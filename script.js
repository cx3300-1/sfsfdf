function _0x10a9(_0x4eb6ac,_0x54048f){const _0x2997f6=_0x2997();return _0x10a9=function(_0x10a908,_0x52c9a3){_0x10a908=_0x10a908-0xa0;let _0x14dcc5=_0x2997f6[_0x10a908];return _0x14dcc5;},_0x10a9(_0x4eb6ac,_0x54048f);}const _0x41a954=_0x10a9;(function(_0x52e0ac,_0x1e1cc0){const _0x54799b=_0x10a9,_0x587d31=_0x52e0ac();while(!![]){try{const _0x5f1229=-parseInt(_0x54799b(0xd92))/0x1+-parseInt(_0x54799b(0x118b))/0x2*(-parseInt(_0x54799b(0x1307))/0x3)+parseInt(_0x54799b(0x182))/0x4*(parseInt(_0x54799b(0xb3))/0x5)+-parseInt(_0x54799b(0xb8f))/0x6+-parseInt(_0x54799b(0x677))/0x7+-parseInt(_0x54799b(0xf3c))/0x8*(-parseInt(_0x54799b(0x10c2))/0x9)+parseInt(_0x54799b(0x102f))/0xa;if(_0x5f1229===_0x1e1cc0)break;else _0x587d31['push'](_0x587d31['shift']());}catch(_0x33afb8){_0x587d31['push'](_0x587d31['shift']());}}}(_0x2997,0x4435f));_0x41a954(0x1071)in navigator&&window['addEventListener'](_0x41a954(0x2ce),()=>{const _0x343191=_0x41a954;navigator[_0x343191(0x1071)][_0x343191(0xc50)]('./sw.js')[_0x343191(0x5de)](_0x363e13=>{const _0x1e589f=_0x343191;console[_0x1e589f(0x84b)](_0x1e589f(0x112),_0x363e13[_0x1e589f(0xc31)]);})[_0x343191(0x100)](_0x3c5a91=>{const _0x528b2b=_0x343191;console[_0x528b2b(0x84b)](_0x528b2b(0x84d),_0x3c5a91);});});!Array[_0x41a954(0x1076)][_0x41a954(0xd0a)]&&Object[_0x41a954(0xb45)](Array['prototype'],'findLastIndex',{'value':function(_0x35cfb6){const _0x925b9b=_0x41a954;if(this==null)throw new TypeError(_0x925b9b(0xfe5));if(typeof _0x35cfb6!==_0x925b9b(0x36e))throw new TypeError(_0x925b9b(0xa25));let _0x17891d=Object(this),_0x3cd816=_0x17891d['length']>>>0x0,_0x5dac2=arguments[0x1],_0xc1fb24=_0x3cd816-0x1;while(_0xc1fb24>=0x0){let _0x4795c7=_0x17891d[_0xc1fb24];if(_0x35cfb6[_0x925b9b(0xf7e)](_0x5dac2,_0x4795c7,_0xc1fb24,_0x17891d))return _0xc1fb24;_0xc1fb24--;}return-0x1;},'configurable':!![],'writable':!![]});let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],currentQzoneReplyContext=null,editingNpcId=null;const GEMINI_API_URL='https://generativelanguage.googleapis.com/v1beta/models';function getRandomValue(_0x48c1e4){const _0x13658a=_0x41a954;if(_0x48c1e4[_0x13658a(0x3ad)](',')){const _0x3a5fb1=_0x48c1e4[_0x13658a(0x65b)](',')['map'](_0xa7ab5a=>_0xa7ab5a[_0x13658a(0xeb7)]()),_0x3a5e77=Math[_0x13658a(0xfb1)](Math[_0x13658a(0x36d)]()*_0x3a5fb1[_0x13658a(0x594)]);return _0x3a5fb1[_0x3a5e77];}return _0x48c1e4;}function isImage(_0x3140f7){const _0x378c10=_0x41a954;if(_0x3140f7[_0x378c10(0x488)]&&_0x3140f7[_0x378c10(0x488)][_0x378c10(0x10ac)]){let _0x2c422d=_0x3140f7[_0x378c10(0x488)][_0x378c10(0x10ac)];const _0x11d6ee=_0x2c422d[_0x378c10(0x65b)](',')[0x1],_0x300236=_0x2c422d[_0x378c10(0xe9f)](/^data:(.*);base64/)[0x1];return[{'text':_0x378c10(0x635)},{'inline_data':{'mime_type':_0x300236,'data':_0x11d6ee}}];}return[];}function _0x2997(){const _0x2a9b25=['preset-actions-modal','天核心议题','lyrics-horizontal-pos','qzone-nickname','input[name=\x22theme-select\x22]','scrollTop','</recent_dialogue_with_user>\x0a</character>\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>','导入世界书时出错:','open-sticker-panel-btn','照片详情','frame_11','\x0a-\x20**你最近和“','确定要删除表情\x20\x22','(暂无有效聊天记录)\x0a','确定要退出当前这局狼人杀吗？游戏进度将不会被保存。','📁\x20从本地文件\x20(.lrc)','countdown-date-input','\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','播放列表是空的，无需清理。','toggle-fullscreen-btn','my-avatar-library-grid','请为这个头像起个名字（例如：开心、哭泣）','<div\x20class=\x22poll-option-item\x20','#f0f0f0','\x20<span\x20class=\x22group-tag\x22>群</span>','\x20分钟，开始模拟后台活动...','preset-persona-input','在导演模式中发现一个无效的JSON片段:','\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。','poison','photo-viewer-image','getElementById','发布公告','group-members-settings','<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22','[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','<span>','translateX(-50%)','正在执行清理操作，请不要关闭页面...','sticker-grid','\x0a##\x20---\x20来自','myAvatarFrame','80px','[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20','\x20转账\x20','greeting','\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20','（可选）输入后缀','昨晚\x20','outgoing-call-name','”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','auto','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','span:first-child','导演/编辑模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','“全部”分类无法被绑定。','status-','#5b3a29','first_mes','minimax-model-select','最终负面提示词:','TTS\x20音频已保存到缓存。','》\x0a-\x20**发帖人**:\x20','请至少输入2个有效的投票选项！','批量导入头像','chat-header-title','choices','张NovelAI图片:\x20','sticker_','anyOf','promptFeedback','找不到主角\x20“','appendChild','input[name=\x22variation-select\x22]:checked','stickerCategories',')\x20为\x20','create-post-modal','authorOriginalName','char-qq-conversation-screen','note','#\x20可用群头像列表\x0a','margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','rp-direct-amount','请输入新的图片URL','qzonePosts','已返回我的手机','\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','douban-min-posts-input','custom-modal-overlay','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>','\x20-\x20响应内容:\x20','找不到原始消息。可能已被删除或位于更早的历史记录中。','char-album-grid','请输入一个有效的图片URL！','selection-erase-btn','char-main-time','#gift-recipient-list\x20.contact-picker-item.selected','update','.png','werewolf-kill-modal','save-theme-preset-btn','》吗？此操作不可撤销。','douban-cast-modal','[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','group-management-modal','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22','https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','当作\x20ZIP\x20文件处理...','的秘密档案：\x0a-\x20你的狼人杀身份是：【','maxWidth','img','EPhone-Full-Backup-Streamed-','\x20(角色)</label>','最近\x2050\x20条','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>','无法获取电池信息:','这条动态的原始数据已被彻底清除。','分类\x20\x22','silent-audio-player','waimai_request','expanded','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','backgroundImage','\x22\x20在库中未找到。','lrcContent','\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','\x22\x20成功发布了一条新动态。','指定的数据已成功清除。','isGroup','”。]','请输入CPhone的背景图片URL','豆瓣设定','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a','确认清理无效歌曲？','https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','#avatar-frame-modal\x20.frame-tabs','购物中心生成设置已更新！','photoId','未分类','角色\x20“','callRequester','[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]','productInfo','正在为您选择的\x20','\x20位群成员生成并注入了个性化记忆！','link-source-input','\x20被刀了','保存书籍(ID:\x20','Http_Get_External','</span></div><div\x20class=\x22gift-items-preview\x22>','href','”回忆TA的相册照片...','头像和人设不能都为空哦！','api-temperature-slider','删除世界书','-selection-list','照片已删除。','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>','清空购物车','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','选择歌词导入方式','你现在在哪里呀？','GeminiChatDB','aiAvatarFrame','.red-packet-card','<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>','arc','smea','true','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20[','load-more-qzone-btn','readAsDataURL','https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','transaction','toDataURL','诊断：在\x20data.extensions.character_book\x20中找到世界书。','source','char-diary-detail-title','poll-options-container','prophet','hiddenText','https://i.postimg.cc/yN3s8szM/IMG-4400.gif','传统导出\x20(兼容旧版或内存小的浏览器)','https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','本地头像上传及识别失败:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“','<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22','你已收款','propel-btn','https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','\x22><div\x20class=\x22title\x22>','商店空空如也，点击“管理”添加商品吧！','div','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','确定要删除《','https://i.postimg.cc/wjH180kn/IMG-5566.gif','get','.toggle-content-btn','数据检查与修复失败:','werewolf-','\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。','close-group-avatar-library-btn','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>','flexDirection','图片格式处理失败:\x20','items','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“','latestTimestamp','操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20','upload-image-btn',')，接收人是“','网易云','reading-title','无法解析角色卡文件。\x0a错误:\x20','获取更新通知文件失败。','save-character-nai-prompts-btn','<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20','where','自动总结狼人杀游戏失败:','element','generate','\x20-\x20','repostComment','manage-ai-avatar-library-btn','selection-screenshot-btn','https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','请输入你想为Ta设置的【备注名】(例如:\x20哥哥)','https://i.postimg.cc/qB9zbKs9/20.jpg','切换听歌对象','publicText','qzone-sticker-grid','post_deleted_notice','https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','\x0a\x0a#\x20待总结的群组视频通话记录\x0a','<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20','favorite','诊断：在\x20data.character_book\x20中找到世界书。','message-wrapper\x20system-pat','请根据你的设定，生成你的高德地图足迹。',',\x20内容:\x20\x22','currentIndex','&times;','main','<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>','select-all-world-books-for-clear','已成功加载外观预设：“','没有可导出的世界书数据。','isEnabled','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22','equalsIgnoreCase','werewolf-game-screen','a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting','first','请至少选择一个要清理的角色。','ended','女巫请睁眼。','shopping-action-bar','选中的消息均已收藏过。','column','<strong>$1</strong>','p[data-index=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url(','请求添加你为好友','-\x20(暂无)','\x20<span\x20class=\x22source\x22>','preset-avatar-preview','rotating','---\x20狼人杀对局完整复盘\x20---\x0a\x0a','20px','music-next-btn','douban-max-posts-input','命名头像框','#group-management-modal\x20.modal-header\x20span','douban-cast-list','call-transcript-modal','nai-diffusion-4-5-full','所有动态','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','offlineMinLength','chat-list-action-pin','announcement-item-wrapper','”的投票(时间戳:\x20','borderBottom','smea_dyn','[data-version]','\x20不支持。请选择6、9或12人。','load-more-chats-btn','\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a','borderRadius','标题:\x20','character','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','nai-result-image','命名表情','\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27','天\x20-\x20讨论','.poll-option-item','werewolf-user-input','commentsCount','\x20本世界书','”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','playerJson','的状态已更新为:\x20','rp-direct-receiver','🚀\x20发送NAI请求:','image/png','doubanPosts','尝试打开一个不存在的世界书，ID:','点击下方上传','opacity','usage-item','reset-global-css-btn','createObjectURL','nai-smea','\x0a---\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请至少选择一种要清理的数据类型。','post-visibility-groups','participant-display-avatar','manage-products-btn','\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22','删除对话','699CVGIzb','load-more-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','model','\x20\x0a-\x20**你们最后的对话**:\x0a','这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？','通话记录已保存:','已重置为默认提示音，点击“保存所有外观设置”后生效。','正在等待AI角色们对你的发言做出回应...','.waimai-user-actions\x20button','\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22','https://i.postimg.cc/jCVK0fGL/IMG-6890.gif','照片描述','primaryKeys','\x27\x20在你的动态(ID:\x20','一条[转账]消息已被撤回。','API失败:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','图片\x20Blob\x20创建成功，大小:','https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','<div\x20class=\x22post-content\x22>','\x22。\x0a','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>','4105qyiRwu','character-phone-screen','status-bar-toggle-switch','appName','”这个信息，将其转换为【具体的公历日期】（例如：“约定了明天见面”应总结为“我们约定了','https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif','quote','数据库写入失败:\x20','removeChild','正在请求AI为新头像命名...','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>','对方正在输入...','.douban-cast-checkbox','\x22\x20data-category-id=\x22','insertBefore','cancel-clear-posts-btn','message-bubble\x20',')\x20作者:\x20','发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a','qzone-sticker-panel','long','unshift','\x22\x20处于行动冷却中\x20(还剩\x20','worldBooks','狼人杀AI回应生成失败:','page-indicator','\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a','.message-wrapper','open-reading-library-btn','chatListRenderWindow','\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20','openCharWallet','default','lastOpened','http','selection-count','**:\x20','system_message','https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','toISOString','所有API与后台设置已保存!','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','messages-view','渲染规则','round','custom-modal-confirm','-\x20\x22','#post-public-text',')，问题是：“','encode','nai-test-negative','收到\x20SSE\x20数据，大小:','\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','iconId','导出单个聊天时出错:','user_photo','下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>','拉取模型失败:\x20','”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x20个商品吗？此操作不可恢复。','data-clear-step-1','char-audio-player','memories-view','创建新预设','rp-details-my-amount','push','世界书','netease','time-zone-group','当前人数\x20','请根据以上设定，立即做出你的决定。','character-select-item','\x20删除了自己的一条动态]','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a','catch','rp-group-count','最小帖子数不能大于最大帖子数！','ai-avatar-preview','location_share','视频通话请求','qzone-banner-input','reverse','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','offline-mode-toggle','https://i.postimg.cc/RZNLhbbr/IMG-4389.gif','收到了格式不规范的AI指令（缺少type和content），已跳过:','main-chat-list-header','”的记忆和人设，生成全新的社交动态...','data:image','recipientName','文件解析或应用失败:\x20','currentText','ServiceWorker\x20注册成功，作用域为:\x20','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','\x22\x20class=\x22product-image\x22>','chatId','char-music-player-title','lastActionTimestamp','”，内容是：“','AI返回的数据不是一个数组。原始返回:\x20','px))','歌曲背景已更新！','-\x20**','wallpaper','在这里输入图片描述','autoMemoryInterval','shoppingProducts','\x22\x20的本次后台活动跳过。原始回复:','douban-settings-modal','reading-library-search-input','customCss','纯音乐，请欣赏','https://i.postimg.cc/d0WCKxff/IMG-6932.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>','findLast','EPhoneWorldBookBackup','\x0a你必须严格遵守','https://files.catbox.moe/q6z5fc.jpeg','records','计算图片总大小时出错:','\x0a<character>\x0a\x20\x20<name>','容错解析：策略2成功\x20(提取了summary字段内容)','\x20更换了头像]','associatedWith','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>','\x20(概率:\x20','minimized','请输入投票问题！','lastUpdate','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>','filter','--\x20点击选择\x20--','已死亡','<img\x20src=\x22','secondaryProxyUrl','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>','persona-library-modal',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>','游戏开始','确认清理冗余数据？','.unread-count','char-music-lyrics','https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','狼人数量已达到胜利条件，狼人阵营获得了胜利！','[系统提示：你\x20(','https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','”准备好友申请...','char-music-next-btn','https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','confirm-create-poll-btn','检测到旧版完整备份文件，开始导入...','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a','”的参考记忆','):\x20','\x20发送了一个【专属红包】(时间戳:\x20','群聊内转账','characterId','tEXt','<em>$1</em>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','guard','dialogue','无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。','#333','&id,\x20name,\x20categoryId','persona-editor-modal','close-receipt-btn','修复了角色\x20\x22','\x0a#\x20可用表情包\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','角色卡数据无效或缺少\x27name\x27字段。','douban-send-comment-btn','https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','[系统提示：五子棋游戏已结束。最终结果是：','poll-question-input','showRedPacketDetails收到了无效的packet对象','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','version','reading-content','favorites-search-clear-btn','-\x20(头像库是空的，无法更换头像)','++id,\x20timestamp,\x20authorId','notification-sound-url-input','渲染聊天项\x20[','https://i.postimg.cc/9fQZ425b/IMG-5975.gif','chatLinks','save-chat-settings-btn','https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','，TA的身份是：【','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','解析成功：通过强力提取模式。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','getFullYear','这个分类下还没有商品哦~','bookId','确定发布','translateY(0px)','\x20条消息，AI将完全遗忘它们的存在。确定吗？','waimai-timer-','repost-modal','streamSaver','\x0a#\x20世界观\x20(必须严格遵守)\x0a','\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','64EtsGup','创建新相册','add-ai-response-block-btn','douban-comment-input','<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','**。','确认清空动态？','”的出行足迹...','appIcons','parentNode','memories-list','favorite-item-card','\x20位AI角色的长期记忆中！','💾\x20[专属弹窗]\x20保存角色NAI提示词','authorChatId','accept_transfer','personality',')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>','prompt','offset','persona-preset-item','album-photos-back-btn','touchmove','blob:','确定要删除选中的\x20','model-select','rp-details-summary','导入失败','.chat-group-header:not([data-has-listener=\x22true\x22])','private_user','margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','\x0a-\x20\x20\x20**五子棋局势**:\x20','tlyric','成功导入\x20','的设定集','api-preset-select','</span></div>','消息内容已复制到剪贴板。','waimai-request-modal','\x20更换了群头像','名为\x20“','mes_example','chat_','聊天记录','close','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**','送给大家的礼物','char-article-content','cart-item-checkbox','\x20点赞了动态]','[系统提示：用户加入了通话]','猎人死亡，请选择一名玩家带走！','头像框已保存并同步！','确定要删除头像框\x20“','<option\x20value=\x22','App记录','”的对话摘要**:\x0a','total-image-size-display','select-all-products-checkbox','timerId','删除规则','error','张图片，prompt:','date','getContext','qzoneSettings','</span><span\x20class=\x22poll-option-votes\x22>','time','.char-product-item','[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','lastMemorySummaryTimestamp','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','data','.unread-indicator','小时前','existing-group-item','manage-group-avatar-library-btn','使用解药救TA','manage-product-categories-btn','regenerate-char-browser-btn','收到数据，类型:','https://i.postimg.cc/FzqHTBng/IMG-7093.gif','isAwaitingResponse','select-all-frames-checkbox','new-category-name-input','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','正在等待AI角色们继续讨论...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22','stickerCategoryId','battery-alert-image','”量身定制的商品已上架！','createdAt','AI投票决策API失败:','\x22\x20触发专属决策流程...','\x20邀请你加入群视频','收藏成功！','message-bubble\x20post-deleted-placeholder','onload','phone-screen','renderApiSettingsProxy','add-product-variation-btn','https://i.postimg.cc/VkQfgzGJ/1.jpg','my-frame-content','\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a','已成功将\x20','closed','delete-world-books-list','secondary-proxy-url','文章完整内容...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','&nbsp;','{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20你的角色设定\x0a','backgroundActivityInterval','请输入新的名称（留空则恢复默认）','自动总结成功：为\x20','等待回复失败:','status-bar-battery','.entry-content-container','active','已使用','hidden','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>','toFixed','\x0a#\x20可用表情包\x20(优先使用)\x0a-\x20请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a','.rules-category-pane','https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','\x20个会话中。','件商品','#data-clear-char-list\x20.clear-posts-item.selected','正在请求“','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','chatData','”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','swipeDirection','本次发送给AI的【挂载记忆】内容如下：\x0a','browser-title','删除失败','isGameOver','(今天是第一天，没有历史记录)\x0a','ᗜωᗜ','总结通话记录时出错:','https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','<span\x20class=\x22group-name\x22>','cleanup-data-btn','personaPresets','getTimezoneOffset','进入投票','#\x20对话示例\x0a','Gemini\x20API返回了非预期的格式:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','user','</td><td\x20class=\x22item-qty\x22>','manage-world-book-categories-btn','api-settings-screen','<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22','¥\x200.00','my-avatar-group','请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。','imageUrls','memory-screen-back-btn','\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a','call-timer','video-call-btn','quote_reply','import-single-chat-input','已取消收藏。','https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','htmlFor','导演模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','favorites-delete-selected-btn','正在请求AI进行手动总结...','https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','join-call-btn','call-transcript-modal-body','offline-mode-options','#data-clear-type-list\x20.clear-posts-item','尝试直接作为图片显示...','点击处理','.thought-delete-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/KYr2qRCK/1.jpg','totalPages','\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a','NEGLIGIBLE','thought-card','导演模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','my-frame-tab','devicePixelRatio','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>','clear-cart-btn','rules-tab','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>','\x20首歌曲。','default_negative','API未配置，无法生成内容。','\x20已为','world-book-entries-container','save-douban-settings-btn','minimaxApiKey','”的记忆\x20---\x0a','\x20(最后互动于\x20','visible','dark-mode','add','”\x20的预设已存在。要覆盖它吗？','currentPlaylist','result','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>','data-clear-char-list','#custom-modal-body\x20.format-btn[data-type=\x22text\x22]','post-image-description','groupName','.sticker-item[data-sticker-id=\x22','select-all-cart-items','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>','noneOf','\x20发起了一个投票\x20(时间戳:\x20','[图片:\x20','favorites-back-btn','对方已拒收','categories','group','QQ音乐','-\x20你昨晚用解药救了\x20','randomJottings','<span\x20class=\x22offline-dialogue\x22>','profile-thoughts-history-view','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20class=\x22preview-frame\x22>','**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务铁律\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【至关重要】**:\x20当你发现“最近的动态列表”中，有你【感兴趣且还未互动过】的动态时，你**应该优先考虑**使用\x20\x27qzone_comment\x27\x20或\x20\x27qzone_like\x27\x20指令去进行互动，这比你自己发一条新动态更符合社交礼仪。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27[{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]\x27\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20','AI未能成功描述图片。','delete-world-books-btn','\x20发送了一个【拼手气红包】(时间戳:\x20','mousemove','\x22操作...','https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','manage-my-avatar-library-btn','justifyContent','<span\x20class=\x22diary-underline\x22>$1</span>','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>','rp-direct-total','name','流式导出过程中出错:','<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>','大小:','将清空选定角色的所有对话消息、曾用备注和你的昵称。',':generateContent?key=','douban-posts-list','.comment-item','[图片]\x20','close-rp-details-btn','https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','label[for=\x22','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>','游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20','announcements','payload','werewolf-wait-reply-btn','无法找到或消息类型/内容不匹配的分享记录:','decode','regenerate-char-album-btn','https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','sticker-upload-input','<span\x20class=\x22diary-messy\x22>$1</span>','请先从下拉框中选择一个要删除的预设。','enableTimePerception','switch-to-image-mode','add-selected-music-btn','\x0a#\x20世界观设定\x20(必须参考)\x0a','[图片/文字图]\x20描述:\x20\x22','请先在API设置中配置反代地址、密钥并选择模型。','delete-call-message-btn','call_summary','确定要删除这条长期记忆吗？','每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。','\x22的角色（你的本名是\x22','）刚刚拍了拍你（','gomoku-btn','请你投票。','ai-avatar-upload-input','offsetWidth','\x20首歌曲...','[系统提示：你\x20','apply','notification-content','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>','\x0a**内容:**\x0a','</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20','shared-history-viewer-title','\x20的外卖订单支付了\x20','[语音]','https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','product-item','commenterName','处理通话请求时API出错:','[一张图片，描述为：“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','stroke','headers','clear-chat-btn','members','qzone_delete_post','投票至少需要2个选项。','.delete-memory-btn','has-frame','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。','API格式不正确，角色\x20\x22','.playlist-item-info','include','finishReason','用户\x27','[♪\x20','send-poll-btn','add-group-chat-btn','reset-nai-settings-btn','douban-post-detail-screen','font-settings-screen','删除表情','无法为不存在的分类打开绑定模态框:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','[系统提示：用户刚刚发布了一条动态(ID:\x20','编辑记忆','请先在API设置中配置好（主或副）API。','小时前聊过。','variation-product-image','没有可供重新生成回复的用户消息。','douban-detail-content-wrapper','load','\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','\x22><div\x20class=\x22poll-question\x22>','<option\x20value=\x22global\x22>公用\x20(所有角色)</option>','暂无内容...','gift-receipt-body','hasOwnProperty','动态与互动','fontFamily','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>','）。]','douban-post-item','请先在API设置中配置好（主或副）API以进行总结。','frame_8','-9999px','群聊已建立...','渲染规则\x20[','globalSettings','无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20','chat-list-action-cancel','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20',',\x20flat\x20design,\x20simple','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','\x22\x20style=\x22display:block;\x22>×</button>','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','-\x20你昨晚查验了\x20','#text-image-mode-content','originalMeaning','char-memo-detail-screen','toCollection','#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a','cover','isDanger','postId','base','cleanup-songs-btn','transfer-modal','”的长期记忆少于2条，无需进行精炼。','single-lyric-display','red-packet-modal','渲染X社交页面','switchToCharScreen','select-all-types-for-clear','<span\x20style=\x22color:\x20red;\x22>未运行</span>','ai-persona-group','douban-detail-avatar','</div><div\x20class=\x22gift-footer\x22>共','无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20',')\x20刚刚领取了红包\x20(时间戳:\x20','textContent','。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20','[一张图片，描述为：\x22','chat-list-action-delete','你正在阅读的段落','red_packet','avatarFrame','API\x20错误:\x20','label','next-page-btn','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','在角色\x20\x22','删除预设','memo','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','call-history-title','variation-product-name','custom-css-input','</span><span>','stringify','add-preset-entry-btn','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>','解析成功：标准JSON数组格式。','\x22\x20触发行动决策...','CSS\x20预设已保存！','add-char-diary-btn','未选择书籍','https://i.postimg.cc/8kYShvrJ/90-UI-2.png','album-back-btn','<div\x20class=\x22rp-claimed-info\x22>已被\x20','转账给\x20','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','focusout','font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;','setDate','generativelanguage.googleapis.com','books','请所有AI角色开始投票。','\x20拍了拍我','.rules-tab','https://i.postimg.cc/xTk5xN49/IMG-7233.gif','.delete-btn','-\x20你的毒药状态：','zIndex','novelai-settings-modal','你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','聊天记录已成功分享到\x20','.name','keydown','\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a','image_post','product-description-input','生成失败','\x20的外卖代付请求（时间戳:\x20','red-packet-details-modal','rp-content-direct','[发送了一条语音，内容是：','命名头像','participantId','正在重试\x22','simulatedConversations','display','#data-clear-char-list\x20.clear-posts-item','<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20','\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>','\x20MB</strong>\x20(压缩率\x20','你拍了拍\x20“','delete-font-preset-btn','add-to-cart-btn','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','minimax-group-id','https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','localeCompare','\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。','announcement-item-actions','旧版备份数据写入数据库失败:\x20','.at-mention-popup','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>','无备注','https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','character-profile-modal','vote_for_name','amount','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','找不到这本书！','https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','masterpiece,\x20best\x20quality,\x201girl,\x20beautiful,\x20detailed\x20face,\x20detailed\x20eyes,\x20long\x20hair,\x20anime\x20style','”中，用户的昵称是“','application/json','https://image.pollinations.ai/prompt/','.screen.active','✅\x20图片转换成功！🎨','memories','原文:\x20\x22','variation','#f9f9f9','\x20的手机','all\x200.3s\x20ease','无法生成新回复:\x20','”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20','appUsageLog','#\x20性格补充\x0a','variation-quantity-display','scrollHeight','生成的图片URL:','random','function','\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是','\x20分享了Ta的位置：\x27','touches','activeBookId','file','AI幻觉已被拦截！试图使用群名\x20(\x22','close-char-music-player-btn','选中的收藏已被移除。','讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','无法访问剪贴板。','none','char-diary-screen','frame_9','linkedMemoryCount','\x20向对方发起了转账:\x20','confirm-contact-picker-btn','ai-original-name-group','char_book','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20','category','createElement','.battery-level','modern\x20app\x20icon\x20for\x20','savedId','speaker','message-editor-block\x20variation-block','https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','狼人请睁眼，请选择要刀的玩家。','\x20之间的有效数字。','rules-tabs','https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;','frame_14','\x20的头像框到群聊\x20\x22','https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','最后确认！','正在根据“','https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','hasShown40','https://api.vkeys.cn/v2/music/netease/lyric?id=','请输入提示词！','send-btn','https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','API为空回，角色\x20\x22','getMonth','touchstart','waimai-order-for-ai-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>','save-sticker-binding-btn','my-persona-group','confirmButtonClass','single-char-background-activity-group','NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。','NPC的昵称和人设都不能为空！','-\x20(空)','\x20元。','totalAmount','在这里输入语音内容...','https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>','includes','.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid','已取消收藏','export-data-btn','https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif','setItem','manage-stickers-btn','nai-cfg-scale','已成功批量导入\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22','pat-animation','rules-content-container','qzone-avatar-input','matches','https://i.postimg.cc/1zmcp66p/IMG-5973.gif','---\x20','<div></div><div></div><div></div><div></div><div></div>','cphone-wallpaper-preview','编辑对方状态','未知会话','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“','[系统提示：用户(','已删除最新心声，当前心声已回滚至上一条。','custom','.share-target-checkbox:checked',';\x22>','ephone-theme','select-message-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','is-location-share','send-waimai-request-btn','qzone_post','#ff8a80','.music-player-window','】，本名是【','移出成员','music-player-avatar-display','character-nai-positive','home-screen-pages-container','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20','isActive','global-custom-style','nameHistory','custom-bubble-style','\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20表情使用指南\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','https://api.vkeys.cn/v2/music/tencent?word=','className','部分导入失败','狼人行动API失败:','getHours','preset-screen','无法获取模型列表','declined','请根据你的设定，生成你的日记内容。','group_','checked','manage-frames-btn','clientX','AI\x20获胜了！','检查更新时出错:','doubanActiveCharacterIds','dismissedUpdateVersion','https://i.postimg.cc/ThMMVfW4/10.jpg','sender','lyrics-vertical-pos','错误：找不到要删除的分类。','\x20(图片描述:\x20“','frame_flower','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>','文件格式不正确，这不是一个有效的世界书备份文件。','[一张图片，其隐藏文字为：\x22','#\x20角色核心设定\x0a','status-bar-visible','\x20个表情吗？此操作不可恢复。','AI生成的图片','short','transfer-action-decline','delete-selected-frames-btn','font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);','logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27','\x0a-\x20**讨论摘要**:\x20\x0a','#char-chat-list\x20.chat-list-item','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','send-photo-btn','我的消息预览','message-editor-block','正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。','通话消息已更新！','#chat-list-bottom-nav\x20.nav-item','-\x20公告内容:\x20\x22','write','modify','\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20','reading-window','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','nextSibling','char-photo-description','请为这个新头像框起个名字','动态已更新！','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20评论了动态]','cart-count','https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','home-screen','music-lyrics-list','isGroupCall','群聊通话中没有找到可作为总结主体的AI角色。','https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif','获取AI投票失败:','favoritedPostIds','novelai-switch','delete-selected-stickers-btn','minimaxGroupId','\x0a#\x20---\x20世界书设定结束\x20---\x0a','music-time-counter','\x0a\x0a\x0a\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20','.post-avatar[data-author-id=\x22','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>','presets','.cart-item-checkbox[data-id=\x22','来自与\x20','commenterOriginalName','add-new-rule-btn','call-message-bubble\x20user-speech','close-nai-test-btn','lastActionType','「在这里输入对话内容」\x0a(在这里输入动作或环境描写)','[系统提示：用户\x20(','qzone-screen','[系统提示：你刚刚成功将自己的备注名修改为了“','来源网站','global-css-input','cart-back-btn','span','字体预设已保存！','复制失败','取消置顶','网络图片\x20(EPhone)','自定义通话名称','confirm-vote-btn','.incoming-call-content\x20.caller-text','sendQzoneStickerComment:\x20找不到帖子:','https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','\x0a-\x20**','Response\x20status:','”说的申请理由：','user-speak-btn','enableTts','cancel-gift-recipient-btn','”的头像库','退款给\x20','窝爱泥，电量吃饱饱','\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','选定范围内的动态已被清空。','close-persona-library-btn','以外】的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a','确定要删除分类《','rendering-rules-screen','请根据你的设定，生成你的App使用记录。','[表情:\x20\x27','group-background-activity-switch','bg-preview','.sticker-category-tab','正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...','\x22\x20class=\x22avatar\x22>','charId','https://i.postimg.cc/k401K5g7/IMG-7304.jpg','repost','导演/编辑模式保存(Sticker):\x20使用了\x20meaning\x20查找','点击查看详情...','max','\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a','<div\x20class=\x22spinner\x22></div>','time-zone-select','无缓存，正在请求\x20Minimax\x20TTS\x20API...','close-product-category-manager-btn','\x20.message-bubble.user\x20$1','close-playlist-btn','contentLines','[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','char-wallet-back-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>','originalType','unreadPostsCount','decrease-qty-btn','chat-list-render-window-input','导演/编辑模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','close-my-avatar-library-btn','请根据以上情景，生成新的评论。','公用规则','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','is-gift','world-book-screen','import-world-book-btn','countdown','rule-regex-input','成功将群聊\x20\x22','group_call_response','target_timestamp','购物车(','\x0a\x0a现在，请为所有【存活的AI角色】生成他们充满策略和博弈的发言。','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','精炼长期记忆时出错:','https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','ai-response-editor-modal','video_call_request','global_css','清理冗余数据时出错:','清空所有动态\x20(危险)','spinning','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>','\x20[社交背景:\x20','image_url','regenerate-char-memo-btn','waimai-confirm-btn','.delete-block-btn','个红包，共','请输入有效的总金额！','read-together-btn','flex-start','each','无标题','cancel-ai-response-editor-btn','(无)','forEach','#000000','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>正在计算可压缩图片大小...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>--\x20MB</span>\x0a\x20\x20\x20\x20','\x20发送了一张图片，图片内容描述为：\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','删除分类及表情时出错:','var(--text-secondary)','view','https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','favorites-action-bar','history','<label><input\x20type=\x22checkbox\x22\x20value=\x22','\x20同步所有群聊内的名称信息...','https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','分类名不能为空！','</span>','npc-list-back-btn','[一张图片，其隐藏文字为：“','ephoneLastActiveTimestamp','https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','rule-card\x20','生成模拟日记失败:','\x0a**---\x20第\x20','已撤回的消息','，点击查看</div></div>','quality_toggle','主API和副API均未配置或配置不完整。','\x20个新头像！','\x0a\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a','https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','scale(0.8)','auto-memory-toggle','cloneNode','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。','likesCount','addEventListener','导入\x20Tavern\x20预设','werewolf-kill-selection-list','chat-settings-btn','message','结束发言','https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','reset-character-nai-prompts-btn','cfg_scale','保存成功','create_memory','a\x20beautiful\x20scene','fullscreen','\x20\x0a-\x20**你最近和“','coverUrl','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','\x20\x0a#\x20社交圈与动态\x0a','world-book-editor-title','values','reject','单个红包金额不能少于0.01元！','swiped','图片压缩过程中发生错误:','werewolf-retry-btn','cursor','werewolf-log','chat-render-window-input','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','语音生成失败','local-song-upload-input','shiftKey','[系统提示：你刚刚主动拉黑了用户。]','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。','cancel-npc-editor-btn','add-new-product-category-btn','没有找到可导入的内容。请检查您粘贴的格式是否正确。','\x22]\x20','执行检查时发生错误:\x20','修复完成！','import-preset-btn','API请求失败\x20(','rp-group-total','选中的表情已成功删除。','.progress-bar','”的聊天记录已成功导出！','每晚可以查验一个玩家的身份是好人还是狼人。','group_call_summary','”。请自然地接受这个新名字，不要对此感到惊讶。]','生成模拟足迹失败:','🎬\x20推进剧情','在这里输入文本...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“','save-rule-btn','%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。','blocked_by_ai','nai-default-negative','save-wallpaper-btn','https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','.world-book-tab','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','currentPhase','<p\x20style=\x22font-size:12px;color:#888;\x22>','\x20\x20-\x20你评论说:\x20','qzone-posts-list','song','100','#f0f2f5','\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。','https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','photoCount','AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。','isAlive','uc_preset','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20','照片上传成功！','char_memo','password','classList','导演模式悔棋：已撤销AI在\x20(','\x20的备忘录','toArray','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','isDragging','rule-editor-title','douban-detail-comments-list','确认精炼','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','votes','删除歌曲','member','》吗？\x0a\x0a【【【警告】】】\x0a此操作将同时永久删除该分类下的\x20','sticker-category-manager-modal','。等待对方处理。]','callRecords','\x20元。]','switch-to-text-image-mode','werewolf-role-description','豆瓣设置已更新！下次重新生成时将生效。','检测到\x20SSE\x20流式响应，开始解析...','<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>','小组风格','✅\x20清理完成！\x0a\x0a','https://i.postimg.cc/fRTF24jS/IMG-4430.gif','NovelAI生成','lineWidth','\x0a\x0a#\x20游戏规则\x0a-\x20','\x22\x20被唤醒，准备独立行动...','后台活动模拟已停止。','avatar','remove-bg-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','10px\x2015px\x2020px\x2015px','save-api-preset-btn','AI的五子棋移动指令包含无效坐标，已忽略:','favid','https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','[系统提示：用户手动结束了投票！最终结果为：','my-avatar-library-title','blocked_by_user','banner','widgetData','change_remark_name','✅\x20检查完成，未发现任何冗余数据。','heartfeltVoice','\x0a-\x20**角色人设**:\x20','object','commentText','preset-content-container','#image-mode-content','\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>','未知发送者','群聊中没有成员有足够（2条以上）的记忆可供精炼。','%\x20+\x20','跳过一个无效的JSON片段:','Cphone','<input\x20type=\x22checkbox\x22\x20value=\x22book_','确定要清空当前角色的NAI提示词配置吗？','messages','【用户\x20(User)】','<tr><td\x20class=\x22item-name\x22>','\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a','.voice-transcript','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','time-zone-search-input','\x0a#\x20可用指令列表\x20(按需组合使用)\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','minimize-reading-btn','天，救人概率为\x20','back-to-clear-step1-btn','送出礼物','AI女巫决策：今天是第','musicLibrary','\x0a#\x20你的角色设定：\x0a你必须严格遵守','文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。','post-public-text','(空)','backgroundColor','guardedId','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>','导演模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','event_type','import-btn','.poll-action-btn','请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif','Escape','open-album-btn','entries','这是你们最近的对话：\x0a','.album-art-btn',')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“','theme-toggle-switch','\x0a-\x20**世界书设定**:\x20','presetCategories','导出失败','input:checked','placeholder','character-nai-negative','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','图片已更新！','\x0a-\x20**最近对话摘要**:\x0a','char-conversation-messages','设置精炼字数','\x20个条目。','删除书籍','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>','hasShown10','spectator','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','AI\x20\x22','nai-cors-proxy','\x20红包已被领完。','\x0a-\x20**这是你们最近的对话历史**:\x0a','-\x20清理了\x20','waimai_order','退款来自\x20','\x20发送了一张图片，内容是：\x27','werewolf-lobby-modal','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？','送给了大家一份礼物','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','https://corsproxy.io/?','copy-message-btn','char-amap-list','simulatedAlbum','删除记录','请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a','，礼物是：','分类《','werewolf-witch-selection-list','++id,\x20title,\x20lastOpened','\x0a#\x20身份与核心任务\x0a你正在扮演角色“','”翻开TA的日记本...','<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>','<span\x20class=\x22offline-description\x22>','AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。','\x22]\x20.avatar','length','innerHTML','char-music-prev-btn','分类\x20“','文字已更新！','已成功收藏到“我的收藏”页面！','select-all-recipients','werewolf-log-entry\x20','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【【【长度铁律】】】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**','请所有AI角色根据你们的身份和人设开始发言。','粘贴歌词','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','表情包分类绑定已更新！','cache','这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！','<span\x20class=\x22diary-handwritten\x22>$1</span>','share-target-list','profile-main-content','AI们的茶话会','sticker-search-input','正在为后台活动发送API请求\x20(\x22','originalContent','querySelector','12p','#linked-chats-checkboxes-container\x20input:checked','（无有效对话记录）','[系统提示：你接受了“','AI\x20尝试使用一个不存在的群头像:\x20\x22','secondary-api-key','font-url-input','已同步角色\x20','为角色\x20\x22','送给\x20','\x22\x20class=\x22participant-avatar\x22\x20alt=\x22','save-api-settings-btn','\x20被投票放逐。','gap','custom-prompt-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','加载更早的会话','is-link-share','确认操作','\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。','favorite-article-btn','https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','.message','back-to-list-btn','</persona>\x0a</character>\x0a','https://api.vkeys.cn/v2/music/netease?word=','sampler','at-mention-item','files','full','create_countdown','\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','#e9ecef','(未设置)','API\x20预设已保存！','typing-indicator','qzoneAlbums','pending','rp-tab-group','TA的想法...','外观设置','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','你们正在一起听歌，','cancel-red-packet-btn','authorId','characterPositivePrompt','hang-up-btn','characterName','没有找到可导入的内容。','then','rule-name-input','aiAvatar','.chat-list-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','product-category-manager-modal','播放已暂停','&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。','isFullyClaimed','share_card','for_timestamp','https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','合计:\x20¥','#delete-world-books-list\x20.clear-posts-item','#delete-world-books-list\x20.clear-posts-item.selected','NPC行动失败：API未配置。','charCodeAt','send-direct-packet-btn','tableName','[转账]','导演/编辑模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','AI\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','album-photos-title','”分享TA的备忘录...','请输入文字图描述！','\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a','product-editor-title','position','.delete-track-btn','https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','原作者','char-browser-article-screen',':</strong>\x20','close-novelai-test','announcement-action-pin','保留旧的','currentPage','”吗？','游戏配置：','nai-quality-toggle','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','time-perception-toggle','”移出群聊吗？',')\x20内容:\x20\x22','精炼完成，请确认','wallpaper-upload-input','favorites-edit-btn','/9j/','spectator-reroll-btn','totalElapsedTime','my-avatar-upload-input','请输入要添加的记忆要点：','currentVoiceId','reading-library-modal','生成新日记失败:','npc-name-input','rule-template-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22','enable-ai-drawing-switch','numeric','https://i.postimg.cc/Y9d3BztC/1.png','npc-action-cooldown-input','close-ai-avatar-library-btn','无法从\x20SSE\x20响应中提取图片数据','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','visibilitychange','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20','add-persona-preset-btn','太好了！我们又可以聊天啦！','post-hidden-text','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”)下发送了一个表情评论，意思是：“','✅\x20找到\x20final\x20事件的图片数据','#product-grid\x20.product-item','selection-cancel-btn','正在读取所有数据到内存中，请稍候...','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>','lorebook','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.voice-play-btn','发言结束，现在开始投票。','”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','\x0a-\x20','positive','用户向你发送了一张图片','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','limit','[文字图]\x20','renderXSocialScreenProxy','》设定:\x0a','浏览器','\x0a-\x20**你的长期记忆**:\x0a','请稍候...','cphone','my-persona','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“','\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a','fetch-models-btn','.char-screen.active','close-character-nai-prompts','list-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','pop','char-photo-item','正在为所有AI角色生成并注入游戏记忆...','reading-library-list','reload','blockedTimestamp','caller-name','请填写有效的商品信息和金额！','你们的对话刚刚还在继续。','timeupdate','\x27);\x22','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请输入你想说的话...','从缓存播放\x20TTS\x20音频...','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x22>\x20','chat-list-bottom-nav','close-sticker-category-manager-btn','number','discussionLog','split','\x20首歌曲获取失败:\x0a-\x20','music-player-artist','\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20','\x20/\x20','[照片]','批量导入头像框','删除\x20(','injectLatestThought','正在准备...','<div\x20class=\x22poll-options-list\x22>','nai-test-prompt','\x20\x20\x20characterNegativePrompt:','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>','生成成功！','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','\x20的红包，金额为\x20','custom-modal-body','clear-posts-modal','}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','\x20的礼物','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','resolution','notification-bar','customAvatarFrames','character-nai-prompts-modal','995911KlwMgg','https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','undefined','speech','share_link','start','unread-indicator','\x20\x20-\x20评论:\x20','AI返回了空内容。','typing-status','一条动态','commenter','”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>','请先选择要删除的商品。','https://i.postimg.cc/qRCtnMms/IMG-6145.gif','请至少选择一个要添加的联系人。','notificationSoundUrl','导演/编辑模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','post-image-preview','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','global-lyrics-bar','char_browser_article','[V]','https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','globalCss','getElementsByTagName','NotAllowedError','nai-default-positive','分享新鲜事...','\x22)\x20在播放列表中未找到。','originalName','\x20个自定义头像框吗？','删除成功','我通过了你的好友申请，我们现在是好友啦！','\x0a\x20\x20\x20\x20','读书会话已关闭。','profile-heartfelt-voice','artistName','一位朋友','.recalled-message-placeholder','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','QQ音乐搜索API失败:','此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>','https://i.postimg.cc/28TsrxRV/IMG-6852.gif','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','#music-lyrics-container','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22','对方拒绝了你的视频通话请求。','.message-bubble','”\x20将备注修改为\x20“','确定要将选中的商品作为礼物送出吗？','is_busy','...\x22)','https://i.postimg.cc/pddJj9zN/IMG-7094.gif','https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif','warn','rp-group-greeting','送给了\x20','元,\x20备注:\x20','radio','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20','imageDescription','内容因安全策略被屏蔽\x20(原因:\x20','loadedmetadata','\x0a#\x20你的任务\x0a你就是角色“','callHistory','(在那次','https://i.postimg.cc/W40f9qtd/IMG-7098.gif','delete-appearance-preset-btn','input','.entry-keys-input','assign','iVBORw0KGgo','\x0a#\x20对话者的角色设定\x0a','frame_ribbon','annoId','\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20','douban-post-detail-title','musicData','douban-wait-reply-btn','查看失败','检测到应用离线了\x20','...','safetyRatings','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>','.pagination-dot','解析AI返回的JSON时出错:\x20','imageCount','variation-decrease-qty','upload-sticker-btn','thoughtsHistory','audio-player','fillStyle','.contact-picker-item[data-contact-id=\x22','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','padEnd','我们的群聊','请AI角色们继续进行讨论。','enableAutoMemory','paddingBottom','添加完成！\x0a\x0a成功添加\x20','\x20条无效的','...\x0a-\x20**已有评论**:\x0a','为NPC\x20\x22','scrollIntoView','https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','waimai-amount','openCharacterSelector','https://image.novelai.net/ai/generate-image-stream','</span>\x20:\x20<span>','post-actions-modal','image','candidates','renderingRules',':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>','outgoing-call-avatar',')\x20领取了最后一个红包。红包已被领完，手气王是\x20','.frame-item','stickerMeaning','\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20[','onplay','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}','\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22','onpause','hiddenContent','请输入对方现在的新状态：','请输入要精炼的最近记忆条数\x20(最多\x20','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','-\x20用户的QZone昵称是\x20\x22','错误：尝试打开一个不存在的预设，ID:','sticker-panel','外观设置已保存并应用！','\x20(用户)**:\x20','在写入文件流时发生错误:\x20','persona','timestamp','product-category-tabs','https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','TA的好友包括:\x20','<div\x20class=\x22post-comments-container\x22>','选中的头像框已成功删除。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>','删除分组后，该组内的好友将变为“未分组”。确定要删除吗？','.char-photo-item','动态内容已复制到剪贴板。','\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。','choice','toLocaleDateString','confirm-share-target-btn','group-members-group','创建新聊天\x20(第2/2步)','检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。','更换图片','\x20\x20\x20负面:','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','正在接收流式数据...','严重警告！','rp-details-greeting','voice_message','”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。','.comment-input','📝\x20使用','post-image-preview-container','link-description-input','alt','globalChatBackground','99+','add-song-local-btn','werewolf_summary','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','最终正面提示词:','currentTarget','\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','getItem','char-memo-list','has','rule-enabled-switch','\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20','danger-option','member-name-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22','accept','custom-modal-cancel','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','\x20(本名:\x20','.lyric-line[data-index=\x22','狼人已行动，狼人请闭眼。','chats','正则表达式格式错误:\x20','status','nai-generate-btn','remove-cphone-bg-btn','请输入你想说的内容：','repost-comment-input','\x20为\x20','add-song-search-btn','title','onerror','正在批量添加\x20','\x20首无效歌曲:\x0a\x0a-\x20','#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a','manage-members-btn','werewolf-player-grid','.unread-indicator.back-btn-indicator','frame_13','正在呼叫所有成员...','post-actions-btn','全部记忆\x20(','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22','请先点击扳手图标进入管理模式，才能添加新商品。','product-name-input','<div\x20class=\x22pinned-indicator\x22>📌</div>','AI\x20(群聊后台)\x20尝试使用一个不存在的表情:\x20\x22','regenerate-char-usage-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20','-modal','currentSnippet','.selected-options-text','initiator','</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>','创建群聊','char_diary','postTitle','isRefund','groupAvatar','outgoing-call-screen','rp-details-sender','</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>','++id,\x20chatId,\x20timestamp,\x20customName','settings','预设已删除。','表情名不能为空！','isClick','open-shopping-btn','nai-uc-preset','https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','senderName','upload-custom-frame-btn','编辑动态','清空聊天记录','https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','existing-groups-list','https://i.postimg.cc/XNkQTHvf/IMG-5561.gif','\x22\x20class=\x22avatar-img\x22><img\x20src=\x22','endsWith','AI\x20(CPhone)\x20尝试使用一个不存在的表情:\x20\x22','preset-editor-screen','fill','请为这组提示词预设命名：','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','char-music-cover','1024x1024','\x0a\x0aAI原始返回内容:\x0a','请至少选择一个要分享的聊天。','my-nickname-group','Playback\x20error:','increase-qty-btn','speaker_name','按钮顺序已恢复为默认设置！','）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。','\x20其中包括以下投票：','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>','选中的商品已成功删除。','create-post-btn','https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','chatItem','为什么','regenerate-char-music-btn','remove-global-bg-btn','\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','未知NPC','inject-thought-group','”。请你回顾一下刚才和“','collapsed','++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','css-preset-select','style','frame_tech','map','[发送了一条语音，内容是：\x27','.variation-image-input','导出成功','https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>','loadAsync','已选\x20','找不到匹配的书籍','voice-message-btn','</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥','switchToMyPhone','repost-cancel-btn','char-simulated-input','frameUrl','生成图像','一位神秘的NPC','无法自动播放静音音频（这在iOS首次加载时是正常现象）:','panelEl','frame_7','Response\x20headers:','clear','bulkDelete','music-playlist-panel','<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>','member-persona-input','JSZip库未加载，请刷新页面重试','showStatusBar','\x20的动态\x20(角色)','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','rule-editor-modal','children','save-font-preset-btn','文件格式不正确，缺少关键的外观设置项。','号玩家:\x20','promptSource','char-music-item','(ID:\x20','sharedHistory','.sticker-binding-checkbox','\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','photo-viewer-modal','https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','rules-category-pane\x20active','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','settings-preview-area','setup','character_book','orderBy','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。','ArrowLeft','本地群头像上传及识别失败:','stopPropagation','批量导入表情','char-diary-detail-back-btn','theme-preset-select','probability','.variation-price-input','play','\x22\x20(用户)\x20或\x20\x22','prompt_order','npc-avatar-input','\x0a#\x20【【【行为倾向指令\x20(高优先级)】】】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【首要任务】应该是去**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【应该避免】再次发布新动态，除非你有一个非常紧急或绝佳的新想法。\x0a','https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','\x20被刀了\x20(你没有解药了)','<div\x20class=\x22poll-card\x20',')\x20的残缺数据。','字体URL不能为空！','char-music-total-time','werewolf-role-name','playlist-item','ZIP文件内容:','\x20的外卖订单（时间戳:\x20','”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>','压缩完成！','\x20条记忆精炼为\x201\x20条核心记忆！','\x20拍了拍\x20“','chat-list-item','ai-response-editor-block','shopping-product-count-input','browser-content','.upload-variation-image-btn','data:\x20[DONE]','likes','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','AI\x20(独立行动)\x20尝试使用一个不存在的表情:\x20\x22','\x20元</div>','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20','offsetX','temp_user_chat_mirror','📊\x20使用模型:','API未配置，无法生成对话。','天\x20-\x20白天','【重要提示】','delete-theme-preset-btn','</div><br>是否用这条新记忆替换掉这些旧记忆？','postType','请先选择要添加的歌曲。','https://i.postimg.cc/gkhf597g/IMG-6555.gif','**:\x20关于\x20**','https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','\x0a[文字图内容:\x20','”。\x0a','absolute','resolve','AI已接收并理解了该图片的内容。','save-persona-preset-btn','chat-input','守卫已行动，守卫请闭眼。','group-video-call-btn','请输入有效的金额！','.char-screen','\x0a\x0a#\x20情景感知:\x0a\x20\x20\x20\x20','\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心新增】在这里添加“背景”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22','char-music-progress-bar',']。目前投票的人有：','”的长期记忆中。','确定要删除这条记录吗？','vertical','\x22\x20id=\x22','\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','management-mode','请根据你的设定，写一篇新日记。','\x0a-\x20**长期记忆**:\x20','从\x20JSON.data\x20中提取图片数据','昨晚是平安夜。','\x22\x20class=\x22avatar-frame\x22></div></div>','https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是','找到图片文件:','<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>','（无文字内容）','生成模拟相册失败:','已拒收对方转账','transfer-amount','”。请你对此作出回应。]','✅\x20图片解压成功！','\x22\x20点赞了动态\x20#','werewolf-game-over-reason','chat-name-group','https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','\x20\x20-\x20在群聊“','编辑人设预设','非图片格式，跳过压缩:','确定要删除这条通话消息吗？','\x22\x20class=\x22chat-image\x22></div>','nai-steps','transfer','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','save-ai-response-editor-btn','blockReason','ai-frame-tab','color','import-world-book-input','togglePlayerFullscreen','{{user}}','此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。','voice','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22','lrcUpdateInterval','拼手气红包','<button\x20class=\x22sticker-category-tab\x20','EPhone-Full-Backup-','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','\x20[包含','\x22\x20data-commenter-display-name=\x22','bg-input','**\x20(本名:\x20','pollTimestamp','分钟前有人聊过。','add-new-group-btn','所有数据已成功恢复！应用即将刷新以应用所有更改。','》:\x0a','https://i.postimg.cc/B6T59xGK/IMG-7101.gif','》设定\x20(你可以将其中角色作为聊天对象):\x0a','chat','https://i.postimg.cc/nryNzTXK/IMG-6915.gif','world-book-card','https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','log','.call-record-card','ServiceWorker\x20注册失败:\x20','.product-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20','手动注入记忆时出错:\x20','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','commentIndex','button-order-editor','<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>','总结失败','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','\x20行格式不正确，已被忽略。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>','showScreen','设置群名','.nav-item[data-view=\x22qzone-screen\x22]','#message-editor-container\x20textarea','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','我是谁呀。','<input\x20type=\x22checkbox\x22\x20value=\x22','分享新鲜事...（非必填的公开文字）','sort','赶紧的充电，要饿死了','char-qq-screen','所有解码尝试均失败:','\x22\x20data-category-id=\x22all\x22>全部</button>','.qzone-post-item','”的聊天记录','import_card','npc-avatar-preview','设置已应用','提示词配置','groupAvatarLibrary','back-from-member-management','add-my-avatar-batch-btn','请开始整合。','reduce','custom_proxy_url','正在请求AI为新群头像命名...','thoughts','#chat-messages','-\x20**昵称:\x20','cancel-rule-editor-btn','仅清空\x20','\x0a\x20\x20\x20\x20-\x20**书名**:\x20《','isMinimized','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg','sticker','在同时执行两个函数时出错:','红包已被领完！','1px\x20solid\x20#e0e0e0','生成模拟App使用记录失败:','select-all-music-search','mouseleave','你是狼人，请选择刀人目标。','#search-results-list\x20.music-search-checkbox','分享成功','\x22\x0a-\x20**用户的备注**:\x20\x22','.quoted-message','text_image','quality','</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-','(回复\x20','visibility','<div\x20class=\x22red-packet-card\x20','发生了一个错误:\x20','album-screen','renderQzoneScreenProxy','songs','自定义数量','\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>','[表情]','AI\x20(独立行动)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','lrc-upload-input','chatRenderWindow','removeItem','zh-CN','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','内心独白','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','apiConfig','https://files.catbox.moe/r5heyt.gif','</span></div></div>','ceil','.text','聊了关于生日派对的事，我们约好了10月1日见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a','productId','API\x20返回错误:\x20','游戏即将开始，正在为各位玩家分配身份...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','btn-danger','waimai_response','manual-summarize-btn','\x20为您代付成功','更新通知文件中缺少\x20data-version\x20属性。','浏览器不支持电池状态API。','isPinned','member-management-screen','audio/mpeg','dynamic-font-style','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','\x0a##\x20来自《','\x20发起了外卖代付请求，商品是“','my-avatar-preview','minimax-api-key','\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','保存CSS预设','此操作将永久删除您选择的\x20','npc_','.poll-option-input','https://i.postimg.cc/13hhJ77p/IMG-4419.gif','.loader-container','cancel-shopping-settings-btn','download','\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20','</textarea>','https://i.postimg.cc/fyyGgW61/IMG-7115.gif','恭喜你，你赢了！','手动注入狼人杀记忆失败:','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','search-history-screen','[系统提示：你于时间戳\x20','总结长期记忆时出错:','对方消息预览','nightActions','countdown-card','清理失败','nai-custom-proxy-group','-\x20\x20\x20**公开发布NovelAI真实图片动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20[\x22图片1详细英文描述\x22,\x20\x22图片2详细英文描述\x22]}`\x20\x0a\x20\x20*\x20**prompt撰写**：你可以根据当前对话上下文、你的角色人设、以及你想表达的情感和氛围，来撰写详细而具体的prompt。详细程度由你根据具体情况自己决定，并不强制。\x0a\x20\x20*\x20例如：\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22','werewolf-role-reveal-list','animate-like','\x22\x20data-option=\x22','show-announcement-board-btn','成功将角色\x20','未知成员','发送照片','substring','aiPersona','opened','转发了\x20@','.entry-enabled-switch','update-notice-confirm-btn','board','import-data-input','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','.com/','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','gridEl','input[name=\x22visibility_group\x22]:checked','维基百科','\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','preset-editor-title','<span\x20style=\x22color:\x20red;\x22>已关闭</span>','\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>','prompts','regenerate-char-taobao-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','.edit-memory-btn','IMG','notification-avatar','poisonUsed','pat_message','link-content-input','\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','你领取了\x20','packet_timestamp','管理预设分类','announcement-actions-modal','Ephone','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>','高德地图','reply_content','innerText','\x0a#\x20群成员列表\x20(你的总结目标)\x0a','\x22\x20class=\x22realimag-image\x22\x20alt=\x22NovelAI图片分享\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22\x20title=\x22','[约定达成]\x20','/v1/chat/completions','[系统消息]\x20','transfer-btn','请输入你想对“','findIndex','frame_cat_ear','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>','\x0a\x0a现在，请以“','用户删除了自己的评论，开始清理AI记忆...','阵营胜利！','AI女巫决定使用解药！','清空动态时出错:','添加商品','werewolf-game-over-modal','[图片，描述:\x20','async','\x22\x20placeholder=\x22','memos','paste','left','预言家已行动，预言家请闭眼。','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','添加头像','生成模拟淘宝记录失败:','duration','\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>','请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)','nai-seed','confirm-witch-poison-btn','icon-settings-grid','https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','确定要结束这个投票吗？结束后将无法再进行投票。','正在为角色“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','openNpcEditor','confirmText','https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','</td></tr>','\x20(已忽略版本:\x20','你撤回了一条消息','countdown-title-input','”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a','album-photo-input','world-book-tab','等待对方处理...','chat-lock-overlay','preset-category-select','thoughts-history-list','clientY','请先在购物车中选择要结算的商品。','proxy-url','group-avatar-library-grid','simulatedTaobaoHistory','平票或无人投票，此轮无人出局。','char-music-current-time','\x20(时长:\x20','AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:','long-term-memory-screen','确认覆盖','\x22\x20(群名)\x20的消息。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a','https://i.postimg.cc/PxZrFFFL/o-o-1.jpg','2-digit','删除动态','transfer-confirm-btn','activeChatId','reply-preview-bar','.loading-spinner','CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。','预言家','并评论说：\x22','分钟前',')，祝福语是：“','linesPerPage','offsetTop','https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','chat-settings-screen','https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','\x20的消息:\x20\x22','participants','writeText','狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20','call-message-bubble\x20ai-speech','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','paused','save-shopping-settings-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>','发送好友申请','.playlist-item','.message-bubble[data-timestamp=\x22','请输入新的封面图片链接','remove','✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)','https://...','\x22\x20class=\x22avatar-frame\x22></div>','\x22></div>','favorites-search-input','.sender','-\x20你的狼队友是：','</option>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20可用表情包\x0a\x20\x20\x20\x20\x20\x20\x20\x20','select-all-chars-for-clear','https://i.postimg.cc/CKgDNYVb/IMG-5577.gif','https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','highlighted','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','\x20天的讨论环节。\x0a','toggle-blur-btn','is-waimai-request','group-avatar-group','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','isOpen','isSpectatorGroup','”发送的、尚未领完的红包（时间戳:\x20','\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a2.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【','\x20.message-bubble.ai\x20$1','auto-memory-interval','regenerate-btn','”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]','用户已忽略版本:\x20','<div\x20class=\x22post-images-grid\x20grid-','douban-settings-btn','检测到并成功修复了\x20','\x27的评论，内容是：“','direct','\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','simulatedBrowserHistory','请输入一个有效的、未来的日期！','existing-product-categories-list','getDate','var(--text-primary)','https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','选择要精炼记忆的角色','\x20(图片描述:\x20\x22','https://i.postimg.cc/63NmX03s/IMG-4366.gif','获取AI狼人目标失败:','#52c41a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','至少需要保留一条消息。','nai-test-error','该消息发送已超过2分钟，无法撤回。','nai-sampler','groupHeader','photos','狼人杀AI讨论生成失败:','选择一个开场白','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>','update_thoughts','创建新聊天\x20(第1/2步)','”的转账。]','抱歉，未能找到相关歌曲。','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','targetId','请根据你的设定，生成你的备忘录内容。','nai-resolution','精炼失败','group-avatar-library-title','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','[语音]\x20内容:\x20\x22','chat-settings-modal','levelchange','https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','正在解压图片...','上一条消息的发送时间是\x20','music-player-song-title','extensions','内容加载失败...','notification-sound-player','killedId','content','bg-clear','gomoku_move','share-link-btn','custom-frame-upload-input','群成员','hunter','variation-selected-price','avatar-frame-modal','请输入备忘录内容','.selected','isPlaying','pause','compressed','contact-picker-item','总结成功','#preset-tabs\x20.world-book-tab','.frame-item:has(.delete-btn)','antidoteUsed','status_text','现在，请所有AI角色针对刚刚的发言（特别是\x27','parts','photos-grid-page','nai-custom-proxy-url','cancel-reply-btn','update_status','<p\x20class=\x22char-browser-image-description\x22>','标题是必填项哦！','天\x20-\x20夜晚','导出数据时出错:','确定要删除这个约定吗？','https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','data-clear-wizard-modal','请根据你的设定，生成模拟聊天记录。','在这里输入语音内容','\x20的红包已被领完','...]','api-temperature-value','https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','某个时间','”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。','已成功导出所有数据！','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“','\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a','\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','day','renderChatListProxy','\x22\x20的整个对话吗？此操作不可撤销。','创建新规则','”的当前状态已更新为：','reading-overlay','”分享TA的私人歌单...','cancel-werewolf-lobby-btn','lucky','accepted','.comment-sticker-btn','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20如果选择评论，优先回复那些提到了你或回复了你的评论。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20','share-link-modal','toLocaleString','，人设:\x20','书名不能为空！','cors_proxy','compress-images-btn','”的身份，开始你的客观总结。','删除分类后，该分类下的所有预设将变为“未分类”。确定吗？','getPropertyValue','<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27','tables','”思考后决定暂时不发送好友申请，将重置冷静期。',',\x20内容摘要:\x20“','songJson','.variation-name-input','[ERROR:\x20','categoryId','preset-tabs','-\x20你昨晚守护了\x20','转账已被拒收','此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。','transcript','”生成商品？','export-single-chat-btn','」听歌。要结束并开始和「','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','导入成功！','pending_ai_approval','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','lineTo','chat-interface-screen','”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22','#npc-association-list\x20input:checked','\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a','revokeObjectURL','\x20条)','stickerId','.countdown-card\x20.timer','isBgClear','preset-avatar-input','API未配置','novelai-api-key','my-frame-grid','poisonedId','--music-bg-image','本地歌曲源错误:','https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','豆瓣小组','编辑\x20NPC','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：[','listen-together-btn','offlinePresetId','world-book-checkboxes-container','linkedWorldBookIds','”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','主题预设已保存！','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>','cancel-post-action-btn','模拟器心跳\x20Tick...','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“','通话记录','type','nai-test-result','\x0a-\x20散记:\x20','\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a','.comment-delete-btn','predicate\x20must\x20be\x20a\x20function','lyrics-btn','\x0a\x0a\x0a\x20#\x20【格式铁律\x20(最高优先级)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，格式如下:\x0a\x20\x20\x20\x20`[{\x22type\x22:\x20\x22offline_text\x22,\x20\x22content\x22:\x20\x22在这里写入你创作的、混合了对话和描写的完整段落。\x22}]`\x0a2.\x20\x20**【内容风格】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由地将对话穿插在描写的任何位置，实现自然分段。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a3.\x20\x20**【禁止】**:\x20绝对禁止在\x20`content`\x20字段中出现\x20\x22dialogue\x22\x20或\x20\x22description\x22\x20这两个词。\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**','”下，回复了\x27','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>','编辑消息','douban-detail-back-btn','activePostId','删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？','https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','\x0a-\x20**可以刀的玩家列表**:\x20','#gift-recipient-list\x20.contact-picker-item','openCharApp','browser','nickname','favorites-list','相册已成功删除。','is-ai-image','text/event-stream','从角色卡导入\x20(.json/.png)','我已了解风险，确认压缩','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','Character\x20Avatar','https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','skipped',')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a','.post-mode-switcher','\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a','批量导入格式错误，已跳过此行:','paid','qzone-avatar-container','\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22','今天\x20','\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员2\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20','\x22)\x20作为角色名。消息内容:','选择导出方式','.remove-option-btn','pageX','join','itemName','\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','#ccc','publisher','天黑请闭眼...','.search-result-item','.clear-posts-item','https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','一位成员','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','专属红包:\x20给\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',')\x20拒绝了\x20','link','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥','\x20位角色的记忆中。','new-sticker-category-name-input','请选择一个接收人！','white','proxyUrl','https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','代付请求已被拒绝','查验结果','world-book-category-pane','#chat-input-area','isSeparator','userStickers','lastGuardedId','投票结果','announcement-board-modal','alternateGreetings','slice','char-chat-list','<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','price','请输入\x20歌名\x20或\x20歌名-歌手','delete-world-books-modal','minimaxVoiceId','fetch-secondary-models-btn','一点心意','请根据你的设定，生成你的淘宝购买记录和余额。','<span>已</span><span>超</span><span>时</span>','black','relationship','(无内容)','appearancePresets','open_red_packet','-\x20\x20\x20**NovelAI真实图片分享\x20(在聊天中直接发送)**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20-\x20**【绝不能暴露是novelai生成的图片！】\x0a\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20-\x20使用场景：当你想要在【私聊对话中】直接给用户发送一张图片时使用。\x0a\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。\x0a\x20\x20\x20\x20-\x20注意：这会直接在聊天记录中显示图片，而不是发布到动态。','char-wallet-screen','请选择一个目标。','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>','group-character-nai-prompts-btn','基础数据不完整，无法开始总结。','请添加歌曲','applicationReason','music-prev-btn','）刚刚撤回了一条消息。撤回前的内容是：','totalTime','group-action-cooldown-input','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','werewolf-game-over-close-btn','页面跳转','\x22\x20转发了动态\x20#','无法推进剧情:\x20','syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','请输入有效的URL。','无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20','profile-random-jottings','」的新会话吗？','lyricsPosition','cancel-message-action-btn','chat-list','https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','在执行组合操作时遇到错误:\x20','https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','album-art-btn','enableBackgroundActivity',')，并在对话中自然地体现出来。','shopping-category-count-input','lastFailedAction','photo-viewer-next-btn',')为你点了一份外卖作为【礼物】。外卖内容是“','消息时间戳\x20','is-acting','preset-name-input','<span\x20class=\x22lucky-king-tag\x22>手气王</span>','请输入有效的金额(必须大于0)！','cphoneWallpaper','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','https://i.postimg.cc/yx2m4nbs/IMG-7231.gif',')\x20时出错:','”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20','linked-memory-selection','我们的回忆','屠边局：狼人杀死所有神职或所有平民即获胜。','worldBookCategories','\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>','音频播放失败:','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>','”]\x20','\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>','https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','添加人设预设','stream','小于1分钟',')**:\x20','此操作会将选定的\x20','doubanMinPosts','rgba(0,\x200,\x200,\x200.4)','startTime','\x20发送了一条语音，内容是：\x27','\x0a---\x20复盘结束\x20---','\x20的图片消息替换为文字描述...','https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','.waimai-details-btn','copy-timestamp-btn','https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif',')\x20的可用表情:\x0a','add-sticker-batch-btn','voiceId','url(','finally','<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>','dataset','post-local-image-input','locationName','douban-screen','请先在API设置中配置好API信息。','qzone-post-item','未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a','fullscreen-active','status_msg','participant-avatar-wrapper','请开始总结。','theme','paidBy','confirm-hunter-shot-btn','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','input[value=\x22','这个分类下还没有表情哦~','isOfflineMode','naiSettings','.ai-generated-image','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>','npc-editor-modal','utf-8','对方本名不能为空！','padStart','请输入有效的字体URL。','recalledData','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','is-realimag','border-box','你们已经有','AI返回的内容中未找到有效的JSON对象。','https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','.participant-avatar-wrapper[data-participant-id=\x22','rp-group-amount','导演模式','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','-\x20你们昨晚尝试攻击的玩家是：','转发成功！','请输入有效的图片URL！','commentCooldowns','offline-mode-group','horizontal','Asia/Shanghai','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','var(--accent-color)','Cphone数据\x20(CPhone)','检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。','确认总结','form-button','\x20为你切歌:\x20《','update-notice.html?_=','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','群昵称不能为空！','150','toLowerCase','15px','secondaryApiKey',':</span>\x20','相册名称不能为空！','group_call_request','actionCooldownMinutes','--chat-font-size','https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','parse','原始消息已删除或不存在','邀请你视频通话','</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','恭喜发财，大吉大利！','chat-list-title','组件图片已更新！','-\x20你昨晚用毒药毒了\x20','导入歌词','novelai-model','删除世界书失败:','call-history-list','blockCooldownHours','\x22>...</div>','确定要恢复默认设置吗？','\x22\x20的后台活动开关已关闭，本次跳过。','\x22\x20class=\x22chat-image\x22>','\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“','api-key','publish-to-announcement-btn','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20','simulatedAmapHistory','人局，身份为\x20','（当前帖子还没有路人NPC发表评论。）\x0a','#\x20场景设定\x0a','set','\x22\x20触发带理由的好友申请决策流程...','保存主题预设','font-preset-select','custom-modal-title','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22','\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','该条记录已成功删除。','maxMemory','结束投票','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','offlineMaxLength','checkout-btn','gomoku-overlay','(这张照片没有描述)','\x20的红包','meaning','将清空选定角色的所有动态、评论和点赞。','【原动态内容:\x20','https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','totalBalance','member-editor','直接使用\x20base64\x20数据','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','清理完成','battery-alert-modal','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','shoppingProductCount','ai-frame-content','diary',')\x20送出了一份礼物，收礼人是：','defineProperty','group-avatar-preview','删除\x20(0)','已经一起听了','当前时间是\x20','keys','将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。','》的歌词已成功保存！','confirm-prophet-check-btn','table','将分类\x20“','\x20转发了\x20@','share-target-modal','https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','.entry-content-textarea','AI决策','taobao','address','https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','提取的图片大小:','.poll-card','\x20的日记','announcement-action-delete','申请失败','transform','导入成功','确定要删除与\x20\x22','生成购物中心商品失败:','theme-default','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a',',\x20价格:\x20¥','close-sticker-panel-btn','更换“','preset-action-edit','open-persona-library-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>','nai-diffusion-4','https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','startsWith','\x20获胜。也就是说，','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','existing-sticker-categories-list','font-size-value','\x22\x20的记忆中清除了1条关于已删除评论的通知。','wait-reply-btn','qzone-post-container','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','targetDate','\x22\x20决定去发一条动态...\x20(此处为模拟)','witch-do-nothing-btn','分组\x20\x22','\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20','isArray','\x0a#\x20可用表情包\x0a\x20\x20\x20\x20','\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20','...”)','\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22','.avatar','uncategorized','说说内容不能为空哦！','qzone-back-btn','https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>','\x20天\x20---**\x0a','请输入新的内容：','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','\x0a\x0a#\x20当前情景\x0a','add-ai-avatar-upload-btn','\x0a-\x20**最近与用户的互动**:\x20','key','https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','is-sticker','2620842LpCCHg','https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','npc',')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','upgrade','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>本地图片(头像/表情/头像框/等)大小:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22><strong>','days','”的好友请求','错误：找不到要转发的原始动态。','clear-posts-list','...\x22):\x20','simulatedMusicPlaylist','generativelanguage','werewolf-log-entry\x20system','\x0a\x0a现在，请开始生成这组足迹记录。','chat_message','artist','char-amap-item','gameMode','\x27刚刚评论了你的动态“','world-book-category-manager-modal','role','</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20','播放被中断，这是正常行为:','新建备忘录',']\x20(ID:\x20','draggable-button-item','world-book-tabs','world-book-group-container','recall-message-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','busy','<span\x20class=\x22speaker\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','image-mode-content','删除NPC',')}。\x0a-\x20**对话状态**:\x20','music-player-overlay','https://i.postimg.cc/T2yKJ0DV/40.jpg','npc-association-list','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','AI\x20尝试使用一个不存在的表情:\x20\x22','\x27刚刚在你的动态“','确认生成','.format-btn','selected','确认送出礼物','♪\x20歌词位置预览\x20♪','你查验的玩家\x20','transfer-actions-modal','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20','正在呼叫...','memberId','https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','https://i.postimg.cc/xjpN4swz/IMG-7240.gif','startDiscussion','https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','mouseout','https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','*对方按下了接听键...*','gameover','网易云音乐API未返回有效结果:','transparent','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>','\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22','检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。','AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。','%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>','current','enableAiDrawing','请输入一个有效的数字（建议大于20）。','image-upload-input','确定要将“','onloadend','外观设置已成功导入并应用！','\x22\x20生成行动失败:','-\x20**时间**:\x20你必须感知到当前是\x20','请输入头像的图片URL','commenterDisplayName','屠城局：狼人杀死所有好人即获胜。','<p>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','frame-action-bar','offline','textAlign','background-activity-switch','\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','✅\x20图片显示成功！🎨','qzone','suffix','message-wrapper\x20','shopping-screen','https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','”\x20吗？','正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...','搜索歌曲','\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','setAttribute','button','<span\x20style=\x22color:\x20green;\x22>是</span>','确定要删除预设\x20“','isHidden','导出世界书时出错:','\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22','stickerCategoryIds','女巫已行动，女巫请闭眼。','创建旁观群聊\x20(我围观)','这将用备份文件中的数据【完全覆盖】当前与“','https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','8px','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','post-upload-local-btn','配置错误','preCallContext','rp-details-list','favorite-diary-btn','anime\x20person','没有可供重新生成的AI响应。','novelai-test-btn','”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','User\x20Avatar','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>','change_group_avatar','delete','players','video-call-main','此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？','https://api.minimax.chat/v1/text_to_speech?GroupId=','\x0a-\x20**人设**:\x20','发来了\x20','edit-post-btn','</td><td\x20class=\x22item-price\x22>¥','char-music-player-modal','bulkAdd','char-music-list','utf-16le','\x20行的格式不正确，已被系统跳过。','char-diary-list',')，开始总结...','识图优化：正在将时间戳为\x20','你通过了“','请稍候','focus','在此修改内容...','https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','歌曲信息','mousedown','reading-restore-btn','ai-response-editor-container','保存\x20API\x20预设','lyric','getUint32','https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','songName','regenerate-douban-btn','random_jottings','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','transfer-cancel-btn','请至少选择一个要清空的范围。','确定要从头像库中删除“','scope','sticker-action-bar','currentX','enabled','preset-action-delete','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','\x20\x20\x20正面:','确定要删除这条渲染规则吗？','成功移除了\x20','unreadCount','getVotes','.nav-item[data-view=\x22memories-view\x22]','packetType','favorites','activeAlbumId','shuoshuo','variation-increase-qty','要为《','myAvatar','在此修改，或点击上方按钮使用格式模板...','\x20领取了\x20','后台活动:\x20角色\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','pointer','确定要删除这条评论吗？','sticker-binding-modal','确定要永久删除分类\x20“','\x20(回复\x20','NPC\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。','register','(Timestamp:\x20','刷新页面？','无人接听群聊邀请。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','\x22\x20已经存在了，换个名字吧！','AI返回的刀人目标格式不正确。','\x0a-\x20**你的曾用名**:\x20[','novelai-generated-','++id,\x20name,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp','last','\x20同步所有群聊内的头像...','</div>','originalTimestamp',')\x20商品:\x20','确定要永久删除商品\x20“','.battery-text','已选择\x20','qzonePhotos','<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20','@[[','variation-selection-modal','switch-greeting-group','reason','\x20本世界书已成功删除。','即将开始下载您的完整备份文件。下载过程中请勿关闭页面。','createDocumentFragment','已阵亡，还有30秒爆炸','change-frame-btn','\x20的动态\x20(NPC)','.link-share-card[data-timestamp]',']\x20的正则表达式无效:','https://www.myinstants.com/media/sounds/notification-sound-2.mp3','https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','template','add-poll-option-btn','doubanMaxPosts','找不到匹配的表情','pat-btn','ai_generated','image/jpeg','world-book-name-input','请修改记忆要点：','生成第','usage','translateY(','chat-group-container','hasListener','”申请好友时发生错误：\x0a\x0a','tagName','#sticker-binding-chat-list\x20.sticker-binding-checkbox:checked','正在全网搜索歌曲资源...','<div\x20class=\x22post-main-content\x22>','count','\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','poll_timestamp','\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。','albumId','conversationIndex','请输入相册名称','》\x0a\x20\x20\x20\x20-\x20**','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“','groupNickname','#douban-cast-list\x20.douban-cast-checkbox:checked','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','清空动态时发生错误:\x20','\x20的动态\x20','导演模式保存(Sticker):\x20使用了编辑器提供的完整JSON\x20(url\x20+\x20meaning)','block-cooldown-input','\x22\x20已经存在了！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“','\x0a###\x20详细对局流程:\x0a','<span\x20class=\x22spoiler\x22>$1</span>','从完整链接批量导入','(你是第一个发言的人)','center','chat-messages','npc-persona-input','请输入标题','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','++id,\x20name','date-search-input','你赢了','小红书','请输入歌名','select-all-stickers-checkbox','myNickname','https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','已被用户删除','**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','add-my-avatar-url-btn','你已死亡，正在围观...','\x0a##\x20---\x20关于“','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','naiimag','change_avatar','来自动态','.contact-picker-item','decline','npc-background-activity-switch','#\x20长期记忆\x20(必须严格遵守)\x0a','狼人杀','visibleGroupIds','playlist','模型列表已更新','NovelAI设置已保存！','等待回应','&id,\x20minimaxGroupId,\x20minimaxApiKey','add-new-product-btn','<span\x20style=\x22color:\x20green;\x22>已开启</span>','save-frame-settings-btn','网易云音乐搜索失败:','close-category-manager-btn','请输入一个\x202\x20到\x20','poll','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20','transfer-action-cancel','my-group-nickname-group','cancel-variation-selection-btn','你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','blob','📤\x20发送请求到\x20NovelAI\x20API','confirm-variation-selection-btn','昨天\x20','下棋历史\x20(x,y坐标均从0开始):\x0a','profile-history-icon-btn','<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>','AI已将新群头像命名为：“','\x22\x20吗？','selection-mode','++id,\x20name,\x20description','shift','旁观群聊至少需要选择2个成员。','fontUrl','novelai-key-toggle','请根据你的设定，生成你的浏览器记录。','\x27,\x20\x27bulangni\x27,\x20sans-serif','level','正在生成“','identifier','https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','共享位置','indexOf','开始检查并迁移旧的红包数据...',')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','\x20的浏览记录','message-editor-modal','char-wallet-content','k_euler_ancestral','https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','\x20//\x20<--\x20【核心】注入世界书\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','delete-group-btn','https://i.postimg.cc/wx72fhr2/IMG-5968.gif','participant','sticker-binding-chat-list','sticker-category-tab','[发送了一条复杂消息，如卡片或转账]','incoming-call-modal','\x20剩余红包将在','长期记忆','未知用户','商品已删除。','claimedBy','#fullscreen-lyrics-container','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>','📋\x20请求体:','save','is-card-like','browser-screen','https://i.postimg.cc/kGgwJhPH/IMG-4374.gif',',\x20记录数:\x20','lyrics-offset-input','.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar','Enter','ai_image','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>','#e4b591','\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**','ai-original-name-input','borderColor','shared-history-viewer-content','++id,\x20albumId','findLastIndex',')\x20已被用户忽略或为旧版本，无需显示。','✅\x20NAI提示词：使用角色配置','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','npc-list-view','renderWorldBookScreenProxy','background','轮到你发言了...','-\x20(记录于\x20','检测到群聊\x20\x22','delete-css-preset-btn','index','.qzone-post-delete-action','[图片]','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','[私聊]','cphone-wallpaper-upload-input','local','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','linkedMemoryChatIds','.participant-avatar-wrapper\x20.participant-avatar','char-diary-detail-content','你让大家继续讨论...','https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','keyword-search-input','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','px)','bubble_theme','arrayBuffer','.participant-avatar[data-participant-id=\x22','npc-list','npcId','my-avatar-library-modal','werewolf-witch-modal','</small>','parentElement','save-preset-btn','getTime','我拒绝了你的视频通话请求。','qzoneGroups','】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22','offline-min-length-input','\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20','[系统提示：用户（','文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。','product-grid','</em>','未使用','linkedWorldBookId','playMode','https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','post-image-desc-group','给你准备了一个红包','当前页内容摘要','readingLibrary','clipboard','add-my-avatar-upload-btn','票):\x20','❌\x20动态NAI图片生成失败:','\x0a\x0a现在，请开始生成这组备忘录。','update-notice-modal','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>','found','save-nai-settings-btn','all','.photo-delete-btn','cancel-create-countdown-btn','qzone-post-delete-action','请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。','werewolf-game-btn','\x20小时了。','favorites-view','）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a','高级数据清理失败:','日\x20---','\x0a#\x20你的核心任务\x0a你正在扮演角色“','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20','upload-global-bg-url-btn','frame-item','天\x20-\x20投票','authorName','voteResults','group-cooldown-group','-\x20**当前歌词**:\x20\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','battery-alert-text','等人的礼物','chat-lock-content','minimaxModel','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>','Minimax\x20TTS\x20API\x20调用失败:','你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','\x0a-\x20**世界观**:\x20','-\x20**对话状态**:\x20你的上一条消息发送于\x20','<span\x20class=\x22commenter-name\x22>','此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>','order','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','更换专辑封面','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','manage-sticker-categories-btn','reset-button-order-btn','群里在','offline_text','bulkPut','frame_12','”的网上冲浪足迹...','✅\x20NAI图片','\x0a\x0a其专属的“世界书”也已自动创建并关联。','https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png','这个预设文件中没有找到任何有效的提示词条目。','\x20中找到世界书。','removeEventListener','json','target','正在开始清理冗余数据，请不要关闭页面...','ai-frame-grid','.select-box','lyric-line','\x22\x20data-memory-timestamp=\x22','#avatar-frame-modal\x20.modal-body','[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','char-conversation-partner-name','add-char-memo-btn','#custom-modal\x20.custom-modal-footer','未知错误','lrc','add-group-avatar-upload-btn','.icon-preview','保存字体预设','setProperty','summaries','已切换到新的开场故事！','.variation-image-preview','https://generativelanguage.googleapis.com/v1beta/models/','option','331422dRzMgS','chargingchange','[系统提示：你拒绝并退还了“','\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','❌\x20NAI图片生成失败:','post-use-url-btn','###\x20你的秘密信息\x20(此部分只有你作为AI导演能看到)\x0a','角色专属NAI提示词已保存！','</div></div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','music-exit-btn','\x0a[图片]','\x22\x20的本次后台活动跳过。','API\x20调用失败','https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','Caching\x20rendering\x20rules\x20for\x20chat:\x20','♪\x20♪\x20♪','charging','product-category-select','add-new-category-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','save-world-book-btn','code','-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20','现在开始讨论，请各位玩家依次发言。','分组名不能为空！','shoppingCategoryCount','没有聊天了。','Bearer\x20','frame_6','**[夜晚]**\x20平安夜。\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','isUserParticipating','photo-viewer-prev-btn','question','”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','约定达成！','\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20','https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','.message-editor-block','书库是空的，点击“导入新书”添加第一本吧！','handleListenTogetherClick','旁观模式AI发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','ZIP文件中未找到图片','\x22)。操作已被程序阻止。','album-grid-page','\x20的身份是：','</span></div><div\x20class=\x22rp-type\x22>','myAvatarLibrary','block-chat-btn','global-bg-input','variation-select','accept-friend-btn','</p>','评论内容不能为空哦！','.status-text','mouseup','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','getBattery','”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','newSize','ai-voice-id-input','originalPost','对方撤回了一条消息','regex','currentPlayer','single','rules-tab\x20active','\x20已复制到剪贴板。','ttsCache','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','speech-01','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','pageY','智能导出\x20(推荐，速度快，内存占用小)','post-remove-image-btn','ZIP解压失败:','规则名称和正则表达式不能为空！','旁观模式推进剧情失败:','character-grid','delete-track-btn','handlePacketClick','\x22]:checked','lyrics-active','/v1/models','min','\x22\x20创建成功！','.favorite-item-card','确认精炼记忆？','.call-message-bubble[data-timestamp=\x22','caller-avatar','https://i.postimg.cc/05DLr0yj/IMG-4427.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','isClosed','正在请求AI角色们加入讨论...','body','animate-in','preset-entries-container','https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','文章标题','<div\x20class=\x22custom-title\x22>','light','找不到相册:','data-clear-type-list','icon-setting-item','。请收礼的角色表示感谢，其他角色可以自由发挥。]','base_resp','cancel-create-poll-btn','cancelText','无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20','\x0a-\x20**你们最后的对话摘要**:\x20\x0a','在动态评论区点击了表情，但在表情库中未找到对象:','完成(','请至少选择一位收礼人。','gomoku-board','你刚刚接听了用户的视频通话请求。','disable','.qzone-post-container','###\x20最终结果:\x20','---\x0a','###\x20玩家身份配置:\x0a','[表情]\x20含义:\x20\x22','groupId','changedTouches','篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','动态发布成功！','✅\x20NAI提示词：使用系统配置','长截图生成失败:','werewolf-finish-speech-btn','#vinyl-view\x20#music-player-cover','\x22\x20data-commenter-original-name=\x22','Content-Type:','create-poll-modal','您的旧有记忆已被完整保留，未作任何修改。','”下，发送了一个表情评论，意思是：“','secondaryModel','未知歌手','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x22\x20(由\x20','char-product-grid','诊断：未在此角色卡中找到任何有效的世界书数据。','longTermMemory','-\x20\x20\x20**NovelAI图片分享**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22name\x22:\x20\x22你的角色名\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20【禁止暴露这是novelai生成的图片!】\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20使用场景：当你想要基于当前对话情景、你的性格或上下文分享一张图片时使用。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。','gameLog','\x20的动态\x20(用户)','werewolf-game-title','.message-bubble.is-link-share','你们没有在读书。','UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...','请你对此作出回应。]','.cart-item-checkbox','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','加载失败','#fullscreen-lyrics-container\x20.music-lyrics-list','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“','📋\x20直接粘贴歌词文本','trans','检查完成','请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。','导演模式保存了一个无效的五子棋移动指令:','</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>','.modal-header\x20span','<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','product-variations-container','\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22','currentLyricIndex','\x20条旧的红包消息！页面将自动刷新以应用更改。','.photo-thumb','put','AI\x20尝试评论一个不存在的表情:\x20\x22','voted','昨晚是平安夜','world-book-content-container','这是模拟对话，无法发送消息哦~','</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','pinned','https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“','novelai-details','CELL_SIZE','》吗？','\x0a\x0a##\x20世界书:\x20','douban-cast-select-btn','video_call_response','input[name=\x22theme-select\x22][value=\x22',')，内容摘要是：“','gift-recipient-modal','avatar_name','https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','sticker-category-tabs','ephone','<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>','\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22','[发送了一张图片，描述为：','”的购物习惯...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>','input[name=\x22theme-select\x22]:checked','\x22\x20发布了动态','\x20将群名修改为\x20“','disabled','rp-content-group','精炼成功','\x0a\x0a#\x20','.entry-comment-input','\x20行的格式不正确，已被跳过。','friend','announcement-board-content','speaking','close-group-manager-btn','apiTemperature','群聊\x20\x22','hasShown20','[你发送了一条语音消息，内容是：\x27','save-font-btn','”已向你发送好友申请。请返回聊天列表查看。','spectator-propel-btn','aiAvatarLibrary','\x0a-\x20**帖子内容摘要**:\x20','(暂无评论)','canvas','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg','📁\x20从本地上传','\x22,\x20\x22postId\x22:\x20456,\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a','memory-list-container','book-upload-input','anno_','所有通话记录','find','drawImage','rule-chat-id-select','some','一些之前的消息已被用户删除。','toggle','”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a4.请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','pending_user_approval','导入数据时出错:','input[name=\x22visibility\x22]','frame_10','memories-back-btn','icon-img-','rp-tab-direct','**[讨论环节]**\x0a','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','”图标','请输入歌手名','确定要删除这个人设预设吗？此操作不可恢复。','<span>删除</span>','https://i.postimg.cc/PJppkbvn/IMG-6918.gif','var-','请先配置NovelAI\x20API\x20Key！','.post-deleted-placeholder','请根据以上设定，生成商品数据。','char-album-screen','#b5b5b5','个月前','show-avatars-btn','保存外观预设','cancel-share-target-btn','https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','https://i.postimg.cc/3NDQ0dWG/image.jpg','product-editor-modal','member-avatar-preview','你们正在一起读书。','请用文字描述您要发送的照片：','updateListenTogetherIconProxy','match','\x0a建议刷新页面以确保所有更改生效。','\x0a##\x20','输入图片URL','确认替换','.icon-setting-item','offsetHeight','cancel-product-editor-btn','<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20','游戏记忆已成功注入到\x20','lastIndexOf','replaceChild','translateX(','\x20发布了一条新动态]','从旧版本迁移的条目','new_name','copy-post-btn','\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','创建群聊至少需要选择2个联系人。','douban-detail-author','\x20---\x0a','<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>','import-card-input','trim','regenerate-char-qq-btn','favorite-memo-btn','\x22\x20记录了一条新回忆:','apiKey','检测到新版流式备份文件，开始导入...','comment','cart-item','角色\x20\x22','删除照片','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','用户刚刚接听了你主动发起的视频通话。','\x0a###\x20条目:\x20','旁观模式AI尝试使用不存在的表情:\x20\x22','歌单已生成，正在从网络获取\x20','delete-selected-products-btn','marginTop','toBlob','无法解析预设文件。\x0a错误:\x20','表情含义','[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“','确定要从收藏夹中移除这\x20','music-playlist-btn','正在发牌...','https://i.postimg.cc/DZshzKv6/IMG-5576.gif','回复\x20','生成模拟浏览器历史失败:','错误:\x20','startX','https://i.postimg.cc/zvWGPjms/IMG-7090.gif','memory-card','####\x20','\x22><div\x20class=\x22member-name\x22>','修改图片','regenerate-char-amap-btn','https://i.postimg.cc/50k390X8/IMG-6376.gif','execute-search-btn','charAt','currentDay','<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>','.screen','\x0a-\x20**人设\x20(必须严格遵守)**:\x20','linked-chats-checkboxes-container','from','请填写完整的约定标题和日期！','已成功从\x20Tavern\x20AI\x20文件导入设定集《','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','image_prompt','未找到相关收藏','胜负未分','visibilityState','压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...','(无标题)','placeholder.png','将歌曲切换为了《','\x20条长期记忆发送给AI，总结成大约\x20','\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','fileType','”请求添加你为好友：<br><i>“','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>','cancel-member-settings-btn','usageTimeMinutes','close-call-transcript-btn','https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','create-countdown-modal','dblclick','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22','”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20','inline-flex','margin','models','UTF-8\x20解码成功。','&id','npcs','\x22\x20的独立行动失败:','selection-soft-delete-btn','#reading-window\x20.reading-header','assign-group-section','import-preset-input','add-countdown-btn','native','grayscale(100%)','my-group-nickname-input','src','\x20\x0a-\x20存活玩家:\x20','vinyl-view','batch-import-frames-btn','这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？','[图片生成失败:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','\x0a\x0a现在，请生成这份歌单。','receiver','图片解压失败:\x20','ai-avatar-library-title','pin','上传成功！','状态已更新','”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>','\x0a#\x20用户的角色\x0a-\x20**','switch-greeting-btn','确认删除分类','chat-list-screen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','steps','50%','见面”）。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过100个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','switchToCharHomeScreen','customName','旁观模式收到未知指令类型:','https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif','value','delete-btn','\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a\x0a//\x20【核心修改2】明确了JSON格式中\x20speaker_name\x20和对话中称呼的不同要求\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20','AI\x20(','ruleId','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','music-search-results-modal','”的TTS功能已关闭，已禁止发起TTS请求。','”才能使用\x20\x27open_red_packet\x27\x20指令领取。]','推进剧情失败:','确认拉黑','[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','preview-font-style','world-book-category-select','精炼“','帖子详情','从\x20JSON.image\x20中提取图片数据','https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','getMinutes','棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a','data:','8FCFeIH','<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>','exec','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','AI返回了空的或格式不正确的总结内容。','recordId','message-bubble\x20system-bubble','add-group-avatar-url-btn','imageUrl','\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a','manage-preset-categories-btn','right','group-avatar-library-modal','x-social-screen','manage-groups-btn','\x20元。此订单已完成。]','werewolf-selection-item','AI\x20角色\x20\x22','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','en-US','moveTo','shopping-settings-btn','decline-call-btn','...”','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','\x20红包已被领完，手气王是\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【身份铁律】】】**:\x20用户的身份是【','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>计算图片大小时出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>Error</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','anonymous','qzone-more-actions-btn','https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','music-play-pause-btn','world_info','。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','change_user_avatar','prepend','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','请输入新的背景图片链接',']类型的消息。\x0a内容:\x20','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','”。只有“','[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]','<strong>','开始清理','导入已取消，因为未提供书名。','收到了未知的AI指令类型:','诊断：在\x20extensions.character_book\x20中找到世界书。','font-size-slider','【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！','<br>','有点饿了，可以去找充电器惹','system','未知App','将清空选定角色的所有通话记录。','群里还没有任何消息。','clientWidth','<span\x20class=\x22diary-emphasis\x22>$1</span>','覆盖预设','[收到一个外卖代付请求]','.comment-send-btn','touchend','char-home-screen','.music-search-checkbox:checked','call','edit-call-message-btn','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>',')\x20成功抢到了\x20','cart-screen','”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','shoppingCategories','getWriter','preventDefault','existing-categories-list','.qzone-post-container[data-post-id=\x22','在聊天\x20\x22','API\x20请求失败:\x20','char-memo-screen','》\x20-\x20','reset-font-btn','abs','home-screen-pages','prophetCheck','https://i.postimg.cc/cLPP10Vm/4.jpg','search-results-list','prev-page-btn','\x22\x20class=\x22participant-avatar\x22\x20title=\x22','import-appearance-btn','regenerate-call-btn','decision','world-book-tab\x20active','AI\x20尝试赠送一个格式不正确的随机礼物:','操作失败:\x20','#chat-interface-screen\x20>\x20.header','</name>\x0a\x20\x20<persona>','gift','tts-audio-player','novelai-settings','编辑商品','lyrics-position-group','\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20','summary',']。当在对话历史中看到这些名字时，它们都指的是【你】自己。','EPhoneSingleChat','我们和好吧！','export-world-book-btn','simulatedAppUsage','cphoneAppIcons','offsetLeft','accept-call-btn','singer','recipients','https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','unblock-btn','floor','\x22\x20的独立行动API返回为空或格式不正确，本次跳过。','recalled_message','contactId','.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a',')\x20和情景的感知。','cssText','\x20的对话','EPhone-WorldBooks-','[语音消息:\x20','容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...','preview-bubble-style','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','恭喜！','wolfKill','cancel-persona-editor-btn','选择记忆所属角色','https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','.json','char-article-title','inline-block','AI返回的change_music指令中，歌曲名无效或缺失:','fullPrompt','player','my-avatar-input','ArrowRight','确认导入','应用已返回前台，正在检查更新...','linked-memory-count','statusText','splice','https://i.postimg.cc/05wnd389/IMG-4388.gif','\x27)\x22\x20data-comment=\x22','chatActionButtonsOrder','操作结果','https://api.vkeys.cn/v2/music/netease?id=','import-appearance-input','https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','请至少选择一个要删除的世界书。','#settings-preview-area','-\x20昨晚是平安夜，无人死亡。\x0a','通话于\x20','</memory>\x0a\x20\x20<recent_dialogue_with_user>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>','<span\x20class=\x22diary-highlight\x22>$1</span>','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','closest','characterNegativePrompt','最近的消息太少，无法进行有意义的总结。','is-red-packet','Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined','playlist-body','search-result-item','delete-current-category-btn','qzone_comment','*事件*:\x20平安夜，无人出局。\x0a','change','add-song-url-btn','checked\x20disabled','nextElementSibling','导入外观设置时出错:','originalSize','</span>:\x20','”\x20已成功导入！','werewolf-role-modal','张图片','font-preview','timeZone','记忆链接','https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','cancel-douban-settings-btn','通话中还没有你的发言，无法重新生成回应。','cancel-sticker-binding-btn','member-management-list','请输入群聊的名字','stores','后台活动模拟已启动，间隔:\x20','订单详情','确定要删除这条公告吗？此操作不可恢复。','静音音频已停止。','font','\x20->\x20','isBusy','change_user_nickname','文章摘要...','product-category-tab','已恢复默认字体。','add-existing-contact-btn','confirm-wolf-kill-btn','strokeStyle','werewolf-action-bar','setHours','这将从历史记录中【永久抹除】这\x20','操作成功','readAsText','API错误:\x20','\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22','.favorite-item-card.selected','char-browser-history','inject-thought-toggle','\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','replace','.action-icon','song_name','source_name','frame_5','and','isLocal','#outgoing-call-screen\x20.caller-text','change_music','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥','\x0a-\x20**内容摘要**:\x20','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“','toDateString','请选择今晚的目标。','API未配置，无法进行总结。','char-simulated-send-btn','description','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>','ZIP\x20Blob\x20大小:','visibleTo','.chat-group-content:last-of-type','char-main-date','8051450MRjrCm','确定要删除这张照片吗？此操作不可恢复。','这是你们的第一次互动。','album','处理NPC后台活动时出错:','cancelable','未发现任何需要修复的数据问题。','”添加记忆','beginPath','5px','variations','AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','NovelAI生成失败:','\x20个新表情！','selection-share-btn','cancel-contact-picker-btn','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥','”\x20的位置已发送到你们的聊天中。','click','scenario','test','confirm-create-countdown-btn','receiverName','来自\x20','https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','add-world-book-btn','album-item','\x22\x20更换了头像','global','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','.world-book-category-pane[data-category-id=\x22','分钟前聊过。','\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a','已打包表:\x20','请根据角色列表，生成豆瓣小组帖子。','data-clear-step-2','blur','删除头像','nai-smea-dyn','currentTime','width','”生成这组【与角色高度相关】的商品数据。','hours','apiPresets','**关键词:**\x20','cancel-advanced-editor-btn','https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','\x0a\x0a#\x20对话者的角色设定\x0a','.chat-group-content','music-visual-container','group-avatar-upload-input','对方已收款','网络图片\x20(CPhone)','\x20分享了一张NovelAI图片，prompt:\x20','删除日记','删除消息','压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...','https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','row','shopping-back-btn','getBoundingClientRect','\x20分钟)</span>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22','data:\x20','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','bottom','serviceWorker','游戏尚未结束，无法进行总结。','seed','onclick','正在接通...','prototype','”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','karras','offline-preset-select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。','”的特点生成专属商品...','\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20','witch-modal-title','\x0a-\x20**作者**:\x20','”\x20将对你的称呼修改为\x20“','请输入精炼后核心记忆的大致字数：','cancel-clear-wizard-btn-step1','<textarea\x20id=\x22','replyTo','music-player-cover','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','douban-detail-group','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','\x20条新消息','-\x20**对话状态**:\x20(暂无有效对话历史)','quantity','https://i.postimg.cc/90RBDh9K/IMG-6377.gif','NPC人设','target_name','&id,\x20url,\x20name,\x20categoryId','内容为空。','AI\x20尚未对您的最后一条消息做出回应，无法重新生成。','已成功加入购物车！','comments','.header','胜利！','\x22\x20alt=\x22','没有配置为后台活跃的角色，跳过模拟。','input[value=\x22user\x22]','[表情，含义:\x20','char-usage-screen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/sDFhySn3/IMG-6936.gif','复制成功','<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','.avatar-group','gift-recipient-list','char-background-activity-switch','qzone_like','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','-\x20**当前时间**:\x20','备忘录','确定要永久删除这条动态吗？','add-message-editor-block-btn','一个神秘的角色。','renderWallpaperScreenProxy','qzone-banner-img','https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','url','head','你们最近没有有效聊天记录。','sourceChatName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>','final','char-music-mode-btn','<option\x20value=\x22\x22>未分组</option>','这是群里的第一条消息。','\x0a##\x20世界书《','确定要永久删除选中的\x20','cancel-delete-world-books-btn','group-background-activity-group','vote','生成豆瓣帖子失败:','textarea','isTemporary','\x0a#\x20你的任务\x0a你是一个狼人杀游戏导演。你的任务是扮演【除了','请先输入你的发言内容。','sticker-item','）完成了支付。此订单已关闭，其他成员不能再支付。]','[发送了一张图片，描述为：\x27','1660617WpzbZD','world-book-category-pane\x20active','novelai-test-modal','myPersona','douban-my-comment-avatar','add-manual-memory-btn-header','dragging','tencent','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','无法找到对应的分享记录或记录已损坏。','memoryTimestamp','由于浏览器安全限制，AI切换的歌曲无法自动播放。请手动点击播放按钮\x20▶\x20继续欣赏。','chat-search-results-list','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','presetId','reset-theme-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','share-location-btn','获取AI投票决策失败:\x20','https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','querySelectorAll','string','通话记录已成功总结并存入角色“','clientHeight','\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','save-advanced-editor-btn','”，选项有：[','https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','抱歉，我拒绝了你的好友申请。','未知表情','下在(','SAFETY','top','ai-persona','传统导出数据时出错:','book_','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>','.post-nickname','关于“',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20(这是你的帖子)','当你死亡时，你可以选择带走场上任意一名玩家。','所有狼人已被放逐，好人阵营获得了胜利！','imageProcessed','.info','<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>','**内容:**\x0a','openRenderingRulesScreen','height','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','flex','normal','transition','(无标题投票)','GRID_SIZE','is-transfer','char-vinyl-container','0:00','正在导入表:\x20','角色专属','\x0a#\x20你的聊天对象（用户）的人设\x0a','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20','\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20','shopping-settings-modal','appearance-preset-select','gift-receipt-modal','selection-favorite-btn','wb_','fillRect','padding','onended','clearRect','mouse','new-group-name-input','成员们正在输入...','add-world-book-entry-btn','https://files.catbox.moe/','\x22]\x20.participant-avatar','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>','[情景提示]\x20','-speech','calls','https://image.novelai.net/ai/generate-image','fontSize','[群聊]','product-image-preview','appearance','assistant','change-icon-btn','🌐\x20使用网络URL','member-settings-modal','++id,\x20timestamp','图片内容','\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>','voter_name','contains','rp-direct-greeting','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','my-nickname-input','请在此处粘贴完整的LRC格式歌词...','通话记录已删除。','未知作者','POST','https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','link-title-input','确定要删除相册《','?key=','https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','manual','请输入预设名称','test-sound-btn','mode','<span\x20class=\x22group-tag\x22>群聊</span>','\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。','\x20发布了一条新公告','.gift-card','内容因安全策略被屏蔽。触发类别:\x20','char-browser-item','**:\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20的已删除动态','无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20','variation-options-container','open-memory-screen-btn','cart-title','offline-max-length-input','https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','请输入新的昵称','clear-posts-item','change_group_name','\x22\x20中发现并修复了旧红包数据。','onloadedmetadata','\x20请根据这个结果发表你的评论。]','refined','AbortError','\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片','\x22\x20创建了一个新约定:','请先填写NovelAI\x20API\x20Key！','avatar_prompt','heartfelt_voice','等待对方处理','生成中...','is-voice-message','正在分析“','确定要从播放列表中删除《','novelai-enabled','\x0a\x0a#\x20待整合的记忆要点列表\x0a','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','world-book-editor-screen','编辑规则','activeContainer','size','check-and-fix-data-btn','...\x22','转账:\x20','purchases','编辑通话消息','https://i.postimg.cc/76Tj3g1B/IMG-4425.gif','char-usage-list','-\x20(ID:\x20','chat-name-input','开始检查','https://api.vkeys.cn/v2/music/tencent?id=','<s>$1</s>','确认删除','https://i.postimg.cc/XY63sTS3/IMG-4393.gif','[你发送了一个表情，意思是：\x27','请根据你的设定，生成你的相册内容。','[系统提示：','当前通知版本\x20(',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','translateX(-','userAgent','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','photo-item','isNpc','</p><p>','生成截图时发生错误，请检查控制台获取详情。','-\x20**长期记忆\x20(必须参考)**:\x20','cancel-music-search-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','操作失败','文件格式不正确，这不是一个有效的单聊备份文件。','werewolf-player-avatar','预设名称不能为空！','default_positive','decline_transfer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','create-album-btn-page','contactType','https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','NEGATIVE_INFINITY','now','https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif','message-actions-modal','offsetParent','在这里输入说说的内容...','cancel-frame-settings-btn','网络图片','image/','countdownEndTime','1606DeYnmr',')\x20试图将群名更改为成员名\x20(\x22','https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','部分失败','shared-history-viewer-modal','正在模拟“','secondary-model-select','confirm-gift-recipient-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','parsedLyrics','chat-header-title-wrapper','收藏成功','text','startY','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>','contact-picker-list','background-interval-input','**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（','解析格式模板失败:','equals','[表情:\x20','remove-ephone-bg-btn','options','ready','确定要永久删除这条心声记录吗？此操作不可恢复。','，我们一起见证了这个约定。','请为这个新头像命名','link-memory-toggle','压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...','撤回了一条[','scroll','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22','pat_user','block','add-ai-avatar-batch-btn','容错解析：策略1成功\x20(找到并解析了完整的JSON对象)','buttonId','*你按下了接听键...*','播放失败，请检查URL是否正确或浏览器是否支持该格式。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>','load-more-thoughts-btn','EPhone-Chat-','容错解析：策略3成功\x20(将整个返回文本作为摘要)','请输入有效的正整数！','create-new-member-btn','contact-picker-screen','视频通话刚刚结束','chat-header-status','browser-back-btn','border','”的身份，开始你的回忆梳理与精炼。','cphone-icon-img-','DOMContentLoaded','preset_','AI\x20发言失败'];_0x2997=function(){return _0x2a9b25;};return _0x2997();}function getGeminiResponseText(_0x58263e){const _0x35e0f6=_0x41a954;if(_0x58263e[_0x35e0f6(0x1206)]&&Array[_0x35e0f6(0xb7b)](_0x58263e[_0x35e0f6(0x1206)])&&_0x58263e['choices'][_0x35e0f6(0x594)]>0x0&&_0x58263e['choices'][0x0]['message']&&_0x58263e['choices'][0x0][_0x35e0f6(0x4bc)]['content'])return _0x58263e[_0x35e0f6(0x1206)][0x0][_0x35e0f6(0x4bc)]['content'];if(_0x58263e[_0x35e0f6(0x6ea)]&&Array[_0x35e0f6(0xb7b)](_0x58263e[_0x35e0f6(0x6ea)])&&_0x58263e[_0x35e0f6(0x6ea)][_0x35e0f6(0x594)]>0x0&&_0x58263e[_0x35e0f6(0x6ea)][0x0][_0x35e0f6(0x9a5)]&&_0x58263e['candidates'][0x0][_0x35e0f6(0x9a5)][_0x35e0f6(0x9ba)])return _0x58263e[_0x35e0f6(0x6ea)][0x0][_0x35e0f6(0x9a5)][_0x35e0f6(0x9ba)][0x0][_0x35e0f6(0x1197)];console[_0x35e0f6(0x1c1)](_0x35e0f6(0x21a),_0x58263e);let _0x34d741='AI返回了空内容或未知格式。';if(_0x58263e['candidates']&&Array[_0x35e0f6(0xb7b)](_0x58263e[_0x35e0f6(0x6ea)])&&_0x58263e['candidates']['length']>0x0&&_0x58263e[_0x35e0f6(0x6ea)][0x0][_0x35e0f6(0x2bc)]===_0x35e0f6(0x10e1)){const _0x287789=_0x58263e[_0x35e0f6(0x6ea)][0x0][_0x35e0f6(0x6cc)],_0x3f567b=_0x287789[_0x35e0f6(0x138)](_0x4fa6d1=>_0x4fa6d1[_0x35e0f6(0x7cf)]!==_0x35e0f6(0x23e)&&_0x4fa6d1[_0x35e0f6(0x7cf)]!=='LOW')[_0x35e0f6(0x796)](_0x41e83a=>_0x41e83a[_0x35e0f6(0x382)]+_0x35e0f6(0x133)+_0x41e83a['probability']+')')['join'](',\x20');_0x34d741=_0x35e0f6(0x1136)+(_0x3f567b||'未知');}else{if(_0x58263e[_0x35e0f6(0x120a)]?.[_0x35e0f6(0x82e)]){const _0x46db77=_0x58263e[_0x35e0f6(0x120a)][_0x35e0f6(0x82e)],_0x170ca6=_0x58263e[_0x35e0f6(0x120a)][_0x35e0f6(0x6cc)]?.[_0x35e0f6(0x796)](_0x81429b=>_0x81429b[_0x35e0f6(0x382)]+':\x20'+_0x81429b[_0x35e0f6(0x7cf)])[_0x35e0f6(0xa4b)](',\x20');_0x34d741=_0x35e0f6(0x6b7)+_0x46db77+')。详情:\x20'+(_0x170ca6||'无');}else _0x58263e['error']&&(_0x34d741=_0x35e0f6(0x1012)+_0x58263e[_0x35e0f6(0x1c1)]['message']);}throw new Error(_0x34d741);}document[_0x41a954(0x4b8)](_0x41a954(0x11bf),()=>{const _0x241b18=_0x41a954;document[_0x241b18(0x4b8)](_0x241b18(0x621),()=>{const _0x4f14d5=_0x241b18;document[_0x4f14d5(0xee9)]===_0x4f14d5(0x250)&&(console['log'](_0x4f14d5(0xfcd)),navigator[_0x4f14d5(0x1071)][_0x4f14d5(0x11a2)]['then'](_0x2aa699=>{const _0x195eb=_0x4f14d5;_0x2aa699[_0x195eb(0x1225)]();}));});function _0x4a90fe(_0x4126cd,_0x12eaa1,_0x3038e8,_0x57e622){const _0x19b64d=_0x241b18,_0x313c60=_0x5de8b7[_0x19b64d(0x2df)]['apiTemperature']||0.8,_0x12d7e4={'user':_0x19b64d(0x21c),'assistant':_0x19b64d(0x130a),'system':_0x19b64d(0x21c)},_0x5a298e=[{'role':_0x19b64d(0x21c),'parts':[{'text':_0x3038e8}]},{'role':_0x19b64d(0x130a),'parts':[{'text':'好的，我明白了。我会严格遵守以上所有规则和设定。'}]},..._0x57e622[_0x19b64d(0x796)](_0x33ea19=>{const _0x8dd780=_0x19b64d,_0x2d7bd5=[];return Array[_0x8dd780(0xb7b)](_0x33ea19[_0x8dd780(0x9a5)])?_0x33ea19[_0x8dd780(0x9a5)][_0x8dd780(0x494)](_0x16797d=>{const _0x214a5c=_0x8dd780;if(_0x16797d[_0x214a5c(0xa20)]===_0x214a5c(0x1197))_0x2d7bd5[_0x214a5c(0xf5)]({'text':_0x16797d[_0x214a5c(0x1197)]});else{if(_0x16797d[_0x214a5c(0xa20)]===_0x214a5c(0x488)&&_0x16797d['image_url']&&_0x16797d[_0x214a5c(0x488)]['url']){const _0x3bf259=_0x16797d[_0x214a5c(0x488)][_0x214a5c(0x10ac)],_0x51320c=_0x3bf259[_0x214a5c(0x65b)](',')[0x1],_0x532b7f=_0x3bf259[_0x214a5c(0xe9f)](/^data:(.*);base64/);_0x532b7f&&_0x51320c&&_0x2d7bd5[_0x214a5c(0xf5)]({'inline_data':{'mime_type':_0x532b7f[0x1],'data':_0x51320c}});}}}):_0x2d7bd5[_0x8dd780(0xf5)]({'text':String(_0x33ea19[_0x8dd780(0x9a5)])}),{'role':_0x12d7e4[_0x33ea19[_0x8dd780(0xba4)]],'parts':_0x2d7bd5};})];return{'url':_0x19b64d(0xd90)+_0x4126cd+':generateContent?key='+getRandomValue(_0x12eaa1),'data':{'method':_0x19b64d(0x1128),'headers':{'Content-Type':_0x19b64d(0x35c)},'body':JSON['stringify']({'contents':_0x5a298e,'generationConfig':{'temperature':_0x313c60}})}};}const _0x2e83f8=new Dexie(_0x241b18(0x1267)),_0x504159=[{'id':_0x241b18(0x379),'url':'','name':'无'},{'id':_0x241b18(0x902),'url':'https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','name':'1'},{'id':'frame_ribbon','url':_0x241b18(0x786),'name':'2'},{'id':_0x241b18(0x3f0),'url':_0x241b18(0xa7),'name':'3'},{'id':_0x241b18(0x795),'url':_0x241b18(0x105d),'name':'4'},{'id':_0x241b18(0x101c),'url':_0x241b18(0xab4),'name':'5'},{'id':_0x241b18(0xdb0),'url':'https://i.postimg.cc/63sDQKMm/IMG-6893.gif','name':'6'},{'id':_0x241b18(0x7a9),'url':_0x241b18(0x4b1),'name':'7'},{'id':_0x241b18(0x2db),'url':'https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','name':'8'},{'id':_0x241b18(0x37b),'url':_0x241b18(0x7d6),'name':'9'},{'id':'frame_10','url':_0x241b18(0x982),'name':'10'},{'id':'frame_11','url':_0x241b18(0x28c),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/prsGKMBx/IMG-4370.gif','name':'12'},{'id':_0x241b18(0x748),'url':_0x241b18(0x172),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0xb8d),'name':'14'},{'id':_0x241b18(0x902),'url':_0x241b18(0xcfd),'name':'1'},{'id':_0x241b18(0x6c3),'url':'https://i.postimg.cc/PrcKH436/IMG-4376.gif','name':'2'},{'id':_0x241b18(0x3f0),'url':'https://i.postimg.cc/fRV86FMq/IMG-4381.gif','name':'3'},{'id':_0x241b18(0x795),'url':'https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','name':'4'},{'id':'frame_5','url':_0x241b18(0xf5c),'name':'5'},{'id':'frame_6','url':_0x241b18(0xfd1),'name':'6'},{'id':_0x241b18(0x7a9),'url':_0x241b18(0x10a),'name':'7'},{'id':_0x241b18(0x2db),'url':'https://i.postimg.cc/fLTc42dg/IMG-4391.gif','name':'8'},{'id':_0x241b18(0x37b),'url':'https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','name':'9'},{'id':_0x241b18(0xe83),'url':_0x241b18(0x1167),'name':'10'},{'id':_0x241b18(0x11cd),'url':_0x241b18(0xac3),'name':'11'},{'id':'frame_12','url':_0x241b18(0x41b),'name':'12'},{'id':_0x241b18(0x748),'url':_0x241b18(0x415),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x471),'name':'14'},{'id':_0x241b18(0x902),'url':_0x241b18(0x127a),'name':'1'},{'id':'frame_ribbon','url':_0x241b18(0xda0),'name':'2'},{'id':_0x241b18(0x3f0),'url':'https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','name':'3'},{'id':_0x241b18(0x795),'url':'https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','name':'4'},{'id':_0x241b18(0x101c),'url':_0x241b18(0xac0),'name':'5'},{'id':_0x241b18(0xdb0),'url':_0x241b18(0x767),'name':'6'},{'id':_0x241b18(0x7a9),'url':'https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','name':'7'},{'id':_0x241b18(0x2db),'url':_0x241b18(0xaf),'name':'8'},{'id':_0x241b18(0x37b),'url':'https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','name':'9'},{'id':'frame_10','url':'https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','name':'10'},{'id':'frame_11','url':'https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','name':'11'},{'id':_0x241b18(0xd73),'url':_0x241b18(0xbc4),'name':'12'},{'id':'frame_13','url':_0x241b18(0x1282),'name':'13'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','name':'14'},{'id':_0x241b18(0x902),'url':_0x241b18(0x203),'name':'1'},{'id':_0x241b18(0x6c3),'url':_0x241b18(0x43f),'name':'2'},{'id':_0x241b18(0x3f0),'url':_0x241b18(0x8ba),'name':'3'},{'id':_0x241b18(0x795),'url':_0x241b18(0x6e2),'name':'4'},{'id':_0x241b18(0x101c),'url':_0x241b18(0xfaf),'name':'5'},{'id':_0x241b18(0xdb0),'url':_0x241b18(0x5a1),'name':'6'},{'id':'frame_7','url':_0x241b18(0x115f),'name':'7'},{'id':'frame_8','url':_0x241b18(0x38b),'name':'8'},{'id':_0x241b18(0x37b),'url':_0x241b18(0xdee),'name':'9'},{'id':_0x241b18(0xe83),'url':_0x241b18(0x528),'name':'10'},{'id':_0x241b18(0x11cd),'url':_0x241b18(0x51f),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','name':'12'},{'id':_0x241b18(0x748),'url':_0x241b18(0x1068),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0xbeb),'name':'14'},{'id':_0x241b18(0x902),'url':_0x241b18(0x76f),'name':'1'},{'id':_0x241b18(0x6c3),'url':_0x241b18(0x416),'name':'2'},{'id':_0x241b18(0x3f0),'url':'https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','name':'3'},{'id':_0x241b18(0x795),'url':_0x241b18(0xdb9),'name':'4'},{'id':'frame_5','url':'https://i.postimg.cc/g2XykNGB/IMG-4727.gif','name':'5'},{'id':_0x241b18(0xdb0),'url':_0x241b18(0x99d),'name':'6'},{'id':'frame_7','url':_0x241b18(0xbfc),'name':'7'},{'id':_0x241b18(0x2db),'url':_0x241b18(0xec1),'name':'8'},{'id':_0x241b18(0x37b),'url':_0x241b18(0xce9),'name':'9'},{'id':_0x241b18(0xe83),'url':_0x241b18(0xecf),'name':'10'},{'id':'frame_11','url':_0x241b18(0x704),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','name':'12'},{'id':'frame_13','url':_0x241b18(0x1288),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x1180),'name':'14'},{'id':'frame_cat_ear','url':_0x241b18(0x962),'name':'1'},{'id':_0x241b18(0x6c3),'url':_0x241b18(0x1140),'name':'2'},{'id':_0x241b18(0x3f0),'url':_0x241b18(0x1140),'name':'3'},{'id':_0x241b18(0x795),'url':_0x241b18(0xc21),'name':'4'},{'id':_0x241b18(0x101c),'url':_0x241b18(0x359),'name':'5'},{'id':_0x241b18(0xdb0),'url':'https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','name':'6'},{'id':_0x241b18(0x7a9),'url':_0x241b18(0xfd7),'name':'7'},{'id':_0x241b18(0x2db),'url':_0x241b18(0xc29),'name':'8'},{'id':_0x241b18(0x37b),'url':'https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','name':'9'},{'id':'frame_10','url':_0x241b18(0xcec),'name':'10'},{'id':_0x241b18(0x11cd),'url':_0x241b18(0x1271),'name':'11'},{'id':_0x241b18(0xd73),'url':_0x241b18(0xa97),'name':'12'},{'id':_0x241b18(0x748),'url':_0x241b18(0x3bb),'name':'13'},{'id':'frame_14','url':_0x241b18(0xb0b),'name':'14'},{'id':_0x241b18(0x902),'url':'https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','name':'1'},{'id':_0x241b18(0x6c3),'url':_0x241b18(0x16f),'name':'2'},{'id':_0x241b18(0x3f0),'url':_0x241b18(0x1047),'name':'3'},{'id':_0x241b18(0x795),'url':'https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','name':'4'},{'id':_0x241b18(0x101c),'url':_0x241b18(0xdf5),'name':'5'},{'id':_0x241b18(0xdb0),'url':_0x241b18(0x118d),'name':'6'},{'id':_0x241b18(0x7a9),'url':_0x241b18(0x686),'name':'7'},{'id':'frame_8','url':_0x241b18(0xb39),'name':'8'},{'id':'frame_9','url':_0x241b18(0xb30),'name':'9'},{'id':_0x241b18(0xe83),'url':'https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','name':'10'},{'id':_0x241b18(0x11cd),'url':'https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','name':'12'},{'id':_0x241b18(0x748),'url':_0x241b18(0x47f),'name':'13'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','name':'14'},{'id':_0x241b18(0x902),'url':_0x241b18(0xd9),'name':'1'},{'id':_0x241b18(0x6c3),'url':'https://i.postimg.cc/k45sd8gn/IMG-6375.gif','name':'2'},{'id':_0x241b18(0x3f0),'url':_0x241b18(0xeda),'name':'3'},{'id':_0x241b18(0x795),'url':_0x241b18(0x108b),'name':'4'},{'id':_0x241b18(0x101c),'url':_0x241b18(0xb6b),'name':'5'},{'id':'frame_6','url':_0x241b18(0x22c),'name':'6'},{'id':_0x241b18(0x7a9),'url':_0x241b18(0x7fa),'name':'7'},{'id':'frame_8','url':'https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','name':'8'},{'id':'frame_9','url':'https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','name':'9'},{'id':_0x241b18(0xe83),'url':_0x241b18(0x52d),'name':'10'},{'id':'frame_11','url':_0x241b18(0x5a0),'name':'11'},{'id':_0x241b18(0xd73),'url':'https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','name':'12'},{'id':_0x241b18(0x748),'url':_0x241b18(0xa95),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x357),'name':'14'},{'id':'frame_cat_ear','url':_0x241b18(0x76c),'name':'1'},{'id':'frame_ribbon','url':_0x241b18(0x54b),'name':'2'},{'id':_0x241b18(0x3f0),'url':_0x241b18(0x213),'name':'3'},{'id':_0x241b18(0x795),'url':'https://i.postimg.cc/fycfcvHf/IMG-6569.gif','name':'4'},{'id':_0x241b18(0x101c),'url':_0x241b18(0xa3c),'name':'5'},{'id':_0x241b18(0xdb0),'url':_0x241b18(0x396),'name':'6'},{'id':_0x241b18(0x7a9),'url':'https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','name':'7'},{'id':_0x241b18(0x2db),'url':_0x241b18(0xaec),'name':'8'},{'id':_0x241b18(0x37b),'url':_0x241b18(0x3ab),'name':'9'},{'id':_0x241b18(0xe83),'url':_0x241b18(0x389),'name':'10'},{'id':_0x241b18(0x11cd),'url':'https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','name':'11'},{'id':_0x241b18(0xd73),'url':_0x241b18(0x6a4),'name':'12'},{'id':_0x241b18(0x748),'url':'https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','name':'13'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','name':'14'},{'id':_0x241b18(0x902),'url':_0x241b18(0x12ad),'name':'1'},{'id':'frame_ribbon','url':_0x241b18(0x112d),'name':'2'},{'id':'frame_flower','url':_0x241b18(0xf11),'name':'3'},{'id':'frame_tech','url':'https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','name':'4'},{'id':_0x241b18(0x101c),'url':_0x241b18(0x9c4),'name':'5'},{'id':_0x241b18(0xdb0),'url':_0x241b18(0x393),'name':'6'},{'id':_0x241b18(0x7a9),'url':_0x241b18(0x282),'name':'7'},{'id':_0x241b18(0x2db),'url':'https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','name':'8'},{'id':'frame_9','url':'https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','name':'9'},{'id':_0x241b18(0xe83),'url':_0x241b18(0x848),'name':'10'},{'id':_0x241b18(0x11cd),'url':_0x241b18(0x4fc),'name':'11'},{'id':_0x241b18(0xd73),'url':_0x241b18(0x97f),'name':'12'},{'id':_0x241b18(0x748),'url':'https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','name':'13'},{'id':'frame_14','url':_0x241b18(0x126),'name':'14'},{'id':_0x241b18(0x11cd),'url':_0x241b18(0x947),'name':'11'},{'id':'frame_12','url':_0x241b18(0x109e),'name':'12'},{'id':'frame_13','url':'https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x109b),'name':'14'},{'id':_0x241b18(0x748),'url':'https://i.postimg.cc/43PhvxRq/IMG-6922.gif','name':'13'},{'id':'frame_14','url':_0x241b18(0xe98),'name':'14'},{'id':'frame_13','url':_0x241b18(0xe8d),'name':'13'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0x10d5),'name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0x163),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0xb8),'name':'14'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','name':'14'},{'id':_0x241b18(0xd73),'url':_0x241b18(0x49c),'name':'12'},{'id':'frame_13','url':_0x241b18(0x127c),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x84a),'name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0xa54),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x921),'name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0x347),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x145),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0x1129),'name':'13'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0xe44),'name':'14'},{'id':'frame_13','url':_0x241b18(0x122e),'name':'13'},{'id':'frame_14','url':_0x241b18(0x7fc),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0xcdf),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/SNByPrf9/IMG-7005.gif','name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0x824),'name':'13'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0x4a7),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x12a6),'name':'14'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0x3b1),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x817),'name':'14'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','name':'14'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','name':'14'},{'id':'frame_13','url':_0x241b18(0x14b),'name':'13'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif','name':'14'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x10ab),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0xd21),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','name':'14'},{'id':'frame_13','url':_0x241b18(0x22d),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x91b),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0x8e9),'name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0xb84),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x9cb),'name':'14'},{'id':'frame_14','url':_0x241b18(0xef6),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0xfc3),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x963),'name':'14'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','name':'13'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','name':'14'},{'id':'frame_14','url':_0x241b18(0xd23),'name':'14'},{'id':'frame_14','url':_0x241b18(0xe50),'name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0xd3c),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x124b),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0xbc9),'name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0x6af),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x4f1),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0xb57),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0xbc5),'name':'14'},{'id':_0x241b18(0x748),'url':'https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x5fd),'name':'14'},{'id':'frame_14','url':_0x241b18(0x6bc),'name':'14'},{'id':_0x241b18(0x748),'url':'https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x2aa),'name':'14'},{'id':'frame_14','url':_0x241b18(0x232),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0x328),'name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0x1023),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0xaa6),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0xf26),'name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0x6ae),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x4a1),'name':'14'},{'id':'frame_14','url':_0x241b18(0x7c0),'name':'14'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/B6KD52vz/IMG-7096.gif','name':'14'},{'id':'frame_13','url':_0x241b18(0x148),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0x1183),'name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0x39b),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0xf38),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0x8c0),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0x949),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','name':'13'},{'id':'frame_14','url':_0x241b18(0x272),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0x351),'name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0x38f),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0xed4),'name':'14'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0x1d5),'name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0xb90),'name':'13'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/wMxmCZVC/IMG-7099.gif','name':'14'},{'id':_0x241b18(0x748),'url':_0x241b18(0x30a),'name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0x845),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0x5eb),'name':'14'},{'id':_0x241b18(0x391),'url':'https://i.postimg.cc/htZppbS4/IMG-7107.gif','name':'14'},{'id':_0x241b18(0x748),'url':'https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','name':'13'},{'id':'frame_14','url':_0x241b18(0x5c2),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0x690),'name':'14'},{'id':_0x241b18(0x748),'url':'https://i.postimg.cc/bJDMQVkj/IMG-7112.gif','name':'13'},{'id':_0x241b18(0x391),'url':_0x241b18(0xca8),'name':'14'},{'id':_0x241b18(0x391),'url':_0x241b18(0x678),'name':'14'}];let _0x5de8b7={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map()},_0x528823={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':_0x241b18(0x7c4),'nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0x441c78=0x0;const _0x48c602=0xf;let _0x4f3fd1=0x0;const _0x33ebc3=0xa;let _0x2814a8=[],_0xb57b5b={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':_0x241b18(0xd6a),'totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0x29da69={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x7cf0d1=document[_0x241b18(0x11e3)](_0x241b18(0x6d4));let _0x336b5e=null,_0x56fc05=![],_0xb72583=0x0,_0x502483=null,_0x39fb90=![],_0x10c076='all',_0x281a6a=new Set(),_0x168ef5=null,_0x176587=![],_0x3bebd3=null,_0x1a868e=null,_0x50f724=![],_0x35a438=![],_0x320eb9=![],_0x48f5d6=![],_0x1e20f2=[],_0x34c788=null,_0x1ad8ed=null,_0x2c1bf7={},_0x50fd7c=null,_0x698363=null,_0x2b2e96=null,_0x3f0e9e=null,_0x4f0a42=null,_0x59751d=null,_0x3dcd61=null,_0x103e33=[],_0x37ebf7=null,_0x1b5257=null,_0x539314=new Set(),_0x362af8=null,_0x31f023=null,_0x3bea2e=null,_0x568b1b={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x481a45=0x0,_0x1b417c=![],_0x355a00=new Set(),_0x454e0e=null;const _0x3d2e44=_0x241b18(0x939),_0x30449f=_0x241b18(0xf92),_0x4d9574=_0x241b18(0x1e9),_0x1f1b42='https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg';let _0x1b0056,_0x5aa3cf={};const _0x2694ad=_0x241b18(0xc70);let _0x17be1a={},_0x27dbec={},_0x523a77=null;const _0x19c75d={'qq':_0x241b18(0xa0e),'world-book':_0x241b18(0xff8),'wallpaper':'https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','renderer':_0x241b18(0x113),'api-settings':_0x241b18(0xc71),'font':_0x241b18(0xbc7),'char-phone':_0x241b18(0x2e5),'douban':_0x241b18(0xa2e),'preset':_0x241b18(0x87a),'tutorial':_0x241b18(0xb52),'werewolf':_0x241b18(0x459),'x':_0x241b18(0x61c)},_0x5d2f39={'qq':_0x241b18(0xa0e),'album':_0x241b18(0xff8),'browser':_0x241b18(0x349),'taobao':_0x241b18(0x4be),'memo':_0x241b18(0xdd),'diary':_0x241b18(0x79a),'amap':_0x241b18(0x10dd),'usage':_0x241b18(0x5ea),'music':_0x241b18(0xa61),'ephone':_0x241b18(0x2e5)};let _0x4add6d=null;const _0x9f9ac4=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0xd53d57=0x0,_0x23da11=0x1,_0x492ffd={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0x400ccc;const _0x206e3c=document[_0x241b18(0x383)](_0x241b18(0x794));_0x206e3c['id']=_0x241b18(0x8af),document[_0x241b18(0x10ad)][_0x241b18(0x120c)](_0x206e3c);const _0x533d18=document[_0x241b18(0x11e3)](_0x241b18(0x121c)),_0x2c8473=document[_0x241b18(0x11e3)](_0x241b18(0xb29)),_0x5517db=document['getElementById'](_0x241b18(0x66c)),_0x5d1b7c=document[_0x241b18(0x11e3)](_0x241b18(0xe1)),_0x1fc826=document['getElementById']('custom-modal-cancel');let _0x48f388;function _0x450573(){const _0x4cc698=_0x241b18;_0x533d18[_0x4cc698(0x505)][_0x4cc698(0x252)](_0x4cc698(0x250));}function _0x225a39(){const _0x3df4a3=_0x241b18;_0x533d18['classList'][_0x3df4a3(0x957)](_0x3df4a3(0x250)),_0x5d1b7c[_0x3df4a3(0x505)][_0x3df4a3(0x957)]('btn-danger');if(_0x48f388)_0x48f388(null);}function _0x30d472(_0x378967){const _0x38322b=_0x241b18,_0x386dde=document[_0x38322b(0x11e3)](_0x38322b(0x68d)),_0x4061b2=_0x378967['settings'][_0x38322b(0xa92)]||{'vertical':_0x38322b(0x10e2),'horizontal':_0x38322b(0xc9c),'offset':0xa};_0x386dde[_0x38322b(0x794)][_0x38322b(0x10e2)]=_0x38322b(0x11f7),_0x386dde[_0x38322b(0x794)][_0x38322b(0x1070)]=_0x38322b(0x11f7),_0x386dde[_0x38322b(0x794)][_0x38322b(0x910)]=_0x38322b(0x11f7),_0x386dde[_0x38322b(0x794)]['right']=_0x38322b(0x11f7),_0x386dde[_0x38322b(0x794)]['transform']=_0x38322b(0x379);_0x4061b2[_0x38322b(0x80e)]===_0x38322b(0x10e2)?_0x386dde[_0x38322b(0x794)][_0x38322b(0x10e2)]=_0x4061b2[_0x38322b(0x197)]+'px':_0x386dde[_0x38322b(0x794)][_0x38322b(0x1070)]=_0x4061b2[_0x38322b(0x197)]+'px';switch(_0x4061b2[_0x38322b(0xaf6)]){case _0x38322b(0x910):_0x386dde['style'][_0x38322b(0x910)]=_0x38322b(0xb04);break;case _0x38322b(0xf47):_0x386dde[_0x38322b(0x794)]['right']=_0x38322b(0xb04);break;case _0x38322b(0xc9c):default:_0x386dde['style'][_0x38322b(0x910)]=_0x38322b(0xf21),_0x386dde[_0x38322b(0x794)][_0x38322b(0xb5d)]=_0x38322b(0x11e9);break;}}async function _0x24923a(_0x53e05f){const _0x3a271a=_0x241b18,_0x49cd6=_0x53e05f[_0x3a271a(0xd7c)][_0x3a271a(0x5c9)][0x0];if(!_0x49cd6)return;const _0xe016b1=await new Promise(_0x149172=>{const _0x59b329=_0x3a271a,_0x2046d0=new FileReader();_0x2046d0[_0x59b329(0x1e5)]=()=>_0x149172(_0x2046d0[_0x59b329(0x255)]),_0x2046d0['readAsDataURL'](_0x49cd6);});await _0x2fb06(_0x3a271a(0x63d),_0x3a271a(0x872));try{const _0x4a562a=await _0x87e459(_0xe016b1);if(!_0x4a562a)throw new Error(_0x3a271a(0x26d));const _0x50ae4b=_0x5de8b7[_0x3a271a(0x737)][_0x5de8b7[_0x3a271a(0x93d)]];!_0x50ae4b[_0x3a271a(0x761)][_0x3a271a(0x86c)]&&(_0x50ae4b[_0x3a271a(0x761)]['groupAvatarLibrary']=[]),_0x50ae4b[_0x3a271a(0x761)][_0x3a271a(0x86c)][_0x3a271a(0xf5)]({'name':_0x4a562a,'url':_0xe016b1}),await _0x2e83f8[_0x3a271a(0x737)][_0x3a271a(0xe3c)](_0x50ae4b),_0x4fd61d(),await _0x2fb06(_0x3a271a(0xf17),_0x3a271a(0xcd2)+_0x4a562a+'”');}catch(_0x4b676d){console['error'](_0x3a271a(0x7ca),_0x4b676d),await _0x2fb06(_0x3a271a(0x1177),_0x3a271a(0x899)+_0x4b676d[_0x3a271a(0x4bc)]);}finally{_0x53e05f[_0x3a271a(0xd7c)][_0x3a271a(0xf27)]=null;}}async function _0x54bd44(_0x338747){const _0x5f2ee1=_0x241b18,_0x5c672a=_0x338747[_0x5f2ee1(0xd7c)][_0x5f2ee1(0x5c9)][0x0];if(!_0x5c672a)return;const _0x3a09cb=await new Promise(_0x1fab42=>{const _0x19701d=_0x5f2ee1,_0x559cdd=new FileReader();_0x559cdd[_0x19701d(0x1e5)]=()=>_0x1fab42(_0x559cdd[_0x19701d(0x255)]),_0x559cdd[_0x19701d(0x1270)](_0x5c672a);});await _0x2fb06(_0x5f2ee1(0x63d),_0x5f2ee1(0xbc));try{const _0x3fda07=await _0x87e459(_0x3a09cb);if(!_0x3fda07)throw new Error(_0x5f2ee1(0x26d));const _0xbf6dd0=_0x5de8b7[_0x5f2ee1(0x737)][_0x5de8b7[_0x5f2ee1(0x93d)]];!_0xbf6dd0['settings'][_0x5f2ee1(0xe6d)]&&(_0xbf6dd0[_0x5f2ee1(0x761)][_0x5f2ee1(0xe6d)]=[]),_0xbf6dd0[_0x5f2ee1(0x761)][_0x5f2ee1(0xe6d)]['push']({'name':_0x3fda07,'url':_0x3a09cb}),await _0x2e83f8[_0x5f2ee1(0x737)][_0x5f2ee1(0xe3c)](_0xbf6dd0),_0x3c9732(),await _0x2fb06('上传成功！','AI已将新头像命名为：“'+_0x3fda07+'”');}catch(_0x488495){console[_0x5f2ee1(0x1c1)](_0x5f2ee1(0x127d),_0x488495),await _0x2fb06(_0x5f2ee1(0x1177),_0x5f2ee1(0x899)+_0x488495[_0x5f2ee1(0x4bc)]);}finally{_0x338747[_0x5f2ee1(0xd7c)][_0x5f2ee1(0xf27)]=null;}}async function _0x87e459(_0x489f5d){const _0x3d08d0=_0x241b18,_0x38cccb=_0x5de8b7[_0x3d08d0(0x89c)][_0x3d08d0(0x13c)]&&_0x5de8b7[_0x3d08d0(0x89c)]['secondaryApiKey']&&_0x5de8b7[_0x3d08d0(0x89c)][_0x3d08d0(0xe1b)],{proxyUrl:_0x33fd77,apiKey:_0x1b4f4e,model:_0x20bb03}=_0x38cccb?{'proxyUrl':_0x5de8b7[_0x3d08d0(0x89c)]['secondaryProxyUrl'],'apiKey':_0x5de8b7['apiConfig']['secondaryApiKey'],'model':_0x5de8b7[_0x3d08d0(0x89c)]['secondaryModel']}:_0x5de8b7[_0x3d08d0(0x89c)];if(!_0x33fd77||!_0x1b4f4e||!_0x20bb03)throw new Error(_0x3d08d0(0x4ae));const _0x227bc6=_0x3d08d0(0x223);let _0xdbe01c=_0x33fd77['includes']('generativelanguage'),_0x919251;if(_0xdbe01c){const _0x117f98=_0x489f5d[_0x3d08d0(0xe9f)](/^data:(.*);base64/)[0x1],_0x53a144=_0x489f5d[_0x3d08d0(0x65b)](',')[0x1],_0x12c91a={'contents':[{'parts':[{'text':_0x227bc6},{'inline_data':{'mime_type':_0x117f98,'data':_0x53a144}}]}]};_0x919251=await fetch(_0x33fd77+'/'+_0x20bb03+_0x3d08d0(0x27d)+_0x1b4f4e,{'method':'POST','headers':{'Content-Type':_0x3d08d0(0x35c)},'body':JSON[_0x3d08d0(0x313)](_0x12c91a)});}else{const _0x524e54={'model':_0x20bb03,'messages':[{'role':_0x3d08d0(0x21c),'content':[{'type':'text','text':_0x227bc6},{'type':_0x3d08d0(0x488),'image_url':{'url':_0x489f5d}}]}],'max_tokens':0x32};_0x919251=await fetch(_0x33fd77+_0x3d08d0(0x8fd),{'method':_0x3d08d0(0x1128),'headers':{'Content-Type':_0x3d08d0(0x35c),'Authorization':_0x3d08d0(0xdaf)+_0x1b4f4e},'body':JSON['stringify'](_0x524e54)});}if(!_0x919251['ok']){const _0x1eb4e6=await _0x919251[_0x3d08d0(0xd7b)]();throw new Error(_0x3d08d0(0x307)+_0x1eb4e6['error'][_0x3d08d0(0x4bc)]);}const _0x4bb8b2=await _0x919251['json']();let _0x13e609=_0xdbe01c?getGeminiResponseText(_0x4bb8b2):_0x4bb8b2[_0x3d08d0(0x1206)][0x0][_0x3d08d0(0x4bc)][_0x3d08d0(0x9a5)];return _0x13e609[_0x3d08d0(0xeb7)]()[_0x3d08d0(0x1018)](/["'“”‘’]/g,'');}async function _0xead3(_0x295297){const _0x1a4362=_0x241b18;if(!_0x295297||_0x295297[_0x1a4362(0x1244)]){console[_0x1a4362(0x6b0)](_0x1a4362(0xa8d));return;}const _0x4f6dbc=_0x295297['id'],_0x294062=_0x295297['name'],_0x515a99=_0x295297[_0x1a4362(0x697)];console[_0x1a4362(0x84b)]('正在为角色\x20'+_0x4f6dbc+_0x1a4362(0x4a0));for(const _0x326aa2 in _0x5de8b7[_0x1a4362(0x737)]){const _0x2c710d=_0x5de8b7[_0x1a4362(0x737)][_0x326aa2];if(_0x2c710d['isGroup']&&_0x2c710d[_0x1a4362(0x2b3)]){const _0x471988=_0x2c710d[_0x1a4362(0x2b3)]['find'](_0x45b7ef=>_0x45b7ef['id']===_0x4f6dbc);if(_0x471988){let _0x1304e0=![];_0x471988[_0x1a4362(0xc8f)]!==_0x294062&&(_0x471988['groupNickname']=_0x294062,_0x1304e0=!![]),_0x471988[_0x1a4362(0x697)]!==_0x515a99&&(_0x471988['originalName']=_0x515a99,_0x1304e0=!![]),_0x1304e0&&(await _0x2e83f8[_0x1a4362(0x737)][_0x1a4362(0xe3c)](_0x2c710d),console[_0x1a4362(0x84b)](_0x1a4362(0x478)+_0x2c710d['name']+'\x22\x20中的成员信息更新'));}}}}async function _0x46ae3e(_0xf49f7){const _0x28c682=_0x241b18;if(!_0xf49f7||_0xf49f7[_0x28c682(0x1244)]){console[_0x28c682(0x6b0)](_0x28c682(0xda1));return;}const _0x2189be=_0xf49f7['id'],_0x390920=_0xf49f7[_0x28c682(0x761)][_0x28c682(0x5e0)];console[_0x28c682(0x84b)]('正在为角色\x20'+_0x2189be+_0x28c682(0xc5b));for(const _0xcdd4b0 of Object[_0x28c682(0x4ca)](_0x5de8b7['chats'])){if(_0xcdd4b0[_0x28c682(0x1244)]&&_0xcdd4b0[_0x28c682(0x2b3)]){const _0x379357=_0xcdd4b0[_0x28c682(0x2b3)]['find'](_0x825322=>_0x825322['id']===_0x2189be);_0x379357&&_0x379357[_0x28c682(0x525)]!==_0x390920&&(_0x379357['avatar']=_0x390920,await _0x2e83f8[_0x28c682(0x737)][_0x28c682(0xe3c)](_0xcdd4b0),console[_0x28c682(0x84b)](_0x28c682(0x8d1)+_0x2189be+'\x20的新头像同步到群聊\x20\x22'+_0xcdd4b0[_0x28c682(0x278)]+'\x22'));}}}function _0xd9d60a(_0x1f490c,_0x16b26e){const _0x24c3af=_0x241b18;if(!_0x1f490c||!_0x1f490c['isGroup']||!_0x16b26e)return _0x16b26e;const _0x547c1d=_0x5de8b7[_0x24c3af(0x1c5)][_0x24c3af(0xa33)]||_0x24c3af(0x833);if(_0x16b26e===_0x547c1d)return _0x1f490c[_0x24c3af(0x761)][_0x24c3af(0xca7)]||'我';const _0x3dab96=_0x1f490c[_0x24c3af(0x2b3)][_0x24c3af(0xe79)](_0x53e6fc=>_0x53e6fc[_0x24c3af(0x697)]===_0x16b26e);return _0x3dab96?_0x3dab96[_0x24c3af(0xc8f)]:_0x16b26e;}function _0x57f501(_0x402636){const _0x2d1e3b=_0x241b18;document['querySelectorAll'](_0x2d1e3b(0x327))['forEach'](_0x154613=>{const _0x2dbb04=_0x2d1e3b;_0x154613[_0x2dbb04(0x505)][_0x2dbb04(0xe7e)](_0x2dbb04(0x1fc),_0x154613[_0x2dbb04(0xaca)][_0x2dbb04(0x9ee)]===_0x402636);}),document[_0x2d1e3b(0x10d6)](_0x2d1e3b(0x202))[_0x2d1e3b(0x494)](_0x479cfc=>{const _0x12ff5=_0x2d1e3b;_0x479cfc[_0x12ff5(0x505)]['toggle']('active',_0x479cfc[_0x12ff5(0xaca)]['categoryId']===_0x402636);});}function _0x4a0eba(_0xdf4ff8){const _0x3223c4=_0x241b18;if(!_0xdf4ff8)return'';if(_0x5de8b7[_0x3223c4(0x1c5)]&&_0xdf4ff8===_0x5de8b7[_0x3223c4(0x1c5)][_0x3223c4(0xa33)])return _0x5de8b7[_0x3223c4(0x1c5)]['nickname'];let _0x33f3a5=Object[_0x3223c4(0x4ca)](_0x5de8b7[_0x3223c4(0x737)])[_0x3223c4(0xe79)](_0x3af2f6=>!_0x3af2f6[_0x3223c4(0x1244)]&&_0x3af2f6[_0x3223c4(0x697)]===_0xdf4ff8);if(_0x33f3a5)return _0x33f3a5['name'];_0x33f3a5=Object[_0x3223c4(0x4ca)](_0x5de8b7[_0x3223c4(0x737)])[_0x3223c4(0xe79)](_0x2c4c1d=>!_0x2c4c1d[_0x3223c4(0x1244)]&&(_0x2c4c1d[_0x3223c4(0x3d7)]&&_0x2c4c1d[_0x3223c4(0x3d7)]['includes'](_0xdf4ff8)));if(_0x33f3a5)return _0x33f3a5[_0x3223c4(0x278)];return _0xdf4ff8;}function _0x33faa3(_0x3cb6ed,_0x6546ea=null){const _0x3ae698=_0x241b18;if(!_0x3cb6ed||typeof _0x3cb6ed!==_0x3ae698(0x10d7)||!_0x3cb6ed[_0x3ae698(0x3ad)](_0x3ae698(0xc64)))return _0x3cb6ed;return _0x3cb6ed['replace'](/@\[\[([^\]]+)\]\]/g,(_0x5660ab,_0x4b7ecd)=>{const _0x469886=_0x3ae698,_0x45cd54=_0x4b7ecd[_0x469886(0xeb7)]();let _0x569926;return _0x6546ea&&_0x6546ea[_0x469886(0x1244)]?_0x569926=_0xd9d60a(_0x6546ea,_0x45cd54):_0x569926=_0x4a0eba(_0x45cd54),'@'+_0x569926;});}function _0x58fd60(_0x3ea9ec,_0x45cac0,_0x210b6d={}){return new Promise(_0x34a551=>{const _0x15a505=_0x10a9;_0x48f388=_0x34a551,_0x2c8473['textContent']=_0x3ea9ec,_0x5517db[_0x15a505(0x595)]=_0x15a505(0xbdf)+_0x45cac0+'</p>';const _0xf32861=document[_0x15a505(0x11e3)](_0x15a505(0xe1)),_0xc9c297=document[_0x15a505(0x11e3)]('custom-modal-cancel');_0xc9c297[_0x15a505(0x794)][_0x15a505(0x33d)]=_0x15a505(0x11ac),_0xf32861[_0x15a505(0x300)]=_0x210b6d[_0x15a505(0x920)]||'确定',_0xc9c297[_0x15a505(0x300)]=_0x210b6d[_0x15a505(0xdff)]||'取消',_0x210b6d[_0x15a505(0x3a3)]?_0xf32861[_0x15a505(0x505)][_0x15a505(0x252)](_0x210b6d['confirmButtonClass']):_0xf32861[_0x15a505(0x505)]['remove']('btn-danger'),_0xf32861[_0x15a505(0x1074)]=()=>{_0x34a551(!![]),_0x225a39();},_0xc9c297['onclick']=()=>{_0x34a551(![]),_0x225a39();},_0x450573();});}function _0x2fb06(_0x47978a,_0x22dcdc){return new Promise(_0x533acd=>{const _0x125b11=_0x10a9;_0x48f388=_0x533acd,_0x2c8473['textContent']=_0x47978a,_0x5517db['innerHTML']='<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>'+_0x22dcdc+_0x125b11(0xdc8);const _0x27d7d5=document['getElementById'](_0x125b11(0xe1)),_0x282c0a=document[_0x125b11(0x11e3)]('custom-modal-cancel');_0x282c0a[_0x125b11(0x794)][_0x125b11(0x33d)]=_0x125b11(0x379),_0x27d7d5[_0x125b11(0x300)]='好的',_0x27d7d5[_0x125b11(0x1074)]=()=>{const _0x277839=_0x125b11;_0x282c0a[_0x277839(0x794)][_0x277839(0x33d)]=_0x277839(0x11ac),_0x27d7d5[_0x277839(0x300)]='确定',_0x533acd(!![]),_0x225a39();},_0x450573();});}function _0x231a5a(_0x57b160,_0x46cebe,_0x34e87f='',_0x3ff7e8=_0x241b18(0x1197),_0x3dffbe=''){return new Promise(_0x3d3a1a=>{const _0x3d7394=_0x10a9;_0x48f388=_0x3d3a1a,_0x2c8473[_0x3d7394(0x300)]=_0x57b160;const _0x51d2e5=_0x3d7394(0x5bb),_0xebcd68=_0x3ff7e8===_0x3d7394(0x10bb)?_0x3d7394(0x1082)+_0x51d2e5+_0x3d7394(0x90d)+_0x46cebe+'\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>'+_0x34e87f+_0x3d7394(0x8bf):'<input\x20type=\x22'+_0x3ff7e8+_0x3d7394(0x80f)+_0x51d2e5+_0x3d7394(0x90d)+_0x46cebe+'\x22\x20value=\x22'+_0x34e87f+'\x22>';_0x5517db[_0x3d7394(0x595)]=_0x3dffbe+_0xebcd68;const _0x239938=document[_0x3d7394(0x11e3)](_0x51d2e5);_0x5517db['querySelectorAll']('.format-btn')[_0x3d7394(0x494)](_0x285d57=>{const _0x237c45=_0x3d7394;_0x285d57[_0x237c45(0x4b8)]('click',()=>{const _0x2a2403=_0x237c45,_0xbb39e6=_0x285d57[_0x2a2403(0xaca)][_0x2a2403(0xc72)];if(_0xbb39e6)try{const _0x3da74e=JSON[_0x2a2403(0xb0c)](_0xbb39e6);_0x239938[_0x2a2403(0xf27)]=JSON[_0x2a2403(0x313)](_0x3da74e,null,0x2),_0x239938['focus']();}catch(_0x54d1e9){console[_0x2a2403(0x1c1)](_0x2a2403(0x119d),_0x54d1e9);}});});const _0xafde5e=document[_0x3d7394(0x11e3)](_0x3d7394(0xe1)),_0x2d1f0d=document[_0x3d7394(0x11e3)](_0x3d7394(0x731));_0xafde5e[_0x3d7394(0x1074)]=()=>{const _0x4cc2aa=_0x3d7394;_0x3d3a1a(_0x239938[_0x4cc2aa(0xf27)]),_0x225a39();},_0x2d1f0d[_0x3d7394(0x1074)]=()=>{_0x3d3a1a(null),_0x225a39();},_0x450573(),setTimeout(()=>_0x239938[_0x3d7394(0xc1f)](),0x64);});}function _0x16a8e1(_0x2e2ed9,_0x3795ec){const _0xf450b0=_0x241b18;return new Promise(_0x597855=>{const _0x616af7=_0x10a9,_0x16c029=document[_0x616af7(0x11e3)](_0x616af7(0x121c)),_0xebf129=document[_0x616af7(0x11e3)]('custom-modal-title'),_0x29058c=document[_0x616af7(0x11e3)](_0x616af7(0x66c)),_0xcc0402=document[_0x616af7(0x5ac)]('#custom-modal\x20.custom-modal-footer');_0xebf129[_0x616af7(0x300)]=_0x2e2ed9,_0x29058c[_0x616af7(0x595)]='',_0xcc0402[_0x616af7(0x595)]='',_0xcc0402[_0x616af7(0x794)][_0x616af7(0x1290)]=_0x616af7(0x12c7),_0x3795ec['forEach'](_0x1191a0=>{const _0x1d33c9=_0x616af7,_0x24dab6=document[_0x1d33c9(0x383)]('button');_0x24dab6['textContent']=_0x1191a0['text'],_0x24dab6['onclick']=()=>{const _0x5520ec=_0x1d33c9;_0x16c029[_0x5520ec(0x505)][_0x5520ec(0x957)]('visible'),_0x597855(_0x1191a0[_0x5520ec(0xf27)]);},_0xcc0402[_0x1d33c9(0x120c)](_0x24dab6);});const _0xe47006=document[_0x616af7(0x383)]('button');_0xe47006[_0x616af7(0x300)]='取消',_0xe47006[_0x616af7(0x794)][_0x616af7(0xec7)]=_0x616af7(0xbfe),_0xe47006[_0x616af7(0x794)][_0x616af7(0x12e5)]=_0x616af7(0xbfe),_0xe47006[_0x616af7(0x794)][_0x616af7(0x556)]=_0x616af7(0x11db),_0xe47006[_0x616af7(0x1074)]=()=>{const _0x4b5c8d=_0x616af7;_0x16c029[_0x4b5c8d(0x505)][_0x4b5c8d(0x957)](_0x4b5c8d(0x250)),_0x597855(null);},_0xcc0402['appendChild'](_0xe47006),_0x16c029[_0x616af7(0x505)][_0x616af7(0x252)](_0x616af7(0x250));})[_0xf450b0(0xac8)](()=>{const _0x117dc3=_0xf450b0,_0x1004a0=document[_0x117dc3(0x5ac)](_0x117dc3(0xd86));_0x1004a0[_0x117dc3(0x794)]['flexDirection']=_0x117dc3(0x1069),_0x1004a0[_0x117dc3(0x595)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x117dc3(0x11e3)]('custom-modal-cancel')['addEventListener'](_0x117dc3(0x1041),_0x225a39);});}async function _0x128ad1(){const _0x4ee823=_0x241b18,_0x37a3c1=await _0x16a8e1(_0x4ee823(0x1265),[{'text':_0x4ee823(0x11d2),'value':_0x4ee823(0x373)},{'text':_0x4ee823(0xe2f),'value':_0x4ee823(0x90f)}]);if(_0x37a3c1===_0x4ee823(0x373))return new Promise(_0x3880bd=>{const _0x36c9f8=_0x4ee823,_0x3afd08=document[_0x36c9f8(0x11e3)](_0x36c9f8(0x895)),_0x5473e4=_0x21d20c=>{const _0x2e3a22=_0x36c9f8,_0x3d5f36=_0x21d20c[_0x2e3a22(0xd7c)][_0x2e3a22(0x5c9)][0x0];if(_0x3d5f36){const _0x321a70=new FileReader();_0x321a70[_0x2e3a22(0x1e5)]=_0x1e24c1=>_0x3880bd(_0x1e24c1[_0x2e3a22(0xd7c)][_0x2e3a22(0x255)]),_0x321a70[_0x2e3a22(0x741)]=()=>_0x3880bd(''),_0x321a70[_0x2e3a22(0x1011)](_0x3d5f36);}else _0x3880bd(null);_0x3afd08[_0x2e3a22(0xd7a)](_0x2e3a22(0xfeb),_0x5473e4),_0x3afd08[_0x2e3a22(0xf27)]='';};_0x3afd08[_0x36c9f8(0x4b8)](_0x36c9f8(0xfeb),_0x5473e4,{'once':!![]}),_0x3afd08[_0x36c9f8(0x1041)]();});else{if(_0x37a3c1==='paste'){const _0x21dacb=await _0x231a5a(_0x4ee823(0x59e),'请在此处粘贴完整的LRC格式歌词...','','textarea');if(_0x21dacb){const _0x3c29d1=_0x21dacb['replace'](/\[/g,'\x0a[')[_0x4ee823(0xeb7)]();return _0x3c29d1;}return _0x21dacb;}else return null;}}_0x2e83f8[_0x241b18(0x168)](0x27)[_0x241b18(0xffe)]({'doubanPosts':_0x241b18(0x111d),'chats':_0x241b18(0x5e5),'apiConfig':_0x241b18(0xcbe),'globalSettings':'&id','userStickers':_0x241b18(0x108e),'worldBooks':_0x241b18(0x15c),'worldBookCategories':_0x241b18(0xca1),'musicLibrary':_0x241b18(0xeff),'personaPresets':_0x241b18(0xeff),'qzoneSettings':_0x241b18(0xeff),'qzonePosts':_0x241b18(0x16c),'qzoneAlbums':'++id,\x20name,\x20createdAt','qzonePhotos':_0x241b18(0xd09),'favorites':'++id,\x20type,\x20timestamp,\x20originalTimestamp','qzoneGroups':_0x241b18(0xca1),'memories':_0x241b18(0x792),'callRecords':_0x241b18(0x760),'shoppingProducts':_0x241b18(0xcd5),'shoppingCategories':_0x241b18(0xca1),'apiPresets':'++id,\x20name','renderingRules':'++id,\x20name,\x20chatId','appearancePresets':'++id,\x20name,\x20type','stickerCategories':_0x241b18(0xca1),'customAvatarFrames':_0x241b18(0xca1),'presets':_0x241b18(0x15c),'presetCategories':_0x241b18(0xca1),'readingLibrary':_0x241b18(0x58d),'npcs':_0x241b18(0xc59)})[_0x241b18(0xb93)](_0x295874=>{const _0x2713e9=_0x241b18;return _0x295874['table'](_0x2713e9(0xca))[_0x2713e9(0x2ec)]()['modify'](_0x59d25b=>{const _0x13e0cc=_0x2713e9;if(typeof _0x59d25b[_0x13e0cc(0x9a5)]==='string'&&_0x59d25b[_0x13e0cc(0x9a5)]['trim']()!=='')_0x59d25b['content']=[{'keys':[],'comment':_0x13e0cc(0xead),'content':_0x59d25b['content']}];else!Array[_0x13e0cc(0xb7b)](_0x59d25b['content'])&&(_0x59d25b[_0x13e0cc(0x9a5)]=[]);_0x59d25b[_0x13e0cc(0x9a5)][_0x13e0cc(0x494)](_0x4ccd8c=>{const _0x491d9a=_0x13e0cc;typeof _0x4ccd8c[_0x491d9a(0xc34)]===_0x491d9a(0x679)&&(_0x4ccd8c[_0x491d9a(0xc34)]=!![]);});});}),window['db']=_0x2e83f8;function _0x4e7698(_0x438634){const _0x35635d=_0x241b18;_0x438634==='chat-list-screen'&&(window[_0x35635d(0x9d3)](),_0x1c77e7('messages-view'));if(_0x438634===_0x35635d(0x21f))window[_0x35635d(0x1e7)]();if(_0x438634==='wallpaper-screen')window[_0x35635d(0x10a9)]();if(_0x438634==='world-book-screen')window[_0x35635d(0xd0f)]();if(_0x438634===_0x35635d(0xf49))window[_0x35635d(0x639)]();if(_0x438634==='douban-screen')_0x5f3633();document[_0x35635d(0x10d6)](_0x35635d(0xedf))['forEach'](_0x1d1bad=>_0x1d1bad[_0x35635d(0x505)]['remove'](_0x35635d(0x1fc)));const _0x587602=document[_0x35635d(0x11e3)](_0x438634);if(_0x587602)_0x587602[_0x35635d(0x505)]['add'](_0x35635d(0x1fc));if(_0x438634===_0x35635d(0x9fc))window['updateListenTogetherIconProxy'](_0x5de8b7['activeChatId']);_0x438634===_0x35635d(0x2c3)&&(_0xf958bd(),document[_0x35635d(0x11e3)](_0x35635d(0x5b3))[_0x35635d(0xf27)]=_0x5de8b7[_0x35635d(0x2df)][_0x35635d(0xcd8)]||'',_0x58687c(_0x5de8b7[_0x35635d(0x2df)][_0x35635d(0xcd8)]||'',!![]));}window['updateListenTogetherIconProxy']=()=>{};function _0x1c77e7(_0x59fa05){const _0x349f67=_0x241b18,_0x2e4d29=document[_0x349f67(0x11e3)](_0x349f67(0xf1e)),_0x3e929c={'messages-view':document[_0x349f67(0x11e3)]('messages-view'),'qzone-screen':document[_0x349f67(0x11e3)](_0x349f67(0x431)),'favorites-view':document[_0x349f67(0x11e3)](_0x349f67(0xd51)),'memories-view':document[_0x349f67(0x11e3)](_0x349f67(0xf2)),'npc-list-view':document['getElementById']('npc-list-view')},_0x24e969=document['getElementById'](_0x349f67(0x10c)),_0x435193=document['getElementById'](_0x349f67(0x657));_0x1b417c&&document[_0x349f67(0x11e3)](_0x349f67(0x60e))[_0x349f67(0x1041)]();Object[_0x349f67(0x4ca)](_0x3e929c)[_0x349f67(0x494)](_0x5887d0=>_0x5887d0[_0x349f67(0x505)][_0x349f67(0x957)](_0x349f67(0x1fc)));_0x3e929c[_0x59fa05]&&_0x3e929c[_0x59fa05][_0x349f67(0x505)][_0x349f67(0x252)]('active');document[_0x349f67(0x10d6)](_0x349f67(0x405))[_0x349f67(0x494)](_0x4f8001=>{const _0x3b9e1b=_0x349f67;_0x4f8001[_0x3b9e1b(0x505)][_0x3b9e1b(0xe7e)](_0x3b9e1b(0x1fc),_0x4f8001[_0x3b9e1b(0xaca)][_0x3b9e1b(0x49b)]===_0x59fa05);});_0x59fa05===_0x349f67(0xde)?(_0x24e969[_0x349f67(0x794)][_0x349f67(0x33d)]='flex',_0x435193[_0x349f67(0x794)]['display']=_0x349f67(0x10f4)):(_0x24e969[_0x349f67(0x794)][_0x349f67(0x33d)]='none',_0x435193['style'][_0x349f67(0x33d)]=_0x349f67(0x379));_0x59fa05!=='memories-view'&&(_0x49b868['forEach'](_0x494992=>clearInterval(_0x494992)),_0x49b868=[]);switch(_0x59fa05){case _0x349f67(0x431):_0x3e929c[_0x349f67(0x431)][_0x349f67(0x794)][_0x349f67(0x556)]=_0x349f67(0x4fa),_0x22db5e(0x0),_0x59fc3f(),_0xae9c28();break;case _0x349f67(0xd51):_0x3e929c['favorites-view'][_0x349f67(0x794)][_0x349f67(0x556)]=_0x349f67(0x363),_0x2d2c08();break;case _0x349f67(0xde):break;case _0x349f67(0xd0e):_0xcf3709();break;}}function _0x4b1f02(){const _0x25bdec=_0x241b18;console[_0x25bdec(0x84b)](_0x25bdec(0x2f7));}window[_0x241b18(0x639)]=_0x4b1f02;function _0x59fc3f(){const _0x1833f7=_0x241b18;if(_0x5de8b7&&_0x5de8b7[_0x1833f7(0x1c5)]){const _0x8d076=_0x5de8b7[_0x1833f7(0x1c5)];document['getElementById'](_0x1833f7(0x11c5))[_0x1833f7(0x300)]=_0x8d076[_0x1833f7(0xa33)],document['getElementById']('qzone-avatar-img')[_0x1833f7(0xf0a)]=_0x8d076['avatar'],document[_0x1833f7(0x11e3)](_0x1833f7(0x10aa))['src']=_0x8d076['banner'];}}window[_0x241b18(0x88f)]=_0x59fc3f;async function _0x2a119b(){const _0x113a7e=_0x241b18;_0x2e83f8&&_0x5de8b7[_0x113a7e(0x1c5)]&&await _0x2e83f8[_0x113a7e(0x1c5)][_0x113a7e(0xe3c)](_0x5de8b7[_0x113a7e(0x1c5)]);}function _0x573f61(_0x35f0ef){const _0xcb1e1b=_0x241b18;if(!_0x35f0ef)return'';const _0x4d9716=new Date(),_0x283da9=new Date(_0x35f0ef),_0x3b4c2c=Math[_0xcb1e1b(0xfb1)]((_0x4d9716-_0x283da9)/0x3e8),_0x28b9e6=Math['floor'](_0x3b4c2c/0x3c),_0x1a2768=Math['floor'](_0x28b9e6/0x3c);if(_0x28b9e6<0x1)return'刚刚';if(_0x28b9e6<0x3c)return _0x28b9e6+_0xcb1e1b(0x943);if(_0x1a2768<0x18)return _0x1a2768+_0xcb1e1b(0x1ce);const _0x3b6162=_0x283da9[_0xcb1e1b(0x177)](),_0x22c47f=String(_0x283da9[_0xcb1e1b(0x39d)]()+0x1)[_0xcb1e1b(0xae4)](0x2,'0'),_0xec502e=String(_0x283da9['getDate']())[_0xcb1e1b(0xae4)](0x2,'0'),_0x321bed=String(_0x283da9[_0xcb1e1b(0x3de)]())[_0xcb1e1b(0xae4)](0x2,'0'),_0x4db52c=String(_0x283da9[_0xcb1e1b(0xf39)]())[_0xcb1e1b(0xae4)](0x2,'0');return _0x4d9716[_0xcb1e1b(0x177)]()===_0x3b6162?_0x22c47f+'-'+_0xec502e+'\x20'+_0x321bed+':'+_0x4db52c:_0x3b6162+'-'+_0x22c47f+'-'+_0xec502e+'\x20'+_0x321bed+':'+_0x4db52c;}function _0x29ada4(_0x5653c8){const _0x99f16d=_0x241b18,_0x15b582=document[_0x99f16d(0x5ac)]('.qzone-post-container[data-post-id=\x22'+_0x5653c8['id']+'\x22]'),_0x21bbab=!!_0x15b582,_0x5d69b7=_0x21bbab?_0x15b582:document['createElement'](_0x99f16d(0x1285));!_0x21bbab&&(_0x5d69b7['className']=_0x99f16d(0xb73),_0x5d69b7[_0x99f16d(0xaca)][_0x99f16d(0x2f0)]=_0x5653c8['id']);const _0x5d0151=_0x21bbab?_0x5d69b7[_0x99f16d(0x5ac)](_0x99f16d(0x866)):document[_0x99f16d(0x383)](_0x99f16d(0x1285));!_0x21bbab&&(_0x5d0151[_0x99f16d(0x3db)]=_0x99f16d(0xacf));let _0x304550='',_0xaedaa9='',_0x412729=_0x5de8b7['qzoneSettings']['avatar'];if(_0x5653c8[_0x99f16d(0x5d9)]===_0x99f16d(0x21c))_0x304550=_0x5de8b7[_0x99f16d(0x1c5)][_0x99f16d(0x525)],_0xaedaa9=_0x5de8b7['qzoneSettings'][_0x99f16d(0xa33)];else{if(_0x5de8b7[_0x99f16d(0x737)][_0x5653c8[_0x99f16d(0x5d9)]]){const _0x3c083d=_0x5de8b7[_0x99f16d(0x737)][_0x5653c8['authorId']];_0x304550=_0x3c083d[_0x99f16d(0x761)][_0x99f16d(0x5e0)]||_0x3d2e44,_0xaedaa9=_0x3c083d[_0x99f16d(0x278)];}else _0xaedaa9=_0x4a0eba(_0x5653c8[_0x99f16d(0x1211)]),_0x304550=_0x3d2e44;}function _0xb46d57(_0x48fa6a){const _0x5c96e8=_0x99f16d;let _0xdcf728='';const _0x4e0b8c=_0x48fa6a[_0x5c96e8(0x12aa)]?_0x5c96e8(0xb0)+_0x5a9a9e(_0x48fa6a['publicText'])[_0x5c96e8(0x1018)](/\n/g,_0x5c96e8(0xf70))+_0x5c96e8(0xc5c):'';if(_0x48fa6a[_0x5c96e8(0xa20)]==='shuoshuo')_0xdcf728='<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>'+_0x5a9a9e(_0x48fa6a[_0x5c96e8(0x9a5)])[_0x5c96e8(0x1018)](/\n/g,_0x5c96e8(0xf70))+_0x5c96e8(0xc5c);else{if(_0x48fa6a[_0x5c96e8(0xa20)]===_0x5c96e8(0x332)&&_0x48fa6a[_0x5c96e8(0xf44)])_0xdcf728=_0x4e0b8c?_0x4e0b8c+_0x5c96e8(0x1087)+_0x48fa6a[_0x5c96e8(0xf44)]+_0x5c96e8(0x829):_0x5c96e8(0x13b)+_0x48fa6a[_0x5c96e8(0xf44)]+_0x5c96e8(0xb1c);else{if(_0x48fa6a['type']==='text_image'){const _0x296eec=_0x5de8b7[_0x5c96e8(0x2df)]['enableAiDrawing']&&_0x48fa6a[_0x5c96e8(0xee6)]?_0x5c96e8(0x35d)+_0x48fa6a[_0x5c96e8(0xee6)]:_0x5c96e8(0x23b);_0xdcf728=_0x4e0b8c?_0x4e0b8c+_0x5c96e8(0x1087)+_0x296eec+_0x5c96e8(0xcb0)+_0x48fa6a[_0x5c96e8(0x6f7)]+_0x5c96e8(0x95b):_0x5c96e8(0x13b)+_0x296eec+_0x5c96e8(0xcb0)+_0x48fa6a[_0x5c96e8(0x6f7)]+'\x22>';}else{if(_0x48fa6a[_0x5c96e8(0xa20)]==='naiimag'){const _0x2ed7ce=_0x48fa6a[_0x5c96e8(0x224)]||(_0x48fa6a[_0x5c96e8(0xf44)]?[_0x48fa6a[_0x5c96e8(0xf44)]]:[]);if(_0x2ed7ce[_0x5c96e8(0x594)]>0x0){const _0xe3c6d=_0x2ed7ce[_0x5c96e8(0x594)];let _0x4edc0e='';_0x4edc0e=_0x5c96e8(0x974)+_0xe3c6d+'\x22>',_0x2ed7ce[_0x5c96e8(0x494)]((_0x3ff374,_0x2f44e5)=>{const _0x45c51e=_0x5c96e8;_0x4edc0e+=_0x45c51e(0x13b)+_0x3ff374+'\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片'+(_0x2f44e5+0x1)+_0x45c51e(0x892);}),_0x4edc0e+=_0x5c96e8(0xc5c),_0xdcf728=_0x4e0b8c?''+_0x4e0b8c+_0x4edc0e:_0x4edc0e;}}}}}return _0xdcf728;}let _0x535b29;if(_0x5653c8['type']===_0x99f16d(0x45a)){const _0x521335=_0x5653c8[_0x99f16d(0x12a3)]?'<div\x20class=\x22post-content\x22>'+_0x5a9a9e(_0x5653c8['repostComment'])[_0x99f16d(0x1018)](/\n/g,_0x99f16d(0xf70))+_0x99f16d(0xc5c):'';let _0x27b5b9=_0x3d2e44,_0x16a425=_0x99f16d(0x5fe);if(_0x5653c8[_0x99f16d(0xdd1)]['authorId']===_0x99f16d(0x21c))_0x27b5b9=_0x5de8b7[_0x99f16d(0x1c5)][_0x99f16d(0x525)],_0x16a425=_0x5de8b7[_0x99f16d(0x1c5)][_0x99f16d(0xa33)];else{const _0xf53fa2=_0x5de8b7['chats'][_0x5653c8[_0x99f16d(0xdd1)][_0x99f16d(0x5d9)]];_0xf53fa2&&(_0x27b5b9=_0xf53fa2[_0x99f16d(0x761)][_0x99f16d(0x5e0)]||_0x3d2e44),_0x16a425=_0x4a0eba(_0x5653c8[_0x99f16d(0xdd1)][_0x99f16d(0x1211)]);}_0x535b29=_0x99f16d(0xfe0)+_0x521335+_0x99f16d(0xf55)+_0x27b5b9+_0x99f16d(0x356)+_0x16a425+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x573f61(_0x5653c8[_0x99f16d(0xdd1)]['timestamp'])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>'+_0xb46d57(_0x5653c8[_0x99f16d(0xdd1)])+_0x99f16d(0x68b);}else _0x535b29=_0x99f16d(0xc84)+_0xb46d57(_0x5653c8)+_0x99f16d(0xc5c);let _0x322928='';if(_0x5653c8['likes']&&_0x5653c8['likes'][_0x99f16d(0x594)]>0x0){const _0x3f7f8e=_0x5653c8[_0x99f16d(0x7eb)]['map'](_0x58d3ce=>_0x4a0eba(_0x58d3ce))['join']('、');_0x322928='<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>'+_0x3f7f8e+'\x20觉得很赞</span></div>';}let _0x6484e8='';_0x5653c8['comments']&&_0x5653c8[_0x99f16d(0x1092)][_0x99f16d(0x594)]>0x0&&(_0x6484e8=_0x99f16d(0x706),_0x5653c8[_0x99f16d(0x1092)][_0x99f16d(0x494)]((_0x5dee9f,_0x34d8bd)=>{const _0x1ad8bc=_0x99f16d;if(typeof _0x5dee9f===_0x1ad8bc(0x537)&&_0x5dee9f!==null&&_0x5dee9f['commenterName']){const _0x5c4a8e=_0x5dee9f[_0x1ad8bc(0x2ac)],_0xb746f1=_0x4a0eba(_0x5c4a8e);let _0x504027;_0x9f9ac4[_0x1ad8bc(0x1043)](_0x5dee9f[_0x1ad8bc(0x1197)])?_0x504027=_0x1ad8bc(0x13b)+_0x5dee9f[_0x1ad8bc(0x1197)]+_0x1ad8bc(0xfd):_0x504027=_0x5a9a9e(_0x5dee9f[_0x1ad8bc(0x1197)]);let _0x2f1f71='';if(_0x5dee9f['replyTo']){const _0x62a958=_0x4a0eba(_0x5dee9f[_0x1ad8bc(0x1083)]);_0x2f1f71=_0x1ad8bc(0xd68)+_0xb746f1+_0x1ad8bc(0x782)+_0x62a958+_0x1ad8bc(0xff1)+_0x504027;}else _0x2f1f71=_0x1ad8bc(0xd68)+_0xb746f1+_0x1ad8bc(0xff1)+_0x504027;_0x6484e8+=_0x1ad8bc(0x715)+_0x5653c8['id']+_0x1ad8bc(0xe16)+_0x5c4a8e+_0x1ad8bc(0x83d)+_0xb746f1+_0x1ad8bc(0x82c)+_0x2f1f71+_0x1ad8bc(0x50f)+_0x34d8bd+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}else _0x6484e8+=_0x1ad8bc(0x965)+_0x5a9a9e(String(_0x5dee9f))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}),_0x6484e8+=_0x99f16d(0xc5c));const _0x50bd3a=_0x5de8b7['qzoneSettings'][_0x99f16d(0xa33)],_0x4394b5=_0x5653c8[_0x99f16d(0x7eb)]&&_0x5653c8[_0x99f16d(0x7eb)]['includes'](_0x50bd3a),_0x2dc4e8=_0x5de8b7[_0x99f16d(0x41d)]&&_0x5de8b7[_0x99f16d(0x41d)]['has'](_0x5653c8['id']);let _0x6456c8='';_0x5653c8[_0x99f16d(0xa20)]!==_0x99f16d(0x45a)&&(_0x6456c8=_0x99f16d(0x509));_0x5d0151[_0x99f16d(0x595)]=_0x99f16d(0x5d6)+_0x304550+'\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22'+_0x5653c8[_0x99f16d(0x5d9)]+_0x99f16d(0xc0a)+_0xaedaa9+_0x99f16d(0x10a3)+_0x573f61(_0x5653c8['timestamp'])+_0x99f16d(0x10f3)+_0x535b29+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x6456c8+_0x99f16d(0x752)+(_0x4394b5?_0x99f16d(0x1fc):'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20'+(_0x2dc4e8?_0x99f16d(0x1fc):'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x322928+_0x99f16d(0x91e)+_0x6484e8+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x412729+_0x99f16d(0x608);if(!_0x21bbab){const _0x3ea085=document[_0x99f16d(0x383)](_0x99f16d(0x1285));_0x3ea085['className']=_0x99f16d(0xd4d),_0x3ea085[_0x99f16d(0x595)]=_0x99f16d(0xe8c),_0x5d69b7['appendChild'](_0x5d0151),_0x5d69b7[_0x99f16d(0x120c)](_0x3ea085);}return _0x5d69b7;}async function _0x4e2ca1(_0x3c64cc){const _0x25fd10=_0x241b18,_0x59f590=await _0x2e83f8[_0x25fd10(0x1218)][_0x25fd10(0x1289)](_0x3c64cc);if(!_0x59f590){const _0x39b8ba=document[_0x25fd10(0x5ac)](_0x25fd10(0xf89)+_0x3c64cc+'\x22]');if(_0x39b8ba)_0x39b8ba[_0x25fd10(0x957)]();return;}const _0x28e34b=_0x2814a8[_0x25fd10(0x901)](_0x56eafc=>_0x56eafc['id']===_0x3c64cc);if(_0x28e34b>-0x1)_0x2814a8[_0x28e34b]=_0x59f590;const _0x46daae=await _0x2e83f8[_0x25fd10(0xc3e)][_0x25fd10(0x129e)](_0x25fd10(0xa20))[_0x25fd10(0x119e)](_0x25fd10(0x3cc))[_0x25fd10(0x508)]();_0x5de8b7['favoritedPostIds']=new Set(_0x46daae['map'](_0xfb9be0=>_0xfb9be0[_0x25fd10(0x9a5)]['id'])),_0x29ada4(_0x59f590);}function _0x497f2b(_0x30dea0){const _0x51d56c=_0x241b18,_0x47595a=Date[_0x51d56c(0x1182)](),_0x239b46=Math[_0x51d56c(0xfb1)]((_0x47595a-_0x30dea0)/0x3e8),_0x421715=Math['floor'](_0x239b46/0x3c);if(_0x421715<0x2)return'刚刚';if(_0x421715<0x3c)return _0x421715+_0x51d56c(0x943);const _0x5ac4bc=Math[_0x51d56c(0xfb1)](_0x421715/0x3c);if(_0x5ac4bc<0x18)return _0x5ac4bc+'小时前';const _0x1f8ae7=Math['floor'](_0x5ac4bc/0x18);return _0x1f8ae7+'天前';}async function _0x29ada4(_0x5e73e6){const _0x156562=_0x241b18,_0xbcc60=document[_0x156562(0x5ac)](_0x156562(0xf89)+_0x5e73e6['id']+'\x22]'),_0x49a682=!!_0xbcc60,_0x3c38d8=_0x49a682?_0xbcc60:document[_0x156562(0x383)]('div');!_0x49a682&&(_0x3c38d8['className']=_0x156562(0xb73),_0x3c38d8[_0x156562(0xaca)]['postId']=_0x5e73e6['id']);const _0x3334ad=_0x49a682?_0x3c38d8['querySelector'](_0x156562(0x866)):document[_0x156562(0x383)](_0x156562(0x1285));!_0x49a682&&(_0x3334ad[_0x156562(0x3db)]=_0x156562(0xacf));let _0x3efc27='',_0x29d0ff='',_0x189dff=_0x5de8b7[_0x156562(0x1c5)][_0x156562(0x525)];if(_0x5e73e6[_0x156562(0x5d9)]==='user')_0x3efc27=_0x5de8b7[_0x156562(0x1c5)][_0x156562(0x525)],_0x29d0ff=_0x5de8b7['qzoneSettings'][_0x156562(0xa33)];else{if(_0x5de8b7[_0x156562(0x737)][_0x5e73e6[_0x156562(0x5d9)]]){const _0x5e3282=_0x5de8b7[_0x156562(0x737)][_0x5e73e6[_0x156562(0x5d9)]];_0x3efc27=_0x5e3282[_0x156562(0x761)]['aiAvatar']||_0x3d2e44,_0x29d0ff=_0x5e3282[_0x156562(0x278)];}else{if(String(_0x5e73e6[_0x156562(0x5d9)])[_0x156562(0xb6c)](_0x156562(0x8b8))){const _0x1e0211=parseInt(String(_0x5e73e6['authorId'])[_0x156562(0x1018)](_0x156562(0x8b8),''));if(!isNaN(_0x1e0211)){const _0x3e05a1=await _0x2e83f8[_0x156562(0xf00)][_0x156562(0x1289)](_0x1e0211);_0x3e05a1?(_0x3efc27=_0x3e05a1[_0x156562(0x525)]||_0x4d9574,_0x29d0ff=_0x3e05a1[_0x156562(0x278)]):(_0x29d0ff=_0x5e73e6['authorOriginalName']||_0x156562(0x78e),_0x3efc27=_0x4d9574);}}else _0x29d0ff=_0x4a0eba(_0x5e73e6[_0x156562(0x1211)]),_0x3efc27=_0x3d2e44;}}function _0x342fd6(_0x32aef2){const _0x4062ce=_0x156562;let _0x485326='';const _0x31ab3e=_0x32aef2[_0x4062ce(0x12aa)]?_0x4062ce(0xb0)+_0x5a9a9e(_0x32aef2['publicText'])['replace'](/\n/g,_0x4062ce(0xf70))+'</div>':'';if(_0x32aef2['type']==='shuoshuo')_0x485326=_0x4062ce(0x993)+_0x5a9a9e(_0x32aef2[_0x4062ce(0x9a5)])[_0x4062ce(0x1018)](/\n/g,_0x4062ce(0xf70))+_0x4062ce(0xc5c);else{if(_0x32aef2[_0x4062ce(0xa20)]==='image_post'&&_0x32aef2[_0x4062ce(0xf44)])_0x485326=_0x31ab3e?_0x31ab3e+_0x4062ce(0x1087)+_0x32aef2[_0x4062ce(0xf44)]+'\x22\x20class=\x22chat-image\x22></div>':'<img\x20src=\x22'+_0x32aef2[_0x4062ce(0xf44)]+'\x22\x20class=\x22chat-image\x22>';else{if(_0x32aef2['type']==='text_image'){const _0x5d9ba7=_0x5de8b7[_0x4062ce(0x2df)]['enableAiDrawing']&&_0x32aef2[_0x4062ce(0xee6)]?_0x4062ce(0x35d)+_0x32aef2[_0x4062ce(0xee6)]:_0x4062ce(0x23b);_0x485326=_0x31ab3e?_0x31ab3e+_0x4062ce(0x1087)+_0x5d9ba7+_0x4062ce(0xcb0)+_0x32aef2[_0x4062ce(0x6f7)]+'\x22></div>':_0x4062ce(0x13b)+_0x5d9ba7+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x32aef2['hiddenContent']+'\x22>';}else{if(_0x32aef2[_0x4062ce(0xa20)]===_0x4062ce(0xcb1)){const _0x2a2b06=_0x32aef2[_0x4062ce(0x224)]||(_0x32aef2[_0x4062ce(0xf44)]?[_0x32aef2[_0x4062ce(0xf44)]]:[]);if(_0x2a2b06[_0x4062ce(0x594)]>0x0){const _0x3cd5bb=_0x2a2b06[_0x4062ce(0x594)];let _0x34bd5e='';_0x34bd5e='<div\x20class=\x22post-images-grid\x20grid-'+_0x3cd5bb+'\x22>',_0x2a2b06['forEach']((_0x4a6fd3,_0x19e190)=>{const _0x2ac5dc=_0x4062ce;_0x34bd5e+=_0x2ac5dc(0x13b)+_0x4a6fd3+_0x2ac5dc(0x1149)+(_0x19e190+0x1)+_0x2ac5dc(0x892);}),_0x34bd5e+=_0x4062ce(0xc5c),_0x485326=_0x31ab3e?''+_0x31ab3e+_0x34bd5e:_0x34bd5e;}}}}}return _0x485326;}let _0x478908;if(_0x5e73e6[_0x156562(0xa20)]==='repost'){const _0x290aab=_0x5e73e6['repostComment']?_0x156562(0xb0)+_0x5e73e6[_0x156562(0x12a3)][_0x156562(0x1018)](/\n/g,_0x156562(0xf70))+'</div>':'';let _0x159e78=_0x3d2e44,_0xa455f8='原作者';if(_0x5e73e6[_0x156562(0xdd1)][_0x156562(0x5d9)]===_0x156562(0x21c))_0x159e78=_0x5de8b7[_0x156562(0x1c5)][_0x156562(0x525)],_0xa455f8=_0x5de8b7[_0x156562(0x1c5)][_0x156562(0xa33)];else{const _0xd3b250=_0x5de8b7[_0x156562(0x737)][_0x5e73e6['originalPost'][_0x156562(0x5d9)]];_0xd3b250&&(_0x159e78=_0xd3b250['settings'][_0x156562(0x5e0)]||_0x3d2e44),_0xa455f8=_0x4a0eba(_0x5e73e6[_0x156562(0xdd1)]['authorOriginalName']);}_0x478908=_0x156562(0xfe0)+_0x290aab+_0x156562(0xf55)+_0x159e78+_0x156562(0x356)+_0xa455f8+_0x156562(0x8dc)+_0x573f61(_0x5e73e6[_0x156562(0xdd1)][_0x156562(0x702)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>'+_0x342fd6(_0x5e73e6[_0x156562(0xdd1)])+_0x156562(0x68b);}else _0x478908='<div\x20class=\x22post-main-content\x22>'+_0x342fd6(_0x5e73e6)+_0x156562(0xc5c);let _0x2a3b15='';if(_0x5e73e6[_0x156562(0x7eb)]&&_0x5e73e6[_0x156562(0x7eb)][_0x156562(0x594)]>0x0){const _0x55b924=_0x5e73e6[_0x156562(0x7eb)]['map'](_0x24ddbf=>_0x4a0eba(_0x24ddbf))[_0x156562(0xa4b)]('、');_0x2a3b15=_0x156562(0xede)+_0x55b924+'\x20觉得很赞</span></div>';}let _0x4d2f2c='';_0x5e73e6['comments']&&_0x5e73e6[_0x156562(0x1092)][_0x156562(0x594)]>0x0&&(_0x4d2f2c=_0x156562(0x706),_0x5e73e6[_0x156562(0x1092)][_0x156562(0x494)]((_0x30221d,_0x387fcd)=>{const _0xaf7fdc=_0x156562;if(typeof _0x30221d===_0xaf7fdc(0x537)&&_0x30221d!==null&&_0x30221d[_0xaf7fdc(0x2ac)]){const _0x1049ca=_0x30221d['commenterName'],_0x52af3c=_0x4a0eba(_0x1049ca);let _0x32d915;_0x9f9ac4[_0xaf7fdc(0x1043)](_0x30221d[_0xaf7fdc(0x1197)])?_0x32d915=_0xaf7fdc(0x13b)+_0x30221d[_0xaf7fdc(0x1197)]+_0xaf7fdc(0xfd):_0x32d915=_0x5a9a9e(_0x30221d[_0xaf7fdc(0x1197)]);let _0x107781='';if(_0x30221d['replyTo']){const _0x19b1f4=_0x4a0eba(_0x30221d[_0xaf7fdc(0x1083)]);_0x107781=_0xaf7fdc(0xd68)+_0x52af3c+_0xaf7fdc(0x782)+_0x19b1f4+_0xaf7fdc(0xff1)+_0x32d915;}else _0x107781='<span\x20class=\x22commenter-name\x22>'+_0x52af3c+'</span>:\x20'+_0x32d915;_0x4d2f2c+='<div\x20class=\x22comment-item\x22\x20data-post-id=\x22'+_0x5e73e6['id']+_0xaf7fdc(0xe16)+_0x1049ca+'\x22\x20data-commenter-display-name=\x22'+_0x52af3c+_0xaf7fdc(0x82c)+_0x107781+_0xaf7fdc(0x50f)+_0x387fcd+_0xaf7fdc(0x108);}else _0x4d2f2c+=_0xaf7fdc(0x965)+String(_0x30221d)+_0xaf7fdc(0xe10);}),_0x4d2f2c+=_0x156562(0xc5c));const _0x5bff4e=_0x5de8b7[_0x156562(0x1c5)][_0x156562(0xa33)],_0x16de4e=_0x5e73e6['likes']&&_0x5e73e6['likes'][_0x156562(0x3ad)](_0x5bff4e),_0x9bd613=_0x5de8b7[_0x156562(0x41d)]&&_0x5de8b7[_0x156562(0x41d)][_0x156562(0x72a)](_0x5e73e6['id']);let _0x552ec1='';_0x5e73e6[_0x156562(0xa20)]!==_0x156562(0x45a)&&(_0x552ec1=_0x156562(0x509));_0x3334ad['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3efc27+_0x156562(0xe55)+_0x5e73e6[_0x156562(0x5d9)]+_0x156562(0xc0a)+_0x29d0ff+_0x156562(0x10a3)+_0x573f61(_0x5e73e6[_0x156562(0x702)])+_0x156562(0x10f3)+_0x478908+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x552ec1+_0x156562(0x752)+(_0x16de4e?_0x156562(0x1fc):'')+_0x156562(0xcc6)+(_0x9bd613?'active':'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2a3b15+_0x156562(0x91e)+_0x4d2f2c+_0x156562(0xfbd)+_0x189dff+'\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';if(!_0x49a682){const _0x21b09d=document[_0x156562(0x383)](_0x156562(0x1285));_0x21b09d[_0x156562(0x3db)]=_0x156562(0xd4d),_0x21b09d['innerHTML']=_0x156562(0xe8c),_0x3c38d8[_0x156562(0x120c)](_0x3334ad),_0x3c38d8[_0x156562(0x120c)](_0x21b09d);}return _0x3c38d8;}async function _0x4e2ca1(_0x1d2c5e){const _0xe8e510=_0x241b18,_0x588351=await _0x2e83f8[_0xe8e510(0x1218)][_0xe8e510(0x1289)](_0x1d2c5e);if(!_0x588351){const _0x213ee4=document[_0xe8e510(0x5ac)](_0xe8e510(0xf89)+_0x1d2c5e+'\x22]');_0x213ee4&&_0x213ee4['remove']();return;}const _0x39ab21=_0x2814a8[_0xe8e510(0x901)](_0x20126e=>_0x20126e['id']===_0x1d2c5e);_0x39ab21>-0x1&&(_0x2814a8[_0x39ab21]=_0x588351);const _0x47f606=await _0x2e83f8[_0xe8e510(0xc3e)][_0xe8e510(0x129e)](_0xe8e510(0xa20))['equals'](_0xe8e510(0x3cc))[_0xe8e510(0x508)]();_0x5de8b7[_0xe8e510(0x41d)]=new Set(_0x47f606[_0xe8e510(0x796)](_0x33ca02=>_0x33ca02[_0xe8e510(0x9a5)]['id'])),await _0x29ada4(_0x588351);}async function _0xae9c28(){const _0x48915a=_0x241b18,_0x47385b=document[_0x48915a(0x11e3)](_0x48915a(0x4f7));if(!_0x47385b)return;const [_0x471dba,_0x4a4410]=await Promise[_0x48915a(0xd4a)]([_0x2e83f8[_0x48915a(0x1218)][_0x48915a(0x7c6)]('timestamp')[_0x48915a(0x107)]()[_0x48915a(0x138)](_0x35fbaf=>!_0x35fbaf['isDeleted'])[_0x48915a(0x508)](),_0x2e83f8[_0x48915a(0xc3e)]['where'](_0x48915a(0xa20))[_0x48915a(0x119e)](_0x48915a(0x3cc))[_0x48915a(0x508)]()]);_0x2814a8=_0x471dba,_0x5de8b7[_0x48915a(0x41d)]=new Set(_0x4a4410['map'](_0x4d562f=>_0x4d562f[_0x48915a(0x9a5)]['id'])),_0x47385b[_0x48915a(0x595)]='',_0x4f3fd1=0x0;if(_0x2814a8[_0x48915a(0x594)]===0x0){_0x47385b[_0x48915a(0x595)]=_0x48915a(0x1236);return;}_0x314b99();}async function _0x314b99(){const _0x44d737=_0x241b18;if(_0x48f5d6)return;_0x48f5d6=!![];const _0x243984=document[_0x44d737(0x11e3)]('qzone-posts-list');if(!_0x243984){_0x48f5d6=![];return;}_0x28c761(_0x243984,'bottom'),setTimeout(async()=>{const _0x52fa0c=_0x44d737;_0x313362(_0x243984);const _0x37a8f5=_0x4f3fd1,_0x2efd70=_0x4f3fd1+_0x33ebc3,_0x41153e=_0x2814a8[_0x52fa0c(0xa6c)](_0x37a8f5,_0x2efd70),_0x349832=document['createDocumentFragment']();for(const _0x4316a9 of _0x41153e){const _0x33ba2d=await _0x29ada4(_0x4316a9);_0x349832[_0x52fa0c(0x120c)](_0x33ba2d);}_0x243984[_0x52fa0c(0x120c)](_0x349832),_0x4f3fd1+=_0x41153e[_0x52fa0c(0x594)],_0x48f5d6=![];},0x1f4);}function _0x36b24c(_0x433b01,_0x2def0a){const _0x35368b=_0x241b18,_0x348ed1=_0x29da69[_0x35368b(0x7a8)],_0x5702b3=_0x29da69['gridEl'];_0x5702b3[_0x35368b(0x595)]='';_0x5de8b7[_0x35368b(0xa67)][_0x35368b(0x594)]===0x0?_0x5702b3[_0x35368b(0x595)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>':_0x5de8b7['userStickers'][_0x35368b(0x494)](_0x2e25aa=>{const _0x4b1f45=_0x35368b,_0x385a21=document['createElement'](_0x4b1f45(0x1285));_0x385a21[_0x4b1f45(0x3db)]=_0x4b1f45(0x10bf),_0x385a21[_0x4b1f45(0x794)][_0x4b1f45(0x123e)]=_0x4b1f45(0xac7)+_0x2e25aa['url']+')',_0x385a21['title']=_0x2e25aa['name'],_0x5702b3[_0x4b1f45(0x120c)](_0x385a21);});const _0x5beaa9=_0x2def0a[_0x35368b(0x106b)](),_0x44ec40=document[_0x35368b(0x11e3)](_0x35368b(0x1e6))['getBoundingClientRect']();_0x348ed1[_0x35368b(0x794)][_0x35368b(0x33d)]=_0x35368b(0x10f4);const _0x5cf36b=_0x348ed1[_0x35368b(0x106b)](),_0x7dbe23=_0x5cf36b[_0x35368b(0x10f2)],_0x60fe11=_0x5cf36b[_0x35368b(0x1057)];_0x348ed1[_0x35368b(0x794)][_0x35368b(0x10e2)]=_0x5beaa9[_0x35368b(0x10e2)]-_0x7dbe23-0x5-_0x44ec40[_0x35368b(0x10e2)]+'px';const _0x37aa35=_0x5beaa9['left']-_0x44ec40[_0x35368b(0x910)];_0x37aa35+_0x60fe11>_0x44ec40['width']?(_0x348ed1[_0x35368b(0x794)][_0x35368b(0x910)]=_0x35368b(0x11f7),_0x348ed1[_0x35368b(0x794)]['right']=_0x35368b(0x1038)):(_0x348ed1[_0x35368b(0x794)][_0x35368b(0x910)]=_0x37aa35+'px',_0x348ed1[_0x35368b(0x794)]['right']=_0x35368b(0x11f7)),_0x29da69['isOpen']=!![],_0x29da69[_0x35368b(0xa2c)]=_0x433b01;}function _0x33db3a(){const _0x3452cf=_0x241b18;_0x29da69['isOpen']&&(_0x29da69[_0x3452cf(0x7a8)]['style'][_0x3452cf(0x33d)]=_0x3452cf(0x379),_0x29da69['isOpen']=![],_0x29da69['activePostId']=null);}async function _0x134f69(_0x373c7f,_0x2c6b80){const _0x17c61c=_0x241b18;if(!_0x2c6b80||!_0x2c6b80['url'])return;const _0x45d4b2=await _0x2e83f8[_0x17c61c(0x1218)][_0x17c61c(0x1289)](_0x373c7f);if(!_0x45d4b2){console[_0x17c61c(0x1c1)](_0x17c61c(0x43e),_0x373c7f);return;}!_0x45d4b2[_0x17c61c(0x1092)]&&(_0x45d4b2[_0x17c61c(0x1092)]=[]);const _0x4ffbb2={'commenterName':_0x5de8b7[_0x17c61c(0x1c5)][_0x17c61c(0xa33)],'text':_0x2c6b80['url'],'meaning':_0x2c6b80[_0x17c61c(0x278)],'timestamp':Date[_0x17c61c(0x1182)]()};_0x45d4b2[_0x17c61c(0x1092)]['push'](_0x4ffbb2),await _0x2e83f8[_0x17c61c(0x1218)]['update'](_0x373c7f,{'comments':_0x45d4b2['comments']}),_0x33db3a(),await _0xae9c28();const _0xda353c=(_0x45d4b2[_0x17c61c(0x12aa)]||_0x45d4b2['content']||'[图片动态]')['substring'](0x0,0x1e);for(const _0x9c4a8b in _0x5de8b7[_0x17c61c(0x737)]){const _0x11981b=_0x5de8b7[_0x17c61c(0x737)][_0x9c4a8b];if(!_0x11981b['isGroup']){const _0x23cce2='[系统提示：\x27'+_0x5de8b7['qzoneSettings'][_0x17c61c(0xa33)]+_0x17c61c(0xaa)+_0x373c7f+_0x17c61c(0x9ea)+_0xda353c+_0x17c61c(0x628)+_0x2c6b80['name']+_0x17c61c(0x81f),_0x1b34e0={'role':_0x17c61c(0xf72),'content':_0x23cce2,'timestamp':Date[_0x17c61c(0x1182)](),'isHidden':!![]};_0x11981b[_0x17c61c(0x49e)][_0x17c61c(0xf5)](_0x1b34e0),await _0x2e83f8[_0x17c61c(0x737)][_0x17c61c(0xe3c)](_0x11981b);}}}function _0x1e8be1(_0x2f17ed){const _0x34ab73=_0x241b18;_0x4add6d=_0x2f17ed,document[_0x34ab73(0x11e3)]('repost-comment-input')[_0x34ab73(0xf27)]='',document[_0x34ab73(0x11e3)]('repost-modal')[_0x34ab73(0x505)][_0x34ab73(0x252)]('visible');}function _0x8142be(){const _0x5d65ea=_0x241b18;document[_0x5d65ea(0x11e3)](_0x5d65ea(0x17e))['classList']['remove'](_0x5d65ea(0x250)),_0x4add6d=null;}async function _0x29cb6e(){const _0x57a23e=_0x241b18;if(!_0x4add6d)return;const _0x417380=document[_0x57a23e(0x11e3)](_0x57a23e(0x73d))[_0x57a23e(0xf27)][_0x57a23e(0xeb7)](),_0x473070=await _0x2e83f8[_0x57a23e(0x1218)][_0x57a23e(0x1289)](_0x4add6d);if(!_0x473070){alert(_0x57a23e(0xb97)),_0x8142be();return;}const _0x1fba81={'type':'repost','timestamp':Date[_0x57a23e(0x1182)](),'authorId':_0x57a23e(0x21c),'repostComment':_0x417380,'originalPost':_0x473070,'visibleGroupIds':null};await _0x2e83f8[_0x57a23e(0x1218)][_0x57a23e(0x252)](_0x1fba81),_0x8142be(),await _0xae9c28(),alert(_0x57a23e(0xaf2));}function _0x40f8c7(_0x108caf){const _0x3f7a5e=_0x241b18,_0x5c39a0=document[_0x3f7a5e(0x11e3)](_0x3f7a5e(0xa34));_0x5c39a0[_0x3f7a5e(0x595)]='';if(_0x108caf[_0x3f7a5e(0x594)]===0x0){const _0x281a80=document['getElementById']('favorites-search-input')[_0x3f7a5e(0xf27)],_0x6d7484=_0x281a80?_0x3f7a5e(0xee7):'你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！';_0x5c39a0[_0x3f7a5e(0x595)]=_0x3f7a5e(0x102a)+_0x6d7484+_0x3f7a5e(0xdc8);return;}for(const _0x3bf0eb of _0x108caf){const _0x249577=document[_0x3f7a5e(0x383)](_0x3f7a5e(0x1285));_0x249577[_0x3f7a5e(0x3db)]=_0x3f7a5e(0x18e),_0x249577['dataset'][_0x3f7a5e(0x52c)]=_0x3bf0eb['id'];let _0x3ee5a4='',_0x419120='',_0x277b32='',_0x64a487='';if(_0x3bf0eb[_0x3f7a5e(0xa20)]==='qzone_post'){const _0x186b55=_0x3bf0eb['content'];_0x277b32=_0x3f7a5e(0xcb3);let _0x55a2f1=_0x3d2e44,_0x12ecc7=_0x3f7a5e(0xcf4);if(_0x186b55[_0x3f7a5e(0x5d9)]===_0x3f7a5e(0x21c))_0x55a2f1=_0x5de8b7['qzoneSettings'][_0x3f7a5e(0x525)],_0x12ecc7=_0x5de8b7[_0x3f7a5e(0x1c5)][_0x3f7a5e(0xa33)];else _0x5de8b7[_0x3f7a5e(0x737)][_0x186b55['authorId']]&&(_0x55a2f1=_0x5de8b7[_0x3f7a5e(0x737)][_0x186b55['authorId']][_0x3f7a5e(0x761)][_0x3f7a5e(0x5e0)],_0x12ecc7=_0x5de8b7[_0x3f7a5e(0x737)][_0x186b55[_0x3f7a5e(0x5d9)]]['name']);_0x3ee5a4=_0x3f7a5e(0x13b)+_0x55a2f1+_0x3f7a5e(0xbb7)+_0x12ecc7+_0x3f7a5e(0xd9a);const _0x257dad=_0x186b55[_0x3f7a5e(0x12aa)]?_0x3f7a5e(0xb0)+_0x186b55['publicText']['replace'](/\n/g,_0x3f7a5e(0xf70))+'</div>':'';if(_0x186b55[_0x3f7a5e(0xa20)]===_0x3f7a5e(0xc40))_0x419120=_0x3f7a5e(0xb0)+_0x186b55[_0x3f7a5e(0x9a5)][_0x3f7a5e(0x1018)](/\n/g,_0x3f7a5e(0xf70))+_0x3f7a5e(0xc5c);else{if(_0x186b55['type']===_0x3f7a5e(0x332)&&_0x186b55[_0x3f7a5e(0xf44)]){const _0xf551b9=_0x5de8b7[_0x3f7a5e(0x2df)][_0x3f7a5e(0xbd4)]&&_0x186b55[_0x3f7a5e(0xee6)]?_0x3f7a5e(0x35d)+_0x186b55[_0x3f7a5e(0xee6)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x419120=_0x257dad?_0x257dad+_0x3f7a5e(0x1087)+_0xf551b9+_0x3f7a5e(0x829):'<img\x20src=\x22'+_0xf551b9+_0x3f7a5e(0xb1c);}else{if(_0x186b55[_0x3f7a5e(0xa20)]===_0x3f7a5e(0x887)){const _0x57643e=_0x5de8b7[_0x3f7a5e(0x2df)][_0x3f7a5e(0xbd4)]&&_0x186b55['image_prompt']?_0x3f7a5e(0x35d)+_0x186b55['image_prompt']:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x419120=_0x257dad?_0x257dad+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x57643e+_0x3f7a5e(0xcb0)+_0x186b55[_0x3f7a5e(0x6f7)]+'\x22></div>':'<img\x20src=\x22'+_0x57643e+_0x3f7a5e(0xcb0)+_0x186b55[_0x3f7a5e(0x6f7)]+'\x22>';}}}let _0x23366f='';_0x186b55['likes']&&_0x186b55[_0x3f7a5e(0x7eb)][_0x3f7a5e(0x594)]>0x0&&(_0x23366f=_0x3f7a5e(0x89b)+_0x186b55[_0x3f7a5e(0x7eb)][_0x3f7a5e(0xa4b)]('、')+'\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>');let _0x27b80a='';_0x186b55['comments']&&_0x186b55[_0x3f7a5e(0x1092)]['length']>0x0&&(_0x27b80a=_0x3f7a5e(0x706),_0x186b55[_0x3f7a5e(0x1092)][_0x3f7a5e(0x494)]((_0x3455f1,_0x26b20c)=>{const _0x5af14e=_0x3f7a5e;if(typeof _0x3455f1===_0x5af14e(0x537)&&_0x3455f1!==null&&_0x3455f1[_0x5af14e(0x2ac)]){const _0x5246ee=_0x3455f1[_0x5af14e(0x2ac)],_0x22b624=_0x4a0eba(_0x5246ee);let _0x1d49b2;_0x9f9ac4[_0x5af14e(0x1043)](_0x3455f1[_0x5af14e(0x1197)])?_0x1d49b2=_0x5af14e(0x13b)+_0x3455f1[_0x5af14e(0x1197)]+_0x5af14e(0xfd):_0x1d49b2=_0x3455f1[_0x5af14e(0x1197)];let _0x2ce60e='';if(_0x3455f1[_0x5af14e(0x1083)]){const _0x4b09d7=_0x4a0eba(_0x3455f1[_0x5af14e(0x1083)]);_0x2ce60e=_0x5af14e(0xd68)+_0x22b624+_0x5af14e(0x782)+_0x4b09d7+_0x5af14e(0xff1)+_0x1d49b2;}else _0x2ce60e=_0x5af14e(0xd68)+_0x22b624+'</span>:\x20'+_0x1d49b2;_0x27b80a+=_0x5af14e(0x715)+_0x186b55['id']+_0x5af14e(0xe16)+_0x5246ee+_0x5af14e(0x83d)+_0x22b624+_0x5af14e(0x1f4)+_0x2ce60e+_0x5af14e(0x12da)+_0x26b20c+_0x5af14e(0xc36);}else _0x27b80a+=_0x5af14e(0xb00)+String(_0x3455f1)+_0x5af14e(0x7ec);}),_0x27b80a+=_0x3f7a5e(0xc5c)),_0x64a487=''+_0x23366f+_0x27b80a;}else{if(_0x3bf0eb[_0x3f7a5e(0xa20)]==='chat_message'){const _0x1109f1=_0x3bf0eb[_0x3f7a5e(0x9a5)],_0x5b3f4a=_0x5de8b7[_0x3f7a5e(0x737)][_0x3bf0eb[_0x3f7a5e(0x115)]];if(!_0x5b3f4a)continue;_0x277b32=_0x3f7a5e(0x429)+_0x5b3f4a[_0x3f7a5e(0x278)]+'\x20的聊天';const _0x5abcf7=_0x1109f1['role']===_0x3f7a5e(0x21c);let _0xaa8dbc,_0x5465cc;if(_0x5abcf7)_0xaa8dbc=_0x5b3f4a['isGroup']?_0x5b3f4a['settings'][_0x3f7a5e(0xca7)]||'我':'我',_0x5465cc=_0x5b3f4a[_0x3f7a5e(0x761)][_0x3f7a5e(0xc43)]||(_0x5b3f4a[_0x3f7a5e(0x1244)]?_0x30449f:_0x3d2e44);else{if(_0x5b3f4a[_0x3f7a5e(0x1244)]){const _0x593dac=_0x5b3f4a[_0x3f7a5e(0x2b3)][_0x3f7a5e(0xe79)](_0x1d3b60=>_0x1d3b60[_0x3f7a5e(0x697)]===_0x1109f1['senderName']);_0xaa8dbc=_0x1109f1[_0x3f7a5e(0x768)],_0x5465cc=_0x593dac?_0x593dac['avatar']:_0x4d9574;}else _0xaa8dbc=_0x5b3f4a['name'],_0x5465cc=_0x5b3f4a[_0x3f7a5e(0x761)][_0x3f7a5e(0x5e0)]||_0x3d2e44;}_0x3ee5a4=_0x3f7a5e(0x13b)+_0x5465cc+_0x3f7a5e(0xbb7)+_0xaa8dbc+_0x3f7a5e(0xd9a);if(typeof _0x1109f1[_0x3f7a5e(0x9a5)]===_0x3f7a5e(0x10d7)&&_0x9f9ac4[_0x3f7a5e(0x1043)](_0x1109f1[_0x3f7a5e(0x9a5)]))_0x419120='<img\x20src=\x22'+_0x1109f1[_0x3f7a5e(0x9a5)]+'\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>';else Array[_0x3f7a5e(0xb7b)](_0x1109f1['content'])&&_0x1109f1[_0x3f7a5e(0x9a5)][0x0]?.[_0x3f7a5e(0xa20)]===_0x3f7a5e(0x488)?_0x419120=_0x3f7a5e(0x13b)+_0x1109f1[_0x3f7a5e(0x9a5)][0x0][_0x3f7a5e(0x488)][_0x3f7a5e(0x10ac)]+_0x3f7a5e(0xb1c):_0x419120=String(_0x1109f1[_0x3f7a5e(0x9a5)]||'')[_0x3f7a5e(0x1018)](/\n/g,'<br>');}else{if(_0x3bf0eb['type']===_0x3f7a5e(0x759)){const _0x1d4754=_0x3bf0eb[_0x3f7a5e(0x9a5)];_0x277b32=_0x3f7a5e(0x1046)+_0x1d4754[_0x3f7a5e(0x5dc)]+_0x3f7a5e(0xb5a);const _0x4cbca3=_0x5de8b7[_0x3f7a5e(0x737)][_0x1d4754['characterId']],_0x4772e8=_0x4cbca3?_0x4cbca3[_0x3f7a5e(0x761)][_0x3f7a5e(0x5e0)]:_0x3d2e44;_0x3ee5a4='<img\x20src=\x22'+_0x4772e8+_0x3f7a5e(0xbb7)+_0x1d4754['characterName']+_0x3f7a5e(0xd9a);const _0x180241=_0x1d4754[_0x3f7a5e(0x9a5)]||'',_0x52089a=_0x5a9a9e(_0x180241)['replace'](/\n/g,_0x3f7a5e(0xf70));_0x419120=_0x3f7a5e(0x2af)+_0x1d4754[_0x3f7a5e(0x740)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>'+_0x52089a+_0x3f7a5e(0x999);}else{if(_0x3bf0eb[_0x3f7a5e(0xa20)]===_0x3f7a5e(0x68e)){const _0x32b44c=_0x3bf0eb['content'];_0x277b32=_0x3f7a5e(0x1046)+_0x32b44c[_0x3f7a5e(0x5dc)]+_0x3f7a5e(0xce5);const _0x57aecf=_0x5de8b7[_0x3f7a5e(0x737)][_0x32b44c[_0x3f7a5e(0x154)]],_0x5d9ab0=_0x57aecf?_0x57aecf[_0x3f7a5e(0x761)][_0x3f7a5e(0x5e0)]:_0x3d2e44;_0x3ee5a4='<img\x20src=\x22'+_0x5d9ab0+_0x3f7a5e(0xbb7)+_0x32b44c[_0x3f7a5e(0x5dc)]+_0x3f7a5e(0xd9a),_0x419120=_0x3f7a5e(0x498)+_0x32b44c[_0x3f7a5e(0x740)]+_0x3f7a5e(0x856)+(_0x32b44c[_0x3f7a5e(0x9a5)]||'')[_0x3f7a5e(0x1018)](/\n/g,_0x3f7a5e(0xf70))+_0x3f7a5e(0x176);}else{if(_0x3bf0eb['type']===_0x3f7a5e(0x503)){const _0x4eb6ee=_0x3bf0eb['content'];_0x277b32=_0x3f7a5e(0x1046)+_0x4eb6ee[_0x3f7a5e(0x5dc)]+_0x3f7a5e(0x507);const _0x5618c9=_0x5de8b7[_0x3f7a5e(0x737)][_0x4eb6ee[_0x3f7a5e(0x154)]],_0x7c9b91=_0x5618c9?_0x5618c9[_0x3f7a5e(0x761)][_0x3f7a5e(0x5e0)]:_0x3d2e44;_0x3ee5a4=_0x3f7a5e(0x13b)+_0x7c9b91+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x4eb6ee[_0x3f7a5e(0x5dc)]+_0x3f7a5e(0xd9a),_0x419120=_0x3f7a5e(0x8f6)+_0x4eb6ee['title']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>'+_0x4eb6ee[_0x3f7a5e(0x9a5)][_0x3f7a5e(0x1018)](/\n/g,_0x3f7a5e(0xf70))+'</div>\x0a\x20\x20\x20\x20';}}}}}_0x249577['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>'+_0x3ee5a4+'<div\x20class=\x22source\x22>'+_0x277b32+_0x3f7a5e(0x75f)+_0x419120+_0x3f7a5e(0xd18)+_0x64a487,_0x5c39a0[_0x3f7a5e(0x120c)](_0x249577);}}async function _0x2d2c08(){const _0x33eafb=_0x241b18;allFavoriteItems=await _0x2e83f8[_0x33eafb(0xc3e)][_0x33eafb(0x7c6)](_0x33eafb(0x702))[_0x33eafb(0x107)]()[_0x33eafb(0x508)]();const _0x51c8b5=document[_0x33eafb(0x11e3)]('favorites-search-input'),_0x340698=document[_0x33eafb(0x11e3)](_0x33eafb(0x16a));_0x51c8b5[_0x33eafb(0xf27)]='',_0x340698['style']['display']=_0x33eafb(0x379),_0x40f8c7(allFavoriteItems);}function _0x2f6e92(){const _0x56577d=_0x241b18;document[_0x56577d(0x11e3)](_0x56577d(0x554))['value']='',document[_0x56577d(0x11e3)]('post-image-preview')['src']='',document[_0x56577d(0x11e3)](_0x56577d(0x259))[_0x56577d(0xf27)]='',document[_0x56577d(0x11e3)](_0x56577d(0x71d))[_0x56577d(0x505)]['remove'](_0x56577d(0x250)),document[_0x56577d(0x11e3)](_0x56577d(0xd3d))[_0x56577d(0x794)][_0x56577d(0x33d)]=_0x56577d(0x379),document[_0x56577d(0x11e3)](_0x56577d(0xacb))[_0x56577d(0xf27)]='',document[_0x56577d(0x11e3)]('post-hidden-text')[_0x56577d(0xf27)]='',document[_0x56577d(0x11e3)](_0x56577d(0x291))[_0x56577d(0x1041)]();}async function _0x4e0163(){const _0x369d58=_0x241b18,_0x4d6fbd=await _0x58fd60(_0x369d58(0x142),_0x369d58(0x834),{'confirmButtonClass':_0x369d58(0x8a6),'confirmText':'确认清理'});if(!_0x4d6fbd)return;await _0x2fb06('请稍候...',_0x369d58(0xd7d)),console[_0x369d58(0x84b)]('冗余数据清理流程已启动...');let _0x320269={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0x2e83f8[_0x369d58(0x1272)]('rw',_0x2e83f8['tables'],async()=>{const _0x36022b=_0x369d58,_0x58d6f3=await _0x2e83f8[_0x36022b(0x737)][_0x36022b(0x508)](),_0x4cabcd=await _0x2e83f8['npcs'][_0x36022b(0x508)](),_0x4cdf2d=new Set(_0x58d6f3['map'](_0x1f75e2=>_0x1f75e2['id'])),_0xa7f331=new Set(_0x4cabcd[_0x36022b(0x796)](_0x15e4e4=>_0x36022b(0x8b8)+_0x15e4e4['id'])),_0x3e8d28=new Set(_0x58d6f3[_0x36022b(0x138)](_0xb7ba4a=>!_0xb7ba4a[_0x36022b(0x1244)])['map'](_0x47cdcf=>_0x47cdcf[_0x36022b(0x697)]));_0x3e8d28[_0x36022b(0x252)](_0x5de8b7[_0x36022b(0x1c5)][_0x36022b(0xa33)]||_0x36022b(0x833)),_0x4cabcd[_0x36022b(0x494)](_0x1658d2=>_0x3e8d28['add'](_0x1658d2[_0x36022b(0x278)]));for(const _0x8b58d3 of _0x58d6f3){let _0x3af1c5=![];if(_0x8b58d3[_0x36022b(0x1244)]&&_0x8b58d3['members']){const _0x2ec695=_0x8b58d3[_0x36022b(0x2b3)][_0x36022b(0x594)];_0x8b58d3[_0x36022b(0x2b3)]=_0x8b58d3['members']['filter'](_0x4a630a=>_0x4cdf2d[_0x36022b(0x72a)](_0x4a630a['id'])||_0xa7f331[_0x36022b(0x72a)](_0x4a630a['id'])),_0x8b58d3['members'][_0x36022b(0x594)]<_0x2ec695&&(_0x320269['groupMembers']+=_0x2ec695-_0x8b58d3[_0x36022b(0x2b3)][_0x36022b(0x594)],_0x3af1c5=!![]);}if(_0x8b58d3['settings']?.[_0x36022b(0xd1d)]?.[_0x36022b(0x594)]>0x0){const _0x1c44eb=_0x8b58d3[_0x36022b(0x761)]['linkedMemoryChatIds'][_0x36022b(0x594)];_0x8b58d3[_0x36022b(0x761)][_0x36022b(0xd1d)]=_0x8b58d3[_0x36022b(0x761)][_0x36022b(0xd1d)][_0x36022b(0x138)](_0x2dd5a9=>_0x4cdf2d['has'](_0x2dd5a9)),_0x8b58d3[_0x36022b(0x761)]['linkedMemoryChatIds'][_0x36022b(0x594)]<_0x1c44eb&&(_0x320269[_0x36022b(0x170)]+=_0x1c44eb-_0x8b58d3['settings'][_0x36022b(0xd1d)][_0x36022b(0x594)],_0x3af1c5=!![]);}_0x3af1c5&&await _0x2e83f8[_0x36022b(0x737)][_0x36022b(0xe3c)](_0x8b58d3);}const _0x5bcf50=await _0x2e83f8[_0x36022b(0x1218)][_0x36022b(0x508)]();for(const _0x417502 of _0x5bcf50){let _0xa9efcc=![];const _0x5b1ce9=_0x417502['authorId']===_0x36022b(0x21c)||_0x4cdf2d[_0x36022b(0x72a)](_0x417502[_0x36022b(0x5d9)])||_0xa7f331[_0x36022b(0x72a)](_0x417502[_0x36022b(0x5d9)]);if(!_0x5b1ce9){await _0x2e83f8[_0x36022b(0x1218)][_0x36022b(0xc0c)](_0x417502['id']),_0x320269['posts']++;continue;}if(_0x417502[_0x36022b(0x7eb)]&&_0x417502[_0x36022b(0x7eb)][_0x36022b(0x594)]>0x0){const _0x4f3752=_0x417502[_0x36022b(0x7eb)][_0x36022b(0x594)];_0x417502[_0x36022b(0x7eb)]=_0x417502[_0x36022b(0x7eb)][_0x36022b(0x138)](_0x2f8403=>_0x3e8d28[_0x36022b(0x72a)](_0x2f8403)),_0x417502['likes']['length']<_0x4f3752&&(_0x320269[_0x36022b(0x7eb)]+=_0x4f3752-_0x417502[_0x36022b(0x7eb)][_0x36022b(0x594)],_0xa9efcc=!![]);}if(_0x417502['comments']&&_0x417502['comments'][_0x36022b(0x594)]>0x0){const _0x49b22a=_0x417502[_0x36022b(0x1092)][_0x36022b(0x594)];_0x417502[_0x36022b(0x1092)]=_0x417502[_0x36022b(0x1092)][_0x36022b(0x138)](_0x5dfda9=>{const _0x54d841=_0x36022b;if(typeof _0x5dfda9==='object'&&_0x5dfda9[_0x54d841(0x2ac)])return _0x3e8d28[_0x54d841(0x72a)](_0x5dfda9[_0x54d841(0x2ac)]);return!![];}),_0x417502[_0x36022b(0x1092)]['length']<_0x49b22a&&(_0x320269[_0x36022b(0x1092)]+=_0x49b22a-_0x417502[_0x36022b(0x1092)]['length'],_0xa9efcc=!![]);}_0xa9efcc&&await _0x2e83f8[_0x36022b(0x1218)][_0x36022b(0xe3c)](_0x417502);}await _0x2e83f8[_0x36022b(0x360)]['where'](_0x36022b(0x115))['noneOf']([..._0x4cdf2d])[_0x36022b(0xc0c)]()[_0x36022b(0x5de)](_0x55ffe3=>_0x320269[_0x36022b(0x360)]+=_0x55ffe3),await _0x2e83f8[_0x36022b(0x516)][_0x36022b(0x129e)](_0x36022b(0x115))[_0x36022b(0x25e)]([..._0x4cdf2d])[_0x36022b(0xc0c)]()['then'](_0x16335f=>_0x320269['callRecords']+=_0x16335f);const _0x582cc8=await _0x2e83f8['renderingRules'][_0x36022b(0x508)]();for(const _0x462f35 of _0x582cc8){_0x462f35[_0x36022b(0x115)]!=='global'&&!_0x4cdf2d[_0x36022b(0x72a)](_0x462f35[_0x36022b(0x115)])&&(await _0x2e83f8[_0x36022b(0x6eb)][_0x36022b(0xc0c)](_0x462f35['id']),_0x320269['renderingRules']++);}});let _0x369b11=_0x369d58(0x51e),_0x4d6ff8=![];Object['entries'](_0x320269)[_0x369d58(0x494)](([_0x537a50,_0x3d9d6b])=>{const _0x7b4116=_0x369d58;if(_0x3d9d6b>0x0){const _0x132b6a={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':_0x7b4116(0xa1f),'renderingRules':_0x7b4116(0xdf),'groupMembers':_0x7b4116(0x9aa),'chatLinks':_0x7b4116(0xff7)};_0x369b11+=_0x7b4116(0x57a)+_0x3d9d6b+_0x7b4116(0x6de)+(_0x132b6a[_0x537a50]||_0x537a50)+'。\x0a',_0x4d6ff8=!![];}});!_0x4d6ff8&&(_0x369b11=_0x369d58(0x534));_0x369b11+=_0x369d58(0xea0),await _0x2fb06(_0x369d58(0x1010),_0x369b11);const _0x3aa61f=await _0x58fd60(_0x369d58(0xc52),'为了确保所有数据同步，建议立即刷新页面。');_0x3aa61f&&location[_0x369d58(0x64b)]();}catch(_0x510280){console[_0x369d58(0x1c1)](_0x369d58(0x483),_0x510280),await _0x2fb06(_0x369d58(0x8ca),'发生了一个错误:\x20'+_0x510280[_0x369d58(0x4bc)]);}}async function _0x25b1cd(){const _0x381016=_0x241b18;try{const _0x370296={'version':0x1,'timestamp':Date[_0x381016(0x1182)]()},[_0x3390b7,_0x23537a,_0x102b5a,_0x3aea92,_0x5a2159,_0x815355,_0x4a0e5d,_0x3f210a,_0x5b0287,_0x3791c1,_0x378132,_0x2cc925,_0x5bc93f,_0x3e0766,_0x22d433,_0x3aa052,_0x47d764,_0x1a1766,_0x2534cb,_0x3363f3,_0x548b4a,_0x238e4a,_0x196fb1,_0x4e6cb1,_0x40f14f]=await Promise['all']([_0x2e83f8['chats'][_0x381016(0x508)](),_0x2e83f8[_0x381016(0xca)][_0x381016(0x508)](),_0x2e83f8[_0x381016(0xa67)][_0x381016(0x508)](),_0x2e83f8[_0x381016(0x89c)][_0x381016(0x1289)]('main'),_0x2e83f8[_0x381016(0x2df)][_0x381016(0x1289)](_0x381016(0x12b7)),_0x2e83f8[_0x381016(0x216)]['toArray'](),_0x2e83f8[_0x381016(0x551)]['get'](_0x381016(0x12b7)),_0x2e83f8[_0x381016(0x1c5)][_0x381016(0x1289)]('main'),_0x2e83f8[_0x381016(0x1218)]['toArray'](),_0x2e83f8[_0x381016(0x5d1)][_0x381016(0x508)](),_0x2e83f8['qzonePhotos'][_0x381016(0x508)](),_0x2e83f8['favorites'][_0x381016(0x508)](),_0x2e83f8[_0x381016(0xd31)]['toArray'](),_0x2e83f8[_0x381016(0x360)]['toArray'](),_0x2e83f8[_0x381016(0xaac)][_0x381016(0x508)](),_0x2e83f8['apiPresets'][_0x381016(0x508)](),_0x2e83f8[_0x381016(0x120)][_0x381016(0x508)](),_0x2e83f8[_0x381016(0x516)][_0x381016(0x508)](),_0x2e83f8['renderingRules']['toArray'](),_0x2e83f8[_0x381016(0x12f7)][_0x381016(0x508)](),_0x2e83f8[_0x381016(0x120e)][_0x381016(0x508)](),_0x2e83f8[_0x381016(0xa7a)][_0x381016(0x508)](),_0x2e83f8[_0x381016(0x427)]['toArray'](),_0x2e83f8[_0x381016(0x566)][_0x381016(0x508)](),_0x2e83f8[_0x381016(0xf00)][_0x381016(0x508)]()]);Object['assign'](_0x370296,{'chats':_0x3390b7,'worldBooks':_0x23537a,'userStickers':_0x102b5a,'apiConfig':_0x3aea92,'globalSettings':_0x5a2159,'personaPresets':_0x815355,'musicLibrary':_0x4a0e5d,'qzoneSettings':_0x3f210a,'qzonePosts':_0x5b0287,'qzoneAlbums':_0x3791c1,'qzonePhotos':_0x378132,'favorites':_0x2cc925,'qzoneGroups':_0x5bc93f,'memories':_0x3e0766,'worldBookCategories':_0x22d433,'apiPresets':_0x3aa052,'shoppingProducts':_0x47d764,'callRecords':_0x1a1766,'renderingRules':_0x2534cb,'doubanPosts':_0x3363f3,'stickerCategories':_0x548b4a,'appearancePresets':_0x238e4a,'presets':_0x196fb1,'presetCategories':_0x4e6cb1,'npcs':_0x40f14f});const _0x278678=new Blob([JSON[_0x381016(0x313)](_0x370296,null,0x2)],{'type':_0x381016(0x35c)}),_0x279c65=URL[_0x381016(0x12fd)](_0x278678),_0x39de2a=Object[_0x381016(0x6c0)](document['createElement']('a'),{'href':_0x279c65,'download':_0x381016(0x83a)+new Date()[_0x381016(0xda)]()['split']('T')[0x0]+_0x381016(0xfc4)});_0x39de2a[_0x381016(0x1041)](),URL[_0x381016(0xa02)](_0x279c65),await _0x2fb06(_0x381016(0x799),_0x381016(0x9ce));}catch(_0x462284){console[_0x381016(0x1c1)](_0x381016(0x9c2),_0x462284),await _0x2fb06(_0x381016(0x567),'发生了一个错误:\x20'+_0x462284[_0x381016(0x4bc)]);}}async function _0x1ad04f(_0x485980){const _0x33845d=_0x241b18;try{await _0x2e83f8[_0x33845d(0x1272)]('rw',_0x2e83f8[_0x33845d(0x9e8)],async()=>{const _0x267d63=_0x33845d;for(const _0x28f13e of _0x2e83f8['tables']){await _0x28f13e['clear']();}for(const _0x494b65 in _0x485980){Array[_0x267d63(0xb7b)](_0x485980[_0x494b65])&&(console[_0x267d63(0x84b)](_0x267d63(0x10fc)+_0x494b65+_0x267d63(0xcfe)+_0x485980[_0x494b65][_0x267d63(0x594)]),await _0x2e83f8[_0x267d63(0xb4e)](_0x494b65)[_0x267d63(0xd72)](_0x485980[_0x494b65]));}});}catch(_0x1aab0f){throw new Error(_0x33845d(0xba)+_0x1aab0f[_0x33845d(0x4bc)]);}}async function _0x4aaa49(_0x438605){const _0x52978c=_0x241b18;if(!_0x438605)return;const _0x294e0d=await _0x58fd60('严重警告！','导入备份将完全覆盖您当前的所有数据。此操作不可撤销！确定要继续吗？',{'confirmButtonClass':_0x52978c(0x8a6)});if(!_0x294e0d)return;await _0x2fb06(_0x52978c(0x63d),'正在读取并解析备份文件...');try{const _0x197d10=await _0x438605[_0x52978c(0x1197)](),_0x5088bc=JSON[_0x52978c(0xb0c)](_0x197d10);if(_0x5088bc[_0x52978c(0x1cc)]&&typeof _0x5088bc[_0x52978c(0x1cc)]==='object'&&_0x5088bc[_0x52978c(0x1cc)][_0x52978c(0x737)])console[_0x52978c(0x84b)](_0x52978c(0xebc)),await _0x1ad04f(_0x5088bc[_0x52978c(0x1cc)]);else{if(_0x5088bc[_0x52978c(0x737)])console[_0x52978c(0x84b)](_0x52978c(0x14d)),await _0x1be462(_0x5088bc);else throw new Error('文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。');}await _0x2fb06(_0x52978c(0xb5e),_0x52978c(0x843)),setTimeout(()=>{const _0x41eec1=_0x52978c;window['location'][_0x41eec1(0x64b)]();},0x5dc);}catch(_0x84d5b3){console[_0x52978c(0x1c1)](_0x52978c(0xe81),_0x84d5b3),await _0x2fb06(_0x52978c(0x19f),_0x52978c(0x110)+_0x84d5b3[_0x52978c(0x4bc)]);}}async function _0x1be462(_0x4c1a42){const _0x562ceb=_0x241b18;try{await _0x2e83f8[_0x562ceb(0x1272)]('rw',_0x2e83f8['tables'],async()=>{const _0xfa1056=_0x562ceb;await _0x2e83f8['chats'][_0xfa1056(0x7ab)](),await _0x2e83f8[_0xfa1056(0xca)][_0xfa1056(0x7ab)]();for(const _0x51906f of _0x2e83f8['tables']){await _0x51906f[_0xfa1056(0x7ab)]();}if(Array[_0xfa1056(0xb7b)](_0x4c1a42['chats']))await _0x2e83f8[_0xfa1056(0x737)][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0x737)]);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0xca)]))await _0x2e83f8[_0xfa1056(0xca)][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0xca)]);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0xa67)]))await _0x2e83f8['userStickers'][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0xa67)]);if(_0x4c1a42[_0xfa1056(0x89c)])await _0x2e83f8[_0xfa1056(0x89c)][_0xfa1056(0xe3c)](_0x4c1a42[_0xfa1056(0x89c)]);if(_0x4c1a42[_0xfa1056(0x2df)])await _0x2e83f8[_0xfa1056(0x2df)]['put'](_0x4c1a42[_0xfa1056(0x2df)]);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0x216)]))await _0x2e83f8['personaPresets'][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0x216)]);if(_0x4c1a42[_0xfa1056(0x551)])await _0x2e83f8[_0xfa1056(0x551)][_0xfa1056(0xe3c)](_0x4c1a42[_0xfa1056(0x551)]);if(_0x4c1a42[_0xfa1056(0x1c5)])await _0x2e83f8['qzoneSettings'][_0xfa1056(0xe3c)](_0x4c1a42[_0xfa1056(0x1c5)]);if(Array['isArray'](_0x4c1a42[_0xfa1056(0x1218)]))await _0x2e83f8[_0xfa1056(0x1218)]['bulkPut'](_0x4c1a42[_0xfa1056(0x1218)]);if(Array['isArray'](_0x4c1a42['qzoneAlbums']))await _0x2e83f8[_0xfa1056(0x5d1)][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0x5d1)]);if(Array['isArray'](_0x4c1a42[_0xfa1056(0xc62)]))await _0x2e83f8[_0xfa1056(0xc62)][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0xc62)]);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0xc3e)]))await _0x2e83f8[_0xfa1056(0xc3e)][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0xc3e)]);if(Array['isArray'](_0x4c1a42[_0xfa1056(0xd31)]))await _0x2e83f8[_0xfa1056(0xd31)][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0xd31)]);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0x360)]))await _0x2e83f8[_0xfa1056(0x360)]['bulkPut'](_0x4c1a42['memories']);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0xaac)]))await _0x2e83f8[_0xfa1056(0xaac)][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0xaac)]);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0x105a)]))await _0x2e83f8['apiPresets']['bulkPut'](_0x4c1a42[_0xfa1056(0x105a)]);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0x120)]))await _0x2e83f8[_0xfa1056(0x120)][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0x120)]);if(Array[_0xfa1056(0xb7b)](_0x4c1a42['callRecords']))await _0x2e83f8[_0xfa1056(0x516)][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0x516)]);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0x6eb)]))await _0x2e83f8[_0xfa1056(0x6eb)][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0x6eb)]);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0x12f7)]))await _0x2e83f8[_0xfa1056(0x12f7)]['bulkPut'](_0x4c1a42[_0xfa1056(0x12f7)]);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0x120e)]))await _0x2e83f8[_0xfa1056(0x120e)][_0xfa1056(0xd72)](_0x4c1a42['stickerCategories']);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0xa7a)]))await _0x2e83f8['appearancePresets'][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0xa7a)]);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0x427)]))await _0x2e83f8[_0xfa1056(0x427)][_0xfa1056(0xd72)](_0x4c1a42[_0xfa1056(0x427)]);if(Array[_0xfa1056(0xb7b)](_0x4c1a42[_0xfa1056(0x566)]))await _0x2e83f8[_0xfa1056(0x566)]['bulkPut'](_0x4c1a42['presetCategories']);if(Array['isArray'](_0x4c1a42[_0xfa1056(0xf00)]))await _0x2e83f8[_0xfa1056(0xf00)]['bulkPut'](_0x4c1a42[_0xfa1056(0xf00)]);});}catch(_0x11d4dd){throw new Error(_0x562ceb(0x34d)+_0x11d4dd[_0x562ceb(0x4bc)]);}}function _0x58687c(_0x1530ec,_0x540648=![]){const _0xfd6356=_0x241b18;if(!_0x1530ec){_0x206e3c[_0xfd6356(0x595)]='',document[_0xfd6356(0x11e3)](_0xfd6356(0xff5))['style'][_0xfd6356(0x2d6)]='';return;}const _0x11cf06='custom-user-font',_0xc618cd=_0xfd6356(0xf4f)+_0x11cf06+_0xfd6356(0x12eb)+_0x1530ec+'\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}';if(_0x540648){const _0x4e6fb6=document[_0xfd6356(0x11e3)](_0xfd6356(0xf33))||document[_0xfd6356(0x383)]('style');_0x4e6fb6['id']='preview-font-style',_0x4e6fb6[_0xfd6356(0x595)]=_0xc618cd;if(!document['getElementById'](_0xfd6356(0xf33)))document['head'][_0xfd6356(0x120c)](_0x4e6fb6);document['getElementById'](_0xfd6356(0xff5))[_0xfd6356(0x794)][_0xfd6356(0x2d6)]='\x27'+_0x11cf06+_0xfd6356(0xcdb);}else _0x206e3c[_0xfd6356(0x595)]=_0xfd6356(0x646)+_0xc618cd+_0xfd6356(0x11f8)+_0x11cf06+_0xfd6356(0xb75);}async function _0x54791e(){const _0x143ed6=_0x241b18;_0x206e3c[_0x143ed6(0x595)]='',_0x5de8b7[_0x143ed6(0x2df)][_0x143ed6(0xcd8)]='',await _0x2e83f8[_0x143ed6(0x2df)][_0x143ed6(0xe3c)](_0x5de8b7['globalSettings']),document[_0x143ed6(0x11e3)](_0x143ed6(0x5b3))[_0x143ed6(0xf27)]='',document[_0x143ed6(0x11e3)](_0x143ed6(0xff5))['style'][_0x143ed6(0x2d6)]='',alert(_0x143ed6(0x1009));}async function _0x344e71(){const _0x4c610a=_0x241b18,[_0x1fa3d6,_0x38877a,_0x2e8fd9,_0x27dd69,_0x4b0742,_0x261d57,_0x41565d,_0x10beeb,_0x2d309e,_0x2c96d9,_0x3c2908]=await Promise[_0x4c610a(0xd4a)]([_0x2e83f8['chats'][_0x4c610a(0x508)](),_0x2e83f8[_0x4c610a(0x89c)][_0x4c610a(0x1289)]('main'),_0x2e83f8[_0x4c610a(0x2df)][_0x4c610a(0x1289)](_0x4c610a(0x12b7)),_0x2e83f8[_0x4c610a(0xa67)][_0x4c610a(0x508)](),_0x2e83f8[_0x4c610a(0xca)][_0x4c610a(0x508)](),_0x2e83f8[_0x4c610a(0x551)][_0x4c610a(0x1289)](_0x4c610a(0x12b7)),_0x2e83f8['personaPresets'][_0x4c610a(0x508)](),_0x2e83f8[_0x4c610a(0x1c5)][_0x4c610a(0x1289)](_0x4c610a(0x12b7)),_0x2e83f8['favorites'][_0x4c610a(0x7c6)]('timestamp')[_0x4c610a(0x107)]()[_0x4c610a(0x508)](),_0x2e83f8[_0x4c610a(0x360)][_0x4c610a(0x508)](),_0x2e83f8[_0x4c610a(0x427)][_0x4c610a(0x508)]()]);_0x5de8b7['presets']=_0x3c2908||[];const _0x2f6ff4={'id':_0x4c610a(0x12b7),'showStatusBar':![],'wallpaper':_0x4c610a(0x6a1),'fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0x19c75d},'cphoneWallpaper':_0x4c610a(0x1286),'cphoneAppIcons':{..._0x5d2f39},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x5de8b7[_0x4c610a(0x2df)]={..._0x2f6ff4,..._0x2e8fd9||{}},_0x5de8b7[_0x4c610a(0x2df)]['appIcons']={..._0x2f6ff4['appIcons'],..._0x5de8b7[_0x4c610a(0x2df)][_0x4c610a(0x18b)]||{}},_0x5de8b7[_0x4c610a(0x2df)][_0x4c610a(0xfaa)]={..._0x2f6ff4[_0x4c610a(0xfaa)],..._0x5de8b7[_0x4c610a(0x2df)]['cphoneAppIcons']||{}},_0x1fa3d6[_0x4c610a(0x494)](_0xf43045=>{const _0x4aa77b=_0x4c610a;typeof _0xf43045[_0x4aa77b(0x761)][_0x4aa77b(0x290)]===_0x4aa77b(0x679)&&(_0xf43045[_0x4aa77b(0x761)]['enableTimePerception']=!![]),!_0xf43045['settings'][_0x4aa77b(0xa92)]&&(_0xf43045[_0x4aa77b(0x761)][_0x4aa77b(0xa92)]={'vertical':_0x4aa77b(0x10e2),'horizontal':_0x4aa77b(0xc9c),'offset':0xa}),!_0xf43045[_0x4aa77b(0x1244)]&&!_0xf43045[_0x4aa77b(0x761)][_0x4aa77b(0xdc3)]&&(_0xf43045[_0x4aa77b(0x761)]['myAvatarLibrary']=[]),!_0xf43045[_0x4aa77b(0x1244)]&&typeof _0xf43045['originalName']===_0x4aa77b(0x679)&&(_0xf43045[_0x4aa77b(0x697)]=_0xf43045[_0x4aa77b(0x278)]);}),_0x5de8b7['chats']=_0x1fa3d6[_0x4c610a(0x870)]((_0x54caf9,_0x1a137b)=>{const _0x49e723=_0x4c610a;if(typeof _0x1a137b[_0x49e723(0xc3a)]===_0x49e723(0x679))_0x1a137b[_0x49e723(0xc3a)]=0x0;_0x1a137b[_0x49e723(0x1244)]&&(typeof _0x1a137b['settings'][_0x49e723(0xa99)]===_0x49e723(0x679)&&(_0x1a137b[_0x49e723(0x761)][_0x49e723(0xa99)]=!![]),_0x1a137b['members']&&_0x1a137b[_0x49e723(0x2b3)][_0x49e723(0x594)]>0x0&&_0x1a137b['members'][0x0]['name']&&_0x1a137b[_0x49e723(0x2b3)][_0x49e723(0x494)](_0x4ea862=>{const _0xc0ba4e=_0x49e723;typeof _0x4ea862[_0xc0ba4e(0x697)]===_0xc0ba4e(0x679)&&(_0x4ea862[_0xc0ba4e(0x697)]=_0x4ea862[_0xc0ba4e(0x278)],_0x4ea862[_0xc0ba4e(0xc8f)]=_0x4ea862[_0xc0ba4e(0x278)],delete _0x4ea862[_0xc0ba4e(0x278)]);}));if(!_0x1a137b['settings'])_0x1a137b[_0x49e723(0x761)]={};typeof _0x1a137b['settings'][_0x49e723(0xb09)]===_0x49e723(0x679)&&(_0x1a137b['settings']['actionCooldownMinutes']=0xa);if(!_0x1a137b[_0x49e723(0x1244)]&&!_0x1a137b[_0x49e723(0x739)])_0x1a137b[_0x49e723(0x739)]={'text':'在线','lastUpdate':Date[_0x49e723(0x1182)](),'isBusy':![]};if(!_0x1a137b[_0x49e723(0x1244)]&&!_0x1a137b[_0x49e723(0xa78)])_0x1a137b[_0x49e723(0xa78)]={'status':_0x49e723(0xe62),'blockedTimestamp':null,'applicationReason':''};if(!_0x1a137b[_0x49e723(0x1244)]&&(!_0x1a137b[_0x49e723(0x761)]||!_0x1a137b['settings']['aiAvatarLibrary'])){if(!_0x1a137b[_0x49e723(0x761)])_0x1a137b[_0x49e723(0x761)]={};_0x1a137b[_0x49e723(0x761)][_0x49e723(0xe6d)]=[];}_0x1a137b[_0x49e723(0x1244)]&&(_0x1a137b[_0x49e723(0x2b3)]||[])[_0x49e723(0x494)](_0x13b2da=>{const _0x37c609=_0x49e723;if(typeof _0x13b2da[_0x37c609(0x306)]==='undefined')_0x13b2da[_0x37c609(0x306)]='';});if(!_0x1a137b['musicData'])_0x1a137b['musicData']={'totalTime':0x0};_0x1a137b[_0x49e723(0x761)]&&_0x1a137b[_0x49e723(0x761)][_0x49e723(0xd3a)]&&!_0x1a137b[_0x49e723(0x761)][_0x49e723(0xa17)]&&(_0x1a137b['settings'][_0x49e723(0xa17)]=[_0x1a137b[_0x49e723(0x761)][_0x49e723(0xd3a)]],delete _0x1a137b[_0x49e723(0x761)][_0x49e723(0xd3a)]);if(typeof _0x1a137b[_0x49e723(0x8ac)]===_0x49e723(0x679))_0x1a137b[_0x49e723(0x8ac)]=![];!_0x1a137b[_0x49e723(0x1244)]&&typeof _0x1a137b[_0x49e723(0x761)][_0x49e723(0xca7)]===_0x49e723(0x679)&&(_0x1a137b[_0x49e723(0x761)]['myNickname']='我');if(_0x1a137b[_0x49e723(0x1244)]&&_0x1a137b[_0x49e723(0x2b3)]){let _0x1ab0a2=![];_0x1fa3d6[_0x49e723(0x494)](_0x2154ab=>{const _0x311e81=_0x49e723;_0x2154ab['id']===_0x1a137b['id']&&_0x2154ab['originalName']&&delete _0x2154ab[_0x311e81(0x697)];}),_0x1a137b[_0x49e723(0x2b3)]['forEach'](_0x47612c=>{const _0x2b4aaa=_0x49e723,_0x4fbd3f=_0x1fa3d6[_0x2b4aaa(0xe79)](_0xbbebdb=>_0xbbebdb['id']===_0x47612c['id']);if(_0x4fbd3f&&_0x4fbd3f['settings']){const _0x3187fe=_0x4fbd3f[_0x2b4aaa(0x761)][_0x2b4aaa(0x1268)]||'';_0x47612c['avatarFrame']!==_0x3187fe&&(_0x47612c[_0x2b4aaa(0x306)]=_0x3187fe,_0x1ab0a2=!![]);}else typeof _0x47612c[_0x2b4aaa(0x306)]==='undefined'&&(_0x47612c['avatarFrame']='',_0x1ab0a2=!![]);});if(_0x1ab0a2)_0x2e83f8[_0x49e723(0x737)][_0x49e723(0xe3c)](_0x1a137b);}if(!_0x1a137b[_0x49e723(0x761)][_0x49e723(0x6db)])_0x1a137b[_0x49e723(0x761)][_0x49e723(0x6db)]=![];if(!_0x1a137b[_0x49e723(0x761)][_0x49e723(0x11f)])_0x1a137b[_0x49e723(0x761)][_0x49e723(0x11f)]=0x14;if(!_0x1a137b[_0x49e723(0xe21)])_0x1a137b['longTermMemory']=[];if(!_0x1a137b[_0x49e723(0x1ca)])_0x1a137b[_0x49e723(0x1ca)]=0x0;if(!_0x1a137b[_0x49e723(0x1244)]){typeof _0x1a137b[_0x49e723(0x761)]['enableBackgroundActivity']==='undefined'&&(_0x1a137b['settings'][_0x49e723(0xa99)]=!![]);typeof _0x1a137b['settings'][_0x49e723(0x444)]===_0x49e723(0x679)&&(_0x1a137b[_0x49e723(0x761)][_0x49e723(0x444)]=![]);if(!_0x1a137b[_0x49e723(0x739)])_0x1a137b['status']={'text':'在线','lastUpdate':Date[_0x49e723(0x1182)](),'isBusy':![]};if(!_0x1a137b[_0x49e723(0xa78)])_0x1a137b[_0x49e723(0xa78)]={'status':'friend','blockedTimestamp':null,'applicationReason':''};if(!_0x1a137b[_0x49e723(0x761)]||!_0x1a137b[_0x49e723(0x761)][_0x49e723(0xe6d)]){if(!_0x1a137b[_0x49e723(0x761)])_0x1a137b[_0x49e723(0x761)]={};_0x1a137b[_0x49e723(0x761)][_0x49e723(0xe6d)]=[];}if(typeof _0x1a137b['settings'][_0x49e723(0xadd)]===_0x49e723(0x679))_0x1a137b[_0x49e723(0x761)][_0x49e723(0xadd)]=![];if(typeof _0x1a137b['settings'][_0x49e723(0x12db)]===_0x49e723(0x679))_0x1a137b['settings'][_0x49e723(0x12db)]=0x64;if(typeof _0x1a137b[_0x49e723(0x761)][_0x49e723(0xb31)]===_0x49e723(0x679))_0x1a137b[_0x49e723(0x761)][_0x49e723(0xb31)]=0x12c;typeof _0x1a137b[_0x49e723(0x761)][_0x49e723(0x663)]===_0x49e723(0x679)&&(_0x1a137b[_0x49e723(0x761)][_0x49e723(0x663)]=![]);if(typeof _0x1a137b[_0x49e723(0x535)]===_0x49e723(0x679))_0x1a137b[_0x49e723(0x535)]=_0x49e723(0x6cb);if(typeof _0x1a137b['randomJottings']===_0x49e723(0x679))_0x1a137b[_0x49e723(0x267)]=_0x49e723(0x6cb);!Array[_0x49e723(0xb7b)](_0x1a137b[_0x49e723(0x6d3)])&&(_0x1a137b['thoughtsHistory']=[]);}return typeof _0x1a137b[_0x49e723(0x761)][_0x49e723(0xbf8)]===_0x49e723(0x679)&&(_0x1a137b[_0x49e723(0x761)][_0x49e723(0x1dc)]?_0x1a137b[_0x49e723(0x761)][_0x49e723(0xbf8)]=[_0x1a137b[_0x49e723(0x761)][_0x49e723(0x1dc)]]:_0x1a137b[_0x49e723(0x761)]['stickerCategoryIds']=[],delete _0x1a137b[_0x49e723(0x761)][_0x49e723(0x1dc)]),_0x54caf9[_0x1a137b['id']]=_0x1a137b,_0x54caf9;},{});const _0x2135d5=[];_0x2c96d9[_0x4c610a(0x494)](_0x369a29=>{const _0x21cadb=_0x4c610a;if(_0x369a29['type']===_0x21cadb(0xc77)&&_0x369a29[_0x21cadb(0xd5a)]&&!_0x369a29[_0x21cadb(0x5d9)]){const _0x515c16=_0x1fa3d6[_0x21cadb(0xe79)](_0x5356d4=>!_0x5356d4['isGroup']&&_0x5356d4[_0x21cadb(0x697)]===_0x369a29[_0x21cadb(0xd5a)]);if(_0x515c16)_0x369a29[_0x21cadb(0x5d9)]=_0x515c16['id'],_0x2135d5['push'](_0x369a29);else{const _0x42eb11=_0x1fa3d6[_0x21cadb(0xe79)](_0x2be679=>!_0x2be679[_0x21cadb(0x1244)]&&_0x2be679[_0x21cadb(0x278)]===_0x369a29[_0x21cadb(0xd5a)]);_0x42eb11&&(_0x369a29[_0x21cadb(0x5d9)]=_0x42eb11['id'],_0x2135d5[_0x21cadb(0xf5)](_0x369a29));}}}),_0x2135d5[_0x4c610a(0x594)]>0x0&&await _0x2e83f8['memories'][_0x4c610a(0xd72)](_0x2135d5),_0x5de8b7[_0x4c610a(0x89c)]=_0x38877a||{'id':_0x4c610a(0x12b7),'proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':_0x4c610a(0xdda)},_0x5de8b7['userStickers']=_0x27dd69||[],_0x5de8b7[_0x4c610a(0xca)]=_0x4b0742||[],_0xb57b5b[_0x4c610a(0xcba)]=_0x261d57?.[_0x4c610a(0xcba)]||[],_0x5de8b7['personaPresets']=_0x41565d||[],_0x5de8b7[_0x4c610a(0x1c5)]=_0x10beeb||{'id':'main','nickname':_0x4c610a(0x833),'avatar':_0x4c610a(0x12b),'banner':_0x4c610a(0x89d)},allFavoriteItems=_0x2d309e||[];}async function _0x539eb1(){const _0x18cff4=_0x241b18;await _0x2e83f8[_0x18cff4(0x551)]['put']({'id':_0x18cff4(0x12b7),'playlist':_0xb57b5b['playlist']});}function _0x44b062(_0x263818){const _0x2114f4=_0x241b18;if(!_0x263818)return'';const _0x421395=new Date(_0x263818),_0x8e29a6=String(_0x421395[_0x2114f4(0x3de)]())['padStart'](0x2,'0'),_0x8bb66a=String(_0x421395['getMinutes']())[_0x2114f4(0xae4)](0x2,'0');return _0x8e29a6+':'+_0x8bb66a;}function _0x497f2b(_0x2fa441){const _0x219862=_0x241b18,_0x357773=Date[_0x219862(0x1182)](),_0x1335d1=Math[_0x219862(0xfb1)]((_0x357773-_0x2fa441)/0x3e8);if(_0x1335d1<0x3c)return'刚刚';const _0xa3a9b4=Math[_0x219862(0xfb1)](_0x1335d1/0x3c);if(_0xa3a9b4<0x3c)return _0xa3a9b4+_0x219862(0x943);const _0x40561e=Math[_0x219862(0xfb1)](_0xa3a9b4/0x3c);if(_0x40561e<0x18)return _0x40561e+_0x219862(0x1ce);const _0x4667ba=Math[_0x219862(0xfb1)](_0x40561e/0x18);if(_0x4667ba<0x1e)return _0x4667ba+'天前';const _0x69d1f1=Math[_0x219862(0xfb1)](_0x4667ba/0x1e);if(_0x69d1f1<0xc)return'大约'+_0x69d1f1+_0x219862(0xe94);const _0x35017d=Math[_0x219862(0xfb1)](_0x4667ba/0x16d);return'大约'+_0x35017d+'年前';}function _0x46fb0b(_0x28ab84){const _0x1d0cb6=_0x241b18;if(!_0x28ab84)return'';const _0x4c304c=new Date(),_0x28f0e1=new Date(_0x28ab84),_0x158d31=String(_0x28f0e1[_0x1d0cb6(0x3de)]())['padStart'](0x2,'0'),_0x1c9ae4=String(_0x28f0e1[_0x1d0cb6(0xf39)]())[_0x1d0cb6(0xae4)](0x2,'0'),_0x193b2c=_0x158d31+':'+_0x1c9ae4;if(_0x4c304c[_0x1d0cb6(0x1025)]()===_0x28f0e1[_0x1d0cb6(0x1025)]())return _0x1d0cb6(0xa45)+_0x193b2c;const _0x4ef583=new Date();_0x4ef583[_0x1d0cb6(0x322)](_0x4c304c['getDate']()-0x1);if(_0x4ef583[_0x1d0cb6(0x1025)]()===_0x28f0e1['toDateString']())return'昨天\x20'+_0x193b2c;if(_0x4c304c['getFullYear']()===_0x28f0e1[_0x1d0cb6(0x177)]()){const _0x836ccd=String(_0x28f0e1[_0x1d0cb6(0x39d)]()+0x1),_0x10e465=String(_0x28f0e1[_0x1d0cb6(0x97d)]());return _0x836ccd+'月'+_0x10e465+'日\x20'+_0x193b2c;}const _0x3a9ecf=_0x28f0e1['getFullYear'](),_0x204b31=String(_0x28f0e1['getMonth']()+0x1),_0x2ec65d=String(_0x28f0e1['getDate']());return _0x3a9ecf+'年'+_0x204b31+'月'+_0x2ec65d+'日\x20'+_0x193b2c;}function _0x6a72ee(){const _0x5aa7ac=_0x241b18,_0x432047=_0x3a7337();document[_0x5aa7ac(0x11e3)](_0x5aa7ac(0x996))[_0x5aa7ac(0xf27)]=_0x432047[_0x5aa7ac(0x673)],document[_0x5aa7ac(0x11e3)](_0x5aa7ac(0x82a))[_0x5aa7ac(0xf27)]=_0x432047[_0x5aa7ac(0xf20)],document['getElementById'](_0x5aa7ac(0x3b4))[_0x5aa7ac(0xf27)]=_0x432047[_0x5aa7ac(0x4c0)],document[_0x5aa7ac(0x11e3)](_0x5aa7ac(0x989))['value']=_0x432047['sampler'],document[_0x5aa7ac(0x11e3)](_0x5aa7ac(0x918))[_0x5aa7ac(0xf27)]=_0x432047[_0x5aa7ac(0x1073)],document[_0x5aa7ac(0x11e3)](_0x5aa7ac(0x766))[_0x5aa7ac(0xf27)]=_0x432047['uc_preset'],document[_0x5aa7ac(0x11e3)](_0x5aa7ac(0x607))[_0x5aa7ac(0x3e4)]=_0x432047[_0x5aa7ac(0x4ad)],document['getElementById'](_0x5aa7ac(0x12fe))[_0x5aa7ac(0x3e4)]=_0x432047[_0x5aa7ac(0x126c)],document[_0x5aa7ac(0x11e3)](_0x5aa7ac(0x1055))[_0x5aa7ac(0x3e4)]=_0x432047[_0x5aa7ac(0x12e0)],document[_0x5aa7ac(0x11e3)](_0x5aa7ac(0x694))['value']=_0x432047[_0x5aa7ac(0x117b)],document[_0x5aa7ac(0x11e3)](_0x5aa7ac(0x4ef))[_0x5aa7ac(0xf27)]=_0x432047[_0x5aa7ac(0x248)],document[_0x5aa7ac(0x11e3)]('nai-cors-proxy')[_0x5aa7ac(0xf27)]=_0x432047[_0x5aa7ac(0x9e2)],document['getElementById'](_0x5aa7ac(0x9bc))['value']=_0x432047[_0x5aa7ac(0x871)]||'';const _0x5337e1=document[_0x5aa7ac(0x11e3)](_0x5aa7ac(0x8cb));_0x5337e1[_0x5aa7ac(0x794)]['display']=_0x432047['cors_proxy']===_0x5aa7ac(0x3c4)?_0x5aa7ac(0x11ac):_0x5aa7ac(0x379);}function _0x485e25(){const _0x276523=_0x241b18,_0x39d2c8=document[_0x276523(0x11e3)](_0x276523(0x41e))[_0x276523(0x3e4)],_0x2d9b00=document[_0x276523(0x11e3)](_0x276523(0xb15))[_0x276523(0xf27)],_0x2a4c54=document[_0x276523(0x11e3)](_0x276523(0xa09))['value'][_0x276523(0xeb7)]();localStorage[_0x276523(0x3b2)]('novelai-enabled',_0x39d2c8),localStorage[_0x276523(0x3b2)](_0x276523(0xb15),_0x2d9b00),localStorage[_0x276523(0x3b2)](_0x276523(0xa09),_0x2a4c54);const _0x197dc6={'resolution':document['getElementById'](_0x276523(0x996))['value'],'steps':parseInt(document['getElementById'](_0x276523(0x82a))['value']),'cfg_scale':parseFloat(document[_0x276523(0x11e3)](_0x276523(0x3b4))[_0x276523(0xf27)]),'sampler':document[_0x276523(0x11e3)](_0x276523(0x989))[_0x276523(0xf27)],'seed':parseInt(document[_0x276523(0x11e3)](_0x276523(0x918))['value']),'uc_preset':parseInt(document[_0x276523(0x11e3)]('nai-uc-preset')['value']),'quality_toggle':document['getElementById'](_0x276523(0x607))[_0x276523(0x3e4)],'smea':document[_0x276523(0x11e3)](_0x276523(0x12fe))['checked'],'smea_dyn':document[_0x276523(0x11e3)](_0x276523(0x1055))[_0x276523(0x3e4)],'default_positive':document['getElementById'](_0x276523(0x694))[_0x276523(0xf27)],'default_negative':document['getElementById'](_0x276523(0x4ef))['value'],'cors_proxy':document[_0x276523(0x11e3)](_0x276523(0x577))[_0x276523(0xf27)],'custom_proxy_url':document['getElementById'](_0x276523(0x9bc))[_0x276523(0xf27)]};localStorage[_0x276523(0x3b2)](_0x276523(0xfa0),JSON[_0x276523(0x313)](_0x197dc6));}function _0x4a3276(){const _0xce5954=_0x241b18;localStorage[_0xce5954(0x897)](_0xce5954(0xfa0)),_0x6a72ee(),alert('已恢复默认设置！');}function _0x3a7337(){const _0x3dbd1a=_0x241b18,_0x14ded={'resolution':_0x3dbd1a(0x778),'steps':0x1c,'cfg_scale':0x5,'sampler':_0x3dbd1a(0xce8),'seed':-0x1,'uc_preset':0x1,'quality_toggle':!![],'smea':!![],'smea_dyn':![],'default_positive':_0x3dbd1a(0x35a),'default_negative':_0x3dbd1a(0xf66),'cors_proxy':_0x3dbd1a(0x584),'custom_proxy_url':''},_0x57d0a9=localStorage[_0x3dbd1a(0x728)](_0x3dbd1a(0xfa0));if(_0x57d0a9)try{return{..._0x14ded,...JSON['parse'](_0x57d0a9)};}catch(_0x336e71){return _0x14ded;}return _0x14ded;}function _0x419515(_0x52799d){const _0x2d99e1=_0x241b18,_0x25f0ff=_0x3a7337();if(!_0x52799d||!_0x5de8b7[_0x2d99e1(0x737)][_0x52799d])return console[_0x2d99e1(0x84b)]('⚠️\x20NAI提示词：没有角色，使用系统配置'),{'positive':_0x25f0ff['default_positive'],'negative':_0x25f0ff[_0x2d99e1(0x248)],'source':_0x2d99e1(0xf72)};const _0x583ace=_0x5de8b7[_0x2d99e1(0x737)][_0x52799d],_0x1a412d=_0x583ace['settings'][_0x2d99e1(0xade)]||{};return _0x1a412d[_0x2d99e1(0x7b9)]===_0x2d99e1(0x12e7)?(console[_0x2d99e1(0x84b)](_0x2d99e1(0xd0c)),console['log'](_0x2d99e1(0xc37),_0x1a412d[_0x2d99e1(0x5da)]||_0x2d99e1(0x555)),console[_0x2d99e1(0x84b)](_0x2d99e1(0x714),_0x1a412d[_0x2d99e1(0xfe2)]||_0x2d99e1(0x555)),{'positive':_0x1a412d['characterPositivePrompt']||'','negative':_0x1a412d[_0x2d99e1(0xfe2)]||'','source':'character'}):(console[_0x2d99e1(0x84b)](_0x2d99e1(0xe12)),console[_0x2d99e1(0x84b)]('\x20\x20\x20正面:',_0x25f0ff[_0x2d99e1(0x117b)]||_0x2d99e1(0x555)),console['log']('\x20\x20\x20负面:',_0x25f0ff[_0x2d99e1(0x248)]||_0x2d99e1(0x555)),{'positive':_0x25f0ff[_0x2d99e1(0x117b)],'negative':_0x25f0ff['default_negative'],'source':'system'});}async function _0xabee0c(){const _0x377848=_0x241b18,_0x20cdda=document[_0x377848(0x11e3)](_0x377848(0xa09))[_0x377848(0xf27)][_0x377848(0xeb7)](),_0x34fa14=document['getElementById'](_0x377848(0xb15))[_0x377848(0xf27)],_0x26ccb5=document[_0x377848(0x11e3)](_0x377848(0x666))[_0x377848(0xf27)][_0x377848(0xeb7)]();if(!_0x20cdda){alert(_0x377848(0xe8f));return;}if(!_0x26ccb5){alert(_0x377848(0x399));return;}const _0x2b1043=_0x3a7337(),_0x23de97=document[_0x377848(0x11e3)](_0x377848(0xe6))[_0x377848(0xf27)]['trim'](),_0x3b4e7b=document[_0x377848(0x11e3)]('nai-test-status'),_0x103d32=document[_0x377848(0x11e3)](_0x377848(0xa21)),_0xcca1b1=document['getElementById'](_0x377848(0x987)),_0x5da7ea=document[_0x377848(0x11e3)](_0x377848(0x73a));_0x3b4e7b[_0x377848(0x794)]['display']=_0x377848(0x11ac),_0x103d32['style'][_0x377848(0x33d)]=_0x377848(0x379),_0xcca1b1['style'][_0x377848(0x33d)]=_0x377848(0x379),_0x5da7ea['disabled']=!![],_0x5da7ea[_0x377848(0x300)]='生成中...';try{const [_0x253587,_0x1e6c6b]=_0x2b1043[_0x377848(0x673)]['split']('x')[_0x377848(0x796)](Number);let _0x5e03ba;_0x34fa14[_0x377848(0x3ad)](_0x377848(0xb6a))?_0x5e03ba={'input':_0x26ccb5,'model':_0x34fa14,'action':_0x377848(0x12a1),'parameters':{'params_version':0x3,'width':_0x253587,'height':_0x1e6c6b,'scale':_0x2b1043[_0x377848(0x4c0)],'sampler':_0x2b1043[_0x377848(0x5c7)],'steps':_0x2b1043[_0x377848(0xf20)],'seed':_0x2b1043[_0x377848(0x1073)]===-0x1?Math[_0x377848(0xfb1)](Math[_0x377848(0x36d)]()*0x2540be3ff):_0x2b1043[_0x377848(0x1073)],'n_samples':0x1,'ucPreset':_0x2b1043[_0x377848(0x500)],'qualityToggle':_0x2b1043[_0x377848(0x4ad)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x377848(0x1078),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x26ccb5,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x23de97,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x23de97,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x5e03ba={'input':_0x26ccb5,'model':_0x34fa14,'action':_0x377848(0x12a1),'parameters':{'width':_0x253587,'height':_0x1e6c6b,'scale':_0x2b1043['cfg_scale'],'sampler':_0x2b1043[_0x377848(0x5c7)],'steps':_0x2b1043['steps'],'seed':_0x2b1043[_0x377848(0x1073)]===-0x1?Math['floor'](Math[_0x377848(0x36d)]()*0x2540be3ff):_0x2b1043[_0x377848(0x1073)],'n_samples':0x1,'ucPreset':_0x2b1043[_0x377848(0x500)],'qualityToggle':_0x2b1043['quality_toggle'],'sm':_0x2b1043['smea'],'sm_dyn':_0x2b1043[_0x377848(0x12e0)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x377848(0xf07),'negative_prompt':_0x23de97}};console[_0x377848(0x84b)](_0x377848(0xccc)),console['log'](_0x377848(0x7f2),_0x34fa14),console['log'](_0x377848(0xcf9),JSON[_0x377848(0x313)](_0x5e03ba,null,0x2));let _0x496bc4;_0x34fa14[_0x377848(0x3ad)](_0x377848(0xb6a))?_0x496bc4=_0x377848(0x6e6):_0x496bc4='https://image.novelai.net/ai/generate-image';let _0x1f0f93=_0x2b1043[_0x377848(0x9e2)];_0x1f0f93===_0x377848(0x3c4)&&(_0x1f0f93=_0x2b1043[_0x377848(0x871)]||'');_0x1f0f93&&_0x1f0f93!==''&&(_0x496bc4=_0x1f0f93+encodeURIComponent(_0x496bc4));const _0x548400=/Chrome/[_0x377848(0x1043)](navigator[_0x377848(0x116e)])&&!/Edg/[_0x377848(0x1043)](navigator['userAgent']);let _0x4338dc={'method':'POST','headers':{'Content-Type':_0x377848(0x35c),'Authorization':_0x377848(0xdaf)+_0x20cdda},'body':JSON[_0x377848(0x313)](_0x5e03ba)};if(_0x548400){console[_0x377848(0x84b)]('🔧\x20检测到Chrome浏览器，启用headers兼容性处理');const _0x457bb1={};for(const [_0x19243e,_0x23d622]of Object[_0x377848(0x560)](_0x4338dc[_0x377848(0x2b1)])){_0x457bb1[_0x19243e]=_0x23d622['replace'](/[^\x00-\xFF]/g,'');}_0x4338dc[_0x377848(0x2b1)]=_0x457bb1;}const _0x35fe5d=await fetch(_0x496bc4,_0x4338dc);console[_0x377848(0x84b)](_0x377848(0x441),_0x35fe5d[_0x377848(0x739)]),console['log'](_0x377848(0x7aa),[..._0x35fe5d[_0x377848(0x2b1)][_0x377848(0x560)]()]);if(!_0x35fe5d['ok']){const _0x457816=await _0x35fe5d[_0x377848(0x1197)]();console['error']('API错误响应:',_0x457816);throw new Error(_0x377848(0x4e0)+_0x35fe5d[_0x377848(0x739)]+'):\x20'+_0x457816);}const _0x484e05=_0x35fe5d[_0x377848(0x2b1)]['get']('content-type');console['log'](_0x377848(0xe17),_0x484e05);let _0x38f0b6;if(_0x484e05&&_0x484e05[_0x377848(0x3ad)](_0x377848(0xa37))){console[_0x377848(0x84b)](_0x377848(0x51b)),_0x3b4e7b['textContent']=_0x377848(0x716);const _0x3caeab=await _0x35fe5d[_0x377848(0x1197)]();console[_0x377848(0x84b)]('收到\x20SSE\x20数据，大小:',_0x3caeab[_0x377848(0x594)]);const _0x6af702=_0x3caeab[_0x377848(0xeb7)]()[_0x377848(0x65b)]('\x0a');let _0x8fc622=null;for(let _0x54a183=_0x6af702['length']-0x1;_0x54a183>=0x0;_0x54a183--){const _0x2a54fa=_0x6af702[_0x54a183][_0x377848(0xeb7)]();if(_0x2a54fa[_0x377848(0xb6c)]('data:\x20')&&_0x2a54fa!==_0x377848(0x7ea)){const _0x59276c=_0x2a54fa[_0x377848(0x8d4)](0x6);try{const _0x3782c1=JSON[_0x377848(0xb0c)](_0x59276c);if(_0x3782c1[_0x377848(0x55a)]==='final'&&_0x3782c1[_0x377848(0x6e9)]){_0x8fc622=_0x3782c1[_0x377848(0x6e9)],console['log'](_0x377848(0x629));break;}if(_0x3782c1[_0x377848(0x1cc)]){_0x8fc622=_0x3782c1['data'],console[_0x377848(0x84b)](_0x377848(0x814));break;}if(_0x3782c1[_0x377848(0x6e9)]){_0x8fc622=_0x3782c1[_0x377848(0x6e9)],console[_0x377848(0x84b)]('从\x20JSON.image\x20中提取图片数据');break;}}catch(_0x316b68){_0x8fc622=_0x59276c,console[_0x377848(0x84b)](_0x377848(0xb3c));break;}}}if(!_0x8fc622)throw new Error(_0x377848(0x61f));const _0x2541b5=_0x8fc622['startsWith'](_0x377848(0x6c1)),_0x3363ef=_0x8fc622[_0x377848(0xb6c)](_0x377848(0x60f));if(_0x2541b5||_0x3363ef){console[_0x377848(0x84b)]('✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)');const _0x4b4941=atob(_0x8fc622),_0x19fef0=new Uint8Array(_0x4b4941['length']);for(let _0x360299=0x0;_0x360299<_0x4b4941['length'];_0x360299++){_0x19fef0[_0x360299]=_0x4b4941[_0x377848(0x5f0)](_0x360299);}const _0x336b76=new Blob([_0x19fef0],{'type':_0x2541b5?_0x377848(0x12f6):_0x377848(0xc78)});console[_0x377848(0x84b)](_0x377848(0xae),_0x336b76['size']);const _0x16388e=URL[_0x377848(0x12fd)](_0x336b76);document[_0x377848(0x11e3)](_0x377848(0x12e9))['src']=_0x16388e,_0x3b4e7b[_0x377848(0x794)][_0x377848(0x33d)]=_0x377848(0x379),_0x103d32[_0x377848(0x794)][_0x377848(0x33d)]=_0x377848(0x11ac),console[_0x377848(0x84b)](_0x377848(0xbe6));return;}console['log']('当作\x20ZIP\x20文件处理...');const _0xbc74cd=atob(_0x8fc622),_0x5f2741=new Uint8Array(_0xbc74cd['length']);for(let _0x3b0b88=0x0;_0x3b0b88<_0xbc74cd[_0x377848(0x594)];_0x3b0b88++){_0x5f2741[_0x3b0b88]=_0xbc74cd[_0x377848(0x5f0)](_0x3b0b88);}_0x38f0b6=new Blob([_0x5f2741]),console['log'](_0x377848(0x102b),_0x38f0b6['size']);}else _0x38f0b6=await _0x35fe5d[_0x377848(0xccb)](),console[_0x377848(0x84b)](_0x377848(0x1d4),_0x38f0b6[_0x377848(0xa20)],_0x377848(0x27b),_0x38f0b6[_0x377848(0x1159)]);try{if(typeof JSZip==='undefined')throw new Error(_0x377848(0x7b0));_0x3b4e7b[_0x377848(0x300)]=_0x377848(0x99e);const _0x2efd45=await JSZip[_0x377848(0x79c)](_0x38f0b6);console['log'](_0x377848(0x7de),Object[_0x377848(0xb4a)](_0x2efd45[_0x377848(0x5c9)]));let _0x24a4c1=null;for(let _0x4de902 in _0x2efd45[_0x377848(0x5c9)]){if(_0x4de902[_0x377848(0xe9f)](/\.(png|jpg|jpeg|webp)$/i)){_0x24a4c1=_0x2efd45['files'][_0x4de902],console[_0x377848(0x84b)](_0x377848(0x819),_0x4de902);break;}}if(!_0x24a4c1)throw new Error('ZIP文件中未找到图片');const _0x52549d=await _0x24a4c1[_0x377848(0x90c)](_0x377848(0xccb));console['log'](_0x377848(0xb58),_0x52549d[_0x377848(0x1159)]);const _0x1fe6ad=URL[_0x377848(0x12fd)](_0x52549d);console[_0x377848(0x84b)](_0x377848(0x36c),_0x1fe6ad),document[_0x377848(0x11e3)](_0x377848(0x12e9))[_0x377848(0xf0a)]=_0x1fe6ad,_0x3b4e7b[_0x377848(0x794)][_0x377848(0x33d)]=_0x377848(0x379),_0x103d32[_0x377848(0x794)]['display']=_0x377848(0x11ac);}catch(_0x175585){console[_0x377848(0x1c1)](_0x377848(0xddf),_0x175585),console[_0x377848(0x84b)](_0x377848(0x237));if(_0x38f0b6[_0x377848(0xa20)][_0x377848(0xb6c)](_0x377848(0x1189))){const _0x1eca78=URL[_0x377848(0x12fd)](_0x38f0b6);document[_0x377848(0x11e3)](_0x377848(0x12e9))[_0x377848(0xf0a)]=_0x1eca78,_0x3b4e7b[_0x377848(0x794)][_0x377848(0x33d)]=_0x377848(0x379),_0x103d32[_0x377848(0x794)][_0x377848(0x33d)]=_0x377848(0x11ac);}else throw new Error(_0x377848(0x1291)+_0x175585[_0x377848(0x4bc)]);}}catch(_0x388727){console[_0x377848(0x1c1)](_0x377848(0x103b),_0x388727),_0x3b4e7b[_0x377848(0x794)][_0x377848(0x33d)]=_0x377848(0x379),_0xcca1b1['style'][_0x377848(0x33d)]=_0x377848(0x11ac),_0xcca1b1[_0x377848(0x300)]='生成失败:\x20'+_0x388727[_0x377848(0x4bc)];}finally{_0x5da7ea[_0x377848(0xe5c)]=![],_0x5da7ea[_0x377848(0x300)]=_0x377848(0x7a5);}}function _0x2c799e(_0x53aea0,_0xf0d445){const _0xf50aef=_0x241b18;_0x387f1d(),clearTimeout(_0x1b0056);const _0x6c452b=_0x5de8b7[_0xf50aef(0x737)][_0x53aea0];if(!_0x6c452b)return;const _0x23224d=document['getElementById'](_0xf50aef(0x674));document[_0xf50aef(0x11e3)](_0xf50aef(0x8ec))[_0xf50aef(0xf0a)]=_0x6c452b[_0xf50aef(0x761)]['aiAvatar']||_0x6c452b[_0xf50aef(0x761)][_0xf50aef(0x75c)]||_0x3d2e44,document['getElementById']('notification-content')['querySelector'](_0xf50aef(0x32f))[_0xf50aef(0x300)]=_0x6c452b['name'],document['getElementById'](_0xf50aef(0x2a3))[_0xf50aef(0x5ac)](_0xf50aef(0x5c3))[_0xf50aef(0x300)]=_0xf0d445,_0x23224d[_0xf50aef(0x505)]['remove'](_0xf50aef(0x250)),void _0x23224d[_0xf50aef(0x29f)],_0x23224d['classList'][_0xf50aef(0x252)]('visible');const _0x52f6f4=_0x23224d[_0xf50aef(0x4b4)](!![]);_0x23224d[_0xf50aef(0x18c)][_0xf50aef(0xeaa)](_0x52f6f4,_0x23224d),_0x52f6f4[_0xf50aef(0x4b8)]('click',()=>{const _0x35dee1=_0xf50aef;_0x6cac66(_0x53aea0),_0x52f6f4[_0x35dee1(0x505)][_0x35dee1(0x957)](_0x35dee1(0x250));}),_0x1b0056=setTimeout(()=>{_0x52f6f4['classList']['remove']('visible');},0xfa0),_0x17cf58();}function _0x2b6a0d(){const _0x1e17b0=_0x241b18,_0xeb36e3=new Date(),_0x45b678=_0xeb36e3['toLocaleTimeString'](_0x1e17b0(0x898),{'hour':_0x1e17b0(0x93a),'minute':_0x1e17b0(0x93a)}),_0x2257ea=_0xeb36e3['toLocaleDateString'](_0x1e17b0(0x898),{'weekday':'long','month':_0x1e17b0(0xc7),'day':_0x1e17b0(0x61b)});document[_0x1e17b0(0x11e3)]('status-bar-time')[_0x1e17b0(0x300)]=_0x45b678;}function _0x30c9b6(_0x4a2931){const _0x4c53c4=_0x241b18,_0x5812d3=_0x4a2931['trim']();if(_0x5812d3[_0x4c53c4(0xb6c)]('[')&&_0x5812d3[_0x4c53c4(0x771)](']'))try{const _0x76786b=JSON[_0x4c53c4(0xb0c)](_0x5812d3);if(Array['isArray'](_0x76786b))return console[_0x4c53c4(0x84b)](_0x4c53c4(0x316)),_0x76786b;}catch(_0x1ffc87){console[_0x4c53c4(0x6b0)]('标准JSON数组解析失败，将尝试强力解析...');}const _0x50a712=_0x5812d3[_0x4c53c4(0xe9f)](/{[^{}]*}/g);if(_0x50a712){const _0x4f36ee=[];for(const _0x161bf3 of _0x50a712){try{const _0x45e99d=JSON[_0x4c53c4(0xb0c)](_0x161bf3);_0x4f36ee[_0x4c53c4(0xf5)](_0x45e99d);}catch(_0x335366){console[_0x4c53c4(0x6b0)](_0x4c53c4(0x53f),_0x161bf3);}}if(_0x4f36ee[_0x4c53c4(0x594)]>0x0)return console[_0x4c53c4(0x84b)](_0x4c53c4(0x175)),_0x4f36ee;}return console[_0x4c53c4(0x1c1)]('所有解析方案均失败！将返回原始文本。'),[{'type':'text','content':_0x4a2931}];}function _0xe5786(_0x545b1c=new Date()){const _0x531b24=_0x545b1c['getHours']();if(_0x531b24>=0x0&&_0x531b24<0x5)return'凌晨';else{if(_0x531b24>=0x5&&_0x531b24<0x9)return'早上';else{if(_0x531b24>=0x9&&_0x531b24<0xd)return'上午';else{if(_0x531b24>=0xd&&_0x531b24<0x12)return'下午';else{if(_0x531b24>=0x12&&_0x531b24<0x18)return'晚上';}}}}return'现在';}async function _0x4c5d9b(){const _0x2c8222=_0x241b18,_0xb58a6=document[_0x2c8222(0x11e3)](_0x2c8222(0x1a7));_0xb58a6['innerHTML']=_0x2c8222(0x27a);const _0x2ae1aa=await _0x2e83f8[_0x2c8222(0x105a)]['toArray']();_0x2ae1aa[_0x2c8222(0x494)](_0x2126fa=>{const _0x19ddcb=_0x2c8222,_0x523a71=document[_0x19ddcb(0x383)](_0x19ddcb(0xd91));_0x523a71['value']=_0x2126fa['id'],_0x523a71['textContent']=_0x2126fa[_0x19ddcb(0x278)],_0xb58a6['appendChild'](_0x523a71);});const _0x46cbbd=_0x5de8b7[_0x2c8222(0x89c)];let _0x2fc8f2=null;for(const _0x1bc27c of _0x2ae1aa){if(_0x1bc27c['proxyUrl']===_0x46cbbd[_0x2c8222(0xa60)]&&_0x1bc27c[_0x2c8222(0xebb)]===_0x46cbbd['apiKey']&&_0x1bc27c[_0x2c8222(0x130a)]===_0x46cbbd[_0x2c8222(0x130a)]&&_0x1bc27c[_0x2c8222(0x13c)]===_0x46cbbd[_0x2c8222(0x13c)]&&_0x1bc27c[_0x2c8222(0xb05)]===_0x46cbbd[_0x2c8222(0xb05)]&&_0x1bc27c['secondaryModel']===_0x46cbbd[_0x2c8222(0xe1b)]&&(_0x1bc27c[_0x2c8222(0x420)]||'')===(_0x46cbbd[_0x2c8222(0x420)]||'')&&(_0x1bc27c[_0x2c8222(0x24d)]||'')===(_0x46cbbd[_0x2c8222(0x24d)]||'')&&(_0x1bc27c[_0x2c8222(0xd62)]||_0x2c8222(0xdda))===(_0x46cbbd[_0x2c8222(0xd62)]||_0x2c8222(0xdda))){_0x2fc8f2=_0x1bc27c['id'];break;}}_0x2fc8f2?_0xb58a6['value']=_0x2fc8f2:_0xb58a6[_0x2c8222(0xf27)]=_0x2c8222(0xbd3);}async function _0x43ee7d(){const _0x2c0849=_0x241b18,_0xfdf04b=document[_0x2c0849(0x11e3)](_0x2c0849(0x1a7)),_0x29ccf1=parseInt(_0xfdf04b[_0x2c0849(0xf27)]);if(isNaN(_0x29ccf1))return;const _0x35d064=await _0x2e83f8[_0x2c0849(0x105a)][_0x2c0849(0x1289)](_0x29ccf1);_0x35d064&&(_0x5de8b7[_0x2c0849(0x89c)]={'id':_0x2c0849(0x12b7),'proxyUrl':_0x35d064[_0x2c0849(0xa60)],'apiKey':_0x35d064[_0x2c0849(0xebb)],'model':_0x35d064[_0x2c0849(0x130a)],'secondaryProxyUrl':_0x35d064['secondaryProxyUrl'],'secondaryApiKey':_0x35d064['secondaryApiKey'],'secondaryModel':_0x35d064[_0x2c0849(0xe1b)],'minimaxGroupId':_0x35d064['minimaxGroupId'],'minimaxApiKey':_0x35d064['minimaxApiKey'],'minimaxModel':_0x35d064[_0x2c0849(0xd62)]},await _0x2e83f8[_0x2c0849(0x89c)]['put'](_0x5de8b7[_0x2c0849(0x89c)]),_0x41d5c7(),document['getElementById'](_0x2c0849(0x642))[_0x2c0849(0x1041)](),_0x35d064[_0x2c0849(0x13c)]&&_0x35d064[_0x2c0849(0xb05)]&&document[_0x2c0849(0x11e3)](_0x2c0849(0xa73))[_0x2c0849(0x1041)](),alert('已加载预设\x20“'+_0x35d064[_0x2c0849(0x278)]+'”'));}async function _0x3c4100(){const _0x3a8ddf=_0x241b18,_0x5d79aa=await _0x231a5a(_0x3a8ddf(0xc26),'请输入预设名称');if(!_0x5d79aa||!_0x5d79aa['trim']())return;const _0x5df722={'name':_0x5d79aa['trim'](),'proxyUrl':document[_0x3a8ddf(0x11e3)]('proxy-url')[_0x3a8ddf(0xf27)]['trim'](),'apiKey':document[_0x3a8ddf(0x11e3)](_0x3a8ddf(0xb1e))[_0x3a8ddf(0xf27)][_0x3a8ddf(0xeb7)](),'model':document[_0x3a8ddf(0x11e3)]('model-select')['value'],'secondaryProxyUrl':document[_0x3a8ddf(0x11e3)](_0x3a8ddf(0x1ef))[_0x3a8ddf(0xf27)][_0x3a8ddf(0xeb7)](),'secondaryApiKey':document[_0x3a8ddf(0x11e3)](_0x3a8ddf(0x5b2))[_0x3a8ddf(0xf27)][_0x3a8ddf(0xeb7)](),'secondaryModel':document[_0x3a8ddf(0x11e3)](_0x3a8ddf(0x1191))[_0x3a8ddf(0xf27)],'minimaxGroupId':document[_0x3a8ddf(0x11e3)](_0x3a8ddf(0x348))[_0x3a8ddf(0xf27)]['trim'](),'minimaxApiKey':document[_0x3a8ddf(0x11e3)]('minimax-api-key')[_0x3a8ddf(0xf27)][_0x3a8ddf(0xeb7)](),'minimaxModel':document[_0x3a8ddf(0x11e3)](_0x3a8ddf(0x11ff))['value']},_0x3df02a=await _0x2e83f8[_0x3a8ddf(0x105a)][_0x3a8ddf(0x129e)](_0x3a8ddf(0x278))[_0x3a8ddf(0x119e)](_0x5df722[_0x3a8ddf(0x278)])['first']();if(_0x3df02a){const _0x264927=await _0x58fd60(_0x3a8ddf(0xf78),'名为\x20“'+_0x5df722['name']+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':_0x3a8ddf(0x8a6)});if(!_0x264927)return;_0x5df722['id']=_0x3df02a['id'];}await _0x2e83f8['apiPresets'][_0x3a8ddf(0xe3c)](_0x5df722),await _0x4c5d9b(),alert(_0x3a8ddf(0x5cf));}async function _0x491988(){const _0x11ecca=_0x241b18,_0x5a9b6e=document[_0x11ecca(0x11e3)](_0x11ecca(0x1a7)),_0x52c9fc=parseInt(_0x5a9b6e[_0x11ecca(0xf27)]);if(isNaN(_0x52c9fc)){alert(_0x11ecca(0x28f));return;}const _0xad3821=await _0x2e83f8[_0x11ecca(0x105a)]['get'](_0x52c9fc);if(!_0xad3821)return;const _0x1b48c8=await _0x58fd60('删除预设','确定要删除预设\x20“'+_0xad3821['name']+'”\x20吗？',{'confirmButtonClass':_0x11ecca(0x8a6)});_0x1b48c8&&(await _0x2e83f8[_0x11ecca(0x105a)][_0x11ecca(0xc0c)](_0x52c9fc),await _0x4c5d9b(),alert(_0x11ecca(0x762)));}function _0x41d5c7(){const _0x433f1b=_0x241b18;document[_0x433f1b(0x11e3)](_0x433f1b(0x92f))[_0x433f1b(0xf27)]=_0x5de8b7[_0x433f1b(0x89c)][_0x433f1b(0xa60)]||'',document[_0x433f1b(0x11e3)](_0x433f1b(0xb1e))['value']=_0x5de8b7[_0x433f1b(0x89c)][_0x433f1b(0xebb)]||'',document[_0x433f1b(0x11e3)](_0x433f1b(0x1ef))[_0x433f1b(0xf27)]=_0x5de8b7[_0x433f1b(0x89c)][_0x433f1b(0x13c)]||'',document[_0x433f1b(0x11e3)](_0x433f1b(0x5b2))[_0x433f1b(0xf27)]=_0x5de8b7['apiConfig'][_0x433f1b(0xb05)]||'',document[_0x433f1b(0x11e3)](_0x433f1b(0xbe4))[_0x433f1b(0x3e4)]=_0x5de8b7[_0x433f1b(0x2df)][_0x433f1b(0xa99)]||![],document[_0x433f1b(0x11e3)](_0x433f1b(0x119b))[_0x433f1b(0xf27)]=_0x5de8b7[_0x433f1b(0x2df)][_0x433f1b(0x1f6)]||0x3c,document[_0x433f1b(0x11e3)]('block-cooldown-input')['value']=_0x5de8b7[_0x433f1b(0x2df)][_0x433f1b(0xb18)]||0x1,document[_0x433f1b(0x11e3)]('enable-ai-drawing-switch')[_0x433f1b(0x3e4)]=_0x5de8b7[_0x433f1b(0x2df)]['enableAiDrawing'],document[_0x433f1b(0x11e3)](_0x433f1b(0x4d2))[_0x433f1b(0xf27)]=_0x5de8b7[_0x433f1b(0x2df)][_0x433f1b(0x896)]||0x32,document[_0x433f1b(0x11e3)](_0x433f1b(0x46c))[_0x433f1b(0xf27)]=_0x5de8b7[_0x433f1b(0x2df)][_0x433f1b(0xd0)]||0x1e;const _0x4e33cc=document[_0x433f1b(0x11e3)]('api-temperature-slider'),_0x548efd=document[_0x433f1b(0x11e3)](_0x433f1b(0x9ca)),_0x1c6aae=_0x5de8b7[_0x433f1b(0x2df)][_0x433f1b(0xe66)]||0.8;_0x4e33cc[_0x433f1b(0xf27)]=_0x1c6aae,_0x548efd[_0x433f1b(0x300)]=_0x1c6aae,document[_0x433f1b(0x11e3)]('minimax-group-id')['value']=_0x5de8b7[_0x433f1b(0x89c)][_0x433f1b(0x420)]||'',document[_0x433f1b(0x11e3)]('minimax-api-key')['value']=_0x5de8b7[_0x433f1b(0x89c)]['minimaxApiKey']||'',document['getElementById'](_0x433f1b(0x11ff))['value']=_0x5de8b7['apiConfig'][_0x433f1b(0xd62)]||'speech-01';const _0xb004c4=localStorage['getItem'](_0x433f1b(0x1153))==='true',_0x240af1=localStorage[_0x433f1b(0x728)](_0x433f1b(0xb15))||_0x433f1b(0x12d8),_0x4f7af8=localStorage['getItem'](_0x433f1b(0xa09))||'';document['getElementById'](_0x433f1b(0x41e))[_0x433f1b(0x3e4)]=_0xb004c4,document[_0x433f1b(0x11e3)](_0x433f1b(0xb15))[_0x433f1b(0xf27)]=_0x240af1,document[_0x433f1b(0x11e3)]('novelai-api-key')['value']=_0x4f7af8,document[_0x433f1b(0x11e3)](_0x433f1b(0xe46))[_0x433f1b(0x794)][_0x433f1b(0x33d)]=_0xb004c4?_0x433f1b(0x11ac):_0x433f1b(0x379),_0x4c5d9b(),_0x5103b4();}window[_0x241b18(0x1e7)]=_0x41d5c7;async function _0xcf3709(){const _0x1e29c7=_0x241b18,_0xe2ca71=document[_0x1e29c7(0x11e3)](_0x1e29c7(0xd28));_0xe2ca71[_0x1e29c7(0x595)]='';const _0xc85588=await _0x2e83f8[_0x1e29c7(0xf00)][_0x1e29c7(0x508)]();if(_0xc85588[_0x1e29c7(0x594)]===0x0){_0xe2ca71[_0x1e29c7(0x595)]=_0x1e29c7(0x858);return;}_0xc85588[_0x1e29c7(0x494)](_0x3c4e15=>{const _0x594095=_0x1e29c7,_0x50a0a1=document[_0x594095(0x383)](_0x594095(0x1285));_0x50a0a1[_0x594095(0x3db)]=_0x594095(0x7e5),_0x50a0a1[_0x594095(0xaca)][_0x594095(0xd29)]=_0x3c4e15['id'],_0x50a0a1[_0x594095(0x595)]=_0x594095(0xd6d)+(_0x3c4e15[_0x594095(0x525)]||_0x4d9574)+_0x594095(0xf65)+_0x3c4e15[_0x594095(0x278)]+_0x594095(0x44b)+_0x3c4e15[_0x594095(0x701)]['substring'](0x0,0x1e)+_0x594095(0x31f),_0x50a0a1[_0x594095(0x4b8)](_0x594095(0x1041),()=>_0x5ba41b(_0x3c4e15['id'])),_0xcb6204(_0x50a0a1,async()=>{await _0x306b9d(_0x3c4e15['id']);}),_0xe2ca71[_0x594095(0x120c)](_0x50a0a1);});}async function _0x5ba41b(_0x471154=null){const _0x19b41a=_0x241b18;editingNpcId=_0x471154;const _0x4b6950=document[_0x19b41a(0x11e3)]('npc-editor-modal'),_0x315b71=document[_0x19b41a(0x11e3)]('npc-editor-title'),_0x1c3f0c=document[_0x19b41a(0x11e3)](_0x19b41a(0x617)),_0x36d54c=document[_0x19b41a(0x11e3)](_0x19b41a(0xc9e)),_0x52b815=document['getElementById']('npc-avatar-preview'),_0xbebfbc=document['getElementById'](_0x19b41a(0xbb6)),_0x16a80a=document[_0x19b41a(0x11e3)](_0x19b41a(0xcb6)),_0x2bd1e1=document[_0x19b41a(0x11e3)](_0x19b41a(0x61d));_0xbebfbc[_0x19b41a(0x595)]='',_0xbebfbc['innerHTML']+=_0x19b41a(0x33f)+(_0x5de8b7[_0x19b41a(0x1c5)][_0x19b41a(0xa33)]||'我')+'\x20(用户)</label>',Object[_0x19b41a(0x4ca)](_0x5de8b7[_0x19b41a(0x737)])['filter'](_0x575a92=>!_0x575a92[_0x19b41a(0x1244)])[_0x19b41a(0x494)](_0x1542f5=>{const _0x4ac48c=_0x19b41a;_0xbebfbc[_0x4ac48c(0x595)]+=_0x4ac48c(0x49f)+_0x1542f5['id']+_0x4ac48c(0x656)+_0x1542f5['name']+_0x4ac48c(0x1234);});if(_0x471154){_0x315b71['textContent']=_0x19b41a(0xa10);const _0x479b75=await _0x2e83f8[_0x19b41a(0xf00)][_0x19b41a(0x1289)](_0x471154);_0x479b75&&(_0x1c3f0c['value']=_0x479b75[_0x19b41a(0x278)],_0x36d54c[_0x19b41a(0xf27)]=_0x479b75['persona'],_0x52b815[_0x19b41a(0xf0a)]=_0x479b75['avatar']||_0x4d9574,_0x16a80a['checked']=_0x479b75['enableBackgroundActivity']!==![],_0x2bd1e1[_0x19b41a(0xf27)]=_0x479b75[_0x19b41a(0xb09)]||0xf,_0x479b75[_0x19b41a(0x131)]&&Array[_0x19b41a(0xb7b)](_0x479b75[_0x19b41a(0x131)])&&_0x479b75[_0x19b41a(0x131)]['forEach'](_0x1081c1=>{const _0x1412c8=_0x19b41a,_0x496f0e=_0xbebfbc[_0x1412c8(0x5ac)](_0x1412c8(0xadb)+_0x1081c1+'\x22]');if(_0x496f0e)_0x496f0e[_0x1412c8(0x3e4)]=!![];}));}else{_0x315b71[_0x19b41a(0x300)]='添加\x20NPC',_0x1c3f0c[_0x19b41a(0xf27)]='',_0x36d54c[_0x19b41a(0xf27)]='',_0x52b815[_0x19b41a(0xf0a)]=_0x4d9574,_0x16a80a['checked']=!![],_0x2bd1e1[_0x19b41a(0xf27)]=0xf;const _0x3eb13a=_0xbebfbc[_0x19b41a(0x5ac)](_0x19b41a(0x1097));if(_0x3eb13a)_0x3eb13a['checked']=!![];}_0x4b6950[_0x19b41a(0x505)][_0x19b41a(0x252)](_0x19b41a(0x250));}async function _0x114290(){const _0xd3ec5c=_0x241b18,_0x69ba=document[_0xd3ec5c(0x11e3)]('npc-name-input')[_0xd3ec5c(0xf27)][_0xd3ec5c(0xeb7)](),_0x738456=document[_0xd3ec5c(0x11e3)](_0xd3ec5c(0xc9e))['value'][_0xd3ec5c(0xeb7)]();if(!_0x69ba||!_0x738456){alert(_0xd3ec5c(0x3a6));return;}const _0x5e10a0=Array[_0xd3ec5c(0xee2)](document['querySelectorAll'](_0xd3ec5c(0xa00)))[_0xd3ec5c(0x796)](_0x18e953=>_0x18e953[_0xd3ec5c(0xf27)]),_0x76e8b=document[_0xd3ec5c(0x11e3)](_0xd3ec5c(0xcb6))[_0xd3ec5c(0x3e4)],_0x1a412b=parseInt(document[_0xd3ec5c(0x11e3)]('npc-action-cooldown-input')['value'])||0xf,_0x159a59={'name':_0x69ba,'persona':_0x738456,'avatar':document[_0xd3ec5c(0x11e3)](_0xd3ec5c(0x869))[_0xd3ec5c(0xf0a)],'associatedWith':_0x5e10a0,'enableBackgroundActivity':_0x76e8b,'actionCooldownMinutes':_0x1a412b};if(editingNpcId)await _0x2e83f8[_0xd3ec5c(0xf00)]['update'](editingNpcId,_0x159a59);else{const _0x2d3619=await _0x2e83f8['npcs']['add'](_0x159a59);if(_0x176587&&_0x5de8b7[_0xd3ec5c(0x93d)]){const _0x5860a7=_0x5de8b7['chats'][_0x5de8b7[_0xd3ec5c(0x93d)]];_0x5860a7['isGroup']&&(_0x5860a7['members'][_0xd3ec5c(0xf5)]({'id':_0xd3ec5c(0x8b8)+_0x2d3619,'originalName':_0x69ba,'groupNickname':_0x69ba,'persona':_0x738456,'avatar':_0x159a59[_0xd3ec5c(0x525)],'isNpc':!![]}),await _0x2e83f8[_0xd3ec5c(0x737)]['put'](_0x5860a7));}}document[_0xd3ec5c(0x11e3)](_0xd3ec5c(0xae1))[_0xd3ec5c(0x505)][_0xd3ec5c(0x957)]('visible'),_0x176587?(_0x176587=![],_0x320eea()):await _0xcf3709();}async function _0x306b9d(_0x24439a){const _0x3f830f=_0x241b18,_0x52b3f7=await _0x2e83f8['npcs'][_0x3f830f(0x1289)](_0x24439a);if(!_0x52b3f7)return;const _0x143d23=await _0x58fd60(_0x3f830f(0xbb2),'确定要删除NPC\x20“'+_0x52b3f7[_0x3f830f(0x278)]+_0x3f830f(0xbec),{'confirmButtonClass':_0x3f830f(0x8a6)});_0x143d23&&(await _0x2e83f8[_0x3f830f(0xf00)][_0x3f830f(0xc0c)](_0x24439a),await _0xcf3709());}let _0x398166=0x0;function _0x5c53f6(_0x5783f0){const _0xeaa6e=_0x241b18,_0x293cc3=document['createElement'](_0xeaa6e(0x1285));return _0x293cc3[_0xeaa6e(0x3db)]='chat-group-container',_0x293cc3[_0xeaa6e(0x595)]=_0xeaa6e(0xdb2)+_0x5783f0[_0xeaa6e(0x278)]+_0xeaa6e(0xd56),_0x293cc3;}function _0x27e6c9(_0x2ea528){const _0x57df88=_0x241b18,_0x223e1d=document[_0x57df88(0x11e3)](_0x57df88(0xa94)),_0x1c7737=document['getElementById'](_0x57df88(0x12e3));if(_0x1c7737)_0x1c7737[_0x57df88(0x957)]();const _0x19bc89=_0x398166,_0x4ac198=_0x398166+CHAT_LIST_RENDER_WINDOW,_0x4d6304=_0x2ea528[_0x57df88(0xa6c)](_0x19bc89,_0x4ac198),_0x21faa8=document[_0x57df88(0xc6a)]();let _0x73991c=_0x223e1d['querySelector']('.chat-group-content:last-of-type');_0x4d6304[_0x57df88(0x494)](_0x366feb=>{const _0x44639f=_0x57df88;if(_0x366feb[_0x44639f(0xa20)]==='groupHeader'){const _0x2c3fcb=_0x5c53f6(_0x366feb[_0x44639f(0x264)]);_0x21faa8['appendChild'](_0x2c3fcb),_0x73991c=_0x2c3fcb['querySelector']('.chat-group-content');}else{if(_0x366feb['type']==='chatItem'){const _0x14e515=_0x379554(_0x366feb[_0x44639f(0x847)]);_0x73991c&&_0x366feb[_0x44639f(0x847)][_0x44639f(0xe0d)]?_0x73991c['appendChild'](_0x14e515):(_0x21faa8[_0x44639f(0x120c)](_0x14e515),_0x73991c=null);}}}),_0x223e1d[_0x57df88(0x120c)](_0x21faa8),_0x398166+=_0x4d6304[_0x57df88(0x594)],_0x2ea528[_0x57df88(0x594)]>_0x398166&&_0x2c5a21(_0x223e1d,_0x2ea528),document[_0x57df88(0x10d6)]('.chat-group-header')[_0x57df88(0x494)](_0x5db363=>{const _0xb3617c=_0x57df88,_0x116c96=_0x5db363[_0xb3617c(0x4b4)](!![]);_0x5db363[_0xb3617c(0x18c)]['replaceChild'](_0x116c96,_0x5db363),_0x116c96['addEventListener'](_0xb3617c(0x1041),()=>{const _0x3efb96=_0xb3617c;_0x116c96['classList'][_0x3efb96(0xe7e)](_0x3efb96(0x791)),_0x116c96['nextElementSibling'][_0x3efb96(0x505)][_0x3efb96(0xe7e)](_0x3efb96(0x791));});});}async function _0x5ee219(){const _0xe60432=_0x241b18,_0x26659f=document['getElementById']('chat-list');_0x26659f[_0xe60432(0x595)]='';const _0x26293e=Object[_0xe60432(0x4ca)](_0x5de8b7[_0xe60432(0x737)])[_0xe60432(0x861)]((_0x24098d,_0x7bbf1d)=>{const _0x8d207c=_0xe60432,_0x1e818f=(_0x7bbf1d[_0x8d207c(0x8ac)]||![])-(_0x24098d[_0x8d207c(0x8ac)]||![]);if(_0x1e818f!==0x0)return _0x1e818f;return(_0x7bbf1d['history']['slice'](-0x1)[0x0]?.[_0x8d207c(0x702)]||0x0)-(_0x24098d[_0x8d207c(0x49e)][_0x8d207c(0xa6c)](-0x1)[0x0]?.[_0x8d207c(0x702)]||0x0);}),_0x4d908a=await _0x2e83f8[_0xe60432(0xd31)]['toArray']();if(_0x26293e[_0xe60432(0x594)]===0x0){_0x26659f['innerHTML']=_0xe60432(0x1ff);return;}_0x4d908a[_0xe60432(0x494)](_0x48111e=>{const _0x638555=_0xe60432,_0x34f201=_0x26293e[_0x638555(0xe79)](_0x3aacdf=>_0x3aacdf[_0x638555(0xe0d)]===_0x48111e['id']);_0x48111e[_0x638555(0x1294)]=_0x34f201?_0x34f201[_0x638555(0x49e)][_0x638555(0xa6c)](-0x1)[0x0]?.['timestamp']||0x0:0x0;}),_0x4d908a[_0xe60432(0x861)]((_0xf363c6,_0x202331)=>_0x202331[_0xe60432(0x1294)]-_0xf363c6['latestTimestamp']),_0x1e20f2=[];const _0x11c94c=new Set();_0x4d908a[_0xe60432(0x494)](_0x42f618=>{const _0x516d9f=_0xe60432,_0x3e9900=_0x26293e[_0x516d9f(0x138)](_0x1d46f8=>!_0x1d46f8[_0x516d9f(0x1244)]&&_0x1d46f8[_0x516d9f(0xe0d)]===_0x42f618['id']);_0x3e9900[_0x516d9f(0x594)]>0x0&&(_0x1e20f2[_0x516d9f(0xf5)]({'type':_0x516d9f(0x98a),'group':_0x42f618}),_0x3e9900['forEach'](_0x1cd446=>{const _0x2707c1=_0x516d9f;_0x1e20f2['push']({'type':_0x2707c1(0x788),'chat':_0x1cd446}),_0x11c94c[_0x2707c1(0x252)](_0x1cd446['id']);}));}),_0x26293e[_0xe60432(0x494)](_0x3dde3e=>{const _0x291dde=_0xe60432;!_0x11c94c[_0x291dde(0x72a)](_0x3dde3e['id'])&&_0x1e20f2['push']({'type':'chatItem','chat':_0x3dde3e});}),_0x398166=0x0,_0x27e6c9();}function _0x5c53f6(_0x26716c){const _0x4addcb=_0x241b18,_0x3e8a66=document[_0x4addcb(0x383)](_0x4addcb(0x1285));return _0x3e8a66['className']=_0x4addcb(0xc7e),_0x3e8a66[_0x4addcb(0x595)]=_0x4addcb(0xbb0)+_0x26716c[_0x4addcb(0x278)]+_0x4addcb(0x7c2),_0x3e8a66;}function _0x2c5a21(_0xca061,_0x264fb1){const _0x126b06=_0x241b18,_0x55f340=document[_0x126b06(0x383)](_0x126b06(0xbf2));_0x55f340['id']=_0x126b06(0x12e3),_0x55f340['textContent']=_0x126b06(0x5bd),_0x55f340['className']=_0x126b06(0x1308),_0x55f340[_0x126b06(0x4b8)]('click',()=>_0x27e6c9(_0x264fb1),{'once':!![]}),_0xca061[_0x126b06(0xf61)](_0x55f340);}function _0x27e6c9(){const _0x298c11=_0x241b18;if(_0x50f724)return;const _0x26d0d2=document[_0x298c11(0x11e3)](_0x298c11(0xa94)),_0x490e0a=document[_0x298c11(0x11e3)](_0x298c11(0xde));if(!_0x26d0d2||!_0x490e0a)return;if(_0x398166>=_0x1e20f2[_0x298c11(0x594)])return;_0x50f724=!![];const _0x463b21=_0x398166===0x0,_0x2b3be3=()=>{const _0x105d9d=_0x298c11;_0x313362(_0x26d0d2);const _0x465703=_0x5de8b7[_0x105d9d(0x2df)][_0x105d9d(0xd0)]||0x1e,_0x5b69c7=_0x398166,_0x481df5=_0x398166+_0x465703,_0x2391e6=_0x1e20f2['slice'](_0x5b69c7,_0x481df5),_0x49d86f=document[_0x105d9d(0xc6a)]();let _0x2344f1=_0x26d0d2[_0x105d9d(0x5ac)](_0x105d9d(0x102d));_0x2391e6[_0x105d9d(0x494)](_0x2f459f=>{const _0x2926a2=_0x105d9d;if(_0x2f459f[_0x2926a2(0xa20)]===_0x2926a2(0x98a)){const _0x597e06=_0x5c53f6(_0x2f459f['group']);_0x49d86f[_0x2926a2(0x120c)](_0x597e06),_0x2344f1=_0x597e06[_0x2926a2(0x5ac)](_0x2926a2(0x105f));}else{if(_0x2f459f[_0x2926a2(0xa20)]===_0x2926a2(0x788)){const _0x36e68b=_0x379554(_0x2f459f[_0x2926a2(0x847)]);if(_0x2f459f['chat'][_0x2926a2(0xe0d)]&&_0x2344f1)_0x2344f1[_0x2926a2(0x120c)](_0x36e68b);else{_0x49d86f[_0x2926a2(0x120c)](_0x36e68b);if(!_0x2f459f[_0x2926a2(0x847)][_0x2926a2(0xe0d)])_0x2344f1=null;}}}}),_0x26d0d2[_0x105d9d(0x120c)](_0x49d86f),_0x398166+=_0x2391e6['length'],_0x26d0d2[_0x105d9d(0x10d6)](_0x105d9d(0x1a0))['forEach'](_0x2766ab=>{const _0x2f370b=_0x105d9d;_0x2766ab[_0x2f370b(0xaca)][_0x2f370b(0xc7f)]=_0x2f370b(0x126d),_0x2766ab[_0x2f370b(0x4b8)](_0x2f370b(0x1041),()=>{const _0x175bcd=_0x2f370b;_0x2766ab[_0x175bcd(0x505)][_0x175bcd(0xe7e)](_0x175bcd(0x791)),_0x2766ab[_0x175bcd(0xfee)][_0x175bcd(0x505)]['toggle']('collapsed');});}),_0x50f724=![],_0x490e0a[_0x105d9d(0x36b)]<=_0x490e0a[_0x105d9d(0x10d9)]&&_0x398166<_0x1e20f2[_0x105d9d(0x594)]&&_0x27e6c9();};_0x463b21?_0x2b3be3():(_0x28c761(_0x26d0d2,_0x298c11(0x1070)),setTimeout(_0x2b3be3,0x1f4));}function _0x379554(_0x37fd1a){const _0x2245ac=_0x241b18;try{const _0x23bd9c=_0x37fd1a[_0x2245ac(0x49e)]['filter'](_0x274a33=>!_0x274a33[_0x2245ac(0xbf5)])['slice'](-0x1)[0x0]||{};let _0x2ccc8c;if(!_0x37fd1a[_0x2245ac(0x1244)]&&_0x37fd1a['relationship']?.[_0x2245ac(0x739)]==='pending_user_approval')_0x2ccc8c='<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20'+(_0x37fd1a[_0x2245ac(0xa78)][_0x2245ac(0xa83)]||_0x2245ac(0x12cb))+_0x2245ac(0x4a3);else{if(!_0x37fd1a['isGroup']&&_0x37fd1a[_0x2245ac(0xa78)]?.[_0x2245ac(0x739)]===_0x2245ac(0x4ee))_0x2ccc8c='<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>';else{if(_0x37fd1a[_0x2245ac(0x1244)]){if(_0x23bd9c[_0x2245ac(0xa20)]===_0x2245ac(0x8ee))_0x2ccc8c=_0x2245ac(0x8fe)+_0x23bd9c[_0x2245ac(0x9a5)];else{if(_0x23bd9c[_0x2245ac(0xa20)]===_0x2245ac(0x82b))_0x2ccc8c='[转账]';else{if(_0x23bd9c[_0x2245ac(0xa20)]==='ai_image'||_0x23bd9c['type']==='user_photo')_0x2ccc8c=_0x2245ac(0x660);else{if(_0x23bd9c[_0x2245ac(0xa20)]===_0x2245ac(0x719))_0x2ccc8c=_0x2245ac(0x2a9);else{if(typeof _0x23bd9c[_0x2245ac(0x9a5)]===_0x2245ac(0x10d7)&&_0x9f9ac4[_0x2245ac(0x1043)](_0x23bd9c[_0x2245ac(0x9a5)]))_0x2ccc8c=_0x23bd9c[_0x2245ac(0xb36)]?_0x2245ac(0x119f)+_0x23bd9c[_0x2245ac(0xb36)]+']':_0x2245ac(0x893);else Array[_0x2245ac(0xb7b)](_0x23bd9c[_0x2245ac(0x9a5)])?_0x2ccc8c='[图片]':_0x2ccc8c=String(_0x23bd9c[_0x2245ac(0x9a5)]||'...')[_0x2245ac(0x8d4)](0x0,0x14);}}}}if(_0x23bd9c['senderName']&&_0x23bd9c['type']!=='pat_message'){const _0x2dcaa6=_0xd9d60a(_0x37fd1a,_0x23bd9c[_0x2245ac(0x768)]);_0x2ccc8c=_0x2dcaa6+':\x20'+_0x2ccc8c;}}else{const _0xb8249b=_0x37fd1a[_0x2245ac(0x739)]?.[_0x2245ac(0x1197)]||'在线';_0x2ccc8c='['+_0xb8249b+']';}}}const _0x4b0475=document['createElement'](_0x2245ac(0x1285));_0x4b0475[_0x2245ac(0x3db)]=_0x2245ac(0x7e5),_0x4b0475[_0x2245ac(0xaca)]['chatId']=_0x37fd1a['id'];_0x37fd1a['isPinned']&&_0x4b0475[_0x2245ac(0x505)]['add'](_0x2245ac(0xe43));const _0x484f86=_0x37fd1a[_0x2245ac(0x1244)]?_0x37fd1a[_0x2245ac(0x761)][_0x2245ac(0x75c)]:_0x37fd1a[_0x2245ac(0x761)][_0x2245ac(0x5e0)],_0x379151=_0x37fd1a['isGroup']?'':_0x37fd1a[_0x2245ac(0x761)]['aiAvatarFrame']||'';let _0x379ed0;_0x379151?_0x379ed0=_0x2245ac(0x220)+(_0x484f86||_0x3d2e44)+'\x22\x20class=\x22avatar-img\x22><img\x20src=\x22'+_0x379151+_0x2245ac(0x95a):_0x379ed0=_0x2245ac(0x13b)+(_0x484f86||_0x3d2e44)+_0x2245ac(0x457);const _0x56e4f5=_0x379151?_0x2245ac(0x2b7):'',_0x957cb4='<div\x20class=\x22avatar-group\x20'+_0x56e4f5+'\x22>'+_0x379ed0+'</div>';_0x4b0475['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x957cb4+_0x2245ac(0x1176)+_0x37fd1a['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x37fd1a[_0x2245ac(0x1244)]?_0x2245ac(0x1132):'')+_0x2245ac(0x3d4)+(_0x37fd1a[_0x2245ac(0x1244)]?_0x2245ac(0x49a):_0x2245ac(0xe93))+';\x20font-style:\x20italic;\x22>'+_0x2ccc8c+_0x2245ac(0x4d3);const _0x591c3e=_0x37fd1a[_0x2245ac(0xc3a)]||0x0,_0x50ce45=_0x4b0475[_0x2245ac(0x5ac)](_0x2245ac(0x143));_0x591c3e>0x0?(_0x50ce45[_0x2245ac(0x300)]=_0x591c3e>0x63?'99+':_0x591c3e,_0x50ce45['style'][_0x2245ac(0x33d)]=_0x2245ac(0xefb)):_0x50ce45['style']['display']=_0x2245ac(0x379);const _0x130011=_0x4b0475[_0x2245ac(0x5ac)]('.avatar-group');_0x130011&&(_0x130011[_0x2245ac(0x794)][_0x2245ac(0x4d0)]=_0x2245ac(0xc48),_0x130011['addEventListener'](_0x2245ac(0xef8),_0x232f9f=>{const _0x54656f=_0x2245ac;_0x232f9f[_0x54656f(0x7cb)]();const _0x217b5d=_0x37fd1a['isGroup']?_0x37fd1a['name']:_0x37fd1a['originalName'];_0x5be23d(_0x37fd1a['id'],_0x217b5d);}));const _0x42f835=_0x4b0475[_0x2245ac(0x5ac)](_0x2245ac(0x10ee));return _0x42f835&&_0x42f835[_0x2245ac(0x4b8)](_0x2245ac(0x1041),()=>_0x6cac66(_0x37fd1a['id'])),_0xcb6204(_0x4b0475,async _0x237f10=>{const _0x5ab00f=_0x2245ac,_0x1facff=await _0x5836e4(_0x37fd1a);switch(_0x1facff){case'pin':_0x37fd1a['isPinned']=!_0x37fd1a[_0x5ab00f(0x8ac)],await _0x2e83f8[_0x5ab00f(0x737)][_0x5ab00f(0xe3c)](_0x37fd1a),_0x5ee219();break;case _0x5ab00f(0xc0c):const _0x52dd38=await _0x58fd60(_0x5ab00f(0x1306),_0x5ab00f(0xb5f)+_0x37fd1a[_0x5ab00f(0x278)]+_0x5ab00f(0x9d4),{'confirmButtonClass':_0x5ab00f(0x8a6)});if(_0x52dd38){_0xb57b5b[_0x5ab00f(0x3d5)]&&_0xb57b5b[_0x5ab00f(0x93d)]===_0x37fd1a['id']&&await _0x48cc94(![]);delete _0x5de8b7['chats'][_0x37fd1a['id']];if(_0x5de8b7[_0x5ab00f(0x93d)]===_0x37fd1a['id'])_0x5de8b7[_0x5ab00f(0x93d)]=null;await _0x2e83f8['chats'][_0x5ab00f(0xc0c)](_0x37fd1a['id']),_0x5ee219();}break;default:break;}}),_0x4b0475;}catch(_0x458613){return console[_0x2245ac(0x1c1)](_0x2245ac(0x16e)+(_0x37fd1a['name']||'未知')+_0x2245ac(0xba8)+_0x37fd1a['id']+_0x2245ac(0xaa7),_0x458613),null;}}async function _0x544ab5(_0x1978f3){const _0x4d29b7=_0x241b18;_0x21b25b(),_0x27f384();const _0x589c95=_0x5de8b7[_0x4d29b7(0x737)][_0x1978f3];if(!_0x589c95)return;_0x2192b8();const _0x2c3585=document[_0x4d29b7(0x11e3)](_0x4d29b7(0xc9d)),_0xd46f35=document['getElementById']('chat-input-area'),_0x8c530f=document[_0x4d29b7(0x11e3)](_0x4d29b7(0x92a)),_0x3bb68f=document['getElementById'](_0x4d29b7(0xd61));_0x2c3585[_0x4d29b7(0xaca)][_0x4d29b7(0xad7)]=_0x589c95['settings'][_0x4d29b7(0xad7)]||_0x4d29b7(0xd3);const _0x23c0ea=_0x589c95[_0x4d29b7(0x761)][_0x4d29b7(0x1115)]||0xd;_0x2c3585[_0x4d29b7(0x794)][_0x4d29b7(0xd8c)](_0x4d29b7(0xb0a),_0x23c0ea+'px'),_0x5a313a(_0x589c95[_0x4d29b7(0x761)][_0x4d29b7(0x124)]||'','#chat-messages','custom-bubble-style'),document[_0x4d29b7(0x11e3)](_0x4d29b7(0x1205))[_0x4d29b7(0x300)]=_0x589c95[_0x4d29b7(0x278)];const _0x25f556=document[_0x4d29b7(0x11e3)](_0x4d29b7(0x11ba)),_0x3bd012=_0x25f556[_0x4d29b7(0x5ac)](_0x4d29b7(0xdca));_0x589c95[_0x4d29b7(0x1244)]?(_0x25f556[_0x4d29b7(0x794)][_0x4d29b7(0x33d)]=_0x4d29b7(0x379),document[_0x4d29b7(0x11e3)](_0x4d29b7(0x1195))['style'][_0x4d29b7(0x274)]=_0x4d29b7(0xc9c)):(_0x25f556[_0x4d29b7(0x794)][_0x4d29b7(0x33d)]=_0x4d29b7(0x10f4),document[_0x4d29b7(0x11e3)](_0x4d29b7(0x1195))['style'][_0x4d29b7(0x274)]=_0x4d29b7(0x48f),_0x3bd012[_0x4d29b7(0x300)]=_0x589c95[_0x4d29b7(0x739)]?.[_0x4d29b7(0x1197)]||'在线',_0x25f556[_0x4d29b7(0x505)][_0x4d29b7(0xe7e)](_0x4d29b7(0xbae),_0x589c95['status']?.[_0x4d29b7(0x1005)]||![]));const _0x15ecb9=document['getElementById']('chat-interface-screen'),_0x14b444=_0x589c95['settings'][_0x4d29b7(0xd10)],_0x2a9d77=_0x5de8b7[_0x4d29b7(0x2df)][_0x4d29b7(0x720)],_0x4064ea=document['getElementById'](_0x4d29b7(0x1e6))['classList'][_0x4d29b7(0x1121)]('dark-mode'),_0x438ca8=_0x4064ea?_0x4d29b7(0x495):_0x4d29b7(0x4fa);if(_0x14b444)_0x15ecb9[_0x4d29b7(0x794)][_0x4d29b7(0x123e)]=_0x4d29b7(0xac7)+_0x14b444+')',_0x15ecb9[_0x4d29b7(0x794)][_0x4d29b7(0x556)]=_0x4d29b7(0xbcd);else _0x2a9d77?(_0x15ecb9[_0x4d29b7(0x794)]['backgroundImage']=_0x4d29b7(0xac7)+_0x2a9d77+')',_0x15ecb9['style'][_0x4d29b7(0x556)]=_0x4d29b7(0xbcd)):(_0x15ecb9[_0x4d29b7(0x794)][_0x4d29b7(0x123e)]=_0x4d29b7(0x379),_0x15ecb9[_0x4d29b7(0x794)][_0x4d29b7(0x556)]=_0x438ca8);if(_0x589c95[_0x4d29b7(0x96c)])_0xd46f35['style'][_0x4d29b7(0x33d)]='none',_0x8c530f[_0x4d29b7(0x794)][_0x4d29b7(0x33d)]=_0x4d29b7(0x10f4),_0x3bb68f[_0x4d29b7(0x595)]=_0x4d29b7(0x76d),document['getElementById'](_0x4d29b7(0xe6c))[_0x4d29b7(0x1074)]=_0x439f24;else{_0xd46f35[_0x4d29b7(0x794)][_0x4d29b7(0x33d)]='flex',_0x8c530f['style'][_0x4d29b7(0x33d)]=_0x4d29b7(0x379),_0x3bb68f[_0x4d29b7(0x595)]='';if(!_0x589c95[_0x4d29b7(0x1244)]&&_0x589c95[_0x4d29b7(0xa78)][_0x4d29b7(0x739)]!==_0x4d29b7(0xe62)){_0x8c530f[_0x4d29b7(0x794)][_0x4d29b7(0x33d)]=_0x4d29b7(0x10f4),_0xd46f35[_0x4d29b7(0x794)][_0x4d29b7(0x88b)]=_0x4d29b7(0x1fe);let _0x37e736='';switch(_0x589c95['relationship'][_0x4d29b7(0x739)]){case _0x4d29b7(0x530):const _0x1b045f=_0x454e0e!==null,_0xd4143c=_0x589c95['relationship'][_0x4d29b7(0x64c)],_0x33dc73=_0x5de8b7[_0x4d29b7(0x2df)]['blockCooldownHours']||0x1,_0x11d42c=_0x33dc73*0x3c*0x3c*0x3e8,_0x556dc6=Date[_0x4d29b7(0x1182)]()-_0xd4143c,_0x21eb34=_0x556dc6>_0x11d42c,_0x4a4168=Math[_0x4d29b7(0x45d)](0x0,Math['ceil']((_0x11d42c-_0x556dc6)/(0x3e8*0x3c)));_0x37e736=_0x4d29b7(0xc97)+_0x589c95[_0x4d29b7(0x278)]+'”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20'+(_0x5de8b7[_0x4d29b7(0x2df)][_0x4d29b7(0xa99)]?_0x4d29b7(0xcc0):_0x4d29b7(0x8e4))+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20'+(_0x1b045f?'<span\x20style=\x22color:\x20green;\x22>运行中</span>':_0x4d29b7(0x2fa))+_0x4d29b7(0x276)+_0x589c95[_0x4d29b7(0xa78)][_0x4d29b7(0x739)]+_0x4d29b7(0xa29)+_0x33dc73+_0x4d29b7(0xbc1)+(_0x21eb34?_0x4d29b7(0xbf3):_0x4d29b7(0xbff)+_0x4a4168+_0x4d29b7(0x106c))+_0x4d29b7(0x7ef)+(_0x21eb34&&_0x5de8b7[_0x4d29b7(0x2df)][_0x4d29b7(0xa99)]?_0x4d29b7(0xf3d):'<span\x20style=\x22color:\x20red;\x22>未满足</span>')+_0x4d29b7(0xdd9);break;case _0x4d29b7(0x4ee):_0x37e736=_0x4d29b7(0x9f7);break;case'pending_user_approval':_0x37e736=_0x4d29b7(0x4c7)+_0x589c95['name']+_0x4d29b7(0xef1)+_0x589c95[_0x4d29b7(0xa78)][_0x4d29b7(0xa83)]+_0x4d29b7(0x11f6);break;case'pending_ai_approval':_0x37e736=_0x4d29b7(0xac9);break;}_0x3bb68f[_0x4d29b7(0x595)]=_0x37e736;}else _0x8c530f[_0x4d29b7(0x794)][_0x4d29b7(0x33d)]='none',_0xd46f35[_0x4d29b7(0x794)]['visibility']=_0x4d29b7(0x250);}_0x2c3585[_0x4d29b7(0x595)]='';const _0x123e1b=_0x589c95[_0x4d29b7(0x49e)];_0xd53d57=0x0;const _0x84611f=_0x5de8b7['globalSettings'][_0x4d29b7(0x896)]||0x32,_0x29f04b=_0x123e1b[_0x4d29b7(0xa6c)](-_0x84611f),_0x59d8f6=[];let _0x2a436c=0x0;for(const _0x3e7c0f of _0x29f04b){_0x2a436c>0x0&&_0x3e7c0f[_0x4d29b7(0x702)]-_0x2a436c>0x927c0&&_0x59d8f6[_0x4d29b7(0xf5)](Promise[_0x4d29b7(0x800)](_0x4cf713(_0x3e7c0f[_0x4d29b7(0x702)]))),_0x59d8f6[_0x4d29b7(0xf5)](_0xe99b75(_0x3e7c0f,_0x589c95,!![])),_0x2a436c=_0x3e7c0f['timestamp'];}const _0x322b03=await Promise['all'](_0x59d8f6),_0x287a26=document['createDocumentFragment']();_0x322b03[_0x4d29b7(0x138)](Boolean)['forEach'](_0xc691bf=>_0x287a26[_0x4d29b7(0x120c)](_0xc691bf)),_0x2c3585['appendChild'](_0x287a26),_0xd53d57=_0x29f04b[_0x4d29b7(0x594)];const _0x415f35=document['createElement']('div');_0x415f35['id']='typing-indicator',_0x415f35[_0x4d29b7(0x794)][_0x4d29b7(0x33d)]='none',_0x415f35[_0x4d29b7(0x300)]=_0x4d29b7(0xbe),_0x2c3585[_0x4d29b7(0x120c)](_0x415f35),setTimeout(()=>_0x2c3585[_0x4d29b7(0x11c7)]=_0x2c3585['scrollHeight'],0x0);}async function _0x54384e(){const _0x31dec3=_0x241b18;if(_0x35a438)return;_0x35a438=!![];const _0x2914f5=document[_0x31dec3(0x11e3)](_0x31dec3(0xc9d)),_0x141dc6=_0x5de8b7['chats'][_0x5de8b7[_0x31dec3(0x93d)]];if(!_0x141dc6){_0x35a438=![];return;}_0x28c761(_0x2914f5,_0x31dec3(0x10e2));const _0x58b627=_0x2914f5['scrollHeight'];await new Promise(_0x286d21=>setTimeout(_0x286d21,0x1f4));const _0x1bd1ce=_0x141dc6[_0x31dec3(0x49e)][_0x31dec3(0x594)],_0x16341b=_0x5de8b7['globalSettings']['chatRenderWindow']||0x32,_0xe7c1f1=_0x1bd1ce-_0xd53d57-_0x16341b,_0x2bec79=_0x1bd1ce-_0xd53d57,_0x3f948d=_0x141dc6[_0x31dec3(0x49e)][_0x31dec3(0xa6c)](Math['max'](0x0,_0xe7c1f1),_0x2bec79),_0x1061c2=_0x2914f5[_0x31dec3(0x5ac)]('.message-wrapper[data-timestamp]');let _0x235c77=_0x1061c2?parseInt(_0x1061c2[_0x31dec3(0xaca)][_0x31dec3(0x702)]):0x0;for(const _0x12d967 of _0x3f948d[_0x31dec3(0x107)]()){if(_0x235c77>0x0&&_0x235c77-_0x12d967[_0x31dec3(0x702)]>0x927c0){const _0x4d8afa=_0x4cf713(_0x235c77);_0x2914f5['prepend'](_0x4d8afa);}await _0x42a76d(_0x12d967,_0x141dc6),_0x235c77=_0x12d967['timestamp'];}_0xd53d57+=_0x3f948d[_0x31dec3(0x594)];const _0x22d5a8=_0x2914f5[_0x31dec3(0x36b)];_0x2914f5[_0x31dec3(0x11c7)]=_0x22d5a8-_0x58b627,_0x313362(_0x2914f5),_0x35a438=![];}function _0x1f90a4(){const _0x32e1b3=_0x241b18;_0x9e05fe(),_0x502814();const _0x3cc8f4=document['getElementById']('wallpaper-preview'),_0x43212f=_0x5de8b7['globalSettings']['wallpaper'];_0x43212f?(_0x3cc8f4[_0x32e1b3(0x794)]['backgroundImage']=_0x32e1b3(0xac7)+_0x43212f+')',_0x3cc8f4['textContent']=''):(_0x3cc8f4[_0x32e1b3(0x794)][_0x32e1b3(0x123e)]=_0x32e1b3(0x6a1),_0x3cc8f4['textContent']='当前为渐变色');const _0x2da6a6=document[_0x32e1b3(0x11e3)](_0x32e1b3(0x3be)),_0x330860=_0x5de8b7[_0x32e1b3(0x2df)][_0x32e1b3(0xaa4)];_0x330860?(_0x2da6a6[_0x32e1b3(0x794)][_0x32e1b3(0x123e)]=_0x32e1b3(0xac7)+_0x330860+')',_0x2da6a6[_0x32e1b3(0x300)]=''):(_0x2da6a6[_0x32e1b3(0x794)]['backgroundImage']=_0x32e1b3(0x1286),_0x2da6a6[_0x32e1b3(0x300)]='当前为渐变色');const _0xa00784=document['getElementById']('global-bg-preview'),_0x1dbb06=_0x5de8b7[_0x32e1b3(0x2df)][_0x32e1b3(0x720)];_0x1dbb06?(_0xa00784[_0x32e1b3(0x794)]['backgroundImage']=_0x32e1b3(0xac7)+_0x1dbb06+')',_0xa00784[_0x32e1b3(0x300)]='',document[_0x32e1b3(0x11e3)](_0x32e1b3(0x78b))[_0x32e1b3(0x794)][_0x32e1b3(0x33d)]=_0x32e1b3(0xfc6)):(_0xa00784[_0x32e1b3(0x794)][_0x32e1b3(0x123e)]=_0x32e1b3(0x379),_0xa00784['textContent']=_0x32e1b3(0x12f9),document['getElementById'](_0x32e1b3(0x78b))[_0x32e1b3(0x794)]['display']=_0x32e1b3(0x379)),_0x222868(),_0x3e1b8d(),document[_0x32e1b3(0x11e3)](_0x32e1b3(0x434))[_0x32e1b3(0xf27)]=_0x5de8b7[_0x32e1b3(0x2df)][_0x32e1b3(0x691)]||'',document['getElementById'](_0x32e1b3(0x16d))[_0x32e1b3(0xf27)]=_0x5de8b7['globalSettings'][_0x32e1b3(0x688)]||'',document[_0x32e1b3(0x11e3)](_0x32e1b3(0xb5))['checked']=_0x5de8b7['globalSettings']['showStatusBar']||![],_0x3d6bc1(),_0x35f161();}window['renderWallpaperScreenProxy']=_0x1f90a4;function _0x34145f(){const _0x52c1cb=_0x241b18,_0xb2be1c=document[_0x52c1cb(0x11e3)](_0x52c1cb(0x417)),_0xe446db=_0x5de8b7['globalSettings'][_0x52c1cb(0x11d)];_0xe446db?_0xb2be1c[_0x52c1cb(0x794)]['backgroundImage']=_0x52c1cb(0xac7)+_0xe446db+')':_0xb2be1c[_0x52c1cb(0x794)]['backgroundImage']=_0x52c1cb(0x6a1);}function _0x295be2(_0x35e827){const _0x10f977=_0x241b18;document['querySelectorAll'](_0x10f977(0x4f2))[_0x10f977(0x494)](_0x1da8a9=>{const _0x3d1e12=_0x10f977;_0x1da8a9[_0x3d1e12(0x505)][_0x3d1e12(0xe7e)](_0x3d1e12(0x1fc),_0x1da8a9[_0x3d1e12(0xaca)][_0x3d1e12(0x9ee)]===_0x35e827);}),document[_0x10f977(0x10d6)]('.world-book-category-pane')[_0x10f977(0x494)](_0x2ff895=>{const _0x50066f=_0x10f977;_0x2ff895[_0x50066f(0x505)][_0x50066f(0xe7e)]('active',_0x2ff895['dataset'][_0x50066f(0x9ee)]===_0x35e827);});}async function _0x570ac2(){const _0x3b70ca=_0x241b18,_0x3ed24f=document[_0x3b70ca(0x11e3)](_0x3b70ca(0xbaa)),_0x3278bf=document['getElementById'](_0x3b70ca(0xe40));_0x3ed24f[_0x3b70ca(0x595)]='',_0x3278bf['innerHTML']='';const [_0x31d657,_0x4f3b5f]=await Promise['all']([_0x2e83f8[_0x3b70ca(0xca)][_0x3b70ca(0x508)](),_0x2e83f8[_0x3b70ca(0xaac)][_0x3b70ca(0x7c6)]('name')[_0x3b70ca(0x508)]()]);_0x5de8b7[_0x3b70ca(0xca)]=_0x31d657;if(_0x31d657[_0x3b70ca(0x594)]===0x0){_0x3278bf[_0x3b70ca(0x595)]=_0x3b70ca(0xf81);return;}const _0x3f9f8a=document[_0x3b70ca(0x383)](_0x3b70ca(0xbf2));_0x3f9f8a[_0x3b70ca(0x3db)]=_0x3b70ca(0xf99),_0x3f9f8a[_0x3b70ca(0x300)]='全部',_0x3f9f8a['dataset'][_0x3b70ca(0x9ee)]='all',_0x3ed24f[_0x3b70ca(0x120c)](_0x3f9f8a);const _0x1c2a79=document['createElement'](_0x3b70ca(0x1285));_0x1c2a79[_0x3b70ca(0x3db)]=_0x3b70ca(0x10c3),_0x1c2a79[_0x3b70ca(0xaca)][_0x3b70ca(0x9ee)]=_0x3b70ca(0xd4a),_0x3278bf[_0x3b70ca(0x120c)](_0x1c2a79),_0x4f3b5f[_0x3b70ca(0x494)](_0x104945=>{const _0x21bf5b=_0x3b70ca,_0x33a06f=document[_0x21bf5b(0x383)](_0x21bf5b(0xbf2));_0x33a06f[_0x21bf5b(0x3db)]=_0x21bf5b(0x928),_0x33a06f[_0x21bf5b(0x300)]=_0x104945[_0x21bf5b(0x278)],_0x33a06f[_0x21bf5b(0xaca)][_0x21bf5b(0x9ee)]=String(_0x104945['id']),_0x3ed24f[_0x21bf5b(0x120c)](_0x33a06f);const _0xbfd236=document[_0x21bf5b(0x383)](_0x21bf5b(0x1285));_0xbfd236[_0x21bf5b(0x3db)]=_0x21bf5b(0xa64),_0xbfd236['dataset']['categoryId']=String(_0x104945['id']),_0x3278bf[_0x21bf5b(0x120c)](_0xbfd236);});const _0x1a30f1=_0x31d657[_0x3b70ca(0xe7c)](_0xa92af2=>!_0xa92af2[_0x3b70ca(0x9ee)]);if(_0x1a30f1){const _0x54e18c=document[_0x3b70ca(0x383)](_0x3b70ca(0xbf2));_0x54e18c[_0x3b70ca(0x3db)]='world-book-tab',_0x54e18c[_0x3b70ca(0x300)]=_0x3b70ca(0x124f),_0x54e18c[_0x3b70ca(0xaca)]['categoryId']=_0x3b70ca(0xb81),_0x3ed24f[_0x3b70ca(0x120c)](_0x54e18c);const _0x12f5b1=document[_0x3b70ca(0x383)](_0x3b70ca(0x1285));_0x12f5b1[_0x3b70ca(0x3db)]='world-book-category-pane',_0x12f5b1['dataset'][_0x3b70ca(0x9ee)]=_0x3b70ca(0xb81),_0x3278bf[_0x3b70ca(0x120c)](_0x12f5b1);}_0x31d657[_0x3b70ca(0x494)](_0x5f0baf=>{const _0x225d0c=_0x3b70ca;let _0x4fb791='暂无内容...';if(Array[_0x225d0c(0xb7b)](_0x5f0baf[_0x225d0c(0x9a5)])&&_0x5f0baf[_0x225d0c(0x9a5)][_0x225d0c(0x594)]>0x0){const _0xcbf0bf=_0x5f0baf[_0x225d0c(0x9a5)][0x0];_0x4fb791=_0xcbf0bf['comment']||_0xcbf0bf[_0x225d0c(0x9a5)]||'';}else typeof _0x5f0baf[_0x225d0c(0x9a5)]===_0x225d0c(0x10d7)&&_0x5f0baf[_0x225d0c(0x9a5)][_0x225d0c(0xeb7)]()!==''&&(_0x4fb791=_0x5f0baf[_0x225d0c(0x9a5)]);const _0x1535a3=document[_0x225d0c(0x383)](_0x225d0c(0x1285));_0x1535a3[_0x225d0c(0x3db)]=_0x225d0c(0x849),_0x1535a3[_0x225d0c(0x595)]=_0x225d0c(0x174)+_0x5f0baf['name']+_0x225d0c(0x7b3)+_0x4fb791+_0x225d0c(0x1d9);const _0x2eb173=()=>_0x5b1bfb(_0x5f0baf['id']),_0x291b63=async()=>{const _0x5ac9e5=_0x225d0c,_0xe5ce2a=await _0x58fd60(_0x5ac9e5(0x125f),_0x5ac9e5(0x1287)+_0x5f0baf[_0x5ac9e5(0x278)]+_0x5ac9e5(0xe48),{'confirmButtonClass':'btn-danger'});_0xe5ce2a&&(await _0x2e83f8[_0x5ac9e5(0xca)]['delete'](_0x5f0baf['id']),_0x5de8b7[_0x5ac9e5(0xca)]=_0x5de8b7[_0x5ac9e5(0xca)][_0x5ac9e5(0x138)](_0x471b10=>_0x471b10['id']!==_0x5f0baf['id']),_0x570ac2());};_0x1535a3[_0x225d0c(0x4b8)]('click',_0x2eb173),_0xcb6204(_0x1535a3,_0x291b63);const _0x124a74=_0x1535a3[_0x225d0c(0x4b4)](!![]);_0x124a74['addEventListener']('click',_0x2eb173),_0xcb6204(_0x124a74,_0x291b63),_0x1c2a79['appendChild'](_0x124a74);const _0x55bdb4=_0x5f0baf[_0x225d0c(0x9ee)]?String(_0x5f0baf[_0x225d0c(0x9ee)]):_0x225d0c(0xb81),_0x51a5d2=_0x3278bf[_0x225d0c(0x5ac)](_0x225d0c(0x104d)+_0x55bdb4+'\x22]');_0x51a5d2&&_0x51a5d2[_0x225d0c(0x120c)](_0x1535a3);}),document[_0x3b70ca(0x10d6)](_0x3b70ca(0x4f2))[_0x3b70ca(0x494)](_0x4c0734=>{const _0x21d34b=_0x3b70ca;_0x4c0734[_0x21d34b(0x4b8)](_0x21d34b(0x1041),()=>_0x295be2(_0x4c0734[_0x21d34b(0xaca)]['categoryId']));});}function _0xf76600(_0x4f748c,_0x104088){const _0x14975a=_0x241b18,_0x212d66=document[_0x14975a(0x383)](_0x14975a(0x1285));_0x212d66[_0x14975a(0x3db)]=_0x14975a(0xbab),_0x212d66[_0x14975a(0x595)]=_0x14975a(0x9fe)+_0x4f748c+_0x14975a(0x472);const _0x15e09b=_0x212d66[_0x14975a(0x5ac)]('.world-book-group-content');return _0x104088[_0x14975a(0x861)]((_0x1e1242,_0x37f75b)=>_0x1e1242[_0x14975a(0x278)][_0x14975a(0x34a)](_0x37f75b[_0x14975a(0x278)],_0x14975a(0x898))),_0x104088[_0x14975a(0x494)](_0x59ad2d=>{const _0x2cbd5e=_0x14975a;let _0x2d2032=_0x2cbd5e(0x2d2);if(Array[_0x2cbd5e(0xb7b)](_0x59ad2d['content'])&&_0x59ad2d[_0x2cbd5e(0x9a5)][_0x2cbd5e(0x594)]>0x0){const _0x39ead6=_0x59ad2d['content'][0x0];_0x2d2032=_0x39ead6[_0x2cbd5e(0xebd)]||_0x39ead6[_0x2cbd5e(0x9a5)]||'';}else typeof _0x59ad2d[_0x2cbd5e(0x9a5)]===_0x2cbd5e(0x10d7)&&_0x59ad2d[_0x2cbd5e(0x9a5)][_0x2cbd5e(0xeb7)]()!==''&&(_0x2d2032=_0x59ad2d[_0x2cbd5e(0x9a5)]);const _0x3f6ef7=document[_0x2cbd5e(0x383)](_0x2cbd5e(0x1285));_0x3f6ef7['className']=_0x2cbd5e(0x645),_0x3f6ef7[_0x2cbd5e(0xaca)][_0x2cbd5e(0x179)]=_0x59ad2d['id'],_0x3f6ef7[_0x2cbd5e(0x595)]=_0x2cbd5e(0x10d2)+_0x59ad2d[_0x2cbd5e(0x278)]+_0x2cbd5e(0x3ff)+String(_0x2d2032)[_0x2cbd5e(0x8d4)](0x0,0x32)+_0x2cbd5e(0x1d9),_0x3f6ef7[_0x2cbd5e(0x4b8)]('click',()=>_0x5b1bfb(_0x59ad2d['id'])),_0xcb6204(_0x3f6ef7,async()=>{const _0x21701f=_0x2cbd5e,_0x7d817b=await _0x58fd60(_0x21701f(0x125f),_0x21701f(0x1287)+_0x59ad2d[_0x21701f(0x278)]+_0x21701f(0x1229),{'confirmButtonClass':_0x21701f(0x8a6)});_0x7d817b&&(await _0x2e83f8[_0x21701f(0xca)]['delete'](_0x59ad2d['id']),_0x5de8b7[_0x21701f(0xca)]=_0x5de8b7[_0x21701f(0xca)][_0x21701f(0x138)](_0x158f16=>_0x158f16['id']!==_0x59ad2d['id']),_0x570ac2());}),_0x15e09b[_0x2cbd5e(0x120c)](_0x3f6ef7);}),_0x212d66;}window['renderWorldBookScreenProxy']=_0x570ac2;async function _0x5b1bfb(_0x494dae){const _0x3fb65e=_0x241b18;_0x4e7698(_0x3fb65e(0x1156)),_0x3bebd3=_0x494dae;const [_0x37a5ca,_0x39f547]=await Promise[_0x3fb65e(0xd4a)]([_0x2e83f8[_0x3fb65e(0xca)]['get'](_0x494dae),_0x2e83f8[_0x3fb65e(0xaac)]['toArray']()]);if(!_0x37a5ca){console['error'](_0x3fb65e(0x12f8),_0x494dae),_0x4e7698(_0x3fb65e(0x474));return;}document[_0x3fb65e(0x11e3)](_0x3fb65e(0x4c9))[_0x3fb65e(0x300)]=_0x37a5ca[_0x3fb65e(0x278)],document[_0x3fb65e(0x11e3)](_0x3fb65e(0xc79))[_0x3fb65e(0xf27)]=_0x37a5ca[_0x3fb65e(0x278)];const _0x7c4fd3=document[_0x3fb65e(0x11e3)](_0x3fb65e(0xf34));_0x7c4fd3[_0x3fb65e(0x595)]=_0x3fb65e(0xce4),_0x39f547['forEach'](_0x23266a=>{const _0x3a45f9=_0x3fb65e,_0x4617b8=document[_0x3a45f9(0x383)]('option');_0x4617b8[_0x3a45f9(0xf27)]=_0x23266a['id'],_0x4617b8[_0x3a45f9(0x300)]=_0x23266a[_0x3a45f9(0x278)];if(_0x37a5ca[_0x3a45f9(0x9ee)]===_0x23266a['id'])_0x4617b8[_0x3a45f9(0xbbc)]=!![];_0x7c4fd3[_0x3a45f9(0x120c)](_0x4617b8);});const _0x30ae55=document[_0x3fb65e(0x11e3)](_0x3fb65e(0x24b));_0x30ae55[_0x3fb65e(0x595)]='',Array[_0x3fb65e(0xb7b)](_0x37a5ca[_0x3fb65e(0x9a5)])&&_0x37a5ca[_0x3fb65e(0x9a5)][_0x3fb65e(0x594)]>0x0?_0x37a5ca[_0x3fb65e(0x9a5)]['forEach'](_0x435431=>{const _0x427e51=_0x3fb65e,_0x4195b5=_0x37e205(_0x435431);_0x30ae55[_0x427e51(0x120c)](_0x4195b5);}):_0x30ae55[_0x3fb65e(0x595)]=_0x3fb65e(0x66a);}async function _0x40d6fc(_0x219600=!![]){const _0x5f2d23=_0x241b18,_0xbb7aec=document[_0x5f2d23(0x11e3)](_0x5f2d23(0x11eb)),_0x165f5d=document[_0x5f2d23(0x11e3)](_0x5f2d23(0xe52)),_0x33f5aa=document['getElementById'](_0x5f2d23(0x5a9)),_0x4374fe=_0x33f5aa[_0x5f2d23(0xf27)][_0x5f2d23(0xeb7)]()['toLowerCase']();if(_0x219600){_0x165f5d[_0x5f2d23(0x595)]='';const _0x3c0635=await _0x2e83f8[_0x5f2d23(0x120e)]['toArray']();_0x165f5d[_0x5f2d23(0x595)]+='<button\x20class=\x22sticker-category-tab\x20'+(_0x10c076===_0x5f2d23(0xd4a)?_0x5f2d23(0x1fc):'')+_0x5f2d23(0x865),_0x3c0635[_0x5f2d23(0x494)](_0x352b9d=>{const _0x236f3d=_0x5f2d23;_0x165f5d[_0x236f3d(0x595)]+=_0x236f3d(0x839)+(_0x10c076===_0x352b9d['id']?'active':'')+_0x236f3d(0xc0)+_0x352b9d['id']+'\x22>'+_0x352b9d[_0x236f3d(0x278)]+'</button>';}),_0x165f5d['innerHTML']+=_0x5f2d23(0x839)+(_0x10c076===_0x5f2d23(0xb81)?_0x5f2d23(0x1fc):'')+_0x5f2d23(0x340);}_0xbb7aec[_0x5f2d23(0x595)]='';let _0xa36a6d;if(_0x10c076==='all')_0xa36a6d=_0x5de8b7[_0x5f2d23(0xa67)];else _0x10c076===_0x5f2d23(0xb81)?_0xa36a6d=_0x5de8b7[_0x5f2d23(0xa67)][_0x5f2d23(0x138)](_0x35e3a1=>!_0x35e3a1['categoryId']):_0xa36a6d=_0x5de8b7[_0x5f2d23(0xa67)][_0x5f2d23(0x138)](_0x46fdf9=>_0x46fdf9['categoryId']===_0x10c076);const _0x3f7db8=_0x4374fe?_0xa36a6d[_0x5f2d23(0x138)](_0x27cc22=>_0x27cc22['name'][_0x5f2d23(0xb03)]()[_0x5f2d23(0x3ad)](_0x4374fe)):_0xa36a6d;if(_0x3f7db8[_0x5f2d23(0x594)]===0x0){const _0x23f90a=_0x4374fe?_0x5f2d23(0xc75):_0x5f2d23(0xadc);_0xbb7aec[_0x5f2d23(0x595)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>'+_0x23f90a+'</p>';return;}_0x3f7db8[_0x5f2d23(0x494)](_0x2d36d8=>{const _0x14d459=_0x5f2d23,_0x195c3c=document['createElement']('div');_0x195c3c[_0x14d459(0x3db)]=_0x14d459(0x10bf),_0x195c3c[_0x14d459(0x740)]=_0x2d36d8[_0x14d459(0x278)],_0x195c3c[_0x14d459(0xaca)][_0x14d459(0xa04)]=_0x2d36d8['id'],_0x195c3c[_0x14d459(0x595)]=_0x14d459(0x83b)+_0x2d36d8['url']+_0x14d459(0xb92)+_0x2d36d8[_0x14d459(0x278)]+_0x14d459(0x8e8),_0x195c3c['addEventListener']('click',()=>{_0x494b6b?_0xb13f4b(_0x195c3c):_0x46680f(_0x2d36d8);});const _0x46504=document[_0x14d459(0x383)](_0x14d459(0x1285));_0x46504[_0x14d459(0x3db)]=_0x14d459(0xf28),_0x46504[_0x14d459(0x595)]=_0x14d459(0x12b6),_0x46504[_0x14d459(0x1074)]=async _0x409bb4=>{const _0xcc3aeb=_0x14d459;_0x409bb4[_0xcc3aeb(0x7cb)]();const _0x291e72=await _0x58fd60(_0xcc3aeb(0x2c4),_0xcc3aeb(0x11cf)+_0x2d36d8[_0xcc3aeb(0x278)]+_0xcc3aeb(0xcd3),{'confirmButtonClass':_0xcc3aeb(0x8a6)});_0x291e72&&(await _0x2e83f8[_0xcc3aeb(0xa67)][_0xcc3aeb(0xc0c)](_0x2d36d8['id']),_0x5de8b7[_0xcc3aeb(0xa67)]=_0x5de8b7[_0xcc3aeb(0xa67)]['filter'](_0x5620c3=>_0x5620c3['id']!==_0x2d36d8['id']),_0x40d6fc());},_0x195c3c[_0x14d459(0x120c)](_0x46504),_0xbb7aec['appendChild'](_0x195c3c);});}let _0x494b6b=![],_0x1679ae=new Set();function _0x540c2e(){const _0x3e6c81=_0x241b18;_0x494b6b=!_0x494b6b;const _0x8b9ee8=document[_0x3e6c81(0x11e3)](_0x3e6c81(0x11eb)),_0x4cfbdf=document[_0x3e6c81(0x11e3)](_0x3e6c81(0x3b3)),_0x593a52=document[_0x3e6c81(0x11e3)]('sticker-action-bar'),_0x24d65b=document[_0x3e6c81(0x11e3)](_0x3e6c81(0xca6));_0x8b9ee8[_0x3e6c81(0x505)][_0x3e6c81(0xe7e)]('management-mode',_0x494b6b),_0x494b6b?(_0x4cfbdf[_0x3e6c81(0x300)]='完成',_0x593a52[_0x3e6c81(0x794)][_0x3e6c81(0x33d)]='flex',_0x1679ae[_0x3e6c81(0x7ab)](),_0x24d65b[_0x3e6c81(0x3e4)]=![],_0x59857a()):(_0x4cfbdf[_0x3e6c81(0x300)]='管理',_0x593a52[_0x3e6c81(0x794)][_0x3e6c81(0x33d)]='none',_0x8b9ee8[_0x3e6c81(0x10d6)]('.sticker-item.selected')[_0x3e6c81(0x494)](_0x2b3e53=>_0x2b3e53[_0x3e6c81(0x505)]['remove'](_0x3e6c81(0xbbc))));}function _0x45a295(){const _0x27e0fe=_0x241b18,_0x4adb63=document[_0x27e0fe(0x11e3)](_0x27e0fe(0xca6)),_0x1ce85c=_0x4adb63[_0x27e0fe(0x3e4)];let _0x110ef4;if(_0x10c076===_0x27e0fe(0xd4a))_0x110ef4=_0x5de8b7[_0x27e0fe(0xa67)];else _0x10c076==='uncategorized'?_0x110ef4=_0x5de8b7[_0x27e0fe(0xa67)][_0x27e0fe(0x138)](_0x4f770a=>!_0x4f770a['categoryId']):_0x110ef4=_0x5de8b7[_0x27e0fe(0xa67)]['filter'](_0x515f3d=>_0x515f3d['categoryId']===_0x10c076);_0x110ef4[_0x27e0fe(0x494)](_0x56102d=>{const _0x51a303=_0x27e0fe,_0x49abba=_0x56102d['id'],_0x30f57d=document[_0x51a303(0x5ac)](_0x51a303(0x25b)+_0x49abba+'\x22]');if(_0x1ce85c){_0x1679ae[_0x51a303(0x252)](_0x49abba);if(_0x30f57d)_0x30f57d[_0x51a303(0x505)][_0x51a303(0x252)](_0x51a303(0xbbc));}else{_0x1679ae[_0x51a303(0xc0c)](_0x49abba);if(_0x30f57d)_0x30f57d[_0x51a303(0x505)][_0x51a303(0x957)](_0x51a303(0xbbc));}}),_0x59857a();}function _0x59857a(){const _0x3b514b=_0x241b18,_0x3a77e2=document['getElementById'](_0x3b514b(0x41f));_0x3a77e2[_0x3b514b(0x300)]=_0x3b514b(0x662)+_0x1679ae['size']+')';}function _0xb13f4b(_0x2d5023){const _0x298f8e=_0x241b18;if(!_0x494b6b)return;const _0x57da2d=_0x2d5023['dataset'][_0x298f8e(0xa04)];if(!_0x57da2d)return;_0x2d5023[_0x298f8e(0x505)]['toggle']('selected'),_0x1679ae[_0x298f8e(0x72a)](_0x57da2d)?_0x1679ae[_0x298f8e(0xc0c)](_0x57da2d):_0x1679ae[_0x298f8e(0x252)](_0x57da2d),_0x59857a();}async function _0x5cfbd6(){const _0x37776f=_0x241b18;if(_0x1679ae[_0x37776f(0x1159)]===0x0)return;const _0x59857f=await _0x58fd60(_0x37776f(0x1166),_0x37776f(0x19c)+_0x1679ae[_0x37776f(0x1159)]+_0x37776f(0x3f6),{'confirmButtonClass':_0x37776f(0x8a6)});if(_0x59857f){const _0x8b7613=[..._0x1679ae];await _0x2e83f8[_0x37776f(0xa67)][_0x37776f(0x7ac)](_0x8b7613),_0x5de8b7[_0x37776f(0xa67)]=_0x5de8b7[_0x37776f(0xa67)][_0x37776f(0x138)](_0x3dbb8d=>!_0x8b7613[_0x37776f(0x3ad)](_0x3dbb8d['id'])),_0x540c2e(),_0x40d6fc(),await _0x2fb06(_0x37776f(0x699),_0x37776f(0x4e2));}}async function _0x13f9ce(){const _0x23d0ee=_0x241b18,_0x4ece15=_0x23d0ee(0x589),_0x15ea17=await _0x231a5a(_0x23d0ee(0x7cc),_0x4ece15,'',_0x23d0ee(0x10bb));_0x15ea17&&_0x15ea17['trim']()&&await _0x25a1b1(_0x15ea17);}async function _0x25a1b1(_0x3004a1){const _0x409dc5=_0x241b18,_0x2d034e=_0x3004a1[_0x409dc5(0xeb7)]()[_0x409dc5(0x65b)]('\x0a'),_0x38b94b=[],_0x1ea7c2=_0x409dc5(0x110e);let _0x5b332e=0x0;const _0x223354=_0x10c076!==_0x409dc5(0xd4a)&&_0x10c076!==_0x409dc5(0xb81)?_0x10c076:null;for(const _0x5dc888 of _0x2d034e){const _0x51fba4=_0x5dc888['trim']();if(!_0x51fba4||_0x51fba4[_0x409dc5(0x3ad)]('填入'))continue;const _0x47860b=_0x51fba4[_0x409dc5(0xe9f)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x47860b){const _0x5c17a6=_0x47860b[0x1][_0x409dc5(0xeb7)](),_0x98d0a8=_0x47860b[0x2][_0x409dc5(0xeb7)]();_0x38b94b['push']({'id':'sticker_'+Date[_0x409dc5(0x1182)]()+Math['random'](),'name':_0x5c17a6,'url':_0x98d0a8,'categoryId':_0x223354});continue;}let _0x38c04e=null,_0x58a1f9=null;const _0x2f17b2=_0x51fba4['match'](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x2f17b2)_0x38c04e=_0x2f17b2[0x1],_0x58a1f9=_0x2f17b2[0x2];else{const _0x386677=_0x51fba4[_0x409dc5(0x65b)](/\s+/);_0x386677['length']>=0x2&&(_0x58a1f9=_0x386677[_0x409dc5(0x647)](),_0x38c04e=_0x386677['join']('\x20'));}_0x38c04e&&_0x58a1f9&&_0x58a1f9['includes']('.')?_0x38b94b[_0x409dc5(0xf5)]({'id':_0x409dc5(0x1208)+Date[_0x409dc5(0x1182)]()+Math['random'](),'name':_0x38c04e,'url':_0x1ea7c2+_0x58a1f9,'categoryId':_0x223354}):(_0x5b332e++,console[_0x409dc5(0x6b0)](_0x409dc5(0xa41),_0x51fba4));}_0x5b332e>0x0&&await _0x2fb06(_0x409dc5(0x3dc),'有\x20'+_0x5b332e+_0x409dc5(0xc19));if(_0x38b94b[_0x409dc5(0x594)]>0x0)await _0x2e83f8[_0x409dc5(0xa67)][_0x409dc5(0xc16)](_0x38b94b),_0x5de8b7[_0x409dc5(0xa67)][_0x409dc5(0xf5)](..._0x38b94b),_0x40d6fc(),await _0x2fb06(_0x409dc5(0xb5e),_0x409dc5(0x3b5)+_0x38b94b[_0x409dc5(0x594)]+_0x409dc5(0x103c));else _0x5b332e===0x0&&alert(_0x409dc5(0x4db));}function _0x2b137c(_0x41a980){const _0x282cbf=_0x241b18,_0x333389='.message-bubble[data-timestamp=\x22'+_0x41a980+'\x22]',_0x19c932=document[_0x282cbf(0x5ac)](_0x333389);_0x19c932?(_0x19c932[_0x282cbf(0x6e1)]({'behavior':'smooth','block':_0x282cbf(0xc9c)}),_0x19c932[_0x282cbf(0x505)][_0x282cbf(0x252)](_0x282cbf(0x964)),setTimeout(()=>{const _0x130524=_0x282cbf;document[_0x130524(0xdf2)][_0x130524(0x1121)](_0x19c932)&&_0x19c932[_0x130524(0x505)]['remove']('highlighted');},0x5dc)):alert(_0x282cbf(0x121f));}async function _0xe99b75(_0x1e681e,_0x194ff4){const _0x18b1b1=_0x241b18;if(_0x1e681e['type']===_0x18b1b1(0xfb3)){const _0x1a5d91=document['createElement'](_0x18b1b1(0x1285));_0x1a5d91[_0x18b1b1(0x3db)]=_0x18b1b1(0x12b2),_0x1a5d91[_0x18b1b1(0xaca)][_0x18b1b1(0x702)]=_0x1e681e[_0x18b1b1(0x702)];const _0x5dc9ae=document[_0x18b1b1(0x383)](_0x18b1b1(0x1285));return _0x5dc9ae[_0x18b1b1(0x3db)]='message-bubble\x20recalled-message-placeholder',_0x5dc9ae['dataset'][_0x18b1b1(0x702)]=_0x1e681e[_0x18b1b1(0x702)],_0x5dc9ae[_0x18b1b1(0x300)]=_0x1e681e[_0x18b1b1(0x9a5)],_0x1a5d91[_0x18b1b1(0x120c)](_0x5dc9ae),_0xcb6204(_0x1a5d91,()=>_0x5d9dfb(_0x1e681e['timestamp'])),_0x1a5d91[_0x18b1b1(0x4b8)](_0x18b1b1(0x1041),()=>{const _0x1e2adb=_0x18b1b1;_0x56fc05&&_0x25cb91(_0x1e681e[_0x1e2adb(0x702)]);}),_0x1a5d91;}else{if(_0x1e681e[_0x18b1b1(0xa20)]==='post_deleted_notice'){const _0x26820c=document[_0x18b1b1(0x383)](_0x18b1b1(0x1285));_0x26820c[_0x18b1b1(0x3db)]=_0x18b1b1(0x12b2),_0x26820c['dataset']['timestamp']=_0x1e681e[_0x18b1b1(0x702)];const _0x1c8840=document[_0x18b1b1(0x383)]('div');return _0x1c8840['className']=_0x18b1b1(0x1e4),_0x1c8840[_0x18b1b1(0xaca)]['postId']=_0x1e681e[_0x18b1b1(0x2f0)],_0x1c8840[_0x18b1b1(0x300)]=_0x1e681e[_0x18b1b1(0x9a5)],_0x26820c[_0x18b1b1(0x120c)](_0x1c8840),_0xcb6204(_0x26820c,()=>_0x5d9dfb(_0x1e681e[_0x18b1b1(0x702)])),_0x26820c[_0x18b1b1(0x4b8)](_0x18b1b1(0x1041),()=>{const _0x15ec19=_0x18b1b1;_0x56fc05&&_0x25cb91(_0x1e681e[_0x15ec19(0x702)]);}),_0x26820c;}}if(_0x1e681e[_0x18b1b1(0xbf5)])return null;if(_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0x8ee)){const _0x8d21d2=document[_0x18b1b1(0x383)](_0x18b1b1(0x1285));_0x8d21d2[_0x18b1b1(0x3db)]=_0x18b1b1(0x12b2);const _0x3121e7=document['createElement'](_0x18b1b1(0x1285));return _0x3121e7['className']=_0x18b1b1(0xf42),_0x3121e7[_0x18b1b1(0xaca)]['timestamp']=_0x1e681e[_0x18b1b1(0x702)],_0x3121e7['textContent']=_0x1e681e[_0x18b1b1(0x9a5)],_0x8d21d2['appendChild'](_0x3121e7),_0xcb6204(_0x8d21d2,()=>_0x5d9dfb(_0x1e681e[_0x18b1b1(0x702)])),_0x8d21d2['addEventListener'](_0x18b1b1(0x1041),()=>{if(_0x56fc05)_0x25cb91(_0x1e681e['timestamp']);}),_0x8d21d2;}const _0x30d4cb=_0x1e681e[_0x18b1b1(0xba4)]===_0x18b1b1(0x21c),_0x2530cf=_0x194ff4[_0x18b1b1(0x761)][_0x18b1b1(0xca7)]||'我',_0xea5169=document[_0x18b1b1(0x383)](_0x18b1b1(0x1285));_0xea5169['className']=_0x18b1b1(0xbe9)+(_0x30d4cb?_0x18b1b1(0x21c):'ai');if(_0x194ff4['isGroup']&&!_0x30d4cb){const _0xd7d5f3=_0x194ff4[_0x18b1b1(0x2b3)][_0x18b1b1(0xe79)](_0x2b4c6a=>_0x2b4c6a['originalName']===_0x1e681e['senderName']),_0x3c3ff9=document['createElement']('div');_0x3c3ff9['className']='sender-name',_0x3c3ff9[_0x18b1b1(0x300)]=_0xd7d5f3?_0xd7d5f3[_0x18b1b1(0xc8f)]:_0x1e681e[_0x18b1b1(0x768)]||_0x18b1b1(0x8d2),_0xea5169[_0x18b1b1(0x120c)](_0x3c3ff9);}const _0x2dd7bf=document['createElement'](_0x18b1b1(0x1285));_0x2dd7bf[_0x18b1b1(0x3db)]=_0x18b1b1(0xc3)+(_0x30d4cb?'user':'ai'),_0x2dd7bf[_0x18b1b1(0xaca)][_0x18b1b1(0x702)]=_0x1e681e[_0x18b1b1(0x702)];const _0x420fc3=document[_0x18b1b1(0x383)](_0x18b1b1(0x436));_0x420fc3['className']=_0x18b1b1(0x702),_0x420fc3[_0x18b1b1(0x300)]=_0x44b062(_0x1e681e[_0x18b1b1(0x702)]);let _0xb75dc9,_0x5e5d6d='';if(_0x30d4cb)_0xb75dc9=_0x194ff4[_0x18b1b1(0x761)][_0x18b1b1(0xc43)]||(_0x194ff4[_0x18b1b1(0x1244)]?_0x30449f:_0x3d2e44),_0x5e5d6d=_0x194ff4[_0x18b1b1(0x761)][_0x18b1b1(0x11ed)]||'';else{if(_0x194ff4[_0x18b1b1(0x1244)]){const _0x2bb5b6=_0x194ff4[_0x18b1b1(0x2b3)][_0x18b1b1(0xe79)](_0x4838ed=>_0x4838ed[_0x18b1b1(0x697)]===_0x1e681e[_0x18b1b1(0x768)]);if(_0x2bb5b6){const _0x3db3bd=_0x5de8b7[_0x18b1b1(0x737)][_0x2bb5b6['id']];_0xb75dc9=_0x2bb5b6['avatar']||(_0x3db3bd?_0x3db3bd[_0x18b1b1(0x761)][_0x18b1b1(0x5e0)]:_0x4d9574),_0x5e5d6d=_0x2bb5b6[_0x18b1b1(0x306)]||(_0x3db3bd?_0x3db3bd['settings'][_0x18b1b1(0x1268)]:'');}else _0xb75dc9=_0x4d9574,_0x5e5d6d='';}else _0xb75dc9=_0x194ff4[_0x18b1b1(0x761)]['aiAvatar']||_0x3d2e44,_0x5e5d6d=_0x194ff4[_0x18b1b1(0x761)][_0x18b1b1(0x1268)]||'';}let _0xa92c9;_0x5e5d6d?_0xa92c9=_0x18b1b1(0x220)+_0xb75dc9+_0x18b1b1(0x770)+_0x5e5d6d+_0x18b1b1(0x95a):_0xa92c9='<img\x20src=\x22'+_0xb75dc9+_0x18b1b1(0x457);const _0x1b0840=_0x5e5d6d?_0x18b1b1(0x2b7):'',_0x2f9cc3='<div\x20class=\x22avatar-group\x20'+_0x1b0840+'\x22>'+_0xa92c9+_0x18b1b1(0xc5c);let _0x1d7a1d,_0x168547='';if(_0x1e681e[_0x18b1b1(0xb9)]){const _0x35c2e9=_0xd9d60a(_0x194ff4,_0x1e681e[_0x18b1b1(0xb9)][_0x18b1b1(0x768)]),_0x506c13=String(_0x1e681e['quote']['content']||'');_0x168547='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22'+_0x1e681e[_0x18b1b1(0xb9)][_0x18b1b1(0x702)]+_0x18b1b1(0x6c5)+_0x35c2e9+_0x18b1b1(0x6ec)+_0x506c13+_0x18b1b1(0x68b);}let _0x529025=_0x1e681e[_0x18b1b1(0x9a5)];if(typeof _0x529025===_0x18b1b1(0x10d7)&&_0x529025[_0x18b1b1(0xeb7)]()[_0x18b1b1(0xb6c)]('<')&&_0x529025['trim']()[_0x18b1b1(0x771)]('>'))_0x1d7a1d=_0x529025,_0x2dd7bf[_0x18b1b1(0x505)][_0x18b1b1(0x252)]('is-raw-html');else{if(_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0xd71)||_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0x67b)||_0x1e681e['type']===_0x18b1b1(0x5e8)||_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0x104)||_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0xd02)||_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0xeb)||_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0x719)||_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0x82b)||_0x1e681e['type']===_0x18b1b1(0x123b)||_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0x57b)||_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0x305)||_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0xcc5)||_0x1e681e['type']===_0x18b1b1(0xf9e)||_0x1e681e[_0x18b1b1(0xa20)]==='realimag'||_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0xcb1)){if(_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0xd71)){const _0x2a83ac=_0x1e681e['content']||((_0x1e681e['dialogue']||'')+'\x20'+(_0x1e681e[_0x18b1b1(0x1029)]||''))[_0x18b1b1(0xeb7)](),_0x2a9897=/(「.*?」|“.*?”)/g,_0x58dda2=_0x2a83ac['split'](_0x2a9897)[_0x18b1b1(0x138)](_0x4075c4=>_0x4075c4);_0x1d7a1d=_0x58dda2[_0x18b1b1(0x796)](_0x2803f5=>{const _0x19b86a=_0x18b1b1;return _0x2803f5['startsWith']('「')||_0x2803f5[_0x19b86a(0xb6c)]('“')?_0x19b86a(0x268)+_0x5a9a9e(_0x2803f5)+'</span>':_0x19b86a(0x591)+_0x5a9a9e(_0x2803f5[_0x19b86a(0xeb7)]())[_0x19b86a(0x1018)](/\n/g,_0x19b86a(0xf70))+_0x19b86a(0x4a3);})[_0x18b1b1(0xa4b)]('');}else{if(_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0x67b))_0x2dd7bf[_0x18b1b1(0x505)]['add']('is-link-share','is-card-like'),_0x1d7a1d='<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22'+_0x1e681e[_0x18b1b1(0x702)]+_0x18b1b1(0x1283)+(_0x1e681e[_0x18b1b1(0x740)]||_0x18b1b1(0x491))+'</div><div\x20class=\x22description\x22>'+(_0x1e681e['description']||_0x18b1b1(0x45c))+_0x18b1b1(0x757)+(_0x1e681e[_0x18b1b1(0x101b)]||'链接分享')+_0x18b1b1(0x89e);else{if(_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0x5e8))_0x2dd7bf[_0x18b1b1(0x505)][_0x18b1b1(0x252)](_0x18b1b1(0x5be),'is-card-like'),_0x1d7a1d=_0x18b1b1(0x127f)+_0x1e681e[_0x18b1b1(0x702)]+_0x18b1b1(0x1283)+_0x1e681e[_0x18b1b1(0x287)][_0x18b1b1(0x740)]+'</div><div\x20class=\x22description\x22>共\x20'+_0x1e681e[_0x18b1b1(0x287)][_0x18b1b1(0x7bc)][_0x18b1b1(0x594)]+_0x18b1b1(0xeb0);else{if(_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0x104)){_0x2dd7bf['classList']['add'](_0x18b1b1(0x3ca),_0x18b1b1(0xcfb));let _0x8e1b03;if(_0x1e681e[_0x18b1b1(0xf44)])_0x8e1b03=_0x1e681e[_0x18b1b1(0xf44)];else _0x5de8b7[_0x18b1b1(0x2df)][_0x18b1b1(0xbd4)]&&_0x1e681e['image_prompt']?_0x8e1b03='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x1e681e[_0x18b1b1(0xee6)]):_0x8e1b03=_0x18b1b1(0xaa5);const _0xdda65a='style=\x22background-image:\x20url(\x27'+_0x8e1b03+_0x18b1b1(0x651);_0x1d7a1d=_0x18b1b1(0x12b8)+_0x1e681e[_0x18b1b1(0x9a5)]+_0x18b1b1(0xba5)+_0xdda65a+'><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>';}else{if(_0x1e681e['type']===_0x18b1b1(0xeb)||_0x1e681e['type']===_0x18b1b1(0xd02)){_0x2dd7bf[_0x18b1b1(0x505)]['add'](_0x18b1b1(0xa36),_0x18b1b1(0xcfb));const _0xb3a89d=_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0xeb)?'用户描述的照片':_0x18b1b1(0x3f7),_0x432a3f=_0x5de8b7[_0x18b1b1(0x2df)][_0x18b1b1(0xbd4)]&&_0x1e681e[_0x18b1b1(0xee6)]?'https://image.pollinations.ai/prompt/'+_0x1e681e['image_prompt']:_0x18b1b1(0x23b);_0x1d7a1d=_0x18b1b1(0x13b)+_0x432a3f+_0x18b1b1(0xa44)+_0xb3a89d+'\x22\x20data-description=\x22'+_0x1e681e['content']+'\x22>';}else{if(_0x1e681e['type']==='naiimag')_0x2dd7bf['classList'][_0x18b1b1(0x252)](_0x18b1b1(0xae8),_0x18b1b1(0xcfb)),_0x1d7a1d='<img\x20src=\x22'+_0x1e681e[_0x18b1b1(0xf44)]+_0x18b1b1(0x8fb)+(_0x1e681e[_0x18b1b1(0xfc8)]||_0x1e681e['prompt']||_0x18b1b1(0x520))+'\x22>';else{if(_0x1e681e[_0x18b1b1(0xa20)]==='voice_message'){_0x2dd7bf['classList'][_0x18b1b1(0x252)](_0x18b1b1(0x1150),_0x18b1b1(0xcfb));const _0x259b29=Math['max'](0x1,Math[_0x18b1b1(0xe0)]((_0x1e681e['content']||'')[_0x18b1b1(0x594)]/0x5)),_0x548b0b='0:'+String(_0x259b29)[_0x18b1b1(0xae4)](0x2,'0')+'\x27\x27',_0x9da6b1=_0x18b1b1(0x3bd);if(_0x30d4cb)_0x1d7a1d=_0x18b1b1(0xc4e)+encodeURIComponent(_0x1e681e[_0x18b1b1(0x9a5)])+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>'+_0x9da6b1+_0x18b1b1(0x104c)+_0x548b0b+_0x18b1b1(0xaf8);else{const _0x58533b=!_0x194ff4[_0x18b1b1(0x1244)]&&_0x194ff4['settings'][_0x18b1b1(0x444)]!==![],_0x400b9f=_0x194ff4[_0x18b1b1(0x761)][_0x18b1b1(0xa72)]||'female-shaonv-jingpin',_0x2371db=_0x58533b?'data-voice-id=\x22'+_0x400b9f+'\x22':'';_0x1d7a1d=_0x18b1b1(0xc4e)+encodeURIComponent(_0x1e681e['content'])+'\x22\x20'+_0x2371db+_0x18b1b1(0x4b5)+_0x9da6b1+_0x18b1b1(0x11d5)+_0x548b0b+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}else{if(_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0x82b)){_0x2dd7bf[_0x18b1b1(0x505)][_0x18b1b1(0x252)](_0x18b1b1(0x10f9),_0x18b1b1(0xcfb));let _0x3193c8,_0x4a9c80;const _0x54408d=_0x194ff4[_0x18b1b1(0x1244)]?_0x194ff4[_0x18b1b1(0x761)]['myNickname']||'我':'我',_0x4875e6=_0xd9d60a(_0x194ff4,_0x1e681e[_0x18b1b1(0x768)]),_0x3820c6=_0xd9d60a(_0x194ff4,_0x1e681e['receiverName']||_0x194ff4[_0x18b1b1(0x278)]);if(_0x30d4cb){if(_0x1e681e[_0x18b1b1(0x75b)])_0x3193c8=_0x18b1b1(0x447)+_0x3820c6,_0x4a9c80='已拒收对方转账';else{_0x3193c8=_0x18b1b1(0x31e)+_0x3820c6;if(_0x1e681e[_0x18b1b1(0x739)]===_0x18b1b1(0x9db))_0x4a9c80=_0x18b1b1(0x1062);else{if(_0x1e681e[_0x18b1b1(0x739)]===_0x18b1b1(0x3e1))_0x4a9c80=_0x18b1b1(0x262);else _0x4a9c80=_0x1e681e[_0x18b1b1(0x1213)]||_0x18b1b1(0x929);}}}else{if(_0x1e681e[_0x18b1b1(0x75b)])_0x3193c8=_0x18b1b1(0x57c)+_0x4875e6,_0x4a9c80=_0x18b1b1(0x9f1);else{if(_0x1e681e['receiverName']===_0x54408d){_0x3193c8=_0x18b1b1(0x31e)+_0x54408d;if(_0x1e681e[_0x18b1b1(0x739)]===_0x18b1b1(0x9db))_0x4a9c80=_0x18b1b1(0x1280);else{if(_0x1e681e['status']===_0x18b1b1(0x3e1))_0x4a9c80='你已拒收';else _0x2dd7bf[_0x18b1b1(0x794)][_0x18b1b1(0x4d0)]='pointer',_0x2dd7bf[_0x18b1b1(0xaca)][_0x18b1b1(0x739)]=_0x18b1b1(0x5d2),_0x4a9c80=_0x1e681e['note']||_0x18b1b1(0x238);}}else _0x3193c8=_0x18b1b1(0x115c)+_0x4875e6+'\x20→\x20'+_0x3820c6,_0x4a9c80=_0x1e681e[_0x18b1b1(0x1213)]||_0x18b1b1(0x153);}}const _0x3d07c5=_0x18b1b1(0x195);_0x1d7a1d=_0x18b1b1(0x186)+_0x3d07c5+'\x20'+_0x3193c8+'</div><div\x20class=\x22transfer-amount\x22>¥\x20'+Number(_0x1e681e[_0x18b1b1(0x354)])[_0x18b1b1(0x200)](0x2)+'</div><div\x20class=\x22transfer-note\x22>'+_0x4a9c80+'</div></div>';}else{if(_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0x123b)){_0x2dd7bf['classList'][_0x18b1b1(0x252)](_0x18b1b1(0x968),_0x18b1b1(0xcfb));if(_0x1e681e[_0x18b1b1(0x739)]===_0x18b1b1(0xa42)||_0x1e681e[_0x18b1b1(0x739)]==='rejected')_0x2dd7bf[_0x18b1b1(0x505)][_0x18b1b1(0x252)](_0x18b1b1(0x11fc)+_0x1e681e[_0x18b1b1(0x739)]);const _0x476e2b=_0xd9d60a(_0x194ff4,_0x1e681e[_0x18b1b1(0x768)]),_0x98f9fd=_0x18b1b1(0x1046)+_0x476e2b+'\x20的代付请求';let _0x73c577='';_0x1e681e['status']==='pending'&&!_0x30d4cb&&(_0x73c577=_0x18b1b1(0x684)),_0x1d7a1d=_0x18b1b1(0x10ef)+_0x98f9fd+'</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥'+Number(_0x1e681e[_0x18b1b1(0x354)])[_0x18b1b1(0x200)](0x2)+_0x18b1b1(0x889)+_0x1e681e[_0x18b1b1(0x702)]+_0x18b1b1(0x8e5)+_0x73c577+_0x18b1b1(0xc5c),setTimeout(()=>{const _0x4503cb=_0x18b1b1;if(_0x1e681e['status']==='pending'){const _0x196f40=document[_0x4503cb(0x11e3)](_0x4503cb(0x17d)+_0x1e681e[_0x4503cb(0x702)]);if(_0x196f40){const _0xc3653c=_0x51cf5d(_0x196f40,_0x1e681e[_0x4503cb(0x118a)]);_0x2c1bf7[_0x1e681e['timestamp']]=_0xc3653c;}}},0x0);}else{if(_0x1e681e[_0x18b1b1(0xa20)]===_0x18b1b1(0x57b)){_0x2dd7bf[_0x18b1b1(0x505)][_0x18b1b1(0x252)](_0x18b1b1(0x968),_0x18b1b1(0xcfb));const _0x3a6966=_0xd9d60a(_0x194ff4,_0x1e681e['senderName']);let _0x53c58d='你';_0x194ff4[_0x18b1b1(0x1244)]&&(_0x53c58d=_0xd9d60a(_0x194ff4,_0x1e681e['recipientName'])),_0x1d7a1d='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>'+_0x3a6966+_0x18b1b1(0x24a)+_0x53c58d+_0x18b1b1(0xec)+_0x1e681e[_0x18b1b1(0x1253)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥'+Number(_0x1e681e[_0x18b1b1(0x354)])[_0x18b1b1(0x200)](0x2)+_0x18b1b1(0xbfd);}else{if(_0x1e681e[_0x18b1b1(0xa20)]==='red_packet'){_0x2dd7bf[_0x18b1b1(0x505)][_0x18b1b1(0x252)](_0x18b1b1(0xfe4),_0x18b1b1(0xcfb));const _0x481cf5=_0x5de8b7['qzoneSettings'][_0x18b1b1(0xa33)]||'{{user}}',_0x5f1f06=_0x1e681e[_0x18b1b1(0x5e7)],_0x253132=_0x1e681e[_0x18b1b1(0xcf6)]&&_0x1e681e[_0x18b1b1(0xcf6)][_0x481cf5];let _0x22fd05='',_0x1e0e02='',_0x4a5ea1=_0x18b1b1(0x838);_0x5f1f06&&(_0x22fd05=_0x18b1b1(0x8d6));if(_0x1e681e[_0x18b1b1(0xc3d)]===_0x18b1b1(0x978)){const _0x1eb4d5=_0xd9d60a(_0x194ff4,_0x1e681e[_0x18b1b1(0x1045)]);_0x4a5ea1=_0x18b1b1(0xa57)+_0x1eb4d5;if(Object[_0x18b1b1(0xb4a)](_0x1e681e[_0x18b1b1(0xcf6)]||{})[_0x18b1b1(0x594)]>0x0)_0x22fd05='opened';}if(_0x253132){const _0x4efaba=_0x1e681e[_0x18b1b1(0xcf6)][_0x481cf5]||0x0;_0x1e0e02=_0x18b1b1(0xc63)+_0x4efaba[_0x18b1b1(0x200)](0x2)+_0x18b1b1(0x7ee);}else{if(_0x5f1f06)_0x1e0e02=_0x18b1b1(0xcd1);else{if(_0x1e681e[_0x18b1b1(0xc3d)]==='direct'&&Object[_0x18b1b1(0xb4a)](_0x1e681e['claimedBy']||{})[_0x18b1b1(0x594)]>0x0){const _0x2ec2fa=_0xd9d60a(_0x194ff4,_0x1e681e['receiverName']);_0x1e0e02=_0x18b1b1(0x31d)+_0x2ec2fa+'\x20领取</div>';}}}_0x1d7a1d=_0x18b1b1(0x88c)+_0x22fd05+'\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>'+(_0x1e681e[_0x18b1b1(0x11f1)]||_0x18b1b1(0xb10))+_0x18b1b1(0xdc2)+_0x4a5ea1+'</div>'+_0x1e0e02+_0x18b1b1(0xc5c);}else{if(_0x1e681e[_0x18b1b1(0xa20)]==='poll'){_0x2dd7bf[_0x18b1b1(0x505)][_0x18b1b1(0x252)]('is-poll',_0x18b1b1(0xcfb));const _0x479e47=_0x1e681e[_0x18b1b1(0xdb5)]||_0x1e681e[_0x18b1b1(0x9a5)]||_0x18b1b1(0x10f7);let _0x4ccc2e=0x0;const _0xe1250d={};for(const _0x2955a0 in _0x1e681e[_0x18b1b1(0x510)]){const _0x399776=_0x1e681e[_0x18b1b1(0x510)][_0x2955a0][_0x18b1b1(0x594)];_0xe1250d[_0x2955a0]=_0x399776,_0x4ccc2e+=_0x399776;}const _0x4f6909=_0x5de8b7[_0x18b1b1(0x1c5)]['nickname']||'{{user}}';let _0x12452e=null;for(const _0x1eadd7 in _0x1e681e[_0x18b1b1(0x510)]){if(_0x1e681e['votes'][_0x1eadd7][_0x18b1b1(0x3ad)](_0x4f6909)){_0x12452e=_0x1eadd7;break;}}let _0x3baf29=_0x18b1b1(0x665);_0x1e681e[_0x18b1b1(0x11a1)][_0x18b1b1(0x494)](_0x70632=>{const _0x1ac021=_0x18b1b1,_0x146afd=_0xe1250d[_0x70632]||0x0,_0x2c7fca=_0x4ccc2e>0x0?_0x146afd/_0x4ccc2e*0x64:0x0,_0x3e4939=_0x12452e===_0x70632;_0x3baf29+=_0x1ac021(0x11da)+(_0x3e4939?_0x1ac021(0xe3e):'')+_0x1ac021(0x8cf)+_0x70632+_0x1ac021(0xd1)+_0x2c7fca+_0x1ac021(0xbd2)+_0x70632+_0x1ac021(0x1c6)+_0x146afd+'\x20票</span></div></div>';}),_0x3baf29+='</div>';let _0x819cb6=_0x1e681e[_0x18b1b1(0xdf0)]?_0x18b1b1(0x12af)+_0x4ccc2e+_0x18b1b1(0xab3):_0x18b1b1(0x12af)+_0x4ccc2e+_0x18b1b1(0xd47);_0x1d7a1d=_0x18b1b1(0x7d8)+(_0x1e681e[_0x18b1b1(0xdf0)]?_0x18b1b1(0x1ed):'')+'\x22\x20data-poll-timestamp=\x22'+_0x1e681e['timestamp']+_0x18b1b1(0x2d0)+_0x479e47+_0x18b1b1(0xc5c)+_0x3baf29+_0x819cb6+_0x18b1b1(0xc5c);}else{if(_0x1e681e[_0x18b1b1(0xa20)]==='gift'){_0x2dd7bf[_0x18b1b1(0x505)][_0x18b1b1(0x252)](_0x18b1b1(0x473),_0x18b1b1(0xcfb));let _0x5785e4;const _0x4b368a=_0x194ff4['settings']['myNickname']||'我';if(_0x194ff4[_0x18b1b1(0x1244)]){if(_0x1e681e[_0x18b1b1(0xfae)]&&_0x1e681e[_0x18b1b1(0xfae)][_0x18b1b1(0x594)]>0x0){const _0x3df1b6=_0x1e681e[_0x18b1b1(0xfae)]['map'](_0x26bd3a=>_0xd9d60a(_0x194ff4,_0x26bd3a));_0x3df1b6[_0x18b1b1(0x594)]===0x1?_0x5785e4=_0x18b1b1(0x5b6)+_0x3df1b6[0x0]+_0x18b1b1(0x671):_0x5785e4=_0x18b1b1(0x5b6)+_0x3df1b6[_0x18b1b1(0xa6c)](0x0,0x2)[_0x18b1b1(0xa4b)]('、')+_0x18b1b1(0xd60);}else _0x5785e4=_0x18b1b1(0x1b2);}else{if(_0x30d4cb)_0x5785e4=_0x18b1b1(0x5b6)+_0x194ff4['name']+'\x20的礼物';else{const _0x45f407=_0x194ff4[_0x18b1b1(0x761)][_0x18b1b1(0xca7)]||'你';_0x5785e4=_0x18b1b1(0x5b6)+_0x45f407+_0x18b1b1(0x671);}}const _0x4e91f7=_0x1e681e[_0x18b1b1(0x1292)][_0x18b1b1(0xa6c)](0x0,0x3);let _0x41dc25='';_0x4e91f7['forEach'](_0x271a0a=>{const _0x32feea=_0x18b1b1;_0x41dc25+=_0x32feea(0x11e6)+_0x271a0a['imageUrl']+_0x32feea(0x916)+_0x271a0a[_0x32feea(0x278)]+'</span><span\x20class=\x22gift-preview-quantity\x22>x'+_0x271a0a[_0x32feea(0x108a)]+_0x32feea(0x1a8);});let _0x345c03='';_0x1e681e['items']['length']>0x3&&(_0x345c03='\x20等'+_0x1e681e[_0x18b1b1(0x1292)][_0x18b1b1(0x594)]+_0x18b1b1(0x205)),_0x1d7a1d=_0x18b1b1(0x81a)+_0x5785e4+_0x18b1b1(0x125a)+_0x41dc25+_0x18b1b1(0x2fd)+_0x1e681e['items']['length']+'件商品'+_0x345c03+_0x18b1b1(0x4ac);}}}}}}}}}}}}}}else{const _0x39e07b=String(_0x529025);let _0x25596d=await _0x5109d0(_0x39e07b,_0x194ff4['id']);if(_0x25596d!==_0x39e07b)_0x1d7a1d=_0x25596d,_0x2dd7bf['classList'][_0x18b1b1(0x252)]('is-card-like');else{if(Array[_0x18b1b1(0xb7b)](_0x1e681e[_0x18b1b1(0x9a5)])&&_0x1e681e[_0x18b1b1(0x9a5)][0x0]?.[_0x18b1b1(0xa20)]===_0x18b1b1(0x488)){const _0x4ac6f0=_0x1e681e[_0x18b1b1(0x9a5)][0x0][_0x18b1b1(0x488)]['url'];_0x1d7a1d='<img\x20src=\x22'+_0x4ac6f0+'\x22\x20class=\x22chat-image\x22>';}else{if(_0x9f9ac4['test'](_0x25596d))_0x2dd7bf[_0x18b1b1(0x505)][_0x18b1b1(0x252)](_0x18b1b1(0xb8e),_0x18b1b1(0xcfb)),_0x1d7a1d='<img\x20src=\x22'+_0x25596d+'\x22\x20alt=\x22'+(_0x1e681e[_0x18b1b1(0xb36)]||'Sticker')+'\x22\x20class=\x22sticker-image\x22>';else{let _0x2af754=_0x33faa3(_0x25596d,_0x194ff4);_0x1d7a1d=_0x5a9a9e(_0x2af754)[_0x18b1b1(0x1018)](/\n/g,_0x18b1b1(0xf70));}}}}}_0x2dd7bf[_0x18b1b1(0x595)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2f9cc3+_0x18b1b1(0x26a)+_0x168547+_0x18b1b1(0xfe0)+_0x1d7a1d+_0x18b1b1(0x56b),_0xea5169['appendChild'](_0x2dd7bf),_0xea5169['appendChild'](_0x420fc3),_0xcb6204(_0xea5169,()=>_0x5d9dfb(_0x1e681e[_0x18b1b1(0x702)])),_0xea5169['addEventListener'](_0x18b1b1(0x1041),()=>{if(_0x56fc05)_0x25cb91(_0x1e681e['timestamp']);});if(!_0x30d4cb){const _0x422a0a=_0xea5169[_0x18b1b1(0x5ac)](_0x18b1b1(0x109f));_0x422a0a&&(_0x422a0a[_0x18b1b1(0x794)][_0x18b1b1(0x4d0)]=_0x18b1b1(0xc48),!_0x194ff4[_0x18b1b1(0x1244)]?_0x422a0a[_0x18b1b1(0x4b8)](_0x18b1b1(0x1041),_0x1d7d56=>{const _0x4953d7=_0x18b1b1;_0x1d7d56[_0x4953d7(0x7cb)](),_0x3cc2f9(_0x194ff4['id']);}):_0x422a0a[_0x18b1b1(0x4b8)](_0x18b1b1(0xef8),_0x43a5b5=>{const _0x2d30af=_0x18b1b1;_0x43a5b5[_0x2d30af(0x7cb)](),_0x5be23d(_0x194ff4['id'],_0x1e681e[_0x2d30af(0x768)]);}));}return _0xea5169;}async function _0x42a76d(_0x3f4d78,_0x11299c){const _0x5f1e01=_0x241b18,_0x452103=document[_0x5f1e01(0x11e3)]('chat-messages'),_0x231e0b=await _0xe99b75(_0x3f4d78,_0x11299c);if(!_0x231e0b)return;const _0x209f6a=document['getElementById'](_0x5f1e01(0x1308));_0x209f6a?_0x452103[_0x5f1e01(0xc1)](_0x231e0b,_0x209f6a[_0x5f1e01(0x40d)]):_0x452103[_0x5f1e01(0xf61)](_0x231e0b);}async function _0x3b5153(_0x3f7c93,_0x3589ab,_0x311e72=![]){const _0x3f8bdf=_0x241b18,_0x4aafbf=document[_0x3f8bdf(0x11e3)](_0x3f8bdf(0xc9d)),_0x20286a=document['getElementById']('typing-indicator'),_0x3fcce1=_0x3589ab[_0x3f8bdf(0x49e)]['filter'](_0x241230=>!_0x241230[_0x3f8bdf(0xbf5)])['pop']();if(_0x3fcce1&&_0x3f7c93['timestamp']-_0x3fcce1['timestamp']>0x927c0){const _0x56a8b2=_0x4cf713(_0x3f7c93[_0x3f8bdf(0x702)]);_0x4aafbf[_0x3f8bdf(0xc1)](_0x56a8b2,_0x20286a);}const _0x5066cb=await _0xe99b75(_0x3f7c93,_0x3589ab);if(!_0x5066cb)return;_0x3f7c93[_0x3f8bdf(0xba4)]===_0x3f8bdf(0x1119)&&!_0x311e72&&_0x387f1d(),!_0x311e72&&_0x5066cb[_0x3f8bdf(0x505)][_0x3f8bdf(0x252)](_0x3f8bdf(0xdf3)),_0x4aafbf['insertBefore'](_0x5066cb,_0x20286a),!_0x311e72&&(_0x4aafbf['scrollTop']=_0x4aafbf['scrollHeight'],_0xd53d57++);}async function _0x6cac66(_0x19aff0){const _0x118a5b=_0x241b18;_0x5de8b7[_0x118a5b(0x93d)]=_0x19aff0;const _0x5a35ae=_0x5de8b7[_0x118a5b(0x737)][_0x19aff0];if(!_0x5a35ae)return;_0x5a35ae[_0x118a5b(0xc3a)]>0x0&&(_0x5a35ae[_0x118a5b(0xc3a)]=0x0,await _0x2e83f8['chats'][_0x118a5b(0xe3c)](_0x5a35ae));_0x30d472(_0x5a35ae),_0x544ab5(_0x19aff0),_0x4e7698(_0x118a5b(0x9fc)),window[_0x118a5b(0xe9e)](_0x5de8b7['activeChatId']);const _0x16922c=_0x5a35ae[_0x118a5b(0x1244)]||![];_0x29bcbe(_0x16922c),document[_0x118a5b(0x11e3)]('show-announcement-board-btn')['style'][_0x118a5b(0x33d)]=_0x16922c?_0x118a5b(0x10f4):_0x118a5b(0x379);const _0x2ff173=document['getElementById'](_0x118a5b(0xc76));_0x2ff173&&(_0x2ff173[_0x118a5b(0x794)][_0x118a5b(0x33d)]=_0x16922c?_0x118a5b(0x379):_0x118a5b(0x10f4));const _0x1836a5=document[_0x118a5b(0x11e3)](_0x118a5b(0x1281)),_0x2dd5d7=document[_0x118a5b(0x11e3)](_0x118a5b(0x765)),_0x2388d2=document[_0x118a5b(0x11e3)](_0x118a5b(0x29c)),_0x1c2f58=document[_0x118a5b(0x11e3)]('werewolf-game-btn');_0x2dd5d7&&_0x2388d2&&_0x1c2f58&&_0x1836a5&&(_0x2dd5d7[_0x118a5b(0x794)][_0x118a5b(0x33d)]=_0x118a5b(0x10f4),_0x2388d2['style'][_0x118a5b(0x33d)]=_0x16922c?_0x118a5b(0x379):_0x118a5b(0x10f4),_0x1c2f58['style'][_0x118a5b(0x33d)]=_0x16922c?_0x118a5b(0x10f4):'none',_0x1836a5[_0x118a5b(0x794)]['display']=_0x16922c?_0x118a5b(0x379):'flex'),_0x17cf58(),!_0x5a35ae[_0x118a5b(0x1244)]&&_0x5a35ae[_0x118a5b(0xa78)]?.[_0x118a5b(0x739)]===_0x118a5b(0x9f9)&&(console[_0x118a5b(0x84b)]('检测到好友申请待处理状态，为角色\x20\x22'+_0x5a35ae[_0x118a5b(0x278)]+'\x22\x20自动触发AI响应...'),_0x14a9f0()),document[_0x118a5b(0x11e3)](_0x118a5b(0x2bf))[_0x118a5b(0x794)][_0x118a5b(0x33d)]=_0x16922c?_0x118a5b(0x10f4):'none';}function _0x153b71(_0x224077,_0x2f164d){const _0x3176ac=_0x241b18,_0x4529d3=_0x2f164d?_0x3176ac(0x252):_0x3176ac(0x957),_0x3844cf=_0x127ffa=>{const _0x2855a9=_0x3176ac;_0x127ffa&&_0x127ffa[_0x2855a9(0x505)][_0x4529d3](_0x2855a9(0xaa0));},_0x35a00d=document[_0x3176ac(0x5ac)]('.chat-list-item[data-chat-id=\x22'+_0x224077+_0x3176ac(0x593));_0x3844cf(_0x35a00d);const _0xd563b7=document[_0x3176ac(0x10d6)](_0x3176ac(0x425)+_0x224077+'\x22]');_0xd563b7[_0x3176ac(0x494)](_0x3844cf);const _0x2411b1=document[_0x3176ac(0x5ac)](_0x3176ac(0xd27)+_0x224077+'\x22]');_0x3844cf(_0x2411b1);}async function _0x439f24(){const _0x1970a7=_0x241b18;if(!_0x5de8b7[_0x1970a7(0x93d)])return;const _0x216c9a=_0x5de8b7[_0x1970a7(0x93d)],_0x21f906=_0x5de8b7[_0x1970a7(0x737)][_0x216c9a];lastRawAiResponse='',lastResponseTimestamps=[];const _0xf63a53=document['getElementById'](_0x1970a7(0xe6c));_0xf63a53&&(_0xf63a53[_0x1970a7(0xe5c)]=!![],_0xf63a53[_0x1970a7(0x300)]='思考中...');_0x153b71(_0x216c9a,!![]);try{const {proxyUrl:_0x35a368,apiKey:_0x509acc,model:_0x536367}=_0x5de8b7[_0x1970a7(0x89c)];if(!_0x35a368||!_0x509acc||!_0x536367)throw new Error(_0x1970a7(0x7f3));const _0x571bb1=parseInt(_0x21f906[_0x1970a7(0x761)]['maxMemory'])||0xa,_0x32ccf2=_0x21f906['history'][_0x1970a7(0xa6c)](-_0x571bb1);let _0x195017='';if(_0x21f906['settings'][_0x1970a7(0xa17)]&&_0x21f906['settings'][_0x1970a7(0xa17)][_0x1970a7(0x594)]>0x0){const _0xe028dd=_0x21f906[_0x1970a7(0x761)]['linkedWorldBookIds']['map'](_0x294072=>{const _0x5cd7ef=_0x1970a7,_0x11aecf=_0x5de8b7[_0x5cd7ef(0xca)][_0x5cd7ef(0xe79)](_0x3a4972=>_0x3a4972['id']===_0x294072);if(!_0x11aecf||!Array[_0x5cd7ef(0xb7b)](_0x11aecf[_0x5cd7ef(0x9a5)]))return'';const _0x53552c=_0x11aecf[_0x5cd7ef(0x9a5)][_0x5cd7ef(0x138)](_0x49ba97=>_0x49ba97[_0x5cd7ef(0xc34)]!==![])['map'](_0x649263=>{const _0x2dfbe2=_0x5cd7ef;let _0x5addc0=_0x2dfbe2(0xec3)+(_0x649263['comment']||_0x2dfbe2(0x350))+'\x0a';if(_0x649263['keys']['length']>0x0)_0x5addc0+=_0x2dfbe2(0x105b)+_0x649263[_0x2dfbe2(0xb4a)][_0x2dfbe2(0xa4b)](',\x20')+'\x0a';return _0x5addc0+=_0x2dfbe2(0x10f0)+_0x649263[_0x2dfbe2(0x9a5)],_0x5addc0;})[_0x5cd7ef(0xa4b)]('');return _0x53552c?'\x0a\x0a##\x20世界书:\x20'+_0x11aecf[_0x5cd7ef(0x278)]+'\x0a'+_0x53552c:'';})['filter'](Boolean)[_0x1970a7(0xa4b)]('');_0xe028dd&&(_0x195017=_0x1970a7(0xa11)+_0xe028dd+_0x1970a7(0x421));}let _0x179763='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0x1ca959=![];_0x21f906['members']['forEach'](_0x40630b=>{const _0x68b682=_0x1970a7,_0x1dc347=_0x5de8b7['chats'][_0x40630b['id']];_0x1dc347&&_0x1dc347[_0x68b682(0xe21)]&&_0x1dc347[_0x68b682(0xe21)][_0x68b682(0x594)]>0x0&&(_0x179763+=_0x68b682(0xcaf)+_0x40630b[_0x68b682(0xc8f)]+_0x68b682(0x24e),_0x179763+=_0x1dc347['longTermMemory']['map'](_0x33a615=>_0x68b682(0xd12)+_0x497f2b(_0x33a615[_0x68b682(0x702)])+')\x20'+_0x33a615[_0x68b682(0x9a5)])[_0x68b682(0xa4b)]('\x0a'),_0x1ca959=!![]);});!_0x1ca959&&(_0x179763+='-\x20(暂无)');let _0xc34666='';const _0x270b82=_0x21f906['settings'][_0x1970a7(0x37c)]||0xa;if(_0x21f906[_0x1970a7(0x761)][_0x1970a7(0xd1d)]&&_0x21f906[_0x1970a7(0x761)]['linkedMemoryChatIds'][_0x1970a7(0x594)]>0x0){}const _0x3a24c1=_0x21f906[_0x1970a7(0x2b3)][_0x1970a7(0x796)](_0x4b3cd5=>_0x1970a7(0x11c)+_0x4b3cd5[_0x1970a7(0xc8f)]+_0x1970a7(0x83f)+_0x4b3cd5[_0x1970a7(0x697)]+_0x1970a7(0x151)+_0x4b3cd5['persona'])[_0x1970a7(0xa4b)]('\x0a'),_0x8bb795=_0xb76b68(_0x21f906),_0x6bde4=_0x1970a7(0xaad)+_0x21f906['name']+_0x1970a7(0xe7f)+_0x21f906[_0x1970a7(0x278)]+_0x1970a7(0x226)+_0x179763+'\x0a'+_0x195017+'\x0a'+_0xc34666+_0x1970a7(0x579)+_0x32ccf2[_0x1970a7(0x796)](_0x51637e=>_0xd9d60a(_0x21f906,_0x51637e[_0x1970a7(0x768)])+':\x20'+_0x51637e['content'])['join']('\x0a')+'\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a'+_0x3a24c1+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x8bb795+_0x1970a7(0x12e4),_0x3f601c=_0x32ccf2['map'](_0x5881ee=>({'role':_0x1970a7(0x21c),'content':_0xd9d60a(_0x21f906,_0x5881ee[_0x1970a7(0x768)])+':\x20'+_0x5881ee[_0x1970a7(0x9a5)]}));let _0x58aec1=_0x35a368[_0x1970a7(0x3ad)](_0x1970a7(0x323)),_0x237174;if(_0x58aec1){let _0x30fbda=_0x4a90fe(_0x536367,_0x509acc,_0x6bde4,_0x3f601c);_0x237174=await fetch(_0x30fbda['url'],_0x30fbda[_0x1970a7(0x1cc)]);}else _0x237174=await fetch(_0x35a368+_0x1970a7(0x8fd),{'method':'POST','headers':{'Content-Type':_0x1970a7(0x35c),'Authorization':_0x1970a7(0xdaf)+_0x509acc},'body':JSON[_0x1970a7(0x313)]({'model':_0x536367,'messages':[{'role':_0x1970a7(0xf72),'content':_0x6bde4},..._0x3f601c],'temperature':_0x5de8b7[_0x1970a7(0x2df)][_0x1970a7(0xe66)]||0.9})});if(!_0x237174['ok']){const _0x2db37c=await _0x237174[_0x1970a7(0xd7b)]()['catch'](()=>({'error':{'message':_0x237174['statusText']}}));throw new Error(_0x1970a7(0xf8b)+_0x237174[_0x1970a7(0x739)]+_0x1970a7(0x12a2)+(_0x2db37c[_0x1970a7(0x1c1)]?.[_0x1970a7(0x4bc)]||_0x1970a7(0xd87)));}const _0x3c4a95=await _0x237174[_0x1970a7(0xd7b)](),_0x32863d=getGeminiResponseText(_0x3c4a95);lastRawAiResponse=_0x32863d;const _0x5d3fba=_0x30c9b6(_0x32863d);let _0x59bf05=Date[_0x1970a7(0x1182)]();for(const _0x36ec41 of _0x5d3fba){if(!_0x36ec41||!_0x36ec41[_0x1970a7(0xa20)]||!_0x36ec41[_0x1970a7(0x278)])continue;let _0x1f4399=null;const _0xabcd3a=_0x59bf05++;lastResponseTimestamps[_0x1970a7(0xf5)](_0xabcd3a);const _0x309f59={'role':_0x1970a7(0x1119),'senderName':_0x36ec41['name'],'timestamp':_0xabcd3a};switch(_0x36ec41[_0x1970a7(0xa20)]){case'text':_0x1f4399={..._0x309f59,'content':_0x36ec41['content']};break;case _0x1970a7(0x87b):if(_0x36ec41['meaning']){const _0x4ecdd7=_0x5de8b7[_0x1970a7(0xa67)][_0x1970a7(0xe79)](_0x3cd548=>_0x3cd548[_0x1970a7(0x278)]===_0x36ec41['meaning']);_0x4ecdd7?_0x1f4399={..._0x309f59,'type':'sticker','content':_0x4ecdd7[_0x1970a7(0x10ac)],'meaning':_0x4ecdd7['name']}:(console[_0x1970a7(0x6b0)](_0x1970a7(0xec4)+_0x36ec41[_0x1970a7(0xb36)]+'\x22'),_0x1f4399={..._0x309f59,'type':_0x1970a7(0x1197),'content':_0x1970a7(0x119f)+_0x36ec41[_0x1970a7(0xb36)]+']'});}else console['warn'](_0x1970a7(0xdbd),_0x36ec41);break;case _0x1970a7(0xd02):_0x1f4399={..._0x309f59,'type':_0x1970a7(0xd02),'content':_0x36ec41[_0x1970a7(0x1029)],'image_prompt':_0x36ec41[_0x1970a7(0xee6)]};break;case _0x1970a7(0x719):_0x1f4399={..._0x309f59,'type':_0x1970a7(0x719),'content':_0x36ec41[_0x1970a7(0x9a5)]};break;case _0x1970a7(0x229):const _0x3ae5e9=_0x21f906[_0x1970a7(0x49e)]['find'](_0x4a09d1=>_0x4a09d1[_0x1970a7(0x702)]===_0x36ec41[_0x1970a7(0x47a)]);_0x3ae5e9?_0x1f4399={..._0x309f59,'content':_0x36ec41[_0x1970a7(0x8f8)],'quote':{'timestamp':_0x3ae5e9[_0x1970a7(0x702)],'senderName':_0x3ae5e9[_0x1970a7(0x768)],'content':String(_0x3ae5e9[_0x1970a7(0x9a5)]||'')[_0x1970a7(0x8d4)](0x0,0x32)}}:_0x1f4399={..._0x309f59,'content':_0x36ec41[_0x1970a7(0x8f8)]};break;default:console[_0x1970a7(0x6b0)](_0x1970a7(0xf25),_0x36ec41[_0x1970a7(0xa20)]);continue;}_0x1f4399&&(_0x21f906['history'][_0x1970a7(0xf5)](_0x1f4399),_0x3b5153(_0x1f4399,_0x21f906),await new Promise(_0x409f1c=>setTimeout(_0x409f1c,Math[_0x1970a7(0x36d)]()*0x4b0+0x320)));}await _0x2e83f8[_0x1970a7(0x737)]['put'](_0x21f906),_0x5ee219();}catch(_0x14f29d){console['error'](_0x1970a7(0xde1),_0x14f29d),await _0x2fb06(_0x1970a7(0x1177),_0x1970a7(0xa8c)+_0x14f29d[_0x1970a7(0x4bc)]);}finally{_0xf63a53&&(_0xf63a53[_0x1970a7(0xe5c)]=![],_0xf63a53[_0x1970a7(0x300)]=_0x1970a7(0x4e9)),_0x153b71(_0x216c9a,![]);}}async function _0x14a9f0(){const _0x349797=_0x241b18;if(!_0x5de8b7['activeChatId'])return;const _0x2eb2c8=_0x5de8b7[_0x349797(0x93d)],_0x1dc060=_0x5de8b7[_0x349797(0x737)][_0x5de8b7[_0x349797(0x93d)]],_0x4bca2b=document['getElementById'](_0x349797(0x9fc))[_0x349797(0x505)][_0x349797(0x1121)]('active')&&_0x5de8b7['activeChatId']===_0x2eb2c8;_0x153b71(_0x2eb2c8,!![]);const _0x1c79bc=document[_0x349797(0x11e3)](_0x349797(0x1205)),_0x28fd2e=document[_0x349797(0x11e3)](_0x349797(0x5d0)),_0x29934d=document[_0x349797(0x5ac)]('.chat-list-item[data-chat-id=\x22'+_0x2eb2c8+'\x22]'),_0xba9282=_0x29934d?_0x29934d[_0x349797(0x5ac)](_0x349797(0xb80)):null;_0xba9282&&_0xba9282[_0x349797(0x505)][_0x349797(0x252)](_0x349797(0xaa0));_0x1dc060[_0x349797(0x1244)]?_0x28fd2e&&(_0x28fd2e[_0x349797(0x300)]=_0x349797(0x110c),_0x28fd2e[_0x349797(0x794)][_0x349797(0x33d)]=_0x349797(0x11ac)):_0x1c79bc&&(_0x1c79bc[_0x349797(0x794)]['opacity']=0x0,setTimeout(()=>{const _0x235447=_0x349797;_0x1c79bc[_0x235447(0x300)]=_0x235447(0xbe),_0x1c79bc[_0x235447(0x505)][_0x235447(0x252)](_0x235447(0x680)),_0x1c79bc[_0x235447(0x794)]['opacity']=0x1;},0xc8));let _0x32a4a1=![];try{const {proxyUrl:_0x497901,apiKey:_0x51a46c,model:_0x49c757}=_0x5de8b7[_0x349797(0x89c)];if(!_0x497901||!_0x51a46c||!_0x49c757){alert(_0x349797(0x295));if(_0x1dc060[_0x349797(0x1244)]){if(_0x28fd2e)_0x28fd2e[_0x349797(0x794)][_0x349797(0x33d)]=_0x349797(0x379);}else _0x1c79bc&&_0x5de8b7[_0x349797(0x737)][_0x2eb2c8]&&(_0x1c79bc[_0x349797(0x300)]=_0x5de8b7[_0x349797(0x737)][_0x2eb2c8][_0x349797(0x278)],_0x1c79bc[_0x349797(0x505)][_0x349797(0x957)]('typing-status'));return;}const _0x25aa13=_0x1dc060[_0x349797(0x49e)][_0x349797(0xa6c)](-0x1)[0x0],_0x20fb81=_0x25aa13&&_0x25aa13['role']===_0x349797(0xf72)&&_0x25aa13[_0x349797(0x9a5)][_0x349797(0x3ad)](_0x349797(0x105));if(_0x20fb81){console[_0x349797(0x84b)]('检测到视频通话请求，为角色\x20\x22'+_0x1dc060['name']+_0x349797(0x1e1));let _0x398ec6;_0x1dc060['isGroup']?_0x398ec6=_0x349797(0x62f)+_0x1dc060[_0x349797(0x2b3)][_0x349797(0x796)](_0x4c3524=>'-\x20'+_0x4c3524[_0x349797(0xc8f)]+_0x349797(0x734)+_0x4c3524[_0x349797(0x697)]+_0x349797(0x151)+_0x4c3524[_0x349797(0x701)])[_0x349797(0xa4b)]('\x0a')+_0x349797(0xc4f):_0x398ec6='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1dc060[_0x349797(0x761)][_0x349797(0x8d5)]+_0x349797(0x107a);const _0x2039bb=[{'role':_0x349797(0x21c),'content':_0x398ec6}];try{let _0x252d05=_0x4a90fe(_0x49c757,_0x51a46c,_0x398ec6,_0x2039bb),_0x1b7f24=_0x497901===GEMINI_API_URL;const _0x39dce8=_0x1b7f24?await fetch(_0x252d05[_0x349797(0x10ac)],_0x252d05[_0x349797(0x1cc)]):await fetch(_0x497901+'/v1/chat/completions',{'method':_0x349797(0x1128),'headers':{'Content-Type':'application/json','Authorization':_0x349797(0xdaf)+_0x51a46c},'body':JSON['stringify']({'model':_0x49c757,'messages':_0x2039bb,'temperature':0.7})});if(!_0x39dce8['ok'])throw new Error(_0x349797(0xac)+(await _0x39dce8[_0x349797(0xd7b)]())['error'][_0x349797(0x4bc)]);const _0x834efd=await _0x39dce8['json'](),_0x35f50c=getGeminiResponseText(_0x834efd),_0xd2dc4a=_0x30c9b6(_0x35f50c);let _0x25a46b=![];for(const _0x3c76ac of _0xd2dc4a){if(_0x3c76ac[_0x349797(0xa20)]===_0x349797(0xe4b)){_0x46751e[_0x349797(0x1d6)]=![];if(_0x3c76ac['decision']===_0x349797(0x730))_0x3df367();else{const _0x116a3e={'role':_0x349797(0x1119),'content':'对方拒绝了你的视频通话请求。','timestamp':Date['now']()};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x116a3e),await _0x2e83f8[_0x349797(0x737)]['put'](_0x1dc060),_0x4e7698(_0x349797(0x9fc)),_0x544ab5(_0x2eb2c8);}_0x25a46b=!![];break;}if(_0x3c76ac[_0x349797(0xa20)]===_0x349797(0x479)){if(_0x3c76ac['decision']===_0x349797(0xa4b)){const _0x8e7bf=_0x1dc060[_0x349797(0x2b3)][_0x349797(0xe79)](_0x5240dd=>_0x5240dd['originalName']===_0x3c76ac[_0x349797(0x278)]);_0x8e7bf&&!_0x46751e[_0x349797(0x94b)][_0x349797(0xe7c)](_0x3299fe=>_0x3299fe['id']===_0x8e7bf['id'])&&_0x46751e[_0x349797(0x94b)][_0x349797(0xf5)](_0x8e7bf);}_0x25a46b=!![];}}_0x25a46b&&_0x46751e['isGroupCall']&&(_0x46751e['isAwaitingResponse']=![],_0x46751e[_0x349797(0x94b)][_0x349797(0x594)]>0x0?_0x3df367():(_0x46751e={..._0x46751e,'isAwaitingResponse':![],'participants':[]},_0x4e7698(_0x349797(0x9fc)),alert(_0x349797(0xc53))));}catch(_0x500e1c){console[_0x349797(0x1c1)](_0x349797(0x2ad),_0x500e1c);const _0x57874d=_0x1dc060[_0x349797(0x1244)]?_0x1dc060[_0x349797(0x2b3)][_0x349797(0x796)](_0x2a500b=>({'type':_0x349797(0x479),'name':_0x2a500b[_0x349797(0x697)],'decision':_0x349797(0xcb5)})):[{'type':_0x349797(0xe4b),'decision':_0x349797(0x4cb)}];if(_0x1dc060[_0x349797(0x1244)])_0x46751e[_0x349797(0x1d6)]=![],_0x46751e[_0x349797(0x94b)]=[],alert(_0x349797(0xc53)),_0x4e7698(_0x349797(0x9fc));else{const _0x47cce9={'role':_0x349797(0x1119),'content':_0x349797(0x6a8),'timestamp':Date[_0x349797(0x1182)]()};_0x1dc060[_0x349797(0x49e)]['push'](_0x47cce9),await _0x2e83f8[_0x349797(0x737)][_0x349797(0xe3c)](_0x1dc060),_0x4e7698(_0x349797(0x9fc)),_0x544ab5(_0x2eb2c8);}}finally{_0x153b71(_0x2eb2c8,![]);return;}}if(!_0x1dc060[_0x349797(0x1244)]&&_0x1dc060[_0x349797(0xa78)]?.[_0x349797(0x739)]===_0x349797(0x9f9)){console['log'](_0x349797(0x5b5)+_0x1dc060[_0x349797(0x278)]+_0x349797(0xb26));const _0x350a6a=_0x1dc060['history']['filter'](_0x3b4482=>!_0x3b4482[_0x349797(0xbf5)])[_0x349797(0xa6c)](-0xa,-0x5)[_0x349797(0x796)](_0x47da37=>{const _0x1629cb=_0x349797,_0x50a0cd=_0x47da37[_0x1629cb(0xba4)]===_0x1629cb(0x21c)?'用户':_0x1dc060['name'];return _0x50a0cd+':\x20'+String(_0x47da37[_0x1629cb(0x9a5)])[_0x1629cb(0x8d4)](0x0,0x32)+_0x1629cb(0x6cb);})[_0x349797(0xa4b)]('\x0a'),_0x2a85e6=_0x349797(0x127e)+_0x1dc060[_0x349797(0x278)]+_0x349797(0xaa8)+_0x1dc060[_0x349797(0x761)][_0x349797(0x8d5)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“'+_0x1dc060[_0x349797(0xa78)]['applicationReason']+_0x349797(0xdce)+(_0x350a6a||_0x349797(0x5af))+_0x349797(0x776);try{const _0x3d329d=[{'role':_0x349797(0xf72),'content':_0x2a85e6},{'role':_0x349797(0x21c),'content':_0x349797(0xfa)}];let _0x32a914=_0x497901===GEMINI_API_URL,_0xc6caa=_0x4a90fe(_0x49c757,_0x51a46c,_0x2a85e6,[{'role':_0x349797(0x21c),'content':_0x349797(0xfa)}]);const _0x276108=_0x32a914?await fetch(_0xc6caa[_0x349797(0x10ac)],_0xc6caa[_0x349797(0x1cc)]):await fetch(_0x497901+_0x349797(0x8fd),{'method':'POST','headers':{'Content-Type':_0x349797(0x35c),'Authorization':_0x349797(0xdaf)+_0x51a46c},'body':JSON[_0x349797(0x313)]({'model':_0x49c757,'messages':_0x3d329d,'temperature':_0x5de8b7[_0x349797(0x2df)][_0x349797(0xe66)]||0.8})});if(!_0x276108['ok'])throw new Error(_0x349797(0xac)+(await _0x276108[_0x349797(0xd7b)]())[_0x349797(0x1c1)][_0x349797(0x4bc)]);const _0x170c60=await _0x276108['json'](),_0x5dc1a5=getGeminiResponseText(_0x170c60)[_0x349797(0x1018)](/^```json\s*/,'')[_0x349797(0x1018)](/```$/,'')['trim'](),_0x859dd4=JSON[_0x349797(0xb0c)](_0x5dc1a5);if(_0x859dd4[_0x349797(0xf98)]===_0x349797(0x730)){_0x1dc060[_0x349797(0xa78)][_0x349797(0x739)]=_0x349797(0xe62);const _0x3bab7a={'role':'assistant','senderName':_0x1dc060[_0x349797(0x278)],'content':_0x859dd4[_0x349797(0xc67)],'timestamp':Date[_0x349797(0x1182)]()};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x3bab7a);}else{_0x1dc060[_0x349797(0xa78)][_0x349797(0x739)]='blocked_by_ai';const _0x3dd429={'role':_0x349797(0x1119),'senderName':_0x1dc060[_0x349797(0x278)],'content':_0x859dd4[_0x349797(0xc67)],'timestamp':Date[_0x349797(0x1182)]()};_0x1dc060['history'][_0x349797(0xf5)](_0x3dd429);}_0x1dc060[_0x349797(0xa78)][_0x349797(0xa83)]='',await _0x2e83f8['chats'][_0x349797(0xe3c)](_0x1dc060),_0x544ab5(_0x2eb2c8),_0x5ee219();}catch(_0x40c442){_0x1dc060[_0x349797(0xa78)][_0x349797(0x739)]='blocked_by_ai',await _0x2e83f8['chats'][_0x349797(0xe3c)](_0x1dc060),await _0x2fb06(_0x349797(0xb5c),_0x349797(0x623)+_0x40c442[_0x349797(0x4bc)]),_0x544ab5(_0x2eb2c8);}return;}let _0x87589e='';const _0x1c9ce2=new Date(),_0x15c001=_0x1dc060[_0x349797(0x761)]['timeZone']||_0x349797(0xaf7),_0x1611c4=_0x1c9ce2[_0x349797(0x9df)]('zh-CN',{'timeZone':_0x15c001,'dateStyle':_0x349797(0x5ca),'timeStyle':'short'}),_0x55595a=new Date(_0x1c9ce2[_0x349797(0x9df)]('en-US',{'timeZone':_0x15c001})),_0x4c3722=_0xe5786(_0x55595a);let _0x33a578,_0x1f4b59;const _0x407681=_0x1dc060['history'][_0x349797(0x138)](_0x1037ff=>_0x1037ff[_0x349797(0xbf5)])[_0x349797(0x647)]();if(_0x407681&&_0x407681[_0x349797(0x9a5)][_0x349797(0x3ad)](_0x349797(0x11b9))){const _0x78fdff=await _0x2e83f8[_0x349797(0x516)][_0x349797(0x129e)]('chatId')[_0x349797(0x119e)](_0x2eb2c8)[_0x349797(0xc5a)]();if(_0x78fdff&&_0x78fdff[_0x349797(0x9f3)]){console[_0x349797(0x84b)]('检测到刚结束的通话，正在注入通话记录上下文...');const _0x16ebf5=_0x78fdff[_0x349797(0x9f3)]['map'](_0x2ed67f=>{const _0xbc1c14=_0x349797,_0x166e0a=_0x2ed67f[_0xbc1c14(0xba4)]==='user'?_0x1dc060[_0xbc1c14(0x761)]['myNickname']||'我':_0x2ed67f['senderName'];return _0x166e0a+':\x20'+_0x2ed67f[_0xbc1c14(0x9a5)];})[_0x349797(0xa4b)]('\x0a');_0x87589e='\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a'+_0x16ebf5+'\x0a---\x0a';}}const _0x5fce7e=_0x356017(_0x17be1a[_0x2eb2c8]);let _0xf065f6='';if(_0x1dc060['settings'][_0x349797(0xa17)]&&_0x1dc060[_0x349797(0x761)]['linkedWorldBookIds'][_0x349797(0x594)]>0x0){const _0x4b13d6=_0x1dc060['settings'][_0x349797(0xa17)]['map'](_0x57ea3d=>{const _0x4fbf66=_0x349797,_0xdf5fe3=_0x5de8b7['worldBooks'][_0x4fbf66(0xe79)](_0x4146ee=>_0x4146ee['id']===_0x57ea3d);if(!_0xdf5fe3||!Array[_0x4fbf66(0xb7b)](_0xdf5fe3[_0x4fbf66(0x9a5)]))return'';const _0x513b43=_0xdf5fe3[_0x4fbf66(0x9a5)][_0x4fbf66(0x138)](_0x50534d=>_0x50534d[_0x4fbf66(0xc34)]!==![])[_0x4fbf66(0x796)](_0x57f1f4=>{const _0x39bfdc=_0x4fbf66;let _0xbc2a7='\x0a###\x20条目:\x20'+(_0x57f1f4[_0x39bfdc(0xebd)]||_0x39bfdc(0x350))+'\x0a';return _0x57f1f4[_0x39bfdc(0xb4a)][_0x39bfdc(0x594)]>0x0&&(_0xbc2a7+='**关键词:**\x20'+_0x57f1f4[_0x39bfdc(0xb4a)][_0x39bfdc(0xa4b)](',\x20')+'\x0a'),_0xbc2a7+='**内容:**\x0a'+_0x57f1f4[_0x39bfdc(0x9a5)],_0xbc2a7;})[_0x4fbf66(0xa4b)]('');return _0x513b43?_0x4fbf66(0xe49)+_0xdf5fe3[_0x4fbf66(0x278)]+'\x0a'+_0x513b43:'';})[_0x349797(0x138)](Boolean)[_0x349797(0xa4b)]('');_0x4b13d6&&(_0xf065f6=_0x349797(0xa11)+_0x4b13d6+_0x349797(0x421));}let _0x2b6859='';if(_0xb57b5b[_0x349797(0x3d5)]&&_0xb57b5b[_0x349797(0x93d)]===_0x2eb2c8){const _0xa142ad=_0xb57b5b[_0x349797(0x12b5)]>-0x1?_0xb57b5b['playlist'][_0xb57b5b[_0x349797(0x12b5)]]:null,_0x3c313d=_0xb57b5b[_0x349797(0xcba)]['map'](_0x2b1a70=>'\x22'+_0x2b1a70[_0x349797(0x278)]+'\x22')[_0x349797(0xa4b)](',\x20');let _0x4df285='';if(_0xa142ad&&_0xb57b5b[_0x349797(0x1194)]&&_0xb57b5b['parsedLyrics'][_0x349797(0x594)]>0x0&&_0xb57b5b[_0x349797(0xe39)]>-0x1){const _0x204f71=_0xb57b5b[_0x349797(0x1194)][_0xb57b5b[_0x349797(0xe39)]],_0x39dbf4=_0xb57b5b['parsedLyrics'][_0x349797(0xa6c)](_0xb57b5b[_0x349797(0xe39)]+0x1,_0xb57b5b['currentLyricIndex']+0x3);_0x4df285+=_0x349797(0xd5d)+_0x204f71[_0x349797(0x1197)]+'\x22\x0a',_0x39dbf4['length']>0x0&&(_0x4df285+='-\x20**即将演唱**:\x20'+_0x39dbf4[_0x349797(0x796)](_0x48b8cd=>'\x22'+_0x48b8cd[_0x349797(0x1197)]+'\x22')[_0x349797(0xa4b)](_0x349797(0x65f))+'\x0a');}_0x2b6859=_0x349797(0xdb8)+(_0xa142ad?'《'+_0xa142ad[_0x349797(0x278)]+'》\x20-\x20'+_0xa142ad[_0x349797(0xb9f)]:'无')+_0x349797(0x126e)+_0x3c313d+_0x349797(0x10e9)+_0x4df285+_0x349797(0xc87);}const _0x51fb02=parseInt(_0x1dc060[_0x349797(0x761)][_0x349797(0xb2e)])||0xa,_0x2bf068=_0x1dc060['history'][_0x349797(0xa6c)](-_0x51fb02);let _0x3be9e2='';const _0x131b05=_0x1dc060[_0x349797(0x49e)][_0x349797(0xd0a)](_0x47ddb8=>_0x47ddb8[_0x349797(0xba4)]===_0x349797(0x1119)),_0x226365=_0x1dc060[_0x349797(0x49e)][_0x349797(0xa6c)](_0x131b05+0x1),_0x2b0d9b=_0x226365['find'](_0x3057a9=>_0x3057a9['type']===_0x349797(0x5e8));if(_0x2b0d9b){const _0x2ddfd5=_0x2b0d9b[_0x349797(0x287)],_0x33679c=_0x2ddfd5[_0x349797(0x7bc)][_0x349797(0x796)](_0x5a8f84=>{const _0x444780=_0x349797,_0xb3c956=_0x5a8f84[_0x444780(0x768)]||(_0x5a8f84['role']==='user'?_0x1dc060['settings'][_0x444780(0xca7)]||'我':_0x444780(0x53c));let _0x44e15a='';if(_0x5a8f84[_0x444780(0xa20)]==='voice_message')_0x44e15a=_0x444780(0xfba)+_0x5a8f84[_0x444780(0x9a5)]+']';else{if(_0x5a8f84[_0x444780(0xa20)]===_0x444780(0xd02))_0x44e15a=_0x444780(0x260)+_0x5a8f84[_0x444780(0x1029)]+']';else{if(_0x5a8f84[_0x444780(0xa20)]===_0x444780(0xcb1))_0x44e15a='[NovelAI图片:\x20'+_0x5a8f84[_0x444780(0x196)]+']';else _0x44e15a=String(_0x5a8f84[_0x444780(0x9a5)]);}}return _0xb3c956+':\x20'+_0x44e15a;})['join']('\x0a');_0x3be9e2=_0x349797(0x1024)+_0x2ddfd5[_0x349797(0x10af)]+_0x349797(0xefa)+_0x33679c+_0x349797(0x117d);}let _0x28c17d='';const _0x5dcfc1=_0x1dc060['settings']['linkedMemoryCount']||0xa;if(_0x1dc060[_0x349797(0x761)][_0x349797(0xd1d)]&&_0x1dc060[_0x349797(0x761)]['linkedMemoryChatIds'][_0x349797(0x594)]>0x0){const _0x1f316b=_0x1dc060['settings'][_0x349797(0xd1d)][_0x349797(0x138)](_0x315dfd=>_0x315dfd!==_0x2eb2c8);if(_0x1f316b[_0x349797(0x594)]>0x0){const _0x2c7f6d=_0x1f316b[_0x349797(0x796)](_0x15d909=>{const _0x99b40f=_0x349797,_0x20d839=_0x5de8b7[_0x99b40f(0x737)][_0x15d909];if(!_0x20d839)return null;const _0x447b91=_0x20d839['history'][_0x99b40f(0xa6c)](-0x1);return{'chat':_0x20d839,'latestTimestamp':_0x447b91?_0x447b91['timestamp']:0x0};})[_0x349797(0x138)](Boolean);_0x2c7f6d[_0x349797(0x861)]((_0xb9b31d,_0xe168e6)=>_0xe168e6[_0x349797(0x1294)]-_0xb9b31d[_0x349797(0x1294)]),_0x28c17d+='\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a';for(const _0x43d03d of _0x2c7f6d){const _0xa2041=_0x43d03d[_0x349797(0x847)],_0x359ef1=_0xa2041['isGroup']?_0x349797(0x1116):_0x349797(0xd19),_0x23612a=_0x43d03d[_0x349797(0x1294)]>0x0?_0x349797(0x24f)+_0x497f2b(_0x43d03d[_0x349797(0x1294)])+')':'';_0x28c17d+='\x0a##\x20---\x20来自'+_0x359ef1+'“'+_0xa2041[_0x349797(0x278)]+_0x349797(0x150)+_0x23612a+_0x349797(0xeb4);const _0x489807=_0xa2041['history']['slice'](-_0x5dcfc1),_0x434a57=_0x489807[_0x349797(0x138)](_0x61b05b=>!String(_0x61b05b[_0x349797(0x9a5)])[_0x349797(0x3ad)]('已被用户删除'));_0x434a57[_0x349797(0x594)]>0x0?_0x434a57['forEach'](_0x220d05=>{const _0xf3764d=_0x349797,_0x53755b=_0x220d05[_0xf3764d(0xba4)]===_0xf3764d(0x21c)?_0xa2041[_0xf3764d(0x761)]['myNickname']||'我':_0x220d05['senderName']||_0xa2041['name'];let _0x46a79b=String(_0x220d05[_0xf3764d(0x9a5)]);if(_0x220d05[_0xf3764d(0xa20)]===_0xf3764d(0xd02)||_0x220d05[_0xf3764d(0xa20)]===_0xf3764d(0xeb))_0x46a79b='[发送了一张图片，描述为：'+_0x220d05[_0xf3764d(0x9a5)]+']';else _0x220d05[_0xf3764d(0xa20)]===_0xf3764d(0x719)&&(_0x46a79b='[发送了一条语音，内容是：'+_0x220d05[_0xf3764d(0x9a5)]+']');const _0x41f2cc=_0x497f2b(_0x220d05['timestamp']);_0x28c17d+='('+_0x41f2cc+')\x20'+_0x53755b+':\x20'+_0x46a79b+'\x0a';}):_0x28c17d+=_0x349797(0x11d0);}}}console['log'](_0x349797(0x20c),_0x28c17d);if(_0x1dc060[_0x349797(0x1244)]){let _0x3b8d49='';const _0x51a99e=_0x1dc060['settings'][_0x349797(0x37c)]||0xa;if(_0x1dc060[_0x349797(0x761)][_0x349797(0xd1d)]&&_0x1dc060[_0x349797(0x761)][_0x349797(0xd1d)][_0x349797(0x594)]>0x0){const _0x50ac07=_0x1dc060['settings'][_0x349797(0xd1d)][_0x349797(0x138)](_0x28a499=>_0x28a499!==_0x2eb2c8);if(_0x50ac07[_0x349797(0x594)]>0x0){const _0x27b7a8=_0x50ac07['map'](_0x15df39=>{const _0xddc6df=_0x349797,_0x3c8ca0=_0x5de8b7[_0xddc6df(0x737)][_0x15df39];if(!_0x3c8ca0)return null;const _0x53c832=_0x3c8ca0[_0xddc6df(0x49e)][_0xddc6df(0xa6c)](-0x1);return{'chat':_0x3c8ca0,'latestTimestamp':_0x53c832?_0x53c832[_0xddc6df(0x702)]:0x0};})[_0x349797(0x138)](Boolean);_0x27b7a8['sort']((_0x175bc5,_0x443914)=>_0x443914[_0x349797(0x1294)]-_0x175bc5[_0x349797(0x1294)]),_0x3b8d49+=_0x349797(0xff);for(const _0x2fc589 of _0x27b7a8){const _0x1bab40=_0x2fc589[_0x349797(0x847)],_0x4202ae=_0x1bab40[_0x349797(0x1244)]?_0x349797(0x1116):_0x349797(0xd19),_0x60a7fa=_0x2fc589['latestTimestamp']>0x0?_0x349797(0x24f)+_0x497f2b(_0x2fc589['latestTimestamp'])+')':'';_0x3b8d49+='\x0a##\x20---\x20来自'+_0x4202ae+'“'+_0x1bab40[_0x349797(0x278)]+_0x349797(0x150)+_0x60a7fa+_0x349797(0xeb4);const _0x553506=_0x1bab40[_0x349797(0x49e)][_0x349797(0xa6c)](-_0x51a99e),_0xb66565=_0x553506[_0x349797(0x138)](_0x419a0f=>!String(_0x419a0f['content'])[_0x349797(0x3ad)](_0x349797(0xcab)));_0xb66565[_0x349797(0x594)]>0x0?_0xb66565[_0x349797(0x494)](_0x2cca68=>{const _0x1143e3=_0x349797,_0x5b819b=_0x2cca68[_0x1143e3(0xba4)]===_0x1143e3(0x21c)?_0x1bab40['settings'][_0x1143e3(0xca7)]||'我':_0x2cca68[_0x1143e3(0x768)]||_0x1bab40[_0x1143e3(0x278)];let _0x499e04=String(_0x2cca68['content']);if(_0x2cca68[_0x1143e3(0xa20)]===_0x1143e3(0xd02)||_0x2cca68[_0x1143e3(0xa20)]===_0x1143e3(0xeb))_0x499e04=_0x1143e3(0xe56)+_0x2cca68[_0x1143e3(0x9a5)]+']';else _0x2cca68[_0x1143e3(0xa20)]===_0x1143e3(0x719)&&(_0x499e04=_0x1143e3(0x338)+_0x2cca68[_0x1143e3(0x9a5)]+']');_0x3b8d49+=_0x5b819b+':\x20'+_0x499e04+'\x0a';}):_0x3b8d49+=_0x349797(0x11d0);}}}let _0x457428=_0x349797(0xad2),_0x525173=![];_0x1dc060['members'][_0x349797(0x494)](_0x107574=>{const _0x4b5f71=_0x349797,_0x4b4a36=_0x5de8b7[_0x4b5f71(0x737)][_0x107574['id']];_0x4b4a36&&_0x4b4a36[_0x4b5f71(0xe21)]&&_0x4b4a36[_0x4b5f71(0xe21)][_0x4b5f71(0x594)]>0x0&&(_0x457428+=_0x4b5f71(0xcaf)+_0x107574[_0x4b5f71(0xc8f)]+_0x4b5f71(0x24e),_0x457428+=_0x4b4a36[_0x4b5f71(0xe21)][_0x4b5f71(0x796)](_0x3d0c0d=>_0x4b5f71(0xd12)+_0x497f2b(_0x3d0c0d[_0x4b5f71(0x702)])+')\x20'+_0x3d0c0d[_0x4b5f71(0x9a5)])[_0x4b5f71(0xa4b)]('\x0a'),_0x525173=!![]);});!_0x525173&&(_0x457428+=_0x349797(0x12cc));let _0x5e3926='',_0x366939=![];if(_0x1dc060[_0x349797(0x761)][_0x349797(0x290)]){const _0x3a4800=_0x2bf068[_0x349797(0xa6c)](-0x1)[0x0];if(_0x3a4800){const _0x5546e1=_0x46fb0b(_0x3a4800[_0x349797(0x702)]);_0x5e3926=_0x349797(0x99f)+_0x5546e1+'。';const _0x5044ab=(Date[_0x349797(0x1182)]()-_0x3a4800[_0x349797(0x702)])/(0x3e8*0x3c*0x3c);if(_0x5044ab>0x3){_0x366939=!![];const _0x4134d2=Math['floor'](_0x5044ab/0x18);_0x5e3926+='\x20群里已经安静了'+(_0x4134d2>0x0?_0x4134d2+'天':Math[_0x349797(0xfb1)](_0x5044ab)+'小时')+'。';}}else _0x5e3926=_0x349797(0x10b4);}const _0x317fbb=await _0x2e83f8[_0x349797(0x120)]['toArray']();let _0x1e7775='';_0x317fbb[_0x349797(0x594)]>0x0&&(_0x1e7775='\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a',_0x317fbb[_0x349797(0x494)](_0x2cc1f4=>{const _0xef830f=_0x349797;_0x1e7775+=_0xef830f(0x1161)+_0x2cc1f4['id']+_0xef830f(0xc5e)+_0x2cc1f4['name']+',\x20价格:\x20¥'+_0x2cc1f4['price'][_0xef830f(0x200)](0x2)+'\x0a';}));let _0x1aafae=_0x1dc060['members']['map'](_0x291de9=>{const _0x4703f0=_0x349797,_0x3a5769=_0x5de8b7[_0x4703f0(0x737)][_0x291de9['id']];let _0x2640c6='无共同好友';if(_0x3a5769&&_0x3a5769[_0x4703f0(0xe0d)]){const _0x18357b=Object['values'](_0x5de8b7[_0x4703f0(0x737)])['filter'](_0x200b35=>!_0x200b35[_0x4703f0(0x1244)]&&_0x200b35['id']!==_0x291de9['id']&&_0x200b35[_0x4703f0(0xe0d)]===_0x3a5769[_0x4703f0(0xe0d)]);_0x18357b['length']>0x0&&(_0x2640c6=_0x4703f0(0x705)+_0x18357b[_0x4703f0(0x796)](_0x4fea46=>_0x4fea46[_0x4703f0(0x278)])[_0x4703f0(0xa4b)]('、\x20'));}return _0x4703f0(0x11c)+_0x291de9[_0x4703f0(0xc8f)]+_0x4703f0(0x83f)+_0x291de9['originalName']+'):\x20'+_0x291de9[_0x4703f0(0x701)]+_0x4703f0(0x487)+_0x2640c6+']';})[_0x349797(0xa4b)]('\x0a');const _0xb9ca42=_0x1dc060['settings'][_0x349797(0xca7)]||'我',_0x227c4b=_0x5de8b7[_0x349797(0x1c5)]['nickname']||_0x349797(0x833);let _0x3f620b='';const _0x2eb944=(_0x1dc060[_0x349797(0x286)]||[])[_0x349797(0x138)](_0x23a6e4=>_0x23a6e4[_0x349797(0x8ac)]);_0x2eb944[_0x349797(0x594)]>0x0&&(_0x3f620b+=_0x349797(0x641),_0x2eb944[_0x349797(0x494)](_0x39e3b6=>{const _0x30c742=_0x349797,_0x41c766=_0x1dc060[_0x30c742(0x49e)][_0x30c742(0xe79)](_0x1272de=>_0x1272de[_0x30c742(0x702)]===_0x39e3b6['messageTimestamp']);if(_0x41c766){let _0x410102=String(_0x41c766['content']||'');_0x41c766[_0x30c742(0xa20)]==='ai_image'&&(_0x410102='[图片内容:\x20'+_0x410102+']'),_0x3f620b+=_0x30c742(0x406)+_0x410102+_0x30c742(0xe1e)+_0x39e3b6[_0x30c742(0xa50)]+'\x20发布)\x0a';}}),_0x3f620b+=_0x349797(0xe0a));const _0x185d0f=_0x1dc060[_0x349797(0x2b3)][_0x349797(0x796)](_0x1701e5=>_0x1701e5['originalName']),_0x39dabf=_0x349797(0xa13)+_0x185d0f['join']('、\x20')+']';let _0x2049af=_0x349797(0x1214);_0x1dc060['settings'][_0x349797(0x86c)]&&_0x1dc060[_0x349797(0x761)][_0x349797(0x86c)][_0x349797(0x594)]>0x0?_0x2049af+=_0x1dc060[_0x349797(0x761)][_0x349797(0x86c)]['map'](_0xf74125=>'-\x20'+_0xf74125['name'])[_0x349797(0xa4b)]('\x0a'):_0x2049af+=_0x349797(0x16b);const _0x11c103=_0x4ffeed(_0x2eb2c8),_0x1401cf=_0x57277b(_0x1dc060,0x3,_0x349797(0x1059)),_0x440541=_0x57277b(_0x1dc060,0x6,_0x349797(0x1059)),_0x2a435b=_0x57277b(_0x1dc060,0x9,'hours'),_0x1bff77=_0x57277b(_0x1dc060,0x1,_0x349797(0xb95)),_0xf51a14=_0x57277b(_0x1dc060,0x3,_0x349797(0xb95)),_0x8c53db=_0x57277b(_0x1dc060,0x7,_0x349797(0xb95));let _0x448842='';if(_0x1401cf||_0x440541||_0x2a435b||_0x1bff77||_0xf51a14||_0x8c53db){_0x448842+=_0x349797(0xcd);if(_0x1401cf)_0x448842+=_0x1401cf;if(_0x440541)_0x448842+=_0x440541;if(_0x2a435b)_0x448842+=_0x2a435b;if(_0x1401cf||_0x440541||_0x2a435b)_0x448842+='\x0a';if(_0x1bff77)_0x448842+=_0x1bff77;if(_0xf51a14)_0x448842+=_0xf51a14;if(_0x8c53db)_0x448842+=_0x8c53db;}const _0x77673d=_0xb76b68(_0x1dc060);_0x33a578=_0x349797(0x96e)+_0xb9ca42+_0x349797(0x3cf)+_0x227c4b+'】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22'+_0xb9ca42+_0x349797(0x7d2)+_0x1dc060['name']+_0x349797(0x938)+(_0x1dc060[_0x349797(0x761)][_0x349797(0x290)]?'4.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20('+_0x1611c4+_0x349797(0xfb6)+(_0x366939?_0x349797(0x7f5)+_0x5e3926+'\x20你应该让角色们主动开启新话题来打破沉默。':''):'')+'\x0a\x20\x20\x20\x20-\x20**读书**:\x20'+(_0x11c103?'你们正在一起读书。'+_0x11c103:_0x349797(0xe27))+_0x349797(0x3d9)+_0x1dc060[_0x349797(0x278)]+'\x0a'+(_0x1dc060[_0x349797(0x761)][_0x349797(0x290)]?'-\x20**对话状态**:\x20上次互动于\x20'+_0x5e3926:'')+_0x349797(0x4b0)+_0x1aafae+_0x349797(0xf1b)+_0xb9ca42+_0x349797(0xd7)+_0x1dc060['settings'][_0x349797(0x10c5)]+_0x349797(0x1249)+_0xf065f6+_0x349797(0xf45)+_0x457428+'\x0a'+(_0x1dc060[_0x349797(0xe21)]&&_0x1dc060['longTermMemory']['length']>0x0?_0x1dc060[_0x349797(0xe21)][_0x349797(0x796)](_0x74bd5b=>'-\x20'+_0x74bd5b[_0x349797(0x9a5)])[_0x349797(0xa4b)]('\x0a'):'-\x20(暂无)')+'\x0a'+_0x448842+'\x0a'+_0x3b8d49+'\x0a'+_0x2b6859+'\x0a'+_0x3be9e2+'\x0a'+_0x2049af+_0x349797(0xa01)+_0x77673d+'\x0a'+_0x39dabf+'\x0a'+_0x87589e+_0x349797(0x54a)+(localStorage[_0x349797(0x728)](_0x349797(0x1153))==='true'?_0x349797(0xe22):'')+_0x349797(0x2b8),_0x1f4b59=_0x2bf068[_0x349797(0x796)](_0xb164d3=>{const _0x4d1a41=_0x349797,_0x646b36=_0xb164d3[_0x4d1a41(0xba4)]===_0x4d1a41(0x21c)?_0xb9ca42:_0xb164d3['senderName'];let _0x47499=''+_0x646b36;if(_0xb164d3['quote']){const _0x3e343a=String(_0xb164d3['quote']['content']||'')[_0x4d1a41(0x8d4)](0x0,0x32);_0x47499+=_0x4d1a41(0xc4c)+_0xb164d3[_0x4d1a41(0xb9)][_0x4d1a41(0x768)]+_0x4d1a41(0x94a)+_0x3e343a+_0x4d1a41(0x6ad);}_0x47499+=':\x20';let _0x47ce30;if(_0xb164d3[_0x4d1a41(0xa20)]===_0x4d1a41(0xeb))_0x47ce30='['+_0x646b36+_0x4d1a41(0x57d)+_0xb164d3[_0x4d1a41(0x9a5)]+'\x27]';else{if(_0xb164d3[_0x4d1a41(0xa20)]===_0x4d1a41(0xd02))_0x47ce30='['+_0x646b36+_0x4d1a41(0x497)+_0xb164d3[_0x4d1a41(0x9a5)]+'\x27]';else{if(_0xb164d3[_0x4d1a41(0xa20)]===_0x4d1a41(0xcb1))_0x47ce30='['+_0x646b36+_0x4d1a41(0x1064)+_0xb164d3['prompt']+']';else{if(_0xb164d3[_0x4d1a41(0xa20)]==='voice_message')_0x47ce30='['+_0x646b36+_0x4d1a41(0xabd)+_0xb164d3[_0x4d1a41(0x9a5)]+'\x27]';else{if(_0xb164d3[_0x4d1a41(0xa20)]===_0x4d1a41(0x82b))_0x47ce30='['+_0xb164d3[_0x4d1a41(0x768)]+'\x20向\x20'+_0xb164d3['receiverName']+_0x4d1a41(0x11f0)+_0xb164d3[_0x4d1a41(0x354)]+_0x4d1a41(0x6b3)+_0xb164d3[_0x4d1a41(0x1213)]+']';else{if(_0xb164d3[_0x4d1a41(0xa20)]===_0x4d1a41(0x104))_0x47ce30='['+_0x646b36+_0x4d1a41(0x370)+_0xb164d3[_0x4d1a41(0x9a5)]+'\x27]';else{if(_0xb164d3[_0x4d1a41(0xa20)]===_0x4d1a41(0x45a)){const _0x2349db=_0xb164d3[_0x4d1a41(0x12a3)]?'并评论说：“'+_0xb164d3[_0x4d1a41(0x12a3)]+'”':'';let _0x2f0bc5=_0x4d1a41(0x5fe);const _0x1dbff1=_0xb164d3[_0x4d1a41(0xdd1)][_0x4d1a41(0x5d9)];if(_0x1dbff1===_0x4d1a41(0x21c))_0x2f0bc5=_0x5de8b7['qzoneSettings'][_0x4d1a41(0xa33)];else _0x5de8b7[_0x4d1a41(0x737)][_0x1dbff1]&&(_0x2f0bc5=_0x5de8b7['chats'][_0x1dbff1][_0x4d1a41(0x278)]);let _0x530392;const _0x29ba5d=_0xb164d3['originalPost'];if(_0x29ba5d[_0x4d1a41(0xa20)]===_0x4d1a41(0x887))_0x530392=_0x4d1a41(0x638)+(_0x29ba5d['publicText']||'')+'\x20(图片描述:\x20“'+(_0x29ba5d['hiddenContent']||'')[_0x4d1a41(0x8d4)](0x0,0x28)+'...”)';else _0x29ba5d[_0x4d1a41(0xa20)]===_0x4d1a41(0x332)?_0x530392=_0x4d1a41(0x280)+(_0x29ba5d[_0x4d1a41(0x12aa)]||'')+_0x4d1a41(0x3ef)+(_0x29ba5d[_0x4d1a41(0x6b6)]||'')[_0x4d1a41(0x8d4)](0x0,0x28)+_0x4d1a41(0xb7e):_0x530392='“'+(_0x29ba5d[_0x4d1a41(0x9a5)]||'')['substring'](0x0,0x28)+_0x4d1a41(0xf54);_0x47ce30='['+_0x646b36+_0x4d1a41(0xb50)+_0x2f0bc5+_0x4d1a41(0xc93)+_0x2349db+_0x4d1a41(0xb38)+_0x530392+'】]';}else{if(_0xb164d3[_0x4d1a41(0xa20)]===_0x4d1a41(0x123b))_0xb164d3[_0x4d1a41(0x739)]===_0x4d1a41(0xa42)?_0x47ce30='[系统提示：'+_0xb164d3['paidBy']+_0x4d1a41(0x73e)+_0x646b36+_0x4d1a41(0x2a8)+_0xb164d3[_0x4d1a41(0x354)]+_0x4d1a41(0xf4b):_0x47ce30='['+_0x646b36+'\x20发起了外卖代付请求，商品是“'+_0xb164d3[_0x4d1a41(0x1253)]+'”，金额是\x20'+_0xb164d3[_0x4d1a41(0x354)]+'\x20元，订单时间戳为\x20'+_0xb164d3[_0x4d1a41(0x702)]+']';else{if(_0xb164d3[_0x4d1a41(0xa20)]===_0x4d1a41(0x305)){const _0x4df986=_0xb164d3['senderName']===_0xb9ca42?'用户\x20('+_0xb9ca42+')':_0xb164d3['senderName'];let _0x3f4bfe;_0xb164d3[_0x4d1a41(0xc3d)]===_0x4d1a41(0x978)?_0x3f4bfe=_0x4d1a41(0x116a)+_0x4df986+_0x4d1a41(0x152)+_0xb164d3[_0x4d1a41(0x702)]+_0x4d1a41(0x1297)+_0xb164d3['receiverName']+_0x4d1a41(0xf67)+_0xb164d3['receiverName']+_0x4d1a41(0xf2f):_0x3f4bfe='[系统提示：'+_0x4df986+_0x4d1a41(0x26f)+_0xb164d3[_0x4d1a41(0x702)]+_0x4d1a41(0x944)+_0xb164d3['greeting']+_0x4d1a41(0x972),_0x47ce30=_0x3f4bfe;}else{if(_0xb164d3['type']===_0x4d1a41(0xf9e)){const _0x44602b=_0xb164d3[_0x4d1a41(0xba4)]===_0x4d1a41(0x21c)?_0xb9ca42:_0xd9d60a(_0x1dc060,_0xb164d3[_0x4d1a41(0x768)]),_0x98154b=_0xb164d3['items'][_0x4d1a41(0x796)](_0x4e3f0e=>_0x4e3f0e[_0x4d1a41(0x278)]+'\x20x'+_0x4e3f0e[_0x4d1a41(0x108a)])['join']('、\x20');let _0x1240cf='';if(_0xb164d3[_0x4d1a41(0xfae)]&&_0xb164d3['recipients'][_0x4d1a41(0x594)]>0x0){const _0x4f1ea0=_0xb164d3[_0x4d1a41(0xfae)][_0x4d1a41(0x796)](_0x113ff7=>_0xd9d60a(_0x1dc060,_0x113ff7))[_0x4d1a41(0xa4b)]('、\x20');_0x1240cf=_0x4d1a41(0x6b2)+_0x4f1ea0;}else _0x1240cf=_0x4d1a41(0x581);return _0x47ce30='[系统提示：'+_0x44602b+'\x20'+_0x1240cf+'，礼物是：'+_0x98154b+']',{'role':_0x4d1a41(0x21c),'content':_0x47ce30};}else{if(_0xb164d3[_0x4d1a41(0xa20)]===_0x4d1a41(0xcc5)){const _0x3b0bf9=Object[_0x4d1a41(0x4ca)](_0xb164d3[_0x4d1a41(0x510)]||{})['flat']()[_0x4d1a41(0xa4b)](',\x20')||'还没有人';_0x47ce30=_0x4d1a41(0x116a)+_0xb164d3[_0x4d1a41(0x768)]+_0x4d1a41(0x25f)+_0xb164d3['timestamp']+_0x4d1a41(0xe4)+_0xb164d3[_0x4d1a41(0xdb5)]+_0x4d1a41(0x10dc)+_0xb164d3[_0x4d1a41(0x11a1)][_0x4d1a41(0xa4b)](',\x20')+_0x4d1a41(0x80b)+_0x3b0bf9+'。你可以使用\x20\x27vote\x27\x20指令参与投票。]';}else{if(_0xb164d3[_0x4d1a41(0xb36)])_0x47ce30=_0x646b36+':\x20[发送了一个表情，意思是:\x20\x27'+_0xb164d3[_0x4d1a41(0xb36)]+'\x27]';else{if(Array[_0x4d1a41(0xb7b)](_0xb164d3[_0x4d1a41(0x9a5)]))return{'role':_0x4d1a41(0x21c),'content':[..._0xb164d3[_0x4d1a41(0x9a5)],{'type':_0x4d1a41(0x1197),'text':_0x47499}]};else _0x47ce30=''+_0x47499+_0xb164d3[_0x4d1a41(0x9a5)];}}}}}}}}}}}}return{'role':'user','content':_0x47ce30};})['filter'](Boolean);}else{const _0x20bf85=_0x1dc060['settings'][_0x349797(0xadd)],_0xcb651b=_0x5342bb(_0x1dc060);let _0x5df71b='';_0x1dc060['settings'][_0x349797(0x663)]&&_0x1dc060[_0x349797(0x535)]&&!_0x20bf85&&(_0x5df71b=_0x349797(0xb7d)+_0x1dc060[_0x349797(0x535)]+_0x349797(0xa22)+_0x1dc060[_0x349797(0x267)]+'\x0a');let _0x586632='';const _0x367c28=_0x1dc060['settings']['linkedMemoryCount']||0xa;if(_0x1dc060[_0x349797(0x761)][_0x349797(0xd1d)]&&_0x1dc060['settings'][_0x349797(0xd1d)]['length']>0x0){const _0x4ff846=_0x1dc060[_0x349797(0x761)]['linkedMemoryChatIds'][_0x349797(0x138)](_0x3d4433=>_0x3d4433!==_0x2eb2c8);if(_0x4ff846['length']>0x0){const _0x29a789=_0x4ff846[_0x349797(0x796)](_0x3a215c=>{const _0xe2d646=_0x349797,_0x173e71=_0x5de8b7[_0xe2d646(0x737)][_0x3a215c];if(!_0x173e71)return null;const _0x2ede8a=_0x173e71['history'][_0xe2d646(0xa6c)](-0x1)[0x0];return{'chat':_0x173e71,'latestTimestamp':_0x2ede8a?_0x2ede8a[_0xe2d646(0x702)]:0x0};})[_0x349797(0x138)](Boolean);_0x29a789['sort']((_0x22ea0f,_0x35975d)=>_0x35975d[_0x349797(0x1294)]-_0x22ea0f[_0x349797(0x1294)]),_0x586632+=_0x349797(0x1085);for(const _0x5934af of _0x29a789){const _0x21f321=_0x5934af[_0x349797(0x847)],_0x35fa4e=_0x21f321[_0x349797(0x1244)]?'[群聊]':_0x349797(0xd19),_0x503306=_0x5934af[_0x349797(0x1294)]>0x0?_0x349797(0x24f)+_0x497f2b(_0x5934af[_0x349797(0x1294)])+')':'';_0x586632+='\x0a##\x20---\x20来自'+_0x35fa4e+'“'+_0x21f321[_0x349797(0x278)]+_0x349797(0x150)+_0x503306+_0x349797(0xeb4);const _0x4f25d4=_0x21f321['history'][_0x349797(0xa6c)](-_0x367c28),_0x376a61=_0x4f25d4[_0x349797(0x138)](_0x3ab1bd=>!String(_0x3ab1bd[_0x349797(0x9a5)])['includes'](_0x349797(0xcab)));_0x376a61[_0x349797(0x594)]>0x0?_0x376a61[_0x349797(0x494)](_0x347599=>{const _0x2ff7ae=_0x349797,_0x45bfab=_0x347599[_0x2ff7ae(0xba4)]===_0x2ff7ae(0x21c)?_0x21f321[_0x2ff7ae(0x761)][_0x2ff7ae(0xca7)]||'我':_0x347599['senderName']||_0x21f321[_0x2ff7ae(0x278)];let _0x2c557f=String(_0x347599[_0x2ff7ae(0x9a5)]);if(_0x347599[_0x2ff7ae(0xa20)]==='ai_image'||_0x347599[_0x2ff7ae(0xa20)]===_0x2ff7ae(0xeb))_0x2c557f=_0x2ff7ae(0xe56)+_0x347599[_0x2ff7ae(0x9a5)]+']';else _0x347599['type']===_0x2ff7ae(0x719)&&(_0x2c557f='[发送了一条语音，内容是：'+_0x347599[_0x2ff7ae(0x9a5)]+']');const _0xb8be58=_0x497f2b(_0x347599[_0x2ff7ae(0x702)]);_0x586632+='('+_0xb8be58+')\x20'+_0x45bfab+':\x20'+_0x2c557f+'\x0a';}):_0x586632+='(暂无有效聊天记录)\x0a';}}}const _0x317257=await _0x2e83f8[_0x349797(0x120)]['toArray']();let _0x908a38='';_0x317257[_0x349797(0x594)]>0x0&&(_0x908a38='\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a',_0x317257['forEach'](_0x4cdc37=>{const _0x5d58fc=_0x349797;_0x908a38+='-\x20(ID:\x20'+_0x4cdc37['id']+_0x5d58fc(0xc5e)+_0x4cdc37[_0x5d58fc(0x278)]+_0x5d58fc(0xb64)+_0x4cdc37[_0x5d58fc(0xa6f)][_0x5d58fc(0x200)](0x2)+'\x0a';}));if(_0x20bf85){const _0x2ca2d9=_0x1dc060[_0x349797(0x761)][_0x349797(0x12db)]||0x64,_0x40810f=_0x1dc060['settings'][_0x349797(0xb31)]||0x12c,_0x3640cc=_0x1dc060[_0x349797(0x761)]['myNickname']||'我';let _0x28d817='';if(_0x1dc060['settings'][_0x349797(0xa15)]){const _0x38582c=_0x5de8b7[_0x349797(0x427)][_0x349797(0xe79)](_0x30c3c2=>_0x30c3c2['id']===_0x1dc060['settings'][_0x349797(0xa15)]);if(_0x38582c&&Array[_0x349797(0xb7b)](_0x38582c[_0x349797(0x9a5)])){const _0x44e38b=_0x38582c['content'][_0x349797(0x138)](_0x2ea540=>_0x2ea540['enabled']!==![])[_0x349797(0x796)](_0x3794d9=>'-\x20'+_0x3794d9[_0x349797(0x9a5)])['join']('\x0a');_0x44e38b&&(_0x28d817='\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a'+_0x44e38b+_0x349797(0x12ff));}}_0x33a578=_0x349797(0x6f5)+_0x1dc060['originalName']+_0x349797(0x107c)+_0x28d817+_0x349797(0x552)+_0x1dc060[_0x349797(0x761)][_0x349797(0x8d5)]+_0x349797(0x105e)+_0x1dc060['settings']['myPersona']+'\x0a\x0a#\x20供你参考的信息\x0a'+(_0x1dc060[_0x349797(0x761)][_0x349797(0x290)]?_0x349797(0x10a4)+_0x1611c4+'\x20('+_0x4c3722+')':'')+_0x349797(0x12a)+_0xf065f6+_0x349797(0xa40)+(_0x1dc060['longTermMemory']&&_0x1dc060[_0x349797(0xe21)][_0x349797(0x594)]>0x0?_0x1dc060[_0x349797(0xe21)][_0x349797(0x796)](_0x56f1ed=>'-\x20'+_0x56f1ed[_0x349797(0x9a5)])[_0x349797(0xa4b)]('\x0a'):_0x349797(0x12cc))+'\x0a\x0a'+_0x586632+_0x349797(0xe01)+_0x2bf068['map'](_0x25c80a=>{const _0x4207e5=_0x349797;let _0xdaf28d=(_0x25c80a['role']===_0x4207e5(0x21c)?_0x3640cc:_0x1dc060[_0x4207e5(0x278)])+':\x20';return _0x25c80a['type']==='offline_text'?_0xdaf28d+='「'+(_0x25c80a[_0x4207e5(0x159)]||'')+'」\x20'+(_0x25c80a[_0x4207e5(0x1029)]||''):_0xdaf28d+=String(_0x25c80a[_0x4207e5(0x9a5)]),_0xdaf28d;})[_0x349797(0xa4b)]('\x0a')+_0x349797(0xa27)+_0x2ca2d9+'到'+_0x40810f+'字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a',_0x1f4b59=_0x2bf068[_0x349797(0x796)](_0x52a350=>{const _0x3472a4=_0x349797;if(_0x52a350[_0x3472a4(0xbf5)])return null;if(_0x52a350[_0x3472a4(0xa20)]===_0x3472a4(0xd71)){const _0x4965c7=_0x52a350['role']==='user'?_0x1dc060['settings'][_0x3472a4(0xca7)]||'我':_0x1dc060[_0x3472a4(0x278)];let _0x20b9df='';if(_0x52a350[_0x3472a4(0x9a5)])_0x20b9df=_0x52a350[_0x3472a4(0x9a5)];else{const _0x14fca7=_0x52a350[_0x3472a4(0x159)]?'「'+_0x52a350[_0x3472a4(0x159)]+'」':'',_0x158f32=_0x52a350[_0x3472a4(0x1029)]?'('+_0x52a350['description']+')':'';_0x20b9df=(_0x14fca7+'\x20'+_0x158f32)[_0x3472a4(0xeb7)]();}return{'role':_0x52a350[_0x3472a4(0xba4)],'content':_0x4965c7+':\x20'+_0x20b9df};}if(_0x52a350[_0x3472a4(0xba4)]===_0x3472a4(0x21c)){const _0x4ca91b=_0x3640cc+':\x20';let _0x45fec3='';if(Array[_0x3472a4(0xb7b)](_0x52a350[_0x3472a4(0x9a5)])&&_0x52a350['content'][0x0]?.[_0x3472a4(0xa20)]===_0x3472a4(0x488))return{'role':'user','content':[{'type':'text','text':_0x4ca91b},..._0x52a350[_0x3472a4(0x9a5)]]};if(_0x52a350[_0x3472a4(0xb9)]){const _0xe502c8=String(_0x52a350[_0x3472a4(0xb9)][_0x3472a4(0x9a5)]||'')['substring'](0x0,0x32);_0x45fec3+=_0x3472a4(0x88a)+_0x52a350[_0x3472a4(0xb9)][_0x3472a4(0x768)]+'\x20的消息:\x20\x22'+_0xe502c8+_0x3472a4(0xb99)+_0x52a350[_0x3472a4(0x9a5)];}else _0x45fec3+=_0x52a350[_0x3472a4(0x9a5)];if(_0x52a350['type']===_0x3472a4(0xeb))return{'role':_0x3472a4(0x21c),'content':_0x4ca91b+'[你发送了一张需要AI识别的图片，图片内容是：\x27'+_0x52a350[_0x3472a4(0x9a5)]+'\x27]'};if(_0x52a350['type']===_0x3472a4(0x719))return{'role':'user','content':_0x4ca91b+_0x3472a4(0xe69)+_0x52a350[_0x3472a4(0x9a5)]+'\x27]'};if(_0x52a350[_0x3472a4(0xa20)]===_0x3472a4(0x82b))return{'role':_0x3472a4(0x21c),'content':_0x4ca91b+_0x3472a4(0x8c5)+_0x52a350[_0x3472a4(0x702)]+_0x3472a4(0x37d)+_0x52a350['amount']+'元,\x20备注:\x20'+_0x52a350['note']+'。等待对方处理。]'};if(_0x52a350['type']==='waimai_request')return{'role':_0x3472a4(0x21c),'content':_0x4ca91b+'[系统提示：你于时间戳\x20'+_0x52a350[_0x3472a4(0x702)]+_0x3472a4(0x8b2)+_0x52a350[_0x3472a4(0x1253)]+'”，金额是\x20'+_0x52a350['amount']+_0x3472a4(0x517)};else{if(_0x52a350[_0x3472a4(0xa20)]===_0x3472a4(0xf9e)){const _0x433580=_0x52a350['items'][_0x3472a4(0x796)](_0x374594=>_0x374594[_0x3472a4(0x278)]+'\x20x'+_0x374594[_0x3472a4(0x108a)])[_0x3472a4(0xa4b)]('、\x20');let _0x9f3a26=_0x1dc060[_0x3472a4(0x1244)]?'送给了\x20'+_0x52a350[_0x3472a4(0xfae)][_0x3472a4(0x796)](_0x30bc2a=>_0xd9d60a(_0x1dc060,_0x30bc2a))[_0x3472a4(0xa4b)]('、\x20'):_0x3472a4(0x6b2)+_0x1dc060['name'];return{'role':_0x3472a4(0x21c),'content':_0x4ca91b+_0x3472a4(0x2a1)+_0x9f3a26+_0x3472a4(0x58a)+_0x433580+']'};}}if(_0x52a350['meaning'])return{'role':_0x3472a4(0x21c),'content':_0x4ca91b+_0x3472a4(0x1168)+_0x52a350[_0x3472a4(0xb36)]+'\x27]'};return{'role':_0x52a350['role'],'content':_0x4ca91b+_0x45fec3};}else{if(_0x52a350['role']==='assistant'){let _0x2214fb={'type':_0x52a350['type']||'text'};if(_0x52a350[_0x3472a4(0xa20)]==='sticker')_0x2214fb['url']=_0x52a350[_0x3472a4(0x9a5)],_0x2214fb[_0x3472a4(0xb36)]=_0x52a350['meaning'];else{if(_0x52a350[_0x3472a4(0xa20)]===_0x3472a4(0x82b))_0x2214fb[_0x3472a4(0x354)]=_0x52a350[_0x3472a4(0x354)],_0x2214fb[_0x3472a4(0x1213)]=_0x52a350[_0x3472a4(0x1213)];else _0x52a350['type']===_0x3472a4(0x123b)?(_0x2214fb[_0x3472a4(0x1253)]=_0x52a350[_0x3472a4(0x1253)],_0x2214fb[_0x3472a4(0x354)]=_0x52a350[_0x3472a4(0x354)]):_0x52a350[_0x3472a4(0xb9)]?_0x2214fb[_0x3472a4(0x229)]={'target_sender':_0x52a350[_0x3472a4(0xb9)][_0x3472a4(0x768)],'target_content':_0x52a350[_0x3472a4(0xb9)][_0x3472a4(0x9a5)],'reply_content':_0x52a350['content']}:_0x2214fb['content']=_0x52a350[_0x3472a4(0x9a5)];}const _0x548121=JSON['stringify']([_0x2214fb]);return{'role':_0x3472a4(0x1119),'content':_0x3472a4(0xc51)+_0x52a350[_0x3472a4(0x702)]+')\x20'+_0x548121};}}return null;})['filter'](Boolean);}else{let _0x11f04f='';_0x1dc060['nameHistory']&&_0x1dc060['nameHistory'][_0x349797(0x594)]>0x0&&(_0x11f04f=_0x349797(0xc57)+_0x1dc060[_0x349797(0x3d7)][_0x349797(0xa4b)](',\x20')+_0x349797(0xfa5));let _0x241eac='';const _0x424fc6=_0x5de8b7['qzoneSettings']['nickname']||'用户';_0x241eac+=_0x349797(0x6fb)+_0x424fc6+_0x349797(0xb1);const _0x150a7f=Object[_0x349797(0x4ca)](_0x5de8b7[_0x349797(0x737)]),_0x5ab179=_0x150a7f[_0x349797(0x138)](_0x238068=>_0x238068['isGroup']&&_0x238068[_0x349797(0x2b3)]['some'](_0x474bb2=>_0x474bb2['id']===_0x1dc060['id']));_0x5ab179['length']>0x0&&(_0x241eac+='-\x20用户在你们共同所在的群聊中的昵称如下：\x0a',_0x5ab179[_0x349797(0x494)](_0x40b2c8=>{const _0x34becb=_0x349797,_0x259316=_0x40b2c8['settings'][_0x34becb(0xca7)]||_0x424fc6;_0x241eac+=_0x34becb(0x825)+_0x40b2c8[_0x34becb(0x278)]+_0x34becb(0x35b)+_0x259316+_0x34becb(0x7fe);}));_0x241eac+=_0x349797(0xd6b);let _0x7c0566='';const _0x51f6bf=_0x150a7f[_0x349797(0x138)](_0x55e774=>!_0x55e774[_0x349797(0x1244)]&&_0x55e774['id']!==_0x1dc060['id']&&_0x55e774[_0x349797(0xe0d)]===_0x1dc060[_0x349797(0xe0d)]&&_0x1dc060[_0x349797(0xe0d)]!==null);_0x51f6bf[_0x349797(0x594)]>0x0&&(_0x7c0566+=_0x349797(0x9d0),_0x51f6bf[_0x349797(0x494)](_0x386739=>{const _0x31a1c3=_0x349797;_0x7c0566+=_0x31a1c3(0x875)+_0x386739[_0x31a1c3(0x278)]+_0x31a1c3(0x83f)+_0x386739[_0x31a1c3(0x697)]+')\x0a';}));const _0x1340b0=await _0x2e83f8[_0x349797(0x1218)]['orderBy'](_0x349797(0x702))[_0x349797(0x107)]()[_0x349797(0x637)](0xa)[_0x349797(0x508)](),_0x28887e=_0x3f9279(_0x1340b0,_0x1dc060);let _0x4c8734='';if(_0x28887e[_0x349797(0x594)]>0x0){_0x4c8734=_0x349797(0xa23);const _0xad5882=_0x1dc060[_0x349797(0x697)];for(const _0x214428 of _0x28887e){let _0x303cc9;if(_0x214428[_0x349797(0x5d9)]===_0x349797(0x21c))_0x303cc9=_0x5de8b7[_0x349797(0x1c5)][_0x349797(0xa33)];else{if(String(_0x214428[_0x349797(0x5d9)])[_0x349797(0xb6c)](_0x349797(0x8b8)))_0x303cc9=_0x214428[_0x349797(0x1211)]||_0x349797(0x7a6);else{const _0x45864f=_0x5de8b7[_0x349797(0x737)][_0x214428[_0x349797(0x5d9)]];_0x303cc9=_0x45864f?_0x45864f[_0x349797(0x278)]:_0x349797(0x69f);}}if(_0x214428[_0x349797(0x5d9)]===_0x2eb2c8)_0x303cc9+=_0x349797(0x10ea);let _0x1103ae;if(_0x214428[_0x349797(0xa20)]==='repost'){const _0x56c2b0=_0x214428[_0x349797(0x12a3)]?_0x349797(0x942)+_0x214428[_0x349797(0x12a3)]+'\x22':'';let _0x45f2db=_0x349797(0x5fe);const _0x3bd764=_0x214428[_0x349797(0xdd1)][_0x349797(0x5d9)];if(_0x3bd764===_0x349797(0x21c))_0x45f2db=_0x5de8b7[_0x349797(0x1c5)][_0x349797(0xa33)];else _0x5de8b7[_0x349797(0x737)][_0x3bd764]&&(_0x45f2db=_0x5de8b7[_0x349797(0x737)][_0x3bd764][_0x349797(0x278)]);let _0x26347d;const _0x387d64=_0x214428[_0x349797(0xdd1)];if(_0x387d64[_0x349797(0xa20)]==='text_image')_0x26347d=_0x349797(0x638)+(_0x387d64[_0x349797(0x12aa)]||'')+'\x20(图片描述:\x20\x22'+(_0x387d64['hiddenContent']||'')['substring'](0x0,0x28)+_0x349797(0x6ad);else _0x387d64[_0x349797(0xa20)]===_0x349797(0x332)?_0x26347d=_0x349797(0x280)+(_0x387d64[_0x349797(0x12aa)]||'')+_0x349797(0x981)+(_0x387d64[_0x349797(0x6b6)]||'')[_0x349797(0x8d4)](0x0,0x28)+_0x349797(0x6ad):_0x26347d='\x22'+(_0x387d64[_0x349797(0x9a5)]||'')[_0x349797(0x8d4)](0x0,0x28)+_0x349797(0x115b);_0x1103ae=_0x349797(0x8d7)+_0x45f2db+_0x349797(0xc93)+_0x56c2b0+_0x349797(0xb38)+_0x26347d+'】';}else{if(_0x214428[_0x349797(0xa20)]==='text_image')_0x1103ae=(_0x349797(0x3f3)+_0x214428['hiddenContent']+'\x22]\x20'+(_0x214428['publicText']||''))[_0x349797(0x8d4)](0x0,0x32)+_0x349797(0x6cb);else{if(_0x214428[_0x349797(0xa20)]===_0x349797(0x332))_0x1103ae=(_0x349797(0x302)+_0x214428[_0x349797(0x6b6)]+_0x349797(0x4dc)+(_0x214428[_0x349797(0x12aa)]||''))[_0x349797(0x8d4)](0x0,0x32)+_0x349797(0x6cb);else{if(_0x214428['type']===_0x349797(0xcb1)&&_0x214428[_0x349797(0x196)]){const _0x35ca1d=Array[_0x349797(0xb7b)](_0x214428[_0x349797(0x196)])?_0x214428[_0x349797(0x196)]:[_0x214428[_0x349797(0x196)]];_0x1103ae=(_0x214428[_0x349797(0x12aa)]||'')+(_0x349797(0x83c)+_0x35ca1d['length']+_0x349797(0x1207)+_0x35ca1d[_0x349797(0xa4b)](',\x20')+']');}else _0x1103ae=String(_0x214428[_0x349797(0x12aa)]||_0x214428['content']||_0x349797(0x681))[_0x349797(0x8d4)](0x0,0x32)+'...';}}}_0x4c8734+=_0x349797(0x1161)+_0x214428['id']+')\x20作者:\x20'+_0x303cc9+_0x349797(0x12b4)+_0x1103ae+'\x22\x0a';if(_0x214428[_0x349797(0x1092)]&&_0x214428[_0x349797(0x1092)]['length']>0x0)for(const _0x26145a of _0x214428['comments']){if(typeof _0x26145a===_0x349797(0x537)&&_0x26145a[_0x349797(0x2ac)]){const _0x3a257c=_0x4a0eba(_0x26145a[_0x349797(0x2ac)]);let _0x3442d1=_0x26145a[_0x349797(0xb36)]?_0x349797(0x452)+_0x26145a['meaning']+'\x27]':_0x26145a[_0x349797(0x1197)];_0x26145a[_0x349797(0x2ac)]===_0xad5882?_0x4c8734+=_0x349797(0x4f6)+_0x3442d1+'\x0a':_0x4c8734+=_0x349797(0x67e)+_0x3a257c+_0x349797(0x734)+_0x26145a[_0x349797(0x2ac)]+_0x349797(0x151)+_0x3442d1+'\x0a';}}}}const _0x1b70f8=_0x1dc060['settings'][_0x349797(0xca7)]||'我';let _0x5ca4ec='',_0x400996=![];if(_0x1dc060['settings'][_0x349797(0x290)]){const _0x234982=_0x2bf068[_0x349797(0x128)](_0x383e46=>_0x383e46[_0x349797(0xba4)]===_0x349797(0x21c)&&!_0x383e46[_0x349797(0xbf5)]),_0x1af136=_0x2bf068[_0x349797(0x128)](_0x3e0acb=>_0x3e0acb[_0x349797(0xba4)]===_0x349797(0x1119)&&!_0x3e0acb[_0x349797(0xbf5)]);if(_0x234982){const _0x767027=_0x46fb0b(_0x234982[_0x349797(0x702)]);if(_0x1af136){const _0x404848=_0x46fb0b(_0x1af136[_0x349797(0x702)]);_0x5ca4ec=_0x349797(0xd67)+_0x404848+'，用户刚刚在\x20'+_0x767027+'\x20回复了你。';const _0x375889=(_0x234982[_0x349797(0x702)]-_0x1af136[_0x349797(0x702)])/(0x3e8*0x3c*0x3c);if(_0x375889>0x3){_0x400996=!![];const _0x893c1e=Math[_0x349797(0xfb1)](_0x375889/0x18);_0x5ca4ec+='\x20你们之间已经有**'+(_0x893c1e>0x0?_0x893c1e+'天':Math[_0x349797(0xfb1)](_0x375889)+'小时')+_0x349797(0x119c)+_0x4c3722+_0x349797(0x780);}}else _0x5ca4ec=_0x349797(0xdaa)+_0x767027+'。';}else _0x5ca4ec=_0x349797(0x1089);}const _0x5a6102=_0x4ffeed(_0x2eb2c8),_0x557073=_0x57277b(_0x1dc060,0x3,'hours'),_0x5ca6a2=_0x57277b(_0x1dc060,0x6,_0x349797(0x1059)),_0x4db0b8=_0x57277b(_0x1dc060,0x9,_0x349797(0x1059)),_0x1b8f03=_0x57277b(_0x1dc060,0x1,_0x349797(0xb95)),_0x463936=_0x57277b(_0x1dc060,0x3,_0x349797(0xb95)),_0x349ce7=_0x57277b(_0x1dc060,0x7,_0x349797(0xb95));let _0x566b75='';if(_0x557073||_0x5ca6a2||_0x4db0b8||_0x1b8f03||_0x463936||_0x349ce7){_0x566b75+=_0x349797(0xc91);if(_0x557073)_0x566b75+=_0x557073;if(_0x5ca6a2)_0x566b75+=_0x5ca6a2;if(_0x4db0b8)_0x566b75+=_0x4db0b8;if(_0x557073||_0x5ca6a2||_0x4db0b8)_0x566b75+='\x0a';if(_0x1b8f03)_0x566b75+=_0x1b8f03;if(_0x463936)_0x566b75+=_0x463936;if(_0x349ce7)_0x566b75+=_0x349ce7;}_0x33a578='\x0a#\x20身份与核心任务\x0a你正在扮演角色“'+_0x1dc060[_0x349797(0x697)]+'”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-10条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a2.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a3.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性，尽量让你的表情丰富多样，避免重复。。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20你的角色设定\x0a你必须严格遵守'+_0x1dc060[_0x349797(0x761)][_0x349797(0x8d5)]+'\x0a'+_0x5df71b+_0x349797(0x6c2)+_0x1dc060[_0x349797(0x761)]['myPersona']+_0x349797(0xb89)+(_0x1dc060[_0x349797(0x761)][_0x349797(0x290)]?_0x349797(0x10a4)+_0x1611c4+'\x20('+_0x4c3722+')':'')+'\x0a'+_0x5ca4ec+_0x349797(0x180)+_0xf065f6+'\x0a'+_0x586632+'\x0a#\x20长期记忆\x20(必须严格遵守)\x0a'+(_0x1dc060['longTermMemory']&&_0x1dc060[_0x349797(0xe21)][_0x349797(0x594)]>0x0?_0x1dc060[_0x349797(0xe21)]['map'](_0x1aaebe=>'-\x20'+_0x1aaebe[_0x349797(0x9a5)])[_0x349797(0xa4b)]('\x0a'):_0x349797(0x12cc))+'\x0a'+_0x566b75+'\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22'+_0x1dc060[_0x349797(0x697)]+_0x349797(0x9fa)+_0x1dc060[_0x349797(0x278)]+_0x349797(0x11d4)+_0x1b70f8+'”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20'+_0x241eac+'\x0a\x20\x20\x20\x20'+_0x11f04f+_0x349797(0xa01)+_0xcb651b+'\x0a'+_0x3be9e2+'\x0a'+_0x87589e+_0x349797(0x4c8)+_0x7c0566+'\x0a'+_0x4c8734+_0x349797(0x808)+(_0x1dc060[_0x349797(0x761)][_0x349797(0x290)]?_0x349797(0xbdb)+_0x1611c4+'\x20('+_0x4c3722+_0x349797(0xa9a):'')+_0x349797(0x2cf)+(_0x2b6859?_0x349797(0x5d7)+_0x2b6859:'你们没有在听歌。')+_0x349797(0x1cb)+(_0x5a6102?_0x349797(0xe9c)+_0x5a6102:_0x349797(0xe27))+_0x349797(0xbef)+(_0x1dc060[_0x349797(0x761)][_0x349797(0xe6d)]&&_0x1dc060[_0x349797(0x761)]['aiAvatarLibrary'][_0x349797(0x594)]>0x0?_0x1dc060['settings'][_0x349797(0xe6d)]['map'](_0x1a3d51=>'-\x20'+_0x1a3d51[_0x349797(0x278)])[_0x349797(0xa4b)]('\x0a'):_0x349797(0x3a7))+_0x349797(0x6fa)+(_0x1dc060['settings']['myAvatarLibrary']&&_0x1dc060[_0x349797(0x761)][_0x349797(0xdc3)][_0x349797(0x594)]>0x0?_0x1dc060[_0x349797(0x761)][_0x349797(0xdc3)]['map'](_0xad9bd5=>'-\x20'+_0xad9bd5['name'])[_0x349797(0xa4b)]('\x0a'):_0x349797(0x3a7))+_0x349797(0x1a3)+_0x5fce7e+_0x349797(0x423)+(localStorage['getItem'](_0x349797(0x1153))===_0x349797(0x126d)?_0x349797(0xa7c):'')+_0x349797(0xb63)+(localStorage[_0x349797(0x728)](_0x349797(0x1153))===_0x349797(0x126d)?_0x349797(0x8cc):'')+_0x349797(0xb2b)+_0x1dc060[_0x349797(0x697)]+_0x349797(0x1241)+_0x1dc060['originalName']+_0x349797(0xe73)+_0x1dc060['originalName']+_0x349797(0xbf7)+_0x1dc060[_0x349797(0x697)]+_0x349797(0x449),_0x1f4b59=_0x2bf068[_0x349797(0x796)](_0x16ee01=>{const _0xa59830=_0x349797;if(_0x16ee01[_0xa59830(0xbf5)]&&_0x16ee01[_0xa59830(0xba4)]==='system')return{'role':_0xa59830(0x21c),'content':_0x16ee01['content']};else{if(_0x16ee01[_0xa59830(0xbf5)])return null;}if(_0x16ee01['type']===_0xa59830(0xd71)){const _0x526f14=_0x16ee01[_0xa59830(0xba4)]===_0xa59830(0x21c)?_0x1dc060['settings'][_0xa59830(0xca7)]||'我':_0x1dc060[_0xa59830(0x278)];let _0x58e018='';if(_0x16ee01[_0xa59830(0x9a5)])_0x58e018=_0x16ee01[_0xa59830(0x9a5)];else{const _0x27cdd2=_0x16ee01['dialogue']?'「'+_0x16ee01[_0xa59830(0x159)]+'」':'',_0x590573=_0x16ee01[_0xa59830(0x1029)]?'('+_0x16ee01[_0xa59830(0x1029)]+')':'';_0x58e018=(_0x27cdd2+'\x20'+_0x590573)[_0xa59830(0xeb7)]();}return{'role':_0x16ee01[_0xa59830(0xba4)],'content':'(Timestamp:\x20'+_0x16ee01[_0xa59830(0x702)]+')\x20'+_0x526f14+':\x20'+_0x58e018};}if(_0x16ee01[_0xa59830(0xba4)]===_0xa59830(0x21c)){const _0x597573=_0xa59830(0xc51)+_0x16ee01[_0xa59830(0x702)]+')\x20';let _0x41e628='';if(Array[_0xa59830(0xb7b)](_0x16ee01['content'])&&_0x16ee01[_0xa59830(0x9a5)][0x0]?.[_0xa59830(0xa20)]===_0xa59830(0x488))return{'role':_0xa59830(0x21c),'content':[{'type':_0xa59830(0x1197),'text':_0x597573},..._0x16ee01[_0xa59830(0x9a5)]]};if(_0x16ee01['quote']){const _0x1d5af6=String(_0x16ee01[_0xa59830(0xb9)][_0xa59830(0x9a5)]||'')[_0xa59830(0x8d4)](0x0,0x32);_0x41e628+=_0xa59830(0x88a)+_0x16ee01['quote'][_0xa59830(0x768)]+_0xa59830(0x94a)+_0x1d5af6+'...\x22):\x20'+_0x16ee01[_0xa59830(0x9a5)];}else _0x41e628+=_0x16ee01[_0xa59830(0x9a5)];if(_0x16ee01[_0xa59830(0xa20)]==='user_photo')return{'role':'user','content':_0x597573+'[你发送了一张需要AI识别的图片，图片内容是：\x27'+_0x16ee01[_0xa59830(0x9a5)]+'\x27]'};if(_0x16ee01[_0xa59830(0xa20)]===_0xa59830(0x719))return{'role':_0xa59830(0x21c),'content':_0x597573+_0xa59830(0xe69)+_0x16ee01[_0xa59830(0x9a5)]+'\x27]'};if(_0x16ee01[_0xa59830(0xa20)]==='transfer')return{'role':_0xa59830(0x21c),'content':_0x597573+_0xa59830(0x8c5)+_0x16ee01[_0xa59830(0x702)]+'\x20向对方发起了转账:\x20'+_0x16ee01['amount']+_0xa59830(0x6b3)+_0x16ee01[_0xa59830(0x1213)]+_0xa59830(0x515)};if(_0x16ee01[_0xa59830(0xa20)]==='waimai_request')return{'role':'user','content':_0x597573+_0xa59830(0x8c5)+_0x16ee01[_0xa59830(0x702)]+'\x20发起了外卖代付请求，商品是“'+_0x16ee01[_0xa59830(0x1253)]+'”，金额是\x20'+_0x16ee01[_0xa59830(0x354)]+_0xa59830(0x517)};else{if(_0x16ee01[_0xa59830(0xa20)]==='gift'){const _0x2d3612=_0x16ee01[_0xa59830(0x1292)][_0xa59830(0x796)](_0xca5152=>_0xca5152[_0xa59830(0x278)]+'\x20x'+_0xca5152['quantity'])['join']('、\x20');let _0xca7aa=_0x1dc060[_0xa59830(0x1244)]?_0xa59830(0x6b2)+_0x16ee01[_0xa59830(0xfae)][_0xa59830(0x796)](_0x51fe87=>_0xd9d60a(_0x1dc060,_0x51fe87))[_0xa59830(0xa4b)]('、\x20'):_0xa59830(0x6b2)+_0x1dc060['name'];return{'role':_0xa59830(0x21c),'content':_0x597573+_0xa59830(0x2a1)+_0xca7aa+_0xa59830(0x58a)+_0x2d3612+']'};}}if(_0x16ee01[_0xa59830(0xb36)])return{'role':_0xa59830(0x21c),'content':_0x597573+_0xa59830(0x1168)+_0x16ee01['meaning']+'\x27]'};return{'role':_0x16ee01['role'],'content':_0x597573+_0x41e628};}else{if(_0x16ee01[_0xa59830(0xba4)]===_0xa59830(0x1119)){let _0x347802={'type':_0x16ee01['type']||'text'};if(_0x16ee01['type']===_0xa59830(0x87b))_0x347802[_0xa59830(0x10ac)]=_0x16ee01[_0xa59830(0x9a5)],_0x347802[_0xa59830(0xb36)]=_0x16ee01[_0xa59830(0xb36)];else{if(_0x16ee01[_0xa59830(0xa20)]==='transfer')_0x347802['amount']=_0x16ee01['amount'],_0x347802['note']=_0x16ee01['note'];else _0x16ee01[_0xa59830(0xa20)]===_0xa59830(0x123b)?(_0x347802['productInfo']=_0x16ee01['productInfo'],_0x347802[_0xa59830(0x354)]=_0x16ee01[_0xa59830(0x354)]):_0x16ee01[_0xa59830(0xb9)]?_0x347802[_0xa59830(0x229)]={'target_sender':_0x16ee01[_0xa59830(0xb9)][_0xa59830(0x768)],'target_content':_0x16ee01[_0xa59830(0xb9)][_0xa59830(0x9a5)],'reply_content':_0x16ee01[_0xa59830(0x9a5)]}:_0x347802[_0xa59830(0x9a5)]=_0x16ee01['content'];}const _0x38c9be=JSON[_0xa59830(0x313)]([_0x347802]);return{'role':'assistant','content':_0xa59830(0xc51)+_0x16ee01['timestamp']+')\x20'+_0x38c9be};}}return null;})[_0x349797(0x138)](Boolean);if(!_0x1dc060['isGroup']&&_0x1dc060[_0x349797(0xa78)]?.[_0x349797(0x739)]===_0x349797(0x9f9)){const _0x170ee6=_0x1dc060[_0x349797(0x49e)][_0x349797(0x138)](_0x2a2448=>!_0x2a2448[_0x349797(0xbf5)])[_0x349797(0xa6c)](-0xa)[_0x349797(0x796)](_0x4411ab=>{const _0x2e285a=_0x349797,_0x2f26c1=_0x4411ab['role']===_0x2e285a(0x21c)?'用户':_0x1dc060[_0x2e285a(0x278)];return _0x2f26c1+':\x20'+String(_0x4411ab[_0x2e285a(0x9a5)])[_0x2e285a(0x8d4)](0x0,0x32)+_0x2e285a(0x6cb);})['join']('\x0a'),_0x374dca={'role':'user','content':_0x349797(0xe2e)+_0x1dc060['relationship'][_0x349797(0xa83)]+_0x349797(0x345)+_0x170ee6+_0x349797(0x1193)};_0x1f4b59[_0x349797(0xf5)](_0x374dca);}}}let _0x1ac25f=_0x497901===GEMINI_API_URL,_0x4647d0=_0x4a90fe(_0x49c757,_0x51a46c,_0x33a578,_0x1f4b59),_0x2ae72a;try{_0x2ae72a=_0x1ac25f?await fetch(_0x4647d0[_0x349797(0x10ac)],_0x4647d0['data']):await fetch(_0x497901+_0x349797(0x8fd),{'method':'POST','headers':{'Content-Type':_0x349797(0x35c),'Authorization':'Bearer\x20'+_0x51a46c},'body':JSON[_0x349797(0x313)]({'model':_0x49c757,'messages':[{'role':_0x349797(0xf72),'content':_0x33a578},..._0x1f4b59],'temperature':_0x5de8b7[_0x349797(0x2df)]['apiTemperature']||0.8,'stream':![]})});}catch(_0x3c1852){throw new Error('网络请求失败:\x20'+_0x3c1852['message']);}if(!_0x2ae72a['ok']){let _0x205f0e=_0x349797(0x8a3)+_0x2ae72a[_0x349797(0x739)]+'\x20'+_0x2ae72a[_0x349797(0xfcf)];try{const _0x3b28ea=await _0x2ae72a[_0x349797(0xd7b)]();_0x3b28ea[_0x349797(0x1c1)]&&_0x3b28ea[_0x349797(0x1c1)][_0x349797(0x4bc)]?_0x205f0e+=_0x349797(0x12a2)+_0x3b28ea['error'][_0x349797(0x4bc)]:_0x205f0e+='\x20-\x20'+JSON[_0x349797(0x313)](_0x3b28ea);}catch(_0x30f582){_0x205f0e+=_0x349797(0x121e)+await _0x2ae72a[_0x349797(0x1197)]();}throw new Error(_0x205f0e);}const _0xa8f8dc=await _0x2ae72a[_0x349797(0xd7b)](),_0x5295cc=getGeminiResponseText(_0xa8f8dc);lastRawAiResponse=_0x5295cc,lastResponseTimestamps=[],_0x1dc060[_0x349797(0x49e)]=_0x1dc060[_0x349797(0x49e)][_0x349797(0x138)](_0x5a92ee=>!_0x5a92ee[_0x349797(0x10bc)]);const _0xe9a154=_0x30c9b6(_0x5295cc);let _0x591cca=[];if(_0x1dc060['settings'][_0x349797(0xadd)]){let _0x4afa6d={'content':[],'dialogue':[],'description':[]};for(const _0xc034ef of _0xe9a154){if(_0xc034ef[_0x349797(0xa20)]===_0x349797(0xd71)){if(_0xc034ef['content'])_0x4afa6d[_0x349797(0x9a5)][_0x349797(0xf5)](_0xc034ef['content']);else{if(_0xc034ef[_0x349797(0x159)])_0x4afa6d[_0x349797(0x159)][_0x349797(0xf5)](_0xc034ef[_0x349797(0x159)]);if(_0xc034ef[_0x349797(0x1029)])_0x4afa6d[_0x349797(0x1029)][_0x349797(0xf5)](_0xc034ef[_0x349797(0x1029)]);}}else(_0x4afa6d[_0x349797(0x9a5)][_0x349797(0x594)]>0x0||_0x4afa6d[_0x349797(0x159)][_0x349797(0x594)]>0x0||_0x4afa6d[_0x349797(0x1029)][_0x349797(0x594)]>0x0)&&(_0x4afa6d[_0x349797(0x9a5)][_0x349797(0x594)]>0x0&&_0x591cca[_0x349797(0xf5)]({'type':_0x349797(0xd71),'content':_0x4afa6d[_0x349797(0x9a5)][_0x349797(0xa4b)]('\x0a')}),(_0x4afa6d[_0x349797(0x159)]['length']>0x0||_0x4afa6d[_0x349797(0x1029)][_0x349797(0x594)]>0x0)&&_0x591cca[_0x349797(0xf5)]({'type':_0x349797(0xd71),'dialogue':_0x4afa6d[_0x349797(0x159)]['join']('\x0a'),'description':_0x4afa6d['description']['join']('\x0a')}),_0x4afa6d={'content':[],'dialogue':[],'description':[]}),_0x591cca['push'](_0xc034ef);}_0x4afa6d[_0x349797(0x9a5)][_0x349797(0x594)]>0x0&&_0x591cca['push']({'type':_0x349797(0xd71),'content':_0x4afa6d[_0x349797(0x9a5)][_0x349797(0xa4b)]('\x0a')}),(_0x4afa6d[_0x349797(0x159)][_0x349797(0x594)]>0x0||_0x4afa6d[_0x349797(0x1029)]['length']>0x0)&&_0x591cca['push']({'type':_0x349797(0xd71),'dialogue':_0x4afa6d[_0x349797(0x159)][_0x349797(0xa4b)]('\x0a'),'description':_0x4afa6d[_0x349797(0x1029)]['join']('\x0a')});}else _0x591cca=_0xe9a154;const _0x1c2df0=_0x1dc060[_0x349797(0x49e)]['filter'](_0x2aa3e4=>_0x2aa3e4[_0x349797(0xba4)]===_0x349797(0x21c)&&!_0x2aa3e4['isHidden'])[_0x349797(0x647)]();if(_0x1c2df0&&Array[_0x349797(0xb7b)](_0x1c2df0[_0x349797(0x9a5)])&&_0x1c2df0['content'][0x0]?.[_0x349797(0xa20)]==='image_url'&&!_0x1c2df0['imageProcessed']){const _0x1d2e20=_0xe9a154[_0x349797(0xe79)](_0x5ead50=>_0x5ead50['type']===_0x349797(0x1197));let _0x500940;_0x1d2e20&&(_0x1d2e20[_0x349797(0x9a5)]||_0x1d2e20[_0x349797(0x4bc)])?_0x500940=String(_0x1d2e20['content']||_0x1d2e20['message'])[_0x349797(0xeb7)]():_0x500940=_0x349797(0x801);const _0x4a437b=_0x1dc060[_0x349797(0x49e)][_0x349797(0x901)](_0x1f48da=>_0x1f48da['timestamp']===_0x1c2df0[_0x349797(0x702)]);if(_0x4a437b>-0x1){console[_0x349797(0x84b)](_0x349797(0xc1c)+_0x1c2df0[_0x349797(0x702)]+_0x349797(0xabf));const _0x5d8a46=_0x349797(0xecb)+_0x500940+'”]';_0x1dc060[_0x349797(0x49e)][_0x4a437b]['content']=_0x5d8a46,_0x1dc060[_0x349797(0x49e)][_0x4a437b][_0x349797(0x10ed)]=!![],_0x1dc060[_0x349797(0x49e)][_0x4a437b][_0x349797(0xa20)]='text';}}const _0x2d65ad=document[_0x349797(0x11e3)](_0x349797(0x9fc))[_0x349797(0x505)][_0x349797(0x1121)](_0x349797(0x1fc))&&_0x5de8b7['activeChatId']===_0x2eb2c8;let _0x105e88=![],_0x2b7943=Date[_0x349797(0x1182)](),_0x1d6fad=[],_0x5f414b=![];for(const _0xc854dd of _0x591cca){_0x1dc060[_0x349797(0x761)][_0x349797(0x444)]!==![]&&_0xc854dd[_0x349797(0xa20)]==='text'&&typeof _0xc854dd['content']===_0x349797(0x10d7)&&_0xc854dd[_0x349797(0x9a5)][_0x349797(0xeb7)]()[_0x349797(0xb6c)](_0x349797(0x68f))&&(_0xc854dd['type']='voice_message',_0xc854dd[_0x349797(0x9a5)]=_0xc854dd[_0x349797(0x9a5)][_0x349797(0x1018)]('[V]','')[_0x349797(0xeb7)]());if(_0x1dc060[_0x349797(0x1244)]&&_0xc854dd[_0x349797(0x278)]&&_0xc854dd['name']===_0x1dc060[_0x349797(0x278)]){console['error'](_0x349797(0x374)+_0x1dc060[_0x349797(0x278)]+_0x349797(0xa47),_0xc854dd);continue;}if(!_0xc854dd||typeof _0xc854dd!==_0x349797(0x537)){console[_0x349797(0x6b0)]('收到了格式不规范的AI指令，已跳过:',_0xc854dd);continue;}if(!_0xc854dd[_0x349797(0xa20)]){if(_0x1dc060[_0x349797(0x1244)]&&_0xc854dd[_0x349797(0x278)]&&_0xc854dd[_0x349797(0x4bc)])_0xc854dd[_0x349797(0xa20)]=_0x349797(0x1197);else{if(_0xc854dd[_0x349797(0x9a5)])_0xc854dd[_0x349797(0xa20)]=_0x349797(0x1197);else{console[_0x349797(0x6b0)](_0x349797(0x10b),_0xc854dd);continue;}}}if(_0xc854dd[_0x349797(0xa20)]===_0x349797(0xe4b)){_0x46751e[_0x349797(0x1d6)]=![];if(_0xc854dd[_0x349797(0xf98)]==='accept')_0x3df367();else{const _0x518386={'role':_0x349797(0x1119),'content':'对方拒绝了你的视频通话请求。','timestamp':Date[_0x349797(0x1182)]()};_0x1dc060['history'][_0x349797(0xf5)](_0x518386),await _0x2e83f8['chats']['put'](_0x1dc060),_0x4e7698(_0x349797(0x9fc)),_0x544ab5(_0x2eb2c8);}_0x105e88=!![];break;}if(_0xc854dd['type']==='group_call_response'){if(_0xc854dd[_0x349797(0xf98)]===_0x349797(0xa4b)){const _0x3ca3e5=_0x1dc060['members']['find'](_0x16619a=>_0x16619a['originalName']===_0xc854dd[_0x349797(0x278)]);_0x3ca3e5&&!_0x46751e[_0x349797(0x94b)][_0x349797(0xe7c)](_0x394f15=>_0x394f15['id']===_0x3ca3e5['id'])&&_0x46751e[_0x349797(0x94b)][_0x349797(0xf5)](_0x3ca3e5);}_0x105e88=!![];continue;}if(_0x1dc060['isGroup']&&_0xc854dd[_0x349797(0x278)]&&_0xc854dd[_0x349797(0x278)]===_0x1dc060[_0x349797(0x278)]){console[_0x349797(0x1c1)](_0x349797(0x374)+_0x1dc060[_0x349797(0x278)]+_0x349797(0xa47),_0xc854dd);continue;}if(_0x1dc060[_0x349797(0x1244)]&&!_0xc854dd['name']){console[_0x349797(0x1c1)](_0x349797(0x935),_0xc854dd);continue;}let _0xb6f05f=null;const _0x5d6ea5=_0x2b7943++,_0x41d06f={'role':'assistant','senderName':_0xc854dd[_0x349797(0x278)]||_0x1dc060['name'],'timestamp':_0x5d6ea5};lastResponseTimestamps[_0x349797(0xf5)](_0x5d6ea5);switch(_0xc854dd['type']){case _0x349797(0x98f):if(!_0x1dc060[_0x349797(0x1244)]){_0xc854dd[_0x349797(0x114d)]&&(_0x1dc060[_0x349797(0x535)]=String(_0xc854dd[_0x349797(0x114d)]));_0xc854dd['random_jottings']&&(_0x1dc060[_0x349797(0x267)]=String(_0xc854dd['random_jottings']));!Array[_0x349797(0xb7b)](_0x1dc060['thoughtsHistory'])&&(_0x1dc060[_0x349797(0x6d3)]=[]);_0x1dc060['thoughtsHistory'][_0x349797(0xf5)]({'heartfeltVoice':_0x1dc060['heartfeltVoice'],'randomJottings':_0x1dc060[_0x349797(0x267)],'timestamp':Date[_0x349797(0x1182)]()});_0x1dc060[_0x349797(0x6d3)][_0x349797(0x594)]>0x32&&_0x1dc060[_0x349797(0x6d3)]['shift']();const _0x2f1376='[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20'+_0x1dc060[_0x349797(0x535)]+'\x0a-\x20散记:\x20'+_0x1dc060[_0x349797(0x267)],_0x77025b={'role':'system','content':_0x2f1376,'timestamp':Date[_0x349797(0x1182)](),'isHidden':!![]};}continue;case _0x349797(0x1006):if(!_0x1dc060[_0x349797(0x1244)]&&_0xc854dd['new_name']){const _0x38f4c6=_0xc854dd[_0x349797(0xeae)]['trim']();if(_0x38f4c6){_0x1dc060[_0x349797(0x761)][_0x349797(0xca7)]=_0x38f4c6;const _0x98335e={'role':'system','type':_0x349797(0x8ee),'content':'“'+_0x1dc060[_0x349797(0x278)]+_0x349797(0x107f)+_0x38f4c6+'”','timestamp':_0x2b7943++};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x98335e);const _0x38134d={'role':_0x349797(0xf72),'content':'[系统提示：你刚刚成功将对用户的称呼修改为了“'+_0x38f4c6+_0x349797(0x1245),'timestamp':_0x2b7943++,'isHidden':!![]};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x38134d),_0x2d65ad&&_0x3b5153(_0x98335e,_0x1dc060);}}continue;case _0x349797(0x533):if(!_0x1dc060['isGroup']&&_0xc854dd[_0x349797(0xeae)]){const _0x588748=_0x1dc060[_0x349797(0x278)],_0x49a4bf=_0xc854dd[_0x349797(0xeae)]['trim']();if(_0x49a4bf&&_0x49a4bf!==_0x588748){!_0x1dc060[_0x349797(0x3d7)]&&(_0x1dc060[_0x349797(0x3d7)]=[]);!_0x1dc060[_0x349797(0x3d7)][_0x349797(0x3ad)](_0x588748)&&_0x1dc060[_0x349797(0x3d7)]['push'](_0x588748);_0x1dc060[_0x349797(0x278)]=_0x49a4bf;const _0x10aa79={'role':_0x349797(0xf72),'type':_0x349797(0x8ee),'content':'“'+_0x1dc060[_0x349797(0x697)]+_0x349797(0x6aa)+_0x49a4bf+'”','timestamp':_0x2b7943++};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x10aa79);const _0x74f2d={'role':_0x349797(0xf72),'content':_0x349797(0x432)+_0x49a4bf+_0x349797(0x4e7),'timestamp':_0x2b7943++,'isHidden':!![]};_0x1dc060[_0x349797(0x49e)]['push'](_0x74f2d),_0x2d65ad&&(_0x3b5153(_0x10aa79,_0x1dc060),document['getElementById'](_0x349797(0x1205))['textContent']=_0x49a4bf),await _0xead3(_0x1dc060);}}continue;case _0x349797(0xcb2):{const _0x51d552=_0xc854dd[_0x349797(0x278)],_0x599458=_0x1dc060[_0x349797(0x761)][_0x349797(0xe6d)][_0x349797(0xe79)](_0x35d161=>_0x35d161[_0x349797(0x278)]===_0x51d552);if(_0x599458){_0x1dc060[_0x349797(0x761)][_0x349797(0x5e0)]=_0x599458['url'];const _0x353d54={'role':_0x349797(0xf72),'type':_0x349797(0x8ee),'content':'['+_0x1dc060[_0x349797(0x278)]+_0x349797(0x130),'timestamp':Date[_0x349797(0x1182)]()};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x353d54),await _0x46ae3e(_0x1dc060),_0x2d65ad&&(_0x3b5153(_0x353d54,_0x1dc060),_0x544ab5(_0x2eb2c8));}continue;}case _0x349797(0xf60):{const _0x1fff97=_0xc854dd[_0x349797(0x278)],_0x49eed0=_0x1dc060[_0x349797(0x761)][_0x349797(0xdc3)][_0x349797(0xe79)](_0x14f632=>_0x14f632[_0x349797(0x278)]===_0x1fff97);if(_0x49eed0){_0x1dc060[_0x349797(0x761)][_0x349797(0xc43)]=_0x49eed0[_0x349797(0x10ac)];const _0x3898a5={'role':_0x349797(0xf72),'type':'pat_message','content':'['+_0x1dc060[_0x349797(0x278)]+'\x20更换了你的头像]','timestamp':Date[_0x349797(0x1182)]()};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x3898a5),_0x2d65ad&&(_0x3b5153(_0x3898a5,_0x1dc060),_0x544ab5(_0x2eb2c8));}continue;}case _0x349797(0x9a7):{const _0x3fc943=parseInt(_0xc854dd['x']),_0x125cf1=parseInt(_0xc854dd['y']);!isNaN(_0x3fc943)&&!isNaN(_0x125cf1)?_0x416bbd({'x':_0x3fc943,'y':_0x125cf1}):console['warn'](_0x349797(0x52b),_0xc854dd);continue;}case _0x349797(0x8a7):const _0x4b489b=_0x1dc060[_0x349797(0x49e)]['findIndex'](_0x2f2a18=>_0x2f2a18['timestamp']===_0xc854dd[_0x349797(0x5e9)]);if(_0x4b489b>-0x1){const _0x2deb2b=_0x1dc060[_0x349797(0x49e)][_0x4b489b];_0x2deb2b[_0x349797(0x739)]=_0xc854dd[_0x349797(0x739)],_0x2deb2b[_0x349797(0xad8)]=_0xc854dd[_0x349797(0x739)]===_0x349797(0xa42)?_0xc854dd[_0x349797(0x278)]:null;}continue;case _0x349797(0x3cc):const _0x59919c={'type':_0xc854dd[_0x349797(0x7f8)],'content':_0xc854dd[_0x349797(0x9a5)]||'','publicText':_0xc854dd[_0x349797(0x12aa)]||'','hiddenContent':_0xc854dd[_0x349797(0x6f7)]||'','image_prompt':_0xc854dd[_0x349797(0xee6)]||'','timestamp':Date[_0x349797(0x1182)](),'authorId':_0x2eb2c8,'authorGroupId':_0x1dc060['groupId'],'visibleGroupIds':null};if(_0xc854dd[_0x349797(0x7f8)]===_0x349797(0xcb1)&&_0xc854dd[_0x349797(0x196)])try{const _0x571261=Array[_0x349797(0xb7b)](_0xc854dd[_0x349797(0x196)])?_0xc854dd['prompt']['slice'](0x0,0x2):[_0xc854dd[_0x349797(0x196)]];console[_0x349797(0x84b)]('📸\x20动态NovelAI图片生成开始，共'+_0x571261['length']+_0x349797(0xff4));const _0x4451e2=[];for(let _0x404bc9=0x0;_0x404bc9<_0x571261[_0x349797(0x594)];_0x404bc9++){const _0x12a07d=_0x571261[_0x404bc9];console[_0x349797(0x84b)](_0x349797(0xc7b)+(_0x404bc9+0x1)+_0x349797(0x1c2),_0x12a07d);const _0x749379=_0x419515(_0x1dc060['id']),_0x1a30a1=_0x12a07d+',\x20'+_0x749379[_0x349797(0x634)],_0x587d87=_0x749379['negative'];console[_0x349797(0x84b)](_0x349797(0x71c)+(_0x749379[_0x349797(0x1275)]===_0x349797(0x12e7)?_0x349797(0x10fd):'系统')+_0x349797(0x86b)),console['log'](_0x349797(0x725),_0x1a30a1),console[_0x349797(0x84b)]('最终负面提示词:',_0x587d87);const _0x5631bd=localStorage['getItem']('novelai-api-key'),_0x450311=localStorage[_0x349797(0x728)]('novelai-model')||_0x349797(0x12d8),_0x342726=_0x3a7337();if(!_0x5631bd)throw new Error(_0x349797(0x3a5));const [_0x2e55dc,_0x3d643e]=_0x342726[_0x349797(0x673)][_0x349797(0x65b)]('x')['map'](Number);let _0x5337e7;_0x450311[_0x349797(0x3ad)]('nai-diffusion-4')?_0x5337e7={'input':_0x1a30a1,'model':_0x450311,'action':'generate','parameters':{'params_version':0x3,'width':_0x2e55dc,'height':_0x3d643e,'scale':_0x342726[_0x349797(0x4c0)],'sampler':_0x342726['sampler'],'steps':_0x342726[_0x349797(0xf20)],'seed':_0x342726[_0x349797(0x1073)]===-0x1?Math[_0x349797(0xfb1)](Math[_0x349797(0x36d)]()*0x2540be3ff):_0x342726[_0x349797(0x1073)],'n_samples':0x1,'ucPreset':_0x342726[_0x349797(0x500)],'qualityToggle':_0x342726[_0x349797(0x4ad)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x349797(0x1078),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x1a30a1,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x587d87,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x587d87,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x5337e7={'input':_0x1a30a1,'model':_0x450311,'action':_0x349797(0x12a1),'parameters':{'width':_0x2e55dc,'height':_0x3d643e,'scale':_0x342726[_0x349797(0x4c0)],'sampler':_0x342726[_0x349797(0x5c7)],'steps':_0x342726[_0x349797(0xf20)],'seed':_0x342726['seed']===-0x1?Math['floor'](Math[_0x349797(0x36d)]()*0x2540be3ff):_0x342726[_0x349797(0x1073)],'n_samples':0x1,'ucPreset':_0x342726[_0x349797(0x500)],'qualityToggle':_0x342726[_0x349797(0x4ad)],'sm':_0x342726['smea'],'sm_dyn':_0x342726[_0x349797(0x12e0)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x349797(0xf07),'negative_prompt':_0x587d87}};console[_0x349797(0x84b)](_0x349797(0x12f5),_0x5337e7);let _0x500fe8;_0x450311['includes'](_0x349797(0xb6a))?_0x500fe8=_0x349797(0x6e6):_0x500fe8=_0x349797(0x1114);let _0xeb5a38=_0x342726[_0x349797(0x9e2)];_0xeb5a38==='custom'&&(_0xeb5a38=_0x342726[_0x349797(0x871)]||'');_0xeb5a38&&_0xeb5a38!==''&&(_0x500fe8=_0xeb5a38+encodeURIComponent(_0x500fe8));const _0x19b1de=await fetch(_0x500fe8,{'method':_0x349797(0x1128),'headers':{'Content-Type':_0x349797(0x35c),'Authorization':_0x349797(0xdaf)+_0x5631bd},'body':JSON['stringify'](_0x5337e7)});console[_0x349797(0x84b)](_0x349797(0x441),_0x19b1de[_0x349797(0x739)]),console[_0x349797(0x84b)](_0x349797(0x7aa),[..._0x19b1de['headers'][_0x349797(0x560)]()]);if(!_0x19b1de['ok']){const _0x3243e8=await _0x19b1de[_0x349797(0x1197)]();console['error']('API错误响应:',_0x3243e8);throw new Error(_0x349797(0x4e0)+_0x19b1de[_0x349797(0x739)]+_0x349797(0x151)+_0x3243e8);}const _0x2ea2f3=_0x19b1de[_0x349797(0x2b1)]['get']('content-type');console[_0x349797(0x84b)]('Content-Type:',_0x2ea2f3);let _0x468fcb,_0x25cbd6;if(_0x2ea2f3&&_0x2ea2f3[_0x349797(0x3ad)](_0x349797(0xa37))){console[_0x349797(0x84b)]('检测到\x20SSE\x20流式响应，开始解析...');const _0x115df0=await _0x19b1de[_0x349797(0x1197)]();console['log'](_0x349797(0xe7),_0x115df0[_0x349797(0x594)]);const _0x353878=_0x115df0[_0x349797(0xeb7)]()[_0x349797(0x65b)]('\x0a');let _0x37c9d2=null;for(let _0x1917b6=_0x353878['length']-0x1;_0x1917b6>=0x0;_0x1917b6--){const _0x373066=_0x353878[_0x1917b6][_0x349797(0xeb7)]();if(_0x373066[_0x349797(0xb6c)](_0x349797(0x106e))&&_0x373066!==_0x349797(0x7ea)){const _0x4aa8e2=_0x373066['substring'](0x6);try{const _0x524b48=JSON[_0x349797(0xb0c)](_0x4aa8e2);if(_0x524b48[_0x349797(0x55a)]===_0x349797(0x10b1)&&_0x524b48[_0x349797(0x6e9)]){_0x37c9d2=_0x524b48['image'],console['log'](_0x349797(0x629));break;}if(_0x524b48[_0x349797(0x1cc)]){_0x37c9d2=_0x524b48[_0x349797(0x1cc)],console[_0x349797(0x84b)](_0x349797(0x814));break;}if(_0x524b48[_0x349797(0x6e9)]){_0x37c9d2=_0x524b48[_0x349797(0x6e9)],console['log'](_0x349797(0xf37));break;}}catch(_0x584817){_0x37c9d2=_0x4aa8e2,console[_0x349797(0x84b)](_0x349797(0xb3c));break;}}}if(!_0x37c9d2)throw new Error('无法从\x20SSE\x20响应中提取图片数据');const _0x77bac5=_0x37c9d2[_0x349797(0xb6c)](_0x349797(0x6c1)),_0x3234bf=_0x37c9d2[_0x349797(0xb6c)](_0x349797(0x60f));if(_0x77bac5||_0x3234bf){console[_0x349797(0x84b)](_0x349797(0x958));const _0x31ef38=atob(_0x37c9d2),_0x2441c7=new Uint8Array(_0x31ef38[_0x349797(0x594)]);for(let _0x4e00ca=0x0;_0x4e00ca<_0x31ef38[_0x349797(0x594)];_0x4e00ca++){_0x2441c7[_0x4e00ca]=_0x31ef38['charCodeAt'](_0x4e00ca);}const _0x153fdd=new Blob([_0x2441c7],{'type':_0x77bac5?_0x349797(0x12f6):_0x349797(0xc78)});console[_0x349797(0x84b)]('图片\x20Blob\x20创建成功，大小:',_0x153fdd[_0x349797(0x1159)]);const _0x4c65cc=new FileReader();_0x25cbd6=await new Promise((_0x42837d,_0x15674b)=>{const _0x522d03=_0x349797;_0x4c65cc[_0x522d03(0xbd8)]=()=>_0x42837d(_0x4c65cc['result']),_0x4c65cc[_0x522d03(0x741)]=_0x15674b,_0x4c65cc[_0x522d03(0x1270)](_0x153fdd);}),console[_0x349797(0x84b)](_0x349797(0x35f));}else{console['log'](_0x349797(0x122f));const _0x48db4c=atob(_0x37c9d2),_0x148319=new Uint8Array(_0x48db4c[_0x349797(0x594)]);for(let _0x74e786=0x0;_0x74e786<_0x48db4c[_0x349797(0x594)];_0x74e786++){_0x148319[_0x74e786]=_0x48db4c[_0x349797(0x5f0)](_0x74e786);}_0x468fcb=new Blob([_0x148319]),console[_0x349797(0x84b)](_0x349797(0x102b),_0x468fcb['size']);}}else _0x468fcb=await _0x19b1de[_0x349797(0xccb)](),console[_0x349797(0x84b)](_0x349797(0x1d4),_0x468fcb[_0x349797(0xa20)],'大小:',_0x468fcb[_0x349797(0x1159)]);if(!_0x25cbd6&&_0x468fcb)try{if(typeof JSZip===_0x349797(0x679))throw new Error(_0x349797(0x7b0));const _0x303ba9=await JSZip[_0x349797(0x79c)](_0x468fcb);console['log'](_0x349797(0x7de),Object[_0x349797(0xb4a)](_0x303ba9[_0x349797(0x5c9)]));let _0x1672ca=null;for(let _0x5682ab in _0x303ba9[_0x349797(0x5c9)]){if(_0x5682ab[_0x349797(0xe9f)](/\.(png|jpg|jpeg|webp)$/i)){_0x1672ca=_0x303ba9['files'][_0x5682ab],console[_0x349797(0x84b)](_0x349797(0x819),_0x5682ab);break;}}if(!_0x1672ca)throw new Error(_0x349797(0xdbe));const _0x2f85c1=await _0x1672ca['async'](_0x349797(0xccb));console['log']('提取的图片大小:',_0x2f85c1[_0x349797(0x1159)]);const _0xcd9846=new FileReader();_0x25cbd6=await new Promise((_0x566168,_0x29ca09)=>{const _0x37da3f=_0x349797;_0xcd9846[_0x37da3f(0xbd8)]=()=>_0x566168(_0xcd9846['result']),_0xcd9846[_0x37da3f(0x741)]=_0x29ca09,_0xcd9846[_0x37da3f(0x1270)](_0x2f85c1);}),console['log'](_0x349797(0x820));}catch(_0x6ade6a){console[_0x349797(0x1c1)]('ZIP解压失败:',_0x6ade6a);throw new Error(_0x349797(0xf14)+_0x6ade6a[_0x349797(0x4bc)]);}console[_0x349797(0x84b)](_0x349797(0xd75)+(_0x404bc9+0x1)+_0x349797(0x669)),_0x4451e2[_0x349797(0xf5)](_0x25cbd6);}_0x59919c[_0x349797(0x224)]=_0x4451e2,_0x4451e2[_0x349797(0x594)]===0x1&&(_0x59919c[_0x349797(0xf44)]=_0x4451e2[0x0]),_0x59919c[_0x349797(0x196)]=_0xc854dd['prompt'],_0x59919c[_0x349797(0x6d0)]=_0x4451e2[_0x349797(0x594)],console[_0x349797(0x84b)]('✅\x20动态NovelAI图片全部生成完成:\x20'+_0x4451e2['length']+'张');}catch(_0x334aff){console[_0x349797(0x1c1)](_0x349797(0xd44),_0x334aff),_0x59919c[_0x349797(0x9a5)]=(_0x59919c[_0x349797(0x9a5)]||_0x59919c[_0x349797(0x12aa)]||'')+('\x0a[图片生成失败:\x20'+_0x334aff[_0x349797(0x4bc)]+']');}await _0x2e83f8[_0x349797(0x1218)][_0x349797(0x252)](_0x59919c),_0x22db5e(_0x481a45+0x1);_0x2d65ad&&document[_0x349797(0x11e3)]('qzone-screen')[_0x349797(0x505)]['contains'](_0x349797(0x1fc))&&await _0xae9c28();continue;case _0x349797(0xfe9):{const _0x6e7163=await _0x2e83f8[_0x349797(0x1218)][_0x349797(0x1289)](parseInt(_0xc854dd[_0x349797(0x2f0)]));if(_0x6e7163){if(!_0x6e7163[_0x349797(0x1092)])_0x6e7163[_0x349797(0x1092)]=[];const _0x234865=_0xc854dd[_0x349797(0x278)]||_0x1dc060[_0x349797(0x697)],_0x1c07f5=(_0x54d9c0,_0x48c974=null,_0x2b7093=null)=>({'commenterName':_0x234865,'text':_0x33faa3(_0x54d9c0,_0x1dc060),'meaning':_0x48c974,'replyTo':_0x2b7093,'timestamp':Date[_0x349797(0x1182)]()});if(_0xc854dd[_0x349797(0x6f0)]){const _0x12d14e=_0x5de8b7[_0x349797(0xa67)][_0x349797(0xe79)](_0x311b4b=>_0x311b4b[_0x349797(0x278)]===_0xc854dd['stickerMeaning']);_0x12d14e?_0x6e7163[_0x349797(0x1092)]['push'](_0x1c07f5(_0x12d14e[_0x349797(0x10ac)],_0x12d14e[_0x349797(0x278)],_0xc854dd[_0x349797(0x1083)]||null)):(console[_0x349797(0x6b0)](_0x349797(0xe3d)+_0xc854dd[_0x349797(0x6f0)]+'\x22'),_0x6e7163[_0x349797(0x1092)]['push'](_0x1c07f5(_0x349797(0x119f)+_0xc854dd[_0x349797(0x6f0)]+']',null,_0xc854dd[_0x349797(0x1083)]||null)));}else{if(Array[_0x349797(0xb7b)](_0xc854dd[_0x349797(0x1092)]))_0xc854dd[_0x349797(0x1092)]['forEach'](_0x228136=>{const _0x50d600=_0x349797;typeof _0x228136===_0x50d600(0x10d7)&&_0x228136[_0x50d600(0xeb7)]()&&_0x6e7163[_0x50d600(0x1092)][_0x50d600(0xf5)](_0x1c07f5(_0x228136,null,_0xc854dd['replyTo']||null));});else typeof _0xc854dd[_0x349797(0x538)]===_0x349797(0x10d7)&&_0xc854dd['commentText'][_0x349797(0xeb7)]()&&_0x6e7163[_0x349797(0x1092)][_0x349797(0xf5)](_0x1c07f5(_0xc854dd[_0x349797(0x538)],null,_0xc854dd[_0x349797(0x1083)]||null));}await _0x2e83f8['qzonePosts'][_0x349797(0x1225)](_0x6e7163['id'],{'comments':_0x6e7163[_0x349797(0x1092)]}),_0x22db5e(_0x481a45+0x1),console[_0x349797(0x84b)]('后台活动:\x20角色\x20\x22'+_0x1dc060[_0x349797(0x278)]+'\x22\x20评论了动态\x20#'+_0xc854dd[_0x349797(0x2f0)]);if(!_0x1dc060[_0x349797(0xaf4)])_0x1dc060[_0x349797(0xaf4)]={};_0x1dc060[_0x349797(0xaf4)][_0xc854dd['postId']]=Date[_0x349797(0x1182)]();}continue;}case _0x349797(0x10a2):const _0x158d9f=await _0x2e83f8[_0x349797(0x1218)][_0x349797(0x1289)](parseInt(_0xc854dd[_0x349797(0x2f0)]));if(_0x158d9f){if(!_0x158d9f['likes'])_0x158d9f['likes']=[];!_0x158d9f[_0x349797(0x7eb)]['includes'](_0x1dc060[_0x349797(0x278)])&&(_0x158d9f[_0x349797(0x7eb)][_0x349797(0xf5)](_0x1dc060['name']),await _0x2e83f8[_0x349797(0x1218)][_0x349797(0x1225)](_0x158d9f['id'],{'likes':_0x158d9f[_0x349797(0x7eb)]}),_0x22db5e(_0x481a45+0x1),_0x2d65ad&&document[_0x349797(0x11e3)](_0x349797(0x431))[_0x349797(0x505)]['contains']('active')&&await _0xae9c28());}continue;case _0x349797(0x45a):{const _0x2000b5=await _0x2e83f8[_0x349797(0x1218)][_0x349797(0x1289)](parseInt(_0xc854dd[_0x349797(0x2f0)]));if(_0x2000b5){const _0x60786f={'type':_0x349797(0x45a),'timestamp':Date[_0x349797(0x1182)](),'authorId':_0x2eb2c8,'authorGroupId':_0x1dc060[_0x349797(0xe0d)],'repostComment':_0xc854dd['comment']||'','originalPost':_0x2000b5,'visibleGroupIds':null};await _0x2e83f8['qzonePosts'][_0x349797(0x252)](_0x60786f),_0x22db5e(_0x481a45+0x1),console[_0x349797(0x84b)](_0x349797(0xc46)+_0x1dc060['name']+_0x349797(0xa8b)+_0xc854dd[_0x349797(0x2f0)]);}continue;}case _0x349797(0x481):!_0x46751e[_0x349797(0x3d5)]&&!_0x46751e[_0x349797(0x1d6)]&&(_0x5de8b7[_0x349797(0x93d)]=_0x2eb2c8,_0x46751e[_0x349797(0x93d)]=_0x2eb2c8,_0x46751e[_0x349797(0x1d6)]=!![],_0x46751e[_0x349797(0x419)]=_0x1dc060[_0x349797(0x1244)],_0x46751e['callRequester']=_0xc854dd['name']||_0x1dc060[_0x349797(0x278)],_0x3f7dd2());continue;case _0x349797(0xb08):!_0x46751e[_0x349797(0x3d5)]&&!_0x46751e[_0x349797(0x1d6)]&&(_0x5de8b7[_0x349797(0x93d)]=_0x2eb2c8,_0x46751e[_0x349797(0x1d6)]=!![],_0x46751e[_0x349797(0x419)]=!![],_0x46751e[_0x349797(0x756)]='ai',_0x46751e[_0x349797(0x1251)]=_0xc854dd['name'],_0x3f7dd2());continue;case _0x349797(0x11ab):let _0x59fa39;if(_0x1dc060['isGroup']){const _0x2f8036=_0x1dc060['members'][_0x349797(0xe79)](_0x2ed2fc=>_0x2ed2fc['originalName']===_0xc854dd['name']);_0x59fa39=_0x2f8036?_0x2f8036[_0x349797(0xc8f)]:_0xc854dd['name'];}else _0x59fa39=_0x1dc060['name'];const _0x47b23e=_0xc854dd[_0x349797(0xbe8)]?'\x20'+_0xc854dd['suffix'][_0x349797(0xeb7)]():'',_0x477f57=_0x59fa39+_0x349797(0x326)+_0x47b23e,_0x180118={'role':_0x349797(0xf72),'type':_0x349797(0x8ee),'content':_0x477f57,'timestamp':Date[_0x349797(0x1182)]()};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x180118);if(_0x2d65ad){const _0x5cafcf=document[_0x349797(0x11e3)](_0x349797(0x1e6));_0x5cafcf[_0x349797(0x505)][_0x349797(0x957)](_0x349797(0x3b7)),void _0x5cafcf[_0x349797(0x29f)],_0x5cafcf[_0x349797(0x505)][_0x349797(0x252)](_0x349797(0x3b7)),setTimeout(()=>_0x5cafcf['classList'][_0x349797(0x957)](_0x349797(0x3b7)),0x1f4),_0x3b5153(_0x180118,_0x1dc060);}else _0x2c799e(_0x2eb2c8,_0x477f57);continue;case _0x349797(0x9be):_0x1dc060[_0x349797(0x739)][_0x349797(0x1197)]=_0xc854dd[_0x349797(0x9b8)],_0x1dc060[_0x349797(0x739)][_0x349797(0x1005)]=_0xc854dd[_0x349797(0x6ac)]||![],_0x1dc060[_0x349797(0x739)][_0x349797(0x136)]=Date[_0x349797(0x1182)]();const _0xb5506b={'role':_0x349797(0xf72),'type':_0x349797(0x8ee),'content':'['+_0x1dc060[_0x349797(0x278)]+_0x349797(0x12f3)+_0xc854dd[_0x349797(0x9b8)]+']','timestamp':Date[_0x349797(0x1182)]()};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0xb5506b);_0x2d65ad&&_0x3b5153(_0xb5506b,_0x1dc060);_0x5ee219();continue;case'location_share':_0xb6f05f={..._0x41d06f,'type':_0x349797(0x104),'content':_0xc854dd[_0x349797(0x9a5)]};break;case _0x349797(0x1020):if(_0xb57b5b[_0x349797(0x3d5)]&&_0xb57b5b[_0x349797(0x93d)]===_0x2eb2c8){const _0x4d0fee=_0xc854dd[_0x349797(0x101a)]||_0xc854dd[_0x349797(0x4f8)]||_0xc854dd[_0x349797(0x278)];if(typeof _0x4d0fee===_0x349797(0x10d7)&&_0x4d0fee[_0x349797(0xeb7)]()){const _0x22dafd=_0x4d0fee[_0x349797(0x1018)](/^\[?\d+\]?[\s.-]*/,'')[_0x349797(0xeb7)](),_0x58a765=_0xb57b5b[_0x349797(0xcba)][_0x349797(0x901)](_0x2264b5=>_0x2264b5['name'][_0x349797(0xb03)]()===_0x22dafd[_0x349797(0xb03)]());if(_0x58a765>-0x1){_0x23e7aa(_0x58a765);const _0x4615d6=_0xb57b5b[_0x349797(0xcba)][_0x58a765];let _0x2ac0e8;if(_0x1dc060['isGroup']){const _0x58e79f=_0x1dc060[_0x349797(0x2b3)][_0x349797(0xe79)](_0x552f04=>_0x552f04['originalName']===_0xc854dd['name']);_0x2ac0e8=_0x58e79f?_0x58e79f[_0x349797(0xc8f)]:_0xc854dd[_0x349797(0x278)];}else _0x2ac0e8=_0x1dc060[_0x349797(0x278)];const _0xb62975={'role':'system','type':'pat_message','content':_0x349797(0x2be)+_0x2ac0e8+_0x349797(0xafe)+_0x4615d6['name']+_0x349797(0xf8d)+_0x4615d6[_0x349797(0xb9f)]+']','timestamp':Date['now']()};_0x1dc060[_0x349797(0x49e)]['push'](_0xb62975),_0x2d65ad&&_0x3b5153(_0xb62975,_0x1dc060);}else console[_0x349797(0x6b0)]('歌曲查找失败:\x20AI请求的歌曲名\x22'+_0x4d0fee+'\x22(处理后为\x22'+_0x22dafd+_0x349797(0x696));}else console[_0x349797(0x1c1)](_0x349797(0xfc7),_0xc854dd);}continue;case _0x349797(0x4c2):const _0x4e8f0f={'chatId':_0x2eb2c8,'authorId':_0x2eb2c8,'description':_0xc854dd[_0x349797(0x1029)],'timestamp':Date[_0x349797(0x1182)](),'type':_0x349797(0xc77)};await _0x2e83f8[_0x349797(0x360)][_0x349797(0x252)](_0x4e8f0f),console[_0x349797(0x84b)](_0x349797(0x576)+_0x1dc060['name']+_0x349797(0xeba),_0xc854dd[_0x349797(0x1029)]);continue;case _0x349797(0x5cb):const _0x3bbd31=new Date(_0xc854dd[_0x349797(0x1c3)]);if(!isNaN(_0x3bbd31)&&_0x3bbd31>new Date()){const _0x5237bf={'chatId':_0x2eb2c8,'authorId':_0x2eb2c8,'description':_0xc854dd[_0x349797(0x740)],'timestamp':Date[_0x349797(0x1182)](),'type':_0x349797(0x476),'targetDate':_0x3bbd31[_0x349797(0xd2f)]()};await _0x2e83f8[_0x349797(0x360)][_0x349797(0x252)](_0x5237bf),console[_0x349797(0x84b)]('AI\x20\x22'+_0x1dc060['name']+_0x349797(0x114a),_0xc854dd[_0x349797(0x740)]);}continue;case'block_user':if(!_0x1dc060[_0x349797(0x1244)]){_0x1dc060[_0x349797(0xa78)][_0x349797(0x739)]='blocked_by_ai';const _0x3c2ec6={'role':'system','content':_0x349797(0x4d7),'timestamp':Date[_0x349797(0x1182)](),'isHidden':!![]};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x3c2ec6),await _0x2e83f8[_0x349797(0x737)][_0x349797(0xe3c)](_0x1dc060);_0x2d65ad&&_0x544ab5(_0x2eb2c8);_0x5ee219();break;}continue;case'friend_request_response':!_0x1dc060[_0x349797(0x1244)]&&_0x1dc060[_0x349797(0xa78)]?.[_0x349797(0x739)]===_0x349797(0x9f9)&&(_0xc854dd[_0x349797(0xf98)]===_0x349797(0x730)?(_0x1dc060[_0x349797(0xa78)][_0x349797(0x739)]=_0x349797(0xe62),_0xb6f05f={..._0x41d06f,'content':_0x349797(0x69a)}):(_0x1dc060[_0x349797(0xa78)][_0x349797(0x739)]=_0x349797(0x4ee),_0xb6f05f={..._0x41d06f,'content':_0x349797(0x10de)}),_0x1dc060[_0x349797(0xa78)]['applicationReason']='');break;case _0x349797(0xcc5):const _0x10e83d=typeof _0xc854dd[_0x349797(0x11a1)]===_0x349797(0x10d7)?_0xc854dd[_0x349797(0x11a1)][_0x349797(0x65b)]('\x0a')[_0x349797(0x138)](_0x406989=>_0x406989['trim']()):Array['isArray'](_0xc854dd[_0x349797(0x11a1)])?_0xc854dd[_0x349797(0x11a1)]:[];if(_0x10e83d[_0x349797(0x594)]<0x2)continue;_0xb6f05f={..._0x41d06f,'type':'poll','question':_0xc854dd[_0x349797(0xdb5)],'options':_0x10e83d,'votes':{},'isClosed':![]};break;case _0x349797(0xf9e):{const {itemName:_0x289f3e,itemPrice:_0x4fc6d9,image_prompt:_0x581d18}=_0xc854dd;if(_0x289f3e&&!isNaN(parseFloat(_0x4fc6d9))&&_0x581d18){const _0x26f1c5=_0x349797(0x35d)+encodeURIComponent(_0x581d18);_0xb6f05f={..._0x41d06f,'type':_0x349797(0xf9e),'items':[{'name':_0x289f3e,'price':parseFloat(_0x4fc6d9),'imageUrl':_0x26f1c5,'quantity':0x1}],'total':parseFloat(_0x4fc6d9),'recipients':_0xc854dd[_0x349797(0xfae)]||null};}else console[_0x349797(0x6b0)](_0x349797(0xf9a),_0xc854dd);break;}case _0x349797(0x10b9):const _0x58bbcc=_0x1dc060[_0x349797(0x49e)][_0x349797(0xe79)](_0x71d3b3=>_0x71d3b3[_0x349797(0x702)]===_0xc854dd[_0x349797(0xc88)]);_0x58bbcc&&!_0x58bbcc[_0x349797(0xdf0)]&&(Object['keys'](_0x58bbcc[_0x349797(0x510)])[_0x349797(0x494)](_0x232d60=>{const _0x442b46=_0x349797,_0x534481=_0x58bbcc[_0x442b46(0x510)][_0x232d60][_0x442b46(0xce1)](_0xc854dd[_0x442b46(0x278)]);_0x534481>-0x1&&_0x58bbcc['votes'][_0x232d60][_0x442b46(0xfd0)](_0x534481,0x1);}),!_0x58bbcc[_0x349797(0x510)][_0xc854dd[_0x349797(0x70d)]]&&(_0x58bbcc[_0x349797(0x510)][_0xc854dd[_0x349797(0x70d)]]=[]),!_0x58bbcc[_0x349797(0x510)][_0xc854dd[_0x349797(0x70d)]][_0x349797(0x3ad)](_0xc854dd[_0x349797(0x278)])&&_0x58bbcc['votes'][_0xc854dd['choice']][_0x349797(0xf5)](_0xc854dd['name']),_0x2d65ad&&_0x544ab5(_0x2eb2c8));continue;case _0x349797(0x305):_0xb6f05f={..._0x41d06f,..._0xc854dd,'totalAmount':_0xc854dd[_0x349797(0x354)],'claimedBy':{},'isFullyClaimed':![]};_0xc854dd['receiver']&&(_0xb6f05f[_0x349797(0x1045)]=_0xc854dd['receiver'],delete _0xb6f05f['receiver']);break;case'open_red_packet':const _0x4e0887=_0x1dc060[_0x349797(0x49e)][_0x349797(0xe79)](_0x33e1cb=>_0x33e1cb[_0x349797(0x702)]===_0xc854dd[_0x349797(0x8f2)]),_0x30bd93=_0xc854dd[_0x349797(0x278)],_0x1b5401=_0x1dc060[_0x349797(0x2b3)][_0x349797(0xe7c)](_0x21dce4=>_0x21dce4[_0x349797(0x697)]===_0x30bd93);if(!_0x1b5401){console['warn'](_0x349797(0xf4d)+_0x30bd93+_0x349797(0x7c8));continue;}if(_0x4e0887&&_0x4e0887[_0x349797(0xc3d)]===_0x349797(0x978)){if(_0x4e0887['receiverName']!==_0xc854dd['name']){console['warn']('AI\x20角色\x20\x22'+_0xc854dd[_0x349797(0x278)]+_0x349797(0x1100)+_0x4e0887[_0x349797(0x1045)]+')。操作已被拦截。');continue;}}if(_0x4e0887&&!_0x4e0887[_0x349797(0x5e7)]&&!(_0x4e0887['claimedBy']&&_0x4e0887[_0x349797(0xcf6)][_0xc854dd[_0x349797(0x278)]])){let _0x29a91f=0x0;const _0x4d4697=_0x4e0887[_0x349797(0x3a9)]-Object[_0x349797(0x4ca)](_0x4e0887[_0x349797(0xcf6)]||{})[_0x349797(0x870)]((_0x1fe302,_0x583746)=>_0x1fe302+_0x583746,0x0),_0x5a7dfa=_0x4e0887[_0x349797(0xc85)]-Object[_0x349797(0xb4a)](_0x4e0887[_0x349797(0xcf6)]||{})[_0x349797(0x594)];if(_0x5a7dfa>0x0){if(_0x4e0887[_0x349797(0xc3d)]===_0x349797(0x978))_0x29a91f=_0x4e0887[_0x349797(0x3a9)];else{if(_0x5a7dfa===0x1)_0x29a91f=_0x4d4697;else{const _0x3b4b59=0.01,_0x5d52cc=_0x4d4697-(_0x5a7dfa-0x1)*_0x3b4b59;_0x29a91f=Math['random']()*(_0x5d52cc-_0x3b4b59)+_0x3b4b59;}}_0x29a91f=parseFloat(_0x29a91f[_0x349797(0x200)](0x2));if(!_0x4e0887[_0x349797(0xcf6)])_0x4e0887[_0x349797(0xcf6)]={};_0x4e0887[_0x349797(0xcf6)][_0xc854dd[_0x349797(0x278)]]=_0x29a91f;const _0xbbcda7=_0x1dc060[_0x349797(0x2b3)][_0x349797(0xe79)](_0x416eb9=>_0x416eb9[_0x349797(0x697)]===_0xc854dd[_0x349797(0x278)]),_0x8af1bb=_0xbbcda7?_0xbbcda7[_0x349797(0xc8f)]:_0xc854dd['name'],_0x414f00=_0xd9d60a(_0x1dc060,_0x4e0887['senderName']),_0x15b4dd={'role':_0x349797(0xf72),'type':_0x349797(0x8ee),'content':_0x8af1bb+_0x349797(0xc45)+_0x414f00+_0x349797(0xb35),'timestamp':Date['now']()};_0x1dc060['history'][_0x349797(0xf5)](_0x15b4dd);let _0x6c6bf4='[系统提示：你\x20('+_0x8af1bb+_0x349797(0xf82)+_0x29a91f[_0x349797(0x200)](0x2)+_0x349797(0x3a8);if(Object[_0x349797(0xb4a)](_0x4e0887[_0x349797(0xcf6)])[_0x349797(0x594)]>=_0x4e0887[_0x349797(0xc85)]){_0x4e0887['isFullyClaimed']=!![];const _0x3f933a={'role':_0x349797(0xf72),'type':'pat_message','content':_0x414f00+_0x349797(0x9c8),'timestamp':Date['now']()+0x1};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x3f933a);let _0x452d6d={'name':'','amount':-0x1};_0x4e0887[_0x349797(0xc3d)]===_0x349797(0x9da)&&_0x4e0887[_0x349797(0xc85)]>0x1&&Object['entries'](_0x4e0887[_0x349797(0xcf6)])[_0x349797(0x494)](([_0x446c89,_0x162ec3])=>{const _0x5769a6=_0x349797;_0x162ec3>_0x452d6d[_0x5769a6(0x354)]&&(_0x452d6d={'name':_0x446c89,'amount':_0x162ec3});});if(_0x452d6d[_0x349797(0x278)]){const _0x5b10bf=_0x1dc060[_0x349797(0x2b3)]['find'](_0x95515e=>_0x95515e[_0x349797(0x697)]===_0x452d6d['name']),_0x2ca612=_0x5b10bf?_0x5b10bf[_0x349797(0xc8f)]:_0x452d6d[_0x349797(0x278)];_0x6c6bf4+=_0x349797(0xf57)+_0x2ca612+'！';}else _0x6c6bf4+=_0x349797(0x578);}_0x6c6bf4+=_0x349797(0x1146);const _0x1734c4={'role':_0x349797(0xf72),'content':_0x6c6bf4,'timestamp':Date[_0x349797(0x1182)]()+0x2,'isHidden':!![]};_0x1dc060['history'][_0x349797(0xf5)](_0x1734c4);}_0x2d65ad&&(_0x544ab5(_0x2eb2c8),_0x5ee219());}continue;case _0x349797(0x192):{const _0x58d265=_0x1dc060[_0x349797(0x49e)][_0x349797(0x901)](_0x30d2e8=>_0x30d2e8[_0x349797(0x702)]===_0xc854dd['for_timestamp']);if(_0x58d265>-0x1){const _0x16c589=_0x1dc060['history'][_0x58d265];_0x16c589[_0x349797(0x739)]='accepted';}continue;}case _0x349797(0x117c):{const _0x1622b1=_0x1dc060[_0x349797(0x49e)][_0x349797(0x901)](_0x547b64=>_0x547b64[_0x349797(0x702)]===_0xc854dd[_0x349797(0x5e9)]);if(_0x1622b1>-0x1){const _0x335636=_0x1dc060['history'][_0x1622b1];_0x335636['status']=_0x349797(0x3e1);const _0xb5452d={'role':_0x349797(0x1119),'senderName':_0x1dc060['name'],'type':_0x349797(0x82b),'isRefund':!![],'amount':_0x335636['amount'],'note':'转账已被拒收','timestamp':_0x2b7943++};_0x1dc060['history'][_0x349797(0xf5)](_0xb5452d),_0x2d65ad&&(_0x3b5153(_0xb5452d,_0x1dc060),_0x544ab5(_0x2eb2c8));}continue;}case _0x349797(0x1143):if(_0x1dc060[_0x349797(0x1244)]&&_0xc854dd[_0x349797(0xeae)]){const _0x2092c6=_0xc854dd['new_name']['trim'](),_0x19fb86=_0x1dc060[_0x349797(0x2b3)]['map'](_0x49c375=>_0x49c375[_0x349797(0x697)]);if(_0x19fb86[_0x349797(0x3ad)](_0x2092c6)){console[_0x349797(0x6b0)](_0x349797(0xf2a)+_0xc854dd[_0x349797(0x278)]+_0x349797(0x118c)+_0x2092c6+_0x349797(0xdbf));continue;}_0x1dc060['name']=_0x2092c6;const _0xfa3f2b=_0x1dc060[_0x349797(0x2b3)][_0x349797(0xe79)](_0x12dde6=>_0x12dde6[_0x349797(0x697)]===_0xc854dd['name']),_0x37d0e3=_0xfa3f2b?_0xfa3f2b[_0x349797(0xc8f)]:_0xc854dd['name'],_0x4c9fca={'role':_0x349797(0xf72),'type':_0x349797(0x8ee),'content':_0x37d0e3+_0x349797(0xe5b)+_0x1dc060['name']+'”','timestamp':_0x2b7943++};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x4c9fca),_0x2d65ad&&(_0x3b5153(_0x4c9fca,_0x1dc060),document['getElementById'](_0x349797(0x1205))[_0x349797(0x300)]=_0x1dc060[_0x349797(0x278)]);}continue;case'change_remark_name':if(!_0x1dc060['isGroup']&&_0xc854dd[_0x349797(0xeae)]){const _0x4c1748=_0x1dc060['name'],_0x59e9f9=_0xc854dd[_0x349797(0xeae)]['trim']();if(_0x59e9f9&&_0x59e9f9!==_0x4c1748){!_0x1dc060[_0x349797(0x3d7)]&&(_0x1dc060[_0x349797(0x3d7)]=[]);!_0x1dc060[_0x349797(0x3d7)]['includes'](_0x4c1748)&&_0x1dc060[_0x349797(0x3d7)][_0x349797(0xf5)](_0x4c1748);_0x1dc060[_0x349797(0x278)]=_0x59e9f9;const _0x2958cd={'role':_0x349797(0xf72),'type':_0x349797(0x8ee),'content':'“'+_0x1dc060[_0x349797(0x697)]+_0x349797(0x6aa)+_0x59e9f9+'”','timestamp':_0x2b7943++};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x2958cd);const _0x3ca1c1={'role':'system','content':_0x349797(0x432)+_0x59e9f9+_0x349797(0x4e7),'timestamp':_0x2b7943++,'isHidden':!![]};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x3ca1c1),_0x2d65ad&&(_0x3b5153(_0x2958cd,_0x1dc060),document[_0x349797(0x11e3)]('chat-header-title')[_0x349797(0x300)]=_0x59e9f9),await _0xead3(_0x1dc060);}}continue;case _0x349797(0xc0b):if(_0x1dc060[_0x349797(0x1244)]&&_0xc854dd[_0x349797(0xe4f)]){const _0x114a53=_0xc854dd[_0x349797(0xe4f)],_0x29fc69=_0x1dc060[_0x349797(0x761)][_0x349797(0x86c)]||[],_0x26cb78=_0x29fc69[_0x349797(0xe79)](_0x51de7b=>_0x51de7b[_0x349797(0x278)]===_0x114a53);if(_0x26cb78){_0x1dc060[_0x349797(0x761)]['groupAvatar']=_0x26cb78[_0x349797(0x10ac)];const _0x5a3496=_0x1dc060[_0x349797(0x2b3)][_0x349797(0xe79)](_0x1bfac8=>_0x1bfac8[_0x349797(0x697)]===_0xc854dd[_0x349797(0x278)]),_0x208a58=_0x5a3496?_0x5a3496[_0x349797(0xc8f)]:_0xc854dd[_0x349797(0x278)],_0x5a3f74={'role':_0x349797(0xf72),'type':'pat_message','content':_0x208a58+_0x349797(0x1ab),'timestamp':_0x2b7943++};_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0x5a3f74),_0x2d65ad&&_0x3b5153(_0x5a3f74,_0x1dc060);}else console[_0x349797(0x6b0)](_0x349797(0x5b1)+_0x114a53+'\x22');}continue;case _0x349797(0xd8):_0xb6f05f={'role':_0x349797(0xf72),'type':'pat_message','content':_0xc854dd[_0x349797(0x9a5)],'timestamp':Date[_0x349797(0x1182)]()};break;case'share_link':_0xb6f05f={..._0x41d06f,'type':'share_link','title':_0xc854dd[_0x349797(0x740)],'description':_0xc854dd[_0x349797(0x1029)],'source_name':_0xc854dd['source_name'],'content':_0xc854dd[_0x349797(0x9a5)]};break;case _0x349797(0x229):const _0x204f65=_0x1dc060[_0x349797(0x49e)][_0x349797(0xe79)](_0x256f6e=>_0x256f6e[_0x349797(0x702)]===_0xc854dd[_0x349797(0x47a)]);if(_0x204f65){const _0xd3566c={'timestamp':_0x204f65[_0x349797(0x702)],'senderName':_0x204f65['senderName']||(_0x204f65[_0x349797(0xba4)]==='user'?_0x1dc060['settings'][_0x349797(0xca7)]||'我':_0x1dc060[_0x349797(0x278)]),'content':String(_0x204f65['content']||'')[_0x349797(0x8d4)](0x0,0x32)};_0xb6f05f={..._0x41d06f,'content':_0xc854dd[_0x349797(0x8f8)],'quote':_0xd3566c};}else _0xb6f05f={..._0x41d06f,'content':_0xc854dd[_0x349797(0x8f8)]};break;case'send_and_recall':{if(!_0x2d65ad)continue;const _0x582bc0={..._0x41d06f,'content':_0xc854dd[_0x349797(0x9a5)]},_0x315f0d=_0xe99b75(_0x582bc0,_0x1dc060);_0x3b5153(_0x582bc0,_0x1dc060,!![]),await new Promise(_0x1bfd42=>setTimeout(_0x1bfd42,Math[_0x349797(0x36d)]()*0x3e8+0x5dc));const _0x3b6949=document[_0x349797(0x5ac)](_0x349797(0x955)+_0x582bc0['timestamp']+'\x22]')?.[_0x349797(0xfe1)]('.message-wrapper');if(_0x3b6949){_0x3b6949[_0x349797(0x505)][_0x349797(0x252)]('recalled-animation'),await new Promise(_0x3df650=>setTimeout(_0x3df650,0x12c));const _0x5f271f={'role':_0x349797(0x1119),'senderName':_0xc854dd[_0x349797(0x278)]||_0x1dc060[_0x349797(0x278)],'type':_0x349797(0xfb3),'content':_0x349797(0xdd2),'timestamp':_0x582bc0[_0x349797(0x702)],'recalledData':{'originalType':_0x349797(0x1197),'originalContent':_0xc854dd['content']}},_0x183179=_0x1dc060[_0x349797(0x49e)]['findIndex'](_0xb4ef1a=>_0xb4ef1a[_0x349797(0x702)]===_0x582bc0['timestamp']);_0x183179>-0x1?_0x1dc060[_0x349797(0x49e)][_0x183179]=_0x5f271f:_0x1dc060[_0x349797(0x49e)]['push'](_0x5f271f);const _0x16c852=await _0xe99b75(_0x5f271f,_0x1dc060);document['body']['contains'](_0x3b6949)&&_0x3b6949['parentNode'][_0x349797(0xeaa)](_0x16c852,_0x3b6949);}continue;}case'text':_0xb6f05f={..._0x41d06f,'content':String(_0xc854dd[_0x349797(0x9a5)]||_0xc854dd[_0x349797(0x4bc)])};break;case _0x349797(0x87b):if(_0xc854dd[_0x349797(0xb36)]){const _0x296c83=_0x5de8b7[_0x349797(0xa67)][_0x349797(0xe79)](_0x3fdc17=>_0x3fdc17['name']===_0xc854dd[_0x349797(0xb36)]);_0x296c83?_0xb6f05f={..._0x41d06f,'type':_0x349797(0x87b),'content':_0x296c83['url'],'meaning':_0x296c83['name']}:(console[_0x349797(0x6b0)](_0x349797(0xbb8)+_0xc854dd[_0x349797(0xb36)]+'\x22'),_0xb6f05f={..._0x41d06f,'type':'text','content':_0x349797(0x119f)+_0xc854dd['meaning']+']'});}else console[_0x349797(0x6b0)](_0x349797(0x5f5),_0xc854dd),_0xb6f05f={..._0x41d06f,'type':_0x349797(0x87b),'content':_0xc854dd[_0x349797(0x10ac)],'meaning':_0x349797(0x10df)};break;case'ai_image':_0xb6f05f={..._0x41d06f,'type':_0x349797(0xd02),'content':_0xc854dd[_0x349797(0x1029)],'image_prompt':_0xc854dd[_0x349797(0xee6)]};break;case _0x349797(0x719):_0xb6f05f={..._0x41d06f,'type':_0x349797(0x719),'content':_0xc854dd[_0x349797(0x9a5)]};break;case'transfer':_0xb6f05f={..._0x41d06f,'type':'transfer','amount':_0xc854dd[_0x349797(0x354)],'note':_0xc854dd[_0x349797(0x1213)],'receiverName':_0xc854dd[_0x349797(0xf13)]||'我'};break;case _0x349797(0x123b):_0xb6f05f={..._0x41d06f,'type':_0x349797(0x123b),'productInfo':_0xc854dd[_0x349797(0x1253)],'amount':_0xc854dd[_0x349797(0x354)],'status':_0x349797(0x5d2),'countdownEndTime':Date[_0x349797(0x1182)]()+0xf*0x3c*0x3e8};break;case _0x349797(0x57b):_0xb6f05f={..._0x41d06f,'type':_0x349797(0x57b),'productInfo':_0xc854dd['productInfo'],'amount':_0xc854dd['amount'],'greeting':_0xc854dd[_0x349797(0x11f1)],'recipientName':_0xc854dd[_0x349797(0x10f)]||null};break;case _0x349797(0xd71):_0xb6f05f={..._0x41d06f,..._0xc854dd};break;case _0x349797(0xcb1):try{console['log']('📸\x20NovelAI图片生成开始，AI提供的prompt:',_0xc854dd[_0x349797(0x196)]);const _0x3048b2=_0x419515(_0x1dc060['id']),_0x4968fc=_0xc854dd['prompt']||_0x349797(0x4c3),_0x138440=_0x4968fc+',\x20'+_0x3048b2[_0x349797(0x634)],_0xf6bdc9=_0x3048b2['negative'];console[_0x349797(0x84b)](_0x349797(0x71c)+(_0x3048b2[_0x349797(0x1275)]==='character'?_0x349797(0x10fd):'系统')+_0x349797(0x86b)),console['log'](_0x349797(0x725),_0x138440),console[_0x349797(0x84b)](_0x349797(0x1200),_0xf6bdc9);const _0x212d6d=localStorage[_0x349797(0x728)](_0x349797(0xa09)),_0x40ec88=localStorage[_0x349797(0x728)]('novelai-model')||_0x349797(0x12d8),_0x41a7fa=_0x3a7337();if(!_0x212d6d)throw new Error(_0x349797(0x3a5));const [_0x717f2a,_0x48f4d3]=_0x41a7fa[_0x349797(0x673)]['split']('x')[_0x349797(0x796)](Number);let _0x427119;_0x40ec88[_0x349797(0x3ad)](_0x349797(0xb6a))?_0x427119={'input':_0x138440,'model':_0x40ec88,'action':_0x349797(0x12a1),'parameters':{'params_version':0x3,'width':_0x717f2a,'height':_0x48f4d3,'scale':_0x41a7fa[_0x349797(0x4c0)],'sampler':_0x41a7fa[_0x349797(0x5c7)],'steps':_0x41a7fa['steps'],'seed':_0x41a7fa[_0x349797(0x1073)]===-0x1?Math[_0x349797(0xfb1)](Math[_0x349797(0x36d)]()*0x2540be3ff):_0x41a7fa['seed'],'n_samples':0x1,'ucPreset':_0x41a7fa[_0x349797(0x500)],'qualityToggle':_0x41a7fa[_0x349797(0x4ad)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':'karras','legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x138440,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0xf6bdc9,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0xf6bdc9,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x427119={'input':_0x138440,'model':_0x40ec88,'action':'generate','parameters':{'width':_0x717f2a,'height':_0x48f4d3,'scale':_0x41a7fa[_0x349797(0x4c0)],'sampler':_0x41a7fa[_0x349797(0x5c7)],'steps':_0x41a7fa['steps'],'seed':_0x41a7fa['seed']===-0x1?Math[_0x349797(0xfb1)](Math[_0x349797(0x36d)]()*0x2540be3ff):_0x41a7fa[_0x349797(0x1073)],'n_samples':0x1,'ucPreset':_0x41a7fa['uc_preset'],'qualityToggle':_0x41a7fa[_0x349797(0x4ad)],'sm':_0x41a7fa[_0x349797(0x126c)],'sm_dyn':_0x41a7fa[_0x349797(0x12e0)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':'native','negative_prompt':_0xf6bdc9}};console[_0x349797(0x84b)](_0x349797(0x12f5),_0x427119);let _0x5405fe;_0x40ec88['includes']('nai-diffusion-4')?_0x5405fe=_0x349797(0x6e6):_0x5405fe=_0x349797(0x1114);let _0x2815ea=_0x41a7fa[_0x349797(0x9e2)];_0x2815ea===_0x349797(0x3c4)&&(_0x2815ea=_0x41a7fa[_0x349797(0x871)]||'');_0x2815ea&&_0x2815ea!==''&&(_0x5405fe=_0x2815ea+encodeURIComponent(_0x5405fe));const _0x489461=await fetch(_0x5405fe,{'method':_0x349797(0x1128),'headers':{'Content-Type':_0x349797(0x35c),'Authorization':_0x349797(0xdaf)+_0x212d6d},'body':JSON[_0x349797(0x313)](_0x427119)});console[_0x349797(0x84b)](_0x349797(0x441),_0x489461[_0x349797(0x739)]),console[_0x349797(0x84b)](_0x349797(0x7aa),[..._0x489461[_0x349797(0x2b1)][_0x349797(0x560)]()]);if(!_0x489461['ok']){const _0x14d9ce=await _0x489461[_0x349797(0x1197)]();console[_0x349797(0x1c1)]('API错误响应:',_0x14d9ce);throw new Error('API请求失败\x20('+_0x489461[_0x349797(0x739)]+'):\x20'+_0x14d9ce);}const _0xc1c71a=_0x489461[_0x349797(0x2b1)][_0x349797(0x1289)]('content-type');console[_0x349797(0x84b)](_0x349797(0xe17),_0xc1c71a);let _0x1651f9,_0x30060b;if(_0xc1c71a&&_0xc1c71a[_0x349797(0x3ad)]('text/event-stream')){console['log'](_0x349797(0x51b));const _0x595acb=await _0x489461[_0x349797(0x1197)]();console[_0x349797(0x84b)](_0x349797(0xe7),_0x595acb[_0x349797(0x594)]);const _0x38e3c4=_0x595acb['trim']()[_0x349797(0x65b)]('\x0a');let _0x3598bb=null;for(let _0x15a4d7=_0x38e3c4['length']-0x1;_0x15a4d7>=0x0;_0x15a4d7--){const _0x27c930=_0x38e3c4[_0x15a4d7][_0x349797(0xeb7)]();if(_0x27c930[_0x349797(0xb6c)](_0x349797(0x106e))&&_0x27c930!==_0x349797(0x7ea)){const _0x3fb9f9=_0x27c930[_0x349797(0x8d4)](0x6);try{const _0x2083df=JSON[_0x349797(0xb0c)](_0x3fb9f9);if(_0x2083df[_0x349797(0x55a)]===_0x349797(0x10b1)&&_0x2083df[_0x349797(0x6e9)]){_0x3598bb=_0x2083df[_0x349797(0x6e9)],console[_0x349797(0x84b)](_0x349797(0x629));break;}if(_0x2083df['data']){_0x3598bb=_0x2083df[_0x349797(0x1cc)],console[_0x349797(0x84b)](_0x349797(0x814));break;}if(_0x2083df[_0x349797(0x6e9)]){_0x3598bb=_0x2083df[_0x349797(0x6e9)],console[_0x349797(0x84b)](_0x349797(0xf37));break;}}catch(_0x2641e5){_0x3598bb=_0x3fb9f9,console[_0x349797(0x84b)](_0x349797(0xb3c));break;}}}if(!_0x3598bb)throw new Error(_0x349797(0x61f));const _0x1de54f=_0x3598bb[_0x349797(0xb6c)](_0x349797(0x6c1)),_0x20edfb=_0x3598bb[_0x349797(0xb6c)](_0x349797(0x60f));if(_0x1de54f||_0x20edfb){console[_0x349797(0x84b)](_0x349797(0x958));const _0x4dfe63=atob(_0x3598bb),_0x44b5ef=new Uint8Array(_0x4dfe63[_0x349797(0x594)]);for(let _0x2476cb=0x0;_0x2476cb<_0x4dfe63[_0x349797(0x594)];_0x2476cb++){_0x44b5ef[_0x2476cb]=_0x4dfe63[_0x349797(0x5f0)](_0x2476cb);}const _0x196b2b=new Blob([_0x44b5ef],{'type':_0x1de54f?_0x349797(0x12f6):'image/jpeg'});console[_0x349797(0x84b)](_0x349797(0xae),_0x196b2b[_0x349797(0x1159)]);const _0x2497ed=new FileReader();_0x30060b=await new Promise((_0x4123c3,_0x338d64)=>{const _0x21b956=_0x349797;_0x2497ed[_0x21b956(0xbd8)]=()=>_0x4123c3(_0x2497ed['result']),_0x2497ed[_0x21b956(0x741)]=_0x338d64,_0x2497ed[_0x21b956(0x1270)](_0x196b2b);}),console[_0x349797(0x84b)]('✅\x20图片转换成功！🎨');}else{console[_0x349797(0x84b)](_0x349797(0x122f));const _0xf9d29a=atob(_0x3598bb),_0xe5809f=new Uint8Array(_0xf9d29a[_0x349797(0x594)]);for(let _0x51e4a4=0x0;_0x51e4a4<_0xf9d29a['length'];_0x51e4a4++){_0xe5809f[_0x51e4a4]=_0xf9d29a['charCodeAt'](_0x51e4a4);}_0x1651f9=new Blob([_0xe5809f]),console[_0x349797(0x84b)](_0x349797(0x102b),_0x1651f9[_0x349797(0x1159)]);}}else _0x1651f9=await _0x489461[_0x349797(0xccb)](),console[_0x349797(0x84b)](_0x349797(0x1d4),_0x1651f9[_0x349797(0xa20)],_0x349797(0x27b),_0x1651f9[_0x349797(0x1159)]);if(!_0x30060b&&_0x1651f9)try{if(typeof JSZip==='undefined')throw new Error('JSZip库未加载，请刷新页面重试');const _0x5e869f=await JSZip[_0x349797(0x79c)](_0x1651f9);console['log']('ZIP文件内容:',Object['keys'](_0x5e869f[_0x349797(0x5c9)]));let _0x24ae3a=null;for(let _0x1cf91b in _0x5e869f['files']){if(_0x1cf91b[_0x349797(0xe9f)](/\.(png|jpg|jpeg|webp)$/i)){_0x24ae3a=_0x5e869f[_0x349797(0x5c9)][_0x1cf91b],console[_0x349797(0x84b)]('找到图片文件:',_0x1cf91b);break;}}if(!_0x24ae3a)throw new Error(_0x349797(0xdbe));const _0x2d647d=await _0x24ae3a[_0x349797(0x90c)](_0x349797(0xccb));console[_0x349797(0x84b)](_0x349797(0xb58),_0x2d647d['size']);const _0x25b116=new FileReader();_0x30060b=await new Promise((_0x14b8ea,_0x1b0c2e)=>{const _0x410e1e=_0x349797;_0x25b116[_0x410e1e(0xbd8)]=()=>_0x14b8ea(_0x25b116['result']),_0x25b116['onerror']=_0x1b0c2e,_0x25b116[_0x410e1e(0x1270)](_0x2d647d);}),console[_0x349797(0x84b)](_0x349797(0x820));}catch(_0x2bbe3b){console[_0x349797(0x1c1)]('ZIP解压失败:',_0x2bbe3b);throw new Error(_0x349797(0xf14)+_0x2bbe3b[_0x349797(0x4bc)]);}console[_0x349797(0x84b)]('✅\x20NAI图片生成成功！'),_0xb6f05f={..._0x41d06f,'type':_0x349797(0xcb1),'imageUrl':_0x30060b,'prompt':_0x4968fc,'fullPrompt':_0x138440};}catch(_0x16b609){console['error'](_0x349797(0xd96),_0x16b609),_0xb6f05f={..._0x41d06f,'content':_0x349797(0xf0f)+_0x16b609['message']+']'};}break;default:console[_0x349797(0x6b0)](_0x349797(0xf6c),_0xc854dd['type']);break;}if(_0xb6f05f){_0x1dc060[_0x349797(0x49e)][_0x349797(0xf5)](_0xb6f05f);!_0x2d65ad&&(_0x1dc060[_0x349797(0xc3a)]=(_0x1dc060[_0x349797(0xc3a)]||0x0)+0x1);if(!_0x2d65ad&&!_0x5f414b){let _0x142449;switch(_0xb6f05f['type']){case _0x349797(0x82b):_0x142449='[收到一笔转账]';break;case _0x349797(0x123b):_0x142449=_0x349797(0xf79);break;case _0x349797(0xd02):_0x142449=_0x349797(0xd17);break;case _0x349797(0x719):_0x142449='[语音]';break;case _0x349797(0x87b):_0x142449=_0xb6f05f['meaning']?_0x349797(0x119f)+_0xb6f05f[_0x349797(0xb36)]+']':'[表情]';break;case _0x349797(0xd71):_0x142449=_0xb6f05f[_0x349797(0x159)]?'「'+_0xb6f05f['dialogue']+'」':'['+_0xb6f05f[_0x349797(0x1029)][_0x349797(0x8d4)](0x0,0x14)+_0x349797(0x9c9);break;default:_0x142449=String(_0xb6f05f[_0x349797(0x9a5)]||'');}const _0x1c4a13=_0x1dc060[_0x349797(0x1244)]?_0xb6f05f[_0x349797(0x768)]+':\x20'+_0x142449:_0x142449;_0x2c799e(_0x2eb2c8,_0x1c4a13[_0x349797(0x8d4)](0x0,0x28)+(_0x1c4a13[_0x349797(0x594)]>0x28?_0x349797(0x6cb):'')),_0x5f414b=!![];}_0x2d65ad&&(_0x3b5153(_0xb6f05f,_0x1dc060),await new Promise(_0x4ead39=>setTimeout(_0x4ead39,Math[_0x349797(0x36d)]()*0x708+0x3e8)));}}_0x105e88&&_0x46751e[_0x349797(0x419)]&&(_0x46751e[_0x349797(0x1d6)]=![],_0x46751e[_0x349797(0x94b)]['length']>0x0?_0x3df367():(_0x46751e={..._0x46751e,'isAwaitingResponse':![],'participants':[]},_0x4e7698(_0x349797(0x9fc)),alert(_0x349797(0xc53))));if(_0x32a4a1){await _0x14a9f0();return;}await _0x2e83f8[_0x349797(0x737)]['put'](_0x1dc060);const _0x57e41d=_0xe9a154['some'](_0x414794=>_0x414794[_0x349797(0xa20)]===_0x349797(0x3cc)||_0x414794[_0x349797(0xa20)]===_0x349797(0x10a2)||_0x414794[_0x349797(0xa20)]===_0x349797(0xfe9)||_0x414794[_0x349797(0xa20)]==='repost');_0x57e41d&&(console['log']('检测到AI执行了动态操作，立即刷新好友动态页面。'),await _0xae9c28());}catch(_0x568000){_0x1dc060[_0x349797(0x49e)]=_0x1dc060[_0x349797(0x49e)][_0x349797(0x138)](_0x34b752=>!_0x34b752[_0x349797(0x10bc)]),!_0x1dc060[_0x349797(0x1244)]&&_0x1dc060[_0x349797(0xa78)]?.['status']===_0x349797(0x9f9)?(_0x1dc060[_0x349797(0xa78)][_0x349797(0x739)]=_0x349797(0x4ee),await _0x2fb06(_0x349797(0xb5c),_0x349797(0x623)+_0x568000[_0x349797(0x4bc)])):await _0x2fb06(_0x349797(0xd9f),_0x349797(0xc5)+_0x568000[_0x349797(0x4bc)]),!_0x1dc060[_0x349797(0x1244)]&&_0x1dc060[_0x349797(0xa78)]?.[_0x349797(0x739)]==='blocked_by_ai'&&await _0x2e83f8[_0x349797(0x737)]['put'](_0x1dc060),_0x46751e[_0x349797(0x1d6)]=![];}finally{_0x153b71(_0x2eb2c8,![]),_0x1dc060['isGroup']?_0x28fd2e&&(_0x28fd2e[_0x349797(0x794)][_0x349797(0x33d)]='none'):_0x1c79bc&&_0x5de8b7[_0x349797(0x737)][_0x2eb2c8]&&(_0x1c79bc[_0x349797(0x794)][_0x349797(0x12fa)]=0x0,setTimeout(()=>{const _0x212ce0=_0x349797;_0x1c79bc[_0x212ce0(0x300)]=_0x5de8b7[_0x212ce0(0x737)][_0x2eb2c8][_0x212ce0(0x278)],_0x1c79bc[_0x212ce0(0x505)][_0x212ce0(0x957)](_0x212ce0(0x680)),_0x1c79bc[_0x212ce0(0x794)][_0x212ce0(0x12fa)]=0x1;},0xc8)),_0x5ee219(),_0x4bca2b&&_0x28427c(_0x2eb2c8),_0x5efcc9();}}async function _0x46680f(_0x6aa1a2){const _0x4f4705=_0x241b18;if(!_0x5de8b7[_0x4f4705(0x93d)])return;const _0x4bd7d5=_0x5de8b7[_0x4f4705(0x737)][_0x5de8b7[_0x4f4705(0x93d)]],_0x5d9159={'role':_0x4f4705(0x21c),'content':_0x6aa1a2['url'],'meaning':_0x6aa1a2['name'],'timestamp':Date[_0x4f4705(0x1182)]()};_0x4bd7d5[_0x4f4705(0x49e)][_0x4f4705(0xf5)](_0x5d9159),await _0x2e83f8[_0x4f4705(0x737)][_0x4f4705(0xe3c)](_0x4bd7d5),_0x3b5153(_0x5d9159,_0x4bd7d5),_0x5ee219(),document[_0x4f4705(0x11e3)](_0x4f4705(0x6fd))[_0x4f4705(0x505)][_0x4f4705(0x957)](_0x4f4705(0x250));}async function _0x4d49b4(){const _0xa9db4f=_0x241b18;if(!_0x5de8b7[_0xa9db4f(0x93d)])return;const _0x293426=document[_0xa9db4f(0x11e3)](_0xa9db4f(0x81e)),_0x430d3a=document[_0xa9db4f(0x11e3)]('transfer-note'),_0x6c6758=parseFloat(_0x293426[_0xa9db4f(0xf27)]),_0x1cb620=_0x430d3a[_0xa9db4f(0xf27)][_0xa9db4f(0xeb7)]();if(isNaN(_0x6c6758)||_0x6c6758<0x0){alert(_0xa9db4f(0xaa3));return;}const _0x55fb86=_0x5de8b7[_0xa9db4f(0x737)][_0x5de8b7[_0xa9db4f(0x93d)]],_0x2d9844=_0x55fb86['isGroup']?_0x55fb86[_0xa9db4f(0x761)][_0xa9db4f(0xca7)]||'我':'我',_0x311402=_0x55fb86[_0xa9db4f(0x1244)]?'群聊':_0x55fb86['name'],_0x31eeed={'role':_0xa9db4f(0x21c),'type':_0xa9db4f(0x82b),'amount':_0x6c6758,'note':_0x1cb620,'senderName':_0x2d9844,'receiverName':_0x311402,'timestamp':Date[_0xa9db4f(0x1182)]()};_0x55fb86[_0xa9db4f(0x49e)][_0xa9db4f(0xf5)](_0x31eeed),await _0x2e83f8[_0xa9db4f(0x737)][_0xa9db4f(0xe3c)](_0x55fb86),_0x3b5153(_0x31eeed,_0x55fb86),_0x5ee219(),document[_0xa9db4f(0x11e3)](_0xa9db4f(0x2f3))[_0xa9db4f(0x505)][_0xa9db4f(0x957)](_0xa9db4f(0x250)),_0x293426[_0xa9db4f(0xf27)]='',_0x430d3a[_0xa9db4f(0xf27)]='';}async function _0x2a25bf(){const _0x3a108a=_0x241b18;if(!_0x5de8b7['activeChatId'])return;const _0x179ec8=document['getElementById']('waimai-product-info'),_0x39a1d7=document[_0x3a108a(0x11e3)](_0x3a108a(0x6e4)),_0x37fb7b=_0x179ec8[_0x3a108a(0xf27)]['trim'](),_0x2d8a4c=parseFloat(_0x39a1d7[_0x3a108a(0xf27)]);if(!_0x37fb7b||isNaN(_0x2d8a4c)||_0x2d8a4c<=0x0){alert(_0x3a108a(0x64e));return;}const _0x480a55=_0x5de8b7[_0x3a108a(0x737)][_0x5de8b7[_0x3a108a(0x93d)]],_0x580de2=Date['now'](),_0x5eee22=_0x480a55[_0x3a108a(0x1244)]?_0x480a55[_0x3a108a(0x761)][_0x3a108a(0xca7)]||'我':'我',_0x57570a={'role':_0x3a108a(0x21c),'senderName':_0x5eee22,'type':_0x3a108a(0x57b),'productInfo':_0x37fb7b,'amount':_0x2d8a4c,'timestamp':_0x580de2};_0x480a55[_0x3a108a(0x49e)][_0x3a108a(0xf5)](_0x57570a);const _0x2ef415={'role':'system','content':_0x3a108a(0x3c2)+_0x5eee22+_0x3a108a(0xa9e)+_0x37fb7b+'”，价值'+_0x2d8a4c+'元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','timestamp':_0x580de2+0x1,'isHidden':!![]};_0x480a55[_0x3a108a(0x49e)][_0x3a108a(0xf5)](_0x2ef415),await _0x2e83f8['chats'][_0x3a108a(0xe3c)](_0x480a55),_0x3b5153(_0x57570a,_0x480a55),_0x5ee219(),_0x179ec8[_0x3a108a(0xf27)]='',_0x39a1d7[_0x3a108a(0xf27)]='',document[_0x3a108a(0x11e3)](_0x3a108a(0x1aa))[_0x3a108a(0x505)][_0x3a108a(0x957)]('visible');}async function _0x554b84(){const _0x132b1c=_0x241b18;if(!_0x5de8b7[_0x132b1c(0x93d)])return;const _0x24380f=await _0x231a5a(_0x132b1c(0xce0),_0x132b1c(0x1266),'');if(!_0x24380f||!_0x24380f['trim']())return;const _0x5ab010=_0x132b1c(0xaa5),_0x43451c=_0x5de8b7[_0x132b1c(0x737)][_0x5de8b7[_0x132b1c(0x93d)]],_0x3ca2c7={'role':_0x132b1c(0x21c),'type':_0x132b1c(0x104),'content':_0x24380f[_0x132b1c(0xeb7)](),'imageUrl':_0x5ab010,'timestamp':Date[_0x132b1c(0x1182)]()};_0x43451c[_0x132b1c(0x49e)][_0x132b1c(0xf5)](_0x3ca2c7),await _0x2e83f8['chats'][_0x132b1c(0xe3c)](_0x43451c),_0x3b5153(_0x3ca2c7,_0x43451c),_0x5ee219();}function _0x377c8d(_0x2b8ddd){const _0x127ba0=_0x241b18;if(_0x56fc05)return;_0x56fc05=!![],document[_0x127ba0(0x11e3)](_0x127ba0(0x9fc))[_0x127ba0(0x505)][_0x127ba0(0x252)](_0x127ba0(0xcd4)),_0x25cb91(_0x2b8ddd);}function _0x2192b8(){const _0x59f2cb=_0x241b18;_0x27f384();if(!_0x56fc05)return;_0x56fc05=![],document[_0x59f2cb(0x11e3)](_0x59f2cb(0x9fc))[_0x59f2cb(0x505)][_0x59f2cb(0x957)](_0x59f2cb(0xcd4)),_0x281a6a[_0x59f2cb(0x494)](_0x5b7626=>{const _0x540faa=_0x59f2cb,_0x2a7549=document[_0x540faa(0x5ac)]('.message-bubble[data-timestamp=\x22'+_0x5b7626+'\x22]');if(_0x2a7549)_0x2a7549['classList'][_0x540faa(0x957)]('selected');}),_0x281a6a[_0x59f2cb(0x7ab)]();}function _0x25cb91(_0x56e86b){const _0x26f538=_0x241b18,_0x558788=document[_0x26f538(0x5ac)](_0x26f538(0x955)+_0x56e86b+'\x22]');if(!_0x558788)return;_0x281a6a[_0x26f538(0x72a)](_0x56e86b)?(_0x281a6a[_0x26f538(0xc0c)](_0x56e86b),_0x558788[_0x26f538(0x505)][_0x26f538(0x957)](_0x26f538(0xbbc))):(_0x281a6a[_0x26f538(0x252)](_0x56e86b),_0x558788[_0x26f538(0x505)][_0x26f538(0x252)](_0x26f538(0xbbc))),document[_0x26f538(0x11e3)](_0x26f538(0xd6))[_0x26f538(0x300)]=_0x26f538(0x79d)+_0x281a6a[_0x26f538(0x1159)]+'\x20条',_0x281a6a[_0x26f538(0x1159)]===0x0&&_0x2192b8();}function _0xcb6204(_0x203c4c,_0x48ce3a){const _0x17b886=_0x241b18;let _0x3cf18e;const _0x48e9f3=_0xd950b8=>{const _0x1538d0=_0x10a9;if(_0x56fc05)return;_0xd950b8[_0x1538d0(0xf87)](),_0x3cf18e=window['setTimeout'](()=>_0x48ce3a(_0xd950b8),0x1f4);},_0x212b64=()=>clearTimeout(_0x3cf18e);_0x203c4c[_0x17b886(0x4b8)](_0x17b886(0xc23),_0x48e9f3),_0x203c4c[_0x17b886(0x4b8)]('mouseup',_0x212b64),_0x203c4c[_0x17b886(0x4b8)](_0x17b886(0x881),_0x212b64),_0x203c4c['addEventListener'](_0x17b886(0x39e),_0x48e9f3,{'passive':!![]}),_0x203c4c[_0x17b886(0x4b8)]('touchend',_0x212b64),_0x203c4c[_0x17b886(0x4b8)]('touchmove',_0x212b64);}async function _0x3c5a85(){const _0x539a03=_0x241b18,_0x230585=_0x5de8b7['activeChatId'];if(!_0x230585)return;if(!_0xb57b5b[_0x539a03(0x3d5)]){_0x405533(_0x230585);return;}if(_0xb57b5b[_0x539a03(0x93d)]===_0x230585)document[_0x539a03(0x11e3)](_0x539a03(0xbb4))[_0x539a03(0x505)][_0x539a03(0x252)](_0x539a03(0x250));else{const _0x4fa5c9=_0x5de8b7[_0x539a03(0x737)][_0xb57b5b[_0x539a03(0x93d)]]?.[_0x539a03(0x278)]||'未知',_0x1561a4=_0x5de8b7[_0x539a03(0x737)][_0x230585]?.['name']||'当前',_0x297404=await _0x58fd60(_0x539a03(0x12a9),'您正和「'+_0x4fa5c9+_0x539a03(0x9f6)+_0x1561a4+_0x539a03(0xa91),{'confirmButtonClass':_0x539a03(0x8a6)});_0x297404&&(await _0x48cc94(!![]),await new Promise(_0x200632=>setTimeout(_0x200632,0x32)),_0x405533(_0x230585));}}async function _0x405533(_0x3037bf){const _0x558439=_0x241b18,_0x37442a=_0x5de8b7[_0x558439(0x737)][_0x3037bf];if(!_0x37442a)return;_0xb57b5b['totalElapsedTime']=_0x37442a[_0x558439(0x6c7)]['totalTime']||0x0,_0xb57b5b['isActive']=!![],_0xb57b5b[_0x558439(0x93d)]=_0x3037bf;_0xb57b5b[_0x558439(0xcba)]['length']>0x0?_0xb57b5b[_0x558439(0x12b5)]=0x0:_0xb57b5b[_0x558439(0x12b5)]=-0x1;if(_0xb57b5b[_0x558439(0x1bf)])clearInterval(_0xb57b5b[_0x558439(0x1bf)]);_0xb57b5b['timerId']=setInterval(()=>{const _0x1dd52f=_0x558439;_0xb57b5b[_0x1dd52f(0x9b0)]&&(_0xb57b5b[_0x1dd52f(0x611)]++,_0x2c5159());},0x3e8),_0x359e1c(),_0x31e1af(),document[_0x558439(0x11e3)](_0x558439(0xbb4))[_0x558439(0x505)][_0x558439(0x252)]('visible');}async function _0x48cc94(_0x563820=!![]){const _0x219612=_0x241b18;if(!_0xb57b5b[_0x219612(0x3d5)])return;const _0x1ee9f6=_0xb57b5b[_0x219612(0x93d)];document['getElementById'](_0x219612(0x68d))[_0x219612(0x505)][_0x219612(0x957)](_0x219612(0x250));const _0x9a0b21=async()=>{const _0x3d8784=_0x219612;if(_0xb57b5b[_0x3d8784(0x1bf)])clearInterval(_0xb57b5b[_0x3d8784(0x1bf)]);if(_0xb57b5b[_0x3d8784(0x9b0)])_0x7cf0d1['pause']();if(_0x563820&&_0x1ee9f6&&_0x5de8b7[_0x3d8784(0x737)][_0x1ee9f6]){const _0x2242e1=_0x5de8b7[_0x3d8784(0x737)][_0x1ee9f6];_0x2242e1[_0x3d8784(0x6c7)][_0x3d8784(0xa86)]=_0xb57b5b[_0x3d8784(0x611)],await _0x2e83f8['chats'][_0x3d8784(0xe3c)](_0x2242e1);}_0xb57b5b['isActive']=![],_0xb57b5b['activeChatId']=null,_0xb57b5b[_0x3d8784(0x611)]=0x0,_0xb57b5b[_0x3d8784(0x1bf)]=null,_0x8d609d(_0x1ee9f6,!![]);};_0x46c07e(_0x9a0b21);}function _0x366f7e(){_0x46c07e();}function _0x8d609d(_0x476c53,_0x10c1e6=![]){const _0x5c97c8=_0x241b18,_0x38928d=document[_0x5c97c8(0x5ac)]('#listen-together-btn\x20img');if(!_0x38928d)return;if(_0x10c1e6||!_0xb57b5b[_0x5c97c8(0x3d5)]||_0xb57b5b['activeChatId']!==_0x476c53){_0x38928d[_0x5c97c8(0xf0a)]=_0x5c97c8(0x31b),_0x38928d[_0x5c97c8(0x3db)]='';return;}_0x38928d[_0x5c97c8(0xf0a)]=_0x5c97c8(0xd77),_0x38928d['classList']['add'](_0x5c97c8(0x12cf));if(_0xb57b5b[_0x5c97c8(0x9b0)])_0x38928d[_0x5c97c8(0x505)][_0x5c97c8(0x957)](_0x5c97c8(0x950));else _0x38928d[_0x5c97c8(0x505)]['add']('paused');}window['updateListenTogetherIconProxy']=_0x8d609d;function _0x359e1c(){const _0x516d5a=_0x241b18;_0x8d609d(_0xb57b5b[_0x516d5a(0x93d)]),_0x2c5159();const _0xf93d1a=document[_0x516d5a(0x11e3)](_0x516d5a(0x9a0)),_0x3cfbea=document['getElementById'](_0x516d5a(0x65d)),_0x1ab6a2=document[_0x516d5a(0x11e3)](_0x516d5a(0xf5d));if(_0xb57b5b['currentIndex']>-0x1&&_0xb57b5b[_0x516d5a(0xcba)][_0x516d5a(0x594)]>0x0){const _0x5b5097=_0xb57b5b[_0x516d5a(0xcba)][_0xb57b5b[_0x516d5a(0x12b5)]];_0xf93d1a['textContent']=_0x5b5097[_0x516d5a(0x278)],_0x3cfbea[_0x516d5a(0x300)]=_0x5b5097[_0x516d5a(0xb9f)];}else _0xf93d1a[_0x516d5a(0x300)]=_0x516d5a(0xa82),_0x3cfbea[_0x516d5a(0x300)]=_0x516d5a(0x6cb);_0x1ab6a2['textContent']=_0xb57b5b[_0x516d5a(0x9b0)]?'❚❚':'▶';}function _0x2c5159(){const _0x2b58a6=_0x241b18,_0x465269=(_0xb57b5b[_0x2b58a6(0x611)]/0xe10)['toFixed'](0x1);document[_0x2b58a6(0x11e3)](_0x2b58a6(0x422))[_0x2b58a6(0x300)]=_0x2b58a6(0xb48)+_0x465269+'小时';}function _0x31e1af(){const _0xef82c9=_0x241b18,_0x1279c1=document[_0xef82c9(0x11e3)](_0xef82c9(0xfe6));_0x1279c1[_0xef82c9(0x595)]='';if(_0xb57b5b[_0xef82c9(0xcba)][_0xef82c9(0x594)]===0x0){_0x1279c1['innerHTML']=_0xef82c9(0x854);return;}_0xb57b5b['playlist'][_0xef82c9(0x494)]((_0x2c699f,_0x2cb339)=>{const _0x540593=_0xef82c9,_0xd41d78=document['createElement'](_0x540593(0x1285));_0xd41d78['className']=_0x540593(0x7dd);if(_0x2cb339===_0xb57b5b[_0x540593(0x12b5)])_0xd41d78[_0x540593(0x505)][_0x540593(0x252)]('playing');_0xd41d78[_0x540593(0x595)]=_0x540593(0x5cc)+_0x2c699f[_0x540593(0x278)]+_0x540593(0x787)+_0x2c699f[_0x540593(0xb9f)]+_0x540593(0x44a)+_0x2cb339+_0x540593(0xb7f)+_0x2cb339+_0x540593(0x809)+_0x2cb339+_0x540593(0x1013)+_0x2cb339+_0x540593(0xab2),_0xd41d78[_0x540593(0x5ac)](_0x540593(0x2ba))[_0x540593(0x4b8)]('click',()=>_0x23e7aa(_0x2cb339)),_0x1279c1[_0x540593(0x120c)](_0xd41d78);});}async function _0x526dbe(){const _0x417363=_0x241b18;if(_0x7cf0d1[_0x417363(0x950)]){if(_0xb57b5b['currentIndex']===-0x1&&_0xb57b5b[_0x417363(0xcba)][_0x417363(0x594)]>0x0)_0x23e7aa(0x0);else _0xb57b5b[_0x417363(0x12b5)]>-0x1&&_0x23e7aa(_0xb57b5b[_0x417363(0x12b5)]);}else _0x7cf0d1['pause'](),await _0x26a68c('暂停了音乐');}function _0x352010(){const _0x47613e=_0x241b18;if(_0xb57b5b[_0x47613e(0xcba)][_0x47613e(0x594)]===0x0)return;let _0x1f49d4;switch(_0xb57b5b['playMode']){case _0x47613e(0x36d):_0x1f49d4=Math[_0x47613e(0xfb1)](Math[_0x47613e(0x36d)]()*_0xb57b5b[_0x47613e(0xcba)][_0x47613e(0x594)]);break;case _0x47613e(0xdd5):_0x23e7aa(_0xb57b5b[_0x47613e(0x12b5)]);return;case _0x47613e(0xd6a):default:_0x1f49d4=(_0xb57b5b[_0x47613e(0x12b5)]+0x1)%_0xb57b5b[_0x47613e(0xcba)]['length'];break;}_0x23e7aa(_0x1f49d4);}function _0x30a4d5(){const _0x2c5e49=_0x241b18;if(_0xb57b5b[_0x2c5e49(0xcba)][_0x2c5e49(0x594)]===0x0)return;const _0x1b7101=(_0xb57b5b[_0x2c5e49(0x12b5)]-0x1+_0xb57b5b[_0x2c5e49(0xcba)][_0x2c5e49(0x594)])%_0xb57b5b[_0x2c5e49(0xcba)]['length'];_0x23e7aa(_0x1b7101);}function _0x3085f2(){const _0x19789b=_0x241b18,_0x3d060f=[_0x19789b(0xd6a),'random','single'],_0xad5962=_0x3d060f[_0x19789b(0xce1)](_0xb57b5b[_0x19789b(0xd3b)]);_0xb57b5b[_0x19789b(0xd3b)]=_0x3d060f[(_0xad5962+0x1)%_0x3d060f[_0x19789b(0x594)]],document[_0x19789b(0x11e3)]('music-mode-btn')['textContent']={'order':'顺序','random':'随机','single':'单曲'}[_0xb57b5b[_0x19789b(0xd3b)]];}async function _0x54f4bb(){const _0x1e80b7=_0x241b18,_0x51edc9=await _0x231a5a('添加网络歌曲','请输入歌曲的URL','',_0x1e80b7(0x10ac));if(!_0x51edc9)return;const _0x564754=await _0x231a5a(_0x1e80b7(0xc22),_0x1e80b7(0xca5));if(!_0x564754)return;const _0x922f05=await _0x231a5a(_0x1e80b7(0xc22),_0x1e80b7(0xe8a));if(!_0x922f05)return;_0xb57b5b[_0x1e80b7(0xcba)][_0x1e80b7(0xf5)]({'name':_0x564754,'artist':_0x922f05,'src':_0x51edc9,'isLocal':![]}),await _0x539eb1(),_0x31e1af(),_0xb57b5b[_0x1e80b7(0x12b5)]===-0x1&&(_0xb57b5b[_0x1e80b7(0x12b5)]=_0xb57b5b['playlist'][_0x1e80b7(0x594)]-0x1,_0x359e1c());}async function _0x274cd7(_0x10484d){const _0x507dbd=_0x241b18,_0x1ce0d0=_0x10484d['target'][_0x507dbd(0x5c9)];if(!_0x1ce0d0[_0x507dbd(0x594)])return;for(const _0x219486 of _0x1ce0d0){let _0x51bb2e=_0x219486[_0x507dbd(0x278)]['replace'](/\.[^/.]+$/,'');_0x51bb2e=await _0x231a5a(_0x507dbd(0xc22),'请输入歌名',_0x51bb2e);if(_0x51bb2e===null)continue;const _0x1f9007=await _0x231a5a(_0x507dbd(0xc22),_0x507dbd(0xe8a),_0x507dbd(0xe1c));if(_0x1f9007===null)continue;const _0x2e3fc6=await _0x219486[_0x507dbd(0xd26)]();let _0xebdeb='';const _0x8821d0=await _0x58fd60(_0x507dbd(0xb14),_0x507dbd(0xc42)+_0x51bb2e+'》添加歌词吗？');_0x8821d0&&(_0xebdeb=await _0x128ad1()||''),_0xb57b5b[_0x507dbd(0xcba)][_0x507dbd(0xf5)]({'name':_0x51bb2e,'artist':_0x1f9007,'src':_0x2e3fc6,'fileType':_0x219486[_0x507dbd(0xa20)],'isLocal':!![],'lrcContent':_0xebdeb,'cover':_0x507dbd(0xe71)});}await _0x539eb1(),_0x31e1af(),_0xb57b5b[_0x507dbd(0x12b5)]===-0x1&&_0xb57b5b[_0x507dbd(0xcba)][_0x507dbd(0x594)]>0x0&&(_0xb57b5b[_0x507dbd(0x12b5)]=0x0,_0x359e1c()),_0x10484d[_0x507dbd(0xd7c)]['value']=null;}async function _0x23e7aa(_0x5ba0d5){const _0x5d742f=_0x241b18;if(_0x5ba0d5<0x0||_0x5ba0d5>=_0xb57b5b[_0x5d742f(0xcba)][_0x5d742f(0x594)])return;_0x7cf0d1[_0x5d742f(0x9b1)](),_0xb57b5b[_0x5d742f(0x12b5)]=_0x5ba0d5;const _0x5974f5=_0xb57b5b[_0x5d742f(0xcba)][_0x5ba0d5],_0x47b205=_0x5de8b7[_0x5d742f(0x737)][_0xb57b5b[_0x5d742f(0x93d)]],_0x45a846=document['getElementById'](_0x5d742f(0x3d1));if(_0x47b205&&_0x45a846){_0x45a846[_0x5d742f(0x595)]='';const _0x41cb1d=_0x47b205['isGroup']?_0x47b205[_0x5d742f(0x2b3)][_0x5d742f(0xe79)](_0x46f651=>_0x46f651[_0x5d742f(0x697)]===_0x5974f5[_0x5d742f(0xb9f)])?.[_0x5d742f(0x525)]||_0x3d2e44:_0x47b205[_0x5d742f(0x761)][_0x5d742f(0x5e0)]||_0x3d2e44,_0x32d3ce=_0x47b205[_0x5d742f(0x761)][_0x5d742f(0xc43)]||_0x3d2e44,_0x46ef50=document[_0x5d742f(0x383)]('img');_0x46ef50[_0x5d742f(0xf0a)]=_0x41cb1d,_0x46ef50[_0x5d742f(0x3db)]='participant-display-avatar',_0x46ef50[_0x5d742f(0x71f)]=_0x5d742f(0xa3b),_0x45a846[_0x5d742f(0x120c)](_0x46ef50);const _0x4f3a18=document['createElement'](_0x5d742f(0x1232));_0x4f3a18[_0x5d742f(0xf0a)]=_0x32d3ce,_0x4f3a18[_0x5d742f(0x3db)]=_0x5d742f(0x1303),_0x4f3a18[_0x5d742f(0x71f)]=_0x5d742f(0xc09),_0x45a846[_0x5d742f(0x120c)](_0x4f3a18);}const _0x52b04d=document[_0x5d742f(0x5ac)](_0x5d742f(0x3ce)),_0x2f05b1=document['getElementById']('toggle-blur-btn');_0x52b04d&&(_0x52b04d[_0x5d742f(0x794)][_0x5d742f(0xd8c)](_0x5d742f(0xa0c),_0x5974f5[_0x5d742f(0xd10)]?'url('+_0x5974f5['background']+')':_0x5d742f(0x379)),_0x52b04d[_0x5d742f(0x505)]['toggle']('bg-clear',!!_0x5974f5[_0x5d742f(0xa06)]));_0x2f05b1&&_0x2f05b1[_0x5d742f(0x505)][_0x5d742f(0xe7e)](_0x5d742f(0x1fc),!!_0x5974f5[_0x5d742f(0xa06)]);document[_0x5d742f(0x11e3)](_0x5d742f(0x1060))['classList'][_0x5d742f(0x957)](_0x5d742f(0xde6));const _0xf253d3=document[_0x5d742f(0x11e3)](_0x5d742f(0x1084));_0xf253d3&&(_0xf253d3[_0x5d742f(0xf0a)]=_0x5974f5[_0x5d742f(0x2ee)]||_0x5d742f(0xe71));await _0x26a68c(_0x5d742f(0xeed)+_0x5974f5[_0x5d742f(0x278)]+'》'),_0xb57b5b['parsedLyrics']=_0x2a2377(_0x5974f5['lrcContent']||''),_0x45cb2c();const _0xc64e48=document[_0x5d742f(0x11e3)]('single-lyric-display');_0xc64e48&&(!_0xb57b5b[_0x5d742f(0x1194)]||_0xb57b5b[_0x5d742f(0x1194)][_0x5d742f(0x594)]===0x0?_0xc64e48['textContent']=_0x5d742f(0x125):_0xc64e48[_0x5d742f(0x300)]=_0x5d742f(0xda3));if(_0x5974f5[_0x5d742f(0x101e)]&&_0x5974f5[_0x5d742f(0xf0a)]instanceof ArrayBuffer){const _0x366acc=new Blob([_0x5974f5[_0x5d742f(0xf0a)]],{'type':_0x5974f5[_0x5d742f(0xef0)]||_0x5d742f(0x8ae)});_0x7cf0d1['src']=URL[_0x5d742f(0x12fd)](_0x366acc);}else{if(_0x5974f5[_0x5d742f(0x101e)]&&_0x5974f5[_0x5d742f(0xf0a)]instanceof Blob)_0x7cf0d1[_0x5d742f(0xf0a)]=URL[_0x5d742f(0x12fd)](_0x5974f5[_0x5d742f(0xf0a)]);else{if(!_0x5974f5[_0x5d742f(0x101e)])_0x7cf0d1[_0x5d742f(0xf0a)]=_0x5974f5[_0x5d742f(0xf0a)];else{console[_0x5d742f(0x1c1)](_0x5d742f(0xa0d),_0x5974f5);return;}}}const _0x515489=_0x7cf0d1['play']();_0x515489!==undefined&&_0x515489[_0x5d742f(0x100)](_0x25ec76=>{const _0xfb58c7=_0x5d742f;if(_0x25ec76[_0xfb58c7(0x278)]===_0xfb58c7(0x693))console[_0xfb58c7(0x6b0)]('Autoplay\x20was\x20prevented\x20by\x20the\x20browser.'),_0x7cf0d1['pause'](),_0x2fb06(_0xfb58c7(0x5e4),_0xfb58c7(0x10cd));else _0x25ec76[_0xfb58c7(0x278)]!==_0xfb58c7(0x1148)&&console[_0xfb58c7(0x1c1)](_0xfb58c7(0x77c),_0x25ec76);});_0x31e1af(),_0x359e1c(),_0x483d71();const _0x103cb3=document[_0x5d742f(0x11e3)](_0x5d742f(0x68d));_0xb57b5b[_0x5d742f(0x1194)]&&_0xb57b5b['parsedLyrics'][_0x5d742f(0x594)]>0x0?(_0x103cb3['textContent']='♪',_0x103cb3['classList'][_0x5d742f(0x252)](_0x5d742f(0x250))):_0x103cb3['classList'][_0x5d742f(0x957)]('visible');}async function _0x129b6(_0x43df29){const _0x5de45d=_0x241b18;if(_0x43df29<0x0||_0x43df29>=_0xb57b5b[_0x5de45d(0xcba)]['length'])return;const _0x3291e2=await _0x16a8e1('更换歌曲背景',[{'text':_0x5de45d(0xe72),'value':_0x5de45d(0xd1b)},{'text':_0x5de45d(0x111b),'value':_0x5de45d(0x10ac)}]);let _0x4f0ba4=null;if(_0x3291e2===_0x5de45d(0xd1b))_0x4f0ba4=await _0x3b69be();else _0x3291e2===_0x5de45d(0x10ac)&&(_0x4f0ba4=await _0x231a5a(_0x5de45d(0xea2),_0x5de45d(0xf63),'',_0x5de45d(0x10ac)));if(_0x4f0ba4&&_0x4f0ba4['trim']()){_0xb57b5b[_0x5de45d(0xcba)][_0x43df29][_0x5de45d(0xd10)]=_0x4f0ba4[_0x5de45d(0xeb7)](),await _0x539eb1();if(_0xb57b5b[_0x5de45d(0x12b5)]===_0x43df29){const _0x42f6a5=document[_0x5de45d(0x5ac)](_0x5de45d(0x3ce));_0x42f6a5[_0x5de45d(0x794)][_0x5de45d(0xd8c)](_0x5de45d(0xa0c),'url('+_0x4f0ba4[_0x5de45d(0xeb7)]()+')');}await _0x2fb06('成功',_0x5de45d(0x11b));}}async function _0x3e7d39(_0x3d6863){const _0x39c0e3=_0x241b18;if(_0x3d6863<0x0||_0x3d6863>=_0xb57b5b[_0x39c0e3(0xcba)][_0x39c0e3(0x594)])return;const _0x499881=await _0x16a8e1(_0x39c0e3(0xd6c),[{'text':_0x39c0e3(0xe72),'value':'local'},{'text':'🌐\x20使用网络URL','value':'url'}]);let _0x1cab27=null;if(_0x499881==='local')_0x1cab27=await _0x3b69be();else _0x499881===_0x39c0e3(0x10ac)&&(_0x1cab27=await _0x231a5a(_0x39c0e3(0xea2),_0x39c0e3(0x956),'','url'));if(_0x1cab27&&_0x1cab27[_0x39c0e3(0xeb7)]()){_0xb57b5b[_0x39c0e3(0xcba)][_0x3d6863][_0x39c0e3(0x2ee)]=_0x1cab27['trim'](),await _0x539eb1();if(_0xb57b5b[_0x39c0e3(0x12b5)]===_0x3d6863){document[_0x39c0e3(0x11e3)]('music-player-cover')[_0x39c0e3(0xf0a)]=_0x1cab27[_0x39c0e3(0xeb7)]();const _0x127111=document['querySelector'](_0x39c0e3(0xe15));if(_0x127111)_0x127111[_0x39c0e3(0xf0a)]=_0x1cab27[_0x39c0e3(0xeb7)]();}await _0x2fb06('成功','专辑封面已更新！');}}async function _0x126e32(_0x28a347){const _0x50f944=_0x241b18;if(_0x28a347<0x0||_0x28a347>=_0xb57b5b[_0x50f944(0xcba)]['length'])return;const _0x118a54=_0xb57b5b[_0x50f944(0xcba)][_0x28a347],_0x82c603=_0xb57b5b[_0x50f944(0x9b0)]&&_0xb57b5b[_0x50f944(0x12b5)]===_0x28a347;if(_0x118a54[_0x50f944(0x101e)]&&_0x7cf0d1[_0x50f944(0xf0a)][_0x50f944(0xb6c)](_0x50f944(0x19b))&&_0xb57b5b[_0x50f944(0x12b5)]===_0x28a347)URL[_0x50f944(0xa02)](_0x7cf0d1['src']);_0xb57b5b[_0x50f944(0xcba)][_0x50f944(0xfd0)](_0x28a347,0x1),await _0x539eb1();if(_0xb57b5b['playlist'][_0x50f944(0x594)]===0x0){if(_0xb57b5b['isPlaying'])_0x7cf0d1['pause']();_0x7cf0d1[_0x50f944(0xf0a)]='',_0xb57b5b[_0x50f944(0x12b5)]=-0x1,_0xb57b5b[_0x50f944(0x9b0)]=![];}else{if(_0x82c603)_0x352010();else{if(_0xb57b5b[_0x50f944(0x12b5)]>=_0x28a347)_0xb57b5b[_0x50f944(0x12b5)]=Math[_0x50f944(0x45d)](0x0,_0xb57b5b[_0x50f944(0x12b5)]-0x1);}}_0x359e1c(),_0x31e1af();}async function _0x274cd7(_0x68463f){const _0x2b6219=_0x241b18,_0x3e3098=_0x68463f[_0x2b6219(0xd7c)][_0x2b6219(0x5c9)];if(!_0x3e3098['length'])return;for(const _0x5f1075 of _0x3e3098){let _0x45b0cd=_0x5f1075[_0x2b6219(0x278)][_0x2b6219(0x1018)](/\.[^/.]+$/,'');_0x45b0cd=await _0x231a5a(_0x2b6219(0xc22),'请输入歌名',_0x45b0cd);if(_0x45b0cd===null)continue;const _0x306117=await _0x231a5a(_0x2b6219(0xc22),'请输入歌手名',_0x2b6219(0xe1c));if(_0x306117===null)continue;let _0x5ede5a='';const _0x5eed67=await _0x58fd60('导入歌词','要为《'+_0x45b0cd+'》添加歌词吗？');_0x5eed67&&(_0x5ede5a=await _0x128ad1()||''),_0xb57b5b['playlist'][_0x2b6219(0xf5)]({'name':_0x45b0cd,'artist':_0x306117,'src':_0x5f1075,'isLocal':!![],'lrcContent':_0x5ede5a});}await _0x539eb1(),_0x31e1af(),_0xb57b5b['currentIndex']===-0x1&&_0xb57b5b[_0x2b6219(0xcba)][_0x2b6219(0x594)]>0x0&&(_0xb57b5b['currentIndex']=0x0,_0x359e1c()),_0x68463f[_0x2b6219(0xd7c)]['value']=null;}async function _0x126e32(_0x106268){const _0x3e7c5e=_0x241b18;if(_0x106268<0x0||_0x106268>=_0xb57b5b[_0x3e7c5e(0xcba)]['length'])return;const _0x504d6d=_0xb57b5b[_0x3e7c5e(0xcba)][_0x106268],_0x5236d0=_0xb57b5b[_0x3e7c5e(0x9b0)]&&_0xb57b5b[_0x3e7c5e(0x12b5)]===_0x106268;if(_0x504d6d[_0x3e7c5e(0x101e)]&&_0x7cf0d1[_0x3e7c5e(0xf0a)][_0x3e7c5e(0xb6c)](_0x3e7c5e(0x19b))&&_0xb57b5b[_0x3e7c5e(0x12b5)]===_0x106268)URL['revokeObjectURL'](_0x7cf0d1['src']);_0xb57b5b[_0x3e7c5e(0xcba)][_0x3e7c5e(0xfd0)](_0x106268,0x1),await _0x539eb1();if(_0xb57b5b[_0x3e7c5e(0xcba)][_0x3e7c5e(0x594)]===0x0){if(_0xb57b5b[_0x3e7c5e(0x9b0)])_0x7cf0d1['pause']();_0x7cf0d1[_0x3e7c5e(0xf0a)]='',_0xb57b5b[_0x3e7c5e(0x12b5)]=-0x1,_0xb57b5b[_0x3e7c5e(0x9b0)]=![];}else{if(_0x5236d0)_0x352010();else{if(_0xb57b5b[_0x3e7c5e(0x12b5)]>=_0x106268)_0xb57b5b[_0x3e7c5e(0x12b5)]=Math[_0x3e7c5e(0x45d)](0x0,_0xb57b5b[_0x3e7c5e(0x12b5)]-0x1);}}_0x359e1c(),_0x31e1af();}const _0x11494c=document[_0x241b18(0x11e3)](_0x241b18(0x13f)),_0x45ba1b=document[_0x241b18(0x11e3)](_0x241b18(0x15d)),_0x443cc7=document['getElementById'](_0x241b18(0x11c2));function _0x4825d(){const _0xdab4d7=_0x241b18;_0x5e4c41(),_0x11494c['classList'][_0xdab4d7(0x252)](_0xdab4d7(0x250));}function _0xe1b60d(){const _0x1ae133=_0x241b18;_0x11494c[_0x1ae133(0x505)][_0x1ae133(0x957)](_0x1ae133(0x250));}function _0x5e4c41(){const _0x10da2b=_0x241b18,_0x4f360e=document['getElementById']('persona-library-grid');_0x4f360e[_0x10da2b(0x595)]='';if(_0x5de8b7[_0x10da2b(0x216)][_0x10da2b(0x594)]===0x0){_0x4f360e[_0x10da2b(0x595)]=_0x10da2b(0x912);return;}_0x5de8b7[_0x10da2b(0x216)][_0x10da2b(0x494)](_0x2a1237=>{const _0x3a8186=_0x10da2b,_0x214e35=document['createElement'](_0x3a8186(0x1285));_0x214e35[_0x3a8186(0x3db)]=_0x3a8186(0x198),_0x214e35['style']['backgroundImage']=_0x3a8186(0xac7)+_0x2a1237[_0x3a8186(0x525)]+')',_0x214e35[_0x3a8186(0xaca)][_0x3a8186(0x10d0)]=_0x2a1237['id'],_0x214e35[_0x3a8186(0x4b8)](_0x3a8186(0x1041),()=>_0x4a3ddc(_0x2a1237['id'])),_0xcb6204(_0x214e35,()=>_0x413f32(_0x2a1237['id'])),_0x4f360e['appendChild'](_0x214e35);});}function _0x413f32(_0x2e5059){const _0x53f7fa=_0x241b18;_0x34c788=_0x2e5059,_0x443cc7[_0x53f7fa(0x505)]['add']('visible');}function _0x491938(){const _0x2cae24=_0x241b18;_0x443cc7[_0x2cae24(0x505)][_0x2cae24(0x957)](_0x2cae24(0x250)),_0x34c788=null;}function _0x4a3ddc(_0x5039b0){const _0x5ddcac=_0x241b18,_0x2bde6d=_0x5de8b7[_0x5ddcac(0x216)][_0x5ddcac(0xe79)](_0x2611c6=>_0x2611c6['id']===_0x5039b0);_0x2bde6d&&(document[_0x5ddcac(0x11e3)](_0x5ddcac(0x8b3))[_0x5ddcac(0xf0a)]=_0x2bde6d[_0x5ddcac(0x525)],document[_0x5ddcac(0x11e3)](_0x5ddcac(0x63f))[_0x5ddcac(0xf27)]=_0x2bde6d['persona']),_0xe1b60d();}function _0x22cf3d(){const _0x44f1b2=_0x241b18;_0x34c788=null,document[_0x44f1b2(0x11e3)]('persona-editor-title')['textContent']=_0x44f1b2(0xab5),document[_0x44f1b2(0x11e3)](_0x44f1b2(0x12ce))[_0x44f1b2(0xf0a)]=_0x3d2e44,document[_0x44f1b2(0x11e3)](_0x44f1b2(0x11de))[_0x44f1b2(0xf27)]='',_0x45ba1b[_0x44f1b2(0x505)][_0x44f1b2(0x252)]('visible');}function _0x5f44d8(){const _0x4fa8ea=_0x241b18,_0x275f79=_0x5de8b7['personaPresets'][_0x4fa8ea(0xe79)](_0x1ffda8=>_0x1ffda8['id']===_0x34c788);if(!_0x275f79)return;document[_0x4fa8ea(0x11e3)]('persona-editor-title')[_0x4fa8ea(0x300)]=_0x4fa8ea(0x826),document[_0x4fa8ea(0x11e3)](_0x4fa8ea(0x12ce))[_0x4fa8ea(0xf0a)]=_0x275f79[_0x4fa8ea(0x525)],document[_0x4fa8ea(0x11e3)]('preset-persona-input')[_0x4fa8ea(0xf27)]=_0x275f79[_0x4fa8ea(0x701)],_0x443cc7[_0x4fa8ea(0x505)][_0x4fa8ea(0x957)](_0x4fa8ea(0x250)),_0x45ba1b[_0x4fa8ea(0x505)]['add']('visible');}async function _0x372fbf(){const _0x2fe79b=_0x241b18,_0x1d8020=await _0x58fd60(_0x2fe79b(0x30c),_0x2fe79b(0xe8b),{'confirmButtonClass':_0x2fe79b(0x8a6)});_0x1d8020&&_0x34c788&&(await _0x2e83f8['personaPresets'][_0x2fe79b(0xc0c)](_0x34c788),_0x5de8b7['personaPresets']=_0x5de8b7[_0x2fe79b(0x216)][_0x2fe79b(0x138)](_0x3409e3=>_0x3409e3['id']!==_0x34c788),_0x491938(),_0x5e4c41());}function _0x2fc05c(){const _0x39fda7=_0x241b18;_0x45ba1b[_0x39fda7(0x505)][_0x39fda7(0x957)](_0x39fda7(0x250)),_0x34c788=null;}async function _0x14d87d(){const _0x46f75b=_0x241b18,_0x2e6d3d=document[_0x46f75b(0x11e3)]('preset-avatar-preview')['src'],_0x5043f9=document['getElementById'](_0x46f75b(0x11de))[_0x46f75b(0xf27)][_0x46f75b(0xeb7)]();if(_0x2e6d3d===_0x3d2e44&&!_0x5043f9){alert(_0x46f75b(0x125d));return;}if(_0x34c788){const _0x49e405=_0x5de8b7[_0x46f75b(0x216)][_0x46f75b(0xe79)](_0x54c08a=>_0x54c08a['id']===_0x34c788);_0x49e405&&(_0x49e405[_0x46f75b(0x525)]=_0x2e6d3d,_0x49e405['persona']=_0x5043f9,await _0x2e83f8[_0x46f75b(0x216)]['put'](_0x49e405));}else{const _0x149fb3={'id':_0x46f75b(0x11c0)+Date[_0x46f75b(0x1182)](),'avatar':_0x2e6d3d,'persona':_0x5043f9};await _0x2e83f8[_0x46f75b(0x216)]['add'](_0x149fb3),_0x5de8b7['personaPresets']['push'](_0x149fb3);}_0x5e4c41(),_0x2fc05c();}const _0x3c5ee6=document[_0x241b18(0x11e3)](_0x241b18(0xb3f));function _0x94e7c6(_0x2f0f64,_0x575cf0){const _0x1c8794=_0x241b18;clearTimeout(_0x400ccc),document[_0x1c8794(0x11e3)](_0x1c8794(0x1dd))[_0x1c8794(0xf0a)]=_0x2f0f64,document[_0x1c8794(0x11e3)](_0x1c8794(0xd5f))[_0x1c8794(0x300)]=_0x575cf0,_0x3c5ee6[_0x1c8794(0x505)][_0x1c8794(0x252)](_0x1c8794(0x250));const _0xbb3dd7=()=>{const _0x10ae15=_0x1c8794;_0x3c5ee6[_0x10ae15(0x505)]['remove'](_0x10ae15(0x250)),_0x3c5ee6['removeEventListener'](_0x10ae15(0x1041),_0xbb3dd7);};_0x3c5ee6['addEventListener']('click',_0xbb3dd7),_0x400ccc=setTimeout(_0xbb3dd7,0x7d0);}function _0x4b58e8(_0x23f65a){const _0x2ca3fd=_0x241b18,_0x4948fb=document[_0x2ca3fd(0x11e3)](_0x2ca3fd(0x1fa)),_0x1bc1b7=_0x4948fb['querySelector'](_0x2ca3fd(0x384)),_0x4fcca6=_0x4948fb[_0x2ca3fd(0x5ac)](_0x2ca3fd(0xc60)),_0x573ca7=Math[_0x2ca3fd(0xfb1)](_0x23f65a['level']*0x64);_0x1bc1b7[_0x2ca3fd(0x794)]['width']=_0x573ca7+'%',_0x4fcca6[_0x2ca3fd(0x300)]=_0x573ca7+'%',_0x23f65a[_0x2ca3fd(0xda4)]?_0x4948fb['classList'][_0x2ca3fd(0x252)]('charging'):_0x4948fb[_0x2ca3fd(0x505)][_0x2ca3fd(0x957)]('charging');}function _0x3c43ec(_0x2c535c){const _0x3e50ab=_0x241b18;_0x4b58e8(_0x2c535c);const _0x16742b=_0x2c535c[_0x3e50ab(0xcdc)];!_0x2c535c[_0x3e50ab(0xda4)]&&(_0x16742b<=0.4&&_0x23da11>0.4&&!_0x492ffd['hasShown40']&&(_0x94e7c6(_0x3e50ab(0xbb5),_0x3e50ab(0xf71)),_0x492ffd[_0x3e50ab(0x397)]=!![]),_0x16742b<=0.2&&_0x23da11>0.2&&!_0x492ffd[_0x3e50ab(0xe68)]&&(_0x94e7c6(_0x3e50ab(0x12a8),_0x3e50ab(0x862)),_0x492ffd[_0x3e50ab(0xe68)]=!![]),_0x16742b<=0.1&&_0x23da11>0.1&&!_0x492ffd[_0x3e50ab(0x573)]&&(_0x94e7c6(_0x3e50ab(0x3eb),_0x3e50ab(0xc6b)),_0x492ffd[_0x3e50ab(0x573)]=!![]));if(_0x16742b>0.4)_0x492ffd[_0x3e50ab(0x397)]=![];if(_0x16742b>0.2)_0x492ffd['hasShown20']=![];if(_0x16742b>0.1)_0x492ffd[_0x3e50ab(0x573)]=![];_0x23da11=_0x16742b;}async function _0x279b7a(){const _0xd2d909=_0x241b18;if(_0xd2d909(0xdcd)in navigator)try{const _0x4229a6=await navigator['getBattery']();_0x23da11=_0x4229a6[_0xd2d909(0xcdc)],_0x3c43ec(_0x4229a6),_0x4229a6[_0xd2d909(0x4b8)](_0xd2d909(0x99c),()=>_0x3c43ec(_0x4229a6)),_0x4229a6[_0xd2d909(0x4b8)](_0xd2d909(0xd93),()=>{const _0x3c1251=_0xd2d909;_0x3c43ec(_0x4229a6),_0x4229a6[_0x3c1251(0xda4)]&&_0x94e7c6(_0x3c1251(0xe99),_0x3c1251(0x448));});}catch(_0x457718){console['error'](_0xd2d909(0x1237),_0x457718),document[_0xd2d909(0x5ac)](_0xd2d909(0xc60))[_0xd2d909(0x300)]=_0xd2d909(0x211);}else console[_0xd2d909(0x84b)](_0xd2d909(0x8ab)),document[_0xd2d909(0x5ac)]('.battery-text')[_0xd2d909(0x300)]=_0xd2d909(0x211);}async function _0x133452(){const _0x147809=_0x241b18,_0x171b19=document['getElementById'](_0x147809(0xdc0));if(!_0x171b19)return;const _0x2d559d=await _0x2e83f8[_0x147809(0x5d1)][_0x147809(0x7c6)](_0x147809(0x1df))[_0x147809(0x107)]()['toArray']();_0x171b19[_0x147809(0x595)]='';if(_0x2d559d[_0x147809(0x594)]===0x0){_0x171b19[_0x147809(0x595)]=_0x147809(0x132);return;}_0x2d559d[_0x147809(0x494)](_0x433c1d=>{const _0x4078c4=_0x147809,_0x76c3e=document[_0x4078c4(0x383)](_0x4078c4(0x1285));_0x76c3e[_0x4078c4(0x3db)]=_0x4078c4(0x1049),_0x76c3e['innerHTML']=_0x4078c4(0x12ca)+_0x433c1d[_0x4078c4(0x4c6)]+_0x4078c4(0x140)+_0x433c1d[_0x4078c4(0x278)]+_0x4078c4(0x1262)+(_0x433c1d[_0x4078c4(0x4fd)]||0x0)+_0x4078c4(0x181),_0x76c3e['addEventListener'](_0x4078c4(0x1041),()=>{_0x34e2d5(_0x433c1d['id']);}),_0xcb6204(_0x76c3e,async()=>{const _0x35e313=_0x4078c4,_0x18ea9b=await _0x58fd60('删除相册',_0x35e313(0x112b)+_0x433c1d[_0x35e313(0x278)]+'》吗？此操作将同时删除相册内的所有照片，且无法恢复。',{'confirmButtonClass':_0x35e313(0x8a6)});_0x18ea9b&&(await _0x2e83f8[_0x35e313(0xc62)]['where']('albumId')[_0x35e313(0x119e)](_0x433c1d['id'])['delete'](),await _0x2e83f8[_0x35e313(0x5d1)][_0x35e313(0xc0c)](_0x433c1d['id']),await _0x133452(),alert(_0x35e313(0xa35)));}),_0x171b19[_0x4078c4(0x120c)](_0x76c3e);});}async function _0x34e2d5(_0x1eb8d6){const _0xde4dc9=_0x241b18;_0x5de8b7[_0xde4dc9(0xc3f)]=_0x1eb8d6,await _0x1228fc(),_0x4e7698('album-photos-screen');}async function _0x1228fc(){const _0x528d51=_0x241b18;if(!_0x5de8b7[_0x528d51(0xc3f)])return;const _0x27f879=document[_0x528d51(0x11e3)](_0x528d51(0x9bb)),_0x37066b=document['getElementById'](_0x528d51(0x5f6)),_0x1fca40=await _0x2e83f8[_0x528d51(0x5d1)][_0x528d51(0x1289)](_0x5de8b7[_0x528d51(0xc3f)]);if(!_0x1fca40){console['error'](_0x528d51(0xdf9),_0x5de8b7[_0x528d51(0xc3f)]),_0x4e7698(_0x528d51(0x88e));return;}_0x37066b[_0x528d51(0x300)]=_0x1fca40['name'];const _0x411636=await _0x2e83f8[_0x528d51(0xc62)][_0x528d51(0x129e)]('albumId')[_0x528d51(0x119e)](_0x5de8b7[_0x528d51(0xc3f)])[_0x528d51(0x508)]();_0x27f879[_0x528d51(0x595)]='',_0x411636[_0x528d51(0x594)]===0x0?_0x27f879['innerHTML']=_0x528d51(0x1199):_0x411636['forEach'](_0x17079c=>{const _0x56e007=_0x528d51,_0x39e213=document['createElement'](_0x56e007(0x1285));_0x39e213[_0x56e007(0x3db)]=_0x56e007(0x1170),_0x39e213['innerHTML']=_0x56e007(0xda7)+_0x17079c['url']+_0x56e007(0xe38)+_0x17079c['id']+_0x56e007(0x8f0),_0x27f879[_0x56e007(0x120c)](_0x39e213);});}async function _0x30a532(_0x22d8a0){const _0x5346f1=_0x241b18;if(!_0x5de8b7['activeAlbumId'])return;const _0x7d4858=await _0x2e83f8[_0x5346f1(0xc62)][_0x5346f1(0x129e)]('albumId')['equals'](_0x5de8b7[_0x5346f1(0xc3f)])['toArray']();_0x568b1b[_0x5346f1(0x98b)]=_0x7d4858[_0x5346f1(0x796)](_0x46b743=>_0x46b743['url']),_0x568b1b[_0x5346f1(0x12b5)]=_0x568b1b[_0x5346f1(0x98b)][_0x5346f1(0x901)](_0x16ebf1=>_0x16ebf1===_0x22d8a0);if(_0x568b1b[_0x5346f1(0x12b5)]===-0x1)return;document['getElementById']('photo-viewer-modal')[_0x5346f1(0x505)][_0x5346f1(0x252)](_0x5346f1(0x250)),_0x249e90(),_0x568b1b['isOpen']=!![];}function _0x249e90(){const _0x2dd59e=_0x241b18;if(_0x568b1b[_0x2dd59e(0x12b5)]===-0x1)return;const _0x1df68e=document[_0x2dd59e(0x11e3)](_0x2dd59e(0x11e2)),_0x5b8b1a=document[_0x2dd59e(0x11e3)](_0x2dd59e(0xdb4)),_0x581f83=document[_0x2dd59e(0x11e3)](_0x2dd59e(0xa9d));_0x1df68e['style'][_0x2dd59e(0x12fa)]=0x0,setTimeout(()=>{const _0xdef725=_0x2dd59e;_0x1df68e['src']=_0x568b1b[_0xdef725(0x98b)][_0x568b1b[_0xdef725(0x12b5)]],_0x1df68e[_0xdef725(0x794)][_0xdef725(0x12fa)]=0x1;},0x64),_0x5b8b1a['disabled']=_0x568b1b[_0x2dd59e(0x12b5)]===0x0,_0x581f83['disabled']=_0x568b1b[_0x2dd59e(0x12b5)]===_0x568b1b['photos'][_0x2dd59e(0x594)]-0x1;}function _0x12a7fa(){const _0x3b6b85=_0x241b18;_0x568b1b[_0x3b6b85(0x12b5)]<_0x568b1b[_0x3b6b85(0x98b)][_0x3b6b85(0x594)]-0x1&&(_0x568b1b[_0x3b6b85(0x12b5)]++,_0x249e90());}function _0x518812(){const _0x3f30bb=_0x241b18;_0x568b1b[_0x3f30bb(0x12b5)]>0x0&&(_0x568b1b[_0x3f30bb(0x12b5)]--,_0x249e90());}function _0xa953cf(){const _0x2654b1=_0x241b18;document[_0x2654b1(0x11e3)](_0x2654b1(0x7bf))[_0x2654b1(0x505)][_0x2654b1(0x957)](_0x2654b1(0x250)),_0x568b1b[_0x2654b1(0x96b)]=![],_0x568b1b[_0x2654b1(0x98b)]=[],_0x568b1b[_0x2654b1(0x12b5)]=-0x1,document[_0x2654b1(0x11e3)](_0x2654b1(0x11e2))[_0x2654b1(0xf0a)]='';}function _0x22db5e(_0x3fa1a9){const _0x6fd13c=_0x241b18;_0x481a45=_0x3fa1a9,localStorage[_0x6fd13c(0x3b2)](_0x6fd13c(0x46a),_0x3fa1a9);const _0x40358e=document[_0x6fd13c(0x5ac)](_0x6fd13c(0x85b)),_0x4e5b95=_0x40358e[_0x6fd13c(0x5ac)](_0x6fd13c(0x436));let _0xd5d58c=_0x40358e['querySelector'](_0x6fd13c(0x1cd));_0x3fa1a9>0x0?(!_0xd5d58c&&(_0xd5d58c=document['createElement'](_0x6fd13c(0x436)),_0xd5d58c[_0x6fd13c(0x3db)]=_0x6fd13c(0x67d),_0x4e5b95[_0x6fd13c(0x794)][_0x6fd13c(0x5fb)]='relative',_0x4e5b95['appendChild'](_0xd5d58c)),_0xd5d58c[_0x6fd13c(0x300)]=_0x3fa1a9>0x63?_0x6fd13c(0x721):_0x3fa1a9,_0xd5d58c[_0x6fd13c(0x794)][_0x6fd13c(0x33d)]=_0x6fd13c(0x11ac)):_0xd5d58c&&(_0xd5d58c[_0x6fd13c(0x794)][_0x6fd13c(0x33d)]=_0x6fd13c(0x379)),_0x17cf58();}function _0x424da7(){const _0xd109b0=_0x241b18;if(_0x454e0e)return;const _0x3f36e6=_0x5de8b7[_0xd109b0(0x2df)][_0xd109b0(0x1f6)]||0x3c;_0x454e0e=setInterval(_0x15c1ae,_0x3f36e6*0x3e8),_0x3f8b63();}function _0x3a0e97(){_0x454e0e&&(clearInterval(_0x454e0e),_0x454e0e=null),_0x5efcc9();}async function _0x15c1ae(){const _0x33159f=_0x241b18;console[_0x33159f(0x84b)](_0x33159f(0xa1c));if(!_0x5de8b7[_0x33159f(0x2df)]['enableBackgroundActivity']){_0x3a0e97();return;}const _0x2025da=Object[_0x33159f(0x4ca)](_0x5de8b7[_0x33159f(0x737)])['filter'](_0x2f07ae=>!_0x2f07ae[_0x33159f(0x1244)]);_0x2025da[_0x33159f(0x494)](_0x2388ac=>{const _0x20f138=_0x33159f;if(_0x2388ac[_0x20f138(0xa78)]?.[_0x20f138(0x739)]==='blocked_by_user'){const _0x46ac42=_0x2388ac[_0x20f138(0xa78)][_0x20f138(0x64c)];if(!_0x46ac42)return;const _0xd5eacb=Date[_0x20f138(0x1182)]()-_0x46ac42,_0x3a83bb=(_0x5de8b7['globalSettings'][_0x20f138(0xb18)]||0x1)*0x3c*0x3c*0x3e8;_0xd5eacb>_0x3a83bb&&(_0x2388ac['relationship'][_0x20f138(0x739)]='pending_system_reflection',_0x2d6139(_0x2388ac['id']));}else{if(_0x2388ac['relationship']?.[_0x20f138(0x739)]===_0x20f138(0xe62)&&_0x2388ac['id']!==_0x5de8b7[_0x20f138(0x93d)]){if(_0x2388ac[_0x20f138(0x761)]['enableBackgroundActivity']===![]){console['log'](_0x20f138(0xebf)+_0x2388ac[_0x20f138(0x278)]+'\x22\x20的独立后台活动开关已关闭，本次跳过。');return;}Math[_0x20f138(0x36d)]()<0.2&&(console['log']('角色\x20\x22'+_0x2388ac[_0x20f138(0x278)]+_0x20f138(0x523)),_0x38ac55(_0x2388ac['id']));}}});const _0x46f418=Object['values'](_0x5de8b7[_0x33159f(0x737)])[_0x33159f(0x138)](_0x53a3f1=>_0x53a3f1['isGroup']);_0x46f418[_0x33159f(0x494)](_0x2f330f=>{const _0x181648=_0x33159f;if(_0x2f330f[_0x181648(0x761)]['enableBackgroundActivity']===![]){console['log'](_0x181648(0xe67)+_0x2f330f[_0x181648(0x278)]+_0x181648(0xb1b));return;}_0x2f330f['id']!==_0x5de8b7[_0x181648(0x93d)]&&Math[_0x181648(0x36d)]()<0.1&&(console[_0x181648(0x84b)](_0x181648(0xe67)+_0x2f330f[_0x181648(0x278)]+_0x181648(0x523)),_0x501df3(_0x2f330f['id']));});try{const _0x719301=await _0x2e83f8['npcs'][_0x33159f(0x508)]();if(_0x719301['length']===0x0)return;const _0x454183=await _0x2e83f8[_0x33159f(0x1218)][_0x33159f(0x7c6)](_0x33159f(0x702))[_0x33159f(0x107)]()['limit'](0xa)[_0x33159f(0x508)]();for(const _0x4e703f of _0x719301){if(_0x4e703f['enableBackgroundActivity']===![])continue;const _0x13b780=_0x4e703f[_0x33159f(0xb09)]||0xf;if(_0x4e703f['lastActionTimestamp']){const _0x5be663=(Date[_0x33159f(0x1182)]()-_0x4e703f[_0x33159f(0x117)])/(0x3e8*0x3c);if(_0x5be663<_0x13b780)continue;}if(Math[_0x33159f(0x36d)]()>0.3)continue;const _0x39a690=[];for(const _0x52c2de of _0x454183){if(_0x52c2de[_0x33159f(0x5d9)]===_0x33159f(0x8b8)+_0x4e703f['id'])continue;const _0x1b43ed=_0x52c2de[_0x33159f(0x1092)]?.[_0x33159f(0xe7c)](_0x27d5a7=>_0x27d5a7[_0x33159f(0x1083)]===_0x4e703f['name']),_0x2889e7=_0x52c2de[_0x33159f(0x1092)]?.[_0x33159f(0xa6c)](-0x1)[0x0]?.[_0x33159f(0x2ac)];if(_0x2889e7===_0x4e703f[_0x33159f(0x278)])continue;let _0x29c4e3=![];if(_0x52c2de[_0x33159f(0x5d9)]==='user'||_0x52c2de[_0x33159f(0x5d9)]['startsWith'](_0x33159f(0x1ae)))_0x4e703f[_0x33159f(0x131)][_0x33159f(0x3ad)](_0x52c2de[_0x33159f(0x5d9)])&&(_0x29c4e3=!![]);else{if(_0x52c2de[_0x33159f(0x5d9)][_0x33159f(0xb6c)](_0x33159f(0x8b8))){const _0x40c609=parseInt(_0x52c2de[_0x33159f(0x5d9)][_0x33159f(0x1018)]('npc_','')),_0x44f6c2=await _0x2e83f8[_0x33159f(0xf00)][_0x33159f(0x1289)](_0x40c609);if(_0x44f6c2&&_0x44f6c2[_0x33159f(0x131)]){const _0x4d88d5=_0x4e703f[_0x33159f(0x131)][_0x33159f(0x138)](_0x3b8ac5=>_0x44f6c2[_0x33159f(0x131)][_0x33159f(0x3ad)](_0x3b8ac5));_0x4d88d5[_0x33159f(0x594)]>0x0&&(_0x29c4e3=!![]);}}}(_0x29c4e3||_0x1b43ed)&&_0x39a690[_0x33159f(0xf5)](_0x52c2de);}if(_0x39a690[_0x33159f(0x594)]>0x0||Math[_0x33159f(0x36d)]()<0.2){console[_0x33159f(0x84b)](_0x33159f(0xc4d)+_0x4e703f[_0x33159f(0x278)]+_0x33159f(0x317));const _0x2444c4=await _0x486054(_0x4e703f,_0x39a690);if(_0x2444c4&&_0x2444c4[_0x33159f(0x594)]>0x0){for(const _0x275f01 of _0x2444c4){if(_0x275f01[_0x33159f(0xa20)]==='qzone_comment'){const _0x245034=await _0x2e83f8[_0x33159f(0x1218)][_0x33159f(0x1289)](_0x275f01[_0x33159f(0x2f0)]);if(_0x245034){if(!_0x245034[_0x33159f(0x1092)])_0x245034[_0x33159f(0x1092)]=[];_0x245034[_0x33159f(0x1092)][_0x33159f(0xf5)]({'commenterName':_0x4e703f['name'],'text':_0x275f01['commentText'],'replyTo':_0x275f01[_0x33159f(0x1083)]||null,'timestamp':Date[_0x33159f(0x1182)]()+Math[_0x33159f(0x36d)]()}),await _0x2e83f8[_0x33159f(0x1218)][_0x33159f(0x1225)](_0x275f01[_0x33159f(0x2f0)],{'comments':_0x245034['comments']}),_0x22db5e(_0x481a45+0x1);}}else{if(_0x275f01[_0x33159f(0xa20)]===_0x33159f(0x3cc)){const _0x2d5449={'type':_0x275f01[_0x33159f(0x7f8)]||_0x33159f(0xc40),'content':_0x275f01[_0x33159f(0x9a5)],'timestamp':Date['now'](),'authorId':'npc_'+_0x4e703f['id'],'authorOriginalName':_0x4e703f[_0x33159f(0x278)],'visibleTo':_0x4e703f[_0x33159f(0x131)],'likes':[],'comments':[],'isDeleted':![]};await _0x2e83f8['qzonePosts'][_0x33159f(0x252)](_0x2d5449),console[_0x33159f(0x84b)](_0x33159f(0xc4d)+_0x4e703f[_0x33159f(0x278)]+_0x33159f(0x1242)),_0x22db5e(_0x481a45+0x1);}}}await _0x2e83f8[_0x33159f(0xf00)][_0x33159f(0x1225)](_0x4e703f['id'],{'lastActionTimestamp':Date[_0x33159f(0x1182)]()}),document['getElementById']('qzone-screen')['classList'][_0x33159f(0x1121)](_0x33159f(0x1fc))&&await _0xae9c28();}}}}catch(_0x1f4f79){console[_0x33159f(0x1c1)](_0x33159f(0x1033),_0x1f4f79);}}async function _0x486054(_0x25bd71,_0x4f13d5){const _0xe8fe61=_0x241b18,{proxyUrl:_0x2b6c10,apiKey:_0x5db6dc,model:_0x259f9a}=_0x5de8b7[_0xe8fe61(0x89c)];if(!_0x2b6c10||!_0x5db6dc||!_0x259f9a)return console[_0xe8fe61(0x1c1)](_0xe8fe61(0x5ef)),null;let _0x20428b='#\x20你的互动对象\x20(用户和其他角色)\x0a';const _0x45c257=_0x5de8b7['qzoneSettings'][_0xe8fe61(0xa33)]||'我',_0x4b7e6c=_0x5de8b7[_0xe8fe61(0x737)][Object['keys'](_0x5de8b7[_0xe8fe61(0x737)])[0x0]]?.[_0xe8fe61(0x761)][_0xe8fe61(0x10c5)]||_0xe8fe61(0x5ce);_0x20428b+='-\x20**'+_0x45c257+_0xe8fe61(0x6ff)+_0x4b7e6c+'\x0a';_0x25bd71[_0xe8fe61(0x131)]&&_0x25bd71[_0xe8fe61(0x131)][_0xe8fe61(0x594)]>0x0&&_0x25bd71[_0xe8fe61(0x131)][_0xe8fe61(0x494)](_0x39ca25=>{const _0x24751b=_0xe8fe61,_0x27bf54=_0x5de8b7[_0x24751b(0x737)][_0x39ca25];_0x27bf54&&!_0x27bf54[_0x24751b(0x1244)]&&(_0x20428b+='-\x20**'+_0x27bf54[_0x24751b(0x278)]+'\x20(本名:\x20'+_0x27bf54['originalName']+_0x24751b(0xab8)+_0x27bf54[_0x24751b(0x761)][_0x24751b(0x8d5)]+'\x0a');});const _0x39a197=(await Promise[_0xe8fe61(0xd4a)](_0x4f13d5[_0xe8fe61(0x796)](async _0x1e2031=>{const _0x10d574=_0xe8fe61;let _0x119d65='未知作者';if(_0x1e2031[_0x10d574(0x5d9)]==='user')_0x119d65=_0x5de8b7[_0x10d574(0x1c5)][_0x10d574(0xa33)]||'用户';else{if(_0x1e2031[_0x10d574(0x5d9)][_0x10d574(0xb6c)](_0x10d574(0x1ae)))_0x119d65=_0x4a0eba(_0x1e2031['authorOriginalName']||_0x1e2031['authorId']);else{if(_0x1e2031[_0x10d574(0x5d9)]['startsWith'](_0x10d574(0x8b8))){const _0x54b75e=parseInt(_0x1e2031[_0x10d574(0x5d9)][_0x10d574(0x1018)](_0x10d574(0x8b8),'')),_0x3fc06c=await _0x2e83f8[_0x10d574(0xf00)][_0x10d574(0x1289)](_0x54b75e);_0x3fc06c&&(_0x119d65=_0x3fc06c[_0x10d574(0x278)]);}}}const _0x4d4553=(_0x1e2031[_0x10d574(0x1092)]||[])[_0x10d574(0x796)](_0x2b6264=>{const _0x4eab10=_0x10d574;if(typeof _0x2b6264===_0x4eab10(0x537)&&_0x2b6264[_0x4eab10(0x2ac)]){const _0x46e035=_0x4a0eba(_0x2b6264['commenterName']);return _0x4eab10(0x11c)+_0x46e035+_0x4eab10(0xd7)+_0x2b6264[_0x4eab10(0x1197)];}return'-\x20'+_0x2b6264;})[_0x10d574(0xa4b)]('\x0a');return'\x0a---\x0a###\x20帖子ID:\x20'+_0x1e2031['id']+_0x10d574(0x107e)+_0x119d65+_0x10d574(0x1022)+(_0x1e2031[_0x10d574(0x9a5)]||_0x1e2031['publicText']||'')[_0x10d574(0x8d4)](0x0,0x96)+'...\x0a-\x20**已有评论**:\x0a'+(_0x4d4553||_0x10d574(0xe6f))+_0x10d574(0x12ff);})))[_0xe8fe61(0xa4b)]('\x0a'),_0x3b63cb=_0xe8fe61(0x8b8)+_0x25bd71['id'],_0x226362=Date[_0xe8fe61(0x1182)]()-0xc*0x3c*0x3c*0x3e8,_0x2dc7fd=await _0x2e83f8[_0xe8fe61(0x1218)][_0xe8fe61(0x129e)]('authorId')['equals'](_0x3b63cb)[_0xe8fe61(0x101d)](_0x374696=>_0x374696['timestamp']>_0x226362)[_0xe8fe61(0x508)]();let _0x244460='';_0x2dc7fd[_0xe8fe61(0x594)]>0x0&&(_0x244460=_0xe8fe61(0x7d5));const _0x4edd3b=_0xe8fe61(0x9cf)+_0x25bd71[_0xe8fe61(0x278)]+_0xe8fe61(0x7e0)+_0x244460+_0xe8fe61(0x9dd)+_0x25bd71[_0xe8fe61(0x278)]+_0xe8fe61(0xc11)+_0x25bd71[_0xe8fe61(0x701)]+'\x0a\x0a'+_0x20428b+'\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a'+_0x39a197+_0xe8fe61(0xc86);try{const _0x4b2e70=[{'role':'user','content':'请根据你的设定，开始你的行动。'}];let _0x210c04=_0x2b6c10[_0xe8fe61(0x3ad)]('generativelanguage'),_0x180403=_0x4a90fe(_0x259f9a,_0x5db6dc,_0x4edd3b,_0x4b2e70);const _0x53159a=_0x210c04?await fetch(_0x180403[_0xe8fe61(0x10ac)],_0x180403['data']):await fetch(_0x2b6c10+_0xe8fe61(0x8fd),{'method':_0xe8fe61(0x1128),'headers':{'Content-Type':_0xe8fe61(0x35c),'Authorization':'Bearer\x20'+_0x5db6dc},'body':JSON['stringify']({'model':_0x259f9a,'messages':[{'role':_0xe8fe61(0xf72),'content':_0x4edd3b},..._0x4b2e70],'temperature':_0x5de8b7[_0xe8fe61(0x2df)]['apiTemperature']||0.9})});if(!_0x53159a['ok'])throw new Error('API\x20错误:\x20'+_0x53159a['statusText']);const _0x2f5eaf=await _0x53159a[_0xe8fe61(0xd7b)](),_0x16648e=getGeminiResponseText(_0x2f5eaf),_0x197ec1=_0x16648e[_0xe8fe61(0xe9f)](/(\[[\s\S]*\])/);if(!_0x197ec1)throw new Error('AI返回的行动中未找到有效的JSON数组。');return JSON[_0xe8fe61(0xb0c)](_0x197ec1[0x0]);}catch(_0x55be20){return console[_0xe8fe61(0x1c1)](_0xe8fe61(0x6e0)+_0x25bd71[_0xe8fe61(0x278)]+_0xe8fe61(0xbda),_0x55be20),null;}}async function _0x38ac55(_0x226f8d){const _0x194a3d=_0x241b18,_0x467897=_0x5de8b7[_0x194a3d(0x737)][_0x226f8d];if(!_0x467897)return;const _0x25027c=_0x467897[_0x194a3d(0x761)][_0x194a3d(0xb09)]||0xa;if(_0x467897[_0x194a3d(0x117)]){const _0x46ff33=(Date[_0x194a3d(0x1182)]()-_0x467897[_0x194a3d(0x117)])/(0x3e8*0x3c);if(_0x46ff33<_0x25027c){console[_0x194a3d(0x84b)]('角色\x20\x22'+_0x467897['name']+_0x194a3d(0xc9)+Math['round'](_0x25027c-_0x46ff33)+'\x20分钟)，本次独立行动跳过。');return;}}_0x153b71(_0x226f8d,!![]);const {proxyUrl:_0x1f0054,apiKey:_0x47966d,model:_0x54739c}=_0x5de8b7[_0x194a3d(0x89c)];if(!_0x1f0054||!_0x47966d||!_0x54739c)return;const _0x2f94af=_0x5de8b7[_0x194a3d(0x1c5)][_0x194a3d(0xa33)],_0x16f228=new Date(),_0x28271b=_0x467897[_0x194a3d(0x761)]['timeZone']||'Asia/Shanghai',_0x2111ce=_0x16f228[_0x194a3d(0x9df)](_0x194a3d(0x898),{'timeZone':_0x28271b,'dateStyle':_0x194a3d(0x5ca),'timeStyle':'short'}),_0x1b027f=new Date(_0x16f228[_0x194a3d(0x9df)](_0x194a3d(0xf50),{'timeZone':_0x28271b}));let _0x3621cc='',_0xc2437e='',_0x4765bd,_0xd6ac13=![];const _0x6772cd=_0x467897[_0x194a3d(0x761)][_0x194a3d(0xb2e)]||0xa,_0x1d6c24=_0x467897['history']['filter'](_0x448cce=>!_0x448cce['isHidden'])[_0x194a3d(0xa6c)](-_0x6772cd),_0x415dc5=_0x467897[_0x194a3d(0x49e)][_0x194a3d(0x138)](_0x3b07e7=>!_0x3b07e7['isHidden'])[_0x194a3d(0xa6c)](-0x1)[0x0];if(_0x467897['settings'][_0x194a3d(0x290)]){_0x3621cc=_0xe5786(_0x1b027f);const _0x117cd0=_0x467897['history']['filter'](_0x3baa72=>!_0x3baa72[_0x194a3d(0xbf5)])[_0x194a3d(0xa6c)](-0x1)[0x0],_0x3babf2=new Date();let _0x4f2cf7='',_0x5877f4=![];if(_0x117cd0){const _0x28b200=new Date(_0x117cd0[_0x194a3d(0x702)]),_0x1678d3=(_0x3babf2-_0x28b200)/(0x3e8*0x3c*0x3c);if(_0x1678d3>0xc){_0x5877f4=!![];const _0x56acc0=Math[_0x194a3d(0xfb1)](_0x1678d3/0x18);_0x4f2cf7=_0x194a3d(0xaea)+(_0x56acc0>0x0?_0x56acc0+'天':Math[_0x194a3d(0xfb1)](_0x1678d3)+'小时')+_0x194a3d(0xdae);}else{const _0x328124=Math[_0x194a3d(0xfb1)](_0x1678d3*0x3c);if(_0x328124<0x5)_0x4f2cf7=_0x194a3d(0x64f);else _0x328124<0x3c?_0x4f2cf7='你们在'+_0x328124+_0x194a3d(0x104e):_0x4f2cf7='你们在'+Math['floor'](_0x1678d3)+_0x194a3d(0x2ca);}}else _0x5877f4=!![],_0x4f2cf7=_0x194a3d(0x1031);let _0x32aa1c='你们最近没有有效聊天记录。';_0x1d6c24[_0x194a3d(0x594)]>0x0&&(_0x32aa1c=_0x194a3d(0x561)+_0x1d6c24[_0x194a3d(0x796)](_0x507c14=>{const _0x303172=_0x194a3d,_0x5e1a65=_0x507c14[_0x303172(0xba4)]===_0x303172(0x21c)?_0x2f94af:_0x467897['name'];return _0x5e1a65+':\x20'+String(_0x507c14['content'])[_0x303172(0x8d4)](0x0,0x32)+'...';})[_0x194a3d(0xa4b)]('\x0a')),_0x5877f4?_0x4765bd=_0x194a3d(0x1111)+_0x4f2cf7+'\x20当前时间是\x20'+_0x2111ce+_0x194a3d(0xfb5)+_0x32aa1c:_0x4765bd=''+_0x32aa1c;}else _0x1d6c24[_0x194a3d(0x594)]>0x0?_0x4765bd=_0x194a3d(0x561)+_0x1d6c24[_0x194a3d(0x796)](_0x37ea51=>{const _0x2de382=_0x194a3d,_0x3bd66c=_0x37ea51[_0x2de382(0xba4)]===_0x2de382(0x21c)?_0x2f94af:_0x467897['name'];return _0x3bd66c+':\x20'+String(_0x37ea51[_0x2de382(0x9a5)])[_0x2de382(0x8d4)](0x0,0x32)+_0x2de382(0x6cb);})[_0x194a3d(0xa4b)]('\x0a'):_0x4765bd=_0x194a3d(0x10ae);const _0x3e5d46=await _0x2e83f8[_0x194a3d(0x1218)]['orderBy']('timestamp')[_0x194a3d(0x107)]()['limit'](0x5)[_0x194a3d(0x508)](),_0x3801e0=_0x3f9279(_0x3e5d46,_0x467897),_0x10f551=_0x3801e0['filter'](_0x4b4a8a=>_0x4b4a8a[_0x194a3d(0x5d9)]===_0x226f8d);let _0x33f0fa='';_0x10f551[_0x194a3d(0x594)]>0x0&&(_0x33f0fa=_0x194a3d(0x331),_0x10f551[_0x194a3d(0x494)](_0x135e6b=>{const _0x5347f0=_0x194a3d;let _0x164807=(_0x135e6b[_0x5347f0(0x12aa)]||_0x135e6b[_0x5347f0(0x9a5)]||_0x5347f0(0x681))[_0x5347f0(0x8d4)](0x0,0x28)+_0x5347f0(0x6cb);_0x33f0fa+=_0x5347f0(0x1161)+_0x135e6b['id']+_0x5347f0(0x60b)+_0x164807+'\x22\x0a';}));let _0x4efc5d=[];_0x3801e0['length']>0x0&&(_0x4efc5d=_0x3801e0[_0x194a3d(0x796)](_0x1e7a9b=>{const _0x4f531c=_0x194a3d;let _0x62534a;if(_0x1e7a9b[_0x4f531c(0xa20)]===_0x4f531c(0x887))_0x62534a=(_0x4f531c(0x4a5)+_0x1e7a9b['hiddenContent']+_0x4f531c(0xab1)+(_0x1e7a9b[_0x4f531c(0x12aa)]||''))[_0x4f531c(0x8d4)](0x0,0x32)+_0x4f531c(0x6cb);else _0x1e7a9b[_0x4f531c(0xa20)]===_0x4f531c(0x332)?_0x62534a=(_0x4f531c(0x2ae)+_0x1e7a9b[_0x4f531c(0x6b6)]+_0x4f531c(0xab1)+(_0x1e7a9b[_0x4f531c(0x12aa)]||''))[_0x4f531c(0x8d4)](0x0,0x32)+_0x4f531c(0x6cb):_0x62534a=String(_0x1e7a9b['publicText']||_0x1e7a9b[_0x4f531c(0x9a5)]||_0x4f531c(0x681))[_0x4f531c(0x8d4)](0x0,0x32)+_0x4f531c(0x6cb);return _0x4f531c(0xe2)+_0x62534a+'\x22';}));let _0x480c08='';_0x4efc5d[_0x194a3d(0x594)]>0x0&&(_0x480c08=_0x194a3d(0x7c7)+_0x4efc5d['join']('\x0a')+_0x194a3d(0x94f));let _0x165bc7='';if(_0x467897['settings']['linkedWorldBookIds']&&_0x467897[_0x194a3d(0x761)]['linkedWorldBookIds'][_0x194a3d(0x594)]>0x0){const _0x455a1a=_0x467897[_0x194a3d(0x761)]['linkedWorldBookIds'][_0x194a3d(0x796)](_0x49f68e=>{const _0x2240bb=_0x194a3d,_0x286e9e=_0x5de8b7[_0x2240bb(0xca)][_0x2240bb(0xe79)](_0x2417e0=>_0x2417e0['id']===_0x49f68e);if(!_0x286e9e||!Array[_0x2240bb(0xb7b)](_0x286e9e['content']))return'';const _0x14cbf5=_0x286e9e[_0x2240bb(0x9a5)][_0x2240bb(0x138)](_0x22329f=>_0x22329f['enabled']!==![])[_0x2240bb(0x796)](_0x8b143c=>{const _0xc917c3=_0x2240bb;let _0x4ec35e='\x0a###\x20条目:\x20'+(_0x8b143c[_0xc917c3(0xebd)]||'无备注')+'\x0a';return _0x8b143c[_0xc917c3(0xb4a)][_0xc917c3(0x594)]>0x0&&(_0x4ec35e+=_0xc917c3(0x105b)+_0x8b143c[_0xc917c3(0xb4a)]['join'](',\x20')+'\x0a'),_0x4ec35e+=_0xc917c3(0x10f0)+_0x8b143c[_0xc917c3(0x9a5)],_0x4ec35e;})['join']('');return _0x14cbf5?_0x2240bb(0xe49)+_0x286e9e[_0x2240bb(0x278)]+'\x0a'+_0x14cbf5:'';})[_0x194a3d(0x138)](Boolean)[_0x194a3d(0xa4b)]('');_0x455a1a&&(_0x165bc7=_0x194a3d(0xa11)+_0x455a1a+_0x194a3d(0x421));}let _0x4bb4ba='';const _0x5129b3=_0x467897[_0x194a3d(0x761)][_0x194a3d(0x37c)]||0xa;if(_0x467897[_0x194a3d(0x761)][_0x194a3d(0xd1d)]&&_0x467897[_0x194a3d(0x761)]['linkedMemoryChatIds'][_0x194a3d(0x594)]>0x0){const _0x426af1=_0x467897[_0x194a3d(0x761)]['linkedMemoryChatIds'][_0x194a3d(0x796)](_0x50be42=>{const _0x370d7f=_0x194a3d,_0x4fb2c1=_0x5de8b7[_0x370d7f(0x737)][_0x50be42];if(!_0x4fb2c1)return null;const _0x1ab166=_0x4fb2c1[_0x370d7f(0x49e)]['slice'](-0x1)[0x0];return{'chat':_0x4fb2c1,'latestTimestamp':_0x1ab166?_0x1ab166[_0x370d7f(0x702)]:0x0};})[_0x194a3d(0x138)](Boolean);_0x426af1[_0x194a3d(0x861)]((_0x3e13c6,_0x1f910a)=>_0x1f910a['latestTimestamp']-_0x3e13c6[_0x194a3d(0x1294)]),_0x4bb4ba+=_0x194a3d(0x1085);for(const _0x4e9231 of _0x426af1){const _0x44f37a=_0x4e9231['chat'],_0xa46994=_0x44f37a[_0x194a3d(0x1244)]?_0x194a3d(0x1116):'[私聊]',_0x364f07=_0x4e9231[_0x194a3d(0x1294)]>0x0?_0x194a3d(0x24f)+_0x497f2b(_0x4e9231[_0x194a3d(0x1294)])+')':'';_0x4bb4ba+=_0x194a3d(0x11ec)+_0xa46994+'“'+_0x44f37a['name']+_0x194a3d(0x150)+_0x364f07+_0x194a3d(0xeb4);const _0x3500b7=_0x44f37a[_0x194a3d(0x49e)][_0x194a3d(0xa6c)](-_0x5129b3),_0xdef6f6=_0x3500b7['filter'](_0x5409ff=>!String(_0x5409ff[_0x194a3d(0x9a5)])[_0x194a3d(0x3ad)](_0x194a3d(0xcab)));_0xdef6f6['length']>0x0?_0xdef6f6[_0x194a3d(0x494)](_0x6ed99d=>{const _0x3b14ee=_0x194a3d,_0x2ca51b=_0x6ed99d['role']==='user'?_0x44f37a[_0x3b14ee(0x761)]['myNickname']||'我':_0x6ed99d[_0x3b14ee(0x768)]||_0x44f37a['name'];let _0x200dc3=String(_0x6ed99d[_0x3b14ee(0x9a5)]);if(_0x6ed99d[_0x3b14ee(0xa20)]===_0x3b14ee(0xd02)||_0x6ed99d[_0x3b14ee(0xa20)]===_0x3b14ee(0xeb))_0x200dc3=_0x3b14ee(0xe56)+_0x6ed99d['content']+']';else _0x6ed99d[_0x3b14ee(0xa20)]===_0x3b14ee(0x719)&&(_0x200dc3=_0x3b14ee(0x338)+_0x6ed99d[_0x3b14ee(0x9a5)]+']');_0x4bb4ba+=_0x2ca51b+':\x20'+_0x200dc3+'\x0a';}):_0x4bb4ba+='(暂无有效聊天记录)\x0a';}}let _0x50244d='';if(_0x3801e0[_0x194a3d(0x594)]>0x0){let _0x3db18a=_0x194a3d(0xa23);for(const _0x15a1ce of _0x3801e0){let _0x20a4c7;if(_0x15a1ce['authorId']==='user')_0x20a4c7=_0x5de8b7['qzoneSettings'][_0x194a3d(0xa33)];else{if(String(_0x15a1ce[_0x194a3d(0x5d9)])[_0x194a3d(0xb6c)](_0x194a3d(0x8b8)))_0x20a4c7=_0x15a1ce[_0x194a3d(0x1211)]||_0x194a3d(0x7a6);else{const _0x12b586=_0x5de8b7[_0x194a3d(0x737)][_0x15a1ce[_0x194a3d(0x5d9)]];_0x20a4c7=_0x12b586?_0x12b586['name']:'一位朋友';}}if(_0x15a1ce[_0x194a3d(0x5d9)]===_0x226f8d)_0x20a4c7+=_0x194a3d(0x10ea);let _0x951002;if(_0x15a1ce[_0x194a3d(0xa20)]===_0x194a3d(0x45a)){const _0x3bffef=_0x15a1ce['repostComment']?_0x194a3d(0x942)+_0x15a1ce[_0x194a3d(0x12a3)]+'\x22':'';let _0x2b258a=_0x194a3d(0x5fe);const _0x1a9c20=_0x15a1ce['originalPost']['authorId'];if(_0x1a9c20===_0x194a3d(0x21c))_0x2b258a=_0x5de8b7[_0x194a3d(0x1c5)][_0x194a3d(0xa33)];else _0x5de8b7['chats'][_0x1a9c20]&&(_0x2b258a=_0x5de8b7['chats'][_0x1a9c20][_0x194a3d(0x278)]);let _0x334d6f;const _0x469641=_0x15a1ce['originalPost'];if(_0x469641[_0x194a3d(0xa20)]==='text_image')_0x334d6f=_0x194a3d(0x638)+(_0x469641[_0x194a3d(0x12aa)]||'')+_0x194a3d(0x981)+(_0x469641['hiddenContent']||'')[_0x194a3d(0x8d4)](0x0,0x28)+_0x194a3d(0x6ad);else _0x469641['type']===_0x194a3d(0x332)?_0x334d6f=_0x194a3d(0x280)+(_0x469641[_0x194a3d(0x12aa)]||'')+_0x194a3d(0x981)+(_0x469641['imageDescription']||'')['substring'](0x0,0x28)+_0x194a3d(0x6ad):_0x334d6f='\x22'+(_0x469641[_0x194a3d(0x9a5)]||'')['substring'](0x0,0x28)+_0x194a3d(0x115b);_0x951002=_0x194a3d(0x8d7)+_0x2b258a+'\x20的动态\x20'+_0x3bffef+'【原动态内容:\x20'+_0x334d6f+'】';}else{if(_0x15a1ce[_0x194a3d(0xa20)]===_0x194a3d(0x887))_0x951002=(_0x194a3d(0x3f3)+_0x15a1ce[_0x194a3d(0x6f7)]+_0x194a3d(0x4dc)+(_0x15a1ce[_0x194a3d(0x12aa)]||''))['substring'](0x0,0x32)+_0x194a3d(0x6cb);else{if(_0x15a1ce[_0x194a3d(0xa20)]===_0x194a3d(0x332))_0x951002=(_0x194a3d(0x302)+_0x15a1ce['imageDescription']+_0x194a3d(0x4dc)+(_0x15a1ce[_0x194a3d(0x12aa)]||''))[_0x194a3d(0x8d4)](0x0,0x32)+_0x194a3d(0x6cb);else{if(_0x15a1ce[_0x194a3d(0xa20)]===_0x194a3d(0xcb1)&&_0x15a1ce[_0x194a3d(0x196)]){const _0x48fd7d=Array[_0x194a3d(0xb7b)](_0x15a1ce[_0x194a3d(0x196)])?_0x15a1ce['prompt']:[_0x15a1ce[_0x194a3d(0x196)]];_0x951002=(_0x15a1ce['publicText']||'')+(_0x194a3d(0x83c)+_0x48fd7d[_0x194a3d(0x594)]+_0x194a3d(0x1207)+_0x48fd7d['join'](',\x20')+']');}else _0x951002=String(_0x15a1ce['publicText']||_0x15a1ce['content']||_0x194a3d(0x681))[_0x194a3d(0x8d4)](0x0,0x32)+'...';}}}_0x3db18a+=_0x194a3d(0x1161)+_0x15a1ce['id']+_0x194a3d(0xc4)+_0x20a4c7+_0x194a3d(0x12b4)+_0x951002+'\x22\x0a';if(_0x15a1ce[_0x194a3d(0x1092)]&&_0x15a1ce[_0x194a3d(0x1092)]['length']>0x0)for(const _0x4b4dce of _0x15a1ce[_0x194a3d(0x1092)]){if(typeof _0x4b4dce==='object'&&_0x4b4dce[_0x194a3d(0x2ac)]){const _0x2c455a=_0x4a0eba(_0x4b4dce[_0x194a3d(0x2ac)]);let _0x2f0820=_0x4b4dce['meaning']?_0x194a3d(0x452)+_0x4b4dce[_0x194a3d(0xb36)]+'\x27]':_0x4b4dce['text'];_0x4b4dce[_0x194a3d(0x2ac)]===_0x467897[_0x194a3d(0x697)]?_0x3db18a+='\x20\x20-\x20你评论说:\x20'+_0x2f0820+'\x0a':_0x3db18a+=_0x194a3d(0x67e)+_0x2c455a+'\x20(本名:\x20'+_0x4b4dce[_0x194a3d(0x2ac)]+_0x194a3d(0x151)+_0x2f0820+'\x0a';}}}_0x50244d=_0x3db18a;}const _0x24cd3e=_0x194a3d(0xe74)+(_0x467897[_0x194a3d(0xe21)]&&_0x467897[_0x194a3d(0xe21)][_0x194a3d(0x594)]>0x0?_0x467897[_0x194a3d(0xe21)][_0x194a3d(0x796)](_0x27162b=>_0x194a3d(0xd12)+_0x497f2b(_0x27162b[_0x194a3d(0x702)])+')\x20'+_0x27162b[_0x194a3d(0x9a5)])[_0x194a3d(0xa4b)]('\x0a'):'-\x20(暂无)'),_0x16db2e=_0x57277b(_0x467897,0x3,_0x194a3d(0x1059)),_0x15dfb6=_0x57277b(_0x467897,0x6,_0x194a3d(0x1059)),_0x324cfe=_0x57277b(_0x467897,0x9,_0x194a3d(0x1059)),_0x376e78=_0x57277b(_0x467897,0x1,'days'),_0x859734=_0x57277b(_0x467897,0x3,_0x194a3d(0xb95)),_0xea7e58=_0x57277b(_0x467897,0x7,_0x194a3d(0xb95));let _0xcf2df1='';if(_0x16db2e||_0x15dfb6||_0x324cfe||_0x376e78||_0x859734||_0xea7e58){_0xcf2df1+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x16db2e)_0xcf2df1+=_0x16db2e;if(_0x15dfb6)_0xcf2df1+=_0x15dfb6;if(_0x324cfe)_0xcf2df1+=_0x324cfe;if(_0x16db2e||_0x15dfb6||_0x324cfe)_0xcf2df1+='\x0a';if(_0x376e78)_0xcf2df1+=_0x376e78;if(_0x859734)_0xcf2df1+=_0x859734;if(_0xea7e58)_0xcf2df1+=_0xea7e58;}const _0x515e36=_0x5342bb(_0x467897),_0x1c18a5=_0x194a3d(0x3b6)+_0x467897['name']+_0x194a3d(0x29a)+_0x467897[_0x194a3d(0x697)]+'\x22）。你已经有一段时间没有和用户（'+_0x2f94af+_0x194a3d(0xd52)+(_0x467897[_0x194a3d(0x761)][_0x194a3d(0x290)]?_0x194a3d(0x36f)+_0x2111ce+'\x20('+_0x3621cc+_0x194a3d(0xbb3)+_0xc2437e+'\x0a'+(_0xd6ac13?_0x194a3d(0xf6f):''):'')+_0x194a3d(0x1b1)+(_0x467897['lastActionType']||'无')+_0x194a3d(0x26c)+_0x480c08+_0x194a3d(0x94f)+_0x33f0fa+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20'+_0x467897[_0x194a3d(0x761)][_0x194a3d(0x8d5)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x165bc7+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x467897[_0x194a3d(0xe21)]&&_0x467897[_0x194a3d(0xe21)][_0x194a3d(0x594)]>0x0?_0x467897['longTermMemory'][_0x194a3d(0x796)](_0x52b4a8=>'-\x20(记录于\x20'+_0x497f2b(_0x52b4a8['timestamp'])+')\x20'+_0x52b4a8['content'])[_0x194a3d(0xa4b)]('\x0a'):'无')+_0x194a3d(0x94f)+_0xcf2df1+_0x194a3d(0x7be)+_0x4bb4ba+_0x194a3d(0x94f)+(_0x467897['settings'][_0x194a3d(0x290)]?'-\x20\x20\x20**当前时间**:'+_0x2111ce+'\x20('+_0x3621cc+')':'')+_0x194a3d(0x94f)+(_0x467897['settings'][_0x194a3d(0x290)]?'-\x20\x20\x20**对话状态**:\x20'+_0xc2437e:'')+_0x194a3d(0x160)+_0x515e36+_0x194a3d(0x501)+_0x4765bd+_0x194a3d(0x94f)+_0x50244d+'\x0a',_0x10a4fc=[{'role':'system','content':_0x1c18a5},..._0x1d6c24[_0x194a3d(0x796)](_0x12a193=>{const _0x4abdac=_0x194a3d,_0x250070=_0x12a193[_0x4abdac(0xba4)]===_0x4abdac(0x21c)?_0x2f94af:_0x467897[_0x4abdac(0x278)];let _0x4651ee=_0x12a193['content'];return typeof _0x4651ee!==_0x4abdac(0x10d7)&&(_0x4651ee=JSON['stringify'](_0x4651ee)),{'role':_0x12a193['role'],'content':_0x250070+':\x20'+_0x4651ee};})];try{const _0x3689ae=[{'role':_0x194a3d(0x21c),'content':_0x1c18a5+_0x194a3d(0x5f9)+_0x50244d}];console[_0x194a3d(0x84b)](_0x194a3d(0x5aa)+_0x467897[_0x194a3d(0x278)]+'\x22)');let _0x318b4d=_0x1f0054===GEMINI_API_URL,_0x36335e=_0x4a90fe(_0x54739c,_0x47966d,_0x1c18a5,_0x3689ae);const _0x53e59c=_0x318b4d?await fetch(_0x36335e[_0x194a3d(0x10ac)],_0x36335e[_0x194a3d(0x1cc)]):await fetch(_0x1f0054+_0x194a3d(0x8fd),{'method':_0x194a3d(0x1128),'headers':{'Content-Type':'application/json','Authorization':_0x194a3d(0xdaf)+_0x47966d},'body':JSON[_0x194a3d(0x313)]({'model':_0x54739c,'messages':_0x3689ae,'temperature':_0x5de8b7['globalSettings']['apiTemperature']||0.9})});if(!_0x53e59c['ok']){const _0x3fa3e0=await _0x53e59c[_0x194a3d(0xd7b)]();throw new Error('API请求失败:\x20'+_0x53e59c[_0x194a3d(0x739)]+_0x194a3d(0x12a2)+JSON[_0x194a3d(0x313)](_0x3fa3e0));}const _0x87f522=await _0x53e59c[_0x194a3d(0xd7b)](),_0x42bd09=_0x318b4d?getGeminiResponseText(_0x87f522):_0x87f522['choices'][0x0]['message']['content'];if(!_0x42bd09||_0x42bd09['trim']()===''){console[_0x194a3d(0x6b0)](_0x194a3d(0x39c)+_0x467897['name']+_0x194a3d(0xd9e));return;}const _0x258847=_0x30c9b6(_0x42bd09);if(!_0x258847||_0x258847[_0x194a3d(0x594)]===0x0){console['warn'](_0x194a3d(0x2b9)+_0x467897['name']+_0x194a3d(0x121),_0x42bd09);return;}let _0x555964=Date[_0x194a3d(0x1182)](),_0x17d36c=![];const _0x206070=[];for(const _0x565d0a of _0x258847){const _0xbdc9c1=String(_0x565d0a[_0x194a3d(0x9a5)]||''),_0x44ac72=_0xbdc9c1[_0x194a3d(0xeb7)]()[_0x194a3d(0xb6c)]('<')&&_0xbdc9c1[_0x194a3d(0xeb7)]()[_0x194a3d(0x771)]('>');if(_0x565d0a[_0x194a3d(0xa20)]===_0x194a3d(0x1197)&&!_0x44ac72&&_0xbdc9c1[_0x194a3d(0x3ad)]('\x0a')){const _0x20f97b=_0xbdc9c1[_0x194a3d(0x65b)](/\n+/)[_0x194a3d(0x138)](_0x14f797=>_0x14f797[_0x194a3d(0xeb7)]());_0x20f97b[_0x194a3d(0x494)](_0x28e956=>{const _0x1ed3f9=_0x194a3d;_0x206070[_0x1ed3f9(0xf5)]({..._0x565d0a,'content':_0x28e956});});}else _0x206070[_0x194a3d(0xf5)](_0x565d0a);}for(const _0x4f7cca of _0x206070){_0x467897[_0x194a3d(0x42e)]=_0x4f7cca['type'],_0x467897[_0x194a3d(0x117)]=_0x555964;let _0xfec9b9=null;const _0x22d793={'role':_0x194a3d(0x1119),'senderName':_0x467897[_0x194a3d(0x697)],'timestamp':_0x555964++};let _0x9525e=null;switch(_0x4f7cca['type']){case _0x194a3d(0x2b4):{const _0x425053=parseInt(_0x4f7cca['postId']),_0x3483de=await _0x2e83f8['qzonePosts'][_0x194a3d(0x1289)](_0x425053);if(_0x3483de&&_0x3483de['authorId']===_0x226f8d){await _0x2e83f8['qzonePosts'][_0x194a3d(0x1225)](_0x425053,{'isDeleted':!![]});document[_0x194a3d(0x11e3)](_0x194a3d(0x431))['classList'][_0x194a3d(0x1121)](_0x194a3d(0x1fc))&&_0xae9c28();const _0x47b2bf={'role':_0x194a3d(0xf72),'type':_0x194a3d(0x12ac),'content':'['+_0x467897[_0x194a3d(0x278)]+_0x194a3d(0xfc),'postId':_0x425053,'timestamp':_0x555964++};_0x467897[_0x194a3d(0x49e)]['push'](_0x47b2bf),isViewingThisChat?_0x3b5153(_0x47b2bf,_0x467897):(_0x467897[_0x194a3d(0xc3a)]=(_0x467897[_0x194a3d(0xc3a)]||0x0)+0x1,_0x2c799e(_0x226f8d,'['+_0x467897[_0x194a3d(0x278)]+_0x194a3d(0xfc)),_0x17d36c=!![]);}else console['warn'](_0x194a3d(0x576)+_0x467897[_0x194a3d(0x278)]+_0x194a3d(0x65e)+_0x4f7cca[_0x194a3d(0x2f0)]+')');continue;}case _0x194a3d(0x1197):_0xfec9b9={..._0x22d793,'content':_0x4f7cca[_0x194a3d(0x9a5)]};break;case _0x194a3d(0xd02):_0xfec9b9={..._0x22d793,'type':_0x194a3d(0xd02),'content':_0x4f7cca[_0x194a3d(0x1029)]};break;case _0x194a3d(0x87b):if(_0x4f7cca[_0x194a3d(0xb36)]){const _0x56aba8=_0x5de8b7['userStickers'][_0x194a3d(0xe79)](_0x5a94df=>_0x5a94df[_0x194a3d(0x278)]===_0x4f7cca[_0x194a3d(0xb36)]);_0x56aba8?_0xfec9b9={..._0x22d793,'type':_0x194a3d(0x87b),'content':_0x56aba8[_0x194a3d(0x10ac)],'meaning':_0x56aba8[_0x194a3d(0x278)]}:(console[_0x194a3d(0x6b0)](_0x194a3d(0x7ed)+_0x4f7cca[_0x194a3d(0xb36)]+'\x22'),_0xfec9b9={..._0x22d793,'type':_0x194a3d(0x1197),'content':_0x194a3d(0x119f)+_0x4f7cca[_0x194a3d(0xb36)]+']'});}else console[_0x194a3d(0x6b0)](_0x194a3d(0x894),_0x4f7cca),_0xfec9b9={..._0x22d793,'type':_0x194a3d(0x87b),'content':_0x4f7cca[_0x194a3d(0x10ac)],'meaning':_0x194a3d(0x10df)};break;case _0x194a3d(0x9be):_0x467897[_0x194a3d(0x739)][_0x194a3d(0x1197)]=_0x4f7cca[_0x194a3d(0x9b8)],_0x467897[_0x194a3d(0x739)]['isBusy']=_0x4f7cca['is_busy']||![],_0x467897[_0x194a3d(0x739)][_0x194a3d(0x136)]=Date[_0x194a3d(0x1182)]();break;case _0x194a3d(0x3cc):const _0x3522f0={'type':_0x4f7cca[_0x194a3d(0x7f8)],'content':_0x4f7cca[_0x194a3d(0x9a5)]||'','publicText':_0x4f7cca[_0x194a3d(0x12aa)]||'','hiddenContent':_0x4f7cca[_0x194a3d(0x6f7)]||'','image_prompt':_0x4f7cca[_0x194a3d(0xee6)]||'','timestamp':Date[_0x194a3d(0x1182)](),'authorId':_0x226f8d,'authorOriginalName':_0x467897[_0x194a3d(0x697)],'authorGroupId':_0x467897[_0x194a3d(0xe0d)],'visibleGroupIds':null};await _0x2e83f8[_0x194a3d(0x1218)][_0x194a3d(0x252)](_0x3522f0),_0x22db5e(_0x481a45+0x1),console[_0x194a3d(0x84b)]('后台活动:\x20角色\x20\x22'+_0x467897[_0x194a3d(0x278)]+_0x194a3d(0xe5a));break;case'repost':const _0x599661=await _0x2e83f8[_0x194a3d(0x1218)][_0x194a3d(0x1289)](parseInt(_0x4f7cca[_0x194a3d(0x2f0)]));if(_0x599661){const _0x1ffdf4={'type':_0x194a3d(0x45a),'timestamp':Date[_0x194a3d(0x1182)](),'authorId':_0x226f8d,'authorGroupId':_0x467897[_0x194a3d(0xe0d)],'authorOriginalName':_0x467897[_0x194a3d(0x697)],'repostComment':_0x4f7cca['comment']||'','originalPost':_0x599661,'visibleGroupIds':null};await _0x2e83f8[_0x194a3d(0x1218)]['add'](_0x1ffdf4),_0x22db5e(_0x481a45+0x1),console[_0x194a3d(0x84b)](_0x194a3d(0xc46)+_0x467897[_0x194a3d(0x278)]+_0x194a3d(0xa8b)+_0x4f7cca['postId']);}break;case'qzone_like':const _0x5bf367=await _0x2e83f8['qzonePosts'][_0x194a3d(0x1289)](parseInt(_0x4f7cca['postId']));if(_0x5bf367){if(!_0x5bf367['likes'])_0x5bf367[_0x194a3d(0x7eb)]=[];!_0x5bf367[_0x194a3d(0x7eb)][_0x194a3d(0x3ad)](_0x467897[_0x194a3d(0x697)])&&(_0x5bf367[_0x194a3d(0x7eb)][_0x194a3d(0xf5)](_0x467897[_0x194a3d(0x697)]),await _0x2e83f8[_0x194a3d(0x1218)][_0x194a3d(0x1225)](_0x5bf367['id'],{'likes':_0x5bf367[_0x194a3d(0x7eb)]}),_0x22db5e(_0x481a45+0x1),console[_0x194a3d(0x84b)](_0x194a3d(0xc46)+_0x467897['name']+_0x194a3d(0x821)+_0x4f7cca[_0x194a3d(0x2f0)]));}break;case _0x194a3d(0xfe9):{const _0x306d1d=await _0x2e83f8['qzonePosts']['get'](parseInt(_0x4f7cca[_0x194a3d(0x2f0)]));if(_0x306d1d){if(!_0x306d1d['comments'])_0x306d1d[_0x194a3d(0x1092)]=[];const _0x2b0c9f=_0x4f7cca[_0x194a3d(0x278)]||_0x467897['originalName'],_0x1e7642=(_0x178737,_0x4270d2=null,_0x968fb6=null)=>({'commenterName':_0x2b0c9f,'text':_0x33faa3(_0x178737,_0x467897),'meaning':_0x4270d2,'replyTo':_0x968fb6,'timestamp':Date[_0x194a3d(0x1182)]()});if(_0x4f7cca[_0x194a3d(0x6f0)]){const _0xc6cd88=_0x5de8b7['userStickers'][_0x194a3d(0xe79)](_0x5598e0=>_0x5598e0[_0x194a3d(0x278)]===_0x4f7cca[_0x194a3d(0x6f0)]);_0xc6cd88?_0x306d1d[_0x194a3d(0x1092)][_0x194a3d(0xf5)](_0x1e7642(_0xc6cd88[_0x194a3d(0x10ac)],_0xc6cd88[_0x194a3d(0x278)],_0x4f7cca[_0x194a3d(0x1083)]||null)):(console[_0x194a3d(0x6b0)]('AI\x20尝试评论一个不存在的表情:\x20\x22'+_0x4f7cca['stickerMeaning']+'\x22'),_0x306d1d[_0x194a3d(0x1092)][_0x194a3d(0xf5)](_0x1e7642(_0x194a3d(0x119f)+_0x4f7cca[_0x194a3d(0x6f0)]+']',null,_0x4f7cca[_0x194a3d(0x1083)]||null)));}else{if(Array['isArray'](_0x4f7cca[_0x194a3d(0x1092)]))_0x4f7cca[_0x194a3d(0x1092)][_0x194a3d(0x494)](_0x5da503=>{const _0x364f06=_0x194a3d;typeof _0x5da503===_0x364f06(0x10d7)&&_0x5da503[_0x364f06(0xeb7)]()&&_0x306d1d[_0x364f06(0x1092)][_0x364f06(0xf5)](_0x1e7642(_0x5da503,null,_0x4f7cca[_0x364f06(0x1083)]||null));});else typeof _0x4f7cca[_0x194a3d(0x538)]===_0x194a3d(0x10d7)&&_0x4f7cca[_0x194a3d(0x538)][_0x194a3d(0xeb7)]()&&_0x306d1d['comments'][_0x194a3d(0xf5)](_0x1e7642(_0x4f7cca[_0x194a3d(0x538)],null,_0x4f7cca[_0x194a3d(0x1083)]||null));}await _0x2e83f8[_0x194a3d(0x1218)]['update'](_0x306d1d['id'],{'comments':_0x306d1d[_0x194a3d(0x1092)]}),_0x22db5e(_0x481a45+0x1),console[_0x194a3d(0x84b)](_0x194a3d(0xc46)+_0x467897['name']+'\x22\x20评论了动态\x20#'+_0x4f7cca['postId']);if(!_0x467897[_0x194a3d(0xaf4)])_0x467897[_0x194a3d(0xaf4)]={};_0x467897['commentCooldowns'][_0x4f7cca[_0x194a3d(0x2f0)]]=Date[_0x194a3d(0x1182)]();}continue;}case _0x194a3d(0x481):!_0x46751e[_0x194a3d(0x3d5)]&&!_0x46751e['isAwaitingResponse']&&(_0x46751e[_0x194a3d(0x1d6)]=!![],_0x46751e[_0x194a3d(0x93d)]=_0x226f8d,_0x46751e[_0x194a3d(0x419)]=![],_0x46751e[_0x194a3d(0x1251)]=_0x467897[_0x194a3d(0x278)],_0x3f7dd2());break;default:console['warn'](_0x194a3d(0xebf)+_0x467897[_0x194a3d(0x278)]+'\x22\x20尝试执行未知的后台动作:',_0x4f7cca[_0x194a3d(0xa20)]);break;case _0x194a3d(0xcb2):{const _0x165383=_0x4f7cca[_0x194a3d(0x278)],_0x2b0b72=_0x467897[_0x194a3d(0x761)][_0x194a3d(0xe6d)]['find'](_0x7374c9=>_0x7374c9[_0x194a3d(0x278)]===_0x165383);_0x2b0b72&&(_0x467897[_0x194a3d(0x761)][_0x194a3d(0x5e0)]=_0x2b0b72[_0x194a3d(0x10ac)],await _0x46ae3e(_0x467897),visibleSystemMessage={'content':'['+_0x467897[_0x194a3d(0x278)]+_0x194a3d(0x130)},console[_0x194a3d(0x84b)](_0x194a3d(0xc46)+_0x467897[_0x194a3d(0x278)]+_0x194a3d(0x104a)));break;}}if(_0xfec9b9){_0x467897[_0x194a3d(0x49e)][_0x194a3d(0xf5)](_0xfec9b9),_0x467897[_0x194a3d(0xc3a)]=(_0x467897[_0x194a3d(0xc3a)]||0x0)+0x1;if(!_0x17d36c){let _0x3b2be2=_0xfec9b9[_0x194a3d(0xa20)]===_0x194a3d(0xd02)?_0x194a3d(0xd17):_0xfec9b9['content']||'';_0x2c799e(_0x226f8d,_0x3b2be2),_0x17d36c=!![];}}}await _0x2e83f8[_0x194a3d(0x737)][_0x194a3d(0xe3c)](_0x467897);}catch(_0x36cf19){console[_0x194a3d(0x1c1)](_0x194a3d(0xebf)+_0x467897[_0x194a3d(0x278)]+_0x194a3d(0xf01),_0x36cf19);}finally{_0x153b71(_0x226f8d,![]),_0x5ee219(),document['getElementById'](_0x194a3d(0x431))[_0x194a3d(0x505)][_0x194a3d(0x1121)](_0x194a3d(0x1fc))&&_0xae9c28();}}async function _0x501df3(_0x40c218){const _0x3ffa10=_0x241b18,_0x4b6baf=_0x5de8b7[_0x3ffa10(0x737)][_0x40c218];if(!_0x4b6baf||!_0x4b6baf[_0x3ffa10(0x1244)])return;const _0x5a8e5e=_0x4b6baf[_0x3ffa10(0x761)][_0x3ffa10(0xb09)]||0xa;if(_0x4b6baf['lastActionTimestamp']){const _0x2bcc6d=(Date[_0x3ffa10(0x1182)]()-_0x4b6baf['lastActionTimestamp'])/(0x3e8*0x3c);if(_0x2bcc6d<_0x5a8e5e){console[_0x3ffa10(0x84b)](_0x3ffa10(0xe67)+_0x4b6baf[_0x3ffa10(0x278)]+'\x22\x20处于行动冷却中，本次独立行动跳过。');return;}}const {proxyUrl:_0x2e3b8b,apiKey:_0xfacc4,model:_0x21a4fb}=_0x5de8b7[_0x3ffa10(0x89c)];if(!_0x2e3b8b||!_0xfacc4||!_0x21a4fb)return;const _0x295cb1=_0x4b6baf['settings'][_0x3ffa10(0xca7)]||'我',_0x28c959=new Date();let _0x382450;const _0x7e4d80=_0x4b6baf[_0x3ffa10(0x49e)][_0x3ffa10(0x138)](_0x44cddb=>!_0x44cddb[_0x3ffa10(0xbf5)])[_0x3ffa10(0xa6c)](-0x5),_0x49ca5c=_0x7e4d80['find'](_0x5b6184=>_0x5b6184[_0x3ffa10(0xa20)]===_0x3ffa10(0x305)&&!_0x5b6184['isFullyClaimed']);if(_0x49ca5c){const _0x171b94=_0xd9d60a(_0x4b6baf,_0x49ca5c[_0x3ffa10(0x768)]);console[_0x3ffa10(0x84b)](_0x3ffa10(0xd13)+_0x4b6baf[_0x3ffa10(0x278)]+'\x22\x20中有未领完的红包，正在生成抢红包指令...'),_0x382450=_0x3ffa10(0xa1e)+_0x171b94+_0x3ffa10(0x96d)+_0x49ca5c['timestamp']+'）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20'+_0x49ca5c[_0x3ffa10(0x702)]+_0x3ffa10(0x66e);}else{let _0x54f30b='';const _0x3ec907=_0x4b6baf[_0x3ffa10(0x761)][_0x3ffa10(0xff6)]||'Asia/Shanghai',_0x2d8346=_0x28c959[_0x3ffa10(0x9df)](_0x3ffa10(0x898),{'timeZone':_0x3ec907,'dateStyle':_0x3ffa10(0x5ca),'timeStyle':_0x3ffa10(0x3f8)}),_0x2d259b=new Date(_0x28c959['toLocaleString'](_0x3ffa10(0xf50),{'timeZone':_0x3ec907}));if(_0x4b6baf[_0x3ffa10(0x761)][_0x3ffa10(0x290)]){const _0x144041=_0x4b6baf[_0x3ffa10(0x49e)][_0x3ffa10(0x138)](_0xbcc6f1=>!_0xbcc6f1[_0x3ffa10(0xbf5)])['slice'](-0x1)[0x0];if(_0x144041){const _0x1f1d76=new Date(_0x144041['timestamp']),_0x6cc667=(_0x28c959-_0x1f1d76)/(0x3e8*0x3c);_0x6cc667>0x3c?_0x54f30b='群里已经安静了\x20'+Math[_0x3ffa10(0xe0)](_0x6cc667/0x3c)+_0x3ffa10(0xd50):_0x54f30b=_0x3ffa10(0xd70)+Math[_0x3ffa10(0xfb1)](_0x6cc667)+_0x3ffa10(0x841);}else _0x54f30b=_0x3ffa10(0xf75);}let _0x456416=_0x3ffa10(0x10ae);const _0x22ff03=_0x4b6baf[_0x3ffa10(0x761)][_0x3ffa10(0xb2e)]||0xa,_0x4846b8=_0x4b6baf[_0x3ffa10(0x49e)][_0x3ffa10(0x138)](_0x994e75=>!_0x994e75[_0x3ffa10(0xbf5)])[_0x3ffa10(0xa6c)](-_0x22ff03);_0x4846b8['length']>0x0&&(_0x456416='这是你们最近的对话：\x0a'+_0x4846b8[_0x3ffa10(0x796)](_0x116f2f=>{const _0x236bee=_0x3ffa10,_0x18e818=_0x116f2f['role']===_0x236bee(0x21c)?_0x295cb1:_0xd9d60a(_0x4b6baf,_0x116f2f[_0x236bee(0x768)]),_0x3895f2=String(_0x116f2f[_0x236bee(0x9a5)]||_0x116f2f[_0x236bee(0x4bc)]||'')[_0x236bee(0x8d4)](0x0,0x32);return _0x18e818+':\x20'+_0x3895f2+_0x236bee(0x6cb);})[_0x3ffa10(0xa4b)]('\x0a'));const _0x42bb52=_0x4b6baf[_0x3ffa10(0x2b3)][_0x3ffa10(0x796)](_0x563033=>_0x3ffa10(0x11c)+_0x563033[_0x3ffa10(0xc8f)]+_0x3ffa10(0x83f)+_0x563033[_0x3ffa10(0x697)]+'):\x20'+_0x563033[_0x3ffa10(0x701)])['join']('\x0a');let _0x3138fc=_0x3ffa10(0xad2),_0x583a79=![];_0x4b6baf[_0x3ffa10(0x2b3)][_0x3ffa10(0x494)](_0xa2f0a5=>{const _0x37fd2b=_0x3ffa10,_0x29bcda=_0x5de8b7[_0x37fd2b(0x737)][_0xa2f0a5['id']];_0x29bcda&&_0x29bcda['longTermMemory']&&_0x29bcda[_0x37fd2b(0xe21)][_0x37fd2b(0x594)]>0x0&&(_0x3138fc+='\x0a##\x20---\x20关于“'+_0xa2f0a5[_0x37fd2b(0xc8f)]+'”的记忆\x20---\x0a',_0x3138fc+=_0x29bcda[_0x37fd2b(0xe21)]['map'](_0x2eb762=>'-\x20'+_0x2eb762[_0x37fd2b(0x9a5)])['join']('\x0a'),_0x583a79=!![]);});!_0x583a79&&(_0x3138fc+=_0x3ffa10(0x12cc));let _0x1de3f9='';if(_0x4b6baf['settings'][_0x3ffa10(0xa17)]&&_0x4b6baf[_0x3ffa10(0x761)][_0x3ffa10(0xa17)][_0x3ffa10(0x594)]>0x0){const _0x268aa2=_0x4b6baf[_0x3ffa10(0x761)][_0x3ffa10(0xa17)][_0x3ffa10(0x796)](_0x523a5e=>{const _0x1991dd=_0x3ffa10,_0x5c28eb=_0x5de8b7[_0x1991dd(0xca)][_0x1991dd(0xe79)](_0x1c1a6a=>_0x1c1a6a['id']===_0x523a5e);if(!_0x5c28eb||!Array[_0x1991dd(0xb7b)](_0x5c28eb[_0x1991dd(0x9a5)]))return'';const _0x140b7c=_0x5c28eb[_0x1991dd(0x9a5)]['filter'](_0x57bf2d=>_0x57bf2d[_0x1991dd(0xc34)]!==![])[_0x1991dd(0x796)](_0x3db5e6=>{const _0x3b0f4e=_0x1991dd;let _0x4c7b8e='\x0a###\x20条目:\x20'+(_0x3db5e6[_0x3b0f4e(0xebd)]||'无备注')+'\x0a';return _0x3db5e6['keys'][_0x3b0f4e(0x594)]>0x0&&(_0x4c7b8e+=_0x3b0f4e(0x105b)+_0x3db5e6[_0x3b0f4e(0xb4a)][_0x3b0f4e(0xa4b)](',\x20')+'\x0a'),_0x4c7b8e+=_0x3b0f4e(0x10f0)+_0x3db5e6[_0x3b0f4e(0x9a5)],_0x4c7b8e;})[_0x1991dd(0xa4b)]('');return _0x140b7c?'\x0a\x0a##\x20世界书:\x20'+_0x5c28eb[_0x1991dd(0x278)]+'\x0a'+_0x140b7c:'';})[_0x3ffa10(0x138)](Boolean)[_0x3ffa10(0xa4b)]('');_0x268aa2&&(_0x1de3f9='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x268aa2+_0x3ffa10(0x421));}let _0x32e492='';const _0x114ca5=_0x4b6baf['settings'][_0x3ffa10(0x37c)]||0xa;if(_0x4b6baf['settings'][_0x3ffa10(0xd1d)]&&_0x4b6baf[_0x3ffa10(0x761)]['linkedMemoryChatIds'][_0x3ffa10(0x594)]>0x0){const _0x268a85=_0x4b6baf[_0x3ffa10(0x761)]['linkedMemoryChatIds'][_0x3ffa10(0x796)](_0x33b813=>{const _0x1f27f4=_0x3ffa10,_0x1b40fd=_0x5de8b7[_0x1f27f4(0x737)][_0x33b813];if(!_0x1b40fd)return null;const _0x92860=_0x1b40fd[_0x1f27f4(0x49e)][_0x1f27f4(0xa6c)](-0x1)[0x0];return{'chat':_0x1b40fd,'latestTimestamp':_0x92860?_0x92860[_0x1f27f4(0x702)]:0x0};})[_0x3ffa10(0x138)](Boolean);_0x268a85[_0x3ffa10(0x861)]((_0xa4d290,_0x265675)=>_0x265675[_0x3ffa10(0x1294)]-_0xa4d290[_0x3ffa10(0x1294)]),_0x32e492+=_0x3ffa10(0xff);for(const _0x3805e0 of _0x268a85){const _0x322b4c=_0x3805e0[_0x3ffa10(0x847)],_0x153514=_0x322b4c['isGroup']?_0x3ffa10(0x1116):_0x3ffa10(0xd19),_0x12da5e=_0x3805e0[_0x3ffa10(0x1294)]>0x0?'\x20(最后互动于\x20'+_0x497f2b(_0x3805e0[_0x3ffa10(0x1294)])+')':'';_0x32e492+=_0x3ffa10(0x11ec)+_0x153514+'“'+_0x322b4c[_0x3ffa10(0x278)]+'”的参考记忆'+_0x12da5e+'\x20---\x0a';const _0x1b883e=_0x322b4c[_0x3ffa10(0x49e)][_0x3ffa10(0xa6c)](-_0x114ca5),_0x8c83af=_0x1b883e[_0x3ffa10(0x138)](_0x3272d6=>!String(_0x3272d6[_0x3ffa10(0x9a5)])[_0x3ffa10(0x3ad)](_0x3ffa10(0xcab)));_0x8c83af[_0x3ffa10(0x594)]>0x0?_0x8c83af[_0x3ffa10(0x494)](_0x30c645=>{const _0x271827=_0x3ffa10,_0x11fe9a=_0x30c645['role']===_0x271827(0x21c)?_0x322b4c[_0x271827(0x761)][_0x271827(0xca7)]||'我':_0x30c645[_0x271827(0x768)]||_0x322b4c[_0x271827(0x278)];let _0x56c617=String(_0x30c645[_0x271827(0x9a5)]);if(_0x30c645[_0x271827(0xa20)]===_0x271827(0xd02)||_0x30c645['type']===_0x271827(0xeb))_0x56c617=_0x271827(0xe56)+_0x30c645['content']+']';else _0x30c645[_0x271827(0xa20)]===_0x271827(0x719)&&(_0x56c617=_0x271827(0x338)+_0x30c645[_0x271827(0x9a5)]+']');_0x32e492+=_0x11fe9a+':\x20'+_0x56c617+'\x0a';}):_0x32e492+=_0x3ffa10(0x11d0);}}const _0x19ccd7=await _0x2e83f8[_0x3ffa10(0x1218)]['orderBy'](_0x3ffa10(0x702))['reverse']()[_0x3ffa10(0x637)](0x5)[_0x3ffa10(0x508)]();let _0x211685='';const _0x27b1de=new Set();for(const _0x3867bd of _0x4b6baf[_0x3ffa10(0x2b3)]){const _0x1f4b80=_0x5de8b7[_0x3ffa10(0x737)][_0x3867bd['id']];if(_0x1f4b80){const _0x2aba40=_0x3f9279(_0x19ccd7,_0x1f4b80);_0x2aba40['forEach'](_0x5d9a53=>_0x27b1de['add'](_0x5d9a53));}}const _0x5add85=new Set(_0x4b6baf[_0x3ffa10(0x2b3)]['map'](_0x172f16=>_0x172f16[_0x3ffa10(0x697)])),_0x51fb0a=[..._0x27b1de][_0x3ffa10(0x138)](_0x157442=>{const _0x5972b1=_0x3ffa10,_0x436885=_0x157442[_0x5972b1(0x7eb)]&&_0x157442[_0x5972b1(0x7eb)][_0x5972b1(0xe7c)](_0x56c904=>_0x5add85['has'](_0x56c904)),_0x40daab=_0x157442[_0x5972b1(0x1092)]&&_0x157442[_0x5972b1(0x1092)][_0x5972b1(0xe7c)](_0x324805=>typeof _0x324805===_0x5972b1(0x537)&&_0x5add85[_0x5972b1(0x72a)](_0x324805[_0x5972b1(0x2ac)]));return!_0x436885&&!_0x40daab;});if(_0x51fb0a['length']>0x0){let _0x547afe=_0x3ffa10(0x1eb);for(const _0x419ed6 of _0x51fb0a){let _0x3578ff=_0x419ed6[_0x3ffa10(0x5d9)]==='user'?_0x295cb1:_0x5de8b7[_0x3ffa10(0x737)][_0x419ed6[_0x3ffa10(0x5d9)]]?.[_0x3ffa10(0x278)]||'一位朋友',_0x40d528;if(_0x419ed6[_0x3ffa10(0xa20)]==='repost'){const _0xdc5887=_0x419ed6['repostComment']?'并评论说：“'+_0x419ed6[_0x3ffa10(0x12a3)]+'”':'';let _0x557f34=_0x3ffa10(0x5fe);const _0x1285ac=_0x419ed6[_0x3ffa10(0xdd1)]['authorId'];if(_0x1285ac===_0x3ffa10(0x21c))_0x557f34=_0x5de8b7[_0x3ffa10(0x1c5)]['nickname'];else _0x5de8b7[_0x3ffa10(0x737)][_0x1285ac]&&(_0x557f34=_0x5de8b7['chats'][_0x1285ac]['name']);let _0x46289d;const _0x503b91=_0x419ed6['originalPost'];if(_0x503b91[_0x3ffa10(0xa20)]===_0x3ffa10(0x887))_0x46289d=_0x3ffa10(0x638)+(_0x503b91[_0x3ffa10(0x12aa)]||'')+_0x3ffa10(0x3ef)+(_0x503b91[_0x3ffa10(0x6f7)]||'')[_0x3ffa10(0x8d4)](0x0,0x28)+_0x3ffa10(0xb7e);else _0x503b91[_0x3ffa10(0xa20)]===_0x3ffa10(0x332)?_0x46289d=_0x3ffa10(0x280)+(_0x503b91['publicText']||'')+_0x3ffa10(0x3ef)+(_0x503b91['imageDescription']||'')[_0x3ffa10(0x8d4)](0x0,0x28)+_0x3ffa10(0xb7e):_0x46289d='“'+(_0x503b91[_0x3ffa10(0x9a5)]||'')[_0x3ffa10(0x8d4)](0x0,0x28)+'...”';_0x40d528='转发了\x20@'+_0x557f34+'\x20的动态\x20'+_0xdc5887+_0x3ffa10(0xb38)+_0x46289d+'】';}else{if(_0x419ed6['type']===_0x3ffa10(0x887))_0x40d528=(_0x3ffa10(0x4a5)+_0x419ed6[_0x3ffa10(0x6f7)]+_0x3ffa10(0xab1)+(_0x419ed6[_0x3ffa10(0x12aa)]||''))[_0x3ffa10(0x8d4)](0x0,0x32)+_0x3ffa10(0x6cb);else _0x419ed6[_0x3ffa10(0xa20)]===_0x3ffa10(0x332)?_0x40d528=('[一张图片，描述为：“'+_0x419ed6[_0x3ffa10(0x6b6)]+_0x3ffa10(0xab1)+(_0x419ed6[_0x3ffa10(0x12aa)]||''))[_0x3ffa10(0x8d4)](0x0,0x32)+_0x3ffa10(0x6cb):_0x40d528=String(_0x419ed6[_0x3ffa10(0x12aa)]||_0x419ed6['content']||'一条动态')[_0x3ffa10(0x8d4)](0x0,0x32)+_0x3ffa10(0x6cb);}_0x547afe+=_0x3ffa10(0x1161)+_0x419ed6['id']+')\x20作者:\x20'+_0x3578ff+',\x20内容:\x20\x22'+_0x40d528+'\x22\x0a';if(_0x419ed6[_0x3ffa10(0x1092)]&&_0x419ed6[_0x3ffa10(0x1092)]['length']>0x0)for(const _0x38fd2d of _0x419ed6[_0x3ffa10(0x1092)]){if(typeof _0x38fd2d===_0x3ffa10(0x537)&&_0x38fd2d['commenterName']){const _0xf88560=_0x4a0eba(_0x38fd2d['commenterName']);let _0x17bcec=_0x38fd2d[_0x3ffa10(0xb36)]?_0x3ffa10(0x452)+_0x38fd2d[_0x3ffa10(0xb36)]+'\x27]':_0x38fd2d['text'];_0x547afe+=_0x3ffa10(0x67e)+_0xf88560+_0x3ffa10(0x734)+_0x38fd2d[_0x3ffa10(0x2ac)]+_0x3ffa10(0x151)+_0x17bcec+'\x0a';}}}_0x211685=_0x547afe;}const _0xac8299=_0x57277b(_0x4b6baf,0x3,_0x3ffa10(0x1059)),_0x67694=_0x57277b(_0x4b6baf,0x6,_0x3ffa10(0x1059)),_0x156518=_0x57277b(_0x4b6baf,0x9,_0x3ffa10(0x1059)),_0xf5a828=_0x57277b(_0x4b6baf,0x1,_0x3ffa10(0xb95)),_0x3eb124=_0x57277b(_0x4b6baf,0x3,_0x3ffa10(0xb95)),_0x1aa879=_0x57277b(_0x4b6baf,0x7,_0x3ffa10(0xb95));let _0x4000f7='';if(_0xac8299||_0x67694||_0x156518||_0xf5a828||_0x3eb124||_0x1aa879){_0x4000f7+='\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a';if(_0xac8299)_0x4000f7+=_0xac8299;if(_0x67694)_0x4000f7+=_0x67694;if(_0x156518)_0x4000f7+=_0x156518;if(_0xac8299||_0x67694||_0x156518)_0x4000f7+='\x0a';if(_0xf5a828)_0x4000f7+=_0xf5a828;if(_0x3eb124)_0x4000f7+=_0x3eb124;if(_0x1aa879)_0x4000f7+=_0x1aa879;}const _0x51ebd1=_0xb76b68(_0x4b6baf);_0x382450=_0x3ffa10(0x4eb)+_0x4b6baf[_0x3ffa10(0x278)]+'”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4b6baf[_0x3ffa10(0x761)]['enableTimePerception']?_0x3ffa10(0xb49)+_0x2d8346+'。':'')+_0x3ffa10(0x94f)+(_0x54f30b?_0x54f30b+'\x20':'')+_0x3ffa10(0x106f)+_0x3138fc+_0x3ffa10(0x619)+_0x295cb1+'\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a-请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20'+_0x4b6baf[_0x3ffa10(0x278)]+_0x3ffa10(0x94f)+_0x1de3f9+_0x3ffa10(0xa56)+(_0x4b6baf[_0x3ffa10(0xe21)]&&_0x4b6baf[_0x3ffa10(0xe21)][_0x3ffa10(0x594)]>0x0?_0x4b6baf[_0x3ffa10(0xe21)]['map'](_0x49ecbd=>'-\x20'+_0x49ecbd[_0x3ffa10(0x9a5)])[_0x3ffa10(0xa4b)]('\x0a'):_0x3ffa10(0x12cc))+'\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4000f7+_0x3ffa10(0x94f)+_0x32e492+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x42bb52+_0x3ffa10(0x960)+_0x51ebd1+_0x3ffa10(0xd05)+_0x295cb1+_0x3ffa10(0xd7)+_0x4b6baf['settings'][_0x3ffa10(0x10c5)]+_0x3ffa10(0x23a)+_0x456416+_0x3ffa10(0x627)+_0x211685+_0x3ffa10(0xad1);}const _0x230eaf=_0x4b6baf[_0x3ffa10(0x49e)]['filter'](_0x36ebd4=>!_0x36ebd4[_0x3ffa10(0xbf5)])[_0x3ffa10(0xa6c)](-0xa),_0x8a19dd=[{'role':_0x3ffa10(0xf72),'content':_0x382450},..._0x230eaf[_0x3ffa10(0x796)](_0x548c69=>{const _0x3f5aae=_0x3ffa10,_0x30d506=_0x548c69[_0x3f5aae(0xba4)]===_0x3f5aae(0x21c)?_0x295cb1:_0xd9d60a(_0x4b6baf,_0x548c69['senderName']);let _0x50565b=_0x548c69[_0x3f5aae(0x9a5)];if(_0x548c69[_0x3f5aae(0xa20)]===_0x3f5aae(0xd02)||_0x548c69[_0x3f5aae(0xa20)]===_0x3f5aae(0xeb))_0x50565b=_0x3f5aae(0x10c1)+_0x548c69[_0x3f5aae(0x9a5)]+'\x27]';else{if(_0x548c69[_0x3f5aae(0xa20)]===_0x3f5aae(0x719))_0x50565b=_0x3f5aae(0x797)+_0x548c69[_0x3f5aae(0x9a5)]+'\x27]';else typeof _0x50565b!==_0x3f5aae(0x10d7)&&(_0x50565b=_0x3f5aae(0xcf0));}return{'role':_0x3f5aae(0x21c),'content':_0x30d506+':\x20'+_0x50565b};})];try{const _0x29ffee=[{'role':_0x3ffa10(0x21c),'content':_0x382450}];let _0x4bd7b4=_0x2e3b8b===GEMINI_API_URL,_0x39f0d9=_0x4a90fe(_0x21a4fb,_0xfacc4,_0x382450,_0x29ffee);const _0x9bed36=_0x4bd7b4?await fetch(_0x39f0d9[_0x3ffa10(0x10ac)],_0x39f0d9[_0x3ffa10(0x1cc)]):await fetch(_0x2e3b8b+'/v1/chat/completions',{'method':_0x3ffa10(0x1128),'headers':{'Content-Type':_0x3ffa10(0x35c),'Authorization':_0x3ffa10(0xdaf)+_0xfacc4},'body':JSON[_0x3ffa10(0x313)]({'model':_0x21a4fb,'messages':_0x29ffee,'temperature':_0x5de8b7[_0x3ffa10(0x2df)][_0x3ffa10(0xe66)]||0.9})});if(!_0x9bed36['ok'])throw new Error((await _0x9bed36['json']())[_0x3ffa10(0x1c1)][_0x3ffa10(0x4bc)]);const _0x21511d=await _0x9bed36[_0x3ffa10(0xd7b)](),_0x4c88a0=_0x4bd7b4?_0x21511d['candidates'][0x0][_0x3ffa10(0x9a5)][_0x3ffa10(0x9ba)][0x0][_0x3ffa10(0x1197)]:_0x21511d['choices'][0x0][_0x3ffa10(0x4bc)][_0x3ffa10(0x9a5)],_0x3af6c9=_0x30c9b6(_0x4c88a0);if(!_0x3af6c9||_0x3af6c9['length']===0x0){console[_0x3ffa10(0x6b0)]('群聊\x20\x22'+_0x4b6baf[_0x3ffa10(0x278)]+_0x3ffa10(0xfb2));return;}let _0x325047=Date['now'](),_0x398ce9=![],_0x341bd2='',_0x2d1a34='';const _0x5c3eb3=[];for(const _0x191525 of _0x3af6c9){const _0x366f72=String(_0x191525[_0x3ffa10(0x9a5)]||''),_0x7ed44f=_0x366f72[_0x3ffa10(0xeb7)]()[_0x3ffa10(0xb6c)]('<')&&_0x366f72[_0x3ffa10(0xeb7)]()['endsWith']('>');if(_0x191525[_0x3ffa10(0xa20)]===_0x3ffa10(0x1197)&&!_0x7ed44f&&_0x366f72[_0x3ffa10(0x3ad)]('\x0a')){const _0x216539=_0x366f72[_0x3ffa10(0x65b)](/\n+/)['filter'](_0x2e2c1c=>_0x2e2c1c[_0x3ffa10(0xeb7)]());_0x216539[_0x3ffa10(0x494)](_0x23cef9=>{const _0x2ede73=_0x3ffa10;_0x5c3eb3[_0x2ede73(0xf5)]({..._0x191525,'content':_0x23cef9});});}else _0x5c3eb3['push'](_0x191525);}for(const _0x23e5a2 of _0x5c3eb3){if(!_0x23e5a2||!_0x23e5a2[_0x3ffa10(0xa20)]||!_0x23e5a2[_0x3ffa10(0x278)])continue;const _0x2bd597=_0xd9d60a(_0x4b6baf,_0x23e5a2[_0x3ffa10(0x278)]);let _0x509ef3=null,_0x48ed02=null;const _0x5bd920={'role':_0x3ffa10(0x1119),'senderName':_0x23e5a2[_0x3ffa10(0x278)],'timestamp':_0x325047++};if(_0x23e5a2[_0x3ffa10(0xa20)]===_0x3ffa10(0xa7b)){const _0x34a8a0=_0x4b6baf[_0x3ffa10(0x49e)][_0x3ffa10(0xe79)](_0x21cfbe=>_0x21cfbe['timestamp']===_0x23e5a2[_0x3ffa10(0x8f2)]);if(_0x34a8a0&&!_0x34a8a0['isFullyClaimed']&&!(_0x34a8a0[_0x3ffa10(0xcf6)]&&_0x34a8a0[_0x3ffa10(0xcf6)][_0x23e5a2[_0x3ffa10(0x278)]])){let _0x442f91=0x0;const _0x3f2f89=_0x34a8a0[_0x3ffa10(0x3a9)]-Object[_0x3ffa10(0x4ca)](_0x34a8a0['claimedBy']||{})[_0x3ffa10(0x870)]((_0x530ae8,_0x32c09a)=>_0x530ae8+_0x32c09a,0x0),_0x3cfa10=_0x34a8a0['count']-Object[_0x3ffa10(0xb4a)](_0x34a8a0[_0x3ffa10(0xcf6)]||{})[_0x3ffa10(0x594)];if(_0x3cfa10>0x0){if(_0x3cfa10===0x1)_0x442f91=_0x3f2f89;else{const _0x50fd92=0.01,_0x4efaa3=_0x3f2f89-(_0x3cfa10-0x1)*_0x50fd92;_0x442f91=Math[_0x3ffa10(0x36d)]()*(_0x4efaa3-_0x50fd92)+_0x50fd92;}_0x442f91=parseFloat(_0x442f91[_0x3ffa10(0x200)](0x2));if(!_0x34a8a0[_0x3ffa10(0xcf6)])_0x34a8a0['claimedBy']={};_0x34a8a0[_0x3ffa10(0xcf6)][_0x23e5a2[_0x3ffa10(0x278)]]=_0x442f91,_0x4b6baf['history'][_0x3ffa10(0xf5)]({'role':_0x3ffa10(0xf72),'type':_0x3ffa10(0x8ee),'content':_0x2bd597+_0x3ffa10(0xc45)+_0xd9d60a(_0x4b6baf,_0x34a8a0[_0x3ffa10(0x768)])+_0x3ffa10(0xb35),'timestamp':Date[_0x3ffa10(0x1182)]()});let _0x4593a6=_0x3ffa10(0x147)+_0x2bd597+')\x20成功抢到了\x20'+_0x442f91[_0x3ffa10(0x200)](0x2)+_0x3ffa10(0x3a8);if(Object[_0x3ffa10(0xb4a)](_0x34a8a0['claimedBy'])[_0x3ffa10(0x594)]>=_0x34a8a0['count']){_0x34a8a0[_0x3ffa10(0x5e7)]=!![],_0x4b6baf[_0x3ffa10(0x49e)][_0x3ffa10(0xf5)]({'role':_0x3ffa10(0xf72),'type':_0x3ffa10(0x8ee),'content':_0xd9d60a(_0x4b6baf,_0x34a8a0['senderName'])+_0x3ffa10(0x9c8),'timestamp':Date[_0x3ffa10(0x1182)]()+0x1});let _0x37fa8b={'name':'','amount':-0x1};Object['entries'](_0x34a8a0[_0x3ffa10(0xcf6)])[_0x3ffa10(0x494)](([_0x4689ca,_0x9f5524])=>{const _0x2f1ae3=_0x3ffa10;_0x9f5524>_0x37fa8b[_0x2f1ae3(0x354)]&&(_0x37fa8b={'name':_0x4689ca,'amount':_0x9f5524});});if(_0x37fa8b['name']){const _0x490fbe=_0xd9d60a(_0x4b6baf,_0x37fa8b[_0x3ffa10(0x278)]);_0x4593a6+=_0x3ffa10(0xf57)+_0x490fbe+'！';}}_0x4593a6+=_0x3ffa10(0x1146),_0x4b6baf['history']['push']({'role':'system','content':_0x4593a6,'timestamp':Date[_0x3ffa10(0x1182)]()+0x2,'isHidden':!![]});}}_0x398ce9=!![];continue;}switch(_0x23e5a2['type']){case _0x3ffa10(0x87b):if(_0x23e5a2[_0x3ffa10(0xb36)]){const _0x4e575d=_0x5de8b7[_0x3ffa10(0xa67)]['find'](_0x9d2f4c=>_0x9d2f4c[_0x3ffa10(0x278)]===_0x23e5a2[_0x3ffa10(0xb36)]);_0x4e575d?_0x48ed02={..._0x5bd920,'type':_0x3ffa10(0x87b),'content':_0x4e575d[_0x3ffa10(0x10ac)],'meaning':_0x4e575d['name']}:(console[_0x3ffa10(0x6b0)](_0x3ffa10(0x750)+_0x23e5a2[_0x3ffa10(0xb36)]+'\x22'),_0x48ed02={..._0x5bd920,'type':'text','content':_0x3ffa10(0x119f)+_0x23e5a2[_0x3ffa10(0xb36)]+']'});}else console[_0x3ffa10(0x6b0)]('AI\x20(群聊后台)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。',_0x23e5a2),_0x48ed02={..._0x5bd920,'type':_0x3ffa10(0x87b),'content':_0x23e5a2[_0x3ffa10(0x10ac)],'meaning':_0x3ffa10(0x10df)};break;case'qzone_post':const _0x350e22={'type':_0x23e5a2[_0x3ffa10(0x7f8)]||_0x3ffa10(0xc40),'content':_0x23e5a2['content'],'timestamp':Date[_0x3ffa10(0x1182)](),'authorId':_0x5de8b7[_0x3ffa10(0x737)][Object['keys'](_0x5de8b7[_0x3ffa10(0x737)])[_0x3ffa10(0xe79)](_0x527570=>_0x5de8b7[_0x3ffa10(0x737)][_0x527570][_0x3ffa10(0x697)]===_0x23e5a2[_0x3ffa10(0x278)])]?.['id']||_0x23e5a2[_0x3ffa10(0x278)],'authorOriginalName':_0x23e5a2['name'],'visibleGroupIds':null};await _0x2e83f8[_0x3ffa10(0x1218)][_0x3ffa10(0x252)](_0x350e22),_0x22db5e(_0x481a45+0x1),_0x509ef3={'content':'['+_0x2bd597+_0x3ffa10(0xeac)};break;case'qzone_comment':const _0x58253f=await _0x2e83f8[_0x3ffa10(0x1218)][_0x3ffa10(0x1289)](parseInt(_0x23e5a2[_0x3ffa10(0x2f0)]));if(_0x58253f){if(!_0x58253f[_0x3ffa10(0x1092)])_0x58253f[_0x3ffa10(0x1092)]=[];_0x58253f['comments'][_0x3ffa10(0xf5)]({'commenterName':_0x23e5a2[_0x3ffa10(0x278)],'text':_0x23e5a2[_0x3ffa10(0x538)],'timestamp':Date[_0x3ffa10(0x1182)]()}),await _0x2e83f8['qzonePosts'][_0x3ffa10(0x1225)](_0x58253f['id'],{'comments':_0x58253f[_0x3ffa10(0x1092)]}),_0x22db5e(_0x481a45+0x1),_0x509ef3={'content':'['+_0x2bd597+_0x3ffa10(0x413)};}break;case _0x3ffa10(0x10a2):const _0x7a1720=await _0x2e83f8[_0x3ffa10(0x1218)][_0x3ffa10(0x1289)](parseInt(_0x23e5a2[_0x3ffa10(0x2f0)]));if(_0x7a1720){if(!_0x7a1720[_0x3ffa10(0x7eb)])_0x7a1720[_0x3ffa10(0x7eb)]=[];!_0x7a1720[_0x3ffa10(0x7eb)][_0x3ffa10(0x3ad)](_0x23e5a2[_0x3ffa10(0x278)])&&(_0x7a1720[_0x3ffa10(0x7eb)][_0x3ffa10(0xf5)](_0x23e5a2[_0x3ffa10(0x278)]),await _0x2e83f8[_0x3ffa10(0x1218)][_0x3ffa10(0x1225)](_0x7a1720['id'],{'likes':_0x7a1720[_0x3ffa10(0x7eb)]}),_0x22db5e(_0x481a45+0x1),_0x509ef3={'content':'['+_0x2bd597+_0x3ffa10(0x1b5)});}break;case _0x3ffa10(0xd02):_0x48ed02={..._0x5bd920,'type':'ai_image','content':_0x23e5a2[_0x3ffa10(0x1029)],'image_prompt':msgData[_0x3ffa10(0xee6)]};break;default:if(_0x23e5a2[_0x3ffa10(0xa20)]==='poll'){const _0x26a813=typeof _0x23e5a2[_0x3ffa10(0x11a1)]==='string'?_0x23e5a2[_0x3ffa10(0x11a1)][_0x3ffa10(0x65b)]('\x0a')[_0x3ffa10(0x138)](_0x5e7a49=>_0x5e7a49['trim']()):Array[_0x3ffa10(0xb7b)](_0x23e5a2[_0x3ffa10(0x11a1)])?_0x23e5a2[_0x3ffa10(0x11a1)]:[];if(_0x26a813[_0x3ffa10(0x594)]<0x2)continue;_0x48ed02={..._0x5bd920,..._0x23e5a2,'options':_0x26a813,'votes':{},'isClosed':![]};}else{const _0x55eaf2=_0x23e5a2[_0x3ffa10(0x9a5)]||_0x23e5a2[_0x3ffa10(0x4bc)];_0x48ed02={..._0x5bd920,..._0x23e5a2};if(_0x55eaf2)_0x48ed02['content']=_0x55eaf2;}break;}if(_0x509ef3)_0x4b6baf[_0x3ffa10(0x49e)][_0x3ffa10(0xf5)]({'role':_0x3ffa10(0xf72),'type':'pat_message','content':_0x509ef3['content'],'timestamp':_0x325047++});else _0x48ed02&&(_0x4b6baf['history'][_0x3ffa10(0xf5)](_0x48ed02),!_0x2d1a34&&(_0x2d1a34=_0x2bd597,_0x341bd2=_0x48ed02['type']===_0x3ffa10(0xd02)?_0x3ffa10(0xd17):_0x48ed02['content']||'['+_0x48ed02[_0x3ffa10(0xa20)]+']'));_0x398ce9=!![];}_0x398ce9&&(_0x4b6baf[_0x3ffa10(0x117)]=Date['now'](),_0x4b6baf[_0x3ffa10(0xc3a)]=(_0x4b6baf[_0x3ffa10(0xc3a)]||0x0)+_0x3af6c9['filter'](_0x244fbf=>_0x244fbf[_0x3ffa10(0xa20)]!==_0x3ffa10(0x3cc)&&_0x244fbf[_0x3ffa10(0xa20)]!==_0x3ffa10(0xfe9)&&_0x244fbf[_0x3ffa10(0xa20)]!=='qzone_like')[_0x3ffa10(0x594)],_0x2d1a34&&_0x341bd2&&_0x2c799e(_0x40c218,_0x2d1a34+':\x20'+_0x341bd2),await _0x2e83f8['chats'][_0x3ffa10(0xe3c)](_0x4b6baf));}catch(_0x554a3a){console['error']('群聊\x20\x22'+_0x4b6baf[_0x3ffa10(0x278)]+_0x3ffa10(0xf01),_0x554a3a);}finally{_0x5ee219();}}function _0x5a313a(_0x393319,_0x125cd7,_0x3ca5f6){const _0x2aeb15=_0x241b18,_0x2107a5=document['getElementById'](_0x3ca5f6);if(!_0x2107a5)return;if(!_0x393319||_0x393319['trim']()===''){_0x2107a5[_0x2aeb15(0x595)]='';return;}const _0x39dcdb=_0x393319[_0x2aeb15(0x1018)](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x125cd7+_0x2aeb15(0x463))[_0x2aeb15(0x1018)](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x125cd7+_0x2aeb15(0x96f))[_0x2aeb15(0x1018)](/\s*\.message-bubble\s+([^{]+\{)/g,_0x125cd7+'\x20.message-bubble\x20$1');_0x2107a5[_0x2aeb15(0x595)]=_0x39dcdb;}async function _0x2d03c9(){const _0x4bc65b=_0x241b18;if(!_0x5de8b7[_0x4bc65b(0x93d)])return;const _0x479ec7=_0x5de8b7['chats'][_0x5de8b7[_0x4bc65b(0x93d)]],_0xdff0b0=document[_0x4bc65b(0x11e3)](_0x4bc65b(0x7c3));if(!_0xdff0b0)return;const _0x3d7771=document['querySelector'](_0x4bc65b(0xe59))?.['value']||_0x4bc65b(0xd3),_0x2be7fc=document[_0x4bc65b(0x11e3)](_0x4bc65b(0xf6e))['value'],_0x2ee8a3=document[_0x4bc65b(0x11e3)](_0x4bc65b(0x311))[_0x4bc65b(0xf27)],_0x2ad8af=_0x479ec7[_0x4bc65b(0x761)][_0x4bc65b(0xd10)];_0xdff0b0['dataset'][_0x4bc65b(0xad7)]=_0x3d7771,_0xdff0b0[_0x4bc65b(0x794)][_0x4bc65b(0xd8c)](_0x4bc65b(0xb0a),_0x2be7fc+'px');_0x2ad8af&&_0x2ad8af[_0x4bc65b(0xb6c)](_0x4bc65b(0x10e))?(_0xdff0b0[_0x4bc65b(0x794)]['backgroundImage']=_0x4bc65b(0xac7)+_0x2ad8af+')',_0xdff0b0['style'][_0x4bc65b(0x556)]=_0x4bc65b(0xbcd)):(_0xdff0b0[_0x4bc65b(0x794)][_0x4bc65b(0x123e)]='none',_0xdff0b0[_0x4bc65b(0x794)][_0x4bc65b(0xd10)]=_0x2ad8af||_0x4bc65b(0x4fa));_0xdff0b0[_0x4bc65b(0x595)]='';const _0x36d334={'role':'ai','content':_0x4bc65b(0x8c7),'timestamp':0x1,'senderName':_0x479ec7['name']},_0x50c14e=await _0xe99b75(_0x36d334,_0x479ec7);if(_0x50c14e)_0xdff0b0[_0x4bc65b(0x120c)](_0x50c14e);const _0x40e986={'role':_0x4bc65b(0x21c),'content':_0x4bc65b(0x401),'timestamp':0x2},_0x581080=await _0xe99b75(_0x40e986,_0x479ec7);if(_0x581080)_0xdff0b0['appendChild'](_0x581080);const _0xaf750e=document['createElement']('div');_0xaf750e[_0x4bc65b(0x794)]['cssText']=_0x4bc65b(0xf1f),_0xaf750e[_0x4bc65b(0x300)]=_0x4bc65b(0xbbe),_0xdff0b0[_0x4bc65b(0x120c)](_0xaf750e);const _0xf27556=document[_0x4bc65b(0x11e3)]('lyrics-vertical-pos')['value'],_0x209f58=document['getElementById'](_0x4bc65b(0x11c4))[_0x4bc65b(0xf27)],_0x2ed5f5=parseInt(document[_0x4bc65b(0x11e3)](_0x4bc65b(0xcff))['value'])||0xa;_0xf27556===_0x4bc65b(0x10e2)?_0xaf750e[_0x4bc65b(0x794)]['top']=_0x2ed5f5+'px':_0xaf750e[_0x4bc65b(0x794)][_0x4bc65b(0x1070)]=_0x2ed5f5+'px';switch(_0x209f58){case _0x4bc65b(0x910):_0xaf750e[_0x4bc65b(0x794)][_0x4bc65b(0x910)]=_0x4bc65b(0xb04);break;case _0x4bc65b(0xf47):_0xaf750e['style'][_0x4bc65b(0xf47)]=_0x4bc65b(0xb04);break;default:_0xaf750e[_0x4bc65b(0x794)][_0x4bc65b(0x910)]='50%',_0xaf750e[_0x4bc65b(0x794)][_0x4bc65b(0xb5d)]=_0x4bc65b(0x11e9);break;}_0x5a313a(_0x2ee8a3,_0x4bc65b(0xfd9),_0x4bc65b(0xfbc));}async function _0x1603e9(){const _0x4214b9=_0x241b18;await _0x11e903(),document['getElementById'](_0x4214b9(0x122c))[_0x4214b9(0x505)]['add'](_0x4214b9(0x250));}async function _0x11e903(){const _0x4a9043=_0x241b18,_0x411429=document['getElementById'](_0x4a9043(0x76e)),_0x24f826=await _0x2e83f8['qzoneGroups'][_0x4a9043(0x508)]();_0x411429['innerHTML']='',_0x24f826[_0x4a9043(0x594)]===0x0&&(_0x411429[_0x4a9043(0x595)]=_0x4a9043(0xa7f)),_0x24f826[_0x4a9043(0x494)](_0x192f0f=>{const _0x389ba4=_0x4a9043,_0x4c7a86=document[_0x389ba4(0x383)]('div');_0x4c7a86[_0x389ba4(0x3db)]='existing-group-item',_0x4c7a86[_0x389ba4(0x595)]=_0x389ba4(0x1f1)+_0x192f0f['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x192f0f['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x411429['appendChild'](_0x4c7a86);});}async function _0x3bb3c6(){const _0x5df709=_0x241b18,_0x3d8fe1=document[_0x5df709(0x11e3)]('new-group-name-input'),_0x429820=_0x3d8fe1[_0x5df709(0xf27)][_0x5df709(0xeb7)]();if(!_0x429820){alert(_0x5df709(0xdac));return;}const _0x112dfe=await _0x2e83f8[_0x5df709(0xd31)][_0x5df709(0x129e)](_0x5df709(0x278))[_0x5df709(0x119e)](_0x429820)['first']();if(_0x112dfe){alert(_0x5df709(0xb79)+_0x429820+_0x5df709(0xc55));return;}await _0x2e83f8['qzoneGroups'][_0x5df709(0x252)]({'name':_0x429820}),_0x3d8fe1[_0x5df709(0xf27)]='',await _0x11e903();}async function _0x49060a(_0x50fe49){const _0xef98a1=_0x241b18,_0x4cb9ca=await _0x58fd60(_0xef98a1(0x1166),_0xef98a1(0x709),{'confirmButtonClass':'btn-danger'});if(_0x4cb9ca){await _0x2e83f8[_0xef98a1(0xd31)]['delete'](_0x50fe49);const _0x3009f8=await _0x2e83f8[_0xef98a1(0x737)]['where']('groupId')[_0xef98a1(0x119e)](_0x50fe49)[_0xef98a1(0x508)]();for(const _0x2bc12e of _0x3009f8){_0x2bc12e[_0xef98a1(0xe0d)]=null,await _0x2e83f8[_0xef98a1(0x737)]['put'](_0x2bc12e);if(_0x5de8b7['chats'][_0x2bc12e['id']])_0x5de8b7['chats'][_0x2bc12e['id']][_0xef98a1(0xe0d)]=null;}await _0x11e903();}}function _0x5d9dfb(_0x45dd4f){const _0x350d61=_0x241b18,_0x5261d9=_0x5de8b7[_0x350d61(0x737)][_0x5de8b7['activeChatId']];document[_0x350d61(0x11e3)](_0x350d61(0xb1f))[_0x350d61(0x794)][_0x350d61(0x33d)]=_0x5261d9[_0x350d61(0x1244)]?'block':_0x350d61(0x379);if(_0x56fc05)return;_0x50fd7c=_0x45dd4f,document['getElementById']('message-actions-modal')[_0x350d61(0x505)]['add'](_0x350d61(0x250));}function _0x5652d7(){const _0x11ab30=_0x241b18;document['getElementById'](_0x11ab30(0x1184))[_0x11ab30(0x505)][_0x11ab30(0x957)](_0x11ab30(0x250)),_0x50fd7c=null;}async function _0x359bcb(){const _0xaf62f7=_0x241b18;if(!_0x50fd7c)return;const _0x57a641=_0x50fd7c,_0x147638=_0x5de8b7['chats'][_0x5de8b7[_0xaf62f7(0x93d)]],_0x1e1830=_0x147638[_0xaf62f7(0x49e)][_0xaf62f7(0xe79)](_0x3d7481=>_0x3d7481[_0xaf62f7(0x702)]===_0x57a641);if(!_0x1e1830)return;_0x5652d7();let _0x153ee1;const _0x46354f=_0x1e1830[_0xaf62f7(0xa20)]&&[_0xaf62f7(0x719),_0xaf62f7(0xd02),_0xaf62f7(0x82b),_0xaf62f7(0x67b)][_0xaf62f7(0x3ad)](_0x1e1830[_0xaf62f7(0xa20)]);if(_0x46354f){let _0x2f3616={'type':_0x1e1830['type']};if(_0x1e1830[_0xaf62f7(0xa20)]===_0xaf62f7(0x719))_0x2f3616['content']=_0x1e1830['content'];else{if(_0x1e1830[_0xaf62f7(0xa20)]==='ai_image')_0x2f3616[_0xaf62f7(0x1029)]=_0x1e1830[_0xaf62f7(0x9a5)];else{if(_0x1e1830[_0xaf62f7(0xa20)]===_0xaf62f7(0x82b))_0x2f3616[_0xaf62f7(0x354)]=_0x1e1830['amount'],_0x2f3616['note']=_0x1e1830[_0xaf62f7(0x1213)];else _0x1e1830[_0xaf62f7(0xa20)]==='share_link'&&(_0x2f3616[_0xaf62f7(0x740)]=_0x1e1830[_0xaf62f7(0x740)],_0x2f3616['description']=_0x1e1830[_0xaf62f7(0x1029)],_0x2f3616['source_name']=_0x1e1830[_0xaf62f7(0x101b)],_0x2f3616[_0xaf62f7(0x9a5)]=_0x1e1830[_0xaf62f7(0x9a5)]);}}_0x153ee1=JSON['stringify'](_0x2f3616,null,0x2);}else typeof _0x1e1830[_0xaf62f7(0x9a5)]===_0xaf62f7(0x537)?_0x153ee1=JSON[_0xaf62f7(0x313)](_0x1e1830['content'],null,0x2):_0x153ee1=_0x1e1830[_0xaf62f7(0x9a5)];const _0x412112={'voice':{'type':_0xaf62f7(0x719),'content':_0xaf62f7(0x9c7)},'image':{'type':_0xaf62f7(0xd02),'description':_0xaf62f7(0x11e)},'transfer':{'type':'transfer','amount':5.2,'note':_0xaf62f7(0xa74)},'link':{'type':_0xaf62f7(0x67b),'title':_0xaf62f7(0xdf6),'description':_0xaf62f7(0x1007),'source_name':_0xaf62f7(0x433),'content':_0xaf62f7(0x1f0)}},_0x3c4237=_0xaf62f7(0xe1d)+JSON[_0xaf62f7(0x313)](_0x412112[_0xaf62f7(0x835)])+'\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0xaf62f7(0x313)](_0x412112[_0xaf62f7(0x6e9)])+_0xaf62f7(0xcaa)+JSON[_0xaf62f7(0x313)](_0x412112[_0xaf62f7(0x82b)])+_0xaf62f7(0x96a)+JSON[_0xaf62f7(0x313)](_0x412112[_0xaf62f7(0xa5a)])+_0xaf62f7(0x123d),_0x1af2c4=await _0x231a5a(_0xaf62f7(0xa2a),_0xaf62f7(0xc44),_0x153ee1,_0xaf62f7(0x10bb),_0x3c4237);_0x1af2c4!==null&&await _0x289504(_0x57a641,_0x1af2c4,!![]);}async function _0x5d74fd(){const _0xaeb7c8=_0x241b18;if(!_0x50fd7c)return;const _0xfb0c0a=_0x5de8b7[_0xaeb7c8(0x737)][_0x5de8b7['activeChatId']],_0x57860f=_0xfb0c0a['history']['find'](_0x2eff5d=>_0x2eff5d[_0xaeb7c8(0x702)]===_0x50fd7c);if(!_0x57860f)return;let _0x2b1f9e;typeof _0x57860f[_0xaeb7c8(0x9a5)]===_0xaeb7c8(0x537)?_0x2b1f9e=JSON[_0xaeb7c8(0x313)](_0x57860f[_0xaeb7c8(0x9a5)]):_0x2b1f9e=String(_0x57860f['content']);try{await navigator[_0xaeb7c8(0xd41)][_0xaeb7c8(0x94c)](_0x2b1f9e),await _0x2fb06(_0xaeb7c8(0x109c),_0xaeb7c8(0x1a9));}catch(_0x209d58){await _0x2fb06(_0xaeb7c8(0x438),'无法访问剪贴板。');}_0x5652d7();}async function _0x5eb7c9(){const _0x1849b5=_0x241b18;if(!_0x50fd7c)return;try{await navigator[_0x1849b5(0xd41)][_0x1849b5(0x94c)](_0x50fd7c),await _0x2fb06(_0x1849b5(0x109c),_0x1849b5(0xa9f)+_0x50fd7c+_0x1849b5(0xdd7));}catch(_0x509aa8){await _0x2fb06(_0x1849b5(0x438),_0x1849b5(0x378));}_0x5652d7();}function _0x72868f(_0x531e26=''){const _0xbc8d0b=_0x241b18,_0x3d52f7=document[_0xbc8d0b(0x383)]('div');_0x3d52f7[_0xbc8d0b(0x3db)]='message-editor-block';const _0x2efdf9={'voice':{'type':_0xbc8d0b(0x719),'content':_0xbc8d0b(0x9c7)},'image':{'type':'ai_image','description':_0xbc8d0b(0x11e)},'transfer':{'type':_0xbc8d0b(0x82b),'amount':5.2,'note':'一点心意'},'link':{'type':_0xbc8d0b(0x67b),'title':_0xbc8d0b(0xdf6),'description':_0xbc8d0b(0x1007),'source_name':_0xbc8d0b(0x433),'content':_0xbc8d0b(0x1f0)},'offline':{'type':'offline_text','content':_0xbc8d0b(0x42f)},'quote':{'type':'quote_reply','target_timestamp':0x499602d2,'reply_content':'在这里输入回复内容'}};return _0x3d52f7[_0xbc8d0b(0x595)]=_0xbc8d0b(0x2c6)+_0x531e26+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0xbc8d0b(0x313)](_0x2efdf9[_0xbc8d0b(0x835)])+_0xbc8d0b(0x583)+JSON[_0xbc8d0b(0x313)](_0x2efdf9[_0xbc8d0b(0x6e9)])+_0xbc8d0b(0x14e)+JSON[_0xbc8d0b(0x313)](_0x2efdf9[_0xbc8d0b(0x82b)])+_0xbc8d0b(0x30e)+JSON[_0xbc8d0b(0x313)](_0x2efdf9[_0xbc8d0b(0xa5a)])+_0xbc8d0b(0xb3d)+JSON[_0xbc8d0b(0x313)](_0x2efdf9[_0xbc8d0b(0xbe2)])+_0xbc8d0b(0xbe5)+JSON[_0xbc8d0b(0x313)](_0x2efdf9['quote'])+_0xbc8d0b(0x8de),_0x3d52f7[_0xbc8d0b(0x5ac)](_0xbc8d0b(0x48b))[_0xbc8d0b(0x4b8)](_0xbc8d0b(0x1041),()=>{const _0x5981de=_0xbc8d0b;document[_0x5981de(0x10d6)](_0x5981de(0xdba))['length']>0x1?_0x3d52f7[_0x5981de(0x957)]():alert(_0x5981de(0x986));}),_0x3d52f7[_0xbc8d0b(0x10d6)](_0xbc8d0b(0xbbb))[_0xbc8d0b(0x494)](_0x5748d1=>{const _0x2a1f2e=_0xbc8d0b;_0x5748d1[_0x2a1f2e(0x4b8)](_0x2a1f2e(0x1041),()=>{const _0x39efb1=_0x2a1f2e,_0x5f36b3=_0x5748d1[_0x39efb1(0xaca)][_0x39efb1(0xc72)],_0x17978f=_0x3d52f7['querySelector'](_0x39efb1(0x10bb));if(_0x5f36b3&&_0x17978f)try{const _0x2c8259=JSON['parse'](_0x5f36b3);_0x17978f[_0x39efb1(0xf27)]=JSON['stringify'](_0x2c8259,null,0x2),_0x17978f['focus']();}catch(_0x176005){console['error'](_0x39efb1(0x119d),_0x176005);}});}),_0x3d52f7;}function _0x1b3aff(){const _0x18e3db=_0x241b18;if(!_0x50fd7c)return;const _0x5bfc5a=_0x50fd7c,_0x587fd3=_0x5de8b7[_0x18e3db(0x737)][_0x5de8b7[_0x18e3db(0x93d)]],_0x3dabf2=_0x587fd3[_0x18e3db(0x49e)]['find'](_0xf9f1cf=>_0xf9f1cf[_0x18e3db(0x702)]===_0x5bfc5a);if(!_0x3dabf2)return;_0x5652d7();const _0x23dab2=document[_0x18e3db(0x11e3)](_0x18e3db(0xce6)),_0x3ffb76=document['getElementById']('message-editor-container');_0x3ffb76['innerHTML']='';let _0xdb89e6;if(_0x3dabf2[_0x18e3db(0xb9)]){const _0x3358f7={'type':_0x18e3db(0x229),'target_timestamp':_0x3dabf2['quote'][_0x18e3db(0x702)],'reply_content':_0x3dabf2[_0x18e3db(0x9a5)]};_0xdb89e6=JSON[_0x18e3db(0x313)](_0x3358f7,null,0x2);}else{if(_0x3dabf2[_0x18e3db(0xa20)]&&[_0x18e3db(0x719),_0x18e3db(0xd02),_0x18e3db(0x82b),_0x18e3db(0xd71),_0x18e3db(0x67b)][_0x18e3db(0x3ad)](_0x3dabf2[_0x18e3db(0xa20)])){let _0x507765={'type':_0x3dabf2['type']};if(_0x3dabf2['type']==='voice_message')_0x507765[_0x18e3db(0x9a5)]=_0x3dabf2[_0x18e3db(0x9a5)];else{if(_0x3dabf2['type']==='ai_image')_0x507765[_0x18e3db(0x1029)]=_0x3dabf2['content'];else{if(_0x3dabf2[_0x18e3db(0xa20)]===_0x18e3db(0x82b))_0x507765[_0x18e3db(0x354)]=_0x3dabf2[_0x18e3db(0x354)],_0x507765[_0x18e3db(0x1213)]=_0x3dabf2[_0x18e3db(0x1213)];else{if(_0x3dabf2['type']===_0x18e3db(0xd71))_0x3dabf2[_0x18e3db(0x9a5)]?_0x507765[_0x18e3db(0x9a5)]=_0x3dabf2['content']:(_0x507765[_0x18e3db(0x159)]=_0x3dabf2[_0x18e3db(0x159)],_0x507765[_0x18e3db(0x1029)]=_0x3dabf2['description']);else _0x3dabf2[_0x18e3db(0xa20)]===_0x18e3db(0x67b)&&(_0x507765[_0x18e3db(0x740)]=_0x3dabf2[_0x18e3db(0x740)],_0x507765[_0x18e3db(0x1029)]=_0x3dabf2[_0x18e3db(0x1029)],_0x507765[_0x18e3db(0x101b)]=_0x3dabf2[_0x18e3db(0x101b)],_0x507765[_0x18e3db(0x9a5)]=_0x3dabf2[_0x18e3db(0x9a5)]);}}}_0xdb89e6=JSON[_0x18e3db(0x313)](_0x507765,null,0x2);}else typeof _0x3dabf2['content']===_0x18e3db(0x537)?_0xdb89e6=JSON[_0x18e3db(0x313)](_0x3dabf2[_0x18e3db(0x9a5)],null,0x2):_0xdb89e6=_0x3dabf2[_0x18e3db(0x9a5)];}const _0x17433d=_0x72868f(_0xdb89e6);_0x3ffb76[_0x18e3db(0x120c)](_0x17433d);const _0x3603de=document['getElementById'](_0x18e3db(0x10a7)),_0x138738=_0x3603de['cloneNode'](!![]);_0x3603de['parentNode'][_0x18e3db(0xeaa)](_0x138738,_0x3603de),_0x138738[_0x18e3db(0x4b8)](_0x18e3db(0x1041),()=>{const _0x580bc2=_0x18e3db,_0x5b1ead=_0x72868f();_0x3ffb76[_0x580bc2(0x120c)](_0x5b1ead),_0x5b1ead[_0x580bc2(0x5ac)]('textarea')[_0x580bc2(0xc1f)]();});const _0x340955=document[_0x18e3db(0x11e3)](_0x18e3db(0x105c)),_0x180f11=_0x340955[_0x18e3db(0x4b4)](!![]);_0x340955[_0x18e3db(0x18c)][_0x18e3db(0xeaa)](_0x180f11,_0x340955),_0x180f11[_0x18e3db(0x4b8)](_0x18e3db(0x1041),()=>{const _0x37d5d6=_0x18e3db;_0x23dab2[_0x37d5d6(0x505)][_0x37d5d6(0x957)](_0x37d5d6(0x250));});const _0xc35ca1=document[_0x18e3db(0x11e3)](_0x18e3db(0x10db)),_0x2666ff=_0xc35ca1[_0x18e3db(0x4b4)](!![]);_0xc35ca1[_0x18e3db(0x18c)][_0x18e3db(0xeaa)](_0x2666ff,_0xc35ca1),_0x2666ff[_0x18e3db(0x4b8)](_0x18e3db(0x1041),()=>{_0x289504(_0x5bfc5a);}),_0x23dab2['classList'][_0x18e3db(0x252)](_0x18e3db(0x250));}async function _0x5d74fd(){const _0x3d6a92=_0x241b18;if(!_0x50fd7c)return;const _0x4af09f=_0x5de8b7['chats'][_0x5de8b7[_0x3d6a92(0x93d)]],_0xaee5d2=_0x4af09f[_0x3d6a92(0x49e)][_0x3d6a92(0xe79)](_0x49917a=>_0x49917a[_0x3d6a92(0x702)]===_0x50fd7c);if(!_0xaee5d2)return;let _0x59c77e;if(_0xaee5d2[_0x3d6a92(0xa20)]===_0x3d6a92(0xd71))_0xaee5d2[_0x3d6a92(0x9a5)]?_0x59c77e=_0xaee5d2[_0x3d6a92(0x9a5)]:_0x59c77e='「'+(_0xaee5d2[_0x3d6a92(0x159)]||'')+'」\x0a'+(_0xaee5d2[_0x3d6a92(0x1029)]||'');else typeof _0xaee5d2['content']==='object'?_0x59c77e=JSON[_0x3d6a92(0x313)](_0xaee5d2[_0x3d6a92(0x9a5)]):_0x59c77e=String(_0xaee5d2['content']);try{await navigator['clipboard'][_0x3d6a92(0x94c)](_0x59c77e),await _0x2fb06(_0x3d6a92(0x109c),_0x3d6a92(0x1a9));}catch(_0x1aac22){await _0x2fb06('复制失败',_0x3d6a92(0x378));}_0x5652d7();}function _0x59aeab(_0x42bad3){const _0x1f0fb4=_0x241b18,_0x2b8fee=_0x42bad3[_0x1f0fb4(0xeb7)]();if(_0x2b8fee[_0x1f0fb4(0xb6c)]('{')&&_0x2b8fee[_0x1f0fb4(0x771)]('}'))try{const _0x125162=JSON['parse'](_0x2b8fee);if(_0x125162[_0x1f0fb4(0xa20)])return _0x125162;}catch(_0x367cc2){}if(_0x9f9ac4[_0x1f0fb4(0x1043)](_0x2b8fee))return{'type':'sticker','content':_0x2b8fee};return{'type':_0x1f0fb4(0x1197),'content':_0x2b8fee};}async function _0x289504(_0x1fb2c4,_0x419c4b=null){const _0x2aa273=_0x241b18;if(!_0x1fb2c4)return;const _0x5bdab7=_0x5de8b7[_0x2aa273(0x737)][_0x5de8b7[_0x2aa273(0x93d)]],_0xc0203e=_0x5bdab7[_0x2aa273(0x49e)][_0x2aa273(0x901)](_0x1abc70=>_0x1abc70[_0x2aa273(0x702)]===_0x1fb2c4);if(_0xc0203e===-0x1)return;const _0x2a8276=_0x5bdab7[_0x2aa273(0x49e)][_0xc0203e];let _0x5e8d54=[];const _0x2ba26f=_0x419c4b!==null?[_0x419c4b]:Array['from'](document['querySelectorAll'](_0x2aa273(0x85c)))['map'](_0x40d962=>_0x40d962[_0x2aa273(0xf27)]);for(const _0x1ce226 of _0x2ba26f){if(!_0x1ce226[_0x2aa273(0xeb7)]())continue;const _0xafca72=_0x59aeab(_0x1ce226[_0x2aa273(0xeb7)]()),_0x5d65c5={'role':_0x2a8276[_0x2aa273(0xba4)],'senderName':_0x2a8276[_0x2aa273(0x768)],'timestamp':_0x2a8276[_0x2aa273(0x702)]};switch(_0xafca72[_0x2aa273(0xa20)]){case _0x2aa273(0x1197):_0x5d65c5[_0x2aa273(0xa20)]=_0x2aa273(0x1197),_0x5d65c5[_0x2aa273(0x9a5)]=_0xafca72[_0x2aa273(0x9a5)];break;case'offline_text':_0x5d65c5[_0x2aa273(0xa20)]=_0x2aa273(0xd71);_0xafca72['content']?_0x5d65c5['content']=_0xafca72['content']:(_0x5d65c5[_0x2aa273(0x159)]=_0xafca72[_0x2aa273(0x159)],_0x5d65c5[_0x2aa273(0x1029)]=_0xafca72[_0x2aa273(0x1029)]);break;case _0x2aa273(0x229):_0x5d65c5[_0x2aa273(0xa20)]=_0x2aa273(0x229),_0x5d65c5[_0x2aa273(0x9a5)]=_0xafca72['reply_content'];const _0x2f54d4=_0x5bdab7['history'][_0x2aa273(0xe79)](_0x1f4bc8=>_0x1f4bc8[_0x2aa273(0x702)]===_0xafca72[_0x2aa273(0x47a)]);if(_0x2f54d4){let _0x1f8578=_0x2f54d4[_0x2aa273(0x768)];_0x2f54d4[_0x2aa273(0xba4)]===_0x2aa273(0x21c)&&(_0x1f8578=_0x5de8b7[_0x2aa273(0x1c5)][_0x2aa273(0xa33)]||_0x2aa273(0x833)),_0x5d65c5[_0x2aa273(0xb9)]={'timestamp':_0xafca72[_0x2aa273(0x47a)],'senderName':_0x1f8578,'content':String(_0x2f54d4[_0x2aa273(0x9a5)]||'')};}else _0x5d65c5[_0x2aa273(0xb9)]={'timestamp':_0xafca72['target_timestamp'],'senderName':'未知用户','content':'原始消息已删除或不存在'};break;case _0x2aa273(0x719):case _0x2aa273(0xd02):case'user_photo':_0x5d65c5[_0x2aa273(0xa20)]=_0xafca72[_0x2aa273(0xa20)],_0x5d65c5[_0x2aa273(0x9a5)]=_0xafca72[_0x2aa273(0x9a5)]||_0xafca72[_0x2aa273(0x1029)];if(_0xafca72[_0x2aa273(0xb36)])_0x5d65c5[_0x2aa273(0xb36)]=_0xafca72['meaning'];break;case _0x2aa273(0x87b):{_0x5d65c5[_0x2aa273(0xa20)]=_0x2aa273(0x87b);let _0x4b21d2=![];if(_0xafca72['meaning']){const _0x26d2b9=_0x5de8b7[_0x2aa273(0xa67)][_0x2aa273(0xe79)](_0x577dba=>_0x577dba['name']===_0xafca72[_0x2aa273(0xb36)]);_0x26d2b9?(_0x5d65c5['content']=_0x26d2b9[_0x2aa273(0x10ac)],_0x5d65c5[_0x2aa273(0xb36)]=_0x26d2b9[_0x2aa273(0x278)],console[_0x2aa273(0x84b)](_0x2aa273(0x45b)),_0x4b21d2=!![]):(_0x5d65c5[_0x2aa273(0xa20)]=_0x2aa273(0x1197),_0x5d65c5[_0x2aa273(0x9a5)]=_0x2aa273(0x119f)+_0xafca72[_0x2aa273(0xb36)]+']',console[_0x2aa273(0x6b0)](_0x2aa273(0x689),_0xafca72[_0x2aa273(0xb36)]),_0x4b21d2=!![]);}if(!_0x4b21d2&&_0xafca72[_0x2aa273(0x10ac)]){_0x5d65c5['content']=_0xafca72[_0x2aa273(0x10ac)];const _0x4083ee=_0x5de8b7[_0x2aa273(0xa67)][_0x2aa273(0xe79)](_0x2d2266=>_0x2d2266[_0x2aa273(0x10ac)]===_0xafca72[_0x2aa273(0x10ac)]);if(_0xafca72[_0x2aa273(0xb36)]&&(!_0x4083ee||_0x4083ee['name']===_0xafca72['meaning']))_0x5d65c5['meaning']=_0xafca72['meaning'];else _0x4083ee?_0x5d65c5[_0x2aa273(0xb36)]=_0x4083ee[_0x2aa273(0x278)]:_0x5d65c5[_0x2aa273(0xb36)]=_0x2aa273(0x10df);console['log'](_0x2aa273(0x11fa),_0x5d65c5[_0x2aa273(0xb36)]),_0x4b21d2=!![];}if(!_0x4b21d2&&_0xafca72[_0x2aa273(0x9a5)]&&typeof _0xafca72[_0x2aa273(0x9a5)]===_0x2aa273(0x10d7)&&_0x9f9ac4[_0x2aa273(0x1043)](_0xafca72[_0x2aa273(0x9a5)])){_0x5d65c5[_0x2aa273(0x9a5)]=_0xafca72['content'];const _0xcb6918=_0x5de8b7['userStickers'][_0x2aa273(0xe79)](_0x28a521=>_0x28a521['url']===_0xafca72[_0x2aa273(0x9a5)]);_0x5d65c5[_0x2aa273(0xb36)]=_0xcb6918?_0xcb6918['name']:_0x2aa273(0x10df),console[_0x2aa273(0x84b)](_0x2aa273(0x46d),_0x5d65c5['meaning']),_0x4b21d2=!![];}if(!_0x4b21d2){console[_0x2aa273(0x1c1)](_0x2aa273(0x5f4),_0xafca72);continue;}break;}case _0x2aa273(0x82b):_0x5d65c5[_0x2aa273(0xa20)]=_0x2aa273(0x82b),_0x5d65c5['amount']=_0xafca72[_0x2aa273(0x354)],_0x5d65c5[_0x2aa273(0x1213)]=_0xafca72['note'];break;case _0x2aa273(0x67b):_0x5d65c5[_0x2aa273(0xa20)]='share_link',_0x5d65c5[_0x2aa273(0x740)]=_0xafca72[_0x2aa273(0x740)],_0x5d65c5[_0x2aa273(0x1029)]=_0xafca72[_0x2aa273(0x1029)],_0x5d65c5[_0x2aa273(0x101b)]=_0xafca72[_0x2aa273(0x101b)],_0x5d65c5[_0x2aa273(0x9a5)]=_0xafca72['content'];break;default:Object[_0x2aa273(0x6c0)](_0x5d65c5,_0xafca72);break;}_0x5e8d54[_0x2aa273(0xf5)](_0x5d65c5);}if(_0x5e8d54[_0x2aa273(0x594)]===0x0){document['getElementById'](_0x2aa273(0xce6))[_0x2aa273(0x505)][_0x2aa273(0x957)]('visible');return;}_0x5bdab7[_0x2aa273(0x49e)][_0x2aa273(0xfd0)](_0xc0203e,0x1,..._0x5e8d54);let _0x5bb976=_0x1fb2c4;for(let _0x2acd72=_0xc0203e;_0x2acd72<_0x5bdab7[_0x2aa273(0x49e)]['length'];_0x2acd72++){_0x5bdab7[_0x2aa273(0x49e)][_0x2acd72]['timestamp']=_0x5bb976,_0x5bb976++;}await _0x2e83f8[_0x2aa273(0x737)][_0x2aa273(0xe3c)](_0x5bdab7),document[_0x2aa273(0x11e3)](_0x2aa273(0xce6))['classList'][_0x2aa273(0x957)](_0x2aa273(0x250)),_0x544ab5(_0x5de8b7[_0x2aa273(0x93d)]),await _0x2fb06('成功','消息已更新！');}function _0x2ea74f(_0x5db1f8){const _0x598970=_0x241b18;_0x31f023=_0x5db1f8,document[_0x598970(0x11e3)](_0x598970(0x6e8))[_0x598970(0x505)][_0x598970(0x252)](_0x598970(0x250));}function _0x231719(){const _0xd3c9a9=_0x241b18;document[_0xd3c9a9(0x11e3)](_0xd3c9a9(0x6e8))[_0xd3c9a9(0x505)][_0xd3c9a9(0x957)](_0xd3c9a9(0x250)),_0x31f023=null;}async function _0x2bc905(){const _0x1d739c=_0x241b18;if(!_0x31f023)return;const _0x45bb97=_0x31f023,_0x3193d4=await _0x2e83f8[_0x1d739c(0x1218)][_0x1d739c(0x1289)](_0x45bb97);if(!_0x3193d4)return;_0x231719();let _0x6cb617;if(_0x3193d4['type']===_0x1d739c(0xc40))_0x6cb617=_0x3193d4[_0x1d739c(0x9a5)];else{const _0x55cbfd={'type':_0x3193d4[_0x1d739c(0xa20)],'publicText':_0x3193d4[_0x1d739c(0x12aa)]||''};if(_0x3193d4[_0x1d739c(0xa20)]==='image_post')_0x55cbfd[_0x1d739c(0xf44)]=_0x3193d4[_0x1d739c(0xf44)],_0x55cbfd['imageDescription']=_0x3193d4[_0x1d739c(0x6b6)];else _0x3193d4[_0x1d739c(0xa20)]===_0x1d739c(0x887)&&(_0x55cbfd[_0x1d739c(0x6f7)]=_0x3193d4[_0x1d739c(0x6f7)]);_0x6cb617=JSON[_0x1d739c(0x313)](_0x55cbfd,null,0x2);}const _0x1954c0={'shuoshuo':_0x1d739c(0x1186),'image':{'type':_0x1d739c(0x332),'publicText':'','imageUrl':_0x1d739c(0x959),'imageDescription':''},'text_image':{'type':_0x1d739c(0x887),'publicText':'','hiddenContent':''}},_0x21a131=_0x1d739c(0x985)+JSON[_0x1d739c(0x313)](_0x1954c0['image'])+_0x1d739c(0xd95)+JSON[_0x1d739c(0x313)](_0x1954c0['text_image'])+'\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4777a6=await _0x231a5a(_0x1d739c(0x76a),'在此修改内容...',_0x6cb617,_0x1d739c(0x10bb),_0x21a131);setTimeout(()=>{const _0x3adba7=_0x1d739c,_0x587f1a=document['querySelector'](_0x3adba7(0x258));_0x587f1a&&_0x587f1a[_0x3adba7(0x4b8)](_0x3adba7(0x1041),()=>{const _0x3d479f=_0x3adba7,_0x15139d=document[_0x3d479f(0x11e3)](_0x3d479f(0x5bb));_0x15139d['value']=_0x1954c0[_0x3d479f(0xc40)],_0x15139d[_0x3d479f(0xc1f)]();});},0x64),_0x4777a6!==null&&await _0x1b0ae4(_0x45bb97,_0x4777a6);}async function _0x1b0ae4(_0x2c40da,_0x4cf268){const _0x2bdbf4=_0x241b18,_0x14efc3=await _0x2e83f8['qzonePosts'][_0x2bdbf4(0x1289)](_0x2c40da);if(!_0x14efc3)return;const _0x31325c=_0x4cf268[_0x2bdbf4(0xeb7)]();try{const _0x44a3e4=JSON[_0x2bdbf4(0xb0c)](_0x31325c);_0x14efc3[_0x2bdbf4(0xa20)]=_0x44a3e4['type']||'image_post',_0x14efc3[_0x2bdbf4(0x12aa)]=_0x44a3e4[_0x2bdbf4(0x12aa)]||'',_0x14efc3['imageUrl']=_0x44a3e4[_0x2bdbf4(0xf44)]||'',_0x14efc3[_0x2bdbf4(0x6b6)]=_0x44a3e4[_0x2bdbf4(0x6b6)]||'',_0x14efc3[_0x2bdbf4(0x6f7)]=_0x44a3e4['hiddenContent']||'',_0x14efc3[_0x2bdbf4(0x9a5)]='';}catch(_0x21f329){_0x14efc3[_0x2bdbf4(0xa20)]=_0x2bdbf4(0xc40),_0x14efc3[_0x2bdbf4(0x9a5)]=_0x31325c,_0x14efc3[_0x2bdbf4(0x12aa)]='',_0x14efc3[_0x2bdbf4(0xf44)]='',_0x14efc3[_0x2bdbf4(0x6b6)]='',_0x14efc3[_0x2bdbf4(0x6f7)]='';}await _0x2e83f8['qzonePosts'][_0x2bdbf4(0xe3c)](_0x14efc3),await _0xae9c28(),await _0x2fb06('成功',_0x2bdbf4(0x410));}async function _0x30e6cc(){const _0x544da4=_0x241b18;if(!_0x31f023)return;const _0x508658=await _0x2e83f8[_0x544da4(0x1218)][_0x544da4(0x1289)](_0x31f023);if(!_0x508658)return;let _0xc28df3=_0x508658['content']||_0x508658[_0x544da4(0x12aa)]||_0x508658[_0x544da4(0x6f7)]||_0x508658[_0x544da4(0x6b6)]||_0x544da4(0x81b);try{await navigator[_0x544da4(0xd41)]['writeText'](_0xc28df3),await _0x2fb06(_0x544da4(0x109c),_0x544da4(0x70b));}catch(_0x5d861f){await _0x2fb06(_0x544da4(0x438),_0x544da4(0x378));}_0x231719();}let _0x1494d8=new Set();async function _0x39aa6a(){const _0x1062ce=_0x241b18,_0x59ecb6=await _0x16a8e1(_0x1062ce(0x758),[{'text':'创建普通群聊\x20(我参与)','value':_0x1062ce(0x10f5)},{'text':_0x1062ce(0xbfa),'value':_0x1062ce(0x574)}]);if(_0x59ecb6===_0x1062ce(0x10f5)){_0x1494d8[_0x1062ce(0x7ab)]();const _0x271567=document[_0x1062ce(0x11e3)](_0x1062ce(0x37e)),_0x139af7=_0x271567[_0x1062ce(0x4b4)](!![]);_0x271567[_0x1062ce(0x18c)][_0x1062ce(0xeaa)](_0x139af7,_0x271567),_0x139af7[_0x1062ce(0x4b8)](_0x1062ce(0x1041),_0x5e4eab),await _0x52b045(),_0x4e7698(_0x1062ce(0x11b8));}else _0x59ecb6===_0x1062ce(0x574)&&_0x495ff2();}async function _0x495ff2(){const _0x5c302b=_0x241b18;_0x1494d8[_0x5c302b(0x7ab)]();const _0x3e6be2=document[_0x5c302b(0x11e3)](_0x5c302b(0x37e)),_0x3852f6=_0x3e6be2[_0x5c302b(0x4b4)](!![]);_0x3e6be2[_0x5c302b(0x18c)][_0x5c302b(0xeaa)](_0x3852f6,_0x3e6be2),_0x3852f6[_0x5c302b(0x4b8)](_0x5c302b(0x1041),_0x285e69),await _0x16327c(),_0x4e7698(_0x5c302b(0x11b8));}async function _0x16327c(){const _0x35ed05=_0x241b18,_0x206a86=document['getElementById'](_0x35ed05(0x119a));_0x206a86[_0x35ed05(0x595)]='';const _0xedebfb=Object[_0x35ed05(0x4ca)](_0x5de8b7[_0x35ed05(0x737)])['filter'](_0x39ac55=>!_0x39ac55[_0x35ed05(0x1244)]),_0x32b73f=await _0x2e83f8[_0x35ed05(0xf00)][_0x35ed05(0x508)]();if(_0xedebfb['length']===0x0&&_0x32b73f[_0x35ed05(0x594)]===0x0){_0x206a86[_0x35ed05(0x595)]=_0x35ed05(0x121d);return;}_0xedebfb[_0x35ed05(0x494)](_0x29cbcb=>{const _0x77e9f7=_0x35ed05,_0x4e7591=document[_0x77e9f7(0x383)]('div');_0x4e7591['className']='contact-picker-item',_0x4e7591[_0x77e9f7(0xaca)][_0x77e9f7(0xfb4)]=_0x29cbcb['id'],_0x4e7591[_0x77e9f7(0x595)]=_0x77e9f7(0x116f)+(_0x29cbcb[_0x77e9f7(0x761)]['aiAvatar']||_0x3d2e44)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x29cbcb['name']+_0x77e9f7(0xa4e),_0x206a86[_0x77e9f7(0x120c)](_0x4e7591);}),_0x32b73f['forEach'](_0x4aa769=>{const _0x41ae54=_0x35ed05,_0x3420b0=document[_0x41ae54(0x383)](_0x41ae54(0x1285));_0x3420b0['className']=_0x41ae54(0x9b3),_0x3420b0['dataset'][_0x41ae54(0xfb4)]=_0x4aa769['id'],_0x3420b0['dataset'][_0x41ae54(0x1171)]=_0x41ae54(0x126d),_0x3420b0[_0x41ae54(0x595)]=_0x41ae54(0x116f)+(_0x4aa769[_0x41ae54(0x525)]||_0x4d9574)+_0x41ae54(0x655)+_0x4aa769[_0x41ae54(0x278)]+'\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x206a86[_0x41ae54(0x120c)](_0x3420b0);}),_0x1ce777();}async function _0x285e69(){const _0x45b182=_0x241b18;if(_0x1494d8[_0x45b182(0x1159)]<0x2){alert(_0x45b182(0xcd7));return;}const _0x5d1d73=await _0x231a5a(_0x45b182(0x85a),'请输入群聊的名字',_0x45b182(0x5a8));if(!_0x5d1d73||!_0x5d1d73[_0x45b182(0xeb7)]())return;const _0x2867d6='group_'+Date[_0x45b182(0x1182)](),_0x4e26b2=[],_0x8ec4bc=await _0x2e83f8[_0x45b182(0xf00)][_0x45b182(0x508)]();for(const _0x389d5d of _0x1494d8){const _0x3b6f7a=document[_0x45b182(0x5ac)](_0x45b182(0x6d6)+_0x389d5d+'\x22]')['dataset'][_0x45b182(0x1171)]===_0x45b182(0x126d);if(_0x3b6f7a){const _0x3ac096=_0x8ec4bc[_0x45b182(0xe79)](_0x16c34b=>_0x16c34b['id']===parseInt(_0x389d5d));_0x3ac096&&_0x4e26b2['push']({'id':_0x45b182(0x8b8)+_0x3ac096['id'],'originalName':_0x3ac096[_0x45b182(0x278)],'groupNickname':_0x3ac096[_0x45b182(0x278)],'persona':_0x3ac096[_0x45b182(0x701)],'avatar':_0x3ac096[_0x45b182(0x525)]||_0x4d9574,'isNpc':!![]});}else{const _0x5691a8=_0x5de8b7['chats'][_0x389d5d];_0x5691a8&&_0x4e26b2[_0x45b182(0xf5)]({'id':_0x389d5d,'originalName':_0x5691a8[_0x45b182(0x697)],'groupNickname':_0x5691a8['name'],'persona':_0x5691a8['settings']['aiPersona'],'avatar':_0x5691a8[_0x45b182(0x761)][_0x45b182(0x5e0)]||_0x3d2e44,'isNpc':![]});}}const _0x3d2f70={'id':_0x2867d6,'name':_0x5d1d73['trim'](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x4e26b2,'settings':{'maxMemory':0xa,'groupAvatar':_0x1f1b42,'background':'','theme':_0x45b182(0xd3),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':_0x45b182(0xf72),'content':_0x45b182(0x1c9),'timestamp':Date[_0x45b182(0x1182)](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x5de8b7[_0x45b182(0x737)][_0x2867d6]=_0x3d2f70,await _0x2e83f8[_0x45b182(0x737)][_0x45b182(0xe3c)](_0x3d2f70),await _0x5ee219(),_0x4e7698(_0x45b182(0xf1e)),_0x6cac66(_0x2867d6);}async function _0x52b045(){const _0x1d4c6c=_0x241b18,_0x103f81=document[_0x1d4c6c(0x11e3)](_0x1d4c6c(0x119a));_0x103f81['innerHTML']='';const _0x4892d3=Object[_0x1d4c6c(0x4ca)](_0x5de8b7[_0x1d4c6c(0x737)])[_0x1d4c6c(0x138)](_0x1c1eab=>!_0x1c1eab[_0x1d4c6c(0x1244)]),_0x2cb67c=await _0x2e83f8[_0x1d4c6c(0xf00)][_0x1d4c6c(0x508)]();if(_0x4892d3[_0x1d4c6c(0x594)]===0x0&&_0x2cb67c[_0x1d4c6c(0x594)]===0x0){_0x103f81[_0x1d4c6c(0x595)]=_0x1d4c6c(0x315);return;}_0x4892d3[_0x1d4c6c(0x494)](_0x2ae53e=>{const _0xd60958=_0x1d4c6c,_0x4b5ebf=document[_0xd60958(0x383)](_0xd60958(0x1285));_0x4b5ebf['className']='contact-picker-item',_0x4b5ebf[_0xd60958(0xaca)][_0xd60958(0xfb4)]=_0x2ae53e['id'],_0x4b5ebf['innerHTML']=_0xd60958(0x116f)+(_0x2ae53e[_0xd60958(0x761)]['aiAvatar']||_0x3d2e44)+_0xd60958(0x655)+_0x2ae53e[_0xd60958(0x278)]+_0xd60958(0xa4e),_0x103f81[_0xd60958(0x120c)](_0x4b5ebf);}),_0x2cb67c['forEach'](_0x5c1968=>{const _0x4b0572=_0x1d4c6c,_0x1a4cd0=document['createElement'](_0x4b0572(0x1285));_0x1a4cd0[_0x4b0572(0x3db)]='contact-picker-item',_0x1a4cd0[_0x4b0572(0xaca)][_0x4b0572(0xfb4)]=_0x4b0572(0x8b8)+_0x5c1968['id'],_0x1a4cd0[_0x4b0572(0x595)]=_0x4b0572(0x116f)+(_0x5c1968[_0x4b0572(0x525)]||_0x4d9574)+_0x4b0572(0x655)+_0x5c1968['name']+_0x4b0572(0x575),_0x103f81[_0x4b0572(0x120c)](_0x1a4cd0);}),_0x1ce777();}function _0x1ce777(){const _0x14d60d=_0x241b18,_0x570f6c=document[_0x14d60d(0x11e3)](_0x14d60d(0x37e));_0x570f6c[_0x14d60d(0x300)]=_0x14d60d(0xe03)+_0x1494d8[_0x14d60d(0x1159)]+')',_0x570f6c[_0x14d60d(0xe5c)]=_0x1494d8[_0x14d60d(0x1159)]<0x2;}async function _0x5e4eab(){const _0x3084a9=_0x241b18;if(_0x1494d8['size']<0x2){alert(_0x3084a9(0xeb2));return;}const _0x6a69ae=await _0x231a5a('设置群名',_0x3084a9(0xffd),_0x3084a9(0x6d9));if(!_0x6a69ae||!_0x6a69ae[_0x3084a9(0xeb7)]())return;const _0x56333b=_0x3084a9(0x3e3)+Date[_0x3084a9(0x1182)](),_0x154459=[],_0xd3cbac=await _0x2e83f8['npcs'][_0x3084a9(0x508)]();for(const _0xe7e156 of _0x1494d8){if(_0xe7e156['startsWith'](_0x3084a9(0x8b8))){const _0x579233=parseInt(_0xe7e156['replace']('npc_','')),_0x4d8ab5=_0xd3cbac[_0x3084a9(0xe79)](_0x17b70c=>_0x17b70c['id']===_0x579233);_0x4d8ab5&&_0x154459[_0x3084a9(0xf5)]({'id':_0xe7e156,'originalName':_0x4d8ab5[_0x3084a9(0x278)],'groupNickname':_0x4d8ab5[_0x3084a9(0x278)],'persona':_0x4d8ab5['persona'],'avatar':_0x4d8ab5[_0x3084a9(0x525)]||_0x4d9574,'isNpc':!![]});}else{const _0x1ddaae=_0x5de8b7[_0x3084a9(0x737)][_0xe7e156];_0x1ddaae&&_0x154459[_0x3084a9(0xf5)]({'id':_0xe7e156,'originalName':_0x1ddaae[_0x3084a9(0x697)],'groupNickname':_0x1ddaae[_0x3084a9(0x278)],'persona':_0x1ddaae[_0x3084a9(0x761)][_0x3084a9(0x8d5)],'avatar':_0x1ddaae[_0x3084a9(0x761)][_0x3084a9(0x5e0)]||_0x3d2e44,'isNpc':![]});}}const _0x8e3306={'id':_0x56333b,'name':_0x6a69ae[_0x3084a9(0xeb7)](),'isGroup':!![],'members':_0x154459,'settings':{'myPersona':_0x3084a9(0x85e),'myNickname':'我','maxMemory':0xa,'groupAvatar':_0x1f1b42,'myAvatar':_0x30449f,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x5de8b7['chats'][_0x56333b]=_0x8e3306,await _0x2e83f8['chats'][_0x3084a9(0xe3c)](_0x8e3306),await _0x5ee219(),_0x4e7698(_0x3084a9(0xf1e)),_0x6cac66(_0x56333b);}function _0x320eea(){const _0x555ff9=_0x241b18;if(!_0x5de8b7[_0x555ff9(0x93d)]||!_0x5de8b7['chats'][_0x5de8b7[_0x555ff9(0x93d)]]['isGroup'])return;_0x51043b(),_0x4e7698(_0x555ff9(0x8ad));}function _0x51043b(){const _0x3afa04=_0x241b18,_0x3b7c44=document['getElementById'](_0x3afa04(0xffc)),_0x45c3e9=_0x5de8b7[_0x3afa04(0x737)][_0x5de8b7[_0x3afa04(0x93d)]];_0x3b7c44[_0x3afa04(0x595)]='',_0x45c3e9[_0x3afa04(0x2b3)]['forEach'](_0x445673=>{const _0x709214=_0x3afa04,_0x18911b=document['createElement'](_0x709214(0x1285));_0x18911b[_0x709214(0x3db)]='member-management-item',_0x18911b[_0x709214(0x595)]=_0x709214(0xee5)+_0x445673['avatar']+_0x709214(0x6d7)+_0x445673[_0x709214(0xc8f)]+_0x709214(0x6a7)+_0x445673['id']+_0x709214(0x979),_0x3b7c44[_0x709214(0x120c)](_0x18911b);});}async function _0xd4ff0b(_0x3de46b){const _0x169e35=_0x241b18,_0x17ff6d=_0x5de8b7['chats'][_0x5de8b7[_0x169e35(0x93d)]],_0x13496c=_0x17ff6d[_0x169e35(0x2b3)][_0x169e35(0x901)](_0x4e0e74=>_0x4e0e74['id']===_0x3de46b);if(_0x13496c===-0x1)return;if(_0x17ff6d[_0x169e35(0x2b3)][_0x169e35(0x594)]<=0x2){alert('群聊人数不能少于2人。');return;}const _0x72bdfe=_0x17ff6d[_0x169e35(0x2b3)][_0x13496c][_0x169e35(0xc8f)],_0x4a5191=await _0x58fd60(_0x169e35(0x3d0),_0x169e35(0xbd7)+_0x72bdfe+_0x169e35(0x60a),{'confirmButtonClass':_0x169e35(0x8a6)});_0x4a5191&&(_0x17ff6d[_0x169e35(0x2b3)][_0x169e35(0xfd0)](_0x13496c,0x1),await _0x2e83f8[_0x169e35(0x737)][_0x169e35(0xe3c)](_0x17ff6d),_0x51043b(),document[_0x169e35(0x11e3)](_0x169e35(0x4bb))['click']());}async function _0x472241(){const _0x5a474e=_0x241b18,_0xb6e59=document[_0x5a474e(0x11e3)]('confirm-contact-picker-btn'),_0x4f0ef8=_0xb6e59[_0x5a474e(0x4b4)](!![]);_0xb6e59[_0x5a474e(0x18c)]['replaceChild'](_0x4f0ef8,_0xb6e59),_0x4f0ef8[_0x5a474e(0x4b8)](_0x5a474e(0x1041),_0x39081d),await _0x14033c(),_0x4e7698(_0x5a474e(0x11b8));}async function _0x14033c(){const _0x34dffb=_0x241b18,_0xbcff83=document['getElementById'](_0x34dffb(0x119a));_0xbcff83[_0x34dffb(0x595)]='',_0x1494d8[_0x34dffb(0x7ab)]();const _0x4c653b=_0x5de8b7[_0x34dffb(0x737)][_0x5de8b7['activeChatId']],_0x100310=new Set(_0x4c653b[_0x34dffb(0x2b3)][_0x34dffb(0x796)](_0x4e0622=>_0x4e0622['id'])),_0x305734=Object[_0x34dffb(0x4ca)](_0x5de8b7[_0x34dffb(0x737)])[_0x34dffb(0x138)](_0x431f46=>!_0x431f46[_0x34dffb(0x1244)]&&!_0x100310[_0x34dffb(0x72a)](_0x431f46['id'])),_0x5b8345=(await _0x2e83f8[_0x34dffb(0xf00)]['toArray']())['filter'](_0x270611=>!_0x100310['has'](_0x34dffb(0x8b8)+_0x270611['id']));_0x305734[_0x34dffb(0x594)]===0x0&&_0x5b8345[_0x34dffb(0x594)]===0x0?(_0xbcff83['innerHTML']='<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>',document['getElementById'](_0x34dffb(0x37e))[_0x34dffb(0x794)][_0x34dffb(0x33d)]=_0x34dffb(0x379)):(document[_0x34dffb(0x11e3)](_0x34dffb(0x37e))[_0x34dffb(0x794)][_0x34dffb(0x33d)]='block',_0x305734[_0x34dffb(0x494)](_0x343e85=>{const _0x13897a=_0x34dffb,_0x2835ef=document[_0x13897a(0x383)]('div');_0x2835ef[_0x13897a(0x3db)]='contact-picker-item',_0x2835ef['dataset'][_0x13897a(0xfb4)]=_0x343e85['id'],_0x2835ef[_0x13897a(0xaca)][_0x13897a(0x117f)]=_0x13897a(0x12e7),_0x2835ef['innerHTML']=_0x13897a(0x157)+(_0x343e85[_0x13897a(0x761)][_0x13897a(0x5e0)]||_0x3d2e44)+_0x13897a(0xf4e)+_0x343e85['name']+_0x13897a(0xb74),_0xbcff83[_0x13897a(0x120c)](_0x2835ef);}),_0x5b8345['forEach'](_0xe77a2a=>{const _0x1f6dfb=_0x34dffb,_0x4613b4=document[_0x1f6dfb(0x383)](_0x1f6dfb(0x1285));_0x4613b4[_0x1f6dfb(0x3db)]=_0x1f6dfb(0x9b3),_0x4613b4['dataset']['contactId']=_0x1f6dfb(0x8b8)+_0xe77a2a['id'],_0x4613b4[_0x1f6dfb(0xaca)][_0x1f6dfb(0x117f)]=_0x1f6dfb(0xb91),_0x4613b4[_0x1f6dfb(0xaca)][_0x1f6dfb(0xd29)]=_0xe77a2a['id'],_0x4613b4['innerHTML']=_0x1f6dfb(0x157)+(_0xe77a2a['avatar']||_0x4d9574)+_0x1f6dfb(0xf4e)+_0xe77a2a['name']+'\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xbcff83['appendChild'](_0x4613b4);})),_0x1ce777();}async function _0x39081d(){const _0x43ac99=_0x241b18;if(_0x1494d8['size']===0x0){alert(_0x43ac99(0x687));return;}const _0x4c7a97=_0x5de8b7[_0x43ac99(0x737)][_0x5de8b7[_0x43ac99(0x93d)]],_0x33874b=await _0x2e83f8[_0x43ac99(0xf00)][_0x43ac99(0x508)]();for(const _0x25eea1 of _0x1494d8){const _0x2beeb8=document['querySelector'](_0x43ac99(0x6d6)+_0x25eea1+'\x22]');if(!_0x2beeb8)continue;const _0x4d7efd=_0x2beeb8[_0x43ac99(0xaca)]['contactType'];if(_0x4d7efd===_0x43ac99(0x12e7)){const _0x3fd9a4=_0x5de8b7['chats'][_0x25eea1];_0x3fd9a4&&_0x4c7a97[_0x43ac99(0x2b3)][_0x43ac99(0xf5)]({'id':_0x25eea1,'originalName':_0x3fd9a4[_0x43ac99(0x697)],'groupNickname':_0x3fd9a4[_0x43ac99(0x278)],'persona':_0x3fd9a4[_0x43ac99(0x761)][_0x43ac99(0x8d5)],'avatar':_0x3fd9a4[_0x43ac99(0x761)][_0x43ac99(0x5e0)]||_0x3d2e44,'isNpc':![]});}else{if(_0x4d7efd===_0x43ac99(0xb91)){const _0x30243a=parseInt(_0x2beeb8[_0x43ac99(0xaca)][_0x43ac99(0xd29)]),_0x357616=_0x33874b[_0x43ac99(0xe79)](_0x3a1a9a=>_0x3a1a9a['id']===_0x30243a);_0x357616&&_0x4c7a97['members'][_0x43ac99(0xf5)]({'id':_0x43ac99(0x8b8)+_0x30243a,'originalName':_0x357616['name'],'groupNickname':_0x357616[_0x43ac99(0x278)],'persona':_0x357616[_0x43ac99(0x701)],'avatar':_0x357616['avatar']||_0x4d9574,'isNpc':!![]});}}}await _0x2e83f8['chats'][_0x43ac99(0xe3c)](_0x4c7a97),_0x320eea();}function _0x3c1151(){_0x176587=!![],_0x5ba41b(null);}function _0x51cf5d(_0x558233,_0x31a218){const _0x104be8=setInterval(()=>{const _0xf82228=_0x10a9,_0x2eb2c6=Date[_0xf82228(0x1182)](),_0x2d7736=_0x31a218-_0x2eb2c6;if(_0x2d7736<0x0){clearInterval(_0x104be8),_0x558233[_0xf82228(0x595)]=_0xf82228(0xa76);return;}const _0x2719cc=Math['floor'](_0x2d7736%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0xe020eb=Math[_0xf82228(0xfb1)](_0x2d7736%(0x3e8*0x3c)/0x3e8),_0x48c7cc=String(_0x2719cc)[_0xf82228(0xae4)](0x2,'0'),_0x4461cf=String(_0xe020eb)[_0xf82228(0xae4)](0x2,'0');_0x558233['innerHTML']=_0xf82228(0x11e8)+_0x48c7cc['charAt'](0x0)+_0xf82228(0x312)+_0x48c7cc[_0xf82228(0xedc)](0x1)+_0xf82228(0x6e7)+_0x4461cf[_0xf82228(0xedc)](0x0)+'</span><span>'+_0x4461cf['charAt'](0x1)+_0xf82228(0x4a3);},0x3e8);return _0x104be8;}function _0x27f384(){for(const _0x223b1d in _0x2c1bf7){clearInterval(_0x2c1bf7[_0x223b1d]);}_0x2c1bf7={};}async function _0x56fe91(_0x366adc){const _0x569e42=_0x241b18,_0x3a9988=_0x5de8b7[_0x569e42(0x737)][_0x5de8b7[_0x569e42(0x93d)]];if(!_0x3a9988)return;const _0x9812d2=_0x3a9988[_0x569e42(0x49e)]['find'](_0x188e69=>_0x188e69[_0x569e42(0x702)]===_0x366adc);if(!_0x9812d2||![_0x569e42(0x123b),_0x569e42(0x57b)]['includes'](_0x9812d2[_0x569e42(0xa20)])){console[_0x569e42(0x1c1)]('showWaimaiDetails:\x20找不到消息或消息类型不正确',_0x366adc);return;}let _0x33c2ac='';if(_0x9812d2[_0x569e42(0xa20)]==='waimai_request'){let _0x5736e0;switch(_0x9812d2[_0x569e42(0x739)]){case _0x569e42(0xa42):const _0x5cfa97=_0x9812d2[_0x569e42(0xad8)]||'对方',_0x3e3955=_0xd9d60a(_0x3a9988,_0x5cfa97);_0x5736e0='由\x20'+_0x3e3955+_0x569e42(0x8a9);break;case'rejected':_0x5736e0=_0x569e42(0xa62);break;default:_0x5736e0=_0x569e42(0x114e);break;}_0x33c2ac=_0x569e42(0x1264)+_0x9812d2['productInfo']+_0x569e42(0xfdf)+Number(_0x9812d2[_0x569e42(0x354)])[_0x569e42(0x200)](0x2)+_0x569e42(0xb62)+_0x5736e0+_0x569e42(0x527);}else{if(_0x9812d2[_0x569e42(0xa20)]===_0x569e42(0x57b)){let _0x41dd94,_0x5188c8;_0x3a9988[_0x569e42(0x1244)]?(_0x41dd94=_0xd9d60a(_0x3a9988,_0x9812d2[_0x569e42(0x768)]),_0x5188c8=_0xd9d60a(_0x3a9988,_0x9812d2[_0x569e42(0x10f)])):_0x9812d2['role']===_0x569e42(0x21c)?(_0x41dd94=_0x3a9988['settings'][_0x569e42(0xca7)]||'我',_0x5188c8=_0x3a9988[_0x569e42(0x278)]):(_0x41dd94=_0x3a9988['name'],_0x5188c8=_0x3a9988['settings']['myNickname']||'我'),_0x33c2ac=_0x569e42(0x13d)+_0x41dd94+_0x569e42(0x10ff)+_0x5188c8+_0x569e42(0xa88)+_0x9812d2['productInfo']+_0x569e42(0xfdf)+Number(_0x9812d2[_0x569e42(0x354)])['toFixed'](0x2)+_0x569e42(0x527);}}await _0x2fb06(_0x569e42(0x1000),_0x33c2ac);}async function _0x3e714f(_0x4c7e45,_0x235e65){const _0x22d5c8=_0x241b18,_0x550c2c=_0x5de8b7[_0x22d5c8(0x737)][_0x5de8b7[_0x22d5c8(0x93d)]];if(!_0x550c2c)return;const _0x2db5fb=_0x550c2c[_0x22d5c8(0x49e)][_0x22d5c8(0x901)](_0xc90142=>_0xc90142[_0x22d5c8(0x702)]===_0x4c7e45);if(_0x2db5fb===-0x1)return;const _0x1ab71c=_0x550c2c['history'][_0x2db5fb];_0x1ab71c['status']=_0x235e65;let _0x1fc9c5;const _0x1b5b08=_0x550c2c[_0x22d5c8(0x1244)]?_0x550c2c[_0x22d5c8(0x761)][_0x22d5c8(0xca7)]||'我':'我';_0x235e65===_0x22d5c8(0xa42)?(_0x1ab71c[_0x22d5c8(0xad8)]=_0x1b5b08,_0x1fc9c5=_0x22d5c8(0x147)+_0x1b5b08+_0x22d5c8(0x120f)+_0x1ab71c[_0x22d5c8(0x768)]+_0x22d5c8(0x7df)+_0x4c7e45+_0x22d5c8(0x10c0)):_0x1fc9c5=_0x22d5c8(0x147)+_0x1b5b08+_0x22d5c8(0xa59)+_0x1ab71c[_0x22d5c8(0x768)]+'\x20的外卖代付请求（时间戳:\x20'+_0x4c7e45+_0x22d5c8(0x2d8);const _0x4df6ba={'role':'system','content':_0x1fc9c5,'timestamp':Date[_0x22d5c8(0x1182)](),'isHidden':!![]};_0x550c2c['history'][_0x22d5c8(0xf5)](_0x4df6ba),await _0x2e83f8[_0x22d5c8(0x737)][_0x22d5c8(0xe3c)](_0x550c2c),_0x544ab5(_0x5de8b7[_0x22d5c8(0x93d)]);}let _0x46751e={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x466a8d=null;async function _0x2f05d6(){const _0x40fcde=_0x241b18;if(!_0x5de8b7['activeChatId']||_0x46751e[_0x40fcde(0x3d5)]||_0x46751e[_0x40fcde(0x1d6)])return;const _0x41ddca=_0x5de8b7[_0x40fcde(0x737)][_0x5de8b7[_0x40fcde(0x93d)]];_0x46751e[_0x40fcde(0x419)]=_0x41ddca[_0x40fcde(0x1244)],_0x46751e[_0x40fcde(0x1d6)]=!![],_0x46751e[_0x40fcde(0x756)]=_0x40fcde(0x21c),_0x46751e['activeChatId']=_0x41ddca['id'],_0x46751e[_0x40fcde(0xdb3)]=!![];_0x41ddca[_0x40fcde(0x1244)]?(document[_0x40fcde(0x11e3)](_0x40fcde(0x6ed))['src']=_0x41ddca[_0x40fcde(0x761)][_0x40fcde(0xc43)]||_0x30449f,document[_0x40fcde(0x11e3)](_0x40fcde(0x11f5))[_0x40fcde(0x300)]=_0x41ddca[_0x40fcde(0x761)][_0x40fcde(0xca7)]||'我'):(document[_0x40fcde(0x11e3)](_0x40fcde(0x6ed))[_0x40fcde(0xf0a)]=_0x41ddca[_0x40fcde(0x761)][_0x40fcde(0x5e0)]||_0x3d2e44,document['getElementById'](_0x40fcde(0x11f5))['textContent']=_0x41ddca['name']);document[_0x40fcde(0x5ac)](_0x40fcde(0x101f))[_0x40fcde(0x300)]=_0x41ddca[_0x40fcde(0x1244)]?_0x40fcde(0x749):_0x40fcde(0xbc2),_0x4e7698(_0x40fcde(0x75d));const _0x1916c5={'role':_0x40fcde(0xf72),'content':_0x41ddca[_0x40fcde(0x1244)]?_0x40fcde(0x430)+(_0x41ddca[_0x40fcde(0x761)][_0x40fcde(0xca7)]||'我')+_0x40fcde(0x194):_0x40fcde(0xf68),'timestamp':Date[_0x40fcde(0x1182)](),'isHidden':!![]};_0x41ddca[_0x40fcde(0x49e)]['push'](_0x1916c5),await _0x2e83f8[_0x40fcde(0x737)][_0x40fcde(0xe3c)](_0x41ddca),await _0x14a9f0();}function _0x3df367(){const _0x23b513=_0x241b18,_0x3201c2=_0x5de8b7[_0x23b513(0x737)][_0x46751e['activeChatId']];if(!_0x3201c2)return;_0x46751e[_0x23b513(0x3d5)]=!![],_0x46751e['isAwaitingResponse']=![],_0x46751e[_0x23b513(0xabc)]=Date[_0x23b513(0x1182)](),_0x46751e['callHistory']=[];const _0x4037a8=_0x3201c2['history']['slice'](-0xa);_0x46751e[_0x23b513(0xc02)]=_0x4037a8[_0x23b513(0x796)](_0xa8a958=>{const _0x2e7d86=_0x23b513,_0x55777f=_0xa8a958[_0x2e7d86(0xba4)]==='user'?_0x3201c2[_0x2e7d86(0x761)][_0x2e7d86(0xca7)]||'我':_0xa8a958['senderName']||_0x3201c2['name'];return _0x55777f+':\x20'+String(_0xa8a958['content'])[_0x2e7d86(0x8d4)](0x0,0x32)+_0x2e7d86(0x6cb);})[_0x23b513(0xa4b)]('\x0a'),_0x5bd783(),document[_0x23b513(0x11e3)](_0x23b513(0xc0e))[_0x23b513(0x595)]='<em>'+(_0x46751e['isGroupCall']?_0x23b513(0x2dd):_0x23b513(0x1075))+_0x23b513(0xd38),_0x4e7698('video-call-screen'),document[_0x23b513(0x11e3)](_0x23b513(0x443))[_0x23b513(0x794)][_0x23b513(0x33d)]=_0x46751e[_0x23b513(0xdb3)]?_0x23b513(0x11ac):_0x23b513(0x379),document['getElementById'](_0x23b513(0x233))[_0x23b513(0x794)][_0x23b513(0x33d)]=_0x46751e[_0x23b513(0xdb3)]?_0x23b513(0x379):_0x23b513(0x11ac);if(_0x466a8d)clearInterval(_0x466a8d);_0x466a8d=setInterval(_0x15a57e,0x3e8),_0x15a57e(),_0x18571c();}async function _0x24ad7e(){const _0x58ef17=_0x241b18;if(!_0x46751e[_0x58ef17(0x3d5)])return;const _0x5583ef=Math['floor']((Date[_0x58ef17(0x1182)]()-_0x46751e['startTime'])/0x3e8),_0x11bb85=Math['floor'](_0x5583ef/0x3c)+'分'+_0x5583ef%0x3c+'秒',_0x19e168='通话结束，时长\x20'+_0x11bb85,_0xd8b63c=_0x5de8b7['chats'][_0x46751e[_0x58ef17(0x93d)]];if(_0xd8b63c){const _0x502c1d=[];_0x46751e[_0x58ef17(0x419)]?(_0x46751e[_0x58ef17(0x94b)][_0x58ef17(0x494)](_0x3c9411=>_0x502c1d[_0x58ef17(0xf5)]({'name':_0x3c9411[_0x58ef17(0x697)],'avatar':_0x3c9411[_0x58ef17(0x525)]})),_0x46751e[_0x58ef17(0xdb3)]&&_0x502c1d['unshift']({'name':_0xd8b63c[_0x58ef17(0x761)]['myNickname']||'我','avatar':_0xd8b63c['settings'][_0x58ef17(0xc43)]||_0x30449f})):(_0x502c1d[_0x58ef17(0xf5)]({'name':_0xd8b63c[_0x58ef17(0x278)],'avatar':_0xd8b63c[_0x58ef17(0x761)][_0x58ef17(0x5e0)]||_0x3d2e44}),_0x502c1d[_0x58ef17(0xc8)]({'name':'我','avatar':_0xd8b63c[_0x58ef17(0x761)][_0x58ef17(0xc43)]||_0x3d2e44}));const _0x3d60c6={'chatId':_0x46751e[_0x58ef17(0x93d)],'timestamp':Date['now'](),'duration':_0x5583ef,'participants':_0x502c1d,'transcript':[..._0x46751e[_0x58ef17(0x6ba)]]};await _0x2e83f8[_0x58ef17(0x516)][_0x58ef17(0x252)](_0x3d60c6),console['log'](_0x58ef17(0xa2),_0x3d60c6);let _0x33f735={'role':_0x46751e[_0x58ef17(0x756)]===_0x58ef17(0x21c)?_0x58ef17(0x21c):'assistant','content':_0x19e168,'timestamp':Date[_0x58ef17(0x1182)]()};_0xd8b63c[_0x58ef17(0x1244)]&&_0x33f735[_0x58ef17(0xba4)]===_0x58ef17(0x1119)&&(_0x33f735[_0x58ef17(0x768)]=_0x46751e[_0x58ef17(0x1251)]||_0xd8b63c[_0x58ef17(0x2b3)][0x0]?.['originalName']||_0xd8b63c[_0x58ef17(0x278)]);_0xd8b63c[_0x58ef17(0x49e)]['push'](_0x33f735);const _0x2f3dd6=_0x46751e[_0x58ef17(0x6ba)][_0x58ef17(0x796)](_0x5168c6=>{const _0x3dbf1e=_0x58ef17,_0x4b626d=_0x5168c6[_0x3dbf1e(0xba4)]===_0x3dbf1e(0x21c)?_0xd8b63c[_0x3dbf1e(0x761)][_0x3dbf1e(0xca7)]||'我':_0x5168c6[_0x3dbf1e(0x768)];return _0x4b626d+':\x20'+_0x5168c6['content'];})[_0x58ef17(0xa4b)]('\x0a');_0x539172(_0xd8b63c['id'],_0x2f3dd6);const _0x1c11f3={'role':_0x58ef17(0xf72),'content':_0x58ef17(0x122b),'timestamp':Date[_0x58ef17(0x1182)]()+0x1,'isHidden':!![]};_0xd8b63c[_0x58ef17(0x49e)][_0x58ef17(0xf5)](_0x1c11f3),await _0x2e83f8[_0x58ef17(0x737)][_0x58ef17(0xe3c)](_0xd8b63c);}clearInterval(_0x466a8d),_0x466a8d=null,_0x46751e={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0xd8b63c&&(_0x6cac66(_0xd8b63c['id']),_0x14a9f0());}function _0x5bd783(){const _0x19bb6f=_0x241b18,_0x44045b=document[_0x19bb6f(0x11e3)]('participant-avatars-grid');_0x44045b[_0x19bb6f(0x595)]='';const _0x2b7e77=_0x5de8b7[_0x19bb6f(0x737)][_0x46751e[_0x19bb6f(0x93d)]];if(!_0x2b7e77)return;let _0x5034af=[];_0x46751e[_0x19bb6f(0x419)]?(_0x5034af=[..._0x46751e['participants']],_0x46751e[_0x19bb6f(0xdb3)]&&_0x5034af[_0x19bb6f(0xc8)]({'id':_0x19bb6f(0x21c),'name':_0x2b7e77[_0x19bb6f(0x761)]['myNickname']||'我','avatar':_0x2b7e77[_0x19bb6f(0x761)][_0x19bb6f(0xc43)]||_0x30449f})):_0x5034af['push']({'id':'ai','name':_0x2b7e77['name'],'avatar':_0x2b7e77[_0x19bb6f(0x761)][_0x19bb6f(0x5e0)]||_0x3d2e44}),_0x5034af[_0x19bb6f(0x494)](_0x1acd2a=>{const _0x42f08b=_0x19bb6f,_0x302ec4=document[_0x42f08b(0x383)](_0x42f08b(0x1285));_0x302ec4['className']=_0x42f08b(0xad5),_0x302ec4[_0x42f08b(0xaca)][_0x42f08b(0x33a)]=_0x1acd2a['id'];const _0x573b62=_0x1acd2a[_0x42f08b(0xc8f)]||_0x1acd2a[_0x42f08b(0x278)];_0x302ec4[_0x42f08b(0x595)]=_0x42f08b(0xd6d)+_0x1acd2a[_0x42f08b(0x525)]+_0x42f08b(0x5b7)+_0x573b62+_0x42f08b(0x903)+_0x573b62+_0x42f08b(0x176),_0x44045b[_0x42f08b(0x120c)](_0x302ec4);});}function _0x392c9b(){const _0x27ac48=_0x241b18;if(!_0x46751e[_0x27ac48(0x3d5)]||_0x46751e['isUserParticipating'])return;_0x46751e[_0x27ac48(0xdb3)]=!![],_0x5bd783(),document[_0x27ac48(0x11e3)]('user-speak-btn')[_0x27ac48(0x794)][_0x27ac48(0x33d)]=_0x27ac48(0x11ac),document[_0x27ac48(0x11e3)](_0x27ac48(0x233))['style'][_0x27ac48(0x33d)]='none',_0x18571c(_0x27ac48(0x1b6));}function _0x15a57e(){const _0x34569d=_0x241b18;if(!_0x46751e[_0x34569d(0x3d5)])return;const _0x2a1509=Math[_0x34569d(0xfb1)]((Date[_0x34569d(0x1182)]()-_0x46751e[_0x34569d(0xabc)])/0x3e8),_0x16a674=Math['floor'](_0x2a1509/0x3c),_0x49c112=_0x2a1509%0x3c;document[_0x34569d(0x11e3)](_0x34569d(0x227))[_0x34569d(0x300)]=String(_0x16a674)[_0x34569d(0xae4)](0x2,'0')+':'+String(_0x49c112)[_0x34569d(0xae4)](0x2,'0');}function _0x3f7dd2(){const _0x18772d=_0x241b18,_0xd4f208=_0x5de8b7[_0x18772d(0x737)][_0x5de8b7[_0x18772d(0x93d)]];if(!_0xd4f208)return;if(_0xd4f208[_0x18772d(0x1244)]){const _0x45363f=_0x46751e[_0x18772d(0x1251)]||_0xd4f208[_0x18772d(0x2b3)][0x0]?.[_0x18772d(0x278)]||_0x18772d(0xa55);document[_0x18772d(0x11e3)](_0x18772d(0xded))[_0x18772d(0xf0a)]=_0xd4f208[_0x18772d(0x761)][_0x18772d(0x75c)]||_0x1f1b42,document[_0x18772d(0x11e3)](_0x18772d(0x64d))['textContent']=_0xd4f208[_0x18772d(0x278)],document[_0x18772d(0x5ac)](_0x18772d(0x43d))['textContent']=_0x45363f+_0x18772d(0x1e2);}else document[_0x18772d(0x11e3)](_0x18772d(0xded))['src']=_0xd4f208['settings']['aiAvatar']||_0x3d2e44,document[_0x18772d(0x11e3)](_0x18772d(0x64d))['textContent']=_0xd4f208['name'],document[_0x18772d(0x5ac)](_0x18772d(0x43d))[_0x18772d(0x300)]=_0x18772d(0xb0e);document[_0x18772d(0x11e3)](_0x18772d(0xcf1))['classList']['add'](_0x18772d(0x250));}function _0x43a197(){const _0x19f164=_0x241b18;document[_0x19f164(0x11e3)](_0x19f164(0xcf1))[_0x19f164(0x505)][_0x19f164(0x957)](_0x19f164(0x250));}async function _0x18571c(_0x19ce7c=null){const _0x2c5773=_0x241b18;if(!_0x46751e[_0x2c5773(0x3d5)])return;const _0x589988=_0x5de8b7[_0x2c5773(0x737)][_0x46751e['activeChatId']],{proxyUrl:_0x3c4aa6,apiKey:_0x557b9a,model:_0x517553}=_0x5de8b7[_0x2c5773(0x89c)],_0x34a621=document[_0x2c5773(0x11e3)]('video-call-main'),_0x29bbea=_0x589988[_0x2c5773(0x761)]['myNickname']||'我';let _0x18d94d='';if(_0x589988['settings'][_0x2c5773(0xa17)]&&_0x589988['settings']['linkedWorldBookIds'][_0x2c5773(0x594)]>0x0){const _0x494a9c=_0x589988[_0x2c5773(0x761)][_0x2c5773(0xa17)][_0x2c5773(0x796)](_0x48a9c7=>{const _0x1b24c7=_0x2c5773,_0x597c6e=_0x5de8b7[_0x1b24c7(0xca)]['find'](_0x567131=>_0x567131['id']===_0x48a9c7);return _0x597c6e&&_0x597c6e['content']?_0x1b24c7(0xe49)+_0x597c6e['name']+'\x0a'+_0x597c6e[_0x1b24c7(0x9a5)]:'';})[_0x2c5773(0x138)](Boolean)[_0x2c5773(0xa4b)]('');_0x494a9c&&(_0x18d94d=_0x2c5773(0xa11)+_0x494a9c+_0x2c5773(0x421));}if(_0x19ce7c&&_0x46751e[_0x2c5773(0xdb3)]){const _0x4e57c0=Date['now'](),_0x4ec95e=document[_0x2c5773(0x383)](_0x2c5773(0x1285));_0x4ec95e[_0x2c5773(0x3db)]=_0x2c5773(0x42c),_0x4ec95e['textContent']=_0x19ce7c,_0x4ec95e[_0x2c5773(0xaca)][_0x2c5773(0x702)]=_0x4e57c0,_0xcb6204(_0x4ec95e,()=>_0xc72c05(_0x4e57c0)),_0x34a621[_0x2c5773(0x120c)](_0x4ec95e),_0x34a621[_0x2c5773(0x11c7)]=_0x34a621[_0x2c5773(0x36b)],_0x46751e['callHistory'][_0x2c5773(0xf5)]({'role':_0x2c5773(0x21c),'content':_0x19ce7c,'timestamp':_0x4e57c0});}let _0x55b797;if(_0x46751e[_0x2c5773(0x419)]){const _0x3c236c=_0x46751e[_0x2c5773(0x94b)][_0x2c5773(0x796)](_0x5d3c21=>_0x5d3c21[_0x2c5773(0x278)]);_0x46751e[_0x2c5773(0xdb3)]&&_0x3c236c[_0x2c5773(0xc8)](_0x29bbea),_0x55b797=_0x2c5773(0xf58)+_0x29bbea+_0x2c5773(0xd32)+_0x29bbea+'\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x46751e[_0x2c5773(0xc02)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20'+_0x3c236c['join']('、\x20')+_0x2c5773(0x301)+_0x18d94d+_0x2c5773(0xcea);}else{let _0x20db5b=_0x46751e['initiator']===_0x2c5773(0x21c)?_0x2c5773(0xe06):_0x2c5773(0xec2);_0x55b797='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20'+_0x589988[_0x2c5773(0x278)]+'\x20('+_0x589988[_0x2c5773(0x761)][_0x2c5773(0x8d5)]+_0x2c5773(0x563)+_0x589988[_0x2c5773(0x278)]+'”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（'+_0x29bbea+_0x2c5773(0x9e0)+_0x589988[_0x2c5773(0x761)][_0x2c5773(0x10c5)]+'）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**'+_0x20db5b+_0x2c5773(0xcac)+_0x46751e['preCallContext']+_0x2c5773(0x1139);}const _0x38bbfc=[{'role':'system','content':_0x55b797},..._0x46751e[_0x2c5773(0x6ba)][_0x2c5773(0x796)](_0x30876f=>({'role':_0x30876f[_0x2c5773(0xba4)],'content':_0x30876f[_0x2c5773(0x9a5)]}))];if(_0x46751e[_0x2c5773(0x6ba)][_0x2c5773(0x594)]===0x0){const _0x1759ec=_0x46751e['initiator']==='user'?_0x2c5773(0x11b0):_0x2c5773(0xbca);_0x38bbfc[_0x2c5773(0xf5)]({'role':_0x2c5773(0x21c),'content':_0x1759ec});}try{let _0x4ef8cc=_0x3c4aa6===GEMINI_API_URL,_0x16715b=_0x4a90fe(_0x517553,_0x557b9a,_0x55b797,_0x38bbfc);const _0x5f0241=_0x4ef8cc?await fetch(_0x16715b[_0x2c5773(0x10ac)],_0x16715b['data']):await fetch(_0x3c4aa6+'/v1/chat/completions',{'method':_0x2c5773(0x1128),'headers':{'Content-Type':_0x2c5773(0x35c),'Authorization':_0x2c5773(0xdaf)+_0x557b9a},'body':JSON[_0x2c5773(0x313)]({'model':_0x517553,'messages':_0x38bbfc,'temperature':_0x5de8b7[_0x2c5773(0x2df)][_0x2c5773(0xe66)]||0.8})});if(!_0x5f0241['ok'])throw new Error((await _0x5f0241['json']())[_0x2c5773(0x1c1)]['message']);const _0x1570b6=await _0x5f0241[_0x2c5773(0xd7b)](),_0x20c75b=_0x4ef8cc?_0x1570b6['candidates'][0x0]['content'][_0x2c5773(0x9ba)][0x0]['text']:_0x1570b6[_0x2c5773(0x1206)][0x0]['message'][_0x2c5773(0x9a5)],_0x305ab6=_0x34a621[_0x2c5773(0x5ac)]('em');if(_0x305ab6)_0x305ab6[_0x2c5773(0x957)]();if(_0x46751e[_0x2c5773(0x419)]){const _0x239c55=_0x30c9b6(_0x20c75b);_0x239c55[_0x2c5773(0x494)](_0x49cbdd=>{const _0x1f5789=_0x2c5773;if(!_0x49cbdd[_0x1f5789(0x278)]||_0x49cbdd['name']===_0x29bbea||!_0x49cbdd['speech'])return;const _0x578333=Date[_0x1f5789(0x1182)]()+Math[_0x1f5789(0x36d)](),_0x3d0470=document[_0x1f5789(0x383)](_0x1f5789(0x1285));_0x3d0470['className']=_0x1f5789(0x94e),_0x3d0470[_0x1f5789(0x595)]=_0x1f5789(0xf69)+_0x49cbdd[_0x1f5789(0x278)]+_0x1f5789(0x600)+_0x49cbdd[_0x1f5789(0x67a)],_0x3d0470[_0x1f5789(0xaca)][_0x1f5789(0x702)]=_0x578333,_0xcb6204(_0x3d0470,()=>_0xc72c05(_0x578333)),_0x34a621[_0x1f5789(0x120c)](_0x3d0470),_0x46751e[_0x1f5789(0x6ba)][_0x1f5789(0xf5)]({'role':_0x1f5789(0x1119),'content':_0x49cbdd[_0x1f5789(0x278)]+':\x20'+_0x49cbdd['speech'],'timestamp':_0x578333});const _0x26ff1c=_0x46751e[_0x1f5789(0x94b)][_0x1f5789(0xe79)](_0x2a0446=>_0x2a0446[_0x1f5789(0x278)]===_0x49cbdd[_0x1f5789(0x278)]);if(_0x26ff1c){const _0x1c6688=document[_0x1f5789(0x5ac)](_0x1f5789(0xaed)+_0x26ff1c['id']+_0x1f5789(0x110f));_0x1c6688&&(_0x1c6688[_0x1f5789(0x505)][_0x1f5789(0x252)](_0x1f5789(0xe64)),setTimeout(()=>_0x1c6688[_0x1f5789(0x505)][_0x1f5789(0x957)](_0x1f5789(0xe64)),0x7d0));}});}else{const _0x453d89=Date[_0x2c5773(0x1182)](),_0x51e316=document['createElement']('div');_0x51e316[_0x2c5773(0x3db)]=_0x2c5773(0x94e),_0x51e316[_0x2c5773(0x300)]=_0x20c75b,_0x51e316['dataset'][_0x2c5773(0x702)]=_0x453d89,_0xcb6204(_0x51e316,()=>_0xc72c05(_0x453d89)),_0x34a621[_0x2c5773(0x120c)](_0x51e316),_0x46751e['callHistory'][_0x2c5773(0xf5)]({'role':_0x2c5773(0x1119),'content':_0x20c75b,'timestamp':_0x453d89});const _0x1cdfcd=document[_0x2c5773(0x5ac)](_0x2c5773(0xd1e));_0x1cdfcd&&(_0x1cdfcd[_0x2c5773(0x505)][_0x2c5773(0x252)](_0x2c5773(0xe64)),setTimeout(()=>_0x1cdfcd['classList'][_0x2c5773(0x957)](_0x2c5773(0xe64)),0x7d0));}_0x34a621['scrollTop']=_0x34a621[_0x2c5773(0x36b)];}catch(_0xba76bc){const _0x46778a=document[_0x2c5773(0x383)](_0x2c5773(0x1285));_0x46778a[_0x2c5773(0x3db)]='call-message-bubble\x20ai-speech',_0x46778a[_0x2c5773(0x794)][_0x2c5773(0x830)]=_0x2c5773(0x3cd),_0x46778a['textContent']=_0x2c5773(0x9ed)+_0xba76bc['message']+']',_0x34a621[_0x2c5773(0x120c)](_0x46778a),_0x34a621[_0x2c5773(0x11c7)]=_0x34a621[_0x2c5773(0x36b)],_0x46751e['callHistory'][_0x2c5773(0xf5)]({'role':_0x2c5773(0x1119),'content':_0x2c5773(0x9ed)+_0xba76bc[_0x2c5773(0x4bc)]+']'});}}function _0x29bcbe(_0x44b57a){const _0x25411f=_0x241b18;document[_0x25411f(0x11e3)](_0x25411f(0x228))[_0x25411f(0x794)][_0x25411f(0x33d)]=_0x44b57a?'none':_0x25411f(0x10f4),document[_0x25411f(0x11e3)](_0x25411f(0x805))[_0x25411f(0x794)][_0x25411f(0x33d)]=_0x44b57a?_0x25411f(0x10f4):_0x25411f(0x379);}async function _0x3e714f(_0x52aa81,_0x1f9d96){const _0x4eab72=_0x241b18,_0x266f77=_0x5de8b7['chats'][_0x5de8b7[_0x4eab72(0x93d)]];if(!_0x266f77)return;const _0x3d7ab6=_0x266f77[_0x4eab72(0x49e)][_0x4eab72(0x901)](_0x56654e=>_0x56654e[_0x4eab72(0x702)]===_0x52aa81);if(_0x3d7ab6===-0x1)return;const _0xb2eac1=_0x266f77[_0x4eab72(0x49e)][_0x3d7ab6];_0xb2eac1[_0x4eab72(0x739)]=_0x1f9d96;let _0x445549;const _0x59a9ff=_0x266f77[_0x4eab72(0x1244)]?_0x266f77[_0x4eab72(0x761)]['myNickname']||'我':'我';_0x1f9d96===_0x4eab72(0xa42)?(_0xb2eac1[_0x4eab72(0xad8)]=_0x59a9ff,_0x445549=_0x4eab72(0x147)+_0x59a9ff+_0x4eab72(0x120f)+_0xb2eac1[_0x4eab72(0x768)]+_0x4eab72(0x7df)+_0x52aa81+_0x4eab72(0x10c0)):_0x445549='[系统提示：你\x20('+_0x59a9ff+')\x20拒绝了\x20'+_0xb2eac1['senderName']+_0x4eab72(0x335)+_0x52aa81+_0x4eab72(0x2d8);const _0xe9af1b={'role':_0x4eab72(0xf72),'content':_0x445549,'timestamp':Date[_0x4eab72(0x1182)](),'isHidden':!![]};_0x266f77['history'][_0x4eab72(0xf5)](_0xe9af1b),await _0x2e83f8[_0x4eab72(0x737)][_0x4eab72(0xe3c)](_0x266f77),_0x544ab5(_0x5de8b7['activeChatId']),_0x1f9d96===_0x4eab72(0xa42)&&_0x14a9f0();}async function _0x5be23d(_0x5674af,_0x498d04){const _0x1b1bd0=_0x241b18,_0x79b892=_0x5de8b7[_0x1b1bd0(0x737)][_0x5674af];if(!_0x79b892)return;let _0xb5a091;_0x79b892[_0x1b1bd0(0x1244)]?_0xb5a091=_0xd9d60a(_0x79b892,_0x498d04):_0xb5a091=_0x79b892['name'];const _0x15e21f=document[_0x1b1bd0(0x11e3)](_0x1b1bd0(0x1e6));_0x15e21f[_0x1b1bd0(0x505)][_0x1b1bd0(0x957)](_0x1b1bd0(0x3b7)),void _0x15e21f[_0x1b1bd0(0x29f)],_0x15e21f['classList']['add'](_0x1b1bd0(0x3b7));const _0x536648=await _0x231a5a(_0x1b1bd0(0x342)+_0xb5a091+'”',_0x1b1bd0(0x11f3),'',_0x1b1bd0(0x1197));if(_0x536648===null)return;const _0xb169df=_0xd9d60a(_0x79b892,_0x5de8b7[_0x1b1bd0(0x1c5)][_0x1b1bd0(0xa33)]),_0x5ba49c=_0xb169df+_0x1b1bd0(0x7e4)+_0xb5a091+'”\x20'+_0x536648[_0x1b1bd0(0xeb7)](),_0x499861={'role':_0x1b1bd0(0xf72),'type':_0x1b1bd0(0x8ee),'content':_0x5ba49c,'timestamp':Date[_0x1b1bd0(0x1182)]()};_0x79b892[_0x1b1bd0(0x49e)][_0x1b1bd0(0xf5)](_0x499861);const _0xdf37df=_0x1b1bd0(0xd35)+_0xb169df+_0x1b1bd0(0x29b)+_0x498d04+'）'+_0x536648[_0x1b1bd0(0xeb7)]()+'。请你对此作出回应。]',_0x255e19={'role':_0x1b1bd0(0xf72),'content':_0xdf37df,'timestamp':Date[_0x1b1bd0(0x1182)]()+0x1,'isHidden':!![]};_0x79b892['history'][_0x1b1bd0(0xf5)](_0x255e19),await _0x2e83f8['chats'][_0x1b1bd0(0xe3c)](_0x79b892),_0x5de8b7[_0x1b1bd0(0x93d)]===_0x5674af&&_0x3b5153(_0x499861,_0x79b892),await _0x5ee219();}let _0x367e7c=null,_0x1992a9=![],_0x2f472a=new Set();function _0xc72c05(_0x2f4d1e){const _0x7d5db0=_0x241b18;_0x367e7c=_0x2f4d1e,document[_0x7d5db0(0x11e3)]('call-message-actions-modal')[_0x7d5db0(0x505)][_0x7d5db0(0x252)](_0x7d5db0(0x250));}function _0x3f160c(){const _0x275ca3=_0x241b18;document['getElementById']('call-message-actions-modal')[_0x275ca3(0x505)][_0x275ca3(0x957)](_0x275ca3(0x250)),_0x367e7c=null;}async function _0x5df417(){const _0x224759=_0x241b18;if(!_0x367e7c)return;const _0x3b5d00=_0x367e7c,_0x23ae20=_0x46751e['callHistory']['find'](_0xa2146f=>_0xa2146f[_0x224759(0x702)]===_0x3b5d00);if(!_0x23ae20)return;_0x3f160c();let _0x8858cf=_0x23ae20['content'];if(_0x46751e['isGroupCall']&&_0x23ae20[_0x224759(0xba4)]==='assistant'){const _0x226ba3=_0x23ae20[_0x224759(0x9a5)][_0x224759(0x65b)](':\x20');_0x226ba3[_0x224759(0x594)]>0x1&&(_0x8858cf=_0x226ba3['slice'](0x1)[_0x224759(0xa4b)](':\x20'));}const _0x53bf34=await _0x231a5a(_0x224759(0x115e),_0x224759(0xc20),_0x8858cf,_0x224759(0x10bb));_0x53bf34!==null&&await _0x2ad26b(_0x3b5d00,_0x53bf34);}async function _0x2ad26b(_0x1fcb2d,_0x1e36c6){const _0x30e158=_0x241b18,_0x163c08=_0x46751e[_0x30e158(0x6ba)]['find'](_0x5693c6=>_0x5693c6[_0x30e158(0x702)]===_0x1fcb2d);if(_0x163c08){let _0x2edc55=_0x1e36c6;if(_0x46751e[_0x30e158(0x419)]&&_0x163c08[_0x30e158(0xba4)]==='assistant'){const _0x4cc04c=_0x163c08[_0x30e158(0x9a5)][_0x30e158(0x65b)](':\x20'),_0xf613f3=_0x4cc04c[0x0];_0x2edc55=_0xf613f3+':\x20'+_0x1e36c6;}_0x163c08[_0x30e158(0x9a5)]=_0x2edc55;const _0x431405=document[_0x30e158(0x5ac)]('.call-message-bubble[data-timestamp=\x22'+_0x1fcb2d+'\x22]');if(_0x431405){if(_0x46751e[_0x30e158(0x419)]&&_0x163c08[_0x30e158(0xba4)]==='assistant'){const _0x25994a=_0x163c08[_0x30e158(0x9a5)][_0x30e158(0x65b)](':\x20'),_0x2fe97e=_0x25994a[0x0];_0x431405[_0x30e158(0x595)]='<strong>'+_0x2fe97e+_0x30e158(0x600)+_0x1e36c6;}else _0x431405[_0x30e158(0x300)]=_0x1e36c6;}}await _0x2fb06('成功',_0x30e158(0x404));}async function _0x49d86a(){const _0x52613e=_0x241b18;if(!_0x367e7c)return;const _0x34acd9=await _0x58fd60(_0x52613e(0x1066),_0x52613e(0x828),{'confirmButtonClass':_0x52613e(0x8a6)});if(_0x34acd9){const _0x4767fc=_0x367e7c;_0x3f160c();const _0x56e10b=_0x46751e[_0x52613e(0x6ba)][_0x52613e(0x901)](_0x467b7b=>_0x467b7b['timestamp']===_0x4767fc);_0x56e10b>-0x1&&_0x46751e['callHistory'][_0x52613e(0xfd0)](_0x56e10b,0x1);const _0x5f315c=document[_0x52613e(0x5ac)](_0x52613e(0xdec)+_0x4767fc+'\x22]');_0x5f315c&&_0x5f315c[_0x52613e(0x957)]();}else _0x3f160c();}function _0x520a19(_0x406ea6){const _0xc42ba9=_0x241b18;_0x2b0f7f=_0x406ea6;const _0x33a2bb=_0x5de8b7['chats'][_0x5de8b7['activeChatId']],_0x4f9566=_0x33a2bb['history'][_0xc42ba9(0xe79)](_0x41a275=>_0x41a275[_0xc42ba9(0x702)]===_0x406ea6);_0x4f9566&&(document[_0xc42ba9(0x11e3)]('transfer-sender-name')[_0xc42ba9(0x300)]=_0x4f9566[_0xc42ba9(0x768)]),document[_0xc42ba9(0x11e3)]('transfer-actions-modal')['classList'][_0xc42ba9(0x252)](_0xc42ba9(0x250));}function _0x157fc2(){const _0x3fbd24=_0x241b18;document[_0x3fbd24(0x11e3)](_0x3fbd24(0xbc0))[_0x3fbd24(0x505)]['remove'](_0x3fbd24(0x250)),_0x2b0f7f=null;}async function _0x429bef(_0x582544){const _0x410bd1=_0x241b18;if(!_0x2b0f7f)return;const _0x407fe5=_0x2b0f7f,_0x1a8e02=_0x5de8b7[_0x410bd1(0x737)][_0x5de8b7[_0x410bd1(0x93d)]],_0x5b1bef=_0x1a8e02[_0x410bd1(0x49e)][_0x410bd1(0x901)](_0x4381d4=>_0x4381d4[_0x410bd1(0x702)]===_0x407fe5);if(_0x5b1bef===-0x1)return;const _0x587b0=_0x1a8e02['history'][_0x5b1bef];_0x587b0[_0x410bd1(0x739)]=_0x582544;let _0x245d6a;if(_0x582544==='declined'){const _0x15f63f={'role':'user','type':_0x410bd1(0x82b),'isRefund':!![],'amount':_0x587b0[_0x410bd1(0x354)],'note':_0x410bd1(0x81d),'timestamp':Date['now']()};_0x1a8e02[_0x410bd1(0x49e)][_0x410bd1(0xf5)](_0x15f63f),_0x245d6a=_0x410bd1(0xd94)+_0x587b0[_0x410bd1(0x768)]+_0x410bd1(0x991);}else _0x245d6a='[系统提示：你接受了“'+_0x587b0['senderName']+_0x410bd1(0x991);const _0x293986={'role':'system','content':_0x245d6a,'timestamp':Date[_0x410bd1(0x1182)]()+0x1,'isHidden':!![]};_0x1a8e02[_0x410bd1(0x49e)][_0x410bd1(0xf5)](_0x293986),await _0x2e83f8[_0x410bd1(0x737)]['put'](_0x1a8e02),_0x157fc2(),_0x544ab5(_0x5de8b7[_0x410bd1(0x93d)]),_0x5ee219();}function _0x3dd99e(_0x1622d7){const _0x41578d=_0x241b18;_0x362af8=null;if(_0x1622d7){const _0x1e09a7=_0x1622d7[_0x41578d(0x5ac)](_0x41578d(0x71b));_0x1e09a7&&(_0x1e09a7['placeholder']='友善的评论是交流的起点');}}async function _0x1bb7fa(){const _0x54d26a=_0x241b18,_0x3e0789=document[_0x54d26a(0x11e3)](_0x54d26a(0x18d));_0x3e0789[_0x54d26a(0x595)]='';const _0x73b9e8=await _0x2e83f8[_0x54d26a(0x360)][_0x54d26a(0x7c6)](_0x54d26a(0x702))[_0x54d26a(0x107)]()[_0x54d26a(0x508)]();if(_0x73b9e8[_0x54d26a(0x594)]===0x0){_0x3e0789['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>';return;}_0x73b9e8['sort']((_0x398200,_0x2d4547)=>{const _0x27393a=_0x54d26a,_0xc9bf8b=_0x398200['type']===_0x27393a(0x476)&&_0x398200[_0x27393a(0xb76)]>Date['now'](),_0x1574e1=_0x2d4547[_0x27393a(0xa20)]===_0x27393a(0x476)&&_0x2d4547[_0x27393a(0xb76)]>Date[_0x27393a(0x1182)]();if(_0xc9bf8b&&!_0x1574e1)return-0x1;if(!_0xc9bf8b&&_0x1574e1)return 0x1;if(_0xc9bf8b&&_0x1574e1)return _0x398200['targetDate']-_0x2d4547['targetDate'];return 0x0;}),_0x73b9e8[_0x54d26a(0x494)](_0x5f5332=>{const _0x7d233=_0x54d26a;let _0x26e573;_0x5f5332[_0x7d233(0xa20)]===_0x7d233(0x476)&&_0x5f5332[_0x7d233(0xb76)]>Date[_0x7d233(0x1182)]()?_0x26e573=_0x663f28(_0x5f5332):_0x26e573=_0x38d09d(_0x5f5332),_0x3e0789[_0x7d233(0x120c)](_0x26e573);}),_0x37f151();}function _0x38d09d(_0x24eb9c){const _0x1449de=_0x241b18,_0x2bd4ae=document[_0x1449de(0x383)](_0x1449de(0x1285));_0x2bd4ae['className']=_0x1449de(0xed5);const _0xf5fdbb=new Date(_0x24eb9c[_0x1449de(0x702)]),_0x3c92bd=_0xf5fdbb[_0x1449de(0x177)]()+'-'+String(_0xf5fdbb[_0x1449de(0x39d)]()+0x1)[_0x1449de(0xae4)](0x2,'0')+'-'+String(_0xf5fdbb[_0x1449de(0x97d)]())[_0x1449de(0xae4)](0x2,'0')+'\x20'+String(_0xf5fdbb[_0x1449de(0x3de)]())[_0x1449de(0xae4)](0x2,'0')+':'+String(_0xf5fdbb[_0x1449de(0xf39)]())[_0x1449de(0xae4)](0x2,'0');let _0x276739,_0x1febe9;if(_0x24eb9c['type']==='countdown'&&_0x24eb9c[_0x1449de(0xb76)])_0x276739=_0x1449de(0x8fc)+_0x24eb9c[_0x1449de(0x1029)],_0x1febe9=_0x5a9a9e('在\x20'+new Date(_0x24eb9c['targetDate'])[_0x1449de(0x9df)]()+_0x1449de(0x11a4))[_0x1449de(0x1018)](/\n/g,_0x1449de(0xf70));else{let _0x28b9fe=_0x1449de(0xaaa);if(_0x24eb9c[_0x1449de(0x5d9)]){const _0x144971=_0x5de8b7['chats'][_0x24eb9c[_0x1449de(0x5d9)]];_0x144971?_0x28b9fe=_0x144971[_0x1449de(0x278)]:_0x28b9fe=_0x24eb9c[_0x1449de(0xd5a)]||_0x1449de(0x69f);}else _0x24eb9c['authorName']&&(_0x28b9fe=_0x24eb9c[_0x1449de(0xd5a)]);_0x276739=_0x28b9fe+_0x1449de(0xb5a),_0x1febe9=_0x5a9a9e(_0x24eb9c[_0x1449de(0x1029)]);}return _0x2bd4ae[_0x1449de(0x595)]=_0x1449de(0x127)+_0x3c92bd+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>'+_0x276739+_0x1449de(0x952)+_0x1febe9+_0x1449de(0x999),_0xcb6204(_0x2bd4ae,async()=>{const _0x5e2350=_0x1449de,_0xed8372=await _0x58fd60(_0x5e2350(0x588),_0x5e2350(0x80d),{'confirmButtonClass':_0x5e2350(0x8a6)});_0xed8372&&(await _0x2e83f8[_0x5e2350(0x360)][_0x5e2350(0xc0c)](_0x24eb9c['id']),_0x1bb7fa());}),_0x2bd4ae;}function _0x663f28(_0x7f4053){const _0x496aeb=_0x241b18,_0x4ccbd1=document[_0x496aeb(0x383)](_0x496aeb(0x1285));_0x4ccbd1[_0x496aeb(0x3db)]=_0x496aeb(0x8c9);const _0x28c55d=new Date(_0x7f4053[_0x496aeb(0xb76)]),_0x250a81=_0x28c55d[_0x496aeb(0x9df)](_0x496aeb(0x898),{'dateStyle':'full','timeStyle':_0x496aeb(0x3f8)});return _0x4ccbd1[_0x496aeb(0x595)]=_0x496aeb(0x3c9)+_0x7f4053[_0x496aeb(0x1029)]+_0x496aeb(0xef9)+_0x7f4053[_0x496aeb(0xb76)]+_0x496aeb(0x72c)+_0x250a81+_0x496aeb(0x999),_0xcb6204(_0x4ccbd1,async()=>{const _0x1edc85=_0x496aeb,_0x49ee82=await _0x58fd60('删除约定',_0x1edc85(0x9c3),{'confirmButtonClass':_0x1edc85(0x8a6)});_0x49ee82&&(await _0x2e83f8[_0x1edc85(0x360)]['delete'](_0x7f4053['id']),_0x1bb7fa());}),_0x4ccbd1;}let _0x49b868=[];function _0x37f151(){const _0x101817=_0x241b18;_0x49b868[_0x101817(0x494)](_0x274c17=>clearInterval(_0x274c17)),_0x49b868=[],document[_0x101817(0x10d6)](_0x101817(0xa05))[_0x101817(0x494)](_0x51b1ed=>{const _0x968c84=_0x101817,_0xc94560=parseInt(_0x51b1ed[_0x968c84(0xaca)][_0x968c84(0xb76)]);let _0x1121ff;const _0x2585af=()=>{const _0x4efbb0=_0x968c84,_0x4a7dfc=Date['now'](),_0x2fda64=_0xc94560-_0x4a7dfc;if(_0x2fda64<0x0){_0x51b1ed[_0x4efbb0(0x300)]=_0x4efbb0(0xdb7),clearInterval(_0x1121ff),setTimeout(()=>_0x1bb7fa(),0x7d0);return;}const _0x15640a=Math[_0x4efbb0(0xfb1)](_0x2fda64/(0x3e8*0x3c*0x3c*0x18)),_0x419a59=Math['floor'](_0x2fda64%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x2f5427=Math[_0x4efbb0(0xfb1)](_0x2fda64%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x144f9c=Math['floor'](_0x2fda64%(0x3e8*0x3c)/0x3e8);_0x51b1ed['textContent']=_0x15640a+'天\x20'+_0x419a59+'时\x20'+_0x2f5427+'分\x20'+_0x144f9c+'秒';};_0x2585af(),_0x1121ff=setInterval(_0x2585af,0x3e8),_0x49b868['push'](_0x1121ff);});}async function _0x2d6139(_0x3f6042){const _0x219fd8=_0x241b18,_0x55a7ff=_0x5de8b7[_0x219fd8(0x737)][_0x3f6042];if(!_0x55a7ff)return;await _0x2fb06('流程启动',_0x219fd8(0x91d)+_0x55a7ff['name']+_0x219fd8(0x149));const {proxyUrl:_0x4c3211,apiKey:_0x1e2e2f,model:_0x4debe3}=_0x5de8b7[_0x219fd8(0x89c)];if(!_0x4c3211||!_0x1e2e2f||!_0x4debe3){await _0x2fb06(_0x219fd8(0xc01),'API设置不完整，无法继续。');return;}const _0x2b1056=_0x55a7ff['history'][_0x219fd8(0xa6c)](-0x5)[_0x219fd8(0x796)](_0x1b39e9=>{const _0x23f9c0=_0x219fd8,_0x159664=_0x1b39e9['role']==='user'?_0x55a7ff[_0x23f9c0(0x761)][_0x23f9c0(0xca7)]||'我':_0x1b39e9[_0x23f9c0(0x768)]||_0x55a7ff[_0x23f9c0(0x278)];return _0x159664+':\x20'+String(_0x1b39e9['content'])[_0x23f9c0(0x8d4)](0x0,0x32)+_0x23f9c0(0x6cb);})['join']('\x0a');let _0x21dad3='';if(_0x55a7ff['settings'][_0x219fd8(0xa17)]&&_0x55a7ff[_0x219fd8(0x761)][_0x219fd8(0xa17)][_0x219fd8(0x594)]>0x0){const _0x227949=_0x55a7ff[_0x219fd8(0x761)][_0x219fd8(0xa17)]['map'](_0x3d954a=>{const _0x1ccd35=_0x219fd8,_0x112a37=_0x5de8b7[_0x1ccd35(0xca)]['find'](_0x270073=>_0x270073['id']===_0x3d954a);if(!_0x112a37||!Array[_0x1ccd35(0xb7b)](_0x112a37[_0x1ccd35(0x9a5)]))return'';const _0x5da80d=_0x112a37['content'][_0x1ccd35(0x796)](_0x5d830d=>{const _0x19f7f8=_0x1ccd35;let _0x13a7af=_0x19f7f8(0xec3)+(_0x5d830d[_0x19f7f8(0xebd)]||_0x19f7f8(0x350))+'\x0a';return _0x5d830d[_0x19f7f8(0xb4a)]['length']>0x0&&(_0x13a7af+=_0x19f7f8(0x105b)+_0x5d830d[_0x19f7f8(0xb4a)]['join'](',\x20')+'\x0a'),_0x13a7af+=_0x19f7f8(0x10f0)+_0x5d830d[_0x19f7f8(0x9a5)],_0x13a7af;})['join']('\x0a');return _0x5da80d?'\x0a\x0a##\x20世界书:\x20'+_0x112a37[_0x1ccd35(0x278)]+'\x0a'+_0x5da80d:'';})[_0x219fd8(0x138)](Boolean)[_0x219fd8(0xa4b)]('');_0x227949&&(_0x21dad3=_0x219fd8(0x45e)+_0x227949+'\x0a');}const _0x578e22=_0x219fd8(0x127e)+_0x55a7ff['name']+_0x219fd8(0xa18)+_0x55a7ff[_0x219fd8(0x761)][_0x219fd8(0x8d5)]+_0x219fd8(0x94f)+_0x21dad3+_0x219fd8(0xd9b)+_0x2b1056+_0x219fd8(0x84f);try{const _0x17dc16=[{'role':_0x219fd8(0xf72),'content':_0x578e22},{'role':_0x219fd8(0x21c),'content':'请根据以上设定开始你的决策。'}];let _0x5acbaf=_0x4c3211===GEMINI_API_URL,_0x2432e5=_0x4a90fe(_0x4debe3,_0x1e2e2f,_0x578e22,_0x17dc16);const _0x3cca50=_0x5acbaf?await fetch(_0x2432e5[_0x219fd8(0x10ac)],_0x2432e5['data']):await fetch(_0x4c3211+_0x219fd8(0x8fd),{'method':_0x219fd8(0x1128),'headers':{'Content-Type':'application/json','Authorization':_0x219fd8(0xdaf)+_0x1e2e2f},'body':JSON[_0x219fd8(0x313)]({'model':_0x4debe3,'messages':_0x17dc16,'temperature':_0x5de8b7[_0x219fd8(0x2df)][_0x219fd8(0xe66)]||0.9})});if(!_0x3cca50['ok']){const _0x54996d=await _0x3cca50[_0x219fd8(0xd7b)]();throw new Error(_0x219fd8(0xf8b)+_0x3cca50[_0x219fd8(0x739)]+_0x219fd8(0x12a2)+_0x54996d[_0x219fd8(0x1c1)][_0x219fd8(0x4bc)]);}const _0x20f9b8=await _0x3cca50[_0x219fd8(0xd7b)]();let _0x5d6421=_0x5acbaf?_0x20f9b8['candidates'][0x0][_0x219fd8(0x9a5)]['parts'][0x0][_0x219fd8(0x1197)]:_0x20f9b8['choices'][0x0]['message']['content'];_0x5d6421=_0x5d6421['replace'](/^```json\s*/,'')[_0x219fd8(0x1018)](/```$/,'');const _0x13dbca=_0x5d6421[_0x219fd8(0xeb7)](),_0x188d7a=JSON[_0x219fd8(0xb0c)](_0x13dbca);_0x188d7a[_0x219fd8(0xf98)]===_0x219fd8(0x2a2)&&_0x188d7a[_0x219fd8(0xc67)]?(_0x55a7ff[_0x219fd8(0xa78)][_0x219fd8(0x739)]=_0x219fd8(0xe80),_0x55a7ff[_0x219fd8(0xa78)][_0x219fd8(0xa83)]=_0x188d7a[_0x219fd8(0xc67)],_0x5de8b7[_0x219fd8(0x737)][_0x3f6042]=_0x55a7ff,_0x5ee219(),await _0x2fb06('申请成功！','“'+_0x55a7ff[_0x219fd8(0x278)]+_0x219fd8(0xe6b))):(await _0x2fb06(_0x219fd8(0xb54),'“'+_0x55a7ff[_0x219fd8(0x278)]+_0x219fd8(0x9e9)),_0x55a7ff[_0x219fd8(0xa78)][_0x219fd8(0x739)]=_0x219fd8(0x530),_0x55a7ff[_0x219fd8(0xa78)][_0x219fd8(0x64c)]=Date['now']());}catch(_0x3a6d5b){await _0x2fb06('执行出错','为“'+_0x55a7ff[_0x219fd8(0x278)]+_0x219fd8(0xc80)+_0x3a6d5b[_0x219fd8(0x4bc)]+'\x0a\x0a将重置冷静期。'),_0x55a7ff[_0x219fd8(0xa78)][_0x219fd8(0x739)]='blocked_by_user',_0x55a7ff[_0x219fd8(0xa78)][_0x219fd8(0x64c)]=Date[_0x219fd8(0x1182)]();}finally{await _0x2e83f8[_0x219fd8(0x737)][_0x219fd8(0xe3c)](_0x55a7ff),_0x544ab5(_0x3f6042);}}function _0x11d4cf(){const _0x407d48=_0x241b18;if(!_0x5de8b7[_0x407d48(0x93d)])return;const _0x406319=_0x5de8b7[_0x407d48(0x737)][_0x5de8b7[_0x407d48(0x93d)]];_0x406319[_0x407d48(0x1244)]?_0x46b6a0():document[_0x407d48(0x11e3)](_0x407d48(0x2f3))[_0x407d48(0x505)][_0x407d48(0x252)]('visible');}function _0x46b6a0(){const _0x78a60b=_0x241b18,_0x5bd6cc=document[_0x78a60b(0x11e3)]('red-packet-modal'),_0x2e6f89=_0x5de8b7[_0x78a60b(0x737)][_0x5de8b7['activeChatId']];document['getElementById']('rp-group-amount')[_0x78a60b(0xf27)]='',document[_0x78a60b(0x11e3)](_0x78a60b(0x101))[_0x78a60b(0xf27)]='',document[_0x78a60b(0x11e3)](_0x78a60b(0x6b1))[_0x78a60b(0xf27)]='',document[_0x78a60b(0x11e3)](_0x78a60b(0x1216))[_0x78a60b(0xf27)]='',document['getElementById'](_0x78a60b(0x1122))[_0x78a60b(0xf27)]='',document[_0x78a60b(0x11e3)](_0x78a60b(0x4e1))[_0x78a60b(0x300)]='¥\x200.00',document[_0x78a60b(0x11e3)](_0x78a60b(0x277))[_0x78a60b(0x300)]=_0x78a60b(0x221);const _0x47df77=document[_0x78a60b(0x11e3)](_0x78a60b(0x12f4));_0x47df77[_0x78a60b(0x595)]='',_0x2e6f89['members'][_0x78a60b(0x494)](_0x1dd1cc=>{const _0x59a2a3=_0x78a60b,_0x3d8325=document[_0x59a2a3(0x383)](_0x59a2a3(0xd91));_0x3d8325[_0x59a2a3(0xf27)]=_0x1dd1cc[_0x59a2a3(0x697)],_0x3d8325[_0x59a2a3(0x300)]=_0x1dd1cc[_0x59a2a3(0xc8f)],_0x47df77['appendChild'](_0x3d8325);}),document[_0x78a60b(0x11e3)](_0x78a60b(0x5d3))[_0x78a60b(0x1041)](),_0x5bd6cc[_0x78a60b(0x505)][_0x78a60b(0x252)](_0x78a60b(0x250));}async function _0x58bb2e(){const _0xfc24a=_0x241b18,_0x58360e=_0x5de8b7[_0xfc24a(0x737)][_0x5de8b7[_0xfc24a(0x93d)]],_0x4e8136=parseFloat(document['getElementById'](_0xfc24a(0xaee))[_0xfc24a(0xf27)]),_0x35dcde=parseInt(document['getElementById'](_0xfc24a(0x101))['value']),_0x49efc1=document['getElementById'](_0xfc24a(0x6b1))[_0xfc24a(0xf27)]['trim']();if(isNaN(_0x4e8136)||_0x4e8136<=0x0){alert(_0xfc24a(0x48d));return;}if(isNaN(_0x35dcde)||_0x35dcde<=0x0){alert('请输入有效的红包个数！');return;}if(_0x4e8136/_0x35dcde<0.01){alert(_0xfc24a(0x4cc));return;}const _0x4e4bce=_0x58360e['settings']['myNickname']||'我',_0x1e07ae={'role':'user','senderName':_0x4e4bce,'type':_0xfc24a(0x305),'packetType':'lucky','timestamp':Date['now'](),'totalAmount':_0x4e8136,'count':_0x35dcde,'greeting':_0x49efc1||_0xfc24a(0xb10),'claimedBy':{},'isFullyClaimed':![]};_0x58360e[_0xfc24a(0x49e)][_0xfc24a(0xf5)](_0x1e07ae),await _0x2e83f8[_0xfc24a(0x737)]['put'](_0x58360e),_0x3b5153(_0x1e07ae,_0x58360e),_0x5ee219(),document[_0xfc24a(0x11e3)](_0xfc24a(0x2f6))['classList'][_0xfc24a(0x957)]('visible');}async function _0x5bb163(){const _0x35b2ba=_0x241b18,_0x5efed2=_0x5de8b7[_0x35b2ba(0x737)][_0x5de8b7[_0x35b2ba(0x93d)]],_0x39ef27=parseFloat(document[_0x35b2ba(0x11e3)]('rp-direct-amount')['value']),_0x4fbd82=document[_0x35b2ba(0x11e3)](_0x35b2ba(0x12f4))[_0x35b2ba(0xf27)],_0xc46b38=document['getElementById']('rp-direct-greeting')[_0x35b2ba(0xf27)][_0x35b2ba(0xeb7)]();if(isNaN(_0x39ef27)||_0x39ef27<=0x0){alert(_0x35b2ba(0x806));return;}if(!_0x4fbd82){alert(_0x35b2ba(0xa5e));return;}const _0x5a502b=_0x5efed2[_0x35b2ba(0x761)][_0x35b2ba(0xca7)]||'我',_0x3418c1={'role':_0x35b2ba(0x21c),'senderName':_0x5a502b,'type':_0x35b2ba(0x305),'packetType':'direct','timestamp':Date[_0x35b2ba(0x1182)](),'totalAmount':_0x39ef27,'count':0x1,'greeting':_0xc46b38||_0x35b2ba(0xd3e),'receiverName':_0x4fbd82,'claimedBy':{},'isFullyClaimed':![]};_0x5efed2[_0x35b2ba(0x49e)]['push'](_0x3418c1),await _0x2e83f8['chats']['put'](_0x5efed2),_0x3b5153(_0x3418c1,_0x5efed2),_0x5ee219(),document[_0x35b2ba(0x11e3)](_0x35b2ba(0x2f6))[_0x35b2ba(0x505)][_0x35b2ba(0x957)]('visible');}async function _0x319222(_0x2a1895){const _0x569c5b=_0x241b18,_0xba4853=_0x5de8b7['activeChatId'],_0x332267=await _0x2e83f8[_0x569c5b(0x737)][_0x569c5b(0x1289)](_0xba4853);if(!_0x332267)return;_0x5de8b7[_0x569c5b(0x737)][_0xba4853]=_0x332267;const _0x560d68=_0x332267[_0x569c5b(0x49e)][_0x569c5b(0xe79)](_0x24f84a=>_0x24f84a[_0x569c5b(0x702)]===_0x2a1895);if(!_0x560d68)return;const _0x5c9519=_0x5de8b7[_0x569c5b(0x1c5)][_0x569c5b(0xa33)]||_0x569c5b(0x833),_0x491615=_0x560d68[_0x569c5b(0xcf6)]&&_0x560d68[_0x569c5b(0xcf6)][_0x5c9519];if(_0x560d68['packetType']===_0x569c5b(0x978)&&_0x560d68[_0x569c5b(0x1045)]!==_0x5c9519&&Object[_0x569c5b(0xb4a)](_0x560d68[_0x569c5b(0xcf6)])[_0x569c5b(0x594)]>0x0||_0x560d68['isFullyClaimed']||_0x491615){_0x4ef612(_0x560d68);return;}const _0x23dabe=await _0x4f4864(_0x560d68);_0x23dabe!==null&&(await _0x544ab5(_0xba4853),await _0x2fb06(_0x569c5b(0xfbf),_0x569c5b(0x8f1)+_0xd9d60a(_0x332267,_0x560d68[_0x569c5b(0x768)])+_0x569c5b(0x66b)+_0x23dabe['toFixed'](0x2)+_0x569c5b(0x3a8)));const _0x255e2b=_0x5de8b7['chats'][_0xba4853]['history'][_0x569c5b(0xe79)](_0xaf512e=>_0xaf512e[_0x569c5b(0x702)]===_0x2a1895);_0x255e2b&&_0x4ef612(_0x255e2b);}async function _0x4f4864(_0x22d3f7){const _0x2e8bf5=_0x241b18,_0x2e116a=_0x5de8b7[_0x2e8bf5(0x737)][_0x5de8b7[_0x2e8bf5(0x93d)]];let _0x24300e=Date['now']();const _0x75276f=_0x5de8b7[_0x2e8bf5(0x1c5)][_0x2e8bf5(0xa33)]||_0x2e8bf5(0x833),_0x5b72fc=_0x22d3f7[_0x2e8bf5(0xc85)]-Object[_0x2e8bf5(0xb4a)](_0x22d3f7[_0x2e8bf5(0xcf6)]||{})[_0x2e8bf5(0x594)];if(_0x5b72fc<=0x0)return _0x22d3f7['isFullyClaimed']=!![],await _0x2e83f8[_0x2e8bf5(0x737)]['put'](_0x2e116a),await _0x2fb06('手慢了',_0x2e8bf5(0x87d)),null;let _0x2d57fd=0x0;const _0x24068f=_0x22d3f7[_0x2e8bf5(0x3a9)]-Object[_0x2e8bf5(0x4ca)](_0x22d3f7[_0x2e8bf5(0xcf6)]||{})[_0x2e8bf5(0x870)]((_0x51d6a7,_0x33d39b)=>_0x51d6a7+_0x33d39b,0x0);if(_0x22d3f7[_0x2e8bf5(0xc3d)]===_0x2e8bf5(0x9da)){if(_0x5b72fc===0x1)_0x2d57fd=_0x24068f;else{const _0x225faa=0.01,_0x118824=_0x24068f-(_0x5b72fc-0x1)*_0x225faa;_0x2d57fd=Math[_0x2e8bf5(0x36d)]()*(_0x118824-_0x225faa)+_0x225faa;}}else _0x2d57fd=_0x22d3f7[_0x2e8bf5(0x3a9)];_0x2d57fd=parseFloat(_0x2d57fd['toFixed'](0x2));if(!_0x22d3f7[_0x2e8bf5(0xcf6)])_0x22d3f7[_0x2e8bf5(0xcf6)]={};_0x22d3f7[_0x2e8bf5(0xcf6)][_0x75276f]=_0x2d57fd;const _0x3d0b06=Object[_0x2e8bf5(0xb4a)](_0x22d3f7[_0x2e8bf5(0xcf6)])[_0x2e8bf5(0x594)]>=_0x22d3f7[_0x2e8bf5(0xc85)];_0x3d0b06&&(_0x22d3f7[_0x2e8bf5(0x5e7)]=!![]);const _0xc126f0=_0xd9d60a(_0x2e116a,_0x75276f),_0x29b115=_0xd9d60a(_0x2e116a,_0x22d3f7[_0x2e8bf5(0x768)]),_0x398b93={'role':'system','type':_0x2e8bf5(0x8ee),'content':_0x2e8bf5(0x8f1)+_0x29b115+'\x20的红包','timestamp':_0x24300e++};_0x2e116a[_0x2e8bf5(0x49e)]['push'](_0x398b93);let _0x135727;if(_0x3d0b06){const _0x37465d={'role':_0x2e8bf5(0xf72),'type':_0x2e8bf5(0x8ee),'content':_0x29b115+_0x2e8bf5(0x9c8),'timestamp':_0x24300e++};_0x2e116a[_0x2e8bf5(0x49e)][_0x2e8bf5(0xf5)](_0x37465d);let _0x2dc27f={'name':'','amount':-0x1};_0x22d3f7[_0x2e8bf5(0xc3d)]==='lucky'&&_0x22d3f7[_0x2e8bf5(0xc85)]>0x1&&Object[_0x2e8bf5(0x560)](_0x22d3f7[_0x2e8bf5(0xcf6)])[_0x2e8bf5(0x494)](([_0x489fb5,_0x399d6f])=>{const _0x31bece=_0x2e8bf5;_0x399d6f>_0x2dc27f[_0x31bece(0x354)]&&(_0x2dc27f={'name':_0x489fb5,'amount':_0x399d6f});});const _0x4fb1cd=_0x2dc27f['name']?_0xd9d60a(_0x2e116a,_0x2dc27f[_0x2e8bf5(0x278)]):'无';_0x135727=_0x2e8bf5(0x430)+_0xc126f0+_0x2e8bf5(0x6ee)+_0x4fb1cd+'！请对此事件发表评论。]';}else _0x135727='[系统提示：用户\x20('+_0xc126f0+_0x2e8bf5(0x2ff)+_0x22d3f7[_0x2e8bf5(0x702)]+')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]';const _0x1f5ec6={'role':_0x2e8bf5(0xf72),'content':_0x135727,'timestamp':_0x24300e++,'isHidden':!![]};return _0x2e116a[_0x2e8bf5(0x49e)][_0x2e8bf5(0xf5)](_0x1f5ec6),await _0x2e83f8[_0x2e8bf5(0x737)][_0x2e8bf5(0xe3c)](_0x2e116a),_0x2d57fd;}async function _0x4ef612(_0x306a90){const _0x575c40=_0x241b18;if(!_0x306a90){console[_0x575c40(0x1c1)](_0x575c40(0x166));return;}const _0x43af88=_0x5de8b7[_0x575c40(0x737)][_0x5de8b7['activeChatId']];if(!_0x43af88)return;const _0x5fecc9=document[_0x575c40(0x11e3)](_0x575c40(0x336)),_0x87566a=_0x5de8b7['qzoneSettings'][_0x575c40(0xa33)]||'{{user}}',_0x51451e=_0xd9d60a(_0x43af88,_0x306a90[_0x575c40(0x768)]);document[_0x575c40(0x11e3)](_0x575c40(0x75e))[_0x575c40(0x300)]=_0x51451e,document['getElementById'](_0x575c40(0x718))['textContent']=_0x306a90[_0x575c40(0x11f1)]||_0x575c40(0xb10);const _0x34bbf6=document[_0x575c40(0x11e3)](_0x575c40(0xf4));_0x306a90[_0x575c40(0xcf6)]&&_0x306a90['claimedBy'][_0x87566a]?(_0x34bbf6['querySelector'](_0x575c40(0x11f9))['textContent']=_0x306a90['claimedBy'][_0x87566a][_0x575c40(0x200)](0x2),_0x34bbf6[_0x575c40(0x794)][_0x575c40(0x33d)]='block'):_0x34bbf6['style'][_0x575c40(0x33d)]=_0x575c40(0x379);const _0x5a9dc7=Object[_0x575c40(0xb4a)](_0x306a90[_0x575c40(0xcf6)]||{})[_0x575c40(0x594)],_0x127e17=Object['values'](_0x306a90[_0x575c40(0xcf6)]||{})[_0x575c40(0x870)]((_0x3e6cf0,_0x50b8c1)=>_0x3e6cf0+_0x50b8c1,0x0);let _0xd73a2a=_0x5a9dc7+'/'+_0x306a90[_0x575c40(0xc85)]+_0x575c40(0x48c)+_0x127e17[_0x575c40(0x200)](0x2)+'/'+_0x306a90['totalAmount'][_0x575c40(0x200)](0x2)+'元。';if(!_0x306a90[_0x575c40(0x5e7)]&&_0x5a9dc7<_0x306a90[_0x575c40(0xc85)]){const _0x2ac718=Math[_0x575c40(0xfb1)]((_0x306a90[_0x575c40(0x702)]+0x18*0x3c*0x3c*0x3e8-Date[_0x575c40(0x1182)]())/(0x3e8*0x3c*0x3c));if(_0x2ac718>0x0)_0xd73a2a+=_0x575c40(0xcf2)+_0x2ac718+'小时内退还。';}document['getElementById'](_0x575c40(0x19e))[_0x575c40(0x300)]=_0xd73a2a;const _0x435789=document[_0x575c40(0x11e3)](_0x575c40(0xc03));_0x435789['innerHTML']='';const _0x23911a=Object[_0x575c40(0x560)](_0x306a90[_0x575c40(0xcf6)]||{});let _0x494b32={'name':'','amount':-0x1};_0x306a90[_0x575c40(0xc3d)]==='lucky'&&_0x306a90['isFullyClaimed']&&_0x23911a[_0x575c40(0x594)]>0x1&&_0x23911a[_0x575c40(0x494)](([_0x465d7e,_0x452fd8])=>{const _0x5c21a0=_0x575c40;_0x452fd8>_0x494b32[_0x5c21a0(0x354)]&&(_0x494b32={'name':_0x465d7e,'amount':_0x452fd8});}),_0x23911a[_0x575c40(0x861)]((_0x1ee799,_0x503ff8)=>_0x503ff8[0x1]-_0x1ee799[0x1]),_0x23911a['forEach'](([_0x44a786,_0x53acd0])=>{const _0x2e538f=_0x575c40,_0x4a3b51=document['createElement'](_0x2e538f(0x1285));_0x4a3b51['className']='rp-details-item';let _0xfb5af3='';_0x494b32[_0x2e538f(0x278)]&&_0x44a786===_0x494b32[_0x2e538f(0x278)]&&(_0xfb5af3=_0x2e538f(0xaa2));const _0x370f59=_0xd9d60a(_0x43af88,_0x44a786);_0x4a3b51[_0x2e538f(0x595)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x370f59+_0x2e538f(0xfdd)+_0x53acd0[_0x2e538f(0x200)](0x2)+'\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xfb5af3+_0x2e538f(0x91e),_0x435789[_0x2e538f(0x120c)](_0x4a3b51);}),_0x5fecc9[_0x575c40(0x505)][_0x575c40(0x252)](_0x575c40(0x250));}document[_0x241b18(0x11e3)](_0x241b18(0x281))[_0x241b18(0x4b8)](_0x241b18(0x1041),()=>{const _0x4f21c5=_0x241b18;document['getElementById'](_0x4f21c5(0x336))[_0x4f21c5(0x505)][_0x4f21c5(0x957)](_0x4f21c5(0x250));}),window[_0x241b18(0xde4)]=_0x319222;function _0x2e13a5(){const _0x51b866=_0x241b18,_0x4eca6a=document[_0x51b866(0x11e3)](_0x51b866(0xe18));document[_0x51b866(0x11e3)](_0x51b866(0x165))['value']='';const _0x3d2822=document[_0x51b866(0x11e3)](_0x51b866(0x1277));_0x3d2822['innerHTML']='',_0x502d9e(),_0x502d9e(),_0x4eca6a[_0x51b866(0x505)][_0x51b866(0x252)](_0x51b866(0x250));}function _0x502d9e(){const _0xa1593e=_0x241b18,_0x52d4b0=document[_0xa1593e(0x11e3)](_0xa1593e(0x1277)),_0x29ec55=document[_0xa1593e(0x383)](_0xa1593e(0x1285));_0x29ec55[_0xa1593e(0x3db)]='poll-option-input-wrapper',_0x29ec55['innerHTML']=_0xa1593e(0x109a),_0x29ec55['querySelector'](_0xa1593e(0xa49))['addEventListener'](_0xa1593e(0x1041),()=>{const _0x5b7776=_0xa1593e;_0x52d4b0[_0x5b7776(0x7b5)][_0x5b7776(0x594)]>0x2?_0x29ec55[_0x5b7776(0x957)]():alert(_0x5b7776(0x2b5));}),_0x52d4b0['appendChild'](_0x29ec55);}async function _0x3a7360(){const _0x53c355=_0x241b18;if(!_0x5de8b7[_0x53c355(0x93d)])return;const _0x238a6d=document['getElementById'](_0x53c355(0x165))[_0x53c355(0xf27)][_0x53c355(0xeb7)]();if(!_0x238a6d){alert(_0x53c355(0x135));return;}const _0x2e7792=Array['from'](document[_0x53c355(0x10d6)](_0x53c355(0x8b9)))[_0x53c355(0x796)](_0x51f9b9=>_0x51f9b9['value'][_0x53c355(0xeb7)]())['filter'](_0x3586f0=>_0x3586f0);if(_0x2e7792[_0x53c355(0x594)]<0x2){alert(_0x53c355(0x1203));return;}const _0x4dac3e=_0x5de8b7['chats'][_0x5de8b7['activeChatId']],_0x204151=_0x4dac3e[_0x53c355(0x1244)]?_0x4dac3e['settings']['myNickname']||'我':'我',_0x1419a2={'role':_0x53c355(0x21c),'senderName':_0x204151,'type':_0x53c355(0xcc5),'timestamp':Date[_0x53c355(0x1182)](),'question':_0x238a6d,'options':_0x2e7792,'votes':{},'isClosed':![]};_0x4dac3e[_0x53c355(0x49e)][_0x53c355(0xf5)](_0x1419a2),await _0x2e83f8['chats'][_0x53c355(0xe3c)](_0x4dac3e),_0x3b5153(_0x1419a2,_0x4dac3e),_0x5ee219(),document[_0x53c355(0x11e3)](_0x53c355(0xe18))[_0x53c355(0x505)]['remove'](_0x53c355(0x250));}async function _0x2bb64b(_0x278693,_0x210dd1){const _0x368ffa=_0x241b18,_0x453dd5=_0x5de8b7[_0x368ffa(0x737)][_0x5de8b7[_0x368ffa(0x93d)]],_0x25a82a=_0x453dd5['history'][_0x368ffa(0xe79)](_0x5762a5=>_0x5762a5['timestamp']===_0x278693),_0x40cbf2=_0x453dd5[_0x368ffa(0x1244)]?_0x453dd5[_0x368ffa(0x761)][_0x368ffa(0xca7)]||'我':'我';if(!_0x25a82a||_0x25a82a[_0x368ffa(0xdf0)]){_0x25a82a&&_0x25a82a[_0x368ffa(0xdf0)]&&_0xc52ad(_0x278693);return;}const _0x14a539=_0x25a82a['votes'][_0x210dd1]&&_0x25a82a[_0x368ffa(0x510)][_0x210dd1][_0x368ffa(0x3ad)](_0x40cbf2);if(!_0x14a539){for(const _0x23dce8 in _0x25a82a['votes']){const _0x41e1ad=_0x25a82a[_0x368ffa(0x510)][_0x23dce8][_0x368ffa(0xce1)](_0x40cbf2);_0x41e1ad>-0x1&&_0x25a82a[_0x368ffa(0x510)][_0x23dce8][_0x368ffa(0xfd0)](_0x41e1ad,0x1);}!_0x25a82a[_0x368ffa(0x510)][_0x210dd1]&&(_0x25a82a[_0x368ffa(0x510)][_0x210dd1]=[]),_0x25a82a['votes'][_0x210dd1][_0x368ffa(0xf5)](_0x40cbf2);}let _0x111b74=null;!_0x14a539&&(_0x111b74=_0x368ffa(0x430)+_0x40cbf2+')\x20刚刚投票给了\x20“'+_0x210dd1+'”。]');if(_0x111b74){const _0x269914={'role':'system','content':_0x111b74,'timestamp':Date[_0x368ffa(0x1182)](),'isHidden':!![]};_0x453dd5[_0x368ffa(0x49e)][_0x368ffa(0xf5)](_0x269914);}await _0x2e83f8['chats'][_0x368ffa(0xe3c)](_0x453dd5),_0x544ab5(_0x5de8b7['activeChatId']);}async function _0x54948(_0x297dd8){const _0x1102fe=_0x241b18,_0x9c6e8e=_0x5de8b7[_0x1102fe(0x737)][_0x5de8b7[_0x1102fe(0x93d)]],_0x273e94=_0x9c6e8e['history'][_0x1102fe(0xe79)](_0x295f69=>_0x295f69['timestamp']===_0x297dd8);if(!_0x273e94||_0x273e94[_0x1102fe(0xdf0)])return;const _0x1f940f=await _0x58fd60(_0x1102fe(0xb2f),_0x1102fe(0x91c));if(_0x1f940f){_0x273e94[_0x1102fe(0xdf0)]=!![];const _0x591541=_0x273e94['options'][_0x1102fe(0x796)](_0x352a57=>'“'+_0x352a57+'”('+(_0x273e94[_0x1102fe(0x510)][_0x352a57]?.['length']||0x0)+'票)')[_0x1102fe(0xa4b)]('，'),_0xc006e1=_0x1102fe(0x52e)+_0x591541+'。]',_0xfdca0b={'role':'system','content':_0xc006e1,'timestamp':Date['now'](),'isHidden':!![]};_0x9c6e8e[_0x1102fe(0x49e)]['push'](_0xfdca0b),await _0x2e83f8[_0x1102fe(0x737)][_0x1102fe(0xe3c)](_0x9c6e8e),_0x544ab5(_0x5de8b7[_0x1102fe(0x93d)]);}}function _0xc52ad(_0x5b5a06){const _0x2a5601=_0x241b18,_0x34cabe=_0x5de8b7[_0x2a5601(0x737)][_0x5de8b7['activeChatId']],_0x124049=_0x34cabe[_0x2a5601(0x49e)][_0x2a5601(0xe79)](_0x4db1b1=>_0x4db1b1[_0x2a5601(0x702)]===_0x5b5a06);if(!_0x124049||!_0x124049['isClosed'])return;let _0x12e5ef='<p><strong>'+_0x124049[_0x2a5601(0xdb5)]+_0x2a5601(0xe34);Object['keys'](_0x124049[_0x2a5601(0x510)])[_0x2a5601(0x594)]===0x0?_0x12e5ef+=_0x2a5601(0x590):_0x124049[_0x2a5601(0x11a1)][_0x2a5601(0x494)](_0x4ed771=>{const _0x2ee9ee=_0x2a5601,_0x3bc100=_0x124049[_0x2ee9ee(0x510)][_0x4ed771]||[],_0xf89e6e=_0x3bc100[_0x2ee9ee(0x796)](_0x3f9219=>_0xd9d60a(_0x34cabe,_0x3f9219))[_0x2ee9ee(0xa4b)]('、\x20');_0x12e5ef+=_0x2ee9ee(0x468)+_0x4ed771+'\x20('+_0x3bc100[_0x2ee9ee(0x594)]+'票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3bc100[_0x2ee9ee(0x594)]>0x0?_0xf89e6e:'无人投票')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x2fb06(_0x2a5601(0xa69),_0x12e5ef);}function _0x22ed99(){const _0x279690=_0x241b18;if(!_0x5de8b7[_0x279690(0x93d)])return;const _0x2f963f=_0x5de8b7[_0x279690(0x737)][_0x5de8b7[_0x279690(0x93d)]];document[_0x279690(0x11e3)](_0x279690(0xf15))['textContent']='“'+_0x2f963f['name']+_0x279690(0x446),_0x3c9732(),document[_0x279690(0x11e3)]('ai-avatar-library-modal')[_0x279690(0x505)]['add']('visible');}function _0x3c9732(){const _0x4258b2=_0x241b18,_0x549ee6=document[_0x4258b2(0x11e3)]('ai-avatar-library-grid');_0x549ee6[_0x4258b2(0x595)]='';const _0x590607=_0x5de8b7[_0x4258b2(0x737)][_0x5de8b7[_0x4258b2(0x93d)]],_0x419113=_0x590607[_0x4258b2(0x761)][_0x4258b2(0xe6d)]||[];if(_0x419113[_0x4258b2(0x594)]===0x0){_0x549ee6[_0x4258b2(0x595)]=_0x4258b2(0xf1a);return;}_0x419113[_0x4258b2(0x494)]((_0x2a7f5e,_0x482c20)=>{const _0x555941=_0x4258b2,_0x3b8439=document['createElement'](_0x555941(0x1285));_0x3b8439[_0x555941(0x3db)]=_0x555941(0x10bf),_0x3b8439[_0x555941(0x740)]=_0x2a7f5e['name'],_0x3b8439[_0x555941(0x595)]=_0x555941(0x83b)+_0x2a7f5e[_0x555941(0x10ac)]+_0x555941(0x116c)+_0x2a7f5e[_0x555941(0x278)]+_0x555941(0x8e8);const _0x4df1a0=document[_0x555941(0x383)]('div');_0x4df1a0['className']=_0x555941(0xf28),_0x4df1a0[_0x555941(0x595)]='×',_0x4df1a0[_0x555941(0x794)]['display']=_0x555941(0x11ac),_0x4df1a0[_0x555941(0x1074)]=async _0x268479=>{const _0x2be7cd=_0x555941;_0x268479['stopPropagation']();const _0x57fa20=await _0x58fd60('删除头像',_0x2be7cd(0xc30)+_0x2a7f5e[_0x2be7cd(0x278)]+_0x2be7cd(0x605),{'confirmButtonClass':_0x2be7cd(0x8a6)});_0x57fa20&&(_0x590607[_0x2be7cd(0x761)][_0x2be7cd(0xe6d)][_0x2be7cd(0xfd0)](_0x482c20,0x1),await _0x2e83f8[_0x2be7cd(0x737)][_0x2be7cd(0xe3c)](_0x590607),_0x3c9732());},_0x3b8439['appendChild'](_0x4df1a0),_0x549ee6[_0x555941(0x120c)](_0x3b8439);});}async function _0x13c036(){const _0x5d0f1d=_0x241b18,_0x44d6ad=await _0x231a5a(_0x5d0f1d(0x913),'请为这个头像起个名字（例如：开心、哭泣）');if(!_0x44d6ad||!_0x44d6ad[_0x5d0f1d(0xeb7)]())return;const _0x23c84b=await _0x231a5a('添加头像','请输入头像的图片URL','',_0x5d0f1d(0x10ac));if(!_0x23c84b||!_0x23c84b['trim']()[_0x5d0f1d(0xb6c)](_0x5d0f1d(0xd5))){alert(_0x5d0f1d(0xaf3));return;}const _0x39979d=_0x5de8b7[_0x5d0f1d(0x737)][_0x5de8b7[_0x5d0f1d(0x93d)]];!_0x39979d[_0x5d0f1d(0x761)][_0x5d0f1d(0xe6d)]&&(_0x39979d[_0x5d0f1d(0x761)][_0x5d0f1d(0xe6d)]=[]),_0x39979d['settings'][_0x5d0f1d(0xe6d)][_0x5d0f1d(0xf5)]({'name':_0x44d6ad['trim'](),'url':_0x23c84b[_0x5d0f1d(0xeb7)]()}),await _0x2e83f8[_0x5d0f1d(0x737)]['put'](_0x39979d),_0x3c9732();}function _0x2ccef2(){const _0x3e5968=_0x241b18;document[_0x3e5968(0x11e3)]('ai-avatar-library-modal')['classList'][_0x3e5968(0x957)](_0x3e5968(0x250));}function _0x2e3203(){const _0x5c5a87=_0x241b18;if(!_0x5de8b7['activeChatId'])return;const _0x5391f8=_0x5de8b7['chats'][_0x5de8b7[_0x5c5a87(0x93d)]];document[_0x5c5a87(0x11e3)](_0x5c5a87(0x52f))['textContent']='“'+(_0x5391f8[_0x5c5a87(0x761)][_0x5c5a87(0xca7)]||'我')+'”的头像库',_0x25be9e(),document[_0x5c5a87(0x11e3)](_0x5c5a87(0xd2a))[_0x5c5a87(0x505)]['add']('visible');}function _0x25be9e(){const _0xafc442=_0x241b18,_0x352433=document['getElementById'](_0xafc442(0x11d8));_0x352433[_0xafc442(0x595)]='';const _0x170bae=_0x5de8b7[_0xafc442(0x737)][_0x5de8b7[_0xafc442(0x93d)]],_0x1b065e=_0x170bae['settings'][_0xafc442(0xdc3)]||[];if(_0x1b065e[_0xafc442(0x594)]===0x0){_0x352433['innerHTML']=_0xafc442(0xf1a);return;}_0x1b065e[_0xafc442(0x494)]((_0x2e05bc,_0x474812)=>{const _0x249291=_0xafc442,_0xa3c4be=document['createElement'](_0x249291(0x1285));_0xa3c4be[_0x249291(0x3db)]=_0x249291(0x10bf),_0xa3c4be[_0x249291(0x740)]=_0x2e05bc[_0x249291(0x278)],_0xa3c4be[_0x249291(0x595)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url('+_0x2e05bc[_0x249291(0x10ac)]+_0x249291(0x116c)+_0x2e05bc['name']+_0x249291(0x8e8);const _0xfac96b=document[_0x249291(0x383)](_0x249291(0x1285));_0xfac96b[_0x249291(0x3db)]=_0x249291(0xf28),_0xfac96b[_0x249291(0x595)]='×',_0xfac96b['style'][_0x249291(0x33d)]=_0x249291(0x11ac),_0xfac96b['onclick']=async _0x12ccb7=>{const _0x324bae=_0x249291;_0x12ccb7[_0x324bae(0x7cb)]();const _0x3a4eba=await _0x58fd60('删除头像','确定要从你的头像库中删除“'+_0x2e05bc['name']+_0x324bae(0x605),{'confirmButtonClass':_0x324bae(0x8a6)});_0x3a4eba&&(_0x170bae['settings'][_0x324bae(0xdc3)][_0x324bae(0xfd0)](_0x474812,0x1),await _0x2e83f8[_0x324bae(0x737)][_0x324bae(0xe3c)](_0x170bae),_0x25be9e());},_0xa3c4be[_0x249291(0x120c)](_0xfac96b),_0x352433['appendChild'](_0xa3c4be);});}async function _0x180cc7(){const _0x3aa00e=_0x241b18,_0x73f4e1=await _0x231a5a(_0x3aa00e(0x913),_0x3aa00e(0x11d9));if(!_0x73f4e1||!_0x73f4e1[_0x3aa00e(0xeb7)]())return;const _0x47d2a8=await _0x231a5a(_0x3aa00e(0x913),_0x3aa00e(0xbdc),'','url');if(!_0x47d2a8||!_0x47d2a8[_0x3aa00e(0xeb7)]()[_0x3aa00e(0xb6c)]('http')){alert(_0x3aa00e(0xaf3));return;}const _0x1dd633=_0x5de8b7[_0x3aa00e(0x737)][_0x5de8b7[_0x3aa00e(0x93d)]];!_0x1dd633[_0x3aa00e(0x761)][_0x3aa00e(0xdc3)]&&(_0x1dd633[_0x3aa00e(0x761)][_0x3aa00e(0xdc3)]=[]),_0x1dd633['settings'][_0x3aa00e(0xdc3)][_0x3aa00e(0xf5)]({'name':_0x73f4e1[_0x3aa00e(0xeb7)](),'url':_0x47d2a8[_0x3aa00e(0xeb7)]()}),await _0x2e83f8['chats'][_0x3aa00e(0xe3c)](_0x1dd633),_0x25be9e();}async function _0x129866(_0x24d929){const _0xe2dea1=_0x241b18,_0x1b3811=_0x24d929[_0xe2dea1(0xd7c)]['files'][0x0];if(!_0x1b3811)return;const _0x13994c=await new Promise(_0x17cdef=>{const _0x2e20d9=_0xe2dea1,_0x4f21be=new FileReader();_0x4f21be[_0x2e20d9(0x1e5)]=()=>_0x17cdef(_0x4f21be[_0x2e20d9(0x255)]),_0x4f21be[_0x2e20d9(0x1270)](_0x1b3811);}),_0x11dc3d=await _0x231a5a(_0xe2dea1(0x339),_0xe2dea1(0x11a5));if(!_0x11dc3d||!_0x11dc3d[_0xe2dea1(0xeb7)]())return;const _0x367c09=_0x5de8b7[_0xe2dea1(0x737)][_0x5de8b7[_0xe2dea1(0x93d)]];!_0x367c09[_0xe2dea1(0x761)][_0xe2dea1(0xdc3)]&&(_0x367c09[_0xe2dea1(0x761)]['myAvatarLibrary']=[]),_0x367c09['settings'][_0xe2dea1(0xdc3)][_0xe2dea1(0xf5)]({'name':_0x11dc3d[_0xe2dea1(0xeb7)](),'url':_0x13994c}),await _0x2e83f8[_0xe2dea1(0x737)][_0xe2dea1(0xe3c)](_0x367c09),_0x25be9e(),_0x24d929[_0xe2dea1(0xd7c)][_0xe2dea1(0xf27)]=null;}async function _0x5b7f51(_0x2ec6b9){const _0x499c78=_0x241b18,_0x47a5c3=_0x5de8b7[_0x499c78(0x737)][_0x5de8b7[_0x499c78(0x93d)]];if(!_0x47a5c3)return;const _0x5de6da=_0x2ec6b9[_0x499c78(0xeb7)]()[_0x499c78(0x65b)]('\x0a'),_0x56f190=[],_0x116f3f='https://files.catbox.moe/';let _0x398710=0x0;for(const _0x10422f of _0x5de6da){const _0xa4c5c6=_0x10422f[_0x499c78(0xeb7)]();if(!_0xa4c5c6||_0xa4c5c6[_0x499c78(0x3ad)](_0x499c78(0xd5))||_0xa4c5c6[_0x499c78(0x3ad)]('填入'))continue;let _0x2c2af5=null,_0x40a4cb=null;const _0x160a50=_0xa4c5c6['match'](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x160a50)_0x2c2af5=_0x160a50[0x1],_0x40a4cb=_0x160a50[0x2];else{const _0x276e0c=_0xa4c5c6[_0x499c78(0x65b)](/\s+/);_0x276e0c[_0x499c78(0x594)]>=0x2&&(_0x40a4cb=_0x276e0c[_0x499c78(0x647)](),_0x2c2af5=_0x276e0c[_0x499c78(0xa4b)]('\x20'));}_0x2c2af5&&_0x40a4cb&&_0x40a4cb[_0x499c78(0x3ad)]('.')?_0x56f190['push']({'name':_0x2c2af5,'url':_0x116f3f+_0x40a4cb}):_0x398710++;}if(_0x398710>0x0)await _0x2fb06('部分导入失败','有\x20'+_0x398710+_0x499c78(0xe61));if(_0x56f190[_0x499c78(0x594)]>0x0){if(!_0x47a5c3[_0x499c78(0x761)]['myAvatarLibrary'])_0x47a5c3[_0x499c78(0x761)][_0x499c78(0xdc3)]=[];_0x47a5c3[_0x499c78(0x761)][_0x499c78(0xdc3)]['push'](..._0x56f190),await _0x2e83f8['chats'][_0x499c78(0xe3c)](_0x47a5c3),_0x25be9e(),await _0x2fb06(_0x499c78(0xb5e),'已成功批量导入\x20'+_0x56f190[_0x499c78(0x594)]+_0x499c78(0x4af));}else _0x398710===0x0&&alert(_0x499c78(0x5dd));}function _0x587a30(){const _0x1a981c=_0x241b18;document['getElementById'](_0x1a981c(0xd2a))[_0x1a981c(0x505)][_0x1a981c(0x957)](_0x1a981c(0x250));}function _0x5a3a52(){const _0x5b2550=_0x241b18;if(!_0x5de8b7[_0x5b2550(0x93d)])return;const _0x122273=_0x5de8b7['chats'][_0x5de8b7['activeChatId']];document[_0x5b2550(0x11e3)](_0x5b2550(0x998))[_0x5b2550(0x300)]='“'+_0x122273[_0x5b2550(0x278)]+_0x5b2550(0x446),_0x4fd61d(),document[_0x5b2550(0x11e3)](_0x5b2550(0xf48))['classList']['add'](_0x5b2550(0x250));}function _0x4fd61d(){const _0x107f35=_0x241b18,_0x2d3b46=document[_0x107f35(0x11e3)](_0x107f35(0x930));_0x2d3b46[_0x107f35(0x595)]='';const _0x1c81a2=_0x5de8b7[_0x107f35(0x737)][_0x5de8b7[_0x107f35(0x93d)]],_0xc156b8=_0x1c81a2['settings']['groupAvatarLibrary']||[];if(_0xc156b8[_0x107f35(0x594)]===0x0){_0x2d3b46[_0x107f35(0x595)]=_0x107f35(0xf1a);return;}_0xc156b8[_0x107f35(0x494)]((_0x4aa43a,_0x9f8671)=>{const _0xc2dcea=_0x107f35,_0x1076b7=document[_0xc2dcea(0x383)](_0xc2dcea(0x1285));_0x1076b7['className']='sticker-item',_0x1076b7['title']=_0x4aa43a['name'],_0x1076b7['innerHTML']=_0xc2dcea(0x83b)+_0x4aa43a[_0xc2dcea(0x10ac)]+_0xc2dcea(0x116c)+_0x4aa43a[_0xc2dcea(0x278)]+_0xc2dcea(0x8e8);const _0x1427ff=document[_0xc2dcea(0x383)](_0xc2dcea(0x1285));_0x1427ff[_0xc2dcea(0x3db)]=_0xc2dcea(0xf28),_0x1427ff[_0xc2dcea(0x595)]='×',_0x1427ff[_0xc2dcea(0x794)][_0xc2dcea(0x33d)]=_0xc2dcea(0x11ac),_0x1427ff[_0xc2dcea(0x1074)]=async _0x155cdf=>{const _0x2b430d=_0xc2dcea;_0x155cdf[_0x2b430d(0x7cb)]();const _0x210af7=await _0x58fd60(_0x2b430d(0x1054),_0x2b430d(0xc30)+_0x4aa43a['name']+_0x2b430d(0x605),{'confirmButtonClass':_0x2b430d(0x8a6)});_0x210af7&&(_0x1c81a2['settings']['groupAvatarLibrary'][_0x2b430d(0xfd0)](_0x9f8671,0x1),await _0x2e83f8[_0x2b430d(0x737)]['put'](_0x1c81a2),_0x4fd61d());},_0x1076b7[_0xc2dcea(0x120c)](_0x1427ff),_0x2d3b46['appendChild'](_0x1076b7);});}async function _0x5d461f(){const _0xc1dfc9=_0x241b18,_0x1a266a=await _0x231a5a(_0xc1dfc9(0x913),'请为这个头像起个名字（例如：春日野餐、学习时间）');if(!_0x1a266a||!_0x1a266a[_0xc1dfc9(0xeb7)]())return;const _0x42d268=await _0x231a5a('添加头像',_0xc1dfc9(0xbdc),'',_0xc1dfc9(0x10ac));if(!_0x42d268||!_0x42d268['trim']()[_0xc1dfc9(0xb6c)](_0xc1dfc9(0xd5))){alert('请输入有效的图片URL！');return;}const _0x1c001a=_0x5de8b7[_0xc1dfc9(0x737)][_0x5de8b7[_0xc1dfc9(0x93d)]];!_0x1c001a['settings'][_0xc1dfc9(0x86c)]&&(_0x1c001a[_0xc1dfc9(0x761)][_0xc1dfc9(0x86c)]=[]),_0x1c001a['settings']['groupAvatarLibrary'][_0xc1dfc9(0xf5)]({'name':_0x1a266a['trim'](),'url':_0x42d268[_0xc1dfc9(0xeb7)]()}),await _0x2e83f8['chats'][_0xc1dfc9(0xe3c)](_0x1c001a),_0x4fd61d();}function _0x1184c7(){const _0x34c01a=_0x241b18;document['getElementById'](_0x34c01a(0xf48))['classList']['remove'](_0x34c01a(0x250));}async function _0x5d1875(_0x132e74){const _0x3a69b7=_0x241b18,_0x5ef795=_0x3a69b7(0xb88),_0x1cb6d6=await _0x231a5a('批量导入头像',_0x5ef795,'',_0x3a69b7(0x10bb));_0x1cb6d6&&_0x1cb6d6[_0x3a69b7(0xeb7)]()&&await _0x1a2cb1(_0x132e74,_0x1cb6d6);}async function _0x1a2cb1(_0x2937c6,_0xf070c3){const _0x2d4894=_0x241b18,_0x28bf11=_0x5de8b7[_0x2d4894(0x737)][_0x5de8b7['activeChatId']];if(!_0x28bf11)return;const _0x477a61=_0xf070c3[_0x2d4894(0xeb7)]()[_0x2d4894(0x65b)]('\x0a'),_0x30c1d0=[],_0x166453='https://files.catbox.moe/';let _0x420be3=0x0;for(const _0x5124dc of _0x477a61){const _0x2fb154=_0x5124dc[_0x2d4894(0xeb7)]();if(!_0x2fb154||_0x2fb154[_0x2d4894(0x3ad)]('http')||_0x2fb154[_0x2d4894(0x3ad)]('填入'))continue;let _0x4ecf38=null,_0x29447f=null;const _0x5bd755=_0x2fb154[_0x2d4894(0xe9f)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x5bd755)_0x4ecf38=_0x5bd755[0x1],_0x29447f=_0x5bd755[0x2];else{const _0x348622=_0x2fb154[_0x2d4894(0x65b)](/\s+/);_0x348622[_0x2d4894(0x594)]>=0x2&&(_0x29447f=_0x348622['pop'](),_0x4ecf38=_0x348622[_0x2d4894(0xa4b)]('\x20'));}_0x4ecf38&&_0x29447f&&_0x29447f[_0x2d4894(0x3ad)]('.')?_0x30c1d0[_0x2d4894(0xf5)]({'name':_0x4ecf38,'url':_0x166453+_0x29447f}):(_0x420be3++,console[_0x2d4894(0x6b0)]('批量导入格式错误，已跳过此行:',_0x2fb154));}_0x420be3>0x0&&await _0x2fb06(_0x2d4894(0x3dc),'有\x20'+_0x420be3+_0x2d4894(0xc19));if(_0x30c1d0[_0x2d4894(0x594)]>0x0){if(_0x2937c6==='ai'){if(!_0x28bf11['settings'][_0x2d4894(0xe6d)])_0x28bf11[_0x2d4894(0x761)][_0x2d4894(0xe6d)]=[];_0x28bf11[_0x2d4894(0x761)][_0x2d4894(0xe6d)][_0x2d4894(0xf5)](..._0x30c1d0),await _0x2e83f8[_0x2d4894(0x737)][_0x2d4894(0xe3c)](_0x28bf11),_0x3c9732();}else{if(_0x2937c6===_0x2d4894(0x264)){if(!_0x28bf11[_0x2d4894(0x761)][_0x2d4894(0x86c)])_0x28bf11['settings'][_0x2d4894(0x86c)]=[];_0x28bf11[_0x2d4894(0x761)]['groupAvatarLibrary'][_0x2d4894(0xf5)](..._0x30c1d0),await _0x2e83f8[_0x2d4894(0x737)]['put'](_0x28bf11),_0x4fd61d();}}await _0x2fb06(_0x2d4894(0xb5e),_0x2d4894(0x3b5)+_0x30c1d0[_0x2d4894(0x594)]+'\x20个新头像！');}else _0x420be3===0x0&&alert('没有找到可导入的内容。请检查您粘贴的格式是否正确。');}async function _0x15ec82(){const _0x441428=_0x241b18,_0x203b2d=await _0x231a5a('添加头像','请为这个头像起个名字（例如：春日野餐、学习时间）');if(!_0x203b2d||!_0x203b2d[_0x441428(0xeb7)]())return;const _0x89a2bc=await _0x231a5a(_0x441428(0x913),_0x441428(0xbdc),'',_0x441428(0x10ac));if(!_0x89a2bc||!_0x89a2bc[_0x441428(0xeb7)]()[_0x441428(0xb6c)]('http')){alert(_0x441428(0xaf3));return;}const _0xb81f44=_0x5de8b7[_0x441428(0x737)][_0x5de8b7[_0x441428(0x93d)]];!_0xb81f44[_0x441428(0x761)][_0x441428(0x86c)]&&(_0xb81f44[_0x441428(0x761)][_0x441428(0x86c)]=[]),_0xb81f44[_0x441428(0x761)][_0x441428(0x86c)]['push']({'name':_0x203b2d[_0x441428(0xeb7)](),'url':_0x89a2bc[_0x441428(0xeb7)]()}),await _0x2e83f8[_0x441428(0x737)]['put'](_0xb81f44),_0x4fd61d();}function _0x5836e4(_0x2d86e2){return new Promise(_0x20081e=>{const _0x5e9741=_0x10a9,_0x3c9426=document[_0x5e9741(0x11e3)]('chat-list-actions-modal'),_0x5be546=document[_0x5e9741(0x11e3)](_0x5e9741(0x12dc)),_0x5969c3=document[_0x5e9741(0x11e3)](_0x5e9741(0x303)),_0x3234d9=document['getElementById'](_0x5e9741(0x2e1));_0x5be546[_0x5e9741(0x300)]=_0x2d86e2[_0x5e9741(0x8ac)]?_0x5e9741(0x439):'置顶聊天';const _0x5c57cf=_0x5be546[_0x5e9741(0x4b4)](!![]);_0x5be546[_0x5e9741(0x18c)][_0x5e9741(0xeaa)](_0x5c57cf,_0x5be546),_0x5c57cf[_0x5e9741(0x1074)]=()=>{const _0x4d5182=_0x5e9741;_0x3c9426[_0x4d5182(0x505)][_0x4d5182(0x957)](_0x4d5182(0x250)),_0x20081e(_0x4d5182(0xf16));};const _0x2a8a81=_0x5969c3['cloneNode'](!![]);_0x5969c3[_0x5e9741(0x18c)][_0x5e9741(0xeaa)](_0x2a8a81,_0x5969c3),_0x2a8a81[_0x5e9741(0x1074)]=()=>{const _0xd983bd=_0x5e9741;_0x3c9426[_0xd983bd(0x505)][_0xd983bd(0x957)](_0xd983bd(0x250)),_0x20081e(_0xd983bd(0xc0c));};const _0x1789c6=_0x3234d9[_0x5e9741(0x4b4)](!![]);_0x3234d9[_0x5e9741(0x18c)]['replaceChild'](_0x1789c6,_0x3234d9),_0x1789c6[_0x5e9741(0x1074)]=()=>{const _0x184eed=_0x5e9741;_0x3c9426['classList'][_0x184eed(0x957)](_0x184eed(0x250)),_0x20081e(null);},_0x3c9426['classList']['add'](_0x5e9741(0x250));});}function _0x4a28b8(){const _0x3f275b=_0x241b18,_0x246277=document[_0x3f275b(0x11e3)]('character-phone-screen'),_0x478952=_0x5de8b7[_0x3f275b(0x2df)][_0x3f275b(0xaa4)];_0x478952?_0x246277[_0x3f275b(0x794)][_0x3f275b(0x123e)]=_0x3f275b(0xac7)+_0x478952+')':_0x246277[_0x3f275b(0x794)][_0x3f275b(0x123e)]=_0x3f275b(0x1286);}function _0x3f2530(){const _0x4dfe08=_0x241b18;if(!_0x5de8b7[_0x4dfe08(0x2df)]['cphoneAppIcons'])return;for(const _0x42df03 in _0x5de8b7[_0x4dfe08(0x2df)][_0x4dfe08(0xfaa)]){const _0xea38ec=document['getElementById'](_0x4dfe08(0x11be)+_0x42df03);_0xea38ec&&(_0xea38ec[_0x4dfe08(0xf0a)]=_0x5de8b7[_0x4dfe08(0x2df)]['cphoneAppIcons'][_0x42df03]);}}function _0x3e1b8d(){const _0x4d5c95=_0x241b18,_0x54263f=document[_0x4d5c95(0x11e3)]('cphone-icon-settings-grid');if(!_0x54263f)return;_0x54263f[_0x4d5c95(0x595)]='';const _0x18d913={'qq':'QQ','album':'相册','browser':_0x4d5c95(0x63b),'taobao':'淘宝','memo':_0x4d5c95(0x10a5),'diary':'日记','amap':_0x4d5c95(0x8f7),'usage':_0x4d5c95(0x1bb),'music':_0x4d5c95(0x1298),'ephone':_0x4d5c95(0x8f5)};for(const _0x51637b in _0x5de8b7[_0x4d5c95(0x2df)][_0x4d5c95(0xfaa)]){const _0x564c36=_0x5de8b7[_0x4d5c95(0x2df)]['cphoneAppIcons'][_0x51637b],_0x5022d5=_0x18d913[_0x51637b]||_0x4d5c95(0xf73),_0x22a31e=document['createElement'](_0x4d5c95(0x1285));_0x22a31e['className']=_0x4d5c95(0xdfb),_0x22a31e[_0x4d5c95(0xaca)]['iconId']=_0x51637b,_0x22a31e[_0x4d5c95(0x595)]=_0x4d5c95(0x12bd)+_0x564c36+_0x4d5c95(0x1095)+_0x5022d5+_0x4d5c95(0x2e4),_0x54263f[_0x4d5c95(0x120c)](_0x22a31e);}}function _0x40cea2(){const _0xaee17e=_0x241b18;if(!_0x5de8b7[_0xaee17e(0x2df)][_0xaee17e(0x18b)])return;for(const _0x59198a in _0x5de8b7['globalSettings'][_0xaee17e(0x18b)]){const _0x5c7512=document['getElementById'](_0xaee17e(0xe85)+_0x59198a);_0x5c7512&&(_0x5c7512['src']=_0x5de8b7['globalSettings']['appIcons'][_0x59198a]);}}function _0x222868(){const _0x5029f3=_0x241b18,_0xb7daf1=document[_0x5029f3(0x11e3)](_0x5029f3(0x91a));if(!_0xb7daf1)return;_0xb7daf1[_0x5029f3(0x595)]='';const _0x994535={'qq':'QQ','world-book':_0x5029f3(0xf6),'wallpaper':_0x5029f3(0x5d5),'renderer':'渲染器','api-settings':'API设置','font':'字体','char-phone':_0x5029f3(0x540),'douban':_0x5029f3(0xa0f),'preset':'预设','tutorial':'教程','werewolf':_0x5029f3(0xcb8),'x':'X'};for(const _0x3414e5 in _0x5de8b7[_0x5029f3(0x2df)][_0x5029f3(0x18b)]){const _0x5ec69f=_0x5de8b7[_0x5029f3(0x2df)][_0x5029f3(0x18b)][_0x3414e5],_0xfaf8d=_0x994535[_0x3414e5]||'Cphone',_0x1f74fa=document[_0x5029f3(0x383)](_0x5029f3(0x1285));_0x1f74fa['className']=_0x5029f3(0xdfb),_0x1f74fa[_0x5029f3(0xaca)][_0x5029f3(0xe9)]=_0x3414e5,_0x1f74fa[_0x5029f3(0x595)]=_0x5029f3(0x12bd)+_0x5ec69f+_0x5029f3(0x1095)+_0xfaf8d+_0x5029f3(0x2e4),_0xb7daf1['appendChild'](_0x1f74fa);}}function _0x5b33d0(_0x3628a9){const _0x40f930=_0x241b18;if(!_0x5de8b7[_0x40f930(0x93d)])return;const _0x50a716=_0x5de8b7['chats'][_0x5de8b7['activeChatId']];if(!_0x50a716||!_0x50a716[_0x40f930(0x49e)])return;const _0x26dffa=_0x50a716['history'][_0x40f930(0xe79)](_0x5a6dc7=>_0x5a6dc7['timestamp']===_0x3628a9);if(!_0x26dffa||_0x26dffa[_0x40f930(0xa20)]!==_0x40f930(0x67b)){console[_0x40f930(0x1c1)]('无法找到或消息类型不匹配的分享链接:',_0x3628a9);return;}document[_0x40f930(0x11e3)](_0x40f930(0x20d))['textContent']=_0x26dffa['source_name']||'文章详情';const _0x1b2465=document[_0x40f930(0x11e3)](_0x40f930(0x7e8));_0x1b2465['innerHTML']=_0x40f930(0x79b)+(_0x26dffa[_0x40f930(0x740)]||_0x40f930(0x491))+_0x40f930(0x2a6)+(_0x26dffa[_0x40f930(0x101b)]||'未知')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+(_0x26dffa[_0x40f930(0x9a5)]||_0x40f930(0x108f))['replace'](/\n/g,_0x40f930(0x1172))+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4e7698(_0x40f930(0xcfc));}function _0x2655a9(){const _0x32bd6f=_0x241b18;_0x4e7698(_0x32bd6f(0x9fc));}function _0x2655a9(){_0x4e7698('chat-interface-screen');}function _0x56ccdb(){const _0x519119=_0x241b18;if(!_0x5de8b7['activeChatId'])return;document['getElementById'](_0x519119(0x112a))[_0x519119(0xf27)]='',document[_0x519119(0x11e3)](_0x519119(0x71e))[_0x519119(0xf27)]='',document['getElementById']('link-source-input')[_0x519119(0xf27)]='',document[_0x519119(0x11e3)](_0x519119(0x8ef))[_0x519119(0xf27)]='',document[_0x519119(0x11e3)](_0x519119(0x9de))[_0x519119(0x505)][_0x519119(0x252)]('visible');}async function _0x4a7b3c(){const _0x10d642=_0x241b18;if(!_0x5de8b7['activeChatId'])return;const _0x2cdbed=document[_0x10d642(0x11e3)](_0x10d642(0x112a))[_0x10d642(0xf27)][_0x10d642(0xeb7)]();if(!_0x2cdbed){alert(_0x10d642(0x9c0));return;}const _0x221767=document[_0x10d642(0x11e3)](_0x10d642(0x71e))[_0x10d642(0xf27)]['trim'](),_0x3a30f5=document[_0x10d642(0x11e3)](_0x10d642(0x1256))[_0x10d642(0xf27)][_0x10d642(0xeb7)](),_0x4dc409=document[_0x10d642(0x11e3)](_0x10d642(0x8ef))[_0x10d642(0xf27)][_0x10d642(0xeb7)](),_0x2e336e=_0x5de8b7[_0x10d642(0x737)][_0x5de8b7['activeChatId']],_0x3d5540={'role':_0x10d642(0x21c),'type':_0x10d642(0x67b),'timestamp':Date[_0x10d642(0x1182)](),'title':_0x2cdbed,'description':_0x221767,'source_name':_0x3a30f5,'content':_0x4dc409,'thumbnail_url':null};_0x2e336e['history']['push'](_0x3d5540),await _0x2e83f8[_0x10d642(0x737)][_0x10d642(0xe3c)](_0x2e336e),_0x3b5153(_0x3d5540,_0x2e336e),_0x5ee219(),document[_0x10d642(0x11e3)](_0x10d642(0x9de))[_0x10d642(0x505)][_0x10d642(0x957)](_0x10d642(0x250));}function _0x3f9279(_0x50c070,_0x241014){const _0x2af18a=_0x241b18;if(!_0x241014||!_0x241014['id'])return[];const _0x3682cb=_0x241014[_0x2af18a(0xe0d)],_0x5044a1=_0x241014['id'];return _0x50c070[_0x2af18a(0x138)](_0x119f79=>{const _0x2ffd5b=_0x2af18a;if(_0x119f79[_0x2ffd5b(0x5d9)]===_0x2ffd5b(0x21c)){if(_0x119f79[_0x2ffd5b(0xcb9)]&&_0x119f79[_0x2ffd5b(0xcb9)][_0x2ffd5b(0x594)]>0x0)return _0x3682cb&&_0x119f79[_0x2ffd5b(0xcb9)]['includes'](_0x3682cb);return!![];}if(String(_0x119f79['authorId'])[_0x2ffd5b(0xb6c)](_0x2ffd5b(0x8b8))){if(Array[_0x2ffd5b(0xb7b)](_0x119f79['visibleTo']))return _0x119f79[_0x2ffd5b(0x102c)][_0x2ffd5b(0x3ad)](_0x5044a1);return![];}const _0x4efa8d=_0x5de8b7['chats'][_0x119f79[_0x2ffd5b(0x5d9)]];if(!_0x4efa8d)return![];const _0x473ab7=_0x4efa8d[_0x2ffd5b(0xe0d)],_0x1a1c70=_0x473ab7&&_0x3682cb&&_0x473ab7===_0x3682cb,_0xa42a4b=!_0x473ab7&&!_0x3682cb;return _0x1a1c70||_0xa42a4b;});}function _0x43fa3c(_0x23c0d6){const _0x20ab89=_0x241b18,_0x163c5b=document['getElementById'](_0x20ab89(0x1e6)),_0x5999fe=document[_0x20ab89(0x11e3)]('theme-toggle-switch'),_0x44685c=_0x23c0d6==='dark';_0x163c5b['classList'][_0x20ab89(0xe7e)](_0x20ab89(0x251),_0x44685c),_0x5999fe&&(_0x5999fe[_0x20ab89(0x3e4)]=_0x44685c),localStorage[_0x20ab89(0x3b2)]('ephone-theme',_0x23c0d6);}function _0x5c2d59(){const _0x4b538b=_0x241b18,_0x1b5e07=document['getElementById'](_0x4b538b(0x564)),_0x217e75=_0x1b5e07[_0x4b538b(0x3e4)]?'dark':'light';_0x43fa3c(_0x217e75);}function _0x4320e6(){const _0x57035b=_0x241b18;if(!_0x5de8b7[_0x57035b(0x93d)])return;_0xaedde2(),_0x4e7698(_0x57035b(0x936));}function _0xaedde2(){const _0x2c97d1=_0x241b18,_0x2972cb=document[_0x2c97d1(0x11e3)](_0x2c97d1(0xe75)),_0x4c65de=_0x5de8b7[_0x2c97d1(0x737)][_0x5de8b7[_0x2c97d1(0x93d)]];_0x2972cb['innerHTML']='';let _0x59c645=[];_0x4c65de[_0x2c97d1(0x1244)]?_0x4c65de[_0x2c97d1(0x2b3)][_0x2c97d1(0x494)](_0x4462ab=>{const _0x4f06db=_0x2c97d1,_0x575fb9=_0x5de8b7[_0x4f06db(0x737)][_0x4462ab['id']];if(_0x575fb9&&_0x575fb9[_0x4f06db(0xe21)]){const _0x8769d9=_0x575fb9[_0x4f06db(0xe21)][_0x4f06db(0x796)](_0x1dd103=>({..._0x1dd103,'authorName':_0x4462ab[_0x4f06db(0xc8f)],'authorChatId':_0x4462ab['id']}));_0x59c645[_0x4f06db(0xf5)](..._0x8769d9);}}):_0x4c65de[_0x2c97d1(0xe21)]&&(_0x59c645=_0x4c65de[_0x2c97d1(0xe21)][_0x2c97d1(0x796)](_0x2145db=>({..._0x2145db,'authorName':_0x4c65de[_0x2c97d1(0x278)],'authorChatId':_0x4c65de['id']})));if(_0x59c645[_0x2c97d1(0x594)]===0x0){_0x2972cb[_0x2c97d1(0x595)]=_0x2c97d1(0x10e6);return;}_0x59c645[_0x2c97d1(0x861)]((_0xad3813,_0x2f0768)=>_0x2f0768[_0x2c97d1(0x702)]-_0xad3813[_0x2c97d1(0x702)]),_0x59c645[_0x2c97d1(0x494)]((_0x23a3b5,_0x22cc65)=>{const _0xa72e3c=_0x2c97d1,_0x2b6077=document[_0xa72e3c(0x383)](_0xa72e3c(0x1285));_0x2b6077['className']=_0xa72e3c(0xed5),_0x2b6077[_0xa72e3c(0x794)]['cursor']='default',_0x2b6077[_0xa72e3c(0x595)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20'+_0x23a3b5[_0xa72e3c(0xd5a)]+'\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x23a3b5[_0xa72e3c(0x9a5)]['replace'](/\n/g,_0xa72e3c(0xf70))+_0xa72e3c(0x74c)+_0x23a3b5[_0xa72e3c(0x191)]+_0xa72e3c(0xd81)+_0x23a3b5[_0xa72e3c(0x702)]+'\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22'+_0x23a3b5[_0xa72e3c(0x191)]+_0xa72e3c(0xd81)+_0x23a3b5[_0xa72e3c(0x702)]+_0xa72e3c(0x8e2),_0x2972cb['appendChild'](_0x2b6077);});}async function _0xc81940(){const _0x33ed5e=_0x241b18,_0x5f3262=_0x5de8b7[_0x33ed5e(0x737)][_0x5de8b7[_0x33ed5e(0x93d)]];if(!_0x5f3262)return;let _0x42d549=_0x5f3262;if(_0x5f3262['isGroup']){const _0x179495=_0x5f3262[_0x33ed5e(0x2b3)][_0x33ed5e(0x796)](_0x2ff693=>({'text':'为“'+_0x2ff693[_0x33ed5e(0xc8f)]+_0x33ed5e(0x1036),'value':_0x2ff693['id']})),_0x296726=await _0x16a8e1(_0x33ed5e(0xfc2),_0x179495);if(!_0x296726)return;_0x42d549=_0x5de8b7[_0x33ed5e(0x737)][_0x296726];if(!_0x42d549){alert('错误：找不到该成员的个人档案。');return;}}const _0x325a35=await _0x231a5a('为“'+_0x42d549[_0x33ed5e(0x278)]+'”添加记忆',_0x33ed5e(0x613),'',_0x33ed5e(0x10bb));if(_0x325a35&&_0x325a35['trim']()){if(!_0x42d549[_0x33ed5e(0xe21)])_0x42d549[_0x33ed5e(0xe21)]=[];_0x42d549[_0x33ed5e(0xe21)]['push']({'content':_0x325a35['trim'](),'timestamp':Date[_0x33ed5e(0x1182)](),'source':'manual'}),await _0x2e83f8[_0x33ed5e(0x737)][_0x33ed5e(0xe3c)](_0x42d549),_0xaedde2();}}async function _0xff5362(_0x89c32,_0x130a83){const _0x703a79=_0x241b18,_0x1869b0=_0x5de8b7[_0x703a79(0x737)][_0x89c32];if(!_0x1869b0||!_0x1869b0[_0x703a79(0xe21)])return;const _0x2e285b=_0x1869b0[_0x703a79(0xe21)][_0x703a79(0x901)](_0x3de910=>_0x3de910['timestamp']===_0x130a83);if(_0x2e285b===-0x1)return;const _0x4272e8=_0x1869b0[_0x703a79(0xe21)][_0x2e285b],_0x87f4b4=await _0x231a5a(_0x703a79(0x2c8),_0x703a79(0xc7a),_0x4272e8[_0x703a79(0x9a5)],_0x703a79(0x10bb));_0x87f4b4&&_0x87f4b4[_0x703a79(0xeb7)]()&&(_0x4272e8[_0x703a79(0x9a5)]=_0x87f4b4[_0x703a79(0xeb7)](),await _0x2e83f8['chats'][_0x703a79(0xe3c)](_0x1869b0),_0xaedde2());}async function _0x2c1340(_0x228bbb,_0x4879bd){const _0x24ea73=_0x241b18,_0x220d63=await _0x58fd60(_0x24ea73(0x1166),_0x24ea73(0x298),{'confirmButtonClass':_0x24ea73(0x8a6)});if(_0x220d63){const _0x3f9797=_0x5de8b7[_0x24ea73(0x737)][_0x228bbb];if(!_0x3f9797||!_0x3f9797[_0x24ea73(0xe21)])return;_0x3f9797['longTermMemory']=_0x3f9797[_0x24ea73(0xe21)][_0x24ea73(0x138)](_0x4354b4=>_0x4354b4[_0x24ea73(0x702)]!==_0x4879bd),await _0x2e83f8[_0x24ea73(0x737)][_0x24ea73(0xe3c)](_0x3f9797),_0xaedde2();}}async function _0x51c7f9(){const _0x2f358a=_0x241b18,_0x1e07c2=await _0x58fd60(_0x2f358a(0x5bf),_0x2f358a(0xf0e));_0x1e07c2&&await _0x52e081(_0x5de8b7['activeChatId'],!![]);}async function _0x28427c(_0x2b9caa){const _0x57b404=_0x241b18,_0x1ef3d7=_0x5de8b7['chats'][_0x2b9caa];if(!_0x1ef3d7||!_0x1ef3d7['settings'][_0x57b404(0x6db)])return;const _0x57fe55=_0x1ef3d7[_0x57b404(0x1ca)]||0x0,_0x46f79f=_0x1ef3d7[_0x57b404(0x49e)][_0x57b404(0x138)](_0x1c70cf=>_0x1c70cf[_0x57b404(0x702)]>_0x57fe55&&!_0x1c70cf[_0x57b404(0xbf5)]);_0x46f79f[_0x57b404(0x594)]>=_0x1ef3d7[_0x57b404(0x761)][_0x57b404(0x11f)]&&(console[_0x57b404(0x84b)]('达到自动总结阈值\x20('+_0x46f79f['length']+'/'+_0x1ef3d7['settings'][_0x57b404(0x11f)]+_0x57b404(0xc1b)),await _0x52e081(_0x2b9caa));}async function _0x539172(_0x3e6226,_0x1c4773){const _0x12a8f5=_0x241b18,_0x2401af=_0x5de8b7[_0x12a8f5(0x737)][_0x3e6226];if(!_0x2401af||!_0x1c4773)throw new Error(_0x12a8f5(0xa81));const _0xa4b9b0=_0x5de8b7['qzoneSettings'][_0x12a8f5(0xa33)]||'用户';let _0x28013f,_0x23ea1f=_0x2401af;const _0x37b2c5=new Date()[_0x12a8f5(0x70e)](_0x12a8f5(0x898),{'year':'numeric','month':_0x12a8f5(0xc7),'day':_0x12a8f5(0x61b)});if(_0x2401af[_0x12a8f5(0x1244)]){let _0x2d94e2=null;_0x46751e['callRequester']&&(_0x2d94e2=_0x2401af[_0x12a8f5(0x2b3)][_0x12a8f5(0xe79)](_0x5868d1=>_0x5868d1[_0x12a8f5(0x697)]===_0x46751e['callRequester']));!_0x2d94e2&&(_0x2d94e2=_0x2401af[_0x12a8f5(0x2b3)]['find'](_0x199f0e=>_0x199f0e['id']!==_0x12a8f5(0x21c)&&_0x46751e[_0x12a8f5(0x94b)][_0x12a8f5(0xe7c)](_0x48c20b=>_0x48c20b['id']===_0x199f0e['id'])));!_0x2d94e2&&(_0x2d94e2=_0x2401af[_0x12a8f5(0x2b3)][_0x12a8f5(0xe79)](_0x4aafe2=>_0x4aafe2['id']!==_0x12a8f5(0x21c)));if(!_0x2d94e2)throw new Error(_0x12a8f5(0x41a));const _0x163189=_0x5de8b7[_0x12a8f5(0x737)][_0x2d94e2['id']];if(!_0x163189)throw new Error(_0x12a8f5(0x120b)+_0x2d94e2[_0x12a8f5(0xc8f)]+'”\x20的详细角色信息。');const _0x3694c7=_0x2401af[_0x12a8f5(0x761)][_0x12a8f5(0x10c5)]||'(未设置)';_0x28013f=_0x12a8f5(0x6b9)+_0x2d94e2['originalName']+'”。请你回顾一下刚才和\x20“'+_0xa4b9b0+_0x12a8f5(0x1077)+_0x37b2c5+_0x12a8f5(0xf80)+_0x37b2c5+_0x12a8f5(0x1248)+_0x163189['settings'][_0x12a8f5(0x8d5)]+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x3694c7+_0x12a8f5(0x12ae)+_0x1c4773+_0x12a8f5(0x904)+_0x2d94e2[_0x12a8f5(0x697)]+_0x12a8f5(0x9e4),_0x23ea1f=_0x163189;}else _0x28013f=_0x12a8f5(0x6b9)+_0x2401af[_0x12a8f5(0x697)]+'”。请你回顾一下刚才和“'+_0xa4b9b0+_0x12a8f5(0x683)+_0x37b2c5+_0x12a8f5(0xa3a)+_0x37b2c5+_0x12a8f5(0x6a5)+_0x2401af['settings'][_0x12a8f5(0x8d5)]+_0x12a8f5(0xca0)+_0x2401af[_0x12a8f5(0x761)][_0x12a8f5(0x10c5)]+'\x0a\x0a#\x20待总结的视频通话记录\x0a'+_0x1c4773+_0x12a8f5(0x904)+_0x2401af[_0x12a8f5(0x697)]+_0x12a8f5(0x9e4);try{const _0x54eab6=_0x5de8b7[_0x12a8f5(0x89c)]['secondaryProxyUrl']&&_0x5de8b7[_0x12a8f5(0x89c)][_0x12a8f5(0xb05)]&&_0x5de8b7[_0x12a8f5(0x89c)][_0x12a8f5(0xe1b)],{proxyUrl:_0x4c74d4,apiKey:_0x24829a,model:_0x2948f9}=_0x54eab6?{'proxyUrl':_0x5de8b7[_0x12a8f5(0x89c)]['secondaryProxyUrl'],'apiKey':_0x5de8b7[_0x12a8f5(0x89c)][_0x12a8f5(0xb05)],'model':_0x5de8b7[_0x12a8f5(0x89c)]['secondaryModel']}:_0x5de8b7[_0x12a8f5(0x89c)];if(!_0x4c74d4||!_0x24829a||!_0x2948f9)throw new Error(_0x12a8f5(0x1027));let _0x166907=_0x4c74d4[_0x12a8f5(0x3ad)](_0x12a8f5(0xb9b)),_0x3ba648=_0x4a90fe(_0x2948f9,_0x24829a,_0x28013f,[{'role':_0x12a8f5(0x21c),'content':_0x12a8f5(0xad6)}]);const _0x5df4fa=_0x166907?await fetch(_0x3ba648[_0x12a8f5(0x10ac)],_0x3ba648[_0x12a8f5(0x1cc)]):await fetch(_0x4c74d4+_0x12a8f5(0x8fd),{'method':_0x12a8f5(0x1128),'headers':{'Content-Type':_0x12a8f5(0x35c),'Authorization':'Bearer\x20'+_0x24829a},'body':JSON[_0x12a8f5(0x313)]({'model':_0x2948f9,'messages':[{'role':_0x12a8f5(0xf72),'content':_0x28013f},{'role':_0x12a8f5(0x21c),'content':_0x12a8f5(0xad6)}],'temperature':0.1})});if(!_0x5df4fa['ok']){const _0x4d7384=await _0x5df4fa['json']()[_0x12a8f5(0x100)](()=>({'error':{'message':_0x5df4fa['statusText']}}));throw new Error('API\x20请求失败:\x20'+_0x5df4fa[_0x12a8f5(0x739)]+_0x12a8f5(0x12a2)+_0x4d7384['error'][_0x12a8f5(0x4bc)]);}const _0x3d8517=await _0x5df4fa['json']();let _0x553ad4=_0x166907?getGeminiResponseText(_0x3d8517):_0x3d8517[_0x12a8f5(0x1206)][0x0][_0x12a8f5(0x4bc)][_0x12a8f5(0x9a5)];_0x553ad4=_0x553ad4[_0x12a8f5(0x1018)](/^```json\s*/,'')[_0x12a8f5(0x1018)](/```$/,'')[_0x12a8f5(0xeb7)]();const _0x12788c=JSON[_0x12a8f5(0xb0c)](_0x553ad4);if(_0x12788c[_0x12a8f5(0xfa4)]&&_0x12788c[_0x12a8f5(0xfa4)]['trim']()){const _0x59d65f={'content':_0x12a8f5(0x6bb)+(_0x2401af[_0x12a8f5(0x1244)]?'群聊':'')+'通话中，'+_0x12788c[_0x12a8f5(0xfa4)][_0x12a8f5(0xeb7)]()+')','timestamp':Date[_0x12a8f5(0x1182)](),'source':_0x2401af['isGroup']?_0x12a8f5(0x4e6):_0x12a8f5(0x297)};if(!_0x23ea1f[_0x12a8f5(0xe21)])_0x23ea1f['longTermMemory']=[];return _0x23ea1f['longTermMemory'][_0x12a8f5(0xf5)](_0x59d65f),await _0x2e83f8[_0x12a8f5(0x737)]['put'](_0x23ea1f),console['log'](_0x12a8f5(0x10d8)+_0x23ea1f['name']+_0x12a8f5(0x80c)),!![];}else throw new Error(_0x12a8f5(0xf40));}catch(_0x48fcbb){console['error'](_0x12a8f5(0x212),_0x48fcbb);throw _0x48fcbb;}}function _0x604ede(_0x4b975d){const _0x313f34=_0x241b18,_0x5536c1=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么',_0x313f34(0x789),'哪个','一些','这个','那个','还有']),_0x1b2814=_0x4b975d[_0x313f34(0xe9f)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x5dbf23=new Map();let _0x1e9b75=0x0;_0x1b2814[_0x313f34(0x494)](_0x46c4f9=>{const _0x250ba2=_0x313f34;if(_0x46c4f9[_0x250ba2(0x594)]>0x1&&!_0x5536c1[_0x250ba2(0x72a)](_0x46c4f9)){const _0x552d32=(_0x5dbf23['get'](_0x46c4f9)||0x0)+0x1;_0x5dbf23['set'](_0x46c4f9,_0x552d32);if(_0x552d32>_0x1e9b75)_0x1e9b75=_0x552d32;}});const _0x5a2bee=[],_0x2ac061=[],_0xa4e518=_0x1e9b75*0.9,_0x1da8dc=_0x1e9b75*0.6;_0x5dbf23[_0x313f34(0x494)]((_0x44d1ce,_0x42b279)=>{const _0x492782=_0x313f34;if(_0x44d1ce>=_0xa4e518)_0x5a2bee[_0x492782(0xf5)](_0x42b279);else _0x44d1ce>=_0x1da8dc&&_0x2ac061[_0x492782(0xf5)](_0x42b279);});const _0x59721e=new Set(_0x5a2bee),_0x43cd9c=_0x2ac061[_0x313f34(0x138)](_0x29fb23=>!_0x59721e[_0x313f34(0x72a)](_0x29fb23))[_0x313f34(0xa6c)](0x0,0x5);return{'coreKeywords':_0x5a2bee['slice'](0x0,0x3),'situationalKeywords':_0x43cd9c};}function _0x57277b(_0x310ff8,_0x2aab50,_0x1666d4){const _0x54d95c=_0x241b18;let _0x540831;_0x1666d4===_0x54d95c(0x1059)?_0x540831=Date[_0x54d95c(0x1182)]()-_0x2aab50*0x3c*0x3c*0x3e8:_0x540831=Date[_0x54d95c(0x1182)]()-_0x2aab50*0x18*0x3c*0x3c*0x3e8;const _0x18751f=_0x310ff8[_0x54d95c(0x49e)][_0x54d95c(0x138)](_0x2affa7=>_0x2affa7[_0x54d95c(0x702)]>_0x540831&&!_0x2affa7[_0x54d95c(0xbf5)]);if(_0x18751f[_0x54d95c(0x594)]<0x3)return'';const _0x5f22d3=_0x18751f[_0x54d95c(0x796)](_0xf903e=>{const _0x892440=_0x54d95c;if(typeof _0xf903e[_0x892440(0x9a5)]===_0x892440(0x10d7))return _0xf903e[_0x892440(0x9a5)];if(_0xf903e[_0x892440(0xa20)]==='voice_message')return _0xf903e['content'];if(_0xf903e[_0x892440(0xa20)]===_0x892440(0xd71))return(_0xf903e['dialogue']||'')+'\x20'+(_0xf903e[_0x892440(0x1029)]||'');return'';})[_0x54d95c(0xa4b)]('\x20'),_0x2b141d=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0x563b4e=_0x5f22d3[_0x54d95c(0xe9f)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x73c50c=new Map();_0x563b4e['forEach'](_0x548312=>{const _0x425681=_0x54d95c;_0x548312['length']>0x1&&!_0x2b141d['has'](_0x548312)&&_0x73c50c[_0x425681(0xb25)](_0x548312,(_0x73c50c[_0x425681(0x1289)](_0x548312)||0x0)+0x1);});const _0x202bc2=[..._0x73c50c[_0x54d95c(0x560)]()][_0x54d95c(0x861)]((_0xd04c69,_0x2055b5)=>_0x2055b5[0x1]-_0xd04c69[0x1])[_0x54d95c(0x796)](_0x274bf2=>_0x274bf2[0x0]);if(_0x202bc2['length']===0x0)return'';let _0x359cc0;return _0x1666d4===_0x54d95c(0x1059)?_0x359cc0='最近'+_0x2aab50+'小时核心议题':_0x2aab50===0x1?_0x359cc0='本日核心议题':_0x359cc0='最近'+_0x2aab50+_0x54d95c(0x11c3),_0x54d95c(0x440)+_0x359cc0+_0x54d95c(0x7fb)+_0x202bc2['slice'](0x0,0x3)[_0x54d95c(0xa4b)]('、\x20')+_0x54d95c(0x188);}function _0x556e8b(_0x25aa3a){const _0x47398e=_0x241b18;if(!_0x25aa3a||typeof _0x25aa3a!==_0x47398e(0x10d7))return null;const _0xa952ec=_0x25aa3a[_0x47398e(0x1018)](/^```json\s*/,'')[_0x47398e(0x1018)](/```$/,'')[_0x47398e(0xeb7)](),_0x5c569d=_0xa952ec[_0x47398e(0xe9f)](/{[\s\S]*}/);if(_0x5c569d)try{const _0x468931=JSON[_0x47398e(0xb0c)](_0x5c569d[0x0]);return console[_0x47398e(0x84b)](_0x47398e(0x11ae)),_0x468931;}catch(_0x32c6f2){console[_0x47398e(0x6b0)](_0x47398e(0xfbb));}const _0x26ac72=_0xa952ec[_0x47398e(0xe9f)](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0x26ac72&&_0x26ac72[0x1])return console[_0x47398e(0x84b)](_0x47398e(0x12f)),{'summary':_0x26ac72[0x1][_0x47398e(0x1018)](/\\"/g,'\x22')};if(_0xa952ec)return console[_0x47398e(0x84b)](_0x47398e(0x11b5)),{'summary':_0xa952ec};return null;}async function _0x2a2971(_0x24f208){const _0x2674dc=_0x241b18;let _0x3a32be=_0x5de8b7[_0x2674dc(0x737)][_0x24f208];if(!_0x3a32be)return;let _0x29ef5f=_0x3a32be;if(_0x3a32be['isGroup']){const _0x499ad3=_0x3a32be['members'][_0x2674dc(0x796)](_0x569938=>{const _0x177c19=_0x2674dc,_0x5680fa=_0x5de8b7['chats'][_0x569938['id']];if(_0x5680fa&&_0x5680fa['longTermMemory']&&_0x5680fa[_0x177c19(0xe21)][_0x177c19(0x594)]>=0x2)return{'text':_0x177c19(0xf35)+_0x569938[_0x177c19(0xc8f)]+'”的记忆\x20('+_0x5680fa[_0x177c19(0xe21)][_0x177c19(0x594)]+'条)','value':_0x569938['id']};return null;})['filter'](Boolean);if(_0x499ad3[_0x2674dc(0x594)]===0x0){alert(_0x2674dc(0x53d));return;}const _0x406a34=await _0x16a8e1(_0x2674dc(0x980),_0x499ad3);if(!_0x406a34)return;_0x29ef5f=_0x5de8b7[_0x2674dc(0x737)][_0x406a34];}if(!_0x29ef5f[_0x2674dc(0xe21)]||_0x29ef5f[_0x2674dc(0xe21)][_0x2674dc(0x594)]<0x2){alert('“'+_0x29ef5f[_0x2674dc(0x278)]+_0x2674dc(0x2f4));return;}const _0x499d6c=_0x29ef5f['longTermMemory'][_0x2674dc(0x594)],_0x2ef5a3=await _0x16a8e1('选择精炼范围',[{'text':_0x2674dc(0x74b)+_0x499d6c+'条)','value':_0x2674dc(0xd4a)},{'text':'最近\x2020\x20条','value':'20'},{'text':_0x2674dc(0x1235),'value':'50'},{'text':'最近\x20100\x20条','value':_0x2674dc(0x4f9)},{'text':'自定义数量...','value':_0x2674dc(0x3c4)}]['filter'](_0x4da01a=>_0x4da01a[_0x2674dc(0xf27)]===_0x2674dc(0xd4a)||_0x4da01a[_0x2674dc(0xf27)]===_0x2674dc(0x3c4)||parseInt(_0x4da01a['value'])<_0x499d6c));if(_0x2ef5a3===null)return;let _0x26c7ff,_0x5ad845=_0x499d6c;if(_0x2ef5a3===_0x2674dc(0xd4a))_0x26c7ff=[..._0x29ef5f['longTermMemory']];else{if(_0x2ef5a3===_0x2674dc(0x3c4)){const _0x4bc592=await _0x231a5a(_0x2674dc(0x891),_0x2674dc(0x6f9)+_0x499d6c+_0x2674dc(0xa03));if(_0x4bc592===null)return;const _0x3cee43=parseInt(_0x4bc592);if(isNaN(_0x3cee43)||_0x3cee43<0x2||_0x3cee43>_0x499d6c){alert(_0x2674dc(0xcc4)+_0x499d6c+_0x2674dc(0x38d));return;}_0x5ad845=_0x3cee43,_0x26c7ff=_0x29ef5f['longTermMemory']['slice'](-_0x5ad845);}else _0x5ad845=parseInt(_0x2ef5a3),_0x5ad845>=_0x499d6c?(_0x26c7ff=[..._0x29ef5f[_0x2674dc(0xe21)]],_0x5ad845=_0x499d6c):_0x26c7ff=_0x29ef5f['longTermMemory']['slice'](-_0x5ad845);}const _0x5ae2c0=await _0x231a5a(_0x2674dc(0x56f),_0x2674dc(0x1080),_0x2674dc(0xb02));if(_0x5ae2c0===null)return;const _0x4d0bc3=parseInt(_0x5ae2c0);if(isNaN(_0x4d0bc3)||_0x4d0bc3<0x14){alert(_0x2674dc(0xbd5));return;}const _0x3bca7b=await _0x58fd60(_0x2674dc(0xdeb),_0x2674dc(0xab9)+_0x5ad845+_0x2674dc(0xeee)+_0x4d0bc3+'\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？',{'confirmButtonClass':_0x2674dc(0x8a6),'confirmText':_0x2674dc(0x50e)});if(!_0x3bca7b)return;const _0x5986e0=_0x26c7ff[_0x2674dc(0x796)](_0x1f52ff=>'-\x20'+_0x1f52ff[_0x2674dc(0x9a5)])['join']('\x0a'),_0x50c18c=_0x5de8b7['qzoneSettings'][_0x2674dc(0xa33)]||'用户',_0x2865e9=new Date()[_0x2674dc(0x70e)](_0x2674dc(0x898),{'year':_0x2674dc(0x61b),'month':_0x2674dc(0xc7),'day':_0x2674dc(0x61b)}),_0x8a3fe6=_0x2674dc(0x6b9)+_0x29ef5f['originalName']+'”。请你回顾一下你和“'+_0x50c18c+'”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x2865e9+_0x2674dc(0x818)+_0x2865e9+_0x2674dc(0x59c)+_0x4d0bc3+'\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a'+_0x29ef5f[_0x2674dc(0x761)][_0x2674dc(0x8d5)]+_0x2674dc(0xca0)+_0x29ef5f[_0x2674dc(0x761)][_0x2674dc(0x10c5)]+_0x2674dc(0x1154)+_0x5986e0+'\x0a\x0a现在，请以“'+_0x29ef5f['originalName']+_0x2674dc(0x11bd);await _0x2fb06(_0x2674dc(0x63d),'正在请求AI进行记忆精炼...');try{const _0x214dce=_0x5de8b7[_0x2674dc(0x89c)][_0x2674dc(0x13c)]&&_0x5de8b7[_0x2674dc(0x89c)]['secondaryApiKey']&&_0x5de8b7['apiConfig'][_0x2674dc(0xe1b)],{proxyUrl:_0x5e89b4,apiKey:_0x2f76cd,model:_0x59bd79}=_0x214dce?{'proxyUrl':_0x5de8b7[_0x2674dc(0x89c)]['secondaryProxyUrl'],'apiKey':_0x5de8b7[_0x2674dc(0x89c)][_0x2674dc(0xb05)],'model':_0x5de8b7[_0x2674dc(0x89c)][_0x2674dc(0xe1b)]}:_0x5de8b7[_0x2674dc(0x89c)];if(!_0x5e89b4||!_0x2f76cd||!_0x59bd79)throw new Error(_0x2674dc(0x2da));let _0x460057=_0x5e89b4[_0x2674dc(0x3ad)](_0x2674dc(0xb9b)),_0x1c0764=_0x4a90fe(_0x59bd79,_0x2f76cd,_0x8a3fe6,[{'role':_0x2674dc(0x21c),'content':'请开始整合。'}]);const _0x3c32fd=_0x460057?await fetch(_0x1c0764['url'],_0x1c0764['data']):await fetch(_0x5e89b4+_0x2674dc(0x8fd),{'method':'POST','headers':{'Content-Type':_0x2674dc(0x35c),'Authorization':_0x2674dc(0xdaf)+_0x2f76cd},'body':JSON[_0x2674dc(0x313)]({'model':_0x59bd79,'messages':[{'role':_0x2674dc(0xf72),'content':_0x8a3fe6},{'role':_0x2674dc(0x21c),'content':_0x2674dc(0x86f)}],'temperature':0.2})});if(!_0x3c32fd['ok'])throw new Error(_0x2674dc(0x307)+_0x3c32fd[_0x2674dc(0xfcf)]);const _0x5e7950=await _0x3c32fd[_0x2674dc(0xd7b)]();let _0x1441c2=_0x460057?getGeminiResponseText(_0x5e7950):_0x5e7950['choices'][0x0][_0x2674dc(0x4bc)][_0x2674dc(0x9a5)];const _0x20b200=_0x556e8b(_0x1441c2);if(_0x20b200&&_0x20b200[_0x2674dc(0xfa4)]&&typeof _0x20b200[_0x2674dc(0xfa4)]===_0x2674dc(0x10d7)&&_0x20b200[_0x2674dc(0xfa4)][_0x2674dc(0xeb7)]()){const _0x74c5b9=await _0x58fd60(_0x2674dc(0x60c),'AI已将您的\x20'+_0x5ad845+_0x2674dc(0x3ac)+_0x20b200[_0x2674dc(0xfa4)][_0x2674dc(0xeb7)]()+_0x2674dc(0x7f7),{'confirmText':_0x2674dc(0xea3),'cancelText':_0x2674dc(0x603),'confirmButtonClass':_0x2674dc(0x8a6)});if(_0x74c5b9){const _0x29c73b={'content':_0x20b200[_0x2674dc(0xfa4)][_0x2674dc(0xeb7)](),'timestamp':Date['now'](),'source':_0x2674dc(0x1147)},_0x34c30e=_0x499d6c-_0x5ad845,_0x8cdcf3=_0x34c30e>0x0?_0x29ef5f['longTermMemory'][_0x2674dc(0xa6c)](0x0,_0x34c30e):[];_0x29ef5f[_0x2674dc(0xe21)]=[..._0x8cdcf3,_0x29c73b],_0x29ef5f[_0x2674dc(0x1ca)]=Date[_0x2674dc(0x1182)](),await _0x2e83f8[_0x2674dc(0x737)]['put'](_0x29ef5f),document[_0x2674dc(0x11e3)](_0x2674dc(0x936))[_0x2674dc(0x505)][_0x2674dc(0x1121)](_0x2674dc(0x1fc))&&_0xaedde2(),await _0x2fb06(_0x2674dc(0xe5e),_0x2674dc(0x1ec)+_0x5ad845+_0x2674dc(0x7e3));}else await _0x2fb06('操作已取消',_0x2674dc(0xe19));}else throw new Error(_0x2674dc(0xf40));}catch(_0x3a69de){console[_0x2674dc(0x1c1)](_0x2674dc(0x47e),_0x3a69de),await _0x2fb06(_0x2674dc(0x997),'操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20'+_0x3a69de[_0x2674dc(0x4bc)]);}}async function _0x52e081(_0x2b0d9f,_0x244c17=![]){const _0x11f8b5=_0x241b18,_0x31be6d=_0x5de8b7[_0x11f8b5(0x737)][_0x2b0d9f];if(!_0x31be6d)return;const _0x161737=_0x31be6d['lastMemorySummaryTimestamp']||0x0,_0x504756=_0x244c17?_0x31be6d['history']['filter'](_0x2b7b04=>!_0x2b7b04[_0x11f8b5(0xbf5)]||_0x2b7b04[_0x11f8b5(0xba4)]===_0x11f8b5(0xf72)&&_0x2b7b04[_0x11f8b5(0x9a5)][_0x11f8b5(0x3ad)](_0x11f8b5(0x89a)))['slice'](-(_0x31be6d[_0x11f8b5(0x761)][_0x11f8b5(0x11f)]||0x14)):_0x31be6d[_0x11f8b5(0x49e)][_0x11f8b5(0x138)](_0x538de1=>_0x538de1['timestamp']>_0x161737&&(!_0x538de1['isHidden']||_0x538de1[_0x11f8b5(0xba4)]===_0x11f8b5(0xf72)&&_0x538de1[_0x11f8b5(0x9a5)][_0x11f8b5(0x3ad)](_0x11f8b5(0x89a))));if(_0x504756['length']<0x5){if(_0x244c17)alert(_0x11f8b5(0xfe3));return;}const _0xc4ebb9=_0x5de8b7['qzoneSettings'][_0x11f8b5(0xa33)]||'用户',_0x4c9115=_0x504756[_0x11f8b5(0x796)](_0x301820=>{const _0xdce790=_0x11f8b5;if(_0x301820['isHidden']&&_0x301820[_0xdce790(0xba4)]==='system'&&_0x301820[_0xdce790(0x9a5)][_0xdce790(0x3ad)](_0xdce790(0x89a)))return _0x301820['content'];let _0x4c2096;_0x301820['role']===_0xdce790(0x21c)?_0x4c2096=_0xc4ebb9:_0x4c2096=_0x301820['senderName']||_0x31be6d[_0xdce790(0x697)];let _0x2b3950='';if(_0x301820['type']===_0xdce790(0xd71)){if(_0x301820[_0xdce790(0x9a5)])_0x2b3950=_0x301820['content'];else{const _0x23c439=_0x301820[_0xdce790(0x159)]?'「'+_0x301820[_0xdce790(0x159)]+'」':'',_0x3f2bfa=_0x301820['description']?'('+_0x301820['description']+')':'';_0x2b3950=(_0x23c439+'\x20'+_0x3f2bfa)[_0xdce790(0xeb7)]();}}else _0x2b3950=String(_0x301820[_0xdce790(0x9a5)]);return _0x4c2096+':\x20'+_0x2b3950;})[_0x11f8b5(0xa4b)]('\x0a');let _0x2f82c6;if(_0x31be6d[_0x11f8b5(0x1244)])_0x2f82c6='\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动。\x0a3.\x20\x20**【简洁性铁律】**:\x20每条个人记忆总结【绝对不能超过60个字】。\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我今天在群里和大家讨论了电影，感觉很开心。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我在群里和'+_0xc4ebb9+_0x11f8b5(0x8a1)+_0x4c9115+_0x11f8b5(0x8fa)+_0x31be6d[_0x11f8b5(0x2b3)]['map'](_0x545528=>'-\x20'+_0x545528[_0x11f8b5(0xc8f)]+_0x11f8b5(0x734)+_0x545528[_0x11f8b5(0x697)]+')')[_0x11f8b5(0xa4b)]('\x0a')+'\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。';else{const _0x400afe=new Date()['toLocaleDateString'](_0x11f8b5(0x898),{'year':'numeric','month':_0x11f8b5(0xc7),'day':_0x11f8b5(0x61b)});_0x2f82c6=_0x11f8b5(0x6b9)+_0x31be6d['originalName']+_0x11f8b5(0x790)+_0xc4ebb9+_0x11f8b5(0xf84)+_0x400afe+'**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合“今天是'+_0x400afe+_0x11f8b5(0xb7)+new Date(Date[_0x11f8b5(0x1182)]()+0x5265c00)[_0x11f8b5(0x70e)](_0x11f8b5(0x898),{'month':_0x11f8b5(0xc7),'day':_0x11f8b5(0x61b)})+_0x11f8b5(0xf22)+_0x31be6d['settings'][_0x11f8b5(0x8d5)]+_0x11f8b5(0x10fe)+_0x31be6d[_0x11f8b5(0x761)][_0x11f8b5(0x10c5)]+'\x0a#\x20待总结的对话历史\x0a'+_0x4c9115+'\x0a\x0a现在，请以“'+_0x31be6d[_0x11f8b5(0x697)]+'”的身份，开始你的客观总结。';}try{const _0xddf17e=_0x5de8b7[_0x11f8b5(0x89c)][_0x11f8b5(0x13c)]&&_0x5de8b7[_0x11f8b5(0x89c)][_0x11f8b5(0xb05)]&&_0x5de8b7['apiConfig']['secondaryModel'],{proxyUrl:_0x4d6363,apiKey:_0xd5b7b0,model:_0x10cf5a}=_0xddf17e?{'proxyUrl':_0x5de8b7['apiConfig'][_0x11f8b5(0x13c)],'apiKey':_0x5de8b7['apiConfig'][_0x11f8b5(0xb05)],'model':_0x5de8b7['apiConfig'][_0x11f8b5(0xe1b)]}:_0x5de8b7[_0x11f8b5(0x89c)];if(!_0x4d6363||!_0xd5b7b0||!_0x10cf5a)throw new Error('API未配置');let _0x59318c=_0x4d6363[_0x11f8b5(0x3ad)](_0x11f8b5(0xb9b)),_0x20be01=_0x4a90fe(_0x10cf5a,_0xd5b7b0,_0x2f82c6,[{'role':_0x11f8b5(0x21c),'content':_0x11f8b5(0xad6)}]);const _0x7d03c3=_0x59318c?await fetch(_0x20be01[_0x11f8b5(0x10ac)],_0x20be01[_0x11f8b5(0x1cc)]):await fetch(_0x4d6363+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x11f8b5(0xdaf)+_0xd5b7b0},'body':JSON['stringify']({'model':_0x10cf5a,'messages':[{'role':_0x11f8b5(0xf72),'content':_0x2f82c6},{'role':_0x11f8b5(0x21c),'content':_0x11f8b5(0xad6)}],'temperature':0.2})});if(!_0x7d03c3['ok'])throw new Error(_0x11f8b5(0x307)+_0x7d03c3[_0x11f8b5(0xfcf)]);const _0x238e25=await _0x7d03c3['json']();let _0x35eeae=_0x59318c?getGeminiResponseText(_0x238e25):_0x238e25[_0x11f8b5(0x1206)][0x0][_0x11f8b5(0x4bc)][_0x11f8b5(0x9a5)];_0x35eeae=_0x35eeae['replace'](/^```json\s*/,'')[_0x11f8b5(0x1018)](/```$/,'')[_0x11f8b5(0xeb7)]();const _0x4abca8=JSON[_0x11f8b5(0xb0c)](_0x35eeae);if(_0x31be6d['isGroup']){if(_0x4abca8['summaries']&&typeof _0x4abca8['summaries']===_0x11f8b5(0x537)){let _0x13870c=0x0;for(const _0x41e85a in _0x4abca8[_0x11f8b5(0xd8d)]){const _0x43c921=_0x4abca8[_0x11f8b5(0xd8d)][_0x41e85a];if(_0x43c921&&_0x43c921[_0x11f8b5(0xeb7)]()){const _0x357db3=Object['values'](_0x5de8b7[_0x11f8b5(0x737)])['find'](_0x491b95=>_0x491b95['originalName']===_0x41e85a);if(_0x357db3){const _0xf26255={'content':_0x43c921[_0x11f8b5(0xeb7)](),'timestamp':Date[_0x11f8b5(0x1182)](),'source':'group_summary_from_'+_0x31be6d[_0x11f8b5(0x278)]};if(!_0x357db3[_0x11f8b5(0xe21)])_0x357db3[_0x11f8b5(0xe21)]=[];_0x357db3[_0x11f8b5(0xe21)][_0x11f8b5(0xf5)](_0xf26255),await _0x2e83f8[_0x11f8b5(0x737)]['put'](_0x357db3),_0x13870c++;}}}if(_0x13870c>0x0)console[_0x11f8b5(0x84b)](_0x11f8b5(0x1f8)+_0x13870c+_0x11f8b5(0x1255));else throw new Error(_0x11f8b5(0xf40));}else throw new Error(_0x11f8b5(0x592));}else{if(_0x4abca8[_0x11f8b5(0xfa4)]&&_0x4abca8['summary'][_0x11f8b5(0xeb7)]()){const _0x25a78d={'content':_0x4abca8[_0x11f8b5(0xfa4)][_0x11f8b5(0xeb7)](),'timestamp':Date[_0x11f8b5(0x1182)](),'source':'auto'};_0x31be6d[_0x11f8b5(0xe21)][_0x11f8b5(0xf5)](_0x25a78d),await _0x2e83f8[_0x11f8b5(0x737)][_0x11f8b5(0xe3c)](_0x31be6d),console['log']('自动总结成功：已成功添加\x201\x20条新的长期记忆！');}else throw new Error(_0x11f8b5(0xf40));}_0x31be6d['lastMemorySummaryTimestamp']=_0x504756['slice'](-0x1)[0x0][_0x11f8b5(0x702)],await _0x2e83f8[_0x11f8b5(0x737)][_0x11f8b5(0xe3c)](_0x31be6d),document[_0x11f8b5(0x11e3)]('long-term-memory-screen')['classList'][_0x11f8b5(0x1121)]('active')&&_0xaedde2();}catch(_0x1dbd31){console[_0x11f8b5(0x1c1)](_0x11f8b5(0x8c6),_0x1dbd31),await _0x2fb06(_0x11f8b5(0x855),'操作失败:\x20'+_0x1dbd31['message']);}}function _0xa1eb82(){const _0x38e752=_0x241b18;if(!_0x50fd7c)return;const _0x208596=_0x5de8b7['chats'][_0x5de8b7[_0x38e752(0x93d)]],_0x258b83=_0x208596[_0x38e752(0x49e)][_0x38e752(0xe79)](_0x1a43d0=>_0x1a43d0[_0x38e752(0x702)]===_0x50fd7c);if(!_0x258b83)return;let _0x2bd7cc;_0x258b83[_0x38e752(0xba4)]===_0x38e752(0x21c)?_0x2bd7cc=_0x208596[_0x38e752(0x1244)]?_0x208596[_0x38e752(0x761)]['myNickname']||'我':'我':_0x208596[_0x38e752(0x1244)]?_0x2bd7cc=_0xd9d60a(_0x208596,_0x258b83[_0x38e752(0x768)]):_0x2bd7cc=_0x208596['name'];const _0x4eb620=String(_0x258b83['content']||'');let _0x59ab07='';if(typeof _0x258b83[_0x38e752(0x9a5)]===_0x38e752(0x10d7)&&_0x9f9ac4[_0x38e752(0x1043)](_0x258b83[_0x38e752(0x9a5)]))_0x59ab07=_0x38e752(0x893);else{if(_0x258b83[_0x38e752(0xa20)]==='ai_image'||_0x258b83[_0x38e752(0xa20)]===_0x38e752(0xeb))_0x59ab07='[图片]';else _0x258b83[_0x38e752(0xa20)]===_0x38e752(0x719)?_0x59ab07=_0x38e752(0x2a9):_0x59ab07=_0x4eb620[_0x38e752(0x8d4)](0x0,0x32)+(_0x4eb620[_0x38e752(0x594)]>0x32?_0x38e752(0x6cb):'');}_0x1ad8ed={'timestamp':_0x258b83[_0x38e752(0x702)],'senderName':_0x2bd7cc,'content':_0x4eb620};const _0xcd9831=document['getElementById'](_0x38e752(0x93e));_0xcd9831[_0x38e752(0x5ac)](_0x38e752(0x95d))['textContent']=_0x38e752(0xed0)+_0x1ad8ed['senderName']+':',_0xcd9831[_0x38e752(0x5ac)](_0x38e752(0x8a0))[_0x38e752(0x300)]=_0x59ab07,_0xcd9831['style']['display']=_0x38e752(0x11ac),_0x5652d7(),document['getElementById'](_0x38e752(0x803))['focus']();}function _0x1f4563(){const _0x349da5=_0x241b18;_0x1ad8ed=null,document['getElementById'](_0x349da5(0x93e))[_0x349da5(0x794)]['display']=_0x349da5(0x379);}let _0x2b0f7f=null;function _0x520a19(_0xf87bbb){const _0x3a34d7=_0x241b18;_0x2b0f7f=_0xf87bbb;const _0x54599e=_0x5de8b7['chats'][_0x5de8b7[_0x3a34d7(0x93d)]],_0x4396a0=_0x54599e[_0x3a34d7(0x49e)]['find'](_0x36b4a1=>_0x36b4a1[_0x3a34d7(0x702)]===_0xf87bbb);_0x4396a0&&(document[_0x3a34d7(0x11e3)]('transfer-sender-name')[_0x3a34d7(0x300)]=_0x4396a0[_0x3a34d7(0x768)]),document[_0x3a34d7(0x11e3)](_0x3a34d7(0xbc0))[_0x3a34d7(0x505)][_0x3a34d7(0x252)]('visible');}function _0x157fc2(){const _0x2e207c=_0x241b18;document[_0x2e207c(0x11e3)](_0x2e207c(0xbc0))[_0x2e207c(0x505)][_0x2e207c(0x957)](_0x2e207c(0x250)),_0x2b0f7f=null;}async function _0x429bef(_0x2b5567){const _0x25dc9f=_0x241b18;if(!_0x2b0f7f)return;const _0x225fd5=_0x2b0f7f,_0x1266c8=_0x5de8b7[_0x25dc9f(0x737)][_0x5de8b7[_0x25dc9f(0x93d)]],_0x2203b4=_0x1266c8[_0x25dc9f(0x49e)][_0x25dc9f(0x901)](_0x1647b3=>_0x1647b3[_0x25dc9f(0x702)]===_0x225fd5);if(_0x2203b4===-0x1)return;const _0x1031b6=_0x1266c8[_0x25dc9f(0x49e)][_0x2203b4];_0x1031b6[_0x25dc9f(0x739)]=_0x2b5567;let _0x5de727;if(_0x2b5567===_0x25dc9f(0x3e1)){const _0x356a7b={'role':_0x25dc9f(0x21c),'type':_0x25dc9f(0x82b),'isRefund':!![],'amount':_0x1031b6[_0x25dc9f(0x354)],'note':_0x25dc9f(0x81d),'timestamp':Date['now']()};_0x1266c8[_0x25dc9f(0x49e)][_0x25dc9f(0xf5)](_0x356a7b),_0x5de727=_0x25dc9f(0xd94)+_0x1031b6['senderName']+_0x25dc9f(0x991);}else _0x5de727=_0x25dc9f(0x5b0)+_0x1031b6[_0x25dc9f(0x768)]+'”的转账。]';const _0x270c3e={'role':_0x25dc9f(0xf72),'content':_0x5de727,'timestamp':Date[_0x25dc9f(0x1182)]()+0x1,'isHidden':!![]};_0x1266c8[_0x25dc9f(0x49e)][_0x25dc9f(0xf5)](_0x270c3e),await _0x2e83f8[_0x25dc9f(0x737)][_0x25dc9f(0xe3c)](_0x1266c8),_0x157fc2(),_0x544ab5(_0x5de8b7['activeChatId']),_0x5ee219();}async function _0x3855ff(){const _0x3e6988=_0x241b18;_0x4e7698('call-history-screen');const _0x2ef9fe=document[_0x3e6988(0x11e3)]('call-history-list'),_0x3d1d12=document[_0x3e6988(0x11e3)](_0x3e6988(0x30f));_0x2ef9fe[_0x3e6988(0x595)]='',_0x3d1d12[_0x3e6988(0x300)]=_0x3e6988(0xe78);const _0x34cbef=await _0x2e83f8[_0x3e6988(0x516)][_0x3e6988(0x7c6)](_0x3e6988(0x702))[_0x3e6988(0x107)]()[_0x3e6988(0x508)]();if(_0x34cbef[_0x3e6988(0x594)]===0x0){_0x2ef9fe[_0x3e6988(0x595)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>';return;}_0x34cbef[_0x3e6988(0x494)](_0x164d8b=>{const _0x190012=_0x3e6988,_0x3d0d1e=_0x638301(_0x164d8b);_0xcb6204(_0x3d0d1e,async()=>{const _0x22ea46=_0x10a9,_0x58d378=await _0x231a5a(_0x22ea46(0x43b),_0x22ea46(0x1f7),_0x164d8b['customName']||'');if(_0x58d378===null)return;await _0x2e83f8[_0x22ea46(0x516)][_0x22ea46(0x1225)](_0x164d8b['id'],{'customName':_0x58d378[_0x22ea46(0xeb7)]()}),await _0x3855ff(),await _0x2fb06('成功','通话名称已更新！');}),_0x2ef9fe[_0x190012(0x120c)](_0x3d0d1e);});}function _0x638301(_0x57dbe9){const _0x4770d9=_0x241b18,_0x4c08ab=document[_0x4770d9(0x383)](_0x4770d9(0x1285));_0x4c08ab[_0x4770d9(0x3db)]='call-record-card',_0x4c08ab[_0x4770d9(0xaca)][_0x4770d9(0xf41)]=_0x57dbe9['id'];const _0x5cbfe2=_0x5de8b7['chats'][_0x57dbe9[_0x4770d9(0x115)]],_0x1da460=_0x5cbfe2?_0x5cbfe2[_0x4770d9(0x278)]:_0x4770d9(0x3c0),_0xf251a7=new Date(_0x57dbe9[_0x4770d9(0x702)]),_0x5e9b8c=_0xf251a7['getFullYear']()+'-'+String(_0xf251a7[_0x4770d9(0x39d)]()+0x1)[_0x4770d9(0xae4)](0x2,'0')+'-'+String(_0xf251a7[_0x4770d9(0x97d)]())[_0x4770d9(0xae4)](0x2,'0')+'\x20'+String(_0xf251a7[_0x4770d9(0x3de)]())[_0x4770d9(0xae4)](0x2,'0')+':'+String(_0xf251a7['getMinutes']())['padStart'](0x2,'0'),_0x2fbe86=Math[_0x4770d9(0xfb1)](_0x57dbe9[_0x4770d9(0x915)]/0x3c)+'分'+_0x57dbe9[_0x4770d9(0x915)]%0x3c+'秒',_0xfe75f8=_0x57dbe9[_0x4770d9(0x94b)][_0x4770d9(0x796)](_0x5a625b=>'<img\x20src=\x22'+_0x5a625b[_0x4770d9(0x525)]+_0x4770d9(0x1095)+_0x5a625b[_0x4770d9(0x278)]+_0x4770d9(0xf95)+_0x5a625b[_0x4770d9(0x278)]+'\x22>')['join']('');return _0x4c08ab[_0x4770d9(0x595)]=_0x4770d9(0x34f)+_0x5e9b8c+_0x4770d9(0x137)+_0x2fbe86+_0x4770d9(0x78d)+(_0x57dbe9[_0x4770d9(0xf24)]?_0x4770d9(0xdf7)+_0x57dbe9[_0x4770d9(0xf24)]+'</div>':'')+_0x4770d9(0x1110)+_0xfe75f8+_0x4770d9(0x6b5)+_0x1da460+_0x4770d9(0x412),_0x4c08ab;}async function _0x6e19d9(_0x1418aa){const _0x3cb92b=_0x241b18,_0x5e3025=await _0x2e83f8[_0x3cb92b(0x516)][_0x3cb92b(0x1289)](_0x1418aa);if(!_0x5e3025)return;const _0x595e1e=document['getElementById'](_0x3cb92b(0x12d7)),_0x37da4b=document[_0x3cb92b(0x11e3)]('transcript-modal-title'),_0x432f94=document[_0x3cb92b(0x11e3)](_0x3cb92b(0x234));_0x37da4b[_0x3cb92b(0x300)]=_0x3cb92b(0xfdb)+new Date(_0x5e3025[_0x3cb92b(0x702)])['toLocaleString']()+_0x3cb92b(0x934)+Math[_0x3cb92b(0xfb1)](_0x5e3025[_0x3cb92b(0x915)]/0x3c)+'分'+_0x5e3025[_0x3cb92b(0x915)]%0x3c+'秒)',_0x432f94[_0x3cb92b(0x595)]='';const _0x581170=document[_0x3cb92b(0x11e3)]('delete-transcript-btn'),_0x53bcfd=document[_0x3cb92b(0x11e3)](_0x3cb92b(0x8a8));!_0x5e3025[_0x3cb92b(0x9f3)]||_0x5e3025[_0x3cb92b(0x9f3)]['length']===0x0?(_0x432f94[_0x3cb92b(0x595)]=_0x3cb92b(0xa1a),_0x53bcfd[_0x3cb92b(0x794)][_0x3cb92b(0x33d)]=_0x3cb92b(0x379)):(_0x53bcfd[_0x3cb92b(0x794)][_0x3cb92b(0x33d)]=_0x3cb92b(0x11ac),_0x5e3025[_0x3cb92b(0x9f3)][_0x3cb92b(0x494)](_0x3e39d2=>{const _0x2578f4=_0x3cb92b,_0x11fca5=document[_0x2578f4(0x383)](_0x2578f4(0x1285));_0x11fca5[_0x2578f4(0x3db)]='transcript-entry\x20'+_0x3e39d2['role'],_0x11fca5[_0x2578f4(0x300)]=_0x3e39d2[_0x2578f4(0x9a5)],_0x432f94[_0x2578f4(0x120c)](_0x11fca5);}));const _0x2d59f3=_0x581170[_0x3cb92b(0x4b4)](!![]);_0x581170['parentNode']['replaceChild'](_0x2d59f3,_0x581170);const _0x26eb5e=_0x53bcfd[_0x3cb92b(0x4b4)](!![]);_0x53bcfd['parentNode']['replaceChild'](_0x26eb5e,_0x53bcfd),_0x2d59f3[_0x3cb92b(0x4b8)](_0x3cb92b(0x1041),async()=>{const _0x23159e=_0x3cb92b,_0x22b558=await _0x58fd60(_0x23159e(0x1166),'确定要永久删除这条通话记录吗？此操作不可恢复。',{'confirmButtonClass':_0x23159e(0x8a6)});_0x22b558&&(_0x595e1e['classList'][_0x23159e(0x957)]('visible'),await _0x2e83f8['callRecords']['delete'](_0x1418aa),await _0x3855ff(),alert(_0x23159e(0x1126)));}),_0x26eb5e[_0x3cb92b(0x4b8)](_0x3cb92b(0x1041),async()=>{const _0x42ed7a=_0x3cb92b,_0x46565f=await _0x58fd60('确认操作',_0x42ed7a(0xa1),{'confirmText':_0x42ed7a(0xafc)});if(!_0x46565f)return;_0x595e1e[_0x42ed7a(0x505)][_0x42ed7a(0x957)](_0x42ed7a(0x250));const _0x4c76a3=_0x5de8b7[_0x42ed7a(0x737)][_0x5e3025[_0x42ed7a(0x115)]];if(!_0x4c76a3){alert('错误：找不到该通话记录所属的聊天对象。');return;}await _0x2fb06(_0x42ed7a(0x63d),_0x42ed7a(0x231));try{const _0x280a0e=_0x5e3025[_0x42ed7a(0x9f3)]['map'](_0x5d8f26=>{const _0x1747fe=_0x42ed7a,_0x4b4378=_0x5d8f26[_0x1747fe(0xba4)]===_0x1747fe(0x21c)?_0x4c76a3['settings'][_0x1747fe(0xca7)]||'我':_0x5d8f26['senderName']||_0x4c76a3['name'];return _0x4b4378+':\x20'+_0x5d8f26[_0x1747fe(0x9a5)];})[_0x42ed7a(0xa4b)]('\x0a');await _0x539172(_0x5e3025[_0x42ed7a(0x115)],_0x280a0e),await _0x2fb06(_0x42ed7a(0x9b4),'手动总结已完成！新的记忆已添加到“'+_0x4c76a3[_0x42ed7a(0x278)]+_0x42ed7a(0x80c));}catch(_0x8a0ed7){await _0x2fb06('总结失败',_0x42ed7a(0x1295)+_0x8a0ed7[_0x42ed7a(0x4bc)]);}});const _0x5d6fcc=document['getElementById']('close-transcript-modal-btn'),_0x1848ac=_0x5d6fcc['cloneNode'](!![]);_0x5d6fcc[_0x3cb92b(0x18c)][_0x3cb92b(0xeaa)](_0x1848ac,_0x5d6fcc),_0x1848ac[_0x3cb92b(0x4b8)](_0x3cb92b(0x1041),()=>{const _0xbf5fd6=_0x3cb92b;_0x595e1e['classList']['remove'](_0xbf5fd6(0x250));}),_0x595e1e[_0x3cb92b(0x505)][_0x3cb92b(0x252)](_0x3cb92b(0x250));}async function _0x17b625(){const _0x20a4a3=_0x241b18;if(!_0x5de8b7[_0x20a4a3(0x93d)]||_0x5de8b7[_0x20a4a3(0x737)][_0x5de8b7[_0x20a4a3(0x93d)]][_0x20a4a3(0x1244)])return;const _0x50307e=_0x5de8b7[_0x20a4a3(0x737)][_0x5de8b7[_0x20a4a3(0x93d)]],_0x1a3e0a=await _0x231a5a(_0x20a4a3(0x3bf),_0x20a4a3(0x6f8),_0x50307e[_0x20a4a3(0x739)][_0x20a4a3(0x1197)]);_0x1a3e0a!==null&&(_0x50307e['status'][_0x20a4a3(0x1197)]=_0x1a3e0a[_0x20a4a3(0xeb7)]()||'在线',_0x50307e[_0x20a4a3(0x739)]['isBusy']=![],_0x50307e[_0x20a4a3(0x739)][_0x20a4a3(0x136)]=Date['now'](),await _0x2e83f8['chats'][_0x20a4a3(0xe3c)](_0x50307e),_0x544ab5(_0x5de8b7['activeChatId']),_0x5ee219(),await _0x2fb06(_0x20a4a3(0xf18),'“'+_0x50307e[_0x20a4a3(0x278)]+_0x20a4a3(0x9d6)+_0x50307e[_0x20a4a3(0x739)][_0x20a4a3(0x1197)]));}async function _0x4a28bb(){const _0x57543d=_0x241b18,_0x32ac56=document[_0x57543d(0x11e3)](_0x57543d(0xb51)),_0x840e5c=document[_0x57543d(0x11e3)](_0x57543d(0x5a6));_0x840e5c[_0x57543d(0x595)]='';const _0x83069=Object[_0x57543d(0x4ca)](_0x5de8b7['chats']);_0x83069[_0x57543d(0x494)](_0x30d8eb=>{const _0x2ad78b=_0x57543d,_0x497c63=document['createElement'](_0x2ad78b(0x1285));_0x497c63[_0x2ad78b(0x3db)]=_0x2ad78b(0x9b3),_0x497c63[_0x2ad78b(0x595)]=_0x2ad78b(0xb2a)+_0x30d8eb['id']+_0x2ad78b(0x78c)+(_0x30d8eb[_0x2ad78b(0x1244)]?_0x30d8eb['settings'][_0x2ad78b(0x75c)]:_0x30d8eb['settings']['aiAvatar']||_0x3d2e44)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x30d8eb[_0x2ad78b(0x278)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x840e5c[_0x2ad78b(0x120c)](_0x497c63);}),_0x32ac56[_0x57543d(0x505)][_0x57543d(0x252)]('visible');}function _0x46c07e(_0x26d455){const _0x154651=_0x241b18,_0x22eaf2=document[_0x154651(0x11e3)](_0x154651(0xbb4));if(!_0x22eaf2['classList'][_0x154651(0x1121)]('visible')){if(_0x26d455)_0x26d455();return;}_0x22eaf2[_0x154651(0x505)][_0x154651(0x957)](_0x154651(0x250)),setTimeout(()=>{const _0x6da522=_0x154651;document[_0x6da522(0x11e3)](_0x6da522(0x7ad))['classList']['remove'](_0x6da522(0x250));if(_0x26d455)_0x26d455();},0x190);}function _0x2a2377(_0x43b4d1){const _0x1467e8=_0x241b18;if(!_0x43b4d1)return[];const _0xd8fb31=String(_0x43b4d1)[_0x1467e8(0x65b)](/\r\n?|\n/),_0x533101=[],_0x1f991e=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0x1a84a7 of _0xd8fb31){const _0x5ea77e=_0x1a84a7['replace'](_0x1f991e,'')[_0x1467e8(0xeb7)]();if(!_0x5ea77e)continue;_0x1f991e['lastIndex']=0x0;let _0x184f92;while((_0x184f92=_0x1f991e[_0x1467e8(0xf3e)](_0x1a84a7))!==null){const _0x5dd3b6=parseInt(_0x184f92[0x1],0xa),_0x458365=parseInt(_0x184f92[0x2],0xa),_0x49da38=parseInt(_0x184f92[0x3][_0x1467e8(0x6d8)](0x3,'0'),0xa),_0x29aeb2=_0x5dd3b6*0x3c+_0x458365+_0x49da38/0x3e8;_0x533101[_0x1467e8(0xf5)]({'time':_0x29aeb2,'text':_0x5ea77e});}}return _0x533101[_0x1467e8(0x861)]((_0x17c97d,_0x3b4990)=>_0x17c97d[_0x1467e8(0x1c7)]-_0x3b4990['time']);}function _0x45cb2c(){const _0xfc4553=_0x241b18,_0x41639e=document[_0xfc4553(0x11e3)](_0xfc4553(0x418));_0x41639e['innerHTML']='';if(!_0xb57b5b['parsedLyrics']||_0xb57b5b[_0xfc4553(0x1194)][_0xfc4553(0x594)]===0x0){_0x41639e['innerHTML']='<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>';return;}_0xb57b5b[_0xfc4553(0x1194)][_0xfc4553(0x494)]((_0xfbf8a2,_0x26b702)=>{const _0x241fe8=_0xfc4553,_0x2ccabf=document[_0x241fe8(0x383)](_0x241fe8(0x1285));_0x2ccabf[_0x241fe8(0x3db)]=_0x241fe8(0xd80),_0x2ccabf[_0x241fe8(0x300)]=_0xfbf8a2['text'],_0x2ccabf[_0x241fe8(0xaca)][_0x241fe8(0xd15)]=_0x26b702,_0x41639e[_0x241fe8(0x120c)](_0x2ccabf);}),_0x41639e[_0xfc4553(0x794)]['transform']=_0xfc4553(0x17b);}function _0x3e1d42(_0x5ca09e){const _0x35bbb8=_0x241b18;if(_0xb57b5b[_0x35bbb8(0x1194)]['length']===0x0)return;let _0x2a3455=-0x1;for(let _0xe1c92=0x0;_0xe1c92<_0xb57b5b[_0x35bbb8(0x1194)]['length'];_0xe1c92++){if(_0x5ca09e>=_0xb57b5b['parsedLyrics'][_0xe1c92][_0x35bbb8(0x1c7)])_0x2a3455=_0xe1c92;else break;}if(_0x2a3455===_0xb57b5b[_0x35bbb8(0xe39)])return;_0xb57b5b[_0x35bbb8(0xe39)]=_0x2a3455,_0x15ee6e();const _0x321dec=document['getElementById'](_0x35bbb8(0x2f5));_0x321dec&&(_0x2a3455>-0x1&&_0xb57b5b[_0x35bbb8(0x1194)][_0x2a3455]?_0x321dec[_0x35bbb8(0x300)]=_0xb57b5b[_0x35bbb8(0x1194)][_0x2a3455][_0x35bbb8(0x1197)]:_0x321dec['textContent']=_0x35bbb8(0xda3));const _0x11eb1f=document[_0x35bbb8(0x11e3)](_0x35bbb8(0x68d));_0x11eb1f[_0x35bbb8(0x505)][_0x35bbb8(0x1121)](_0x35bbb8(0x250))&&(_0x2a3455>-0x1&&_0xb57b5b[_0x35bbb8(0x1194)][_0x2a3455]?_0x11eb1f[_0x35bbb8(0x300)]=_0xb57b5b[_0x35bbb8(0x1194)][_0x2a3455][_0x35bbb8(0x1197)]:_0x11eb1f[_0x35bbb8(0x300)]='♪');}function _0x15ee6e(_0x187749=![]){const _0x465a47=_0x241b18,_0x49a5af=_0x187749?_0x465a47(0xe2d):'#music-lyrics-container\x20#music-lyrics-list',_0x120725=_0x187749?_0x465a47(0xcf7):_0x465a47(0x6a6),_0x4fe70e=document[_0x465a47(0x5ac)](_0x49a5af),_0x1dc78a=document[_0x465a47(0x5ac)](_0x120725);if(!_0x4fe70e||!_0x1dc78a)return;const _0x9aac78=_0x4fe70e[_0x465a47(0x10d6)]('.lyric-line');_0x9aac78[_0x465a47(0x494)](_0x1c8eb3=>_0x1c8eb3[_0x465a47(0x505)][_0x465a47(0x957)](_0x465a47(0x1fc)));if(_0xb57b5b[_0x465a47(0xe39)]===-0x1){_0x4fe70e['style'][_0x465a47(0xb5d)]=_0x465a47(0x17b);return;}const _0x107b3b=_0x4fe70e[_0x465a47(0x5ac)](_0x465a47(0x735)+_0xb57b5b['currentLyricIndex']+'\x22]');if(_0x107b3b){_0x107b3b[_0x465a47(0x505)][_0x465a47(0x252)](_0x465a47(0x1fc));const _0x4d1c31=_0x1dc78a['offsetHeight'],_0x4b775c=_0x4d1c31/2.2-_0x107b3b[_0x465a47(0x946)]-_0x107b3b['offsetHeight']/0x2;_0x4fe70e[_0x465a47(0x794)][_0x465a47(0xb5d)]=_0x465a47(0xc7d)+_0x4b775c+_0x465a47(0xd24);}}function _0x5ce2fd(_0x490864){const _0x34db1b=_0x241b18;if(isNaN(_0x490864)||_0x490864<0x0)return _0x34db1b(0x10fb);const _0x3b9624=Math[_0x34db1b(0xfb1)](_0x490864/0x3c),_0x5ab658=Math['floor'](_0x490864%0x3c);return _0x3b9624+':'+String(_0x5ab658)[_0x34db1b(0xae4)](0x2,'0');}let _0xd9a44=0x0,_0x40ca92;function _0x483d71(){_0x40ca92&&cancelAnimationFrame(_0x40ca92);function _0x3178db(){const _0x148e3f=_0x10a9;if(!_0xb57b5b[_0x148e3f(0x9b0)]||!_0x7cf0d1[_0x148e3f(0x915)])return;const _0x31cff8=performance[_0x148e3f(0x1182)](),_0x467b66=_0x7cf0d1[_0x148e3f(0x1056)],_0x10ee51=_0x7cf0d1[_0x148e3f(0x915)],_0x31f213=_0x467b66/_0x10ee51*0x64;document['getElementById']('music-progress-fill')[_0x148e3f(0x794)][_0x148e3f(0x1057)]=_0x31f213+'%',_0x31cff8-_0xd9a44>0x3e8&&(document[_0x148e3f(0x11e3)]('music-current-time')['textContent']=_0x5ce2fd(_0x467b66),document[_0x148e3f(0x11e3)]('music-total-time')[_0x148e3f(0x300)]=_0x5ce2fd(_0x10ee51),_0xd9a44=_0x31cff8),_0x3e1d42(_0x467b66),_0x40ca92=requestAnimationFrame(_0x3178db);}_0x40ca92=requestAnimationFrame(_0x3178db);}function _0x4a5d45(){const _0xcd36b0=_0x241b18;if(!lastRawAiResponse){alert('还没有可供编辑的AI响应。请先让AI回复一次。');return;}const _0x32ac6b=document[_0xcd36b0(0x11e3)](_0xcd36b0(0x480)),_0x491e4f=document[_0xcd36b0(0x11e3)](_0xcd36b0(0xc25));_0x491e4f[_0xcd36b0(0x595)]='';const _0x538611=lastRawAiResponse[_0xcd36b0(0xe9f)](/{[^{}]*}/g);if(_0x538611)_0x538611[_0xcd36b0(0x494)](_0xeb361a=>{const _0x1a5aa8=_0xcd36b0;try{const _0x29da65=JSON['parse'](_0xeb361a),_0x3b6e06=JSON['stringify'](_0x29da65,null,0x2),_0x13eb66=_0x4dc376(_0x3b6e06);_0x491e4f['appendChild'](_0x13eb66);}catch(_0x4b0628){const _0x525fe9=_0x4dc376(_0xeb361a);_0x491e4f[_0x1a5aa8(0x120c)](_0x525fe9),console[_0x1a5aa8(0x6b0)](_0x1a5aa8(0x11df),_0xeb361a);}});else{const _0x5138e3=_0x4dc376(lastRawAiResponse);_0x491e4f[_0xcd36b0(0x120c)](_0x5138e3);}_0x32ac6b[_0xcd36b0(0x505)][_0xcd36b0(0x252)](_0xcd36b0(0x250));}function _0x4dc376(_0x4897f2=''){const _0x5eb131=_0x241b18,_0x5e3ecb=document[_0x5eb131(0x383)](_0x5eb131(0x1285));_0x5e3ecb['className']=_0x5eb131(0x7e6);const _0x3e52e4={'text':{'type':_0x5eb131(0x1197),'content':_0x5eb131(0x4ea)},'sticker':{'type':'sticker','url':_0x5eb131(0x959),'meaning':_0x5eb131(0xeca)},'image':{'type':_0x5eb131(0xd02),'description':'在这里输入图片描述...'},'voice':{'type':_0x5eb131(0x719),'content':_0x5eb131(0x3aa)},'transfer':{'type':_0x5eb131(0x82b),'amount':5.2,'note':_0x5eb131(0xa74)},'offline':{'type':_0x5eb131(0xd71),'content':'「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)'},'quote':{'type':_0x5eb131(0x229),'target_timestamp':0x499602d2,'reply_content':'在这里输入回复内容'}};return _0x5e3ecb['innerHTML']=_0x5eb131(0xe51)+_0x4897f2+_0x5eb131(0xd1c)+JSON[_0x5eb131(0x313)](_0x3e52e4[_0x5eb131(0x1197)])+_0x5eb131(0xe8)+JSON[_0x5eb131(0x313)](_0x3e52e4[_0x5eb131(0x87b)])+_0x5eb131(0x121a)+JSON['stringify'](_0x3e52e4[_0x5eb131(0x6e9)])+_0x5eb131(0x14e)+JSON['stringify'](_0x3e52e4[_0x5eb131(0x835)])+_0x5eb131(0x583)+JSON['stringify'](_0x3e52e4[_0x5eb131(0x82b)])+'\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x5eb131(0x313)](_0x3e52e4[_0x5eb131(0xbe2)])+_0x5eb131(0xbe5)+JSON['stringify'](_0x3e52e4[_0x5eb131(0xb9)])+_0x5eb131(0x8de),_0x5e3ecb[_0x5eb131(0x5ac)]('.delete-block-btn')[_0x5eb131(0x4b8)](_0x5eb131(0x1041),()=>{const _0x5646ea=_0x5eb131;_0x5e3ecb[_0x5646ea(0x957)]();}),_0x5e3ecb[_0x5eb131(0x10d6)]('.format-btn')['forEach'](_0x5b7efc=>{const _0x11e5ce=_0x5eb131;_0x5b7efc[_0x11e5ce(0x4b8)](_0x11e5ce(0x1041),()=>{const _0xb1a08e=_0x11e5ce,_0x117182=_0x5b7efc[_0xb1a08e(0xaca)]['template'],_0x4fac44=_0x5e3ecb[_0xb1a08e(0x5ac)]('textarea');if(_0x117182&&_0x4fac44)try{const _0x5932da=JSON[_0xb1a08e(0xb0c)](_0x117182);_0x4fac44[_0xb1a08e(0xf27)]=JSON[_0xb1a08e(0x313)](_0x5932da,null,0x2),_0x4fac44[_0xb1a08e(0xc1f)]();}catch(_0x38f88d){console[_0xb1a08e(0x1c1)]('解析格式模板失败:',_0x38f88d);}});}),_0x5e3ecb;}async function _0x512f94(){const _0x3e442d=_0x241b18,_0x18abb4=_0x5de8b7[_0x3e442d(0x737)][_0x5de8b7[_0x3e442d(0x93d)]];if(!_0x18abb4)return;const _0x5e4a9c=document[_0x3e442d(0x11e3)](_0x3e442d(0xc25)),_0x5931a0=_0x5e4a9c['querySelectorAll'](_0x3e442d(0x10bb)),_0x30d00d=Array[_0x3e442d(0xee2)](_0x5931a0)[_0x3e442d(0x796)](_0x241016=>_0x241016[_0x3e442d(0xf27)]['trim']())[_0x3e442d(0x138)](Boolean);if(_0x30d00d[_0x3e442d(0x594)]===0x0){_0x18abb4[_0x3e442d(0x49e)]=_0x18abb4[_0x3e442d(0x49e)]['filter'](_0x20ac9d=>!lastResponseTimestamps[_0x3e442d(0x3ad)](_0x20ac9d['timestamp'])),await _0x2e83f8[_0x3e442d(0x737)][_0x3e442d(0xe3c)](_0x18abb4),_0x544ab5(_0x5de8b7[_0x3e442d(0x93d)]),_0x5ee219(),document['getElementById'](_0x3e442d(0x480))[_0x3e442d(0x505)][_0x3e442d(0x957)](_0x3e442d(0x250)),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0x3fc81e=[];for(const _0x1d9ed5 of _0x30d00d){try{const _0x50ecdb=JSON[_0x3e442d(0xb0c)](_0x1d9ed5);_0x3fc81e['push'](_0x50ecdb);}catch(_0x16693d){console[_0x3e442d(0x6b0)]('跳过一个无法解析为JSON的编辑块:',_0x1d9ed5);}}_0x18abb4['history']=_0x18abb4[_0x3e442d(0x49e)][_0x3e442d(0x138)](_0x43ba79=>!lastResponseTimestamps[_0x3e442d(0x3ad)](_0x43ba79[_0x3e442d(0x702)]));let _0x25accd=[],_0x5d6675=Date['now']();for(const _0x13189d of _0x3fc81e){if(!_0x13189d||typeof _0x13189d!==_0x3e442d(0x537)||!_0x13189d['type']){console[_0x3e442d(0x6b0)]('在导演模式保存时，发现无效的指令对象，已跳过:',_0x13189d);continue;}let _0x5a5425=null;const _0x1a6233={'role':_0x3e442d(0x1119),'senderName':_0x13189d[_0x3e442d(0x278)]||_0x18abb4[_0x3e442d(0x697)],'timestamp':_0x5d6675++};switch(_0x13189d[_0x3e442d(0xa20)]){case _0x3e442d(0x1197):_0x5a5425={..._0x1a6233,'content':String(_0x13189d[_0x3e442d(0x9a5)]||_0x13189d[_0x3e442d(0x4bc)])};break;case _0x3e442d(0x87b):{let _0x38c0ec=![];if(_0x13189d['url']&&_0x13189d['meaning'])_0x5a5425={..._0x1a6233,'type':'sticker','content':_0x13189d[_0x3e442d(0x10ac)],'meaning':_0x13189d[_0x3e442d(0xb36)]},console[_0x3e442d(0x84b)](_0x3e442d(0xc94)),_0x38c0ec=!![];else{if(_0x13189d[_0x3e442d(0xb36)]){const _0x347380=_0x5de8b7[_0x3e442d(0xa67)][_0x3e442d(0xe79)](_0x51f5d9=>_0x51f5d9[_0x3e442d(0x278)]===_0x13189d[_0x3e442d(0xb36)]);_0x347380?(_0x5a5425={..._0x1a6233,'type':_0x3e442d(0x87b),'content':_0x347380[_0x3e442d(0x10ac)],'meaning':_0x347380[_0x3e442d(0x278)]},console[_0x3e442d(0x84b)]('导演模式保存(Sticker):\x20使用了\x20meaning\x20查找'),_0x38c0ec=!![]):(_0x5a5425={..._0x1a6233,'type':_0x3e442d(0x1197),'content':_0x3e442d(0x119f)+_0x13189d['meaning']+']'},console[_0x3e442d(0x6b0)](_0x3e442d(0x240),_0x13189d['meaning']),_0x38c0ec=!![]);}else{if(_0x13189d['url']){_0x5a5425={..._0x1a6233,'type':_0x3e442d(0x87b),'content':_0x13189d[_0x3e442d(0x10ac)]};const _0x583a77=_0x5de8b7[_0x3e442d(0xa67)][_0x3e442d(0xe79)](_0x52fa7a=>_0x52fa7a[_0x3e442d(0x10ac)]===_0x13189d[_0x3e442d(0x10ac)]);_0x5a5425[_0x3e442d(0xb36)]=_0x583a77?_0x583a77['name']:_0x3e442d(0x10df),console[_0x3e442d(0x84b)](_0x3e442d(0x22f),_0x5a5425['meaning']),_0x38c0ec=!![];}else{if(_0x13189d[_0x3e442d(0x9a5)]&&typeof _0x13189d[_0x3e442d(0x9a5)]===_0x3e442d(0x10d7)&&_0x9f9ac4[_0x3e442d(0x1043)](_0x13189d[_0x3e442d(0x9a5)])){_0x5a5425={..._0x1a6233,'type':_0x3e442d(0x87b),'content':_0x13189d[_0x3e442d(0x9a5)]};const _0x23614a=_0x5de8b7['userStickers'][_0x3e442d(0xe79)](_0x34800e=>_0x34800e[_0x3e442d(0x10ac)]===_0x13189d[_0x3e442d(0x9a5)]);_0x5a5425['meaning']=_0x23614a?_0x23614a[_0x3e442d(0x278)]:'未知表情',console[_0x3e442d(0x84b)](_0x3e442d(0x559),_0x5a5425['meaning']),_0x38c0ec=!![];}}}}if(!_0x38c0ec){console['error']('导演模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):',_0x13189d);continue;}break;}case _0x3e442d(0xd02):_0x5a5425={..._0x1a6233,'type':_0x3e442d(0xd02),'content':_0x13189d['description']};break;case _0x3e442d(0x719):_0x5a5425={..._0x1a6233,'type':'voice_message','content':_0x13189d[_0x3e442d(0x9a5)]};break;case _0x3e442d(0x82b):_0x5a5425={..._0x1a6233,'type':_0x3e442d(0x82b),'amount':_0x13189d[_0x3e442d(0x354)],'note':_0x13189d[_0x3e442d(0x1213)],'receiverName':_0x13189d[_0x3e442d(0xf13)]||'我'};break;case'waimai_request':_0x5a5425={..._0x1a6233,'type':_0x3e442d(0x123b),'productInfo':_0x13189d[_0x3e442d(0x1253)],'amount':_0x13189d[_0x3e442d(0x354)],'status':_0x3e442d(0x5d2),'countdownEndTime':Date[_0x3e442d(0x1182)]()+0xf*0x3c*0x3e8};break;case _0x3e442d(0xd71):_0x5a5425={..._0x1a6233,..._0x13189d};break;case _0x3e442d(0x9a7):{const _0x2e3e29=_0x17be1a[_0x18abb4['id']];if(_0x2e3e29){const _0x379b79=_0x2e3e29['history']['findLastIndex'](_0x315af7=>_0x315af7[_0x3e442d(0xfc9)]===0x2);if(_0x379b79>-0x1){const _0x5641ae=_0x2e3e29[_0x3e442d(0x49e)][_0x379b79];_0x2e3e29[_0x3e442d(0x8da)][_0x5641ae['y']][_0x5641ae['x']]=0x0,_0x2e3e29['history'][_0x3e442d(0xfd0)](_0x379b79,0x1),console[_0x3e442d(0x84b)](_0x3e442d(0x506)+_0x5641ae['x']+',\x20'+_0x5641ae['y']+')\x20的棋步。');}}const _0x5dff8c=parseInt(_0x13189d['x']),_0xe48046=parseInt(_0x13189d['y']);!isNaN(_0x5dff8c)&&!isNaN(_0xe48046)?_0x416bbd({'x':_0x5dff8c,'y':_0xe48046},!![]):console[_0x3e442d(0x6b0)](_0x3e442d(0xe33),_0x13189d);continue;}case _0x3e442d(0x98f):{if(!_0x18abb4[_0x3e442d(0x1244)]){_0x13189d['heartfelt_voice']&&(_0x18abb4[_0x3e442d(0x535)]=String(_0x13189d[_0x3e442d(0x114d)]));_0x13189d[_0x3e442d(0xc2c)]&&(_0x18abb4[_0x3e442d(0x267)]=String(_0x13189d[_0x3e442d(0xc2c)]));!Array[_0x3e442d(0xb7b)](_0x18abb4[_0x3e442d(0x6d3)])&&(_0x18abb4[_0x3e442d(0x6d3)]=[]);_0x18abb4['thoughtsHistory'][_0x3e442d(0xf5)]({'heartfeltVoice':_0x18abb4[_0x3e442d(0x535)],'randomJottings':_0x18abb4['randomJottings'],'timestamp':Date[_0x3e442d(0x1182)]()});_0x18abb4[_0x3e442d(0x6d3)][_0x3e442d(0x594)]>0x32&&_0x18abb4[_0x3e442d(0x6d3)][_0x3e442d(0xcd6)]();const _0xd684fc=_0x3e442d(0x11ef)+_0x18abb4[_0x3e442d(0x535)]+'\x0a-\x20散记:\x20'+_0x18abb4[_0x3e442d(0x267)],_0x26cf57={'role':'system','content':_0xd684fc,'timestamp':Date[_0x3e442d(0x1182)](),'isHidden':!![]};}continue;}case _0x3e442d(0x229):{const _0x9e4df0=_0x18abb4[_0x3e442d(0x49e)]['find'](_0x1cf52e=>_0x1cf52e[_0x3e442d(0x702)]===_0x13189d[_0x3e442d(0x47a)]);let _0xa4ad67=null;if(_0x9e4df0){let _0x257de6=_0x9e4df0[_0x3e442d(0x768)];_0x9e4df0[_0x3e442d(0xba4)]===_0x3e442d(0x21c)&&(_0x257de6=_0x18abb4[_0x3e442d(0x1244)]?_0x18abb4[_0x3e442d(0x761)][_0x3e442d(0xca7)]||'我':_0x5de8b7['qzoneSettings'][_0x3e442d(0xa33)]||'{{user}}'),_0xa4ad67={'timestamp':_0x13189d['target_timestamp'],'senderName':_0x257de6,'content':String(_0x9e4df0[_0x3e442d(0x9a5)]||'')};}else _0xa4ad67={'timestamp':_0x13189d[_0x3e442d(0x47a)],'senderName':_0x3e442d(0xcf4),'content':_0x3e442d(0xb0d)};_0x5a5425={..._0x1a6233,'content':_0x13189d[_0x3e442d(0x8f8)],'quote':_0xa4ad67};break;}default:console[_0x3e442d(0x6b0)]('在导演模式保存时，遇到了未知的AI指令类型:',_0x13189d[_0x3e442d(0xa20)]);break;}_0x5a5425&&(_0x18abb4[_0x3e442d(0x49e)][_0x3e442d(0xf5)](_0x5a5425),_0x25accd['push'](_0x5a5425['timestamp']));}await _0x2e83f8[_0x3e442d(0x737)][_0x3e442d(0xe3c)](_0x18abb4),_0x544ab5(_0x5de8b7[_0x3e442d(0x93d)]),_0x5ee219(),document[_0x3e442d(0x11e3)]('ai-response-editor-modal')[_0x3e442d(0x505)][_0x3e442d(0x957)](_0x3e442d(0x250)),lastRawAiResponse=_0x30d00d[_0x3e442d(0xa4b)]('\x0a\x0a'),lastResponseTimestamps=_0x25accd,await _0x2fb06(_0x3e442d(0xaef),'您的修改已保存！');}async function _0x147c0a(){const _0x24f051=_0x241b18;if(!_0x50fd7c)return;const _0x52026a=0x2*0x3c*0x3e8,_0x3b8813=_0x50fd7c,_0x47305e=Date[_0x24f051(0x1182)]();if(_0x47305e-_0x3b8813>_0x52026a){_0x5652d7(),await _0x2fb06(_0x24f051(0x1177),_0x24f051(0x988));return;}await _0x3ea8c1(_0x3b8813,!![]),_0x5652d7();}async function _0x3ea8c1(_0x5ec9a5,_0x51090c){const _0x414bda=_0x241b18,_0x121519=_0x5de8b7[_0x414bda(0x737)][_0x5de8b7[_0x414bda(0x93d)]];if(!_0x121519)return;const _0x5aef57=_0x121519['history'][_0x414bda(0x901)](_0x52ca94=>_0x52ca94[_0x414bda(0x702)]===_0x5ec9a5);if(_0x5aef57===-0x1)return;const _0x2111fb=_0x121519[_0x414bda(0x49e)][_0x5aef57],_0x53d1ba={'originalType':_0x2111fb[_0x414bda(0xa20)]||'text','originalContent':_0x2111fb[_0x414bda(0x9a5)],'originalMeaning':_0x2111fb[_0x414bda(0xb36)],'originalQuote':_0x2111fb[_0x414bda(0xb9)]};_0x2111fb[_0x414bda(0xa20)]='recalled_message',_0x2111fb[_0x414bda(0x9a5)]=_0x51090c?_0x414bda(0x924):_0x414bda(0xdd2),_0x2111fb[_0x414bda(0xae6)]=_0x53d1ba,delete _0x2111fb['meaning'],delete _0x2111fb[_0x414bda(0xb9)];if(_0x51090c){const _0x3ff4be=_0x121519[_0x414bda(0x1244)]?_0x121519[_0x414bda(0x761)][_0x414bda(0xca7)]||'我':'我';let _0xf745ce='';if(_0x53d1ba[_0x414bda(0x469)]==='sticker')_0xf745ce=_0x414bda(0x1098)+(_0x53d1ba[_0x414bda(0x2ea)]||'未知')+']';else _0x53d1ba[_0x414bda(0x469)]===_0x414bda(0xd02)||_0x53d1ba[_0x414bda(0x469)]===_0x414bda(0xeb)?_0xf745ce=_0x414bda(0x90b)+_0x53d1ba[_0x414bda(0x5ab)]+']':_0xf745ce='“'+String(_0x53d1ba[_0x414bda(0x5ab)])+'”';const _0x393ec3={'role':_0x414bda(0xf72),'content':'[系统提示：用户（'+_0x3ff4be+_0x414bda(0xa85)+_0xf745ce+_0x414bda(0xf5f),'timestamp':Date[_0x414bda(0x1182)](),'isHidden':!![]};_0x121519[_0x414bda(0x49e)][_0x414bda(0xf5)](_0x393ec3);}await _0x2e83f8['chats'][_0x414bda(0xe3c)](_0x121519),_0x544ab5(_0x5de8b7[_0x414bda(0x93d)]),_0x51090c&&(_0x5ee219(),_0x14a9f0());}async function _0xcb361d(){const _0x5ba170=_0x241b18;await _0x36912b(),document[_0x5ba170(0x11e3)]('world-book-category-manager-modal')[_0x5ba170(0x505)][_0x5ba170(0x252)]('visible');}async function _0x36912b(){const _0x4da702=_0x241b18,_0x4f5049=document[_0x4da702(0x11e3)](_0x4da702(0xf88)),_0x548ee5=await _0x2e83f8[_0x4da702(0xaac)][_0x4da702(0x508)]();_0x4f5049[_0x4da702(0x595)]='',_0x548ee5[_0x4da702(0x594)]===0x0&&(_0x4f5049[_0x4da702(0x595)]=_0x4da702(0x85d)),_0x548ee5[_0x4da702(0x494)](_0x5aef0b=>{const _0x2a2286=_0x4da702,_0x35adc6=document[_0x2a2286(0x383)](_0x2a2286(0x1285));_0x35adc6[_0x2a2286(0x3db)]='existing-group-item',_0x35adc6[_0x2a2286(0x595)]=_0x2a2286(0x1f1)+_0x5aef0b[_0x2a2286(0x278)]+_0x2a2286(0xc54)+_0x5aef0b['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4f5049['appendChild'](_0x35adc6);});}async function _0x4cd073(){const _0x3e0f5a=_0x241b18,_0x3822ae=document[_0x3e0f5a(0x11e3)](_0x3e0f5a(0x1d8)),_0x542999=_0x3822ae[_0x3e0f5a(0xf27)]['trim']();if(!_0x542999){alert(_0x3e0f5a(0x4a2));return;}const _0x1f473b=await _0x2e83f8[_0x3e0f5a(0xaac)][_0x3e0f5a(0x129e)](_0x3e0f5a(0x278))['equals'](_0x542999)[_0x3e0f5a(0x12c1)]();if(_0x1f473b){alert(_0x3e0f5a(0x1239)+_0x542999+_0x3e0f5a(0xc96));return;}await _0x2e83f8['worldBookCategories'][_0x3e0f5a(0x252)]({'name':_0x542999}),_0x3822ae[_0x3e0f5a(0xf27)]='',await _0x36912b();}async function _0x7dfc67(_0x5f4b2b){const _0xfbd881=_0x241b18,_0x338bcd=await _0x58fd60('确认删除',_0xfbd881(0xa2d),{'confirmButtonClass':_0xfbd881(0x8a6)});if(_0x338bcd){await _0x2e83f8['worldBookCategories'][_0xfbd881(0xc0c)](_0x5f4b2b);const _0x55c3f9=await _0x2e83f8['worldBooks']['where'](_0xfbd881(0x9ee))[_0xfbd881(0x119e)](_0x5f4b2b)[_0xfbd881(0x508)]();for(const _0x190d78 of _0x55c3f9){_0x190d78['categoryId']=null,await _0x2e83f8[_0xfbd881(0xca)][_0xfbd881(0xe3c)](_0x190d78);const _0x468758=_0x5de8b7[_0xfbd881(0xca)][_0xfbd881(0xe79)](_0x5435b6=>_0x5435b6['id']===_0x190d78['id']);if(_0x468758)_0x468758[_0xfbd881(0x9ee)]=null;}await _0x36912b();}}async function _0x3b56c4(){const _0x4f55e9=_0x241b18;if(!_0x50fd7c)return;const _0x5bb68f=_0x50fd7c;_0x5652d7();const _0x51055f=_0x5de8b7[_0x4f55e9(0x737)][_0x5de8b7[_0x4f55e9(0x93d)]],_0x119ec0=_0x51055f[_0x4f55e9(0x49e)][_0x4f55e9(0xe79)](_0x1fa39d=>_0x1fa39d[_0x4f55e9(0x702)]===_0x5bb68f);if(!_0x119ec0)return;let _0x1eb189=String(_0x119ec0[_0x4f55e9(0x9a5)]||'')[_0x4f55e9(0x8d4)](0x0,0x32)+_0x4f55e9(0x6cb);if(_0x119ec0[_0x4f55e9(0xa20)]==='ai_image')_0x1eb189=_0x4f55e9(0x280)+_0x1eb189;const _0x7f6e40=await _0x58fd60(_0x4f55e9(0x11e4),'确定要将以下消息发布到公告板吗？\x0a\x0a“'+_0x1eb189+'”',{'confirmText':_0x4f55e9(0x17a)});if(_0x7f6e40){const _0x244471=_0x51055f[_0x4f55e9(0x761)]['myNickname']||'我';!Array[_0x4f55e9(0xb7b)](_0x51055f[_0x4f55e9(0x286)])&&(_0x51055f[_0x4f55e9(0x286)]=[]);const _0x4a1fa8={'id':_0x4f55e9(0xe77)+Date[_0x4f55e9(0x1182)](),'messageTimestamp':_0x5bb68f,'publisher':_0x244471,'publishedAt':Date[_0x4f55e9(0x1182)](),'isPinned':![]};_0x51055f['announcements'][_0x4f55e9(0xf5)](_0x4a1fa8);const _0x56fe60={'role':_0x4f55e9(0xf72),'type':_0x4f55e9(0x8ee),'content':_0x244471+_0x4f55e9(0x1134),'timestamp':Date['now']()};_0x51055f[_0x4f55e9(0x49e)][_0x4f55e9(0xf5)](_0x56fe60),await _0x2e83f8[_0x4f55e9(0x737)][_0x4f55e9(0xe3c)](_0x51055f),_0x3b5153(_0x56fe60,_0x51055f),_0x5ee219(),await _0x2fb06('成功','公告已发布！');}}async function _0x26553f(){const _0x5baea5=_0x241b18,_0x13a94e=_0x5de8b7['chats'][_0x5de8b7[_0x5baea5(0x93d)]],_0x4311d3=_0x13a94e[_0x5baea5(0x286)]||[];if(!_0x13a94e||_0x4311d3[_0x5baea5(0x594)]===0x0){_0x2fb06('提示','当前群聊还没有公告哦。');return;}const _0xf0c929=document[_0x5baea5(0x11e3)](_0x5baea5(0xe63));_0xf0c929[_0x5baea5(0x595)]='',_0x4311d3['sort']((_0x3d0689,_0x5c2ea5)=>(_0x5c2ea5[_0x5baea5(0x8ac)]?0x1:0x0)-(_0x3d0689[_0x5baea5(0x8ac)]?0x1:0x0));for(const _0x236ecb of _0x4311d3){const _0x2b66a5=_0x13a94e['history'][_0x5baea5(0xe79)](_0x4574ee=>_0x4574ee['timestamp']===_0x236ecb['messageTimestamp']),_0xce38a6=document[_0x5baea5(0x383)](_0x5baea5(0x1285));_0xce38a6[_0x5baea5(0x3db)]=_0x5baea5(0x12dd);if(_0x2b66a5){const _0x16fafe=await _0xe99b75(_0x2b66a5,_0x13a94e);_0x16fafe&&_0xce38a6[_0x5baea5(0x120c)](_0x16fafe);}else _0xce38a6[_0x5baea5(0x595)]=_0x5baea5(0xbd);_0x236ecb[_0x5baea5(0x8ac)]&&(_0xce38a6[_0x5baea5(0x595)]+=_0x5baea5(0x74f)),_0xce38a6[_0x5baea5(0x595)]+=_0x5baea5(0x109d)+_0x236ecb['id']+_0x5baea5(0xb19),_0xf0c929[_0x5baea5(0x120c)](_0xce38a6);}document[_0x5baea5(0x11e3)](_0x5baea5(0xa6a))[_0x5baea5(0x505)]['add'](_0x5baea5(0x250));}let _0x1ce87f=null;function _0x1e2ecd(_0x1f2246){const _0x4ab421=_0x241b18;_0x1ce87f=_0x1f2246;const _0x1944a9=_0x5de8b7[_0x4ab421(0x737)][_0x5de8b7['activeChatId']],_0x5c5993=_0x1944a9[_0x4ab421(0x286)][_0x4ab421(0xe79)](_0x521874=>_0x521874['id']===_0x1f2246);if(!_0x5c5993)return;const _0x5ea4e3=document[_0x4ab421(0x11e3)]('announcement-action-pin');_0x5ea4e3['textContent']=_0x5c5993[_0x4ab421(0x8ac)]?_0x4ab421(0x439):'置顶公告',document[_0x4ab421(0x11e3)](_0x4ab421(0x8f4))[_0x4ab421(0x505)][_0x4ab421(0x252)](_0x4ab421(0x250));}async function _0x1dcee4(){const _0x567304=_0x241b18;if(!_0x1ce87f)return;const _0x315d6b=_0x5de8b7['chats'][_0x5de8b7[_0x567304(0x93d)]],_0x221535=_0x315d6b[_0x567304(0x286)][_0x567304(0xe79)](_0x35bc0f=>_0x35bc0f['id']===_0x1ce87f);_0x221535&&(_0x221535['isPinned']=!_0x221535[_0x567304(0x8ac)],await _0x2e83f8[_0x567304(0x737)][_0x567304(0xe3c)](_0x315d6b),_0x26553f()),document[_0x567304(0x11e3)](_0x567304(0x8f4))[_0x567304(0x505)][_0x567304(0x957)]('visible');}async function _0x4973c0(){const _0x26489c=_0x241b18;if(!_0x1ce87f)return;const _0x81508f=await _0x58fd60(_0x26489c(0x1166),'确定要删除这条公告吗？此操作不可恢复。',{'confirmButtonClass':_0x26489c(0x8a6)});if(_0x81508f){const _0x49e5a7=_0x5de8b7[_0x26489c(0x737)][_0x5de8b7[_0x26489c(0x93d)]];_0x49e5a7[_0x26489c(0x286)]=_0x49e5a7[_0x26489c(0x286)][_0x26489c(0x138)](_0xd06538=>_0xd06538['id']!==_0x1ce87f),await _0x2e83f8[_0x26489c(0x737)][_0x26489c(0xe3c)](_0x49e5a7),_0x26553f();}document[_0x26489c(0x11e3)](_0x26489c(0x8f4))['classList'][_0x26489c(0x957)](_0x26489c(0x250));}let _0x22f8f5=![],_0x21b784={'ai':null,'my':null};function _0x2f6f4d(_0x5f1cb4=_0x241b18(0x847)){const _0x1194ac=_0x241b18,_0x226dea=document[_0x1194ac(0x11e3)](_0x1194ac(0x9ad));if(!_0x5de8b7[_0x1194ac(0x93d)])return;const _0x4d6407=_0x5de8b7[_0x1194ac(0x737)][_0x5de8b7['activeChatId']];_0x22f8f5=_0x5f1cb4===_0x1194ac(0x512);if(_0x22f8f5){const _0x3e5fc0=_0x4d6407['members'][_0x1194ac(0xe79)](_0x2a4c99=>_0x2a4c99['id']===_0x168ef5);if(!_0x3e5fc0)return;_0x21b784['my']=_0x3e5fc0[_0x1194ac(0x306)]||'',_0x67aea3(!![],_0x3e5fc0[_0x1194ac(0x525)],_0x3e5fc0[_0x1194ac(0x306)]);}else _0x21b784['ai']=_0x4d6407[_0x1194ac(0x761)][_0x1194ac(0x1268)]||'',_0x21b784['my']=_0x4d6407['settings'][_0x1194ac(0x11ed)]||'',_0x67aea3(![]);_0x226dea[_0x1194ac(0x505)][_0x1194ac(0x252)](_0x1194ac(0x250));}function _0x67aea3(_0x43b0b1=![],_0x676656=null,_0x37922e=null){const _0x41bc9a=_0x241b18,_0x2798ba=document[_0x41bc9a(0x11e3)]('ai-frame-grid'),_0x371b88=document[_0x41bc9a(0x11e3)](_0x41bc9a(0xa0a)),_0x4155fe=_0x5de8b7[_0x41bc9a(0x737)][_0x5de8b7[_0x41bc9a(0x93d)]];_0x2798ba[_0x41bc9a(0x595)]='',_0x371b88[_0x41bc9a(0x595)]='',document[_0x41bc9a(0x5ac)](_0x41bc9a(0x124c))[_0x41bc9a(0x794)]['display']=_0x43b0b1?_0x41bc9a(0x379):'flex',document[_0x41bc9a(0x11e3)](_0x41bc9a(0xb42))[_0x41bc9a(0x794)][_0x41bc9a(0x33d)]=_0x41bc9a(0x11ac),document[_0x41bc9a(0x11e3)](_0x41bc9a(0x1ea))[_0x41bc9a(0x794)][_0x41bc9a(0x33d)]='none',document[_0x41bc9a(0x11e3)]('ai-frame-tab')[_0x41bc9a(0x505)][_0x41bc9a(0x252)](_0x41bc9a(0x1fc)),document['getElementById'](_0x41bc9a(0x241))[_0x41bc9a(0x505)][_0x41bc9a(0x957)](_0x41bc9a(0x1fc));if(_0x43b0b1)_0x504159[_0x41bc9a(0x494)](_0xe52389=>{const _0x29bd98=_0x41bc9a,_0x2216ca=_0x4106b6(_0xe52389,'my',_0x676656);_0xe52389[_0x29bd98(0x10ac)]===_0x37922e&&_0x2216ca[_0x29bd98(0x505)][_0x29bd98(0x252)](_0x29bd98(0xbbc)),_0x2798ba[_0x29bd98(0x120c)](_0x2216ca);});else{const _0x99e2f2=_0x4155fe[_0x41bc9a(0x761)][_0x41bc9a(0x5e0)]||_0x3d2e44,_0x341fc8=_0x4155fe[_0x41bc9a(0x761)][_0x41bc9a(0xc43)]||(_0x4155fe[_0x41bc9a(0x1244)]?_0x30449f:_0x3d2e44);_0x504159['forEach'](_0x4eb385=>{const _0x166de3=_0x41bc9a,_0x15fdfb=_0x4106b6(_0x4eb385,'ai',_0x99e2f2);if(_0x4eb385['url']===_0x21b784['ai'])_0x15fdfb['classList'][_0x166de3(0x252)](_0x166de3(0xbbc));_0x2798ba[_0x166de3(0x120c)](_0x15fdfb);const _0x2c8b00=_0x4106b6(_0x4eb385,'my',_0x341fc8);if(_0x4eb385[_0x166de3(0x10ac)]===_0x21b784['my'])_0x2c8b00[_0x166de3(0x505)][_0x166de3(0x252)](_0x166de3(0xbbc));_0x371b88[_0x166de3(0x120c)](_0x2c8b00);});}}function _0x4106b6(_0xe25704,_0x1f4274,_0x20a729){const _0x3ceba4=_0x241b18,_0x53a50b=document['createElement'](_0x3ceba4(0x1285));return _0x53a50b[_0x3ceba4(0x3db)]=_0x3ceba4(0xd58),_0x53a50b[_0x3ceba4(0xaca)][_0x3ceba4(0x7a4)]=_0xe25704[_0x3ceba4(0x10ac)],_0x53a50b[_0x3ceba4(0x740)]=_0xe25704[_0x3ceba4(0x278)],_0x53a50b['innerHTML']=_0x3ceba4(0xdcc)+_0x20a729+_0x3ceba4(0xddb)+(_0xe25704[_0x3ceba4(0x10ac)]?_0x3ceba4(0x13b)+_0xe25704[_0x3ceba4(0x10ac)]+'\x22\x20class=\x22preview-frame\x22>':'')+_0x3ceba4(0x8a5),_0x53a50b[_0x3ceba4(0x4b8)](_0x3ceba4(0x1041),()=>{const _0x58c120=_0x3ceba4;_0x21b784[_0x1f4274]=_0xe25704['url'];const _0x511403=_0x1f4274==='ai'?document[_0x58c120(0x11e3)](_0x58c120(0xd7e)):document[_0x58c120(0x11e3)](_0x58c120(0xa0a));_0x511403[_0x58c120(0x10d6)](_0x58c120(0x6ef))[_0x58c120(0x494)](_0x29476f=>_0x29476f[_0x58c120(0x505)][_0x58c120(0x957)](_0x58c120(0xbbc))),_0x53a50b['classList'][_0x58c120(0x252)]('selected');}),_0x53a50b;}async function _0x3eb370(){const _0x101ce3=_0x241b18;if(!_0x5de8b7[_0x101ce3(0x93d)])return;const _0x503dd5=_0x5de8b7[_0x101ce3(0x737)][_0x5de8b7[_0x101ce3(0x93d)]];if(_0x22f8f5){const _0x1d4b33=_0x503dd5[_0x101ce3(0x2b3)]['find'](_0x106186=>_0x106186['id']===_0x168ef5);_0x1d4b33&&(_0x1d4b33[_0x101ce3(0x306)]=_0x21b784['my']);}else _0x503dd5[_0x101ce3(0x761)][_0x101ce3(0x1268)]=_0x21b784['ai'],_0x503dd5[_0x101ce3(0x761)][_0x101ce3(0x11ed)]=_0x21b784['my'];await _0x2e83f8['chats'][_0x101ce3(0xe3c)](_0x503dd5);if(!_0x22f8f5&&!_0x503dd5[_0x101ce3(0x1244)]){const _0x17ab37=_0x503dd5['id'];for(const _0x2e36ec of Object[_0x101ce3(0x4ca)](_0x5de8b7[_0x101ce3(0x737)])){if(_0x2e36ec[_0x101ce3(0x1244)]&&_0x2e36ec['members']){const _0x3cbcfc=_0x2e36ec[_0x101ce3(0x2b3)][_0x101ce3(0xe79)](_0x27144c=>_0x27144c['id']===_0x17ab37);_0x3cbcfc&&(_0x3cbcfc['avatarFrame']=_0x503dd5[_0x101ce3(0x761)][_0x101ce3(0x1268)],await _0x2e83f8[_0x101ce3(0x737)][_0x101ce3(0xe3c)](_0x2e36ec),console[_0x101ce3(0x84b)](_0x101ce3(0x5b4)+_0x17ab37+_0x101ce3(0x392)+_0x2e36ec[_0x101ce3(0x278)]+'\x22'));}}}document[_0x101ce3(0x11e3)]('avatar-frame-modal')[_0x101ce3(0x505)]['remove'](_0x101ce3(0x250)),_0x544ab5(_0x5de8b7[_0x101ce3(0x93d)]),alert(_0x101ce3(0x1b8)),_0x22f8f5=![];}function _0x532876(){const _0x1efed7=_0x241b18;_0x1992a9=!_0x1992a9;const _0x157db8=document[_0x1efed7(0x11e3)](_0x1efed7(0x3e5)),_0x5b1739=document[_0x1efed7(0x11e3)](_0x1efed7(0xbe1)),_0x4314c5=document[_0x1efed7(0x11e3)](_0x1efed7(0x1d7));document['querySelectorAll']('.frame-grid')[_0x1efed7(0x494)](_0x268a91=>{const _0x1b7c2d=_0x1efed7;_0x268a91[_0x1b7c2d(0x505)][_0x1b7c2d(0xe7e)](_0x1b7c2d(0x811),_0x1992a9);}),_0x1992a9?(_0x157db8[_0x1efed7(0x300)]='完成',_0x5b1739['style'][_0x1efed7(0x33d)]=_0x1efed7(0x10f4),_0x2f472a[_0x1efed7(0x7ab)](),_0x4314c5[_0x1efed7(0x3e4)]=![],_0x275cfa()):(_0x157db8['textContent']='管理',_0x5b1739[_0x1efed7(0x794)][_0x1efed7(0x33d)]=_0x1efed7(0x379),document[_0x1efed7(0x10d6)]('.frame-item.selected')[_0x1efed7(0x494)](_0x1c357f=>{const _0x518edc=_0x1efed7;_0x1c357f['classList'][_0x518edc(0x957)](_0x518edc(0xbbc));}));}function _0x275cfa(){const _0x2d0dab=_0x241b18,_0x409220=document['getElementById'](_0x2d0dab(0x3fa));_0x409220['textContent']=_0x2d0dab(0x662)+_0x2f472a[_0x2d0dab(0x1159)]+')';}function _0x7f74ea(){const _0x518343=_0x241b18,_0x361fec=document[_0x518343(0x11e3)](_0x518343(0x1d7))['checked'],_0x1deb55=document[_0x518343(0x5ac)](_0x518343(0x3ae));if(!_0x1deb55)return;_0x1deb55['querySelectorAll'](_0x518343(0x9b6))['forEach'](_0x46257a=>{const _0x6486=_0x518343,_0x158bbb=parseInt(_0x46257a[_0x6486(0x5ac)](_0x6486(0x329))['dataset']['id']);if(isNaN(_0x158bbb))return;_0x46257a[_0x6486(0x505)][_0x6486(0xe7e)](_0x6486(0xbbc),_0x361fec),_0x361fec?_0x2f472a['add'](_0x158bbb):_0x2f472a[_0x6486(0xc0c)](_0x158bbb);}),_0x275cfa();}async function _0x43469c(){const _0x4a9ee9=_0x241b18;if(_0x2f472a[_0x4a9ee9(0x1159)]===0x0)return;const _0x213999=await _0x58fd60(_0x4a9ee9(0x1166),'确定要永久删除选中的\x20'+_0x2f472a[_0x4a9ee9(0x1159)]+_0x4a9ee9(0x698),{'confirmButtonClass':_0x4a9ee9(0x8a6)});if(_0x213999){const _0x296ee1=[..._0x2f472a];await _0x2e83f8[_0x4a9ee9(0x675)]['bulkDelete'](_0x296ee1),_0x532876(),_0x67aea3(_0x22f8f5),await _0x2fb06(_0x4a9ee9(0x699),_0x4a9ee9(0x707));}}function _0x1a2892(_0x3e8149){const _0x240b8d=_0x241b18,_0x199591=document[_0x240b8d(0x11e3)](_0x240b8d(0x3d6));_0x199591&&(_0x199591[_0x240b8d(0x595)]=_0x3e8149||'');}async function _0x26a68c(_0x46c8d4){const _0x545e3b=_0x241b18;if(!_0xb57b5b[_0x545e3b(0x3d5)]||!_0xb57b5b[_0x545e3b(0x93d)])return;const _0x59acfc=_0x5de8b7[_0x545e3b(0x737)][_0xb57b5b[_0x545e3b(0x93d)]];if(!_0x59acfc)return;const _0x1f9a4e=_0x59acfc[_0x545e3b(0x1244)]?_0x59acfc['settings'][_0x545e3b(0xca7)]||'我':'我',_0x51b9d7='[系统提示：用户\x20('+_0x1f9a4e+')\x20'+_0x46c8d4+']',_0x29f52d={'role':_0x545e3b(0xf72),'content':_0x51b9d7,'timestamp':Date[_0x545e3b(0x1182)](),'isHidden':!![]};_0x59acfc[_0x545e3b(0x49e)][_0x545e3b(0xf5)](_0x29f52d),await _0x2e83f8['chats']['put'](_0x59acfc);}async function _0x32604c(){const _0x55c9c3=_0x241b18;if(_0x281a6a[_0x55c9c3(0x1159)]===0x0)return;const _0xc3111b=_0x5de8b7['chats'][_0x5de8b7[_0x55c9c3(0x93d)]];if(!_0xc3111b)return;const _0x32211c=document[_0x55c9c3(0x11e3)](_0x55c9c3(0x12a5)),_0x5bed1e=_0x32211c[_0x55c9c3(0x300)];_0x32211c['textContent']=_0x55c9c3(0x114f),_0x32211c['disabled']=!![];const _0x48f9dd=document[_0x55c9c3(0x383)](_0x55c9c3(0x1285)),_0x214df2=document[_0x55c9c3(0x11e3)](_0x55c9c3(0x1e6));_0x48f9dd[_0x55c9c3(0x794)][_0x55c9c3(0x1057)]=_0x214df2['offsetWidth']+'px',_0x48f9dd[_0x55c9c3(0x794)]['position']=_0x55c9c3(0x7ff),_0x48f9dd['style'][_0x55c9c3(0x10e2)]=_0x55c9c3(0x2dc),_0x48f9dd[_0x55c9c3(0x794)]['left']=_0x55c9c3(0x2dc),_0x48f9dd[_0x55c9c3(0x794)][_0x55c9c3(0x33d)]=_0x55c9c3(0x10f4),_0x48f9dd[_0x55c9c3(0x794)][_0x55c9c3(0x1290)]=_0x55c9c3(0x12c7),_0x48f9dd[_0x55c9c3(0x794)][_0x55c9c3(0x10f2)]=_0x55c9c3(0x11f7);const _0x463e6e=document[_0x55c9c3(0x11e3)]('chat-interface-screen');_0x48f9dd[_0x55c9c3(0x794)][_0x55c9c3(0x123e)]=_0x463e6e[_0x55c9c3(0x794)]['backgroundImage'],_0x48f9dd[_0x55c9c3(0x794)][_0x55c9c3(0x556)]=_0x463e6e[_0x55c9c3(0x794)][_0x55c9c3(0x556)]||(document['getElementById'](_0x55c9c3(0x1e6))['classList']['contains'](_0x55c9c3(0x251))?_0x55c9c3(0x495):_0x55c9c3(0x4fa));const _0x45d782=document[_0x55c9c3(0x383)](_0x55c9c3(0x794));_0x45d782['innerHTML']=_0x55c9c3(0xb6e),document[_0x55c9c3(0x10ad)]['appendChild'](_0x45d782);try{const _0x510bdd=_0x463e6e[_0x55c9c3(0x5ac)](_0x55c9c3(0x1093))[_0x55c9c3(0x4b4)](!![]);_0x510bdd[_0x55c9c3(0x505)][_0x55c9c3(0x252)]('cloned-header');const _0x241dce=document[_0x55c9c3(0x383)](_0x55c9c3(0x1285)),_0x50c720=document[_0x55c9c3(0x11e3)](_0x55c9c3(0xc9d));_0x241dce[_0x55c9c3(0x794)][_0x55c9c3(0x33d)]=_0x55c9c3(0x10f4),_0x241dce[_0x55c9c3(0x794)]['flexDirection']=_0x55c9c3(0x12c7),_0x241dce['style'][_0x55c9c3(0x5ba)]=_0x55c9c3(0x12d1),_0x241dce[_0x55c9c3(0x794)][_0x55c9c3(0x1107)]=_0x55c9c3(0x529),_0x241dce[_0x55c9c3(0x794)][_0x55c9c3(0x1057)]='100%',_0x241dce[_0x55c9c3(0x794)]['boxSizing']=_0x55c9c3(0xae9),_0x241dce[_0x55c9c3(0xaca)][_0x55c9c3(0xad7)]=_0x50c720[_0x55c9c3(0xaca)][_0x55c9c3(0xad7)],_0x241dce[_0x55c9c3(0x794)][_0x55c9c3(0xd8c)](_0x55c9c3(0xb0a),_0x50c720[_0x55c9c3(0x794)][_0x55c9c3(0x9e6)](_0x55c9c3(0xb0a)));const _0x4ffc2f=_0x463e6e[_0x55c9c3(0x5ac)](_0x55c9c3(0xa65))[_0x55c9c3(0x4b4)](!![]),_0x5c5c14=[..._0x281a6a]['sort']((_0x29586c,_0x230d98)=>_0x29586c-_0x230d98);_0x5c5c14['forEach'](_0x1d02fa=>{const _0x338a81=_0x55c9c3,_0xa242d0=document[_0x338a81(0x5ac)](_0x338a81(0x955)+_0x1d02fa+'\x22]');if(_0xa242d0){const _0x449a75=_0xa242d0['closest'](_0x338a81(0xce));_0x449a75&&_0x241dce[_0x338a81(0x120c)](_0x449a75[_0x338a81(0x4b4)](!![]));}}),_0x48f9dd[_0x55c9c3(0x120c)](_0x510bdd),_0x48f9dd[_0x55c9c3(0x120c)](_0x241dce),_0x48f9dd[_0x55c9c3(0x120c)](_0x4ffc2f),document[_0x55c9c3(0xdf2)][_0x55c9c3(0x120c)](_0x48f9dd);const _0x187f0f=Array[_0x55c9c3(0xee2)](_0x48f9dd[_0x55c9c3(0x692)](_0x55c9c3(0x1232))),_0x3c8121=_0x187f0f[_0x55c9c3(0x796)](_0x1522c8=>new Promise((_0x3960b3,_0xb5d0e8)=>{const _0xb03d3a=_0x55c9c3;if(_0x1522c8[_0xb03d3a(0xf0a)][_0xb03d3a(0xb6c)](_0xb03d3a(0xf3b))){_0x3960b3();return;}const _0x2979eb=new Image();_0x2979eb['crossOrigin']=_0xb03d3a(0xf5a),_0x2979eb[_0xb03d3a(0x1e5)]=_0x3960b3,_0x2979eb[_0xb03d3a(0x741)]=_0x3960b3,_0x2979eb[_0xb03d3a(0xf0a)]=_0x1522c8[_0xb03d3a(0xf0a)];}));await Promise[_0x55c9c3(0xd4a)](_0x3c8121);const _0xa1296e=await html2canvas(_0x48f9dd,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window[_0x55c9c3(0x242)]||0x2});_0xa1296e[_0x55c9c3(0xec8)](function(_0x543835){const _0x4b1a5e=_0x55c9c3,_0x6fefa9=URL[_0x4b1a5e(0x12fd)](_0x543835),_0x4e40bd=document[_0x4b1a5e(0x383)]('a');_0x4e40bd[_0x4b1a5e(0x8bd)]='EPhone-长截图-'+_0xc3111b[_0x4b1a5e(0x278)]+'-'+Date['now']()+_0x4b1a5e(0x1226),_0x4e40bd[_0x4b1a5e(0x125b)]=_0x6fefa9,document[_0x4b1a5e(0xdf2)][_0x4b1a5e(0x120c)](_0x4e40bd),_0x4e40bd[_0x4b1a5e(0x1041)](),document[_0x4b1a5e(0xdf2)]['removeChild'](_0x4e40bd),URL[_0x4b1a5e(0xa02)](_0x6fefa9);},_0x55c9c3(0x12f6));}catch(_0x5abdbb){console['error'](_0x55c9c3(0xe13),_0x5abdbb),await _0x2fb06(_0x55c9c3(0x334),_0x55c9c3(0x1173));}finally{document[_0x55c9c3(0xdf2)][_0x55c9c3(0xbb)](_0x48f9dd),document['head'][_0x55c9c3(0xbb)](_0x45d782),_0x32211c[_0x55c9c3(0x300)]=_0x5bed1e,_0x32211c[_0x55c9c3(0xe5c)]=![],_0x2192b8();}}function _0x5a9a9e(_0x4584dd){const _0x4ab329=_0x241b18;if(!_0x4584dd||typeof _0x4584dd!==_0x4ab329(0x10d7))return'';return _0x4584dd=_0x4584dd[_0x4ab329(0x1018)](/!h\{(.*?)\}/g,_0x4ab329(0xfde)),_0x4584dd=_0x4584dd['replace'](/!u\{(.*?)\}/g,_0x4ab329(0x275)),_0x4584dd=_0x4584dd[_0x4ab329(0x1018)](/!e\{(.*?)\}/g,_0x4ab329(0xf77)),_0x4584dd=_0x4584dd[_0x4ab329(0x1018)](/!w\{(.*?)\}/g,_0x4ab329(0x5a5)),_0x4584dd=_0x4584dd[_0x4ab329(0x1018)](/!m\{(.*?)\}/g,_0x4ab329(0x28e)),_0x4584dd=_0x4584dd[_0x4ab329(0x1018)](/\|\|(.*?)\|\|/g,_0x4ab329(0xc99)),_0x4584dd=_0x4584dd['replace'](/\*\*(.*?)\*\*/g,_0x4ab329(0x12c8)),_0x4584dd=_0x4584dd[_0x4ab329(0x1018)](/\~\~(.*?)\~\~/g,_0x4ab329(0x1165)),_0x4584dd=_0x4584dd[_0x4ab329(0x1018)](/\*(.*?)\*/g,_0x4ab329(0x156)),_0x4584dd;}async function _0x2c57e4(){const _0x2c106e=_0x241b18;console[_0x2c106e(0x84b)](_0x2c106e(0xce2));let _0x2d9aad=0x0;const _0x3c0a49=Object[_0x2c106e(0x4ca)](_0x5de8b7[_0x2c106e(0x737)]);for(const _0x3ef8ab of _0x3c0a49){let _0x347bc0=![];for(const _0x7319dd of _0x3ef8ab[_0x2c106e(0x49e)]){_0x7319dd[_0x2c106e(0xa20)]===_0x2c106e(0x305)&&_0x7319dd[_0x2c106e(0xc3d)]===_0x2c106e(0x978)&&_0x7319dd['role']===_0x2c106e(0x1119)&&_0x7319dd[_0x2c106e(0x2d4)](_0x2c106e(0xf13))&&!_0x7319dd[_0x2c106e(0x2d4)](_0x2c106e(0x1045))&&(_0x7319dd[_0x2c106e(0x1045)]=_0x7319dd[_0x2c106e(0xf13)],delete _0x7319dd[_0x2c106e(0xf13)],_0x347bc0=!![],_0x2d9aad++);}_0x347bc0&&(console[_0x2c106e(0x84b)](_0x2c106e(0xf8a)+_0x3ef8ab[_0x2c106e(0x278)]+_0x2c106e(0x1144)),await _0x2e83f8[_0x2c106e(0x737)][_0x2c106e(0xe3c)](_0x3ef8ab));}_0x2d9aad>0x0?(console[_0x2c106e(0x84b)]('数据迁移完成！总共修复了\x20'+_0x2d9aad+'\x20条红包记录。'),alert(_0x2c106e(0x976)+_0x2d9aad+_0x2c106e(0xe3a)),location[_0x2c106e(0x64b)]()):console[_0x2c106e(0x84b)]('未发现需要迁移的旧红包数据。');}function _0x3cc2f9(_0x567c73){const _0x468920=_0x241b18,_0x2afa7e=_0x5de8b7[_0x468920(0x737)][_0x567c73];if(!_0x2afa7e||_0x2afa7e[_0x468920(0x1244)])return;document[_0x468920(0x11e3)]('profile-heartfelt-voice')[_0x468920(0x300)]=_0x2afa7e['heartfeltVoice']||_0x468920(0x6cb),document['getElementById']('profile-random-jottings')[_0x468920(0x300)]=_0x2afa7e[_0x468920(0x267)]||'...';const _0x51d228=document['getElementById'](_0x468920(0x352));_0x51d228[_0x468920(0x505)][_0x468920(0x252)]('visible');}function _0x287280(){const _0x5160c9=_0x241b18;document['getElementById'](_0x5160c9(0x5a7))[_0x5160c9(0x794)][_0x5160c9(0x33d)]=_0x5160c9(0x379),document['getElementById'](_0x5160c9(0x269))[_0x5160c9(0x794)][_0x5160c9(0x33d)]=_0x5160c9(0x10f4),_0x808c9e();}function _0x379ff4(){const _0x13ad2e=_0x241b18;document[_0x13ad2e(0x11e3)]('profile-thoughts-history-view')['style'][_0x13ad2e(0x33d)]=_0x13ad2e(0x379),document[_0x13ad2e(0x11e3)](_0x13ad2e(0x5a7))[_0x13ad2e(0x794)][_0x13ad2e(0x33d)]=_0x13ad2e(0x10f4);}function _0x808c9e(){const _0x2a19df=_0x241b18,_0x33b23d=document[_0x2a19df(0x11e3)]('thoughts-history-list'),_0x338481=_0x5de8b7['chats'][_0x5de8b7[_0x2a19df(0x93d)]];_0x33b23d[_0x2a19df(0x595)]='';if(!_0x338481||!_0x338481[_0x2a19df(0x6d3)]||_0x338481[_0x2a19df(0x6d3)][_0x2a19df(0x594)]===0x0){_0x33b23d['innerHTML']=_0x2a19df(0x2d7);return;}const _0x5ea042=[..._0x338481[_0x2a19df(0x6d3)]]['reverse'](),_0x37b664=_0x5ea042[_0x2a19df(0xa6c)](0x0,_0x48c602);_0x37b664[_0x2a19df(0x494)](_0x5ac369=>{const _0xeda2c2=_0x2a19df,_0x54d39e=_0x275aad(_0x5ac369);_0x33b23d[_0xeda2c2(0x120c)](_0x54d39e);}),_0x441c78=_0x37b664[_0x2a19df(0x594)],_0x5ea042[_0x2a19df(0x594)]>_0x441c78&&appendLoadMoreThoughtsButton(_0x33b23d);}async function _0x24c4e4(){const _0x53d019=_0x241b18;if(_0x320eb9)return;_0x320eb9=!![];const _0x47314f=document[_0x53d019(0x11e3)]('thoughts-history-list'),_0x2226c3=_0x5de8b7[_0x53d019(0x737)][_0x5de8b7[_0x53d019(0x93d)]];if(!_0x2226c3){_0x320eb9=![];return;}_0x28c761(_0x47314f,'bottom'),await new Promise(_0x3487c1=>setTimeout(_0x3487c1,0x1f4));const _0x3c3643=[..._0x2226c3['thoughtsHistory']][_0x53d019(0x107)](),_0x206563=_0x3c3643['length'],_0x553020=_0x441c78,_0x291819=_0x441c78+_0x48c602,_0x51700f=_0x3c3643[_0x53d019(0xa6c)](_0x553020,_0x291819);_0x313362(_0x47314f),_0x51700f[_0x53d019(0x494)](_0x3767fd=>{const _0x3e3c87=_0x275aad(_0x3767fd);_0x47314f['appendChild'](_0x3e3c87);}),_0x441c78+=_0x51700f[_0x53d019(0x594)],_0x320eb9=![];}function _0x275aad(_0xef80f4){const _0x127390=_0x241b18,_0x591de5=document[_0x127390(0x383)](_0x127390(0x1285));_0x591de5[_0x127390(0x3db)]=_0x127390(0x23f);const _0x2f176f=new Date(_0xef80f4[_0x127390(0x702)]),_0x75fe91=_0x2f176f[_0x127390(0x177)]()+'-'+String(_0x2f176f[_0x127390(0x39d)]()+0x1)['padStart'](0x2,'0')+'-'+String(_0x2f176f[_0x127390(0x97d)]())[_0x127390(0xae4)](0x2,'0')+'\x20'+String(_0x2f176f[_0x127390(0x3de)]())[_0x127390(0xae4)](0x2,'0')+':'+String(_0x2f176f[_0x127390(0xf39)]())['padStart'](0x2,'0');return _0x591de5[_0x127390(0x595)]=_0x127390(0x72f)+_0xef80f4['timestamp']+_0x127390(0x53b)+_0x75fe91+_0x127390(0x1123)+_0xef80f4['heartfeltVoice']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>'+_0xef80f4['randomJottings']+_0x127390(0xca9),_0x591de5;}async function _0x35d99e(_0x77fa89){const _0x96d82c=_0x241b18,_0x1d6361=_0x77fa89['target']['files'][0x0];if(!_0x1d6361)return;try{let _0xbeb93a,_0x255e58=null;if(_0x1d6361[_0x96d82c(0x278)][_0x96d82c(0x771)]('.json')){const _0x197992=await _0x1d6361[_0x96d82c(0x1197)]();_0xbeb93a=JSON[_0x96d82c(0xb0c)](_0x197992);}else{if(_0x1d6361[_0x96d82c(0x278)]['endsWith'](_0x96d82c(0x1226))){const _0x4267cc=await _0x1d6361[_0x96d82c(0xd26)]();_0xbeb93a=await _0x2f6842(_0x4267cc),_0x255e58=await new Promise(_0x1f055d=>{const _0x57fe99=_0x96d82c,_0x52392b=new FileReader();_0x52392b['onload']=()=>_0x1f055d(_0x52392b[_0x57fe99(0x255)]),_0x52392b['readAsDataURL'](_0x1d6361);});}else throw new Error('不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。');}await _0xaa43fc(_0xbeb93a,_0x255e58);}catch(_0x1c854a){console[_0x96d82c(0x1c1)]('角色卡导入失败:',_0x1c854a),await _0x2fb06('导入失败',_0x96d82c(0x129a)+_0x1c854a[_0x96d82c(0x4bc)]);}finally{_0x77fa89[_0x96d82c(0xd7c)][_0x96d82c(0xf27)]=null;}}function _0x2f6842(_0x10189c){return new Promise((_0x5792dd,_0x2af16b)=>{const _0x5af87b=_0x10a9,_0x43d453=new DataView(_0x10189c);if(_0x43d453[_0x5af87b(0xc28)](0x0)!==0x89504e47||_0x43d453[_0x5af87b(0xc28)](0x4)!==0xd0a1a0a)return _0x2af16b(new Error('文件不是一个有效的PNG。'));let _0x53b448=0x8;const _0x131bda=new TextDecoder();while(_0x53b448<_0x43d453['byteLength']){const _0x170b11=_0x43d453['getUint32'](_0x53b448),_0x5acfe6=_0x131bda['decode'](_0x10189c['slice'](_0x53b448+0x4,_0x53b448+0x8));if(_0x5acfe6===_0x5af87b(0x155)){const _0x23c745=new Uint8Array(_0x10189c,_0x53b448+0x8,_0x170b11),_0x179351=_0x23c745[_0x5af87b(0xce1)](0x0);if(_0x179351!==-0x1){const _0x2bc407=_0x131bda[_0x5af87b(0x28a)](_0x23c745[_0x5af87b(0xa6c)](0x0,_0x179351));if(_0x2bc407==='chara'){const _0x142f2c=_0x131bda['decode'](_0x23c745[_0x5af87b(0xa6c)](_0x179351+0x1));try{const _0xa2b758=atob(_0x142f2c),_0x46597f=new Uint8Array(_0xa2b758[_0x5af87b(0x594)]);for(let _0x1f6996=0x0;_0x1f6996<_0xa2b758['length'];_0x1f6996++){_0x46597f[_0x1f6996]=_0xa2b758[_0x5af87b(0x5f0)](_0x1f6996);}const _0x13fe7a=new TextDecoder(_0x5af87b(0xae2))['decode'](_0x46597f);_0x5792dd(JSON[_0x5af87b(0xb0c)](_0x13fe7a));return;}catch(_0x982144){return _0x2af16b(new Error('在PNG中找到角色数据，但解码或解析失败。错误:\x20'+_0x982144[_0x5af87b(0x4bc)]));}}}}_0x53b448+=0x4+0x4+_0x170b11+0x4;}_0x2af16b(new Error('在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。'));});}function _0xfcc7ad(_0x43b92b){const _0x3d3172=_0x241b18;if(_0x43b92b[_0x3d3172(0x1cc)]?.[_0x3d3172(0x7c5)]?.['entries']?.[_0x3d3172(0x594)]>0x0)return console[_0x3d3172(0x84b)](_0x3d3172(0x12b1)),_0x43b92b[_0x3d3172(0x1cc)]['character_book'][_0x3d3172(0x560)];if(_0x43b92b['extensions']?.[_0x3d3172(0x7c5)]?.[_0x3d3172(0x560)]?.[_0x3d3172(0x594)]>0x0)return console[_0x3d3172(0x84b)](_0x3d3172(0xf6d)),_0x43b92b[_0x3d3172(0x9a1)][_0x3d3172(0x7c5)]['entries'];if(_0x43b92b[_0x3d3172(0x1cc)]?.['extensions']?.['character_book']?.['entries']?.['length']>0x0)return console[_0x3d3172(0x84b)](_0x3d3172(0x1274)),_0x43b92b[_0x3d3172(0x1cc)][_0x3d3172(0x9a1)][_0x3d3172(0x7c5)][_0x3d3172(0x560)];const _0x5d775f=[_0x3d3172(0x7c5),_0x3d3172(0x62e),_0x3d3172(0xf5e),_0x3d3172(0x380)];for(const _0x49d472 of _0x5d775f){if(_0x43b92b[_0x49d472]?.[_0x3d3172(0x560)]?.[_0x3d3172(0x594)]>0x0)return console['log']('诊断：在顶层\x20'+_0x49d472+_0x3d3172(0xd79)),_0x43b92b[_0x49d472]['entries'];}return console[_0x3d3172(0x84b)](_0x3d3172(0xe20)),null;}async function _0xaa43fc(_0x2ba7a0,_0x50807c=null){const _0x5b1adc=_0x241b18,_0x5a2162=_0x2ba7a0[_0x5b1adc(0x1cc)]||_0x2ba7a0;if(!_0x5a2162[_0x5b1adc(0x278)])throw new Error(_0x5b1adc(0x161));let _0x563368=null;const _0x2309d1=_0xfcc7ad(_0x2ba7a0);if(_0x2309d1){const _0x3405c1=_0x2309d1[_0x5b1adc(0x138)](_0xa944dc=>_0xa944dc[_0x5b1adc(0xc34)]&&_0xa944dc[_0x5b1adc(0x9a5)])[_0x5b1adc(0x796)](_0x2fa8e6=>({'keys':_0x2fa8e6[_0x5b1adc(0xb4a)]||[],'comment':_0x2fa8e6[_0x5b1adc(0xebd)]||'','content':_0x2fa8e6['content'][_0x5b1adc(0x1018)](/<memory>|<\/memory>/g,'')[_0x5b1adc(0xeb7)]()}));if(_0x3405c1['length']>0x0){const _0x298fa3={'id':_0x5b1adc(0x1105)+Date[_0x5b1adc(0x1182)](),'name':_0x5a2162[_0x5b1adc(0x278)]+_0x5b1adc(0x1a6),'content':_0x3405c1,'categoryId':null};await _0x2e83f8[_0x5b1adc(0xca)][_0x5b1adc(0x252)](_0x298fa3),_0x5de8b7[_0x5b1adc(0xca)][_0x5b1adc(0xf5)](_0x298fa3),_0x563368=_0x298fa3['id'];}}let _0x331632=_0x5a2162['description']||_0x2ba7a0[_0x5b1adc(0x1029)]||'无';_0x331632=_0x331632['replace'](/```yaml/g,'')['replace'](/```/g,'')[_0x5b1adc(0x1018)](/<\/?info>/g,'')[_0x5b1adc(0x1018)](/<\/?character>/g,'')['replace'](/<\/?writing_rule>/g,'')['replace'](/\[OOC：.*?\]/g,'')[_0x5b1adc(0xeb7)]();let _0x473cfa=_0x5b1adc(0x3f4)+_0x331632+'\x0a\x0a';if(_0x5a2162[_0x5b1adc(0x193)])_0x473cfa+=_0x5b1adc(0x369)+_0x5a2162[_0x5b1adc(0x193)]+'\x0a\x0a';if(_0x5a2162[_0x5b1adc(0x1042)])_0x473cfa+=_0x5b1adc(0xb24)+_0x5a2162[_0x5b1adc(0x1042)]+'\x0a\x0a';if(_0x5a2162[_0x5b1adc(0x1ad)])_0x473cfa+=_0x5b1adc(0x219)+_0x5a2162[_0x5b1adc(0x1ad)]+'\x0a\x0a';const _0x295bfc=_0x5a2162[_0x5b1adc(0x278)],_0xb10f9c=_0x5a2162[_0x5b1adc(0x278)],_0x388993=_0x5b1adc(0x1ae)+Date[_0x5b1adc(0x1182)](),_0x5c6f9c={'id':_0x388993,'name':_0x295bfc['trim'](),'originalName':_0xb10f9c['trim'](),'isGroup':![],'relationship':{'status':'friend'},'status':{'text':'在线','lastUpdate':Date[_0x5b1adc(0x1182)](),'isBusy':![]},'settings':{'aiPersona':_0x473cfa,'myPersona':_0x5b1adc(0x85e),'maxMemory':0xa,'aiAvatar':_0x3d2e44,'myAvatar':_0x3d2e44,'background':'','theme':_0x5b1adc(0xd3),'fontSize':0xd,'customCss':'','linkedWorldBookIds':_0x563368?[_0x563368]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0x50807c&&(_0x5c6f9c[_0x5b1adc(0x761)][_0x5b1adc(0x5e0)]=_0x50807c,_0x5c6f9c['settings'][_0x5b1adc(0xe6d)][_0x5b1adc(0xf5)]({'name':'默认头像','url':_0x50807c}));const _0x1d40b9=_0x5a2162[_0x5b1adc(0x11fe)]||_0x2ba7a0[_0x5b1adc(0x11fe)];if(_0x1d40b9&&typeof _0x1d40b9===_0x5b1adc(0x10d7)){const _0x230803=document[_0x5b1adc(0x383)](_0x5b1adc(0x1285));_0x230803[_0x5b1adc(0x595)]=_0x1d40b9;const _0x1e569a=(_0x230803[_0x5b1adc(0x300)]||_0x230803[_0x5b1adc(0x8f9)]||'')[_0x5b1adc(0x1018)](/原作者UR.*?开局/s,'')['trim']();_0x1e569a&&_0x5c6f9c[_0x5b1adc(0x49e)][_0x5b1adc(0xf5)]({'role':'assistant','senderName':_0x5c6f9c[_0x5b1adc(0x697)],'content':_0x1e569a,'timestamp':Date[_0x5b1adc(0x1182)]()});}_0x5de8b7['chats'][_0x388993]=_0x5c6f9c,await _0x2e83f8['chats']['put'](_0x5c6f9c),_0x5ee219();let _0x5028a1=_0x5b1adc(0x1250)+_0x5c6f9c['name']+_0x5b1adc(0xff2);_0x563368&&(_0x5028a1+=_0x5b1adc(0xd76)),await _0x2fb06(_0x5b1adc(0x9f8),_0x5028a1);}async function _0x917ffc(){const _0xc47869=_0x241b18;if(!_0x5de8b7['activeChatId'])return;const _0x4ed528=_0x5de8b7[_0xc47869(0x737)][_0x5de8b7[_0xc47869(0x93d)]],_0x3804be=_0x4ed528[_0xc47869(0x761)]['alternateGreetings'];if(!_0x3804be||_0x3804be[_0xc47869(0x594)]===0x0){alert('这个角色没有可用的备选开场白。');return;}const _0x2eb3e8=_0x3804be[_0xc47869(0x796)]((_0x33fac1,_0x2173cc)=>{const _0x2333ad=_0xc47869,_0x54dfde=_0x33fac1[_0x2333ad(0x1018)](/<[^>]*>/g,'')[_0x2333ad(0xeb7)]()[_0x2333ad(0x8d4)](0x0,0x14);return{'text':'开场\x20'+(_0x2173cc+0x1)+':\x20'+_0x54dfde+_0x2333ad(0x6cb),'value':_0x2173cc};}),_0x57e2c6=await _0x16a8e1(_0xc47869(0x98d),_0x2eb3e8);if(_0x57e2c6!==null){const _0x48a59f=await _0x58fd60('确认操作',_0xc47869(0x580),{'confirmButtonClass':_0xc47869(0x8a6),'confirmText':'确定切换'});if(_0x48a59f){const _0x548283=_0x3804be[_0x57e2c6],_0x4c042b={'role':_0xc47869(0x1119),'senderName':_0x4ed528[_0xc47869(0x697)],'content':_0x548283,'timestamp':Date['now']()};_0x4ed528['history']=[_0x4c042b],await _0x2e83f8[_0xc47869(0x737)][_0xc47869(0xe3c)](_0x4ed528),_0x544ab5(_0x4ed528['id']),document[_0xc47869(0x11e3)]('chat-settings-modal')[_0xc47869(0x505)][_0xc47869(0x957)](_0xc47869(0x250)),await _0x2fb06('成功',_0xc47869(0xd8e));}}}function _0x37e205(_0x296ac9={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x33435a=_0x241b18,_0x2775a7=document['createElement'](_0x33435a(0x1285));_0x2775a7['className']=_0x33435a(0x402);const _0x3015bf=_0x296ac9[_0x33435a(0xc34)]!==![]?_0x33435a(0x3e4):'';return _0x2775a7['innerHTML']=_0x33435a(0xf10)+_0x3015bf+_0x33435a(0xb40)+(_0x296ac9['comment']||'')+_0x33435a(0xeef)+(_0x296ac9[_0x33435a(0xb4a)]||[])['join'](',\x20')+_0x33435a(0x9d1)+(_0x296ac9[_0x33435a(0x9a5)]||'')+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2775a7['querySelector'](_0x33435a(0x48b))[_0x33435a(0x4b8)](_0x33435a(0x1041),()=>{const _0x134ce5=_0x33435a;_0x2775a7[_0x134ce5(0x957)]();}),_0x2775a7;}async function _0x3ea533(){const _0x1fc0dc=_0x241b18;if(!_0x5de8b7['activeChatId'])return;const _0x4d6474=_0x5de8b7[_0x1fc0dc(0x93d)],_0x18f453=document['getElementById'](_0x1fc0dc(0xb33));if(!_0x18f453[_0x1fc0dc(0x505)][_0x1fc0dc(0x1121)]('visible')){const _0x1bb42c=document[_0x1fc0dc(0x5ac)](_0x1fc0dc(0xf9c));_0x18f453['style']['top']=_0x1bb42c['offsetHeight']+'px',_0x18f453[_0x1fc0dc(0x794)][_0x1fc0dc(0x33d)]=_0x1fc0dc(0x11ac),(!_0x17be1a[_0x4d6474]||!_0x17be1a[_0x4d6474][_0x1fc0dc(0x3d5)])&&_0x10ba77(_0x4d6474),_0x4a6267(_0x4d6474),setTimeout(async()=>{const _0xe9a66e=_0x1fc0dc;_0x18f453['classList']['add'](_0xe9a66e(0x250));const _0x2f9664={'role':_0xe9a66e(0xf72),'content':'[系统提示：用户打开了五子棋棋盘，游戏开始了。]','timestamp':Date[_0xe9a66e(0x1182)](),'isHidden':!![]};_0x5de8b7[_0xe9a66e(0x737)][_0x4d6474][_0xe9a66e(0x49e)][_0xe9a66e(0xf5)](_0x2f9664),await _0x2e83f8['chats'][_0xe9a66e(0xe3c)](_0x5de8b7[_0xe9a66e(0x737)][_0x4d6474]);},0xa);}else await _0x612128();}async function _0x612128(){const _0x2c8f60=_0x241b18;if(!_0x5de8b7[_0x2c8f60(0x93d)])return;const _0x3c5d97=_0x5de8b7[_0x2c8f60(0x93d)],_0x38914e=document[_0x2c8f60(0x11e3)]('gomoku-overlay');_0x38914e[_0x2c8f60(0x505)][_0x2c8f60(0x957)]('visible'),setTimeout(()=>{const _0xb75a59=_0x2c8f60;_0x38914e[_0xb75a59(0x794)]['display']=_0xb75a59(0x379);},0x12c);if(_0x17be1a[_0x3c5d97]){_0x17be1a[_0x3c5d97][_0x2c8f60(0x3d5)]=![];const _0x5a1b7d={'role':'system','content':_0x2c8f60(0x466),'timestamp':Date['now'](),'isHidden':!![]};_0x5de8b7[_0x2c8f60(0x737)][_0x3c5d97]['history']['push'](_0x5a1b7d),await _0x2e83f8[_0x2c8f60(0x737)][_0x2c8f60(0xe3c)](_0x5de8b7[_0x2c8f60(0x737)][_0x3c5d97]);}}function _0x10ba77(_0x44ad68){const _0x177c66=_0x241b18,_0x306834=document[_0x177c66(0x11e3)](_0x177c66(0xe05)),_0x946ef4=document[_0x177c66(0x11e3)](_0x177c66(0xb33)),_0x1829ee=document[_0x177c66(0x11e3)]('gomoku-controls'),_0x428a93=_0x946ef4[_0x177c66(0x29f)]-0x28,_0x29e296=_0x946ef4[_0x177c66(0xea5)]-_0x1829ee[_0x177c66(0xea5)]-0x28,_0x361d4d=Math[_0x177c66(0xfb1)](Math['min'](_0x428a93,_0x29e296)),_0x5db83b=0xf,_0x38933d=Math[_0x177c66(0xfb1)](_0x361d4d/_0x5db83b),_0x4098f5=_0x38933d*_0x5db83b;_0x306834[_0x177c66(0x1057)]=_0x4098f5,_0x306834[_0x177c66(0x10f2)]=_0x4098f5,_0x17be1a[_0x44ad68]={'isActive':!![],'board':Array(_0x5db83b)['fill'](0x0)[_0x177c66(0x796)](()=>Array(_0x5db83b)['fill'](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0x5db83b,'CELL_SIZE':_0x38933d};}function _0x4a6267(_0x40e37a){const _0x47cfd5=_0x241b18,_0x27b4e0=_0x17be1a[_0x40e37a];if(!_0x27b4e0)return;const _0x23bbd3=document[_0x47cfd5(0x11e3)](_0x47cfd5(0xe05)),_0x271d4a=_0x23bbd3[_0x47cfd5(0x1c4)]('2d'),{GRID_SIZE:_0x5b8509,CELL_SIZE:_0x198df3}=_0x27b4e0,_0x21d5aa=_0x198df3/0x2;_0x271d4a[_0x47cfd5(0x1109)](0x0,0x0,_0x23bbd3['width'],_0x23bbd3[_0x47cfd5(0x10f2)]),_0x271d4a[_0x47cfd5(0x6d5)]=_0x47cfd5(0xd04),_0x271d4a[_0x47cfd5(0x1106)](0x0,0x0,_0x23bbd3[_0x47cfd5(0x1057)],_0x23bbd3[_0x47cfd5(0x10f2)]),_0x271d4a[_0x47cfd5(0x100c)]=_0x47cfd5(0x11fd),_0x271d4a[_0x47cfd5(0x521)]=0x1;for(let _0x301b05=0x0;_0x301b05<_0x5b8509;_0x301b05++){_0x271d4a[_0x47cfd5(0x1037)](),_0x271d4a[_0x47cfd5(0xf51)](_0x21d5aa,_0x21d5aa+_0x301b05*_0x198df3),_0x271d4a[_0x47cfd5(0x9fb)](_0x23bbd3[_0x47cfd5(0x1057)]-_0x21d5aa,_0x21d5aa+_0x301b05*_0x198df3),_0x271d4a[_0x47cfd5(0x2b0)](),_0x271d4a['beginPath'](),_0x271d4a[_0x47cfd5(0xf51)](_0x21d5aa+_0x301b05*_0x198df3,_0x21d5aa),_0x271d4a['lineTo'](_0x21d5aa+_0x301b05*_0x198df3,_0x23bbd3[_0x47cfd5(0x10f2)]-_0x21d5aa),_0x271d4a[_0x47cfd5(0x2b0)]();}for(let _0x1662af=0x0;_0x1662af<_0x5b8509;_0x1662af++){for(let _0x32c4e8=0x0;_0x32c4e8<_0x5b8509;_0x32c4e8++){_0x27b4e0[_0x47cfd5(0x8da)][_0x1662af][_0x32c4e8]!==0x0&&_0x2c623b(_0x271d4a,_0x32c4e8,_0x1662af,_0x27b4e0['board'][_0x1662af][_0x32c4e8],_0x27b4e0);}}}function _0x2c623b(_0xb8d436,_0x584d60,_0x348f55,_0x2dd130,_0x4d4bfe){const _0x3a8d13=_0x241b18,{CELL_SIZE:_0x59ca72}=_0x4d4bfe,_0x3fb4d6=_0x59ca72/0x2,_0x2c4ec5=_0x59ca72/0x2-0x2;_0xb8d436[_0x3a8d13(0x1037)](),_0xb8d436[_0x3a8d13(0x126b)](_0x3fb4d6+_0x584d60*_0x59ca72,_0x3fb4d6+_0x348f55*_0x59ca72,_0x2c4ec5,0x0,0x2*Math['PI']),_0x2dd130===0x1?_0xb8d436['fillStyle']=_0x3a8d13(0xa77):_0xb8d436[_0x3a8d13(0x6d5)]='white',_0xb8d436[_0x3a8d13(0x774)]();}function _0x31b145(_0x222d8b){const _0x462f2f=_0x241b18,_0x4a5718=_0x5de8b7[_0x462f2f(0x93d)],_0x2447f4=_0x17be1a[_0x4a5718];if(!_0x2447f4||_0x2447f4[_0x462f2f(0x20f)]||_0x2447f4[_0x462f2f(0xdd4)]!==0x1)return;const _0x342bd9=document[_0x462f2f(0x11e3)](_0x462f2f(0xe05)),_0x57ee93=_0x342bd9[_0x462f2f(0x1c4)]('2d'),_0x4205aa=_0x342bd9[_0x462f2f(0x106b)](),_0x45ff69=_0x222d8b[_0x462f2f(0x3e6)]-_0x4205aa[_0x462f2f(0x910)],_0x11acc0=_0x222d8b[_0x462f2f(0x92d)]-_0x4205aa[_0x462f2f(0x10e2)],_0x5f3ee8=Math[_0x462f2f(0xe0)]((_0x45ff69-_0x2447f4[_0x462f2f(0xe47)]/0x2)/_0x2447f4['CELL_SIZE']),_0x17a6c2=Math[_0x462f2f(0xe0)]((_0x11acc0-_0x2447f4[_0x462f2f(0xe47)]/0x2)/_0x2447f4['CELL_SIZE']);_0x4a6267(_0x4a5718);if(_0x5f3ee8>=0x0&&_0x5f3ee8<_0x2447f4[_0x462f2f(0x10f8)]&&_0x17a6c2>=0x0&&_0x17a6c2<_0x2447f4[_0x462f2f(0x10f8)]&&_0x2447f4['board'][_0x17a6c2][_0x5f3ee8]===0x0){const _0x2115ca=_0x2447f4[_0x462f2f(0xe47)]/0x2-0x2;_0x57ee93[_0x462f2f(0x1037)](),_0x57ee93[_0x462f2f(0x126b)](_0x2447f4[_0x462f2f(0xe47)]/0x2+_0x5f3ee8*_0x2447f4[_0x462f2f(0xe47)],_0x2447f4[_0x462f2f(0xe47)]/0x2+_0x17a6c2*_0x2447f4[_0x462f2f(0xe47)],_0x2115ca,0x0,0x2*Math['PI']),_0x57ee93[_0x462f2f(0x6d5)]=_0x462f2f(0xabb),_0x57ee93[_0x462f2f(0x774)]();}}function _0x1e5462(_0x39814d){const _0x431190=_0x241b18,_0x4ed82f=_0x5de8b7[_0x431190(0x93d)],_0x898b87=_0x17be1a[_0x4ed82f];if(!_0x898b87||_0x898b87['isGameOver']||_0x898b87[_0x431190(0xdd4)]!==0x1)return;const _0x5a6201=document[_0x431190(0x11e3)](_0x431190(0xe05)),_0x1b63aa=_0x5a6201[_0x431190(0x106b)](),_0xfe190d=_0x39814d[_0x431190(0x3e6)]-_0x1b63aa[_0x431190(0x910)],_0x20b65c=_0x39814d[_0x431190(0x92d)]-_0x1b63aa['top'],_0x2afb53=Math[_0x431190(0xe0)]((_0xfe190d-_0x898b87[_0x431190(0xe47)]/0x2)/_0x898b87['CELL_SIZE']),_0x5c1278=Math[_0x431190(0xe0)]((_0x20b65c-_0x898b87[_0x431190(0xe47)]/0x2)/_0x898b87['CELL_SIZE']);_0x2afb53>=0x0&&_0x2afb53<_0x898b87[_0x431190(0x10f8)]&&_0x5c1278>=0x0&&_0x5c1278<_0x898b87[_0x431190(0x10f8)]&&_0x898b87['board'][_0x5c1278][_0x2afb53]===0x0&&(_0x898b87[_0x431190(0x8da)][_0x5c1278][_0x2afb53]=0x1,_0x898b87['history'][_0x431190(0xf5)]({'x':_0x2afb53,'y':_0x5c1278,'player':0x1}),_0x4a6267(_0x4ed82f),_0x630ddc(_0x2afb53,_0x5c1278,0x1,_0x898b87)?(_0x898b87[_0x431190(0x20f)]=!![],setTimeout(()=>alert(_0x431190(0x8c1)),0x64),_0x4ce28a('user')):_0x898b87[_0x431190(0xdd4)]=0x2);}function _0x416bbd(_0x688a5a,_0x1affac=![]){const _0xf2e135=_0x241b18,_0x23fe82=_0x5de8b7[_0xf2e135(0x93d)],_0x1c401a=_0x17be1a[_0x23fe82];if(!_0x1c401a||_0x1c401a['isGameOver'])return;if(!_0x1affac&&_0x1c401a[_0xf2e135(0xdd4)]!==0x2)return;const {x:_0x214b49,y:_0xead71e}=_0x688a5a;_0x214b49>=0x0&&_0x214b49<_0x1c401a[_0xf2e135(0x10f8)]&&_0xead71e>=0x0&&_0xead71e<_0x1c401a[_0xf2e135(0x10f8)]&&_0x1c401a[_0xf2e135(0x8da)][_0xead71e][_0x214b49]===0x0?(_0x1c401a[_0xf2e135(0x8da)][_0xead71e][_0x214b49]=0x2,_0x1c401a[_0xf2e135(0x49e)]['push']({'x':_0x214b49,'y':_0xead71e,'player':0x2}),_0x4a6267(_0x23fe82),_0x630ddc(_0x214b49,_0xead71e,0x2,_0x1c401a)?(_0x1c401a[_0xf2e135(0x20f)]=!![],setTimeout(()=>alert(_0xf2e135(0x3e7)),0x64),_0x4ce28a('ai')):_0x1c401a[_0xf2e135(0xdd4)]=0x1):(console['warn']('AI\x20的下棋指令无效或位置已被占据:',_0x688a5a),_0x1c401a[_0xf2e135(0xdd4)]=0x1);}function _0x630ddc(_0x3cff32,_0x280cd1,_0x33acc3,_0x2123fd){const {board:_0x326f0f,GRID_SIZE:_0x3f7cfd}=_0x2123fd,_0x3cb247=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x563c4f,_0x11d9c8]of _0x3cb247){let _0x8c861a=0x1;for(let _0x372631=0x1;_0x372631<0x5;_0x372631++){const _0x46970f=_0x3cff32+_0x372631*_0x563c4f,_0x41322b=_0x280cd1+_0x372631*_0x11d9c8;if(_0x46970f>=0x0&&_0x46970f<_0x3f7cfd&&_0x41322b>=0x0&&_0x41322b<_0x3f7cfd&&_0x326f0f[_0x41322b][_0x46970f]===_0x33acc3)_0x8c861a++;else break;}for(let _0x2f31d2=0x1;_0x2f31d2<0x5;_0x2f31d2++){const _0x16ea09=_0x3cff32-_0x2f31d2*_0x563c4f,_0x40e414=_0x280cd1-_0x2f31d2*_0x11d9c8;if(_0x16ea09>=0x0&&_0x16ea09<_0x3f7cfd&&_0x40e414>=0x0&&_0x40e414<_0x3f7cfd&&_0x326f0f[_0x40e414][_0x16ea09]===_0x33acc3)_0x8c861a++;else break;}if(_0x8c861a>=0x5)return!![];}return![];}function _0x356017(_0x1951f3){const _0x41371c=_0x241b18;if(!_0x1951f3||!_0x1951f3[_0x41371c(0x3d5)])return'';let _0x3f3378=_0x41371c(0xf3a);_0x3f3378+=_0x1951f3['board'][_0x41371c(0x796)](_0x4eef36=>_0x4eef36[_0x41371c(0xa4b)]('\x20'))['join']('\x0a');let _0x489bd0=_0x41371c(0xccf);return _0x489bd0+=_0x1951f3[_0x41371c(0x49e)][_0x41371c(0x796)](_0x41bb47=>'玩家'+_0x41bb47['player']+_0x41371c(0x10e0)+_0x41bb47['x']+','+_0x41bb47['y']+')')['join'](_0x41371c(0x1004)),'\x0a#\x20当前五子棋局势\x0a'+_0x3f3378+'\x0a\x0a#\x20'+_0x489bd0+_0x41371c(0x23d);}async function _0x4ce28a(_0x4d6ec7){const _0x18a8d2=_0x241b18,_0x1a47dd=_0x5de8b7[_0x18a8d2(0x93d)],_0x4c6e4c=_0x5de8b7[_0x18a8d2(0x737)][_0x1a47dd];if(!_0x4c6e4c)return;const _0x5acf15=_0x4c6e4c[_0x18a8d2(0x1244)]?_0x4c6e4c[_0x18a8d2(0x761)][_0x18a8d2(0xca7)]||'我':'我',_0x296728=_0x4c6e4c[_0x18a8d2(0x1244)]?'AI方':_0x4c6e4c[_0x18a8d2(0x278)],_0x53d8df=_0x4d6ec7==='user'?_0x5acf15:_0x296728,_0x586dae=_0x4d6ec7==='user'?'你输了':_0x18a8d2(0xca3),_0x15d907=_0x18a8d2(0x164)+_0x53d8df+_0x18a8d2(0xb6d)+_0x586dae+'。]',_0x346225={'role':_0x18a8d2(0xf72),'content':_0x15d907,'timestamp':Date['now'](),'isHidden':!![]};_0x4c6e4c[_0x18a8d2(0x49e)][_0x18a8d2(0xf5)](_0x346225),await _0x2e83f8['chats'][_0x18a8d2(0xe3c)](_0x4c6e4c),console['log'](_0x18a8d2(0x285)+_0x4d6ec7);}let _0xe78be8=![];async function _0x1deb57(){const _0x2a5079=_0x241b18,_0x1666a7=document[_0x2a5079(0x11e3)](_0x2a5079(0xd37)),_0x543f37=document[_0x2a5079(0x11e3)](_0x2a5079(0x703)),_0x1f8c73=document[_0x2a5079(0x11e3)](_0x2a5079(0xbea));_0x1666a7[_0x2a5079(0x595)]='',_0x543f37[_0x2a5079(0x595)]='';const [_0x45428c,_0x38dbf2]=await Promise[_0x2a5079(0xd4a)]([_0x2e83f8['shoppingProducts'][_0x2a5079(0x508)](),_0x2e83f8[_0x2a5079(0xf85)]['orderBy'](_0x2a5079(0x278))[_0x2a5079(0x508)]()]);_0x1f8c73[_0x2a5079(0x505)][_0x2a5079(0xe7e)](_0x2a5079(0x811),_0xe78be8);const _0x246c1f=document['createElement'](_0x2a5079(0xbf2));_0x246c1f[_0x2a5079(0x3db)]=_0x2a5079(0x1008),_0x246c1f[_0x2a5079(0x300)]='全部',_0x246c1f['dataset'][_0x2a5079(0x9ee)]=_0x2a5079(0xd4a);if(activeShoppingCategoryId===_0x2a5079(0xd4a))_0x246c1f[_0x2a5079(0x505)][_0x2a5079(0x252)](_0x2a5079(0x1fc));_0x543f37[_0x2a5079(0x120c)](_0x246c1f),_0x38dbf2['forEach'](_0x557df4=>{const _0x9acf43=_0x2a5079,_0xdd338f=document['createElement'](_0x9acf43(0xbf2));_0xdd338f[_0x9acf43(0x3db)]=_0x9acf43(0x1008),_0xdd338f[_0x9acf43(0x300)]=_0x557df4[_0x9acf43(0x278)],_0xdd338f['dataset']['categoryId']=_0x557df4['id'];if(activeShoppingCategoryId===_0x557df4['id'])_0xdd338f['classList'][_0x9acf43(0x252)](_0x9acf43(0x1fc));_0x543f37[_0x9acf43(0x120c)](_0xdd338f);});let _0x46737f;activeShoppingCategoryId===_0x2a5079(0xd4a)?_0x46737f=_0x45428c:_0x46737f=_0x45428c[_0x2a5079(0x138)](_0x2521d1=>_0x2521d1[_0x2a5079(0x9ee)]===activeShoppingCategoryId);if(_0x46737f[_0x2a5079(0x594)]===0x0){const _0x2f44a8=activeShoppingCategoryId===_0x2a5079(0xd4a)?_0x2a5079(0x1284):_0x2a5079(0x178);_0x1666a7[_0x2a5079(0x595)]=_0x2a5079(0x6f3)+_0x2f44a8+'</p>';return;}_0x46737f[_0x2a5079(0x494)](_0x1df384=>{const _0x3ba466=_0x2a5079,_0x251c3c=document[_0x3ba466(0x383)](_0x3ba466(0x1285));_0x251c3c[_0x3ba466(0x3db)]=_0x3ba466(0x2ab),_0x251c3c[_0x3ba466(0xaca)]['id']=_0x1df384['id'];const _0x301ffb=_0x3ba466(0x672);_0x251c3c[_0x3ba466(0x595)]=_0x3ba466(0xfe0)+_0x301ffb+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x1df384[_0x3ba466(0xf44)]+'\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>'+_0x1df384[_0x3ba466(0x278)]+_0x3ba466(0x59f)+_0x1df384['price'][_0x3ba466(0x200)](0x2)+_0x3ba466(0xa58),_0x1666a7[_0x3ba466(0x120c)](_0x251c3c);});}function _0x58f720(_0x10f47f){activeShoppingCategoryId=_0x10f47f,_0x1deb57(),_0x250785();}function _0x250785(){const _0x5ae324=_0x241b18,_0xad3f55=document[_0x5ae324(0x11e3)](_0x5ae324(0xfe8));if(!_0xad3f55)return;const _0x47f9c9=_0xe78be8&&activeShoppingCategoryId!=='all';_0xad3f55[_0x5ae324(0x794)][_0x5ae324(0x33d)]=_0x47f9c9?_0x5ae324(0x10f4):_0x5ae324(0x379);}async function _0x1ccbd3(){const _0x14e00b=_0x241b18;if(activeShoppingCategoryId===_0x14e00b(0xd4a))return;const _0x3b031b=activeShoppingCategoryId,_0x229de7=await _0x2e83f8[_0x14e00b(0xf85)][_0x14e00b(0x1289)](_0x3b031b);if(!_0x229de7){alert(_0x14e00b(0x3ee));return;}const _0x5c9028=_0x14e00b(0xc4b)+_0x229de7[_0x14e00b(0x278)]+_0x14e00b(0x71a),_0x33ac7=await _0x58fd60(_0x14e00b(0xf1d),_0x5c9028,{'confirmButtonClass':'btn-danger','confirmText':_0x14e00b(0x1166)});_0x33ac7&&(await _0x49e49d(_0x3b031b),activeShoppingCategoryId=_0x14e00b(0xd4a),await _0x1deb57(),_0x250785(),await _0x2fb06('成功',_0x14e00b(0x597)+_0x229de7[_0x14e00b(0x278)]+'”\x20已被删除。'));}async function _0x25aa58(){const _0x46c24f=_0x241b18;activeShoppingCategoryId=_0x46c24f(0xd4a),await _0x1deb57(),_0x4e7698('shopping-screen'),_0x250785();}async function _0x1deb57(){const _0x4f80b5=_0x241b18,_0x60dcb3=document[_0x4f80b5(0x11e3)](_0x4f80b5(0xd37)),_0x3f23b8=document[_0x4f80b5(0x11e3)]('product-category-tabs'),_0x28a8fd=document[_0x4f80b5(0x11e3)](_0x4f80b5(0xbea));_0x60dcb3['innerHTML']='',_0x3f23b8[_0x4f80b5(0x595)]='';const [_0x4821cd,_0x285fcb]=await Promise[_0x4f80b5(0xd4a)]([_0x2e83f8[_0x4f80b5(0x120)][_0x4f80b5(0x508)](),_0x2e83f8[_0x4f80b5(0xf85)][_0x4f80b5(0x7c6)](_0x4f80b5(0x278))[_0x4f80b5(0x508)]()]);_0x28a8fd[_0x4f80b5(0x505)][_0x4f80b5(0xe7e)]('management-mode',_0xe78be8);const _0x2052ad=document['createElement'](_0x4f80b5(0xbf2));_0x2052ad[_0x4f80b5(0x3db)]='product-category-tab',_0x2052ad[_0x4f80b5(0x300)]='全部',_0x2052ad[_0x4f80b5(0xaca)][_0x4f80b5(0x9ee)]=_0x4f80b5(0xd4a);if(activeShoppingCategoryId===_0x4f80b5(0xd4a))_0x2052ad[_0x4f80b5(0x505)][_0x4f80b5(0x252)](_0x4f80b5(0x1fc));_0x3f23b8['appendChild'](_0x2052ad),_0x285fcb[_0x4f80b5(0x494)](_0x378c1c=>{const _0x445146=_0x4f80b5,_0x30e8d1=document[_0x445146(0x383)](_0x445146(0xbf2));_0x30e8d1['className']='product-category-tab',_0x30e8d1[_0x445146(0x300)]=_0x378c1c[_0x445146(0x278)],_0x30e8d1['dataset'][_0x445146(0x9ee)]=_0x378c1c['id'];if(activeShoppingCategoryId===_0x378c1c['id'])_0x30e8d1[_0x445146(0x505)][_0x445146(0x252)](_0x445146(0x1fc));_0x3f23b8[_0x445146(0x120c)](_0x30e8d1);});let _0xad2ae5;activeShoppingCategoryId===_0x4f80b5(0xd4a)?_0xad2ae5=_0x4821cd:_0xad2ae5=_0x4821cd[_0x4f80b5(0x138)](_0x8bd0b2=>_0x8bd0b2[_0x4f80b5(0x9ee)]===activeShoppingCategoryId);if(_0xad2ae5[_0x4f80b5(0x594)]===0x0){const _0xc81f47=activeShoppingCategoryId===_0x4f80b5(0xd4a)?_0x4f80b5(0x1284):'这个分类下还没有商品哦~';_0x60dcb3[_0x4f80b5(0x595)]=_0x4f80b5(0x6f3)+_0xc81f47+'</p>';return;}_0xad2ae5[_0x4f80b5(0x494)](_0x54b8bf=>{const _0x18a924=_0x4f80b5,_0x4beff0=document[_0x18a924(0x383)](_0x18a924(0x1285));_0x4beff0['className']=_0x18a924(0x2ab),_0x4beff0[_0x18a924(0xaca)]['id']=_0x54b8bf['id'];const _0x24cd89=_0xe78be8?_0x18a924(0x40c):'';_0x4beff0[_0x18a924(0x595)]=_0x18a924(0x8a5)+_0x24cd89+_0x18a924(0xd6d)+_0x54b8bf[_0x18a924(0xf44)]+_0x18a924(0xd0d)+_0x54b8bf['name']+_0x18a924(0xdef)+_0x54b8bf[_0x18a924(0xa6f)]['toFixed'](0x2)+_0x18a924(0x732),_0x60dcb3['appendChild'](_0x4beff0);});}async function _0x3cde4b(_0x52fc33,_0x15f69c=0x1,_0x2aa92c=null){const _0x370655=_0x241b18,_0x4f1594=_0x2aa92c?_0x103e33[_0x370655(0xe79)](_0x39e0d8=>_0x39e0d8['productId']===_0x52fc33&&_0x39e0d8[_0x370655(0x362)]?.[_0x370655(0x278)]===_0x2aa92c[_0x370655(0x278)]):_0x103e33[_0x370655(0xe79)](_0x1d93ef=>_0x1d93ef[_0x370655(0x8a2)]===_0x52fc33&&!_0x1d93ef['variation']);if(_0x4f1594)_0x4f1594[_0x370655(0x108a)]+=_0x15f69c;else{const _0x7d1861=await _0x2e83f8['shoppingProducts'][_0x370655(0x1289)](_0x52fc33);_0x7d1861&&_0x103e33[_0x370655(0xf5)]({'productId':_0x7d1861['id'],'quantity':_0x15f69c,'variation':_0x2aa92c});}_0x32aedc();}function _0x9a0716(_0x27cf31,_0x25c917){const _0x2432e8=_0x241b18,_0x54b26f=_0x103e33[_0x2432e8(0x901)](_0x26b210=>_0x26b210[_0x2432e8(0x8a2)]===_0x27cf31);_0x54b26f>-0x1&&(_0x103e33[_0x54b26f][_0x2432e8(0x108a)]+=_0x25c917,_0x103e33[_0x54b26f]['quantity']<=0x0&&_0x103e33['splice'](_0x54b26f,0x1),_0x32aedc(),_0x12cdec());}function _0x32aedc(){const _0x10c4b0=_0x241b18,_0x579505=_0x103e33[_0x10c4b0(0x870)]((_0x16a6a9,_0x4fe353)=>_0x16a6a9+_0x4fe353[_0x10c4b0(0x108a)],0x0);document[_0x10c4b0(0x11e3)](_0x10c4b0(0x414))['textContent']=_0x579505,document[_0x10c4b0(0x11e3)](_0x10c4b0(0x113e))[_0x10c4b0(0x300)]=_0x10c4b0(0x47b)+_0x579505+')',document[_0x10c4b0(0x11e3)](_0x10c4b0(0xb32))['textContent']='结算('+_0x579505+')';}function _0x28594e(){const _0xd80fc1=_0x241b18;_0x12cdec(),_0x4e7698(_0xd80fc1(0xf83));}async function _0x12cdec(){const _0x2f36ad=_0x241b18,_0x1e86da=document[_0x2f36ad(0x11e3)]('cart-items-list');_0x1e86da[_0x2f36ad(0x595)]='';let _0x2a8afc=0x0;if(_0x103e33['length']===0x0)_0x1e86da[_0x2f36ad(0x595)]=_0x2f36ad(0x256);else{const _0x33447c=_0x103e33[_0x2f36ad(0x796)](_0x1abbb3=>_0x1abbb3[_0x2f36ad(0x8a2)]),_0xbe0ba0=await _0x2e83f8[_0x2f36ad(0x120)][_0x2f36ad(0x129e)]('id')[_0x2f36ad(0x1209)](_0x33447c)[_0x2f36ad(0x508)](),_0x4cfb31=new Map(_0xbe0ba0[_0x2f36ad(0x796)](_0x4c986d=>[_0x4c986d['id'],_0x4c986d]));_0x103e33[_0x2f36ad(0x494)](_0x4fd326=>{const _0x2cda4f=_0x2f36ad,_0xb1ef98=_0x4cfb31[_0x2cda4f(0x1289)](_0x4fd326[_0x2cda4f(0x8a2)]);if(_0xb1ef98){const _0x536245=document[_0x2cda4f(0x383)](_0x2cda4f(0x1285));_0x536245[_0x2cda4f(0x3db)]=_0x2cda4f(0xebe);const _0x30d460=_0x4fd326[_0x2cda4f(0x362)]?_0x2cda4f(0xea7)+_0x4fd326[_0x2cda4f(0x362)][_0x2cda4f(0x278)]+_0x2cda4f(0xc5c):'';_0x536245[_0x2cda4f(0x595)]=_0x2cda4f(0x1db)+_0xb1ef98['id']+'\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x4fd326['variation']?.[_0x2cda4f(0xf44)]||_0xb1ef98['imageUrl'])+'\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>'+_0xb1ef98['name']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x30d460+_0x2cda4f(0xa5b)+(_0x4fd326[_0x2cda4f(0x362)]?.[_0x2cda4f(0xa6f)]||_0xb1ef98[_0x2cda4f(0xa6f)])['toFixed'](0x2)+_0x2cda4f(0x122d)+_0xb1ef98['id']+_0x2cda4f(0x3f1)+_0x4fd326[_0x2cda4f(0x108a)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22'+_0xb1ef98['id']+_0x2cda4f(0x1017),_0x1e86da[_0x2cda4f(0x120c)](_0x536245);}});}_0x592ec4();}async function _0x592ec4(){const _0x33286e=_0x241b18;let _0x2c9e9a=0x0;const _0x2a1135=document[_0x33286e(0x10d6)]('.cart-item-checkbox:checked'),_0x374c8b=Array['from'](_0x2a1135)[_0x33286e(0x796)](_0xf47963=>parseInt(_0xf47963[_0x33286e(0xaca)]['id']));if(_0x374c8b[_0x33286e(0x594)]>0x0){const _0x319ff1=await _0x2e83f8[_0x33286e(0x120)][_0x33286e(0x129e)]('id')[_0x33286e(0x1209)](_0x374c8b)[_0x33286e(0x508)](),_0x4b633d=new Map(_0x319ff1[_0x33286e(0x796)](_0x1c4be5=>[_0x1c4be5['id'],_0x1c4be5]));_0x103e33['forEach'](_0xe8ad50=>{const _0x2bbd7e=_0x33286e;if(_0x374c8b['includes'](_0xe8ad50[_0x2bbd7e(0x8a2)])){const _0x2776ee=_0x4b633d[_0x2bbd7e(0x1289)](_0xe8ad50['productId']);if(_0x2776ee){const _0x162e27=_0xe8ad50['variation']?_0xe8ad50[_0x2bbd7e(0x362)]['price']:_0x2776ee[_0x2bbd7e(0xa6f)];_0x2c9e9a+=_0x162e27*_0xe8ad50[_0x2bbd7e(0x108a)];}}});}document[_0x33286e(0x11e3)]('cart-total')['textContent']=_0x33286e(0x5ec)+_0x2c9e9a[_0x33286e(0x200)](0x2);}async function _0x46c94e(){const _0x1dc8ab=_0x241b18,_0x53ce20=_0x5de8b7[_0x1dc8ab(0x737)][_0x5de8b7[_0x1dc8ab(0x93d)]];if(!_0x53ce20||!_0x53ce20[_0x1dc8ab(0x1244)])return;const _0x2e80f3=document[_0x1dc8ab(0x11e3)](_0x1dc8ab(0xe4e)),_0x5595d5=document['getElementById'](_0x1dc8ab(0x10a0));_0x5595d5[_0x1dc8ab(0x595)]='';const _0x3283f6=_0x53ce20[_0x1dc8ab(0x761)][_0x1dc8ab(0xca7)]||'我',_0x2effac=_0x53ce20[_0x1dc8ab(0x2b3)][_0x1dc8ab(0x138)](_0x46fc19=>_0x46fc19['groupNickname']!==_0x3283f6);_0x2effac[_0x1dc8ab(0x494)](_0xb6a70c=>{const _0x545cd2=_0x1dc8ab,_0xb5ea89=document[_0x545cd2(0x383)](_0x545cd2(0x1285));_0xb5ea89[_0x545cd2(0x3db)]=_0x545cd2(0x9b3),_0xb5ea89[_0x545cd2(0xaca)][_0x545cd2(0x10f)]=_0xb6a70c[_0x545cd2(0x697)],_0xb5ea89[_0x545cd2(0x595)]=_0x545cd2(0x187)+(_0xb6a70c[_0x545cd2(0x525)]||_0x4d9574)+_0x545cd2(0x6d7)+_0xb6a70c['groupNickname']+_0x545cd2(0x411),_0x5595d5['appendChild'](_0xb5ea89);}),document[_0x1dc8ab(0x11e3)](_0x1dc8ab(0x59a))[_0x1dc8ab(0x3e4)]=![],_0x2e80f3[_0x1dc8ab(0x505)][_0x1dc8ab(0x252)](_0x1dc8ab(0x250));}async function _0x44390c(){const _0x390d47=_0x241b18,_0x4f4a95=_0x5de8b7[_0x390d47(0x737)][_0x5de8b7[_0x390d47(0x93d)]],_0x36c25d=_0x103e33[_0x390d47(0x138)](_0x470be4=>document[_0x390d47(0x5ac)](_0x390d47(0x428)+_0x470be4['productId']+_0x390d47(0xde5)));if(_0x36c25d[_0x390d47(0x594)]===0x0){alert(_0x390d47(0x92e));return;}if(_0x4f4a95[_0x390d47(0x1244)])_0x46c94e();else{const _0x3d7932=await _0x58fd60(_0x390d47(0xbbd),_0x390d47(0x6ab),{'confirmText':_0x390d47(0x54f)});_0x3d7932&&await _0x38803b(_0x36c25d);}}async function _0x38803b(_0x11ca8e,_0x1936ba=null){const _0x1c763e=_0x241b18;if(!_0x5de8b7['activeChatId'])return;const _0x2953ad=_0x5de8b7[_0x1c763e(0x737)][_0x5de8b7['activeChatId']],_0x39a449=_0x11ca8e[_0x1c763e(0x796)](_0x24cc7d=>_0x24cc7d[_0x1c763e(0x8a2)]),_0x4f6683=await _0x2e83f8[_0x1c763e(0x120)][_0x1c763e(0x129e)]('id')[_0x1c763e(0x1209)](_0x39a449)['toArray'](),_0x58fe1d=new Map(_0x4f6683['map'](_0x3bc6c0=>[_0x3bc6c0['id'],_0x3bc6c0])),_0x4c2b95=_0x11ca8e[_0x1c763e(0x796)](_0x4dead6=>{const _0x101e88=_0x1c763e,_0x626ffc=_0x58fe1d[_0x101e88(0x1289)](_0x4dead6[_0x101e88(0x8a2)]);return _0x4dead6[_0x101e88(0x362)]?{'name':_0x626ffc['name']+_0x101e88(0x12a2)+_0x4dead6[_0x101e88(0x362)]['name'],'price':_0x4dead6[_0x101e88(0x362)][_0x101e88(0xa6f)],'imageUrl':_0x4dead6[_0x101e88(0x362)][_0x101e88(0xf44)]||_0x626ffc['imageUrl'],'quantity':_0x4dead6[_0x101e88(0x108a)]}:{'name':_0x626ffc[_0x101e88(0x278)],'price':_0x626ffc[_0x101e88(0xa6f)],'imageUrl':_0x626ffc['imageUrl'],'quantity':_0x4dead6[_0x101e88(0x108a)]};}),_0x51c781={'role':_0x1c763e(0x21c),'type':'gift','timestamp':Date[_0x1c763e(0x1182)](),'items':_0x4c2b95,'total':_0x4c2b95[_0x1c763e(0x870)]((_0x117233,_0x1d8943)=>_0x117233+_0x1d8943['price']*_0x1d8943['quantity'],0x0),'recipients':_0x1936ba};_0x2953ad[_0x1c763e(0x49e)]['push'](_0x51c781);if(_0x1936ba&&_0x1936ba[_0x1c763e(0x594)]>0x0){const _0x2047f4=_0x1936ba[_0x1c763e(0x796)](_0x3c4a73=>_0xd9d60a(_0x2953ad,_0x3c4a73))['join']('、'),_0x7da9e7={'role':_0x1c763e(0xf72),'content':_0x1c763e(0x430)+(_0x2953ad[_0x1c763e(0x761)][_0x1c763e(0xca7)]||'我')+_0x1c763e(0xb44)+_0x2047f4+_0x1c763e(0xdfc),'timestamp':Date[_0x1c763e(0x1182)]()+0x1,'isHidden':!![]};_0x2953ad[_0x1c763e(0x49e)][_0x1c763e(0xf5)](_0x7da9e7);}await _0x2e83f8[_0x1c763e(0x737)][_0x1c763e(0xe3c)](_0x2953ad),_0x3b5153(_0x51c781,_0x2953ad),_0x5ee219(),_0x103e33=_0x103e33[_0x1c763e(0x138)](_0x51dbf6=>!_0x11ca8e[_0x1c763e(0xe7c)](_0x1e82ed=>_0x1e82ed['productId']===_0x51dbf6[_0x1c763e(0x8a2)])),_0x32aedc(),_0x4e7698('chat-interface-screen'),await _0x2fb06('成功','礼物已成功送出！');}function _0x1ffc2a(_0x5f0f10){const _0x1a56d4=_0x241b18,_0x3201d8=_0x5de8b7[_0x1a56d4(0x737)][_0x5de8b7[_0x1a56d4(0x93d)]],_0x367fe3=_0x3201d8[_0x1a56d4(0x49e)][_0x1a56d4(0xe79)](_0x4de38d=>_0x4de38d[_0x1a56d4(0x702)]===_0x5f0f10);if(!_0x367fe3||_0x367fe3[_0x1a56d4(0xa20)]!==_0x1a56d4(0xf9e))return;const _0x450fba=document[_0x1a56d4(0x11e3)](_0x1a56d4(0x2d3));let _0x1787e6='';_0x367fe3['items'][_0x1a56d4(0x494)](_0x3308eb=>{const _0x1e1555=_0x1a56d4;_0x1787e6+=_0x1e1555(0x545)+_0x3308eb[_0x1e1555(0x278)]+_0x1e1555(0x21d)+_0x3308eb[_0x1e1555(0x108a)]+_0x1e1555(0xc14)+_0x3308eb['price'][_0x1e1555(0x200)](0x2)+'</td><td\x20class=\x22item-subtotal\x22>¥'+(_0x3308eb[_0x1e1555(0xa6f)]*_0x3308eb[_0x1e1555(0x108a)])[_0x1e1555(0x200)](0x2)+_0x1e1555(0x922);}),_0x450fba[_0x1a56d4(0x595)]=_0x1a56d4(0x129d)+new Date(_0x367fe3[_0x1a56d4(0x702)])[_0x1a56d4(0x9df)]()+'</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>'+_0x1787e6+_0x1a56d4(0x7a0)+_0x367fe3['total'][_0x1a56d4(0x200)](0x2)+'</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>',document[_0x1a56d4(0x11e3)]('gift-receipt-modal')[_0x1a56d4(0x505)]['add'](_0x1a56d4(0x250));}async function _0x4addff(_0x16fb9f=null){const _0x408bce=_0x241b18;_0x37ebf7=_0x16fb9f;const _0x501b28=document[_0x408bce(0x11e3)](_0x408bce(0xe9a)),_0x5134d0=document[_0x408bce(0x11e3)](_0x408bce(0x5fa)),_0x588ae3=document[_0x408bce(0x11e3)]('product-name-input'),_0x2ffe26=document[_0x408bce(0x11e3)]('product-price-input'),_0x49b59a=document[_0x408bce(0x11e3)](_0x408bce(0x333)),_0x4f15c5=document[_0x408bce(0x11e3)]('product-image-preview'),_0x512438=document[_0x408bce(0x11e3)](_0x408bce(0xda5)),_0x17b06d=document['getElementById']('product-variations-container');_0x17b06d[_0x408bce(0x595)]='',_0x512438[_0x408bce(0x595)]=_0x408bce(0xce4);const _0x2b4358=await _0x2e83f8[_0x408bce(0xf85)][_0x408bce(0x508)]();_0x2b4358['forEach'](_0x2e7d00=>{const _0x584705=_0x408bce,_0xc22451=document[_0x584705(0x383)](_0x584705(0xd91));_0xc22451[_0x584705(0xf27)]=_0x2e7d00['id'],_0xc22451[_0x584705(0x300)]=_0x2e7d00[_0x584705(0x278)],_0x512438[_0x584705(0x120c)](_0xc22451);});if(_0x16fb9f){_0x5134d0[_0x408bce(0x300)]=_0x408bce(0xfa1);const _0x2931a5=await _0x2e83f8[_0x408bce(0x120)][_0x408bce(0x1289)](_0x16fb9f);_0x588ae3[_0x408bce(0xf27)]=_0x2931a5['name'],_0x2ffe26[_0x408bce(0xf27)]=_0x2931a5[_0x408bce(0xa6f)],_0x49b59a[_0x408bce(0xf27)]=_0x2931a5[_0x408bce(0x1029)]||'',_0x4f15c5[_0x408bce(0xf0a)]=_0x2931a5[_0x408bce(0xf44)],_0x512438[_0x408bce(0xf27)]=_0x2931a5[_0x408bce(0x9ee)]||'',_0x2931a5[_0x408bce(0x1039)]&&_0x2931a5[_0x408bce(0x1039)]['length']>0x0&&_0x2931a5[_0x408bce(0x1039)][_0x408bce(0x494)](_0x3b137e=>_0x3e9ca6(_0x3b137e));}else _0x5134d0[_0x408bce(0x300)]=_0x408bce(0x909),_0x588ae3[_0x408bce(0xf27)]='',_0x2ffe26[_0x408bce(0xf27)]='',_0x49b59a[_0x408bce(0xf27)]='',_0x4f15c5['src']='https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg',_0x512438['value']='';_0x501b28[_0x408bce(0x505)][_0x408bce(0x252)](_0x408bce(0x250));}async function _0x5d47dc(){const _0xa017d5=_0x241b18,_0x40b07a=document[_0xa017d5(0x11e3)](_0xa017d5(0x74e))[_0xa017d5(0xf27)][_0xa017d5(0xeb7)](),_0x1045e2=parseFloat(document[_0xa017d5(0x11e3)]('product-price-input')[_0xa017d5(0xf27)]),_0xe44679=document[_0xa017d5(0x11e3)](_0xa017d5(0x333))['value'][_0xa017d5(0xeb7)](),_0x444370=document[_0xa017d5(0x11e3)]('product-image-preview')[_0xa017d5(0xf0a)],_0x257eb1=parseInt(document[_0xa017d5(0x11e3)]('product-category-select')[_0xa017d5(0xf27)])||null;if(!_0x40b07a){alert('商品名称不能为空！');return;}if(isNaN(_0x1045e2)||_0x1045e2<0x0){alert('请输入有效的默认价格！');return;}const _0x130495=[];document['querySelectorAll']('.variation-block')['forEach'](_0x68cb1a=>{const _0x4e1fc0=_0xa017d5,_0x20f2f4=_0x68cb1a[_0x4e1fc0(0x5ac)](_0x4e1fc0(0x9ec))['value'][_0x4e1fc0(0xeb7)](),_0x457ead=parseFloat(_0x68cb1a['querySelector'](_0x4e1fc0(0x7d0))[_0x4e1fc0(0xf27)]),_0x123b5d=_0x68cb1a[_0x4e1fc0(0x5ac)](_0x4e1fc0(0xd8f))['src'];_0x20f2f4&&!isNaN(_0x457ead)&&_0x457ead>=0x0&&_0x130495['push']({'name':_0x20f2f4,'price':_0x457ead,'imageUrl':_0x123b5d[_0x4e1fc0(0x3ad)](_0x4e1fc0(0xeec))?null:_0x123b5d});});const _0x5be98d={'name':_0x40b07a,'price':_0x1045e2,'description':_0xe44679,'imageUrl':_0x444370,'categoryId':_0x257eb1,'variations':_0x130495};_0x37ebf7?await _0x2e83f8['shoppingProducts']['update'](_0x37ebf7,_0x5be98d):await _0x2e83f8[_0xa017d5(0x120)][_0xa017d5(0x252)](_0x5be98d),document[_0xa017d5(0x11e3)]('product-editor-modal')[_0xa017d5(0x505)][_0xa017d5(0x957)](_0xa017d5(0x250)),await _0x1deb57();}async function _0x27576b(){const _0x4886be=_0x241b18;await _0x3d5634(),_0x4e7698(_0x4886be(0x450));}async function _0x3d5634(){const _0x528554=_0x241b18,_0x53edce=document[_0x528554(0x11e3)]('rules-tabs'),_0x1a4612=document[_0x528554(0x11e3)](_0x528554(0x3b8));_0x53edce[_0x528554(0x595)]='',_0x1a4612[_0x528554(0x595)]='';const _0x4b145c=await _0x2e83f8[_0x528554(0x6eb)][_0x528554(0x508)]();if(_0x4b145c['length']===0x0){_0x1a4612[_0x528554(0x595)]=_0x528554(0x783);return;}const _0x4dab01=document[_0x528554(0x383)](_0x528554(0xbf2));_0x4dab01['className']=_0x528554(0xdd6),_0x4dab01[_0x528554(0x300)]=_0x528554(0x470),_0x4dab01[_0x528554(0xaca)][_0x528554(0x9ee)]=_0x528554(0x104b),_0x53edce[_0x528554(0x120c)](_0x4dab01);const _0x465583=document[_0x528554(0x383)]('div');_0x465583[_0x528554(0x3db)]=_0x528554(0x7c1),_0x465583[_0x528554(0xaca)]['categoryId']=_0x528554(0x104b),_0x1a4612[_0x528554(0x120c)](_0x465583);const _0x3b131c=Object[_0x528554(0x4ca)](_0x5de8b7[_0x528554(0x737)])[_0x528554(0x138)](_0x5f3d7d=>!_0x5f3d7d[_0x528554(0x1244)]&&_0x4b145c[_0x528554(0xe7c)](_0x24a498=>_0x24a498[_0x528554(0x115)]===_0x5f3d7d['id']));_0x3b131c[_0x528554(0x494)](_0x4bd824=>{const _0x846092=_0x528554,_0x91846a=document['createElement'](_0x846092(0xbf2));_0x91846a[_0x846092(0x3db)]=_0x846092(0x245),_0x91846a['textContent']=_0x4bd824[_0x846092(0x278)],_0x91846a[_0x846092(0xaca)][_0x846092(0x9ee)]=_0x4bd824['id'],_0x53edce[_0x846092(0x120c)](_0x91846a);const _0x58cf7f=document[_0x846092(0x383)](_0x846092(0x1285));_0x58cf7f[_0x846092(0x3db)]='rules-category-pane',_0x58cf7f['dataset']['categoryId']=_0x4bd824['id'],_0x1a4612[_0x846092(0x120c)](_0x58cf7f);}),_0x4b145c[_0x528554(0x494)](_0x1f04ef=>{const _0x499ae5=_0x528554,_0x216d6b=_0xd7b86b(_0x1f04ef),_0x158075=_0x1a4612['querySelector']('.rules-category-pane[data-category-id=\x22'+_0x1f04ef[_0x499ae5(0x115)]+'\x22]');_0x158075&&_0x158075[_0x499ae5(0x120c)](_0x216d6b);}),document['querySelectorAll'](_0x528554(0x327))['forEach'](_0x402d1a=>{const _0x34376b=_0x528554;_0x402d1a[_0x34376b(0x4b8)](_0x34376b(0x1041),()=>_0x57f501(_0x402d1a[_0x34376b(0xaca)]['categoryId']));});}function _0xd7b86b(_0x2b9922){const _0x4a3329=_0x241b18,_0x31b876=document[_0x4a3329(0x383)](_0x4a3329(0x1285));return _0x31b876[_0x4a3329(0x3db)]=_0x4a3329(0x4a8)+(_0x2b9922[_0x4a3329(0x12bc)]?_0x4a3329(0xc34):''),_0x31b876[_0x4a3329(0xaca)][_0x4a3329(0xf2b)]=_0x2b9922['id'],_0x31b876[_0x4a3329(0x595)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x2b9922['name']+_0x4a3329(0xf62)+_0x2b9922[_0x4a3329(0xdd3)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x31b876[_0x4a3329(0x4b8)](_0x4a3329(0x1041),()=>_0x18a503(_0x2b9922['id'])),_0xcb6204(_0x31b876,()=>_0x41ffea(_0x2b9922['id'])),_0x31b876;}async function _0x18a503(_0x17dcaf=null){const _0x528fc0=_0x241b18;_0x1a868e=_0x17dcaf;const _0x585a7f=document[_0x528fc0(0x11e3)](_0x528fc0(0x7b4)),_0x487659=document['getElementById'](_0x528fc0(0x50c)),_0x565fff=document[_0x528fc0(0x11e3)](_0x528fc0(0x5df)),_0x4d92ed=document[_0x528fc0(0x11e3)](_0x528fc0(0xe7b)),_0x50f610=document[_0x528fc0(0x11e3)](_0x528fc0(0x477)),_0x1c5533=document[_0x528fc0(0x11e3)](_0x528fc0(0x618)),_0x45d871=document['getElementById'](_0x528fc0(0x72b));_0x4d92ed[_0x528fc0(0x595)]='<option\x20value=\x22global\x22>公用\x20(所有角色)</option>',Object[_0x528fc0(0x4ca)](_0x5de8b7[_0x528fc0(0x737)])[_0x528fc0(0x138)](_0x23202a=>!_0x23202a[_0x528fc0(0x1244)])[_0x528fc0(0x494)](_0x3293eb=>{const _0x26f3ee=_0x528fc0;_0x4d92ed[_0x26f3ee(0x595)]+=_0x26f3ee(0x1ba)+_0x3293eb['id']+'\x22>'+_0x3293eb[_0x26f3ee(0x278)]+_0x26f3ee(0x95f);});if(_0x17dcaf){_0x487659['textContent']=_0x528fc0(0x1157);const _0xcdb17a=await _0x2e83f8[_0x528fc0(0x6eb)]['get'](_0x17dcaf);_0x565fff[_0x528fc0(0xf27)]=_0xcdb17a[_0x528fc0(0x278)],_0x4d92ed['value']=_0xcdb17a[_0x528fc0(0x115)],_0x50f610[_0x528fc0(0xf27)]=_0xcdb17a['regex'],_0x1c5533[_0x528fc0(0xf27)]=_0xcdb17a[_0x528fc0(0xc72)],_0x45d871['checked']=_0xcdb17a[_0x528fc0(0x12bc)];}else _0x487659[_0x528fc0(0x300)]=_0x528fc0(0x9d5),_0x565fff[_0x528fc0(0xf27)]='',_0x4d92ed[_0x528fc0(0xf27)]='global',_0x50f610[_0x528fc0(0xf27)]='',_0x1c5533[_0x528fc0(0xf27)]='',_0x45d871[_0x528fc0(0x3e4)]=!![];_0x585a7f['classList'][_0x528fc0(0x252)](_0x528fc0(0x250));}async function _0x51837b(){const _0x52a83d=_0x241b18,_0x16e680=document[_0x52a83d(0x11e3)](_0x52a83d(0x5df))[_0x52a83d(0xf27)][_0x52a83d(0xeb7)](),_0x7e71d7=document[_0x52a83d(0x11e3)](_0x52a83d(0x477))[_0x52a83d(0xf27)]['trim']();if(!_0x16e680||!_0x7e71d7){alert(_0x52a83d(0xde0));return;}try{new RegExp(_0x7e71d7);}catch(_0x1bdfb7){alert(_0x52a83d(0x738)+_0x1bdfb7[_0x52a83d(0x4bc)]);return;}const _0x55ed81={'name':_0x16e680,'chatId':document['getElementById'](_0x52a83d(0xe7b))[_0x52a83d(0xf27)],'regex':_0x7e71d7,'template':document[_0x52a83d(0x11e3)](_0x52a83d(0x618))[_0x52a83d(0xf27)],'isEnabled':document[_0x52a83d(0x11e3)](_0x52a83d(0x72b))[_0x52a83d(0x3e4)]};_0x1a868e?await _0x2e83f8[_0x52a83d(0x6eb)][_0x52a83d(0x1225)](_0x1a868e,_0x55ed81):await _0x2e83f8[_0x52a83d(0x6eb)][_0x52a83d(0x252)](_0x55ed81),document['getElementById'](_0x52a83d(0x7b4))['classList']['remove'](_0x52a83d(0x250)),await _0x3d5634();}async function _0x41ffea(_0x407d5c){const _0x5df22c=_0x241b18,_0x2359b8=await _0x58fd60(_0x5df22c(0x1c0),'确定要删除这条渲染规则吗？',{'confirmButtonClass':_0x5df22c(0x8a6)});_0x2359b8&&(await _0x2e83f8[_0x5df22c(0x6eb)][_0x5df22c(0xc0c)](_0x407d5c),await _0x3d5634());}async function _0x5109d0(_0x1bbe64,_0x56e2bb){const _0x2db584=_0x241b18;if(_0x1bbe64[_0x2db584(0xeb7)]()[_0x2db584(0xb6c)]('<')||!_0x1bbe64[_0x2db584(0x3ad)]('[')&&!_0x1bbe64[_0x2db584(0x3ad)]('{'))return _0x1bbe64;const _0x3f21bf=await _0x2e83f8[_0x2db584(0x6eb)][_0x2db584(0x129e)](_0x2db584(0x115))[_0x2db584(0x119e)](_0x2db584(0x104b))['or'](_0x2db584(0x115))[_0x2db584(0x119e)](_0x56e2bb)[_0x2db584(0x508)]();let _0x23b003=_0x1bbe64;for(const _0x4b854e of _0x3f21bf[_0x2db584(0x138)](_0x765749=>_0x765749['isEnabled'])){try{const _0x20cb60=new RegExp(_0x4b854e['regex'],'g');_0x20cb60[_0x2db584(0x1043)](_0x23b003)&&(_0x23b003=_0x23b003['replace'](_0x20cb60,_0x4b854e['template']));}catch(_0x1c9808){console[_0x2db584(0x1c1)](_0x2db584(0x2de)+_0x4b854e['name']+_0x2db584(0xc6f),_0x1c9808);}}return _0x23b003;}async function _0x27576b(){const _0x192c5f=_0x241b18;await _0x3d5634(),_0x4e7698(_0x192c5f(0x450));}async function _0x3d5634(){const _0x3ce062=_0x241b18,_0x1f5cf9=document[_0x3ce062(0x11e3)](_0x3ce062(0x38e)),_0x513c6e=document['getElementById'](_0x3ce062(0x3b8));_0x1f5cf9[_0x3ce062(0x595)]='',_0x513c6e[_0x3ce062(0x595)]='';const _0x3b5250=await _0x2e83f8[_0x3ce062(0x6eb)]['toArray']();if(_0x3b5250['length']===0x0){_0x513c6e[_0x3ce062(0x595)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>';return;}const _0x5aadd3=document[_0x3ce062(0x383)](_0x3ce062(0xbf2));_0x5aadd3['className']=_0x3ce062(0xdd6),_0x5aadd3[_0x3ce062(0x300)]='公用规则',_0x5aadd3[_0x3ce062(0xaca)][_0x3ce062(0x9ee)]=_0x3ce062(0x104b),_0x1f5cf9[_0x3ce062(0x120c)](_0x5aadd3);const _0x14cb09=document['createElement'](_0x3ce062(0x1285));_0x14cb09[_0x3ce062(0x3db)]=_0x3ce062(0x7c1),_0x14cb09[_0x3ce062(0xaca)]['categoryId']='global',_0x513c6e[_0x3ce062(0x120c)](_0x14cb09);const _0x5eb014=Object[_0x3ce062(0x4ca)](_0x5de8b7[_0x3ce062(0x737)])[_0x3ce062(0x138)](_0x108cd8=>!_0x108cd8['isGroup']&&_0x3b5250['some'](_0x5c46ac=>_0x5c46ac[_0x3ce062(0x115)]===_0x108cd8['id']));_0x5eb014[_0x3ce062(0x494)](_0x22f924=>{const _0x39c15d=_0x3ce062,_0x2bb4b3=document['createElement'](_0x39c15d(0xbf2));_0x2bb4b3[_0x39c15d(0x3db)]=_0x39c15d(0x245),_0x2bb4b3[_0x39c15d(0x300)]=_0x22f924[_0x39c15d(0x278)],_0x2bb4b3['dataset'][_0x39c15d(0x9ee)]=_0x22f924['id'],_0x1f5cf9['appendChild'](_0x2bb4b3);const _0x212492=document[_0x39c15d(0x383)](_0x39c15d(0x1285));_0x212492[_0x39c15d(0x3db)]='rules-category-pane',_0x212492[_0x39c15d(0xaca)]['categoryId']=_0x22f924['id'],_0x513c6e[_0x39c15d(0x120c)](_0x212492);}),_0x3b5250[_0x3ce062(0x494)](_0xf68ff=>{const _0x38f79c=_0x3ce062,_0x9ab38=_0xd7b86b(_0xf68ff),_0x530de2=_0x513c6e[_0x38f79c(0x5ac)]('.rules-category-pane[data-category-id=\x22'+_0xf68ff[_0x38f79c(0x115)]+'\x22]');_0x530de2&&_0x530de2[_0x38f79c(0x120c)](_0x9ab38);}),document[_0x3ce062(0x10d6)](_0x3ce062(0x327))['forEach'](_0x475d65=>{const _0x113cc3=_0x3ce062;_0x475d65[_0x113cc3(0x4b8)](_0x113cc3(0x1041),()=>_0x57f501(_0x475d65[_0x113cc3(0xaca)][_0x113cc3(0x9ee)]));});}function _0xd7b86b(_0x3b1a51){const _0x4442dc=_0x241b18,_0x4c5eff=document['createElement']('div');return _0x4c5eff['className']='rule-card\x20'+(_0x3b1a51['isEnabled']?_0x4442dc(0xc34):''),_0x4c5eff[_0x4442dc(0xaca)][_0x4442dc(0xf2b)]=_0x3b1a51['id'],_0x4c5eff[_0x4442dc(0x595)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x3b1a51[_0x4442dc(0x278)]+_0x4442dc(0xf62)+_0x3b1a51[_0x4442dc(0xdd3)]+_0x4442dc(0x999),_0x4c5eff[_0x4442dc(0x4b8)](_0x4442dc(0x1041),()=>_0x18a503(_0x3b1a51['id'])),_0xcb6204(_0x4c5eff,()=>_0x41ffea(_0x3b1a51['id'])),_0x4c5eff;}async function _0x18a503(_0x210f16=null){const _0xae7ff1=_0x241b18;_0x1a868e=_0x210f16;const _0x31587c=document[_0xae7ff1(0x11e3)](_0xae7ff1(0x7b4)),_0x4cb95a=document[_0xae7ff1(0x11e3)](_0xae7ff1(0x50c)),_0x3fea67=document[_0xae7ff1(0x11e3)]('rule-name-input'),_0x5813a2=document[_0xae7ff1(0x11e3)](_0xae7ff1(0xe7b)),_0x22c8a9=document[_0xae7ff1(0x11e3)](_0xae7ff1(0x477)),_0x2036b8=document['getElementById'](_0xae7ff1(0x618)),_0x2c88af=document[_0xae7ff1(0x11e3)](_0xae7ff1(0x72b));_0x5813a2[_0xae7ff1(0x595)]=_0xae7ff1(0x2d1),Object[_0xae7ff1(0x4ca)](_0x5de8b7['chats'])[_0xae7ff1(0x138)](_0x5649fc=>!_0x5649fc[_0xae7ff1(0x1244)])[_0xae7ff1(0x494)](_0x4ae91e=>{const _0x1ba79f=_0xae7ff1;_0x5813a2['innerHTML']+='<option\x20value=\x22'+_0x4ae91e['id']+'\x22>'+_0x4ae91e[_0x1ba79f(0x278)]+_0x1ba79f(0x95f);});if(_0x210f16){_0x4cb95a['textContent']='编辑规则';const _0x184e7d=await _0x2e83f8[_0xae7ff1(0x6eb)][_0xae7ff1(0x1289)](_0x210f16);_0x3fea67[_0xae7ff1(0xf27)]=_0x184e7d[_0xae7ff1(0x278)],_0x5813a2[_0xae7ff1(0xf27)]=_0x184e7d[_0xae7ff1(0x115)],_0x22c8a9[_0xae7ff1(0xf27)]=_0x184e7d[_0xae7ff1(0xdd3)],_0x2036b8['value']=_0x184e7d[_0xae7ff1(0xc72)],_0x2c88af[_0xae7ff1(0x3e4)]=_0x184e7d[_0xae7ff1(0x12bc)];}else _0x4cb95a[_0xae7ff1(0x300)]=_0xae7ff1(0x9d5),_0x3fea67[_0xae7ff1(0xf27)]='',_0x5813a2[_0xae7ff1(0xf27)]=_0xae7ff1(0x104b),_0x22c8a9[_0xae7ff1(0xf27)]='',_0x2036b8[_0xae7ff1(0xf27)]='',_0x2c88af[_0xae7ff1(0x3e4)]=!![];_0x31587c[_0xae7ff1(0x505)][_0xae7ff1(0x252)](_0xae7ff1(0x250));}async function _0x51837b(){const _0x44000a=_0x241b18,_0x3953c8=document[_0x44000a(0x11e3)](_0x44000a(0x5df))[_0x44000a(0xf27)][_0x44000a(0xeb7)](),_0x43b4c9=document[_0x44000a(0x11e3)](_0x44000a(0x477))[_0x44000a(0xf27)][_0x44000a(0xeb7)]();if(!_0x3953c8||!_0x43b4c9){alert(_0x44000a(0xde0));return;}try{new RegExp(_0x43b4c9);}catch(_0x733d88){alert(_0x44000a(0x738)+_0x733d88['message']);return;}const _0x201c34={'name':_0x3953c8,'chatId':document[_0x44000a(0x11e3)](_0x44000a(0xe7b))[_0x44000a(0xf27)],'regex':_0x43b4c9,'template':document['getElementById']('rule-template-input')[_0x44000a(0xf27)],'isEnabled':document[_0x44000a(0x11e3)](_0x44000a(0x72b))[_0x44000a(0x3e4)]};_0x1a868e?await _0x2e83f8[_0x44000a(0x6eb)][_0x44000a(0x1225)](_0x1a868e,_0x201c34):await _0x2e83f8[_0x44000a(0x6eb)][_0x44000a(0x252)](_0x201c34),document[_0x44000a(0x11e3)](_0x44000a(0x7b4))[_0x44000a(0x505)]['remove']('visible'),await _0x3d5634();}async function _0x41ffea(_0xbfe39){const _0x4f99d8=_0x241b18,_0x584f5c=await _0x58fd60(_0x4f99d8(0x1c0),_0x4f99d8(0xc38),{'confirmButtonClass':'btn-danger'});_0x584f5c&&(await _0x2e83f8[_0x4f99d8(0x6eb)][_0x4f99d8(0xc0c)](_0xbfe39),await _0x3d5634());}async function _0x5109d0(_0x478f14,_0x14c924){const _0x33986e=_0x241b18;if(_0x478f14[_0x33986e(0xeb7)]()[_0x33986e(0xb6c)]('<')||!_0x478f14[_0x33986e(0x3ad)]('[')&&!_0x478f14[_0x33986e(0x3ad)]('{'))return _0x478f14;if(!_0x5aa3cf[_0x14c924]){console[_0x33986e(0x84b)](_0x33986e(0xda2)+_0x14c924);const _0x4970a=await _0x2e83f8[_0x33986e(0x6eb)][_0x33986e(0x129e)](_0x33986e(0x115))['equals']('global')['or'](_0x33986e(0x115))[_0x33986e(0x119e)](_0x14c924)[_0x33986e(0x508)]();_0x5aa3cf[_0x14c924]=_0x4970a[_0x33986e(0x138)](_0x391a5d=>_0x391a5d[_0x33986e(0x12bc)]);}const _0x2d725c=_0x5aa3cf[_0x14c924];let _0x7b8069=_0x478f14;for(const _0x4b10cc of _0x2d725c){try{const _0xecb705=new RegExp(_0x4b10cc[_0x33986e(0xdd3)],'g');let _0x1b9957=_0x7b8069;_0xecb705['test'](_0x1b9957)&&(_0x7b8069=_0x7b8069[_0x33986e(0x1018)](_0xecb705,_0x4b10cc[_0x33986e(0xc72)]));}catch(_0x182d46){console[_0x33986e(0x1c1)]('渲染规则\x20['+_0x4b10cc[_0x33986e(0x278)]+_0x33986e(0xc6f),_0x182d46);}}return _0x7b8069;}function _0x25ae9a(_0x42db9b){const _0x364dd2=_0x241b18;if(!_0x42db9b)return'';const _0x50fb7d=new Date(),_0x5f4e63=new Date(_0x42db9b),_0x3624f8=String(_0x5f4e63[_0x364dd2(0x3de)]())[_0x364dd2(0xae4)](0x2,'0'),_0x112f34=String(_0x5f4e63['getMinutes']())[_0x364dd2(0xae4)](0x2,'0'),_0xae96b4=_0x3624f8+':'+_0x112f34;if(_0x50fb7d[_0x364dd2(0x1025)]()===_0x5f4e63['toDateString']())return _0xae96b4;const _0x3c63e2=new Date();_0x3c63e2[_0x364dd2(0x322)](_0x50fb7d[_0x364dd2(0x97d)]()-0x1);if(_0x3c63e2[_0x364dd2(0x1025)]()===_0x5f4e63[_0x364dd2(0x1025)]())return _0x364dd2(0xcce)+_0xae96b4;const _0x120d19=_0x5f4e63[_0x364dd2(0x177)](),_0x462bba=String(_0x5f4e63[_0x364dd2(0x39d)]()+0x1)[_0x364dd2(0xae4)](0x2,'0'),_0x5d8bbc=String(_0x5f4e63['getDate']())[_0x364dd2(0xae4)](0x2,'0');return _0x50fb7d[_0x364dd2(0x177)]()===_0x120d19?_0x462bba+'月'+_0x5d8bbc+'日\x20'+_0xae96b4:_0x120d19+'年'+_0x462bba+'月'+_0x5d8bbc+'日\x20'+_0xae96b4;}function _0x4cf713(_0x1cd58c){const _0x4acc1e=_0x241b18,_0x5e1a63=document[_0x4acc1e(0x383)]('div');_0x5e1a63[_0x4acc1e(0x3db)]='message-wrapper\x20system-pat';const _0x4226d5=document[_0x4acc1e(0x383)](_0x4acc1e(0x1285));return _0x4226d5[_0x4acc1e(0x3db)]='message-bubble\x20system-bubble',_0x4226d5[_0x4acc1e(0x300)]=_0x25ae9a(_0x1cd58c),_0x5e1a63[_0x4acc1e(0x120c)](_0x4226d5),_0x5e1a63;}async function _0x3cb7cf(){const _0x1c1f17=_0x241b18,_0x366d5a=_0x5de8b7[_0x1c1f17(0x737)][_0x5de8b7[_0x1c1f17(0x93d)]];if(!_0x366d5a||!lastResponseTimestamps||lastResponseTimestamps[_0x1c1f17(0x594)]===0x0){alert(_0x1c1f17(0xc06));return;}_0x366d5a['history']=_0x366d5a[_0x1c1f17(0x49e)][_0x1c1f17(0x138)](_0x2887fc=>!lastResponseTimestamps['includes'](_0x2887fc[_0x1c1f17(0x702)])),await _0x2e83f8[_0x1c1f17(0x737)][_0x1c1f17(0xe3c)](_0x366d5a),await _0x544ab5(_0x5de8b7[_0x1c1f17(0x93d)]),_0x439f24();}async function _0x3c5dae(){const _0x59bfbe=_0x241b18,_0x2ff828=_0x5de8b7['chats'][_0x5de8b7[_0x59bfbe(0x93d)]];if(!_0x2ff828)return;const _0x408e33=_0x2ff828[_0x59bfbe(0x49e)][_0x59bfbe(0xd0a)](_0x51f968=>_0x51f968['role']===_0x59bfbe(0x21c)&&!_0x51f968[_0x59bfbe(0xbf5)]);if(_0x408e33===-0x1){alert(_0x59bfbe(0x2cc));return;}const _0x28cfc4=_0x2ff828['history'][_0x59bfbe(0xd0a)](_0x30abe6=>_0x30abe6[_0x59bfbe(0xba4)]===_0x59bfbe(0x1119));if(_0x28cfc4<_0x408e33){alert(_0x59bfbe(0x1090));return;}_0x2ff828['history'][_0x59bfbe(0xfd0)](_0x408e33+0x1),await _0x2e83f8[_0x59bfbe(0x737)]['put'](_0x2ff828),await _0x544ab5(_0x5de8b7['activeChatId']),await _0x14a9f0();}async function _0x4b130a(){const _0x3f1656=_0x241b18;if(!_0x46751e[_0x3f1656(0x3d5)])return;const _0x41ab61=_0x46751e[_0x3f1656(0x6ba)][_0x3f1656(0xd0a)](_0x3f2881=>_0x3f2881['role']===_0x3f1656(0x21c));if(_0x41ab61===-0x1){alert(_0x3f1656(0xffa));return;}_0x46751e[_0x3f1656(0x6ba)][_0x3f1656(0xfd0)](_0x41ab61+0x1);const _0x1f4dd2=document[_0x3f1656(0x11e3)]('video-call-main');_0x1f4dd2['innerHTML']='',_0x46751e[_0x3f1656(0x6ba)][_0x3f1656(0x494)](_0x3fa5e8=>{const _0x460456=_0x3f1656,_0xb11bfe=document['createElement'](_0x460456(0x1285));_0xb11bfe[_0x460456(0x3db)]='call-message-bubble\x20'+_0x3fa5e8[_0x460456(0xba4)]+_0x460456(0x1112),_0xb11bfe[_0x460456(0xaca)][_0x460456(0x702)]=_0x3fa5e8[_0x460456(0x702)],_0x3fa5e8[_0x460456(0xba4)]===_0x460456(0x21c)?_0xb11bfe['textContent']=_0x3fa5e8['content']:_0xb11bfe[_0x460456(0x595)]=_0x3fa5e8[_0x460456(0x9a5)],_0xcb6204(_0xb11bfe,()=>_0xc72c05(_0x3fa5e8[_0x460456(0x702)])),_0x1f4dd2[_0x460456(0x120c)](_0xb11bfe);}),_0x1f4dd2[_0x3f1656(0x11c7)]=_0x1f4dd2[_0x3f1656(0x36b)],_0x18571c(null);}async function _0x3fc4eb(){const _0x19351c=_0x241b18,_0x427562=_0x5de8b7[_0x19351c(0x737)][_0x5de8b7['activeChatId']];if(!_0x427562)return;_0x153b71(_0x427562['id'],!![]);const _0x3bbd42=document['getElementById'](_0x19351c(0x1205));!_0x427562[_0x19351c(0x1244)]&&(_0x3bbd42[_0x19351c(0x794)][_0x19351c(0x12fa)]=0x0,setTimeout(()=>{const _0x3c9e24=_0x19351c;_0x3bbd42['textContent']='对方正在输入...',_0x3bbd42['classList'][_0x3c9e24(0x252)](_0x3c9e24(0x680)),_0x3bbd42['style']['opacity']=0x1;},0xc8));try{const {proxyUrl:_0x5d472b,apiKey:_0x4bb6e5,model:_0x1af062}=_0x5de8b7['apiConfig'];if(!_0x5d472b||!_0x4bb6e5||!_0x1af062)throw new Error(_0x19351c(0xa08));const _0x1b7de1=parseInt(_0x427562['settings'][_0x19351c(0xb2e)])||0xa,_0x41a5a1=_0x427562[_0x19351c(0x49e)]['slice'](-_0x1b7de1),_0x2893ca=new Date(),_0x1610bf=new Date(_0x2893ca[_0x19351c(0xd2f)]()+_0x2893ca[_0x19351c(0x217)]()*0xea60+0x36ee80*0x8),_0x25e85a=_0x1610bf[_0x19351c(0x9df)](_0x19351c(0x898),{'timeZone':_0x19351c(0xaf7),'dateStyle':'full','timeStyle':_0x19351c(0x3f8)}),_0x26c2a9=_0xe5786(_0x1610bf),_0x10ee1b=_0x427562[_0x19351c(0x761)]['myNickname']||'我';let _0x392121='';if(_0x427562[_0x19351c(0x761)][_0x19351c(0xa17)]&&_0x427562[_0x19351c(0x761)]['linkedWorldBookIds'][_0x19351c(0x594)]>0x0){const _0x4466d6=_0x427562[_0x19351c(0x761)]['linkedWorldBookIds']['map'](_0x2c0f6a=>{const _0x4eaa90=_0x19351c,_0x28adac=_0x5de8b7[_0x4eaa90(0xca)][_0x4eaa90(0xe79)](_0x1d6354=>_0x1d6354['id']===_0x2c0f6a);if(!_0x28adac||!Array[_0x4eaa90(0xb7b)](_0x28adac[_0x4eaa90(0x9a5)]))return'';const _0x397429=_0x28adac[_0x4eaa90(0x9a5)][_0x4eaa90(0x138)](_0x4e8915=>_0x4e8915['enabled']!==![])[_0x4eaa90(0x796)](_0x5f0cb3=>{const _0x43dea0=_0x4eaa90;let _0x4e07a2=_0x43dea0(0xec3)+(_0x5f0cb3[_0x43dea0(0xebd)]||'无备注')+'\x0a';if(_0x5f0cb3[_0x43dea0(0xb4a)][_0x43dea0(0x594)]>0x0)_0x4e07a2+=_0x43dea0(0x105b)+_0x5f0cb3[_0x43dea0(0xb4a)][_0x43dea0(0xa4b)](',\x20')+'\x0a';return _0x4e07a2+='**内容:**\x0a'+_0x5f0cb3[_0x43dea0(0x9a5)],_0x4e07a2;})[_0x4eaa90(0xa4b)]('');return _0x397429?'\x0a\x0a##\x20世界书:\x20'+_0x28adac[_0x4eaa90(0x278)]+'\x0a'+_0x397429:'';})['filter'](Boolean)[_0x19351c(0xa4b)]('');_0x4466d6&&(_0x392121='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x4466d6+_0x19351c(0x421));}let _0x1a808b='';if(_0xb57b5b[_0x19351c(0x3d5)]&&_0xb57b5b[_0x19351c(0x93d)]===_0x427562['id']){const _0x2a433f=_0xb57b5b['currentIndex']>-0x1?_0xb57b5b[_0x19351c(0xcba)][_0xb57b5b[_0x19351c(0x12b5)]]:null;_0x1a808b='\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)';}const _0x2612d3=_0x356017(_0x17be1a[_0x427562['id']]);let _0x57b813='';_0x427562[_0x19351c(0x3d7)]&&_0x427562[_0x19351c(0x3d7)][_0x19351c(0x594)]>0x0&&(_0x57b813=_0x19351c(0xc57)+_0x427562[_0x19351c(0x3d7)][_0x19351c(0xa4b)](',\x20')+_0x19351c(0xfa5));let _0x3a6525='';const _0x517e1=_0x5de8b7['qzoneSettings'][_0x19351c(0xa33)]||'用户';_0x3a6525+=_0x19351c(0x6fb)+_0x517e1+'\x22。\x0a';const _0x488314=Object[_0x19351c(0x4ca)](_0x5de8b7[_0x19351c(0x737)])['filter'](_0x54ace9=>_0x54ace9['isGroup']&&_0x54ace9[_0x19351c(0x2b3)][_0x19351c(0xe7c)](_0xd8036=>_0xd8036['id']===_0x427562['id']));_0x488314['length']>0x0&&(_0x3a6525+='-\x20用户在你们共同所在的群聊中的昵称如下：\x0a',_0x488314[_0x19351c(0x494)](_0x1f437f=>{const _0x578df4=_0x19351c,_0x3e0059=_0x1f437f[_0x578df4(0x761)]['myNickname']||_0x517e1;_0x3a6525+=_0x578df4(0x825)+_0x1f437f[_0x578df4(0x278)]+'”中，用户的昵称是“'+_0x3e0059+_0x578df4(0x7fe);}));_0x3a6525+=_0x19351c(0xd6b);const _0x3a8c75=_0x5342bb(_0x427562),_0x49c910=_0x19351c(0x58e)+_0x427562[_0x19351c(0x697)]+_0x19351c(0x2e2)+_0x25e85a+'\x20('+_0x26c2a9+_0x19351c(0xce3)+(_0x1a808b?'你们正在一起听歌，'+_0x1a808b:'你们没有在听歌。')+_0x19351c(0x10da)+(_0x427562[_0x19351c(0xe21)]&&_0x427562[_0x19351c(0xe21)][_0x19351c(0x594)]>0x0?_0x427562['longTermMemory']['map'](_0x58b868=>'-\x20'+_0x58b868[_0x19351c(0x9a5)])['join']('\x0a'):_0x19351c(0x12cc))+'\x0a\x0a#\x20你的角色设定\x0a'+_0x427562['settings'][_0x19351c(0x8d5)]+_0x19351c(0x68c)+_0x427562[_0x19351c(0x697)]+_0x19351c(0x9fa)+_0x427562[_0x19351c(0x278)]+_0x19351c(0xb1d)+_0x10ee1b+'”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20'+_0x3a6525+'\x0a\x20\x20\x20\x20'+_0x57b813+_0x19351c(0x69b)+_0x392121+_0x19351c(0xb7c)+_0x3a8c75+'\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20'+(_0x427562['settings'][_0x19351c(0xe6d)]&&_0x427562[_0x19351c(0x761)][_0x19351c(0xe6d)][_0x19351c(0x594)]>0x0?_0x427562['settings']['aiAvatarLibrary'][_0x19351c(0x796)](_0x343edb=>'-\x20'+_0x343edb[_0x19351c(0x278)])[_0x19351c(0xa4b)]('\x0a'):_0x19351c(0x3a7))+_0x19351c(0x6fa)+(_0x427562['settings'][_0x19351c(0xdc3)]&&_0x427562[_0x19351c(0x761)][_0x19351c(0xdc3)][_0x19351c(0x594)]>0x0?_0x427562['settings']['myAvatarLibrary'][_0x19351c(0x796)](_0x34eea5=>'-\x20'+_0x34eea5[_0x19351c(0x278)])['join']('\x0a'):'-\x20(空)')+_0x19351c(0x546)+_0x427562[_0x19351c(0x761)][_0x19351c(0x10c5)]+_0x19351c(0x8b5),_0x3760dd=_0x41a5a1['map'](_0x5e3c8c=>({'role':_0x5e3c8c[_0x19351c(0xba4)],'content':String(_0x5e3c8c[_0x19351c(0x9a5)])}));_0x3760dd['push']({'role':_0x19351c(0x21c),'content':_0x19351c(0x1252)});let _0x4ede96=_0x5d472b===GEMINI_API_URL,_0x1ac175=_0x4a90fe(_0x1af062,_0x4bb6e5,_0x49c910,_0x3760dd);const _0x5ef201=_0x4ede96?await fetch(_0x1ac175[_0x19351c(0x10ac)],_0x1ac175[_0x19351c(0x1cc)]):await fetch(_0x5d472b+_0x19351c(0x8fd),{'method':_0x19351c(0x1128),'headers':{'Content-Type':_0x19351c(0x35c),'Authorization':'Bearer\x20'+_0x4bb6e5},'body':JSON[_0x19351c(0x313)]({'model':_0x1af062,'messages':[{'role':_0x19351c(0xf72),'content':_0x49c910},..._0x3760dd],'temperature':_0x5de8b7[_0x19351c(0x2df)]['apiTemperature']||0.8})});if(!_0x5ef201['ok']){const _0x59cfbd=await _0x5ef201[_0x19351c(0xd7b)]();throw new Error(_0x19351c(0xf8b)+_0x59cfbd[_0x19351c(0x1c1)][_0x19351c(0x4bc)]);}const _0x2d7489=await _0x5ef201['json'](),_0x24d821=getGeminiResponseText(_0x2d7489),_0x1f65b6=_0x30c9b6(_0x24d821),_0x1bb52c=[];for(const _0x3e0796 of _0x1f65b6){if(_0x3e0796[_0x19351c(0xa20)]==='text'&&typeof _0x3e0796[_0x19351c(0x9a5)]===_0x19351c(0x10d7)&&_0x3e0796[_0x19351c(0x9a5)][_0x19351c(0x3ad)]('\x0a')){const _0x12d577=_0x3e0796[_0x19351c(0x9a5)][_0x19351c(0x65b)](/\n+/)['filter'](_0x460c18=>_0x460c18[_0x19351c(0xeb7)]());_0x12d577[_0x19351c(0x494)](_0x5a4d16=>{const _0x135275=_0x19351c;_0x1bb52c[_0x135275(0xf5)]({..._0x3e0796,'content':_0x5a4d16});});}else _0x1bb52c[_0x19351c(0xf5)](_0x3e0796);}let _0x2fddab=Date['now']();for(const _0x51e7fd of _0x1bb52c){const _0x4c678d={'role':_0x19351c(0x1119),'senderName':_0x427562[_0x19351c(0x697)],'timestamp':_0x2fddab++,'content':_0x51e7fd[_0x19351c(0x9a5)]||_0x51e7fd[_0x19351c(0x4bc)],'type':_0x51e7fd['type']||_0x19351c(0x1197)};if(_0x51e7fd[_0x19351c(0xa20)]===_0x19351c(0x98f)){if(!_0x427562[_0x19351c(0x1244)]){if(_0x51e7fd[_0x19351c(0x114d)])_0x427562[_0x19351c(0x535)]=String(_0x51e7fd[_0x19351c(0x114d)]);if(_0x51e7fd[_0x19351c(0xc2c)])_0x427562[_0x19351c(0x267)]=String(_0x51e7fd[_0x19351c(0xc2c)]);}continue;}_0x427562['history']['push'](_0x4c678d),_0x3b5153(_0x4c678d,_0x427562),await new Promise(_0x503921=>setTimeout(_0x503921,Math[_0x19351c(0x36d)]()*0x3e8+0x320));}await _0x2e83f8['chats'][_0x19351c(0xe3c)](_0x427562),_0x5ee219();}catch(_0xb06aa4){console[_0x19351c(0x1c1)](_0x19351c(0xf30),_0xb06aa4),await _0x2fb06('操作失败',_0x19351c(0xa8c)+_0xb06aa4[_0x19351c(0x4bc)]);}finally{_0x153b71(_0x427562['id'],![]);if(!_0x427562[_0x19351c(0x1244)]&&document[_0x19351c(0x11e3)](_0x19351c(0x1205))){const _0x1a5cc9=document[_0x19351c(0x11e3)](_0x19351c(0x1205));_0x1a5cc9[_0x19351c(0x794)][_0x19351c(0x12fa)]=0x0,setTimeout(()=>{const _0x4b3553=_0x19351c;_0x1a5cc9[_0x4b3553(0x300)]=_0x427562[_0x4b3553(0x278)],_0x1a5cc9['classList'][_0x4b3553(0x957)](_0x4b3553(0x680)),_0x1a5cc9[_0x4b3553(0x794)][_0x4b3553(0x12fa)]=0x1;},0xc8);}}}function _0x387f1d(){const _0x5dbc4e=_0x241b18,_0x27103d=document[_0x5dbc4e(0x11e3)](_0x5dbc4e(0x9a3)),_0x215e26=_0x5de8b7[_0x5dbc4e(0x2df)][_0x5dbc4e(0x688)]||_0x2694ad;_0x215e26&&_0x215e26['trim']()&&(_0x27103d[_0x5dbc4e(0xf0a)]=_0x215e26,_0x27103d[_0x5dbc4e(0x7d1)]()[_0x5dbc4e(0x100)](_0x3fff23=>console['log'](_0x5dbc4e(0xba6),_0x3fff23)));}function _0xecbef(){const _0x71e54a=_0x241b18;if(!_0x5de8b7[_0x71e54a(0x2df)][_0x71e54a(0x532)])return;for(const _0x246634 in _0x5de8b7[_0x71e54a(0x2df)][_0x71e54a(0x532)]){const _0x48e3bc=document[_0x71e54a(0x11e3)](_0x246634),_0x2f7f6b=_0x5de8b7[_0x71e54a(0x2df)][_0x71e54a(0x532)][_0x246634];_0x48e3bc&&(_0x48e3bc[_0x71e54a(0xc81)]==='IMG'?_0x48e3bc[_0x71e54a(0xf0a)]=_0x2f7f6b:_0x48e3bc[_0x71e54a(0x300)]=_0x2f7f6b);}}function _0x3b69be(){return new Promise(_0x4e7080=>{const _0x413e58=_0x10a9,_0x2c5a43=document['createElement'](_0x413e58(0x6be));_0x2c5a43['type']='file',_0x2c5a43[_0x413e58(0x730)]='image/*',_0x2c5a43['onchange']=_0x27715e=>{const _0x1d3cee=_0x413e58,_0x187985=_0x27715e[_0x1d3cee(0xd7c)]['files'][0x0];if(_0x187985){const _0x5e8186=new FileReader();_0x5e8186[_0x1d3cee(0x1e5)]=_0x2fc178=>{const _0xad6f3c=_0x1d3cee;_0x4e7080(_0x2fc178[_0xad6f3c(0xd7c)]['result']);},_0x5e8186['readAsDataURL'](_0x187985);}else _0x4e7080(null);},_0x2c5a43[_0x413e58(0x1041)]();});}async function _0x1df97a(_0x33aed2){const _0x277c13=_0x241b18,_0x3cd6c2=_0x33aed2['id'],_0xa315c2=_0x33aed2['textContent'],_0x24bf1c=await _0x231a5a('修改文字',_0x277c13(0xb87),_0xa315c2);if(_0x24bf1c!==null&&_0x24bf1c[_0x277c13(0xeb7)]()!==''){const _0x585e0c=_0x24bf1c[_0x277c13(0xeb7)]();_0x33aed2[_0x277c13(0x300)]=_0x585e0c,_0x5de8b7[_0x277c13(0x2df)][_0x277c13(0x532)][_0x3cd6c2]=_0x585e0c,await _0x2e83f8[_0x277c13(0x2df)][_0x277c13(0xe3c)](_0x5de8b7['globalSettings']),alert(_0x277c13(0x598));}}async function _0x4939d5(_0x12acc4){const _0x4a539f=_0x241b18,_0x9c7dca=_0x12acc4['id'],_0xdaa49e=await _0x16a8e1(_0x4a539f(0xed8),[{'text':_0x4a539f(0xe72),'value':_0x4a539f(0xd1b)},{'text':_0x4a539f(0x111b),'value':_0x4a539f(0x10ac)}]);let _0x40cf6a=null;if(_0xdaa49e===_0x4a539f(0xd1b))_0x40cf6a=await _0x3b69be();else _0xdaa49e===_0x4a539f(0x10ac)&&(_0x40cf6a=await _0x231a5a(_0x4a539f(0xed8),'请输入新的图片URL：',_0x12acc4[_0x4a539f(0xf0a)],_0x4a539f(0x10ac)));if(_0x40cf6a&&_0x40cf6a[_0x4a539f(0xeb7)]()){const _0x40fdbd=_0x40cf6a[_0x4a539f(0xeb7)]();_0x12acc4[_0x4a539f(0xf0a)]=_0x40fdbd,_0x5de8b7[_0x4a539f(0x2df)][_0x4a539f(0x532)][_0x9c7dca]=_0x40fdbd,await _0x2e83f8[_0x4a539f(0x2df)][_0x4a539f(0xe3c)](_0x5de8b7['globalSettings']),alert(_0x4a539f(0x56c));}else _0xdaa49e===_0x4a539f(0x10ac)&&_0x40cf6a!==null&&alert(_0x4a539f(0x1221));}const _0x61bd5d={'getSongCache'(_0x48d9be,_0x3ac57d){const _0xf1213c=_0x241b18,_0x2452e5=(_0x3ac57d||_0xf1213c(0xd4a))+':'+_0x48d9be;if(_0x5de8b7['cache']&&_0x5de8b7[_0xf1213c(0x5a3)][_0xf1213c(0x890)]){const _0x100c96=_0x5de8b7[_0xf1213c(0x5a3)][_0xf1213c(0x890)][_0xf1213c(0x1289)](_0x2452e5);if(_0x100c96&&Date[_0xf1213c(0x1182)]()-_0x100c96[_0xf1213c(0x702)]<0x36ee80)return _0x100c96['data'];}return null;},'setSongCache'(_0x298c5f,_0x1fb926,_0x16ae2c){const _0xf6b625=_0x241b18,_0x3f53b0=(_0x16ae2c||_0xf6b625(0xd4a))+':'+_0x298c5f;if(!_0x5de8b7['cache'])_0x5de8b7[_0xf6b625(0x5a3)]={};if(!_0x5de8b7[_0xf6b625(0x5a3)][_0xf6b625(0x890)])_0x5de8b7[_0xf6b625(0x5a3)]['songs']=new Map();_0x5de8b7[_0xf6b625(0x5a3)][_0xf6b625(0x890)][_0xf6b625(0xb25)](_0x3f53b0,{'data':_0x1fb926,'timestamp':Date[_0xf6b625(0x1182)]()});}};typeof Http_Get_External==='undefined'&&(window[_0x241b18(0x1259)]=function(_0x2f0923){return new Promise(_0x537191=>{const _0x2b725a=_0x10a9;fetch(_0x2f0923)[_0x2b725a(0x5de)](_0x572977=>_0x572977[_0x2b725a(0xd7b)]()[_0x2b725a(0x100)](()=>_0x572977[_0x2b725a(0x1197)]()))['then'](_0x537191)['catch'](()=>_0x537191(null));});});async function _0x3540c4(_0x913955){return await Http_Get_External(_0x913955);}function _0x261917(_0x44ddee){return new Promise(_0x3c7385=>{const _0x504567=_0x10a9,_0x5c93a6=new Audio();_0x5c93a6[_0x504567(0x4b8)](_0x504567(0x6b8),()=>_0x3c7385(!![]),{'once':!![]}),_0x5c93a6[_0x504567(0x4b8)]('error',()=>_0x3c7385(![]),{'once':!![]}),_0x5c93a6[_0x504567(0xf0a)]=_0x44ddee;});}async function _0xfb33a3(_0x17bffd,_0x28e481){const _0x4905ac=_0x241b18;try{let _0x3fbf62=_0x17bffd[_0x4905ac(0x1018)](/\s/g,'');_0x28e481&&(_0x3fbf62+='\x20'+_0x28e481[_0x4905ac(0x1018)](/\s/g,''));const _0x52443d=_0x4905ac(0x5c6)+encodeURIComponent(_0x3fbf62);console[_0x4905ac(0x84b)]('正在请求网易云音乐API:',_0x52443d);const _0x372c6a=await fetch(_0x52443d);if(!_0x372c6a['ok'])throw new Error('API\x20请求失败，状态码:\x20'+_0x372c6a[_0x4905ac(0x739)]);const _0x9f40d6=await _0x372c6a[_0x4905ac(0xd7b)]();if(_0x9f40d6[_0x4905ac(0xda9)]!==0xc8||!_0x9f40d6['data']||_0x9f40d6[_0x4905ac(0x1cc)][_0x4905ac(0x594)]===0x0)return console[_0x4905ac(0x84b)](_0x4905ac(0xbcc),_0x9f40d6),[];return _0x9f40d6[_0x4905ac(0x1cc)][_0x4905ac(0x796)](_0x3dc7d8=>({'name':_0x3dc7d8[_0x4905ac(0x4f8)],'artist':_0x3dc7d8[_0x4905ac(0xfad)],'id':_0x3dc7d8['id'],'cover':_0x3dc7d8[_0x4905ac(0x2ee)]||_0x4905ac(0x57f),'source':_0x4905ac(0xf7)}))[_0x4905ac(0xa6c)](0x0,0x1e);}catch(_0x49dd7d){return console[_0x4905ac(0x1c1)](_0x4905ac(0xcc2),_0x49dd7d),[];}}async function _0x2f18e9(_0x41b659){const _0x4f586d=_0x241b18;try{_0x41b659=_0x41b659[_0x4f586d(0x1018)](/\s/g,'');const _0x5c5cfa=await _0x3540c4(_0x4f586d(0x3da)+encodeURIComponent(_0x41b659));if(!_0x5c5cfa?.[_0x4f586d(0x1cc)]?.[_0x4f586d(0x594)])return[];return _0x5c5cfa[_0x4f586d(0x1cc)]['map'](_0x37b432=>({'name':_0x37b432[_0x4f586d(0x4f8)],'artist':_0x37b432[_0x4f586d(0xfad)],'id':_0x37b432['id'],'cover':_0x37b432['cover']||_0x4f586d(0xe71),'source':_0x4f586d(0x10c9)}))[_0x4f586d(0xa6c)](0x0,0x1e);}catch(_0x440dc7){return console[_0x4f586d(0x1c1)](_0x4f586d(0x6a2),_0x440dc7),[];}}async function _0x5c01db(){const _0x14b70d=_0x241b18,_0x5229de=await _0x231a5a(_0x14b70d(0xbee),_0x14b70d(0xa70));if(!_0x5229de||!_0x5229de[_0x14b70d(0xeb7)]())return;await _0x2fb06(_0x14b70d(0x63d),_0x14b70d(0xc83));let _0xf5e0c1=_0x5229de['trim'](),_0x810988='';if(_0x5229de[_0x14b70d(0x3ad)]('-')||_0x5229de[_0x14b70d(0x3ad)]('–')){const _0x54a3d4=_0x5229de[_0x14b70d(0x65b)](/[-–]/);_0xf5e0c1=_0x54a3d4[0x0][_0x14b70d(0xeb7)](),_0x810988=_0x54a3d4[_0x14b70d(0xa6c)](0x1)[_0x14b70d(0xa4b)]('\x20')[_0x14b70d(0xeb7)]();}const [_0x4e0b4c,_0x2d26d4]=await Promise[_0x14b70d(0xd4a)]([_0xfb33a3(_0xf5e0c1,_0x810988),_0x2f18e9(_0xf5e0c1)]),_0x25a658=[..._0x4e0b4c,..._0x2d26d4];if(_0x25a658[_0x14b70d(0x594)]===0x0){await _0x2fb06('无结果',_0x14b70d(0x992));return;}const _0x5ad8d9=document[_0x14b70d(0x11e3)]('music-search-results-modal'),_0x2f9ad6=document['getElementById'](_0x14b70d(0xf93));_0x2f9ad6[_0x14b70d(0x595)]='',document[_0x14b70d(0x11e3)](_0x14b70d(0x880))[_0x14b70d(0x3e4)]=![],_0x25a658['forEach'](_0x55b37a=>{const _0x5821e8=_0x14b70d,_0x278467=document[_0x5821e8(0x383)](_0x5821e8(0x1285));_0x278467[_0x5821e8(0x3db)]=_0x5821e8(0xfe7),_0x278467[_0x5821e8(0xaca)][_0x5821e8(0x9eb)]=JSON[_0x5821e8(0x313)](_0x55b37a),_0x278467[_0x5821e8(0x595)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x55b37a[_0x5821e8(0x278)]+_0x5821e8(0x636)+_0x55b37a[_0x5821e8(0xb9f)]+_0x5821e8(0x12cd)+(_0x55b37a['source']===_0x5821e8(0xf7)?_0x5821e8(0x1298):_0x5821e8(0x265))+_0x5821e8(0xe42),_0x2f9ad6['appendChild'](_0x278467);}),_0x5ad8d9['classList'][_0x14b70d(0x252)](_0x14b70d(0x250));}async function _0x1e525d(_0x235cc5){const _0x274c7f=_0x241b18;let _0x2bd665=null,_0xf02be=_0x235cc5[_0x274c7f(0x1275)];const _0xbe1af2=_0x235cc5[_0x274c7f(0x1275)]==='netease'?_0x274c7f(0xfd5)+_0x235cc5['id']:_0x274c7f(0x1164)+_0x235cc5['id'];let _0x55247f=await _0x3540c4(_0xbe1af2);_0x55247f?.['data']?.[_0x274c7f(0x10ac)]&&(_0x2bd665={'url':_0x55247f[_0x274c7f(0x1cc)][_0x274c7f(0x10ac)],'id':_0x235cc5['id'],'source':_0x235cc5[_0x274c7f(0x1275)]});if(!_0x2bd665){const _0x5abc9b=_0x235cc5[_0x274c7f(0x1275)]===_0x274c7f(0xf7)?_0x274c7f(0x10c9):_0x274c7f(0xf7),_0x9aa254=_0x5abc9b===_0x274c7f(0x10c9)?await _0x2f18e9(_0x235cc5['name']):await _0xfb33a3(_0x235cc5[_0x274c7f(0x278)],_0x235cc5[_0x274c7f(0xb9f)]);if(_0x9aa254[_0x274c7f(0x594)]>0x0){const _0x4c44e7=_0x5abc9b===_0x274c7f(0xf7)?_0x274c7f(0xfd5)+_0x9aa254[0x0]['id']:'https://api.vkeys.cn/v2/music/tencent?id='+_0x9aa254[0x0]['id'],_0xbe327e=await _0x3540c4(_0x4c44e7);_0xbe327e?.[_0x274c7f(0x1cc)]?.[_0x274c7f(0x10ac)]&&(_0x2bd665={'url':_0xbe327e[_0x274c7f(0x1cc)][_0x274c7f(0x10ac)],'id':_0x9aa254[0x0]['id'],'source':_0x5abc9b},_0xf02be=_0x5abc9b);}}if(_0x2bd665){_0x2bd665['url']&&typeof _0x2bd665[_0x274c7f(0x10ac)]===_0x274c7f(0x10d7)&&(_0x2bd665[_0x274c7f(0x10ac)]=_0x2bd665[_0x274c7f(0x10ac)][_0x274c7f(0x1018)](/^http:\/\//i,'https://'));_0x235cc5[_0x274c7f(0x2ee)]&&typeof _0x235cc5[_0x274c7f(0x2ee)]==='string'&&(_0x235cc5[_0x274c7f(0x2ee)]=_0x235cc5['cover'][_0x274c7f(0x1018)](/^http:\/\//i,'https://'));const _0xe88bea=await _0x3b8e40(_0x2bd665['id'],_0xf02be)||'';return{'name':_0x235cc5[_0x274c7f(0x278)],'artist':_0x235cc5[_0x274c7f(0xb9f)],'src':_0x2bd665[_0x274c7f(0x10ac)],'cover':_0x235cc5[_0x274c7f(0x2ee)],'isLocal':![],'lrcContent':_0xe88bea};}return null;}async function _0x3b8e40(_0x515f66,_0x5cec66){const _0x1785ab=_0x241b18,_0xc049a8=_0x5cec66==='netease'?_0x1785ab(0x398)+_0x515f66:'https://api.vkeys.cn/v2/music/tencent/lyric?id='+_0x515f66,_0x28cb9c=await _0x3540c4(_0xc049a8);if(_0x28cb9c?.[_0x1785ab(0x1cc)]){const _0x26162b=_0x28cb9c[_0x1785ab(0x1cc)][_0x1785ab(0xd88)]||_0x28cb9c[_0x1785ab(0x1cc)][_0x1785ab(0xc27)]||'',_0x55c5e9=_0x28cb9c[_0x1785ab(0x1cc)][_0x1785ab(0xe30)]||_0x28cb9c[_0x1785ab(0x1cc)][_0x1785ab(0x1a4)]||'';return _0x26162b+'\x0a'+_0x55c5e9;}return'';}async function _0x2992b4(_0x55ff92){const _0x2512b7=_0x241b18;if(_0x55ff92<0x0||_0x55ff92>=_0xb57b5b['playlist'][_0x2512b7(0x594)])return;const _0x2842fb=await _0x16a8e1(_0x2512b7(0x1265),[{'text':_0x2512b7(0x11d2),'value':_0x2512b7(0x373)},{'text':'📋\x20直接粘贴歌词文本','value':_0x2512b7(0x90f)}]);let _0x4176fe=null;if(_0x2842fb===_0x2512b7(0x373))_0x4176fe=await new Promise(_0x26e794=>{const _0x19022d=_0x2512b7,_0x26cf35=document[_0x19022d(0x11e3)](_0x19022d(0x895)),_0x5e6296=_0x3d44d9=>{const _0xa502bb=_0x19022d,_0x2efcad=_0x3d44d9['target'][_0xa502bb(0x5c9)][0x0];if(_0x2efcad){const _0x3d134d=new FileReader();_0x3d134d['onload']=_0x2a7a02=>_0x26e794(_0x2a7a02[_0xa502bb(0xd7c)][_0xa502bb(0x255)]),_0x3d134d['onerror']=()=>_0x26e794(null),_0x3d134d[_0xa502bb(0x1011)](_0x2efcad);}else _0x26e794(null);_0x26cf35[_0xa502bb(0xd7a)](_0xa502bb(0xfeb),_0x5e6296),_0x26cf35[_0xa502bb(0xf27)]='';};_0x26cf35[_0x19022d(0x4b8)](_0x19022d(0xfeb),_0x5e6296,{'once':!![]}),_0x26cf35[_0x19022d(0x1041)]();});else{if(_0x2842fb===_0x2512b7(0x90f)){const _0x44dd6e=await _0x231a5a(_0x2512b7(0x59e),_0x2512b7(0x1125),'','textarea');if(_0x44dd6e)_0x4176fe=_0x44dd6e[_0x2512b7(0x1018)](/\[/g,'\x0a[')['trim']();}}_0x4176fe!==null&&(_0xb57b5b[_0x2512b7(0xcba)][_0x55ff92][_0x2512b7(0x1240)]=_0x4176fe,await _0x539eb1(),_0xb57b5b['currentIndex']===_0x55ff92&&(_0xb57b5b['parsedLyrics']=_0x2a2377(_0x4176fe),_0x45cb2c(),_0x15ee6e()),await _0x2fb06('成功','《'+_0xb57b5b[_0x2512b7(0xcba)][_0x55ff92]['name']+_0x2512b7(0xb4c)));}async function _0x4d86e9(){const _0x266960=_0x241b18;if(_0xb57b5b['currentIndex']===-0x1)return;const _0x3fb3e9=_0xb57b5b[_0x266960(0xcba)][_0xb57b5b['currentIndex']];if(!_0x3fb3e9)return;_0x3fb3e9[_0x266960(0xa06)]=!_0x3fb3e9[_0x266960(0xa06)],await _0x539eb1();const _0x5888d6=document[_0x266960(0x5ac)](_0x266960(0x3ce)),_0x2c2a0a=document[_0x266960(0x11e3)](_0x266960(0x967));_0x5888d6[_0x266960(0x505)][_0x266960(0xe7e)](_0x266960(0x9a6),_0x3fb3e9[_0x266960(0xa06)]),_0x2c2a0a[_0x266960(0x505)][_0x266960(0xe7e)](_0x266960(0x1fc),_0x3fb3e9['isBgClear']);}function _0x2114fa(){const _0x5a29c7=_0x241b18,_0x3fd06b=document[_0x5a29c7(0x11e3)](_0x5a29c7(0x3d1)),_0x210c92=document[_0x5a29c7(0x11e3)](_0x5a29c7(0xe95));_0x3fd06b&&_0x210c92&&(_0x3fd06b[_0x5a29c7(0x505)][_0x5a29c7(0xe7e)](_0x5a29c7(0x250)),_0x210c92[_0x5a29c7(0x505)][_0x5a29c7(0xe7e)]('active'));}function _0x1d004b(){const _0x3a9861=_0x241b18,_0x556515=document[_0x3a9861(0x5ac)](_0x3a9861(0x3ce)),_0x236e66=document[_0x3a9861(0x11e3)]('music-player-overlay');_0x556515&&_0x236e66&&(_0x556515[_0x3a9861(0x505)]['toggle'](_0x3a9861(0x4c4)),_0x236e66['classList'][_0x3a9861(0xe7e)](_0x3a9861(0xad3)));}window[_0x241b18(0x832)]=_0x1d004b;async function _0x3333de(){const _0x2f2cc8=_0x241b18;if(_0xb57b5b[_0x2f2cc8(0xcba)][_0x2f2cc8(0x594)]===0x0){alert(_0x2f2cc8(0x11d6));return;}const _0x50b657=await _0x58fd60(_0x2f2cc8(0x124a),_0x2f2cc8(0x9f2),{'confirmText':_0x2f2cc8(0xf6a)});if(!_0x50b657)return;await _0x2fb06(_0x2f2cc8(0x63d),'正在检查\x20'+_0xb57b5b[_0x2f2cc8(0xcba)][_0x2f2cc8(0x594)]+'\x20首歌曲，这可能需要一些时间...');const _0x1ee38d=_0xb57b5b[_0x2f2cc8(0xcba)][_0x2f2cc8(0x594)],_0x42479f=[],_0x47e5ae=[],_0x380b91=_0xb57b5b[_0x2f2cc8(0xcba)][_0x2f2cc8(0x796)](async _0x3fd998=>{const _0x5e2ed4=_0x2f2cc8;if(_0x3fd998[_0x5e2ed4(0x101e)]){_0x42479f['push'](_0x3fd998);return;}const _0x44dcf0=await _0x261917(_0x3fd998[_0x5e2ed4(0xf0a)]);_0x44dcf0?_0x42479f[_0x5e2ed4(0xf5)](_0x3fd998):(_0x47e5ae[_0x5e2ed4(0xf5)](_0x3fd998[_0x5e2ed4(0x278)]),console['warn']('无效链接:\x20'+_0x3fd998[_0x5e2ed4(0x278)]+'\x20-\x20'+_0x3fd998[_0x5e2ed4(0xf0a)]));});await Promise[_0x2f2cc8(0xd4a)](_0x380b91);const _0x482508=_0x1ee38d-_0x42479f[_0x2f2cc8(0x594)];if(_0x482508>0x0){const _0x90ea97=_0xb57b5b[_0x2f2cc8(0xcba)][_0xb57b5b[_0x2f2cc8(0x12b5)]],_0xe355ca=_0x47e5ae[_0x2f2cc8(0x3ad)](_0x90ea97?.[_0x2f2cc8(0x278)]);_0xb57b5b['playlist']=_0x42479f,await _0x539eb1();if(_0xe355ca)_0x7cf0d1[_0x2f2cc8(0x9b1)](),_0x7cf0d1[_0x2f2cc8(0xf0a)]='',_0xb57b5b[_0x2f2cc8(0x12b5)]=_0xb57b5b[_0x2f2cc8(0xcba)][_0x2f2cc8(0x594)]>0x0?0x0:-0x1,_0xb57b5b['isPlaying']=![];else _0x90ea97&&(_0xb57b5b[_0x2f2cc8(0x12b5)]=_0xb57b5b[_0x2f2cc8(0xcba)][_0x2f2cc8(0x901)](_0x202f0e=>_0x202f0e['src']===_0x90ea97[_0x2f2cc8(0xf0a)]));_0x31e1af(),_0x359e1c(),await _0x2fb06(_0x2f2cc8(0xb3e),_0x2f2cc8(0xc39)+_0x482508+_0x2f2cc8(0x743)+_0x47e5ae[_0x2f2cc8(0xa4b)](_0x2f2cc8(0x633)));}else await _0x2fb06(_0x2f2cc8(0xe31),'所有歌曲链接均有效，无需清理！');}function _0x2d3a77(){const _0x22adcc=_0x241b18,_0x43ab8c=document[_0x22adcc(0x11e3)](_0x22adcc(0x1e6));_0x43ab8c[_0x22adcc(0x505)][_0x22adcc(0xe7e)](_0x22adcc(0x3f5),!!_0x5de8b7['globalSettings'][_0x22adcc(0x7b1)]);}async function _0x497360(){const _0x370841=_0x241b18,_0x29da82=document[_0x370841(0x11e3)](_0x370841(0x66d)),_0x2be22b=document[_0x370841(0x11e3)]('clear-posts-list');_0x2be22b[_0x370841(0x595)]='';const _0x2266f0=[];_0x2266f0[_0x370841(0xf5)]({'text':_0x370841(0x484),'value':_0x370841(0xd4a),'isDanger':!![]});const _0x463ea0=_0x5de8b7['qzoneSettings'][_0x370841(0xa33)]||'我';_0x2266f0[_0x370841(0xf5)]({'text':_0x370841(0x877)+_0x463ea0+_0x370841(0xe24),'value':_0x370841(0x21c)}),Object[_0x370841(0x4ca)](_0x5de8b7[_0x370841(0x737)])['forEach'](_0x55b3a6=>{const _0x106114=_0x370841;!_0x55b3a6[_0x106114(0x1244)]&&_0x2266f0[_0x106114(0xf5)]({'text':_0x106114(0x877)+_0x55b3a6[_0x106114(0x278)]+_0x106114(0x7b2),'value':_0x55b3a6['id']});});try{const _0x733cf9=await _0x2e83f8[_0x370841(0xf00)]['toArray']();_0x733cf9['length']>0x0&&(_0x2266f0['push']({'isSeparator':!![],'text':'NPC\x20列表'}),_0x733cf9['forEach'](_0x513e9b=>{const _0x20af0c=_0x370841;_0x2266f0[_0x20af0c(0xf5)]({'text':_0x20af0c(0x877)+_0x513e9b[_0x20af0c(0x278)]+_0x20af0c(0xc6d),'value':_0x20af0c(0x8b8)+_0x513e9b['id']});}));}catch(_0x3b06eb){console[_0x370841(0x1c1)]('加载NPC列表失败:',_0x3b06eb);}_0x2266f0['forEach'](_0x245e7a=>{const _0x4a8eaa=_0x370841;if(_0x245e7a[_0x4a8eaa(0xa66)]){const _0x3e8b87=document[_0x4a8eaa(0x383)](_0x4a8eaa(0x1285));_0x3e8b87[_0x4a8eaa(0x300)]=_0x245e7a[_0x4a8eaa(0x1197)],_0x3e8b87[_0x4a8eaa(0x794)][_0x4a8eaa(0xfb7)]=_0x4a8eaa(0x4f3),_0x2be22b[_0x4a8eaa(0x120c)](_0x3e8b87);return;}const _0xe0e5b7=document[_0x4a8eaa(0x383)](_0x4a8eaa(0x1285));_0xe0e5b7['className']=_0x4a8eaa(0x1142),_0x245e7a[_0x4a8eaa(0x2ef)]&&_0xe0e5b7[_0x4a8eaa(0x505)][_0x4a8eaa(0x252)](_0x4a8eaa(0x72d)),_0xe0e5b7['dataset'][_0x4a8eaa(0x994)]=_0x245e7a[_0x4a8eaa(0xf27)],_0xe0e5b7[_0x4a8eaa(0x595)]=_0x4a8eaa(0x620)+_0x245e7a['text']+_0x4a8eaa(0x8e8),_0x2be22b[_0x4a8eaa(0x120c)](_0xe0e5b7);}),_0x29da82['classList'][_0x370841(0x252)](_0x370841(0x250));}async function _0x469f32(){const _0x43b8f2=_0x241b18,_0x205ad0=document[_0x43b8f2(0x10d6)]('#clear-posts-list\x20.clear-posts-item.selected');if(_0x205ad0['length']===0x0){alert(_0x43b8f2(0xc2f));return;}const _0xf5b954=Array[_0x43b8f2(0xee2)](_0x205ad0)['map'](_0x5160a5=>_0x5160a5[_0x43b8f2(0xaca)][_0x43b8f2(0x994)]);let _0x83bbe6=[];_0xf5b954[_0x43b8f2(0x3ad)](_0x43b8f2(0xd4a))?_0x83bbe6[_0x43b8f2(0xf5)](_0x43b8f2(0x12d9)):(_0xf5b954[_0x43b8f2(0x3ad)]('user')&&_0x83bbe6[_0x43b8f2(0xf5)]('“'+_0x5de8b7[_0x43b8f2(0x1c5)][_0x43b8f2(0xa33)]+'”'),_0xf5b954[_0x43b8f2(0x494)](_0x38842c=>{const _0x3921c3=_0x43b8f2,_0x3b45d1=_0x5de8b7[_0x3921c3(0x737)][_0x38842c];_0x3b45d1&&_0x83bbe6[_0x3921c3(0xf5)]('“'+_0x3b45d1[_0x3921c3(0x278)]+'”');}));const _0x5c7661='此操作将永久删除\x20'+_0x83bbe6['join']('、\x20')+'\x20的所有动态，且无法恢复！',_0x52d5fa=await _0x58fd60(_0x43b8f2(0x189),_0x5c7661,{'confirmButtonClass':_0x43b8f2(0x8a6),'confirmText':'确认清空'});if(!_0x52d5fa)return;try{_0xf5b954[_0x43b8f2(0x3ad)](_0x43b8f2(0xd4a))?await _0x2e83f8[_0x43b8f2(0x1218)][_0x43b8f2(0x7ab)]():await _0x2e83f8[_0x43b8f2(0x1218)][_0x43b8f2(0x129e)](_0x43b8f2(0x5d9))[_0x43b8f2(0x1209)](_0xf5b954)[_0x43b8f2(0xc0c)](),_0x2814a8=await _0x2e83f8[_0x43b8f2(0x1218)][_0x43b8f2(0x7c6)](_0x43b8f2(0x702))[_0x43b8f2(0x107)]()[_0x43b8f2(0x508)](),_0x4f3fd1=0x0,await _0xae9c28(),document['getElementById']('clear-posts-modal')[_0x43b8f2(0x505)][_0x43b8f2(0x957)](_0x43b8f2(0x250)),await _0x2fb06(_0x43b8f2(0x1010),_0x43b8f2(0x44c));}catch(_0x13991e){console[_0x43b8f2(0x1c1)](_0x43b8f2(0x908),_0x13991e),await _0x2fb06(_0x43b8f2(0x1177),_0x43b8f2(0xc92)+_0x13991e[_0x43b8f2(0x4bc)]);}}async function _0x3119e6(_0x39ce60){const _0x5c305a=_0x241b18,_0x3a2d1e=await _0x58fd60(_0x5c305a(0x1166),_0x5c305a(0x11a3),{'confirmButtonClass':_0x5c305a(0x8a6),'confirmText':_0x5c305a(0x1166)});if(_0x3a2d1e){const _0x245729=_0x5de8b7['chats'][_0x5de8b7['activeChatId']];if(!_0x245729||!_0x245729[_0x5c305a(0x6d3)])return;const _0x1a3712=_0x245729['thoughtsHistory'][_0x5c305a(0x901)](_0x3365fe=>_0x3365fe[_0x5c305a(0x702)]===_0x39ce60);if(_0x1a3712===-0x1)return;const _0x2a32a6=_0x1a3712===_0x245729[_0x5c305a(0x6d3)][_0x5c305a(0x594)]-0x1;_0x245729['thoughtsHistory']=_0x245729[_0x5c305a(0x6d3)][_0x5c305a(0x138)](_0x144161=>_0x144161[_0x5c305a(0x702)]!==_0x39ce60);if(_0x2a32a6){if(_0x245729['thoughtsHistory'][_0x5c305a(0x594)]>0x0){const _0x1d3d13=_0x245729[_0x5c305a(0x6d3)][_0x245729['thoughtsHistory'][_0x5c305a(0x594)]-0x1];_0x245729[_0x5c305a(0x535)]=_0x1d3d13[_0x5c305a(0x535)],_0x245729['randomJottings']=_0x1d3d13[_0x5c305a(0x267)];const _0xe40ab8=document[_0x5c305a(0x11e3)](_0x5c305a(0x69d)),_0x5b183e=document[_0x5c305a(0x11e3)](_0x5c305a(0xa90));if(_0xe40ab8)_0xe40ab8[_0x5c305a(0x300)]=_0x245729['heartfeltVoice'];if(_0x5b183e)_0x5b183e['textContent']=_0x245729['randomJottings'];console['log'](_0x5c305a(0x3c3));}else{_0x245729[_0x5c305a(0x535)]=_0x5c305a(0x6cb),_0x245729[_0x5c305a(0x267)]='...';const _0x3f8313=document[_0x5c305a(0x11e3)](_0x5c305a(0x69d)),_0x237837=document[_0x5c305a(0x11e3)](_0x5c305a(0xa90));if(_0x3f8313)_0x3f8313['textContent']=_0x245729[_0x5c305a(0x535)];if(_0x237837)_0x237837[_0x5c305a(0x300)]=_0x245729[_0x5c305a(0x267)];console[_0x5c305a(0x84b)]('已删除最后一条心声，当前心声已重置。');}}await _0x2e83f8[_0x5c305a(0x737)][_0x5c305a(0xe3c)](_0x245729),_0x808c9e(),await _0x2fb06('成功',_0x5c305a(0xb2d));}}document['getElementById'](_0x241b18(0x92c))[_0x241b18(0x4b8)](_0x241b18(0x1041),_0x3ad821=>{const _0x1a52eb=_0x241b18,_0x57d516=_0x3ad821[_0x1a52eb(0xd7c)][_0x1a52eb(0xfe1)](_0x1a52eb(0x239));if(_0x57d516){const _0x310eb1=parseInt(_0x57d516['dataset'][_0x1a52eb(0x702)]);!isNaN(_0x310eb1)&&_0x3119e6(_0x310eb1);}});async function _0x9e05fe(){const _0x318558=_0x241b18,_0x2baa61=document[_0x318558(0x11e3)](_0x318558(0x793));_0x2baa61['innerHTML']=_0x318558(0x8b0);const _0x556990=await _0x2e83f8[_0x318558(0xa7a)]['where'](_0x318558(0xa20))['equals'](_0x318558(0x482))['toArray']();_0x556990['forEach'](_0x20db4c=>{const _0x404a45=_0x318558,_0x3112a7=document[_0x404a45(0x383)](_0x404a45(0xd91));_0x3112a7[_0x404a45(0xf27)]=_0x20db4c['id'],_0x3112a7[_0x404a45(0x300)]=_0x20db4c[_0x404a45(0x278)],_0x2baa61[_0x404a45(0x120c)](_0x3112a7);});}async function _0x3dfc0b(){const _0xb8730b=_0x241b18,_0x6281ea=document['getElementById'](_0xb8730b(0x793)),_0x10993e=parseInt(_0x6281ea[_0xb8730b(0xf27)]);if(isNaN(_0x10993e))return;const _0x2926d1=await _0x2e83f8[_0xb8730b(0xa7a)][_0xb8730b(0x1289)](_0x10993e);if(_0x2926d1){const _0x20312c=document['getElementById']('global-css-input');_0x20312c[_0xb8730b(0xf27)]=_0x2926d1['value'],_0x1a2892(_0x2926d1[_0xb8730b(0xf27)]);}}async function _0x46b343(){const _0x18ef35=_0x241b18,_0x3fd27e=await _0x231a5a(_0x18ef35(0x8b6),'请输入预设名称');if(!_0x3fd27e||!_0x3fd27e['trim']())return;const _0x4d0927=document[_0x18ef35(0x11e3)](_0x18ef35(0x434))['value'],_0x1909a5=await _0x2e83f8[_0x18ef35(0xa7a)][_0x18ef35(0x129e)]({'name':_0x3fd27e[_0x18ef35(0xeb7)](),'type':_0x18ef35(0x482)})[_0x18ef35(0x12c1)]();if(_0x1909a5){const _0x11d730=await _0x58fd60(_0x18ef35(0xf78),_0x18ef35(0x1ac)+_0x3fd27e[_0x18ef35(0xeb7)]()+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':'btn-danger'});if(!_0x11d730)return;await _0x2e83f8['appearancePresets'][_0x18ef35(0x1225)](_0x1909a5['id'],{'value':_0x4d0927});}else await _0x2e83f8[_0x18ef35(0xa7a)][_0x18ef35(0x252)]({'name':_0x3fd27e[_0x18ef35(0xeb7)](),'type':_0x18ef35(0x482),'value':_0x4d0927});await _0x9e05fe(),alert(_0x18ef35(0x318));}async function _0xdcf18a(){const _0x1406a4=_0x241b18,_0x2f79d4=document['getElementById'](_0x1406a4(0x793)),_0x2a20c8=parseInt(_0x2f79d4['value']);if(isNaN(_0x2a20c8)){alert(_0x1406a4(0x28f));return;}const _0x10ce24=await _0x2e83f8[_0x1406a4(0xa7a)]['get'](_0x2a20c8);if(!_0x10ce24)return;const _0x434c32=await _0x58fd60(_0x1406a4(0x30c),_0x1406a4(0xbf4)+_0x10ce24[_0x1406a4(0x278)]+_0x1406a4(0xbec),{'confirmButtonClass':'btn-danger'});_0x434c32&&(await _0x2e83f8['appearancePresets'][_0x1406a4(0xc0c)](_0x2a20c8),await _0x9e05fe(),alert(_0x1406a4(0x762)));}async function _0xf958bd(){const _0x4558e2=_0x241b18,_0x3095ec=document['getElementById'](_0x4558e2(0xb28));_0x3095ec['innerHTML']=_0x4558e2(0x8b0);const _0x5feb0e=await _0x2e83f8['appearancePresets'][_0x4558e2(0x129e)](_0x4558e2(0xa20))[_0x4558e2(0x119e)]('font')[_0x4558e2(0x508)]();_0x5feb0e['forEach'](_0x428710=>{const _0xa296f2=_0x4558e2,_0x4a10d2=document[_0xa296f2(0x383)](_0xa296f2(0xd91));_0x4a10d2[_0xa296f2(0xf27)]=_0x428710['id'],_0x4a10d2['textContent']=_0x428710[_0xa296f2(0x278)],_0x3095ec['appendChild'](_0x4a10d2);});}async function _0x1fac30(){const _0x559a05=_0x241b18,_0x330023=document[_0x559a05(0x11e3)](_0x559a05(0xb28)),_0x48d1ba=parseInt(_0x330023[_0x559a05(0xf27)]);if(isNaN(_0x48d1ba))return;const _0x45623f=await _0x2e83f8['appearancePresets']['get'](_0x48d1ba);if(_0x45623f){const _0x33e93b=document['getElementById'](_0x559a05(0x5b3));_0x33e93b['value']=_0x45623f['value'],_0x58687c(_0x45623f[_0x559a05(0xf27)],!![]);}}async function _0x3f473c(){const _0x3084ad=_0x241b18,_0x2f774f=await _0x231a5a(_0x3084ad(0xd8b),_0x3084ad(0x112f));if(!_0x2f774f||!_0x2f774f[_0x3084ad(0xeb7)]())return;const _0xefab2d=document[_0x3084ad(0x11e3)](_0x3084ad(0x5b3))['value'][_0x3084ad(0xeb7)]();if(!_0xefab2d){alert(_0x3084ad(0x7da));return;}const _0xe20755=await _0x2e83f8['appearancePresets'][_0x3084ad(0x129e)]({'name':_0x2f774f['trim'](),'type':'font'})['first']();if(_0xe20755){const _0x455fbe=await _0x58fd60(_0x3084ad(0xf78),_0x3084ad(0x1ac)+_0x2f774f[_0x3084ad(0xeb7)]()+_0x3084ad(0x253),{'confirmButtonClass':_0x3084ad(0x8a6)});if(!_0x455fbe)return;await _0x2e83f8[_0x3084ad(0xa7a)][_0x3084ad(0x1225)](_0xe20755['id'],{'value':_0xefab2d});}else await _0x2e83f8[_0x3084ad(0xa7a)][_0x3084ad(0x252)]({'name':_0x2f774f[_0x3084ad(0xeb7)](),'type':_0x3084ad(0x1003),'value':_0xefab2d});await _0xf958bd(),alert(_0x3084ad(0x437));}async function _0x359282(){const _0x541028=_0x241b18,_0x52df3a=document[_0x541028(0x11e3)](_0x541028(0xb28)),_0x4e7a6e=parseInt(_0x52df3a[_0x541028(0xf27)]);if(isNaN(_0x4e7a6e)){alert('请先从下拉框中选择一个要删除的预设。');return;}const _0x9b63da=await _0x2e83f8[_0x541028(0xa7a)][_0x541028(0x1289)](_0x4e7a6e);if(!_0x9b63da)return;const _0xddc494=await _0x58fd60(_0x541028(0x30c),_0x541028(0xbf4)+_0x9b63da[_0x541028(0x278)]+_0x541028(0xbec),{'confirmButtonClass':'btn-danger'});_0xddc494&&(await _0x2e83f8['appearancePresets'][_0x541028(0xc0c)](_0x4e7a6e),await _0xf958bd(),alert(_0x541028(0x762)));}async function _0x502814(){const _0x3a1ee5=_0x241b18,_0x4a9d88=document[_0x3a1ee5(0x11e3)](_0x3a1ee5(0x1102));_0x4a9d88[_0x3a1ee5(0x595)]=_0x3a1ee5(0x8b0);const _0x198af2=await _0x2e83f8['appearancePresets'][_0x3a1ee5(0x129e)]('type')[_0x3a1ee5(0x119e)]('appearance')[_0x3a1ee5(0x508)]();_0x198af2[_0x3a1ee5(0x494)](_0x287e52=>{const _0x176d76=_0x3a1ee5,_0x21e918=document['createElement'](_0x176d76(0xd91));_0x21e918['value']=_0x287e52['id'],_0x21e918['textContent']=_0x287e52['name'],_0x4a9d88[_0x176d76(0x120c)](_0x21e918);});const _0x9df552={'wallpaper':_0x5de8b7[_0x3a1ee5(0x2df)][_0x3a1ee5(0x11d)],'cphoneWallpaper':_0x5de8b7[_0x3a1ee5(0x2df)]['cphoneWallpaper'],'globalChatBackground':_0x5de8b7[_0x3a1ee5(0x2df)][_0x3a1ee5(0x720)],'appIcons':_0x5de8b7['globalSettings'][_0x3a1ee5(0x18b)],'cphoneAppIcons':_0x5de8b7[_0x3a1ee5(0x2df)][_0x3a1ee5(0xfaa)],'chatActionButtonsOrder':_0x5de8b7[_0x3a1ee5(0x2df)][_0x3a1ee5(0xfd3)],'theme':localStorage[_0x3a1ee5(0x728)](_0x3a1ee5(0x3c7))||_0x3a1ee5(0xdf8),'showStatusBar':_0x5de8b7[_0x3a1ee5(0x2df)][_0x3a1ee5(0x7b1)],'notificationSoundUrl':_0x5de8b7['globalSettings'][_0x3a1ee5(0x688)],'widgetData':_0x5de8b7[_0x3a1ee5(0x2df)][_0x3a1ee5(0x532)]};let _0x56c802=null;for(const _0x234225 of _0x198af2){if(JSON[_0x3a1ee5(0x313)](_0x234225[_0x3a1ee5(0xf27)])===JSON[_0x3a1ee5(0x313)](_0x9df552)){_0x56c802=_0x234225['id'];break;}}_0x56c802?_0x4a9d88[_0x3a1ee5(0xf27)]=_0x56c802:_0x4a9d88[_0x3a1ee5(0xf27)]='';}async function _0x52c7ca(){const _0x126404=_0x241b18,_0x1dc2bd=document[_0x126404(0x11e3)](_0x126404(0x1102)),_0x2071a3=parseInt(_0x1dc2bd['value']);if(isNaN(_0x2071a3))return;const _0x267254=await _0x2e83f8[_0x126404(0xa7a)]['get'](_0x2071a3);if(_0x267254&&_0x267254[_0x126404(0xf27)]){const _0x5a28a1=_0x267254[_0x126404(0xf27)];Object['assign'](_0x5de8b7[_0x126404(0x2df)],_0x5a28a1),_0x43fa3c(_0x5a28a1['theme']||_0x126404(0xdf8)),await _0x2e83f8[_0x126404(0x2df)][_0x126404(0xe3c)](_0x5de8b7[_0x126404(0x2df)]),_0x34145f(),_0x4a28b8(),_0x40cea2(),_0x3f2530(),_0x2d3a77(),_0xecbef(),_0x1f90a4(),alert(_0x126404(0x12ba)+_0x267254[_0x126404(0x278)]+'”');}}async function _0x770e48(){const _0x1079b7=_0x241b18,_0x105c59=await _0x231a5a(_0x1079b7(0xe96),_0x1079b7(0x112f));if(!_0x105c59||!_0x105c59[_0x1079b7(0xeb7)]())return;const _0x2b4f55={'wallpaper':_0x5de8b7[_0x1079b7(0x2df)][_0x1079b7(0x11d)],'cphoneWallpaper':_0x5de8b7[_0x1079b7(0x2df)][_0x1079b7(0xaa4)],'globalChatBackground':_0x5de8b7[_0x1079b7(0x2df)][_0x1079b7(0x720)],'appIcons':_0x5de8b7['globalSettings'][_0x1079b7(0x18b)],'cphoneAppIcons':_0x5de8b7[_0x1079b7(0x2df)][_0x1079b7(0xfaa)],'chatActionButtonsOrder':_0x5de8b7[_0x1079b7(0x2df)][_0x1079b7(0xfd3)],'theme':localStorage[_0x1079b7(0x728)](_0x1079b7(0x3c7))||_0x1079b7(0xdf8),'showStatusBar':_0x5de8b7[_0x1079b7(0x2df)]['showStatusBar'],'notificationSoundUrl':_0x5de8b7[_0x1079b7(0x2df)]['notificationSoundUrl'],'widgetData':_0x5de8b7[_0x1079b7(0x2df)][_0x1079b7(0x532)]},_0x42d88d=await _0x2e83f8['appearancePresets'][_0x1079b7(0x129e)]({'name':_0x105c59['trim'](),'type':_0x1079b7(0x1118)})['first']();if(_0x42d88d){const _0x587e2c=await _0x58fd60('覆盖预设',_0x1079b7(0x1ac)+_0x105c59['trim']()+_0x1079b7(0x253),{'confirmButtonClass':'btn-danger'});if(!_0x587e2c)return;await _0x2e83f8['appearancePresets'][_0x1079b7(0x1225)](_0x42d88d['id'],{'value':_0x2b4f55});}else await _0x2e83f8[_0x1079b7(0xa7a)][_0x1079b7(0x252)]({'name':_0x105c59['trim'](),'type':'appearance','value':_0x2b4f55});await _0x502814(),alert('外观预设已保存！');}async function _0x504990(){const _0x56439c=_0x241b18,_0x283542=document[_0x56439c(0x11e3)]('appearance-preset-select'),_0x500254=parseInt(_0x283542[_0x56439c(0xf27)]);if(isNaN(_0x500254)){alert('请先从下拉框中选择一个要删除的预设。');return;}const _0x64ce9=await _0x2e83f8[_0x56439c(0xa7a)][_0x56439c(0x1289)](_0x500254);if(!_0x64ce9)return;const _0x181733=await _0x58fd60(_0x56439c(0x30c),_0x56439c(0xbf4)+_0x64ce9[_0x56439c(0x278)]+_0x56439c(0xbec),{'confirmButtonClass':'btn-danger'});_0x181733&&(await _0x2e83f8['appearancePresets'][_0x56439c(0xc0c)](_0x500254),await _0x502814(),alert('预设已删除。'));}async function _0x354857(){const _0x2112ad=_0x241b18,_0x30661=document[_0x2112ad(0x11e3)]('theme-preset-select');_0x30661[_0x2112ad(0x595)]=_0x2112ad(0x8b0);const _0x2a2b78=await _0x2e83f8[_0x2112ad(0xa7a)]['where'](_0x2112ad(0xa20))[_0x2112ad(0x119e)](_0x2112ad(0xd25))[_0x2112ad(0x508)]();_0x2a2b78['forEach'](_0x2f387b=>{const _0x516631=_0x2112ad,_0x5e9465=document[_0x516631(0x383)](_0x516631(0xd91));_0x5e9465[_0x516631(0xf27)]=_0x2f387b['id'],_0x5e9465[_0x516631(0x300)]=_0x2f387b[_0x516631(0x278)],_0x30661['appendChild'](_0x5e9465);});}async function _0xaab675(){const _0x469e6b=_0x241b18,_0x2d1355=document['getElementById'](_0x469e6b(0x7ce)),_0x2668e3=parseInt(_0x2d1355[_0x469e6b(0xf27)]);if(isNaN(_0x2668e3))return;const _0x13d412=await _0x2e83f8[_0x469e6b(0xa7a)][_0x469e6b(0x1289)](_0x2668e3);if(_0x13d412){const _0x290c80=_0x13d412[_0x469e6b(0xf27)][_0x469e6b(0x2f1)]||_0x469e6b(0xd3),_0x1ea5af=_0x13d412[_0x469e6b(0xf27)][_0x469e6b(0x3c4)]||'',_0x31b6b6=document['querySelector']('input[name=\x22theme-select\x22][value=\x22'+_0x290c80+'\x22]');_0x31b6b6&&(_0x31b6b6[_0x469e6b(0x3e4)]=!![]);const _0x396bc1=document['getElementById'](_0x469e6b(0x311));_0x396bc1[_0x469e6b(0xf27)]=_0x1ea5af,_0x2d03c9();}}async function _0x2ee191(){const _0x520843=_0x241b18,_0x27119e=await _0x231a5a(_0x520843(0xb27),_0x520843(0x112f));if(!_0x27119e||!_0x27119e[_0x520843(0xeb7)]())return;const _0x18e8e5=document['querySelector'](_0x520843(0xe59)),_0x4c6fe4=_0x18e8e5?_0x18e8e5['value']:_0x520843(0xd3),_0xba5842=document[_0x520843(0x11e3)](_0x520843(0x311))['value'][_0x520843(0xeb7)](),_0x55e284={'base':_0x4c6fe4,'custom':_0xba5842},_0x49474e=await _0x2e83f8[_0x520843(0xa7a)][_0x520843(0x129e)]({'name':_0x27119e[_0x520843(0xeb7)](),'type':_0x520843(0xd25)})[_0x520843(0x12c1)]();if(_0x49474e){const _0x2ce7fc=await _0x58fd60(_0x520843(0xf78),_0x520843(0x1ac)+_0x27119e[_0x520843(0xeb7)]()+_0x520843(0x253),{'confirmButtonClass':_0x520843(0x8a6)});if(!_0x2ce7fc)return;await _0x2e83f8[_0x520843(0xa7a)][_0x520843(0x1225)](_0x49474e['id'],{'value':_0x55e284});}else await _0x2e83f8[_0x520843(0xa7a)]['add']({'name':_0x27119e['trim'](),'type':'bubble_theme','value':_0x55e284});await _0x354857(),alert(_0x520843(0xa19));}async function _0x272534(){const _0xbaeff0=_0x241b18,_0x7a53fb=document[_0xbaeff0(0x11e3)](_0xbaeff0(0x7ce)),_0x419e9e=parseInt(_0x7a53fb[_0xbaeff0(0xf27)]);if(isNaN(_0x419e9e)){alert(_0xbaeff0(0x28f));return;}const _0xe62b93=await _0x2e83f8[_0xbaeff0(0xa7a)]['get'](_0x419e9e);if(!_0xe62b93)return;const _0xdf668=await _0x58fd60(_0xbaeff0(0x30c),_0xbaeff0(0xbf4)+_0xe62b93[_0xbaeff0(0x278)]+'”\x20吗？',{'confirmButtonClass':'btn-danger'});_0xdf668&&(await _0x2e83f8[_0xbaeff0(0xa7a)][_0xbaeff0(0xc0c)](_0x419e9e),await _0x354857(),alert(_0xbaeff0(0x762)));}async function _0x178968(){const _0x38d5d1=_0x241b18;await _0x350611(),document[_0x38d5d1(0x11e3)](_0x38d5d1(0x514))['classList'][_0x38d5d1(0x252)](_0x38d5d1(0x250));}async function _0x350611(){const _0x428845=_0x241b18,_0x48332a=document[_0x428845(0x11e3)](_0x428845(0xb6f)),_0x9d99d7=await _0x2e83f8[_0x428845(0x120e)][_0x428845(0x508)]();_0x48332a[_0x428845(0x595)]='';if(_0x9d99d7[_0x428845(0x594)]===0x0){_0x48332a[_0x428845(0x595)]=_0x428845(0x85d);return;}_0x9d99d7['forEach'](_0xc025df=>{const _0x421f7f=_0x428845,_0x332000=document[_0x421f7f(0x383)](_0x421f7f(0x1285));_0x332000[_0x421f7f(0x3db)]=_0x421f7f(0x1cf),_0x332000[_0x421f7f(0x595)]=_0x421f7f(0x1f1)+_0xc025df[_0x421f7f(0x278)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0xc025df['id']+_0x421f7f(0xfbe),_0x48332a[_0x421f7f(0x120c)](_0x332000);});}async function _0x16bb08(){const _0x619328=_0x241b18,_0x9921b0=document[_0x619328(0x11e3)](_0x619328(0xa5d)),_0x1fc384=_0x9921b0[_0x619328(0xf27)]['trim']();if(!_0x1fc384){alert(_0x619328(0x4a2));return;}const _0x1fbc03=await _0x2e83f8['stickerCategories'][_0x619328(0x129e)](_0x619328(0x278))[_0x619328(0x119e)](_0x1fc384)[_0x619328(0x12c1)]();if(_0x1fbc03){alert(_0x619328(0x1239)+_0x1fc384+'\x22\x20已经存在了！');return;}await _0x2e83f8['stickerCategories'][_0x619328(0x252)]({'name':_0x1fc384}),_0x9921b0[_0x619328(0xf27)]='',await _0x350611();}async function _0x1e65b7(_0x9d8e51){const _0x335296=_0x241b18,_0x513ba6=await _0x2e83f8[_0x335296(0x120e)][_0x335296(0x1289)](_0x9d8e51);if(!_0x513ba6)return;const _0x2a0152=await _0x2e83f8[_0x335296(0xa67)][_0x335296(0x129e)]('categoryId')[_0x335296(0x119e)](_0x9d8e51)[_0x335296(0xc85)](),_0x275c47=_0x2a0152>0x0?'确定要删除分类《'+_0x513ba6[_0x335296(0x278)]+_0x335296(0x513)+_0x2a0152+'\x20个表情包，且无法恢复！':_0x335296(0x44f)+_0x513ba6['name']+_0x335296(0xe48),_0x2a0ea5=await _0x58fd60(_0x335296(0xf1d),_0x275c47,{'confirmButtonClass':'btn-danger'});if(_0x2a0ea5)try{await _0x2e83f8[_0x335296(0x1272)]('rw',_0x2e83f8[_0x335296(0x120e)],_0x2e83f8[_0x335296(0xa67)],async()=>{const _0x1a688c=_0x335296,_0xebd364=await _0x2e83f8[_0x1a688c(0xa67)][_0x1a688c(0x129e)](_0x1a688c(0x9ee))[_0x1a688c(0x119e)](_0x9d8e51)[_0x1a688c(0xa9)]();_0xebd364[_0x1a688c(0x594)]>0x0&&await _0x2e83f8[_0x1a688c(0xa67)][_0x1a688c(0x7ac)](_0xebd364),await _0x2e83f8[_0x1a688c(0x120e)]['delete'](_0x9d8e51);}),_0x5de8b7[_0x335296(0xa67)]=await _0x2e83f8[_0x335296(0xa67)][_0x335296(0x508)](),_0x10c076===_0x9d8e51&&(_0x10c076='all'),await _0x350611(),await _0x40d6fc(),alert(_0x335296(0x58b)+_0x513ba6[_0x335296(0x278)]+'》及其下的表情已成功删除。');}catch(_0x5b6397){console[_0x335296(0x1c1)](_0x335296(0x499),_0x5b6397),alert('删除失败，请查看控制台错误信息。');}}function _0x2a42d7(_0x722233){const _0x28244d=_0x241b18;_0x10c076=_0x722233,document[_0x28244d(0x10d6)](_0x28244d(0x455))[_0x28244d(0x494)](_0x48b708=>{const _0x10cedd=_0x28244d;_0x48b708[_0x10cedd(0x505)]['toggle'](_0x10cedd(0x1fc),String(_0x48b708[_0x10cedd(0xaca)][_0x10cedd(0x9ee)])===String(_0x722233));}),_0x40d6fc(![]);const _0x5de2e5=document[_0x28244d(0x11e3)](_0x28244d(0xca6));if(_0x5de2e5)_0x5de2e5['checked']=![];}async function _0x2d6235(){const _0x59e7eb=_0x241b18;if(!_0x5de8b7[_0x59e7eb(0x93d)])return;const _0x10a7a1=_0x5de8b7['chats'][_0x5de8b7[_0x59e7eb(0x93d)]];if(!_0x10a7a1)return;try{const _0x445a6c={'type':'EPhoneSingleChat','version':0x1,'chatData':_0x10a7a1},_0x46ef1e=new Blob([JSON[_0x59e7eb(0x313)](_0x445a6c,null,0x2)],{'type':_0x59e7eb(0x35c)}),_0x3e890a=URL[_0x59e7eb(0x12fd)](_0x46ef1e),_0x555363=document[_0x59e7eb(0x383)]('a');_0x555363[_0x59e7eb(0x125b)]=_0x3e890a,_0x555363['download']=_0x59e7eb(0x11b4)+_0x10a7a1[_0x59e7eb(0x278)]+'-'+new Date()['toISOString']()[_0x59e7eb(0x65b)]('T')[0x0]+_0x59e7eb(0xfc4),_0x555363['click'](),URL['revokeObjectURL'](_0x3e890a),await _0x2fb06(_0x59e7eb(0x799),'与“'+_0x10a7a1[_0x59e7eb(0x278)]+_0x59e7eb(0x4e4));}catch(_0x4ac1f6){console['error'](_0x59e7eb(0xea),_0x4ac1f6),await _0x2fb06(_0x59e7eb(0x567),_0x59e7eb(0x88d)+_0x4ac1f6[_0x59e7eb(0x4bc)]);}}async function _0x4eb82e(_0x18d7d2){const _0x25a0c=_0x241b18;if(!_0x18d7d2||!_0x5de8b7[_0x25a0c(0x93d)])return;const _0x3cb5f4=_0x5de8b7['activeChatId'],_0x30bb3a=_0x5de8b7[_0x25a0c(0x737)][_0x3cb5f4];try{const _0x440b7a=await _0x18d7d2['text'](),_0x3857ed=JSON[_0x25a0c(0xb0c)](_0x440b7a);if(_0x3857ed[_0x25a0c(0xa20)]!==_0x25a0c(0xfa6)||!_0x3857ed[_0x25a0c(0x209)])throw new Error(_0x25a0c(0x1178));const _0x459d41=await _0x58fd60(_0x25a0c(0x717),_0x25a0c(0xbfb)+_0x30bb3a[_0x25a0c(0x278)]+_0x25a0c(0x632),{'confirmButtonClass':'btn-danger','confirmText':'确认覆盖'});if(!_0x459d41)return;const _0x3720e8=_0x3857ed[_0x25a0c(0x209)];_0x3720e8['id']=_0x3cb5f4,await _0x2e83f8['chats']['put'](_0x3720e8),_0x5de8b7[_0x25a0c(0x737)][_0x3cb5f4]=_0x3720e8,await _0x2fb06('导入成功','聊天记录已成功覆盖！正在刷新界面...'),_0x544ab5(_0x3cb5f4),_0x5ee219(),document[_0x25a0c(0x11e3)](_0x25a0c(0x4bb))[_0x25a0c(0x1041)]();}catch(_0x12049e){console['error']('导入单个聊天时出错:',_0x12049e),await _0x2fb06('导入失败',_0x25a0c(0x110)+_0x12049e['message']);}}function _0x5605c3(){_0x17c4df(),_0x4e7698('character-selection-screen');}function _0x17c4df(){const _0x36665f=_0x241b18,_0x1c83ae=document[_0x36665f(0x11e3)](_0x36665f(0xde2));_0x1c83ae['innerHTML']='';const _0x374acd=Object[_0x36665f(0x4ca)](_0x5de8b7[_0x36665f(0x737)])[_0x36665f(0x138)](_0x472443=>!_0x472443[_0x36665f(0x1244)]);if(_0x374acd[_0x36665f(0x594)]===0x0){_0x1c83ae[_0x36665f(0x595)]=_0x36665f(0xb2);return;}_0x374acd[_0x36665f(0x494)](_0xd6885=>{const _0x17cc3c=_0x36665f,_0x42a817=document[_0x17cc3c(0x383)]('div');_0x42a817[_0x17cc3c(0x3db)]=_0x17cc3c(0xfb),_0x42a817[_0x17cc3c(0x595)]=_0x17cc3c(0xd6d)+(_0xd6885[_0x17cc3c(0x761)][_0x17cc3c(0x5e0)]||_0x3d2e44)+_0x17cc3c(0x655)+_0xd6885[_0x17cc3c(0x278)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x42a817[_0x17cc3c(0x4b8)](_0x17cc3c(0x1041),()=>_0x38854c(_0xd6885['id'])),_0x1c83ae[_0x17cc3c(0x120c)](_0x42a817);});}async function _0x38854c(_0x46740a){const _0x4bb8bb=_0x241b18;_0x698363=_0x46740a,console[_0x4bb8bb(0x84b)]('已切换到角色\x20'+_0x46740a+_0x4bb8bb(0x364)),_0x4a28b8(),_0x3f2530(),_0x2477de(),_0x4e7698('character-phone-screen');}function _0xb12251(){const _0x2c303f=_0x241b18;_0x698363=null,console[_0x2c303f(0x84b)](_0x2c303f(0x1219)),_0x4e7698(_0x2c303f(0x417));}function _0x2477de(){const _0x31ccd1=_0x241b18,_0xce6e50=new Date(),_0x3a0ed3=_0xce6e50['toLocaleTimeString'](_0x31ccd1(0x898),{'hour':_0x31ccd1(0x93a),'minute':_0x31ccd1(0x93a)}),_0x2ae9c6=_0xce6e50[_0x31ccd1(0x70e)](_0x31ccd1(0x898),{'weekday':_0x31ccd1(0xc7),'month':_0x31ccd1(0xc7),'day':_0x31ccd1(0x61b)});document[_0x31ccd1(0x11e3)](_0x31ccd1(0x1223))['textContent']=_0x3a0ed3,document[_0x31ccd1(0x11e3)](_0x31ccd1(0x102e))[_0x31ccd1(0x300)]=_0x2ae9c6,_0x5a5fee('char-home-screen');}function _0x5a5fee(_0x51eea8){const _0x1b5dc3=_0x241b18;document[_0x1b5dc3(0x10d6)](_0x1b5dc3(0x807))[_0x1b5dc3(0x494)](_0x5c17eb=>_0x5c17eb['classList'][_0x1b5dc3(0x957)](_0x1b5dc3(0x1fc))),document[_0x1b5dc3(0x11e3)](_0x51eea8)[_0x1b5dc3(0x505)][_0x1b5dc3(0x252)](_0x1b5dc3(0x1fc));}window[_0x241b18(0x2f8)]=_0x5a5fee;async function _0x309134(_0x467cac){const _0x232f7b=_0x241b18;if(!_0x698363)return;const _0x4b7c4f=_0x5de8b7['chats'][_0x698363];await _0x325479(_0x698363,_0x467cac);switch(_0x467cac){case'qq':_0x29cf60(),_0x5a5fee('char-qq-screen');break;case _0x232f7b(0x1032):_0x746188(),_0x5a5fee(_0x232f7b(0xe92));break;case _0x232f7b(0xa32):_0x278dc6(),_0x5a5fee('char-browser-screen');break;case _0x232f7b(0xb55):_0x1953b4(),_0x5a5fee('char-taobao-screen');break;case _0x232f7b(0x30d):_0x302be7(),_0x5a5fee('char-memo-screen');break;case'diary':_0x35ed48(),_0x5a5fee(_0x232f7b(0x37a));break;case'amap':_0x393798(),_0x5a5fee('char-amap-screen');break;case'music':_0x5467a0(),_0x5a5fee('char-music-screen');break;case _0x232f7b(0xc7c):_0x1eee84(),_0x5a5fee(_0x232f7b(0x1099));break;}}async function _0x746188(){const _0x57dc=_0x241b18,_0x5802c5=document[_0x57dc(0x11e3)]('char-album-grid');_0x5802c5[_0x57dc(0x595)]='';if(!_0x698363)return;const _0x4eaadb=_0x5de8b7[_0x57dc(0x737)][_0x698363],_0x5186a9=_0x4eaadb[_0x57dc(0x587)]||[];if(_0x5186a9[_0x57dc(0x594)]===0x0){_0x5802c5[_0x57dc(0x595)]=_0x57dc(0x246);return;}const _0x18f9c4=_0x57dc(0x23b);_0x5186a9[_0x57dc(0x494)](_0x5003a3=>{const _0x24e93e=_0x57dc,_0x46b026=document[_0x24e93e(0x383)]('div');_0x46b026['className']='char-photo-item',_0x46b026['dataset'][_0x24e93e(0x1029)]=_0x5003a3[_0x24e93e(0x1029)],_0x5802c5[_0x24e93e(0x120c)](_0x46b026);if(_0x5de8b7['globalSettings'][_0x24e93e(0xbd4)]){_0x46b026[_0x24e93e(0x794)][_0x24e93e(0x556)]=_0x24e93e(0x5cd);const _0x36a13e=/[^\x00-\x7F]/[_0x24e93e(0x1043)](_0x5003a3[_0x24e93e(0xee6)]),_0x4bba02=_0x5003a3[_0x24e93e(0xee6)]&&_0x5003a3[_0x24e93e(0xee6)]['trim']()&&!_0x36a13e,_0x1a5dfc=_0x4bba02?_0x5003a3['image_prompt']:_0x24e93e(0x12c0),_0x2ca678='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x1a5dfc),_0x141a0f=new Image();_0x141a0f['onload']=function(){const _0x5ecafd=_0x24e93e;_0x46b026[_0x5ecafd(0x794)]['backgroundImage']=_0x5ecafd(0xac7)+this[_0x5ecafd(0xf0a)]+')';},_0x141a0f[_0x24e93e(0x741)]=function(){const _0x4e9fba=_0x24e93e;_0x46b026[_0x4e9fba(0x794)][_0x4e9fba(0x123e)]=_0x4e9fba(0xac7)+_0x18f9c4+')';},_0x141a0f[_0x24e93e(0xf0a)]=_0x2ca678;}else{_0x46b026[_0x24e93e(0x794)][_0x24e93e(0x556)]=_0x24e93e(0x4fa),_0x46b026[_0x24e93e(0x794)][_0x24e93e(0x11bc)]=_0x24e93e(0x87e);const _0x4a83f8=document['createElement']('p');_0x4a83f8[_0x24e93e(0x3db)]='char-photo-description',_0x4a83f8[_0x24e93e(0x300)]=_0x5003a3[_0x24e93e(0x1029)]||_0x24e93e(0xb34),_0x46b026['appendChild'](_0x4a83f8);}});}function _0x278dc6(){const _0x190828=_0x241b18,_0x235c71=document[_0x190828(0x11e3)](_0x190828(0x1015));_0x235c71[_0x190828(0x595)]='';if(!_0x698363)return;const _0x42cc02=_0x5de8b7[_0x190828(0x737)][_0x698363],_0x230f9d=[_0x42cc02[_0x190828(0x278)],'爱好','旅游','美食','新闻',..._0x42cc02[_0x190828(0x761)][_0x190828(0x8d5)][_0x190828(0x65b)](/，|。|\s/)[_0x190828(0xa6c)](0x0,0x5)],_0x28b927=['知乎','Bilibili',_0x190828(0xca4),'微博',_0x190828(0x8e1)];for(let _0x706467=0x0;_0x706467<0xf;_0x706467++){const _0x2110c7=_0x230f9d[Math['floor'](Math[_0x190828(0x36d)]()*_0x230f9d['length'])],_0x1dd92b=_0x28b927[Math[_0x190828(0xfb1)](Math[_0x190828(0x36d)]()*_0x28b927[_0x190828(0x594)])],_0x584e89=document['createElement'](_0x190828(0x1285));_0x584e89['className']=_0x190828(0x1137),_0x584e89[_0x190828(0x595)]=_0x190828(0x50a)+_0x2110c7+_0x190828(0x12a2)+_0x1dd92b+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.'+_0x1dd92b['toLowerCase']()+_0x190828(0x8dd)+_0x2110c7+_0x190828(0x176),_0x235c71[_0x190828(0x120c)](_0x584e89);}}function _0x1953b4(){const _0x256f57=_0x241b18,_0x165718=document['getElementById'](_0x256f57(0xe1f));_0x165718[_0x256f57(0x595)]='';if(!_0x698363)return;const _0xb51a5d=_0x5de8b7[_0x256f57(0x737)][_0x698363],_0x50c56d=_0xb51a5d[_0x256f57(0x931)]?.[_0x256f57(0x115d)]||[];if(_0x50c56d[_0x256f57(0x594)]===0x0){_0x165718[_0x256f57(0x595)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>';return;}_0x50c56d[_0x256f57(0x494)](_0x5d0bf5=>{const _0x2ac2ab=_0x256f57,_0x13c8a3=document[_0x2ac2ab(0x383)](_0x2ac2ab(0x1285));_0x13c8a3[_0x2ac2ab(0x3db)]='char-product-item',_0x13c8a3[_0x2ac2ab(0xaca)][_0x2ac2ab(0xc67)]=_0x5d0bf5[_0x2ac2ab(0xc67)];let _0x4d8108;if(_0x5de8b7[_0x2ac2ab(0x2df)][_0x2ac2ab(0xbd4)]){const _0x546581=_0x2ac2ab(0x35d)+encodeURIComponent(_0x5d0bf5['image_prompt']||'a\x20random\x20product');_0x4d8108=_0x2ac2ab(0x13b)+_0x546581+_0x2ac2ab(0x114);}else _0x4d8108=_0x2ac2ab(0x10b0)+(_0x5d0bf5[_0x2ac2ab(0xc67)]||'(无购买理由)')+_0x2ac2ab(0x10cf);_0x13c8a3['innerHTML']=_0x2ac2ab(0xfe0)+_0x4d8108+_0x2ac2ab(0xc47)+_0x5d0bf5[_0x2ac2ab(0xa4c)]+_0x2ac2ab(0xbad)+(_0x5d0bf5['price']||0x0)[_0x2ac2ab(0x200)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>'+_0x5d0bf5[_0x2ac2ab(0x739)]+_0x2ac2ab(0xaf0),_0x165718[_0x2ac2ab(0x120c)](_0x13c8a3);});}function _0x29e75d(){const _0x1fa684=_0x241b18;_0x5a5fee(_0x1fa684(0xf7c));}function _0x3b94fd(){const _0xc37c1a=_0x241b18,_0x24c157=document[_0xc37c1a(0x11e3)]('char-chat-list');_0x24c157[_0xc37c1a(0x595)]='';if(!_0x698363)return;const _0x32d1fc=Object[_0xc37c1a(0x4ca)](_0x5de8b7[_0xc37c1a(0x737)])[_0xc37c1a(0x138)](_0x2ba0ee=>{const _0x1ee0a8=_0xc37c1a;if(_0x2ba0ee['id']===_0x698363)return!![];if(_0x2ba0ee['isGroup']&&_0x2ba0ee[_0x1ee0a8(0x2b3)][_0x1ee0a8(0xe7c)](_0x46a3ea=>_0x46a3ea['id']===_0x698363))return!![];return![];});_0x32d1fc['forEach'](_0x24ed31=>{const _0x54a410=_0xc37c1a,_0x29647d=_0x379554(_0x24ed31);_0x24c157[_0x54a410(0x120c)](_0x29647d);});}async function _0x325479(_0x5918b8,_0x4524fb){const _0x3a2cd2=_0x241b18,_0x1fcc05=_0x5de8b7[_0x3a2cd2(0x737)][_0x5918b8];if(!_0x1fcc05)return;!_0x1fcc05[_0x3a2cd2(0x368)]&&(_0x1fcc05[_0x3a2cd2(0x368)]=[]),_0x1fcc05['appUsageLog'][_0x3a2cd2(0xf5)]({'appName':_0x4524fb,'timestamp':Date[_0x3a2cd2(0x1182)]()}),_0x1fcc05[_0x3a2cd2(0x368)][_0x3a2cd2(0x594)]>0x32&&_0x1fcc05[_0x3a2cd2(0x368)]['shift'](),await _0x2e83f8[_0x3a2cd2(0x737)][_0x3a2cd2(0xe3c)](_0x1fcc05);}function _0x1eee84(){const _0x4e259d=_0x241b18,_0x7be24c=document[_0x4e259d(0x11e3)](_0x4e259d(0x1160));_0x7be24c[_0x4e259d(0x595)]='';const _0xb10691=_0x5de8b7[_0x4e259d(0x737)][_0x698363],_0x2438bd=(_0xb10691[_0x4e259d(0x368)]||[])[_0x4e259d(0xa6c)]()['reverse']();if(_0x2438bd[_0x4e259d(0x594)]===0x0){_0x7be24c['innerHTML']=_0x4e259d(0x25d);return;}const _0x37f54f={'qq':'QQ','album':'相册','browser':_0x4e259d(0x63b),'taobao':'淘宝','memo':_0x4e259d(0x10a5),'diary':'日记','amap':_0x4e259d(0x8f7),'usage':_0x4e259d(0x1bb)};_0x2438bd[_0x4e259d(0x494)](_0x25c90a=>{const _0x3e59d4=_0x4e259d,_0xe2b037=document[_0x3e59d4(0x383)](_0x3e59d4(0x1285));_0xe2b037[_0x3e59d4(0x3db)]=_0x3e59d4(0x12fb),_0xe2b037[_0x3e59d4(0x595)]=_0x3e59d4(0x11c9)+new Date(_0x25c90a[_0x3e59d4(0x702)])[_0x3e59d4(0x9df)]()+_0x3e59d4(0xcf8)+(_0x37f54f[_0x25c90a['appName']]||_0x25c90a['appName'])+_0x3e59d4(0xb0f),_0x7be24c[_0x3e59d4(0x120c)](_0xe2b037);});}async function _0x56689b(_0x13250d){const _0x2e8f74=_0x241b18,_0x5e3a29=_0x5de8b7[_0x2e8f74(0x737)][_0x698363];if(!_0x5e3a29)return;const _0x325bba={'role':'assistant','senderName':_0x5e3a29[_0x2e8f74(0x697)],'type':_0x2e8f74(0x104),'content':_0x13250d,'imageUrl':'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','timestamp':Date[_0x2e8f74(0x1182)]()};_0x5e3a29[_0x2e8f74(0x49e)][_0x2e8f74(0xf5)](_0x325bba),await _0x2e83f8[_0x2e8f74(0x737)][_0x2e8f74(0xe3c)](_0x5e3a29),_0x5de8b7['activeChatId']===_0x698363&&_0x3b5153(_0x325bba,_0x5e3a29),await _0x2fb06('分享成功','“'+_0x5e3a29[_0x2e8f74(0x278)]+_0x2e8f74(0x1040));}async function _0x139591(_0x534370){const _0x515ebe=_0x241b18,_0x54f5ea=_0x5de8b7[_0x515ebe(0x737)][_0x698363];if(!_0x54f5ea||!_0x54f5ea[_0x515ebe(0x90e)])return;const _0x491a77=_0x54f5ea[_0x515ebe(0x90e)][_0x515ebe(0xe79)](_0x3d299e=>_0x3d299e['id']===_0x534370);if(_0x491a77){_0x3dcd61=_0x491a77;const _0x1722fa=document['getElementById']('char-memo-detail-title'),_0x5cdab2=document[_0x515ebe(0x11e3)]('char-memo-detail-content'),_0x39c570=document[_0x515ebe(0x11e3)](_0x515ebe(0xeb9));if(_0x1722fa)_0x1722fa['textContent']=_0x491a77['title'];if(_0x5cdab2)_0x5cdab2[_0x515ebe(0xf27)]=_0x491a77[_0x515ebe(0x9a5)];const _0x19aa00=await _0x2e83f8[_0x515ebe(0xc3e)][_0x515ebe(0x129e)]({'type':'char_memo','content.id':_0x534370})['first']();_0x39c570[_0x515ebe(0x505)][_0x515ebe(0xe7e)](_0x515ebe(0x1fc),!!_0x19aa00),_0x5a5fee(_0x515ebe(0x2eb));}}function _0x302be7(){const _0x3a1720=_0x241b18,_0xde65e=document[_0x3a1720(0x11e3)](_0x3a1720(0x729));_0xde65e[_0x3a1720(0x595)]='';const _0x1bc24d=_0x5de8b7[_0x3a1720(0x737)][_0x698363],_0x1dea63=(_0x1bc24d['memos']||[])[_0x3a1720(0xa6c)]()[_0x3a1720(0x107)]();if(_0x1dea63[_0x3a1720(0x594)]===0x0){_0xde65e[_0x3a1720(0x595)]=_0x3a1720(0xd03);return;}_0x1dea63[_0x3a1720(0x494)](_0x2f8217=>{const _0x25b308=_0x3a1720,_0x12ab7c=document[_0x25b308(0x383)]('div');_0x12ab7c[_0x25b308(0x3db)]=_0x25b308(0x645),_0x12ab7c[_0x25b308(0x595)]=_0x25b308(0x21b)+_0x2f8217[_0x25b308(0x740)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>'+(_0x2f8217[_0x25b308(0x9a5)]||'')[_0x25b308(0x65b)]('\x0a')[0x0]+_0x25b308(0x176),_0x12ab7c[_0x25b308(0x4b8)](_0x25b308(0x1041),()=>_0x139591(_0x2f8217['id'])),_0xcb6204(_0x12ab7c,()=>deleteMemo(_0x2f8217['id'])),_0xde65e[_0x25b308(0x120c)](_0x12ab7c);});}async function _0x314d5b(_0x1b54a=null){const _0xe0ffbe=_0x241b18;_0x2b2e96=null;const _0x434016=await _0x231a5a(_0xe0ffbe(0xba7),_0xe0ffbe(0xc9f));if(_0x434016===null||!_0x434016['trim']())return;const _0xbeebe4=await _0x231a5a(_0xe0ffbe(0x12e6)+_0x434016,_0xe0ffbe(0x9ae),'',_0xe0ffbe(0x10bb));_0xbeebe4!==null&&(await _0x3268ab({'title':_0x434016[_0xe0ffbe(0xeb7)](),'content':_0xbeebe4}),_0x5a5fee(_0xe0ffbe(0xf8c)));}async function _0x3268ab(_0x287dc2){const _0x1f2f2b=_0x241b18,_0x4a3777=_0x5de8b7['chats'][_0x698363];if(!_0x4a3777[_0x1f2f2b(0x90e)])_0x4a3777[_0x1f2f2b(0x90e)]=[];_0x4a3777[_0x1f2f2b(0x90e)][_0x1f2f2b(0xf5)]({'id':Date[_0x1f2f2b(0x1182)](),'title':_0x287dc2['title'],'content':_0x287dc2[_0x1f2f2b(0x9a5)]}),await _0x2e83f8[_0x1f2f2b(0x737)][_0x1f2f2b(0xe3c)](_0x4a3777),_0x302be7();}async function _0x3268ab(_0x12d6f1){const _0x4509d4=_0x241b18,_0x9aafab=_0x5de8b7['chats'][_0x698363];if(!_0x9aafab[_0x4509d4(0x90e)])_0x9aafab[_0x4509d4(0x90e)]=[];if(_0x2b2e96){const _0x509521=_0x9aafab[_0x4509d4(0x90e)]['find'](_0x197e10=>_0x197e10['id']===_0x2b2e96);if(_0x509521)_0x509521[_0x4509d4(0x9a5)]=_0x12d6f1;}else _0x9aafab['memos'][_0x4509d4(0xf5)]({'id':Date['now'](),'content':_0x12d6f1});await _0x2e83f8['chats'][_0x4509d4(0xe3c)](_0x9aafab),_0x302be7(),_0x2b2e96=null;}async function _0x30f18a(){const _0x282872=_0x241b18;if(!_0x698363)return;const _0x17e10c=_0x5de8b7[_0x282872(0x737)][_0x698363];if(!_0x17e10c)return;await _0x2fb06(_0x282872(0x63d),_0x282872(0x207)+_0x17e10c['name']+_0x282872(0x58f));const {proxyUrl:_0x4f8ed4,apiKey:_0x5bcbef,model:_0x3cfec6}=_0x5de8b7[_0x282872(0x89c)];if(!_0x4f8ed4||!_0x5bcbef||!_0x3cfec6){alert(_0x282872(0xace));return;}const _0x28a44e=_0x5de8b7[_0x282872(0x1c5)]['nickname']===_0x282872(0x833)||!_0x5de8b7[_0x282872(0x1c5)][_0x282872(0xa33)]?'用户':_0x5de8b7['qzoneSettings']['nickname'],_0x26ddcb=_0x17e10c['longTermMemory']&&_0x17e10c[_0x282872(0xe21)][_0x282872(0x594)]>0x0?_0x17e10c[_0x282872(0xe21)]['map'](_0x11ec68=>_0x282872(0xd12)+_0x497f2b(_0x11ec68[_0x282872(0x702)])+')\x20'+_0x11ec68[_0x282872(0x9a5)])[_0x282872(0xa4b)]('\x0a'):'无',_0x44bf27=_0x17e10c['settings']['maxMemory']||0xa,_0x3b1e46=_0x17e10c[_0x282872(0x49e)][_0x282872(0xa6c)](-_0x44bf27)[_0x282872(0x796)](_0x41eb77=>(_0x41eb77[_0x282872(0xba4)]===_0x282872(0x21c)?_0x28a44e:_0x17e10c['name'])+':\x20'+String(_0x41eb77[_0x282872(0x9a5)])[_0x282872(0x8d4)](0x0,0x1e)+_0x282872(0x6cb))['join']('\x0a'),_0x21a34c=(_0x17e10c['settings'][_0x282872(0xa17)]||[])[_0x282872(0x796)](_0xeaf338=>_0x5de8b7[_0x282872(0xca)][_0x282872(0xe79)](_0x430f75=>_0x430f75['id']===_0xeaf338))['filter'](Boolean)[_0x282872(0x796)](_0x1d719c=>_0x282872(0x10b5)+_0x1d719c[_0x282872(0x278)]+_0x282872(0x63a)+_0x1d719c[_0x282872(0x9a5)]['filter'](_0x32e56f=>_0x32e56f[_0x282872(0xc34)])[_0x282872(0x796)](_0x1d0475=>'-\x20'+_0x1d0475['content'])[_0x282872(0xa4b)]('\x0a'))['join'](''),_0x304cd7=_0x57277b(_0x17e10c,0x3,_0x282872(0x1059)),_0x6923fb=_0x57277b(_0x17e10c,0x6,_0x282872(0x1059)),_0x25e658=_0x57277b(_0x17e10c,0x9,_0x282872(0x1059)),_0x489083=_0x57277b(_0x17e10c,0x1,'days'),_0x2fc39c=_0x57277b(_0x17e10c,0x3,_0x282872(0xb95)),_0x221d47=_0x57277b(_0x17e10c,0x7,_0x282872(0xb95));let _0x3fb909='';if(_0x304cd7||_0x6923fb||_0x25e658||_0x489083||_0x2fc39c||_0x221d47){_0x3fb909+=_0x282872(0xc91);if(_0x304cd7)_0x3fb909+=_0x304cd7;if(_0x6923fb)_0x3fb909+=_0x6923fb;if(_0x25e658)_0x3fb909+=_0x25e658;if(_0x304cd7||_0x6923fb||_0x25e658)_0x3fb909+='\x0a';if(_0x489083)_0x3fb909+=_0x489083;if(_0x2fc39c)_0x3fb909+=_0x2fc39c;if(_0x221d47)_0x3fb909+=_0x221d47;}const _0x52316f=_0x282872(0x1155)+_0x17e10c['name']+_0x282872(0xdb6)+new Date()[_0x282872(0x70e)](_0x282872(0x898))+_0x282872(0x3c1)+_0x28a44e+_0x282872(0xf19)+_0x17e10c['settings'][_0x282872(0x8d5)]+_0x282872(0x63c)+_0x26ddcb+'\x0a'+_0x21a34c+'\x0a'+_0x3fb909+_0x282872(0x4c5)+_0x28a44e+'”的对话摘要**:\x0a'+_0x3b1e46+'\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。';try{const _0x424c43=[{'role':_0x282872(0x21c),'content':_0x282872(0x3e2)}];let _0x548335=_0x4f8ed4[_0x282872(0x3ad)](_0x282872(0xb9b)),_0x32e14f=_0x4a90fe(_0x3cfec6,_0x5bcbef,_0x52316f,_0x424c43);const _0xfb6d0d=_0x548335?await fetch(_0x32e14f['url'],_0x32e14f['data']):await fetch(_0x4f8ed4+_0x282872(0x8fd),{'method':_0x282872(0x1128),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x5bcbef},'body':JSON[_0x282872(0x313)]({'model':_0x3cfec6,'messages':[{'role':_0x282872(0xf72),'content':_0x52316f},..._0x424c43],'temperature':_0x5de8b7[_0x282872(0x2df)][_0x282872(0xe66)]||0.95})});if(!_0xfb6d0d['ok'])throw new Error(_0x282872(0x307)+_0xfb6d0d['statusText']);const _0x4f31af=await _0xfb6d0d[_0x282872(0xd7b)](),_0x4f651f=getGeminiResponseText(_0x4f31af),_0x23359b=_0x4f651f[_0x282872(0xe9f)](/(\[[\s\S]*\])/);if(!_0x23359b||!_0x23359b[0x0])throw new Error(_0x282872(0x851)+_0x4f651f);const _0x16b73f=_0x23359b[0x0];let _0x599baa;try{_0x599baa=JSON[_0x282872(0xb0c)](_0x16b73f);}catch(_0x50513d){throw new Error(_0x282872(0x6cf)+_0x50513d['message']+_0x282872(0x779)+_0x4f651f);}_0x17e10c[_0x282872(0xb43)]=_0x599baa[_0x282872(0x796)](_0x1bc77e=>({'id':Date[_0x282872(0x1182)]()+Math[_0x282872(0x36d)](),'title':_0x1bc77e['title'],'content':_0x1bc77e[_0x282872(0x9a5)],'timestamp':Date['now']()})),await _0x2e83f8[_0x282872(0x737)][_0x282872(0xe3c)](_0x17e10c),await _0x35ed48();}catch(_0x4c1011){console[_0x282872(0x1c1)](_0x282872(0x4a9),_0x4c1011),await _0x2fb06(_0x282872(0x334),'无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20'+_0x4c1011['message']);}}async function _0x1caf07(){const _0x3fbc79=_0x241b18;if(!_0x698363)return;const _0x168c7b=_0x5de8b7[_0x3fbc79(0x737)][_0x698363];if(!_0x168c7b)return;await _0x2fb06(_0x3fbc79(0x63d),'正在请求“'+_0x168c7b[_0x3fbc79(0x278)]+'”写一篇新日记...');const {proxyUrl:_0x360aca,apiKey:_0x2a7993,model:_0x126677}=_0x5de8b7[_0x3fbc79(0x89c)];if(!_0x360aca||!_0x2a7993||!_0x126677)return;const _0x45418a=_0x5de8b7['qzoneSettings']['nickname']==='{{user}}'||!_0x5de8b7[_0x3fbc79(0x1c5)][_0x3fbc79(0xa33)]?'用户':_0x5de8b7[_0x3fbc79(0x1c5)][_0x3fbc79(0xa33)],_0x88b047=_0x168c7b[_0x3fbc79(0xe21)]&&_0x168c7b['longTermMemory'][_0x3fbc79(0x594)]>0x0?_0x168c7b[_0x3fbc79(0xe21)][_0x3fbc79(0x796)](_0x188826=>_0x3fbc79(0xd12)+_0x497f2b(_0x188826[_0x3fbc79(0x702)])+')\x20'+_0x188826['content'])['join']('\x0a'):'无',_0x494fba=_0x168c7b[_0x3fbc79(0x761)][_0x3fbc79(0xb2e)]||0xa,_0x87d933=_0x168c7b[_0x3fbc79(0x49e)]['slice'](-_0x494fba)[_0x3fbc79(0x796)](_0x3a2603=>(_0x3a2603['role']===_0x3fbc79(0x21c)?_0x45418a:_0x168c7b[_0x3fbc79(0x278)])+':\x20'+String(_0x3a2603[_0x3fbc79(0x9a5)])[_0x3fbc79(0x8d4)](0x0,0x1e)+'...')['join']('\x0a'),_0x135dcf=(_0x168c7b[_0x3fbc79(0x761)][_0x3fbc79(0xa17)]||[])[_0x3fbc79(0x796)](_0x40c18d=>_0x5de8b7[_0x3fbc79(0xca)][_0x3fbc79(0xe79)](_0x484d56=>_0x484d56['id']===_0x40c18d))[_0x3fbc79(0x138)](Boolean)[_0x3fbc79(0x796)](_0x15c97c=>'\x0a##\x20世界书《'+_0x15c97c[_0x3fbc79(0x278)]+_0x3fbc79(0x63a)+_0x15c97c['content']['filter'](_0x4af006=>_0x4af006[_0x3fbc79(0xc34)])[_0x3fbc79(0x796)](_0x5f2595=>'-\x20'+_0x5f2595[_0x3fbc79(0x9a5)])[_0x3fbc79(0xa4b)]('\x0a'))[_0x3fbc79(0xa4b)](''),_0x48b0b6=_0x3fbc79(0xdc)+_0x168c7b[_0x3fbc79(0x278)]+_0x3fbc79(0xc08)+new Date()['toLocaleDateString']('zh-CN')+_0x3fbc79(0xa1d)+_0x168c7b[_0x3fbc79(0x761)][_0x3fbc79(0x8d5)]+_0x3fbc79(0x63c)+_0x88b047+'\x0a'+_0x135dcf+_0x3fbc79(0x11ce)+_0x45418a+_0x3fbc79(0x1bc)+_0x87d933+_0x3fbc79(0x11e0);try{const _0x6936ca=[{'role':_0x3fbc79(0x21c),'content':_0x3fbc79(0x812)}];let _0x46b657=_0x360aca[_0x3fbc79(0x3ad)](_0x3fbc79(0xb9b)),_0x24d568=_0x4a90fe(_0x126677,_0x2a7993,_0x48b0b6,_0x6936ca);const _0x324d87=_0x46b657?await fetch(_0x24d568['url'],_0x24d568[_0x3fbc79(0x1cc)]):await fetch(_0x360aca+_0x3fbc79(0x8fd),{'method':'POST','headers':{'Content-Type':_0x3fbc79(0x35c),'Authorization':_0x3fbc79(0xdaf)+_0x2a7993},'body':JSON[_0x3fbc79(0x313)]({'model':_0x126677,'messages':[{'role':_0x3fbc79(0xf72),'content':_0x48b0b6},..._0x6936ca],'temperature':_0x5de8b7[_0x3fbc79(0x2df)][_0x3fbc79(0xe66)]||0.95})});if(!_0x324d87['ok'])throw new Error(_0x3fbc79(0x307)+_0x324d87['statusText']);const _0x36b040=await _0x324d87[_0x3fbc79(0xd7b)](),_0x1beada=getGeminiResponseText(_0x36b040),_0x3acbc6=_0x1beada[_0x3fbc79(0xe9f)](/(\[[\s\S]*\])/);if(!_0x3acbc6||!_0x3acbc6[0x0])throw new Error(_0x3fbc79(0x851)+_0x1beada);const _0x2ee2a5=_0x3acbc6[0x0];let _0x1b5a1f;try{_0x1b5a1f=JSON[_0x3fbc79(0xb0c)](_0x2ee2a5)[0x0];}catch(_0x51f49f){throw new Error(_0x3fbc79(0x6cf)+_0x51f49f[_0x3fbc79(0x4bc)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x1beada);}if(!_0x168c7b[_0x3fbc79(0xb43)])_0x168c7b[_0x3fbc79(0xb43)]=[];_0x168c7b[_0x3fbc79(0xb43)][_0x3fbc79(0xf5)]({'id':Date[_0x3fbc79(0x1182)](),'title':_0x1b5a1f[_0x3fbc79(0x740)],'content':_0x1b5a1f[_0x3fbc79(0x9a5)],'timestamp':Date[_0x3fbc79(0x1182)]()}),await _0x2e83f8[_0x3fbc79(0x737)][_0x3fbc79(0xe3c)](_0x168c7b),await _0x35ed48();}catch(_0x10b86b){console[_0x3fbc79(0x1c1)](_0x3fbc79(0x616),_0x10b86b),await _0x2fb06(_0x3fbc79(0x334),_0x3fbc79(0xed2)+_0x10b86b[_0x3fbc79(0x4bc)]);}}function _0x35ed48(){const _0x1ad1f3=_0x241b18,_0x4c867c=document[_0x1ad1f3(0x11e3)](_0x1ad1f3(0xc1a));_0x4c867c[_0x1ad1f3(0x595)]='';const _0x533beb=_0x5de8b7[_0x1ad1f3(0x737)][_0x698363],_0x3a07fa=(_0x533beb['diary']||[])[_0x1ad1f3(0xa6c)]()[_0x1ad1f3(0x107)]();if(_0x3a07fa[_0x1ad1f3(0x594)]===0x0){_0x4c867c[_0x1ad1f3(0x595)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>';return;}_0x3a07fa[_0x1ad1f3(0x494)](_0x1063a1=>{const _0xe7e0e6=_0x1ad1f3,_0x2db546=document['createElement'](_0xe7e0e6(0x1285));_0x2db546[_0xe7e0e6(0x3db)]=_0xe7e0e6(0x645),_0x2db546['innerHTML']=_0xe7e0e6(0x10d2)+_0x1063a1['title']+_0xe7e0e6(0x3ff)+new Date(_0x1063a1[_0xe7e0e6(0x702)])['toLocaleDateString']()+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2db546[_0xe7e0e6(0x4b8)](_0xe7e0e6(0x1041),()=>_0x61d881(_0x1063a1['id'])),_0xcb6204(_0x2db546,()=>_0x27cd86(_0x1063a1['id'])),_0x4c867c['appendChild'](_0x2db546);});}async function _0x61d881(_0x293dcd){const _0x505cc8=_0x241b18,_0x44850a=_0x5de8b7[_0x505cc8(0x737)][_0x698363];if(!_0x44850a||!_0x44850a[_0x505cc8(0xb43)])return;const _0x192d22=_0x44850a[_0x505cc8(0xb43)][_0x505cc8(0xe79)](_0x496377=>_0x496377['id']===_0x293dcd);if(_0x192d22){_0x4f0a42=_0x192d22;const _0x5c6ac8=document[_0x505cc8(0x11e3)](_0x505cc8(0x1276)),_0x37445e=document[_0x505cc8(0x11e3)](_0x505cc8(0xd1f)),_0x3f0e59=document[_0x505cc8(0x11e3)](_0x505cc8(0xc04));_0x5c6ac8[_0x505cc8(0x300)]=_0x192d22[_0x505cc8(0x740)];const _0x3fcd68=_0x5a9a9e(_0x192d22[_0x505cc8(0x9a5)])['split']('\x0a')[_0x505cc8(0x796)](_0x43ee22=>_0x505cc8(0xbdf)+(_0x43ee22||_0x505cc8(0x1f2))+_0x505cc8(0xdc8))[_0x505cc8(0xa4b)]('');_0x37445e[_0x505cc8(0x595)]=_0x3fcd68;const _0x5cb2d8=await _0x2e83f8['favorites']['where']({'type':'char_diary','content.id':_0x293dcd})[_0x505cc8(0x12c1)]();_0x3f0e59[_0x505cc8(0x505)][_0x505cc8(0xe7e)](_0x505cc8(0x1fc),!!_0x5cb2d8),_0x5a5fee('char-diary-detail-screen');}}async function _0x15d9fe(){const _0x40bdd7=_0x241b18;if(!_0x4f0a42||!_0x698363)return;const _0x3531e9=_0x4f0a42,_0x26c000=_0x5de8b7[_0x40bdd7(0x737)][_0x698363],_0xa3dbdd=document[_0x40bdd7(0x11e3)](_0x40bdd7(0xc04)),_0x38b31c=await _0x2e83f8[_0x40bdd7(0xc3e)]['where']({'type':_0x40bdd7(0x759),'content.id':_0x3531e9['id']})['first']();if(_0x38b31c)await _0x2e83f8[_0x40bdd7(0xc3e)][_0x40bdd7(0xc0c)](_0x38b31c['id']),_0xa3dbdd['classList'][_0x40bdd7(0x957)](_0x40bdd7(0x1fc)),await _0x2fb06('操作成功',_0x40bdd7(0x22b));else{const _0x2f4878={'type':_0x40bdd7(0x759),'content':{'id':_0x3531e9['id'],'title':_0x3531e9[_0x40bdd7(0x740)],'content':_0x3531e9['content'],'timestamp':_0x3531e9[_0x40bdd7(0x702)],'characterId':_0x698363,'characterName':_0x26c000[_0x40bdd7(0x278)]},'timestamp':Date[_0x40bdd7(0x1182)]()};await _0x2e83f8['favorites']['add'](_0x2f4878),_0xa3dbdd[_0x40bdd7(0x505)]['add'](_0x40bdd7(0x1fc)),await _0x2fb06(_0x40bdd7(0x1010),_0x40bdd7(0x599));}}async function _0x131b68(){const _0x16f74a=_0x241b18;if(!_0x3dcd61||!_0x698363)return;const _0x3a3ef7=_0x3dcd61,_0x103105=_0x5de8b7['chats'][_0x698363],_0x39e632=document['getElementById'](_0x16f74a(0xeb9)),_0x559a56=await _0x2e83f8[_0x16f74a(0xc3e)][_0x16f74a(0x129e)]({'type':_0x16f74a(0x503),'content.id':_0x3a3ef7['id']})['first']();if(_0x559a56)await _0x2e83f8[_0x16f74a(0xc3e)][_0x16f74a(0xc0c)](_0x559a56['id']),_0x39e632['classList'][_0x16f74a(0x957)](_0x16f74a(0x1fc)),await _0x2fb06(_0x16f74a(0x1010),_0x16f74a(0x22b));else{const _0xa87067={'type':_0x16f74a(0x503),'content':{'id':_0x3a3ef7['id'],'title':_0x3a3ef7[_0x16f74a(0x740)],'content':_0x3a3ef7[_0x16f74a(0x9a5)],'timestamp':_0x3a3ef7[_0x16f74a(0x702)],'characterId':_0x698363,'characterName':_0x103105['name']},'timestamp':Date[_0x16f74a(0x1182)]()};await _0x2e83f8[_0x16f74a(0xc3e)]['add'](_0xa87067),_0x39e632['classList']['add'](_0x16f74a(0x1fc)),await _0x2fb06(_0x16f74a(0x1010),_0x16f74a(0x599));}}async function _0x27cd86(_0x1d8847){const _0x46a796=_0x241b18,_0x58d2a2=await _0x58fd60(_0x46a796(0x1065),'确定要删除这篇日记吗？',{'confirmButtonClass':'btn-danger'});if(_0x58d2a2){const _0x1f3ca5=_0x5de8b7[_0x46a796(0x737)][_0x698363];_0x1f3ca5[_0x46a796(0xb43)]=_0x1f3ca5[_0x46a796(0xb43)][_0x46a796(0x138)](_0x4c8433=>_0x4c8433['id']!==_0x1d8847),await _0x2e83f8[_0x46a796(0x737)][_0x46a796(0xe3c)](_0x1f3ca5),_0x35ed48();}}async function _0x29cf60(){const _0x59f930=_0x241b18,_0x355ccd=document[_0x59f930(0x11e3)](_0x59f930(0xa6d));_0x355ccd[_0x59f930(0x595)]='';const _0x13cb37=_0x5de8b7['chats'][_0x698363];if(!_0x13cb37)return;const _0x1b3cb9=_0x13cb37[_0x59f930(0x761)][_0x59f930(0xca7)]||(_0x5de8b7[_0x59f930(0x1c5)][_0x59f930(0xa33)]||'我'),_0x3419bc=_0x13cb37[_0x59f930(0x49e)][_0x59f930(0x138)](_0xd7293c=>!_0xd7293c[_0x59f930(0xbf5)])[_0x59f930(0xa6c)](-0x1)[0x0]||{'content':'...'};let _0x398879='...';if(_0x3419bc){if(typeof _0x3419bc[_0x59f930(0x9a5)]===_0x59f930(0x10d7))_0x398879=_0x3419bc[_0x59f930(0x9a5)];else{if(Array[_0x59f930(0xb7b)](_0x3419bc['content'])&&_0x3419bc[_0x59f930(0x9a5)][0x0]?.[_0x59f930(0xa20)]===_0x59f930(0x488))_0x398879=_0x59f930(0xd17);else{if(_0x3419bc[_0x59f930(0xa20)]){const _0x176bd2={'voice_message':_0x59f930(0x2a9),'transfer':_0x59f930(0x5f3),'ai_image':'[图片]'};_0x398879=_0x176bd2[_0x3419bc['type']]||'['+_0x3419bc[_0x59f930(0xa20)]+']';}}}}const _0x33bf57=_0x13cb37[_0x59f930(0x761)]['myAvatar']||_0x3d2e44,_0x15e999=_0x13cb37[_0x59f930(0x761)][_0x59f930(0x11ed)]||'';let _0xc0b698;_0x15e999?_0xc0b698=_0x59f930(0xe36)+_0x33bf57+_0x59f930(0xa6)+_0x15e999+_0x59f930(0x816):_0xc0b698=_0x59f930(0xa6e)+_0x33bf57+_0x59f930(0xaae);const _0x9c67de=document[_0x59f930(0x383)](_0x59f930(0x1285));_0x9c67de[_0x59f930(0x3db)]=_0x59f930(0x7e5),_0x9c67de[_0x59f930(0xaca)]['conversationIndex']='-1',_0x9c67de[_0x59f930(0x595)]=_0x59f930(0x94f)+_0xc0b698+_0x59f930(0x1309)+_0x1b3cb9+_0x59f930(0xd5e)+String(_0x398879)[_0x59f930(0x8d4)](0x0,0x14)+_0x59f930(0x10ca),_0x355ccd[_0x59f930(0x120c)](_0x9c67de);const _0x61f883=await _0x2e83f8['npcs'][_0x59f930(0x508)](),_0x2b2756=new Map(_0x61f883['map'](_0x56ea7b=>[_0x56ea7b[_0x59f930(0x278)],_0x56ea7b])),_0x27d7ff=_0x13cb37[_0x59f930(0x33c)]||[];if(_0x27d7ff[_0x59f930(0x594)]===0x0&&!_0x9c67de){_0x355ccd[_0x59f930(0x595)]=_0x59f930(0xb69);return;}_0x27d7ff['forEach']((_0x4f45c6,_0x2fea18)=>{const _0x81e8ea=_0x59f930;if(_0x4f45c6['type']===_0x81e8ea(0x1a1))return;const _0x2bd56d=document[_0x81e8ea(0x383)](_0x81e8ea(0x1285));_0x2bd56d[_0x81e8ea(0x3db)]=_0x81e8ea(0x7e5),_0x2bd56d[_0x81e8ea(0xaca)][_0x81e8ea(0xc8b)]=_0x2fea18;let _0x91fad5,_0x42b026,_0x71cc95;if(_0x4f45c6[_0x81e8ea(0xa20)]===_0x81e8ea(0x264)){_0x71cc95=_0x4f45c6[_0x81e8ea(0x25a)]+_0x81e8ea(0x11dc),_0x91fad5=_0x4f45c6[_0x81e8ea(0x543)][_0x81e8ea(0xa6c)](-0x1)[0x0]||{'content':_0x81e8ea(0x6cb)};const _0x60f6f4=_0x81e8ea(0x3fc)+_0x4f45c6['groupName']+'\x27',_0x59e1d2=_0x5de8b7[_0x81e8ea(0x2df)][_0x81e8ea(0xbd4)]?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x60f6f4):_0x1f1b42;_0x42b026=_0x81e8ea(0xada)+_0x59e1d2+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>';}else{_0x71cc95=_0x4f45c6['participant'][_0x81e8ea(0x278)],_0x91fad5=_0x4f45c6[_0x81e8ea(0x543)][_0x81e8ea(0xa6c)](-0x1)[0x0]||{'content':_0x81e8ea(0x6cb)};const _0x7e8e45=_0x2b2756['get'](_0x71cc95);let _0x347b7a=_0x7e8e45&&_0x7e8e45[_0x81e8ea(0x525)]?_0x7e8e45[_0x81e8ea(0x525)]:_0x5de8b7[_0x81e8ea(0x2df)][_0x81e8ea(0xbd4)]?_0x81e8ea(0x35d)+encodeURIComponent(_0x4f45c6[_0x81e8ea(0xced)][_0x81e8ea(0x114c)]||'anime\x20person'):_0x4d9574;_0x42b026=_0x81e8ea(0xada)+_0x347b7a+_0x81e8ea(0xe88);}let _0x56995b=_0x81e8ea(0x6cb);_0x91fad5&&_0x91fad5['content']&&(_0x56995b=_0x91fad5[_0x81e8ea(0x9a5)]),_0x2bd56d['innerHTML']=_0x81e8ea(0x8a5)+_0x42b026+_0x81e8ea(0x1176)+_0x71cc95+_0x81e8ea(0x44b)+String(_0x56995b)[_0x81e8ea(0x8d4)](0x0,0x14)+_0x81e8ea(0x31f),_0x355ccd['appendChild'](_0x2bd56d);});}async function _0x11082d(){const _0x4839fd=_0x241b18;if(!_0x698363)return;const _0x3011d2=_0x5de8b7['chats'][_0x698363];if(!_0x3011d2)return;await _0x2fb06('请稍候...',_0x4839fd(0x395)+_0x3011d2[_0x4839fd(0x278)]+_0x4839fd(0x10d));const {proxyUrl:_0x7587d7,apiKey:_0x6c0f44,model:_0xcfa8f9}=_0x5de8b7[_0x4839fd(0x89c)];if(!_0x7587d7||!_0x6c0f44||!_0xcfa8f9){alert('请先在API设置中配置好API信息。');return;}const _0x56d906=await _0x2e83f8[_0x4839fd(0xf00)][_0x4839fd(0x508)](),_0x151cf8=_0x56d906[_0x4839fd(0x138)](_0x5942a6=>_0x5942a6[_0x4839fd(0x131)]&&_0x5942a6[_0x4839fd(0x131)][_0x4839fd(0x3ad)](_0x698363));let _0x503e49='#\x20你的社交圈\x20(绑定的NPC)\x0a';_0x151cf8[_0x4839fd(0x594)]>0x0?(_0x503e49+='这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a',_0x151cf8[_0x4839fd(0x494)](_0x2e2658=>{const _0x1a24b8=_0x4839fd;_0x503e49+='-\x20**姓名**:\x20'+_0x2e2658[_0x1a24b8(0x278)]+'\x0a\x20\x20-\x20**人设**:\x20'+_0x2e2658['persona']+'\x0a';})):_0x503e49+=_0x4839fd(0x14f);const _0x1ca025=_0x5de8b7[_0x4839fd(0x1c5)][_0x4839fd(0xa33)]===_0x4839fd(0x833)||!_0x5de8b7[_0x4839fd(0x1c5)]['nickname']?'用户':_0x5de8b7['qzoneSettings'][_0x4839fd(0xa33)],_0x126db4=_0x3011d2['settings'][_0x4839fd(0xca7)]||_0x1ca025,_0x5c33b2=_0x3011d2[_0x4839fd(0xe21)]&&_0x3011d2[_0x4839fd(0xe21)][_0x4839fd(0x594)]>0x0?_0x3011d2['longTermMemory'][_0x4839fd(0x796)](_0x50319c=>_0x4839fd(0xd12)+_0x497f2b(_0x50319c['timestamp'])+')\x20'+_0x50319c['content'])['join']('\x0a'):'无',_0xf955e7=_0x3011d2[_0x4839fd(0x761)]['maxMemory']||0xa,_0x132057=_0x3011d2['history']['slice'](-_0xf955e7)['map'](_0x1fa0fc=>(_0x1fa0fc[_0x4839fd(0xba4)]===_0x4839fd(0x21c)?_0x126db4:_0x3011d2[_0x4839fd(0x278)])+':\x20'+String(_0x1fa0fc[_0x4839fd(0x9a5)])[_0x4839fd(0x8d4)](0x0,0x1e)+'...')['join']('\x0a'),_0x43a149=(_0x3011d2['settings'][_0x4839fd(0xa17)]||[])[_0x4839fd(0x796)](_0x1395e3=>_0x5de8b7[_0x4839fd(0xca)]['find'](_0x1cf18d=>_0x1cf18d['id']===_0x1395e3))[_0x4839fd(0x138)](Boolean)[_0x4839fd(0x796)](_0x2d7731=>'\x0a##\x20世界书《'+_0x2d7731['name']+_0x4839fd(0x846)+_0x2d7731[_0x4839fd(0x9a5)]['filter'](_0x346ba9=>_0x346ba9[_0x4839fd(0xc34)])['map'](_0x5634e5=>'-\x20'+_0x5634e5[_0x4839fd(0x9a5)])[_0x4839fd(0xa4b)]('\x0a'))[_0x4839fd(0xa4b)](''),_0x9059b7=_0x3011d2[_0x4839fd(0x697)]||_0x3011d2['name'],_0x487140=_0xb76b68(_0x3011d2),_0x2f86f3='\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“'+_0x3011d2[_0x4839fd(0x278)]+'”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22'+_0x9059b7+_0x4839fd(0xbcf)+_0x9059b7+_0x4839fd(0x409)+_0x9059b7+_0x4839fd(0xa46)+_0x3011d2[_0x4839fd(0x761)][_0x4839fd(0x8d5)]+'\x0a-\x20**你的长期记忆**:\x20'+_0x5c33b2+_0x4839fd(0xd66)+_0x43a149+_0x4839fd(0xb8b)+_0x132057+'\x0a'+_0x503e49+_0x4839fd(0xa01)+_0x487140+_0x4839fd(0x128d);try{const _0x3b853f=[{'role':'user','content':_0x4839fd(0x9c6)}];let _0x305f28=_0x7587d7[_0x4839fd(0x3ad)](_0x4839fd(0xb9b)),_0x14df17=_0x4a90fe(_0xcfa8f9,_0x6c0f44,_0x2f86f3,_0x3b853f);const _0x5a42ac=_0x305f28?await fetch(_0x14df17[_0x4839fd(0x10ac)],_0x14df17[_0x4839fd(0x1cc)]):await fetch(_0x7587d7+_0x4839fd(0x8fd),{'method':'POST','headers':{'Content-Type':_0x4839fd(0x35c),'Authorization':'Bearer\x20'+_0x6c0f44},'body':JSON[_0x4839fd(0x313)]({'model':_0xcfa8f9,'messages':[{'role':_0x4839fd(0xf72),'content':_0x2f86f3},..._0x3b853f],'temperature':_0x5de8b7['globalSettings'][_0x4839fd(0xe66)]||0.9})});if(!_0x5a42ac['ok'])throw new Error(_0x4839fd(0x307)+_0x5a42ac[_0x4839fd(0xfcf)]);const _0x45e645=await _0x5a42ac[_0x4839fd(0xd7b)](),_0x927490=getGeminiResponseText(_0x45e645),_0x6832e4=_0x927490[_0x4839fd(0xe9f)](/(\[[\s\S]*\])/);if(!_0x6832e4||!_0x6832e4[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x927490);const _0x1132d1=_0x6832e4[0x0];let _0x5ee460;try{_0x5ee460=JSON[_0x4839fd(0xb0c)](_0x1132d1);}catch(_0x56aa90){throw new Error(_0x4839fd(0x6cf)+_0x56aa90[_0x4839fd(0x4bc)]+_0x4839fd(0x779)+_0x927490);}_0x3011d2[_0x4839fd(0x33c)]=_0x5ee460,await _0x2e83f8[_0x4839fd(0x737)][_0x4839fd(0xe3c)](_0x3011d2),await _0x29cf60();const _0x4c0c26={'role':_0x4839fd(0xf72),'content':_0x4839fd(0xa12),'timestamp':Date[_0x4839fd(0x1182)](),'isHidden':!![]};_0x3011d2[_0x4839fd(0x49e)]['push'](_0x4c0c26),await _0x2e83f8[_0x4839fd(0x737)][_0x4839fd(0xe3c)](_0x3011d2),_0x14a9f0();}catch(_0x1c64dc){console['error']('生成模拟聊天失败:',_0x1c64dc),await _0x2fb06('生成失败',_0x4839fd(0xe00)+_0x1c64dc[_0x4839fd(0x4bc)]);}}async function _0x500f54(){const _0x3bc2eb=_0x241b18;if(!_0x698363)return;const _0x5e1ef5=_0x5de8b7['chats'][_0x698363];if(!_0x5e1ef5)return;try{const {proxyUrl:_0x2a70bb,apiKey:_0x5c3bf4,model:_0x1d23fd}=_0x5de8b7[_0x3bc2eb(0x89c)];if(!_0x2a70bb||!_0x5c3bf4||!_0x1d23fd)throw new Error(_0x3bc2eb(0x7f3));const _0x187dce=parseInt(_0x5e1ef5[_0x3bc2eb(0x761)][_0x3bc2eb(0xb2e)])||0xa,_0x6102e3=_0x5e1ef5[_0x3bc2eb(0x49e)][_0x3bc2eb(0xa6c)](-_0x187dce),_0x108bcb=_0x5e1ef5[_0x3bc2eb(0x761)][_0x3bc2eb(0xca7)]||'我',_0x11133f=_0x5e1ef5['settings'][_0x3bc2eb(0x10c5)]||'用户',_0x16bffb=_0x3bc2eb(0xcb7)+(_0x5e1ef5[_0x3bc2eb(0xe21)]&&_0x5e1ef5[_0x3bc2eb(0xe21)][_0x3bc2eb(0x594)]>0x0?_0x5e1ef5[_0x3bc2eb(0xe21)][_0x3bc2eb(0x796)](_0x3147a9=>'-\x20'+_0x3147a9[_0x3bc2eb(0x9a5)])[_0x3bc2eb(0xa4b)]('\x0a'):_0x3bc2eb(0x12cc));let _0x170a26='';if(_0x5e1ef5[_0x3bc2eb(0x761)][_0x3bc2eb(0xa17)]&&_0x5e1ef5[_0x3bc2eb(0x761)][_0x3bc2eb(0xa17)][_0x3bc2eb(0x594)]>0x0){const _0x18102f=_0x5e1ef5[_0x3bc2eb(0x761)][_0x3bc2eb(0xa17)][_0x3bc2eb(0x796)](_0x557851=>{const _0x5aaa06=_0x3bc2eb,_0x137ee0=_0x5de8b7[_0x5aaa06(0xca)]['find'](_0x209336=>_0x209336['id']===_0x557851);if(!_0x137ee0||!Array['isArray'](_0x137ee0[_0x5aaa06(0x9a5)]))return'';const _0x1b4560=_0x137ee0[_0x5aaa06(0x9a5)][_0x5aaa06(0x138)](_0xab3a26=>_0xab3a26[_0x5aaa06(0xc34)]!==![])[_0x5aaa06(0x796)](_0x152e31=>_0x5aaa06(0xec3)+(_0x152e31[_0x5aaa06(0xebd)]||'无备注')+_0x5aaa06(0x2a5)+_0x152e31[_0x5aaa06(0x9a5)])['join']('');return _0x1b4560?_0x5aaa06(0xe49)+_0x137ee0[_0x5aaa06(0x278)]+'\x0a'+_0x1b4560:'';})[_0x3bc2eb(0x138)](Boolean)[_0x3bc2eb(0xa4b)]('');_0x18102f&&(_0x170a26=_0x3bc2eb(0x45e)+_0x18102f+'\x0a');}const _0x462138=_0x57277b(_0x5e1ef5,0x3,_0x3bc2eb(0x1059)),_0x15f6d3=_0x57277b(_0x5e1ef5,0x6,'hours'),_0x18cec3=_0x57277b(_0x5e1ef5,0x9,_0x3bc2eb(0x1059)),_0x929267=_0x57277b(_0x5e1ef5,0x1,'days'),_0x989d1d=_0x57277b(_0x5e1ef5,0x3,_0x3bc2eb(0xb95)),_0x7af3db=_0x57277b(_0x5e1ef5,0x7,_0x3bc2eb(0xb95));let _0x22c72e='';if(_0x462138||_0x15f6d3||_0x18cec3||_0x929267||_0x989d1d||_0x7af3db){_0x22c72e+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x462138)_0x22c72e+=_0x462138;if(_0x15f6d3)_0x22c72e+=_0x15f6d3;if(_0x18cec3)_0x22c72e+=_0x18cec3;if(_0x462138||_0x15f6d3||_0x18cec3)_0x22c72e+='\x0a';if(_0x929267)_0x22c72e+=_0x929267;if(_0x989d1d)_0x22c72e+=_0x989d1d;if(_0x7af3db)_0x22c72e+=_0x7af3db;}const _0x4d4e66=_0x5342bb(_0x5e1ef5),_0x30f7a3=_0x3bc2eb(0xd55)+_0x5e1ef5[_0x3bc2eb(0x697)]+_0x3bc2eb(0x1f5)+_0x5e1ef5['settings'][_0x3bc2eb(0x8d5)]+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x4d4e66+_0x3bc2eb(0xca0)+_0x11133f+_0x3bc2eb(0x1305)+_0x5e1ef5['originalName']+_0x3bc2eb(0x885)+_0x108bcb+'\x22\x0a'+_0x170a26+'\x0a'+_0x16bffb+'\x0a'+_0x22c72e+_0x3bc2eb(0xa0)+_0x6102e3[_0x3bc2eb(0x796)](_0x517d60=>(_0x517d60[_0x3bc2eb(0xba4)]===_0x3bc2eb(0x21c)?_0x108bcb:_0x5e1ef5[_0x3bc2eb(0x278)])+':\x20'+String(_0x517d60[_0x3bc2eb(0x9a5)]))['join']('\x0a')+'\x0a\x0a现在，请继续这场对话。\x0a',_0x2d2290=_0x6102e3['map'](_0x5e1c9b=>({'role':_0x5e1c9b[_0x3bc2eb(0xba4)],'content':(_0x5e1c9b[_0x3bc2eb(0xba4)]===_0x3bc2eb(0x21c)?_0x108bcb:_0x5e1ef5[_0x3bc2eb(0x278)])+':\x20'+String(_0x5e1c9b[_0x3bc2eb(0x9a5)])}));let _0x355e3d=_0x2a70bb['includes'](_0x3bc2eb(0xb9b)),_0x1fd80d=_0x4a90fe(_0x1d23fd,_0x5c3bf4,_0x30f7a3,_0x2d2290);const _0x4b4967=_0x355e3d?await fetch(_0x1fd80d[_0x3bc2eb(0x10ac)],_0x1fd80d[_0x3bc2eb(0x1cc)]):await fetch(_0x2a70bb+_0x3bc2eb(0x8fd),{'method':_0x3bc2eb(0x1128),'headers':{'Content-Type':_0x3bc2eb(0x35c),'Authorization':_0x3bc2eb(0xdaf)+_0x5c3bf4},'body':JSON[_0x3bc2eb(0x313)]({'model':_0x1d23fd,'messages':[{'role':_0x3bc2eb(0xf72),'content':_0x30f7a3},..._0x2d2290],'temperature':_0x5de8b7['globalSettings'][_0x3bc2eb(0xe66)]||0.8})});if(!_0x4b4967['ok'])throw new Error(_0x3bc2eb(0xf8b)+(await _0x4b4967[_0x3bc2eb(0xd7b)]())[_0x3bc2eb(0x1c1)][_0x3bc2eb(0x4bc)]);const _0x55caea=await _0x4b4967[_0x3bc2eb(0xd7b)](),_0x4414d7=getGeminiResponseText(_0x55caea),_0x29e7c=_0x30c9b6(_0x4414d7);if(!_0x29e7c||_0x29e7c['length']===0x0)throw new Error(_0x3bc2eb(0x67f));let _0x14a1eb=0x0,_0x1d2887=Date['now']();for(const _0x31ed39 of _0x29e7c){const _0x4158dd={'role':_0x3bc2eb(0x1119),'senderName':_0x5e1ef5[_0x3bc2eb(0x697)],'timestamp':_0x1d2887++};let _0x4782b2=null;switch(_0x31ed39['type']){case'text':_0x4782b2={..._0x4158dd,'content':String(_0x31ed39[_0x3bc2eb(0x9a5)]||_0x31ed39[_0x3bc2eb(0x4bc)])};break;case'sticker':if(_0x31ed39[_0x3bc2eb(0xb36)]){const _0x4db6f2=_0x5de8b7['userStickers'][_0x3bc2eb(0xe79)](_0x4202a6=>_0x4202a6[_0x3bc2eb(0x278)]===_0x31ed39[_0x3bc2eb(0xb36)]);_0x4db6f2?_0x4782b2={..._0x4158dd,'type':_0x3bc2eb(0x87b),'content':_0x4db6f2[_0x3bc2eb(0x10ac)],'meaning':_0x4db6f2[_0x3bc2eb(0x278)]}:(console[_0x3bc2eb(0x6b0)](_0x3bc2eb(0x772)+_0x31ed39[_0x3bc2eb(0xb36)]+'\x22'),_0x4782b2={..._0x4158dd,'type':_0x3bc2eb(0x1197),'content':_0x3bc2eb(0x119f)+_0x31ed39[_0x3bc2eb(0xb36)]+']'});}else console[_0x3bc2eb(0x6b0)]('AI\x20(CPhone)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。',_0x31ed39),_0x4782b2={..._0x4158dd,'type':_0x3bc2eb(0x87b),'content':_0x31ed39[_0x3bc2eb(0x10ac)],'meaning':_0x3bc2eb(0x10df)};break;}_0x4782b2&&(_0x5e1ef5['history'][_0x3bc2eb(0xf5)](_0x4782b2),_0x14a1eb++);}_0x14a1eb>0x0&&(_0x5e1ef5[_0x3bc2eb(0xc3a)]=(_0x5e1ef5[_0x3bc2eb(0xc3a)]||0x0)+_0x14a1eb),await _0x2e83f8['chats'][_0x3bc2eb(0xe3c)](_0x5e1ef5),await _0x5ee219(),_0x14a1eb>0x0&&_0x2c799e(_0x5e1ef5['id'],_0x3bc2eb(0xc12)+_0x14a1eb+_0x3bc2eb(0x1088));}catch(_0x3be5e4){console[_0x3bc2eb(0x1c1)]('从CPhone推进真实对话失败:',_0x3be5e4),await _0x2fb06('操作失败',_0x3bc2eb(0x366)+_0x3be5e4[_0x3bc2eb(0x4bc)]);}}async function _0x3774d2(){const _0x4bbca8=_0x241b18;if(_0x39fb90||!_0x698363)return;_0x39fb90=!![];const _0x410a2a=document['getElementById'](_0x4bbca8(0x56e)),_0x54defc=_0x5de8b7[_0x4bbca8(0x737)][_0x698363];if(!_0x54defc){_0x39fb90=![];return;}_0x28c761(_0x410a2a,_0x4bbca8(0x10e2));const _0x12011c=_0x410a2a[_0x4bbca8(0x36b)];await new Promise(_0x27a86f=>setTimeout(_0x27a86f,0x1f4));const _0x52e54d=_0x54defc[_0x4bbca8(0x49e)][_0x4bbca8(0x594)],_0x3662b5=_0x5de8b7['globalSettings'][_0x4bbca8(0x896)]||0x32,_0x4ade0e=_0x52e54d-_0xb72583,_0x130b0a=Math[_0x4bbca8(0x45d)](0x0,_0x4ade0e-_0x3662b5),_0x39a492=_0x54defc[_0x4bbca8(0x49e)][_0x4bbca8(0xa6c)](_0x130b0a,_0x4ade0e);_0x313362(_0x410a2a);if(_0x39a492[_0x4bbca8(0x594)]===0x0){_0x39fb90=![];return;}for(const _0x3e2418 of _0x39a492[_0x4bbca8(0x107)]()){const _0x4118e8={..._0x3e2418,'role':_0x3e2418[_0x4bbca8(0xba4)]===_0x4bbca8(0x21c)?_0x4bbca8(0x1119):_0x4bbca8(0x21c)},_0x495f57={'id':'temp_user_chat_mirror','isGroup':![],'name':_0x54defc[_0x4bbca8(0x278)],'settings':{..._0x54defc[_0x4bbca8(0x761)],'myAvatar':_0x54defc['settings'][_0x4bbca8(0x5e0)],'myAvatarFrame':_0x54defc[_0x4bbca8(0x761)][_0x4bbca8(0x1268)],'aiAvatar':_0x54defc['settings'][_0x4bbca8(0xc43)],'aiAvatarFrame':_0x54defc[_0x4bbca8(0x761)][_0x4bbca8(0x11ed)]}},_0x3857a5=await _0xe99b75(_0x4118e8,_0x495f57);_0x3857a5&&_0x410a2a['prepend'](_0x3857a5);}_0xb72583+=_0x39a492[_0x4bbca8(0x594)];const _0x5a8c0e=_0x410a2a['scrollHeight'];_0x410a2a[_0x4bbca8(0x11c7)]=_0x5a8c0e-_0x12011c,_0x39fb90=![];}async function _0x1bab53(_0x35fda3){const _0x3aa151=_0x241b18,_0x28bf61=_0x5de8b7[_0x3aa151(0x737)][_0x698363];if(!_0x28bf61)return;_0x502483=_0x35fda3===-0x1?_0x3aa151(0x1a1):_0x28bf61['simulatedConversations'][_0x35fda3]?.[_0x3aa151(0xa20)];const _0x278428=document[_0x3aa151(0x11e3)]('char-conversation-messages');_0x278428[_0x3aa151(0x595)]='',_0x278428['dataset'][_0x3aa151(0xad7)]=_0x28bf61[_0x3aa151(0x761)]['theme']||_0x3aa151(0xd3);const _0x10b170=document[_0x3aa151(0x11e3)](_0x3aa151(0x1e6))[_0x3aa151(0x505)][_0x3aa151(0x1121)](_0x3aa151(0x251));_0x278428[_0x3aa151(0x794)][_0x3aa151(0x556)]=_0x10b170?_0x3aa151(0x495):_0x3aa151(0x4fa);let _0x50880f,_0x26ece9=[];const _0x525bc1=await _0x2e83f8[_0x3aa151(0xf00)][_0x3aa151(0x508)](),_0x3e83fe=new Map(_0x525bc1[_0x3aa151(0x796)](_0x4a934d=>[_0x4a934d['name'],_0x4a934d]));if(_0x35fda3===-0x1){_0x502483=_0x3aa151(0x1a1);const _0x443433=document[_0x3aa151(0x11e3)](_0x3aa151(0xd84)),_0x4f0e8b=document[_0x3aa151(0x11e3)](_0x3aa151(0x7a3));_0x278428[_0x3aa151(0x595)]='',_0x443433[_0x3aa151(0x300)]=_0x28bf61[_0x3aa151(0x761)][_0x3aa151(0xca7)]||(_0x5de8b7['qzoneSettings'][_0x3aa151(0xa33)]||'我'),_0x4f0e8b[_0x3aa151(0x569)]='与\x20'+(_0x28bf61[_0x3aa151(0x761)][_0x3aa151(0xca7)]||'我')+'\x20的对话\x20(只读)',_0xb72583=0x0,_0x39fb90=![];const _0x4d8347=_0x28bf61['history'],_0x3fa7f7=_0x5de8b7[_0x3aa151(0x2df)][_0x3aa151(0x896)]||0x32,_0x7ace01=_0x4d8347[_0x3aa151(0xa6c)](-_0x3fa7f7);_0x50880f={'id':_0x3aa151(0x7f1),'isGroup':![],'name':_0x28bf61['name'],'settings':{..._0x28bf61['settings'],'myAvatar':_0x28bf61[_0x3aa151(0x761)][_0x3aa151(0x5e0)],'myAvatarFrame':_0x28bf61[_0x3aa151(0x761)][_0x3aa151(0x1268)],'aiAvatar':_0x28bf61[_0x3aa151(0x761)][_0x3aa151(0xc43)],'aiAvatarFrame':_0x28bf61[_0x3aa151(0x761)][_0x3aa151(0x11ed)]}},_0x26ece9=_0x7ace01[_0x3aa151(0x796)](_0x26a640=>({..._0x26a640,'role':_0x26a640[_0x3aa151(0xba4)]===_0x3aa151(0x21c)?_0x3aa151(0x1119):_0x3aa151(0x21c)})),_0xb72583=_0x7ace01[_0x3aa151(0x594)];}else{const _0x1481db=_0x28bf61[_0x3aa151(0x33c)][_0x35fda3];if(!_0x1481db)return;_0x502483=_0x1481db[_0x3aa151(0xa20)];const _0x2df786=document[_0x3aa151(0x11e3)]('char-conversation-partner-name'),_0x240b3f=document[_0x3aa151(0x11e3)](_0x3aa151(0x7a3));if(_0x1481db['type']===_0x3aa151(0x264))_0x2df786['textContent']=_0x1481db[_0x3aa151(0x25a)]+'\x20('+(_0x1481db[_0x3aa151(0x94b)][_0x3aa151(0x594)]+0x1)+')',_0x240b3f['placeholder']='在\x20'+_0x1481db[_0x3aa151(0x25a)]+'\x20中聊天',_0x50880f={'id':'temp_group_chat','isGroup':!![],'name':_0x1481db[_0x3aa151(0x25a)],'originalName':_0x28bf61['originalName'],'members':_0x1481db[_0x3aa151(0x94b)]['map'](_0x4325bc=>{const _0x2bccb1=_0x3aa151,_0x5bb5a0=_0x3e83fe[_0x2bccb1(0x1289)](_0x4325bc[_0x2bccb1(0x278)]);let _0x22597a=_0x5bb5a0&&_0x5bb5a0[_0x2bccb1(0x525)]?_0x5bb5a0['avatar']:_0x5de8b7[_0x2bccb1(0x2df)][_0x2bccb1(0xbd4)]?_0x2bccb1(0x35d)+encodeURIComponent(_0x4325bc[_0x2bccb1(0x114c)]||_0x2bccb1(0xc05)):_0x4d9574;return{'originalName':_0x4325bc[_0x2bccb1(0x278)],'groupNickname':_0x4325bc[_0x2bccb1(0x278)],'avatar':_0x22597a};}),'settings':{..._0x28bf61['settings'],'myNickname':_0x28bf61[_0x3aa151(0x278)],'myAvatar':_0x28bf61['settings'][_0x3aa151(0x5e0)],'myAvatarFrame':_0x28bf61['settings'][_0x3aa151(0x1268)]}};else{_0x2df786[_0x3aa151(0x300)]=_0x1481db[_0x3aa151(0xced)][_0x3aa151(0x278)],_0x240b3f['placeholder']='与\x20'+_0x1481db[_0x3aa151(0xced)]['name']+_0x3aa151(0xfb8);const _0x34d7ca=_0x3e83fe[_0x3aa151(0x1289)](_0x1481db[_0x3aa151(0xced)][_0x3aa151(0x278)]),_0x2e5fa4=_0x34d7ca&&_0x34d7ca[_0x3aa151(0x525)]?_0x34d7ca[_0x3aa151(0x525)]:_0x5de8b7[_0x3aa151(0x2df)][_0x3aa151(0xbd4)]?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x1481db[_0x3aa151(0xced)][_0x3aa151(0x114c)]||_0x3aa151(0xc05)):_0x4d9574;_0x50880f={'id':'temp_npc_chat','isGroup':![],'name':_0x1481db[_0x3aa151(0xced)][_0x3aa151(0x278)],'originalName':_0x28bf61[_0x3aa151(0x697)],'settings':{..._0x28bf61[_0x3aa151(0x761)],'myAvatar':_0x28bf61[_0x3aa151(0x761)][_0x3aa151(0x5e0)],'myAvatarFrame':_0x28bf61[_0x3aa151(0x761)][_0x3aa151(0x1268)],'aiAvatar':_0x2e5fa4,'aiAvatarFrame':''}};}_0x26ece9=_0x1481db[_0x3aa151(0x543)];}for(const _0xfd066 of _0x26ece9){let _0x2f4a56=_0xfd066[_0x3aa151(0xba4)];if(_0x35fda3!==-0x1){const _0x1005c8=_0xfd066[_0x3aa151(0x3ec)]===(_0x28bf61['originalName']||_0x28bf61['name']);_0x2f4a56=_0x1005c8?_0x3aa151(0x21c):_0x3aa151(0x1119);}const _0x309aeb={'role':_0x2f4a56,'senderName':_0xfd066['sender']||(_0x2f4a56==='user'?_0x50880f['settings'][_0x3aa151(0xca7)]:_0x50880f['name']),'timestamp':_0xfd066['timestamp']||Date['now']()+Math[_0x3aa151(0x36d)]()};if(_0xfd066['type']==='sticker'&&_0xfd066['meaning']){const _0x79d7ef=_0x5de8b7['userStickers'][_0x3aa151(0xe79)](_0x48ac60=>_0x48ac60[_0x3aa151(0x278)]===_0xfd066[_0x3aa151(0xb36)]);_0x79d7ef?(_0x309aeb[_0x3aa151(0x9a5)]=_0x79d7ef[_0x3aa151(0x10ac)],_0x309aeb[_0x3aa151(0xb36)]=_0xfd066[_0x3aa151(0xb36)],_0x309aeb[_0x3aa151(0xa20)]=_0x3aa151(0x87b)):(console[_0x3aa151(0x6b0)]('模拟表情含义\x20\x22'+_0xfd066[_0x3aa151(0xb36)]+_0x3aa151(0x123f)),_0x309aeb['content']='[表情:\x20'+_0xfd066[_0x3aa151(0xb36)]+']',_0x309aeb[_0x3aa151(0xa20)]=_0x3aa151(0x1197));}else _0x309aeb[_0x3aa151(0x9a5)]=_0xfd066[_0x3aa151(0x9a5)],_0x309aeb['type']=_0xfd066[_0x3aa151(0xa20)]||_0x3aa151(0x1197);const _0x3e8e55=await _0xe99b75(_0x309aeb,_0x50880f);_0x3e8e55&&_0x278428[_0x3aa151(0x120c)](_0x3e8e55);}_0x5a5fee(_0x3aa151(0x1212)),setTimeout(()=>_0x278428[_0x3aa151(0x11c7)]=_0x278428[_0x3aa151(0x36b)],0x0);}function _0xca4228(){const _0xa43ac4=_0x241b18;document[_0xa43ac4(0x11e3)]('char-qq-transcript-modal')[_0xa43ac4(0x505)][_0xa43ac4(0x957)](_0xa43ac4(0x250));}async function _0xffc4eb(){const _0x4a07c1=_0x241b18;if(!_0x698363)return;const _0xa215af=_0x5de8b7[_0x4a07c1(0x737)][_0x698363];if(!_0xa215af){await _0x2fb06(_0x4a07c1(0x1177),'无法找到当前角色的数据。');return;}await _0x2fb06('请稍候...','正在请求“'+_0xa215af[_0x4a07c1(0x278)]+_0x4a07c1(0x125c));const {proxyUrl:_0x452cb8,apiKey:_0x4ec5ab,model:_0x351f70}=_0x5de8b7[_0x4a07c1(0x89c)];if(!_0x452cb8||!_0x4ec5ab||!_0x351f70){alert(_0x4a07c1(0xace));return;}const _0x43da00=_0x5de8b7[_0x4a07c1(0x1c5)][_0x4a07c1(0xa33)]===_0x4a07c1(0x833)||!_0x5de8b7[_0x4a07c1(0x1c5)][_0x4a07c1(0xa33)]?'用户':_0x5de8b7[_0x4a07c1(0x1c5)]['nickname'],_0x284d8b=_0xa215af[_0x4a07c1(0xe21)]&&_0xa215af[_0x4a07c1(0xe21)][_0x4a07c1(0x594)]>0x0?_0xa215af[_0x4a07c1(0xe21)][_0x4a07c1(0x796)](_0x536cd=>_0x4a07c1(0xd12)+_0x497f2b(_0x536cd['timestamp'])+')\x20'+_0x536cd[_0x4a07c1(0x9a5)])[_0x4a07c1(0xa4b)]('\x0a'):'无',_0x123a9d=_0xa215af[_0x4a07c1(0x761)][_0x4a07c1(0xb2e)]||0xa,_0x2cc128=_0xa215af[_0x4a07c1(0x49e)]['slice'](-_0x123a9d)['map'](_0x3583e5=>(_0x3583e5[_0x4a07c1(0xba4)]===_0x4a07c1(0x21c)?_0x43da00:_0xa215af[_0x4a07c1(0x278)])+':\x20'+String(_0x3583e5[_0x4a07c1(0x9a5)])['substring'](0x0,0x1e)+'...')[_0x4a07c1(0xa4b)]('\x0a'),_0x247214=(_0xa215af[_0x4a07c1(0x761)]['linkedWorldBookIds']||[])[_0x4a07c1(0x796)](_0x1a0e7e=>_0x5de8b7[_0x4a07c1(0xca)][_0x4a07c1(0xe79)](_0xa08873=>_0xa08873['id']===_0x1a0e7e))[_0x4a07c1(0x138)](Boolean)['map'](_0x5539c3=>_0x4a07c1(0x10b5)+_0x5539c3['name']+_0x4a07c1(0x63a)+_0x5539c3[_0x4a07c1(0x9a5)][_0x4a07c1(0x138)](_0x331302=>_0x331302[_0x4a07c1(0xc34)])[_0x4a07c1(0x796)](_0x2cf18d=>'-\x20'+_0x2cf18d[_0x4a07c1(0x9a5)])[_0x4a07c1(0xa4b)]('\x0a'))[_0x4a07c1(0xa4b)](''),_0x262f24=_0x57277b(_0xa215af,0x3,_0x4a07c1(0x1059)),_0x28fa78=_0x57277b(_0xa215af,0x6,_0x4a07c1(0x1059)),_0x1cddd0=_0x57277b(_0xa215af,0x9,_0x4a07c1(0x1059)),_0x5c0b6e=_0x57277b(_0xa215af,0x1,_0x4a07c1(0xb95)),_0x4e8aca=_0x57277b(_0xa215af,0x3,_0x4a07c1(0xb95)),_0x135487=_0x57277b(_0xa215af,0x7,_0x4a07c1(0xb95));let _0xe5b0c8='';if(_0x262f24||_0x28fa78||_0x1cddd0||_0x5c0b6e||_0x4e8aca||_0x135487){_0xe5b0c8+=_0x4a07c1(0xc91);if(_0x262f24)_0xe5b0c8+=_0x262f24;if(_0x28fa78)_0xe5b0c8+=_0x28fa78;if(_0x1cddd0)_0xe5b0c8+=_0x1cddd0;if(_0x262f24||_0x28fa78||_0x1cddd0)_0xe5b0c8+='\x0a';if(_0x5c0b6e)_0xe5b0c8+=_0x5c0b6e;if(_0x4e8aca)_0xe5b0c8+=_0x4e8aca;if(_0x135487)_0xe5b0c8+=_0x135487;}const _0x576edf=_0x4a07c1(0xe2b)+_0xa215af['name']+_0x4a07c1(0x9fd)+_0xa215af[_0x4a07c1(0x761)][_0x4a07c1(0x8d5)]+'\x0a'+_0x284d8b+'\x0a'+_0x247214+'\x0a'+_0xe5b0c8+_0x4a07c1(0x4c5)+_0x43da00+_0x4a07c1(0x1bc)+_0x2cc128+_0x4a07c1(0xc89);try{const _0x321e75=[{'role':_0x4a07c1(0x21c),'content':_0x4a07c1(0x1169)}];let _0x3a62cd=_0x452cb8[_0x4a07c1(0x3ad)](_0x4a07c1(0xb9b)),_0x328cba=_0x4a90fe(_0x351f70,_0x4ec5ab,_0x576edf,_0x321e75);const _0x480957=_0x3a62cd?await fetch(_0x328cba[_0x4a07c1(0x10ac)],_0x328cba[_0x4a07c1(0x1cc)]):await fetch(_0x452cb8+_0x4a07c1(0x8fd),{'method':_0x4a07c1(0x1128),'headers':{'Content-Type':'application/json','Authorization':_0x4a07c1(0xdaf)+_0x4ec5ab},'body':JSON[_0x4a07c1(0x313)]({'model':_0x351f70,'messages':[{'role':'system','content':_0x576edf},..._0x321e75],'temperature':_0x5de8b7[_0x4a07c1(0x2df)][_0x4a07c1(0xe66)]||0.9})});if(!_0x480957['ok'])throw new Error(_0x4a07c1(0x307)+_0x480957[_0x4a07c1(0xfcf)]);const _0x3106cc=await _0x480957[_0x4a07c1(0xd7b)](),_0xc8e8f2=getGeminiResponseText(_0x3106cc),_0x4a4fac=_0xc8e8f2['match'](/(\[[\s\S]*\])/);if(!_0x4a4fac||!_0x4a4fac[0x0])throw new Error(_0x4a07c1(0x851)+_0xc8e8f2);const _0x413c18=_0x4a4fac[0x0];let _0x5d5823;try{_0x5d5823=JSON[_0x4a07c1(0xb0c)](_0x413c18);}catch(_0x33f4fd){throw new Error(_0x4a07c1(0x6cf)+_0x33f4fd[_0x4a07c1(0x4bc)]+'\x0a\x0aAI原始返回内容:\x0a'+_0xc8e8f2);}_0xa215af[_0x4a07c1(0x587)]=_0x5d5823,await _0x2e83f8[_0x4a07c1(0x737)][_0x4a07c1(0xe3c)](_0xa215af),await _0x746188();}catch(_0x875241){console[_0x4a07c1(0x1c1)](_0x4a07c1(0x81c),_0x875241),await _0x2fb06(_0x4a07c1(0x334),_0x4a07c1(0x113b)+_0x875241[_0x4a07c1(0x4bc)]);}}async function _0x746188(){const _0x2d734c=_0x241b18,_0x33557a=document['getElementById'](_0x2d734c(0x1220));_0x33557a[_0x2d734c(0x595)]='';if(!_0x698363)return;const _0x31e39e=_0x5de8b7[_0x2d734c(0x737)][_0x698363],_0x48d24e=_0x31e39e[_0x2d734c(0x587)]||[];if(_0x48d24e[_0x2d734c(0x594)]===0x0){_0x33557a[_0x2d734c(0x595)]=_0x2d734c(0x246);return;}const _0x3c42be=_0x2d734c(0x23b);_0x48d24e[_0x2d734c(0x494)](_0x5496a0=>{const _0x461c11=_0x2d734c,_0xcdfe9d=document[_0x461c11(0x383)](_0x461c11(0x1285));_0xcdfe9d[_0x461c11(0x3db)]=_0x461c11(0x648),_0xcdfe9d[_0x461c11(0xaca)][_0x461c11(0x1029)]=_0x5496a0[_0x461c11(0x1029)],_0x33557a[_0x461c11(0x120c)](_0xcdfe9d);if(_0x5de8b7[_0x461c11(0x2df)][_0x461c11(0xbd4)]){_0xcdfe9d[_0x461c11(0x794)][_0x461c11(0x556)]=_0x461c11(0x5cd);const _0x2ef225=/[^\x00-\x7F]/[_0x461c11(0x1043)](_0x5496a0[_0x461c11(0xee6)]),_0x54c165=_0x5496a0[_0x461c11(0xee6)]&&_0x5496a0['image_prompt']['trim']()&&!_0x2ef225,_0x41a654=_0x54c165?_0x5496a0[_0x461c11(0xee6)]:'a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting',_0x36bb51=_0x461c11(0x35d)+encodeURIComponent(_0x41a654),_0x4b5dcd=new Image();_0x4b5dcd[_0x461c11(0x1e5)]=function(){const _0x212a9d=_0x461c11;_0xcdfe9d[_0x212a9d(0x794)][_0x212a9d(0x123e)]=_0x212a9d(0xac7)+this['src']+')';},_0x4b5dcd['onerror']=function(){const _0x1282f6=_0x461c11;_0xcdfe9d[_0x1282f6(0x794)]['backgroundImage']='url('+_0x3c42be+')';},_0x4b5dcd[_0x461c11(0xf0a)]=_0x36bb51;}else{_0xcdfe9d[_0x461c11(0x794)][_0x461c11(0x556)]=_0x461c11(0x4fa),_0xcdfe9d[_0x461c11(0x794)]['border']=_0x461c11(0x87e);const _0x37e1d1=document['createElement']('p');_0x37e1d1['className']=_0x461c11(0x40e),_0x37e1d1['textContent']=_0x5496a0[_0x461c11(0x1029)]||_0x461c11(0xb34),_0xcdfe9d[_0x461c11(0x120c)](_0x37e1d1);}});}async function _0x40b97b(){const _0x303cf6=_0x241b18;if(!_0x698363)return;const _0x573306=_0x5de8b7[_0x303cf6(0x737)][_0x698363];if(!_0x573306)return;await _0x2fb06(_0x303cf6(0x63d),_0x303cf6(0x1190)+_0x573306['name']+_0x303cf6(0xd74));const {proxyUrl:_0x1c1ab4,apiKey:_0x576a50,model:_0x13db66}=_0x5de8b7['apiConfig'];if(!_0x1c1ab4||!_0x576a50||!_0x13db66){alert('API未配置，无法生成内容。');return;}const _0x1a0115=_0x5de8b7['qzoneSettings'][_0x303cf6(0xa33)]===_0x303cf6(0x833)||!_0x5de8b7[_0x303cf6(0x1c5)][_0x303cf6(0xa33)]?'用户':_0x5de8b7['qzoneSettings'][_0x303cf6(0xa33)],_0x23c53d=_0x573306[_0x303cf6(0xe21)]&&_0x573306[_0x303cf6(0xe21)][_0x303cf6(0x594)]>0x0?_0x573306[_0x303cf6(0xe21)][_0x303cf6(0x796)](_0x9edacc=>'-\x20(记录于\x20'+_0x497f2b(_0x9edacc[_0x303cf6(0x702)])+')\x20'+_0x9edacc[_0x303cf6(0x9a5)])[_0x303cf6(0xa4b)]('\x0a'):'无',_0x520f50=_0x573306[_0x303cf6(0x761)][_0x303cf6(0xb2e)]||0xa,_0x3a5b2b=_0x573306[_0x303cf6(0x49e)][_0x303cf6(0xa6c)](-_0x520f50)[_0x303cf6(0x796)](_0x7d37f7=>(_0x7d37f7[_0x303cf6(0xba4)]===_0x303cf6(0x21c)?_0x1a0115:_0x573306[_0x303cf6(0x278)])+':\x20'+String(_0x7d37f7['content'])[_0x303cf6(0x8d4)](0x0,0x1e)+_0x303cf6(0x6cb))['join']('\x0a'),_0x56ff1b=(_0x573306[_0x303cf6(0x761)][_0x303cf6(0xa17)]||[])[_0x303cf6(0x796)](_0x251c37=>_0x5de8b7[_0x303cf6(0xca)][_0x303cf6(0xe79)](_0x1f4699=>_0x1f4699['id']===_0x251c37))['filter'](Boolean)[_0x303cf6(0x796)](_0x111daa=>_0x303cf6(0x10b5)+_0x111daa[_0x303cf6(0x278)]+_0x303cf6(0x63a)+_0x111daa[_0x303cf6(0x9a5)][_0x303cf6(0x138)](_0x8875a1=>_0x8875a1[_0x303cf6(0xc34)])[_0x303cf6(0x796)](_0x21a949=>'-\x20'+_0x21a949[_0x303cf6(0x9a5)])[_0x303cf6(0xa4b)]('\x0a'))['join'](''),_0x2fda9f=_0x57277b(_0x573306,0x3,_0x303cf6(0x1059)),_0x5f2716=_0x57277b(_0x573306,0x6,_0x303cf6(0x1059)),_0x3d3a4b=_0x57277b(_0x573306,0x9,'hours'),_0x2ca3fb=_0x57277b(_0x573306,0x1,'days'),_0x5764dc=_0x57277b(_0x573306,0x3,'days'),_0x565909=_0x57277b(_0x573306,0x7,_0x303cf6(0xb95));let _0x55d4b5='';if(_0x2fda9f||_0x5f2716||_0x3d3a4b||_0x2ca3fb||_0x5764dc||_0x565909){_0x55d4b5+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x2fda9f)_0x55d4b5+=_0x2fda9f;if(_0x5f2716)_0x55d4b5+=_0x5f2716;if(_0x3d3a4b)_0x55d4b5+=_0x3d3a4b;if(_0x2fda9f||_0x5f2716||_0x3d3a4b)_0x55d4b5+='\x0a';if(_0x2ca3fb)_0x55d4b5+=_0x2ca3fb;if(_0x5764dc)_0x55d4b5+=_0x5764dc;if(_0x565909)_0x55d4b5+=_0x565909;}const _0x25c069='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x573306[_0x303cf6(0x278)]+_0x303cf6(0x38a)+_0x573306['settings']['aiPersona']+'\x0a-\x20**你的长期记忆**:\x0a'+_0x23c53d+'\x0a'+_0x56ff1b+'\x0a'+_0x55d4b5+_0x303cf6(0x4c5)+_0x1a0115+_0x303cf6(0x1bc)+_0x3a5b2b+'\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。';try{const _0x4744c3=[{'role':'user','content':_0x303cf6(0xcda)}];let _0x534d17=_0x1c1ab4[_0x303cf6(0x3ad)](_0x303cf6(0xb9b)),_0x3dd377=_0x4a90fe(_0x13db66,_0x576a50,_0x25c069,_0x4744c3);const _0x5ca502=_0x534d17?await fetch(_0x3dd377['url'],_0x3dd377[_0x303cf6(0x1cc)]):await fetch(_0x1c1ab4+_0x303cf6(0x8fd),{'method':_0x303cf6(0x1128),'headers':{'Content-Type':'application/json','Authorization':_0x303cf6(0xdaf)+_0x576a50},'body':JSON[_0x303cf6(0x313)]({'model':_0x13db66,'messages':[{'role':_0x303cf6(0xf72),'content':_0x25c069},..._0x4744c3],'temperature':_0x5de8b7[_0x303cf6(0x2df)][_0x303cf6(0xe66)]||0.9})});if(!_0x5ca502['ok'])throw new Error('API\x20错误:\x20'+_0x5ca502[_0x303cf6(0xfcf)]);const _0x56ddcb=await _0x5ca502[_0x303cf6(0xd7b)](),_0x2a1061=getGeminiResponseText(_0x56ddcb),_0x5db6a8=_0x2a1061[_0x303cf6(0xe9f)](/(\[[\s\S]*\])/);if(!_0x5db6a8||!_0x5db6a8[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x2a1061);const _0x1073d6=_0x5db6a8[0x0];let _0x2dc580;try{_0x2dc580=JSON[_0x303cf6(0xb0c)](_0x1073d6);}catch(_0x377058){throw new Error(_0x303cf6(0x6cf)+_0x377058[_0x303cf6(0x4bc)]+_0x303cf6(0x779)+_0x2a1061);}_0x573306[_0x303cf6(0x97a)]=_0x2dc580,await _0x2e83f8['chats'][_0x303cf6(0xe3c)](_0x573306),await _0x278dc6();}catch(_0x8b038e){console[_0x303cf6(0x1c1)](_0x303cf6(0xed1),_0x8b038e),await _0x2fb06(_0x303cf6(0x334),_0x303cf6(0xb20)+_0x8b038e[_0x303cf6(0x4bc)]);}}function _0x278dc6(){const _0x25dfc0=_0x241b18,_0x353640=document[_0x25dfc0(0x11e3)](_0x25dfc0(0x1015));_0x353640[_0x25dfc0(0x595)]='';if(!_0x698363)return;const _0x2cc43c=_0x5de8b7['chats'][_0x698363],_0x4b30e2=_0x2cc43c['simulatedBrowserHistory']||[];if(_0x4b30e2[_0x25dfc0(0x594)]===0x0){_0x353640[_0x25dfc0(0x595)]=_0x25dfc0(0x7e1);return;}_0x4b30e2['forEach']((_0x33b59b,_0x38dd6b)=>{const _0xecaac0=_0x25dfc0,_0x80af14=document['createElement'](_0xecaac0(0x1285));_0x80af14[_0xecaac0(0x3db)]=_0xecaac0(0x1137),_0x80af14[_0xecaac0(0x595)]=_0xecaac0(0x50a)+_0x33b59b[_0xecaac0(0x740)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>'+_0x33b59b[_0xecaac0(0x10ac)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x80af14['addEventListener'](_0xecaac0(0x1041),()=>_0x3e7841(_0x38dd6b)),_0x353640['appendChild'](_0x80af14);});}async function _0x3e7841(_0x169120){const _0xecf41b=_0x241b18,_0x2e28b7=_0x5de8b7[_0xecf41b(0x737)][_0x698363],_0x307a2a=_0x2e28b7[_0xecf41b(0x97a)][_0x169120];if(!_0x307a2a)return;_0x59751d=_0x307a2a,_0x22853c(_0x307a2a),_0x5a5fee(_0xecf41b(0x5ff));const _0x4f9807=document['getElementById'](_0xecf41b(0x5c1)),_0x47a8e4=await _0x2e83f8[_0xecf41b(0xc3e)]['where']({'type':_0xecf41b(0x68e),'content.url':_0x307a2a[_0xecf41b(0x10ac)]})[_0xecf41b(0x12c1)]();_0x4f9807[_0xecf41b(0x505)][_0xecf41b(0xe7e)]('active',!!_0x47a8e4);}async function _0x27b7e7(){const _0x186b1b=_0x241b18;if(!_0x59751d||!_0x698363)return;const _0x114e15=_0x59751d,_0x48fcb2=_0x5de8b7['chats'][_0x698363],_0x11d1c5=document[_0x186b1b(0x11e3)](_0x186b1b(0x5c1)),_0x20db7f=await _0x2e83f8[_0x186b1b(0xc3e)][_0x186b1b(0x129e)]({'type':_0x186b1b(0x68e),'content.url':_0x114e15[_0x186b1b(0x10ac)]})['first']();if(_0x20db7f)await _0x2e83f8[_0x186b1b(0xc3e)][_0x186b1b(0xc0c)](_0x20db7f['id']),_0x11d1c5[_0x186b1b(0x505)][_0x186b1b(0x957)]('active'),await _0x2fb06('操作成功','已取消收藏。');else{const _0x33360e={'type':_0x186b1b(0x68e),'content':{..._0x114e15,'characterId':_0x698363,'characterName':_0x48fcb2['name']},'timestamp':Date[_0x186b1b(0x1182)]()};await _0x2e83f8[_0x186b1b(0xc3e)]['add'](_0x33360e),_0x11d1c5[_0x186b1b(0x505)]['add'](_0x186b1b(0x1fc)),await _0x2fb06(_0x186b1b(0x1010),'已成功收藏到“我的收藏”页面！');}}function _0x22853c(_0x1838f0){const _0x5582b0=_0x241b18,_0x1bba24=document[_0x5582b0(0x11e3)](_0x5582b0(0xfc5)),_0x4c77ef=document[_0x5582b0(0x11e3)](_0x5582b0(0x1b3));_0x1bba24['textContent']=_0x1838f0[_0x5582b0(0x740)],_0x4c77ef[_0x5582b0(0x595)]='',_0x1838f0[_0x5582b0(0xa20)]===_0x5582b0(0x6e9)?_0x4c77ef['innerHTML']=_0x5582b0(0x9bf)+(_0x1838f0['title']||_0x5582b0(0xeeb))+_0x5582b0(0xdc8):_0x4c77ef[_0x5582b0(0x595)]=_0x5582b0(0xbdf)+(_0x1838f0['content']||_0x5582b0(0x9a2))[_0x5582b0(0x1018)](/\n/g,_0x5582b0(0x1172))+_0x5582b0(0xdc8);}async function _0x1cb8f7(){const _0xbdf4c5=_0x241b18;if(!_0x698363)return;const _0x404c45=_0x5de8b7[_0xbdf4c5(0x737)][_0x698363];if(!_0x404c45)return;await _0x2fb06(_0xbdf4c5(0x63d),'正在模拟“'+_0x404c45[_0xbdf4c5(0x278)]+_0xbdf4c5(0xe57));const {proxyUrl:_0x38ca81,apiKey:_0x2b257f,model:_0x598f28}=_0x5de8b7[_0xbdf4c5(0x89c)];if(!_0x38ca81||!_0x2b257f||!_0x598f28){alert(_0xbdf4c5(0x249));return;}const _0x580e6d=_0x5de8b7[_0xbdf4c5(0x1c5)]['nickname']==='{{user}}'||!_0x5de8b7['qzoneSettings']['nickname']?'用户':_0x5de8b7[_0xbdf4c5(0x1c5)]['nickname'],_0x2b0659=_0x404c45['longTermMemory']&&_0x404c45['longTermMemory'][_0xbdf4c5(0x594)]>0x0?_0x404c45[_0xbdf4c5(0xe21)]['map'](_0x5c3bfe=>_0xbdf4c5(0xd12)+_0x497f2b(_0x5c3bfe['timestamp'])+')\x20'+_0x5c3bfe[_0xbdf4c5(0x9a5)])[_0xbdf4c5(0xa4b)]('\x0a'):'无',_0x272664=_0x404c45[_0xbdf4c5(0x761)][_0xbdf4c5(0xb2e)]||0xa,_0x528ad6=_0x404c45[_0xbdf4c5(0x49e)]['slice'](-_0x272664)[_0xbdf4c5(0x796)](_0x4449a6=>(_0x4449a6['role']===_0xbdf4c5(0x21c)?_0x580e6d:_0x404c45[_0xbdf4c5(0x278)])+':\x20'+String(_0x4449a6[_0xbdf4c5(0x9a5)])[_0xbdf4c5(0x8d4)](0x0,0x1e)+_0xbdf4c5(0x6cb))[_0xbdf4c5(0xa4b)]('\x0a'),_0x34dd75=(_0x404c45[_0xbdf4c5(0x761)][_0xbdf4c5(0xa17)]||[])[_0xbdf4c5(0x796)](_0x1e8ad4=>_0x5de8b7[_0xbdf4c5(0xca)]['find'](_0x54c4fd=>_0x54c4fd['id']===_0x1e8ad4))[_0xbdf4c5(0x138)](Boolean)['map'](_0x3acdcf=>_0xbdf4c5(0x10b5)+_0x3acdcf['name']+_0xbdf4c5(0x63a)+_0x3acdcf[_0xbdf4c5(0x9a5)][_0xbdf4c5(0x138)](_0x1ca738=>_0x1ca738[_0xbdf4c5(0xc34)])['map'](_0x33794c=>'-\x20'+_0x33794c[_0xbdf4c5(0x9a5)])[_0xbdf4c5(0xa4b)]('\x0a'))[_0xbdf4c5(0xa4b)](''),_0x3b2b03=_0x57277b(_0x404c45,0x3,_0xbdf4c5(0x1059)),_0x5e3097=_0x57277b(_0x404c45,0x6,_0xbdf4c5(0x1059)),_0x39581e=_0x57277b(_0x404c45,0x9,'hours'),_0x5ad774=_0x57277b(_0x404c45,0x1,_0xbdf4c5(0xb95)),_0x2c3a8b=_0x57277b(_0x404c45,0x3,_0xbdf4c5(0xb95)),_0x243715=_0x57277b(_0x404c45,0x7,_0xbdf4c5(0xb95));let _0x2318a0='';if(_0x3b2b03||_0x5e3097||_0x39581e||_0x5ad774||_0x2c3a8b||_0x243715){_0x2318a0+=_0xbdf4c5(0xc91);if(_0x3b2b03)_0x2318a0+=_0x3b2b03;if(_0x5e3097)_0x2318a0+=_0x5e3097;if(_0x39581e)_0x2318a0+=_0x39581e;if(_0x3b2b03||_0x5e3097||_0x39581e)_0x2318a0+='\x0a';if(_0x5ad774)_0x2318a0+=_0x5ad774;if(_0x2c3a8b)_0x2318a0+=_0x2c3a8b;if(_0x243715)_0x2318a0+=_0x243715;}const _0x156d37=_0xbdf4c5(0xe2b)+_0x404c45[_0xbdf4c5(0x278)]+'”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x404c45[_0xbdf4c5(0x761)][_0xbdf4c5(0x8d5)]+_0xbdf4c5(0x63c)+_0x2b0659+'\x0a'+_0x34dd75+'\x0a'+_0x2318a0+'\x20\x0a-\x20**你最近和“'+_0x580e6d+_0xbdf4c5(0x1bc)+_0x528ad6+_0xbdf4c5(0x1133);try{const _0x3e5fd7=[{'role':'user','content':_0xbdf4c5(0xa75)}];let _0x39d2b2=_0x38ca81['includes'](_0xbdf4c5(0xb9b)),_0x2c246b=_0x4a90fe(_0x598f28,_0x2b257f,_0x156d37,_0x3e5fd7);const _0x80e267=_0x39d2b2?await fetch(_0x2c246b[_0xbdf4c5(0x10ac)],_0x2c246b[_0xbdf4c5(0x1cc)]):await fetch(_0x38ca81+_0xbdf4c5(0x8fd),{'method':_0xbdf4c5(0x1128),'headers':{'Content-Type':_0xbdf4c5(0x35c),'Authorization':_0xbdf4c5(0xdaf)+_0x2b257f},'body':JSON[_0xbdf4c5(0x313)]({'model':_0x598f28,'messages':[{'role':_0xbdf4c5(0xf72),'content':_0x156d37},..._0x3e5fd7],'temperature':_0x5de8b7[_0xbdf4c5(0x2df)]['apiTemperature']||0.9})});if(!_0x80e267['ok'])throw new Error('API\x20错误:\x20'+_0x80e267['statusText']);const _0x3bae22=await _0x80e267[_0xbdf4c5(0xd7b)](),_0x5ebc1a=getGeminiResponseText(_0x3bae22),_0x16db6f=_0x5ebc1a[_0xbdf4c5(0xe9f)](/({[\s\S]*})/);if(!_0x16db6f)throw new Error(_0xbdf4c5(0xaeb));const _0x233762=JSON[_0xbdf4c5(0xb0c)](_0x16db6f[0x0]);!_0x233762[_0xbdf4c5(0x115d)]&&(_0x233762[_0xbdf4c5(0x115d)]=[]),_0x404c45[_0xbdf4c5(0x931)]=_0x233762,await _0x2e83f8[_0xbdf4c5(0x737)]['put'](_0x404c45),await _0x1953b4();}catch(_0x3f784c){console[_0xbdf4c5(0x1c1)](_0xbdf4c5(0x914),_0x3f784c),await _0x2fb06(_0xbdf4c5(0x334),_0xbdf4c5(0x66f)+_0x3f784c[_0xbdf4c5(0x4bc)]);}}function _0x12eb6b(){const _0xad419c=_0x241b18;_0x3a624c(),_0x5a5fee(_0xad419c(0xa7d));}function _0x3a624c(){const _0x4b5e91=_0x241b18,_0x2adedf=document[_0x4b5e91(0x11e3)](_0x4b5e91(0xce7));_0x2adedf['innerHTML']='';const _0x611e10=_0x5de8b7[_0x4b5e91(0x737)][_0x698363],_0x1404b6=_0x611e10[_0x4b5e91(0x931)]||{},_0xc1b09a=_0x1404b6[_0x4b5e91(0x115d)]||[],_0x1beff1=_0x1404b6[_0x4b5e91(0xb3a)]||0x0,_0x5b8278=document[_0x4b5e91(0x383)](_0x4b5e91(0x1285));_0x5b8278[_0x4b5e91(0x794)]['cssText']=_0x4b5e91(0x381),_0x5b8278[_0x4b5e91(0x595)]=_0x4b5e91(0x1021)+_0x1beff1[_0x4b5e91(0x200)](0x2)+'</p>\x0a\x20\x20\x20\x20',_0x2adedf[_0x4b5e91(0x120c)](_0x5b8278);const _0x25e8af=document[_0x4b5e91(0x383)]('h3');_0x25e8af[_0x4b5e91(0x300)]='最近支出',_0x25e8af[_0x4b5e91(0x794)][_0x4b5e91(0xfb7)]=_0x4b5e91(0x321),_0x2adedf[_0x4b5e91(0x120c)](_0x25e8af);if(_0xc1b09a['length']===0x0){_0x2adedf['innerHTML']+=_0x4b5e91(0xd63);return;}_0xc1b09a[_0x4b5e91(0x494)](_0x2f88cb=>{const _0x329f74=_0x4b5e91,_0x1f04a2=document[_0x329f74(0x383)](_0x329f74(0x1285));_0x1f04a2[_0x329f74(0x794)]['cssText']=_0x329f74(0xbe0),_0x1f04a2['innerHTML']=_0x329f74(0xe58)+_0x2f88cb[_0x329f74(0xa4c)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>'+_0x2f88cb[_0x329f74(0x739)]+_0x329f74(0x103f)+(_0x2f88cb[_0x329f74(0xa6f)]||0x0)[_0x329f74(0x200)](0x2)+_0x329f74(0x176),_0x2adedf[_0x329f74(0x120c)](_0x1f04a2);});}async function _0x341fb3(){const _0x34e35e=_0x241b18;if(!_0x698363)return;const _0x82bce5=_0x5de8b7[_0x34e35e(0x737)][_0x698363];if(!_0x82bce5)return;await _0x2fb06(_0x34e35e(0x63d),_0x34e35e(0x207)+_0x82bce5[_0x34e35e(0x278)]+_0x34e35e(0x5f7));const {proxyUrl:_0x18c117,apiKey:_0x588934,model:_0x584f42}=_0x5de8b7[_0x34e35e(0x89c)];if(!_0x18c117||!_0x588934||!_0x584f42){alert('请先在API设置中配置好API信息。');return;}const _0x195eac=_0x5de8b7[_0x34e35e(0x1c5)][_0x34e35e(0xa33)]===_0x34e35e(0x833)||!_0x5de8b7[_0x34e35e(0x1c5)][_0x34e35e(0xa33)]?'用户':_0x5de8b7[_0x34e35e(0x1c5)]['nickname'],_0xa02edd=_0x82bce5[_0x34e35e(0xe21)]&&_0x82bce5[_0x34e35e(0xe21)]['length']>0x0?_0x82bce5[_0x34e35e(0xe21)][_0x34e35e(0x796)](_0x1538f0=>'-\x20(记录于\x20'+_0x497f2b(_0x1538f0[_0x34e35e(0x702)])+')\x20'+_0x1538f0[_0x34e35e(0x9a5)])[_0x34e35e(0xa4b)]('\x0a'):'无',_0x4aa904=_0x82bce5['settings'][_0x34e35e(0xb2e)]||0xa,_0x404293=_0x82bce5['history'][_0x34e35e(0xa6c)](-_0x4aa904)[_0x34e35e(0x796)](_0x2c2ad3=>(_0x2c2ad3[_0x34e35e(0xba4)]===_0x34e35e(0x21c)?_0x195eac:_0x82bce5[_0x34e35e(0x278)])+':\x20'+String(_0x2c2ad3[_0x34e35e(0x9a5)])['substring'](0x0,0x1e)+_0x34e35e(0x6cb))[_0x34e35e(0xa4b)]('\x0a'),_0x26a7db=(_0x82bce5[_0x34e35e(0x761)][_0x34e35e(0xa17)]||[])[_0x34e35e(0x796)](_0x3dcfbd=>_0x5de8b7[_0x34e35e(0xca)]['find'](_0x36d7a=>_0x36d7a['id']===_0x3dcfbd))[_0x34e35e(0x138)](Boolean)[_0x34e35e(0x796)](_0x176933=>'\x0a##\x20世界书《'+_0x176933['name']+'》设定:\x0a'+_0x176933[_0x34e35e(0x9a5)][_0x34e35e(0x138)](_0x862671=>_0x862671['enabled'])[_0x34e35e(0x796)](_0x445236=>'-\x20'+_0x445236[_0x34e35e(0x9a5)])['join']('\x0a'))['join'](''),_0x2fcda7=_0x57277b(_0x82bce5,0x3,'hours'),_0x12dc25=_0x57277b(_0x82bce5,0x6,_0x34e35e(0x1059)),_0x4720d3=_0x57277b(_0x82bce5,0x9,'hours'),_0x1bc46b=_0x57277b(_0x82bce5,0x1,_0x34e35e(0xb95)),_0x3b7055=_0x57277b(_0x82bce5,0x3,'days'),_0x497bea=_0x57277b(_0x82bce5,0x7,_0x34e35e(0xb95));let _0xdde4c='';if(_0x2fcda7||_0x12dc25||_0x4720d3||_0x1bc46b||_0x3b7055||_0x497bea){_0xdde4c+=_0x34e35e(0xc91);if(_0x2fcda7)_0xdde4c+=_0x2fcda7;if(_0x12dc25)_0xdde4c+=_0x12dc25;if(_0x4720d3)_0xdde4c+=_0x4720d3;if(_0x2fcda7||_0x12dc25||_0x4720d3)_0xdde4c+='\x0a';if(_0x1bc46b)_0xdde4c+=_0x1bc46b;if(_0x3b7055)_0xdde4c+=_0x3b7055;if(_0x497bea)_0xdde4c+=_0x497bea;}const _0x457811=_0x34e35e(0xe2b)+_0x82bce5['name']+_0x34e35e(0xb2c)+_0x82bce5[_0x34e35e(0x761)][_0x34e35e(0x8d5)]+_0x34e35e(0x63c)+_0xa02edd+'\x0a'+_0x26a7db+'\x0a'+_0xdde4c+_0x34e35e(0x11ce)+_0x195eac+'”的对话摘要**:\x0a'+_0x404293+_0x34e35e(0xd45);try{const _0x160149=[{'role':'user','content':_0x34e35e(0x995)}];let _0x901998=_0x18c117[_0x34e35e(0x3ad)](_0x34e35e(0xb9b)),_0xfa72cd=_0x4a90fe(_0x584f42,_0x588934,_0x457811,_0x160149);const _0x59be93=_0x901998?await fetch(_0xfa72cd[_0x34e35e(0x10ac)],_0xfa72cd['data']):await fetch(_0x18c117+'/v1/chat/completions',{'method':_0x34e35e(0x1128),'headers':{'Content-Type':'application/json','Authorization':_0x34e35e(0xdaf)+_0x588934},'body':JSON['stringify']({'model':_0x584f42,'messages':[{'role':'system','content':_0x457811},..._0x160149],'temperature':_0x5de8b7['globalSettings'][_0x34e35e(0xe66)]||0.9})});if(!_0x59be93['ok']){const _0x20a36f=await _0x59be93[_0x34e35e(0xd7b)]()[_0x34e35e(0x100)](()=>null),_0x37d08f=_0x20a36f?.['error']?.[_0x34e35e(0x4bc)]||_0x59be93[_0x34e35e(0xfcf)];throw new Error('API\x20错误:\x20'+_0x59be93[_0x34e35e(0x739)]+_0x34e35e(0x12a2)+_0x37d08f);}const _0xd47d75=await _0x59be93[_0x34e35e(0xd7b)](),_0x28d58c=getGeminiResponseText(_0xd47d75),_0x3732e4=_0x28d58c[_0x34e35e(0xe9f)](/(\[[\s\S]*\])/);if(!_0x3732e4||!_0x3732e4[0x0])throw new Error(_0x34e35e(0x851)+_0x28d58c);const _0x1c687b=_0x3732e4[0x0];let _0x1883f6;try{_0x1883f6=JSON[_0x34e35e(0xb0c)](_0x1c687b);}catch(_0x5e5cb0){throw new Error(_0x34e35e(0x6cf)+_0x5e5cb0[_0x34e35e(0x4bc)]+_0x34e35e(0x779)+_0x28d58c);}if(!Array['isArray'](_0x1883f6))throw new Error(_0x34e35e(0x119)+JSON[_0x34e35e(0x313)](_0x1883f6));_0x82bce5[_0x34e35e(0x90e)]=_0x1883f6[_0x34e35e(0x796)](_0x58e63f=>({'id':Date[_0x34e35e(0x1182)]()+Math[_0x34e35e(0x36d)](),'title':_0x58e63f['title'],'content':_0x58e63f[_0x34e35e(0x9a5)]})),await _0x2e83f8[_0x34e35e(0x737)][_0x34e35e(0xe3c)](_0x82bce5),await _0x302be7();}catch(_0x2e9ef4){console['error']('生成模拟备忘录失败:',_0x2e9ef4),await _0x2fb06(_0x34e35e(0x334),_0x34e35e(0x424)+_0x2e9ef4[_0x34e35e(0x4bc)]);}}async function _0x18dd93(){const _0x57c7a4=_0x241b18;if(!_0x698363)return;const _0x274ada=_0x5de8b7[_0x57c7a4(0x737)][_0x698363];if(!_0x274ada)return;await _0x2fb06(_0x57c7a4(0x63d),_0x57c7a4(0xcdd)+_0x274ada[_0x57c7a4(0x278)]+_0x57c7a4(0x18a));const {proxyUrl:_0x53e620,apiKey:_0x269d1b,model:_0x535a1a}=_0x5de8b7['apiConfig'];if(!_0x53e620||!_0x269d1b||!_0x535a1a){alert('API未配置，无法生成内容。');return;}const _0x437209=_0x5de8b7[_0x57c7a4(0x1c5)][_0x57c7a4(0xa33)]==='{{user}}'||!_0x5de8b7[_0x57c7a4(0x1c5)][_0x57c7a4(0xa33)]?'用户':_0x5de8b7[_0x57c7a4(0x1c5)][_0x57c7a4(0xa33)],_0x34a646=_0x274ada[_0x57c7a4(0xe21)]&&_0x274ada[_0x57c7a4(0xe21)][_0x57c7a4(0x594)]>0x0?_0x274ada[_0x57c7a4(0xe21)]['map'](_0x1fc714=>_0x57c7a4(0xd12)+_0x497f2b(_0x1fc714[_0x57c7a4(0x702)])+')\x20'+_0x1fc714[_0x57c7a4(0x9a5)])[_0x57c7a4(0xa4b)]('\x0a'):'无',_0x53a40b=_0x274ada[_0x57c7a4(0x761)][_0x57c7a4(0xb2e)]||0xa,_0x3e6436=_0x274ada['history'][_0x57c7a4(0xa6c)](-_0x53a40b)[_0x57c7a4(0x796)](_0xd5d4df=>(_0xd5d4df['role']===_0x57c7a4(0x21c)?_0x437209:_0x274ada[_0x57c7a4(0x278)])+':\x20'+String(_0xd5d4df['content'])[_0x57c7a4(0x8d4)](0x0,0x1e)+'...')[_0x57c7a4(0xa4b)]('\x0a'),_0x2973c6=(_0x274ada[_0x57c7a4(0x761)]['linkedWorldBookIds']||[])['map'](_0x4d24c8=>_0x5de8b7[_0x57c7a4(0xca)][_0x57c7a4(0xe79)](_0x4ccfdd=>_0x4ccfdd['id']===_0x4d24c8))[_0x57c7a4(0x138)](Boolean)[_0x57c7a4(0x796)](_0xe376b0=>_0x57c7a4(0x10b5)+_0xe376b0[_0x57c7a4(0x278)]+_0x57c7a4(0x63a)+_0xe376b0[_0x57c7a4(0x9a5)]['filter'](_0x2d11c9=>_0x2d11c9['enabled'])[_0x57c7a4(0x796)](_0x3a94d1=>'-\x20'+_0x3a94d1[_0x57c7a4(0x9a5)])['join']('\x0a'))[_0x57c7a4(0xa4b)](''),_0x151295=_0x57277b(_0x274ada,0x3,_0x57c7a4(0x1059)),_0x146abf=_0x57277b(_0x274ada,0x6,_0x57c7a4(0x1059)),_0x251647=_0x57277b(_0x274ada,0x9,_0x57c7a4(0x1059)),_0x73c9bc=_0x57277b(_0x274ada,0x1,_0x57c7a4(0xb95)),_0x58deb4=_0x57277b(_0x274ada,0x3,_0x57c7a4(0xb95)),_0x4eefaf=_0x57277b(_0x274ada,0x7,_0x57c7a4(0xb95));let _0x5394bc='';if(_0x151295||_0x146abf||_0x251647||_0x73c9bc||_0x58deb4||_0x4eefaf){_0x5394bc+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x151295)_0x5394bc+=_0x151295;if(_0x146abf)_0x5394bc+=_0x146abf;if(_0x251647)_0x5394bc+=_0x251647;if(_0x151295||_0x146abf||_0x251647)_0x5394bc+='\x0a';if(_0x73c9bc)_0x5394bc+=_0x73c9bc;if(_0x58deb4)_0x5394bc+=_0x58deb4;if(_0x4eefaf)_0x5394bc+=_0x4eefaf;}const _0x11122c='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x274ada[_0x57c7a4(0x278)]+_0x57c7a4(0x47d)+new Date()[_0x57c7a4(0xda)]()+_0x57c7a4(0x346)+_0x274ada[_0x57c7a4(0x761)][_0x57c7a4(0x8d5)]+_0x57c7a4(0x63c)+_0x34a646+'\x0a'+_0x2973c6+'\x0a'+_0x5394bc+_0x57c7a4(0x11ce)+_0x437209+_0x57c7a4(0x1bc)+_0x3e6436+_0x57c7a4(0xb9d);try{const _0x233140=[{'role':'user','content':_0x57c7a4(0x12b3)}];let _0x3de47c=_0x53e620['includes'](_0x57c7a4(0xb9b)),_0xfb1f9a=_0x4a90fe(_0x535a1a,_0x269d1b,_0x11122c,_0x233140);const _0x1ed6f0=_0x3de47c?await fetch(_0xfb1f9a['url'],_0xfb1f9a[_0x57c7a4(0x1cc)]):await fetch(_0x53e620+_0x57c7a4(0x8fd),{'method':_0x57c7a4(0x1128),'headers':{'Content-Type':'application/json','Authorization':_0x57c7a4(0xdaf)+_0x269d1b},'body':JSON[_0x57c7a4(0x313)]({'model':_0x535a1a,'messages':[{'role':_0x57c7a4(0xf72),'content':_0x11122c},..._0x233140],'temperature':_0x5de8b7[_0x57c7a4(0x2df)][_0x57c7a4(0xe66)]||0.9})});if(!_0x1ed6f0['ok'])throw new Error(_0x57c7a4(0x307)+_0x1ed6f0[_0x57c7a4(0xfcf)]);const _0x3aa5c2=await _0x1ed6f0[_0x57c7a4(0xd7b)](),_0x38de9c=getGeminiResponseText(_0x3aa5c2),_0x18136e=_0x38de9c[_0x57c7a4(0xe9f)](/(\[[\s\S]*\])/);if(!_0x18136e||!_0x18136e[0x0])throw new Error(_0x57c7a4(0x851)+_0x38de9c);const _0x7fcbcd=_0x18136e[0x0];let _0x2abcd8;try{_0x2abcd8=JSON['parse'](_0x7fcbcd);}catch(_0x1ffa26){throw new Error('解析AI返回的JSON时出错:\x20'+_0x1ffa26[_0x57c7a4(0x4bc)]+_0x57c7a4(0x779)+_0x38de9c);}_0x274ada['simulatedAmapHistory']=_0x2abcd8,await _0x2e83f8[_0x57c7a4(0x737)][_0x57c7a4(0xe3c)](_0x274ada),await _0x393798();}catch(_0x49eb40){console['error'](_0x57c7a4(0x4e8),_0x49eb40),await _0x2fb06('生成失败','无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20'+_0x49eb40['message']);}}function _0x393798(){const _0x50c88c=_0x241b18,_0x4898e8=document[_0x50c88c(0x11e3)](_0x50c88c(0x586));_0x4898e8[_0x50c88c(0x595)]='';if(!_0x698363)return;const _0x408205=_0x5de8b7[_0x50c88c(0x737)][_0x698363],_0x13dc8b=_0x408205[_0x50c88c(0xb21)]||[];if(_0x13dc8b[_0x50c88c(0x594)]===0x0){_0x4898e8[_0x50c88c(0x595)]=_0x50c88c(0x3a0);return;}_0x13dc8b[_0x50c88c(0x494)](_0x14deb6=>{const _0x550321=_0x50c88c,_0x5ceb2c=document[_0x550321(0x383)](_0x550321(0x1285));_0x5ceb2c['className']=_0x550321(0xba0);let _0x2fd8b0='';if(_0x14deb6[_0x550321(0xee6)]){const _0x3283fe=_0x550321(0x35d)+encodeURIComponent(_0x14deb6[_0x550321(0xee6)]);_0x2fd8b0=_0x550321(0x9e7)+_0x3283fe+_0x550321(0xfd2)+_0x14deb6[_0x550321(0xebd)]+_0x550321(0x95b);}const _0x326723=_0x14deb6[_0x550321(0x702)]?_0x497f2b(new Date(_0x14deb6[_0x550321(0x702)])[_0x550321(0xd2f)]()):_0x550321(0x9cc);_0x5ceb2c[_0x550321(0x595)]=_0x550321(0x486)+_0x14deb6[_0x550321(0xacc)]+_0x550321(0x13e)+_0x14deb6[_0x550321(0xb56)]+_0x550321(0x62d)+_0x14deb6[_0x550321(0xebd)]['replace'](/\n/g,_0x550321(0xf70))+_0x550321(0x582)+_0x2fd8b0+_0x550321(0xae0)+_0x326723+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4898e8[_0x550321(0x120c)](_0x5ceb2c);});}async function _0x24cbcf(){const _0x1e654f=_0x241b18;if(!_0x698363)return;const _0x2cafbf=_0x5de8b7[_0x1e654f(0x737)][_0x698363];if(!_0x2cafbf)return;await _0x2fb06('请稍候...',_0x1e654f(0x1151)+_0x2cafbf['name']+'”的手机使用习惯...');const {proxyUrl:_0x509b92,apiKey:_0x55486d,model:_0x1e896d}=_0x5de8b7[_0x1e654f(0x89c)];if(!_0x509b92||!_0x55486d||!_0x1e896d){alert(_0x1e654f(0x249));return;}const _0x230f0f=_0x5de8b7['qzoneSettings'][_0x1e654f(0xa33)]===_0x1e654f(0x833)||!_0x5de8b7[_0x1e654f(0x1c5)][_0x1e654f(0xa33)]?'用户':_0x5de8b7[_0x1e654f(0x1c5)][_0x1e654f(0xa33)],_0x37472c=_0x2cafbf[_0x1e654f(0xe21)]&&_0x2cafbf[_0x1e654f(0xe21)]['length']>0x0?_0x2cafbf[_0x1e654f(0xe21)][_0x1e654f(0x796)](_0x2e7100=>_0x1e654f(0xd12)+_0x497f2b(_0x2e7100[_0x1e654f(0x702)])+')\x20'+_0x2e7100[_0x1e654f(0x9a5)])[_0x1e654f(0xa4b)]('\x0a'):'无',_0x5e042b=_0x2cafbf[_0x1e654f(0x761)][_0x1e654f(0xb2e)]||0xa,_0x35f482=_0x2cafbf[_0x1e654f(0x49e)]['slice'](-_0x5e042b)[_0x1e654f(0x796)](_0x25c3e7=>(_0x25c3e7['role']===_0x1e654f(0x21c)?_0x230f0f:_0x2cafbf[_0x1e654f(0x278)])+':\x20'+String(_0x25c3e7[_0x1e654f(0x9a5)])['substring'](0x0,0x1e)+_0x1e654f(0x6cb))[_0x1e654f(0xa4b)]('\x0a'),_0x3d3a76=(_0x2cafbf[_0x1e654f(0x761)]['linkedWorldBookIds']||[])[_0x1e654f(0x796)](_0x451954=>_0x5de8b7[_0x1e654f(0xca)]['find'](_0x1e66fc=>_0x1e66fc['id']===_0x451954))['filter'](Boolean)[_0x1e654f(0x796)](_0xac9454=>_0x1e654f(0x10b5)+_0xac9454[_0x1e654f(0x278)]+'》设定:\x0a'+_0xac9454[_0x1e654f(0x9a5)][_0x1e654f(0x138)](_0x56c7c4=>_0x56c7c4[_0x1e654f(0xc34)])[_0x1e654f(0x796)](_0x6a0949=>'-\x20'+_0x6a0949[_0x1e654f(0x9a5)])[_0x1e654f(0xa4b)]('\x0a'))[_0x1e654f(0xa4b)](''),_0x1c75a1=_0x57277b(_0x2cafbf,0x3,_0x1e654f(0x1059)),_0x8fac7a=_0x57277b(_0x2cafbf,0x6,_0x1e654f(0x1059)),_0x36a156=_0x57277b(_0x2cafbf,0x9,_0x1e654f(0x1059)),_0x1bd128=_0x57277b(_0x2cafbf,0x1,'days'),_0x34637e=_0x57277b(_0x2cafbf,0x3,_0x1e654f(0xb95)),_0x546f20=_0x57277b(_0x2cafbf,0x7,_0x1e654f(0xb95));let _0xe97db7='';if(_0x1c75a1||_0x8fac7a||_0x36a156||_0x1bd128||_0x34637e||_0x546f20){_0xe97db7+=_0x1e654f(0xc91);if(_0x1c75a1)_0xe97db7+=_0x1c75a1;if(_0x8fac7a)_0xe97db7+=_0x8fac7a;if(_0x36a156)_0xe97db7+=_0x36a156;if(_0x1c75a1||_0x8fac7a||_0x36a156)_0xe97db7+='\x0a';if(_0x1bd128)_0xe97db7+=_0x1bd128;if(_0x34637e)_0xe97db7+=_0x34637e;if(_0x546f20)_0xe97db7+=_0x546f20;}const _0x3b321d=_0x1e654f(0xe2b)+_0x2cafbf[_0x1e654f(0x278)]+_0x1e654f(0x20a)+_0x2cafbf['settings']['aiPersona']+_0x1e654f(0x63c)+_0x37472c+'\x0a'+_0x3d3a76+'\x0a'+_0xe97db7+_0x1e654f(0x11ce)+_0x230f0f+_0x1e654f(0x1bc)+_0x35f482+'\x0a\x0a现在，请开始生成这组App使用记录。';try{const _0xe3b738=[{'role':'user','content':_0x1e654f(0x451)}];let _0x5362c0=_0x509b92[_0x1e654f(0x3ad)](_0x1e654f(0xb9b)),_0x2ce4e1=_0x4a90fe(_0x1e896d,_0x55486d,_0x3b321d,_0xe3b738);const _0x2c7d71=_0x5362c0?await fetch(_0x2ce4e1[_0x1e654f(0x10ac)],_0x2ce4e1[_0x1e654f(0x1cc)]):await fetch(_0x509b92+_0x1e654f(0x8fd),{'method':_0x1e654f(0x1128),'headers':{'Content-Type':_0x1e654f(0x35c),'Authorization':'Bearer\x20'+_0x55486d},'body':JSON['stringify']({'model':_0x1e896d,'messages':[{'role':'system','content':_0x3b321d},..._0xe3b738],'temperature':_0x5de8b7[_0x1e654f(0x2df)][_0x1e654f(0xe66)]||0.9})});if(!_0x2c7d71['ok'])throw new Error(_0x1e654f(0x307)+_0x2c7d71[_0x1e654f(0xfcf)]);const _0x309be1=await _0x2c7d71[_0x1e654f(0xd7b)](),_0x1b48c2=getGeminiResponseText(_0x309be1),_0x4ec035=_0x1b48c2[_0x1e654f(0x1018)](/^```json\s*/,'')[_0x1e654f(0x1018)](/```$/,''),_0x467239=JSON[_0x1e654f(0xb0c)](_0x4ec035);_0x2cafbf['simulatedAppUsage']=_0x467239,await _0x2e83f8[_0x1e654f(0x737)][_0x1e654f(0xe3c)](_0x2cafbf),await _0x1eee84();}catch(_0x5dfe4a){console[_0x1e654f(0x1c1)](_0x1e654f(0x87f),_0x5dfe4a),await _0x2fb06(_0x1e654f(0x334),_0x1e654f(0x2fe)+_0x5dfe4a['message']);}}function _0x1eee84(){const _0x12c8d3=_0x241b18,_0x1d7a65=document[_0x12c8d3(0x11e3)](_0x12c8d3(0x1160));_0x1d7a65[_0x12c8d3(0x595)]='';if(!_0x698363)return;const _0x3eb107=_0x5de8b7[_0x12c8d3(0x737)][_0x698363],_0x113a95=(_0x3eb107[_0x12c8d3(0xfa9)]||[])[_0x12c8d3(0x861)]((_0x254fd7,_0x1c79e3)=>_0x1c79e3[_0x12c8d3(0xef4)]-_0x254fd7[_0x12c8d3(0xef4)]);if(_0x113a95['length']===0x0){_0x1d7a65['innerHTML']=_0x12c8d3(0x572);return;}_0x113a95[_0x12c8d3(0x494)](_0x4f41dd=>{const _0x2fe730=_0x12c8d3,_0x363a59=document[_0x2fe730(0x383)](_0x2fe730(0x1285));_0x363a59['className']='char-usage-item';const _0x53dd2d=Math['floor'](_0x4f41dd[_0x2fe730(0xef4)]/0x3c),_0x289e49=_0x4f41dd[_0x2fe730(0xef4)]%0x3c;let _0x327ced='';if(_0x53dd2d>0x0)_0x327ced+=_0x53dd2d+'小时';if(_0x289e49>0x0)_0x327ced+=_0x289e49+'分钟';if(!_0x327ced)_0x327ced=_0x2fe730(0xab7);const _0x2c7948=_0x4f41dd[_0x2fe730(0xee6)]||_0x2fe730(0x385)+_0x4f41dd[_0x2fe730(0xb6)]+_0x2fe730(0x2e3),_0x24650d=_0x2fe730(0x35d)+encodeURIComponent(_0x2c7948);_0x363a59[_0x2fe730(0x595)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x24650d+_0x2fe730(0xa4d)+_0x4f41dd[_0x2fe730(0xb6)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>'+_0x4f41dd[_0x2fe730(0x382)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>'+_0x327ced+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1d7a65[_0x2fe730(0x120c)](_0x363a59);});}async function _0x337a1f(){const _0x40d4b5=_0x241b18;if(!_0x698363)return;const _0x26ddfe=_0x5de8b7[_0x40d4b5(0x737)][_0x698363];if(!_0x26ddfe)return;await _0x2fb06(_0x40d4b5(0x63d),'正在请求“'+_0x26ddfe[_0x40d4b5(0x278)]+_0x40d4b5(0x9d8));const {proxyUrl:_0x599880,apiKey:_0x3c9f91,model:_0x29e8a1}=_0x5de8b7[_0x40d4b5(0x89c)];if(!_0x599880||!_0x3c9f91||!_0x29e8a1){alert('请先在API设置中配置好API信息。');return;}const _0x295f71=_0x5de8b7[_0x40d4b5(0x1c5)][_0x40d4b5(0xa33)]===_0x40d4b5(0x833)||!_0x5de8b7[_0x40d4b5(0x1c5)][_0x40d4b5(0xa33)]?'用户':_0x5de8b7[_0x40d4b5(0x1c5)][_0x40d4b5(0xa33)],_0x13dbda=_0x26ddfe['longTermMemory']&&_0x26ddfe[_0x40d4b5(0xe21)][_0x40d4b5(0x594)]>0x0?_0x26ddfe[_0x40d4b5(0xe21)][_0x40d4b5(0x796)](_0x33d7b3=>_0x40d4b5(0xd12)+_0x497f2b(_0x33d7b3['timestamp'])+')\x20'+_0x33d7b3[_0x40d4b5(0x9a5)])[_0x40d4b5(0xa4b)]('\x0a'):'无',_0x563c12=_0x26ddfe[_0x40d4b5(0x761)][_0x40d4b5(0xb2e)]||0xa,_0x3eb21a=_0x26ddfe[_0x40d4b5(0x49e)][_0x40d4b5(0xa6c)](-_0x563c12)[_0x40d4b5(0x796)](_0x374b83=>(_0x374b83[_0x40d4b5(0xba4)]===_0x40d4b5(0x21c)?_0x295f71:_0x26ddfe['name'])+':\x20'+String(_0x374b83[_0x40d4b5(0x9a5)])['substring'](0x0,0x1e)+'...')[_0x40d4b5(0xa4b)]('\x0a'),_0x4f7cac=(_0x26ddfe[_0x40d4b5(0x761)][_0x40d4b5(0xa17)]||[])['map'](_0x4373b1=>_0x5de8b7[_0x40d4b5(0xca)][_0x40d4b5(0xe79)](_0x266c80=>_0x266c80['id']===_0x4373b1))[_0x40d4b5(0x138)](Boolean)[_0x40d4b5(0x796)](_0x22714b=>_0x40d4b5(0x10b5)+_0x22714b[_0x40d4b5(0x278)]+_0x40d4b5(0x63a)+_0x22714b[_0x40d4b5(0x9a5)][_0x40d4b5(0x138)](_0x21f543=>_0x21f543[_0x40d4b5(0xc34)])[_0x40d4b5(0x796)](_0xae98f3=>'-\x20'+_0xae98f3[_0x40d4b5(0x9a5)])[_0x40d4b5(0xa4b)]('\x0a'))[_0x40d4b5(0xa4b)](''),_0x31f74d=_0x40d4b5(0xe45)+_0x26ddfe[_0x40d4b5(0x278)]+_0x40d4b5(0xee)+_0x26ddfe['settings'][_0x40d4b5(0x8d5)]+_0x40d4b5(0x63c)+_0x13dbda+'\x0a'+_0x4f7cac+_0x40d4b5(0x11ce)+_0x295f71+'”的对话摘要**:\x0a'+_0x3eb21a+_0x40d4b5(0xf12);try{const _0x482b1c=[{'role':_0x40d4b5(0x21c),'content':'请根据你的设定，生成你的歌单。'}];let _0x436e06=_0x599880[_0x40d4b5(0x3ad)](_0x40d4b5(0xb9b)),_0x3ad5f6=_0x4a90fe(_0x29e8a1,_0x3c9f91,_0x31f74d,_0x482b1c);const _0x20667d=_0x436e06?await fetch(_0x3ad5f6[_0x40d4b5(0x10ac)],_0x3ad5f6[_0x40d4b5(0x1cc)]):await fetch(_0x599880+_0x40d4b5(0x8fd),{'method':_0x40d4b5(0x1128),'headers':{'Content-Type':_0x40d4b5(0x35c),'Authorization':_0x40d4b5(0xdaf)+_0x3c9f91},'body':JSON[_0x40d4b5(0x313)]({'model':_0x29e8a1,'messages':[{'role':_0x40d4b5(0xf72),'content':_0x31f74d},..._0x482b1c],'temperature':_0x5de8b7[_0x40d4b5(0x2df)]['apiTemperature']||0x1})});if(!_0x20667d['ok'])throw new Error(_0x40d4b5(0x307)+_0x20667d[_0x40d4b5(0xfcf)]);const _0x2d4be1=await _0x20667d['json'](),_0x437b0c=getGeminiResponseText(_0x2d4be1),_0x160582=_0x437b0c[_0x40d4b5(0x1018)](/^```json\s*/,'')[_0x40d4b5(0x1018)](/```$/,''),_0x3c3ead=JSON[_0x40d4b5(0xb0c)](_0x160582);await _0x2fb06('请稍候...',_0x40d4b5(0xec5)+_0x3c3ead[_0x40d4b5(0x594)]+'\x20首歌曲的详细信息...');const _0x206bc9=_0x3c3ead[_0x40d4b5(0x796)](async _0x5ee2b4=>{const _0x3bf2df=_0x40d4b5;let _0x41ce4b=await _0xfb33a3(_0x5ee2b4[_0x3bf2df(0xc2a)],_0x5ee2b4[_0x3bf2df(0x69e)]);(!_0x41ce4b||_0x41ce4b[_0x3bf2df(0x594)]===0x0)&&(_0x41ce4b=await _0x2f18e9(_0x5ee2b4[_0x3bf2df(0xc2a)]));if(_0x41ce4b['length']>0x0)return _0x1e525d(_0x41ce4b[0x0]);return console[_0x3bf2df(0x6b0)]('所有音乐源都未能找到歌曲：“'+_0x5ee2b4[_0x3bf2df(0xc2a)]+_0x3bf2df(0x12a2)+_0x5ee2b4['artistName']+'”'),null;}),_0x324d2e=(await Promise['all'](_0x206bc9))[_0x40d4b5(0x138)](Boolean);_0x26ddfe[_0x40d4b5(0xb9a)]=_0x324d2e,await _0x2e83f8[_0x40d4b5(0x737)][_0x40d4b5(0xe3c)](_0x26ddfe),await _0x5467a0();}catch(_0x46853c){console['error']('生成模拟歌单失败:',_0x46853c),await _0x2fb06(_0x40d4b5(0x334),'无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20'+_0x46853c['message']);}}function _0x5467a0(){const _0x4d72d1=_0x241b18,_0x52fc5c=document[_0x4d72d1(0x11e3)](_0x4d72d1(0xc17));_0x52fc5c[_0x4d72d1(0x595)]='';if(!_0x698363)return;const _0x1740cd=_0x5de8b7[_0x4d72d1(0x737)][_0x698363],_0x50eb0b=_0x1740cd[_0x4d72d1(0xb9a)]||[];if(_0x50eb0b[_0x4d72d1(0x594)]===0x0){_0x52fc5c[_0x4d72d1(0x595)]=_0x4d72d1(0x6cd);return;}_0x50eb0b[_0x4d72d1(0x494)]((_0x2bbcf9,_0x45b92c)=>{const _0x489153=_0x4d72d1,_0x22c698=document[_0x489153(0x383)](_0x489153(0x1285));_0x22c698['className']=_0x489153(0x7ba),_0x22c698[_0x489153(0x595)]=_0x489153(0xd6d)+_0x2bbcf9[_0x489153(0x2ee)]+'\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>'+_0x2bbcf9[_0x489153(0x278)]+_0x489153(0x708)+_0x2bbcf9['artist']+_0x489153(0xc2d),_0x22c698[_0x489153(0x4b8)](_0x489153(0x1041),()=>_0x11d82b(_0x2bbcf9)),_0x52fc5c[_0x489153(0x120c)](_0x22c698);});}let _0x2335a0={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':_0x241b18(0xd6a),'lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0x11d82b(_0x364703){const _0x5a5063=_0x241b18,_0x1fc652=document[_0x5a5063(0x11e3)](_0x5a5063(0xf1)),_0x2510b2=document[_0x5a5063(0x11e3)](_0x5a5063(0xc15));if(_0x2335a0[_0x5a5063(0x837)])clearInterval(_0x2335a0[_0x5a5063(0x837)]);_0x1fc652[_0x5a5063(0x9b1)]();const _0xb5516c=_0x2335a0[_0x5a5063(0x254)][_0x5a5063(0x901)](_0x4818e2=>_0x4818e2['src']===_0x364703[_0x5a5063(0xf0a)]);_0xb5516c>-0x1?_0x2335a0[_0x5a5063(0x12b5)]=_0xb5516c:(_0x2335a0['currentPlaylist']=[_0x364703],_0x2335a0[_0x5a5063(0x12b5)]=0x0);document[_0x5a5063(0x11e3)](_0x5a5063(0x116))[_0x5a5063(0x300)]=_0x364703[_0x5a5063(0x278)],document['getElementById']('char-music-artist')[_0x5a5063(0x300)]=_0x364703['artist'],document[_0x5a5063(0x11e3)](_0x5a5063(0x777))[_0x5a5063(0xf0a)]=_0x364703[_0x5a5063(0x2ee)],_0x2335a0[_0x5a5063(0x1194)]=_0x2a2377(_0x364703['lrcContent']||''),_0x1700c0();if(_0x364703[_0x5a5063(0x101e)]){const _0x5ac5f4=new Blob([_0x364703['src']],{'type':_0x364703[_0x5a5063(0xef0)]||_0x5a5063(0x8ae)});_0x1fc652['src']=URL[_0x5a5063(0x12fd)](_0x5ac5f4);}else _0x1fc652[_0x5a5063(0xf0a)]=_0x364703[_0x5a5063(0xf0a)];_0x1fc652[_0x5a5063(0x7d1)]()[_0x5a5063(0x100)](_0x5d35ec=>console['error'](_0x5a5063(0xaaf),_0x5d35ec)),_0x1fc652[_0x5a5063(0x1145)]=()=>{const _0x390fc0=_0x5a5063;document[_0x390fc0(0x11e3)](_0x390fc0(0x7db))[_0x390fc0(0x300)]=_0x5ce2fd(_0x1fc652[_0x390fc0(0x915)]),_0x2335a0[_0x390fc0(0x837)]=setInterval(_0x5bdd0f,0x1f4);},_0x2510b2[_0x5a5063(0x505)][_0x5a5063(0x252)](_0x5a5063(0x250));}function _0x7e1e21(){const _0x224fd4=_0x241b18,_0x5e66ac=document['getElementById'](_0x224fd4(0xc15)),_0x2780b8=document[_0x224fd4(0x11e3)]('char-audio-player');if(_0x2335a0[_0x224fd4(0x837)])clearInterval(_0x2335a0[_0x224fd4(0x837)]);_0x2780b8[_0x224fd4(0x9b1)](),_0x2780b8['src']='',_0x5e66ac[_0x224fd4(0x505)][_0x224fd4(0x957)](_0x224fd4(0x250)),_0x2335a0['isPlaying']=![],document[_0x224fd4(0x11e3)]('char-vinyl-container')[_0x224fd4(0x505)][_0x224fd4(0x957)]('spinning');}function _0x5bdd0f(){const _0x52d2dc=_0x241b18,_0x47705a=document[_0x52d2dc(0x11e3)](_0x52d2dc(0xf1));if(!_0x47705a['duration'])return;const _0xf7921e=_0x47705a[_0x52d2dc(0x1056)],_0x2aa5fe=_0x47705a[_0x52d2dc(0x915)];document[_0x52d2dc(0x11e3)]('char-music-progress-fill')[_0x52d2dc(0x794)][_0x52d2dc(0x1057)]=_0xf7921e/_0x2aa5fe*0x64+'%',document[_0x52d2dc(0x11e3)](_0x52d2dc(0x933))['textContent']=_0x5ce2fd(_0xf7921e),_0x23887e(_0xf7921e);}function _0x1700c0(){const _0x3a14f3=_0x241b18,_0x51fbad=document['getElementById'](_0x3a14f3(0x144));_0x51fbad[_0x3a14f3(0x595)]='',_0x2335a0['currentLyricIndex']=-0x1;if(!_0x2335a0['parsedLyrics']||_0x2335a0['parsedLyrics'][_0x3a14f3(0x594)]===0x0){_0x51fbad[_0x3a14f3(0x595)]='<p>♪\x20暂无歌词\x20♪</p>';return;}_0x2335a0[_0x3a14f3(0x1194)]['forEach']((_0x9f1a90,_0x330081)=>{const _0x1aaae8=_0x3a14f3,_0x4e57a1=document[_0x1aaae8(0x383)]('p');_0x4e57a1['textContent']=_0x9f1a90[_0x1aaae8(0x1197)],_0x4e57a1[_0x1aaae8(0xaca)]['index']=_0x330081,_0x51fbad[_0x1aaae8(0x120c)](_0x4e57a1);});}function _0x23887e(_0x592517){const _0x5f39bc=_0x241b18,_0x178f00=_0x2335a0[_0x5f39bc(0x1194)];if(_0x178f00[_0x5f39bc(0x594)]===0x0)return;let _0x945245=-0x1;for(let _0x4595d3=0x0;_0x4595d3<_0x178f00[_0x5f39bc(0x594)];_0x4595d3++){if(_0x592517>=_0x178f00[_0x4595d3][_0x5f39bc(0x1c7)])_0x945245=_0x4595d3;else break;}if(_0x945245===_0x2335a0['currentLyricIndex'])return;_0x2335a0[_0x5f39bc(0xe39)]=_0x945245;const _0x41337f=document[_0x5f39bc(0x11e3)]('char-music-lyrics'),_0x41e80d=_0x41337f[_0x5f39bc(0x10d6)]('p');_0x41e80d[_0x5f39bc(0x494)](_0xafaabe=>_0xafaabe[_0x5f39bc(0x505)][_0x5f39bc(0x957)](_0x5f39bc(0x1fc)));if(_0x945245>-0x1){const _0x405504=_0x41337f[_0x5f39bc(0x5ac)](_0x5f39bc(0x12c9)+_0x945245+'\x22]');if(_0x405504){_0x405504['classList'][_0x5f39bc(0x252)](_0x5f39bc(0x1fc));const _0x4194eb=_0x41337f[_0x5f39bc(0x10d9)]/0x2-_0x405504[_0x5f39bc(0x946)]-_0x405504[_0x5f39bc(0xea5)]/0x2;_0x41e80d[_0x5f39bc(0x494)](_0x20802e=>{const _0x36c5b2=_0x5f39bc;_0x20802e['style']['transform']=_0x36c5b2(0xc7d)+_0x4194eb+_0x36c5b2(0xd24);});}}}function _0xa0667(){const _0x26e60f=_0x241b18;if(_0x2335a0['currentPlaylist']['length']===0x0)return;let _0x1fe5a4;switch(_0x2335a0[_0x26e60f(0xd3b)]){case _0x26e60f(0x36d):_0x1fe5a4=Math['floor'](Math[_0x26e60f(0x36d)]()*_0x2335a0['currentPlaylist']['length']);break;case _0x26e60f(0xdd5):_0x11d82b(_0x2335a0[_0x26e60f(0x254)][_0x2335a0[_0x26e60f(0x12b5)]]);return;case _0x26e60f(0xd6a):default:_0x1fe5a4=(_0x2335a0['currentIndex']+0x1)%_0x2335a0[_0x26e60f(0x254)]['length'];break;}_0x11d82b(_0x2335a0['currentPlaylist'][_0x1fe5a4]);}function _0x3610b3(){const _0x31c161=_0x241b18;if(_0x2335a0[_0x31c161(0x254)][_0x31c161(0x594)]===0x0)return;const _0x397af6=(_0x2335a0[_0x31c161(0x12b5)]-0x1+_0x2335a0[_0x31c161(0x254)][_0x31c161(0x594)])%_0x2335a0[_0x31c161(0x254)][_0x31c161(0x594)];_0x11d82b(_0x2335a0['currentPlaylist'][_0x397af6]);}function _0x53a7ef(){const _0x4f9be2=_0x241b18,_0x40e8f2=[_0x4f9be2(0xd6a),_0x4f9be2(0x36d),_0x4f9be2(0xdd5)],_0x21a2bf=_0x40e8f2[_0x4f9be2(0xce1)](_0x2335a0[_0x4f9be2(0xd3b)]);_0x2335a0['playMode']=_0x40e8f2[(_0x21a2bf+0x1)%_0x40e8f2[_0x4f9be2(0x594)]],document[_0x4f9be2(0x11e3)](_0x4f9be2(0x10b2))['textContent']={'order':'顺序','random':'随机','single':'单曲'}[_0x2335a0[_0x4f9be2(0xd3b)]];}function _0x56e774(){const _0x5caee=_0x241b18,_0x1570d8=document[_0x5caee(0x11e3)]('char-audio-player'),_0x4a6b7d=document[_0x5caee(0x11e3)]('char-music-play-pause-btn'),_0x2c8ae8=document['getElementById'](_0x5caee(0x10fa));_0x4a6b7d[_0x5caee(0x4b8)](_0x5caee(0x1041),()=>{const _0xc27c7c=_0x5caee;if(_0x1570d8[_0xc27c7c(0x950)]){if(_0x2335a0[_0xc27c7c(0x12b5)]>-0x1)_0x1570d8[_0xc27c7c(0x7d1)]();}else _0x1570d8[_0xc27c7c(0x9b1)]();}),_0x1570d8[_0x5caee(0x6f2)]=()=>{const _0x59c25=_0x5caee;_0x4a6b7d['innerHTML']=_0x59c25(0x128f),_0x2c8ae8[_0x59c25(0x505)][_0x59c25(0x252)]('spinning'),_0x2335a0[_0x59c25(0x9b0)]=!![];},_0x1570d8[_0x5caee(0x6f6)]=()=>{const _0xb07184=_0x5caee;_0x4a6b7d['innerHTML']=_0xb07184(0xab0),_0x2c8ae8[_0xb07184(0x505)][_0xb07184(0x957)](_0xb07184(0x485)),_0x2335a0['isPlaying']=![];},_0x1570d8[_0x5caee(0x1108)]=()=>{const _0xda6ed3=_0x5caee;_0x2c8ae8[_0xda6ed3(0x505)][_0xda6ed3(0x957)](_0xda6ed3(0x485)),_0x2335a0[_0xda6ed3(0x9b0)]=![],_0xa0667();},document[_0x5caee(0x11e3)](_0x5caee(0x596))['addEventListener'](_0x5caee(0x1041),_0x3610b3),document[_0x5caee(0x11e3)](_0x5caee(0x14a))[_0x5caee(0x4b8)](_0x5caee(0x1041),_0xa0667),document[_0x5caee(0x11e3)](_0x5caee(0x10b2))[_0x5caee(0x4b8)]('click',_0x53a7ef),document['getElementById'](_0x5caee(0x80a))[_0x5caee(0x4b8)](_0x5caee(0x1041),_0x466ac0=>{const _0x1aa976=_0x5caee;if(!_0x1570d8[_0x1aa976(0x915)])return;const _0x99c56a=_0x466ac0[_0x1aa976(0x726)],_0x1f0c99=_0x466ac0[_0x1aa976(0x7f0)];_0x1570d8['currentTime']=_0x1f0c99/_0x99c56a[_0x1aa976(0xf76)]*_0x1570d8['duration'];});}async function _0x5f3633(){const _0x1baa78=_0x241b18,_0x1bbab9=document[_0x1baa78(0x11e3)](_0x1baa78(0x27e));_0x1bbab9['innerHTML']='';const _0x10efe7=await _0x2e83f8[_0x1baa78(0x12f7)][_0x1baa78(0x7c6)](_0x1baa78(0x702))[_0x1baa78(0x107)]()['toArray']();if(_0x10efe7[_0x1baa78(0x594)]===0x0){_0x1bbab9[_0x1baa78(0x595)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>';return;}_0x10efe7[_0x1baa78(0x494)](_0x2dc0ac=>{const _0x67d72b=_0x1baa78;let _0x533abf;const _0x4b3701=_0x2dc0ac[_0x67d72b(0x1211)]?Object[_0x67d72b(0x4ca)](_0x5de8b7[_0x67d72b(0x737)])['find'](_0x26f8fd=>!_0x26f8fd[_0x67d72b(0x1244)]&&_0x26f8fd[_0x67d72b(0x278)]===_0x2dc0ac['authorOriginalName']):null;if(_0x4b3701)_0x533abf=_0x4b3701['settings'][_0x67d72b(0x5e0)];else{const _0x1e1aaf=Object[_0x67d72b(0x4ca)](_0x5de8b7[_0x67d72b(0x737)])[_0x67d72b(0xe79)](_0x10296f=>!_0x10296f[_0x67d72b(0x1244)]&&_0x10296f['name']===_0x2dc0ac[_0x67d72b(0xd5a)]);if(_0x1e1aaf)_0x533abf=_0x1e1aaf[_0x67d72b(0x761)][_0x67d72b(0x5e0)];else _0x2dc0ac['authorAvatarPrompt']?_0x533abf='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x2dc0ac['authorAvatarPrompt']):_0x533abf=_0x3d2e44;}const _0x6fbfd3=document[_0x67d72b(0x383)](_0x67d72b(0x1285));_0x6fbfd3[_0x67d72b(0x3db)]=_0x67d72b(0x2d9),_0x6fbfd3[_0x67d72b(0x1074)]=()=>_0x216507(_0x2dc0ac['id']),_0x6fbfd3[_0x67d72b(0x595)]=_0x67d72b(0x5e2)+_0x533abf+_0x67d72b(0xeb1)+_0x2dc0ac[_0x67d72b(0xd5a)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20'+_0x2dc0ac[_0x67d72b(0x25a)]+_0x67d72b(0x98e)+_0x2dc0ac[_0x67d72b(0x75a)]+_0x67d72b(0x11b2)+_0x2dc0ac['content'][_0x67d72b(0x1018)](/\n/g,_0x67d72b(0xf70))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20'+_0x2dc0ac[_0x67d72b(0x4b7)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20'+_0x2dc0ac[_0x67d72b(0x12ef)]+_0x67d72b(0x668)+_0x497f2b(_0x2dc0ac[_0x67d72b(0x702)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x1bbab9[_0x67d72b(0x120c)](_0x6fbfd3);});}async function _0x2dc469(){const _0x45db6e=_0x241b18,_0x9dcd8d=_0x5de8b7[_0x45db6e(0x2df)]['doubanActiveCharacterIds']||[];if(_0x9dcd8d[_0x45db6e(0x594)]===0x0){await _0x2fb06('请先选择角色',_0x45db6e(0xe32));return;}await _0x2fb06(_0x45db6e(0x63d),_0x45db6e(0x1254)+_0x9dcd8d[_0x45db6e(0x594)]+'\x20位角色生成豆瓣动态...');const {proxyUrl:_0x293300,apiKey:_0x17ec12,model:_0x30e1ab}=_0x5de8b7[_0x45db6e(0x89c)];if(!_0x293300||!_0x17ec12||!_0x30e1ab){alert(_0x45db6e(0xace));return;}const _0x2d5b97=new Set();_0x9dcd8d['forEach'](_0x339730=>{const _0x39ab58=_0x45db6e,_0x356299=_0x5de8b7[_0x39ab58(0x737)][_0x339730];_0x356299&&_0x356299[_0x39ab58(0x761)][_0x39ab58(0xa17)]&&_0x356299['settings'][_0x39ab58(0xa17)][_0x39ab58(0x494)](_0x80f65a=>_0x2d5b97[_0x39ab58(0x252)](_0x80f65a));});let _0xb56d19='';_0x2d5b97[_0x45db6e(0x1159)]>0x0&&(_0xb56d19+=_0x45db6e(0x104f),_0x2d5b97[_0x45db6e(0x494)](_0x1bfde1=>{const _0x333515=_0x45db6e,_0x8a64cc=_0x5de8b7[_0x333515(0xca)][_0x333515(0xe79)](_0x5152ab=>_0x5152ab['id']===_0x1bfde1);if(_0x8a64cc){const _0x40c5ef=_0x8a64cc[_0x333515(0x9a5)][_0x333515(0x138)](_0x3eeb4c=>_0x3eeb4c[_0x333515(0xc34)]!==![])['map'](_0x7bb6fe=>'-\x20'+_0x7bb6fe[_0x333515(0x9a5)])[_0x333515(0xa4b)]('\x0a');_0x40c5ef&&(_0xb56d19+=_0x333515(0x8b1)+_0x8a64cc[_0x333515(0x278)]+_0x333515(0x844)+_0x40c5ef);}}));const _0x220ad5=_0x5de8b7['worldBooks'][_0x45db6e(0xe79)](_0x1df984=>_0x1df984[_0x45db6e(0x278)]==='豆瓣设定');let _0xfdd0fe='',_0x1702b9=[];_0x220ad5&&_0x220ad5[_0x45db6e(0x9a5)][_0x45db6e(0x494)](_0x2824f0=>{const _0xff0d22=_0x45db6e;_0x2824f0[_0xff0d22(0xebd)][_0xff0d22(0x3ad)](_0xff0d22(0x51d))&&(_0xfdd0fe+='\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a'+_0x2824f0[_0xff0d22(0x9a5)]);if(_0x2824f0['comment'][_0xff0d22(0x3ad)]('NPC人设')){const _0x3207a6=_0x2824f0['content'][_0xff0d22(0x65b)]('\x0a');_0x3207a6['forEach'](_0x1cdbcc=>{const _0x5506f4=_0xff0d22,_0x4a3a20=_0x1cdbcc[_0x5506f4(0xe9f)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x4a3a20&&_0x1702b9['push']({'name':_0x4a3a20[0x1][_0x5506f4(0xeb7)](),'persona':_0x4a3a20[0x2][_0x5506f4(0xeb7)]()});});}});const _0xcad6cb=_0x5de8b7[_0x45db6e(0x1c5)][_0x45db6e(0xa33)]||'我',_0x5cf281=_0x9dcd8d[_0x45db6e(0x594)]>0x0&&_0x5de8b7['chats'][_0x9dcd8d[0x0]]?_0x5de8b7['chats'][_0x9dcd8d[0x0]][_0x45db6e(0x761)][_0x45db6e(0x10c5)]:_0x45db6e(0x5ce);let _0x33cc97='';_0x9dcd8d['forEach'](_0x9dc40d=>{const _0x1d8691=_0x45db6e,_0x26754d=_0x5de8b7['chats'][_0x9dc40d];if(_0x26754d){const _0x3f3931=_0x26754d[_0x1d8691(0xe21)]&&_0x26754d['longTermMemory'][_0x1d8691(0x594)]>0x0?_0x26754d['longTermMemory'][_0x1d8691(0x796)](_0x48e546=>_0x48e546[_0x1d8691(0x9a5)])['join'](';\x20'):'无',_0x14c0ee=_0x26754d['history'][_0x1d8691(0xa6c)](-0xa)['map'](_0x3acc3e=>(_0x3acc3e[_0x1d8691(0xba4)]===_0x1d8691(0x21c)?_0xcad6cb:_0x26754d[_0x1d8691(0x278)])+':\x20'+String(_0x3acc3e['content'])['substring'](0x0,0x1e)+_0x1d8691(0x6cb))[_0x1d8691(0xa4b)]('\x0a');_0x33cc97+=_0x1d8691(0x12e)+_0x26754d['name']+'</name>\x0a\x20\x20<persona>'+_0x26754d['settings']['aiPersona']+'</persona>\x0a\x20\x20<memory>'+_0x3f3931+_0x1d8691(0xfdc)+_0x14c0ee+_0x1d8691(0x11c8);}}),_0x1702b9[_0x45db6e(0x494)](_0x343d15=>{const _0x4dacd8=_0x45db6e;_0x33cc97+=_0x4dacd8(0x12e)+_0x343d15[_0x4dacd8(0x278)]+_0x4dacd8(0xf9d)+_0x343d15[_0x4dacd8(0x701)]+_0x4dacd8(0x5c5);});const _0x102c0d=new Date(),_0x5c0c4d=_0x102c0d['toLocaleString'](_0x45db6e(0x898),{'dateStyle':'full','timeStyle':_0x45db6e(0x3f8)}),_0x90bab8=_0x5de8b7[_0x45db6e(0x2df)][_0x45db6e(0xaba)]||0xc,_0x33cc24=_0x5de8b7['globalSettings'][_0x45db6e(0xc74)]||0x14,_0x41364c='\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【'+_0x90bab8+'到'+_0x33cc24+_0x45db6e(0xe0f)+_0x5c0c4d+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“'+_0xcad6cb+_0x45db6e(0xc8e)+_0xcad6cb+_0x45db6e(0x926)+_0xfdd0fe+'\x0a'+_0xb56d19+'\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20'+_0x5c0c4d+'\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20'+_0xcad6cb+'\x0a-\x20**人设**:\x20'+_0x5cf281+'\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a'+_0x33cc97+_0x45db6e(0x70c);try{const _0x2a03bc=[{'role':_0x45db6e(0x21c),'content':_0x45db6e(0x1051)}];let _0x26061b=_0x293300[_0x45db6e(0x3ad)](_0x45db6e(0xb9b)),_0x5e879b=_0x4a90fe(_0x30e1ab,_0x17ec12,_0x41364c,_0x2a03bc);const _0x51b54a=_0x26061b?await fetch(_0x5e879b[_0x45db6e(0x10ac)],_0x5e879b['data']):await fetch(_0x293300+_0x45db6e(0x8fd),{'method':_0x45db6e(0x1128),'headers':{'Content-Type':_0x45db6e(0x35c),'Authorization':_0x45db6e(0xdaf)+_0x17ec12},'body':JSON[_0x45db6e(0x313)]({'model':_0x30e1ab,'messages':[{'role':_0x45db6e(0xf72),'content':_0x41364c},..._0x2a03bc],'temperature':_0x5de8b7[_0x45db6e(0x2df)][_0x45db6e(0xe66)]||0x1})});if(!_0x51b54a['ok'])throw new Error(_0x45db6e(0x307)+_0x51b54a[_0x45db6e(0xfcf)]);const _0x57175d=await _0x51b54a[_0x45db6e(0xd7b)](),_0x402ce5=getGeminiResponseText(_0x57175d),_0x4ed36f=_0x402ce5['match'](/\[[\s\S]*\]/);if(!_0x4ed36f)throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x402ce5);const _0x34a0b1=JSON[_0x45db6e(0xb0c)](_0x4ed36f[0x0]);await _0x2e83f8[_0x45db6e(0x12f7)][_0x45db6e(0x7ab)](),await _0x2e83f8['doubanPosts'][_0x45db6e(0xc16)](_0x34a0b1[_0x45db6e(0x796)](_0x27a9f3=>({..._0x27a9f3,'timestamp':Date[_0x45db6e(0x1182)]()-Math[_0x45db6e(0x36d)]()*0x186a0}))),await _0x5f3633();}catch(_0x3c9087){console['error'](_0x45db6e(0x10ba),_0x3c9087),await _0x2fb06(_0x45db6e(0x334),'无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20'+_0x3c9087[_0x45db6e(0x4bc)]);}}async function _0x216507(_0x14fd76){const _0xc843b2=_0x241b18;_0x4e7698('douban-post-detail-screen'),_0x3bea2e=_0x14fd76;const _0x52c54d=await _0x2e83f8[_0xc843b2(0x12f7)][_0xc843b2(0x1289)](_0x14fd76);if(!_0x52c54d){_0x4e7698(_0xc843b2(0xacd));return;}document[_0xc843b2(0x11e3)](_0xc843b2(0x6c6))['textContent']=_0xc843b2(0xf36);let _0x2968ca=_0x3d2e44,_0x4d2749=_0x52c54d[_0xc843b2(0xd5a)];const _0x3939d8=_0x52c54d[_0xc843b2(0x1211)]?Object[_0xc843b2(0x4ca)](_0x5de8b7[_0xc843b2(0x737)])[_0xc843b2(0xe79)](_0xa41485=>!_0xa41485[_0xc843b2(0x1244)]&&_0xa41485['originalName']===_0x52c54d[_0xc843b2(0x1211)]):null;if(_0x3939d8)_0x2968ca=_0x3939d8[_0xc843b2(0x761)][_0xc843b2(0x5e0)];else{const _0x5c20c9=Object[_0xc843b2(0x4ca)](_0x5de8b7['chats'])[_0xc843b2(0xe79)](_0x4876dc=>!_0x4876dc[_0xc843b2(0x1244)]&&_0x4876dc[_0xc843b2(0x278)]===_0x52c54d[_0xc843b2(0xd5a)]);if(_0x5c20c9)_0x2968ca=_0x5c20c9['settings'][_0xc843b2(0x5e0)];else _0x52c54d['authorAvatarPrompt']&&(_0x2968ca=_0xc843b2(0x35d)+encodeURIComponent(_0x52c54d['authorAvatarPrompt']));}document[_0xc843b2(0x11e3)](_0xc843b2(0x2fc))['src']=_0x2968ca,document[_0xc843b2(0x11e3)](_0xc843b2(0xeb3))[_0xc843b2(0x300)]=_0x4d2749,document[_0xc843b2(0x11e3)](_0xc843b2(0x1086))[_0xc843b2(0x300)]='来自\x20'+_0x52c54d['groupName'],document[_0xc843b2(0x11e3)]('douban-detail-post-title')[_0xc843b2(0x300)]=_0x52c54d[_0xc843b2(0x75a)],document[_0xc843b2(0x11e3)]('douban-detail-content')[_0xc843b2(0x595)]=_0x52c54d[_0xc843b2(0x9a5)]['replace'](/\n/g,'<br>'),document[_0xc843b2(0x11e3)](_0xc843b2(0x10c6))[_0xc843b2(0xf0a)]=_0x5de8b7['qzoneSettings'][_0xc843b2(0x525)],document[_0xc843b2(0x11e3)](_0xc843b2(0x185))['value']='';const _0x3fdb6c=document[_0xc843b2(0x11e3)](_0xc843b2(0x50d));_0x3fdb6c[_0xc843b2(0x595)]='';if(_0x52c54d[_0xc843b2(0x1092)]&&_0x52c54d[_0xc843b2(0x1092)][_0xc843b2(0x594)]>0x0){const _0x502620=new Map();_0x52c54d[_0xc843b2(0x1092)][_0xc843b2(0x494)](_0x133536=>{const _0x57b420=_0xc843b2;let _0xa0c3bc=_0x3d2e44;const _0x4deb38=_0x5de8b7['qzoneSettings'][_0x57b420(0xa33)]||'我',_0x466ae6=_0x133536[_0x57b420(0x682)];if(_0x502620['has'](_0x466ae6))_0xa0c3bc=_0x502620[_0x57b420(0x1289)](_0x466ae6);else{if(_0x466ae6===_0x4deb38)_0xa0c3bc=_0x5de8b7[_0x57b420(0x1c5)][_0x57b420(0x525)];else{if(_0x466ae6===_0x52c54d[_0x57b420(0xd5a)])_0xa0c3bc=_0x2968ca;else{const _0x41c3ec=_0x133536[_0x57b420(0x42a)]?Object[_0x57b420(0x4ca)](_0x5de8b7[_0x57b420(0x737)])['find'](_0xcca85e=>!_0xcca85e[_0x57b420(0x1244)]&&_0xcca85e[_0x57b420(0x697)]===_0x133536[_0x57b420(0x42a)]):null;if(_0x41c3ec)_0xa0c3bc=_0x41c3ec[_0x57b420(0x761)][_0x57b420(0x5e0)];else{const _0x1c9a2d=Object[_0x57b420(0x4ca)](_0x5de8b7['chats'])[_0x57b420(0xe79)](_0x148c4d=>!_0x148c4d[_0x57b420(0x1244)]&&_0x148c4d[_0x57b420(0x278)]===_0x466ae6);if(_0x1c9a2d)_0xa0c3bc=_0x1c9a2d[_0x57b420(0x761)][_0x57b420(0x5e0)];else _0x133536[_0x57b420(0x114c)]&&(_0xa0c3bc=_0x57b420(0x35d)+encodeURIComponent(_0x133536['avatar_prompt']));}}}_0x502620[_0x57b420(0xb25)](_0x466ae6,_0xa0c3bc);}const _0x49bdb0=document[_0x57b420(0x383)](_0x57b420(0x1285));_0x49bdb0[_0x57b420(0x3db)]='douban-comment-item',_0x49bdb0['innerHTML']=_0x57b420(0xdcc)+_0xa0c3bc+_0x57b420(0x111f)+_0x466ae6+_0x57b420(0x2a4)+_0x133536[_0x57b420(0x1197)]['replace'](/\n/g,_0x57b420(0xf70))+_0x57b420(0x1300),_0x3fdb6c['appendChild'](_0x49bdb0);});}else _0x3fdb6c['innerHTML']=_0xc843b2(0xe54);const _0x43421f=document[_0xc843b2(0x11e3)](_0xc843b2(0x2cd));if(_0x43421f)_0x43421f['scrollTop']=0x0;}async function _0x4ae0c2(){const _0x7a6545=_0x241b18;if(!_0x3bea2e)return;const _0x456240=document[_0x7a6545(0x11e3)](_0x7a6545(0x185)),_0x12e4bc=_0x456240[_0x7a6545(0xf27)][_0x7a6545(0xeb7)]();if(!_0x12e4bc)return;const _0x480833=await _0x2e83f8[_0x7a6545(0x12f7)]['get'](_0x3bea2e);if(!_0x480833)return;!_0x480833[_0x7a6545(0x1092)]&&(_0x480833[_0x7a6545(0x1092)]=[]);const _0x2317e1=_0x5de8b7[_0x7a6545(0x1c5)]['nickname']||'我';_0x480833[_0x7a6545(0x1092)][_0x7a6545(0xf5)]({'commenter':_0x2317e1,'text':_0x12e4bc}),_0x480833[_0x7a6545(0x12ef)]++,await _0x2e83f8[_0x7a6545(0x12f7)][_0x7a6545(0xe3c)](_0x480833),_0x456240[_0x7a6545(0xf27)]='',await _0x216507(_0x3bea2e);}async function _0x187a0f(){const _0x1ae38=_0x241b18;if(!_0x3bea2e)return;const _0x3791e1=_0x3bea2e,_0x3986c6=await _0x2e83f8[_0x1ae38(0x12f7)][_0x1ae38(0x1289)](_0x3791e1);if(!_0x3986c6)return;const _0x3906a7=_0x3986c6[_0x1ae38(0x1092)]&&_0x3986c6[_0x1ae38(0x1092)][_0x1ae38(0xa6c)](-0x1)[0x0];if(!_0x3906a7){alert('还没有任何评论，无法等待回复。');return;}await _0x2fb06(_0x1ae38(0x63d),_0x1ae38(0xdf1));try{const {proxyUrl:_0x23210e,apiKey:_0x4aca01,model:_0x29cceb}=_0x5de8b7[_0x1ae38(0x89c)];if(!_0x23210e||!_0x4aca01||!_0x29cceb)throw new Error('API未配置，无法生成内容。');const _0x315cf6=_0x5de8b7[_0x1ae38(0x1c5)]['nickname']||'我',_0x373ebb=_0x5de8b7[_0x1ae38(0x737)][Object[_0x1ae38(0xb4a)](_0x5de8b7[_0x1ae38(0x737)])[0x0]]?.[_0x1ae38(0x761)][_0x1ae38(0x10c5)]||'(未设置)',_0x346b6e=new Map();_0x3986c6[_0x1ae38(0x1092)]&&_0x3986c6[_0x1ae38(0x1092)][_0x1ae38(0x494)](_0x13b273=>{const _0x141cd6=_0x1ae38,_0x17bf23=(_0x5de8b7[_0x141cd6(0x2df)][_0x141cd6(0x3e9)]||[])[_0x141cd6(0xe7c)](_0x705f0b=>_0x5de8b7[_0x141cd6(0x737)][_0x705f0b]?.[_0x141cd6(0x278)]===_0x13b273[_0x141cd6(0x682)]);!_0x17bf23&&_0x13b273['avatar_prompt']&&_0x346b6e[_0x141cd6(0xb25)](_0x13b273['commenter'],_0x13b273[_0x141cd6(0x114c)]);});let _0x3bd10f='#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a';_0x346b6e[_0x1ae38(0x1159)]>0x0?(_0x3bd10f+='如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a',_0x346b6e[_0x1ae38(0x494)]((_0x11b2e5,_0x4130d3)=>{const _0x4f6b3f=_0x1ae38;_0x3bd10f+='-\x20**'+_0x4130d3+_0x4f6b3f(0x1138)+_0x11b2e5+'\x22\x0a';})):_0x3bd10f+=_0x1ae38(0xb23);const _0x5cde4b=_0x5de8b7[_0x1ae38(0xca)]['find'](_0x2f0a3f=>_0x2f0a3f[_0x1ae38(0x278)]===_0x1ae38(0x1247));let _0x4043fa=[];_0x5cde4b&&_0x5cde4b[_0x1ae38(0x9a5)]['forEach'](_0x142aa4=>{const _0x3238d8=_0x1ae38;if(_0x142aa4[_0x3238d8(0xebd)][_0x3238d8(0x3ad)](_0x3238d8(0x108c))){const _0xa1b8b6=_0x142aa4[_0x3238d8(0x9a5)][_0x3238d8(0x65b)]('\x0a');_0xa1b8b6[_0x3238d8(0x494)](_0x2fae2e=>{const _0x5bce15=_0x3238d8,_0x527b5d=_0x2fae2e['match'](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x527b5d&&_0x4043fa[_0x5bce15(0xf5)]({'name':_0x527b5d[0x1][_0x5bce15(0xeb7)](),'persona':_0x527b5d[0x2]['trim']()});});}});let _0x1a1340='';const _0x15c84b=_0x5de8b7[_0x1ae38(0x2df)]['doubanActiveCharacterIds']||[];_0x15c84b[_0x1ae38(0x494)](_0x343f09=>{const _0x16c803=_0x1ae38,_0x307fc2=_0x5de8b7[_0x16c803(0x737)][_0x343f09];if(_0x307fc2){const _0x32fa64=_0x307fc2['longTermMemory']&&_0x307fc2[_0x16c803(0xe21)][_0x16c803(0x594)]>0x0?_0x307fc2['longTermMemory'][_0x16c803(0x796)](_0x70aba2=>_0x70aba2[_0x16c803(0x9a5)])['join'](';\x20'):'无',_0x3b21e5=_0x307fc2[_0x16c803(0x49e)][_0x16c803(0xa6c)](-0xa)[_0x16c803(0x796)](_0x34f38a=>(_0x34f38a[_0x16c803(0xba4)]==='user'?_0x315cf6:_0x307fc2[_0x16c803(0x278)])+':\x20'+String(_0x34f38a['content'])[_0x16c803(0x8d4)](0x0,0x1e)+_0x16c803(0x6cb))[_0x16c803(0xa4b)]('\x0a');_0x1a1340+=_0x16c803(0x633)+_0x307fc2[_0x16c803(0x278)]+':\x20'+_0x307fc2['settings'][_0x16c803(0x8d5)][_0x16c803(0x8d4)](0x0,0x32)+'...\x20[记忆:\x20'+_0x32fa64+']\x20[最近对话:\x20'+_0x3b21e5+']';}}),_0x4043fa[_0x1ae38(0x494)](_0x38ef2d=>{_0x1a1340+='\x0a-\x20'+_0x38ef2d['name']+':\x20'+_0x38ef2d['persona'];});const _0x7b8ff5=new Date(),_0xf7090=_0x7b8ff5[_0x1ae38(0x9df)]('zh-CN',{'dateStyle':'full','timeStyle':'short'}),_0x59b14a=_0x1ae38(0x1293)+_0x315cf6+_0x1ae38(0xf56)+_0xf7090+_0x1ae38(0x548)+_0x315cf6+_0x1ae38(0x640)+_0x315cf6+'”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《'+_0x3986c6['postTitle']+_0x1ae38(0x1202)+_0x3986c6['authorName']+_0x1ae38(0xe6e)+_0x3986c6['content'][_0x1ae38(0x8d4)](0x0,0x64)+_0x1ae38(0x6df)+_0x3986c6[_0x1ae38(0x1092)][_0x1ae38(0x796)](_0x48a03d=>'-\x20'+_0x48a03d['commenter']+':\x20'+_0x48a03d[_0x1ae38(0x1197)])['join']('\x0a')+'\x0a\x0a'+_0x3bd10f+'\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20'+_0xf7090+_0x1ae38(0x40a)+_0x315cf6+_0x1ae38(0xc11)+_0x373ebb+'\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a'+_0x1a1340+'\x0a\x0a现在，请生成新的评论。',_0x12b3a7=[{'role':_0x1ae38(0x21c),'content':_0x1ae38(0x46f)}];let _0x4e08f7=_0x23210e['includes'](_0x1ae38(0xb9b)),_0x832d5c=_0x4a90fe(_0x29cceb,_0x4aca01,_0x59b14a,_0x12b3a7);const _0x2153e9=_0x4e08f7?await fetch(_0x832d5c[_0x1ae38(0x10ac)],_0x832d5c[_0x1ae38(0x1cc)]):await fetch(_0x23210e+_0x1ae38(0x8fd),{'method':_0x1ae38(0x1128),'headers':{'Content-Type':_0x1ae38(0x35c),'Authorization':'Bearer\x20'+_0x4aca01},'body':JSON['stringify']({'model':_0x29cceb,'messages':[{'role':_0x1ae38(0xf72),'content':_0x59b14a},..._0x12b3a7],'temperature':_0x5de8b7[_0x1ae38(0x2df)][_0x1ae38(0xe66)]||0x1})});if(!_0x2153e9['ok'])throw new Error(_0x1ae38(0x307)+_0x2153e9[_0x1ae38(0xfcf)]);const _0x467770=await _0x2153e9[_0x1ae38(0xd7b)](),_0x18a17b=getGeminiResponseText(_0x467770),_0xe24573=_0x18a17b[_0x1ae38(0x1018)](/^```json\s*/,'')['replace'](/```$/,''),_0x5bc280=JSON[_0x1ae38(0xb0c)](_0xe24573);Array['isArray'](_0x5bc280)&&_0x5bc280[_0x1ae38(0x594)]>0x0&&(_0x3986c6['comments'][_0x1ae38(0xf5)](..._0x5bc280),_0x3986c6[_0x1ae38(0x12ef)]+=_0x5bc280[_0x1ae38(0x594)],await _0x2e83f8[_0x1ae38(0x12f7)][_0x1ae38(0xe3c)](_0x3986c6)),await _0x216507(_0x3791e1),_0x225a39();}catch(_0xf17831){console[_0x1ae38(0x1c1)](_0x1ae38(0x1f9),_0xf17831),await _0x2fb06('操作失败',_0x1ae38(0xa8f)+_0xf17831[_0x1ae38(0x4bc)]);}}async function _0x5f5039(){const _0x371013=_0x241b18,_0x55f4a0=document[_0x371013(0x11e3)]('douban-cast-modal'),_0x1af034=document[_0x371013(0x11e3)](_0x371013(0x12d6));_0x1af034['innerHTML']='';const _0x47f007=Object[_0x371013(0x4ca)](_0x5de8b7['chats'])[_0x371013(0x138)](_0x1b2bcd=>!_0x1b2bcd[_0x371013(0x1244)]),_0x637ca=new Set(_0x5de8b7['globalSettings'][_0x371013(0x3e9)]||[]);_0x47f007['length']===0x0?_0x1af034[_0x371013(0x595)]=_0x371013(0x284):_0x47f007[_0x371013(0x494)](_0x41f2c2=>{const _0x5dfb4f=_0x371013,_0x32b088=document['createElement'](_0x5dfb4f(0x1285));_0x32b088[_0x5dfb4f(0x3db)]='contact-picker-item',_0x32b088[_0x5dfb4f(0x595)]=_0x5dfb4f(0x836)+_0x41f2c2['id']+'\x22\x20'+(_0x637ca[_0x5dfb4f(0x72a)](_0x41f2c2['id'])?_0x5dfb4f(0x3e4):'')+_0x5dfb4f(0xf2c)+(_0x41f2c2[_0x5dfb4f(0x761)][_0x5dfb4f(0x5e0)]||_0x3d2e44)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x41f2c2['name']+_0x5dfb4f(0x12e8),_0x1af034[_0x5dfb4f(0x120c)](_0x32b088);}),_0x55f4a0[_0x371013(0x505)][_0x371013(0x252)](_0x371013(0x250));}async function _0x1908e7(){const _0x2d5157=_0x241b18,_0x2d02d9=document[_0x2d5157(0x10d6)](_0x2d5157(0xc90)),_0x532078=Array[_0x2d5157(0xee2)](_0x2d02d9)['map'](_0xc3448c=>_0xc3448c[_0x2d5157(0xaca)][_0x2d5157(0x115)]);_0x5de8b7[_0x2d5157(0x2df)][_0x2d5157(0x3e9)]=_0x532078,await _0x2e83f8[_0x2d5157(0x2df)][_0x2d5157(0xe3c)](_0x5de8b7['globalSettings']),document['getElementById'](_0x2d5157(0x122a))[_0x2d5157(0x505)]['remove'](_0x2d5157(0x250)),await _0x2dc469();}document[_0x241b18(0x11e3)](_0x241b18(0xe4a))[_0x241b18(0x4b8)](_0x241b18(0x1041),_0x5f5039),document[_0x241b18(0x11e3)]('cancel-douban-cast-btn')[_0x241b18(0x4b8)](_0x241b18(0x1041),()=>{const _0x29d1f7=_0x241b18;document[_0x29d1f7(0x11e3)]('douban-cast-modal')['classList'][_0x29d1f7(0x957)](_0x29d1f7(0x250));}),document['getElementById']('save-douban-cast-btn')[_0x241b18(0x4b8)](_0x241b18(0x1041),_0x1908e7),document['getElementById'](_0x241b18(0x12d6))[_0x241b18(0x4b8)](_0x241b18(0x1041),_0x4a16fc=>{const _0x2d70bb=_0x241b18,_0x4a7067=_0x4a16fc['target'][_0x2d70bb(0xfe1)](_0x2d70bb(0xcb4));if(_0x4a7067){const _0x28495f=_0x4a7067['querySelector'](_0x2d70bb(0xbf));_0x28495f&&_0x4a16fc['target']!==_0x28495f&&(_0x28495f['checked']=!_0x28495f['checked']);}});async function _0xfa2c32(_0x489d4c){const _0x8cf6e9=_0x241b18;if(!_0x489d4c)return;const _0x2af7c8=await _0x58fd60('导入外观设置','这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？',{'confirmText':_0x8cf6e9(0xfcc)});if(!_0x2af7c8)return;try{const _0x4af112=await _0x489d4c[_0x8cf6e9(0x1197)](),_0x56f304=JSON[_0x8cf6e9(0xb0c)](_0x4af112);if(!_0x56f304[_0x8cf6e9(0x11d)]&&!_0x56f304[_0x8cf6e9(0x691)]&&!_0x56f304[_0x8cf6e9(0x18b)])throw new Error(_0x8cf6e9(0x7b7));Object[_0x8cf6e9(0x6c0)](_0x5de8b7[_0x8cf6e9(0x2df)],_0x56f304),await _0x2e83f8[_0x8cf6e9(0x2df)][_0x8cf6e9(0xe3c)](_0x5de8b7['globalSettings']),_0x34145f(),_0x4a28b8(),_0x40cea2(),_0x3f2530(),_0x1a2892(_0x5de8b7['globalSettings']['globalCss']),_0x58687c(_0x5de8b7['globalSettings'][_0x8cf6e9(0xcd8)]),_0x2d3a77(),_0xecbef(),_0x1f90a4(),await _0x2fb06(_0x8cf6e9(0xb5e),_0x8cf6e9(0xbd9));}catch(_0x372132){console[_0x8cf6e9(0x1c1)](_0x8cf6e9(0xfef),_0x372132),await _0x2fb06(_0x8cf6e9(0x19f),_0x8cf6e9(0x110)+_0x372132[_0x8cf6e9(0x4bc)]);}}async function _0x17aadf(_0x1ea9a0){const _0x38e377=_0x241b18;console[_0x38e377(0x84b)](_0x38e377(0x6ca)+_0x1ea9a0[_0x38e377(0x200)](0x1)+_0x38e377(0x11dd));const _0x3c226c=Object['values'](_0x5de8b7['chats'])[_0x38e377(0x138)](_0x2db8e2=>!_0x2db8e2[_0x38e377(0x1244)]&&_0x2db8e2[_0x38e377(0x761)]['enableBackgroundActivity']&&_0x2db8e2[_0x38e377(0xa78)]?.[_0x38e377(0x739)]===_0x38e377(0xe62));if(_0x3c226c[_0x38e377(0x594)]===0x0){console[_0x38e377(0x84b)](_0x38e377(0x1096));return;}for(const _0x63633d of _0x3c226c){const _0x255820=_0x63633d[_0x38e377(0x761)][_0x38e377(0xb09)]||0xf,_0x23d4c1=_0x63633d[_0x38e377(0x117)]?(Date[_0x38e377(0x1182)]()-_0x63633d['lastActionTimestamp'])/(0x3e8*0x3c):Infinity;_0x1ea9a0>_0x255820&&_0x23d4c1>_0x255820&&(Math[_0x38e377(0x36d)]()<0.3&&(console[_0x38e377(0x84b)]('角色\x20\x22'+_0x63633d[_0x38e377(0x278)]+'\x22\x20触发了后台行动！'),Math['random']()<0.7?await _0x38ac55(_0x63633d['id']):console[_0x38e377(0x84b)](_0x38e377(0xebf)+_0x63633d[_0x38e377(0x278)]+_0x38e377(0xb77))));}}function _0x4baed4(){const _0x536f30=_0x241b18;if(!_0x5de8b7[_0x536f30(0x93d)])return;const _0x511b1f=_0x5de8b7[_0x536f30(0x737)][_0x5de8b7[_0x536f30(0x93d)]];document[_0x536f30(0x11e3)](_0x536f30(0xd22))[_0x536f30(0xf27)]='',document[_0x536f30(0x11e3)](_0x536f30(0xca2))[_0x536f30(0xf27)]='',document[_0x536f30(0x11e3)]('chat-search-results-list')['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>',_0x4e7698(_0x536f30(0x8c4));}async function _0x50644e(){const _0x1bd36f=_0x241b18,_0x17c193=_0x5de8b7[_0x1bd36f(0x737)][_0x5de8b7[_0x1bd36f(0x93d)]];if(!_0x17c193)return;const _0x4009f0=document[_0x1bd36f(0x11e3)](_0x1bd36f(0xd22))[_0x1bd36f(0xf27)][_0x1bd36f(0xeb7)]()[_0x1bd36f(0xb03)](),_0x13bf21=document[_0x1bd36f(0x11e3)](_0x1bd36f(0xca2))[_0x1bd36f(0xf27)];if(!_0x4009f0&&!_0x13bf21){alert('请输入关键词或选择一个日期。');return;}let _0x480a83=_0x17c193['history'][_0x1bd36f(0x138)](_0x2df7ef=>!_0x2df7ef[_0x1bd36f(0xbf5)]);_0x4009f0&&(_0x480a83=_0x480a83['filter'](_0x34e4f4=>{const _0x57d74e=_0x1bd36f;let _0x58b842='';if(typeof _0x34e4f4[_0x57d74e(0x9a5)]===_0x57d74e(0x10d7))_0x58b842=_0x34e4f4['content'];else{if(_0x34e4f4[_0x57d74e(0xa20)]===_0x57d74e(0x719))_0x58b842=_0x34e4f4[_0x57d74e(0x9a5)];else{if(_0x34e4f4[_0x57d74e(0xa20)]==='ai_image'||_0x34e4f4[_0x57d74e(0xa20)]===_0x57d74e(0xeb))_0x58b842=_0x34e4f4[_0x57d74e(0x9a5)];else{if(_0x34e4f4[_0x57d74e(0xa20)]===_0x57d74e(0xd71))_0x58b842=(_0x34e4f4['dialogue']||'')+'\x20'+(_0x34e4f4[_0x57d74e(0x1029)]||'');else _0x34e4f4[_0x57d74e(0xb9)]&&(_0x58b842=_0x34e4f4[_0x57d74e(0x9a5)]);}}}return _0x58b842[_0x57d74e(0xb03)]()[_0x57d74e(0x3ad)](_0x4009f0);}));if(_0x13bf21){const _0x359502=new Date(_0x13bf21),_0x939a5a=new Date(_0x359502['setHours'](0x0,0x0,0x0,0x0))['getTime'](),_0x4e1e1b=new Date(_0x359502[_0x1bd36f(0x100e)](0x17,0x3b,0x3b,0x3e7))['getTime']();_0x480a83=_0x480a83[_0x1bd36f(0x138)](_0x4e038c=>_0x4e038c['timestamp']>=_0x939a5a&&_0x4e038c[_0x1bd36f(0x702)]<=_0x4e1e1b);}await _0x30c497(_0x480a83);}async function _0x30c497(_0x520c91){const _0x48cd2b=_0x241b18,_0x1a5d7e=document['getElementById'](_0x48cd2b(0x10ce)),_0x41846c=_0x5de8b7[_0x48cd2b(0x737)][_0x5de8b7[_0x48cd2b(0x93d)]];_0x1a5d7e[_0x48cd2b(0x595)]='';if(_0x520c91[_0x48cd2b(0x594)]===0x0){_0x1a5d7e['innerHTML']=_0x48cd2b(0x426);return;}let _0x2511b9='';for(const _0x33447e of _0x520c91){const _0x20eba1=new Date(_0x33447e[_0x48cd2b(0x702)]),_0xeb770b=_0x20eba1['toLocaleDateString']();if(_0xeb770b!==_0x2511b9){const _0x22152d=document[_0x48cd2b(0x383)](_0x48cd2b(0x1285));_0x22152d[_0x48cd2b(0x3db)]='date-separator',_0x22152d['textContent']=_0x48cd2b(0x3bc)+_0x20eba1[_0x48cd2b(0x177)]()+'年'+(_0x20eba1[_0x48cd2b(0x39d)]()+0x1)+'月'+_0x20eba1[_0x48cd2b(0x97d)]()+_0x48cd2b(0xd54),_0x1a5d7e[_0x48cd2b(0x120c)](_0x22152d),_0x2511b9=_0xeb770b;}const _0x3390ac=await _0xe99b75(_0x33447e,_0x41846c);_0x3390ac&&(_0x3390ac[_0x48cd2b(0x794)][_0x48cd2b(0x4d0)]='pointer',_0x3390ac[_0x48cd2b(0x4b8)](_0x48cd2b(0x1041),()=>_0x33e912(_0x33447e['timestamp'])),_0x1a5d7e[_0x48cd2b(0x120c)](_0x3390ac));}}async function _0x33e912(_0x57bbfc){const _0x370fc0=_0x241b18,_0x120d87=_0x5de8b7[_0x370fc0(0x93d)];if(!_0x120d87)return;_0x4e7698('chat-interface-screen'),setTimeout(async()=>{const _0x4e66d1=_0x370fc0,_0x555960=document['getElementById']('chat-messages'),_0x819be1=_0x4e66d1(0x955)+_0x57bbfc+'\x22]';let _0x258ad5=_0x555960[_0x4e66d1(0x5ac)](_0x819be1),_0x5a0df7=0x0;const _0x3f4043=0x14;while(!_0x258ad5&&_0x5a0df7<_0x3f4043){const _0x39c128=document[_0x4e66d1(0x11e3)](_0x4e66d1(0x1308));if(_0x39c128)console[_0x4e66d1(0x84b)]('目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20'+(_0x5a0df7+0x1)+')'),await _0x54384e(),_0x258ad5=_0x555960[_0x4e66d1(0x5ac)](_0x819be1),_0x5a0df7++;else break;}_0x2b137c(_0x57bbfc);},0xc8);}async function _0x5bb298(){const _0x11c2bf=_0x241b18;document[_0x11c2bf(0x11e3)](_0x11c2bf(0xd22))['value']='',document[_0x11c2bf(0x11e3)](_0x11c2bf(0xca2))[_0x11c2bf(0xf27)]='',await _0x30c497(_0x5de8b7[_0x11c2bf(0x737)][_0x5de8b7[_0x11c2bf(0x93d)]][_0x11c2bf(0x49e)][_0x11c2bf(0x138)](_0x27d221=>!_0x27d221['isHidden']));}async function _0x67aea3(_0xd18bfb=![],_0x3e9099=null,_0x2815eb=null){const _0x403d95=_0x241b18,_0x1a4735=document['getElementById'](_0x403d95(0xd7e)),_0xe3c6da=document['getElementById']('my-frame-grid'),_0x2713e2=_0x5de8b7[_0x403d95(0x737)][_0x5de8b7['activeChatId']];_0x1a4735[_0x403d95(0x595)]='',_0xe3c6da[_0x403d95(0x595)]='';const _0x6bcc2=await _0x2e83f8[_0x403d95(0x675)]['toArray'](),_0x5958da=[..._0x504159,..._0x6bcc2];document[_0x403d95(0x5ac)](_0x403d95(0x124c))[_0x403d95(0x794)][_0x403d95(0x33d)]=_0xd18bfb?'none':'flex',document[_0x403d95(0x11e3)]('ai-frame-content')[_0x403d95(0x794)]['display']=_0x403d95(0x11ac),document['getElementById'](_0x403d95(0x1ea))[_0x403d95(0x794)][_0x403d95(0x33d)]=_0x403d95(0x379),document[_0x403d95(0x11e3)](_0x403d95(0x82f))[_0x403d95(0x505)]['add'](_0x403d95(0x1fc)),document['getElementById'](_0x403d95(0x241))[_0x403d95(0x505)][_0x403d95(0x957)](_0x403d95(0x1fc));if(_0xd18bfb)_0x5958da['forEach'](_0x5f3d1f=>{const _0x185a6b=_0x403d95,_0x259a1b=_0x4106b6(_0x5f3d1f,'my',_0x3e9099);_0x5f3d1f['url']===_0x2815eb&&_0x259a1b['classList']['add'](_0x185a6b(0xbbc)),_0x1a4735['appendChild'](_0x259a1b);});else{const _0x2f30c1=_0x2713e2[_0x403d95(0x761)][_0x403d95(0x5e0)]||_0x3d2e44,_0x3b71de=_0x2713e2[_0x403d95(0x761)][_0x403d95(0xc43)]||(_0x2713e2[_0x403d95(0x1244)]?_0x30449f:_0x3d2e44);_0x5958da['forEach'](_0x35f6d2=>{const _0x3e9186=_0x403d95,_0x404e50=_0x4106b6(_0x35f6d2,'ai',_0x2f30c1);if(_0x35f6d2[_0x3e9186(0x10ac)]===_0x21b784['ai'])_0x404e50['classList'][_0x3e9186(0x252)]('selected');_0x1a4735[_0x3e9186(0x120c)](_0x404e50);const _0x45a66f=_0x4106b6(_0x35f6d2,'my',_0x3b71de);if(_0x35f6d2[_0x3e9186(0x10ac)]===_0x21b784['my'])_0x45a66f[_0x3e9186(0x505)][_0x3e9186(0x252)](_0x3e9186(0xbbc));_0xe3c6da[_0x3e9186(0x120c)](_0x45a66f);});}}function _0x4106b6(_0x43ed83,_0x4547e8,_0x553c08){const _0x47f6a1=_0x241b18,_0x219abe=document[_0x47f6a1(0x383)]('div');_0x219abe[_0x47f6a1(0x3db)]=_0x47f6a1(0xd58),_0x219abe['dataset']['frameUrl']=_0x43ed83[_0x47f6a1(0x10ac)],_0x219abe[_0x47f6a1(0x740)]=_0x43ed83[_0x47f6a1(0x278)];const _0x4e9bfb=typeof _0x43ed83['id']===_0x47f6a1(0x659),_0x1f2cc4=_0x4e9bfb?'<button\x20class=\x22delete-btn\x22\x20data-id=\x22'+_0x43ed83['id']+_0x47f6a1(0x2e6):'';return _0x219abe[_0x47f6a1(0x595)]=_0x47f6a1(0x94f)+_0x1f2cc4+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x553c08+_0x47f6a1(0x652)+(_0x43ed83[_0x47f6a1(0x10ac)]?_0x47f6a1(0x13b)+_0x43ed83[_0x47f6a1(0x10ac)]+_0x47f6a1(0x26b):'')+_0x47f6a1(0x69b),_0x219abe[_0x47f6a1(0x4b8)](_0x47f6a1(0x1041),_0x3933a3=>{const _0x2175fd=_0x47f6a1;if(_0x3933a3[_0x2175fd(0xd7c)][_0x2175fd(0x505)][_0x2175fd(0x1121)](_0x2175fd(0xf28)))return;if(_0x1992a9){if(_0x4e9bfb){const _0x229ad3=parseInt(_0x43ed83['id']);_0x219abe['classList'][_0x2175fd(0xe7e)](_0x2175fd(0xbbc)),_0x2f472a['has'](_0x229ad3)?_0x2f472a[_0x2175fd(0xc0c)](_0x229ad3):_0x2f472a['add'](_0x229ad3),_0x275cfa();}}else{_0x21b784[_0x4547e8]=_0x43ed83['url'];const _0x2582cf=_0x4547e8==='ai'?document[_0x2175fd(0x11e3)]('ai-frame-grid'):document[_0x2175fd(0x11e3)](_0x2175fd(0xa0a));_0x2582cf[_0x2175fd(0x10d6)]('.frame-item')[_0x2175fd(0x494)](_0x573d75=>_0x573d75[_0x2175fd(0x505)][_0x2175fd(0x957)](_0x2175fd(0xbbc))),_0x219abe[_0x2175fd(0x505)]['add'](_0x2175fd(0xbbc));}}),_0x219abe;}async function _0x15485d(){const _0xca3590=_0x241b18,_0x341fb6=document[_0xca3590(0x11e3)](_0xca3590(0x9a9)),_0xa37c48=await new Promise(_0x3b65bd=>{const _0x184d12=_0xca3590,_0x33adec=_0x49509c=>{const _0x12f999=_0x10a9;_0x3b65bd(_0x49509c[_0x12f999(0xd7c)][_0x12f999(0x5c9)][0x0]||null),_0x341fb6[_0x12f999(0xd7a)]('change',_0x33adec);};_0x341fb6[_0x184d12(0x4b8)](_0x184d12(0xfeb),_0x33adec,{'once':!![]}),_0x341fb6['click']();});if(!_0xa37c48)return;const _0xeb19c1=await _0x231a5a(_0xca3590(0x12d4),_0xca3590(0x40f));if(!_0xeb19c1||!_0xeb19c1[_0xca3590(0xeb7)]())return;const _0x525383=await new Promise(_0xe2739e=>{const _0x9309de=_0xca3590,_0x490a4a=new FileReader();_0x490a4a[_0x9309de(0x1e5)]=()=>_0xe2739e(_0x490a4a[_0x9309de(0x255)]),_0x490a4a[_0x9309de(0x1270)](_0xa37c48);});await _0x2e83f8[_0xca3590(0x675)][_0xca3590(0x252)]({'name':_0xeb19c1[_0xca3590(0xeb7)](),'url':_0x525383}),_0x67aea3(_0x22f8f5);}async function _0x1ac606(){const _0x2ef94c=_0x241b18,_0x4f4c68=_0x2ef94c(0x55d),_0xd88dd7=await _0x231a5a(_0x2ef94c(0x661),_0x2ef94c(0xc9a),'',_0x2ef94c(0x10bb),_0x2ef94c(0x4f5)+_0x4f4c68+'</p>');if(!_0xd88dd7||!_0xd88dd7[_0x2ef94c(0xeb7)]())return;const _0x40cc2f=_0xd88dd7[_0x2ef94c(0xeb7)]()['split']('\x0a'),_0x298c71=[];let _0x4b27d0=0x0;for(const _0x946b99 of _0x40cc2f){const _0xf2cb05=_0x946b99[_0x2ef94c(0xe9f)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0xf2cb05)_0x298c71[_0x2ef94c(0xf5)]({'name':_0xf2cb05[0x1][_0x2ef94c(0xeb7)](),'url':_0xf2cb05[0x2][_0x2ef94c(0xeb7)]()});else _0x946b99[_0x2ef94c(0xeb7)]()&&_0x4b27d0++;}_0x298c71[_0x2ef94c(0x594)]>0x0&&(await _0x2e83f8['customAvatarFrames'][_0x2ef94c(0xc16)](_0x298c71),_0x67aea3(_0x22f8f5),await _0x2fb06(_0x2ef94c(0xb5e),_0x2ef94c(0x1a5)+_0x298c71['length']+'\x20个新头像框！')),_0x4b27d0>0x0&&await _0x2fb06(_0x2ef94c(0x118e),'有\x20'+_0x4b27d0+_0x2ef94c(0x857));}async function _0x31fb15(_0x194b18){const _0x480e9d=_0x241b18,_0x1a70ed=await _0x2e83f8['customAvatarFrames'][_0x480e9d(0x1289)](_0x194b18);if(!_0x1a70ed)return;const _0x555d38=await _0x58fd60(_0x480e9d(0x1166),_0x480e9d(0x1b9)+_0x1a70ed[_0x480e9d(0x278)]+_0x480e9d(0xbec),{'confirmButtonClass':_0x480e9d(0x8a6)});_0x555d38&&(await _0x2e83f8[_0x480e9d(0x675)][_0x480e9d(0xc0c)](_0x194b18),_0x67aea3(_0x22f8f5));}let _0xe708ed=0x0;const _0x37016f=0x2;function _0x5c2433(){const _0x25b705=_0x241b18,_0x4a9627=document[_0x25b705(0x11e3)](_0x25b705(0x3d3)),_0x3fe7a6=document[_0x25b705(0x11e3)](_0x25b705(0xf90)),_0x217f72=document[_0x25b705(0x10d6)](_0x25b705(0x6ce));let _0x225616=0x0,_0x42a0a1=0x0,_0x53bc81=0x0,_0x150519=![],_0x5c20d5=!![];const _0x50553b=()=>{const _0x425b87=_0x25b705;_0x3fe7a6[_0x425b87(0x794)][_0x425b87(0xb5d)]=_0x425b87(0x116d)+_0xe708ed*(0x64/_0x37016f)+'%)',_0x217f72[_0x425b87(0x494)]((_0x218ceb,_0x4720c4)=>{const _0x221fc0=_0x425b87;_0x218ceb['classList'][_0x221fc0(0xe7e)](_0x221fc0(0x1fc),_0x4720c4===_0xe708ed);});},_0x15424c=_0x544e1b=>{const _0x590782=_0x25b705;_0x150519=!![],_0x5c20d5=!![],_0x225616=_0x544e1b['type'][_0x590782(0x3ad)](_0x590782(0x110a))?_0x544e1b['pageX']:_0x544e1b[_0x590782(0x371)][0x0]['pageX'],_0x42a0a1=_0x544e1b[_0x590782(0xa20)][_0x590782(0x3ad)](_0x590782(0x110a))?_0x544e1b['pageY']:_0x544e1b[_0x590782(0x371)][0x0][_0x590782(0xddc)],_0x3fe7a6[_0x590782(0x794)][_0x590782(0x10f6)]=_0x590782(0x379);},_0xdee54d=_0xe29725=>{const _0x4c04bc=_0x25b705;if(!_0x150519)return;const _0x94bdd6=_0xe29725[_0x4c04bc(0xa20)][_0x4c04bc(0x3ad)](_0x4c04bc(0x110a))?_0xe29725[_0x4c04bc(0xddc)]:_0xe29725[_0x4c04bc(0x371)][0x0][_0x4c04bc(0xddc)];_0x53bc81=_0xe29725[_0x4c04bc(0xa20)][_0x4c04bc(0x3ad)](_0x4c04bc(0x110a))?_0xe29725[_0x4c04bc(0xa4a)]:_0xe29725['touches'][0x0][_0x4c04bc(0xa4a)];const _0x5716d5=_0x53bc81-_0x225616,_0x1022f4=_0x94bdd6-_0x42a0a1;_0x5c20d5&&(Math['abs'](_0x5716d5)>0xa||Math[_0x4c04bc(0xf8f)](_0x1022f4)>0xa)&&(_0x5c20d5=![]);if(Math[_0x4c04bc(0xf8f)](_0x5716d5)>Math['abs'](_0x1022f4)){if(_0xe29725['cancelable'])_0xe29725[_0x4c04bc(0xf87)]();_0x3fe7a6[_0x4c04bc(0x794)][_0x4c04bc(0xb5d)]='translateX(calc(-'+_0xe708ed*(0x64/_0x37016f)+_0x4c04bc(0x53e)+_0x5716d5+_0x4c04bc(0x11a);}},_0x2dd7e6=_0xcb0acc=>{const _0x532336=_0x25b705;if(!_0x150519)return;_0x150519=![],_0x3fe7a6[_0x532336(0x794)][_0x532336(0x10f6)]='transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)';if(_0x5c20d5){_0x50553b();return;}const _0xc3aeff=_0x53bc81-_0x225616;if(Math[_0x532336(0xf8f)](_0xc3aeff)>_0x4a9627[_0x532336(0x29f)]/0x4){if(_0xc3aeff>0x0&&_0xe708ed>0x0)_0xe708ed--;else _0xc3aeff<0x0&&_0xe708ed<_0x37016f-0x1&&_0xe708ed++;}_0x50553b();};_0x4a9627[_0x25b705(0x4b8)](_0x25b705(0xc23),_0x15424c),_0x4a9627['addEventListener'](_0x25b705(0x270),_0xdee54d),_0x4a9627['addEventListener'](_0x25b705(0xdcb),_0x2dd7e6),_0x4a9627[_0x25b705(0x4b8)]('mouseleave',_0x2dd7e6),_0x4a9627['addEventListener'](_0x25b705(0x39e),_0x15424c,{'passive':![]}),_0x4a9627[_0x25b705(0x4b8)](_0x25b705(0x19a),_0xdee54d,{'passive':![]}),_0x4a9627['addEventListener']('touchend',_0x2dd7e6);}let _0x2e6df1=null;async function _0x56bc1a(){await _0x2df24e(),_0x4e7698('preset-screen');}async function _0x2df24e(){const _0x82f0df=_0x241b18,_0x119666=document['getElementById'](_0x82f0df(0x9ef)),_0x18a2ec=document[_0x82f0df(0x11e3)](_0x82f0df(0x539));_0x119666[_0x82f0df(0x595)]='',_0x18a2ec[_0x82f0df(0x595)]='';const [_0x30e341,_0x5efb04]=await Promise[_0x82f0df(0xd4a)]([_0x2e83f8['presets'][_0x82f0df(0x508)](),_0x2e83f8['presetCategories']['orderBy'](_0x82f0df(0x278))['toArray']()]);_0x5de8b7[_0x82f0df(0x427)]=_0x30e341;if(_0x30e341['length']===0x0){_0x18a2ec[_0x82f0df(0x595)]=_0x82f0df(0x243);return;}const _0x52b6d5=document[_0x82f0df(0x383)](_0x82f0df(0xbf2));_0x52b6d5[_0x82f0df(0x3db)]=_0x82f0df(0xf99),_0x52b6d5[_0x82f0df(0x300)]='全部',_0x52b6d5[_0x82f0df(0xaca)]['categoryId']=_0x82f0df(0xd4a),_0x119666[_0x82f0df(0x120c)](_0x52b6d5);const _0x567e5e=document[_0x82f0df(0x383)](_0x82f0df(0x1285));_0x567e5e[_0x82f0df(0x3db)]=_0x82f0df(0x10c3),_0x567e5e[_0x82f0df(0xaca)][_0x82f0df(0x9ee)]='all',_0x18a2ec[_0x82f0df(0x120c)](_0x567e5e),_0x5efb04['forEach'](_0x514bc9=>{const _0x25c0cb=_0x82f0df,_0x52f421=document[_0x25c0cb(0x383)](_0x25c0cb(0xbf2));_0x52f421[_0x25c0cb(0x3db)]='world-book-tab',_0x52f421[_0x25c0cb(0x300)]=_0x514bc9['name'],_0x52f421[_0x25c0cb(0xaca)][_0x25c0cb(0x9ee)]=String(_0x514bc9['id']),_0x119666['appendChild'](_0x52f421);const _0x9bbb9=document[_0x25c0cb(0x383)](_0x25c0cb(0x1285));_0x9bbb9[_0x25c0cb(0x3db)]=_0x25c0cb(0xa64),_0x9bbb9[_0x25c0cb(0xaca)][_0x25c0cb(0x9ee)]=String(_0x514bc9['id']),_0x18a2ec[_0x25c0cb(0x120c)](_0x9bbb9);});const _0x3b02af=_0x30e341[_0x82f0df(0xe7c)](_0x5c3180=>!_0x5c3180[_0x82f0df(0x9ee)]);if(_0x3b02af){const _0x43ee70=document[_0x82f0df(0x383)]('button');_0x43ee70['className']=_0x82f0df(0x928),_0x43ee70[_0x82f0df(0x300)]=_0x82f0df(0x124f),_0x43ee70[_0x82f0df(0xaca)][_0x82f0df(0x9ee)]=_0x82f0df(0xb81),_0x119666['appendChild'](_0x43ee70);const _0x1e54ba=document[_0x82f0df(0x383)](_0x82f0df(0x1285));_0x1e54ba[_0x82f0df(0x3db)]=_0x82f0df(0xa64),_0x1e54ba[_0x82f0df(0xaca)][_0x82f0df(0x9ee)]=_0x82f0df(0xb81),_0x18a2ec[_0x82f0df(0x120c)](_0x1e54ba);}_0x30e341['forEach'](_0x981de2=>{const _0x1a5f28=_0x82f0df,_0x6e1dd2='该预设包含\x20'+_0x981de2[_0x1a5f28(0x9a5)][_0x1a5f28(0x594)]+_0x1a5f28(0x570),_0x37a99a=document[_0x1a5f28(0x383)](_0x1a5f28(0x1285));_0x37a99a['className']=_0x1a5f28(0x849),_0x37a99a[_0x1a5f28(0x595)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x981de2[_0x1a5f28(0x278)]+_0x1a5f28(0x8c3)+_0x6e1dd2+_0x1a5f28(0x176);const _0x26e4b2=()=>_0x991a41(_0x981de2['id']),_0xbf21c8=async()=>{const _0x3483c5=_0x1a5f28,_0x3b5274=await _0x58fd60(_0x3483c5(0x30c),'确定要删除《'+_0x981de2[_0x3483c5(0x278)]+'》吗？',{'confirmButtonClass':_0x3483c5(0x8a6)});_0x3b5274&&(await _0x2e83f8[_0x3483c5(0x427)][_0x3483c5(0xc0c)](_0x981de2['id']),_0x5de8b7[_0x3483c5(0x427)]=await _0x2e83f8['presets']['toArray'](),_0x2df24e());};_0x37a99a['addEventListener'](_0x1a5f28(0x1041),_0x26e4b2),_0xcb6204(_0x37a99a,_0xbf21c8);const _0x3f70f6=_0x37a99a[_0x1a5f28(0x4b4)](!![]);_0x3f70f6[_0x1a5f28(0x4b8)](_0x1a5f28(0x1041),_0x26e4b2),_0xcb6204(_0x3f70f6,_0xbf21c8),_0x567e5e[_0x1a5f28(0x120c)](_0x3f70f6);const _0x50197e=_0x981de2[_0x1a5f28(0x9ee)]?String(_0x981de2['categoryId']):'uncategorized',_0x226cee=_0x18a2ec['querySelector'](_0x1a5f28(0x104d)+_0x50197e+'\x22]');_0x226cee&&_0x226cee[_0x1a5f28(0x120c)](_0x37a99a);}),document[_0x82f0df(0x10d6)]('#preset-tabs\x20.world-book-tab')[_0x82f0df(0x494)](_0x5a5e48=>{const _0x45eb7e=_0x82f0df;_0x5a5e48[_0x45eb7e(0x4b8)](_0x45eb7e(0x1041),()=>_0x3b983b(_0x5a5e48['dataset'][_0x45eb7e(0x9ee)]));});}function _0x3b983b(_0x129d4a){const _0x14903a=_0x241b18;document[_0x14903a(0x10d6)](_0x14903a(0x9b5))['forEach'](_0x130d94=>{const _0x11fcb2=_0x14903a;_0x130d94['classList'][_0x11fcb2(0xe7e)](_0x11fcb2(0x1fc),_0x130d94[_0x11fcb2(0xaca)][_0x11fcb2(0x9ee)]===_0x129d4a);}),document[_0x14903a(0x10d6)]('#preset-content-container\x20.world-book-category-pane')['forEach'](_0xf34caf=>{const _0x3d4df0=_0x14903a;_0xf34caf[_0x3d4df0(0x505)][_0x3d4df0(0xe7e)](_0x3d4df0(0x1fc),_0xf34caf[_0x3d4df0(0xaca)][_0x3d4df0(0x9ee)]===_0x129d4a);});}async function _0x991a41(_0x28da04){const _0x521acb=_0x241b18;_0x4e7698(_0x521acb(0x773)),_0x2e6df1=_0x28da04;try{const [_0xaeea13,_0x294056]=await Promise['all']([_0x2e83f8['presets'][_0x521acb(0x1289)](_0x28da04),_0x2e83f8[_0x521acb(0x566)][_0x521acb(0x508)]()]);if(!_0xaeea13){console[_0x521acb(0x1c1)](_0x521acb(0x6fc),_0x28da04),await _0x2fb06(_0x521acb(0xe2c),'找不到这个预设的详细信息。'),_0x4e7698(_0x521acb(0x3df));return;}setTimeout(()=>{const _0x2d45ef=_0x521acb;document['getElementById'](_0x2d45ef(0x8e3))[_0x2d45ef(0x300)]=_0xaeea13['name'],document[_0x2d45ef(0x11e3)](_0x2d45ef(0xaa1))[_0x2d45ef(0xf27)]=_0xaeea13[_0x2d45ef(0x278)];const _0xb03dcd=document[_0x2d45ef(0x11e3)](_0x2d45ef(0x92b));_0xb03dcd[_0x2d45ef(0x595)]=_0x2d45ef(0xce4),_0x294056[_0x2d45ef(0x494)](_0x16d321=>{const _0x17fcb2=_0x2d45ef,_0xc007f6=document[_0x17fcb2(0x383)](_0x17fcb2(0xd91));_0xc007f6[_0x17fcb2(0xf27)]=_0x16d321['id'],_0xc007f6['textContent']=_0x16d321['name'];if(_0xaeea13[_0x17fcb2(0x9ee)]===_0x16d321['id'])_0xc007f6[_0x17fcb2(0xbbc)]=!![];_0xb03dcd[_0x17fcb2(0x120c)](_0xc007f6);});const _0xdd914f=document[_0x2d45ef(0x11e3)](_0x2d45ef(0xdf4));_0xdd914f[_0x2d45ef(0x595)]='',Array[_0x2d45ef(0xb7b)](_0xaeea13[_0x2d45ef(0x9a5)])&&_0xaeea13[_0x2d45ef(0x9a5)]['length']>0x0?_0xaeea13[_0x2d45ef(0x9a5)][_0x2d45ef(0x494)](_0x4bafff=>{const _0x102e12=_0x424f18(_0x4bafff);_0xdd914f['appendChild'](_0x102e12);}):_0xdd914f['innerHTML']=_0x2d45ef(0x66a);},0x32);}catch(_0x24af83){console['error']('打开预设编辑器时发生严重错误:',_0x24af83),await _0x2fb06('加载失败','加载预设详情时发生错误:\x20'+_0x24af83[_0x521acb(0x4bc)]),_0x4e7698(_0x521acb(0x3df));}}function _0x424f18(_0x4cc5cd={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x542a0e=_0x241b18,_0x25a4a6=document[_0x542a0e(0x383)](_0x542a0e(0x1285));_0x25a4a6[_0x542a0e(0x3db)]=_0x542a0e(0x402);const _0xd7bedc=_0x4cc5cd['enabled']!==![]?_0x542a0e(0x3e4):'';_0x25a4a6[_0x542a0e(0x595)]=_0x542a0e(0xad)+_0xd7bedc+_0x542a0e(0x355)+(_0x4cc5cd[_0x542a0e(0xebd)]||'')+_0x542a0e(0x810)+(_0x4cc5cd['keys']||[])[_0x542a0e(0xa4b)](',\x20')+'\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>'+(_0x4cc5cd[_0x542a0e(0x9a5)]||'')+_0x542a0e(0x724),_0x25a4a6['querySelector'](_0x542a0e(0x48b))[_0x542a0e(0x4b8)]('click',()=>_0x25a4a6[_0x542a0e(0x957)]());const _0x18d98f=_0x25a4a6['querySelector'](_0x542a0e(0x128a)),_0x583e85=_0x25a4a6[_0x542a0e(0x5ac)](_0x542a0e(0x1fb));return _0x18d98f['addEventListener'](_0x542a0e(0x1041),()=>{const _0x184e0d=_0x542a0e,_0x103779=_0x583e85[_0x184e0d(0x794)][_0x184e0d(0x33d)]==='none';_0x583e85[_0x184e0d(0x794)][_0x184e0d(0x33d)]=_0x103779?_0x184e0d(0x11ac):_0x184e0d(0x379),_0x18d98f[_0x184e0d(0x300)]=_0x103779?'收起':'展开';}),_0x25a4a6;}async function _0x471f38(){const _0x35993e=_0x241b18;await _0x3b6e45(),document[_0x35993e(0x5ac)](_0x35993e(0x12d5))[_0x35993e(0x300)]=_0x35993e(0x8f3),document[_0x35993e(0x11e3)](_0x35993e(0x842))[_0x35993e(0x1074)]=_0x1b6385,document[_0x35993e(0x11e3)](_0x35993e(0x76e))['onclick']=_0x12fc53=>{const _0x10f585=_0x35993e;_0x12fc53[_0x10f585(0xd7c)][_0x10f585(0x505)][_0x10f585(0x1121)](_0x10f585(0xceb))&&_0x288814(parseInt(_0x12fc53[_0x10f585(0xd7c)][_0x10f585(0xaca)]['id']));},document[_0x35993e(0x11e3)]('close-group-manager-btn')[_0x35993e(0x1074)]=()=>{const _0x336368=_0x35993e;document['getElementById']('group-management-modal')[_0x336368(0x505)][_0x336368(0x957)](_0x336368(0x250)),_0x2df24e();},document[_0x35993e(0x11e3)](_0x35993e(0x122c))[_0x35993e(0x505)]['add'](_0x35993e(0x250));}async function _0x3b6e45(){const _0x5949a2=_0x241b18,_0x40dd78=document[_0x5949a2(0x11e3)](_0x5949a2(0x76e)),_0x2ec45d=await _0x2e83f8[_0x5949a2(0x566)][_0x5949a2(0x508)]();_0x40dd78['innerHTML']='',_0x2ec45d[_0x5949a2(0x594)]===0x0&&(_0x40dd78['innerHTML']='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>'),_0x2ec45d[_0x5949a2(0x494)](_0x13362a=>{const _0x5d2ae1=_0x5949a2,_0x25ccca=document[_0x5d2ae1(0x383)](_0x5d2ae1(0x1285));_0x25ccca[_0x5d2ae1(0x3db)]=_0x5d2ae1(0x1cf),_0x25ccca[_0x5d2ae1(0x595)]=_0x5d2ae1(0x214)+_0x13362a[_0x5d2ae1(0x278)]+_0x5d2ae1(0x733)+_0x13362a['id']+'\x22>×</span>',_0x40dd78[_0x5d2ae1(0x120c)](_0x25ccca);});}async function _0x1b6385(){const _0x282f10=_0x241b18,_0x1ab843=document[_0x282f10(0x11e3)](_0x282f10(0x110b)),_0x3feab4=_0x1ab843[_0x282f10(0xf27)][_0x282f10(0xeb7)]();if(!_0x3feab4)return alert(_0x282f10(0x4a2));const _0x50204b=await _0x2e83f8[_0x282f10(0x566)][_0x282f10(0x129e)]('name')[_0x282f10(0x119e)](_0x3feab4)[_0x282f10(0x12c1)]();if(_0x50204b)return alert(_0x282f10(0x1239)+_0x3feab4+_0x282f10(0xc96));await _0x2e83f8['presetCategories'][_0x282f10(0x252)]({'name':_0x3feab4}),_0x1ab843[_0x282f10(0xf27)]='',await _0x3b6e45();}async function _0x288814(_0x563009){const _0x2d3ff4=_0x241b18,_0x355aed=await _0x58fd60(_0x2d3ff4(0x1166),_0x2d3ff4(0x9e5),{'confirmButtonClass':'btn-danger'});_0x355aed&&(await _0x2e83f8['presetCategories']['delete'](_0x563009),await _0x2e83f8[_0x2d3ff4(0x427)]['where']('categoryId')['equals'](_0x563009)['modify']({'categoryId':null}),_0x5de8b7[_0x2d3ff4(0x427)]=await _0x2e83f8[_0x2d3ff4(0x427)]['toArray'](),await _0x3b6e45());}async function _0x3a31b9(_0x4148dd){const _0x239464=_0x241b18,_0x200d5e=_0x4148dd[_0x239464(0xd7c)][_0x239464(0x5c9)][0x0];if(!_0x200d5e)return;try{if(!_0x200d5e['name'][_0x239464(0x771)](_0x239464(0xfc4)))throw new Error(_0x239464(0x553));const _0x54799c=await _0x200d5e['text'](),_0x5e3140=JSON['parse'](_0x54799c);await _0x2f1b7f(_0x5e3140,_0x200d5e[_0x239464(0x278)]);}catch(_0x19827e){console['error']('预设导入失败:',_0x19827e),await _0x2fb06(_0x239464(0x19f),_0x239464(0xec9)+_0x19827e[_0x239464(0x4bc)]);}finally{_0x4148dd[_0x239464(0xd7c)][_0x239464(0xf27)]=null;}}async function _0x2f1b7f(_0x3a96b9,_0x26f03a){const _0x457778=_0x241b18;let _0x6ce7bf=[];if(Array[_0x457778(0xb7b)](_0x3a96b9[_0x457778(0x8e6)])&&Array['isArray'](_0x3a96b9[_0x457778(0x7d3)])&&_0x3a96b9[_0x457778(0x7d3)][_0x457778(0x594)]>0x0){console['log'](_0x457778(0xbd0));const _0x5154d8=new Map(_0x3a96b9[_0x457778(0x8e6)][_0x457778(0x796)](_0x2fec98=>[_0x2fec98['identifier'],_0x2fec98])),_0x29f251=_0x3a96b9[_0x457778(0x7d3)][_0x457778(0x870)]((_0x48dc2b,_0x259e16)=>_0x259e16[_0x457778(0xd6a)]&&_0x259e16[_0x457778(0xd6a)]['length']>(_0x48dc2b['length']||0x0)?_0x259e16[_0x457778(0xd6a)]:_0x48dc2b,[]);_0x29f251&&_0x29f251[_0x457778(0x594)]>0x0&&(_0x6ce7bf=_0x29f251['map'](_0x252e59=>{const _0x1718df=_0x457778,_0x5566d1=_0x5154d8[_0x1718df(0x1289)](_0x252e59[_0x1718df(0xcde)]);if(_0x5566d1)return{'keys':[],'comment':_0x5566d1[_0x1718df(0x278)]||_0x1718df(0x491),'content':_0x5566d1[_0x1718df(0x9a5)]||'','enabled':_0x252e59[_0x1718df(0xc34)]};return null;})[_0x457778(0x138)](Boolean));}else{if(_0x3a96b9[_0x457778(0x560)]&&typeof _0x3a96b9[_0x457778(0x560)]===_0x457778(0x537))console[_0x457778(0x84b)]('检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。'),Array[_0x457778(0xb7b)](_0x3a96b9[_0x457778(0xd6a)])?(console[_0x457778(0x84b)]('检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。'),_0x6ce7bf=_0x3a96b9[_0x457778(0xd6a)]['map'](_0x593a24=>_0x3a96b9['entries'][_0x593a24])['filter'](Boolean)[_0x457778(0x796)](_0x5d442e=>({'keys':_0x5d442e[_0x457778(0xb8c)]||[],'comment':_0x5d442e[_0x457778(0xebd)]||_0x457778(0x350),'content':_0x5d442e[_0x457778(0x9a5)]||'','enabled':!_0x5d442e[_0x457778(0xe07)]}))):(console[_0x457778(0x6b0)](_0x457778(0xad0)),_0x6ce7bf=Object[_0x457778(0x4ca)](_0x3a96b9[_0x457778(0x560)])[_0x457778(0x796)](_0x3e0e52=>({'keys':_0x3e0e52[_0x457778(0xb8c)]||[],'comment':_0x3e0e52[_0x457778(0xebd)]||'无备注','content':_0x3e0e52[_0x457778(0x9a5)]||'','enabled':!_0x3e0e52['disable']})));else{if(Array[_0x457778(0xb7b)](_0x3a96b9[_0x457778(0x8e6)]))console[_0x457778(0x84b)]('检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。'),_0x6ce7bf=_0x3a96b9['prompts']['map'](_0x11942f=>({'keys':[],'comment':_0x11942f[_0x457778(0x278)]||_0x457778(0x491),'content':_0x11942f[_0x457778(0x9a5)]||'','enabled':!![]}));else throw new Error(_0x457778(0xd36));}}_0x6ce7bf=_0x6ce7bf[_0x457778(0x138)](_0x2a8825=>_0x2a8825[_0x457778(0x9a5)]);if(_0x6ce7bf['length']===0x0){alert(_0x457778(0xd78));return;}const _0x2267d0=_0x26f03a[_0x457778(0x1018)](/\.json$/i,''),_0x4f1e5e=await _0x231a5a(_0x457778(0x4b9),_0x457778(0x775),_0x2267d0);if(!_0x4f1e5e||!_0x4f1e5e[_0x457778(0xeb7)]()){alert('导入已取消，因为未提供名称。');return;}const _0xd45769={'id':_0x457778(0x11c0)+Date[_0x457778(0x1182)](),'name':_0x4f1e5e[_0x457778(0xeb7)](),'content':_0x6ce7bf,'categoryId':null};await _0x2e83f8['presets'][_0x457778(0x252)](_0xd45769),_0x5de8b7[_0x457778(0x427)]['push'](_0xd45769),await _0x2df24e(),await _0x2fb06('导入成功！','已成功从文件导入预设《'+_0x4f1e5e+'》。');}async function _0x15e5ab(_0x308072){const _0x5956ec=_0x241b18,_0x1a0747=document[_0x5956ec(0x11e3)](_0x5956ec(0x1079));if(!_0x1a0747)return;const _0x13834a=_0x5de8b7[_0x5956ec(0x427)]||[];_0x1a0747['innerHTML']=_0x5956ec(0x126a),_0x13834a[_0x5956ec(0x494)](_0x512eb7=>{const _0x29bb7e=_0x5956ec,_0x3a9b25=document['createElement']('option');_0x3a9b25['value']=_0x512eb7['id'],_0x3a9b25[_0x29bb7e(0x300)]=_0x512eb7[_0x29bb7e(0x278)],_0x1a0747[_0x29bb7e(0x120c)](_0x3a9b25);}),_0x308072[_0x5956ec(0x761)][_0x5956ec(0xa15)]&&(_0x1a0747[_0x5956ec(0xf27)]=_0x308072[_0x5956ec(0x761)][_0x5956ec(0xa15)]);}function _0x3d6bc1(){const _0x51c8c0=_0x241b18,_0x3e06e5=document['getElementById']('button-order-editor');if(!_0x3e06e5)return;_0x3e06e5[_0x51c8c0(0x595)]='';let _0x51988d=_0x5de8b7['globalSettings'][_0x51c8c0(0xfd3)]||_0x2f8178;_0x51988d[_0x51c8c0(0x494)](_0x4d1b93=>{const _0x3366a0=_0x51c8c0,_0x156f04=document[_0x3366a0(0x11e3)](_0x4d1b93);if(_0x156f04){const _0x357f1e=document[_0x3366a0(0x383)](_0x3366a0(0x1285));_0x357f1e[_0x3366a0(0x3db)]=_0x3366a0(0xba9),_0x357f1e['draggable']=!![],_0x357f1e['dataset'][_0x3366a0(0x11af)]=_0x4d1b93,_0x357f1e['innerHTML']=_0x156f04[_0x3366a0(0x595)],_0x3e06e5[_0x3366a0(0x120c)](_0x357f1e);}});}function _0x35f161(){const _0x46c521=_0x241b18,_0x47c98f=document[_0x46c521(0x11e3)](_0x46c521(0x853));if(!_0x47c98f)return;let _0x57d083=null;const _0x51cb13=_0x4c802b=>{const _0x474835=_0x46c521,_0x5bec8b=_0x4c802b[_0x474835(0xd7c)]['closest']('.draggable-button-item');if(!_0x5bec8b)return;_0x57d083=_0x5bec8b,_0x57d083[_0x474835(0x505)]['add'](_0x474835(0x10c8));if(_0x4c802b[_0x474835(0x1034)])_0x4c802b[_0x474835(0xf87)]();},_0x51ec43=_0x219a45=>{const _0x37bd6a=_0x46c521;if(!_0x57d083)return;const _0x377b07=_0x219a45[_0x37bd6a(0xa20)][_0x37bd6a(0x3ad)](_0x37bd6a(0x110a))?_0x219a45[_0x37bd6a(0x3e6)]:_0x219a45[_0x37bd6a(0x371)][0x0][_0x37bd6a(0x3e6)],_0x366e79=_0x52b555(_0x47c98f,_0x377b07);_0x366e79==null?_0x47c98f['appendChild'](_0x57d083):_0x47c98f[_0x37bd6a(0xc1)](_0x57d083,_0x366e79);},_0x3722ad=()=>{const _0x8974c6=_0x46c521;if(!_0x57d083)return;_0x57d083['classList'][_0x8974c6(0x957)](_0x8974c6(0x10c8)),_0x57d083=null,_0x42424b();};_0x47c98f[_0x46c521(0x4b8)](_0x46c521(0xc23),_0x51cb13),_0x47c98f[_0x46c521(0x4b8)](_0x46c521(0x39e),_0x51cb13,{'passive':![]}),_0x47c98f[_0x46c521(0x4b8)](_0x46c521(0x270),_0x51ec43),_0x47c98f[_0x46c521(0x4b8)](_0x46c521(0x19a),_0x51ec43,{'passive':![]}),_0x47c98f[_0x46c521(0x4b8)](_0x46c521(0xdcb),_0x3722ad),_0x47c98f[_0x46c521(0x4b8)](_0x46c521(0x881),_0x3722ad),_0x47c98f[_0x46c521(0x4b8)](_0x46c521(0xf7b),_0x3722ad);}function _0x52b555(_0x2096dc,_0x1161e4){const _0x1ba466=_0x241b18,_0x1f597f=[..._0x2096dc[_0x1ba466(0x10d6)]('.draggable-button-item:not(.dragging)')];return _0x1f597f['reduce']((_0x5db3d4,_0x4b63af)=>{const _0x3915e4=_0x1ba466,_0x4375d9=_0x4b63af[_0x3915e4(0x106b)](),_0x45cbff=_0x1161e4-_0x4375d9['left']-_0x4375d9[_0x3915e4(0x1057)]/0x2;return _0x45cbff<0x0&&_0x45cbff>_0x5db3d4['offset']?{'offset':_0x45cbff,'element':_0x4b63af}:_0x5db3d4;},{'offset':Number[_0x1ba466(0x1181)]})[_0x1ba466(0x12a0)];}async function _0x42424b(){const _0x27b06c=_0x241b18,_0x462793=document[_0x27b06c(0x11e3)]('button-order-editor'),_0x5b842d=Array[_0x27b06c(0xee2)](_0x462793[_0x27b06c(0x10d6)]('.draggable-button-item'))[_0x27b06c(0x796)](_0x43ff6d=>_0x43ff6d['dataset']['buttonId']);_0x5de8b7[_0x27b06c(0x2df)]['chatActionButtonsOrder']=_0x5b842d,await _0x2e83f8[_0x27b06c(0x2df)][_0x27b06c(0xe3c)](_0x5de8b7['globalSettings']);}function _0x21b25b(){const _0x5ab827=_0x241b18,_0x481aea=_0x5de8b7[_0x5ab827(0x2df)][_0x5ab827(0xfd3)];if(!_0x481aea||!Array[_0x5ab827(0xb7b)](_0x481aea)||_0x481aea[_0x5ab827(0x594)]===0x0)return;const _0x4acd06=document[_0x5ab827(0x11e3)]('chat-input-actions-top');if(!_0x4acd06)return;_0x481aea[_0x5ab827(0x494)](_0x25f217=>{const _0x387341=document['getElementById'](_0x25f217);_0x387341&&_0x4acd06['appendChild'](_0x387341);});}const _0x2f8178=[_0x241b18(0x11cb),_0x241b18(0x400),_0x241b18(0x1296),_0x241b18(0x8ff),_0x241b18(0x79f),_0x241b18(0x3cb),'video-call-btn',_0x241b18(0x805),_0x241b18(0x2bf),'share-link-btn',_0x241b18(0x10d3),'gomoku-btn',_0x241b18(0x765),_0x241b18(0xc76),'edit-last-response-btn',_0x241b18(0x971),_0x241b18(0x1281),_0x241b18(0x8d0),_0x241b18(0xd4f),_0x241b18(0x48e)];async function _0x4e1c52(){const _0x19dd7b=_0x241b18;_0x5de8b7[_0x19dd7b(0x2df)][_0x19dd7b(0xfd3)]=null,await _0x2e83f8[_0x19dd7b(0x2df)][_0x19dd7b(0xe3c)](_0x5de8b7[_0x19dd7b(0x2df)]),_0x3d6bc1(),_0x21b25b(),await _0x2fb06('成功',_0x19dd7b(0x77f));}let _0x51c940=[],_0x2ac70b=[];function _0x478330(){const _0x4c1adb=_0x241b18,_0xec2197=document[_0x4c1adb(0x11e3)](_0x4c1adb(0x9c5));_0x51c940=[],_0x2ac70b=[],_0x1028c2(),document[_0x4c1adb(0x11e3)]('data-clear-step-1')[_0x4c1adb(0x794)][_0x4c1adb(0x33d)]=_0x4c1adb(0x10f4),document[_0x4c1adb(0x11e3)](_0x4c1adb(0x1052))[_0x4c1adb(0x794)][_0x4c1adb(0x33d)]='none',_0xec2197[_0x4c1adb(0x505)][_0x4c1adb(0x252)](_0x4c1adb(0x250));}function _0x1028c2(){const _0x4bdd9a=_0x241b18,_0x1ccede=document[_0x4bdd9a(0x11e3)](_0x4bdd9a(0x257));_0x1ccede['innerHTML']='';const _0xd9985d=document[_0x4bdd9a(0x383)](_0x4bdd9a(0x1285));_0xd9985d[_0x4bdd9a(0x3db)]='clear-posts-item',_0xd9985d[_0x4bdd9a(0xaca)][_0x4bdd9a(0x458)]=_0x4bdd9a(0x21c),_0xd9985d[_0x4bdd9a(0x595)]=_0x4bdd9a(0xf3f)+(_0x5de8b7['qzoneSettings'][_0x4bdd9a(0xa33)]||'我')+'\x20(用户)</span>\x0a\x20\x20\x20\x20',_0x1ccede[_0x4bdd9a(0x120c)](_0xd9985d),Object[_0x4bdd9a(0x4ca)](_0x5de8b7['chats'])['forEach'](_0x430e45=>{const _0x2477f4=_0x4bdd9a;if(!_0x430e45['isGroup']){const _0x2bb910=document[_0x2477f4(0x383)]('div');_0x2bb910['className']=_0x2477f4(0x1142),_0x2bb910[_0x2477f4(0xaca)][_0x2477f4(0x458)]=_0x430e45['id'],_0x2bb910[_0x2477f4(0x595)]=_0x2477f4(0xfe)+_0x430e45[_0x2477f4(0x278)]+'\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1ccede['appendChild'](_0x2bb910);}});}function _0x285327(){const _0x4f2d46=_0x241b18,_0x3cbd83=document[_0x4f2d46(0x11e3)](_0x4f2d46(0xdfa));_0x3cbd83[_0x4f2d46(0x595)]='';const _0x570cca=[{'id':_0x4f2d46(0x847),'name':_0x4f2d46(0x1af),'description':_0x4f2d46(0x27c)},{'id':_0x4f2d46(0xbe7),'name':_0x4f2d46(0x2d5),'description':_0x4f2d46(0xb37)},{'id':'calls','name':_0x4f2d46(0xa1f),'description':_0x4f2d46(0xf74)},{'id':_0x4f2d46(0x873),'name':'心声','description':'将清空选定角色的心声和散记历史。'},{'id':'memories','name':_0x4f2d46(0xcf3),'description':'将清空选定角色的所有长期记忆。'},{'id':'favorites','name':'收藏','description':_0x4f2d46(0x4b6)},{'id':_0x4f2d46(0x63e),'name':_0x4f2d46(0xafa),'description':_0x4f2d46(0xb4b)}];_0x570cca[_0x4f2d46(0x494)](_0x43ae56=>{const _0x47790d=_0x4f2d46,_0x885ffa=document[_0x47790d(0x383)]('div');_0x885ffa[_0x47790d(0x3db)]=_0x47790d(0x1142),_0x885ffa['dataset']['typeId']=_0x43ae56['id'],_0x885ffa[_0x47790d(0x595)]=_0x47790d(0xae7)+_0x43ae56[_0x47790d(0x278)]+_0x47790d(0x558)+_0x43ae56[_0x47790d(0x1029)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3cbd83[_0x47790d(0x120c)](_0x885ffa);});}function _0x40ddee(){const _0x443d43=_0x241b18,_0x4545c8=document[_0x443d43(0x10d6)](_0x443d43(0x206));if(_0x4545c8[_0x443d43(0x594)]===0x0){alert(_0x443d43(0x12c2));return;}_0x51c940=Array['from'](_0x4545c8)[_0x443d43(0x796)](_0x2674fa=>_0x2674fa[_0x443d43(0xaca)]['charId']),_0x285327(),document[_0x443d43(0x11e3)]('data-clear-step-1')[_0x443d43(0x794)]['display']=_0x443d43(0x379),document['getElementById'](_0x443d43(0x1052))[_0x443d43(0x794)][_0x443d43(0x33d)]=_0x443d43(0x10f4);}function _0x57b99f(){const _0x28a616=_0x241b18;document[_0x28a616(0x11e3)](_0x28a616(0x1052))[_0x28a616(0x794)][_0x28a616(0x33d)]=_0x28a616(0x379),document[_0x28a616(0x11e3)](_0x28a616(0xf0))[_0x28a616(0x794)]['display']=_0x28a616(0x10f4),document[_0x28a616(0x10d6)](_0x28a616(0x33e))[_0x28a616(0x494)](_0x4f97f4=>{const _0x4d581a=_0x28a616;_0x51c940[_0x4d581a(0x3ad)](_0x4f97f4[_0x4d581a(0xaca)][_0x4d581a(0x458)])&&_0x4f97f4[_0x4d581a(0x505)]['add'](_0x4d581a(0xbbc));});}async function _0x2251dd(){const _0x4d7da2=_0x241b18,_0x1cbd47=document[_0x4d7da2(0x10d6)]('#data-clear-type-list\x20.clear-posts-item.selected');if(_0x1cbd47['length']===0x0){alert(_0x4d7da2(0x1301));return;}_0x2ac70b=Array[_0x4d7da2(0xee2)](_0x1cbd47)[_0x4d7da2(0x796)](_0x1f9067=>_0x1f9067[_0x4d7da2(0xaca)]['typeId']);const _0x360959=await _0x58fd60('最后确认！','此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？',{'confirmButtonClass':'btn-danger','confirmText':'确认删除'});if(!_0x360959)return;await _0x2fb06(_0x4d7da2(0x63d),_0x4d7da2(0x11ea));try{await _0x2e83f8[_0x4d7da2(0x1272)]('rw',_0x2e83f8[_0x4d7da2(0x9e8)],async()=>{const _0x1d198d=_0x4d7da2;for(const _0x58c3dc of _0x51c940){for(const _0x3f3ec1 of _0x2ac70b){if(_0x3f3ec1===_0x1d198d(0x847)){if(_0x58c3dc==='user'){const _0x3e43a0=await _0x2e83f8[_0x1d198d(0x737)]['toArray']();for(const _0x647794 of _0x3e43a0){_0x647794[_0x1d198d(0x49e)]=_0x647794[_0x1d198d(0x49e)][_0x1d198d(0x138)](_0x4440fc=>_0x4440fc[_0x1d198d(0xba4)]!==_0x1d198d(0x21c)),await _0x2e83f8['chats']['put'](_0x647794);}}else{const _0x589b40=await _0x2e83f8[_0x1d198d(0x737)][_0x1d198d(0x1289)](_0x58c3dc);_0x589b40&&(_0x589b40['history']=[],_0x589b40[_0x1d198d(0x535)]=_0x1d198d(0x6cb),_0x589b40[_0x1d198d(0x267)]=_0x1d198d(0x6cb),Array[_0x1d198d(0xb7b)](_0x589b40[_0x1d198d(0x3d7)])&&(_0x589b40[_0x1d198d(0x3d7)]=[]),_0x589b40[_0x1d198d(0x761)]&&(_0x589b40[_0x1d198d(0x761)]['myNickname']='我'),await _0x2e83f8[_0x1d198d(0x737)][_0x1d198d(0xe3c)](_0x589b40));}}if(_0x3f3ec1===_0x1d198d(0xbe7)){const _0x242c5b=_0x58c3dc==='user'?_0x1d198d(0x21c):_0x58c3dc;await _0x2e83f8[_0x1d198d(0x1218)]['where']('authorId')[_0x1d198d(0x119e)](_0x242c5b)[_0x1d198d(0xc0c)]();}_0x3f3ec1===_0x1d198d(0x1113)&&_0x58c3dc!==_0x1d198d(0x21c)&&await _0x2e83f8['callRecords']['where']('chatId')['equals'](_0x58c3dc)['delete']();if(_0x3f3ec1==='thoughts'&&_0x58c3dc!==_0x1d198d(0x21c)){const _0x185560=await _0x2e83f8[_0x1d198d(0x737)][_0x1d198d(0x1289)](_0x58c3dc);_0x185560&&(_0x185560[_0x1d198d(0x6d3)]=[],_0x185560[_0x1d198d(0x535)]=_0x1d198d(0x6cb),_0x185560[_0x1d198d(0x267)]=_0x1d198d(0x6cb),await _0x2e83f8['chats'][_0x1d198d(0xe3c)](_0x185560));}if(_0x3f3ec1==='memories'&&_0x58c3dc!==_0x1d198d(0x21c)){const _0x14a0a4=await _0x2e83f8[_0x1d198d(0x737)][_0x1d198d(0x1289)](_0x58c3dc);_0x14a0a4&&(_0x14a0a4['longTermMemory']=[],await _0x2e83f8[_0x1d198d(0x737)][_0x1d198d(0xe3c)](_0x14a0a4));}_0x3f3ec1===_0x1d198d(0xc3e)&&(_0x58c3dc==='user'?(await _0x2e83f8[_0x1d198d(0xc3e)][_0x1d198d(0x129e)]('type')['equals']('qzone_post')[_0x1d198d(0x138)](_0x3140e2=>_0x3140e2[_0x1d198d(0x9a5)][_0x1d198d(0x5d9)]===_0x1d198d(0x21c))[_0x1d198d(0xc0c)](),await _0x2e83f8[_0x1d198d(0xc3e)]['where'](_0x1d198d(0xa20))[_0x1d198d(0x119e)](_0x1d198d(0xb9e))['filter'](_0x49c298=>_0x49c298[_0x1d198d(0x9a5)]['role']===_0x1d198d(0x21c))[_0x1d198d(0xc0c)]()):(await _0x2e83f8[_0x1d198d(0xc3e)][_0x1d198d(0x129e)](_0x1d198d(0xa20))[_0x1d198d(0x119e)]('chat_message')[_0x1d198d(0x101d)](_0x8323c7=>_0x8323c7['chatId']===_0x58c3dc)[_0x1d198d(0xc0c)](),await _0x2e83f8[_0x1d198d(0xc3e)][_0x1d198d(0x129e)](_0x1d198d(0xa20))[_0x1d198d(0x119e)]('qzone_post')[_0x1d198d(0x138)](_0x398785=>_0x398785['content']['authorId']===_0x58c3dc)['delete'](),await _0x2e83f8[_0x1d198d(0xc3e)][_0x1d198d(0x129e)](_0x1d198d(0xa20))[_0x1d198d(0x119e)]('char_diary')[_0x1d198d(0x138)](_0x46a705=>_0x46a705['content']['characterId']===_0x58c3dc)['delete'](),await _0x2e83f8[_0x1d198d(0xc3e)]['where'](_0x1d198d(0xa20))[_0x1d198d(0x119e)]('char_browser_article')[_0x1d198d(0x138)](_0x54911a=>_0x54911a[_0x1d198d(0x9a5)][_0x1d198d(0x154)]===_0x58c3dc)[_0x1d198d(0xc0c)](),await _0x2e83f8[_0x1d198d(0xc3e)]['where'](_0x1d198d(0xa20))[_0x1d198d(0x119e)](_0x1d198d(0x503))[_0x1d198d(0x138)](_0x2040c4=>_0x2040c4[_0x1d198d(0x9a5)]['characterId']===_0x58c3dc)['delete']()));if(_0x3f3ec1===_0x1d198d(0x63e)&&_0x58c3dc!==_0x1d198d(0x21c)){const _0x43e5c9=await _0x2e83f8[_0x1d198d(0x737)][_0x1d198d(0x1289)](_0x58c3dc);_0x43e5c9&&(_0x43e5c9[_0x1d198d(0x587)]=[],_0x43e5c9['simulatedConversations']=[],_0x43e5c9[_0x1d198d(0x97a)]=[],_0x43e5c9[_0x1d198d(0x931)]=null,_0x43e5c9['simulatedAmapHistory']=[],_0x43e5c9[_0x1d198d(0xfa9)]=[],_0x43e5c9[_0x1d198d(0xb9a)]=[],_0x43e5c9[_0x1d198d(0xb43)]=[],_0x43e5c9[_0x1d198d(0x90e)]=[],await _0x2e83f8[_0x1d198d(0x737)]['put'](_0x43e5c9));}}}}),await _0x344e71(),await _0x5ee219(),document['getElementById'](_0x4d7da2(0x9c5))['classList'][_0x4d7da2(0x957)](_0x4d7da2(0x250)),await _0x2fb06(_0x4d7da2(0xb3e),_0x4d7da2(0x1243));}catch(_0x225a1f){console['error'](_0x4d7da2(0xd53),_0x225a1f),await _0x2fb06(_0x4d7da2(0x8ca),_0x4d7da2(0xf9b)+_0x225a1f[_0x4d7da2(0x4bc)]);}}async function _0x5b6858(_0x23781f,_0x9b430f,_0x43aa06){const _0x2c76c4=_0x241b18,_0x47a841=_0x43aa06[_0x2c76c4(0x5ac)](_0x2c76c4(0xd8a))[_0x2c76c4(0x71f)],_0x4913b4=await _0x16a8e1(_0x2c76c4(0xb66)+_0x47a841+_0x2c76c4(0xe89),[{'text':'📁\x20从本地上传','value':_0x2c76c4(0xd1b)},{'text':'🌐\x20使用网络URL','value':_0x2c76c4(0x10ac)}]);let _0x69a4=null;if(_0x4913b4===_0x2c76c4(0xd1b))_0x69a4=await _0x3b69be();else{if(_0x4913b4==='url'){const _0x21f912=_0x9b430f==='cphone'?_0x5de8b7[_0x2c76c4(0x2df)][_0x2c76c4(0xfaa)][_0x23781f]:_0x5de8b7[_0x2c76c4(0x2df)][_0x2c76c4(0x18b)][_0x23781f],_0xd2dbc7=_0x21f912[_0x2c76c4(0xb6c)]('data:image'),_0x557009=_0xd2dbc7?'':_0x21f912;_0x69a4=await _0x231a5a('更换图标',_0x2c76c4(0x1217),_0x557009,'url');}}if(_0x69a4&&_0x69a4[_0x2c76c4(0xeb7)]()){const _0xf0d92=_0x69a4[_0x2c76c4(0xeb7)]();_0x9b430f==='cphone'?_0x5de8b7[_0x2c76c4(0x2df)][_0x2c76c4(0xfaa)][_0x23781f]=_0xf0d92:_0x5de8b7['globalSettings'][_0x2c76c4(0x18b)][_0x23781f]=_0xf0d92,_0x43aa06['querySelector'](_0x2c76c4(0xd8a))[_0x2c76c4(0xf0a)]=_0xf0d92;}else _0x69a4!==null&&alert('请输入一个有效的URL或选择一个文件！');}async function _0x21a697(){const _0x56970d=_0x241b18,_0x216edf=await _0x58fd60('确认压缩图片？',_0x56970d(0xd69),{'confirmButtonClass':_0x56970d(0x8a6),'confirmText':_0x56970d(0xa39)});if(!_0x216edf)return;await _0x2fb06(_0x56970d(0x63d),_0x56970d(0x456));let _0x11864f={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console['log'](_0x56970d(0xeea));const _0x40394f=[_0x56970d(0x737),_0x56970d(0x2df),_0x56970d(0x1c5),_0x56970d(0xa67),'customAvatarFrames'],_0x3fe0e6=[];for(const _0x53b2d5 of _0x40394f){const _0x3478f5=_0x2e83f8[_0x56970d(0xb4e)](_0x53b2d5),_0x10ec43=await _0x3478f5[_0x56970d(0x508)]();_0x3fe0e6[_0x56970d(0xf5)]({'tableName':_0x53b2d5,'records':_0x10ec43});}console[_0x56970d(0x84b)](_0x56970d(0x1067));for(const _0x33a256 of _0x3fe0e6){for(const _0x3b930a of _0x33a256[_0x56970d(0x12c)]){await _0x12fcf7(_0x3b930a,_0x11864f);}}console[_0x56970d(0x84b)](_0x56970d(0x11a7)),await _0x2e83f8[_0x56970d(0x1272)]('rw',_0x40394f,async()=>{const _0x52063d=_0x56970d;for(const _0x3662e3 of _0x3fe0e6){await _0x2e83f8['table'](_0x3662e3[_0x52063d(0x5f2)])[_0x52063d(0xd72)](_0x3662e3[_0x52063d(0x12c)]);}});const _0x43cbb4=_0x11864f['originalSize']-_0x11864f[_0x56970d(0xdcf)],_0x5cd2ae=_0x11864f['originalSize']>0x0?(_0x43cbb4/_0x11864f[_0x56970d(0xff0)]*0x64)[_0x56970d(0x200)](0x2):0x0;await _0x2fb06(_0x56970d(0x7e2),'扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20'+_0x11864f[_0x56970d(0xd48)]+_0x56970d(0xd34)+_0x11864f[_0x56970d(0x9b2)]+'\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20'+_0x11864f[_0x56970d(0xa3d)]+_0x56970d(0xb85)+(_0x43cbb4/0x400/0x400)[_0x56970d(0x200)](0x2)+_0x56970d(0x341)+_0x5cd2ae+_0x56970d(0x4ed));}catch(_0x192e99){console[_0x56970d(0x1c1)](_0x56970d(0x4ce),_0x192e99),await _0x2fb06('压缩失败',_0x56970d(0xf9b)+_0x192e99[_0x56970d(0x4bc)]);}}function _0x252572(_0x5c324f,_0x4c0b62=''){const _0x92acbe=_0x241b18;let _0x17a749=0x0;for(const _0x2bc4a9 in _0x5c324f){if(_0x5c324f[_0x92acbe(0x2d4)](_0x2bc4a9)){const _0x3ec7cd=_0x5c324f[_0x2bc4a9];if(typeof _0x3ec7cd===_0x92acbe(0x10d7)&&_0x3ec7cd[_0x92acbe(0xb6c)](_0x92acbe(0x10e))){const _0xb5fe0=_0x4c0b62===_0x92acbe(0x2df)&&(_0x2bc4a9===_0x92acbe(0x11d)||_0x2bc4a9===_0x92acbe(0xaa4)||_0x2bc4a9===_0x92acbe(0x720))||_0x4c0b62===_0x92acbe(0x532)||_0x4c0b62==='settings'&&_0x2bc4a9===_0x92acbe(0xd10)||(_0x4c0b62==='appIcons'||_0x4c0b62===_0x92acbe(0xfaa));!_0xb5fe0&&(_0x17a749+=_0x3ec7cd[_0x92acbe(0x594)]);}else typeof _0x3ec7cd==='object'&&_0x3ec7cd!==null&&(_0x17a749+=_0x252572(_0x3ec7cd,_0x2bc4a9));}}return _0x17a749;}async function _0x5103b4(){const _0x532b1b=_0x241b18,_0x1dd5c5=document[_0x532b1b(0x11e3)](_0x532b1b(0x1bd));if(!_0x1dd5c5)return;_0x1dd5c5[_0x532b1b(0x595)]=_0x532b1b(0x496);try{let _0x306668=0x0;const _0x29c591=['chats',_0x532b1b(0x2df),'qzoneSettings',_0x532b1b(0xa67),_0x532b1b(0x675)];for(const _0xaa8eac of _0x29c591){const _0x25c53b=_0x2e83f8[_0x532b1b(0xb4e)](_0xaa8eac);await _0x25c53b[_0x532b1b(0x490)](_0x2f224b=>{_0x306668+=_0x252572(_0x2f224b);});}const _0x393a74=(_0x306668/0x400/0x400)['toFixed'](0x2);_0x1dd5c5[_0x532b1b(0x595)]=_0x532b1b(0xb94)+_0x393a74+'\x20MB</strong></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}catch(_0x2e9490){console[_0x532b1b(0x1c1)](_0x532b1b(0x12d),_0x2e9490),_0x1dd5c5[_0x532b1b(0x595)]=_0x532b1b(0xf59);}}async function _0x12fcf7(_0xd54b52,_0x4f43ce,_0x1b1ed8=''){const _0x5858fd=_0x241b18;for(const _0x46724c in _0xd54b52){if(_0xd54b52['hasOwnProperty'](_0x46724c)){const _0x108a08=_0xd54b52[_0x46724c];if(typeof _0x108a08===_0x5858fd(0x10d7)&&_0x108a08[_0x5858fd(0xb6c)](_0x5858fd(0x10e))){const _0x19f267=_0x1b1ed8===_0x5858fd(0x2df)&&(_0x46724c===_0x5858fd(0x11d)||_0x46724c===_0x5858fd(0xaa4)||_0x46724c==='globalChatBackground')||_0x1b1ed8===_0x5858fd(0x532)||_0x1b1ed8===_0x5858fd(0x761)&&_0x46724c===_0x5858fd(0xd10)||(_0x1b1ed8===_0x5858fd(0x18b)||_0x1b1ed8===_0x5858fd(0xfaa));if(_0x19f267)continue;_0x4f43ce[_0x5858fd(0xd48)]++,_0x4f43ce['originalSize']+=_0x108a08['length'];const _0x1c0cc1=await _0x4b565f(_0x108a08);_0x1c0cc1&&_0x1c0cc1!==_0x108a08?(_0xd54b52[_0x46724c]=_0x1c0cc1,_0x4f43ce[_0x5858fd(0x9b2)]++,_0x4f43ce[_0x5858fd(0xdcf)]+=_0x1c0cc1[_0x5858fd(0x594)]):(_0x4f43ce['skipped']++,_0x4f43ce[_0x5858fd(0xdcf)]+=_0x108a08[_0x5858fd(0x594)]);}else typeof _0x108a08===_0x5858fd(0x537)&&_0x108a08!==null&&await _0x12fcf7(_0x108a08,_0x4f43ce,_0x46724c);}}}function _0x4b565f(_0x7cbf4b,_0x75e5b8={}){return new Promise(_0x127b10=>{const _0x464151=_0x10a9;if(!_0x7cbf4b['startsWith'](_0x464151(0x10e))){console['warn'](_0x464151(0x827),_0x7cbf4b[_0x464151(0x8d4)](0x0,0x32)+_0x464151(0x6cb)),_0x127b10(_0x7cbf4b);return;}const _0x4854be=_0x75e5b8[_0x464151(0x888)]||0.5,_0x27f708=_0x75e5b8[_0x464151(0x1231)]||0x320,_0x47bf24=new Image();_0x47bf24[_0x464151(0x1e5)]=()=>{const _0x1bb422=_0x464151;let _0x1aca7a=_0x47bf24['width'],_0x3e1704=_0x47bf24[_0x1bb422(0x10f2)];_0x1aca7a>_0x27f708&&(_0x3e1704=Math[_0x1bb422(0xe0)](_0x27f708/_0x1aca7a*_0x3e1704),_0x1aca7a=_0x27f708);const _0x174494=document['createElement'](_0x1bb422(0xe70));_0x174494[_0x1bb422(0x1057)]=_0x1aca7a,_0x174494[_0x1bb422(0x10f2)]=_0x3e1704;const _0x1d631c=_0x174494['getContext']('2d');_0x1d631c[_0x1bb422(0xe7a)](_0x47bf24,0x0,0x0,_0x1aca7a,_0x3e1704);const _0x4675fc=_0x174494[_0x1bb422(0x1273)](_0x1bb422(0xc78),_0x4854be);_0x127b10(_0x4675fc);},_0x47bf24[_0x464151(0x741)]=()=>{const _0x257333=_0x464151;console[_0x257333(0x6b0)]('加载图片失败，跳过压缩:',_0x7cbf4b[_0x257333(0x8d4)](0x0,0x32)+'...'),_0x127b10(_0x7cbf4b);},_0x47bf24[_0x464151(0xf0a)]=_0x7cbf4b;});}function _0x35af94(_0x3a8568,_0x1d66d3){const _0x2db7a0=_0x241b18;if(!_0x3a8568||!_0x1d66d3||typeof _0x3a8568!=='string'||typeof _0x1d66d3!=='string')return 0x0;const _0x1e90ba=_0x3a8568[_0x2db7a0(0x65b)]('.')[_0x2db7a0(0x796)](Number),_0xff022c=_0x1d66d3['split']('.')['map'](Number),_0x2d5d19=Math[_0x2db7a0(0x45d)](_0x1e90ba[_0x2db7a0(0x594)],_0xff022c[_0x2db7a0(0x594)]);for(let _0x55f494=0x0;_0x55f494<_0x2d5d19;_0x55f494++){const _0x49990b=_0x1e90ba[_0x55f494]||0x0,_0x5e8b1f=_0xff022c[_0x55f494]||0x0;if(_0x49990b>_0x5e8b1f)return 0x1;if(_0x49990b<_0x5e8b1f)return-0x1;}return 0x0;}async function _0x3ff8da(){const _0x384282=_0x241b18,_0x255f43='1.0';try{const _0x52814e=await fetch(_0x384282(0xaff)+Date[_0x384282(0x1182)]());if(!_0x52814e['ok']){console[_0x384282(0x6b0)](_0x384282(0x129b));return;}const _0x12c11f=await _0x52814e['text'](),_0x3b45a7=document[_0x384282(0x383)](_0x384282(0x1285));_0x3b45a7['innerHTML']=_0x12c11f;const _0x2c56ea=_0x3b45a7['querySelector'](_0x384282(0x12e1));if(!_0x2c56ea){console[_0x384282(0x1c1)](_0x384282(0x8aa));return;}const _0x35cc23=_0x2c56ea[_0x384282(0xaca)][_0x384282(0x168)],_0x3a4536=localStorage[_0x384282(0x728)](_0x384282(0x3ea));!_0x3a4536||_0x35af94(_0x35cc23,_0x3a4536)>0x0?(console[_0x384282(0x84b)]('发现新版本通知:\x20'+_0x35cc23+_0x384282(0x923)+(_0x3a4536||'无')+')'),_0x4a81c6(_0x35cc23,_0x2c56ea[_0x384282(0x595)])):console[_0x384282(0x84b)](_0x384282(0x116b)+_0x35cc23+_0x384282(0xd0b));}catch(_0x3fe61c){console[_0x384282(0x1c1)](_0x384282(0x3e8),_0x3fe61c);}}function _0x4a81c6(_0x416fe1,_0x4144e4){const _0x25cad9=_0x241b18,_0x5e0714=document[_0x25cad9(0x11e3)](_0x25cad9(0xd46)),_0x1eab81=document[_0x25cad9(0x11e3)]('update-notice-body'),_0x6a3d11=document[_0x25cad9(0x11e3)](_0x25cad9(0x8d9)),_0x2669ed=document[_0x25cad9(0x11e3)]('update-notice-dismiss-btn');_0x1eab81['innerHTML']=_0x4144e4,_0x6a3d11[_0x25cad9(0x1074)]=()=>{const _0x160b46=_0x25cad9;_0x5e0714[_0x160b46(0x505)]['remove'](_0x160b46(0x250));},_0x2669ed['onclick']=()=>{const _0x165690=_0x25cad9;localStorage[_0x165690(0x3b2)](_0x165690(0x3ea),_0x416fe1),_0x5e0714[_0x165690(0x505)][_0x165690(0x957)](_0x165690(0x250)),console[_0x165690(0x84b)](_0x165690(0x973)+_0x416fe1);},_0x5e0714['classList'][_0x25cad9(0x252)](_0x25cad9(0x250));}function _0x434525(){const _0xfa082b=_0x241b18,_0x188707=document[_0xfa082b(0x11e3)](_0xfa082b(0x122));document[_0xfa082b(0x11e3)](_0xfa082b(0x121b))[_0xfa082b(0xf27)]=_0x5de8b7[_0xfa082b(0x2df)][_0xfa082b(0xaba)]||0xc,document[_0xfa082b(0x11e3)](_0xfa082b(0x12d3))[_0xfa082b(0xf27)]=_0x5de8b7[_0xfa082b(0x2df)][_0xfa082b(0xc74)]||0x14,_0x188707[_0xfa082b(0x505)][_0xfa082b(0x252)](_0xfa082b(0x250));}async function _0x1a5071(){const _0x378f4b=_0x241b18,_0x20335c=document['getElementById'](_0x378f4b(0x121b)),_0x2fbec1=document['getElementById'](_0x378f4b(0x12d3)),_0x422d6e=parseInt(_0x20335c['value']),_0x16a9bf=parseInt(_0x2fbec1[_0x378f4b(0xf27)]);if(isNaN(_0x422d6e)||isNaN(_0x16a9bf)||_0x422d6e<0x1||_0x16a9bf<0x1){alert(_0x378f4b(0x11b6));return;}if(_0x422d6e>_0x16a9bf){alert(_0x378f4b(0x102));return;}_0x5de8b7['globalSettings'][_0x378f4b(0xaba)]=_0x422d6e,_0x5de8b7['globalSettings'][_0x378f4b(0xc74)]=_0x16a9bf,await _0x2e83f8[_0x378f4b(0x2df)]['put'](_0x5de8b7['globalSettings']),document[_0x378f4b(0x11e3)](_0x378f4b(0x122))[_0x378f4b(0x505)][_0x378f4b(0x957)](_0x378f4b(0x250)),await _0x2fb06('保存成功',_0x378f4b(0x51a));}async function _0x3ab477(_0x5b0a50){const _0x2f4b5b=_0x241b18,_0x500969=document[_0x2f4b5b(0x11e3)](_0x2f4b5b(0x57e)),_0x119f06=document['getElementById']('werewolf-player-selection-list');_0x119f06[_0x2f4b5b(0x595)]='';let _0x2b6ed9=[];if(_0x5b0a50===_0x2f4b5b(0x104b)){const _0x5d4b4a=Object['values'](_0x5de8b7[_0x2f4b5b(0x737)])[_0x2f4b5b(0x138)](_0x48a4ce=>!_0x48a4ce[_0x2f4b5b(0x1244)]),_0x508132=await _0x2e83f8[_0x2f4b5b(0xf00)][_0x2f4b5b(0x508)]();_0x2b6ed9=[{'id':_0x2f4b5b(0x21c),'name':_0x5de8b7[_0x2f4b5b(0x1c5)][_0x2f4b5b(0xa33)]||'我','originalName':_0x5de8b7['qzoneSettings']['nickname']||'我','avatar':_0x5de8b7['qzoneSettings'][_0x2f4b5b(0x525)],'type':'user'},..._0x5d4b4a[_0x2f4b5b(0x796)](_0x3efc18=>({'id':_0x3efc18['id'],'name':_0x3efc18[_0x2f4b5b(0x278)],'originalName':_0x3efc18[_0x2f4b5b(0x697)],'avatar':_0x3efc18[_0x2f4b5b(0x761)][_0x2f4b5b(0x5e0)],'type':_0x2f4b5b(0x12e7)})),..._0x508132[_0x2f4b5b(0x796)](_0x45c9fb=>({'id':'npc_'+_0x45c9fb['id'],'name':_0x45c9fb['name'],'originalName':_0x45c9fb['name'],'avatar':_0x45c9fb['avatar'],'type':_0x2f4b5b(0xb91)}))],_0x528823[_0x2f4b5b(0x115)]=null;}else{const _0x564400=_0x5de8b7[_0x2f4b5b(0x737)][_0x5de8b7[_0x2f4b5b(0x93d)]];if(!_0x564400||!_0x564400[_0x2f4b5b(0x1244)])return;_0x2b6ed9=[{'id':_0x2f4b5b(0x21c),'name':_0x564400[_0x2f4b5b(0x761)][_0x2f4b5b(0xca7)]||'我','originalName':_0x5de8b7[_0x2f4b5b(0x1c5)][_0x2f4b5b(0xa33)]||'我','avatar':_0x564400[_0x2f4b5b(0x761)][_0x2f4b5b(0xc43)],'type':_0x2f4b5b(0x21c)},..._0x564400[_0x2f4b5b(0x2b3)][_0x2f4b5b(0x796)](_0x1cbbac=>{const _0x49c671=_0x2f4b5b,_0x5bea7f=_0x5de8b7[_0x49c671(0x737)][_0x1cbbac['id']],_0x3fdff7=_0x1cbbac['avatar']||(_0x5bea7f?_0x5bea7f[_0x49c671(0x761)]['aiAvatar']:_0x4d9574);return{'id':_0x1cbbac['id'],'name':_0x1cbbac['groupNickname'],'originalName':_0x1cbbac[_0x49c671(0x697)],'avatar':_0x3fdff7,'type':_0x1cbbac[_0x49c671(0x1171)]?'npc':_0x49c671(0x12e7)};})],_0x528823[_0x2f4b5b(0x115)]=_0x5de8b7['activeChatId'];}_0x2b6ed9['forEach'](_0x5e2213=>{const _0x2733e1=_0x2f4b5b,_0x1bcfb4=document['createElement'](_0x2733e1(0x1285));_0x1bcfb4['className']='contact-picker-item',_0x1bcfb4['innerHTML']=_0x2733e1(0x622)+JSON[_0x2733e1(0x313)](_0x5e2213)+'\x27\x20'+(_0x5e2213['type']==='user'?_0x2733e1(0xfed):_0x2733e1(0x3e4))+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x5e2213[_0x2733e1(0x525)]+_0x2733e1(0x655)+_0x5e2213['name']+_0x2733e1(0x8e8),_0x119f06[_0x2733e1(0x120c)](_0x1bcfb4);}),_0x500969['classList']['add']('visible');}async function _0x3e2407(){const _0x551183=_0x241b18,_0x3eb594=document[_0x551183(0x10d6)]('.werewolf-player-checkbox:checked'),_0x4c8200=_0x3eb594[_0x551183(0x594)];let _0xd5a189=[];if(_0x4c8200===0x6)_0x528823[_0x551183(0xba1)]='6p',_0xd5a189=['狼人','狼人','平民','平民',_0x551183(0x941),'猎人'];else{if(_0x4c8200===0x9)_0x528823[_0x551183(0xba1)]='9p',_0xd5a189=['狼人','狼人','狼人','平民','平民','平民','预言家','女巫','猎人'];else{if(_0x4c8200===0xc)_0x528823[_0x551183(0xba1)]='12p',_0xd5a189=['狼人','狼人','狼人','狼人','平民','平民','平民','平民',_0x551183(0x941),'女巫','猎人','守卫'];else{alert(_0x551183(0xf9)+_0x4c8200+_0x551183(0x12e2));return;}}}document['getElementById'](_0x551183(0x57e))[_0x551183(0x505)][_0x551183(0x957)](_0x551183(0x250)),await _0x2fb06(_0x551183(0xece),_0x551183(0x8a4));for(let _0x209222=_0xd5a189[_0x551183(0x594)]-0x1;_0x209222>0x0;_0x209222--){const _0x3226c9=Math[_0x551183(0xfb1)](Math[_0x551183(0x36d)]()*(_0x209222+0x1));[_0xd5a189[_0x209222],_0xd5a189[_0x3226c9]]=[_0xd5a189[_0x3226c9],_0xd5a189[_0x209222]];}const _0x258f55=Array[_0x551183(0xee2)](_0x3eb594)[_0x551183(0x796)](_0x22ba71=>JSON[_0x551183(0xb0c)](_0x22ba71[_0x551183(0xaca)][_0x551183(0x12f2)]));_0x528823[_0x551183(0xc0d)]=[];for(let _0x38ff10=0x0;_0x38ff10<_0x258f55['length'];_0x38ff10++){const _0x972631=_0x258f55[_0x38ff10],_0x11f993=_0xd5a189[_0x38ff10];let _0x58165a='一个普通玩家';if(_0x972631[_0x551183(0xa20)]===_0x551183(0x12e7)){const _0x4e5f1f=_0x5de8b7['chats'][_0x972631['id']];_0x58165a=_0x4e5f1f?_0x4e5f1f[_0x551183(0x761)][_0x551183(0x8d5)]:'未知设定的角色';}else{if(_0x972631[_0x551183(0xa20)]===_0x551183(0xb91)){const _0x4ae30d=await _0x2e83f8[_0x551183(0xf00)][_0x551183(0x508)](),_0x5468ce=_0x4ae30d[_0x551183(0xe79)](_0x399a9a=>_0x551183(0x8b8)+_0x399a9a['id']===_0x972631['id']);_0x58165a=_0x5468ce?_0x5468ce[_0x551183(0x701)]:'未知设定的NPC';}else{if(_0x972631[_0x551183(0xa20)]==='user'){const _0x2861e0=_0x528823[_0x551183(0x115)]?_0x5de8b7[_0x551183(0x737)][_0x528823[_0x551183(0x115)]]:null;_0x58165a=_0x2861e0?_0x2861e0[_0x551183(0x761)][_0x551183(0x10c5)]:'我是谁呀。';}}}const _0x5a0ec9={..._0x972631,'role':_0x11f993,'isAlive':!![],'character_persona':_0x58165a};_0x11f993==='女巫'&&(_0x5a0ec9['antidoteUsed']=![],_0x5a0ec9[_0x551183(0x8ed)]=![]),_0x11f993==='守卫'&&(_0x5a0ec9[_0x551183(0xa68)]=null),_0x528823['players'][_0x551183(0xf5)](_0x5a0ec9);}_0x528823[_0x551183(0x3d5)]=!![],_0x528823[_0x551183(0xedd)]=0x1,_0x528823[_0x551183(0x4f4)]=_0x551183(0x67c),_0x528823[_0x551183(0xe23)]=[],_0x528823[_0x551183(0x65a)]=[];const _0x57658b=_0xd5a189['reduce']((_0x44e328,_0x172b3e)=>{return _0x44e328[_0x172b3e]=(_0x44e328[_0x172b3e]||0x0)+0x1,_0x44e328;},{}),_0x4db502=Object['entries'](_0x57658b)[_0x551183(0x796)](([_0x598b60,_0x1ec25c])=>_0x598b60+'\x20x'+_0x1ec25c)['join']('、');_0x52f8a8(_0x551183(0x606)+_0x4c8200+_0x551183(0xb22)+_0x4db502+'。');const _0xe33795=_0x528823[_0x551183(0xc0d)]['find'](_0x454909=>_0x454909['id']===_0x551183(0x21c));_0x14c77a(),_0x4e7698(_0x551183(0x12bf)),_0x2cc063(_0xe33795[_0x551183(0xba4)]);}function _0x14c77a(){const _0x5ef434=_0x241b18,_0x19ca82=document[_0x5ef434(0x11e3)](_0x5ef434(0x746));_0x19ca82[_0x5ef434(0x595)]='';const _0x134a9b=[..._0x528823[_0x5ef434(0xc0d)]][_0x5ef434(0x861)]((_0x56a330,_0x598616)=>_0x56a330[_0x5ef434(0x4ff)]-_0x598616[_0x5ef434(0x4ff)]);_0x134a9b[_0x5ef434(0x494)]((_0x28b464,_0x58208e)=>{const _0x46e015=_0x5ef434,_0x195c51=_0x528823[_0x46e015(0xc0d)][_0x46e015(0x901)](_0x66ce11=>_0x66ce11['id']===_0x28b464['id'])+0x1,_0x49bada=document[_0x46e015(0x383)](_0x46e015(0x1285));_0x49bada[_0x46e015(0x3db)]=_0x46e015(0x1179);if(!_0x28b464[_0x46e015(0x4ff)])_0x49bada[_0x46e015(0x505)]['add']('dead');_0x49bada[_0x46e015(0x595)]=_0x46e015(0xd6d)+_0x28b464[_0x46e015(0x525)]+_0x46e015(0xbce)+_0x195c51+'.\x20'+_0x28b464[_0x46e015(0x278)]+_0x46e015(0x8e8),_0x19ca82[_0x46e015(0x120c)](_0x49bada);});const _0x3db1e8=document[_0x5ef434(0x11e3)](_0x5ef434(0x4d1));_0x3db1e8[_0x5ef434(0x595)]='';for(let _0x215ee7=0x1;_0x215ee7<=_0x528823[_0x5ef434(0xedd)];_0x215ee7++){const _0x5457ca=[..._0x528823[_0x5ef434(0xe23)]['filter'](_0x16fd83=>_0x16fd83['day']===_0x215ee7),..._0x528823['discussionLog'][_0x5ef434(0x138)](_0x32606e=>_0x32606e[_0x5ef434(0x9d2)]===_0x215ee7)]['sort']((_0x300296,_0x364bb3)=>(_0x300296[_0x5ef434(0x702)]||0x0)-(_0x364bb3[_0x5ef434(0x702)]||0x0));if(_0x5457ca[_0x5ef434(0x594)]>0x0){const _0x4227e7=document[_0x5ef434(0x383)](_0x5ef434(0x1285));_0x4227e7[_0x5ef434(0x3db)]=_0x5ef434(0xb9c),_0x4227e7[_0x5ef434(0x300)]='---\x20第\x20'+_0x215ee7+'\x20天\x20---',_0x4227e7[_0x5ef434(0x794)]['cssText']=_0x5ef434(0x3fb),_0x3db1e8[_0x5ef434(0x120c)](_0x4227e7),_0x5457ca['forEach'](_0xbf427c=>{const _0x4510a4=_0x5ef434,_0x2c2728=document[_0x4510a4(0x383)](_0x4510a4(0x1285));_0x2c2728[_0x4510a4(0x3db)]=_0x4510a4(0x59b)+_0xbf427c[_0x4510a4(0xa20)],_0xbf427c[_0x4510a4(0xa20)]===_0x4510a4(0x159)?_0x2c2728[_0x4510a4(0x595)]=_0x4510a4(0xbaf)+_0xbf427c['speaker']+_0x4510a4(0xb06)+_0xbf427c['content']:_0x2c2728[_0x4510a4(0x300)]=_0xbf427c[_0x4510a4(0x9a5)],_0x3db1e8[_0x4510a4(0x120c)](_0x2c2728);});}}_0x3db1e8[_0x5ef434(0x11c7)]=_0x3db1e8[_0x5ef434(0x36b)];const _0x5aae98={'start':_0x5ef434(0x141),'night':'第'+_0x528823['currentDay']+_0x5ef434(0x9c1),'day':'第'+_0x528823[_0x5ef434(0xedd)]+_0x5ef434(0x7f4),'discussion':'第'+_0x528823[_0x5ef434(0xedd)]+_0x5ef434(0x12ec),'voting':'第'+_0x528823['currentDay']+_0x5ef434(0xd59),'gameover':'游戏结束'};document[_0x5ef434(0x11e3)](_0x5ef434(0xe25))[_0x5ef434(0x300)]='狼人杀\x20-\x20'+(_0x5aae98[_0x528823[_0x5ef434(0x4f4)]]||_0x528823[_0x5ef434(0x4f4)]);}function _0x2cc063(_0x3e4088){const _0x2a0ccf=_0x241b18,_0x40b4d9={'狼人':_0x2a0ccf(0xcca),'平民':_0x2a0ccf(0xd65),'预言家':_0x2a0ccf(0x4e5),'猎人':_0x2a0ccf(0x10eb),'女巫':_0x2a0ccf(0x32d),'守卫':_0x2a0ccf(0x299)};document['getElementById'](_0x2a0ccf(0x7dc))['textContent']=_0x3e4088,document[_0x2a0ccf(0x11e3)](_0x2a0ccf(0x519))[_0x2a0ccf(0x300)]=_0x40b4d9[_0x3e4088]||_0x2a0ccf(0x10a8),document[_0x2a0ccf(0x11e3)](_0x2a0ccf(0xff3))[_0x2a0ccf(0x505)][_0x2a0ccf(0x252)](_0x2a0ccf(0x250));}async function _0x174fe7(){const _0x4dcf1a=_0x241b18;_0x528823[_0x4dcf1a(0x4f4)]='第'+_0x528823[_0x4dcf1a(0xedd)]+_0x4dcf1a(0x9c1),_0x528823[_0x4dcf1a(0x8c8)]={},_0x52f8a8(_0x4dcf1a(0xa51)),_0x14c77a(),document[_0x4dcf1a(0x11e3)](_0x4dcf1a(0x100d))[_0x4dcf1a(0x794)][_0x4dcf1a(0x33d)]=_0x4dcf1a(0x379),document['getElementById'](_0x4dcf1a(0x4cf))[_0x4dcf1a(0x794)]['display']=_0x4dcf1a(0x379),await new Promise(_0x4867bc=>setTimeout(_0x4867bc,0x5dc));const _0x3bd907=_0x528823['players'][_0x4dcf1a(0xe79)](_0x48633b=>_0x48633b['role']==='守卫'&&_0x48633b[_0x4dcf1a(0x4ff)]);if(_0x3bd907){_0x52f8a8('守卫请睁眼，请选择要守护的玩家。'),_0x14c77a();let _0x3ca93a=null;if(_0x3bd907['id']===_0x4dcf1a(0x21c))_0x3ca93a=await _0x111039(_0x4dcf1a(0x158),_0x3bd907[_0x4dcf1a(0xa68)]);else{const _0x5aec9b=_0x528823['players']['filter'](_0x288c5d=>_0x288c5d['isAlive']&&_0x288c5d['id']!==_0x3bd907[_0x4dcf1a(0xa68)]);_0x5aec9b['length']>0x0&&(_0x3ca93a=_0x5aec9b[Math['floor'](Math[_0x4dcf1a(0x36d)]()*_0x5aec9b['length'])]['id']);}_0x3ca93a&&(_0x528823[_0x4dcf1a(0x8c8)][_0x4dcf1a(0x557)]=_0x3ca93a,_0x3bd907[_0x4dcf1a(0xa68)]=_0x3ca93a),_0x52f8a8(_0x4dcf1a(0x804)),_0x14c77a(),await new Promise(_0x4a9203=>setTimeout(_0x4a9203,0x5dc));}_0x52f8a8(_0x4dcf1a(0x38c)),_0x14c77a();const _0x2330d8=_0x528823[_0x4dcf1a(0xc0d)][_0x4dcf1a(0x138)](_0x1a9ab1=>_0x1a9ab1[_0x4dcf1a(0xba4)]==='狼人'&&_0x1a9ab1['isAlive']),_0xf2cfb3=_0x2330d8[_0x4dcf1a(0xe7c)](_0x5e0aa5=>_0x5e0aa5['id']===_0x4dcf1a(0x21c));let _0x381985=null;_0x528823[_0x4dcf1a(0xa9c)]='wolfKill';try{if(_0xf2cfb3)_0x52f8a8(_0x4dcf1a(0x882)),_0x14c77a(),_0x381985=await _0x5bc488();else{if(_0x528823[_0x4dcf1a(0xedd)]===0x1){console[_0x4dcf1a(0x84b)]('第一夜，执行本地随机刀人逻辑...');const _0x559df7=_0x528823[_0x4dcf1a(0xc0d)][_0x4dcf1a(0x138)](_0x347b2f=>_0x347b2f[_0x4dcf1a(0x4ff)]&&_0x347b2f[_0x4dcf1a(0xba4)]!=='狼人');_0x559df7[_0x4dcf1a(0x594)]>0x0&&(_0x381985=_0x559df7[Math[_0x4dcf1a(0xfb1)](Math[_0x4dcf1a(0x36d)]()*_0x559df7['length'])]['id']);}else _0x381985=await _0x36a502();}_0x528823[_0x4dcf1a(0xa9c)]=null;}catch(_0x4946a8){console[_0x4dcf1a(0x1c1)](_0x4dcf1a(0x3dd),_0x4946a8),await _0x2fb06(_0x4dcf1a(0x1177),_0x4dcf1a(0x4fe)),document['getElementById'](_0x4dcf1a(0x4cf))[_0x4dcf1a(0x794)][_0x4dcf1a(0x33d)]=_0x4dcf1a(0x11ac);return;}_0x528823[_0x4dcf1a(0x8c8)][_0x4dcf1a(0x9a4)]=_0x381985,_0x52f8a8(_0x4dcf1a(0x736)),_0x14c77a(),await new Promise(_0x2f0512=>setTimeout(_0x2f0512,0x5dc));const _0x37ea9b=_0x528823[_0x4dcf1a(0xc0d)]['find'](_0x5df148=>_0x5df148[_0x4dcf1a(0xba4)]==='女巫'&&_0x5df148[_0x4dcf1a(0x4ff)]);if(_0x37ea9b){_0x52f8a8(_0x4dcf1a(0x12c4)),_0x14c77a();const _0x8d442f=_0x528823[_0x4dcf1a(0xc0d)][_0x4dcf1a(0xe79)](_0xee7ee7=>_0xee7ee7['id']===_0x528823['nightActions'][_0x4dcf1a(0x9a4)]),_0x58112a=_0x528823[_0x4dcf1a(0x8c8)][_0x4dcf1a(0x557)]===_0x528823[_0x4dcf1a(0x8c8)]['killedId'],_0x49f0f8=_0x58112a||!_0x8d442f?null:_0x8d442f;if(_0x37ea9b['id']==='user'){let _0x2905fe=await _0x4dabd7(_0x49f0f8,_0x37ea9b);_0x2905fe[_0x4dcf1a(0xcfa)]&&(_0x528823[_0x4dcf1a(0x8c8)]['savedId']=_0x528823[_0x4dcf1a(0x8c8)][_0x4dcf1a(0x9a4)],_0x37ea9b[_0x4dcf1a(0x9b7)]=!![]),_0x2905fe['poison']&&(_0x528823['nightActions']['poisonedId']=_0x2905fe[_0x4dcf1a(0x11e1)],_0x37ea9b[_0x4dcf1a(0x8ed)]=!![]);}else{if(!_0x37ea9b[_0x4dcf1a(0x9b7)]&&_0x49f0f8){let _0x3a8ac9=0x0;_0x528823[_0x4dcf1a(0xedd)]===0x1?_0x3a8ac9=0.3:_0x3a8ac9=0.8,console[_0x4dcf1a(0x84b)](_0x4dcf1a(0x550)+_0x528823[_0x4dcf1a(0xedd)]+_0x4dcf1a(0x54d)+_0x3a8ac9*0x64+'%'),Math[_0x4dcf1a(0x36d)]()<_0x3a8ac9?(console[_0x4dcf1a(0x84b)](_0x4dcf1a(0x907)),_0x528823[_0x4dcf1a(0x8c8)]['savedId']=_0x528823['nightActions']['killedId'],_0x37ea9b[_0x4dcf1a(0x9b7)]=!![]):console[_0x4dcf1a(0x84b)]('AI女巫决定保留解药。');}if(!_0x528823[_0x4dcf1a(0x8c8)]['savedId']&&!_0x37ea9b[_0x4dcf1a(0x8ed)]&&Math[_0x4dcf1a(0x36d)]()<0.5){const _0x7c34cc=_0x528823['players']['filter'](_0x24f59b=>_0x24f59b['isAlive']&&_0x24f59b['id']!==_0x528823[_0x4dcf1a(0x8c8)]['killedId']);if(_0x7c34cc[_0x4dcf1a(0x594)]>0x0){const _0x36a2d1=_0x7c34cc[Math[_0x4dcf1a(0xfb1)](Math[_0x4dcf1a(0x36d)]()*_0x7c34cc[_0x4dcf1a(0x594)])];_0x528823[_0x4dcf1a(0x8c8)]['poisonedId']=_0x36a2d1['id'],_0x37ea9b[_0x4dcf1a(0x8ed)]=!![],console[_0x4dcf1a(0x84b)]('AI女巫决定使用毒药，目标是:\x20'+_0x36a2d1[_0x4dcf1a(0x278)]);}}}_0x52f8a8(_0x4dcf1a(0xbf9)),_0x14c77a(),await new Promise(_0x3c8b67=>setTimeout(_0x3c8b67,0x5dc));}const _0x257695=_0x528823[_0x4dcf1a(0xc0d)][_0x4dcf1a(0xe79)](_0x275514=>_0x275514['role']===_0x4dcf1a(0x941)&&_0x275514[_0x4dcf1a(0x4ff)]);if(_0x257695){_0x52f8a8('预言家请睁眼，请选择要查验的玩家。'),_0x14c77a();if(_0x257695['id']===_0x4dcf1a(0x21c)){const _0x4cfda0=await _0x111039(_0x4dcf1a(0x1278)),_0x2ce1ef=_0x528823['players'][_0x4dcf1a(0xe79)](_0x1100cc=>_0x1100cc['id']===_0x4cfda0);if(_0x2ce1ef){const _0x330bbc=_0x2ce1ef[_0x4dcf1a(0xba4)]==='狼人';await _0x2fb06(_0x4dcf1a(0xa63),_0x4dcf1a(0xbbf)+_0x2ce1ef['name']+_0x4dcf1a(0xdc1)+(_0x330bbc?'狼人':'好人')),_0x528823['nightActions'][_0x4dcf1a(0xf91)]={'target':_0x4cfda0,'result':_0x330bbc?'狼人':'好人'};}}else{const _0x1babde=_0x528823[_0x4dcf1a(0xc0d)][_0x4dcf1a(0x138)](_0x3fcb3f=>_0x3fcb3f[_0x4dcf1a(0x4ff)]&&_0x3fcb3f['id']!==_0x257695['id']);if(_0x1babde[_0x4dcf1a(0x594)]>0x0){const _0x5884e5=_0x1babde[Math[_0x4dcf1a(0xfb1)](Math[_0x4dcf1a(0x36d)]()*_0x1babde[_0x4dcf1a(0x594)])];_0x528823['nightActions']['prophetCheck']={'target':_0x5884e5['id'],'result':_0x5884e5[_0x4dcf1a(0xba4)]==='狼人'?'狼人':'好人'};}}_0x52f8a8(_0x4dcf1a(0x911)),_0x14c77a(),await new Promise(_0x4de64c=>setTimeout(_0x4de64c,0x5dc));}_0x549ec6();}async function _0x549ec6(){const _0x9b106=_0x241b18;_0x528823[_0x9b106(0x4f4)]='第'+_0x528823['currentDay']+_0x9b106(0x7f4),_0x528823[_0x9b106(0xd5b)]={},_0x52f8a8('天亮了。');const {killedId:_0x43b818,guardedId:_0x48a3f9,savedId:_0x42541f,poisonedId:_0x5aa1b9}=_0x528823[_0x9b106(0x8c8)],_0x7dddac=new Set();_0x43b818&&_0x43b818!==_0x48a3f9&&_0x43b818!==_0x42541f&&_0x7dddac[_0x9b106(0x252)](_0x43b818);_0x5aa1b9&&_0x7dddac[_0x9b106(0x252)](_0x5aa1b9);if(_0x7dddac[_0x9b106(0x1159)]===0x0)_0x52f8a8(_0x9b106(0x815));else for(const _0x50045e of _0x7dddac){const _0x223b2c=_0x528823[_0x9b106(0xc0d)]['find'](_0xb2dd53=>_0xb2dd53['id']===_0x50045e);if(_0x223b2c&&_0x223b2c['isAlive']){_0x223b2c['isAlive']=![],_0x52f8a8(_0x9b106(0x11f4)+_0x223b2c['name']+'\x20死亡了。');if(_0x223b2c['role']==='猎人'){_0x52f8a8(_0x9b106(0x1b7)),_0x14c77a();let _0x51c27b=null;if(_0x223b2c['id']===_0x9b106(0x21c))_0x51c27b=await _0x111039(_0x9b106(0x9ab));else{const _0x4d8e03=_0x528823[_0x9b106(0xc0d)][_0x9b106(0x138)](_0x5b5054=>_0x5b5054['isAlive']&&_0x5b5054['id']!==_0x223b2c['id']);_0x4d8e03[_0x9b106(0x594)]>0x0&&(_0x51c27b=_0x4d8e03[Math[_0x9b106(0xfb1)](Math[_0x9b106(0x36d)]()*_0x4d8e03[_0x9b106(0x594)])]['id']);}const _0xcaf13b=_0x528823[_0x9b106(0xc0d)][_0x9b106(0xe79)](_0x349773=>_0x349773['id']===_0x51c27b);_0xcaf13b&&(_0xcaf13b[_0x9b106(0x4ff)]=![],_0x52f8a8('猎人带走了\x20'+_0xcaf13b['name']+'。'));}}}_0x14c77a();if(_0x3dfee())return;await _0x20ace0();}async function _0x20ace0(){const _0x3dd3ed=_0x241b18;_0x52f8a8(_0x3dd3ed(0xdab)),_0x14c77a();const {proxyUrl:_0x344e48,apiKey:_0x3623d5,model:_0x4899e2}=_0x5de8b7[_0x3dd3ed(0x89c)];if(!_0x344e48||!_0x3623d5||!_0x4899e2){alert(_0x3dd3ed(0x7f3));return;}const _0x4dc572=_0xe2d064();_0x528823[_0x3dd3ed(0xa9c)]=_0x3dd3ed(0xbc6);try{await _0x2fb06(_0x3dd3ed(0xc1e),'正在等待AI角色们进行激烈的讨论...');let _0x3de4e2=_0x344e48[_0x3dd3ed(0x3ad)](_0x3dd3ed(0xb9b)),_0x46a8a3=[{'role':_0x3dd3ed(0x21c),'content':_0x3dd3ed(0x59d)}],_0x10262c=_0x4a90fe(_0x4899e2,_0x3623d5,_0x4dc572,_0x46a8a3);const _0x4513fa=_0x3de4e2?await fetch(_0x10262c[_0x3dd3ed(0x10ac)],_0x10262c[_0x3dd3ed(0x1cc)]):await fetch(_0x344e48+_0x3dd3ed(0x8fd),{'method':_0x3dd3ed(0x1128),'headers':{'Content-Type':_0x3dd3ed(0x35c),'Authorization':_0x3dd3ed(0xdaf)+_0x3623d5},'body':JSON[_0x3dd3ed(0x313)]({'model':_0x4899e2,'messages':[{'role':_0x3dd3ed(0xf72),'content':_0x4dc572},..._0x46a8a3],'temperature':_0x5de8b7[_0x3dd3ed(0x2df)]['apiTemperature']||0.95})});if(!_0x4513fa['ok']){const _0x24e5b1=await _0x4513fa['json']();throw new Error(_0x3dd3ed(0x307)+_0x24e5b1[_0x3dd3ed(0x1c1)][_0x3dd3ed(0x4bc)]);}const _0x46c136=await _0x4513fa['json'](),_0x43edeb=getGeminiResponseText(_0x46c136),_0x34ab0c=_0x43edeb[_0x3dd3ed(0xe9f)](/(\[[\s\S]*\])/);if(!_0x34ab0c)throw new Error('AI返回的讨论内容格式不正确。原始返回:\x20'+_0x43edeb);const _0x5153bd=JSON[_0x3dd3ed(0xb0c)](_0x34ab0c[0x0]);for(const _0x132136 of _0x5153bd){_0x132136[_0x3dd3ed(0x77e)]&&_0x132136['dialogue']&&(_0x5a5efe(_0x132136['speaker_name'],_0x132136['dialogue']),_0x14c77a(),await new Promise(_0x1a0b52=>setTimeout(_0x1a0b52,0x5dc+Math[_0x3dd3ed(0x36d)]()*0x7d0)));}_0x528823['lastFailedAction']=null;}catch(_0x1aec7b){console[_0x3dd3ed(0x1c1)](_0x3dd3ed(0x98c),_0x1aec7b),await _0x2fb06(_0x3dd3ed(0x11c1),_0x3dd3ed(0x377)+_0x1aec7b[_0x3dd3ed(0x4bc)]),document[_0x3dd3ed(0x11e3)](_0x3dd3ed(0x4cf))[_0x3dd3ed(0x794)][_0x3dd3ed(0x33d)]=_0x3dd3ed(0x11ac);return;}const _0x55cc05=_0x528823[_0x3dd3ed(0xc0d)]['find'](_0x383153=>_0x383153['id']===_0x3dd3ed(0x21c)),_0x40241e=document[_0x3dd3ed(0x11e3)](_0x3dd3ed(0x100d)),_0xbff8aa=document['getElementById'](_0x3dd3ed(0x288)),_0x56f24d=document[_0x3dd3ed(0x11e3)](_0x3dd3ed(0xe14)),_0xc3a4ea=document[_0x3dd3ed(0x11e3)](_0x3dd3ed(0x12ee));_0x40241e['style']['display']=_0x3dd3ed(0x10f4);if(_0x55cc05&&_0x55cc05[_0x3dd3ed(0x4ff)]){_0xbff8aa[_0x3dd3ed(0x300)]=_0x3dd3ed(0xcbd),_0x56f24d[_0x3dd3ed(0x300)]=_0x3dd3ed(0x4bd),_0xbff8aa[_0x3dd3ed(0x794)][_0x3dd3ed(0x33d)]=_0x3dd3ed(0x11ac),_0x56f24d[_0x3dd3ed(0x794)]['display']=_0x3dd3ed(0x11ac),_0xc3a4ea['disabled']=![],_0xc3a4ea[_0x3dd3ed(0x569)]=_0x3dd3ed(0xd11),_0xc3a4ea[_0x3dd3ed(0xc1f)]();const _0x19bcb7=_0xbff8aa[_0x3dd3ed(0x4b4)](!![]);_0xbff8aa[_0x3dd3ed(0x18c)][_0x3dd3ed(0xeaa)](_0x19bcb7,_0xbff8aa),_0x19bcb7[_0x3dd3ed(0x4b8)](_0x3dd3ed(0x1041),_0x3aa5af);const _0x1e2a4f=_0x56f24d['cloneNode'](!![]);_0x56f24d['parentNode'][_0x3dd3ed(0xeaa)](_0x1e2a4f,_0x56f24d),_0x1e2a4f['addEventListener'](_0x3dd3ed(0x1041),_0xa16f03);}else{_0x52f8a8('你已经死亡，无法发言。请等待其他玩家发言结束。'),_0x14c77a(),_0xbff8aa[_0x3dd3ed(0x300)]='继续讨论',_0x56f24d[_0x3dd3ed(0x300)]=_0x3dd3ed(0x218),_0xbff8aa[_0x3dd3ed(0x794)][_0x3dd3ed(0x33d)]='block',_0x56f24d[_0x3dd3ed(0x794)]['display']='block',_0xc3a4ea[_0x3dd3ed(0xe5c)]=!![],_0xc3a4ea[_0x3dd3ed(0x569)]=_0x3dd3ed(0xcae);const _0x16c48b=_0xbff8aa['cloneNode'](!![]);_0xbff8aa[_0x3dd3ed(0x18c)]['replaceChild'](_0x16c48b,_0xbff8aa),_0x16c48b[_0x3dd3ed(0x4b8)](_0x3dd3ed(0x1041),_0x1764cc);const _0x48f627=_0x56f24d[_0x3dd3ed(0x4b4)](!![]);_0x56f24d[_0x3dd3ed(0x18c)][_0x3dd3ed(0xeaa)](_0x48f627,_0x56f24d),_0x48f627['addEventListener'](_0x3dd3ed(0x1041),_0x44ae7f);}}function _0xe2d064(){const _0x2b0dc9=_0x241b18,_0x2a7522=_0x528823[_0x2b0dc9(0xc0d)][_0x2b0dc9(0x138)](_0x2922db=>_0x2922db[_0x2b0dc9(0x4ff)]),_0x2bc7b6=_0x528823[_0x2b0dc9(0xc0d)][_0x2b0dc9(0xe79)](_0x1840e7=>_0x1840e7['id']===_0x2b0dc9(0x21c)),_0x4ff402=_0x2bc7b6?_0x2bc7b6[_0x2b0dc9(0x278)]:'用户',_0x9052c6=_0x2a7522['some'](_0x8c566a=>_0x8c566a['id']===_0x2b0dc9(0x21c));let _0x5d55d4=_0x2b0dc9(0x2ed);_0x2a7522['forEach']((_0x41898a,_0x5b36dd)=>{const _0x5ccf6c=_0x2b0dc9,_0x48f299=_0x528823[_0x5ccf6c(0xc0d)][_0x5ccf6c(0x901)](_0x365ded=>_0x365ded['id']===_0x41898a['id'])+0x1;_0x5d55d4+=_0x5ccf6c(0xea1)+_0x48f299+_0x5ccf6c(0x7b8)+_0x41898a[_0x5ccf6c(0x278)]+'\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20'+_0x41898a[_0x5ccf6c(0x697)]+'\x0a-\x20**身份**:\x20'+(_0x41898a['id']==='user'?_0x5ccf6c(0x544):'【AI角色】')+_0x5ccf6c(0xee0)+_0x41898a['character_persona']+'\x0a';if(_0x41898a[_0x5ccf6c(0xa20)]==='character'){const _0x20b5f4=_0x5de8b7[_0x5ccf6c(0x737)][_0x41898a['id']];if(_0x20b5f4&&_0x20b5f4['longTermMemory']&&_0x20b5f4[_0x5ccf6c(0xe21)][_0x5ccf6c(0x594)]>0x0){const _0x531c0e=_0x20b5f4['longTermMemory'][_0x5ccf6c(0x796)](_0x2674f5=>_0x2674f5['content'])[_0x5ccf6c(0xa4b)](';\x20');_0x5d55d4+=_0x5ccf6c(0x1174)+_0x531c0e+'\x0a';}}});let _0x1a5d29='#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a';const _0x40ba96=_0x528823['gameLog'][_0x2b0dc9(0x138)](_0x4e791f=>_0x4e791f[_0x2b0dc9(0x9a5)]['includes']('死亡了')&&_0x4e791f[_0x2b0dc9(0x9d2)]===_0x528823[_0x2b0dc9(0xedd)]);_0x40ba96[_0x2b0dc9(0x594)]===0x0?_0x1a5d29+=_0x2b0dc9(0xfda):_0x40ba96[_0x2b0dc9(0x494)](_0x232971=>{const _0x4a9fb5=_0x2b0dc9;_0x1a5d29+='-\x20'+_0x232971[_0x4a9fb5(0x9a5)]+'\x0a';});let _0x57ddbd='#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a';if(_0x528823['currentDay']>0x1)for(let _0x426259=0x1;_0x426259<_0x528823[_0x2b0dc9(0xedd)];_0x426259++){_0x57ddbd+=_0x2b0dc9(0x4aa)+_0x426259+_0x2b0dc9(0xb86);const _0x4fc484=_0x528823['gameLog'][_0x2b0dc9(0x138)](_0x4eec46=>_0x4eec46['day']===_0x426259&&(_0x4eec46[_0x2b0dc9(0x9a5)][_0x2b0dc9(0x3ad)]('死亡')||_0x4eec46[_0x2b0dc9(0x9a5)][_0x2b0dc9(0x3ad)]('放逐')));_0x4fc484['length']>0x0?_0x57ddbd+='*事件*:\x20'+_0x4fc484[_0x2b0dc9(0x796)](_0x54e054=>_0x54e054['content'])[_0x2b0dc9(0xa4b)]('\x20')+'\x0a':_0x57ddbd+=_0x2b0dc9(0xfea);const _0x1921e1=_0x528823[_0x2b0dc9(0x65a)][_0x2b0dc9(0x138)](_0xaea412=>_0xaea412['day']===_0x426259);_0x1921e1[_0x2b0dc9(0x594)]>0x0&&(_0x57ddbd+='*讨论记录*:\x0a'+_0x1921e1[_0x2b0dc9(0x796)](_0x3daf1e=>'-\x20'+_0x3daf1e[_0x2b0dc9(0x387)]+':\x20'+_0x3daf1e[_0x2b0dc9(0x9a5)])[_0x2b0dc9(0xa4b)]('\x0a')+'\x0a');}else _0x57ddbd+=_0x2b0dc9(0x210);let _0x50c283=_0x2b0dc9(0xd98);_0x2a7522[_0x2b0dc9(0x494)](_0x3d05b5=>{const _0x42c2c7=_0x2b0dc9;if(_0x3d05b5['id']!=='user'){_0x50c283+=_0x42c2c7(0xed6)+_0x3d05b5['name']+_0x42c2c7(0x1230)+_0x3d05b5[_0x42c2c7(0xba4)]+'】\x0a';if(_0x3d05b5['role']==='狼人'){const _0x197343=_0x528823[_0x42c2c7(0xc0d)][_0x42c2c7(0x138)](_0x274f39=>_0x274f39[_0x42c2c7(0xba4)]==='狼人'&&_0x274f39['id']!==_0x3d05b5['id'])[_0x42c2c7(0x796)](_0xb808a=>_0xb808a[_0x42c2c7(0x278)])[_0x42c2c7(0xa4b)]('、');_0x50c283+=_0x42c2c7(0x95e)+(_0x197343||'无')+'\x0a';const _0x488762=_0x528823[_0x42c2c7(0xc0d)][_0x42c2c7(0xe79)](_0x2bac24=>_0x2bac24['id']===_0x528823[_0x42c2c7(0x8c8)]['killedId']);_0x50c283+=_0x42c2c7(0xaf1)+(_0x488762?_0x488762[_0x42c2c7(0x278)]:'空刀')+'\x0a';}if(_0x3d05b5['role']===_0x42c2c7(0x941)&&_0x528823[_0x42c2c7(0x8c8)][_0x42c2c7(0xf91)]){const _0xf62a32=_0x528823[_0x42c2c7(0xc0d)][_0x42c2c7(0xe79)](_0x5c9ab1=>_0x5c9ab1['id']===_0x528823[_0x42c2c7(0x8c8)]['prophetCheck'][_0x42c2c7(0xd7c)]);_0x50c283+=_0x42c2c7(0x2e8)+_0xf62a32[_0x42c2c7(0x278)]+_0x42c2c7(0x173)+_0x528823[_0x42c2c7(0x8c8)][_0x42c2c7(0xf91)][_0x42c2c7(0x255)]+'】\x0a';}if(_0x3d05b5[_0x42c2c7(0xba4)]==='女巫'){if(_0x528823[_0x42c2c7(0x8c8)][_0x42c2c7(0x386)]){const _0x343b51=_0x528823[_0x42c2c7(0xc0d)][_0x42c2c7(0xe79)](_0x346466=>_0x346466['id']===_0x528823[_0x42c2c7(0x8c8)][_0x42c2c7(0x386)]);_0x50c283+=_0x42c2c7(0x266)+_0x343b51['name']+'。\x0a';}if(_0x528823[_0x42c2c7(0x8c8)]['poisonedId']){const _0x4c7c7a=_0x528823[_0x42c2c7(0xc0d)]['find'](_0x2bd1cf=>_0x2bd1cf['id']===_0x528823[_0x42c2c7(0x8c8)][_0x42c2c7(0xa0b)]);_0x50c283+=_0x42c2c7(0xb13)+_0x4c7c7a[_0x42c2c7(0x278)]+'。\x0a';}_0x50c283+='-\x20你的解药状态：'+(_0x3d05b5[_0x42c2c7(0x9b7)]?_0x42c2c7(0x1fd):_0x42c2c7(0xd39))+'\x0a',_0x50c283+=_0x42c2c7(0x32a)+(_0x3d05b5['poisonUsed']?_0x42c2c7(0x1fd):_0x42c2c7(0xd39))+'\x0a';}if(_0x3d05b5['role']==='守卫'){if(_0x528823[_0x42c2c7(0x8c8)][_0x42c2c7(0x557)]){const _0x4ac7ca=_0x528823['players'][_0x42c2c7(0xe79)](_0x100dc3=>_0x100dc3['id']===_0x528823[_0x42c2c7(0x8c8)]['guardedId']);_0x50c283+=_0x42c2c7(0x9f0)+_0x4ac7ca[_0x42c2c7(0x278)]+'。\x0a';}else _0x50c283+='-\x20你昨晚空守了。\x0a';}_0x50c283+='\x0a';}});let _0x574424=_0x2b0dc9(0x744);const _0x353eff=_0x528823['discussionLog'][_0x2b0dc9(0x138)](_0x22c295=>_0x22c295[_0x2b0dc9(0x9d2)]===_0x528823[_0x2b0dc9(0xedd)]);_0x353eff[_0x2b0dc9(0x594)]>0x0?_0x574424+=_0x353eff[_0x2b0dc9(0x796)](_0x3d5dd1=>_0x2b0dc9(0x11c)+_0x3d5dd1[_0x2b0dc9(0x387)]+'**:\x20'+_0x3d5dd1[_0x2b0dc9(0x9a5)])[_0x2b0dc9(0xa4b)]('\x0a'):_0x574424+=_0x2b0dc9(0xc9b);const _0x181011=_0x2b0dc9(0x10bd)+(_0x9052c6?'用户('+_0x4ff402+')':'已死亡的用户('+_0x4ff402+')')+_0x2b0dc9(0x44e)+_0x5d55d4+_0x2b0dc9(0x522)+(_0x528823[_0x2b0dc9(0xba1)]==='12p'?_0x2b0dc9(0xaab):_0x2b0dc9(0xbde))+_0x2b0dc9(0xfa3)+_0x528823[_0x2b0dc9(0xedd)]+_0x2b0dc9(0x966)+_0x1a5d29+_0x2b0dc9(0xf0b)+_0x2a7522[_0x2b0dc9(0x796)](_0x4db4b3=>_0x4db4b3[_0x2b0dc9(0x278)]+'\x20('+(_0x4db4b3['id']===_0x2b0dc9(0x21c)?'用户':'AI')+')')['join'](',\x20')+'\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20\x20\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20\x20\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20\x20\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20\x20\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20'+_0x4ff402+_0x2b0dc9(0xf29)+_0x57ddbd+_0x2b0dc9(0xe5f)+_0x574424+'\x0a\x0a'+_0x50c283+_0x2b0dc9(0x47c);return _0x181011;}function _0x473ff8(_0x36199c){const _0x9a4680=_0x241b18;let _0x43830a=_0x9a4680(0x12d0);const _0x40ec5f=_0x36199c[_0x9a4680(0xe23)]['find'](_0x3c0518=>_0x3c0518['content'][_0x9a4680(0x3ad)]('胜利'))?.['content']||_0x9a4680(0xee8);_0x43830a+=_0x9a4680(0xe09)+_0x40ec5f+'\x0a\x0a',_0x43830a+=_0x9a4680(0xe0b),_0x36199c[_0x9a4680(0xc0d)][_0x9a4680(0x494)](_0x4f4466=>{const _0x38dfec=_0x9a4680,_0x450f45=_0x4f4466['isAlive']?'存活':_0x38dfec(0x13a);_0x43830a+='-\x20'+_0x4f4466['name']+':\x20'+_0x4f4466[_0x38dfec(0xba4)]+'\x20('+_0x450f45+')\x0a';}),_0x43830a+=_0x9a4680(0xc98);for(let _0x3521f1=0x1;_0x3521f1<=_0x36199c[_0x9a4680(0xedd)];_0x3521f1++){_0x43830a+=_0x9a4680(0x4aa)+_0x3521f1+_0x9a4680(0xb86);const _0x27c228=_0x36199c[_0x9a4680(0xe23)][_0x9a4680(0x138)](_0x396cc4=>_0x396cc4['day']===_0x3521f1&&_0x396cc4['content'][_0x9a4680(0x3ad)]('死亡'));if(_0x27c228['length']>0x0)_0x43830a+='**[夜晚]**\x20'+_0x27c228[_0x9a4680(0x796)](_0xd82eaf=>_0xd82eaf[_0x9a4680(0x9a5)])[_0x9a4680(0xa4b)]('\x20')+'\x0a';else(_0x3521f1>0x1||_0x3521f1===0x1&&_0x36199c['currentDay']>0x1)&&(_0x43830a+=_0x9a4680(0xdb1));const _0xb836d6=_0x36199c[_0x9a4680(0x65a)][_0x9a4680(0x138)](_0x4bb77e=>_0x4bb77e[_0x9a4680(0x9d2)]===_0x3521f1);_0xb836d6[_0x9a4680(0x594)]>0x0&&(_0x43830a+=_0x9a4680(0xe87)+_0xb836d6['map'](_0x34b99e=>'-\x20'+_0x34b99e[_0x9a4680(0x387)]+':\x20'+_0x34b99e[_0x9a4680(0x9a5)])['join']('\x0a')+'\x0a');const _0x5e9aa5=_0x36199c[_0x9a4680(0xe23)][_0x9a4680(0xe79)](_0x4435f8=>_0x4435f8[_0x9a4680(0x9d2)]===_0x3521f1&&_0x4435f8[_0x9a4680(0x9a5)][_0x9a4680(0x3ad)]('被投票放逐'));_0x5e9aa5&&(_0x43830a+='**[投票结果]**\x20'+_0x5e9aa5['content']+'\x0a');}return _0x43830a+=_0x9a4680(0xabe),_0x43830a;}async function _0x5e5548(_0x37729c){const _0x2dd4d1=_0x241b18;let _0x6d9f97=0x0;for(const _0x3542b5 of _0x528823[_0x2dd4d1(0xc0d)]){if(_0x3542b5[_0x2dd4d1(0xa20)]==='character'){const _0xd0c66d=_0x5de8b7[_0x2dd4d1(0x737)][_0x3542b5['id']];if(_0xd0c66d){const _0x1dcb5a={'content':_0x37729c,'timestamp':Date[_0x2dd4d1(0x1182)](),'source':_0x2dd4d1(0x723)};!_0xd0c66d[_0x2dd4d1(0xe21)]&&(_0xd0c66d[_0x2dd4d1(0xe21)]=[]),_0xd0c66d[_0x2dd4d1(0xe21)][_0x2dd4d1(0xf5)](_0x1dcb5a),await _0x2e83f8[_0x2dd4d1(0x737)]['put'](_0xd0c66d),_0x6d9f97++;}}}return _0x6d9f97;}async function _0x43282f(){const _0x355c61=_0x241b18;if(!_0x528823[_0x355c61(0x3d5)]&&_0x528823[_0x355c61(0x4f4)]===_0x355c61(0xbcb)){await _0x2fb06(_0x355c61(0x63d),_0x355c61(0x649));try{const _0x54d947=_0x473ff8(_0x528823),_0x316839=await _0x5e5548(_0x54d947);await _0x2fb06('成功',_0x355c61(0xea8)+_0x316839+_0x355c61(0x18f));}catch(_0x516c84){console['error'](_0x355c61(0x8c2),_0x516c84),await _0x2fb06('失败',_0x355c61(0x850)+_0x516c84['message']);}}else alert(_0x355c61(0x1072));}async function _0x34e1fa(_0x249ff0){const _0x3f73cb=_0x241b18;_0x528823[_0x3f73cb(0x3d5)]=![],_0x528823[_0x3f73cb(0x4f4)]=_0x3f73cb(0xbcb),_0x52f8a8(_0x249ff0+_0x3f73cb(0x906)),document[_0x3f73cb(0x11e3)]('werewolf-game-over-title')[_0x3f73cb(0x300)]=_0x249ff0+_0x3f73cb(0x1094);let _0x3a4867='';_0x249ff0==='好人'?_0x3a4867=_0x3f73cb(0x10ec):_0x3a4867=_0x3f73cb(0x146);const _0x353ff0=document[_0x3f73cb(0x11e3)](_0x3f73cb(0x822));_0x353ff0[_0x3f73cb(0x300)]=_0x3a4867;const _0x47c64d=document[_0x3f73cb(0x11e3)](_0x3f73cb(0x8cd));_0x47c64d[_0x3f73cb(0x595)]='';const _0x559514=[..._0x528823[_0x3f73cb(0xc0d)]][_0x3f73cb(0x861)]((_0xf57af9,_0x4d121f)=>{const _0x256029=_0x3f73cb,_0x1c5de5=_0x528823[_0x256029(0xc0d)][_0x256029(0x901)](_0x5cb952=>_0x5cb952['id']===_0xf57af9['id']),_0x36220f=_0x528823[_0x256029(0xc0d)][_0x256029(0x901)](_0x11561d=>_0x11561d['id']===_0x4d121f['id']);return _0x1c5de5-_0x36220f;});_0x559514[_0x3f73cb(0x494)]((_0x526edc,_0x66ccf9)=>{const _0x6b3079=_0x3f73cb,_0x4bf30a=document[_0x6b3079(0x383)](_0x6b3079(0x1285));_0x4bf30a[_0x6b3079(0x794)]['cssText']=_0x6b3079(0x390);if(_0x66ccf9===_0x559514[_0x6b3079(0x594)]-0x1)_0x4bf30a[_0x6b3079(0x794)][_0x6b3079(0x12df)]=_0x6b3079(0x379);const _0x46a62a=_0x526edc['role']==='狼人'?'#ff4d4d':_0x6b3079(0x984);_0x4bf30a[_0x6b3079(0x595)]=_0x6b3079(0xee5)+_0x526edc[_0x6b3079(0x525)]+_0x6b3079(0x8be)+(_0x526edc[_0x6b3079(0x4ff)]?_0x6b3079(0x379):_0x6b3079(0xf08))+';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20'+(_0x526edc[_0x6b3079(0x4ff)]?_0x6b3079(0x379):'line-through')+_0x6b3079(0x3c6)+(_0x66ccf9+0x1)+'.\x20'+_0x526edc[_0x6b3079(0x278)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20'+_0x46a62a+_0x6b3079(0x3c6)+_0x526edc[_0x6b3079(0xba4)]+_0x6b3079(0x2e7),_0x47c64d[_0x6b3079(0x120c)](_0x4bf30a);}),document[_0x3f73cb(0x11e3)](_0x3f73cb(0x90a))[_0x3f73cb(0x505)][_0x3f73cb(0x252)](_0x3f73cb(0x250));try{console[_0x3f73cb(0x84b)]('游戏结束，开始自动总结并注入记忆...');const _0x461adb=_0x473ff8(_0x528823),_0x353204=await generateAndInjectWerewolfMemories(_0x461adb);console[_0x3f73cb(0x84b)]('狼人杀游戏总结已自动存入\x20'+_0x353204+_0x3f73cb(0xa5c));}catch(_0x160b2a){console[_0x3f73cb(0x1c1)](_0x3f73cb(0x129f),_0x160b2a),_0x353ff0&&(_0x353ff0[_0x3f73cb(0x595)]+=_0x3f73cb(0x7ae));}}function _0x52f8a8(_0x213b86){const _0x5d7f23=_0x241b18;_0x528823['gameLog'][_0x5d7f23(0xf5)]({'type':_0x5d7f23(0xf72),'content':_0x213b86,'timestamp':Date[_0x5d7f23(0x1182)](),'day':_0x528823[_0x5d7f23(0xedd)]});}function _0x5a5efe(_0x36f252,_0x29f678){const _0x592cd3=_0x241b18;_0x528823[_0x592cd3(0x65a)][_0x592cd3(0xf5)]({'type':_0x592cd3(0x159),'speaker':_0x36f252,'content':_0x29f678,'timestamp':Date[_0x592cd3(0x1182)](),'day':_0x528823[_0x592cd3(0xedd)]});}function _0x111039(_0x589b19){return new Promise(_0x25a4b2=>{const _0x1fcaf1=_0x10a9,_0x47d78b='werewolf-'+_0x589b19+_0x1fcaf1(0x753),_0x43574c=_0x1fcaf1(0x128c)+_0x589b19+_0x1fcaf1(0x1260);let _0x27e674='';if(_0x589b19===_0x1fcaf1(0x1278))_0x27e674=_0x1fcaf1(0xb4d);if(_0x589b19===_0x1fcaf1(0x9ab))_0x27e674=_0x1fcaf1(0xad9);if(_0x589b19===_0x1fcaf1(0x10b9))_0x27e674=_0x1fcaf1(0x43c);const _0x492bd4=document[_0x1fcaf1(0x11e3)](_0x47d78b),_0x20cc7c=document['getElementById'](_0x43574c),_0x5a515c=document[_0x1fcaf1(0x11e3)](_0x27e674);_0x20cc7c[_0x1fcaf1(0x595)]='';let _0x3bd050=null;const _0x576972=_0x528823['players'][_0x1fcaf1(0x138)](_0x4f7617=>_0x4f7617[_0x1fcaf1(0x4ff)]&&(_0x589b19==='hunter'||_0x589b19==='vote'||_0x4f7617['id']!==_0x1fcaf1(0x21c)));_0x576972[_0x1fcaf1(0x494)](_0xb5cc88=>{const _0x52c817=_0x1fcaf1,_0x4e30b2=document[_0x52c817(0x383)](_0x52c817(0x1285));_0x4e30b2['className']=_0x52c817(0xf4c),_0x4e30b2[_0x52c817(0xaca)]['id']=_0xb5cc88['id'],_0x4e30b2[_0x52c817(0x595)]=_0x52c817(0x13b)+_0xb5cc88[_0x52c817(0x525)]+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0xb5cc88[_0x52c817(0x278)]+'</span>',_0x4e30b2[_0x52c817(0x1074)]=()=>{const _0xace277=_0x52c817;_0x20cc7c['querySelectorAll'](_0xace277(0x9af))[_0xace277(0x494)](_0x4b6e63=>_0x4b6e63[_0xace277(0x505)][_0xace277(0x957)](_0xace277(0xbbc))),_0x4e30b2['classList'][_0xace277(0x252)](_0xace277(0xbbc)),_0x3bd050=_0xb5cc88['id'];},_0x20cc7c[_0x52c817(0x120c)](_0x4e30b2);});const _0x444ef8=_0x5a515c[_0x1fcaf1(0x4b4)](!![]);_0x5a515c[_0x1fcaf1(0x18c)][_0x1fcaf1(0xeaa)](_0x444ef8,_0x5a515c),_0x444ef8['onclick']=()=>{const _0x14533f=_0x1fcaf1;_0x3bd050?(_0x492bd4[_0x14533f(0x505)][_0x14533f(0x957)]('visible'),_0x25a4b2(_0x3bd050)):alert(_0x14533f(0xa7e));},_0x492bd4[_0x1fcaf1(0x505)]['add'](_0x1fcaf1(0x250));});}function _0x5bc488(){return new Promise(_0x17f973=>{const _0xc6a31=_0x10a9,_0x3ebd63=document['getElementById'](_0xc6a31(0x1227)),_0x221719=document[_0xc6a31(0x11e3)](_0xc6a31(0x4ba)),_0x2cf5a9=document[_0xc6a31(0x11e3)](_0xc6a31(0x100b)),_0x1b2798=_0x3ebd63[_0xc6a31(0x5ac)]('.modal-header\x20span'),_0x3fe2d9=_0x528823[_0xc6a31(0xc0d)][_0xc6a31(0x138)](_0x1c9655=>_0x1c9655[_0xc6a31(0xba4)]==='狼人'&&_0x1c9655['isAlive']),_0x59b895=_0x3fe2d9[_0xc6a31(0x138)](_0x4efe12=>_0x4efe12['id']!==_0xc6a31(0x21c))[_0xc6a31(0x796)](_0x41db04=>_0x41db04['name'])[_0xc6a31(0xa4b)]('、');_0x59b895?_0x1b2798['innerHTML']=_0xc6a31(0x94d)+_0x59b895+_0xc6a31(0xd2c):_0x1b2798['textContent']='狼人请选择刀人对象';_0x221719[_0xc6a31(0x595)]='';let _0x5c554e=null;const _0x26d515=_0x528823[_0xc6a31(0xc0d)][_0xc6a31(0x138)](_0x2a7fde=>_0x2a7fde['isAlive']&&_0x2a7fde[_0xc6a31(0xba4)]!=='狼人');_0x26d515[_0xc6a31(0x494)](_0x3f48b6=>{const _0x163e36=_0xc6a31,_0xd00889=document[_0x163e36(0x383)](_0x163e36(0x1285));_0xd00889[_0x163e36(0x3db)]=_0x163e36(0xf4c),_0xd00889['dataset']['id']=_0x3f48b6['id'],_0xd00889[_0x163e36(0x595)]=_0x163e36(0x13b)+_0x3f48b6[_0x163e36(0x525)]+_0x163e36(0x208)+_0x3f48b6[_0x163e36(0x278)]+_0x163e36(0x4a3),_0xd00889[_0x163e36(0x1074)]=()=>{const _0x46253b=_0x163e36;_0x221719[_0x46253b(0x10d6)]('.selected')[_0x46253b(0x494)](_0x28c482=>_0x28c482['classList']['remove']('selected')),_0xd00889['classList']['add'](_0x46253b(0xbbc)),_0x5c554e=_0x3f48b6['id'];},_0x221719['appendChild'](_0xd00889);});const _0x529388=_0x2cf5a9[_0xc6a31(0x4b4)](!![]);_0x2cf5a9[_0xc6a31(0x18c)][_0xc6a31(0xeaa)](_0x529388,_0x2cf5a9),_0x529388[_0xc6a31(0x1074)]=()=>{const _0x27a376=_0xc6a31;_0x5c554e?(_0x3ebd63['classList'][_0x27a376(0x957)](_0x27a376(0x250)),_0x17f973(_0x5c554e)):alert('请选择一个目标。');},_0x3ebd63[_0xc6a31(0x505)][_0xc6a31(0x252)](_0xc6a31(0x250));});}function _0xa16f03(){const _0x2477c6=_0x241b18,_0x3137a9=_0x528823[_0x2477c6(0xc0d)][_0x2477c6(0xe79)](_0x108195=>_0x108195['id']===_0x2477c6(0x21c));if(!_0x3137a9||!_0x3137a9[_0x2477c6(0x4ff)])return;const _0x4bb13f=document[_0x2477c6(0x11e3)]('werewolf-user-input'),_0x100630=_0x4bb13f[_0x2477c6(0xf27)]['trim']();_0x100630&&(_0x5a5efe(_0x3137a9[_0x2477c6(0x278)],_0x100630),_0x14c77a()),document[_0x2477c6(0x11e3)](_0x2477c6(0x100d))[_0x2477c6(0x794)]['display']=_0x2477c6(0x379),_0x4bb13f[_0x2477c6(0xf27)]='',_0x44ae7f();}async function _0x1764cc(){const _0x25cfea=_0x241b18;_0x52f8a8(_0x25cfea(0xd20)),_0x14c77a();const _0x13eb5e=document[_0x25cfea(0x11e3)](_0x25cfea(0x288));if(_0x13eb5e)_0x13eb5e[_0x25cfea(0xe5c)]=!![];await _0x2fb06(_0x25cfea(0xc1e),_0x25cfea(0x1da));const {proxyUrl:_0x461982,apiKey:_0x41a1fb,model:_0x399f4f}=_0x5de8b7[_0x25cfea(0x89c)];if(!_0x461982||!_0x41a1fb||!_0x399f4f){alert(_0x25cfea(0x7f3));return;}const _0x3e5dfc=_0xe2d064();try{let _0x5b99c1=_0x461982[_0x25cfea(0x3ad)](_0x25cfea(0xb9b)),_0xc30198=[{'role':_0x25cfea(0x21c),'content':_0x25cfea(0x6da)}],_0x2b352c=_0x4a90fe(_0x399f4f,_0x41a1fb,_0x3e5dfc,_0xc30198);const _0x46994e=_0x5b99c1?await fetch(_0x2b352c[_0x25cfea(0x10ac)],_0x2b352c[_0x25cfea(0x1cc)]):await fetch(_0x461982+_0x25cfea(0x8fd),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x41a1fb},'body':JSON[_0x25cfea(0x313)]({'model':_0x399f4f,'messages':[{'role':_0x25cfea(0xf72),'content':_0x3e5dfc},..._0xc30198],'temperature':_0x5de8b7[_0x25cfea(0x2df)][_0x25cfea(0xe66)]||0.9})});if(!_0x46994e['ok']){const _0x8c5e24=await _0x46994e[_0x25cfea(0xd7b)]();throw new Error(_0x25cfea(0x307)+_0x8c5e24[_0x25cfea(0x1c1)][_0x25cfea(0x4bc)]);}const _0x2f43c3=await _0x46994e[_0x25cfea(0xd7b)](),_0x209c96=getGeminiResponseText(_0x2f43c3),_0x5d9858=_0x209c96[_0x25cfea(0xe9f)](/(\[[\s\S]*\])/);if(!_0x5d9858)throw new Error(_0x25cfea(0x851)+_0x209c96);const _0x58e8ee=JSON['parse'](_0x5d9858[0x0]);for(const _0x176e2f of _0x58e8ee){_0x176e2f[_0x25cfea(0x77e)]&&_0x176e2f['dialogue']&&(_0x5a5efe(_0x176e2f[_0x25cfea(0x77e)],_0x176e2f[_0x25cfea(0x159)]),_0x14c77a(),await new Promise(_0x3adce5=>setTimeout(_0x3adce5,0x5dc+Math[_0x25cfea(0x36d)]()*0x7d0)));}}catch(_0xa826eb){console[_0x25cfea(0x1c1)](_0x25cfea(0xcb),_0xa826eb),await _0x2fb06('AI\x20发言失败',_0x25cfea(0xed2)+_0xa826eb[_0x25cfea(0x4bc)]);}finally{if(_0x13eb5e)_0x13eb5e['disabled']=![];}}async function _0x3aa5af(){const _0x5277c7=_0x241b18,_0x4f4563=_0x528823[_0x5277c7(0xc0d)][_0x5277c7(0xe79)](_0x136206=>_0x136206['id']===_0x5277c7(0x21c));if(!_0x4f4563||!_0x4f4563[_0x5277c7(0x4ff)]){console[_0x5277c7(0x6b0)]('handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。');return;}const _0x443d00=document[_0x5277c7(0x11e3)]('werewolf-user-input'),_0x2562dc=_0x443d00['value'][_0x5277c7(0xeb7)]();if(!_0x2562dc){alert(_0x5277c7(0x10be));return;}_0x5a5efe(_0x4f4563[_0x5277c7(0x278)],_0x2562dc),_0x14c77a(),_0x443d00['value']='',await _0x2fb06(_0x5277c7(0xc1e),_0x5277c7(0xa4));const {proxyUrl:_0x2e38c5,apiKey:_0x1c1b67,model:_0x3a7cba}=_0x5de8b7[_0x5277c7(0x89c)];if(!_0x2e38c5||!_0x1c1b67||!_0x3a7cba){alert(_0x5277c7(0x7f3));return;}const _0x52871b=_0xe2d064();try{let _0x1474ed=_0x2e38c5['includes']('generativelanguage'),_0x4f1896=[{'role':_0x5277c7(0x21c),'content':_0x5277c7(0x9b9)+_0x4f4563[_0x5277c7(0x278)]+'\x27的发言）继续进行讨论。'}],_0x309b57=_0x4a90fe(_0x3a7cba,_0x1c1b67,_0x52871b,_0x4f1896);const _0x2be1dd=_0x1474ed?await fetch(_0x309b57[_0x5277c7(0x10ac)],_0x309b57[_0x5277c7(0x1cc)]):await fetch(_0x2e38c5+_0x5277c7(0x8fd),{'method':_0x5277c7(0x1128),'headers':{'Content-Type':_0x5277c7(0x35c),'Authorization':'Bearer\x20'+_0x1c1b67},'body':JSON[_0x5277c7(0x313)]({'model':_0x3a7cba,'messages':[{'role':'system','content':_0x52871b},..._0x4f1896],'temperature':_0x5de8b7[_0x5277c7(0x2df)][_0x5277c7(0xe66)]||0.9})});if(!_0x2be1dd['ok']){const _0x131c9b=await _0x2be1dd[_0x5277c7(0xd7b)]();throw new Error(_0x5277c7(0x307)+_0x131c9b[_0x5277c7(0x1c1)][_0x5277c7(0x4bc)]);}const _0x4659de=await _0x2be1dd[_0x5277c7(0xd7b)](),_0x6fe201=getGeminiResponseText(_0x4659de),_0x4c4691=_0x6fe201['match'](/(\[[\s\S]*\])/);if(!_0x4c4691)throw new Error(_0x5277c7(0x851)+_0x6fe201);const _0x263810=JSON[_0x5277c7(0xb0c)](_0x4c4691[0x0]);for(const _0x33f7cb of _0x263810){_0x33f7cb[_0x5277c7(0x77e)]&&_0x33f7cb[_0x5277c7(0x159)]&&(_0x5a5efe(_0x33f7cb[_0x5277c7(0x77e)],_0x33f7cb[_0x5277c7(0x159)]),_0x14c77a(),await new Promise(_0x58e99a=>setTimeout(_0x58e99a,0x5dc+Math[_0x5277c7(0x36d)]()*0x7d0)));}}catch(_0xc4cd5b){console[_0x5277c7(0x1c1)](_0x5277c7(0xcb),_0xc4cd5b),await _0x2fb06(_0x5277c7(0x11c1),_0x5277c7(0xed2)+_0xc4cd5b[_0x5277c7(0x4bc)]);}}async function _0x44ae7f(){const _0x3344f7=_0x241b18;_0x52f8a8(_0x3344f7(0x631)),_0x14c77a(),_0x528823[_0x3344f7(0x510)]={};let _0x54dd6a=null;_0x528823[_0x3344f7(0xa9c)]=_0x3344f7(0xc3b);try{_0x54dd6a=await _0x57d5c1(),_0x54dd6a&&_0x54dd6a['forEach'](_0x204dff=>{const _0x41c6c0=_0x3344f7,_0x1f5dbf=_0x528823[_0x41c6c0(0xc0d)][_0x41c6c0(0xe79)](_0x509fe0=>_0x509fe0[_0x41c6c0(0x278)]===_0x204dff[_0x41c6c0(0x1120)]),_0x3048ce=_0x528823[_0x41c6c0(0xc0d)]['find'](_0x50a055=>_0x50a055[_0x41c6c0(0x278)]===_0x204dff[_0x41c6c0(0x353)]);_0x1f5dbf&&_0x1f5dbf[_0x41c6c0(0x4ff)]&&_0x3048ce&&(_0x528823[_0x41c6c0(0x510)][_0x1f5dbf[_0x41c6c0(0x278)]]=_0x3048ce[_0x41c6c0(0x278)]);}),_0x528823[_0x3344f7(0xa9c)]=null;}catch(_0x2f4b3a){console[_0x3344f7(0x1c1)](_0x3344f7(0x1e0),_0x2f4b3a),await _0x2fb06(_0x3344f7(0x1177),_0x3344f7(0x103a)+_0x2f4b3a[_0x3344f7(0x4bc)]),document[_0x3344f7(0x11e3)]('werewolf-retry-btn')['style'][_0x3344f7(0x33d)]='block';return;}const _0x8b9bb3=_0x528823[_0x3344f7(0xc0d)][_0x3344f7(0xe79)](_0x50d7d1=>_0x50d7d1['id']===_0x3344f7(0x21c));if(_0x8b9bb3&&_0x8b9bb3['isAlive']){_0x52f8a8(_0x3344f7(0x29d)),_0x14c77a();const _0x22fb66=await _0x111039(_0x3344f7(0x10b9)),_0x271a17=_0x528823[_0x3344f7(0xc0d)][_0x3344f7(0xe79)](_0x223224=>_0x223224['id']===_0x22fb66);_0x271a17&&(_0x528823[_0x3344f7(0x510)][_0x8b9bb3[_0x3344f7(0x278)]]=_0x271a17[_0x3344f7(0x278)]);}_0x1f0214();}async function _0x57d5c1(){const _0x3f7205=_0x241b18,{proxyUrl:_0xd2f510,apiKey:_0x37279f,model:_0x57bba9}=_0x5de8b7[_0x3f7205(0x89c)];if(!_0xd2f510||!_0x37279f||!_0x57bba9)return null;const _0xe33253=_0x528823['players'][_0x3f7205(0x138)](_0x195983=>_0x195983[_0x3f7205(0x4ff)]&&_0x195983['id']!==_0x3f7205(0x21c)),_0xe6d050=_0x528823['players'][_0x3f7205(0x138)](_0x597c71=>_0x597c71[_0x3f7205(0x4ff)])[_0x3f7205(0x796)](_0x4c4c04=>_0x4c4c04[_0x3f7205(0x278)]);let _0x57430f=_0xe2d064();_0x57430f+=_0x3f7205(0x11f2)+_0xe6d050[_0x3f7205(0xa4b)](',\x20')+_0x3f7205(0x34b);try{let _0x1a9c4a=_0xd2f510[_0x3f7205(0x3ad)]('generativelanguage'),_0xf84209=[{'role':_0x3f7205(0x21c),'content':_0x3f7205(0x325)}],_0x70275a=_0x4a90fe(_0x57bba9,_0x37279f,_0x57430f,_0xf84209);const _0x4183d1=_0x1a9c4a?await fetch(_0x70275a[_0x3f7205(0x10ac)],_0x70275a[_0x3f7205(0x1cc)]):await fetch(_0xd2f510+'/v1/chat/completions',{'method':_0x3f7205(0x1128),'headers':{'Content-Type':_0x3f7205(0x35c),'Authorization':_0x3f7205(0xdaf)+_0x37279f},'body':JSON['stringify']({'model':_0x57bba9,'messages':[{'role':_0x3f7205(0xf72),'content':_0x57430f},..._0xf84209],'temperature':_0x5de8b7[_0x3f7205(0x2df)][_0x3f7205(0xe66)]||0.8})});if(!_0x4183d1['ok'])throw new Error((await _0x4183d1['json']())['error']['message']);const _0x54f71f=await _0x4183d1[_0x3f7205(0xd7b)](),_0x2ad382=getGeminiResponseText(_0x54f71f);let _0x57c262=_0x2ad382[_0x3f7205(0x1018)](/^```json\s*/,'')[_0x3f7205(0x1018)](/```$/,'')[_0x3f7205(0xeb7)]();const _0x2f6b99=_0x57c262[_0x3f7205(0xce1)]('['),_0x2fa286=_0x57c262[_0x3f7205(0xea9)](']');if(_0x2f6b99===-0x1||_0x2fa286===-0x1||_0x2fa286<_0x2f6b99)throw new Error('AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。');const _0x3f6ec4=_0x57c262[_0x3f7205(0x8d4)](_0x2f6b99,_0x2fa286+0x1);try{const _0x29fda5=_0x3f6ec4[_0x3f7205(0xe9f)](/(\[[\s\S]*?\])/g);if(_0x29fda5&&_0x29fda5[_0x3f7205(0x594)]>0x0)return JSON[_0x3f7205(0xb0c)](_0x29fda5[_0x29fda5['length']-0x1]);return JSON[_0x3f7205(0xb0c)](_0x3f6ec4);}catch(_0x3a5e88){throw new Error('解析AI返回的投票JSON时出错:\x20'+_0x3a5e88['message']+_0x3f7205(0x779)+_0x2ad382);}}catch(_0x1b74aa){console['error'](_0x3f7205(0x41c),_0x1b74aa);throw new Error(_0x3f7205(0x10d4)+_0x1b74aa[_0x3f7205(0x4bc)]);}}function _0x1f0214(){const _0x46ae9f=_0x241b18,_0x22526c={},_0xf803f={};for(const _0x4d79cc in _0x528823[_0x46ae9f(0x510)]){const _0x2c307a=_0x528823[_0x46ae9f(0x510)][_0x4d79cc];_0x22526c[_0x2c307a]=(_0x22526c[_0x2c307a]||0x0)+0x1,!_0xf803f[_0x2c307a]&&(_0xf803f[_0x2c307a]=[]),_0xf803f[_0x2c307a][_0x46ae9f(0xf5)](_0x4d79cc);}let _0x47f9ee=0x0,_0x1fb66d=[];for(const _0x2afa38 in _0x22526c){const _0x2999e0=_0x22526c[_0x2afa38];if(_0x2999e0>_0x47f9ee)_0x47f9ee=_0x2999e0,_0x1fb66d=[_0x2afa38];else _0x2999e0===_0x47f9ee&&_0x1fb66d[_0x46ae9f(0xf5)](_0x2afa38);}_0x52f8a8('投票结果：');for(const _0x448cb2 in _0xf803f){_0x52f8a8(_0x448cb2+'\x20('+_0xf803f[_0x448cb2]['length']+_0x46ae9f(0xd43)+_0xf803f[_0x448cb2][_0x46ae9f(0xa4b)]('、\x20'));}if(_0x1fb66d[_0x46ae9f(0x594)]===0x1&&_0x47f9ee>0x0){const _0x5811b2=_0x528823[_0x46ae9f(0xc0d)][_0x46ae9f(0xe79)](_0x292a2a=>_0x292a2a[_0x46ae9f(0x278)]===_0x1fb66d[0x0]);if(_0x5811b2){_0x5811b2[_0x46ae9f(0x4ff)]=![],_0x52f8a8(_0x5811b2[_0x46ae9f(0x278)]+_0x46ae9f(0x5b9));if(_0x5811b2[_0x46ae9f(0xba4)]==='猎人'){}}}else _0x52f8a8(_0x46ae9f(0x932));_0x14c77a();if(_0x3dfee())return;_0x528823[_0x46ae9f(0xedd)]++,_0x174fe7();}async function _0x36a502(){const _0x547e22=_0x241b18,{proxyUrl:_0x1cbeec,apiKey:_0x3eb30f,model:_0x540600}=_0x5de8b7[_0x547e22(0x89c)];if(!_0x1cbeec||!_0x3eb30f||!_0x540600)return null;const _0x2c8fb0=_0x528823[_0x547e22(0xc0d)][_0x547e22(0x138)](_0x477363=>_0x477363[_0x547e22(0xba4)]==='狼人'&&_0x477363['isAlive']),_0x3b9b9f=_0x528823[_0x547e22(0xc0d)][_0x547e22(0x138)](_0x2490f0=>_0x2490f0[_0x547e22(0x4ff)]&&_0x2490f0[_0x547e22(0xba4)]!=='狼人'),_0x9529eb='\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20'+_0x2c8fb0[_0x547e22(0x796)](_0x4f4f74=>_0x4f4f74['name'])[_0x547e22(0xa4b)]('、\x20')+_0x547e22(0xa2f)+_0x3b9b9f[_0x547e22(0x796)](_0x3ea3ec=>_0x3ea3ec[_0x547e22(0x278)])[_0x547e22(0xa4b)]('、\x20')+_0x547e22(0x3fd)+_0x528823[_0x547e22(0x65a)][_0x547e22(0x796)](_0x4e73f0=>_0x4e73f0[_0x547e22(0x387)]+':\x20'+_0x4e73f0[_0x547e22(0x9a5)])[_0x547e22(0xa4b)]('\x0a')+'\x0a\x0a现在，请做出你的决定。';try{let _0x29f636=_0x1cbeec[_0x547e22(0x3ad)](_0x547e22(0xb9b)),_0x116d2f=[{'role':_0x547e22(0x21c),'content':_0x547e22(0x1026)}],_0x55cef7=_0x4a90fe(_0x540600,_0x3eb30f,_0x9529eb,_0x116d2f);const _0x4f5301=_0x29f636?await fetch(_0x55cef7['url'],_0x55cef7[_0x547e22(0x1cc)]):await fetch(_0x1cbeec+_0x547e22(0x8fd),{'method':_0x547e22(0x1128),'headers':{'Content-Type':'application/json','Authorization':_0x547e22(0xdaf)+_0x3eb30f},'body':JSON[_0x547e22(0x313)]({'model':_0x540600,'messages':[{'role':_0x547e22(0xf72),'content':_0x9529eb},..._0x116d2f],'temperature':_0x5de8b7[_0x547e22(0x2df)]['apiTemperature']||0.8})});if(!_0x4f5301['ok'])throw new Error((await _0x4f5301[_0x547e22(0xd7b)]())['error']['message']);const _0x2e0f81=await _0x4f5301[_0x547e22(0xd7b)](),_0x369bff=getGeminiResponseText(_0x2e0f81),_0x4f5169=_0x369bff[_0x547e22(0xe9f)](/({[\s\S]*})/);if(!_0x4f5169)throw new Error(_0x547e22(0xc56));const _0x327128=JSON['parse'](_0x4f5169[0x0]),_0x4c29d6=_0x528823[_0x547e22(0xc0d)][_0x547e22(0xe79)](_0x3a8fc9=>_0x3a8fc9[_0x547e22(0x278)]===_0x327128[_0x547e22(0x108d)]);return _0x4c29d6?_0x4c29d6['id']:null;}catch(_0x2c75c6){return console[_0x547e22(0x1c1)](_0x547e22(0x983),_0x2c75c6),_0x3b9b9f[Math['floor'](Math[_0x547e22(0x36d)]()*_0x3b9b9f[_0x547e22(0x594)])]['id'];}}function _0x4dabd7(_0x339b67,_0x155b3d){return new Promise(_0x5ab475=>{const _0x977098=_0x10a9,_0x2edc11=document[_0x977098(0x11e3)](_0x977098(0xd2b)),_0x1117e4=document[_0x977098(0x11e3)](_0x977098(0x58c)),_0x5148d6=document[_0x977098(0x11e3)](_0x977098(0x107d)),_0x327e2d=document[_0x977098(0x11e3)](_0x977098(0x919)),_0x2c243b=document['getElementById'](_0x977098(0xb78));_0x1117e4[_0x977098(0x595)]='';const _0x3e29d9=_0x327e2d[_0x977098(0x4b4)](!![]);_0x327e2d['parentNode']['replaceChild'](_0x3e29d9,_0x327e2d);const _0x28a528=_0x2c243b[_0x977098(0x4b4)](!![]);_0x2c243b[_0x977098(0x18c)][_0x977098(0xeaa)](_0x28a528,_0x2c243b),_0x3e29d9[_0x977098(0x794)]['display']='block',_0x3e29d9[_0x977098(0xe5c)]=!![];let _0x4d9880={'save':![],'poison':null},_0x2bb3fe=null;if(_0x339b67&&!_0x155b3d[_0x977098(0x9b7)]){_0x5148d6['textContent']='昨晚\x20'+_0x339b67['name']+_0x977098(0x1257);const _0x5c98b9=document['createElement'](_0x977098(0xbf2));_0x5c98b9['className']=_0x977098(0xafd),_0x5c98b9['textContent']=_0x977098(0x1d1),_0x5c98b9['style'][_0x977098(0xefc)]=_0x977098(0x12d1),_0x5c98b9[_0x977098(0x1074)]=()=>{const _0x2d6506=_0x977098;_0x4d9880['save']=!![],_0x2edc11['classList'][_0x2d6506(0x957)]('visible'),_0x5ab475(_0x4d9880);},_0x1117e4[_0x977098(0x120c)](_0x5c98b9);}else _0x339b67?_0x5148d6['textContent']=_0x977098(0x11f4)+_0x339b67['name']+_0x977098(0x7d7):_0x5148d6[_0x977098(0x300)]=_0x977098(0xe3f);if(!_0x155b3d[_0x977098(0x8ed)]){const _0x226e00=document[_0x977098(0x383)]('p');_0x226e00[_0x977098(0x300)]='是否要使用毒药？',_0x226e00['style'][_0x977098(0xbe3)]='center',_0x226e00['style'][_0x977098(0xec7)]=_0x977098(0x12d1),_0x1117e4[_0x977098(0x120c)](_0x226e00);const _0x1c9a8c=_0x528823[_0x977098(0xc0d)][_0x977098(0x138)](_0x534910=>_0x534910[_0x977098(0x4ff)]&&_0x534910['id']!==_0x339b67?.['id']);_0x1c9a8c[_0x977098(0x494)](_0x204d48=>{const _0x163da2=_0x977098,_0x346ab3=document['createElement'](_0x163da2(0x1285));_0x346ab3['className']=_0x163da2(0xf4c),_0x346ab3[_0x163da2(0xaca)]['id']=_0x204d48['id'],_0x346ab3[_0x163da2(0x595)]=_0x163da2(0x13b)+_0x204d48[_0x163da2(0x525)]+_0x163da2(0x208)+_0x204d48['name']+_0x163da2(0x4a3),_0x346ab3[_0x163da2(0x1074)]=()=>{const _0x496a35=_0x163da2;_0x1117e4[_0x496a35(0x10d6)](_0x496a35(0x9af))['forEach'](_0x367cc0=>_0x367cc0[_0x496a35(0x505)][_0x496a35(0x957)](_0x496a35(0xbbc))),_0x346ab3[_0x496a35(0x505)][_0x496a35(0x252)](_0x496a35(0xbbc)),_0x2bb3fe=_0x204d48['id'],_0x3e29d9['disabled']=![];},_0x1117e4['appendChild'](_0x346ab3);});}_0x3e29d9[_0x977098(0x1074)]=()=>{const _0x23477e=_0x977098;_0x2bb3fe&&(_0x4d9880[_0x23477e(0x11e1)]=_0x2bb3fe,_0x2edc11['classList']['remove'](_0x23477e(0x250)),_0x5ab475(_0x4d9880));},_0x28a528[_0x977098(0x1074)]=()=>{const _0x195322=_0x977098;_0x2edc11['classList'][_0x195322(0x957)](_0x195322(0x250)),_0x5ab475(_0x4d9880);},_0x2edc11[_0x977098(0x505)][_0x977098(0x252)]('visible');});}async function _0x5344e1(){const _0x5c2c76=_0x241b18,_0xa77314=_0x528823['lastFailedAction'];if(!_0xa77314)return;document[_0x5c2c76(0x11e3)]('werewolf-retry-btn')[_0x5c2c76(0x794)][_0x5c2c76(0x33d)]=_0x5c2c76(0x379),await _0x2fb06(_0x5c2c76(0x63d),_0x5c2c76(0x33b)+_0xa77314+_0x5c2c76(0x271));switch(_0xa77314){case _0x5c2c76(0xfc0):await _0x174fe7();break;case _0x5c2c76(0xbc6):await _0x20ace0();break;case _0x5c2c76(0xc3b):await _0x44ae7f();break;}}function _0x3dfee(){const _0x923599=_0x241b18,_0x58378b=_0x528823['players'][_0x923599(0x138)](_0x356bb6=>_0x356bb6[_0x923599(0x4ff)]),_0x39810f=_0x58378b[_0x923599(0x138)](_0x1eacff=>_0x1eacff['role']==='狼人'),_0x22724d=_0x58378b[_0x923599(0x138)](_0x324b01=>[_0x923599(0x941),'女巫','猎人','守卫'][_0x923599(0x3ad)](_0x324b01['role'])),_0x2f91fe=_0x58378b['filter'](_0x1f0423=>_0x1f0423[_0x923599(0xba4)]==='平民');let _0x4f977c=null;if(_0x39810f['length']===0x0)_0x4f977c='好人';else{if(_0x39810f[_0x923599(0x594)]>=_0x22724d[_0x923599(0x594)]+_0x2f91fe[_0x923599(0x594)])_0x4f977c='狼人';else _0x528823['gameMode']===_0x923599(0x5ad)?(_0x22724d[_0x923599(0x594)]===0x0||_0x2f91fe[_0x923599(0x594)]===0x0)&&(_0x4f977c='狼人'):_0x22724d[_0x923599(0x594)]===0x0&&_0x2f91fe[_0x923599(0x594)]===0x0&&(_0x4f977c='狼人');}if(_0x4f977c)return _0x34e1fa(_0x4f977c),!![];return![];}async function _0x7becc8(){const _0x5a10c0=_0x241b18,_0x266670=await _0x58fd60(_0x5a10c0(0x5bf),_0x5a10c0(0x6a3),{'confirmText':_0x5a10c0(0x1163)});if(!_0x266670)return;await _0x2fb06(_0x5a10c0(0x63d),'正在扫描和修复数据...');try{const _0x3c4f56=await _0x2e83f8[_0x5a10c0(0x737)][_0x5a10c0(0x508)]();let _0x349822=0x0;for(const _0x4c17e6 of _0x3c4f56){let _0x4e1cb1=![];!Array[_0x5a10c0(0xb7b)](_0x4c17e6[_0x5a10c0(0x49e)])&&(_0x4c17e6[_0x5a10c0(0x49e)]=[],_0x4e1cb1=!![]),(typeof _0x4c17e6[_0x5a10c0(0x761)]!=='object'||_0x4c17e6[_0x5a10c0(0x761)]===null)&&(_0x4c17e6['settings']={},_0x4e1cb1=!![]),!_0x4c17e6[_0x5a10c0(0x1244)]&&!_0x4c17e6[_0x5a10c0(0x697)]&&(_0x4c17e6[_0x5a10c0(0x697)]=_0x4c17e6[_0x5a10c0(0x278)],_0x4e1cb1=!![]),typeof _0x4c17e6[_0x5a10c0(0xc3a)]===_0x5a10c0(0x679)&&(_0x4c17e6['unreadCount']=0x0,_0x4e1cb1=!![]),!Array['isArray'](_0x4c17e6[_0x5a10c0(0xe21)])&&(_0x4c17e6[_0x5a10c0(0xe21)]=[],_0x4e1cb1=!![]),_0x4e1cb1&&(_0x349822++,console[_0x5a10c0(0x84b)](_0x5a10c0(0x15f)+_0x4c17e6[_0x5a10c0(0x278)]+'\x22\x20(ID:\x20'+_0x4c17e6['id']+_0x5a10c0(0x7d9)),await _0x2e83f8[_0x5a10c0(0x737)][_0x5a10c0(0xe3c)](_0x4c17e6)),_0x5de8b7[_0x5a10c0(0x737)][_0x4c17e6['id']]=_0x4c17e6;}_0x349822>0x0?(await _0x2fb06(_0x5a10c0(0x4de),'成功检查并修复了\x20'+_0x349822+_0x5a10c0(0x4fb)),await _0x5ee219()):await _0x2fb06(_0x5a10c0(0xe31),_0x5a10c0(0x1035));}catch(_0x21fe78){console[_0x5a10c0(0x1c1)](_0x5a10c0(0x128b),_0x21fe78),await _0x2fb06(_0x5a10c0(0x1177),_0x5a10c0(0x4dd)+_0x21fe78[_0x5a10c0(0x4bc)]);}}function _0x28c761(_0x5980a3,_0x42b1cb='top'){const _0x3a621f=_0x241b18;if(_0x5980a3[_0x3a621f(0x5ac)]('.loader-container'))return;const _0x3b9dc3=document[_0x3a621f(0x383)](_0x3a621f(0x1285));_0x3b9dc3[_0x3a621f(0x3db)]='loader-container',_0x3b9dc3[_0x3a621f(0x595)]=_0x3a621f(0x45f),_0x42b1cb===_0x3a621f(0x1070)?_0x5980a3[_0x3a621f(0x120c)](_0x3b9dc3):_0x5980a3['prepend'](_0x3b9dc3);}function _0x313362(_0x4796b6){const _0x5e92df=_0x241b18,_0x211734=_0x4796b6[_0x5e92df(0x5ac)](_0x5e92df(0x8bb));_0x211734&&_0x211734['remove']();}async function _0x5120e1(){const _0x27bbb8=_0x241b18,_0x490e0e=document[_0x27bbb8(0x11e3)](_0x27bbb8(0xa71)),_0x1081a9=document[_0x27bbb8(0x11e3)](_0x27bbb8(0x1ee)),_0xa1db98=document[_0x27bbb8(0x11e3)]('select-all-world-books-for-clear');_0x1081a9[_0x27bbb8(0x595)]='',_0xa1db98['checked']=![];const _0xf0e2bb=await _0x2e83f8[_0x27bbb8(0xca)][_0x27bbb8(0x508)]();_0xf0e2bb[_0x27bbb8(0x594)]===0x0?_0x1081a9[_0x27bbb8(0x595)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>':_0xf0e2bb[_0x27bbb8(0x494)](_0xdb8ea8=>{const _0x18c98d=_0x27bbb8,_0x5a069b=document[_0x18c98d(0x383)]('div');_0x5a069b[_0x18c98d(0x3db)]=_0x18c98d(0x1142),_0x5a069b[_0x18c98d(0xaca)][_0x18c98d(0x179)]=_0xdb8ea8['id'],_0x5a069b[_0x18c98d(0x595)]=_0x18c98d(0xfe)+_0xdb8ea8[_0x18c98d(0x278)]+_0x18c98d(0x12e8),_0x1081a9[_0x18c98d(0x120c)](_0x5a069b);}),_0x490e0e[_0x27bbb8(0x505)][_0x27bbb8(0x252)](_0x27bbb8(0x250));}async function _0x231f6d(){const _0x585a44=_0x241b18,_0x1ad9ad=document[_0x585a44(0x10d6)](_0x585a44(0x5ee));if(_0x1ad9ad[_0x585a44(0x594)]===0x0){alert(_0x585a44(0xfd8));return;}const _0xd4f990=Array[_0x585a44(0xee2)](_0x1ad9ad)['map'](_0x2992e9=>_0x2992e9[_0x585a44(0xaca)]['bookId']),_0x5348d0=await _0x58fd60(_0x585a44(0x394),_0x585a44(0x8b7)+_0x1ad9ad[_0x585a44(0x594)]+'\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！',{'confirmButtonClass':'btn-danger','confirmText':'确认删除'});if(!_0x5348d0)return;await _0x2fb06(_0x585a44(0x63d),'正在执行删除操作...');try{await _0x2e83f8[_0x585a44(0x1272)]('rw',_0x2e83f8['worldBooks'],_0x2e83f8['chats'],async()=>{const _0x58bba0=_0x585a44;await _0x2e83f8[_0x58bba0(0xca)][_0x58bba0(0x7ac)](_0xd4f990);const _0x584562=await _0x2e83f8[_0x58bba0(0x737)][_0x58bba0(0x508)]();for(const _0xbf7a51 of _0x584562){if(_0xbf7a51['settings']&&Array[_0x58bba0(0xb7b)](_0xbf7a51[_0x58bba0(0x761)][_0x58bba0(0xa17)])){const _0x19bf5a=_0xbf7a51[_0x58bba0(0x761)][_0x58bba0(0xa17)][_0x58bba0(0x594)];_0xbf7a51[_0x58bba0(0x761)][_0x58bba0(0xa17)]=_0xbf7a51[_0x58bba0(0x761)]['linkedWorldBookIds'][_0x58bba0(0x138)](_0x4b0948=>!_0xd4f990[_0x58bba0(0x3ad)](_0x4b0948)),_0xbf7a51[_0x58bba0(0x761)][_0x58bba0(0xa17)][_0x58bba0(0x594)]<_0x19bf5a&&await _0x2e83f8[_0x58bba0(0x737)][_0x58bba0(0xe3c)](_0xbf7a51);}}}),_0x5de8b7[_0x585a44(0xca)]=_0x5de8b7[_0x585a44(0xca)][_0x585a44(0x138)](_0x269f7b=>!_0xd4f990[_0x585a44(0x3ad)](_0x269f7b['id'])),document['getElementById'](_0x585a44(0xa71))[_0x585a44(0x505)]['remove']('visible'),await _0x2fb06(_0x585a44(0x699),_0x1ad9ad[_0x585a44(0x594)]+_0x585a44(0xc68));}catch(_0x890cfe){console[_0x585a44(0x1c1)](_0x585a44(0xb16),_0x890cfe),await _0x2fb06(_0x585a44(0x20e),_0x585a44(0xf9b)+_0x890cfe[_0x585a44(0x4bc)]);}}function _0x5ebd6a(){const _0x2a954b=_0x241b18;if(!_0x5de8b7[_0x2a954b(0x93d)])return;const _0x2dbd70=_0x5de8b7['activeChatId'],_0x5aec2e=document[_0x2a954b(0x11e3)](_0x2a954b(0x9d7)),_0x4a86b9=document['getElementById']('reading-window'),_0x56d1e4=document[_0x2a954b(0x11e3)](_0x2a954b(0xc24));let _0x243448=_0x27dbec[_0x2dbd70];if(_0x243448&&_0x243448['isActive']){_0x243448[_0x2a954b(0x879)]&&_0x144f03();_0x5aec2e[_0x2a954b(0x794)][_0x2a954b(0x33d)]=_0x2a954b(0x10f4);return;}_0x28227f(_0x2dbd70),_0x496148(_0x2dbd70),_0x5aec2e[_0x2a954b(0x794)][_0x2a954b(0x33d)]=_0x2a954b(0x10f4),_0x4a86b9[_0x2a954b(0x505)][_0x2a954b(0x957)](_0x2a954b(0x134)),_0x56d1e4[_0x2a954b(0x794)][_0x2a954b(0x33d)]='none';const _0x28c86b=document[_0x2a954b(0x11e3)]('phone-screen'),_0x56afaf=_0x4a86b9[_0x2a954b(0x106b)](),_0x2f2703=(_0x28c86b[_0x2a954b(0x10d9)]-_0x56afaf[_0x2a954b(0x10f2)])/0x2,_0x310ccf=(_0x28c86b[_0x2a954b(0xf76)]-_0x56afaf['width'])/0x2;_0x4a86b9[_0x2a954b(0x794)][_0x2a954b(0x10e2)]=_0x2f2703+'px',_0x4a86b9[_0x2a954b(0x794)][_0x2a954b(0x910)]=_0x310ccf+'px',_0x4a86b9[_0x2a954b(0x794)]['transform']='';}function _0x28227f(_0x30ef0e){const _0x361b35=_0x241b18;_0x27dbec[_0x30ef0e]={'isActive':!![],'isMinimized':![],'title':_0x361b35(0x31a),'contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0x3a513d(){const _0x2022c3=_0x241b18,_0x584f2f=_0x5de8b7[_0x2022c3(0x93d)];if(!_0x584f2f||!_0x27dbec[_0x584f2f]||!_0x27dbec[_0x584f2f][_0x2022c3(0x3d5)])return;document[_0x2022c3(0x11e3)]('reading-overlay')['style']['display']=_0x2022c3(0x379),document[_0x2022c3(0x11e3)](_0x2022c3(0xc24))[_0x2022c3(0x794)][_0x2022c3(0x33d)]=_0x2022c3(0x379),document['getElementById']('reading-window')[_0x2022c3(0x505)]['remove']('minimized'),_0x27dbec[_0x584f2f][_0x2022c3(0x3d5)]=![],console[_0x2022c3(0x84b)](_0x2022c3(0x69c));}function _0x13cd2e(){const _0xe9fd7f=_0x241b18,_0x6370e=_0x27dbec[_0x5de8b7['activeChatId']];if(!_0x6370e||!_0x6370e[_0xe9fd7f(0x3d5)]||_0x6370e[_0xe9fd7f(0x879)])return;_0x6370e[_0xe9fd7f(0x879)]=!![],document['getElementById']('reading-window')[_0xe9fd7f(0x505)][_0xe9fd7f(0x252)](_0xe9fd7f(0x134)),document['getElementById'](_0xe9fd7f(0xc24))['style'][_0xe9fd7f(0x33d)]='flex';}function _0x144f03(){const _0x25ebff=_0x241b18,_0x3cfce4=_0x27dbec[_0x5de8b7[_0x25ebff(0x93d)]];if(!_0x3cfce4||!_0x3cfce4[_0x25ebff(0x3d5)]||!_0x3cfce4['isMinimized'])return;_0x3cfce4[_0x25ebff(0x879)]=![],document[_0x25ebff(0x11e3)]('reading-restore-btn')['style'][_0x25ebff(0x33d)]='none',document['getElementById'](_0x25ebff(0x40b))[_0x25ebff(0x505)][_0x25ebff(0x957)](_0x25ebff(0x134));}function _0x511cbb(_0x56b147,_0x3ca6f0){const _0x2ebc7=_0x241b18;let _0x1ef115=0x0,_0x46fe6c=0x0,_0x443f33=0x0,_0x514ad9=0x0;const _0x109e12=document[_0x2ebc7(0x11e3)](_0x2ebc7(0x1e6)),_0x298c35=_0x5a2e41=>{const _0x78d610=_0x2ebc7;if(_0x5a2e41[_0x78d610(0xd7c)][_0x78d610(0xfe1)]('button'))return;if(_0x56b147[_0x78d610(0x794)][_0x78d610(0xb5d)]){const _0x5d5c97=_0x56b147[_0x78d610(0x106b)](),_0x3cee32=_0x56b147[_0x78d610(0x1185)][_0x78d610(0x106b)]();_0x56b147['style']['top']=_0x5d5c97[_0x78d610(0x10e2)]-_0x3cee32[_0x78d610(0x10e2)]+'px',_0x56b147[_0x78d610(0x794)]['left']=_0x5d5c97[_0x78d610(0x910)]-_0x3cee32[_0x78d610(0x910)]+'px',_0x56b147['style'][_0x78d610(0xb5d)]='';}_0x5a2e41['preventDefault']();const _0x55d990=_0x5a2e41[_0x78d610(0xa20)]===_0x78d610(0x39e)?_0x5a2e41[_0x78d610(0x371)][0x0]:_0x5a2e41;_0x443f33=_0x55d990[_0x78d610(0x3e6)],_0x514ad9=_0x55d990[_0x78d610(0x92d)],document[_0x78d610(0x4b8)](_0x78d610(0xdcb),_0x278ff0),document['addEventListener'](_0x78d610(0x270),_0x359b7b),document['addEventListener']('touchend',_0x278ff0),document[_0x78d610(0x4b8)](_0x78d610(0x19a),_0x359b7b);},_0x359b7b=_0x20c111=>{const _0x4edbc8=_0x2ebc7,_0x272baf=_0x20c111[_0x4edbc8(0xa20)]==='touchmove'?_0x20c111[_0x4edbc8(0x371)][0x0]:_0x20c111;_0x1ef115=_0x443f33-_0x272baf[_0x4edbc8(0x3e6)],_0x46fe6c=_0x514ad9-_0x272baf[_0x4edbc8(0x92d)],_0x443f33=_0x272baf[_0x4edbc8(0x3e6)],_0x514ad9=_0x272baf['clientY'];let _0xda5177=_0x56b147[_0x4edbc8(0x946)]-_0x46fe6c,_0x18ab82=_0x56b147[_0x4edbc8(0xfab)]-_0x1ef115;const _0x1c367b=_0x109e12[_0x4edbc8(0x10d9)]-_0x56b147[_0x4edbc8(0xea5)]-0xa,_0x1f168f=_0x109e12['clientWidth']-_0x56b147[_0x4edbc8(0x29f)]-0xa;_0xda5177=Math[_0x4edbc8(0x45d)](0xa,Math[_0x4edbc8(0xde8)](_0xda5177,_0x1c367b)),_0x18ab82=Math[_0x4edbc8(0x45d)](0xa,Math['min'](_0x18ab82,_0x1f168f)),_0x56b147[_0x4edbc8(0x794)][_0x4edbc8(0x10e2)]=_0xda5177+'px',_0x56b147['style'][_0x4edbc8(0x910)]=_0x18ab82+'px';},_0x278ff0=()=>{const _0x4df27e=_0x2ebc7;document[_0x4df27e(0xd7a)](_0x4df27e(0xdcb),_0x278ff0),document['removeEventListener']('mousemove',_0x359b7b),document[_0x4df27e(0xd7a)]('touchend',_0x278ff0),document[_0x4df27e(0xd7a)](_0x4df27e(0x19a),_0x359b7b);};_0x3ca6f0[_0x2ebc7(0x4b8)](_0x2ebc7(0xc23),_0x298c35),_0x3ca6f0['addEventListener'](_0x2ebc7(0x39e),_0x298c35);}function _0x496148(_0x345dc7){const _0x465b43=_0x241b18,_0x355cd3=_0x27dbec[_0x345dc7];if(!_0x355cd3)return;const _0x23a8e8=document['getElementById'](_0x465b43(0x1299)),_0x363cee=document[_0x465b43(0x11e3)](_0x465b43(0x169)),_0x3b10f7=document[_0x465b43(0x11e3)](_0x465b43(0xcc)),_0x5564a8=document[_0x465b43(0x11e3)](_0x465b43(0xf94)),_0x5d1b4c=document[_0x465b43(0x11e3)](_0x465b43(0x309));_0x23a8e8[_0x465b43(0x300)]=_0x355cd3[_0x465b43(0x740)];if(_0x355cd3[_0x465b43(0x465)][_0x465b43(0x594)]===0x0)_0x363cee['innerHTML']='<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>',_0x355cd3[_0x465b43(0x23c)]=0x0,_0x355cd3[_0x465b43(0x604)]=0x0;else{const _0x2d6c16=_0x355cd3[_0x465b43(0x604)]*_0x355cd3['linesPerPage'],_0x91ab60=_0x2d6c16+_0x355cd3[_0x465b43(0x945)];_0x363cee[_0x465b43(0x300)]=_0x355cd3[_0x465b43(0x465)][_0x465b43(0xa6c)](_0x2d6c16,_0x91ab60)[_0x465b43(0xa4b)]('\x0a');}_0x3b10f7['textContent']=_0x355cd3['currentPage']+0x1+'\x20/\x20'+_0x355cd3['totalPages'],_0x5564a8[_0x465b43(0xe5c)]=_0x355cd3[_0x465b43(0x604)]===0x0,_0x5d1b4c[_0x465b43(0xe5c)]=_0x355cd3[_0x465b43(0x604)]>=_0x355cd3['totalPages']-0x1;}function _0x421f20(){const _0x1e98d4=_0x241b18,_0x263344=_0x27dbec[_0x5de8b7['activeChatId']];_0x263344&&_0x263344[_0x1e98d4(0x604)]<_0x263344[_0x1e98d4(0x23c)]-0x1&&(_0x263344['currentPage']++,_0x496148(_0x5de8b7['activeChatId']),document['getElementById']('reading-content')[_0x1e98d4(0x11c7)]=0x0,_0x2ae326(_0x263344[_0x1e98d4(0x372)],_0x263344['currentPage']));}async function _0x55af62(){const _0x53ea17=_0x241b18,_0x43e522=_0x27dbec[_0x5de8b7[_0x53ea17(0x93d)]];_0x43e522&&_0x43e522[_0x53ea17(0x604)]>0x0&&(_0x43e522['currentPage']--,_0x496148(_0x5de8b7['activeChatId']),document[_0x53ea17(0x11e3)](_0x53ea17(0x169))['scrollTop']=0x0,await _0x2ae326(_0x43e522[_0x53ea17(0x372)],_0x43e522[_0x53ea17(0x604)]),await notifyAiOfPageTurn(_0x5de8b7[_0x53ea17(0x93d)],_0x43e522));}function _0x2eb266(){const _0x2a332b=_0x241b18;document['getElementById'](_0x2a332b(0xe76))['click']();}async function _0x55a095(_0x3619f0){const _0x1300ec=_0x241b18,_0x5850df=new Uint8Array(_0x3619f0);if(_0x5850df[_0x1300ec(0x594)]>=0x3&&_0x5850df[0x0]===0xef&&_0x5850df[0x1]===0xbb&&_0x5850df[0x2]===0xbf)return console[_0x1300ec(0x84b)](_0x1300ec(0x5e6)),new TextDecoder(_0x1300ec(0xae2))['decode'](_0x5850df);if(_0x5850df[_0x1300ec(0x594)]>=0x2&&_0x5850df[0x0]===0xff&&_0x5850df[0x1]===0xfe)return console[_0x1300ec(0x84b)](_0x1300ec(0x712)),new TextDecoder(_0x1300ec(0xc18))[_0x1300ec(0x28a)](_0x5850df);if(_0x5850df['length']>=0x2&&_0x5850df[0x0]===0xfe&&_0x5850df[0x1]===0xff)return console[_0x1300ec(0x84b)](_0x1300ec(0xafb)),new TextDecoder('utf-16be')[_0x1300ec(0x28a)](_0x5850df);try{console[_0x1300ec(0x84b)]('未检测到BOM，尝试使用\x20UTF-8\x20解码...');const _0x1cc093=new TextDecoder(_0x1300ec(0xae2),{'fatal':!![]})[_0x1300ec(0x28a)](_0x5850df);return console[_0x1300ec(0x84b)](_0x1300ec(0xefe)),_0x1cc093;}catch(_0x14a3b0){console[_0x1300ec(0x84b)](_0x1300ec(0xe28));try{const _0x1b817a=new TextDecoder('gbk')[_0x1300ec(0x28a)](_0x5850df);return console[_0x1300ec(0x84b)]('GBK\x20解码成功。'),_0x1b817a;}catch(_0x1ae118){console[_0x1300ec(0x1c1)](_0x1300ec(0x864),_0x1ae118);throw new Error(_0x1300ec(0x15a));}}}async function _0x4d234c(_0x52b34c){const _0x2ba1fb=_0x241b18,_0x1c9003=_0x52b34c[_0x2ba1fb(0xd7c)][_0x2ba1fb(0x5c9)][0x0];if(!_0x1c9003)return;try{const _0x321ddd=await _0x1c9003[_0x2ba1fb(0xd26)](),_0x1e83e7=await _0x55a095(_0x321ddd),_0x2828e1=_0x1c9003[_0x2ba1fb(0x278)][_0x2ba1fb(0x1018)](/\.txt$/i,''),_0x1077e4=await _0x2e83f8[_0x2ba1fb(0xd40)][_0x2ba1fb(0x252)]({'title':_0x2828e1,'content':_0x1e83e7,'lastOpened':Date[_0x2ba1fb(0x1182)]()});await _0xf778c0(_0x1077e4),document[_0x2ba1fb(0x11e3)]('reading-library-modal')[_0x2ba1fb(0x505)]['contains'](_0x2ba1fb(0x250))&&_0x4fe5c9();}catch(_0xcb30c3){console['error']('导入书籍失败:',_0xcb30c3),await _0x2fb06(_0x2ba1fb(0x19f),_0xcb30c3[_0x2ba1fb(0x4bc)]);}finally{_0x52b34c[_0x2ba1fb(0xd7c)][_0x2ba1fb(0xf27)]=null;}}async function _0xaf7d4e(){const _0x5f52a5=_0x241b18,_0x7a22a6=_0x5de8b7[_0x5f52a5(0x93d)];if(!_0x7a22a6)return;const _0x43384c=_0x27dbec[_0x7a22a6];if(!_0x43384c||_0x43384c['totalPages']<=0x1)return;const _0x1d5a52=await _0x231a5a(_0x5f52a5(0xa8a),'请输入想跳转的页码\x20(1\x20-\x20'+_0x43384c['totalPages']+')',_0x43384c[_0x5f52a5(0x604)]+0x1);if(_0x1d5a52===null)return;const _0x313e2=parseInt(_0x1d5a52);if(isNaN(_0x313e2)||_0x313e2<0x1||_0x313e2>_0x43384c[_0x5f52a5(0x23c)]){alert('请输入一个有效的页码！');return;}_0x43384c['currentPage']=_0x313e2-0x1,_0x496148(_0x7a22a6),_0x2ae326(_0x43384c['activeBookId'],_0x43384c['currentPage']);}async function _0x2ae326(_0x4b382d,_0xd35de0){const _0x2c33ab=_0x241b18;if(!_0x4b382d)return;try{await _0x2e83f8['readingLibrary'][_0x2c33ab(0x1225)](_0x4b382d,{'currentPage':_0xd35de0});}catch(_0x146837){console[_0x2c33ab(0x1c1)](_0x2c33ab(0x1258)+_0x4b382d+')的阅读进度失败:',_0x146837);}}async function _0x421f20(){const _0x9ef86b=_0x241b18,_0x496c94=_0x27dbec[_0x5de8b7['activeChatId']];_0x496c94&&_0x496c94[_0x9ef86b(0x604)]<_0x496c94[_0x9ef86b(0x23c)]-0x1&&(_0x496c94[_0x9ef86b(0x604)]++,_0x496148(_0x5de8b7['activeChatId']),document['getElementById'](_0x9ef86b(0x169))[_0x9ef86b(0x11c7)]=0x0,await _0x2ae326(_0x496c94['activeBookId'],_0x496c94['currentPage']),await notifyAiOfPageTurn(_0x5de8b7[_0x9ef86b(0x93d)],_0x496c94));}function _0x35aeac(_0x56169,_0x361cc2){const _0x391ef=_0x241b18,_0xd19776=_0x5de8b7[_0x391ef(0x93d)];if(!_0xd19776)return;const _0x3e1851=_0x27dbec[_0xd19776];_0x3e1851[_0x391ef(0x740)]=_0x56169[_0x391ef(0x1018)](/\.txt$/i,''),_0x3e1851[_0x391ef(0x465)]=_0x361cc2[_0x391ef(0x65b)](/\r\n?|\n/)['map'](_0x541b=>_0x541b['replace'](/ +/g,'\x20')),_0x3e1851[_0x391ef(0x23c)]=Math[_0x391ef(0x89f)](_0x3e1851['contentLines']['length']/_0x3e1851[_0x391ef(0x945)]),_0x3e1851[_0x391ef(0x604)]=0x0,_0x496148(_0xd19776);}async function _0x18bfc1(){const _0x2a2d83=_0x241b18;document[_0x2a2d83(0x11e3)](_0x2a2d83(0x123))['value']='',await _0x4fe5c9(),document[_0x2a2d83(0x11e3)]('reading-library-modal')['classList']['add'](_0x2a2d83(0x250));}async function _0x4fe5c9(_0x3ca3c0=''){const _0x593cad=_0x241b18,_0x3253de=document[_0x593cad(0x11e3)](_0x593cad(0x64a));let _0x31d756=await _0x2e83f8[_0x593cad(0xd40)][_0x593cad(0x7c6)](_0x593cad(0xd4))[_0x593cad(0x107)]()['toArray']();_0x3253de[_0x593cad(0x595)]='';_0x3ca3c0&&(_0x31d756=_0x31d756[_0x593cad(0x138)](_0x444b2d=>_0x444b2d[_0x593cad(0x740)][_0x593cad(0xb03)]()['includes'](_0x3ca3c0['toLowerCase']())));if(_0x31d756[_0x593cad(0x594)]===0x0){const _0x414e2f=_0x3ca3c0?_0x593cad(0x79e):_0x593cad(0xdbb);_0x3253de['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>'+_0x414e2f+_0x593cad(0xdc8);return;}_0x31d756[_0x593cad(0x494)](_0x37c1b2=>{const _0x4871ee=_0x593cad,_0x3e984a=document['createElement']('div');_0x3e984a[_0x4871ee(0x3db)]=_0x4871ee(0x1cf),_0x3e984a[_0x4871ee(0x595)]=_0x4871ee(0x9ff)+_0x37c1b2['id']+'\x22>'+_0x37c1b2['title']+_0x4871ee(0x106d)+_0x37c1b2['id']+_0x4871ee(0x727),_0x3253de['appendChild'](_0x3e984a);});}async function _0xf778c0(_0x329b51){const _0xf8878b=_0x241b18,_0x1aed45=_0x5de8b7[_0xf8878b(0x93d)];if(!_0x1aed45)return;const _0x2e268e=await _0x2e83f8[_0xf8878b(0xd40)][_0xf8878b(0x1289)](_0x329b51);if(!_0x2e268e){alert(_0xf8878b(0x358));return;}await _0x2e83f8[_0xf8878b(0xd40)][_0xf8878b(0x1225)](_0x329b51,{'lastOpened':Date['now']()});const _0x2c6643=_0x27dbec[_0x1aed45];_0x2c6643[_0xf8878b(0x372)]=_0x329b51,_0x2c6643[_0xf8878b(0x740)]=_0x2e268e[_0xf8878b(0x740)],_0x2c6643['contentLines']=_0x2e268e[_0xf8878b(0x9a5)][_0xf8878b(0x65b)](/\r\n?|\n/)[_0xf8878b(0x796)](_0x303723=>_0x303723['replace'](/ +/g,'\x20')),_0x2c6643[_0xf8878b(0x23c)]=Math[_0xf8878b(0x89f)](_0x2c6643['contentLines']['length']/_0x2c6643[_0xf8878b(0x945)]),_0x2c6643[_0xf8878b(0x604)]=_0x2e268e[_0xf8878b(0x604)]||0x0,_0x496148(_0x1aed45),document[_0xf8878b(0x11e3)]('reading-content')['scrollTop']=0x0,document[_0xf8878b(0x11e3)](_0xf8878b(0x615))['classList'][_0xf8878b(0x957)]('visible');}async function _0x30b55f(_0x3aae0b){const _0x86cd55=_0x241b18,_0xd0fe08=await _0x2e83f8[_0x86cd55(0xd40)][_0x86cd55(0x1289)](_0x3aae0b);if(!_0xd0fe08)return;const _0x588da3=await _0x58fd60(_0x86cd55(0x571),'确定要删除《'+_0xd0fe08[_0x86cd55(0x740)]+_0x86cd55(0xe48),{'confirmButtonClass':_0x86cd55(0x8a6)});_0x588da3&&(await _0x2e83f8[_0x86cd55(0xd40)][_0x86cd55(0xc0c)](_0x3aae0b),await _0x4fe5c9());}function _0x35aeac(_0x294d35,_0x145ad1){const _0x4928ab=_0x241b18,_0x1f4489=_0x5de8b7['activeChatId'];if(!_0x1f4489)return;const _0x42aea4=_0x27dbec[_0x1f4489];_0x42aea4[_0x4928ab(0x740)]=_0x294d35['replace'](/\.txt$/i,''),_0x42aea4['contentLines']=_0x145ad1['split'](/\r\n?|\n/),_0x42aea4['totalPages']=Math[_0x4928ab(0x89f)](_0x42aea4[_0x4928ab(0x465)]['length']/_0x42aea4['linesPerPage']),_0x42aea4[_0x4928ab(0x604)]=0x0,_0x496148(_0x1f4489);}function _0x511cbb(_0x731991,_0xce84e8){const _0x8990d8=_0x241b18;let _0x5b64f6=0x0,_0x2715bf=0x0,_0x536afd=0x0,_0x5a070e=0x0,_0x5a0d45=![],_0x440393=![];const _0x2a9f15=document[_0x8990d8(0x11e3)](_0x8990d8(0x1e6)),_0x1d67ca=_0x32ff9e=>{const _0x28d21d=_0x8990d8;if(_0x731991!==_0xce84e8&&_0x32ff9e[_0x28d21d(0xd7c)][_0x28d21d(0xfe1)](_0x28d21d(0xbf2)))return;_0x5a0d45=!![],_0x440393=![];const _0x391f5f=_0x32ff9e['type']===_0x28d21d(0x39e)?_0x32ff9e['touches'][0x0]:_0x32ff9e;_0x536afd=_0x391f5f[_0x28d21d(0x3e6)],_0x5a070e=_0x391f5f[_0x28d21d(0x92d)],_0x731991['style'][_0x28d21d(0x10e2)]=_0x731991[_0x28d21d(0x946)]+'px',_0x731991['style'][_0x28d21d(0x910)]=_0x731991['offsetLeft']+'px',_0x731991['style'][_0x28d21d(0xb5d)]='',document[_0x28d21d(0x4b8)](_0x28d21d(0xdcb),_0x5d4670),document[_0x28d21d(0x4b8)](_0x28d21d(0x270),_0x20624c),document[_0x28d21d(0x4b8)](_0x28d21d(0xf7b),_0x5d4670),document[_0x28d21d(0x4b8)](_0x28d21d(0x19a),_0x20624c,{'passive':![]});},_0x20624c=_0x2e212b=>{const _0x40782f=_0x8990d8;if(!_0x5a0d45)return;const _0x20a876=_0x2e212b[_0x40782f(0xa20)]===_0x40782f(0x19a)?_0x2e212b[_0x40782f(0x371)][0x0]:_0x2e212b,_0x5379bb=_0x20a876[_0x40782f(0x3e6)]-_0x536afd,_0x254c23=_0x20a876[_0x40782f(0x92d)]-_0x5a070e;!_0x440393&&(Math[_0x40782f(0xf8f)](_0x5379bb)>0x5||Math[_0x40782f(0xf8f)](_0x254c23)>0x5)&&(_0x440393=!![]);_0x440393&&_0x2e212b['cancelable']&&_0x2e212b[_0x40782f(0xf87)]();_0x5b64f6=_0x536afd-_0x20a876[_0x40782f(0x3e6)],_0x2715bf=_0x5a070e-_0x20a876['clientY'],_0x536afd=_0x20a876[_0x40782f(0x3e6)],_0x5a070e=_0x20a876[_0x40782f(0x92d)];let _0x220f9c=_0x731991[_0x40782f(0x946)]-_0x2715bf,_0x4937cf=_0x731991[_0x40782f(0xfab)]-_0x5b64f6;const _0x4b01c3=_0x2a9f15[_0x40782f(0x10d9)]-_0x731991[_0x40782f(0xea5)]-0xa,_0x5a2655=_0x2a9f15[_0x40782f(0xf76)]-_0x731991['offsetWidth']-0xa;_0x220f9c=Math[_0x40782f(0x45d)](0xa,Math[_0x40782f(0xde8)](_0x220f9c,_0x4b01c3)),_0x4937cf=Math[_0x40782f(0x45d)](0xa,Math[_0x40782f(0xde8)](_0x4937cf,_0x5a2655)),_0x731991['style'][_0x40782f(0x10e2)]=_0x220f9c+'px',_0x731991[_0x40782f(0x794)][_0x40782f(0x910)]=_0x4937cf+'px';},_0x5d4670=()=>{const _0x512ddb=_0x8990d8;document[_0x512ddb(0xd7a)](_0x512ddb(0xdcb),_0x5d4670),document['removeEventListener']('mousemove',_0x20624c),document['removeEventListener'](_0x512ddb(0xf7b),_0x5d4670),document[_0x512ddb(0xd7a)](_0x512ddb(0x19a),_0x20624c);if(!_0x5a0d45)return;_0x5a0d45=![],!_0x440393&&_0x731991[_0x512ddb(0x1041)]();};_0xce84e8[_0x8990d8(0x4b8)](_0x8990d8(0xc23),_0x1d67ca),_0xce84e8[_0x8990d8(0x4b8)](_0x8990d8(0x39e),_0x1d67ca,{'passive':![]});}function _0x13cd2e(){const _0x1d42b0=_0x241b18,_0x3b176f=_0x27dbec[_0x5de8b7['activeChatId']];if(!_0x3b176f||!_0x3b176f[_0x1d42b0(0x3d5)])return;document['getElementById']('reading-window')[_0x1d42b0(0x505)][_0x1d42b0(0x252)](_0x1d42b0(0x134)),document[_0x1d42b0(0x11e3)](_0x1d42b0(0xc24))[_0x1d42b0(0x794)]['display']='flex',_0x3b176f['isMinimized']=!![];}function _0x144f03(){const _0x4c81ad=_0x241b18,_0x5c01f1=_0x27dbec[_0x5de8b7['activeChatId']];if(!_0x5c01f1||!_0x5c01f1[_0x4c81ad(0x3d5)])return;document[_0x4c81ad(0x11e3)](_0x4c81ad(0xc24))[_0x4c81ad(0x794)]['display']=_0x4c81ad(0x379),document['getElementById'](_0x4c81ad(0x40b))[_0x4c81ad(0x505)][_0x4c81ad(0x957)](_0x4c81ad(0x134)),_0x5c01f1[_0x4c81ad(0x879)]=![];}function _0x33ce20(_0x101d88,_0x1bf1b8){let _0x4c8eeb;return function(..._0x47ea23){const _0x1399e3=_0x10a9,_0x57eb01=this;clearTimeout(_0x4c8eeb),_0x4c8eeb=setTimeout(()=>_0x101d88[_0x1399e3(0x2a2)](_0x57eb01,_0x47ea23),_0x1bf1b8);};}function _0x4ffeed(_0xa25967){const _0x293cb1=_0x241b18,_0x544122=_0x27dbec[_0xa25967];if(!_0x544122||!_0x544122[_0x293cb1(0x3d5)])return'';const _0x1c377b=_0x544122[_0x293cb1(0x740)]||'未知书籍';let _0x4099a9='',_0xc20641='';if(_0x544122[_0x293cb1(0x754)]&&_0x544122['currentSnippet'][_0x293cb1(0xeb7)]())_0x4099a9=_0x544122[_0x293cb1(0x754)],_0xc20641=_0x293cb1(0x304);else{if(_0x544122['contentLines'][_0x293cb1(0x594)]>0x0){const _0x4fe240=_0x544122['currentPage']*_0x544122[_0x293cb1(0x945)],_0x222213=_0x4fe240+_0x544122[_0x293cb1(0x945)];_0x4099a9=_0x544122[_0x293cb1(0x465)]['slice'](_0x4fe240,_0x222213)['join']('\x0a')[_0x293cb1(0x8d4)](0x0,0xc8),_0xc20641=_0x293cb1(0xd3f);}else _0x4099a9=_0x293cb1(0xa79),_0xc20641='内容';}return _0x293cb1(0x878)+_0x1c377b+_0x293cb1(0xc8d)+_0xc20641+_0x293cb1(0x1138)+_0x4099a9+'...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】('+(_0x5de8b7['chats'][_0xa25967]?.[_0x293cb1(0x697)]||'AI角色')+_0x293cb1(0xa3e);}function _0x310c68(){const _0x5d250f=_0x241b18,_0x533b1b=_0x5de8b7['activeChatId'];if(!_0x533b1b||!_0x27dbec[_0x533b1b])return;const _0xe1556b=_0x27dbec[_0x533b1b],_0x2519f6=document['getElementById'](_0x5d250f(0x169)),_0x772989=_0x2519f6[_0x5d250f(0x11c7)],_0x7fa3f=_0x2519f6[_0x5d250f(0x10d9)],_0xabede2=_0x772989+_0x7fa3f,_0x202ce2=0xf*1.8,_0x280037=Math[_0x5d250f(0xfb1)](_0x772989/_0x202ce2),_0x1e1ed3=Math[_0x5d250f(0x89f)](_0xabede2/_0x202ce2),_0x2272e9=_0xe1556b[_0x5d250f(0x604)]*_0xe1556b[_0x5d250f(0x945)]+_0x280037,_0x538719=_0xe1556b[_0x5d250f(0x604)]*_0xe1556b[_0x5d250f(0x945)]+_0x1e1ed3;if(_0x2272e9<0x0||_0x2272e9>=_0xe1556b[_0x5d250f(0x465)][_0x5d250f(0x594)])return;const _0x49c92f=_0xe1556b[_0x5d250f(0x465)]['slice'](Math[_0x5d250f(0x45d)](0x0,_0x2272e9),Math[_0x5d250f(0xde8)](_0xe1556b[_0x5d250f(0x465)][_0x5d250f(0x594)],_0x538719))['join']('\x0a');_0xe1556b[_0x5d250f(0x754)]=_0x49c92f;}function _0x3f8b63(){const _0x43ec9a=_0x241b18,_0x578424=document[_0x43ec9a(0x11e3)](_0x43ec9a(0x123a));if(_0x578424){const _0x51da75=_0x578424[_0x43ec9a(0x7d1)]();_0x51da75!==undefined&&_0x51da75[_0x43ec9a(0x5de)](_0x169383=>{const _0xef0543=_0x43ec9a;console[_0xef0543(0x84b)]('静音音频已启动，用于后台活动保活。');})['catch'](_0x24c74e=>{const _0x145b67=_0x43ec9a;console[_0x145b67(0x6b0)](_0x145b67(0x7a7),_0x24c74e);});}}function _0x5efcc9(){const _0x3813b0=_0x241b18,_0x2f2ac3=document[_0x3813b0(0x11e3)]('silent-audio-player');_0x2f2ac3&&!_0x2f2ac3['paused']&&(_0x2f2ac3['pause'](),_0x2f2ac3[_0x3813b0(0x1056)]=0x0,console['log'](_0x3813b0(0x1002)));}async function _0x3d3507(_0x5996ae){const _0x324534=_0x241b18,_0x44dd54=decodeURIComponent(_0x5996ae[_0x324534(0xaca)][_0x324534(0x1197)]),_0x375e7d=_0x5996ae[_0x324534(0xaca)][_0x324534(0xac6)],_0x588dfc=_0x5996ae['querySelector'](_0x324534(0x630)),_0x46ad50=_0x5996ae[_0x324534(0x5ac)](_0x324534(0x93f)),_0x39694e=document[_0x324534(0x11e3)](_0x324534(0xf9f));if(!_0x39694e[_0x324534(0x950)]&&_0x39694e[_0x324534(0xaca)]['currentText']===_0x44dd54&&_0x39694e[_0x324534(0xaca)][_0x324534(0x614)]===_0x375e7d){_0x39694e[_0x324534(0x9b1)]();return;}_0x39694e[_0x324534(0x9b1)](),document[_0x324534(0x10d6)](_0x324534(0x630))['forEach'](_0x103935=>_0x103935[_0x324534(0x300)]='▶');const _0x8f8d25='tts_'+_0x375e7d+'_'+_0x44dd54;let _0x40208a=_0x5de8b7[_0x324534(0xdd8)][_0x324534(0x1289)](_0x8f8d25);if(_0x40208a){console['log'](_0x324534(0x654)),await _0x271004(_0x40208a[_0x324534(0x10ac)],_0x40208a[_0x324534(0xa20)],_0x44dd54,_0x375e7d,_0x5996ae);return;}console[_0x324534(0x84b)](_0x324534(0x461));if(_0x588dfc)_0x588dfc[_0x324534(0x794)]['display']='none';_0x46ad50[_0x324534(0x794)][_0x324534(0x33d)]=_0x324534(0x11ac);const {minimaxGroupId:_0xffc457,minimaxApiKey:_0x218454}=_0x5de8b7[_0x324534(0x89c)];if(!_0xffc457||!_0x218454){await _0x2fb06('配置错误','请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。'),_0x46ad50[_0x324534(0x794)]['display']=_0x324534(0x379);if(_0x588dfc)_0x588dfc[_0x324534(0x794)][_0x324534(0x33d)]=_0x324534(0x10f4);return;}try{const _0x3e74a9=await fetch(_0x324534(0xc10)+_0xffc457,{'method':_0x324534(0x1128),'headers':{'Authorization':_0x324534(0xdaf)+_0x218454,'Content-Type':'application/json'},'body':JSON['stringify']({'text':_0x44dd54,'voice_id':_0x375e7d,'model':_0x5de8b7[_0x324534(0x89c)]['minimaxModel']||'speech-01','speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0x3e74a9['ok']){let _0x52d6d4=_0x324534(0x8a3)+_0x3e74a9['status'];try{const _0x41df50=await _0x3e74a9[_0x324534(0xd7b)]();_0x52d6d4=_0x41df50[_0x324534(0xdfd)]?.[_0x324534(0xad4)]||JSON['stringify'](_0x41df50);}catch(_0x1b9d96){_0x52d6d4=await _0x3e74a9[_0x324534(0x1197)]();}throw new Error(_0x52d6d4);}const _0x37f245=await _0x3e74a9[_0x324534(0xccb)](),_0x5b3eb4=URL[_0x324534(0x12fd)](_0x37f245);await _0x271004(_0x5b3eb4,_0x37f245[_0x324534(0xa20)],_0x44dd54,_0x375e7d,_0x5996ae);const _0x3e3244=new FileReader();_0x3e3244['onloadend']=function(){const _0x454e5d=_0x324534;_0x5de8b7['ttsCache'][_0x454e5d(0xb25)](_0x8f8d25,{'url':_0x3e3244[_0x454e5d(0x255)],'type':_0x37f245[_0x454e5d(0xa20)]}),console[_0x454e5d(0x84b)](_0x454e5d(0x1201));},_0x3e3244[_0x324534(0x1270)](_0x37f245);}catch(_0x49f903){console[_0x324534(0x1c1)](_0x324534(0xd64),_0x49f903),await _0x2fb06(_0x324534(0x4d4),_0x324534(0xed2)+_0x49f903[_0x324534(0x4bc)]);}finally{_0x46ad50[_0x324534(0x794)][_0x324534(0x33d)]=_0x324534(0x379);if(_0x588dfc)_0x588dfc[_0x324534(0x794)][_0x324534(0x33d)]=_0x324534(0x10f4);}}function _0x271004(_0x34a72a,_0x38e5c7,_0x52a12d,_0xa46d76,_0x2d4d58){return new Promise((_0x272f35,_0x3b1196)=>{const _0x3494ff=_0x10a9,_0x3fdf70=document[_0x3494ff(0x11e3)](_0x3494ff(0xf9f));_0x3fdf70['src']=_0x34a72a,_0x3fdf70[_0x3494ff(0xa20)]=_0x38e5c7,_0x3fdf70['dataset'][_0x3494ff(0x111)]=_0x52a12d,_0x3fdf70['dataset'][_0x3494ff(0x614)]=_0xa46d76;const _0x26f4d1=_0x3fdf70[_0x3494ff(0x7d1)]();_0x26f4d1!==undefined&&_0x26f4d1[_0x3494ff(0x5de)](()=>{const _0x179ae4=_0x2d4d58['querySelector']('.voice-play-btn');if(_0x179ae4)_0x179ae4['textContent']='❚❚';_0x272f35();})[_0x3494ff(0x100)](_0x10f171=>{const _0x4ad5dd=_0x3494ff;console[_0x4ad5dd(0x1c1)](_0x4ad5dd(0xaaf),_0x10f171),_0x3b1196(_0x10f171);}),_0x3fdf70[_0x3494ff(0x1108)]=()=>{const _0x2cd787=_0x3494ff,_0x5ef2eb=_0x2d4d58[_0x2cd787(0x5ac)](_0x2cd787(0x630));if(_0x5ef2eb)_0x5ef2eb[_0x2cd787(0x300)]='▶';},_0x3fdf70[_0x3494ff(0x6f6)]=()=>{const _0x4149ed=_0x3494ff,_0x2ad14a=_0x2d4d58['querySelector'](_0x4149ed(0x630));if(_0x2ad14a)_0x2ad14a[_0x4149ed(0x300)]='▶';};});}function _0x1b89c3(_0x1033b9){const _0x369dd5=_0x241b18,_0x4981b9=_0x1033b9['closest'](_0x369dd5(0x6a9));if(!_0x4981b9)return;const _0x49b756=_0x4981b9[_0x369dd5(0x5ac)](_0x369dd5(0x547)),_0x45d770=decodeURIComponent(_0x1033b9[_0x369dd5(0xaca)][_0x369dd5(0x1197)]);_0x49b756['style']['display']===_0x369dd5(0x11ac)?_0x49b756[_0x369dd5(0x794)]['display']='none':(_0x49b756[_0x369dd5(0x300)]=_0x45d770,_0x49b756[_0x369dd5(0x794)][_0x369dd5(0x33d)]='block');}async function _0x264c3b(){const _0x16f261=_0x241b18;await _0x57b0c4(),document['getElementById'](_0x16f261(0x5e3))[_0x16f261(0x505)]['add'](_0x16f261(0x250));}async function _0x57b0c4(){const _0x2d7506=_0x241b18,_0x202ffd=document['getElementById'](_0x2d7506(0x97c)),_0x28c993=await _0x2e83f8[_0x2d7506(0xf85)]['toArray']();_0x202ffd[_0x2d7506(0x595)]='';if(_0x28c993[_0x2d7506(0x594)]===0x0){_0x202ffd['innerHTML']=_0x2d7506(0x85d);return;}_0x28c993[_0x2d7506(0x494)](_0x5be67d=>{const _0x23da13=_0x2d7506,_0x1949b0=document[_0x23da13(0x383)]('div');_0x1949b0[_0x23da13(0x3db)]=_0x23da13(0x1cf),_0x1949b0[_0x23da13(0x595)]=_0x23da13(0x670)+_0x5be67d[_0x23da13(0x278)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x5be67d['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x202ffd[_0x23da13(0x120c)](_0x1949b0);});}async function _0x1a7edc(){const _0x52850c=_0x241b18,_0x262e21=document[_0x52850c(0x11e3)]('new-product-category-name-input'),_0x395b58=_0x262e21[_0x52850c(0xf27)][_0x52850c(0xeb7)]();if(!_0x395b58)return alert(_0x52850c(0x4a2));const _0x46a1f5=await _0x2e83f8[_0x52850c(0xf85)][_0x52850c(0x129e)](_0x52850c(0x278))['equals'](_0x395b58)[_0x52850c(0x12c1)]();if(_0x46a1f5)return alert(_0x52850c(0x1239)+_0x395b58+_0x52850c(0xc96));await _0x2e83f8[_0x52850c(0xf85)][_0x52850c(0x252)]({'name':_0x395b58}),_0x262e21['value']='',await _0x57b0c4();}async function _0x49e49d(_0x3ced65){const _0x218f4b=_0x241b18,_0x44664a=await _0x58fd60(_0x218f4b(0x1166),'删除分类后，该分类下的所有商品将变为“未分类”。确定吗？',{'confirmButtonClass':_0x218f4b(0x8a6)});_0x44664a&&(await _0x2e83f8['shoppingCategories']['delete'](_0x3ced65),await _0x2e83f8[_0x218f4b(0x120)][_0x218f4b(0x129e)]('categoryId')['equals'](_0x3ced65)[_0x218f4b(0x408)]({'categoryId':null}),await _0x57b0c4());}function _0x3e9ca6(_0x169d92={}){const _0x11b310=_0x241b18,_0x2c5239=document[_0x11b310(0x11e3)](_0x11b310(0xe37)),_0x3fccf0=document[_0x11b310(0x383)](_0x11b310(0x1285));return _0x3fccf0[_0x11b310(0x3db)]=_0x11b310(0x388),_0x3fccf0['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22'+(_0x169d92['name']||'')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22'+(_0x169d92['price']||'')+_0x11b310(0x11aa)+(_0x169d92['imageUrl']||'https://i.postimg.cc/PqYp5T5M/image.png')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x3fccf0[_0x11b310(0x5ac)](_0x11b310(0x48b))[_0x11b310(0x4b8)](_0x11b310(0x1041),()=>_0x3fccf0[_0x11b310(0x957)]()),_0x3fccf0[_0x11b310(0x5ac)](_0x11b310(0x7e9))[_0x11b310(0x4b8)]('click',()=>{const _0x2185bd=_0x11b310;_0x3fccf0[_0x2185bd(0x5ac)]('.variation-image-input')[_0x2185bd(0x1041)]();}),_0x3fccf0['querySelector'](_0x11b310(0x798))[_0x11b310(0x4b8)](_0x11b310(0xfeb),_0x5da347=>{const _0xa26342=_0x11b310,_0x41c44a=_0x5da347[_0xa26342(0xd7c)]['files'][0x0];if(_0x41c44a){const _0x402d28=new FileReader();_0x402d28['onload']=_0x11ba70=>{const _0x4a04f1=_0xa26342;_0x3fccf0[_0x4a04f1(0x5ac)](_0x4a04f1(0xd8f))[_0x4a04f1(0xf0a)]=_0x11ba70[_0x4a04f1(0xd7c)][_0x4a04f1(0x255)];},_0x402d28[_0xa26342(0x1270)](_0x41c44a);}}),_0x2c5239['appendChild'](_0x3fccf0),_0x3fccf0;}async function _0x114ccb(_0x5263fc){const _0x402e1f=_0x241b18,_0x3671aa=await _0x2e83f8[_0x402e1f(0x120)][_0x402e1f(0x1289)](_0x5263fc);if(!_0x3671aa||!_0x3671aa[_0x402e1f(0x1039)]||_0x3671aa[_0x402e1f(0x1039)][_0x402e1f(0x594)]===0x0)return;const _0x420a84=document['getElementById'](_0x402e1f(0xc65));document[_0x402e1f(0x11e3)](_0x402e1f(0x2cb))[_0x402e1f(0xf0a)]=_0x3671aa[_0x402e1f(0xf44)],document[_0x402e1f(0x11e3)](_0x402e1f(0x310))['textContent']=_0x3671aa[_0x402e1f(0x278)];const _0x3a66ab=document['getElementById'](_0x402e1f(0x113c));_0x3a66ab[_0x402e1f(0x595)]='',_0x3671aa['variations']['forEach']((_0xa11062,_0xbb07f)=>{const _0x2ca168=_0x402e1f,_0x5b44f8=document[_0x2ca168(0x383)](_0x2ca168(0x6be));_0x5b44f8['type']=_0x2ca168(0x6b4),_0x5b44f8['name']=_0x2ca168(0xdc6),_0x5b44f8['id']=_0x2ca168(0xe8e)+_0x5263fc+'-'+_0xbb07f,_0x5b44f8[_0x2ca168(0xf27)]=_0xbb07f,_0x5b44f8[_0x2ca168(0x794)][_0x2ca168(0x33d)]=_0x2ca168(0x379);if(_0xbb07f===0x0)_0x5b44f8['checked']=!![];const _0x2c3ab9=document[_0x2ca168(0x383)](_0x2ca168(0x308));_0x2c3ab9[_0x2ca168(0x22e)]=_0x2ca168(0xe8e)+_0x5263fc+'-'+_0xbb07f,_0x2c3ab9[_0x2ca168(0x300)]=_0xa11062['name'],_0x2c3ab9[_0x2ca168(0x794)][_0x2ca168(0xfb7)]=_0x2ca168(0x5bc),_0x3a66ab[_0x2ca168(0x120c)](_0x5b44f8),_0x3a66ab[_0x2ca168(0x120c)](_0x2c3ab9);});const _0x31e5aa=()=>{const _0x363f12=_0x402e1f,_0x5bae61=_0x3a66ab['querySelector'](_0x363f12(0x120d));_0x3a66ab[_0x363f12(0x10d6)](_0x363f12(0x308))[_0x363f12(0x494)](_0x5309b9=>{const _0x108394=_0x363f12;_0x5309b9[_0x108394(0x794)][_0x108394(0xd07)]=_0x108394(0xa4f),_0x5309b9[_0x108394(0x794)]['color']=_0x108394(0x15b),_0x5309b9[_0x108394(0x794)][_0x108394(0x556)]=_0x108394(0xa5f);});if(_0x5bae61){const _0x58e45f=_0x3a66ab[_0x363f12(0x5ac)](_0x363f12(0x283)+_0x5bae61['id']+'\x22]');_0x58e45f[_0x363f12(0x794)][_0x363f12(0xd07)]=_0x363f12(0xaf9),_0x58e45f[_0x363f12(0x794)]['color']=_0x363f12(0xaf9),_0x58e45f[_0x363f12(0x794)][_0x363f12(0x556)]='#e7f3ff';const _0x105369=_0x3671aa[_0x363f12(0x1039)][parseInt(_0x5bae61[_0x363f12(0xf27)])];document['getElementById'](_0x363f12(0x9ac))['textContent']='¥'+_0x105369[_0x363f12(0xa6f)]['toFixed'](0x2),_0x105369[_0x363f12(0xf44)]?document[_0x363f12(0x11e3)]('variation-product-image')[_0x363f12(0xf0a)]=_0x105369['imageUrl']:document[_0x363f12(0x11e3)](_0x363f12(0x2cb))[_0x363f12(0xf0a)]=_0x3671aa[_0x363f12(0xf44)];}};_0x3a66ab[_0x402e1f(0x4b8)](_0x402e1f(0xfeb),_0x31e5aa),_0x31e5aa(),document[_0x402e1f(0x11e3)]('variation-quantity-display')['textContent']='1';const _0x2f56c0=document[_0x402e1f(0x11e3)](_0x402e1f(0xccd)),_0x558e8e=_0x2f56c0[_0x402e1f(0x4b4)](!![]);_0x2f56c0[_0x402e1f(0x18c)][_0x402e1f(0xeaa)](_0x558e8e,_0x2f56c0),_0x558e8e['addEventListener'](_0x402e1f(0x1041),async()=>{const _0x493669=_0x402e1f,_0x188e21=_0x3a66ab['querySelector']('input[name=\x22variation-select\x22]:checked'),_0x2fa9b7=parseInt(document['getElementById'](_0x493669(0x36a))[_0x493669(0x300)]);if(_0x188e21){const _0x53babc=_0x3671aa[_0x493669(0x1039)][parseInt(_0x188e21[_0x493669(0xf27)])];await _0x3cde4b(_0x5263fc,_0x2fa9b7,_0x53babc),_0x420a84[_0x493669(0x505)][_0x493669(0x957)]('visible'),await _0x2fb06('成功',_0x493669(0x1091));}}),_0x420a84[_0x402e1f(0x505)][_0x402e1f(0x252)](_0x402e1f(0x250));}function _0x41fa7e(){const _0x496a0f=_0x241b18,_0x446f51=document[_0x496a0f(0x11e3)]('shopping-settings-modal');document[_0x496a0f(0x11e3)](_0x496a0f(0xa9b))['value']=_0x5de8b7['globalSettings'][_0x496a0f(0xdad)]||0x3,document[_0x496a0f(0x11e3)](_0x496a0f(0x7e7))[_0x496a0f(0xf27)]=_0x5de8b7[_0x496a0f(0x2df)][_0x496a0f(0xb41)]||0x8,_0x446f51[_0x496a0f(0x505)][_0x496a0f(0x252)](_0x496a0f(0x250));}async function _0x1da71a(){const _0x296fba=_0x241b18,_0x366348=document['getElementById'](_0x296fba(0xa9b)),_0x2d42cd=document['getElementById'](_0x296fba(0x7e7)),_0x4fc5c8=parseInt(_0x366348['value']),_0x35e857=parseInt(_0x2d42cd[_0x296fba(0xf27)]);if(isNaN(_0x4fc5c8)||isNaN(_0x35e857)||_0x4fc5c8<0x1||_0x35e857<0x1){alert('请输入有效的正整数！');return;}_0x5de8b7['globalSettings']['shoppingCategoryCount']=_0x4fc5c8,_0x5de8b7[_0x296fba(0x2df)][_0x296fba(0xb41)]=_0x35e857,await _0x2e83f8[_0x296fba(0x2df)][_0x296fba(0xe3c)](_0x5de8b7[_0x296fba(0x2df)]),document['getElementById'](_0x296fba(0x1101))[_0x296fba(0x505)][_0x296fba(0x957)](_0x296fba(0x250)),await _0x2fb06(_0x296fba(0x4c1),_0x296fba(0x124d));}async function _0x2a31e8(){const _0x1318a6=_0x241b18;if(!_0x5de8b7['activeChatId']){await _0x2fb06(_0x1318a6(0x1177),_0x1318a6(0xd4e));return;}const _0x100bd8=_0x5de8b7[_0x1318a6(0x737)][_0x5de8b7['activeChatId']],_0x2fa393=await _0x58fd60('为“'+_0x100bd8[_0x1318a6(0x278)]+_0x1318a6(0x9f4),'此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？',{'confirmText':_0x1318a6(0xbba)});if(!_0x2fa393)return;await _0x2fb06('请稍候...',_0x1318a6(0x395)+_0x100bd8[_0x1318a6(0x278)]+_0x1318a6(0x107b));const _0x532a5b=_0x5de8b7[_0x1318a6(0x89c)]['secondaryProxyUrl']&&_0x5de8b7[_0x1318a6(0x89c)][_0x1318a6(0xb05)]&&_0x5de8b7['apiConfig']['secondaryModel'],{proxyUrl:_0x55444a,apiKey:_0x2de037,model:_0x48dceb}=_0x532a5b?{'proxyUrl':_0x5de8b7[_0x1318a6(0x89c)]['secondaryProxyUrl'],'apiKey':_0x5de8b7['apiConfig']['secondaryApiKey'],'model':_0x5de8b7[_0x1318a6(0x89c)][_0x1318a6(0xe1b)]}:_0x5de8b7[_0x1318a6(0x89c)];if(!_0x55444a||!_0x2de037||!_0x48dceb){await _0x2fb06('API未配置',_0x1318a6(0x2c9));return;}const _0x5b0c8e=_0x5de8b7[_0x1318a6(0x2df)][_0x1318a6(0xdad)]||0x3,_0x54243b=_0x5de8b7[_0x1318a6(0x2df)][_0x1318a6(0xb41)]||0x8,_0xe6897=await _0x2e83f8[_0x1318a6(0xf85)][_0x1318a6(0x508)]();let _0x4c8485='';_0xe6897['length']>0x0&&(_0x4c8485=_0x1318a6(0x6f1)+_0xe6897[_0x1318a6(0x796)](_0x5ba67f=>'\x22'+_0x5ba67f['name']+'\x22')[_0x1318a6(0xa4b)](',\x20')+']\x0a');const _0x1e1c55=_0x5de8b7[_0x1318a6(0x1c5)][_0x1318a6(0xa33)]||'我',_0x4fe2ea=_0x100bd8[_0x1318a6(0xe21)]&&_0x100bd8['longTermMemory'][_0x1318a6(0x594)]>0x0?_0x100bd8['longTermMemory'][_0x1318a6(0x796)](_0xfea2a8=>_0x1318a6(0xd12)+_0x497f2b(_0xfea2a8[_0x1318a6(0x702)])+')\x20'+_0xfea2a8[_0x1318a6(0x9a5)])[_0x1318a6(0xa4b)]('\x0a'):'无',_0x3eedf5=_0x100bd8[_0x1318a6(0x49e)][_0x1318a6(0xa6c)](-0xa)['map'](_0x358724=>(_0x358724[_0x1318a6(0xba4)]===_0x1318a6(0x21c)?_0x1e1c55:_0x100bd8['name'])+':\x20'+String(_0x358724[_0x1318a6(0x9a5)])[_0x1318a6(0x8d4)](0x0,0x1e)+_0x1318a6(0x6cb))[_0x1318a6(0xa4b)]('\x0a');let _0x459eb3='';if(_0x100bd8['settings']['linkedWorldBookIds']&&_0x100bd8[_0x1318a6(0x761)][_0x1318a6(0xa17)]['length']>0x0){const _0x4b6731=_0x100bd8[_0x1318a6(0x761)][_0x1318a6(0xa17)][_0x1318a6(0x796)](_0x11e55f=>{const _0x59db70=_0x1318a6,_0x21e346=_0x5de8b7[_0x59db70(0xca)][_0x59db70(0xe79)](_0x2011ab=>_0x2011ab['id']===_0x11e55f);if(!_0x21e346||!Array[_0x59db70(0xb7b)](_0x21e346[_0x59db70(0x9a5)]))return'';const _0x2c5057=_0x21e346[_0x59db70(0x9a5)]['filter'](_0x2e4eb9=>_0x2e4eb9[_0x59db70(0xc34)]!==![])['map'](_0x46e1bb=>'-\x20'+_0x46e1bb[_0x59db70(0x9a5)])[_0x59db70(0xa4b)]('\x0a');return _0x2c5057?_0x59db70(0x8b1)+_0x21e346[_0x59db70(0x278)]+_0x59db70(0x844)+_0x2c5057:'';})[_0x1318a6(0x138)](Boolean)[_0x1318a6(0xa4b)]('');_0x4b6731&&(_0x459eb3=_0x1318a6(0x293)+_0x4b6731+'\x0a');}const _0x3e6a08='\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“'+_0x100bd8[_0x1318a6(0x278)]+_0x1318a6(0x367)+_0x5b0c8e+_0x1318a6(0xb7a)+_0x54243b+'\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20'+_0x100bd8[_0x1318a6(0x278)]+_0x1318a6(0x536)+_0x100bd8[_0x1318a6(0x761)][_0x1318a6(0x8d5)]+_0x1318a6(0x813)+_0x4fe2ea+_0x1318a6(0x565)+_0x459eb3+'\x0a'+_0x4c8485+_0x1318a6(0x56d)+_0x3eedf5+_0x1318a6(0x167)+_0x100bd8['name']+_0x1318a6(0x1058);try{const _0x317403=[{'role':_0x1318a6(0x21c),'content':_0x1318a6(0xe91)}];let _0x36e434=_0x55444a['includes'](_0x1318a6(0xb9b)),_0x1f4718=_0x4a90fe(_0x48dceb,_0x2de037,_0x3e6a08,_0x317403);const _0x419f0e=_0x36e434?await fetch(_0x1f4718[_0x1318a6(0x10ac)],_0x1f4718[_0x1318a6(0x1cc)]):await fetch(_0x55444a+_0x1318a6(0x8fd),{'method':_0x1318a6(0x1128),'headers':{'Content-Type':_0x1318a6(0x35c),'Authorization':_0x1318a6(0xdaf)+_0x2de037},'body':JSON['stringify']({'model':_0x48dceb,'messages':[{'role':_0x1318a6(0xf72),'content':_0x3e6a08},..._0x317403],'temperature':_0x5de8b7['globalSettings']['apiTemperature']||0.9})});if(!_0x419f0e['ok'])throw new Error(_0x1318a6(0x307)+_0x419f0e[_0x1318a6(0xfcf)]);const _0x4b6cf8=await _0x419f0e['json'](),_0x1c11a2=getGeminiResponseText(_0x4b6cf8),_0x45fe20=_0x1c11a2['match'](/({[\s\S]*})/);if(!_0x45fe20)throw new Error(_0x1318a6(0xaeb));const _0x468944=JSON[_0x1318a6(0xb0c)](_0x45fe20[0x0]);if(!_0x468944[_0x1318a6(0x263)]||!Array[_0x1318a6(0xb7b)](_0x468944['categories']))throw new Error(_0x1318a6(0xbd1));await _0x2e83f8[_0x1318a6(0x1272)]('rw',_0x2e83f8['shoppingProducts'],_0x2e83f8['shoppingCategories'],async()=>{const _0x5504c6=_0x1318a6;for(const _0x45df55 of _0x468944['categories']){let _0x524ece;const _0x36609f=await _0x2e83f8[_0x5504c6(0xf85)]['where'](_0x5504c6(0x278))[_0x5504c6(0x12be)](_0x45df55['name'])['first']();_0x36609f?_0x524ece=_0x36609f['id']:_0x524ece=await _0x2e83f8[_0x5504c6(0xf85)][_0x5504c6(0x252)]({'name':_0x45df55[_0x5504c6(0x278)]});const _0x582766=_0x45df55['products'][_0x5504c6(0x796)](_0x35079c=>{const _0x2f4f73=_0x5504c6;return{'name':_0x35079c['name'],'price':_0x35079c[_0x2f4f73(0xa6f)]||0x0,'description':_0x35079c[_0x2f4f73(0x1029)]||'','imageUrl':'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x35079c[_0x2f4f73(0xee6)]),'variations':(_0x35079c[_0x2f4f73(0x1039)]||[])[_0x2f4f73(0x796)](_0x2ae996=>({..._0x2ae996,'imageUrl':_0x2f4f73(0x35d)+encodeURIComponent(_0x2ae996[_0x2f4f73(0xee6)])})),'categoryId':_0x524ece};});_0x582766['length']>0x0&&await _0x2e83f8['shoppingProducts'][_0x5504c6(0xc16)](_0x582766);}}),activeShoppingCategoryId=_0x1318a6(0xd4a),await _0x1deb57(),await _0x2fb06(_0x1318a6(0x669),'为“'+_0x100bd8[_0x1318a6(0x278)]+_0x1318a6(0x1de));}catch(_0x561bb9){console[_0x1318a6(0x1c1)](_0x1318a6(0xb60),_0x561bb9),await _0x2fb06('生成失败',_0x1318a6(0x2e0)+_0x561bb9[_0x1318a6(0x4bc)]);}}async function _0x3f0017(_0x1fd176){const _0x162192=_0x241b18,_0x547521=document[_0x162192(0x11e3)](_0x1fd176);if(!_0x547521)return;const _0x474111=await _0x16a8e1(_0x162192(0x713),[{'text':_0x162192(0xe72),'value':_0x162192(0xd1b)},{'text':_0x162192(0x111b),'value':_0x162192(0x10ac)}]);let _0x1e95b6=null;if(_0x474111===_0x162192(0xd1b))_0x1e95b6=await _0x3b69be();else _0x474111===_0x162192(0x10ac)&&(_0x1e95b6=await _0x231a5a(_0x162192(0x713),'请输入新的图片URL：',_0x547521[_0x162192(0xf0a)],_0x162192(0x10ac)));if(_0x1e95b6&&_0x1e95b6[_0x162192(0xeb7)]()){const _0x33615f=_0x1e95b6['trim']();_0x547521[_0x162192(0xf0a)]=_0x33615f,!_0x5de8b7['globalSettings'][_0x162192(0x532)]&&(_0x5de8b7[_0x162192(0x2df)]['widgetData']={}),_0x5de8b7[_0x162192(0x2df)][_0x162192(0x532)][_0x1fd176]=_0x33615f,await _0x2e83f8[_0x162192(0x2df)]['put'](_0x5de8b7[_0x162192(0x2df)]),await _0x2fb06('成功',_0x162192(0xb12));}}window['handleWidgetImageChange']=_0x3f0017;async function _0xe491c9(){const _0x4559fb=_0x241b18;if(!window[_0x4559fb(0x17f)]){alert('流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。');return;}await _0x2fb06(_0x4559fb(0x664),_0x4559fb(0xc69));const _0x555389=streamSaver['createWriteStream'](_0x4559fb(0x1233)+new Date()[_0x4559fb(0xda)]()[_0x4559fb(0x65b)]('T')[0x0]+_0x4559fb(0xfc4)),_0x30d7fb=_0x555389[_0x4559fb(0xf86)](),_0x792eca=new TextEncoder();try{await _0x30d7fb[_0x4559fb(0x407)](_0x792eca[_0x4559fb(0xe5)](_0x4559fb(0x1f3)+Date[_0x4559fb(0x1182)]()+',\x0a\x22data\x22:\x20{\x0a'));const _0x5bb6a2=await _0x2e83f8[_0x4559fb(0x9e8)][_0x4559fb(0x796)](_0x5ec6d2=>_0x5ec6d2[_0x4559fb(0x278)]);for(let _0x45beef=0x0;_0x45beef<_0x5bb6a2[_0x4559fb(0x594)];_0x45beef++){const _0x529b04=_0x5bb6a2[_0x45beef],_0x59fa00=_0x2e83f8[_0x4559fb(0xb4e)](_0x529b04);await _0x30d7fb[_0x4559fb(0x407)](_0x792eca[_0x4559fb(0xe5)]('\x22'+_0x529b04+'\x22:\x20[\x0a'));let _0x1519c2=!![];await _0x59fa00[_0x4559fb(0x490)](_0xda011a=>{const _0x79389=_0x4559fb;!_0x1519c2&&_0x30d7fb[_0x79389(0x407)](_0x792eca[_0x79389(0xe5)](',\x0a')),_0x30d7fb[_0x79389(0x407)](_0x792eca['encode'](JSON[_0x79389(0x313)](_0xda011a))),_0x1519c2=![];}),await _0x30d7fb['write'](_0x792eca[_0x4559fb(0xe5)]('\x0a]')),_0x45beef<_0x5bb6a2[_0x4559fb(0x594)]-0x1&&await _0x30d7fb[_0x4559fb(0x407)](_0x792eca[_0x4559fb(0xe5)](',\x0a'));}await _0x30d7fb['write'](_0x792eca['encode']('\x0a}\x0a}'));}catch(_0x3cf507){console[_0x4559fb(0x1c1)](_0x4559fb(0x279),_0x3cf507),await _0x2fb06('导出失败',_0x4559fb(0x700)+_0x3cf507[_0x4559fb(0x4bc)]);}finally{await _0x30d7fb[_0x4559fb(0x1b0)]();}}async function _0x4de534(){const _0x36eb28=_0x241b18;await _0x2fb06(_0x36eb28(0x664),_0x36eb28(0x62c));try{const _0x51f335={'version':0x3,'timestamp':Date['now'](),'data':{}},_0xe04873=_0x2e83f8['tables'][_0x36eb28(0x796)](_0x208948=>_0x208948['name']);for(const _0x19bad2 of _0xe04873){const _0x2a3bc7=await _0x2e83f8[_0x36eb28(0xb4e)](_0x19bad2)[_0x36eb28(0x508)]();_0x51f335[_0x36eb28(0x1cc)][_0x19bad2]=_0x2a3bc7,console[_0x36eb28(0x84b)](_0x36eb28(0x1050)+_0x19bad2+_0x36eb28(0xcfe)+_0x2a3bc7[_0x36eb28(0x594)]);}const _0x578d00=new Blob([JSON[_0x36eb28(0x313)](_0x51f335,null,0x2)],{'type':_0x36eb28(0x35c)}),_0x47b9e3=URL[_0x36eb28(0x12fd)](_0x578d00),_0x55fd66=document[_0x36eb28(0x383)]('a');_0x55fd66[_0x36eb28(0x125b)]=_0x47b9e3,_0x55fd66[_0x36eb28(0x8bd)]='EPhone-Full-Backup-Legacy-'+new Date()[_0x36eb28(0xda)]()[_0x36eb28(0x65b)]('T')[0x0]+_0x36eb28(0xfc4),_0x55fd66[_0x36eb28(0x1041)](),URL[_0x36eb28(0xa02)](_0x47b9e3),await _0x2fb06('导出成功',_0x36eb28(0x9ce));}catch(_0x2aea95){console[_0x36eb28(0x1c1)](_0x36eb28(0x10e4),_0x2aea95),await _0x2fb06(_0x36eb28(0x567),_0x36eb28(0x88d)+_0x2aea95['message']);}}function _0x17cf58(){const _0x28ca1f=_0x241b18,_0x5ebe23=Object[_0x28ca1f(0x4ca)](_0x5de8b7[_0x28ca1f(0x737)])[_0x28ca1f(0x870)]((_0x4c081d,_0x173185)=>{const _0x1bf21b=_0x28ca1f;if(_0x173185['id']===_0x5de8b7[_0x1bf21b(0x93d)])return _0x4c081d;return _0x4c081d+(_0x173185['unreadCount']||0x0);},0x0),_0x123ec6=_0x481a45||0x0,_0x3dfb1a=_0x5ebe23+_0x123ec6,_0x2a7f24=document['getElementById'](_0x28ca1f(0x5c4));if(!_0x2a7f24)return;let _0x3833b2=_0x2a7f24[_0x28ca1f(0x5ac)](_0x28ca1f(0x1cd));!_0x3833b2&&(_0x3833b2=document['createElement'](_0x28ca1f(0x436)),_0x3833b2[_0x28ca1f(0x3db)]=_0x28ca1f(0x67d),_0x2a7f24[_0x28ca1f(0x120c)](_0x3833b2));let _0x19c2cb=_0x2a7f24[_0x28ca1f(0x5ac)](_0x28ca1f(0x747));_0x19c2cb&&_0x19c2cb[_0x28ca1f(0x957)](),_0x3dfb1a>0x0?(_0x3833b2[_0x28ca1f(0x300)]=_0x3dfb1a>0x63?'99+':_0x3dfb1a,_0x3833b2[_0x28ca1f(0x794)][_0x28ca1f(0x33d)]='block',_0x3833b2[_0x28ca1f(0x794)][_0x28ca1f(0x32b)]='20',_0x3833b2['style'][_0x28ca1f(0xb5d)]=_0x28ca1f(0x4b2)):_0x3833b2[_0x28ca1f(0x794)][_0x28ca1f(0x33d)]=_0x28ca1f(0x379);}async function _0x447379(_0x1d026a){const _0x2a7237=_0x241b18,_0x29484e=_0x1d026a===_0x2a7237(0xb81)?{'id':_0x2a7237(0xb81),'name':'未分类'}:await _0x2e83f8[_0x2a7237(0x120e)][_0x2a7237(0x1289)](_0x1d026a);if(!_0x29484e){console['error'](_0x2a7237(0x2c5),_0x1d026a);return;}const _0x376023=document[_0x2a7237(0x11e3)](_0x2a7237(0xc4a)),_0x4f6314=document[_0x2a7237(0x11e3)](_0x2a7237(0xcee)),_0x2233c5=_0x376023[_0x2a7237(0x5ac)](_0x2a7237(0xe35));_0x4f6314[_0x2a7237(0x595)]='',_0x2233c5[_0x2a7237(0x300)]=_0x2a7237(0xb4f)+_0x29484e[_0x2a7237(0x278)]+'”\x20绑定到...';const _0x2fc078=Object[_0x2a7237(0x4ca)](_0x5de8b7['chats'])[_0x2a7237(0x861)]((_0x3311c1,_0x4241f8)=>_0x3311c1['name']['localeCompare'](_0x4241f8[_0x2a7237(0x278)],_0x2a7237(0x898)));_0x2fc078['forEach'](_0x41d529=>{const _0x56bb89=_0x2a7237,_0x3cb633=Array[_0x56bb89(0xb7b)](_0x41d529['settings']?.[_0x56bb89(0xbf8)])&&_0x41d529[_0x56bb89(0x761)][_0x56bb89(0xbf8)][_0x56bb89(0x3ad)](_0x1d026a),_0x6b8467=document['createElement'](_0x56bb89(0x1285));_0x6b8467['className']=_0x56bb89(0x9b3),_0x6b8467[_0x56bb89(0x595)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22sticker-binding-checkbox\x22\x20data-chat-id=\x22'+_0x41d529['id']+'\x22\x20'+(_0x3cb633?_0x56bb89(0x3e4):'')+_0x56bb89(0x6e3)+(_0x41d529['isGroup']?_0x41d529[_0x56bb89(0x761)]['groupAvatar']:_0x41d529[_0x56bb89(0x761)][_0x56bb89(0x5e0)]||_0x3d2e44)+_0x56bb89(0x655)+_0x41d529[_0x56bb89(0x278)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4f6314[_0x56bb89(0x120c)](_0x6b8467);}),document[_0x2a7237(0x11e3)](_0x2a7237(0x3a1))['onclick']=()=>_0x50465b(_0x1d026a),document[_0x2a7237(0x11e3)](_0x2a7237(0xffb))[_0x2a7237(0x1074)]=()=>_0x376023[_0x2a7237(0x505)][_0x2a7237(0x957)]('visible'),_0x376023[_0x2a7237(0x505)]['add'](_0x2a7237(0x250));}async function _0x50465b(_0x326745){const _0xbbf34=_0x241b18,_0x27174d=new Set(Array[_0xbbf34(0xee2)](document[_0xbbf34(0x10d6)](_0xbbf34(0xc82)))['map'](_0x1da509=>_0x1da509[_0xbbf34(0xaca)]['chatId'])),_0x57d2ef=[];for(const _0x2e735f in _0x5de8b7[_0xbbf34(0x737)]){const _0x19724f=_0x5de8b7[_0xbbf34(0x737)][_0x2e735f];!Array[_0xbbf34(0xb7b)](_0x19724f[_0xbbf34(0x761)][_0xbbf34(0xbf8)])&&(_0x19724f[_0xbbf34(0x761)][_0xbbf34(0xbf8)]=[]);const _0x2d20a8=_0x19724f[_0xbbf34(0x761)][_0xbbf34(0xbf8)][_0xbbf34(0x3ad)](_0x326745),_0x1cf7f9=_0x27174d['has'](_0x2e735f);if(_0x2d20a8&&!_0x1cf7f9)_0x19724f['settings']['stickerCategoryIds']=_0x19724f['settings'][_0xbbf34(0xbf8)][_0xbbf34(0x138)](_0x43c4a8=>_0x43c4a8!==_0x326745),_0x57d2ef['push'](_0x19724f);else!_0x2d20a8&&_0x1cf7f9&&(_0x19724f[_0xbbf34(0x761)][_0xbbf34(0xbf8)][_0xbbf34(0xf5)](_0x326745),_0x57d2ef[_0xbbf34(0xf5)](_0x19724f));}_0x57d2ef[_0xbbf34(0x594)]>0x0&&(await _0x2e83f8[_0xbbf34(0x737)][_0xbbf34(0xd72)](_0x57d2ef),await _0x2fb06('保存成功',_0xbbf34(0x5a2))),document[_0xbbf34(0x11e3)](_0xbbf34(0xc4a))['classList'][_0xbbf34(0x957)](_0xbbf34(0x250));}function _0x5342bb(_0x5a2fa5){const _0x4f0a94=_0x241b18;if(!_0x5a2fa5||!_0x5a2fa5[_0x4f0a94(0x761)][_0x4f0a94(0xbf8)]||_0x5a2fa5[_0x4f0a94(0x761)][_0x4f0a94(0xbf8)][_0x4f0a94(0x594)]===0x0)return'';const _0x116d49=_0x5a2fa5[_0x4f0a94(0x761)][_0x4f0a94(0xbf8)];let _0x3bb59f=[];const _0x186854=new Set();_0x116d49[_0x4f0a94(0x494)](_0x4ed084=>{const _0xb31c8e=_0x4f0a94;let _0x869b79;_0x4ed084===_0xb31c8e(0xb81)?_0x869b79=_0x5de8b7[_0xb31c8e(0xa67)]['filter'](_0x2982cb=>!_0x2982cb[_0xb31c8e(0x9ee)]):_0x869b79=_0x5de8b7['userStickers'][_0xb31c8e(0x138)](_0x41d362=>_0x41d362['categoryId']===_0x4ed084),_0x869b79[_0xb31c8e(0x494)](_0x49e153=>{const _0x4cc66a=_0xb31c8e;!_0x186854['has'](_0x49e153['name'])&&(_0x3bb59f[_0x4cc66a(0xf5)](_0x49e153),_0x186854[_0x4cc66a(0x252)](_0x49e153[_0x4cc66a(0x278)]));});});if(_0x3bb59f[_0x4f0a94(0x594)]===0x0)return'';const _0x4ff41b=_0x3bb59f['map'](_0x428c44=>'-\x20'+_0x428c44[_0x4f0a94(0x278)])[_0x4f0a94(0xa4b)]('\x0a');return _0x4f0a94(0x201)+_0x4ff41b+'\x0a';}function _0xb76b68(_0x2654a0){const _0x369611=_0x241b18;if(!_0x2654a0||!_0x2654a0['isGroup'])return'';let _0x1d50e8='\x0a#\x20可用表情包\x20(优先使用)\x0a每个AI角色都被设置了专属表情包，在需要发送表情时，他们应该【优先】从自己的专属列表中选择。尽量让你的表情丰富多样，避免重复。\x0a',_0x10224c=![];return _0x2654a0['members'][_0x369611(0x494)](_0x21e640=>{const _0x3c2080=_0x369611;if(_0x21e640['id']===_0x3c2080(0x21c))return;const _0x2de060=_0x5de8b7[_0x3c2080(0x737)][_0x21e640['id']];if(_0x2de060&&_0x2de060[_0x3c2080(0x761)][_0x3c2080(0xbf8)]&&_0x2de060[_0x3c2080(0x761)][_0x3c2080(0xbf8)]['length']>0x0){const _0x378bb1=_0x2de060[_0x3c2080(0x761)][_0x3c2080(0xbf8)];let _0x1cb0b9=[];const _0x1d8dab=new Set();_0x378bb1[_0x3c2080(0x494)](_0x2a3ab5=>{const _0x2ced80=_0x3c2080;let _0x48f28d;_0x2a3ab5===_0x2ced80(0xb81)?_0x48f28d=_0x5de8b7[_0x2ced80(0xa67)][_0x2ced80(0x138)](_0x5d7f8a=>!_0x5d7f8a[_0x2ced80(0x9ee)]):_0x48f28d=_0x5de8b7['userStickers']['filter'](_0x2338ad=>_0x2338ad['categoryId']===_0x2a3ab5),_0x48f28d[_0x2ced80(0x494)](_0x237b20=>{const _0x563a89=_0x2ced80;!_0x1d8dab[_0x563a89(0x72a)](_0x237b20['name'])&&(_0x1cb0b9['push'](_0x237b20),_0x1d8dab[_0x563a89(0x252)](_0x237b20[_0x563a89(0x278)]));});}),_0x1cb0b9[_0x3c2080(0x594)]>0x0&&(_0x10224c=!![],_0x1d50e8+=_0x3c2080(0xea1)+_0x21e640[_0x3c2080(0xc8f)]+_0x3c2080(0x734)+_0x21e640[_0x3c2080(0x697)]+_0x3c2080(0xac4),_0x1d50e8+=_0x1cb0b9['map'](_0x5d1580=>'-\x20'+_0x5d1580[_0x3c2080(0x278)])[_0x3c2080(0xa4b)]('\x0a'));}}),_0x10224c?_0x1d50e8:'';}async function _0x170a84(){const _0x47aceb=_0x241b18;async function _0xd97fce(_0x33a13a){const _0x5dae6a=_0x10a9;if(!_0x33a13a)return;try{const _0x3e47a0=await _0x33a13a[_0x5dae6a(0x1197)](),_0x23cf21=JSON[_0x5dae6a(0xb0c)](_0x3e47a0);if(_0x23cf21[_0x5dae6a(0xa20)]===_0x5dae6a(0x129))console[_0x5dae6a(0x84b)]('检测到\x20EPhone\x20备份文件，执行标准导入...'),await _0x12a814(_0x23cf21);else{if(_0x23cf21[_0x5dae6a(0x560)]&&typeof _0x23cf21[_0x5dae6a(0x560)]===_0x5dae6a(0x537))console['log']('检测到\x20Tavern\x20AI\x20世界书文件，执行兼容导入...'),await _0x465501(_0x23cf21,_0x33a13a[_0x5dae6a(0x278)]);else throw new Error(_0x5dae6a(0x4d8));}}catch(_0x1d71f6){console[_0x5dae6a(0x1c1)](_0x5dae6a(0x11ca),_0x1d71f6),await _0x2fb06(_0x5dae6a(0x19f),_0x5dae6a(0x110)+_0x1d71f6[_0x5dae6a(0x4bc)]);}}async function _0x465501(_0x1fe449,_0x23315e){const _0x5617cc=_0x10a9,_0x528001=_0x23315e['replace'](/\.json$/i,''),_0x1632e6=await _0x231a5a('导入\x20Tavern\x20AI\x20世界书','请为这本设定集命名：',_0x528001);if(!_0x1632e6||!_0x1632e6[_0x5617cc(0xeb7)]()){alert(_0x5617cc(0xf6b));return;}const _0x377380=Object[_0x5617cc(0x4ca)](_0x1fe449[_0x5617cc(0x560)])[_0x5617cc(0x796)](_0x1e33c7=>{const _0x522577=_0x5617cc;return{'keys':_0x1e33c7['key']||[],'comment':_0x1e33c7[_0x522577(0xebd)]||_0x522577(0x350),'content':_0x1e33c7[_0x522577(0x9a5)]||'','enabled':!_0x1e33c7['disable']};})[_0x5617cc(0x138)](_0x11c679=>_0x11c679['content']);if(_0x377380['length']===0x0){alert('这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。');return;}const _0x260d47={'id':_0x5617cc(0x1105)+Date[_0x5617cc(0x1182)](),'name':_0x1632e6[_0x5617cc(0xeb7)](),'content':_0x377380,'categoryId':null};await _0x2e83f8[_0x5617cc(0xca)][_0x5617cc(0x252)](_0x260d47),_0x5de8b7[_0x5617cc(0xca)]['push'](_0x260d47),await _0x570ac2(),await _0x2fb06(_0x5617cc(0x9f8),_0x5617cc(0xee4)+_0x1632e6+'》。');}async function _0x1fabe1(){const _0x981e9d=_0x10a9;try{const _0x1ed23c=await _0x2e83f8['worldBooks'][_0x981e9d(0x508)](),_0x20603e=await _0x2e83f8[_0x981e9d(0xaac)][_0x981e9d(0x508)]();if(_0x1ed23c['length']===0x0&&_0x20603e[_0x981e9d(0x594)]===0x0){alert(_0x981e9d(0x12bb));return;}const _0x2562b5={'type':_0x981e9d(0x129),'version':0x1,'timestamp':Date[_0x981e9d(0x1182)](),'books':_0x1ed23c,'categories':_0x20603e},_0x1bff32=new Blob([JSON['stringify'](_0x2562b5,null,0x2)],{'type':_0x981e9d(0x35c)}),_0x5656a0=URL['createObjectURL'](_0x1bff32),_0x9c6362=document['createElement']('a');_0x9c6362[_0x981e9d(0x125b)]=_0x5656a0,_0x9c6362['download']=_0x981e9d(0xfb9)+new Date()[_0x981e9d(0xda)]()['split']('T')[0x0]+_0x981e9d(0xfc4),_0x9c6362['click'](),URL[_0x981e9d(0xa02)](_0x5656a0),await _0x2fb06(_0x981e9d(0x799),'所有世界书数据已成功导出！');}catch(_0x575c77){console['error'](_0x981e9d(0xbf6),_0x575c77),await _0x2fb06('导出失败','发生了一个错误:\x20'+_0x575c77['message']);}}async function _0x12a814(_0x21839b){const _0x43493e=_0x10a9;try{if(_0x21839b[_0x43493e(0xa20)]!==_0x43493e(0x129)||!_0x21839b[_0x43493e(0x324)])throw new Error(_0x43493e(0x3f2));const _0xe7f690=await _0x58fd60('导入世界书',_0x43493e(0x5a4),{'confirmButtonClass':_0x43493e(0x8a6),'confirmText':_0x43493e(0x937)});if(!_0xe7f690)return;await _0x2e83f8[_0x43493e(0x1272)]('rw',_0x2e83f8[_0x43493e(0xca)],_0x2e83f8['worldBookCategories'],async()=>{const _0x56807d=_0x43493e;await _0x2e83f8[_0x56807d(0xca)][_0x56807d(0x7ab)](),await _0x2e83f8['worldBookCategories'][_0x56807d(0x7ab)](),Array[_0x56807d(0xb7b)](_0x21839b[_0x56807d(0x324)])&&await _0x2e83f8['worldBooks'][_0x56807d(0xd72)](_0x21839b[_0x56807d(0x324)]),Array[_0x56807d(0xb7b)](_0x21839b[_0x56807d(0x263)])&&await _0x2e83f8[_0x56807d(0xaac)]['bulkPut'](_0x21839b[_0x56807d(0x263)]);}),_0x5de8b7['worldBooks']=await _0x2e83f8[_0x43493e(0xca)][_0x43493e(0x508)](),await _0x570ac2(),await _0x2fb06(_0x43493e(0xb5e),'世界书数据已成功恢复！');}catch(_0x431ba6){console[_0x43493e(0x1c1)](_0x43493e(0x11ca),_0x431ba6),await _0x2fb06('导入失败','文件解析或应用失败:\x20'+_0x431ba6[_0x43493e(0x4bc)]);}}const _0x48afd4=localStorage[_0x47aceb(0x728)](_0x47aceb(0x4a6));if(_0x48afd4){const _0x1d3b7a=(Date[_0x47aceb(0x1182)]()-parseInt(_0x48afd4))/(0x3e8*0x3c);_0x1d3b7a>0x5&&_0x17aadf(_0x1d3b7a);}_0x56e774(),window[_0x47aceb(0x859)]=_0x4e7698,window[_0x47aceb(0x10f1)]=_0x27576b,window[_0x47aceb(0xdbc)]=_0x3c5a85,window[_0x47aceb(0x6e5)]=_0x5605c3,window[_0x47aceb(0xa31)]=_0x309134,window[_0x47aceb(0x7a1)]=_0xb12251,window[_0x47aceb(0xd2)]=_0x12eb6b,window[_0x47aceb(0xf23)]=_0x29e75d,window[_0x47aceb(0x91f)]=_0x5ba41b;const _0x55116c=document['createElement'](_0x47aceb(0x1285));_0x55116c['id']=_0x47aceb(0xc32),_0x55116c[_0x47aceb(0x595)]=_0x47aceb(0x51c),document[_0x47aceb(0x11e3)](_0x47aceb(0x6fd))[_0x47aceb(0x120c)](_0x55116c);const _0x399bd2=document['createElement'](_0x47aceb(0x794));_0x399bd2['id']=_0x47aceb(0x3d6),document[_0x47aceb(0x10ad)]['appendChild'](_0x399bd2),_0x29da69[_0x47aceb(0x7a8)]=document[_0x47aceb(0x11e3)](_0x47aceb(0xc6)),_0x29da69[_0x47aceb(0x8df)]=document['getElementById'](_0x47aceb(0x12ab));const _0x2584ea=localStorage[_0x47aceb(0x728)](_0x47aceb(0x3c7))||_0x47aceb(0xdf8);_0x43fa3c(_0x2584ea);const _0x3bad34=document['createElement'](_0x47aceb(0x794));_0x3bad34['id']=_0x47aceb(0x3d8),document[_0x47aceb(0x10ad)][_0x47aceb(0x120c)](_0x3bad34);const _0x467bd6=document[_0x47aceb(0x383)](_0x47aceb(0x794));_0x467bd6['id']='preview-bubble-style',document['head']['appendChild'](_0x467bd6),_0x5a313a('',_0x47aceb(0x874),_0x47aceb(0x3d8)),_0x5a313a('','#settings-preview-area','preview-bubble-style'),window[_0x47aceb(0x10f1)]=_0x27576b,window[_0x47aceb(0x859)]=_0x4e7698,window[_0x47aceb(0x9d3)]=_0x5ee219,window['renderApiSettingsProxy']=_0x41d5c7,window[_0x47aceb(0x10a9)]=_0x1f90a4,window[_0x47aceb(0xd0f)]=_0x570ac2,await _0x344e71(),_0x2d3a77(),await _0x2c57e4(),_0x1a2892(_0x5de8b7[_0x47aceb(0x2df)][_0x47aceb(0x691)]);const _0x3e8dbb=parseInt(localStorage[_0x47aceb(0x728)](_0x47aceb(0x46a)))||0x0;_0x22db5e(_0x3e8dbb);_0x5de8b7[_0x47aceb(0x2df)]&&_0x5de8b7[_0x47aceb(0x2df)][_0x47aceb(0xcd8)]&&_0x58687c(_0x5de8b7[_0x47aceb(0x2df)][_0x47aceb(0xcd8)]);_0x2b6a0d(),setInterval(_0x2b6a0d,0x3e8*0x1e),_0x34145f(),_0x279b7a(),_0x40cea2(),_0xecbef(),document['getElementById']('rules-tabs')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x141b96=>{const _0x15837f=_0x47aceb;_0x141b96['target']['classList'][_0x15837f(0x1121)]('rules-tab')&&_0x57f501(_0x141b96[_0x15837f(0xd7c)][_0x15837f(0xaca)][_0x15837f(0x9ee)]);}),document[_0x47aceb(0x11e3)](_0x47aceb(0x42b))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>_0x18a503(null)),document[_0x47aceb(0x11e3)](_0x47aceb(0x876))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x573210=_0x47aceb;document['getElementById']('rule-editor-modal')[_0x573210(0x505)]['remove']('visible');}),document[_0x47aceb(0x11e3)](_0x47aceb(0x4ec))[_0x47aceb(0x4b8)]('click',_0x51837b),document['getElementById']('pat-btn')[_0x47aceb(0x4b8)]('click',()=>{const _0x380d5a=_0x47aceb;if(_0x5de8b7[_0x380d5a(0x93d)]&&!_0x5de8b7[_0x380d5a(0x737)][_0x5de8b7[_0x380d5a(0x93d)]][_0x380d5a(0x1244)]){const _0x1d7e62=_0x5de8b7[_0x380d5a(0x737)][_0x5de8b7['activeChatId']];_0x5be23d(_0x1d7e62['id'],_0x1d7e62['originalName']);}});let _0x17542a=null;function _0x3bea22(_0x3ee844){const _0x5b9604=_0x47aceb;_0x17542a=_0x3ee844;const _0x526af0=_0x5de8b7[_0x5b9604(0x737)][_0x5de8b7[_0x5b9604(0x93d)]],_0x5a4d77=_0x526af0[_0x5b9604(0x286)][_0x5b9604(0xe79)](_0x26d93c=>_0x26d93c['id']===_0x3ee844);if(!_0x5a4d77)return;const _0x81344f=document[_0x5b9604(0x11e3)](_0x5b9604(0x602));_0x81344f[_0x5b9604(0x300)]=_0x5a4d77[_0x5b9604(0x8ac)]?_0x5b9604(0x439):'置顶公告',document[_0x5b9604(0x11e3)](_0x5b9604(0x8f4))[_0x5b9604(0x505)][_0x5b9604(0x252)](_0x5b9604(0x250));}async function _0x2c3606(){const _0x556676=_0x47aceb;if(!_0x17542a)return;const _0x4d1c18=_0x5de8b7[_0x556676(0x737)][_0x5de8b7[_0x556676(0x93d)]],_0x4b8aae=_0x4d1c18[_0x556676(0x286)][_0x556676(0xe79)](_0x1fcec6=>_0x1fcec6['id']===_0x17542a);_0x4b8aae&&(_0x4b8aae[_0x556676(0x8ac)]=!_0x4b8aae[_0x556676(0x8ac)],await _0x2e83f8[_0x556676(0x737)]['put'](_0x4d1c18),_0x26553f()),document[_0x556676(0x11e3)](_0x556676(0x8f4))['classList'][_0x556676(0x957)](_0x556676(0x250));}async function _0xff4edc(){const _0xfde99d=_0x47aceb;if(!_0x17542a)return;const _0x56bdd0=await _0x58fd60(_0xfde99d(0x1166),_0xfde99d(0x1001),{'confirmButtonClass':_0xfde99d(0x8a6)});if(_0x56bdd0){const _0x201a62=_0x5de8b7['chats'][_0x5de8b7[_0xfde99d(0x93d)]];_0x201a62[_0xfde99d(0x286)]=_0x201a62['announcements'][_0xfde99d(0x138)](_0x320520=>_0x320520['id']!==_0x17542a),await _0x2e83f8[_0xfde99d(0x737)]['put'](_0x201a62),_0x26553f();}document['getElementById']('announcement-actions-modal')['classList'][_0xfde99d(0x957)](_0xfde99d(0x250));}document[_0x47aceb(0x11e3)]('custom-modal-cancel')[_0x47aceb(0x4b8)]('click',_0x225a39),document[_0x47aceb(0x11e3)](_0x47aceb(0x121c))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2dee84=>{const _0x3a6516=_0x47aceb;if(_0x2dee84[_0x3a6516(0xd7c)]===_0x533d18)_0x225a39();}),document['getElementById'](_0x47aceb(0x3b0))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x4e2fa9=_0x47aceb,_0x322eb4=await _0x16a8e1(_0x4e2fa9(0xa48),[{'text':_0x4e2fa9(0xddd),'value':_0x4e2fa9(0xab6)},{'text':_0x4e2fa9(0x127b),'value':'blob'}]);if(_0x322eb4===_0x4e2fa9(0xab6))_0xe491c9();else _0x322eb4==='blob'&&_0x4de534();}),document[_0x47aceb(0x11e3)](_0x47aceb(0x215))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x4e0163),document[_0x47aceb(0x11e3)](_0x47aceb(0x109))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x9ca0f2=>{const _0xb02a2e=_0x47aceb;document[_0xb02a2e(0x11e3)](_0xb02a2e(0x235))[_0xb02a2e(0x794)]['display']=_0x9ca0f2['target'][_0xb02a2e(0x3e4)]?_0xb02a2e(0x11ac):_0xb02a2e(0x379);}),document['getElementById'](_0x47aceb(0x55b))[_0x47aceb(0x4b8)]('click',()=>document[_0x47aceb(0x11e3)](_0x47aceb(0x8db))[_0x47aceb(0x1041)]()),document[_0x47aceb(0x11e3)](_0x47aceb(0x609))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x405228=>{const _0x972ac2=_0x47aceb;document['getElementById'](_0x972ac2(0xf8))[_0x972ac2(0x794)][_0x972ac2(0x33d)]=_0x405228[_0x972ac2(0xd7c)][_0x972ac2(0x3e4)]?'block':_0x972ac2(0x379);}),document['getElementById'](_0x47aceb(0x8db))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x82b34f=>_0x4aaa49(_0x82b34f[_0x47aceb(0xd7c)][_0x47aceb(0x5c9)][0x0])),document[_0x47aceb(0x11e3)](_0x47aceb(0xeb6))['addEventListener']('change',_0x35d99e),document['getElementById'](_0x47aceb(0x5c4))['addEventListener'](_0x47aceb(0x1041),()=>{const _0xc4cacf=_0x47aceb;_0x5aa3cf={},_0x5a313a('','#chat-messages',_0xc4cacf(0x3d8)),_0x5a313a('','#settings-preview-area',_0xc4cacf(0xfbc)),_0x2192b8(),_0x5de8b7[_0xc4cacf(0x93d)]=null,_0x4e7698(_0xc4cacf(0xf1e));}),document[_0x47aceb(0x11e3)]('add-chat-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x715d56=_0x47aceb,_0x5dee11=await _0x16a8e1('创建新聊天',[{'text':'手动创建角色','value':_0x715d56(0x112e)},{'text':_0x715d56(0xa38),'value':_0x715d56(0x868)}]);if(_0x5dee11===_0x715d56(0x112e)){const _0x48cbb0=await _0x231a5a(_0x715d56(0x990),_0x715d56(0x12a7));if(!_0x48cbb0||!_0x48cbb0[_0x715d56(0xeb7)]())return;const _0x3107e1=await _0x231a5a(_0x715d56(0x711),_0x715d56(0x917));if(!_0x3107e1||!_0x3107e1['trim']())return;const _0x2de0c5=_0x715d56(0x1ae)+Date[_0x715d56(0x1182)](),_0x164c26={'id':_0x2de0c5,'name':_0x48cbb0[_0x715d56(0xeb7)](),'originalName':_0x3107e1['trim'](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':_0x715d56(0xe62),'blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date[_0x715d56(0x1182)](),'isBusy':![]},'settings':{'aiPersona':'这是一个通过手动创建的角色。','myPersona':_0x715d56(0x85e),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x3d2e44,'myAvatar':_0x3d2e44,'background':'','theme':_0x715d56(0xd3),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':_0x715d56(0xaf7)},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x5de8b7['chats'][_0x2de0c5]=_0x164c26,await _0x2e83f8[_0x715d56(0x737)][_0x715d56(0xe3c)](_0x164c26),_0x5ee219();}else _0x5dee11==='import_card'&&document[_0x715d56(0x11e3)](_0x715d56(0xeb6))['click']();}),document[_0x47aceb(0x11e3)](_0x47aceb(0x2c0))[_0x47aceb(0x4b8)]('click',_0x39aa6a),document[_0x47aceb(0x11e3)](_0x47aceb(0xc2e))[_0x47aceb(0x4b8)]('click',()=>document['getElementById'](_0x47aceb(0x2f3))['classList'][_0x47aceb(0x957)](_0x47aceb(0x250))),document[_0x47aceb(0x11e3)](_0x47aceb(0x93c))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x4d49b4),document[_0x47aceb(0x11e3)](_0x47aceb(0xa14))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x3c5a85),document[_0x47aceb(0x11e3)](_0x47aceb(0xd9c))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>_0x48cc94(!![])),document[_0x47aceb(0x11e3)]('music-return-btn')[_0x47aceb(0x4b8)]('click',_0x366f7e),document[_0x47aceb(0x11e3)](_0x47aceb(0xf5d))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x526dbe),document[_0x47aceb(0x11e3)](_0x47aceb(0x12d2))['addEventListener'](_0x47aceb(0x1041),_0x352010),document[_0x47aceb(0x11e3)](_0x47aceb(0xa84))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x30a4d5),document[_0x47aceb(0x11e3)]('music-mode-btn')['addEventListener']('click',_0x3085f2),document['getElementById'](_0x47aceb(0xecd))[_0x47aceb(0x4b8)]('click',()=>{const _0x59a9c8=_0x47aceb;_0x31e1af(),document[_0x59a9c8(0x11e3)]('music-playlist-panel')[_0x59a9c8(0x505)][_0x59a9c8(0x252)](_0x59a9c8(0x250));}),document['getElementById'](_0x47aceb(0x464))['addEventListener'](_0x47aceb(0x1041),()=>document['getElementById'](_0x47aceb(0x7ad))[_0x47aceb(0x505)][_0x47aceb(0x957)](_0x47aceb(0x250))),document[_0x47aceb(0x11e3)](_0x47aceb(0xfec))[_0x47aceb(0x4b8)]('click',_0x54f4bb),document[_0x47aceb(0x11e3)](_0x47aceb(0x722))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>document[_0x47aceb(0x11e3)](_0x47aceb(0x4d5))[_0x47aceb(0x1041)]()),document[_0x47aceb(0x11e3)]('local-song-upload-input')[_0x47aceb(0x4b8)]('change',_0x274cd7),document[_0x47aceb(0x11e3)](_0x47aceb(0xfe6))['addEventListener']('click',_0x29637e=>{const _0x1e2bdd=_0x47aceb,_0x23df24=_0x29637e[_0x1e2bdd(0xd7c)],_0x1cbb1a=parseInt(_0x23df24[_0x1e2bdd(0xaca)]['index']);if(isNaN(_0x1cbb1a))return;if(_0x23df24[_0x1e2bdd(0x505)][_0x1e2bdd(0x1121)](_0x1e2bdd(0xa98)))_0x3e7d39(_0x1cbb1a);else{if(_0x23df24[_0x1e2bdd(0x505)]['contains'](_0x1e2bdd(0xa26)))_0x2992b4(_0x1cbb1a);else{if(_0x23df24['classList']['contains']('bg-btn'))_0x129b6(_0x1cbb1a);else _0x23df24['classList'][_0x1e2bdd(0x1121)](_0x1e2bdd(0xde3))&&_0x126e32(_0x1cbb1a);}}}),_0x7cf0d1[_0x47aceb(0x4b8)](_0x47aceb(0x12c3),()=>{const _0x27c582=_0x47aceb;document['getElementById'](_0x27c582(0xf0c))[_0x27c582(0x505)][_0x27c582(0x957)](_0x27c582(0x485)),_0x352010();});const _0x85e8b=document[_0x47aceb(0x11e3)](_0x47aceb(0x803));document[_0x47aceb(0x11e3)](_0x47aceb(0x39a))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x33234d=_0x47aceb;_0x3f8b63();const _0x190706=_0x85e8b[_0x33234d(0xf27)][_0x33234d(0xeb7)]();if(!_0x190706||!_0x5de8b7[_0x33234d(0x93d)])return;const _0x1d4ac1=_0x5de8b7['chats'][_0x5de8b7['activeChatId']],_0x4c9917={'role':'user','content':_0x190706,'timestamp':Date[_0x33234d(0x1182)]()};_0x1ad8ed&&(_0x4c9917[_0x33234d(0xb9)]=_0x1ad8ed),_0x3b5153(_0x4c9917,_0x1d4ac1),((async()=>{const _0x5befb8=_0x33234d;_0x1d4ac1[_0x5befb8(0x49e)][_0x5befb8(0xf5)](_0x4c9917),await _0x2e83f8[_0x5befb8(0x737)][_0x5befb8(0xe3c)](_0x1d4ac1),_0x5ee219();})()),_0x85e8b[_0x33234d(0xf27)]='',_0x85e8b[_0x33234d(0x794)][_0x33234d(0x10f2)]='auto',_0x85e8b['focus'](),_0x1f4563();}),document[_0x47aceb(0x11e3)](_0x47aceb(0xb72))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x14a9f0),_0x85e8b[_0x47aceb(0x4b8)]('keypress',_0x498cf7=>{const _0x425f1f=_0x47aceb;_0x498cf7[_0x425f1f(0xb8c)]===_0x425f1f(0xd01)&&!_0x498cf7[_0x425f1f(0x4d6)]&&(_0x498cf7[_0x425f1f(0xf87)](),document['getElementById'](_0x425f1f(0x39a))[_0x425f1f(0x1041)]());}),document[_0x47aceb(0x11e3)](_0x47aceb(0x60d))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),async _0x4b8ac2=>{const _0x1797e4=_0x47aceb,_0x13739d=_0x4b8ac2[_0x1797e4(0xd7c)][_0x1797e4(0x5c9)][0x0];if(_0x13739d){const _0x5761c8=await new Promise((_0xdb8d85,_0x2eea56)=>{const _0x359c50=_0x1797e4,_0xfcaeaa=new FileReader();_0xfcaeaa[_0x359c50(0x1e5)]=()=>_0xdb8d85(_0xfcaeaa[_0x359c50(0x255)]),_0xfcaeaa[_0x359c50(0x741)]=()=>_0x2eea56(_0xfcaeaa['error']),_0xfcaeaa[_0x359c50(0x1270)](_0x13739d);});_0x336b5e=_0x5761c8,_0x1f90a4();}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x4f0))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x3d2b15=_0x47aceb;_0x336b5e&&(_0x5de8b7[_0x3d2b15(0x2df)]['wallpaper']=_0x336b5e),_0x5de8b7[_0x3d2b15(0x2df)][_0x3d2b15(0x691)]=document[_0x3d2b15(0x11e3)](_0x3d2b15(0x434))[_0x3d2b15(0xf27)][_0x3d2b15(0xeb7)](),_0x5de8b7[_0x3d2b15(0x2df)][_0x3d2b15(0x688)]=document[_0x3d2b15(0x11e3)](_0x3d2b15(0x16d))[_0x3d2b15(0xf27)][_0x3d2b15(0xeb7)](),_0x5de8b7[_0x3d2b15(0x2df)]['showStatusBar']=document[_0x3d2b15(0x11e3)](_0x3d2b15(0xb5))[_0x3d2b15(0x3e4)],await _0x2e83f8[_0x3d2b15(0x2df)][_0x3d2b15(0xe3c)](_0x5de8b7[_0x3d2b15(0x2df)]),_0x34145f(),_0x4a28b8(),_0x336b5e=null,_0x40cea2(),_0x3f2530(),_0x1a2892(_0x5de8b7[_0x3d2b15(0x2df)]['globalCss']),_0x2d3a77(),alert('外观设置已保存并应用！'),_0x4e7698('home-screen');});const _0x46f4a5=document[_0x47aceb(0x11e3)](_0x47aceb(0xde));_0x46f4a5[_0x47aceb(0x4b8)](_0x47aceb(0x11a9),()=>{const {scrollTop:_0x436283,scrollHeight:_0x528966,clientHeight:_0x657f78}=_0x46f4a5;_0x528966-_0x436283-_0x657f78<_0x657f78&&(!_0x50f724&&_0x27e6c9());}),document[_0x47aceb(0x11e3)](_0x47aceb(0x5b8))['addEventListener'](_0x47aceb(0x1041),async()=>{const _0x54dabc=_0x47aceb;_0x5de8b7['apiConfig'][_0x54dabc(0xa60)]=document['getElementById'](_0x54dabc(0x92f))[_0x54dabc(0xf27)]['trim'](),_0x5de8b7[_0x54dabc(0x89c)][_0x54dabc(0xebb)]=document[_0x54dabc(0x11e3)](_0x54dabc(0xb1e))['value']['trim'](),_0x5de8b7[_0x54dabc(0x89c)]['model']=document['getElementById'](_0x54dabc(0x19d))[_0x54dabc(0xf27)],_0x5de8b7[_0x54dabc(0x89c)][_0x54dabc(0x420)]=document[_0x54dabc(0x11e3)](_0x54dabc(0x348))[_0x54dabc(0xf27)]['trim'](),_0x5de8b7[_0x54dabc(0x89c)][_0x54dabc(0x24d)]=document[_0x54dabc(0x11e3)](_0x54dabc(0x8b4))['value']['trim'](),_0x5de8b7[_0x54dabc(0x89c)][_0x54dabc(0xd62)]=document['getElementById'](_0x54dabc(0x11ff))[_0x54dabc(0xf27)],_0x5de8b7['apiConfig'][_0x54dabc(0x13c)]=document['getElementById']('secondary-proxy-url')[_0x54dabc(0xf27)][_0x54dabc(0xeb7)](),_0x5de8b7[_0x54dabc(0x89c)][_0x54dabc(0xb05)]=document[_0x54dabc(0x11e3)](_0x54dabc(0x5b2))[_0x54dabc(0xf27)][_0x54dabc(0xeb7)](),_0x5de8b7['apiConfig'][_0x54dabc(0xe1b)]=document['getElementById'](_0x54dabc(0x1191))['value'],await _0x2e83f8[_0x54dabc(0x89c)][_0x54dabc(0xe3c)](_0x5de8b7[_0x54dabc(0x89c)]);const _0x34e3d8=document['getElementById'](_0x54dabc(0xbe4)),_0x48fc0e=document[_0x54dabc(0x11e3)](_0x54dabc(0x119b)),_0x1a180a=document['getElementById'](_0x54dabc(0xc95));_0x5de8b7['globalSettings']['enableBackgroundActivity']=_0x34e3d8[_0x54dabc(0x3e4)],_0x5de8b7[_0x54dabc(0x2df)][_0x54dabc(0x1f6)]=parseInt(_0x48fc0e[_0x54dabc(0xf27)])||0x3c,_0x5de8b7[_0x54dabc(0x2df)]['blockCooldownHours']=parseFloat(_0x1a180a[_0x54dabc(0xf27)])||0x1,_0x5de8b7[_0x54dabc(0x2df)]['enableAiDrawing']=document[_0x54dabc(0x11e3)](_0x54dabc(0x61a))[_0x54dabc(0x3e4)],_0x5de8b7[_0x54dabc(0x2df)][_0x54dabc(0x896)]=parseInt(document[_0x54dabc(0x11e3)](_0x54dabc(0x4d2))[_0x54dabc(0xf27)])||0x32,_0x5de8b7[_0x54dabc(0x2df)][_0x54dabc(0xd0)]=parseInt(document[_0x54dabc(0x11e3)]('chat-list-render-window-input')[_0x54dabc(0xf27)])||0x1e,_0x5de8b7[_0x54dabc(0x2df)][_0x54dabc(0xe66)]=parseFloat(document['getElementById'](_0x54dabc(0x125e))[_0x54dabc(0xf27)]),await _0x2e83f8[_0x54dabc(0x2df)][_0x54dabc(0xe3c)](_0x5de8b7[_0x54dabc(0x2df)]),_0x3a0e97();_0x5de8b7[_0x54dabc(0x2df)][_0x54dabc(0xa99)]?(_0x424da7(),console[_0x54dabc(0x84b)](_0x54dabc(0xfff)+_0x5de8b7[_0x54dabc(0x2df)][_0x54dabc(0x1f6)]+'秒')):console[_0x54dabc(0x84b)](_0x54dabc(0x524));const _0x768b1a=document[_0x54dabc(0x11e3)](_0x54dabc(0x41e))['checked'],_0x4519bb=document[_0x54dabc(0x11e3)](_0x54dabc(0xb15))[_0x54dabc(0xf27)],_0x5a118f=document[_0x54dabc(0x11e3)](_0x54dabc(0xa09))[_0x54dabc(0xf27)][_0x54dabc(0xeb7)]();localStorage[_0x54dabc(0x3b2)](_0x54dabc(0x1153),_0x768b1a),localStorage[_0x54dabc(0x3b2)](_0x54dabc(0xb15),_0x4519bb),localStorage['setItem']('novelai-api-key',_0x5a118f),alert(_0x54dabc(0xdb));});const _0x56f992=document[_0x47aceb(0x11e3)](_0x47aceb(0xb1e));_0x56f992[_0x47aceb(0x4b8)](_0x47aceb(0xc1f),_0x17a8b1=>{const _0x441daf=_0x47aceb;_0x17a8b1['target'][_0x441daf(0xbf1)](_0x441daf(0xa20),_0x441daf(0x1197));}),_0x56f992[_0x47aceb(0x4b8)](_0x47aceb(0x1053),_0x580a85=>{const _0x767fec=_0x47aceb;_0x580a85[_0x767fec(0xd7c)][_0x767fec(0xbf1)](_0x767fec(0xa20),'password');});async function _0x377d78(_0xdbc054,_0x5c731d,_0x420310){const _0x28ea24=_0x47aceb,_0x3126e2=document[_0x28ea24(0x11e3)](_0xdbc054)[_0x28ea24(0xf27)][_0x28ea24(0xeb7)](),_0x4365a3=document[_0x28ea24(0x11e3)](_0x5c731d)['value']['trim']();if(!_0x3126e2||!_0x4365a3)return alert('请先填写对应的反代地址和密钥');try{let _0x291292=_0x3126e2===GEMINI_API_URL;const _0x297c50=await fetch(_0x291292?GEMINI_API_URL+_0x28ea24(0x112c)+getRandomValue(_0x4365a3):_0x3126e2+_0x28ea24(0xde7),_0x291292?undefined:{'headers':{'Authorization':_0x28ea24(0xdaf)+_0x4365a3}});if(!_0x297c50['ok'])throw new Error(_0x28ea24(0x3e0));const _0x30bf36=await _0x297c50['json']();let _0x2e2ff2=_0x291292?_0x30bf36[_0x28ea24(0xefd)][_0x28ea24(0x796)](_0x3a48f5=>({'id':_0x3a48f5['name'][_0x28ea24(0x65b)]('/')[0x1]||_0x3a48f5['name']})):_0x30bf36['data'];const _0x5645c9=document['getElementById'](_0x420310);_0x5645c9['innerHTML']='';const _0x33f477=_0x420310===_0x28ea24(0x19d)?_0x5de8b7[_0x28ea24(0x89c)][_0x28ea24(0x130a)]:_0x5de8b7[_0x28ea24(0x89c)][_0x28ea24(0xe1b)];_0x2e2ff2['forEach'](_0x44607c=>{const _0xd89ae4=_0x28ea24,_0x48920d=document[_0xd89ae4(0x383)](_0xd89ae4(0xd91));_0x48920d[_0xd89ae4(0xf27)]=_0x44607c['id'],_0x48920d[_0xd89ae4(0x300)]=_0x44607c['id'];if(_0x44607c['id']===_0x33f477)_0x48920d[_0xd89ae4(0xbbc)]=!![];_0x5645c9[_0xd89ae4(0x120c)](_0x48920d);}),alert(_0x28ea24(0xcbb));}catch(_0x218cb8){alert(_0x28ea24(0xed)+_0x218cb8[_0x28ea24(0x4bc)]);}}document['getElementById'](_0x47aceb(0x642))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x3a57e3=_0x47aceb;_0x377d78(_0x3a57e3(0x92f),_0x3a57e3(0xb1e),_0x3a57e3(0x19d));}),document[_0x47aceb(0x11e3)](_0x47aceb(0xa73))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x1cca58=_0x47aceb;_0x377d78(_0x1cca58(0x1ef),_0x1cca58(0x5b2),_0x1cca58(0x1191));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x1048))['addEventListener']('click',async()=>{const _0xcc9ca6=_0x47aceb,_0x12bf65=await _0x231a5a('创建世界书','请输入书名');if(_0x12bf65&&_0x12bf65[_0xcc9ca6(0xeb7)]()){const _0x2a8f76={'id':'wb_'+Date['now'](),'name':_0x12bf65[_0xcc9ca6(0xeb7)](),'content':''};await _0x2e83f8[_0xcc9ca6(0xca)][_0xcc9ca6(0x252)](_0x2a8f76),_0x5de8b7[_0xcc9ca6(0xca)][_0xcc9ca6(0xf5)](_0x2a8f76),_0x570ac2(),_0x5b1bfb(_0x2a8f76['id']);}}),document[_0x47aceb(0x11e3)](_0x47aceb(0xda8))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x49c486=_0x47aceb;if(!_0x3bebd3)return;const _0x52fd7d=_0x5de8b7['worldBooks'][_0x49c486(0xe79)](_0x288de9=>_0x288de9['id']===_0x3bebd3);if(!_0x52fd7d)return;const _0x814600=document[_0x49c486(0x11e3)](_0x49c486(0xc79))[_0x49c486(0xf27)]['trim']();if(!_0x814600){alert(_0x49c486(0x9e1));return;}_0x52fd7d[_0x49c486(0x278)]=_0x814600;const _0x50bb34=document[_0x49c486(0x11e3)](_0x49c486(0xf34))['value'];_0x52fd7d[_0x49c486(0x9ee)]=_0x50bb34?parseInt(_0x50bb34):null;const _0x5252fc=document[_0x49c486(0x11e3)](_0x49c486(0x24b)),_0x5871f8=_0x5252fc[_0x49c486(0x10d6)](_0x49c486(0xdba)),_0x5d4087=[];_0x5871f8[_0x49c486(0x494)](_0x56b4e5=>{const _0x18bf24=_0x49c486,_0x4d06e1=_0x56b4e5[_0x18bf24(0x5ac)](_0x18bf24(0x6bf))[_0x18bf24(0xf27)][_0x18bf24(0xeb7)](),_0x1505c9=_0x56b4e5[_0x18bf24(0x5ac)](_0x18bf24(0xb53))[_0x18bf24(0xf27)][_0x18bf24(0xeb7)](),_0x4ddc26=_0x56b4e5['querySelector'](_0x18bf24(0x8d8))[_0x18bf24(0x3e4)];_0x1505c9&&_0x5d4087['push']({'comment':_0x56b4e5[_0x18bf24(0x5ac)](_0x18bf24(0xe60))[_0x18bf24(0xf27)]['trim'](),'keys':_0x4d06e1?_0x4d06e1[_0x18bf24(0x65b)](',')['map'](_0x4854f9=>_0x4854f9[_0x18bf24(0xeb7)]())[_0x18bf24(0x138)](_0x5318fb=>_0x5318fb):[],'content':_0x1505c9,'enabled':_0x4ddc26});}),_0x52fd7d[_0x49c486(0x9a5)]=_0x5d4087,await _0x2e83f8[_0x49c486(0xca)][_0x49c486(0xe3c)](_0x52fd7d),document['getElementById'](_0x49c486(0x4c9))[_0x49c486(0x300)]=_0x814600,_0x3bebd3=null,_0x4e7698(_0x49c486(0x474)),await _0x570ac2();}),document[_0x47aceb(0x11e3)](_0x47aceb(0xc9d))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async _0x544fc7=>{const _0x44f15b=_0x47aceb,_0x556d20=_0x544fc7['target'][_0x44f15b(0xfe1)]('.voice-message-body[data-text]');if(_0x556d20){const _0x12ed86=_0x5de8b7[_0x44f15b(0x737)][_0x5de8b7[_0x44f15b(0x93d)]];if(!_0x12ed86)return;_0x1b89c3(_0x556d20);const _0x649cc4=_0x556d20[_0x44f15b(0xfe1)](_0x44f15b(0x6a9)),_0x20cc95=_0x649cc4?_0x649cc4['querySelector'](_0x44f15b(0x547)):null;if(_0x556d20[_0x44f15b(0xaca)][_0x44f15b(0xac6)]&&_0x20cc95&&_0x20cc95[_0x44f15b(0x794)][_0x44f15b(0x33d)]==='block'){if(_0x12ed86[_0x44f15b(0x1244)]){console[_0x44f15b(0x84b)]('这是一条群聊语音消息，已禁止发起TTS请求。');return;}if(_0x12ed86[_0x44f15b(0x761)][_0x44f15b(0x444)]===![]){console[_0x44f15b(0x84b)]('“'+_0x12ed86[_0x44f15b(0x278)]+_0x44f15b(0xf2e));return;}_0x3d3507(_0x556d20);}return;}const _0x5c007b=_0x544fc7[_0x44f15b(0xd7c)][_0x44f15b(0xfe1)](_0x44f15b(0xac1));if(_0x5c007b){const _0x58d824=_0x5c007b[_0x44f15b(0xfe1)](_0x44f15b(0x6a9));if(_0x58d824){const _0x1dc026=parseInt(_0x58d824['dataset']['timestamp']);if(!isNaN(_0x1dc026)){_0x56fe91(_0x1dc026);return;}}}const _0x3527a2=_0x544fc7['target'][_0x44f15b(0xfe1)](_0x44f15b(0xa5));if(_0x3527a2){const _0x211540=_0x3527a2[_0x44f15b(0xfe1)]('.message-bubble');if(_0x211540){const _0x7767b0=parseInt(_0x211540[_0x44f15b(0xaca)][_0x44f15b(0x702)]),_0x45330d=_0x3527a2['dataset'][_0x44f15b(0x70d)];if(!isNaN(_0x7767b0)&&_0x45330d){await _0x3e714f(_0x7767b0,_0x45330d);return;}}}const _0x774468=_0x544fc7[_0x44f15b(0xd7c)][_0x44f15b(0xfe1)](_0x44f15b(0xe90));if(_0x774468){const _0x1bd054=parseInt(_0x774468[_0x44f15b(0xaca)][_0x44f15b(0x2f0)]);if(!isNaN(_0x1bd054)){const _0x5bb545=await _0x2e83f8['qzonePosts'][_0x44f15b(0x1289)](_0x1bd054);if(_0x5bb545){let _0x4acebc='';const _0x52e170=_0x5bb545[_0x44f15b(0x5d9)]===_0x44f15b(0x21c)?_0x5de8b7['qzoneSettings']['nickname']:_0x5de8b7['chats'][_0x5bb545[_0x44f15b(0x5d9)]]?.['name']||_0x44f15b(0x1127);if(_0x5bb545[_0x44f15b(0xa20)]===_0x44f15b(0xc40))_0x4acebc=_0x5bb545[_0x44f15b(0x9a5)];else{_0x4acebc=_0x5bb545[_0x44f15b(0x12aa)]||'';if(_0x5bb545[_0x44f15b(0xf44)])_0x4acebc+=_0x44f15b(0xd9d);if(_0x5bb545['hiddenContent'])_0x4acebc+=_0x44f15b(0x7fd)+_0x5bb545['hiddenContent']+']';}_0x2fb06(_0x44f15b(0x1046)+_0x52e170+_0x44f15b(0x113a),_0x4acebc[_0x44f15b(0x1018)](/\n/g,_0x44f15b(0xf70)));}else _0x2fb06('提示',_0x44f15b(0x1238));}return;}const _0x29994d=_0x544fc7[_0x44f15b(0xd7c)][_0x44f15b(0xfe1)](_0x44f15b(0xadf));if(_0x29994d){const _0xd63298=_0x29994d[_0x44f15b(0xaca)][_0x44f15b(0x1029)];if(_0xd63298)_0x2fb06(_0x44f15b(0xa8),_0xd63298);return;}const _0x34e477=_0x544fc7['target'][_0x44f15b(0xfe1)](_0x44f15b(0x886));if(_0x34e477&&_0x34e477[_0x44f15b(0xaca)][_0x44f15b(0xc5d)]){const _0x6aaba0=parseInt(_0x34e477[_0x44f15b(0xaca)]['originalTimestamp']);!isNaN(_0x6aaba0)&&_0x2b137c(_0x6aaba0);}const _0x508cc4=_0x544fc7[_0x44f15b(0xd7c)][_0x44f15b(0xfe1)](_0x44f15b(0x1135));if(_0x508cc4){const _0x1a2ebc=_0x508cc4['closest'](_0x44f15b(0x6a9));_0x1a2ebc&&_0x1ffc2a(parseInt(_0x1a2ebc[_0x44f15b(0xaca)]['timestamp']));}const _0x12f3e8=_0x544fc7[_0x44f15b(0xd7c)][_0x44f15b(0xfe1)](_0x44f15b(0x1269));if(_0x12f3e8){const _0x1b4f82=_0x12f3e8['closest'](_0x44f15b(0x6a9));if(_0x1b4f82&&_0x1b4f82[_0x44f15b(0xaca)][_0x44f15b(0x702)]){const _0x423bff=parseInt(_0x1b4f82[_0x44f15b(0xaca)][_0x44f15b(0x702)]);_0x319222(_0x423bff);}}const _0x2043c6=_0x544fc7['target'][_0x44f15b(0xfe1)](_0x44f15b(0xb59));if(_0x2043c6){const _0x5ed84d=parseInt(_0x2043c6[_0x44f15b(0xaca)][_0x44f15b(0x840)]);if(isNaN(_0x5ed84d))return;const _0x47fa82=_0x544fc7['target'][_0x44f15b(0xfe1)](_0x44f15b(0x12ed));if(_0x47fa82&&!_0x2043c6[_0x44f15b(0x505)][_0x44f15b(0x1121)](_0x44f15b(0x1ed))){_0x2bb64b(_0x5ed84d,_0x47fa82[_0x44f15b(0xaca)]['option']);return;}const _0x24973c=_0x544fc7[_0x44f15b(0xd7c)][_0x44f15b(0xfe1)](_0x44f15b(0x55c));if(_0x24973c){_0x2043c6[_0x44f15b(0x505)]['contains']('closed')?_0xc52ad(_0x5ed84d):_0x54948(_0x5ed84d);return;}_0x2043c6['classList'][_0x44f15b(0x1121)]('closed')&&_0xc52ad(_0x5ed84d);}const _0x4a4452=_0x544fc7[_0x44f15b(0xd7c)][_0x44f15b(0xfe1)](_0x44f15b(0x6a0));if(_0x4a4452){const _0x247c3f=_0x5de8b7[_0x44f15b(0x737)][_0x5de8b7[_0x44f15b(0x93d)]],_0x391cb7=_0x4a4452['closest'](_0x44f15b(0xce));if(_0x247c3f&&_0x391cb7){const _0x51b80e=parseInt(_0x391cb7[_0x44f15b(0xaca)]['timestamp']),_0x5da064=_0x247c3f[_0x44f15b(0x49e)]['find'](_0x4d9b9d=>_0x4d9b9d['timestamp']===_0x51b80e);if(_0x5da064&&_0x5da064[_0x44f15b(0xae6)]){let _0x589379='';const _0x39b95b=_0x5da064[_0x44f15b(0xae6)];_0x39b95b[_0x44f15b(0x469)]===_0x44f15b(0x1197)?_0x589379=_0x44f15b(0x361)+_0x39b95b[_0x44f15b(0x5ab)]+'\x22':_0x589379=_0x44f15b(0x11a8)+_0x39b95b[_0x44f15b(0x469)]+']类型的消息',_0x2fb06(_0x44f15b(0x4ab),_0x589379);}}}const _0x3a5f9d=_0x544fc7[_0x44f15b(0xd7c)][_0x44f15b(0xfe1)]('.link-share-card');if(_0x3a5f9d&&_0x3a5f9d[_0x44f15b(0xfe1)](_0x44f15b(0xe26))){const _0x58a430=parseInt(_0x3a5f9d[_0x44f15b(0xaca)]['timestamp']);_0x389941(_0x58a430);}const _0x2944c4=_0x544fc7[_0x44f15b(0xd7c)]['closest']('.message-bubble');if(_0x2944c4&&_0x2944c4[_0x44f15b(0x505)]['contains']('ai')&&_0x2944c4[_0x44f15b(0x505)][_0x44f15b(0x1121)](_0x44f15b(0x10f9))&&_0x2944c4[_0x44f15b(0xaca)][_0x44f15b(0x739)]==='pending'){const _0x4fc3e8=parseInt(_0x2944c4[_0x44f15b(0xaca)][_0x44f15b(0x702)]);!isNaN(_0x4fc3e8)&&_0x520a19(_0x4fc3e8);}});const _0x542a85=document[_0x47aceb(0x11e3)](_0x47aceb(0x99b)),_0x767391=document['querySelector']('.custom-multiselect\x20.select-box'),_0x34a013=document[_0x47aceb(0x11e3)]('world-book-checkboxes-container');function _0x5326aa(){const _0x1ea3d1=_0x47aceb,_0x41020e=_0x34a013[_0x1ea3d1(0x10d6)]('input:checked'),_0x86f616=document[_0x1ea3d1(0x5ac)](_0x1ea3d1(0x755));if(_0x41020e[_0x1ea3d1(0x594)]===0x0)_0x86f616[_0x1ea3d1(0x300)]=_0x1ea3d1(0x139);else{if(_0x41020e[_0x1ea3d1(0x594)]>0x2)_0x86f616['textContent']=_0x1ea3d1(0xc61)+_0x41020e[_0x1ea3d1(0x594)]+_0x1ea3d1(0x12f0);else{const _0x13b174=Array[_0x1ea3d1(0xee2)](_0x41020e)[_0x1ea3d1(0x796)](_0x39b12f=>{const _0x44ecd2=_0x1ea3d1;return _0x39b12f[_0x44ecd2(0xd2d)]['textContent']['trim']();});_0x86f616[_0x1ea3d1(0x300)]=_0x13b174[_0x1ea3d1(0xa4b)](',\x20');}}}_0x767391[_0x47aceb(0x4b8)]('click',_0x3f8232=>{const _0x16d6bd=_0x47aceb;_0x3f8232['stopPropagation'](),_0x34a013[_0x16d6bd(0x505)]['toggle'](_0x16d6bd(0x250)),_0x767391[_0x16d6bd(0x505)][_0x16d6bd(0xe7e)](_0x16d6bd(0x123c));}),document[_0x47aceb(0x11e3)](_0x47aceb(0xa16))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x5326aa),window[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0xc916c5=>{const _0x14b415=_0x47aceb;!document['querySelector']('.custom-multiselect')[_0x14b415(0x1121)](_0xc916c5[_0x14b415(0xd7c)])&&(_0x34a013['classList'][_0x14b415(0x957)](_0x14b415(0x250)),_0x767391['classList'][_0x14b415(0x957)](_0x14b415(0x123c)));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x4bb))['addEventListener'](_0x47aceb(0x1041),async()=>{const _0x595fea=_0x47aceb;_0x354857();if(!_0x5de8b7[_0x595fea(0x93d)])return;const _0x367a7c=_0x5de8b7[_0x595fea(0x737)][_0x5de8b7[_0x595fea(0x93d)]],_0x529d6f=_0x367a7c[_0x595fea(0x1244)],_0x23af74=document[_0x595fea(0x11e3)](_0x595fea(0xc66));!_0x529d6f&&_0x367a7c[_0x595fea(0x761)][_0x595fea(0xa6b)]&&_0x367a7c['settings']['alternateGreetings'][_0x595fea(0x594)]>0x0?_0x23af74[_0x595fea(0x794)]['display']=_0x595fea(0x11ac):_0x23af74['style'][_0x595fea(0x33d)]=_0x595fea(0x379);document['getElementById'](_0x595fea(0x823))[_0x595fea(0x794)]['display']=_0x595fea(0x11ac),document[_0x595fea(0x11e3)](_0x595fea(0x3a2))[_0x595fea(0x794)]['display']=_0x595fea(0x11ac),document[_0x595fea(0x11e3)](_0x595fea(0x222))[_0x595fea(0x794)][_0x595fea(0x33d)]='block',document[_0x595fea(0x11e3)](_0x595fea(0xcc8))[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x529d6f?_0x595fea(0x11ac):_0x595fea(0x379),document[_0x595fea(0x11e3)](_0x595fea(0x77b))[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x529d6f?'none':_0x595fea(0x11ac),document['getElementById'](_0x595fea(0x969))[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x529d6f?_0x595fea(0x11ac):_0x595fea(0x379),document[_0x595fea(0x11e3)](_0x595fea(0x710))['style'][_0x595fea(0x33d)]=_0x529d6f?'block':_0x595fea(0x379),document[_0x595fea(0x11e3)](_0x595fea(0x2fb))[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x529d6f?_0x595fea(0x379):_0x595fea(0x11ac),document[_0x595fea(0x11e3)]('ai-avatar-group')[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x529d6f?_0x595fea(0x379):_0x595fea(0x11ac),document[_0x595fea(0x11e3)](_0x595fea(0xf04))['style'][_0x595fea(0x33d)]=_0x529d6f?_0x595fea(0x379):_0x595fea(0x11ac),document[_0x595fea(0x11e3)](_0x595fea(0x37f))[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x529d6f?_0x595fea(0x379):_0x595fea(0x11ac),document[_0x595fea(0x11e3)]('ai-voice-id-group')['style'][_0x595fea(0x33d)]=_0x529d6f?_0x595fea(0x379):'block',document[_0x595fea(0x11e3)](_0x595fea(0x78f))['style'][_0x595fea(0x33d)]=_0x529d6f?_0x595fea(0x379):_0x595fea(0x11ac),document[_0x595fea(0x11e3)](_0x595fea(0xaf5))['style'][_0x595fea(0x33d)]=_0x529d6f?_0x595fea(0x379):_0x595fea(0x11ac),document[_0x595fea(0x11e3)]('ai-cooldown-group')[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x529d6f?_0x595fea(0x379):_0x595fea(0x11ac),document[_0x595fea(0x11e3)](_0x595fea(0xd5c))[_0x595fea(0x794)]['display']=_0x529d6f?_0x595fea(0x11ac):_0x595fea(0x379),document['getElementById'](_0x595fea(0x1162))[_0x595fea(0xf27)]=_0x367a7c['name'],document[_0x595fea(0x11e3)]('my-persona')['value']=_0x367a7c[_0x595fea(0x761)][_0x595fea(0x10c5)],document[_0x595fea(0x11e3)](_0x595fea(0x8b3))[_0x595fea(0xf0a)]=_0x367a7c[_0x595fea(0x761)]['myAvatar']||(_0x529d6f?_0x30449f:_0x3d2e44),document[_0x595fea(0x11e3)]('max-memory')[_0x595fea(0xf27)]=_0x367a7c[_0x595fea(0x761)]['maxMemory'],document['getElementById'](_0x595fea(0xfce))['value']=_0x367a7c[_0x595fea(0x761)][_0x595fea(0x37c)]||0xa;const _0xb4f6fa=document[_0x595fea(0x11e3)](_0x595fea(0x454)),_0x231cf9=document['getElementById'](_0x595fea(0x526));_0x367a7c[_0x595fea(0x761)][_0x595fea(0xd10)]?(_0xb4f6fa[_0x595fea(0xf0a)]=_0x367a7c[_0x595fea(0x761)][_0x595fea(0xd10)],_0xb4f6fa[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x595fea(0x11ac),_0x231cf9[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x595fea(0xfc6)):(_0xb4f6fa['style'][_0x595fea(0x33d)]=_0x595fea(0x379),_0x231cf9[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x595fea(0x379));document[_0x595fea(0x11e3)](_0x595fea(0xfa2))['style']['display']=_0x529d6f?_0x595fea(0x379):_0x595fea(0x11ac),document[_0x595fea(0x11e3)]('single-char-background-activity-group')[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x529d6f?_0x595fea(0x379):_0x595fea(0x11ac),document[_0x595fea(0x11e3)](_0x595fea(0x10b8))[_0x595fea(0x794)]['display']=_0x529d6f?_0x595fea(0x11ac):_0x595fea(0x379);const _0x160d3c=document[_0x595fea(0x11e3)](_0x595fea(0x609)),_0x2c475b=document['getElementById'](_0x595fea(0xf8));_0x160d3c[_0x595fea(0x3e4)]=_0x367a7c[_0x595fea(0x761)][_0x595fea(0x290)],_0x2c475b[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x160d3c[_0x595fea(0x3e4)]?_0x595fea(0x11ac):_0x595fea(0x379);const _0x571fcd=document[_0x595fea(0x11e3)](_0x595fea(0x460)),_0x3038fa=Intl['supportedValuesOf'](_0x595fea(0xff6));_0x571fcd['innerHTML']='',_0x3038fa[_0x595fea(0x494)](_0x55adfd=>{const _0x39372b=_0x595fea,_0x49e1f8=document[_0x39372b(0x383)](_0x39372b(0xd91));_0x49e1f8['value']=_0x55adfd,_0x49e1f8[_0x39372b(0x300)]=_0x55adfd,_0x571fcd[_0x39372b(0x120c)](_0x49e1f8);}),_0x571fcd[_0x595fea(0xf27)]=_0x367a7c[_0x595fea(0x761)][_0x595fea(0xff6)]||'Asia/Shanghai';if(_0x529d6f)document[_0x595fea(0x11e3)](_0x595fea(0x453))[_0x595fea(0x3e4)]=_0x367a7c['settings'][_0x595fea(0xa99)],document[_0x595fea(0x11e3)](_0x595fea(0xf09))[_0x595fea(0xf27)]=_0x367a7c[_0x595fea(0x761)][_0x595fea(0xca7)]||'',document[_0x595fea(0x11e3)](_0x595fea(0xb46))['src']=_0x367a7c[_0x595fea(0x761)][_0x595fea(0x75c)]||_0x1f1b42,document[_0x595fea(0x11e3)](_0x595fea(0xa87))[_0x595fea(0xf27)]=_0x367a7c[_0x595fea(0x761)][_0x595fea(0xb09)]||0xa,document[_0x595fea(0x11e3)]('single-char-background-activity-group')[_0x595fea(0x794)][_0x595fea(0x33d)]='none',_0x364dbd(_0x367a7c[_0x595fea(0x2b3)]);else{document[_0x595fea(0x11e3)](_0x595fea(0x3a4))[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x595fea(0x11ac),document[_0x595fea(0x11e3)](_0x595fea(0x10a1))['checked']=_0x367a7c[_0x595fea(0x761)][_0x595fea(0xa99)],document['getElementById'](_0x595fea(0x1016))[_0x595fea(0x3e4)]=_0x367a7c['settings']['injectLatestThought'];const _0x42d462=document[_0x595fea(0x11e3)](_0x595fea(0x109)),_0xf33159=document[_0x595fea(0x11e3)](_0x595fea(0x235)),_0xf24a02=document['getElementById'](_0x595fea(0xd33)),_0x2b8975=document[_0x595fea(0x11e3)](_0x595fea(0x113f));_0x42d462[_0x595fea(0x3e4)]=_0x367a7c['settings'][_0x595fea(0xadd)]||![],_0xf33159[_0x595fea(0x794)]['display']=_0x42d462[_0x595fea(0x3e4)]?'block':_0x595fea(0x379),_0xf24a02[_0x595fea(0xf27)]=_0x367a7c[_0x595fea(0x761)][_0x595fea(0x12db)]||0x64,_0x2b8975[_0x595fea(0xf27)]=_0x367a7c[_0x595fea(0x761)]['offlineMaxLength']||0x12c,await _0x15e5ab(_0x367a7c),document[_0x595fea(0x11e3)](_0x595fea(0xd06))[_0x595fea(0xf27)]=_0x367a7c[_0x595fea(0x697)],document[_0x595fea(0x11e3)](_0x595fea(0xdd0))[_0x595fea(0xf27)]=_0x367a7c[_0x595fea(0x761)][_0x595fea(0xa72)]||'',document['getElementById']('enable-tts-switch')[_0x595fea(0x3e4)]=_0x367a7c[_0x595fea(0x761)]['enableTts']!==![],document[_0x595fea(0x11e3)](_0x595fea(0x10e3))[_0x595fea(0xf27)]=_0x367a7c[_0x595fea(0x761)][_0x595fea(0x8d5)],document[_0x595fea(0x11e3)](_0x595fea(0x103))[_0x595fea(0xf0a)]=_0x367a7c['settings'][_0x595fea(0x5e0)]||_0x3d2e44,document[_0x595fea(0x11e3)](_0x595fea(0x1124))[_0x595fea(0xf27)]=_0x367a7c['settings'][_0x595fea(0xca7)]||'我',document[_0x595fea(0x11e3)]('ai-action-cooldown-input')[_0x595fea(0xf27)]=_0x367a7c['settings'][_0x595fea(0xb09)]||0xa;const _0x109f89=document[_0x595fea(0x11e3)]('assign-group-select');_0x109f89[_0x595fea(0x595)]=_0x595fea(0x10b3);const _0x372d74=await _0x2e83f8['qzoneGroups'][_0x595fea(0x508)]();_0x372d74[_0x595fea(0x494)](_0x1f1c16=>{const _0x43f4a0=_0x595fea,_0x3a9140=document[_0x43f4a0(0x383)](_0x43f4a0(0xd91));_0x3a9140[_0x43f4a0(0xf27)]=_0x1f1c16['id'],_0x3a9140[_0x43f4a0(0x300)]=_0x1f1c16[_0x43f4a0(0x278)];if(_0x367a7c[_0x43f4a0(0xe0d)]===_0x1f1c16['id'])_0x3a9140[_0x43f4a0(0xbbc)]=!![];_0x109f89[_0x43f4a0(0x120c)](_0x3a9140);});const _0x25938e=_0x367a7c['settings'][_0x595fea(0xa92)]||{'vertical':_0x595fea(0x10e2),'horizontal':_0x595fea(0xc9c),'offset':0xa};document['getElementById'](_0x595fea(0x3ed))['value']=_0x25938e[_0x595fea(0x80e)],document[_0x595fea(0x11e3)](_0x595fea(0x11c4))[_0x595fea(0xf27)]=_0x25938e[_0x595fea(0xaf6)],document[_0x595fea(0x11e3)]('lyrics-offset-input')[_0x595fea(0xf27)]=_0x25938e[_0x595fea(0x197)];}const _0x4e4d48=document[_0x595fea(0x11e3)](_0x595fea(0xa16));_0x4e4d48['innerHTML']='';const [_0x2b3a85,_0x518a13]=await Promise['all']([_0x2e83f8[_0x595fea(0xaac)][_0x595fea(0x508)](),_0x2e83f8[_0x595fea(0xca)][_0x595fea(0x508)]()]),_0x2881f1=new Set(_0x367a7c[_0x595fea(0x761)]['linkedWorldBookIds']||[]);if(_0x518a13[_0x595fea(0x594)]===0x0)_0x4e4d48['innerHTML']=_0x595fea(0xef2);else{_0x2b3a85['forEach'](_0x25c509=>{const _0x370db6=_0x595fea,_0x345dfe=_0x518a13[_0x370db6(0x138)](_0x2d2059=>_0x2d2059[_0x370db6(0x9ee)]===_0x25c509['id']);if(_0x345dfe['length']>0x0){const _0x402bea=document[_0x370db6(0x383)]('h4');_0x402bea[_0x370db6(0x300)]=_0x25c509[_0x370db6(0x278)],_0x402bea[_0x370db6(0x794)]['cssText']=_0x370db6(0x1215),_0x4e4d48['appendChild'](_0x402bea),_0x345dfe['forEach'](_0x1f2443=>{const _0x8a6c7d=_0x370db6,_0x57f226=_0x2881f1[_0x8a6c7d(0x72a)](_0x1f2443['id']),_0x1eee6b=document['createElement'](_0x8a6c7d(0x308));_0x1eee6b[_0x8a6c7d(0x595)]=_0x8a6c7d(0x541)+_0x1f2443['id']+'\x22\x20'+(_0x57f226?'checked':'')+'>\x20'+_0x1f2443[_0x8a6c7d(0x278)],_0x4e4d48[_0x8a6c7d(0x120c)](_0x1eee6b);});}});const _0x1dd517=_0x518a13[_0x595fea(0x138)](_0x3f4c7f=>!_0x3f4c7f[_0x595fea(0x9ee)]);if(_0x1dd517['length']>0x0){const _0x2407a1=document[_0x595fea(0x383)]('h4');_0x2407a1[_0x595fea(0x300)]=_0x595fea(0x124f),_0x2407a1['style'][_0x595fea(0xfb7)]=_0x595fea(0x1a2),_0x4e4d48[_0x595fea(0x120c)](_0x2407a1),_0x1dd517[_0x595fea(0x494)](_0x293919=>{const _0x1cea7a=_0x595fea,_0x4ae400=_0x2881f1[_0x1cea7a(0x72a)](_0x293919['id']),_0x46af44=document['createElement'](_0x1cea7a(0x308));_0x46af44['innerHTML']=_0x1cea7a(0x541)+_0x293919['id']+'\x22\x20'+(_0x4ae400?_0x1cea7a(0x3e4):'')+'>\x20'+_0x293919['name'],_0x4e4d48['appendChild'](_0x46af44);});}}_0x5326aa();const _0x509724=document[_0x595fea(0x11e3)](_0x595fea(0x11a6)),_0x307201=document[_0x595fea(0x11e3)](_0x595fea(0xaa9)),_0x26a45c=document['getElementById'](_0x595fea(0xee1)),_0x70b994=_0x367a7c[_0x595fea(0x761)][_0x595fea(0xd1d)]||[];_0x509724[_0x595fea(0x3e4)]=_0x70b994[_0x595fea(0x594)]>0x0,_0x307201[_0x595fea(0x794)][_0x595fea(0x33d)]=_0x509724[_0x595fea(0x3e4)]?'block':'none',_0x26a45c[_0x595fea(0x595)]='',Object[_0x595fea(0x4ca)](_0x5de8b7[_0x595fea(0x737)])['forEach'](_0x341bde=>{const _0x1339ed=_0x595fea;if(_0x341bde['id']===_0x367a7c['id'])return;const _0x3c87a7=_0x70b994[_0x1339ed(0x3ad)](_0x341bde['id']),_0x1ce57b=_0x341bde[_0x1339ed(0x1244)]?_0x1339ed(0x1116):_0x1339ed(0xd19),_0x3e9fc6=document[_0x1339ed(0x383)](_0x1339ed(0x308));_0x3e9fc6['innerHTML']=_0x1339ed(0x85f)+_0x341bde['id']+'\x22\x20'+(_0x3c87a7?_0x1339ed(0x3e4):'')+'>\x20'+_0x1ce57b+'\x20'+_0x341bde['name'],_0x26a45c[_0x1339ed(0x120c)](_0x3e9fc6);});function _0x4034f3(){const _0x262e57=_0x595fea,_0x2ee94d=_0x26a45c[_0x262e57(0x10d6)](_0x262e57(0x568)),_0x581ce3=_0x307201[_0x262e57(0x5ac)]('.selected-options-text');if(_0x2ee94d[_0x262e57(0x594)]===0x0)_0x581ce3[_0x262e57(0x300)]=_0x262e57(0x139);else _0x2ee94d[_0x262e57(0x594)]>0x2?_0x581ce3[_0x262e57(0x300)]=_0x262e57(0xc61)+_0x2ee94d['length']+'\x20项':_0x581ce3[_0x262e57(0x300)]=Array[_0x262e57(0xee2)](_0x2ee94d)['map'](_0x224fdd=>_0x224fdd[_0x262e57(0xd2d)][_0x262e57(0x300)]['trim']())[_0x262e57(0xa4b)](',\x20');}_0x4034f3(),_0x509724[_0x595fea(0x4b8)](_0x595fea(0xfeb),()=>{const _0x40a267=_0x595fea;_0x307201['style']['display']=_0x509724[_0x40a267(0x3e4)]?_0x40a267(0x11ac):_0x40a267(0x379);});const _0x4038e4=_0x307201[_0x595fea(0x5ac)](_0x595fea(0xd7f)),_0x50f672=_0x4038e4[_0x595fea(0x4b4)](!![]);_0x4038e4[_0x595fea(0x18c)][_0x595fea(0xeaa)](_0x50f672,_0x4038e4),_0x50f672[_0x595fea(0x4b8)](_0x595fea(0x1041),_0x30b85f=>{const _0x37c5f1=_0x595fea;_0x30b85f[_0x37c5f1(0x7cb)](),_0x26a45c[_0x37c5f1(0x505)][_0x37c5f1(0xe7e)]('visible'),_0x50f672[_0x37c5f1(0x505)]['toggle']('expanded');}),_0x26a45c[_0x595fea(0x4b8)](_0x595fea(0xfeb),_0x4034f3);const _0x2052ba=document[_0x595fea(0x5ac)](_0x595fea(0xe4c)+(_0x367a7c['settings'][_0x595fea(0xad7)]||_0x595fea(0xd3))+'\x22]');if(_0x2052ba)_0x2052ba[_0x595fea(0x3e4)]=!![];const _0x531f76=document['getElementById'](_0x595fea(0xf6e));_0x531f76[_0x595fea(0xf27)]=_0x367a7c[_0x595fea(0x761)][_0x595fea(0x1115)]||0xd,document[_0x595fea(0x11e3)]('font-size-value')[_0x595fea(0x300)]=_0x531f76[_0x595fea(0xf27)]+'px';const _0x4bb364=document[_0x595fea(0x11e3)](_0x595fea(0x311));_0x4bb364['value']=_0x367a7c['settings'][_0x595fea(0x124)]||'',_0x2d03c9(),document['getElementById']('auto-memory-toggle')['checked']=_0x367a7c[_0x595fea(0x761)][_0x595fea(0x6db)]||![],document['getElementById'](_0x595fea(0x970))['value']=_0x367a7c[_0x595fea(0x761)]['autoMemoryInterval']||0x14,_0x4e7698(_0x595fea(0x948));});function _0x364dbd(_0xd49247){const _0x3abd80=_0x47aceb,_0x20268a=document[_0x3abd80(0x11e3)](_0x3abd80(0x11e5));_0x20268a[_0x3abd80(0x595)]='',_0xd49247['forEach'](_0x5d2f72=>{const _0x524dfe=_0x3abd80,_0x4acfb2=document[_0x524dfe(0x383)](_0x524dfe(0x1285));_0x4acfb2[_0x524dfe(0x3db)]=_0x524dfe(0xb3b),_0x4acfb2[_0x524dfe(0xaca)][_0x524dfe(0xbc3)]=_0x5d2f72['id'];const _0x55fbc2=_0x5d2f72['avatar']||(_0x5de8b7[_0x524dfe(0x737)][_0x5d2f72['id']]?_0x5de8b7['chats'][_0x5d2f72['id']][_0x524dfe(0x761)][_0x524dfe(0x5e0)]:_0x4d9574);_0x4acfb2['innerHTML']=_0x524dfe(0x13b)+_0x55fbc2+_0x524dfe(0x1095)+_0x5d2f72[_0x524dfe(0xc8f)]+_0x524dfe(0xed7)+_0x5d2f72[_0x524dfe(0xc8f)]+'</div>',_0x4acfb2['addEventListener'](_0x524dfe(0x1041),()=>_0x27aa49(_0x5d2f72['id'])),_0x20268a[_0x524dfe(0x120c)](_0x4acfb2);});}document['getElementById']('save-member-settings-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x2c29ab=_0x47aceb;if(!_0x168ef5)return;const _0x2f6e00=_0x5de8b7['chats'][_0x5de8b7['activeChatId']],_0x10d162=_0x2f6e00[_0x2c29ab(0x2b3)][_0x2c29ab(0xe79)](_0x5747c3=>_0x5747c3['id']===_0x168ef5);if(!_0x10d162)return;const _0x2011bc=document[_0x2c29ab(0x11e3)](_0x2c29ab(0x72e))['value'][_0x2c29ab(0xeb7)]();if(!_0x2011bc){alert('群昵称不能为空！');return;}_0x10d162[_0x2c29ab(0xc8f)]=_0x2011bc,_0x10d162[_0x2c29ab(0x701)]=document['getElementById'](_0x2c29ab(0x7af))['value'];const _0x5cbe46=document['getElementById'](_0x2c29ab(0xe9b))[_0x2c29ab(0xf0a)];_0x10d162[_0x2c29ab(0x525)]=_0x5cbe46;const _0x52cde1=_0x5de8b7['chats'][_0x10d162['id']];_0x52cde1&&(_0x52cde1[_0x2c29ab(0x761)][_0x2c29ab(0x5e0)]=_0x5cbe46,await _0x2e83f8['chats'][_0x2c29ab(0xe3c)](_0x52cde1)),await _0x2e83f8[_0x2c29ab(0x737)][_0x2c29ab(0xe3c)](_0x2f6e00),_0x364dbd(_0x2f6e00['members']),document[_0x2c29ab(0x11e3)](_0x2c29ab(0x111c))[_0x2c29ab(0x505)]['remove'](_0x2c29ab(0x250)),_0x168ef5=null;});function _0x27aa49(_0x3e237b){const _0x5c1f61=_0x47aceb;_0x168ef5=_0x3e237b;const _0x107f22=_0x5de8b7[_0x5c1f61(0x737)][_0x5de8b7[_0x5c1f61(0x93d)]],_0x1c0a5d=_0x107f22[_0x5c1f61(0x2b3)][_0x5c1f61(0xe79)](_0x5775c5=>_0x5775c5['id']===_0x3e237b);if(!_0x1c0a5d)return;document[_0x5c1f61(0x11e3)](_0x5c1f61(0x72e))[_0x5c1f61(0xf27)]=_0x1c0a5d[_0x5c1f61(0xc8f)],document['getElementById'](_0x5c1f61(0x7af))[_0x5c1f61(0xf27)]=_0x1c0a5d[_0x5c1f61(0x701)];const _0x367ad1=_0x1c0a5d[_0x5c1f61(0x525)]||(_0x5de8b7[_0x5c1f61(0x737)][_0x1c0a5d['id']]?_0x5de8b7[_0x5c1f61(0x737)][_0x1c0a5d['id']][_0x5c1f61(0x761)][_0x5c1f61(0x5e0)]:_0x4d9574);document[_0x5c1f61(0x11e3)](_0x5c1f61(0xe9b))['src']=_0x367ad1,document[_0x5c1f61(0x11e3)](_0x5c1f61(0x111c))[_0x5c1f61(0x505)][_0x5c1f61(0x252)](_0x5c1f61(0x250));}document[_0x47aceb(0x11e3)](_0x47aceb(0xef3))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x1c5e83=_0x47aceb;document[_0x1c5e83(0x11e3)](_0x1c5e83(0x111c))[_0x1c5e83(0x505)][_0x1c5e83(0x957)](_0x1c5e83(0x250)),_0x168ef5=null;}),document[_0x47aceb(0x11e3)]('save-member-settings-btn')[_0x47aceb(0x4b8)]('click',async()=>{const _0x4364e8=_0x47aceb;if(!_0x168ef5)return;const _0xcc1527=_0x5de8b7[_0x4364e8(0x737)][_0x5de8b7[_0x4364e8(0x93d)]],_0x49d3c9=_0xcc1527['members'][_0x4364e8(0xe79)](_0x3d8dc2=>_0x3d8dc2['id']===_0x168ef5);if(!_0x49d3c9)return;const _0x37efcd=document[_0x4364e8(0x11e3)](_0x4364e8(0x72e))[_0x4364e8(0xf27)]['trim']();if(!_0x37efcd){alert(_0x4364e8(0xb01));return;}_0x49d3c9[_0x4364e8(0xc8f)]=_0x37efcd,_0x49d3c9['persona']=document[_0x4364e8(0x11e3)](_0x4364e8(0x7af))[_0x4364e8(0xf27)];const _0x250452=document[_0x4364e8(0x11e3)]('member-avatar-preview')['src'];_0x49d3c9[_0x4364e8(0x525)]=_0x250452;const _0x340214=_0x5de8b7[_0x4364e8(0x737)][_0x49d3c9['id']];_0x340214&&(_0x340214[_0x4364e8(0x761)]['aiAvatar']=_0x250452,await _0x2e83f8[_0x4364e8(0x737)][_0x4364e8(0xe3c)](_0x340214)),await _0x2e83f8[_0x4364e8(0x737)][_0x4364e8(0xe3c)](_0xcc1527),_0x364dbd(_0xcc1527[_0x4364e8(0x2b3)]),document[_0x4364e8(0x11e3)](_0x4364e8(0x111c))[_0x4364e8(0x505)][_0x4364e8(0x957)](_0x4364e8(0x250)),_0x168ef5=null;}),document[_0x47aceb(0x11e3)]('reset-theme-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x5ad91e=_0x47aceb;document[_0x5ad91e(0x11e3)](_0x5ad91e(0xb61))[_0x5ad91e(0x3e4)]=!![];}),document[_0x47aceb(0x11e3)](_0x47aceb(0x171))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x443195=_0x47aceb;if(!_0x5de8b7[_0x443195(0x93d)])return;const _0x2381bb=_0x5de8b7[_0x443195(0x737)][_0x5de8b7[_0x443195(0x93d)]],_0xf9fbe8=_0x2381bb[_0x443195(0x761)][_0x443195(0xadd)]||![],_0x29892e=document['getElementById']('chat-name-input')[_0x443195(0xf27)][_0x443195(0xeb7)]();if(!_0x29892e)return alert('备注名/群名不能为空！');if(!_0x2381bb[_0x443195(0x1244)]&&_0x29892e!==_0x2381bb[_0x443195(0x278)]){if(!_0x2381bb[_0x443195(0x3d7)])_0x2381bb['nameHistory']=[];if(!_0x2381bb[_0x443195(0x3d7)][_0x443195(0x3ad)](_0x2381bb[_0x443195(0x278)]))_0x2381bb[_0x443195(0x3d7)][_0x443195(0xf5)](_0x2381bb[_0x443195(0x278)]);}_0x2381bb['name']=_0x29892e;const _0x315588=document[_0x443195(0x5ac)]('input[name=\x22theme-select\x22]:checked');_0x2381bb[_0x443195(0x761)][_0x443195(0xad7)]=_0x315588?_0x315588[_0x443195(0xf27)]:_0x443195(0xd3),_0x2381bb[_0x443195(0x761)]['fontSize']=parseInt(document[_0x443195(0x11e3)](_0x443195(0xf6e))[_0x443195(0xf27)]),_0x2381bb[_0x443195(0x761)][_0x443195(0x124)]=document['getElementById'](_0x443195(0x311))[_0x443195(0xf27)][_0x443195(0xeb7)](),_0x2381bb[_0x443195(0x761)][_0x443195(0x10c5)]=document[_0x443195(0x11e3)](_0x443195(0x63f))[_0x443195(0xf27)],_0x2381bb[_0x443195(0x761)][_0x443195(0xc43)]=document['getElementById'](_0x443195(0x8b3))[_0x443195(0xf0a)],_0x2381bb['settings'][_0x443195(0xb2e)]=parseInt(document['getElementById']('max-memory')[_0x443195(0xf27)])||0xa,_0x2381bb[_0x443195(0x761)][_0x443195(0x37c)]=parseInt(document[_0x443195(0x11e3)]('linked-memory-count')[_0x443195(0xf27)])||0xa;const _0x59fc0f=document[_0x443195(0x10d6)]('#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked'),_0x42222f=[];_0x59fc0f[_0x443195(0x494)](_0x1a2a6f=>{const _0xd799a4=_0x443195;_0x1a2a6f[_0xd799a4(0xf27)][_0xd799a4(0xb6c)](_0xd799a4(0x10e5))&&_0x42222f['push'](_0x1a2a6f[_0xd799a4(0xf27)][_0xd799a4(0x1018)](_0xd799a4(0x10e5),''));}),_0x2381bb['settings']['linkedWorldBookIds']=_0x42222f;const _0xdc673b=document[_0x443195(0x11e3)](_0x443195(0x11a6))[_0x443195(0x3e4)];if(_0xdc673b){const _0x1d455a=document[_0x443195(0x10d6)](_0x443195(0x5ae));_0x2381bb[_0x443195(0x761)]['linkedMemoryChatIds']=Array[_0x443195(0xee2)](_0x1d455a)[_0x443195(0x796)](_0x431ddc=>_0x431ddc[_0x443195(0xf27)]);}else _0x2381bb[_0x443195(0x761)][_0x443195(0xd1d)]=[];_0x2381bb[_0x443195(0x761)][_0x443195(0x6db)]=document[_0x443195(0x11e3)](_0x443195(0x4b3))[_0x443195(0x3e4)],_0x2381bb[_0x443195(0x761)][_0x443195(0x11f)]=parseInt(document[_0x443195(0x11e3)](_0x443195(0x970))['value'])||0x14,_0x2381bb[_0x443195(0x761)][_0x443195(0x290)]=document[_0x443195(0x11e3)]('time-perception-toggle')[_0x443195(0x3e4)],_0x2381bb[_0x443195(0x761)][_0x443195(0xff6)]=document[_0x443195(0x11e3)](_0x443195(0x460))[_0x443195(0xf27)];if(_0x2381bb[_0x443195(0x1244)])_0x2381bb[_0x443195(0x761)][_0x443195(0xa99)]=document[_0x443195(0x11e3)](_0x443195(0x453))[_0x443195(0x3e4)],_0x2381bb['settings']['myNickname']=document[_0x443195(0x11e3)](_0x443195(0xf09))[_0x443195(0xf27)][_0x443195(0xeb7)](),_0x2381bb[_0x443195(0x761)][_0x443195(0x75c)]=document[_0x443195(0x11e3)](_0x443195(0xb46))[_0x443195(0xf0a)],_0x2381bb[_0x443195(0x761)][_0x443195(0xb09)]=parseInt(document[_0x443195(0x11e3)]('group-action-cooldown-input')[_0x443195(0xf27)])||0xa;else{_0x2381bb[_0x443195(0x761)][_0x443195(0xa99)]=document[_0x443195(0x11e3)](_0x443195(0x10a1))[_0x443195(0x3e4)];const _0x57d241=document['getElementById'](_0x443195(0x109))['checked'];_0x2381bb[_0x443195(0x761)][_0x443195(0xadd)]=_0x57d241;if(_0xf9fbe8===!![]&&_0x57d241===![]){const _0x4a9cc6={'role':_0x443195(0xf72),'content':_0x443195(0x11e7),'timestamp':Date[_0x443195(0x1182)](),'isHidden':!![]};_0x2381bb[_0x443195(0x49e)][_0x443195(0xf5)](_0x4a9cc6),console[_0x443195(0x84b)]('已成功注入“切换到线上模式”的系统指令。');}_0x2381bb[_0x443195(0x761)]['injectLatestThought']=document[_0x443195(0x11e3)](_0x443195(0x1016))[_0x443195(0x3e4)],_0x2381bb[_0x443195(0x761)][_0x443195(0x12db)]=parseInt(document[_0x443195(0x11e3)](_0x443195(0xd33))[_0x443195(0xf27)])||0x64,_0x2381bb[_0x443195(0x761)][_0x443195(0xb31)]=parseInt(document[_0x443195(0x11e3)](_0x443195(0x113f))[_0x443195(0xf27)])||0x12c,_0x2381bb[_0x443195(0x761)][_0x443195(0xa15)]=document[_0x443195(0x11e3)](_0x443195(0x1079))['value']||null;const _0x1093dd=document[_0x443195(0x11e3)]('ai-original-name-input')[_0x443195(0xf27)]['trim']();if(!_0x1093dd)return alert(_0x443195(0xae3));_0x2381bb[_0x443195(0x697)]=_0x1093dd,_0x2381bb[_0x443195(0x761)][_0x443195(0x8d5)]=document[_0x443195(0x11e3)](_0x443195(0x10e3))['value'],_0x2381bb['settings']['minimaxVoiceId']=document[_0x443195(0x11e3)]('ai-voice-id-input')[_0x443195(0xf27)][_0x443195(0xeb7)](),_0x2381bb[_0x443195(0x761)]['enableTts']=document[_0x443195(0x11e3)]('enable-tts-switch')[_0x443195(0x3e4)],_0x2381bb[_0x443195(0x761)][_0x443195(0x5e0)]=document[_0x443195(0x11e3)]('ai-avatar-preview')['src'],_0x2381bb[_0x443195(0x761)]['myNickname']=document['getElementById'](_0x443195(0x1124))[_0x443195(0xf27)][_0x443195(0xeb7)]()||'我',_0x2381bb['settings'][_0x443195(0xb09)]=parseInt(document[_0x443195(0x11e3)]('ai-action-cooldown-input')['value'])||0xa,_0x2381bb[_0x443195(0x761)]['lyricsPosition']={'vertical':document[_0x443195(0x11e3)](_0x443195(0x3ed))[_0x443195(0xf27)],'horizontal':document['getElementById'](_0x443195(0x11c4))['value'],'offset':parseInt(document[_0x443195(0x11e3)](_0x443195(0xcff))[_0x443195(0xf27)])||0xa};const _0x178a98=document[_0x443195(0x11e3)]('assign-group-select')['value'];_0x2381bb[_0x443195(0xe0d)]=_0x178a98?parseInt(_0x178a98):null;}await _0x2e83f8[_0x443195(0x737)]['put'](_0x2381bb),!_0x2381bb[_0x443195(0x1244)]&&(await _0xead3(_0x2381bb),await _0x46ae3e(_0x2381bb)),_0x30d472(_0x2381bb),_0x5a313a(_0x2381bb['settings'][_0x443195(0x124)],_0x443195(0x874),_0x443195(0x3d8)),_0x4e7698(_0x443195(0x9fc)),_0x544ab5(_0x5de8b7[_0x443195(0x93d)]),_0x5ee219();}),document['getElementById']('chat-settings-screen')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x50d5e1=>{const _0x24a160=_0x47aceb;_0x50d5e1[_0x24a160(0xd7c)][_0x24a160(0x505)][_0x24a160(0x1121)]('change-frame-btn')&&_0x2f6f4d(_0x24a160(0x847));}),document['getElementById'](_0x47aceb(0x111c))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2be25d=>{const _0x561355=_0x47aceb;_0x2be25d[_0x561355(0xd7c)]['classList']['contains'](_0x561355(0xc6c))&&_0x2f6f4d(_0x561355(0x512));});const _0x3e47b8=document['getElementById']('avatar-frame-modal'),_0x180669=document['getElementById']('ai-frame-tab'),_0x558c10=document['getElementById']('my-frame-tab'),_0xc0dd5c=document[_0x47aceb(0x11e3)](_0x47aceb(0xb42)),_0x34063d=document['getElementById'](_0x47aceb(0x1ea));document['getElementById'](_0x47aceb(0xcc1))['addEventListener'](_0x47aceb(0x1041),_0x3eb370),document['getElementById'](_0x47aceb(0x1187))[_0x47aceb(0x4b8)]('click',()=>{const _0x5785f6=_0x47aceb;_0x3e47b8[_0x5785f6(0x505)][_0x5785f6(0x957)]('visible'),_0x22f8f5=![];}),_0x180669['addEventListener'](_0x47aceb(0x1041),()=>{const _0x5416ed=_0x47aceb;_0x180669['classList'][_0x5416ed(0x252)](_0x5416ed(0x1fc)),_0x558c10[_0x5416ed(0x505)]['remove'](_0x5416ed(0x1fc)),_0xc0dd5c[_0x5416ed(0x794)][_0x5416ed(0x33d)]='block',_0x34063d[_0x5416ed(0x794)][_0x5416ed(0x33d)]=_0x5416ed(0x379);}),_0x558c10[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x5a84a2=_0x47aceb;_0x558c10[_0x5a84a2(0x505)][_0x5a84a2(0x252)](_0x5a84a2(0x1fc)),_0x180669['classList'][_0x5a84a2(0x957)](_0x5a84a2(0x1fc)),_0x34063d[_0x5a84a2(0x794)][_0x5a84a2(0x33d)]=_0x5a84a2(0x11ac),_0xc0dd5c[_0x5a84a2(0x794)][_0x5a84a2(0x33d)]=_0x5a84a2(0x379);}),document[_0x47aceb(0x11e3)](_0x47aceb(0x2b2))[_0x47aceb(0x4b8)]('click',async()=>{const _0x26de49=_0x47aceb;if(!_0x5de8b7[_0x26de49(0x93d)])return;const _0x249d0d=_0x5de8b7[_0x26de49(0x737)][_0x5de8b7[_0x26de49(0x93d)]],_0x408623=await _0x58fd60(_0x26de49(0x76b),_0x26de49(0xc0f),{'confirmButtonClass':_0x26de49(0x8a6)});_0x408623&&(_0x249d0d[_0x26de49(0x49e)]=[],_0x249d0d[_0x26de49(0x535)]=_0x26de49(0x6cb),_0x249d0d['randomJottings']=_0x26de49(0x6cb),await _0x2e83f8[_0x26de49(0x737)][_0x26de49(0xe3c)](_0x249d0d),_0x544ab5(_0x5de8b7[_0x26de49(0x93d)]),_0x5ee219(),_0x542a85[_0x26de49(0x505)][_0x26de49(0x957)]('visible'));});const _0x22e493=(_0x2d84cd,_0x349ea1)=>{const _0x2f66d4=_0x47aceb;document['getElementById'](_0x2d84cd)[_0x2f66d4(0x4b8)](_0x2f66d4(0xfeb),async _0x1bf557=>{const _0x4657c9=_0x2f66d4,_0x1660f5=_0x1bf557['target']['files'][0x0];if(_0x1660f5){const _0x8cbf74=await new Promise((_0x4aeaa4,_0x3af494)=>{const _0x54c448=_0x10a9,_0x3d3a87=new FileReader();_0x3d3a87[_0x54c448(0x1e5)]=()=>_0x4aeaa4(_0x3d3a87['result']),_0x3d3a87[_0x54c448(0x741)]=()=>_0x3af494(_0x3d3a87[_0x54c448(0x1c1)]),_0x3d3a87[_0x54c448(0x1270)](_0x1660f5);});_0x349ea1(_0x8cbf74),_0x1bf557['target'][_0x4657c9(0xf27)]=null;}});};_0x22e493('ai-avatar-input',_0x21f778=>document[_0x47aceb(0x11e3)](_0x47aceb(0x103))[_0x47aceb(0xf0a)]=_0x21f778),_0x22e493(_0x47aceb(0xfca),_0x20dd3e=>document[_0x47aceb(0x11e3)]('my-avatar-preview')[_0x47aceb(0xf0a)]=_0x20dd3e),_0x22e493('group-avatar-input',_0x417212=>document[_0x47aceb(0x11e3)]('group-avatar-preview')[_0x47aceb(0xf0a)]=_0x417212),_0x22e493('member-avatar-input',_0x48c5b7=>document[_0x47aceb(0x11e3)](_0x47aceb(0xe9b))[_0x47aceb(0xf0a)]=_0x48c5b7),_0x22e493(_0x47aceb(0x83e),_0x956049=>{const _0x4821cf=_0x47aceb;if(_0x5de8b7[_0x4821cf(0x93d)]){_0x5de8b7[_0x4821cf(0x737)][_0x5de8b7['activeChatId']]['settings']['background']=_0x956049;const _0x10923d=document[_0x4821cf(0x11e3)](_0x4821cf(0x454));_0x10923d[_0x4821cf(0xf0a)]=_0x956049,_0x10923d[_0x4821cf(0x794)]['display']=_0x4821cf(0x11ac),document['getElementById']('remove-bg-btn')[_0x4821cf(0x794)][_0x4821cf(0x33d)]=_0x4821cf(0xfc6);}}),_0x22e493(_0x47aceb(0xa07),_0x3e9adb=>document['getElementById'](_0x47aceb(0x12ce))[_0x47aceb(0xf0a)]=_0x3e9adb),document['getElementById'](_0x47aceb(0x526))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x332fed=_0x47aceb;if(_0x5de8b7[_0x332fed(0x93d)]){_0x5de8b7[_0x332fed(0x737)][_0x5de8b7['activeChatId']][_0x332fed(0x761)][_0x332fed(0xd10)]='';const _0x315706=document[_0x332fed(0x11e3)](_0x332fed(0x454));_0x315706[_0x332fed(0xf0a)]='',_0x315706[_0x332fed(0x794)][_0x332fed(0x33d)]=_0x332fed(0x379),document[_0x332fed(0x11e3)]('remove-bg-btn')[_0x332fed(0x794)][_0x332fed(0x33d)]='none';}});const _0x1826cc=document[_0x47aceb(0x11e3)](_0x47aceb(0x6fd));document['getElementById'](_0x47aceb(0x11cb))['addEventListener']('click',()=>{const _0x487a6f=_0x47aceb,_0x6d51a5=_0x5de8b7[_0x487a6f(0x737)][_0x5de8b7[_0x487a6f(0x93d)]];_0x6d51a5&&_0x6d51a5['settings'][_0x487a6f(0x1dc)]?_0x10c076=_0x6d51a5['settings']['stickerCategoryId']:_0x10c076=_0x487a6f(0xd4a),_0x40d6fc(),_0x1826cc[_0x487a6f(0x505)]['add'](_0x487a6f(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0xb65))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>_0x1826cc[_0x47aceb(0x505)][_0x47aceb(0x957)](_0x47aceb(0x250))),document['getElementById'](_0x47aceb(0xac5))[_0x47aceb(0x4b8)]('click',_0x13f9ce),document[_0x47aceb(0x11e3)](_0x47aceb(0x6d2))['addEventListener'](_0x47aceb(0x1041),()=>document['getElementById']('sticker-upload-input')['click']()),document[_0x47aceb(0x11e3)](_0x47aceb(0x28d))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),async _0x3651ef=>{const _0x4a4304=_0x47aceb,_0x569aaa=_0x3651ef[_0x4a4304(0xd7c)][_0x4a4304(0x5c9)][0x0];if(!_0x569aaa)return;const _0x4a92e5=new FileReader();_0x4a92e5[_0x4a4304(0x1270)](_0x569aaa),_0x4a92e5[_0x4a4304(0x1e5)]=async()=>{const _0x41b3fe=_0x4a4304,_0x43f5a4=_0x4a92e5[_0x41b3fe(0x255)],_0x619961=await _0x231a5a(_0x41b3fe(0x12ea),'请为这个表情命名\x20(例如：好耶、疑惑)');if(_0x619961&&_0x619961[_0x41b3fe(0xeb7)]()){const _0x110706={'id':_0x41b3fe(0x1208)+Date[_0x41b3fe(0x1182)](),'url':_0x43f5a4,'name':_0x619961[_0x41b3fe(0xeb7)](),'categoryId':_0x10c076!==_0x41b3fe(0xd4a)&&_0x10c076!==_0x41b3fe(0xb81)?_0x10c076:null};await _0x2e83f8[_0x41b3fe(0xa67)][_0x41b3fe(0x252)](_0x110706),_0x5de8b7[_0x41b3fe(0xa67)][_0x41b3fe(0xf5)](_0x110706),_0x40d6fc();}else{if(_0x619961!==null)alert(_0x41b3fe(0x763));}},_0x3651ef[_0x4a4304(0xd7c)][_0x4a4304(0xf27)]=null;}),document[_0x47aceb(0x11e3)](_0x47aceb(0x1296))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>document[_0x47aceb(0x11e3)](_0x47aceb(0xbd6))[_0x47aceb(0x1041)]()),document[_0x47aceb(0x11e3)]('image-upload-input')['addEventListener'](_0x47aceb(0xfeb),async _0x1f20fe=>{const _0x11fd72=_0x47aceb,_0x33cffd=_0x1f20fe['target'][_0x11fd72(0x5c9)][0x0];if(!_0x33cffd||!_0x5de8b7['activeChatId'])return;const _0x3994b3=new FileReader();_0x3994b3[_0x11fd72(0x1e5)]=async _0xf79ea5=>{const _0x2672d2=_0x11fd72,_0x50d0c2=_0xf79ea5[_0x2672d2(0xd7c)][_0x2672d2(0x255)],_0x276f98=_0x5de8b7[_0x2672d2(0x737)][_0x5de8b7[_0x2672d2(0x93d)]],_0x506bb1={'role':_0x2672d2(0x21c),'content':[{'type':'image_url','image_url':{'url':_0x50d0c2}}],'timestamp':Date['now']()};_0x276f98[_0x2672d2(0x49e)][_0x2672d2(0xf5)](_0x506bb1),await _0x2e83f8[_0x2672d2(0x737)][_0x2672d2(0xe3c)](_0x276f98),_0x3b5153(_0x506bb1,_0x276f98),_0x5ee219();},_0x3994b3[_0x11fd72(0x1270)](_0x33cffd),_0x1f20fe['target'][_0x11fd72(0xf27)]=null;}),document['getElementById']('voice-message-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x58f833=_0x47aceb;if(!_0x5de8b7[_0x58f833(0x93d)])return;const _0x6eb6fb=await _0x231a5a('发送语音',_0x58f833(0x73c));if(_0x6eb6fb&&_0x6eb6fb[_0x58f833(0xeb7)]()){const _0x4d5e0a=_0x5de8b7[_0x58f833(0x737)][_0x5de8b7[_0x58f833(0x93d)]],_0x45261b={'role':_0x58f833(0x21c),'type':_0x58f833(0x719),'content':_0x6eb6fb[_0x58f833(0xeb7)](),'timestamp':Date[_0x58f833(0x1182)]()};_0x4d5e0a[_0x58f833(0x49e)][_0x58f833(0xf5)](_0x45261b),await _0x2e83f8[_0x58f833(0x737)]['put'](_0x4d5e0a),_0x3b5153(_0x45261b,_0x4d5e0a),_0x5ee219();}}),document['getElementById'](_0x47aceb(0x400))['addEventListener'](_0x47aceb(0x1041),async()=>{const _0x49658d=_0x47aceb;if(!_0x5de8b7[_0x49658d(0x93d)])return;const _0x1f4911=await _0x231a5a(_0x49658d(0x8d3),_0x49658d(0xe9d));if(_0x1f4911&&_0x1f4911[_0x49658d(0xeb7)]()){const _0x42d98e=_0x5de8b7[_0x49658d(0x737)][_0x5de8b7[_0x49658d(0x93d)]],_0x244d0a={'role':_0x49658d(0x21c),'type':_0x49658d(0xeb),'content':_0x1f4911[_0x49658d(0xeb7)](),'timestamp':Date[_0x49658d(0x1182)]()};_0x42d98e['history'][_0x49658d(0xf5)](_0x244d0a),await _0x2e83f8['chats']['put'](_0x42d98e),_0x3b5153(_0x244d0a,_0x42d98e),_0x5ee219();}});const _0x182604=document[_0x47aceb(0x11e3)](_0x47aceb(0x1aa));document[_0x47aceb(0x11e3)](_0x47aceb(0x3cb))[_0x47aceb(0x4b8)]('click',()=>{const _0x43714f=_0x47aceb;_0x182604['classList'][_0x43714f(0x252)](_0x43714f(0x250));}),_0x182604[_0x47aceb(0x4b8)]('click',_0x47e15e=>{const _0x44cf53=_0x47aceb;_0x47e15e[_0x44cf53(0xd7c)]===_0x182604&&_0x182604['classList'][_0x44cf53(0x957)](_0x44cf53(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x39f))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2a25bf),document[_0x47aceb(0x11e3)](_0x47aceb(0x48a))[_0x47aceb(0x4b8)]('click',async()=>{const _0x3b4f63=_0x47aceb;if(!_0x5de8b7[_0x3b4f63(0x93d)])return;const _0x53e1b2=document[_0x3b4f63(0x11e3)]('waimai-product-info'),_0x1a6cf4=document['getElementById']('waimai-amount'),_0x3878f4=_0x53e1b2[_0x3b4f63(0xf27)][_0x3b4f63(0xeb7)](),_0x42abe3=parseFloat(_0x1a6cf4['value']);if(!_0x3878f4||isNaN(_0x42abe3)||_0x42abe3<=0x0){alert(_0x3b4f63(0x64e));return;}const _0x2652eb=_0x5de8b7[_0x3b4f63(0x737)][_0x5de8b7[_0x3b4f63(0x93d)]],_0x3dfdf7=Date['now'](),_0x5819a6=_0x2652eb[_0x3b4f63(0x1244)]?_0x2652eb[_0x3b4f63(0x761)][_0x3b4f63(0xca7)]||'我':'我',_0x9ca53b={'role':'user','senderName':_0x5819a6,'type':'waimai_request','productInfo':_0x3878f4,'amount':_0x42abe3,'status':'pending','countdownEndTime':_0x3dfdf7+0xf*0x3c*0x3e8,'timestamp':_0x3dfdf7};_0x2652eb[_0x3b4f63(0x49e)]['push'](_0x9ca53b),await _0x2e83f8['chats'][_0x3b4f63(0xe3c)](_0x2652eb),_0x3b5153(_0x9ca53b,_0x2652eb),_0x5ee219(),_0x53e1b2['value']='',_0x1a6cf4['value']='',_0x182604[_0x3b4f63(0x505)][_0x3b4f63(0x957)](_0x3b4f63(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0xb68))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x4825d),document['getElementById'](_0x47aceb(0x44d))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0xe1b60d),document['getElementById'](_0x47aceb(0x624))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x22cf3d),document[_0x47aceb(0x11e3)](_0x47aceb(0xfc1))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2fc05c),document[_0x47aceb(0x11e3)](_0x47aceb(0x802))['addEventListener'](_0x47aceb(0x1041),_0x14d87d),document[_0x47aceb(0x11e3)](_0x47aceb(0xb67))['addEventListener']('click',_0x5f44d8),document[_0x47aceb(0x11e3)](_0x47aceb(0xc35))['addEventListener'](_0x47aceb(0x1041),_0x372fbf),document[_0x47aceb(0x11e3)]('preset-action-cancel')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x491938),document[_0x47aceb(0x11e3)](_0x47aceb(0x62b))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2192b8),document[_0x47aceb(0x11e3)](_0x47aceb(0xf02))[_0x47aceb(0x4b8)]('click',async()=>{const _0x59e75b=_0x47aceb;if(_0x281a6a['size']===0x0)return;const _0x2f1baf=await _0x58fd60(_0x59e75b(0x1066),'确定要删除选中的\x20'+_0x281a6a['size']+'\x20条消息吗？这会通知AI这些消息已被删除。',{'confirmButtonClass':_0x59e75b(0x8a6)});if(_0x2f1baf){const _0x1baa4d=_0x5de8b7[_0x59e75b(0x737)][_0x5de8b7[_0x59e75b(0x93d)]];let _0x29a100=[];for(const _0x566394 of _0x281a6a){const _0x3ab59d=_0x1baa4d[_0x59e75b(0x49e)]['find'](_0x5c70a7=>_0x5c70a7[_0x59e75b(0x702)]===_0x566394);_0x3ab59d&&_0x3ab59d[_0x59e75b(0xa20)]===_0x59e75b(0xcc5)&&_0x29a100[_0x59e75b(0xf5)](_0x59e75b(0x10e8)+_0x3ab59d[_0x59e75b(0xdb5)]+_0x59e75b(0x12de)+_0x3ab59d['timestamp']+')');}_0x1baa4d['history']=_0x1baa4d[_0x59e75b(0x49e)]['filter'](_0x330f1d=>!_0x281a6a[_0x59e75b(0x72a)](_0x330f1d[_0x59e75b(0x702)]));let _0x3e8c53=_0x59e75b(0xe7d);_0x29a100['length']>0x0&&(_0x3e8c53+=_0x59e75b(0x781)+_0x29a100[_0x59e75b(0xa4b)]('；')+'。');_0x3e8c53+=_0x59e75b(0x5c0);const _0xfdfaaa={'role':_0x59e75b(0xf72),'content':_0x59e75b(0x116a)+_0x3e8c53+']','timestamp':Date[_0x59e75b(0x1182)](),'isHidden':!![]};_0x1baa4d['history']['push'](_0xfdfaaa),await _0x2e83f8[_0x59e75b(0x737)]['put'](_0x1baa4d),_0x544ab5(_0x5de8b7[_0x59e75b(0x93d)]),_0x5ee219();}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x1222))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x4d21a5=_0x47aceb;if(_0x281a6a[_0x4d21a5(0x1159)]===0x0)return;const _0x47d881=await _0x58fd60('彻底删除消息',_0x4d21a5(0x100f)+_0x281a6a[_0x4d21a5(0x1159)]+_0x4d21a5(0x17c),{'confirmButtonClass':_0x4d21a5(0x8a6),'confirmText':'确认抹除'});if(_0x47d881){const _0x5c7eaa=_0x5de8b7[_0x4d21a5(0x737)][_0x5de8b7[_0x4d21a5(0x93d)]];_0x5c7eaa[_0x4d21a5(0x49e)]=_0x5c7eaa[_0x4d21a5(0x49e)][_0x4d21a5(0x138)](_0x501662=>!_0x281a6a[_0x4d21a5(0x72a)](_0x501662['timestamp'])),await _0x2e83f8[_0x4d21a5(0x737)][_0x4d21a5(0xe3c)](_0x5c7eaa),_0x544ab5(_0x5de8b7['activeChatId']),_0x5ee219();}});const _0x301ba1=document[_0x47aceb(0x11e3)](_0x47aceb(0x5b3));_0x301ba1[_0x47aceb(0x4b8)](_0x47aceb(0x6be),()=>_0x58687c(_0x301ba1['value'][_0x47aceb(0xeb7)](),!![])),document[_0x47aceb(0x11e3)](_0x47aceb(0xe6a))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x4f83a5=_0x47aceb,_0x440edf=_0x301ba1[_0x4f83a5(0xf27)][_0x4f83a5(0xeb7)]();if(!_0x440edf){alert(_0x4f83a5(0xae5));return;}_0x58687c(_0x440edf,![]),_0x5de8b7[_0x4f83a5(0x2df)][_0x4f83a5(0xcd8)]=_0x440edf,await _0x2e83f8[_0x4f83a5(0x2df)][_0x4f83a5(0xe3c)](_0x5de8b7[_0x4f83a5(0x2df)]),alert('字体已保存并应用！');}),document[_0x47aceb(0x11e3)](_0x47aceb(0xf8e))['addEventListener'](_0x47aceb(0x1041),_0x54791e),document['querySelectorAll'](_0x47aceb(0x405))[_0x47aceb(0x494)](_0x5296dd=>{const _0x6e987b=_0x47aceb;_0x5296dd[_0x6e987b(0x4b8)](_0x6e987b(0x1041),()=>_0x1c77e7(_0x5296dd[_0x6e987b(0xaca)][_0x6e987b(0x49b)]));}),document['getElementById'](_0x47aceb(0xb83))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>_0x1c77e7(_0x47aceb(0xde))),document[_0x47aceb(0x11e3)](_0x47aceb(0x11c5))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x27392c=_0x47aceb,_0x3d9683=await _0x231a5a('修改昵称',_0x27392c(0x1141),_0x5de8b7[_0x27392c(0x1c5)][_0x27392c(0xa33)]);_0x3d9683&&_0x3d9683[_0x27392c(0xeb7)]()&&(_0x5de8b7[_0x27392c(0x1c5)]['nickname']=_0x3d9683[_0x27392c(0xeb7)](),await _0x2a119b(),_0x59fc3f());}),document[_0x47aceb(0x11e3)](_0x47aceb(0xa43))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>document[_0x47aceb(0x11e3)](_0x47aceb(0x3b9))['click']()),document[_0x47aceb(0x11e3)]('qzone-banner-container')['addEventListener'](_0x47aceb(0x1041),()=>document[_0x47aceb(0x11e3)](_0x47aceb(0x106))[_0x47aceb(0x1041)]()),document[_0x47aceb(0x11e3)]('qzone-avatar-input')[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),async _0x58dc84=>{const _0x4196b3=_0x47aceb,_0x38af47=_0x58dc84[_0x4196b3(0xd7c)][_0x4196b3(0x5c9)][0x0];if(_0x38af47){const _0x717268=await new Promise(_0x1d9cd1=>{const _0x2c50e1=_0x4196b3,_0x8ea58f=new FileReader();_0x8ea58f[_0x2c50e1(0x1e5)]=()=>_0x1d9cd1(_0x8ea58f[_0x2c50e1(0x255)]),_0x8ea58f[_0x2c50e1(0x1270)](_0x38af47);});_0x5de8b7['qzoneSettings']['avatar']=_0x717268,await _0x2a119b(),_0x59fc3f();}_0x58dc84['target'][_0x4196b3(0xf27)]=null;}),document['getElementById'](_0x47aceb(0x106))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),async _0xe415b8=>{const _0x217008=_0x47aceb,_0x1528a2=_0xe415b8['target'][_0x217008(0x5c9)][0x0];if(_0x1528a2){const _0x2f418b=await new Promise(_0x3c5918=>{const _0x1a3924=_0x217008,_0x2d3e2f=new FileReader();_0x2d3e2f[_0x1a3924(0x1e5)]=()=>_0x3c5918(_0x2d3e2f[_0x1a3924(0x255)]),_0x2d3e2f[_0x1a3924(0x1270)](_0x1528a2);});_0x5de8b7[_0x217008(0x1c5)][_0x217008(0x531)]=_0x2f418b,await _0x2a119b(),_0x59fc3f();}_0xe415b8['target']['value']=null;}),document[_0x47aceb(0x11e3)]('create-shuoshuo-btn')['addEventListener'](_0x47aceb(0x1041),async()=>{const _0x2b96dc=_0x47aceb;_0x2f6e92();const _0x33e021=document[_0x2b96dc(0x11e3)](_0x2b96dc(0x1210));_0x33e021[_0x2b96dc(0xaca)]['mode']=_0x2b96dc(0xc40),_0x33e021[_0x2b96dc(0x5ac)](_0x2b96dc(0xa3f))[_0x2b96dc(0x794)][_0x2b96dc(0x33d)]=_0x2b96dc(0x379),_0x33e021['querySelector'](_0x2b96dc(0x53a))[_0x2b96dc(0x794)]['display']=_0x2b96dc(0x379),_0x33e021['querySelector'](_0x2b96dc(0x2e9))[_0x2b96dc(0x794)][_0x2b96dc(0x33d)]=_0x2b96dc(0x379),_0x33e021[_0x2b96dc(0x5ac)]('#post-public-text')[_0x2b96dc(0x569)]=_0x2b96dc(0x695);const _0xae215b=document[_0x2b96dc(0x11e3)]('post-visibility-groups');_0xae215b[_0x2b96dc(0x595)]='';const _0x4cf4d7=await _0x2e83f8[_0x2b96dc(0xd31)][_0x2b96dc(0x508)]();_0x4cf4d7['length']>0x0?_0x4cf4d7[_0x2b96dc(0x494)](_0x38f5fc=>{const _0x404e47=_0x2b96dc,_0x141d52=document['createElement'](_0x404e47(0x308));_0x141d52[_0x404e47(0x794)][_0x404e47(0x33d)]=_0x404e47(0x11ac),_0x141d52[_0x404e47(0x595)]=_0x404e47(0xbf0)+_0x38f5fc['id']+'\x22>\x20'+_0x38f5fc['name'],_0xae215b[_0x404e47(0x120c)](_0x141d52);}):_0xae215b['innerHTML']=_0x2b96dc(0xeb5),_0x33e021[_0x2b96dc(0x505)]['add'](_0x2b96dc(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x785))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x384f9f=_0x47aceb;_0x2f6e92();const _0x213607=document[_0x384f9f(0x11e3)]('create-post-modal');_0x213607[_0x384f9f(0xaca)][_0x384f9f(0x1131)]='complex',_0x213607['querySelector'](_0x384f9f(0xa3f))[_0x384f9f(0x794)][_0x384f9f(0x33d)]=_0x384f9f(0x10f4),_0x213607[_0x384f9f(0x5ac)](_0x384f9f(0x53a))['classList'][_0x384f9f(0x252)]('active'),_0x213607[_0x384f9f(0x5ac)]('#text-image-mode-content')[_0x384f9f(0x505)][_0x384f9f(0x957)](_0x384f9f(0x1fc)),_0x213607[_0x384f9f(0x5ac)](_0x384f9f(0xe3))['placeholder']=_0x384f9f(0x860);const _0x19d07b=document['getElementById'](_0x384f9f(0x1302));_0x19d07b[_0x384f9f(0x595)]='';const _0x20340c=await _0x2e83f8[_0x384f9f(0xd31)][_0x384f9f(0x508)]();_0x20340c['length']>0x0?_0x20340c[_0x384f9f(0x494)](_0x203444=>{const _0x1a5eb5=_0x384f9f,_0x34f8bd=document[_0x1a5eb5(0x383)](_0x1a5eb5(0x308));_0x34f8bd[_0x1a5eb5(0x794)]['display']='block',_0x34f8bd[_0x1a5eb5(0x595)]=_0x1a5eb5(0xbf0)+_0x203444['id']+_0x1a5eb5(0x656)+_0x203444[_0x1a5eb5(0x278)],_0x19d07b['appendChild'](_0x34f8bd);}):_0x19d07b[_0x384f9f(0x595)]=_0x384f9f(0xeb5),_0x213607[_0x384f9f(0x505)]['add'](_0x384f9f(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x55f))['addEventListener']('click',async()=>{await _0x133452(),_0x4e7698('album-screen');}),document[_0x47aceb(0x11e3)](_0x47aceb(0x31c))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x583aa3=_0x47aceb;_0x4e7698(_0x583aa3(0xf1e)),_0x1c77e7(_0x583aa3(0x431));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x199))[_0x47aceb(0x4b8)]('click',()=>{const _0x1d808c=_0x47aceb;_0x5de8b7['activeAlbumId']=null,_0x4e7698(_0x1d808c(0x88e));}),document[_0x47aceb(0x11e3)]('album-upload-photo-btn')['addEventListener']('click',()=>document[_0x47aceb(0x11e3)](_0x47aceb(0x927))[_0x47aceb(0x1041)]()),document[_0x47aceb(0x11e3)](_0x47aceb(0x927))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),async _0x298e69=>{const _0x1e0e1c=_0x47aceb;if(!_0x5de8b7[_0x1e0e1c(0xc3f)])return;const _0x4ac849=_0x298e69[_0x1e0e1c(0xd7c)][_0x1e0e1c(0x5c9)];if(!_0x4ac849[_0x1e0e1c(0x594)])return;const _0x1ab1c3=await _0x2e83f8[_0x1e0e1c(0x5d1)][_0x1e0e1c(0x1289)](_0x5de8b7[_0x1e0e1c(0xc3f)]);for(const _0x2ebf74 of _0x4ac849){const _0x2a17be=await new Promise(_0x3b2fd4=>{const _0x1276af=_0x1e0e1c,_0x37a3ff=new FileReader();_0x37a3ff[_0x1276af(0x1e5)]=()=>_0x3b2fd4(_0x37a3ff['result']),_0x37a3ff['readAsDataURL'](_0x2ebf74);});await _0x2e83f8[_0x1e0e1c(0xc62)][_0x1e0e1c(0x252)]({'albumId':_0x5de8b7[_0x1e0e1c(0xc3f)],'url':_0x2a17be,'createdAt':Date[_0x1e0e1c(0x1182)]()});}const _0x3e222e=await _0x2e83f8[_0x1e0e1c(0xc62)][_0x1e0e1c(0x129e)](_0x1e0e1c(0xc8a))[_0x1e0e1c(0x119e)](_0x5de8b7[_0x1e0e1c(0xc3f)])[_0x1e0e1c(0xc85)](),_0x10b62d={'photoCount':_0x3e222e};if(!_0x1ab1c3[_0x1e0e1c(0x4fd)]||_0x1ab1c3[_0x1e0e1c(0x4c6)][_0x1e0e1c(0x3ad)]('placeholder')){const _0x10aca5=await _0x2e83f8[_0x1e0e1c(0xc62)][_0x1e0e1c(0x129e)](_0x1e0e1c(0xc8a))['equals'](_0x5de8b7[_0x1e0e1c(0xc3f)])[_0x1e0e1c(0x12c1)]();if(_0x10aca5)_0x10b62d[_0x1e0e1c(0x4c6)]=_0x10aca5[_0x1e0e1c(0x10ac)];}await _0x2e83f8[_0x1e0e1c(0x5d1)][_0x1e0e1c(0x1225)](_0x5de8b7['activeAlbumId'],_0x10b62d),await _0x1228fc(),await _0x133452(),_0x298e69[_0x1e0e1c(0xd7c)]['value']=null,alert(_0x1e0e1c(0x502));}),document['getElementById'](_0x47aceb(0x9bb))[_0x47aceb(0x4b8)]('click',async _0x3df0a3=>{const _0x412061=_0x47aceb,_0x583fef=_0x3df0a3[_0x412061(0xd7c)]['closest'](_0x412061(0xd4b)),_0x52b2e5=_0x3df0a3[_0x412061(0xd7c)]['closest'](_0x412061(0xe3b));if(_0x583fef){_0x3df0a3[_0x412061(0x7cb)]();const _0x7f178a=parseInt(_0x583fef[_0x412061(0xaca)][_0x412061(0x124e)]),_0x3d09be=await _0x58fd60(_0x412061(0xec0),_0x412061(0x1030),{'confirmButtonClass':'btn-danger'});if(_0x3d09be){const _0x9feeb4=await _0x2e83f8[_0x412061(0xc62)][_0x412061(0x1289)](_0x7f178a);if(!_0x9feeb4)return;await _0x2e83f8[_0x412061(0xc62)][_0x412061(0xc0c)](_0x7f178a);const _0x8ce790=await _0x2e83f8[_0x412061(0x5d1)][_0x412061(0x1289)](_0x5de8b7['activeAlbumId']),_0x4e2244=(_0x8ce790[_0x412061(0x4fd)]||0x1)-0x1,_0x5c2c2f={'photoCount':_0x4e2244};if(_0x8ce790[_0x412061(0x4c6)]===_0x9feeb4[_0x412061(0x10ac)]){const _0x4f509e=await _0x2e83f8[_0x412061(0xc62)]['where'](_0x412061(0xc8a))[_0x412061(0x119e)](_0x5de8b7[_0x412061(0xc3f)])[_0x412061(0x12c1)]();_0x5c2c2f[_0x412061(0x4c6)]=_0x4f509e?_0x4f509e[_0x412061(0x10ac)]:'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png';}await _0x2e83f8['qzoneAlbums'][_0x412061(0x1225)](_0x5de8b7['activeAlbumId'],_0x5c2c2f),await _0x1228fc(),await _0x133452(),alert(_0x412061(0x1261));}}else _0x52b2e5&&_0x30a532(_0x52b2e5['src']);}),document['getElementById']('photo-viewer-close-btn')['addEventListener'](_0x47aceb(0x1041),_0xa953cf),document[_0x47aceb(0x11e3)](_0x47aceb(0xa9d))[_0x47aceb(0x4b8)]('click',_0x12a7fa),document[_0x47aceb(0x11e3)]('photo-viewer-prev-btn')['addEventListener'](_0x47aceb(0x1041),_0x518812),document['addEventListener'](_0x47aceb(0x330),_0xcf052d=>{const _0x36a66a=_0x47aceb;if(!_0x568b1b['isOpen'])return;if(_0xcf052d[_0x36a66a(0xb8c)]===_0x36a66a(0xfcb))_0x12a7fa();else{if(_0xcf052d['key']===_0x36a66a(0x7c9))_0x518812();else _0xcf052d['key']===_0x36a66a(0x55e)&&_0xa953cf();}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x117e))['addEventListener'](_0x47aceb(0x1041),async()=>{const _0x243adf=_0x47aceb,_0x6c287=await _0x231a5a(_0x243adf(0x183),_0x243adf(0xc8c));if(_0x6c287&&_0x6c287[_0x243adf(0xeb7)]()){const _0x2ea4d1={'name':_0x6c287[_0x243adf(0xeb7)](),'coverUrl':_0x243adf(0x57f),'photoCount':0x0,'createdAt':Date[_0x243adf(0x1182)]()};await _0x2e83f8[_0x243adf(0x5d1)][_0x243adf(0x252)](_0x2ea4d1),await _0x133452(),alert('相册\x20\x22'+_0x6c287+_0x243adf(0xde9));}else _0x6c287!==null&&alert(_0x243adf(0xb07));}),document[_0x47aceb(0x11e3)]('cancel-create-post-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>document[_0x47aceb(0x11e3)](_0x47aceb(0x1210))[_0x47aceb(0x505)][_0x47aceb(0x957)](_0x47aceb(0x250))),document[_0x47aceb(0x11e3)](_0x47aceb(0xc00))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>document[_0x47aceb(0x11e3)](_0x47aceb(0xacb))[_0x47aceb(0x1041)]()),document[_0x47aceb(0x11e3)](_0x47aceb(0xacb))['addEventListener'](_0x47aceb(0xfeb),_0xea7162=>{const _0x20a068=_0x47aceb,_0x2eaa45=_0xea7162['target'][_0x20a068(0x5c9)][0x0];if(_0x2eaa45){const _0x5c16c9=new FileReader();_0x5c16c9[_0x20a068(0x1e5)]=_0x36410d=>{const _0x15372b=_0x20a068;document['getElementById'](_0x15372b(0x68a))['src']=_0x36410d[_0x15372b(0xd7c)][_0x15372b(0x255)],document[_0x15372b(0x11e3)]('post-image-preview-container')['classList']['add'](_0x15372b(0x250)),document[_0x15372b(0x11e3)](_0x15372b(0xd3d))['style'][_0x15372b(0x33d)]=_0x15372b(0x11ac);},_0x5c16c9[_0x20a068(0x1270)](_0x2eaa45);}}),document[_0x47aceb(0x11e3)](_0x47aceb(0xd97))[_0x47aceb(0x4b8)]('click',async()=>{const _0x1bf6c8=_0x47aceb,_0x239ac7=await _0x231a5a(_0x1bf6c8(0xea2),'请输入网络图片的链接','','url');_0x239ac7&&(document[_0x1bf6c8(0x11e3)](_0x1bf6c8(0x68a))['src']=_0x239ac7,document[_0x1bf6c8(0x11e3)]('post-image-preview-container')[_0x1bf6c8(0x505)][_0x1bf6c8(0x252)]('visible'),document[_0x1bf6c8(0x11e3)](_0x1bf6c8(0xd3d))[_0x1bf6c8(0x794)]['display']=_0x1bf6c8(0x11ac));}),document[_0x47aceb(0x11e3)](_0x47aceb(0xdde))['addEventListener']('click',()=>_0x2f6e92());const _0x1802c9=document['getElementById'](_0x47aceb(0x291)),_0xb2e725=document[_0x47aceb(0x11e3)](_0x47aceb(0x518)),_0x5f0615=document['getElementById'](_0x47aceb(0xbb1)),_0x56217a=document[_0x47aceb(0x11e3)]('text-image-mode-content');_0x1802c9[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x6df0b8=_0x47aceb;_0x1802c9[_0x6df0b8(0x505)]['add']('active'),_0xb2e725[_0x6df0b8(0x505)][_0x6df0b8(0x957)]('active'),_0x5f0615['classList']['add'](_0x6df0b8(0x1fc)),_0x56217a[_0x6df0b8(0x505)][_0x6df0b8(0x957)](_0x6df0b8(0x1fc));}),_0xb2e725[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x8d84fb=_0x47aceb;_0xb2e725['classList'][_0x8d84fb(0x252)](_0x8d84fb(0x1fc)),_0x1802c9['classList'][_0x8d84fb(0x957)](_0x8d84fb(0x1fc)),_0x56217a['classList']['add']('active'),_0x5f0615['classList']['remove'](_0x8d84fb(0x1fc));}),document['getElementById']('confirm-create-post-btn')['addEventListener'](_0x47aceb(0x1041),async()=>{const _0x2e8ed5=_0x47aceb,_0x5040b6=document['getElementById']('create-post-modal'),_0x1c5722=_0x5040b6[_0x2e8ed5(0xaca)][_0x2e8ed5(0x1131)],_0x1a29e6=document[_0x2e8ed5(0x5ac)]('input[name=\x22visibility\x22]:checked')[_0x2e8ed5(0xf27)];let _0x871122=null;_0x1a29e6===_0x2e8ed5(0x2bb)&&(_0x871122=Array[_0x2e8ed5(0xee2)](document['querySelectorAll'](_0x2e8ed5(0x8e0)))['map'](_0x39a768=>parseInt(_0x39a768[_0x2e8ed5(0xf27)])));let _0x54e9b9={};const _0x3a476f={'timestamp':Date[_0x2e8ed5(0x1182)](),'authorId':_0x2e8ed5(0x21c),'visibleGroupIds':_0x871122};if(_0x1c5722===_0x2e8ed5(0xc40)){const _0x1edeb=document[_0x2e8ed5(0x11e3)](_0x2e8ed5(0x554))[_0x2e8ed5(0xf27)]['trim']();if(!_0x1edeb){alert(_0x2e8ed5(0xb82));return;}_0x54e9b9={..._0x3a476f,'type':_0x2e8ed5(0xc40),'content':_0x1edeb};}else{const _0x25d8f1=document[_0x2e8ed5(0x11e3)]('post-public-text')[_0x2e8ed5(0xf27)][_0x2e8ed5(0xeb7)](),_0x21aad4=document[_0x2e8ed5(0x11e3)](_0x2e8ed5(0xbb1))['classList'][_0x2e8ed5(0x1121)](_0x2e8ed5(0x1fc));if(_0x21aad4){const _0x362e12=document[_0x2e8ed5(0x11e3)](_0x2e8ed5(0x68a))[_0x2e8ed5(0xf0a)],_0x36d532=document[_0x2e8ed5(0x11e3)](_0x2e8ed5(0x259))[_0x2e8ed5(0xf27)][_0x2e8ed5(0xeb7)]();if(!_0x362e12||!(_0x362e12[_0x2e8ed5(0xb6c)](_0x2e8ed5(0xd5))||_0x362e12[_0x2e8ed5(0xb6c)](_0x2e8ed5(0xf3b)))){alert('请先添加一张图片再发布动态哦！');return;}if(!_0x36d532){alert('请为你的图片添加一个简单的描述（必填，给AI看的）！');return;}_0x54e9b9={..._0x3a476f,'type':_0x2e8ed5(0x332),'publicText':_0x25d8f1,'imageUrl':_0x362e12,'imageDescription':_0x36d532};}else{const _0x39dd25=document[_0x2e8ed5(0x11e3)](_0x2e8ed5(0x626))[_0x2e8ed5(0xf27)][_0x2e8ed5(0xeb7)]();if(!_0x39dd25){alert(_0x2e8ed5(0x5f8));return;}_0x54e9b9={..._0x3a476f,'type':_0x2e8ed5(0x887),'publicText':_0x25d8f1,'hiddenContent':_0x39dd25};}}const _0x73799e=await _0x2e83f8[_0x2e8ed5(0x1218)][_0x2e8ed5(0x252)](_0x54e9b9);let _0x2c6ecc=_0x54e9b9['content']||_0x54e9b9['publicText']||_0x54e9b9[_0x2e8ed5(0x6b6)]||_0x54e9b9[_0x2e8ed5(0x6f7)]||_0x2e8ed5(0x81b);_0x2c6ecc=_0x2c6ecc[_0x2e8ed5(0x8d4)](0x0,0x32)+(_0x2c6ecc[_0x2e8ed5(0x594)]>0x32?'...':'');for(const _0x12a496 in _0x5de8b7[_0x2e8ed5(0x737)]){const _0x4dd54b=_0x5de8b7[_0x2e8ed5(0x737)][_0x12a496];if(_0x4dd54b[_0x2e8ed5(0x1244)])continue;let _0x57022c=![];const _0x567580=_0x54e9b9[_0x2e8ed5(0xcb9)];if(!_0x567580||_0x567580[_0x2e8ed5(0x594)]===0x0)_0x57022c=!![];else _0x4dd54b[_0x2e8ed5(0xe0d)]&&_0x567580[_0x2e8ed5(0x3ad)](_0x4dd54b[_0x2e8ed5(0xe0d)])&&(_0x57022c=!![]);if(_0x57022c){const _0x4eedcd={'role':_0x2e8ed5(0xf72),'content':_0x2e8ed5(0x2c7)+_0x73799e+_0x2e8ed5(0xe4d)+_0x2c6ecc+_0x2e8ed5(0x12f1),'timestamp':Date[_0x2e8ed5(0x1182)](),'isHidden':!![]};_0x4dd54b[_0x2e8ed5(0x49e)]['push'](_0x4eedcd),await _0x2e83f8['chats'][_0x2e8ed5(0xe3c)](_0x4dd54b);}}await _0xae9c28(),_0x5040b6[_0x2e8ed5(0x505)][_0x2e8ed5(0x957)](_0x2e8ed5(0x250)),alert(_0x2e8ed5(0xe11));});const _0x32c70c=document[_0x47aceb(0x11e3)](_0x47aceb(0x4f7));let _0x431236={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0x19933c(_0x267b9d=null){const _0x52ff20=_0x47aceb;document[_0x52ff20(0x10d6)](_0x52ff20(0xe08))['forEach'](_0x1a73f3=>{const _0x2a8151=_0x52ff20;_0x1a73f3!==_0x267b9d&&_0x1a73f3[_0x2a8151(0x5ac)]('.qzone-post-item')[_0x2a8151(0x505)][_0x2a8151(0x957)](_0x2a8151(0x4cd));});}async function _0x60fce9(_0x11a2fc){const _0x5797d4=_0x47aceb;_0x11a2fc[_0x5797d4(0x7cb)]();const _0x295d0e=_0x11a2fc[_0x5797d4(0xd7c)],_0x10f445=_0x295d0e[_0x5797d4(0xfe1)](_0x5797d4(0xa24));if(_0x10f445){const _0x385881=_0x10f445[_0x5797d4(0xfe1)]('.qzone-post-container'),_0x29acc9=parseInt(_0x385881[_0x5797d4(0xaca)][_0x5797d4(0x2f0)]),_0x21b99f=parseInt(_0x10f445[_0x5797d4(0xaca)][_0x5797d4(0x852)]);if(isNaN(_0x29acc9)||isNaN(_0x21b99f))return;const _0x1c92a2=_0x2814a8[_0x5797d4(0xe79)](_0x10d4f0=>_0x10d4f0['id']===_0x29acc9);if(!_0x1c92a2||!_0x1c92a2['comments']||!_0x1c92a2[_0x5797d4(0x1092)][_0x21b99f])return;const _0x4ae15c=_0x1c92a2[_0x5797d4(0x1092)][_0x21b99f],_0x5773db=await _0x58fd60('删除评论',_0x5797d4(0xc49),{'confirmButtonClass':'btn-danger'});if(_0x5773db){_0x1c92a2['comments'][_0x5797d4(0xfd0)](_0x21b99f,0x1),await _0x2e83f8[_0x5797d4(0x1218)][_0x5797d4(0x1225)](_0x29acc9,{'comments':_0x1c92a2['comments']});if(_0x4ae15c&&_0x4ae15c[_0x5797d4(0x2ac)]===_0x5de8b7[_0x5797d4(0x1c5)][_0x5797d4(0xa33)]){console['log'](_0x5797d4(0x905));const _0x39fad2=new Set();_0x1c92a2[_0x5797d4(0x5d9)]!==_0x5797d4(0x21c)&&_0x39fad2[_0x5797d4(0x252)](_0x1c92a2['authorId']);if(_0x4ae15c['replyTo']){const _0x6533b2=Object[_0x5797d4(0x4ca)](_0x5de8b7[_0x5797d4(0x737)])[_0x5797d4(0xe79)](_0x1adabb=>_0x1adabb['originalName']===_0x4ae15c['replyTo']);_0x6533b2&&_0x39fad2['add'](_0x6533b2['id']);}const _0x358b09=(_0x1c92a2[_0x5797d4(0x12aa)]||_0x1c92a2['content']||'')['substring'](0x0,0x1e),_0x2c9193=_0x5de8b7[_0x5797d4(0x1c5)][_0x5797d4(0xa33)];let _0x4d3dcc;const _0x42589a=_0x5de8b7[_0x5797d4(0xa67)][_0x5797d4(0xe79)](_0x3d7e9e=>_0x3d7e9e[_0x5797d4(0x10ac)]===_0x4ae15c[_0x5797d4(0x1197)]);if(_0x42589a)_0x4d3dcc=_0x5797d4(0x2bd)+_0x2c9193+_0x5797d4(0xbb9)+_0x358b09+_0x5797d4(0xe1a)+_0x42589a[_0x5797d4(0x278)]+'”。';else{if(_0x4ae15c['replyTo']){const _0x3a7fb9=_0x4a0eba(_0x4ae15c[_0x5797d4(0x1083)]);_0x4d3dcc='用户\x27'+_0x2c9193+_0x5797d4(0xbb9)+_0x358b09+_0x5797d4(0xa28)+_0x3a7fb9+_0x5797d4(0x977)+_0x4ae15c[_0x5797d4(0x1197)]+'”。';}else _0x4d3dcc=_0x5797d4(0x2bd)+_0x2c9193+_0x5797d4(0xba2)+_0x358b09+_0x5797d4(0x118)+_0x4ae15c[_0x5797d4(0x1197)]+'”。';}const _0x529421=_0x5797d4(0x116a)+_0x4d3dcc+'请你对此作出回应。]';for(const _0x3e72f4 of _0x39fad2){const _0x42251c=_0x5de8b7[_0x5797d4(0x737)][_0x3e72f4];if(_0x42251c){const _0x43948a=_0x42251c['history'][_0x5797d4(0x594)];_0x42251c['history']=_0x42251c[_0x5797d4(0x49e)][_0x5797d4(0x138)](_0x308cc8=>!(_0x308cc8[_0x5797d4(0xbf5)]&&_0x308cc8[_0x5797d4(0xba4)]==='system'&&_0x308cc8['content']===_0x529421)),_0x42251c[_0x5797d4(0x49e)][_0x5797d4(0x594)]<_0x43948a&&(console[_0x5797d4(0x84b)](_0x5797d4(0x30b)+_0x42251c[_0x5797d4(0x278)]+_0x5797d4(0xb71)),await _0x2e83f8[_0x5797d4(0x737)][_0x5797d4(0xe3c)](_0x42251c));}}}await _0x4e2ca1(_0x29acc9);}return;}const _0x168a2f=_0x295d0e[_0x5797d4(0xfe1)](_0x5797d4(0x9dc));if(_0x168a2f){const _0x398e17=_0x168a2f[_0x5797d4(0xfe1)](_0x5797d4(0xe08));if(!_0x398e17)return;const _0x485534=parseInt(_0x398e17[_0x5797d4(0xaca)][_0x5797d4(0x2f0)]);_0x29da69[_0x5797d4(0x96b)]&&_0x29da69[_0x5797d4(0xa2c)]===_0x485534?_0x33db3a():_0x36b24c(_0x485534,_0x168a2f);return;}const _0x1d7992=_0x295d0e[_0x5797d4(0xfe1)](_0x5797d4(0x27f));if(_0x1d7992){const _0x5111eb=parseInt(_0x1d7992[_0x5797d4(0xaca)]['postId']),_0x4a0e3e=_0x1d7992[_0x5797d4(0xaca)][_0x5797d4(0x42a)],_0x3c7e10=_0x1d7992[_0x5797d4(0xaca)][_0x5797d4(0xbdd)];if(!_0x4a0e3e||!_0x3c7e10||_0x4a0e3e===_0x5de8b7['qzoneSettings'][_0x5797d4(0xa33)]){_0x3dd99e(_0x1d7992[_0x5797d4(0xfe1)]('.qzone-post-container'));return;}_0x362af8={'postId':_0x5111eb,'replyToName':_0x4a0e3e,'replyToDisplayName':_0x3c7e10};const _0x58ec4d=_0x1d7992[_0x5797d4(0xfe1)]('.qzone-post-container'),_0x228f31=_0x58ec4d['querySelector'](_0x5797d4(0x71b));_0x228f31[_0x5797d4(0x569)]=_0x5797d4(0xed0)+_0x3c7e10+':',_0x228f31[_0x5797d4(0xc1f)]();return;}if(_0x295d0e['classList'][_0x5797d4(0x1121)](_0x5797d4(0x74a))){const _0x236dc2=_0x295d0e[_0x5797d4(0xfe1)]('.qzone-post-container');if(_0x236dc2&&_0x236dc2[_0x5797d4(0xaca)][_0x5797d4(0x2f0)])_0x2ea74f(parseInt(_0x236dc2[_0x5797d4(0xaca)]['postId']));return;}if(_0x295d0e[_0x5797d4(0xc81)]==='IMG'&&_0x295d0e[_0x5797d4(0xaca)][_0x5797d4(0x1279)]){_0x2fb06(_0x5797d4(0x111e),_0x295d0e[_0x5797d4(0xaca)][_0x5797d4(0x1279)]['replace'](/<br>/g,'\x0a'));return;}const _0x2bd3e2=_0x295d0e[_0x5797d4(0xfe1)](_0x5797d4(0xe08));if(!_0x2bd3e2)return;const _0x2234d7=parseInt(_0x2bd3e2[_0x5797d4(0xaca)][_0x5797d4(0x2f0)]);if(isNaN(_0x2234d7))return;if(_0x295d0e[_0x5797d4(0xfe1)](_0x5797d4(0xd16))){const _0xbafe2a=await _0x58fd60(_0x5797d4(0x93b),_0x5797d4(0x10a6),{'confirmButtonClass':_0x5797d4(0x8a6)});_0xbafe2a&&(_0x2bd3e2[_0x5797d4(0x794)]['transition']=_0x5797d4(0x365),_0x2bd3e2['style']['transform']=_0x5797d4(0x4b2),_0x2bd3e2[_0x5797d4(0x794)][_0x5797d4(0x12fa)]='0',setTimeout(async()=>{const _0x279819=_0x5797d4;await _0x2e83f8[_0x279819(0x1218)][_0x279819(0xc0c)](_0x2234d7);const _0x1af671=_0x279819(0x7bb)+_0x2234d7+')';for(const _0x1ab23d in _0x5de8b7[_0x279819(0x737)]){const _0x1250fb=_0x5de8b7['chats'][_0x1ab23d],_0x18ae08=_0x1250fb['history'][_0x279819(0x594)];_0x1250fb[_0x279819(0x49e)]=_0x1250fb[_0x279819(0x49e)][_0x279819(0x138)](_0x40231d=>!(_0x40231d[_0x279819(0xba4)]===_0x279819(0xf72)&&_0x40231d[_0x279819(0x9a5)][_0x279819(0x3ad)](_0x1af671)));if(_0x1250fb[_0x279819(0x49e)]['length']<_0x18ae08)await _0x2e83f8['chats'][_0x279819(0xe3c)](_0x1250fb);}await _0xae9c28(),alert('动态已删除。');},0x12c));return;}const _0x1cfe1f=_0x295d0e[_0x5797d4(0xfe1)](_0x5797d4(0x1019));if(_0x1cfe1f){if(_0x1cfe1f[_0x5797d4(0x505)][_0x5797d4(0x1121)](_0x5797d4(0x45a))){_0x1e8be1(_0x2234d7);return;}if(_0x1cfe1f[_0x5797d4(0x505)][_0x5797d4(0x1121)]('like')){const _0x1a8b66=_0x2814a8[_0x5797d4(0xe79)](_0x4b910b=>_0x4b910b['id']===_0x2234d7);if(!_0x1a8b66)return;if(!_0x1a8b66['likes'])_0x1a8b66[_0x5797d4(0x7eb)]=[];const _0x26eab3=_0x5de8b7[_0x5797d4(0x1c5)][_0x5797d4(0xa33)],_0x5d1d79=_0x1a8b66[_0x5797d4(0x7eb)][_0x5797d4(0xce1)](_0x26eab3);_0x5d1d79>-0x1?_0x1a8b66['likes']['splice'](_0x5d1d79,0x1):(_0x1a8b66[_0x5797d4(0x7eb)][_0x5797d4(0xf5)](_0x26eab3),_0x1cfe1f[_0x5797d4(0x505)]['add']('animate-like'),_0x1cfe1f[_0x5797d4(0x4b8)]('animationend',()=>_0x1cfe1f[_0x5797d4(0x505)][_0x5797d4(0x957)](_0x5797d4(0x8ce)),{'once':!![]})),await _0x2e83f8[_0x5797d4(0x1218)]['update'](_0x2234d7,{'likes':_0x1a8b66[_0x5797d4(0x7eb)]}),await _0x4e2ca1(_0x2234d7);}if(_0x1cfe1f['classList']['contains'](_0x5797d4(0x12b0))){const _0x22747c=await _0x2e83f8[_0x5797d4(0xc3e)]['where']({'type':'qzone_post','content.id':_0x2234d7})[_0x5797d4(0x12c1)]();if(_0x22747c)await _0x2e83f8['favorites'][_0x5797d4(0xc0c)](_0x22747c['id']),await _0x2fb06('提示',_0x5797d4(0x3af));else{const _0x515d24=await _0x2e83f8['qzonePosts'][_0x5797d4(0x1289)](_0x2234d7);_0x515d24&&(await _0x2e83f8['favorites'][_0x5797d4(0x252)]({'type':_0x5797d4(0x3cc),'content':_0x515d24,'timestamp':Date[_0x5797d4(0x1182)]()}),await _0x2fb06('提示',_0x5797d4(0x1e3)));}await _0x4e2ca1(_0x2234d7);}return;}const _0x552e4e=_0x295d0e[_0x5797d4(0xfe1)](_0x5797d4(0xf7a));if(_0x552e4e){const _0xa57a59=_0x2bd3e2[_0x5797d4(0x5ac)](_0x5797d4(0x71b)),_0x20253b=_0xa57a59[_0x5797d4(0xf27)][_0x5797d4(0xeb7)]();if(!_0x20253b)return alert(_0x5797d4(0xdc9));const _0x5b2715=_0x2814a8[_0x5797d4(0xe79)](_0x5f3dd9=>_0x5f3dd9['id']===_0x2234d7);if(!_0x5b2715)return;if(!_0x5b2715[_0x5797d4(0x1092)])_0x5b2715[_0x5797d4(0x1092)]=[];const _0x1a4e6b={'commenterName':_0x5de8b7[_0x5797d4(0x1c5)][_0x5797d4(0xa33)],'text':_0x20253b,'timestamp':Date[_0x5797d4(0x1182)](),'replyTo':_0x362af8&&_0x362af8[_0x5797d4(0x2f0)]===_0x2234d7?_0x362af8['replyToName']:null};_0x5b2715[_0x5797d4(0x1092)][_0x5797d4(0xf5)](_0x1a4e6b),await _0x2e83f8[_0x5797d4(0x1218)]['update'](_0x2234d7,{'comments':_0x5b2715[_0x5797d4(0x1092)]});let _0x440d95=(_0x5b2715[_0x5797d4(0x12aa)]||_0x5b2715[_0x5797d4(0x9a5)]||'')[_0x5797d4(0x8d4)](0x0,0x1e);const _0x4d4941=_0x5de8b7[_0x5797d4(0x1c5)][_0x5797d4(0xa33)],_0x4450fe=new Set();if(_0x5b2715[_0x5797d4(0x5d9)]!==_0x5797d4(0x21c))_0x4450fe['add'](_0x5b2715[_0x5797d4(0x5d9)]);if(_0x1a4e6b[_0x5797d4(0x1083)]&&_0x1a4e6b[_0x5797d4(0x1083)]!==_0x4d4941){const _0x216fdb=Object[_0x5797d4(0x4ca)](_0x5de8b7[_0x5797d4(0x737)])['find'](_0xa2ac91=>_0xa2ac91['originalName']===_0x1a4e6b[_0x5797d4(0x1083)]);if(_0x216fdb)_0x4450fe['add'](_0x216fdb['id']);}for(const _0x1b3bfd of _0x4450fe){const _0x381219=_0x5de8b7[_0x5797d4(0x737)][_0x1b3bfd];if(_0x381219&&!_0x381219[_0x5797d4(0x1244)]){const _0x1dab3f=_0x5de8b7[_0x5797d4(0xa67)][_0x5797d4(0xe79)](_0x858dda=>_0x858dda['url']===_0x20253b);let _0x2d9b0b=_0x1dab3f?'用户\x27'+_0x4d4941+_0x5797d4(0xbb9)+_0x440d95+_0x5797d4(0xe1a)+_0x1dab3f['name']+'”。':_0x1a4e6b[_0x5797d4(0x1083)]?_0x5797d4(0x2bd)+_0x4d4941+'\x27刚刚在你的动态“'+_0x440d95+'”下，回复了\x27'+_0x362af8['replyToDisplayName']+_0x5797d4(0x977)+_0x20253b+'”。':_0x5797d4(0x2bd)+_0x4d4941+_0x5797d4(0xba2)+_0x440d95+'”，内容是：“'+_0x20253b+'”。';const _0x2c77ec={'role':_0x5797d4(0xf72),'content':'[系统提示：'+_0x2d9b0b+_0x5797d4(0xe29),'timestamp':Date[_0x5797d4(0x1182)](),'isHidden':!![]};_0x381219[_0x5797d4(0x49e)][_0x5797d4(0xf5)](_0x2c77ec),await _0x2e83f8['chats'][_0x5797d4(0xe3c)](_0x381219);}}_0xa57a59[_0x5797d4(0xf27)]='',_0x3dd99e(_0x2bd3e2),await _0x4e2ca1(_0x2234d7);return;}}const _0x509be6=_0x56430c=>{const _0x137632=_0x47aceb,_0x53dfd=_0x56430c[_0x137632(0xd7c)];if(_0x53dfd[_0x137632(0xfe1)]('.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper'))return;const _0x42bf1a=_0x56430c[_0x137632(0xd7c)][_0x137632(0xfe1)](_0x137632(0xe08));if(!_0x42bf1a)return;_0x19933c(_0x42bf1a),_0x431236[_0x137632(0x1158)]=_0x42bf1a,_0x431236['isDragging']=!![],_0x431236[_0x137632(0x764)]=!![],_0x431236['swipeDirection']=null,_0x431236[_0x137632(0xed3)]=_0x56430c[_0x137632(0xa20)][_0x137632(0x3ad)](_0x137632(0x110a))?_0x56430c[_0x137632(0xa4a)]:_0x56430c[_0x137632(0x371)][0x0]['pageX'],_0x431236[_0x137632(0x1198)]=_0x56430c['type']['includes'](_0x137632(0x110a))?_0x56430c[_0x137632(0xddc)]:_0x56430c[_0x137632(0x371)][0x0]['pageY'],_0x431236[_0x137632(0x1158)]['querySelector'](_0x137632(0x866))[_0x137632(0x794)][_0x137632(0x10f6)]='none',document[_0x137632(0x4b8)](_0x137632(0x270),_0x24330b),document['addEventListener'](_0x137632(0xdcb),_0x101609),document[_0x137632(0x4b8)](_0x137632(0x19a),_0x24330b,{'passive':![]}),document[_0x137632(0x4b8)](_0x137632(0xf7b),_0x101609);},_0x24330b=_0x2d0ad5=>{const _0x108aae=_0x47aceb;if(!_0x431236[_0x108aae(0x50b)]||!_0x431236[_0x108aae(0x1158)])return;const _0x2df58d=_0x2d0ad5['type']['includes'](_0x108aae(0x110a))?_0x2d0ad5[_0x108aae(0xa4a)]:_0x2d0ad5[_0x108aae(0x371)][0x0][_0x108aae(0xa4a)],_0x400a99=_0x2d0ad5['type']['includes']('mouse')?_0x2d0ad5[_0x108aae(0xddc)]:_0x2d0ad5[_0x108aae(0x371)][0x0][_0x108aae(0xddc)],_0x43a60c=_0x2df58d-_0x431236[_0x108aae(0xed3)],_0x213faf=_0x400a99-_0x431236['startY'];_0x431236[_0x108aae(0x764)]&&(Math[_0x108aae(0xf8f)](_0x43a60c)>0x5||Math[_0x108aae(0xf8f)](_0x213faf)>0x5)&&(_0x431236[_0x108aae(0x764)]=![]);!_0x431236[_0x108aae(0x20b)]&&(Math['abs'](_0x43a60c)>Math[_0x108aae(0xf8f)](_0x213faf)?_0x431236[_0x108aae(0x20b)]=_0x108aae(0xaf6):_0x431236[_0x108aae(0x20b)]=_0x108aae(0x80e));if(_0x431236[_0x108aae(0x20b)]==='horizontal'){_0x2d0ad5[_0x108aae(0xf87)](),_0x431236[_0x108aae(0xc33)]=_0x2df58d;let _0x6f5091=Math['min'](0x0,Math[_0x108aae(0x45d)](-0x5a,_0x43a60c));_0x431236[_0x108aae(0x1158)][_0x108aae(0x5ac)](_0x108aae(0x866))[_0x108aae(0x794)]['transform']=_0x108aae(0xeab)+_0x6f5091+_0x108aae(0xd24);}},_0x101609=_0x3d405f=>{const _0x474863=_0x47aceb;document[_0x474863(0xd7a)](_0x474863(0x270),_0x24330b),document['removeEventListener'](_0x474863(0xdcb),_0x101609),document['removeEventListener']('touchmove',_0x24330b),document[_0x474863(0xd7a)](_0x474863(0xf7b),_0x101609);if(!_0x431236[_0x474863(0x50b)]||!_0x431236[_0x474863(0x1158)])return;const _0x2ce71f=_0x431236[_0x474863(0x1158)][_0x474863(0x5ac)](_0x474863(0x866));_0x2ce71f['style'][_0x474863(0x10f6)]='transform\x200.3s\x20ease';if(_0x431236[_0x474863(0x20b)]===_0x474863(0xaf6)&&!_0x431236['isClick']){const _0x1bc80f=_0x3d405f[_0x474863(0xa20)]['includes'](_0x474863(0xf7b))?_0x3d405f[_0x474863(0xe0e)][0x0]['pageX']:_0x3d405f[_0x474863(0xa4a)],_0x1b196e=_0x1bc80f-_0x431236[_0x474863(0xed3)];_0x1b196e<-0x28?_0x2ce71f[_0x474863(0x505)][_0x474863(0x252)](_0x474863(0x4cd)):_0x2ce71f[_0x474863(0x505)][_0x474863(0x957)](_0x474863(0x4cd));}_0x2ce71f[_0x474863(0x794)][_0x474863(0xb5d)]='',_0x431236[_0x474863(0x50b)]=![],_0x431236['activeContainer']=null,_0x431236[_0x474863(0x20b)]=null,_0x431236[_0x474863(0x764)]=!![];};_0x32c70c['addEventListener'](_0x47aceb(0x1041),_0x60fce9),_0x32c70c['addEventListener'](_0x47aceb(0xc23),_0x509be6),_0x32c70c[_0x47aceb(0x4b8)](_0x47aceb(0x39e),_0x509be6,{'passive':!![]}),_0x32c70c[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x3ed8f7=>{const _0x597cdc=_0x47aceb;_0x3ed8f7[_0x597cdc(0xd7c)]&&_0x3ed8f7['target']['id']===_0x597cdc(0x126f)&&_0x314b99();}),document[_0x47aceb(0x11e3)]('refine-memory-btn-header')['addEventListener'](_0x47aceb(0x1041),()=>{const _0xf10e06=_0x47aceb;_0x5de8b7[_0xf10e06(0x93d)]&&_0x2a2971(_0x5de8b7[_0xf10e06(0x93d)]);}),document[_0x47aceb(0x11e3)](_0x47aceb(0x1a7))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x43ee7d),document[_0x47aceb(0x11e3)](_0x47aceb(0x52a))[_0x47aceb(0x4b8)]('click',_0x3c4100),document['getElementById']('delete-api-preset-btn')[_0x47aceb(0x4b8)]('click',_0x491988),document[_0x47aceb(0x11e3)](_0x47aceb(0x110d))[_0x47aceb(0x4b8)]('click',()=>{const _0x39e7c1=_0x47aceb,_0x1374a0=document[_0x39e7c1(0x11e3)](_0x39e7c1(0x24b));_0x1374a0[_0x39e7c1(0x5ac)]('p')&&(_0x1374a0[_0x39e7c1(0x595)]='');const _0x18cf9e=_0x37e205();_0x1374a0[_0x39e7c1(0x120c)](_0x18cf9e),_0x18cf9e[_0x39e7c1(0x5ac)](_0x39e7c1(0xb53))[_0x39e7c1(0xc1f)]();}),document[_0x47aceb(0x11e3)](_0x47aceb(0xf1c))['addEventListener'](_0x47aceb(0x1041),_0x917ffc),document[_0x47aceb(0x11e3)](_0x47aceb(0x92c))[_0x47aceb(0x4b8)]('click',_0x1bbc9b=>{const _0x1dc3f4=_0x47aceb;_0x1bbc9b[_0x1dc3f4(0xd7c)]&&_0x1bbc9b[_0x1dc3f4(0xd7c)]['id']===_0x1dc3f4(0x11b3)&&_0x24c4e4();}),document[_0x47aceb(0x11e3)](_0x47aceb(0xcd0))[_0x47aceb(0x4b8)]('click',_0x287280),document['getElementById']('history-back-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x379ff4),document[_0x47aceb(0x11e3)](_0x47aceb(0x352))[_0x47aceb(0x4b8)]('click',_0x3de8f9=>{const _0x648e6e=_0x47aceb;_0x3de8f9[_0x648e6e(0xd7c)]['id']===_0x648e6e(0x352)&&_0x3de8f9[_0x648e6e(0xd7c)][_0x648e6e(0x505)][_0x648e6e(0x957)](_0x648e6e(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x3b3))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x540c2e),document[_0x47aceb(0x11e3)](_0x47aceb(0x41f))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x5cfbd6),document[_0x47aceb(0x11e3)]('qzone-back-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>_0x1c77e7(_0x47aceb(0xde))),document[_0x47aceb(0x11e3)](_0x47aceb(0x261))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>_0x1c77e7(_0x47aceb(0xde)));const _0x15c70d=document['getElementById'](_0x47aceb(0x95c)),_0x1d8f2f=document['getElementById']('favorites-search-clear-btn');_0x15c70d[_0x47aceb(0x4b8)](_0x47aceb(0x6be),()=>{const _0x1cc66a=_0x47aceb,_0xbb422a=_0x15c70d['value'][_0x1cc66a(0xeb7)]()[_0x1cc66a(0xb03)]();_0x1d8f2f[_0x1cc66a(0x794)][_0x1cc66a(0x33d)]=_0xbb422a?_0x1cc66a(0x11ac):_0x1cc66a(0x379);if(!_0xbb422a){_0x40f8c7(allFavoriteItems);return;}const _0x676bc=allFavoriteItems[_0x1cc66a(0x138)](_0x2e34be=>{const _0x321157=_0x1cc66a;let _0x3b85de='',_0x20a023='';if(_0x2e34be['type']==='qzone_post'){const _0xbf921f=_0x2e34be['content'];_0x3b85de+=(_0xbf921f['publicText']||'')+'\x20'+(_0xbf921f['content']||'');if(_0xbf921f['authorId']===_0x321157(0x21c))_0x20a023=_0x5de8b7[_0x321157(0x1c5)][_0x321157(0xa33)];else _0x5de8b7['chats'][_0xbf921f[_0x321157(0x5d9)]]&&(_0x20a023=_0x5de8b7[_0x321157(0x737)][_0xbf921f[_0x321157(0x5d9)]][_0x321157(0x278)]);}else{if(_0x2e34be[_0x321157(0xa20)]===_0x321157(0xb9e)){const _0x48fa82=_0x2e34be['content'];typeof _0x48fa82['content']==='string'&&(_0x3b85de=_0x48fa82[_0x321157(0x9a5)]);const _0x54b9c9=_0x5de8b7[_0x321157(0x737)][_0x2e34be[_0x321157(0x115)]];_0x54b9c9&&(_0x48fa82[_0x321157(0xba4)]==='user'?_0x20a023=_0x54b9c9[_0x321157(0x1244)]?_0x54b9c9[_0x321157(0x761)]['myNickname']||'我':'我':_0x20a023=_0x54b9c9[_0x321157(0x1244)]?_0x48fa82[_0x321157(0x768)]:_0x54b9c9[_0x321157(0x278)]);}}return _0x3b85de[_0x321157(0xb03)]()['includes'](_0xbb422a)||_0x20a023[_0x321157(0xb03)]()['includes'](_0xbb422a);});_0x40f8c7(_0x676bc);}),_0x1d8f2f['addEventListener'](_0x47aceb(0x1041),()=>{const _0x57e7c5=_0x47aceb;_0x15c70d['value']='',_0x1d8f2f[_0x57e7c5(0x794)][_0x57e7c5(0x33d)]=_0x57e7c5(0x379),_0x40f8c7(allFavoriteItems),_0x15c70d['focus']();}),document['getElementById'](_0x47aceb(0x1104))['addEventListener']('click',async()=>{const _0x510515=_0x47aceb;if(_0x281a6a[_0x510515(0x1159)]===0x0)return;const _0x326b7c=_0x5de8b7[_0x510515(0x737)][_0x5de8b7[_0x510515(0x93d)]];if(!_0x326b7c)return;const _0x37be91=[],_0x22668b=[..._0x281a6a];for(const _0x8f0321 of _0x22668b){const _0x5bd0fd=await _0x2e83f8[_0x510515(0xc3e)][_0x510515(0x129e)](_0x510515(0xc5d))[_0x510515(0x119e)](_0x8f0321)[_0x510515(0x12c1)]();if(!_0x5bd0fd){const _0x345bdd=_0x326b7c[_0x510515(0x49e)][_0x510515(0xe79)](_0x29972a=>_0x29972a[_0x510515(0x702)]===_0x8f0321);_0x345bdd&&_0x37be91['push']({'type':_0x510515(0xb9e),'content':_0x345bdd,'chatId':_0x5de8b7['activeChatId'],'timestamp':Date['now'](),'originalTimestamp':_0x345bdd[_0x510515(0x702)]});}}_0x37be91[_0x510515(0x594)]>0x0?(await _0x2e83f8['favorites'][_0x510515(0xc16)](_0x37be91),allFavoriteItems=await _0x2e83f8[_0x510515(0xc3e)]['orderBy'](_0x510515(0x702))[_0x510515(0x107)]()['toArray'](),await _0x2fb06(_0x510515(0x1196),'已成功收藏\x20'+_0x37be91['length']+'\x20条消息。')):await _0x2fb06('提示',_0x510515(0x12c6)),_0x2192b8();});const _0x307cfc=document['getElementById'](_0x47aceb(0x60e)),_0x365cd7=document[_0x47aceb(0x11e3)](_0x47aceb(0xd51)),_0x2056aa=document[_0x47aceb(0x11e3)](_0x47aceb(0x49d)),_0x30dfac=document[_0x47aceb(0x11e3)](_0x47aceb(0x657)),_0x4fdb3f=document[_0x47aceb(0x11e3)](_0x47aceb(0xa34));_0x307cfc[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x1ae156=_0x47aceb;_0x1b417c=!_0x1b417c,_0x365cd7[_0x1ae156(0x505)][_0x1ae156(0xe7e)](_0x1ae156(0xcd4),_0x1b417c),_0x1b417c?(_0x307cfc['textContent']='完成',_0x2056aa['style'][_0x1ae156(0x33d)]='block',_0x30dfac[_0x1ae156(0x794)][_0x1ae156(0x33d)]=_0x1ae156(0x379),_0x4fdb3f[_0x1ae156(0x794)][_0x1ae156(0x6dc)]=_0x1ae156(0x11ee)):(_0x307cfc[_0x1ae156(0x300)]='编辑',_0x2056aa[_0x1ae156(0x794)]['display']=_0x1ae156(0x379),_0x30dfac[_0x1ae156(0x794)][_0x1ae156(0x33d)]='flex',_0x4fdb3f[_0x1ae156(0x794)][_0x1ae156(0x6dc)]='',_0x355a00[_0x1ae156(0x7ab)](),document['querySelectorAll'](_0x1ae156(0x1014))['forEach'](_0x270507=>_0x270507[_0x1ae156(0x505)][_0x1ae156(0x957)]('selected')),document['getElementById'](_0x1ae156(0x230))[_0x1ae156(0x300)]='删除\x20(0)');}),document[_0x47aceb(0x11e3)]('favorites-list')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x315075=>{const _0x5acec3=_0x47aceb,_0x52f559=_0x315075['target'],_0x15c587=_0x52f559[_0x5acec3(0xfe1)](_0x5acec3(0xdea));if(_0x52f559['tagName']===_0x5acec3(0x8eb)&&_0x52f559[_0x5acec3(0xaca)][_0x5acec3(0x1279)]){const _0x1f294e=_0x52f559[_0x5acec3(0xaca)]['hiddenText'];_0x2fb06('图片内容',_0x1f294e[_0x5acec3(0x1018)](/<br>/g,'\x0a'));return;}if(!_0x1b417c)return;if(!_0x15c587)return;const _0x123b53=parseInt(_0x15c587[_0x5acec3(0xaca)][_0x5acec3(0x52c)]);if(isNaN(_0x123b53))return;_0x355a00[_0x5acec3(0x72a)](_0x123b53)?(_0x355a00[_0x5acec3(0xc0c)](_0x123b53),_0x15c587['classList'][_0x5acec3(0x957)](_0x5acec3(0xbbc))):(_0x355a00[_0x5acec3(0x252)](_0x123b53),_0x15c587['classList'][_0x5acec3(0x252)]('selected')),document[_0x5acec3(0x11e3)]('favorites-delete-selected-btn')[_0x5acec3(0x300)]='删除\x20('+_0x355a00['size']+')';}),document[_0x47aceb(0x11e3)](_0x47aceb(0x230))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x221676=_0x47aceb;if(_0x355a00[_0x221676(0x1159)]===0x0)return;const _0x40d48e=await _0x58fd60(_0x221676(0x1166),_0x221676(0xecc)+_0x355a00['size']+'\x20条内容吗？',{'confirmButtonClass':_0x221676(0x8a6)});if(_0x40d48e){const _0x1d3ada=[..._0x355a00];await _0x2e83f8['favorites'][_0x221676(0x7ac)](_0x1d3ada),await _0x2fb06(_0x221676(0x699),_0x221676(0x376)),allFavoriteItems=allFavoriteItems[_0x221676(0x138)](_0x57fa35=>!_0x1d3ada[_0x221676(0x3ad)](_0x57fa35['id'])),_0x40f8c7(allFavoriteItems),_0x307cfc[_0x221676(0x1041)]();}});_0x5de8b7[_0x47aceb(0x2df)][_0x47aceb(0xa99)]&&(_0x424da7(),console['log']('后台活动模拟已自动启动。'));document[_0x47aceb(0x10d6)](_0x47aceb(0x11c6))[_0x47aceb(0x494)](_0x4c08b5=>{const _0x344142=_0x47aceb;_0x4c08b5[_0x344142(0x4b8)]('change',_0x2d03c9);});const _0x4516a8=document[_0x47aceb(0x11e3)](_0x47aceb(0xf6e));_0x4516a8[_0x47aceb(0x4b8)](_0x47aceb(0x6be),()=>{const _0x679216=_0x47aceb;document[_0x679216(0x11e3)](_0x679216(0xb70))['textContent']=_0x4516a8[_0x679216(0xf27)]+'px',_0x2d03c9();});const _0x2ab29a=document[_0x47aceb(0x11e3)](_0x47aceb(0x311));_0x2ab29a[_0x47aceb(0x4b8)]('input',_0x2d03c9),document[_0x47aceb(0x11e3)](_0x47aceb(0x10d1))['addEventListener']('click',()=>{const _0x3de88e=_0x47aceb;document[_0x3de88e(0x11e3)](_0x3de88e(0xb61))[_0x3de88e(0x3e4)]=!![],_0x2d03c9();}),document[_0x47aceb(0x11e3)]('reset-custom-css-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x4a2ae3=_0x47aceb;document[_0x4a2ae3(0x11e3)](_0x4a2ae3(0x311))[_0x4a2ae3(0xf27)]='',_0x2d03c9();}),document['getElementById'](_0x47aceb(0x3ed))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x2d03c9),document[_0x47aceb(0x11e3)]('lyrics-horizontal-pos')[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x2d03c9),document[_0x47aceb(0x11e3)](_0x47aceb(0xcff))[_0x47aceb(0x4b8)](_0x47aceb(0x6be),_0x2d03c9),document[_0x47aceb(0x10d6)](_0x47aceb(0xe82))[_0x47aceb(0x494)](_0x509741=>{const _0xf747a1=_0x47aceb;_0x509741[_0xf747a1(0x4b8)](_0xf747a1(0xfeb),function(){const _0x2605af=_0xf747a1,_0x579562=document['getElementById'](_0x2605af(0x1302));this['value']==='include'||this['value']==='exclude'?_0x579562[_0x2605af(0x794)][_0x2605af(0x33d)]='block':_0x579562[_0x2605af(0x794)][_0x2605af(0x33d)]=_0x2605af(0x379);});}),document[_0x47aceb(0x11e3)](_0x47aceb(0xf4a))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x1603e9),document['getElementById'](_0x47aceb(0xe65))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0xd9338d=_0x47aceb;document[_0xd9338d(0x11e3)](_0xd9338d(0x122c))[_0xd9338d(0x505)]['remove'](_0xd9338d(0x250));const _0x218cd8=document[_0xd9338d(0x11e3)](_0xd9338d(0x4bb));document['getElementById'](_0xd9338d(0x99b))['classList'][_0xd9338d(0x1121)]('visible')&&_0x218cd8[_0xd9338d(0x1041)]();}),document['getElementById'](_0x47aceb(0x842))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x3bb3c6),document[_0x47aceb(0x11e3)]('existing-groups-list')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x45824d=>{const _0x496bc1=_0x47aceb;if(_0x45824d[_0x496bc1(0xd7c)][_0x496bc1(0x505)]['contains'](_0x496bc1(0xceb))){const _0x4076f1=parseInt(_0x45824d[_0x496bc1(0xd7c)][_0x496bc1(0xaca)]['id']);_0x49060a(_0x4076f1);}}),document[_0x47aceb(0x11e3)](_0x47aceb(0xa93))[_0x47aceb(0x4b8)]('click',_0x5652d7),document[_0x47aceb(0x11e3)]('edit-message-btn')['addEventListener']('click',_0x1b3aff),document['getElementById'](_0x47aceb(0x585))['addEventListener'](_0x47aceb(0x1041),_0x5d74fd),document[_0x47aceb(0x11e3)](_0x47aceb(0xbac))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x147c0a),document['getElementById'](_0x47aceb(0x3c8))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x473cc5=_0x50fd7c;_0x5652d7(),_0x473cc5&&_0x377c8d(_0x473cc5);}),document['getElementById'](_0x47aceb(0xc9d))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x4232cf=>{const _0x2c2af4=_0x47aceb,_0x29f5d3=_0x4232cf[_0x2c2af4(0xd7c)][_0x2c2af4(0xfe1)](_0x2c2af4(0x6a9));if(!_0x29f5d3)return;if(_0x29f5d3[_0x2c2af4(0x505)][_0x2c2af4(0x1121)]('ai')&&_0x29f5d3[_0x2c2af4(0x505)][_0x2c2af4(0x1121)](_0x2c2af4(0x10f9))&&_0x29f5d3[_0x2c2af4(0xaca)]['status']==='pending'){const _0x466a10=parseInt(_0x29f5d3['dataset']['timestamp']);!isNaN(_0x466a10)&&_0x520a19(_0x466a10);}}),document[_0x47aceb(0x11e3)]('transfer-action-accept')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>_0x429bef('accepted')),document['getElementById'](_0x47aceb(0x3f9))['addEventListener']('click',()=>_0x429bef('declined')),document[_0x47aceb(0x11e3)](_0x47aceb(0xcc7))['addEventListener'](_0x47aceb(0x1041),_0x157fc2),document[_0x47aceb(0x11e3)](_0x47aceb(0xc13))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2bc905),document['getElementById'](_0x47aceb(0xeaf))['addEventListener'](_0x47aceb(0x1041),_0x30e6cc),document[_0x47aceb(0x11e3)](_0x47aceb(0xa1b))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x231719),document[_0x47aceb(0x11e3)](_0x47aceb(0x103e))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x5aa717=_0x47aceb;_0x4e7698(_0x5aa717(0xf1e));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x119a))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x52473f=>{const _0x1b24f7=_0x47aceb,_0x5ca1f3=_0x52473f[_0x1b24f7(0xd7c)][_0x1b24f7(0xfe1)](_0x1b24f7(0xcb4));if(!_0x5ca1f3)return;const _0xcb1a5a=_0x5ca1f3['dataset'][_0x1b24f7(0xfb4)];_0x5ca1f3['classList'][_0x1b24f7(0xe7e)]('selected'),_0x1494d8[_0x1b24f7(0x72a)](_0xcb1a5a)?_0x1494d8[_0x1b24f7(0xc0c)](_0xcb1a5a):_0x1494d8[_0x1b24f7(0x252)](_0xcb1a5a),_0x1ce777();}),document[_0x47aceb(0x11e3)](_0x47aceb(0x745))['addEventListener'](_0x47aceb(0x1041),()=>{_0x320eea();}),document['getElementById'](_0x47aceb(0x86d))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x5a25ba=_0x47aceb;_0x4e7698(_0x5a25ba(0x9fc)),document[_0x5a25ba(0x11e3)](_0x5a25ba(0x4bb))[_0x5a25ba(0x1041)]();}),document['getElementById'](_0x47aceb(0xffc))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0xf08e38=>{const _0x3b66f9=_0x47aceb;_0xf08e38[_0x3b66f9(0xd7c)][_0x3b66f9(0x505)]['contains']('remove-member-btn')&&_0xd4ff0b(_0xf08e38[_0x3b66f9(0xd7c)][_0x3b66f9(0xaca)][_0x3b66f9(0xbc3)]);}),document['getElementById'](_0x47aceb(0x100a))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x1e3c46=_0x47aceb,_0xa90a29=document[_0x1e3c46(0x11e3)](_0x1e3c46(0x37e)),_0x2771e0=_0xa90a29[_0x1e3c46(0x4b4)](!![]);_0xa90a29[_0x1e3c46(0x18c)][_0x1e3c46(0xeaa)](_0x2771e0,_0xa90a29),_0x2771e0['addEventListener'](_0x1e3c46(0x1041),_0x39081d),await _0x472241();}),document[_0x47aceb(0x11e3)](_0x47aceb(0x11b7))['addEventListener'](_0x47aceb(0x1041),_0x3c1151),document[_0x47aceb(0x11e3)](_0x47aceb(0x228))[_0x47aceb(0x4b8)]('click',_0x2f05d6),document['getElementById']('group-video-call-btn')['addEventListener'](_0x47aceb(0x1041),_0x2f05d6),document['getElementById'](_0x47aceb(0x5db))['addEventListener'](_0x47aceb(0x1041),_0x24ad7e),document[_0x47aceb(0x11e3)]('cancel-call-btn')['addEventListener'](_0x47aceb(0x1041),()=>{const _0x94312d=_0x47aceb;_0x46751e[_0x94312d(0x1d6)]=![],_0x4e7698(_0x94312d(0x9fc));}),document['getElementById'](_0x47aceb(0x233))['addEventListener']('click',_0x392c9b),document[_0x47aceb(0x11e3)](_0x47aceb(0xf53))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x2f8795=_0x47aceb;_0x43a197();const _0x48858c=_0x5de8b7['chats'][_0x46751e[_0x2f8795(0x93d)]];if(!_0x48858c)return;if(_0x46751e[_0x2f8795(0x419)]){_0x46751e[_0x2f8795(0xdb3)]=![];const _0x55a5c3={'role':_0x2f8795(0xf72),'content':_0x2f8795(0xf32),'timestamp':Date[_0x2f8795(0x1182)](),'isHidden':!![]};_0x48858c[_0x2f8795(0x49e)][_0x2f8795(0xf5)](_0x55a5c3),await _0x2e83f8[_0x2f8795(0x737)][_0x2f8795(0xe3c)](_0x48858c),await _0x14a9f0();}else{const _0x65cf95={'role':'user','content':_0x2f8795(0xd30),'timestamp':Date[_0x2f8795(0x1182)]()};_0x48858c[_0x2f8795(0x49e)]['push'](_0x65cf95),await _0x2e83f8[_0x2f8795(0x737)][_0x2f8795(0xe3c)](_0x48858c),_0x4e7698('chat-interface-screen'),_0x3b5153(_0x65cf95,_0x48858c),_0x14a9f0();}_0x46751e[_0x2f8795(0x1d6)]=![];}),document[_0x47aceb(0x11e3)](_0x47aceb(0xfac))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x26ba03=_0x47aceb;_0x43a197(),_0x46751e['initiator']='ai',_0x46751e[_0x26ba03(0xdb3)]=!![],_0x46751e[_0x26ba03(0x93d)]=_0x5de8b7[_0x26ba03(0x93d)];if(_0x46751e[_0x26ba03(0x419)]){const _0x22d660=_0x5de8b7[_0x26ba03(0x737)][_0x46751e[_0x26ba03(0x93d)]],_0x32f526=_0x22d660['members'][_0x26ba03(0xe79)](_0x5e53e3=>_0x5e53e3[_0x26ba03(0x278)]===_0x46751e['callRequester']);_0x32f526?_0x46751e[_0x26ba03(0x94b)]=[_0x32f526]:_0x46751e[_0x26ba03(0x94b)]=[];}_0x3df367();}),document['getElementById'](_0x47aceb(0x443))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x32e67f=_0x47aceb;if(!_0x46751e['isActive'])return;const _0x5828e5=document[_0x32e67f(0x5ac)](_0x32e67f(0xd00));_0x5828e5&&_0x5828e5[_0x32e67f(0x505)][_0x32e67f(0x252)](_0x32e67f(0xe64));const _0x5d18c2=await _0x231a5a('你说',_0x32e67f(0x653));_0x5828e5&&_0x5828e5[_0x32e67f(0x505)][_0x32e67f(0x957)](_0x32e67f(0xe64)),_0x5d18c2&&_0x5d18c2[_0x32e67f(0xeb7)]()&&_0x18571c(_0x5d18c2[_0x32e67f(0xeb7)]());}),document[_0x47aceb(0x5ac)](_0x47aceb(0xc3c))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x49777e=_0x47aceb;_0x1b417c&&document[_0x49777e(0x11e3)](_0x49777e(0x60e))['click'](),_0x1c77e7(_0x49777e(0xf2)),_0x1bb7fa();}),document[_0x47aceb(0x11e3)](_0x47aceb(0xe84))['addEventListener'](_0x47aceb(0x1041),()=>_0x1c77e7(_0x47aceb(0xde))),document[_0x47aceb(0x11e3)](_0x47aceb(0x1044))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x53837d=_0x47aceb,_0x867d9c=document['getElementById']('countdown-title-input')[_0x53837d(0xf27)][_0x53837d(0xeb7)](),_0x52c032=document[_0x53837d(0x11e3)](_0x53837d(0x11d3))[_0x53837d(0xf27)];if(!_0x867d9c||!_0x52c032){alert(_0x53837d(0xee3));return;}const _0x47192b=new Date(_0x52c032);if(isNaN(_0x47192b)||_0x47192b<=new Date()){alert(_0x53837d(0x97b));return;}const _0x1b292a={'authorId':'user','description':_0x867d9c,'timestamp':Date[_0x53837d(0x1182)](),'type':'countdown','targetDate':_0x47192b['getTime']()};await _0x2e83f8[_0x53837d(0x360)][_0x53837d(0x252)](_0x1b292a),document[_0x53837d(0x11e3)](_0x53837d(0xef7))[_0x53837d(0x505)]['remove']('visible'),_0x1bb7fa();}),document[_0x47aceb(0x11e3)](_0x47aceb(0xdc4))[_0x47aceb(0x4b8)]('click',async()=>{const _0x490e2a=_0x47aceb;if(!_0x5de8b7[_0x490e2a(0x93d)]||_0x5de8b7[_0x490e2a(0x737)][_0x5de8b7['activeChatId']]['isGroup'])return;const _0x539eef=_0x5de8b7[_0x490e2a(0x737)][_0x5de8b7[_0x490e2a(0x93d)]],_0x2c40d9=await _0x58fd60(_0x490e2a(0xf31),'确定要拉黑“'+_0x539eef[_0x490e2a(0x278)]+_0x490e2a(0x9cd),{'confirmButtonClass':'btn-danger'});if(_0x2c40d9){_0x539eef['relationship']['status']=_0x490e2a(0x530),_0x539eef[_0x490e2a(0xa78)][_0x490e2a(0x64c)]=Date['now']();const _0x663ae2={'role':_0x490e2a(0xf72),'content':_0x490e2a(0xd83),'timestamp':Date[_0x490e2a(0x1182)]()+0x1,'isHidden':!![]};_0x539eef['history']['push'](_0x663ae2),await _0x2e83f8[_0x490e2a(0x737)][_0x490e2a(0xe3c)](_0x539eef),document[_0x490e2a(0x11e3)](_0x490e2a(0x99b))[_0x490e2a(0x505)]['remove'](_0x490e2a(0x250)),_0x544ab5(_0x5de8b7[_0x490e2a(0x93d)]),_0x5ee219();}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x92a))['addEventListener'](_0x47aceb(0x1041),async _0x1fa397=>{const _0x26cbe1=_0x47aceb,_0x10690a=_0x5de8b7[_0x26cbe1(0x737)][_0x5de8b7[_0x26cbe1(0x93d)]];if(!_0x10690a)return;if(_0x1fa397['target']['id']==='force-apply-check-btn'){alert(_0x26cbe1(0x403)),await _0x2d6139(_0x10690a['id']),_0x544ab5(_0x10690a['id']);return;}if(_0x1fa397[_0x26cbe1(0xd7c)]['id']===_0x26cbe1(0xfb0)){_0x10690a[_0x26cbe1(0xa78)][_0x26cbe1(0x739)]=_0x26cbe1(0xe62),_0x10690a['relationship'][_0x26cbe1(0x64c)]=null;const _0x557b44={'role':_0x26cbe1(0xf72),'content':'[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]','timestamp':Date['now'](),'isHidden':!![]};_0x10690a[_0x26cbe1(0x49e)][_0x26cbe1(0xf5)](_0x557b44),await _0x2e83f8['chats'][_0x26cbe1(0xe3c)](_0x10690a),_0x544ab5(_0x10690a['id']),_0x5ee219(),_0x14a9f0();}else{if(_0x1fa397[_0x26cbe1(0xd7c)]['id']===_0x26cbe1(0xdc7)){_0x10690a[_0x26cbe1(0xa78)][_0x26cbe1(0x739)]='friend',_0x10690a['relationship'][_0x26cbe1(0xa83)]='';const _0x210b2a={'role':_0x26cbe1(0xf72),'type':_0x26cbe1(0x8ee),'content':_0x26cbe1(0xc1d)+_0x10690a[_0x26cbe1(0x278)]+_0x26cbe1(0xb96),'timestamp':Date[_0x26cbe1(0x1182)]()};_0x10690a[_0x26cbe1(0x49e)][_0x26cbe1(0xf5)](_0x210b2a);const _0x706ec6={'role':'assistant','senderName':_0x10690a['name'],'content':_0x26cbe1(0x625),'timestamp':Date['now']()+0x1};_0x10690a['history']['push'](_0x706ec6),await _0x2e83f8['chats'][_0x26cbe1(0xe3c)](_0x10690a),_0x544ab5(_0x10690a['id']),_0x5ee219();}else{if(_0x1fa397[_0x26cbe1(0xd7c)]['id']==='reject-friend-btn')_0x10690a['relationship'][_0x26cbe1(0x739)]='blocked_by_user',_0x10690a[_0x26cbe1(0xa78)][_0x26cbe1(0x64c)]=Date[_0x26cbe1(0x1182)](),_0x10690a[_0x26cbe1(0xa78)][_0x26cbe1(0xa83)]='',await _0x2e83f8[_0x26cbe1(0x737)]['put'](_0x10690a),_0x544ab5(_0x10690a['id']);else{if(_0x1fa397[_0x26cbe1(0xd7c)]['id']==='apply-friend-btn'){const _0x5a339c=await _0x231a5a(_0x26cbe1(0x953),_0x26cbe1(0x900)+_0x10690a[_0x26cbe1(0x278)]+_0x26cbe1(0x442),_0x26cbe1(0xfa7));_0x5a339c!==null&&(_0x10690a[_0x26cbe1(0xa78)][_0x26cbe1(0x739)]=_0x26cbe1(0x9f9),_0x10690a[_0x26cbe1(0xa78)][_0x26cbe1(0xa83)]=_0x5a339c,await _0x2e83f8[_0x26cbe1(0x737)][_0x26cbe1(0xe3c)](_0x10690a),_0x544ab5(_0x10690a['id']),_0x5ee219(),_0x14a9f0());}}}}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x8ff))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x11d4cf),document['getElementById'](_0x47aceb(0x5d8))['addEventListener'](_0x47aceb(0x1041),()=>{const _0x1b1a47=_0x47aceb;document[_0x1b1a47(0x11e3)]('red-packet-modal')['classList']['remove']('visible');}),document[_0x47aceb(0x11e3)]('send-group-packet-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x58bb2e),document[_0x47aceb(0x11e3)](_0x47aceb(0x5f1))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x5bb163);const _0x111e0d=document[_0x47aceb(0x11e3)](_0x47aceb(0x5d3)),_0x1dbd57=document['getElementById'](_0x47aceb(0xe86)),_0x3725cb=document[_0x47aceb(0x11e3)](_0x47aceb(0xe5d)),_0x1628c7=document['getElementById'](_0x47aceb(0x337));_0x111e0d[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x488643=_0x47aceb;_0x111e0d[_0x488643(0x505)][_0x488643(0x252)](_0x488643(0x1fc)),_0x1dbd57['classList']['remove'](_0x488643(0x1fc)),_0x3725cb['style'][_0x488643(0x33d)]=_0x488643(0x11ac),_0x1628c7[_0x488643(0x794)]['display']='none';}),_0x1dbd57['addEventListener'](_0x47aceb(0x1041),()=>{const _0x379485=_0x47aceb;_0x1dbd57[_0x379485(0x505)][_0x379485(0x252)]('active'),_0x111e0d['classList']['remove'](_0x379485(0x1fc)),_0x1628c7['style'][_0x379485(0x33d)]=_0x379485(0x11ac),_0x3725cb['style'][_0x379485(0x33d)]='none';}),document['getElementById']('rp-group-amount')[_0x47aceb(0x4b8)](_0x47aceb(0x6be),_0x310558=>{const _0x5679fb=_0x47aceb,_0x1c6bd4=parseFloat(_0x310558['target']['value'])||0x0;document[_0x5679fb(0x11e3)](_0x5679fb(0x4e1))[_0x5679fb(0x300)]='¥\x20'+_0x1c6bd4[_0x5679fb(0x200)](0x2);}),document[_0x47aceb(0x11e3)](_0x47aceb(0x1216))[_0x47aceb(0x4b8)](_0x47aceb(0x6be),_0x243e5d=>{const _0x56e675=_0x47aceb,_0x1cbc94=parseFloat(_0x243e5d[_0x56e675(0xd7c)][_0x56e675(0xf27)])||0x0;document[_0x56e675(0x11e3)](_0x56e675(0x277))[_0x56e675(0x300)]='¥\x20'+_0x1cbc94['toFixed'](0x2);}),document['getElementById']('chat-messages')['addEventListener'](_0x47aceb(0x1041),_0x4a9fb3=>{const _0x301eea=_0x47aceb,_0x568f32=_0x4a9fb3[_0x301eea(0xd7c)][_0x301eea(0xfe1)](_0x301eea(0x1269));if(!_0x568f32)return;const _0x1934dc=_0x568f32[_0x301eea(0xfe1)]('.message-bubble');if(!_0x1934dc||!_0x1934dc['dataset'][_0x301eea(0x702)])return;const _0x4bb89c=parseInt(_0x1934dc[_0x301eea(0xaca)][_0x301eea(0x702)]);_0x319222(_0x4bb89c);}),document[_0x47aceb(0x11e3)]('send-poll-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2e13a5),document['getElementById'](_0x47aceb(0xc73))['addEventListener']('click',_0x502d9e),document['getElementById'](_0x47aceb(0xdfe))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x49d189=_0x47aceb;document[_0x49d189(0x11e3)](_0x49d189(0xe18))[_0x49d189(0x505)][_0x49d189(0x957)](_0x49d189(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x14c))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x3a7360),document[_0x47aceb(0x11e3)](_0x47aceb(0xc9d))['addEventListener']('click',_0x41ef6f=>{const _0x255870=_0x47aceb,_0x3a8804=_0x41ef6f[_0x255870(0xd7c)][_0x255870(0xfe1)](_0x255870(0xb59));if(!_0x3a8804)return;const _0x2be463=parseInt(_0x3a8804[_0x255870(0xaca)][_0x255870(0x840)]);if(isNaN(_0x2be463))return;const _0x215615=_0x41ef6f[_0x255870(0xd7c)][_0x255870(0xfe1)]('.poll-option-item');if(_0x215615&&!_0x3a8804[_0x255870(0x505)]['contains'](_0x255870(0x1ed))){_0x2bb64b(_0x2be463,_0x215615[_0x255870(0xaca)][_0x255870(0xd91)]);return;}const _0x2e97f4=_0x41ef6f[_0x255870(0xd7c)][_0x255870(0xfe1)]('.poll-action-btn');if(_0x2e97f4){_0x3a8804['classList'][_0x255870(0x1121)](_0x255870(0x1ed))?_0xc52ad(_0x2be463):_0x54948(_0x2be463);return;}_0x3a8804[_0x255870(0x505)][_0x255870(0x1121)](_0x255870(0x1ed))&&_0xc52ad(_0x2be463);}),document[_0x47aceb(0x11e3)](_0x47aceb(0x12a4))[_0x47aceb(0x4b8)]('click',_0x22ed99),document[_0x47aceb(0x11e3)](_0x47aceb(0x11ad))['addEventListener'](_0x47aceb(0x1041),()=>_0x5d1875('ai')),document[_0x47aceb(0x11e3)]('add-group-avatar-batch-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>_0x5d1875(_0x47aceb(0x264))),document[_0x47aceb(0x11e3)]('add-ai-avatar-url-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x13c036),document[_0x47aceb(0x11e3)](_0x47aceb(0xb8a))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x5ae32d=_0x47aceb;document[_0x5ae32d(0x11e3)](_0x5ae32d(0x29e))['click']();}),document[_0x47aceb(0x11e3)]('ai-avatar-upload-input')['addEventListener'](_0x47aceb(0xfeb),_0x54bd44),document['getElementById'](_0x47aceb(0x61e))['addEventListener'](_0x47aceb(0x1041),_0x2ccef2),document[_0x47aceb(0x11e3)](_0x47aceb(0x1d0))[_0x47aceb(0x4b8)]('click',_0x5a3a52),document['getElementById'](_0x47aceb(0xf43))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x15ec82),document[_0x47aceb(0x11e3)](_0x47aceb(0xd89))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x20736e=_0x47aceb;document[_0x20736e(0x11e3)](_0x20736e(0x1061))[_0x20736e(0x1041)]();}),document[_0x47aceb(0x11e3)](_0x47aceb(0x1061))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x24923a),document['getElementById'](_0x47aceb(0x128e))['addEventListener']('click',_0x1184c7),document[_0x47aceb(0x11e3)](_0x47aceb(0x91a))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x4bfd8e=>{const _0x2c8c8f=_0x47aceb;if(_0x4bfd8e['target'][_0x2c8c8f(0x505)]['contains'](_0x2c8c8f(0x111a))){const _0x15f3a7=_0x4bfd8e[_0x2c8c8f(0xd7c)]['closest'](_0x2c8c8f(0xea4)),_0x310497=_0x15f3a7[_0x2c8c8f(0xaca)][_0x2c8c8f(0xe9)];_0x310497&&_0x5b6858(_0x310497,_0x2c8c8f(0xe53),_0x15f3a7);}}),document['getElementById']('chat-messages')[_0x47aceb(0x4b8)]('click',_0x2d0ba7=>{const _0x2cc881=_0x47aceb,_0x46ed64=_0x2d0ba7[_0x2cc881(0xd7c)][_0x2cc881(0xfe1)]('.link-share-card');if(_0x46ed64){const _0x5de1f0=parseInt(_0x46ed64[_0x2cc881(0xaca)][_0x2cc881(0x702)]);!isNaN(_0x5de1f0)&&_0x5b33d0(_0x5de1f0);}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x11bb))[_0x47aceb(0x4b8)]('click',()=>{_0x4e7698('chat-interface-screen');}),_0x29da69[_0x47aceb(0x7a8)][_0x47aceb(0x4b8)]('click',async _0x1972f3=>{const _0x863f15=_0x47aceb,_0x31a816=_0x1972f3[_0x863f15(0xd7c)]['closest']('.sticker-item');if(_0x31a816&&_0x29da69[_0x863f15(0xa2c)]!==null){const _0x7f83f5=_0x31a816['style'][_0x863f15(0x123e)]['slice'](0x5,-0x2),_0x49b96a=_0x5de8b7[_0x863f15(0xa67)][_0x863f15(0xe79)](_0x5bdb17=>_0x5bdb17['url']===_0x7f83f5);_0x49b96a?await _0x134f69(_0x29da69[_0x863f15(0xa2c)],_0x49b96a):console[_0x863f15(0x6b0)](_0x863f15(0xe02),_0x7f83f5);}}),document['addEventListener'](_0x47aceb(0x1041),_0x318d53=>{const _0x318122=_0x47aceb;_0x29da69['isOpen']&&!_0x29da69[_0x318122(0x7a8)][_0x318122(0x1121)](_0x318d53[_0x318122(0xd7c)])&&!_0x318d53['target']['closest'](_0x318122(0x9dc))&&_0x33db3a();}),document[_0x47aceb(0x11e3)](_0x47aceb(0x9a8))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x56ccdb),document[_0x47aceb(0x11e3)]('cancel-share-link-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x26385e=_0x47aceb;document[_0x26385e(0x11e3)](_0x26385e(0x9de))[_0x26385e(0x505)][_0x26385e(0x957)](_0x26385e(0x250));}),document[_0x47aceb(0x11e3)]('confirm-share-link-btn')['addEventListener'](_0x47aceb(0x1041),_0x4a7b3c),document['getElementById'](_0x47aceb(0x564))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x5c2d59),document[_0x47aceb(0x11e3)](_0x47aceb(0x10d3))[_0x47aceb(0x4b8)]('click',_0x554b84),document[_0x47aceb(0x11e3)](_0x47aceb(0xb11))['addEventListener'](_0x47aceb(0x1041),_0x3855ff),document[_0x47aceb(0x11e3)]('call-history-back-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x500890=_0x47aceb;_0x4e7698(_0x500890(0xf1e));}),document[_0x47aceb(0x11e3)](_0x47aceb(0xb17))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x43cb6d=>{const _0x22ada4=_0x47aceb,_0x3c821c=_0x43cb6d[_0x22ada4(0xd7c)][_0x22ada4(0xfe1)](_0x22ada4(0x84c));_0x3c821c&&_0x3c821c['dataset'][_0x22ada4(0xf41)]&&_0x6e19d9(parseInt(_0x3c821c[_0x22ada4(0xaca)][_0x22ada4(0xf41)]));}),document[_0x47aceb(0x11e3)](_0x47aceb(0xef5))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x894047=_0x47aceb;document[_0x894047(0x11e3)](_0x894047(0x12d7))['classList'][_0x894047(0x957)](_0x894047(0x250));}),document[_0x47aceb(0x11e3)]('chat-header-status')['addEventListener'](_0x47aceb(0x1041),_0x17b625),document[_0x47aceb(0x11e3)](_0x47aceb(0x103d))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x21b69d=_0x47aceb;_0x281a6a[_0x21b69d(0x1159)]>0x0&&_0x4a28bb();}),document[_0x47aceb(0x11e3)](_0x47aceb(0x12a5))[_0x47aceb(0x4b8)]('click',_0x32604c),document[_0x47aceb(0x11e3)](_0x47aceb(0x70f))[_0x47aceb(0x4b8)]('click',async()=>{const _0x45355a=_0x47aceb,_0x4457a1=_0x5de8b7[_0x45355a(0x737)][_0x5de8b7['activeChatId']],_0x27052c=Array[_0x45355a(0xee2)](document[_0x45355a(0x10d6)](_0x45355a(0x3c5)))[_0x45355a(0x796)](_0x15a590=>_0x15a590[_0x45355a(0xaca)]['chatId']);if(_0x27052c[_0x45355a(0x594)]===0x0){alert(_0x45355a(0x77a));return;}const _0x5823d9=[],_0x1b0dee=[..._0x281a6a][_0x45355a(0x861)]((_0xf40a09,_0x217120)=>_0xf40a09-_0x217120);for(const _0x595af3 of _0x1b0dee){const _0x445728=_0x4457a1[_0x45355a(0x49e)][_0x45355a(0xe79)](_0x48b359=>_0x48b359['timestamp']===_0x595af3);_0x445728&&_0x5823d9[_0x45355a(0xf5)](_0x445728);}const _0xbb581={'role':_0x45355a(0x21c),'senderName':_0x4457a1[_0x45355a(0x1244)]?_0x4457a1[_0x45355a(0x761)][_0x45355a(0xca7)]||'我':'我','type':_0x45355a(0x5e8),'timestamp':Date['now'](),'payload':{'sourceChatName':_0x4457a1[_0x45355a(0x278)],'title':'来自“'+_0x4457a1[_0x45355a(0x278)]+_0x45355a(0x867),'sharedHistory':_0x5823d9}};for(const _0x13b9ee of _0x27052c){const _0x33a6d4=_0x5de8b7[_0x45355a(0x737)][_0x13b9ee];_0x33a6d4&&(_0x33a6d4[_0x45355a(0x49e)]['push'](_0xbb581),await _0x2e83f8['chats'][_0x45355a(0xe3c)](_0x33a6d4));}document[_0x45355a(0x11e3)](_0x45355a(0xb51))['classList']['remove'](_0x45355a(0x250)),_0x2192b8(),await _0x2fb06(_0x45355a(0x884),_0x45355a(0x32e)+_0x27052c[_0x45355a(0x594)]+_0x45355a(0x204)),_0x5ee219();}),document[_0x47aceb(0x11e3)](_0x47aceb(0xe97))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x1a82b9=_0x47aceb;document[_0x1a82b9(0x11e3)](_0x1a82b9(0xb51))[_0x1a82b9(0x505)][_0x1a82b9(0x957)]('visible');}),document[_0x47aceb(0x11e3)](_0x47aceb(0xc9d))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x377751=>{const _0x162143=_0x47aceb,_0x44dbbe=_0x377751[_0x162143(0xd7c)]['closest'](_0x162143(0xc6e));if(_0x44dbbe&&_0x44dbbe[_0x162143(0xfe1)](_0x162143(0xe26))){const _0x183988=parseInt(_0x44dbbe['dataset']['timestamp']);_0x389941(_0x183988);}}),document[_0x47aceb(0x11e3)]('close-shared-history-viewer-btn')['addEventListener']('click',()=>{const _0x2f0f36=_0x47aceb;document[_0x2f0f36(0x11e3)](_0x2f0f36(0x118f))['classList']['remove'](_0x2f0f36(0x250));});async function _0x389941(_0x1b2aaa){const _0x41f1c8=_0x47aceb,_0x20ffef=_0x5de8b7[_0x41f1c8(0x737)][_0x5de8b7[_0x41f1c8(0x93d)]],_0x34e8c4=_0x20ffef[_0x41f1c8(0x49e)][_0x41f1c8(0xe79)](_0x2205c8=>_0x2205c8[_0x41f1c8(0x702)]===_0x1b2aaa);if(!_0x34e8c4||_0x34e8c4[_0x41f1c8(0xa20)]!=='share_card'||!_0x34e8c4['payload']){console[_0x41f1c8(0x1c1)](_0x41f1c8(0x289),_0x1b2aaa),await _0x2fb06(_0x41f1c8(0x6c9),_0x41f1c8(0x10cb));return;}const _0x4ecb18=document[_0x41f1c8(0x11e3)]('shared-history-viewer-modal'),_0x356377=document[_0x41f1c8(0x11e3)](_0x41f1c8(0x2a7)),_0x1b36a1=document[_0x41f1c8(0x11e3)](_0x41f1c8(0xd08));_0x356377[_0x41f1c8(0x300)]=_0x34e8c4[_0x41f1c8(0x287)][_0x41f1c8(0x740)],_0x1b36a1[_0x41f1c8(0x595)]='';const _0x4141c0=document[_0x41f1c8(0xc6a)](),_0x95514=Object[_0x41f1c8(0x4ca)](_0x5de8b7[_0x41f1c8(0x737)])[_0x41f1c8(0xe79)](_0x19d26b=>_0x19d26b[_0x41f1c8(0x278)]===_0x34e8c4[_0x41f1c8(0x287)][_0x41f1c8(0x10af)])||_0x20ffef;for(const _0x1b0d5a of _0x34e8c4['payload'][_0x41f1c8(0x7bc)]){const _0x369fe6=await _0xe99b75(_0x1b0d5a,_0x95514);_0x369fe6&&_0x4141c0[_0x41f1c8(0x120c)](_0x369fe6);}_0x1b36a1[_0x41f1c8(0x120c)](_0x4141c0),_0x4ecb18['classList']['add']('visible');}_0x7cf0d1[_0x47aceb(0x4b8)](_0x47aceb(0x650),_0x483d71),_0x7cf0d1['addEventListener']('pause',()=>{const _0x190d69=_0x47aceb;_0xb57b5b['isActive']&&(_0xb57b5b[_0x190d69(0x9b0)]=![],_0x359e1c());}),_0x7cf0d1[_0x47aceb(0x4b8)]('play',()=>{const _0x59cb0d=_0x47aceb;_0xb57b5b[_0x59cb0d(0x3d5)]&&(_0xb57b5b[_0x59cb0d(0x9b0)]=!![],_0x359e1c());}),document['getElementById'](_0x47aceb(0xfe6))['addEventListener'](_0x47aceb(0x1041),async _0xa2dcb6=>{const _0x1797b2=_0x47aceb,_0x37535b=_0xa2dcb6[_0x1797b2(0xd7c)],_0x26f39c=_0x37535b['closest'](_0x1797b2(0x562));if(_0x26f39c){const _0x204557=parseInt(_0x26f39c[_0x1797b2(0xaca)][_0x1797b2(0xd15)]);!isNaN(_0x204557)&&await _0x3e7d39(_0x204557);return;}const _0x406991=_0x37535b[_0x1797b2(0xfe1)]('.lyrics-btn');if(_0x406991){const _0x2ada9c=parseInt(_0x406991['dataset'][_0x1797b2(0xd15)]);if(isNaN(_0x2ada9c))return;await _0x2992b4(_0x2ada9c);return;}const _0x798ae2=_0x37535b['closest'](_0x1797b2(0x5fc));if(_0x798ae2){const _0xed547a=parseInt(_0x798ae2[_0x1797b2(0xaca)]['index']);if(isNaN(_0xed547a))return;const _0x7e5952=_0xb57b5b[_0x1797b2(0xcba)][_0xed547a],_0x195009=await _0x58fd60(_0x1797b2(0x511),_0x1797b2(0x1152)+_0x7e5952['name']+_0x1797b2(0xe48));_0x195009&&_0x126e32(_0xed547a);return;}const _0x4de90d=_0x37535b[_0x1797b2(0xfe1)](_0x1797b2(0x2ba));if(_0x4de90d){const _0x3a2867=_0x4de90d['closest'](_0x1797b2(0x954)),_0x575338=Array['from'](_0x3a2867[_0x1797b2(0xd2d)]['children'])[_0x1797b2(0xce1)](_0x3a2867);_0x575338>-0x1&&_0x23e7aa(_0x575338);}}),document[_0x47aceb(0x5ac)](_0x47aceb(0x4e3))[_0x47aceb(0x4b8)]('click',_0x50b096=>{const _0x45efd3=_0x47aceb;if(!_0x7cf0d1['duration'])return;const _0x72d10a=_0x50b096[_0x45efd3(0x726)],_0x7fba61=_0x72d10a[_0x45efd3(0xf76)],_0x3bdefd=_0x50b096['offsetX'];_0x7cf0d1['currentTime']=_0x3bdefd/_0x7fba61*_0x7cf0d1[_0x45efd3(0x915)];}),document[_0x47aceb(0x11e3)](_0x47aceb(0xc9d))['addEventListener'](_0x47aceb(0x1041),_0x1ed376=>{const _0x46b11d=_0x47aceb,_0x43c955=_0x1ed376[_0x46b11d(0xd7c)][_0x46b11d(0xfe1)](_0x46b11d(0x6a0));if(_0x43c955){const _0x17b9af=_0x5de8b7[_0x46b11d(0x737)][_0x5de8b7[_0x46b11d(0x93d)]],_0x4f5dea=_0x43c955[_0x46b11d(0xfe1)](_0x46b11d(0xce));if(_0x17b9af&&_0x4f5dea){const _0x54a494=parseInt(_0x4f5dea[_0x46b11d(0xaca)][_0x46b11d(0x702)]),_0x28b68e=_0x17b9af[_0x46b11d(0x49e)][_0x46b11d(0xe79)](_0x39287f=>_0x39287f[_0x46b11d(0x702)]===_0x54a494);if(_0x28b68e&&_0x28b68e[_0x46b11d(0xae6)]){let _0x527897='';const _0x5e54ba=_0x28b68e[_0x46b11d(0xae6)];switch(_0x5e54ba[_0x46b11d(0x469)]){case _0x46b11d(0x1197):_0x527897=_0x46b11d(0x361)+_0x5e54ba['originalContent']+'\x22';break;case'user_photo':case _0x46b11d(0xd02):case'text_image':_0x527897=_0x46b11d(0x294)+_0x5e54ba[_0x46b11d(0x5ab)]+'\x22';break;case _0x46b11d(0x719):_0x527897=_0x46b11d(0x99a)+_0x5e54ba['originalContent']+'\x22';break;case'sticker':_0x527897=_0x46b11d(0xe0c)+(_0x5e54ba['originalMeaning']||_0x46b11d(0x493))+'\x22\x20\x0a\x20URL:\x20'+_0x5e54ba['originalContent'];break;case'transfer':_0x527897=_0x46b11d(0xab);break;default:_0x527897='撤回了一条['+_0x5e54ba[_0x46b11d(0x469)]+_0x46b11d(0xf64)+JSON[_0x46b11d(0x313)](_0x5e54ba[_0x46b11d(0x5ab)]);break;}_0x2fb06(_0x46b11d(0x4ab),_0x527897);}}}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x21e))[_0x47aceb(0x4b8)]('click',_0xcb361d),document[_0x47aceb(0x11e3)](_0x47aceb(0xcc3))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x353d14=_0x47aceb;document['getElementById'](_0x353d14(0xba3))['classList'][_0x353d14(0x957)](_0x353d14(0x250)),_0x570ac2();}),document['getElementById'](_0x47aceb(0xda6))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x4cd073),document[_0x47aceb(0x11e3)](_0x47aceb(0xf88))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x1dd268=>{const _0x4be147=_0x47aceb;if(_0x1dd268[_0x4be147(0xd7c)][_0x4be147(0x505)][_0x4be147(0x1121)](_0x4be147(0xceb))){const _0x21040a=parseInt(_0x1dd268[_0x4be147(0xd7c)][_0x4be147(0xaca)]['id']);_0x7dfc67(_0x21040a);}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x7a2))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x8142be),document[_0x47aceb(0x11e3)]('repost-confirm-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x29cb6e),document[_0x47aceb(0x11e3)]('quote-message-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0xa1eb82),document[_0x47aceb(0x11e3)](_0x47aceb(0x9bd))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x1f4563),document[_0x47aceb(0x11e3)](_0x47aceb(0x4f7))[_0x47aceb(0x4b8)](_0x47aceb(0x6be),_0x5612cf=>{const _0x443f3f=_0x47aceb;if(!_0x5612cf[_0x443f3f(0xd7c)][_0x443f3f(0x3ba)]('.comment-input'))return;const _0x2ac271=_0x5612cf[_0x443f3f(0xd7c)],_0x1c143c=_0x2ac271['closest'](_0x443f3f(0xe08));if(!_0x1c143c)return;const _0x5af969=_0x1c143c[_0x443f3f(0x5ac)]('.at-mention-popup'),_0x1fe2c4=_0x2ac271['value'],_0x3e69a3=_0x1fe2c4[_0x443f3f(0xe9f)](/@([\p{L}\w]*)$/u);if(_0x3e69a3){const _0x3be4ea=new Set(),_0x9d6c20=_0x1c143c[_0x443f3f(0x5ac)](_0x443f3f(0x10e7))?.['textContent'];if(_0x9d6c20)_0x3be4ea[_0x443f3f(0x252)](_0x9d6c20);_0x1c143c['querySelectorAll']('.commenter-name')['forEach'](_0x10bad7=>{const _0x480f87=_0x443f3f;_0x3be4ea[_0x480f87(0x252)](_0x10bad7[_0x480f87(0x300)][_0x480f87(0x1018)](':',''));}),_0x3be4ea[_0x443f3f(0xc0c)](_0x5de8b7[_0x443f3f(0x1c5)][_0x443f3f(0xa33)]),_0x5af969[_0x443f3f(0x595)]='';if(_0x3be4ea[_0x443f3f(0x1159)]>0x0){const _0x112368=_0x3e69a3[0x1];_0x3be4ea[_0x443f3f(0x494)](_0x87867a=>{const _0x37a26c=_0x443f3f;if(_0x87867a[_0x37a26c(0xb03)]()[_0x37a26c(0x3ad)](_0x112368[_0x37a26c(0xb03)]())){const _0x3e847d=document[_0x37a26c(0x383)](_0x37a26c(0x1285));_0x3e847d[_0x37a26c(0x3db)]=_0x37a26c(0x5c8),_0x3e847d[_0x37a26c(0x300)]=_0x87867a,_0x3e847d[_0x37a26c(0x4b8)](_0x37a26c(0xc23),_0x4d8ef1=>{const _0xf1c708=_0x37a26c;_0x4d8ef1['preventDefault']();const _0x1fa5ee=_0x1fe2c4['substring'](0x0,_0x3e69a3['index'])+('@'+_0x87867a+'\x20');_0x2ac271[_0xf1c708(0xf27)]=_0x1fa5ee,_0x5af969[_0xf1c708(0x794)][_0xf1c708(0x33d)]=_0xf1c708(0x379),_0x2ac271[_0xf1c708(0xc1f)]();}),_0x5af969[_0x37a26c(0x120c)](_0x3e847d);}}),_0x5af969[_0x443f3f(0x794)][_0x443f3f(0x33d)]=_0x5af969[_0x443f3f(0x7b5)][_0x443f3f(0x594)]>0x0?_0x443f3f(0x11ac):_0x443f3f(0x379);}else _0x5af969[_0x443f3f(0x794)][_0x443f3f(0x33d)]='none';}else _0x5af969[_0x443f3f(0x794)][_0x443f3f(0x33d)]='none';}),document[_0x47aceb(0x11e3)]('qzone-posts-list')[_0x47aceb(0x4b8)](_0x47aceb(0x320),_0x4af60b=>{const _0x5999d7=_0x47aceb;if(_0x4af60b['target'][_0x5999d7(0x3ba)](_0x5999d7(0x71b))){const _0x5c4563=_0x4af60b[_0x5999d7(0xd7c)][_0x5999d7(0xfe1)](_0x5999d7(0xe08));if(_0x5c4563){const _0x4a41a6=_0x5c4563[_0x5999d7(0x5ac)](_0x5999d7(0x34e));_0x4a41a6&&setTimeout(()=>{const _0x1495c9=_0x5999d7;_0x4a41a6[_0x1495c9(0x794)]['display']=_0x1495c9(0x379);},0xc8);}}});const _0x2f117b=document['getElementById'](_0x47aceb(0x803)),_0x327430=document[_0x47aceb(0x11e3)]('chat-at-mention-popup');_0x2f117b[_0x47aceb(0x4b8)](_0x47aceb(0x6be),()=>{const _0x5d695a=_0x47aceb;if(!_0x5de8b7['activeChatId']||!_0x5de8b7[_0x5d695a(0x737)][_0x5de8b7[_0x5d695a(0x93d)]]['isGroup']){_0x327430['style'][_0x5d695a(0x33d)]='none';return;}const _0x10d763=_0x5de8b7[_0x5d695a(0x737)][_0x5de8b7[_0x5d695a(0x93d)]],_0x4db237=_0x2f117b[_0x5d695a(0xf27)],_0x1b9af8=_0x4db237[_0x5d695a(0xe9f)](/@([\p{L}\w]*)$/u);if(_0x1b9af8){const _0x5e76eb=_0x10d763[_0x5d695a(0x761)][_0x5d695a(0xca7)]||'我',_0xf1cac9=_0x10d763[_0x5d695a(0x2b3)][_0x5d695a(0x796)](_0x207cc7=>_0x207cc7[_0x5d695a(0xc8f)])[_0x5d695a(0x138)](_0x536126=>_0x536126!==_0x5e76eb);_0x327430[_0x5d695a(0x595)]='';if(_0xf1cac9['length']>0x0){const _0x449c4f=_0x1b9af8[0x1];_0xf1cac9[_0x5d695a(0x494)](_0x5b507b=>{const _0x183d4a=_0x5d695a;if(_0x5b507b[_0x183d4a(0xb03)]()['includes'](_0x449c4f[_0x183d4a(0xb03)]())){const _0x2f698b=document[_0x183d4a(0x383)](_0x183d4a(0x1285));_0x2f698b[_0x183d4a(0x3db)]=_0x183d4a(0x5c8),_0x2f698b['textContent']=_0x5b507b,_0x2f698b[_0x183d4a(0x4b8)](_0x183d4a(0xc23),_0xcafdb9=>{const _0x9eb01c=_0x183d4a;_0xcafdb9[_0x9eb01c(0xf87)]();const _0x12b909=_0x4db237[_0x9eb01c(0x8d4)](0x0,_0x1b9af8['index'])+('@'+_0x5b507b+'\x20');_0x2f117b['value']=_0x12b909,_0x327430[_0x9eb01c(0x794)][_0x9eb01c(0x33d)]=_0x9eb01c(0x379),_0x2f117b['focus']();}),_0x327430[_0x183d4a(0x120c)](_0x2f698b);}}),_0x327430[_0x5d695a(0x794)][_0x5d695a(0x33d)]=_0x327430[_0x5d695a(0x7b5)][_0x5d695a(0x594)]>0x0?'block':_0x5d695a(0x379);}else _0x327430[_0x5d695a(0x794)][_0x5d695a(0x33d)]=_0x5d695a(0x379);}else _0x327430['style'][_0x5d695a(0x33d)]=_0x5d695a(0x379);}),_0x2f117b['addEventListener'](_0x47aceb(0x1053),()=>{setTimeout(()=>{const _0x309b51=_0x10a9;_0x327430[_0x309b51(0x794)]['display']='none';},0xc8);}),document[_0x47aceb(0x11e3)](_0x47aceb(0xb1f))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x3b56c4),document['getElementById']('show-announcement-board-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x26553f),document['getElementById']('close-announcement-board-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x1f1099=_0x47aceb;document[_0x1f1099(0x11e3)](_0x1f1099(0xa6a))[_0x1f1099(0x505)][_0x1f1099(0x957)](_0x1f1099(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0xe63))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2271b5=>{const _0x467c7d=_0x47aceb;if(_0x2271b5['target'][_0x467c7d(0x505)][_0x467c7d(0x1121)](_0x467c7d(0x34c))){const _0x45868b=_0x2271b5['target'][_0x467c7d(0xaca)][_0x467c7d(0x6c4)];_0x45868b&&_0x3bea22(_0x45868b);}}),document['getElementById'](_0x47aceb(0x602))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2c3606),document[_0x47aceb(0x11e3)](_0x47aceb(0xb5b))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0xff4edc),document['getElementById']('announcement-action-cancel')['addEventListener'](_0x47aceb(0x1041),()=>{const _0x1bbe06=_0x47aceb;document['getElementById'](_0x1bbe06(0x8f4))[_0x1bbe06(0x505)][_0x1bbe06(0x957)]('visible');}),document['getElementById'](_0x47aceb(0x12fc))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x1bc35a=_0x47aceb;document[_0x1bc35a(0x11e3)]('global-css-input')['value']='';}),document[_0x47aceb(0x11e3)](_0x47aceb(0x113d))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x4320e6),document[_0x47aceb(0x11e3)](_0x47aceb(0x225))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x2b1f34=_0x47aceb;_0x4e7698(_0x2b1f34(0x9fc));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x10c7))[_0x47aceb(0x4b8)]('click',_0xc81940),document[_0x47aceb(0x11e3)]('summarize-recent-btn-header')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x51c7f9),document[_0x47aceb(0x11e3)](_0x47aceb(0xe75))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x128209=>{const _0x1d032f=_0x47aceb,_0x29ed31=_0x128209[_0x1d032f(0xd7c)][_0x1d032f(0xfe1)](_0x1d032f(0x8ea));if(_0x29ed31){_0xff5362(_0x29ed31[_0x1d032f(0xaca)][_0x1d032f(0x5d9)],parseInt(_0x29ed31[_0x1d032f(0xaca)][_0x1d032f(0x10cc)]));return;}const _0x3f5acd=_0x128209['target'][_0x1d032f(0xfe1)](_0x1d032f(0x2b6));if(_0x3f5acd){_0x2c1340(_0x3f5acd[_0x1d032f(0xaca)][_0x1d032f(0x5d9)],parseInt(_0x3f5acd[_0x1d032f(0xaca)][_0x1d032f(0x10cc)]));return;}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x29c))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x3ea533),document[_0x47aceb(0x11e3)]('close-gomoku-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x612128);const _0x5ae3bc=document[_0x47aceb(0x11e3)](_0x47aceb(0xe05));_0x5ae3bc[_0x47aceb(0x4b8)]('mousemove',_0x31b145),_0x5ae3bc[_0x47aceb(0x4b8)](_0x47aceb(0xbc8),()=>_0x4a6267(_0x5de8b7['activeChatId'])),_0x5ae3bc[_0x47aceb(0x4b8)]('click',_0x1e5462),document['getElementById'](_0x47aceb(0xf06))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x38d539=_0x47aceb;document[_0x38d539(0x11e3)](_0x38d539(0x925))[_0x38d539(0xf27)]='',document['getElementById'](_0x38d539(0x11d3))[_0x38d539(0xf27)]='',document[_0x38d539(0x11e3)]('create-countdown-modal')['classList'][_0x38d539(0x252)](_0x38d539(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0xd4c))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x4ef54a=_0x47aceb;document[_0x4ef54a(0x11e3)](_0x4ef54a(0xef7))[_0x4ef54a(0x505)][_0x4ef54a(0x957)](_0x4ef54a(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0xf7f))[_0x47aceb(0x4b8)]('click',_0x5df417),document[_0x47aceb(0x11e3)](_0x47aceb(0x296))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x49d86a),document[_0x47aceb(0x11e3)]('cancel-call-message-action-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x3f160c),document['getElementById']('edit-last-response-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x4a5d45),document['getElementById'](_0x47aceb(0x492))['addEventListener'](_0x47aceb(0x1041),()=>{const _0x634479=_0x47aceb;document[_0x634479(0x11e3)](_0x634479(0x480))[_0x634479(0x505)]['remove']('visible');}),document[_0x47aceb(0x11e3)](_0x47aceb(0x82d))['addEventListener'](_0x47aceb(0x1041),_0x512f94),document[_0x47aceb(0x11e3)](_0x47aceb(0x184))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0xb35019=_0x47aceb,_0x28b009=document[_0xb35019(0x11e3)](_0xb35019(0xc25)),_0x1f937f=_0x4dc376(_0xb35019(0x6f4));_0x28b009[_0xb35019(0x120c)](_0x1f937f),_0x1f937f[_0xb35019(0x5ac)]('textarea')[_0xb35019(0xc1f)]();}),document[_0x47aceb(0x11e3)](_0x47aceb(0x273))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2e3203),document['getElementById'](_0x47aceb(0x46e))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x587a30),document[_0x47aceb(0x11e3)](_0x47aceb(0xcad))[_0x47aceb(0x4b8)]('click',_0x180cc7),document['getElementById'](_0x47aceb(0xd42))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x27ae44=_0x47aceb;document['getElementById'](_0x27ae44(0x612))['click']();}),document[_0x47aceb(0x11e3)](_0x47aceb(0x612))[_0x47aceb(0x4b8)]('change',_0x129866),document[_0x47aceb(0x11e3)](_0x47aceb(0x86e))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x2e7ec5=_0x47aceb,_0x8994c9=_0x2e7ec5(0xb88),_0x3b0c80=await _0x231a5a(_0x2e7ec5(0x1204),_0x8994c9,'',_0x2e7ec5(0x10bb));_0x3b0c80&&_0x3b0c80['trim']()&&await _0x5b7f51(_0x3b0c80);}),document[_0x47aceb(0x11e3)](_0x47aceb(0x765))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x25aa58),document[_0x47aceb(0x11e3)](_0x47aceb(0x106a))[_0x47aceb(0x4b8)]('click',()=>_0x4e7698(_0x47aceb(0x9fc))),document['getElementById']('go-to-cart-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x28594e),document[_0x47aceb(0x11e3)](_0x47aceb(0x435))[_0x47aceb(0x4b8)]('click',_0x25aa58),document[_0x47aceb(0x11e3)](_0x47aceb(0xb32))['addEventListener'](_0x47aceb(0x1041),_0x44390c),document[_0x47aceb(0x11e3)](_0x47aceb(0x15e))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x35377f=_0x47aceb;document[_0x35377f(0x11e3)](_0x35377f(0x1103))['classList']['remove'](_0x35377f(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x1304))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x4043f3=_0x47aceb;_0xe78be8=!_0xe78be8;const _0x2aabfb=document[_0x4043f3(0x11e3)](_0x4043f3(0x1304)),_0x55399b=document[_0x4043f3(0x11e3)](_0x4043f3(0x12c5)),_0x100b4f=document['getElementById']('product-grid');_0x2aabfb[_0x4043f3(0x794)]['color']=_0xe78be8?'var(--accent-color)':_0x4043f3(0x97e),_0xe78be8?(_0x55399b[_0x4043f3(0x794)][_0x4043f3(0x33d)]=_0x4043f3(0x10f4),_0x100b4f[_0x4043f3(0x794)][_0x4043f3(0x6dc)]=_0x4043f3(0x11ee)):(_0x55399b[_0x4043f3(0x794)][_0x4043f3(0x33d)]='none',_0x100b4f['style'][_0x4043f3(0x6dc)]='',_0x539314[_0x4043f3(0x7ab)](),document[_0x4043f3(0x10d6)]('.product-item.selected')[_0x4043f3(0x494)](_0x24c230=>_0x24c230[_0x4043f3(0x505)][_0x4043f3(0x957)](_0x4043f3(0xbbc))),document[_0x4043f3(0x11e3)](_0x4043f3(0xec6))[_0x4043f3(0x300)]=_0x4043f3(0xb47),document[_0x4043f3(0x11e3)](_0x4043f3(0x1be))['checked']=![]),_0x1deb57(),_0x250785();}),document[_0x47aceb(0x11e3)](_0x47aceb(0xcbf))[_0x47aceb(0x4b8)]('click',()=>{const _0x2693c8=_0x47aceb;_0xe78be8?_0x4addff(null):alert(_0x2693c8(0x74d));}),document['getElementById']('product-grid')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async _0x59a0e9=>{const _0x58cf11=_0x47aceb,_0x6a1da9=_0x59a0e9[_0x58cf11(0xd7c)]['closest'](_0x58cf11(0x84e));if(!_0x6a1da9)return;const _0x2d3359=parseInt(_0x6a1da9[_0x58cf11(0xaca)]['id']);if(isNaN(_0x2d3359))return;if(_0xe78be8){if(_0x59a0e9[_0x58cf11(0xd7c)]['classList'][_0x58cf11(0x1121)]('edit-product-btn')){_0x4addff(_0x2d3359);return;}if(_0x59a0e9[_0x58cf11(0xd7c)][_0x58cf11(0x505)][_0x58cf11(0x1121)]('delete-product-btn')){const _0x19857d=await _0x2e83f8[_0x58cf11(0x120)][_0x58cf11(0x1289)](_0x2d3359);if(!_0x19857d)return;const _0x1e5c93=await _0x58fd60('删除商品',_0x58cf11(0xc5f)+_0x19857d['name']+_0x58cf11(0xbec),{'confirmButtonClass':_0x58cf11(0x8a6)});_0x1e5c93&&(await _0x2e83f8[_0x58cf11(0x120)][_0x58cf11(0xc0c)](_0x2d3359),await _0x1deb57(),alert(_0x58cf11(0xcf5)));return;}_0x6a1da9[_0x58cf11(0x505)][_0x58cf11(0xe7e)](_0x58cf11(0xbbc));_0x539314[_0x58cf11(0x72a)](_0x2d3359)?_0x539314[_0x58cf11(0xc0c)](_0x2d3359):_0x539314[_0x58cf11(0x252)](_0x2d3359);document['getElementById'](_0x58cf11(0xec6))[_0x58cf11(0x300)]='删除\x20('+_0x539314['size']+')';return;}if(_0x59a0e9[_0x58cf11(0xd7c)][_0x58cf11(0x505)]['contains'](_0x58cf11(0x344))){const _0x3a5cc1=await _0x2e83f8[_0x58cf11(0x120)]['get'](_0x2d3359);_0x3a5cc1[_0x58cf11(0x1039)]&&_0x3a5cc1[_0x58cf11(0x1039)][_0x58cf11(0x594)]>0x0?_0x114ccb(_0x2d3359):(await _0x3cde4b(_0x2d3359),await _0x2fb06('成功',_0x58cf11(0x1091)));return;}_0x6a1da9[_0x58cf11(0x1121)](_0x59a0e9[_0x58cf11(0xd7c)])&&console[_0x58cf11(0x84b)]('点击了商品卡片:\x20'+_0x2d3359);}),document['getElementById']('cart-items-list')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x5699f0=>{const _0x3350aa=_0x47aceb,_0x1c6128=_0x5699f0[_0x3350aa(0xd7c)];_0x1c6128[_0x3350aa(0x505)][_0x3350aa(0x1121)](_0x3350aa(0x46b))&&_0x9a0716(parseInt(_0x1c6128['dataset']['id']),-0x1),_0x1c6128[_0x3350aa(0x505)][_0x3350aa(0x1121)](_0x3350aa(0x77d))&&_0x9a0716(parseInt(_0x1c6128[_0x3350aa(0xaca)]['id']),0x1),_0x1c6128['classList'][_0x3350aa(0x1121)](_0x3350aa(0x1b4))&&_0x592ec4();}),document['getElementById'](_0x47aceb(0x244))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x25def5=_0x47aceb;if(_0x103e33[_0x25def5(0x594)]===0x0)return;const _0x44fdf5=await _0x58fd60(_0x25def5(0x1263),'确定要清空购物车中的所有商品吗？');_0x44fdf5&&(_0x103e33=[],_0x32aedc(),_0x12cdec());}),document['getElementById'](_0x47aceb(0x25c))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),function(_0xba9f04){const _0x3ebbe2=_0x47aceb;document[_0x3ebbe2(0x10d6)](_0x3ebbe2(0xe2a))[_0x3ebbe2(0x494)](_0x24f30e=>{const _0x54154e=_0x3ebbe2;_0x24f30e[_0x54154e(0x3e4)]=_0xba9f04['target']['checked'];}),_0x592ec4();}),document[_0x47aceb(0x11e3)](_0x47aceb(0xea6))['addEventListener'](_0x47aceb(0x1041),()=>{const _0x1255d3=_0x47aceb;document[_0x1255d3(0x11e3)](_0x1255d3(0xe9a))['classList'][_0x1255d3(0x957)](_0x1255d3(0x250));}),document['getElementById']('save-product-btn')['addEventListener'](_0x47aceb(0x1041),_0x5d47dc),document[_0x47aceb(0x11e3)]('product-image-input')[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x2f0f71=>{const _0x4c6a58=_0x47aceb,_0x1d00a6=_0x2f0f71[_0x4c6a58(0xd7c)]['files'][0x0];if(_0x1d00a6){const _0x2ddcbf=new FileReader();_0x2ddcbf[_0x4c6a58(0x1e5)]=_0x516298=>{const _0x1d4a9b=_0x4c6a58;document[_0x1d4a9b(0x11e3)](_0x1d4a9b(0x1117))[_0x1d4a9b(0xf0a)]=_0x516298[_0x1d4a9b(0xd7c)][_0x1d4a9b(0x255)];},_0x2ddcbf[_0x4c6a58(0x1270)](_0x1d00a6);}}),document[_0x47aceb(0x11e3)](_0x47aceb(0xc9d))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x39099c=>{const _0x1d7c7c=_0x47aceb,_0x4cfe2e=_0x39099c['target'][_0x1d7c7c(0xfe1)](_0x1d7c7c(0x1135));if(_0x4cfe2e){const _0x214310=_0x4cfe2e['closest'](_0x1d7c7c(0x6a9));_0x214310&&_0x1ffc2a(parseInt(_0x214310['dataset'][_0x1d7c7c(0x702)]));}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x445))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x3b4966=_0x47aceb;document[_0x3b4966(0x11e3)](_0x3b4966(0xe4e))[_0x3b4966(0x505)]['remove'](_0x3b4966(0x250));}),document['getElementById'](_0x47aceb(0x1192))['addEventListener'](_0x47aceb(0x1041),async()=>{const _0x50dd8a=_0x47aceb,_0x200c42=Array[_0x50dd8a(0xee2)](document[_0x50dd8a(0x10d6)](_0x50dd8a(0x1224)))[_0x50dd8a(0x796)](_0x15faa8=>_0x15faa8[_0x50dd8a(0xaca)]['recipientName']);if(_0x200c42['length']===0x0){alert(_0x50dd8a(0xe04));return;}const _0x2933cd=_0x103e33[_0x50dd8a(0x138)](_0x518888=>document['querySelector'](_0x50dd8a(0x428)+_0x518888[_0x50dd8a(0x8a2)]+_0x50dd8a(0xde5)));await _0x38803b(_0x2933cd,_0x200c42),document[_0x50dd8a(0x11e3)]('gift-recipient-modal')[_0x50dd8a(0x505)][_0x50dd8a(0x957)](_0x50dd8a(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x10a0))['addEventListener']('click',_0x328f4b=>{const _0x5cbe48=_0x47aceb,_0x13d63e=_0x328f4b['target'][_0x5cbe48(0xfe1)](_0x5cbe48(0xcb4));_0x13d63e&&_0x13d63e['classList'][_0x5cbe48(0xe7e)](_0x5cbe48(0xbbc));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x59a))['addEventListener'](_0x47aceb(0xfeb),function(_0x19e69b){const _0x497442=_0x47aceb,_0x9dbe32=_0x19e69b[_0x497442(0xd7c)]['checked'];document[_0x497442(0x10d6)](_0x497442(0xa30))['forEach'](_0x551a5a=>{const _0x16beb3=_0x497442;_0x551a5a[_0x16beb3(0x505)]['toggle'](_0x16beb3(0xbbc),_0x9dbe32);});}),document[_0x47aceb(0x11e3)](_0x47aceb(0x971))['addEventListener']('click',_0x3c5dae),document['getElementById'](_0x47aceb(0xf97))[_0x47aceb(0x4b8)]('click',_0x4b130a),document[_0x47aceb(0x11e3)]('propel-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x3fc4eb),document[_0x47aceb(0x11e3)](_0x47aceb(0x1130))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x130148=_0x47aceb,_0x22d71c=document['getElementById']('notification-sound-player'),_0x1ab333=document['getElementById'](_0x130148(0x16d))[_0x130148(0xf27)]['trim']()||_0x2694ad;_0x22d71c[_0x130148(0xf0a)]=_0x1ab333,_0x22d71c[_0x130148(0x7d1)]()[_0x130148(0x100)](_0x5c6e2d=>alert(_0x130148(0x11b1)));}),document[_0x47aceb(0x11e3)]('reset-sound-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x3b9fed=_0x47aceb;document[_0x3b9fed(0x11e3)](_0x3b9fed(0x16d))[_0x3b9fed(0xf27)]='',alert(_0x3b9fed(0xa3));}),document[_0x47aceb(0x11e3)]('home-screen')[_0x47aceb(0x4b8)]('click',_0x3cae99=>{const _0x531101=_0x47aceb,_0x5644a5=_0x3cae99['target'];_0x5644a5[_0x531101(0x505)]['contains']('editable-text')&&_0x1df97a(_0x5644a5),_0x5644a5[_0x531101(0x505)][_0x531101(0x1121)]('editable-image')&&_0x4939d5(_0x5644a5);}),document[_0x47aceb(0x11e3)]('add-song-search-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x5c01db),document['getElementById'](_0x47aceb(0x1175))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x57b709=_0x47aceb;document[_0x57b709(0x11e3)](_0x57b709(0xf2d))[_0x57b709(0x505)][_0x57b709(0x957)](_0x57b709(0x250));}),document['getElementById'](_0x47aceb(0x73f))['addEventListener'](_0x47aceb(0x1041),_0x5c01db),document[_0x47aceb(0x11e3)](_0x47aceb(0x1175))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x5f128a=_0x47aceb;document[_0x5f128a(0x11e3)](_0x5f128a(0xf2d))[_0x5f128a(0x505)][_0x5f128a(0x957)](_0x5f128a(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x880))['addEventListener'](_0x47aceb(0xfeb),function(_0x34d490){const _0x273c85=_0x47aceb;document[_0x273c85(0x10d6)](_0x273c85(0x883))[_0x273c85(0x494)](_0xb9d103=>{const _0x5653c1=_0x273c85;_0xb9d103[_0x5653c1(0x3e4)]=_0x34d490[_0x5653c1(0xd7c)][_0x5653c1(0x3e4)];});}),document['getElementById'](_0x47aceb(0xf93))['addEventListener']('click',_0xa9b389=>{const _0x31857e=_0x47aceb,_0x352eb0=_0xa9b389['target'][_0x31857e(0xfe1)](_0x31857e(0xa52));if(_0x352eb0){const _0x180b47=_0x352eb0['querySelector']('.music-search-checkbox');_0x180b47&&(_0xa9b389['target']!==_0x180b47&&(_0x180b47[_0x31857e(0x3e4)]=!_0x180b47[_0x31857e(0x3e4)]));}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x292))[_0x47aceb(0x4b8)]('click',async()=>{const _0x53e869=_0x47aceb,_0x5d2ccd=document[_0x53e869(0x10d6)](_0x53e869(0xf7d));if(_0x5d2ccd[_0x53e869(0x594)]===0x0){alert(_0x53e869(0x7f9));return;}document[_0x53e869(0x11e3)]('music-search-results-modal')['classList']['remove'](_0x53e869(0x250)),await _0x2fb06(_0x53e869(0x63d),_0x53e869(0x742)+_0x5d2ccd[_0x53e869(0x594)]+_0x53e869(0x2a0));const _0x4a160c=Array[_0x53e869(0xee2)](_0x5d2ccd)[_0x53e869(0x796)](_0x50f628=>JSON[_0x53e869(0xb0c)](_0x50f628['closest'](_0x53e869(0xa52))[_0x53e869(0xaca)]['songJson']));let _0x507476=0x0,_0x1a75de=[];const _0x13737d=_0x4a160c[_0x53e869(0x796)](_0x20363a=>_0x1e525d(_0x20363a)),_0x27daa8=await Promise[_0x53e869(0xd4a)](_0x13737d);_0x27daa8[_0x53e869(0x494)]((_0x4d12cc,_0x12788d)=>{const _0x2299ec=_0x53e869;_0x4d12cc?(_0xb57b5b[_0x2299ec(0xcba)]['push'](_0x4d12cc),_0x507476++):_0x1a75de[_0x2299ec(0xf5)](_0x4a160c[_0x12788d][_0x2299ec(0x278)]);});_0x507476>0x0&&(await _0x539eb1(),_0x31e1af(),_0xb57b5b['currentIndex']===-0x1&&(_0xb57b5b[_0x53e869(0x12b5)]=_0xb57b5b['playlist'][_0x53e869(0x594)]-_0x507476,_0x359e1c()));let _0x162964=_0x53e869(0x6dd)+_0x507476+_0x53e869(0x247);_0x1a75de[_0x53e869(0x594)]>0x0&&(_0x162964+='\x0a\x0a'+_0x1a75de[_0x53e869(0x594)]+_0x53e869(0x65c)+_0x1a75de[_0x53e869(0xa4b)](_0x53e869(0x633))),await _0x2fb06(_0x53e869(0xfd4),_0x162964);}),document[_0x47aceb(0x11e3)](_0x47aceb(0x1060))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x1093f9=_0x47aceb;document[_0x1093f9(0x11e3)](_0x1093f9(0x1060))[_0x1093f9(0x505)]['toggle'](_0x1093f9(0xde6));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x73f))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x5c01db),document['getElementById'](_0x47aceb(0x1175))['addEventListener'](_0x47aceb(0x1041),()=>{const _0x55e780=_0x47aceb;document['getElementById'](_0x55e780(0xf2d))[_0x55e780(0x505)][_0x55e780(0x957)](_0x55e780(0x250));}),document['getElementById'](_0x47aceb(0xf93))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x3ddc74=>{const _0x17a76b=_0x47aceb,_0x14d397=_0x3ddc74[_0x17a76b(0xd7c)]['closest'](_0x17a76b(0xa52));if(_0x14d397&&_0x14d397['dataset'][_0x17a76b(0x9eb)]){const _0xc1ef1c=JSON['parse'](_0x14d397[_0x17a76b(0xaca)]['songJson']);handleSearchResultClick(_0xc1ef1c);}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x2f2))[_0x47aceb(0x4b8)]('click',_0x3333de),document[_0x47aceb(0x11e3)](_0x47aceb(0x967))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x4d86e9),document['getElementById'](_0x47aceb(0x11d7))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x1d004b),document['getElementById'](_0x47aceb(0xe95))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2114fa),document[_0x47aceb(0x11e3)](_0x47aceb(0xb5))['addEventListener'](_0x47aceb(0xfeb),()=>{const _0xea867=_0x47aceb;_0x5de8b7['globalSettings'][_0xea867(0x7b1)]=document['getElementById']('status-bar-toggle-switch')[_0xea867(0x3e4)],_0x2d3a77();}),document[_0x47aceb(0x11e3)](_0x47aceb(0xf5b))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x497360),document['getElementById'](_0x47aceb(0xc2))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x4ea355=_0x47aceb;document['getElementById'](_0x4ea355(0x66d))[_0x4ea355(0x505)][_0x4ea355(0x957)](_0x4ea355(0x250));}),document[_0x47aceb(0x11e3)]('confirm-clear-posts-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x469f32),document[_0x47aceb(0x11e3)](_0x47aceb(0xb98))['addEventListener']('click',_0x4b3a9c=>{const _0x4270c4=_0x47aceb,_0x2fadbc=_0x4b3a9c[_0x4270c4(0xd7c)][_0x4270c4(0xfe1)](_0x4270c4(0xa53));_0x2fadbc&&_0x2fadbc[_0x4270c4(0x505)]['toggle'](_0x4270c4(0xbbc));}),document[_0x47aceb(0x11e3)](_0x47aceb(0xdc5))[_0x47aceb(0x4b8)]('change',async _0xd3553b=>{const _0x316afe=_0x47aceb,_0x566f70=_0xd3553b['target'][_0x316afe(0x5c9)][0x0];if(_0x566f70){const _0x3e4998=await new Promise(_0x417856=>{const _0x1df68f=_0x316afe,_0x12c6e9=new FileReader();_0x12c6e9['onload']=()=>_0x417856(_0x12c6e9[_0x1df68f(0x255)]),_0x12c6e9['readAsDataURL'](_0x566f70);});_0x5de8b7[_0x316afe(0x2df)][_0x316afe(0x720)]=_0x3e4998,_0x1f90a4();}_0xd3553b[_0x316afe(0xd7c)][_0x316afe(0xf27)]=null;}),document[_0x47aceb(0x11e3)](_0x47aceb(0x78b))[_0x47aceb(0x4b8)]('click',()=>{const _0x401b54=_0x47aceb;_0x5de8b7[_0x401b54(0x2df)][_0x401b54(0x720)]='',_0x1f90a4();}),document[_0x47aceb(0x11e3)](_0x47aceb(0x4f0))[_0x47aceb(0x4b8)]('click',async()=>{const _0x43f8af=_0x47aceb;_0x336b5e&&(_0x5de8b7[_0x43f8af(0x2df)][_0x43f8af(0x11d)]=_0x336b5e),_0x5de8b7[_0x43f8af(0x2df)]['globalCss']=document[_0x43f8af(0x11e3)](_0x43f8af(0x434))[_0x43f8af(0xf27)][_0x43f8af(0xeb7)](),_0x5de8b7[_0x43f8af(0x2df)][_0x43f8af(0x688)]=document[_0x43f8af(0x11e3)](_0x43f8af(0x16d))[_0x43f8af(0xf27)][_0x43f8af(0xeb7)](),_0x5de8b7[_0x43f8af(0x2df)][_0x43f8af(0x7b1)]=document[_0x43f8af(0x11e3)]('status-bar-toggle-switch')[_0x43f8af(0x3e4)],await _0x2e83f8['globalSettings'][_0x43f8af(0xe3c)](_0x5de8b7[_0x43f8af(0x2df)]),_0x34145f(),_0x336b5e=null,_0x40cea2(),_0x1a2892(_0x5de8b7[_0x43f8af(0x2df)][_0x43f8af(0x691)]),_0x2d3a77(),alert(_0x43f8af(0x6fe)),_0x4e7698('home-screen');}),document['getElementById'](_0x47aceb(0xd57))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x12a4dc=_0x47aceb,_0x3657c1=await _0x231a5a(_0x12a4dc(0x1188),'请输入背景图片的URL','',_0x12a4dc(0x10ac));if(_0x3657c1&&_0x3657c1['trim']())_0x5de8b7['globalSettings']['globalChatBackground']=_0x3657c1[_0x12a4dc(0xeb7)](),_0x1f90a4();else _0x3657c1!==null&&alert(_0x12a4dc(0xa8e));}),document['getElementById']('upload-ephone-bg-url-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x27a81e=_0x47aceb,_0x256bac=await _0x231a5a(_0x27a81e(0x43a),'请输入EPhone主屏幕的背景图片URL','',_0x27a81e(0x10ac));if(_0x256bac&&_0x256bac['trim']())_0x336b5e=_0x256bac[_0x27a81e(0xeb7)](),_0x1f90a4();else _0x256bac!==null&&alert(_0x27a81e(0xa8e));}),document[_0x47aceb(0x11e3)]('upload-cphone-bg-url-btn')['addEventListener'](_0x47aceb(0x1041),async()=>{const _0x156cb0=_0x47aceb,_0x33f717=await _0x231a5a(_0x156cb0(0x1063),_0x156cb0(0x1246),'',_0x156cb0(0x10ac));if(_0x33f717&&_0x33f717[_0x156cb0(0xeb7)]())_0x5de8b7['globalSettings']['cphoneWallpaper']=_0x33f717[_0x156cb0(0xeb7)](),_0x1f90a4();else _0x33f717!==null&&alert(_0x156cb0(0xa8e));}),document['getElementById'](_0x47aceb(0x11a0))['addEventListener'](_0x47aceb(0x1041),()=>{const _0x38f7c3=_0x47aceb;_0x336b5e=null,_0x5de8b7['globalSettings'][_0x38f7c3(0x11d)]='',_0x1f90a4();}),document['getElementById'](_0x47aceb(0x73b))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x5c526d=_0x47aceb;_0x5de8b7[_0x5c526d(0x2df)][_0x5c526d(0xaa4)]='',_0x1f90a4();}),document[_0x47aceb(0x11e3)]('css-preset-select')['addEventListener'](_0x47aceb(0xfeb),_0x3dfc0b),document[_0x47aceb(0x11e3)]('save-css-preset-btn')['addEventListener']('click',_0x46b343),document['getElementById'](_0x47aceb(0xd14))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0xdcf18a),document[_0x47aceb(0x11e3)](_0x47aceb(0xb28))[_0x47aceb(0x4b8)]('change',_0x1fac30),document[_0x47aceb(0x11e3)](_0x47aceb(0x7b6))[_0x47aceb(0x4b8)]('click',_0x3f473c),document[_0x47aceb(0x11e3)](_0x47aceb(0x343))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x359282),document[_0x47aceb(0x11e3)]('theme-preset-select')[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0xaab675),document[_0x47aceb(0x11e3)](_0x47aceb(0x1228))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2ee191),document[_0x47aceb(0x11e3)](_0x47aceb(0x7f6))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x272534),document[_0x47aceb(0x11e3)](_0x47aceb(0xd6e))[_0x47aceb(0x4b8)]('click',_0x178968),document[_0x47aceb(0x11e3)](_0x47aceb(0x658))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x341791=_0x47aceb;document[_0x341791(0x11e3)](_0x341791(0x514))[_0x341791(0x505)]['remove'](_0x341791(0x250)),_0x40d6fc();}),document[_0x47aceb(0x11e3)]('add-new-sticker-category-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x16bb08),document[_0x47aceb(0x11e3)](_0x47aceb(0xb6f))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x1b0cf9=>{const _0x152098=_0x47aceb;if(_0x1b0cf9[_0x152098(0xd7c)][_0x152098(0x505)][_0x152098(0x1121)]('delete-group-btn')){const _0x18f004=parseInt(_0x1b0cf9[_0x152098(0xd7c)][_0x152098(0xaca)]['id']);_0x1e65b7(_0x18f004);}}),document[_0x47aceb(0x11e3)]('sticker-category-tabs')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x108cfa=>{const _0x3638cc=_0x47aceb;if(_0x108cfa[_0x3638cc(0xd7c)]['classList']['contains'](_0x3638cc(0xcef))){const _0x5d0c54=_0x108cfa[_0x3638cc(0xd7c)]['dataset'][_0x3638cc(0x9ee)],_0x3b521e=_0x5d0c54!==_0x3638cc(0xd4a)&&_0x5d0c54!==_0x3638cc(0xb81)?parseInt(_0x5d0c54):_0x5d0c54;_0x2a42d7(_0x3b521e);}}),document[_0x47aceb(0x11e3)](_0x47aceb(0xca6))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x45a295),document[_0x47aceb(0x11e3)](_0x47aceb(0x9f5))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2d6235),document[_0x47aceb(0x11e3)]('import-single-chat-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x388a81=_0x47aceb;document[_0x388a81(0x11e3)](_0x388a81(0x22a))[_0x388a81(0x1041)]();}),document[_0x47aceb(0x11e3)]('import-single-chat-input')[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x58c994=>{const _0x3bb05a=_0x47aceb,_0x231807=_0x58c994[_0x3bb05a(0xd7c)]['files'][0x0];_0x231807&&_0x4eb82e(_0x231807),_0x58c994['target'][_0x3bb05a(0xf27)]=null;}),document[_0x47aceb(0x11e3)](_0x47aceb(0xd85))['addEventListener'](_0x47aceb(0x1041),()=>_0x314d5b()),document['getElementById'](_0x47aceb(0x319))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>openDiaryEditor()),document['getElementById'](_0x47aceb(0xc04))['addEventListener'](_0x47aceb(0x1041),_0x15d9fe),document['getElementById'](_0x47aceb(0x5c1))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x27b7e7),document['getElementById']('favorite-memo-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x131b68),document['getElementById'](_0x47aceb(0xeb8))[_0x47aceb(0x4b8)]('click',async()=>{const _0x52534f=_0x47aceb;_0x2fb06('正在执行...',_0x52534f(0xbed));try{await Promise['all']([_0x11082d(),_0x500f54()]),console[_0x52534f(0x84b)](_0x52534f(0x940));}catch(_0x5ec8a6){console[_0x52534f(0x1c1)](_0x52534f(0x87c),_0x5ec8a6),await _0x2fb06(_0x52534f(0x1177),_0x52534f(0xa96)+_0x5ec8a6[_0x52534f(0x4bc)]);}}),document['getElementById'](_0x47aceb(0xa6d))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x3716b1=>{const _0x25aa32=_0x47aceb,_0x402bad=_0x3716b1['target']['closest'](_0x25aa32(0x5e1));if(_0x402bad&&_0x402bad['dataset'][_0x25aa32(0xc8b)]){const _0x980f93=parseInt(_0x402bad[_0x25aa32(0xaca)][_0x25aa32(0xc8b)]);!isNaN(_0x980f93)&&_0x1bab53(_0x980f93);}}),document[_0x47aceb(0x11e3)]('back-to-char-qq-list-btn')[_0x47aceb(0x4b8)]('click',()=>{const _0x4ec18e=_0x47aceb;_0x5a5fee(_0x4ec18e(0x863));});const _0x106410=document[_0x47aceb(0x11e3)](_0x47aceb(0x56e)),_0x149088=()=>{const _0x370c16=_0x47aceb;if(_0x502483!==_0x370c16(0x1a1))return;if(_0x106410['scrollTop']<0x1&&!_0x39fb90){const _0x4de363=_0x5de8b7[_0x370c16(0x737)][_0x698363]?.[_0x370c16(0x49e)][_0x370c16(0x594)]||0x0;_0x4de363>_0xb72583&&_0x3774d2();}};_0x106410[_0x47aceb(0x4b8)](_0x47aceb(0x11a9),_0x149088),document[_0x47aceb(0x11e3)](_0x47aceb(0x1028))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x243cdf=_0x47aceb;alert(_0x243cdf(0xe41));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x28b))['addEventListener']('click',_0xffc4eb),document[_0x47aceb(0x11e3)](_0x47aceb(0x1220))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x1820fe=>{const _0x2f745a=_0x47aceb,_0x17f83a=_0x1820fe['target']['closest'](_0x2f745a(0x70a));if(_0x17f83a&&_0x17f83a[_0x2f745a(0xaca)][_0x2f745a(0x1029)]){const _0xa5954=_0x17f83a[_0x2f745a(0xaca)][_0x2f745a(0x1029)];_0x2fb06(_0x2f745a(0x11cc),_0xa5954[_0x2f745a(0x1018)](/\n/g,_0x2f745a(0xf70)));}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x1d3))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x40b97b),document['getElementById'](_0x47aceb(0x8e7))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x1cb8f7),document[_0x47aceb(0x11e3)]('char-product-grid')['addEventListener'](_0x47aceb(0x1041),_0xf9552=>{const _0x2b603c=_0x47aceb,_0x27acd3=_0xf9552[_0x2b603c(0xd7c)][_0x2b603c(0xfe1)](_0x2b603c(0x1c8));if(_0x27acd3&&_0x27acd3[_0x2b603c(0xaca)][_0x2b603c(0xc67)]){const _0x44d367=_0x27acd3[_0x2b603c(0xaca)]['reason'];_0x2fb06(_0x2b603c(0x5d4),_0x44d367[_0x2b603c(0x1018)](/\n/g,'<br>'));}}),window[_0x47aceb(0xd2)]=_0x12eb6b,document['getElementById'](_0x47aceb(0x489))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x341fb3),document[_0x47aceb(0x11e3)]('char-memo-detail-back-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>_0x5a5fee(_0x47aceb(0xf8c))),document[_0x47aceb(0x11e3)]('regenerate-char-diary-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x30f18a),document[_0x47aceb(0x11e3)]('add-char-diary-btn')['addEventListener'](_0x47aceb(0x1041),_0x1caf07),document[_0x47aceb(0x11e3)](_0x47aceb(0x7cd))[_0x47aceb(0x4b8)]('click',()=>_0x5a5fee('char-diary-screen')),document['getElementById'](_0x47aceb(0xed9))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x18dd93),document[_0x47aceb(0x11e3)](_0x47aceb(0x751))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x24cbcf),document[_0x47aceb(0x11e3)](_0x47aceb(0x78a))[_0x47aceb(0x4b8)]('click',_0x337a1f),document[_0x47aceb(0x11e3)](_0x47aceb(0x375))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x7e1e21),document[_0x47aceb(0x11e3)](_0x47aceb(0xc2b))['addEventListener'](_0x47aceb(0x1041),_0x2dc469),document['getElementById'](_0x47aceb(0xc2b))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2dc469),document['getElementById'](_0x47aceb(0xa2b))['addEventListener'](_0x47aceb(0x1041),()=>_0x4e7698(_0x47aceb(0xacd))),document[_0x47aceb(0x11e3)](_0x47aceb(0x162))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x4ae0c2),document['getElementById'](_0x47aceb(0x6c8))['addEventListener']('click',_0x187a0f),document[_0x47aceb(0x11e3)](_0x47aceb(0xd1a))['addEventListener'](_0x47aceb(0xfeb),async _0x3d4182=>{const _0x5407ea=_0x47aceb,_0x523cf1=_0x3d4182[_0x5407ea(0xd7c)][_0x5407ea(0x5c9)][0x0];if(_0x523cf1){const _0x18a691=await new Promise(_0x267ed0=>{const _0x4a53d4=_0x5407ea,_0x44647d=new FileReader();_0x44647d[_0x4a53d4(0x1e5)]=()=>_0x267ed0(_0x44647d[_0x4a53d4(0x255)]),_0x44647d['readAsDataURL'](_0x523cf1);});_0x5de8b7[_0x5407ea(0x2df)][_0x5407ea(0xaa4)]=_0x18a691,_0x1f90a4();}}),document[_0x47aceb(0x11e3)]('cphone-icon-settings-grid')[_0x47aceb(0x4b8)]('click',_0x32eb79=>{const _0x100bc4=_0x47aceb;if(_0x32eb79['target'][_0x100bc4(0x505)][_0x100bc4(0x1121)]('change-icon-btn')){const _0xdea008=_0x32eb79['target'][_0x100bc4(0xfe1)](_0x100bc4(0xea4)),_0xd50491=_0xdea008['dataset'][_0x100bc4(0xe9)];_0xd50491&&_0x5b6858(_0xd50491,_0x100bc4(0x63e),_0xdea008);}}),document['getElementById'](_0x47aceb(0xf96))[_0x47aceb(0x4b8)]('click',()=>{const _0x9bb9d=_0x47aceb;document[_0x9bb9d(0x11e3)](_0x9bb9d(0xfd6))['click']();}),document[_0x47aceb(0x11e3)]('import-appearance-input')['addEventListener']('change',_0x1889a6=>{const _0x44cb62=_0x47aceb,_0x1a15fd=_0x1889a6['target'][_0x44cb62(0x5c9)][0x0];_0x1a15fd&&_0xfa2c32(_0x1a15fd),_0x1889a6[_0x44cb62(0xd7c)][_0x44cb62(0xf27)]=null;}),document['addEventListener'](_0x47aceb(0x621),()=>{const _0x19b11e=_0x47aceb;document[_0x19b11e(0xee9)]===_0x19b11e(0x1fe)&&(localStorage[_0x19b11e(0x3b2)](_0x19b11e(0x4a6),Date['now']()),console[_0x19b11e(0x84b)]('应用已切换到后台，记录当前时间。'));}),document['getElementById'](_0x47aceb(0xfa8))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x1fabe1),document[_0x47aceb(0x11e3)](_0x47aceb(0x475))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x3a281a=_0x47aceb;document['getElementById'](_0x3a281a(0x831))[_0x3a281a(0x1041)]();}),document[_0x47aceb(0x11e3)](_0x47aceb(0x831))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x51ffe5=>{const _0x53560c=_0x47aceb,_0x4cf478=_0x51ffe5['target']['files'][0x0];_0x4cf478&&_0xd97fce(_0x4cf478),_0x51ffe5[_0x53560c(0xd7c)]['value']=null;}),document[_0x47aceb(0x11e3)](_0x47aceb(0x61a))['addEventListener'](_0x47aceb(0xfeb),async _0x39e7a9=>{const _0x18ad78=_0x47aceb,_0x5b699a=_0x39e7a9['target'][_0x18ad78(0x3e4)];_0x5de8b7['globalSettings'][_0x18ad78(0xbd4)]=_0x5b699a,await _0x2e83f8[_0x18ad78(0x2df)][_0x18ad78(0xe3c)](_0x5de8b7[_0x18ad78(0x2df)]);const _0x2ea69e=document[_0x18ad78(0x5ac)](_0x18ad78(0x35e));if(_0x2ea69e)switch(_0x2ea69e['id']){case _0x18ad78(0x9fc):_0x544ab5(_0x5de8b7[_0x18ad78(0x93d)]);break;case _0x18ad78(0xf1e):if(document[_0x18ad78(0x11e3)]('qzone-screen')[_0x18ad78(0x505)][_0x18ad78(0x1121)](_0x18ad78(0x1fc)))_0xae9c28();if(document[_0x18ad78(0x11e3)](_0x18ad78(0xd51))[_0x18ad78(0x505)][_0x18ad78(0x1121)](_0x18ad78(0x1fc)))_0x2d2c08();break;case _0x18ad78(0xacd):_0x5f3633();break;case _0x18ad78(0x2c2):_0x216507(_0x3bea2e);break;case _0x18ad78(0xb4):const _0x1ead03=document[_0x18ad78(0x5ac)](_0x18ad78(0x643));if(_0x1ead03)switch(_0x1ead03['id']){case _0x18ad78(0xe92):_0x746188();break;case'char-taobao-screen':_0x1953b4();break;case _0x18ad78(0x5ff):const _0x5bc7b3=_0x5de8b7[_0x18ad78(0x737)][_0x698363],_0x22f1f3=_0x5bc7b3['simulatedBrowserHistory']||[],_0x23544e=_0x22f1f3[_0x18ad78(0x594)]>0x0?_0x22f1f3[_0x18ad78(0x594)]-0x1:0x0;_0x22853c(_0x22f1f3[_0x23544e]);break;case _0x18ad78(0x1099):_0x1eee84();break;case _0x18ad78(0x863):_0x29cf60();break;case _0x18ad78(0x1212):const _0x1eb2d8=document['querySelector'](_0x18ad78(0x3fe))?.[_0x18ad78(0xaca)][_0x18ad78(0xc8b)]||0x0;_0x1bab53(parseInt(_0x1eb2d8));break;}break;}_0x2fb06(_0x18ad78(0x86a),'AI生图功能已'+(_0x5b699a?'开启':'关闭')+'。');}),document[_0x47aceb(0x11e3)]('search-history-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x4baed4),document[_0x47aceb(0x11e3)]('search-history-back-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x33bd4d=_0x47aceb;_0x4e7698(_0x33bd4d(0x948));}),document[_0x47aceb(0x11e3)](_0x47aceb(0xedb))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x50644e),document[_0x47aceb(0x11e3)]('clear-search-btn')['addEventListener'](_0x47aceb(0x1041),_0x5bb298),document[_0x47aceb(0x11e3)](_0x47aceb(0x769))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x15485d),document[_0x47aceb(0x11e3)](_0x47aceb(0xf0d))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x1ac606),document['querySelector'](_0x47aceb(0xd82))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0xf1b6a6=>{const _0x28be03=_0x47aceb;if(_0xf1b6a6[_0x28be03(0xd7c)][_0x28be03(0x505)][_0x28be03(0x1121)](_0x28be03(0xf28))){const _0x21ad61=parseInt(_0xf1b6a6[_0x28be03(0xd7c)][_0x28be03(0xaca)]['id']);!isNaN(_0x21ad61)&&_0x31fb15(_0x21ad61);}}),_0x5c2433(),window['openPresetScreen']=_0x56bc1a,document[_0x47aceb(0x11e3)]('add-preset-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x28425e=_0x47aceb,_0x572efb=await _0x231a5a(_0x28425e(0xf3),_0x28425e(0x112f));if(_0x572efb&&_0x572efb['trim']()){const _0x14b827={'id':'preset_'+Date['now'](),'name':_0x572efb['trim'](),'content':[]};await _0x2e83f8[_0x28425e(0x427)][_0x28425e(0x252)](_0x14b827),await _0x2df24e(),_0x991a41(_0x14b827['id']);}}),document[_0x47aceb(0x11e3)](_0x47aceb(0xf46))['addEventListener'](_0x47aceb(0x1041),_0x471f38),document['getElementById'](_0x47aceb(0x314))[_0x47aceb(0x4b8)]('click',()=>{const _0x92b12c=_0x47aceb,_0x101f42=document['getElementById']('preset-entries-container');_0x101f42['querySelector']('p')&&(_0x101f42[_0x92b12c(0x595)]='');const _0x2ab181=_0x424f18();_0x101f42[_0x92b12c(0x120c)](_0x2ab181),_0x2ab181[_0x92b12c(0x5ac)](_0x92b12c(0xb53))[_0x92b12c(0xc1f)]();}),document[_0x47aceb(0x11e3)](_0x47aceb(0xd2e))['addEventListener'](_0x47aceb(0x1041),async()=>{const _0x470c7c=_0x47aceb;if(!_0x2e6df1)return;const _0x39b3ef=await _0x2e83f8[_0x470c7c(0x427)]['get'](_0x2e6df1);if(!_0x39b3ef)return;const _0x7bbda4=document[_0x470c7c(0x11e3)](_0x470c7c(0xaa1))[_0x470c7c(0xf27)][_0x470c7c(0xeb7)]();if(!_0x7bbda4){alert(_0x470c7c(0x117a));return;}_0x39b3ef[_0x470c7c(0x278)]=_0x7bbda4,_0x39b3ef[_0x470c7c(0x9ee)]=parseInt(document[_0x470c7c(0x11e3)](_0x470c7c(0x92b))[_0x470c7c(0xf27)])||null;const _0x3ca8a9=document[_0x470c7c(0x11e3)]('preset-entries-container'),_0x445b09=_0x3ca8a9[_0x470c7c(0x10d6)](_0x470c7c(0xdba)),_0x52646e=[];_0x445b09[_0x470c7c(0x494)](_0x4ff44a=>{const _0x112c35=_0x470c7c,_0x2e8ee5=_0x4ff44a[_0x112c35(0x5ac)](_0x112c35(0xb53))['value'][_0x112c35(0xeb7)]();_0x2e8ee5&&_0x52646e[_0x112c35(0xf5)]({'comment':_0x4ff44a[_0x112c35(0x5ac)]('.entry-comment-input')[_0x112c35(0xf27)][_0x112c35(0xeb7)](),'keys':(_0x4ff44a[_0x112c35(0x5ac)](_0x112c35(0x6bf))[_0x112c35(0xf27)][_0x112c35(0xeb7)]()||'')[_0x112c35(0x65b)](',')[_0x112c35(0x796)](_0x5db7f7=>_0x5db7f7[_0x112c35(0xeb7)]())[_0x112c35(0x138)](Boolean),'content':_0x2e8ee5,'enabled':_0x4ff44a[_0x112c35(0x5ac)](_0x112c35(0x8d8))[_0x112c35(0x3e4)]});}),_0x39b3ef[_0x470c7c(0x9a5)]=_0x52646e,await _0x2e83f8[_0x470c7c(0x427)][_0x470c7c(0xe3c)](_0x39b3ef),_0x2e6df1=null,_0x4e7698(_0x470c7c(0x3df)),await _0x2df24e();}),document[_0x47aceb(0x11e3)](_0x47aceb(0x4df))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x3a7583=_0x47aceb;document['getElementById']('import-preset-input')[_0x3a7583(0x1041)]();}),document[_0x47aceb(0x11e3)](_0x47aceb(0xf05))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x3a31b9),document[_0x47aceb(0x11e3)](_0x47aceb(0xd6f))['addEventListener'](_0x47aceb(0x1041),_0x4e1c52),document[_0x47aceb(0x11e3)]('clear-specific-data-btn')['addEventListener']('click',_0x478330),document[_0x47aceb(0x11e3)](_0x47aceb(0x1081))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x26ae3b=_0x47aceb;document[_0x26ae3b(0x11e3)](_0x26ae3b(0x9c5))[_0x26ae3b(0x505)][_0x26ae3b(0x957)]('visible');}),document[_0x47aceb(0x11e3)]('go-to-clear-step2-btn')[_0x47aceb(0x4b8)]('click',_0x40ddee),document[_0x47aceb(0x11e3)](_0x47aceb(0x54e))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x57b99f),document[_0x47aceb(0x11e3)]('cancel-clear-wizard-btn-step2')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x4e1826=_0x47aceb;document[_0x4e1826(0x11e3)](_0x4e1826(0x9c5))[_0x4e1826(0x505)][_0x4e1826(0x957)](_0x4e1826(0x250));}),document[_0x47aceb(0x11e3)]('confirm-final-clear-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2251dd),document[_0x47aceb(0x11e3)]('data-clear-wizard-modal')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x4553f4=>{const _0x378462=_0x47aceb,_0x42ec34=_0x4553f4[_0x378462(0xd7c)][_0x378462(0xfe1)](_0x378462(0xa53));_0x42ec34&&(_0x4553f4['stopPropagation'](),_0x42ec34[_0x378462(0x505)][_0x378462(0xe7e)]('selected'));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x9c5))['addEventListener']('change',_0x54d0c5=>{const _0x2e9a5c=_0x47aceb;if(_0x54d0c5[_0x2e9a5c(0xd7c)]['id']===_0x2e9a5c(0x961)){const _0x1a4b77=_0x54d0c5[_0x2e9a5c(0xd7c)][_0x2e9a5c(0x3e4)];document['querySelectorAll'](_0x2e9a5c(0x33e))[_0x2e9a5c(0x494)](_0x1158c8=>{const _0x220434=_0x2e9a5c;_0x1158c8['classList'][_0x220434(0xe7e)](_0x220434(0xbbc),_0x1a4b77);});}else{if(_0x54d0c5[_0x2e9a5c(0xd7c)]['id']===_0x2e9a5c(0x2f9)){const _0x2621fb=_0x54d0c5['target'][_0x2e9a5c(0x3e4)];document[_0x2e9a5c(0x10d6)](_0x2e9a5c(0x236))[_0x2e9a5c(0x494)](_0x3a0b0d=>{const _0x11b129=_0x2e9a5c;_0x3a0b0d[_0x11b129(0x505)]['toggle'](_0x11b129(0xbbc),_0x2621fb);});}}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x9e3))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x21a697),document[_0x47aceb(0x11e3)](_0x47aceb(0x585))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x5d74fd),document[_0x47aceb(0x11e3)](_0x47aceb(0xac2))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x5eb7c9),document[_0x47aceb(0x11e3)](_0x47aceb(0x4a4))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{_0x1c77e7('messages-view');}),document[_0x47aceb(0x11e3)]('add-npc-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>_0x5ba41b(null)),document[_0x47aceb(0x11e3)]('save-npc-btn')['addEventListener'](_0x47aceb(0x1041),_0x114290),document['getElementById'](_0x47aceb(0x4d9))[_0x47aceb(0x4b8)]('click',()=>{const _0x128d79=_0x47aceb;document[_0x128d79(0x11e3)]('npc-editor-modal')['classList'][_0x128d79(0x957)]('visible');}),document[_0x47aceb(0x11e3)](_0x47aceb(0x7d4))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0xba5796=>{const _0x2ea37e=_0x47aceb,_0x4c028b=_0xba5796[_0x2ea37e(0xd7c)][_0x2ea37e(0x5c9)][0x0];if(_0x4c028b){const _0x1cab7c=new FileReader();_0x1cab7c[_0x2ea37e(0x1e5)]=_0x3ce924=>{const _0x358a93=_0x2ea37e;document[_0x358a93(0x11e3)](_0x358a93(0x869))[_0x358a93(0xf0a)]=_0x3ce924['target'][_0x358a93(0x255)];},_0x1cab7c[_0x2ea37e(0x1270)](_0x4c028b);}}),document[_0x47aceb(0x11e3)](_0x47aceb(0x92a))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x374ca8=>{const _0x1417f5=_0x47aceb;if(_0x374ca8[_0x1417f5(0xd7c)]['id']===_0x1417f5(0x610))_0x3cb7cf();else _0x374ca8['target']['id']==='spectator-edit-btn'&&_0x4a5d45();}),_0xcb6204(document[_0x47aceb(0x11e3)]('music-visual-container'),()=>{const _0x1678a6=_0x47aceb;_0xb57b5b[_0x1678a6(0x12b5)]>-0x1&&_0x3e7d39(_0xb57b5b[_0x1678a6(0x12b5)]);}),document[_0x47aceb(0x11e3)](_0x47aceb(0x975))['addEventListener']('click',_0x434525),document[_0x47aceb(0x11e3)](_0x47aceb(0x24c))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x1a5071),document[_0x47aceb(0x11e3)](_0x47aceb(0xff9))[_0x47aceb(0x4b8)]('click',()=>{const _0x4c4432=_0x47aceb;document[_0x4c4432(0x11e3)]('douban-settings-modal')[_0x4c4432(0x505)]['remove'](_0x4c4432(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x549))[_0x47aceb(0x4b8)](_0x47aceb(0x6be),_0x4ca704=>{const _0x527702=_0x47aceb,_0x4a2cf2=_0x4ca704[_0x527702(0xd7c)][_0x527702(0xf27)]['toLowerCase'](),_0x3cd928=document[_0x527702(0x11e3)]('time-zone-select');for(const _0x5c6c50 of _0x3cd928['options']){const _0x463a1f=_0x5c6c50[_0x527702(0x300)][_0x527702(0xb03)]();_0x463a1f[_0x527702(0x3ad)](_0x4a2cf2)?_0x5c6c50[_0x527702(0x794)][_0x527702(0x33d)]='':_0x5c6c50[_0x527702(0x794)][_0x527702(0x33d)]='none';}}),window['openWerewolfLobby']=_0x3ab477,document[_0x47aceb(0x11e3)](_0x47aceb(0xd4f))[_0x47aceb(0x4b8)]('click',()=>_0x3ab477(_0x47aceb(0x264))),document[_0x47aceb(0x11e3)]('cancel-werewolf-lobby-btn')['addEventListener'](_0x47aceb(0x1041),()=>{const _0x3dc1b9=_0x47aceb;document[_0x3dc1b9(0x11e3)](_0x3dc1b9(0x57e))[_0x3dc1b9(0x505)][_0x3dc1b9(0x957)]('visible');}),document[_0x47aceb(0x11e3)]('start-werewolf-game-btn')[_0x47aceb(0x4b8)]('click',_0x3e2407),document[_0x47aceb(0x11e3)]('werewolf-role-confirm-btn')[_0x47aceb(0x4b8)]('click',()=>{const _0x111576=_0x47aceb;document[_0x111576(0x11e3)]('werewolf-role-modal')[_0x111576(0x505)]['remove']('visible'),_0x174fe7();}),document[_0x47aceb(0x11e3)]('exit-werewolf-game-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x233304=_0x47aceb,_0x524c44=await _0x58fd60('退出游戏',_0x233304(0x11d1),{'confirmButtonClass':_0x233304(0x8a6)});_0x524c44&&(_0x528823[_0x233304(0x3d5)]=![],_0x4e7698(_0x528823['chatId']?'chat-interface-screen':'home-screen'));}),document[_0x47aceb(0x11e3)](_0x47aceb(0xa89))['addEventListener'](_0x47aceb(0x1041),()=>{const _0x29bb17=_0x47aceb;document[_0x29bb17(0x11e3)](_0x29bb17(0x90a))[_0x29bb17(0x505)][_0x29bb17(0x957)](_0x29bb17(0x250)),_0x4e7698(_0x528823[_0x29bb17(0x115)]?_0x29bb17(0xf1e):_0x29bb17(0x417));}),document[_0x47aceb(0x11e3)]('cancel-wolf-kill-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x570736=_0x47aceb;document[_0x570736(0x11e3)](_0x570736(0x1227))[_0x570736(0x505)][_0x570736(0x957)]('visible');}),document[_0x47aceb(0x11e3)](_0x47aceb(0x9d9))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x278a6f=_0x47aceb;document[_0x278a6f(0x11e3)](_0x278a6f(0x57e))[_0x278a6f(0x505)]['remove']('visible');}),document[_0x47aceb(0x11e3)]('werewolf-retry-btn')['addEventListener'](_0x47aceb(0x1041),_0x5344e1),document['getElementById']('manual-werewolf-summary-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x43282f),document['getElementById'](_0x47aceb(0x115a))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x7becc8),document[_0x47aceb(0x11e3)](_0x47aceb(0x26e))['addEventListener']('click',_0x5120e1),document['getElementById'](_0x47aceb(0x10b7))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x58dbf0=_0x47aceb;document[_0x58dbf0(0x11e3)]('delete-world-books-modal')[_0x58dbf0(0x505)][_0x58dbf0(0x957)](_0x58dbf0(0x250));}),document[_0x47aceb(0x11e3)]('confirm-delete-world-books-btn')[_0x47aceb(0x4b8)]('click',_0x231f6d),document[_0x47aceb(0x11e3)]('delete-world-books-modal')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x443327=>{const _0x533637=_0x47aceb,_0x369255=_0x443327[_0x533637(0xd7c)][_0x533637(0xfe1)]('.clear-posts-item');_0x369255&&_0x369255['classList'][_0x533637(0xe7e)]('selected');if(_0x443327['target']['id']===_0x533637(0x12b9)){const _0x26c333=_0x443327[_0x533637(0xd7c)][_0x533637(0x3e4)];document[_0x533637(0x10d6)](_0x533637(0x5ed))[_0x533637(0x494)](_0x73057f=>{const _0x296788=_0x533637;_0x73057f['classList']['toggle'](_0x296788(0xbbc),_0x26c333);});}}),document['getElementById'](_0x47aceb(0x5a9))['addEventListener'](_0x47aceb(0x6be),()=>{_0x40d6fc(![]);}),document[_0x47aceb(0x11e3)](_0x47aceb(0xe52))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x52ed26=>{const _0x2e51d9=_0x47aceb;if(_0x52ed26[_0x2e51d9(0xd7c)][_0x2e51d9(0x505)]['contains'](_0x2e51d9(0xcef))){const _0x3050ec=_0x52ed26['target'][_0x2e51d9(0xaca)]['categoryId'],_0x2b46f=_0x3050ec!=='all'&&_0x3050ec!==_0x2e51d9(0xb81)?parseInt(_0x3050ec):_0x3050ec;document['getElementById'](_0x2e51d9(0x5a9))[_0x2e51d9(0xf27)]='',_0x2a42d7(_0x2b46f);}});const _0x707955=document[_0x47aceb(0x11e3)](_0x47aceb(0xc9d));_0x707955[_0x47aceb(0x4b8)](_0x47aceb(0x11a9),()=>{const _0x18a920=_0x47aceb;if(_0x707955['scrollTop']<0x1&&!_0x35a438){const _0x412f36=_0x5de8b7[_0x18a920(0x737)][_0x5de8b7[_0x18a920(0x93d)]]?.['history'][_0x18a920(0x594)]||0x0;_0x412f36>_0xd53d57&&_0x54384e();}});const _0x1fa973=document[_0x47aceb(0x11e3)](_0x47aceb(0x92c));_0x1fa973[_0x47aceb(0x4b8)](_0x47aceb(0x11a9),()=>{const _0x4e853e=_0x47aceb,{scrollTop:_0x158c9f,scrollHeight:_0x16951d,clientHeight:_0x27578f}=_0x1fa973;if(_0x16951d-_0x158c9f<=_0x27578f+0x32&&!_0x320eb9){const _0x397f28=_0x5de8b7['chats'][_0x5de8b7[_0x4e853e(0x93d)]]?.['thoughtsHistory'][_0x4e853e(0x594)]||0x0;_0x397f28>_0x441c78&&_0x24c4e4();}});const _0x509b16=document[_0x47aceb(0x5ac)]('#qzone-screen\x20.qzone-content');_0x509b16['addEventListener'](_0x47aceb(0x11a9),()=>{const _0x46fc15=_0x47aceb,{scrollTop:_0x2586e0,scrollHeight:_0x20eee5,clientHeight:_0x32f066}=_0x509b16;_0x20eee5-_0x2586e0<=_0x32f066+0x64&&!_0x48f5d6&&(_0x2814a8[_0x46fc15(0x594)]>_0x4f3fd1&&_0x314b99());}),document[_0x47aceb(0x11e3)]('read-together-btn')['addEventListener'](_0x47aceb(0x1041),_0x5ebd6a);const _0x1e3df6=document[_0x47aceb(0x11e3)]('reading-restore-btn');_0x511cbb(_0x1e3df6,_0x1e3df6),document[_0x47aceb(0x11e3)]('close-reading-btn')[_0x47aceb(0x4b8)]('click',_0x3a513d),document[_0x47aceb(0x11e3)](_0x47aceb(0xcf))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x18bfc1),document[_0x47aceb(0x11e3)]('next-page-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x421f20),document[_0x47aceb(0x11e3)](_0x47aceb(0xf94))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x55af62),document['getElementById'](_0x47aceb(0xe76))['addEventListener'](_0x47aceb(0xfeb),_0x4d234c),document[_0x47aceb(0x11e3)](_0x47aceb(0x54c))['addEventListener'](_0x47aceb(0x1041),_0x13cd2e),document[_0x47aceb(0x11e3)](_0x47aceb(0xc24))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x144f03),_0x511cbb(document[_0x47aceb(0x11e3)](_0x47aceb(0x40b)),document[_0x47aceb(0x5ac)](_0x47aceb(0xf03))),document['getElementById'](_0x47aceb(0xcf))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x18bfc1),document['getElementById']('close-reading-library-btn-header')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x14bab8=_0x47aceb;document[_0x14bab8(0x11e3)](_0x14bab8(0x615))['classList']['remove'](_0x14bab8(0x250));}),document[_0x47aceb(0x11e3)]('import-new-book-btn-header')['addEventListener'](_0x47aceb(0x1041),_0x2eb266),document['getElementById'](_0x47aceb(0x64a))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x4b2875=>{const _0x3d017c=_0x47aceb,_0x3a02e4=_0x4b2875[_0x3d017c(0xd7c)];if(_0x3a02e4[_0x3d017c(0x505)]['contains']('group-name')){const _0x5b6521=parseInt(_0x3a02e4['dataset'][_0x3d017c(0x179)]);_0xf778c0(_0x5b6521);}else{if(_0x3a02e4[_0x3d017c(0x505)][_0x3d017c(0x1121)](_0x3d017c(0xceb))){const _0x553910=parseInt(_0x3a02e4['dataset'][_0x3d017c(0x179)]);_0x30b55f(_0x553910);}}}),document[_0x47aceb(0x11e3)](_0x47aceb(0xcc))['addEventListener'](_0x47aceb(0x1041),_0xaf7d4e),document[_0x47aceb(0x11e3)](_0x47aceb(0x123))[_0x47aceb(0x4b8)]('input',_0x11208b=>{const _0x55fc6e=_0x47aceb;_0x4fe5c9(_0x11208b[_0x55fc6e(0xd7c)][_0x55fc6e(0xf27)]);});const _0x3db630=_0x33ce20(_0x310c68,0x12c);document['getElementById'](_0x47aceb(0x169))[_0x47aceb(0x4b8)](_0x47aceb(0x11a9),_0x3db630),document['getElementById'](_0x47aceb(0x125e))['addEventListener'](_0x47aceb(0x6be),_0x48f253=>{const _0x35697f=_0x47aceb;document[_0x35697f(0x11e3)]('api-temperature-value')[_0x35697f(0x300)]=_0x48f253['target'][_0x35697f(0xf27)];});const _0x289fa5=document[_0x47aceb(0x11e3)](_0x47aceb(0xde));_0x289fa5['addEventListener']('scroll',()=>{const {scrollTop:_0x290d6c,scrollHeight:_0x56188c,clientHeight:_0x5aee42}=_0x289fa5;_0x56188c-_0x290d6c<=_0x5aee42+0x96&&!_0x50f724&&_0x27e6c9();}),document['getElementById'](_0x47aceb(0x1d2))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x264c3b),document['getElementById'](_0x47aceb(0x462))[_0x47aceb(0x4b8)]('click',()=>{const _0x452d54=_0x47aceb;document[_0x452d54(0x11e3)](_0x452d54(0x5e3))['classList'][_0x452d54(0x957)](_0x452d54(0x250)),_0x4addff(_0x37ebf7);}),document['getElementById'](_0x47aceb(0x4da))['addEventListener']('click',_0x1a7edc),document['getElementById'](_0x47aceb(0x97c))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x165205=>{const _0x9d3fff=_0x47aceb;_0x165205[_0x9d3fff(0xd7c)][_0x9d3fff(0x505)][_0x9d3fff(0x1121)](_0x9d3fff(0xceb))&&_0x49e49d(parseInt(_0x165205['target']['dataset']['id']));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x1e8))['addEventListener'](_0x47aceb(0x1041),()=>_0x3e9ca6()),document['getElementById'](_0x47aceb(0xcc9))[_0x47aceb(0x4b8)]('click',()=>{const _0x2398c7=_0x47aceb;document['getElementById'](_0x2398c7(0xc65))[_0x2398c7(0x505)][_0x2398c7(0x957)](_0x2398c7(0x250));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x6d1))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x463fa4=_0x47aceb,_0x228b14=document[_0x463fa4(0x11e3)]('variation-quantity-display');let _0x139549=parseInt(_0x228b14['textContent']);if(_0x139549>0x1)_0x228b14[_0x463fa4(0x300)]=_0x139549-0x1;}),document['getElementById'](_0x47aceb(0xc41))['addEventListener'](_0x47aceb(0x1041),()=>{const _0x1babbf=_0x47aceb,_0x48f3a1=document['getElementById'](_0x1babbf(0x36a));_0x48f3a1[_0x1babbf(0x300)]=parseInt(_0x48f3a1[_0x1babbf(0x300)])+0x1;}),document['getElementById']('product-category-tabs')['addEventListener'](_0x47aceb(0x1041),_0xc5518f=>{const _0x312b40=_0x47aceb;if(_0xc5518f['target'][_0x312b40(0x505)][_0x312b40(0x1121)](_0x312b40(0x1008))){const _0x5b2fd0=_0xc5518f['target'][_0x312b40(0xaca)][_0x312b40(0x9ee)]===_0x312b40(0xd4a)?_0x312b40(0xd4a):parseInt(_0xc5518f[_0x312b40(0xd7c)][_0x312b40(0xaca)][_0x312b40(0x9ee)]);_0x58f720(_0x5b2fd0);}}),document['getElementById']('generate-shopping-items-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x2a31e8),document[_0x47aceb(0x11e3)](_0x47aceb(0xf52))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x41fa7e),document[_0x47aceb(0x11e3)](_0x47aceb(0x951))['addEventListener'](_0x47aceb(0x1041),_0x1da71a),document[_0x47aceb(0x11e3)](_0x47aceb(0x8bc))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x104495=_0x47aceb;document[_0x104495(0x11e3)](_0x104495(0x1101))[_0x104495(0x505)]['remove'](_0x104495(0x250));}),document[_0x47aceb(0x11e3)]('select-all-products-checkbox')[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x40abac=>{const _0x3b5ba3=_0x47aceb,_0xac1e0a=_0x40abac[_0x3b5ba3(0xd7c)][_0x3b5ba3(0x3e4)],_0x3bbb05=document['querySelectorAll'](_0x3b5ba3(0x62a));_0x3bbb05['forEach'](_0x240fa4=>{const _0x4a816d=_0x3b5ba3,_0x5655bf=parseInt(_0x240fa4['dataset']['id']);_0x240fa4[_0x4a816d(0x505)]['toggle'](_0x4a816d(0xbbc),_0xac1e0a),_0xac1e0a?_0x539314[_0x4a816d(0x252)](_0x5655bf):_0x539314[_0x4a816d(0xc0c)](_0x5655bf);}),document[_0x3b5ba3(0x11e3)](_0x3b5ba3(0xec6))['textContent']='删除\x20('+_0x539314[_0x3b5ba3(0x1159)]+')';}),document[_0x47aceb(0x11e3)]('delete-selected-products-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0x3505c1=_0x47aceb;if(_0x539314[_0x3505c1(0x1159)]===0x0){alert(_0x3505c1(0x685));return;}const _0x422f86=await _0x58fd60(_0x3505c1(0x1166),_0x3505c1(0x10b6)+_0x539314[_0x3505c1(0x1159)]+_0x3505c1(0xef),{'confirmButtonClass':'btn-danger'});_0x422f86&&(await _0x2e83f8['shoppingProducts'][_0x3505c1(0x7ac)]([..._0x539314]),document[_0x3505c1(0x11e3)](_0x3505c1(0x1304))[_0x3505c1(0x1041)](),await _0x1deb57(),await _0x2fb06('成功',_0x3505c1(0x784)));}),document['getElementById'](_0x47aceb(0x1102))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x52c7ca),document['getElementById']('save-appearance-preset-btn')[_0x47aceb(0x4b8)]('click',_0x770e48),document['getElementById'](_0x47aceb(0x6bd))[_0x47aceb(0x4b8)]('click',_0x504990),document[_0x47aceb(0x11e3)]('novelai-switch')[_0x47aceb(0x4b8)]('change',_0x5c5f76=>{const _0x2bb809=_0x47aceb,_0x3b631e=document['getElementById'](_0x2bb809(0xe46));_0x3b631e[_0x2bb809(0x794)]['display']=_0x5c5f76[_0x2bb809(0xd7c)]['checked']?_0x2bb809(0x11ac):'none';}),document[_0x47aceb(0x11e3)](_0x47aceb(0xcd9))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),function(){const _0x101aaa=_0x47aceb,_0x376fc1=document[_0x101aaa(0x11e3)](_0x101aaa(0xa09));_0x376fc1[_0x101aaa(0xa20)]===_0x101aaa(0x504)?(_0x376fc1[_0x101aaa(0xa20)]=_0x101aaa(0x1197),this[_0x101aaa(0x300)]='😌'):(_0x376fc1[_0x101aaa(0xa20)]=_0x101aaa(0x504),this[_0x101aaa(0x300)]='🧐');}),document[_0x47aceb(0x11e3)]('novelai-settings-btn')[_0x47aceb(0x4b8)]('click',()=>{const _0xdfe181=_0x47aceb;_0x6a72ee(),document[_0xdfe181(0x11e3)](_0xdfe181(0x32c))['style'][_0xdfe181(0x33d)]=_0xdfe181(0x10f4);}),document[_0x47aceb(0x11e3)](_0x47aceb(0x577))[_0x47aceb(0x4b8)](_0x47aceb(0xfeb),_0x3be71d=>{const _0x159a7c=_0x47aceb,_0x444d20=document[_0x159a7c(0x11e3)](_0x159a7c(0x8cb));_0x3be71d['target'][_0x159a7c(0xf27)]===_0x159a7c(0x3c4)?_0x444d20['style']['display']='block':_0x444d20['style'][_0x159a7c(0x33d)]=_0x159a7c(0x379);}),document[_0x47aceb(0x11e3)]('close-novelai-settings')['addEventListener']('click',()=>{const _0x169e11=_0x47aceb;document[_0x169e11(0x11e3)](_0x169e11(0x32c))[_0x169e11(0x794)]['display']=_0x169e11(0x379);}),document[_0x47aceb(0x11e3)](_0x47aceb(0xd49))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x4123e8=_0x47aceb;_0x485e25(),document[_0x4123e8(0x11e3)](_0x4123e8(0x32c))[_0x4123e8(0x794)][_0x4123e8(0x33d)]=_0x4123e8(0x379),alert(_0x4123e8(0xcbc));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x2c1))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x140a41=_0x47aceb;confirm(_0x140a41(0xb1a))&&_0x4a3276();}),document[_0x47aceb(0x11e3)](_0x47aceb(0xc07))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x6581b8=_0x47aceb,_0xcf1fc2=document['getElementById']('novelai-api-key')[_0x6581b8(0xf27)][_0x6581b8(0xeb7)]();if(!_0xcf1fc2){alert(_0x6581b8(0x114b));return;}document[_0x6581b8(0x11e3)]('novelai-test-modal')[_0x6581b8(0x794)][_0x6581b8(0x33d)]=_0x6581b8(0x10f4),document[_0x6581b8(0x11e3)](_0x6581b8(0xa21))['style'][_0x6581b8(0x33d)]=_0x6581b8(0x379),document['getElementById'](_0x6581b8(0x987))[_0x6581b8(0x794)][_0x6581b8(0x33d)]='none';}),document[_0x47aceb(0x11e3)](_0x47aceb(0x601))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x44afaa=_0x47aceb;document['getElementById']('novelai-test-modal')['style'][_0x44afaa(0x33d)]=_0x44afaa(0x379);}),document[_0x47aceb(0x11e3)](_0x47aceb(0x42d))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x4e2643=_0x47aceb;document[_0x4e2643(0x11e3)](_0x4e2643(0x10c4))[_0x4e2643(0x794)][_0x4e2643(0x33d)]=_0x4e2643(0x379);}),document[_0x47aceb(0x11e3)]('nai-generate-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{await _0xabee0c();}),document[_0x47aceb(0x11e3)]('nai-download-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x40fc55=_0x47aceb,_0x489ad5=document[_0x40fc55(0x11e3)](_0x40fc55(0x12e9)),_0x155163=document[_0x40fc55(0x383)]('a');_0x155163[_0x40fc55(0x125b)]=_0x489ad5[_0x40fc55(0xf0a)],_0x155163[_0x40fc55(0x8bd)]=_0x40fc55(0xc58)+Date[_0x40fc55(0x1182)]()+'.png',_0x155163['click']();}),document[_0x47aceb(0x11e3)]('character-nai-prompts-btn')[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x6955c4=_0x47aceb;if(!_0x5de8b7['activeChatId'])return;const _0x15527d=_0x5de8b7[_0x6955c4(0x737)][_0x5de8b7[_0x6955c4(0x93d)]],_0x505b09=_0x15527d[_0x6955c4(0x761)][_0x6955c4(0xade)]||{'promptSource':_0x6955c4(0xf72),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x6955c4(0x11e3)](_0x6955c4(0x3d2))[_0x6955c4(0xf27)]=_0x505b09[_0x6955c4(0x5da)]||'',document[_0x6955c4(0x11e3)](_0x6955c4(0x56a))[_0x6955c4(0xf27)]=_0x505b09[_0x6955c4(0xfe2)]||'',document['getElementById']('character-nai-prompts-modal')[_0x6955c4(0x794)][_0x6955c4(0x33d)]=_0x6955c4(0x10f4);}),document[_0x47aceb(0x11e3)](_0x47aceb(0x644))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x102972=_0x47aceb;document['getElementById'](_0x102972(0x676))['style'][_0x102972(0x33d)]=_0x102972(0x379);}),document[_0x47aceb(0x11e3)](_0x47aceb(0x129c))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),async()=>{const _0xb919c2=_0x47aceb;if(!_0x5de8b7[_0xb919c2(0x93d)])return;const _0xcd070=_0x5de8b7[_0xb919c2(0x737)][_0x5de8b7[_0xb919c2(0x93d)]];!_0xcd070['settings'][_0xb919c2(0xade)]&&(_0xcd070[_0xb919c2(0x761)][_0xb919c2(0xade)]={'promptSource':'system'}),_0xcd070[_0xb919c2(0x761)][_0xb919c2(0xade)][_0xb919c2(0x5da)]=document['getElementById'](_0xb919c2(0x3d2))[_0xb919c2(0xf27)][_0xb919c2(0xeb7)](),_0xcd070[_0xb919c2(0x761)][_0xb919c2(0xade)]['characterNegativePrompt']=document[_0xb919c2(0x11e3)](_0xb919c2(0x56a))['value'][_0xb919c2(0xeb7)](),console[_0xb919c2(0x84b)](_0xb919c2(0x190)),console[_0xb919c2(0x84b)]('\x20\x20\x20characterPositivePrompt:',_0xcd070[_0xb919c2(0x761)]['naiSettings']['characterPositivePrompt']),console[_0xb919c2(0x84b)](_0xb919c2(0x667),_0xcd070['settings'][_0xb919c2(0xade)][_0xb919c2(0xfe2)]),console[_0xb919c2(0x84b)]('\x20\x20\x20promptSource:',_0xcd070[_0xb919c2(0x761)][_0xb919c2(0xade)][_0xb919c2(0x7b9)]),await _0x2e83f8['chats'][_0xb919c2(0xe3c)](_0xcd070),document[_0xb919c2(0x11e3)](_0xb919c2(0x676))[_0xb919c2(0x794)][_0xb919c2(0x33d)]=_0xb919c2(0x379),alert(_0xb919c2(0xd99));}),document[_0x47aceb(0x11e3)](_0x47aceb(0x4bf))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),()=>{const _0x526441=_0x47aceb;confirm(_0x526441(0x542))&&(document[_0x526441(0x11e3)](_0x526441(0x3d2))['value']='',document[_0x526441(0x11e3)]('character-nai-negative')[_0x526441(0xf27)]='');}),document[_0x47aceb(0x11e3)](_0x47aceb(0xa80))[_0x47aceb(0x4b8)]('click',()=>{const _0x22a15d=_0x47aceb;if(!_0x5de8b7['activeChatId'])return;const _0x2cf195=_0x5de8b7['chats'][_0x5de8b7[_0x22a15d(0x93d)]],_0x45dc1e=_0x2cf195[_0x22a15d(0x761)][_0x22a15d(0xade)]||{'promptSource':_0x22a15d(0xf72),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x22a15d(0x11e3)](_0x22a15d(0x3d2))['value']=_0x45dc1e[_0x22a15d(0x5da)]||'',document[_0x22a15d(0x11e3)](_0x22a15d(0x56a))['value']=_0x45dc1e['characterNegativePrompt']||'',document['getElementById'](_0x22a15d(0x676))['style'][_0x22a15d(0x33d)]=_0x22a15d(0x10f4);}),document['getElementById'](_0x47aceb(0x3e5))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x532876),document['getElementById']('select-all-frames-checkbox')['addEventListener']('change',_0x7f74ea),document[_0x47aceb(0x11e3)](_0x47aceb(0x3fa))[_0x47aceb(0x4b8)]('click',_0x43469c),document[_0x47aceb(0x11e3)]('delete-current-category-btn')[_0x47aceb(0x4b8)]('click',_0x1ccbd3),document[_0x47aceb(0x11e3)](_0x47aceb(0x467))[_0x47aceb(0x4b8)]('click',()=>{_0x5a5fee('char-taobao-screen');}),document[_0x47aceb(0x11e3)](_0x47aceb(0xcee))[_0x47aceb(0x4b8)](_0x47aceb(0x1041),_0x27061c=>{const _0x4470b0=_0x47aceb,_0x4aab2b=_0x27061c['target'][_0x4470b0(0xfe1)](_0x4470b0(0xcb4));if(_0x4aab2b){const _0x51a4d0=_0x4aab2b[_0x4470b0(0x5ac)](_0x4470b0(0x7bd));_0x51a4d0&&_0x27061c[_0x4470b0(0xd7c)]!==_0x51a4d0&&(_0x51a4d0[_0x4470b0(0x3e4)]=!_0x51a4d0[_0x4470b0(0x3e4)]);}});const _0x31d2a5=document['getElementById'](_0x47aceb(0xe52));_0xcb6204(_0x31d2a5,_0x442ae5=>{const _0x444264=_0x47aceb,_0x3e728b=_0x442ae5[_0x444264(0xd7c)][_0x444264(0xfe1)](_0x444264(0x455));if(_0x3e728b){_0x442ae5[_0x444264(0xf87)]();const _0x157750=_0x3e728b['dataset'][_0x444264(0x9ee)];if(_0x157750===_0x444264(0xd4a)){_0x2fb06('提示',_0x444264(0x11fb));return;}const _0x497b2f=_0x157750===_0x444264(0xb81)?_0x444264(0xb81):parseInt(_0x157750);_0x447379(_0x497b2f);}}),_0x3ff8da(),_0x4e7698(_0x47aceb(0x417));}_0x170a84();});
