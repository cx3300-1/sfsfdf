const _0x2cf84d=_0x1a5b;(function(_0x2c2b2c,_0x15fa30){const _0x52bbd0=_0x1a5b,_0x31ef9e=_0x2c2b2c();while(!![]){try{const _0x219aa4=parseInt(_0x52bbd0(0x10a))/0x1+-parseInt(_0x52bbd0(0x1150))/0x2*(-parseInt(_0x52bbd0(0x2a1))/0x3)+parseInt(_0x52bbd0(0xa08))/0x4+parseInt(_0x52bbd0(0xe69))/0x5*(-parseInt(_0x52bbd0(0xe8a))/0x6)+-parseInt(_0x52bbd0(0x11fd))/0x7*(-parseInt(_0x52bbd0(0xf4f))/0x8)+-parseInt(_0x52bbd0(0xbd6))/0x9+parseInt(_0x52bbd0(0x1392))/0xa*(parseInt(_0x52bbd0(0x1236))/0xb);if(_0x219aa4===_0x15fa30)break;else _0x31ef9e['push'](_0x31ef9e['shift']());}catch(_0x308857){_0x31ef9e['push'](_0x31ef9e['shift']());}}}(_0x5f43,0x8d531));const translations={'zh-CN':{'save':'保存','cancel':'取消','confirm':'确定','edit':'编辑','done':'完成','add':'添加','back':'返回','next':'下一步','close':'关闭','reset':'重置','upload':'上传','send':'发送','manage':'管理','share':'分享','delete':'删除','publish':'发布','refresh':'刷新','search':'搜索','remove':'移除','finish':'结束','details':'详情','settings':'设置','title':'标题','content':'内容','category':'分类','name':'名称','description':'描述','status':'状态','ok':'好的','error':'错误','success':'成功','warning':'警告','loading':_0x2cf84d(0xdb1),'processing':'处理中...','pleaseWait':_0x2cf84d(0x12b9),'languageChangedAlert':_0x2cf84d(0x11cf),'homeAppQQ':'QQ','homeAppWorldBook':'世界书','homeAppAppearance':_0x2cf84d(0x34c),'homeAppRenderer':'渲染器','homeAppApiSettings':'设置','homeAppFont':'字体','homeAppCPhone':_0x2cf84d(0x65d),'homeAppDouban':'豆瓣','homeAppPreset':'预设','homeAppTutorial':'教程','homeAppWerewolf':_0x2cf84d(0x11f9),'homeAppX':'X','chatListTitle':'消息','navMessages':'消息','navQzone':'动态','navMemories':'回忆','navFavorites':'收藏','navNpcList':_0x2cf84d(0x64b),'qzoneTitle':_0x2cf84d(0xcd3),'qzoneActionShuoshuo':'说说','qzoneActionPost':'动态','qzoneActionAlbum':'相册','cphoneTitleSelect':'选择一部手机','cphoneAppQQ':'QQ','cphoneAppAlbum':'相册','cphoneAppBrowser':_0x2cf84d(0x3ce),'cphoneAppTaobao':'淘宝','cphoneAppMemo':_0x2cf84d(0x138d),'cphoneAppDiary':'日记','cphoneAppAmap':_0x2cf84d(0x525),'cphoneAppUsage':_0x2cf84d(0x11d4),'cphoneAppMusic':_0x2cf84d(0xb84),'cphoneAppEphone':_0x2cf84d(0x568),'cphoneAppFootprints':'足迹','cphoneAlbumTitle':_0x2cf84d(0xc4d),'cphoneBrowserTitle':_0x2cf84d(0xa8e),'cphoneTaobaoTitle':_0x2cf84d(0x115c),'cphoneWalletTitle':'钱包','cphoneMemoTitle':_0x2cf84d(0x138d),'cphoneDiaryTitle':'日记','cphoneUsageTitle':_0x2cf84d(0x120e),'cphoneMusicTitle':_0x2cf84d(0x2e4),'cphoneArticleTitle':'文章','cphoneSimulatedChatPlaceholder':_0x2cf84d(0xf76),'worldBookTitle':_0x2cf84d(0x5eb),'worldBookEditorTitle':'编辑世界书','worldBookEntryEditorTitle':_0x2cf84d(0x23d),'worldBookNameLabel':'书名','worldBookCategoryLabel':'分类','worldBookEntriesLabel':'内容条目','worldBookAddEntryBtn':_0x2cf84d(0xae5),'worldBookNamePlaceholder':_0x2cf84d(0xb95),'worldBookImportTitle':'导入世界书','presetTitle':'预设','presetEditorTitle':_0x2cf84d(0x4fc),'presetNameLabel':_0x2cf84d(0xc27),'presetCategoryLabel':'分类','presetEntriesLabel':'内容条目','presetAddEntryBtn':'[+]\x20添加新条目','tutorialTitle':'教程','apiSettingsTitle':_0x2cf84d(0x12de),'languageLabel':'语言','apiPresetManagement':_0x2cf84d(0xd94),'apiPresetSelectLabel':'选择或切换预设','apiPrimarySettings':'主API设置\x20(用于聊天)','apiProxyUrlLabel':_0x2cf84d(0xaae),'apiKeyLabel':'密钥\x20(API\x20Key)','apiModelLabel':'模型','apiFetchModelsBtn':_0x2cf84d(0x1e8),'apiSecondarySettings':_0x2cf84d(0xa1f),'apiSecondaryProxyUrlLabel':'副反代地址','apiSecondaryKeyLabel':'副密钥','apiSecondaryModelLabel':_0x2cf84d(0x543),'apiFetchSecondaryModelsBtn':_0x2cf84d(0x6ab),'apiBgActivitySettings':_0x2cf84d(0xca5),'apiEnableBgActivityLabel':_0x2cf84d(0xc6e),'apiBgIntervalLabel':_0x2cf84d(0xe1f),'apiBlockCooldownLabel':_0x2cf84d(0xb02),'apiTtsSettings':_0x2cf84d(0x187),'apiTtsModelLabel':_0x2cf84d(0xc68),'apiPerformanceSettings':_0x2cf84d(0x933),'apiChatListRenderWindowLabel':_0x2cf84d(0x127e),'apiChatRenderWindowLabel':'聊天界面初始加载条数','apiImageGenSettings':_0x2cf84d(0x3d7),'apiEnableImageGenLabel':_0x2cf84d(0x7ab),'apiEnableNovelAILabel':_0x2cf84d(0x94e),'apiNovelAIModelLabel':_0x2cf84d(0x11f4),'apiNovelAIKeyLabel':_0x2cf84d(0x2c8),'apiNovelAIGenSettingsBtn':_0x2cf84d(0x10bb),'apiNovelAITestBtn':_0x2cf84d(0x131e),'apiStorageOptimization':_0x2cf84d(0x428),'apiCompressImagesBtn':_0x2cf84d(0x1057),'apiSaveAllBtn':'保存所有设置','apiExportDataBtn':_0x2cf84d(0x1265),'apiImportDataBtn':_0x2cf84d(0x984),'apiCleanupDataBtn':_0x2cf84d(0x402),'apiDeleteWorldBooksBtn':_0x2cf84d(0x1304),'apiAdvancedCleanupBtn':_0x2cf84d(0xb25),'apiCheckAndFixDataBtn':_0x2cf84d(0x7e8),'chatHeaderOnline':'在线','chatHeaderLongTermMemory':_0x2cf84d(0x77e),'chatHeaderListenTogether':_0x2cf84d(0xfd0),'chatHeaderChatSettings':_0x2cf84d(0x3ff),'chatSelectionCancel':'取消','chatSelectionScreenshot':_0x2cf84d(0x8d8),'chatSelectionFavorite':'收藏','chatSelectionShare':'分享','chatSelectionSoftDelete':_0x2cf84d(0xaab),'chatSelectionHardDelete':_0x2cf84d(0x248),'chatReplyTo':'回复','chatInputPlaceholder':_0x2cf84d(0x1f1),'chatWaitForReply':'等待回复','appearanceTitle':'外观设置','appearanceSaveAll':_0x2cf84d(0x121e),'fontSettingsTitle':_0x2cf84d(0x362),'fontPresetManagement':_0x2cf84d(0xccf),'fontFileUrlLabel':_0x2cf84d(0x58d),'fontPreviewLabel':_0x2cf84d(0x1457),'fontPreviewText1':_0x2cf84d(0x249),'fontPreviewText2':_0x2cf84d(0x1357),'fontSaveAndApply':'保存并应用','fontResetDefault':_0x2cf84d(0x5fb),'rendererTitle':_0x2cf84d(0x746),'rendererEditorTitle':'编辑规则','rendererCreateTitle':_0x2cf84d(0x37e),'rendererRuleName':'规则名称','rendererBindScope':_0x2cf84d(0x1228),'rendererScopeGlobal':_0x2cf84d(0x1233),'rendererRegex':_0x2cf84d(0x6e1),'rendererHtmlTemplate':'HTML\x20模板\x20(用\x20$1,\x20$2\x20引用)','rendererEnableRule':'启用规则','myAlbumTitle':_0x2cf84d(0x437),'albumPhotosTitle':'相册名称','npcEditorTitleAdd':'添加\x20NPC','npcEditorTitleEdit':_0x2cf84d(0x3ba),'npcAvatarLabel':_0x2cf84d(0x92c),'npcUploadAvatar':_0x2cf84d(0x760),'npcNicknameLabel':_0x2cf84d(0x1232),'npcPersonaLabel':'NPC\x20人设','npcEnableBgActivity':_0x2cf84d(0x598),'npcActionCooldown':_0x2cf84d(0xb4e),'npcAssociatedChars':_0x2cf84d(0xf9b)},'en':{'save':_0x2cf84d(0x9cc),'cancel':_0x2cf84d(0x50f),'confirm':_0x2cf84d(0x17e),'edit':_0x2cf84d(0x7a4),'done':_0x2cf84d(0x145c),'add':_0x2cf84d(0x133c),'back':_0x2cf84d(0x370),'next':_0x2cf84d(0x83d),'close':'Close','reset':_0x2cf84d(0x851),'upload':_0x2cf84d(0x10fe),'send':_0x2cf84d(0x8da),'manage':_0x2cf84d(0x9af),'share':'Share','delete':_0x2cf84d(0x4c4),'publish':_0x2cf84d(0xcc5),'refresh':_0x2cf84d(0x541),'search':_0x2cf84d(0x8f0),'remove':_0x2cf84d(0x115a),'finish':_0x2cf84d(0x6ce),'details':_0x2cf84d(0x78b),'settings':_0x2cf84d(0x6cd),'title':_0x2cf84d(0x5d9),'content':_0x2cf84d(0x34d),'category':'Category','name':'Name','description':'Description','status':'Status','ok':'OK','error':_0x2cf84d(0x8a3),'success':_0x2cf84d(0x425),'warning':_0x2cf84d(0x478),'loading':_0x2cf84d(0x208),'processing':_0x2cf84d(0x77),'pleaseWait':_0x2cf84d(0x834),'languageChangedAlert':_0x2cf84d(0x406),'homeAppQQ':'QQ','homeAppWorldBook':_0x2cf84d(0x98e),'homeAppAppearance':_0x2cf84d(0xf96),'homeAppRenderer':_0x2cf84d(0x1217),'homeAppApiSettings':'Settings','homeAppFont':_0x2cf84d(0x22f),'homeAppCPhone':_0x2cf84d(0x65d),'homeAppDouban':_0x2cf84d(0x13d3),'homeAppPreset':_0x2cf84d(0x873),'homeAppTutorial':'Tutorial','homeAppWerewolf':_0x2cf84d(0x483),'homeAppX':'X','chatListTitle':_0x2cf84d(0x80b),'navMessages':_0x2cf84d(0x80b),'navQzone':_0x2cf84d(0xb63),'navMemories':'Memories','navFavorites':_0x2cf84d(0x12e9),'navNpcList':_0x2cf84d(0x6e7),'qzoneTitle':'Moments','qzoneActionShuoshuo':_0x2cf84d(0xab),'qzoneActionPost':_0x2cf84d(0xf14),'qzoneActionAlbum':'Album','cphoneTitleSelect':'Select\x20a\x20Phone','cphoneAppQQ':'QQ','cphoneAppAlbum':'Album','cphoneAppBrowser':_0x2cf84d(0x90c),'cphoneAppTaobao':_0x2cf84d(0xec9),'cphoneAppMemo':'Memo','cphoneAppDiary':_0x2cf84d(0xca),'cphoneAppAmap':'Amap','cphoneAppUsage':_0x2cf84d(0x12e3),'cphoneAppMusic':_0x2cf84d(0x3f5),'cphoneAppEphone':_0x2cf84d(0x568),'cphoneAppFootprints':'Footprints','cphoneAlbumTitle':_0x2cf84d(0x102e),'cphoneBrowserTitle':_0x2cf84d(0x1017),'cphoneTaobaoTitle':'Their\x20Taobao\x20Orders','cphoneWalletTitle':_0x2cf84d(0x96),'cphoneMemoTitle':'Memo','cphoneDiaryTitle':_0x2cf84d(0xca),'cphoneUsageTitle':_0x2cf84d(0xf30),'cphoneMusicTitle':_0x2cf84d(0xa02),'cphoneArticleTitle':'Article','cphoneSimulatedChatPlaceholder':_0x2cf84d(0xcad),'worldBookTitle':_0x2cf84d(0x98e),'worldBookEditorTitle':'Edit\x20World\x20Book','worldBookEntryEditorTitle':_0x2cf84d(0xfb7),'worldBookNameLabel':_0x2cf84d(0x1412),'worldBookCategoryLabel':_0x2cf84d(0x957),'worldBookEntriesLabel':_0x2cf84d(0x11e3),'worldBookAddEntryBtn':'[+]\x20Add\x20New\x20Entry','worldBookNamePlaceholder':_0x2cf84d(0x262),'worldBookImportTitle':_0x2cf84d(0xdee),'presetTitle':_0x2cf84d(0x873),'presetEditorTitle':_0x2cf84d(0xfaf),'presetNameLabel':_0x2cf84d(0x779),'presetCategoryLabel':_0x2cf84d(0x957),'presetEntriesLabel':_0x2cf84d(0x11e3),'presetAddEntryBtn':_0x2cf84d(0xb22),'tutorialTitle':_0x2cf84d(0xd49),'apiSettingsTitle':'API\x20Settings','languageLabel':_0x2cf84d(0x3a2),'apiPresetManagement':_0x2cf84d(0x572),'apiPresetSelectLabel':_0x2cf84d(0x153),'apiPrimarySettings':_0x2cf84d(0x138c),'apiProxyUrlLabel':'Proxy\x20URL\x20(No\x20/v1\x20needed~)','apiKeyLabel':'API\x20Key','apiModelLabel':_0x2cf84d(0xd4e),'apiFetchModelsBtn':_0x2cf84d(0xad9),'apiSecondarySettings':_0x2cf84d(0x331),'apiSecondaryProxyUrlLabel':_0x2cf84d(0x278),'apiSecondaryKeyLabel':_0x2cf84d(0x808),'apiSecondaryModelLabel':'Secondary\x20Model','apiFetchSecondaryModelsBtn':_0x2cf84d(0x196),'apiTemperatureLabel':_0x2cf84d(0x8c),'apiBgActivitySettings':'Background\x20Activity\x20Settings','apiEnableBgActivityLabel':'Enable\x20Background\x20Character\x20Activity','apiBgIntervalLabel':_0x2cf84d(0x3ab),'apiBlockCooldownLabel':_0x2cf84d(0x699),'apiTtsSettings':_0x2cf84d(0xd33),'apiTtsModelLabel':'Voice\x20Model','apiPerformanceSettings':_0x2cf84d(0x426),'apiChatListRenderWindowLabel':_0x2cf84d(0xd82),'apiChatRenderWindowLabel':_0x2cf84d(0xd89),'apiImageGenSettings':_0x2cf84d(0xc56),'apiEnableImageGenLabel':_0x2cf84d(0x80),'apiEnableNovelAILabel':_0x2cf84d(0x1324),'apiNovelAIModelLabel':_0x2cf84d(0xae8),'apiNovelAIKeyLabel':'NovelAI\x20API\x20Key','apiNovelAIGenSettingsBtn':'Generation\x20Settings','apiNovelAITestBtn':_0x2cf84d(0x13fd),'apiStorageOptimization':_0x2cf84d(0xd66),'apiCompressImagesBtn':'Compress\x20Local\x20Images','apiSaveAllBtn':_0x2cf84d(0xda8),'apiExportDataBtn':_0x2cf84d(0x71a),'apiImportDataBtn':_0x2cf84d(0x737),'apiCleanupDataBtn':_0x2cf84d(0xc26),'apiDeleteWorldBooksBtn':_0x2cf84d(0x1445),'apiAdvancedCleanupBtn':_0x2cf84d(0xc8e),'apiCheckAndFixDataBtn':_0x2cf84d(0xe7a),'chatHeaderOnline':_0x2cf84d(0x99a),'chatHeaderLongTermMemory':_0x2cf84d(0xe82),'chatHeaderListenTogether':_0x2cf84d(0xd6e),'chatHeaderChatSettings':_0x2cf84d(0xcbf),'chatSelectionCancel':_0x2cf84d(0x50f),'chatSelectionScreenshot':_0x2cf84d(0x39b),'chatSelectionFavorite':_0x2cf84d(0xad5),'chatSelectionShare':'Share','chatSelectionSoftDelete':_0x2cf84d(0x1151),'chatSelectionHardDelete':_0x2cf84d(0x148),'chatReplyTo':_0x2cf84d(0x72e),'chatInputPlaceholder':_0x2cf84d(0x10af),'chatWaitForReply':'Wait\x20for\x20Reply','appearanceTitle':_0x2cf84d(0x112c),'appearanceSaveAll':'Save\x20All\x20Appearance\x20Settings','fontSettingsTitle':_0x2cf84d(0xbc6),'fontPresetManagement':_0x2cf84d(0xa5),'fontFileUrlLabel':_0x2cf84d(0x6c9),'fontPreviewLabel':_0x2cf84d(0xa00),'fontPreviewText1':_0x2cf84d(0x11b),'fontPreviewText2':_0x2cf84d(0x8b3),'fontSaveAndApply':_0x2cf84d(0x4bf),'fontResetDefault':_0x2cf84d(0x5ea),'rendererTitle':_0x2cf84d(0x134c),'rendererEditorTitle':_0x2cf84d(0x557),'rendererCreateTitle':'Create\x20New\x20Rule','rendererRuleName':_0x2cf84d(0xa27),'rendererBindScope':_0x2cf84d(0xd01),'rendererScopeGlobal':_0x2cf84d(0x516),'rendererRegex':_0x2cf84d(0x97),'rendererHtmlTemplate':'HTML\x20Template\x20(use\x20$1,\x20$2)','rendererEnableRule':_0x2cf84d(0x1179),'myAlbumTitle':_0x2cf84d(0x903),'albumPhotosTitle':'Album\x20Name','npcEditorTitleAdd':'Add\x20NPC','npcEditorTitleEdit':_0x2cf84d(0x13da),'npcAvatarLabel':_0x2cf84d(0xe89),'npcUploadAvatar':_0x2cf84d(0x995),'npcNicknameLabel':_0x2cf84d(0x7b9),'npcPersonaLabel':_0x2cf84d(0x13e1),'npcEnableBgActivity':'Enable\x20Independent\x20Background\x20Activity','npcActionCooldown':_0x2cf84d(0x6e0),'npcAssociatedChars':'Associated\x20Characters\x20(NPC\x20will\x20comment\x20on\x20their\x20moments)'}};let currentLanguage=_0x2cf84d(0xaa2);function setLanguage(_0x3ab406){const _0x403b5a=_0x2cf84d;!translations[_0x3ab406]&&(console[_0x403b5a(0x1b6)](_0x403b5a(0x14a)+_0x3ab406+_0x403b5a(0x78f)),_0x3ab406=_0x403b5a(0xaa2)),currentLanguage=_0x3ab406,localStorage[_0x403b5a(0xc93)](_0x403b5a(0x1465),_0x3ab406),document['documentElement'][_0x403b5a(0x1207)]=_0x3ab406,document[_0x403b5a(0x102a)]('[data-lang-key]')[_0x403b5a(0x12c2)](_0x52aab6=>{const _0x940df9=_0x403b5a,_0x3e8087=_0x52aab6[_0x940df9(0x11ce)](_0x940df9(0xe5a));translations[_0x3ab406][_0x3e8087]&&(_0x52aab6[_0x940df9(0x1a2)]=translations[_0x3ab406][_0x3e8087]);}),document[_0x403b5a(0x102a)](_0x403b5a(0xea))[_0x403b5a(0x12c2)](_0x4449f6=>{const _0xf49ea7=_0x403b5a,_0x5a7930=_0x4449f6['getAttribute'](_0xf49ea7(0x1fd));translations[_0x3ab406][_0x5a7930]&&(_0x4449f6[_0xf49ea7(0x134b)]=translations[_0x3ab406][_0x5a7930]);}),document['querySelectorAll'](_0x403b5a(0x164))[_0x403b5a(0x12c2)](_0x77bb98=>{const _0x11c21f=_0x403b5a,_0x5d305e=_0x77bb98['getAttribute'](_0x11c21f(0x6d5));translations[_0x3ab406][_0x5d305e]&&(_0x77bb98[_0x11c21f(0x316)]=translations[_0x3ab406][_0x5d305e]);});}function initLanguage(){const _0x3c1ee7=_0x2cf84d,_0x486c74=localStorage[_0x3c1ee7(0x127d)](_0x3c1ee7(0x1465))||_0x3c1ee7(0xaa2),_0x33b1a6=document[_0x3c1ee7(0x458)](_0x3c1ee7(0x11ef));_0x33b1a6&&(_0x33b1a6[_0x3c1ee7(0x8dd)]=_0x486c74,_0x33b1a6[_0x3c1ee7(0xd85)]('change',_0x34cef3=>{const _0xec56ca=_0x3c1ee7,_0x7944dc=_0x34cef3[_0xec56ca(0x12df)][_0xec56ca(0x8dd)];alert(translations[_0x7944dc][_0xec56ca(0x63f)]),localStorage['setItem'](_0xec56ca(0x1465),_0x7944dc),setTimeout(()=>window[_0xec56ca(0x299)]['reload'](),0x64);})),setLanguage(_0x486c74);}(function(){'use strict';const _0x3c6fdf=_0x2cf84d;function _0x5f41ea(_0xcc852f,_0x248c15){const _0x281a16=_0x1a5b;try{const _0x160f49=document[_0x281a16(0xe7d)]('a');_0x160f49[_0x281a16(0x1173)]=_0xcc852f,_0x160f49['download']=_0x248c15,_0x160f49[_0x281a16(0x1104)][_0x281a16(0x4db)]='none',document[_0x281a16(0x5b4)][_0x281a16(0x1079)](_0x160f49),_0x160f49['click'](),setTimeout(()=>{const _0x31e533=_0x281a16;document['body'][_0x31e533(0x626)](_0x160f49);},0x64),console[_0x281a16(0x7d1)]('✅\x20[NAI下载]\x20开始下载图片:',_0x248c15),_0x3d5651();}catch(_0x47d30e){console[_0x281a16(0xb61)](_0x281a16(0x10aa),_0x47d30e),_0x3d5651('下载失败，请重试',_0x281a16(0xb61));}}function _0x3d5651(_0x4ae306=_0x3c6fdf(0xfb8),_0x5410a2=_0x3c6fdf(0x5d5)){const _0x1d283f=_0x3c6fdf,_0x20769c=document[_0x1d283f(0xe7d)](_0x1d283f(0x1323));_0x20769c['textContent']=_0x4ae306,_0x20769c[_0x1d283f(0x1104)]['cssText']=_0x1d283f(0x739)+(_0x5410a2===_0x1d283f(0x5d5)?_0x1d283f(0x451):_0x1d283f(0x11c6))+_0x1d283f(0x7f0),document[_0x1d283f(0x5b4)]['appendChild'](_0x20769c),setTimeout(()=>{const _0x5b46af=_0x1d283f;_0x20769c['style'][_0x5b46af(0x539)]='1',_0x20769c[_0x5b46af(0x1104)][_0x5b46af(0xb7e)]='translateY(0)';},0xa),setTimeout(()=>{const _0x38fcda=_0x1d283f;_0x20769c['style'][_0x38fcda(0x539)]='0',_0x20769c[_0x38fcda(0x1104)][_0x38fcda(0xb7e)]=_0x38fcda(0x1087),setTimeout(()=>{_0x20769c['remove']();},0x12c);},0x7d0);}function _0x284dcb(_0x29bf9d){const _0x5e7e7d=_0x3c6fdf,_0x359e97=_0x29bf9d['getAttribute'](_0x5e7e7d(0x316))||_0x29bf9d[_0x5e7e7d(0x11ce)](_0x5e7e7d(0x647))||'';let _0x10da10=_0x359e97[_0x5e7e7d(0x33b)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')[_0x5e7e7d(0x33b)](/\s+/g,'_')[_0x5e7e7d(0xa6d)](0x0,0x1e);!_0x10da10&&(_0x10da10=_0x5e7e7d(0x1140));const _0x1bec14=new Date()[_0x5e7e7d(0xf63)]()[_0x5e7e7d(0x33b)](/[-:]/g,'')[_0x5e7e7d(0x33b)]('T','_')[_0x5e7e7d(0x90b)]('.')[0x0];return _0x10da10+'_'+_0x1bec14+_0x5e7e7d(0x1224);}function _0xc7426d(_0x2c7254){const _0x5d4a6b=_0x3c6fdf,_0x26270c=_0x2c7254[_0x5d4a6b(0x1104)]['transform']||'',_0x2094b6=_0x2c7254[_0x5d4a6b(0x1104)][_0x5d4a6b(0x41b)]||'';_0x2c7254[_0x5d4a6b(0x1104)]['transition']='transform\x200.15s\x20ease',_0x2c7254[_0x5d4a6b(0x1104)][_0x5d4a6b(0xb7e)]=_0x5d4a6b(0x19d),setTimeout(()=>{const _0x2b3fd8=_0x5d4a6b;_0x2c7254['style'][_0x2b3fd8(0xb7e)]=_0x26270c,setTimeout(()=>{const _0xa56f1f=_0x2b3fd8;_0x2c7254[_0xa56f1f(0x1104)][_0xa56f1f(0x41b)]=_0x2094b6;},0x96);},0x96);}let _0x49cddd=0x0,_0x33ca24=null,_0x3c9c56=null;document['addEventListener'](_0x3c6fdf(0x1122),function(_0x1b7d3d){const _0x20fa72=_0x3c6fdf,_0xf22943=_0x1b7d3d[_0x20fa72(0x12df)];if(_0xf22943[_0x20fa72(0xf13)]===_0x20fa72(0x1071)&&(_0xf22943[_0x20fa72(0x11c2)][_0x20fa72(0x526)]('realimag-image')||_0xf22943[_0x20fa72(0x11c2)][_0x20fa72(0x526)]('naiimag-image'))){_0xf22943===_0x3c9c56?_0x49cddd++:(_0x49cddd=0x1,_0x3c9c56=_0xf22943);_0x33ca24&&clearTimeout(_0x33ca24);if(_0x49cddd===0x3){_0x49cddd=0x0,_0x3c9c56=null,_0x1b7d3d[_0x20fa72(0xae3)](),_0x1b7d3d['stopPropagation'](),console[_0x20fa72(0x7d1)](_0x20fa72(0xf88)),_0xc7426d(_0xf22943);const _0x2adb0d=_0xf22943['src'];if(!_0x2adb0d||_0x2adb0d===_0x20fa72(0x1451)){console[_0x20fa72(0x1b6)](_0x20fa72(0xd71)),_0x3d5651(_0x20fa72(0xc58),_0x20fa72(0xb61));return;}const _0x4c4c92=_0x284dcb(_0xf22943);_0x5f41ea(_0x2adb0d,_0x4c4c92);}else _0x33ca24=setTimeout(()=>{_0x49cddd=0x0,_0x3c9c56=null;},0x1f4);}},!![]),console[_0x3c6fdf(0x7d1)](_0x3c6fdf(0xb51)),console[_0x3c6fdf(0x7d1)]('💡\x20[NAI下载]\x20提示：三击任意NAI图片即可下载');}());'serviceWorker'in navigator&&window[_0x2cf84d(0xd85)](_0x2cf84d(0x68d),()=>{const _0x231f5e=_0x2cf84d;navigator['serviceWorker'][_0x231f5e(0xa2a)](_0x231f5e(0x427))[_0x231f5e(0x1260)](_0x5eb806=>{const _0x451472=_0x231f5e;console[_0x451472(0x7d1)]('ServiceWorker\x20注册成功，作用域为:\x20',_0x5eb806[_0x451472(0xb73)]);})[_0x231f5e(0x1135)](_0x16fad5=>{const _0x18554b=_0x231f5e;console[_0x18554b(0x7d1)]('ServiceWorker\x20注册失败:\x20',_0x16fad5);});});!Array[_0x2cf84d(0x11a6)][_0x2cf84d(0xc81)]&&Object[_0x2cf84d(0x38a)](Array[_0x2cf84d(0x11a6)],_0x2cf84d(0xc81),{'value':function(_0x4aaf39){const _0x38b998=_0x2cf84d;if(this==null)throw new TypeError(_0x38b998(0x126a));if(typeof _0x4aaf39!==_0x38b998(0xa7))throw new TypeError('predicate\x20must\x20be\x20a\x20function');let _0x3289fa=Object(this),_0x2ed89c=_0x3289fa[_0x38b998(0x131d)]>>>0x0,_0x149bf4=arguments[0x1],_0x54db8e=_0x2ed89c-0x1;while(_0x54db8e>=0x0){let _0x4a1e85=_0x3289fa[_0x54db8e];if(_0x4aaf39[_0x38b998(0x1390)](_0x149bf4,_0x4a1e85,_0x54db8e,_0x3289fa))return _0x54db8e;_0x54db8e--;}return-0x1;},'configurable':!![],'writable':!![]});let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],currentQzoneReplyContext=null,editingNpcId=null,pendingBackupData=null;const GEMINI_API_URL='https://generativelanguage.googleapis.com/v1beta/models';function getRandomValue(_0x15cfff){const _0x2b6b46=_0x2cf84d;if(_0x15cfff['includes'](',')){const _0x3389ce=_0x15cfff['split'](',')[_0x2b6b46(0xbf6)](_0x5a581f=>_0x5a581f[_0x2b6b46(0x2aa)]()),_0x331817=Math[_0x2b6b46(0xbd5)](Math[_0x2b6b46(0x23a)]()*_0x3389ce[_0x2b6b46(0x131d)]);return _0x3389ce[_0x331817];}return _0x15cfff;}function _0x1a5b(_0x35f34a,_0x6a7fe4){const _0x5f432d=_0x5f43();return _0x1a5b=function(_0x1a5b8d,_0x44c60b){_0x1a5b8d=_0x1a5b8d-0x6a;let _0xc7a2b9=_0x5f432d[_0x1a5b8d];return _0xc7a2b9;},_0x1a5b(_0x35f34a,_0x6a7fe4);}function isImage(_0x128b5e){const _0xab33c6=_0x2cf84d;if(_0x128b5e[_0xab33c6(0x1072)]&&_0x128b5e[_0xab33c6(0x1072)][_0xab33c6(0x1377)]){let _0x19d891=_0x128b5e['image_url'][_0xab33c6(0x1377)];const _0x5c0018=_0x19d891[_0xab33c6(0x90b)](',')[0x1],_0x2a4f52=_0x19d891[_0xab33c6(0x41c)](/^data:(.*);base64/)[0x1];return[{'text':_0xab33c6(0xb66)},{'inline_data':{'mime_type':_0x2a4f52,'data':_0x5c0018}}];}return[];}function getGeminiResponseText(_0x42c146){const _0x52c938=_0x2cf84d;if(_0x42c146[_0x52c938(0x2f9)]&&Array[_0x52c938(0x971)](_0x42c146[_0x52c938(0x2f9)])&&_0x42c146['choices']['length']>0x0&&_0x42c146[_0x52c938(0x2f9)][0x0][_0x52c938(0x7aa)]&&_0x42c146[_0x52c938(0x2f9)][0x0]['message'][_0x52c938(0x1316)])return _0x42c146[_0x52c938(0x2f9)][0x0][_0x52c938(0x7aa)][_0x52c938(0x1316)];if(_0x42c146[_0x52c938(0x116f)]&&Array[_0x52c938(0x971)](_0x42c146['candidates'])&&_0x42c146['candidates'][_0x52c938(0x131d)]>0x0&&_0x42c146['candidates'][0x0]['content']&&_0x42c146[_0x52c938(0x116f)][0x0][_0x52c938(0x1316)][_0x52c938(0xc00)])return _0x42c146[_0x52c938(0x116f)][0x0][_0x52c938(0x1316)][_0x52c938(0xc00)][0x0]['text'];console[_0x52c938(0xb61)]('Gemini\x20API返回了非预期的格式:',_0x42c146);let _0x445492=_0x52c938(0x1074);if(_0x42c146[_0x52c938(0x116f)]&&Array[_0x52c938(0x971)](_0x42c146[_0x52c938(0x116f)])&&_0x42c146[_0x52c938(0x116f)][_0x52c938(0x131d)]>0x0&&_0x42c146['candidates'][0x0][_0x52c938(0x12a)]===_0x52c938(0xef1)){const _0x56b837=_0x42c146[_0x52c938(0x116f)][0x0][_0x52c938(0x1153)],_0x4fc9cd=_0x56b837[_0x52c938(0xaf1)](_0x55f7f4=>_0x55f7f4[_0x52c938(0x7ca)]!==_0x52c938(0xa1b)&&_0x55f7f4[_0x52c938(0x7ca)]!==_0x52c938(0x1119))[_0x52c938(0xbf6)](_0x10e05a=>_0x10e05a[_0x52c938(0xc4f)]+_0x52c938(0x10cb)+_0x10e05a[_0x52c938(0x7ca)]+')')['join'](',\x20');_0x445492=_0x52c938(0x727)+(_0x4fc9cd||'未知');}else{if(_0x42c146[_0x52c938(0xd77)]?.[_0x52c938(0x1306)]){const _0x33c202=_0x42c146[_0x52c938(0xd77)][_0x52c938(0x1306)],_0x5524cb=_0x42c146['promptFeedback'][_0x52c938(0x1153)]?.[_0x52c938(0xbf6)](_0x362369=>_0x362369[_0x52c938(0xc4f)]+':\x20'+_0x362369['probability'])[_0x52c938(0x56c)](',\x20');_0x445492=_0x52c938(0x88d)+_0x33c202+_0x52c938(0x1267)+(_0x5524cb||'无');}else _0x42c146[_0x52c938(0xb61)]&&(_0x445492=_0x52c938(0x87f)+_0x42c146[_0x52c938(0xb61)][_0x52c938(0x7aa)]);}throw new Error(_0x445492);}function _0x5f43(){const _0x49a356=['选择记忆所属角色','核心库\x20(JSZip\x20或\x20StreamSaver)\x20未能成功加载，请检查您的网络连接并刷新页面后重试。','<button\x20class=\x22delete-btn\x22\x20data-id=\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','诊断：在\x20data.character_book\x20中找到世界书。','where','”的身份，开始你的客观总结。','gap','char-memo-detail-screen','group-video-call-btn','99+','anno_','add-char-memo-btn','「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)','离线预设','clipboard','char-music-current-time','50%','Douban','cart-back-btn','quality_toggle','search-history-screen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20','werewolf-lobby-modal','AI幻觉已被拦截！试图使用群名\x20(\x22','Edit\x20NPC','”。请自然地接受这个新名字，不要对此感到惊讶。]','https://i.postimg.cc/PxZrFFFL/o-o-1.jpg','chat-list-actions-modal','已经一起听了','time-zone-search-input','\x0a#\x20你的任务\x0a你是一个狼人杀游戏模拟器\x20(Game\x20Simulator)。你的任务是【并行模拟】','NPC\x20Persona','prepend','这是群里的第一条消息。','\x22\x20的独立行动失败:','auto-memory-interval','increase-qty-btn','”申请好友时发生错误：\x0a\x0a','检测到刚结束的通话，正在注入通话记录上下文...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥','alternateGreetings','https://api.vkeys.cn/v2/music/tencent?word=','生成第','background','global-bg-input','状态已更新','检查更新时出错:','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20','已选\x20','[群聊]','reject','已成功注入“切换到线上模式”的系统指令。','请根据以上设定，生成商品数据。','max-memory','无法访问剪贴板。','announcement-item-actions','waimai-product-info','\x22:\x20\x22你此时的详细内心活动...\x22}}`**\x0a\x20\x20\x20\x20-\x20\x20\x20**analysis**:\x20简要分析用户的意图或聊天的氛围。\x0a\x20\x20\x20\x20-\x20\x20\x20**strategy**:\x20你的计划（例如：安抚用户、转移话题、发起一个功能）。\x0a\x20\x20\x20\x20-\x20\x20\x20**character_thoughts**:\x20必须包含一个以你本名\x20(\x22','[系统提示：你\x20','Test\x20Generation','”的当前状态已更新为：','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>','）刚刚撤回了一条消息。撤回前的内容是：','\x20条红包记录。','dblclick','正在解压图片...','chat-input-area','✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)','pat-animation','\x0a---\x0a###\x20帖子ID:\x20','未知用户','.unread-indicator','\x20位AI角色的长期记忆中！','stickerCategories','gomoku-btn','[图片:\x20','.chat-group-content:last-of-type','来自“','检测到新版流式备份文件...','++id,\x20albumId','Book\x20Name','\x20的新头像同步到群聊\x20\x22','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','manage-world-book-categories-btn','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“','data-clear-type-list','has-frame','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>','frameUrl','\x20张图片...','开始检查','sticker-grid','gift-receipt-modal','password','cancel-contact-picker-btn','receiverName','https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','toLocaleDateString','world-book-entries-container','.message-editor-block','所有数据已成功恢复！应用即将刷新以应用所有更改。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','favorites-delete-selected-btn','未知成员','已成功删除\x20','正则表达式格式错误:\x20','确认精炼','tlyric','sender-name','shopping-screen','\x20首歌曲获取失败:\x0a-\x20','rules-tab\x20active','reading-title','Response\x20headers:','round','已阵亡，还有30秒爆炸','正在为后台活动发送API请求\x20(\x22','groupId','call-record-card','，我们一起见证了这个约定。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>','flex-start','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请输入有效的金额(必须大于0)！','data:\x20','\x0a**内容:**\x0a','https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','main','选中的收藏已被移除。','import_card','Delete\x20World\x20Books','\x0a\x0a现在，请继续这场对话。\x0a','\x20觉得很赞</span></div>','linkedMemoryChatIds','https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x0a其专属的“世界书”也已自动创建并关联。','utf-8','lineWidth','npc-avatar-preview','reduce','about:blank','聊天记录分享卡片数据损坏:','旁观模式推进剧情失败:','对方本名不能为空！','save-appearance-preset-btn','获取AI投票决策失败:\x20','实时预览','已成功批量导入\x20','API请求失败:\x20','ZIP\x20Blob\x20大小:','送给大家的礼物','Done','\x0a\x0a#\x20当前情景\x0a','offsetWidth','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','保存主题预设','visibilityState','\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。','assign-group-section','ephone','ephone-language','confirm-variation-selection-btn','paid','link-memory-toggle','nai-smea','https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','.modal-header\x20span','injectLatestThought','导出单个聊天时出错:','照片描述',')\x20拒绝了\x20','delete-world-books-btn','{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}','NPC的昵称和人设都不能为空！','直接使用\x20base64\x20数据','novelai-settings-btn','群里在','导入单个聊天时出错:','<div\x20class=\x22post-content\x22>','操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20','Processing...','主题预设已保存！','该预设包含\x20','products','generativelanguage.googleapis.com','location_share','world-book-screen','\x0a-\x20**人设**:\x20','characterPositivePrompt','Enable\x20AI\x20Image\x20Generation','status-bar-battery','这条动态的原始数据已被彻底清除。','”下，回复了\x27','\x20死亡了。','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','lastIndex','正在请求AI进行记忆精炼...','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','random_jottings','选中的商品已成功删除。','API\x20Temperature','.char-product-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22','API错误响应:','https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png','.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a','votes','使用\x20browser-image-compression\x20压缩失败:','https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','Wallet','Regular\x20Expression\x20(use\x20g\x20flag)','handleListenTogetherClick','\x0a##\x20阶段2：生成最终对话\x20(Final\x20JSON\x20Output)\x0a你现在已经为【所有AI角色】都完成了“TGS三核”独立思考。\x0a请根据你在“阶段C：最终发言稿”中为每个角色准备好的草稿，生成最终的、符合格式的JSON数组。\x0a','msgTimestamp','...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】(','\x20条长期记忆发送给AI，总结成大约\x20','成功打包\x20','at-mention-item','world-book-category-manager-modal','status-bar-visible','originalName','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>','date-search-input','offsetLeft','Font\x20Preset\x20Management','myAvatar','function','\x22\x20class=\x22chat-image\x22></div>','\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【','用户\x27','Status','无法找到或消息类型不匹配的分享链接:','world-book-category-pane','accepted','browser-content','天黑请闭眼...','操作已取消','incoming-call-modal','index','exit-werewolf-game-btn','[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','\x20//\x20<--\x20【核心】注入世界书\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','toggle-blur-btn','variation-select','first','book-upload-input','nai-custom-proxy-group','char-diary-screen','getContext','文章标题','**。','cart-title','marginTop','\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20','昨天\x20','favorite','语音生成失败','music-exit-btn','transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)','https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','my-nickname-group','Diary','shared-history-viewer-content','likesCount','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','npc-name-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>','span','simulatedAmapHistory','add-ai-avatar-url-btn','musicLibrary','https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','群聊中没有成员有足够（2条以上）的记忆可供精炼。','/v1/chat/completions','character-select-item','确认合并？','最近的消息太少，无法进行有意义的总结。','change_group_avatar','\x20行的格式不正确，已被跳过。','大小:','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','totalElapsedTime','</td><td\x20class=\x22item-qty\x22>','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>','wallpaper-upload-input','导入世界书','generate','加载失败','character-nai-positive','open-album-btn','\x20MB','.select-box','[data-lang-key-placeholder]','thoughts-history-list','\x20个新头像！','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>','成功检查并修复了\x20','image_prompt','globalSettings','cors','确定要永久删除这条通话记录吗？此操作不可恢复。','group_call_summary','nai-generate-btn','已重置为默认提示音，点击“保存所有外观设置”后生效。','<input\x20type=\x22checkbox\x22\x20value=\x22','backgroundImage','.search-result-item','\x0a**---\x20第\x20','url(','.delete-memory-btn','abort','群成员','https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','确认覆盖','”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20','-\x20(记录于\x20','\x20发送了一个【拼手气红包】(时间戳:\x20','nameHistory','nai-smea-dyn','loadAsync','屠城局：狼人杀死所有好人即获胜。','open-memory-screen-btn','AI\x20\x22','游戏记忆已成功注入到\x20','320450eXHUSj','[系统提示：用户\x20(','char-music-prev-btn','请输入CPhone的背景图片URL','\x20分钟，开始模拟后台活动...','#ff8a80','announcement-actions-modal','<label><input\x20type=\x22checkbox\x22\x20value=\x22','activeContainer','stroke','base','scenario','amount','总结失败','isRefund','将歌曲切换为了《','base_resp','Hello\x20World\x20你好世界','delete-selected-products-btn','群聊\x20\x22','witch-modal-title','cssText','\x22\x20的本次后台活动跳过。','my-group-nickname-group','来源网站','<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>','currentSnippet','left','compressed','API\x20请求失败:\x20','\x22\x20(ID:\x20','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','finishReason','Cphone数据\x20(CPhone)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>','cart-items-list','clear-posts-item\x20selected','TA的好友包括:\x20','小时核心议题','[表情]','is-waimai-request','line-through','playing','cart-item-checkbox','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20','min','memories-list','coverUrl','.battery-level','正在为角色\x20','商品名称不能为空！','input[value=\x22','\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a','已成功收藏\x20','未发现任何需要修复的数据问题。','close-group-avatar-library-btn','manage-preset-categories-btn','\x22\x20吗？','\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。','hiddenContent','favorites-back-btn','is-card-like','Erase','delete-appearance-preset-btn','Language\x20\x22','未找到\x20postID:\x20','getDate','locationName','reason','所有动态','delete-current-category-btn','bottom','https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','Select\x20or\x20Switch\x20Preset','rotating','.selected','summarize-recent-btn-header','var(--text-secondary)','请输入新的内容：','[你发送了一张需要AI识别的图片，图片内容是：\x27','\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？','qzonePosts','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥','这是你们最近的对话：\x0a','tEXt','my-group-nickname-input','add-song-search-btn','.comment-send-btn','import-appearance-input','status_text','[data-lang-key-title]','enqueue','\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','paidBy','stickerCategoryId','parsedLyrics','pause','\x20的红包已被领完','平票或无人投票，此轮无人出局。','https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','createWriteStream','battery-alert-image','”的投票(时间戳:\x20','世界书数据已成功恢复！','API未配置','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。','已加载预设\x20“','https://i.postimg.cc/W40f9qtd/IMG-7098.gif','\x22\x20class=\x22avatar-img\x22><img\x20src=\x22','quantity','备注名/群名不能为空！','确定要将选中的商品作为礼物送出吗？','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','添加商品','world-book-content-container','.link-share-card','Confirm','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/fRTF24jS/IMG-4430.gif','请为这个新头像框起个名字','.char-photo-item','\x0a#\x20【格式铁律\x20(最高优先级：NovelAI\x20开启模式)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【必须包含且只能包含两个】元素，【严格按照】以下顺序:\x0a\x20\x20\x20\x201.\x20\x20第一个元素：一个\x20`offline_text`\x20对象，包含场景和对话。\x0a\x20\x20\x20\x202.\x20\x20第二个元素：一个\x20`naiimag`\x20对象，用于生成该场景的图片。\x0a2.\x20\x20**【【【绝对禁止】】】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】只返回一个\x20`offline_text`\x20元素。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】只返回一个\x20`naiimag`\x20元素。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回任何其他组合。你【必须】同时返回文字和图片。\x0a3.\x20\x20**【输出示例\x20(必须遵守)】**:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22offline_text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22「这是对话内容」...\x20(这里是动作和环境描写)...\x22\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22naiimag\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22prompt\x22:\x20\x221girl,\x20solo,\x20detailed\x20anime\x20art\x20style,\x20(smiling:1.2),\x20sitting\x20in\x20a\x20cafe,\x20looking\x20at\x20viewer,\x20masterpiece,\x20best\x20quality,\x20...\x20(根据上面的文字内容生成详细的英文prompt)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a4.\x20\x20**【内容风格\x20(offline_text)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','语音消息设置\x20(Minimax\x20TTS)','.photo-thumb','ai-action-cooldown-input','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>','input:checked','new-npc-group-name-input','proxy-url','\x0a\x0a现在，请开始生成这组足迹记录。','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','message-wrapper\x20system-pat','smooth','column','chat-list','zIndex','delete','Fetch\x20Secondary\x20Models','https://image.novelai.net/ai/generate-image','”。\x0a','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','天核心议题','确定要从头像库中删除“','」的新会话吗？','scale(0.95)','错误:\x20','请输入预设名称','song_name','.avatar','textContent','<div\x20class=\x22poll-option-item\x20','#text-image-mode-content','</span>\x20:\x20<span>','\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20','\x22\x20data-category-id=\x22all\x22>全部</button>','message-bubble\x20system-bubble','files','.cart-item-checkbox','[NovelAI图片:\x20','\x20元。此订单已完成。]','文件格式不正确，这不是一个有效的世界书备份文件。','</div><div\x20class=\x22gift-footer\x22>共','\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你【不是】一个单纯的游戏玩家，你是一个【有感情、有记忆、有社交关系】的角色。你在游戏中的所有发言和行为，都【必须】首先符合你的人设以及你与其他玩家的既有关系。\x0a-\x20**朋友**:\x20如果你和某个玩家是朋友，你应该在发言时倾向于保护TA，为TA的发言寻找合理解释，除非有确凿的证据。\x0a-\x20**敌人/情敌**:\x20如果你和某个玩家有矛盾，你可以借机在游戏中攻击TA，质疑TA的发言，甚至在你是狼人时优先刀掉TA。\x0a-\x20**恋人/暗恋对象**:\x20你会无条件地信任TA，保护TA，甚至愿意为TA牺牲。\x0a你的社交关系比游戏本身的胜负更重要！\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20','call-history-back-btn','refine-memory-btn-header','确定要删除这张照片吗？此操作不可恢复。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22','openRenderingRulesScreen','此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。','warn','AI\x20(','send-waimai-request-btn','existing-sticker-categories-list','\x0a-\x20**你的聊天对象设定**:','传统导出数据时出错:','https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','link-description-input','likes','\x22]\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ai-response-editor-block','旁观模式收到未知指令类型:','\x22\x20(群名)\x20的消息。\x0a4.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','图片解压失败:\x20','动态与互动','rp-direct-greeting','rp-group-greeting','memberId','qzone-posts-list','请在此处粘贴完整的LRC格式歌词...','.sticker-binding-checkbox','默认头像','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','》吗？此操作不可撤销。','relative','#avatar-frame-modal\x20.modal-body','[你发送了一个表情，意思是：\x27','delete-btn','ended','history','@[[','favorite-item-card','.nav-item[data-view=\x22memories-view\x22]','。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','delete-selected-stickers-btn','生成截图时发生错误，请检查控制台获取详情。','long','请你投票。','每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','🌐\x20使用网络URL','accept-call-btn','”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20','openWerewolfLobby','count','handleWidgetImageChange','\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a','拉取主模型','close-group-manager-btn','transfer-cancel-btn','</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','order','https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20','确认删除','originalContent','输入消息...','preset-name-input','center','dataset','确定要删除选中的\x20','<span\x20class=\x22spoiler\x22>$1</span>','-\x20(头像库是空的，无法更换头像)','ai-avatar-upload-input','正在呼叫...','var(--accent-color)','\x22,\x20\x22postId\x22:\x20456,\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。','data-lang-key-placeholder','”已向你发送好友申请。请返回聊天列表查看。','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','getUint32','speech-01','preset-actions-modal','globalChatBackground','home-screen-pages','EPhone-Sliced-Backup-','regenerate-douban-btn','countdown-title-input','Loading...','music-mode-btn','**:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','，跳过...','文件解析或应用失败:\x20','\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','https://i.postimg.cc/yN3s8szM/IMG-4400.gif','enableTts','custom-prompt-input','(未设置)','group-avatar-input','请至少选择一个要分享的聊天。','existing-groups-list','status-bar-toggle-switch','icon-img-','enableTimePerception','预设分类','”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','expanded','data:\x20[DONE]','无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20','[表情:\x20','\x22\x20成功发布了一条新动态。','\x0a##\x20世界书《','\x20的礼物',']。当在对话历史中看到这些名字时，它们都指的是【你】自己。','.comment-sticker-btn','\x20的动态\x20','.world-book-group-content','</span><span>','#5b3a29','image/jpeg','go-to-cart-btn','offline_text','myAvatarLibrary','”的长期记忆少于2条，无需进行精炼。',';\x22>','Fonts','devicePixelRatio','save-rule-btn','lyric-line','[一张图片，其隐藏文字为：“','change-icon-btn','clear-posts-list','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>','video_call_response','chat-input','\x20拍了拍\x20“','random','qzone-post-item','change_avatar','编辑条目','未选择书籍','char-product-item','smea','狼人已行动，狼人请闭眼。','\x0a#\x20【行为倾向指令\x20(高优先级)】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【唯一任务】就是**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【绝对禁止】再次发布新动态，除非你收到了直接的指令或有一个对剧情发展至关重要的、紧急的新想法。\x0a','save-douban-cast-btn','confirm-share-link-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','动态已更新！','input[name=\x22theme-select\x22]','彻底删除','你好世界\x20Hello\x20World','\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','.screen','.nai-gallery-item','表情包','https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**','正在为角色“','close-product-category-manager-btn','https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22','正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...','确定要将以下消息发布到公告板吗？\x0a\x0a“','sticker-binding-chat-list','transfer-amount','players','type','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20','请输入新的图片URL','status-bar-time','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','originalMeaning','票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Enter\x20the\x20name\x20of\x20the\x20world\x20book...','confirm-create-post-btn','网络图片\x20(CPhone)','borderBottom','小时前聊过。','rp-details-my-amount','https://i.postimg.cc/g2XykNGB/IMG-4727.gif','分类\x20\x22','change','toggle-fullscreen-btn','\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','》\x20-\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','visibleTo','imageProcessed','char-diary-detail-screen','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg','buttonId','\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','tables','狼人杀AI回应生成失败:','）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。','Secondary\x20Proxy\x20URL','正在为您选择的\x20','\x20中找到世界书。','[一张图片，其隐藏文字为：\x22','chat-lock-overlay','导入数据时出错:','add-new-rule-btn','is-transfer','offlineMaxLength','offline-max-length-input','https://i.postimg.cc/SNByPrf9/IMG-7005.gif','\x20(图片描述:\x20\x22','📸\x20NovelAI图片生成开始，AI提供的prompt:','(无)','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>','检测到\x20SSE\x20流式响应，开始解析...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','AI未能成功描述图片。','found','setTimeout','contact-picker-item','容错解析：策略3成功\x20(将整个返回文本作为摘要)','删除消息','<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20','<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','char-photo-item','删除日记','stickerMeaning','打开预设编辑器时发生严重错误:','》吗？\x0a\x0a【【【警告】】】\x0a此操作将同时永久删除该分类下的\x20','购物车(','speaking','\x22\x20alt=\x22','location','element','form-button','\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>','”的记忆\x20---\x0a','temp_user_chat_mirror','(无标题投票)','》:\x0a','15LzWfji','rp-group-total','senderName','外观设置已保存并应用！','https://api.vkeys.cn/v2/music/tencent/lyric?id=','🎬\x20Director\x20Mode:\x20Saving\x20thought_chain.','audio-player','删除头像','”的TTS功能已关闭，已禁止发起TTS请求。','trim','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','delete-css-preset-btn','char-main-date','\x20\x20-\x20在群聊“','https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif','album-upload-photo-btn','cphone-wallpaper-upload-input','openNpcEditor','\x27)\x22\x20data-comment=\x22','https://i.postimg.cc/k45sd8gn/IMG-6375.gif','\x20条消息吗？这会通知AI这些消息已被删除。','custom-modal-overlay','/9j/','custom_proxy_url','nai-test-error','touchend','<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>','poison','尝试打开一个不存在的世界书，ID:','download-selected-nai-gallery-btn','已同步角色\x20','字体URL不能为空！','history-back-btn','</td></tr>','startX','reading-overlay','avatarFrame','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','NovelAI\x20API\x20Key','旁观模式AI尝试使用不存在的表情:\x20\x22','\x22:\x20[\x0a','manage-nai-gallery-btn','imageUrl','reading-library-search-input','\x20张NAI图片吗？此操作不可恢复。','\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20','\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','existing-categories-list','lastActionTimestamp','https://i.postimg.cc/XNkQTHvf/IMG-5561.gif','bookId','globalCss','masterpiece,\x20best\x20quality,\x201girl,\x20beautiful,\x20detailed\x20face,\x20detailed\x20eyes,\x20long\x20hair,\x20anime\x20style','input[name=\x22theme-select\x22][value=\x22','[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','”这个信息，将其转换为【具体的公历日期】（例如：“约定了明天见面”应总结为“我们约定了','pollTimestamp','取消置顶','select-all-music-search','\x20(本名:\x20','\x20剩余红包将在','music-player-overlay','single','#000000','[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“','totalBalance','TA的歌单','通话记录已成功总结并存入角色“','home-screen-pages-container','.message-wrapper[data-timestamp]','photo-viewer-next-btn','单个红包金额不能少于0.01元！','rp-content-group','这个分类下还没有商品哦~','head','result','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','ᗜωᗜ','确认导入','发言结束，现在开始投票。','npc-editor-modal','角色卡数据无效或缺少\x27name\x27字段。','rp-tab-group','https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。','add-group-chat-btn','import-world-book-input','choices','\x20发布了一条新动态]','置顶公告','.voice-play-btn','my-frame-tab','https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','选择一个开场白','album-grid-page','下棋历史\x20(x,y坐标均从0开始):\x0a','netease','#image-mode-content','”，金额是\x20','user_photo','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','translateX(','nickname','minimax-api-key','---\x20狼人杀对局完整复盘\x20---\x0a\x0a','profile-thoughts-history-view','revokeObjectURL','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','操作结果','repost-confirm-btn','-\x20**当前时间**:\x20','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','[图片，描述:\x20','memories-view','rp-group-amount','linkedWorldBookIds','title','cancel-wolf-kill-btn','请用文字描述您要发送的照片：','<span\x20class=\x22diary-handwritten\x22>$1</span>','add-song-local-btn','chat-header-title-wrapper','has','aiPersona','[表情，含义:\x20','\x22\x20data-category-id=\x22','\x0a###\x20正在模拟\x20','正在批量添加\x20','switchToCharScreen','select-all-nai-gallery-checkbox','已删除最新心声，当前心声已回滚至上一条。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','\x20\x20\x20\x20-\x20我的狼队友是：','positive','导入歌词','#music-lyrics-container\x20#music-lyrics-list','<span>','renderXSocialScreenProxy','”的头像库','创建新聊天\x20(第1/2步)','meaning','werewolf-wait-reply-btn','isSeparator','Secondary\x20API\x20Settings\x20(for\x20Summarization)','member-persona-input','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','暂停了音乐','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','cancel-ai-response-editor-btn','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','1.0','群昵称不能为空！','variation-product-name','replace','resolution','input[name=\x22theme-select\x22]:checked','time','save-product-btn','rp-direct-receiver','确认压缩图片？','save-ai-response-editor-btn','imageDescription','page-indicator','lucky','repost-cancel-btn','退款给\x20','(今天是第一天，没有历史记录)\x0a','call-history-list','.entry-keys-input','https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','外观设置','Content','typing-indicator','en-US','cloneNode','message-editor-block','):\x20','char-article-content','commenterDisplayName','wallpaper-screen','memos','.music-search-checkbox','scrollTop','autoMemoryInterval','show-avatars-btn','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','[私聊]','NotAllowedError','</div><div\x20class=\x22transfer-amount\x22>¥\x20','Autoplay\x20was\x20prevented\x20by\x20the\x20browser.','translateX(-50%)','api-key','字体设置','group-avatar-library-modal','nai-default-positive','status-','一位朋友','fullPrompt','精炼失败','编辑商品','这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？','group_','#avatar-frame-modal\x20.frame-tabs','get','请先在API设置中配置好（主或副）API。','AI\x20获胜了！','Back','headers','申请成功！','在执行组合操作时遇到错误:\x20','\x22\x20已经存在了！','ai-frame-content','收到了未知的AI指令类型:','[V]','NAI_Gallery_Batch_','save-frame-settings-btn','my-frame-grid','分组名不能为空！','undefined','werewolf-selection-item','创建新规则','<strong>$1</strong>','预设已删除。','chat-list-render-window-input','\x22>\x20','静音音频已停止。','status_msg','cloned-header','custom-modal-cancel','https://i.postimg.cc/nryNzTXK/IMG-6915.gif','.contact-picker-item[data-contact-id=\x22','发生了一个错误:\x20','defineProperty','无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','mouse','.delete-btn','确定要恢复默认设置吗？','dismissedUpdateVersion','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20','&nbsp;','\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“','\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a','</span>:\x20','确定要删除这条评论吗？','正在执行...','链接分享','小于1分钟','&times;','Long\x20Screenshot','[系统提示：你\x20(','preCallContext','input[name=\x22visibility\x22]:checked','fontFamily','<option\x20value=\x22global\x22>公用\x20(所有角色)</option>','.voice-transcript','Language','create-countdown-modal','switch-to-text-image-mode','元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20','simulatedTaobaoHistory','标准JSON数组解析失败，将尝试强力提取...','”的手机使用习惯...','渲染X社交页面','Background\x20Activity\x20Interval\x20(sec)','，我的人设很','post-local-image-input','.toggle-content-btn','[图片]\x20','恭喜！','(ID:\x20','导演模式保存(Sticker):\x20使用了编辑器提供的完整JSON\x20(url\x20+\x20meaning)','first_mes','postTitle','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20','确定要从收藏夹中移除这\x20','\x20的红包','📝\x20使用','message-editor-modal','编辑\x20NPC','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','cphoneWallpaper','close-playlist-btn','\x20的外卖订单（时间戳:\x20','pat_message','--chat-font-size','https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','cancel-variation-selection-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x20selected\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x20的身份是：','download','my-avatar-preview','\x20(用户)</span>\x0a\x20\x20\x20\x20','announcements','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','[系统提示：你拒绝并退还了“','https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif','ai_generated','openCharWallet','浏览器','纯音乐，请欣赏','\x22\x20class=\x22avatar-frame\x22></div>','announcement-board-content','开始清理','private_user','歌曲查找失败:\x20AI请求的歌曲名\x22','\x20\x20\x20\x20-\x20我昨晚用毒药毒了\x20','请为你的图片添加一个简单的描述（必填，给AI看的）！','生图功能设置','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','请先在API设置中配置好API信息。','font-size-slider','外观预设','拼手气红包','维基百科','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>','https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','theme-preset-select','小时内退还。','\x22\x20转发了动态\x20#','<span\x20class=\x22offline-dialogue\x22>',':\x20[发送了一个表情，意思是:\x20\x27','.poll-action-btn','移出成员','user-speak-btn','analysis','订单详情','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','进入投票','CSS\x20预设已保存！','无法自动播放静音音频（这在iOS首次加载时是正常现象）:','npc-group-select','为什么','\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a','transfer-actions-modal','replaceChild','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22','\x20\x20\x20负面:','Music','表情名不能为空！','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22','<div\x20class=\x22rp-claimed-info\x22>已被\x20','AI返回了空的或格式不正确的总结内容。','savedId','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>文件中未找到可合并的数据。</p>','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','文字已更新！','apiKey','聊天设置','char-memo-list','https://i.postimg.cc/cLPP10Vm/4.jpg','清理冗余数据','tableName','douban-detail-author','group-character-nai-prompts-btn','Language\x20switched.\x20The\x20page\x20will\x20reload\x20to\x20apply\x20changes.','arc','offset','Escape','novelai-api-key','\x22)\x20作为角色名。消息内容:','2-digit','添加完成！\x0a\x0a成功添加\x20','跳过一个无法解析为JSON的编辑块:','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/sDFhySn3/IMG-6936.gif','\x22\x20\x0a\x20URL:\x20','导演/编辑模式保存(Sticker):\x20使用了\x20meaning\x20查找','cors_proxy','memories','clear','图片格式处理失败:\x20','typing-status','...，所以我决定这样说...)\x0a\x0a####\x20阶段\x20C：最终发言稿\x20(草稿)\x0a(结合T,\x20G,\x20S的思考，我准备这样说：...)\x0a---\x0a','[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','npc-persona-input','transition','match','[一张图片，描述为：\x22','contentLines','qzone-post-container','manage-stickers-btn','data:image','https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','的设定集','decline-call-btn','Success','Performance\x20&\x20Display\x20Settings','./sw.js','存储空间优化','grayscale(100%)','-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20','保存\x20API\x20预设','确定要永久删除商品\x20“','https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif','https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。','#b5b5b5','https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','theme-toggle-switch','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','\x20->\x20','我的相册','isEnabled','\x0a建议刷新页面以确保所有更改生效。','paddingBottom','commentCooldowns','https://i.postimg.cc/B6KD52vz/IMG-7096.gif','blob','天，救人概率为\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>','\x0a\x0a现在，请以“','input[value=\x22user\x22]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','rule-template-input','\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>','settings-preview-area','https://i.postimg.cc/8kYShvrJ/90-UI-2.png','AI生成的图片','modern\x20app\x20icon\x20for\x20','guardedId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','我是谁呀。','parse','导出数据时出错:','</textarea>','product-category-tab','请先选择角色','#4CAF50','call-transcript-modal','在此修改内容...','music-progress-fill','网络图片\x20(EPhone)','AI返回的行动中未找到有效的JSON数组。','-modal','getElementById','content-type','prompt_order','我的消息预览','sticker-panel','无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','openCharacterSelector','black','}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','删除分类后，该分类下的所有预设将变为“未分类”。确定吗？','none','shopping-product-count-input','dark-mode','https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif','\x22\x20触发带理由的好友申请决策流程...','nightActions','找不到原始消息。可能已被删除或位于更早的历史记录中。','这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20-\x20响应内容:\x20','指定的数据已成功清除。','like','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20','https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','#preset-tabs\x20.world-book-tab','transcript','isNpc','participant','qzone-avatar-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“','Warning','qzone-back-btn','werewolf-player-selection-list','生成失败','关于“','qzone-nickname','originalPost','确认清理冗余数据？','noneOf','在导演模式保存时，发现无效的指令对象，已跳过:','char-wallet-back-btn','Werewolf','渲染规则\x20[','EPhone-WorldBooks-','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','保存字体预设','https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','rules-tab','动态内容已复制到剪贴板。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','复制成功','save-chat-settings-btn','<span>删除</span>','删除分类后，该分类下的所有商品将变为“未分类”。确定吗？','https://i.postimg.cc/PJppkbvn/IMG-6918.gif','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>','\x20\x20\x20\x20\x20\x20-\x20我在此次游戏中没有特别的社交关系。\x0a','message-editor-block\x20variation-block','secondary-api-key','https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','offline-mode-group','save-persona-preset-btn','werewolf-game-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','pipeTo','model','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>','分钟前聊过。','\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>','char_memo','<li>未在此文件中找到可识别的数据。</li>','删除对话','sampler','currentVoiceId','API未配置，无法进行总结。','world-book-tab','.message-bubble.is-link-share','\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','findIndex','</memory>\x0a\x20\x20<recent_dialogue_with_user>','是狼...”)\x0a\x20\x20\x20\x20-\x20(例如：我的敌人发言了，我的表演就是无视TA的逻辑，直接攻击TA。)\x0a\x20\x20\x20\x20-\x20(例如：我是一个','.char-screen','分类名不能为空！','new-product-category-name-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>','覆盖预设','点击查看详情...','currentTime','将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。','批量导入格式错误，已跳过此行:','add-ai-avatar-batch-btn','qzone-sticker-grid','请为这个表情命名\x20(例如：好耶、疑惑)','精炼“','\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','chatActionButtonsOrder','https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','全部记忆\x20(','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','currentIndex','收藏成功！','Save\x20and\x20Apply','...\x0a-\x20**已有评论**:\x0a','\x0a-\x20**人设\x20(必须严格遵守)**:\x20','\x20(图片描述:\x20“','一条[转账]消息已被撤回。','Delete','character','\x0a#\x20可用表情包\x20(优先使用)\x0a每个AI角色都被设置了专属表情包，在需要发送表情时，他们应该【优先】从自己的专属列表中选择。尽量让你的表情丰富多样，避免重复。\x0a','borderRadius','syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','npc-list','照片已删除。','currentPlaylist','.waimai-details-btn','请根据你的设定，生成模拟聊天记录。','native','++id,\x20timestamp','查验结果','\x22\x20中发现并修复了旧红包数据。','btn-danger','insertBefore','custom-frame-upload-input','add-manual-memory-btn-header','清空动态时发生错误:\x20','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','dialogue','https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','display','拉取模型失败:\x20','song','onerror','https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','相册名称不能为空！','icon-settings-grid','\x20条记录到\x20','检测到\x20EPhone\x20备份文件，执行标准导入...','.product-item.selected','scrollIntoView','https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','.music-search-checkbox:checked','本地群头像上传及识别失败:','description','创建新相册','批量导入表情','\x20元。]','#nai-gallery-grid\x20.nai-gallery-item','你们最近没有有效聊天记录。','头像框已保存并同步！','scale(0.8)','clear-cart-btn','请先在购物车中选择要结算的商品。','character-nai-negative','image-upload-input','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','修改昵称','.draggable-button-item','\x0a#\x20群成员列表\x20(你的总结目标)\x0a','</recent_dialogue_with_user>\x0a</character>\x0a','numeric','编辑预设','请输入文字图描述！','API设置不完整，无法继续。','highlighted','selected','qzone-banner-container','手慢了','https://i.postimg.cc/KYr2qRCK/1.jpg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','<p\x20class=\x22char-browser-image-description\x22>','cancel-frame-settings-btn','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','padStart','#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a','更换图标','orderBy','https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','正在准备...','请添加歌曲','Cancel','fillStyle','toArray','message-bubble\x20post-deleted-placeholder','\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20','<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>','witch-do-nothing-btn','Global\x20(All\x20Characters)','douban-detail-group','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','lyrics-position-group','char-photo-description','删除记录','regenerate-char-diary-btn','.frame-grid','开始压缩图片，原始大小:\x20',')\x20内容:\x20\x22','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>','red-packet-details-modal','messages','char_diary','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','高德地图','contains','\x0a-\x20**你的曾用名**:\x20[','这是一个通过手动创建的角色。','https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','狼人行动API失败:','logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27','\x20\x20-\x20评论:\x20','clearRect','<span>已</span><span>超</span><span>时</span>','frame_14','create_countdown','.participant-avatar-wrapper[data-participant-id=\x22','.playlist-item-info','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>','days','hidden','countdown','minimax-model-select','max','opacity','删除表情','.variation-image-preview','char-browser-screen','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','\x22\x20data-memory-timestamp=\x22','请根据你的设定，生成你的淘宝购买记录和余额。','char-qq-conversation-screen','Refresh','variation-selected-price','副模型','https://api.vkeys.cn/v2/music/netease?id=','blur','diary','没有可供重新生成的AI响应。','未分类','book_','，礼物是：','appearance-preset-select','edit-last-response-btn','<span\x20style=\x22color:\x20red;\x22>未满足</span>','https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','suffix','\x20MB</strong></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','qzoneSettings','\x0a#\x20身份与核心任务\x0a你正在扮演角色“','\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>',')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','AI女巫决定保留解药。','正在请求AI进行手动总结...','Edit\x20Rule','https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','刷新页面？','公用规则','</td><td\x20class=\x22item-price\x22>¥','https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','代付请求已被拒绝','https://api.vkeys.cn/v2/music/netease?word=','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','.variation-block','发布公告','duration','update-notice.html?_=','select-all-chars-for-clear','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>','聊天记录已成功覆盖！正在刷新界面...','Ephone','relationship','enable-tts-switch','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>','join','nextElementSibling','确认合并','.nai-gallery-item[data-key=\x22','preset-avatar-preview','\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','API\x20Preset\x20Management','cart-total','contactType','focusout','.red-packet-card','src','generateInternalStream','已成功将\x20','add-group-avatar-batch-btn','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥','timeupdate','https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','chat-lock-content','自动总结成功：为\x20','light','”\x20吗？','<div\x20class=\x22red-packet-card\x20','✅\x20检查完成，未发现任何冗余数据。','<div\x20class=\x22poll-card\x20','image-mode-content','querySelector','游戏配置：','chat-list-bottom-nav','albumId','.chat-list-item[data-chat-id=\x22','werewolf-game-title','charId','字体文件URL\x20(.ttf,\x20.otf,\x20.woff等)','stopPropagation','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','.frame-item.selected','songs','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','some','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','📋\x20直接粘贴歌词文本','启用独立后台活动','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','data-clear-step-1','api-temperature-slider','dragging','AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。','member','k_euler_ancestral','https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','EPhone-Chat-','投票结果：','imageCount','检测到群聊\x20\x22','恭喜你，你赢了！','\x22\x20(大小:\x20','link-source-input','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>','https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','vote','toDateString','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','preset-editor-screen','commenterOriginalName','已成功导出所有数据！','slice','这是你们的第一次互动。','...”','(回复\x20','body','用户已忽略版本:\x20','无法为不存在的分类打开绑定模态框:','sticker_','level','bulkPut','\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a','mouseout','相册已成功删除。','请填写完整的约定标题和日期！','stickerId','请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif','setProperty','post-use-url-btn','save-sticker-binding-btn','transfer-btn','歌单已生成，正在从网络获取\x20','#settings-preview-area','avatar','\x20的动态\x20(角色)','群聊内转账','simulatedAppUsage','data-clear-char-list','apiConfig','char-qq-screen','npcId','https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','结算(','[约定达成]\x20','已成功加入购物车！','”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]','aiAvatarLibrary','global-lyrics-bar','success','\x20领取了\x20','prompts','chat-settings-screen','Title','\x27刚刚评论了你的动态“','**[夜晚]**\x20','spectator-edit-btn','[图片内容:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','\x22\x20placeholder=\x22','导入成功！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','identifier','游戏开始','char-conversation-partner-name','<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>','*你按下了接听键...*','post-visibility-groups','\x20是我的好友。\x0a','douban-my-comment-avatar','Reset\x20to\x20Default\x20Font','世界书','生成模拟相册失败:','\x22><div\x20class=\x22poll-question\x22>','\x22\x20class=\x22sticker-image\x22>','\x22。\x0a','\x20张图片因网络或CORS限制下载失败。','white','loader-container','【AI角色】','请输入一个有效的URL或选择一个文件！','\x20已复制到剪贴板。','\x20向对方发起了转账:\x20','categoryId','usage-item','getWriter','lrcUpdateInterval','恢复默认字体','frame-item','图片内容','.favorite-item-card.selected','https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','\x20<span\x20class=\x22source\x22>','https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','music-playlist-panel','originalType','”\x20的详细角色信息。','memory-list-container','now','\x20发送了一张图片，内容是：\x27','群聊人数不能少于2人。','red-packet-modal','isGroupCall','严重警告！','选定范围内的动态已被清空。','[发送了一张图片，描述为：\x27','\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a','切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？','生成中...','\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','music-play-pause-btn','\x0a-\x20**你的长期记忆**:\x20','music-lyrics-list','[系统提示：用户(','\x22><div\x20class=\x22title\x22>','\x20个新表情！','shoppingCategories','**:\x20\x22','\x22\x20已经存在了，换个名字吧！','-\x20**时间**:\x20你必须感知到当前是\x20','转账给\x20','删除规则','解析器：已启用\x20Markdown\x20提取模式。','cancel-call-message-action-btn','object','hasOwnProperty','send-photo-btn','currentPlayer','recalledData','导演/编辑模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','removeChild','猎人带走了\x20','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>','\x20被刀了','declined','var-','announcement-action-cancel','正在全网搜索歌曲资源...','100','[表情:\x20\x27',')\x20刚刚领取了红包\x20(时间戳:\x20','douban-post-detail-screen','keys','最终正面提示词:','avatar_name','shiftKey','修改图片','<p>','getMonth','\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','share-location-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','照片上传成功！','languageChangedAlert','char-taobao-screen','分组\x20\x22','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','商品已删除。','AI\x20(群聊后台)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','”分享TA的私人歌单...','block-chat-btn','alt','douban-max-posts-input','\x0a###\x20详细对局流程:\x0a','\x0a\x0a##\x20世界书:\x20','NPC','<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22','nai-result-image','waimai-order-for-ai-btn','appearancePresets','group-avatar-upload-input','and','外观设置已成功导入并应用！','.action-icon','<textarea\x20id=\x22','global','char-article-title','minimaxGroupId','https://i.postimg.cc/76Tj3g1B/IMG-4425.gif','font-preview','renderingRules','AI\x20尝试使用一个不存在的群头像:\x20\x22','werewolf-finish-speech-btn','CPhone','张图片，prompt:','myPersona','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-image-container\x22\x20style=\x22background-image:\x20url(','send_and_recall','正在执行删除操作...','角色\x20“','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','applicationReason','localeCompare','profile-heartfelt-voice','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','红包已被领完！','\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20','delete-selected-frames-btn','#chat-input-area','\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a','myAvatarFrame','poll','isDanger','variation-selection-modal','”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**',';\x20font-style:\x20italic;\x22>','https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','API\x20错误:\x20','lastGuardedId','each','cancel-create-poll-btn','nai-quality-toggle','file','playlist-body','visible','EPhoneSingleChat','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','还没有任何评论，无法等待回复。','#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a','https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','proxyUrl','share-link-modal','fetch-secondary-models-btn','preset-screen','world-book-category-pane\x20active','waimai_response','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20你的核心任务\x0a你正在扮演角色“','\x0a-\x20策略:\x20','https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif','load','选择要精炼记忆的角色','#data-clear-type-list\x20.clear-posts-item','message-wrapper\x20','css-preset-select','请根据你的设定，生成你的浏览器记录。','\x20将群名修改为\x20“','https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','confirm-delete-world-books-btn','https://i.postimg.cc/zvWGPjms/IMG-7090.gif','头像框','photos-grid-page','AI\x20Block\x20Cooldown\x20(hours)','add-preset-btn','className','decline_transfer','无人投票','doubanMinPosts','找不到主角\x20“','initiator','gomoku_move','regex','appIcons','\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a','\x22]\x20.avatar',')}。\x0a-\x20**对话状态**:\x20','打包中...','female-shaonv-jingpin','8px','\x20(已忽略版本:\x20','拉取副模型','ai-response-editor-modal','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是','https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif','添加头像','如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a','add-chat-btn','cancel-red-packet-btn','checkout-btn','is-poll','你已拒收','\x20分享了Ta的位置：\x27','旧版备份数据写入数据库失败:\x20','thoughtsHistory','\x20请根据这个结果发表你的评论。]','album-photos-title','.variation-image-input','https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','iconId','back-from-member-management','openPresetScreen','my-frame-content','上传成功！','\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>','https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','原文:\x20\x22','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','\x20已为','请根据你的设定，生成你的歌单。','replyToName','Font\x20File\x20URL\x20(.ttf,\x20.otf,\x20.woff,\x20etc.)','ArrowLeft','translateY(','switchToMyPhone','Settings','Finish','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','writeText','save-preset-btn','.sticker-category-tab','originalSize','music-playlist-btn','data-lang-key-title','请输入歌手名','setDate','</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22','waimai-confirm-btn','favorites-action-bar','><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.','5.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20(','.unread-count','\x20分钟)，本次独立行动跳过。','Independent\x20Action\x20Cooldown\x20(min)','正则表达式\x20(使用g作为标志)','profile-history-icon-btn','.poll-option-item','delete-transcript-btn','album-screen','所有图片都下载失败了。这通常是由于网络问题或CORS跨域限制（请检查API设置中的CORS代理是否有效）。','NPCs','cphoneAppIcons','(暂无有效聊天记录)\x0a','battery-alert-modal','values','ai-avatar-library-modal','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>','\x0a-\x20**最近与用户的互动**:\x20','werewolf-retry-btn','创建新聊天\x20(第2/2步)','pageY','DOMContentLoaded','\x22\x20class=\x22participant-avatar\x22\x20alt=\x22','https://i.postimg.cc/3NDQ0dWG/image.jpg','nai-gallery-grid','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>','请至少选择一个要清空的范围。','API请求失败\x20(','收藏成功','保存外观预设','\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22','translateX(calc(-','请根据你的设定，写一篇新日记。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','album-item','https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','没有找到可导入的内容。','unblock-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','group-avatar-group','长截图生成失败:','*讨论记录*:\x0a','\x0a##\x20来自《','userAgent','你领取了\x20','clear-posts-item','\x20\x20\x20\x20-\x20我昨晚守护了\x20','</persona>\x0a\x20\x20<memory>','variation-quantity-display','.incoming-call-content\x20.caller-text','”图标','请输入头像的图片URL','下载失败','close-shared-history-viewer-btn','角色\x20\x22','qzone-banner-input','https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','豆瓣小组','save-api-preset-btn','Export\x20Data','无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','.post-avatar[data-author-id=\x22','\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a-请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20','”\x20的预设已存在。要覆盖它吗？','流式导出过程中出错:','world-book-tabs','sourceChatName','请根据你的设定，生成你的相册内容。','确定要删除这个约定吗？','isGroup','内容因安全策略被屏蔽。触发类别:\x20','.chat-list-item','stream','banner','cancel-create-post-btn','”添加记忆','》\x0a-\x20**发帖人**:\x20','Reply\x20to','.voice-message-body[data-text]','”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。','appUsageLog','hunter','showStatusBar','save-wallpaper-btn','解析格式模板失败:','packet_timestamp','Import\x20Backup\x20File','char-simulated-send-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background:\x20','AI返回的内容中未找到有效的JSON对象。','https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','call-history-screen','cart-count','\x22\x20class=\x22avatar-frame\x22></div></div>','touches','rule-name-input','删除相册','\x20\x20\x20\x20-\x20我昨晚空守了。\x0a','<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22','.entry-comment-input','import-single-chat-input','渲染规则','#\x20性格补充\x0a','getHours','\x20条旧的红包消息！页面将自动刷新以应用更改。','请选择今晚的目标。','正在归档最后一个切片\x20','好的，我明白了。我会严格遵守以上所有规则和设定。','close-ai-avatar-library-btn','chat-name-input','从旧版本迁移的条目','guard','sticker-category-manager-modal','nai-steps','<span\x20style=\x22color:\x20green;\x22>运行中</span>','input','widgetData','一条动态','分享成功','textAlign','novelai-switch','favid','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。','确定要将“','save-member-settings-btn','voted','上传头像','检测到JSON中的非法控制字符，尝试清理并重试...','\x20更换了头像]','成功将角色\x20','\x20发送了一个【专属红包】(时间戳:\x20','loadedmetadata','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','[一张图片，描述为：“','version','\x22\x20(由\x20','custom','data','\x22\x20value=\x22','https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','\x20.message-bubble.user\x20$1','top','minimaxApiKey','upload-global-bg-url-btn','-\x20**长期记忆\x20(必须参考)**:\x20','usageTimeMinutes','categories','*对方按下了接听键...*','【用户\x20(User)】','.gift-card','product-category-manager-modal','Preset\x20Name','图片详情','photo-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20','等待对方处理','长期记忆','”\x20的位置已发送到你们的聊天中。','分享新鲜事...（非必填的公开文字）','char-diary-detail-title','++id,\x20name,\x20type','manage-group-avatar-library-btn','music-player-avatar-display','messages-view','https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','天\x20-\x20白天','chat-list-action-delete','manage-npc-groups-btn','AI\x20(CPhone)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','Details','压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...','📁\x20从本地文件\x20(.lrc)','char-home-screen','\x22\x20not\x20found.\x20Defaulting\x20to\x20\x27zh-CN\x27.','option','preset-avatar-input','byteLength','save-advanced-editor-btn','last','createObjectURL','已使用','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>','group_call_request','board','discussionLog','流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。','<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>','https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','utf-16be','char-music-artist','isHidden','\x20(大小:\x20','...\x22','character-profile-modal','Edit','tts-audio-player','讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','commenterName','\x20的图片消息替换为文字描述...','内容为空。','message','启用AI生图功能','<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>','regenerate-char-memo-btn','cancel-create-countdown-btn','抱歉，我拒绝了你的好友申请。','<span\x20class=\x22commenter-name\x22>','https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','”]\x20','douban-post-item','%\x20+\x20','\x20(最后互动于\x20','https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','custom-modal-confirm','https://i.postimg.cc/fyyGgW61/IMG-7115.gif','NPC\x20Nickname','命名头像','inline-block','receiver','最后确认！','友善的评论是交流的起点','novelai-test-modal','在导演模式中发现一个无效的片段\x20(来自parseAiResponse的文本回退):','save-npc-btn','\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“','targetId','is-sticker','.at-mention-popup','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“','后台活动模拟已自动启动。','API失败:\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','probability','https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','\x27的评论，内容是：“','werewolf-game-over-close-btn','data-clear-wizard-modal','select-all-import-types','已切换到新的开场故事！','log','mousedown','生成模拟淘宝记录失败:','playlist-item','lastIndexOf','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。','\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“','https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','\x20-\x20','equals','borderColor','char-amap-list','manage-members-btn','customCss','.contact-picker-item','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','steps','预言家已行动，预言家请闭眼。','time-zone-group','*事件*:\x20','API\x20调用失败','.share-target-checkbox:checked','数据检查与修复','isLocal','管理预设分类','EPhone-Full-Backup-Streamed-','<button\x20class=\x22sticker-category-tab\x20','npc-list-view','读书会话已关闭。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>',';\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2012px\x2024px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x2010000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20pointer-events:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(20px);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','summary','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<span\x20class=\x22speaker\x22>','.text','张图片','smea_dyn','rp-details-greeting','...\x20[记忆:\x20','https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','\x22\x20id=\x22','add-ai-response-block-btn','is-realimag','antidoteUsed','toFixed','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>计算图片大小时出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>Error</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','preset-action-edit','spectator','\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20[','.rules-category-pane[data-category-id=\x22','https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','Secondary\x20API\x20Key','nai-cfg-scale','成功移除了\x20','Messages','狼人杀游戏总结已自动存入\x20','world-book-checkboxes-container','audio/mpeg','仅清空\x20','https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。','”。请你回顾一下你和“','auto-memory-toggle','openCharApp','-\x20\x20\x20**对话状态**:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','手动总结已完成！新的记忆已添加到“','\x0a4.\x20\x20**我的人设与社交关系**:\x0a\x20\x20\x20\x20-\x20**人设**:\x20','处理通话请求时API出错:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','memories-back-btn','cancel-rule-editor-btn','activeChatId','请至少选择一种要合并的数据类型。','\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。','\x22\x20的整个对话吗？此操作不可撤销。','已成功从文件导入预设《','保存书籍(ID:\x20','read-together-btn','选中的表情已成功删除。','<span\x20style=\x22color:\x20green;\x22>是</span>','select-all-stickers-checkbox','切换听歌对象','即将开始下载您的完整备份文件。下载过程中请勿关闭页面。','扫描聊天记录失败:','img','flex','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>','confirm-gift-recipient-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','音频播放失败:','</p><p>','onended','投票至少需要2个选项。','management-mode','Please\x20wait...','group_summary_from_','rules-category-pane\x20active','setAttribute','home-screen','\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片','直连失败','.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper','api-temperature-value','Next','simulatedBrowserHistory','**\x20(本名:\x20','.progress-bar','default_negative','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a','presets','*事件*:\x20平安夜，无人出局。\x0a','https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','Response\x20status:','cover','char-album-grid','rule-enabled-switch','.zip','commentsCount','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','100%','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心新增】在这里添加“背景”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22','char-wallet-content','Reset','{{user}}','删除书籍','address','qzone-post-delete-action','**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（','确定要删除这篇日记吗？','isPinned','translateY(0)','.world-book-category-pane[data-category-id=\x22','已撤回的消息','更换“','isTemporary','call-message-actions-modal','.checkbox','确定要删除分类《','string','\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','.name','https://files.catbox.moe/r5heyt.gif','qzone-avatar-container','open_red_packet','计算图片总大小时出错:','chargingchange','sticker','char-music-cover','”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','请填写有效的商品信息和金额！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>','”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','[这是你上一轮的内部思考]\x0a-\x20分析:\x20','offline-min-length-input','Presets','favorites-edit-btn','”的出行足迹...','frame_5',',\x20内容:\x20\x22',')\x20的棋步。','在这里输入图片描述','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','outgoing-call-name','persona-preset-item','\x22\x20class=\x22chat-image\x22>','--music-bg-image','API错误:\x20','#f9f9f9','#ff4d4d','search-history-back-btn','video-call-btn','favoritedPostIds','source_name','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','ai-avatar-group','join-call-btn','\x22\x20在库中未找到。','reload','直连失败,\x20尝试使用CORS代理...','view','内容因安全策略被屏蔽\x20(原因:\x20','</div><div\x20class=\x22description\x22>共\x20','close-nai-test-btn','async','诊断：在\x20data.extensions.character_book\x20中找到世界书。','ZIP文件中未找到图片','indexOf','生成新日记失败:','游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20','清理完成','发来了\x20','\x0a-\x20**世界观**:\x20','是否要使用毒药？','#world-book-checkboxes-container\x20input:checked','文章摘要...','请输入书名','getBoundingClientRect','is-location-share','cancel-music-search-btn','[语音]','&id,\x20minimaxGroupId,\x20minimaxApiKey','请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。','Error','</span></div></div>','[图片/文字图]\x20描述:\x20\x22','artistName','font-url-input','repost-comment-input','\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','Bearer\x20','申请失败','昨晚是平安夜。','生成模拟浏览器历史失败:','block-cooldown-input','通话记录已保存:','chat-settings-modal','#\x20场景设定\x0a','AI已将您的\x20','This\x20is\x20a\x20font\x20preview\x20effect,\x2012345.','\x22\x20的本次后台活动跳过。原始回复:','apiPresets','\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a','https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','未使用','toBlob','douban-cast-list','charAt','char-music-lyrics','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a','https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','我们的回忆','callHistory','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','-\x20\x20\x20**公开发布NovelAI真实图片动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20[\x22图片1详细英文描述\x22,\x20\x22图片2详细英文描述\x22]}`\x20\x0a\x20\x20*\x20**prompt撰写**：你可以根据当前对话上下文、你的角色人设、以及你想表达的情感和氛围，来撰写详细而具体的prompt。详细程度由你根据具体情况自己决定，并不强制。\x0a\x20\x20*\x20例如：\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22','htmlFor','.upload-variation-image-btn','---\x0a','isClick','fetch-models-btn','visibilitychange','send-group-packet-btn','你们正在一起读书。','#selective-import-list\x20.clear-posts-item.selected','一个普通玩家','。请收礼的角色表示感谢，其他角色可以自由发挥。]','-\x20\x22','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg','rgba(0,\x200,\x200,\x200.4)','copy-message-btn','npcGroupId','\x22）。你已经有一段时间没有和用户（','mode','swiped','长截图','rp-group-count','Send','请根据你的设定，开始你的行动。','toCollection','value','导入已取消，因为未提供书名。','https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','profile-main-content','prev-page-btn','》吗？','https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','¥\x200.00','”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','renderWallpaperScreenProxy','\x0a你必须严格遵守','AI\x20(独立行动)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','options','char-conversation-messages','randomJottings','playerJson','++id,\x20name,\x20description','transfer-note','usage','Search','[系统提示：用户刚刚发布了一条动态(ID:\x20','https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','来自\x20','commentText',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','.chat-group-content','checked','#ccc','https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>本地图片(头像/表情/头像框/等)大小:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22><strong>','translateY(0px)','message-bubble\x20','enableAutoMemory','”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','save-character-nai-prompts-btn','”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20评论了动态\x20#','My\x20Albums','ai-persona-group','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>','chat-list-title','inline-flex','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22','is-raw-html','split','Browser','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22','AI\x20(群聊后台)\x20尝试使用一个不存在的表情:\x20\x22','找不到匹配的表情','modify','\x20点赞了动态]','linkedMemoryCount','解析成功：通过强力提取\x20{...}\x20模式。','\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>','https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','成员们正在输入...','”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','spectator-reroll-btn','请至少选择一位收礼人。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','isBusy','clientHeight','删除动态','在PNG中找到角色数据，但解码或解析失败。错误:\x20','<p><strong>','callRecords','create-post-btn','final','检测到应用离线了\x20','confirm-witch-poison-btn','https://i.postimg.cc/50k390X8/IMG-6376.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“','票):\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','API配置','\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“','characterId','NPC\x20头像','select-all-recipients','frame_11','<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>','photoId','已成功加载外观预设：“','删除分类及表情时出错:','性能与显示设置','号玩家:\x20','一些之前的消息已被用户删除。','reading-content','-\x20**即将演唱**:\x20','update','确认替换','playMode','font','char-music-progress-bar','检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。','upload-sticker-btn','douban-min-posts-input','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','<div\x20class=\x22poll-options-list\x22>','\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','propel-btn','\x0a-\x20**内容摘要**:\x20','\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员2\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20','comments','\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>','<s>$1</s>','paste','longTermMemory','scrollHeight','https://image.pollinations.ai/prompt/','请输入一个有效的图片URL！','启用\x20NovelAI\x20图像生成','generate-shopping-items-btn','include','https://i.postimg.cc/k401K5g7/IMG-7304.jpg','模拟表情含义\x20\x22','预设名称不能为空！','chats','https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','++id,\x20chatId,\x20timestamp,\x20customName','Category','werewolf-log-entry\x20','请输入有效的总金额！','群里已经安静了\x20','contactId','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>','请为这个头像起个名字（例如：开心、哭泣）','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','API预设','收到了格式不规范的AI指令，已跳过:','color','records','--\x20点击选择\x20--','rules-tabs','https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','nai-sampler','regenerate-btn','\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22','global_css','close-persona-library-btn','douban-detail-back-btn','++id,\x20name','操作失败','readAsDataURL','https://i.postimg.cc/qRCtnMms/IMG-6145.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','isArray','streamed','”，价值','source','删除照片','[图片动态]','请先从下拉框中选择一个要删除的预设。','确认清空动态？','结束发言','utf-16le','groupAvatarLibrary','main-chat-list-header','.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！','当前时间是\x20','force-apply-check-btn','你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','今天\x20','导入备份文件','请输入有效的URL。','button','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.sticker-item.selected','reset-custom-css-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>','此操作将永久删除您选择的\x20','world-book-group-container','请为这组提示词预设命名：','World\x20Book','恭喜发财，大吉大利！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','AI方','resolve','novelai-test-btn','AI返回的change_music指令中，歌曲名无效或缺失:','Upload\x20Avatar','npcs','(无购买理由)','<span\x20class=\x22diary-messy\x22>$1</span>','请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。','Online','导出失败','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>','strategy','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>','product-editor-modal','将分类\x20“','character-phone-screen','manual-summarize-btn','选中的头像框已成功删除。','enable-ai-drawing-switch','player','isAwaitingResponse','transaction','renderQzoneScreenProxy','frame_8','\x22\x20class=\x22product-image\x22>','-\x20\x20\x20**当前时间**:','style=\x22background-image:\x20url(\x27','import-data-input','werewolf-kill-modal','Manage','simulatedConversations','doubanActiveCharacterIds','在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。','copy-post-btn','</p>\x0a\x20\x20\x20\x20','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','EPhoneWorldBookBackup',')，开始总结...','x-social-screen','📊\x20使用模型:','<div\x20class=\x22post-main-content\x22>','🔧\x20检测到Chrome浏览器，启用headers兼容性处理','棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','hasShown20','test','++id,\x20name,\x20chatId','\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20个新头像框！','\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','manage-product-categories-btn','lyrics-offset-input','aiAvatar','在打包或写入文件流时发生错误:\x20','actionCooldownMinutes','nai-gallery-item','music-player-song-title','Save','-9999px','无法找到对应的分享记录或记录已损坏。','splice','werewolf-game-over-modal','visibility','compress-images-btn','-\x20(ID:\x20','\x20的备忘录','确定要拉黑“','sticker-item','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>','礼物已成功送出！','totalPages','购物中心生成设置已更新！','transfer-action-cancel','transfer-confirm-btn','recalled_message','没有配置为后台活跃的角色，跳过模拟。','shopping-category-count-input','\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','\x20不支持。请选择6、9或12人。','upload-cphone-bg-url-btn','Character\x20Avatar','\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20','https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','border-box','https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','upload-custom-frame-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','#fullscreen-lyrics-container\x20.music-lyrics-list','post-actions-modal','”移出群聊吗？','cancel-sticker-binding-btn','existing-npc-groups-list','.qzone-post-item','https://api.minimax.chat/v1/text_to_speech?GroupId=','customName','browser-screen','cursor','已拒收对方转账','video-call-screen','\x20的动态\x20(NPC)','通话记录','ArrowRight','save-api-settings-btn','back-to-clear-step1-btn','\x0a-\x20**长期记忆**:\x20','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','\x0a#\x20你的聊天对象（用户）的人设\x0a','https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','Live\x20Preview','将清空选定角色的心声和散记历史。','Their\x20Playlist','.commenter-name','.recalled-message-placeholder','分享的聊天记录已损坏。','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x22\x20class=\x22realimag-image\x22\x20alt=\x22NovelAI图片分享\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22\x20title=\x22','584036IEDbXT','shared-history-viewer-modal','\x20被刀了\x20(你没有解药了)','流式下载ZIP失败:','https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','single-char-background-activity-group','application/json','flexDirection','\x0a-\x20散记:\x20','visibleGroupIds','change_remark_name','检查完成','is_busy','后台活动模拟已停止。','<div\x20class=\x22spinner\x22></div>','\x22\x20处于行动冷却中\x20(还剩\x20','add-my-avatar-upload-btn','a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting','char-usage-item','NEGLIGIBLE','未检测到BOM，尝试使用\x20UTF-8\x20解码...','<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>','callRequester','副API设置\x20(用于总结长期记忆)','确定要删除这条渲染规则吗？','favorites-search-input','#\x20你的社交圈\x20(绑定的NPC)\x0a','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','call-timer','\x20发起了一个投票\x20(时间戳:\x20','Rule\x20Name','disable','\x22]:checked','register','hiddenText','character_book','https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','getVotes','请输入有效的默认价格！','---\x20第\x20','【原动态内容:\x20','保存CSS预设','ai-avatar-library-grid','创建普通群聊\x20(我参与)','正在模拟“','#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked','for_timestamp','char_browser_article','[data-version]','\x20MB</strong>\x20(压缩率\x20','rule-editor-modal','网易云音乐搜索失败:','自定义通话名称','cancel-reply-btn','总结通话记录时出错:','right','chat-settings-btn','qzone-sticker-panel','frame_12','save-shopping-settings-btn','npc_','\x20\x0a-\x20**你最近和“','\x20发起了外卖代付请求，商品是“','导入世界书时出错:','对方已收款','custom-modal-body','-\x20**姓名**:\x20','countdown-date-input','我通过了你的好友申请，我们现在是好友啦！','default_positive','[发送了一条语音，内容是：\x27','\x0a\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a',')\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-gallery-controls\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-gallery-download-btn\x22\x20title=\x22下载\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M19\x209h-4V3H9v6H5l7\x207\x207-7zM5\x2018v2h14v-2H5z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-gallery-delete-btn\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019c0\x201.1.9\x202\x202\x202h8c1.1\x200\x202-.9\x202-2V7H6v12zM19\x204h-3.5l-1-1h-5l-1\x201H5v2h14V4z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22nai-gallery-name\x22>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>','&id,\x20name,\x20categoryId','remove-cphone-bg-btn','\x20\x0a#\x20社交圈与动态\x0a','https://i.postimg.cc/05DLr0yj/IMG-4427.gif','https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','add','删除成功','killedId','发送语音','撤回了一条[',')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22','upload-image-btn','\x0a\x0a\x0a\x0a\x0a#\x20可用指令列表\x0a###\x20思维链\x20(必须作为第一个元素！)\x0a-\x20\x20\x20**`{\x22type\x22:\x20\x22thought_chain\x22,\x20\x22analysis\x22:\x20\x22你对用户上一轮发言的分析...\x22,\x20\x22strategy\x22:\x20\x22你本轮的回复策略...\x22,\x20\x22character_thoughts\x22:\x20{\x22','decline','正在合并单条记录到\x20','douban-detail-avatar','来自动态','add-new-npc-group-btn','.selected-options-text','从完整链接批量导入','删除预设','》添加歌词吗？','头像和人设不能都为空哦！','pointer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20','substring','请先在API设置中配置好（主或副）API以进行总结。','。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.participant-avatar-wrapper\x20.participant-avatar','人设预设','seed','页面跳转','https://files.catbox.moe/q6z5fc.jpeg','\x22>...</div>','showRedPacketDetails收到了无效的packet对象','确定要删除相册《','扫描动态失败:','\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。','\x22\x20的后台活动开关已关闭，本次跳过。','target_timestamp','input[name=\x22visibility_group\x22]:checked','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','lastMemorySummaryTimestamp','go-to-clear-step2-btn','frame_6','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥','\x22\x20data-option=\x22','personaPresets','close-rp-details-btn','sticker-upload-input','background-activity-switch','https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','open-sticker-panel-btn','douban-comment-input','close-sticker-panel-btn','.call-record-card','EPhone-Full-Backup-Legacy-','TA的浏览器历史','product-name-input','）。]','请先输入你的发言内容。','**[投票结果]**\x20','search-result-item','nai-seed','cancel-gift-recipient-btn','karras','battery-alert-text','送给\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>','[语音]\x20内容:\x20\x22','\x0a\x0a现在，请生成新的评论。','等待回应','API\x20预设已保存！','#\x20对话示例\x0a','<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22','\x22\x20处于行动冷却中，本次独立行动跳过。','你已死亡，正在围观...','zh-CN','.werewolf-player-checkbox:checked','\x20\x20\x20正面:','customAvatarFrames','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','decision','ai-voice-id-group','https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','♪\x20歌词位置预览\x20♪','删除(通知AI)','NovelAI设置已保存！','bulkAdd','反代地址\x20(不需要添加/v1噢~)','save-theme-preset-btn','压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...','https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','edit-product-btn','<span\x20style=\x22color:\x20red;\x22>已关闭</span>','ZIP解压失败:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','worldBooks','》设定\x20(你可以将其中角色作为聊天对象):\x0a','export-world-book-btn','\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','商店空空如也，点击“管理”添加商品吧！','昨晚\x20','给你准备了一个红包','short','https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','isClosed','confirm-prophet-check-btn','gomoku-board','assistant','\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a','boxSizing','rules-content-container','countdownEndTime','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>','\x0a\x0a现在，请开始生成这组备忘录。','执行检查时发生错误:\x20','动态已删除。','group-management-modal','close-novelai-test','cphone','https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','🚀\x20发送NAI请求:','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','天\x20-\x20投票','cancelText','music-player-cover','Favorite','”准备好友申请...','frame_10','正在接收流式数据...','Fetch\x20Primary\x20Models','cart-item','”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请你对此作出回应。]','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','remove-global-bg-btn','”的长期记忆中。','.status-text','”，选项有：[','preventDefault','你们在','[+]\x20添加新条目','variations','\x20元，订单时间戳为\x20','NovelAI\x20Model','部分导入失败','找不到这个预设的详细信息。','role','\x0a---\x0a','productInfo','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','json','\x0a[图片生成失败:\x20','filter','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22','sticker-action-bar',')，内容摘要是：“','歌曲背景已更新！','发送好友申请','groupAvatar','ai-frame-tab','doubanPosts','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>','fontUrl','分类《','.lyrics-btn','poisonedId','请根据以上设定开始你的决策。','5px','》及其下的表情已成功删除。','AI被拉黑后冷静期\x20(小时)','shuoshuo','offlineMinLength','[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20','尝试直接作为图片显示...','find','</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-','修复完成！','<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20','isDragging','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>','assign-group-select','请输入有效的图片URL！','heartfeltVoice','create_memory','export-single-chat-btn','post-image-desc-group','\x20条/个','所有歌曲链接均有效，无需清理！','toLowerCase','cancel-persona-editor-btn','\x20.message-bubble\x20$1','disabled','delete-world-books-list','\x20的聊天','导入\x20Tavern\x20AI\x20世界书','ZIP\x20流生成完毕。','global-css-input','ai_image','https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...','https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','[+]\x20Add\x20New\x20Entry','\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a','onloadedmetadata','高级数据清理','字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a','Cphone','lastFailedAction','\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20','无法获取电池信息:','minimax-group-id','<option\x20value=\x22\x22>--\x20未分组\x20--</option>','repostComment','.custom-multiselect','getTimezoneOffset','https://i.postimg.cc/CKgDNYVb/IMG-5577.gif',',\x20记录数:\x20','exec','生成模拟聊天失败:','simulatedMusicPlaylist','onplay','”\x20将对你的称呼修改为\x20“','https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','product-variations-container','请AI角色们继续进行讨论。','清理后仍未找到JSON数组。','收到\x20SSE\x20数据，大小:','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','reading-library-modal','phone-screen','AI角色','photos','导出世界书时出错:','.json','textarea','</div>','text/event-stream','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>','text-image-mode-content','所有解析方案均失败！将返回原始文本。原始回复:','更换歌曲背景','anonymous','finally','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>',')\x20时出错:','独立行动冷却\x20(分钟)','poll-options-container','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','✅\x20[NAI下载]\x20三击下载功能已初始化','commenter','\x20条新消息','add-new-category-btn','prompt','confirm-vote-btn','\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a','》的歌词已成功保存！','未知NPC','</div><br>是否用这条新记忆替换掉这些旧记忆？','https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','在这里输入回复内容','music-next-btn','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','删除\x20(0)','pageX','error','naiimag','Moments','视频通话刚刚结束','close-reading-btn','用户向你发送了一张图片','ai-voice-id-input','\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','[系统提示：\x27','&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','songJson','当前通知版本\x20(','delete-group-btn','投票结果','错误：找不到该成员的个人档案。','\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','scope','.format-btn','https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','message-editor-container','.cart-item-checkbox[data-id=\x22','favorites','用户描述的照片','\x0a##\x20','。等待对方处理。]','并评论说：“','https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','transform','未知书籍','qzone_','#custom-modal\x20.custom-modal-footer','正在呼叫所有成员...','转发成功！','网易云','authorOriginalName','-\x20(暂无)','正在准备\x20','npc-editor-title','linked-memory-count','https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','”\x20绑定到...','”发送的、尚未领完的红包（时间戳:\x20','#e9ecef','发送照片','.comment-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：[','quote','frame-action-bar','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','请输入世界书的名称...','variation-product-image','-\x20**与用户的关系**:\x20你和用户(','char-music-mode-btn','所有切片已打包，开始流式下载ZIP...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>','找不到匹配的书籍','streamSaver','NPC行动失败：API未配置。','你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','totalTime','分片导出过程中出错:','selection-share-btn','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20','歌曲信息','participant-display-avatar','这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。','full','---\x20','ai-response-editor-container','publisher','char-diary-detail-content','生成模拟备忘录失败:','无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20','voiceId','my-avatar-library-grid','API\x20返回错误:\x20','没有可导出的世界书数据。','请输入新的名称（留空则恢复默认）','update_status','</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>','link-title-input','.call-message-bubble[data-timestamp=\x22','\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动。\x0a3.\x20\x20**【简洁性铁律】**:\x20每条个人记忆总结【绝对不能超过60个字】。\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我今天在群里和大家讨论了电影，感觉很开心。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我在群里和','reset-character-nai-prompts-btn','my-avatar-library-modal','browser-back-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“','一点心意','<p>♪\x20暂无歌词\x20♪</p>','add-new-group-btn','”写一篇新日记...','正在请求AI为新头像命名...','\x20(这是你的帖子)','postType',')\x20已被用户忽略或为旧版本，无需显示。','create-post-modal','offsetTop','Font\x20Settings',',\x20价格:\x20¥','\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','question','reply_content','groupHeader','对方拒绝了你的视频通话请求。','.frame-item','isAlive','pat_user','share_link','notification-avatar','share-target-list','将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。','reading-restore-btn','floor','6629076cFrFXL','preset-entries-container','font-preset-select','通话名称已更新！','没有聊天了。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22','theme','lastUpdate','”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a4.请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','从\x20JSON.data\x20中提取图片数据','<span\x20class=\x22group-name\x22>','global-custom-style','long-term-memory-screen','<span\x20style=\x22color:\x20red;\x22>未运行</span>','无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20','[转账]','[收到一个外卖代付请求]','data:','onclick','UTF-8\x20解码成功。','\x20天的讨论环节。\x0a','你们的对话刚刚还在继续。','你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','文件格式不正确，缺少关键的外观设置项。','”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20','</span><span\x20class=\x22gift-preview-quantity\x22>x','\x0a\x0a现在，请严格按照“阶段2”的指令，为所有【存活的AI角色】生成他们充满策略和博弈的发言JSON数组。','https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','\x20个表情包，且无法恢复！','secondary-model-select','后台活动模拟已启动，间隔:\x20','\x22(处理后为\x22','map','chat-group-container','将清空选定角色的所有对话消息、曾用备注和你的昵称。','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20','update-notice-confirm-btn','.poll-card','[♪\x20','https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','uncategorized','parts','[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]','contact-picker-screen','template','stringify','https://i.postimg.cc/9fQZ425b/IMG-5975.gif','<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','image/','frame_ribbon','聊了关于生日派对的事，我们约好了10月1日见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a','https://i.postimg.cc/bJDMQVkj/IMG-7112.gif',')\x20的残缺数据。','rule-editor-title','\x20行格式不正确，已被忽略。','https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','ephoneLastActiveTimestamp','已恢复默认字体。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**','sort','#product-grid\x20.product-item','group-name','<strong>','import-preset-input','(在那次','QQ音乐搜索API失败:','(你是第一个发言的人)','\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22','sticker-search-input','#data-clear-type-list\x20.clear-posts-item.selected','\x20删除了自己的一条动态]','在这里输入图片描述...','\x20\x0a-\x20存活玩家:\x20',':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>','rp-details-list',')\x20的可用表情:\x0a','https://...','manage-ai-avatar-library-btn','justifyContent','Cleanup\x20Redundant\x20Data','预设名称','确定要删除表情\x20\x22','backgroundActivityInterval','getFullYear','werewolf-player-avatar','20px','model-select','复制失败','MB)...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22','”中，用户的昵称是“','</small>','ai-frame-grid','守卫已行动，守卫请闭眼。','执行出错','EPhone-Full-Backup-','transfer-sender-name','导出已开始','regenerate-char-album-btn','musicData','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20','JSZip库未加载，请刷新页面重试','你刚刚接听了用户的视频通话请求。','apply','为NPC\x20\x22','reset-theme-btn','GRID_SIZE','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','typeId','[发送了一条语音，内容是：','”的记忆和人设，生成全新的社交动态...','\x20---\x0a','speaker_name','</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>','notification-sound-url-input','”的记忆\x20(','https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','purchases','TA的相册','collapsed','category','rule-regex-input','frame_cat_ear','cancel-advanced-editor-btn','https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','\x22>×</span>','图片\x20Blob\x20创建成功，大小:','Image\x20Generation\x20Settings','select-all-frames-checkbox','图片加载中，请稍后重试','music-current-time','\x0a\x0a#\x20你的角色设定\x0a','解析AI返回的投票JSON时出错:\x20','部分下载完成','lastActionType','无法获取模型列表','未知App','个红包，共','pin','📤\x20发送请求到\x20NovelAI\x20API','”的对话摘要**:\x0a','\x20的日记','mousemove','.nai-gallery-item.selected','诊断：在顶层\x20','语音模型\x20(Model)','流程启动','下载\x20(','https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','gameMode','add-to-cart-btn','启用后台角色活动','✅\x20动态NovelAI图片全部生成完成:\x20','member-management-item','\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a','qzone_like','waimai-timer-','对方撤回了一条消息','JSZip\x20流错误:','检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。','没有可供重新生成回复的用户消息。','\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“','”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a','timeZone','无人接听群聊邀请。','\x0a\x20\x20-\x20**人设**:\x20','myNickname','https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','.unread-indicator.back-btn-indicator','\x0a\x0a#\x20对话者的角色设定\x0a','findLastIndex','prophetCheck','正在执行完全导入，请勿关闭页面...','manual','video_call_request','abs','custom-modal-title','levelchange','werewolf-role-confirm-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','这个角色没有可用的备选开场白。','https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','删除失败','Advanced\x20Data\x20Cleanup','”的聊天记录','”量身定制的商品已上架！','</option>','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','setItem','<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20','创建旁观群聊\x20(我围观)','张NovelAI图片:\x20','https://api.vkeys.cn/v2/music/netease/lyric?id=','-\x20**昵称:\x20','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20你的首要任务是检查“待处理的帖子列表”。如果列表中有你可以回应的帖子（特别是那些有新评论或提到你的），你【必须】优先进行评论或回复，而不是发布新动态。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20','请先添加一张图片再发布动态哦！','change_music','\x22\x20决定去发一条动态...\x20(此处为模拟)','icon-setting-item','生成成功！','\x20条)','正在检查\x20','douban-screen','from','table','iVBORw0KGgo','后台活动设置','chat-header-title','<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20','清理冗余数据时出错:','收到数据，类型:','\x20的消息:\x20\x22','所有世界书数据已成功导出！','此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>','This\x20is\x20a\x20simulated\x20chat,\x20messages\x20cannot\x20be\x20sent','<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>','\x20红包已被领完，手气王是\x20','\x20个会话中。','mouseleave','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','</button>','comment','</td><td\x20class=\x22item-subtotal\x22>¥','手动创建角色','有点饿了，可以去找充电器惹','cancel-clear-posts-btn','favorite-diary-btn','AI\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','touchstart','空间设置','Chat\x20Settings','\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','sendQzoneStickerComment:\x20找不到帖子:','douban-comment-item','bg-input','\x20<span\x20class=\x22group-tag\x22>群</span>','Publish','https://i.postimg.cc/gkhf597g/IMG-6555.gif','decrease-qty-btn','**:\x20关于\x20**','frame_flower','personality','.qzone-post-delete-action','switch-to-image-mode','isMinimized','♪\x20♪\x20♪','字体预设管理','该条记录已成功删除。','.clear-posts-item','\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。','好友动态','claimedBy','）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a','\x0a<character>\x0a\x20\x20<name>','一个神秘的角色。','product-editor-title','送给了\x20','<span\x20class=\x22group-tag\x22>群聊</span>','offsetHeight','渲染器','ready','confirm-wolf-kill-btn','**内容:**\x0a','您的旧有记忆已被完整保留，未作任何修改。','文章完整内容...','请至少输入2个有效的投票选项！','EPhone-长截图-','https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','items','aiAvatarFrame','char-diary-detail-back-btn','https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','itemName','请输入有效的正整数！','https://i.postimg.cc/wMxmCZVC/IMG-7099.gif','设置已应用','未知歌手','#vinyl-view\x20#music-player-cover','\x20票</span></div></div>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>','\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22','\x20发布了一条新公告','\x22\x20style=\x22display:block;\x22>×</button>','说说内容不能为空哦！','.thought-delete-btn','AI\x20角色\x20\x22','元,\x20备注:\x20','extensions','music-return-btn','请先点击扳手图标进入管理模式，才能添加新商品。','offline-mode-toggle','werewolf-action-bar','import-appearance-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','chat-render-window-input','(暂无评论)','Binding\x20Scope','replyToDisplayName','当前为渐变色','npc-background-activity-switch','selection-soft-delete-btn','close-category-manager-btn','发现新版本通知:\x20','\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','confirm-hunter-shot-btn','product-category-select','reset-button-order-btn','delete-font-preset-btn','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>','https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','char-simulated-input','group-background-activity-switch','album-photo-input','offlinePresetId','https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','selection-mode','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','world-book-category-select','\x0a####\x20阶段\x20B：TGS\x20融合思考\x20(Task-Game-Social)\x0a1.\x20\x20**T\x20(Task\x20-\x20游戏任务)**:\x20基于我的身份和秘密，我的【逻辑目标】是\x20(例如：找出狼人\x20/\x20悍跳预言家\x20/\x20隐藏身份\x20/\x20保护队友\x20/\x20攻击','recipients','个月前','background-interval-input','\x20更换了你的头像]','[文字图]\x20','请输入你想说的话...','anime\x20person','werewolf-kill-selection-list','\x22\x20创建成功！','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','douban-wait-reply-btn','char-browser-history','<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>','persona-library-modal','shoppingProductCount','第一夜，执行本地随机刀人逻辑...','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','show-announcement-board-btn','product-category-tabs','totalAmount','publicText','基础数据不完整，无法开始总结。','matches','自动总结狼人杀游戏失败:','&id','onpause','Voice\x20Message\x20Settings\x20(Minimax\x20TTS)','presetId','#reading-window\x20.reading-header','</p>','导入外观设置','delete-world-books-modal','offline','原作者','<div\x20class=\x22post-comments-container\x22>','#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a','total-image-size-display','\x0a-\x20**角色人设**:\x20','创建世界书','negative','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','my-persona-group','photo-viewer-close-btn','.comment-delete-btn','导演模式保存了一个无效的五子棋移动指令:','profile-random-jottings','nai-default-negative','.album-art-btn','Tutorial','cfg_scale','\x0a\x0a现在，请做出你的决定。','.header','请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。','Model','.message-bubble','photo-viewer-modal','约定达成！','group_call_response','waimai-request-modal','ai-persona','time-zone-select','#custom-modal-body\x20.format-btn[data-type=\x22text\x22]','quote-message-btn','douban-post-detail-title','#outgoing-call-screen\x20.caller-text',',\x20flat\x20design,\x20simple','https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','[系统消息]\x20','API未配置，无法生成对话。','\x0a\x0a现在，请开始生成这组App使用记录。','\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a','命名头像框','new-group-name-input','++id,\x20name,\x20npcGroupId,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp','#data-clear-char-list\x20.clear-posts-item.selected','cancel-douban-cast-btn','product-grid','Storage\x20Optimization','thought_chain','#f0f0f0','update_thoughts','https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','”生成这组【与角色高度相关】的商品数据。','commentIndex','User\x20Avatar','Listen\x20Together','\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a','tencent','⚠️\x20[NAI下载]\x20图片源为空，无法下载','角色卡导入失败:','无效链接:\x20','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20','replyTo',')\x20成功抢到了\x20','promptFeedback','editable-image','https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','.playlist-item','\x22\x20触发了后台行动！','#clear-posts-list\x20.clear-posts-item.selected','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','nai-gallery-action-bar','https://i.postimg.cc/xjpN4swz/IMG-7240.gif','[系统提示：用户（','artist','Chat\x20List\x20Batch\x20Load\x20Count','packetType','thoughts','addEventListener','translateX(-','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>','nai-test-status','Chat\x20View\x20Initial\x20Load\x20Count','昨晚的死讯','数据检查与修复失败:','\x0a\x0a#\x20待整合的记忆要点列表\x0a','includes','local-song-upload-input','https://i.postimg.cc/ThMMVfW4/10.jpg','正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...','\x0a-\x20**可以刀的玩家列表**:\x20','hours','》吗？此操作将同时删除相册内的所有照片，且无法恢复。','API\x20预设管理','标题:\x20','contact-picker-list','世界书分类','确定要从播放列表中删除《','chat-interface-screen','https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','（无文字内容）','closed','<div\x20class=\x22pinned-indicator\x22>📌</div>','red_packet','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','要为《','selection-screenshot-btn','settings','font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);','15px','ai-avatar-input','</div></div>','未知会话','Save\x20All\x20Settings','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>','pending','加载更早的会话','hasShown40','<div\x20class=\x22avatar-group\x20','https://i.postimg.cc/PqYp5T5M/image.png','修改文字',';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20','加载中...','currentTarget','member-avatar-preview','确定要永久删除选中的\x20','https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“','createDocumentFragment','api-preset-select','✅\x20图片解压成功！','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','ai-original-name-group','payload','qzone','appearance','粘贴歌词','\x20张图片。','.icon-preview','import-options-modal','对方正在输入...','clear-posts-modal','display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;','MB)\x20单独超过了切片限制。','旁观群聊至少需要选择2个成员。','消息内容已复制到剪贴板。','secondaryModel','ttsCache','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','\x0a#\x20---\x20世界书设定结束\x20---\x0a','\x0a\x0a#\x20情景感知:\x0a\x20\x20\x20\x20','请输入你想说的内容：','button-order-editor','#sticker-binding-chat-list\x20.sticker-binding-checkbox:checked','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','vertical','pop','text','后台活动:\x20角色\x20\x22','new_name','.entry-content-textarea','qzone-avatar-img','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27','数据迁移完成！总共修复了\x20','bg-preview','link','memory-screen-back-btn','nai-diffusion-4-5-full','解析AI返回的JSON时出错:\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>','album-back-btn','chat-search-results-list','从\x20JSON.image\x20中提取图片数据','GeminiChatDB','load-more-btn','font-settings-screen','novelai-details','create-album-btn-page','cphone-icon-img-','remove-bg-btn','\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20','border','Import\x20World\x20Book','reset-nai-settings-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','自定义数量...','font-size-value','lineTo','linked-memory-selection','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','NPC\x20列表','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>正在计算可压缩图片大小...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>--\x20MB</span>\x0a\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','add-existing-contact-btn','selection-erase-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20','AI\x20尝试使用一个不存在的表情:\x20\x22','150','.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar','至少需要保留一条消息。','shopping-back-btn','https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','http','rendering-rules-screen','您正和「','rp-details-item','stores','memoryTimestamp','已返回我的手机','opened','AI已将新群头像命名为：“','shared-history-viewer-title','”回忆TA的相册照片...','primaryKeys','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','post_deleted_notice','px)','#f0f2f5','qzonePhotos','你们没有在读书。','-\x20**对话状态**:\x20你的上一条消息发送于\x20','<span\x20style=\x22color:\x20green;\x22>已开启</span>','最近\x2020\x20条','naiSettings','.rules-category-pane','currentText','px))','product-price-input','后台活动检测间隔\x20(秒)','preset-tabs','cache','请输入背景图片的URL','.qzone-post-container[data-post-id=\x22','https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','select-all-cart-items','</strong>\x20Tokens</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.avatar-group','数据已成功合并！应用即将刷新以应用所有更改。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','wolfKill','未知设定的角色','12p','renderWorldBookScreenProxy','AI\x20尝试赠送一个格式不正确的随机礼物:','”，内容是：“','heartfelt_voice','nai-uc-preset','[系统提示：你于时间戳\x20','https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','close-sticker-category-manager-btn','isGameOver','请至少选择一个要清理的角色。','send-direct-packet-btn','AI返回的刀人目标格式不正确。','showWaimaiDetails:\x20找不到消息或消息类型不正确','导演模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','confirm-share-target-btn','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','暂无内容...','\x20\x20\x20promptSource:','isSpectatorGroup','此操作会将选定的\x20','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','activeAlbumId','toLocaleString','https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','确定要删除这条长期记忆吗？','qzone_post','import-new-book-btn-header','\x20是我的重要互动对象（用户）。\x0a','”)下发送了一个表情评论，意思是：“','change_user_nickname','请稍候','你正在阅读的段落','1024x1024','my-nickname-input','is-acting','模型列表已更新','提示词配置','frame_13','获取更新通知文件失败。','npc','characterName','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg','帖子详情','gameLog','data-lang-key','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。','char-wallet-screen','fillRect','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','所有通话记录','没有找到可导入的内容。请检查您粘贴的格式是否正确。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>','AI生图功能已','thought-card','确认拉黑','/v1/models','authorAvatarPrompt','\x0a\x0a#\x20待总结的群组视频通话记录\x0a','这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？','3445POvpnF','{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20','已取消收藏。','animate-like','https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','#douban-cast-list\x20.douban-cast-checkbox:checked','\x20的红包，金额为\x20','\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20','set','caller-avatar','char-music-item','\x20\x20\x20characterNegativePrompt:','\x20\x20\x20\x20\x20\x20-\x20','请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22','AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:','create-shuoshuo-btn','Data\x20Check\x20&\x20Repair','draggable','startDiscussion','createElement','reply-preview-bar','image_post','请输入有效的字体URL。','clear-search-btn','Long-term\x20Memory','<option\x20value=\x22','表情含义','📁\x20从本地上传','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20','closest','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','NPC\x20Avatar','7122qHAJwx',')，祝福语是：“','**关键词:**\x20','cancel-shopping-settings-btn','https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','https://image.novelai.net/ai/generate-image-stream','swipeDirection','AI已将新头像命名为：“','[表情]\x20含义:\x20\x22','点击下方上传','manage-groups-btn','https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','\x0a-\x20**世界书设定**:\x20','friend','variation-options-container','confirm-final-clear-btn','\x20分钟)</span>','正在等待AI角色们继续讨论...','gift-receipt-body','请输入\x20歌名\x20或\x20歌名-歌手','renderApiSettingsProxy','**[讨论环节]**\x0a','0:00','shopping-action-bar','\x20首歌曲...','open-nai-gallery-btn','remove-ephone-bg-btn','</span></div><div\x20class=\x22rp-type\x22>','cphone-icon-settings-grid','character_persona','fullscreen-active','accept-friend-btn','不支持的分享类型。','删除\x20(','AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。','preset-persona-input','容错解析：策略2成功\x20(提取了summary字段内容)','++id,\x20title,\x20lastOpened','\x20(角色)</label>','原始消息已删除或不存在','\x20天\x20---**\x0a','https://i.postimg.cc/qB9zbKs9/20.jpg','limit','请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。','请至少选择一个要添加的联系人。','送给了大家一份礼物','unshift','originalTimestamp','announcement-action-pin','trans','”。请你回顾一下刚才和“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22><strong>\x20','转账:\x20','\x20分享了一张NovelAI图片，prompt:\x20','\x22\x20更换了头像','lyrics-active','CELL_SIZE','无法找到当前角色的数据。','分类\x20“','继续讨论','<div\x20class=\x22post-images-grid\x20grid-','notification-content','ceil','Taobao','请输入歌曲的URL','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','确认清理','fontSize','assign','\x20\x20\x20\x20-\x20我的毒药：','这将用备份文件中的数据【完全覆盖】当前与“','精炼长期记忆时出错:','死亡了','.icon-setting-item','search-history-btn','clear-chat-btn','群聊已建立...','share-link-btn','批量导入头像框','https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**','encode','.entry-content-container','确认清理无效歌曲？','请输入新的图片URL：','send-poll-btn','请根据以上设定，立即做出你的决定。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','timerId','showScreen','\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20','上一条消息的发送时间是\x20','close-receipt-btn','notificationSoundUrl','participant-avatars-grid','call-message-bubble\x20ai-speech','请先选择要删除的商品。','狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20','我们和好吧！','完成(','chat-list-item','这将把您选择的数据【添加并覆盖】到现有数据中。同ID的数据将被更新，新数据将被添加。<br><br><strong>此操作不可撤销！</strong>','请开始总结。','SAFETY','wallpaper','close-npc-group-manager-btn','.post-nickname','shopping-settings-modal','.music-player-window','）完成了支付。此订单已关闭，其他成员不能再支付。]','fullscreen','https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','voice_message','\x20\x20\x20\x20-\x20我昨晚用解药救了\x20','gomoku-overlay','https://files.catbox.moe/','image','manage-products-btn','offline-preset-select','”的购物习惯...','member-editor','spectator-propel-btn','3.\x20\x20**我看到的公开信息\x20(所有人可见)**:\x0a\x20\x20\x20\x20-\x20**昨晚事件**:\x20','”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','post-upload-local-btn','start','getTime','无法解析预设文件。\x0a错误:\x20','确定要退出当前这局狼人杀吗？游戏进度将不会被保存。','请输入相册名称','statusText',')\x0a\x0a####\x20阶段\x20A：数据输入\x20(Data\x20Input)\x0a1.\x20\x20**我的秘密身份**:\x20我是【','enableAiDrawing','douban-detail-comments-list','正在导入表:\x20','你赢了','请根据角色列表，生成豆瓣小组帖子。','tagName','Post','\x20的已删除动态','timestamp',']\x20的正则表达式无效:','Caching\x20rendering\x20rules\x20for\x20chat:\x20','end','\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20','\x22\x20class=\x22avatar\x22>','\x0a#\x20你的任务\x0a你就是角色“','chatListRenderWindow','新建备忘录','input[name=\x22visibility\x22]','正在合并\x20','clientX','预设导入失败:','world-book-editor-title','is-ai-image','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22','persona-library-grid','draggable-button-item','\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22','auto','realimag','合并成功','来自与\x20','聊天记录','children','”的转账。]','App\x20Usage\x20Log','请输入一个有效的、未来的日期！','请输入有效的金额！','分享新鲜事...','isDeleted','[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','为了确保所有数据同步，建议立即刷新页面。','诊断：在\x20extensions.character_book\x20中找到世界书。','activeBookId','https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','已成功收藏到“我的收藏”页面！','</name>\x0a\x20\x20<persona>','.delete-block-btn','list-item','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','put','总结成功','✅\x20图片转换成功！🎨','novelai-enabled','[发送了一张图片，描述为：','quote_reply','网易云音乐API未返回有效结果:','\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','day','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“','[系统提示：你接受了“','\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a','导演/编辑模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','check-and-fix-data-btn','transfer','8iPBFQu','所有解码尝试均失败:','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>','(这张照片没有描述)','”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','presetCategories','music-time-counter','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','cleanup-data-btn','notification-sound-player','NEGATIVE_INFINITY','.qzone-post-container','\x20行的格式不正确，已被系统跳过。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','a\x20beautiful\x20scene','horizontal','https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','确定要删除预设\x20“','此操作将永久删除\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','toISOString','sticker-category-tabs','danger-option','#chat-messages','https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','❌\x20NAI图片生成失败:','npcGroups','scroll','<div\x20class=\x22source\x22>','my-avatar-upload-input','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','save-nai-settings-btn','\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20','✅\x20NAI提示词：使用系统配置','无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20','[图片]','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>','lyricsPosition','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>','这是模拟对话，无法发送消息','greeting','无结果','delete-selected-nai-gallery-btn','paused','lastOpened','char-vinyl-container','test-sound-btn','add-world-book-btn','.com/','转账已被拒收','退款来自\x20','</span>','\x22\x20发布了动态','.edit-memory-btn','https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif','user','❌\x20动态NAI图片生成失败:','🖼️\x20[NAI下载]\x20检测到三击NAI图片','-\x20\x20\x20**NovelAI真实图片分享\x20(在聊天中直接发送)**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20-\x20**【绝不能暴露是novelai生成的图片！】\x0a\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20-\x20使用场景：当你想要在【私聊对话中】直接给用户发送一张图片时使用。\x0a\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。\x0a\x20\x20\x20\x20-\x20注意：这会直接在聊天记录中显示图片，而不是发布到动态。','<em>$1</em>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','加载预设详情时发生错误:\x20','本日核心议题','create-new-member-btn','nai-custom-proxy-url','识图优化：正在将时间戳为\x20','播放失败，请检查URL是否正确或浏览器是否支持该格式。','》\x0a\x20\x20\x20\x20-\x20**','\x0a-\x20**你的长期记忆**:\x0a','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','add-my-avatar-url-btn','Appearance','</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥','导入成功','character-nai-prompts-modal','删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？','关联的角色\x20(NPC会去评论这些角色的动态)',')，并在对话中自然地体现出来。','狼人杀AI讨论生成失败:','\x0a}\x0a}','已被用户删除','bubble_theme','你们没有在听歌。','API为空回，角色\x20\x22','import-btn','select-all-world-books-for-clear','\x20天\x20---','chatData','确认删除分类','members','<img\x20src=\x22','添加\x20NPC','close-reading-library-btn-header','\x20的动态\x20(用户)','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20','char-music-list','Edit\x20Preset','gift','.nav-item[data-view=\x22qzone-screen\x22]','\x0a##\x20---\x20关于“',']。目前投票的人有：',')。操作已被拦截。','确认送出礼物','reading-library-list','Edit\x20Entry','📥\x20图片下载中...','close-announcement-board-btn','合并失败','cancel-product-editor-btn','#search-results-list\x20.music-search-checkbox','结束投票','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','accept','#chat-list-bottom-nav\x20.nav-item','\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！','touchmove','my-avatar-group','导入失败','variation','accept_transfer','world-book-name-input','表情分类','post-image-preview','chatId','favorite-memo-btn','】。\x0a2.\x20\x20**我掌握的秘密信息\x20(仅我可见)**:\x0a','删除失败，请查看控制台错误信息。','linkedWorldBookId','confirm-create-countdown-btn','一起听',')的阅读进度失败:','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','anyOf',')\x20为\x20','repost-modal','shoppingCategoryCount','请开始整合。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>','清空购物车','margin','cancel-delete-world-books-btn','无备注','.post-mode-switcher','-\x20\x20\x20**NovelAI图片分享**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22name\x22:\x20\x22你的角色名\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20【禁止暴露这是novelai生成的图片!】\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20使用场景：当你想要基于当前对话情景、你的性格或上下文分享一张图片时使用。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。','apiTemperature','导演模式悔棋：已撤销AI在\x20(','active','all','generativelanguage','生成失败:\x20','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“','Content-Type:','开始检查并迁移旧的红包数据...','聊天记录已成功分享到\x20','ruleId','...”)','add-group-avatar-upload-btn','panelEl','https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','normal','data-clear-step-2','add-group-avatar-url-btn','nextSibling','latestTimestamp','\x20→\x20','搜索歌曲','chat-at-mention-popup','切片\x20','\x0a#\x20世界观设定\x20(必须参考)\x0a','setHours','Http_Get_External','跳过一个无效的JSON片段:','💾\x20[专属弹窗]\x20保存角色NAI提示词','https://','容错解析：策略1成功\x20(找到并解析了完整的JSON对象)','char-usage-screen','group-members-group','\x20的对话','qzoneAlbums','当前群聊还没有公告哦。','handlePacketClick','编辑动态','Playback\x20error:','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a','participants','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','event_type','char-music-player-modal','gameover','image/png','offline-mode-options','https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','[系统提示：你刚刚成功将对用户的称呼修改为了“','天亮了。','配置错误','char-audio-player','标题是必填项哦！','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20','strokeStyle','Their\x20Browser\x20History','update-notice-body','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','add-selected-music-btn','werewolf-witch-modal','preview-font-style','\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a','强力提取\x20[\x20...\x20}\x20...\x20]\x20失败，将尝试提取单个对象...','spinning','动态发布成功！','对方已拒收','https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','\x0a##\x20---\x20来自','-\x20(空)','edit-message-btn','”\x20将备注修改为\x20“','确认操作','”吗？','hasShown10','querySelectorAll','message-actions-modal','add-new-sticker-category-btn','\x22\x20尝试执行未知的后台动作:','Their\x20Album','】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22','local','npc-group-manager-modal','qzone_comment','回复\x20','clientY','送出礼物','狼人请选择刀人对象','rule-card\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','group-members-settings','post-image-preview-container','请所有AI角色开始投票。','已选择\x20','setup','\x20首歌曲。','更新通知文件中缺少\x20data-version\x20属性。','确定要删除《','https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','rp-content-direct','price','\x20条无效的','caller-name','#\x20角色核心设定\x0a','\x20的外卖代付请求（时间戳:\x20','”的网上冲浪足迹...','https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','world-book-card','预言家','\x0a\x20\x20\x20\x20','豆瓣设定','\x20已满\x20(大小:\x20','https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20','NAI\x20Image','custom-bubble-style','music-search-results-modal','lyrics-vertical-pos','ai-avatar-preview','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','一键压缩本地图片','\x22\x20的独立后台活动开关已关闭，本次跳过。','product-image-preview','nai-diffusion-4','selection-count','\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>','voteResults','\x22\x20data-commenter-display-name=\x22','思考中...','[你发送了一条语音消息，内容是：\x27',':</span>\x20','https://i.postimg.cc/28TsrxRV/IMG-6852.gif','minimaxModel','member-management-list','group-action-cooldown-input','edit-call-message-btn','cancel-share-target-btn','readingLibrary','https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','member-management-screen','annoId','天\x20-\x20夜晚','\x20被怀疑了，虽然我的逻辑也怀疑TA，但我的表演必须是维护TA的：“我不觉得','https://i.postimg.cc/43PhvxRq/IMG-6922.gif','IMG','image_url','https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','AI返回了空内容或未知格式。','正在为所有AI角色生成并注入游戏记忆...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','minimaxVoiceId','existing-group-item','appendChild','</span><span\x20class=\x22poll-option-votes\x22>','\x20个自定义头像框吗？','char_book','\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','\x20邀请你加入群视频','char-music-next-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>','导入\x20Tavern\x20预设','endsWith','nai-test-negative','(Timestamp:\x20','最近支出','authorId','translateY(-20px)','\x22\x20自动触发AI响应...','poll-question-input','douban-settings-modal','群里还没有任何消息。','文件格式不正确，这不是一个有效的单聊备份文件。','https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif',']类型的消息','https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','load-more-thoughts-btn','https://i.postimg.cc/pddJj9zN/IMG-7094.gif','https://i.postimg.cc/XY63sTS3/IMG-4393.gif','call-transcript-modal-body','我已了解风险，确认压缩','char-product-grid','char-usage-list','remove','\x20的外卖订单支付了\x20','create-poll-modal','不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。','time-perception-toggle','\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','poisonUsed','.loader-container','group-background-activity-group','...','delete-api-preset-btn','activePostId','\x20个商品吗？此操作不可恢复。','请根据你的设定，生成你的日记内容。','qzoneGroups','back-to-list-btn','.quoted-message','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x22>画廊还是空的，快去生成一些图片吧！</p>','conversationIndex','❌\x20[NAI下载]\x20下载失败:',')，问题是：“','is-red-packet','close-character-nai-prompts','你撤回了一条消息','Type\x20a\x20message...','“全部”分类无法被绑定。','\x20\x20\x20characterPositivePrompt:','npc-action-cooldown-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。','close-call-transcript-btn',')\x20作者:\x20','cancel-share-link-btn','\x27刚刚在你的动态“','add-new-product-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>','music-visual-container','生成设置','一位神秘的NPC','linked-chats-checkboxes-container','无法找到分享记录:','GBK\x20解码成功。','chatItem','-\x20**对话状态**:\x20上次互动于\x20','https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','.screen.active','.poll-option-input','合计:\x20¥','repost','https://i.postimg.cc/jCVK0fGL/IMG-6890.gif','...\x22)','appName','<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>','\x20(概率:\x20','容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...','生成的图片URL:','.sticker-item','**[夜晚]**\x20平安夜。\x0a','novelai-model','下载图片失败:\x20','#e7f3ff','请输入要精炼的最近记忆条数\x20(最多\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>','\x20是同一个分组的好友。\x0a','stickerCategoryIds','https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','regenerate-char-browser-btn','fill','currentPage','load-more-qzone-btn','》设定:\x0a','正在生成“','AI们的茶话会','voice-message-btn','\x20向\x20','文件不是一个有效的PNG。','\x20本世界书已成功删除。','）刚刚拍了拍你（','，TA的身份是：【','#data-clear-char-list\x20.clear-posts-item','chat_message','douban-cast-modal','\x20首歌曲的详细信息...','waimai_order','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','imageIndex','\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20','获取AI狼人目标失败:','\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20','search-results-list','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','confirm-merge-import-btn','”的好友请求','\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)','\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>','所有音乐源都未能找到歌曲：“','chat','件商品','.link-share-card[data-timestamp]','.custom-multiselect\x20.select-box','1px\x20solid\x20#e0e0e0','select-all-types-for-clear','查看失败','<input\x20type=\x22checkbox\x22\x20value=\x22book_','Upload','character-grid','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','请输入你想对“','playlist','import-single-chat-btn','style','（当前帖子还没有路人NPC发表评论。）\x0a','正在扫描和修复数据...','cancel-werewolf-lobby-btn','gbk','你们正在一起听歌，','确定要清空当前角色的NAI提示词配置吗？','worldBookCategories','（无有效对话记录）','innerHTML','#chat-interface-screen\x20>\x20.header','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','isPlaying','open-reading-library-btn','正在执行清理操作，请不要关闭页面...','associatedWith','frame_9','qzone-screen','number','groupNickname','LOW','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>','photoCount','currentPhase','通话记录已删除。','preview-bubble-style','\x0a###\x20条目:\x20','mouseup','default','click','char-music-player-title','group-avatar-library-title','checked\x20disabled','正在请求“','\x20中聊天','waimai_request','\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。','\x20你们之间已经有**','mes_example','Appearance\x20Settings','已打包表:\x20','save-douban-settings-btn','\x0a-\x20**你最近和“','beginPath','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','https://www.myinstants.com/media/sounds/notification-sound-2.mp3','rejected','.loading-spinner','catch','https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','char-music-progress-fill','close-char-music-player-btn','请输入歌名','请输入一个\x202\x20到\x20','在此修改，或点击上方按钮使用格式模板...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>','用户刚刚接听了你主动发起的视频通话。','change-frame-btn','NAI_Image','wb_','.entry-enabled-switch','recipientName','转发了\x20@','group-avatar-preview','member-name-input','width','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。','”思考后决定暂时不发送好友申请，将重置冷静期。','正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。','✅\x20NAI图片','createdAt','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','自定义数量','创建ZIP流时出错:\x20','332586mPvynK','Delete\x20(Notify\x20AI)','请先填写NovelAI\x20API\x20Key！','safetyRatings','char-music-play-pause-btn','share-target-modal','transfer-modal','AI女巫决策：今天是第','https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','arrayBuffer','Remove','reverse','TA的淘宝订单','所有图片已准备就绪，正在流式压缩...\x20下载将自动开始。','switch-greeting-btn','https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','sharedHistory','###\x20最终结果:\x20','\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>','###\x20玩家身份配置:\x0a','https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20','getPropertyValue','请输入想跳转的页码\x20(1\x20-\x20','https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','inject-thought-toggle','你已经死亡，无法发言。请等待其他玩家发言结束。','data-voice-id=\x22','video-call-main','https://i.postimg.cc/13hhJ77p/IMG-4419.gif','https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','candidates','nai-resolution','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','moveTo','href','渲染聊天项\x20[','change_group_name','authorName','你们已经有','豆瓣设置已更新！下次重新生成时将生效。','Enable\x20Rule','temp_group_chat','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','browser-title','还没有可供编辑的AI响应。请先让AI回复一次。','\x20的对话\x20(只读)','gift-recipient-modal','manage-frames-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>','篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','link-content-input','startY','聊天会话','<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>','note','block','此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？','.comment-input','未知的分享卡片类型:','你拍了拍\x20“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','[系统提示：你刚刚成功将自己的备注名修改为了“','temp_npc_chat','检测到好友申请待处理状态，为角色\x20\x22','group','messageTimestamp','next-page-btn','\x22的角色（你的本名是\x22','isActive','linesPerPage','https://i.postimg.cc/RZNLhbbr/IMG-4389.gif','无法从\x20SSE\x20响应中提取图片数据','\x0a\x20\x20\x20\x20-\x20**社交**:\x20\x0a','dead','数据库写入失败:\x20','\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20','生成模拟歌单失败:','ZIP文件内容:','找不到这本书！','choice','未知表情','world-book-tab\x20active','正在等待AI角色们进行激烈的讨论...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22','prototype','isOfflineMode','\x0a-\x20**身份**:\x20','「在这里输入对话内容」\x0a(在这里输入动作或环境描写)','”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','由于浏览器安全限制，AI切换的歌曲无法自动播放。请手动点击播放按钮\x20▶\x20继续欣赏。','ai-original-name-input','reset-global-css-btn','https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','label','legacy','请选择一个接收人！','你查验的玩家\x20','rule-chat-id-select','newSize','transparent','update-notice-modal','\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“','https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg','https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','.favorite-item-card','animationend','名为\x20“','检测到视频通话请求，为角色\x20\x22','selection-cancel-btn','custom-css-input','https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','清理失败','classList','posts','close','未知设定的NPC','#f44336','NovelAI生成失败:','\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a','错误：找不到要删除的分类。','见面”）。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过100个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','minimized','confirm-contact-picker-btn','文件应用失败:\x20','getAttribute','语言已切换，页面即将刷新以应用更改。','select-all-products-checkbox','.message-wrapper','++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','App记录','<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>','edit-post-btn','backgroundColor','frame_7','simulatedAlbum','cancelable','prophet','未知作者','。你可以使用\x20\x27vote\x27\x20指令参与投票。]','\x0a-\x20**','toLocaleTimeString','photo-viewer-prev-btn','clientWidth','请根据你的设定，生成你的备忘录内容。','Content\x20Entries','(空)','models','请至少选择一种要清理的数据类型。','token-count-display','authorChatId','-\x20用户的QZone昵称是\x20\x22','请输入投票问题！','notification-bar','lrcContent','删除分组后，该组内的好友将变为“未分组”。确定要删除吗？','https://corsproxy.io/?','language-select','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','lyrics-btn','bg-clear','innerText','NovelAI\x20模型','现在，请所有AI角色针对刚刚的发言（特别是\x27','https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','supportedValuesOf','pending_ai_approval','狼人杀','onload','import-card-input','summaries','44821DSzjCk','等待对方处理...','请输入提示词！','chat-list-action-cancel','\x20[社交背景:\x20','预言家请睁眼，请选择要查验的玩家。','网络请求失败:\x20','currentLyricIndex','direct','currentDay','lang','<br>','请至少选择一个要删除的世界书。','margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','height','\x0a\x20\x20\x20\x20-\x20**书名**:\x20《','renderChatListProxy','App使用记录','请选择一个目标。','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>','日\x20---','\x20为\x20','Renderer','女巫请睁眼。','novelai-settings','getMinutes','blockCooldownHours','uc_preset','secondaryApiKey','保存所有外观设置','\x20拍了拍我','找不到相册:','规则名称和正则表达式不能为空！','theme-default','无标题','.png','gift-recipient-list','sticker-category-tab','使用解药救TA','绑定范围','\x22\x20的独立行动API返回为空或格式不正确，本次跳过。','导演模式保存(Sticker):\x20使用了\x20meaning\x20查找','游戏结束，开始自动总结并注入记忆...','shoppingProducts','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',')\x20刚刚投票给了\x20“','未知错误','blockedTimestamp','\x22\x20点赞了动态\x20#','NPC\x20昵称','公用\x20(所有角色)','<p\x20style=\x22font-size:12px;color:#888;\x22>','waimai-amount','99oUbTxu','text_image','avatar_prompt','\x22\x20被唤醒，准备独立行动...','生成模拟日记失败:','keyword-search-input','确定要永久删除分类\x20“','MB)，正在归档...','设置群名','请输入群聊的名字','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>','\x20元</div>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','置顶聊天','\x0a#\x20用户的角色\x0a-\x20**','frame_tech','photo-viewer-image','”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','focus','用户\x20(','ai-cooldown-group','close-my-avatar-library-btn','werewolf-','persona','rp-direct-amount','https://i.postimg.cc/xTk5xN49/IMG-7233.gif','chat-header-status','无法生成新回复:\x20','\x20张图片。有\x20','，点击查看</div></div>','主API和副API均未配置或配置不完整。','\x20之间的有效数字。','”的身份，开始你的回忆梳理与精炼。','AI决策','isFullyClaimed','提取的图片大小:','add-npc-btn','.sender','maxMemory','album','nai-cors-proxy','AI的五子棋移动指令包含无效坐标，已忽略:','then','start-werewolf-game-btn','char-memo-screen','persona-editor-title','文章详情','导出数据','字体预设已保存！',')。详情:\x20','\x20其中包括以下投票：','avatar-frame-modal','Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined','\x27的发言）继续进行讨论。','确定要删除这个人设预设吗？此操作不可恢复。','AI返回的内容中未找到有效的JSON数组结构\x20(`[...]`)。','\x20的代付请求','[系统提示：你刚刚主动拉黑了用户。]','toggle','ephone-theme','您的分片备份已开始下载。解压后，您可以使用“导入”功能，选择其中的\x20`slice_X.json`\x20文件进行增量恢复。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22\x20style=\x22color:\x20red;\x22>计算出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','doubanMaxPosts','all\x200.3s\x20ease','胜负未分','imageUrls','key','应用已切换到后台，记录当前时间。','offsetParent','.countdown-card\x20.timer','lyrics-horizontal-pos','getItem','聊天列表每次加载条数','请输入新的背景图片链接','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>','Bilibili','group-avatar-library-grid','confirm-full-import-btn','.nai-gallery-download-btn','确认生成','\x20条记忆精炼为\x201\x20条核心记忆！','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','正在合并数据，请勿关闭页面...','Bad\x20control\x20character','transcript-modal-title','AI女巫决定使用解药！','AI\x20尝试评论一个不存在的表情:\x20\x22','[ERROR:\x20','\x20发布)\x0a','\x22\x20data-poll-timestamp=\x22','未知发送者','\x0a\x0a现在，请生成这份歌单。','-\x20**','userStickers','[系统提示：用户打开了五子棋棋盘，游戏开始了。]','（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a','blob:','AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','\x20的浏览记录','reject-friend-btn','内容加载失败...','add-new-product-category-btn','push','werewolf-user-input','share_card','检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22sticker-binding-checkbox\x22\x20data-chat-id=\x22','\x20元。','size','\x27);\x22','\x0a-\x20','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>','🎬\x20推进剧情','导演模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','transfer-action-accept','speech','请为这个新头像命名','保留旧的','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>','删除评论','blocked_by_ai','radio','[系统提示：用户加入了通话]','groupName','offsetX','无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20','https://i.postimg.cc/wjH180kn/IMG-5566.gif','true','#char-chat-list\x20.chat-list-item','请稍候...','\x0a#\x20待总结的对话历史\x0a','recordId','cancel-call-btn','文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。','\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20','targetDate','#\x20你的互动对象\x20(用户和其他角色)\x0a','传统导出\x20(兼容旧版或内存小的浏览器)','forEach','错误：找不到要转发的原始动态。','\x0a\x0aAI原始返回内容:\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','公告已发布！','date-separator','.rules-tab','unreadCount',')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a','AI返回的数据不是一个数组。原始返回:\x20','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','enableBackgroundActivity','werewolf-role-modal','nai-gallery-panel','char-browser-item','”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a','导入外观设置时出错:','werewolf-game-screen','\x0a-\x20角色思考:\x20','API未配置，无法生成内容。','<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27','请先选择要下载的图片。','导出成功','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','.message-bubble[data-timestamp=\x22','Asia/Shanghai','lrc-upload-input','#52c41a','API\x20设置','target','每晚可以查验一个玩家的身份是好人还是狼人。','rp-details-summary','自动总结成功：已成功添加\x201\x20条新的长期记忆！','App\x20Usage','blocked_by_user','char-chat-list','total','readAsText','批量导入头像','Favorites','在这里输入语音内容','-\x20清理了\x20','[系统提示：','#post-public-text','CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。','rp-details-sender','导演模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','voice','\x22)\x20为键的内心独白。\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','charCodeAt','werewolf-role-name','精炼完成，请确认','reset-font-btn','novelai-settings-modal','isOpen','\x20被投票放逐。','-selection-list','enabled','静音音频已启动，用于后台活动保活。','char-browser-article-screen','chat_','请输入精炼后核心记忆的大致字数：','<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>','.battery-text','chat-list-screen','\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','删除世界书','https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','blockReason',',\x0a\x22data\x22:\x20{\x0a','\x20转账\x20','entries','delete-product-btn','isUserParticipating','</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','favorites-search-clear-btn','dark','handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。','...\x22):\x20','pending_system_reflection','POST','✅\x20找到\x20final\x20事件的图片数据','post-public-text','bulkDelete','content','padEnd','rules-category-pane','startTime','播放被中断，这是正常行为:','未知的备份类型。','rp-direct-total','length','测试生成','确定要删除这条公告吗？此操作不可恢复。','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>','pending_user_approval','最近\x20100\x20条','div','Enable\x20NovelAI\x20Image\x20Generation','\x20\x20-\x20你评论说:\x20','确认抹除','books','manage-my-avatar-library-btn','confirmButtonClass','name','你已收款','chat-list-action-pin','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22','speaker','secondary-proxy-url','API设置','favorites-list','sticker-binding-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20','currentX','padding','操作成功','\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20','is-link-share','https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','cart-screen','女巫已行动，女巫请闭眼。','Add','single-lyric-display','save','\x22\x20class=\x22participant-avatar\x22\x20title=\x22','unread-indicator','\x27\x20在你的动态(ID:\x20','”的参考记忆','正在根据“','member-settings-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url(','send-btn','请输入一个有效的数字（建议大于20）。','”。]','my-persona','characterNegativePrompt','placeholder','Rendering\x20Rules','fileType','\x0a-\x20**最近对话摘要**:\x0a','voter_name','将清空选定角色的所有动态、评论和点赞。','在这里输入文本...','图片已更新！','label[for=\x22','小时前','保存成功','删除商品','这是字体预览效果，12345。','charging','\x22\x20创建了一个新约定:',':</strong>\x20','\x22><div\x20class=\x22member-name\x22>','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','确定要删除与\x20\x22','parentNode','(无内容)','decode','skipped','char-album-screen','\x20的所有动态，且无法恢复！',')。\x0a2.\x20\x20**G\x20(Game\x20-\x20游戏互动)**:\x20针对【今日讨论】中\x20','chatRenderWindow','resume','existing-product-categories-list','https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','reading-window','当作\x20ZIP\x20文件处理...','\x20[包含','检测到AI执行了动态操作，立即刷新好友动态页面。','<span\x20class=\x22offline-description\x22>','更换图片','[收到一笔转账]','system','productId','正在分析“','character_thoughts','write','character-nai-prompts-btn','announcement-board-modal','url','pinned','-\x20用户在你们共同所在的群聊中的昵称如下：\x0a','分钟前','AI\x20发言失败','操作失败:\x20','编辑人设预设','favorite-article-btn','\x0a---\x20复盘结束\x20---','secondaryProxyUrl','选择精炼范围','char-main-time','gridEl','\x20首无效歌曲:\x0a\x0a-\x20','未找到\x20chatID:\x20','</span></div>','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','以外的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a','parentElement','slice_','upgrade','Primary\x20API\x20Settings\x20(for\x20Chat)','备忘录','游戏结束','⚠️\x20NAI提示词：没有角色，使用系统配置','call','play','921050DsAuTy','cancel-douban-settings-btn','群聊通话中没有找到可作为总结主体的AI角色。','已删除最后一条心声，当前心声已重置。','remove-member-btn','小组风格','输入图片URL','检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>','正在接通...','等人的礼物','确定要从【聊天记录和动态】中永久删除这\x20','创建群聊','nai-download-btn','chat-messages','https://api.vkeys.cn/v2/music/tencent?id=','save-world-book-btn','add-product-variation-btn','<em>','”\x20已成功导入！','在同时执行两个函数时出错:','onloadend',')，接收人是“','favorites-view','.ai-generated-image','添加网络歌曲','removeEventListener','startsWith','variation-decrease-qty','用户删除了自己的评论，开始清理AI记忆...','通话中，','add-persona-preset-btn','status','preset_','isBgClear','change_user_avatar','\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a','\x22></div>','\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>','AI女巫决定使用毒药，目标是:\x20','编辑规则','postId','\x22\x20data-commenter-original-name=\x22','编辑消息','pat-btn'];_0x5f43=function(){return _0x49a356;};return _0x5f43();}document[_0x2cf84d(0xd85)](_0x2cf84d(0x6f3),()=>{const _0x204348=_0x2cf84d;document['addEventListener'](_0x204348(0x8ca),()=>{const _0x1bf901=_0x204348;document[_0x1bf901(0x1461)]===_0x1bf901(0x67d)&&(console[_0x1bf901(0x7d1)]('应用已返回前台，正在检查更新...'),navigator['serviceWorker'][_0x1bf901(0xcdd)][_0x1bf901(0x1260)](_0x45fdb3=>{const _0x403b6c=_0x1bf901;_0x45fdb3[_0x403b6c(0x938)]();}));});function _0x5d73db(_0x302f54,_0x5d2d01,_0x555348,_0x3616a){const _0x4b9716=_0x204348,_0x145078=_0x42f206[_0x4b9716(0xf0)][_0x4b9716(0xfdf)]||0.8,_0x1eab60={'user':_0x4b9716(0xf86),'assistant':_0x4b9716(0x49b),'system':'user'},_0x1cb8c6=[{'role':'user','parts':[{'text':_0x555348}]},{'role':'model','parts':[{'text':_0x4b9716(0x74c)}]},..._0x3616a[_0x4b9716(0xbf6)](_0x11a88e=>{const _0x5d922f=_0x4b9716,_0x16d87e=[];return Array[_0x5d922f(0x971)](_0x11a88e[_0x5d922f(0x1316)])?_0x11a88e[_0x5d922f(0x1316)][_0x5d922f(0x12c2)](_0x156ee0=>{const _0x3fd20d=_0x5d922f;if(_0x156ee0[_0x3fd20d(0x259)]===_0x3fd20d(0xdd5))_0x16d87e[_0x3fd20d(0x129e)]({'text':_0x156ee0['text']});else{if(_0x156ee0['type']==='image_url'&&_0x156ee0[_0x3fd20d(0x1072)]&&_0x156ee0[_0x3fd20d(0x1072)][_0x3fd20d(0x1377)]){const _0x54b4a=_0x156ee0[_0x3fd20d(0x1072)][_0x3fd20d(0x1377)],_0x270964=_0x54b4a['split'](',')[0x1],_0x2e4421=_0x54b4a[_0x3fd20d(0x41c)](/^data:(.*);base64/);_0x2e4421&&_0x270964&&_0x16d87e[_0x3fd20d(0x129e)]({'inline_data':{'mime_type':_0x2e4421[0x1],'data':_0x270964}});}}}):_0x16d87e['push']({'text':String(_0x11a88e[_0x5d922f(0x1316)])}),{'role':_0x1eab60[_0x11a88e[_0x5d922f(0xaeb)]],'parts':_0x16d87e};})];return{'url':'https://generativelanguage.googleapis.com/v1beta/models/'+_0x302f54+':generateContent?key='+getRandomValue(_0x5d2d01),'data':{'method':_0x4b9716(0x1312),'headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'contents':_0x1cb8c6,'generationConfig':{'temperature':_0x145078}})}};}const _0x17d534=new Dexie(_0x204348(0xde5)),_0x3f8fb4=[{'id':_0x204348(0x464),'url':'','name':'无'},{'id':_0x204348(0xc51),'url':_0x204348(0x560),'name':'1'},{'id':_0x204348(0xc08),'url':_0x204348(0xd5),'name':'2'},{'id':'frame_flower','url':_0x204348(0x10c7),'name':'3'},{'id':_0x204348(0x1245),'url':_0x204348(0x11f6),'name':'4'},{'id':'frame_5','url':_0x204348(0xdb5),'name':'5'},{'id':_0x204348(0xa80),'url':'https://i.postimg.cc/63sDQKMm/IMG-6893.gif','name':'6'},{'id':_0x204348(0x11d8),'url':_0x204348(0xa57),'name':'7'},{'id':'frame_8','url':_0x204348(0xd0f),'name':'8'},{'id':_0x204348(0x1115),'url':'https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','name':'9'},{'id':'frame_10','url':'https://i.postimg.cc/63NmX03s/IMG-4366.gif','name':'10'},{'id':_0x204348(0x92e),'url':'https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','name':'11'},{'id':_0x204348(0xa43),'url':'https://i.postimg.cc/prsGKMBx/IMG-4370.gif','name':'12'},{'id':'frame_13','url':_0x204348(0xc4b),'name':'13'},{'id':'frame_14','url':_0x204348(0xab1),'name':'14'},{'id':_0x204348(0xc51),'url':'https://i.postimg.cc/kGgwJhPH/IMG-4374.gif','name':'1'},{'id':_0x204348(0xc08),'url':'https://i.postimg.cc/PrcKH436/IMG-4376.gif','name':'2'},{'id':_0x204348(0xcc9),'url':'https://i.postimg.cc/fRV86FMq/IMG-4381.gif','name':'3'},{'id':'frame_tech','url':_0x204348(0xa88),'name':'4'},{'id':_0x204348(0x876),'url':'https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','name':'5'},{'id':_0x204348(0xa80),'url':'https://i.postimg.cc/05wnd389/IMG-4388.gif','name':'6'},{'id':_0x204348(0x11d8),'url':_0x204348(0x1198),'name':'7'},{'id':_0x204348(0x9a9),'url':'https://i.postimg.cc/fLTc42dg/IMG-4391.gif','name':'8'},{'id':_0x204348(0x1115),'url':'https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','name':'9'},{'id':_0x204348(0xad7),'url':_0x204348(0x1092),'name':'10'},{'id':_0x204348(0x92e),'url':_0x204348(0x2af),'name':'11'},{'id':_0x204348(0xa43),'url':_0x204348(0x68c),'name':'12'},{'id':_0x204348(0xe53),'url':_0x204348(0xe45),'name':'13'},{'id':'frame_14','url':_0x204348(0x129),'name':'14'},{'id':_0x204348(0xc51),'url':_0x204348(0x210),'name':'1'},{'id':_0x204348(0xc08),'url':_0x204348(0xf4c),'name':'2'},{'id':_0x204348(0xcc9),'url':_0x204348(0xb5b),'name':'3'},{'id':'frame_tech','url':_0x204348(0xe44),'name':'4'},{'id':_0x204348(0x876),'url':'https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','name':'5'},{'id':'frame_6','url':_0x204348(0x180),'name':'6'},{'id':_0x204348(0x11d8),'url':_0x204348(0xb7d),'name':'7'},{'id':'frame_8','url':_0x204348(0xef9),'name':'8'},{'id':_0x204348(0x1115),'url':_0x204348(0x9e8),'name':'9'},{'id':_0x204348(0xad7),'url':_0x204348(0xb21),'name':'10'},{'id':_0x204348(0x92e),'url':'https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','name':'11'},{'id':_0x204348(0xa43),'url':_0x204348(0x1449),'name':'12'},{'id':_0x204348(0xe53),'url':_0x204348(0xbf1),'name':'13'},{'id':'frame_14','url':_0x204348(0xce4),'name':'14'},{'id':_0x204348(0xc51),'url':_0x204348(0xce8),'name':'1'},{'id':_0x204348(0xc08),'url':_0x204348(0x11c0),'name':'2'},{'id':_0x204348(0xcc9),'url':_0x204348(0x116d),'name':'3'},{'id':_0x204348(0x1245),'url':_0x204348(0x1441),'name':'4'},{'id':_0x204348(0x876),'url':_0x204348(0x1158),'name':'5'},{'id':_0x204348(0xa80),'url':_0x204348(0x1288),'name':'6'},{'id':_0x204348(0x11d8),'url':_0x204348(0x658),'name':'7'},{'id':_0x204348(0x9a9),'url':_0x204348(0xfed),'name':'8'},{'id':_0x204348(0x1115),'url':_0x204348(0xa56),'name':'9'},{'id':'frame_10','url':_0x204348(0x4ba),'name':'10'},{'id':_0x204348(0x92e),'url':_0x204348(0x183),'name':'11'},{'id':_0x204348(0xa43),'url':_0x204348(0xc7e),'name':'12'},{'id':_0x204348(0xe53),'url':_0x204348(0x558),'name':'13'},{'id':'frame_14','url':_0x204348(0x5ff),'name':'14'},{'id':'frame_cat_ear','url':_0x204348(0x2d3),'name':'1'},{'id':_0x204348(0xc08),'url':_0x204348(0x7b1),'name':'2'},{'id':'frame_flower','url':_0x204348(0xe03),'name':'3'},{'id':'frame_tech','url':_0x204348(0x1022),'name':'4'},{'id':_0x204348(0x876),'url':_0x204348(0x268),'name':'5'},{'id':_0x204348(0xa80),'url':'https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','name':'6'},{'id':'frame_7','url':'https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','name':'7'},{'id':_0x204348(0x9a9),'url':_0x204348(0x1c4),'name':'8'},{'id':'frame_9','url':_0x204348(0x3c1),'name':'9'},{'id':'frame_10','url':'https://i.postimg.cc/DZshzKv6/IMG-5576.gif','name':'10'},{'id':_0x204348(0x92e),'url':_0x204348(0xd79),'name':'11'},{'id':_0x204348(0xa43),'url':'https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','name':'12'},{'id':'frame_13','url':_0x204348(0x12b6),'name':'13'},{'id':_0x204348(0x52f),'url':'https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','name':'14'},{'id':_0x204348(0xc51),'url':_0x204348(0xb30),'name':'1'},{'id':'frame_ribbon','url':'https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','name':'2'},{'id':_0x204348(0xcc9),'url':_0x204348(0x76d),'name':'3'},{'id':_0x204348(0x1245),'url':_0x204348(0x7fb),'name':'4'},{'id':'frame_5','url':_0x204348(0x5a9),'name':'5'},{'id':'frame_6','url':_0x204348(0x1422),'name':'6'},{'id':_0x204348(0x11d8),'url':_0x204348(0x807),'name':'7'},{'id':_0x204348(0x9a9),'url':'https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','name':'8'},{'id':_0x204348(0x1115),'url':_0x204348(0xd4),'name':'9'},{'id':_0x204348(0xad7),'url':'https://i.postimg.cc/wx72fhr2/IMG-5968.gif','name':'10'},{'id':'frame_11','url':_0x204348(0x6c3),'name':'11'},{'id':_0x204348(0xa43),'url':'https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','name':'12'},{'id':_0x204348(0xe53),'url':'https://i.postimg.cc/1zmcp66p/IMG-5973.gif','name':'13'},{'id':_0x204348(0x52f),'url':'https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','name':'14'},{'id':'frame_cat_ear','url':'https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','name':'1'},{'id':_0x204348(0xc08),'url':_0x204348(0xc05),'name':'2'},{'id':_0x204348(0xcc9),'url':_0x204348(0x95),'name':'3'},{'id':'frame_tech','url':'https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','name':'4'},{'id':_0x204348(0x876),'url':_0x204348(0xbfd),'name':'5'},{'id':_0x204348(0xa80),'url':'https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','name':'6'},{'id':_0x204348(0x11d8),'url':_0x204348(0x96f),'name':'7'},{'id':_0x204348(0x9a9),'url':_0x204348(0x915),'name':'8'},{'id':_0x204348(0x1115),'url':_0x204348(0x311),'name':'9'},{'id':_0x204348(0xad7),'url':'https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','name':'10'},{'id':_0x204348(0x92e),'url':_0x204348(0x9ff),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','name':'12'},{'id':_0x204348(0xe53),'url':_0x204348(0xc0e),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0x42e),'name':'14'},{'id':_0x204348(0xc51),'url':_0x204348(0x71d),'name':'1'},{'id':'frame_ribbon','url':_0x204348(0x2b4),'name':'2'},{'id':_0x204348(0xcc9),'url':_0x204348(0x925),'name':'3'},{'id':_0x204348(0x1245),'url':'https://i.postimg.cc/90RBDh9K/IMG-6377.gif','name':'4'},{'id':_0x204348(0x876),'url':_0x204348(0xfe),'name':'5'},{'id':_0x204348(0xa80),'url':'https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','name':'6'},{'id':_0x204348(0x11d8),'url':_0x204348(0xcc6),'name':'7'},{'id':_0x204348(0x9a9),'url':_0x204348(0x471),'name':'8'},{'id':_0x204348(0x1115),'url':_0x204348(0x786),'name':'9'},{'id':_0x204348(0xad7),'url':_0x204348(0x73b),'name':'10'},{'id':_0x204348(0x92e),'url':_0x204348(0x252),'name':'11'},{'id':_0x204348(0xa43),'url':_0x204348(0xe24),'name':'12'},{'id':'frame_13','url':_0x204348(0x54e),'name':'13'},{'id':_0x204348(0x52f),'url':'https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','name':'14'},{'id':'frame_cat_ear','url':_0x204348(0x55c),'name':'1'},{'id':'frame_ribbon','url':_0x204348(0x6bc),'name':'2'},{'id':_0x204348(0xcc9),'url':_0x204348(0x7d9),'name':'3'},{'id':'frame_tech','url':'https://i.postimg.cc/fycfcvHf/IMG-6569.gif','name':'4'},{'id':_0x204348(0x876),'url':_0x204348(0x8df),'name':'5'},{'id':_0x204348(0xa80),'url':_0x204348(0x1136),'name':'6'},{'id':'frame_7','url':_0x204348(0x116e),'name':'7'},{'id':_0x204348(0x9a9),'url':_0x204348(0x4da),'name':'8'},{'id':_0x204348(0x1115),'url':'https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','name':'9'},{'id':_0x204348(0xad7),'url':_0x204348(0x7cb),'name':'10'},{'id':_0x204348(0x92e),'url':'https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','name':'11'},{'id':_0x204348(0xa43),'url':_0x204348(0x1062),'name':'12'},{'id':_0x204348(0xe53),'url':_0x204348(0x601),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0xe6d),'name':'14'},{'id':_0x204348(0xc51),'url':_0x204348(0x810),'name':'1'},{'id':'frame_ribbon','url':_0x204348(0x8c0),'name':'2'},{'id':_0x204348(0xcc9),'url':_0x204348(0x34b),'name':'3'},{'id':_0x204348(0x1245),'url':_0x204348(0xc53),'name':'4'},{'id':'frame_5','url':_0x204348(0x8f9),'name':'5'},{'id':_0x204348(0xa80),'url':_0x204348(0x4df),'name':'6'},{'id':_0x204348(0x11d8),'url':_0x204348(0x701),'name':'7'},{'id':_0x204348(0x9a9),'url':_0x204348(0xb75),'name':'8'},{'id':_0x204348(0x1115),'url':_0x204348(0xb72),'name':'9'},{'id':_0x204348(0xad7),'url':_0x204348(0x387),'name':'10'},{'id':_0x204348(0x92e),'url':_0x204348(0xaa9),'name':'11'},{'id':_0x204348(0xa43),'url':'https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','name':'12'},{'id':_0x204348(0xe53),'url':'https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','name':'13'},{'id':_0x204348(0x52f),'url':'https://i.postimg.cc/d0WCKxff/IMG-6932.gif','name':'14'},{'id':_0x204348(0x92e),'url':_0x204348(0x716),'name':'11'},{'id':_0x204348(0xa43),'url':_0x204348(0x1287),'name':'12'},{'id':_0x204348(0xe53),'url':_0x204348(0x965),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0x410),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0x1070),'name':'13'},{'id':_0x204348(0x52f),'url':'https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0x490),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0xf67),'name':'14'},{'id':_0x204348(0x52f),'url':'https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0x488),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0x467),'name':'14'},{'id':'frame_14','url':_0x204348(0x16d),'name':'14'},{'id':_0x204348(0xa43),'url':'https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','name':'12'},{'id':_0x204348(0xe53),'url':_0x204348(0x9e6),'name':'13'},{'id':'frame_14','url':_0x204348(0x24e),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0xd5b),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0x1073),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0x11ae),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0x2fe),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x5ce),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0xa0c),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0xacf),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','name':'14'},{'id':_0x204348(0xe53),'url':'https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0x1ed),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x146a),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x282),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0x104f),'name':'13'},{'id':'frame_14','url':_0x204348(0x57d),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0xd14),'name':'14'},{'id':_0x204348(0xe53),'url':'https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','name':'13'},{'id':_0x204348(0x52f),'url':'https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0xb6b),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0xf85),'name':'13'},{'id':'frame_14','url':_0x204348(0x1305),'name':'14'},{'id':'frame_14','url':_0x204348(0x5a0),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0xe95),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0x7f9),'name':'13'},{'id':'frame_14','url':_0x204348(0x42d),'name':'14'},{'id':'frame_14','url':_0x204348(0x1168),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','name':'13'},{'id':'frame_14','url':_0x204348(0x11b9),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x432),'name':'14'},{'id':'frame_14','url':_0x204348(0xa2d),'name':'14'},{'id':'frame_13','url':_0x204348(0x1339),'name':'13'},{'id':_0x204348(0x52f),'url':'https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','name':'14'},{'id':'frame_13','url':_0x204348(0x1049),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0x94),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0xd6a),'name':'14'},{'id':_0x204348(0x52f),'url':'https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0x10c2),'name':'13'},{'id':'frame_14','url':_0x204348(0x152),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x25b),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0x100f),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x38c),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x9e5),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0x1069),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0xc8c),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0xb8a),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0x6ae),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0xabf),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0xb37),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0xd7f),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0xf39),'name':'13'},{'id':'frame_14','url':_0x204348(0x682),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x175),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0x1368),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0x955),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x2f5),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x124f),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0x2ab),'name':'13'},{'id':_0x204348(0x52f),'url':'https://i.postimg.cc/yx2m4nbs/IMG-7231.gif','name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x108d),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0x1091),'name':'13'},{'id':'frame_14','url':_0x204348(0xc6b),'name':'14'},{'id':'frame_14','url':_0x204348(0xf5f),'name':'14'},{'id':'frame_14','url':_0x204348(0x43c),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0x1164),'name':'13'},{'id':'frame_14','url':_0x204348(0x10d7),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x3cb),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0xed9),'name':'13'},{'id':'frame_14','url':_0x204348(0x495),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x7b8),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0xe8e),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0x694),'name':'14'},{'id':'frame_14','url':_0x204348(0x8e3),'name':'14'},{'id':_0x204348(0xe53),'url':'https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0x696),'name':'14'},{'id':_0x204348(0x52f),'url':'https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','name':'14'},{'id':_0x204348(0x52f),'url':'https://i.postimg.cc/FzqHTBng/IMG-7093.gif','name':'14'},{'id':'frame_13','url':_0x204348(0x79d),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0x675),'name':'14'},{'id':'frame_14','url':_0x204348(0xceb),'name':'14'},{'id':'frame_13','url':_0x204348(0x118e),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/B6T59xGK/IMG-7101.gif','name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x50c),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/htZppbS4/IMG-7107.gif','name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0xc8),'name':'13'},{'id':_0x204348(0x52f),'url':_0x204348(0xe33),'name':'14'},{'id':_0x204348(0x52f),'url':_0x204348(0x7b6),'name':'14'},{'id':_0x204348(0xe53),'url':_0x204348(0xc0a),'name':'13'},{'id':'frame_14','url':_0x204348(0x529),'name':'14'},{'id':_0x204348(0x52f),'url':'https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','name':'14'}];let _0x42f206={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map()},_0xd93c0f={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':_0x204348(0x103d),'nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0x23e903=0x0;const _0x435eaa=0xf;let _0x577f17=0x0;const _0x3fd33d=0xa;let _0x394ad5=[],_0x59377b={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':'order','totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0xf96d9b={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x112d48=document[_0x204348(0x458)](_0x204348(0x2a7));let _0x251566=null,_0x2b45d0=![],_0x5b5e0c=0x0,_0x3280ac=null,_0x239724=![],_0x414f54=_0x204348(0xfe2),_0x3e3048=new Set(),_0x3b3bcb=null,_0x9dc5b0=![],_0x35398a=null,_0x37ecd0=null,_0x935422=![],_0x27b4ae=![],_0x92221f=![],_0x1a7b40=![],_0x28eb35=[],_0x11002f=null,_0x9db598=null,_0x2bdb95={},_0x362918=null,_0xa42f18=null,_0x4a763b=null,_0x4a4a2d=null,_0x573734=null,_0x25949e=null,_0x195baa=null,_0x6bbec1=[],_0xa38baa=null,_0x474d33=null,_0x4fc6cc=new Set(),_0x22febf=null,_0x3e8819=null,_0x2c2275=null,_0x5a38a4={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x116b59=0x0,_0x188658=![],_0x38dccd=new Set(),_0x5af2e0=null;const _0x4fd084=_0x204348(0x13dc),_0x502840=_0x204348(0x401),_0x482806='https://i.postimg.cc/VkQfgzGJ/1.jpg',_0x5448a9=_0x204348(0x11b8);let _0xf2f511,_0x1130c4={};const _0x1bb61a=_0x204348(0x1132);let _0x2b82e3={},_0x3cef04={},_0x18dcd8=null;const _0x886ae3={'qq':_0x204348(0x845),'world-book':_0x204348(0x1bc),'wallpaper':_0x204348(0x8f2),'renderer':_0x204348(0xb3c),'api-settings':'https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','font':_0x204348(0x422),'char-phone':_0x204348(0x115f),'douban':_0x204348(0x1041),'preset':_0x204348(0x8d1),'tutorial':_0x204348(0xb1f),'werewolf':_0x204348(0x951),'x':'https://i.postimg.cc/Y9d3BztC/1.png'},_0x3d34eb={'qq':'https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','album':_0x204348(0x1bc),'browser':'https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','taobao':_0x204348(0x8b7),'memo':_0x204348(0xd9a),'diary':_0x204348(0x4e6),'amap':_0x204348(0x3df),'usage':_0x204348(0x108f),'music':'https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','ephone':'https://i.postimg.cc/pXj9h20L/IMG-7275.jpg'};let _0x51ecb2=null;const _0x30c9b4=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0x36c81d=0x0,_0x2c093d=0x1,_0x13e4ca={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0x2f1a75;const _0x5966ce=document[_0x204348(0xe7d)]('style');_0x5966ce['id']='dynamic-font-style',document[_0x204348(0x2ec)]['appendChild'](_0x5966ce);const _0x60019f=document[_0x204348(0x458)]('custom-modal-overlay'),_0x40569b=document[_0x204348(0x458)](_0x204348(0xc87)),_0x55813e=document[_0x204348(0x458)](_0x204348(0xa4a)),_0x343b0d=document[_0x204348(0x458)]('custom-modal-confirm'),_0x12e7f6=document[_0x204348(0x458)]('custom-modal-cancel');let _0x2678f3;function _0xe026f8(){const _0x44f377=_0x204348;_0x60019f[_0x44f377(0x11c2)][_0x44f377(0xa58)](_0x44f377(0x67d));}function _0x424532(){const _0x14c77f=_0x204348;_0x60019f[_0x14c77f(0x11c2)][_0x14c77f(0x1097)](_0x14c77f(0x67d)),_0x343b0d[_0x14c77f(0x11c2)][_0x14c77f(0x1097)]('btn-danger');if(_0x2678f3)_0x2678f3(null);}function _0x1c0fcf(_0x57ae0e){const _0x5c50a9=_0x204348,_0x158618=document['getElementById'](_0x5c50a9(0x5d4)),_0x751d3a=_0x57ae0e[_0x5c50a9(0xda2)][_0x5c50a9(0xf74)]||{'vertical':'top','horizontal':_0x5c50a9(0x1f3),'offset':0xa};_0x158618['style'][_0x5c50a9(0x76f)]='auto',_0x158618[_0x5c50a9(0x1104)]['bottom']=_0x5c50a9(0xf29),_0x158618[_0x5c50a9(0x1104)][_0x5c50a9(0x125)]='auto',_0x158618['style']['right']=_0x5c50a9(0xf29),_0x158618[_0x5c50a9(0x1104)]['transform']=_0x5c50a9(0x464);_0x751d3a[_0x5c50a9(0xdd3)]==='top'?_0x158618[_0x5c50a9(0x1104)][_0x5c50a9(0x76f)]=_0x751d3a[_0x5c50a9(0x408)]+'px':_0x158618[_0x5c50a9(0x1104)][_0x5c50a9(0x151)]=_0x751d3a[_0x5c50a9(0x408)]+'px';switch(_0x751d3a['horizontal']){case _0x5c50a9(0x125):_0x158618[_0x5c50a9(0x1104)]['left']='15px';break;case'right':_0x158618['style'][_0x5c50a9(0xa40)]='15px';break;case _0x5c50a9(0x1f3):default:_0x158618[_0x5c50a9(0x1104)][_0x5c50a9(0x125)]=_0x5c50a9(0x13d2),_0x158618[_0x5c50a9(0x1104)][_0x5c50a9(0xb7e)]=_0x5c50a9(0x360);break;}}async function _0x2b45cd(_0x57fd4e){const _0x1c35d8=_0x204348,_0x5b6b4c=_0x57fd4e[_0x1c35d8(0x12df)][_0x1c35d8(0x1a9)][0x0];if(!_0x5b6b4c)return;const _0x1401c6=await new Promise(_0x1f395a=>{const _0x2680c5=_0x1c35d8,_0x2b4280=new FileReader();_0x2b4280[_0x2680c5(0x11fa)]=()=>_0x1f395a(_0x2b4280[_0x2680c5(0x2ed)]),_0x2b4280['readAsDataURL'](_0x5b6b4c);});await _0x34fce8(_0x1c35d8(0x12b9),'正在请求AI为新群头像命名...');try{const _0x2b0b8f=await _0x179ee3(_0x1401c6);if(!_0x2b0b8f)throw new Error(_0x1c35d8(0x289));const _0x5def93=_0x42f206[_0x1c35d8(0x954)][_0x42f206['activeChatId']];!_0x5def93[_0x1c35d8(0xda2)][_0x1c35d8(0x97b)]&&(_0x5def93[_0x1c35d8(0xda2)][_0x1c35d8(0x97b)]=[]),_0x5def93[_0x1c35d8(0xda2)][_0x1c35d8(0x97b)]['push']({'name':_0x2b0b8f,'url':_0x1401c6}),await _0x17d534['chats']['put'](_0x5def93),_0x3d3a2b(),await _0x34fce8(_0x1c35d8(0x6c1),_0x1c35d8(0xe0c)+_0x2b0b8f+'”');}catch(_0x1a4af5){console[_0x1c35d8(0xb61)](_0x1c35d8(0x4e8),_0x1a4af5),await _0x34fce8(_0x1c35d8(0x96d),_0x1c35d8(0xd7d)+_0x1a4af5[_0x1c35d8(0x7aa)]);}finally{_0x57fd4e[_0x1c35d8(0x12df)]['value']=null;}}async function _0x232d06(_0x2f3b4f){const _0x2a2ed3=_0x204348,_0x1fdaf5=_0x2f3b4f[_0x2a2ed3(0x12df)][_0x2a2ed3(0x1a9)][0x0];if(!_0x1fdaf5)return;const _0x30f7cd=await new Promise(_0x519944=>{const _0x7ce81b=_0x2a2ed3,_0x13bbd3=new FileReader();_0x13bbd3[_0x7ce81b(0x11fa)]=()=>_0x519944(_0x13bbd3['result']),_0x13bbd3['readAsDataURL'](_0x1fdaf5);});await _0x34fce8('请稍候...',_0x2a2ed3(0xbc0));try{const _0x426158=await _0x179ee3(_0x30f7cd);if(!_0x426158)throw new Error('AI未能成功描述图片。');const _0x45ae51=_0x42f206[_0x2a2ed3(0x954)][_0x42f206['activeChatId']];!_0x45ae51['settings']['aiAvatarLibrary']&&(_0x45ae51['settings']['aiAvatarLibrary']=[]),_0x45ae51[_0x2a2ed3(0xda2)][_0x2a2ed3(0x5d3)][_0x2a2ed3(0x129e)]({'name':_0x426158,'url':_0x30f7cd}),await _0x17d534['chats'][_0x2a2ed3(0xf3f)](_0x45ae51),_0x3204f6(),await _0x34fce8('上传成功！',_0x2a2ed3(0xe91)+_0x426158+'”');}catch(_0x148fe3){console[_0x2a2ed3(0xb61)]('本地头像上传及识别失败:',_0x148fe3),await _0x34fce8(_0x2a2ed3(0x96d),_0x2a2ed3(0xd7d)+_0x148fe3[_0x2a2ed3(0x7aa)]);}finally{_0x2f3b4f[_0x2a2ed3(0x12df)][_0x2a2ed3(0x8dd)]=null;}}async function _0x179ee3(_0x30a3be){const _0x21b074=_0x204348,_0x4efb1d=_0x42f206['apiConfig'][_0x21b074(0x1380)]&&_0x42f206[_0x21b074(0x5cb)][_0x21b074(0x121d)]&&_0x42f206[_0x21b074(0x5cb)][_0x21b074(0xdc9)],{proxyUrl:_0x396147,apiKey:_0x465841,model:_0x2ad9d1}=_0x4efb1d?{'proxyUrl':_0x42f206['apiConfig']['secondaryProxyUrl'],'apiKey':_0x42f206[_0x21b074(0x5cb)][_0x21b074(0x121d)],'model':_0x42f206['apiConfig'][_0x21b074(0xdc9)]}:_0x42f206[_0x21b074(0x5cb)];if(!_0x396147||!_0x465841||!_0x2ad9d1)throw new Error(_0x21b074(0x1254));const _0x32c575=_0x21b074(0x999);let _0x46d477=_0x396147[_0x21b074(0xd8d)](_0x21b074(0xfe3)),_0x5ae33d;if(_0x46d477){const _0x512172=_0x30a3be[_0x21b074(0x41c)](/^data:(.*);base64/)[0x1],_0x230cf4=_0x30a3be[_0x21b074(0x90b)](',')[0x1],_0x1910ff={'contents':[{'parts':[{'text':_0x32c575},{'inline_data':{'mime_type':_0x512172,'data':_0x230cf4}}]}]};_0x5ae33d=await fetch(_0x396147+'/'+_0x2ad9d1+':generateContent?key='+_0x465841,{'method':'POST','headers':{'Content-Type':_0x21b074(0xa0e)},'body':JSON[_0x21b074(0xc04)](_0x1910ff)});}else{const _0xf20a5={'model':_0x2ad9d1,'messages':[{'role':'user','content':[{'type':'text','text':_0x32c575},{'type':_0x21b074(0x1072),'image_url':{'url':_0x30a3be}}]}],'max_tokens':0x32};_0x5ae33d=await fetch(_0x396147+_0x21b074(0xd7),{'method':'POST','headers':{'Content-Type':_0x21b074(0xa0e),'Authorization':_0x21b074(0x8aa)+_0x465841},'body':JSON[_0x21b074(0xc04)](_0xf20a5)});}if(!_0x5ae33d['ok']){const _0x210b34=await _0x5ae33d[_0x21b074(0xaef)]();throw new Error(_0x21b074(0x676)+_0x210b34[_0x21b074(0xb61)][_0x21b074(0x7aa)]);}const _0x4706de=await _0x5ae33d['json']();let _0x5f2bae=_0x46d477?getGeminiResponseText(_0x4706de):_0x4706de[_0x21b074(0x2f9)][0x0][_0x21b074(0x7aa)][_0x21b074(0x1316)];return _0x5f2bae[_0x21b074(0x2aa)]()[_0x21b074(0x33b)](/["'“”‘’]/g,'');}async function _0x5bef7a(_0x5c08ec){const _0x59ad6c=_0x204348;if(!_0x5c08ec||_0x5c08ec['isGroup']){console[_0x59ad6c(0x1b6)]('syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。');return;}const _0x2dacbc=_0x5c08ec['id'],_0x3437b7=_0x5c08ec['name'],_0x3467dd=_0x5c08ec[_0x59ad6c(0xa1)];console[_0x59ad6c(0x7d1)](_0x59ad6c(0x13b)+_0x2dacbc+'\x20同步所有群聊内的名称信息...');for(const _0x24cc65 in _0x42f206[_0x59ad6c(0x954)]){const _0x1bd360=_0x42f206[_0x59ad6c(0x954)][_0x24cc65];if(_0x1bd360[_0x59ad6c(0x726)]&&_0x1bd360[_0x59ad6c(0xfa8)]){const _0x3bb283=_0x1bd360['members'][_0x59ad6c(0xb07)](_0x2fc250=>_0x2fc250['id']===_0x2dacbc);if(_0x3bb283){let _0x248dbd=![];_0x3bb283[_0x59ad6c(0x1118)]!==_0x3437b7&&(_0x3bb283['groupNickname']=_0x3437b7,_0x248dbd=!![]),_0x3bb283['originalName']!==_0x3467dd&&(_0x3bb283['originalName']=_0x3467dd,_0x248dbd=!![]),_0x248dbd&&(await _0x17d534[_0x59ad6c(0x954)][_0x59ad6c(0xf3f)](_0x1bd360),console[_0x59ad6c(0x7d1)]('成功将群聊\x20\x22'+_0x1bd360[_0x59ad6c(0x132a)]+'\x22\x20中的成员信息更新'));}}}}async function _0x249add(_0x11c7ad){const _0x2894bb=_0x204348;if(!_0x11c7ad||_0x11c7ad[_0x2894bb(0x726)]){console[_0x2894bb(0x1b6)](_0x2894bb(0x4c8));return;}const _0x5afa06=_0x11c7ad['id'],_0x3c3328=_0x11c7ad[_0x2894bb(0xda2)][_0x2894bb(0x9c7)];console['log']('正在为角色\x20'+_0x5afa06+'\x20同步所有群聊内的头像...');for(const _0x59f568 of Object[_0x2894bb(0x6eb)](_0x42f206[_0x2894bb(0x954)])){if(_0x59f568[_0x2894bb(0x726)]&&_0x59f568[_0x2894bb(0xfa8)]){const _0xeb85a4=_0x59f568[_0x2894bb(0xfa8)][_0x2894bb(0xb07)](_0x56f903=>_0x56f903['id']===_0x5afa06);_0xeb85a4&&_0xeb85a4[_0x2894bb(0x5c6)]!==_0x3c3328&&(_0xeb85a4[_0x2894bb(0x5c6)]=_0x3c3328,await _0x17d534[_0x2894bb(0x954)][_0x2894bb(0xf3f)](_0x59f568),console[_0x2894bb(0x7d1)](_0x2894bb(0x763)+_0x5afa06+_0x2894bb(0x1413)+_0x59f568['name']+'\x22'));}}}function _0x32d364(_0x43ce35,_0x1e32a7){const _0x2b2d39=_0x204348;if(!_0x43ce35||!_0x43ce35[_0x2b2d39(0x726)]||!_0x1e32a7)return _0x1e32a7;const _0x4aea18=_0x42f206[_0x2b2d39(0x551)][_0x2b2d39(0x308)]||'{{user}}';if(_0x1e32a7===_0x4aea18)return _0x43ce35[_0x2b2d39(0xda2)]['myNickname']||'我';const _0x4540f0=_0x43ce35[_0x2b2d39(0xfa8)]['find'](_0x2cfeba=>_0x2cfeba[_0x2b2d39(0xa1)]===_0x1e32a7);return _0x4540f0?_0x4540f0['groupNickname']:_0x1e32a7;}function _0x582eaa(_0x15557a){const _0x3f2188=_0x204348;document[_0x3f2188(0x102a)]('.rules-tab')['forEach'](_0x22ace2=>{const _0x4f29d0=_0x3f2188;_0x22ace2[_0x4f29d0(0x11c2)][_0x4f29d0(0x1270)]('active',_0x22ace2[_0x4f29d0(0x1f4)][_0x4f29d0(0x5f7)]===_0x15557a);}),document[_0x3f2188(0x102a)](_0x3f2188(0xe1b))[_0x3f2188(0x12c2)](_0x3d302c=>{const _0x37ed77=_0x3f2188;_0x3d302c[_0x37ed77(0x11c2)]['toggle'](_0x37ed77(0xfe1),_0x3d302c[_0x37ed77(0x1f4)][_0x37ed77(0x5f7)]===_0x15557a);});}function _0x4e0b74(_0x39feb8){const _0x2add58=_0x204348;if(!_0x39feb8)return'';if(_0x42f206['qzoneSettings']&&_0x39feb8===_0x42f206[_0x2add58(0x551)][_0x2add58(0x308)])return _0x42f206[_0x2add58(0x551)][_0x2add58(0x308)];let _0x56238c=Object['values'](_0x42f206['chats'])[_0x2add58(0xb07)](_0x2822bf=>!_0x2822bf[_0x2add58(0x726)]&&_0x2822bf[_0x2add58(0xa1)]===_0x39feb8);if(_0x56238c)return _0x56238c[_0x2add58(0x132a)];_0x56238c=Object[_0x2add58(0x6eb)](_0x42f206[_0x2add58(0x954)])[_0x2add58(0xb07)](_0x554bb1=>!_0x554bb1[_0x2add58(0x726)]&&(_0x554bb1[_0x2add58(0x103)]&&_0x554bb1[_0x2add58(0x103)][_0x2add58(0xd8d)](_0x39feb8)));if(_0x56238c)return _0x56238c[_0x2add58(0x132a)];return _0x39feb8;}function _0xcad370(_0x32a5ce,_0x1524b3=null){const _0x1f340d=_0x204348;if(!_0x32a5ce||typeof _0x32a5ce!==_0x1f340d(0x861)||!_0x32a5ce[_0x1f340d(0xd8d)](_0x1f340d(0x1d6)))return _0x32a5ce;return _0x32a5ce[_0x1f340d(0x33b)](/@\[\[([^\]]+)\]\]/g,(_0x5dcd1b,_0x2ff5a0)=>{const _0x37cdcb=_0x2ff5a0['trim']();let _0x2c0b0c;return _0x1524b3&&_0x1524b3['isGroup']?_0x2c0b0c=_0x32d364(_0x1524b3,_0x37cdcb):_0x2c0b0c=_0x4e0b74(_0x37cdcb),'@'+_0x2c0b0c;});}function _0x2532b9(_0x54bbaf,_0x121255,_0xd73ecb={}){return new Promise(_0x5dd9fe=>{const _0x4e2a71=_0x1a5b;_0x2678f3=_0x5dd9fe,_0x40569b[_0x4e2a71(0x1a2)]=_0x54bbaf,_0x55813e['innerHTML']=_0x4e2a71(0x639)+_0x121255+'</p>';const _0x22d1d7=document[_0x4e2a71(0x458)]('custom-modal-confirm'),_0x51a206=document['getElementById']('custom-modal-cancel');_0x51a206[_0x4e2a71(0x1104)][_0x4e2a71(0x4db)]=_0x4e2a71(0x1188),_0x22d1d7[_0x4e2a71(0x1a2)]=_0xd73ecb['confirmText']||'确定',_0x51a206['textContent']=_0xd73ecb[_0x4e2a71(0xad3)]||'取消',_0xd73ecb[_0x4e2a71(0x1329)]?_0x22d1d7['classList'][_0x4e2a71(0xa58)](_0xd73ecb[_0x4e2a71(0x1329)]):_0x22d1d7[_0x4e2a71(0x11c2)][_0x4e2a71(0x1097)](_0x4e2a71(0x4d3)),_0x22d1d7[_0x4e2a71(0xbe8)]=()=>{_0x5dd9fe(!![]),_0x424532();},_0x51a206[_0x4e2a71(0xbe8)]=()=>{_0x5dd9fe(![]),_0x424532();},_0xe026f8();});}function _0x83d295(_0x1f5faf=_0x204348(0xfb8),_0x4b508e=_0x204348(0x5d5)){const _0x14cfbe=_0x204348,_0x408f83=document[_0x14cfbe(0xe7d)](_0x14cfbe(0x1323));_0x408f83[_0x14cfbe(0x1a2)]=_0x1f5faf,_0x408f83[_0x14cfbe(0x1104)]['cssText']=_0x14cfbe(0x25c)+(_0x4b508e==='success'?'#4CAF50':_0x14cfbe(0x11c6))+';\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2012px\x2024px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x2010000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20pointer-events:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(20px);\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20',document[_0x14cfbe(0x5b4)][_0x14cfbe(0x1079)](_0x408f83),setTimeout(()=>{const _0x27ea30=_0x14cfbe;_0x408f83[_0x27ea30(0x1104)][_0x27ea30(0x539)]='1',_0x408f83[_0x27ea30(0x1104)][_0x27ea30(0xb7e)]=_0x27ea30(0x859);},0xa),setTimeout(()=>{const _0xdb45e3=_0x14cfbe;_0x408f83[_0xdb45e3(0x1104)][_0xdb45e3(0x539)]='0',_0x408f83[_0xdb45e3(0x1104)][_0xdb45e3(0xb7e)]='translateY(-20px)',setTimeout(()=>{const _0x5eb787=_0xdb45e3;_0x408f83[_0x5eb787(0x1097)]();},0x12c);},0x7d0);}function _0x3fcb02(_0x33c93a){const _0x33747e=_0x204348;let _0x5150dc=(_0x33c93a||'NAI_Image')[_0x33747e(0x33b)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')[_0x33747e(0x33b)](/\s+/g,'_')[_0x33747e(0xa6d)](0x0,0x1e);const _0xd8504a=new Date()[_0x33747e(0xf63)]()[_0x33747e(0x33b)](/[-:]/g,'')[_0x33747e(0x33b)]('T','_')['split']('.')[0x0];return _0x5150dc+'_'+_0xd8504a+_0x33747e(0x1224);}function _0x213dd5(_0x476b1c,_0x2a4015){const _0x490095=_0x204348;try{const _0x19ad5e=_0x3fcb02(_0x2a4015),_0x393c51=document['createElement']('a');_0x393c51['href']=_0x476b1c,_0x393c51[_0x490095(0x3c5)]=_0x19ad5e,_0x393c51[_0x490095(0x1104)][_0x490095(0x4db)]=_0x490095(0x464),document['body']['appendChild'](_0x393c51),_0x393c51[_0x490095(0x1122)](),setTimeout(()=>{const _0x3d33f6=_0x490095;document[_0x3d33f6(0x5b4)][_0x3d33f6(0x626)](_0x393c51);},0x64),_0x83d295(_0x490095(0xfb8));}catch(_0x546a31){console[_0x490095(0xb61)](_0x490095(0x10aa),_0x546a31),_0x83d295('下载失败，请重试',_0x490095(0xb61));}}function _0x34fce8(_0x35ffae,_0x17b9e3){return new Promise(_0x4e8a2b=>{const _0x3dd060=_0x1a5b;_0x2678f3=_0x4e8a2b,_0x40569b['textContent']=_0x35ffae,_0x55813e[_0x3dd060(0x110d)]=_0x3dd060(0x11d5)+_0x17b9e3+_0x3dd060(0xd36);const _0x49b7ba=document[_0x3dd060(0x458)]('custom-modal-confirm'),_0x3cc2f6=document[_0x3dd060(0x458)]('custom-modal-cancel');_0x3cc2f6[_0x3dd060(0x1104)]['display']='none',_0x49b7ba[_0x3dd060(0x1a2)]='好的',_0x49b7ba[_0x3dd060(0xbe8)]=()=>{const _0x22e1f4=_0x3dd060;_0x3cc2f6[_0x22e1f4(0x1104)][_0x22e1f4(0x4db)]=_0x22e1f4(0x1188),_0x49b7ba[_0x22e1f4(0x1a2)]='确定',_0x4e8a2b(!![]),_0x424532();},_0xe026f8();});}function _0x335e57(_0x5097fc,_0x2f414d,_0x2d9ff0='',_0x2c9def=_0x204348(0xdd5),_0xf342b8=''){return new Promise(_0x59e86a=>{const _0x3025db=_0x1a5b;_0x2678f3=_0x59e86a,_0x40569b[_0x3025db(0x1a2)]=_0x5097fc;const _0x109948=_0x3025db(0x212),_0x4732d5=_0x2c9def===_0x3025db(0xb43)?_0x3025db(0x654)+_0x109948+_0x3025db(0x5df)+_0x2f414d+'\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>'+_0x2d9ff0+_0x3025db(0x44e):'<input\x20type=\x22'+_0x2c9def+_0x3025db(0x7fc)+_0x109948+'\x22\x20placeholder=\x22'+_0x2f414d+_0x3025db(0x76c)+_0x2d9ff0+'\x22>';_0x55813e[_0x3025db(0x110d)]=_0xf342b8+_0x4732d5;const _0x21121b=document[_0x3025db(0x458)](_0x109948);_0x55813e[_0x3025db(0x102a)](_0x3025db(0xb74))['forEach'](_0xd5d6f1=>{const _0x8a63fe=_0x3025db;_0xd5d6f1[_0x8a63fe(0xd85)](_0x8a63fe(0x1122),()=>{const _0x58a7e7=_0x8a63fe,_0x26895e=_0xd5d6f1[_0x58a7e7(0x1f4)]['template'];if(_0x26895e)try{const _0x39ee8e=JSON['parse'](_0x26895e);_0x21121b[_0x58a7e7(0x8dd)]=JSON[_0x58a7e7(0xc04)](_0x39ee8e,null,0x2),_0x21121b['focus']();}catch(_0x2b2cb8){console[_0x58a7e7(0xb61)](_0x58a7e7(0x735),_0x2b2cb8);}});});const _0x18c78a=document['getElementById'](_0x3025db(0x7b7)),_0x50b060=document[_0x3025db(0x458)](_0x3025db(0x386));_0x18c78a[_0x3025db(0xbe8)]=()=>{const _0x23fed1=_0x3025db;_0x59e86a(_0x21121b[_0x23fed1(0x8dd)]),_0x424532();},_0x50b060[_0x3025db(0xbe8)]=()=>{_0x59e86a(null),_0x424532();},_0xe026f8(),setTimeout(()=>_0x21121b['focus'](),0x64);});}function _0xcd7475(_0x8b06ac,_0x2ef829){const _0x23e3f0=_0x204348;return new Promise(_0x5f27b8=>{const _0x585b25=_0x1a5b,_0x3b5cac=document[_0x585b25(0x458)](_0x585b25(0x2b6)),_0x556fcb=document['getElementById'](_0x585b25(0xc87)),_0x254886=document['getElementById'](_0x585b25(0xa4a)),_0x31d99f=document[_0x585b25(0x586)](_0x585b25(0xb81));_0x556fcb[_0x585b25(0x1a2)]=_0x8b06ac,_0x254886[_0x585b25(0x110d)]='',_0x31d99f[_0x585b25(0x110d)]='',_0x31d99f[_0x585b25(0x1104)][_0x585b25(0xa0f)]='column',_0x2ef829[_0x585b25(0x12c2)](_0x3d2e40=>{const _0x1e288e=_0x585b25,_0x5d1730=document['createElement']('button');_0x5d1730[_0x1e288e(0x1a2)]=_0x3d2e40['text'],_0x5d1730[_0x1e288e(0xbe8)]=()=>{const _0xa693f2=_0x1e288e;_0x3b5cac[_0xa693f2(0x11c2)]['remove'](_0xa693f2(0x67d)),_0x5f27b8(_0x3d2e40[_0xa693f2(0x8dd)]);},_0x31d99f['appendChild'](_0x5d1730);});const _0x594a48=document[_0x585b25(0xe7d)](_0x585b25(0x986));_0x594a48[_0x585b25(0x1a2)]='取消',_0x594a48['style']['marginTop']='8px',_0x594a48[_0x585b25(0x1104)][_0x585b25(0x4c7)]=_0x585b25(0x6a9),_0x594a48[_0x585b25(0x1104)]['backgroundColor']=_0x585b25(0xd68),_0x594a48[_0x585b25(0xbe8)]=()=>{const _0x3ad7e9=_0x585b25;_0x3b5cac[_0x3ad7e9(0x11c2)][_0x3ad7e9(0x1097)]('visible'),_0x5f27b8(null);},_0x31d99f[_0x585b25(0x1079)](_0x594a48),_0x3b5cac[_0x585b25(0x11c2)]['add'](_0x585b25(0x67d));})[_0x23e3f0(0xb4b)](()=>{const _0x48befd=_0x23e3f0,_0x210f6c=document['querySelector'](_0x48befd(0xb81));_0x210f6c[_0x48befd(0x1104)]['flexDirection']='row',_0x210f6c[_0x48befd(0x110d)]=_0x48befd(0x67f),document[_0x48befd(0x458)](_0x48befd(0x386))['addEventListener']('click',_0x424532);});}async function _0x122402(){const _0x34b2da=_0x204348,_0x3b6321=await _0xcd7475('选择歌词导入方式',[{'text':_0x34b2da(0x78d),'value':'file'},{'text':'📋\x20直接粘贴歌词文本','value':_0x34b2da(0x949)}]);if(_0x3b6321==='file')return new Promise(_0x5b17b9=>{const _0x4326e8=_0x34b2da,_0x2554eb=document[_0x4326e8(0x458)](_0x4326e8(0x12dc)),_0x337d01=_0x3e0f62=>{const _0x1ad3e7=_0x4326e8,_0x26a825=_0x3e0f62[_0x1ad3e7(0x12df)]['files'][0x0];if(_0x26a825){const _0x47af8c=new FileReader();_0x47af8c[_0x1ad3e7(0x11fa)]=_0x597fed=>_0x5b17b9(_0x597fed[_0x1ad3e7(0x12df)][_0x1ad3e7(0x2ed)]),_0x47af8c[_0x1ad3e7(0x4de)]=()=>_0x5b17b9(''),_0x47af8c['readAsText'](_0x26a825);}else _0x5b17b9(null);_0x2554eb[_0x1ad3e7(0x13ac)](_0x1ad3e7(0x26a),_0x337d01),_0x2554eb[_0x1ad3e7(0x8dd)]='';};_0x2554eb[_0x4326e8(0xd85)]('change',_0x337d01,{'once':!![]}),_0x2554eb['click']();});else{if(_0x3b6321===_0x34b2da(0x949)){const _0x3a5f22=await _0x335e57(_0x34b2da(0xdbf),_0x34b2da(0x1cb),'','textarea');if(_0x3a5f22){const _0x47cbfc=_0x3a5f22[_0x34b2da(0x33b)](/\[/g,'\x0a[')[_0x34b2da(0x2aa)]();return _0x47cbfc;}return _0x3a5f22;}else return null;}}_0x17d534[_0x204348(0x768)](0x28)[_0x204348(0xe08)]({'doubanPosts':_0x204348(0x4d0),'chats':_0x204348(0xb6a),'apiConfig':_0x204348(0x8a1),'globalSettings':'&id','userStickers':'&id,\x20url,\x20name,\x20categoryId','worldBooks':'&id,\x20name,\x20categoryId','worldBookCategories':_0x204348(0x96c),'musicLibrary':_0x204348(0xd31),'personaPresets':_0x204348(0xd31),'qzoneSettings':_0x204348(0xd31),'qzonePosts':'++id,\x20timestamp,\x20authorId','qzoneAlbums':'++id,\x20name,\x20createdAt','qzonePhotos':_0x204348(0x1411),'favorites':'++id,\x20type,\x20timestamp,\x20originalTimestamp','qzoneGroups':'++id,\x20name','memories':_0x204348(0x11d2),'callRecords':_0x204348(0x956),'shoppingProducts':_0x204348(0x8ed),'shoppingCategories':_0x204348(0x96c),'apiPresets':'++id,\x20name','renderingRules':_0x204348(0x9c1),'appearancePresets':_0x204348(0x782),'stickerCategories':_0x204348(0x96c),'customAvatarFrames':_0x204348(0x96c),'presets':_0x204348(0xa53),'presetCategories':_0x204348(0x96c),'readingLibrary':_0x204348(0xeaf),'npcs':_0x204348(0xd62),'npcGroups':_0x204348(0x96c)})[_0x204348(0x138b)](_0x235209=>{const _0x34c29a=_0x204348;return _0x235209[_0x34c29a(0xca3)](_0x34c29a(0xab7))[_0x34c29a(0x8dc)]()[_0x34c29a(0x910)](_0x452ccc=>{const _0x16a815=_0x34c29a;if(typeof _0x452ccc[_0x16a815(0x1316)]===_0x16a815(0x861)&&_0x452ccc[_0x16a815(0x1316)][_0x16a815(0x2aa)]()!=='')_0x452ccc[_0x16a815(0x1316)]=[{'keys':[],'comment':_0x16a815(0x74f),'content':_0x452ccc[_0x16a815(0x1316)]}];else!Array[_0x16a815(0x971)](_0x452ccc[_0x16a815(0x1316)])&&(_0x452ccc[_0x16a815(0x1316)]=[]);_0x452ccc['content'][_0x16a815(0x12c2)](_0x4a59c3=>{const _0x2a0dc3=_0x16a815;typeof _0x4a59c3[_0x2a0dc3(0x12fb)]==='undefined'&&(_0x4a59c3[_0x2a0dc3(0x12fb)]=!![]);});});}),window['db']=_0x17d534;function _0x589d88(_0x48bd4d){const _0x266d81=_0x204348;_0x48bd4d===_0x266d81(0x1302)&&(window[_0x266d81(0x120d)](),_0x2ecab9(_0x266d81(0x785)));if(_0x48bd4d==='api-settings-screen')window[_0x266d81(0xe9e)]();if(_0x48bd4d===_0x266d81(0x355))window['renderWallpaperScreenProxy']();if(_0x48bd4d===_0x266d81(0x7d))window[_0x266d81(0xe2d)]();if(_0x48bd4d===_0x266d81(0x9b8))window['renderXSocialScreenProxy']();if(_0x48bd4d===_0x266d81(0xca1))_0x10bf4a();document[_0x266d81(0x102a)](_0x266d81(0x24b))['forEach'](_0x5ae85b=>_0x5ae85b[_0x266d81(0x11c2)][_0x266d81(0x1097)](_0x266d81(0xfe1)));const _0x86563d=document['getElementById'](_0x48bd4d);if(_0x86563d)_0x86563d[_0x266d81(0x11c2)][_0x266d81(0xa58)](_0x266d81(0xfe1));if(_0x48bd4d===_0x266d81(0xd99))window['updateListenTogetherIconProxy'](_0x42f206[_0x266d81(0x81d)]);_0x48bd4d===_0x266d81(0xde7)&&(_0x2ea2e5(),document['getElementById'](_0x266d81(0x8a7))['value']=_0x42f206['globalSettings'][_0x266d81(0xafb)]||'',_0x393d41(_0x42f206[_0x266d81(0xf0)][_0x266d81(0xafb)]||'',!![]));}window['updateListenTogetherIconProxy']=()=>{};function _0x2ecab9(_0x3166fc){const _0x36c0ec=_0x204348,_0x50bf40=document[_0x36c0ec(0x458)]('chat-list-screen'),_0x55307e={'messages-view':document[_0x36c0ec(0x458)](_0x36c0ec(0x785)),'qzone-screen':document['getElementById'](_0x36c0ec(0x1116)),'favorites-view':document[_0x36c0ec(0x458)](_0x36c0ec(0x13a9)),'memories-view':document[_0x36c0ec(0x458)](_0x36c0ec(0x313)),'npc-list-view':document[_0x36c0ec(0x458)](_0x36c0ec(0x7ed))},_0x3d7d63=document[_0x36c0ec(0x458)](_0x36c0ec(0x97c)),_0xe55af5=document['getElementById'](_0x36c0ec(0x588));_0x188658&&document[_0x36c0ec(0x458)]('favorites-edit-btn')['click']();Object[_0x36c0ec(0x6eb)](_0x55307e)[_0x36c0ec(0x12c2)](_0x1bbbd7=>_0x1bbbd7[_0x36c0ec(0x11c2)][_0x36c0ec(0x1097)](_0x36c0ec(0xfe1)));_0x55307e[_0x3166fc]&&_0x55307e[_0x3166fc][_0x36c0ec(0x11c2)]['add'](_0x36c0ec(0xfe1));document[_0x36c0ec(0x102a)](_0x36c0ec(0xfc0))[_0x36c0ec(0x12c2)](_0x11cb3c=>{const _0x1f5236=_0x36c0ec;_0x11cb3c['classList'][_0x1f5236(0x1270)]('active',_0x11cb3c[_0x1f5236(0x1f4)][_0x1f5236(0x88c)]===_0x3166fc);});_0x3166fc==='messages-view'?(_0x3d7d63[_0x36c0ec(0x1104)][_0x36c0ec(0x4db)]=_0x36c0ec(0x82b),_0xe55af5[_0x36c0ec(0x1104)][_0x36c0ec(0x4db)]='flex'):(_0x3d7d63[_0x36c0ec(0x1104)][_0x36c0ec(0x4db)]=_0x36c0ec(0x464),_0xe55af5[_0x36c0ec(0x1104)]['display']=_0x36c0ec(0x464));_0x3166fc!=='memories-view'&&(_0x4d37ba[_0x36c0ec(0x12c2)](_0x35010b=>clearInterval(_0x35010b)),_0x4d37ba=[]);switch(_0x3166fc){case _0x36c0ec(0x1116):_0x55307e[_0x36c0ec(0x1116)]['style'][_0x36c0ec(0x11d7)]=_0x36c0ec(0xe14),_0x276281(0x0),_0x6a6725(),_0x316550();break;case'favorites-view':_0x55307e[_0x36c0ec(0x13a9)]['style'][_0x36c0ec(0x11d7)]=_0x36c0ec(0x880),_0x25490b();break;case'messages-view':break;case _0x36c0ec(0x7ed):_0x2844bc();break;}}function _0x3d61dc(){const _0x2b0d04=_0x204348;console['log'](_0x2b0d04(0x3aa));}window[_0x204348(0x32b)]=_0x3d61dc;function _0x6a6725(){const _0xa102b5=_0x204348;if(_0x42f206&&_0x42f206[_0xa102b5(0x551)]){const _0xbea206=_0x42f206[_0xa102b5(0x551)];document[_0xa102b5(0x458)](_0xa102b5(0x47d))['textContent']=_0xbea206[_0xa102b5(0x308)],document['getElementById'](_0xa102b5(0xdd9))[_0xa102b5(0x577)]=_0xbea206[_0xa102b5(0x5c6)],document['getElementById']('qzone-banner-img')[_0xa102b5(0x577)]=_0xbea206[_0xa102b5(0x72a)];}}window[_0x204348(0x9a8)]=_0x6a6725;async function _0x5ebe5c(){const _0x5fbe6d=_0x204348;_0x17d534&&_0x42f206[_0x5fbe6d(0x551)]&&await _0x17d534[_0x5fbe6d(0x551)]['put'](_0x42f206[_0x5fbe6d(0x551)]);}function _0x459554(_0x162700){const _0x386a34=_0x204348;if(!_0x162700)return'';const _0x17e10d=new Date(),_0x3e08db=new Date(_0x162700),_0x74ecc5=Math[_0x386a34(0xbd5)]((_0x17e10d-_0x3e08db)/0x3e8),_0x279aa2=Math[_0x386a34(0xbd5)](_0x74ecc5/0x3c),_0x5f2ce=Math[_0x386a34(0xbd5)](_0x279aa2/0x3c);if(_0x279aa2<0x1)return'刚刚';if(_0x279aa2<0x3c)return _0x279aa2+_0x386a34(0x137a);if(_0x5f2ce<0x18)return _0x5f2ce+_0x386a34(0x1354);const _0x5d58c0=_0x3e08db['getFullYear'](),_0x774745=String(_0x3e08db[_0x386a34(0x63a)]()+0x1)[_0x386a34(0x508)](0x2,'0'),_0x3b2477=String(_0x3e08db[_0x386a34(0x14c)]())[_0x386a34(0x508)](0x2,'0'),_0x5b5363=String(_0x3e08db[_0x386a34(0x748)]())[_0x386a34(0x508)](0x2,'0'),_0x3fed8d=String(_0x3e08db[_0x386a34(0x121a)]())['padStart'](0x2,'0');return _0x17e10d[_0x386a34(0xc2a)]()===_0x5d58c0?_0x774745+'-'+_0x3b2477+'\x20'+_0x5b5363+':'+_0x3fed8d:_0x5d58c0+'-'+_0x774745+'-'+_0x3b2477+'\x20'+_0x5b5363+':'+_0x3fed8d;}function _0x280e3c(_0x189ce7){const _0x3cc9f3=_0x204348,_0x37a991=document[_0x3cc9f3(0x586)]('.qzone-post-container[data-post-id=\x22'+_0x189ce7['id']+'\x22]'),_0x4b908c=!!_0x37a991,_0x49becc=_0x4b908c?_0x37a991:document[_0x3cc9f3(0xe7d)](_0x3cc9f3(0x1323));!_0x4b908c&&(_0x49becc['className']=_0x3cc9f3(0x41f),_0x49becc[_0x3cc9f3(0x1f4)][_0x3cc9f3(0x13bc)]=_0x189ce7['id']);const _0x4d9155=_0x4b908c?_0x49becc[_0x3cc9f3(0x586)]('.qzone-post-item'):document[_0x3cc9f3(0xe7d)](_0x3cc9f3(0x1323));!_0x4b908c&&(_0x4d9155[_0x3cc9f3(0x69b)]=_0x3cc9f3(0x23b));let _0x355a6e='',_0x4e6490='',_0x53277b=_0x42f206[_0x3cc9f3(0x551)]['avatar'];if(_0x189ce7[_0x3cc9f3(0x1086)]===_0x3cc9f3(0xf86))_0x355a6e=_0x42f206[_0x3cc9f3(0x551)]['avatar'],_0x4e6490=_0x42f206[_0x3cc9f3(0x551)]['nickname'];else{if(_0x42f206['chats'][_0x189ce7[_0x3cc9f3(0x1086)]]){const _0x3aef08=_0x42f206['chats'][_0x189ce7[_0x3cc9f3(0x1086)]];_0x355a6e=_0x3aef08[_0x3cc9f3(0xda2)]['aiAvatar']||_0x4fd084,_0x4e6490=_0x3aef08['name'];}else _0x4e6490=_0x4e0b74(_0x189ce7[_0x3cc9f3(0xb85)]),_0x355a6e=_0x4fd084;}function _0x31d984(_0x30ce2b){const _0x5aae3e=_0x3cc9f3;let _0x1cb951='';const _0xb21403=_0x30ce2b['publicText']?_0x5aae3e(0x75)+_0x5c8590(_0x30ce2b[_0x5aae3e(0xd2d)])['replace'](/\n/g,'<br>')+_0x5aae3e(0xb44):'';if(_0x30ce2b[_0x5aae3e(0x259)]===_0x5aae3e(0xb03))_0x1cb951='<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>'+_0x5c8590(_0x30ce2b['content'])[_0x5aae3e(0x33b)](/\n/g,_0x5aae3e(0x1208))+_0x5aae3e(0xb44);else{if(_0x30ce2b[_0x5aae3e(0x259)]==='image_post'&&_0x30ce2b[_0x5aae3e(0x2cc)])_0x1cb951=_0xb21403?_0xb21403+_0x5aae3e(0x9b5)+_0x30ce2b[_0x5aae3e(0x2cc)]+_0x5aae3e(0xa8):_0x5aae3e(0xfa9)+_0x30ce2b['imageUrl']+_0x5aae3e(0x87d);else{if(_0x30ce2b[_0x5aae3e(0x259)]===_0x5aae3e(0x1237)){const _0x569d9a=_0x42f206[_0x5aae3e(0xf0)][_0x5aae3e(0xf0e)]&&_0x30ce2b[_0x5aae3e(0xef)]?_0x5aae3e(0x94c)+_0x30ce2b[_0x5aae3e(0xef)]:_0x5aae3e(0x503);_0x1cb951=_0xb21403?_0xb21403+_0x5aae3e(0x9b5)+_0x569d9a+_0x5aae3e(0x337)+_0x30ce2b[_0x5aae3e(0x145)]+'\x22></div>':_0x5aae3e(0xfa9)+_0x569d9a+_0x5aae3e(0x337)+_0x30ce2b[_0x5aae3e(0x145)]+'\x22>';}else{if(_0x30ce2b[_0x5aae3e(0x259)]===_0x5aae3e(0xb62)){const _0x570cb8=_0x30ce2b[_0x5aae3e(0x1277)]||(_0x30ce2b[_0x5aae3e(0x2cc)]?[_0x30ce2b['imageUrl']]:[]);if(_0x570cb8['length']>0x0){const _0x400a05=_0x570cb8[_0x5aae3e(0x131d)];let _0x3a6350='';_0x3a6350=_0x5aae3e(0xec6)+_0x400a05+'\x22>',_0x570cb8[_0x5aae3e(0x12c2)]((_0x29fec8,_0x424817)=>{const _0x14699a=_0x5aae3e;_0x3a6350+='<img\x20src=\x22'+_0x29fec8+'\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片'+(_0x424817+0x1)+_0x14699a(0x10f4);}),_0x3a6350+='</div>',_0x1cb951=_0xb21403?''+_0xb21403+_0x3a6350:_0x3a6350;}}}}}return _0x1cb951;}let _0x5d333c;if(_0x189ce7[_0x3cc9f3(0x259)]===_0x3cc9f3(0x10c6)){const _0x57fcd0=_0x189ce7[_0x3cc9f3(0xb2d)]?_0x3cc9f3(0x75)+_0x5c8590(_0x189ce7[_0x3cc9f3(0xb2d)])['replace'](/\n/g,_0x3cc9f3(0x1208))+_0x3cc9f3(0xb44):'';let _0x5d993f=_0x4fd084,_0x113d45='原作者';if(_0x189ce7[_0x3cc9f3(0x47e)][_0x3cc9f3(0x1086)]===_0x3cc9f3(0xf86))_0x5d993f=_0x42f206[_0x3cc9f3(0x551)][_0x3cc9f3(0x5c6)],_0x113d45=_0x42f206[_0x3cc9f3(0x551)][_0x3cc9f3(0x308)];else{const _0x120c2b=_0x42f206[_0x3cc9f3(0x954)][_0x189ce7[_0x3cc9f3(0x47e)][_0x3cc9f3(0x1086)]];_0x120c2b&&(_0x5d993f=_0x120c2b[_0x3cc9f3(0xda2)][_0x3cc9f3(0x9c7)]||_0x4fd084),_0x113d45=_0x4e0b74(_0x189ce7[_0x3cc9f3(0x47e)]['authorOriginalName']);}_0x5d333c=_0x3cc9f3(0x5e1)+_0x57fcd0+_0x3cc9f3(0x504)+_0x5d993f+_0x3cc9f3(0x25f)+_0x113d45+_0x3cc9f3(0x20c)+_0x459554(_0x189ce7[_0x3cc9f3(0x47e)][_0x3cc9f3(0xf16)])+_0x3cc9f3(0xcbb)+_0x31d984(_0x189ce7[_0x3cc9f3(0x47e)])+_0x3cc9f3(0x1213);}else _0x5d333c=_0x3cc9f3(0x9ba)+_0x31d984(_0x189ce7)+_0x3cc9f3(0xb44);let _0x2f1812='';if(_0x189ce7['likes']&&_0x189ce7[_0x3cc9f3(0x1be)]['length']>0x0){const _0x44abcf=_0x189ce7[_0x3cc9f3(0x1be)]['map'](_0x22e560=>_0x4e0b74(_0x22e560))[_0x3cc9f3(0x56c)]('、');_0x2f1812=_0x3cc9f3(0xd25)+_0x44abcf+_0x3cc9f3(0x1447);}let _0x29b381='';_0x189ce7['comments']&&_0x189ce7[_0x3cc9f3(0x946)][_0x3cc9f3(0x131d)]>0x0&&(_0x29b381='<div\x20class=\x22post-comments-container\x22>',_0x189ce7['comments'][_0x3cc9f3(0x12c2)]((_0x28d142,_0xf92ca4)=>{const _0x3247a5=_0x3cc9f3;if(typeof _0x28d142==='object'&&_0x28d142!==null&&_0x28d142[_0x3247a5(0x7a7)]){const _0x3519d7=_0x28d142[_0x3247a5(0x7a7)],_0x4cec9e=_0x4e0b74(_0x3519d7);let _0x3d3e04;_0x30c9b4['test'](_0x28d142[_0x3247a5(0xdd5)])?_0x3d3e04=_0x3247a5(0xfa9)+_0x28d142['text']+_0x3247a5(0x18f):_0x3d3e04=_0x5c8590(_0x28d142['text']);let _0xe17421='';if(_0x28d142[_0x3247a5(0xd75)]){const _0x5e833c=_0x4e0b74(_0x28d142[_0x3247a5(0xd75)]);_0xe17421='<span\x20class=\x22commenter-name\x22>'+_0x4cec9e+_0x3247a5(0x75b)+_0x5e833c+'</span>:\x20'+_0x3d3e04;}else _0xe17421=_0x3247a5(0x7b0)+_0x4cec9e+_0x3247a5(0x395)+_0x3d3e04;_0x29b381+=_0x3247a5(0x12cc)+_0x189ce7['id']+_0x3247a5(0x13bd)+_0x3519d7+'\x22\x20data-commenter-display-name=\x22'+_0x4cec9e+_0x3247a5(0x89)+_0xe17421+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22'+_0xf92ca4+_0x3247a5(0x5ac);}else _0x29b381+=_0x3247a5(0x10ea)+_0x5c8590(String(_0x28d142))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}),_0x29b381+=_0x3cc9f3(0xb44));const _0x3c7167=_0x42f206[_0x3cc9f3(0x551)][_0x3cc9f3(0x308)],_0xaf4478=_0x189ce7['likes']&&_0x189ce7[_0x3cc9f3(0x1be)]['includes'](_0x3c7167),_0x972728=_0x42f206[_0x3cc9f3(0x884)]&&_0x42f206[_0x3cc9f3(0x884)][_0x3cc9f3(0x31c)](_0x189ce7['id']);let _0x4e1709='';_0x189ce7['type']!=='repost'&&(_0x4e1709='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>');_0x4d9155[_0x3cc9f3(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x355a6e+'\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22'+_0x189ce7['authorId']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>'+_0x4e6490+_0x3cc9f3(0xaee)+_0x459554(_0x189ce7['timestamp'])+_0x3cc9f3(0x1ce)+_0x5d333c+_0x3cc9f3(0xdf8)+_0x4e1709+_0x3cc9f3(0xc3b)+(_0xaf4478?_0x3cc9f3(0xfe1):'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20'+(_0x972728?'active':'')+_0x3cc9f3(0x3ea)+_0x2f1812+_0x3cc9f3(0x8c3)+_0x29b381+_0x3cc9f3(0x145f)+_0x53277b+_0x3cc9f3(0x85);if(!_0x4b908c){const _0x2dcf12=document[_0x3cc9f3(0xe7d)](_0x3cc9f3(0x1323));_0x2dcf12[_0x3cc9f3(0x69b)]=_0x3cc9f3(0x855),_0x2dcf12['innerHTML']=_0x3cc9f3(0x48e),_0x49becc[_0x3cc9f3(0x1079)](_0x4d9155),_0x49becc['appendChild'](_0x2dcf12);}return _0x49becc;}async function _0xb8d737(_0x12ea3c){const _0x503682=_0x204348,_0x2f7138=await _0x17d534[_0x503682(0x15b)][_0x503682(0x36d)](_0x12ea3c);if(!_0x2f7138){const _0x1c8879=document['querySelector']('.qzone-post-container[data-post-id=\x22'+_0x12ea3c+'\x22]');if(_0x1c8879)_0x1c8879['remove']();return;}const _0x9f6ec=_0x394ad5[_0x503682(0x4a8)](_0x6c9b63=>_0x6c9b63['id']===_0x12ea3c);if(_0x9f6ec>-0x1)_0x394ad5[_0x9f6ec]=_0x2f7138;const _0x511dc4=await _0x17d534[_0x503682(0xb78)][_0x503682(0x13c6)]('type')[_0x503682(0x7db)](_0x503682(0xe47))['toArray']();_0x42f206[_0x503682(0x884)]=new Set(_0x511dc4[_0x503682(0xbf6)](_0x2b0bb1=>_0x2b0bb1[_0x503682(0x1316)]['id'])),_0x280e3c(_0x2f7138);}function _0x1f0c92(_0x2ac847){const _0xa0bef7=_0x204348,_0x4d95b9=Date[_0xa0bef7(0x606)](),_0x4b7424=Math[_0xa0bef7(0xbd5)]((_0x4d95b9-_0x2ac847)/0x3e8),_0x2983df=Math['floor'](_0x4b7424/0x3c);if(_0x2983df<0x2)return'刚刚';if(_0x2983df<0x3c)return _0x2983df+_0xa0bef7(0x137a);const _0x4fa4f2=Math[_0xa0bef7(0xbd5)](_0x2983df/0x3c);if(_0x4fa4f2<0x18)return _0x4fa4f2+_0xa0bef7(0x1354);const _0x2dec67=Math[_0xa0bef7(0xbd5)](_0x4fa4f2/0x18);return _0x2dec67+'天前';}async function _0x280e3c(_0x1686f9){const _0x584709=_0x204348,_0x4c0a38=document[_0x584709(0x586)]('.qzone-post-container[data-post-id=\x22'+_0x1686f9['id']+'\x22]'),_0x184eed=!!_0x4c0a38,_0x2e35b1=_0x184eed?_0x4c0a38:document[_0x584709(0xe7d)](_0x584709(0x1323));!_0x184eed&&(_0x2e35b1[_0x584709(0x69b)]=_0x584709(0x41f),_0x2e35b1[_0x584709(0x1f4)][_0x584709(0x13bc)]=_0x1686f9['id']);const _0x482734=_0x184eed?_0x2e35b1['querySelector']('.qzone-post-item'):document[_0x584709(0xe7d)](_0x584709(0x1323));!_0x184eed&&(_0x482734[_0x584709(0x69b)]=_0x584709(0x23b));let _0x16d9d0='',_0x1bbe29='',_0x5f5090=_0x42f206[_0x584709(0x551)][_0x584709(0x5c6)];if(_0x1686f9['authorId']===_0x584709(0xf86))_0x16d9d0=_0x42f206[_0x584709(0x551)]['avatar'],_0x1bbe29=_0x42f206[_0x584709(0x551)]['nickname'];else{if(_0x42f206['chats'][_0x1686f9['authorId']]){const _0x430ff3=_0x42f206[_0x584709(0x954)][_0x1686f9['authorId']];_0x16d9d0=_0x430ff3[_0x584709(0xda2)]['aiAvatar']||_0x4fd084,_0x1bbe29=_0x430ff3['name'];}else{if(String(_0x1686f9[_0x584709(0x1086)])[_0x584709(0x13ad)]('npc_')){const _0x2caa3a=parseInt(String(_0x1686f9[_0x584709(0x1086)])['replace'](_0x584709(0xa45),''));if(!isNaN(_0x2caa3a)){const _0x255fc2=await _0x17d534[_0x584709(0x996)][_0x584709(0x36d)](_0x2caa3a);_0x255fc2?(_0x16d9d0=_0x255fc2[_0x584709(0x5c6)]||_0x482806,_0x1bbe29=_0x255fc2[_0x584709(0x132a)]):(_0x1bbe29=_0x1686f9[_0x584709(0xb85)]||_0x584709(0xb59),_0x16d9d0=_0x482806);}}else _0x1bbe29=_0x4e0b74(_0x1686f9[_0x584709(0xb85)]),_0x16d9d0=_0x4fd084;}}function _0x438d59(_0x15f3c4){const _0x128a06=_0x584709;let _0x555747='';const _0x84e2f0=_0x15f3c4[_0x128a06(0xd2d)]?_0x128a06(0x75)+_0x5c8590(_0x15f3c4[_0x128a06(0xd2d)])[_0x128a06(0x33b)](/\n/g,_0x128a06(0x1208))+_0x128a06(0xb44):'';if(_0x15f3c4['type']===_0x128a06(0xb03))_0x555747=_0x128a06(0x84e)+_0x5c8590(_0x15f3c4['content'])['replace'](/\n/g,_0x128a06(0x1208))+_0x128a06(0xb44);else{if(_0x15f3c4[_0x128a06(0x259)]==='image_post'&&_0x15f3c4[_0x128a06(0x2cc)])_0x555747=_0x84e2f0?_0x84e2f0+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x15f3c4[_0x128a06(0x2cc)]+_0x128a06(0xa8):_0x128a06(0xfa9)+_0x15f3c4[_0x128a06(0x2cc)]+'\x22\x20class=\x22chat-image\x22>';else{if(_0x15f3c4[_0x128a06(0x259)]===_0x128a06(0x1237)){const _0x3e7ee2=_0x42f206[_0x128a06(0xf0)][_0x128a06(0xf0e)]&&_0x15f3c4[_0x128a06(0xef)]?_0x128a06(0x94c)+_0x15f3c4[_0x128a06(0xef)]:_0x128a06(0x503);_0x555747=_0x84e2f0?_0x84e2f0+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x3e7ee2+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x15f3c4[_0x128a06(0x145)]+_0x128a06(0x13b7):_0x128a06(0xfa9)+_0x3e7ee2+_0x128a06(0x337)+_0x15f3c4[_0x128a06(0x145)]+'\x22>';}else{if(_0x15f3c4[_0x128a06(0x259)]===_0x128a06(0xb62)){const _0x2bfb9f=_0x15f3c4['imageUrls']||(_0x15f3c4['imageUrl']?[_0x15f3c4[_0x128a06(0x2cc)]]:[]);if(_0x2bfb9f[_0x128a06(0x131d)]>0x0){const _0x34d729=_0x2bfb9f[_0x128a06(0x131d)];let _0x5f1c9a='';_0x5f1c9a=_0x128a06(0xec6)+_0x34d729+'\x22>',_0x2bfb9f[_0x128a06(0x12c2)]((_0x1b5ed4,_0x3c4fa9)=>{const _0x2941c6=_0x128a06;_0x5f1c9a+=_0x2941c6(0xfa9)+_0x1b5ed4+_0x2941c6(0x839)+(_0x3c4fa9+0x1)+_0x2941c6(0x10f4);}),_0x5f1c9a+=_0x128a06(0xb44),_0x555747=_0x84e2f0?''+_0x84e2f0+_0x5f1c9a:_0x5f1c9a;}}}}}return _0x555747;}let _0x278cc2;if(_0x1686f9[_0x584709(0x259)]===_0x584709(0x10c6)){const _0x1ffc63=_0x1686f9[_0x584709(0xb2d)]?'<div\x20class=\x22post-content\x22>'+_0x1686f9[_0x584709(0xb2d)][_0x584709(0x33b)](/\n/g,_0x584709(0x1208))+_0x584709(0xb44):'';let _0x242d6a=_0x4fd084,_0x10cae1=_0x584709(0xd3a);if(_0x1686f9[_0x584709(0x47e)][_0x584709(0x1086)]===_0x584709(0xf86))_0x242d6a=_0x42f206[_0x584709(0x551)]['avatar'],_0x10cae1=_0x42f206[_0x584709(0x551)][_0x584709(0x308)];else{const _0x8a9242=_0x42f206[_0x584709(0x954)][_0x1686f9['originalPost'][_0x584709(0x1086)]];_0x8a9242&&(_0x242d6a=_0x8a9242[_0x584709(0xda2)]['aiAvatar']||_0x4fd084),_0x10cae1=_0x4e0b74(_0x1686f9[_0x584709(0x47e)][_0x584709(0xb85)]);}_0x278cc2=_0x584709(0x5e1)+_0x1ffc63+_0x584709(0x504)+_0x242d6a+_0x584709(0x25f)+_0x10cae1+_0x584709(0x20c)+_0x459554(_0x1686f9[_0x584709(0x47e)][_0x584709(0xf16)])+_0x584709(0xcbb)+_0x438d59(_0x1686f9['originalPost'])+_0x584709(0x1213);}else _0x278cc2=_0x584709(0x9ba)+_0x438d59(_0x1686f9)+_0x584709(0xb44);let _0x473e34='';if(_0x1686f9['likes']&&_0x1686f9[_0x584709(0x1be)]['length']>0x0){const _0x3b3f17=_0x1686f9[_0x584709(0x1be)][_0x584709(0xbf6)](_0x2ba16e=>_0x4e0b74(_0x2ba16e))[_0x584709(0x56c)]('、');_0x473e34='<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>'+_0x3b3f17+_0x584709(0x1447);}let _0x543bdc='';_0x1686f9['comments']&&_0x1686f9[_0x584709(0x946)][_0x584709(0x131d)]>0x0&&(_0x543bdc=_0x584709(0xd3b),_0x1686f9[_0x584709(0x946)][_0x584709(0x12c2)]((_0x667269,_0x3f3189)=>{const _0x45fa92=_0x584709;if(typeof _0x667269==='object'&&_0x667269!==null&&_0x667269[_0x45fa92(0x7a7)]){const _0x3b1134=_0x667269[_0x45fa92(0x7a7)],_0x439bcf=_0x4e0b74(_0x3b1134);let _0x352e4e;_0x30c9b4['test'](_0x667269[_0x45fa92(0xdd5)])?_0x352e4e=_0x45fa92(0xfa9)+_0x667269[_0x45fa92(0xdd5)]+_0x45fa92(0x18f):_0x352e4e=_0x5c8590(_0x667269[_0x45fa92(0xdd5)]);let _0xad826b='';if(_0x667269[_0x45fa92(0xd75)]){const _0x306b8b=_0x4e0b74(_0x667269[_0x45fa92(0xd75)]);_0xad826b=_0x45fa92(0x7b0)+_0x439bcf+_0x45fa92(0x75b)+_0x306b8b+'</span>:\x20'+_0x352e4e;}else _0xad826b=_0x45fa92(0x7b0)+_0x439bcf+_0x45fa92(0x395)+_0x352e4e;_0x543bdc+=_0x45fa92(0x12cc)+_0x1686f9['id']+_0x45fa92(0x13bd)+_0x3b1134+_0x45fa92(0x105e)+_0x439bcf+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>'+_0xad826b+_0x45fa92(0x95e)+_0x3f3189+_0x45fa92(0x5ac);}else _0x543bdc+=_0x45fa92(0x10ea)+String(_0x667269)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}),_0x543bdc+=_0x584709(0xb44));const _0x256b41=_0x42f206[_0x584709(0x551)][_0x584709(0x308)],_0x2d4967=_0x1686f9['likes']&&_0x1686f9[_0x584709(0x1be)][_0x584709(0xd8d)](_0x256b41),_0x4d5a04=_0x42f206['favoritedPostIds']&&_0x42f206['favoritedPostIds'][_0x584709(0x31c)](_0x1686f9['id']);let _0xbac99e='';_0x1686f9['type']!==_0x584709(0x10c6)&&(_0xbac99e='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>');_0x482734['innerHTML']=_0x584709(0x7d6)+_0x16d9d0+_0x584709(0x968)+_0x1686f9[_0x584709(0x1086)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>'+_0x1bbe29+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x459554(_0x1686f9[_0x584709(0xf16)])+_0x584709(0x1ce)+_0x278cc2+_0x584709(0xdf8)+_0xbac99e+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20'+(_0x2d4967?_0x584709(0xfe1):'')+_0x584709(0x391)+(_0x4d5a04?_0x584709(0xfe1):'')+_0x584709(0x3ea)+_0x473e34+_0x584709(0x8c3)+_0x543bdc+_0x584709(0x145f)+_0x5f5090+_0x584709(0x85);if(!_0x184eed){const _0x1b9f0c=document[_0x584709(0xe7d)](_0x584709(0x1323));_0x1b9f0c[_0x584709(0x69b)]=_0x584709(0x855),_0x1b9f0c[_0x584709(0x110d)]='<span>删除</span>',_0x2e35b1['appendChild'](_0x482734),_0x2e35b1[_0x584709(0x1079)](_0x1b9f0c);}return _0x2e35b1;}async function _0xb8d737(_0x23bd33){const _0x6d67e6=_0x204348,_0x2fec25=await _0x17d534['qzonePosts'][_0x6d67e6(0x36d)](_0x23bd33);if(!_0x2fec25){const _0x112a79=document['querySelector'](_0x6d67e6(0xe23)+_0x23bd33+'\x22]');_0x112a79&&_0x112a79[_0x6d67e6(0x1097)]();return;}const _0x2baab5=_0x394ad5['findIndex'](_0x3ab18b=>_0x3ab18b['id']===_0x23bd33);_0x2baab5>-0x1&&(_0x394ad5[_0x2baab5]=_0x2fec25);const _0x32be8b=await _0x17d534[_0x6d67e6(0xb78)]['where'](_0x6d67e6(0x259))[_0x6d67e6(0x7db)](_0x6d67e6(0xe47))[_0x6d67e6(0x511)]();_0x42f206[_0x6d67e6(0x884)]=new Set(_0x32be8b[_0x6d67e6(0xbf6)](_0x584d9e=>_0x584d9e[_0x6d67e6(0x1316)]['id'])),await _0x280e3c(_0x2fec25);}async function _0x316550(){const _0x5edac4=_0x204348,_0x10a65c=document[_0x5edac4(0x458)]('qzone-posts-list');if(!_0x10a65c)return;const [_0x1f3f46,_0x139557]=await Promise[_0x5edac4(0xfe2)]([_0x17d534[_0x5edac4(0x15b)][_0x5edac4(0x50b)]('timestamp')[_0x5edac4(0x115b)]()['filter'](_0x1c4868=>!_0x1c4868[_0x5edac4(0xf34)])[_0x5edac4(0x511)](),_0x17d534[_0x5edac4(0xb78)][_0x5edac4(0x13c6)](_0x5edac4(0x259))['equals'](_0x5edac4(0xe47))['toArray']()]);_0x394ad5=_0x1f3f46,_0x42f206['favoritedPostIds']=new Set(_0x139557['map'](_0x40a302=>_0x40a302['content']['id'])),_0x10a65c[_0x5edac4(0x110d)]='',_0x577f17=0x0;if(_0x394ad5[_0x5edac4(0x131d)]===0x0){_0x10a65c[_0x5edac4(0x110d)]=_0x5edac4(0xa99);return;}_0x2b7986();}async function _0x2b7986(){const _0x3fe395=_0x204348;if(_0x1a7b40)return;_0x1a7b40=!![];const _0x324314=document[_0x3fe395(0x458)](_0x3fe395(0x1ca));if(!_0x324314){_0x1a7b40=![];return;}_0x4c8ce6(_0x324314,_0x3fe395(0x151)),setTimeout(async()=>{const _0x353e99=_0x3fe395;_0x17adee(_0x324314);const _0x4ea58f=_0x577f17,_0x19fec9=_0x577f17+_0x3fd33d,_0x14f45f=_0x394ad5['slice'](_0x4ea58f,_0x19fec9),_0x1f40fa=document[_0x353e99(0xdb7)]();for(const _0x1ee717 of _0x14f45f){const _0x40c294=await _0x280e3c(_0x1ee717);_0x1f40fa[_0x353e99(0x1079)](_0x40c294);}_0x324314[_0x353e99(0x1079)](_0x1f40fa),_0x577f17+=_0x14f45f[_0x353e99(0x131d)],_0x1a7b40=![];},0x1f4);}function _0x4fdb91(_0x12a7d6,_0x2c00c1){const _0x4e22ef=_0x204348,_0x13556f=_0xf96d9b[_0x4e22ef(0xfec)],_0x503bdb=_0xf96d9b[_0x4e22ef(0x1383)];_0x503bdb[_0x4e22ef(0x110d)]='';_0x42f206[_0x4e22ef(0x1294)][_0x4e22ef(0x131d)]===0x0?_0x503bdb['innerHTML']=_0x4e22ef(0x99e):_0x42f206[_0x4e22ef(0x1294)][_0x4e22ef(0x12c2)](_0x15c021=>{const _0x3725a0=_0x4e22ef,_0x2b4dda=document[_0x3725a0(0xe7d)](_0x3725a0(0x1323));_0x2b4dda[_0x3725a0(0x69b)]=_0x3725a0(0x9d6),_0x2b4dda[_0x3725a0(0x1104)][_0x3725a0(0xf7)]='url('+_0x15c021[_0x3725a0(0x1377)]+')',_0x2b4dda[_0x3725a0(0x316)]=_0x15c021['name'],_0x503bdb['appendChild'](_0x2b4dda);});const _0x1e7349=_0x2c00c1['getBoundingClientRect'](),_0x4c5cc9=document[_0x4e22ef(0x458)](_0x4e22ef(0xb3e))['getBoundingClientRect']();_0x13556f[_0x4e22ef(0x1104)]['display']=_0x4e22ef(0x82b);const _0x10e9fb=_0x13556f['getBoundingClientRect'](),_0x11e99e=_0x10e9fb[_0x4e22ef(0x120b)],_0x25797f=_0x10e9fb[_0x4e22ef(0x1147)];_0x13556f[_0x4e22ef(0x1104)][_0x4e22ef(0x76f)]=_0x1e7349[_0x4e22ef(0x76f)]-_0x11e99e-0x5-_0x4c5cc9['top']+'px';const _0xa8ae51=_0x1e7349[_0x4e22ef(0x125)]-_0x4c5cc9[_0x4e22ef(0x125)];_0xa8ae51+_0x25797f>_0x4c5cc9[_0x4e22ef(0x1147)]?(_0x13556f[_0x4e22ef(0x1104)][_0x4e22ef(0x125)]=_0x4e22ef(0xf29),_0x13556f['style'][_0x4e22ef(0xa40)]=_0x4e22ef(0xb00)):(_0x13556f[_0x4e22ef(0x1104)][_0x4e22ef(0x125)]=_0xa8ae51+'px',_0x13556f[_0x4e22ef(0x1104)]['right']=_0x4e22ef(0xf29)),_0xf96d9b[_0x4e22ef(0x12f8)]=!![],_0xf96d9b[_0x4e22ef(0x10a2)]=_0x12a7d6;}function _0x117c0b(){const _0x40ba5d=_0x204348;_0xf96d9b['isOpen']&&(_0xf96d9b[_0x40ba5d(0xfec)][_0x40ba5d(0x1104)][_0x40ba5d(0x4db)]=_0x40ba5d(0x464),_0xf96d9b['isOpen']=![],_0xf96d9b[_0x40ba5d(0x10a2)]=null);}async function _0x4bce80(_0x58cdc2,_0x2853bd){const _0x6beffc=_0x204348;if(!_0x2853bd||!_0x2853bd[_0x6beffc(0x1377)])return;const _0x3ce334=await _0x17d534[_0x6beffc(0x15b)]['get'](_0x58cdc2);if(!_0x3ce334){console[_0x6beffc(0xb61)](_0x6beffc(0xcc1),_0x58cdc2);return;}!_0x3ce334[_0x6beffc(0x946)]&&(_0x3ce334[_0x6beffc(0x946)]=[]);const _0x246812={'commenterName':_0x42f206['qzoneSettings'][_0x6beffc(0x308)],'text':_0x2853bd[_0x6beffc(0x1377)],'meaning':_0x2853bd['name'],'timestamp':Date[_0x6beffc(0x606)]()};_0x3ce334[_0x6beffc(0x946)]['push'](_0x246812),await _0x17d534[_0x6beffc(0x15b)][_0x6beffc(0x938)](_0x58cdc2,{'comments':_0x3ce334[_0x6beffc(0x946)]}),_0x117c0b(),await _0x316550();const _0x205df6=(_0x3ce334[_0x6beffc(0xd2d)]||_0x3ce334[_0x6beffc(0x1316)]||_0x6beffc(0x976))[_0x6beffc(0xa6d)](0x0,0x1e);for(const _0x2a14a5 in _0x42f206[_0x6beffc(0x954)]){const _0x16fc02=_0x42f206[_0x6beffc(0x954)][_0x2a14a5];if(!_0x16fc02[_0x6beffc(0x726)]){const _0x3ae9f1=_0x6beffc(0xb69)+_0x42f206[_0x6beffc(0x551)]['nickname']+_0x6beffc(0x1341)+_0x58cdc2+',\x20内容摘要:\x20“'+_0x205df6+_0x6beffc(0xe4a)+_0x2853bd['name']+'”。请你对此作出回应。]',_0x1e0ad1={'role':_0x6beffc(0x1370),'content':_0x3ae9f1,'timestamp':Date['now'](),'isHidden':!![]};_0x16fc02[_0x6beffc(0x1d5)]['push'](_0x1e0ad1),await _0x17d534[_0x6beffc(0x954)][_0x6beffc(0xf3f)](_0x16fc02);}}}function _0x180ac7(_0x3f4d5d){const _0x37dee1=_0x204348;_0x51ecb2=_0x3f4d5d,document[_0x37dee1(0x458)]('repost-comment-input')['value']='',document[_0x37dee1(0x458)](_0x37dee1(0xfd5))[_0x37dee1(0x11c2)][_0x37dee1(0xa58)](_0x37dee1(0x67d));}function _0x3b0765(){const _0x52dda2=_0x204348;document[_0x52dda2(0x458)](_0x52dda2(0xfd5))[_0x52dda2(0x11c2)][_0x52dda2(0x1097)](_0x52dda2(0x67d)),_0x51ecb2=null;}async function _0x1d50d3(){const _0x3ba42d=_0x204348;if(!_0x51ecb2)return;const _0x3c36d8=document[_0x3ba42d(0x458)](_0x3ba42d(0x8a8))[_0x3ba42d(0x8dd)][_0x3ba42d(0x2aa)](),_0x308f1a=await _0x17d534[_0x3ba42d(0x15b)][_0x3ba42d(0x36d)](_0x51ecb2);if(!_0x308f1a){alert(_0x3ba42d(0x12c3)),_0x3b0765();return;}const _0x85d6a={'type':'repost','timestamp':Date['now'](),'authorId':_0x3ba42d(0xf86),'repostComment':_0x3c36d8,'originalPost':_0x308f1a,'visibleGroupIds':null};await _0x17d534[_0x3ba42d(0x15b)][_0x3ba42d(0xa58)](_0x85d6a),_0x3b0765(),await _0x316550(),alert(_0x3ba42d(0xb83));}function _0x2a636c(_0x34ec04){const _0x2d0d85=_0x204348,_0x18377f=document[_0x2d0d85(0x458)](_0x2d0d85(0x1331));_0x18377f['innerHTML']='';if(_0x34ec04[_0x2d0d85(0x131d)]===0x0){const _0x25d52b=document[_0x2d0d85(0x458)](_0x2d0d85(0xa21))[_0x2d0d85(0x8dd)],_0x2065ec=_0x25d52b?'未找到相关收藏':'你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！';_0x18377f['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>'+_0x2065ec+'</p>';return;}for(const _0x2b545e of _0x34ec04){const _0x482774=document[_0x2d0d85(0xe7d)](_0x2d0d85(0x1323));_0x482774['className']=_0x2d0d85(0x1d7),_0x482774[_0x2d0d85(0x1f4)][_0x2d0d85(0x75a)]=_0x2b545e['id'];let _0x757718='',_0x680bd5='',_0x933262='',_0x176993='';if(_0x2b545e[_0x2d0d85(0x259)]===_0x2d0d85(0xe47)){const _0x1d910b=_0x2b545e[_0x2d0d85(0x1316)];_0x933262=_0x2d0d85(0xa64);let _0x1fb042=_0x4fd084,_0x4baaf3='未知用户';if(_0x1d910b[_0x2d0d85(0x1086)]==='user')_0x1fb042=_0x42f206[_0x2d0d85(0x551)][_0x2d0d85(0x5c6)],_0x4baaf3=_0x42f206[_0x2d0d85(0x551)][_0x2d0d85(0x308)];else _0x42f206['chats'][_0x1d910b[_0x2d0d85(0x1086)]]&&(_0x1fb042=_0x42f206[_0x2d0d85(0x954)][_0x1d910b['authorId']][_0x2d0d85(0xda2)]['aiAvatar'],_0x4baaf3=_0x42f206[_0x2d0d85(0x954)][_0x1d910b[_0x2d0d85(0x1086)]][_0x2d0d85(0x132a)]);_0x757718=_0x2d0d85(0xfa9)+_0x1fb042+_0x2d0d85(0x11f0)+_0x4baaf3+'</div></div>';const _0x5f21e3=_0x1d910b[_0x2d0d85(0xd2d)]?'<div\x20class=\x22post-content\x22>'+_0x1d910b[_0x2d0d85(0xd2d)][_0x2d0d85(0x33b)](/\n/g,_0x2d0d85(0x1208))+_0x2d0d85(0xb44):'';if(_0x1d910b[_0x2d0d85(0x259)]===_0x2d0d85(0xb03))_0x680bd5=_0x2d0d85(0x75)+_0x1d910b['content'][_0x2d0d85(0x33b)](/\n/g,_0x2d0d85(0x1208))+_0x2d0d85(0xb44);else{if(_0x1d910b[_0x2d0d85(0x259)]===_0x2d0d85(0xe7f)&&_0x1d910b[_0x2d0d85(0x2cc)]){const _0x46374f=_0x42f206[_0x2d0d85(0xf0)][_0x2d0d85(0xf0e)]&&_0x1d910b[_0x2d0d85(0xef)]?_0x2d0d85(0x94c)+_0x1d910b[_0x2d0d85(0xef)]:_0x2d0d85(0x503);_0x680bd5=_0x5f21e3?_0x5f21e3+_0x2d0d85(0x9b5)+_0x46374f+_0x2d0d85(0xa8):_0x2d0d85(0xfa9)+_0x46374f+'\x22\x20class=\x22chat-image\x22>';}else{if(_0x1d910b[_0x2d0d85(0x259)]===_0x2d0d85(0x1237)){const _0xdae1df=_0x42f206[_0x2d0d85(0xf0)]['enableAiDrawing']&&_0x1d910b['image_prompt']?_0x2d0d85(0x94c)+_0x1d910b[_0x2d0d85(0xef)]:_0x2d0d85(0x503);_0x680bd5=_0x5f21e3?_0x5f21e3+_0x2d0d85(0x9b5)+_0xdae1df+_0x2d0d85(0x337)+_0x1d910b[_0x2d0d85(0x145)]+_0x2d0d85(0x13b7):_0x2d0d85(0xfa9)+_0xdae1df+_0x2d0d85(0x337)+_0x1d910b['hiddenContent']+'\x22>';}}}let _0x178cb4='';_0x1d910b[_0x2d0d85(0x1be)]&&_0x1d910b[_0x2d0d85(0x1be)][_0x2d0d85(0x131d)]>0x0&&(_0x178cb4=_0x2d0d85(0xdf5)+_0x1d910b[_0x2d0d85(0x1be)][_0x2d0d85(0x56c)]('、')+'\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>');let _0x3b2cd6='';_0x1d910b[_0x2d0d85(0x946)]&&_0x1d910b[_0x2d0d85(0x946)][_0x2d0d85(0x131d)]>0x0&&(_0x3b2cd6=_0x2d0d85(0xd3b),_0x1d910b[_0x2d0d85(0x946)][_0x2d0d85(0x12c2)]((_0x1be7d5,_0x25fcc9)=>{const _0x1db527=_0x2d0d85;if(typeof _0x1be7d5===_0x1db527(0x620)&&_0x1be7d5!==null&&_0x1be7d5[_0x1db527(0x7a7)]){const _0x2fcc18=_0x1be7d5[_0x1db527(0x7a7)],_0x5bb98a=_0x4e0b74(_0x2fcc18);let _0x94efa6;_0x30c9b4[_0x1db527(0x9c0)](_0x1be7d5[_0x1db527(0xdd5)])?_0x94efa6=_0x1db527(0xfa9)+_0x1be7d5[_0x1db527(0xdd5)]+_0x1db527(0x18f):_0x94efa6=_0x1be7d5[_0x1db527(0xdd5)];let _0x214bde='';if(_0x1be7d5[_0x1db527(0xd75)]){const _0x1dbf1a=_0x4e0b74(_0x1be7d5[_0x1db527(0xd75)]);_0x214bde='<span\x20class=\x22commenter-name\x22>'+_0x5bb98a+_0x1db527(0x75b)+_0x1dbf1a+_0x1db527(0x395)+_0x94efa6;}else _0x214bde=_0x1db527(0x7b0)+_0x5bb98a+_0x1db527(0x395)+_0x94efa6;_0x3b2cd6+='<div\x20class=\x22comment-item\x22\x20data-post-id=\x22'+_0x1d910b['id']+_0x1db527(0x13bd)+_0x2fcc18+_0x1db527(0x105e)+_0x5bb98a+_0x1db527(0xa24)+_0x214bde+_0x1db527(0xd09)+_0x25fcc9+_0x1db527(0x53d);}else _0x3b2cd6+='<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>'+String(_0x1be7d5)+_0x1db527(0x13c3);}),_0x3b2cd6+=_0x2d0d85(0xb44)),_0x176993=''+_0x178cb4+_0x3b2cd6;}else{if(_0x2b545e[_0x2d0d85(0x259)]==='chat_message'){const _0x99a49=_0x2b545e[_0x2d0d85(0x1316)],_0x9fe885=_0x42f206['chats'][_0x2b545e[_0x2d0d85(0xfca)]];if(!_0x9fe885)continue;_0x933262=_0x2d0d85(0xf2c)+_0x9fe885[_0x2d0d85(0x132a)]+_0x2d0d85(0xb1a);const _0x2219ad=_0x99a49[_0x2d0d85(0xaeb)]===_0x2d0d85(0xf86);let _0x240e9d,_0x138f33;if(_0x2219ad)_0x240e9d=_0x9fe885[_0x2d0d85(0x726)]?_0x9fe885[_0x2d0d85(0xda2)][_0x2d0d85(0xc7d)]||'我':'我',_0x138f33=_0x9fe885[_0x2d0d85(0xda2)]['myAvatar']||(_0x9fe885[_0x2d0d85(0x726)]?_0x502840:_0x4fd084);else{if(_0x9fe885[_0x2d0d85(0x726)]){const _0x1b7145=_0x9fe885[_0x2d0d85(0xfa8)][_0x2d0d85(0xb07)](_0x1c9a51=>_0x1c9a51[_0x2d0d85(0xa1)]===_0x99a49[_0x2d0d85(0x2a3)]);_0x240e9d=_0x99a49[_0x2d0d85(0x2a3)],_0x138f33=_0x1b7145?_0x1b7145['avatar']:_0x482806;}else _0x240e9d=_0x9fe885['name'],_0x138f33=_0x9fe885[_0x2d0d85(0xda2)][_0x2d0d85(0x9c7)]||_0x4fd084;}_0x757718=_0x2d0d85(0xfa9)+_0x138f33+_0x2d0d85(0x11f0)+_0x240e9d+_0x2d0d85(0xda6);if(typeof _0x99a49[_0x2d0d85(0x1316)]===_0x2d0d85(0x861)&&_0x30c9b4[_0x2d0d85(0x9c0)](_0x99a49[_0x2d0d85(0x1316)]))_0x680bd5=_0x2d0d85(0xfa9)+_0x99a49['content']+_0x2d0d85(0x444);else Array[_0x2d0d85(0x971)](_0x99a49['content'])&&_0x99a49[_0x2d0d85(0x1316)][0x0]?.['type']==='image_url'?_0x680bd5=_0x2d0d85(0xfa9)+_0x99a49['content'][0x0]['image_url'][_0x2d0d85(0x1377)]+_0x2d0d85(0x87d):_0x680bd5=String(_0x99a49[_0x2d0d85(0x1316)]||'')[_0x2d0d85(0x33b)](/\n/g,_0x2d0d85(0x1208));}else{if(_0x2b545e['type']==='char_diary'){const _0xd2bfeb=_0x2b545e[_0x2d0d85(0x1316)];_0x933262=_0x2d0d85(0x8f3)+_0xd2bfeb[_0x2d0d85(0xe56)]+_0x2d0d85(0xc64);const _0x99a59f=_0x42f206[_0x2d0d85(0x954)][_0xd2bfeb[_0x2d0d85(0x92b)]],_0x177fac=_0x99a59f?_0x99a59f[_0x2d0d85(0xda2)][_0x2d0d85(0x9c7)]:_0x4fd084;_0x757718='<img\x20src=\x22'+_0x177fac+_0x2d0d85(0x11f0)+_0xd2bfeb[_0x2d0d85(0xe56)]+_0x2d0d85(0xda6);const _0x2a8792=_0xd2bfeb[_0x2d0d85(0x1316)]||'',_0x5d2f5e=_0x5c8590(_0x2a8792)[_0x2d0d85(0x33b)](/\n/g,_0x2d0d85(0x1208));_0x680bd5=_0x2d0d85(0x25a)+_0xd2bfeb['title']+_0x2d0d85(0xa2)+_0x5d2f5e+_0x2d0d85(0x12c5);}else{if(_0x2b545e[_0x2d0d85(0x259)]===_0x2d0d85(0xa38)){const _0x248286=_0x2b545e[_0x2d0d85(0x1316)];_0x933262=_0x2d0d85(0x8f3)+_0x248286[_0x2d0d85(0xe56)]+_0x2d0d85(0x129a);const _0x345e3a=_0x42f206[_0x2d0d85(0x954)][_0x248286[_0x2d0d85(0x92b)]],_0x260253=_0x345e3a?_0x345e3a[_0x2d0d85(0xda2)][_0x2d0d85(0x9c7)]:_0x4fd084;_0x757718='<img\x20src=\x22'+_0x260253+_0x2d0d85(0x11f0)+_0x248286[_0x2d0d85(0xe56)]+_0x2d0d85(0xda6),_0x680bd5=_0x2d0d85(0xdcb)+_0x248286[_0x2d0d85(0x316)]+_0x2d0d85(0xde)+(_0x248286[_0x2d0d85(0x1316)]||'')[_0x2d0d85(0x33b)](/\n/g,_0x2d0d85(0x1208))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}else{if(_0x2b545e[_0x2d0d85(0x259)]==='char_memo'){const _0x434297=_0x2b545e['content'];_0x933262=_0x2d0d85(0x8f3)+_0x434297[_0x2d0d85(0xe56)]+_0x2d0d85(0x9d4);const _0xd8c87b=_0x42f206[_0x2d0d85(0x954)][_0x434297['characterId']],_0x542c05=_0xd8c87b?_0xd8c87b[_0x2d0d85(0xda2)][_0x2d0d85(0x9c7)]:_0x4fd084;_0x757718=_0x2d0d85(0xfa9)+_0x542c05+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x434297[_0x2d0d85(0xe56)]+_0x2d0d85(0xda6),_0x680bd5=_0x2d0d85(0x1080)+_0x434297['title']+_0x2d0d85(0x928)+_0x434297[_0x2d0d85(0x1316)][_0x2d0d85(0x33b)](/\n/g,'<br>')+'</div>\x0a\x20\x20\x20\x20';}}}}}_0x482774[_0x2d0d85(0x110d)]=_0x2d0d85(0x4ae)+_0x757718+_0x2d0d85(0xf6b)+_0x933262+'</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>'+_0x680bd5+_0x2d0d85(0x704)+_0x176993,_0x18377f[_0x2d0d85(0x1079)](_0x482774);}}async function _0x25490b(){const _0x4906d8=_0x204348;allFavoriteItems=await _0x17d534[_0x4906d8(0xb78)][_0x4906d8(0x50b)](_0x4906d8(0xf16))[_0x4906d8(0x115b)]()[_0x4906d8(0x511)]();const _0x38b0fe=document['getElementById'](_0x4906d8(0xa21)),_0xa10830=document[_0x4906d8(0x458)](_0x4906d8(0x130d));_0x38b0fe[_0x4906d8(0x8dd)]='',_0xa10830[_0x4906d8(0x1104)][_0x4906d8(0x4db)]=_0x4906d8(0x464),_0x2a636c(allFavoriteItems);}function _0x56eadb(){const _0x33d103=_0x204348;document['getElementById'](_0x33d103(0x1314))[_0x33d103(0x8dd)]='',document['getElementById']('post-image-preview')[_0x33d103(0x577)]='',document['getElementById']('post-image-description')[_0x33d103(0x8dd)]='',document['getElementById']('post-image-preview-container')[_0x33d103(0x11c2)][_0x33d103(0x1097)](_0x33d103(0x67d)),document[_0x33d103(0x458)]('post-image-desc-group')[_0x33d103(0x1104)][_0x33d103(0x4db)]=_0x33d103(0x464),document[_0x33d103(0x458)](_0x33d103(0x3ad))['value']='',document[_0x33d103(0x458)]('post-hidden-text')['value']='',document[_0x33d103(0x458)](_0x33d103(0xccc))[_0x33d103(0x1122)]();}async function _0x15e238(){const _0x2b79f6=_0x204348,_0x2e4ce7=await _0x2532b9(_0x2b79f6(0x47f),_0x2b79f6(0x1b5),{'confirmButtonClass':_0x2b79f6(0x4d3),'confirmText':_0x2b79f6(0xecc)});if(!_0x2e4ce7)return;await _0x34fce8(_0x2b79f6(0x12b9),'正在开始清理冗余数据，请不要关闭页面...'),console['log']('冗余数据清理流程已启动...');let _0x30d0b9={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0x17d534[_0x2b79f6(0x9a7)]('rw',_0x17d534['tables'],async()=>{const _0x8745af=_0x2b79f6,_0x3c60b8=await _0x17d534[_0x8745af(0x954)]['toArray'](),_0x59a0a8=await _0x17d534[_0x8745af(0x996)][_0x8745af(0x511)](),_0x34d86e=new Set(_0x3c60b8[_0x8745af(0xbf6)](_0x3a9934=>_0x3a9934['id'])),_0x36dda2=new Set(_0x59a0a8[_0x8745af(0xbf6)](_0x298b24=>_0x8745af(0xa45)+_0x298b24['id'])),_0x2410eb=new Set(_0x3c60b8['filter'](_0x1d6fda=>!_0x1d6fda[_0x8745af(0x726)])[_0x8745af(0xbf6)](_0x28cc44=>_0x28cc44[_0x8745af(0xa1)]));_0x2410eb['add'](_0x42f206[_0x8745af(0x551)][_0x8745af(0x308)]||'{{user}}'),_0x59a0a8['forEach'](_0x187e6a=>_0x2410eb['add'](_0x187e6a['name']));for(const _0x43cea1 of _0x3c60b8){let _0x2430d0=![];if(_0x43cea1[_0x8745af(0x726)]&&_0x43cea1[_0x8745af(0xfa8)]){const _0x430ccf=_0x43cea1['members'][_0x8745af(0x131d)];_0x43cea1[_0x8745af(0xfa8)]=_0x43cea1['members'][_0x8745af(0xaf1)](_0x3dfb41=>_0x34d86e[_0x8745af(0x31c)](_0x3dfb41['id'])||_0x36dda2[_0x8745af(0x31c)](_0x3dfb41['id'])),_0x43cea1[_0x8745af(0xfa8)][_0x8745af(0x131d)]<_0x430ccf&&(_0x30d0b9['groupMembers']+=_0x430ccf-_0x43cea1[_0x8745af(0xfa8)][_0x8745af(0x131d)],_0x2430d0=!![]);}if(_0x43cea1[_0x8745af(0xda2)]?.['linkedMemoryChatIds']?.[_0x8745af(0x131d)]>0x0){const _0x23bc10=_0x43cea1[_0x8745af(0xda2)][_0x8745af(0x1448)][_0x8745af(0x131d)];_0x43cea1['settings']['linkedMemoryChatIds']=_0x43cea1[_0x8745af(0xda2)][_0x8745af(0x1448)][_0x8745af(0xaf1)](_0x1d5b85=>_0x34d86e[_0x8745af(0x31c)](_0x1d5b85)),_0x43cea1[_0x8745af(0xda2)][_0x8745af(0x1448)]['length']<_0x23bc10&&(_0x30d0b9['chatLinks']+=_0x23bc10-_0x43cea1[_0x8745af(0xda2)]['linkedMemoryChatIds'][_0x8745af(0x131d)],_0x2430d0=!![]);}_0x2430d0&&await _0x17d534['chats']['put'](_0x43cea1);}const _0x455384=await _0x17d534[_0x8745af(0x15b)][_0x8745af(0x511)]();for(const _0x35678f of _0x455384){let _0x1fdb0d=![];const _0x376c72=_0x35678f[_0x8745af(0x1086)]===_0x8745af(0xf86)||_0x34d86e[_0x8745af(0x31c)](_0x35678f['authorId'])||_0x36dda2['has'](_0x35678f[_0x8745af(0x1086)]);if(!_0x376c72){await _0x17d534[_0x8745af(0x15b)]['delete'](_0x35678f['id']),_0x30d0b9[_0x8745af(0x11c3)]++;continue;}if(_0x35678f[_0x8745af(0x1be)]&&_0x35678f[_0x8745af(0x1be)]['length']>0x0){const _0x2b7022=_0x35678f[_0x8745af(0x1be)][_0x8745af(0x131d)];_0x35678f[_0x8745af(0x1be)]=_0x35678f[_0x8745af(0x1be)][_0x8745af(0xaf1)](_0x227994=>_0x2410eb['has'](_0x227994)),_0x35678f[_0x8745af(0x1be)][_0x8745af(0x131d)]<_0x2b7022&&(_0x30d0b9[_0x8745af(0x1be)]+=_0x2b7022-_0x35678f[_0x8745af(0x1be)]['length'],_0x1fdb0d=!![]);}if(_0x35678f['comments']&&_0x35678f['comments'][_0x8745af(0x131d)]>0x0){const _0x4d93f8=_0x35678f[_0x8745af(0x946)][_0x8745af(0x131d)];_0x35678f['comments']=_0x35678f['comments'][_0x8745af(0xaf1)](_0x5b410f=>{const _0x90d7ce=_0x8745af;if(typeof _0x5b410f===_0x90d7ce(0x620)&&_0x5b410f[_0x90d7ce(0x7a7)])return _0x2410eb[_0x90d7ce(0x31c)](_0x5b410f[_0x90d7ce(0x7a7)]);return!![];}),_0x35678f[_0x8745af(0x946)][_0x8745af(0x131d)]<_0x4d93f8&&(_0x30d0b9['comments']+=_0x4d93f8-_0x35678f[_0x8745af(0x946)][_0x8745af(0x131d)],_0x1fdb0d=!![]);}_0x1fdb0d&&await _0x17d534[_0x8745af(0x15b)]['put'](_0x35678f);}await _0x17d534[_0x8745af(0x414)][_0x8745af(0x13c6)](_0x8745af(0xfca))[_0x8745af(0x480)]([..._0x34d86e])[_0x8745af(0x195)]()[_0x8745af(0x1260)](_0x456ef3=>_0x30d0b9['memories']+=_0x456ef3),await _0x17d534['callRecords'][_0x8745af(0x13c6)](_0x8745af(0xfca))['noneOf']([..._0x34d86e])[_0x8745af(0x195)]()['then'](_0x3d3679=>_0x30d0b9[_0x8745af(0x920)]+=_0x3d3679);const _0x49dd8a=await _0x17d534[_0x8745af(0x65a)][_0x8745af(0x511)]();for(const _0x467330 of _0x49dd8a){_0x467330[_0x8745af(0xfca)]!==_0x8745af(0x655)&&!_0x34d86e[_0x8745af(0x31c)](_0x467330[_0x8745af(0xfca)])&&(await _0x17d534[_0x8745af(0x65a)][_0x8745af(0x195)](_0x467330['id']),_0x30d0b9[_0x8745af(0x65a)]++);}});let _0x71321f='✅\x20清理完成！\x0a\x0a',_0x23711d=![];Object[_0x2b79f6(0x1309)](_0x30d0b9)['forEach'](([_0x1fc542,_0x2f79c4])=>{const _0x3776bc=_0x2b79f6;if(_0x2f79c4>0x0){const _0xd39b0={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':'通话记录','renderingRules':_0x3776bc(0x746),'groupMembers':_0x3776bc(0xfd),'chatLinks':'记忆链接'};_0x71321f+=_0x3776bc(0x12eb)+_0x2f79c4+_0x3776bc(0x1044)+(_0xd39b0[_0x1fc542]||_0x1fc542)+'。\x0a',_0x23711d=!![];}});!_0x23711d&&(_0x71321f=_0x2b79f6(0x583));_0x71321f+=_0x2b79f6(0x439),await _0x34fce8('操作成功',_0x71321f);const _0x666b59=await _0x2532b9(_0x2b79f6(0x559),_0x2b79f6(0xf36));_0x666b59&&location[_0x2b79f6(0x88a)]();}catch(_0x508e8a){console[_0x2b79f6(0xb61)](_0x2b79f6(0xca8),_0x508e8a),await _0x34fce8('清理失败',_0x2b79f6(0x389)+_0x508e8a['message']);}}async function _0x5891e8(){const _0xfd0897=_0x204348;try{const _0x3d8879={'version':0x1,'timestamp':Date[_0xfd0897(0x606)]()},[_0x518487,_0x316647,_0x41aced,_0x21962f,_0x47345c,_0x5eda7c,_0x54d2c2,_0x350292,_0xdeac0d,_0x3da7d2,_0x5a667a,_0x35ac8a,_0x247e1f,_0x42976a,_0x3a4a12,_0x558b8a,_0x426509,_0x79c73d,_0x260f36,_0x31c48f,_0x1c8f8e,_0x14a218,_0x503086,_0x373154,_0x5dafcd]=await Promise[_0xfd0897(0xfe2)]([_0x17d534[_0xfd0897(0x954)][_0xfd0897(0x511)](),_0x17d534[_0xfd0897(0xab7)][_0xfd0897(0x511)](),_0x17d534['userStickers'][_0xfd0897(0x511)](),_0x17d534[_0xfd0897(0x5cb)][_0xfd0897(0x36d)](_0xfd0897(0x1442)),_0x17d534['globalSettings'][_0xfd0897(0x36d)]('main'),_0x17d534[_0xfd0897(0xa84)][_0xfd0897(0x511)](),_0x17d534[_0xfd0897(0xd3)][_0xfd0897(0x36d)]('main'),_0x17d534[_0xfd0897(0x551)][_0xfd0897(0x36d)](_0xfd0897(0x1442)),_0x17d534[_0xfd0897(0x15b)]['toArray'](),_0x17d534[_0xfd0897(0x1001)]['toArray'](),_0x17d534[_0xfd0897(0xe15)]['toArray'](),_0x17d534[_0xfd0897(0xb78)][_0xfd0897(0x511)](),_0x17d534[_0xfd0897(0x10a5)][_0xfd0897(0x511)](),_0x17d534[_0xfd0897(0x414)]['toArray'](),_0x17d534['worldBookCategories']['toArray'](),_0x17d534[_0xfd0897(0x8b5)][_0xfd0897(0x511)](),_0x17d534[_0xfd0897(0x122c)][_0xfd0897(0x511)](),_0x17d534[_0xfd0897(0x920)][_0xfd0897(0x511)](),_0x17d534[_0xfd0897(0x65a)][_0xfd0897(0x511)](),_0x17d534[_0xfd0897(0xaf9)][_0xfd0897(0x511)](),_0x17d534[_0xfd0897(0x140b)][_0xfd0897(0x511)](),_0x17d534['appearancePresets'][_0xfd0897(0x511)](),_0x17d534[_0xfd0897(0x843)][_0xfd0897(0x511)](),_0x17d534[_0xfd0897(0xf54)][_0xfd0897(0x511)](),_0x17d534[_0xfd0897(0x996)][_0xfd0897(0x511)]()]);Object[_0xfd0897(0xece)](_0x3d8879,{'chats':_0x518487,'worldBooks':_0x316647,'userStickers':_0x41aced,'apiConfig':_0x21962f,'globalSettings':_0x47345c,'personaPresets':_0x5eda7c,'musicLibrary':_0x54d2c2,'qzoneSettings':_0x350292,'qzonePosts':_0xdeac0d,'qzoneAlbums':_0x3da7d2,'qzonePhotos':_0x5a667a,'favorites':_0x35ac8a,'qzoneGroups':_0x247e1f,'memories':_0x42976a,'worldBookCategories':_0x3a4a12,'apiPresets':_0x558b8a,'shoppingProducts':_0x426509,'callRecords':_0x79c73d,'renderingRules':_0x260f36,'doubanPosts':_0x31c48f,'stickerCategories':_0x1c8f8e,'appearancePresets':_0x14a218,'presets':_0x503086,'presetCategories':_0x373154,'npcs':_0x5dafcd});const _0x5b84d7=new Blob([JSON['stringify'](_0x3d8879,null,0x2)],{'type':'application/json'}),_0x119da4=URL[_0xfd0897(0x795)](_0x5b84d7),_0x5ec977=Object[_0xfd0897(0xece)](document[_0xfd0897(0xe7d)]('a'),{'href':_0x119da4,'download':_0xfd0897(0xc36)+new Date()['toISOString']()['split']('T')[0x0]+_0xfd0897(0xb42)});_0x5ec977['click'](),URL[_0xfd0897(0x30c)](_0x119da4),await _0x34fce8('导出成功','已成功导出所有数据！');}catch(_0x436b62){console[_0xfd0897(0xb61)](_0xfd0897(0x44d),_0x436b62),await _0x34fce8('导出失败',_0xfd0897(0x389)+_0x436b62[_0xfd0897(0x7aa)]);}}async function _0x39eacd(_0x176053){const _0x1865ba=_0x204348;try{await _0x17d534[_0x1865ba(0x9a7)]('rw',_0x17d534[_0x1865ba(0x275)],async()=>{const _0xffa321=_0x1865ba;for(const _0x4b82f4 of _0x17d534['tables']){await _0x4b82f4[_0xffa321(0x415)]();}for(const _0x3f7709 in _0x176053){Array[_0xffa321(0x971)](_0x176053[_0x3f7709])&&(console[_0xffa321(0x7d1)](_0xffa321(0xf10)+_0x3f7709+_0xffa321(0xb31)+_0x176053[_0x3f7709][_0xffa321(0x131d)]),await _0x17d534[_0xffa321(0xca3)](_0x3f7709)[_0xffa321(0x5b9)](_0x176053[_0x3f7709]));}});}catch(_0x138d39){throw new Error(_0x1865ba(0x119c)+_0x138d39[_0x1865ba(0x7aa)]);}}async function _0x55c86e(_0x213053){const _0x954238=_0x204348;if(!_0x213053)return;await _0x34fce8('请稍候...','正在读取并解析备份文件...');try{const _0x2a96e3=await _0x213053[_0x954238(0xdd5)](),_0x180d16=JSON['parse'](_0x2a96e3);let _0x291f05,_0x950a05;if(_0x180d16[_0x954238(0x76b)]&&typeof _0x180d16[_0x954238(0x76b)]===_0x954238(0x620)&&(_0x180d16[_0x954238(0x76b)]['chats']||_0x180d16[_0x954238(0x76b)][_0x954238(0xab7)]))console[_0x954238(0x7d1)](_0x954238(0x1410)),_0x291f05=_0x180d16[_0x954238(0x76b)],_0x950a05=_0x954238(0x972);else{if(_0x180d16[_0x954238(0x954)]||_0x180d16[_0x954238(0xab7)])console[_0x954238(0x7d1)]('检测到旧版完整备份文件...'),_0x291f05=_0x180d16,_0x950a05=_0x954238(0x11b0);else throw new Error(_0x954238(0x7d7));}pendingBackupData={'type':_0x950a05,'content':_0x291f05},_0x208f76(_0x291f05);}catch(_0x48e87e){console[_0x954238(0xb61)](_0x954238(0x27d),_0x48e87e),pendingBackupData=null,await _0x34fce8(_0x954238(0xfc4),_0x954238(0x20e)+_0x48e87e['message']);}}function _0x208f76(_0x1388d8){const _0x35cc19=_0x204348,_0x3a9d25=document[_0x35cc19(0x458)](_0x35cc19(0xdc2)),_0x30db6e=document[_0x35cc19(0x458)]('import-preview-list');_0x30db6e[_0x35cc19(0x110d)]='';const _0x567cbd={'chats':_0x35cc19(0x1185),'worldBooks':_0x35cc19(0x5eb),'worldBookCategories':_0x35cc19(0xd97),'presets':_0x35cc19(0x13cf),'presetCategories':_0x35cc19(0x21a),'userStickers':_0x35cc19(0x24d),'stickerCategories':_0x35cc19(0xfc8),'customAvatarFrames':_0x35cc19(0x697),'apiConfig':_0x35cc19(0x929),'globalSettings':'全局设置','personaPresets':_0x35cc19(0xa71),'qzoneSettings':_0x35cc19(0xcbe),'qzonePosts':'动态','qzoneAlbums':'相册','favorites':'收藏','memories':'回忆','callRecords':_0x35cc19(0x9f8),'shoppingProducts':'商品','apiPresets':_0x35cc19(0x95f),'renderingRules':'渲染规则','appearancePresets':_0x35cc19(0x3db),'npcs':'NPCs'};let _0x8d325c=![];for(const _0x201728 in _0x567cbd){if(_0x1388d8[_0x201728]&&(Array[_0x35cc19(0x971)](_0x1388d8[_0x201728])?_0x1388d8[_0x201728]['length']>0x0:_0x1388d8[_0x201728])){const _0x1a5b83=Array['isArray'](_0x1388d8[_0x201728])?_0x1388d8[_0x201728][_0x35cc19(0x131d)]:0x1,_0x1e89ab=document[_0x35cc19(0xe7d)]('li');_0x1e89ab['textContent']=_0x567cbd[_0x201728]+':\x20'+_0x1a5b83+_0x35cc19(0xb13),_0x30db6e[_0x35cc19(0x1079)](_0x1e89ab),_0x8d325c=!![];}}!_0x8d325c&&(_0x30db6e[_0x35cc19(0x110d)]=_0x35cc19(0x4a0)),document[_0x35cc19(0x458)](_0x35cc19(0x1283))['onclick']=()=>{const _0x4ddf32=_0x35cc19;_0x3a9d25[_0x4ddf32(0x11c2)][_0x4ddf32(0x1097)](_0x4ddf32(0x67d)),_0x405c4c(pendingBackupData);},document[_0x35cc19(0x458)]('confirm-selective-import-btn')[_0x35cc19(0xbe8)]=()=>{const _0x3461f3=_0x35cc19;_0x3a9d25[_0x3461f3(0x11c2)][_0x3461f3(0x1097)](_0x3461f3(0x67d)),_0x2e0b50(pendingBackupData['content']);},document[_0x35cc19(0x458)]('cancel-import-options-btn')['onclick']=()=>{const _0x2f9aea=_0x35cc19;_0x3a9d25[_0x2f9aea(0x11c2)][_0x2f9aea(0x1097)](_0x2f9aea(0x67d)),pendingBackupData=null;},_0x3a9d25['classList']['add']('visible');}async function _0x405c4c(_0x475528){const _0x1f4cfe=_0x204348;if(!_0x475528)return;const _0xb7039e=await _0x2532b9(_0x1f4cfe(0x60b),'【完全导入】将删除您当前的所有数据并替换为备份文件中的内容。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>',{'confirmButtonClass':'btn-danger','confirmText':'我明白，覆盖所有数据'});if(!_0xb7039e){pendingBackupData=null;return;}await _0x34fce8(_0x1f4cfe(0x12b9),_0x1f4cfe(0xc83));try{if(_0x475528['type']===_0x1f4cfe(0x972))await _0x39eacd(_0x475528[_0x1f4cfe(0x1316)]);else{if(_0x475528[_0x1f4cfe(0x259)]===_0x1f4cfe(0x11b0))await _0x345dc2(_0x475528[_0x1f4cfe(0x1316)]);else throw new Error(_0x1f4cfe(0x131b));}await _0x34fce8(_0x1f4cfe(0xf98),_0x1f4cfe(0x1426)),setTimeout(()=>window[_0x1f4cfe(0x299)]['reload'](),0x5dc);}catch(_0x2a4063){console[_0x1f4cfe(0xb61)]('完全导入失败:',_0x2a4063),await _0x34fce8('导入失败','文件应用失败:\x20'+_0x2a4063[_0x1f4cfe(0x7aa)]);}finally{pendingBackupData=null;}}function _0x2e0b50(_0x97bbf){const _0x3c992d=_0x204348,_0x3f8d87=document['getElementById']('selective-import-modal'),_0x342c49=document[_0x3c992d(0x458)]('selective-import-list'),_0x4b9c4a=document[_0x3c992d(0x458)](_0x3c992d(0x7cf));_0x342c49['innerHTML']='',_0x4b9c4a[_0x3c992d(0x8f7)]=!![];const _0x28318f={'chats':_0x3c992d(0x1185),'worldBooks':_0x3c992d(0x5eb),'worldBookCategories':'世界书分类','presets':_0x3c992d(0x13cf),'presetCategories':'预设分类','userStickers':_0x3c992d(0x24d),'stickerCategories':_0x3c992d(0xfc8),'customAvatarFrames':_0x3c992d(0x697),'apiConfig':_0x3c992d(0x929),'globalSettings':'全局设置','personaPresets':_0x3c992d(0xa71),'qzoneSettings':_0x3c992d(0xcbe),'qzonePosts':'动态','qzoneAlbums':'相册','favorites':'收藏','memories':'回忆','callRecords':_0x3c992d(0x9f8),'shoppingProducts':'商品','apiPresets':_0x3c992d(0x95f),'renderingRules':_0x3c992d(0x746),'appearancePresets':_0x3c992d(0x3db),'npcs':'NPCs'};let _0x5ae4ff=![];for(const _0x32fffb in _0x28318f){if(_0x97bbf[_0x32fffb]&&(Array['isArray'](_0x97bbf[_0x32fffb])?_0x97bbf[_0x32fffb]['length']>0x0:_0x97bbf[_0x32fffb])){const _0x1d14f7=Array[_0x3c992d(0x971)](_0x97bbf[_0x32fffb])?_0x97bbf[_0x32fffb][_0x3c992d(0x131d)]:0x1,_0x53c9f9=!Array[_0x3c992d(0x971)](_0x97bbf[_0x32fffb]),_0x2bbf0e=document[_0x3c992d(0xe7d)](_0x3c992d(0x1323));_0x2bbf0e[_0x3c992d(0x69b)]=_0x3c992d(0x12e),_0x2bbf0e[_0x3c992d(0x1f4)][_0x3c992d(0xc43)]=_0x32fffb,_0x2bbf0e[_0x3c992d(0x110d)]=_0x3c992d(0x3c3)+_0x28318f[_0x32fffb]+'\x20('+_0x1d14f7+'\x20条/个)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x53c9f9?'<p\x20style=\x22font-size:\x2012px;\x20color:\x20#ff8c00;\x20margin:\x204px\x200\x200;\x22>(注意:\x20这将【覆盖】您当前的设置)</p>':'')+_0x3c992d(0x144a),_0x342c49[_0x3c992d(0x1079)](_0x2bbf0e),_0x5ae4ff=!![];}}!_0x5ae4ff&&(_0x342c49[_0x3c992d(0x110d)]=_0x3c992d(0x3fb)),document['getElementById'](_0x3c992d(0x10f1))[_0x3c992d(0xbe8)]=()=>_0x4d1858(pendingBackupData),document[_0x3c992d(0x458)]('cancel-selective-import-btn')[_0x3c992d(0xbe8)]=()=>{const _0x13a7a5=_0x3c992d;_0x3f8d87[_0x13a7a5(0x11c2)][_0x13a7a5(0x1097)](_0x13a7a5(0x67d)),pendingBackupData=null;},_0x4b9c4a['onchange']=_0x813780=>{const _0x4c0924=_0x3c992d,_0x56d594=_0x813780[_0x4c0924(0x12df)][_0x4c0924(0x8f7)];_0x342c49[_0x4c0924(0x102a)]('.clear-posts-item')['forEach'](_0x30ce68=>{const _0x4341f6=_0x4c0924;_0x30ce68[_0x4341f6(0x11c2)][_0x4341f6(0x1270)](_0x4341f6(0x500),_0x56d594),_0x30ce68['querySelector']('.checkbox')[_0x4341f6(0x11c2)][_0x4341f6(0x1270)]('selected',_0x56d594);});},_0x342c49[_0x3c992d(0xbe8)]=_0x424778=>{const _0x113ae8=_0x3c992d,_0x3ed640=_0x424778['target']['closest'](_0x113ae8(0xcd1));_0x3ed640&&(_0x3ed640[_0x113ae8(0x11c2)]['toggle'](_0x113ae8(0x500)),_0x3ed640[_0x113ae8(0x586)](_0x113ae8(0x85f))['classList']['toggle'](_0x113ae8(0x500)));},_0x3f8d87[_0x3c992d(0x11c2)][_0x3c992d(0xa58)](_0x3c992d(0x67d));}async function _0x4d1858(_0xb97695){const _0x1f4606=_0x204348;if(!_0xb97695)return;const _0x27ee6c=document[_0x1f4606(0x102a)](_0x1f4606(0x8cd));if(_0x27ee6c[_0x1f4606(0x131d)]===0x0){alert(_0x1f4606(0x81e));return;}const _0x1496e8=Array['from'](_0x27ee6c)[_0x1f4606(0xbf6)](_0x42832e=>_0x42832e['dataset'][_0x1f4606(0xc43)]),_0x27982f=_0xb97695[_0x1f4606(0x1316)],_0x1cd83d=await _0x2532b9(_0x1f4606(0xd9),_0x1f4606(0xeef),{'confirmText':_0x1f4606(0x56e)});if(!_0x1cd83d)return;await _0x34fce8(_0x1f4606(0x12b9),_0x1f4606(0x1289));try{await _0x17d534[_0x1f4606(0x9a7)]('rw',_0x17d534['tables'],async()=>{const _0x2007a1=_0x1f4606;for(const _0x2c7d53 of _0x1496e8){const _0x1df443=_0x27982f[_0x2c7d53];if(!_0x1df443)continue;const _0x52039b=_0x17d534[_0x2007a1(0xca3)](_0x2c7d53);if(!_0x52039b){console[_0x2007a1(0x1b6)]('找不到表:\x20'+_0x2c7d53+',\x20跳过...');continue;}if(Array[_0x2007a1(0x971)](_0x1df443))console['log'](_0x2007a1(0xf20)+_0x1df443[_0x2007a1(0x131d)]+_0x2007a1(0x4e2)+_0x2c7d53+_0x2007a1(0x10a0)),await _0x52039b[_0x2007a1(0x5b9)](_0x1df443);else{if(typeof _0x1df443===_0x2007a1(0x620)&&_0x1df443['id'])console['log'](_0x2007a1(0xa62)+_0x2c7d53+_0x2007a1(0x10a0)),await _0x52039b[_0x2007a1(0xf3f)](_0x1df443);else{if(typeof _0x1df443==='object'){console[_0x2007a1(0x7d1)]('正在合并非标对象到\x20'+_0x2c7d53+'...');const _0x1a16c4=await _0x52039b[_0x2007a1(0x8dc)]()['first']()||{},_0x41f4e0={..._0x1a16c4,..._0x1df443};if(_0x1a16c4['id'])_0x41f4e0['id']=_0x1a16c4['id'];else(_0x2c7d53===_0x2007a1(0x5cb)||_0x2c7d53===_0x2007a1(0x551)||_0x2c7d53===_0x2007a1(0xf0)||_0x2c7d53===_0x2007a1(0xd3))&&(_0x41f4e0['id']=_0x2007a1(0x1442));await _0x52039b['put'](_0x41f4e0);}}}}}),await _0x34fce8(_0x1f4606(0xf2b),_0x1f4606(0xe28)),setTimeout(()=>window[_0x1f4606(0x299)][_0x1f4606(0x88a)](),0x5dc);}catch(_0x392192){console['error']('选择性导入失败:',_0x392192),await _0x34fce8(_0x1f4606(0xfba),_0x1f4606(0x11cd)+_0x392192['message']);}finally{pendingBackupData=null;}}async function _0x345dc2(_0xa4c8ae){const _0x35382e=_0x204348;try{await _0x17d534[_0x35382e(0x9a7)]('rw',_0x17d534[_0x35382e(0x275)],async()=>{const _0x110f72=_0x35382e;await _0x17d534[_0x110f72(0x954)][_0x110f72(0x415)](),await _0x17d534[_0x110f72(0xab7)][_0x110f72(0x415)]();for(const _0x57eccb of _0x17d534['tables']){await _0x57eccb['clear']();}if(Array[_0x110f72(0x971)](_0xa4c8ae[_0x110f72(0x954)]))await _0x17d534[_0x110f72(0x954)]['bulkPut'](_0xa4c8ae[_0x110f72(0x954)]);if(Array[_0x110f72(0x971)](_0xa4c8ae['worldBooks']))await _0x17d534[_0x110f72(0xab7)]['bulkPut'](_0xa4c8ae[_0x110f72(0xab7)]);if(Array[_0x110f72(0x971)](_0xa4c8ae[_0x110f72(0x1294)]))await _0x17d534[_0x110f72(0x1294)][_0x110f72(0x5b9)](_0xa4c8ae[_0x110f72(0x1294)]);if(_0xa4c8ae[_0x110f72(0x5cb)])await _0x17d534[_0x110f72(0x5cb)][_0x110f72(0xf3f)](_0xa4c8ae[_0x110f72(0x5cb)]);if(_0xa4c8ae[_0x110f72(0xf0)])await _0x17d534[_0x110f72(0xf0)][_0x110f72(0xf3f)](_0xa4c8ae[_0x110f72(0xf0)]);if(Array[_0x110f72(0x971)](_0xa4c8ae[_0x110f72(0xa84)]))await _0x17d534['personaPresets'][_0x110f72(0x5b9)](_0xa4c8ae[_0x110f72(0xa84)]);if(_0xa4c8ae[_0x110f72(0xd3)])await _0x17d534[_0x110f72(0xd3)][_0x110f72(0xf3f)](_0xa4c8ae[_0x110f72(0xd3)]);if(_0xa4c8ae[_0x110f72(0x551)])await _0x17d534[_0x110f72(0x551)][_0x110f72(0xf3f)](_0xa4c8ae[_0x110f72(0x551)]);if(Array[_0x110f72(0x971)](_0xa4c8ae[_0x110f72(0x15b)]))await _0x17d534['qzonePosts'][_0x110f72(0x5b9)](_0xa4c8ae[_0x110f72(0x15b)]);if(Array[_0x110f72(0x971)](_0xa4c8ae[_0x110f72(0x1001)]))await _0x17d534['qzoneAlbums']['bulkPut'](_0xa4c8ae[_0x110f72(0x1001)]);if(Array['isArray'](_0xa4c8ae[_0x110f72(0xe15)]))await _0x17d534[_0x110f72(0xe15)][_0x110f72(0x5b9)](_0xa4c8ae[_0x110f72(0xe15)]);if(Array['isArray'](_0xa4c8ae['favorites']))await _0x17d534[_0x110f72(0xb78)][_0x110f72(0x5b9)](_0xa4c8ae['favorites']);if(Array[_0x110f72(0x971)](_0xa4c8ae[_0x110f72(0x10a5)]))await _0x17d534[_0x110f72(0x10a5)][_0x110f72(0x5b9)](_0xa4c8ae[_0x110f72(0x10a5)]);if(Array[_0x110f72(0x971)](_0xa4c8ae[_0x110f72(0x414)]))await _0x17d534[_0x110f72(0x414)][_0x110f72(0x5b9)](_0xa4c8ae['memories']);if(Array['isArray'](_0xa4c8ae[_0x110f72(0x110b)]))await _0x17d534[_0x110f72(0x110b)][_0x110f72(0x5b9)](_0xa4c8ae['worldBookCategories']);if(Array['isArray'](_0xa4c8ae[_0x110f72(0x8b5)]))await _0x17d534[_0x110f72(0x8b5)]['bulkPut'](_0xa4c8ae[_0x110f72(0x8b5)]);if(Array[_0x110f72(0x971)](_0xa4c8ae[_0x110f72(0x122c)]))await _0x17d534['shoppingProducts'][_0x110f72(0x5b9)](_0xa4c8ae['shoppingProducts']);if(Array[_0x110f72(0x971)](_0xa4c8ae[_0x110f72(0x920)]))await _0x17d534[_0x110f72(0x920)][_0x110f72(0x5b9)](_0xa4c8ae[_0x110f72(0x920)]);if(Array['isArray'](_0xa4c8ae[_0x110f72(0x65a)]))await _0x17d534[_0x110f72(0x65a)]['bulkPut'](_0xa4c8ae[_0x110f72(0x65a)]);if(Array[_0x110f72(0x971)](_0xa4c8ae['doubanPosts']))await _0x17d534[_0x110f72(0xaf9)][_0x110f72(0x5b9)](_0xa4c8ae[_0x110f72(0xaf9)]);if(Array[_0x110f72(0x971)](_0xa4c8ae[_0x110f72(0x140b)]))await _0x17d534[_0x110f72(0x140b)]['bulkPut'](_0xa4c8ae[_0x110f72(0x140b)]);if(Array[_0x110f72(0x971)](_0xa4c8ae['appearancePresets']))await _0x17d534[_0x110f72(0x64f)]['bulkPut'](_0xa4c8ae[_0x110f72(0x64f)]);if(Array['isArray'](_0xa4c8ae[_0x110f72(0x843)]))await _0x17d534[_0x110f72(0x843)][_0x110f72(0x5b9)](_0xa4c8ae[_0x110f72(0x843)]);if(Array[_0x110f72(0x971)](_0xa4c8ae['presetCategories']))await _0x17d534['presetCategories'][_0x110f72(0x5b9)](_0xa4c8ae[_0x110f72(0xf54)]);if(Array['isArray'](_0xa4c8ae[_0x110f72(0x996)]))await _0x17d534['npcs'][_0x110f72(0x5b9)](_0xa4c8ae['npcs']);});}catch(_0x1fa901){throw new Error(_0x35382e(0x6b7)+_0x1fa901[_0x35382e(0x7aa)]);}}function _0x393d41(_0x16516c,_0x1d7ad5=![]){const _0x5b4859=_0x204348;if(!_0x16516c){_0x5966ce[_0x5b4859(0x110d)]='',document['getElementById'](_0x5b4859(0x659))[_0x5b4859(0x1104)]['fontFamily']='';return;}const _0x57b711='custom-user-font',_0x228a96=_0x5b4859(0x1427)+_0x57b711+'\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27'+_0x16516c+_0x5b4859(0xcd);if(_0x1d7ad5){const _0x3f07b9=document[_0x5b4859(0x458)](_0x5b4859(0x101c))||document[_0x5b4859(0xe7d)](_0x5b4859(0x1104));_0x3f07b9['id']=_0x5b4859(0x101c),_0x3f07b9[_0x5b4859(0x110d)]=_0x228a96;if(!document[_0x5b4859(0x458)]('preview-font-style'))document['head'][_0x5b4859(0x1079)](_0x3f07b9);document['getElementById'](_0x5b4859(0x659))[_0x5b4859(0x1104)][_0x5b4859(0x39f)]='\x27'+_0x57b711+'\x27,\x20\x27bulangni\x27,\x20sans-serif';}else _0x5966ce[_0x5b4859(0x110d)]=_0x5b4859(0x182)+_0x228a96+_0x5b4859(0x2c7)+_0x57b711+_0x5b4859(0x24a);}async function _0x40cf5c(){const _0x2ae88e=_0x204348;_0x5966ce[_0x2ae88e(0x110d)]='',_0x42f206[_0x2ae88e(0xf0)][_0x2ae88e(0xafb)]='',await _0x17d534[_0x2ae88e(0xf0)][_0x2ae88e(0xf3f)](_0x42f206[_0x2ae88e(0xf0)]),document[_0x2ae88e(0x458)](_0x2ae88e(0x8a7))[_0x2ae88e(0x8dd)]='',document['getElementById']('font-preview')['style'][_0x2ae88e(0x39f)]='',alert(_0x2ae88e(0xc10));}async function _0x198396(){const _0x4dce73=_0x204348,[_0x375a4e,_0x989d97,_0x3c8faf,_0x598cde,_0x4f3606,_0x41c452,_0x43be19,_0x3ad15b,_0x822fca,_0x14ac8d,_0x22725]=await Promise['all']([_0x17d534[_0x4dce73(0x954)][_0x4dce73(0x511)](),_0x17d534[_0x4dce73(0x5cb)][_0x4dce73(0x36d)](_0x4dce73(0x1442)),_0x17d534[_0x4dce73(0xf0)][_0x4dce73(0x36d)](_0x4dce73(0x1442)),_0x17d534['userStickers'][_0x4dce73(0x511)](),_0x17d534['worldBooks'][_0x4dce73(0x511)](),_0x17d534['musicLibrary'][_0x4dce73(0x36d)](_0x4dce73(0x1442)),_0x17d534[_0x4dce73(0xa84)][_0x4dce73(0x511)](),_0x17d534[_0x4dce73(0x551)][_0x4dce73(0x36d)](_0x4dce73(0x1442)),_0x17d534[_0x4dce73(0xb78)][_0x4dce73(0x50b)](_0x4dce73(0xf16))[_0x4dce73(0x115b)]()[_0x4dce73(0x511)](),_0x17d534['memories']['toArray'](),_0x17d534[_0x4dce73(0x843)][_0x4dce73(0x511)]()]);_0x42f206['presets']=_0x22725||[];const _0x2fa6c9={'id':'main','showStatusBar':![],'wallpaper':'linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0x886ae3},'cphoneWallpaper':'linear-gradient(135deg,\x20#f6d365,\x20#fda085)','cphoneAppIcons':{..._0x3d34eb},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x42f206['globalSettings']={..._0x2fa6c9,..._0x3c8faf||{}},_0x42f206[_0x4dce73(0xf0)]['appIcons']={..._0x2fa6c9[_0x4dce73(0x6a3)],..._0x42f206[_0x4dce73(0xf0)]['appIcons']||{}},_0x42f206[_0x4dce73(0xf0)][_0x4dce73(0x6e8)]={..._0x2fa6c9[_0x4dce73(0x6e8)],..._0x42f206[_0x4dce73(0xf0)]['cphoneAppIcons']||{}},_0x375a4e[_0x4dce73(0x12c2)](_0x2f4f47=>{const _0x567a92=_0x4dce73;typeof _0x2f4f47[_0x567a92(0xda2)][_0x567a92(0x219)]===_0x567a92(0x37c)&&(_0x2f4f47[_0x567a92(0xda2)][_0x567a92(0x219)]=!![]),!_0x2f4f47[_0x567a92(0xda2)][_0x567a92(0xf74)]&&(_0x2f4f47[_0x567a92(0xda2)][_0x567a92(0xf74)]={'vertical':_0x567a92(0x76f),'horizontal':_0x567a92(0x1f3),'offset':0xa}),!_0x2f4f47[_0x567a92(0x726)]&&!_0x2f4f47[_0x567a92(0xda2)][_0x567a92(0x22c)]&&(_0x2f4f47['settings'][_0x567a92(0x22c)]=[]),!_0x2f4f47[_0x567a92(0x726)]&&typeof _0x2f4f47[_0x567a92(0xa1)]===_0x567a92(0x37c)&&(_0x2f4f47[_0x567a92(0xa1)]=_0x2f4f47['name']);}),_0x42f206[_0x4dce73(0x954)]=_0x375a4e[_0x4dce73(0x1450)]((_0x30c2ee,_0x3d837f)=>{const _0x3804a3=_0x4dce73;if(typeof _0x3d837f['unreadCount']===_0x3804a3(0x37c))_0x3d837f[_0x3804a3(0x12c9)]=0x0;_0x3d837f['isGroup']&&(typeof _0x3d837f['settings'][_0x3804a3(0x12cd)]===_0x3804a3(0x37c)&&(_0x3d837f['settings']['enableBackgroundActivity']=!![]),_0x3d837f[_0x3804a3(0xfa8)]&&_0x3d837f[_0x3804a3(0xfa8)][_0x3804a3(0x131d)]>0x0&&_0x3d837f[_0x3804a3(0xfa8)][0x0][_0x3804a3(0x132a)]&&_0x3d837f[_0x3804a3(0xfa8)][_0x3804a3(0x12c2)](_0x13183c=>{const _0x453b02=_0x3804a3;typeof _0x13183c['originalName']===_0x453b02(0x37c)&&(_0x13183c[_0x453b02(0xa1)]=_0x13183c[_0x453b02(0x132a)],_0x13183c['groupNickname']=_0x13183c[_0x453b02(0x132a)],delete _0x13183c['name']);}));if(!_0x3d837f[_0x3804a3(0xda2)])_0x3d837f[_0x3804a3(0xda2)]={};typeof _0x3d837f['settings']['actionCooldownMinutes']===_0x3804a3(0x37c)&&(_0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0x9c9)]=0xa);if(!_0x3d837f[_0x3804a3(0x726)]&&!_0x3d837f[_0x3804a3(0x13b2)])_0x3d837f['status']={'text':'在线','lastUpdate':Date['now'](),'isBusy':![]};if(!_0x3d837f[_0x3804a3(0x726)]&&!_0x3d837f[_0x3804a3(0x569)])_0x3d837f[_0x3804a3(0x569)]={'status':_0x3804a3(0xe97),'blockedTimestamp':null,'applicationReason':''};if(!_0x3d837f[_0x3804a3(0x726)]&&(!_0x3d837f['settings']||!_0x3d837f['settings'][_0x3804a3(0x5d3)])){if(!_0x3d837f[_0x3804a3(0xda2)])_0x3d837f['settings']={};_0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0x5d3)]=[];}_0x3d837f['isGroup']&&(_0x3d837f[_0x3804a3(0xfa8)]||[])['forEach'](_0x1e7e06=>{const _0x16b13d=_0x3804a3;if(typeof _0x1e7e06[_0x16b13d(0x2c5)]===_0x16b13d(0x37c))_0x1e7e06['avatarFrame']='';});if(!_0x3d837f['musicData'])_0x3d837f[_0x3804a3(0xc3a)]={'totalTime':0x0};_0x3d837f['settings']&&_0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0xfce)]&&!_0x3d837f[_0x3804a3(0xda2)]['linkedWorldBookIds']&&(_0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0x315)]=[_0x3d837f[_0x3804a3(0xda2)]['linkedWorldBookId']],delete _0x3d837f[_0x3804a3(0xda2)]['linkedWorldBookId']);if(typeof _0x3d837f[_0x3804a3(0x858)]===_0x3804a3(0x37c))_0x3d837f[_0x3804a3(0x858)]=![];!_0x3d837f[_0x3804a3(0x726)]&&typeof _0x3d837f[_0x3804a3(0xda2)]['myNickname']===_0x3804a3(0x37c)&&(_0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0xc7d)]='我');if(_0x3d837f[_0x3804a3(0x726)]&&_0x3d837f[_0x3804a3(0xfa8)]){let _0x270139=![];_0x375a4e[_0x3804a3(0x12c2)](_0x4ec803=>{const _0x59fe44=_0x3804a3;_0x4ec803['id']===_0x3d837f['id']&&_0x4ec803[_0x59fe44(0xa1)]&&delete _0x4ec803[_0x59fe44(0xa1)];}),_0x3d837f[_0x3804a3(0xfa8)][_0x3804a3(0x12c2)](_0x43ac5d=>{const _0x5973d5=_0x3804a3,_0x8bf064=_0x375a4e[_0x5973d5(0xb07)](_0x2afcaf=>_0x2afcaf['id']===_0x43ac5d['id']);if(_0x8bf064&&_0x8bf064[_0x5973d5(0xda2)]){const _0x39c895=_0x8bf064[_0x5973d5(0xda2)][_0x5973d5(0xce6)]||'';_0x43ac5d[_0x5973d5(0x2c5)]!==_0x39c895&&(_0x43ac5d[_0x5973d5(0x2c5)]=_0x39c895,_0x270139=!![]);}else typeof _0x43ac5d[_0x5973d5(0x2c5)]==='undefined'&&(_0x43ac5d[_0x5973d5(0x2c5)]='',_0x270139=!![]);});if(_0x270139)_0x17d534[_0x3804a3(0x954)][_0x3804a3(0xf3f)](_0x3d837f);}if(!_0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0x8fd)])_0x3d837f[_0x3804a3(0xda2)]['enableAutoMemory']=![];if(!_0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0x359)])_0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0x359)]=0x14;if(!_0x3d837f[_0x3804a3(0x94a)])_0x3d837f['longTermMemory']=[];if(!_0x3d837f['lastMemorySummaryTimestamp'])_0x3d837f[_0x3804a3(0xa7e)]=0x0;if(!_0x3d837f[_0x3804a3(0x726)]){typeof _0x3d837f['settings'][_0x3804a3(0x12cd)]===_0x3804a3(0x37c)&&(_0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0x12cd)]=!![]);typeof _0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0x211)]==='undefined'&&(_0x3d837f['settings']['enableTts']=![]);if(!_0x3d837f['status'])_0x3d837f['status']={'text':'在线','lastUpdate':Date[_0x3804a3(0x606)](),'isBusy':![]};if(!_0x3d837f['relationship'])_0x3d837f[_0x3804a3(0x569)]={'status':_0x3804a3(0xe97),'blockedTimestamp':null,'applicationReason':''};if(!_0x3d837f[_0x3804a3(0xda2)]||!_0x3d837f['settings'][_0x3804a3(0x5d3)]){if(!_0x3d837f[_0x3804a3(0xda2)])_0x3d837f[_0x3804a3(0xda2)]={};_0x3d837f['settings'][_0x3804a3(0x5d3)]=[];}if(typeof _0x3d837f['settings']['isOfflineMode']===_0x3804a3(0x37c))_0x3d837f['settings'][_0x3804a3(0x11a7)]=![];if(typeof _0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0xb04)]===_0x3804a3(0x37c))_0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0xb04)]=0x64;if(typeof _0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0x280)]===_0x3804a3(0x37c))_0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0x280)]=0x12c;typeof _0x3d837f[_0x3804a3(0xda2)]['injectLatestThought']===_0x3804a3(0x37c)&&(_0x3d837f['settings'][_0x3804a3(0x6a)]=![]);if(typeof _0x3d837f[_0x3804a3(0xb0f)]===_0x3804a3(0x37c))_0x3d837f[_0x3804a3(0xb0f)]=_0x3804a3(0x10a0);if(typeof _0x3d837f[_0x3804a3(0x8eb)]===_0x3804a3(0x37c))_0x3d837f['randomJottings']=_0x3804a3(0x10a0);!Array[_0x3804a3(0x971)](_0x3d837f[_0x3804a3(0x6b8)])&&(_0x3d837f[_0x3804a3(0x6b8)]=[]);}return typeof _0x3d837f['settings'][_0x3804a3(0x10d6)]===_0x3804a3(0x37c)&&(_0x3d837f[_0x3804a3(0xda2)]['stickerCategoryId']?_0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0x10d6)]=[_0x3d837f[_0x3804a3(0xda2)][_0x3804a3(0x168)]]:_0x3d837f[_0x3804a3(0xda2)]['stickerCategoryIds']=[],delete _0x3d837f['settings'][_0x3804a3(0x168)]),_0x30c2ee[_0x3d837f['id']]=_0x3d837f,_0x30c2ee;},{});const _0x1fc94d=[];_0x14ac8d[_0x4dce73(0x12c2)](_0x483129=>{const _0x119507=_0x4dce73;if(_0x483129[_0x119507(0x259)]==='ai_generated'&&_0x483129[_0x119507(0x1176)]&&!_0x483129[_0x119507(0x1086)]){const _0x146d80=_0x375a4e[_0x119507(0xb07)](_0xfaab77=>!_0xfaab77['isGroup']&&_0xfaab77[_0x119507(0xa1)]===_0x483129[_0x119507(0x1176)]);if(_0x146d80)_0x483129[_0x119507(0x1086)]=_0x146d80['id'],_0x1fc94d['push'](_0x483129);else{const _0x475ac1=_0x375a4e[_0x119507(0xb07)](_0x4e062a=>!_0x4e062a[_0x119507(0x726)]&&_0x4e062a['name']===_0x483129[_0x119507(0x1176)]);_0x475ac1&&(_0x483129[_0x119507(0x1086)]=_0x475ac1['id'],_0x1fc94d[_0x119507(0x129e)](_0x483129));}}}),_0x1fc94d[_0x4dce73(0x131d)]>0x0&&await _0x17d534['memories'][_0x4dce73(0x5b9)](_0x1fc94d),_0x42f206['apiConfig']=_0x989d97||{'id':'main','proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':_0x4dce73(0x201)},_0x42f206[_0x4dce73(0x1294)]=_0x598cde||[],_0x42f206[_0x4dce73(0xab7)]=_0x4f3606||[],_0x59377b[_0x4dce73(0x1102)]=_0x41c452?.[_0x4dce73(0x1102)]||[],_0x42f206['personaPresets']=_0x43be19||[],_0x42f206[_0x4dce73(0x551)]=_0x3ad15b||{'id':'main','nickname':_0x4dce73(0x852),'avatar':_0x4dce73(0xa74),'banner':_0x4dce73(0x864)},allFavoriteItems=_0x822fca||[];}async function _0x562193(){const _0x29d210=_0x204348;await _0x17d534[_0x29d210(0xd3)][_0x29d210(0xf3f)]({'id':_0x29d210(0x1442),'playlist':_0x59377b[_0x29d210(0x1102)]});}function _0x3c9d90(_0x35c865){const _0x53075b=_0x204348;if(!_0x35c865)return'';const _0x2bd0fe=new Date(_0x35c865),_0x234c2a=String(_0x2bd0fe[_0x53075b(0x748)]())[_0x53075b(0x508)](0x2,'0'),_0x5cc7fe=String(_0x2bd0fe[_0x53075b(0x121a)]())['padStart'](0x2,'0');return _0x234c2a+':'+_0x5cc7fe;}function _0x1f0c92(_0x1af7a9){const _0x38137a=_0x204348,_0x4ac5aa=Date[_0x38137a(0x606)](),_0x357837=Math[_0x38137a(0xbd5)]((_0x4ac5aa-_0x1af7a9)/0x3e8);if(_0x357837<0x3c)return'刚刚';const _0x5abaef=Math['floor'](_0x357837/0x3c);if(_0x5abaef<0x3c)return _0x5abaef+_0x38137a(0x137a);const _0x549490=Math[_0x38137a(0xbd5)](_0x5abaef/0x3c);if(_0x549490<0x18)return _0x549490+_0x38137a(0x1354);const _0xb42197=Math[_0x38137a(0xbd5)](_0x549490/0x18);if(_0xb42197<0x1e)return _0xb42197+'天前';const _0x309c53=Math[_0x38137a(0xbd5)](_0xb42197/0x1e);if(_0x309c53<0xc)return'大约'+_0x309c53+_0x38137a(0xd1a);const _0x4444fa=Math[_0x38137a(0xbd5)](_0xb42197/0x16d);return'大约'+_0x4444fa+'年前';}function _0x421a56(_0x163a7a){const _0x37cdf0=_0x204348;if(!_0x163a7a)return'';const _0x500c96=new Date(),_0x31a74d=new Date(_0x163a7a),_0x670133=String(_0x31a74d['getHours']())[_0x37cdf0(0x508)](0x2,'0'),_0x10afeb=String(_0x31a74d[_0x37cdf0(0x121a)]())['padStart'](0x2,'0'),_0x193521=_0x670133+':'+_0x10afeb;if(_0x500c96['toDateString']()===_0x31a74d['toDateString']())return _0x37cdf0(0x983)+_0x193521;const _0x333fc8=new Date();_0x333fc8['setDate'](_0x500c96['getDate']()-0x1);if(_0x333fc8[_0x37cdf0(0x5ab)]()===_0x31a74d[_0x37cdf0(0x5ab)]())return _0x37cdf0(0xc3)+_0x193521;if(_0x500c96[_0x37cdf0(0xc2a)]()===_0x31a74d[_0x37cdf0(0xc2a)]()){const _0x3617cf=String(_0x31a74d[_0x37cdf0(0x63a)]()+0x1),_0xef1aa4=String(_0x31a74d[_0x37cdf0(0x14c)]());return _0x3617cf+'月'+_0xef1aa4+'日\x20'+_0x193521;}const _0x2b6848=_0x31a74d[_0x37cdf0(0xc2a)](),_0x1f654b=String(_0x31a74d[_0x37cdf0(0x63a)]()+0x1),_0x235c89=String(_0x31a74d[_0x37cdf0(0x14c)]());return _0x2b6848+'年'+_0x1f654b+'月'+_0x235c89+'日\x20'+_0x193521;}function _0x25b947(){const _0x164fe2=_0x204348,_0x2f3fcf=_0xb80e9();document[_0x164fe2(0x458)](_0x164fe2(0x1170))[_0x164fe2(0x8dd)]=_0x2f3fcf[_0x164fe2(0x33c)],document[_0x164fe2(0x458)](_0x164fe2(0x752))['value']=_0x2f3fcf[_0x164fe2(0x7e2)],document['getElementById'](_0x164fe2(0x809))[_0x164fe2(0x8dd)]=_0x2f3fcf['cfg_scale'],document[_0x164fe2(0x458)]('nai-sampler')[_0x164fe2(0x8dd)]=_0x2f3fcf[_0x164fe2(0x4a2)],document[_0x164fe2(0x458)](_0x164fe2(0xa94))[_0x164fe2(0x8dd)]=_0x2f3fcf['seed'],document[_0x164fe2(0x458)](_0x164fe2(0xe31))[_0x164fe2(0x8dd)]=_0x2f3fcf['uc_preset'],document[_0x164fe2(0x458)](_0x164fe2(0x67a))[_0x164fe2(0x8f7)]=_0x2f3fcf['quality_toggle'],document['getElementById'](_0x164fe2(0x1469))[_0x164fe2(0x8f7)]=_0x2f3fcf[_0x164fe2(0x240)],document[_0x164fe2(0x458)](_0x164fe2(0x104))[_0x164fe2(0x8f7)]=_0x2f3fcf[_0x164fe2(0x7f6)],document['getElementById'](_0x164fe2(0x364))[_0x164fe2(0x8dd)]=_0x2f3fcf[_0x164fe2(0xa4e)],document[_0x164fe2(0x458)](_0x164fe2(0xd47))['value']=_0x2f3fcf[_0x164fe2(0x841)],document[_0x164fe2(0x458)](_0x164fe2(0x125e))[_0x164fe2(0x8dd)]=_0x2f3fcf['cors_proxy'],document[_0x164fe2(0x458)](_0x164fe2(0xf8f))[_0x164fe2(0x8dd)]=_0x2f3fcf['custom_proxy_url']||'';const _0x28efbc=document[_0x164fe2(0x458)](_0x164fe2(0xbb));_0x28efbc[_0x164fe2(0x1104)][_0x164fe2(0x4db)]=_0x2f3fcf[_0x164fe2(0x413)]===_0x164fe2(0x76a)?'block':'none';}function _0x49ce2f(){const _0x332205=_0x204348,_0x13ee0c=document[_0x332205(0x458)](_0x332205(0x759))[_0x332205(0x8f7)],_0x36b0fa=document[_0x332205(0x458)](_0x332205(0x10d0))[_0x332205(0x8dd)],_0x4fea22=document[_0x332205(0x458)](_0x332205(0x40a))[_0x332205(0x8dd)][_0x332205(0x2aa)]();localStorage[_0x332205(0xc93)](_0x332205(0xf42),_0x13ee0c),localStorage[_0x332205(0xc93)](_0x332205(0x10d0),_0x36b0fa),localStorage[_0x332205(0xc93)](_0x332205(0x40a),_0x4fea22);const _0x29c4af={'resolution':document[_0x332205(0x458)](_0x332205(0x1170))[_0x332205(0x8dd)],'steps':parseInt(document[_0x332205(0x458)]('nai-steps')[_0x332205(0x8dd)]),'cfg_scale':parseFloat(document['getElementById']('nai-cfg-scale')[_0x332205(0x8dd)]),'sampler':document[_0x332205(0x458)](_0x332205(0x966))[_0x332205(0x8dd)],'seed':parseInt(document['getElementById']('nai-seed')[_0x332205(0x8dd)]),'uc_preset':parseInt(document[_0x332205(0x458)](_0x332205(0xe31))[_0x332205(0x8dd)]),'quality_toggle':document[_0x332205(0x458)](_0x332205(0x67a))['checked'],'smea':document[_0x332205(0x458)](_0x332205(0x1469))[_0x332205(0x8f7)],'smea_dyn':document[_0x332205(0x458)](_0x332205(0x104))['checked'],'default_positive':document[_0x332205(0x458)]('nai-default-positive')[_0x332205(0x8dd)],'default_negative':document['getElementById'](_0x332205(0xd47))[_0x332205(0x8dd)],'cors_proxy':document[_0x332205(0x458)]('nai-cors-proxy')[_0x332205(0x8dd)],'custom_proxy_url':document[_0x332205(0x458)]('nai-custom-proxy-url')[_0x332205(0x8dd)]};localStorage['setItem'](_0x332205(0x1219),JSON[_0x332205(0xc04)](_0x29c4af));}function _0x16a87b(){const _0xbf500a=_0x204348;localStorage['removeItem'](_0xbf500a(0x1219)),_0x25b947(),alert('已恢复默认设置！');}function _0xb80e9(){const _0x314686=_0x204348,_0x3b761b={'resolution':_0x314686(0xe4e),'steps':0x1c,'cfg_scale':0x5,'sampler':_0x314686(0x59f),'seed':-0x1,'uc_preset':0x1,'quality_toggle':!![],'smea':!![],'smea_dyn':![],'default_positive':_0x314686(0x2d6),'default_negative':_0x314686(0xb5e),'cors_proxy':_0x314686(0x11ee),'custom_proxy_url':''},_0x5b7644=localStorage[_0x314686(0x127d)]('novelai-settings');if(_0x5b7644)try{return{..._0x3b761b,...JSON[_0x314686(0x44c)](_0x5b7644)};}catch(_0x9c004e){return _0x3b761b;}return _0x3b761b;}function _0x1567d3(_0x22af26){const _0x2b0485=_0x204348,_0x3e63e2=_0xb80e9();if(!_0x22af26||!_0x42f206[_0x2b0485(0x954)][_0x22af26])return console[_0x2b0485(0x7d1)](_0x2b0485(0x138f)),{'positive':_0x3e63e2[_0x2b0485(0xa4e)],'negative':_0x3e63e2['default_negative'],'source':'system'};const _0x15dcfa=_0x42f206[_0x2b0485(0x954)][_0x22af26],_0x28bd21=_0x15dcfa[_0x2b0485(0xda2)][_0x2b0485(0xe1a)]||{};return _0x28bd21['promptSource']===_0x2b0485(0x4c5)?(console[_0x2b0485(0x7d1)]('✅\x20NAI提示词：使用角色配置'),console[_0x2b0485(0x7d1)](_0x2b0485(0xaa4),_0x28bd21['characterPositivePrompt']||_0x2b0485(0x11e4)),console[_0x2b0485(0x7d1)](_0x2b0485(0x3f4),_0x28bd21[_0x2b0485(0x134a)]||_0x2b0485(0x11e4)),{'positive':_0x28bd21[_0x2b0485(0x7f)]||'','negative':_0x28bd21[_0x2b0485(0x134a)]||'','source':_0x2b0485(0x4c5)}):(console[_0x2b0485(0x7d1)](_0x2b0485(0xf70)),console['log'](_0x2b0485(0xaa4),_0x3e63e2[_0x2b0485(0xa4e)]||_0x2b0485(0x11e4)),console[_0x2b0485(0x7d1)](_0x2b0485(0x3f4),_0x3e63e2[_0x2b0485(0x841)]||'(空)'),{'positive':_0x3e63e2[_0x2b0485(0xa4e)],'negative':_0x3e63e2[_0x2b0485(0x841)],'source':_0x2b0485(0x1370)});}async function _0x4d9797(){const _0xa2f50d=_0x204348,_0x2afd7c=document[_0xa2f50d(0x458)](_0xa2f50d(0x40a))[_0xa2f50d(0x8dd)]['trim'](),_0xd1ab20=document[_0xa2f50d(0x458)](_0xa2f50d(0x10d0))['value'],_0x565bb7=document[_0xa2f50d(0x458)]('nai-test-prompt')[_0xa2f50d(0x8dd)][_0xa2f50d(0x2aa)]();if(!_0x2afd7c){alert('请先配置NovelAI\x20API\x20Key！');return;}if(!_0x565bb7){alert(_0xa2f50d(0x11ff));return;}const _0xcef3d2=_0xb80e9(),_0x58b5bb=document['getElementById'](_0xa2f50d(0x1083))[_0xa2f50d(0x8dd)][_0xa2f50d(0x2aa)](),_0x3654f0=document[_0xa2f50d(0x458)](_0xa2f50d(0xd88)),_0x2d9460=document['getElementById']('nai-test-result'),_0x4868d6=document[_0xa2f50d(0x458)](_0xa2f50d(0x2b9)),_0x1e4a5d=document[_0xa2f50d(0x458)](_0xa2f50d(0xf4));_0x3654f0[_0xa2f50d(0x1104)][_0xa2f50d(0x4db)]=_0xa2f50d(0x1188),_0x2d9460[_0xa2f50d(0x1104)][_0xa2f50d(0x4db)]=_0xa2f50d(0x464),_0x4868d6[_0xa2f50d(0x1104)][_0xa2f50d(0x4db)]=_0xa2f50d(0x464),_0x1e4a5d[_0xa2f50d(0xb18)]=!![],_0x1e4a5d['textContent']=_0xa2f50d(0x610);try{const [_0x57c8b1,_0x3b06b3]=_0xcef3d2[_0xa2f50d(0x33c)][_0xa2f50d(0x90b)]('x')['map'](Number);let _0x14212c;_0xd1ab20[_0xa2f50d(0xd8d)]('nai-diffusion-4')?_0x14212c={'input':_0x565bb7,'model':_0xd1ab20,'action':'generate','parameters':{'params_version':0x3,'width':_0x57c8b1,'height':_0x3b06b3,'scale':_0xcef3d2[_0xa2f50d(0xd4a)],'sampler':_0xcef3d2['sampler'],'steps':_0xcef3d2[_0xa2f50d(0x7e2)],'seed':_0xcef3d2['seed']===-0x1?Math['floor'](Math[_0xa2f50d(0x23a)]()*0x2540be3ff):_0xcef3d2['seed'],'n_samples':0x1,'ucPreset':_0xcef3d2['uc_preset'],'qualityToggle':_0xcef3d2[_0xa2f50d(0x13d5)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0xa2f50d(0xa96),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x565bb7,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x58b5bb,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x58b5bb,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x14212c={'input':_0x565bb7,'model':_0xd1ab20,'action':_0xa2f50d(0xe4),'parameters':{'width':_0x57c8b1,'height':_0x3b06b3,'scale':_0xcef3d2[_0xa2f50d(0xd4a)],'sampler':_0xcef3d2['sampler'],'steps':_0xcef3d2[_0xa2f50d(0x7e2)],'seed':_0xcef3d2[_0xa2f50d(0xa72)]===-0x1?Math[_0xa2f50d(0xbd5)](Math[_0xa2f50d(0x23a)]()*0x2540be3ff):_0xcef3d2[_0xa2f50d(0xa72)],'n_samples':0x1,'ucPreset':_0xcef3d2[_0xa2f50d(0x121c)],'qualityToggle':_0xcef3d2[_0xa2f50d(0x13d5)],'sm':_0xcef3d2[_0xa2f50d(0x240)],'sm_dyn':_0xcef3d2['smea_dyn'],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0xa2f50d(0x4cf),'negative_prompt':_0x58b5bb}};console[_0xa2f50d(0x7d1)](_0xa2f50d(0xc62)),console[_0xa2f50d(0x7d1)](_0xa2f50d(0x9b9),_0xd1ab20),console[_0xa2f50d(0x7d1)]('📋\x20请求体:',JSON[_0xa2f50d(0xc04)](_0x14212c,null,0x2));let _0x5f4631;_0xd1ab20[_0xa2f50d(0xd8d)](_0xa2f50d(0x105a))?_0x5f4631=_0xa2f50d(0xe8f):_0x5f4631=_0xa2f50d(0x197);let _0x30a4c9=_0xcef3d2[_0xa2f50d(0x413)];_0x30a4c9===_0xa2f50d(0x76a)&&(_0x30a4c9=_0xcef3d2[_0xa2f50d(0x2b8)]||'');_0x30a4c9&&_0x30a4c9!==''&&(_0x5f4631=_0x30a4c9+encodeURIComponent(_0x5f4631));const _0x184c14=/Chrome/[_0xa2f50d(0x9c0)](navigator['userAgent'])&&!/Edg/[_0xa2f50d(0x9c0)](navigator[_0xa2f50d(0x709)]);let _0x28c052={'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0xa2f50d(0x8aa)+_0x2afd7c},'body':JSON[_0xa2f50d(0xc04)](_0x14212c)};if(_0x184c14){console[_0xa2f50d(0x7d1)](_0xa2f50d(0x9bb));const _0x52f789={};for(const [_0x81eebc,_0x5b990f]of Object[_0xa2f50d(0x1309)](_0x28c052[_0xa2f50d(0x371)])){_0x52f789[_0x81eebc]=_0x5b990f['replace'](/[^\x00-\xFF]/g,'');}_0x28c052[_0xa2f50d(0x371)]=_0x52f789;}const _0x3cf0ce=await fetch(_0x5f4631,_0x28c052);console[_0xa2f50d(0x7d1)]('Response\x20status:',_0x3cf0ce[_0xa2f50d(0x13b2)]),console['log']('Response\x20headers:',[..._0x3cf0ce['headers']['entries']()]);if(!_0x3cf0ce['ok']){const _0x50e611=await _0x3cf0ce[_0xa2f50d(0xdd5)]();console[_0xa2f50d(0xb61)](_0xa2f50d(0x8f),_0x50e611);throw new Error(_0xa2f50d(0x6f9)+_0x3cf0ce[_0xa2f50d(0x13b2)]+'):\x20'+_0x50e611);}const _0x59c48a=_0x3cf0ce[_0xa2f50d(0x371)][_0xa2f50d(0x36d)](_0xa2f50d(0x459));console['log']('Content-Type:',_0x59c48a);let _0x437e7d;if(_0x59c48a&&_0x59c48a[_0xa2f50d(0xd8d)](_0xa2f50d(0xb45))){console[_0xa2f50d(0x7d1)]('检测到\x20SSE\x20流式响应，开始解析...'),_0x3654f0[_0xa2f50d(0x1a2)]=_0xa2f50d(0xad8);const _0x20f116=await _0x3cf0ce['text']();console[_0xa2f50d(0x7d1)](_0xa2f50d(0xb3b),_0x20f116[_0xa2f50d(0x131d)]);const _0x43fb83=_0x20f116[_0xa2f50d(0x2aa)]()[_0xa2f50d(0x90b)]('\x0a');let _0xef47c1=null;for(let _0x3cfe32=_0x43fb83['length']-0x1;_0x3cfe32>=0x0;_0x3cfe32--){const _0x2180ca=_0x43fb83[_0x3cfe32][_0xa2f50d(0x2aa)]();if(_0x2180ca[_0xa2f50d(0x13ad)]('data:\x20')&&_0x2180ca!==_0xa2f50d(0x21d)){const _0x417502=_0x2180ca[_0xa2f50d(0xa6d)](0x6);try{const _0xa6e47f=JSON[_0xa2f50d(0x44c)](_0x417502);if(_0xa6e47f['event_type']===_0xa2f50d(0x922)&&_0xa6e47f[_0xa2f50d(0xefe)]){_0xef47c1=_0xa6e47f[_0xa2f50d(0xefe)],console[_0xa2f50d(0x7d1)](_0xa2f50d(0x1313));break;}if(_0xa6e47f[_0xa2f50d(0x76b)]){_0xef47c1=_0xa6e47f[_0xa2f50d(0x76b)],console[_0xa2f50d(0x7d1)]('从\x20JSON.data\x20中提取图片数据');break;}if(_0xa6e47f[_0xa2f50d(0xefe)]){_0xef47c1=_0xa6e47f['image'],console[_0xa2f50d(0x7d1)](_0xa2f50d(0xde4));break;}}catch(_0x458cbe){_0xef47c1=_0x417502,console[_0xa2f50d(0x7d1)]('直接使用\x20base64\x20数据');break;}}}if(!_0xef47c1)throw new Error(_0xa2f50d(0x1199));const _0x442979=_0xef47c1[_0xa2f50d(0x13ad)](_0xa2f50d(0xca4)),_0x8348ba=_0xef47c1[_0xa2f50d(0x13ad)](_0xa2f50d(0x2b7));if(_0x442979||_0x8348ba){console[_0xa2f50d(0x7d1)](_0xa2f50d(0x1405));const _0x4e6a00=atob(_0xef47c1),_0x5aceaf=new Uint8Array(_0x4e6a00[_0xa2f50d(0x131d)]);for(let _0x20f82d=0x0;_0x20f82d<_0x4e6a00[_0xa2f50d(0x131d)];_0x20f82d++){_0x5aceaf[_0x20f82d]=_0x4e6a00['charCodeAt'](_0x20f82d);}const _0x324864=new Blob([_0x5aceaf],{'type':_0x442979?_0xa2f50d(0x100d):_0xa2f50d(0x229)});console['log']('图片\x20Blob\x20创建成功，大小:',_0x324864['size']);const _0x1c27c8=URL[_0xa2f50d(0x795)](_0x324864);document[_0xa2f50d(0x458)]('nai-result-image')['src']=_0x1c27c8,_0x3654f0['style'][_0xa2f50d(0x4db)]=_0xa2f50d(0x464),_0x2d9460[_0xa2f50d(0x1104)][_0xa2f50d(0x4db)]='block',console[_0xa2f50d(0x7d1)]('✅\x20图片显示成功！🎨');return;}console[_0xa2f50d(0x7d1)](_0xa2f50d(0x136a));const _0x17ccc2=atob(_0xef47c1),_0x3389f6=new Uint8Array(_0x17ccc2[_0xa2f50d(0x131d)]);for(let _0xd0bc83=0x0;_0xd0bc83<_0x17ccc2['length'];_0xd0bc83++){_0x3389f6[_0xd0bc83]=_0x17ccc2['charCodeAt'](_0xd0bc83);}_0x437e7d=new Blob([_0x3389f6]),console[_0xa2f50d(0x7d1)](_0xa2f50d(0x145a),_0x437e7d['size']);}else _0x437e7d=await _0x3cf0ce['blob'](),console[_0xa2f50d(0x7d1)]('收到数据，类型:',_0x437e7d[_0xa2f50d(0x259)],_0xa2f50d(0xdd),_0x437e7d[_0xa2f50d(0x12a4)]);try{if(typeof JSZip===_0xa2f50d(0x37c))throw new Error(_0xa2f50d(0xc3c));_0x3654f0[_0xa2f50d(0x1a2)]=_0xa2f50d(0x1403);const _0x3cab6d=await JSZip[_0xa2f50d(0x105)](_0x437e7d);console[_0xa2f50d(0x7d1)](_0xa2f50d(0x119f),Object['keys'](_0x3cab6d[_0xa2f50d(0x1a9)]));let _0x3fc500=null;for(let _0x4210f7 in _0x3cab6d['files']){if(_0x4210f7['match'](/\.(png|jpg|jpeg|webp)$/i)){_0x3fc500=_0x3cab6d[_0xa2f50d(0x1a9)][_0x4210f7],console[_0xa2f50d(0x7d1)]('找到图片文件:',_0x4210f7);break;}}if(!_0x3fc500)throw new Error(_0xa2f50d(0x892));const _0x242894=await _0x3fc500[_0xa2f50d(0x890)](_0xa2f50d(0x43d));console[_0xa2f50d(0x7d1)]('提取的图片大小:',_0x242894[_0xa2f50d(0x12a4)]);const _0x4c5d81=URL[_0xa2f50d(0x795)](_0x242894);console[_0xa2f50d(0x7d1)](_0xa2f50d(0x10cd),_0x4c5d81),document[_0xa2f50d(0x458)](_0xa2f50d(0x64d))[_0xa2f50d(0x577)]=_0x4c5d81,_0x3654f0[_0xa2f50d(0x1104)][_0xa2f50d(0x4db)]='none',_0x2d9460['style'][_0xa2f50d(0x4db)]='block';}catch(_0x42e250){console[_0xa2f50d(0xb61)](_0xa2f50d(0xab5),_0x42e250),console[_0xa2f50d(0x7d1)](_0xa2f50d(0xb06));if(_0x437e7d[_0xa2f50d(0x259)][_0xa2f50d(0x13ad)](_0xa2f50d(0xc07))){const _0x2794d4=URL[_0xa2f50d(0x795)](_0x437e7d);document['getElementById'](_0xa2f50d(0x64d))[_0xa2f50d(0x577)]=_0x2794d4,_0x3654f0[_0xa2f50d(0x1104)][_0xa2f50d(0x4db)]=_0xa2f50d(0x464),_0x2d9460[_0xa2f50d(0x1104)][_0xa2f50d(0x4db)]='block';}else throw new Error(_0xa2f50d(0x416)+_0x42e250[_0xa2f50d(0x7aa)]);}}catch(_0x265b3e){console[_0xa2f50d(0xb61)](_0xa2f50d(0x11c7),_0x265b3e),_0x3654f0[_0xa2f50d(0x1104)][_0xa2f50d(0x4db)]=_0xa2f50d(0x464),_0x4868d6[_0xa2f50d(0x1104)][_0xa2f50d(0x4db)]=_0xa2f50d(0x1188),_0x4868d6[_0xa2f50d(0x1a2)]=_0xa2f50d(0xfe4)+_0x265b3e[_0xa2f50d(0x7aa)];}finally{_0x1e4a5d['disabled']=![],_0x1e4a5d[_0xa2f50d(0x1a2)]='生成图像';}}function _0x478393(_0x53ed21,_0x42e6dd){const _0x3a0bc3=_0x204348;_0x4b589a(),clearTimeout(_0xf2f511);const _0x41eab7=_0x42f206['chats'][_0x53ed21];if(!_0x41eab7)return;const _0x2f6614=document[_0x3a0bc3(0x458)](_0x3a0bc3(0x11eb));document['getElementById'](_0x3a0bc3(0xbd1))[_0x3a0bc3(0x577)]=_0x41eab7[_0x3a0bc3(0xda2)][_0x3a0bc3(0x9c7)]||_0x41eab7[_0x3a0bc3(0xda2)]['groupAvatar']||_0x4fd084,document[_0x3a0bc3(0x458)](_0x3a0bc3(0xec7))[_0x3a0bc3(0x586)](_0x3a0bc3(0x863))[_0x3a0bc3(0x1a2)]=_0x41eab7[_0x3a0bc3(0x132a)],document[_0x3a0bc3(0x458)]('notification-content')['querySelector']('.message')[_0x3a0bc3(0x1a2)]=_0x42e6dd,_0x2f6614[_0x3a0bc3(0x11c2)][_0x3a0bc3(0x1097)](_0x3a0bc3(0x67d)),void _0x2f6614['offsetWidth'],_0x2f6614[_0x3a0bc3(0x11c2)][_0x3a0bc3(0xa58)](_0x3a0bc3(0x67d));const _0x20b7a4=_0x2f6614[_0x3a0bc3(0x350)](!![]);_0x2f6614[_0x3a0bc3(0x135e)][_0x3a0bc3(0x3f2)](_0x20b7a4,_0x2f6614),_0x20b7a4[_0x3a0bc3(0xd85)](_0x3a0bc3(0x1122),()=>{const _0x701b99=_0x3a0bc3;_0x31c384(_0x53ed21),_0x20b7a4[_0x701b99(0x11c2)][_0x701b99(0x1097)](_0x701b99(0x67d));}),_0xf2f511=setTimeout(()=>{const _0x505eae=_0x3a0bc3;_0x20b7a4[_0x505eae(0x11c2)][_0x505eae(0x1097)](_0x505eae(0x67d));},0xfa0),_0x3fa630();}function _0x325fa4(){const _0x17ec0d=_0x204348,_0xa7541d=new Date(),_0x37184c=_0xa7541d[_0x17ec0d(0x11df)]('zh-CN',{'hour':_0x17ec0d(0x40c),'minute':_0x17ec0d(0x40c)}),_0x2c9235=_0xa7541d[_0x17ec0d(0x1423)](_0x17ec0d(0xaa2),{'weekday':_0x17ec0d(0x1dc),'month':'long','day':_0x17ec0d(0x4fb)});document['getElementById'](_0x17ec0d(0x25e))[_0x17ec0d(0x1a2)]=_0x37184c;}function _0x418096(_0x1a4641){const _0x24fdf3=_0x204348;if(!_0x1a4641)return[{'type':_0x24fdf3(0xdd5),'content':'(AI返回了空内容)'}];let _0xe3db3f=_0x1a4641[_0x24fdf3(0x2aa)]();const _0x48fa8e=/```json\s*([\s\S]*?)\s*```/,_0x321793=_0xe3db3f[_0x24fdf3(0x41c)](_0x48fa8e);_0x321793&&_0x321793[0x1]&&(_0xe3db3f=_0x321793[0x1][_0x24fdf3(0x2aa)](),console['log'](_0x24fdf3(0x61e)));if(_0xe3db3f[_0x24fdf3(0x13ad)]('[')&&_0xe3db3f['endsWith'](']'))try{const _0x415966=JSON['parse'](_0xe3db3f);if(Array[_0x24fdf3(0x971)](_0x415966))return console['log']('解析成功：标准JSON数组格式。'),_0x415966;}catch(_0x211dd0){console[_0x24fdf3(0x1b6)](_0x24fdf3(0x3a8));}const _0x260c69=_0xe3db3f[_0x24fdf3(0x893)]('['),_0x8d7e6=_0xe3db3f['lastIndexOf']('}');if(_0x260c69!==-0x1&&_0x8d7e6!==-0x1&&_0x8d7e6>_0x260c69){const _0x5adc=_0xe3db3f['indexOf'](']',_0x8d7e6);if(_0x5adc!==-0x1){const _0x46a28e=_0xe3db3f[_0x24fdf3(0xa6d)](_0x260c69,_0x5adc+0x1);try{const _0x2f6e3a=JSON[_0x24fdf3(0x44c)](_0x46a28e);if(Array[_0x24fdf3(0x971)](_0x2f6e3a))return console['log']('解析成功：通过强力提取\x20[\x20...\x20}\x20...\x20]\x20模式。'),_0x2f6e3a;}catch(_0x4645e2){console[_0x24fdf3(0x1b6)](_0x24fdf3(0x101e));}}}const _0x5cb80e=_0xe3db3f[_0x24fdf3(0x41c)](/{[^{}]*}/g);if(_0x5cb80e){const _0x583e37=[];for(const _0xe2c758 of _0x5cb80e){try{const _0x46e1a8=JSON[_0x24fdf3(0x44c)](_0xe2c758);_0x583e37[_0x24fdf3(0x129e)](_0x46e1a8);}catch(_0x5c62e8){console[_0x24fdf3(0x1b6)](_0x24fdf3(0xffa),_0xe2c758);}}if(_0x583e37[_0x24fdf3(0x131d)]>0x0)return console[_0x24fdf3(0x7d1)](_0x24fdf3(0x913)),_0x583e37;}return console[_0x24fdf3(0xb61)](_0x24fdf3(0xb48),_0x1a4641),[{'type':_0x24fdf3(0xdd5),'content':_0x1a4641}];}function _0x5ecef0(_0x113099=new Date()){const _0x4e64dc=_0x204348,_0x4cacb8=_0x113099[_0x4e64dc(0x748)]();if(_0x4cacb8>=0x0&&_0x4cacb8<0x5)return'凌晨';else{if(_0x4cacb8>=0x5&&_0x4cacb8<0x9)return'早上';else{if(_0x4cacb8>=0x9&&_0x4cacb8<0xd)return'上午';else{if(_0x4cacb8>=0xd&&_0x4cacb8<0x12)return'下午';else{if(_0x4cacb8>=0x12&&_0x4cacb8<0x18)return'晚上';}}}}return'现在';}async function _0x30fe90(){const _0x2a93b1=_0x204348,_0x5d7723=document['getElementById'](_0x2a93b1(0xdb8));_0x5d7723[_0x2a93b1(0x110d)]=_0x2a93b1(0x92f);const _0x2ddd71=await _0x17d534[_0x2a93b1(0x8b5)]['toArray']();_0x2ddd71[_0x2a93b1(0x12c2)](_0x55df27=>{const _0x478d1b=_0x2a93b1,_0x4444de=document[_0x478d1b(0xe7d)](_0x478d1b(0x790));_0x4444de[_0x478d1b(0x8dd)]=_0x55df27['id'],_0x4444de['textContent']=_0x55df27['name'],_0x5d7723[_0x478d1b(0x1079)](_0x4444de);});const _0x2ead6c=_0x42f206[_0x2a93b1(0x5cb)];let _0x59f6f0=null;for(const _0x2fc9a8 of _0x2ddd71){if(_0x2fc9a8[_0x2a93b1(0x683)]===_0x2ead6c[_0x2a93b1(0x683)]&&_0x2fc9a8[_0x2a93b1(0x3fe)]===_0x2ead6c[_0x2a93b1(0x3fe)]&&_0x2fc9a8[_0x2a93b1(0x49b)]===_0x2ead6c[_0x2a93b1(0x49b)]&&_0x2fc9a8[_0x2a93b1(0x1380)]===_0x2ead6c[_0x2a93b1(0x1380)]&&_0x2fc9a8[_0x2a93b1(0x121d)]===_0x2ead6c[_0x2a93b1(0x121d)]&&_0x2fc9a8[_0x2a93b1(0xdc9)]===_0x2ead6c[_0x2a93b1(0xdc9)]&&(_0x2fc9a8[_0x2a93b1(0x657)]||'')===(_0x2ead6c['minimaxGroupId']||'')&&(_0x2fc9a8[_0x2a93b1(0x770)]||'')===(_0x2ead6c[_0x2a93b1(0x770)]||'')&&(_0x2fc9a8[_0x2a93b1(0x1063)]||'speech-01')===(_0x2ead6c[_0x2a93b1(0x1063)]||_0x2a93b1(0x201))){_0x59f6f0=_0x2fc9a8['id'];break;}}_0x59f6f0?_0x5d7723[_0x2a93b1(0x8dd)]=_0x59f6f0:_0x5d7723[_0x2a93b1(0x8dd)]='current';}async function _0x4a8495(){const _0x24e1ec=_0x204348,_0xc34d69=document['getElementById'](_0x24e1ec(0xdb8)),_0x542546=parseInt(_0xc34d69[_0x24e1ec(0x8dd)]);if(isNaN(_0x542546))return;const _0x5c63ed=await _0x17d534[_0x24e1ec(0x8b5)][_0x24e1ec(0x36d)](_0x542546);_0x5c63ed&&(_0x42f206['apiConfig']={'id':_0x24e1ec(0x1442),'proxyUrl':_0x5c63ed[_0x24e1ec(0x683)],'apiKey':_0x5c63ed['apiKey'],'model':_0x5c63ed[_0x24e1ec(0x49b)],'secondaryProxyUrl':_0x5c63ed[_0x24e1ec(0x1380)],'secondaryApiKey':_0x5c63ed[_0x24e1ec(0x121d)],'secondaryModel':_0x5c63ed[_0x24e1ec(0xdc9)],'minimaxGroupId':_0x5c63ed['minimaxGroupId'],'minimaxApiKey':_0x5c63ed[_0x24e1ec(0x770)],'minimaxModel':_0x5c63ed[_0x24e1ec(0x1063)]},await _0x17d534['apiConfig'][_0x24e1ec(0xf3f)](_0x42f206[_0x24e1ec(0x5cb)]),_0x51cd3d(),document['getElementById'](_0x24e1ec(0x8c9))['click'](),_0x5c63ed[_0x24e1ec(0x1380)]&&_0x5c63ed[_0x24e1ec(0x121d)]&&document[_0x24e1ec(0x458)](_0x24e1ec(0x685))[_0x24e1ec(0x1122)](),alert(_0x24e1ec(0x174)+_0x5c63ed['name']+'”'));}async function _0x85b8f7(){const _0x3eaf6a=_0x204348,_0x3a4d15=await _0x335e57(_0x3eaf6a(0x42b),_0x3eaf6a(0x19f));if(!_0x3a4d15||!_0x3a4d15[_0x3eaf6a(0x2aa)]())return;const _0x1ffaaf={'name':_0x3a4d15['trim'](),'proxyUrl':document['getElementById'](_0x3eaf6a(0x18d))[_0x3eaf6a(0x8dd)][_0x3eaf6a(0x2aa)](),'apiKey':document[_0x3eaf6a(0x458)](_0x3eaf6a(0x361))[_0x3eaf6a(0x8dd)][_0x3eaf6a(0x2aa)](),'model':document['getElementById'](_0x3eaf6a(0xc2d))['value'],'secondaryProxyUrl':document[_0x3eaf6a(0x458)](_0x3eaf6a(0x132f))['value']['trim'](),'secondaryApiKey':document[_0x3eaf6a(0x458)](_0x3eaf6a(0x494))['value'][_0x3eaf6a(0x2aa)](),'secondaryModel':document[_0x3eaf6a(0x458)](_0x3eaf6a(0xbf3))[_0x3eaf6a(0x8dd)],'minimaxGroupId':document[_0x3eaf6a(0x458)](_0x3eaf6a(0xb2b))[_0x3eaf6a(0x8dd)]['trim'](),'minimaxApiKey':document[_0x3eaf6a(0x458)](_0x3eaf6a(0x309))['value']['trim'](),'minimaxModel':document[_0x3eaf6a(0x458)](_0x3eaf6a(0x537))[_0x3eaf6a(0x8dd)]},_0x18768f=await _0x17d534['apiPresets']['where']('name')[_0x3eaf6a(0x7db)](_0x1ffaaf[_0x3eaf6a(0x132a)])['first']();if(_0x18768f){const _0xec29e1=await _0x2532b9('覆盖预设','名为\x20“'+_0x1ffaaf[_0x3eaf6a(0x132a)]+_0x3eaf6a(0x720),{'confirmButtonClass':'btn-danger'});if(!_0xec29e1)return;_0x1ffaaf['id']=_0x18768f['id'];}await _0x17d534[_0x3eaf6a(0x8b5)][_0x3eaf6a(0xf3f)](_0x1ffaaf),await _0x30fe90(),alert(_0x3eaf6a(0xa9d));}async function _0x2afadc(){const _0x1ef1e5=_0x204348,_0x41e1ba=document[_0x1ef1e5(0x458)]('api-preset-select'),_0x336a65=parseInt(_0x41e1ba[_0x1ef1e5(0x8dd)]);if(isNaN(_0x336a65)){alert(_0x1ef1e5(0x977));return;}const _0x443449=await _0x17d534['apiPresets'][_0x1ef1e5(0x36d)](_0x336a65);if(!_0x443449)return;const _0x21431b=await _0x2532b9('删除预设',_0x1ef1e5(0xf60)+_0x443449[_0x1ef1e5(0x132a)]+_0x1ef1e5(0x581),{'confirmButtonClass':_0x1ef1e5(0x4d3)});_0x21431b&&(await _0x17d534['apiPresets'][_0x1ef1e5(0x195)](_0x336a65),await _0x30fe90(),alert(_0x1ef1e5(0x380)));}function _0x51cd3d(){const _0x32089a=_0x204348;document[_0x32089a(0x458)](_0x32089a(0x18d))[_0x32089a(0x8dd)]=_0x42f206[_0x32089a(0x5cb)]['proxyUrl']||'',document[_0x32089a(0x458)]('api-key')[_0x32089a(0x8dd)]=_0x42f206[_0x32089a(0x5cb)]['apiKey']||'',document['getElementById'](_0x32089a(0x132f))[_0x32089a(0x8dd)]=_0x42f206['apiConfig'][_0x32089a(0x1380)]||'',document['getElementById']('secondary-api-key')['value']=_0x42f206[_0x32089a(0x5cb)][_0x32089a(0x121d)]||'',document['getElementById'](_0x32089a(0xa87))['checked']=_0x42f206[_0x32089a(0xf0)]['enableBackgroundActivity']||![],document[_0x32089a(0x458)](_0x32089a(0xd1b))[_0x32089a(0x8dd)]=_0x42f206[_0x32089a(0xf0)][_0x32089a(0xc29)]||0x3c,document[_0x32089a(0x458)](_0x32089a(0x8ae))[_0x32089a(0x8dd)]=_0x42f206['globalSettings']['blockCooldownHours']||0x1,document['getElementById'](_0x32089a(0x9a4))[_0x32089a(0x8f7)]=_0x42f206['globalSettings'][_0x32089a(0xf0e)],document[_0x32089a(0x458)](_0x32089a(0xcff))[_0x32089a(0x8dd)]=_0x42f206[_0x32089a(0xf0)]['chatRenderWindow']||0x32,document[_0x32089a(0x458)](_0x32089a(0x381))[_0x32089a(0x8dd)]=_0x42f206[_0x32089a(0xf0)]['chatListRenderWindow']||0x1e;const _0xda861c=document[_0x32089a(0x458)](_0x32089a(0x59b)),_0x357c37=document[_0x32089a(0x458)](_0x32089a(0x83c)),_0x4059b5=_0x42f206[_0x32089a(0xf0)][_0x32089a(0xfdf)]||0.8;_0xda861c[_0x32089a(0x8dd)]=_0x4059b5,_0x357c37[_0x32089a(0x1a2)]=_0x4059b5,document['getElementById'](_0x32089a(0xb2b))['value']=_0x42f206['apiConfig'][_0x32089a(0x657)]||'',document[_0x32089a(0x458)]('minimax-api-key')[_0x32089a(0x8dd)]=_0x42f206[_0x32089a(0x5cb)]['minimaxApiKey']||'',document[_0x32089a(0x458)](_0x32089a(0x537))[_0x32089a(0x8dd)]=_0x42f206[_0x32089a(0x5cb)][_0x32089a(0x1063)]||_0x32089a(0x201);const _0xd17a33=localStorage[_0x32089a(0x127d)](_0x32089a(0xf42))===_0x32089a(0x12b7),_0x29b6c1=localStorage[_0x32089a(0x127d)](_0x32089a(0x10d0))||_0x32089a(0xddf),_0x5b3e0e=localStorage[_0x32089a(0x127d)]('novelai-api-key')||'';document['getElementById'](_0x32089a(0x759))[_0x32089a(0x8f7)]=_0xd17a33,document[_0x32089a(0x458)](_0x32089a(0x10d0))['value']=_0x29b6c1,document[_0x32089a(0x458)]('novelai-api-key')[_0x32089a(0x8dd)]=_0x5b3e0e,document[_0x32089a(0x458)](_0x32089a(0xde8))[_0x32089a(0x1104)][_0x32089a(0x4db)]=_0xd17a33?_0x32089a(0x1188):_0x32089a(0x464),_0x30fe90(),_0x22222a();}window[_0x204348(0xe9e)]=_0x51cd3d;async function _0x2844bc(){const _0x40c619=_0x204348,_0x367088=document[_0x40c619(0x458)](_0x40c619(0x4ca));_0x367088[_0x40c619(0x110d)]='';const _0x540972=await _0x17d534['npcs'][_0x40c619(0x511)]();if(_0x540972[_0x40c619(0x131d)]===0x0){_0x367088['innerHTML']=_0x40c619(0x18a);return;}_0x540972['forEach'](_0x5eb542=>{const _0x4e0385=_0x40c619,_0x2a41e9=document[_0x4e0385(0xe7d)](_0x4e0385(0x1323));_0x2a41e9[_0x4e0385(0x69b)]=_0x4e0385(0xeee),_0x2a41e9[_0x4e0385(0x1f4)][_0x4e0385(0x5cd)]=_0x5eb542['id'],_0x2a41e9[_0x4e0385(0x110d)]=_0x4e0385(0x442)+(_0x5eb542[_0x4e0385(0x5c6)]||_0x482806)+_0x4e0385(0x333)+_0x5eb542['name']+_0x4e0385(0x7e1)+_0x5eb542['persona'][_0x4e0385(0xa6d)](0x0,0x1e)+_0x4e0385(0x507),_0x2a41e9[_0x4e0385(0xd85)](_0x4e0385(0x1122),()=>_0x169028(_0x5eb542['id'])),_0x4376d8(_0x2a41e9,async()=>{await _0x23b8cb(_0x5eb542['id']);}),_0x367088[_0x4e0385(0x1079)](_0x2a41e9);});}async function _0x169028(_0x40675a=null){const _0x32b3d9=_0x204348;editingNpcId=_0x40675a;const _0x52949a=document[_0x32b3d9(0x458)](_0x32b3d9(0x2f2)),_0x4a7776=document[_0x32b3d9(0x458)](_0x32b3d9(0xb88)),_0x29b10e=document['getElementById'](_0x32b3d9(0xce)),_0x1b7f9c=document[_0x32b3d9(0x458)](_0x32b3d9(0x41a)),_0x1f698b=document[_0x32b3d9(0x458)]('npc-avatar-preview'),_0x5bad36=document['getElementById']('npc-association-list'),_0x12b56e=document[_0x32b3d9(0x458)](_0x32b3d9(0x3ee)),_0x175e44=document['getElementById'](_0x32b3d9(0xd04)),_0x1c81b3=document[_0x32b3d9(0x458)]('npc-action-cooldown-input');_0x5bad36[_0x32b3d9(0x110d)]='',_0x12b56e[_0x32b3d9(0x110d)]=_0x32b3d9(0xb2c);const _0x3cea19=await _0x17d534['npcGroups'][_0x32b3d9(0x511)]();_0x3cea19[_0x32b3d9(0x12c2)](_0xeab15e=>{const _0x3ebb71=_0x32b3d9,_0x4dfc33=document[_0x3ebb71(0xe7d)](_0x3ebb71(0x790));_0x4dfc33[_0x3ebb71(0x8dd)]=_0xeab15e['id'],_0x4dfc33[_0x3ebb71(0x1a2)]=_0xeab15e[_0x3ebb71(0x132a)],_0x12b56e[_0x3ebb71(0x1079)](_0x4dfc33);}),_0x5bad36['innerHTML']+='<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20'+(_0x42f206[_0x32b3d9(0x551)]['nickname']||'我')+'\x20(用户)</label>',Object[_0x32b3d9(0x6eb)](_0x42f206['chats'])['filter'](_0x8712b=>!_0x8712b[_0x32b3d9(0x726)])[_0x32b3d9(0x12c2)](_0x48a357=>{const _0x1a6422=_0x32b3d9;_0x5bad36[_0x1a6422(0x110d)]+=_0x1a6422(0x111)+_0x48a357['id']+'\x22>\x20'+_0x48a357['name']+_0x1a6422(0xeb0);});if(_0x40675a){_0x4a7776[_0x32b3d9(0x1a2)]=_0x32b3d9(0x3ba);const _0x41b96c=await _0x17d534[_0x32b3d9(0x996)][_0x32b3d9(0x36d)](_0x40675a);_0x41b96c&&(_0x29b10e[_0x32b3d9(0x8dd)]=_0x41b96c[_0x32b3d9(0x132a)],_0x1b7f9c[_0x32b3d9(0x8dd)]=_0x41b96c[_0x32b3d9(0x124d)],_0x1f698b[_0x32b3d9(0x577)]=_0x41b96c[_0x32b3d9(0x5c6)]||_0x482806,_0x175e44['checked']=_0x41b96c['enableBackgroundActivity']!==![],_0x1c81b3['value']=_0x41b96c[_0x32b3d9(0x9c9)]||0xf,_0x12b56e[_0x32b3d9(0x8dd)]=_0x41b96c['npcGroupId']||'',_0x41b96c['associatedWith']&&Array['isArray'](_0x41b96c['associatedWith'])&&_0x41b96c[_0x32b3d9(0x1114)]['forEach'](_0x147a7a=>{const _0x1dcbec=_0x32b3d9,_0x4b1f3c=_0x5bad36['querySelector'](_0x1dcbec(0x13d)+_0x147a7a+'\x22]');if(_0x4b1f3c)_0x4b1f3c[_0x1dcbec(0x8f7)]=!![];}));}else{_0x4a7776['textContent']=_0x32b3d9(0xfaa),_0x29b10e[_0x32b3d9(0x8dd)]='',_0x1b7f9c['value']='',_0x1f698b['src']=_0x482806,_0x175e44[_0x32b3d9(0x8f7)]=!![],_0x1c81b3[_0x32b3d9(0x8dd)]=0xf,_0x12b56e[_0x32b3d9(0x8dd)]='';const _0x466f75=_0x5bad36[_0x32b3d9(0x586)](_0x32b3d9(0x441));if(_0x466f75)_0x466f75[_0x32b3d9(0x8f7)]=!![];}_0x52949a['classList']['add']('visible');}async function _0x310485(){const _0x157e89=_0x204348,_0x111f32=document['getElementById'](_0x157e89(0xce))[_0x157e89(0x8dd)]['trim'](),_0x5b8232=document[_0x157e89(0x458)]('npc-persona-input')[_0x157e89(0x8dd)][_0x157e89(0x2aa)]();if(!_0x111f32||!_0x5b8232){alert(_0x157e89(0x70));return;}const _0x42dede=Array[_0x157e89(0xca2)](document[_0x157e89(0x102a)]('#npc-association-list\x20input:checked'))[_0x157e89(0xbf6)](_0x1706c5=>_0x1706c5['value']),_0x5f49e3=document['getElementById'](_0x157e89(0xd04))[_0x157e89(0x8f7)],_0x300a1c=parseInt(document[_0x157e89(0x458)](_0x157e89(0x10b2))[_0x157e89(0x8dd)])||0xf,_0x395d5d=parseInt(document[_0x157e89(0x458)](_0x157e89(0x3ee))[_0x157e89(0x8dd)])||null,_0x148fd6={'name':_0x111f32,'persona':_0x5b8232,'avatar':document[_0x157e89(0x458)](_0x157e89(0x144f))['src'],'associatedWith':_0x42dede,'enableBackgroundActivity':_0x5f49e3,'actionCooldownMinutes':_0x300a1c,'npcGroupId':_0x395d5d};if(editingNpcId)await _0x17d534[_0x157e89(0x996)]['update'](editingNpcId,_0x148fd6);else{const _0x558cd3=await _0x17d534[_0x157e89(0x996)]['add'](_0x148fd6);if(_0x9dc5b0&&_0x42f206[_0x157e89(0x81d)]){const _0x3ed0a5=_0x42f206[_0x157e89(0x954)][_0x42f206['activeChatId']];_0x3ed0a5[_0x157e89(0x726)]&&(_0x3ed0a5['members'][_0x157e89(0x129e)]({'id':_0x157e89(0xa45)+_0x558cd3,'originalName':_0x111f32,'groupNickname':_0x111f32,'persona':_0x5b8232,'avatar':_0x148fd6['avatar'],'isNpc':!![]}),await _0x17d534['chats'][_0x157e89(0xf3f)](_0x3ed0a5));}}document[_0x157e89(0x458)](_0x157e89(0x2f2))[_0x157e89(0x11c2)][_0x157e89(0x1097)](_0x157e89(0x67d)),_0x9dc5b0?(_0x9dc5b0=![],_0x32daaa()):await _0x2844bc();}async function _0x354dc4(){const _0x4c471e=_0x204348;await _0x40ef80(),document[_0x4c471e(0x458)](_0x4c471e(0x1031))[_0x4c471e(0x11c2)][_0x4c471e(0xa58)](_0x4c471e(0x67d));}async function _0x40ef80(){const _0x38f405=_0x204348,_0x1d8402=document[_0x38f405(0x458)]('existing-npc-groups-list'),_0x14614c=await _0x17d534[_0x38f405(0xf69)][_0x38f405(0x511)]();_0x1d8402['innerHTML']='',_0x14614c[_0x38f405(0x131d)]===0x0&&(_0x1d8402[_0x38f405(0x110d)]=_0x38f405(0xb46)),_0x14614c['forEach'](_0x32f842=>{const _0x43851e=_0x38f405,_0x4c9962=document[_0x43851e(0xe7d)](_0x43851e(0x1323));_0x4c9962[_0x43851e(0x69b)]=_0x43851e(0x1078),_0x4c9962[_0x43851e(0x110d)]=_0x43851e(0xc8a)+_0x32f842[_0x43851e(0x132a)]+_0x43851e(0x11d3)+_0x32f842['id']+_0x43851e(0x9be),_0x1d8402[_0x43851e(0x1079)](_0x4c9962);});}async function _0x39486c(){const _0x2e70de=_0x204348,_0x1e0f05=document[_0x2e70de(0x458)](_0x2e70de(0x18c)),_0x482ca7=_0x1e0f05[_0x2e70de(0x8dd)][_0x2e70de(0x2aa)]();if(!_0x482ca7){alert(_0x2e70de(0x37b));return;}const _0x56b335=await _0x17d534[_0x2e70de(0xf69)][_0x2e70de(0x13c6)](_0x2e70de(0x132a))[_0x2e70de(0x7db)](_0x482ca7)[_0x2e70de(0xb9)]();if(_0x56b335){alert(_0x2e70de(0x641)+_0x482ca7+_0x2e70de(0x374));return;}await _0x17d534[_0x2e70de(0xf69)]['add']({'name':_0x482ca7}),_0x1e0f05[_0x2e70de(0x8dd)]='',await _0x40ef80();}async function _0x4028ec(_0x5e9a1a){const _0x5cbd3d=_0x204348,_0x3b7989=await _0x2532b9(_0x5cbd3d(0x1ef),'删除分组后，该组内的所有NPC将变为“未分组”。确定要删除吗？',{'confirmButtonClass':_0x5cbd3d(0x4d3)});_0x3b7989&&(await _0x17d534[_0x5cbd3d(0xf69)][_0x5cbd3d(0x195)](_0x5e9a1a),await _0x17d534[_0x5cbd3d(0x996)][_0x5cbd3d(0x13c6)](_0x5cbd3d(0x8d4))[_0x5cbd3d(0x7db)](_0x5e9a1a)[_0x5cbd3d(0x910)]({'npcGroupId':null}),await _0x40ef80());}async function _0x23b8cb(_0xa203f){const _0x5a8984=_0x204348,_0xef93a2=await _0x17d534[_0x5a8984(0x996)]['get'](_0xa203f);if(!_0xef93a2)return;const _0x4ba572=await _0x2532b9('删除NPC','确定要删除NPC\x20“'+_0xef93a2[_0x5a8984(0x132a)]+_0x5a8984(0x581),{'confirmButtonClass':_0x5a8984(0x4d3)});_0x4ba572&&(await _0x17d534['npcs']['delete'](_0xa203f),await _0x2844bc());}let _0x258b3c=0x0;function _0x556141(_0x2342b9){const _0x36628a=_0x204348,_0x26ad11=document[_0x36628a(0xe7d)](_0x36628a(0x1323));return _0x26ad11[_0x36628a(0x69b)]='chat-group-container',_0x26ad11['innerHTML']=_0x36628a(0x44a)+_0x2342b9[_0x36628a(0x132a)]+_0x36628a(0x136),_0x26ad11;}function _0x438393(_0x3338f0){const _0x4f48f6=_0x204348,_0x2c0d8d=document['getElementById'](_0x4f48f6(0x193)),_0x3ccf63=document[_0x4f48f6(0x458)]('load-more-chats-btn');if(_0x3ccf63)_0x3ccf63[_0x4f48f6(0x1097)]();const _0x48585f=_0x258b3c,_0x39b410=_0x258b3c+CHAT_LIST_RENDER_WINDOW,_0xf6aa27=_0x3338f0[_0x4f48f6(0x5b0)](_0x48585f,_0x39b410),_0x4c9fb6=document['createDocumentFragment']();let _0x15afba=_0x2c0d8d[_0x4f48f6(0x586)]('.chat-group-content:last-of-type');_0xf6aa27[_0x4f48f6(0x12c2)](_0x8a8897=>{const _0x71543f=_0x4f48f6;if(_0x8a8897[_0x71543f(0x259)]==='groupHeader'){const _0x3ff658=_0x556141(_0x8a8897[_0x71543f(0x1192)]);_0x4c9fb6[_0x71543f(0x1079)](_0x3ff658),_0x15afba=_0x3ff658['querySelector'](_0x71543f(0x8f6));}else{if(_0x8a8897[_0x71543f(0x259)]==='chatItem'){const _0x4df6fb=_0x1eb370(_0x8a8897['chat']);_0x15afba&&_0x8a8897[_0x71543f(0x10f6)][_0x71543f(0x1437)]?_0x15afba[_0x71543f(0x1079)](_0x4df6fb):(_0x4c9fb6[_0x71543f(0x1079)](_0x4df6fb),_0x15afba=null);}}}),_0x2c0d8d['appendChild'](_0x4c9fb6),_0x258b3c+=_0xf6aa27['length'],_0x3338f0[_0x4f48f6(0x131d)]>_0x258b3c&&_0x4ff9b9(_0x2c0d8d,_0x3338f0),document[_0x4f48f6(0x102a)]('.chat-group-header')[_0x4f48f6(0x12c2)](_0x21d5ef=>{const _0x5638df=_0x4f48f6,_0x54cb15=_0x21d5ef['cloneNode'](!![]);_0x21d5ef['parentNode'][_0x5638df(0x3f2)](_0x54cb15,_0x21d5ef),_0x54cb15[_0x5638df(0xd85)]('click',()=>{const _0x2f244f=_0x5638df;_0x54cb15[_0x2f244f(0x11c2)][_0x2f244f(0x1270)]('collapsed'),_0x54cb15['nextElementSibling']['classList']['toggle'](_0x2f244f(0xc4e));});});}async function _0x27be5e(){const _0x5549c5=_0x204348,_0x222e34=document[_0x5549c5(0x458)]('chat-list');_0x222e34['innerHTML']='';const _0x392ea3=Object[_0x5549c5(0x6eb)](_0x42f206[_0x5549c5(0x954)])[_0x5549c5(0xc12)]((_0x8cb7a5,_0x323559)=>{const _0x594eb5=_0x5549c5,_0x3a2f3d=(_0x323559[_0x594eb5(0x858)]||![])-(_0x8cb7a5[_0x594eb5(0x858)]||![]);if(_0x3a2f3d!==0x0)return _0x3a2f3d;return(_0x323559[_0x594eb5(0x1d5)][_0x594eb5(0x5b0)](-0x1)[0x0]?.[_0x594eb5(0xf16)]||0x0)-(_0x8cb7a5[_0x594eb5(0x1d5)][_0x594eb5(0x5b0)](-0x1)[0x0]?.[_0x594eb5(0xf16)]||0x0);}),_0x5df5b9=await _0x17d534[_0x5549c5(0x10a5)][_0x5549c5(0x511)]();if(_0x392ea3[_0x5549c5(0x131d)]===0x0){_0x222e34['innerHTML']=_0x5549c5(0x95c);return;}_0x5df5b9[_0x5549c5(0x12c2)](_0xa499ba=>{const _0x459450=_0x5549c5,_0x7de078=_0x392ea3[_0x459450(0xb07)](_0x30df7=>_0x30df7[_0x459450(0x1437)]===_0xa499ba['id']);_0xa499ba['latestTimestamp']=_0x7de078?_0x7de078['history'][_0x459450(0x5b0)](-0x1)[0x0]?.[_0x459450(0xf16)]||0x0:0x0;}),_0x5df5b9[_0x5549c5(0xc12)]((_0x4df658,_0x150071)=>_0x150071['latestTimestamp']-_0x4df658[_0x5549c5(0xff2)]),_0x28eb35=[];const _0x20f0ef=new Set();_0x392ea3[_0x5549c5(0x12c2)](_0xc3f6f7=>{const _0x5a0127=_0x5549c5;_0xc3f6f7[_0x5a0127(0x858)]&&(_0x28eb35[_0x5a0127(0x129e)]({'type':_0x5a0127(0x10c0),'chat':_0xc3f6f7}),_0x20f0ef[_0x5a0127(0xa58)](_0xc3f6f7['id']));}),_0x5df5b9[_0x5549c5(0x12c2)](_0x5648a9=>{const _0x2368b6=_0x5549c5,_0x527532=_0x392ea3[_0x2368b6(0xaf1)](_0x482c0f=>!_0x482c0f[_0x2368b6(0x858)]&&!_0x482c0f[_0x2368b6(0x726)]&&_0x482c0f[_0x2368b6(0x1437)]===_0x5648a9['id']);_0x527532[_0x2368b6(0x131d)]>0x0&&(_0x28eb35[_0x2368b6(0x129e)]({'type':_0x2368b6(0xbcb),'group':_0x5648a9}),_0x527532[_0x2368b6(0x12c2)](_0x250482=>{const _0x245132=_0x2368b6;_0x28eb35['push']({'type':_0x245132(0x10c0),'chat':_0x250482}),_0x20f0ef['add'](_0x250482['id']);}));}),_0x392ea3['forEach'](_0x1990f8=>{const _0x447545=_0x5549c5;!_0x20f0ef[_0x447545(0x31c)](_0x1990f8['id'])&&(_0x28eb35[_0x447545(0x129e)]({'type':_0x447545(0x10c0),'chat':_0x1990f8}),_0x20f0ef[_0x447545(0xa58)](_0x1990f8['id']));}),_0x258b3c=0x0,_0x438393();}function _0x556141(_0x10ef7a){const _0x428e20=_0x204348,_0x5dcfe9=document[_0x428e20(0xe7d)]('div');return _0x5dcfe9[_0x428e20(0x69b)]=_0x428e20(0xbf7),_0x5dcfe9[_0x428e20(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x10ef7a['name']+_0x428e20(0xf3e),_0x5dcfe9;}function _0x4ff9b9(_0x139d8c,_0x292248){const _0x4259c4=_0x204348,_0x1a5cf1=document[_0x4259c4(0xe7d)](_0x4259c4(0x986));_0x1a5cf1['id']='load-more-chats-btn',_0x1a5cf1[_0x4259c4(0x1a2)]=_0x4259c4(0xdab),_0x1a5cf1['className']=_0x4259c4(0xde6),_0x1a5cf1[_0x4259c4(0xd85)](_0x4259c4(0x1122),()=>_0x438393(_0x292248),{'once':!![]}),_0x139d8c[_0x4259c4(0x13e2)](_0x1a5cf1);}function _0x438393(){const _0x411d9d=_0x204348;if(_0x935422)return;const _0x5df445=document['getElementById'](_0x411d9d(0x193)),_0x284aff=document[_0x411d9d(0x458)](_0x411d9d(0x785));if(!_0x5df445||!_0x284aff)return;if(_0x258b3c>=_0x28eb35[_0x411d9d(0x131d)])return;_0x935422=!![];const _0x37f6b5=_0x258b3c===0x0,_0x4fc48b=()=>{const _0x2797db=_0x411d9d;_0x17adee(_0x5df445);const _0x34eba1=_0x42f206[_0x2797db(0xf0)][_0x2797db(0xf1d)]||0x1e,_0xaa2c74=_0x258b3c,_0x13ec5f=_0x258b3c+_0x34eba1,_0x30bcfd=_0x28eb35[_0x2797db(0x5b0)](_0xaa2c74,_0x13ec5f),_0x39946c=document[_0x2797db(0xdb7)]();let _0x37f055=_0x5df445[_0x2797db(0x586)](_0x2797db(0x140e));_0x30bcfd[_0x2797db(0x12c2)](_0x51c64f=>{const _0x1c10aa=_0x2797db;if(_0x51c64f[_0x1c10aa(0x259)]==='groupHeader'){const _0xc03d4c=_0x556141(_0x51c64f[_0x1c10aa(0x1192)]);_0x39946c['appendChild'](_0xc03d4c),_0x37f055=_0xc03d4c[_0x1c10aa(0x586)](_0x1c10aa(0x8f6));}else{if(_0x51c64f[_0x1c10aa(0x259)]==='chatItem'){const _0x2f1085=_0x1eb370(_0x51c64f[_0x1c10aa(0x10f6)]);if(_0x51c64f[_0x1c10aa(0x10f6)][_0x1c10aa(0x1437)]&&_0x37f055)_0x37f055[_0x1c10aa(0x1079)](_0x2f1085);else{_0x39946c[_0x1c10aa(0x1079)](_0x2f1085);if(!_0x51c64f[_0x1c10aa(0x10f6)]['groupId'])_0x37f055=null;}}}}),_0x5df445[_0x2797db(0x1079)](_0x39946c),_0x258b3c+=_0x30bcfd['length'],_0x5df445['querySelectorAll']('.chat-group-header:not([data-has-listener=\x22true\x22])')[_0x2797db(0x12c2)](_0x4af7d0=>{const _0x3936c5=_0x2797db;_0x4af7d0[_0x3936c5(0x1f4)]['hasListener']=_0x3936c5(0x12b7),_0x4af7d0[_0x3936c5(0xd85)](_0x3936c5(0x1122),()=>{const _0x3d11b8=_0x3936c5;_0x4af7d0[_0x3d11b8(0x11c2)][_0x3d11b8(0x1270)](_0x3d11b8(0xc4e)),_0x4af7d0[_0x3d11b8(0x56d)][_0x3d11b8(0x11c2)][_0x3d11b8(0x1270)]('collapsed');});}),_0x935422=![],_0x284aff[_0x2797db(0x94b)]<=_0x284aff[_0x2797db(0x91c)]&&_0x258b3c<_0x28eb35[_0x2797db(0x131d)]&&_0x438393();};_0x37f6b5?_0x4fc48b():(_0x4c8ce6(_0x5df445,_0x411d9d(0x151)),setTimeout(_0x4fc48b,0x1f4));}function _0x1eb370(_0x3f611d){const _0x86016c=_0x204348;try{const _0x1bb3d9=_0x3f611d[_0x86016c(0x1d5)][_0x86016c(0xaf1)](_0x2db64c=>!_0x2db64c[_0x86016c(0x7a0)])[_0x86016c(0x5b0)](-0x1)[0x0]||{};let _0x241f1a;if(!_0x3f611d[_0x86016c(0x726)]&&_0x3f611d[_0x86016c(0x569)]?.[_0x86016c(0x13b2)]===_0x86016c(0x1321))_0x241f1a=_0x86016c(0xb0a)+(_0x3f611d[_0x86016c(0x569)][_0x86016c(0x666)]||'请求添加你为好友')+_0x86016c(0xf82);else{if(!_0x3f611d[_0x86016c(0x726)]&&_0x3f611d[_0x86016c(0x569)]?.[_0x86016c(0x13b2)]===_0x86016c(0x12b0))_0x241f1a=_0x86016c(0x79c);else{if(_0x3f611d[_0x86016c(0x726)]){if(_0x1bb3d9[_0x86016c(0x259)]===_0x86016c(0x3bf))_0x241f1a=_0x86016c(0xd5c)+_0x1bb3d9[_0x86016c(0x1316)];else{if(_0x1bb3d9[_0x86016c(0x259)]===_0x86016c(0xf4e))_0x241f1a=_0x86016c(0xbe5);else{if(_0x1bb3d9['type']==='ai_image'||_0x1bb3d9[_0x86016c(0x259)]===_0x86016c(0x305))_0x241f1a='[照片]';else{if(_0x1bb3d9[_0x86016c(0x259)]===_0x86016c(0xefa))_0x241f1a=_0x86016c(0x8a0);else{if(typeof _0x1bb3d9['content']===_0x86016c(0x861)&&_0x30c9b4[_0x86016c(0x9c0)](_0x1bb3d9['content']))_0x241f1a=_0x1bb3d9['meaning']?_0x86016c(0x21f)+_0x1bb3d9['meaning']+']':_0x86016c(0x131);else Array[_0x86016c(0x971)](_0x1bb3d9[_0x86016c(0x1316)])?_0x241f1a=_0x86016c(0xf72):_0x241f1a=String(_0x1bb3d9[_0x86016c(0x1316)]||_0x86016c(0x10a0))[_0x86016c(0xa6d)](0x0,0x14);}}}}if(_0x1bb3d9[_0x86016c(0x2a3)]&&_0x1bb3d9['type']!=='pat_message'){const _0x2e96e0=_0x32d364(_0x3f611d,_0x1bb3d9['senderName']);_0x241f1a=_0x2e96e0+':\x20'+_0x241f1a;}}else{const _0x4ce446=_0x3f611d[_0x86016c(0x13b2)]?.[_0x86016c(0xdd5)]||'在线';_0x241f1a='['+_0x4ce446+']';}}}const _0x10ce0d=document[_0x86016c(0xe7d)](_0x86016c(0x1323));_0x10ce0d[_0x86016c(0x69b)]=_0x86016c(0xeee),_0x10ce0d[_0x86016c(0x1f4)][_0x86016c(0xfca)]=_0x3f611d['id'];_0x3f611d[_0x86016c(0x858)]&&_0x10ce0d[_0x86016c(0x11c2)][_0x86016c(0xa58)](_0x86016c(0x1378));const _0x470c32=_0x3f611d[_0x86016c(0x726)]?_0x3f611d[_0x86016c(0xda2)][_0x86016c(0xaf7)]:_0x3f611d[_0x86016c(0xda2)][_0x86016c(0x9c7)],_0x1d444f=_0x3f611d['isGroup']?'':_0x3f611d[_0x86016c(0xda2)]['aiAvatarFrame']||'';let _0x227847;_0x1d444f?_0x227847=_0x86016c(0x64c)+(_0x470c32||_0x4fd084)+_0x86016c(0x176)+_0x1d444f+_0x86016c(0x3d0):_0x227847=_0x86016c(0xfa9)+(_0x470c32||_0x4fd084)+'\x22\x20class=\x22avatar\x22>';const _0x2e1a3b=_0x1d444f?'has-frame':'',_0x48c2e8=_0x86016c(0xdad)+_0x2e1a3b+'\x22>'+_0x227847+_0x86016c(0xb44);_0x10ce0d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x48c2e8+_0x86016c(0xb94)+_0x3f611d[_0x86016c(0x132a)]+_0x86016c(0x143a)+(_0x3f611d[_0x86016c(0x726)]?_0x86016c(0xcda):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20'+(_0x3f611d[_0x86016c(0x726)]?_0x86016c(0x157):_0x86016c(0x431))+_0x86016c(0x674)+_0x241f1a+_0x86016c(0x766);const _0x3eb7cb=_0x3f611d[_0x86016c(0x12c9)]||0x0,_0x461f1e=_0x10ce0d[_0x86016c(0x586)](_0x86016c(0x6de));_0x3eb7cb>0x0?(_0x461f1e['textContent']=_0x3eb7cb>0x63?_0x86016c(0x13cb):_0x3eb7cb,_0x461f1e[_0x86016c(0x1104)][_0x86016c(0x4db)]=_0x86016c(0x908)):_0x461f1e[_0x86016c(0x1104)][_0x86016c(0x4db)]=_0x86016c(0x464);const _0xc6979c=_0x10ce0d['querySelector'](_0x86016c(0xe27));_0xc6979c&&(_0xc6979c[_0x86016c(0x1104)][_0x86016c(0x9f4)]=_0x86016c(0xa6b),_0xc6979c[_0x86016c(0xd85)](_0x86016c(0x1402),_0x2f7e96=>{const _0x2f8e01=_0x86016c;_0x2f7e96[_0x2f8e01(0x58e)]();const _0x119513=_0x3f611d[_0x2f8e01(0x726)]?_0x3f611d[_0x2f8e01(0x132a)]:_0x3f611d['originalName'];_0x2ed67a(_0x3f611d['id'],_0x119513);}));const _0x13f660=_0x10ce0d[_0x86016c(0x586)]('.info');return _0x13f660&&_0x13f660[_0x86016c(0xd85)](_0x86016c(0x1122),()=>_0x31c384(_0x3f611d['id'])),_0x4376d8(_0x10ce0d,async _0x20c9a5=>{const _0xd93ce=_0x86016c,_0x4b40c0=await _0x537098(_0x3f611d);switch(_0x4b40c0){case _0xd93ce(0xc61):_0x3f611d[_0xd93ce(0x858)]=!_0x3f611d[_0xd93ce(0x858)],await _0x17d534[_0xd93ce(0x954)][_0xd93ce(0xf3f)](_0x3f611d),_0x27be5e();break;case _0xd93ce(0x195):const _0x388311=await _0x2532b9(_0xd93ce(0x4a1),_0xd93ce(0x135d)+_0x3f611d[_0xd93ce(0x132a)]+_0xd93ce(0x820),{'confirmButtonClass':_0xd93ce(0x4d3)});if(_0x388311){_0x59377b[_0xd93ce(0x1196)]&&_0x59377b[_0xd93ce(0x81d)]===_0x3f611d['id']&&await _0x361813(![]);delete _0x42f206[_0xd93ce(0x954)][_0x3f611d['id']];if(_0x42f206[_0xd93ce(0x81d)]===_0x3f611d['id'])_0x42f206[_0xd93ce(0x81d)]=null;await _0x17d534[_0xd93ce(0x954)][_0xd93ce(0x195)](_0x3f611d['id']),_0x27be5e();}break;default:break;}}),_0x10ce0d;}catch(_0x5bae03){return console[_0x86016c(0xb61)](_0x86016c(0x1174)+(_0x3f611d[_0x86016c(0x132a)]||'未知')+']\x20(ID:\x20'+_0x3f611d['id']+_0x86016c(0xb4d),_0x5bae03),null;}}async function _0x359c96(_0x7b9cd9){const _0x337fb0=_0x204348;_0x5d289b(),_0x34dfd6();const _0xebc1e4=_0x42f206['chats'][_0x7b9cd9];if(!_0xebc1e4)return;_0x5bc130();const _0x593f2e=document['getElementById'](_0x337fb0(0x13a0)),_0x32e0ea=document[_0x337fb0(0x458)](_0x337fb0(0x1404)),_0x5c656c=document[_0x337fb0(0x458)](_0x337fb0(0x27c)),_0x52fecc=document[_0x337fb0(0x458)](_0x337fb0(0x57e));_0x593f2e[_0x337fb0(0x1f4)][_0x337fb0(0xbdc)]=_0xebc1e4['settings'][_0x337fb0(0xbdc)]||'default';const _0x16af23=_0xebc1e4[_0x337fb0(0xda2)][_0x337fb0(0xecd)]||0xd;_0x593f2e['style'][_0x337fb0(0x5c0)]('--chat-font-size',_0x16af23+'px'),_0x1ff070(_0xebc1e4[_0x337fb0(0xda2)][_0x337fb0(0x7df)]||'',_0x337fb0(0xf66),_0x337fb0(0x1052)),document[_0x337fb0(0x458)](_0x337fb0(0xca6))['textContent']=_0xebc1e4[_0x337fb0(0x132a)];const _0x5650a7=document[_0x337fb0(0x458)](_0x337fb0(0x1250)),_0xf888f7=_0x5650a7[_0x337fb0(0x586)](_0x337fb0(0xae1));_0xebc1e4[_0x337fb0(0x726)]?(_0x5650a7[_0x337fb0(0x1104)][_0x337fb0(0x4db)]=_0x337fb0(0x464),document['getElementById']('chat-header-title-wrapper')[_0x337fb0(0x1104)][_0x337fb0(0xc25)]=_0x337fb0(0x1f3)):(_0x5650a7[_0x337fb0(0x1104)][_0x337fb0(0x4db)]=_0x337fb0(0x82b),document[_0x337fb0(0x458)](_0x337fb0(0x31b))[_0x337fb0(0x1104)]['justifyContent']=_0x337fb0(0x143c),_0xf888f7[_0x337fb0(0x1a2)]=_0xebc1e4[_0x337fb0(0x13b2)]?.[_0x337fb0(0xdd5)]||'在线',_0x5650a7[_0x337fb0(0x11c2)][_0x337fb0(0x1270)]('busy',_0xebc1e4[_0x337fb0(0x13b2)]?.[_0x337fb0(0x91b)]||![]));const _0x4723cc=document[_0x337fb0(0x458)](_0x337fb0(0xd99)),_0xa56f4c=_0xebc1e4['settings'][_0x337fb0(0x13ed)],_0x3e8e65=_0x42f206[_0x337fb0(0xf0)][_0x337fb0(0x203)],_0x24a071=document[_0x337fb0(0x458)](_0x337fb0(0xb3e))['classList'][_0x337fb0(0x526)](_0x337fb0(0x466)),_0x517655=_0x24a071?'#000000':_0x337fb0(0xe14);if(_0xa56f4c)_0x4723cc[_0x337fb0(0x1104)]['backgroundImage']=_0x337fb0(0xfa)+_0xa56f4c+')',_0x4723cc[_0x337fb0(0x1104)][_0x337fb0(0x11d7)]=_0x337fb0(0x11b5);else _0x3e8e65?(_0x4723cc[_0x337fb0(0x1104)][_0x337fb0(0xf7)]=_0x337fb0(0xfa)+_0x3e8e65+')',_0x4723cc[_0x337fb0(0x1104)][_0x337fb0(0x11d7)]=_0x337fb0(0x11b5)):(_0x4723cc['style'][_0x337fb0(0xf7)]=_0x337fb0(0x464),_0x4723cc['style'][_0x337fb0(0x11d7)]=_0x517655);if(_0xebc1e4[_0x337fb0(0xe3f)])_0x32e0ea['style'][_0x337fb0(0x4db)]='none',_0x5c656c[_0x337fb0(0x1104)]['display']=_0x337fb0(0x82b),_0x52fecc[_0x337fb0(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x337fb0(0x458)](_0x337fb0(0xf03))['onclick']=_0xef2b3f;else{_0x32e0ea[_0x337fb0(0x1104)][_0x337fb0(0x4db)]=_0x337fb0(0x82b),_0x5c656c[_0x337fb0(0x1104)]['display']=_0x337fb0(0x464),_0x52fecc[_0x337fb0(0x110d)]='';if(!_0xebc1e4['isGroup']&&_0xebc1e4[_0x337fb0(0x569)][_0x337fb0(0x13b2)]!=='friend'){_0x5c656c[_0x337fb0(0x1104)][_0x337fb0(0x4db)]=_0x337fb0(0x82b),_0x32e0ea[_0x337fb0(0x1104)][_0x337fb0(0x9d1)]=_0x337fb0(0x535);let _0x185c48='';switch(_0xebc1e4[_0x337fb0(0x569)]['status']){case _0x337fb0(0x12e4):const _0x5e23c1=_0x5af2e0!==null,_0x276fbe=_0xebc1e4[_0x337fb0(0x569)][_0x337fb0(0x1230)],_0x27c8da=_0x42f206[_0x337fb0(0xf0)][_0x337fb0(0x121b)]||0x1,_0x21123b=_0x27c8da*0x3c*0x3c*0x3e8,_0x3b7754=Date[_0x337fb0(0x606)]()-_0x276fbe,_0x4d06c7=_0x3b7754>_0x21123b,_0xd305b1=Math[_0x337fb0(0x538)](0x0,Math[_0x337fb0(0xec8)]((_0x21123b-_0x3b7754)/(0x3e8*0x3c)));_0x185c48=_0x337fb0(0x7c6)+_0xebc1e4[_0x337fb0(0x132a)]+_0x337fb0(0x100)+(_0x42f206[_0x337fb0(0xf0)][_0x337fb0(0x12cd)]?_0x337fb0(0xe18):_0x337fb0(0xab4))+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20'+(_0x5e23c1?_0x337fb0(0x753):_0x337fb0(0xbe3))+_0x337fb0(0x12ae)+_0xebc1e4['relationship'][_0x337fb0(0x13b2)]+_0x337fb0(0x533)+_0x27c8da+_0x337fb0(0x470)+(_0x4d06c7?_0x337fb0(0x825):_0x337fb0(0xe88)+_0xd305b1+_0x337fb0(0xe9a))+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20'+(_0x4d06c7&&_0x42f206[_0x337fb0(0xf0)][_0x337fb0(0x12cd)]?_0x337fb0(0x10ca):_0x337fb0(0x54d))+_0x337fb0(0x1df);break;case _0x337fb0(0x12b0):_0x185c48=_0x337fb0(0x990);break;case'pending_user_approval':_0x185c48=_0x337fb0(0x113c)+_0xebc1e4[_0x337fb0(0x132a)]+'”请求添加你为好友：<br><i>“'+_0xebc1e4[_0x337fb0(0x569)]['applicationReason']+_0x337fb0(0xadb);break;case _0x337fb0(0x11f8):_0x185c48=_0x337fb0(0x13b9);break;}_0x52fecc[_0x337fb0(0x110d)]=_0x185c48;}else _0x5c656c[_0x337fb0(0x1104)][_0x337fb0(0x4db)]=_0x337fb0(0x464),_0x32e0ea[_0x337fb0(0x1104)][_0x337fb0(0x9d1)]='visible';}_0x593f2e[_0x337fb0(0x110d)]='';const _0x311b35=_0xebc1e4[_0x337fb0(0x1d5)];_0x36c81d=0x0;const _0x581869=_0x42f206[_0x337fb0(0xf0)][_0x337fb0(0x1365)]||0x32,_0x44838f=_0x311b35[_0x337fb0(0x5b0)](-_0x581869),_0x2c801a=[];let _0x29d2d1=0x0;for(const _0x127844 of _0x44838f){_0x29d2d1>0x0&&_0x127844['timestamp']-_0x29d2d1>0x927c0&&_0x2c801a['push'](Promise[_0x337fb0(0x992)](_0x2a60ff(_0x127844[_0x337fb0(0xf16)]))),_0x2c801a[_0x337fb0(0x129e)](_0x4b8ea5(_0x127844,_0xebc1e4,!![])),_0x29d2d1=_0x127844['timestamp'];}const _0xaa991b=await Promise['all'](_0x2c801a),_0x2bf1a9=document[_0x337fb0(0xdb7)]();_0xaa991b[_0x337fb0(0xaf1)](Boolean)[_0x337fb0(0x12c2)](_0x98535c=>_0x2bf1a9['appendChild'](_0x98535c)),_0x593f2e['appendChild'](_0x2bf1a9),_0x36c81d=_0x44838f[_0x337fb0(0x131d)];const _0x3223d4=document[_0x337fb0(0xe7d)]('div');_0x3223d4['id']='typing-indicator',_0x3223d4[_0x337fb0(0x1104)][_0x337fb0(0x4db)]='none',_0x3223d4[_0x337fb0(0x1a2)]=_0x337fb0(0xdc3),_0x593f2e[_0x337fb0(0x1079)](_0x3223d4),setTimeout(()=>_0x593f2e[_0x337fb0(0x358)]=_0x593f2e[_0x337fb0(0x94b)],0x0);}async function _0x2a9557(){const _0x514394=_0x204348;if(_0x27b4ae)return;_0x27b4ae=!![];const _0x50cb32=document[_0x514394(0x458)](_0x514394(0x13a0)),_0x498750=_0x42f206['chats'][_0x42f206[_0x514394(0x81d)]];if(!_0x498750){_0x27b4ae=![];return;}_0x4c8ce6(_0x50cb32,_0x514394(0x76f));const _0x2eef05=_0x50cb32[_0x514394(0x94b)];await new Promise(_0x562f57=>setTimeout(_0x562f57,0x1f4));const _0x236a16=_0x498750[_0x514394(0x1d5)][_0x514394(0x131d)],_0x19c5c4=_0x42f206['globalSettings'][_0x514394(0x1365)]||0x32,_0x4f348f=_0x236a16-_0x36c81d-_0x19c5c4,_0x1dd8c7=_0x236a16-_0x36c81d,_0x3b960d=_0x498750[_0x514394(0x1d5)][_0x514394(0x5b0)](Math[_0x514394(0x538)](0x0,_0x4f348f),_0x1dd8c7),_0x357d12=_0x50cb32[_0x514394(0x586)](_0x514394(0x2e7));let _0x18971f=_0x357d12?parseInt(_0x357d12['dataset']['timestamp']):0x0;for(const _0x15a5bf of _0x3b960d[_0x514394(0x115b)]()){if(_0x18971f>0x0&&_0x18971f-_0x15a5bf[_0x514394(0xf16)]>0x927c0){const _0x4bf72b=_0x2a60ff(_0x18971f);_0x50cb32[_0x514394(0x13e2)](_0x4bf72b);}await _0x409916(_0x15a5bf,_0x498750),_0x18971f=_0x15a5bf[_0x514394(0xf16)];}_0x36c81d+=_0x3b960d[_0x514394(0x131d)];const _0x1cbd94=_0x50cb32[_0x514394(0x94b)];_0x50cb32[_0x514394(0x358)]=_0x1cbd94-_0x2eef05,_0x17adee(_0x50cb32),_0x27b4ae=![];}function _0x3b3899(){const _0x1c37d6=_0x204348;_0x220a78(),_0x1a2e2f();const _0x383095=document[_0x1c37d6(0x458)]('wallpaper-preview'),_0x24aed4=_0x42f206[_0x1c37d6(0xf0)][_0x1c37d6(0xef2)];_0x24aed4?(_0x383095[_0x1c37d6(0x1104)][_0x1c37d6(0xf7)]=_0x1c37d6(0xfa)+_0x24aed4+')',_0x383095[_0x1c37d6(0x1a2)]=''):(_0x383095['style'][_0x1c37d6(0xf7)]=_0x1c37d6(0xf6d),_0x383095[_0x1c37d6(0x1a2)]=_0x1c37d6(0xd03));const _0x7c8db1=document[_0x1c37d6(0x458)]('cphone-wallpaper-preview'),_0x3f8e38=_0x42f206['globalSettings'][_0x1c37d6(0x3bc)];_0x3f8e38?(_0x7c8db1[_0x1c37d6(0x1104)][_0x1c37d6(0xf7)]='url('+_0x3f8e38+')',_0x7c8db1[_0x1c37d6(0x1a2)]=''):(_0x7c8db1[_0x1c37d6(0x1104)]['backgroundImage']=_0x1c37d6(0x58f),_0x7c8db1[_0x1c37d6(0x1a2)]=_0x1c37d6(0xd03));const _0x35b299=document[_0x1c37d6(0x458)]('global-bg-preview'),_0x4d6ded=_0x42f206[_0x1c37d6(0xf0)][_0x1c37d6(0x203)];_0x4d6ded?(_0x35b299[_0x1c37d6(0x1104)]['backgroundImage']=_0x1c37d6(0xfa)+_0x4d6ded+')',_0x35b299['textContent']='',document[_0x1c37d6(0x458)](_0x1c37d6(0xadf))[_0x1c37d6(0x1104)]['display']='inline-block'):(_0x35b299['style']['backgroundImage']='none',_0x35b299[_0x1c37d6(0x1a2)]=_0x1c37d6(0xe93),document[_0x1c37d6(0x458)](_0x1c37d6(0xadf))[_0x1c37d6(0x1104)]['display']=_0x1c37d6(0x464)),_0x9b9a8f(),_0x4911ff(),document[_0x1c37d6(0x458)](_0x1c37d6(0xb1d))[_0x1c37d6(0x8dd)]=_0x42f206[_0x1c37d6(0xf0)][_0x1c37d6(0x2d5)]||'',document[_0x1c37d6(0x458)]('notification-sound-url-input')['value']=_0x42f206['globalSettings'][_0x1c37d6(0xee7)]||'',document[_0x1c37d6(0x458)](_0x1c37d6(0x217))[_0x1c37d6(0x8f7)]=_0x42f206['globalSettings']['showStatusBar']||![],_0x386f12(),_0x442768();}window['renderWallpaperScreenProxy']=_0x3b3899;function _0x3f8328(){const _0x5fdc0f=_0x204348,_0x572791=document[_0x5fdc0f(0x458)](_0x5fdc0f(0x838)),_0x35fd60=_0x42f206[_0x5fdc0f(0xf0)][_0x5fdc0f(0xef2)];_0x35fd60?_0x572791[_0x5fdc0f(0x1104)][_0x5fdc0f(0xf7)]=_0x5fdc0f(0xfa)+_0x35fd60+')':_0x572791['style'][_0x5fdc0f(0xf7)]=_0x5fdc0f(0xf6d);}function _0x30416a(_0xcc0289){const _0x42a74e=_0x204348;document[_0x42a74e(0x102a)]('.world-book-tab')[_0x42a74e(0x12c2)](_0x16d626=>{const _0x1ef682=_0x42a74e;_0x16d626['classList'][_0x1ef682(0x1270)]('active',_0x16d626[_0x1ef682(0x1f4)][_0x1ef682(0x5f7)]===_0xcc0289);}),document[_0x42a74e(0x102a)]('.world-book-category-pane')[_0x42a74e(0x12c2)](_0x3c4fb8=>{const _0x1b7ee2=_0x42a74e;_0x3c4fb8[_0x1b7ee2(0x11c2)][_0x1b7ee2(0x1270)](_0x1b7ee2(0xfe1),_0x3c4fb8[_0x1b7ee2(0x1f4)][_0x1b7ee2(0x5f7)]===_0xcc0289);});}async function _0x1e4af5(){const _0x247265=_0x204348,_0x54fd45=document[_0x247265(0x458)](_0x247265(0x722)),_0x1aeace=document[_0x247265(0x458)](_0x247265(0x17c));_0x54fd45[_0x247265(0x110d)]='',_0x1aeace['innerHTML']='';const [_0x2d31b2,_0x1d21c9]=await Promise[_0x247265(0xfe2)]([_0x17d534[_0x247265(0xab7)][_0x247265(0x511)](),_0x17d534[_0x247265(0x110b)][_0x247265(0x50b)]('name')[_0x247265(0x511)]()]);_0x42f206['worldBooks']=_0x2d31b2;if(_0x2d31b2[_0x247265(0x131d)]===0x0){_0x1aeace[_0x247265(0x110d)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>';return;}const _0x457a74=document[_0x247265(0xe7d)]('button');_0x457a74['className']=_0x247265(0x11a3),_0x457a74[_0x247265(0x1a2)]='全部',_0x457a74[_0x247265(0x1f4)]['categoryId']=_0x247265(0xfe2),_0x54fd45[_0x247265(0x1079)](_0x457a74);const _0x2baeef=document[_0x247265(0xe7d)](_0x247265(0x1323));_0x2baeef[_0x247265(0x69b)]=_0x247265(0x687),_0x2baeef[_0x247265(0x1f4)][_0x247265(0x5f7)]=_0x247265(0xfe2),_0x1aeace[_0x247265(0x1079)](_0x2baeef),_0x1d21c9['forEach'](_0x53b9bb=>{const _0x3f8a6a=_0x247265,_0x3ac1d4=document[_0x3f8a6a(0xe7d)](_0x3f8a6a(0x986));_0x3ac1d4[_0x3f8a6a(0x69b)]=_0x3f8a6a(0x4a5),_0x3ac1d4[_0x3f8a6a(0x1a2)]=_0x53b9bb[_0x3f8a6a(0x132a)],_0x3ac1d4[_0x3f8a6a(0x1f4)][_0x3f8a6a(0x5f7)]=String(_0x53b9bb['id']),_0x54fd45['appendChild'](_0x3ac1d4);const _0x363001=document['createElement']('div');_0x363001[_0x3f8a6a(0x69b)]=_0x3f8a6a(0xad),_0x363001[_0x3f8a6a(0x1f4)]['categoryId']=String(_0x53b9bb['id']),_0x1aeace[_0x3f8a6a(0x1079)](_0x363001);});const _0xcd3438=_0x2d31b2['some'](_0x69029e=>!_0x69029e[_0x247265(0x5f7)]);if(_0xcd3438){const _0x1295c7=document[_0x247265(0xe7d)](_0x247265(0x986));_0x1295c7['className']='world-book-tab',_0x1295c7[_0x247265(0x1a2)]='未分类',_0x1295c7['dataset'][_0x247265(0x5f7)]=_0x247265(0xbff),_0x54fd45[_0x247265(0x1079)](_0x1295c7);const _0xf55529=document[_0x247265(0xe7d)](_0x247265(0x1323));_0xf55529['className']=_0x247265(0xad),_0xf55529[_0x247265(0x1f4)][_0x247265(0x5f7)]=_0x247265(0xbff),_0x1aeace[_0x247265(0x1079)](_0xf55529);}_0x2d31b2[_0x247265(0x12c2)](_0x23893d=>{const _0x1e6788=_0x247265;let _0x348d5e=_0x1e6788(0xe3d);if(Array['isArray'](_0x23893d[_0x1e6788(0x1316)])&&_0x23893d['content'][_0x1e6788(0x131d)]>0x0){const _0x4b21a9=_0x23893d[_0x1e6788(0x1316)][0x0];_0x348d5e=_0x4b21a9[_0x1e6788(0xcb4)]||_0x4b21a9[_0x1e6788(0x1316)]||'';}else typeof _0x23893d['content']==='string'&&_0x23893d[_0x1e6788(0x1316)][_0x1e6788(0x2aa)]()!==''&&(_0x348d5e=_0x23893d[_0x1e6788(0x1316)]);const _0x58ea23=document['createElement']('div');_0x58ea23[_0x1e6788(0x69b)]=_0x1e6788(0x104a),_0x58ea23[_0x1e6788(0x110d)]=_0x1e6788(0xb4c)+_0x23893d['name']+_0x1e6788(0x5de)+_0x348d5e+_0x1e6788(0xab2);const _0x16fb85=()=>_0x35b28c(_0x23893d['id']),_0x23e471=async()=>{const _0x28569c=_0x1e6788,_0x375e53=await _0x2532b9(_0x28569c(0x1304),_0x28569c(0x1040)+_0x23893d[_0x28569c(0x132a)]+'》吗？',{'confirmButtonClass':_0x28569c(0x4d3)});_0x375e53&&(await _0x17d534[_0x28569c(0xab7)][_0x28569c(0x195)](_0x23893d['id']),_0x42f206[_0x28569c(0xab7)]=_0x42f206[_0x28569c(0xab7)][_0x28569c(0xaf1)](_0x1b8b4a=>_0x1b8b4a['id']!==_0x23893d['id']),_0x1e4af5());};_0x58ea23[_0x1e6788(0xd85)](_0x1e6788(0x1122),_0x16fb85),_0x4376d8(_0x58ea23,_0x23e471);const _0x57ff9f=_0x58ea23[_0x1e6788(0x350)](!![]);_0x57ff9f[_0x1e6788(0xd85)](_0x1e6788(0x1122),_0x16fb85),_0x4376d8(_0x57ff9f,_0x23e471),_0x2baeef[_0x1e6788(0x1079)](_0x57ff9f);const _0x24354e=_0x23893d[_0x1e6788(0x5f7)]?String(_0x23893d[_0x1e6788(0x5f7)]):_0x1e6788(0xbff),_0x266f61=_0x1aeace[_0x1e6788(0x586)](_0x1e6788(0x85a)+_0x24354e+'\x22]');_0x266f61&&_0x266f61[_0x1e6788(0x1079)](_0x58ea23);}),document[_0x247265(0x102a)]('.world-book-tab')[_0x247265(0x12c2)](_0x2ff6b5=>{const _0x1f0efe=_0x247265;_0x2ff6b5[_0x1f0efe(0xd85)](_0x1f0efe(0x1122),()=>_0x30416a(_0x2ff6b5[_0x1f0efe(0x1f4)][_0x1f0efe(0x5f7)]));});}function _0x3c273f(_0x57e051,_0x4abfe0){const _0x283e48=_0x204348,_0x3f4c2c=document[_0x283e48(0xe7d)](_0x283e48(0x1323));_0x3f4c2c[_0x283e48(0x69b)]=_0x283e48(0x98c),_0x3f4c2c['innerHTML']=_0x283e48(0x486)+_0x57e051+_0x283e48(0x1171);const _0x10bb10=_0x3f4c2c['querySelector'](_0x283e48(0x226));return _0x4abfe0[_0x283e48(0xc12)]((_0x283496,_0x4f13d5)=>_0x283496[_0x283e48(0x132a)][_0x283e48(0x667)](_0x4f13d5[_0x283e48(0x132a)],_0x283e48(0xaa2))),_0x4abfe0[_0x283e48(0x12c2)](_0x307b4a=>{const _0x1f1fe8=_0x283e48;let _0x373efc=_0x1f1fe8(0xe3d);if(Array['isArray'](_0x307b4a[_0x1f1fe8(0x1316)])&&_0x307b4a[_0x1f1fe8(0x1316)]['length']>0x0){const _0x3d0202=_0x307b4a[_0x1f1fe8(0x1316)][0x0];_0x373efc=_0x3d0202[_0x1f1fe8(0xcb4)]||_0x3d0202[_0x1f1fe8(0x1316)]||'';}else typeof _0x307b4a[_0x1f1fe8(0x1316)]===_0x1f1fe8(0x861)&&_0x307b4a[_0x1f1fe8(0x1316)]['trim']()!==''&&(_0x373efc=_0x307b4a[_0x1f1fe8(0x1316)]);const _0x1e3e3b=document[_0x1f1fe8(0xe7d)](_0x1f1fe8(0x1323));_0x1e3e3b[_0x1f1fe8(0x69b)]=_0x1f1fe8(0xf3d),_0x1e3e3b['dataset']['bookId']=_0x307b4a['id'],_0x1e3e3b['innerHTML']=_0x1f1fe8(0x82e)+_0x307b4a[_0x1f1fe8(0x132a)]+_0x1f1fe8(0xcbc)+String(_0x373efc)[_0x1f1fe8(0xa6d)](0x0,0x32)+_0x1f1fe8(0xab2),_0x1e3e3b[_0x1f1fe8(0xd85)](_0x1f1fe8(0x1122),()=>_0x35b28c(_0x307b4a['id'])),_0x4376d8(_0x1e3e3b,async()=>{const _0x5d31ae=_0x1f1fe8,_0xc287b1=await _0x2532b9(_0x5d31ae(0x1304),_0x5d31ae(0x1040)+_0x307b4a['name']+_0x5d31ae(0x1cf),{'confirmButtonClass':_0x5d31ae(0x4d3)});_0xc287b1&&(await _0x17d534[_0x5d31ae(0xab7)][_0x5d31ae(0x195)](_0x307b4a['id']),_0x42f206[_0x5d31ae(0xab7)]=_0x42f206[_0x5d31ae(0xab7)][_0x5d31ae(0xaf1)](_0x19b121=>_0x19b121['id']!==_0x307b4a['id']),_0x1e4af5());}),_0x10bb10[_0x1f1fe8(0x1079)](_0x1e3e3b);}),_0x3f4c2c;}window['renderWorldBookScreenProxy']=_0x1e4af5;async function _0x35b28c(_0x3dbd50){const _0x427061=_0x204348;_0x589d88('world-book-editor-screen'),_0x35398a=_0x3dbd50;const [_0x3b7316,_0xf6b263]=await Promise['all']([_0x17d534[_0x427061(0xab7)][_0x427061(0x36d)](_0x3dbd50),_0x17d534[_0x427061(0x110b)][_0x427061(0x511)]()]);if(!_0x3b7316){console[_0x427061(0xb61)](_0x427061(0x2bd),_0x3dbd50),_0x589d88(_0x427061(0x7d));return;}document['getElementById'](_0x427061(0xf23))[_0x427061(0x1a2)]=_0x3b7316['name'],document[_0x427061(0x458)](_0x427061(0xfc7))[_0x427061(0x8dd)]=_0x3b7316[_0x427061(0x132a)];const _0x4b3e63=document['getElementById'](_0x427061(0xd17));_0x4b3e63['innerHTML']=_0x427061(0x4c9),_0xf6b263[_0x427061(0x12c2)](_0x429f5c=>{const _0x2df713=_0x427061,_0x20e6a4=document[_0x2df713(0xe7d)]('option');_0x20e6a4[_0x2df713(0x8dd)]=_0x429f5c['id'],_0x20e6a4['textContent']=_0x429f5c[_0x2df713(0x132a)];if(_0x3b7316[_0x2df713(0x5f7)]===_0x429f5c['id'])_0x20e6a4[_0x2df713(0x500)]=!![];_0x4b3e63[_0x2df713(0x1079)](_0x20e6a4);});const _0x5d21e8=document[_0x427061(0x458)](_0x427061(0x1424));_0x5d21e8['innerHTML']='',Array[_0x427061(0x971)](_0x3b7316[_0x427061(0x1316)])&&_0x3b7316['content'][_0x427061(0x131d)]>0x0?_0x3b7316[_0x427061(0x1316)]['forEach'](_0x58291a=>{const _0x43e140=_0x427061,_0x2fdcba=_0x3a75d2(_0x58291a);_0x5d21e8[_0x43e140(0x1079)](_0x2fdcba);}):_0x5d21e8[_0x427061(0x110d)]=_0x427061(0xd29);}async function _0x410b06(_0x31fc34=!![]){const _0x45d9c9=_0x204348,_0x5d985c=document[_0x45d9c9(0x458)](_0x45d9c9(0x141d)),_0x2fc25e=document[_0x45d9c9(0x458)]('sticker-category-tabs'),_0x181142=document[_0x45d9c9(0x458)](_0x45d9c9(0xc1b)),_0x351160=_0x181142[_0x45d9c9(0x8dd)][_0x45d9c9(0x2aa)]()['toLowerCase']();if(_0x31fc34){_0x2fc25e[_0x45d9c9(0x110d)]='';const _0x559d20=await _0x17d534[_0x45d9c9(0x140b)]['toArray']();_0x2fc25e[_0x45d9c9(0x110d)]+=_0x45d9c9(0x7ec)+(_0x414f54===_0x45d9c9(0xfe2)?_0x45d9c9(0xfe1):'')+_0x45d9c9(0x1a7),_0x559d20['forEach'](_0x20e432=>{const _0x49dc37=_0x45d9c9;_0x2fc25e[_0x49dc37(0x110d)]+=_0x49dc37(0x7ec)+(_0x414f54===_0x20e432['id']?_0x49dc37(0xfe1):'')+_0x49dc37(0x31f)+_0x20e432['id']+'\x22>'+_0x20e432[_0x49dc37(0x132a)]+_0x49dc37(0xcb3);}),_0x2fc25e[_0x45d9c9(0x110d)]+=_0x45d9c9(0x7ec)+(_0x414f54===_0x45d9c9(0xbff)?_0x45d9c9(0xfe1):'')+_0x45d9c9(0x914);}_0x5d985c[_0x45d9c9(0x110d)]='';let _0x4b4a79;if(_0x414f54==='all')_0x4b4a79=_0x42f206[_0x45d9c9(0x1294)];else _0x414f54===_0x45d9c9(0xbff)?_0x4b4a79=_0x42f206[_0x45d9c9(0x1294)][_0x45d9c9(0xaf1)](_0x4cde21=>!_0x4cde21[_0x45d9c9(0x5f7)]):_0x4b4a79=_0x42f206[_0x45d9c9(0x1294)]['filter'](_0xce3c38=>_0xce3c38['categoryId']===_0x414f54);const _0xe064e4=_0x351160?_0x4b4a79[_0x45d9c9(0xaf1)](_0x548aaf=>_0x548aaf[_0x45d9c9(0x132a)][_0x45d9c9(0xb15)]()[_0x45d9c9(0xd8d)](_0x351160)):_0x4b4a79;if(_0xe064e4[_0x45d9c9(0x131d)]===0x0){const _0x2153c2=_0x351160?_0x45d9c9(0x90f):'这个分类下还没有表情哦~';_0x5d985c[_0x45d9c9(0x110d)]=_0x45d9c9(0xcf0)+_0x2153c2+_0x45d9c9(0xd36);return;}_0xe064e4[_0x45d9c9(0x12c2)](_0x3f6e03=>{const _0x5b73fb=_0x45d9c9,_0x561017=document['createElement'](_0x5b73fb(0x1323));_0x561017[_0x5b73fb(0x69b)]='sticker-item',_0x561017[_0x5b73fb(0x316)]=_0x3f6e03[_0x5b73fb(0x132a)],_0x561017['dataset']['stickerId']=_0x3f6e03['id'],_0x561017[_0x5b73fb(0x110d)]=_0x5b73fb(0xe29)+_0x3f6e03[_0x5b73fb(0x1377)]+_0x5b73fb(0x554)+_0x3f6e03[_0x5b73fb(0x132a)]+_0x5b73fb(0x106a),_0x561017[_0x5b73fb(0xd85)]('click',()=>{_0x122798?_0x3475a0(_0x561017):_0x5d55d6(_0x3f6e03);});const _0x1900dc=document[_0x5b73fb(0xe7d)]('div');_0x1900dc[_0x5b73fb(0x69b)]=_0x5b73fb(0x1d3),_0x1900dc['innerHTML']=_0x5b73fb(0x39a),_0x1900dc[_0x5b73fb(0xbe8)]=async _0x3b7562=>{const _0x97844b=_0x5b73fb;_0x3b7562[_0x97844b(0x58e)]();const _0x19dc3e=await _0x2532b9(_0x97844b(0x53a),_0x97844b(0xc28)+_0x3f6e03[_0x97844b(0x132a)]+_0x97844b(0x143),{'confirmButtonClass':_0x97844b(0x4d3)});_0x19dc3e&&(await _0x17d534[_0x97844b(0x1294)][_0x97844b(0x195)](_0x3f6e03['id']),_0x42f206[_0x97844b(0x1294)]=_0x42f206['userStickers'][_0x97844b(0xaf1)](_0x131b55=>_0x131b55['id']!==_0x3f6e03['id']),_0x410b06());},_0x561017['appendChild'](_0x1900dc),_0x5d985c[_0x5b73fb(0x1079)](_0x561017);});}let _0x122798=![],_0xea7182=new Set(),_0x51e922=![],_0x905915=new Set(),_0x401c8c=[],_0x597e2e=0x0;const _0x4a8451=0x2d;let _0x452dba=![];function _0xda8122(){const _0x249f72=_0x204348;_0x122798=!_0x122798;const _0x17e8da=document[_0x249f72(0x458)](_0x249f72(0x141d)),_0x54bb9e=document['getElementById'](_0x249f72(0x420)),_0x257c1f=document[_0x249f72(0x458)]('sticker-action-bar'),_0x1a691f=document[_0x249f72(0x458)](_0x249f72(0x826));_0x17e8da['classList'][_0x249f72(0x1270)](_0x249f72(0x833),_0x122798),_0x122798?(_0x54bb9e[_0x249f72(0x1a2)]='完成',_0x257c1f['style']['display']=_0x249f72(0x82b),_0xea7182['clear'](),_0x1a691f[_0x249f72(0x8f7)]=![],_0x75b995()):(_0x54bb9e[_0x249f72(0x1a2)]='管理',_0x257c1f[_0x249f72(0x1104)][_0x249f72(0x4db)]=_0x249f72(0x464),_0x17e8da['querySelectorAll'](_0x249f72(0x988))[_0x249f72(0x12c2)](_0x328010=>_0x328010[_0x249f72(0x11c2)]['remove'](_0x249f72(0x500))));}function _0x1724c0(){const _0x1f0178=_0x204348,_0x3bb9ec=document[_0x1f0178(0x458)](_0x1f0178(0x826)),_0x2cb104=_0x3bb9ec[_0x1f0178(0x8f7)];let _0x1eb3a7;if(_0x414f54===_0x1f0178(0xfe2))_0x1eb3a7=_0x42f206[_0x1f0178(0x1294)];else _0x414f54===_0x1f0178(0xbff)?_0x1eb3a7=_0x42f206[_0x1f0178(0x1294)][_0x1f0178(0xaf1)](_0x1e355d=>!_0x1e355d[_0x1f0178(0x5f7)]):_0x1eb3a7=_0x42f206[_0x1f0178(0x1294)][_0x1f0178(0xaf1)](_0x5c26bf=>_0x5c26bf['categoryId']===_0x414f54);_0x1eb3a7[_0x1f0178(0x12c2)](_0x2d1c3f=>{const _0x27e126=_0x1f0178,_0xbb1946=_0x2d1c3f['id'],_0x51c457=document[_0x27e126(0x586)]('.sticker-item[data-sticker-id=\x22'+_0xbb1946+'\x22]');if(_0x2cb104){_0xea7182[_0x27e126(0xa58)](_0xbb1946);if(_0x51c457)_0x51c457[_0x27e126(0x11c2)][_0x27e126(0xa58)]('selected');}else{_0xea7182['delete'](_0xbb1946);if(_0x51c457)_0x51c457[_0x27e126(0x11c2)][_0x27e126(0x1097)](_0x27e126(0x500));}}),_0x75b995();}function _0x75b995(){const _0x3c133e=_0x204348,_0x340c4e=document[_0x3c133e(0x458)](_0x3c133e(0x1da));_0x340c4e[_0x3c133e(0x1a2)]=_0x3c133e(0xeab)+_0xea7182[_0x3c133e(0x12a4)]+')';}function _0x3475a0(_0xce2d2c){const _0x3380a1=_0x204348;if(!_0x122798)return;const _0x8b5b27=_0xce2d2c[_0x3380a1(0x1f4)][_0x3380a1(0x5be)];if(!_0x8b5b27)return;_0xce2d2c[_0x3380a1(0x11c2)][_0x3380a1(0x1270)](_0x3380a1(0x500)),_0xea7182[_0x3380a1(0x31c)](_0x8b5b27)?_0xea7182['delete'](_0x8b5b27):_0xea7182['add'](_0x8b5b27),_0x75b995();}async function _0x5b2438(){const _0x3e3939=_0x204348;if(_0xea7182[_0x3e3939(0x12a4)]===0x0)return;const _0xf91116=await _0x2532b9(_0x3e3939(0x1ef),_0x3e3939(0x1f5)+_0xea7182[_0x3e3939(0x12a4)]+'\x20个表情吗？此操作不可恢复。',{'confirmButtonClass':_0x3e3939(0x4d3)});if(_0xf91116){const _0x43ebe8=[..._0xea7182];await _0x17d534[_0x3e3939(0x1294)][_0x3e3939(0x1315)](_0x43ebe8),_0x42f206[_0x3e3939(0x1294)]=_0x42f206[_0x3e3939(0x1294)]['filter'](_0x544781=>!_0x43ebe8[_0x3e3939(0xd8d)](_0x544781['id'])),_0xda8122(),_0x410b06(),await _0x34fce8(_0x3e3939(0xa59),_0x3e3939(0x824));}}async function _0x1ff94e(){const _0x2d2893=_0x204348,_0x17e69d='请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a',_0x989103=await _0x335e57(_0x2d2893(0x4eb),_0x17e69d,'',_0x2d2893(0xb43));_0x989103&&_0x989103['trim']()&&await _0x37e5f6(_0x989103);}async function _0x37e5f6(_0x8fd536){const _0x561fcc=_0x204348,_0x543c2d=_0x8fd536[_0x561fcc(0x2aa)]()[_0x561fcc(0x90b)]('\x0a'),_0x43d05f=[],_0x3eb3fc=_0x561fcc(0xefd);let _0x9beced=0x0;const _0x409496=_0x414f54!==_0x561fcc(0xfe2)&&_0x414f54!==_0x561fcc(0xbff)?_0x414f54:null;for(const _0x1bdf8c of _0x543c2d){const _0x2edab0=_0x1bdf8c[_0x561fcc(0x2aa)]();if(!_0x2edab0||_0x2edab0['includes']('填入'))continue;const _0x2cb588=_0x2edab0['match'](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x2cb588){const _0x465711=_0x2cb588[0x1][_0x561fcc(0x2aa)](),_0x87e810=_0x2cb588[0x2][_0x561fcc(0x2aa)]();_0x43d05f[_0x561fcc(0x129e)]({'id':_0x561fcc(0x5b7)+Date[_0x561fcc(0x606)]()+Math[_0x561fcc(0x23a)](),'name':_0x465711,'url':_0x87e810,'categoryId':_0x409496});continue;}let _0x4c8e7f=null,_0x40d974=null;const _0x19ab7f=_0x2edab0[_0x561fcc(0x41c)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x19ab7f)_0x4c8e7f=_0x19ab7f[0x1],_0x40d974=_0x19ab7f[0x2];else{const _0x12b1f2=_0x2edab0[_0x561fcc(0x90b)](/\s+/);_0x12b1f2[_0x561fcc(0x131d)]>=0x2&&(_0x40d974=_0x12b1f2[_0x561fcc(0xdd4)](),_0x4c8e7f=_0x12b1f2['join']('\x20'));}_0x4c8e7f&&_0x40d974&&_0x40d974[_0x561fcc(0xd8d)]('.')?_0x43d05f['push']({'id':_0x561fcc(0x5b7)+Date[_0x561fcc(0x606)]()+Math['random'](),'name':_0x4c8e7f,'url':_0x3eb3fc+_0x40d974,'categoryId':_0x409496}):(_0x9beced++,console[_0x561fcc(0x1b6)](_0x561fcc(0x4b3),_0x2edab0));}_0x9beced>0x0&&await _0x34fce8(_0x561fcc(0xae9),'有\x20'+_0x9beced+_0x561fcc(0xf5b));if(_0x43d05f['length']>0x0)await _0x17d534[_0x561fcc(0x1294)][_0x561fcc(0xaad)](_0x43d05f),_0x42f206[_0x561fcc(0x1294)][_0x561fcc(0x129e)](..._0x43d05f),_0x410b06(),await _0x34fce8(_0x561fcc(0xf98),_0x561fcc(0x1458)+_0x43d05f[_0x561fcc(0x131d)]+_0x561fcc(0x617));else _0x9beced===0x0&&alert('没有找到可导入的内容。请检查您粘贴的格式是否正确。');}function _0x11e348(_0x175537){const _0x511b25=_0x204348,_0x5787d6='.message-bubble[data-timestamp=\x22'+_0x175537+'\x22]',_0x2641dc=document[_0x511b25(0x586)](_0x5787d6);_0x2641dc?(_0x2641dc[_0x511b25(0x4e5)]({'behavior':_0x511b25(0x191),'block':'center'}),_0x2641dc['classList'][_0x511b25(0xa58)](_0x511b25(0x4ff)),setTimeout(()=>{const _0x2983d2=_0x511b25;document[_0x2983d2(0x5b4)][_0x2983d2(0x526)](_0x2641dc)&&_0x2641dc['classList'][_0x2983d2(0x1097)](_0x2983d2(0x4ff));},0x5dc)):alert(_0x511b25(0x46a));}async function _0x4b8ea5(_0x4e36be,_0x441432){const _0x5438ab=_0x204348;if(_0x4e36be[_0x5438ab(0x259)]===_0x5438ab(0x9dd)){const _0x529bd4=document[_0x5438ab(0xe7d)](_0x5438ab(0x1323));_0x529bd4[_0x5438ab(0x69b)]='message-wrapper\x20system-pat',_0x529bd4[_0x5438ab(0x1f4)]['timestamp']=_0x4e36be[_0x5438ab(0xf16)];const _0x16ac6b=document[_0x5438ab(0xe7d)](_0x5438ab(0x1323));return _0x16ac6b[_0x5438ab(0x69b)]='message-bubble\x20recalled-message-placeholder',_0x16ac6b[_0x5438ab(0x1f4)]['timestamp']=_0x4e36be[_0x5438ab(0xf16)],_0x16ac6b[_0x5438ab(0x1a2)]=_0x4e36be[_0x5438ab(0x1316)],_0x529bd4['appendChild'](_0x16ac6b),_0x4376d8(_0x529bd4,()=>_0x233ca6(_0x4e36be['timestamp'])),_0x529bd4[_0x5438ab(0xd85)](_0x5438ab(0x1122),()=>{_0x2b45d0&&_0x32bda0(_0x4e36be['timestamp']);}),_0x529bd4;}else{if(_0x4e36be[_0x5438ab(0x259)]===_0x5438ab(0xe12)){const _0x4f00ab=document[_0x5438ab(0xe7d)](_0x5438ab(0x1323));_0x4f00ab[_0x5438ab(0x69b)]=_0x5438ab(0x190),_0x4f00ab[_0x5438ab(0x1f4)][_0x5438ab(0xf16)]=_0x4e36be[_0x5438ab(0xf16)];const _0x4e4382=document['createElement'](_0x5438ab(0x1323));return _0x4e4382[_0x5438ab(0x69b)]=_0x5438ab(0x512),_0x4e4382['dataset'][_0x5438ab(0x13bc)]=_0x4e36be[_0x5438ab(0x13bc)],_0x4e4382[_0x5438ab(0x1a2)]=_0x4e36be[_0x5438ab(0x1316)],_0x4f00ab[_0x5438ab(0x1079)](_0x4e4382),_0x4376d8(_0x4f00ab,()=>_0x233ca6(_0x4e36be[_0x5438ab(0xf16)])),_0x4f00ab[_0x5438ab(0xd85)](_0x5438ab(0x1122),()=>{const _0x2aa960=_0x5438ab;_0x2b45d0&&_0x32bda0(_0x4e36be[_0x2aa960(0xf16)]);}),_0x4f00ab;}}if(_0x4e36be['isHidden'])return null;if(_0x4e36be[_0x5438ab(0x259)]===_0x5438ab(0x3bf)){const _0x3f2690=document[_0x5438ab(0xe7d)](_0x5438ab(0x1323));_0x3f2690['className']='message-wrapper\x20system-pat';const _0x2abd3f=document[_0x5438ab(0xe7d)]('div');return _0x2abd3f['className']=_0x5438ab(0x1a8),_0x2abd3f[_0x5438ab(0x1f4)]['timestamp']=_0x4e36be[_0x5438ab(0xf16)],_0x2abd3f[_0x5438ab(0x1a2)]=_0x4e36be['content'],_0x3f2690[_0x5438ab(0x1079)](_0x2abd3f),_0x4376d8(_0x3f2690,()=>_0x233ca6(_0x4e36be[_0x5438ab(0xf16)])),_0x3f2690[_0x5438ab(0xd85)]('click',()=>{if(_0x2b45d0)_0x32bda0(_0x4e36be['timestamp']);}),_0x3f2690;}const _0x24190f=_0x4e36be[_0x5438ab(0xaeb)]==='user',_0x1f4c13=_0x441432[_0x5438ab(0xda2)]['myNickname']||'我',_0x157227=document[_0x5438ab(0xe7d)](_0x5438ab(0x1323));_0x157227[_0x5438ab(0x69b)]=_0x5438ab(0x690)+(_0x24190f?'user':'ai');if(_0x441432['isGroup']&&!_0x24190f){const _0x822893=_0x441432['members'][_0x5438ab(0xb07)](_0x2333af=>_0x2333af[_0x5438ab(0xa1)]===_0x4e36be[_0x5438ab(0x2a3)]),_0x4c5f5c=document[_0x5438ab(0xe7d)]('div');_0x4c5f5c['className']=_0x5438ab(0x142e),_0x4c5f5c[_0x5438ab(0x1a2)]=_0x822893?_0x822893[_0x5438ab(0x1118)]:_0x4e36be[_0x5438ab(0x2a3)]||_0x5438ab(0x1429),_0x157227[_0x5438ab(0x1079)](_0x4c5f5c);}const _0x1f8947=document[_0x5438ab(0xe7d)](_0x5438ab(0x1323));_0x1f8947[_0x5438ab(0x69b)]=_0x5438ab(0x8fc)+(_0x24190f?_0x5438ab(0xf86):'ai'),_0x1f8947['dataset'][_0x5438ab(0xf16)]=_0x4e36be['timestamp'];const _0x5b5979=document[_0x5438ab(0xe7d)](_0x5438ab(0xd0));_0x5b5979['className']=_0x5438ab(0xf16),_0x5b5979[_0x5438ab(0x1a2)]=_0x3c9d90(_0x4e36be[_0x5438ab(0xf16)]);let _0x55c4bc,_0x3953f6='';if(_0x24190f)_0x55c4bc=_0x441432[_0x5438ab(0xda2)][_0x5438ab(0xa6)]||(_0x441432[_0x5438ab(0x726)]?_0x502840:_0x4fd084),_0x3953f6=_0x441432[_0x5438ab(0xda2)][_0x5438ab(0x66f)]||'';else{if(_0x441432[_0x5438ab(0x726)]){const _0x3ba7c9=_0x441432[_0x5438ab(0xfa8)][_0x5438ab(0xb07)](_0x1e3cbf=>_0x1e3cbf['originalName']===_0x4e36be[_0x5438ab(0x2a3)]);if(_0x3ba7c9){const _0x1dbdbd=_0x42f206[_0x5438ab(0x954)][_0x3ba7c9['id']];_0x55c4bc=_0x3ba7c9[_0x5438ab(0x5c6)]||(_0x1dbdbd?_0x1dbdbd['settings'][_0x5438ab(0x9c7)]:_0x482806),_0x3953f6=_0x3ba7c9[_0x5438ab(0x2c5)]||(_0x1dbdbd?_0x1dbdbd[_0x5438ab(0xda2)][_0x5438ab(0xce6)]:'');}else _0x55c4bc=_0x482806,_0x3953f6='';}else _0x55c4bc=_0x441432['settings'][_0x5438ab(0x9c7)]||_0x4fd084,_0x3953f6=_0x441432[_0x5438ab(0xda2)][_0x5438ab(0xce6)]||'';}let _0x302b5c;_0x3953f6?_0x302b5c=_0x5438ab(0x64c)+_0x55c4bc+_0x5438ab(0x176)+_0x3953f6+_0x5438ab(0x3d0):_0x302b5c=_0x5438ab(0xfa9)+_0x55c4bc+_0x5438ab(0xf1b);const _0x1399ce=_0x3953f6?_0x5438ab(0x1418):'',_0x2ac5ef=_0x5438ab(0xdad)+_0x1399ce+'\x22>'+_0x302b5c+'</div>';let _0x5ac597,_0x586d26='';if(_0x4e36be[_0x5438ab(0xb92)]){const _0x16d319=_0x32d364(_0x441432,_0x4e36be[_0x5438ab(0xb92)]['senderName']),_0xc98a2f=String(_0x4e36be[_0x5438ab(0xb92)][_0x5438ab(0x1316)]||'');_0x586d26=_0x5438ab(0x11a5)+_0x4e36be[_0x5438ab(0xb92)][_0x5438ab(0xf16)]+_0x5438ab(0x2cf)+_0x16d319+_0x5438ab(0xc20)+_0xc98a2f+_0x5438ab(0x1213);}let _0x56a6b7=_0x4e36be['content'];if(typeof _0x56a6b7===_0x5438ab(0x861)&&_0x56a6b7[_0x5438ab(0x2aa)]()[_0x5438ab(0x13ad)]('<')&&_0x56a6b7[_0x5438ab(0x2aa)]()[_0x5438ab(0x1082)]('>'))_0x5ac597=_0x56a6b7,_0x1f8947[_0x5438ab(0x11c2)][_0x5438ab(0xa58)](_0x5438ab(0x90a));else{if(_0x4e36be[_0x5438ab(0x259)]===_0x5438ab(0x22b)||_0x4e36be[_0x5438ab(0x259)]==='share_link'||_0x4e36be[_0x5438ab(0x259)]==='share_card'||_0x4e36be['type']==='location_share'||_0x4e36be[_0x5438ab(0x259)]==='ai_image'||_0x4e36be['type']===_0x5438ab(0x305)||_0x4e36be[_0x5438ab(0x259)]==='voice_message'||_0x4e36be[_0x5438ab(0x259)]===_0x5438ab(0xf4e)||_0x4e36be['type']==='waimai_request'||_0x4e36be[_0x5438ab(0x259)]===_0x5438ab(0x10e9)||_0x4e36be[_0x5438ab(0x259)]==='red_packet'||_0x4e36be[_0x5438ab(0x259)]===_0x5438ab(0x670)||_0x4e36be['type']===_0x5438ab(0xfb0)||_0x4e36be['type']===_0x5438ab(0xf2a)||_0x4e36be[_0x5438ab(0x259)]===_0x5438ab(0xb62)){if(_0x4e36be['type']===_0x5438ab(0x22b)){const _0x59c1de=_0x4e36be['content']||((_0x4e36be[_0x5438ab(0x4d9)]||'')+'\x20'+(_0x4e36be[_0x5438ab(0x4e9)]||''))[_0x5438ab(0x2aa)](),_0x35067f=/(「.*?」|“.*?”)/g,_0x3e2ea5=_0x59c1de[_0x5438ab(0x90b)](_0x35067f)['filter'](_0x15451e=>_0x15451e);_0x5ac597=_0x3e2ea5[_0x5438ab(0xbf6)](_0x122d67=>{const _0xaa1b13=_0x5438ab;return _0x122d67['startsWith']('「')||_0x122d67[_0xaa1b13(0x13ad)]('“')?_0xaa1b13(0x3e3)+_0x5c8590(_0x122d67)+_0xaa1b13(0xf82):_0xaa1b13(0x136d)+_0x5c8590(_0x122d67[_0xaa1b13(0x2aa)]())[_0xaa1b13(0x33b)](/\n/g,_0xaa1b13(0x1208))+_0xaa1b13(0xf82);})[_0x5438ab(0x56c)]('');}else{if(_0x4e36be[_0x5438ab(0x259)]==='share_link')_0x1f8947[_0x5438ab(0x11c2)][_0x5438ab(0xa58)](_0x5438ab(0x1338),'is-card-like'),_0x5ac597=_0x5438ab(0xa9f)+_0x4e36be[_0x5438ab(0xf16)]+_0x5438ab(0x616)+(_0x4e36be[_0x5438ab(0x316)]||_0x5438ab(0x1223))+'</div><div\x20class=\x22description\x22>'+(_0x4e36be[_0x5438ab(0x4e9)]||_0x5438ab(0x4b0))+'</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>'+(_0x4e36be[_0x5438ab(0x885)]||_0x5438ab(0x398))+_0x5438ab(0x8a4);else{if(_0x4e36be[_0x5438ab(0x259)]===_0x5438ab(0x12a0))_0x1f8947['classList'][_0x5438ab(0xa58)](_0x5438ab(0x1338),'is-card-like'),_0x5ac597=_0x5438ab(0x743)+_0x4e36be[_0x5438ab(0xf16)]+_0x5438ab(0x616)+_0x4e36be[_0x5438ab(0xdbc)][_0x5438ab(0x316)]+_0x5438ab(0x88e)+_0x4e36be['payload'][_0x5438ab(0x1160)]['length']+_0x5438ab(0x49e);else{if(_0x4e36be[_0x5438ab(0x259)]===_0x5438ab(0x7c)){_0x1f8947[_0x5438ab(0x11c2)]['add'](_0x5438ab(0x89e),_0x5438ab(0x147));let _0x4ae08f;if(_0x4e36be['imageUrl'])_0x4ae08f=_0x4e36be[_0x5438ab(0x2cc)];else _0x42f206[_0x5438ab(0xf0)]['enableAiDrawing']&&_0x4e36be[_0x5438ab(0xef)]?_0x4ae08f=_0x5438ab(0x94c)+encodeURIComponent(_0x4e36be[_0x5438ab(0xef)]):_0x4ae08f=_0x5438ab(0xcb2);const _0x52165e=_0x5438ab(0x9ac)+_0x4ae08f+_0x5438ab(0x12a5);_0x5ac597=_0x5438ab(0x5e5)+_0x4e36be['content']+'</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20'+_0x52165e+_0x5438ab(0x6db);}else{if(_0x4e36be[_0x5438ab(0x259)]==='user_photo'||_0x4e36be['type']===_0x5438ab(0xb1e)){_0x1f8947['classList']['add'](_0x5438ab(0xf24),_0x5438ab(0x147));const _0x416f74=_0x4e36be[_0x5438ab(0x259)]===_0x5438ab(0x305)?_0x5438ab(0xb79):_0x5438ab(0x447),_0x115955=_0x42f206[_0x5438ab(0xf0)][_0x5438ab(0xf0e)]&&_0x4e36be[_0x5438ab(0xef)]?_0x5438ab(0x94c)+_0x4e36be[_0x5438ab(0xef)]:_0x5438ab(0x503);_0x5ac597=_0x5438ab(0xfa9)+_0x115955+_0x5438ab(0xf28)+_0x416f74+'\x22\x20data-description=\x22'+_0x4e36be[_0x5438ab(0x1316)]+'\x22>';}else{if(_0x4e36be[_0x5438ab(0x259)]===_0x5438ab(0xb62))_0x1f8947[_0x5438ab(0x11c2)][_0x5438ab(0xa58)](_0x5438ab(0x7fe),_0x5438ab(0x147)),_0x5ac597=_0x5438ab(0xfa9)+_0x4e36be['imageUrl']+_0x5438ab(0xa07)+(_0x4e36be[_0x5438ab(0x367)]||_0x4e36be['prompt']||'NovelAI生成')+'\x22>';else{if(_0x4e36be['type']===_0x5438ab(0xefa)){_0x1f8947[_0x5438ab(0x11c2)][_0x5438ab(0xa58)]('is-voice-message','is-card-like');const _0x5e7002=Math['max'](0x1,Math[_0x5438ab(0x1434)]((_0x4e36be[_0x5438ab(0x1316)]||'')[_0x5438ab(0x131d)]/0x5)),_0x31393f='0:'+String(_0x5e7002)[_0x5438ab(0x508)](0x2,'0')+'\x27\x27',_0x478668='<div></div><div></div><div></div><div></div><div></div>';if(_0x24190f)_0x5ac597=_0x5438ab(0x288)+encodeURIComponent(_0x4e36be['content'])+_0x5438ab(0x3d8)+_0x478668+_0x5438ab(0xcfe)+_0x31393f+_0x5438ab(0x8b8);else{const _0x5a2e06=!_0x441432[_0x5438ab(0x726)]&&_0x441432[_0x5438ab(0xda2)][_0x5438ab(0x211)]!==![],_0x33a6df=_0x441432[_0x5438ab(0xda2)][_0x5438ab(0x1077)]||_0x5438ab(0x6a8),_0x2e75fa=_0x5a2e06?_0x5438ab(0x116b)+_0x33a6df+'\x22':'';_0x5ac597='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22'+encodeURIComponent(_0x4e36be[_0x5438ab(0x1316)])+'\x22\x20'+_0x2e75fa+_0x5438ab(0x45e)+_0x478668+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>'+_0x31393f+_0x5438ab(0x8b8);}}else{if(_0x4e36be['type']===_0x5438ab(0xf4e)){_0x1f8947[_0x5438ab(0x11c2)][_0x5438ab(0xa58)](_0x5438ab(0x27f),_0x5438ab(0x147));let _0x111e77,_0x1bdb07;const _0x18c332=_0x441432[_0x5438ab(0x726)]?_0x441432[_0x5438ab(0xda2)][_0x5438ab(0xc7d)]||'我':'我',_0x336e86=_0x32d364(_0x441432,_0x4e36be[_0x5438ab(0x2a3)]),_0x403186=_0x32d364(_0x441432,_0x4e36be[_0x5438ab(0x1421)]||_0x441432[_0x5438ab(0x132a)]);if(_0x24190f){if(_0x4e36be[_0x5438ab(0x118)])_0x111e77=_0x5438ab(0x347)+_0x403186,_0x1bdb07=_0x5438ab(0x9f5);else{_0x111e77=_0x5438ab(0x61c)+_0x403186;if(_0x4e36be['status']===_0x5438ab(0xae))_0x1bdb07=_0x5438ab(0xa49);else{if(_0x4e36be['status']===_0x5438ab(0x62c))_0x1bdb07=_0x5438ab(0x1021);else _0x1bdb07=_0x4e36be[_0x5438ab(0x1187)]||_0x5438ab(0x11fe);}}}else{if(_0x4e36be['isRefund'])_0x111e77=_0x5438ab(0xf81)+_0x336e86,_0x1bdb07=_0x5438ab(0xf80);else{if(_0x4e36be['receiverName']===_0x18c332){_0x111e77=_0x5438ab(0x61c)+_0x18c332;if(_0x4e36be[_0x5438ab(0x13b2)]===_0x5438ab(0xae))_0x1bdb07=_0x5438ab(0x132b);else{if(_0x4e36be[_0x5438ab(0x13b2)]===_0x5438ab(0x62c))_0x1bdb07=_0x5438ab(0x6b5);else _0x1f8947[_0x5438ab(0x1104)]['cursor']=_0x5438ab(0xa6b),_0x1f8947[_0x5438ab(0x1f4)][_0x5438ab(0x13b2)]='pending',_0x1bdb07=_0x4e36be[_0x5438ab(0x1187)]||'点击处理';}}else _0x111e77=_0x5438ab(0xebe)+_0x336e86+_0x5438ab(0xff3)+_0x403186,_0x1bdb07=_0x4e36be[_0x5438ab(0x1187)]||_0x5438ab(0x5c8);}}const _0x456657=_0x5438ab(0xf51);_0x5ac597=_0x5438ab(0x2bb)+_0x456657+'\x20'+_0x111e77+_0x5438ab(0x35e)+Number(_0x4e36be[_0x5438ab(0x116)])[_0x5438ab(0x800)](0x2)+'</div><div\x20class=\x22transfer-note\x22>'+_0x1bdb07+'</div></div>';}else{if(_0x4e36be['type']===_0x5438ab(0x1128)){_0x1f8947[_0x5438ab(0x11c2)][_0x5438ab(0xa58)](_0x5438ab(0x132),_0x5438ab(0x147));if(_0x4e36be[_0x5438ab(0x13b2)]===_0x5438ab(0x1467)||_0x4e36be['status']==='rejected')_0x1f8947[_0x5438ab(0x11c2)][_0x5438ab(0xa58)](_0x5438ab(0x365)+_0x4e36be[_0x5438ab(0x13b2)]);const _0x5f3af2=_0x32d364(_0x441432,_0x4e36be[_0x5438ab(0x2a3)]),_0x18042f='来自\x20'+_0x5f3af2+_0x5438ab(0x126e);let _0x363fe0='';_0x4e36be[_0x5438ab(0x13b2)]===_0x5438ab(0xdaa)&&!_0x24190f&&(_0x363fe0=_0x5438ab(0x514)),_0x5ac597='<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>'+_0x18042f+_0x5438ab(0xf97)+Number(_0x4e36be[_0x5438ab(0x116)])[_0x5438ab(0x800)](0x2)+_0x5438ab(0xb08)+_0x4e36be[_0x5438ab(0xf16)]+_0x5438ab(0x6c2)+_0x363fe0+_0x5438ab(0xb44),setTimeout(()=>{const _0x1156cf=_0x5438ab;if(_0x4e36be[_0x1156cf(0x13b2)]==='pending'){const _0x1c8b7c=document['getElementById'](_0x1156cf(0xc73)+_0x4e36be[_0x1156cf(0xf16)]);if(_0x1c8b7c){const _0x4d01be=_0x46ec06(_0x1c8b7c,_0x4e36be[_0x1156cf(0xac7)]);_0x2bdb95[_0x4e36be[_0x1156cf(0xf16)]]=_0x4d01be;}}},0x0);}else{if(_0x4e36be[_0x5438ab(0x259)]==='waimai_order'){_0x1f8947[_0x5438ab(0x11c2)][_0x5438ab(0xa58)](_0x5438ab(0x132),_0x5438ab(0x147));const _0x1dc0ed=_0x32d364(_0x441432,_0x4e36be[_0x5438ab(0x2a3)]);let _0x3e954a='你';_0x441432['isGroup']&&(_0x3e954a=_0x32d364(_0x441432,_0x4e36be['recipientName'])),_0x5ac597='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>'+_0x1dc0ed+_0x5438ab(0x6c6)+_0x3e954a+'下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>'+_0x4e36be[_0x5438ab(0xaed)]+_0x5438ab(0x15c)+Number(_0x4e36be[_0x5438ab(0x116)])[_0x5438ab(0x800)](0x2)+_0x5438ab(0x114d);}else{if(_0x4e36be['type']===_0x5438ab(0xd9e)){_0x1f8947[_0x5438ab(0x11c2)][_0x5438ab(0xa58)](_0x5438ab(0x10ac),'is-card-like');const _0x168006=_0x42f206[_0x5438ab(0x551)][_0x5438ab(0x308)]||'{{user}}',_0x42bdcc=_0x4e36be[_0x5438ab(0x1258)],_0x4db61b=_0x4e36be[_0x5438ab(0xcd4)]&&_0x4e36be[_0x5438ab(0xcd4)][_0x168006];let _0x576a49='',_0x54f3a6='',_0x5dc379=_0x5438ab(0x3dc);_0x42bdcc&&(_0x576a49=_0x5438ab(0xe0b));if(_0x4e36be['packetType']===_0x5438ab(0x1205)){const _0x33466e=_0x32d364(_0x441432,_0x4e36be['receiverName']);_0x5dc379='专属红包:\x20给\x20'+_0x33466e;if(Object['keys'](_0x4e36be[_0x5438ab(0xcd4)]||{})[_0x5438ab(0x131d)]>0x0)_0x576a49='opened';}if(_0x4db61b){const _0x2650e0=_0x4e36be[_0x5438ab(0xcd4)][_0x168006]||0x0;_0x54f3a6=_0x5438ab(0x28f)+_0x2650e0[_0x5438ab(0x800)](0x2)+_0x5438ab(0x1241);}else{if(_0x42bdcc)_0x54f3a6='<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>';else{if(_0x4e36be['packetType']===_0x5438ab(0x1205)&&Object['keys'](_0x4e36be[_0x5438ab(0xcd4)]||{})['length']>0x0){const _0x2ece0e=_0x32d364(_0x441432,_0x4e36be[_0x5438ab(0x1421)]);_0x54f3a6=_0x5438ab(0x3f8)+_0x2ece0e+'\x20领取</div>';}}}_0x5ac597=_0x5438ab(0x582)+_0x576a49+'\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>'+(_0x4e36be[_0x5438ab(0xf77)]||_0x5438ab(0x98f))+_0x5438ab(0xea5)+_0x5dc379+_0x5438ab(0xb44)+_0x54f3a6+_0x5438ab(0xb44);}else{if(_0x4e36be[_0x5438ab(0x259)]==='poll'){_0x1f8947[_0x5438ab(0x11c2)][_0x5438ab(0xa58)](_0x5438ab(0x6b4),_0x5438ab(0x147));const _0x212009=_0x4e36be[_0x5438ab(0xbc9)]||_0x4e36be['content']||_0x5438ab(0x29f);let _0x4b32dd=0x0;const _0x550654={};for(const _0x3bfe70 in _0x4e36be[_0x5438ab(0x92)]){const _0xbc446e=_0x4e36be[_0x5438ab(0x92)][_0x3bfe70][_0x5438ab(0x131d)];_0x550654[_0x3bfe70]=_0xbc446e,_0x4b32dd+=_0xbc446e;}const _0xe1f313=_0x42f206['qzoneSettings'][_0x5438ab(0x308)]||_0x5438ab(0x852);let _0x1fb3cb=null;for(const _0x1ae568 in _0x4e36be['votes']){if(_0x4e36be[_0x5438ab(0x92)][_0x1ae568]['includes'](_0xe1f313)){_0x1fb3cb=_0x1ae568;break;}}let _0x45ba68=_0x5438ab(0x941);_0x4e36be[_0x5438ab(0x8e9)]['forEach'](_0x4d66f1=>{const _0x5a7ce0=_0x5438ab,_0x458199=_0x550654[_0x4d66f1]||0x0,_0x52a875=_0x4b32dd>0x0?_0x458199/_0x4b32dd*0x64:0x0,_0x42706b=_0x1fb3cb===_0x4d66f1;_0x45ba68+=_0x5a7ce0(0x1a3)+(_0x42706b?_0x5a7ce0(0x75f):'')+_0x5a7ce0(0xa83)+_0x4d66f1+'\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20'+_0x52a875+'%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>'+_0x4d66f1+_0x5a7ce0(0x107a)+_0x458199+_0x5a7ce0(0xcef);}),_0x45ba68+=_0x5438ab(0xb44);let _0x239179=_0x4e36be['isClosed']?_0x5438ab(0xc94)+_0x4b32dd+'\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>':_0x5438ab(0xc94)+_0x4b32dd+_0x5438ab(0x12a7);_0x5ac597=_0x5438ab(0x584)+(_0x4e36be['isClosed']?_0x5438ab(0xd9c):'')+_0x5438ab(0x1290)+_0x4e36be[_0x5438ab(0xf16)]+_0x5438ab(0x5ed)+_0x212009+_0x5438ab(0xb44)+_0x45ba68+_0x239179+_0x5438ab(0xb44);}else{if(_0x4e36be['type']===_0x5438ab(0xfb0)){_0x1f8947[_0x5438ab(0x11c2)][_0x5438ab(0xa58)]('is-gift',_0x5438ab(0x147));let _0x2ab692;const _0x205ce4=_0x441432[_0x5438ab(0xda2)][_0x5438ab(0xc7d)]||'我';if(_0x441432[_0x5438ab(0x726)]){if(_0x4e36be[_0x5438ab(0xd19)]&&_0x4e36be['recipients']['length']>0x0){const _0x18d970=_0x4e36be[_0x5438ab(0xd19)]['map'](_0x3fba1d=>_0x32d364(_0x441432,_0x3fba1d));_0x18d970[_0x5438ab(0x131d)]===0x1?_0x2ab692=_0x5438ab(0xa98)+_0x18d970[0x0]+_0x5438ab(0x222):_0x2ab692=_0x5438ab(0xa98)+_0x18d970[_0x5438ab(0x5b0)](0x0,0x2)['join']('、')+_0x5438ab(0x139c);}else _0x2ab692=_0x5438ab(0x145b);}else{if(_0x24190f)_0x2ab692=_0x5438ab(0xa98)+_0x441432[_0x5438ab(0x132a)]+_0x5438ab(0x222);else{const _0xa64356=_0x441432[_0x5438ab(0xda2)][_0x5438ab(0xc7d)]||'你';_0x2ab692='送给\x20'+_0xa64356+_0x5438ab(0x222);}}const _0x77ca08=_0x4e36be[_0x5438ab(0xce5)]['slice'](0x0,0x3);let _0x4157b4='';_0x77ca08['forEach'](_0x4ba63d=>{const _0x7de923=_0x5438ab;_0x4157b4+=_0x7de923(0x253)+_0x4ba63d[_0x7de923(0x2cc)]+_0x7de923(0x105c)+_0x4ba63d[_0x7de923(0x132a)]+_0x7de923(0xbef)+_0x4ba63d[_0x7de923(0x177)]+_0x7de923(0x1386);});let _0x4a4cd9='';_0x4e36be['items'][_0x5438ab(0x131d)]>0x3&&(_0x4a4cd9='\x20等'+_0x4e36be[_0x5438ab(0xce5)][_0x5438ab(0x131d)]+'件商品'),_0x5ac597=_0x5438ab(0x1186)+_0x2ab692+'</span></div><div\x20class=\x22gift-items-preview\x22>'+_0x4157b4+_0x5438ab(0x1ae)+_0x4e36be[_0x5438ab(0xce5)][_0x5438ab(0x131d)]+_0x5438ab(0x10f7)+_0x4a4cd9+_0x5438ab(0x1253);}}}}}}}}}}}}}}else{const _0x445ff2=String(_0x56a6b7);let _0x551722=await _0x49d489(_0x445ff2,_0x441432['id']);if(_0x551722!==_0x445ff2)_0x5ac597=_0x551722,_0x1f8947[_0x5438ab(0x11c2)][_0x5438ab(0xa58)]('is-card-like');else{if(Array['isArray'](_0x4e36be[_0x5438ab(0x1316)])&&_0x4e36be[_0x5438ab(0x1316)][0x0]?.[_0x5438ab(0x259)]===_0x5438ab(0x1072)){const _0x254a6d=_0x4e36be[_0x5438ab(0x1316)][0x0][_0x5438ab(0x1072)]['url'];_0x5ac597=_0x5438ab(0xfa9)+_0x254a6d+'\x22\x20class=\x22chat-image\x22>';}else{if(_0x30c9b4[_0x5438ab(0x9c0)](_0x551722))_0x1f8947[_0x5438ab(0x11c2)][_0x5438ab(0xa58)](_0x5438ab(0x7c4),_0x5438ab(0x147)),_0x5ac597=_0x5438ab(0xfa9)+_0x551722+_0x5438ab(0x298)+(_0x4e36be[_0x5438ab(0x32e)]||'Sticker')+_0x5438ab(0x5ee);else{let _0x50749b=_0xcad370(_0x551722,_0x441432);_0x5ac597=_0x5c8590(_0x50749b)[_0x5438ab(0x33b)](/\n/g,_0x5438ab(0x1208));}}}}}_0x1f8947[_0x5438ab(0x110d)]=_0x5438ab(0x8c3)+_0x2ac5ef+_0x5438ab(0x122d)+_0x586d26+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5ac597+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x157227[_0x5438ab(0x1079)](_0x1f8947),_0x157227[_0x5438ab(0x1079)](_0x5b5979),_0x4376d8(_0x157227,()=>_0x233ca6(_0x4e36be['timestamp'])),_0x157227[_0x5438ab(0xd85)](_0x5438ab(0x1122),()=>{const _0x3a6ce9=_0x5438ab;if(_0x2b45d0)_0x32bda0(_0x4e36be[_0x3a6ce9(0xf16)]);});if(!_0x24190f){const _0x4ff56b=_0x157227[_0x5438ab(0x586)](_0x5438ab(0xe27));_0x4ff56b&&(_0x4ff56b[_0x5438ab(0x1104)]['cursor']=_0x5438ab(0xa6b),!_0x441432[_0x5438ab(0x726)]?_0x4ff56b[_0x5438ab(0xd85)]('click',_0x58f026=>{_0x58f026['stopPropagation'](),_0x376e39(_0x441432['id']);}):_0x4ff56b[_0x5438ab(0xd85)]('dblclick',_0x1b955b=>{const _0x39eed9=_0x5438ab;_0x1b955b['stopPropagation'](),_0x2ed67a(_0x441432['id'],_0x4e36be[_0x39eed9(0x2a3)]);}));}return _0x157227;}async function _0x409916(_0x7f892c,_0x502471){const _0x2d75b7=_0x204348,_0x14aeaa=document[_0x2d75b7(0x458)](_0x2d75b7(0x13a0)),_0x12052a=await _0x4b8ea5(_0x7f892c,_0x502471);if(!_0x12052a)return;const _0xab9365=document[_0x2d75b7(0x458)](_0x2d75b7(0xde6));_0xab9365?_0x14aeaa[_0x2d75b7(0x4d4)](_0x12052a,_0xab9365[_0x2d75b7(0xff1)]):_0x14aeaa[_0x2d75b7(0x13e2)](_0x12052a);}async function _0x5d5ee2(_0x10fa33,_0x56eca8,_0x2a7331=![]){const _0x311ec2=_0x204348,_0x265809=document[_0x311ec2(0x458)](_0x311ec2(0x13a0)),_0x22b2d3=document[_0x311ec2(0x458)](_0x311ec2(0x34e)),_0x26a3fb=_0x56eca8[_0x311ec2(0x1d5)][_0x311ec2(0xaf1)](_0x3866ad=>!_0x3866ad[_0x311ec2(0x7a0)])[_0x311ec2(0xdd4)]();if(_0x26a3fb&&_0x10fa33['timestamp']-_0x26a3fb[_0x311ec2(0xf16)]>0x927c0){const _0x2e7912=_0x2a60ff(_0x10fa33[_0x311ec2(0xf16)]);_0x265809['insertBefore'](_0x2e7912,_0x22b2d3);}const _0x41b164=await _0x4b8ea5(_0x10fa33,_0x56eca8);if(!_0x41b164)return;_0x10fa33[_0x311ec2(0xaeb)]===_0x311ec2(0xac3)&&!_0x2a7331&&_0x4b589a(),!_0x2a7331&&_0x41b164[_0x311ec2(0x11c2)][_0x311ec2(0xa58)]('animate-in'),_0x265809['insertBefore'](_0x41b164,_0x22b2d3),!_0x2a7331&&(_0x265809[_0x311ec2(0x358)]=_0x265809[_0x311ec2(0x94b)],_0x36c81d++);}async function _0x31c384(_0x5920be){const _0x39299a=_0x204348;_0x42f206[_0x39299a(0x81d)]=_0x5920be;const _0x4a595c=_0x42f206['chats'][_0x5920be];if(!_0x4a595c)return;_0x4a595c[_0x39299a(0x12c9)]>0x0&&(_0x4a595c[_0x39299a(0x12c9)]=0x0,await _0x17d534[_0x39299a(0x954)][_0x39299a(0xf3f)](_0x4a595c));_0x1c0fcf(_0x4a595c),_0x359c96(_0x5920be),_0x589d88(_0x39299a(0xd99)),window['updateListenTogetherIconProxy'](_0x42f206[_0x39299a(0x81d)]);const _0x460074=_0x4a595c['isGroup']||![];_0x561ecb(_0x460074),document[_0x39299a(0x458)](_0x39299a(0xd2a))['style'][_0x39299a(0x4db)]=_0x460074?_0x39299a(0x82b):'none';const _0x302c47=document[_0x39299a(0x458)](_0x39299a(0x13bf));_0x302c47&&(_0x302c47[_0x39299a(0x1104)][_0x39299a(0x4db)]=_0x460074?_0x39299a(0x464):_0x39299a(0x82b));const _0x4a6df8=document[_0x39299a(0x458)](_0x39299a(0x943)),_0x274a9d=document['getElementById']('open-shopping-btn'),_0xa6414d=document[_0x39299a(0x458)](_0x39299a(0x140c)),_0x31e31b=document[_0x39299a(0x458)]('werewolf-game-btn');_0x274a9d&&_0xa6414d&&_0x31e31b&&_0x4a6df8&&(_0x274a9d['style'][_0x39299a(0x4db)]=_0x39299a(0x82b),_0xa6414d[_0x39299a(0x1104)][_0x39299a(0x4db)]=_0x460074?_0x39299a(0x464):_0x39299a(0x82b),_0x31e31b[_0x39299a(0x1104)][_0x39299a(0x4db)]=_0x460074?_0x39299a(0x82b):_0x39299a(0x464),_0x4a6df8['style'][_0x39299a(0x4db)]=_0x460074?_0x39299a(0x464):_0x39299a(0x82b)),_0x3fa630(),!_0x4a595c[_0x39299a(0x726)]&&_0x4a595c[_0x39299a(0x569)]?.[_0x39299a(0x13b2)]===_0x39299a(0x11f8)&&(console[_0x39299a(0x7d1)](_0x39299a(0x1191)+_0x4a595c[_0x39299a(0x132a)]+_0x39299a(0x1088)),_0x3ee822()),document[_0x39299a(0x458)](_0x39299a(0xedf))[_0x39299a(0x1104)][_0x39299a(0x4db)]=_0x460074?_0x39299a(0x82b):_0x39299a(0x464);}function _0x260324(_0x15b4e7,_0x17e848){const _0x259a90=_0x204348,_0x34c23a=_0x17e848?'add':'remove',_0x216b3b=_0x30006f=>{const _0x270d85=_0x1a5b;_0x30006f&&_0x30006f['classList'][_0x34c23a](_0x270d85(0xe50));},_0x1dde0e=document['querySelector']('.chat-list-item[data-chat-id=\x22'+_0x15b4e7+_0x259a90(0x6a5));_0x216b3b(_0x1dde0e);const _0x43abb2=document['querySelectorAll'](_0x259a90(0x71e)+_0x15b4e7+'\x22]');_0x43abb2['forEach'](_0x216b3b);const _0x582716=document[_0x259a90(0x586)]('.participant-avatar[data-participant-id=\x22'+_0x15b4e7+'\x22]');_0x216b3b(_0x582716);}async function _0xef2b3f(){const _0x3061a7=_0x204348;if(!_0x42f206['activeChatId'])return;const _0x4018ac=_0x42f206['activeChatId'],_0x172621=_0x42f206[_0x3061a7(0x954)][_0x4018ac];lastRawAiResponse='',lastResponseTimestamps=[];const _0x3c2525=document[_0x3061a7(0x458)]('spectator-propel-btn');_0x3c2525&&(_0x3c2525[_0x3061a7(0xb18)]=!![],_0x3c2525[_0x3061a7(0x1a2)]=_0x3061a7(0x105f));_0x260324(_0x4018ac,!![]);try{const {proxyUrl:_0x5d1cdd,apiKey:_0x4a1fa6,model:_0x3fa61a}=_0x42f206['apiConfig'];if(!_0x5d1cdd||!_0x4a1fa6||!_0x3fa61a)throw new Error(_0x3061a7(0xd5d));const _0x14cf1d=parseInt(_0x172621[_0x3061a7(0xda2)][_0x3061a7(0x125c)])||0xa,_0x1e08b5=_0x172621['history'][_0x3061a7(0x5b0)](-_0x14cf1d);let _0x323d9b='';if(_0x172621[_0x3061a7(0xda2)][_0x3061a7(0x315)]&&_0x172621[_0x3061a7(0xda2)][_0x3061a7(0x315)][_0x3061a7(0x131d)]>0x0){const _0x113c3f=_0x172621[_0x3061a7(0xda2)][_0x3061a7(0x315)]['map'](_0x3de823=>{const _0x226b13=_0x3061a7,_0x1a1c40=_0x42f206[_0x226b13(0xab7)][_0x226b13(0xb07)](_0x167bf7=>_0x167bf7['id']===_0x3de823);if(!_0x1a1c40||!Array['isArray'](_0x1a1c40['content']))return'';const _0x3df1b0=_0x1a1c40[_0x226b13(0x1316)][_0x226b13(0xaf1)](_0x3079a0=>_0x3079a0[_0x226b13(0x12fb)]!==![])[_0x226b13(0xbf6)](_0x5439c6=>{const _0x2a5a8f=_0x226b13;let _0x560ec8=_0x2a5a8f(0x111f)+(_0x5439c6['comment']||'无备注')+'\x0a';if(_0x5439c6[_0x2a5a8f(0x634)][_0x2a5a8f(0x131d)]>0x0)_0x560ec8+=_0x2a5a8f(0xe8c)+_0x5439c6[_0x2a5a8f(0x634)]['join'](',\x20')+'\x0a';return _0x560ec8+=_0x2a5a8f(0xcdf)+_0x5439c6[_0x2a5a8f(0x1316)],_0x560ec8;})[_0x226b13(0x56c)]('');return _0x3df1b0?_0x226b13(0x64a)+_0x1a1c40['name']+'\x0a'+_0x3df1b0:'';})[_0x3061a7(0xaf1)](Boolean)[_0x3061a7(0x56c)]('');_0x113c3f&&(_0x323d9b='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x113c3f+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x188f5b='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0xfd0a6=![];_0x172621[_0x3061a7(0xfa8)][_0x3061a7(0x12c2)](_0x5c7498=>{const _0x27ef9c=_0x3061a7,_0x117df8=_0x42f206[_0x27ef9c(0x954)][_0x5c7498['id']];_0x117df8&&_0x117df8[_0x27ef9c(0x94a)]&&_0x117df8['longTermMemory'][_0x27ef9c(0x131d)]>0x0&&(_0x188f5b+=_0x27ef9c(0xfb2)+_0x5c7498[_0x27ef9c(0x1118)]+'”的记忆\x20---\x0a',_0x188f5b+=_0x117df8[_0x27ef9c(0x94a)][_0x27ef9c(0xbf6)](_0x180a45=>_0x27ef9c(0x101)+_0x1f0c92(_0x180a45[_0x27ef9c(0xf16)])+')\x20'+_0x180a45[_0x27ef9c(0x1316)])[_0x27ef9c(0x56c)]('\x0a'),_0xfd0a6=!![]);});!_0xfd0a6&&(_0x188f5b+=_0x3061a7(0xb86));let _0xd82c87='';const _0x3705e5=_0x172621['settings'][_0x3061a7(0x912)]||0xa;if(_0x172621[_0x3061a7(0xda2)][_0x3061a7(0x1448)]&&_0x172621[_0x3061a7(0xda2)][_0x3061a7(0x1448)]['length']>0x0){}const _0x956c6e=_0x172621[_0x3061a7(0xfa8)][_0x3061a7(0xbf6)](_0x4eeb2b=>_0x3061a7(0x1293)+_0x4eeb2b['groupNickname']+'**\x20(本名:\x20'+_0x4eeb2b[_0x3061a7(0xa1)]+_0x3061a7(0x352)+_0x4eeb2b[_0x3061a7(0x124d)])[_0x3061a7(0x56c)]('\x0a'),_0x4f212a=_0x386294(_0x172621),_0x58fa60=_0x3061a7(0x7c2)+_0x172621[_0x3061a7(0x132a)]+_0x3061a7(0xbde)+_0x172621[_0x3061a7(0x132a)]+'\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a'+_0x188f5b+'\x0a'+_0x323d9b+'\x0a'+_0xd82c87+'\x0a-\x20**这是你们最近的对话历史**:\x0a'+_0x1e08b5[_0x3061a7(0xbf6)](_0x10e13f=>_0x32d364(_0x172621,_0x10e13f['senderName'])+':\x20'+_0x10e13f[_0x3061a7(0x1316)])['join']('\x0a')+_0x3061a7(0x60e)+_0x956c6e+_0x3061a7(0x101d)+_0x4f212a+'\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a',_0x4b206a=_0x1e08b5['map'](_0x165241=>({'role':_0x3061a7(0xf86),'content':_0x32d364(_0x172621,_0x165241['senderName'])+':\x20'+_0x165241[_0x3061a7(0x1316)]}));let _0x20d338=_0x5d1cdd['includes'](_0x3061a7(0x7b)),_0x4d4b3f;if(_0x20d338){let _0x29aad=_0x5d73db(_0x3fa61a,_0x4a1fa6,_0x58fa60,_0x4b206a);_0x4d4b3f=await fetch(_0x29aad['url'],_0x29aad['data']);}else _0x4d4b3f=await fetch(_0x5d1cdd+'/v1/chat/completions',{'method':_0x3061a7(0x1312),'headers':{'Content-Type':_0x3061a7(0xa0e),'Authorization':_0x3061a7(0x8aa)+_0x4a1fa6},'body':JSON[_0x3061a7(0xc04)]({'model':_0x3fa61a,'messages':[{'role':_0x3061a7(0x1370),'content':_0x58fa60},..._0x4b206a],'temperature':_0x42f206[_0x3061a7(0xf0)][_0x3061a7(0xfdf)]||0.9})});if(!_0x4d4b3f['ok']){const _0xe0da58=await _0x4d4b3f[_0x3061a7(0xaef)]()[_0x3061a7(0x1135)](()=>({'error':{'message':_0x4d4b3f[_0x3061a7(0xf0c)]}}));throw new Error(_0x3061a7(0x127)+_0x4d4b3f[_0x3061a7(0x13b2)]+'\x20-\x20'+(_0xe0da58[_0x3061a7(0xb61)]?.[_0x3061a7(0x7aa)]||_0x3061a7(0x122f)));}const _0x597f3b=await _0x4d4b3f[_0x3061a7(0xaef)](),_0x484b95=getGeminiResponseText(_0x597f3b);lastRawAiResponse=_0x484b95;const _0x785d79=_0x418096(_0x484b95);let _0x47d7db=Date[_0x3061a7(0x606)]();for(const _0x3fd41e of _0x785d79){if(!_0x3fd41e||!_0x3fd41e[_0x3061a7(0x259)]||!_0x3fd41e['name'])continue;let _0x3f41cd=null;const _0x262ab4=_0x47d7db++;lastResponseTimestamps['push'](_0x262ab4);const _0x25f62c={'role':_0x3061a7(0xac3),'senderName':_0x3fd41e[_0x3061a7(0x132a)],'timestamp':_0x262ab4};switch(_0x3fd41e['type']){case'text':_0x3f41cd={..._0x25f62c,'content':_0x3fd41e[_0x3061a7(0x1316)]};break;case _0x3061a7(0x869):if(_0x3fd41e[_0x3061a7(0x32e)]){const _0x1b3fac=_0x42f206[_0x3061a7(0x1294)][_0x3061a7(0xb07)](_0x128eaa=>_0x128eaa[_0x3061a7(0x132a)]===_0x3fd41e[_0x3061a7(0x32e)]);_0x1b3fac?_0x3f41cd={..._0x25f62c,'type':_0x3061a7(0x869),'content':_0x1b3fac[_0x3061a7(0x1377)],'meaning':_0x1b3fac['name']}:(console['warn'](_0x3061a7(0x2c9)+_0x3fd41e['meaning']+'\x22'),_0x3f41cd={..._0x25f62c,'type':_0x3061a7(0xdd5),'content':_0x3061a7(0x21f)+_0x3fd41e[_0x3061a7(0x32e)]+']'});}else console['warn']('旁观模式AI发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。',_0x3fd41e);break;case'ai_image':_0x3f41cd={..._0x25f62c,'type':_0x3061a7(0xb1e),'content':_0x3fd41e['description'],'image_prompt':_0x3fd41e[_0x3061a7(0xef)]};break;case _0x3061a7(0xefa):_0x3f41cd={..._0x25f62c,'type':'voice_message','content':_0x3fd41e[_0x3061a7(0x1316)]};break;case _0x3061a7(0xf44):const _0xabda09=_0x172621['history']['find'](_0x398d28=>_0x398d28[_0x3061a7(0xf16)]===_0x3fd41e[_0x3061a7(0xa7b)]);_0xabda09?_0x3f41cd={..._0x25f62c,'content':_0x3fd41e['reply_content'],'quote':{'timestamp':_0xabda09[_0x3061a7(0xf16)],'senderName':_0xabda09[_0x3061a7(0x2a3)],'content':String(_0xabda09['content']||'')[_0x3061a7(0xa6d)](0x0,0x32)}}:_0x3f41cd={..._0x25f62c,'content':_0x3fd41e[_0x3061a7(0xbca)]};break;default:console[_0x3061a7(0x1b6)](_0x3061a7(0x1c2),_0x3fd41e['type']);continue;}_0x3f41cd&&(_0x172621[_0x3061a7(0x1d5)][_0x3061a7(0x129e)](_0x3f41cd),_0x5d5ee2(_0x3f41cd,_0x172621),await new Promise(_0xf53c8f=>setTimeout(_0xf53c8f,Math[_0x3061a7(0x23a)]()*0x4b0+0x320)));}await _0x17d534[_0x3061a7(0x954)][_0x3061a7(0xf3f)](_0x172621),_0x27be5e();}catch(_0x2f8947){console[_0x3061a7(0xb61)](_0x3061a7(0x1453),_0x2f8947),await _0x34fce8(_0x3061a7(0x96d),'无法推进剧情:\x20'+_0x2f8947[_0x3061a7(0x7aa)]);}finally{_0x3c2525&&(_0x3c2525[_0x3061a7(0xb18)]=![],_0x3c2525[_0x3061a7(0x1a2)]=_0x3061a7(0x12a8)),_0x260324(_0x4018ac,![]);}}async function _0x3ee822(){const _0x157ae1=_0x204348;if(!_0x42f206['activeChatId'])return;const _0x27c6c8=_0x42f206[_0x157ae1(0x81d)],_0x181f0f=_0x42f206[_0x157ae1(0x954)][_0x42f206[_0x157ae1(0x81d)]],_0x228e99=document[_0x157ae1(0x458)](_0x157ae1(0xd99))[_0x157ae1(0x11c2)][_0x157ae1(0x526)](_0x157ae1(0xfe1))&&_0x42f206[_0x157ae1(0x81d)]===_0x27c6c8;_0x260324(_0x27c6c8,!![]);const _0x5856ac=document[_0x157ae1(0x458)](_0x157ae1(0xca6)),_0x153235=document[_0x157ae1(0x458)](_0x157ae1(0x34e)),_0x980e3f=document[_0x157ae1(0x586)](_0x157ae1(0x58a)+_0x27c6c8+'\x22]'),_0x3d911f=_0x980e3f?_0x980e3f[_0x157ae1(0x586)](_0x157ae1(0x1a1)):null;_0x3d911f&&_0x3d911f['classList'][_0x157ae1(0xa58)]('is-acting');_0x181f0f[_0x157ae1(0x726)]?_0x153235&&(_0x153235[_0x157ae1(0x1a2)]=_0x157ae1(0x916),_0x153235[_0x157ae1(0x1104)]['display']=_0x157ae1(0x1188)):_0x5856ac&&(_0x5856ac[_0x157ae1(0x1104)]['opacity']=0x0,setTimeout(()=>{const _0xa4d8ea=_0x157ae1;_0x5856ac[_0xa4d8ea(0x1a2)]='对方正在输入...',_0x5856ac[_0xa4d8ea(0x11c2)][_0xa4d8ea(0xa58)](_0xa4d8ea(0x417)),_0x5856ac[_0xa4d8ea(0x1104)][_0xa4d8ea(0x539)]=0x1;},0xc8));let _0x1eb741=![];try{const {proxyUrl:_0x1bedae,apiKey:_0x5c5a6b,model:_0x275b29}=_0x42f206[_0x157ae1(0x5cb)];if(!_0x1bedae||!_0x5c5a6b||!_0x275b29){alert('请先在API设置中配置反代地址、密钥并选择模型。');if(_0x181f0f[_0x157ae1(0x726)]){if(_0x153235)_0x153235[_0x157ae1(0x1104)][_0x157ae1(0x4db)]=_0x157ae1(0x464);}else _0x5856ac&&_0x42f206['chats'][_0x27c6c8]&&(_0x5856ac['textContent']=_0x42f206[_0x157ae1(0x954)][_0x27c6c8][_0x157ae1(0x132a)],_0x5856ac[_0x157ae1(0x11c2)][_0x157ae1(0x1097)]('typing-status'));return;}const _0x4e40e5=_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x5b0)](-0x1)[0x0],_0x179cae=_0x4e40e5&&_0x4e40e5[_0x157ae1(0xaeb)]===_0x157ae1(0x1370)&&_0x4e40e5[_0x157ae1(0x1316)][_0x157ae1(0xd8d)]('视频通话请求');if(_0x179cae){console[_0x157ae1(0x7d1)](_0x157ae1(0x11bd)+_0x181f0f['name']+'\x22\x20触发专属决策流程...');let _0x39a6af;_0x181f0f[_0x157ae1(0x726)]?_0x39a6af=_0x157ae1(0x46c)+_0x181f0f[_0x157ae1(0xfa8)][_0x157ae1(0xbf6)](_0x375826=>'-\x20'+_0x375826[_0x157ae1(0x1118)]+_0x157ae1(0x2dd)+_0x375826['originalName']+_0x157ae1(0x352)+_0x375826['persona'])[_0x157ae1(0x56c)]('\x0a')+_0x157ae1(0x10b3):_0x39a6af=_0x157ae1(0x499)+_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x31d)]+_0x157ae1(0xe5b);const _0x285660=[{'role':_0x157ae1(0xf86),'content':_0x39a6af}];try{let _0x185878=_0x5d73db(_0x275b29,_0x5c5a6b,_0x39a6af,_0x285660),_0x1f9506=_0x1bedae===GEMINI_API_URL;const _0x40f8d0=_0x1f9506?await fetch(_0x185878[_0x157ae1(0x1377)],_0x185878['data']):await fetch(_0x1bedae+'/v1/chat/completions',{'method':_0x157ae1(0x1312),'headers':{'Content-Type':_0x157ae1(0xa0e),'Authorization':_0x157ae1(0x8aa)+_0x5c5a6b},'body':JSON[_0x157ae1(0xc04)]({'model':_0x275b29,'messages':_0x285660,'temperature':0.7})});if(!_0x40f8d0['ok'])throw new Error(_0x157ae1(0x7c8)+(await _0x40f8d0[_0x157ae1(0xaef)]())[_0x157ae1(0xb61)][_0x157ae1(0x7aa)]);const _0x30a64e=await _0x40f8d0[_0x157ae1(0xaef)](),_0x36b4cc=getGeminiResponseText(_0x30a64e),_0x456c7c=_0x418096(_0x36b4cc);let _0x249f95=![];for(const _0x2b1f17 of _0x456c7c){if(_0x2b1f17[_0x157ae1(0x259)]===_0x157ae1(0x237)){_0x4a3337[_0x157ae1(0x9a6)]=![];if(_0x2b1f17[_0x157ae1(0xaa7)]==='accept')_0x309acd();else{const _0x47661c={'role':'assistant','content':_0x157ae1(0xbcc),'timestamp':Date[_0x157ae1(0x606)]()};_0x181f0f['history'][_0x157ae1(0x129e)](_0x47661c),await _0x17d534['chats']['put'](_0x181f0f),_0x589d88(_0x157ae1(0xd99)),_0x359c96(_0x27c6c8);}_0x249f95=!![];break;}if(_0x2b1f17[_0x157ae1(0x259)]===_0x157ae1(0xd52)){if(_0x2b1f17[_0x157ae1(0xaa7)]==='join'){const _0x1266ca=_0x181f0f[_0x157ae1(0xfa8)][_0x157ae1(0xb07)](_0x588a9c=>_0x588a9c[_0x157ae1(0xa1)]===_0x2b1f17[_0x157ae1(0x132a)]);_0x1266ca&&!_0x4a3337[_0x157ae1(0x1008)][_0x157ae1(0x593)](_0x1ab3ff=>_0x1ab3ff['id']===_0x1266ca['id'])&&_0x4a3337[_0x157ae1(0x1008)][_0x157ae1(0x129e)](_0x1266ca);}_0x249f95=!![];}}_0x249f95&&_0x4a3337['isGroupCall']&&(_0x4a3337[_0x157ae1(0x9a6)]=![],_0x4a3337[_0x157ae1(0x1008)]['length']>0x0?_0x309acd():(_0x4a3337={..._0x4a3337,'isAwaitingResponse':![],'participants':[]},_0x589d88(_0x157ae1(0xd99)),alert(_0x157ae1(0xc7b))));}catch(_0x1d7de4){console[_0x157ae1(0xb61)](_0x157ae1(0x819),_0x1d7de4);const _0x3e8ac2=_0x181f0f[_0x157ae1(0x726)]?_0x181f0f[_0x157ae1(0xfa8)][_0x157ae1(0xbf6)](_0x35f5b0=>({'type':_0x157ae1(0xd52),'name':_0x35f5b0['originalName'],'decision':_0x157ae1(0xa61)})):[{'type':_0x157ae1(0x237),'decision':_0x157ae1(0x13f4)}];if(_0x181f0f[_0x157ae1(0x726)])_0x4a3337[_0x157ae1(0x9a6)]=![],_0x4a3337[_0x157ae1(0x1008)]=[],alert(_0x157ae1(0xc7b)),_0x589d88('chat-interface-screen');else{const _0x2a7a1a={'role':_0x157ae1(0xac3),'content':_0x157ae1(0xbcc),'timestamp':Date[_0x157ae1(0x606)]()};_0x181f0f[_0x157ae1(0x1d5)]['push'](_0x2a7a1a),await _0x17d534[_0x157ae1(0x954)][_0x157ae1(0xf3f)](_0x181f0f),_0x589d88(_0x157ae1(0xd99)),_0x359c96(_0x27c6c8);}}finally{_0x260324(_0x27c6c8,![]);return;}}if(!_0x181f0f[_0x157ae1(0x726)]&&_0x181f0f[_0x157ae1(0x569)]?.[_0x157ae1(0x13b2)]===_0x157ae1(0x11f8)){console[_0x157ae1(0x7d1)]('为角色\x20\x22'+_0x181f0f['name']+_0x157ae1(0x468));const _0x19644d=_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0xaf1)](_0x253056=>!_0x253056[_0x157ae1(0x7a0)])[_0x157ae1(0x5b0)](-0xa,-0x5)[_0x157ae1(0xbf6)](_0x3c839d=>{const _0x498639=_0x157ae1,_0x4af9ed=_0x3c839d[_0x498639(0xaeb)]==='user'?'用户':_0x181f0f[_0x498639(0x132a)];return _0x4af9ed+':\x20'+String(_0x3c839d['content'])[_0x498639(0xa6d)](0x0,0x32)+_0x498639(0x10a0);})[_0x157ae1(0x56c)]('\x0a'),_0x483035=_0x157ae1(0x477)+_0x181f0f[_0x157ae1(0x132a)]+'”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20'+_0x181f0f['settings']['aiPersona']+_0x157ae1(0xbbb)+_0x181f0f[_0x157ae1(0x569)]['applicationReason']+_0x157ae1(0xf05)+(_0x19644d||_0x157ae1(0x110c))+_0x157ae1(0x9ea);try{const _0x1476b8=[{'role':_0x157ae1(0x1370),'content':_0x483035},{'role':_0x157ae1(0xf86),'content':_0x157ae1(0xee0)}];let _0x2f1370=_0x1bedae===GEMINI_API_URL,_0x407464=_0x5d73db(_0x275b29,_0x5c5a6b,_0x483035,[{'role':'user','content':_0x157ae1(0xee0)}]);const _0xc12a33=_0x2f1370?await fetch(_0x407464[_0x157ae1(0x1377)],_0x407464[_0x157ae1(0x76b)]):await fetch(_0x1bedae+_0x157ae1(0xd7),{'method':_0x157ae1(0x1312),'headers':{'Content-Type':_0x157ae1(0xa0e),'Authorization':'Bearer\x20'+_0x5c5a6b},'body':JSON['stringify']({'model':_0x275b29,'messages':_0x1476b8,'temperature':_0x42f206['globalSettings'][_0x157ae1(0xfdf)]||0.8})});if(!_0xc12a33['ok'])throw new Error(_0x157ae1(0x7c8)+(await _0xc12a33[_0x157ae1(0xaef)]())['error'][_0x157ae1(0x7aa)]);const _0xa81ea4=await _0xc12a33[_0x157ae1(0xaef)](),_0x2ed760=getGeminiResponseText(_0xa81ea4)[_0x157ae1(0x33b)](/^```json\s*/,'')['replace'](/```$/,'')['trim'](),_0x20b455=JSON[_0x157ae1(0x44c)](_0x2ed760);if(_0x20b455[_0x157ae1(0xaa7)]==='accept'){_0x181f0f[_0x157ae1(0x569)][_0x157ae1(0x13b2)]=_0x157ae1(0xe97);const _0x1c4fd4={'role':'assistant','senderName':_0x181f0f['name'],'content':_0x20b455[_0x157ae1(0x14e)],'timestamp':Date[_0x157ae1(0x606)]()};_0x181f0f[_0x157ae1(0x1d5)]['push'](_0x1c4fd4);}else{_0x181f0f[_0x157ae1(0x569)][_0x157ae1(0x13b2)]='blocked_by_ai';const _0x43a5c2={'role':_0x157ae1(0xac3),'senderName':_0x181f0f[_0x157ae1(0x132a)],'content':_0x20b455[_0x157ae1(0x14e)],'timestamp':Date[_0x157ae1(0x606)]()};_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x129e)](_0x43a5c2);}_0x181f0f[_0x157ae1(0x569)][_0x157ae1(0x666)]='',await _0x17d534[_0x157ae1(0x954)][_0x157ae1(0xf3f)](_0x181f0f),_0x359c96(_0x27c6c8),_0x27be5e();}catch(_0xc4e2e3){_0x181f0f[_0x157ae1(0x569)]['status']=_0x157ae1(0x12b0),await _0x17d534[_0x157ae1(0x954)]['put'](_0x181f0f),await _0x34fce8(_0x157ae1(0x8ab),_0x157ae1(0x3b5)+_0xc4e2e3[_0x157ae1(0x7aa)]),_0x359c96(_0x27c6c8);}return;}let _0x4b532f='';const _0x4d49c7=new Date(),_0x5e52f1=_0x181f0f[_0x157ae1(0xda2)]['timeZone']||_0x157ae1(0x12db),_0x16fb1c=_0x4d49c7['toLocaleString']('zh-CN',{'timeZone':_0x5e52f1,'dateStyle':'full','timeStyle':_0x157ae1(0xabe)}),_0x4dc8e9=new Date(_0x4d49c7[_0x157ae1(0xe43)](_0x157ae1(0x34f),{'timeZone':_0x5e52f1})),_0x2ad79e=_0x5ecef0(_0x4dc8e9);let _0x46645e,_0x38458e;const _0x4e0003=_0x181f0f['history']['filter'](_0x3de17f=>_0x3de17f[_0x157ae1(0x7a0)])[_0x157ae1(0xdd4)]();if(_0x4e0003&&_0x4e0003[_0x157ae1(0x1316)][_0x157ae1(0xd8d)](_0x157ae1(0xb64))){const _0x49710d=await _0x17d534[_0x157ae1(0x920)][_0x157ae1(0x13c6)]('chatId')[_0x157ae1(0x7db)](_0x27c6c8)[_0x157ae1(0x794)]();if(_0x49710d&&_0x49710d[_0x157ae1(0x473)]){console[_0x157ae1(0x7d1)](_0x157ae1(0x13e8));const _0x3e100f=_0x49710d['transcript'][_0x157ae1(0xbf6)](_0x3ece5a=>{const _0x209e2d=_0x157ae1,_0x1944a5=_0x3ece5a['role']===_0x209e2d(0xf86)?_0x181f0f[_0x209e2d(0xda2)]['myNickname']||'我':_0x3ece5a[_0x209e2d(0x2a3)];return _0x1944a5+':\x20'+_0x3ece5a[_0x209e2d(0x1316)];})[_0x157ae1(0x56c)]('\x0a');_0x4b532f=_0x157ae1(0xb23)+_0x3e100f+'\x0a---\x0a';}}const _0x5eaef9=_0x1d784c(_0x2b82e3[_0x27c6c8]);let _0x1a8408='';if(_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x315)]&&_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x315)][_0x157ae1(0x131d)]>0x0){const _0x3a4e56=_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x315)][_0x157ae1(0xbf6)](_0x14b8a1=>{const _0x144f3c=_0x157ae1,_0x1c40cb=_0x42f206['worldBooks'][_0x144f3c(0xb07)](_0x3d85c2=>_0x3d85c2['id']===_0x14b8a1);if(!_0x1c40cb||!Array[_0x144f3c(0x971)](_0x1c40cb[_0x144f3c(0x1316)]))return'';const _0x217298=_0x1c40cb[_0x144f3c(0x1316)][_0x144f3c(0xaf1)](_0x4ad95b=>_0x4ad95b[_0x144f3c(0x12fb)]!==![])[_0x144f3c(0xbf6)](_0x2d6407=>{const _0x461097=_0x144f3c;let _0x57e3b='\x0a###\x20条目:\x20'+(_0x2d6407[_0x461097(0xcb4)]||_0x461097(0xfdc))+'\x0a';return _0x2d6407[_0x461097(0x634)][_0x461097(0x131d)]>0x0&&(_0x57e3b+='**关键词:**\x20'+_0x2d6407['keys'][_0x461097(0x56c)](',\x20')+'\x0a'),_0x57e3b+=_0x461097(0xcdf)+_0x2d6407['content'],_0x57e3b;})[_0x144f3c(0x56c)]('');return _0x217298?_0x144f3c(0x64a)+_0x1c40cb[_0x144f3c(0x132a)]+'\x0a'+_0x217298:'';})[_0x157ae1(0xaf1)](Boolean)[_0x157ae1(0x56c)]('');_0x3a4e56&&(_0x1a8408='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x3a4e56+_0x157ae1(0xdcc));}let _0x2b54f9='';if(_0x59377b['isActive']&&_0x59377b[_0x157ae1(0x81d)]===_0x27c6c8){const _0x3a8792=_0x59377b[_0x157ae1(0x4bd)]>-0x1?_0x59377b[_0x157ae1(0x1102)][_0x59377b['currentIndex']]:null,_0x1d7a6d=_0x59377b[_0x157ae1(0x1102)][_0x157ae1(0xbf6)](_0x41045b=>'\x22'+_0x41045b[_0x157ae1(0x132a)]+'\x22')[_0x157ae1(0x56c)](',\x20');let _0x5cb26e='';if(_0x3a8792&&_0x59377b[_0x157ae1(0x169)]&&_0x59377b[_0x157ae1(0x169)]['length']>0x0&&_0x59377b[_0x157ae1(0x1204)]>-0x1){const _0x360568=_0x59377b['parsedLyrics'][_0x59377b['currentLyricIndex']],_0x58afe6=_0x59377b[_0x157ae1(0x169)][_0x157ae1(0x5b0)](_0x59377b[_0x157ae1(0x1204)]+0x1,_0x59377b[_0x157ae1(0x1204)]+0x3);_0x5cb26e+='-\x20**当前歌词**:\x20\x22'+_0x360568[_0x157ae1(0xdd5)]+'\x22\x0a',_0x58afe6['length']>0x0&&(_0x5cb26e+=_0x157ae1(0x937)+_0x58afe6[_0x157ae1(0xbf6)](_0x27be29=>'\x22'+_0x27be29[_0x157ae1(0xdd5)]+'\x22')['join']('\x20/\x20')+'\x0a');}_0x2b54f9='\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20'+(_0x3a8792?'《'+_0x3a8792[_0x157ae1(0x132a)]+_0x157ae1(0x26d)+_0x3a8792[_0x157ae1(0xd81)]:'无')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20['+_0x1d7a6d+_0x157ae1(0x629)+_0x5cb26e+_0x157ae1(0x63d);}const _0x23d33c=parseInt(_0x181f0f[_0x157ae1(0xda2)]['maxMemory'])||0xa,_0x37d903=_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x5b0)](-_0x23d33c);let _0x41605e='';const _0x426997=_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0xc81)](_0x505968=>_0x505968[_0x157ae1(0xaeb)]===_0x157ae1(0xac3)),_0x4b1c06=_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x5b0)](_0x426997+0x1),_0x176263=_0x4b1c06[_0x157ae1(0xb07)](_0x4388bc=>_0x4388bc['type']==='share_card');if(_0x176263){const _0x54179e=_0x176263[_0x157ae1(0xdbc)],_0x93a45b=_0x54179e[_0x157ae1(0x1160)]['map'](_0x144d5b=>{const _0xcfa38e=_0x157ae1,_0x5de648=_0x144d5b['senderName']||(_0x144d5b[_0xcfa38e(0xaeb)]===_0xcfa38e(0xf86)?_0x181f0f[_0xcfa38e(0xda2)]['myNickname']||'我':_0xcfa38e(0x1291));let _0x491ae7='';if(_0x144d5b[_0xcfa38e(0x259)]===_0xcfa38e(0xefa))_0x491ae7='[语音消息:\x20'+_0x144d5b['content']+']';else{if(_0x144d5b[_0xcfa38e(0x259)]===_0xcfa38e(0xb1e))_0x491ae7=_0xcfa38e(0x140d)+_0x144d5b[_0xcfa38e(0x4e9)]+']';else{if(_0x144d5b[_0xcfa38e(0x259)]===_0xcfa38e(0xb62))_0x491ae7=_0xcfa38e(0x1ab)+_0x144d5b[_0xcfa38e(0xb55)]+']';else _0x491ae7=String(_0x144d5b[_0xcfa38e(0x1316)]);}}return _0x5de648+':\x20'+_0x491ae7;})[_0x157ae1(0x56c)]('\x0a');_0x41605e='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“'+_0x54179e[_0x157ae1(0x723)]+_0x157ae1(0x1050)+_0x93a45b+_0x157ae1(0x886);}let _0x5a165e='';const _0x271c2b=_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x912)]||0xa;if(_0x181f0f[_0x157ae1(0xda2)]['linkedMemoryChatIds']&&_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x1448)][_0x157ae1(0x131d)]>0x0){const _0x48d7c4=_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x1448)]['filter'](_0x18d67f=>_0x18d67f!==_0x27c6c8);if(_0x48d7c4[_0x157ae1(0x131d)]>0x0){const _0x16a01a=_0x48d7c4[_0x157ae1(0xbf6)](_0x1c6534=>{const _0x3a1881=_0x157ae1,_0x4a17a0=_0x42f206[_0x3a1881(0x954)][_0x1c6534];if(!_0x4a17a0)return null;const _0x395312=_0x4a17a0[_0x3a1881(0x1d5)][_0x3a1881(0x5b0)](-0x1);return{'chat':_0x4a17a0,'latestTimestamp':_0x395312?_0x395312[_0x3a1881(0xf16)]:0x0};})[_0x157ae1(0xaf1)](Boolean);_0x16a01a[_0x157ae1(0xc12)]((_0x53b4f1,_0x3cdb67)=>_0x3cdb67[_0x157ae1(0xff2)]-_0x53b4f1[_0x157ae1(0xff2)]),_0x5a165e+='\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a';for(const _0x5bf099 of _0x16a01a){const _0x206fa4=_0x5bf099[_0x157ae1(0x10f6)],_0x5a5c8e=_0x206fa4[_0x157ae1(0x726)]?_0x157ae1(0x13f3):_0x157ae1(0x35c),_0x3754b8=_0x5bf099[_0x157ae1(0xff2)]>0x0?_0x157ae1(0x7b5)+_0x1f0c92(_0x5bf099[_0x157ae1(0xff2)])+')':'';_0x5a165e+=_0x157ae1(0x1023)+_0x5a5c8e+'“'+_0x206fa4[_0x157ae1(0x132a)]+_0x157ae1(0x1342)+_0x3754b8+'\x20---\x0a';const _0x3acf40=_0x206fa4[_0x157ae1(0x1d5)]['slice'](-_0x271c2b),_0x5841a6=_0x3acf40[_0x157ae1(0xaf1)](_0x5caa43=>!String(_0x5caa43[_0x157ae1(0x1316)])[_0x157ae1(0xd8d)]('已被用户删除'));_0x5841a6['length']>0x0?_0x5841a6[_0x157ae1(0x12c2)](_0x3bb98a=>{const _0x7acdd0=_0x157ae1,_0x39024a=_0x3bb98a[_0x7acdd0(0xaeb)]==='user'?_0x206fa4[_0x7acdd0(0xda2)][_0x7acdd0(0xc7d)]||'我':_0x3bb98a[_0x7acdd0(0x2a3)]||_0x206fa4[_0x7acdd0(0x132a)];let _0x45c6ef=String(_0x3bb98a['content']);if(_0x3bb98a[_0x7acdd0(0x259)]===_0x7acdd0(0xb1e)||_0x3bb98a[_0x7acdd0(0x259)]===_0x7acdd0(0x305))_0x45c6ef=_0x7acdd0(0xf43)+_0x3bb98a[_0x7acdd0(0x1316)]+']';else _0x3bb98a['type']===_0x7acdd0(0xefa)&&(_0x45c6ef='[发送了一条语音，内容是：'+_0x3bb98a[_0x7acdd0(0x1316)]+']');const _0x4811fa=_0x1f0c92(_0x3bb98a[_0x7acdd0(0xf16)]);_0x5a165e+='('+_0x4811fa+')\x20'+_0x39024a+':\x20'+_0x45c6ef+'\x0a';}):_0x5a165e+=_0x157ae1(0x6e9);}}}console[_0x157ae1(0x7d1)]('本次发送给AI的【挂载记忆】内容如下：\x0a',_0x5a165e);if(_0x181f0f[_0x157ae1(0x726)]){let _0x5c3548='';const _0x526190=_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x912)]||0xa;if(_0x181f0f[_0x157ae1(0xda2)]['linkedMemoryChatIds']&&_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x1448)][_0x157ae1(0x131d)]>0x0){const _0x5db6cc=_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x1448)][_0x157ae1(0xaf1)](_0x28da9b=>_0x28da9b!==_0x27c6c8);if(_0x5db6cc[_0x157ae1(0x131d)]>0x0){const _0x145f85=_0x5db6cc['map'](_0x2bca77=>{const _0x1a42d9=_0x157ae1,_0x29aee0=_0x42f206['chats'][_0x2bca77];if(!_0x29aee0)return null;const _0x125f0b=_0x29aee0['history'][_0x1a42d9(0x5b0)](-0x1);return{'chat':_0x29aee0,'latestTimestamp':_0x125f0b?_0x125f0b[_0x1a42d9(0xf16)]:0x0};})[_0x157ae1(0xaf1)](Boolean);_0x145f85[_0x157ae1(0xc12)]((_0x5baf62,_0x1dfc52)=>_0x1dfc52[_0x157ae1(0xff2)]-_0x5baf62['latestTimestamp']),_0x5c3548+='\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a';for(const _0x5671ab of _0x145f85){const _0x200340=_0x5671ab[_0x157ae1(0x10f6)],_0x190e24=_0x200340['isGroup']?_0x157ae1(0x13f3):_0x157ae1(0x35c),_0x2b15cf=_0x5671ab[_0x157ae1(0xff2)]>0x0?_0x157ae1(0x7b5)+_0x1f0c92(_0x5671ab[_0x157ae1(0xff2)])+')':'';_0x5c3548+=_0x157ae1(0x1023)+_0x190e24+'“'+_0x200340['name']+_0x157ae1(0x1342)+_0x2b15cf+_0x157ae1(0xc46);const _0x1c83b1=_0x200340[_0x157ae1(0x1d5)]['slice'](-_0x526190),_0xd016e8=_0x1c83b1[_0x157ae1(0xaf1)](_0x4a5445=>!String(_0x4a5445[_0x157ae1(0x1316)])[_0x157ae1(0xd8d)](_0x157ae1(0xf9f)));_0xd016e8[_0x157ae1(0x131d)]>0x0?_0xd016e8[_0x157ae1(0x12c2)](_0x2bbd39=>{const _0xf11549=_0x157ae1,_0x5ba61c=_0x2bbd39[_0xf11549(0xaeb)]===_0xf11549(0xf86)?_0x200340[_0xf11549(0xda2)]['myNickname']||'我':_0x2bbd39[_0xf11549(0x2a3)]||_0x200340[_0xf11549(0x132a)];let _0x388e16=String(_0x2bbd39['content']);if(_0x2bbd39[_0xf11549(0x259)]==='ai_image'||_0x2bbd39[_0xf11549(0x259)]===_0xf11549(0x305))_0x388e16=_0xf11549(0xf43)+_0x2bbd39[_0xf11549(0x1316)]+']';else _0x2bbd39[_0xf11549(0x259)]===_0xf11549(0xefa)&&(_0x388e16=_0xf11549(0xc44)+_0x2bbd39[_0xf11549(0x1316)]+']');_0x5c3548+=_0x5ba61c+':\x20'+_0x388e16+'\x0a';}):_0x5c3548+=_0x157ae1(0x6e9);}}}let _0xc51ef7=_0x157ae1(0x509),_0x23bba5=![];_0x181f0f[_0x157ae1(0xfa8)][_0x157ae1(0x12c2)](_0x1b8a51=>{const _0x56683d=_0x157ae1,_0x24e8f6=_0x42f206[_0x56683d(0x954)][_0x1b8a51['id']];_0x24e8f6&&_0x24e8f6['longTermMemory']&&_0x24e8f6['longTermMemory'][_0x56683d(0x131d)]>0x0&&(_0xc51ef7+='\x0a##\x20---\x20关于“'+_0x1b8a51[_0x56683d(0x1118)]+_0x56683d(0x29d),_0xc51ef7+=_0x24e8f6[_0x56683d(0x94a)]['map'](_0x1f2cd6=>_0x56683d(0x101)+_0x1f0c92(_0x1f2cd6[_0x56683d(0xf16)])+')\x20'+_0x1f2cd6[_0x56683d(0x1316)])[_0x56683d(0x56c)]('\x0a'),_0x23bba5=!![]);});!_0x23bba5&&(_0xc51ef7+=_0x157ae1(0xb86));let _0x3c2d0e='',_0x473a85=![];if(_0x181f0f['settings'][_0x157ae1(0x219)]){const _0x290af0=_0x37d903['slice'](-0x1)[0x0];if(_0x290af0){const _0x13e41f=_0x421a56(_0x290af0[_0x157ae1(0xf16)]);_0x3c2d0e=_0x157ae1(0xee5)+_0x13e41f+'。';const _0x56c3df=(Date['now']()-_0x290af0['timestamp'])/(0x3e8*0x3c*0x3c);if(_0x56c3df>0x3){_0x473a85=!![];const _0x7b79cd=Math['floor'](_0x56c3df/0x18);_0x3c2d0e+='\x20群里已经安静了'+(_0x7b79cd>0x0?_0x7b79cd+'天':Math[_0x157ae1(0xbd5)](_0x56c3df)+'小时')+'。';}}else _0x3c2d0e=_0x157ae1(0x13e3);}const _0x47c306=await _0x17d534[_0x157ae1(0x122c)]['toArray']();let _0x19bd0c='';_0x47c306['length']>0x0&&(_0x19bd0c=_0x157ae1(0x394),_0x47c306[_0x157ae1(0x12c2)](_0x255658=>{const _0x26c573=_0x157ae1;_0x19bd0c+=_0x26c573(0x9d3)+_0x255658['id']+')\x20商品:\x20'+_0x255658['name']+_0x26c573(0xbc7)+_0x255658[_0x26c573(0x1043)][_0x26c573(0x800)](0x2)+'\x0a';}));let _0xd3261=_0x181f0f[_0x157ae1(0xfa8)][_0x157ae1(0xbf6)](_0x5dc599=>{const _0x598ac4=_0x157ae1,_0x79d596=_0x42f206[_0x598ac4(0x954)][_0x5dc599['id']];let _0x42591a='无共同好友';if(_0x79d596&&_0x79d596[_0x598ac4(0x1437)]){const _0x5e8765=Object[_0x598ac4(0x6eb)](_0x42f206[_0x598ac4(0x954)])[_0x598ac4(0xaf1)](_0x23619e=>!_0x23619e[_0x598ac4(0x726)]&&_0x23619e['id']!==_0x5dc599['id']&&_0x23619e[_0x598ac4(0x1437)]===_0x79d596[_0x598ac4(0x1437)]);_0x5e8765[_0x598ac4(0x131d)]>0x0&&(_0x42591a=_0x598ac4(0x12f)+_0x5e8765[_0x598ac4(0xbf6)](_0xe79aca=>_0xe79aca[_0x598ac4(0x132a)])[_0x598ac4(0x56c)]('、\x20'));}return _0x598ac4(0x1293)+_0x5dc599[_0x598ac4(0x1118)]+'**\x20(本名:\x20'+_0x5dc599[_0x598ac4(0xa1)]+'):\x20'+_0x5dc599[_0x598ac4(0x124d)]+_0x598ac4(0x1201)+_0x42591a+']';})[_0x157ae1(0x56c)]('\x0a');const _0x176329=_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0xc7d)]||'我',_0x6e8369=_0x42f206[_0x157ae1(0x551)][_0x157ae1(0x308)]||'{{user}}';let _0x2dba91='';const _0xff069b=(_0x181f0f['announcements']||[])[_0x157ae1(0xaf1)](_0x3215e5=>_0x3215e5['isPinned']);_0xff069b[_0x157ae1(0x131d)]>0x0&&(_0x2dba91+='\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a',_0xff069b[_0x157ae1(0x12c2)](_0x2850c1=>{const _0x245b5b=_0x157ae1,_0xd08f22=_0x181f0f['history'][_0x245b5b(0xb07)](_0x49f06b=>_0x49f06b[_0x245b5b(0xf16)]===_0x2850c1['messageTimestamp']);if(_0xd08f22){let _0x31c465=String(_0xd08f22['content']||'');_0xd08f22[_0x245b5b(0x259)]===_0x245b5b(0xb1e)&&(_0x31c465=_0x245b5b(0x5dd)+_0x31c465+']'),_0x2dba91+='-\x20公告内容:\x20\x22'+_0x31c465+_0x245b5b(0x769)+_0x2850c1[_0x245b5b(0xbaa)]+_0x245b5b(0x128f);}}),_0x2dba91+=_0x157ae1(0x8c7));const _0x14f251=_0x181f0f[_0x157ae1(0xfa8)]['map'](_0x4a4893=>_0x4a4893[_0x157ae1(0xa1)]),_0x5c5b0c=_0x157ae1(0xb91)+_0x14f251[_0x157ae1(0x56c)]('、\x20')+']';let _0x21d1c6='#\x20可用群头像列表\x0a';_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x97b)]&&_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x97b)]['length']>0x0?_0x21d1c6+=_0x181f0f[_0x157ae1(0xda2)]['groupAvatarLibrary']['map'](_0x251e4e=>'-\x20'+_0x251e4e[_0x157ae1(0x132a)])[_0x157ae1(0x56c)]('\x0a'):_0x21d1c6+=_0x157ae1(0x1f7);const _0x32acfc=_0x44f39e(_0x27c6c8),_0x1392f1=_0x492011(_0x181f0f,0x3,_0x157ae1(0xd92)),_0x242efe=_0x492011(_0x181f0f,0x6,'hours'),_0x5bb7b4=_0x492011(_0x181f0f,0x9,_0x157ae1(0xd92)),_0x52a86d=_0x492011(_0x181f0f,0x1,_0x157ae1(0x534)),_0x489b0d=_0x492011(_0x181f0f,0x3,_0x157ae1(0x534)),_0x44a277=_0x492011(_0x181f0f,0x7,_0x157ae1(0x534));let _0x4d2134='';if(_0x1392f1||_0x242efe||_0x5bb7b4||_0x52a86d||_0x489b0d||_0x44a277){_0x4d2134+='\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a';if(_0x1392f1)_0x4d2134+=_0x1392f1;if(_0x242efe)_0x4d2134+=_0x242efe;if(_0x5bb7b4)_0x4d2134+=_0x5bb7b4;if(_0x1392f1||_0x242efe||_0x5bb7b4)_0x4d2134+='\x0a';if(_0x52a86d)_0x4d2134+=_0x52a86d;if(_0x489b0d)_0x4d2134+=_0x489b0d;if(_0x44a277)_0x4d2134+=_0x44a277;}const _0xf6215a=_0x386294(_0x181f0f);_0x46645e='\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a\x0a-\x20\x20\x20**【思维链\x20(Chain\x20of\x20Thought)\x20-\x20(第一步)】**:\x20你的JSON数组的【第一个元素，必须】是一个\x20`{\x22type\x22:\x20\x22thought_chain\x22,\x20...}`\x20对象。\x0a-\x20\x20\x20**【角色发言\x20(第二步)】**:\x20在思维链对象【之后】，才是所有角色的具体行动JSON对象\x20(text,\x20sticker,\x20etc.)。\x0a\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a#\x20角色扮演核心规则\x0a\x0a1.\x20\x20**【先思后行】**:\x20在生成任何角色发言之前，你【必须】先完成“思维链”的构思。你的“思维链”必须清晰地分析用户的发言、当前的气氛，并制定出本轮的互动策略。你的所有后续发言都【必须】严格遵循你自己的策略。\x0a\x0a2.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a3.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【'+_0x176329+'】，本名是【'+_0x6e8369+'】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22'+_0x176329+'\x22\x20(用户)\x20或\x20\x22'+_0x181f0f[_0x157ae1(0x132a)]+_0x157ae1(0x1c3)+(_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x219)]?_0x157ae1(0x6dd)+_0x16fb1c+')\x20和情景的感知。'+(_0x473a85?'【重要提示】'+_0x3c2d0e+'\x20你应该让角色们主动开启新话题来打破沉默。':''):'')+_0x157ae1(0x71c)+(_0x32acfc?_0x157ae1(0x8cc)+_0x32acfc:_0x157ae1(0xe16))+'\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20表情使用指南\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20'+_0x181f0f[_0x157ae1(0x132a)]+'\x0a'+(_0x181f0f['settings'][_0x157ae1(0x219)]?_0x157ae1(0x10c1)+_0x3c2d0e:'')+_0x157ae1(0xa50)+_0xd3261+_0x157ae1(0x1244)+_0x176329+_0x157ae1(0x20a)+_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x65f)]+_0x157ae1(0xc71)+_0x1a8408+_0x157ae1(0xb57)+_0xc51ef7+'\x0a'+(_0x181f0f[_0x157ae1(0x94a)]&&_0x181f0f[_0x157ae1(0x94a)][_0x157ae1(0x131d)]>0x0?_0x181f0f[_0x157ae1(0x94a)][_0x157ae1(0xbf6)](_0x5e65c9=>'-\x20'+_0x5e65c9[_0x157ae1(0x1316)])[_0x157ae1(0x56c)]('\x0a'):_0x157ae1(0xb86))+'\x0a'+_0x4d2134+'\x0a'+_0x5c3548+'\x0a'+_0x2b54f9+'\x0a'+_0x41605e+'\x0a'+_0x21d1c6+_0x157ae1(0x101d)+_0xf6215a+'\x0a'+_0x5c5b0c+'\x0a'+_0x4b532f+'\x0a#\x20可用指令列表\x20(按需组合使用)\x0a\x0a###\x20思维链\x20(必须作为第一个元素！)\x0a-\x20\x20\x20**`{\x22type\x22:\x20\x22thought_chain\x22,\x20\x22analysis\x22:\x20\x22你对当前局势和用户上一轮发言的分析...\x22,\x20\x22strategy\x22:\x20\x22你作为导演，本轮的总体策略...\x22,\x20\x22character_thoughts\x22:\x20{\x22角色A本名\x22:\x20\x22角色A的内心活动...\x22,\x20\x22角色B本名\x22:\x20\x22角色B的内心活动...\x22}}`**\x0a\x20\x20\x20\x20-\x20\x20\x20**analysis**:\x20简要分析用户的意图或群聊的氛围。\x0a\x20\x20\x20\x20-\x20\x20\x20**strategy**:\x20你作为导演的计划（例如：让A和B互动，禁止成员总结）。\x0a\x20\x20\x20\x20-\x20\x20\x20**character_thoughts**:\x20【只包含本轮会发言的AI角色】的内心独白。\x0a\x0a\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a'+(localStorage[_0x157ae1(0x127d)](_0x157ae1(0xf42))===_0x157ae1(0x12b7)?_0x157ae1(0xfde):'')+_0x157ae1(0x1148),_0x38458e=_0x37d903[_0x157ae1(0xbf6)](_0x2f59b7=>{const _0x47518d=_0x157ae1,_0x2505d9=_0x2f59b7['role']===_0x47518d(0xf86)?_0x176329:_0x2f59b7['senderName'];let _0x55d217=''+_0x2505d9;if(_0x2f59b7['quote']){const _0x3b55f1=String(_0x2f59b7['quote'][_0x47518d(0x1316)]||'')['substring'](0x0,0x32);_0x55d217+='\x20(回复\x20'+_0x2f59b7[_0x47518d(0xb92)][_0x47518d(0x2a3)]+_0x47518d(0xcaa)+_0x3b55f1+_0x47518d(0x10c8);}_0x55d217+=':\x20';let _0x52f44f;if(_0x2f59b7['type']===_0x47518d(0x305))_0x52f44f='['+_0x2505d9+_0x47518d(0x607)+_0x2f59b7['content']+'\x27]';else{if(_0x2f59b7[_0x47518d(0x259)]==='ai_image')_0x52f44f='['+_0x2505d9+'\x20发送了一张图片，图片内容描述为：\x27'+_0x2f59b7[_0x47518d(0x1316)]+'\x27]';else{if(_0x2f59b7['type']===_0x47518d(0xb62))_0x52f44f='['+_0x2505d9+_0x47518d(0xebf)+_0x2f59b7[_0x47518d(0xb55)]+']';else{if(_0x2f59b7['type']===_0x47518d(0xefa))_0x52f44f='['+_0x2505d9+'\x20发送了一条语音，内容是：\x27'+_0x2f59b7[_0x47518d(0x1316)]+'\x27]';else{if(_0x2f59b7['type']===_0x47518d(0xf4e))_0x52f44f='['+_0x2f59b7[_0x47518d(0x2a3)]+_0x47518d(0x10e0)+_0x2f59b7['receiverName']+_0x47518d(0x1308)+_0x2f59b7[_0x47518d(0x116)]+_0x47518d(0xcf7)+_0x2f59b7[_0x47518d(0x1187)]+']';else{if(_0x2f59b7[_0x47518d(0x259)]===_0x47518d(0x7c))_0x52f44f='['+_0x2505d9+_0x47518d(0x6b6)+_0x2f59b7[_0x47518d(0x1316)]+'\x27]';else{if(_0x2f59b7[_0x47518d(0x259)]===_0x47518d(0x10c6)){const _0x302f42=_0x2f59b7[_0x47518d(0xb2d)]?_0x47518d(0xb7c)+_0x2f59b7['repostComment']+'”':'';let _0x10e262='原作者';const _0x3bf695=_0x2f59b7[_0x47518d(0x47e)][_0x47518d(0x1086)];if(_0x3bf695===_0x47518d(0xf86))_0x10e262=_0x42f206[_0x47518d(0x551)][_0x47518d(0x308)];else _0x42f206[_0x47518d(0x954)][_0x3bf695]&&(_0x10e262=_0x42f206['chats'][_0x3bf695][_0x47518d(0x132a)]);let _0x27a295;const _0xc44cfd=_0x2f59b7['originalPost'];if(_0xc44cfd[_0x47518d(0x259)]===_0x47518d(0x1237))_0x27a295=_0x47518d(0xd1d)+(_0xc44cfd['publicText']||'')+_0x47518d(0x4c2)+(_0xc44cfd[_0x47518d(0x145)]||'')[_0x47518d(0xa6d)](0x0,0x28)+_0x47518d(0xfea);else _0xc44cfd[_0x47518d(0x259)]===_0x47518d(0xe7f)?_0x27a295=_0x47518d(0x3af)+(_0xc44cfd[_0x47518d(0xd2d)]||'')+'\x20(图片描述:\x20“'+(_0xc44cfd[_0x47518d(0x343)]||'')[_0x47518d(0xa6d)](0x0,0x28)+_0x47518d(0xfea):_0x27a295='“'+(_0xc44cfd[_0x47518d(0x1316)]||'')[_0x47518d(0xa6d)](0x0,0x28)+_0x47518d(0x5b2);_0x52f44f='['+_0x2505d9+'\x20转发了\x20@'+_0x10e262+'\x20的动态\x20'+_0x302f42+_0x47518d(0xa31)+_0x27a295+'】]';}else{if(_0x2f59b7['type']===_0x47518d(0x1128))_0x2f59b7['status']===_0x47518d(0x1467)?_0x52f44f=_0x47518d(0x12ec)+_0x2f59b7[_0x47518d(0x167)]+_0x47518d(0x1216)+_0x2505d9+_0x47518d(0x1098)+_0x2f59b7[_0x47518d(0x116)]+_0x47518d(0x1ac):_0x52f44f='['+_0x2505d9+_0x47518d(0xa47)+_0x2f59b7['productInfo']+_0x47518d(0x304)+_0x2f59b7[_0x47518d(0x116)]+_0x47518d(0xae7)+_0x2f59b7[_0x47518d(0xf16)]+']';else{if(_0x2f59b7['type']==='red_packet'){const _0x3643ea=_0x2f59b7['senderName']===_0x176329?_0x47518d(0x1249)+_0x176329+')':_0x2f59b7['senderName'];let _0xc86f8c;_0x2f59b7['packetType']===_0x47518d(0x1205)?_0xc86f8c=_0x47518d(0x12ec)+_0x3643ea+_0x47518d(0x764)+_0x2f59b7[_0x47518d(0xf16)]+_0x47518d(0x13a8)+_0x2f59b7[_0x47518d(0x1421)]+'”。只有“'+_0x2f59b7[_0x47518d(0x1421)]+'”才能使用\x20\x27open_red_packet\x27\x20指令领取。]':_0xc86f8c=_0x47518d(0x12ec)+_0x3643ea+_0x47518d(0x102)+_0x2f59b7[_0x47518d(0xf16)]+_0x47518d(0xe8b)+_0x2f59b7[_0x47518d(0xf77)]+_0x47518d(0x5d2),_0x52f44f=_0xc86f8c;}else{if(_0x2f59b7[_0x47518d(0x259)]===_0x47518d(0xfb0)){const _0x4ef7ab=_0x2f59b7[_0x47518d(0xaeb)]===_0x47518d(0xf86)?_0x176329:_0x32d364(_0x181f0f,_0x2f59b7[_0x47518d(0x2a3)]),_0x38620b=_0x2f59b7[_0x47518d(0xce5)][_0x47518d(0xbf6)](_0x25e647=>_0x25e647[_0x47518d(0x132a)]+'\x20x'+_0x25e647[_0x47518d(0x177)])[_0x47518d(0x56c)]('、\x20');let _0x4fed78='';if(_0x2f59b7[_0x47518d(0xd19)]&&_0x2f59b7[_0x47518d(0xd19)][_0x47518d(0x131d)]>0x0){const _0x4cb9b6=_0x2f59b7[_0x47518d(0xd19)][_0x47518d(0xbf6)](_0x15cd70=>_0x32d364(_0x181f0f,_0x15cd70))['join']('、\x20');_0x4fed78=_0x47518d(0xcd9)+_0x4cb9b6;}else _0x4fed78=_0x47518d(0xeb7);return _0x52f44f=_0x47518d(0x12ec)+_0x4ef7ab+'\x20'+_0x4fed78+'，礼物是：'+_0x38620b+']',{'role':_0x47518d(0xf86),'content':_0x52f44f};}else{if(_0x2f59b7[_0x47518d(0x259)]===_0x47518d(0x670)){const _0x7f8dbe=Object[_0x47518d(0x6eb)](_0x2f59b7[_0x47518d(0x92)]||{})['flat']()[_0x47518d(0x56c)](',\x20')||'还没有人';_0x52f44f=_0x47518d(0x12ec)+_0x2f59b7[_0x47518d(0x2a3)]+_0x47518d(0xa26)+_0x2f59b7[_0x47518d(0xf16)]+_0x47518d(0x10ab)+_0x2f59b7[_0x47518d(0xbc9)]+_0x47518d(0xae2)+_0x2f59b7[_0x47518d(0x8e9)]['join'](',\x20')+_0x47518d(0xfb3)+_0x7f8dbe+_0x47518d(0x11dd);}else{if(_0x2f59b7[_0x47518d(0x32e)])_0x52f44f=_0x2505d9+_0x47518d(0x3e4)+_0x2f59b7[_0x47518d(0x32e)]+'\x27]';else{if(Array[_0x47518d(0x971)](_0x2f59b7[_0x47518d(0x1316)]))return{'role':_0x47518d(0xf86),'content':[..._0x2f59b7['content'],{'type':_0x47518d(0xdd5),'text':_0x55d217}]};else _0x52f44f=''+_0x55d217+_0x2f59b7[_0x47518d(0x1316)];}}}}}}}}}}}}return{'role':_0x47518d(0xf86),'content':_0x52f44f};})[_0x157ae1(0xaf1)](Boolean);}else{const _0x301051=_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x11a7)],_0x14bb33=_0x18518f(_0x181f0f);let _0x25654c='';_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x6a)]&&_0x181f0f[_0x157ae1(0xb0f)]&&!_0x301051&&(_0x25654c=_0x157ae1(0x10ee)+_0x181f0f[_0x157ae1(0xb0f)]+_0x157ae1(0xa10)+_0x181f0f['randomJottings']+'\x0a');let _0x5caef9='';const _0xf825b3=_0x181f0f['settings']['linkedMemoryCount']||0xa;if(_0x181f0f['settings']['linkedMemoryChatIds']&&_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x1448)][_0x157ae1(0x131d)]>0x0){const _0x40d830=_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x1448)][_0x157ae1(0xaf1)](_0x4072b7=>_0x4072b7!==_0x27c6c8);if(_0x40d830['length']>0x0){const _0xa785bc=_0x40d830['map'](_0x5e7557=>{const _0x1c1b6c=_0x157ae1,_0x5f2143=_0x42f206[_0x1c1b6c(0x954)][_0x5e7557];if(!_0x5f2143)return null;const _0xa77b68=_0x5f2143[_0x1c1b6c(0x1d5)][_0x1c1b6c(0x5b0)](-0x1)[0x0];return{'chat':_0x5f2143,'latestTimestamp':_0xa77b68?_0xa77b68[_0x1c1b6c(0xf16)]:0x0};})[_0x157ae1(0xaf1)](Boolean);_0xa785bc['sort']((_0xf77cfe,_0x3ed5ad)=>_0x3ed5ad[_0x157ae1(0xff2)]-_0xf77cfe['latestTimestamp']),_0x5caef9+=_0x157ae1(0x117b);for(const _0x590cf9 of _0xa785bc){const _0x366db1=_0x590cf9[_0x157ae1(0x10f6)],_0x3d737a=_0x366db1['isGroup']?_0x157ae1(0x13f3):_0x157ae1(0x35c),_0x313eee=_0x590cf9[_0x157ae1(0xff2)]>0x0?'\x20(最后互动于\x20'+_0x1f0c92(_0x590cf9[_0x157ae1(0xff2)])+')':'';_0x5caef9+=_0x157ae1(0x1023)+_0x3d737a+'“'+_0x366db1[_0x157ae1(0x132a)]+_0x157ae1(0x1342)+_0x313eee+_0x157ae1(0xc46);const _0x230a33=_0x366db1[_0x157ae1(0x1d5)][_0x157ae1(0x5b0)](-_0xf825b3),_0x1b37af=_0x230a33[_0x157ae1(0xaf1)](_0x379cbf=>!String(_0x379cbf[_0x157ae1(0x1316)])[_0x157ae1(0xd8d)]('已被用户删除'));_0x1b37af['length']>0x0?_0x1b37af[_0x157ae1(0x12c2)](_0x374642=>{const _0x22186a=_0x157ae1,_0x8ea7f8=_0x374642[_0x22186a(0xaeb)]===_0x22186a(0xf86)?_0x366db1[_0x22186a(0xda2)]['myNickname']||'我':_0x374642[_0x22186a(0x2a3)]||_0x366db1[_0x22186a(0x132a)];let _0x323b7f=String(_0x374642[_0x22186a(0x1316)]);if(_0x374642[_0x22186a(0x259)]===_0x22186a(0xb1e)||_0x374642['type']===_0x22186a(0x305))_0x323b7f=_0x22186a(0xf43)+_0x374642[_0x22186a(0x1316)]+']';else _0x374642[_0x22186a(0x259)]===_0x22186a(0xefa)&&(_0x323b7f=_0x22186a(0xc44)+_0x374642['content']+']');const _0x53844a=_0x1f0c92(_0x374642[_0x22186a(0xf16)]);_0x5caef9+='('+_0x53844a+')\x20'+_0x8ea7f8+':\x20'+_0x323b7f+'\x0a';}):_0x5caef9+=_0x157ae1(0x6e9);}}}const _0x17eedd=await _0x17d534[_0x157ae1(0x122c)][_0x157ae1(0x511)]();let _0x31ffc0='';_0x17eedd[_0x157ae1(0x131d)]>0x0&&(_0x31ffc0=_0x157ae1(0x5ba),_0x17eedd['forEach'](_0x212b23=>{const _0x4e019d=_0x157ae1;_0x31ffc0+='-\x20(ID:\x20'+_0x212b23['id']+')\x20商品:\x20'+_0x212b23[_0x4e019d(0x132a)]+_0x4e019d(0xbc7)+_0x212b23['price'][_0x4e019d(0x800)](0x2)+'\x0a';}));if(_0x301051){const _0xbacdbd=localStorage[_0x157ae1(0x127d)]('novelai-enabled')===_0x157ae1(0x12b7),_0x2010fd=_0x181f0f['settings'][_0x157ae1(0xb04)]||0x64,_0x3b2236=_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x280)]||0x12c,_0x4369da=_0x181f0f[_0x157ae1(0xda2)]['myNickname']||'我';let _0x220b6c='';if(_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0xd13)]){const _0x4baabb=_0x42f206[_0x157ae1(0x843)]['find'](_0x3e5ef2=>_0x3e5ef2['id']===_0x181f0f['settings'][_0x157ae1(0xd13)]);if(_0x4baabb&&Array[_0x157ae1(0x971)](_0x4baabb[_0x157ae1(0x1316)])){const _0x126847=_0x4baabb[_0x157ae1(0x1316)]['filter'](_0x59b984=>_0x59b984['enabled']!==![])[_0x157ae1(0xbf6)](_0x45e97b=>'-\x20'+_0x45e97b['content'])['join']('\x0a');_0x126847&&(_0x220b6c=_0x157ae1(0xd6f)+_0x126847+_0x157ae1(0xaec));}}let _0x27635e;_0xbacdbd?_0x27635e=_0x157ae1(0x186):_0x27635e='\x0a#\x20【格式铁律\x20(最高优先级：常规模式)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，即\x20`offline_text`\x20对象。\x0a2.\x20\x20**【【【绝对禁止】】】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回\x20\x22naiimag\x22\x20对象。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回纯文本（即没有JSON包装的文字）。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】在JSON数组前后添加任何\x20markdown\x20标记\x20(如\x20```json)。\x0a3.\x20\x20**【输出示例\x20(必须遵守)】**:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22offline_text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22「这是对话内容」...\x20(这里是动作和环境描写)...\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a4.\x20\x20**【内容风格\x20(offline_text)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x46645e=_0x157ae1(0xcf1)+_0x181f0f[_0x157ae1(0xa1)]+_0x157ae1(0x513)+_0x220b6c+'\x0a#\x20你的角色设定：\x0a你必须严格遵守'+_0x181f0f['settings'][_0x157ae1(0x31d)]+_0x157ae1(0xc80)+_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x65f)]+'\x0a\x0a#\x20供你参考的信息\x0a'+(_0x181f0f['settings']['enableTimePerception']?_0x157ae1(0x310)+_0x16fb1c+'\x20('+_0x2ad79e+')':'')+_0x157ae1(0x8e7)+_0x1a8408+_0x157ae1(0x1e7)+(_0x181f0f['longTermMemory']&&_0x181f0f['longTermMemory'][_0x157ae1(0x131d)]>0x0?_0x181f0f[_0x157ae1(0x94a)][_0x157ae1(0xbf6)](_0x55a0a7=>'-\x20'+_0x55a0a7[_0x157ae1(0x1316)])[_0x157ae1(0x56c)]('\x0a'):_0x157ae1(0xb86))+'\x0a\x0a'+_0x5caef9+'\x0a-\x20**你们最后的对话摘要**:\x20\x0a'+_0x37d903[_0x157ae1(0xbf6)](_0x3d600d=>{const _0x4e1f66=_0x157ae1;let _0x568a8a=(_0x3d600d['role']===_0x4e1f66(0xf86)?_0x4369da:_0x181f0f[_0x4e1f66(0x132a)])+':\x20';return _0x3d600d[_0x4e1f66(0x259)]==='offline_text'?_0x568a8a+='「'+(_0x3d600d[_0x4e1f66(0x4d9)]||'')+'」\x20'+(_0x3d600d['description']||''):_0x568a8a+=String(_0x3d600d[_0x4e1f66(0x1316)]),_0x568a8a;})[_0x157ae1(0x56c)]('\x0a')+'\x0a\x0a\x0a'+_0x27635e+_0x157ae1(0x24f)+_0x2010fd+'到'+_0x3b2236+_0x157ae1(0xb26),_0x38458e=_0x37d903[_0x157ae1(0xbf6)](_0x25799c=>{const _0x171dfd=_0x157ae1;if(_0x25799c[_0x171dfd(0x7a0)])return null;if(_0x25799c[_0x171dfd(0x259)]==='offline_text'){const _0x1cada1=_0x25799c['role']==='user'?_0x181f0f[_0x171dfd(0xda2)][_0x171dfd(0xc7d)]||'我':_0x181f0f['name'];let _0x554e0a='';if(_0x25799c[_0x171dfd(0x1316)])_0x554e0a=_0x25799c[_0x171dfd(0x1316)];else{const _0x4b5705=_0x25799c[_0x171dfd(0x4d9)]?'「'+_0x25799c[_0x171dfd(0x4d9)]+'」':'',_0x4db303=_0x25799c['description']?'('+_0x25799c[_0x171dfd(0x4e9)]+')':'';_0x554e0a=(_0x4b5705+'\x20'+_0x4db303)['trim']();}return{'role':_0x25799c[_0x171dfd(0xaeb)],'content':_0x1cada1+':\x20'+_0x554e0a};}if(_0x25799c[_0x171dfd(0xaeb)]===_0x171dfd(0xf86)){const _0x2cafb3=_0x4369da+':\x20';let _0x159cad='';if(Array['isArray'](_0x25799c[_0x171dfd(0x1316)])&&_0x25799c[_0x171dfd(0x1316)][0x0]?.[_0x171dfd(0x259)]==='image_url')return{'role':_0x171dfd(0xf86),'content':[{'type':'text','text':_0x2cafb3},..._0x25799c[_0x171dfd(0x1316)]]};if(_0x25799c[_0x171dfd(0xb92)]){const _0x28546e=String(_0x25799c[_0x171dfd(0xb92)][_0x171dfd(0x1316)]||'')[_0x171dfd(0xa6d)](0x0,0x32);_0x159cad+=_0x171dfd(0x5b3)+_0x25799c['quote'][_0x171dfd(0x2a3)]+_0x171dfd(0xcaa)+_0x28546e+_0x171dfd(0x1310)+_0x25799c[_0x171dfd(0x1316)];}else _0x159cad+=_0x25799c[_0x171dfd(0x1316)];if(_0x25799c[_0x171dfd(0x259)]==='user_photo')return{'role':_0x171dfd(0xf86),'content':_0x2cafb3+'[你发送了一张需要AI识别的图片，图片内容是：\x27'+_0x25799c[_0x171dfd(0x1316)]+'\x27]'};if(_0x25799c['type']===_0x171dfd(0xefa))return{'role':_0x171dfd(0xf86),'content':_0x2cafb3+_0x171dfd(0x1060)+_0x25799c[_0x171dfd(0x1316)]+'\x27]'};if(_0x25799c[_0x171dfd(0x259)]===_0x171dfd(0xf4e))return{'role':_0x171dfd(0xf86),'content':_0x2cafb3+'[系统提示：你于时间戳\x20'+_0x25799c[_0x171dfd(0xf16)]+_0x171dfd(0x5f6)+_0x25799c['amount']+_0x171dfd(0xcf7)+_0x25799c['note']+'。等待对方处理。]'};if(_0x25799c[_0x171dfd(0x259)]===_0x171dfd(0x1128))return{'role':_0x171dfd(0xf86),'content':_0x2cafb3+_0x171dfd(0xe32)+_0x25799c[_0x171dfd(0xf16)]+_0x171dfd(0xa47)+_0x25799c[_0x171dfd(0xaed)]+'”，金额是\x20'+_0x25799c['amount']+'\x20元。]'};else{if(_0x25799c[_0x171dfd(0x259)]==='gift'){const _0x249968=_0x25799c[_0x171dfd(0xce5)][_0x171dfd(0xbf6)](_0x480d35=>_0x480d35[_0x171dfd(0x132a)]+'\x20x'+_0x480d35[_0x171dfd(0x177)])[_0x171dfd(0x56c)]('、\x20');let _0x16cc44=_0x181f0f[_0x171dfd(0x726)]?_0x171dfd(0xcd9)+_0x25799c[_0x171dfd(0xd19)][_0x171dfd(0xbf6)](_0x1856e2=>_0x32d364(_0x181f0f,_0x1856e2))[_0x171dfd(0x56c)]('、\x20'):_0x171dfd(0xcd9)+_0x181f0f[_0x171dfd(0x132a)];return{'role':'user','content':_0x2cafb3+_0x171dfd(0x13fc)+_0x16cc44+_0x171dfd(0x54a)+_0x249968+']'};}}if(_0x25799c[_0x171dfd(0x32e)])return{'role':_0x171dfd(0xf86),'content':_0x2cafb3+_0x171dfd(0x1d2)+_0x25799c[_0x171dfd(0x32e)]+'\x27]'};return{'role':_0x25799c[_0x171dfd(0xaeb)],'content':_0x2cafb3+_0x159cad};}else{if(_0x25799c[_0x171dfd(0xaeb)]===_0x171dfd(0xac3)){let _0x324970={'type':_0x25799c[_0x171dfd(0x259)]||_0x171dfd(0xdd5)};if(_0x25799c[_0x171dfd(0x259)]===_0x171dfd(0x869))_0x324970[_0x171dfd(0x1377)]=_0x25799c[_0x171dfd(0x1316)],_0x324970[_0x171dfd(0x32e)]=_0x25799c[_0x171dfd(0x32e)];else{if(_0x25799c['type']==='transfer')_0x324970[_0x171dfd(0x116)]=_0x25799c[_0x171dfd(0x116)],_0x324970[_0x171dfd(0x1187)]=_0x25799c['note'];else _0x25799c['type']===_0x171dfd(0x1128)?(_0x324970[_0x171dfd(0xaed)]=_0x25799c[_0x171dfd(0xaed)],_0x324970[_0x171dfd(0x116)]=_0x25799c[_0x171dfd(0x116)]):_0x25799c[_0x171dfd(0xb92)]?_0x324970[_0x171dfd(0xf44)]={'target_sender':_0x25799c[_0x171dfd(0xb92)][_0x171dfd(0x2a3)],'target_content':_0x25799c[_0x171dfd(0xb92)]['content'],'reply_content':_0x25799c[_0x171dfd(0x1316)]}:_0x324970[_0x171dfd(0x1316)]=_0x25799c['content'];}const _0x193da6=JSON['stringify']([_0x324970]);return{'role':_0x171dfd(0xac3),'content':_0x171dfd(0x1084)+_0x25799c[_0x171dfd(0xf16)]+')\x20'+_0x193da6};}}return null;})['filter'](Boolean);}else{let _0x1fdac0='';_0x181f0f[_0x157ae1(0x103)]&&_0x181f0f[_0x157ae1(0x103)][_0x157ae1(0x131d)]>0x0&&(_0x1fdac0=_0x157ae1(0x527)+_0x181f0f['nameHistory'][_0x157ae1(0x56c)](',\x20')+_0x157ae1(0x223));let _0x1304c8='';const _0x583923=_0x42f206[_0x157ae1(0x551)]['nickname']||'用户';_0x1304c8+=_0x157ae1(0x11e9)+_0x583923+'\x22。\x0a';const _0x464a87=Object['values'](_0x42f206['chats']),_0x4582f0=_0x464a87[_0x157ae1(0xaf1)](_0x499968=>_0x499968[_0x157ae1(0x726)]&&_0x499968[_0x157ae1(0xfa8)]['some'](_0x29eb1c=>_0x29eb1c['id']===_0x181f0f['id']));_0x4582f0[_0x157ae1(0x131d)]>0x0&&(_0x1304c8+=_0x157ae1(0x1379),_0x4582f0[_0x157ae1(0x12c2)](_0x118cf6=>{const _0x45bded=_0x157ae1,_0x20c350=_0x118cf6[_0x45bded(0xda2)][_0x45bded(0xc7d)]||_0x583923;_0x1304c8+=_0x45bded(0x2ae)+_0x118cf6['name']+_0x45bded(0xc31)+_0x20c350+_0x45bded(0x198);}));_0x1304c8+='当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。';let _0x4c1646='';const _0x24f76e=_0x464a87['filter'](_0x4c9d6d=>!_0x4c9d6d[_0x157ae1(0x726)]&&_0x4c9d6d['id']!==_0x181f0f['id']&&_0x4c9d6d[_0x157ae1(0x1437)]===_0x181f0f[_0x157ae1(0x1437)]&&_0x181f0f[_0x157ae1(0x1437)]!==null);_0x24f76e[_0x157ae1(0x131d)]>0x0&&(_0x4c1646+='\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a',_0x24f76e[_0x157ae1(0x12c2)](_0x2329d6=>{const _0x5bed60=_0x157ae1;_0x4c1646+=_0x5bed60(0xc98)+_0x2329d6[_0x5bed60(0x132a)]+_0x5bed60(0x83f)+_0x2329d6[_0x5bed60(0xa1)]+')\x0a';}));const _0x4eac59=await _0x17d534['qzonePosts'][_0x157ae1(0x50b)]('timestamp')[_0x157ae1(0x115b)]()[_0x157ae1(0xeb4)](0xa)[_0x157ae1(0x511)](),_0x5d05d9=_0x40b385(_0x4eac59,_0x181f0f);let _0x25dde8='';if(_0x5d05d9['length']>0x0){_0x25dde8=_0x157ae1(0x13b6);const _0x1503d2=_0x181f0f['originalName'];for(const _0x59cab4 of _0x5d05d9){let _0x25b041;if(_0x59cab4['authorId']===_0x157ae1(0xf86))_0x25b041=_0x42f206[_0x157ae1(0x551)]['nickname'];else{if(String(_0x59cab4[_0x157ae1(0x1086)])[_0x157ae1(0x13ad)](_0x157ae1(0xa45)))_0x25b041=_0x59cab4[_0x157ae1(0xb85)]||_0x157ae1(0x10bc);else{const _0x418216=_0x42f206['chats'][_0x59cab4['authorId']];_0x25b041=_0x418216?_0x418216[_0x157ae1(0x132a)]:'一位朋友';}}if(_0x59cab4[_0x157ae1(0x1086)]===_0x27c6c8)_0x25b041+=_0x157ae1(0xbc1);let _0x22a7f0;if(_0x59cab4[_0x157ae1(0x259)]===_0x157ae1(0x10c6)){const _0x549bdb=_0x59cab4[_0x157ae1(0xb2d)]?'并评论说：\x22'+_0x59cab4[_0x157ae1(0xb2d)]+'\x22':'';let _0x20e517='原作者';const _0x398a64=_0x59cab4['originalPost'][_0x157ae1(0x1086)];if(_0x398a64==='user')_0x20e517=_0x42f206[_0x157ae1(0x551)]['nickname'];else _0x42f206[_0x157ae1(0x954)][_0x398a64]&&(_0x20e517=_0x42f206[_0x157ae1(0x954)][_0x398a64][_0x157ae1(0x132a)]);let _0x2bdf9c;const _0x32e989=_0x59cab4[_0x157ae1(0x47e)];if(_0x32e989['type']==='text_image')_0x2bdf9c=_0x157ae1(0xd1d)+(_0x32e989[_0x157ae1(0xd2d)]||'')+'\x20(图片描述:\x20\x22'+(_0x32e989['hiddenContent']||'')['substring'](0x0,0x28)+'...\x22)';else _0x32e989['type']==='image_post'?_0x2bdf9c=_0x157ae1(0x3af)+(_0x32e989[_0x157ae1(0xd2d)]||'')+'\x20(图片描述:\x20\x22'+(_0x32e989['imageDescription']||'')['substring'](0x0,0x28)+_0x157ae1(0x10c8):_0x2bdf9c='\x22'+(_0x32e989[_0x157ae1(0x1316)]||'')['substring'](0x0,0x28)+_0x157ae1(0x7a2);_0x22a7f0=_0x157ae1(0x1144)+_0x20e517+'\x20的动态\x20'+_0x549bdb+_0x157ae1(0xa31)+_0x2bdf9c+'】';}else{if(_0x59cab4[_0x157ae1(0x259)]===_0x157ae1(0x1237))_0x22a7f0=(_0x157ae1(0x27b)+_0x59cab4['hiddenContent']+_0x157ae1(0x1bf)+(_0x59cab4[_0x157ae1(0xd2d)]||''))['substring'](0x0,0x32)+'...';else{if(_0x59cab4[_0x157ae1(0x259)]==='image_post')_0x22a7f0=(_0x157ae1(0x41d)+_0x59cab4['imageDescription']+_0x157ae1(0x1bf)+(_0x59cab4[_0x157ae1(0xd2d)]||''))['substring'](0x0,0x32)+_0x157ae1(0x10a0);else{if(_0x59cab4['type']===_0x157ae1(0xb62)&&_0x59cab4[_0x157ae1(0xb55)]){const _0x4c686f=Array[_0x157ae1(0x971)](_0x59cab4['prompt'])?_0x59cab4['prompt']:[_0x59cab4[_0x157ae1(0xb55)]];_0x22a7f0=(_0x59cab4[_0x157ae1(0xd2d)]||'')+(_0x157ae1(0x136b)+_0x4c686f['length']+_0x157ae1(0xc96)+_0x4c686f[_0x157ae1(0x56c)](',\x20')+']');}else _0x22a7f0=String(_0x59cab4[_0x157ae1(0xd2d)]||_0x59cab4[_0x157ae1(0x1316)]||_0x157ae1(0x756))[_0x157ae1(0xa6d)](0x0,0x32)+_0x157ae1(0x10a0);}}}_0x25dde8+='-\x20(ID:\x20'+_0x59cab4['id']+')\x20作者:\x20'+_0x25b041+_0x157ae1(0x877)+_0x22a7f0+'\x22\x0a';if(_0x59cab4[_0x157ae1(0x946)]&&_0x59cab4[_0x157ae1(0x946)][_0x157ae1(0x131d)]>0x0)for(const _0x517f55 of _0x59cab4[_0x157ae1(0x946)]){if(typeof _0x517f55==='object'&&_0x517f55[_0x157ae1(0x7a7)]){const _0x27701e=_0x4e0b74(_0x517f55['commenterName']);let _0x3affcc=_0x517f55['meaning']?'[表情:\x20\x27'+_0x517f55[_0x157ae1(0x32e)]+'\x27]':_0x517f55[_0x157ae1(0xdd5)];_0x517f55['commenterName']===_0x1503d2?_0x25dde8+='\x20\x20-\x20你评论说:\x20'+_0x3affcc+'\x0a':_0x25dde8+=_0x157ae1(0x52c)+_0x27701e+'\x20(本名:\x20'+_0x517f55['commenterName']+_0x157ae1(0x352)+_0x3affcc+'\x0a';}}}}const _0x20165e=_0x181f0f['settings']['myNickname']||'我';let _0x4071ae='',_0x3fafd0=![];if(_0x181f0f['settings']['enableTimePerception']){const _0xb5596d=_0x37d903['findLast'](_0xfb2448=>_0xfb2448[_0x157ae1(0xaeb)]===_0x157ae1(0xf86)&&!_0xfb2448['isHidden']),_0x520223=_0x37d903['findLast'](_0x526694=>_0x526694[_0x157ae1(0xaeb)]===_0x157ae1(0xac3)&&!_0x526694['isHidden']);if(_0xb5596d){const _0x47aa5f=_0x421a56(_0xb5596d[_0x157ae1(0xf16)]);if(_0x520223){const _0x34b30b=_0x421a56(_0x520223[_0x157ae1(0xf16)]);_0x4071ae=_0x157ae1(0xe17)+_0x34b30b+'，用户刚刚在\x20'+_0x47aa5f+'\x20回复了你。';const _0x2ac047=(_0xb5596d[_0x157ae1(0xf16)]-_0x520223[_0x157ae1(0xf16)])/(0x3e8*0x3c*0x3c);if(_0x2ac047>0x3){_0x3fafd0=!![];const _0x5c437a=Math[_0x157ae1(0xbd5)](_0x2ac047/0x18);_0x4071ae+=_0x157ae1(0x112a)+(_0x5c437a>0x0?_0x5c437a+'天':Math[_0x157ae1(0xbd5)](_0x2ac047)+'小时')+_0x157ae1(0x856)+_0x2ad79e+_0x157ae1(0x277);}}else _0x4071ae=_0x157ae1(0x42a)+_0x47aa5f+'。';}else _0x4071ae='-\x20**对话状态**:\x20(暂无有效对话历史)';}const _0x2a0416=_0x44f39e(_0x27c6c8),_0x34c2e3=_0x492011(_0x181f0f,0x3,_0x157ae1(0xd92)),_0x3ddddf=_0x492011(_0x181f0f,0x6,_0x157ae1(0xd92)),_0x262c15=_0x492011(_0x181f0f,0x9,_0x157ae1(0xd92)),_0x343dd3=_0x492011(_0x181f0f,0x1,_0x157ae1(0x534)),_0x272cc3=_0x492011(_0x181f0f,0x3,'days'),_0x35dc3d=_0x492011(_0x181f0f,0x7,_0x157ae1(0x534));let _0x2d4f4d='';if(_0x34c2e3||_0x3ddddf||_0x262c15||_0x343dd3||_0x272cc3||_0x35dc3d){_0x2d4f4d+=_0x157ae1(0x592);if(_0x34c2e3)_0x2d4f4d+=_0x34c2e3;if(_0x3ddddf)_0x2d4f4d+=_0x3ddddf;if(_0x262c15)_0x2d4f4d+=_0x262c15;if(_0x34c2e3||_0x3ddddf||_0x262c15)_0x2d4f4d+='\x0a';if(_0x343dd3)_0x2d4f4d+=_0x343dd3;if(_0x272cc3)_0x2d4f4d+=_0x272cc3;if(_0x35dc3d)_0x2d4f4d+=_0x35dc3d;}_0x46645e=_0x157ae1(0x552)+_0x181f0f[_0x157ae1(0xa1)]+'”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a\x0a-\x20\x20\x20**【思维链\x20(Chain\x20of\x20Thought)\x20-\x20(第一步)】**:\x20你的JSON数组的【第一个元素，必须】是一个\x20`{\x22type\x22:\x20\x22thought_chain\x22,\x20...}`\x20对象。\x0a-\x20\x20\x20**【角色发言\x20(第二步)】**:\x20在思维链对象【之后】，才是你的具体行动JSON对象\x20(text,\x20sticker,\x20etc.)。\x0a\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【先思后行】**:\x20在生成任何发言之前，你【必须】先完成“思维链”的构思。你的“思维链”必须清晰地分析用户的发言、当前的气氛，并制定出本轮的互动策略。你的所有后续发言都【必须】严格遵循你自己的策略。\x0a2.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-10条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性，尽量让你的表情丰富多样，避免重复。。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20你的角色设定\x0a你必须严格遵守'+_0x181f0f['settings'][_0x157ae1(0x31d)]+'\x0a'+_0x25654c+'\x0a#\x20对话者的角色设定\x0a'+_0x181f0f[_0x157ae1(0xda2)]['myPersona']+_0x157ae1(0x145d)+(_0x181f0f['settings'][_0x157ae1(0x219)]?'-\x20**当前时间**:\x20'+_0x16fb1c+'\x20('+_0x2ad79e+')':'')+'\x0a'+_0x4071ae+'\x0a#\x20世界观\x20(必须严格遵守)\x0a'+_0x1a8408+'\x0a'+_0x5caef9+_0x157ae1(0x1303)+(_0x181f0f[_0x157ae1(0x94a)]&&_0x181f0f[_0x157ae1(0x94a)][_0x157ae1(0x131d)]>0x0?_0x181f0f[_0x157ae1(0x94a)][_0x157ae1(0xbf6)](_0xf269f5=>'-\x20'+_0xf269f5[_0x157ae1(0x1316)])['join']('\x0a'):'-\x20(暂无)')+'\x0a'+_0x2d4f4d+_0x157ae1(0x862)+_0x181f0f['originalName']+'\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22'+_0x181f0f[_0x157ae1(0x132a)]+_0x157ae1(0x7d8)+_0x20165e+_0x157ae1(0xbee)+_0x1304c8+_0x157ae1(0x104c)+_0x1fdac0+_0x157ae1(0x101d)+_0x14bb33+'\x0a'+_0x41605e+'\x0a'+_0x4b532f+_0x157ae1(0xa55)+_0x4c1646+'\x0a'+_0x25dde8+_0x157ae1(0xdcd)+(_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x219)]?_0x157ae1(0x61b)+_0x16fb1c+'\x20('+_0x2ad79e+_0x157ae1(0xf9c):'')+_0x157ae1(0x2d0)+(_0x2b54f9?_0x157ae1(0x1109)+_0x2b54f9:_0x157ae1(0xfa1))+'\x0a\x20\x20\x20\x20-\x20**读书**:\x20'+(_0x2a0416?'你们正在一起读书。'+_0x2a0416:'你们没有在读书。')+'\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20'+(_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x5d3)]&&_0x181f0f['settings'][_0x157ae1(0x5d3)][_0x157ae1(0x131d)]>0x0?_0x181f0f['settings'][_0x157ae1(0x5d3)]['map'](_0x34b6ec=>'-\x20'+_0x34b6ec[_0x157ae1(0x132a)])[_0x157ae1(0x56c)]('\x0a'):'-\x20(空)')+_0x157ae1(0x3fc)+(_0x181f0f['settings'][_0x157ae1(0x22c)]&&_0x181f0f['settings'][_0x157ae1(0x22c)][_0x157ae1(0x131d)]>0x0?_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x22c)][_0x157ae1(0xbf6)](_0x555446=>'-\x20'+_0x555446[_0x157ae1(0x132a)])[_0x157ae1(0x56c)]('\x0a'):_0x157ae1(0x1024))+'\x0a-\x20\x20\x20**五子棋局势**:\x20'+_0x5eaef9+_0x157ae1(0xa60)+_0x181f0f['originalName']+_0x157ae1(0x13fb)+_0x181f0f[_0x157ae1(0xa1)]+_0x157ae1(0x12f2)+(localStorage[_0x157ae1(0x127d)](_0x157ae1(0xf42))===_0x157ae1(0x12b7)?_0x157ae1(0xf89):'')+_0x157ae1(0x842)+(localStorage[_0x157ae1(0x127d)](_0x157ae1(0xf42))===_0x157ae1(0x12b7)?_0x157ae1(0x8c4):'')+_0x157ae1(0x7fa)+_0x181f0f[_0x157ae1(0xa1)]+'\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22'+_0x181f0f['originalName']+_0x157ae1(0x1fb)+_0x181f0f[_0x157ae1(0xa1)]+'\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22'+_0x181f0f['originalName']+_0x157ae1(0x20f),_0x38458e=_0x37d903['map'](_0x52a010=>{const _0x233d39=_0x157ae1;if(_0x52a010[_0x233d39(0x7a0)]&&_0x52a010[_0x233d39(0xaeb)]===_0x233d39(0x1370))return{'role':_0x233d39(0xf86),'content':_0x52a010[_0x233d39(0x1316)]};else{if(_0x52a010['isHidden'])return null;}if(_0x52a010['type']==='offline_text'){const _0x5a14b4=_0x52a010['role']===_0x233d39(0xf86)?_0x181f0f[_0x233d39(0xda2)][_0x233d39(0xc7d)]||'我':_0x181f0f[_0x233d39(0x132a)];let _0x509bd5='';if(_0x52a010[_0x233d39(0x1316)])_0x509bd5=_0x52a010[_0x233d39(0x1316)];else{const _0x3d510e=_0x52a010[_0x233d39(0x4d9)]?'「'+_0x52a010[_0x233d39(0x4d9)]+'」':'',_0x5937d3=_0x52a010[_0x233d39(0x4e9)]?'('+_0x52a010[_0x233d39(0x4e9)]+')':'';_0x509bd5=(_0x3d510e+'\x20'+_0x5937d3)['trim']();}return{'role':_0x52a010[_0x233d39(0xaeb)],'content':_0x233d39(0x1084)+_0x52a010[_0x233d39(0xf16)]+')\x20'+_0x5a14b4+':\x20'+_0x509bd5};}if(_0x52a010[_0x233d39(0xaeb)]===_0x233d39(0xf86)){const _0x1cfe53='(Timestamp:\x20'+_0x52a010[_0x233d39(0xf16)]+')\x20';let _0x1589e7='';if(Array[_0x233d39(0x971)](_0x52a010[_0x233d39(0x1316)])&&_0x52a010['content'][0x0]?.[_0x233d39(0x259)]===_0x233d39(0x1072))return{'role':_0x233d39(0xf86),'content':[{'type':_0x233d39(0xdd5),'text':_0x1cfe53},..._0x52a010['content']]};if(_0x52a010[_0x233d39(0xb92)]){const _0x120f65=String(_0x52a010[_0x233d39(0xb92)]['content']||'')[_0x233d39(0xa6d)](0x0,0x32);_0x1589e7+='(回复\x20'+_0x52a010[_0x233d39(0xb92)][_0x233d39(0x2a3)]+'\x20的消息:\x20\x22'+_0x120f65+_0x233d39(0x1310)+_0x52a010['content'];}else _0x1589e7+=_0x52a010[_0x233d39(0x1316)];if(_0x52a010['type']===_0x233d39(0x305))return{'role':_0x233d39(0xf86),'content':_0x1cfe53+_0x233d39(0x159)+_0x52a010[_0x233d39(0x1316)]+'\x27]'};if(_0x52a010[_0x233d39(0x259)]===_0x233d39(0xefa))return{'role':_0x233d39(0xf86),'content':_0x1cfe53+_0x233d39(0x1060)+_0x52a010[_0x233d39(0x1316)]+'\x27]'};if(_0x52a010[_0x233d39(0x259)]==='transfer')return{'role':'user','content':_0x1cfe53+_0x233d39(0xe32)+_0x52a010['timestamp']+_0x233d39(0x5f6)+_0x52a010['amount']+_0x233d39(0xcf7)+_0x52a010[_0x233d39(0x1187)]+_0x233d39(0xb7b)};if(_0x52a010[_0x233d39(0x259)]===_0x233d39(0x1128))return{'role':_0x233d39(0xf86),'content':_0x1cfe53+'[系统提示：你于时间戳\x20'+_0x52a010['timestamp']+_0x233d39(0xa47)+_0x52a010['productInfo']+'”，金额是\x20'+_0x52a010[_0x233d39(0x116)]+_0x233d39(0x4ec)};else{if(_0x52a010['type']==='gift'){const _0x4b88eb=_0x52a010[_0x233d39(0xce5)][_0x233d39(0xbf6)](_0xda01dc=>_0xda01dc[_0x233d39(0x132a)]+'\x20x'+_0xda01dc[_0x233d39(0x177)])['join']('、\x20');let _0x119010=_0x181f0f[_0x233d39(0x726)]?_0x233d39(0xcd9)+_0x52a010[_0x233d39(0xd19)][_0x233d39(0xbf6)](_0x2ba521=>_0x32d364(_0x181f0f,_0x2ba521))['join']('、\x20'):_0x233d39(0xcd9)+_0x181f0f[_0x233d39(0x132a)];return{'role':_0x233d39(0xf86),'content':_0x1cfe53+'[系统提示：你\x20'+_0x119010+'，礼物是：'+_0x4b88eb+']'};}}if(_0x52a010['meaning'])return{'role':_0x233d39(0xf86),'content':_0x1cfe53+_0x233d39(0x1d2)+_0x52a010[_0x233d39(0x32e)]+'\x27]'};return{'role':_0x52a010['role'],'content':_0x1cfe53+_0x1589e7};}else{if(_0x52a010[_0x233d39(0xaeb)]==='assistant'){let _0x33afcc={'type':_0x52a010['type']||'text'};if(_0x52a010[_0x233d39(0x259)]===_0x233d39(0x869))_0x33afcc[_0x233d39(0x1377)]=_0x52a010[_0x233d39(0x1316)],_0x33afcc[_0x233d39(0x32e)]=_0x52a010['meaning'];else{if(_0x52a010[_0x233d39(0x259)]===_0x233d39(0xf4e))_0x33afcc[_0x233d39(0x116)]=_0x52a010[_0x233d39(0x116)],_0x33afcc['note']=_0x52a010[_0x233d39(0x1187)];else _0x52a010['type']===_0x233d39(0x1128)?(_0x33afcc[_0x233d39(0xaed)]=_0x52a010[_0x233d39(0xaed)],_0x33afcc[_0x233d39(0x116)]=_0x52a010[_0x233d39(0x116)]):_0x52a010[_0x233d39(0xb92)]?_0x33afcc[_0x233d39(0xf44)]={'target_sender':_0x52a010[_0x233d39(0xb92)]['senderName'],'target_content':_0x52a010[_0x233d39(0xb92)][_0x233d39(0x1316)],'reply_content':_0x52a010[_0x233d39(0x1316)]}:_0x33afcc[_0x233d39(0x1316)]=_0x52a010[_0x233d39(0x1316)];}const _0x2bf16f=JSON[_0x233d39(0xc04)]([_0x33afcc]);return{'role':_0x233d39(0xac3),'content':_0x233d39(0x1084)+_0x52a010[_0x233d39(0xf16)]+')\x20'+_0x2bf16f};}}return null;})[_0x157ae1(0xaf1)](Boolean);if(!_0x181f0f[_0x157ae1(0x726)]&&_0x181f0f[_0x157ae1(0x569)]?.[_0x157ae1(0x13b2)]==='pending_ai_approval'){const _0x5c075d=_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0xaf1)](_0x47afa0=>!_0x47afa0[_0x157ae1(0x7a0)])['slice'](-0xa)[_0x157ae1(0xbf6)](_0x3beba8=>{const _0x38bebf=_0x157ae1,_0x2469cc=_0x3beba8[_0x38bebf(0xaeb)]===_0x38bebf(0xf86)?'用户':_0x181f0f[_0x38bebf(0x132a)];return _0x2469cc+':\x20'+String(_0x3beba8['content'])[_0x38bebf(0xa6d)](0x0,0x32)+'...';})[_0x157ae1(0x56c)]('\x0a'),_0x1bc966={'role':_0x157ae1(0xf86),'content':_0x157ae1(0x926)+_0x181f0f['relationship']['applicationReason']+_0x157ae1(0x987)+_0x5c075d+_0x157ae1(0x166)};_0x38458e['push'](_0x1bc966);}}}let _0x253b75=_0x1bedae===GEMINI_API_URL,_0x3337c1=_0x5d73db(_0x275b29,_0x5c5a6b,_0x46645e,_0x38458e),_0xcda9ca;try{_0xcda9ca=_0x253b75?await fetch(_0x3337c1['url'],_0x3337c1['data']):await fetch(_0x1bedae+_0x157ae1(0xd7),{'method':_0x157ae1(0x1312),'headers':{'Content-Type':'application/json','Authorization':_0x157ae1(0x8aa)+_0x5c5a6b},'body':JSON[_0x157ae1(0xc04)]({'model':_0x275b29,'messages':[{'role':_0x157ae1(0x1370),'content':_0x46645e},..._0x38458e],'temperature':_0x42f206['globalSettings'][_0x157ae1(0xfdf)]||0.8,'stream':![]})});}catch(_0x1e821d){throw new Error(_0x157ae1(0x1203)+_0x1e821d['message']);}if(!_0xcda9ca['ok']){let _0x13c3eb=_0x157ae1(0xbb0)+_0xcda9ca[_0x157ae1(0x13b2)]+'\x20'+_0xcda9ca[_0x157ae1(0xf0c)];try{const _0xe37d2c=await _0xcda9ca[_0x157ae1(0xaef)]();_0xe37d2c['error']&&_0xe37d2c[_0x157ae1(0xb61)][_0x157ae1(0x7aa)]?_0x13c3eb+=_0x157ae1(0x7da)+_0xe37d2c[_0x157ae1(0xb61)][_0x157ae1(0x7aa)]:_0x13c3eb+=_0x157ae1(0x7da)+JSON['stringify'](_0xe37d2c);}catch(_0x4a7e29){_0x13c3eb+=_0x157ae1(0x46d)+await _0xcda9ca[_0x157ae1(0xdd5)]();}throw new Error(_0x13c3eb);}const _0x5946a1=await _0xcda9ca[_0x157ae1(0xaef)](),_0x12f939=getGeminiResponseText(_0x5946a1);lastRawAiResponse=_0x12f939,lastResponseTimestamps=[],_0x181f0f[_0x157ae1(0x1d5)]=_0x181f0f[_0x157ae1(0x1d5)]['filter'](_0x2a897d=>!_0x2a897d['isTemporary']);const _0x1918ac=_0x418096(_0x12f939);let _0x294a2b=[];if(_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x11a7)]){let _0x58b0b1={'content':[],'dialogue':[],'description':[]};for(const _0x2339c4 of _0x1918ac){if(_0x2339c4[_0x157ae1(0x259)]===_0x157ae1(0x22b)){if(_0x2339c4['content'])_0x58b0b1[_0x157ae1(0x1316)][_0x157ae1(0x129e)](_0x2339c4[_0x157ae1(0x1316)]);else{if(_0x2339c4[_0x157ae1(0x4d9)])_0x58b0b1[_0x157ae1(0x4d9)][_0x157ae1(0x129e)](_0x2339c4[_0x157ae1(0x4d9)]);if(_0x2339c4[_0x157ae1(0x4e9)])_0x58b0b1[_0x157ae1(0x4e9)][_0x157ae1(0x129e)](_0x2339c4['description']);}}else(_0x58b0b1['content'][_0x157ae1(0x131d)]>0x0||_0x58b0b1['dialogue'][_0x157ae1(0x131d)]>0x0||_0x58b0b1[_0x157ae1(0x4e9)][_0x157ae1(0x131d)]>0x0)&&(_0x58b0b1[_0x157ae1(0x1316)][_0x157ae1(0x131d)]>0x0&&_0x294a2b['push']({'type':_0x157ae1(0x22b),'content':_0x58b0b1[_0x157ae1(0x1316)][_0x157ae1(0x56c)]('\x0a')}),(_0x58b0b1[_0x157ae1(0x4d9)][_0x157ae1(0x131d)]>0x0||_0x58b0b1[_0x157ae1(0x4e9)][_0x157ae1(0x131d)]>0x0)&&_0x294a2b[_0x157ae1(0x129e)]({'type':_0x157ae1(0x22b),'dialogue':_0x58b0b1[_0x157ae1(0x4d9)][_0x157ae1(0x56c)]('\x0a'),'description':_0x58b0b1[_0x157ae1(0x4e9)][_0x157ae1(0x56c)]('\x0a')}),_0x58b0b1={'content':[],'dialogue':[],'description':[]}),_0x294a2b[_0x157ae1(0x129e)](_0x2339c4);}_0x58b0b1['content'][_0x157ae1(0x131d)]>0x0&&_0x294a2b[_0x157ae1(0x129e)]({'type':_0x157ae1(0x22b),'content':_0x58b0b1['content'][_0x157ae1(0x56c)]('\x0a')}),(_0x58b0b1[_0x157ae1(0x4d9)]['length']>0x0||_0x58b0b1[_0x157ae1(0x4e9)]['length']>0x0)&&_0x294a2b['push']({'type':_0x157ae1(0x22b),'dialogue':_0x58b0b1[_0x157ae1(0x4d9)][_0x157ae1(0x56c)]('\x0a'),'description':_0x58b0b1[_0x157ae1(0x4e9)][_0x157ae1(0x56c)]('\x0a')});}else _0x294a2b=_0x1918ac;const _0xe86cf9=_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0xaf1)](_0x49dfde=>_0x49dfde[_0x157ae1(0xaeb)]==='user'&&!_0x49dfde[_0x157ae1(0x7a0)])[_0x157ae1(0xdd4)]();if(_0xe86cf9&&Array[_0x157ae1(0x971)](_0xe86cf9[_0x157ae1(0x1316)])&&_0xe86cf9[_0x157ae1(0x1316)][0x0]?.[_0x157ae1(0x259)]===_0x157ae1(0x1072)&&!_0xe86cf9[_0x157ae1(0x270)]){const _0x139da7=_0x1918ac[_0x157ae1(0xb07)](_0x3cf01d=>_0x3cf01d['type']==='text');let _0x2fddb4;_0x139da7&&(_0x139da7['content']||_0x139da7[_0x157ae1(0x7aa)])?_0x2fddb4=String(_0x139da7[_0x157ae1(0x1316)]||_0x139da7['message'])[_0x157ae1(0x2aa)]():_0x2fddb4='AI已接收并理解了该图片的内容。';const _0xd6f5b5=_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x4a8)](_0x14037d=>_0x14037d[_0x157ae1(0xf16)]===_0xe86cf9[_0x157ae1(0xf16)]);if(_0xd6f5b5>-0x1){console[_0x157ae1(0x7d1)](_0x157ae1(0xf90)+_0xe86cf9[_0x157ae1(0xf16)]+_0x157ae1(0x7a8));const _0x346bd7=_0x157ae1(0x2e2)+_0x2fddb4+'”]';_0x181f0f[_0x157ae1(0x1d5)][_0xd6f5b5][_0x157ae1(0x1316)]=_0x346bd7,_0x181f0f[_0x157ae1(0x1d5)][_0xd6f5b5][_0x157ae1(0x270)]=!![],_0x181f0f['history'][_0xd6f5b5][_0x157ae1(0x259)]='text';}}const _0x4db52b=document[_0x157ae1(0x458)](_0x157ae1(0xd99))['classList'][_0x157ae1(0x526)](_0x157ae1(0xfe1))&&_0x42f206['activeChatId']===_0x27c6c8;let _0x279d8f=![],_0x2942c3=Date[_0x157ae1(0x606)](),_0x4f3aa1=[],_0xa90a3e=![];for(const _0x30da57 of _0x294a2b){if(_0x30da57[_0x157ae1(0x259)]===_0x157ae1(0xd67)){console['log']('🤖\x20AI\x20思维链:',_0x30da57);const _0x1eb4d7='[这是你上一轮的内部思考]\x0a-\x20分析:\x20'+(_0x30da57[_0x157ae1(0x3e8)]||'无')+_0x157ae1(0x68b)+(_0x30da57[_0x157ae1(0x99d)]||'无')+_0x157ae1(0x12d4)+JSON[_0x157ae1(0xc04)](_0x30da57[_0x157ae1(0x1373)]||{}),_0x485131={'role':_0x157ae1(0x1370),'content':_0x1eb4d7,'timestamp':Date['now']()-0x1,'isHidden':!![]};_0x181f0f['history'][_0x157ae1(0x129e)](_0x485131);continue;}_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x211)]!==![]&&_0x30da57['type']===_0x157ae1(0xdd5)&&typeof _0x30da57[_0x157ae1(0x1316)]===_0x157ae1(0x861)&&_0x30da57[_0x157ae1(0x1316)][_0x157ae1(0x2aa)]()[_0x157ae1(0x13ad)](_0x157ae1(0x377))&&(_0x30da57[_0x157ae1(0x259)]=_0x157ae1(0xefa),_0x30da57['content']=_0x30da57[_0x157ae1(0x1316)][_0x157ae1(0x33b)]('[V]','')[_0x157ae1(0x2aa)]());if(_0x181f0f[_0x157ae1(0x726)]&&_0x30da57[_0x157ae1(0x132a)]&&_0x30da57[_0x157ae1(0x132a)]===_0x181f0f[_0x157ae1(0x132a)]){console[_0x157ae1(0xb61)](_0x157ae1(0x13d9)+_0x181f0f['name']+_0x157ae1(0x40b),_0x30da57);continue;}if(!_0x30da57||typeof _0x30da57!==_0x157ae1(0x620)){console[_0x157ae1(0x1b6)](_0x157ae1(0x960),_0x30da57);continue;}if(!_0x30da57[_0x157ae1(0x259)]){if(_0x181f0f[_0x157ae1(0x726)]&&_0x30da57['name']&&_0x30da57[_0x157ae1(0x7aa)])_0x30da57[_0x157ae1(0x259)]='text';else{if(_0x30da57[_0x157ae1(0x1316)])_0x30da57[_0x157ae1(0x259)]=_0x157ae1(0xdd5);else{console[_0x157ae1(0x1b6)]('收到了格式不规范的AI指令（缺少type和content），已跳过:',_0x30da57);continue;}}}if(_0x30da57[_0x157ae1(0x259)]===_0x157ae1(0x237)){_0x4a3337[_0x157ae1(0x9a6)]=![];if(_0x30da57[_0x157ae1(0xaa7)]===_0x157ae1(0xfbf))_0x309acd();else{const _0x172e86={'role':_0x157ae1(0xac3),'content':'对方拒绝了你的视频通话请求。','timestamp':Date['now']()};_0x181f0f[_0x157ae1(0x1d5)]['push'](_0x172e86),await _0x17d534[_0x157ae1(0x954)]['put'](_0x181f0f),_0x589d88('chat-interface-screen'),_0x359c96(_0x27c6c8);}_0x279d8f=!![];break;}if(_0x30da57['type']==='group_call_response'){if(_0x30da57[_0x157ae1(0xaa7)]===_0x157ae1(0x56c)){const _0x44fddf=_0x181f0f['members'][_0x157ae1(0xb07)](_0x6d9167=>_0x6d9167[_0x157ae1(0xa1)]===_0x30da57[_0x157ae1(0x132a)]);_0x44fddf&&!_0x4a3337[_0x157ae1(0x1008)][_0x157ae1(0x593)](_0x9a8cea=>_0x9a8cea['id']===_0x44fddf['id'])&&_0x4a3337[_0x157ae1(0x1008)][_0x157ae1(0x129e)](_0x44fddf);}_0x279d8f=!![];continue;}if(_0x181f0f['isGroup']&&_0x30da57['name']&&_0x30da57['name']===_0x181f0f[_0x157ae1(0x132a)]){console[_0x157ae1(0xb61)](_0x157ae1(0x13d9)+_0x181f0f[_0x157ae1(0x132a)]+'\x22)\x20作为角色名。消息内容:',_0x30da57);continue;}if(_0x181f0f[_0x157ae1(0x726)]&&!_0x30da57[_0x157ae1(0x132a)]){console[_0x157ae1(0xb61)](_0x157ae1(0xe78),_0x30da57);continue;}let _0x16b563=null;const _0x4e6ce4=_0x2942c3++,_0xa91351={'role':_0x157ae1(0xac3),'senderName':_0x30da57[_0x157ae1(0x132a)]||_0x181f0f[_0x157ae1(0x132a)],'timestamp':_0x4e6ce4};lastResponseTimestamps[_0x157ae1(0x129e)](_0x4e6ce4);switch(_0x30da57[_0x157ae1(0x259)]){case'update_thoughts':if(!_0x181f0f[_0x157ae1(0x726)]){_0x30da57[_0x157ae1(0xe30)]&&(_0x181f0f[_0x157ae1(0xb0f)]=String(_0x30da57[_0x157ae1(0xe30)]));_0x30da57[_0x157ae1(0x8a)]&&(_0x181f0f[_0x157ae1(0x8eb)]=String(_0x30da57[_0x157ae1(0x8a)]));!Array['isArray'](_0x181f0f[_0x157ae1(0x6b8)])&&(_0x181f0f[_0x157ae1(0x6b8)]=[]);_0x181f0f[_0x157ae1(0x6b8)][_0x157ae1(0x129e)]({'heartfeltVoice':_0x181f0f[_0x157ae1(0xb0f)],'randomJottings':_0x181f0f['randomJottings'],'timestamp':Date['now']()});_0x181f0f[_0x157ae1(0x6b8)][_0x157ae1(0x131d)]>0x32&&_0x181f0f[_0x157ae1(0x6b8)]['shift']();const _0x1d06af=_0x157ae1(0xb05)+_0x181f0f[_0x157ae1(0xb0f)]+_0x157ae1(0xa10)+_0x181f0f['randomJottings'],_0x32a28f={'role':_0x157ae1(0x1370),'content':_0x1d06af,'timestamp':Date['now'](),'isHidden':!![]};}continue;case _0x157ae1(0xe4b):if(!_0x181f0f[_0x157ae1(0x726)]&&_0x30da57[_0x157ae1(0xdd7)]){const _0x11c5e3=_0x30da57['new_name'][_0x157ae1(0x2aa)]();if(_0x11c5e3){_0x181f0f['settings']['myNickname']=_0x11c5e3;const _0x158c97={'role':'system','type':'pat_message','content':'“'+_0x181f0f[_0x157ae1(0x132a)]+_0x157ae1(0xb36)+_0x11c5e3+'”','timestamp':_0x2942c3++};_0x181f0f['history'][_0x157ae1(0x129e)](_0x158c97);const _0x7d4ca0={'role':_0x157ae1(0x1370),'content':_0x157ae1(0x1010)+_0x11c5e3+'”。]','timestamp':_0x2942c3++,'isHidden':!![]};_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x129e)](_0x7d4ca0),_0x4db52b&&_0x5d5ee2(_0x158c97,_0x181f0f);}}continue;case _0x157ae1(0xa12):if(!_0x181f0f[_0x157ae1(0x726)]&&_0x30da57[_0x157ae1(0xdd7)]){const _0x537cec=_0x181f0f[_0x157ae1(0x132a)],_0x1eea18=_0x30da57[_0x157ae1(0xdd7)][_0x157ae1(0x2aa)]();if(_0x1eea18&&_0x1eea18!==_0x537cec){!_0x181f0f['nameHistory']&&(_0x181f0f['nameHistory']=[]);!_0x181f0f['nameHistory'][_0x157ae1(0xd8d)](_0x537cec)&&_0x181f0f[_0x157ae1(0x103)][_0x157ae1(0x129e)](_0x537cec);_0x181f0f[_0x157ae1(0x132a)]=_0x1eea18;const _0x1bb894={'role':_0x157ae1(0x1370),'type':'pat_message','content':'“'+_0x181f0f[_0x157ae1(0xa1)]+_0x157ae1(0x1026)+_0x1eea18+'”','timestamp':_0x2942c3++};_0x181f0f['history'][_0x157ae1(0x129e)](_0x1bb894);const _0x2e5b02={'role':'system','content':'[系统提示：你刚刚成功将自己的备注名修改为了“'+_0x1eea18+_0x157ae1(0x13db),'timestamp':_0x2942c3++,'isHidden':!![]};_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x129e)](_0x2e5b02),_0x4db52b&&(_0x5d5ee2(_0x1bb894,_0x181f0f),document['getElementById'](_0x157ae1(0xca6))['textContent']=_0x1eea18),await _0x5bef7a(_0x181f0f);}}continue;case _0x157ae1(0x23c):{const _0x509c56=_0x30da57['name'],_0x22efdb=_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x5d3)][_0x157ae1(0xb07)](_0x587fab=>_0x587fab['name']===_0x509c56);if(_0x22efdb){_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x9c7)]=_0x22efdb[_0x157ae1(0x1377)];const _0x581cd7={'role':_0x157ae1(0x1370),'type':_0x157ae1(0x3bf),'content':'['+_0x181f0f[_0x157ae1(0x132a)]+'\x20更换了头像]','timestamp':Date[_0x157ae1(0x606)]()};_0x181f0f[_0x157ae1(0x1d5)]['push'](_0x581cd7),await _0x249add(_0x181f0f),_0x4db52b&&(_0x5d5ee2(_0x581cd7,_0x181f0f),_0x359c96(_0x27c6c8));}continue;}case _0x157ae1(0x13b5):{const _0x2244a2=_0x30da57['name'],_0x1fecd1=_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0x22c)][_0x157ae1(0xb07)](_0x50e01d=>_0x50e01d[_0x157ae1(0x132a)]===_0x2244a2);if(_0x1fecd1){_0x181f0f[_0x157ae1(0xda2)]['myAvatar']=_0x1fecd1['url'];const _0x38340d={'role':_0x157ae1(0x1370),'type':_0x157ae1(0x3bf),'content':'['+_0x181f0f['name']+_0x157ae1(0xd1c),'timestamp':Date[_0x157ae1(0x606)]()};_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x129e)](_0x38340d),_0x4db52b&&(_0x5d5ee2(_0x38340d,_0x181f0f),_0x359c96(_0x27c6c8));}continue;}case _0x157ae1(0x6a1):{const _0x2f3e94=parseInt(_0x30da57['x']),_0x175f6e=parseInt(_0x30da57['y']);!isNaN(_0x2f3e94)&&!isNaN(_0x175f6e)?_0x2f9ca6({'x':_0x2f3e94,'y':_0x175f6e}):console[_0x157ae1(0x1b6)](_0x157ae1(0x125f),_0x30da57);continue;}case _0x157ae1(0x688):const _0x1bcecd=_0x181f0f[_0x157ae1(0x1d5)]['findIndex'](_0x1189d5=>_0x1189d5[_0x157ae1(0xf16)]===_0x30da57['for_timestamp']);if(_0x1bcecd>-0x1){const _0x347bba=_0x181f0f[_0x157ae1(0x1d5)][_0x1bcecd];_0x347bba['status']=_0x30da57[_0x157ae1(0x13b2)],_0x347bba[_0x157ae1(0x167)]=_0x30da57[_0x157ae1(0x13b2)]===_0x157ae1(0x1467)?_0x30da57[_0x157ae1(0x132a)]:null;}continue;case _0x157ae1(0xe47):const _0x4dc1ef={'type':_0x30da57[_0x157ae1(0xbc2)],'content':_0x30da57[_0x157ae1(0x1316)]||'','publicText':_0x30da57[_0x157ae1(0xd2d)]||'','hiddenContent':_0x30da57[_0x157ae1(0x145)]||'','image_prompt':_0x30da57[_0x157ae1(0xef)]||'','timestamp':Date['now'](),'authorId':_0x27c6c8,'authorGroupId':_0x181f0f['groupId'],'visibleGroupIds':null};if(_0x30da57[_0x157ae1(0xbc2)]===_0x157ae1(0xb62)&&_0x30da57[_0x157ae1(0xb55)])try{const _0x261974=Array[_0x157ae1(0x971)](_0x30da57[_0x157ae1(0xb55)])?_0x30da57[_0x157ae1(0xb55)]['slice'](0x0,0x2):[_0x30da57['prompt']];console[_0x157ae1(0x7d1)]('📸\x20动态NovelAI图片生成开始，共'+_0x261974[_0x157ae1(0x131d)]+_0x157ae1(0x7f5));const _0x5c75e7=[];for(let _0x5f352d=0x0;_0x5f352d<_0x261974[_0x157ae1(0x131d)];_0x5f352d++){const _0x4dfbc1=_0x261974[_0x5f352d];console[_0x157ae1(0x7d1)](_0x157ae1(0x13ec)+(_0x5f352d+0x1)+_0x157ae1(0x65e),_0x4dfbc1);const _0xbf142b=_0x1567d3(_0x181f0f['id']),_0x4d1353=_0x4dfbc1+',\x20'+_0xbf142b[_0x157ae1(0x327)],_0x2fef6f=_0xbf142b[_0x157ae1(0xd40)];console[_0x157ae1(0x7d1)](_0x157ae1(0x3b8)+(_0xbf142b['source']===_0x157ae1(0x4c5)?'角色专属':'系统')+_0x157ae1(0xe52)),console[_0x157ae1(0x7d1)](_0x157ae1(0x635),_0x4d1353),console['log']('最终负面提示词:',_0x2fef6f);const _0x374189=localStorage[_0x157ae1(0x127d)]('novelai-api-key'),_0x30c0fc=localStorage[_0x157ae1(0x127d)](_0x157ae1(0x10d0))||'nai-diffusion-4-5-full',_0x502aba=_0xb80e9();if(!_0x374189)throw new Error(_0x157ae1(0x430));const [_0x4c2a6e,_0x583e76]=_0x502aba[_0x157ae1(0x33c)]['split']('x')['map'](Number);let _0x3921b6;_0x30c0fc['includes']('nai-diffusion-4')?_0x3921b6={'input':_0x4d1353,'model':_0x30c0fc,'action':'generate','parameters':{'params_version':0x3,'width':_0x4c2a6e,'height':_0x583e76,'scale':_0x502aba['cfg_scale'],'sampler':_0x502aba[_0x157ae1(0x4a2)],'steps':_0x502aba[_0x157ae1(0x7e2)],'seed':_0x502aba[_0x157ae1(0xa72)]===-0x1?Math[_0x157ae1(0xbd5)](Math[_0x157ae1(0x23a)]()*0x2540be3ff):_0x502aba[_0x157ae1(0xa72)],'n_samples':0x1,'ucPreset':_0x502aba[_0x157ae1(0x121c)],'qualityToggle':_0x502aba[_0x157ae1(0x13d5)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x157ae1(0xa96),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x4d1353,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x2fef6f,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x2fef6f,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x3921b6={'input':_0x4d1353,'model':_0x30c0fc,'action':'generate','parameters':{'width':_0x4c2a6e,'height':_0x583e76,'scale':_0x502aba['cfg_scale'],'sampler':_0x502aba[_0x157ae1(0x4a2)],'steps':_0x502aba[_0x157ae1(0x7e2)],'seed':_0x502aba[_0x157ae1(0xa72)]===-0x1?Math[_0x157ae1(0xbd5)](Math[_0x157ae1(0x23a)]()*0x2540be3ff):_0x502aba['seed'],'n_samples':0x1,'ucPreset':_0x502aba[_0x157ae1(0x121c)],'qualityToggle':_0x502aba[_0x157ae1(0x13d5)],'sm':_0x502aba[_0x157ae1(0x240)],'sm_dyn':_0x502aba['smea_dyn'],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x157ae1(0x4cf),'negative_prompt':_0x2fef6f}};console['log'](_0x157ae1(0xad0),_0x3921b6);let _0x49ccb2;_0x30c0fc[_0x157ae1(0xd8d)](_0x157ae1(0x105a))?_0x49ccb2=_0x157ae1(0xe8f):_0x49ccb2=_0x157ae1(0x197);let _0x54176f=_0x502aba[_0x157ae1(0x413)];_0x54176f==='custom'&&(_0x54176f=_0x502aba[_0x157ae1(0x2b8)]||'');_0x54176f&&_0x54176f!==''&&(_0x49ccb2=_0x54176f+encodeURIComponent(_0x49ccb2));const _0x19fab5=await fetch(_0x49ccb2,{'method':'POST','headers':{'Content-Type':_0x157ae1(0xa0e),'Authorization':_0x157ae1(0x8aa)+_0x374189},'body':JSON['stringify'](_0x3921b6)});console[_0x157ae1(0x7d1)](_0x157ae1(0x846),_0x19fab5[_0x157ae1(0x13b2)]),console[_0x157ae1(0x7d1)](_0x157ae1(0x1433),[..._0x19fab5[_0x157ae1(0x371)][_0x157ae1(0x1309)]()]);if(!_0x19fab5['ok']){const _0x302b52=await _0x19fab5['text']();console[_0x157ae1(0xb61)](_0x157ae1(0x8f),_0x302b52);throw new Error('API请求失败\x20('+_0x19fab5['status']+_0x157ae1(0x352)+_0x302b52);}const _0x556914=_0x19fab5[_0x157ae1(0x371)][_0x157ae1(0x36d)](_0x157ae1(0x459));console[_0x157ae1(0x7d1)](_0x157ae1(0xfe6),_0x556914);let _0x3c6576,_0x121060;if(_0x556914&&_0x556914[_0x157ae1(0xd8d)](_0x157ae1(0xb45))){console['log'](_0x157ae1(0x287));const _0x1b0473=await _0x19fab5[_0x157ae1(0xdd5)]();console[_0x157ae1(0x7d1)](_0x157ae1(0xb3b),_0x1b0473[_0x157ae1(0x131d)]);const _0x332e9b=_0x1b0473[_0x157ae1(0x2aa)]()[_0x157ae1(0x90b)]('\x0a');let _0x17dd49=null;for(let _0x85a86=_0x332e9b[_0x157ae1(0x131d)]-0x1;_0x85a86>=0x0;_0x85a86--){const _0x453008=_0x332e9b[_0x85a86][_0x157ae1(0x2aa)]();if(_0x453008[_0x157ae1(0x13ad)](_0x157ae1(0x143f))&&_0x453008!==_0x157ae1(0x21d)){const _0x2b8e04=_0x453008['substring'](0x6);try{const _0x3425e9=JSON[_0x157ae1(0x44c)](_0x2b8e04);if(_0x3425e9['event_type']==='final'&&_0x3425e9[_0x157ae1(0xefe)]){_0x17dd49=_0x3425e9[_0x157ae1(0xefe)],console[_0x157ae1(0x7d1)](_0x157ae1(0x1313));break;}if(_0x3425e9[_0x157ae1(0x76b)]){_0x17dd49=_0x3425e9['data'],console[_0x157ae1(0x7d1)](_0x157ae1(0xbdf));break;}if(_0x3425e9['image']){_0x17dd49=_0x3425e9[_0x157ae1(0xefe)],console[_0x157ae1(0x7d1)](_0x157ae1(0xde4));break;}}catch(_0x44429d){_0x17dd49=_0x2b8e04,console['log'](_0x157ae1(0x71));break;}}}if(!_0x17dd49)throw new Error(_0x157ae1(0x1199));const _0x22aad8=_0x17dd49[_0x157ae1(0x13ad)]('iVBORw0KGgo'),_0x3c5951=_0x17dd49[_0x157ae1(0x13ad)](_0x157ae1(0x2b7));if(_0x22aad8||_0x3c5951){console[_0x157ae1(0x7d1)](_0x157ae1(0x1405));const _0x117cea=atob(_0x17dd49),_0x476c63=new Uint8Array(_0x117cea[_0x157ae1(0x131d)]);for(let _0x1d6649=0x0;_0x1d6649<_0x117cea[_0x157ae1(0x131d)];_0x1d6649++){_0x476c63[_0x1d6649]=_0x117cea['charCodeAt'](_0x1d6649);}const _0x5b2797=new Blob([_0x476c63],{'type':_0x22aad8?_0x157ae1(0x100d):'image/jpeg'});console['log'](_0x157ae1(0xc55),_0x5b2797[_0x157ae1(0x12a4)]);const _0x56cfce=new FileReader();_0x121060=await new Promise((_0x373347,_0x5bc17b)=>{const _0x1a9bab=_0x157ae1;_0x56cfce['onloadend']=()=>_0x373347(_0x56cfce[_0x1a9bab(0x2ed)]),_0x56cfce['onerror']=_0x5bc17b,_0x56cfce[_0x1a9bab(0x96e)](_0x5b2797);}),console['log']('✅\x20图片转换成功！🎨');}else{console['log'](_0x157ae1(0x136a));const _0x3e2da1=atob(_0x17dd49),_0x5cbedc=new Uint8Array(_0x3e2da1[_0x157ae1(0x131d)]);for(let _0x129652=0x0;_0x129652<_0x3e2da1[_0x157ae1(0x131d)];_0x129652++){_0x5cbedc[_0x129652]=_0x3e2da1[_0x157ae1(0x12f3)](_0x129652);}_0x3c6576=new Blob([_0x5cbedc]),console[_0x157ae1(0x7d1)](_0x157ae1(0x145a),_0x3c6576['size']);}}else _0x3c6576=await _0x19fab5['blob'](),console[_0x157ae1(0x7d1)](_0x157ae1(0xca9),_0x3c6576[_0x157ae1(0x259)],_0x157ae1(0xdd),_0x3c6576[_0x157ae1(0x12a4)]);if(!_0x121060&&_0x3c6576)try{if(typeof JSZip==='undefined')throw new Error(_0x157ae1(0xc3c));const _0x353ab6=await JSZip[_0x157ae1(0x105)](_0x3c6576);console[_0x157ae1(0x7d1)](_0x157ae1(0x119f),Object[_0x157ae1(0x634)](_0x353ab6['files']));let _0x16e08d=null;for(let _0x167d41 in _0x353ab6[_0x157ae1(0x1a9)]){if(_0x167d41[_0x157ae1(0x41c)](/\.(png|jpg|jpeg|webp)$/i)){_0x16e08d=_0x353ab6[_0x157ae1(0x1a9)][_0x167d41],console[_0x157ae1(0x7d1)]('找到图片文件:',_0x167d41);break;}}if(!_0x16e08d)throw new Error(_0x157ae1(0x892));const _0x41b43c=await _0x16e08d[_0x157ae1(0x890)](_0x157ae1(0x43d));console[_0x157ae1(0x7d1)](_0x157ae1(0x1259),_0x41b43c[_0x157ae1(0x12a4)]);const _0x4240fd=new FileReader();_0x121060=await new Promise((_0x1d83cc,_0x254d97)=>{const _0x3c31a2=_0x157ae1;_0x4240fd[_0x3c31a2(0x13a7)]=()=>_0x1d83cc(_0x4240fd['result']),_0x4240fd[_0x3c31a2(0x4de)]=_0x254d97,_0x4240fd['readAsDataURL'](_0x41b43c);}),console['log'](_0x157ae1(0xdb9));}catch(_0x122b68){console[_0x157ae1(0xb61)](_0x157ae1(0xab5),_0x122b68);throw new Error(_0x157ae1(0x1c5)+_0x122b68[_0x157ae1(0x7aa)]);}console['log'](_0x157ae1(0x114b)+(_0x5f352d+0x1)+'生成成功！'),_0x5c75e7[_0x157ae1(0x129e)](_0x121060);}_0x4dc1ef['imageUrls']=_0x5c75e7,_0x5c75e7[_0x157ae1(0x131d)]===0x1&&(_0x4dc1ef[_0x157ae1(0x2cc)]=_0x5c75e7[0x0]),_0x4dc1ef[_0x157ae1(0xb55)]=_0x30da57['prompt'],_0x4dc1ef[_0x157ae1(0x5a3)]=_0x5c75e7[_0x157ae1(0x131d)],console[_0x157ae1(0x7d1)](_0x157ae1(0xc6f)+_0x5c75e7['length']+'张');}catch(_0x9c4186){console[_0x157ae1(0xb61)](_0x157ae1(0xf87),_0x9c4186),_0x4dc1ef['content']=(_0x4dc1ef[_0x157ae1(0x1316)]||_0x4dc1ef[_0x157ae1(0xd2d)]||'')+(_0x157ae1(0xaf0)+_0x9c4186['message']+']');}await _0x17d534[_0x157ae1(0x15b)]['add'](_0x4dc1ef),_0x276281(_0x116b59+0x1);_0x4db52b&&document[_0x157ae1(0x458)](_0x157ae1(0x1116))[_0x157ae1(0x11c2)][_0x157ae1(0x526)](_0x157ae1(0xfe1))&&await _0x316550();continue;case _0x157ae1(0x1032):{const _0x44fb92=await _0x17d534['qzonePosts'][_0x157ae1(0x36d)](parseInt(_0x30da57[_0x157ae1(0x13bc)]));if(_0x44fb92){if(!_0x44fb92[_0x157ae1(0x946)])_0x44fb92['comments']=[];const _0x22318c=_0x30da57['name']||_0x181f0f[_0x157ae1(0xa1)],_0x46ced3=(_0x7d5e43,_0x4b9a5=null,_0x191e93=null)=>({'commenterName':_0x22318c,'text':_0xcad370(_0x7d5e43,_0x181f0f),'meaning':_0x4b9a5,'replyTo':_0x191e93,'timestamp':Date[_0x157ae1(0x606)]()});if(_0x30da57['stickerMeaning']){const _0x4975ba=_0x42f206['userStickers'][_0x157ae1(0xb07)](_0x38e838=>_0x38e838[_0x157ae1(0x132a)]===_0x30da57[_0x157ae1(0x293)]);_0x4975ba?_0x44fb92[_0x157ae1(0x946)]['push'](_0x46ced3(_0x4975ba[_0x157ae1(0x1377)],_0x4975ba[_0x157ae1(0x132a)],_0x30da57[_0x157ae1(0xd75)]||null)):(console[_0x157ae1(0x1b6)](_0x157ae1(0x128d)+_0x30da57[_0x157ae1(0x293)]+'\x22'),_0x44fb92[_0x157ae1(0x946)][_0x157ae1(0x129e)](_0x46ced3(_0x157ae1(0x21f)+_0x30da57[_0x157ae1(0x293)]+']',null,_0x30da57[_0x157ae1(0xd75)]||null)));}else{if(Array['isArray'](_0x30da57[_0x157ae1(0x946)]))_0x30da57[_0x157ae1(0x946)][_0x157ae1(0x12c2)](_0x3894bf=>{const _0x114f79=_0x157ae1;typeof _0x3894bf===_0x114f79(0x861)&&_0x3894bf[_0x114f79(0x2aa)]()&&_0x44fb92['comments'][_0x114f79(0x129e)](_0x46ced3(_0x3894bf,null,_0x30da57[_0x114f79(0xd75)]||null));});else typeof _0x30da57[_0x157ae1(0x8f4)]===_0x157ae1(0x861)&&_0x30da57['commentText'][_0x157ae1(0x2aa)]()&&_0x44fb92[_0x157ae1(0x946)][_0x157ae1(0x129e)](_0x46ced3(_0x30da57['commentText'],null,_0x30da57[_0x157ae1(0xd75)]||null));}await _0x17d534['qzonePosts'][_0x157ae1(0x938)](_0x44fb92['id'],{'comments':_0x44fb92[_0x157ae1(0x946)]}),_0x276281(_0x116b59+0x1),console['log'](_0x157ae1(0xdd6)+_0x181f0f['name']+_0x157ae1(0x902)+_0x30da57[_0x157ae1(0x13bc)]);if(!_0x181f0f[_0x157ae1(0x43b)])_0x181f0f[_0x157ae1(0x43b)]={};_0x181f0f[_0x157ae1(0x43b)][_0x30da57['postId']]=Date[_0x157ae1(0x606)]();}continue;}case _0x157ae1(0xc72):const _0x4815e7=await _0x17d534[_0x157ae1(0x15b)]['get'](parseInt(_0x30da57[_0x157ae1(0x13bc)]));if(_0x4815e7){if(!_0x4815e7[_0x157ae1(0x1be)])_0x4815e7[_0x157ae1(0x1be)]=[];!_0x4815e7[_0x157ae1(0x1be)][_0x157ae1(0xd8d)](_0x181f0f[_0x157ae1(0x132a)])&&(_0x4815e7[_0x157ae1(0x1be)]['push'](_0x181f0f[_0x157ae1(0x132a)]),await _0x17d534[_0x157ae1(0x15b)]['update'](_0x4815e7['id'],{'likes':_0x4815e7[_0x157ae1(0x1be)]}),_0x276281(_0x116b59+0x1),_0x4db52b&&document['getElementById'](_0x157ae1(0x1116))['classList'][_0x157ae1(0x526)](_0x157ae1(0xfe1))&&await _0x316550());}continue;case'repost':{const _0x162690=await _0x17d534[_0x157ae1(0x15b)][_0x157ae1(0x36d)](parseInt(_0x30da57[_0x157ae1(0x13bc)]));if(_0x162690){const _0x37b8bc={'type':_0x157ae1(0x10c6),'timestamp':Date[_0x157ae1(0x606)](),'authorId':_0x27c6c8,'authorGroupId':_0x181f0f[_0x157ae1(0x1437)],'repostComment':_0x30da57['comment']||'','originalPost':_0x162690,'visibleGroupIds':null};await _0x17d534[_0x157ae1(0x15b)][_0x157ae1(0xa58)](_0x37b8bc),_0x276281(_0x116b59+0x1),console[_0x157ae1(0x7d1)](_0x157ae1(0xdd6)+_0x181f0f[_0x157ae1(0x132a)]+_0x157ae1(0x3e2)+_0x30da57[_0x157ae1(0x13bc)]);}continue;}case _0x157ae1(0xc85):!_0x4a3337[_0x157ae1(0x1196)]&&!_0x4a3337[_0x157ae1(0x9a6)]&&(_0x42f206[_0x157ae1(0x81d)]=_0x27c6c8,_0x4a3337[_0x157ae1(0x81d)]=_0x27c6c8,_0x4a3337[_0x157ae1(0x9a6)]=!![],_0x4a3337[_0x157ae1(0x60a)]=_0x181f0f[_0x157ae1(0x726)],_0x4a3337[_0x157ae1(0xa1e)]=_0x30da57['name']||_0x181f0f[_0x157ae1(0x132a)],_0x5ed899());continue;case _0x157ae1(0x798):!_0x4a3337[_0x157ae1(0x1196)]&&!_0x4a3337['isAwaitingResponse']&&(_0x42f206[_0x157ae1(0x81d)]=_0x27c6c8,_0x4a3337[_0x157ae1(0x9a6)]=!![],_0x4a3337['isGroupCall']=!![],_0x4a3337[_0x157ae1(0x6a0)]='ai',_0x4a3337[_0x157ae1(0xa1e)]=_0x30da57[_0x157ae1(0x132a)],_0x5ed899());continue;case _0x157ae1(0xbcf):let _0x2f515d;if(_0x181f0f['isGroup']){const _0x557107=_0x181f0f[_0x157ae1(0xfa8)][_0x157ae1(0xb07)](_0x1e66e8=>_0x1e66e8['originalName']===_0x30da57[_0x157ae1(0x132a)]);_0x2f515d=_0x557107?_0x557107[_0x157ae1(0x1118)]:_0x30da57[_0x157ae1(0x132a)];}else _0x2f515d=_0x181f0f[_0x157ae1(0x132a)];const _0x8ec3dd=_0x30da57[_0x157ae1(0x54f)]?'\x20'+_0x30da57[_0x157ae1(0x54f)][_0x157ae1(0x2aa)]():'',_0x1b555d=_0x2f515d+_0x157ae1(0x121f)+_0x8ec3dd,_0x15afc4={'role':'system','type':_0x157ae1(0x3bf),'content':_0x1b555d,'timestamp':Date[_0x157ae1(0x606)]()};_0x181f0f[_0x157ae1(0x1d5)]['push'](_0x15afc4);if(_0x4db52b){const _0x408c47=document[_0x157ae1(0x458)](_0x157ae1(0xb3e));_0x408c47['classList'][_0x157ae1(0x1097)](_0x157ae1(0x1406)),void _0x408c47[_0x157ae1(0x145e)],_0x408c47[_0x157ae1(0x11c2)][_0x157ae1(0xa58)]('pat-animation'),setTimeout(()=>_0x408c47[_0x157ae1(0x11c2)][_0x157ae1(0x1097)]('pat-animation'),0x1f4),_0x5d5ee2(_0x15afc4,_0x181f0f);}else _0x478393(_0x27c6c8,_0x1b555d);continue;case'update_status':_0x181f0f[_0x157ae1(0x13b2)]['text']=_0x30da57[_0x157ae1(0x163)],_0x181f0f['status'][_0x157ae1(0x91b)]=_0x30da57[_0x157ae1(0xa14)]||![],_0x181f0f[_0x157ae1(0x13b2)][_0x157ae1(0xbdd)]=Date['now']();const _0x250d61={'role':'system','type':'pat_message','content':'['+_0x181f0f[_0x157ae1(0x132a)]+'的状态已更新为:\x20'+_0x30da57[_0x157ae1(0x163)]+']','timestamp':Date[_0x157ae1(0x606)]()};_0x181f0f['history']['push'](_0x250d61);_0x4db52b&&_0x5d5ee2(_0x250d61,_0x181f0f);_0x27be5e();continue;case _0x157ae1(0x7c):_0x16b563={..._0xa91351,'type':_0x157ae1(0x7c),'content':_0x30da57['content']};break;case _0x157ae1(0xc9b):if(_0x59377b['isActive']&&_0x59377b[_0x157ae1(0x81d)]===_0x27c6c8){const _0x30c9ed=_0x30da57[_0x157ae1(0x1a0)]||_0x30da57[_0x157ae1(0x4dd)]||_0x30da57[_0x157ae1(0x132a)];if(typeof _0x30c9ed==='string'&&_0x30c9ed['trim']()){const _0x29362e=_0x30c9ed[_0x157ae1(0x33b)](/^\[?\d+\]?[\s.-]*/,'')['trim'](),_0x49b8a9=_0x59377b[_0x157ae1(0x1102)]['findIndex'](_0x3ac6d0=>_0x3ac6d0[_0x157ae1(0x132a)][_0x157ae1(0xb15)]()===_0x29362e[_0x157ae1(0xb15)]());if(_0x49b8a9>-0x1){_0x50e8cd(_0x49b8a9);const _0x256a68=_0x59377b[_0x157ae1(0x1102)][_0x49b8a9];let _0x481435;if(_0x181f0f[_0x157ae1(0x726)]){const _0x2f7e17=_0x181f0f[_0x157ae1(0xfa8)][_0x157ae1(0xb07)](_0xb128a6=>_0xb128a6[_0x157ae1(0xa1)]===_0x30da57[_0x157ae1(0x132a)]);_0x481435=_0x2f7e17?_0x2f7e17['groupNickname']:_0x30da57[_0x157ae1(0x132a)];}else _0x481435=_0x181f0f[_0x157ae1(0x132a)];const _0x5518c5={'role':'system','type':_0x157ae1(0x3bf),'content':_0x157ae1(0xbfc)+_0x481435+'\x20为你切歌:\x20《'+_0x256a68[_0x157ae1(0x132a)]+'》\x20-\x20'+_0x256a68['artist']+']','timestamp':Date[_0x157ae1(0x606)]()};_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x129e)](_0x5518c5),_0x4db52b&&_0x5d5ee2(_0x5518c5,_0x181f0f);}else console['warn'](_0x157ae1(0x3d4)+_0x30c9ed+_0x157ae1(0xbf5)+_0x29362e+'\x22)\x20在播放列表中未找到。');}else console[_0x157ae1(0xb61)](_0x157ae1(0x994),_0x30da57);}continue;case _0x157ae1(0xb10):const _0x3ab63b={'chatId':_0x27c6c8,'authorId':_0x27c6c8,'description':_0x30da57['description'],'timestamp':Date[_0x157ae1(0x606)](),'type':_0x157ae1(0x3cc)};await _0x17d534[_0x157ae1(0x414)][_0x157ae1(0xa58)](_0x3ab63b),console['log'](_0x157ae1(0x108)+_0x181f0f[_0x157ae1(0x132a)]+'\x22\x20记录了一条新回忆:',_0x30da57[_0x157ae1(0x4e9)]);continue;case _0x157ae1(0x530):const _0x540f72=new Date(_0x30da57['date']);if(!isNaN(_0x540f72)&&_0x540f72>new Date()){const _0x1b3d3c={'chatId':_0x27c6c8,'authorId':_0x27c6c8,'description':_0x30da57[_0x157ae1(0x316)],'timestamp':Date[_0x157ae1(0x606)](),'type':_0x157ae1(0x536),'targetDate':_0x540f72[_0x157ae1(0xf08)]()};await _0x17d534[_0x157ae1(0x414)][_0x157ae1(0xa58)](_0x1b3d3c),console['log'](_0x157ae1(0x108)+_0x181f0f['name']+_0x157ae1(0x1359),_0x30da57[_0x157ae1(0x316)]);}continue;case'block_user':if(!_0x181f0f[_0x157ae1(0x726)]){_0x181f0f['relationship']['status']=_0x157ae1(0x12b0);const _0xccef7d={'role':'system','content':_0x157ae1(0x126f),'timestamp':Date[_0x157ae1(0x606)](),'isHidden':!![]};_0x181f0f['history'][_0x157ae1(0x129e)](_0xccef7d),await _0x17d534['chats'][_0x157ae1(0xf3f)](_0x181f0f);_0x4db52b&&_0x359c96(_0x27c6c8);_0x27be5e();break;}continue;case'friend_request_response':!_0x181f0f[_0x157ae1(0x726)]&&_0x181f0f[_0x157ae1(0x569)]?.['status']==='pending_ai_approval'&&(_0x30da57[_0x157ae1(0xaa7)]===_0x157ae1(0xfbf)?(_0x181f0f[_0x157ae1(0x569)][_0x157ae1(0x13b2)]=_0x157ae1(0xe97),_0x16b563={..._0xa91351,'content':_0x157ae1(0xa4d)}):(_0x181f0f['relationship'][_0x157ae1(0x13b2)]=_0x157ae1(0x12b0),_0x16b563={..._0xa91351,'content':_0x157ae1(0x7af)}),_0x181f0f[_0x157ae1(0x569)][_0x157ae1(0x666)]='');break;case _0x157ae1(0x670):const _0x6eacb6=typeof _0x30da57[_0x157ae1(0x8e9)]===_0x157ae1(0x861)?_0x30da57['options'][_0x157ae1(0x90b)]('\x0a')[_0x157ae1(0xaf1)](_0xd98964=>_0xd98964[_0x157ae1(0x2aa)]()):Array[_0x157ae1(0x971)](_0x30da57[_0x157ae1(0x8e9)])?_0x30da57[_0x157ae1(0x8e9)]:[];if(_0x6eacb6[_0x157ae1(0x131d)]<0x2)continue;_0x16b563={..._0xa91351,'type':_0x157ae1(0x670),'question':_0x30da57['question'],'options':_0x6eacb6,'votes':{},'isClosed':![]};break;case'gift':{const {itemName:_0x13e2d8,itemPrice:_0x1b14f3,image_prompt:_0x2da9f6}=_0x30da57;if(_0x13e2d8&&!isNaN(parseFloat(_0x1b14f3))&&_0x2da9f6){const _0x375f25=_0x157ae1(0x94c)+encodeURIComponent(_0x2da9f6);_0x16b563={..._0xa91351,'type':_0x157ae1(0xfb0),'items':[{'name':_0x13e2d8,'price':parseFloat(_0x1b14f3),'imageUrl':_0x375f25,'quantity':0x1}],'total':parseFloat(_0x1b14f3),'recipients':_0x30da57['recipients']||null};}else console[_0x157ae1(0x1b6)](_0x157ae1(0xe2e),_0x30da57);break;}case _0x157ae1(0x5aa):const _0x199712=_0x181f0f[_0x157ae1(0x1d5)]['find'](_0xa643f9=>_0xa643f9[_0x157ae1(0xf16)]===_0x30da57['poll_timestamp']);_0x199712&&!_0x199712[_0x157ae1(0xac0)]&&(Object['keys'](_0x199712[_0x157ae1(0x92)])[_0x157ae1(0x12c2)](_0x51ca1d=>{const _0x4d6ea8=_0x157ae1,_0x13358c=_0x199712['votes'][_0x51ca1d][_0x4d6ea8(0x893)](_0x30da57['name']);_0x13358c>-0x1&&_0x199712[_0x4d6ea8(0x92)][_0x51ca1d]['splice'](_0x13358c,0x1);}),!_0x199712['votes'][_0x30da57['choice']]&&(_0x199712['votes'][_0x30da57['choice']]=[]),!_0x199712[_0x157ae1(0x92)][_0x30da57['choice']][_0x157ae1(0xd8d)](_0x30da57[_0x157ae1(0x132a)])&&_0x199712[_0x157ae1(0x92)][_0x30da57[_0x157ae1(0x11a1)]][_0x157ae1(0x129e)](_0x30da57[_0x157ae1(0x132a)]),_0x4db52b&&_0x359c96(_0x27c6c8));continue;case _0x157ae1(0xd9e):_0x16b563={..._0xa91351,..._0x30da57,'totalAmount':_0x30da57[_0x157ae1(0x116)],'claimedBy':{},'isFullyClaimed':![]};_0x30da57[_0x157ae1(0x7bc)]&&(_0x16b563[_0x157ae1(0x1421)]=_0x30da57[_0x157ae1(0x7bc)],delete _0x16b563['receiver']);break;case'open_red_packet':const _0x57289f=_0x181f0f[_0x157ae1(0x1d5)]['find'](_0x3ab70a=>_0x3ab70a[_0x157ae1(0xf16)]===_0x30da57[_0x157ae1(0x736)]),_0x1c37fc=_0x30da57[_0x157ae1(0x132a)],_0x17e3a7=_0x181f0f[_0x157ae1(0xfa8)][_0x157ae1(0x593)](_0x580bcd=>_0x580bcd[_0x157ae1(0xa1)]===_0x1c37fc);if(!_0x17e3a7){console['warn'](_0x157ae1(0xcf6)+_0x1c37fc+'\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。');continue;}if(_0x57289f&&_0x57289f[_0x157ae1(0xd83)]===_0x157ae1(0x1205)){if(_0x57289f[_0x157ae1(0x1421)]!==_0x30da57['name']){console[_0x157ae1(0x1b6)](_0x157ae1(0xcf6)+_0x30da57[_0x157ae1(0x132a)]+_0x157ae1(0xe70)+_0x57289f[_0x157ae1(0x1421)]+_0x157ae1(0xfb4));continue;}}if(_0x57289f&&!_0x57289f[_0x157ae1(0x1258)]&&!(_0x57289f[_0x157ae1(0xcd4)]&&_0x57289f[_0x157ae1(0xcd4)][_0x30da57['name']])){let _0x45ca75=0x0;const _0x178d75=_0x57289f[_0x157ae1(0xd2c)]-Object[_0x157ae1(0x6eb)](_0x57289f[_0x157ae1(0xcd4)]||{})['reduce']((_0x346c9d,_0x2f6011)=>_0x346c9d+_0x2f6011,0x0),_0x5be629=_0x57289f[_0x157ae1(0x1e5)]-Object[_0x157ae1(0x634)](_0x57289f[_0x157ae1(0xcd4)]||{})[_0x157ae1(0x131d)];if(_0x5be629>0x0){if(_0x57289f[_0x157ae1(0xd83)]===_0x157ae1(0x1205))_0x45ca75=_0x57289f[_0x157ae1(0xd2c)];else{if(_0x5be629===0x1)_0x45ca75=_0x178d75;else{const _0x573b8b=0.01,_0x209159=_0x178d75-(_0x5be629-0x1)*_0x573b8b;_0x45ca75=Math[_0x157ae1(0x23a)]()*(_0x209159-_0x573b8b)+_0x573b8b;}}_0x45ca75=parseFloat(_0x45ca75['toFixed'](0x2));if(!_0x57289f[_0x157ae1(0xcd4)])_0x57289f[_0x157ae1(0xcd4)]={};_0x57289f['claimedBy'][_0x30da57[_0x157ae1(0x132a)]]=_0x45ca75;const _0x1e79bb=_0x181f0f['members'][_0x157ae1(0xb07)](_0x3fb556=>_0x3fb556[_0x157ae1(0xa1)]===_0x30da57['name']),_0x533d32=_0x1e79bb?_0x1e79bb[_0x157ae1(0x1118)]:_0x30da57[_0x157ae1(0x132a)],_0x865062=_0x32d364(_0x181f0f,_0x57289f[_0x157ae1(0x2a3)]),_0x3c4c1f={'role':'system','type':_0x157ae1(0x3bf),'content':_0x533d32+_0x157ae1(0x5d6)+_0x865062+_0x157ae1(0x3b7),'timestamp':Date[_0x157ae1(0x606)]()};_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x129e)](_0x3c4c1f);let _0x24bd17=_0x157ae1(0x39c)+_0x533d32+_0x157ae1(0xd76)+_0x45ca75[_0x157ae1(0x800)](0x2)+_0x157ae1(0x12a3);if(Object[_0x157ae1(0x634)](_0x57289f[_0x157ae1(0xcd4)])[_0x157ae1(0x131d)]>=_0x57289f[_0x157ae1(0x1e5)]){_0x57289f['isFullyClaimed']=!![];const _0x50685c={'role':_0x157ae1(0x1370),'type':_0x157ae1(0x3bf),'content':_0x865062+_0x157ae1(0x16b),'timestamp':Date[_0x157ae1(0x606)]()+0x1};_0x181f0f[_0x157ae1(0x1d5)]['push'](_0x50685c);let _0x317529={'name':'','amount':-0x1};_0x57289f['packetType']===_0x157ae1(0x345)&&_0x57289f[_0x157ae1(0x1e5)]>0x1&&Object[_0x157ae1(0x1309)](_0x57289f['claimedBy'])[_0x157ae1(0x12c2)](([_0x166b95,_0x4f934e])=>{const _0x2117c5=_0x157ae1;_0x4f934e>_0x317529[_0x2117c5(0x116)]&&(_0x317529={'name':_0x166b95,'amount':_0x4f934e});});if(_0x317529['name']){const _0x3607cc=_0x181f0f[_0x157ae1(0xfa8)][_0x157ae1(0xb07)](_0x4c85e0=>_0x4c85e0[_0x157ae1(0xa1)]===_0x317529[_0x157ae1(0x132a)]),_0x51fbf1=_0x3607cc?_0x3607cc[_0x157ae1(0x1118)]:_0x317529[_0x157ae1(0x132a)];_0x24bd17+=_0x157ae1(0xcaf)+_0x51fbf1+'！';}else _0x24bd17+='\x20红包已被领完。';}_0x24bd17+=_0x157ae1(0x6b9);const _0x9e92aa={'role':_0x157ae1(0x1370),'content':_0x24bd17,'timestamp':Date[_0x157ae1(0x606)]()+0x2,'isHidden':!![]};_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x129e)](_0x9e92aa);}_0x4db52b&&(_0x359c96(_0x27c6c8),_0x27be5e());}continue;case _0x157ae1(0xfc6):{const _0x2b7949=_0x181f0f['history'][_0x157ae1(0x4a8)](_0x56b6ae=>_0x56b6ae[_0x157ae1(0xf16)]===_0x30da57[_0x157ae1(0xa37)]);if(_0x2b7949>-0x1){const _0x258d8d=_0x181f0f[_0x157ae1(0x1d5)][_0x2b7949];_0x258d8d[_0x157ae1(0x13b2)]=_0x157ae1(0xae);}continue;}case _0x157ae1(0x69c):{const _0x36183a=_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x4a8)](_0x1f39cb=>_0x1f39cb[_0x157ae1(0xf16)]===_0x30da57[_0x157ae1(0xa37)]);if(_0x36183a>-0x1){const _0x3f2fe3=_0x181f0f[_0x157ae1(0x1d5)][_0x36183a];_0x3f2fe3[_0x157ae1(0x13b2)]=_0x157ae1(0x62c);const _0xf5ad8f={'role':_0x157ae1(0xac3),'senderName':_0x181f0f[_0x157ae1(0x132a)],'type':_0x157ae1(0xf4e),'isRefund':!![],'amount':_0x3f2fe3['amount'],'note':_0x157ae1(0xf80),'timestamp':_0x2942c3++};_0x181f0f['history']['push'](_0xf5ad8f),_0x4db52b&&(_0x5d5ee2(_0xf5ad8f,_0x181f0f),_0x359c96(_0x27c6c8));}continue;}case _0x157ae1(0x1175):if(_0x181f0f[_0x157ae1(0x726)]&&_0x30da57[_0x157ae1(0xdd7)]){const _0x555d06=_0x30da57[_0x157ae1(0xdd7)]['trim'](),_0x142cdc=_0x181f0f[_0x157ae1(0xfa8)][_0x157ae1(0xbf6)](_0x9fd0cf=>_0x9fd0cf['originalName']);if(_0x142cdc[_0x157ae1(0xd8d)](_0x555d06)){console['warn'](_0x157ae1(0x1b7)+_0x30da57['name']+')\x20试图将群名更改为成员名\x20(\x22'+_0x555d06+'\x22)。操作已被程序阻止。');continue;}_0x181f0f[_0x157ae1(0x132a)]=_0x555d06;const _0x3a27d7=_0x181f0f[_0x157ae1(0xfa8)][_0x157ae1(0xb07)](_0x5eec0a=>_0x5eec0a[_0x157ae1(0xa1)]===_0x30da57[_0x157ae1(0x132a)]),_0x5436f0=_0x3a27d7?_0x3a27d7[_0x157ae1(0x1118)]:_0x30da57['name'],_0x29b294={'role':'system','type':'pat_message','content':_0x5436f0+_0x157ae1(0x693)+_0x181f0f['name']+'”','timestamp':_0x2942c3++};_0x181f0f[_0x157ae1(0x1d5)]['push'](_0x29b294),_0x4db52b&&(_0x5d5ee2(_0x29b294,_0x181f0f),document[_0x157ae1(0x458)](_0x157ae1(0xca6))[_0x157ae1(0x1a2)]=_0x181f0f[_0x157ae1(0x132a)]);}continue;case _0x157ae1(0xa12):if(!_0x181f0f[_0x157ae1(0x726)]&&_0x30da57['new_name']){const _0x375b64=_0x181f0f['name'],_0x4ea126=_0x30da57[_0x157ae1(0xdd7)][_0x157ae1(0x2aa)]();if(_0x4ea126&&_0x4ea126!==_0x375b64){!_0x181f0f[_0x157ae1(0x103)]&&(_0x181f0f[_0x157ae1(0x103)]=[]);!_0x181f0f[_0x157ae1(0x103)][_0x157ae1(0xd8d)](_0x375b64)&&_0x181f0f[_0x157ae1(0x103)][_0x157ae1(0x129e)](_0x375b64);_0x181f0f[_0x157ae1(0x132a)]=_0x4ea126;const _0xe0f1ac={'role':_0x157ae1(0x1370),'type':_0x157ae1(0x3bf),'content':'“'+_0x181f0f[_0x157ae1(0xa1)]+_0x157ae1(0x1026)+_0x4ea126+'”','timestamp':_0x2942c3++};_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x129e)](_0xe0f1ac);const _0x2efdc5={'role':'system','content':_0x157ae1(0x118f)+_0x4ea126+_0x157ae1(0x13db),'timestamp':_0x2942c3++,'isHidden':!![]};_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x129e)](_0x2efdc5),_0x4db52b&&(_0x5d5ee2(_0xe0f1ac,_0x181f0f),document[_0x157ae1(0x458)](_0x157ae1(0xca6))['textContent']=_0x4ea126),await _0x5bef7a(_0x181f0f);}}continue;case _0x157ae1(0xdb):if(_0x181f0f[_0x157ae1(0x726)]&&_0x30da57[_0x157ae1(0x636)]){const _0xac5bf8=_0x30da57[_0x157ae1(0x636)],_0x47bf6c=_0x181f0f[_0x157ae1(0xda2)]['groupAvatarLibrary']||[],_0x1a308b=_0x47bf6c[_0x157ae1(0xb07)](_0x578098=>_0x578098[_0x157ae1(0x132a)]===_0xac5bf8);if(_0x1a308b){_0x181f0f[_0x157ae1(0xda2)][_0x157ae1(0xaf7)]=_0x1a308b[_0x157ae1(0x1377)];const _0x40e851=_0x181f0f['members'][_0x157ae1(0xb07)](_0x4bbb44=>_0x4bbb44['originalName']===_0x30da57[_0x157ae1(0x132a)]),_0x2c5ad5=_0x40e851?_0x40e851[_0x157ae1(0x1118)]:_0x30da57[_0x157ae1(0x132a)],_0x362683={'role':_0x157ae1(0x1370),'type':_0x157ae1(0x3bf),'content':_0x2c5ad5+'\x20更换了群头像','timestamp':_0x2942c3++};_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x129e)](_0x362683),_0x4db52b&&_0x5d5ee2(_0x362683,_0x181f0f);}else console[_0x157ae1(0x1b6)](_0x157ae1(0x65b)+_0xac5bf8+'\x22');}continue;case'system_message':_0x16b563={'role':_0x157ae1(0x1370),'type':'pat_message','content':_0x30da57[_0x157ae1(0x1316)],'timestamp':Date[_0x157ae1(0x606)]()};break;case _0x157ae1(0xbd0):_0x16b563={..._0xa91351,'type':'share_link','title':_0x30da57['title'],'description':_0x30da57[_0x157ae1(0x4e9)],'source_name':_0x30da57[_0x157ae1(0x885)],'content':_0x30da57[_0x157ae1(0x1316)]};break;case'quote_reply':const _0x44e29b=_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0xb07)](_0x119ce5=>_0x119ce5[_0x157ae1(0xf16)]===_0x30da57[_0x157ae1(0xa7b)]);if(_0x44e29b){const _0x4b77af={'timestamp':_0x44e29b[_0x157ae1(0xf16)],'senderName':_0x44e29b[_0x157ae1(0x2a3)]||(_0x44e29b['role']==='user'?_0x181f0f[_0x157ae1(0xda2)]['myNickname']||'我':_0x181f0f[_0x157ae1(0x132a)]),'content':String(_0x44e29b[_0x157ae1(0x1316)]||'')[_0x157ae1(0xa6d)](0x0,0x32)};_0x16b563={..._0xa91351,'content':_0x30da57[_0x157ae1(0xbca)],'quote':_0x4b77af};}else _0x16b563={..._0xa91351,'content':_0x30da57[_0x157ae1(0xbca)]};break;case _0x157ae1(0x661):{if(!_0x4db52b)continue;const _0x38548b={..._0xa91351,'content':_0x30da57[_0x157ae1(0x1316)]},_0x5e5855=_0x4b8ea5(_0x38548b,_0x181f0f);_0x5d5ee2(_0x38548b,_0x181f0f,!![]),await new Promise(_0x4daad4=>setTimeout(_0x4daad4,Math[_0x157ae1(0x23a)]()*0x3e8+0x5dc));const _0x55e150=document[_0x157ae1(0x586)](_0x157ae1(0x12da)+_0x38548b['timestamp']+'\x22]')?.[_0x157ae1(0xe87)](_0x157ae1(0x11d1));if(_0x55e150){_0x55e150[_0x157ae1(0x11c2)][_0x157ae1(0xa58)]('recalled-animation'),await new Promise(_0x4bd97c=>setTimeout(_0x4bd97c,0x12c));const _0x588620={'role':_0x157ae1(0xac3),'senderName':_0x30da57[_0x157ae1(0x132a)]||_0x181f0f[_0x157ae1(0x132a)],'type':_0x157ae1(0x9dd),'content':_0x157ae1(0xc74),'timestamp':_0x38548b['timestamp'],'recalledData':{'originalType':_0x157ae1(0xdd5),'originalContent':_0x30da57[_0x157ae1(0x1316)]}},_0x534bc7=_0x181f0f['history'][_0x157ae1(0x4a8)](_0x391b6d=>_0x391b6d['timestamp']===_0x38548b[_0x157ae1(0xf16)]);_0x534bc7>-0x1?_0x181f0f[_0x157ae1(0x1d5)][_0x534bc7]=_0x588620:_0x181f0f[_0x157ae1(0x1d5)][_0x157ae1(0x129e)](_0x588620);const _0x59d9e1=await _0x4b8ea5(_0x588620,_0x181f0f);document[_0x157ae1(0x5b4)][_0x157ae1(0x526)](_0x55e150)&&_0x55e150[_0x157ae1(0x135e)][_0x157ae1(0x3f2)](_0x59d9e1,_0x55e150);}continue;}case _0x157ae1(0xdd5):_0x16b563={..._0xa91351,'content':String(_0x30da57['content']||_0x30da57['message'])};break;case _0x157ae1(0x869):if(_0x30da57[_0x157ae1(0x32e)]){const _0x1ad2d1=_0x42f206['userStickers'][_0x157ae1(0xb07)](_0x3d817e=>_0x3d817e['name']===_0x30da57[_0x157ae1(0x32e)]);_0x1ad2d1?_0x16b563={..._0xa91351,'type':_0x157ae1(0x869),'content':_0x1ad2d1[_0x157ae1(0x1377)],'meaning':_0x1ad2d1[_0x157ae1(0x132a)]}:(console[_0x157ae1(0x1b6)](_0x157ae1(0xdfe)+_0x30da57[_0x157ae1(0x32e)]+'\x22'),_0x16b563={..._0xa91351,'type':_0x157ae1(0xdd5),'content':_0x157ae1(0x21f)+_0x30da57[_0x157ae1(0x32e)]+']'});}else console[_0x157ae1(0x1b6)](_0x157ae1(0xcba),_0x30da57),_0x16b563={..._0xa91351,'type':_0x157ae1(0x869),'content':_0x30da57['url'],'meaning':_0x157ae1(0x11a2)};break;case _0x157ae1(0xb1e):_0x16b563={..._0xa91351,'type':_0x157ae1(0xb1e),'content':_0x30da57[_0x157ae1(0x4e9)],'image_prompt':_0x30da57[_0x157ae1(0xef)]};break;case'voice_message':_0x16b563={..._0xa91351,'type':_0x157ae1(0xefa),'content':_0x30da57[_0x157ae1(0x1316)]};break;case'transfer':_0x16b563={..._0xa91351,'type':_0x157ae1(0xf4e),'amount':_0x30da57[_0x157ae1(0x116)],'note':_0x30da57[_0x157ae1(0x1187)],'receiverName':_0x30da57[_0x157ae1(0x7bc)]||'我'};break;case'waimai_request':_0x16b563={..._0xa91351,'type':_0x157ae1(0x1128),'productInfo':_0x30da57[_0x157ae1(0xaed)],'amount':_0x30da57[_0x157ae1(0x116)],'status':_0x157ae1(0xdaa),'countdownEndTime':Date[_0x157ae1(0x606)]()+0xf*0x3c*0x3e8};break;case'waimai_order':_0x16b563={..._0xa91351,'type':_0x157ae1(0x10e9),'productInfo':_0x30da57[_0x157ae1(0xaed)],'amount':_0x30da57[_0x157ae1(0x116)],'greeting':_0x30da57[_0x157ae1(0xf77)],'recipientName':_0x30da57[_0x157ae1(0x1143)]||null};break;case _0x157ae1(0x22b):_0x16b563={..._0xa91351,..._0x30da57};break;case _0x157ae1(0xb62):try{console[_0x157ae1(0x7d1)](_0x157ae1(0x284),_0x30da57[_0x157ae1(0xb55)]);const _0x985b08=_0x1567d3(_0x181f0f['id']),_0x322515=_0x30da57[_0x157ae1(0xb55)]||_0x157ae1(0xf5d),_0x524e46=_0x322515+',\x20'+_0x985b08['positive'],_0xb5d9dc=_0x985b08[_0x157ae1(0xd40)];console['log']('📝\x20使用'+(_0x985b08['source']===_0x157ae1(0x4c5)?'角色专属':'系统')+'提示词配置'),console[_0x157ae1(0x7d1)](_0x157ae1(0x635),_0x524e46),console[_0x157ae1(0x7d1)]('最终负面提示词:',_0xb5d9dc);const _0x42a305=localStorage[_0x157ae1(0x127d)](_0x157ae1(0x40a)),_0x5727f0=localStorage[_0x157ae1(0x127d)](_0x157ae1(0x10d0))||_0x157ae1(0xddf),_0x5625b7=_0xb80e9();if(!_0x42a305)throw new Error('NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。');const [_0x151085,_0x271664]=_0x5625b7['resolution'][_0x157ae1(0x90b)]('x')[_0x157ae1(0xbf6)](Number);let _0x32f5f1;_0x5727f0[_0x157ae1(0xd8d)](_0x157ae1(0x105a))?_0x32f5f1={'input':_0x524e46,'model':_0x5727f0,'action':_0x157ae1(0xe4),'parameters':{'params_version':0x3,'width':_0x151085,'height':_0x271664,'scale':_0x5625b7[_0x157ae1(0xd4a)],'sampler':_0x5625b7['sampler'],'steps':_0x5625b7[_0x157ae1(0x7e2)],'seed':_0x5625b7[_0x157ae1(0xa72)]===-0x1?Math[_0x157ae1(0xbd5)](Math[_0x157ae1(0x23a)]()*0x2540be3ff):_0x5625b7[_0x157ae1(0xa72)],'n_samples':0x1,'ucPreset':_0x5625b7[_0x157ae1(0x121c)],'qualityToggle':_0x5625b7[_0x157ae1(0x13d5)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x157ae1(0xa96),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x524e46,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0xb5d9dc,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0xb5d9dc,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x32f5f1={'input':_0x524e46,'model':_0x5727f0,'action':_0x157ae1(0xe4),'parameters':{'width':_0x151085,'height':_0x271664,'scale':_0x5625b7[_0x157ae1(0xd4a)],'sampler':_0x5625b7[_0x157ae1(0x4a2)],'steps':_0x5625b7['steps'],'seed':_0x5625b7[_0x157ae1(0xa72)]===-0x1?Math['floor'](Math[_0x157ae1(0x23a)]()*0x2540be3ff):_0x5625b7['seed'],'n_samples':0x1,'ucPreset':_0x5625b7[_0x157ae1(0x121c)],'qualityToggle':_0x5625b7['quality_toggle'],'sm':_0x5625b7[_0x157ae1(0x240)],'sm_dyn':_0x5625b7['smea_dyn'],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x157ae1(0x4cf),'negative_prompt':_0xb5d9dc}};console[_0x157ae1(0x7d1)](_0x157ae1(0xad0),_0x32f5f1);let _0x4bd3c7;_0x5727f0[_0x157ae1(0xd8d)](_0x157ae1(0x105a))?_0x4bd3c7=_0x157ae1(0xe8f):_0x4bd3c7=_0x157ae1(0x197);let _0x5b4f76=_0x5625b7[_0x157ae1(0x413)];_0x5b4f76===_0x157ae1(0x76a)&&(_0x5b4f76=_0x5625b7[_0x157ae1(0x2b8)]||'');_0x5b4f76&&_0x5b4f76!==''&&(_0x4bd3c7=_0x5b4f76+encodeURIComponent(_0x4bd3c7));const _0x2b9219=await fetch(_0x4bd3c7,{'method':_0x157ae1(0x1312),'headers':{'Content-Type':_0x157ae1(0xa0e),'Authorization':_0x157ae1(0x8aa)+_0x42a305},'body':JSON[_0x157ae1(0xc04)](_0x32f5f1)});console['log'](_0x157ae1(0x846),_0x2b9219[_0x157ae1(0x13b2)]),console[_0x157ae1(0x7d1)]('Response\x20headers:',[..._0x2b9219[_0x157ae1(0x371)]['entries']()]);if(!_0x2b9219['ok']){const _0x4c5b26=await _0x2b9219[_0x157ae1(0xdd5)]();console[_0x157ae1(0xb61)](_0x157ae1(0x8f),_0x4c5b26);throw new Error(_0x157ae1(0x6f9)+_0x2b9219['status']+_0x157ae1(0x352)+_0x4c5b26);}const _0x4e4ac1=_0x2b9219[_0x157ae1(0x371)][_0x157ae1(0x36d)](_0x157ae1(0x459));console[_0x157ae1(0x7d1)](_0x157ae1(0xfe6),_0x4e4ac1);let _0x3b2909,_0x462fc4;if(_0x4e4ac1&&_0x4e4ac1[_0x157ae1(0xd8d)](_0x157ae1(0xb45))){console[_0x157ae1(0x7d1)](_0x157ae1(0x287));const _0x218055=await _0x2b9219[_0x157ae1(0xdd5)]();console[_0x157ae1(0x7d1)](_0x157ae1(0xb3b),_0x218055['length']);const _0x265f80=_0x218055['trim']()[_0x157ae1(0x90b)]('\x0a');let _0x23dd3b=null;for(let _0x3a1546=_0x265f80['length']-0x1;_0x3a1546>=0x0;_0x3a1546--){const _0x3cada1=_0x265f80[_0x3a1546][_0x157ae1(0x2aa)]();if(_0x3cada1[_0x157ae1(0x13ad)](_0x157ae1(0x143f))&&_0x3cada1!==_0x157ae1(0x21d)){const _0x3c990c=_0x3cada1[_0x157ae1(0xa6d)](0x6);try{const _0x129155=JSON[_0x157ae1(0x44c)](_0x3c990c);if(_0x129155[_0x157ae1(0x100a)]==='final'&&_0x129155[_0x157ae1(0xefe)]){_0x23dd3b=_0x129155['image'],console[_0x157ae1(0x7d1)](_0x157ae1(0x1313));break;}if(_0x129155[_0x157ae1(0x76b)]){_0x23dd3b=_0x129155['data'],console[_0x157ae1(0x7d1)]('从\x20JSON.data\x20中提取图片数据');break;}if(_0x129155['image']){_0x23dd3b=_0x129155[_0x157ae1(0xefe)],console[_0x157ae1(0x7d1)](_0x157ae1(0xde4));break;}}catch(_0x1a1b27){_0x23dd3b=_0x3c990c,console[_0x157ae1(0x7d1)](_0x157ae1(0x71));break;}}}if(!_0x23dd3b)throw new Error(_0x157ae1(0x1199));const _0x3fc8e1=_0x23dd3b['startsWith'](_0x157ae1(0xca4)),_0x2cc744=_0x23dd3b[_0x157ae1(0x13ad)](_0x157ae1(0x2b7));if(_0x3fc8e1||_0x2cc744){console[_0x157ae1(0x7d1)]('✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)');const _0x1bc02c=atob(_0x23dd3b),_0x49057a=new Uint8Array(_0x1bc02c['length']);for(let _0x1249ca=0x0;_0x1249ca<_0x1bc02c['length'];_0x1249ca++){_0x49057a[_0x1249ca]=_0x1bc02c[_0x157ae1(0x12f3)](_0x1249ca);}const _0x1d9447=new Blob([_0x49057a],{'type':_0x3fc8e1?_0x157ae1(0x100d):_0x157ae1(0x229)});console['log'](_0x157ae1(0xc55),_0x1d9447[_0x157ae1(0x12a4)]);const _0x114c9f=new FileReader();_0x462fc4=await new Promise((_0x5923ed,_0x2ecfb0)=>{const _0x3e3478=_0x157ae1;_0x114c9f[_0x3e3478(0x13a7)]=()=>_0x5923ed(_0x114c9f[_0x3e3478(0x2ed)]),_0x114c9f[_0x3e3478(0x4de)]=_0x2ecfb0,_0x114c9f[_0x3e3478(0x96e)](_0x1d9447);}),console[_0x157ae1(0x7d1)](_0x157ae1(0xf41));}else{console['log']('当作\x20ZIP\x20文件处理...');const _0x22c01a=atob(_0x23dd3b),_0x41c865=new Uint8Array(_0x22c01a[_0x157ae1(0x131d)]);for(let _0xbdad5d=0x0;_0xbdad5d<_0x22c01a[_0x157ae1(0x131d)];_0xbdad5d++){_0x41c865[_0xbdad5d]=_0x22c01a[_0x157ae1(0x12f3)](_0xbdad5d);}_0x3b2909=new Blob([_0x41c865]),console[_0x157ae1(0x7d1)](_0x157ae1(0x145a),_0x3b2909['size']);}}else _0x3b2909=await _0x2b9219[_0x157ae1(0x43d)](),console[_0x157ae1(0x7d1)](_0x157ae1(0xca9),_0x3b2909['type'],'大小:',_0x3b2909['size']);if(!_0x462fc4&&_0x3b2909)try{if(typeof JSZip===_0x157ae1(0x37c))throw new Error(_0x157ae1(0xc3c));const _0x58eb49=await JSZip['loadAsync'](_0x3b2909);console['log'](_0x157ae1(0x119f),Object['keys'](_0x58eb49[_0x157ae1(0x1a9)]));let _0x1e9eb6=null;for(let _0x59f719 in _0x58eb49['files']){if(_0x59f719[_0x157ae1(0x41c)](/\.(png|jpg|jpeg|webp)$/i)){_0x1e9eb6=_0x58eb49[_0x157ae1(0x1a9)][_0x59f719],console[_0x157ae1(0x7d1)]('找到图片文件:',_0x59f719);break;}}if(!_0x1e9eb6)throw new Error('ZIP文件中未找到图片');const _0x20c2ca=await _0x1e9eb6[_0x157ae1(0x890)]('blob');console['log'](_0x157ae1(0x1259),_0x20c2ca[_0x157ae1(0x12a4)]);const _0x5f43ce=new FileReader();_0x462fc4=await new Promise((_0x59b723,_0x46a129)=>{const _0x4758ed=_0x157ae1;_0x5f43ce[_0x4758ed(0x13a7)]=()=>_0x59b723(_0x5f43ce[_0x4758ed(0x2ed)]),_0x5f43ce[_0x4758ed(0x4de)]=_0x46a129,_0x5f43ce[_0x4758ed(0x96e)](_0x20c2ca);}),console['log'](_0x157ae1(0xdb9));}catch(_0x4cc60c){console[_0x157ae1(0xb61)](_0x157ae1(0xab5),_0x4cc60c);throw new Error(_0x157ae1(0x1c5)+_0x4cc60c['message']);}console[_0x157ae1(0x7d1)]('✅\x20NAI图片生成成功！'),_0x16b563={..._0xa91351,'type':_0x157ae1(0xb62),'imageUrl':_0x462fc4,'prompt':_0x322515,'fullPrompt':_0x524e46};}catch(_0x1344fe){console[_0x157ae1(0xb61)](_0x157ae1(0xf68),_0x1344fe),_0x16b563={..._0xa91351,'content':'[图片生成失败:\x20'+_0x1344fe[_0x157ae1(0x7aa)]+']'};}break;default:console[_0x157ae1(0x1b6)](_0x157ae1(0x376),_0x30da57[_0x157ae1(0x259)]);break;}if(_0x16b563){_0x181f0f[_0x157ae1(0x1d5)]['push'](_0x16b563);!_0x4db52b&&(_0x181f0f[_0x157ae1(0x12c9)]=(_0x181f0f['unreadCount']||0x0)+0x1);if(!_0x4db52b&&!_0xa90a3e){let _0x5605d8;switch(_0x16b563[_0x157ae1(0x259)]){case'transfer':_0x5605d8=_0x157ae1(0x136f);break;case _0x157ae1(0x1128):_0x5605d8=_0x157ae1(0xbe6);break;case'ai_image':_0x5605d8='[图片]';break;case _0x157ae1(0xefa):_0x5605d8=_0x157ae1(0x8a0);break;case _0x157ae1(0x869):_0x5605d8=_0x16b563['meaning']?_0x157ae1(0x21f)+_0x16b563['meaning']+']':_0x157ae1(0x131);break;case _0x157ae1(0x22b):_0x5605d8=_0x16b563[_0x157ae1(0x4d9)]?'「'+_0x16b563[_0x157ae1(0x4d9)]+'」':'['+_0x16b563[_0x157ae1(0x4e9)][_0x157ae1(0xa6d)](0x0,0x14)+'...]';break;default:_0x5605d8=String(_0x16b563[_0x157ae1(0x1316)]||'');}const _0x1f2d29=_0x181f0f['isGroup']?_0x16b563[_0x157ae1(0x2a3)]+':\x20'+_0x5605d8:_0x5605d8;_0x478393(_0x27c6c8,_0x1f2d29['substring'](0x0,0x28)+(_0x1f2d29['length']>0x28?_0x157ae1(0x10a0):'')),_0xa90a3e=!![];}_0x4db52b&&(_0x5d5ee2(_0x16b563,_0x181f0f),await new Promise(_0xc7044c=>setTimeout(_0xc7044c,Math[_0x157ae1(0x23a)]()*0x708+0x3e8)));}}_0x279d8f&&_0x4a3337[_0x157ae1(0x60a)]&&(_0x4a3337[_0x157ae1(0x9a6)]=![],_0x4a3337[_0x157ae1(0x1008)][_0x157ae1(0x131d)]>0x0?_0x309acd():(_0x4a3337={..._0x4a3337,'isAwaitingResponse':![],'participants':[]},_0x589d88(_0x157ae1(0xd99)),alert('无人接听群聊邀请。')));if(_0x1eb741){await _0x3ee822();return;}await _0x17d534[_0x157ae1(0x954)][_0x157ae1(0xf3f)](_0x181f0f);const _0x12e2be=_0x1918ac[_0x157ae1(0x593)](_0x159fe9=>_0x159fe9[_0x157ae1(0x259)]==='qzone_post'||_0x159fe9[_0x157ae1(0x259)]===_0x157ae1(0xc72)||_0x159fe9['type']===_0x157ae1(0x1032)||_0x159fe9[_0x157ae1(0x259)]==='repost');_0x12e2be&&(console[_0x157ae1(0x7d1)](_0x157ae1(0x136c)),await _0x316550());}catch(_0x964d17){_0x181f0f[_0x157ae1(0x1d5)]=_0x181f0f['history'][_0x157ae1(0xaf1)](_0x4cc3de=>!_0x4cc3de[_0x157ae1(0x85d)]),!_0x181f0f[_0x157ae1(0x726)]&&_0x181f0f[_0x157ae1(0x569)]?.[_0x157ae1(0x13b2)]===_0x157ae1(0x11f8)?(_0x181f0f[_0x157ae1(0x569)]['status']=_0x157ae1(0x12b0),await _0x34fce8(_0x157ae1(0x8ab),'AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20'+_0x964d17['message'])):await _0x34fce8(_0x157ae1(0x7e6),_0x157ae1(0x1007)+_0x964d17[_0x157ae1(0x7aa)]),!_0x181f0f[_0x157ae1(0x726)]&&_0x181f0f['relationship']?.['status']==='blocked_by_ai'&&await _0x17d534[_0x157ae1(0x954)]['put'](_0x181f0f),_0x4a3337[_0x157ae1(0x9a6)]=![];}finally{_0x260324(_0x27c6c8,![]),_0x181f0f[_0x157ae1(0x726)]?_0x153235&&(_0x153235[_0x157ae1(0x1104)][_0x157ae1(0x4db)]=_0x157ae1(0x464)):_0x5856ac&&_0x42f206['chats'][_0x27c6c8]&&(_0x5856ac[_0x157ae1(0x1104)][_0x157ae1(0x539)]=0x0,setTimeout(()=>{const _0xc61522=_0x157ae1;_0x5856ac['textContent']=_0x42f206['chats'][_0x27c6c8][_0xc61522(0x132a)],_0x5856ac[_0xc61522(0x11c2)][_0xc61522(0x1097)](_0xc61522(0x417)),_0x5856ac['style'][_0xc61522(0x539)]=0x1;},0xc8)),_0x27be5e(),_0x228e99&&_0x3a9d2a(_0x27c6c8),_0x5bc960();}}async function _0x5d55d6(_0x2b6bcf){const _0x2c5075=_0x204348;if(!_0x42f206[_0x2c5075(0x81d)])return;const _0x1e3583=_0x42f206[_0x2c5075(0x954)][_0x42f206['activeChatId']],_0x3a5de9={'role':_0x2c5075(0xf86),'content':_0x2b6bcf[_0x2c5075(0x1377)],'meaning':_0x2b6bcf[_0x2c5075(0x132a)],'timestamp':Date[_0x2c5075(0x606)]()};_0x1e3583[_0x2c5075(0x1d5)][_0x2c5075(0x129e)](_0x3a5de9),await _0x17d534['chats']['put'](_0x1e3583),_0x5d5ee2(_0x3a5de9,_0x1e3583),_0x27be5e(),document[_0x2c5075(0x458)](_0x2c5075(0x45c))['classList']['remove'](_0x2c5075(0x67d));}async function _0x460286(){const _0x32011e=_0x204348;if(!_0x42f206[_0x32011e(0x81d)])return;const _0x1bbd7a=document[_0x32011e(0x458)](_0x32011e(0x257)),_0x2b4073=document[_0x32011e(0x458)](_0x32011e(0x8ee)),_0x563ef3=parseFloat(_0x1bbd7a[_0x32011e(0x8dd)]),_0x2988f5=_0x2b4073[_0x32011e(0x8dd)]['trim']();if(isNaN(_0x563ef3)||_0x563ef3<0x0){alert(_0x32011e(0x143e));return;}const _0x301308=_0x42f206[_0x32011e(0x954)][_0x42f206[_0x32011e(0x81d)]],_0x19dcc9=_0x301308[_0x32011e(0x726)]?_0x301308[_0x32011e(0xda2)][_0x32011e(0xc7d)]||'我':'我',_0x20f0f4=_0x301308[_0x32011e(0x726)]?'群聊':_0x301308[_0x32011e(0x132a)],_0x2411ad={'role':'user','type':_0x32011e(0xf4e),'amount':_0x563ef3,'note':_0x2988f5,'senderName':_0x19dcc9,'receiverName':_0x20f0f4,'timestamp':Date[_0x32011e(0x606)]()};_0x301308['history'][_0x32011e(0x129e)](_0x2411ad),await _0x17d534[_0x32011e(0x954)]['put'](_0x301308),_0x5d5ee2(_0x2411ad,_0x301308),_0x27be5e(),document['getElementById']('transfer-modal')[_0x32011e(0x11c2)][_0x32011e(0x1097)](_0x32011e(0x67d)),_0x1bbd7a[_0x32011e(0x8dd)]='',_0x2b4073['value']='';}async function _0x4d2f70(){const _0x3ce4da=_0x204348;if(!_0x42f206[_0x3ce4da(0x81d)])return;const _0x1ac59f=document[_0x3ce4da(0x458)]('waimai-product-info'),_0x559452=document[_0x3ce4da(0x458)](_0x3ce4da(0x1235)),_0x36f8b2=_0x1ac59f[_0x3ce4da(0x8dd)][_0x3ce4da(0x2aa)](),_0x1649b8=parseFloat(_0x559452[_0x3ce4da(0x8dd)]);if(!_0x36f8b2||isNaN(_0x1649b8)||_0x1649b8<=0x0){alert(_0x3ce4da(0x86c));return;}const _0x392b03=_0x42f206[_0x3ce4da(0x954)][_0x42f206[_0x3ce4da(0x81d)]],_0x12094d=Date[_0x3ce4da(0x606)](),_0x5e74ad=_0x392b03['isGroup']?_0x392b03['settings'][_0x3ce4da(0xc7d)]||'我':'我',_0x31c420={'role':_0x3ce4da(0xf86),'senderName':_0x5e74ad,'type':_0x3ce4da(0x10e9),'productInfo':_0x36f8b2,'amount':_0x1649b8,'timestamp':_0x12094d};_0x392b03[_0x3ce4da(0x1d5)][_0x3ce4da(0x129e)](_0x31c420);const _0x4683a2={'role':_0x3ce4da(0x1370),'content':_0x3ce4da(0x615)+_0x5e74ad+')为你点了一份外卖作为【礼物】。外卖内容是“'+_0x36f8b2+_0x3ce4da(0x973)+_0x1649b8+_0x3ce4da(0x3a5),'timestamp':_0x12094d+0x1,'isHidden':!![]};_0x392b03[_0x3ce4da(0x1d5)]['push'](_0x4683a2),await _0x17d534[_0x3ce4da(0x954)][_0x3ce4da(0xf3f)](_0x392b03),_0x5d5ee2(_0x31c420,_0x392b03),_0x27be5e(),_0x1ac59f[_0x3ce4da(0x8dd)]='',_0x559452[_0x3ce4da(0x8dd)]='',document[_0x3ce4da(0x458)](_0x3ce4da(0xd53))[_0x3ce4da(0x11c2)][_0x3ce4da(0x1097)](_0x3ce4da(0x67d));}async function _0x3d4cde(){const _0x24f728=_0x204348;if(!_0x42f206[_0x24f728(0x81d)])return;const _0x5df187=await _0x335e57('共享位置','你现在在哪里呀？','');if(!_0x5df187||!_0x5df187['trim']())return;const _0x358611=_0x24f728(0xcb2),_0x129248=_0x42f206[_0x24f728(0x954)][_0x42f206[_0x24f728(0x81d)]],_0x16d228={'role':_0x24f728(0xf86),'type':'location_share','content':_0x5df187[_0x24f728(0x2aa)](),'imageUrl':_0x358611,'timestamp':Date[_0x24f728(0x606)]()};_0x129248[_0x24f728(0x1d5)][_0x24f728(0x129e)](_0x16d228),await _0x17d534[_0x24f728(0x954)]['put'](_0x129248),_0x5d5ee2(_0x16d228,_0x129248),_0x27be5e();}function _0x2a3f29(_0x32a70c){const _0xeda565=_0x204348;if(_0x2b45d0)return;_0x2b45d0=!![],document['getElementById'](_0xeda565(0xd99))['classList'][_0xeda565(0xa58)](_0xeda565(0xd15)),_0x32bda0(_0x32a70c);}function _0x5bc130(){const _0x46dc7f=_0x204348;_0x34dfd6();if(!_0x2b45d0)return;_0x2b45d0=![],document[_0x46dc7f(0x458)](_0x46dc7f(0xd99))['classList'][_0x46dc7f(0x1097)]('selection-mode'),_0x3e3048['forEach'](_0x5e19ba=>{const _0x2c9616=_0x46dc7f,_0x4863fb=document[_0x2c9616(0x586)](_0x2c9616(0x12da)+_0x5e19ba+'\x22]');if(_0x4863fb)_0x4863fb[_0x2c9616(0x11c2)][_0x2c9616(0x1097)](_0x2c9616(0x500));}),_0x3e3048[_0x46dc7f(0x415)]();}function _0x32bda0(_0x2fb4ef){const _0x24d5ac=_0x204348,_0xf4955b=document['querySelector']('.message-bubble[data-timestamp=\x22'+_0x2fb4ef+'\x22]');if(!_0xf4955b)return;_0x3e3048[_0x24d5ac(0x31c)](_0x2fb4ef)?(_0x3e3048[_0x24d5ac(0x195)](_0x2fb4ef),_0xf4955b[_0x24d5ac(0x11c2)][_0x24d5ac(0x1097)](_0x24d5ac(0x500))):(_0x3e3048[_0x24d5ac(0xa58)](_0x2fb4ef),_0xf4955b[_0x24d5ac(0x11c2)][_0x24d5ac(0xa58)](_0x24d5ac(0x500))),document[_0x24d5ac(0x458)](_0x24d5ac(0x105b))['textContent']=_0x24d5ac(0x13f2)+_0x3e3048[_0x24d5ac(0x12a4)]+'\x20条',_0x3e3048[_0x24d5ac(0x12a4)]===0x0&&_0x5bc130();}function _0x4376d8(_0x353697,_0xe7f70e){const _0x52fa81=_0x204348;let _0x1674bb;const _0x2aa049=_0x2c8b8d=>{const _0x1787da=_0x1a5b;if(_0x2b45d0)return;_0x2c8b8d[_0x1787da(0xae3)](),_0x1674bb=window[_0x1787da(0x28b)](()=>_0xe7f70e(_0x2c8b8d),0x1f4);},_0x1c87b7=()=>clearTimeout(_0x1674bb);_0x353697[_0x52fa81(0xd85)]('mousedown',_0x2aa049),_0x353697['addEventListener'](_0x52fa81(0x1120),_0x1c87b7),_0x353697[_0x52fa81(0xd85)](_0x52fa81(0xcb1),_0x1c87b7),_0x353697['addEventListener'](_0x52fa81(0xcbd),_0x2aa049,{'passive':!![]}),_0x353697[_0x52fa81(0xd85)]('touchend',_0x1c87b7),_0x353697[_0x52fa81(0xd85)](_0x52fa81(0xfc2),_0x1c87b7);}async function _0x96fbb6(){const _0x4343e5=_0x204348,_0x256240=_0x42f206['activeChatId'];if(!_0x256240)return;if(!_0x59377b[_0x4343e5(0x1196)]){_0x26365c(_0x256240);return;}if(_0x59377b[_0x4343e5(0x81d)]===_0x256240)document[_0x4343e5(0x458)](_0x4343e5(0x2df))['classList'][_0x4343e5(0xa58)](_0x4343e5(0x67d));else{const _0x28988e=_0x42f206[_0x4343e5(0x954)][_0x59377b[_0x4343e5(0x81d)]]?.[_0x4343e5(0x132a)]||'未知',_0x2a9d1b=_0x42f206[_0x4343e5(0x954)][_0x256240]?.[_0x4343e5(0x132a)]||'当前',_0x12b0a7=await _0x2532b9(_0x4343e5(0x827),_0x4343e5(0xe06)+_0x28988e+'」听歌。要结束并开始和「'+_0x2a9d1b+_0x4343e5(0x19c),{'confirmButtonClass':_0x4343e5(0x4d3)});_0x12b0a7&&(await _0x361813(!![]),await new Promise(_0x2a4e1e=>setTimeout(_0x2a4e1e,0x32)),_0x26365c(_0x256240));}}async function _0x26365c(_0xea720){const _0x4e787d=_0x204348,_0x1abd89=_0x42f206[_0x4e787d(0x954)][_0xea720];if(!_0x1abd89)return;_0x59377b[_0x4e787d(0xdf)]=_0x1abd89[_0x4e787d(0xc3a)][_0x4e787d(0xba0)]||0x0,_0x59377b[_0x4e787d(0x1196)]=!![],_0x59377b[_0x4e787d(0x81d)]=_0xea720;_0x59377b[_0x4e787d(0x1102)][_0x4e787d(0x131d)]>0x0?_0x59377b[_0x4e787d(0x4bd)]=0x0:_0x59377b['currentIndex']=-0x1;if(_0x59377b[_0x4e787d(0xee2)])clearInterval(_0x59377b[_0x4e787d(0xee2)]);_0x59377b[_0x4e787d(0xee2)]=setInterval(()=>{const _0x2a04ac=_0x4e787d;_0x59377b[_0x2a04ac(0x1111)]&&(_0x59377b['totalElapsedTime']++,_0x4b5ef1());},0x3e8),_0x481fb2(),_0xe64ac7(),document['getElementById'](_0x4e787d(0x2df))[_0x4e787d(0x11c2)][_0x4e787d(0xa58)](_0x4e787d(0x67d));}async function _0x361813(_0x2b5746=!![]){const _0x2ca35b=_0x204348;if(!_0x59377b[_0x2ca35b(0x1196)])return;const _0x5ae102=_0x59377b[_0x2ca35b(0x81d)];document['getElementById'](_0x2ca35b(0x5d4))['classList']['remove']('visible');const _0x1d40ae=async()=>{const _0xb07f0b=_0x2ca35b;if(_0x59377b[_0xb07f0b(0xee2)])clearInterval(_0x59377b[_0xb07f0b(0xee2)]);if(_0x59377b[_0xb07f0b(0x1111)])_0x112d48['pause']();if(_0x2b5746&&_0x5ae102&&_0x42f206[_0xb07f0b(0x954)][_0x5ae102]){const _0x4e86b4=_0x42f206[_0xb07f0b(0x954)][_0x5ae102];_0x4e86b4[_0xb07f0b(0xc3a)]['totalTime']=_0x59377b[_0xb07f0b(0xdf)],await _0x17d534[_0xb07f0b(0x954)][_0xb07f0b(0xf3f)](_0x4e86b4);}_0x59377b[_0xb07f0b(0x1196)]=![],_0x59377b[_0xb07f0b(0x81d)]=null,_0x59377b[_0xb07f0b(0xdf)]=0x0,_0x59377b[_0xb07f0b(0xee2)]=null,_0xef9fd3(_0x5ae102,!![]);};_0x85f5df(_0x1d40ae);}function _0x4f6f89(){_0x85f5df();}function _0xef9fd3(_0x516c47,_0x167303=![]){const _0x2968de=_0x204348,_0x2fc45c=document[_0x2968de(0x586)]('#listen-together-btn\x20img');if(!_0x2fc45c)return;if(_0x167303||!_0x59377b['isActive']||_0x59377b['activeChatId']!==_0x516c47){_0x2fc45c['src']=_0x2968de(0x446),_0x2fc45c[_0x2968de(0x69b)]='';return;}_0x2fc45c[_0x2968de(0x577)]=_0x2968de(0x90),_0x2fc45c[_0x2968de(0x11c2)][_0x2968de(0xa58)](_0x2968de(0x154));if(_0x59377b[_0x2968de(0x1111)])_0x2fc45c[_0x2968de(0x11c2)][_0x2968de(0x1097)](_0x2968de(0xf7a));else _0x2fc45c[_0x2968de(0x11c2)][_0x2968de(0xa58)](_0x2968de(0xf7a));}window['updateListenTogetherIconProxy']=_0xef9fd3;function _0x481fb2(){const _0x1caccb=_0x204348;_0xef9fd3(_0x59377b['activeChatId']),_0x4b5ef1();const _0x40527c=document[_0x1caccb(0x458)](_0x1caccb(0x9cb)),_0x49311f=document[_0x1caccb(0x458)]('music-player-artist'),_0x4d2593=document[_0x1caccb(0x458)](_0x1caccb(0x612));if(_0x59377b[_0x1caccb(0x4bd)]>-0x1&&_0x59377b['playlist'][_0x1caccb(0x131d)]>0x0){const _0x2bc102=_0x59377b[_0x1caccb(0x1102)][_0x59377b['currentIndex']];_0x40527c[_0x1caccb(0x1a2)]=_0x2bc102[_0x1caccb(0x132a)],_0x49311f[_0x1caccb(0x1a2)]=_0x2bc102[_0x1caccb(0xd81)];}else _0x40527c[_0x1caccb(0x1a2)]=_0x1caccb(0x50e),_0x49311f[_0x1caccb(0x1a2)]=_0x1caccb(0x10a0);_0x4d2593[_0x1caccb(0x1a2)]=_0x59377b[_0x1caccb(0x1111)]?'❚❚':'▶';}function _0x4b5ef1(){const _0x2ee550=_0x204348,_0x40c604=(_0x59377b[_0x2ee550(0xdf)]/0xe10)['toFixed'](0x1);document['getElementById'](_0x2ee550(0xf55))[_0x2ee550(0x1a2)]=_0x2ee550(0x13de)+_0x40c604+'小时';}function _0xe64ac7(){const _0x37d635=_0x204348,_0x481e75=document[_0x37d635(0x458)](_0x37d635(0x67c));_0x481e75[_0x37d635(0x110d)]='';if(_0x59377b[_0x37d635(0x1102)]['length']===0x0){_0x481e75[_0x37d635(0x110d)]=_0x37d635(0x1300);return;}_0x59377b[_0x37d635(0x1102)][_0x37d635(0x12c2)]((_0xd086fa,_0x39d11b)=>{const _0xe4fdb5=_0x37d635,_0x12f973=document[_0xe4fdb5(0xe7d)](_0xe4fdb5(0x1323));_0x12f973[_0xe4fdb5(0x69b)]=_0xe4fdb5(0x7d4);if(_0x39d11b===_0x59377b[_0xe4fdb5(0x4bd)])_0x12f973['classList'][_0xe4fdb5(0xa58)](_0xe4fdb5(0x134));_0x12f973['innerHTML']=_0xe4fdb5(0x553)+_0xd086fa[_0xe4fdb5(0x132a)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>'+_0xd086fa[_0xe4fdb5(0xd81)]+_0xe4fdb5(0x6d8)+_0x39d11b+_0xe4fdb5(0x6fc)+_0x39d11b+_0xe4fdb5(0x84f)+_0x39d11b+'\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22'+_0x39d11b+'\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a',_0x12f973[_0xe4fdb5(0x586)](_0xe4fdb5(0x532))['addEventListener'](_0xe4fdb5(0x1122),()=>_0x50e8cd(_0x39d11b)),_0x481e75['appendChild'](_0x12f973);});}async function _0x4fd0ef(){const _0x5060c8=_0x204348;if(_0x112d48['paused']){if(_0x59377b[_0x5060c8(0x4bd)]===-0x1&&_0x59377b[_0x5060c8(0x1102)][_0x5060c8(0x131d)]>0x0)_0x50e8cd(0x0);else _0x59377b['currentIndex']>-0x1&&_0x50e8cd(_0x59377b[_0x5060c8(0x4bd)]);}else _0x112d48['pause'](),await _0x29e100(_0x5060c8(0x334));}function _0x106240(){const _0x15b461=_0x204348;if(_0x59377b['playlist']['length']===0x0)return;let _0x115ec1;switch(_0x59377b['playMode']){case _0x15b461(0x23a):_0x115ec1=Math[_0x15b461(0xbd5)](Math[_0x15b461(0x23a)]()*_0x59377b['playlist'][_0x15b461(0x131d)]);break;case _0x15b461(0x2e0):_0x50e8cd(_0x59377b[_0x15b461(0x4bd)]);return;case _0x15b461(0x1ec):default:_0x115ec1=(_0x59377b[_0x15b461(0x4bd)]+0x1)%_0x59377b[_0x15b461(0x1102)][_0x15b461(0x131d)];break;}_0x50e8cd(_0x115ec1);}function _0x14faf6(){const _0x1f6a2d=_0x204348;if(_0x59377b['playlist'][_0x1f6a2d(0x131d)]===0x0)return;const _0x420324=(_0x59377b[_0x1f6a2d(0x4bd)]-0x1+_0x59377b['playlist'][_0x1f6a2d(0x131d)])%_0x59377b['playlist'][_0x1f6a2d(0x131d)];_0x50e8cd(_0x420324);}function _0xb6ae9a(){const _0x124fdb=_0x204348,_0x200675=[_0x124fdb(0x1ec),'random','single'],_0xccb6da=_0x200675['indexOf'](_0x59377b[_0x124fdb(0x93a)]);_0x59377b[_0x124fdb(0x93a)]=_0x200675[(_0xccb6da+0x1)%_0x200675[_0x124fdb(0x131d)]],document[_0x124fdb(0x458)](_0x124fdb(0x209))['textContent']={'order':'顺序','random':'随机','single':'单曲'}[_0x59377b[_0x124fdb(0x93a)]];}async function _0x2161d7(){const _0x4e8410=_0x204348,_0x462c8f=await _0x335e57(_0x4e8410(0x13ab),_0x4e8410(0xeca),'','url');if(!_0x462c8f)return;const _0x15fb02=await _0x335e57(_0x4e8410(0xba4),_0x4e8410(0x1139));if(!_0x15fb02)return;const _0x6b62af=await _0x335e57(_0x4e8410(0xba4),'请输入歌手名');if(!_0x6b62af)return;_0x59377b[_0x4e8410(0x1102)][_0x4e8410(0x129e)]({'name':_0x15fb02,'artist':_0x6b62af,'src':_0x462c8f,'isLocal':![]}),await _0x562193(),_0xe64ac7(),_0x59377b[_0x4e8410(0x4bd)]===-0x1&&(_0x59377b[_0x4e8410(0x4bd)]=_0x59377b[_0x4e8410(0x1102)][_0x4e8410(0x131d)]-0x1,_0x481fb2());}async function _0x2bd74c(_0x3953d7){const _0x23d3c8=_0x204348,_0x43ffc7=_0x3953d7[_0x23d3c8(0x12df)][_0x23d3c8(0x1a9)];if(!_0x43ffc7[_0x23d3c8(0x131d)])return;for(const _0x553af4 of _0x43ffc7){let _0x415b12=_0x553af4[_0x23d3c8(0x132a)]['replace'](/\.[^/.]+$/,'');_0x415b12=await _0x335e57(_0x23d3c8(0xba4),_0x23d3c8(0x1139),_0x415b12);if(_0x415b12===null)continue;const _0x4d9356=await _0x335e57(_0x23d3c8(0xba4),_0x23d3c8(0x6d6),'未知歌手');if(_0x4d9356===null)continue;const _0x47f3a2=await _0x553af4[_0x23d3c8(0x1159)]();let _0x3adf6b='';const _0x350cc9=await _0x2532b9(_0x23d3c8(0x328),_0x23d3c8(0xda0)+_0x415b12+_0x23d3c8(0xa69));_0x350cc9&&(_0x3adf6b=await _0x122402()||''),_0x59377b[_0x23d3c8(0x1102)]['push']({'name':_0x415b12,'artist':_0x4d9356,'src':_0x47f3a2,'fileType':_0x553af4[_0x23d3c8(0x259)],'isLocal':!![],'lrcContent':_0x3adf6b,'cover':_0x23d3c8(0xe57)});}await _0x562193(),_0xe64ac7(),_0x59377b['currentIndex']===-0x1&&_0x59377b[_0x23d3c8(0x1102)]['length']>0x0&&(_0x59377b['currentIndex']=0x0,_0x481fb2()),_0x3953d7[_0x23d3c8(0x12df)]['value']=null;}async function _0x50e8cd(_0x478d28){const _0x191ee6=_0x204348;if(_0x478d28<0x0||_0x478d28>=_0x59377b[_0x191ee6(0x1102)][_0x191ee6(0x131d)])return;_0x112d48[_0x191ee6(0x16a)](),_0x59377b[_0x191ee6(0x4bd)]=_0x478d28;const _0xa58f=_0x59377b[_0x191ee6(0x1102)][_0x478d28],_0x273556=_0x42f206[_0x191ee6(0x954)][_0x59377b[_0x191ee6(0x81d)]],_0x32ee0a=document[_0x191ee6(0x458)]('music-player-avatar-display');if(_0x273556&&_0x32ee0a){_0x32ee0a['innerHTML']='';const _0x223524=_0x273556[_0x191ee6(0x726)]?_0x273556[_0x191ee6(0xfa8)][_0x191ee6(0xb07)](_0xf6db3=>_0xf6db3['originalName']===_0xa58f[_0x191ee6(0xd81)])?.['avatar']||_0x4fd084:_0x273556[_0x191ee6(0xda2)]['aiAvatar']||_0x4fd084,_0x538e82=_0x273556['settings'][_0x191ee6(0xa6)]||_0x4fd084,_0xe8d2ca=document[_0x191ee6(0xe7d)]('img');_0xe8d2ca[_0x191ee6(0x577)]=_0x223524,_0xe8d2ca['className']='participant-display-avatar',_0xe8d2ca[_0x191ee6(0x647)]=_0x191ee6(0x9e3),_0x32ee0a[_0x191ee6(0x1079)](_0xe8d2ca);const _0x109440=document[_0x191ee6(0xe7d)](_0x191ee6(0x82a));_0x109440['src']=_0x538e82,_0x109440[_0x191ee6(0x69b)]=_0x191ee6(0xba5),_0x109440['alt']=_0x191ee6(0xd6d),_0x32ee0a[_0x191ee6(0x1079)](_0x109440);}const _0x1c6d42=document[_0x191ee6(0x586)](_0x191ee6(0xef6)),_0x28c200=document[_0x191ee6(0x458)](_0x191ee6(0xb7));_0x1c6d42&&(_0x1c6d42[_0x191ee6(0x1104)]['setProperty']('--music-bg-image',_0xa58f[_0x191ee6(0x13ed)]?_0x191ee6(0xfa)+_0xa58f['background']+')':'none'),_0x1c6d42[_0x191ee6(0x11c2)]['toggle'](_0x191ee6(0x11f2),!!_0xa58f[_0x191ee6(0x13b4)]));_0x28c200&&_0x28c200[_0x191ee6(0x11c2)][_0x191ee6(0x1270)](_0x191ee6(0xfe1),!!_0xa58f[_0x191ee6(0x13b4)]);document[_0x191ee6(0x458)]('music-visual-container')['classList'][_0x191ee6(0x1097)](_0x191ee6(0xec1));const _0x19fd19=document[_0x191ee6(0x458)](_0x191ee6(0xad4));_0x19fd19&&(_0x19fd19[_0x191ee6(0x577)]=_0xa58f[_0x191ee6(0x847)]||_0x191ee6(0xe57));await _0x29e100(_0x191ee6(0x119)+_0xa58f[_0x191ee6(0x132a)]+'》'),_0x59377b[_0x191ee6(0x169)]=_0x3e0f49(_0xa58f[_0x191ee6(0x11ec)]||''),_0x1616be();const _0x1c5ab6=document[_0x191ee6(0x458)](_0x191ee6(0x133d));_0x1c5ab6&&(!_0x59377b['parsedLyrics']||_0x59377b[_0x191ee6(0x169)][_0x191ee6(0x131d)]===0x0?_0x1c5ab6[_0x191ee6(0x1a2)]=_0x191ee6(0x3cf):_0x1c5ab6[_0x191ee6(0x1a2)]=_0x191ee6(0xcce));if(_0xa58f[_0x191ee6(0x7e9)]&&_0xa58f[_0x191ee6(0x577)]instanceof ArrayBuffer){const _0x452114=new Blob([_0xa58f[_0x191ee6(0x577)]],{'type':_0xa58f[_0x191ee6(0x134d)]||_0x191ee6(0x80e)});_0x112d48['src']=URL[_0x191ee6(0x795)](_0x452114);}else{if(_0xa58f['isLocal']&&_0xa58f[_0x191ee6(0x577)]instanceof Blob)_0x112d48[_0x191ee6(0x577)]=URL[_0x191ee6(0x795)](_0xa58f[_0x191ee6(0x577)]);else{if(!_0xa58f[_0x191ee6(0x7e9)])_0x112d48[_0x191ee6(0x577)]=_0xa58f[_0x191ee6(0x577)];else{console['error']('本地歌曲源错误:',_0xa58f);return;}}}const _0x4dc3a7=_0x112d48[_0x191ee6(0x1391)]();_0x4dc3a7!==undefined&&_0x4dc3a7[_0x191ee6(0x1135)](_0x58aadd=>{const _0x490be0=_0x191ee6;if(_0x58aadd[_0x490be0(0x132a)]===_0x490be0(0x35d))console[_0x490be0(0x1b6)](_0x490be0(0x35f)),_0x112d48[_0x490be0(0x16a)](),_0x34fce8('播放已暂停',_0x490be0(0x11ab));else _0x58aadd[_0x490be0(0x132a)]!=='AbortError'&&console[_0x490be0(0xb61)](_0x490be0(0x1005),_0x58aadd);});_0xe64ac7(),_0x481fb2(),_0x2a7978();const _0x14caae=document['getElementById'](_0x191ee6(0x5d4));_0x59377b['parsedLyrics']&&_0x59377b[_0x191ee6(0x169)][_0x191ee6(0x131d)]>0x0?(_0x14caae['textContent']='♪',_0x14caae['classList'][_0x191ee6(0xa58)](_0x191ee6(0x67d))):_0x14caae['classList'][_0x191ee6(0x1097)](_0x191ee6(0x67d));}async function _0x1a8029(_0x3428b9){const _0x57df00=_0x204348;if(_0x3428b9<0x0||_0x3428b9>=_0x59377b['playlist'][_0x57df00(0x131d)])return;const _0x5f4c67=await _0xcd7475(_0x57df00(0xb49),[{'text':_0x57df00(0xe85),'value':_0x57df00(0x1030)},{'text':_0x57df00(0x1e1),'value':_0x57df00(0x1377)}]);let _0x29bd74=null;if(_0x5f4c67===_0x57df00(0x1030))_0x29bd74=await _0x5f0541();else _0x5f4c67==='url'&&(_0x29bd74=await _0x335e57(_0x57df00(0x1398),_0x57df00(0x127f),'',_0x57df00(0x1377)));if(_0x29bd74&&_0x29bd74[_0x57df00(0x2aa)]()){_0x59377b[_0x57df00(0x1102)][_0x3428b9]['background']=_0x29bd74[_0x57df00(0x2aa)](),await _0x562193();if(_0x59377b[_0x57df00(0x4bd)]===_0x3428b9){const _0x4f31d0=document[_0x57df00(0x586)](_0x57df00(0xef6));_0x4f31d0[_0x57df00(0x1104)]['setProperty'](_0x57df00(0x87e),'url('+_0x29bd74[_0x57df00(0x2aa)]()+')');}await _0x34fce8('成功',_0x57df00(0xaf5));}}async function _0x1ab71a(_0x25efb5){const _0x36aa87=_0x204348;if(_0x25efb5<0x0||_0x25efb5>=_0x59377b[_0x36aa87(0x1102)][_0x36aa87(0x131d)])return;const _0x258186=await _0xcd7475('更换专辑封面',[{'text':'📁\x20从本地上传','value':_0x36aa87(0x1030)},{'text':_0x36aa87(0x1e1),'value':'url'}]);let _0xd39af0=null;if(_0x258186===_0x36aa87(0x1030))_0xd39af0=await _0x5f0541();else _0x258186===_0x36aa87(0x1377)&&(_0xd39af0=await _0x335e57(_0x36aa87(0x1398),'请输入新的封面图片链接','',_0x36aa87(0x1377)));if(_0xd39af0&&_0xd39af0[_0x36aa87(0x2aa)]()){_0x59377b[_0x36aa87(0x1102)][_0x25efb5][_0x36aa87(0x847)]=_0xd39af0[_0x36aa87(0x2aa)](),await _0x562193();if(_0x59377b[_0x36aa87(0x4bd)]===_0x25efb5){document[_0x36aa87(0x458)](_0x36aa87(0xad4))['src']=_0xd39af0[_0x36aa87(0x2aa)]();const _0x27b91d=document['querySelector'](_0x36aa87(0xcee));if(_0x27b91d)_0x27b91d[_0x36aa87(0x577)]=_0xd39af0[_0x36aa87(0x2aa)]();}await _0x34fce8('成功','专辑封面已更新！');}}async function _0xfe0b79(_0x5bf774){const _0x4e231e=_0x204348;if(_0x5bf774<0x0||_0x5bf774>=_0x59377b[_0x4e231e(0x1102)][_0x4e231e(0x131d)])return;const _0x3dfacd=_0x59377b['playlist'][_0x5bf774],_0x3bee91=_0x59377b[_0x4e231e(0x1111)]&&_0x59377b['currentIndex']===_0x5bf774;if(_0x3dfacd[_0x4e231e(0x7e9)]&&_0x112d48[_0x4e231e(0x577)][_0x4e231e(0x13ad)](_0x4e231e(0x1297))&&_0x59377b[_0x4e231e(0x4bd)]===_0x5bf774)URL['revokeObjectURL'](_0x112d48[_0x4e231e(0x577)]);_0x59377b[_0x4e231e(0x1102)]['splice'](_0x5bf774,0x1),await _0x562193();if(_0x59377b['playlist'][_0x4e231e(0x131d)]===0x0){if(_0x59377b[_0x4e231e(0x1111)])_0x112d48[_0x4e231e(0x16a)]();_0x112d48[_0x4e231e(0x577)]='',_0x59377b[_0x4e231e(0x4bd)]=-0x1,_0x59377b[_0x4e231e(0x1111)]=![];}else{if(_0x3bee91)_0x106240();else{if(_0x59377b[_0x4e231e(0x4bd)]>=_0x5bf774)_0x59377b[_0x4e231e(0x4bd)]=Math['max'](0x0,_0x59377b[_0x4e231e(0x4bd)]-0x1);}}_0x481fb2(),_0xe64ac7();}async function _0x2bd74c(_0x3b1539){const _0x415b93=_0x204348,_0xc8a077=_0x3b1539['target'][_0x415b93(0x1a9)];if(!_0xc8a077[_0x415b93(0x131d)])return;for(const _0x592ec8 of _0xc8a077){let _0x1245e1=_0x592ec8[_0x415b93(0x132a)][_0x415b93(0x33b)](/\.[^/.]+$/,'');_0x1245e1=await _0x335e57('歌曲信息',_0x415b93(0x1139),_0x1245e1);if(_0x1245e1===null)continue;const _0x613b85=await _0x335e57(_0x415b93(0xba4),_0x415b93(0x6d6),_0x415b93(0xced));if(_0x613b85===null)continue;let _0x98e5b0='';const _0xf3c614=await _0x2532b9(_0x415b93(0x328),'要为《'+_0x1245e1+'》添加歌词吗？');_0xf3c614&&(_0x98e5b0=await _0x122402()||''),_0x59377b['playlist']['push']({'name':_0x1245e1,'artist':_0x613b85,'src':_0x592ec8,'isLocal':!![],'lrcContent':_0x98e5b0});}await _0x562193(),_0xe64ac7(),_0x59377b['currentIndex']===-0x1&&_0x59377b[_0x415b93(0x1102)][_0x415b93(0x131d)]>0x0&&(_0x59377b['currentIndex']=0x0,_0x481fb2()),_0x3b1539['target'][_0x415b93(0x8dd)]=null;}async function _0xfe0b79(_0xaa8556){const _0x17c8de=_0x204348;if(_0xaa8556<0x0||_0xaa8556>=_0x59377b[_0x17c8de(0x1102)][_0x17c8de(0x131d)])return;const _0x414545=_0x59377b[_0x17c8de(0x1102)][_0xaa8556],_0xd814f2=_0x59377b['isPlaying']&&_0x59377b[_0x17c8de(0x4bd)]===_0xaa8556;if(_0x414545['isLocal']&&_0x112d48[_0x17c8de(0x577)][_0x17c8de(0x13ad)](_0x17c8de(0x1297))&&_0x59377b[_0x17c8de(0x4bd)]===_0xaa8556)URL[_0x17c8de(0x30c)](_0x112d48[_0x17c8de(0x577)]);_0x59377b['playlist'][_0x17c8de(0x9cf)](_0xaa8556,0x1),await _0x562193();if(_0x59377b[_0x17c8de(0x1102)][_0x17c8de(0x131d)]===0x0){if(_0x59377b[_0x17c8de(0x1111)])_0x112d48[_0x17c8de(0x16a)]();_0x112d48[_0x17c8de(0x577)]='',_0x59377b[_0x17c8de(0x4bd)]=-0x1,_0x59377b[_0x17c8de(0x1111)]=![];}else{if(_0xd814f2)_0x106240();else{if(_0x59377b['currentIndex']>=_0xaa8556)_0x59377b[_0x17c8de(0x4bd)]=Math['max'](0x0,_0x59377b[_0x17c8de(0x4bd)]-0x1);}}_0x481fb2(),_0xe64ac7();}const _0x4f2b01=document['getElementById'](_0x204348(0xd26)),_0x31da16=document[_0x204348(0x458)]('persona-editor-modal'),_0x5e3182=document['getElementById'](_0x204348(0x202));function _0x22dc58(){const _0x1f9a85=_0x204348;_0xff7bd6(),_0x4f2b01[_0x1f9a85(0x11c2)]['add'](_0x1f9a85(0x67d));}function _0x4141ab(){const _0x3b42b8=_0x204348;_0x4f2b01[_0x3b42b8(0x11c2)][_0x3b42b8(0x1097)](_0x3b42b8(0x67d));}function _0xff7bd6(){const _0x26a630=_0x204348,_0x112f23=document[_0x26a630(0x458)](_0x26a630(0xf26));_0x112f23[_0x26a630(0x110d)]='';if(_0x42f206[_0x26a630(0xa84)][_0x26a630(0x131d)]===0x0){_0x112f23['innerHTML']=_0x26a630(0x1006);return;}_0x42f206['personaPresets']['forEach'](_0x2a87ea=>{const _0x4cd067=_0x26a630,_0x556456=document[_0x4cd067(0xe7d)](_0x4cd067(0x1323));_0x556456[_0x4cd067(0x69b)]=_0x4cd067(0x87c),_0x556456['style'][_0x4cd067(0xf7)]=_0x4cd067(0xfa)+_0x2a87ea['avatar']+')',_0x556456[_0x4cd067(0x1f4)][_0x4cd067(0xd34)]=_0x2a87ea['id'],_0x556456[_0x4cd067(0xd85)](_0x4cd067(0x1122),()=>_0x278503(_0x2a87ea['id'])),_0x4376d8(_0x556456,()=>_0x3a35e4(_0x2a87ea['id'])),_0x112f23['appendChild'](_0x556456);});}function _0x3a35e4(_0x465031){const _0xc52dbe=_0x204348;_0x11002f=_0x465031,_0x5e3182[_0xc52dbe(0x11c2)]['add'](_0xc52dbe(0x67d));}function _0x2f9fdc(){const _0x59ee55=_0x204348;_0x5e3182['classList'][_0x59ee55(0x1097)](_0x59ee55(0x67d)),_0x11002f=null;}function _0x278503(_0x28e7b5){const _0x4fb92e=_0x204348,_0x4a461e=_0x42f206[_0x4fb92e(0xa84)][_0x4fb92e(0xb07)](_0x3e4ea4=>_0x3e4ea4['id']===_0x28e7b5);_0x4a461e&&(document[_0x4fb92e(0x458)](_0x4fb92e(0x3c6))[_0x4fb92e(0x577)]=_0x4a461e[_0x4fb92e(0x5c6)],document[_0x4fb92e(0x458)](_0x4fb92e(0x1349))[_0x4fb92e(0x8dd)]=_0x4a461e['persona']),_0x4141ab();}function _0x38b283(){const _0x10f0f7=_0x204348;_0x11002f=null,document[_0x10f0f7(0x458)]('persona-editor-title')['textContent']='添加人设预设',document[_0x10f0f7(0x458)](_0x10f0f7(0x570))[_0x10f0f7(0x577)]=_0x4fd084,document['getElementById']('preset-persona-input')[_0x10f0f7(0x8dd)]='',_0x31da16['classList'][_0x10f0f7(0xa58)](_0x10f0f7(0x67d));}function _0x2c47c3(){const _0x313446=_0x204348,_0x52f16f=_0x42f206[_0x313446(0xa84)]['find'](_0x5ac19a=>_0x5ac19a['id']===_0x11002f);if(!_0x52f16f)return;document[_0x313446(0x458)](_0x313446(0x1263))[_0x313446(0x1a2)]=_0x313446(0x137d),document[_0x313446(0x458)](_0x313446(0x570))[_0x313446(0x577)]=_0x52f16f['avatar'],document[_0x313446(0x458)](_0x313446(0xead))[_0x313446(0x8dd)]=_0x52f16f[_0x313446(0x124d)],_0x5e3182[_0x313446(0x11c2)][_0x313446(0x1097)](_0x313446(0x67d)),_0x31da16[_0x313446(0x11c2)]['add']('visible');}async function _0x3ce8a0(){const _0x5c8f67=_0x204348,_0x489f99=await _0x2532b9('删除预设',_0x5c8f67(0x126c),{'confirmButtonClass':_0x5c8f67(0x4d3)});_0x489f99&&_0x11002f&&(await _0x17d534[_0x5c8f67(0xa84)]['delete'](_0x11002f),_0x42f206['personaPresets']=_0x42f206['personaPresets'][_0x5c8f67(0xaf1)](_0x33ebe9=>_0x33ebe9['id']!==_0x11002f),_0x2f9fdc(),_0xff7bd6());}function _0x72817d(){const _0x332c88=_0x204348;_0x31da16[_0x332c88(0x11c2)][_0x332c88(0x1097)]('visible'),_0x11002f=null;}async function _0x49c1ff(){const _0x6dd551=_0x204348,_0x2a5ed1=document[_0x6dd551(0x458)](_0x6dd551(0x570))[_0x6dd551(0x577)],_0x57e9ec=document[_0x6dd551(0x458)](_0x6dd551(0xead))[_0x6dd551(0x8dd)][_0x6dd551(0x2aa)]();if(_0x2a5ed1===_0x4fd084&&!_0x57e9ec){alert(_0x6dd551(0xa6a));return;}if(_0x11002f){const _0x281eec=_0x42f206[_0x6dd551(0xa84)][_0x6dd551(0xb07)](_0x412cc2=>_0x412cc2['id']===_0x11002f);_0x281eec&&(_0x281eec[_0x6dd551(0x5c6)]=_0x2a5ed1,_0x281eec[_0x6dd551(0x124d)]=_0x57e9ec,await _0x17d534[_0x6dd551(0xa84)][_0x6dd551(0xf3f)](_0x281eec));}else{const _0x1171b2={'id':'preset_'+Date[_0x6dd551(0x606)](),'avatar':_0x2a5ed1,'persona':_0x57e9ec};await _0x17d534[_0x6dd551(0xa84)][_0x6dd551(0xa58)](_0x1171b2),_0x42f206[_0x6dd551(0xa84)][_0x6dd551(0x129e)](_0x1171b2);}_0xff7bd6(),_0x72817d();}const _0x534454=document['getElementById'](_0x204348(0x6ea));function _0x35af0c(_0x466e97,_0x312c17){const _0xf99147=_0x204348;clearTimeout(_0x2f1a75),document[_0xf99147(0x458)](_0xf99147(0x16f))[_0xf99147(0x577)]=_0x466e97,document[_0xf99147(0x458)](_0xf99147(0xa97))[_0xf99147(0x1a2)]=_0x312c17,_0x534454[_0xf99147(0x11c2)]['add']('visible');const _0xdc0dc2=()=>{const _0x2ae4f2=_0xf99147;_0x534454[_0x2ae4f2(0x11c2)][_0x2ae4f2(0x1097)](_0x2ae4f2(0x67d)),_0x534454[_0x2ae4f2(0x13ac)]('click',_0xdc0dc2);};_0x534454[_0xf99147(0xd85)](_0xf99147(0x1122),_0xdc0dc2),_0x2f1a75=setTimeout(_0xdc0dc2,0x7d0);}function _0x142c1e(_0x507f60){const _0x288298=_0x204348,_0x2ae349=document[_0x288298(0x458)](_0x288298(0x81)),_0x309a9e=_0x2ae349[_0x288298(0x586)](_0x288298(0x13a)),_0x5d17ff=_0x2ae349['querySelector'](_0x288298(0x1301)),_0x418d5b=Math[_0x288298(0xbd5)](_0x507f60['level']*0x64);_0x309a9e[_0x288298(0x1104)][_0x288298(0x1147)]=_0x418d5b+'%',_0x5d17ff[_0x288298(0x1a2)]=_0x418d5b+'%',_0x507f60['charging']?_0x2ae349[_0x288298(0x11c2)][_0x288298(0xa58)](_0x288298(0x1358)):_0x2ae349['classList'][_0x288298(0x1097)](_0x288298(0x1358));}function _0x15acc3(_0x15397e){const _0x5e37a4=_0x204348;_0x142c1e(_0x15397e);const _0x439b3b=_0x15397e['level'];!_0x15397e['charging']&&(_0x439b3b<=0.4&&_0x2c093d>0.4&&!_0x13e4ca[_0x5e37a4(0xdac)]&&(_0x35af0c('https://i.postimg.cc/T2yKJ0DV/40.jpg',_0x5e37a4(0xcb7)),_0x13e4ca['hasShown40']=!![]),_0x439b3b<=0.2&&_0x2c093d>0.2&&!_0x13e4ca['hasShown20']&&(_0x35af0c(_0x5e37a4(0xeb3),'赶紧的充电，要饿死了'),_0x13e4ca[_0x5e37a4(0x9bf)]=!![]),_0x439b3b<=0.1&&_0x2c093d>0.1&&!_0x13e4ca['hasShown10']&&(_0x35af0c(_0x5e37a4(0xd8f),_0x5e37a4(0x1435)),_0x13e4ca[_0x5e37a4(0x1029)]=!![]));if(_0x439b3b>0.4)_0x13e4ca['hasShown40']=![];if(_0x439b3b>0.2)_0x13e4ca[_0x5e37a4(0x9bf)]=![];if(_0x439b3b>0.1)_0x13e4ca[_0x5e37a4(0x1029)]=![];_0x2c093d=_0x439b3b;}async function _0x40e49a(){const _0x59f737=_0x204348;if('getBattery'in navigator)try{const _0x30da2c=await navigator['getBattery']();_0x2c093d=_0x30da2c[_0x59f737(0x5b8)],_0x15acc3(_0x30da2c),_0x30da2c[_0x59f737(0xd85)](_0x59f737(0xc88),()=>_0x15acc3(_0x30da2c)),_0x30da2c[_0x59f737(0xd85)](_0x59f737(0x868),()=>{const _0x1dbbe1=_0x59f737;_0x15acc3(_0x30da2c),_0x30da2c['charging']&&_0x35af0c(_0x1dbbe1(0x6f5),'窝爱泥，电量吃饱饱');});}catch(_0x373e2f){console[_0x59f737(0xb61)](_0x59f737(0xb2a),_0x373e2f),document['querySelector']('.battery-text')[_0x59f737(0x1a2)]=_0x59f737(0x2ef);}else console[_0x59f737(0x7d1)]('浏览器不支持电池状态API。'),document[_0x59f737(0x586)]('.battery-text')[_0x59f737(0x1a2)]='ᗜωᗜ';}async function _0x212847(){const _0x570dac=_0x204348,_0x4d3781=document['getElementById'](_0x570dac(0x300));if(!_0x4d3781)return;const _0x31c42b=await _0x17d534[_0x570dac(0x1001)][_0x570dac(0x50b)](_0x570dac(0x114c))[_0x570dac(0x115b)]()['toArray']();_0x4d3781['innerHTML']='';if(_0x31c42b[_0x570dac(0x131d)]===0x0){_0x4d3781['innerHTML']=_0x570dac(0x286);return;}_0x31c42b['forEach'](_0x5f5c73=>{const _0x22a27c=_0x570dac,_0x370ece=document['createElement'](_0x22a27c(0x1323));_0x370ece['className']=_0x22a27c(0x700),_0x370ece[_0x22a27c(0x110d)]=_0x22a27c(0x1345)+_0x5f5c73['coverUrl']+_0x22a27c(0x906)+_0x5f5c73[_0x22a27c(0x132a)]+_0x22a27c(0xafa)+(_0x5f5c73['photoCount']||0x0)+_0x22a27c(0x611),_0x370ece[_0x22a27c(0xd85)](_0x22a27c(0x1122),()=>{_0x5440a6(_0x5f5c73['id']);}),_0x4376d8(_0x370ece,async()=>{const _0x29a128=_0x22a27c,_0x309df6=await _0x2532b9(_0x29a128(0x741),_0x29a128(0xa77)+_0x5f5c73[_0x29a128(0x132a)]+_0x29a128(0xd93),{'confirmButtonClass':_0x29a128(0x4d3)});_0x309df6&&(await _0x17d534[_0x29a128(0xe15)][_0x29a128(0x13c6)](_0x29a128(0x589))['equals'](_0x5f5c73['id'])[_0x29a128(0x195)](),await _0x17d534[_0x29a128(0x1001)][_0x29a128(0x195)](_0x5f5c73['id']),await _0x212847(),alert(_0x29a128(0x5bc)));}),_0x4d3781[_0x22a27c(0x1079)](_0x370ece);});}async function _0x5440a6(_0x56b2f5){const _0x373a01=_0x204348;_0x42f206[_0x373a01(0xe42)]=_0x56b2f5,await _0x582a64(),_0x589d88('album-photos-screen');}async function _0x582a64(){const _0x30176b=_0x204348;if(!_0x42f206[_0x30176b(0xe42)])return;const _0x519ec1=document[_0x30176b(0x458)](_0x30176b(0x698)),_0x4f9243=document['getElementById'](_0x30176b(0x6ba)),_0x362884=await _0x17d534[_0x30176b(0x1001)][_0x30176b(0x36d)](_0x42f206[_0x30176b(0xe42)]);if(!_0x362884){console[_0x30176b(0xb61)](_0x30176b(0x1220),_0x42f206['activeAlbumId']),_0x589d88('album-screen');return;}_0x4f9243[_0x30176b(0x1a2)]=_0x362884[_0x30176b(0x132a)];const _0x68df01=await _0x17d534[_0x30176b(0xe15)][_0x30176b(0x13c6)](_0x30176b(0x589))[_0x30176b(0x7db)](_0x42f206[_0x30176b(0xe42)])[_0x30176b(0x511)]();_0x519ec1['innerHTML']='',_0x68df01[_0x30176b(0x131d)]===0x0?_0x519ec1[_0x30176b(0x110d)]=_0x30176b(0x6ee):_0x68df01['forEach'](_0x5dfde3=>{const _0x4c7a83=_0x30176b,_0x5357f0=document[_0x4c7a83(0xe7d)](_0x4c7a83(0x1323));_0x5357f0[_0x4c7a83(0x69b)]=_0x4c7a83(0x77b),_0x5357f0[_0x4c7a83(0x110d)]=_0x4c7a83(0xf5c)+_0x5dfde3[_0x4c7a83(0x1377)]+_0x4c7a83(0xc1a)+_0x5dfde3['id']+_0x4c7a83(0x26c),_0x519ec1['appendChild'](_0x5357f0);});}async function _0x5a099a(_0x2db6c0){const _0x24125b=_0x204348;if(!_0x42f206['activeAlbumId'])return;const _0x1a3e47=await _0x17d534[_0x24125b(0xe15)][_0x24125b(0x13c6)](_0x24125b(0x589))[_0x24125b(0x7db)](_0x42f206[_0x24125b(0xe42)])[_0x24125b(0x511)]();_0x5a38a4[_0x24125b(0xb40)]=_0x1a3e47[_0x24125b(0xbf6)](_0x779b8c=>_0x779b8c[_0x24125b(0x1377)]),_0x5a38a4[_0x24125b(0x4bd)]=_0x5a38a4['photos'][_0x24125b(0x4a8)](_0x4ee820=>_0x4ee820===_0x2db6c0);if(_0x5a38a4['currentIndex']===-0x1)return;document[_0x24125b(0x458)]('photo-viewer-modal')['classList'][_0x24125b(0xa58)]('visible'),_0x3680dc(),_0x5a38a4['isOpen']=!![];}function _0x3680dc(){const _0xfee7e3=_0x204348;if(_0x5a38a4[_0xfee7e3(0x4bd)]===-0x1)return;const _0x4287ba=document[_0xfee7e3(0x458)](_0xfee7e3(0x1246)),_0x2827cc=document[_0xfee7e3(0x458)](_0xfee7e3(0x11e0)),_0x526aa8=document[_0xfee7e3(0x458)](_0xfee7e3(0x2e8));_0x4287ba[_0xfee7e3(0x1104)]['opacity']=0x0,setTimeout(()=>{const _0x1e078c=_0xfee7e3;_0x4287ba[_0x1e078c(0x577)]=_0x5a38a4['photos'][_0x5a38a4[_0x1e078c(0x4bd)]],_0x4287ba[_0x1e078c(0x1104)]['opacity']=0x1;},0x64),_0x2827cc[_0xfee7e3(0xb18)]=_0x5a38a4[_0xfee7e3(0x4bd)]===0x0,_0x526aa8[_0xfee7e3(0xb18)]=_0x5a38a4[_0xfee7e3(0x4bd)]===_0x5a38a4[_0xfee7e3(0xb40)][_0xfee7e3(0x131d)]-0x1;}function _0x4d5106(){const _0x15fcc8=_0x204348;_0x5a38a4[_0x15fcc8(0x4bd)]<_0x5a38a4[_0x15fcc8(0xb40)][_0x15fcc8(0x131d)]-0x1&&(_0x5a38a4[_0x15fcc8(0x4bd)]++,_0x3680dc());}function _0x58df2a(){const _0x2c7238=_0x204348;_0x5a38a4[_0x2c7238(0x4bd)]>0x0&&(_0x5a38a4[_0x2c7238(0x4bd)]--,_0x3680dc());}function _0x33e05f(){const _0x2753f9=_0x204348;document[_0x2753f9(0x458)](_0x2753f9(0xd50))[_0x2753f9(0x11c2)]['remove'](_0x2753f9(0x67d)),_0x5a38a4['isOpen']=![],_0x5a38a4[_0x2753f9(0xb40)]=[],_0x5a38a4[_0x2753f9(0x4bd)]=-0x1,document[_0x2753f9(0x458)](_0x2753f9(0x1246))[_0x2753f9(0x577)]='';}function _0x276281(_0x1dde96){const _0x3c24d5=_0x204348;_0x116b59=_0x1dde96,localStorage[_0x3c24d5(0xc93)]('unreadPostsCount',_0x1dde96);const _0x1c2f57=document['querySelector'](_0x3c24d5(0xfb1)),_0xe1439=_0x1c2f57[_0x3c24d5(0x586)](_0x3c24d5(0xd0));let _0x488c06=_0x1c2f57[_0x3c24d5(0x586)](_0x3c24d5(0x1409));_0x1dde96>0x0?(!_0x488c06&&(_0x488c06=document[_0x3c24d5(0xe7d)](_0x3c24d5(0xd0)),_0x488c06['className']=_0x3c24d5(0x1340),_0xe1439[_0x3c24d5(0x1104)]['position']=_0x3c24d5(0x1d0),_0xe1439[_0x3c24d5(0x1079)](_0x488c06)),_0x488c06[_0x3c24d5(0x1a2)]=_0x1dde96>0x63?_0x3c24d5(0x13cb):_0x1dde96,_0x488c06[_0x3c24d5(0x1104)][_0x3c24d5(0x4db)]=_0x3c24d5(0x1188)):_0x488c06&&(_0x488c06[_0x3c24d5(0x1104)][_0x3c24d5(0x4db)]=_0x3c24d5(0x464)),_0x3fa630();}function _0x27c212(){const _0x4f2f8b=_0x204348;if(_0x5af2e0)return;const _0x10b327=_0x42f206[_0x4f2f8b(0xf0)][_0x4f2f8b(0xc29)]||0x3c;_0x5af2e0=setInterval(_0x33223d,_0x10b327*0x3e8),_0x575bad();}function _0x2437fd(){_0x5af2e0&&(clearInterval(_0x5af2e0),_0x5af2e0=null),_0x5bc960();}async function _0x33223d(){const _0x1ffead=_0x204348;console[_0x1ffead(0x7d1)]('模拟器心跳\x20Tick...');if(!_0x42f206[_0x1ffead(0xf0)][_0x1ffead(0x12cd)]){_0x2437fd();return;}const _0x599cd8=Object[_0x1ffead(0x6eb)](_0x42f206[_0x1ffead(0x954)])[_0x1ffead(0xaf1)](_0x1b508a=>!_0x1b508a[_0x1ffead(0x726)]);_0x599cd8[_0x1ffead(0x12c2)](_0x4d20a2=>{const _0x3199f8=_0x1ffead;if(_0x4d20a2[_0x3199f8(0x569)]?.['status']==='blocked_by_user'){const _0x2bf87e=_0x4d20a2[_0x3199f8(0x569)][_0x3199f8(0x1230)];if(!_0x2bf87e)return;const _0x541b66=Date[_0x3199f8(0x606)]()-_0x2bf87e,_0x5ef366=(_0x42f206[_0x3199f8(0xf0)][_0x3199f8(0x121b)]||0x1)*0x3c*0x3c*0x3e8;_0x541b66>_0x5ef366&&(_0x4d20a2[_0x3199f8(0x569)][_0x3199f8(0x13b2)]=_0x3199f8(0x1311),_0x1613f7(_0x4d20a2['id']));}else{if(_0x4d20a2[_0x3199f8(0x569)]?.[_0x3199f8(0x13b2)]===_0x3199f8(0xe97)&&_0x4d20a2['id']!==_0x42f206[_0x3199f8(0x81d)]){if(_0x4d20a2['settings'][_0x3199f8(0x12cd)]===![]){console[_0x3199f8(0x7d1)](_0x3199f8(0x714)+_0x4d20a2[_0x3199f8(0x132a)]+_0x3199f8(0x1058));return;}Math[_0x3199f8(0x23a)]()<0.2&&(console[_0x3199f8(0x7d1)](_0x3199f8(0x714)+_0x4d20a2[_0x3199f8(0x132a)]+_0x3199f8(0x1239)),_0x481cbe(_0x4d20a2['id']));}}});const _0x1319a1=Object[_0x1ffead(0x6eb)](_0x42f206['chats'])[_0x1ffead(0xaf1)](_0x2a37e4=>_0x2a37e4[_0x1ffead(0x726)]);_0x1319a1[_0x1ffead(0x12c2)](_0x4d2071=>{const _0x2033ec=_0x1ffead;if(_0x4d2071[_0x2033ec(0xda2)][_0x2033ec(0x12cd)]===![]){console[_0x2033ec(0x7d1)](_0x2033ec(0x11d)+_0x4d2071['name']+_0x2033ec(0xa7a));return;}_0x4d2071['id']!==_0x42f206[_0x2033ec(0x81d)]&&Math['random']()<0.1&&(console[_0x2033ec(0x7d1)]('群聊\x20\x22'+_0x4d2071[_0x2033ec(0x132a)]+_0x2033ec(0x1239)),_0x162dd9(_0x4d2071['id']));});try{const _0x57cfce=await _0x17d534[_0x1ffead(0x996)]['toArray']();if(_0x57cfce[_0x1ffead(0x131d)]===0x0)return;const _0x404e7a=await _0x17d534['qzonePosts'][_0x1ffead(0x50b)](_0x1ffead(0xf16))[_0x1ffead(0x115b)]()['limit'](0xa)[_0x1ffead(0x511)]();for(const _0x291e9a of _0x57cfce){if(_0x291e9a[_0x1ffead(0x12cd)]===![])continue;const _0x159ba1=_0x291e9a[_0x1ffead(0x9c9)]||0xf;if(_0x291e9a[_0x1ffead(0x2d2)]){const _0x299234=(Date[_0x1ffead(0x606)]()-_0x291e9a[_0x1ffead(0x2d2)])/(0x3e8*0x3c);if(_0x299234<_0x159ba1)continue;}if(Math[_0x1ffead(0x23a)]()>0.3)continue;const _0x562d97=[];for(const _0x3e799f of _0x404e7a){if(_0x3e799f['authorId']===_0x1ffead(0xa45)+_0x291e9a['id'])continue;const _0x5a7b05=_0x3e799f[_0x1ffead(0x946)]?.[_0x1ffead(0x593)](_0x4d2ee8=>_0x4d2ee8['replyTo']===_0x291e9a[_0x1ffead(0x132a)]),_0x56a794=_0x3e799f[_0x1ffead(0x946)]?.[_0x1ffead(0x5b0)](-0x1)[0x0]?.['commenterName'];if(_0x56a794===_0x291e9a[_0x1ffead(0x132a)])continue;let _0x406575=![];if(_0x3e799f['authorId']===_0x1ffead(0xf86)||_0x3e799f['authorId'][_0x1ffead(0x13ad)](_0x1ffead(0x12fe)))_0x291e9a[_0x1ffead(0x1114)][_0x1ffead(0xd8d)](_0x3e799f[_0x1ffead(0x1086)])&&(_0x406575=!![]);else{if(_0x3e799f[_0x1ffead(0x1086)]['startsWith'](_0x1ffead(0xa45))){const _0xcac33b=parseInt(_0x3e799f[_0x1ffead(0x1086)][_0x1ffead(0x33b)]('npc_','')),_0x21f62e=await _0x17d534[_0x1ffead(0x996)]['get'](_0xcac33b);if(_0x21f62e){const _0x46f090=_0x291e9a[_0x1ffead(0x8d4)],_0x530d88=_0x21f62e['npcGroupId'];_0x46f090&&_0x530d88&&_0x46f090===_0x530d88&&(_0x406575=!![]);}}}(_0x406575||_0x5a7b05)&&_0x562d97[_0x1ffead(0x129e)](_0x3e799f);}if(_0x562d97['length']>0x0||Math[_0x1ffead(0x23a)]()<0.2){console[_0x1ffead(0x7d1)]('NPC\x20\x22'+_0x291e9a['name']+'\x22\x20触发行动决策...');const _0x1870cd=await _0x7cbc24(_0x291e9a,_0x562d97);if(_0x1870cd&&_0x1870cd[_0x1ffead(0x131d)]>0x0){for(const _0x154fbc of _0x1870cd){if(_0x154fbc[_0x1ffead(0x259)]==='qzone_comment'){const _0x518be5=await _0x17d534[_0x1ffead(0x15b)]['get'](_0x154fbc[_0x1ffead(0x13bc)]);if(_0x518be5){if(!_0x518be5[_0x1ffead(0x946)])_0x518be5[_0x1ffead(0x946)]=[];_0x518be5[_0x1ffead(0x946)][_0x1ffead(0x129e)]({'commenterName':_0x291e9a[_0x1ffead(0x132a)],'text':_0x154fbc[_0x1ffead(0x8f4)],'replyTo':_0x154fbc[_0x1ffead(0xd75)]||null,'timestamp':Date[_0x1ffead(0x606)]()+Math[_0x1ffead(0x23a)]()}),await _0x17d534['qzonePosts'][_0x1ffead(0x938)](_0x154fbc[_0x1ffead(0x13bc)],{'comments':_0x518be5['comments']}),_0x276281(_0x116b59+0x1);}}else{if(_0x154fbc['type']===_0x1ffead(0xe47)){const _0x40c525={'type':_0x154fbc[_0x1ffead(0xbc2)]||_0x1ffead(0xb03),'content':_0x154fbc['content'],'timestamp':Date[_0x1ffead(0x606)](),'authorId':_0x1ffead(0xa45)+_0x291e9a['id'],'authorOriginalName':_0x291e9a['name'],'visibleTo':_0x291e9a[_0x1ffead(0x1114)],'likes':[],'comments':[],'isDeleted':![]};await _0x17d534[_0x1ffead(0x15b)]['add'](_0x40c525),console[_0x1ffead(0x7d1)]('NPC\x20\x22'+_0x291e9a[_0x1ffead(0x132a)]+_0x1ffead(0x220)),_0x276281(_0x116b59+0x1);}}}await _0x17d534[_0x1ffead(0x996)][_0x1ffead(0x938)](_0x291e9a['id'],{'lastActionTimestamp':Date[_0x1ffead(0x606)]()}),document['getElementById'](_0x1ffead(0x1116))[_0x1ffead(0x11c2)]['contains'](_0x1ffead(0xfe1))&&await _0x316550();}}}}catch(_0x5ae82a){console[_0x1ffead(0xb61)]('处理NPC后台活动时出错:',_0x5ae82a);}}async function _0x7cbc24(_0x5ecb24,_0x4572b8){const _0x44ed4a=_0x204348,{proxyUrl:_0x44e00f,apiKey:_0x41b6b0,model:_0x16f424}=_0x42f206[_0x44ed4a(0x5cb)];if(!_0x44e00f||!_0x41b6b0||!_0x16f424)return console[_0x44ed4a(0xb61)](_0x44ed4a(0xb9e)),null;let _0x5d7d2a=_0x44ed4a(0x12c0);const _0x417d5f=_0x42f206[_0x44ed4a(0x551)][_0x44ed4a(0x308)]||'我',_0xd35b1c=_0x42f206[_0x44ed4a(0x954)][Object[_0x44ed4a(0x634)](_0x42f206[_0x44ed4a(0x954)])[0x0]]?.[_0x44ed4a(0xda2)][_0x44ed4a(0x65f)]||'(未设置)';_0x5d7d2a+=_0x44ed4a(0x1293)+_0x417d5f+'\x20(用户)**:\x20'+_0xd35b1c+'\x0a';_0x5ecb24[_0x44ed4a(0x1114)]&&_0x5ecb24[_0x44ed4a(0x1114)][_0x44ed4a(0x131d)]>0x0&&_0x5ecb24['associatedWith'][_0x44ed4a(0x12c2)](_0x4316ef=>{const _0x49057b=_0x44ed4a,_0x2172e1=_0x42f206[_0x49057b(0x954)][_0x4316ef];_0x2172e1&&!_0x2172e1[_0x49057b(0x726)]&&(_0x5d7d2a+=_0x49057b(0x1293)+_0x2172e1[_0x49057b(0x132a)]+'\x20(本名:\x20'+_0x2172e1[_0x49057b(0xa1)]+')**:\x20'+_0x2172e1[_0x49057b(0xda2)]['aiPersona']+'\x0a');});const _0x4a5723=(await Promise[_0x44ed4a(0xfe2)](_0x4572b8[_0x44ed4a(0xbf6)](async _0xd9f766=>{const _0x3f6244=_0x44ed4a;let _0x30abe2='未知作者';if(_0xd9f766[_0x3f6244(0x1086)]===_0x3f6244(0xf86))_0x30abe2=_0x42f206[_0x3f6244(0x551)]['nickname']||'用户';else{if(_0xd9f766[_0x3f6244(0x1086)][_0x3f6244(0x13ad)](_0x3f6244(0x12fe)))_0x30abe2=_0x4e0b74(_0xd9f766[_0x3f6244(0xb85)]||_0xd9f766[_0x3f6244(0x1086)]);else{if(_0xd9f766[_0x3f6244(0x1086)][_0x3f6244(0x13ad)]('npc_')){const _0x371f1e=parseInt(_0xd9f766[_0x3f6244(0x1086)][_0x3f6244(0x33b)](_0x3f6244(0xa45),'')),_0x38a0bf=await _0x17d534[_0x3f6244(0x996)][_0x3f6244(0x36d)](_0x371f1e);_0x38a0bf&&(_0x30abe2=_0x38a0bf[_0x3f6244(0x132a)]);}}}const _0x2f4146=(_0xd9f766[_0x3f6244(0x946)]||[])[_0x3f6244(0xbf6)](_0x419f91=>{const _0x58ebde=_0x3f6244;if(typeof _0x419f91===_0x58ebde(0x620)&&_0x419f91[_0x58ebde(0x7a7)]){const _0x31cd07=_0x4e0b74(_0x419f91['commenterName']);return'-\x20**'+_0x31cd07+_0x58ebde(0x20a)+_0x419f91[_0x58ebde(0xdd5)];}return'-\x20'+_0x419f91;})[_0x3f6244(0x56c)]('\x0a');return _0x3f6244(0x1407)+_0xd9f766['id']+'\x0a-\x20**作者**:\x20'+_0x30abe2+_0x3f6244(0x944)+(_0xd9f766[_0x3f6244(0x1316)]||_0xd9f766[_0x3f6244(0xd2d)]||'')[_0x3f6244(0xa6d)](0x0,0x96)+_0x3f6244(0x4c0)+(_0x2f4146||_0x3f6244(0xd00))+_0x3f6244(0xaec);})))[_0x44ed4a(0x56c)]('\x0a'),_0x1fbe29=_0x44ed4a(0xa45)+_0x5ecb24['id'],_0x1f0701=Date[_0x44ed4a(0x606)]()-0xc*0x3c*0x3c*0x3e8,_0x4d488d=await _0x17d534[_0x44ed4a(0x15b)][_0x44ed4a(0x13c6)](_0x44ed4a(0x1086))[_0x44ed4a(0x7db)](_0x1fbe29)[_0x44ed4a(0x651)](_0x2932e5=>_0x2932e5[_0x44ed4a(0xf16)]>_0x1f0701)[_0x44ed4a(0x511)]();let _0x4ffcc9='';_0x4d488d[_0x44ed4a(0x131d)]>0x0&&(_0x4ffcc9=_0x44ed4a(0x242));const _0x26adab=_0x44ed4a(0x1416)+_0x5ecb24[_0x44ed4a(0x132a)]+_0x44ed4a(0xc79)+_0x4ffcc9+_0x44ed4a(0xc99)+_0x5ecb24[_0x44ed4a(0x132a)]+_0x44ed4a(0x7e)+_0x5ecb24[_0x44ed4a(0x124d)]+'\x0a\x0a'+_0x5d7d2a+_0x44ed4a(0x11c8)+_0x4a5723+'\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。';try{const _0x362ce7=[{'role':'user','content':_0x44ed4a(0x8db)}];let _0x52c5ac=_0x44e00f[_0x44ed4a(0xd8d)](_0x44ed4a(0xfe3)),_0x39c625=_0x5d73db(_0x16f424,_0x41b6b0,_0x26adab,_0x362ce7);const _0x344c33=_0x52c5ac?await fetch(_0x39c625[_0x44ed4a(0x1377)],_0x39c625[_0x44ed4a(0x76b)]):await fetch(_0x44e00f+_0x44ed4a(0xd7),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x44ed4a(0x8aa)+_0x41b6b0},'body':JSON[_0x44ed4a(0xc04)]({'model':_0x16f424,'messages':[{'role':_0x44ed4a(0x1370),'content':_0x26adab},..._0x362ce7],'temperature':_0x42f206[_0x44ed4a(0xf0)][_0x44ed4a(0xfdf)]||0.9})});if(!_0x344c33['ok'])throw new Error(_0x44ed4a(0x676)+_0x344c33[_0x44ed4a(0xf0c)]);const _0x1e3ffc=await _0x344c33[_0x44ed4a(0xaef)](),_0x1ec9dd=getGeminiResponseText(_0x1e3ffc),_0x10dd17=_0x1ec9dd['match'](/(\[[\s\S]*\])/);if(!_0x10dd17)throw new Error(_0x44ed4a(0x456));return JSON[_0x44ed4a(0x44c)](_0x10dd17[0x0]);}catch(_0x5eca63){return console[_0x44ed4a(0xb61)](_0x44ed4a(0xc3f)+_0x5ecb24[_0x44ed4a(0x132a)]+'\x22\x20生成行动失败:',_0x5eca63),null;}}async function _0x481cbe(_0x2b4343){const _0x266be3=_0x204348,_0x13f56e=_0x42f206[_0x266be3(0x954)][_0x2b4343];if(!_0x13f56e)return;const _0x57b063=_0x13f56e['settings'][_0x266be3(0x9c9)]||0xa;if(_0x13f56e[_0x266be3(0x2d2)]){const _0xb1d5e=(Date['now']()-_0x13f56e['lastActionTimestamp'])/(0x3e8*0x3c);if(_0xb1d5e<_0x57b063){console[_0x266be3(0x7d1)]('角色\x20\x22'+_0x13f56e[_0x266be3(0x132a)]+_0x266be3(0xa17)+Math[_0x266be3(0x1434)](_0x57b063-_0xb1d5e)+_0x266be3(0x6df));return;}}_0x260324(_0x2b4343,!![]);const {proxyUrl:_0x1c7a35,apiKey:_0x4e402c,model:_0x495fe2}=_0x42f206[_0x266be3(0x5cb)];if(!_0x1c7a35||!_0x4e402c||!_0x495fe2)return;const _0x4bdaf9=_0x42f206[_0x266be3(0x551)]['nickname'],_0x5c8b88=new Date(),_0x18fbbc=_0x13f56e[_0x266be3(0xda2)][_0x266be3(0xc7a)]||'Asia/Shanghai',_0x3bc034=_0x5c8b88[_0x266be3(0xe43)](_0x266be3(0xaa2),{'timeZone':_0x18fbbc,'dateStyle':'full','timeStyle':_0x266be3(0xabe)}),_0x2e8e90=new Date(_0x5c8b88[_0x266be3(0xe43)](_0x266be3(0x34f),{'timeZone':_0x18fbbc}));let _0x5894c8='',_0x4fd68a='',_0x2d0314,_0x35fa93=![];const _0x437d21=_0x13f56e[_0x266be3(0xda2)][_0x266be3(0x125c)]||0xa,_0x291b9f=_0x13f56e[_0x266be3(0x1d5)][_0x266be3(0xaf1)](_0x2e17f2=>!_0x2e17f2['isHidden'])[_0x266be3(0x5b0)](-_0x437d21),_0x573a96=_0x13f56e[_0x266be3(0x1d5)][_0x266be3(0xaf1)](_0x1f0b6c=>!_0x1f0b6c[_0x266be3(0x7a0)])[_0x266be3(0x5b0)](-0x1)[0x0];if(_0x13f56e[_0x266be3(0xda2)]['enableTimePerception']){_0x5894c8=_0x5ecef0(_0x2e8e90);const _0x1f8ec6=_0x13f56e[_0x266be3(0x1d5)][_0x266be3(0xaf1)](_0xcc3946=>!_0xcc3946[_0x266be3(0x7a0)])[_0x266be3(0x5b0)](-0x1)[0x0],_0x4b0207=new Date();let _0x3dc071='',_0x11d640=![];if(_0x1f8ec6){const _0x4bf466=new Date(_0x1f8ec6[_0x266be3(0xf16)]),_0x17aaf9=(_0x4b0207-_0x4bf466)/(0x3e8*0x3c*0x3c);if(_0x17aaf9>0xc){_0x11d640=!![];const _0x522b75=Math['floor'](_0x17aaf9/0x18);_0x3dc071=_0x266be3(0x1177)+(_0x522b75>0x0?_0x522b75+'天':Math['floor'](_0x17aaf9)+'小时')+_0x266be3(0xbda);}else{const _0x14238c=Math[_0x266be3(0xbd5)](_0x17aaf9*0x3c);if(_0x14238c<0x5)_0x3dc071=_0x266be3(0xbeb);else _0x14238c<0x3c?_0x3dc071=_0x266be3(0xae4)+_0x14238c+_0x266be3(0x49d):_0x3dc071='你们在'+Math[_0x266be3(0xbd5)](_0x17aaf9)+_0x266be3(0x266);}}else _0x11d640=!![],_0x3dc071=_0x266be3(0x5b1);let _0x42ba94='你们最近没有有效聊天记录。';_0x291b9f[_0x266be3(0x131d)]>0x0&&(_0x42ba94='这是你们最近的对话：\x0a'+_0x291b9f['map'](_0x1b03c3=>{const _0x24edae=_0x266be3,_0x106bb7=_0x1b03c3[_0x24edae(0xaeb)]===_0x24edae(0xf86)?_0x4bdaf9:_0x13f56e[_0x24edae(0x132a)];return _0x106bb7+':\x20'+String(_0x1b03c3[_0x24edae(0x1316)])['substring'](0x0,0x32)+_0x24edae(0x10a0);})[_0x266be3(0x56c)]('\x0a')),_0x11d640?_0x2d0314='[情景提示]\x20'+_0x3dc071+'\x20当前时间是\x20'+_0x3bc034+_0x266be3(0x91)+_0x42ba94:_0x2d0314=''+_0x42ba94;}else _0x291b9f[_0x266be3(0x131d)]>0x0?_0x2d0314='这是你们最近的对话：\x0a'+_0x291b9f[_0x266be3(0xbf6)](_0x400706=>{const _0xdd4941=_0x266be3,_0x2da937=_0x400706[_0xdd4941(0xaeb)]===_0xdd4941(0xf86)?_0x4bdaf9:_0x13f56e['name'];return _0x2da937+':\x20'+String(_0x400706[_0xdd4941(0x1316)])['substring'](0x0,0x32)+'...';})['join']('\x0a'):_0x2d0314=_0x266be3(0x4ee);const _0x324695=await _0x17d534['qzonePosts']['orderBy'](_0x266be3(0xf16))[_0x266be3(0x115b)]()['limit'](0x5)[_0x266be3(0x511)](),_0x2689bf=_0x40b385(_0x324695,_0x13f56e),_0x4f1c36=_0x2689bf[_0x266be3(0xaf1)](_0x4b2cbf=>_0x4b2cbf[_0x266be3(0x1086)]===_0x2b4343);let _0x1abef4='';_0x4f1c36[_0x266be3(0x131d)]>0x0&&(_0x1abef4=_0x266be3(0x8b6),_0x4f1c36[_0x266be3(0x12c2)](_0x1d4787=>{const _0x515c77=_0x266be3;let _0x1dbb7b=(_0x1d4787[_0x515c77(0xd2d)]||_0x1d4787['content']||_0x515c77(0x756))[_0x515c77(0xa6d)](0x0,0x28)+'...';_0x1abef4+='-\x20(ID:\x20'+_0x1d4787['id']+_0x515c77(0x51f)+_0x1dbb7b+'\x22\x0a';}));let _0x4dc7cf=[];_0x2689bf[_0x266be3(0x131d)]>0x0&&(_0x4dc7cf=_0x2689bf[_0x266be3(0xbf6)](_0x1851ec=>{const _0x417080=_0x266be3;let _0x3e8cc8;if(_0x1851ec[_0x417080(0x259)]==='text_image')_0x3e8cc8=(_0x417080(0x233)+_0x1851ec[_0x417080(0x145)]+'”]\x20'+(_0x1851ec[_0x417080(0xd2d)]||''))[_0x417080(0xa6d)](0x0,0x32)+'...';else _0x1851ec[_0x417080(0x259)]===_0x417080(0xe7f)?_0x3e8cc8=(_0x417080(0x767)+_0x1851ec['imageDescription']+_0x417080(0x7b2)+(_0x1851ec[_0x417080(0xd2d)]||''))[_0x417080(0xa6d)](0x0,0x32)+'...':_0x3e8cc8=String(_0x1851ec[_0x417080(0xd2d)]||_0x1851ec[_0x417080(0x1316)]||_0x417080(0x756))[_0x417080(0xa6d)](0x0,0x32)+_0x417080(0x10a0);return _0x417080(0x8d0)+_0x3e8cc8+'\x22';}));let _0x83ebcf='';_0x4dc7cf[_0x266be3(0x131d)]>0x0&&(_0x83ebcf=_0x266be3(0xa6c)+_0x4dc7cf['join']('\x0a')+_0x266be3(0x84c));let _0x3c70ca='';if(_0x13f56e[_0x266be3(0xda2)][_0x266be3(0x315)]&&_0x13f56e[_0x266be3(0xda2)][_0x266be3(0x315)]['length']>0x0){const _0x43f63b=_0x13f56e['settings'][_0x266be3(0x315)][_0x266be3(0xbf6)](_0x878e65=>{const _0x2705b5=_0x266be3,_0x12febc=_0x42f206[_0x2705b5(0xab7)]['find'](_0x31b2d7=>_0x31b2d7['id']===_0x878e65);if(!_0x12febc||!Array[_0x2705b5(0x971)](_0x12febc[_0x2705b5(0x1316)]))return'';const _0x4db850=_0x12febc[_0x2705b5(0x1316)][_0x2705b5(0xaf1)](_0x211767=>_0x211767['enabled']!==![])[_0x2705b5(0xbf6)](_0x19c456=>{const _0x29c192=_0x2705b5;let _0x459e44=_0x29c192(0x111f)+(_0x19c456[_0x29c192(0xcb4)]||_0x29c192(0xfdc))+'\x0a';return _0x19c456[_0x29c192(0x634)][_0x29c192(0x131d)]>0x0&&(_0x459e44+=_0x29c192(0xe8c)+_0x19c456[_0x29c192(0x634)]['join'](',\x20')+'\x0a'),_0x459e44+='**内容:**\x0a'+_0x19c456[_0x29c192(0x1316)],_0x459e44;})[_0x2705b5(0x56c)]('');return _0x4db850?_0x2705b5(0x64a)+_0x12febc['name']+'\x0a'+_0x4db850:'';})[_0x266be3(0xaf1)](Boolean)['join']('');_0x43f63b&&(_0x3c70ca=_0x266be3(0x518)+_0x43f63b+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x46f3fc='';const _0x5ccb50=_0x13f56e[_0x266be3(0xda2)][_0x266be3(0x912)]||0xa;if(_0x13f56e[_0x266be3(0xda2)][_0x266be3(0x1448)]&&_0x13f56e[_0x266be3(0xda2)]['linkedMemoryChatIds'][_0x266be3(0x131d)]>0x0){const _0x34f091=_0x13f56e[_0x266be3(0xda2)][_0x266be3(0x1448)][_0x266be3(0xbf6)](_0x3f6443=>{const _0x4eb545=_0x266be3,_0x4b8478=_0x42f206[_0x4eb545(0x954)][_0x3f6443];if(!_0x4b8478)return null;const _0x1ba04b=_0x4b8478[_0x4eb545(0x1d5)][_0x4eb545(0x5b0)](-0x1)[0x0];return{'chat':_0x4b8478,'latestTimestamp':_0x1ba04b?_0x1ba04b[_0x4eb545(0xf16)]:0x0};})['filter'](Boolean);_0x34f091[_0x266be3(0xc12)]((_0x1e8557,_0x12c918)=>_0x12c918[_0x266be3(0xff2)]-_0x1e8557['latestTimestamp']),_0x46f3fc+=_0x266be3(0x117b);for(const _0x208d9d of _0x34f091){const _0x30e1aa=_0x208d9d['chat'],_0x20eb07=_0x30e1aa[_0x266be3(0x726)]?_0x266be3(0x13f3):_0x266be3(0x35c),_0x5ee7c6=_0x208d9d[_0x266be3(0xff2)]>0x0?_0x266be3(0x7b5)+_0x1f0c92(_0x208d9d[_0x266be3(0xff2)])+')':'';_0x46f3fc+='\x0a##\x20---\x20来自'+_0x20eb07+'“'+_0x30e1aa['name']+_0x266be3(0x1342)+_0x5ee7c6+_0x266be3(0xc46);const _0x54dd6f=_0x30e1aa[_0x266be3(0x1d5)][_0x266be3(0x5b0)](-_0x5ccb50),_0x431ddb=_0x54dd6f['filter'](_0x33d827=>!String(_0x33d827[_0x266be3(0x1316)])[_0x266be3(0xd8d)]('已被用户删除'));_0x431ddb['length']>0x0?_0x431ddb['forEach'](_0x15f453=>{const _0x54064b=_0x266be3,_0x41524d=_0x15f453['role']===_0x54064b(0xf86)?_0x30e1aa['settings'][_0x54064b(0xc7d)]||'我':_0x15f453[_0x54064b(0x2a3)]||_0x30e1aa[_0x54064b(0x132a)];let _0x51f00c=String(_0x15f453[_0x54064b(0x1316)]);if(_0x15f453[_0x54064b(0x259)]===_0x54064b(0xb1e)||_0x15f453[_0x54064b(0x259)]===_0x54064b(0x305))_0x51f00c=_0x54064b(0xf43)+_0x15f453['content']+']';else _0x15f453[_0x54064b(0x259)]===_0x54064b(0xefa)&&(_0x51f00c='[发送了一条语音，内容是：'+_0x15f453[_0x54064b(0x1316)]+']');_0x46f3fc+=_0x41524d+':\x20'+_0x51f00c+'\x0a';}):_0x46f3fc+=_0x266be3(0x6e9);}}let _0x5e1e3d='';if(_0x2689bf[_0x266be3(0x131d)]>0x0){let _0x5059d2=_0x266be3(0x13b6);for(const _0x160471 of _0x2689bf){let _0x4ac134;if(_0x160471[_0x266be3(0x1086)]===_0x266be3(0xf86))_0x4ac134=_0x42f206[_0x266be3(0x551)][_0x266be3(0x308)];else{if(String(_0x160471[_0x266be3(0x1086)])[_0x266be3(0x13ad)]('npc_'))_0x4ac134=_0x160471[_0x266be3(0xb85)]||_0x266be3(0x10bc);else{const _0x5c1c1a=_0x42f206[_0x266be3(0x954)][_0x160471[_0x266be3(0x1086)]];_0x4ac134=_0x5c1c1a?_0x5c1c1a[_0x266be3(0x132a)]:'一位朋友';}}if(_0x160471['authorId']===_0x2b4343)_0x4ac134+=_0x266be3(0xbc1);let _0xab6feb;if(_0x160471[_0x266be3(0x259)]===_0x266be3(0x10c6)){const _0x1a6e6d=_0x160471[_0x266be3(0xb2d)]?'并评论说：\x22'+_0x160471[_0x266be3(0xb2d)]+'\x22':'';let _0x9292c1='原作者';const _0xc1ed34=_0x160471[_0x266be3(0x47e)]['authorId'];if(_0xc1ed34===_0x266be3(0xf86))_0x9292c1=_0x42f206['qzoneSettings'][_0x266be3(0x308)];else _0x42f206[_0x266be3(0x954)][_0xc1ed34]&&(_0x9292c1=_0x42f206[_0x266be3(0x954)][_0xc1ed34]['name']);let _0x519fc5;const _0x36aefe=_0x160471[_0x266be3(0x47e)];if(_0x36aefe['type']==='text_image')_0x519fc5=_0x266be3(0xd1d)+(_0x36aefe[_0x266be3(0xd2d)]||'')+'\x20(图片描述:\x20\x22'+(_0x36aefe['hiddenContent']||'')['substring'](0x0,0x28)+_0x266be3(0x10c8);else _0x36aefe['type']==='image_post'?_0x519fc5=_0x266be3(0x3af)+(_0x36aefe[_0x266be3(0xd2d)]||'')+_0x266be3(0x283)+(_0x36aefe[_0x266be3(0x343)]||'')[_0x266be3(0xa6d)](0x0,0x28)+'...\x22)':_0x519fc5='\x22'+(_0x36aefe[_0x266be3(0x1316)]||'')[_0x266be3(0xa6d)](0x0,0x28)+_0x266be3(0x7a2);_0xab6feb=_0x266be3(0x1144)+_0x9292c1+_0x266be3(0x225)+_0x1a6e6d+'【原动态内容:\x20'+_0x519fc5+'】';}else{if(_0x160471['type']===_0x266be3(0x1237))_0xab6feb=('[一张图片，其隐藏文字为：\x22'+_0x160471[_0x266be3(0x145)]+'\x22]\x20'+(_0x160471['publicText']||''))[_0x266be3(0xa6d)](0x0,0x32)+_0x266be3(0x10a0);else{if(_0x160471[_0x266be3(0x259)]===_0x266be3(0xe7f))_0xab6feb=(_0x266be3(0x41d)+_0x160471[_0x266be3(0x343)]+'\x22]\x20'+(_0x160471[_0x266be3(0xd2d)]||''))[_0x266be3(0xa6d)](0x0,0x32)+'...';else{if(_0x160471['type']==='naiimag'&&_0x160471['prompt']){const _0x136cd1=Array[_0x266be3(0x971)](_0x160471[_0x266be3(0xb55)])?_0x160471[_0x266be3(0xb55)]:[_0x160471[_0x266be3(0xb55)]];_0xab6feb=(_0x160471[_0x266be3(0xd2d)]||'')+('\x20[包含'+_0x136cd1[_0x266be3(0x131d)]+_0x266be3(0xc96)+_0x136cd1['join'](',\x20')+']');}else _0xab6feb=String(_0x160471[_0x266be3(0xd2d)]||_0x160471[_0x266be3(0x1316)]||_0x266be3(0x756))['substring'](0x0,0x32)+_0x266be3(0x10a0);}}}_0x5059d2+='-\x20(ID:\x20'+_0x160471['id']+_0x266be3(0x10b5)+_0x4ac134+_0x266be3(0x877)+_0xab6feb+'\x22\x0a';if(_0x160471[_0x266be3(0x946)]&&_0x160471[_0x266be3(0x946)][_0x266be3(0x131d)]>0x0)for(const _0x3daa3d of _0x160471[_0x266be3(0x946)]){if(typeof _0x3daa3d==='object'&&_0x3daa3d['commenterName']){const _0x3b49e8=_0x4e0b74(_0x3daa3d[_0x266be3(0x7a7)]);let _0x3ea714=_0x3daa3d[_0x266be3(0x32e)]?_0x266be3(0x631)+_0x3daa3d[_0x266be3(0x32e)]+'\x27]':_0x3daa3d[_0x266be3(0xdd5)];_0x3daa3d[_0x266be3(0x7a7)]===_0x13f56e[_0x266be3(0xa1)]?_0x5059d2+=_0x266be3(0x1325)+_0x3ea714+'\x0a':_0x5059d2+=_0x266be3(0x52c)+_0x3b49e8+_0x266be3(0x2dd)+_0x3daa3d['commenterName']+_0x266be3(0x352)+_0x3ea714+'\x0a';}}}_0x5e1e3d=_0x5059d2;}const _0x362b38=_0x266be3(0x8bf)+(_0x13f56e['longTermMemory']&&_0x13f56e[_0x266be3(0x94a)][_0x266be3(0x131d)]>0x0?_0x13f56e['longTermMemory'][_0x266be3(0xbf6)](_0xae9f70=>_0x266be3(0x101)+_0x1f0c92(_0xae9f70[_0x266be3(0xf16)])+')\x20'+_0xae9f70[_0x266be3(0x1316)])[_0x266be3(0x56c)]('\x0a'):_0x266be3(0xb86)),_0x26c7de=_0x492011(_0x13f56e,0x3,'hours'),_0x2f8623=_0x492011(_0x13f56e,0x6,_0x266be3(0xd92)),_0x13f4e8=_0x492011(_0x13f56e,0x9,'hours'),_0x55d58f=_0x492011(_0x13f56e,0x1,_0x266be3(0x534)),_0x3cdf0c=_0x492011(_0x13f56e,0x3,_0x266be3(0x534)),_0x2383c2=_0x492011(_0x13f56e,0x7,_0x266be3(0x534));let _0xd37c28='';if(_0x26c7de||_0x2f8623||_0x13f4e8||_0x55d58f||_0x3cdf0c||_0x2383c2){_0xd37c28+=_0x266be3(0x592);if(_0x26c7de)_0xd37c28+=_0x26c7de;if(_0x2f8623)_0xd37c28+=_0x2f8623;if(_0x13f4e8)_0xd37c28+=_0x13f4e8;if(_0x26c7de||_0x2f8623||_0x13f4e8)_0xd37c28+='\x0a';if(_0x55d58f)_0xd37c28+=_0x55d58f;if(_0x3cdf0c)_0xd37c28+=_0x3cdf0c;if(_0x2383c2)_0xd37c28+=_0x2383c2;}const _0x4e56e8=_0x18518f(_0x13f56e),_0xabd08c=_0x266be3(0x909)+_0x13f56e[_0x266be3(0x132a)]+_0x266be3(0x1195)+_0x13f56e['originalName']+_0x266be3(0x8d5)+_0x4bdaf9+_0x266be3(0xcd5)+(_0x13f56e[_0x266be3(0xda2)][_0x266be3(0x219)]?'\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是'+_0x3bc034+'\x20('+_0x5894c8+_0x266be3(0x6a6)+_0x4fd68a+'\x0a'+(_0x35fa93?_0x266be3(0x97f):''):'')+_0x266be3(0xc11)+(_0x13f56e[_0x266be3(0xc5d)]||'无')+'**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务铁律\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【至关重要】**:\x20当你发现“最近的动态列表”中，有你【感兴趣且还未互动过】的动态时，你**应该优先考虑**使用\x20\x27qzone_comment\x27\x20或\x20\x27qzone_like\x27\x20指令去进行互动，这比你自己发一条新动态更符合社交礼仪。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27[{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]\x27\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x83ebcf+_0x266be3(0x84c)+_0x1abef4+_0x266be3(0x13f1)+_0x13f56e[_0x266be3(0xda2)][_0x266be3(0x31d)]+_0x266be3(0x84c)+_0x3c70ca+_0x266be3(0x84c)+(_0x13f56e[_0x266be3(0x94a)]&&_0x13f56e[_0x266be3(0x94a)][_0x266be3(0x131d)]>0x0?_0x13f56e[_0x266be3(0x94a)][_0x266be3(0xbf6)](_0x1bcad1=>'-\x20(记录于\x20'+_0x1f0c92(_0x1bcad1[_0x266be3(0xf16)])+')\x20'+_0x1bcad1[_0x266be3(0x1316)])['join']('\x0a'):'无')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0xd37c28+_0x266be3(0x13b8)+_0x46f3fc+_0x266be3(0x84c)+(_0x13f56e['settings'][_0x266be3(0x219)]?_0x266be3(0x9ab)+_0x3bc034+'\x20('+_0x5894c8+')':'')+_0x266be3(0x84c)+(_0x13f56e[_0x266be3(0xda2)][_0x266be3(0x219)]?_0x266be3(0x815)+_0x4fd68a:'')+'\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4e56e8+_0x266be3(0xdfd)+_0x2d0314+_0x266be3(0x84c)+_0x5e1e3d+'\x0a',_0x213148=[{'role':_0x266be3(0x1370),'content':_0xabd08c},..._0x291b9f[_0x266be3(0xbf6)](_0x218a5f=>{const _0x354ac0=_0x266be3,_0x4ebba6=_0x218a5f[_0x354ac0(0xaeb)]===_0x354ac0(0xf86)?_0x4bdaf9:_0x13f56e[_0x354ac0(0x132a)];let _0x21ed1d=_0x218a5f['content'];return typeof _0x21ed1d!=='string'&&(_0x21ed1d=JSON[_0x354ac0(0xc04)](_0x21ed1d)),{'role':_0x218a5f[_0x354ac0(0xaeb)],'content':_0x4ebba6+':\x20'+_0x21ed1d};})];try{const _0xbf5cd2=[{'role':_0x266be3(0xf86),'content':_0xabd08c+_0x266be3(0xac4)+_0x5e1e3d}];console[_0x266be3(0x7d1)](_0x266be3(0x1436)+_0x13f56e[_0x266be3(0x132a)]+'\x22)');let _0xd1929=_0x1c7a35===GEMINI_API_URL,_0xdbf014=_0x5d73db(_0x495fe2,_0x4e402c,_0xabd08c,_0xbf5cd2);const _0x40e88a=_0xd1929?await fetch(_0xdbf014['url'],_0xdbf014[_0x266be3(0x76b)]):await fetch(_0x1c7a35+_0x266be3(0xd7),{'method':'POST','headers':{'Content-Type':_0x266be3(0xa0e),'Authorization':_0x266be3(0x8aa)+_0x4e402c},'body':JSON[_0x266be3(0xc04)]({'model':_0x495fe2,'messages':_0xbf5cd2,'temperature':_0x42f206[_0x266be3(0xf0)]['apiTemperature']||0.9})});if(!_0x40e88a['ok']){const _0x3941b2=await _0x40e88a[_0x266be3(0xaef)]();throw new Error(_0x266be3(0x1459)+_0x40e88a[_0x266be3(0x13b2)]+_0x266be3(0x7da)+JSON[_0x266be3(0xc04)](_0x3941b2));}const _0xa84e9f=await _0x40e88a[_0x266be3(0xaef)](),_0xf71d6c=_0xd1929?getGeminiResponseText(_0xa84e9f):_0xa84e9f[_0x266be3(0x2f9)][0x0][_0x266be3(0x7aa)][_0x266be3(0x1316)];if(!_0xf71d6c||_0xf71d6c[_0x266be3(0x2aa)]()===''){console[_0x266be3(0x1b6)](_0x266be3(0xfa2)+_0x13f56e[_0x266be3(0x132a)]+_0x266be3(0x120));return;}const _0x48771d=_0x418096(_0xf71d6c);if(!_0x48771d||_0x48771d[_0x266be3(0x131d)]===0x0){console[_0x266be3(0x1b6)]('API格式不正确，角色\x20\x22'+_0x13f56e[_0x266be3(0x132a)]+_0x266be3(0x8b4),_0xf71d6c);return;}let _0x58bd41=Date['now'](),_0x11257f=![];const _0x428342=[];for(const _0x21358b of _0x48771d){const _0x2abb35=String(_0x21358b[_0x266be3(0x1316)]||''),_0x1711fb=_0x2abb35['trim']()[_0x266be3(0x13ad)]('<')&&_0x2abb35[_0x266be3(0x2aa)]()['endsWith']('>');if(_0x21358b[_0x266be3(0x259)]==='text'&&!_0x1711fb&&_0x2abb35[_0x266be3(0xd8d)]('\x0a')){const _0x257e67=_0x2abb35[_0x266be3(0x90b)](/\n+/)['filter'](_0x548a0e=>_0x548a0e[_0x266be3(0x2aa)]());_0x257e67[_0x266be3(0x12c2)](_0x419ae7=>{const _0x1402bb=_0x266be3;_0x428342[_0x1402bb(0x129e)]({..._0x21358b,'content':_0x419ae7});});}else _0x428342[_0x266be3(0x129e)](_0x21358b);}for(const _0x5b0679 of _0x428342){_0x13f56e[_0x266be3(0xc5d)]=_0x5b0679[_0x266be3(0x259)],_0x13f56e[_0x266be3(0x2d2)]=_0x58bd41;let _0x43979b=null;const _0x219e69={'role':'assistant','senderName':_0x13f56e[_0x266be3(0xa1)],'timestamp':_0x58bd41++};let _0x503ec3=null;switch(_0x5b0679[_0x266be3(0x259)]){case'qzone_delete_post':{const _0x5cc12b=parseInt(_0x5b0679['postId']),_0x5e35cd=await _0x17d534[_0x266be3(0x15b)][_0x266be3(0x36d)](_0x5cc12b);if(_0x5e35cd&&_0x5e35cd[_0x266be3(0x1086)]===_0x2b4343){await _0x17d534['qzonePosts'][_0x266be3(0x938)](_0x5cc12b,{'isDeleted':!![]});document['getElementById']('qzone-screen')[_0x266be3(0x11c2)][_0x266be3(0x526)](_0x266be3(0xfe1))&&_0x316550();const _0x394519={'role':_0x266be3(0x1370),'type':'post_deleted_notice','content':'['+_0x13f56e[_0x266be3(0x132a)]+_0x266be3(0xc1d),'postId':_0x5cc12b,'timestamp':_0x58bd41++};_0x13f56e[_0x266be3(0x1d5)]['push'](_0x394519),isViewingThisChat?_0x5d5ee2(_0x394519,_0x13f56e):(_0x13f56e['unreadCount']=(_0x13f56e[_0x266be3(0x12c9)]||0x0)+0x1,_0x478393(_0x2b4343,'['+_0x13f56e[_0x266be3(0x132a)]+_0x266be3(0xc1d)),_0x11257f=!![]);}else console[_0x266be3(0x1b6)](_0x266be3(0x108)+_0x13f56e[_0x266be3(0x132a)]+_0x266be3(0xee4)+_0x5b0679[_0x266be3(0x13bc)]+')');continue;}case _0x266be3(0xdd5):_0x43979b={..._0x219e69,'content':_0x5b0679[_0x266be3(0x1316)]};break;case _0x266be3(0xb1e):_0x43979b={..._0x219e69,'type':_0x266be3(0xb1e),'content':_0x5b0679[_0x266be3(0x4e9)]};break;case _0x266be3(0x869):if(_0x5b0679['meaning']){const _0x4ab3d0=_0x42f206[_0x266be3(0x1294)][_0x266be3(0xb07)](_0x23736c=>_0x23736c[_0x266be3(0x132a)]===_0x5b0679['meaning']);_0x4ab3d0?_0x43979b={..._0x219e69,'type':_0x266be3(0x869),'content':_0x4ab3d0[_0x266be3(0x1377)],'meaning':_0x4ab3d0[_0x266be3(0x132a)]}:(console['warn']('AI\x20(独立行动)\x20尝试使用一个不存在的表情:\x20\x22'+_0x5b0679[_0x266be3(0x32e)]+'\x22'),_0x43979b={..._0x219e69,'type':_0x266be3(0xdd5),'content':_0x266be3(0x21f)+_0x5b0679[_0x266be3(0x32e)]+']'});}else console[_0x266be3(0x1b6)](_0x266be3(0x8e8),_0x5b0679),_0x43979b={..._0x219e69,'type':_0x266be3(0x869),'content':_0x5b0679[_0x266be3(0x1377)],'meaning':_0x266be3(0x11a2)};break;case _0x266be3(0xbb3):_0x13f56e[_0x266be3(0x13b2)]['text']=_0x5b0679[_0x266be3(0x163)],_0x13f56e['status'][_0x266be3(0x91b)]=_0x5b0679[_0x266be3(0xa14)]||![],_0x13f56e[_0x266be3(0x13b2)][_0x266be3(0xbdd)]=Date[_0x266be3(0x606)]();break;case'qzone_post':const _0xd1a61e={'type':_0x5b0679[_0x266be3(0xbc2)],'content':_0x5b0679[_0x266be3(0x1316)]||'','publicText':_0x5b0679['publicText']||'','hiddenContent':_0x5b0679[_0x266be3(0x145)]||'','image_prompt':_0x5b0679[_0x266be3(0xef)]||'','timestamp':Date['now'](),'authorId':_0x2b4343,'authorOriginalName':_0x13f56e[_0x266be3(0xa1)],'authorGroupId':_0x13f56e[_0x266be3(0x1437)],'visibleGroupIds':null};await _0x17d534[_0x266be3(0x15b)][_0x266be3(0xa58)](_0xd1a61e),_0x276281(_0x116b59+0x1),console['log'](_0x266be3(0xdd6)+_0x13f56e['name']+_0x266be3(0xf83));break;case _0x266be3(0x10c6):const _0x28489a=await _0x17d534['qzonePosts'][_0x266be3(0x36d)](parseInt(_0x5b0679[_0x266be3(0x13bc)]));if(_0x28489a){const _0x47fdd7={'type':_0x266be3(0x10c6),'timestamp':Date[_0x266be3(0x606)](),'authorId':_0x2b4343,'authorGroupId':_0x13f56e[_0x266be3(0x1437)],'authorOriginalName':_0x13f56e[_0x266be3(0xa1)],'repostComment':_0x5b0679[_0x266be3(0xcb4)]||'','originalPost':_0x28489a,'visibleGroupIds':null};await _0x17d534[_0x266be3(0x15b)][_0x266be3(0xa58)](_0x47fdd7),_0x276281(_0x116b59+0x1),console[_0x266be3(0x7d1)](_0x266be3(0xdd6)+_0x13f56e[_0x266be3(0x132a)]+_0x266be3(0x3e2)+_0x5b0679[_0x266be3(0x13bc)]);}break;case _0x266be3(0xc72):const _0x26c109=await _0x17d534[_0x266be3(0x15b)][_0x266be3(0x36d)](parseInt(_0x5b0679[_0x266be3(0x13bc)]));if(_0x26c109){if(!_0x26c109[_0x266be3(0x1be)])_0x26c109[_0x266be3(0x1be)]=[];!_0x26c109['likes']['includes'](_0x13f56e[_0x266be3(0xa1)])&&(_0x26c109[_0x266be3(0x1be)][_0x266be3(0x129e)](_0x13f56e[_0x266be3(0xa1)]),await _0x17d534[_0x266be3(0x15b)][_0x266be3(0x938)](_0x26c109['id'],{'likes':_0x26c109[_0x266be3(0x1be)]}),_0x276281(_0x116b59+0x1),console[_0x266be3(0x7d1)](_0x266be3(0xdd6)+_0x13f56e[_0x266be3(0x132a)]+_0x266be3(0x1231)+_0x5b0679[_0x266be3(0x13bc)]));}break;case _0x266be3(0x1032):{const _0xdf9f7e=await _0x17d534[_0x266be3(0x15b)][_0x266be3(0x36d)](parseInt(_0x5b0679[_0x266be3(0x13bc)]));if(_0xdf9f7e){if(!_0xdf9f7e[_0x266be3(0x946)])_0xdf9f7e['comments']=[];const _0x5d9455=_0x5b0679[_0x266be3(0x132a)]||_0x13f56e[_0x266be3(0xa1)],_0x458b3a=(_0x591da7,_0x381580=null,_0x541feb=null)=>({'commenterName':_0x5d9455,'text':_0xcad370(_0x591da7,_0x13f56e),'meaning':_0x381580,'replyTo':_0x541feb,'timestamp':Date['now']()});if(_0x5b0679[_0x266be3(0x293)]){const _0x3deb5d=_0x42f206[_0x266be3(0x1294)][_0x266be3(0xb07)](_0x3f3b3c=>_0x3f3b3c[_0x266be3(0x132a)]===_0x5b0679[_0x266be3(0x293)]);_0x3deb5d?_0xdf9f7e[_0x266be3(0x946)]['push'](_0x458b3a(_0x3deb5d[_0x266be3(0x1377)],_0x3deb5d[_0x266be3(0x132a)],_0x5b0679[_0x266be3(0xd75)]||null)):(console[_0x266be3(0x1b6)](_0x266be3(0x128d)+_0x5b0679[_0x266be3(0x293)]+'\x22'),_0xdf9f7e[_0x266be3(0x946)][_0x266be3(0x129e)](_0x458b3a('[表情:\x20'+_0x5b0679[_0x266be3(0x293)]+']',null,_0x5b0679[_0x266be3(0xd75)]||null)));}else{if(Array['isArray'](_0x5b0679['comments']))_0x5b0679['comments'][_0x266be3(0x12c2)](_0x3bb99b=>{const _0x327f7b=_0x266be3;typeof _0x3bb99b===_0x327f7b(0x861)&&_0x3bb99b[_0x327f7b(0x2aa)]()&&_0xdf9f7e[_0x327f7b(0x946)][_0x327f7b(0x129e)](_0x458b3a(_0x3bb99b,null,_0x5b0679[_0x327f7b(0xd75)]||null));});else typeof _0x5b0679[_0x266be3(0x8f4)]===_0x266be3(0x861)&&_0x5b0679['commentText'][_0x266be3(0x2aa)]()&&_0xdf9f7e['comments'][_0x266be3(0x129e)](_0x458b3a(_0x5b0679[_0x266be3(0x8f4)],null,_0x5b0679[_0x266be3(0xd75)]||null));}await _0x17d534[_0x266be3(0x15b)][_0x266be3(0x938)](_0xdf9f7e['id'],{'comments':_0xdf9f7e[_0x266be3(0x946)]}),_0x276281(_0x116b59+0x1),console[_0x266be3(0x7d1)](_0x266be3(0xdd6)+_0x13f56e[_0x266be3(0x132a)]+_0x266be3(0x902)+_0x5b0679[_0x266be3(0x13bc)]);if(!_0x13f56e['commentCooldowns'])_0x13f56e[_0x266be3(0x43b)]={};_0x13f56e[_0x266be3(0x43b)][_0x5b0679[_0x266be3(0x13bc)]]=Date['now']();}continue;}case _0x266be3(0xc85):!_0x4a3337[_0x266be3(0x1196)]&&!_0x4a3337[_0x266be3(0x9a6)]&&(_0x4a3337[_0x266be3(0x9a6)]=!![],_0x4a3337[_0x266be3(0x81d)]=_0x2b4343,_0x4a3337[_0x266be3(0x60a)]=![],_0x4a3337[_0x266be3(0xa1e)]=_0x13f56e[_0x266be3(0x132a)],_0x5ed899());break;default:console[_0x266be3(0x1b6)](_0x266be3(0x714)+_0x13f56e[_0x266be3(0x132a)]+_0x266be3(0x102d),_0x5b0679['type']);break;case _0x266be3(0x23c):{const _0x2ba090=_0x5b0679[_0x266be3(0x132a)],_0x18b6a6=_0x13f56e['settings'][_0x266be3(0x5d3)][_0x266be3(0xb07)](_0xcc9d01=>_0xcc9d01[_0x266be3(0x132a)]===_0x2ba090);_0x18b6a6&&(_0x13f56e[_0x266be3(0xda2)]['aiAvatar']=_0x18b6a6[_0x266be3(0x1377)],await _0x249add(_0x13f56e),visibleSystemMessage={'content':'['+_0x13f56e['name']+_0x266be3(0x762)},console[_0x266be3(0x7d1)](_0x266be3(0xdd6)+_0x13f56e[_0x266be3(0x132a)]+_0x266be3(0xec0)));break;}}if(_0x43979b){_0x13f56e['history'][_0x266be3(0x129e)](_0x43979b),_0x13f56e[_0x266be3(0x12c9)]=(_0x13f56e['unreadCount']||0x0)+0x1;if(!_0x11257f){let _0x5006e4=_0x43979b[_0x266be3(0x259)]===_0x266be3(0xb1e)?_0x266be3(0xf72):_0x43979b[_0x266be3(0x1316)]||'';_0x478393(_0x2b4343,_0x5006e4),_0x11257f=!![];}}}await _0x17d534[_0x266be3(0x954)]['put'](_0x13f56e);}catch(_0x4ceb90){console[_0x266be3(0xb61)](_0x266be3(0x714)+_0x13f56e['name']+_0x266be3(0x13e4),_0x4ceb90);}finally{_0x260324(_0x2b4343,![]),_0x27be5e(),document[_0x266be3(0x458)](_0x266be3(0x1116))[_0x266be3(0x11c2)]['contains']('active')&&_0x316550();}}async function _0x162dd9(_0x17d4e1){const _0xa91285=_0x204348,_0x5cdb38=_0x42f206['chats'][_0x17d4e1];if(!_0x5cdb38||!_0x5cdb38['isGroup'])return;const _0x3c06f0=_0x5cdb38[_0xa91285(0xda2)]['actionCooldownMinutes']||0xa;if(_0x5cdb38[_0xa91285(0x2d2)]){const _0x6226c1=(Date[_0xa91285(0x606)]()-_0x5cdb38[_0xa91285(0x2d2)])/(0x3e8*0x3c);if(_0x6226c1<_0x3c06f0){console[_0xa91285(0x7d1)](_0xa91285(0x11d)+_0x5cdb38[_0xa91285(0x132a)]+_0xa91285(0xaa0));return;}}const {proxyUrl:_0x1da8ee,apiKey:_0x357981,model:_0x25c90d}=_0x42f206['apiConfig'];if(!_0x1da8ee||!_0x357981||!_0x25c90d)return;const _0x4689d2=_0x5cdb38[_0xa91285(0xda2)][_0xa91285(0xc7d)]||'我',_0x2a8a24=new Date();let _0x3fc440;const _0xdde05d=_0x5cdb38['history'][_0xa91285(0xaf1)](_0x47a009=>!_0x47a009[_0xa91285(0x7a0)])[_0xa91285(0x5b0)](-0x5),_0x54528d=_0xdde05d[_0xa91285(0xb07)](_0x428990=>_0x428990[_0xa91285(0x259)]===_0xa91285(0xd9e)&&!_0x428990[_0xa91285(0x1258)]);if(_0x54528d){const _0x4c983f=_0x32d364(_0x5cdb38,_0x54528d[_0xa91285(0x2a3)]);console[_0xa91285(0x7d1)](_0xa91285(0x5a4)+_0x5cdb38['name']+'\x22\x20中有未领完的红包，正在生成抢红包指令...'),_0x3fc440=_0xa91285(0xf48)+_0x4c983f+_0xa91285(0xb8c)+_0x54528d[_0xa91285(0xf16)]+'）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20'+_0x54528d['timestamp']+_0xa91285(0x461);}else{let _0x31cd39='';const _0x4b4f6=_0x5cdb38[_0xa91285(0xda2)][_0xa91285(0xc7a)]||'Asia/Shanghai',_0x3b9894=_0x2a8a24[_0xa91285(0xe43)](_0xa91285(0xaa2),{'timeZone':_0x4b4f6,'dateStyle':'full','timeStyle':_0xa91285(0xabe)}),_0x217824=new Date(_0x2a8a24['toLocaleString']('en-US',{'timeZone':_0x4b4f6}));if(_0x5cdb38['settings'][_0xa91285(0x219)]){const _0x13b386=_0x5cdb38[_0xa91285(0x1d5)]['filter'](_0x2cf445=>!_0x2cf445[_0xa91285(0x7a0)])[_0xa91285(0x5b0)](-0x1)[0x0];if(_0x13b386){const _0x1c8813=new Date(_0x13b386[_0xa91285(0xf16)]),_0x36ba26=(_0x2a8a24-_0x1c8813)/(0x3e8*0x3c);_0x36ba26>0x3c?_0x31cd39=_0xa91285(0x95a)+Math['round'](_0x36ba26/0x3c)+'\x20小时了。':_0x31cd39=_0xa91285(0x73)+Math[_0xa91285(0xbd5)](_0x36ba26)+'分钟前有人聊过。';}else _0x31cd39=_0xa91285(0x108b);}let _0x5f00b6='你们最近没有有效聊天记录。';const _0x301767=_0x5cdb38[_0xa91285(0xda2)]['maxMemory']||0xa,_0x6b4e16=_0x5cdb38[_0xa91285(0x1d5)][_0xa91285(0xaf1)](_0x5cad86=>!_0x5cad86[_0xa91285(0x7a0)])['slice'](-_0x301767);_0x6b4e16[_0xa91285(0x131d)]>0x0&&(_0x5f00b6=_0xa91285(0x15d)+_0x6b4e16[_0xa91285(0xbf6)](_0x4e1d71=>{const _0x4d9a0a=_0xa91285,_0x1cb446=_0x4e1d71[_0x4d9a0a(0xaeb)]===_0x4d9a0a(0xf86)?_0x4689d2:_0x32d364(_0x5cdb38,_0x4e1d71[_0x4d9a0a(0x2a3)]),_0x12e1a8=String(_0x4e1d71[_0x4d9a0a(0x1316)]||_0x4e1d71[_0x4d9a0a(0x7aa)]||'')['substring'](0x0,0x32);return _0x1cb446+':\x20'+_0x12e1a8+_0x4d9a0a(0x10a0);})[_0xa91285(0x56c)]('\x0a'));const _0x25bd72=_0x5cdb38[_0xa91285(0xfa8)][_0xa91285(0xbf6)](_0x243c95=>_0xa91285(0x1293)+_0x243c95[_0xa91285(0x1118)]+_0xa91285(0x83f)+_0x243c95['originalName']+_0xa91285(0x352)+_0x243c95[_0xa91285(0x124d)])[_0xa91285(0x56c)]('\x0a');let _0x4e5282=_0xa91285(0x509),_0x149539=![];_0x5cdb38[_0xa91285(0xfa8)]['forEach'](_0x50b80a=>{const _0x20d05f=_0xa91285,_0x43b6a6=_0x42f206[_0x20d05f(0x954)][_0x50b80a['id']];_0x43b6a6&&_0x43b6a6['longTermMemory']&&_0x43b6a6[_0x20d05f(0x94a)][_0x20d05f(0x131d)]>0x0&&(_0x4e5282+='\x0a##\x20---\x20关于“'+_0x50b80a['groupNickname']+_0x20d05f(0x29d),_0x4e5282+=_0x43b6a6[_0x20d05f(0x94a)][_0x20d05f(0xbf6)](_0x3ded19=>'-\x20'+_0x3ded19[_0x20d05f(0x1316)])[_0x20d05f(0x56c)]('\x0a'),_0x149539=!![]);});!_0x149539&&(_0x4e5282+='-\x20(暂无)');let _0x52c018='';if(_0x5cdb38['settings']['linkedWorldBookIds']&&_0x5cdb38[_0xa91285(0xda2)][_0xa91285(0x315)][_0xa91285(0x131d)]>0x0){const _0xa2295f=_0x5cdb38[_0xa91285(0xda2)]['linkedWorldBookIds']['map'](_0x115aef=>{const _0x26c878=_0xa91285,_0x492a77=_0x42f206[_0x26c878(0xab7)][_0x26c878(0xb07)](_0x566dc3=>_0x566dc3['id']===_0x115aef);if(!_0x492a77||!Array[_0x26c878(0x971)](_0x492a77['content']))return'';const _0x542078=_0x492a77[_0x26c878(0x1316)][_0x26c878(0xaf1)](_0x1db437=>_0x1db437[_0x26c878(0x12fb)]!==![])['map'](_0xf8d559=>{const _0x4691fd=_0x26c878;let _0x3f713e=_0x4691fd(0x111f)+(_0xf8d559[_0x4691fd(0xcb4)]||_0x4691fd(0xfdc))+'\x0a';return _0xf8d559[_0x4691fd(0x634)]['length']>0x0&&(_0x3f713e+=_0x4691fd(0xe8c)+_0xf8d559['keys']['join'](',\x20')+'\x0a'),_0x3f713e+=_0x4691fd(0xcdf)+_0xf8d559[_0x4691fd(0x1316)],_0x3f713e;})[_0x26c878(0x56c)]('');return _0x542078?'\x0a\x0a##\x20世界书:\x20'+_0x492a77[_0x26c878(0x132a)]+'\x0a'+_0x542078:'';})[_0xa91285(0xaf1)](Boolean)[_0xa91285(0x56c)]('');_0xa2295f&&(_0x52c018=_0xa91285(0x518)+_0xa2295f+_0xa91285(0xdcc));}let _0x351ef8='';const _0x2360d4=_0x5cdb38[_0xa91285(0xda2)][_0xa91285(0x912)]||0xa;if(_0x5cdb38[_0xa91285(0xda2)]['linkedMemoryChatIds']&&_0x5cdb38[_0xa91285(0xda2)]['linkedMemoryChatIds'][_0xa91285(0x131d)]>0x0){const _0xa068a7=_0x5cdb38[_0xa91285(0xda2)][_0xa91285(0x1448)][_0xa91285(0xbf6)](_0x5152f4=>{const _0x5308ca=_0xa91285,_0x4ebf40=_0x42f206[_0x5308ca(0x954)][_0x5152f4];if(!_0x4ebf40)return null;const _0x447257=_0x4ebf40[_0x5308ca(0x1d5)]['slice'](-0x1)[0x0];return{'chat':_0x4ebf40,'latestTimestamp':_0x447257?_0x447257[_0x5308ca(0xf16)]:0x0};})[_0xa91285(0xaf1)](Boolean);_0xa068a7[_0xa91285(0xc12)]((_0x53f3f9,_0x55ebad)=>_0x55ebad[_0xa91285(0xff2)]-_0x53f3f9[_0xa91285(0xff2)]),_0x351ef8+=_0xa91285(0x6a4);for(const _0x4f8073 of _0xa068a7){const _0x431d99=_0x4f8073['chat'],_0x24a675=_0x431d99[_0xa91285(0x726)]?_0xa91285(0x13f3):'[私聊]',_0x3b6a43=_0x4f8073['latestTimestamp']>0x0?_0xa91285(0x7b5)+_0x1f0c92(_0x4f8073[_0xa91285(0xff2)])+')':'';_0x351ef8+=_0xa91285(0x1023)+_0x24a675+'“'+_0x431d99[_0xa91285(0x132a)]+_0xa91285(0x1342)+_0x3b6a43+_0xa91285(0xc46);const _0x2b6037=_0x431d99['history']['slice'](-_0x2360d4),_0x1da5c7=_0x2b6037[_0xa91285(0xaf1)](_0xe750ab=>!String(_0xe750ab[_0xa91285(0x1316)])[_0xa91285(0xd8d)]('已被用户删除'));_0x1da5c7[_0xa91285(0x131d)]>0x0?_0x1da5c7[_0xa91285(0x12c2)](_0x4deb6b=>{const _0x2b359c=_0xa91285,_0xa783cf=_0x4deb6b[_0x2b359c(0xaeb)]==='user'?_0x431d99[_0x2b359c(0xda2)][_0x2b359c(0xc7d)]||'我':_0x4deb6b[_0x2b359c(0x2a3)]||_0x431d99[_0x2b359c(0x132a)];let _0x3cd9f1=String(_0x4deb6b[_0x2b359c(0x1316)]);if(_0x4deb6b[_0x2b359c(0x259)]==='ai_image'||_0x4deb6b['type']==='user_photo')_0x3cd9f1=_0x2b359c(0xf43)+_0x4deb6b[_0x2b359c(0x1316)]+']';else _0x4deb6b[_0x2b359c(0x259)]===_0x2b359c(0xefa)&&(_0x3cd9f1=_0x2b359c(0xc44)+_0x4deb6b[_0x2b359c(0x1316)]+']');_0x351ef8+=_0xa783cf+':\x20'+_0x3cd9f1+'\x0a';}):_0x351ef8+='(暂无有效聊天记录)\x0a';}}const _0x4a3149=await _0x17d534[_0xa91285(0x15b)]['orderBy'](_0xa91285(0xf16))[_0xa91285(0x115b)]()['limit'](0x5)['toArray']();let _0x17890c='';const _0x2395e4=new Set();for(const _0x596f94 of _0x5cdb38['members']){const _0x5bba3a=_0x42f206[_0xa91285(0x954)][_0x596f94['id']];if(_0x5bba3a){const _0x52b7bc=_0x40b385(_0x4a3149,_0x5bba3a);_0x52b7bc[_0xa91285(0x12c2)](_0x404aab=>_0x2395e4[_0xa91285(0xa58)](_0x404aab));}}const _0x3dcdec=new Set(_0x5cdb38['members']['map'](_0x2cc682=>_0x2cc682[_0xa91285(0xa1)])),_0x46bdcb=[..._0x2395e4][_0xa91285(0xaf1)](_0x5ddbf6=>{const _0x1e771e=_0xa91285,_0x39440b=_0x5ddbf6[_0x1e771e(0x1be)]&&_0x5ddbf6['likes'][_0x1e771e(0x593)](_0x263f44=>_0x3dcdec[_0x1e771e(0x31c)](_0x263f44)),_0x34438e=_0x5ddbf6[_0x1e771e(0x946)]&&_0x5ddbf6[_0x1e771e(0x946)]['some'](_0x52ee44=>typeof _0x52ee44==='object'&&_0x3dcdec[_0x1e771e(0x31c)](_0x52ee44['commenterName']));return!_0x39440b&&!_0x34438e;});if(_0x46bdcb[_0xa91285(0x131d)]>0x0){let _0x486fa2=_0xa91285(0x66e);for(const _0x536745 of _0x46bdcb){let _0x4ae204=_0x536745['authorId']===_0xa91285(0xf86)?_0x4689d2:_0x42f206[_0xa91285(0x954)][_0x536745['authorId']]?.[_0xa91285(0x132a)]||_0xa91285(0x366),_0x2cacde;if(_0x536745[_0xa91285(0x259)]===_0xa91285(0x10c6)){const _0x25b4aa=_0x536745['repostComment']?'并评论说：“'+_0x536745[_0xa91285(0xb2d)]+'”':'';let _0x413c1a=_0xa91285(0xd3a);const _0x223b87=_0x536745['originalPost'][_0xa91285(0x1086)];if(_0x223b87===_0xa91285(0xf86))_0x413c1a=_0x42f206[_0xa91285(0x551)]['nickname'];else _0x42f206[_0xa91285(0x954)][_0x223b87]&&(_0x413c1a=_0x42f206['chats'][_0x223b87]['name']);let _0x5c21a4;const _0xaba715=_0x536745[_0xa91285(0x47e)];if(_0xaba715[_0xa91285(0x259)]===_0xa91285(0x1237))_0x5c21a4=_0xa91285(0xd1d)+(_0xaba715['publicText']||'')+_0xa91285(0x4c2)+(_0xaba715['hiddenContent']||'')['substring'](0x0,0x28)+_0xa91285(0xfea);else _0xaba715[_0xa91285(0x259)]===_0xa91285(0xe7f)?_0x5c21a4=_0xa91285(0x3af)+(_0xaba715['publicText']||'')+_0xa91285(0x4c2)+(_0xaba715['imageDescription']||'')[_0xa91285(0xa6d)](0x0,0x28)+_0xa91285(0xfea):_0x5c21a4='“'+(_0xaba715[_0xa91285(0x1316)]||'')[_0xa91285(0xa6d)](0x0,0x28)+_0xa91285(0x5b2);_0x2cacde=_0xa91285(0x1144)+_0x413c1a+_0xa91285(0x225)+_0x25b4aa+_0xa91285(0xa31)+_0x5c21a4+'】';}else{if(_0x536745[_0xa91285(0x259)]==='text_image')_0x2cacde=('[一张图片，其隐藏文字为：“'+_0x536745[_0xa91285(0x145)]+_0xa91285(0x7b2)+(_0x536745[_0xa91285(0xd2d)]||''))[_0xa91285(0xa6d)](0x0,0x32)+_0xa91285(0x10a0);else _0x536745['type']==='image_post'?_0x2cacde=(_0xa91285(0x767)+_0x536745[_0xa91285(0x343)]+'”]\x20'+(_0x536745['publicText']||''))[_0xa91285(0xa6d)](0x0,0x32)+'...':_0x2cacde=String(_0x536745[_0xa91285(0xd2d)]||_0x536745[_0xa91285(0x1316)]||'一条动态')[_0xa91285(0xa6d)](0x0,0x32)+_0xa91285(0x10a0);}_0x486fa2+='-\x20(ID:\x20'+_0x536745['id']+')\x20作者:\x20'+_0x4ae204+',\x20内容:\x20\x22'+_0x2cacde+'\x22\x0a';if(_0x536745['comments']&&_0x536745[_0xa91285(0x946)][_0xa91285(0x131d)]>0x0)for(const _0x4fb25b of _0x536745[_0xa91285(0x946)]){if(typeof _0x4fb25b==='object'&&_0x4fb25b['commenterName']){const _0x1d0e91=_0x4e0b74(_0x4fb25b['commenterName']);let _0x59a138=_0x4fb25b[_0xa91285(0x32e)]?_0xa91285(0x631)+_0x4fb25b[_0xa91285(0x32e)]+'\x27]':_0x4fb25b[_0xa91285(0xdd5)];_0x486fa2+=_0xa91285(0x52c)+_0x1d0e91+_0xa91285(0x2dd)+_0x4fb25b['commenterName']+'):\x20'+_0x59a138+'\x0a';}}}_0x17890c=_0x486fa2;}const _0x5730d2=_0x492011(_0x5cdb38,0x3,_0xa91285(0xd92)),_0x3c6a58=_0x492011(_0x5cdb38,0x6,_0xa91285(0xd92)),_0x577761=_0x492011(_0x5cdb38,0x9,_0xa91285(0xd92)),_0x1fbbab=_0x492011(_0x5cdb38,0x1,'days'),_0x413f99=_0x492011(_0x5cdb38,0x3,_0xa91285(0x534)),_0x2c944d=_0x492011(_0x5cdb38,0x7,_0xa91285(0x534));let _0x2bb733='';if(_0x5730d2||_0x3c6a58||_0x577761||_0x1fbbab||_0x413f99||_0x2c944d){_0x2bb733+='\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a';if(_0x5730d2)_0x2bb733+=_0x5730d2;if(_0x3c6a58)_0x2bb733+=_0x3c6a58;if(_0x577761)_0x2bb733+=_0x577761;if(_0x5730d2||_0x3c6a58||_0x577761)_0x2bb733+='\x0a';if(_0x1fbbab)_0x2bb733+=_0x1fbbab;if(_0x413f99)_0x2bb733+=_0x413f99;if(_0x2c944d)_0x2bb733+=_0x2c944d;}const _0x460fc8=_0x386294(_0x5cdb38);_0x3fc440='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“'+_0x5cdb38[_0xa91285(0x132a)]+'”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x5cdb38['settings'][_0xa91285(0x219)]?_0xa91285(0x980)+_0x3b9894+'。':'')+_0xa91285(0x84c)+(_0x31cd39?_0x31cd39+'\x20':'')+_0xa91285(0x801)+_0x4e5282+_0xa91285(0xf25)+_0x4689d2+_0xa91285(0x71f)+_0x5cdb38[_0xa91285(0x132a)]+_0xa91285(0x84c)+_0x52c018+_0xa91285(0x689)+(_0x5cdb38[_0xa91285(0x94a)]&&_0x5cdb38[_0xa91285(0x94a)][_0xa91285(0x131d)]>0x0?_0x5cdb38[_0xa91285(0x94a)][_0xa91285(0xbf6)](_0x46714d=>'-\x20'+_0x46714d[_0xa91285(0x1316)])[_0xa91285(0x56c)]('\x0a'):_0xa91285(0xb86))+_0xa91285(0x181)+_0x2bb733+_0xa91285(0x84c)+_0x351ef8+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x25bd72+_0xa91285(0xf62)+_0x460fc8+'\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**'+_0x4689d2+_0xa91285(0x20a)+_0x5cdb38[_0xa91285(0xda2)][_0xa91285(0x65f)]+_0xa91285(0x1038)+_0x5f00b6+_0xa91285(0xadc)+_0x17890c+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}const _0x45f81c=_0x5cdb38['history'][_0xa91285(0xaf1)](_0x5a0841=>!_0x5a0841[_0xa91285(0x7a0)])[_0xa91285(0x5b0)](-0xa),_0x2bc79e=[{'role':'system','content':_0x3fc440},..._0x45f81c['map'](_0x50ca92=>{const _0x2236f0=_0xa91285,_0x240612=_0x50ca92[_0x2236f0(0xaeb)]===_0x2236f0(0xf86)?_0x4689d2:_0x32d364(_0x5cdb38,_0x50ca92['senderName']);let _0x1ac1f6=_0x50ca92[_0x2236f0(0x1316)];if(_0x50ca92['type']==='ai_image'||_0x50ca92['type']==='user_photo')_0x1ac1f6=_0x2236f0(0x60d)+_0x50ca92[_0x2236f0(0x1316)]+'\x27]';else{if(_0x50ca92[_0x2236f0(0x259)]===_0x2236f0(0xefa))_0x1ac1f6=_0x2236f0(0xa4f)+_0x50ca92[_0x2236f0(0x1316)]+'\x27]';else typeof _0x1ac1f6!==_0x2236f0(0x861)&&(_0x1ac1f6='[发送了一条复杂消息，如卡片或转账]');}return{'role':_0x2236f0(0xf86),'content':_0x240612+':\x20'+_0x1ac1f6};})];try{const _0x13d3e8=[{'role':'user','content':_0x3fc440}];let _0x4d0803=_0x1da8ee===GEMINI_API_URL,_0x151bcb=_0x5d73db(_0x25c90d,_0x357981,_0x3fc440,_0x13d3e8);const _0x2bb825=_0x4d0803?await fetch(_0x151bcb[_0xa91285(0x1377)],_0x151bcb[_0xa91285(0x76b)]):await fetch(_0x1da8ee+_0xa91285(0xd7),{'method':_0xa91285(0x1312),'headers':{'Content-Type':_0xa91285(0xa0e),'Authorization':_0xa91285(0x8aa)+_0x357981},'body':JSON['stringify']({'model':_0x25c90d,'messages':_0x13d3e8,'temperature':_0x42f206[_0xa91285(0xf0)]['apiTemperature']||0.9})});if(!_0x2bb825['ok'])throw new Error((await _0x2bb825['json']())['error']['message']);const _0x35930c=await _0x2bb825[_0xa91285(0xaef)](),_0x315946=_0x4d0803?_0x35930c[_0xa91285(0x116f)][0x0][_0xa91285(0x1316)]['parts'][0x0]['text']:_0x35930c[_0xa91285(0x2f9)][0x0][_0xa91285(0x7aa)][_0xa91285(0x1316)],_0x2e05dd=_0x418096(_0x315946);if(!_0x2e05dd||_0x2e05dd['length']===0x0){console['warn'](_0xa91285(0x11d)+_0x5cdb38[_0xa91285(0x132a)]+_0xa91285(0x1229));return;}let _0x207248=Date['now'](),_0x3dce14=![],_0x90f6cc='',_0x1a2bab='';const _0xb7dfaa=[];for(const _0x389e2f of _0x2e05dd){const _0x2d6e22=String(_0x389e2f[_0xa91285(0x1316)]||''),_0x5cf0b1=_0x2d6e22[_0xa91285(0x2aa)]()['startsWith']('<')&&_0x2d6e22[_0xa91285(0x2aa)]()[_0xa91285(0x1082)]('>');if(_0x389e2f[_0xa91285(0x259)]==='text'&&!_0x5cf0b1&&_0x2d6e22[_0xa91285(0xd8d)]('\x0a')){const _0x46a5d8=_0x2d6e22[_0xa91285(0x90b)](/\n+/)['filter'](_0x52754a=>_0x52754a[_0xa91285(0x2aa)]());_0x46a5d8[_0xa91285(0x12c2)](_0x32b1c1=>{const _0xed043a=_0xa91285;_0xb7dfaa[_0xed043a(0x129e)]({..._0x389e2f,'content':_0x32b1c1});});}else _0xb7dfaa[_0xa91285(0x129e)](_0x389e2f);}for(const _0x293d2 of _0xb7dfaa){if(!_0x293d2||!_0x293d2[_0xa91285(0x259)]||!_0x293d2['name'])continue;const _0x411526=_0x32d364(_0x5cdb38,_0x293d2[_0xa91285(0x132a)]);let _0x2a148a=null,_0x568537=null;const _0x2d7e32={'role':_0xa91285(0xac3),'senderName':_0x293d2[_0xa91285(0x132a)],'timestamp':_0x207248++};if(_0x293d2[_0xa91285(0x259)]===_0xa91285(0x866)){const _0x295300=_0x5cdb38['history'][_0xa91285(0xb07)](_0x5bf5c0=>_0x5bf5c0[_0xa91285(0xf16)]===_0x293d2['packet_timestamp']);if(_0x295300&&!_0x295300[_0xa91285(0x1258)]&&!(_0x295300['claimedBy']&&_0x295300[_0xa91285(0xcd4)][_0x293d2['name']])){let _0x292077=0x0;const _0x32071c=_0x295300['totalAmount']-Object[_0xa91285(0x6eb)](_0x295300[_0xa91285(0xcd4)]||{})[_0xa91285(0x1450)]((_0x306a9a,_0x2e8f27)=>_0x306a9a+_0x2e8f27,0x0),_0x1bab19=_0x295300[_0xa91285(0x1e5)]-Object['keys'](_0x295300[_0xa91285(0xcd4)]||{})[_0xa91285(0x131d)];if(_0x1bab19>0x0){if(_0x1bab19===0x1)_0x292077=_0x32071c;else{const _0x1782ca=0.01,_0x1e077d=_0x32071c-(_0x1bab19-0x1)*_0x1782ca;_0x292077=Math[_0xa91285(0x23a)]()*(_0x1e077d-_0x1782ca)+_0x1782ca;}_0x292077=parseFloat(_0x292077[_0xa91285(0x800)](0x2));if(!_0x295300[_0xa91285(0xcd4)])_0x295300[_0xa91285(0xcd4)]={};_0x295300['claimedBy'][_0x293d2[_0xa91285(0x132a)]]=_0x292077,_0x5cdb38[_0xa91285(0x1d5)][_0xa91285(0x129e)]({'role':'system','type':_0xa91285(0x3bf),'content':_0x411526+_0xa91285(0x5d6)+_0x32d364(_0x5cdb38,_0x295300[_0xa91285(0x2a3)])+_0xa91285(0x3b7),'timestamp':Date[_0xa91285(0x606)]()});let _0x18b347=_0xa91285(0x39c)+_0x411526+_0xa91285(0xd76)+_0x292077[_0xa91285(0x800)](0x2)+'\x20元。';if(Object[_0xa91285(0x634)](_0x295300[_0xa91285(0xcd4)])[_0xa91285(0x131d)]>=_0x295300[_0xa91285(0x1e5)]){_0x295300['isFullyClaimed']=!![],_0x5cdb38[_0xa91285(0x1d5)][_0xa91285(0x129e)]({'role':_0xa91285(0x1370),'type':'pat_message','content':_0x32d364(_0x5cdb38,_0x295300[_0xa91285(0x2a3)])+'\x20的红包已被领完','timestamp':Date[_0xa91285(0x606)]()+0x1});let _0x20c02f={'name':'','amount':-0x1};Object[_0xa91285(0x1309)](_0x295300[_0xa91285(0xcd4)])['forEach'](([_0x454819,_0x18e1f2])=>{const _0x2837dc=_0xa91285;_0x18e1f2>_0x20c02f[_0x2837dc(0x116)]&&(_0x20c02f={'name':_0x454819,'amount':_0x18e1f2});});if(_0x20c02f[_0xa91285(0x132a)]){const _0x52b368=_0x32d364(_0x5cdb38,_0x20c02f['name']);_0x18b347+=_0xa91285(0xcaf)+_0x52b368+'！';}}_0x18b347+=_0xa91285(0x6b9),_0x5cdb38[_0xa91285(0x1d5)][_0xa91285(0x129e)]({'role':_0xa91285(0x1370),'content':_0x18b347,'timestamp':Date[_0xa91285(0x606)]()+0x2,'isHidden':!![]});}}_0x3dce14=!![];continue;}switch(_0x293d2['type']){case _0xa91285(0x869):if(_0x293d2[_0xa91285(0x32e)]){const _0xfaf315=_0x42f206[_0xa91285(0x1294)]['find'](_0x52702f=>_0x52702f[_0xa91285(0x132a)]===_0x293d2['meaning']);_0xfaf315?_0x568537={..._0x2d7e32,'type':_0xa91285(0x869),'content':_0xfaf315[_0xa91285(0x1377)],'meaning':_0xfaf315[_0xa91285(0x132a)]}:(console[_0xa91285(0x1b6)](_0xa91285(0x90e)+_0x293d2[_0xa91285(0x32e)]+'\x22'),_0x568537={..._0x2d7e32,'type':_0xa91285(0xdd5),'content':_0xa91285(0x21f)+_0x293d2[_0xa91285(0x32e)]+']'});}else console[_0xa91285(0x1b6)](_0xa91285(0x644),_0x293d2),_0x568537={..._0x2d7e32,'type':_0xa91285(0x869),'content':_0x293d2[_0xa91285(0x1377)],'meaning':_0xa91285(0x11a2)};break;case'qzone_post':const _0x2b8d65={'type':_0x293d2[_0xa91285(0xbc2)]||_0xa91285(0xb03),'content':_0x293d2[_0xa91285(0x1316)],'timestamp':Date[_0xa91285(0x606)](),'authorId':_0x42f206['chats'][Object[_0xa91285(0x634)](_0x42f206['chats'])[_0xa91285(0xb07)](_0x422db5=>_0x42f206['chats'][_0x422db5][_0xa91285(0xa1)]===_0x293d2[_0xa91285(0x132a)])]?.['id']||_0x293d2[_0xa91285(0x132a)],'authorOriginalName':_0x293d2['name'],'visibleGroupIds':null};await _0x17d534['qzonePosts'][_0xa91285(0xa58)](_0x2b8d65),_0x276281(_0x116b59+0x1),_0x2a148a={'content':'['+_0x411526+_0xa91285(0x2fa)};break;case _0xa91285(0x1032):const _0x3ca6b3=await _0x17d534['qzonePosts'][_0xa91285(0x36d)](parseInt(_0x293d2['postId']));if(_0x3ca6b3){if(!_0x3ca6b3[_0xa91285(0x946)])_0x3ca6b3['comments']=[];_0x3ca6b3['comments'][_0xa91285(0x129e)]({'commenterName':_0x293d2[_0xa91285(0x132a)],'text':_0x293d2[_0xa91285(0x8f4)],'timestamp':Date[_0xa91285(0x606)]()}),await _0x17d534[_0xa91285(0x15b)][_0xa91285(0x938)](_0x3ca6b3['id'],{'comments':_0x3ca6b3[_0xa91285(0x946)]}),_0x276281(_0x116b59+0x1),_0x2a148a={'content':'['+_0x411526+'\x20评论了动态]'};}break;case _0xa91285(0xc72):const _0x7ff27=await _0x17d534[_0xa91285(0x15b)][_0xa91285(0x36d)](parseInt(_0x293d2[_0xa91285(0x13bc)]));if(_0x7ff27){if(!_0x7ff27[_0xa91285(0x1be)])_0x7ff27[_0xa91285(0x1be)]=[];!_0x7ff27['likes'][_0xa91285(0xd8d)](_0x293d2['name'])&&(_0x7ff27[_0xa91285(0x1be)]['push'](_0x293d2[_0xa91285(0x132a)]),await _0x17d534[_0xa91285(0x15b)][_0xa91285(0x938)](_0x7ff27['id'],{'likes':_0x7ff27[_0xa91285(0x1be)]}),_0x276281(_0x116b59+0x1),_0x2a148a={'content':'['+_0x411526+_0xa91285(0x911)});}break;case _0xa91285(0xb1e):_0x568537={..._0x2d7e32,'type':_0xa91285(0xb1e),'content':_0x293d2[_0xa91285(0x4e9)],'image_prompt':msgData[_0xa91285(0xef)]};break;default:if(_0x293d2[_0xa91285(0x259)]==='poll'){const _0xd31ba3=typeof _0x293d2[_0xa91285(0x8e9)]===_0xa91285(0x861)?_0x293d2[_0xa91285(0x8e9)][_0xa91285(0x90b)]('\x0a')[_0xa91285(0xaf1)](_0x1bbb03=>_0x1bbb03[_0xa91285(0x2aa)]()):Array[_0xa91285(0x971)](_0x293d2['options'])?_0x293d2[_0xa91285(0x8e9)]:[];if(_0xd31ba3[_0xa91285(0x131d)]<0x2)continue;_0x568537={..._0x2d7e32,..._0x293d2,'options':_0xd31ba3,'votes':{},'isClosed':![]};}else{const _0x463c59=_0x293d2[_0xa91285(0x1316)]||_0x293d2[_0xa91285(0x7aa)];_0x568537={..._0x2d7e32,..._0x293d2};if(_0x463c59)_0x568537[_0xa91285(0x1316)]=_0x463c59;}break;}if(_0x2a148a)_0x5cdb38[_0xa91285(0x1d5)]['push']({'role':_0xa91285(0x1370),'type':_0xa91285(0x3bf),'content':_0x2a148a[_0xa91285(0x1316)],'timestamp':_0x207248++});else _0x568537&&(_0x5cdb38['history'][_0xa91285(0x129e)](_0x568537),!_0x1a2bab&&(_0x1a2bab=_0x411526,_0x90f6cc=_0x568537[_0xa91285(0x259)]===_0xa91285(0xb1e)?_0xa91285(0xf72):_0x568537[_0xa91285(0x1316)]||'['+_0x568537[_0xa91285(0x259)]+']'));_0x3dce14=!![];}_0x3dce14&&(_0x5cdb38['lastActionTimestamp']=Date[_0xa91285(0x606)](),_0x5cdb38[_0xa91285(0x12c9)]=(_0x5cdb38[_0xa91285(0x12c9)]||0x0)+_0x2e05dd[_0xa91285(0xaf1)](_0x4b6da4=>_0x4b6da4[_0xa91285(0x259)]!==_0xa91285(0xe47)&&_0x4b6da4['type']!==_0xa91285(0x1032)&&_0x4b6da4['type']!==_0xa91285(0xc72))[_0xa91285(0x131d)],_0x1a2bab&&_0x90f6cc&&_0x478393(_0x17d4e1,_0x1a2bab+':\x20'+_0x90f6cc),await _0x17d534[_0xa91285(0x954)][_0xa91285(0xf3f)](_0x5cdb38));}catch(_0xa9222b){console['error'](_0xa91285(0x11d)+_0x5cdb38[_0xa91285(0x132a)]+'\x22\x20的独立行动失败:',_0xa9222b);}finally{_0x27be5e();}}function _0x1ff070(_0x1553d7,_0x2724bc,_0x17a09c){const _0x2032f2=_0x204348,_0x952314=document['getElementById'](_0x17a09c);if(!_0x952314)return;if(!_0x1553d7||_0x1553d7[_0x2032f2(0x2aa)]()===''){_0x952314['innerHTML']='';return;}const _0x49a45c=_0x1553d7['replace'](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x2724bc+_0x2032f2(0x76e))[_0x2032f2(0x33b)](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x2724bc+'\x20.message-bubble.ai\x20$1')['replace'](/\s*\.message-bubble\s+([^{]+\{)/g,_0x2724bc+_0x2032f2(0xb17));_0x952314[_0x2032f2(0x110d)]=_0x49a45c;}async function _0x83553f(){const _0x580e39=_0x204348;if(!_0x42f206[_0x580e39(0x81d)])return;const _0x31c2de=_0x42f206['chats'][_0x42f206[_0x580e39(0x81d)]],_0x1fe1d3=document['getElementById'](_0x580e39(0x445));if(!_0x1fe1d3)return;const _0x5ea9e8=document[_0x580e39(0x586)](_0x580e39(0x33d))?.[_0x580e39(0x8dd)]||'default',_0x254116=document[_0x580e39(0x458)](_0x580e39(0x3da))['value'],_0x4ba8fe=document['getElementById'](_0x580e39(0x11bf))[_0x580e39(0x8dd)],_0x263e08=_0x31c2de[_0x580e39(0xda2)][_0x580e39(0x13ed)];_0x1fe1d3['dataset'][_0x580e39(0xbdc)]=_0x5ea9e8,_0x1fe1d3['style']['setProperty'](_0x580e39(0x3c0),_0x254116+'px');_0x263e08&&_0x263e08[_0x580e39(0x13ad)](_0x580e39(0x421))?(_0x1fe1d3[_0x580e39(0x1104)][_0x580e39(0xf7)]='url('+_0x263e08+')',_0x1fe1d3[_0x580e39(0x1104)][_0x580e39(0x11d7)]=_0x580e39(0x11b5)):(_0x1fe1d3['style'][_0x580e39(0xf7)]=_0x580e39(0x464),_0x1fe1d3[_0x580e39(0x1104)][_0x580e39(0x13ed)]=_0x263e08||_0x580e39(0xe14));_0x1fe1d3[_0x580e39(0x110d)]='';const _0x36f27f={'role':'ai','content':'对方消息预览','timestamp':0x1,'senderName':_0x31c2de['name']},_0x5e5020=await _0x4b8ea5(_0x36f27f,_0x31c2de);if(_0x5e5020)_0x1fe1d3['appendChild'](_0x5e5020);const _0x2b10b1={'role':'user','content':_0x580e39(0x45b),'timestamp':0x2},_0x2c6fc1=await _0x4b8ea5(_0x2b10b1,_0x31c2de);if(_0x2c6fc1)_0x1fe1d3[_0x580e39(0x1079)](_0x2c6fc1);const _0x25d57c=document[_0x580e39(0xe7d)](_0x580e39(0x1323));_0x25d57c[_0x580e39(0x1104)][_0x580e39(0x11f)]=_0x580e39(0x901),_0x25d57c[_0x580e39(0x1a2)]=_0x580e39(0xaaa),_0x1fe1d3[_0x580e39(0x1079)](_0x25d57c);const _0x538ca1=document[_0x580e39(0x458)](_0x580e39(0x1054))[_0x580e39(0x8dd)],_0x4bebbc=document[_0x580e39(0x458)](_0x580e39(0x127c))[_0x580e39(0x8dd)],_0x4f88a2=parseInt(document[_0x580e39(0x458)]('lyrics-offset-input')['value'])||0xa;_0x538ca1===_0x580e39(0x76f)?_0x25d57c[_0x580e39(0x1104)]['top']=_0x4f88a2+'px':_0x25d57c[_0x580e39(0x1104)][_0x580e39(0x151)]=_0x4f88a2+'px';switch(_0x4bebbc){case _0x580e39(0x125):_0x25d57c[_0x580e39(0x1104)][_0x580e39(0x125)]='15px';break;case _0x580e39(0xa40):_0x25d57c['style'][_0x580e39(0xa40)]=_0x580e39(0xda4);break;default:_0x25d57c['style'][_0x580e39(0x125)]=_0x580e39(0x13d2),_0x25d57c[_0x580e39(0x1104)][_0x580e39(0xb7e)]=_0x580e39(0x360);break;}_0x1ff070(_0x4ba8fe,'#settings-preview-area',_0x580e39(0x111e));}async function _0x397b28(){const _0x379376=_0x204348;await _0x1474cf(),document[_0x379376(0x458)](_0x379376(0xacc))[_0x379376(0x11c2)]['add'](_0x379376(0x67d));}async function _0x1474cf(){const _0x750f1b=_0x204348,_0x444f43=document[_0x750f1b(0x458)](_0x750f1b(0x216)),_0x3e644b=await _0x17d534[_0x750f1b(0x10a5)][_0x750f1b(0x511)]();_0x444f43[_0x750f1b(0x110d)]='',_0x3e644b[_0x750f1b(0x131d)]===0x0&&(_0x444f43['innerHTML']=_0x750f1b(0xb46)),_0x3e644b[_0x750f1b(0x12c2)](_0x10ae74=>{const _0x34e1f1=_0x750f1b,_0x44c566=document[_0x34e1f1(0xe7d)]('div');_0x44c566[_0x34e1f1(0x69b)]=_0x34e1f1(0x1078),_0x44c566[_0x34e1f1(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x10ae74[_0x34e1f1(0x132a)]+_0x34e1f1(0x110f)+_0x10ae74['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x444f43[_0x34e1f1(0x1079)](_0x44c566);});}async function _0x3c9d04(){const _0x3e6794=_0x204348,_0x2935f8=document[_0x3e6794(0x458)]('new-group-name-input'),_0x1b4a19=_0x2935f8[_0x3e6794(0x8dd)][_0x3e6794(0x2aa)]();if(!_0x1b4a19){alert(_0x3e6794(0x37b));return;}const _0x267c84=await _0x17d534[_0x3e6794(0x10a5)][_0x3e6794(0x13c6)](_0x3e6794(0x132a))['equals'](_0x1b4a19)[_0x3e6794(0xb9)]();if(_0x267c84){alert(_0x3e6794(0x641)+_0x1b4a19+_0x3e6794(0x61a));return;}await _0x17d534[_0x3e6794(0x10a5)][_0x3e6794(0xa58)]({'name':_0x1b4a19}),_0x2935f8[_0x3e6794(0x8dd)]='',await _0x1474cf();}async function _0x5b6c87(_0x5f0d99){const _0x1a2972=_0x204348,_0x12b4ab=await _0x2532b9(_0x1a2972(0x1ef),_0x1a2972(0x11ed),{'confirmButtonClass':_0x1a2972(0x4d3)});if(_0x12b4ab){await _0x17d534[_0x1a2972(0x10a5)][_0x1a2972(0x195)](_0x5f0d99);const _0x1904e4=await _0x17d534[_0x1a2972(0x954)]['where'](_0x1a2972(0x1437))[_0x1a2972(0x7db)](_0x5f0d99)[_0x1a2972(0x511)]();for(const _0x26dfe2 of _0x1904e4){_0x26dfe2[_0x1a2972(0x1437)]=null,await _0x17d534[_0x1a2972(0x954)]['put'](_0x26dfe2);if(_0x42f206[_0x1a2972(0x954)][_0x26dfe2['id']])_0x42f206[_0x1a2972(0x954)][_0x26dfe2['id']][_0x1a2972(0x1437)]=null;}await _0x1474cf();}}function _0x233ca6(_0x1fdb35){const _0x3ca2b4=_0x204348,_0x1fc58b=_0x42f206[_0x3ca2b4(0x954)][_0x42f206[_0x3ca2b4(0x81d)]];document[_0x3ca2b4(0x458)]('publish-to-announcement-btn')['style']['display']=_0x1fc58b[_0x3ca2b4(0x726)]?'block':'none';if(_0x2b45d0)return;_0x362918=_0x1fdb35,document[_0x3ca2b4(0x458)]('message-actions-modal')['classList']['add'](_0x3ca2b4(0x67d));}function _0x2419bd(){const _0x58b75e=_0x204348;document[_0x58b75e(0x458)](_0x58b75e(0x102b))[_0x58b75e(0x11c2)][_0x58b75e(0x1097)](_0x58b75e(0x67d)),_0x362918=null;}async function _0x92cc31(){const _0x292a2d=_0x204348;if(!_0x362918)return;const _0x459e29=_0x362918,_0x41531b=_0x42f206[_0x292a2d(0x954)][_0x42f206[_0x292a2d(0x81d)]],_0x46ebb0=_0x41531b['history']['find'](_0x2c2245=>_0x2c2245[_0x292a2d(0xf16)]===_0x459e29);if(!_0x46ebb0)return;_0x2419bd();let _0x3587ea;const _0x5dbb16=_0x46ebb0[_0x292a2d(0x259)]&&[_0x292a2d(0xefa),_0x292a2d(0xb1e),_0x292a2d(0xf4e),_0x292a2d(0xbd0)][_0x292a2d(0xd8d)](_0x46ebb0['type']);if(_0x5dbb16){let _0x2efbef={'type':_0x46ebb0[_0x292a2d(0x259)]};if(_0x46ebb0['type']===_0x292a2d(0xefa))_0x2efbef[_0x292a2d(0x1316)]=_0x46ebb0[_0x292a2d(0x1316)];else{if(_0x46ebb0[_0x292a2d(0x259)]===_0x292a2d(0xb1e))_0x2efbef[_0x292a2d(0x4e9)]=_0x46ebb0['content'];else{if(_0x46ebb0[_0x292a2d(0x259)]===_0x292a2d(0xf4e))_0x2efbef[_0x292a2d(0x116)]=_0x46ebb0['amount'],_0x2efbef[_0x292a2d(0x1187)]=_0x46ebb0[_0x292a2d(0x1187)];else _0x46ebb0[_0x292a2d(0x259)]===_0x292a2d(0xbd0)&&(_0x2efbef[_0x292a2d(0x316)]=_0x46ebb0[_0x292a2d(0x316)],_0x2efbef[_0x292a2d(0x4e9)]=_0x46ebb0[_0x292a2d(0x4e9)],_0x2efbef[_0x292a2d(0x885)]=_0x46ebb0[_0x292a2d(0x885)],_0x2efbef[_0x292a2d(0x1316)]=_0x46ebb0[_0x292a2d(0x1316)]);}}_0x3587ea=JSON[_0x292a2d(0xc04)](_0x2efbef,null,0x2);}else typeof _0x46ebb0[_0x292a2d(0x1316)]===_0x292a2d(0x620)?_0x3587ea=JSON[_0x292a2d(0xc04)](_0x46ebb0['content'],null,0x2):_0x3587ea=_0x46ebb0[_0x292a2d(0x1316)];const _0x16df53={'voice':{'type':_0x292a2d(0xefa),'content':_0x292a2d(0x12ea)},'image':{'type':'ai_image','description':_0x292a2d(0x879)},'transfer':{'type':_0x292a2d(0xf4e),'amount':5.2,'note':_0x292a2d(0xbbc)},'link':{'type':_0x292a2d(0xbd0),'title':_0x292a2d(0xbe),'description':_0x292a2d(0x89b),'source_name':'来源网站','content':_0x292a2d(0xce1)}},_0x29a645=_0x292a2d(0xd41)+JSON[_0x292a2d(0xc04)](_0x16df53[_0x292a2d(0x12f1)])+_0x292a2d(0x55f)+JSON[_0x292a2d(0xc04)](_0x16df53[_0x292a2d(0xefe)])+_0x292a2d(0xa06)+JSON[_0x292a2d(0xc04)](_0x16df53[_0x292a2d(0xf4e)])+'\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x16df53[_0x292a2d(0xddd)])+_0x292a2d(0x665),_0x4553c8=await _0x335e57(_0x292a2d(0x13be),_0x292a2d(0x113b),_0x3587ea,_0x292a2d(0xb43),_0x29a645);_0x4553c8!==null&&await _0x4a66df(_0x459e29,_0x4553c8,!![]);}async function _0x514169(){const _0x58af2b=_0x204348;if(!_0x362918)return;const _0x4ba0e8=_0x42f206[_0x58af2b(0x954)][_0x42f206[_0x58af2b(0x81d)]],_0x6f1159=_0x4ba0e8[_0x58af2b(0x1d5)][_0x58af2b(0xb07)](_0x3dfea9=>_0x3dfea9[_0x58af2b(0xf16)]===_0x362918);if(!_0x6f1159)return;let _0x238be9;typeof _0x6f1159['content']===_0x58af2b(0x620)?_0x238be9=JSON[_0x58af2b(0xc04)](_0x6f1159['content']):_0x238be9=String(_0x6f1159['content']);try{await navigator[_0x58af2b(0x13d0)][_0x58af2b(0x6d0)](_0x238be9),await _0x34fce8(_0x58af2b(0x48c),'消息内容已复制到剪贴板。');}catch(_0x587b31){await _0x34fce8('复制失败',_0x58af2b(0x13f8));}_0x2419bd();}async function _0x2192f7(){const _0x339649=_0x204348;if(!_0x362918)return;try{await navigator[_0x339649(0x13d0)][_0x339649(0x6d0)](_0x362918),await _0x34fce8(_0x339649(0x48c),'消息时间戳\x20'+_0x362918+_0x339649(0x5f5));}catch(_0x1618a9){await _0x34fce8(_0x339649(0xc2e),_0x339649(0x13f8));}_0x2419bd();}function _0x17f6e7(_0x11565a=''){const _0x17cf9d=_0x204348,_0x98fef8=document[_0x17cf9d(0xe7d)](_0x17cf9d(0x1323));_0x98fef8[_0x17cf9d(0x69b)]=_0x17cf9d(0x351);const _0x59137c={'voice':{'type':_0x17cf9d(0xefa),'content':_0x17cf9d(0x12ea)},'image':{'type':_0x17cf9d(0xb1e),'description':_0x17cf9d(0x879)},'transfer':{'type':_0x17cf9d(0xf4e),'amount':5.2,'note':_0x17cf9d(0xbbc)},'link':{'type':_0x17cf9d(0xbd0),'title':'文章标题','description':_0x17cf9d(0x89b),'source_name':_0x17cf9d(0x122),'content':_0x17cf9d(0xce1)},'offline':{'type':'offline_text','content':_0x17cf9d(0x11a9)},'quote':{'type':_0x17cf9d(0xf44),'target_timestamp':0x499602d2,'reply_content':_0x17cf9d(0xb5c)}};return _0x98fef8[_0x17cf9d(0x110d)]=_0x17cf9d(0x81a)+_0x11565a+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x17cf9d(0xc04)](_0x59137c['voice'])+'\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x59137c[_0x17cf9d(0xefe)])+_0x17cf9d(0x2ee)+JSON[_0x17cf9d(0xc04)](_0x59137c[_0x17cf9d(0xf4e)])+_0x17cf9d(0xe3c)+JSON['stringify'](_0x59137c[_0x17cf9d(0xddd)])+'\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x17cf9d(0xc04)](_0x59137c[_0x17cf9d(0xd39)])+_0x17cf9d(0x942)+JSON[_0x17cf9d(0xc04)](_0x59137c[_0x17cf9d(0xb92)])+_0x17cf9d(0xa23),_0x98fef8[_0x17cf9d(0x586)](_0x17cf9d(0xf3c))[_0x17cf9d(0xd85)]('click',()=>{const _0x1f16b6=_0x17cf9d;document['querySelectorAll'](_0x1f16b6(0x1425))[_0x1f16b6(0x131d)]>0x1?_0x98fef8[_0x1f16b6(0x1097)]():alert(_0x1f16b6(0xe01));}),_0x98fef8['querySelectorAll'](_0x17cf9d(0xb74))['forEach'](_0x18558c=>{const _0x4cf611=_0x17cf9d;_0x18558c['addEventListener'](_0x4cf611(0x1122),()=>{const _0x1bbbb8=_0x4cf611,_0x1a843a=_0x18558c[_0x1bbbb8(0x1f4)][_0x1bbbb8(0xc03)],_0x4e1494=_0x98fef8[_0x1bbbb8(0x586)]('textarea');if(_0x1a843a&&_0x4e1494)try{const _0x2fe324=JSON[_0x1bbbb8(0x44c)](_0x1a843a);_0x4e1494[_0x1bbbb8(0x8dd)]=JSON['stringify'](_0x2fe324,null,0x2),_0x4e1494[_0x1bbbb8(0x1248)]();}catch(_0x4f1375){console[_0x1bbbb8(0xb61)](_0x1bbbb8(0x735),_0x4f1375);}});}),_0x98fef8;}function _0x4d7e3a(){const _0x2d5694=_0x204348;if(!_0x362918)return;const _0xb95fd=_0x362918,_0x7c71b8=_0x42f206[_0x2d5694(0x954)][_0x42f206[_0x2d5694(0x81d)]],_0x529c13=_0x7c71b8[_0x2d5694(0x1d5)][_0x2d5694(0xb07)](_0x1fce98=>_0x1fce98[_0x2d5694(0xf16)]===_0xb95fd);if(!_0x529c13)return;_0x2419bd();const _0x49fddf=document[_0x2d5694(0x458)](_0x2d5694(0x3b9)),_0x30d020=document['getElementById'](_0x2d5694(0xb76));_0x30d020[_0x2d5694(0x110d)]='';let _0x50c6a6;if(_0x529c13['quote']){const _0x14c756={'type':'quote_reply','target_timestamp':_0x529c13[_0x2d5694(0xb92)][_0x2d5694(0xf16)],'reply_content':_0x529c13[_0x2d5694(0x1316)]};_0x50c6a6=JSON[_0x2d5694(0xc04)](_0x14c756,null,0x2);}else{if(_0x529c13['type']&&[_0x2d5694(0xefa),'ai_image',_0x2d5694(0xf4e),_0x2d5694(0x22b),'share_link'][_0x2d5694(0xd8d)](_0x529c13[_0x2d5694(0x259)])){let _0x14dbe7={'type':_0x529c13[_0x2d5694(0x259)]};if(_0x529c13['type']===_0x2d5694(0xefa))_0x14dbe7['content']=_0x529c13[_0x2d5694(0x1316)];else{if(_0x529c13['type']===_0x2d5694(0xb1e))_0x14dbe7[_0x2d5694(0x4e9)]=_0x529c13[_0x2d5694(0x1316)];else{if(_0x529c13[_0x2d5694(0x259)]==='transfer')_0x14dbe7[_0x2d5694(0x116)]=_0x529c13[_0x2d5694(0x116)],_0x14dbe7[_0x2d5694(0x1187)]=_0x529c13[_0x2d5694(0x1187)];else{if(_0x529c13[_0x2d5694(0x259)]==='offline_text')_0x529c13['content']?_0x14dbe7[_0x2d5694(0x1316)]=_0x529c13[_0x2d5694(0x1316)]:(_0x14dbe7[_0x2d5694(0x4d9)]=_0x529c13[_0x2d5694(0x4d9)],_0x14dbe7[_0x2d5694(0x4e9)]=_0x529c13[_0x2d5694(0x4e9)]);else _0x529c13['type']===_0x2d5694(0xbd0)&&(_0x14dbe7[_0x2d5694(0x316)]=_0x529c13[_0x2d5694(0x316)],_0x14dbe7['description']=_0x529c13[_0x2d5694(0x4e9)],_0x14dbe7['source_name']=_0x529c13[_0x2d5694(0x885)],_0x14dbe7[_0x2d5694(0x1316)]=_0x529c13[_0x2d5694(0x1316)]);}}}_0x50c6a6=JSON['stringify'](_0x14dbe7,null,0x2);}else typeof _0x529c13[_0x2d5694(0x1316)]===_0x2d5694(0x620)?_0x50c6a6=JSON['stringify'](_0x529c13[_0x2d5694(0x1316)],null,0x2):_0x50c6a6=_0x529c13[_0x2d5694(0x1316)];}const _0x4ea084=_0x17f6e7(_0x50c6a6);_0x30d020[_0x2d5694(0x1079)](_0x4ea084);const _0x5421c3=document[_0x2d5694(0x458)]('add-message-editor-block-btn'),_0x289567=_0x5421c3[_0x2d5694(0x350)](!![]);_0x5421c3[_0x2d5694(0x135e)][_0x2d5694(0x3f2)](_0x289567,_0x5421c3),_0x289567[_0x2d5694(0xd85)](_0x2d5694(0x1122),()=>{const _0x5236be=_0x2d5694,_0x812fb2=_0x17f6e7();_0x30d020[_0x5236be(0x1079)](_0x812fb2),_0x812fb2[_0x5236be(0x586)](_0x5236be(0xb43))['focus']();});const _0x400034=document[_0x2d5694(0x458)](_0x2d5694(0xc52)),_0x32227c=_0x400034[_0x2d5694(0x350)](!![]);_0x400034[_0x2d5694(0x135e)][_0x2d5694(0x3f2)](_0x32227c,_0x400034),_0x32227c[_0x2d5694(0xd85)](_0x2d5694(0x1122),()=>{const _0x44548b=_0x2d5694;_0x49fddf['classList'][_0x44548b(0x1097)](_0x44548b(0x67d));});const _0x3d1570=document[_0x2d5694(0x458)](_0x2d5694(0x793)),_0xb52a5=_0x3d1570[_0x2d5694(0x350)](!![]);_0x3d1570['parentNode'][_0x2d5694(0x3f2)](_0xb52a5,_0x3d1570),_0xb52a5[_0x2d5694(0xd85)](_0x2d5694(0x1122),()=>{_0x4a66df(_0xb95fd);}),_0x49fddf[_0x2d5694(0x11c2)]['add']('visible');}async function _0x514169(){const _0x42bbca=_0x204348;if(!_0x362918)return;const _0x3e1652=_0x42f206[_0x42bbca(0x954)][_0x42f206['activeChatId']],_0x5a4858=_0x3e1652[_0x42bbca(0x1d5)][_0x42bbca(0xb07)](_0x27eefb=>_0x27eefb[_0x42bbca(0xf16)]===_0x362918);if(!_0x5a4858)return;let _0x24ab76;if(_0x5a4858[_0x42bbca(0x259)]==='offline_text')_0x5a4858[_0x42bbca(0x1316)]?_0x24ab76=_0x5a4858['content']:_0x24ab76='「'+(_0x5a4858[_0x42bbca(0x4d9)]||'')+'」\x0a'+(_0x5a4858['description']||'');else typeof _0x5a4858[_0x42bbca(0x1316)]===_0x42bbca(0x620)?_0x24ab76=JSON[_0x42bbca(0xc04)](_0x5a4858[_0x42bbca(0x1316)]):_0x24ab76=String(_0x5a4858[_0x42bbca(0x1316)]);try{await navigator[_0x42bbca(0x13d0)][_0x42bbca(0x6d0)](_0x24ab76),await _0x34fce8(_0x42bbca(0x48c),_0x42bbca(0xdc8));}catch(_0x218431){await _0x34fce8(_0x42bbca(0xc2e),_0x42bbca(0x13f8));}_0x2419bd();}function _0x26d97c(_0x567c36){const _0x1e7889=_0x204348,_0x7c598b=_0x567c36[_0x1e7889(0x2aa)]();if(_0x7c598b[_0x1e7889(0x13ad)]('{')&&_0x7c598b[_0x1e7889(0x1082)]('}'))try{const _0x5e5a18=JSON[_0x1e7889(0x44c)](_0x7c598b);if(_0x5e5a18[_0x1e7889(0x259)])return _0x5e5a18;}catch(_0x37ee24){}if(_0x30c9b4[_0x1e7889(0x9c0)](_0x7c598b))return{'type':_0x1e7889(0x869),'content':_0x7c598b};return{'type':_0x1e7889(0xdd5),'content':_0x7c598b};}async function _0x4a66df(_0x1eebd6,_0x152cd5=null){const _0x2cb907=_0x204348;if(!_0x1eebd6)return;const _0x2871b3=_0x42f206[_0x2cb907(0x954)][_0x42f206[_0x2cb907(0x81d)]],_0x5576f5=_0x2871b3[_0x2cb907(0x1d5)][_0x2cb907(0x4a8)](_0x49f930=>_0x49f930['timestamp']===_0x1eebd6);if(_0x5576f5===-0x1)return;const _0x107a0b=_0x2871b3[_0x2cb907(0x1d5)][_0x5576f5];let _0x53aa93=[];const _0x2d6258=_0x152cd5!==null?[_0x152cd5]:Array[_0x2cb907(0xca2)](document[_0x2cb907(0x102a)]('#message-editor-container\x20textarea'))[_0x2cb907(0xbf6)](_0x46dbfa=>_0x46dbfa['value']);for(const _0x57784b of _0x2d6258){if(!_0x57784b[_0x2cb907(0x2aa)]())continue;const _0x4fdb62=_0x26d97c(_0x57784b[_0x2cb907(0x2aa)]()),_0x36d660={'role':_0x107a0b[_0x2cb907(0xaeb)],'senderName':_0x107a0b[_0x2cb907(0x2a3)],'timestamp':_0x107a0b[_0x2cb907(0xf16)]};switch(_0x4fdb62['type']){case _0x2cb907(0xdd5):_0x36d660[_0x2cb907(0x259)]=_0x2cb907(0xdd5),_0x36d660[_0x2cb907(0x1316)]=_0x4fdb62[_0x2cb907(0x1316)];break;case _0x2cb907(0x22b):_0x36d660[_0x2cb907(0x259)]='offline_text';_0x4fdb62[_0x2cb907(0x1316)]?_0x36d660[_0x2cb907(0x1316)]=_0x4fdb62[_0x2cb907(0x1316)]:(_0x36d660[_0x2cb907(0x4d9)]=_0x4fdb62[_0x2cb907(0x4d9)],_0x36d660[_0x2cb907(0x4e9)]=_0x4fdb62[_0x2cb907(0x4e9)]);break;case'quote_reply':_0x36d660['type']=_0x2cb907(0xf44),_0x36d660[_0x2cb907(0x1316)]=_0x4fdb62[_0x2cb907(0xbca)];const _0x3c52ae=_0x2871b3[_0x2cb907(0x1d5)][_0x2cb907(0xb07)](_0x317d58=>_0x317d58[_0x2cb907(0xf16)]===_0x4fdb62[_0x2cb907(0xa7b)]);if(_0x3c52ae){let _0x2b034b=_0x3c52ae[_0x2cb907(0x2a3)];_0x3c52ae[_0x2cb907(0xaeb)]===_0x2cb907(0xf86)&&(_0x2b034b=_0x42f206['qzoneSettings']['nickname']||_0x2cb907(0x852)),_0x36d660[_0x2cb907(0xb92)]={'timestamp':_0x4fdb62['target_timestamp'],'senderName':_0x2b034b,'content':String(_0x3c52ae[_0x2cb907(0x1316)]||'')};}else _0x36d660['quote']={'timestamp':_0x4fdb62[_0x2cb907(0xa7b)],'senderName':_0x2cb907(0x1408),'content':_0x2cb907(0xeb1)};break;case _0x2cb907(0xefa):case _0x2cb907(0xb1e):case'user_photo':_0x36d660[_0x2cb907(0x259)]=_0x4fdb62[_0x2cb907(0x259)],_0x36d660[_0x2cb907(0x1316)]=_0x4fdb62[_0x2cb907(0x1316)]||_0x4fdb62['description'];if(_0x4fdb62[_0x2cb907(0x32e)])_0x36d660[_0x2cb907(0x32e)]=_0x4fdb62[_0x2cb907(0x32e)];break;case _0x2cb907(0x869):{_0x36d660[_0x2cb907(0x259)]=_0x2cb907(0x869);let _0x1ea31a=![];if(_0x4fdb62[_0x2cb907(0x32e)]){const _0x3f6407=_0x42f206[_0x2cb907(0x1294)]['find'](_0x598ac9=>_0x598ac9['name']===_0x4fdb62[_0x2cb907(0x32e)]);_0x3f6407?(_0x36d660[_0x2cb907(0x1316)]=_0x3f6407[_0x2cb907(0x1377)],_0x36d660[_0x2cb907(0x32e)]=_0x3f6407[_0x2cb907(0x132a)],console['log'](_0x2cb907(0x412)),_0x1ea31a=!![]):(_0x36d660['type']=_0x2cb907(0xdd5),_0x36d660[_0x2cb907(0x1316)]=_0x2cb907(0x21f)+_0x4fdb62[_0x2cb907(0x32e)]+']',console[_0x2cb907(0x1b6)]('导演/编辑模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:',_0x4fdb62[_0x2cb907(0x32e)]),_0x1ea31a=!![]);}if(!_0x1ea31a&&_0x4fdb62[_0x2cb907(0x1377)]){_0x36d660[_0x2cb907(0x1316)]=_0x4fdb62[_0x2cb907(0x1377)];const _0x4ca6b4=_0x42f206['userStickers']['find'](_0x234175=>_0x234175[_0x2cb907(0x1377)]===_0x4fdb62[_0x2cb907(0x1377)]);if(_0x4fdb62[_0x2cb907(0x32e)]&&(!_0x4ca6b4||_0x4ca6b4[_0x2cb907(0x132a)]===_0x4fdb62['meaning']))_0x36d660[_0x2cb907(0x32e)]=_0x4fdb62['meaning'];else _0x4ca6b4?_0x36d660['meaning']=_0x4ca6b4[_0x2cb907(0x132a)]:_0x36d660['meaning']='未知表情';console[_0x2cb907(0x7d1)]('导演/编辑模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:',_0x36d660[_0x2cb907(0x32e)]),_0x1ea31a=!![];}if(!_0x1ea31a&&_0x4fdb62[_0x2cb907(0x1316)]&&typeof _0x4fdb62['content']==='string'&&_0x30c9b4[_0x2cb907(0x9c0)](_0x4fdb62['content'])){_0x36d660[_0x2cb907(0x1316)]=_0x4fdb62[_0x2cb907(0x1316)];const _0xc900ca=_0x42f206[_0x2cb907(0x1294)][_0x2cb907(0xb07)](_0x24ccda=>_0x24ccda[_0x2cb907(0x1377)]===_0x4fdb62['content']);_0x36d660['meaning']=_0xc900ca?_0xc900ca['name']:_0x2cb907(0x11a2),console[_0x2cb907(0x7d1)](_0x2cb907(0xf4b),_0x36d660[_0x2cb907(0x32e)]),_0x1ea31a=!![];}if(!_0x1ea31a){console[_0x2cb907(0xb61)](_0x2cb907(0x625),_0x4fdb62);continue;}break;}case _0x2cb907(0xf4e):_0x36d660[_0x2cb907(0x259)]=_0x2cb907(0xf4e),_0x36d660[_0x2cb907(0x116)]=_0x4fdb62[_0x2cb907(0x116)],_0x36d660[_0x2cb907(0x1187)]=_0x4fdb62[_0x2cb907(0x1187)];break;case _0x2cb907(0xbd0):_0x36d660[_0x2cb907(0x259)]=_0x2cb907(0xbd0),_0x36d660[_0x2cb907(0x316)]=_0x4fdb62['title'],_0x36d660['description']=_0x4fdb62[_0x2cb907(0x4e9)],_0x36d660[_0x2cb907(0x885)]=_0x4fdb62[_0x2cb907(0x885)],_0x36d660['content']=_0x4fdb62[_0x2cb907(0x1316)];break;default:Object['assign'](_0x36d660,_0x4fdb62);break;}_0x53aa93['push'](_0x36d660);}if(_0x53aa93[_0x2cb907(0x131d)]===0x0){document['getElementById'](_0x2cb907(0x3b9))[_0x2cb907(0x11c2)]['remove'](_0x2cb907(0x67d));return;}_0x2871b3[_0x2cb907(0x1d5)][_0x2cb907(0x9cf)](_0x5576f5,0x1,..._0x53aa93);let _0x2d2e1c=_0x1eebd6;for(let _0x35d258=_0x5576f5;_0x35d258<_0x2871b3[_0x2cb907(0x1d5)]['length'];_0x35d258++){_0x2871b3[_0x2cb907(0x1d5)][_0x35d258][_0x2cb907(0xf16)]=_0x2d2e1c,_0x2d2e1c++;}await _0x17d534[_0x2cb907(0x954)][_0x2cb907(0xf3f)](_0x2871b3),document[_0x2cb907(0x458)]('message-editor-modal')[_0x2cb907(0x11c2)][_0x2cb907(0x1097)]('visible'),_0x359c96(_0x42f206['activeChatId']),await _0x34fce8('成功','消息已更新！');}function _0xa011e1(_0x444161){const _0x2eefde=_0x204348;_0x3e8819=_0x444161,document[_0x2eefde(0x458)](_0x2eefde(0x9ec))['classList'][_0x2eefde(0xa58)]('visible');}function _0x562409(){const _0x11f3fe=_0x204348;document['getElementById']('post-actions-modal')[_0x11f3fe(0x11c2)]['remove'](_0x11f3fe(0x67d)),_0x3e8819=null;}async function _0x37aa62(){const _0x3600a7=_0x204348;if(!_0x3e8819)return;const _0x1a1e35=_0x3e8819,_0x3668a5=await _0x17d534[_0x3600a7(0x15b)]['get'](_0x1a1e35);if(!_0x3668a5)return;_0x562409();let _0x3c93f3;if(_0x3668a5[_0x3600a7(0x259)]===_0x3600a7(0xb03))_0x3c93f3=_0x3668a5[_0x3600a7(0x1316)];else{const _0x3bd7ee={'type':_0x3668a5['type'],'publicText':_0x3668a5[_0x3600a7(0xd2d)]||''};if(_0x3668a5[_0x3600a7(0x259)]===_0x3600a7(0xe7f))_0x3bd7ee['imageUrl']=_0x3668a5[_0x3600a7(0x2cc)],_0x3bd7ee[_0x3600a7(0x343)]=_0x3668a5[_0x3600a7(0x343)];else _0x3668a5[_0x3600a7(0x259)]==='text_image'&&(_0x3bd7ee[_0x3600a7(0x145)]=_0x3668a5[_0x3600a7(0x145)]);_0x3c93f3=JSON[_0x3600a7(0xc04)](_0x3bd7ee,null,0x2);}const _0x550457={'shuoshuo':'在这里输入说说的内容...','image':{'type':_0x3600a7(0xe7f),'publicText':'','imageUrl':'https://...','imageDescription':''},'text_image':{'type':_0x3600a7(0x1237),'publicText':'','hiddenContent':''}},_0x4234f9='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x3600a7(0xc04)](_0x550457['image'])+_0x3600a7(0x571)+JSON[_0x3600a7(0xc04)](_0x550457[_0x3600a7(0x1237)])+_0x3600a7(0xb71),_0x501ac7=await _0x335e57(_0x3600a7(0x1004),_0x3600a7(0x453),_0x3c93f3,_0x3600a7(0xb43),_0x4234f9);setTimeout(()=>{const _0x2e224f=_0x3600a7,_0x4cba29=document[_0x2e224f(0x586)](_0x2e224f(0xd56));_0x4cba29&&_0x4cba29[_0x2e224f(0xd85)](_0x2e224f(0x1122),()=>{const _0x2fea44=_0x2e224f,_0x2a0f23=document['getElementById'](_0x2fea44(0x212));_0x2a0f23['value']=_0x550457[_0x2fea44(0xb03)],_0x2a0f23[_0x2fea44(0x1248)]();});},0x64),_0x501ac7!==null&&await _0x51961b(_0x1a1e35,_0x501ac7);}async function _0x51961b(_0x5d3acc,_0x361f65){const _0x20d4a0=_0x204348,_0x555906=await _0x17d534[_0x20d4a0(0x15b)][_0x20d4a0(0x36d)](_0x5d3acc);if(!_0x555906)return;const _0x77515b=_0x361f65[_0x20d4a0(0x2aa)]();try{const _0x1929aa=JSON['parse'](_0x77515b);_0x555906[_0x20d4a0(0x259)]=_0x1929aa[_0x20d4a0(0x259)]||_0x20d4a0(0xe7f),_0x555906[_0x20d4a0(0xd2d)]=_0x1929aa[_0x20d4a0(0xd2d)]||'',_0x555906[_0x20d4a0(0x2cc)]=_0x1929aa[_0x20d4a0(0x2cc)]||'',_0x555906[_0x20d4a0(0x343)]=_0x1929aa[_0x20d4a0(0x343)]||'',_0x555906[_0x20d4a0(0x145)]=_0x1929aa['hiddenContent']||'',_0x555906[_0x20d4a0(0x1316)]='';}catch(_0x311c07){_0x555906['type']='shuoshuo',_0x555906['content']=_0x77515b,_0x555906[_0x20d4a0(0xd2d)]='',_0x555906['imageUrl']='',_0x555906[_0x20d4a0(0x343)]='',_0x555906['hiddenContent']='';}await _0x17d534['qzonePosts']['put'](_0x555906),await _0x316550(),await _0x34fce8('成功',_0x20d4a0(0x246));}async function _0x3014c1(){const _0x59704b=_0x204348;if(!_0x3e8819)return;const _0x17c8dd=await _0x17d534[_0x59704b(0x15b)][_0x59704b(0x36d)](_0x3e8819);if(!_0x17c8dd)return;let _0x127f4e=_0x17c8dd['content']||_0x17c8dd['publicText']||_0x17c8dd[_0x59704b(0x145)]||_0x17c8dd[_0x59704b(0x343)]||_0x59704b(0xd9b);try{await navigator[_0x59704b(0x13d0)][_0x59704b(0x6d0)](_0x127f4e),await _0x34fce8(_0x59704b(0x48c),_0x59704b(0x48a));}catch(_0x577845){await _0x34fce8('复制失败',_0x59704b(0x13f8));}_0x562409();}let _0xd156da=new Set();async function _0x55a6d6(){const _0x345a60=_0x204348,_0x113596=await _0xcd7475(_0x345a60(0x139e),[{'text':_0x345a60(0xa34),'value':_0x345a60(0xfee)},{'text':_0x345a60(0xc95),'value':'spectator'}]);if(_0x113596==='normal'){_0xd156da['clear']();const _0x45d631=document[_0x345a60(0x458)]('confirm-contact-picker-btn'),_0x18c516=_0x45d631[_0x345a60(0x350)](!![]);_0x45d631['parentNode'][_0x345a60(0x3f2)](_0x18c516,_0x45d631),_0x18c516[_0x345a60(0xd85)](_0x345a60(0x1122),_0x2a7c6c),await _0x362a4f(),_0x589d88(_0x345a60(0xc02));}else _0x113596===_0x345a60(0x804)&&_0x1dd4c2();}async function _0x1dd4c2(){const _0x51526e=_0x204348;_0xd156da[_0x51526e(0x415)]();const _0xb2d280=document[_0x51526e(0x458)](_0x51526e(0x11cc)),_0x17c8ab=_0xb2d280[_0x51526e(0x350)](!![]);_0xb2d280[_0x51526e(0x135e)][_0x51526e(0x3f2)](_0x17c8ab,_0xb2d280),_0x17c8ab[_0x51526e(0xd85)](_0x51526e(0x1122),_0x22dea8),await _0x35233e(),_0x589d88('contact-picker-screen');}async function _0x35233e(){const _0x3ffd1d=_0x204348,_0x47ed95=document[_0x3ffd1d(0x458)](_0x3ffd1d(0xd96));_0x47ed95[_0x3ffd1d(0x110d)]='';const _0x226915=Object[_0x3ffd1d(0x6eb)](_0x42f206[_0x3ffd1d(0x954)])[_0x3ffd1d(0xaf1)](_0x5df4f2=>!_0x5df4f2[_0x3ffd1d(0x726)]),_0x7340a8=await _0x17d534[_0x3ffd1d(0x996)]['toArray']();if(_0x226915[_0x3ffd1d(0x131d)]===0x0&&_0x7340a8['length']===0x0){_0x47ed95['innerHTML']=_0x3ffd1d(0x1320);return;}_0x226915[_0x3ffd1d(0x12c2)](_0x402c95=>{const _0x5834ec=_0x3ffd1d,_0x4c1682=document['createElement']('div');_0x4c1682[_0x5834ec(0x69b)]='contact-picker-item',_0x4c1682[_0x5834ec(0x1f4)][_0x5834ec(0x95b)]=_0x402c95['id'],_0x4c1682[_0x5834ec(0x110d)]=_0x5834ec(0x12d9)+(_0x402c95[_0x5834ec(0xda2)][_0x5834ec(0x9c7)]||_0x4fd084)+_0x5834ec(0x10f0)+_0x402c95[_0x5834ec(0x132a)]+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x47ed95[_0x5834ec(0x1079)](_0x4c1682);}),_0x7340a8[_0x3ffd1d(0x12c2)](_0x2f0e74=>{const _0x1f28e8=_0x3ffd1d,_0x1c748c=document[_0x1f28e8(0xe7d)](_0x1f28e8(0x1323));_0x1c748c[_0x1f28e8(0x69b)]=_0x1f28e8(0x28c),_0x1c748c[_0x1f28e8(0x1f4)][_0x1f28e8(0x95b)]=_0x2f0e74['id'],_0x1c748c[_0x1f28e8(0x1f4)][_0x1f28e8(0x474)]=_0x1f28e8(0x12b7),_0x1c748c[_0x1f28e8(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x2f0e74[_0x1f28e8(0x5c6)]||_0x482806)+_0x1f28e8(0x10f0)+_0x2f0e74[_0x1f28e8(0x132a)]+_0x1f28e8(0x40f),_0x47ed95[_0x1f28e8(0x1079)](_0x1c748c);}),_0x341807();}async function _0x22dea8(){const _0xe3b1da=_0x204348;if(_0xd156da[_0xe3b1da(0x12a4)]<0x2){alert(_0xe3b1da(0xdc7));return;}const _0x108596=await _0x335e57(_0xe3b1da(0x123e),'请输入群聊的名字',_0xe3b1da(0x10de));if(!_0x108596||!_0x108596[_0xe3b1da(0x2aa)]())return;const _0x5aebd2=_0xe3b1da(0x36b)+Date[_0xe3b1da(0x606)](),_0x49db20=[],_0x4dfb12=await _0x17d534[_0xe3b1da(0x996)]['toArray']();for(const _0x206ad1 of _0xd156da){const _0x25ea45=document[_0xe3b1da(0x586)](_0xe3b1da(0x388)+_0x206ad1+'\x22]')[_0xe3b1da(0x1f4)]['isNpc']===_0xe3b1da(0x12b7);if(_0x25ea45){const _0x36357a=_0x4dfb12[_0xe3b1da(0xb07)](_0x28486e=>_0x28486e['id']===parseInt(_0x206ad1));_0x36357a&&_0x49db20[_0xe3b1da(0x129e)]({'id':_0xe3b1da(0xa45)+_0x36357a['id'],'originalName':_0x36357a[_0xe3b1da(0x132a)],'groupNickname':_0x36357a[_0xe3b1da(0x132a)],'persona':_0x36357a['persona'],'avatar':_0x36357a[_0xe3b1da(0x5c6)]||_0x482806,'isNpc':!![]});}else{const _0x365ced=_0x42f206[_0xe3b1da(0x954)][_0x206ad1];_0x365ced&&_0x49db20[_0xe3b1da(0x129e)]({'id':_0x206ad1,'originalName':_0x365ced['originalName'],'groupNickname':_0x365ced[_0xe3b1da(0x132a)],'persona':_0x365ced[_0xe3b1da(0xda2)][_0xe3b1da(0x31d)],'avatar':_0x365ced[_0xe3b1da(0xda2)]['aiAvatar']||_0x4fd084,'isNpc':![]});}}const _0x3cf345={'id':_0x5aebd2,'name':_0x108596['trim'](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x49db20,'settings':{'maxMemory':0xa,'groupAvatar':_0x5448a9,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':'system','content':_0xe3b1da(0x2d8),'timestamp':Date[_0xe3b1da(0x606)](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x42f206[_0xe3b1da(0x954)][_0x5aebd2]=_0x3cf345,await _0x17d534[_0xe3b1da(0x954)][_0xe3b1da(0xf3f)](_0x3cf345),await _0x27be5e(),_0x589d88(_0xe3b1da(0x1302)),_0x31c384(_0x5aebd2);}async function _0x362a4f(){const _0x2fce24=_0x204348,_0x429598=document['getElementById'](_0x2fce24(0xd96));_0x429598['innerHTML']='';const _0x5c3cff=Object[_0x2fce24(0x6eb)](_0x42f206[_0x2fce24(0x954)])[_0x2fce24(0xaf1)](_0x578e3e=>!_0x578e3e[_0x2fce24(0x726)]),_0x2650c8=await _0x17d534[_0x2fce24(0x996)][_0x2fce24(0x511)]();if(_0x5c3cff[_0x2fce24(0x131d)]===0x0&&_0x2650c8[_0x2fce24(0x131d)]===0x0){_0x429598[_0x2fce24(0x110d)]=_0x2fce24(0xb0c);return;}_0x5c3cff[_0x2fce24(0x12c2)](_0x5db697=>{const _0x4d9664=_0x2fce24,_0x36e58b=document[_0x4d9664(0xe7d)]('div');_0x36e58b[_0x4d9664(0x69b)]=_0x4d9664(0x28c),_0x36e58b[_0x4d9664(0x1f4)][_0x4d9664(0x95b)]=_0x5db697['id'],_0x36e58b[_0x4d9664(0x110d)]=_0x4d9664(0x12d9)+(_0x5db697['settings'][_0x4d9664(0x9c7)]||_0x4fd084)+_0x4d9664(0x10f0)+_0x5db697['name']+_0x4d9664(0xf56),_0x429598[_0x4d9664(0x1079)](_0x36e58b);}),_0x2650c8[_0x2fce24(0x12c2)](_0x449818=>{const _0x263432=_0x2fce24,_0x9c7c=document['createElement'](_0x263432(0x1323));_0x9c7c['className']='contact-picker-item',_0x9c7c['dataset'][_0x263432(0x95b)]='npc_'+_0x449818['id'],_0x9c7c[_0x263432(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x449818[_0x263432(0x5c6)]||_0x482806)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x449818[_0x263432(0x132a)]+_0x263432(0x40f),_0x429598['appendChild'](_0x9c7c);}),_0x341807();}function _0x341807(){const _0x2a4d77=_0x204348,_0x4f77bc=document[_0x2a4d77(0x458)](_0x2a4d77(0x11cc));_0x4f77bc[_0x2a4d77(0x1a2)]=_0x2a4d77(0xeed)+_0xd156da[_0x2a4d77(0x12a4)]+')',_0x4f77bc[_0x2a4d77(0xb18)]=_0xd156da[_0x2a4d77(0x12a4)]<0x2;}async function _0x2a7c6c(){const _0x554186=_0x204348;if(_0xd156da[_0x554186(0x12a4)]<0x2){alert('创建群聊至少需要选择2个联系人。');return;}const _0x2f5062=await _0x335e57(_0x554186(0x123e),_0x554186(0x123f),'我们的群聊');if(!_0x2f5062||!_0x2f5062[_0x554186(0x2aa)]())return;const _0x59e8dd=_0x554186(0x36b)+Date[_0x554186(0x606)](),_0x4f4766=[],_0x4115cd=await _0x17d534[_0x554186(0x996)][_0x554186(0x511)]();for(const _0x1bc85c of _0xd156da){if(_0x1bc85c[_0x554186(0x13ad)](_0x554186(0xa45))){const _0x250a3e=parseInt(_0x1bc85c[_0x554186(0x33b)](_0x554186(0xa45),'')),_0x293445=_0x4115cd[_0x554186(0xb07)](_0x18578b=>_0x18578b['id']===_0x250a3e);_0x293445&&_0x4f4766['push']({'id':_0x1bc85c,'originalName':_0x293445[_0x554186(0x132a)],'groupNickname':_0x293445['name'],'persona':_0x293445[_0x554186(0x124d)],'avatar':_0x293445[_0x554186(0x5c6)]||_0x482806,'isNpc':!![]});}else{const _0x5b38c1=_0x42f206['chats'][_0x1bc85c];_0x5b38c1&&_0x4f4766[_0x554186(0x129e)]({'id':_0x1bc85c,'originalName':_0x5b38c1[_0x554186(0xa1)],'groupNickname':_0x5b38c1[_0x554186(0x132a)],'persona':_0x5b38c1[_0x554186(0xda2)][_0x554186(0x31d)],'avatar':_0x5b38c1[_0x554186(0xda2)][_0x554186(0x9c7)]||_0x4fd084,'isNpc':![]});}}const _0x42c188={'id':_0x59e8dd,'name':_0x2f5062[_0x554186(0x2aa)](),'isGroup':!![],'members':_0x4f4766,'settings':{'myPersona':_0x554186(0x44b),'myNickname':'我','maxMemory':0xa,'groupAvatar':_0x5448a9,'myAvatar':_0x502840,'background':'','theme':_0x554186(0x1121),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x42f206[_0x554186(0x954)][_0x59e8dd]=_0x42c188,await _0x17d534['chats'][_0x554186(0xf3f)](_0x42c188),await _0x27be5e(),_0x589d88(_0x554186(0x1302)),_0x31c384(_0x59e8dd);}function _0x32daaa(){const _0x37f402=_0x204348;if(!_0x42f206[_0x37f402(0x81d)]||!_0x42f206[_0x37f402(0x954)][_0x42f206[_0x37f402(0x81d)]][_0x37f402(0x726)])return;_0x391d12(),_0x589d88(_0x37f402(0x106c));}function _0x391d12(){const _0x2efa11=_0x204348,_0x514877=document[_0x2efa11(0x458)]('member-management-list'),_0x1a02d1=_0x42f206['chats'][_0x42f206['activeChatId']];_0x514877[_0x2efa11(0x110d)]='',_0x1a02d1[_0x2efa11(0xfa8)][_0x2efa11(0x12c2)](_0x2040b0=>{const _0x24d0cf=_0x2efa11,_0x53da9b=document[_0x24d0cf(0xe7d)](_0x24d0cf(0x1323));_0x53da9b[_0x24d0cf(0x69b)]=_0x24d0cf(0xc70),_0x53da9b['innerHTML']=_0x24d0cf(0xe10)+_0x2040b0['avatar']+_0x24d0cf(0x135c)+_0x2040b0[_0x24d0cf(0x1118)]+_0x24d0cf(0x3f7)+_0x2040b0['id']+_0x24d0cf(0x9c2),_0x514877['appendChild'](_0x53da9b);});}async function _0x13cc00(_0xf3c257){const _0x63b82e=_0x204348,_0x33b9c7=_0x42f206['chats'][_0x42f206[_0x63b82e(0x81d)]],_0x418bd7=_0x33b9c7[_0x63b82e(0xfa8)]['findIndex'](_0x5dbce8=>_0x5dbce8['id']===_0xf3c257);if(_0x418bd7===-0x1)return;if(_0x33b9c7[_0x63b82e(0xfa8)]['length']<=0x2){alert(_0x63b82e(0x608));return;}const _0x44b3b4=_0x33b9c7[_0x63b82e(0xfa8)][_0x418bd7][_0x63b82e(0x1118)],_0x192f25=await _0x2532b9(_0x63b82e(0x3e6),_0x63b82e(0x75d)+_0x44b3b4+_0x63b82e(0x9ed),{'confirmButtonClass':_0x63b82e(0x4d3)});_0x192f25&&(_0x33b9c7['members']['splice'](_0x418bd7,0x1),await _0x17d534[_0x63b82e(0x954)][_0x63b82e(0xf3f)](_0x33b9c7),_0x391d12(),document['getElementById']('chat-settings-btn')[_0x63b82e(0x1122)]());}async function _0xfd8b85(){const _0x5a83c5=_0x204348,_0x18822c=document['getElementById'](_0x5a83c5(0x11cc)),_0x1f546a=_0x18822c['cloneNode'](!![]);_0x18822c[_0x5a83c5(0x135e)]['replaceChild'](_0x1f546a,_0x18822c),_0x1f546a[_0x5a83c5(0xd85)](_0x5a83c5(0x1122),_0xd7e165),await _0x1d7433(),_0x589d88(_0x5a83c5(0xc02));}async function _0x1d7433(){const _0x4a2baa=_0x204348,_0x910a2e=document[_0x4a2baa(0x458)](_0x4a2baa(0xd96));_0x910a2e[_0x4a2baa(0x110d)]='',_0xd156da[_0x4a2baa(0x415)]();const _0x21108f=_0x42f206[_0x4a2baa(0x954)][_0x42f206[_0x4a2baa(0x81d)]],_0x1fbe91=new Set(_0x21108f[_0x4a2baa(0xfa8)][_0x4a2baa(0xbf6)](_0x40fbda=>_0x40fbda['id'])),_0x241bd6=Object[_0x4a2baa(0x6eb)](_0x42f206[_0x4a2baa(0x954)])[_0x4a2baa(0xaf1)](_0x4f9400=>!_0x4f9400[_0x4a2baa(0x726)]&&!_0x1fbe91[_0x4a2baa(0x31c)](_0x4f9400['id'])),_0x4bbb9c=(await _0x17d534[_0x4a2baa(0x996)][_0x4a2baa(0x511)]())['filter'](_0x3a0811=>!_0x1fbe91['has'](_0x4a2baa(0xa45)+_0x3a0811['id']));_0x241bd6['length']===0x0&&_0x4bbb9c[_0x4a2baa(0x131d)]===0x0?(_0x910a2e[_0x4a2baa(0x110d)]=_0x4a2baa(0xe1),document[_0x4a2baa(0x458)]('confirm-contact-picker-btn')[_0x4a2baa(0x1104)][_0x4a2baa(0x4db)]=_0x4a2baa(0x464)):(document[_0x4a2baa(0x458)](_0x4a2baa(0x11cc))['style'][_0x4a2baa(0x4db)]='block',_0x241bd6[_0x4a2baa(0x12c2)](_0x4d5004=>{const _0x4df3de=_0x4a2baa,_0xba2e56=document[_0x4df3de(0xe7d)]('div');_0xba2e56[_0x4df3de(0x69b)]=_0x4df3de(0x28c),_0xba2e56[_0x4df3de(0x1f4)]['contactId']=_0x4d5004['id'],_0xba2e56[_0x4df3de(0x1f4)][_0x4df3de(0x574)]=_0x4df3de(0x4c5),_0xba2e56[_0x4df3de(0x110d)]=_0x4df3de(0xa81)+(_0x4d5004[_0x4df3de(0xda2)][_0x4df3de(0x9c7)]||_0x4fd084)+_0x4df3de(0x4f5)+_0x4d5004[_0x4df3de(0x132a)]+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x910a2e[_0x4df3de(0x1079)](_0xba2e56);}),_0x4bbb9c[_0x4a2baa(0x12c2)](_0x2b9bb8=>{const _0x2c01b5=_0x4a2baa,_0x3ed93a=document[_0x2c01b5(0xe7d)](_0x2c01b5(0x1323));_0x3ed93a[_0x2c01b5(0x69b)]=_0x2c01b5(0x28c),_0x3ed93a[_0x2c01b5(0x1f4)][_0x2c01b5(0x95b)]=_0x2c01b5(0xa45)+_0x2b9bb8['id'],_0x3ed93a[_0x2c01b5(0x1f4)]['contactType']='npc',_0x3ed93a[_0x2c01b5(0x1f4)][_0x2c01b5(0x5cd)]=_0x2b9bb8['id'],_0x3ed93a['innerHTML']=_0x2c01b5(0xa81)+(_0x2b9bb8['avatar']||_0x482806)+_0x2c01b5(0x4f5)+_0x2b9bb8[_0x2c01b5(0x132a)]+_0x2c01b5(0x3c9),_0x910a2e[_0x2c01b5(0x1079)](_0x3ed93a);})),_0x341807();}async function _0xd7e165(){const _0xd81a70=_0x204348;if(_0xd156da[_0xd81a70(0x12a4)]===0x0){alert(_0xd81a70(0xeb6));return;}const _0xbf2c76=_0x42f206[_0xd81a70(0x954)][_0x42f206[_0xd81a70(0x81d)]],_0x5c4e20=await _0x17d534['npcs'][_0xd81a70(0x511)]();for(const _0x5a16a9 of _0xd156da){const _0x301ccb=document[_0xd81a70(0x586)](_0xd81a70(0x388)+_0x5a16a9+'\x22]');if(!_0x301ccb)continue;const _0x59b00b=_0x301ccb[_0xd81a70(0x1f4)]['contactType'];if(_0x59b00b===_0xd81a70(0x4c5)){const _0x5bfad5=_0x42f206[_0xd81a70(0x954)][_0x5a16a9];_0x5bfad5&&_0xbf2c76[_0xd81a70(0xfa8)][_0xd81a70(0x129e)]({'id':_0x5a16a9,'originalName':_0x5bfad5[_0xd81a70(0xa1)],'groupNickname':_0x5bfad5[_0xd81a70(0x132a)],'persona':_0x5bfad5[_0xd81a70(0xda2)][_0xd81a70(0x31d)],'avatar':_0x5bfad5[_0xd81a70(0xda2)][_0xd81a70(0x9c7)]||_0x4fd084,'isNpc':![]});}else{if(_0x59b00b==='npc'){const _0x2bd1ee=parseInt(_0x301ccb['dataset']['npcId']),_0x5e3a4d=_0x5c4e20[_0xd81a70(0xb07)](_0xde6d5b=>_0xde6d5b['id']===_0x2bd1ee);_0x5e3a4d&&_0xbf2c76[_0xd81a70(0xfa8)][_0xd81a70(0x129e)]({'id':_0xd81a70(0xa45)+_0x2bd1ee,'originalName':_0x5e3a4d[_0xd81a70(0x132a)],'groupNickname':_0x5e3a4d[_0xd81a70(0x132a)],'persona':_0x5e3a4d[_0xd81a70(0x124d)],'avatar':_0x5e3a4d[_0xd81a70(0x5c6)]||_0x482806,'isNpc':!![]});}}}await _0x17d534[_0xd81a70(0x954)][_0xd81a70(0xf3f)](_0xbf2c76),_0x32daaa();}function _0x22d590(){_0x9dc5b0=!![],_0x169028(null);}function _0x46ec06(_0x5bf100,_0x1c0bda){const _0x574600=setInterval(()=>{const _0x36a038=_0x1a5b,_0x123a02=Date[_0x36a038(0x606)](),_0x569b07=_0x1c0bda-_0x123a02;if(_0x569b07<0x0){clearInterval(_0x574600),_0x5bf100[_0x36a038(0x110d)]=_0x36a038(0x52e);return;}const _0x5bb612=Math[_0x36a038(0xbd5)](_0x569b07%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x17cb5c=Math[_0x36a038(0xbd5)](_0x569b07%(0x3e8*0x3c)/0x3e8),_0x221f48=String(_0x5bb612)[_0x36a038(0x508)](0x2,'0'),_0x28f334=String(_0x17cb5c)[_0x36a038(0x508)](0x2,'0');_0x5bf100[_0x36a038(0x110d)]=_0x36a038(0x32a)+_0x221f48[_0x36a038(0x8bc)](0x0)+_0x36a038(0x227)+_0x221f48[_0x36a038(0x8bc)](0x1)+_0x36a038(0x1a5)+_0x28f334['charAt'](0x0)+_0x36a038(0x227)+_0x28f334[_0x36a038(0x8bc)](0x1)+_0x36a038(0xf82);},0x3e8);return _0x574600;}function _0x34dfd6(){for(const _0x183a1 in _0x2bdb95){clearInterval(_0x2bdb95[_0x183a1]);}_0x2bdb95={};}async function _0x10f1ca(_0x3adc1f){const _0x3f3bdc=_0x204348,_0x430623=_0x42f206[_0x3f3bdc(0x954)][_0x42f206[_0x3f3bdc(0x81d)]];if(!_0x430623)return;const _0x17a7ef=_0x430623[_0x3f3bdc(0x1d5)]['find'](_0x5f12b6=>_0x5f12b6[_0x3f3bdc(0xf16)]===_0x3adc1f);if(!_0x17a7ef||!['waimai_request',_0x3f3bdc(0x10e9)][_0x3f3bdc(0xd8d)](_0x17a7ef[_0x3f3bdc(0x259)])){console[_0x3f3bdc(0xb61)](_0x3f3bdc(0xe39),_0x3adc1f);return;}let _0x58cdef='';if(_0x17a7ef[_0x3f3bdc(0x259)]===_0x3f3bdc(0x1128)){let _0x32d04b;switch(_0x17a7ef['status']){case _0x3f3bdc(0x1467):const _0x38cdcb=_0x17a7ef[_0x3f3bdc(0x167)]||'对方',_0x5758ab=_0x32d364(_0x430623,_0x38cdcb);_0x32d04b='由\x20'+_0x5758ab+'\x20为您代付成功';break;case _0x3f3bdc(0x1133):_0x32d04b=_0x3f3bdc(0x55d);break;default:_0x32d04b=_0x3f3bdc(0x77d);break;}_0x58cdef=_0x3f3bdc(0x596)+_0x17a7ef[_0x3f3bdc(0xaed)]+_0x3f3bdc(0x57b)+Number(_0x17a7ef[_0x3f3bdc(0x116)])[_0x3f3bdc(0x800)](0x2)+_0x3f3bdc(0xbf9)+_0x32d04b+_0x3f3bdc(0x143d);}else{if(_0x17a7ef[_0x3f3bdc(0x259)]===_0x3f3bdc(0x10e9)){let _0x246df4,_0x1cd0ef;_0x430623['isGroup']?(_0x246df4=_0x32d364(_0x430623,_0x17a7ef[_0x3f3bdc(0x2a3)]),_0x1cd0ef=_0x32d364(_0x430623,_0x17a7ef['recipientName'])):_0x17a7ef[_0x3f3bdc(0xaeb)]===_0x3f3bdc(0xf86)?(_0x246df4=_0x430623[_0x3f3bdc(0xda2)][_0x3f3bdc(0xc7d)]||'我',_0x1cd0ef=_0x430623[_0x3f3bdc(0x132a)]):(_0x246df4=_0x430623[_0x3f3bdc(0x132a)],_0x1cd0ef=_0x430623[_0x3f3bdc(0xda2)][_0x3f3bdc(0xc7d)]||'我'),_0x58cdef=_0x3f3bdc(0x77c)+_0x246df4+_0x3f3bdc(0xba3)+_0x1cd0ef+_0x3f3bdc(0x17f)+_0x17a7ef[_0x3f3bdc(0xaed)]+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥'+Number(_0x17a7ef[_0x3f3bdc(0x116)])[_0x3f3bdc(0x800)](0x2)+_0x3f3bdc(0x143d);}}await _0x34fce8(_0x3f3bdc(0x3e9),_0x58cdef);}async function _0x43dd8d(_0x17306d,_0x41fffc){const _0x38f37d=_0x204348,_0x42c90b=_0x42f206['chats'][_0x42f206[_0x38f37d(0x81d)]];if(!_0x42c90b)return;const _0x2ad2fb=_0x42c90b[_0x38f37d(0x1d5)][_0x38f37d(0x4a8)](_0x3acea4=>_0x3acea4[_0x38f37d(0xf16)]===_0x17306d);if(_0x2ad2fb===-0x1)return;const _0x312093=_0x42c90b[_0x38f37d(0x1d5)][_0x2ad2fb];_0x312093[_0x38f37d(0x13b2)]=_0x41fffc;let _0x38c697;const _0xa4cb53=_0x42c90b[_0x38f37d(0x726)]?_0x42c90b[_0x38f37d(0xda2)][_0x38f37d(0xc7d)]||'我':'我';_0x41fffc==='paid'?(_0x312093[_0x38f37d(0x167)]=_0xa4cb53,_0x38c697='[系统提示：你\x20('+_0xa4cb53+_0x38f37d(0xfd4)+_0x312093[_0x38f37d(0x2a3)]+_0x38f37d(0x3be)+_0x17306d+_0x38f37d(0xef7)):_0x38c697=_0x38f37d(0x39c)+_0xa4cb53+_0x38f37d(0x6d)+_0x312093[_0x38f37d(0x2a3)]+_0x38f37d(0x1047)+_0x17306d+_0x38f37d(0xa90);const _0x2533b0={'role':'system','content':_0x38c697,'timestamp':Date['now'](),'isHidden':!![]};_0x42c90b[_0x38f37d(0x1d5)][_0x38f37d(0x129e)](_0x2533b0),await _0x17d534[_0x38f37d(0x954)]['put'](_0x42c90b),_0x359c96(_0x42f206[_0x38f37d(0x81d)]);}let _0x4a3337={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x2b8efa=null;async function _0xd907d5(){const _0x293183=_0x204348;if(!_0x42f206[_0x293183(0x81d)]||_0x4a3337[_0x293183(0x1196)]||_0x4a3337['isAwaitingResponse'])return;const _0x3c7a75=_0x42f206[_0x293183(0x954)][_0x42f206[_0x293183(0x81d)]];_0x4a3337[_0x293183(0x60a)]=_0x3c7a75[_0x293183(0x726)],_0x4a3337[_0x293183(0x9a6)]=!![],_0x4a3337[_0x293183(0x6a0)]=_0x293183(0xf86),_0x4a3337[_0x293183(0x81d)]=_0x3c7a75['id'],_0x4a3337[_0x293183(0x130b)]=!![];_0x3c7a75['isGroup']?(document[_0x293183(0x458)]('outgoing-call-avatar')[_0x293183(0x577)]=_0x3c7a75[_0x293183(0xda2)][_0x293183(0xa6)]||_0x502840,document[_0x293183(0x458)](_0x293183(0x87b))[_0x293183(0x1a2)]=_0x3c7a75[_0x293183(0xda2)]['myNickname']||'我'):(document[_0x293183(0x458)]('outgoing-call-avatar')[_0x293183(0x577)]=_0x3c7a75[_0x293183(0xda2)][_0x293183(0x9c7)]||_0x4fd084,document[_0x293183(0x458)]('outgoing-call-name')['textContent']=_0x3c7a75['name']);document[_0x293183(0x586)](_0x293183(0xd59))['textContent']=_0x3c7a75[_0x293183(0x726)]?_0x293183(0xb82):_0x293183(0x1f9),_0x589d88('outgoing-call-screen');const _0x2c68ef={'role':_0x293183(0x1370),'content':_0x3c7a75['isGroup']?_0x293183(0x10b)+(_0x3c7a75['settings'][_0x293183(0xc7d)]||'我')+')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]':_0x293183(0xc01),'timestamp':Date['now'](),'isHidden':!![]};_0x3c7a75[_0x293183(0x1d5)][_0x293183(0x129e)](_0x2c68ef),await _0x17d534[_0x293183(0x954)][_0x293183(0xf3f)](_0x3c7a75),await _0x3ee822();}function _0x309acd(){const _0x5bf662=_0x204348,_0x427e8e=_0x42f206[_0x5bf662(0x954)][_0x4a3337[_0x5bf662(0x81d)]];if(!_0x427e8e)return;_0x4a3337['isActive']=!![],_0x4a3337[_0x5bf662(0x9a6)]=![],_0x4a3337['startTime']=Date[_0x5bf662(0x606)](),_0x4a3337['callHistory']=[];const _0x130d6c=_0x427e8e[_0x5bf662(0x1d5)][_0x5bf662(0x5b0)](-0xa);_0x4a3337[_0x5bf662(0x39d)]=_0x130d6c['map'](_0x433e79=>{const _0x30b84f=_0x5bf662,_0x5a85ba=_0x433e79[_0x30b84f(0xaeb)]==='user'?_0x427e8e[_0x30b84f(0xda2)][_0x30b84f(0xc7d)]||'我':_0x433e79[_0x30b84f(0x2a3)]||_0x427e8e[_0x30b84f(0x132a)];return _0x5a85ba+':\x20'+String(_0x433e79[_0x30b84f(0x1316)])[_0x30b84f(0xa6d)](0x0,0x32)+_0x30b84f(0x10a0);})[_0x5bf662(0x56c)]('\x0a'),_0x412344(),document['getElementById']('video-call-main')['innerHTML']=_0x5bf662(0x13a4)+(_0x4a3337['isGroupCall']?_0x5bf662(0xed6):_0x5bf662(0x139b))+'</em>',_0x589d88(_0x5bf662(0x9f6)),document[_0x5bf662(0x458)](_0x5bf662(0x3e7))[_0x5bf662(0x1104)][_0x5bf662(0x4db)]=_0x4a3337[_0x5bf662(0x130b)]?_0x5bf662(0x1188):'none',document[_0x5bf662(0x458)](_0x5bf662(0x888))[_0x5bf662(0x1104)][_0x5bf662(0x4db)]=_0x4a3337['isUserParticipating']?_0x5bf662(0x464):_0x5bf662(0x1188);if(_0x2b8efa)clearInterval(_0x2b8efa);_0x2b8efa=setInterval(_0x4c7ff6,0x3e8),_0x4c7ff6(),_0x4db68a();}async function _0x4ffcb4(){const _0x4743a7=_0x204348;if(!_0x4a3337[_0x4743a7(0x1196)])return;const _0x4c356e=Math['floor']((Date['now']()-_0x4a3337[_0x4743a7(0x1319)])/0x3e8),_0x4c5b9a=Math[_0x4743a7(0xbd5)](_0x4c356e/0x3c)+'分'+_0x4c356e%0x3c+'秒',_0x2bcb89='通话结束，时长\x20'+_0x4c5b9a,_0x4d5713=_0x42f206[_0x4743a7(0x954)][_0x4a3337[_0x4743a7(0x81d)]];if(_0x4d5713){const _0x47257b=[];_0x4a3337['isGroupCall']?(_0x4a3337[_0x4743a7(0x1008)][_0x4743a7(0x12c2)](_0x463b07=>_0x47257b['push']({'name':_0x463b07[_0x4743a7(0xa1)],'avatar':_0x463b07[_0x4743a7(0x5c6)]})),_0x4a3337['isUserParticipating']&&_0x47257b[_0x4743a7(0xeb8)]({'name':_0x4d5713[_0x4743a7(0xda2)][_0x4743a7(0xc7d)]||'我','avatar':_0x4d5713[_0x4743a7(0xda2)][_0x4743a7(0xa6)]||_0x502840})):(_0x47257b[_0x4743a7(0x129e)]({'name':_0x4d5713[_0x4743a7(0x132a)],'avatar':_0x4d5713[_0x4743a7(0xda2)]['aiAvatar']||_0x4fd084}),_0x47257b[_0x4743a7(0xeb8)]({'name':'我','avatar':_0x4d5713[_0x4743a7(0xda2)][_0x4743a7(0xa6)]||_0x4fd084}));const _0x4ad100={'chatId':_0x4a3337[_0x4743a7(0x81d)],'timestamp':Date[_0x4743a7(0x606)](),'duration':_0x4c356e,'participants':_0x47257b,'transcript':[..._0x4a3337[_0x4743a7(0x8c2)]]};await _0x17d534[_0x4743a7(0x920)][_0x4743a7(0xa58)](_0x4ad100),console[_0x4743a7(0x7d1)](_0x4743a7(0x8af),_0x4ad100);let _0x50082e={'role':_0x4a3337[_0x4743a7(0x6a0)]===_0x4743a7(0xf86)?_0x4743a7(0xf86):'assistant','content':_0x2bcb89,'timestamp':Date['now']()};_0x4d5713[_0x4743a7(0x726)]&&_0x50082e['role']===_0x4743a7(0xac3)&&(_0x50082e[_0x4743a7(0x2a3)]=_0x4a3337[_0x4743a7(0xa1e)]||_0x4d5713[_0x4743a7(0xfa8)][0x0]?.[_0x4743a7(0xa1)]||_0x4d5713[_0x4743a7(0x132a)]);_0x4d5713['history']['push'](_0x50082e);const _0x460060=_0x4a3337[_0x4743a7(0x8c2)][_0x4743a7(0xbf6)](_0x52a5a5=>{const _0x3e8484=_0x4743a7,_0x376daa=_0x52a5a5[_0x3e8484(0xaeb)]===_0x3e8484(0xf86)?_0x4d5713[_0x3e8484(0xda2)][_0x3e8484(0xc7d)]||'我':_0x52a5a5[_0x3e8484(0x2a3)];return _0x376daa+':\x20'+_0x52a5a5[_0x3e8484(0x1316)];})[_0x4743a7(0x56c)]('\x0a');_0x112eb4(_0x4d5713['id'],_0x460060);const _0x374912={'role':_0x4743a7(0x1370),'content':_0x4743a7(0xb5),'timestamp':Date[_0x4743a7(0x606)]()+0x1,'isHidden':!![]};_0x4d5713['history']['push'](_0x374912),await _0x17d534[_0x4743a7(0x954)][_0x4743a7(0xf3f)](_0x4d5713);}clearInterval(_0x2b8efa),_0x2b8efa=null,_0x4a3337={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x4d5713&&(_0x31c384(_0x4d5713['id']),_0x3ee822());}function _0x412344(){const _0x48d313=_0x204348,_0x5d8b43=document[_0x48d313(0x458)](_0x48d313(0xee8));_0x5d8b43[_0x48d313(0x110d)]='';const _0x464891=_0x42f206[_0x48d313(0x954)][_0x4a3337[_0x48d313(0x81d)]];if(!_0x464891)return;let _0x5940be=[];_0x4a3337[_0x48d313(0x60a)]?(_0x5940be=[..._0x4a3337[_0x48d313(0x1008)]],_0x4a3337[_0x48d313(0x130b)]&&_0x5940be['unshift']({'id':'user','name':_0x464891[_0x48d313(0xda2)][_0x48d313(0xc7d)]||'我','avatar':_0x464891[_0x48d313(0xda2)][_0x48d313(0xa6)]||_0x502840})):_0x5940be[_0x48d313(0x129e)]({'id':'ai','name':_0x464891[_0x48d313(0x132a)],'avatar':_0x464891['settings'][_0x48d313(0x9c7)]||_0x4fd084}),_0x5940be[_0x48d313(0x12c2)](_0x205b67=>{const _0x1521fa=_0x48d313,_0x347859=document[_0x1521fa(0xe7d)]('div');_0x347859[_0x1521fa(0x69b)]='participant-avatar-wrapper',_0x347859[_0x1521fa(0x1f4)]['participantId']=_0x205b67['id'];const _0x48fb3a=_0x205b67['groupNickname']||_0x205b67[_0x1521fa(0x132a)];_0x347859[_0x1521fa(0x110d)]=_0x1521fa(0x442)+_0x205b67[_0x1521fa(0x5c6)]+_0x1521fa(0x6f4)+_0x48fb3a+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>'+_0x48fb3a+_0x1521fa(0x97e),_0x5d8b43[_0x1521fa(0x1079)](_0x347859);});}function _0x39a661(){const _0x5292e4=_0x204348;if(!_0x4a3337[_0x5292e4(0x1196)]||_0x4a3337[_0x5292e4(0x130b)])return;_0x4a3337['isUserParticipating']=!![],_0x412344(),document[_0x5292e4(0x458)](_0x5292e4(0x3e7))[_0x5292e4(0x1104)][_0x5292e4(0x4db)]=_0x5292e4(0x1188),document['getElementById']('join-call-btn')[_0x5292e4(0x1104)][_0x5292e4(0x4db)]=_0x5292e4(0x464),_0x4db68a(_0x5292e4(0x12b2));}function _0x4c7ff6(){const _0x1e75ab=_0x204348;if(!_0x4a3337[_0x1e75ab(0x1196)])return;const _0x58d463=Math['floor']((Date[_0x1e75ab(0x606)]()-_0x4a3337[_0x1e75ab(0x1319)])/0x3e8),_0x2a9bd2=Math[_0x1e75ab(0xbd5)](_0x58d463/0x3c),_0x293fb3=_0x58d463%0x3c;document[_0x1e75ab(0x458)](_0x1e75ab(0xa25))[_0x1e75ab(0x1a2)]=String(_0x2a9bd2)['padStart'](0x2,'0')+':'+String(_0x293fb3)[_0x1e75ab(0x508)](0x2,'0');}function _0x5ed899(){const _0x190bc5=_0x204348,_0x174d2f=_0x42f206[_0x190bc5(0x954)][_0x42f206[_0x190bc5(0x81d)]];if(!_0x174d2f)return;if(_0x174d2f['isGroup']){const _0x3b3f36=_0x4a3337['callRequester']||_0x174d2f['members'][0x0]?.['name']||'一位成员';document[_0x190bc5(0x458)](_0x190bc5(0xe72))[_0x190bc5(0x577)]=_0x174d2f[_0x190bc5(0xda2)]['groupAvatar']||_0x5448a9,document[_0x190bc5(0x458)](_0x190bc5(0x1045))['textContent']=_0x174d2f[_0x190bc5(0x132a)],document[_0x190bc5(0x586)](_0x190bc5(0x70f))[_0x190bc5(0x1a2)]=_0x3b3f36+_0x190bc5(0x107e);}else document['getElementById'](_0x190bc5(0xe72))[_0x190bc5(0x577)]=_0x174d2f['settings'][_0x190bc5(0x9c7)]||_0x4fd084,document[_0x190bc5(0x458)](_0x190bc5(0x1045))[_0x190bc5(0x1a2)]=_0x174d2f[_0x190bc5(0x132a)],document[_0x190bc5(0x586)](_0x190bc5(0x70f))[_0x190bc5(0x1a2)]='邀请你视频通话';document[_0x190bc5(0x458)](_0x190bc5(0xb2))['classList'][_0x190bc5(0xa58)](_0x190bc5(0x67d));}function _0x35c2b7(){const _0x36f008=_0x204348;document[_0x36f008(0x458)](_0x36f008(0xb2))[_0x36f008(0x11c2)]['remove'](_0x36f008(0x67d));}async function _0x4db68a(_0x27be97=null){const _0x19955f=_0x204348;if(!_0x4a3337[_0x19955f(0x1196)])return;const _0x349df8=_0x42f206[_0x19955f(0x954)][_0x4a3337[_0x19955f(0x81d)]],{proxyUrl:_0x285404,apiKey:_0x1f207a,model:_0xb2fe21}=_0x42f206[_0x19955f(0x5cb)],_0x2e0224=document[_0x19955f(0x458)](_0x19955f(0x116c)),_0x5affd5=_0x349df8[_0x19955f(0xda2)][_0x19955f(0xc7d)]||'我';let _0x5c18e5='';if(_0x349df8[_0x19955f(0xda2)][_0x19955f(0x315)]&&_0x349df8['settings'][_0x19955f(0x315)][_0x19955f(0x131d)]>0x0){const _0x36a7fa=_0x349df8[_0x19955f(0xda2)][_0x19955f(0x315)]['map'](_0xc6d7ad=>{const _0x324e18=_0x19955f,_0x525658=_0x42f206['worldBooks'][_0x324e18(0xb07)](_0x150707=>_0x150707['id']===_0xc6d7ad);return _0x525658&&_0x525658[_0x324e18(0x1316)]?'\x0a\x0a##\x20世界书:\x20'+_0x525658['name']+'\x0a'+_0x525658[_0x324e18(0x1316)]:'';})['filter'](Boolean)[_0x19955f(0x56c)]('');_0x36a7fa&&(_0x5c18e5=_0x19955f(0x518)+_0x36a7fa+_0x19955f(0xdcc));}if(_0x27be97&&_0x4a3337['isUserParticipating']){const _0x59503a=Date[_0x19955f(0x606)](),_0x26c273=document[_0x19955f(0xe7d)](_0x19955f(0x1323));_0x26c273['className']='call-message-bubble\x20user-speech',_0x26c273[_0x19955f(0x1a2)]=_0x27be97,_0x26c273[_0x19955f(0x1f4)][_0x19955f(0xf16)]=_0x59503a,_0x4376d8(_0x26c273,()=>_0xc902bb(_0x59503a)),_0x2e0224[_0x19955f(0x1079)](_0x26c273),_0x2e0224['scrollTop']=_0x2e0224[_0x19955f(0x94b)],_0x4a3337[_0x19955f(0x8c2)][_0x19955f(0x129e)]({'role':_0x19955f(0xf86),'content':_0x27be97,'timestamp':_0x59503a});}let _0x1b5956;if(_0x4a3337[_0x19955f(0x60a)]){const _0x18ecd6=_0x4a3337[_0x19955f(0x1008)][_0x19955f(0xbf6)](_0x5d83f4=>_0x5d83f4[_0x19955f(0x132a)]);_0x4a3337[_0x19955f(0x130b)]&&_0x18ecd6[_0x19955f(0xeb8)](_0x5affd5),_0x1b5956='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【身份铁律】】】**:\x20用户的身份是【'+_0x5affd5+_0x19955f(0x102f)+_0x5affd5+_0x19955f(0xe11)+_0x4a3337[_0x19955f(0x39d)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20'+_0x18ecd6[_0x19955f(0x56c)]('、\x20')+_0x19955f(0xa6f)+_0x5c18e5+_0x19955f(0xb6);}else{let _0x567016=_0x4a3337[_0x19955f(0x6a0)]==='user'?_0x19955f(0xc3d):_0x19955f(0x113e);_0x1b5956=_0x19955f(0x13d7)+_0x349df8[_0x19955f(0x132a)]+'\x20('+_0x349df8[_0x19955f(0xda2)]['aiPersona']+_0x19955f(0xa5d)+_0x349df8['name']+_0x19955f(0xdd1)+_0x5affd5+'，人设:\x20'+_0x349df8[_0x19955f(0xda2)]['myPersona']+_0x19955f(0xeda)+_0x567016+'**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4a3337[_0x19955f(0x39d)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}const _0x5ad9e1=[{'role':_0x19955f(0x1370),'content':_0x1b5956},..._0x4a3337[_0x19955f(0x8c2)][_0x19955f(0xbf6)](_0x301243=>({'role':_0x301243['role'],'content':_0x301243[_0x19955f(0x1316)]}))];if(_0x4a3337[_0x19955f(0x8c2)]['length']===0x0){const _0x1a4ca8=_0x4a3337['initiator']==='user'?_0x19955f(0x5e6):_0x19955f(0x775);_0x5ad9e1[_0x19955f(0x129e)]({'role':_0x19955f(0xf86),'content':_0x1a4ca8});}try{let _0x32a22b=_0x285404===GEMINI_API_URL,_0x141f72=_0x5d73db(_0xb2fe21,_0x1f207a,_0x1b5956,_0x5ad9e1);const _0x4e9ed6=_0x32a22b?await fetch(_0x141f72['url'],_0x141f72['data']):await fetch(_0x285404+_0x19955f(0xd7),{'method':_0x19955f(0x1312),'headers':{'Content-Type':'application/json','Authorization':_0x19955f(0x8aa)+_0x1f207a},'body':JSON[_0x19955f(0xc04)]({'model':_0xb2fe21,'messages':_0x5ad9e1,'temperature':_0x42f206[_0x19955f(0xf0)][_0x19955f(0xfdf)]||0.8})});if(!_0x4e9ed6['ok'])throw new Error((await _0x4e9ed6[_0x19955f(0xaef)]())[_0x19955f(0xb61)][_0x19955f(0x7aa)]);const _0x49cb82=await _0x4e9ed6[_0x19955f(0xaef)](),_0x1eeeda=_0x32a22b?_0x49cb82['candidates'][0x0][_0x19955f(0x1316)]['parts'][0x0]['text']:_0x49cb82[_0x19955f(0x2f9)][0x0][_0x19955f(0x7aa)]['content'],_0x200fc9=_0x2e0224[_0x19955f(0x586)]('em');if(_0x200fc9)_0x200fc9[_0x19955f(0x1097)]();if(_0x4a3337[_0x19955f(0x60a)]){const _0x2224a4=_0x418096(_0x1eeeda);_0x2224a4[_0x19955f(0x12c2)](_0x1b1622=>{const _0x45703f=_0x19955f;if(!_0x1b1622[_0x45703f(0x132a)]||_0x1b1622[_0x45703f(0x132a)]===_0x5affd5||!_0x1b1622[_0x45703f(0x12ab)])return;const _0x431ba7=Date[_0x45703f(0x606)]()+Math[_0x45703f(0x23a)](),_0x3e64f3=document[_0x45703f(0xe7d)]('div');_0x3e64f3[_0x45703f(0x69b)]='call-message-bubble\x20ai-speech',_0x3e64f3[_0x45703f(0x110d)]='<strong>'+_0x1b1622[_0x45703f(0x132a)]+_0x45703f(0x135a)+_0x1b1622[_0x45703f(0x12ab)],_0x3e64f3[_0x45703f(0x1f4)][_0x45703f(0xf16)]=_0x431ba7,_0x4376d8(_0x3e64f3,()=>_0xc902bb(_0x431ba7)),_0x2e0224[_0x45703f(0x1079)](_0x3e64f3),_0x4a3337[_0x45703f(0x8c2)][_0x45703f(0x129e)]({'role':'assistant','content':_0x1b1622[_0x45703f(0x132a)]+':\x20'+_0x1b1622[_0x45703f(0x12ab)],'timestamp':_0x431ba7});const _0x24d49b=_0x4a3337[_0x45703f(0x1008)][_0x45703f(0xb07)](_0x47193e=>_0x47193e[_0x45703f(0x132a)]===_0x1b1622[_0x45703f(0x132a)]);if(_0x24d49b){const _0x190767=document[_0x45703f(0x586)](_0x45703f(0x531)+_0x24d49b['id']+'\x22]\x20.participant-avatar');_0x190767&&(_0x190767[_0x45703f(0x11c2)][_0x45703f(0xa58)]('speaking'),setTimeout(()=>_0x190767[_0x45703f(0x11c2)][_0x45703f(0x1097)](_0x45703f(0x297)),0x7d0));}});}else{const _0x250422=Date[_0x19955f(0x606)](),_0x5996f8=document[_0x19955f(0xe7d)](_0x19955f(0x1323));_0x5996f8[_0x19955f(0x69b)]='call-message-bubble\x20ai-speech',_0x5996f8['textContent']=_0x1eeeda,_0x5996f8[_0x19955f(0x1f4)][_0x19955f(0xf16)]=_0x250422,_0x4376d8(_0x5996f8,()=>_0xc902bb(_0x250422)),_0x2e0224[_0x19955f(0x1079)](_0x5996f8),_0x4a3337[_0x19955f(0x8c2)][_0x19955f(0x129e)]({'role':'assistant','content':_0x1eeeda,'timestamp':_0x250422});const _0x2ce247=document[_0x19955f(0x586)](_0x19955f(0xa70));_0x2ce247&&(_0x2ce247[_0x19955f(0x11c2)][_0x19955f(0xa58)]('speaking'),setTimeout(()=>_0x2ce247[_0x19955f(0x11c2)]['remove'](_0x19955f(0x297)),0x7d0));}_0x2e0224['scrollTop']=_0x2e0224['scrollHeight'];}catch(_0x518741){const _0xf7916d=document['createElement'](_0x19955f(0x1323));_0xf7916d[_0x19955f(0x69b)]=_0x19955f(0xee9),_0xf7916d[_0x19955f(0x1104)]['color']=_0x19955f(0x10f),_0xf7916d[_0x19955f(0x1a2)]=_0x19955f(0x128e)+_0x518741['message']+']',_0x2e0224[_0x19955f(0x1079)](_0xf7916d),_0x2e0224[_0x19955f(0x358)]=_0x2e0224[_0x19955f(0x94b)],_0x4a3337[_0x19955f(0x8c2)][_0x19955f(0x129e)]({'role':_0x19955f(0xac3),'content':_0x19955f(0x128e)+_0x518741['message']+']'});}}function _0x561ecb(_0x5c0fb0){const _0xa96a90=_0x204348;document[_0xa96a90(0x458)](_0xa96a90(0x883))['style']['display']=_0x5c0fb0?'none':_0xa96a90(0x82b),document[_0xa96a90(0x458)](_0xa96a90(0x13ca))[_0xa96a90(0x1104)][_0xa96a90(0x4db)]=_0x5c0fb0?_0xa96a90(0x82b):_0xa96a90(0x464);}async function _0x43dd8d(_0x283d62,_0x4b3234){const _0x40d4af=_0x204348,_0x3e845c=_0x42f206['chats'][_0x42f206[_0x40d4af(0x81d)]];if(!_0x3e845c)return;const _0x1f5daf=_0x3e845c[_0x40d4af(0x1d5)]['findIndex'](_0x2bd15b=>_0x2bd15b[_0x40d4af(0xf16)]===_0x283d62);if(_0x1f5daf===-0x1)return;const _0x417d05=_0x3e845c[_0x40d4af(0x1d5)][_0x1f5daf];_0x417d05['status']=_0x4b3234;let _0x41590f;const _0x17c0e7=_0x3e845c[_0x40d4af(0x726)]?_0x3e845c['settings'][_0x40d4af(0xc7d)]||'我':'我';_0x4b3234===_0x40d4af(0x1467)?(_0x417d05[_0x40d4af(0x167)]=_0x17c0e7,_0x41590f=_0x40d4af(0x39c)+_0x17c0e7+_0x40d4af(0xfd4)+_0x417d05[_0x40d4af(0x2a3)]+_0x40d4af(0x3be)+_0x283d62+_0x40d4af(0xef7)):_0x41590f=_0x40d4af(0x39c)+_0x17c0e7+_0x40d4af(0x6d)+_0x417d05[_0x40d4af(0x2a3)]+'\x20的外卖代付请求（时间戳:\x20'+_0x283d62+_0x40d4af(0xa90);const _0x197bdb={'role':'system','content':_0x41590f,'timestamp':Date['now'](),'isHidden':!![]};_0x3e845c[_0x40d4af(0x1d5)][_0x40d4af(0x129e)](_0x197bdb),await _0x17d534[_0x40d4af(0x954)][_0x40d4af(0xf3f)](_0x3e845c),_0x359c96(_0x42f206[_0x40d4af(0x81d)]),_0x4b3234===_0x40d4af(0x1467)&&_0x3ee822();}async function _0x2ed67a(_0x34bcd5,_0x336adc){const _0x4fc292=_0x204348,_0x5c1db3=_0x42f206[_0x4fc292(0x954)][_0x34bcd5];if(!_0x5c1db3)return;let _0x339a96;_0x5c1db3['isGroup']?_0x339a96=_0x32d364(_0x5c1db3,_0x336adc):_0x339a96=_0x5c1db3['name'];const _0x2a5e62=document[_0x4fc292(0x458)](_0x4fc292(0xb3e));_0x2a5e62[_0x4fc292(0x11c2)][_0x4fc292(0x1097)](_0x4fc292(0x1406)),void _0x2a5e62[_0x4fc292(0x145e)],_0x2a5e62[_0x4fc292(0x11c2)][_0x4fc292(0xa58)]('pat-animation');const _0x281215=await _0x335e57(_0x4fc292(0x118c)+_0x339a96+'”','（可选）输入后缀','',_0x4fc292(0xdd5));if(_0x281215===null)return;const _0x9ef1ba=_0x32d364(_0x5c1db3,_0x42f206[_0x4fc292(0x551)][_0x4fc292(0x308)]),_0x32e144=_0x9ef1ba+_0x4fc292(0x239)+_0x339a96+'”\x20'+_0x281215[_0x4fc292(0x2aa)](),_0xc016ce={'role':_0x4fc292(0x1370),'type':_0x4fc292(0x3bf),'content':_0x32e144,'timestamp':Date[_0x4fc292(0x606)]()};_0x5c1db3[_0x4fc292(0x1d5)][_0x4fc292(0x129e)](_0xc016ce);const _0x41eede=_0x4fc292(0xd80)+_0x9ef1ba+_0x4fc292(0x10e3)+_0x336adc+'）'+_0x281215['trim']()+'。请你对此作出回应。]',_0x2d7457={'role':_0x4fc292(0x1370),'content':_0x41eede,'timestamp':Date[_0x4fc292(0x606)]()+0x1,'isHidden':!![]};_0x5c1db3['history']['push'](_0x2d7457),await _0x17d534[_0x4fc292(0x954)][_0x4fc292(0xf3f)](_0x5c1db3),_0x42f206[_0x4fc292(0x81d)]===_0x34bcd5&&_0x5d5ee2(_0xc016ce,_0x5c1db3),await _0x27be5e();}let _0x1f26f6=null,_0x35df22=![],_0x1e8e3d=new Set();function _0xc902bb(_0x3b5544){const _0x141f01=_0x204348;_0x1f26f6=_0x3b5544,document[_0x141f01(0x458)](_0x141f01(0x85e))[_0x141f01(0x11c2)][_0x141f01(0xa58)]('visible');}function _0x30a3c1(){const _0x56a99a=_0x204348;document[_0x56a99a(0x458)](_0x56a99a(0x85e))['classList'][_0x56a99a(0x1097)](_0x56a99a(0x67d)),_0x1f26f6=null;}async function _0x590b31(){const _0x1755e0=_0x204348;if(!_0x1f26f6)return;const _0x2ec527=_0x1f26f6,_0x143284=_0x4a3337['callHistory'][_0x1755e0(0xb07)](_0x16a70a=>_0x16a70a['timestamp']===_0x2ec527);if(!_0x143284)return;_0x30a3c1();let _0x46430f=_0x143284['content'];if(_0x4a3337[_0x1755e0(0x60a)]&&_0x143284[_0x1755e0(0xaeb)]===_0x1755e0(0xac3)){const _0x2c442f=_0x143284[_0x1755e0(0x1316)][_0x1755e0(0x90b)](':\x20');_0x2c442f['length']>0x1&&(_0x46430f=_0x2c442f[_0x1755e0(0x5b0)](0x1)[_0x1755e0(0x56c)](':\x20'));}const _0x95eade=await _0x335e57('编辑通话消息','在此修改内容...',_0x46430f,_0x1755e0(0xb43));_0x95eade!==null&&await _0x7f67f2(_0x2ec527,_0x95eade);}async function _0x7f67f2(_0x30360f,_0x18c0b1){const _0x2df309=_0x204348,_0x2f37ce=_0x4a3337[_0x2df309(0x8c2)][_0x2df309(0xb07)](_0x171755=>_0x171755[_0x2df309(0xf16)]===_0x30360f);if(_0x2f37ce){let _0x190e44=_0x18c0b1;if(_0x4a3337[_0x2df309(0x60a)]&&_0x2f37ce[_0x2df309(0xaeb)]===_0x2df309(0xac3)){const _0x4df407=_0x2f37ce['content'][_0x2df309(0x90b)](':\x20'),_0x5d48e2=_0x4df407[0x0];_0x190e44=_0x5d48e2+':\x20'+_0x18c0b1;}_0x2f37ce[_0x2df309(0x1316)]=_0x190e44;const _0x488ed6=document[_0x2df309(0x586)](_0x2df309(0xbb6)+_0x30360f+'\x22]');if(_0x488ed6){if(_0x4a3337[_0x2df309(0x60a)]&&_0x2f37ce[_0x2df309(0xaeb)]===_0x2df309(0xac3)){const _0x3217ea=_0x2f37ce[_0x2df309(0x1316)][_0x2df309(0x90b)](':\x20'),_0x3cfe31=_0x3217ea[0x0];_0x488ed6[_0x2df309(0x110d)]=_0x2df309(0xc15)+_0x3cfe31+_0x2df309(0x135a)+_0x18c0b1;}else _0x488ed6[_0x2df309(0x1a2)]=_0x18c0b1;}}await _0x34fce8('成功','通话消息已更新！');}async function _0x3a1dbf(){const _0x134ff1=_0x204348;if(!_0x1f26f6)return;const _0x1768a5=await _0x2532b9(_0x134ff1(0x28e),'确定要删除这条通话消息吗？',{'confirmButtonClass':_0x134ff1(0x4d3)});if(_0x1768a5){const _0xb12b93=_0x1f26f6;_0x30a3c1();const _0xa81a36=_0x4a3337['callHistory']['findIndex'](_0x690443=>_0x690443[_0x134ff1(0xf16)]===_0xb12b93);_0xa81a36>-0x1&&_0x4a3337['callHistory'][_0x134ff1(0x9cf)](_0xa81a36,0x1);const _0x199bae=document[_0x134ff1(0x586)]('.call-message-bubble[data-timestamp=\x22'+_0xb12b93+'\x22]');_0x199bae&&_0x199bae[_0x134ff1(0x1097)]();}else _0x30a3c1();}function _0x6e71(_0x20fa0c){const _0xe6cf6b=_0x204348;_0x883477=_0x20fa0c;const _0x1aa8c0=_0x42f206['chats'][_0x42f206['activeChatId']],_0x3d4c32=_0x1aa8c0[_0xe6cf6b(0x1d5)][_0xe6cf6b(0xb07)](_0x255837=>_0x255837[_0xe6cf6b(0xf16)]===_0x20fa0c);_0x3d4c32&&(document['getElementById']('transfer-sender-name')[_0xe6cf6b(0x1a2)]=_0x3d4c32['senderName']),document[_0xe6cf6b(0x458)](_0xe6cf6b(0x3f1))['classList'][_0xe6cf6b(0xa58)]('visible');}function _0x455e8d(){const _0x3e5aa1=_0x204348;document['getElementById'](_0x3e5aa1(0x3f1))[_0x3e5aa1(0x11c2)][_0x3e5aa1(0x1097)]('visible'),_0x883477=null;}async function _0x547e97(_0xe89bc8){const _0x4821a8=_0x204348;if(!_0x883477)return;const _0x2dd607=_0x883477,_0x439ae4=_0x42f206['chats'][_0x42f206['activeChatId']],_0xfbe78e=_0x439ae4[_0x4821a8(0x1d5)][_0x4821a8(0x4a8)](_0xb55be1=>_0xb55be1['timestamp']===_0x2dd607);if(_0xfbe78e===-0x1)return;const _0x5619ed=_0x439ae4[_0x4821a8(0x1d5)][_0xfbe78e];_0x5619ed[_0x4821a8(0x13b2)]=_0xe89bc8;let _0x1fe5e8;if(_0xe89bc8==='declined'){const _0xc7efe3={'role':_0x4821a8(0xf86),'type':_0x4821a8(0xf4e),'isRefund':!![],'amount':_0x5619ed[_0x4821a8(0x116)],'note':_0x4821a8(0x9f5),'timestamp':Date[_0x4821a8(0x606)]()};_0x439ae4['history'][_0x4821a8(0x129e)](_0xc7efe3),_0x1fe5e8='[系统提示：你拒绝并退还了“'+_0x5619ed['senderName']+_0x4821a8(0xf2f);}else _0x1fe5e8=_0x4821a8(0xf49)+_0x5619ed[_0x4821a8(0x2a3)]+_0x4821a8(0xf2f);const _0x333240={'role':_0x4821a8(0x1370),'content':_0x1fe5e8,'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x439ae4[_0x4821a8(0x1d5)][_0x4821a8(0x129e)](_0x333240),await _0x17d534['chats'][_0x4821a8(0xf3f)](_0x439ae4),_0x455e8d(),_0x359c96(_0x42f206['activeChatId']),_0x27be5e();}function _0x1c15cf(_0x23c297){const _0x5b931e=_0x204348;_0x22febf=null;if(_0x23c297){const _0x51b720=_0x23c297['querySelector'](_0x5b931e(0x118a));_0x51b720&&(_0x51b720[_0x5b931e(0x134b)]=_0x5b931e(0x7be));}}async function _0x17ca04(){const _0x551e70=_0x204348,_0xb004b=document[_0x551e70(0x458)](_0x551e70(0x138));_0xb004b[_0x551e70(0x110d)]='';const _0x48f1ae=await _0x17d534['memories'][_0x551e70(0x50b)]('timestamp')[_0x551e70(0x115b)]()['toArray']();if(_0x48f1ae[_0x551e70(0x131d)]===0x0){_0xb004b[_0x551e70(0x110d)]=_0x551e70(0x491);return;}_0x48f1ae[_0x551e70(0xc12)]((_0x31c5e3,_0x44c16e)=>{const _0x524ca0=_0x551e70,_0x5c6640=_0x31c5e3[_0x524ca0(0x259)]==='countdown'&&_0x31c5e3['targetDate']>Date[_0x524ca0(0x606)](),_0x1335fe=_0x44c16e[_0x524ca0(0x259)]===_0x524ca0(0x536)&&_0x44c16e['targetDate']>Date['now']();if(_0x5c6640&&!_0x1335fe)return-0x1;if(!_0x5c6640&&_0x1335fe)return 0x1;if(_0x5c6640&&_0x1335fe)return _0x31c5e3[_0x524ca0(0x12bf)]-_0x44c16e[_0x524ca0(0x12bf)];return 0x0;}),_0x48f1ae[_0x551e70(0x12c2)](_0x2bafbe=>{const _0xc019cc=_0x551e70;let _0x113cb4;_0x2bafbe['type']===_0xc019cc(0x536)&&_0x2bafbe['targetDate']>Date[_0xc019cc(0x606)]()?_0x113cb4=_0x83d9b6(_0x2bafbe):_0x113cb4=_0x5868a1(_0x2bafbe),_0xb004b[_0xc019cc(0x1079)](_0x113cb4);}),_0x577808();}function _0x5868a1(_0x1f4b4e){const _0x17212d=_0x204348,_0x3b0daa=document[_0x17212d(0xe7d)]('div');_0x3b0daa['className']='memory-card';const _0x1f350f=new Date(_0x1f4b4e['timestamp']),_0x58978a=_0x1f350f[_0x17212d(0xc2a)]()+'-'+String(_0x1f350f['getMonth']()+0x1)[_0x17212d(0x508)](0x2,'0')+'-'+String(_0x1f350f[_0x17212d(0x14c)]())[_0x17212d(0x508)](0x2,'0')+'\x20'+String(_0x1f350f[_0x17212d(0x748)]())[_0x17212d(0x508)](0x2,'0')+':'+String(_0x1f350f[_0x17212d(0x121a)]())[_0x17212d(0x508)](0x2,'0');let _0x510524,_0x1deb72;if(_0x1f4b4e[_0x17212d(0x259)]===_0x17212d(0x536)&&_0x1f4b4e['targetDate'])_0x510524=_0x17212d(0x5d0)+_0x1f4b4e[_0x17212d(0x4e9)],_0x1deb72=_0x5c8590('在\x20'+new Date(_0x1f4b4e[_0x17212d(0x12bf)])[_0x17212d(0xe43)]()+_0x17212d(0x1439))['replace'](/\n/g,_0x17212d(0x1208));else{let _0x3a0a42=_0x17212d(0x8c1);if(_0x1f4b4e[_0x17212d(0x1086)]){const _0x2731aa=_0x42f206[_0x17212d(0x954)][_0x1f4b4e[_0x17212d(0x1086)]];_0x2731aa?_0x3a0a42=_0x2731aa[_0x17212d(0x132a)]:_0x3a0a42=_0x1f4b4e['authorName']||_0x17212d(0x366);}else _0x1f4b4e['authorName']&&(_0x3a0a42=_0x1f4b4e['authorName']);_0x510524=_0x3a0a42+'\x20的日记',_0x1deb72=_0x5c8590(_0x1f4b4e[_0x17212d(0x4e9)]);}return _0x3b0daa[_0x17212d(0x110d)]=_0x17212d(0x1214)+_0x58978a+_0x17212d(0x113d)+_0x510524+_0x17212d(0x566)+_0x1deb72+_0x17212d(0x12c5),_0x4376d8(_0x3b0daa,async()=>{const _0x6fa96b=_0x17212d,_0x303810=await _0x2532b9(_0x6fa96b(0x51b),'确定要删除这条记录吗？',{'confirmButtonClass':_0x6fa96b(0x4d3)});_0x303810&&(await _0x17d534[_0x6fa96b(0x414)][_0x6fa96b(0x195)](_0x1f4b4e['id']),_0x17ca04());}),_0x3b0daa;}function _0x83d9b6(_0x1978be){const _0x58a5bb=_0x204348,_0x27750a=document['createElement']('div');_0x27750a['className']='countdown-card';const _0x2e6f08=new Date(_0x1978be['targetDate']),_0x50b5aa=_0x2e6f08['toLocaleString'](_0x58a5bb(0xaa2),{'dateStyle':'full','timeStyle':_0x58a5bb(0xabe)});return _0x27750a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x1978be[_0x58a5bb(0x4e9)]+_0x58a5bb(0x132d)+_0x1978be[_0x58a5bb(0x12bf)]+_0x58a5bb(0x1337)+_0x50b5aa+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4376d8(_0x27750a,async()=>{const _0x522365=_0x58a5bb,_0x5062aa=await _0x2532b9('删除约定',_0x522365(0x725),{'confirmButtonClass':_0x522365(0x4d3)});_0x5062aa&&(await _0x17d534[_0x522365(0x414)][_0x522365(0x195)](_0x1978be['id']),_0x17ca04());}),_0x27750a;}let _0x4d37ba=[];function _0x577808(){const _0x5aca19=_0x204348;_0x4d37ba[_0x5aca19(0x12c2)](_0x2213ef=>clearInterval(_0x2213ef)),_0x4d37ba=[],document[_0x5aca19(0x102a)](_0x5aca19(0x127b))[_0x5aca19(0x12c2)](_0xb8155f=>{const _0x2919bb=_0x5aca19,_0x13bf9e=parseInt(_0xb8155f['dataset'][_0x2919bb(0x12bf)]);let _0x495c1c;const _0x12cd7a=()=>{const _0x4a3648=_0x2919bb,_0x53674d=Date[_0x4a3648(0x606)](),_0x594225=_0x13bf9e-_0x53674d;if(_0x594225<0x0){_0xb8155f[_0x4a3648(0x1a2)]=_0x4a3648(0xd51),clearInterval(_0x495c1c),setTimeout(()=>_0x17ca04(),0x7d0);return;}const _0x117d0d=Math[_0x4a3648(0xbd5)](_0x594225/(0x3e8*0x3c*0x3c*0x18)),_0x40352e=Math[_0x4a3648(0xbd5)](_0x594225%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x2b23ae=Math[_0x4a3648(0xbd5)](_0x594225%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0xb25a74=Math['floor'](_0x594225%(0x3e8*0x3c)/0x3e8);_0xb8155f[_0x4a3648(0x1a2)]=_0x117d0d+'天\x20'+_0x40352e+'时\x20'+_0x2b23ae+'分\x20'+_0xb25a74+'秒';};_0x12cd7a(),_0x495c1c=setInterval(_0x12cd7a,0x3e8),_0x4d37ba[_0x2919bb(0x129e)](_0x495c1c);});}async function _0x1613f7(_0x703966){const _0x2086d3=_0x204348,_0x58661f=_0x42f206[_0x2086d3(0x954)][_0x703966];if(!_0x58661f)return;await _0x34fce8(_0x2086d3(0xc69),_0x2086d3(0x250)+_0x58661f[_0x2086d3(0x132a)]+_0x2086d3(0xad6));const {proxyUrl:_0x27c600,apiKey:_0x121b63,model:_0x170b31}=_0x42f206[_0x2086d3(0x5cb)];if(!_0x27c600||!_0x121b63||!_0x170b31){await _0x34fce8(_0x2086d3(0x1012),_0x2086d3(0x4fe));return;}const _0x452f5d=_0x58661f[_0x2086d3(0x1d5)][_0x2086d3(0x5b0)](-0x5)[_0x2086d3(0xbf6)](_0x5aac11=>{const _0x4135e9=_0x2086d3,_0x1b949b=_0x5aac11['role']===_0x4135e9(0xf86)?_0x58661f[_0x4135e9(0xda2)][_0x4135e9(0xc7d)]||'我':_0x5aac11['senderName']||_0x58661f[_0x4135e9(0x132a)];return _0x1b949b+':\x20'+String(_0x5aac11[_0x4135e9(0x1316)])[_0x4135e9(0xa6d)](0x0,0x32)+_0x4135e9(0x10a0);})[_0x2086d3(0x56c)]('\x0a');let _0x3e97db='';if(_0x58661f[_0x2086d3(0xda2)][_0x2086d3(0x315)]&&_0x58661f[_0x2086d3(0xda2)][_0x2086d3(0x315)][_0x2086d3(0x131d)]>0x0){const _0x492e53=_0x58661f[_0x2086d3(0xda2)][_0x2086d3(0x315)][_0x2086d3(0xbf6)](_0x2c40d3=>{const _0x195344=_0x2086d3,_0x413b99=_0x42f206[_0x195344(0xab7)][_0x195344(0xb07)](_0xb64d76=>_0xb64d76['id']===_0x2c40d3);if(!_0x413b99||!Array[_0x195344(0x971)](_0x413b99[_0x195344(0x1316)]))return'';const _0x12360c=_0x413b99['content'][_0x195344(0xbf6)](_0x531f8c=>{const _0x5b6181=_0x195344;let _0x271c4c='\x0a###\x20条目:\x20'+(_0x531f8c[_0x5b6181(0xcb4)]||_0x5b6181(0xfdc))+'\x0a';return _0x531f8c[_0x5b6181(0x634)][_0x5b6181(0x131d)]>0x0&&(_0x271c4c+=_0x5b6181(0xe8c)+_0x531f8c[_0x5b6181(0x634)][_0x5b6181(0x56c)](',\x20')+'\x0a'),_0x271c4c+=_0x5b6181(0xcdf)+_0x531f8c[_0x5b6181(0x1316)],_0x271c4c;})[_0x195344(0x56c)]('\x0a');return _0x12360c?_0x195344(0x64a)+_0x413b99[_0x195344(0x132a)]+'\x0a'+_0x12360c:'';})['filter'](Boolean)['join']('');_0x492e53&&(_0x3e97db='\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a'+_0x492e53+'\x0a');}const _0x197271=_0x2086d3(0x477)+_0x58661f[_0x2086d3(0x132a)]+_0x2086d3(0x1247)+_0x58661f['settings'][_0x2086d3(0x31d)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3e97db+_0x2086d3(0x48b)+_0x452f5d+_0x2086d3(0x1333);try{const _0x3b1bea=[{'role':_0x2086d3(0x1370),'content':_0x197271},{'role':_0x2086d3(0xf86),'content':_0x2086d3(0xaff)}];let _0x5084c7=_0x27c600===GEMINI_API_URL,_0x268cc5=_0x5d73db(_0x170b31,_0x121b63,_0x197271,_0x3b1bea);const _0x2dd1c0=_0x5084c7?await fetch(_0x268cc5[_0x2086d3(0x1377)],_0x268cc5[_0x2086d3(0x76b)]):await fetch(_0x27c600+_0x2086d3(0xd7),{'method':_0x2086d3(0x1312),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x121b63},'body':JSON[_0x2086d3(0xc04)]({'model':_0x170b31,'messages':_0x3b1bea,'temperature':_0x42f206[_0x2086d3(0xf0)][_0x2086d3(0xfdf)]||0.9})});if(!_0x2dd1c0['ok']){const _0x2a7881=await _0x2dd1c0[_0x2086d3(0xaef)]();throw new Error('API\x20请求失败:\x20'+_0x2dd1c0[_0x2086d3(0x13b2)]+_0x2086d3(0x7da)+_0x2a7881[_0x2086d3(0xb61)][_0x2086d3(0x7aa)]);}const _0x370a90=await _0x2dd1c0[_0x2086d3(0xaef)]();let _0x558f36=_0x5084c7?_0x370a90[_0x2086d3(0x116f)][0x0][_0x2086d3(0x1316)][_0x2086d3(0xc00)][0x0][_0x2086d3(0xdd5)]:_0x370a90[_0x2086d3(0x2f9)][0x0][_0x2086d3(0x7aa)][_0x2086d3(0x1316)];_0x558f36=_0x558f36[_0x2086d3(0x33b)](/^```json\s*/,'')['replace'](/```$/,'');const _0x566c8a=_0x558f36['trim'](),_0xaedd40=JSON[_0x2086d3(0x44c)](_0x566c8a);_0xaedd40['decision']===_0x2086d3(0xc3e)&&_0xaedd40[_0x2086d3(0x14e)]?(_0x58661f[_0x2086d3(0x569)][_0x2086d3(0x13b2)]=_0x2086d3(0x1321),_0x58661f[_0x2086d3(0x569)]['applicationReason']=_0xaedd40[_0x2086d3(0x14e)],_0x42f206[_0x2086d3(0x954)][_0x703966]=_0x58661f,_0x27be5e(),await _0x34fce8(_0x2086d3(0x372),'“'+_0x58661f['name']+_0x2086d3(0x1fe))):(await _0x34fce8(_0x2086d3(0x1257),'“'+_0x58661f[_0x2086d3(0x132a)]+_0x2086d3(0x1149)),_0x58661f[_0x2086d3(0x569)][_0x2086d3(0x13b2)]=_0x2086d3(0x12e4),_0x58661f['relationship'][_0x2086d3(0x1230)]=Date['now']());}catch(_0x1b8b60){await _0x34fce8(_0x2086d3(0xc35),'为“'+_0x58661f[_0x2086d3(0x132a)]+_0x2086d3(0x13e7)+_0x1b8b60[_0x2086d3(0x7aa)]+'\x0a\x0a将重置冷静期。'),_0x58661f[_0x2086d3(0x569)]['status']=_0x2086d3(0x12e4),_0x58661f['relationship'][_0x2086d3(0x1230)]=Date['now']();}finally{await _0x17d534[_0x2086d3(0x954)][_0x2086d3(0xf3f)](_0x58661f),_0x359c96(_0x703966);}}function _0x169b48(){const _0x18756c=_0x204348;if(!_0x42f206['activeChatId'])return;const _0x21d80d=_0x42f206[_0x18756c(0x954)][_0x42f206[_0x18756c(0x81d)]];_0x21d80d[_0x18756c(0x726)]?_0x48187d():document[_0x18756c(0x458)](_0x18756c(0x1156))[_0x18756c(0x11c2)][_0x18756c(0xa58)](_0x18756c(0x67d));}function _0x48187d(){const _0x33562f=_0x204348,_0x4fe317=document[_0x33562f(0x458)]('red-packet-modal'),_0x2f56db=_0x42f206['chats'][_0x42f206[_0x33562f(0x81d)]];document['getElementById']('rp-group-amount')[_0x33562f(0x8dd)]='',document[_0x33562f(0x458)](_0x33562f(0x8d9))['value']='',document['getElementById']('rp-group-greeting')[_0x33562f(0x8dd)]='',document['getElementById'](_0x33562f(0x124e))[_0x33562f(0x8dd)]='',document['getElementById'](_0x33562f(0x1c7))[_0x33562f(0x8dd)]='',document[_0x33562f(0x458)]('rp-group-total')[_0x33562f(0x1a2)]=_0x33562f(0x8e4),document[_0x33562f(0x458)](_0x33562f(0x131c))['textContent']=_0x33562f(0x8e4);const _0x2c3133=document[_0x33562f(0x458)](_0x33562f(0x340));_0x2c3133[_0x33562f(0x110d)]='',_0x2f56db[_0x33562f(0xfa8)][_0x33562f(0x12c2)](_0x5df333=>{const _0x87a59a=_0x33562f,_0x16c8f3=document[_0x87a59a(0xe7d)]('option');_0x16c8f3[_0x87a59a(0x8dd)]=_0x5df333[_0x87a59a(0xa1)],_0x16c8f3[_0x87a59a(0x1a2)]=_0x5df333[_0x87a59a(0x1118)],_0x2c3133['appendChild'](_0x16c8f3);}),document[_0x33562f(0x458)](_0x33562f(0x2f4))[_0x33562f(0x1122)](),_0x4fe317[_0x33562f(0x11c2)][_0x33562f(0xa58)](_0x33562f(0x67d));}async function _0x2e6c96(){const _0x36ceb9=_0x204348,_0x2f2990=_0x42f206[_0x36ceb9(0x954)][_0x42f206['activeChatId']],_0x2db5dd=parseFloat(document[_0x36ceb9(0x458)](_0x36ceb9(0x314))[_0x36ceb9(0x8dd)]),_0x50f351=parseInt(document[_0x36ceb9(0x458)](_0x36ceb9(0x8d9))[_0x36ceb9(0x8dd)]),_0x25062b=document[_0x36ceb9(0x458)](_0x36ceb9(0x1c8))['value'][_0x36ceb9(0x2aa)]();if(isNaN(_0x2db5dd)||_0x2db5dd<=0x0){alert(_0x36ceb9(0x959));return;}if(isNaN(_0x50f351)||_0x50f351<=0x0){alert('请输入有效的红包个数！');return;}if(_0x2db5dd/_0x50f351<0.01){alert(_0x36ceb9(0x2e9));return;}const _0x401056=_0x2f2990[_0x36ceb9(0xda2)][_0x36ceb9(0xc7d)]||'我',_0x2a5b71={'role':_0x36ceb9(0xf86),'senderName':_0x401056,'type':_0x36ceb9(0xd9e),'packetType':_0x36ceb9(0x345),'timestamp':Date['now'](),'totalAmount':_0x2db5dd,'count':_0x50f351,'greeting':_0x25062b||_0x36ceb9(0x98f),'claimedBy':{},'isFullyClaimed':![]};_0x2f2990[_0x36ceb9(0x1d5)][_0x36ceb9(0x129e)](_0x2a5b71),await _0x17d534[_0x36ceb9(0x954)][_0x36ceb9(0xf3f)](_0x2f2990),_0x5d5ee2(_0x2a5b71,_0x2f2990),_0x27be5e(),document['getElementById'](_0x36ceb9(0x609))['classList'][_0x36ceb9(0x1097)]('visible');}async function _0x28e1ba(){const _0x4c1e35=_0x204348,_0xdb1033=_0x42f206[_0x4c1e35(0x954)][_0x42f206[_0x4c1e35(0x81d)]],_0x277017=parseFloat(document[_0x4c1e35(0x458)]('rp-direct-amount')[_0x4c1e35(0x8dd)]),_0x4d4378=document[_0x4c1e35(0x458)]('rp-direct-receiver')[_0x4c1e35(0x8dd)],_0x4e599d=document[_0x4c1e35(0x458)](_0x4c1e35(0x1c7))[_0x4c1e35(0x8dd)][_0x4c1e35(0x2aa)]();if(isNaN(_0x277017)||_0x277017<=0x0){alert(_0x4c1e35(0xf32));return;}if(!_0x4d4378){alert(_0x4c1e35(0x11b1));return;}const _0x169fec=_0xdb1033[_0x4c1e35(0xda2)][_0x4c1e35(0xc7d)]||'我',_0x29eee2={'role':_0x4c1e35(0xf86),'senderName':_0x169fec,'type':_0x4c1e35(0xd9e),'packetType':_0x4c1e35(0x1205),'timestamp':Date[_0x4c1e35(0x606)](),'totalAmount':_0x277017,'count':0x1,'greeting':_0x4e599d||_0x4c1e35(0xabd),'receiverName':_0x4d4378,'claimedBy':{},'isFullyClaimed':![]};_0xdb1033['history'][_0x4c1e35(0x129e)](_0x29eee2),await _0x17d534[_0x4c1e35(0x954)][_0x4c1e35(0xf3f)](_0xdb1033),_0x5d5ee2(_0x29eee2,_0xdb1033),_0x27be5e(),document[_0x4c1e35(0x458)](_0x4c1e35(0x609))[_0x4c1e35(0x11c2)][_0x4c1e35(0x1097)](_0x4c1e35(0x67d));}async function _0x442c2e(_0x4d7291){const _0x40e282=_0x204348,_0x347bb3=_0x42f206['activeChatId'],_0x3b2744=await _0x17d534['chats']['get'](_0x347bb3);if(!_0x3b2744)return;_0x42f206[_0x40e282(0x954)][_0x347bb3]=_0x3b2744;const _0x3a6fa7=_0x3b2744[_0x40e282(0x1d5)][_0x40e282(0xb07)](_0x3c3ff8=>_0x3c3ff8['timestamp']===_0x4d7291);if(!_0x3a6fa7)return;const _0x1d6635=_0x42f206[_0x40e282(0x551)]['nickname']||_0x40e282(0x852),_0x4e82d6=_0x3a6fa7['claimedBy']&&_0x3a6fa7[_0x40e282(0xcd4)][_0x1d6635];if(_0x3a6fa7[_0x40e282(0xd83)]===_0x40e282(0x1205)&&_0x3a6fa7[_0x40e282(0x1421)]!==_0x1d6635&&Object[_0x40e282(0x634)](_0x3a6fa7['claimedBy'])[_0x40e282(0x131d)]>0x0||_0x3a6fa7[_0x40e282(0x1258)]||_0x4e82d6){_0x3cdf3c(_0x3a6fa7);return;}const _0x346728=await _0x21a402(_0x3a6fa7);_0x346728!==null&&(await _0x359c96(_0x347bb3),await _0x34fce8(_0x40e282(0x3b0),_0x40e282(0x70a)+_0x32d364(_0x3b2744,_0x3a6fa7['senderName'])+_0x40e282(0xe6f)+_0x346728[_0x40e282(0x800)](0x2)+_0x40e282(0x12a3)));const _0x167f2e=_0x42f206[_0x40e282(0x954)][_0x347bb3][_0x40e282(0x1d5)][_0x40e282(0xb07)](_0x3609cd=>_0x3609cd[_0x40e282(0xf16)]===_0x4d7291);_0x167f2e&&_0x3cdf3c(_0x167f2e);}async function _0x21a402(_0x4f58d5){const _0xe421e4=_0x204348,_0x26351c=_0x42f206['chats'][_0x42f206[_0xe421e4(0x81d)]];let _0x1423fc=Date['now']();const _0xa3e1b0=_0x42f206[_0xe421e4(0x551)][_0xe421e4(0x308)]||'{{user}}',_0x5349fe=_0x4f58d5[_0xe421e4(0x1e5)]-Object[_0xe421e4(0x634)](_0x4f58d5[_0xe421e4(0xcd4)]||{})[_0xe421e4(0x131d)];if(_0x5349fe<=0x0)return _0x4f58d5['isFullyClaimed']=!![],await _0x17d534[_0xe421e4(0x954)][_0xe421e4(0xf3f)](_0x26351c),await _0x34fce8(_0xe421e4(0x502),_0xe421e4(0x66a)),null;let _0x34522a=0x0;const _0xebbd4d=_0x4f58d5[_0xe421e4(0xd2c)]-Object[_0xe421e4(0x6eb)](_0x4f58d5[_0xe421e4(0xcd4)]||{})[_0xe421e4(0x1450)]((_0x3a492d,_0x5b4fa7)=>_0x3a492d+_0x5b4fa7,0x0);if(_0x4f58d5[_0xe421e4(0xd83)]==='lucky'){if(_0x5349fe===0x1)_0x34522a=_0xebbd4d;else{const _0x4865b0=0.01,_0x3e0226=_0xebbd4d-(_0x5349fe-0x1)*_0x4865b0;_0x34522a=Math['random']()*(_0x3e0226-_0x4865b0)+_0x4865b0;}}else _0x34522a=_0x4f58d5[_0xe421e4(0xd2c)];_0x34522a=parseFloat(_0x34522a[_0xe421e4(0x800)](0x2));if(!_0x4f58d5[_0xe421e4(0xcd4)])_0x4f58d5[_0xe421e4(0xcd4)]={};_0x4f58d5['claimedBy'][_0xa3e1b0]=_0x34522a;const _0x4e9c28=Object[_0xe421e4(0x634)](_0x4f58d5[_0xe421e4(0xcd4)])['length']>=_0x4f58d5[_0xe421e4(0x1e5)];_0x4e9c28&&(_0x4f58d5[_0xe421e4(0x1258)]=!![]);const _0x1a75d4=_0x32d364(_0x26351c,_0xa3e1b0),_0x450b35=_0x32d364(_0x26351c,_0x4f58d5[_0xe421e4(0x2a3)]),_0x4c304b={'role':_0xe421e4(0x1370),'type':_0xe421e4(0x3bf),'content':_0xe421e4(0x70a)+_0x450b35+_0xe421e4(0x3b7),'timestamp':_0x1423fc++};_0x26351c[_0xe421e4(0x1d5)]['push'](_0x4c304b);let _0x35838f;if(_0x4e9c28){const _0x40f8e9={'role':_0xe421e4(0x1370),'type':'pat_message','content':_0x450b35+_0xe421e4(0x16b),'timestamp':_0x1423fc++};_0x26351c[_0xe421e4(0x1d5)][_0xe421e4(0x129e)](_0x40f8e9);let _0x35318a={'name':'','amount':-0x1};_0x4f58d5[_0xe421e4(0xd83)]===_0xe421e4(0x345)&&_0x4f58d5[_0xe421e4(0x1e5)]>0x1&&Object[_0xe421e4(0x1309)](_0x4f58d5[_0xe421e4(0xcd4)])[_0xe421e4(0x12c2)](([_0x1a51a1,_0x5b0693])=>{const _0x4e3495=_0xe421e4;_0x5b0693>_0x35318a[_0x4e3495(0x116)]&&(_0x35318a={'name':_0x1a51a1,'amount':_0x5b0693});});const _0x4b03cc=_0x35318a[_0xe421e4(0x132a)]?_0x32d364(_0x26351c,_0x35318a[_0xe421e4(0x132a)]):'无';_0x35838f=_0xe421e4(0x10b)+_0x1a75d4+')\x20领取了最后一个红包。红包已被领完，手气王是\x20'+_0x4b03cc+'！请对此事件发表评论。]';}else _0x35838f=_0xe421e4(0x10b)+_0x1a75d4+_0xe421e4(0x632)+_0x4f58d5[_0xe421e4(0xf16)]+')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]';const _0x42cec2={'role':_0xe421e4(0x1370),'content':_0x35838f,'timestamp':_0x1423fc++,'isHidden':!![]};return _0x26351c[_0xe421e4(0x1d5)][_0xe421e4(0x129e)](_0x42cec2),await _0x17d534['chats'][_0xe421e4(0xf3f)](_0x26351c),_0x34522a;}async function _0x3cdf3c(_0x4f4d2d){const _0x4a06e2=_0x204348;if(!_0x4f4d2d){console[_0x4a06e2(0xb61)](_0x4a06e2(0xa76));return;}const _0x14f2fc=_0x42f206[_0x4a06e2(0x954)][_0x42f206[_0x4a06e2(0x81d)]];if(!_0x14f2fc)return;const _0x11e8e7=document['getElementById'](_0x4a06e2(0x521)),_0xe628a4=_0x42f206[_0x4a06e2(0x551)][_0x4a06e2(0x308)]||'{{user}}',_0x5966cc=_0x32d364(_0x14f2fc,_0x4f4d2d[_0x4a06e2(0x2a3)]);document['getElementById'](_0x4a06e2(0x12ef))[_0x4a06e2(0x1a2)]=_0x5966cc,document[_0x4a06e2(0x458)](_0x4a06e2(0x7f7))['textContent']=_0x4f4d2d[_0x4a06e2(0xf77)]||_0x4a06e2(0x98f);const _0xd3ed28=document[_0x4a06e2(0x458)](_0x4a06e2(0x267));_0x4f4d2d[_0x4a06e2(0xcd4)]&&_0x4f4d2d[_0x4a06e2(0xcd4)][_0xe628a4]?(_0xd3ed28[_0x4a06e2(0x586)]('span:first-child')[_0x4a06e2(0x1a2)]=_0x4f4d2d[_0x4a06e2(0xcd4)][_0xe628a4][_0x4a06e2(0x800)](0x2),_0xd3ed28[_0x4a06e2(0x1104)][_0x4a06e2(0x4db)]=_0x4a06e2(0x1188)):_0xd3ed28[_0x4a06e2(0x1104)]['display']='none';const _0x11e93a=Object[_0x4a06e2(0x634)](_0x4f4d2d['claimedBy']||{})['length'],_0x38b07f=Object[_0x4a06e2(0x6eb)](_0x4f4d2d[_0x4a06e2(0xcd4)]||{})[_0x4a06e2(0x1450)]((_0x18ecad,_0x48ec54)=>_0x18ecad+_0x48ec54,0x0);let _0x406e6d=_0x11e93a+'/'+_0x4f4d2d[_0x4a06e2(0x1e5)]+_0x4a06e2(0xc60)+_0x38b07f[_0x4a06e2(0x800)](0x2)+'/'+_0x4f4d2d[_0x4a06e2(0xd2c)][_0x4a06e2(0x800)](0x2)+'元。';if(!_0x4f4d2d[_0x4a06e2(0x1258)]&&_0x11e93a<_0x4f4d2d[_0x4a06e2(0x1e5)]){const _0x5b98af=Math[_0x4a06e2(0xbd5)]((_0x4f4d2d[_0x4a06e2(0xf16)]+0x18*0x3c*0x3c*0x3e8-Date[_0x4a06e2(0x606)]())/(0x3e8*0x3c*0x3c));if(_0x5b98af>0x0)_0x406e6d+=_0x4a06e2(0x2de)+_0x5b98af+_0x4a06e2(0x3e1);}document[_0x4a06e2(0x458)](_0x4a06e2(0x12e1))[_0x4a06e2(0x1a2)]=_0x406e6d;const _0x5eb256=document[_0x4a06e2(0x458)](_0x4a06e2(0xc21));_0x5eb256[_0x4a06e2(0x110d)]='';const _0x2da239=Object[_0x4a06e2(0x1309)](_0x4f4d2d[_0x4a06e2(0xcd4)]||{});let _0x531972={'name':'','amount':-0x1};_0x4f4d2d[_0x4a06e2(0xd83)]===_0x4a06e2(0x345)&&_0x4f4d2d[_0x4a06e2(0x1258)]&&_0x2da239['length']>0x1&&_0x2da239[_0x4a06e2(0x12c2)](([_0x20a211,_0x48e8b3])=>{const _0x17ecd9=_0x4a06e2;_0x48e8b3>_0x531972[_0x17ecd9(0x116)]&&(_0x531972={'name':_0x20a211,'amount':_0x48e8b3});}),_0x2da239[_0x4a06e2(0xc12)]((_0x3727e7,_0x30e08d)=>_0x30e08d[0x1]-_0x3727e7[0x1]),_0x2da239['forEach'](([_0x27b759,_0x1f1258])=>{const _0x2a672e=_0x4a06e2,_0x186e01=document[_0x2a672e(0xe7d)](_0x2a672e(0x1323));_0x186e01[_0x2a672e(0x69b)]=_0x2a672e(0xe07);let _0x13a025='';_0x531972[_0x2a672e(0x132a)]&&_0x27b759===_0x531972[_0x2a672e(0x132a)]&&(_0x13a025='<span\x20class=\x22lucky-king-tag\x22>手气王</span>');const _0x3b009a=_0x32d364(_0x14f2fc,_0x27b759);_0x186e01[_0x2a672e(0x110d)]=_0x2a672e(0x30d)+_0x3b009a+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>'+_0x1f1258[_0x2a672e(0x800)](0x2)+_0x2a672e(0x63b)+_0x13a025+_0x2a672e(0x8c3),_0x5eb256[_0x2a672e(0x1079)](_0x186e01);}),_0x11e8e7[_0x4a06e2(0x11c2)]['add']('visible');}document['getElementById'](_0x204348(0xa85))[_0x204348(0xd85)](_0x204348(0x1122),()=>{const _0x22ba29=_0x204348;document[_0x22ba29(0x458)]('red-packet-details-modal')[_0x22ba29(0x11c2)]['remove']('visible');}),window[_0x204348(0x1003)]=_0x442c2e;function _0x441c13(){const _0x24fc8a=_0x204348,_0x468f1e=document[_0x24fc8a(0x458)](_0x24fc8a(0x1099));document[_0x24fc8a(0x458)]('poll-question-input')['value']='';const _0x5a09e5=document[_0x24fc8a(0x458)]('poll-options-container');_0x5a09e5['innerHTML']='',_0x4a213a(),_0x4a213a(),_0x468f1e[_0x24fc8a(0x11c2)][_0x24fc8a(0xa58)](_0x24fc8a(0x67d));}function _0x4a213a(){const _0x38718d=_0x204348,_0x100923=document[_0x38718d(0x458)](_0x38718d(0xb4f)),_0x5a7995=document[_0x38718d(0xe7d)](_0x38718d(0x1323));_0x5a7995['className']='poll-option-input-wrapper',_0x5a7995['innerHTML']=_0x38718d(0x1076),_0x5a7995['querySelector']('.remove-option-btn')[_0x38718d(0xd85)](_0x38718d(0x1122),()=>{const _0x52f95e=_0x38718d;_0x100923[_0x52f95e(0xf2e)][_0x52f95e(0x131d)]>0x2?_0x5a7995[_0x52f95e(0x1097)]():alert(_0x52f95e(0x832));}),_0x100923[_0x38718d(0x1079)](_0x5a7995);}async function _0x511d74(){const _0x2d6151=_0x204348;if(!_0x42f206[_0x2d6151(0x81d)])return;const _0x1ca7fa=document['getElementById'](_0x2d6151(0x1089))[_0x2d6151(0x8dd)][_0x2d6151(0x2aa)]();if(!_0x1ca7fa){alert(_0x2d6151(0x11ea));return;}const _0x3b67b4=Array[_0x2d6151(0xca2)](document[_0x2d6151(0x102a)](_0x2d6151(0x10c4)))[_0x2d6151(0xbf6)](_0x15e4dd=>_0x15e4dd[_0x2d6151(0x8dd)][_0x2d6151(0x2aa)]())['filter'](_0x3db2da=>_0x3db2da);if(_0x3b67b4[_0x2d6151(0x131d)]<0x2){alert(_0x2d6151(0xce2));return;}const _0x42f0db=_0x42f206[_0x2d6151(0x954)][_0x42f206[_0x2d6151(0x81d)]],_0xaa7af5=_0x42f0db[_0x2d6151(0x726)]?_0x42f0db[_0x2d6151(0xda2)][_0x2d6151(0xc7d)]||'我':'我',_0x4a7ffb={'role':_0x2d6151(0xf86),'senderName':_0xaa7af5,'type':_0x2d6151(0x670),'timestamp':Date[_0x2d6151(0x606)](),'question':_0x1ca7fa,'options':_0x3b67b4,'votes':{},'isClosed':![]};_0x42f0db['history'][_0x2d6151(0x129e)](_0x4a7ffb),await _0x17d534[_0x2d6151(0x954)][_0x2d6151(0xf3f)](_0x42f0db),_0x5d5ee2(_0x4a7ffb,_0x42f0db),_0x27be5e(),document[_0x2d6151(0x458)]('create-poll-modal')[_0x2d6151(0x11c2)][_0x2d6151(0x1097)](_0x2d6151(0x67d));}async function _0x5cde4c(_0x57aff6,_0x227cf5){const _0x2e99a2=_0x204348,_0x46360e=_0x42f206[_0x2e99a2(0x954)][_0x42f206['activeChatId']],_0x5c8a84=_0x46360e[_0x2e99a2(0x1d5)][_0x2e99a2(0xb07)](_0x42c671=>_0x42c671[_0x2e99a2(0xf16)]===_0x57aff6),_0x54f26e=_0x46360e[_0x2e99a2(0x726)]?_0x46360e['settings'][_0x2e99a2(0xc7d)]||'我':'我';if(!_0x5c8a84||_0x5c8a84[_0x2e99a2(0xac0)]){_0x5c8a84&&_0x5c8a84[_0x2e99a2(0xac0)]&&_0x5503c9(_0x57aff6);return;}const _0x26f318=_0x5c8a84[_0x2e99a2(0x92)][_0x227cf5]&&_0x5c8a84[_0x2e99a2(0x92)][_0x227cf5][_0x2e99a2(0xd8d)](_0x54f26e);if(!_0x26f318){for(const _0x185cd4 in _0x5c8a84[_0x2e99a2(0x92)]){const _0x4b46f5=_0x5c8a84[_0x2e99a2(0x92)][_0x185cd4][_0x2e99a2(0x893)](_0x54f26e);_0x4b46f5>-0x1&&_0x5c8a84[_0x2e99a2(0x92)][_0x185cd4][_0x2e99a2(0x9cf)](_0x4b46f5,0x1);}!_0x5c8a84[_0x2e99a2(0x92)][_0x227cf5]&&(_0x5c8a84[_0x2e99a2(0x92)][_0x227cf5]=[]),_0x5c8a84[_0x2e99a2(0x92)][_0x227cf5][_0x2e99a2(0x129e)](_0x54f26e);}let _0x3f98b5=null;!_0x26f318&&(_0x3f98b5='[系统提示：用户\x20('+_0x54f26e+_0x2e99a2(0x122e)+_0x227cf5+_0x2e99a2(0x1348));if(_0x3f98b5){const _0x1f45cc={'role':_0x2e99a2(0x1370),'content':_0x3f98b5,'timestamp':Date[_0x2e99a2(0x606)](),'isHidden':!![]};_0x46360e[_0x2e99a2(0x1d5)]['push'](_0x1f45cc);}await _0x17d534['chats'][_0x2e99a2(0xf3f)](_0x46360e),_0x359c96(_0x42f206['activeChatId']);}async function _0x2a3629(_0x39c46b){const _0x2034c4=_0x204348,_0x1f8fdc=_0x42f206[_0x2034c4(0x954)][_0x42f206[_0x2034c4(0x81d)]],_0x50e02c=_0x1f8fdc[_0x2034c4(0x1d5)][_0x2034c4(0xb07)](_0x5a70a1=>_0x5a70a1['timestamp']===_0x39c46b);if(!_0x50e02c||_0x50e02c['isClosed'])return;const _0x482846=await _0x2532b9(_0x2034c4(0xfbd),'确定要结束这个投票吗？结束后将无法再进行投票。');if(_0x482846){_0x50e02c[_0x2034c4(0xac0)]=!![];const _0x62761b=_0x50e02c[_0x2034c4(0x8e9)][_0x2034c4(0xbf6)](_0x46e825=>'“'+_0x46e825+'”('+(_0x50e02c[_0x2034c4(0x92)][_0x46e825]?.['length']||0x0)+'票)')[_0x2034c4(0x56c)]('，'),_0x4bde8c='[系统提示：用户手动结束了投票！最终结果为：'+_0x62761b+'。]',_0x552b5b={'role':_0x2034c4(0x1370),'content':_0x4bde8c,'timestamp':Date[_0x2034c4(0x606)](),'isHidden':!![]};_0x1f8fdc[_0x2034c4(0x1d5)][_0x2034c4(0x129e)](_0x552b5b),await _0x17d534[_0x2034c4(0x954)][_0x2034c4(0xf3f)](_0x1f8fdc),_0x359c96(_0x42f206['activeChatId']);}}function _0x5503c9(_0x56d124){const _0x323304=_0x204348,_0x1f1f65=_0x42f206[_0x323304(0x954)][_0x42f206[_0x323304(0x81d)]],_0x422acd=_0x1f1f65[_0x323304(0x1d5)][_0x323304(0xb07)](_0xf7be33=>_0xf7be33[_0x323304(0xf16)]===_0x56d124);if(!_0x422acd||!_0x422acd[_0x323304(0xac0)])return;let _0x2d9047=_0x323304(0x91f)+_0x422acd['question']+'</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>';Object[_0x323304(0x634)](_0x422acd['votes'])['length']===0x0?_0x2d9047+='<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>':_0x422acd[_0x323304(0x8e9)][_0x323304(0x12c2)](_0x1b405c=>{const _0x5cf015=_0x323304,_0x9c631a=_0x422acd[_0x5cf015(0x92)][_0x1b405c]||[],_0x51ff53=_0x9c631a[_0x5cf015(0xbf6)](_0x1fc3d4=>_0x32d364(_0x1f1f65,_0x1fc3d4))[_0x5cf015(0x56c)]('、\x20');_0x2d9047+=_0x5cf015(0x12c)+_0x1b405c+'\x20('+_0x9c631a['length']+_0x5cf015(0x261)+(_0x9c631a[_0x5cf015(0x131d)]>0x0?_0x51ff53:_0x5cf015(0x69d))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x34fce8(_0x323304(0xb6f),_0x2d9047);}function _0x5f1d35(){const _0x4ad70d=_0x204348;if(!_0x42f206['activeChatId'])return;const _0xc615c5=_0x42f206[_0x4ad70d(0x954)][_0x42f206[_0x4ad70d(0x81d)]];document[_0x4ad70d(0x458)]('ai-avatar-library-title')[_0x4ad70d(0x1a2)]='“'+_0xc615c5[_0x4ad70d(0x132a)]+_0x4ad70d(0x32c),_0x3204f6(),document[_0x4ad70d(0x458)](_0x4ad70d(0x6ec))[_0x4ad70d(0x11c2)][_0x4ad70d(0xa58)](_0x4ad70d(0x67d));}function _0x3204f6(){const _0xf5383b=_0x204348,_0xd581f7=document[_0xf5383b(0x458)](_0xf5383b(0xa33));_0xd581f7[_0xf5383b(0x110d)]='';const _0x2d547d=_0x42f206[_0xf5383b(0x954)][_0x42f206[_0xf5383b(0x81d)]],_0x5151d1=_0x2d547d[_0xf5383b(0xda2)][_0xf5383b(0x5d3)]||[];if(_0x5151d1[_0xf5383b(0x131d)]===0x0){_0xd581f7[_0xf5383b(0x110d)]='<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>';return;}_0x5151d1[_0xf5383b(0x12c2)]((_0x51156f,_0xc7d5e)=>{const _0x49aa08=_0xf5383b,_0x30e5d5=document['createElement'](_0x49aa08(0x1323));_0x30e5d5['className']=_0x49aa08(0x9d6),_0x30e5d5[_0x49aa08(0x316)]=_0x51156f[_0x49aa08(0x132a)],_0x30e5d5[_0x49aa08(0x110d)]=_0x49aa08(0xe29)+_0x51156f[_0x49aa08(0x1377)]+_0x49aa08(0x8f5)+_0x51156f[_0x49aa08(0x132a)]+_0x49aa08(0x106a);const _0x3fd4bd=document['createElement'](_0x49aa08(0x1323));_0x3fd4bd[_0x49aa08(0x69b)]=_0x49aa08(0x1d3),_0x3fd4bd[_0x49aa08(0x110d)]='×',_0x3fd4bd['style']['display']=_0x49aa08(0x1188),_0x3fd4bd[_0x49aa08(0xbe8)]=async _0x24e79a=>{const _0x13087a=_0x49aa08;_0x24e79a['stopPropagation']();const _0x15b464=await _0x2532b9('删除头像',_0x13087a(0x19b)+_0x51156f[_0x13087a(0x132a)]+_0x13087a(0x1028),{'confirmButtonClass':_0x13087a(0x4d3)});_0x15b464&&(_0x2d547d[_0x13087a(0xda2)][_0x13087a(0x5d3)][_0x13087a(0x9cf)](_0xc7d5e,0x1),await _0x17d534[_0x13087a(0x954)][_0x13087a(0xf3f)](_0x2d547d),_0x3204f6());},_0x30e5d5[_0x49aa08(0x1079)](_0x3fd4bd),_0xd581f7[_0x49aa08(0x1079)](_0x30e5d5);});}async function _0x124c42(){const _0x2b1ce0=_0x204348,_0x3f9efb=await _0x335e57(_0x2b1ce0(0x6af),_0x2b1ce0(0x95d));if(!_0x3f9efb||!_0x3f9efb[_0x2b1ce0(0x2aa)]())return;const _0x142f78=await _0x335e57('添加头像',_0x2b1ce0(0x711),'','url');if(!_0x142f78||!_0x142f78[_0x2b1ce0(0x2aa)]()[_0x2b1ce0(0x13ad)](_0x2b1ce0(0xe04))){alert('请输入有效的图片URL！');return;}const _0x340ab5=_0x42f206[_0x2b1ce0(0x954)][_0x42f206[_0x2b1ce0(0x81d)]];!_0x340ab5[_0x2b1ce0(0xda2)][_0x2b1ce0(0x5d3)]&&(_0x340ab5[_0x2b1ce0(0xda2)]['aiAvatarLibrary']=[]),_0x340ab5['settings'][_0x2b1ce0(0x5d3)]['push']({'name':_0x3f9efb[_0x2b1ce0(0x2aa)](),'url':_0x142f78[_0x2b1ce0(0x2aa)]()}),await _0x17d534[_0x2b1ce0(0x954)][_0x2b1ce0(0xf3f)](_0x340ab5),_0x3204f6();}function _0x391191(){const _0x1de76d=_0x204348;document[_0x1de76d(0x458)](_0x1de76d(0x6ec))['classList'][_0x1de76d(0x1097)](_0x1de76d(0x67d));}function _0x2e9184(){const _0xc7ddd7=_0x204348;if(!_0x42f206[_0xc7ddd7(0x81d)])return;const _0x8cb7f7=_0x42f206['chats'][_0x42f206[_0xc7ddd7(0x81d)]];document[_0xc7ddd7(0x458)]('my-avatar-library-title')[_0xc7ddd7(0x1a2)]='“'+(_0x8cb7f7[_0xc7ddd7(0xda2)][_0xc7ddd7(0xc7d)]||'我')+_0xc7ddd7(0x32c),_0x51c07b(),document[_0xc7ddd7(0x458)](_0xc7ddd7(0xbb9))[_0xc7ddd7(0x11c2)][_0xc7ddd7(0xa58)]('visible');}function _0x51c07b(){const _0x398ecc=_0x204348,_0x2f5450=document[_0x398ecc(0x458)](_0x398ecc(0xbaf));_0x2f5450[_0x398ecc(0x110d)]='';const _0x189830=_0x42f206[_0x398ecc(0x954)][_0x42f206[_0x398ecc(0x81d)]],_0x162f72=_0x189830[_0x398ecc(0xda2)][_0x398ecc(0x22c)]||[];if(_0x162f72['length']===0x0){_0x2f5450[_0x398ecc(0x110d)]='<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>';return;}_0x162f72['forEach']((_0x3cd7be,_0x310f95)=>{const _0x16d05a=_0x398ecc,_0x1c6686=document['createElement']('div');_0x1c6686[_0x16d05a(0x69b)]='sticker-item',_0x1c6686[_0x16d05a(0x316)]=_0x3cd7be[_0x16d05a(0x132a)],_0x1c6686['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url('+_0x3cd7be[_0x16d05a(0x1377)]+_0x16d05a(0x8f5)+_0x3cd7be['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x3a34e3=document[_0x16d05a(0xe7d)]('div');_0x3a34e3[_0x16d05a(0x69b)]='delete-btn',_0x3a34e3[_0x16d05a(0x110d)]='×',_0x3a34e3[_0x16d05a(0x1104)][_0x16d05a(0x4db)]=_0x16d05a(0x1188),_0x3a34e3[_0x16d05a(0xbe8)]=async _0xebe4fc=>{const _0x4251e1=_0x16d05a;_0xebe4fc[_0x4251e1(0x58e)]();const _0x54f77d=await _0x2532b9(_0x4251e1(0x2a8),'确定要从你的头像库中删除“'+_0x3cd7be[_0x4251e1(0x132a)]+_0x4251e1(0x1028),{'confirmButtonClass':'btn-danger'});_0x54f77d&&(_0x189830['settings']['myAvatarLibrary'][_0x4251e1(0x9cf)](_0x310f95,0x1),await _0x17d534[_0x4251e1(0x954)]['put'](_0x189830),_0x51c07b());},_0x1c6686[_0x16d05a(0x1079)](_0x3a34e3),_0x2f5450['appendChild'](_0x1c6686);});}async function _0x40ccfc(){const _0x1215eb=_0x204348,_0x59e255=await _0x335e57(_0x1215eb(0x6af),_0x1215eb(0x95d));if(!_0x59e255||!_0x59e255[_0x1215eb(0x2aa)]())return;const _0x486a27=await _0x335e57(_0x1215eb(0x6af),_0x1215eb(0x711),'',_0x1215eb(0x1377));if(!_0x486a27||!_0x486a27['trim']()[_0x1215eb(0x13ad)]('http')){alert(_0x1215eb(0xb0e));return;}const _0x31f11a=_0x42f206['chats'][_0x42f206[_0x1215eb(0x81d)]];!_0x31f11a[_0x1215eb(0xda2)]['myAvatarLibrary']&&(_0x31f11a[_0x1215eb(0xda2)][_0x1215eb(0x22c)]=[]),_0x31f11a[_0x1215eb(0xda2)][_0x1215eb(0x22c)][_0x1215eb(0x129e)]({'name':_0x59e255['trim'](),'url':_0x486a27[_0x1215eb(0x2aa)]()}),await _0x17d534[_0x1215eb(0x954)][_0x1215eb(0xf3f)](_0x31f11a),_0x51c07b();}async function _0x25d7d3(_0x137662){const _0x5478f9=_0x204348,_0x17dd9d=_0x137662[_0x5478f9(0x12df)]['files'][0x0];if(!_0x17dd9d)return;const _0x1a6b33=await new Promise(_0x177f12=>{const _0x41aba3=_0x5478f9,_0xc044fa=new FileReader();_0xc044fa[_0x41aba3(0x11fa)]=()=>_0x177f12(_0xc044fa[_0x41aba3(0x2ed)]),_0xc044fa[_0x41aba3(0x96e)](_0x17dd9d);}),_0x174db1=await _0x335e57(_0x5478f9(0x7ba),_0x5478f9(0x12ac));if(!_0x174db1||!_0x174db1[_0x5478f9(0x2aa)]())return;const _0x464ea7=_0x42f206[_0x5478f9(0x954)][_0x42f206[_0x5478f9(0x81d)]];!_0x464ea7['settings'][_0x5478f9(0x22c)]&&(_0x464ea7[_0x5478f9(0xda2)][_0x5478f9(0x22c)]=[]),_0x464ea7[_0x5478f9(0xda2)][_0x5478f9(0x22c)]['push']({'name':_0x174db1['trim'](),'url':_0x1a6b33}),await _0x17d534[_0x5478f9(0x954)][_0x5478f9(0xf3f)](_0x464ea7),_0x51c07b(),_0x137662[_0x5478f9(0x12df)]['value']=null;}async function _0x3c59eb(_0x20b80a){const _0x3772c3=_0x204348,_0x397ab7=_0x42f206['chats'][_0x42f206[_0x3772c3(0x81d)]];if(!_0x397ab7)return;const _0x2d440a=_0x20b80a['trim']()[_0x3772c3(0x90b)]('\x0a'),_0x3797b1=[],_0x51688a='https://files.catbox.moe/';let _0x31f860=0x0;for(const _0xf20ab8 of _0x2d440a){const _0x3b7606=_0xf20ab8[_0x3772c3(0x2aa)]();if(!_0x3b7606||_0x3b7606[_0x3772c3(0xd8d)]('http')||_0x3b7606[_0x3772c3(0xd8d)]('填入'))continue;let _0x1a649b=null,_0x5a8f5e=null;const _0x35cd17=_0x3b7606[_0x3772c3(0x41c)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x35cd17)_0x1a649b=_0x35cd17[0x1],_0x5a8f5e=_0x35cd17[0x2];else{const _0x3dc3a6=_0x3b7606['split'](/\s+/);_0x3dc3a6['length']>=0x2&&(_0x5a8f5e=_0x3dc3a6[_0x3772c3(0xdd4)](),_0x1a649b=_0x3dc3a6['join']('\x20'));}_0x1a649b&&_0x5a8f5e&&_0x5a8f5e[_0x3772c3(0xd8d)]('.')?_0x3797b1['push']({'name':_0x1a649b,'url':_0x51688a+_0x5a8f5e}):_0x31f860++;}if(_0x31f860>0x0)await _0x34fce8(_0x3772c3(0xae9),'有\x20'+_0x31f860+_0x3772c3(0xdc));if(_0x3797b1[_0x3772c3(0x131d)]>0x0){if(!_0x397ab7['settings'][_0x3772c3(0x22c)])_0x397ab7[_0x3772c3(0xda2)][_0x3772c3(0x22c)]=[];_0x397ab7[_0x3772c3(0xda2)][_0x3772c3(0x22c)][_0x3772c3(0x129e)](..._0x3797b1),await _0x17d534['chats'][_0x3772c3(0xf3f)](_0x397ab7),_0x51c07b(),await _0x34fce8(_0x3772c3(0xf98),_0x3772c3(0x1458)+_0x3797b1['length']+'\x20个新头像！');}else _0x31f860===0x0&&alert(_0x3772c3(0x702));}function _0x2ef045(){const _0x5e3746=_0x204348;document[_0x5e3746(0x458)](_0x5e3746(0xbb9))[_0x5e3746(0x11c2)][_0x5e3746(0x1097)](_0x5e3746(0x67d));}function _0x52ed51(){const _0x545d8f=_0x204348;if(!_0x42f206[_0x545d8f(0x81d)])return;const _0xc29c53=_0x42f206[_0x545d8f(0x954)][_0x42f206[_0x545d8f(0x81d)]];document[_0x545d8f(0x458)](_0x545d8f(0x1124))[_0x545d8f(0x1a2)]='“'+_0xc29c53[_0x545d8f(0x132a)]+_0x545d8f(0x32c),_0x3d3a2b(),document[_0x545d8f(0x458)](_0x545d8f(0x363))[_0x545d8f(0x11c2)]['add'](_0x545d8f(0x67d));}function _0x3d3a2b(){const _0x332997=_0x204348,_0x471a25=document[_0x332997(0x458)](_0x332997(0x1282));_0x471a25['innerHTML']='';const _0x21327c=_0x42f206[_0x332997(0x954)][_0x42f206[_0x332997(0x81d)]],_0x53f380=_0x21327c['settings'][_0x332997(0x97b)]||[];if(_0x53f380[_0x332997(0x131d)]===0x0){_0x471a25[_0x332997(0x110d)]='<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>';return;}_0x53f380[_0x332997(0x12c2)]((_0x150f8c,_0x397640)=>{const _0xac406a=_0x332997,_0x2b93bb=document[_0xac406a(0xe7d)]('div');_0x2b93bb[_0xac406a(0x69b)]=_0xac406a(0x9d6),_0x2b93bb[_0xac406a(0x316)]=_0x150f8c['name'],_0x2b93bb['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url('+_0x150f8c[_0xac406a(0x1377)]+_0xac406a(0x8f5)+_0x150f8c[_0xac406a(0x132a)]+_0xac406a(0x106a);const _0xac94b1=document[_0xac406a(0xe7d)]('div');_0xac94b1[_0xac406a(0x69b)]=_0xac406a(0x1d3),_0xac94b1[_0xac406a(0x110d)]='×',_0xac94b1[_0xac406a(0x1104)][_0xac406a(0x4db)]=_0xac406a(0x1188),_0xac94b1[_0xac406a(0xbe8)]=async _0x4f3a2d=>{const _0x550aa7=_0xac406a;_0x4f3a2d['stopPropagation']();const _0x1137aa=await _0x2532b9('删除头像','确定要从头像库中删除“'+_0x150f8c[_0x550aa7(0x132a)]+'”吗？',{'confirmButtonClass':_0x550aa7(0x4d3)});_0x1137aa&&(_0x21327c['settings']['groupAvatarLibrary'][_0x550aa7(0x9cf)](_0x397640,0x1),await _0x17d534['chats']['put'](_0x21327c),_0x3d3a2b());},_0x2b93bb[_0xac406a(0x1079)](_0xac94b1),_0x471a25['appendChild'](_0x2b93bb);});}async function _0x96f6d6(){const _0x35e189=_0x204348,_0x2822e9=await _0x335e57(_0x35e189(0x6af),'请为这个头像起个名字（例如：春日野餐、学习时间）');if(!_0x2822e9||!_0x2822e9['trim']())return;const _0x2b9bf3=await _0x335e57(_0x35e189(0x6af),_0x35e189(0x711),'',_0x35e189(0x1377));if(!_0x2b9bf3||!_0x2b9bf3[_0x35e189(0x2aa)]()[_0x35e189(0x13ad)](_0x35e189(0xe04))){alert(_0x35e189(0xb0e));return;}const _0x15268e=_0x42f206['chats'][_0x42f206[_0x35e189(0x81d)]];!_0x15268e[_0x35e189(0xda2)]['groupAvatarLibrary']&&(_0x15268e[_0x35e189(0xda2)]['groupAvatarLibrary']=[]),_0x15268e[_0x35e189(0xda2)][_0x35e189(0x97b)][_0x35e189(0x129e)]({'name':_0x2822e9[_0x35e189(0x2aa)](),'url':_0x2b9bf3[_0x35e189(0x2aa)]()}),await _0x17d534[_0x35e189(0x954)][_0x35e189(0xf3f)](_0x15268e),_0x3d3a2b();}function _0x1889c2(){const _0x58a653=_0x204348;document['getElementById'](_0x58a653(0x363))[_0x58a653(0x11c2)][_0x58a653(0x1097)](_0x58a653(0x67d));}async function _0x14da5f(_0x32cba9){const _0x3aad4f=_0x204348,_0x49b981=_0x3aad4f(0xf94),_0x56d29e=await _0x335e57(_0x3aad4f(0x12e8),_0x49b981,'',_0x3aad4f(0xb43));_0x56d29e&&_0x56d29e[_0x3aad4f(0x2aa)]()&&await _0x252875(_0x32cba9,_0x56d29e);}async function _0x252875(_0x55d016,_0x566936){const _0x3088e9=_0x204348,_0x4bb350=_0x42f206['chats'][_0x42f206['activeChatId']];if(!_0x4bb350)return;const _0x394735=_0x566936[_0x3088e9(0x2aa)]()[_0x3088e9(0x90b)]('\x0a'),_0x4f6571=[],_0x1fee45='https://files.catbox.moe/';let _0x26f015=0x0;for(const _0x32e1cc of _0x394735){const _0x45f310=_0x32e1cc[_0x3088e9(0x2aa)]();if(!_0x45f310||_0x45f310[_0x3088e9(0xd8d)]('http')||_0x45f310[_0x3088e9(0xd8d)]('填入'))continue;let _0x84deef=null,_0x499cc6=null;const _0x16b20d=_0x45f310[_0x3088e9(0x41c)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x16b20d)_0x84deef=_0x16b20d[0x1],_0x499cc6=_0x16b20d[0x2];else{const _0x3a57ef=_0x45f310['split'](/\s+/);_0x3a57ef['length']>=0x2&&(_0x499cc6=_0x3a57ef[_0x3088e9(0xdd4)](),_0x84deef=_0x3a57ef[_0x3088e9(0x56c)]('\x20'));}_0x84deef&&_0x499cc6&&_0x499cc6[_0x3088e9(0xd8d)]('.')?_0x4f6571['push']({'name':_0x84deef,'url':_0x1fee45+_0x499cc6}):(_0x26f015++,console[_0x3088e9(0x1b6)]('批量导入格式错误，已跳过此行:',_0x45f310));}_0x26f015>0x0&&await _0x34fce8(_0x3088e9(0xae9),'有\x20'+_0x26f015+_0x3088e9(0xf5b));if(_0x4f6571[_0x3088e9(0x131d)]>0x0){if(_0x55d016==='ai'){if(!_0x4bb350[_0x3088e9(0xda2)][_0x3088e9(0x5d3)])_0x4bb350[_0x3088e9(0xda2)][_0x3088e9(0x5d3)]=[];_0x4bb350['settings'][_0x3088e9(0x5d3)][_0x3088e9(0x129e)](..._0x4f6571),await _0x17d534['chats'][_0x3088e9(0xf3f)](_0x4bb350),_0x3204f6();}else{if(_0x55d016===_0x3088e9(0x1192)){if(!_0x4bb350['settings'][_0x3088e9(0x97b)])_0x4bb350[_0x3088e9(0xda2)][_0x3088e9(0x97b)]=[];_0x4bb350['settings'][_0x3088e9(0x97b)][_0x3088e9(0x129e)](..._0x4f6571),await _0x17d534['chats'][_0x3088e9(0xf3f)](_0x4bb350),_0x3d3a2b();}}await _0x34fce8(_0x3088e9(0xf98),_0x3088e9(0x1458)+_0x4f6571[_0x3088e9(0x131d)]+_0x3088e9(0xec));}else _0x26f015===0x0&&alert(_0x3088e9(0xe60));}async function _0xcbc58f(){const _0xcde6f6=_0x204348,_0x265bda=await _0x335e57(_0xcde6f6(0x6af),'请为这个头像起个名字（例如：春日野餐、学习时间）');if(!_0x265bda||!_0x265bda['trim']())return;const _0x266499=await _0x335e57('添加头像',_0xcde6f6(0x711),'',_0xcde6f6(0x1377));if(!_0x266499||!_0x266499['trim']()[_0xcde6f6(0x13ad)](_0xcde6f6(0xe04))){alert(_0xcde6f6(0xb0e));return;}const _0x411bc5=_0x42f206['chats'][_0x42f206[_0xcde6f6(0x81d)]];!_0x411bc5[_0xcde6f6(0xda2)][_0xcde6f6(0x97b)]&&(_0x411bc5[_0xcde6f6(0xda2)][_0xcde6f6(0x97b)]=[]),_0x411bc5['settings'][_0xcde6f6(0x97b)][_0xcde6f6(0x129e)]({'name':_0x265bda[_0xcde6f6(0x2aa)](),'url':_0x266499['trim']()}),await _0x17d534[_0xcde6f6(0x954)]['put'](_0x411bc5),_0x3d3a2b();}function _0x537098(_0x27d934){return new Promise(_0xb83040=>{const _0x1ff4eb=_0x1a5b,_0x12a5ae=document[_0x1ff4eb(0x458)](_0x1ff4eb(0x13dd)),_0x1ac240=document[_0x1ff4eb(0x458)](_0x1ff4eb(0x132c)),_0x500f0f=document[_0x1ff4eb(0x458)](_0x1ff4eb(0x788)),_0x5a1434=document[_0x1ff4eb(0x458)](_0x1ff4eb(0x1200));_0x1ac240[_0x1ff4eb(0x1a2)]=_0x27d934[_0x1ff4eb(0x858)]?_0x1ff4eb(0x2db):_0x1ff4eb(0x1243);const _0x448352=_0x1ac240['cloneNode'](!![]);_0x1ac240[_0x1ff4eb(0x135e)]['replaceChild'](_0x448352,_0x1ac240),_0x448352[_0x1ff4eb(0xbe8)]=()=>{const _0x12dd98=_0x1ff4eb;_0x12a5ae[_0x12dd98(0x11c2)][_0x12dd98(0x1097)](_0x12dd98(0x67d)),_0xb83040(_0x12dd98(0xc61));};const _0x28450b=_0x500f0f[_0x1ff4eb(0x350)](!![]);_0x500f0f['parentNode']['replaceChild'](_0x28450b,_0x500f0f),_0x28450b[_0x1ff4eb(0xbe8)]=()=>{const _0x591dc9=_0x1ff4eb;_0x12a5ae[_0x591dc9(0x11c2)][_0x591dc9(0x1097)](_0x591dc9(0x67d)),_0xb83040(_0x591dc9(0x195));};const _0x26fdd7=_0x5a1434[_0x1ff4eb(0x350)](!![]);_0x5a1434['parentNode'][_0x1ff4eb(0x3f2)](_0x26fdd7,_0x5a1434),_0x26fdd7[_0x1ff4eb(0xbe8)]=()=>{const _0x151228=_0x1ff4eb;_0x12a5ae[_0x151228(0x11c2)][_0x151228(0x1097)](_0x151228(0x67d)),_0xb83040(null);},_0x12a5ae['classList'][_0x1ff4eb(0xa58)]('visible');});}function _0x4eca92(){const _0x448401=_0x204348,_0x3e1623=document[_0x448401(0x458)](_0x448401(0x9a1)),_0x263b40=_0x42f206[_0x448401(0xf0)]['cphoneWallpaper'];_0x263b40?_0x3e1623[_0x448401(0x1104)][_0x448401(0xf7)]=_0x448401(0xfa)+_0x263b40+')':_0x3e1623[_0x448401(0x1104)]['backgroundImage']=_0x448401(0x58f);}function _0x3abb21(){const _0x158609=_0x204348;if(!_0x42f206[_0x158609(0xf0)]['cphoneAppIcons'])return;for(const _0xd326a7 in _0x42f206[_0x158609(0xf0)]['cphoneAppIcons']){const _0x3d9542=document[_0x158609(0x458)](_0x158609(0xdea)+_0xd326a7);_0x3d9542&&(_0x3d9542[_0x158609(0x577)]=_0x42f206[_0x158609(0xf0)][_0x158609(0x6e8)][_0xd326a7]);}}function _0x4911ff(){const _0xcc3f6c=_0x204348,_0x2ae31e=document['getElementById'](_0xcc3f6c(0xea6));if(!_0x2ae31e)return;_0x2ae31e['innerHTML']='';const _0x4e4383={'qq':'QQ','album':'相册','browser':_0xcc3f6c(0x3ce),'taobao':'淘宝','memo':_0xcc3f6c(0x138d),'diary':'日记','amap':_0xcc3f6c(0x525),'usage':_0xcc3f6c(0x11d4),'music':_0xcc3f6c(0xb84),'ephone':_0xcc3f6c(0x568)};for(const _0x1e9e8a in _0x42f206[_0xcc3f6c(0xf0)][_0xcc3f6c(0x6e8)]){const _0x4bcbfa=_0x42f206[_0xcc3f6c(0xf0)][_0xcc3f6c(0x6e8)][_0x1e9e8a],_0xaeede1=_0x4e4383[_0x1e9e8a]||_0xcc3f6c(0xc5f),_0xc749c8=document[_0xcc3f6c(0xe7d)](_0xcc3f6c(0x1323));_0xc749c8[_0xcc3f6c(0x69b)]='icon-setting-item',_0xc749c8[_0xcc3f6c(0x1f4)]['iconId']=_0x1e9e8a,_0xc749c8[_0xcc3f6c(0x110d)]=_0xcc3f6c(0xbdb)+_0x4bcbfa+_0xcc3f6c(0x298)+_0xaeede1+_0xcc3f6c(0x17a),_0x2ae31e[_0xcc3f6c(0x1079)](_0xc749c8);}}function _0x427694(){const _0x242b88=_0x204348;if(!_0x42f206['globalSettings'][_0x242b88(0x6a3)])return;for(const _0x37a7f7 in _0x42f206[_0x242b88(0xf0)][_0x242b88(0x6a3)]){const _0x4f148e=document[_0x242b88(0x458)](_0x242b88(0x218)+_0x37a7f7);_0x4f148e&&(_0x4f148e[_0x242b88(0x577)]=_0x42f206[_0x242b88(0xf0)][_0x242b88(0x6a3)][_0x37a7f7]);}}function _0x9b9a8f(){const _0x31db61=_0x204348,_0x23d0d8=document[_0x31db61(0x458)](_0x31db61(0x4e1));if(!_0x23d0d8)return;_0x23d0d8[_0x31db61(0x110d)]='';const _0x1b4637={'qq':'QQ','world-book':_0x31db61(0x5eb),'wallpaper':_0x31db61(0x34c),'renderer':_0x31db61(0xcdc),'api-settings':_0x31db61(0x1330),'font':'字体','char-phone':_0x31db61(0xb27),'douban':_0x31db61(0x718),'preset':'预设','tutorial':'教程','werewolf':_0x31db61(0x11f9),'x':'X'};for(const _0x21b4b9 in _0x42f206[_0x31db61(0xf0)][_0x31db61(0x6a3)]){const _0x12666c=_0x42f206[_0x31db61(0xf0)][_0x31db61(0x6a3)][_0x21b4b9],_0x36ced5=_0x1b4637[_0x21b4b9]||'Cphone',_0x1126f9=document[_0x31db61(0xe7d)]('div');_0x1126f9[_0x31db61(0x69b)]=_0x31db61(0xc9d),_0x1126f9['dataset'][_0x31db61(0x6bd)]=_0x21b4b9,_0x1126f9[_0x31db61(0x110d)]=_0x31db61(0xbdb)+_0x12666c+'\x22\x20alt=\x22'+_0x36ced5+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x23d0d8[_0x31db61(0x1079)](_0x1126f9);}}function _0x1b6903(_0x231f8e){const _0x5d4965=_0x204348;if(!_0x42f206[_0x5d4965(0x81d)])return;const _0x311b02=_0x42f206[_0x5d4965(0x954)][_0x42f206[_0x5d4965(0x81d)]];if(!_0x311b02||!_0x311b02['history'])return;const _0x2d6d11=_0x311b02[_0x5d4965(0x1d5)][_0x5d4965(0xb07)](_0x1e407e=>_0x1e407e[_0x5d4965(0xf16)]===_0x231f8e);if(!_0x2d6d11||_0x2d6d11[_0x5d4965(0x259)]!==_0x5d4965(0xbd0)){console[_0x5d4965(0xb61)](_0x5d4965(0xac),_0x231f8e);return;}document[_0x5d4965(0x458)](_0x5d4965(0x117c))[_0x5d4965(0x1a2)]=_0x2d6d11[_0x5d4965(0x885)]||_0x5d4965(0x1264);const _0x3869a7=document['getElementById'](_0x5d4965(0xaf));_0x3869a7[_0x5d4965(0x110d)]=_0x5d4965(0x6f7)+(_0x2d6d11['title']||_0x5d4965(0x1223))+'</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20'+(_0x2d6d11['source_name']||'未知')+_0x5d4965(0x1242)+(_0x2d6d11[_0x5d4965(0x1316)]||_0x5d4965(0x7a9))['replace'](/\n/g,_0x5d4965(0x830))+_0x5d4965(0x7c9),_0x589d88(_0x5d4965(0x9f3));}function _0x1c3db4(){const _0x32f784=_0x204348;_0x589d88(_0x32f784(0xd99));}function _0x1c3db4(){const _0xb57888=_0x204348;_0x589d88(_0xb57888(0xd99));}function _0x5ced16(){const _0x171854=_0x204348;if(!_0x42f206[_0x171854(0x81d)])return;document[_0x171854(0x458)](_0x171854(0xbb5))[_0x171854(0x8dd)]='',document[_0x171854(0x458)](_0x171854(0x1bd))['value']='',document[_0x171854(0x458)](_0x171854(0x5a7))['value']='',document[_0x171854(0x458)](_0x171854(0x1183))[_0x171854(0x8dd)]='',document[_0x171854(0x458)](_0x171854(0x684))[_0x171854(0x11c2)][_0x171854(0xa58)](_0x171854(0x67d));}async function _0x575939(){const _0x49a2d9=_0x204348;if(!_0x42f206[_0x49a2d9(0x81d)])return;const _0x57120c=document[_0x49a2d9(0x458)](_0x49a2d9(0xbb5))[_0x49a2d9(0x8dd)][_0x49a2d9(0x2aa)]();if(!_0x57120c){alert(_0x49a2d9(0x1014));return;}const _0x2b18a1=document[_0x49a2d9(0x458)](_0x49a2d9(0x1bd))[_0x49a2d9(0x8dd)][_0x49a2d9(0x2aa)](),_0x16094d=document[_0x49a2d9(0x458)]('link-source-input')['value'][_0x49a2d9(0x2aa)](),_0x2541c9=document[_0x49a2d9(0x458)](_0x49a2d9(0x1183))[_0x49a2d9(0x8dd)]['trim'](),_0x45bf16=_0x42f206[_0x49a2d9(0x954)][_0x42f206['activeChatId']],_0x2e9cdb={'role':_0x49a2d9(0xf86),'type':_0x49a2d9(0xbd0),'timestamp':Date[_0x49a2d9(0x606)](),'title':_0x57120c,'description':_0x2b18a1,'source_name':_0x16094d,'content':_0x2541c9,'thumbnail_url':null};_0x45bf16[_0x49a2d9(0x1d5)][_0x49a2d9(0x129e)](_0x2e9cdb),await _0x17d534[_0x49a2d9(0x954)][_0x49a2d9(0xf3f)](_0x45bf16),_0x5d5ee2(_0x2e9cdb,_0x45bf16),_0x27be5e(),document[_0x49a2d9(0x458)](_0x49a2d9(0x684))[_0x49a2d9(0x11c2)][_0x49a2d9(0x1097)](_0x49a2d9(0x67d));}function _0x40b385(_0x3fccb5,_0xe00089){const _0x4d648d=_0x204348;if(!_0xe00089||!_0xe00089['id'])return[];const _0x43f833=_0xe00089[_0x4d648d(0x1437)],_0x2656ed=_0xe00089['id'];return _0x3fccb5[_0x4d648d(0xaf1)](_0x1d1703=>{const _0x4c2258=_0x4d648d;if(_0x1d1703[_0x4c2258(0x1086)]===_0x4c2258(0xf86)){if(_0x1d1703[_0x4c2258(0xa11)]&&_0x1d1703[_0x4c2258(0xa11)]['length']>0x0)return _0x43f833&&_0x1d1703[_0x4c2258(0xa11)][_0x4c2258(0xd8d)](_0x43f833);return!![];}if(String(_0x1d1703[_0x4c2258(0x1086)])[_0x4c2258(0x13ad)]('npc_')){if(Array['isArray'](_0x1d1703['visibleTo']))return _0x1d1703[_0x4c2258(0x26f)][_0x4c2258(0xd8d)](_0x2656ed);return![];}const _0x512299=_0x42f206['chats'][_0x1d1703[_0x4c2258(0x1086)]];if(!_0x512299)return![];const _0x45cb36=_0x512299['groupId'],_0x291445=_0x45cb36&&_0x43f833&&_0x45cb36===_0x43f833,_0x12c68f=!_0x45cb36&&!_0x43f833;return _0x291445||_0x12c68f;});}function _0x4c5063(_0x1d488e){const _0x565530=_0x204348,_0x48ed67=document[_0x565530(0x458)](_0x565530(0xb3e)),_0x5b964b=document[_0x565530(0x458)](_0x565530(0x433)),_0xd6b6a5=_0x1d488e===_0x565530(0x130e);_0x48ed67[_0x565530(0x11c2)][_0x565530(0x1270)](_0x565530(0x466),_0xd6b6a5),_0x5b964b&&(_0x5b964b[_0x565530(0x8f7)]=_0xd6b6a5),localStorage['setItem'](_0x565530(0x1271),_0x1d488e);}function _0x435af5(){const _0x54f6c5=_0x204348,_0x45d154=document['getElementById'](_0x54f6c5(0x433)),_0x3d68f9=_0x45d154[_0x54f6c5(0x8f7)]?'dark':_0x54f6c5(0x580);_0x4c5063(_0x3d68f9);}function _0x2f8e76(){const _0x45664d=_0x204348;if(!_0x42f206[_0x45664d(0x81d)])return;_0x29936a(),_0x589d88(_0x45664d(0xbe2));}function _0x29936a(){const _0x3e0fbd=_0x204348,_0xe71240=document[_0x3e0fbd(0x458)](_0x3e0fbd(0x605)),_0x2ac8c6=_0x42f206['chats'][_0x42f206[_0x3e0fbd(0x81d)]];_0xe71240['innerHTML']='';let _0xef55a6=[];_0x2ac8c6['isGroup']?_0x2ac8c6[_0x3e0fbd(0xfa8)][_0x3e0fbd(0x12c2)](_0x27369b=>{const _0x4f9b1d=_0x3e0fbd,_0x3f9920=_0x42f206['chats'][_0x27369b['id']];if(_0x3f9920&&_0x3f9920[_0x4f9b1d(0x94a)]){const _0x36a0c3=_0x3f9920[_0x4f9b1d(0x94a)][_0x4f9b1d(0xbf6)](_0x15eac5=>({..._0x15eac5,'authorName':_0x27369b['groupNickname'],'authorChatId':_0x27369b['id']}));_0xef55a6[_0x4f9b1d(0x129e)](..._0x36a0c3);}}):_0x2ac8c6[_0x3e0fbd(0x94a)]&&(_0xef55a6=_0x2ac8c6[_0x3e0fbd(0x94a)][_0x3e0fbd(0xbf6)](_0x59b3f1=>({..._0x59b3f1,'authorName':_0x2ac8c6[_0x3e0fbd(0x132a)],'authorChatId':_0x2ac8c6['id']})));if(_0xef55a6[_0x3e0fbd(0x131d)]===0x0){_0xe71240['innerHTML']=_0x3e0fbd(0x1280);return;}_0xef55a6[_0x3e0fbd(0xc12)]((_0x22a03d,_0x126687)=>_0x126687[_0x3e0fbd(0xf16)]-_0x22a03d[_0x3e0fbd(0xf16)]),_0xef55a6['forEach']((_0x4eb7e0,_0x53ec58)=>{const _0x3a6e17=_0x3e0fbd,_0x39883c=document[_0x3a6e17(0xe7d)](_0x3a6e17(0x1323));_0x39883c[_0x3a6e17(0x69b)]='memory-card',_0x39883c[_0x3a6e17(0x1104)][_0x3a6e17(0x9f4)]=_0x3a6e17(0x1121),_0x39883c['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20'+_0x4eb7e0[_0x3a6e17(0x1176)]+_0x3a6e17(0x109c)+_0x4eb7e0[_0x3a6e17(0x1316)][_0x3a6e17(0x33b)](/\n/g,_0x3a6e17(0x1208))+_0x3a6e17(0xa5e)+_0x4eb7e0[_0x3a6e17(0x11e8)]+_0x3a6e17(0x53e)+_0x4eb7e0[_0x3a6e17(0xf16)]+'\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22'+_0x4eb7e0[_0x3a6e17(0x11e8)]+'\x22\x20data-memory-timestamp=\x22'+_0x4eb7e0[_0x3a6e17(0xf16)]+_0x3a6e17(0x274),_0xe71240['appendChild'](_0x39883c);});}async function _0x439285(){const _0x613264=_0x204348,_0x354c46=_0x42f206[_0x613264(0x954)][_0x42f206[_0x613264(0x81d)]];if(!_0x354c46)return;let _0x1d6f9d=_0x354c46;if(_0x354c46['isGroup']){const _0x5a6b15=_0x354c46[_0x613264(0xfa8)][_0x613264(0xbf6)](_0x5b382a=>({'text':'为“'+_0x5b382a[_0x613264(0x1118)]+_0x613264(0x72c),'value':_0x5b382a['id']})),_0x3b0385=await _0xcd7475(_0x613264(0x13c0),_0x5a6b15);if(!_0x3b0385)return;_0x1d6f9d=_0x42f206[_0x613264(0x954)][_0x3b0385];if(!_0x1d6f9d){alert(_0x613264(0xb70));return;}}const _0x3e4e80=await _0x335e57('为“'+_0x1d6f9d[_0x613264(0x132a)]+_0x613264(0x72c),'请输入要添加的记忆要点：','',_0x613264(0xb43));if(_0x3e4e80&&_0x3e4e80[_0x613264(0x2aa)]()){if(!_0x1d6f9d[_0x613264(0x94a)])_0x1d6f9d[_0x613264(0x94a)]=[];_0x1d6f9d[_0x613264(0x94a)][_0x613264(0x129e)]({'content':_0x3e4e80[_0x613264(0x2aa)](),'timestamp':Date[_0x613264(0x606)](),'source':_0x613264(0xc84)}),await _0x17d534[_0x613264(0x954)][_0x613264(0xf3f)](_0x1d6f9d),_0x29936a();}}async function _0x4993f6(_0x4a33f6,_0x36ebb3){const _0x1b0417=_0x204348,_0x395664=_0x42f206[_0x1b0417(0x954)][_0x4a33f6];if(!_0x395664||!_0x395664['longTermMemory'])return;const _0x3e6723=_0x395664[_0x1b0417(0x94a)][_0x1b0417(0x4a8)](_0x8039e9=>_0x8039e9[_0x1b0417(0xf16)]===_0x36ebb3);if(_0x3e6723===-0x1)return;const _0x52c6a3=_0x395664[_0x1b0417(0x94a)][_0x3e6723],_0x2827fe=await _0x335e57('编辑记忆','请修改记忆要点：',_0x52c6a3[_0x1b0417(0x1316)],_0x1b0417(0xb43));_0x2827fe&&_0x2827fe[_0x1b0417(0x2aa)]()&&(_0x52c6a3['content']=_0x2827fe[_0x1b0417(0x2aa)](),await _0x17d534['chats'][_0x1b0417(0xf3f)](_0x395664),_0x29936a());}async function _0xdf6935(_0x3d36e6,_0x3cfd8d){const _0x744f71=_0x204348,_0xd4bcc1=await _0x2532b9(_0x744f71(0x1ef),_0x744f71(0xe46),{'confirmButtonClass':_0x744f71(0x4d3)});if(_0xd4bcc1){const _0x3c7875=_0x42f206[_0x744f71(0x954)][_0x3d36e6];if(!_0x3c7875||!_0x3c7875[_0x744f71(0x94a)])return;_0x3c7875[_0x744f71(0x94a)]=_0x3c7875[_0x744f71(0x94a)][_0x744f71(0xaf1)](_0x5357e3=>_0x5357e3[_0x744f71(0xf16)]!==_0x3cfd8d),await _0x17d534['chats']['put'](_0x3c7875),_0x29936a();}}async function _0x5d1aeb(){const _0x26aeeb=_0x204348,_0x33fb84=await _0x2532b9('确认操作',_0x26aeeb(0xe68));_0x33fb84&&await _0x4206ff(_0x42f206[_0x26aeeb(0x81d)],!![]);}async function _0x3a9d2a(_0x389c66){const _0x31d10f=_0x204348,_0x15bedc=_0x42f206['chats'][_0x389c66];if(!_0x15bedc||!_0x15bedc[_0x31d10f(0xda2)]['enableAutoMemory'])return;const _0x2362cb=_0x15bedc[_0x31d10f(0xa7e)]||0x0,_0x3e9955=_0x15bedc[_0x31d10f(0x1d5)][_0x31d10f(0xaf1)](_0x557a4c=>_0x557a4c[_0x31d10f(0xf16)]>_0x2362cb&&!_0x557a4c[_0x31d10f(0x7a0)]);_0x3e9955[_0x31d10f(0x131d)]>=_0x15bedc[_0x31d10f(0xda2)]['autoMemoryInterval']&&(console[_0x31d10f(0x7d1)]('达到自动总结阈值\x20('+_0x3e9955[_0x31d10f(0x131d)]+'/'+_0x15bedc[_0x31d10f(0xda2)]['autoMemoryInterval']+_0x31d10f(0x9b7)),await _0x4206ff(_0x389c66));}async function _0x112eb4(_0x276d6d,_0x130528){const _0x19f5ed=_0x204348,_0x5ec4ae=_0x42f206[_0x19f5ed(0x954)][_0x276d6d];if(!_0x5ec4ae||!_0x130528)throw new Error(_0x19f5ed(0xd2e));const _0x2facf3=_0x42f206[_0x19f5ed(0x551)][_0x19f5ed(0x308)]||'用户';let _0x37afb2,_0x2a5ba7=_0x5ec4ae;const _0x825387=new Date()[_0x19f5ed(0x1423)](_0x19f5ed(0xaa2),{'year':_0x19f5ed(0x4fb),'month':_0x19f5ed(0x1dc),'day':_0x19f5ed(0x4fb)});if(_0x5ec4ae[_0x19f5ed(0x726)]){let _0x226270=null;_0x4a3337[_0x19f5ed(0xa1e)]&&(_0x226270=_0x5ec4ae['members'][_0x19f5ed(0xb07)](_0x1cdf61=>_0x1cdf61[_0x19f5ed(0xa1)]===_0x4a3337[_0x19f5ed(0xa1e)]));!_0x226270&&(_0x226270=_0x5ec4ae[_0x19f5ed(0xfa8)]['find'](_0xc16649=>_0xc16649['id']!==_0x19f5ed(0xf86)&&_0x4a3337[_0x19f5ed(0x1008)][_0x19f5ed(0x593)](_0x2c4bc1=>_0x2c4bc1['id']===_0xc16649['id'])));!_0x226270&&(_0x226270=_0x5ec4ae[_0x19f5ed(0xfa8)][_0x19f5ed(0xb07)](_0x570863=>_0x570863['id']!=='user'));if(!_0x226270)throw new Error(_0x19f5ed(0x1394));const _0x7b880f=_0x42f206[_0x19f5ed(0x954)][_0x226270['id']];if(!_0x7b880f)throw new Error(_0x19f5ed(0x69f)+_0x226270['groupNickname']+_0x19f5ed(0x604));const _0x51061e=_0x5ec4ae[_0x19f5ed(0xda2)][_0x19f5ed(0x65f)]||_0x19f5ed(0x213);_0x37afb2=_0x19f5ed(0xf1c)+_0x226270['originalName']+'”。请你回顾一下刚才和\x20“'+_0x2facf3+'”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x825387+'**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是'+_0x825387+'”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a'+_0x7b880f[_0x19f5ed(0xda2)][_0x19f5ed(0x31d)]+_0x19f5ed(0xdf7)+_0x51061e+_0x19f5ed(0xe67)+_0x130528+_0x19f5ed(0x440)+_0x226270['originalName']+_0x19f5ed(0x13c7),_0x2a5ba7=_0x7b880f;}else _0x37afb2=_0x19f5ed(0xf1c)+_0x5ec4ae[_0x19f5ed(0xa1)]+_0x19f5ed(0xebc)+_0x2facf3+_0x19f5ed(0x86b)+_0x825387+_0x19f5ed(0x1100)+_0x825387+_0x19f5ed(0xd22)+_0x5ec4ae['settings'][_0x19f5ed(0x31d)]+_0x19f5ed(0xdf7)+_0x5ec4ae[_0x19f5ed(0xda2)][_0x19f5ed(0x65f)]+'\x0a\x0a#\x20待总结的视频通话记录\x0a'+_0x130528+_0x19f5ed(0x440)+_0x5ec4ae[_0x19f5ed(0xa1)]+'”的身份，开始你的客观总结。';try{const _0x241a2c=_0x42f206[_0x19f5ed(0x5cb)][_0x19f5ed(0x1380)]&&_0x42f206[_0x19f5ed(0x5cb)][_0x19f5ed(0x121d)]&&_0x42f206[_0x19f5ed(0x5cb)][_0x19f5ed(0xdc9)],{proxyUrl:_0x43482c,apiKey:_0x1edfd1,model:_0x155faa}=_0x241a2c?{'proxyUrl':_0x42f206[_0x19f5ed(0x5cb)][_0x19f5ed(0x1380)],'apiKey':_0x42f206['apiConfig'][_0x19f5ed(0x121d)],'model':_0x42f206[_0x19f5ed(0x5cb)][_0x19f5ed(0xdc9)]}:_0x42f206[_0x19f5ed(0x5cb)];if(!_0x43482c||!_0x1edfd1||!_0x155faa)throw new Error(_0x19f5ed(0x4a4));let _0x24b81c=_0x43482c[_0x19f5ed(0xd8d)]('generativelanguage'),_0x195972=_0x5d73db(_0x155faa,_0x1edfd1,_0x37afb2,[{'role':_0x19f5ed(0xf86),'content':_0x19f5ed(0xef0)}]);const _0x38c51e=_0x24b81c?await fetch(_0x195972[_0x19f5ed(0x1377)],_0x195972[_0x19f5ed(0x76b)]):await fetch(_0x43482c+'/v1/chat/completions',{'method':_0x19f5ed(0x1312),'headers':{'Content-Type':_0x19f5ed(0xa0e),'Authorization':_0x19f5ed(0x8aa)+_0x1edfd1},'body':JSON[_0x19f5ed(0xc04)]({'model':_0x155faa,'messages':[{'role':_0x19f5ed(0x1370),'content':_0x37afb2},{'role':_0x19f5ed(0xf86),'content':_0x19f5ed(0xef0)}],'temperature':0.1})});if(!_0x38c51e['ok']){const _0x391648=await _0x38c51e[_0x19f5ed(0xaef)]()['catch'](()=>({'error':{'message':_0x38c51e[_0x19f5ed(0xf0c)]}}));throw new Error('API\x20请求失败:\x20'+_0x38c51e[_0x19f5ed(0x13b2)]+_0x19f5ed(0x7da)+_0x391648['error'][_0x19f5ed(0x7aa)]);}const _0x8ae0a3=await _0x38c51e[_0x19f5ed(0xaef)]();let _0x206975=_0x24b81c?getGeminiResponseText(_0x8ae0a3):_0x8ae0a3[_0x19f5ed(0x2f9)][0x0]['message'][_0x19f5ed(0x1316)];_0x206975=_0x206975['replace'](/^```json\s*/,'')['replace'](/```$/,'')[_0x19f5ed(0x2aa)]();const _0x4ee85a=JSON['parse'](_0x206975);if(_0x4ee85a['summary']&&_0x4ee85a[_0x19f5ed(0x7f1)][_0x19f5ed(0x2aa)]()){const _0x362357={'content':_0x19f5ed(0xc17)+(_0x5ec4ae[_0x19f5ed(0x726)]?'群聊':'')+_0x19f5ed(0x13b0)+_0x4ee85a[_0x19f5ed(0x7f1)][_0x19f5ed(0x2aa)]()+')','timestamp':Date['now'](),'source':_0x5ec4ae['isGroup']?_0x19f5ed(0xf3):'call_summary'};if(!_0x2a5ba7[_0x19f5ed(0x94a)])_0x2a5ba7[_0x19f5ed(0x94a)]=[];return _0x2a5ba7[_0x19f5ed(0x94a)][_0x19f5ed(0x129e)](_0x362357),await _0x17d534[_0x19f5ed(0x954)]['put'](_0x2a5ba7),console[_0x19f5ed(0x7d1)](_0x19f5ed(0x2e5)+_0x2a5ba7[_0x19f5ed(0x132a)]+_0x19f5ed(0xae0)),!![];}else throw new Error('AI返回了空的或格式不正确的总结内容。');}catch(_0x8846b5){console[_0x19f5ed(0xb61)](_0x19f5ed(0xa3f),_0x8846b5);throw _0x8846b5;}}function _0x52daad(_0x243431){const _0xe720ee=_0x204348,_0x1adb95=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么',_0xe720ee(0x3ef),'哪个','一些','这个','那个','还有']),_0x19e710=_0x243431[_0xe720ee(0x41c)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x318acf=new Map();let _0x5e3eb0=0x0;_0x19e710[_0xe720ee(0x12c2)](_0x58791b=>{const _0x4b4760=_0xe720ee;if(_0x58791b[_0x4b4760(0x131d)]>0x1&&!_0x1adb95[_0x4b4760(0x31c)](_0x58791b)){const _0x297209=(_0x318acf[_0x4b4760(0x36d)](_0x58791b)||0x0)+0x1;_0x318acf[_0x4b4760(0xe71)](_0x58791b,_0x297209);if(_0x297209>_0x5e3eb0)_0x5e3eb0=_0x297209;}});const _0x350c2b=[],_0x120277=[],_0x17d0aa=_0x5e3eb0*0.9,_0x37793d=_0x5e3eb0*0.6;_0x318acf[_0xe720ee(0x12c2)]((_0x3ffe15,_0x31c10c)=>{const _0x3194d5=_0xe720ee;if(_0x3ffe15>=_0x17d0aa)_0x350c2b[_0x3194d5(0x129e)](_0x31c10c);else _0x3ffe15>=_0x37793d&&_0x120277[_0x3194d5(0x129e)](_0x31c10c);});const _0xca2213=new Set(_0x350c2b),_0x29ae90=_0x120277['filter'](_0x2e96a8=>!_0xca2213[_0xe720ee(0x31c)](_0x2e96a8))['slice'](0x0,0x5);return{'coreKeywords':_0x350c2b['slice'](0x0,0x3),'situationalKeywords':_0x29ae90};}function _0x492011(_0x365368,_0x31fa81,_0x125d11){const _0x12264a=_0x204348;let _0x1d31b0;_0x125d11==='hours'?_0x1d31b0=Date['now']()-_0x31fa81*0x3c*0x3c*0x3e8:_0x1d31b0=Date['now']()-_0x31fa81*0x18*0x3c*0x3c*0x3e8;const _0x2704dd=_0x365368[_0x12264a(0x1d5)][_0x12264a(0xaf1)](_0x47ec58=>_0x47ec58[_0x12264a(0xf16)]>_0x1d31b0&&!_0x47ec58[_0x12264a(0x7a0)]);if(_0x2704dd[_0x12264a(0x131d)]<0x3)return'';const _0xcda447=_0x2704dd[_0x12264a(0xbf6)](_0x2d29f5=>{const _0x363861=_0x12264a;if(typeof _0x2d29f5[_0x363861(0x1316)]===_0x363861(0x861))return _0x2d29f5[_0x363861(0x1316)];if(_0x2d29f5[_0x363861(0x259)]===_0x363861(0xefa))return _0x2d29f5[_0x363861(0x1316)];if(_0x2d29f5[_0x363861(0x259)]===_0x363861(0x22b))return(_0x2d29f5[_0x363861(0x4d9)]||'')+'\x20'+(_0x2d29f5['description']||'');return'';})[_0x12264a(0x56c)]('\x20'),_0x45404e=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0xab1ed5=_0xcda447[_0x12264a(0x41c)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x4b2e26=new Map();_0xab1ed5[_0x12264a(0x12c2)](_0xcd4e1b=>{const _0x3e8612=_0x12264a;_0xcd4e1b[_0x3e8612(0x131d)]>0x1&&!_0x45404e[_0x3e8612(0x31c)](_0xcd4e1b)&&_0x4b2e26[_0x3e8612(0xe71)](_0xcd4e1b,(_0x4b2e26[_0x3e8612(0x36d)](_0xcd4e1b)||0x0)+0x1);});const _0x41cfec=[..._0x4b2e26[_0x12264a(0x1309)]()][_0x12264a(0xc12)]((_0x215ed7,_0x271f4c)=>_0x271f4c[0x1]-_0x215ed7[0x1])['map'](_0x1d1887=>_0x1d1887[0x0]);if(_0x41cfec['length']===0x0)return'';let _0x51614d;return _0x125d11==='hours'?_0x51614d='最近'+_0x31fa81+_0x12264a(0x130):_0x31fa81===0x1?_0x51614d=_0x12264a(0xf8d):_0x51614d='最近'+_0x31fa81+_0x12264a(0x19a),_0x12264a(0x11de)+_0x51614d+_0x12264a(0xcc8)+_0x41cfec[_0x12264a(0x5b0)](0x0,0x3)[_0x12264a(0x56c)]('、\x20')+_0x12264a(0xbf);}function _0x3ff900(_0xb97dd8){const _0x417caf=_0x204348;if(!_0xb97dd8||typeof _0xb97dd8!==_0x417caf(0x861))return null;const _0x5d2505=_0xb97dd8[_0x417caf(0x33b)](/^```json\s*/,'')[_0x417caf(0x33b)](/```$/,'')[_0x417caf(0x2aa)](),_0x52b889=_0x5d2505['match'](/{[\s\S]*}/);if(_0x52b889)try{const _0x4cb43a=JSON[_0x417caf(0x44c)](_0x52b889[0x0]);return console['log'](_0x417caf(0xffd)),_0x4cb43a;}catch(_0x4f255b){console[_0x417caf(0x1b6)](_0x417caf(0x10cc));}const _0x545190=_0x5d2505['match'](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0x545190&&_0x545190[0x1])return console[_0x417caf(0x7d1)](_0x417caf(0xeae)),{'summary':_0x545190[0x1][_0x417caf(0x33b)](/\\"/g,'\x22')};if(_0x5d2505)return console[_0x417caf(0x7d1)](_0x417caf(0x28d)),{'summary':_0x5d2505};return null;}async function _0x3073d5(_0x1b933c){const _0x2af310=_0x204348;let _0x37134e=_0x42f206[_0x2af310(0x954)][_0x1b933c];if(!_0x37134e)return;let _0x60f2ca=_0x37134e;if(_0x37134e[_0x2af310(0x726)]){const _0x4872da=_0x37134e[_0x2af310(0xfa8)][_0x2af310(0xbf6)](_0xa9736c=>{const _0x57bfba=_0x2af310,_0x338ca5=_0x42f206['chats'][_0xa9736c['id']];if(_0x338ca5&&_0x338ca5['longTermMemory']&&_0x338ca5[_0x57bfba(0x94a)][_0x57bfba(0x131d)]>=0x2)return{'text':_0x57bfba(0x4b7)+_0xa9736c[_0x57bfba(0x1118)]+_0x57bfba(0xc4a)+_0x338ca5[_0x57bfba(0x94a)][_0x57bfba(0x131d)]+'条)','value':_0xa9736c['id']};return null;})['filter'](Boolean);if(_0x4872da[_0x2af310(0x131d)]===0x0){alert(_0x2af310(0xd6));return;}const _0x1f69c7=await _0xcd7475(_0x2af310(0x68e),_0x4872da);if(!_0x1f69c7)return;_0x60f2ca=_0x42f206[_0x2af310(0x954)][_0x1f69c7];}if(!_0x60f2ca[_0x2af310(0x94a)]||_0x60f2ca[_0x2af310(0x94a)][_0x2af310(0x131d)]<0x2){alert('“'+_0x60f2ca['name']+_0x2af310(0x22d));return;}const _0x548d23=_0x60f2ca[_0x2af310(0x94a)][_0x2af310(0x131d)],_0x5bc20a=await _0xcd7475(_0x2af310(0x1381),[{'text':_0x2af310(0x4bb)+_0x548d23+'条)','value':_0x2af310(0xfe2)},{'text':_0x2af310(0xe19),'value':'20'},{'text':'最近\x2050\x20条','value':'50'},{'text':_0x2af310(0x1322),'value':_0x2af310(0x630)},{'text':_0x2af310(0xdf1),'value':'custom'}][_0x2af310(0xaf1)](_0x52dc7a=>_0x52dc7a[_0x2af310(0x8dd)]===_0x2af310(0xfe2)||_0x52dc7a[_0x2af310(0x8dd)]===_0x2af310(0x76a)||parseInt(_0x52dc7a['value'])<_0x548d23));if(_0x5bc20a===null)return;let _0x291000,_0x222ab6=_0x548d23;if(_0x5bc20a==='all')_0x291000=[..._0x60f2ca[_0x2af310(0x94a)]];else{if(_0x5bc20a==='custom'){const _0xa89d5f=await _0x335e57(_0x2af310(0x114e),_0x2af310(0x10d3)+_0x548d23+_0x2af310(0xc9f));if(_0xa89d5f===null)return;const _0x4e929e=parseInt(_0xa89d5f);if(isNaN(_0x4e929e)||_0x4e929e<0x2||_0x4e929e>_0x548d23){alert(_0x2af310(0x113a)+_0x548d23+_0x2af310(0x1255));return;}_0x222ab6=_0x4e929e,_0x291000=_0x60f2ca[_0x2af310(0x94a)]['slice'](-_0x222ab6);}else _0x222ab6=parseInt(_0x5bc20a),_0x222ab6>=_0x548d23?(_0x291000=[..._0x60f2ca[_0x2af310(0x94a)]],_0x222ab6=_0x548d23):_0x291000=_0x60f2ca[_0x2af310(0x94a)][_0x2af310(0x5b0)](-_0x222ab6);}const _0x1f1b46=await _0x335e57('设置精炼字数',_0x2af310(0x12ff),_0x2af310(0xdff));if(_0x1f1b46===null)return;const _0x1e8dc6=parseInt(_0x1f1b46);if(isNaN(_0x1e8dc6)||_0x1e8dc6<0x14){alert(_0x2af310(0x1347));return;}const _0x34178c=await _0x2532b9('确认精炼记忆？',_0x2af310(0xe40)+_0x222ab6+_0x2af310(0x9c)+_0x1e8dc6+_0x2af310(0x15a),{'confirmButtonClass':'btn-danger','confirmText':_0x2af310(0x142c)});if(!_0x34178c)return;const _0x1cddf0=_0x291000[_0x2af310(0xbf6)](_0x38a9c0=>'-\x20'+_0x38a9c0[_0x2af310(0x1316)])['join']('\x0a'),_0x550466=_0x42f206[_0x2af310(0x551)][_0x2af310(0x308)]||'用户',_0x3ec533=new Date()['toLocaleDateString'](_0x2af310(0xaa2),{'year':_0x2af310(0x4fb),'month':_0x2af310(0x1dc),'day':_0x2af310(0x4fb)}),_0x4ae661='\x0a#\x20你的任务\x0a你就是角色“'+_0x60f2ca[_0x2af310(0xa1)]+_0x2af310(0x812)+_0x550466+_0x2af310(0x435)+_0x3ec533+_0x2af310(0x6ad)+_0x3ec533+'”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【【【长度铁律】】】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**'+_0x1e8dc6+_0x2af310(0x9e0)+_0x60f2ca['settings'][_0x2af310(0x31d)]+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x60f2ca[_0x2af310(0xda2)]['myPersona']+_0x2af310(0xd8c)+_0x1cddf0+_0x2af310(0x440)+_0x60f2ca['originalName']+_0x2af310(0x1256);await _0x34fce8(_0x2af310(0x12b9),_0x2af310(0x87));try{const _0x4ff46d=_0x42f206['apiConfig'][_0x2af310(0x1380)]&&_0x42f206[_0x2af310(0x5cb)]['secondaryApiKey']&&_0x42f206[_0x2af310(0x5cb)][_0x2af310(0xdc9)],{proxyUrl:_0x57b999,apiKey:_0x55a575,model:_0x5f34b6}=_0x4ff46d?{'proxyUrl':_0x42f206[_0x2af310(0x5cb)][_0x2af310(0x1380)],'apiKey':_0x42f206[_0x2af310(0x5cb)]['secondaryApiKey'],'model':_0x42f206[_0x2af310(0x5cb)][_0x2af310(0xdc9)]}:_0x42f206['apiConfig'];if(!_0x57b999||!_0x55a575||!_0x5f34b6)throw new Error(_0x2af310(0xa6e));let _0x52f654=_0x57b999[_0x2af310(0xd8d)]('generativelanguage'),_0x1882a8=_0x5d73db(_0x5f34b6,_0x55a575,_0x4ae661,[{'role':_0x2af310(0xf86),'content':_0x2af310(0xfd7)}]);const _0x3bf87c=_0x52f654?await fetch(_0x1882a8[_0x2af310(0x1377)],_0x1882a8['data']):await fetch(_0x57b999+_0x2af310(0xd7),{'method':_0x2af310(0x1312),'headers':{'Content-Type':_0x2af310(0xa0e),'Authorization':_0x2af310(0x8aa)+_0x55a575},'body':JSON[_0x2af310(0xc04)]({'model':_0x5f34b6,'messages':[{'role':'system','content':_0x4ae661},{'role':_0x2af310(0xf86),'content':_0x2af310(0xfd7)}],'temperature':0.2})});if(!_0x3bf87c['ok'])throw new Error('API\x20错误:\x20'+_0x3bf87c['statusText']);const _0x518220=await _0x3bf87c[_0x2af310(0xaef)]();let _0x1cfb39=_0x52f654?getGeminiResponseText(_0x518220):_0x518220[_0x2af310(0x2f9)][0x0]['message'][_0x2af310(0x1316)];const _0x465573=_0x3ff900(_0x1cfb39);if(_0x465573&&_0x465573[_0x2af310(0x7f1)]&&typeof _0x465573[_0x2af310(0x7f1)]===_0x2af310(0x861)&&_0x465573[_0x2af310(0x7f1)]['trim']()){const _0x499c53=await _0x2532b9(_0x2af310(0x12f5),_0x2af310(0x8b2)+_0x222ab6+_0x2af310(0x947)+_0x465573[_0x2af310(0x7f1)]['trim']()+_0x2af310(0xb5a),{'confirmText':_0x2af310(0x939),'cancelText':_0x2af310(0x12ad),'confirmButtonClass':_0x2af310(0x4d3)});if(_0x499c53){const _0x431022={'content':_0x465573[_0x2af310(0x7f1)][_0x2af310(0x2aa)](),'timestamp':Date[_0x2af310(0x606)](),'source':'refined'},_0x237de1=_0x548d23-_0x222ab6,_0x2ccdd4=_0x237de1>0x0?_0x60f2ca[_0x2af310(0x94a)][_0x2af310(0x5b0)](0x0,_0x237de1):[];_0x60f2ca[_0x2af310(0x94a)]=[..._0x2ccdd4,_0x431022],_0x60f2ca[_0x2af310(0xa7e)]=Date['now'](),await _0x17d534[_0x2af310(0x954)]['put'](_0x60f2ca),document[_0x2af310(0x458)](_0x2af310(0xbe2))[_0x2af310(0x11c2)][_0x2af310(0x526)](_0x2af310(0xfe1))&&_0x29936a(),await _0x34fce8('精炼成功',_0x2af310(0x579)+_0x222ab6+_0x2af310(0x1286));}else await _0x34fce8(_0x2af310(0xb1),_0x2af310(0xce0));}else throw new Error('AI返回了空的或格式不正确的总结内容。');}catch(_0x108b5f){console['error'](_0x2af310(0xed1),_0x108b5f),await _0x34fce8(_0x2af310(0x368),_0x2af310(0x76)+_0x108b5f[_0x2af310(0x7aa)]);}}async function _0x4206ff(_0x36dccc,_0x281367=![]){const _0x2ebb95=_0x204348,_0x4adc74=_0x42f206[_0x2ebb95(0x954)][_0x36dccc];if(!_0x4adc74)return;const _0x1f93d8=_0x4adc74[_0x2ebb95(0xa7e)]||0x0,_0x52f243=_0x281367?_0x4adc74[_0x2ebb95(0x1d5)][_0x2ebb95(0xaf1)](_0x378127=>!_0x378127[_0x2ebb95(0x7a0)]||_0x378127['role']===_0x2ebb95(0x1370)&&_0x378127[_0x2ebb95(0x1316)][_0x2ebb95(0xd8d)]('内心独白'))['slice'](-(_0x4adc74[_0x2ebb95(0xda2)]['autoMemoryInterval']||0x14)):_0x4adc74[_0x2ebb95(0x1d5)][_0x2ebb95(0xaf1)](_0x1de76e=>_0x1de76e['timestamp']>_0x1f93d8&&(!_0x1de76e['isHidden']||_0x1de76e[_0x2ebb95(0xaeb)]===_0x2ebb95(0x1370)&&_0x1de76e[_0x2ebb95(0x1316)]['includes']('内心独白')));if(_0x52f243[_0x2ebb95(0x131d)]<0x5){if(_0x281367)alert(_0x2ebb95(0xda));return;}const _0x1df8b8=_0x42f206[_0x2ebb95(0x551)][_0x2ebb95(0x308)]||'用户',_0x1e139b=_0x52f243[_0x2ebb95(0xbf6)](_0x5c9052=>{const _0x414cee=_0x2ebb95;if(_0x5c9052[_0x414cee(0x7a0)]&&_0x5c9052[_0x414cee(0xaeb)]===_0x414cee(0x1370)&&_0x5c9052[_0x414cee(0x1316)][_0x414cee(0xd8d)]('内心独白'))return _0x5c9052[_0x414cee(0x1316)];let _0x465c48;_0x5c9052[_0x414cee(0xaeb)]===_0x414cee(0xf86)?_0x465c48=_0x1df8b8:_0x465c48=_0x5c9052['senderName']||_0x4adc74['originalName'];let _0x470ca3='';if(_0x5c9052[_0x414cee(0x259)]===_0x414cee(0x22b)){if(_0x5c9052[_0x414cee(0x1316)])_0x470ca3=_0x5c9052[_0x414cee(0x1316)];else{const _0x8311f0=_0x5c9052[_0x414cee(0x4d9)]?'「'+_0x5c9052[_0x414cee(0x4d9)]+'」':'',_0x4c6284=_0x5c9052[_0x414cee(0x4e9)]?'('+_0x5c9052[_0x414cee(0x4e9)]+')':'';_0x470ca3=(_0x8311f0+'\x20'+_0x4c6284)[_0x414cee(0x2aa)]();}}else _0x470ca3=String(_0x5c9052[_0x414cee(0x1316)]);return _0x465c48+':\x20'+_0x470ca3;})['join']('\x0a');let _0x450136;if(_0x4adc74[_0x2ebb95(0x726)])_0x450136=_0x2ebb95(0xbb7)+_0x1df8b8+_0x2ebb95(0xc09)+_0x1e139b+_0x2ebb95(0x4f9)+_0x4adc74[_0x2ebb95(0xfa8)][_0x2ebb95(0xbf6)](_0x32aa60=>'-\x20'+_0x32aa60[_0x2ebb95(0x1118)]+'\x20(本名:\x20'+_0x32aa60[_0x2ebb95(0xa1)]+')')[_0x2ebb95(0x56c)]('\x0a')+_0x2ebb95(0x81f);else{const _0x46d615=new Date()[_0x2ebb95(0x1423)](_0x2ebb95(0xaa2),{'year':_0x2ebb95(0x4fb),'month':'long','day':_0x2ebb95(0x4fb)});_0x450136=_0x2ebb95(0xf1c)+_0x4adc74[_0x2ebb95(0xa1)]+_0x2ebb95(0xebc)+_0x1df8b8+'”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x46d615+'**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合“今天是'+_0x46d615+_0x2ebb95(0x2d9)+new Date(Date['now']()+0x5265c00)[_0x2ebb95(0x1423)](_0x2ebb95(0xaa2),{'month':'long','day':_0x2ebb95(0x4fb)})+_0x2ebb95(0x11ca)+_0x4adc74['settings']['aiPersona']+_0x2ebb95(0x9fe)+_0x4adc74[_0x2ebb95(0xda2)][_0x2ebb95(0x65f)]+_0x2ebb95(0x12ba)+_0x1e139b+_0x2ebb95(0x440)+_0x4adc74[_0x2ebb95(0xa1)]+_0x2ebb95(0x13c7);}try{const _0x36b869=_0x42f206[_0x2ebb95(0x5cb)][_0x2ebb95(0x1380)]&&_0x42f206[_0x2ebb95(0x5cb)]['secondaryApiKey']&&_0x42f206[_0x2ebb95(0x5cb)][_0x2ebb95(0xdc9)],{proxyUrl:_0x15d628,apiKey:_0x36b4b4,model:_0x13f077}=_0x36b869?{'proxyUrl':_0x42f206[_0x2ebb95(0x5cb)]['secondaryProxyUrl'],'apiKey':_0x42f206[_0x2ebb95(0x5cb)][_0x2ebb95(0x121d)],'model':_0x42f206[_0x2ebb95(0x5cb)][_0x2ebb95(0xdc9)]}:_0x42f206[_0x2ebb95(0x5cb)];if(!_0x15d628||!_0x36b4b4||!_0x13f077)throw new Error('API未配置');let _0x9d2915=_0x15d628[_0x2ebb95(0xd8d)](_0x2ebb95(0xfe3)),_0x601445=_0x5d73db(_0x13f077,_0x36b4b4,_0x450136,[{'role':'user','content':_0x2ebb95(0xef0)}]);const _0x51ff3e=_0x9d2915?await fetch(_0x601445[_0x2ebb95(0x1377)],_0x601445['data']):await fetch(_0x15d628+_0x2ebb95(0xd7),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x2ebb95(0x8aa)+_0x36b4b4},'body':JSON[_0x2ebb95(0xc04)]({'model':_0x13f077,'messages':[{'role':'system','content':_0x450136},{'role':'user','content':_0x2ebb95(0xef0)}],'temperature':0.2})});if(!_0x51ff3e['ok'])throw new Error(_0x2ebb95(0x676)+_0x51ff3e[_0x2ebb95(0xf0c)]);const _0x5a6a36=await _0x51ff3e[_0x2ebb95(0xaef)]();let _0x47334e=_0x9d2915?getGeminiResponseText(_0x5a6a36):_0x5a6a36[_0x2ebb95(0x2f9)][0x0][_0x2ebb95(0x7aa)]['content'];_0x47334e=_0x47334e['replace'](/^```json\s*/,'')[_0x2ebb95(0x33b)](/```$/,'')[_0x2ebb95(0x2aa)]();const _0x2b059c=JSON['parse'](_0x47334e);if(_0x4adc74[_0x2ebb95(0x726)]){if(_0x2b059c[_0x2ebb95(0x11fc)]&&typeof _0x2b059c[_0x2ebb95(0x11fc)]===_0x2ebb95(0x620)){let _0x1cd179=0x0;for(const _0x1307b2 in _0x2b059c[_0x2ebb95(0x11fc)]){const _0x434398=_0x2b059c[_0x2ebb95(0x11fc)][_0x1307b2];if(_0x434398&&_0x434398[_0x2ebb95(0x2aa)]()){const _0x2f7553=Object[_0x2ebb95(0x6eb)](_0x42f206[_0x2ebb95(0x954)])[_0x2ebb95(0xb07)](_0x485129=>_0x485129['originalName']===_0x1307b2);if(_0x2f7553){const _0x5b1f00={'content':_0x434398[_0x2ebb95(0x2aa)](),'timestamp':Date[_0x2ebb95(0x606)](),'source':_0x2ebb95(0x835)+_0x4adc74['name']};if(!_0x2f7553['longTermMemory'])_0x2f7553[_0x2ebb95(0x94a)]=[];_0x2f7553['longTermMemory'][_0x2ebb95(0x129e)](_0x5b1f00),await _0x17d534[_0x2ebb95(0x954)][_0x2ebb95(0xf3f)](_0x2f7553),_0x1cd179++;}}}if(_0x1cd179>0x0)console[_0x2ebb95(0x7d1)](_0x2ebb95(0x57f)+_0x1cd179+'\x20位群成员生成并注入了个性化记忆！');else throw new Error('AI返回了空的或格式不正确的总结内容。');}else throw new Error(_0x2ebb95(0x1298));}else{if(_0x2b059c['summary']&&_0x2b059c[_0x2ebb95(0x7f1)][_0x2ebb95(0x2aa)]()){const _0xab7541={'content':_0x2b059c[_0x2ebb95(0x7f1)][_0x2ebb95(0x2aa)](),'timestamp':Date[_0x2ebb95(0x606)](),'source':'auto'};_0x4adc74[_0x2ebb95(0x94a)][_0x2ebb95(0x129e)](_0xab7541),await _0x17d534['chats'][_0x2ebb95(0xf3f)](_0x4adc74),console[_0x2ebb95(0x7d1)](_0x2ebb95(0x12e2));}else throw new Error(_0x2ebb95(0x3f9));}_0x4adc74[_0x2ebb95(0xa7e)]=_0x52f243[_0x2ebb95(0x5b0)](-0x1)[0x0]['timestamp'],await _0x17d534[_0x2ebb95(0x954)][_0x2ebb95(0xf3f)](_0x4adc74),document['getElementById'](_0x2ebb95(0xbe2))[_0x2ebb95(0x11c2)][_0x2ebb95(0x526)](_0x2ebb95(0xfe1))&&_0x29936a();}catch(_0x236738){console[_0x2ebb95(0xb61)]('总结长期记忆时出错:',_0x236738),await _0x34fce8('总结失败',_0x2ebb95(0x137c)+_0x236738[_0x2ebb95(0x7aa)]);}}function _0x306207(){const _0x2f4fdd=_0x204348;if(!_0x362918)return;const _0x334058=_0x42f206['chats'][_0x42f206[_0x2f4fdd(0x81d)]],_0x389f57=_0x334058[_0x2f4fdd(0x1d5)][_0x2f4fdd(0xb07)](_0x56de5e=>_0x56de5e[_0x2f4fdd(0xf16)]===_0x362918&&!_0x56de5e[_0x2f4fdd(0x7a0)]);if(!_0x389f57)return;let _0x41368f;_0x389f57[_0x2f4fdd(0xaeb)]===_0x2f4fdd(0xf86)?_0x41368f=_0x334058['isGroup']?_0x334058['settings'][_0x2f4fdd(0xc7d)]||'我':'我':_0x334058[_0x2f4fdd(0x726)]?_0x41368f=_0x32d364(_0x334058,_0x389f57[_0x2f4fdd(0x2a3)]):_0x41368f=_0x334058[_0x2f4fdd(0x132a)];const _0x381972=String(_0x389f57[_0x2f4fdd(0x1316)]||'');let _0x2a14b4='';if(typeof _0x389f57[_0x2f4fdd(0x1316)]==='string'&&_0x30c9b4[_0x2f4fdd(0x9c0)](_0x389f57[_0x2f4fdd(0x1316)]))_0x2a14b4='[表情]';else{if(_0x389f57[_0x2f4fdd(0x259)]==='ai_image'||_0x389f57[_0x2f4fdd(0x259)]===_0x2f4fdd(0x305))_0x2a14b4=_0x2f4fdd(0xf72);else _0x389f57[_0x2f4fdd(0x259)]==='voice_message'?_0x2a14b4=_0x2f4fdd(0x8a0):_0x2a14b4=_0x381972[_0x2f4fdd(0xa6d)](0x0,0x32)+(_0x381972['length']>0x32?'...':'');}_0x9db598={'timestamp':_0x389f57['timestamp'],'senderName':_0x41368f,'content':_0x381972};const _0x45e572=document[_0x2f4fdd(0x458)](_0x2f4fdd(0xe7e));_0x45e572[_0x2f4fdd(0x586)](_0x2f4fdd(0x125b))[_0x2f4fdd(0x1a2)]='回复\x20'+_0x9db598['senderName']+':',_0x45e572['querySelector'](_0x2f4fdd(0x7f4))[_0x2f4fdd(0x1a2)]=_0x2a14b4,_0x45e572[_0x2f4fdd(0x1104)]['display']=_0x2f4fdd(0x1188),_0x2419bd(),document[_0x2f4fdd(0x458)](_0x2f4fdd(0x238))[_0x2f4fdd(0x1248)]();}function _0xd2d593(){const _0x26b530=_0x204348;_0x9db598=null,document['getElementById'](_0x26b530(0xe7e))[_0x26b530(0x1104)]['display']=_0x26b530(0x464);}let _0x883477=null;function _0x6e71(_0x4c77c6){const _0x176f42=_0x204348;_0x883477=_0x4c77c6;const _0x46c216=_0x42f206[_0x176f42(0x954)][_0x42f206[_0x176f42(0x81d)]],_0x5f5dd6=_0x46c216[_0x176f42(0x1d5)][_0x176f42(0xb07)](_0x190fd9=>_0x190fd9[_0x176f42(0xf16)]===_0x4c77c6);_0x5f5dd6&&(document[_0x176f42(0x458)](_0x176f42(0xc37))['textContent']=_0x5f5dd6[_0x176f42(0x2a3)]),document[_0x176f42(0x458)](_0x176f42(0x3f1))[_0x176f42(0x11c2)][_0x176f42(0xa58)](_0x176f42(0x67d));}function _0x455e8d(){const _0x8f518c=_0x204348;document[_0x8f518c(0x458)](_0x8f518c(0x3f1))['classList'][_0x8f518c(0x1097)](_0x8f518c(0x67d)),_0x883477=null;}async function _0x547e97(_0x1ef51a){const _0x124349=_0x204348;if(!_0x883477)return;const _0x2217b4=_0x883477,_0x29e7ed=_0x42f206['chats'][_0x42f206['activeChatId']],_0x3e8549=_0x29e7ed[_0x124349(0x1d5)][_0x124349(0x4a8)](_0x565fc5=>_0x565fc5[_0x124349(0xf16)]===_0x2217b4);if(_0x3e8549===-0x1)return;const _0x3787bf=_0x29e7ed['history'][_0x3e8549];_0x3787bf[_0x124349(0x13b2)]=_0x1ef51a;let _0x37046e;if(_0x1ef51a===_0x124349(0x62c)){const _0x196322={'role':'user','type':'transfer','isRefund':!![],'amount':_0x3787bf[_0x124349(0x116)],'note':_0x124349(0x9f5),'timestamp':Date[_0x124349(0x606)]()};_0x29e7ed[_0x124349(0x1d5)][_0x124349(0x129e)](_0x196322),_0x37046e=_0x124349(0x3ca)+_0x3787bf[_0x124349(0x2a3)]+_0x124349(0xf2f);}else _0x37046e='[系统提示：你接受了“'+_0x3787bf['senderName']+_0x124349(0xf2f);const _0x1bc2f2={'role':'system','content':_0x37046e,'timestamp':Date[_0x124349(0x606)]()+0x1,'isHidden':!![]};_0x29e7ed[_0x124349(0x1d5)][_0x124349(0x129e)](_0x1bc2f2),await _0x17d534[_0x124349(0x954)][_0x124349(0xf3f)](_0x29e7ed),_0x455e8d(),_0x359c96(_0x42f206['activeChatId']),_0x27be5e();}async function _0x351a9b(){const _0x1a9923=_0x204348;_0x589d88(_0x1a9923(0x73c));const _0x504b92=document['getElementById'](_0x1a9923(0x349)),_0x1285e5=document[_0x1a9923(0x458)]('call-history-title');_0x504b92[_0x1a9923(0x110d)]='',_0x1285e5[_0x1a9923(0x1a2)]=_0x1a9923(0xe5f);const _0x25ecfb=await _0x17d534[_0x1a9923(0x920)][_0x1a9923(0x50b)](_0x1a9923(0xf16))[_0x1a9923(0x115b)]()[_0x1a9923(0x511)]();if(_0x25ecfb[_0x1a9923(0x131d)]===0x0){_0x504b92[_0x1a9923(0x110d)]=_0x1a9923(0xf75);return;}_0x25ecfb['forEach'](_0x32e35a=>{const _0x103622=_0x1a9923,_0x4b055c=_0xeb8683(_0x32e35a);_0x4376d8(_0x4b055c,async()=>{const _0x4ee2a5=_0x1a5b,_0x19989b=await _0x335e57(_0x4ee2a5(0xa3d),_0x4ee2a5(0xbb2),_0x32e35a['customName']||'');if(_0x19989b===null)return;await _0x17d534[_0x4ee2a5(0x920)]['update'](_0x32e35a['id'],{'customName':_0x19989b[_0x4ee2a5(0x2aa)]()}),await _0x351a9b(),await _0x34fce8('成功',_0x4ee2a5(0xbd9));}),_0x504b92[_0x103622(0x1079)](_0x4b055c);});}function _0xeb8683(_0x556a3f){const _0x3ab247=_0x204348,_0x529794=document[_0x3ab247(0xe7d)]('div');_0x529794[_0x3ab247(0x69b)]=_0x3ab247(0x1438),_0x529794[_0x3ab247(0x1f4)][_0x3ab247(0x12bb)]=_0x556a3f['id'];const _0x48b7b9=_0x42f206[_0x3ab247(0x954)][_0x556a3f[_0x3ab247(0xfca)]],_0x41b1cd=_0x48b7b9?_0x48b7b9[_0x3ab247(0x132a)]:_0x3ab247(0xda7),_0x36c208=new Date(_0x556a3f[_0x3ab247(0xf16)]),_0x2b69ab=_0x36c208['getFullYear']()+'-'+String(_0x36c208[_0x3ab247(0x63a)]()+0x1)[_0x3ab247(0x508)](0x2,'0')+'-'+String(_0x36c208[_0x3ab247(0x14c)]())[_0x3ab247(0x508)](0x2,'0')+'\x20'+String(_0x36c208['getHours']())[_0x3ab247(0x508)](0x2,'0')+':'+String(_0x36c208['getMinutes']())[_0x3ab247(0x508)](0x2,'0'),_0x2f0790=Math[_0x3ab247(0xbd5)](_0x556a3f[_0x3ab247(0x563)]/0x3c)+'分'+_0x556a3f['duration']%0x3c+'秒',_0x50c469=_0x556a3f[_0x3ab247(0x1008)]['map'](_0x522991=>_0x3ab247(0xfa9)+_0x522991[_0x3ab247(0x5c6)]+'\x22\x20alt=\x22'+_0x522991['name']+_0x3ab247(0x133f)+_0x522991[_0x3ab247(0x132a)]+'\x22>')['join']('');return _0x529794[_0x3ab247(0x110d)]=_0x3ab247(0x10b9)+_0x2b69ab+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>'+_0x2f0790+_0x3ab247(0x7f2)+(_0x556a3f[_0x3ab247(0x9f2)]?'<div\x20class=\x22custom-title\x22>'+_0x556a3f['customName']+_0x3ab247(0xb44):'')+_0x3ab247(0xcf)+_0x50c469+_0x3ab247(0x1015)+_0x41b1cd+_0x3ab247(0x1c0),_0x529794;}async function _0x39f00e(_0x493381){const _0x31f5fc=_0x204348,_0xd41c51=await _0x17d534[_0x31f5fc(0x920)][_0x31f5fc(0x36d)](_0x493381);if(!_0xd41c51)return;const _0x1489f5=document[_0x31f5fc(0x458)](_0x31f5fc(0x452)),_0x1a39e7=document[_0x31f5fc(0x458)](_0x31f5fc(0x128b)),_0x5b08b9=document[_0x31f5fc(0x458)](_0x31f5fc(0x1093));_0x1a39e7['textContent']='通话于\x20'+new Date(_0xd41c51[_0x31f5fc(0xf16)])['toLocaleString']()+'\x20(时长:\x20'+Math[_0x31f5fc(0xbd5)](_0xd41c51[_0x31f5fc(0x563)]/0x3c)+'分'+_0xd41c51[_0x31f5fc(0x563)]%0x3c+'秒)',_0x5b08b9[_0x31f5fc(0x110d)]='';const _0x2bc997=document['getElementById'](_0x31f5fc(0x6e4)),_0x311449=document[_0x31f5fc(0x458)](_0x31f5fc(0x9a2));!_0xd41c51[_0x31f5fc(0x473)]||_0xd41c51[_0x31f5fc(0x473)][_0x31f5fc(0x131d)]===0x0?(_0x5b08b9[_0x31f5fc(0x110d)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>',_0x311449[_0x31f5fc(0x1104)]['display']=_0x31f5fc(0x464)):(_0x311449[_0x31f5fc(0x1104)][_0x31f5fc(0x4db)]=_0x31f5fc(0x1188),_0xd41c51[_0x31f5fc(0x473)]['forEach'](_0x5f01d3=>{const _0x5e04a4=_0x31f5fc,_0x1c9a65=document[_0x5e04a4(0xe7d)](_0x5e04a4(0x1323));_0x1c9a65[_0x5e04a4(0x69b)]='transcript-entry\x20'+_0x5f01d3[_0x5e04a4(0xaeb)],_0x1c9a65[_0x5e04a4(0x1a2)]=_0x5f01d3[_0x5e04a4(0x1316)],_0x5b08b9[_0x5e04a4(0x1079)](_0x1c9a65);}));const _0x432d33=_0x2bc997[_0x31f5fc(0x350)](!![]);_0x2bc997[_0x31f5fc(0x135e)][_0x31f5fc(0x3f2)](_0x432d33,_0x2bc997);const _0x515b31=_0x311449[_0x31f5fc(0x350)](!![]);_0x311449[_0x31f5fc(0x135e)][_0x31f5fc(0x3f2)](_0x515b31,_0x311449),_0x432d33[_0x31f5fc(0xd85)]('click',async()=>{const _0x481199=_0x31f5fc,_0xd49ed0=await _0x2532b9(_0x481199(0x1ef),_0x481199(0xf2),{'confirmButtonClass':_0x481199(0x4d3)});_0xd49ed0&&(_0x1489f5[_0x481199(0x11c2)]['remove'](_0x481199(0x67d)),await _0x17d534[_0x481199(0x920)][_0x481199(0x195)](_0x493381),await _0x351a9b(),alert(_0x481199(0x111d)));}),_0x515b31['addEventListener'](_0x31f5fc(0x1122),async()=>{const _0x54719f=_0x31f5fc,_0x1e8356=await _0x2532b9(_0x54719f(0x1027),'这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？',{'confirmText':'确认总结'});if(!_0x1e8356)return;_0x1489f5[_0x54719f(0x11c2)][_0x54719f(0x1097)](_0x54719f(0x67d));const _0x412d84=_0x42f206[_0x54719f(0x954)][_0xd41c51[_0x54719f(0xfca)]];if(!_0x412d84){alert('错误：找不到该通话记录所属的聊天对象。');return;}await _0x34fce8(_0x54719f(0x12b9),_0x54719f(0x556));try{const _0x239507=_0xd41c51[_0x54719f(0x473)][_0x54719f(0xbf6)](_0x1b6b14=>{const _0x271793=_0x54719f,_0x25d745=_0x1b6b14[_0x271793(0xaeb)]===_0x271793(0xf86)?_0x412d84['settings'][_0x271793(0xc7d)]||'我':_0x1b6b14['senderName']||_0x412d84[_0x271793(0x132a)];return _0x25d745+':\x20'+_0x1b6b14[_0x271793(0x1316)];})[_0x54719f(0x56c)]('\x0a');await _0x112eb4(_0xd41c51[_0x54719f(0xfca)],_0x239507),await _0x34fce8(_0x54719f(0xf40),_0x54719f(0x817)+_0x412d84[_0x54719f(0x132a)]+_0x54719f(0xae0));}catch(_0x23880d){await _0x34fce8(_0x54719f(0x117),'操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20'+_0x23880d[_0x54719f(0x7aa)]);}});const _0x297a3d=document['getElementById']('close-transcript-modal-btn'),_0x52589f=_0x297a3d['cloneNode'](!![]);_0x297a3d[_0x31f5fc(0x135e)][_0x31f5fc(0x3f2)](_0x52589f,_0x297a3d),_0x52589f[_0x31f5fc(0xd85)]('click',()=>{const _0x3cca46=_0x31f5fc;_0x1489f5[_0x3cca46(0x11c2)]['remove'](_0x3cca46(0x67d));}),_0x1489f5[_0x31f5fc(0x11c2)][_0x31f5fc(0xa58)](_0x31f5fc(0x67d));}async function _0x570520(){const _0x4f53bc=_0x204348;if(!_0x42f206['activeChatId']||_0x42f206[_0x4f53bc(0x954)][_0x42f206[_0x4f53bc(0x81d)]][_0x4f53bc(0x726)])return;const _0x4bc83f=_0x42f206['chats'][_0x42f206[_0x4f53bc(0x81d)]],_0x12808d=await _0x335e57('编辑对方状态','请输入对方现在的新状态：',_0x4bc83f['status'][_0x4f53bc(0xdd5)]);_0x12808d!==null&&(_0x4bc83f[_0x4f53bc(0x13b2)]['text']=_0x12808d[_0x4f53bc(0x2aa)]()||'在线',_0x4bc83f[_0x4f53bc(0x13b2)][_0x4f53bc(0x91b)]=![],_0x4bc83f[_0x4f53bc(0x13b2)]['lastUpdate']=Date[_0x4f53bc(0x606)](),await _0x17d534[_0x4f53bc(0x954)][_0x4f53bc(0xf3f)](_0x4bc83f),_0x359c96(_0x42f206[_0x4f53bc(0x81d)]),_0x27be5e(),await _0x34fce8(_0x4f53bc(0x13ef),'“'+_0x4bc83f['name']+_0x4f53bc(0x13fe)+_0x4bc83f['status'][_0x4f53bc(0xdd5)]));}async function _0x5a5e55(){const _0x2e302f=_0x204348,_0x885b7=document[_0x2e302f(0x458)](_0x2e302f(0x1155)),_0x4612d6=document[_0x2e302f(0x458)](_0x2e302f(0xbd2));_0x4612d6[_0x2e302f(0x110d)]='';const _0x1942b8=Object['values'](_0x42f206[_0x2e302f(0x954)]);_0x1942b8[_0x2e302f(0x12c2)](_0x4f96dd=>{const _0x32c8f1=_0x2e302f,_0x16dfd7=document['createElement']('div');_0x16dfd7['className']=_0x32c8f1(0x28c),_0x16dfd7[_0x32c8f1(0x110d)]=_0x32c8f1(0x8e)+_0x4f96dd['id']+_0x32c8f1(0x8a9)+(_0x4f96dd[_0x32c8f1(0x726)]?_0x4f96dd[_0x32c8f1(0xda2)]['groupAvatar']:_0x4f96dd[_0x32c8f1(0xda2)][_0x32c8f1(0x9c7)]||_0x4fd084)+_0x32c8f1(0x135c)+_0x4f96dd['name']+_0x32c8f1(0x91a),_0x4612d6[_0x32c8f1(0x1079)](_0x16dfd7);}),_0x885b7[_0x2e302f(0x11c2)][_0x2e302f(0xa58)](_0x2e302f(0x67d));}function _0x85f5df(_0x5f1803){const _0x17eb63=_0x204348,_0xff59a3=document[_0x17eb63(0x458)](_0x17eb63(0x2df));if(!_0xff59a3[_0x17eb63(0x11c2)][_0x17eb63(0x526)](_0x17eb63(0x67d))){if(_0x5f1803)_0x5f1803();return;}_0xff59a3[_0x17eb63(0x11c2)][_0x17eb63(0x1097)]('visible'),setTimeout(()=>{const _0x88ac48=_0x17eb63;document[_0x88ac48(0x458)](_0x88ac48(0x602))['classList'][_0x88ac48(0x1097)](_0x88ac48(0x67d));if(_0x5f1803)_0x5f1803();},0x190);}function _0x3e0f49(_0x474ee6){const _0x40e51c=_0x204348;if(!_0x474ee6)return[];const _0x5f2388=String(_0x474ee6)[_0x40e51c(0x90b)](/\r\n?|\n/),_0x3dd51a=[],_0x2d5aeb=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0x229019 of _0x5f2388){const _0x19dce1=_0x229019[_0x40e51c(0x33b)](_0x2d5aeb,'')['trim']();if(!_0x19dce1)continue;_0x2d5aeb[_0x40e51c(0x86)]=0x0;let _0x198149;while((_0x198149=_0x2d5aeb[_0x40e51c(0xb32)](_0x229019))!==null){const _0x2c58e4=parseInt(_0x198149[0x1],0xa),_0x42d063=parseInt(_0x198149[0x2],0xa),_0x2d8f7f=parseInt(_0x198149[0x3][_0x40e51c(0x1317)](0x3,'0'),0xa),_0x2abc24=_0x2c58e4*0x3c+_0x42d063+_0x2d8f7f/0x3e8;_0x3dd51a['push']({'time':_0x2abc24,'text':_0x19dce1});}}return _0x3dd51a[_0x40e51c(0xc12)]((_0x434a7a,_0x5d5cd6)=>_0x434a7a['time']-_0x5d5cd6[_0x40e51c(0x33e)]);}function _0x1616be(){const _0x1db38c=_0x204348,_0x4c4479=document['getElementById'](_0x1db38c(0x614));_0x4c4479[_0x1db38c(0x110d)]='';if(!_0x59377b[_0x1db38c(0x169)]||_0x59377b[_0x1db38c(0x169)][_0x1db38c(0x131d)]===0x0){_0x4c4479[_0x1db38c(0x110d)]='<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>';return;}_0x59377b[_0x1db38c(0x169)][_0x1db38c(0x12c2)]((_0x53975c,_0x343d2f)=>{const _0x1ff4b3=_0x1db38c,_0x36674b=document[_0x1ff4b3(0xe7d)](_0x1ff4b3(0x1323));_0x36674b[_0x1ff4b3(0x69b)]=_0x1ff4b3(0x232),_0x36674b[_0x1ff4b3(0x1a2)]=_0x53975c[_0x1ff4b3(0xdd5)],_0x36674b[_0x1ff4b3(0x1f4)][_0x1ff4b3(0xb3)]=_0x343d2f,_0x4c4479[_0x1ff4b3(0x1079)](_0x36674b);}),_0x4c4479[_0x1db38c(0x1104)][_0x1db38c(0xb7e)]=_0x1db38c(0x8fb);}function _0x22fe77(_0x575d4a){const _0x4372f3=_0x204348;if(_0x59377b[_0x4372f3(0x169)][_0x4372f3(0x131d)]===0x0)return;let _0xa2dba0=-0x1;for(let _0x3f9638=0x0;_0x3f9638<_0x59377b['parsedLyrics']['length'];_0x3f9638++){if(_0x575d4a>=_0x59377b[_0x4372f3(0x169)][_0x3f9638][_0x4372f3(0x33e)])_0xa2dba0=_0x3f9638;else break;}if(_0xa2dba0===_0x59377b['currentLyricIndex'])return;_0x59377b[_0x4372f3(0x1204)]=_0xa2dba0,_0x1da315();const _0x2a7190=document[_0x4372f3(0x458)](_0x4372f3(0x133d));_0x2a7190&&(_0xa2dba0>-0x1&&_0x59377b[_0x4372f3(0x169)][_0xa2dba0]?_0x2a7190['textContent']=_0x59377b[_0x4372f3(0x169)][_0xa2dba0][_0x4372f3(0xdd5)]:_0x2a7190[_0x4372f3(0x1a2)]=_0x4372f3(0xcce));const _0x364131=document[_0x4372f3(0x458)](_0x4372f3(0x5d4));_0x364131[_0x4372f3(0x11c2)][_0x4372f3(0x526)](_0x4372f3(0x67d))&&(_0xa2dba0>-0x1&&_0x59377b[_0x4372f3(0x169)][_0xa2dba0]?_0x364131[_0x4372f3(0x1a2)]=_0x59377b[_0x4372f3(0x169)][_0xa2dba0][_0x4372f3(0xdd5)]:_0x364131[_0x4372f3(0x1a2)]='♪');}function _0x1da315(_0x2e0bf6=![]){const _0x4706c2=_0x204348,_0x54210b=_0x2e0bf6?_0x4706c2(0x9eb):_0x4706c2(0x329),_0x1818c8=_0x2e0bf6?'#fullscreen-lyrics-container':'#music-lyrics-container',_0x36f64f=document[_0x4706c2(0x586)](_0x54210b),_0x4aa5c7=document[_0x4706c2(0x586)](_0x1818c8);if(!_0x36f64f||!_0x4aa5c7)return;const _0x4311d6=_0x36f64f['querySelectorAll']('.lyric-line');_0x4311d6[_0x4706c2(0x12c2)](_0x1d64a0=>_0x1d64a0[_0x4706c2(0x11c2)][_0x4706c2(0x1097)](_0x4706c2(0xfe1)));if(_0x59377b[_0x4706c2(0x1204)]===-0x1){_0x36f64f[_0x4706c2(0x1104)][_0x4706c2(0xb7e)]=_0x4706c2(0x8fb);return;}const _0xcba9fa=_0x36f64f['querySelector']('.lyric-line[data-index=\x22'+_0x59377b[_0x4706c2(0x1204)]+'\x22]');if(_0xcba9fa){_0xcba9fa[_0x4706c2(0x11c2)][_0x4706c2(0xa58)](_0x4706c2(0xfe1));const _0x4e53c8=_0x4aa5c7[_0x4706c2(0xcdb)],_0x43e3d3=_0x4e53c8/2.2-_0xcba9fa[_0x4706c2(0xbc5)]-_0xcba9fa['offsetHeight']/0x2;_0x36f64f[_0x4706c2(0x1104)]['transform']=_0x4706c2(0x6cb)+_0x43e3d3+_0x4706c2(0xe13);}}function _0x3e09a2(_0x57f678){const _0x42a816=_0x204348;if(isNaN(_0x57f678)||_0x57f678<0x0)return _0x42a816(0xea0);const _0x496eee=Math['floor'](_0x57f678/0x3c),_0x280391=Math['floor'](_0x57f678%0x3c);return _0x496eee+':'+String(_0x280391)[_0x42a816(0x508)](0x2,'0');}let _0x4c92de=0x0,_0xcf5977;function _0x2a7978(){_0xcf5977&&cancelAnimationFrame(_0xcf5977);function _0x4f4ee5(){const _0x328dd2=_0x1a5b;if(!_0x59377b[_0x328dd2(0x1111)]||!_0x112d48[_0x328dd2(0x563)])return;const _0x688b0b=performance[_0x328dd2(0x606)](),_0x59d670=_0x112d48[_0x328dd2(0x4b1)],_0x93b5eb=_0x112d48[_0x328dd2(0x563)],_0x42d554=_0x59d670/_0x93b5eb*0x64;document['getElementById'](_0x328dd2(0x454))[_0x328dd2(0x1104)][_0x328dd2(0x1147)]=_0x42d554+'%',_0x688b0b-_0x4c92de>0x3e8&&(document[_0x328dd2(0x458)](_0x328dd2(0xc59))[_0x328dd2(0x1a2)]=_0x3e09a2(_0x59d670),document[_0x328dd2(0x458)]('music-total-time')[_0x328dd2(0x1a2)]=_0x3e09a2(_0x93b5eb),_0x4c92de=_0x688b0b),_0x22fe77(_0x59d670),_0xcf5977=requestAnimationFrame(_0x4f4ee5);}_0xcf5977=requestAnimationFrame(_0x4f4ee5);}function _0x575ece(){const _0xa6012=_0x204348;if(!lastRawAiResponse){alert(_0xa6012(0x117d));return;}const _0x320784=document['getElementById']('ai-response-editor-modal'),_0x241915=document[_0xa6012(0x458)]('ai-response-editor-container');_0x241915[_0xa6012(0x110d)]='';const _0x2ed725=_0x418096(lastRawAiResponse);if(_0x2ed725&&_0x2ed725['length']>0x0)_0x2ed725[_0xa6012(0x12c2)](_0x75a629=>{const _0x2636ab=_0xa6012;if(typeof _0x75a629==='object'&&_0x75a629!==null)try{const _0x5da384=JSON[_0x2636ab(0xc04)](_0x75a629,null,0x2),_0x4c9798=_0x6a940(_0x5da384);_0x241915[_0x2636ab(0x1079)](_0x4c9798);}catch(_0xf50777){console['error']('在导演模式下\x20stringify\x20失败:',_0x75a629,_0xf50777);}else{if(typeof _0x75a629===_0x2636ab(0x861)){const _0x44230d=_0x6a940(_0x75a629);_0x241915['appendChild'](_0x44230d),console[_0x2636ab(0x1b6)](_0x2636ab(0x7c0),_0x75a629);}}});else{const _0x27cb12=_0x6a940(lastRawAiResponse);_0x241915[_0xa6012(0x1079)](_0x27cb12);}_0x320784[_0xa6012(0x11c2)][_0xa6012(0xa58)]('visible');}function _0x6a940(_0x5a7376=''){const _0x42ed9a=_0x204348,_0x431cd3=document[_0x42ed9a(0xe7d)](_0x42ed9a(0x1323));_0x431cd3[_0x42ed9a(0x69b)]=_0x42ed9a(0x1c1);const _0x4d3d72={'text':{'type':_0x42ed9a(0xdd5),'content':_0x42ed9a(0x1351)},'sticker':{'type':_0x42ed9a(0x869),'url':_0x42ed9a(0xc23),'meaning':_0x42ed9a(0xe84)},'image':{'type':_0x42ed9a(0xb1e),'description':_0x42ed9a(0xc1e)},'voice':{'type':_0x42ed9a(0xefa),'content':'在这里输入语音内容...'},'transfer':{'type':_0x42ed9a(0xf4e),'amount':5.2,'note':_0x42ed9a(0xbbc)},'offline':{'type':'offline_text','content':_0x42ed9a(0x13ce)},'quote':{'type':'quote_reply','target_timestamp':0x499602d2,'reply_content':'在这里输入回复内容'}};return _0x431cd3[_0x42ed9a(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>'+_0x5a7376+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x4d3d72[_0x42ed9a(0xdd5)])+_0x42ed9a(0x4b8)+JSON[_0x42ed9a(0xc04)](_0x4d3d72[_0x42ed9a(0x869)])+_0x42ed9a(0x9c4)+JSON['stringify'](_0x4d3d72[_0x42ed9a(0xefe)])+_0x42ed9a(0x2ee)+JSON[_0x42ed9a(0xc04)](_0x4d3d72['voice'])+'\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x42ed9a(0xc04)](_0x4d3d72[_0x42ed9a(0xf4e)])+_0x42ed9a(0xe3c)+JSON[_0x42ed9a(0xc04)](_0x4d3d72[_0x42ed9a(0xd39)])+_0x42ed9a(0x942)+JSON[_0x42ed9a(0xc04)](_0x4d3d72[_0x42ed9a(0xb92)])+_0x42ed9a(0xa23),_0x431cd3[_0x42ed9a(0x586)](_0x42ed9a(0xf3c))[_0x42ed9a(0xd85)](_0x42ed9a(0x1122),()=>{const _0x51157c=_0x42ed9a;_0x431cd3[_0x51157c(0x1097)]();}),_0x431cd3['querySelectorAll'](_0x42ed9a(0xb74))[_0x42ed9a(0x12c2)](_0x29b976=>{const _0x175d97=_0x42ed9a;_0x29b976[_0x175d97(0xd85)](_0x175d97(0x1122),()=>{const _0xf6ec17=_0x175d97,_0x496c67=_0x29b976[_0xf6ec17(0x1f4)][_0xf6ec17(0xc03)],_0x14b1da=_0x431cd3[_0xf6ec17(0x586)](_0xf6ec17(0xb43));if(_0x496c67&&_0x14b1da)try{const _0x29f01f=JSON['parse'](_0x496c67);_0x14b1da[_0xf6ec17(0x8dd)]=JSON[_0xf6ec17(0xc04)](_0x29f01f,null,0x2),_0x14b1da[_0xf6ec17(0x1248)]();}catch(_0x5e86a7){console['error'](_0xf6ec17(0x735),_0x5e86a7);}});}),_0x431cd3;}async function _0xb84736(){const _0x41db2e=_0x204348,_0x2e53a9=_0x42f206[_0x41db2e(0x954)][_0x42f206[_0x41db2e(0x81d)]];if(!_0x2e53a9)return;const _0x561d16=document[_0x41db2e(0x458)](_0x41db2e(0xba9)),_0x241aaa=_0x561d16[_0x41db2e(0x102a)]('textarea'),_0x4341d5=Array[_0x41db2e(0xca2)](_0x241aaa)['map'](_0x11b875=>_0x11b875[_0x41db2e(0x8dd)][_0x41db2e(0x2aa)]())['filter'](Boolean);if(_0x4341d5[_0x41db2e(0x131d)]===0x0){_0x2e53a9[_0x41db2e(0x1d5)]=_0x2e53a9[_0x41db2e(0x1d5)][_0x41db2e(0xaf1)](_0x59f848=>!lastResponseTimestamps['includes'](_0x59f848[_0x41db2e(0xf16)])),await _0x17d534[_0x41db2e(0x954)][_0x41db2e(0xf3f)](_0x2e53a9),_0x359c96(_0x42f206['activeChatId']),_0x27be5e(),document[_0x41db2e(0x458)](_0x41db2e(0x6ac))['classList']['remove'](_0x41db2e(0x67d)),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0x458845=[];for(const _0x287f29 of _0x4341d5){try{const _0x1537e0=JSON[_0x41db2e(0x44c)](_0x287f29);_0x458845[_0x41db2e(0x129e)](_0x1537e0);}catch(_0x4e075e){console[_0x41db2e(0x1b6)](_0x41db2e(0x40e),_0x287f29);}}_0x2e53a9[_0x41db2e(0x1d5)]=_0x2e53a9[_0x41db2e(0x1d5)][_0x41db2e(0xaf1)](_0x2ba995=>!lastResponseTimestamps['includes'](_0x2ba995['timestamp']));let _0x191dd0=[],_0x177fba=Date[_0x41db2e(0x606)]();for(const _0x40a260 of _0x458845){if(!_0x40a260||typeof _0x40a260!=='object'||!_0x40a260[_0x41db2e(0x259)]){console[_0x41db2e(0x1b6)](_0x41db2e(0x481),_0x40a260);continue;}let _0x295438=null;const _0x36c731={'role':_0x41db2e(0xac3),'senderName':_0x40a260['name']||_0x2e53a9[_0x41db2e(0xa1)],'timestamp':_0x177fba++};switch(_0x40a260['type']){case _0x41db2e(0xd67):{console[_0x41db2e(0x7d1)](_0x41db2e(0x2a6));const _0x1cd782=_0x41db2e(0x871)+(_0x40a260[_0x41db2e(0x3e8)]||'无')+_0x41db2e(0x68b)+(_0x40a260[_0x41db2e(0x99d)]||'无')+_0x41db2e(0x12d4)+JSON[_0x41db2e(0xc04)](_0x40a260[_0x41db2e(0x1373)]||{}),_0xe719a0={'role':'system','content':_0x1cd782,'timestamp':_0x177fba++,'isHidden':!![]};_0x2e53a9[_0x41db2e(0x1d5)][_0x41db2e(0x129e)](_0xe719a0),_0x191dd0['push'](_0xe719a0[_0x41db2e(0xf16)]);continue;}case'text':_0x295438={..._0x36c731,'content':String(_0x40a260[_0x41db2e(0x1316)]||_0x40a260[_0x41db2e(0x7aa)])};break;case _0x41db2e(0x869):{let _0x3dfe1b=![];if(_0x40a260[_0x41db2e(0x1377)]&&_0x40a260[_0x41db2e(0x32e)])_0x295438={..._0x36c731,'type':_0x41db2e(0x869),'content':_0x40a260[_0x41db2e(0x1377)],'meaning':_0x40a260['meaning']},console[_0x41db2e(0x7d1)](_0x41db2e(0x3b2)),_0x3dfe1b=!![];else{if(_0x40a260[_0x41db2e(0x32e)]){const _0x49a070=_0x42f206[_0x41db2e(0x1294)][_0x41db2e(0xb07)](_0x9ce355=>_0x9ce355['name']===_0x40a260[_0x41db2e(0x32e)]);_0x49a070?(_0x295438={..._0x36c731,'type':_0x41db2e(0x869),'content':_0x49a070[_0x41db2e(0x1377)],'meaning':_0x49a070[_0x41db2e(0x132a)]},console[_0x41db2e(0x7d1)](_0x41db2e(0x122a)),_0x3dfe1b=!![]):(_0x295438={..._0x36c731,'type':_0x41db2e(0xdd5),'content':'[表情:\x20'+_0x40a260[_0x41db2e(0x32e)]+']'},console['warn'](_0x41db2e(0x12f0),_0x40a260[_0x41db2e(0x32e)]),_0x3dfe1b=!![]);}else{if(_0x40a260[_0x41db2e(0x1377)]){_0x295438={..._0x36c731,'type':_0x41db2e(0x869),'content':_0x40a260[_0x41db2e(0x1377)]};const _0x65b49=_0x42f206[_0x41db2e(0x1294)][_0x41db2e(0xb07)](_0x26afb1=>_0x26afb1[_0x41db2e(0x1377)]===_0x40a260[_0x41db2e(0x1377)]);_0x295438['meaning']=_0x65b49?_0x65b49[_0x41db2e(0x132a)]:_0x41db2e(0x11a2),console['log'](_0x41db2e(0xe3a),_0x295438['meaning']),_0x3dfe1b=!![];}else{if(_0x40a260[_0x41db2e(0x1316)]&&typeof _0x40a260[_0x41db2e(0x1316)]==='string'&&_0x30c9b4['test'](_0x40a260[_0x41db2e(0x1316)])){_0x295438={..._0x36c731,'type':_0x41db2e(0x869),'content':_0x40a260[_0x41db2e(0x1316)]};const _0x23296b=_0x42f206['userStickers'][_0x41db2e(0xb07)](_0x18ad7b=>_0x18ad7b['url']===_0x40a260[_0x41db2e(0x1316)]);_0x295438[_0x41db2e(0x32e)]=_0x23296b?_0x23296b[_0x41db2e(0x132a)]:'未知表情',console[_0x41db2e(0x7d1)](_0x41db2e(0x12a9),_0x295438[_0x41db2e(0x32e)]),_0x3dfe1b=!![];}}}}if(!_0x3dfe1b){console[_0x41db2e(0xb61)]('导演模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):',_0x40a260);continue;}break;}case _0x41db2e(0xb1e):_0x295438={..._0x36c731,'type':'ai_image','content':_0x40a260[_0x41db2e(0x4e9)]};break;case _0x41db2e(0xb62):_0x295438={..._0x36c731,'type':_0x41db2e(0xb62),'imageUrl':_0x40a260[_0x41db2e(0x2cc)],'prompt':_0x40a260[_0x41db2e(0xb55)],'fullPrompt':_0x40a260[_0x41db2e(0x367)]};break;case'voice_message':_0x295438={..._0x36c731,'type':_0x41db2e(0xefa),'content':_0x40a260['content']};break;case _0x41db2e(0xf4e):_0x295438={..._0x36c731,'type':'transfer','amount':_0x40a260[_0x41db2e(0x116)],'note':_0x40a260[_0x41db2e(0x1187)],'receiverName':_0x40a260[_0x41db2e(0x7bc)]||'我'};break;case _0x41db2e(0x1128):_0x295438={..._0x36c731,'type':_0x41db2e(0x1128),'productInfo':_0x40a260[_0x41db2e(0xaed)],'amount':_0x40a260[_0x41db2e(0x116)],'status':_0x41db2e(0xdaa),'countdownEndTime':Date[_0x41db2e(0x606)]()+0xf*0x3c*0x3e8};break;case _0x41db2e(0x22b):_0x295438={..._0x36c731,..._0x40a260};break;case _0x41db2e(0x6a1):{const _0x4ddfd7=_0x2b82e3[_0x2e53a9['id']];if(_0x4ddfd7){const _0x5f356f=_0x4ddfd7[_0x41db2e(0x1d5)][_0x41db2e(0xc81)](_0x222d46=>_0x222d46[_0x41db2e(0x9a5)]===0x2);if(_0x5f356f>-0x1){const _0x612a8=_0x4ddfd7[_0x41db2e(0x1d5)][_0x5f356f];_0x4ddfd7['board'][_0x612a8['y']][_0x612a8['x']]=0x0,_0x4ddfd7[_0x41db2e(0x1d5)]['splice'](_0x5f356f,0x1),console[_0x41db2e(0x7d1)](_0x41db2e(0xfe0)+_0x612a8['x']+',\x20'+_0x612a8['y']+_0x41db2e(0x878));}}const _0x94cea7=parseInt(_0x40a260['x']),_0x5e8519=parseInt(_0x40a260['y']);!isNaN(_0x94cea7)&&!isNaN(_0x5e8519)?_0x2f9ca6({'x':_0x94cea7,'y':_0x5e8519},!![]):console[_0x41db2e(0x1b6)](_0x41db2e(0xd45),_0x40a260);continue;}case _0x41db2e(0xd69):{if(!_0x2e53a9[_0x41db2e(0x726)]){_0x40a260[_0x41db2e(0xe30)]&&(_0x2e53a9['heartfeltVoice']=String(_0x40a260[_0x41db2e(0xe30)]));_0x40a260[_0x41db2e(0x8a)]&&(_0x2e53a9[_0x41db2e(0x8eb)]=String(_0x40a260[_0x41db2e(0x8a)]));!Array[_0x41db2e(0x971)](_0x2e53a9[_0x41db2e(0x6b8)])&&(_0x2e53a9['thoughtsHistory']=[]);_0x2e53a9[_0x41db2e(0x6b8)][_0x41db2e(0x129e)]({'heartfeltVoice':_0x2e53a9['heartfeltVoice'],'randomJottings':_0x2e53a9['randomJottings'],'timestamp':Date[_0x41db2e(0x606)]()});_0x2e53a9['thoughtsHistory'][_0x41db2e(0x131d)]>0x32&&_0x2e53a9['thoughtsHistory']['shift']();const _0x19bd1f=_0x41db2e(0xb05)+_0x2e53a9[_0x41db2e(0xb0f)]+_0x41db2e(0xa10)+_0x2e53a9[_0x41db2e(0x8eb)],_0x3271f5={'role':_0x41db2e(0x1370),'content':_0x19bd1f,'timestamp':Date['now'](),'isHidden':!![]};}continue;}case _0x41db2e(0xf44):{const _0x4826e1=_0x2e53a9['history']['find'](_0xee386b=>_0xee386b[_0x41db2e(0xf16)]===_0x40a260[_0x41db2e(0xa7b)]);let _0x4d99b0=null;if(_0x4826e1){let _0xa6b635=_0x4826e1['senderName'];_0x4826e1[_0x41db2e(0xaeb)]==='user'&&(_0xa6b635=_0x2e53a9[_0x41db2e(0x726)]?_0x2e53a9[_0x41db2e(0xda2)][_0x41db2e(0xc7d)]||'我':_0x42f206['qzoneSettings']['nickname']||'{{user}}'),_0x4d99b0={'timestamp':_0x40a260[_0x41db2e(0xa7b)],'senderName':_0xa6b635,'content':String(_0x4826e1[_0x41db2e(0x1316)]||'')};}else _0x4d99b0={'timestamp':_0x40a260['target_timestamp'],'senderName':_0x41db2e(0x1408),'content':'原始消息已删除或不存在'};_0x295438={..._0x36c731,'content':_0x40a260[_0x41db2e(0xbca)],'quote':_0x4d99b0};break;}default:console['warn']('在导演模式保存时，遇到了未知的AI指令类型:',_0x40a260[_0x41db2e(0x259)]);break;}_0x295438&&(_0x2e53a9['history'][_0x41db2e(0x129e)](_0x295438),_0x191dd0['push'](_0x295438['timestamp']));}await _0x17d534[_0x41db2e(0x954)]['put'](_0x2e53a9),_0x359c96(_0x42f206[_0x41db2e(0x81d)]),_0x27be5e(),document[_0x41db2e(0x458)]('ai-response-editor-modal')[_0x41db2e(0x11c2)][_0x41db2e(0x1097)](_0x41db2e(0x67d)),lastRawAiResponse=_0x4341d5[_0x41db2e(0x56c)]('\x0a\x0a'),lastResponseTimestamps=_0x191dd0,await _0x34fce8('导演模式','您的修改已保存！');}async function _0x27a62f(){const _0x207ba3=_0x204348;if(!_0x362918)return;const _0x22032b=0x2*0x3c*0x3e8,_0x1e3632=_0x362918,_0xb3e241=Date['now']();if(_0xb3e241-_0x1e3632>_0x22032b){_0x2419bd(),await _0x34fce8(_0x207ba3(0x96d),'该消息发送已超过2分钟，无法撤回。');return;}await _0x426a40(_0x1e3632,!![]),_0x2419bd();}async function _0x426a40(_0xb3d959,_0x5d94af){const _0x3b1250=_0x204348,_0x23005f=_0x42f206[_0x3b1250(0x954)][_0x42f206['activeChatId']];if(!_0x23005f)return;const _0xeedc2c=_0x23005f[_0x3b1250(0x1d5)]['findIndex'](_0x2d6376=>_0x2d6376[_0x3b1250(0xf16)]===_0xb3d959);if(_0xeedc2c===-0x1)return;const _0x5534bc=_0x23005f[_0x3b1250(0x1d5)][_0xeedc2c],_0x43e3e7={'originalType':_0x5534bc[_0x3b1250(0x259)]||_0x3b1250(0xdd5),'originalContent':_0x5534bc['content'],'originalMeaning':_0x5534bc[_0x3b1250(0x32e)],'originalQuote':_0x5534bc[_0x3b1250(0xb92)]};_0x5534bc['type']=_0x3b1250(0x9dd),_0x5534bc['content']=_0x5d94af?_0x3b1250(0x10ae):_0x3b1250(0xc74),_0x5534bc[_0x3b1250(0x624)]=_0x43e3e7,delete _0x5534bc['meaning'],delete _0x5534bc[_0x3b1250(0xb92)];if(_0x5d94af){const _0x3eade2=_0x23005f[_0x3b1250(0x726)]?_0x23005f[_0x3b1250(0xda2)][_0x3b1250(0xc7d)]||'我':'我';let _0x539f9e='';if(_0x43e3e7[_0x3b1250(0x603)]==='sticker')_0x539f9e=_0x3b1250(0x31e)+(_0x43e3e7[_0x3b1250(0x260)]||'未知')+']';else _0x43e3e7[_0x3b1250(0x603)]===_0x3b1250(0xb1e)||_0x43e3e7['originalType']===_0x3b1250(0x305)?_0x539f9e=_0x3b1250(0x312)+_0x43e3e7[_0x3b1250(0x1f0)]+']':_0x539f9e='“'+String(_0x43e3e7[_0x3b1250(0x1f0)])+'”';const _0x3f0527={'role':_0x3b1250(0x1370),'content':_0x3b1250(0xd80)+_0x3eade2+_0x3b1250(0x1400)+_0x539f9e+_0x3b1250(0x1d9),'timestamp':Date['now'](),'isHidden':!![]};_0x23005f['history'][_0x3b1250(0x129e)](_0x3f0527);}await _0x17d534[_0x3b1250(0x954)][_0x3b1250(0xf3f)](_0x23005f),_0x359c96(_0x42f206['activeChatId']),_0x5d94af&&(_0x27be5e(),_0x3ee822());}async function _0x33d53f(){const _0x47bd55=_0x204348;await _0x596247(),document[_0x47bd55(0x458)](_0x47bd55(0x9f))[_0x47bd55(0x11c2)]['add'](_0x47bd55(0x67d));}async function _0x596247(){const _0x22adb1=_0x204348,_0x2c1599=document[_0x22adb1(0x458)](_0x22adb1(0x2d1)),_0x4107af=await _0x17d534[_0x22adb1(0x110b)][_0x22adb1(0x511)]();_0x2c1599[_0x22adb1(0x110d)]='',_0x4107af[_0x22adb1(0x131d)]===0x0&&(_0x2c1599[_0x22adb1(0x110d)]=_0x22adb1(0x88)),_0x4107af[_0x22adb1(0x12c2)](_0x147379=>{const _0x56283f=_0x22adb1,_0xc5b3c=document[_0x56283f(0xe7d)]('div');_0xc5b3c[_0x56283f(0x69b)]='existing-group-item',_0xc5b3c[_0x56283f(0x110d)]=_0x56283f(0x970)+_0x147379[_0x56283f(0x132a)]+_0x56283f(0x110f)+_0x147379['id']+_0x56283f(0x4d8),_0x2c1599[_0x56283f(0x1079)](_0xc5b3c);});}async function _0x3284cc(){const _0x37eaf3=_0x204348,_0x5d8fed=document[_0x37eaf3(0x458)]('new-category-name-input'),_0x142523=_0x5d8fed[_0x37eaf3(0x8dd)][_0x37eaf3(0x2aa)]();if(!_0x142523){alert('分类名不能为空！');return;}const _0x1e9894=await _0x17d534[_0x37eaf3(0x110b)]['where'](_0x37eaf3(0x132a))[_0x37eaf3(0x7db)](_0x142523)[_0x37eaf3(0xb9)]();if(_0x1e9894){alert('分类\x20\x22'+_0x142523+_0x37eaf3(0x374));return;}await _0x17d534[_0x37eaf3(0x110b)][_0x37eaf3(0xa58)]({'name':_0x142523}),_0x5d8fed[_0x37eaf3(0x8dd)]='',await _0x596247();}async function _0x266a3b(_0xc3ee0a){const _0xe56718=_0x204348,_0x110659=await _0x2532b9(_0xe56718(0x1ef),_0xe56718(0xf9a),{'confirmButtonClass':_0xe56718(0x4d3)});if(_0x110659){await _0x17d534[_0xe56718(0x110b)]['delete'](_0xc3ee0a);const _0x1df354=await _0x17d534[_0xe56718(0xab7)]['where'](_0xe56718(0x5f7))[_0xe56718(0x7db)](_0xc3ee0a)[_0xe56718(0x511)]();for(const _0x309dc3 of _0x1df354){_0x309dc3[_0xe56718(0x5f7)]=null,await _0x17d534['worldBooks'][_0xe56718(0xf3f)](_0x309dc3);const _0x6458be=_0x42f206['worldBooks'][_0xe56718(0xb07)](_0x5e1a5d=>_0x5e1a5d['id']===_0x309dc3['id']);if(_0x6458be)_0x6458be[_0xe56718(0x5f7)]=null;}await _0x596247();}}async function _0x89000c(){const _0x41a1b8=_0x204348;if(!_0x362918)return;const _0x42bc05=_0x362918;_0x2419bd();const _0x39d05e=_0x42f206[_0x41a1b8(0x954)][_0x42f206['activeChatId']],_0x59b5d3=_0x39d05e[_0x41a1b8(0x1d5)]['find'](_0x35178b=>_0x35178b[_0x41a1b8(0xf16)]===_0x42bc05);if(!_0x59b5d3)return;let _0x54e1ad=String(_0x59b5d3[_0x41a1b8(0x1316)]||'')['substring'](0x0,0x32)+_0x41a1b8(0x10a0);if(_0x59b5d3[_0x41a1b8(0x259)]==='ai_image')_0x54e1ad='[图片]\x20'+_0x54e1ad;const _0x158bf3=await _0x2532b9(_0x41a1b8(0x562),_0x41a1b8(0x255)+_0x54e1ad+'”',{'confirmText':'确定发布'});if(_0x158bf3){const _0x411c80=_0x39d05e['settings'][_0x41a1b8(0xc7d)]||'我';!Array[_0x41a1b8(0x971)](_0x39d05e[_0x41a1b8(0x3c8)])&&(_0x39d05e['announcements']=[]);const _0x10067a={'id':_0x41a1b8(0x13cc)+Date['now'](),'messageTimestamp':_0x42bc05,'publisher':_0x411c80,'publishedAt':Date[_0x41a1b8(0x606)](),'isPinned':![]};_0x39d05e['announcements'][_0x41a1b8(0x129e)](_0x10067a);const _0x181b6a={'role':_0x41a1b8(0x1370),'type':_0x41a1b8(0x3bf),'content':_0x411c80+_0x41a1b8(0xcf2),'timestamp':Date[_0x41a1b8(0x606)]()};_0x39d05e['history'][_0x41a1b8(0x129e)](_0x181b6a),await _0x17d534[_0x41a1b8(0x954)][_0x41a1b8(0xf3f)](_0x39d05e),_0x5d5ee2(_0x181b6a,_0x39d05e),_0x27be5e(),await _0x34fce8('成功',_0x41a1b8(0x12c6));}}async function _0x5c7136(){const _0x20404c=_0x204348,_0x43e5b7=_0x42f206[_0x20404c(0x954)][_0x42f206[_0x20404c(0x81d)]],_0xc7e158=_0x43e5b7[_0x20404c(0x3c8)]||[];if(!_0x43e5b7||_0xc7e158[_0x20404c(0x131d)]===0x0){_0x34fce8('提示',_0x20404c(0x1002));return;}const _0x507d48=document[_0x20404c(0x458)](_0x20404c(0x3d1));_0x507d48['innerHTML']='',_0xc7e158[_0x20404c(0xc12)]((_0x4415fe,_0x66d213)=>(_0x66d213[_0x20404c(0x858)]?0x1:0x0)-(_0x4415fe[_0x20404c(0x858)]?0x1:0x0));for(const _0x1f4107 of _0xc7e158){const _0x541c25=_0x43e5b7[_0x20404c(0x1d5)][_0x20404c(0xb07)](_0x1af26e=>_0x1af26e['timestamp']===_0x1f4107[_0x20404c(0x1193)]),_0x5a223b=document[_0x20404c(0xe7d)](_0x20404c(0x1323));_0x5a223b[_0x20404c(0x69b)]='announcement-item-wrapper';if(_0x541c25){const _0x3d6229=await _0x4b8ea5(_0x541c25,_0x43e5b7);_0x3d6229&&_0x5a223b['appendChild'](_0x3d6229);}else _0x5a223b[_0x20404c(0x110d)]=_0x20404c(0x143b);_0x1f4107[_0x20404c(0x858)]&&(_0x5a223b['innerHTML']+=_0x20404c(0xd9d)),_0x5a223b[_0x20404c(0x110d)]+='<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22'+_0x1f4107['id']+_0x20404c(0xa75),_0x507d48[_0x20404c(0x1079)](_0x5a223b);}document[_0x20404c(0x458)](_0x20404c(0x1376))[_0x20404c(0x11c2)]['add'](_0x20404c(0x67d));}let _0x4e2c09=null;function _0x39e2d6(_0x348265){const _0xc41f3b=_0x204348;_0x4e2c09=_0x348265;const _0x37dfb0=_0x42f206['chats'][_0x42f206[_0xc41f3b(0x81d)]],_0xa8a2ab=_0x37dfb0['announcements'][_0xc41f3b(0xb07)](_0x2417c8=>_0x2417c8['id']===_0x348265);if(!_0xa8a2ab)return;const _0x3179dc=document[_0xc41f3b(0x458)](_0xc41f3b(0xeba));_0x3179dc['textContent']=_0xa8a2ab[_0xc41f3b(0x858)]?_0xc41f3b(0x2db):_0xc41f3b(0x2fb),document[_0xc41f3b(0x458)](_0xc41f3b(0x110))[_0xc41f3b(0x11c2)][_0xc41f3b(0xa58)](_0xc41f3b(0x67d));}async function _0x3ccdd6(){const _0x1b6da8=_0x204348;if(!_0x4e2c09)return;const _0x15e44a=_0x42f206[_0x1b6da8(0x954)][_0x42f206[_0x1b6da8(0x81d)]],_0x259c29=_0x15e44a[_0x1b6da8(0x3c8)]['find'](_0x353e45=>_0x353e45['id']===_0x4e2c09);_0x259c29&&(_0x259c29[_0x1b6da8(0x858)]=!_0x259c29[_0x1b6da8(0x858)],await _0x17d534[_0x1b6da8(0x954)]['put'](_0x15e44a),_0x5c7136()),document[_0x1b6da8(0x458)](_0x1b6da8(0x110))[_0x1b6da8(0x11c2)]['remove']('visible');}async function _0x445c02(){const _0x15daee=_0x204348;if(!_0x4e2c09)return;const _0x2b40ba=await _0x2532b9(_0x15daee(0x1ef),'确定要删除这条公告吗？此操作不可恢复。',{'confirmButtonClass':_0x15daee(0x4d3)});if(_0x2b40ba){const _0x3f6b89=_0x42f206[_0x15daee(0x954)][_0x42f206[_0x15daee(0x81d)]];_0x3f6b89[_0x15daee(0x3c8)]=_0x3f6b89['announcements']['filter'](_0x86d83c=>_0x86d83c['id']!==_0x4e2c09),await _0x17d534['chats'][_0x15daee(0xf3f)](_0x3f6b89),_0x5c7136();}document[_0x15daee(0x458)](_0x15daee(0x110))['classList']['remove'](_0x15daee(0x67d));}let _0x1ccdc4=![],_0x1216ef={'ai':null,'my':null};function _0x21c48c(_0x3dd37a='chat'){const _0x363c73=_0x204348,_0x5ccdd7=document[_0x363c73(0x458)](_0x363c73(0x1269));if(!_0x42f206['activeChatId'])return;const _0x537f9e=_0x42f206['chats'][_0x42f206[_0x363c73(0x81d)]];_0x1ccdc4=_0x3dd37a===_0x363c73(0x59e);if(_0x1ccdc4){const _0x450254=_0x537f9e[_0x363c73(0xfa8)][_0x363c73(0xb07)](_0x4dd29c=>_0x4dd29c['id']===_0x3b3bcb);if(!_0x450254)return;_0x1216ef['my']=_0x450254['avatarFrame']||'',_0x2566cf(!![],_0x450254[_0x363c73(0x5c6)],_0x450254[_0x363c73(0x2c5)]);}else _0x1216ef['ai']=_0x537f9e['settings']['aiAvatarFrame']||'',_0x1216ef['my']=_0x537f9e[_0x363c73(0xda2)][_0x363c73(0x66f)]||'',_0x2566cf(![]);_0x5ccdd7['classList'][_0x363c73(0xa58)]('visible');}function _0x2566cf(_0x276da6=![],_0x1478fb=null,_0x4f8d76=null){const _0x3f1624=_0x204348,_0x2474b1=document[_0x3f1624(0x458)](_0x3f1624(0xc33)),_0x574704=document[_0x3f1624(0x458)](_0x3f1624(0x37a)),_0x2bbdf0=_0x42f206[_0x3f1624(0x954)][_0x42f206[_0x3f1624(0x81d)]];_0x2474b1['innerHTML']='',_0x574704[_0x3f1624(0x110d)]='',document[_0x3f1624(0x586)](_0x3f1624(0x36c))[_0x3f1624(0x1104)]['display']=_0x276da6?_0x3f1624(0x464):'flex',document[_0x3f1624(0x458)](_0x3f1624(0x375))[_0x3f1624(0x1104)][_0x3f1624(0x4db)]='block',document[_0x3f1624(0x458)](_0x3f1624(0x6c0))[_0x3f1624(0x1104)][_0x3f1624(0x4db)]=_0x3f1624(0x464),document[_0x3f1624(0x458)](_0x3f1624(0xaf8))[_0x3f1624(0x11c2)][_0x3f1624(0xa58)]('active'),document[_0x3f1624(0x458)](_0x3f1624(0x2fd))[_0x3f1624(0x11c2)][_0x3f1624(0x1097)](_0x3f1624(0xfe1));if(_0x276da6)_0x3f8fb4[_0x3f1624(0x12c2)](_0x1e3d8f=>{const _0x479816=_0x3f1624,_0x530f03=_0x14dd34(_0x1e3d8f,'my',_0x1478fb);_0x1e3d8f[_0x479816(0x1377)]===_0x4f8d76&&_0x530f03[_0x479816(0x11c2)]['add'](_0x479816(0x500)),_0x2474b1[_0x479816(0x1079)](_0x530f03);});else{const _0x25ae66=_0x2bbdf0[_0x3f1624(0xda2)][_0x3f1624(0x9c7)]||_0x4fd084,_0x5688f3=_0x2bbdf0[_0x3f1624(0xda2)][_0x3f1624(0xa6)]||(_0x2bbdf0[_0x3f1624(0x726)]?_0x502840:_0x4fd084);_0x3f8fb4[_0x3f1624(0x12c2)](_0x52862b=>{const _0x1b44d1=_0x3f1624,_0x17caf0=_0x14dd34(_0x52862b,'ai',_0x25ae66);if(_0x52862b[_0x1b44d1(0x1377)]===_0x1216ef['ai'])_0x17caf0[_0x1b44d1(0x11c2)]['add'](_0x1b44d1(0x500));_0x2474b1[_0x1b44d1(0x1079)](_0x17caf0);const _0x289478=_0x14dd34(_0x52862b,'my',_0x5688f3);if(_0x52862b[_0x1b44d1(0x1377)]===_0x1216ef['my'])_0x289478[_0x1b44d1(0x11c2)][_0x1b44d1(0xa58)]('selected');_0x574704['appendChild'](_0x289478);});}}function _0x14dd34(_0x15a585,_0x248922,_0x2a575a){const _0x17be05=_0x204348,_0x4f3eac=document[_0x17be05(0xe7d)]('div');return _0x4f3eac['className']=_0x17be05(0x5fc),_0x4f3eac['dataset']['frameUrl']=_0x15a585[_0x17be05(0x1377)],_0x4f3eac[_0x17be05(0x316)]=_0x15a585[_0x17be05(0x132a)],_0x4f3eac['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x2a575a+'\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x15a585[_0x17be05(0x1377)]?_0x17be05(0xfa9)+_0x15a585['url']+'\x22\x20class=\x22preview-frame\x22>':'')+_0x17be05(0x524),_0x4f3eac['addEventListener']('click',()=>{const _0x4a50e5=_0x17be05;_0x1216ef[_0x248922]=_0x15a585[_0x4a50e5(0x1377)];const _0x4248b4=_0x248922==='ai'?document[_0x4a50e5(0x458)]('ai-frame-grid'):document['getElementById'](_0x4a50e5(0x37a));_0x4248b4[_0x4a50e5(0x102a)]('.frame-item')[_0x4a50e5(0x12c2)](_0x3523d3=>_0x3523d3[_0x4a50e5(0x11c2)][_0x4a50e5(0x1097)](_0x4a50e5(0x500))),_0x4f3eac[_0x4a50e5(0x11c2)][_0x4a50e5(0xa58)](_0x4a50e5(0x500));}),_0x4f3eac;}async function _0x263dcb(){const _0x450349=_0x204348;if(!_0x42f206[_0x450349(0x81d)])return;const _0x54b35c=_0x42f206['chats'][_0x42f206[_0x450349(0x81d)]];if(_0x1ccdc4){const _0x4600f6=_0x54b35c[_0x450349(0xfa8)]['find'](_0x3be960=>_0x3be960['id']===_0x3b3bcb);_0x4600f6&&(_0x4600f6[_0x450349(0x2c5)]=_0x1216ef['my']);}else _0x54b35c[_0x450349(0xda2)]['aiAvatarFrame']=_0x1216ef['ai'],_0x54b35c[_0x450349(0xda2)]['myAvatarFrame']=_0x1216ef['my'];await _0x17d534[_0x450349(0x954)]['put'](_0x54b35c);if(!_0x1ccdc4&&!_0x54b35c[_0x450349(0x726)]){const _0x1c364b=_0x54b35c['id'];for(const _0x368976 of Object[_0x450349(0x6eb)](_0x42f206[_0x450349(0x954)])){if(_0x368976[_0x450349(0x726)]&&_0x368976[_0x450349(0xfa8)]){const _0x4f709e=_0x368976[_0x450349(0xfa8)][_0x450349(0xb07)](_0x3eb3a8=>_0x3eb3a8['id']===_0x1c364b);_0x4f709e&&(_0x4f709e[_0x450349(0x2c5)]=_0x54b35c[_0x450349(0xda2)][_0x450349(0xce6)],await _0x17d534[_0x450349(0x954)][_0x450349(0xf3f)](_0x368976),console['log'](_0x450349(0x2bf)+_0x1c364b+'\x20的头像框到群聊\x20\x22'+_0x368976['name']+'\x22'));}}}document[_0x450349(0x458)](_0x450349(0x1269))[_0x450349(0x11c2)][_0x450349(0x1097)](_0x450349(0x67d)),_0x359c96(_0x42f206[_0x450349(0x81d)]),alert(_0x450349(0x4ef)),_0x1ccdc4=![];}function _0x337868(){const _0x404b4d=_0x204348;_0x35df22=!_0x35df22;const _0x8487ee=document[_0x404b4d(0x458)](_0x404b4d(0x1180)),_0x26bef8=document[_0x404b4d(0x458)](_0x404b4d(0xb93)),_0x2f1926=document[_0x404b4d(0x458)]('select-all-frames-checkbox');document[_0x404b4d(0x102a)](_0x404b4d(0x51d))['forEach'](_0x3e3f60=>{const _0x490742=_0x404b4d;_0x3e3f60['classList'][_0x490742(0x1270)](_0x490742(0x833),_0x35df22);}),_0x35df22?(_0x8487ee[_0x404b4d(0x1a2)]='完成',_0x26bef8['style'][_0x404b4d(0x4db)]=_0x404b4d(0x82b),_0x1e8e3d[_0x404b4d(0x415)](),_0x2f1926['checked']=![],_0x38bad8()):(_0x8487ee[_0x404b4d(0x1a2)]='管理',_0x26bef8['style']['display']=_0x404b4d(0x464),document['querySelectorAll'](_0x404b4d(0x590))[_0x404b4d(0x12c2)](_0x289e9d=>{const _0x288fd4=_0x404b4d;_0x289e9d[_0x288fd4(0x11c2)][_0x288fd4(0x1097)]('selected');}));}function _0x38bad8(){const _0x159ac0=_0x204348,_0x46abe5=document[_0x159ac0(0x458)](_0x159ac0(0x66c));_0x46abe5[_0x159ac0(0x1a2)]=_0x159ac0(0xeab)+_0x1e8e3d[_0x159ac0(0x12a4)]+')';}function _0x1ff289(){const _0x554082=_0x204348,_0x31ecf3=document[_0x554082(0x458)](_0x554082(0xc57))[_0x554082(0x8f7)],_0x55798e=document[_0x554082(0x586)](_0x554082(0x97d));if(!_0x55798e)return;_0x55798e['querySelectorAll']('.frame-item:has(.delete-btn)')['forEach'](_0x3b5c1b=>{const _0x52d084=_0x554082,_0x13e0e7=parseInt(_0x3b5c1b[_0x52d084(0x586)](_0x52d084(0x38e))[_0x52d084(0x1f4)]['id']);if(isNaN(_0x13e0e7))return;_0x3b5c1b['classList'][_0x52d084(0x1270)](_0x52d084(0x500),_0x31ecf3),_0x31ecf3?_0x1e8e3d['add'](_0x13e0e7):_0x1e8e3d[_0x52d084(0x195)](_0x13e0e7);}),_0x38bad8();}async function _0xd899aa(){const _0x19c02a=_0x204348;if(_0x1e8e3d[_0x19c02a(0x12a4)]===0x0)return;const _0x27a658=await _0x2532b9(_0x19c02a(0x1ef),'确定要永久删除选中的\x20'+_0x1e8e3d[_0x19c02a(0x12a4)]+_0x19c02a(0x107b),{'confirmButtonClass':_0x19c02a(0x4d3)});if(_0x27a658){const _0x4b4c32=[..._0x1e8e3d];await _0x17d534[_0x19c02a(0xaa5)][_0x19c02a(0x1315)](_0x4b4c32),_0x337868(),_0x2566cf(_0x1ccdc4),await _0x34fce8(_0x19c02a(0xa59),_0x19c02a(0x9a3));}}function _0x410076(_0x1cf0c4){const _0x4fea2a=_0x204348,_0x37653f=document['getElementById'](_0x4fea2a(0xbe1));_0x37653f&&(_0x37653f[_0x4fea2a(0x110d)]=_0x1cf0c4||'');}async function _0x29e100(_0x4f0290){const _0x3be29d=_0x204348;if(!_0x59377b[_0x3be29d(0x1196)]||!_0x59377b['activeChatId'])return;const _0x48206f=_0x42f206['chats'][_0x59377b[_0x3be29d(0x81d)]];if(!_0x48206f)return;const _0x2d9db3=_0x48206f[_0x3be29d(0x726)]?_0x48206f[_0x3be29d(0xda2)]['myNickname']||'我':'我',_0x490b98=_0x3be29d(0x10b)+_0x2d9db3+')\x20'+_0x4f0290+']',_0x1a2b53={'role':_0x3be29d(0x1370),'content':_0x490b98,'timestamp':Date[_0x3be29d(0x606)](),'isHidden':!![]};_0x48206f[_0x3be29d(0x1d5)][_0x3be29d(0x129e)](_0x1a2b53),await _0x17d534[_0x3be29d(0x954)]['put'](_0x48206f);}async function _0x155bc1(){const _0x5b5790=_0x204348;if(_0x3e3048[_0x5b5790(0x12a4)]===0x0)return;const _0x5e03d6=_0x42f206[_0x5b5790(0x954)][_0x42f206['activeChatId']];if(!_0x5e03d6)return;const _0x803712=document[_0x5b5790(0x458)]('selection-screenshot-btn'),_0x130205=_0x803712[_0x5b5790(0x1a2)];_0x803712[_0x5b5790(0x1a2)]='生成中...',_0x803712[_0x5b5790(0xb18)]=!![];const _0x5dfa99=document[_0x5b5790(0xe7d)]('div'),_0x34d1cb=document['getElementById'](_0x5b5790(0xb3e));_0x5dfa99[_0x5b5790(0x1104)][_0x5b5790(0x1147)]=_0x34d1cb[_0x5b5790(0x145e)]+'px',_0x5dfa99[_0x5b5790(0x1104)]['position']='absolute',_0x5dfa99[_0x5b5790(0x1104)]['top']=_0x5b5790(0x9cd),_0x5dfa99['style']['left']='-9999px',_0x5dfa99['style']['display']=_0x5b5790(0x82b),_0x5dfa99[_0x5b5790(0x1104)][_0x5b5790(0xa0f)]=_0x5b5790(0x192),_0x5dfa99[_0x5b5790(0x1104)][_0x5b5790(0x120b)]='auto';const _0xc0aa89=document[_0x5b5790(0x458)](_0x5b5790(0xd99));_0x5dfa99[_0x5b5790(0x1104)][_0x5b5790(0xf7)]=_0xc0aa89['style'][_0x5b5790(0xf7)],_0x5dfa99['style'][_0x5b5790(0x11d7)]=_0xc0aa89[_0x5b5790(0x1104)][_0x5b5790(0x11d7)]||(document['getElementById'](_0x5b5790(0xb3e))['classList']['contains'](_0x5b5790(0x466))?_0x5b5790(0x2e1):_0x5b5790(0xe14));const _0x364f83=document[_0x5b5790(0xe7d)]('style');_0x364f83[_0x5b5790(0x110d)]=_0x5b5790(0xb9a),document[_0x5b5790(0x2ec)]['appendChild'](_0x364f83);try{const _0x212ab5=_0xc0aa89['querySelector'](_0x5b5790(0xd4c))[_0x5b5790(0x350)](!![]);_0x212ab5[_0x5b5790(0x11c2)][_0x5b5790(0xa58)](_0x5b5790(0x385));const _0x5ded2e=document[_0x5b5790(0xe7d)]('div'),_0x47f540=document[_0x5b5790(0x458)](_0x5b5790(0x13a0));_0x5ded2e[_0x5b5790(0x1104)][_0x5b5790(0x4db)]='flex',_0x5ded2e[_0x5b5790(0x1104)][_0x5b5790(0xa0f)]='column',_0x5ded2e[_0x5b5790(0x1104)][_0x5b5790(0x13c8)]='20px',_0x5ded2e[_0x5b5790(0x1104)][_0x5b5790(0x1335)]='10px\x2015px\x2020px\x2015px',_0x5ded2e[_0x5b5790(0x1104)][_0x5b5790(0x1147)]=_0x5b5790(0x84d),_0x5ded2e[_0x5b5790(0x1104)][_0x5b5790(0xac5)]=_0x5b5790(0x9e7),_0x5ded2e['dataset'][_0x5b5790(0xbdc)]=_0x47f540['dataset'][_0x5b5790(0xbdc)],_0x5ded2e[_0x5b5790(0x1104)][_0x5b5790(0x5c0)](_0x5b5790(0x3c0),_0x47f540[_0x5b5790(0x1104)][_0x5b5790(0x1166)](_0x5b5790(0x3c0)));const _0x15e035=_0xc0aa89[_0x5b5790(0x586)](_0x5b5790(0x66d))[_0x5b5790(0x350)](!![]),_0x320df0=[..._0x3e3048][_0x5b5790(0xc12)]((_0x1c9049,_0x5685c9)=>_0x1c9049-_0x5685c9);_0x320df0[_0x5b5790(0x12c2)](_0x3eb5b7=>{const _0x2b34aa=_0x5b5790,_0x5705a9=document['querySelector'](_0x2b34aa(0x12da)+_0x3eb5b7+'\x22]');if(_0x5705a9){const _0x41d357=_0x5705a9[_0x2b34aa(0xe87)](_0x2b34aa(0x11d1));_0x41d357&&_0x5ded2e[_0x2b34aa(0x1079)](_0x41d357[_0x2b34aa(0x350)](!![]));}}),_0x5dfa99[_0x5b5790(0x1079)](_0x212ab5),_0x5dfa99[_0x5b5790(0x1079)](_0x5ded2e),_0x5dfa99[_0x5b5790(0x1079)](_0x15e035),document[_0x5b5790(0x5b4)][_0x5b5790(0x1079)](_0x5dfa99);const _0x24ce4f=Array[_0x5b5790(0xca2)](_0x5dfa99['getElementsByTagName'](_0x5b5790(0x82a))),_0x1e28b2=_0x24ce4f[_0x5b5790(0xbf6)](_0x3a1f51=>new Promise((_0x574d11,_0x13ba51)=>{const _0x41db4e=_0x5b5790;if(_0x3a1f51['src'][_0x41db4e(0x13ad)]('data:')){_0x574d11();return;}const _0x595e42=new Image();_0x595e42['crossOrigin']=_0x41db4e(0xb4a),_0x595e42[_0x41db4e(0x11fa)]=_0x574d11,_0x595e42['onerror']=_0x574d11,_0x595e42[_0x41db4e(0x577)]=_0x3a1f51[_0x41db4e(0x577)];}));await Promise[_0x5b5790(0xfe2)](_0x1e28b2);const _0x2b39ae=await html2canvas(_0x5dfa99,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window[_0x5b5790(0x230)]||0x2});_0x2b39ae[_0x5b5790(0x8ba)](function(_0xcad6e4){const _0x5cca3f=_0x5b5790,_0x504942=URL[_0x5cca3f(0x795)](_0xcad6e4),_0x454fdd=document[_0x5cca3f(0xe7d)]('a');_0x454fdd['download']=_0x5cca3f(0xce3)+_0x5e03d6['name']+'-'+Date[_0x5cca3f(0x606)]()+_0x5cca3f(0x1224),_0x454fdd[_0x5cca3f(0x1173)]=_0x504942,document[_0x5cca3f(0x5b4)][_0x5cca3f(0x1079)](_0x454fdd),_0x454fdd['click'](),document[_0x5cca3f(0x5b4)][_0x5cca3f(0x626)](_0x454fdd),URL['revokeObjectURL'](_0x504942);},_0x5b5790(0x100d));}catch(_0x50eea3){console[_0x5b5790(0xb61)](_0x5b5790(0x706),_0x50eea3),await _0x34fce8('生成失败',_0x5b5790(0x1db));}finally{document[_0x5b5790(0x5b4)]['removeChild'](_0x5dfa99),document[_0x5b5790(0x2ec)][_0x5b5790(0x626)](_0x364f83),_0x803712[_0x5b5790(0x1a2)]=_0x130205,_0x803712[_0x5b5790(0xb18)]=![],_0x5bc130();}}function _0x5c8590(_0x11ba76){const _0x33c069=_0x204348;if(!_0x11ba76||typeof _0x11ba76!==_0x33c069(0x861))return'';return _0x11ba76=_0x11ba76[_0x33c069(0x33b)](/!h\{(.*?)\}/g,'<span\x20class=\x22diary-highlight\x22>$1</span>'),_0x11ba76=_0x11ba76[_0x33c069(0x33b)](/!u\{(.*?)\}/g,'<span\x20class=\x22diary-underline\x22>$1</span>'),_0x11ba76=_0x11ba76[_0x33c069(0x33b)](/!e\{(.*?)\}/g,'<span\x20class=\x22diary-emphasis\x22>$1</span>'),_0x11ba76=_0x11ba76[_0x33c069(0x33b)](/!w\{(.*?)\}/g,_0x33c069(0x319)),_0x11ba76=_0x11ba76[_0x33c069(0x33b)](/!m\{(.*?)\}/g,_0x33c069(0x998)),_0x11ba76=_0x11ba76['replace'](/\|\|(.*?)\|\|/g,_0x33c069(0x1f6)),_0x11ba76=_0x11ba76[_0x33c069(0x33b)](/\*\*(.*?)\*\*/g,_0x33c069(0x37f)),_0x11ba76=_0x11ba76['replace'](/\~\~(.*?)\~\~/g,_0x33c069(0x948)),_0x11ba76=_0x11ba76[_0x33c069(0x33b)](/\*(.*?)\*/g,_0x33c069(0xf8a)),_0x11ba76;}async function _0x595cef(){const _0x328c01=_0x204348;console[_0x328c01(0x7d1)](_0x328c01(0xfe7));let _0x5c9f2a=0x0;const _0x54b752=Object['values'](_0x42f206['chats']);for(const _0xa9753d of _0x54b752){let _0x25bbdf=![];for(const _0x2f0770 of _0xa9753d['history']){_0x2f0770[_0x328c01(0x259)]==='red_packet'&&_0x2f0770['packetType']==='direct'&&_0x2f0770['role']===_0x328c01(0xac3)&&_0x2f0770[_0x328c01(0x621)](_0x328c01(0x7bc))&&!_0x2f0770['hasOwnProperty'](_0x328c01(0x1421))&&(_0x2f0770[_0x328c01(0x1421)]=_0x2f0770[_0x328c01(0x7bc)],delete _0x2f0770[_0x328c01(0x7bc)],_0x25bbdf=!![],_0x5c9f2a++);}_0x25bbdf&&(console[_0x328c01(0x7d1)]('在聊天\x20\x22'+_0xa9753d[_0x328c01(0x132a)]+_0x328c01(0x4d2)),await _0x17d534[_0x328c01(0x954)][_0x328c01(0xf3f)](_0xa9753d));}_0x5c9f2a>0x0?(console[_0x328c01(0x7d1)](_0x328c01(0xddb)+_0x5c9f2a+_0x328c01(0x1401)),alert('检测到并成功修复了\x20'+_0x5c9f2a+_0x328c01(0x749)),location[_0x328c01(0x88a)]()):console[_0x328c01(0x7d1)]('未发现需要迁移的旧红包数据。');}function _0x376e39(_0x474fd8){const _0x20b366=_0x204348,_0xe6d6a6=_0x42f206[_0x20b366(0x954)][_0x474fd8];if(!_0xe6d6a6||_0xe6d6a6[_0x20b366(0x726)])return;document[_0x20b366(0x458)](_0x20b366(0x668))['textContent']=_0xe6d6a6['heartfeltVoice']||'...',document[_0x20b366(0x458)](_0x20b366(0xd46))[_0x20b366(0x1a2)]=_0xe6d6a6['randomJottings']||'...';const _0x2f4e0c=document[_0x20b366(0x458)](_0x20b366(0x7a3));_0x2f4e0c[_0x20b366(0x11c2)]['add']('visible');}function _0x2c364b(){const _0x4d3637=_0x204348;document['getElementById'](_0x4d3637(0x8e0))[_0x4d3637(0x1104)][_0x4d3637(0x4db)]=_0x4d3637(0x464),document[_0x4d3637(0x458)]('profile-thoughts-history-view')[_0x4d3637(0x1104)][_0x4d3637(0x4db)]=_0x4d3637(0x82b),_0x380c55();}function _0x1ec147(){const _0x478f8e=_0x204348;document[_0x478f8e(0x458)](_0x478f8e(0x30b))[_0x478f8e(0x1104)]['display']=_0x478f8e(0x464),document['getElementById'](_0x478f8e(0x8e0))[_0x478f8e(0x1104)]['display']='flex';}function _0x380c55(){const _0x5cb6e9=_0x204348,_0x55853e=document['getElementById'](_0x5cb6e9(0xeb)),_0x5868d0=_0x42f206['chats'][_0x42f206[_0x5cb6e9(0x81d)]];_0x55853e[_0x5cb6e9(0x110d)]='';if(!_0x5868d0||!_0x5868d0[_0x5cb6e9(0x6b8)]||_0x5868d0['thoughtsHistory'][_0x5cb6e9(0x131d)]===0x0){_0x55853e['innerHTML']=_0x5cb6e9(0x797);return;}const _0x306d1a=[..._0x5868d0[_0x5cb6e9(0x6b8)]][_0x5cb6e9(0x115b)](),_0x18b00d=_0x306d1a[_0x5cb6e9(0x5b0)](0x0,_0x435eaa);_0x18b00d[_0x5cb6e9(0x12c2)](_0x2cee4c=>{const _0x1901d1=_0x4ff96b(_0x2cee4c);_0x55853e['appendChild'](_0x1901d1);}),_0x23e903=_0x18b00d[_0x5cb6e9(0x131d)],_0x306d1a[_0x5cb6e9(0x131d)]>_0x23e903&&appendLoadMoreThoughtsButton(_0x55853e);}async function _0x180228(){const _0x4b2484=_0x204348;if(_0x92221f)return;_0x92221f=!![];const _0x58579d=document[_0x4b2484(0x458)](_0x4b2484(0xeb)),_0x290635=_0x42f206[_0x4b2484(0x954)][_0x42f206['activeChatId']];if(!_0x290635){_0x92221f=![];return;}_0x4c8ce6(_0x58579d,'bottom'),await new Promise(_0x2b113d=>setTimeout(_0x2b113d,0x1f4));const _0x1d4abf=[..._0x290635['thoughtsHistory']]['reverse'](),_0x40a17b=_0x1d4abf[_0x4b2484(0x131d)],_0x267b63=_0x23e903,_0x2fe23e=_0x23e903+_0x435eaa,_0xf7083e=_0x1d4abf[_0x4b2484(0x5b0)](_0x267b63,_0x2fe23e);_0x17adee(_0x58579d),_0xf7083e[_0x4b2484(0x12c2)](_0x3621a7=>{const _0x21d14d=_0x4b2484,_0x5a6cab=_0x4ff96b(_0x3621a7);_0x58579d[_0x21d14d(0x1079)](_0x5a6cab);}),_0x23e903+=_0xf7083e[_0x4b2484(0x131d)],_0x92221f=![];}function _0x4ff96b(_0x52ba88){const _0x340282=_0x204348,_0x436254=document[_0x340282(0xe7d)](_0x340282(0x1323));_0x436254[_0x340282(0x69b)]=_0x340282(0xe63);const _0x2ac9f1=new Date(_0x52ba88[_0x340282(0xf16)]),_0x57d7c8=_0x2ac9f1[_0x340282(0xc2a)]()+'-'+String(_0x2ac9f1[_0x340282(0x63a)]()+0x1)[_0x340282(0x508)](0x2,'0')+'-'+String(_0x2ac9f1['getDate']())[_0x340282(0x508)](0x2,'0')+'\x20'+String(_0x2ac9f1['getHours']())[_0x340282(0x508)](0x2,'0')+':'+String(_0x2ac9f1[_0x340282(0x121a)]())[_0x340282(0x508)](0x2,'0');return _0x436254[_0x340282(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22'+_0x52ba88[_0x340282(0xf16)]+'\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>'+_0x57d7c8+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>'+_0x52ba88['heartfeltVoice']+_0x340282(0xd9f)+_0x52ba88['randomJottings']+_0x340282(0x1211),_0x436254;}async function _0x516faa(_0x204f98){const _0x4392e3=_0x204348,_0x1f0b04=_0x204f98[_0x4392e3(0x12df)][_0x4392e3(0x1a9)][0x0];if(!_0x1f0b04)return;try{let _0xa9eead,_0x30e7e5=null;if(_0x1f0b04['name'][_0x4392e3(0x1082)](_0x4392e3(0xb42))){const _0x36f0b3=await _0x1f0b04[_0x4392e3(0xdd5)]();_0xa9eead=JSON[_0x4392e3(0x44c)](_0x36f0b3);}else{if(_0x1f0b04[_0x4392e3(0x132a)]['endsWith'](_0x4392e3(0x1224))){const _0x2df42d=await _0x1f0b04[_0x4392e3(0x1159)]();_0xa9eead=await _0x4381e6(_0x2df42d),_0x30e7e5=await new Promise(_0x26af4d=>{const _0x30558c=_0x4392e3,_0x46004f=new FileReader();_0x46004f[_0x30558c(0x11fa)]=()=>_0x26af4d(_0x46004f[_0x30558c(0x2ed)]),_0x46004f[_0x30558c(0x96e)](_0x1f0b04);});}else throw new Error(_0x4392e3(0x109a));}await _0x160646(_0xa9eead,_0x30e7e5);}catch(_0x239cca){console[_0x4392e3(0xb61)](_0x4392e3(0xd72),_0x239cca),await _0x34fce8(_0x4392e3(0xfc4),'无法解析角色卡文件。\x0a错误:\x20'+_0x239cca[_0x4392e3(0x7aa)]);}finally{_0x204f98[_0x4392e3(0x12df)][_0x4392e3(0x8dd)]=null;}}function _0x4381e6(_0x4abe2d){return new Promise((_0x109784,_0x629dd7)=>{const _0x27593e=_0x1a5b,_0x35b452=new DataView(_0x4abe2d);if(_0x35b452[_0x27593e(0x200)](0x0)!==0x89504e47||_0x35b452[_0x27593e(0x200)](0x4)!==0xd0a1a0a)return _0x629dd7(new Error(_0x27593e(0x10e1)));let _0xa4727f=0x8;const _0x3a6780=new TextDecoder();while(_0xa4727f<_0x35b452[_0x27593e(0x792)]){const _0x5a1dfa=_0x35b452[_0x27593e(0x200)](_0xa4727f),_0x4cb2f9=_0x3a6780[_0x27593e(0x1360)](_0x4abe2d[_0x27593e(0x5b0)](_0xa4727f+0x4,_0xa4727f+0x8));if(_0x4cb2f9===_0x27593e(0x15e)){const _0x8a5e11=new Uint8Array(_0x4abe2d,_0xa4727f+0x8,_0x5a1dfa),_0x4dc9d8=_0x8a5e11[_0x27593e(0x893)](0x0);if(_0x4dc9d8!==-0x1){const _0x5c3ec1=_0x3a6780[_0x27593e(0x1360)](_0x8a5e11[_0x27593e(0x5b0)](0x0,_0x4dc9d8));if(_0x5c3ec1==='chara'){const _0x4ee39e=_0x3a6780[_0x27593e(0x1360)](_0x8a5e11['slice'](_0x4dc9d8+0x1));try{const _0x3a98f6=atob(_0x4ee39e),_0x1f07d9=new Uint8Array(_0x3a98f6['length']);for(let _0x16f6af=0x0;_0x16f6af<_0x3a98f6['length'];_0x16f6af++){_0x1f07d9[_0x16f6af]=_0x3a98f6[_0x27593e(0x12f3)](_0x16f6af);}const _0x1b94d2=new TextDecoder('utf-8')[_0x27593e(0x1360)](_0x1f07d9);_0x109784(JSON[_0x27593e(0x44c)](_0x1b94d2));return;}catch(_0x56a269){return _0x629dd7(new Error(_0x27593e(0x91e)+_0x56a269['message']));}}}}_0xa4727f+=0x4+0x4+_0x5a1dfa+0x4;}_0x629dd7(new Error(_0x27593e(0x9b2)));});}function _0x3ec5ab(_0x3d950c){const _0x2c0f18=_0x204348;if(_0x3d950c['data']?.[_0x2c0f18(0xa2c)]?.[_0x2c0f18(0x1309)]?.[_0x2c0f18(0x131d)]>0x0)return console['log'](_0x2c0f18(0x13c5)),_0x3d950c[_0x2c0f18(0x76b)]['character_book'][_0x2c0f18(0x1309)];if(_0x3d950c[_0x2c0f18(0xcf8)]?.[_0x2c0f18(0xa2c)]?.[_0x2c0f18(0x1309)]?.['length']>0x0)return console[_0x2c0f18(0x7d1)](_0x2c0f18(0xf37)),_0x3d950c['extensions'][_0x2c0f18(0xa2c)]['entries'];if(_0x3d950c[_0x2c0f18(0x76b)]?.[_0x2c0f18(0xcf8)]?.['character_book']?.[_0x2c0f18(0x1309)]?.[_0x2c0f18(0x131d)]>0x0)return console['log'](_0x2c0f18(0x891)),_0x3d950c[_0x2c0f18(0x76b)][_0x2c0f18(0xcf8)][_0x2c0f18(0xa2c)][_0x2c0f18(0x1309)];const _0xa59788=[_0x2c0f18(0xa2c),'lorebook','world_info',_0x2c0f18(0x107c)];for(const _0x14cc87 of _0xa59788){if(_0x3d950c[_0x14cc87]?.[_0x2c0f18(0x1309)]?.[_0x2c0f18(0x131d)]>0x0)return console['log'](_0x2c0f18(0xc67)+_0x14cc87+_0x2c0f18(0x27a)),_0x3d950c[_0x14cc87]['entries'];}return console[_0x2c0f18(0x7d1)]('诊断：未在此角色卡中找到任何有效的世界书数据。'),null;}async function _0x160646(_0x4d4c93,_0x570e1d=null){const _0x1860f0=_0x204348,_0xfbce8c=_0x4d4c93['data']||_0x4d4c93;if(!_0xfbce8c[_0x1860f0(0x132a)])throw new Error(_0x1860f0(0x2f3));let _0x4d1fc9=null;const _0x435982=_0x3ec5ab(_0x4d4c93);if(_0x435982){const _0x4ea45b=_0x435982['filter'](_0x57a66f=>_0x57a66f[_0x1860f0(0x12fb)]&&_0x57a66f[_0x1860f0(0x1316)])['map'](_0x527e5e=>({'keys':_0x527e5e['keys']||[],'comment':_0x527e5e[_0x1860f0(0xcb4)]||'','content':_0x527e5e['content'][_0x1860f0(0x33b)](/<memory>|<\/memory>/g,'')[_0x1860f0(0x2aa)]()}));if(_0x4ea45b[_0x1860f0(0x131d)]>0x0){const _0x29d801={'id':_0x1860f0(0x1141)+Date[_0x1860f0(0x606)](),'name':_0xfbce8c['name']+_0x1860f0(0x423),'content':_0x4ea45b,'categoryId':null};await _0x17d534['worldBooks']['add'](_0x29d801),_0x42f206['worldBooks']['push'](_0x29d801),_0x4d1fc9=_0x29d801['id'];}}let _0x470ab0=_0xfbce8c[_0x1860f0(0x4e9)]||_0x4d4c93[_0x1860f0(0x4e9)]||'无';_0x470ab0=_0x470ab0['replace'](/```yaml/g,'')[_0x1860f0(0x33b)](/```/g,'')[_0x1860f0(0x33b)](/<\/?info>/g,'')[_0x1860f0(0x33b)](/<\/?character>/g,'')['replace'](/<\/?writing_rule>/g,'')[_0x1860f0(0x33b)](/\[OOC：.*?\]/g,'')[_0x1860f0(0x2aa)]();let _0x1ad406=_0x1860f0(0x1046)+_0x470ab0+'\x0a\x0a';if(_0xfbce8c[_0x1860f0(0xcca)])_0x1ad406+=_0x1860f0(0x747)+_0xfbce8c[_0x1860f0(0xcca)]+'\x0a\x0a';if(_0xfbce8c['scenario'])_0x1ad406+=_0x1860f0(0x8b1)+_0xfbce8c[_0x1860f0(0x115)]+'\x0a\x0a';if(_0xfbce8c[_0x1860f0(0x112b)])_0x1ad406+=_0x1860f0(0xa9e)+_0xfbce8c[_0x1860f0(0x112b)]+'\x0a\x0a';const _0xea8711=_0xfbce8c[_0x1860f0(0x132a)],_0x249389=_0xfbce8c[_0x1860f0(0x132a)],_0x5e47c0=_0x1860f0(0x12fe)+Date[_0x1860f0(0x606)](),_0x3e1540={'id':_0x5e47c0,'name':_0xea8711[_0x1860f0(0x2aa)](),'originalName':_0x249389[_0x1860f0(0x2aa)](),'isGroup':![],'relationship':{'status':_0x1860f0(0xe97)},'status':{'text':'在线','lastUpdate':Date[_0x1860f0(0x606)](),'isBusy':![]},'settings':{'aiPersona':_0x1ad406,'myPersona':_0x1860f0(0x44b),'maxMemory':0xa,'aiAvatar':_0x4fd084,'myAvatar':_0x4fd084,'background':'','theme':_0x1860f0(0x1121),'fontSize':0xd,'customCss':'','linkedWorldBookIds':_0x4d1fc9?[_0x4d1fc9]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0x570e1d&&(_0x3e1540[_0x1860f0(0xda2)][_0x1860f0(0x9c7)]=_0x570e1d,_0x3e1540[_0x1860f0(0xda2)][_0x1860f0(0x5d3)][_0x1860f0(0x129e)]({'name':_0x1860f0(0x1cd),'url':_0x570e1d}));const _0x1e2a0e=_0xfbce8c[_0x1860f0(0x3b3)]||_0x4d4c93[_0x1860f0(0x3b3)];if(_0x1e2a0e&&typeof _0x1e2a0e===_0x1860f0(0x861)){const _0x3518d3=document[_0x1860f0(0xe7d)](_0x1860f0(0x1323));_0x3518d3[_0x1860f0(0x110d)]=_0x1e2a0e;const _0x397e7b=(_0x3518d3[_0x1860f0(0x1a2)]||_0x3518d3[_0x1860f0(0x11f3)]||'')['replace'](/原作者UR.*?开局/s,'')[_0x1860f0(0x2aa)]();_0x397e7b&&_0x3e1540[_0x1860f0(0x1d5)][_0x1860f0(0x129e)]({'role':'assistant','senderName':_0x3e1540[_0x1860f0(0xa1)],'content':_0x397e7b,'timestamp':Date[_0x1860f0(0x606)]()});}_0x42f206[_0x1860f0(0x954)][_0x5e47c0]=_0x3e1540,await _0x17d534[_0x1860f0(0x954)][_0x1860f0(0xf3f)](_0x3e1540),_0x27be5e();let _0x5e54b5=_0x1860f0(0x663)+_0x3e1540[_0x1860f0(0x132a)]+_0x1860f0(0x13a5);_0x4d1fc9&&(_0x5e54b5+=_0x1860f0(0x144c)),await _0x34fce8(_0x1860f0(0x5e0),_0x5e54b5);}async function _0xb46c8c(){const _0x50ece3=_0x204348;if(!_0x42f206[_0x50ece3(0x81d)])return;const _0x4098ea=_0x42f206['chats'][_0x42f206['activeChatId']],_0x452e8c=_0x4098ea[_0x50ece3(0xda2)][_0x50ece3(0x13ea)];if(!_0x452e8c||_0x452e8c['length']===0x0){alert(_0x50ece3(0xc8b));return;}const _0x303e0d=_0x452e8c[_0x50ece3(0xbf6)]((_0x2352e8,_0x422ad3)=>{const _0x27441e=_0x50ece3,_0x23c60d=_0x2352e8[_0x27441e(0x33b)](/<[^>]*>/g,'')[_0x27441e(0x2aa)]()[_0x27441e(0xa6d)](0x0,0x14);return{'text':'开场\x20'+(_0x422ad3+0x1)+':\x20'+_0x23c60d+'...','value':_0x422ad3};}),_0x5868fc=await _0xcd7475(_0x50ece3(0x2ff),_0x303e0d);if(_0x5868fc!==null){const _0x8e57d4=await _0x2532b9(_0x50ece3(0x1027),_0x50ece3(0x60f),{'confirmButtonClass':'btn-danger','confirmText':'确定切换'});if(_0x8e57d4){const _0x57b615=_0x452e8c[_0x5868fc],_0x4b26a0={'role':_0x50ece3(0xac3),'senderName':_0x4098ea[_0x50ece3(0xa1)],'content':_0x57b615,'timestamp':Date[_0x50ece3(0x606)]()};_0x4098ea[_0x50ece3(0x1d5)]=[_0x4b26a0],await _0x17d534[_0x50ece3(0x954)]['put'](_0x4098ea),_0x359c96(_0x4098ea['id']),document['getElementById'](_0x50ece3(0x8b0))[_0x50ece3(0x11c2)]['remove'](_0x50ece3(0x67d)),await _0x34fce8('成功',_0x50ece3(0x7d0));}}}function _0x3a75d2(_0x4ec9f5={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x1f3f14=_0x204348,_0x287dd3=document[_0x1f3f14(0xe7d)]('div');_0x287dd3[_0x1f3f14(0x69b)]='message-editor-block';const _0x20e69d=_0x4ec9f5['enabled']!==![]?_0x1f3f14(0x8f7):'';return _0x287dd3[_0x1f3f14(0x110d)]=_0x1f3f14(0xee1)+_0x20e69d+_0x1f3f14(0xdba)+(_0x4ec9f5['comment']||'')+_0x1f3f14(0xaba)+(_0x4ec9f5[_0x1f3f14(0x634)]||[])[_0x1f3f14(0x56c)](',\x20')+_0x1f3f14(0xb68)+(_0x4ec9f5['content']||'')+_0x1f3f14(0x1ff),_0x287dd3[_0x1f3f14(0x586)](_0x1f3f14(0xf3c))[_0x1f3f14(0xd85)](_0x1f3f14(0x1122),()=>{const _0x75459e=_0x1f3f14;_0x287dd3[_0x75459e(0x1097)]();}),_0x287dd3;}async function _0x1e0ac0(){const _0x251935=_0x204348;if(!_0x42f206[_0x251935(0x81d)])return;const _0x406dbb=_0x42f206[_0x251935(0x81d)],_0x4e1b47=document[_0x251935(0x458)](_0x251935(0xefc));if(!_0x4e1b47[_0x251935(0x11c2)]['contains']('visible')){const _0x269c71=document[_0x251935(0x586)](_0x251935(0x110e));_0x4e1b47[_0x251935(0x1104)]['top']=_0x269c71['offsetHeight']+'px',_0x4e1b47[_0x251935(0x1104)]['display']=_0x251935(0x1188),(!_0x2b82e3[_0x406dbb]||!_0x2b82e3[_0x406dbb]['isActive'])&&_0x2c9a19(_0x406dbb),_0xf69f1a(_0x406dbb),setTimeout(async()=>{const _0xefb7a7=_0x251935;_0x4e1b47[_0xefb7a7(0x11c2)][_0xefb7a7(0xa58)](_0xefb7a7(0x67d));const _0xae52bb={'role':_0xefb7a7(0x1370),'content':_0xefb7a7(0x1295),'timestamp':Date[_0xefb7a7(0x606)](),'isHidden':!![]};_0x42f206['chats'][_0x406dbb][_0xefb7a7(0x1d5)][_0xefb7a7(0x129e)](_0xae52bb),await _0x17d534[_0xefb7a7(0x954)][_0xefb7a7(0xf3f)](_0x42f206[_0xefb7a7(0x954)][_0x406dbb]);},0xa);}else await _0x3c0a25();}async function _0x3c0a25(){const _0x3217d4=_0x204348;if(!_0x42f206[_0x3217d4(0x81d)])return;const _0x25bff2=_0x42f206[_0x3217d4(0x81d)],_0x23fcd7=document[_0x3217d4(0x458)](_0x3217d4(0xefc));_0x23fcd7[_0x3217d4(0x11c2)]['remove'](_0x3217d4(0x67d)),setTimeout(()=>{const _0x55603a=_0x3217d4;_0x23fcd7[_0x55603a(0x1104)]['display']=_0x55603a(0x464);},0x12c);if(_0x2b82e3[_0x25bff2]){_0x2b82e3[_0x25bff2]['isActive']=![];const _0x1c92ee={'role':_0x3217d4(0x1370),'content':_0x3217d4(0x419),'timestamp':Date[_0x3217d4(0x606)](),'isHidden':!![]};_0x42f206[_0x3217d4(0x954)][_0x25bff2]['history'][_0x3217d4(0x129e)](_0x1c92ee),await _0x17d534['chats'][_0x3217d4(0xf3f)](_0x42f206[_0x3217d4(0x954)][_0x25bff2]);}}function _0x2c9a19(_0x3ca07b){const _0x3ee489=_0x204348,_0x1e7d44=document[_0x3ee489(0x458)]('gomoku-board'),_0x70e93b=document[_0x3ee489(0x458)](_0x3ee489(0xefc)),_0x32031d=document[_0x3ee489(0x458)]('gomoku-controls'),_0xd8a5b2=_0x70e93b['offsetWidth']-0x28,_0x7f3056=_0x70e93b[_0x3ee489(0xcdb)]-_0x32031d[_0x3ee489(0xcdb)]-0x28,_0x25f272=Math['floor'](Math['min'](_0xd8a5b2,_0x7f3056)),_0x4978dd=0xf,_0x6a63ac=Math[_0x3ee489(0xbd5)](_0x25f272/_0x4978dd),_0x11118d=_0x6a63ac*_0x4978dd;_0x1e7d44['width']=_0x11118d,_0x1e7d44[_0x3ee489(0x120b)]=_0x11118d,_0x2b82e3[_0x3ca07b]={'isActive':!![],'board':Array(_0x4978dd)[_0x3ee489(0x10d9)](0x0)['map'](()=>Array(_0x4978dd)['fill'](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0x4978dd,'CELL_SIZE':_0x6a63ac};}function _0xf69f1a(_0x343d9c){const _0x3819a0=_0x204348,_0x403258=_0x2b82e3[_0x343d9c];if(!_0x403258)return;const _0x3e9d2c=document[_0x3819a0(0x458)](_0x3819a0(0xac2)),_0x435973=_0x3e9d2c['getContext']('2d'),{GRID_SIZE:_0x3e2a72,CELL_SIZE:_0x2c9a98}=_0x403258,_0x549ba3=_0x2c9a98/0x2;_0x435973[_0x3819a0(0x52d)](0x0,0x0,_0x3e9d2c['width'],_0x3e9d2c['height']),_0x435973[_0x3819a0(0x510)]='#e4b591',_0x435973[_0x3819a0(0xe5d)](0x0,0x0,_0x3e9d2c['width'],_0x3e9d2c[_0x3819a0(0x120b)]),_0x435973[_0x3819a0(0x1016)]=_0x3819a0(0x228),_0x435973[_0x3819a0(0x144e)]=0x1;for(let _0x19f0b2=0x0;_0x19f0b2<_0x3e2a72;_0x19f0b2++){_0x435973['beginPath'](),_0x435973['moveTo'](_0x549ba3,_0x549ba3+_0x19f0b2*_0x2c9a98),_0x435973[_0x3819a0(0xdf3)](_0x3e9d2c[_0x3819a0(0x1147)]-_0x549ba3,_0x549ba3+_0x19f0b2*_0x2c9a98),_0x435973[_0x3819a0(0x113)](),_0x435973['beginPath'](),_0x435973[_0x3819a0(0x1172)](_0x549ba3+_0x19f0b2*_0x2c9a98,_0x549ba3),_0x435973[_0x3819a0(0xdf3)](_0x549ba3+_0x19f0b2*_0x2c9a98,_0x3e9d2c['height']-_0x549ba3),_0x435973[_0x3819a0(0x113)]();}for(let _0x5187f2=0x0;_0x5187f2<_0x3e2a72;_0x5187f2++){for(let _0x424cae=0x0;_0x424cae<_0x3e2a72;_0x424cae++){_0x403258[_0x3819a0(0x799)][_0x5187f2][_0x424cae]!==0x0&&_0xc1d71a(_0x435973,_0x424cae,_0x5187f2,_0x403258[_0x3819a0(0x799)][_0x5187f2][_0x424cae],_0x403258);}}}function _0xc1d71a(_0x586b9e,_0x392877,_0x525f53,_0x13a51a,_0x161f7c){const _0x1a7644=_0x204348,{CELL_SIZE:_0x370b7a}=_0x161f7c,_0x526c3b=_0x370b7a/0x2,_0x251d0f=_0x370b7a/0x2-0x2;_0x586b9e[_0x1a7644(0x1130)](),_0x586b9e[_0x1a7644(0x407)](_0x526c3b+_0x392877*_0x370b7a,_0x526c3b+_0x525f53*_0x370b7a,_0x251d0f,0x0,0x2*Math['PI']),_0x13a51a===0x1?_0x586b9e['fillStyle']=_0x1a7644(0x460):_0x586b9e[_0x1a7644(0x510)]=_0x1a7644(0x5f1),_0x586b9e[_0x1a7644(0x10d9)]();}function _0x5c3403(_0x19f170){const _0x2e9087=_0x204348,_0x19b688=_0x42f206[_0x2e9087(0x81d)],_0x51d5d3=_0x2b82e3[_0x19b688];if(!_0x51d5d3||_0x51d5d3['isGameOver']||_0x51d5d3['currentPlayer']!==0x1)return;const _0x279ca3=document['getElementById']('gomoku-board'),_0x1756e6=_0x279ca3[_0x2e9087(0xbd)]('2d'),_0x396eab=_0x279ca3[_0x2e9087(0x89d)](),_0x3359a0=_0x19f170['clientX']-_0x396eab['left'],_0x55b805=_0x19f170[_0x2e9087(0x1034)]-_0x396eab[_0x2e9087(0x76f)],_0x72ea18=Math[_0x2e9087(0x1434)]((_0x3359a0-_0x51d5d3[_0x2e9087(0xec2)]/0x2)/_0x51d5d3[_0x2e9087(0xec2)]),_0x17ee3c=Math[_0x2e9087(0x1434)]((_0x55b805-_0x51d5d3[_0x2e9087(0xec2)]/0x2)/_0x51d5d3['CELL_SIZE']);_0xf69f1a(_0x19b688);if(_0x72ea18>=0x0&&_0x72ea18<_0x51d5d3['GRID_SIZE']&&_0x17ee3c>=0x0&&_0x17ee3c<_0x51d5d3[_0x2e9087(0xc41)]&&_0x51d5d3[_0x2e9087(0x799)][_0x17ee3c][_0x72ea18]===0x0){const _0x4e3c46=_0x51d5d3[_0x2e9087(0xec2)]/0x2-0x2;_0x1756e6['beginPath'](),_0x1756e6[_0x2e9087(0x407)](_0x51d5d3['CELL_SIZE']/0x2+_0x72ea18*_0x51d5d3[_0x2e9087(0xec2)],_0x51d5d3[_0x2e9087(0xec2)]/0x2+_0x17ee3c*_0x51d5d3['CELL_SIZE'],_0x4e3c46,0x0,0x2*Math['PI']),_0x1756e6[_0x2e9087(0x510)]=_0x2e9087(0x8d2),_0x1756e6[_0x2e9087(0x10d9)]();}}function _0xef301f(_0x18bfca){const _0x47c388=_0x204348,_0x49594d=_0x42f206['activeChatId'],_0x17706f=_0x2b82e3[_0x49594d];if(!_0x17706f||_0x17706f['isGameOver']||_0x17706f[_0x47c388(0x623)]!==0x1)return;const _0x1403cb=document[_0x47c388(0x458)](_0x47c388(0xac2)),_0x3d93fc=_0x1403cb[_0x47c388(0x89d)](),_0x4ff70a=_0x18bfca[_0x47c388(0xf21)]-_0x3d93fc[_0x47c388(0x125)],_0x227513=_0x18bfca['clientY']-_0x3d93fc[_0x47c388(0x76f)],_0x4cd885=Math[_0x47c388(0x1434)]((_0x4ff70a-_0x17706f[_0x47c388(0xec2)]/0x2)/_0x17706f[_0x47c388(0xec2)]),_0x78a80b=Math[_0x47c388(0x1434)]((_0x227513-_0x17706f[_0x47c388(0xec2)]/0x2)/_0x17706f[_0x47c388(0xec2)]);_0x4cd885>=0x0&&_0x4cd885<_0x17706f['GRID_SIZE']&&_0x78a80b>=0x0&&_0x78a80b<_0x17706f['GRID_SIZE']&&_0x17706f[_0x47c388(0x799)][_0x78a80b][_0x4cd885]===0x0&&(_0x17706f[_0x47c388(0x799)][_0x78a80b][_0x4cd885]=0x1,_0x17706f['history'][_0x47c388(0x129e)]({'x':_0x4cd885,'y':_0x78a80b,'player':0x1}),_0xf69f1a(_0x49594d),_0x29e91a(_0x4cd885,_0x78a80b,0x1,_0x17706f)?(_0x17706f['isGameOver']=!![],setTimeout(()=>alert(_0x47c388(0x5a5)),0x64),_0x427ff0(_0x47c388(0xf86))):_0x17706f[_0x47c388(0x623)]=0x2);}function _0x2f9ca6(_0x45b704,_0x4bd38b=![]){const _0x9cdd88=_0x204348,_0x25665e=_0x42f206['activeChatId'],_0x3dde04=_0x2b82e3[_0x25665e];if(!_0x3dde04||_0x3dde04[_0x9cdd88(0xe35)])return;if(!_0x4bd38b&&_0x3dde04['currentPlayer']!==0x2)return;const {x:_0x4f7009,y:_0x4e7031}=_0x45b704;_0x4f7009>=0x0&&_0x4f7009<_0x3dde04[_0x9cdd88(0xc41)]&&_0x4e7031>=0x0&&_0x4e7031<_0x3dde04['GRID_SIZE']&&_0x3dde04[_0x9cdd88(0x799)][_0x4e7031][_0x4f7009]===0x0?(_0x3dde04['board'][_0x4e7031][_0x4f7009]=0x2,_0x3dde04[_0x9cdd88(0x1d5)]['push']({'x':_0x4f7009,'y':_0x4e7031,'player':0x2}),_0xf69f1a(_0x25665e),_0x29e91a(_0x4f7009,_0x4e7031,0x2,_0x3dde04)?(_0x3dde04[_0x9cdd88(0xe35)]=!![],setTimeout(()=>alert(_0x9cdd88(0x36f)),0x64),_0x427ff0('ai')):_0x3dde04[_0x9cdd88(0x623)]=0x1):(console[_0x9cdd88(0x1b6)]('AI\x20的下棋指令无效或位置已被占据:',_0x45b704),_0x3dde04['currentPlayer']=0x1);}function _0x29e91a(_0x3fee1b,_0x5a53b1,_0x24ff86,_0x40db08){const {board:_0x4b9f1f,GRID_SIZE:_0x22ca9b}=_0x40db08,_0x997a4e=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x5d0588,_0x289728]of _0x997a4e){let _0x4ae231=0x1;for(let _0x38f7e3=0x1;_0x38f7e3<0x5;_0x38f7e3++){const _0x224d58=_0x3fee1b+_0x38f7e3*_0x5d0588,_0x5f0b8b=_0x5a53b1+_0x38f7e3*_0x289728;if(_0x224d58>=0x0&&_0x224d58<_0x22ca9b&&_0x5f0b8b>=0x0&&_0x5f0b8b<_0x22ca9b&&_0x4b9f1f[_0x5f0b8b][_0x224d58]===_0x24ff86)_0x4ae231++;else break;}for(let _0x1e9d82=0x1;_0x1e9d82<0x5;_0x1e9d82++){const _0x55c700=_0x3fee1b-_0x1e9d82*_0x5d0588,_0x46a139=_0x5a53b1-_0x1e9d82*_0x289728;if(_0x55c700>=0x0&&_0x55c700<_0x22ca9b&&_0x46a139>=0x0&&_0x46a139<_0x22ca9b&&_0x4b9f1f[_0x46a139][_0x55c700]===_0x24ff86)_0x4ae231++;else break;}if(_0x4ae231>=0x5)return!![];}return![];}function _0x1d784c(_0x4263aa){const _0x1e8bb2=_0x204348;if(!_0x4263aa||!_0x4263aa['isActive'])return'';let _0x4a9d88=_0x1e8bb2(0x9bc);_0x4a9d88+=_0x4263aa[_0x1e8bb2(0x799)]['map'](_0x2e2795=>_0x2e2795[_0x1e8bb2(0x56c)]('\x20'))[_0x1e8bb2(0x56c)]('\x0a');let _0x2d1265=_0x1e8bb2(0x301);return _0x2d1265+=_0x4263aa['history'][_0x1e8bb2(0xbf6)](_0xe17278=>'玩家'+_0xe17278[_0x1e8bb2(0x9a5)]+'下在('+_0xe17278['x']+','+_0xe17278['y']+')')[_0x1e8bb2(0x56c)](_0x1e8bb2(0x436)),'\x0a#\x20当前五子棋局势\x0a'+_0x4a9d88+'\x0a\x0a#\x20'+_0x2d1265+_0x1e8bb2(0x13e);}async function _0x427ff0(_0x3e60eb){const _0x3dfc65=_0x204348,_0x5ac817=_0x42f206[_0x3dfc65(0x81d)],_0x11d844=_0x42f206[_0x3dfc65(0x954)][_0x5ac817];if(!_0x11d844)return;const _0xe8f802=_0x11d844[_0x3dfc65(0x726)]?_0x11d844[_0x3dfc65(0xda2)][_0x3dfc65(0xc7d)]||'我':'我',_0x476660=_0x11d844[_0x3dfc65(0x726)]?_0x3dfc65(0x991):_0x11d844[_0x3dfc65(0x132a)],_0x1b8564=_0x3e60eb===_0x3dfc65(0xf86)?_0xe8f802:_0x476660,_0x282d50=_0x3e60eb===_0x3dfc65(0xf86)?'你输了':_0x3dfc65(0xf11),_0x5d557f='[系统提示：五子棋游戏已结束。最终结果是：'+_0x1b8564+'\x20获胜。也就是说，'+_0x282d50+'。]',_0x3bbe2c={'role':_0x3dfc65(0x1370),'content':_0x5d557f,'timestamp':Date[_0x3dfc65(0x606)](),'isHidden':!![]};_0x11d844['history']['push'](_0x3bbe2c),await _0x17d534[_0x3dfc65(0x954)][_0x3dfc65(0xf3f)](_0x11d844),console[_0x3dfc65(0x7d1)](_0x3dfc65(0x895)+_0x3e60eb);}let _0x314234=![];async function _0x1044f9(){const _0x258028=_0x204348,_0x4e268c=document[_0x258028(0x458)](_0x258028(0xd65)),_0x9fc8ac=document[_0x258028(0x458)](_0x258028(0xd2b)),_0x31a8e4=document[_0x258028(0x458)](_0x258028(0x142f));_0x4e268c[_0x258028(0x110d)]='',_0x9fc8ac['innerHTML']='';const [_0x3073d2,_0x3f682b]=await Promise[_0x258028(0xfe2)]([_0x17d534[_0x258028(0x122c)][_0x258028(0x511)](),_0x17d534[_0x258028(0x618)][_0x258028(0x50b)](_0x258028(0x132a))[_0x258028(0x511)]()]);_0x31a8e4[_0x258028(0x11c2)][_0x258028(0x1270)]('management-mode',_0x314234);const _0x8de37e=document[_0x258028(0xe7d)](_0x258028(0x986));_0x8de37e[_0x258028(0x69b)]=_0x258028(0x44f),_0x8de37e[_0x258028(0x1a2)]='全部',_0x8de37e[_0x258028(0x1f4)][_0x258028(0x5f7)]=_0x258028(0xfe2);if(activeShoppingCategoryId==='all')_0x8de37e[_0x258028(0x11c2)][_0x258028(0xa58)](_0x258028(0xfe1));_0x9fc8ac[_0x258028(0x1079)](_0x8de37e),_0x3f682b[_0x258028(0x12c2)](_0x4994f7=>{const _0x1b3e63=_0x258028,_0x41fd56=document['createElement']('button');_0x41fd56[_0x1b3e63(0x69b)]=_0x1b3e63(0x44f),_0x41fd56[_0x1b3e63(0x1a2)]=_0x4994f7[_0x1b3e63(0x132a)],_0x41fd56[_0x1b3e63(0x1f4)][_0x1b3e63(0x5f7)]=_0x4994f7['id'];if(activeShoppingCategoryId===_0x4994f7['id'])_0x41fd56[_0x1b3e63(0x11c2)][_0x1b3e63(0xa58)](_0x1b3e63(0xfe1));_0x9fc8ac['appendChild'](_0x41fd56);});let _0x56b765;activeShoppingCategoryId===_0x258028(0xfe2)?_0x56b765=_0x3073d2:_0x56b765=_0x3073d2[_0x258028(0xaf1)](_0x5ebfed=>_0x5ebfed[_0x258028(0x5f7)]===activeShoppingCategoryId);if(_0x56b765[_0x258028(0x131d)]===0x0){const _0x408515=activeShoppingCategoryId===_0x258028(0xfe2)?_0x258028(0xabb):_0x258028(0x2eb);_0x4e268c[_0x258028(0x110d)]='<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>'+_0x408515+_0x258028(0xd36);return;}_0x56b765['forEach'](_0x2cadc5=>{const _0x3010ca=_0x258028,_0x3db047=document[_0x3010ca(0xe7d)](_0x3010ca(0x1323));_0x3db047[_0x3010ca(0x69b)]='product-item',_0x3db047['dataset']['id']=_0x2cadc5['id'];const _0x5567c6=_0x3010ca(0x6cf);_0x3db047['innerHTML']=_0x3010ca(0x5e1)+_0x5567c6+_0x3010ca(0xe10)+_0x2cadc5[_0x3010ca(0x2cc)]+_0x3010ca(0x6c5)+_0x2cadc5['name']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>'+_0x2cadc5['price'][_0x3010ca(0x800)](0x2)+_0x3010ca(0xb50),_0x4e268c['appendChild'](_0x3db047);});}function _0x2d0216(_0x210300){activeShoppingCategoryId=_0x210300,_0x1044f9(),_0x2c1038();}function _0x2c1038(){const _0x56a4f0=_0x204348,_0x269817=document[_0x56a4f0(0x458)](_0x56a4f0(0x150));if(!_0x269817)return;const _0x304e69=_0x314234&&activeShoppingCategoryId!==_0x56a4f0(0xfe2);_0x269817['style'][_0x56a4f0(0x4db)]=_0x304e69?_0x56a4f0(0x82b):_0x56a4f0(0x464);}async function _0x2833a7(){const _0x759dc8=_0x204348;if(activeShoppingCategoryId===_0x759dc8(0xfe2))return;const _0x427ac6=activeShoppingCategoryId,_0x36d5bb=await _0x17d534['shoppingCategories'][_0x759dc8(0x36d)](_0x427ac6);if(!_0x36d5bb){alert(_0x759dc8(0x11c9));return;}const _0x5dc4b8=_0x759dc8(0x123c)+_0x36d5bb[_0x759dc8(0x132a)]+_0x759dc8(0x730),_0x1660a2=await _0x2532b9(_0x759dc8(0xfa7),_0x5dc4b8,{'confirmButtonClass':_0x759dc8(0x4d3),'confirmText':_0x759dc8(0x1ef)});_0x1660a2&&(await _0x4b54a0(_0x427ac6),activeShoppingCategoryId=_0x759dc8(0xfe2),await _0x1044f9(),_0x2c1038(),await _0x34fce8('成功',_0x759dc8(0xec4)+_0x36d5bb[_0x759dc8(0x132a)]+'”\x20已被删除。'));}async function _0x23a932(){const _0x219eeb=_0x204348;activeShoppingCategoryId=_0x219eeb(0xfe2),await _0x1044f9(),_0x589d88('shopping-screen'),_0x2c1038();}async function _0x1044f9(){const _0x932f57=_0x204348,_0x20caec=document[_0x932f57(0x458)](_0x932f57(0xd65)),_0x21474c=document['getElementById'](_0x932f57(0xd2b)),_0x49dbef=document['getElementById'](_0x932f57(0x142f));_0x20caec['innerHTML']='',_0x21474c[_0x932f57(0x110d)]='';const [_0x3b68f4,_0x27005a]=await Promise[_0x932f57(0xfe2)]([_0x17d534['shoppingProducts']['toArray'](),_0x17d534[_0x932f57(0x618)][_0x932f57(0x50b)]('name')['toArray']()]);_0x49dbef[_0x932f57(0x11c2)][_0x932f57(0x1270)](_0x932f57(0x833),_0x314234);const _0x44973f=document[_0x932f57(0xe7d)](_0x932f57(0x986));_0x44973f[_0x932f57(0x69b)]=_0x932f57(0x44f),_0x44973f[_0x932f57(0x1a2)]='全部',_0x44973f['dataset'][_0x932f57(0x5f7)]=_0x932f57(0xfe2);if(activeShoppingCategoryId===_0x932f57(0xfe2))_0x44973f[_0x932f57(0x11c2)][_0x932f57(0xa58)](_0x932f57(0xfe1));_0x21474c[_0x932f57(0x1079)](_0x44973f),_0x27005a[_0x932f57(0x12c2)](_0x2d687c=>{const _0x37e552=_0x932f57,_0x2c551f=document['createElement'](_0x37e552(0x986));_0x2c551f[_0x37e552(0x69b)]=_0x37e552(0x44f),_0x2c551f[_0x37e552(0x1a2)]=_0x2d687c[_0x37e552(0x132a)],_0x2c551f[_0x37e552(0x1f4)][_0x37e552(0x5f7)]=_0x2d687c['id'];if(activeShoppingCategoryId===_0x2d687c['id'])_0x2c551f[_0x37e552(0x11c2)][_0x37e552(0xa58)](_0x37e552(0xfe1));_0x21474c['appendChild'](_0x2c551f);});let _0x409259;activeShoppingCategoryId===_0x932f57(0xfe2)?_0x409259=_0x3b68f4:_0x409259=_0x3b68f4[_0x932f57(0xaf1)](_0x5b37bc=>_0x5b37bc[_0x932f57(0x5f7)]===activeShoppingCategoryId);if(_0x409259['length']===0x0){const _0x431fa0=activeShoppingCategoryId===_0x932f57(0xfe2)?_0x932f57(0xabb):'这个分类下还没有商品哦~';_0x20caec[_0x932f57(0x110d)]=_0x932f57(0xc92)+_0x431fa0+_0x932f57(0xd36);return;}_0x409259[_0x932f57(0x12c2)](_0x2761e5=>{const _0x374b8c=_0x932f57,_0x53cf6c=document[_0x374b8c(0xe7d)]('div');_0x53cf6c['className']='product-item',_0x53cf6c[_0x374b8c(0x1f4)]['id']=_0x2761e5['id'];const _0x459510=_0x314234?_0x374b8c(0xb90):'';_0x53cf6c[_0x374b8c(0x110d)]=_0x374b8c(0x524)+_0x459510+_0x374b8c(0x442)+_0x2761e5[_0x374b8c(0x2cc)]+_0x374b8c(0x199)+_0x2761e5[_0x374b8c(0x132a)]+_0x374b8c(0x1299)+_0x2761e5[_0x374b8c(0x1043)][_0x374b8c(0x800)](0x2)+_0x374b8c(0xade),_0x20caec[_0x374b8c(0x1079)](_0x53cf6c);});}async function _0x4185d9(_0x31d42e,_0xabbe37=0x1,_0x3a14e1=null){const _0x5605ab=_0x204348,_0x4199f6=_0x3a14e1?_0x6bbec1[_0x5605ab(0xb07)](_0x3dac54=>_0x3dac54[_0x5605ab(0x1371)]===_0x31d42e&&_0x3dac54[_0x5605ab(0xfc5)]?.[_0x5605ab(0x132a)]===_0x3a14e1[_0x5605ab(0x132a)]):_0x6bbec1[_0x5605ab(0xb07)](_0x9d7294=>_0x9d7294[_0x5605ab(0x1371)]===_0x31d42e&&!_0x9d7294[_0x5605ab(0xfc5)]);if(_0x4199f6)_0x4199f6[_0x5605ab(0x177)]+=_0xabbe37;else{const _0x3ae045=await _0x17d534[_0x5605ab(0x122c)][_0x5605ab(0x36d)](_0x31d42e);_0x3ae045&&_0x6bbec1[_0x5605ab(0x129e)]({'productId':_0x3ae045['id'],'quantity':_0xabbe37,'variation':_0x3a14e1});}_0x4117ee();}function _0x4434cf(_0x2ce7d2,_0x59ffb6){const _0x494011=_0x204348,_0x26fcfb=_0x6bbec1[_0x494011(0x4a8)](_0x5bf61c=>_0x5bf61c[_0x494011(0x1371)]===_0x2ce7d2);_0x26fcfb>-0x1&&(_0x6bbec1[_0x26fcfb]['quantity']+=_0x59ffb6,_0x6bbec1[_0x26fcfb][_0x494011(0x177)]<=0x0&&_0x6bbec1[_0x494011(0x9cf)](_0x26fcfb,0x1),_0x4117ee(),_0x21ebe8());}function _0x4117ee(){const _0x3d6d18=_0x204348,_0x5f16cd=_0x6bbec1[_0x3d6d18(0x1450)]((_0x1246a8,_0x59034e)=>_0x1246a8+_0x59034e['quantity'],0x0);document[_0x3d6d18(0x458)](_0x3d6d18(0x73d))[_0x3d6d18(0x1a2)]=_0x5f16cd,document[_0x3d6d18(0x458)](_0x3d6d18(0xc0))[_0x3d6d18(0x1a2)]=_0x3d6d18(0x296)+_0x5f16cd+')',document[_0x3d6d18(0x458)](_0x3d6d18(0x6b3))[_0x3d6d18(0x1a2)]=_0x3d6d18(0x5cf)+_0x5f16cd+')';}function _0x16d996(){const _0x49bfe4=_0x204348;_0x21ebe8(),_0x589d88(_0x49bfe4(0x133a));}async function _0x21ebe8(){const _0x300643=_0x204348,_0x39a387=document[_0x300643(0x458)](_0x300643(0x12d));_0x39a387[_0x300643(0x110d)]='';let _0x53778a=0x0;if(_0x6bbec1[_0x300643(0x131d)]===0x0)_0x39a387[_0x300643(0x110d)]=_0x300643(0xa52);else{const _0x7d9c3e=_0x6bbec1[_0x300643(0xbf6)](_0x2a92a8=>_0x2a92a8[_0x300643(0x1371)]),_0x27295a=await _0x17d534['shoppingProducts'][_0x300643(0x13c6)]('id')[_0x300643(0xfd3)](_0x7d9c3e)[_0x300643(0x511)](),_0x12f873=new Map(_0x27295a['map'](_0x5a9096=>[_0x5a9096['id'],_0x5a9096]));_0x6bbec1[_0x300643(0x12c2)](_0x1dc685=>{const _0x391fc0=_0x300643,_0x3ca283=_0x12f873[_0x391fc0(0x36d)](_0x1dc685[_0x391fc0(0x1371)]);if(_0x3ca283){const _0x5da02a=document[_0x391fc0(0xe7d)](_0x391fc0(0x1323));_0x5da02a[_0x391fc0(0x69b)]=_0x391fc0(0xada);const _0x31b578=_0x1dc685['variation']?_0x391fc0(0x1ee)+_0x1dc685[_0x391fc0(0xfc5)][_0x391fc0(0x132a)]+_0x391fc0(0xb44):'';_0x5da02a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22'+_0x3ca283['id']+_0x391fc0(0xcc0)+(_0x1dc685[_0x391fc0(0xfc5)]?.['imageUrl']||_0x3ca283[_0x391fc0(0x2cc)])+_0x391fc0(0x1162)+_0x3ca283[_0x391fc0(0x132a)]+_0x391fc0(0x87a)+_0x31b578+_0x391fc0(0x118d)+(_0x1dc685[_0x391fc0(0xfc5)]?.[_0x391fc0(0x1043)]||_0x3ca283[_0x391fc0(0x1043)])[_0x391fc0(0x800)](0x2)+_0x391fc0(0x3f3)+_0x3ca283['id']+_0x391fc0(0x9bd)+_0x1dc685[_0x391fc0(0x177)]+_0x391fc0(0x1b3)+_0x3ca283['id']+'\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x39a387[_0x391fc0(0x1079)](_0x5da02a);}});}_0x3e435e();}async function _0x3e435e(){const _0x33f907=_0x204348;let _0x1b0425=0x0;const _0x595188=document[_0x33f907(0x102a)]('.cart-item-checkbox:checked'),_0x969741=Array[_0x33f907(0xca2)](_0x595188)['map'](_0x491eac=>parseInt(_0x491eac[_0x33f907(0x1f4)]['id']));if(_0x969741[_0x33f907(0x131d)]>0x0){const _0x1b5c1b=await _0x17d534[_0x33f907(0x122c)]['where']('id')[_0x33f907(0xfd3)](_0x969741)['toArray'](),_0x49d08c=new Map(_0x1b5c1b[_0x33f907(0xbf6)](_0x111c40=>[_0x111c40['id'],_0x111c40]));_0x6bbec1[_0x33f907(0x12c2)](_0x317bee=>{const _0x552eac=_0x33f907;if(_0x969741[_0x552eac(0xd8d)](_0x317bee['productId'])){const _0x29c529=_0x49d08c['get'](_0x317bee['productId']);if(_0x29c529){const _0x1be4f6=_0x317bee[_0x552eac(0xfc5)]?_0x317bee[_0x552eac(0xfc5)]['price']:_0x29c529[_0x552eac(0x1043)];_0x1b0425+=_0x1be4f6*_0x317bee['quantity'];}}});}document[_0x33f907(0x458)](_0x33f907(0x573))[_0x33f907(0x1a2)]=_0x33f907(0x10c5)+_0x1b0425[_0x33f907(0x800)](0x2);}async function _0x22dfad(){const _0x35a7ea=_0x204348,_0x33dcca=_0x42f206[_0x35a7ea(0x954)][_0x42f206[_0x35a7ea(0x81d)]];if(!_0x33dcca||!_0x33dcca[_0x35a7ea(0x726)])return;const _0x12a4fc=document['getElementById']('gift-recipient-modal'),_0x5bbbd9=document['getElementById'](_0x35a7ea(0x1225));_0x5bbbd9[_0x35a7ea(0x110d)]='';const _0x299e2b=_0x33dcca[_0x35a7ea(0xda2)][_0x35a7ea(0xc7d)]||'我',_0x5a342a=_0x33dcca[_0x35a7ea(0xfa8)][_0x35a7ea(0xaf1)](_0xdbffdd=>_0xdbffdd['groupNickname']!==_0x299e2b);_0x5a342a[_0x35a7ea(0x12c2)](_0x1bfe51=>{const _0x2c8416=_0x35a7ea,_0x3405eb=document[_0x2c8416(0xe7d)](_0x2c8416(0x1323));_0x3405eb[_0x2c8416(0x69b)]=_0x2c8416(0x28c),_0x3405eb[_0x2c8416(0x1f4)][_0x2c8416(0x1143)]=_0x1bfe51[_0x2c8416(0xa1)],_0x3405eb[_0x2c8416(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x1bfe51[_0x2c8416(0x5c6)]||_0x482806)+_0x2c8416(0x135c)+_0x1bfe51[_0x2c8416(0x1118)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x5bbbd9[_0x2c8416(0x1079)](_0x3405eb);}),document[_0x35a7ea(0x458)](_0x35a7ea(0x92d))[_0x35a7ea(0x8f7)]=![],_0x12a4fc[_0x35a7ea(0x11c2)]['add'](_0x35a7ea(0x67d));}async function _0x48d0d8(){const _0x4606d6=_0x204348,_0x25e7d9=_0x42f206['chats'][_0x42f206[_0x4606d6(0x81d)]],_0x37c782=_0x6bbec1[_0x4606d6(0xaf1)](_0x11735a=>document[_0x4606d6(0x586)](_0x4606d6(0xb77)+_0x11735a[_0x4606d6(0x1371)]+_0x4606d6(0xa29)));if(_0x37c782[_0x4606d6(0x131d)]===0x0){alert(_0x4606d6(0x4f2));return;}if(_0x25e7d9['isGroup'])_0x22dfad();else{const _0x203020=await _0x2532b9(_0x4606d6(0xfb5),_0x4606d6(0x179),{'confirmText':_0x4606d6(0x1035)});_0x203020&&await _0x20779e(_0x37c782);}}async function _0x20779e(_0x2b80ec,_0x18fdb9=null){const _0x9c384d=_0x204348;if(!_0x42f206[_0x9c384d(0x81d)])return;const _0x37745c=_0x42f206['chats'][_0x42f206[_0x9c384d(0x81d)]],_0x1d4996=_0x2b80ec[_0x9c384d(0xbf6)](_0x5a78ad=>_0x5a78ad[_0x9c384d(0x1371)]),_0x3a126e=await _0x17d534[_0x9c384d(0x122c)][_0x9c384d(0x13c6)]('id')[_0x9c384d(0xfd3)](_0x1d4996)['toArray'](),_0x406554=new Map(_0x3a126e[_0x9c384d(0xbf6)](_0x5b55a8=>[_0x5b55a8['id'],_0x5b55a8])),_0xfb096f=_0x2b80ec[_0x9c384d(0xbf6)](_0xf0435c=>{const _0x4b350b=_0x9c384d,_0x5ee769=_0x406554[_0x4b350b(0x36d)](_0xf0435c[_0x4b350b(0x1371)]);return _0xf0435c[_0x4b350b(0xfc5)]?{'name':_0x5ee769[_0x4b350b(0x132a)]+'\x20-\x20'+_0xf0435c['variation'][_0x4b350b(0x132a)],'price':_0xf0435c[_0x4b350b(0xfc5)][_0x4b350b(0x1043)],'imageUrl':_0xf0435c[_0x4b350b(0xfc5)][_0x4b350b(0x2cc)]||_0x5ee769[_0x4b350b(0x2cc)],'quantity':_0xf0435c[_0x4b350b(0x177)]}:{'name':_0x5ee769[_0x4b350b(0x132a)],'price':_0x5ee769[_0x4b350b(0x1043)],'imageUrl':_0x5ee769[_0x4b350b(0x2cc)],'quantity':_0xf0435c[_0x4b350b(0x177)]};}),_0x507b56={'role':_0x9c384d(0xf86),'type':_0x9c384d(0xfb0),'timestamp':Date['now'](),'items':_0xfb096f,'total':_0xfb096f[_0x9c384d(0x1450)]((_0xde7fdd,_0x596fec)=>_0xde7fdd+_0x596fec[_0x9c384d(0x1043)]*_0x596fec[_0x9c384d(0x177)],0x0),'recipients':_0x18fdb9};_0x37745c[_0x9c384d(0x1d5)][_0x9c384d(0x129e)](_0x507b56);if(_0x18fdb9&&_0x18fdb9['length']>0x0){const _0x4c2d0c=_0x18fdb9[_0x9c384d(0xbf6)](_0x1662f1=>_0x32d364(_0x37745c,_0x1662f1))['join']('、'),_0x4ef16c={'role':'system','content':'[系统提示：用户\x20('+(_0x37745c[_0x9c384d(0xda2)][_0x9c384d(0xc7d)]||'我')+')\x20送出了一份礼物，收礼人是：'+_0x4c2d0c+_0x9c384d(0x8cf),'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x37745c[_0x9c384d(0x1d5)][_0x9c384d(0x129e)](_0x4ef16c);}await _0x17d534[_0x9c384d(0x954)][_0x9c384d(0xf3f)](_0x37745c),_0x5d5ee2(_0x507b56,_0x37745c),_0x27be5e(),_0x6bbec1=_0x6bbec1[_0x9c384d(0xaf1)](_0x368865=>!_0x2b80ec[_0x9c384d(0x593)](_0x51f059=>_0x51f059[_0x9c384d(0x1371)]===_0x368865[_0x9c384d(0x1371)])),_0x4117ee(),_0x589d88(_0x9c384d(0xd99)),await _0x34fce8('成功',_0x9c384d(0x9d8));}function _0x57eb69(_0x3d7793){const _0x34940f=_0x204348,_0x4c28e4=_0x42f206[_0x34940f(0x954)][_0x42f206['activeChatId']],_0x533fcf=_0x4c28e4[_0x34940f(0x1d5)]['find'](_0x1bd061=>_0x1bd061[_0x34940f(0xf16)]===_0x3d7793);if(!_0x533fcf||_0x533fcf['type']!==_0x34940f(0xfb0))return;const _0x110f1c=document[_0x34940f(0x458)](_0x34940f(0xe9c));let _0x5b3a75='';_0x533fcf['items'][_0x34940f(0x12c2)](_0x4a93fe=>{const _0x507d86=_0x34940f;_0x5b3a75+='<tr><td\x20class=\x22item-name\x22>'+_0x4a93fe[_0x507d86(0x132a)]+_0x507d86(0xe0)+_0x4a93fe[_0x507d86(0x177)]+_0x507d86(0x55b)+_0x4a93fe[_0x507d86(0x1043)][_0x507d86(0x800)](0x2)+_0x507d86(0xcb5)+(_0x4a93fe[_0x507d86(0x1043)]*_0x4a93fe[_0x507d86(0x177)])['toFixed'](0x2)+_0x507d86(0x2c2);}),_0x110f1c[_0x34940f(0x110d)]=_0x34940f(0xca7)+new Date(_0x533fcf['timestamp'])['toLocaleString']()+_0x34940f(0xbb4)+_0x5b3a75+_0x34940f(0xa82)+_0x533fcf[_0x34940f(0x12e6)][_0x34940f(0x800)](0x2)+_0x34940f(0xc48),document[_0x34940f(0x458)](_0x34940f(0x141e))[_0x34940f(0x11c2)][_0x34940f(0xa58)](_0x34940f(0x67d));}async function _0x24570e(_0x12a5bf=null){const _0x5c49ac=_0x204348;_0xa38baa=_0x12a5bf;const _0x47793d=document[_0x5c49ac(0x458)](_0x5c49ac(0x99f)),_0xfd46ac=document[_0x5c49ac(0x458)](_0x5c49ac(0xcd8)),_0x4afe42=document['getElementById'](_0x5c49ac(0xa8f)),_0x3daa49=document[_0x5c49ac(0x458)](_0x5c49ac(0xe1e)),_0x4ce4f4=document[_0x5c49ac(0x458)]('product-description-input'),_0x45f212=document[_0x5c49ac(0x458)](_0x5c49ac(0x1059)),_0x31a6b2=document[_0x5c49ac(0x458)](_0x5c49ac(0xd0b)),_0x1b6fc3=document[_0x5c49ac(0x458)]('product-variations-container');_0x1b6fc3[_0x5c49ac(0x110d)]='',_0x31a6b2[_0x5c49ac(0x110d)]=_0x5c49ac(0x4c9);const _0x62cb42=await _0x17d534[_0x5c49ac(0x618)][_0x5c49ac(0x511)]();_0x62cb42[_0x5c49ac(0x12c2)](_0x48ffbb=>{const _0x5546dc=_0x5c49ac,_0x22a3f4=document[_0x5546dc(0xe7d)](_0x5546dc(0x790));_0x22a3f4[_0x5546dc(0x8dd)]=_0x48ffbb['id'],_0x22a3f4['textContent']=_0x48ffbb[_0x5546dc(0x132a)],_0x31a6b2['appendChild'](_0x22a3f4);});if(_0x12a5bf){_0xfd46ac[_0x5c49ac(0x1a2)]=_0x5c49ac(0x369);const _0x3acd49=await _0x17d534[_0x5c49ac(0x122c)]['get'](_0x12a5bf);_0x4afe42['value']=_0x3acd49[_0x5c49ac(0x132a)],_0x3daa49[_0x5c49ac(0x8dd)]=_0x3acd49[_0x5c49ac(0x1043)],_0x4ce4f4[_0x5c49ac(0x8dd)]=_0x3acd49[_0x5c49ac(0x4e9)]||'',_0x45f212[_0x5c49ac(0x577)]=_0x3acd49[_0x5c49ac(0x2cc)],_0x31a6b2[_0x5c49ac(0x8dd)]=_0x3acd49['categoryId']||'',_0x3acd49[_0x5c49ac(0xae6)]&&_0x3acd49['variations'][_0x5c49ac(0x131d)]>0x0&&_0x3acd49[_0x5c49ac(0xae6)]['forEach'](_0x34a643=>_0x4aa268(_0x34a643));}else _0xfd46ac['textContent']=_0x5c49ac(0x17b),_0x4afe42[_0x5c49ac(0x8dd)]='',_0x3daa49[_0x5c49ac(0x8dd)]='',_0x4ce4f4[_0x5c49ac(0x8dd)]='',_0x45f212[_0x5c49ac(0x577)]=_0x5c49ac(0x272),_0x31a6b2[_0x5c49ac(0x8dd)]='';_0x47793d[_0x5c49ac(0x11c2)][_0x5c49ac(0xa58)](_0x5c49ac(0x67d));}async function _0x52834f(){const _0x148941=_0x204348,_0x430799=document[_0x148941(0x458)](_0x148941(0xa8f))['value'][_0x148941(0x2aa)](),_0x57432d=parseFloat(document[_0x148941(0x458)]('product-price-input')[_0x148941(0x8dd)]),_0x3cb80b=document[_0x148941(0x458)]('product-description-input')['value'][_0x148941(0x2aa)](),_0x4e10ae=document[_0x148941(0x458)](_0x148941(0x1059))[_0x148941(0x577)],_0x55f3b5=parseInt(document['getElementById'](_0x148941(0xd0b))['value'])||null;if(!_0x430799){alert(_0x148941(0x13c));return;}if(isNaN(_0x57432d)||_0x57432d<0x0){alert(_0x148941(0xa2f));return;}const _0x234e0b=[];document[_0x148941(0x102a)](_0x148941(0x561))['forEach'](_0x499d88=>{const _0x3bdafc=_0x148941,_0x48ab9=_0x499d88[_0x3bdafc(0x586)]('.variation-name-input')['value']['trim'](),_0x4f606a=parseFloat(_0x499d88[_0x3bdafc(0x586)]('.variation-price-input')[_0x3bdafc(0x8dd)]),_0x1b8738=_0x499d88[_0x3bdafc(0x586)](_0x3bdafc(0x53b))[_0x3bdafc(0x577)];_0x48ab9&&!isNaN(_0x4f606a)&&_0x4f606a>=0x0&&_0x234e0b[_0x3bdafc(0x129e)]({'name':_0x48ab9,'price':_0x4f606a,'imageUrl':_0x1b8738[_0x3bdafc(0xd8d)]('placeholder.png')?null:_0x1b8738});});const _0x479c98={'name':_0x430799,'price':_0x57432d,'description':_0x3cb80b,'imageUrl':_0x4e10ae,'categoryId':_0x55f3b5,'variations':_0x234e0b};_0xa38baa?await _0x17d534['shoppingProducts'][_0x148941(0x938)](_0xa38baa,_0x479c98):await _0x17d534[_0x148941(0x122c)]['add'](_0x479c98),document[_0x148941(0x458)](_0x148941(0x99f))[_0x148941(0x11c2)][_0x148941(0x1097)]('visible'),await _0x1044f9();}async function _0x48f044(){await _0x45fe84(),_0x589d88('rendering-rules-screen');}async function _0x45fe84(){const _0xc10521=_0x204348,_0x1e4c05=document[_0xc10521(0x458)](_0xc10521(0x964)),_0x7d15e2=document[_0xc10521(0x458)](_0xc10521(0xac6));_0x1e4c05[_0xc10521(0x110d)]='',_0x7d15e2[_0xc10521(0x110d)]='';const _0x30f9d6=await _0x17d534[_0xc10521(0x65a)][_0xc10521(0x511)]();if(_0x30f9d6[_0xc10521(0x131d)]===0x0){_0x7d15e2[_0xc10521(0x110d)]=_0xc10521(0x1181);return;}const _0x12f256=document[_0xc10521(0xe7d)](_0xc10521(0x986));_0x12f256['className']=_0xc10521(0x1431),_0x12f256[_0xc10521(0x1a2)]=_0xc10521(0x55a),_0x12f256[_0xc10521(0x1f4)]['categoryId']=_0xc10521(0x655),_0x1e4c05['appendChild'](_0x12f256);const _0x12ef32=document['createElement']('div');_0x12ef32['className']=_0xc10521(0x836),_0x12ef32[_0xc10521(0x1f4)][_0xc10521(0x5f7)]=_0xc10521(0x655),_0x7d15e2[_0xc10521(0x1079)](_0x12ef32);const _0x2367ad=Object[_0xc10521(0x6eb)](_0x42f206['chats'])['filter'](_0x3e31fb=>!_0x3e31fb[_0xc10521(0x726)]&&_0x30f9d6[_0xc10521(0x593)](_0x459265=>_0x459265[_0xc10521(0xfca)]===_0x3e31fb['id']));_0x2367ad[_0xc10521(0x12c2)](_0x12fa8f=>{const _0x1e179f=_0xc10521,_0x1913d1=document[_0x1e179f(0xe7d)](_0x1e179f(0x986));_0x1913d1[_0x1e179f(0x69b)]=_0x1e179f(0x489),_0x1913d1[_0x1e179f(0x1a2)]=_0x12fa8f[_0x1e179f(0x132a)],_0x1913d1['dataset']['categoryId']=_0x12fa8f['id'],_0x1e4c05[_0x1e179f(0x1079)](_0x1913d1);const _0x30d4c1=document[_0x1e179f(0xe7d)](_0x1e179f(0x1323));_0x30d4c1[_0x1e179f(0x69b)]=_0x1e179f(0x1318),_0x30d4c1['dataset'][_0x1e179f(0x5f7)]=_0x12fa8f['id'],_0x7d15e2[_0x1e179f(0x1079)](_0x30d4c1);}),_0x30f9d6['forEach'](_0xc8c936=>{const _0x20bf5b=_0xc10521,_0x5388c6=_0x3e5e5c(_0xc8c936),_0x515688=_0x7d15e2['querySelector'](_0x20bf5b(0x806)+_0xc8c936[_0x20bf5b(0xfca)]+'\x22]');_0x515688&&_0x515688[_0x20bf5b(0x1079)](_0x5388c6);}),document['querySelectorAll'](_0xc10521(0x12c8))['forEach'](_0x29997e=>{const _0x10a811=_0xc10521;_0x29997e[_0x10a811(0xd85)](_0x10a811(0x1122),()=>_0x582eaa(_0x29997e[_0x10a811(0x1f4)][_0x10a811(0x5f7)]));});}function _0x3e5e5c(_0x2ea96d){const _0x44e74f=_0x204348,_0x576b66=document[_0x44e74f(0xe7d)](_0x44e74f(0x1323));return _0x576b66[_0x44e74f(0x69b)]=_0x44e74f(0x1037)+(_0x2ea96d[_0x44e74f(0x438)]?_0x44e74f(0x12fb):''),_0x576b66['dataset']['ruleId']=_0x2ea96d['id'],_0x576b66['innerHTML']=_0x44e74f(0x26e)+_0x2ea96d[_0x44e74f(0x132a)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0x2ea96d[_0x44e74f(0x6a2)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x576b66[_0x44e74f(0xd85)](_0x44e74f(0x1122),()=>_0x596560(_0x2ea96d['id'])),_0x4376d8(_0x576b66,()=>_0x9dc62c(_0x2ea96d['id'])),_0x576b66;}async function _0x596560(_0x2d9347=null){const _0x2bf6ca=_0x204348;_0x37ecd0=_0x2d9347;const _0x1bb35c=document['getElementById'](_0x2bf6ca(0xa3b)),_0x339057=document['getElementById'](_0x2bf6ca(0xc0c)),_0x1ede60=document[_0x2bf6ca(0x458)]('rule-name-input'),_0x5c7796=document[_0x2bf6ca(0x458)](_0x2bf6ca(0x11b3)),_0x1ead53=document['getElementById'](_0x2bf6ca(0xc50)),_0x5a2041=document['getElementById'](_0x2bf6ca(0x443)),_0x107bd1=document[_0x2bf6ca(0x458)]('rule-enabled-switch');_0x5c7796['innerHTML']='<option\x20value=\x22global\x22>公用\x20(所有角色)</option>',Object[_0x2bf6ca(0x6eb)](_0x42f206[_0x2bf6ca(0x954)])[_0x2bf6ca(0xaf1)](_0x4aa250=>!_0x4aa250['isGroup'])[_0x2bf6ca(0x12c2)](_0x2af5ab=>{const _0x3ef07a=_0x2bf6ca;_0x5c7796[_0x3ef07a(0x110d)]+=_0x3ef07a(0xe83)+_0x2af5ab['id']+'\x22>'+_0x2af5ab['name']+_0x3ef07a(0xc91);});if(_0x2d9347){_0x339057['textContent']=_0x2bf6ca(0x13bb);const _0x1de8fd=await _0x17d534[_0x2bf6ca(0x65a)]['get'](_0x2d9347);_0x1ede60[_0x2bf6ca(0x8dd)]=_0x1de8fd[_0x2bf6ca(0x132a)],_0x5c7796['value']=_0x1de8fd[_0x2bf6ca(0xfca)],_0x1ead53['value']=_0x1de8fd[_0x2bf6ca(0x6a2)],_0x5a2041['value']=_0x1de8fd[_0x2bf6ca(0xc03)],_0x107bd1[_0x2bf6ca(0x8f7)]=_0x1de8fd[_0x2bf6ca(0x438)];}else _0x339057[_0x2bf6ca(0x1a2)]=_0x2bf6ca(0x37e),_0x1ede60[_0x2bf6ca(0x8dd)]='',_0x5c7796[_0x2bf6ca(0x8dd)]=_0x2bf6ca(0x655),_0x1ead53[_0x2bf6ca(0x8dd)]='',_0x5a2041[_0x2bf6ca(0x8dd)]='',_0x107bd1[_0x2bf6ca(0x8f7)]=!![];_0x1bb35c[_0x2bf6ca(0x11c2)][_0x2bf6ca(0xa58)](_0x2bf6ca(0x67d));}async function _0x35ee88(){const _0x1ab393=_0x204348,_0xe4a401=document[_0x1ab393(0x458)](_0x1ab393(0x740))[_0x1ab393(0x8dd)]['trim'](),_0x461a6d=document[_0x1ab393(0x458)](_0x1ab393(0xc50))[_0x1ab393(0x8dd)][_0x1ab393(0x2aa)]();if(!_0xe4a401||!_0x461a6d){alert('规则名称和正则表达式不能为空！');return;}try{new RegExp(_0x461a6d);}catch(_0x4c96a5){alert(_0x1ab393(0x142b)+_0x4c96a5[_0x1ab393(0x7aa)]);return;}const _0x40042e={'name':_0xe4a401,'chatId':document[_0x1ab393(0x458)](_0x1ab393(0x11b3))['value'],'regex':_0x461a6d,'template':document[_0x1ab393(0x458)](_0x1ab393(0x443))[_0x1ab393(0x8dd)],'isEnabled':document[_0x1ab393(0x458)](_0x1ab393(0x849))[_0x1ab393(0x8f7)]};_0x37ecd0?await _0x17d534['renderingRules'][_0x1ab393(0x938)](_0x37ecd0,_0x40042e):await _0x17d534[_0x1ab393(0x65a)][_0x1ab393(0xa58)](_0x40042e),document['getElementById'](_0x1ab393(0xa3b))[_0x1ab393(0x11c2)][_0x1ab393(0x1097)](_0x1ab393(0x67d)),await _0x45fe84();}async function _0x9dc62c(_0x4e96a8){const _0xb46872=_0x204348,_0x30b14a=await _0x2532b9(_0xb46872(0x61d),_0xb46872(0xa20),{'confirmButtonClass':_0xb46872(0x4d3)});_0x30b14a&&(await _0x17d534[_0xb46872(0x65a)]['delete'](_0x4e96a8),await _0x45fe84());}async function _0x49d489(_0x2cf8fc,_0x5e16be){const _0x42bb08=_0x204348;if(_0x2cf8fc[_0x42bb08(0x2aa)]()[_0x42bb08(0x13ad)]('<')||!_0x2cf8fc[_0x42bb08(0xd8d)]('[')&&!_0x2cf8fc['includes']('{'))return _0x2cf8fc;const _0x3251e2=await _0x17d534['renderingRules'][_0x42bb08(0x13c6)]('chatId')['equals']('global')['or'](_0x42bb08(0xfca))['equals'](_0x5e16be)[_0x42bb08(0x511)]();let _0x504caa=_0x2cf8fc;for(const _0x582548 of _0x3251e2[_0x42bb08(0xaf1)](_0x2b0405=>_0x2b0405[_0x42bb08(0x438)])){try{const _0x586801=new RegExp(_0x582548['regex'],'g');_0x586801[_0x42bb08(0x9c0)](_0x504caa)&&(_0x504caa=_0x504caa['replace'](_0x586801,_0x582548[_0x42bb08(0xc03)]));}catch(_0x3181ff){console['error'](_0x42bb08(0x484)+_0x582548[_0x42bb08(0x132a)]+_0x42bb08(0xf17),_0x3181ff);}}return _0x504caa;}async function _0x48f044(){const _0x3868d6=_0x204348;await _0x45fe84(),_0x589d88(_0x3868d6(0xe05));}async function _0x45fe84(){const _0x2537c8=_0x204348,_0x514571=document['getElementById']('rules-tabs'),_0x45d30e=document[_0x2537c8(0x458)]('rules-content-container');_0x514571[_0x2537c8(0x110d)]='',_0x45d30e[_0x2537c8(0x110d)]='';const _0x55e442=await _0x17d534['renderingRules'][_0x2537c8(0x511)]();if(_0x55e442[_0x2537c8(0x131d)]===0x0){_0x45d30e[_0x2537c8(0x110d)]=_0x2537c8(0x1181);return;}const _0x174c58=document[_0x2537c8(0xe7d)](_0x2537c8(0x986));_0x174c58['className']='rules-tab\x20active',_0x174c58[_0x2537c8(0x1a2)]=_0x2537c8(0x55a),_0x174c58[_0x2537c8(0x1f4)][_0x2537c8(0x5f7)]='global',_0x514571[_0x2537c8(0x1079)](_0x174c58);const _0x2d2e3c=document[_0x2537c8(0xe7d)](_0x2537c8(0x1323));_0x2d2e3c[_0x2537c8(0x69b)]='rules-category-pane\x20active',_0x2d2e3c[_0x2537c8(0x1f4)][_0x2537c8(0x5f7)]='global',_0x45d30e['appendChild'](_0x2d2e3c);const _0x2c9c1f=Object[_0x2537c8(0x6eb)](_0x42f206['chats'])['filter'](_0xae7be1=>!_0xae7be1[_0x2537c8(0x726)]&&_0x55e442[_0x2537c8(0x593)](_0x4b8aff=>_0x4b8aff[_0x2537c8(0xfca)]===_0xae7be1['id']));_0x2c9c1f['forEach'](_0x2a637d=>{const _0x289a4f=_0x2537c8,_0x43b7c8=document[_0x289a4f(0xe7d)]('button');_0x43b7c8[_0x289a4f(0x69b)]='rules-tab',_0x43b7c8[_0x289a4f(0x1a2)]=_0x2a637d[_0x289a4f(0x132a)],_0x43b7c8[_0x289a4f(0x1f4)][_0x289a4f(0x5f7)]=_0x2a637d['id'],_0x514571[_0x289a4f(0x1079)](_0x43b7c8);const _0x1e0be0=document[_0x289a4f(0xe7d)]('div');_0x1e0be0[_0x289a4f(0x69b)]=_0x289a4f(0x1318),_0x1e0be0['dataset'][_0x289a4f(0x5f7)]=_0x2a637d['id'],_0x45d30e[_0x289a4f(0x1079)](_0x1e0be0);}),_0x55e442[_0x2537c8(0x12c2)](_0x2bf0b1=>{const _0x4c35c3=_0x2537c8,_0x32836e=_0x3e5e5c(_0x2bf0b1),_0x1d5bd1=_0x45d30e[_0x4c35c3(0x586)]('.rules-category-pane[data-category-id=\x22'+_0x2bf0b1[_0x4c35c3(0xfca)]+'\x22]');_0x1d5bd1&&_0x1d5bd1['appendChild'](_0x32836e);}),document[_0x2537c8(0x102a)](_0x2537c8(0x12c8))[_0x2537c8(0x12c2)](_0x347ac5=>{const _0x4847ea=_0x2537c8;_0x347ac5[_0x4847ea(0xd85)]('click',()=>_0x582eaa(_0x347ac5[_0x4847ea(0x1f4)][_0x4847ea(0x5f7)]));});}function _0x3e5e5c(_0x517250){const _0xede722=_0x204348,_0x134a84=document[_0xede722(0xe7d)](_0xede722(0x1323));return _0x134a84['className']=_0xede722(0x1037)+(_0x517250[_0xede722(0x438)]?_0xede722(0x12fb):''),_0x134a84[_0xede722(0x1f4)][_0xede722(0xfe9)]=_0x517250['id'],_0x134a84[_0xede722(0x110d)]=_0xede722(0x26e)+_0x517250['name']+_0xede722(0xa7d)+_0x517250[_0xede722(0x6a2)]+_0xede722(0x12c5),_0x134a84['addEventListener']('click',()=>_0x596560(_0x517250['id'])),_0x4376d8(_0x134a84,()=>_0x9dc62c(_0x517250['id'])),_0x134a84;}async function _0x596560(_0x3cd262=null){const _0x52e61d=_0x204348;_0x37ecd0=_0x3cd262;const _0xc86ff1=document['getElementById'](_0x52e61d(0xa3b)),_0xb42a0b=document[_0x52e61d(0x458)](_0x52e61d(0xc0c)),_0x24deb6=document['getElementById'](_0x52e61d(0x740)),_0x98fce4=document['getElementById'](_0x52e61d(0x11b3)),_0x1b6cb1=document['getElementById']('rule-regex-input'),_0x3b0395=document[_0x52e61d(0x458)]('rule-template-input'),_0x2213a5=document[_0x52e61d(0x458)](_0x52e61d(0x849));_0x98fce4[_0x52e61d(0x110d)]=_0x52e61d(0x3a0),Object[_0x52e61d(0x6eb)](_0x42f206[_0x52e61d(0x954)])[_0x52e61d(0xaf1)](_0x225c03=>!_0x225c03['isGroup'])['forEach'](_0x2d6034=>{const _0x4896ae=_0x52e61d;_0x98fce4[_0x4896ae(0x110d)]+=_0x4896ae(0xe83)+_0x2d6034['id']+'\x22>'+_0x2d6034[_0x4896ae(0x132a)]+_0x4896ae(0xc91);});if(_0x3cd262){_0xb42a0b[_0x52e61d(0x1a2)]=_0x52e61d(0x13bb);const _0x38f9bd=await _0x17d534[_0x52e61d(0x65a)][_0x52e61d(0x36d)](_0x3cd262);_0x24deb6[_0x52e61d(0x8dd)]=_0x38f9bd[_0x52e61d(0x132a)],_0x98fce4[_0x52e61d(0x8dd)]=_0x38f9bd[_0x52e61d(0xfca)],_0x1b6cb1[_0x52e61d(0x8dd)]=_0x38f9bd[_0x52e61d(0x6a2)],_0x3b0395[_0x52e61d(0x8dd)]=_0x38f9bd['template'],_0x2213a5[_0x52e61d(0x8f7)]=_0x38f9bd[_0x52e61d(0x438)];}else _0xb42a0b[_0x52e61d(0x1a2)]='创建新规则',_0x24deb6[_0x52e61d(0x8dd)]='',_0x98fce4[_0x52e61d(0x8dd)]=_0x52e61d(0x655),_0x1b6cb1[_0x52e61d(0x8dd)]='',_0x3b0395['value']='',_0x2213a5[_0x52e61d(0x8f7)]=!![];_0xc86ff1[_0x52e61d(0x11c2)][_0x52e61d(0xa58)]('visible');}async function _0x35ee88(){const _0x3e1257=_0x204348,_0x22a30a=document['getElementById'](_0x3e1257(0x740))['value'][_0x3e1257(0x2aa)](),_0x17a2bb=document[_0x3e1257(0x458)](_0x3e1257(0xc50))['value']['trim']();if(!_0x22a30a||!_0x17a2bb){alert(_0x3e1257(0x1221));return;}try{new RegExp(_0x17a2bb);}catch(_0xe15e94){alert(_0x3e1257(0x142b)+_0xe15e94[_0x3e1257(0x7aa)]);return;}const _0x2c2d39={'name':_0x22a30a,'chatId':document[_0x3e1257(0x458)](_0x3e1257(0x11b3))[_0x3e1257(0x8dd)],'regex':_0x17a2bb,'template':document[_0x3e1257(0x458)](_0x3e1257(0x443))[_0x3e1257(0x8dd)],'isEnabled':document['getElementById'](_0x3e1257(0x849))[_0x3e1257(0x8f7)]};_0x37ecd0?await _0x17d534[_0x3e1257(0x65a)]['update'](_0x37ecd0,_0x2c2d39):await _0x17d534[_0x3e1257(0x65a)]['add'](_0x2c2d39),document[_0x3e1257(0x458)](_0x3e1257(0xa3b))[_0x3e1257(0x11c2)][_0x3e1257(0x1097)](_0x3e1257(0x67d)),await _0x45fe84();}async function _0x9dc62c(_0x1ddfc9){const _0x9e8ff9=_0x204348,_0x15c051=await _0x2532b9(_0x9e8ff9(0x61d),_0x9e8ff9(0xa20),{'confirmButtonClass':'btn-danger'});_0x15c051&&(await _0x17d534['renderingRules'][_0x9e8ff9(0x195)](_0x1ddfc9),await _0x45fe84());}async function _0x49d489(_0x3ef13c,_0x5dacc1){const _0x4bdff9=_0x204348;if(_0x3ef13c['trim']()[_0x4bdff9(0x13ad)]('<')||!_0x3ef13c['includes']('[')&&!_0x3ef13c['includes']('{'))return _0x3ef13c;if(!_0x1130c4[_0x5dacc1]){console[_0x4bdff9(0x7d1)](_0x4bdff9(0xf18)+_0x5dacc1);const _0x5f322b=await _0x17d534['renderingRules'][_0x4bdff9(0x13c6)](_0x4bdff9(0xfca))[_0x4bdff9(0x7db)](_0x4bdff9(0x655))['or'](_0x4bdff9(0xfca))[_0x4bdff9(0x7db)](_0x5dacc1)['toArray']();_0x1130c4[_0x5dacc1]=_0x5f322b['filter'](_0x392e18=>_0x392e18[_0x4bdff9(0x438)]);}const _0x2b760b=_0x1130c4[_0x5dacc1];let _0x23bde5=_0x3ef13c;for(const _0x302bb1 of _0x2b760b){try{const _0x4975fd=new RegExp(_0x302bb1[_0x4bdff9(0x6a2)],'g');let _0x29d356=_0x23bde5;_0x4975fd[_0x4bdff9(0x9c0)](_0x29d356)&&(_0x23bde5=_0x23bde5['replace'](_0x4975fd,_0x302bb1['template']));}catch(_0x2c56ac){console[_0x4bdff9(0xb61)](_0x4bdff9(0x484)+_0x302bb1[_0x4bdff9(0x132a)]+']\x20的正则表达式无效:',_0x2c56ac);}}return _0x23bde5;}function _0x4872f4(_0x43486a){const _0x88a144=_0x204348;if(!_0x43486a)return'';const _0x497a2b=new Date(),_0x5b34e3=new Date(_0x43486a),_0x588fba=String(_0x5b34e3[_0x88a144(0x748)]())['padStart'](0x2,'0'),_0x13c41d=String(_0x5b34e3[_0x88a144(0x121a)]())[_0x88a144(0x508)](0x2,'0'),_0x105e91=_0x588fba+':'+_0x13c41d;if(_0x497a2b[_0x88a144(0x5ab)]()===_0x5b34e3[_0x88a144(0x5ab)]())return _0x105e91;const _0x298718=new Date();_0x298718[_0x88a144(0x6d7)](_0x497a2b[_0x88a144(0x14c)]()-0x1);if(_0x298718[_0x88a144(0x5ab)]()===_0x5b34e3[_0x88a144(0x5ab)]())return _0x88a144(0xc3)+_0x105e91;const _0x47c776=_0x5b34e3[_0x88a144(0xc2a)](),_0x3598d6=String(_0x5b34e3[_0x88a144(0x63a)]()+0x1)[_0x88a144(0x508)](0x2,'0'),_0x501a88=String(_0x5b34e3['getDate']())[_0x88a144(0x508)](0x2,'0');return _0x497a2b[_0x88a144(0xc2a)]()===_0x47c776?_0x3598d6+'月'+_0x501a88+'日\x20'+_0x105e91:_0x47c776+'年'+_0x3598d6+'月'+_0x501a88+'日\x20'+_0x105e91;}function _0x2a60ff(_0x482bed){const _0x50e46c=_0x204348,_0x3d89e7=document['createElement'](_0x50e46c(0x1323));_0x3d89e7[_0x50e46c(0x69b)]=_0x50e46c(0x190);const _0x24b138=document[_0x50e46c(0xe7d)](_0x50e46c(0x1323));return _0x24b138[_0x50e46c(0x69b)]=_0x50e46c(0x1a8),_0x24b138[_0x50e46c(0x1a2)]=_0x4872f4(_0x482bed),_0x3d89e7[_0x50e46c(0x1079)](_0x24b138),_0x3d89e7;}async function _0x185b1e(){const _0x256f05=_0x204348,_0xc3a7ba=_0x42f206[_0x256f05(0x954)][_0x42f206['activeChatId']];if(!_0xc3a7ba||!lastResponseTimestamps||lastResponseTimestamps[_0x256f05(0x131d)]===0x0){alert(_0x256f05(0x547));return;}_0xc3a7ba['history']=_0xc3a7ba[_0x256f05(0x1d5)]['filter'](_0x11ce01=>!lastResponseTimestamps[_0x256f05(0xd8d)](_0x11ce01[_0x256f05(0xf16)])),await _0x17d534[_0x256f05(0x954)][_0x256f05(0xf3f)](_0xc3a7ba),await _0x359c96(_0x42f206['activeChatId']),_0xef2b3f();}async function _0x27f82c(){const _0x114bc1=_0x204348,_0x4a996c=_0x42f206[_0x114bc1(0x954)][_0x42f206[_0x114bc1(0x81d)]];if(!_0x4a996c)return;const _0xb35a19=_0x4a996c[_0x114bc1(0x1d5)][_0x114bc1(0xc81)](_0xd11ab4=>_0xd11ab4[_0x114bc1(0xaeb)]===_0x114bc1(0xf86)&&!_0xd11ab4[_0x114bc1(0x7a0)]);if(_0xb35a19===-0x1){alert(_0x114bc1(0xc77));return;}const _0x15e18a=_0x4a996c[_0x114bc1(0x1d5)]['findLastIndex'](_0x4d5749=>_0x4d5749[_0x114bc1(0xaeb)]===_0x114bc1(0xac3));if(_0x15e18a<_0xb35a19){alert('AI\x20尚未对您的最后一条消息做出回应，无法重新生成。');return;}_0x4a996c[_0x114bc1(0x1d5)][_0x114bc1(0x9cf)](_0xb35a19+0x1),await _0x17d534['chats'][_0x114bc1(0xf3f)](_0x4a996c),await _0x359c96(_0x42f206[_0x114bc1(0x81d)]),await _0x3ee822();}async function _0x4dda16(){const _0x131fe6=_0x204348;if(!_0x4a3337[_0x131fe6(0x1196)])return;const _0x4e1e75=_0x4a3337[_0x131fe6(0x8c2)][_0x131fe6(0xc81)](_0x127732=>_0x127732['role']===_0x131fe6(0xf86));if(_0x4e1e75===-0x1){alert('通话中还没有你的发言，无法重新生成回应。');return;}_0x4a3337[_0x131fe6(0x8c2)][_0x131fe6(0x9cf)](_0x4e1e75+0x1);const _0x5472c6=document[_0x131fe6(0x458)](_0x131fe6(0x116c));_0x5472c6['innerHTML']='',_0x4a3337['callHistory']['forEach'](_0x43d0c8=>{const _0x24cd1c=_0x131fe6,_0x56454e=document[_0x24cd1c(0xe7d)](_0x24cd1c(0x1323));_0x56454e['className']='call-message-bubble\x20'+_0x43d0c8['role']+'-speech',_0x56454e[_0x24cd1c(0x1f4)]['timestamp']=_0x43d0c8[_0x24cd1c(0xf16)],_0x43d0c8[_0x24cd1c(0xaeb)]==='user'?_0x56454e['textContent']=_0x43d0c8[_0x24cd1c(0x1316)]:_0x56454e[_0x24cd1c(0x110d)]=_0x43d0c8[_0x24cd1c(0x1316)],_0x4376d8(_0x56454e,()=>_0xc902bb(_0x43d0c8['timestamp'])),_0x5472c6['appendChild'](_0x56454e);}),_0x5472c6['scrollTop']=_0x5472c6[_0x131fe6(0x94b)],_0x4db68a(null);}async function _0x4aeb17(){const _0x47a5a5=_0x204348,_0x373871=_0x42f206['chats'][_0x42f206[_0x47a5a5(0x81d)]];if(!_0x373871)return;_0x260324(_0x373871['id'],!![]);const _0x5cca7b=document[_0x47a5a5(0x458)]('chat-header-title');!_0x373871[_0x47a5a5(0x726)]&&(_0x5cca7b['style'][_0x47a5a5(0x539)]=0x0,setTimeout(()=>{const _0x43e4cf=_0x47a5a5;_0x5cca7b[_0x43e4cf(0x1a2)]='对方正在输入...',_0x5cca7b[_0x43e4cf(0x11c2)][_0x43e4cf(0xa58)](_0x43e4cf(0x417)),_0x5cca7b[_0x43e4cf(0x1104)][_0x43e4cf(0x539)]=0x1;},0xc8));try{const {proxyUrl:_0x1dd7e4,apiKey:_0x11120d,model:_0x86c9d6}=_0x42f206[_0x47a5a5(0x5cb)];if(!_0x1dd7e4||!_0x11120d||!_0x86c9d6)throw new Error(_0x47a5a5(0x172));const _0x4883df=parseInt(_0x373871[_0x47a5a5(0xda2)][_0x47a5a5(0x125c)])||0xa,_0x2d9b6b=_0x373871['history'][_0x47a5a5(0x5b0)](-_0x4883df),_0x282403=new Date(),_0x309de5=new Date(_0x282403[_0x47a5a5(0xf08)]()+_0x282403[_0x47a5a5(0xb2f)]()*0xea60+0x36ee80*0x8),_0x3a3350=_0x309de5[_0x47a5a5(0xe43)](_0x47a5a5(0xaa2),{'timeZone':_0x47a5a5(0x12db),'dateStyle':_0x47a5a5(0xba7),'timeStyle':'short'}),_0xf3d442=_0x5ecef0(_0x309de5),_0x125526=_0x373871[_0x47a5a5(0xda2)][_0x47a5a5(0xc7d)]||'我';let _0x542447='';if(_0x373871[_0x47a5a5(0xda2)][_0x47a5a5(0x315)]&&_0x373871[_0x47a5a5(0xda2)]['linkedWorldBookIds']['length']>0x0){const _0x5806b3=_0x373871[_0x47a5a5(0xda2)][_0x47a5a5(0x315)][_0x47a5a5(0xbf6)](_0x3734ff=>{const _0x1fc947=_0x47a5a5,_0x54a14=_0x42f206['worldBooks'][_0x1fc947(0xb07)](_0x412077=>_0x412077['id']===_0x3734ff);if(!_0x54a14||!Array[_0x1fc947(0x971)](_0x54a14[_0x1fc947(0x1316)]))return'';const _0x4ca268=_0x54a14['content']['filter'](_0x1f78cb=>_0x1f78cb[_0x1fc947(0x12fb)]!==![])[_0x1fc947(0xbf6)](_0x49f754=>{const _0x5af97c=_0x1fc947;let _0x18ab70=_0x5af97c(0x111f)+(_0x49f754[_0x5af97c(0xcb4)]||'无备注')+'\x0a';if(_0x49f754[_0x5af97c(0x634)][_0x5af97c(0x131d)]>0x0)_0x18ab70+='**关键词:**\x20'+_0x49f754[_0x5af97c(0x634)][_0x5af97c(0x56c)](',\x20')+'\x0a';return _0x18ab70+=_0x5af97c(0xcdf)+_0x49f754[_0x5af97c(0x1316)],_0x18ab70;})[_0x1fc947(0x56c)]('');return _0x4ca268?_0x1fc947(0x64a)+_0x54a14[_0x1fc947(0x132a)]+'\x0a'+_0x4ca268:'';})[_0x47a5a5(0xaf1)](Boolean)[_0x47a5a5(0x56c)]('');_0x5806b3&&(_0x542447=_0x47a5a5(0x518)+_0x5806b3+_0x47a5a5(0xdcc));}let _0x86026f='';if(_0x59377b['isActive']&&_0x59377b['activeChatId']===_0x373871['id']){const _0x286247=_0x59377b['currentIndex']>-0x1?_0x59377b['playlist'][_0x59377b[_0x47a5a5(0x4bd)]]:null;_0x86026f=_0x47a5a5(0x10f3);}const _0x494d00=_0x1d784c(_0x2b82e3[_0x373871['id']]);let _0x2fb42f='';_0x373871[_0x47a5a5(0x103)]&&_0x373871[_0x47a5a5(0x103)][_0x47a5a5(0x131d)]>0x0&&(_0x2fb42f=_0x47a5a5(0x527)+_0x373871[_0x47a5a5(0x103)][_0x47a5a5(0x56c)](',\x20')+_0x47a5a5(0x223));let _0x28599e='';const _0x2f07ce=_0x42f206[_0x47a5a5(0x551)][_0x47a5a5(0x308)]||'用户';_0x28599e+=_0x47a5a5(0x11e9)+_0x2f07ce+_0x47a5a5(0x5ef);const _0x5d16c8=Object[_0x47a5a5(0x6eb)](_0x42f206[_0x47a5a5(0x954)])[_0x47a5a5(0xaf1)](_0x14d97a=>_0x14d97a[_0x47a5a5(0x726)]&&_0x14d97a[_0x47a5a5(0xfa8)][_0x47a5a5(0x593)](_0x15717a=>_0x15717a['id']===_0x373871['id']));_0x5d16c8['length']>0x0&&(_0x28599e+=_0x47a5a5(0x1379),_0x5d16c8[_0x47a5a5(0x12c2)](_0x9c9afd=>{const _0x50429f=_0x47a5a5,_0x3be7a4=_0x9c9afd[_0x50429f(0xda2)]['myNickname']||_0x2f07ce;_0x28599e+=_0x50429f(0x2ae)+_0x9c9afd[_0x50429f(0x132a)]+_0x50429f(0xc31)+_0x3be7a4+_0x50429f(0x198);}));_0x28599e+=_0x47a5a5(0x306);const _0x182357=_0x18518f(_0x373871),_0x5233dd=_0x47a5a5(0x552)+_0x373871[_0x47a5a5(0xa1)]+'”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20'+_0x3a3350+'\x20('+_0xf3d442+')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20'+(_0x86026f?_0x47a5a5(0x1109)+_0x86026f:'你们没有在听歌。')+'\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20长期记忆\x20(必须严格遵守)\x0a'+(_0x373871['longTermMemory']&&_0x373871[_0x47a5a5(0x94a)][_0x47a5a5(0x131d)]>0x0?_0x373871[_0x47a5a5(0x94a)][_0x47a5a5(0xbf6)](_0x543c5e=>'-\x20'+_0x543c5e[_0x47a5a5(0x1316)])[_0x47a5a5(0x56c)]('\x0a'):_0x47a5a5(0xb86))+_0x47a5a5(0xc5a)+_0x373871[_0x47a5a5(0xda2)]['aiPersona']+'\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22'+_0x373871[_0x47a5a5(0xa1)]+_0x47a5a5(0xfbe)+_0x373871[_0x47a5a5(0x132a)]+_0x47a5a5(0x92a)+_0x125526+'”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20'+_0x28599e+_0x47a5a5(0x104c)+_0x2fb42f+_0x47a5a5(0x104c)+_0x542447+_0x47a5a5(0xdec)+_0x182357+_0x47a5a5(0xf46)+(_0x373871[_0x47a5a5(0xda2)][_0x47a5a5(0x5d3)]&&_0x373871[_0x47a5a5(0xda2)]['aiAvatarLibrary'][_0x47a5a5(0x131d)]>0x0?_0x373871[_0x47a5a5(0xda2)]['aiAvatarLibrary']['map'](_0x199caa=>'-\x20'+_0x199caa['name'])[_0x47a5a5(0x56c)]('\x0a'):_0x47a5a5(0x1024))+'\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20'+(_0x373871[_0x47a5a5(0xda2)][_0x47a5a5(0x22c)]&&_0x373871[_0x47a5a5(0xda2)][_0x47a5a5(0x22c)]['length']>0x0?_0x373871[_0x47a5a5(0xda2)][_0x47a5a5(0x22c)][_0x47a5a5(0xbf6)](_0x41e5b4=>'-\x20'+_0x41e5b4[_0x47a5a5(0x132a)])['join']('\x0a'):'-\x20(空)')+_0x47a5a5(0xd5f)+_0x373871[_0x47a5a5(0xda2)][_0x47a5a5(0x65f)]+_0x47a5a5(0x107d),_0x393c34=_0x2d9b6b['map'](_0x20bd45=>({'role':_0x20bd45[_0x47a5a5(0xaeb)],'content':String(_0x20bd45[_0x47a5a5(0x1316)])}));_0x393c34[_0x47a5a5(0x129e)]({'role':_0x47a5a5(0xf86),'content':'[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]'});let _0x3e126f=_0x1dd7e4===GEMINI_API_URL,_0x3c81ea=_0x5d73db(_0x86c9d6,_0x11120d,_0x5233dd,_0x393c34);const _0x46a9c1=_0x3e126f?await fetch(_0x3c81ea[_0x47a5a5(0x1377)],_0x3c81ea[_0x47a5a5(0x76b)]):await fetch(_0x1dd7e4+_0x47a5a5(0xd7),{'method':'POST','headers':{'Content-Type':_0x47a5a5(0xa0e),'Authorization':_0x47a5a5(0x8aa)+_0x11120d},'body':JSON[_0x47a5a5(0xc04)]({'model':_0x86c9d6,'messages':[{'role':'system','content':_0x5233dd},..._0x393c34],'temperature':_0x42f206[_0x47a5a5(0xf0)][_0x47a5a5(0xfdf)]||0.8})});if(!_0x46a9c1['ok']){const _0x1c1364=await _0x46a9c1['json']();throw new Error(_0x47a5a5(0x127)+_0x1c1364[_0x47a5a5(0xb61)][_0x47a5a5(0x7aa)]);}const _0x313c2c=await _0x46a9c1[_0x47a5a5(0xaef)](),_0x1adf0b=getGeminiResponseText(_0x313c2c),_0x14b5f7=_0x418096(_0x1adf0b),_0x2b0454=[];for(const _0x2fc84f of _0x14b5f7){if(_0x2fc84f[_0x47a5a5(0x259)]===_0x47a5a5(0xdd5)&&typeof _0x2fc84f['content']===_0x47a5a5(0x861)&&_0x2fc84f['content'][_0x47a5a5(0xd8d)]('\x0a')){const _0xdc49de=_0x2fc84f[_0x47a5a5(0x1316)]['split'](/\n+/)[_0x47a5a5(0xaf1)](_0x1dae87=>_0x1dae87[_0x47a5a5(0x2aa)]());_0xdc49de['forEach'](_0x2ce7f2=>{_0x2b0454['push']({..._0x2fc84f,'content':_0x2ce7f2});});}else _0x2b0454['push'](_0x2fc84f);}let _0x328f88=Date[_0x47a5a5(0x606)]();for(const _0x10ec3d of _0x2b0454){const _0x283c46={'role':_0x47a5a5(0xac3),'senderName':_0x373871['originalName'],'timestamp':_0x328f88++,'content':_0x10ec3d[_0x47a5a5(0x1316)]||_0x10ec3d[_0x47a5a5(0x7aa)],'type':_0x10ec3d[_0x47a5a5(0x259)]||_0x47a5a5(0xdd5)};if(_0x10ec3d[_0x47a5a5(0x259)]===_0x47a5a5(0xd69)){if(!_0x373871[_0x47a5a5(0x726)]){if(_0x10ec3d[_0x47a5a5(0xe30)])_0x373871[_0x47a5a5(0xb0f)]=String(_0x10ec3d['heartfelt_voice']);if(_0x10ec3d[_0x47a5a5(0x8a)])_0x373871['randomJottings']=String(_0x10ec3d[_0x47a5a5(0x8a)]);}continue;}_0x373871[_0x47a5a5(0x1d5)][_0x47a5a5(0x129e)](_0x283c46),_0x5d5ee2(_0x283c46,_0x373871),await new Promise(_0x1977bc=>setTimeout(_0x1977bc,Math['random']()*0x3e8+0x320));}await _0x17d534['chats'][_0x47a5a5(0xf3f)](_0x373871),_0x27be5e();}catch(_0x359028){console[_0x47a5a5(0xb61)]('推进剧情失败:',_0x359028),await _0x34fce8('操作失败','无法推进剧情:\x20'+_0x359028[_0x47a5a5(0x7aa)]);}finally{_0x260324(_0x373871['id'],![]);if(!_0x373871[_0x47a5a5(0x726)]&&document[_0x47a5a5(0x458)](_0x47a5a5(0xca6))){const _0xb37619=document[_0x47a5a5(0x458)]('chat-header-title');_0xb37619['style'][_0x47a5a5(0x539)]=0x0,setTimeout(()=>{const _0x3effc9=_0x47a5a5;_0xb37619[_0x3effc9(0x1a2)]=_0x373871[_0x3effc9(0x132a)],_0xb37619[_0x3effc9(0x11c2)][_0x3effc9(0x1097)](_0x3effc9(0x417)),_0xb37619[_0x3effc9(0x1104)]['opacity']=0x1;},0xc8);}}}function _0x4b589a(){const _0x10a571=_0x204348,_0x369a5d=document[_0x10a571(0x458)](_0x10a571(0xf58)),_0x4f881f=_0x42f206[_0x10a571(0xf0)][_0x10a571(0xee7)]||_0x1bb61a;_0x4f881f&&_0x4f881f[_0x10a571(0x2aa)]()&&(_0x369a5d['src']=_0x4f881f,_0x369a5d[_0x10a571(0x1391)]()[_0x10a571(0x1135)](_0x3e9205=>console[_0x10a571(0x7d1)](_0x10a571(0x131a),_0x3e9205)));}function _0x19044c(){const _0x50c2c8=_0x204348;if(!_0x42f206[_0x50c2c8(0xf0)][_0x50c2c8(0x755)])return;for(const _0x5039ef in _0x42f206[_0x50c2c8(0xf0)][_0x50c2c8(0x755)]){const _0xbad3b6=document['getElementById'](_0x5039ef),_0x37c49c=_0x42f206[_0x50c2c8(0xf0)][_0x50c2c8(0x755)][_0x5039ef];_0xbad3b6&&(_0xbad3b6[_0x50c2c8(0xf13)]===_0x50c2c8(0x1071)?_0xbad3b6['src']=_0x37c49c:_0xbad3b6[_0x50c2c8(0x1a2)]=_0x37c49c);}}function _0x5f0541(){return new Promise(_0x566467=>{const _0x33a290=_0x1a5b,_0x225025=document[_0x33a290(0xe7d)](_0x33a290(0x754));_0x225025[_0x33a290(0x259)]='file',_0x225025[_0x33a290(0xfbf)]='image/*',_0x225025['onchange']=_0x520fd1=>{const _0x471a46=_0x33a290,_0x3a349c=_0x520fd1[_0x471a46(0x12df)][_0x471a46(0x1a9)][0x0];if(_0x3a349c){const _0x2de5d3=new FileReader();_0x2de5d3['onload']=_0x494ca4=>{const _0x3d33f0=_0x471a46;_0x566467(_0x494ca4[_0x3d33f0(0x12df)][_0x3d33f0(0x2ed)]);},_0x2de5d3['readAsDataURL'](_0x3a349c);}else _0x566467(null);},_0x225025[_0x33a290(0x1122)]();});}async function _0x4e676b(_0x58fac3){const _0x571f9a=_0x204348,_0x4911aa=_0x58fac3['id'],_0x3b7296=_0x58fac3[_0x571f9a(0x1a2)],_0x413efd=await _0x335e57(_0x571f9a(0xdaf),_0x571f9a(0x158),_0x3b7296);if(_0x413efd!==null&&_0x413efd['trim']()!==''){const _0x1be9f6=_0x413efd[_0x571f9a(0x2aa)]();_0x58fac3['textContent']=_0x1be9f6,_0x42f206[_0x571f9a(0xf0)][_0x571f9a(0x755)][_0x4911aa]=_0x1be9f6,await _0x17d534['globalSettings'][_0x571f9a(0xf3f)](_0x42f206['globalSettings']),alert(_0x571f9a(0x3fd));}}async function _0x4f58d3(_0x44331c){const _0x2f5bb1=_0x204348,_0x19c31e=_0x44331c['id'],_0x28484d=await _0xcd7475(_0x2f5bb1(0x638),[{'text':_0x2f5bb1(0xe85),'value':_0x2f5bb1(0x1030)},{'text':'🌐\x20使用网络URL','value':_0x2f5bb1(0x1377)}]);let _0x5491c3=null;if(_0x28484d==='local')_0x5491c3=await _0x5f0541();else _0x28484d===_0x2f5bb1(0x1377)&&(_0x5491c3=await _0x335e57('修改图片',_0x2f5bb1(0xede),_0x44331c[_0x2f5bb1(0x577)],_0x2f5bb1(0x1377)));if(_0x5491c3&&_0x5491c3['trim']()){const _0x1ae248=_0x5491c3[_0x2f5bb1(0x2aa)]();_0x44331c['src']=_0x1ae248,_0x42f206[_0x2f5bb1(0xf0)][_0x2f5bb1(0x755)][_0x19c31e]=_0x1ae248,await _0x17d534['globalSettings'][_0x2f5bb1(0xf3f)](_0x42f206['globalSettings']),alert(_0x2f5bb1(0x1352));}else _0x28484d==='url'&&_0x5491c3!==null&&alert(_0x2f5bb1(0x94d));}const _0x51b072={'getSongCache'(_0xff71d4,_0x2e7244){const _0x2ff991=_0x204348,_0xa89849=(_0x2e7244||_0x2ff991(0xfe2))+':'+_0xff71d4;if(_0x42f206[_0x2ff991(0xe21)]&&_0x42f206['cache'][_0x2ff991(0x591)]){const _0xc4302a=_0x42f206[_0x2ff991(0xe21)][_0x2ff991(0x591)][_0x2ff991(0x36d)](_0xa89849);if(_0xc4302a&&Date[_0x2ff991(0x606)]()-_0xc4302a[_0x2ff991(0xf16)]<0x36ee80)return _0xc4302a['data'];}return null;},'setSongCache'(_0x40e9c6,_0x54b15a,_0x311b00){const _0x723b87=_0x204348,_0x515401=(_0x311b00||_0x723b87(0xfe2))+':'+_0x40e9c6;if(!_0x42f206[_0x723b87(0xe21)])_0x42f206[_0x723b87(0xe21)]={};if(!_0x42f206[_0x723b87(0xe21)][_0x723b87(0x591)])_0x42f206[_0x723b87(0xe21)][_0x723b87(0x591)]=new Map();_0x42f206[_0x723b87(0xe21)][_0x723b87(0x591)]['set'](_0x515401,{'data':_0x54b15a,'timestamp':Date[_0x723b87(0x606)]()});}};typeof Http_Get_External===_0x204348(0x37c)&&(window[_0x204348(0xff9)]=function(_0x27d739){return new Promise(_0x73405e=>{const _0x577ea2=_0x1a5b;fetch(_0x27d739)['then'](_0x568d60=>_0x568d60[_0x577ea2(0xaef)]()[_0x577ea2(0x1135)](()=>_0x568d60[_0x577ea2(0xdd5)]()))[_0x577ea2(0x1260)](_0x73405e)[_0x577ea2(0x1135)](()=>_0x73405e(null));});});async function _0x2c35ad(_0x25f739){return await Http_Get_External(_0x25f739);}function _0x1376c0(_0x3eabe8){return new Promise(_0x16dbc2=>{const _0x5de795=_0x1a5b,_0x51c567=new Audio();_0x51c567[_0x5de795(0xd85)](_0x5de795(0x765),()=>_0x16dbc2(!![]),{'once':!![]}),_0x51c567[_0x5de795(0xd85)]('error',()=>_0x16dbc2(![]),{'once':!![]}),_0x51c567['src']=_0x3eabe8;});}async function _0x15b651(_0x2c655f,_0x131857){const _0x418221=_0x204348;try{let _0xd34283=_0x2c655f[_0x418221(0x33b)](/\s/g,'');_0x131857&&(_0xd34283+='\x20'+_0x131857[_0x418221(0x33b)](/\s/g,''));const _0x2418db=_0x418221(0x55e)+encodeURIComponent(_0xd34283);console[_0x418221(0x7d1)]('正在请求网易云音乐API:',_0x2418db);const _0x18aab6=await fetch(_0x2418db);if(!_0x18aab6['ok'])throw new Error('API\x20请求失败，状态码:\x20'+_0x18aab6[_0x418221(0x13b2)]);const _0x2cdeaf=await _0x18aab6[_0x418221(0xaef)]();if(_0x2cdeaf['code']!==0xc8||!_0x2cdeaf['data']||_0x2cdeaf[_0x418221(0x76b)][_0x418221(0x131d)]===0x0)return console[_0x418221(0x7d1)](_0x418221(0xf45),_0x2cdeaf),[];return _0x2cdeaf[_0x418221(0x76b)]['map'](_0x4744fc=>({'name':_0x4744fc['song'],'artist':_0x4744fc['singer'],'id':_0x4744fc['id'],'cover':_0x4744fc[_0x418221(0x847)]||_0x418221(0xe41),'source':_0x418221(0x302)}))[_0x418221(0x5b0)](0x0,0x1e);}catch(_0x52188c){return console[_0x418221(0xb61)](_0x418221(0xa3c),_0x52188c),[];}}async function _0x2fab6d(_0x451b80){const _0x252aa3=_0x204348;try{_0x451b80=_0x451b80[_0x252aa3(0x33b)](/\s/g,'');const _0x1423aa=await _0x2c35ad(_0x252aa3(0x13eb)+encodeURIComponent(_0x451b80));if(!_0x1423aa?.['data']?.[_0x252aa3(0x131d)])return[];return _0x1423aa[_0x252aa3(0x76b)]['map'](_0x3f2278=>({'name':_0x3f2278[_0x252aa3(0x4dd)],'artist':_0x3f2278['singer'],'id':_0x3f2278['id'],'cover':_0x3f2278[_0x252aa3(0x847)]||_0x252aa3(0xe57),'source':_0x252aa3(0xd70)}))[_0x252aa3(0x5b0)](0x0,0x1e);}catch(_0x39ccda){return console[_0x252aa3(0xb61)](_0x252aa3(0xc18),_0x39ccda),[];}}async function _0xc54b55(){const _0x2b26de=_0x204348,_0x6303a8=await _0x335e57(_0x2b26de(0xff4),_0x2b26de(0xe9d));if(!_0x6303a8||!_0x6303a8[_0x2b26de(0x2aa)]())return;await _0x34fce8(_0x2b26de(0x12b9),_0x2b26de(0x62f));let _0x167fbc=_0x6303a8[_0x2b26de(0x2aa)](),_0x503828='';if(_0x6303a8[_0x2b26de(0xd8d)]('-')||_0x6303a8['includes']('–')){const _0xe404a7=_0x6303a8['split'](/[-–]/);_0x167fbc=_0xe404a7[0x0][_0x2b26de(0x2aa)](),_0x503828=_0xe404a7[_0x2b26de(0x5b0)](0x1)[_0x2b26de(0x56c)]('\x20')[_0x2b26de(0x2aa)]();}const [_0x5ef00c,_0x59b6b3]=await Promise[_0x2b26de(0xfe2)]([_0x15b651(_0x167fbc,_0x503828),_0x2fab6d(_0x167fbc)]),_0x13b82e=[..._0x5ef00c,..._0x59b6b3];if(_0x13b82e['length']===0x0){await _0x34fce8(_0x2b26de(0xf78),'抱歉，未能找到相关歌曲。');return;}const _0x359a6d=document[_0x2b26de(0x458)]('music-search-results-modal'),_0x2da1d6=document[_0x2b26de(0x458)](_0x2b26de(0x10ef));_0x2da1d6[_0x2b26de(0x110d)]='',document[_0x2b26de(0x458)](_0x2b26de(0x2dc))['checked']=![],_0x13b82e['forEach'](_0x1235fb=>{const _0x48673c=_0x2b26de,_0x37b6f0=document[_0x48673c(0xe7d)](_0x48673c(0x1323));_0x37b6f0['className']=_0x48673c(0xa93),_0x37b6f0[_0x48673c(0x1f4)][_0x48673c(0xb6c)]=JSON[_0x48673c(0xc04)](_0x1235fb),_0x37b6f0[_0x48673c(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x1235fb[_0x48673c(0x132a)]+_0x48673c(0x816)+_0x1235fb['artist']+_0x48673c(0x600)+(_0x1235fb[_0x48673c(0x974)]==='netease'?_0x48673c(0xb84):'QQ音乐')+'</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x2da1d6[_0x48673c(0x1079)](_0x37b6f0);}),_0x359a6d[_0x2b26de(0x11c2)][_0x2b26de(0xa58)]('visible');}async function _0x834247(_0x74fbf2){const _0x4214ff=_0x204348;let _0x8a0e5f=null,_0x2320d7=_0x74fbf2[_0x4214ff(0x974)];const _0x444605=_0x74fbf2[_0x4214ff(0x974)]==='netease'?_0x4214ff(0x544)+_0x74fbf2['id']:_0x4214ff(0x13a1)+_0x74fbf2['id'];let _0x18e897=await _0x2c35ad(_0x444605);_0x18e897?.[_0x4214ff(0x76b)]?.['url']&&(_0x8a0e5f={'url':_0x18e897[_0x4214ff(0x76b)]['url'],'id':_0x74fbf2['id'],'source':_0x74fbf2[_0x4214ff(0x974)]});if(!_0x8a0e5f){const _0x524b40=_0x74fbf2['source']==='netease'?'tencent':_0x4214ff(0x302),_0x5c65c8=_0x524b40===_0x4214ff(0xd70)?await _0x2fab6d(_0x74fbf2[_0x4214ff(0x132a)]):await _0x15b651(_0x74fbf2[_0x4214ff(0x132a)],_0x74fbf2[_0x4214ff(0xd81)]);if(_0x5c65c8['length']>0x0){const _0x475ae8=_0x524b40===_0x4214ff(0x302)?_0x4214ff(0x544)+_0x5c65c8[0x0]['id']:_0x4214ff(0x13a1)+_0x5c65c8[0x0]['id'],_0x5442ac=await _0x2c35ad(_0x475ae8);_0x5442ac?.['data']?.[_0x4214ff(0x1377)]&&(_0x8a0e5f={'url':_0x5442ac[_0x4214ff(0x76b)][_0x4214ff(0x1377)],'id':_0x5c65c8[0x0]['id'],'source':_0x524b40},_0x2320d7=_0x524b40);}}if(_0x8a0e5f){_0x8a0e5f['url']&&typeof _0x8a0e5f['url']===_0x4214ff(0x861)&&(_0x8a0e5f[_0x4214ff(0x1377)]=_0x8a0e5f[_0x4214ff(0x1377)][_0x4214ff(0x33b)](/^http:\/\//i,_0x4214ff(0xffc)));_0x74fbf2[_0x4214ff(0x847)]&&typeof _0x74fbf2[_0x4214ff(0x847)]===_0x4214ff(0x861)&&(_0x74fbf2[_0x4214ff(0x847)]=_0x74fbf2[_0x4214ff(0x847)]['replace'](/^http:\/\//i,_0x4214ff(0xffc)));const _0x3bc3bc=await _0x3ffc7b(_0x8a0e5f['id'],_0x2320d7)||'';return{'name':_0x74fbf2[_0x4214ff(0x132a)],'artist':_0x74fbf2['artist'],'src':_0x8a0e5f['url'],'cover':_0x74fbf2[_0x4214ff(0x847)],'isLocal':![],'lrcContent':_0x3bc3bc};}return null;}async function _0x3ffc7b(_0x3cfd26,_0x574079){const _0x36d816=_0x204348,_0x35e12f=_0x574079==='netease'?_0x36d816(0xc97)+_0x3cfd26:_0x36d816(0x2a5)+_0x3cfd26,_0x312d8d=await _0x2c35ad(_0x35e12f);if(_0x312d8d?.[_0x36d816(0x76b)]){const _0x7a3515=_0x312d8d[_0x36d816(0x76b)]['lrc']||_0x312d8d[_0x36d816(0x76b)]['lyric']||'',_0x5f3fc7=_0x312d8d[_0x36d816(0x76b)][_0x36d816(0xebb)]||_0x312d8d['data'][_0x36d816(0x142d)]||'';return _0x7a3515+'\x0a'+_0x5f3fc7;}return'';}async function _0x97e5ff(_0x51d29e){const _0x4177af=_0x204348;if(_0x51d29e<0x0||_0x51d29e>=_0x59377b[_0x4177af(0x1102)][_0x4177af(0x131d)])return;const _0x1495ff=await _0xcd7475('选择歌词导入方式',[{'text':_0x4177af(0x78d),'value':_0x4177af(0x67b)},{'text':_0x4177af(0x597),'value':_0x4177af(0x949)}]);let _0x2f401b=null;if(_0x1495ff===_0x4177af(0x67b))_0x2f401b=await new Promise(_0x327f81=>{const _0x370854=_0x4177af,_0x3096f5=document[_0x370854(0x458)](_0x370854(0x12dc)),_0xd0b2e7=_0x493055=>{const _0x2cbbca=_0x370854,_0x4316de=_0x493055['target'][_0x2cbbca(0x1a9)][0x0];if(_0x4316de){const _0x3c0053=new FileReader();_0x3c0053['onload']=_0x19a6a1=>_0x327f81(_0x19a6a1['target'][_0x2cbbca(0x2ed)]),_0x3c0053[_0x2cbbca(0x4de)]=()=>_0x327f81(null),_0x3c0053[_0x2cbbca(0x12e7)](_0x4316de);}else _0x327f81(null);_0x3096f5[_0x2cbbca(0x13ac)](_0x2cbbca(0x26a),_0xd0b2e7),_0x3096f5[_0x2cbbca(0x8dd)]='';};_0x3096f5[_0x370854(0xd85)]('change',_0xd0b2e7,{'once':!![]}),_0x3096f5[_0x370854(0x1122)]();});else{if(_0x1495ff===_0x4177af(0x949)){const _0x2572ee=await _0x335e57('粘贴歌词',_0x4177af(0x1cb),'',_0x4177af(0xb43));if(_0x2572ee)_0x2f401b=_0x2572ee[_0x4177af(0x33b)](/\[/g,'\x0a[')[_0x4177af(0x2aa)]();}}_0x2f401b!==null&&(_0x59377b[_0x4177af(0x1102)][_0x51d29e][_0x4177af(0x11ec)]=_0x2f401b,await _0x562193(),_0x59377b[_0x4177af(0x4bd)]===_0x51d29e&&(_0x59377b[_0x4177af(0x169)]=_0x3e0f49(_0x2f401b),_0x1616be(),_0x1da315()),await _0x34fce8('成功','《'+_0x59377b[_0x4177af(0x1102)][_0x51d29e][_0x4177af(0x132a)]+_0x4177af(0xb58)));}async function _0x5e04d2(){const _0x180aed=_0x204348;if(_0x59377b['currentIndex']===-0x1)return;const _0x57f146=_0x59377b[_0x180aed(0x1102)][_0x59377b[_0x180aed(0x4bd)]];if(!_0x57f146)return;_0x57f146[_0x180aed(0x13b4)]=!_0x57f146[_0x180aed(0x13b4)],await _0x562193();const _0x13a35a=document[_0x180aed(0x586)](_0x180aed(0xef6)),_0x126443=document[_0x180aed(0x458)]('toggle-blur-btn');_0x13a35a[_0x180aed(0x11c2)][_0x180aed(0x1270)](_0x180aed(0x11f2),_0x57f146[_0x180aed(0x13b4)]),_0x126443[_0x180aed(0x11c2)][_0x180aed(0x1270)](_0x180aed(0xfe1),_0x57f146[_0x180aed(0x13b4)]);}function _0x11971e(){const _0x496075=_0x204348,_0x16cbbe=document[_0x496075(0x458)](_0x496075(0x784)),_0x2f5a00=document['getElementById'](_0x496075(0x35a));_0x16cbbe&&_0x2f5a00&&(_0x16cbbe[_0x496075(0x11c2)]['toggle'](_0x496075(0x67d)),_0x2f5a00[_0x496075(0x11c2)]['toggle'](_0x496075(0xfe1)));}function _0x201074(){const _0x256731=_0x204348,_0x343158=document[_0x256731(0x586)](_0x256731(0xef6)),_0x5e23a9=document['getElementById'](_0x256731(0x2df));_0x343158&&_0x5e23a9&&(_0x343158[_0x256731(0x11c2)]['toggle'](_0x256731(0xef8)),_0x5e23a9[_0x256731(0x11c2)][_0x256731(0x1270)](_0x256731(0xea8)));}window['togglePlayerFullscreen']=_0x201074;async function _0x5eb173(){const _0x2d5e27=_0x204348;if(_0x59377b[_0x2d5e27(0x1102)]['length']===0x0){alert('播放列表是空的，无需清理。');return;}const _0x538919=await _0x2532b9(_0x2d5e27(0xedd),'此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。',{'confirmText':_0x2d5e27(0x3d2)});if(!_0x538919)return;await _0x34fce8(_0x2d5e27(0x12b9),_0x2d5e27(0xca0)+_0x59377b[_0x2d5e27(0x1102)]['length']+'\x20首歌曲，这可能需要一些时间...');const _0x1c8c49=_0x59377b[_0x2d5e27(0x1102)]['length'],_0xe4659e=[],_0x186d6d=[],_0x38063b=_0x59377b[_0x2d5e27(0x1102)][_0x2d5e27(0xbf6)](async _0x4ed739=>{const _0x391850=_0x2d5e27;if(_0x4ed739[_0x391850(0x7e9)]){_0xe4659e[_0x391850(0x129e)](_0x4ed739);return;}const _0x1f72f9=await _0x1376c0(_0x4ed739['src']);_0x1f72f9?_0xe4659e['push'](_0x4ed739):(_0x186d6d[_0x391850(0x129e)](_0x4ed739[_0x391850(0x132a)]),console['warn'](_0x391850(0xd73)+_0x4ed739[_0x391850(0x132a)]+_0x391850(0x7da)+_0x4ed739[_0x391850(0x577)]));});await Promise[_0x2d5e27(0xfe2)](_0x38063b);const _0x39a050=_0x1c8c49-_0xe4659e[_0x2d5e27(0x131d)];if(_0x39a050>0x0){const _0x423f06=_0x59377b[_0x2d5e27(0x1102)][_0x59377b[_0x2d5e27(0x4bd)]],_0x28a7d0=_0x186d6d[_0x2d5e27(0xd8d)](_0x423f06?.[_0x2d5e27(0x132a)]);_0x59377b[_0x2d5e27(0x1102)]=_0xe4659e,await _0x562193();if(_0x28a7d0)_0x112d48[_0x2d5e27(0x16a)](),_0x112d48['src']='',_0x59377b[_0x2d5e27(0x4bd)]=_0x59377b['playlist'][_0x2d5e27(0x131d)]>0x0?0x0:-0x1,_0x59377b[_0x2d5e27(0x1111)]=![];else _0x423f06&&(_0x59377b[_0x2d5e27(0x4bd)]=_0x59377b[_0x2d5e27(0x1102)][_0x2d5e27(0x4a8)](_0x4d32aa=>_0x4d32aa[_0x2d5e27(0x577)]===_0x423f06[_0x2d5e27(0x577)]));_0xe64ac7(),_0x481fb2(),await _0x34fce8(_0x2d5e27(0x896),_0x2d5e27(0x80a)+_0x39a050+_0x2d5e27(0x1384)+_0x186d6d['join'](_0x2d5e27(0x12a6)));}else await _0x34fce8(_0x2d5e27(0xa13),_0x2d5e27(0xb14));}function _0x3ad72c(){const _0x35804f=_0x204348,_0x4dab87=document['getElementById'](_0x35804f(0xb3e));_0x4dab87[_0x35804f(0x11c2)][_0x35804f(0x1270)](_0x35804f(0xa0),!!_0x42f206[_0x35804f(0xf0)]['showStatusBar']);}async function _0x26079f(){const _0x907df0=_0x204348,_0x23f7cb=document[_0x907df0(0x458)](_0x907df0(0xdc4)),_0x159f15=document[_0x907df0(0x458)](_0x907df0(0x235));_0x159f15['innerHTML']='';const _0x4ba07a=[];_0x4ba07a['push']({'text':'清空所有动态\x20(危险)','value':_0x907df0(0xfe2),'isDanger':!![]});const _0x5bfdac=_0x42f206[_0x907df0(0x551)][_0x907df0(0x308)]||'我';_0x4ba07a[_0x907df0(0x129e)]({'text':'仅清空\x20'+_0x5bfdac+_0x907df0(0xfac),'value':'user'}),Object['values'](_0x42f206['chats'])[_0x907df0(0x12c2)](_0xe97e3e=>{const _0x16c398=_0x907df0;!_0xe97e3e['isGroup']&&_0x4ba07a['push']({'text':_0x16c398(0x80f)+_0xe97e3e['name']+_0x16c398(0x5c7),'value':_0xe97e3e['id']});});try{const _0xcf0608=await _0x17d534['npcs'][_0x907df0(0x511)]();_0xcf0608[_0x907df0(0x131d)]>0x0&&(_0x4ba07a[_0x907df0(0x129e)]({'isSeparator':!![],'text':_0x907df0(0xdf6)}),_0xcf0608[_0x907df0(0x12c2)](_0x4c284c=>{const _0x2b95d1=_0x907df0;_0x4ba07a['push']({'text':_0x2b95d1(0x80f)+_0x4c284c[_0x2b95d1(0x132a)]+_0x2b95d1(0x9f7),'value':_0x2b95d1(0xa45)+_0x4c284c['id']});}));}catch(_0x45e159){console[_0x907df0(0xb61)]('加载NPC列表失败:',_0x45e159);}_0x4ba07a[_0x907df0(0x12c2)](_0x30d3d2=>{const _0x4843b4=_0x907df0;if(_0x30d3d2[_0x4843b4(0x330)]){const _0x36ffb8=document[_0x4843b4(0xe7d)](_0x4843b4(0x1323));_0x36ffb8[_0x4843b4(0x1a2)]=_0x30d3d2[_0x4843b4(0xdd5)],_0x36ffb8[_0x4843b4(0x1104)][_0x4843b4(0x11f)]=_0x4843b4(0xab6),_0x159f15[_0x4843b4(0x1079)](_0x36ffb8);return;}const _0x49522b=document[_0x4843b4(0xe7d)]('div');_0x49522b['className']='clear-posts-item',_0x30d3d2[_0x4843b4(0x671)]&&_0x49522b[_0x4843b4(0x11c2)][_0x4843b4(0xa58)](_0x4843b4(0xf65)),_0x49522b[_0x4843b4(0x1f4)]['targetId']=_0x30d3d2[_0x4843b4(0x8dd)],_0x49522b[_0x4843b4(0x110d)]=_0x4843b4(0x245)+_0x30d3d2['text']+_0x4843b4(0x106a),_0x159f15[_0x4843b4(0x1079)](_0x49522b);}),_0x23f7cb['classList']['add'](_0x907df0(0x67d));}async function _0x303e8b(){const _0x548b4b=_0x204348,_0x8d7ce6=document['querySelectorAll'](_0x548b4b(0xd7c));if(_0x8d7ce6[_0x548b4b(0x131d)]===0x0){alert(_0x548b4b(0x6f8));return;}const _0x4befed=Array[_0x548b4b(0xca2)](_0x8d7ce6)[_0x548b4b(0xbf6)](_0x4439d2=>_0x4439d2[_0x548b4b(0x1f4)][_0x548b4b(0x7c3)]);let _0x2af36f=[];_0x4befed[_0x548b4b(0xd8d)](_0x548b4b(0xfe2))?_0x2af36f['push'](_0x548b4b(0x14f)):(_0x4befed[_0x548b4b(0xd8d)](_0x548b4b(0xf86))&&_0x2af36f[_0x548b4b(0x129e)]('“'+_0x42f206[_0x548b4b(0x551)][_0x548b4b(0x308)]+'”'),_0x4befed['forEach'](_0xcf8bfd=>{const _0x413d3b=_0x548b4b,_0x252e17=_0x42f206[_0x413d3b(0x954)][_0xcf8bfd];_0x252e17&&_0x2af36f[_0x413d3b(0x129e)]('“'+_0x252e17['name']+'”');}));const _0xe83eea=_0x548b4b(0xf61)+_0x2af36f[_0x548b4b(0x56c)]('、\x20')+_0x548b4b(0x1363),_0x580912=await _0x2532b9(_0x548b4b(0x978),_0xe83eea,{'confirmButtonClass':'btn-danger','confirmText':'确认清空'});if(!_0x580912)return;try{_0x4befed[_0x548b4b(0xd8d)](_0x548b4b(0xfe2))?await _0x17d534[_0x548b4b(0x15b)][_0x548b4b(0x415)]():await _0x17d534['qzonePosts'][_0x548b4b(0x13c6)](_0x548b4b(0x1086))['anyOf'](_0x4befed)['delete'](),_0x394ad5=await _0x17d534[_0x548b4b(0x15b)]['orderBy'](_0x548b4b(0xf16))['reverse']()['toArray'](),_0x577f17=0x0,await _0x316550(),document[_0x548b4b(0x458)]('clear-posts-modal')[_0x548b4b(0x11c2)][_0x548b4b(0x1097)](_0x548b4b(0x67d)),await _0x34fce8(_0x548b4b(0x1336),_0x548b4b(0x60c));}catch(_0x3f2cac){console[_0x548b4b(0xb61)]('清空动态时出错:',_0x3f2cac),await _0x34fce8(_0x548b4b(0x96d),_0x548b4b(0x4d7)+_0x3f2cac[_0x548b4b(0x7aa)]);}}async function _0x45f683(_0x4d2b6e){const _0x1ed141=_0x204348,_0x1dc375=await _0x2532b9(_0x1ed141(0x1ef),'确定要永久删除这条心声记录吗？此操作不可恢复。',{'confirmButtonClass':_0x1ed141(0x4d3),'confirmText':_0x1ed141(0x1ef)});if(_0x1dc375){const _0x3bc3a2=_0x42f206[_0x1ed141(0x954)][_0x42f206[_0x1ed141(0x81d)]];if(!_0x3bc3a2||!_0x3bc3a2[_0x1ed141(0x6b8)])return;const _0x5ba547=_0x3bc3a2[_0x1ed141(0x6b8)][_0x1ed141(0x4a8)](_0x1fc3bb=>_0x1fc3bb['timestamp']===_0x4d2b6e);if(_0x5ba547===-0x1)return;const _0x2f7100=_0x5ba547===_0x3bc3a2['thoughtsHistory'][_0x1ed141(0x131d)]-0x1;_0x3bc3a2[_0x1ed141(0x6b8)]=_0x3bc3a2[_0x1ed141(0x6b8)][_0x1ed141(0xaf1)](_0x4bab0e=>_0x4bab0e['timestamp']!==_0x4d2b6e);if(_0x2f7100){if(_0x3bc3a2[_0x1ed141(0x6b8)]['length']>0x0){const _0xcb61c0=_0x3bc3a2[_0x1ed141(0x6b8)][_0x3bc3a2[_0x1ed141(0x6b8)][_0x1ed141(0x131d)]-0x1];_0x3bc3a2['heartfeltVoice']=_0xcb61c0[_0x1ed141(0xb0f)],_0x3bc3a2['randomJottings']=_0xcb61c0[_0x1ed141(0x8eb)];const _0x43e751=document['getElementById'](_0x1ed141(0x668)),_0xdf0e25=document[_0x1ed141(0x458)]('profile-random-jottings');if(_0x43e751)_0x43e751[_0x1ed141(0x1a2)]=_0x3bc3a2['heartfeltVoice'];if(_0xdf0e25)_0xdf0e25['textContent']=_0x3bc3a2[_0x1ed141(0x8eb)];console[_0x1ed141(0x7d1)](_0x1ed141(0x324));}else{_0x3bc3a2[_0x1ed141(0xb0f)]=_0x1ed141(0x10a0),_0x3bc3a2[_0x1ed141(0x8eb)]=_0x1ed141(0x10a0);const _0x4339c7=document[_0x1ed141(0x458)](_0x1ed141(0x668)),_0x5a2f1b=document[_0x1ed141(0x458)]('profile-random-jottings');if(_0x4339c7)_0x4339c7[_0x1ed141(0x1a2)]=_0x3bc3a2['heartfeltVoice'];if(_0x5a2f1b)_0x5a2f1b['textContent']=_0x3bc3a2['randomJottings'];console[_0x1ed141(0x7d1)](_0x1ed141(0x1395));}}await _0x17d534[_0x1ed141(0x954)][_0x1ed141(0xf3f)](_0x3bc3a2),_0x380c55(),await _0x34fce8('成功',_0x1ed141(0xcd0));}}document['getElementById'](_0x204348(0xeb))[_0x204348(0xd85)](_0x204348(0x1122),_0x4a558a=>{const _0x933804=_0x204348,_0x2576f5=_0x4a558a[_0x933804(0x12df)][_0x933804(0xe87)](_0x933804(0xcf5));if(_0x2576f5){const _0x23e80e=parseInt(_0x2576f5[_0x933804(0x1f4)][_0x933804(0xf16)]);!isNaN(_0x23e80e)&&_0x45f683(_0x23e80e);}});async function _0x220a78(){const _0x2ee428=_0x204348,_0x3105a8=document[_0x2ee428(0x458)](_0x2ee428(0x691));_0x3105a8[_0x2ee428(0x110d)]='<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>';const _0x3a1813=await _0x17d534[_0x2ee428(0x64f)][_0x2ee428(0x13c6)](_0x2ee428(0x259))[_0x2ee428(0x7db)]('global_css')[_0x2ee428(0x511)]();_0x3a1813[_0x2ee428(0x12c2)](_0x465e2d=>{const _0x1acae6=_0x2ee428,_0x2761bc=document[_0x1acae6(0xe7d)](_0x1acae6(0x790));_0x2761bc[_0x1acae6(0x8dd)]=_0x465e2d['id'],_0x2761bc['textContent']=_0x465e2d[_0x1acae6(0x132a)],_0x3105a8[_0x1acae6(0x1079)](_0x2761bc);});}async function _0x398c36(){const _0x4c0b7a=_0x204348,_0x170b62=document[_0x4c0b7a(0x458)](_0x4c0b7a(0x691)),_0x505aeb=parseInt(_0x170b62[_0x4c0b7a(0x8dd)]);if(isNaN(_0x505aeb))return;const _0x405513=await _0x17d534[_0x4c0b7a(0x64f)][_0x4c0b7a(0x36d)](_0x505aeb);if(_0x405513){const _0x54226f=document['getElementById'](_0x4c0b7a(0xb1d));_0x54226f[_0x4c0b7a(0x8dd)]=_0x405513[_0x4c0b7a(0x8dd)],_0x410076(_0x405513[_0x4c0b7a(0x8dd)]);}}async function _0x10b0de(){const _0x33475b=_0x204348,_0x33bb95=await _0x335e57(_0x33475b(0xa32),'请输入预设名称');if(!_0x33bb95||!_0x33bb95['trim']())return;const _0x43cef6=document[_0x33475b(0x458)]('global-css-input')[_0x33475b(0x8dd)],_0x1f9e93=await _0x17d534[_0x33475b(0x64f)][_0x33475b(0x13c6)]({'name':_0x33bb95[_0x33475b(0x2aa)](),'type':'global_css'})['first']();if(_0x1f9e93){const _0x3a8e8b=await _0x2532b9('覆盖预设',_0x33475b(0x11bc)+_0x33bb95[_0x33475b(0x2aa)]()+_0x33475b(0x720),{'confirmButtonClass':'btn-danger'});if(!_0x3a8e8b)return;await _0x17d534[_0x33475b(0x64f)][_0x33475b(0x938)](_0x1f9e93['id'],{'value':_0x43cef6});}else await _0x17d534[_0x33475b(0x64f)][_0x33475b(0xa58)]({'name':_0x33bb95[_0x33475b(0x2aa)](),'type':_0x33475b(0x969),'value':_0x43cef6});await _0x220a78(),alert(_0x33475b(0x3ec));}async function _0x239890(){const _0x9dc3b=_0x204348,_0x36db42=document['getElementById'](_0x9dc3b(0x691)),_0x8e5667=parseInt(_0x36db42[_0x9dc3b(0x8dd)]);if(isNaN(_0x8e5667)){alert(_0x9dc3b(0x977));return;}const _0x5c77c0=await _0x17d534[_0x9dc3b(0x64f)][_0x9dc3b(0x36d)](_0x8e5667);if(!_0x5c77c0)return;const _0x3563c7=await _0x2532b9(_0x9dc3b(0xa68),'确定要删除预设\x20“'+_0x5c77c0[_0x9dc3b(0x132a)]+_0x9dc3b(0x581),{'confirmButtonClass':_0x9dc3b(0x4d3)});_0x3563c7&&(await _0x17d534['appearancePresets']['delete'](_0x8e5667),await _0x220a78(),alert(_0x9dc3b(0x380)));}async function _0x2ea2e5(){const _0x4e672a=_0x204348,_0x390935=document[_0x4e672a(0x458)](_0x4e672a(0xbd8));_0x390935['innerHTML']='<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>';const _0x1f528e=await _0x17d534['appearancePresets'][_0x4e672a(0x13c6)](_0x4e672a(0x259))['equals'](_0x4e672a(0x93b))[_0x4e672a(0x511)]();_0x1f528e[_0x4e672a(0x12c2)](_0x344589=>{const _0x68829b=_0x4e672a,_0x2b6743=document[_0x68829b(0xe7d)](_0x68829b(0x790));_0x2b6743['value']=_0x344589['id'],_0x2b6743[_0x68829b(0x1a2)]=_0x344589[_0x68829b(0x132a)],_0x390935[_0x68829b(0x1079)](_0x2b6743);});}async function _0x2aa9b6(){const _0x30da7e=_0x204348,_0x3fe72b=document[_0x30da7e(0x458)](_0x30da7e(0xbd8)),_0x25fe54=parseInt(_0x3fe72b[_0x30da7e(0x8dd)]);if(isNaN(_0x25fe54))return;const _0x4b5c40=await _0x17d534[_0x30da7e(0x64f)][_0x30da7e(0x36d)](_0x25fe54);if(_0x4b5c40){const _0x4a1993=document[_0x30da7e(0x458)]('font-url-input');_0x4a1993['value']=_0x4b5c40[_0x30da7e(0x8dd)],_0x393d41(_0x4b5c40[_0x30da7e(0x8dd)],!![]);}}async function _0x22a641(){const _0x187504=_0x204348,_0xef6115=await _0x335e57(_0x187504(0x487),_0x187504(0x19f));if(!_0xef6115||!_0xef6115['trim']())return;const _0x227460=document[_0x187504(0x458)](_0x187504(0x8a7))[_0x187504(0x8dd)][_0x187504(0x2aa)]();if(!_0x227460){alert(_0x187504(0x2c0));return;}const _0x54a627=await _0x17d534[_0x187504(0x64f)]['where']({'name':_0xef6115[_0x187504(0x2aa)](),'type':_0x187504(0x93b)})[_0x187504(0xb9)]();if(_0x54a627){const _0x751ef9=await _0x2532b9(_0x187504(0x4af),_0x187504(0x11bc)+_0xef6115[_0x187504(0x2aa)]()+_0x187504(0x720),{'confirmButtonClass':_0x187504(0x4d3)});if(!_0x751ef9)return;await _0x17d534['appearancePresets']['update'](_0x54a627['id'],{'value':_0x227460});}else await _0x17d534[_0x187504(0x64f)]['add']({'name':_0xef6115['trim'](),'type':_0x187504(0x93b),'value':_0x227460});await _0x2ea2e5(),alert(_0x187504(0x1266));}async function _0x5c866c(){const _0x30428b=_0x204348,_0x2eb6c5=document[_0x30428b(0x458)](_0x30428b(0xbd8)),_0x10e9b8=parseInt(_0x2eb6c5['value']);if(isNaN(_0x10e9b8)){alert(_0x30428b(0x977));return;}const _0x48e5d0=await _0x17d534[_0x30428b(0x64f)][_0x30428b(0x36d)](_0x10e9b8);if(!_0x48e5d0)return;const _0x469490=await _0x2532b9(_0x30428b(0xa68),'确定要删除预设\x20“'+_0x48e5d0[_0x30428b(0x132a)]+'”\x20吗？',{'confirmButtonClass':_0x30428b(0x4d3)});_0x469490&&(await _0x17d534[_0x30428b(0x64f)][_0x30428b(0x195)](_0x10e9b8),await _0x2ea2e5(),alert(_0x30428b(0x380)));}async function _0x1a2e2f(){const _0x59e4f5=_0x204348,_0x4a4ec3=document[_0x59e4f5(0x458)](_0x59e4f5(0x54b));_0x4a4ec3['innerHTML']=_0x59e4f5(0x1056);const _0x1745e7=await _0x17d534[_0x59e4f5(0x64f)][_0x59e4f5(0x13c6)](_0x59e4f5(0x259))['equals'](_0x59e4f5(0xdbe))[_0x59e4f5(0x511)]();_0x1745e7[_0x59e4f5(0x12c2)](_0x4e19a9=>{const _0x8a3834=_0x59e4f5,_0x2a55c1=document[_0x8a3834(0xe7d)](_0x8a3834(0x790));_0x2a55c1[_0x8a3834(0x8dd)]=_0x4e19a9['id'],_0x2a55c1[_0x8a3834(0x1a2)]=_0x4e19a9[_0x8a3834(0x132a)],_0x4a4ec3[_0x8a3834(0x1079)](_0x2a55c1);});const _0x2a22d7={'wallpaper':_0x42f206[_0x59e4f5(0xf0)][_0x59e4f5(0xef2)],'cphoneWallpaper':_0x42f206[_0x59e4f5(0xf0)]['cphoneWallpaper'],'globalChatBackground':_0x42f206[_0x59e4f5(0xf0)][_0x59e4f5(0x203)],'appIcons':_0x42f206['globalSettings']['appIcons'],'cphoneAppIcons':_0x42f206[_0x59e4f5(0xf0)]['cphoneAppIcons'],'chatActionButtonsOrder':_0x42f206[_0x59e4f5(0xf0)][_0x59e4f5(0x4b9)],'theme':localStorage[_0x59e4f5(0x127d)]('ephone-theme')||_0x59e4f5(0x580),'showStatusBar':_0x42f206[_0x59e4f5(0xf0)][_0x59e4f5(0x733)],'notificationSoundUrl':_0x42f206[_0x59e4f5(0xf0)]['notificationSoundUrl'],'widgetData':_0x42f206[_0x59e4f5(0xf0)][_0x59e4f5(0x755)]};let _0x4cfa03=null;for(const _0x5011d0 of _0x1745e7){if(JSON[_0x59e4f5(0xc04)](_0x5011d0['value'])===JSON['stringify'](_0x2a22d7)){_0x4cfa03=_0x5011d0['id'];break;}}_0x4cfa03?_0x4a4ec3[_0x59e4f5(0x8dd)]=_0x4cfa03:_0x4a4ec3[_0x59e4f5(0x8dd)]='';}async function _0x49ef80(){const _0x44f72e=_0x204348,_0xf8d622=document[_0x44f72e(0x458)](_0x44f72e(0x54b)),_0x458f18=parseInt(_0xf8d622['value']);if(isNaN(_0x458f18))return;const _0x4080a2=await _0x17d534[_0x44f72e(0x64f)][_0x44f72e(0x36d)](_0x458f18);if(_0x4080a2&&_0x4080a2[_0x44f72e(0x8dd)]){const _0x12384c=_0x4080a2['value'];Object[_0x44f72e(0xece)](_0x42f206[_0x44f72e(0xf0)],_0x12384c),_0x4c5063(_0x12384c[_0x44f72e(0xbdc)]||_0x44f72e(0x580)),await _0x17d534['globalSettings'][_0x44f72e(0xf3f)](_0x42f206['globalSettings']),_0x3f8328(),_0x4eca92(),_0x427694(),_0x3abb21(),_0x3ad72c(),_0x19044c(),_0x3b3899(),alert(_0x44f72e(0x931)+_0x4080a2['name']+'”');}}async function _0x36714d(){const _0x16fb3a=_0x204348,_0x4f8f59=await _0x335e57(_0x16fb3a(0x6fb),_0x16fb3a(0x19f));if(!_0x4f8f59||!_0x4f8f59[_0x16fb3a(0x2aa)]())return;const _0x239ea6={'wallpaper':_0x42f206[_0x16fb3a(0xf0)][_0x16fb3a(0xef2)],'cphoneWallpaper':_0x42f206[_0x16fb3a(0xf0)][_0x16fb3a(0x3bc)],'globalChatBackground':_0x42f206[_0x16fb3a(0xf0)]['globalChatBackground'],'appIcons':_0x42f206[_0x16fb3a(0xf0)][_0x16fb3a(0x6a3)],'cphoneAppIcons':_0x42f206[_0x16fb3a(0xf0)][_0x16fb3a(0x6e8)],'chatActionButtonsOrder':_0x42f206[_0x16fb3a(0xf0)][_0x16fb3a(0x4b9)],'theme':localStorage[_0x16fb3a(0x127d)](_0x16fb3a(0x1271))||_0x16fb3a(0x580),'showStatusBar':_0x42f206['globalSettings'][_0x16fb3a(0x733)],'notificationSoundUrl':_0x42f206[_0x16fb3a(0xf0)][_0x16fb3a(0xee7)],'widgetData':_0x42f206[_0x16fb3a(0xf0)][_0x16fb3a(0x755)]},_0x5c4750=await _0x17d534[_0x16fb3a(0x64f)][_0x16fb3a(0x13c6)]({'name':_0x4f8f59[_0x16fb3a(0x2aa)](),'type':_0x16fb3a(0xdbe)})[_0x16fb3a(0xb9)]();if(_0x5c4750){const _0x3ccbbb=await _0x2532b9(_0x16fb3a(0x4af),_0x16fb3a(0x11bc)+_0x4f8f59[_0x16fb3a(0x2aa)]()+_0x16fb3a(0x720),{'confirmButtonClass':_0x16fb3a(0x4d3)});if(!_0x3ccbbb)return;await _0x17d534[_0x16fb3a(0x64f)][_0x16fb3a(0x938)](_0x5c4750['id'],{'value':_0x239ea6});}else await _0x17d534[_0x16fb3a(0x64f)][_0x16fb3a(0xa58)]({'name':_0x4f8f59[_0x16fb3a(0x2aa)](),'type':_0x16fb3a(0xdbe),'value':_0x239ea6});await _0x1a2e2f(),alert('外观预设已保存！');}async function _0x730ec0(){const _0x5e6787=_0x204348,_0x5c3fb5=document[_0x5e6787(0x458)]('appearance-preset-select'),_0x3013db=parseInt(_0x5c3fb5[_0x5e6787(0x8dd)]);if(isNaN(_0x3013db)){alert(_0x5e6787(0x977));return;}const _0x4497fb=await _0x17d534[_0x5e6787(0x64f)][_0x5e6787(0x36d)](_0x3013db);if(!_0x4497fb)return;const _0x33f9aa=await _0x2532b9('删除预设','确定要删除预设\x20“'+_0x4497fb[_0x5e6787(0x132a)]+_0x5e6787(0x581),{'confirmButtonClass':_0x5e6787(0x4d3)});_0x33f9aa&&(await _0x17d534[_0x5e6787(0x64f)][_0x5e6787(0x195)](_0x3013db),await _0x1a2e2f(),alert(_0x5e6787(0x380)));}async function _0x54c2f8(){const _0x12391b=_0x204348,_0x36161f=document[_0x12391b(0x458)]('theme-preset-select');_0x36161f['innerHTML']=_0x12391b(0x1056);const _0x11e5d3=await _0x17d534[_0x12391b(0x64f)][_0x12391b(0x13c6)](_0x12391b(0x259))['equals']('bubble_theme')['toArray']();_0x11e5d3[_0x12391b(0x12c2)](_0x138394=>{const _0x18a115=_0x12391b,_0xcf5e64=document[_0x18a115(0xe7d)](_0x18a115(0x790));_0xcf5e64[_0x18a115(0x8dd)]=_0x138394['id'],_0xcf5e64['textContent']=_0x138394[_0x18a115(0x132a)],_0x36161f[_0x18a115(0x1079)](_0xcf5e64);});}async function _0x3dc0ec(){const _0x3407ab=_0x204348,_0x5ad2aa=document[_0x3407ab(0x458)](_0x3407ab(0x3e0)),_0x4b4960=parseInt(_0x5ad2aa[_0x3407ab(0x8dd)]);if(isNaN(_0x4b4960))return;const _0x49f170=await _0x17d534[_0x3407ab(0x64f)]['get'](_0x4b4960);if(_0x49f170){const _0x3777dc=_0x49f170[_0x3407ab(0x8dd)][_0x3407ab(0x114)]||_0x3407ab(0x1121),_0x576f99=_0x49f170[_0x3407ab(0x8dd)][_0x3407ab(0x76a)]||'',_0x52c8bc=document[_0x3407ab(0x586)](_0x3407ab(0x2d7)+_0x3777dc+'\x22]');_0x52c8bc&&(_0x52c8bc['checked']=!![]);const _0x3283eb=document[_0x3407ab(0x458)](_0x3407ab(0x11bf));_0x3283eb[_0x3407ab(0x8dd)]=_0x576f99,_0x83553f();}}async function _0x413995(){const _0x37517d=_0x204348,_0x29e3ca=await _0x335e57(_0x37517d(0x1460),_0x37517d(0x19f));if(!_0x29e3ca||!_0x29e3ca[_0x37517d(0x2aa)]())return;const _0x2dc69a=document['querySelector'](_0x37517d(0x33d)),_0x341aae=_0x2dc69a?_0x2dc69a['value']:'default',_0x265309=document[_0x37517d(0x458)]('custom-css-input')[_0x37517d(0x8dd)][_0x37517d(0x2aa)](),_0x1c05c6={'base':_0x341aae,'custom':_0x265309},_0x2c8d56=await _0x17d534[_0x37517d(0x64f)][_0x37517d(0x13c6)]({'name':_0x29e3ca[_0x37517d(0x2aa)](),'type':_0x37517d(0xfa0)})[_0x37517d(0xb9)]();if(_0x2c8d56){const _0x10228a=await _0x2532b9(_0x37517d(0x4af),_0x37517d(0x11bc)+_0x29e3ca[_0x37517d(0x2aa)]()+_0x37517d(0x720),{'confirmButtonClass':_0x37517d(0x4d3)});if(!_0x10228a)return;await _0x17d534[_0x37517d(0x64f)]['update'](_0x2c8d56['id'],{'value':_0x1c05c6});}else await _0x17d534[_0x37517d(0x64f)][_0x37517d(0xa58)]({'name':_0x29e3ca[_0x37517d(0x2aa)](),'type':_0x37517d(0xfa0),'value':_0x1c05c6});await _0x54c2f8(),alert(_0x37517d(0x78));}async function _0x23dd92(){const _0x205cdf=_0x204348,_0x5e61a5=document[_0x205cdf(0x458)](_0x205cdf(0x3e0)),_0x19eeec=parseInt(_0x5e61a5['value']);if(isNaN(_0x19eeec)){alert(_0x205cdf(0x977));return;}const _0x53d804=await _0x17d534[_0x205cdf(0x64f)][_0x205cdf(0x36d)](_0x19eeec);if(!_0x53d804)return;const _0x4516f7=await _0x2532b9(_0x205cdf(0xa68),'确定要删除预设\x20“'+_0x53d804[_0x205cdf(0x132a)]+'”\x20吗？',{'confirmButtonClass':'btn-danger'});_0x4516f7&&(await _0x17d534['appearancePresets'][_0x205cdf(0x195)](_0x19eeec),await _0x54c2f8(),alert(_0x205cdf(0x380)));}async function _0x5152a6(){const _0x358234=_0x204348;await _0xa7e4ce(),document[_0x358234(0x458)](_0x358234(0x751))[_0x358234(0x11c2)]['add'](_0x358234(0x67d));}async function _0xa7e4ce(){const _0x1883d6=_0x204348,_0x58203a=document[_0x1883d6(0x458)]('existing-sticker-categories-list'),_0x12f64b=await _0x17d534[_0x1883d6(0x140b)]['toArray']();_0x58203a[_0x1883d6(0x110d)]='';if(_0x12f64b[_0x1883d6(0x131d)]===0x0){_0x58203a[_0x1883d6(0x110d)]=_0x1883d6(0x88);return;}_0x12f64b[_0x1883d6(0x12c2)](_0x740416=>{const _0x1fc49c=_0x1883d6,_0x4156c7=document[_0x1fc49c(0xe7d)](_0x1fc49c(0x1323));_0x4156c7['className']=_0x1fc49c(0x1078),_0x4156c7[_0x1fc49c(0x110d)]=_0x1fc49c(0x970)+_0x740416['name']+_0x1fc49c(0x110f)+_0x740416['id']+_0x1fc49c(0x4d8),_0x58203a[_0x1fc49c(0x1079)](_0x4156c7);});}async function _0xa46a9(){const _0x57fe4b=_0x204348,_0x58ac43=document[_0x57fe4b(0x458)]('new-sticker-category-name-input'),_0x5452d4=_0x58ac43[_0x57fe4b(0x8dd)][_0x57fe4b(0x2aa)]();if(!_0x5452d4){alert(_0x57fe4b(0x4ac));return;}const _0x12ce27=await _0x17d534['stickerCategories'][_0x57fe4b(0x13c6)](_0x57fe4b(0x132a))['equals'](_0x5452d4)['first']();if(_0x12ce27){alert(_0x57fe4b(0x269)+_0x5452d4+_0x57fe4b(0x374));return;}await _0x17d534[_0x57fe4b(0x140b)][_0x57fe4b(0xa58)]({'name':_0x5452d4}),_0x58ac43[_0x57fe4b(0x8dd)]='',await _0xa7e4ce();}async function _0x54555d(_0x1fd47a){const _0x23b89f=_0x204348,_0x27d742=await _0x17d534[_0x23b89f(0x140b)][_0x23b89f(0x36d)](_0x1fd47a);if(!_0x27d742)return;const _0x3fdae1=await _0x17d534[_0x23b89f(0x1294)][_0x23b89f(0x13c6)](_0x23b89f(0x5f7))['equals'](_0x1fd47a)['count'](),_0x1eab4c=_0x3fdae1>0x0?_0x23b89f(0x860)+_0x27d742[_0x23b89f(0x132a)]+_0x23b89f(0x295)+_0x3fdae1+_0x23b89f(0xbf2):_0x23b89f(0x860)+_0x27d742[_0x23b89f(0x132a)]+'》吗？',_0x144dae=await _0x2532b9(_0x23b89f(0xfa7),_0x1eab4c,{'confirmButtonClass':_0x23b89f(0x4d3)});if(_0x144dae)try{await _0x17d534[_0x23b89f(0x9a7)]('rw',_0x17d534[_0x23b89f(0x140b)],_0x17d534[_0x23b89f(0x1294)],async()=>{const _0x24bd40=_0x23b89f,_0x1e9a32=await _0x17d534[_0x24bd40(0x1294)][_0x24bd40(0x13c6)](_0x24bd40(0x5f7))[_0x24bd40(0x7db)](_0x1fd47a)[_0x24bd40(0xe0f)]();_0x1e9a32['length']>0x0&&await _0x17d534['userStickers']['bulkDelete'](_0x1e9a32),await _0x17d534[_0x24bd40(0x140b)][_0x24bd40(0x195)](_0x1fd47a);}),_0x42f206[_0x23b89f(0x1294)]=await _0x17d534[_0x23b89f(0x1294)][_0x23b89f(0x511)](),_0x414f54===_0x1fd47a&&(_0x414f54=_0x23b89f(0xfe2)),await _0xa7e4ce(),await _0x410b06(),alert(_0x23b89f(0xafc)+_0x27d742[_0x23b89f(0x132a)]+_0x23b89f(0xb01));}catch(_0xec2f21){console[_0x23b89f(0xb61)](_0x23b89f(0x932),_0xec2f21),alert(_0x23b89f(0xfcd));}}function _0x2b787b(_0x5ce872){const _0x37a87e=_0x204348;_0x414f54=_0x5ce872,document[_0x37a87e(0x102a)](_0x37a87e(0x6d2))[_0x37a87e(0x12c2)](_0x4159b8=>{const _0x1903e9=_0x37a87e;_0x4159b8['classList'][_0x1903e9(0x1270)](_0x1903e9(0xfe1),String(_0x4159b8[_0x1903e9(0x1f4)][_0x1903e9(0x5f7)])===String(_0x5ce872));}),_0x410b06(![]);const _0x18cd67=document[_0x37a87e(0x458)](_0x37a87e(0x826));if(_0x18cd67)_0x18cd67[_0x37a87e(0x8f7)]=![];}async function _0x50ba68(){const _0x1ee990=_0x204348;if(!_0x42f206[_0x1ee990(0x81d)])return;const _0x3df74f=_0x42f206['chats'][_0x42f206[_0x1ee990(0x81d)]];if(!_0x3df74f)return;try{const _0x3d9796={'type':_0x1ee990(0x67e),'version':0x1,'chatData':_0x3df74f},_0x4b0e27=new Blob([JSON['stringify'](_0x3d9796,null,0x2)],{'type':_0x1ee990(0xa0e)}),_0x1a4bf7=URL[_0x1ee990(0x795)](_0x4b0e27),_0x1a758a=document[_0x1ee990(0xe7d)]('a');_0x1a758a[_0x1ee990(0x1173)]=_0x1a4bf7,_0x1a758a[_0x1ee990(0x3c5)]=_0x1ee990(0x5a1)+_0x3df74f[_0x1ee990(0x132a)]+'-'+new Date()[_0x1ee990(0xf63)]()[_0x1ee990(0x90b)]('T')[0x0]+_0x1ee990(0xb42),_0x1a758a['click'](),URL[_0x1ee990(0x30c)](_0x1a4bf7),await _0x34fce8(_0x1ee990(0x12d8),'与“'+_0x3df74f[_0x1ee990(0x132a)]+'”的聊天记录已成功导出！');}catch(_0x58d6cc){console[_0x1ee990(0xb61)](_0x1ee990(0x6b),_0x58d6cc),await _0x34fce8('导出失败','发生了一个错误:\x20'+_0x58d6cc[_0x1ee990(0x7aa)]);}}async function _0x4ccde3(_0x16ed08){const _0x3873df=_0x204348;if(!_0x16ed08||!_0x42f206['activeChatId'])return;const _0xd84209=_0x42f206[_0x3873df(0x81d)],_0xffc17=_0x42f206[_0x3873df(0x954)][_0xd84209];try{const _0x2e60d3=await _0x16ed08[_0x3873df(0xdd5)](),_0x58e81b=JSON[_0x3873df(0x44c)](_0x2e60d3);if(_0x58e81b['type']!==_0x3873df(0x67e)||!_0x58e81b[_0x3873df(0xfa6)])throw new Error(_0x3873df(0x108c));const _0xd8370a=await _0x2532b9(_0x3873df(0x60b),_0x3873df(0xed0)+_0xffc17[_0x3873df(0x132a)]+'”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>',{'confirmButtonClass':_0x3873df(0x4d3),'confirmText':_0x3873df(0xff)});if(!_0xd8370a)return;const _0x367c01=_0x58e81b[_0x3873df(0xfa6)];_0x367c01['id']=_0xd84209,await _0x17d534['chats'][_0x3873df(0xf3f)](_0x367c01),_0x42f206[_0x3873df(0x954)][_0xd84209]=_0x367c01,await _0x34fce8(_0x3873df(0xf98),_0x3873df(0x567)),_0x359c96(_0xd84209),_0x27be5e(),document[_0x3873df(0x458)]('chat-settings-btn')[_0x3873df(0x1122)]();}catch(_0x291bd2){console[_0x3873df(0xb61)](_0x3873df(0x74),_0x291bd2),await _0x34fce8(_0x3873df(0xfc4),_0x3873df(0x20e)+_0x291bd2[_0x3873df(0x7aa)]);}}function _0x468a1b(){_0x1554d2(),_0x589d88('character-selection-screen');}function _0x1554d2(){const _0x118d51=_0x204348,_0x4e077e=document[_0x118d51(0x458)](_0x118d51(0x10ff));_0x4e077e[_0x118d51(0x110d)]='';const _0xe95f00=Object[_0x118d51(0x6eb)](_0x42f206[_0x118d51(0x954)])[_0x118d51(0xaf1)](_0x38cbbf=>!_0x38cbbf['isGroup']);if(_0xe95f00['length']===0x0){_0x4e077e[_0x118d51(0x110d)]=_0x118d51(0x1419);return;}_0xe95f00['forEach'](_0x393054=>{const _0x3e377f=_0x118d51,_0x96d687=document['createElement'](_0x3e377f(0x1323));_0x96d687[_0x3e377f(0x69b)]=_0x3e377f(0xd8),_0x96d687[_0x3e377f(0x110d)]=_0x3e377f(0x442)+(_0x393054[_0x3e377f(0xda2)][_0x3e377f(0x9c7)]||_0x4fd084)+_0x3e377f(0x10f0)+_0x393054[_0x3e377f(0x132a)]+_0x3e377f(0x106a),_0x96d687[_0x3e377f(0xd85)](_0x3e377f(0x1122),()=>_0x21533c(_0x393054['id'])),_0x4e077e[_0x3e377f(0x1079)](_0x96d687);});}async function _0x21533c(_0xa5335){const _0x647b72=_0x204348;_0xa42f18=_0xa5335,console[_0x647b72(0x7d1)]('已切换到角色\x20'+_0xa5335+'\x20的手机'),_0x4eca92(),_0x3abb21(),_0x5176f4(),_0x589d88(_0x647b72(0x9a1));}function _0x2303f9(){const _0x1391d0=_0x204348;_0xa42f18=null,console['log'](_0x1391d0(0xe0a)),_0x589d88('home-screen');}function _0x5176f4(){const _0x2bb6dc=_0x204348,_0x706844=new Date(),_0x4a0288=_0x706844[_0x2bb6dc(0x11df)]('zh-CN',{'hour':'2-digit','minute':'2-digit'}),_0x2472a4=_0x706844['toLocaleDateString'](_0x2bb6dc(0xaa2),{'weekday':_0x2bb6dc(0x1dc),'month':_0x2bb6dc(0x1dc),'day':_0x2bb6dc(0x4fb)});document[_0x2bb6dc(0x458)](_0x2bb6dc(0x1382))[_0x2bb6dc(0x1a2)]=_0x4a0288,document[_0x2bb6dc(0x458)](_0x2bb6dc(0x2ad))['textContent']=_0x2472a4,_0x3d0170(_0x2bb6dc(0x78e));}function _0x3d0170(_0x59b53d){const _0x24cca3=_0x204348;document[_0x24cca3(0x102a)](_0x24cca3(0x4ab))['forEach'](_0x18d8b3=>_0x18d8b3[_0x24cca3(0x11c2)]['remove'](_0x24cca3(0xfe1))),document[_0x24cca3(0x458)](_0x59b53d)[_0x24cca3(0x11c2)][_0x24cca3(0xa58)](_0x24cca3(0xfe1));}window[_0x204348(0x322)]=_0x3d0170;async function _0x7d88d5(_0x4771ec){const _0x1b5fcc=_0x204348;if(!_0xa42f18)return;const _0x32c8ed=_0x42f206[_0x1b5fcc(0x954)][_0xa42f18];await _0x43bcbe(_0xa42f18,_0x4771ec);switch(_0x4771ec){case'qq':_0x57fcb3(),_0x3d0170(_0x1b5fcc(0x5cc));break;case _0x1b5fcc(0x125d):_0x216409(),_0x3d0170(_0x1b5fcc(0x1362));break;case'browser':_0x586881(),_0x3d0170(_0x1b5fcc(0x53c));break;case'taobao':_0xae0e8(),_0x3d0170(_0x1b5fcc(0x640));break;case'memo':_0x33e838(),_0x3d0170(_0x1b5fcc(0x1262));break;case'diary':_0xfeaded(),_0x3d0170('char-diary-screen');break;case'amap':_0x4a1205(),_0x3d0170('char-amap-screen');break;case'music':_0x288ac5(),_0x3d0170('char-music-screen');break;case _0x1b5fcc(0x8ef):_0x4a498a(),_0x3d0170(_0x1b5fcc(0xffe));break;}}async function _0x216409(){const _0x176965=_0x204348,_0x34a660=document[_0x176965(0x458)](_0x176965(0x848));_0x34a660[_0x176965(0x110d)]='';if(!_0xa42f18)return;const _0x1756cb=_0x42f206[_0x176965(0x954)][_0xa42f18],_0x5ccb19=_0x1756cb[_0x176965(0x11d9)]||[];if(_0x5ccb19[_0x176965(0x131d)]===0x0){_0x34a660[_0x176965(0x110d)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>';return;}const _0x34a83e=_0x176965(0x503);_0x5ccb19['forEach'](_0x161489=>{const _0x12fa3a=_0x176965,_0xfeb7bc=document[_0x12fa3a(0xe7d)](_0x12fa3a(0x1323));_0xfeb7bc['className']=_0x12fa3a(0x291),_0xfeb7bc['dataset']['description']=_0x161489[_0x12fa3a(0x4e9)],_0x34a660[_0x12fa3a(0x1079)](_0xfeb7bc);if(_0x42f206[_0x12fa3a(0xf0)][_0x12fa3a(0xf0e)]){_0xfeb7bc[_0x12fa3a(0x1104)][_0x12fa3a(0x11d7)]=_0x12fa3a(0xb8d);const _0x1d45c5=/[^\x00-\x7F]/['test'](_0x161489[_0x12fa3a(0xef)]),_0x3d59c3=_0x161489[_0x12fa3a(0xef)]&&_0x161489[_0x12fa3a(0xef)]['trim']()&&!_0x1d45c5,_0x3b31e6=_0x3d59c3?_0x161489['image_prompt']:_0x12fa3a(0xa19),_0x2cd0c1=_0x12fa3a(0x94c)+encodeURIComponent(_0x3b31e6),_0x4dbe80=new Image();_0x4dbe80[_0x12fa3a(0x11fa)]=function(){const _0x219bf5=_0x12fa3a;_0xfeb7bc[_0x219bf5(0x1104)][_0x219bf5(0xf7)]=_0x219bf5(0xfa)+this[_0x219bf5(0x577)]+')';},_0x4dbe80[_0x12fa3a(0x4de)]=function(){const _0x111c35=_0x12fa3a;_0xfeb7bc[_0x111c35(0x1104)][_0x111c35(0xf7)]='url('+_0x34a83e+')';},_0x4dbe80[_0x12fa3a(0x577)]=_0x2cd0c1;}else{_0xfeb7bc[_0x12fa3a(0x1104)][_0x12fa3a(0x11d7)]=_0x12fa3a(0xe14),_0xfeb7bc['style'][_0x12fa3a(0xded)]='1px\x20solid\x20#e0e0e0';const _0x3e1b63=document[_0x12fa3a(0xe7d)]('p');_0x3e1b63['className']=_0x12fa3a(0x51a),_0x3e1b63[_0x12fa3a(0x1a2)]=_0x161489[_0x12fa3a(0x4e9)]||_0x12fa3a(0xf52),_0xfeb7bc['appendChild'](_0x3e1b63);}});}function _0x586881(){const _0x3e06ca=_0x204348,_0x4d5b1f=document['getElementById'](_0x3e06ca(0xd24));_0x4d5b1f[_0x3e06ca(0x110d)]='';if(!_0xa42f18)return;const _0x273842=_0x42f206[_0x3e06ca(0x954)][_0xa42f18],_0x542790=[_0x273842['name'],'爱好','旅游','美食','新闻',..._0x273842['settings'][_0x3e06ca(0x31d)][_0x3e06ca(0x90b)](/，|。|\s/)[_0x3e06ca(0x5b0)](0x0,0x5)],_0x1e1e47=['知乎',_0x3e06ca(0x1281),'小红书','微博',_0x3e06ca(0x3dd)];for(let _0x14bc42=0x0;_0x14bc42<0xf;_0x14bc42++){const _0x10c485=_0x542790[Math['floor'](Math[_0x3e06ca(0x23a)]()*_0x542790[_0x3e06ca(0x131d)])],_0x5c2e98=_0x1e1e47[Math[_0x3e06ca(0xbd5)](Math[_0x3e06ca(0x23a)]()*_0x1e1e47['length'])],_0x57ab1b=document[_0x3e06ca(0xe7d)](_0x3e06ca(0x1323));_0x57ab1b['className']=_0x3e06ca(0x12d0),_0x57ab1b[_0x3e06ca(0x110d)]=_0x3e06ca(0xbfe)+_0x10c485+_0x3e06ca(0x7da)+_0x5c2e98+_0x3e06ca(0x6dc)+_0x5c2e98[_0x3e06ca(0xb15)]()+_0x3e06ca(0xf7f)+_0x10c485+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4d5b1f[_0x3e06ca(0x1079)](_0x57ab1b);}}function _0xae0e8(){const _0x5d32c6=_0x204348,_0xcc086d=document['getElementById']('char-product-grid');_0xcc086d[_0x5d32c6(0x110d)]='';if(!_0xa42f18)return;const _0x3725ff=_0x42f206[_0x5d32c6(0x954)][_0xa42f18],_0x19d3b2=_0x3725ff[_0x5d32c6(0x3a7)]?.['purchases']||[];if(_0x19d3b2[_0x5d32c6(0x131d)]===0x0){_0xcc086d[_0x5d32c6(0x110d)]=_0x5d32c6(0x111a);return;}_0x19d3b2[_0x5d32c6(0x12c2)](_0x4e3426=>{const _0x3b7b82=_0x5d32c6,_0x2481cc=document['createElement'](_0x3b7b82(0x1323));_0x2481cc[_0x3b7b82(0x69b)]=_0x3b7b82(0x23f),_0x2481cc[_0x3b7b82(0x1f4)]['reason']=_0x4e3426[_0x3b7b82(0x14e)];let _0x1c1497;if(_0x42f206['globalSettings'][_0x3b7b82(0xf0e)]){const _0x5ca736='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x4e3426[_0x3b7b82(0xef)]||'a\x20random\x20product');_0x1c1497='<img\x20src=\x22'+_0x5ca736+_0x3b7b82(0x9aa);}else _0x1c1497='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>'+(_0x4e3426['reason']||_0x3b7b82(0x997))+_0x3b7b82(0x1009);_0x2481cc[_0x3b7b82(0x110d)]=_0x3b7b82(0x5e1)+_0x1c1497+_0x3b7b82(0x86d)+_0x4e3426[_0x3b7b82(0xce9)]+_0x3b7b82(0x6ff)+(_0x4e3426[_0x3b7b82(0x1043)]||0x0)[_0x3b7b82(0x800)](0x2)+_0x3b7b82(0x9d7)+_0x4e3426['status']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xcc086d[_0x3b7b82(0x1079)](_0x2481cc);});}function _0x280dc7(){const _0x2e5827=_0x204348;_0x3d0170(_0x2e5827(0x78e));}function _0x5665ba(){const _0x5571f9=_0x204348,_0x92cef3=document['getElementById'](_0x5571f9(0x12e5));_0x92cef3['innerHTML']='';if(!_0xa42f18)return;const _0x1b3236=Object[_0x5571f9(0x6eb)](_0x42f206[_0x5571f9(0x954)])[_0x5571f9(0xaf1)](_0x4a9cef=>{const _0x13f1fb=_0x5571f9;if(_0x4a9cef['id']===_0xa42f18)return!![];if(_0x4a9cef['isGroup']&&_0x4a9cef['members'][_0x13f1fb(0x593)](_0x517d84=>_0x517d84['id']===_0xa42f18))return!![];return![];});_0x1b3236[_0x5571f9(0x12c2)](_0x38df6f=>{const _0x5e7b54=_0x5571f9,_0x5181db=_0x1eb370(_0x38df6f);_0x92cef3[_0x5e7b54(0x1079)](_0x5181db);});}async function _0x43bcbe(_0x55dbe4,_0x2ecdf1){const _0x28138c=_0x204348,_0x3ec8f7=_0x42f206[_0x28138c(0x954)][_0x55dbe4];if(!_0x3ec8f7)return;!_0x3ec8f7['appUsageLog']&&(_0x3ec8f7['appUsageLog']=[]),_0x3ec8f7[_0x28138c(0x731)][_0x28138c(0x129e)]({'appName':_0x2ecdf1,'timestamp':Date[_0x28138c(0x606)]()}),_0x3ec8f7[_0x28138c(0x731)][_0x28138c(0x131d)]>0x32&&_0x3ec8f7[_0x28138c(0x731)]['shift'](),await _0x17d534[_0x28138c(0x954)][_0x28138c(0xf3f)](_0x3ec8f7);}function _0x4a498a(){const _0x52827b=_0x204348,_0x4f32d8=document[_0x52827b(0x458)](_0x52827b(0x1096));_0x4f32d8[_0x52827b(0x110d)]='';const _0x4382fc=_0x42f206[_0x52827b(0x954)][_0xa42f18],_0x3a54c1=(_0x4382fc[_0x52827b(0x731)]||[])[_0x52827b(0x5b0)]()['reverse']();if(_0x3a54c1[_0x52827b(0x131d)]===0x0){_0x4f32d8['innerHTML']=_0x52827b(0x13ff);return;}const _0x5b5dbe={'qq':'QQ','album':'相册','browser':_0x52827b(0x3ce),'taobao':'淘宝','memo':_0x52827b(0x138d),'diary':'日记','amap':_0x52827b(0x525),'usage':'App记录'};_0x3a54c1['forEach'](_0x241bcd=>{const _0x19e63e=_0x52827b,_0x20757a=document[_0x19e63e(0xe7d)](_0x19e63e(0x1323));_0x20757a['className']=_0x19e63e(0x5f8),_0x20757a[_0x19e63e(0x110d)]=_0x19e63e(0x905)+new Date(_0x241bcd['timestamp'])[_0x19e63e(0xe43)]()+_0x19e63e(0x99c)+(_0x5b5dbe[_0x241bcd[_0x19e63e(0x10c9)]]||_0x241bcd[_0x19e63e(0x10c9)])+_0x19e63e(0x1eb),_0x4f32d8['appendChild'](_0x20757a);});}async function _0x5f15c0(_0x3718a9){const _0x1f7f30=_0x204348,_0x451f0e=_0x42f206['chats'][_0xa42f18];if(!_0x451f0e)return;const _0x46d815={'role':'assistant','senderName':_0x451f0e['originalName'],'type':_0x1f7f30(0x7c),'content':_0x3718a9,'imageUrl':'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','timestamp':Date[_0x1f7f30(0x606)]()};_0x451f0e[_0x1f7f30(0x1d5)][_0x1f7f30(0x129e)](_0x46d815),await _0x17d534[_0x1f7f30(0x954)][_0x1f7f30(0xf3f)](_0x451f0e),_0x42f206['activeChatId']===_0xa42f18&&_0x5d5ee2(_0x46d815,_0x451f0e),await _0x34fce8(_0x1f7f30(0x757),'“'+_0x451f0e['name']+_0x1f7f30(0x77f));}async function _0x321f14(_0xc3ce95){const _0x3331a8=_0x204348,_0x4b11e9=_0x42f206[_0x3331a8(0x954)][_0xa42f18];if(!_0x4b11e9||!_0x4b11e9['memos'])return;const _0x3318e9=_0x4b11e9[_0x3331a8(0x356)][_0x3331a8(0xb07)](_0x4dafa2=>_0x4dafa2['id']===_0xc3ce95);if(_0x3318e9){_0x195baa=_0x3318e9;const _0x55d71b=document[_0x3331a8(0x458)]('char-memo-detail-title'),_0x5af76e=document[_0x3331a8(0x458)]('char-memo-detail-content'),_0x4a4775=document[_0x3331a8(0x458)](_0x3331a8(0xfcb));if(_0x55d71b)_0x55d71b[_0x3331a8(0x1a2)]=_0x3318e9[_0x3331a8(0x316)];if(_0x5af76e)_0x5af76e[_0x3331a8(0x8dd)]=_0x3318e9[_0x3331a8(0x1316)];const _0x1e4a97=await _0x17d534[_0x3331a8(0xb78)][_0x3331a8(0x13c6)]({'type':_0x3331a8(0x49f),'content.id':_0xc3ce95})[_0x3331a8(0xb9)]();_0x4a4775[_0x3331a8(0x11c2)][_0x3331a8(0x1270)](_0x3331a8(0xfe1),!!_0x1e4a97),_0x3d0170(_0x3331a8(0x13c9));}}function _0x33e838(){const _0x1c041d=_0x204348,_0x25bddd=document[_0x1c041d(0x458)](_0x1c041d(0x400));_0x25bddd['innerHTML']='';const _0x14d1e0=_0x42f206[_0x1c041d(0x954)][_0xa42f18],_0x2e2e8a=(_0x14d1e0[_0x1c041d(0x356)]||[])['slice']()[_0x1c041d(0x115b)]();if(_0x2e2e8a[_0x1c041d(0x131d)]===0x0){_0x25bddd[_0x1c041d(0x110d)]=_0x1c041d(0x520);return;}_0x2e2e8a[_0x1c041d(0x12c2)](_0x1158da=>{const _0x3ce268=_0x1c041d,_0x486308=document['createElement'](_0x3ce268(0x1323));_0x486308[_0x3ce268(0x69b)]=_0x3ce268(0xf3d),_0x486308[_0x3ce268(0x110d)]=_0x3ce268(0x4f6)+_0x1158da[_0x3ce268(0x316)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>'+(_0x1158da[_0x3ce268(0x1316)]||'')['split']('\x0a')[0x0]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x486308[_0x3ce268(0xd85)]('click',()=>_0x321f14(_0x1158da['id'])),_0x4376d8(_0x486308,()=>deleteMemo(_0x1158da['id'])),_0x25bddd[_0x3ce268(0x1079)](_0x486308);});}async function _0x1cf6d2(_0xa27b59=null){const _0xfbced3=_0x204348;_0x4a763b=null;const _0xcfe7c=await _0x335e57(_0xfbced3(0xf1e),'请输入标题');if(_0xcfe7c===null||!_0xcfe7c[_0xfbced3(0x2aa)]())return;const _0x548e38=await _0x335e57(_0xfbced3(0xd95)+_0xcfe7c,'请输入备忘录内容','',_0xfbced3(0xb43));_0x548e38!==null&&(await _0x5f2f92({'title':_0xcfe7c['trim'](),'content':_0x548e38}),_0x3d0170(_0xfbced3(0x1262)));}async function _0x5f2f92(_0x5f5ddb){const _0x1ce146=_0x204348,_0x244849=_0x42f206[_0x1ce146(0x954)][_0xa42f18];if(!_0x244849['memos'])_0x244849[_0x1ce146(0x356)]=[];_0x244849[_0x1ce146(0x356)][_0x1ce146(0x129e)]({'id':Date['now'](),'title':_0x5f5ddb[_0x1ce146(0x316)],'content':_0x5f5ddb[_0x1ce146(0x1316)]}),await _0x17d534[_0x1ce146(0x954)][_0x1ce146(0xf3f)](_0x244849),_0x33e838();}async function _0x5f2f92(_0x52cc9e){const _0x12e0fd=_0x204348,_0x387b00=_0x42f206[_0x12e0fd(0x954)][_0xa42f18];if(!_0x387b00['memos'])_0x387b00[_0x12e0fd(0x356)]=[];if(_0x4a763b){const _0x48449d=_0x387b00[_0x12e0fd(0x356)][_0x12e0fd(0xb07)](_0x119279=>_0x119279['id']===_0x4a763b);if(_0x48449d)_0x48449d[_0x12e0fd(0x1316)]=_0x52cc9e;}else _0x387b00[_0x12e0fd(0x356)]['push']({'id':Date[_0x12e0fd(0x606)](),'content':_0x52cc9e});await _0x17d534[_0x12e0fd(0x954)][_0x12e0fd(0xf3f)](_0x387b00),_0x33e838(),_0x4a763b=null;}async function _0x1c6cd7(){const _0x1774f5=_0x204348;if(!_0xa42f18)return;const _0xb65e1f=_0x42f206[_0x1774f5(0x954)][_0xa42f18];if(!_0xb65e1f)return;await _0x34fce8('请稍候...',_0x1774f5(0x1126)+_0xb65e1f[_0x1774f5(0x132a)]+'”翻开TA的日记本...');const {proxyUrl:_0x4de230,apiKey:_0x4d18c8,model:_0x3198f3}=_0x42f206['apiConfig'];if(!_0x4de230||!_0x4d18c8||!_0x3198f3){alert('请先在API设置中配置好API信息。');return;}const _0x3fe792=_0x42f206[_0x1774f5(0x551)]['nickname']===_0x1774f5(0x852)||!_0x42f206[_0x1774f5(0x551)]['nickname']?'用户':_0x42f206['qzoneSettings'][_0x1774f5(0x308)],_0x3f919b=_0xb65e1f[_0x1774f5(0x94a)]&&_0xb65e1f[_0x1774f5(0x94a)]['length']>0x0?_0xb65e1f[_0x1774f5(0x94a)][_0x1774f5(0xbf6)](_0x4b4e35=>'-\x20(记录于\x20'+_0x1f0c92(_0x4b4e35[_0x1774f5(0xf16)])+')\x20'+_0x4b4e35[_0x1774f5(0x1316)])['join']('\x0a'):'无',_0xdd1554=_0xb65e1f[_0x1774f5(0xda2)][_0x1774f5(0x125c)]||0xa,_0x49850a=_0xb65e1f[_0x1774f5(0x1d5)][_0x1774f5(0x5b0)](-_0xdd1554)[_0x1774f5(0xbf6)](_0x555f8d=>(_0x555f8d[_0x1774f5(0xaeb)]===_0x1774f5(0xf86)?_0x3fe792:_0xb65e1f[_0x1774f5(0x132a)])+':\x20'+String(_0x555f8d[_0x1774f5(0x1316)])[_0x1774f5(0xa6d)](0x0,0x1e)+_0x1774f5(0x10a0))[_0x1774f5(0x56c)]('\x0a'),_0x2028e8=(_0xb65e1f[_0x1774f5(0xda2)][_0x1774f5(0x315)]||[])['map'](_0x526325=>_0x42f206['worldBooks'][_0x1774f5(0xb07)](_0x2ef7c7=>_0x2ef7c7['id']===_0x526325))[_0x1774f5(0xaf1)](Boolean)[_0x1774f5(0xbf6)](_0x4d3f5e=>_0x1774f5(0x221)+_0x4d3f5e[_0x1774f5(0x132a)]+_0x1774f5(0x10dc)+_0x4d3f5e[_0x1774f5(0x1316)]['filter'](_0x134afe=>_0x134afe[_0x1774f5(0x12fb)])[_0x1774f5(0xbf6)](_0xcdd3f6=>'-\x20'+_0xcdd3f6[_0x1774f5(0x1316)])[_0x1774f5(0x56c)]('\x0a'))[_0x1774f5(0x56c)](''),_0x3dfc7c=_0x492011(_0xb65e1f,0x3,'hours'),_0x509782=_0x492011(_0xb65e1f,0x6,_0x1774f5(0xd92)),_0xa06953=_0x492011(_0xb65e1f,0x9,_0x1774f5(0xd92)),_0x278f6e=_0x492011(_0xb65e1f,0x1,_0x1774f5(0x534)),_0x20f510=_0x492011(_0xb65e1f,0x3,_0x1774f5(0x534)),_0x40755f=_0x492011(_0xb65e1f,0x7,_0x1774f5(0x534));let _0x30c7fc='';if(_0x3dfc7c||_0x509782||_0xa06953||_0x278f6e||_0x20f510||_0x40755f){_0x30c7fc+=_0x1774f5(0x592);if(_0x3dfc7c)_0x30c7fc+=_0x3dfc7c;if(_0x509782)_0x30c7fc+=_0x509782;if(_0xa06953)_0x30c7fc+=_0xa06953;if(_0x3dfc7c||_0x509782||_0xa06953)_0x30c7fc+='\x0a';if(_0x278f6e)_0x30c7fc+=_0x278f6e;if(_0x20f510)_0x30c7fc+=_0x20f510;if(_0x40755f)_0x30c7fc+=_0x40755f;}const _0x5730fa=_0xb65e1f[_0x1774f5(0xda2)][_0x1774f5(0x65f)]||_0x1774f5(0x213),_0x32fe37=_0x1774f5(0x628)+_0xb65e1f['name']+_0x1774f5(0x917)+new Date()['toLocaleDateString'](_0x1774f5(0xaa2))+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“'+_0x3fe792+_0x1774f5(0x900)+_0xb65e1f[_0x1774f5(0xda2)][_0x1774f5(0x31d)]+_0x1774f5(0x1ba)+_0x5730fa+_0x1774f5(0xf93)+_0x3f919b+'\x0a'+_0x2028e8+'\x0a'+_0x30c7fc+_0x1774f5(0xa46)+_0x3fe792+_0x1774f5(0xc63)+_0x49850a+_0x1774f5(0x1129);try{const _0x1700c9=[{'role':'user','content':_0x1774f5(0x10a4)}];let _0x24cbe3=_0x4de230[_0x1774f5(0xd8d)](_0x1774f5(0xfe3)),_0x22f1f5=_0x5d73db(_0x3198f3,_0x4d18c8,_0x32fe37,_0x1700c9);const _0x50016b=_0x24cbe3?await fetch(_0x22f1f5[_0x1774f5(0x1377)],_0x22f1f5[_0x1774f5(0x76b)]):await fetch(_0x4de230+_0x1774f5(0xd7),{'method':_0x1774f5(0x1312),'headers':{'Content-Type':_0x1774f5(0xa0e),'Authorization':_0x1774f5(0x8aa)+_0x4d18c8},'body':JSON[_0x1774f5(0xc04)]({'model':_0x3198f3,'messages':[{'role':_0x1774f5(0x1370),'content':_0x32fe37},..._0x1700c9],'temperature':_0x42f206[_0x1774f5(0xf0)][_0x1774f5(0xfdf)]||0.95})});if(!_0x50016b['ok'])throw new Error(_0x1774f5(0x676)+_0x50016b['statusText']);const _0x2cc1e2=await _0x50016b[_0x1774f5(0xaef)](),_0x297597=getGeminiResponseText(_0x2cc1e2),_0x2add88=_0x297597['match'](/(\[[\s\S]*\])/);if(!_0x2add88||!_0x2add88[0x0])throw new Error(_0x1774f5(0x42f)+_0x297597);const _0x3a129b=_0x2add88[0x0];let _0x311cf1;try{_0x311cf1=JSON[_0x1774f5(0x44c)](_0x3a129b);}catch(_0x460db8){throw new Error(_0x1774f5(0xde0)+_0x460db8[_0x1774f5(0x7aa)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x297597);}_0xb65e1f[_0x1774f5(0x546)]=_0x311cf1['map'](_0x2fb52f=>({'id':Date[_0x1774f5(0x606)]()+Math[_0x1774f5(0x23a)](),'title':_0x2fb52f['title'],'content':_0x2fb52f[_0x1774f5(0x1316)],'timestamp':Date[_0x1774f5(0x606)]()})),await _0x17d534[_0x1774f5(0x954)]['put'](_0xb65e1f),await _0xfeaded();}catch(_0x3ac66b){console[_0x1774f5(0xb61)](_0x1774f5(0x123a),_0x3ac66b),await _0x34fce8(_0x1774f5(0x47b),_0x1774f5(0xbad)+_0x3ac66b[_0x1774f5(0x7aa)]);}}async function _0x1114c5(){const _0xbddf3=_0x204348;if(!_0xa42f18)return;const _0x2dad8e=_0x42f206[_0xbddf3(0x954)][_0xa42f18];if(!_0x2dad8e)return;await _0x34fce8(_0xbddf3(0x12b9),'正在请求“'+_0x2dad8e['name']+_0xbddf3(0xbbf));const {proxyUrl:_0x16cf21,apiKey:_0x142c52,model:_0x4d7dc9}=_0x42f206[_0xbddf3(0x5cb)];if(!_0x16cf21||!_0x142c52||!_0x4d7dc9)return;const _0x41ec36=_0x42f206[_0xbddf3(0x551)][_0xbddf3(0x308)]==='{{user}}'||!_0x42f206[_0xbddf3(0x551)][_0xbddf3(0x308)]?'用户':_0x42f206[_0xbddf3(0x551)]['nickname'],_0x884d47=_0x2dad8e['longTermMemory']&&_0x2dad8e['longTermMemory'][_0xbddf3(0x131d)]>0x0?_0x2dad8e[_0xbddf3(0x94a)][_0xbddf3(0xbf6)](_0x21cd64=>_0xbddf3(0x101)+_0x1f0c92(_0x21cd64['timestamp'])+')\x20'+_0x21cd64['content'])[_0xbddf3(0x56c)]('\x0a'):'无',_0x35893b=_0x2dad8e[_0xbddf3(0xda2)][_0xbddf3(0x125c)]||0xa,_0x3552bb=_0x2dad8e[_0xbddf3(0x1d5)][_0xbddf3(0x5b0)](-_0x35893b)[_0xbddf3(0xbf6)](_0x5188f7=>(_0x5188f7[_0xbddf3(0xaeb)]==='user'?_0x41ec36:_0x2dad8e[_0xbddf3(0x132a)])+':\x20'+String(_0x5188f7[_0xbddf3(0x1316)])[_0xbddf3(0xa6d)](0x0,0x1e)+_0xbddf3(0x10a0))[_0xbddf3(0x56c)]('\x0a'),_0x23b225=(_0x2dad8e[_0xbddf3(0xda2)][_0xbddf3(0x315)]||[])['map'](_0x12d5bd=>_0x42f206[_0xbddf3(0xab7)][_0xbddf3(0xb07)](_0x555b87=>_0x555b87['id']===_0x12d5bd))[_0xbddf3(0xaf1)](Boolean)['map'](_0x1ca9a4=>_0xbddf3(0x221)+_0x1ca9a4[_0xbddf3(0x132a)]+'》设定:\x0a'+_0x1ca9a4['content']['filter'](_0x477f45=>_0x477f45['enabled'])['map'](_0x55000e=>'-\x20'+_0x55000e['content'])[_0xbddf3(0x56c)]('\x0a'))[_0xbddf3(0x56c)](''),_0x5c8abe=_0xbddf3(0xad1)+_0x2dad8e['name']+'”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**'+new Date()[_0xbddf3(0x1423)](_0xbddf3(0xaa2))+_0xbddf3(0x1387)+_0x2dad8e[_0xbddf3(0xda2)]['aiPersona']+_0xbddf3(0xf93)+_0x884d47+'\x0a'+_0x23b225+_0xbddf3(0x112f)+_0x41ec36+_0xbddf3(0xc63)+_0x3552bb+_0xbddf3(0x1462);try{const _0x59a0be=[{'role':_0xbddf3(0xf86),'content':_0xbddf3(0x6fe)}];let _0x25ca36=_0x16cf21[_0xbddf3(0xd8d)](_0xbddf3(0xfe3)),_0x2f85b4=_0x5d73db(_0x4d7dc9,_0x142c52,_0x5c8abe,_0x59a0be);const _0x32d91c=_0x25ca36?await fetch(_0x2f85b4['url'],_0x2f85b4[_0xbddf3(0x76b)]):await fetch(_0x16cf21+_0xbddf3(0xd7),{'method':_0xbddf3(0x1312),'headers':{'Content-Type':_0xbddf3(0xa0e),'Authorization':'Bearer\x20'+_0x142c52},'body':JSON[_0xbddf3(0xc04)]({'model':_0x4d7dc9,'messages':[{'role':_0xbddf3(0x1370),'content':_0x5c8abe},..._0x59a0be],'temperature':_0x42f206[_0xbddf3(0xf0)][_0xbddf3(0xfdf)]||0.95})});if(!_0x32d91c['ok'])throw new Error(_0xbddf3(0x676)+_0x32d91c[_0xbddf3(0xf0c)]);const _0x267294=await _0x32d91c['json'](),_0xdec84c=getGeminiResponseText(_0x267294),_0x27e4ac=_0xdec84c[_0xbddf3(0x41c)](/(\[[\s\S]*\])/);if(!_0x27e4ac||!_0x27e4ac[0x0])throw new Error(_0xbddf3(0x42f)+_0xdec84c);const _0x337bdf=_0x27e4ac[0x0];let _0x39b04b;try{_0x39b04b=JSON[_0xbddf3(0x44c)](_0x337bdf)[0x0];}catch(_0x5164a9){throw new Error(_0xbddf3(0xde0)+_0x5164a9[_0xbddf3(0x7aa)]+_0xbddf3(0x12c4)+_0xdec84c);}if(!_0x2dad8e[_0xbddf3(0x546)])_0x2dad8e[_0xbddf3(0x546)]=[];_0x2dad8e[_0xbddf3(0x546)][_0xbddf3(0x129e)]({'id':Date[_0xbddf3(0x606)](),'title':_0x39b04b[_0xbddf3(0x316)],'content':_0x39b04b[_0xbddf3(0x1316)],'timestamp':Date[_0xbddf3(0x606)]()}),await _0x17d534[_0xbddf3(0x954)][_0xbddf3(0xf3f)](_0x2dad8e),await _0xfeaded();}catch(_0x4c26cf){console[_0xbddf3(0xb61)](_0xbddf3(0x894),_0x4c26cf),await _0x34fce8(_0xbddf3(0x47b),_0xbddf3(0x19e)+_0x4c26cf[_0xbddf3(0x7aa)]);}}function _0xfeaded(){const _0xd353e6=_0x204348,_0x162c44=document[_0xd353e6(0x458)]('char-diary-list');_0x162c44[_0xd353e6(0x110d)]='';const _0x3747b1=_0x42f206[_0xd353e6(0x954)][_0xa42f18],_0x569b71=(_0x3747b1[_0xd353e6(0x546)]||[])[_0xd353e6(0x5b0)]()[_0xd353e6(0x115b)]();if(_0x569b71[_0xd353e6(0x131d)]===0x0){_0x162c44[_0xd353e6(0x110d)]=_0xd353e6(0x1240);return;}_0x569b71['forEach'](_0x58b441=>{const _0x2b8606=_0xd353e6,_0x374c1c=document[_0x2b8606(0xe7d)](_0x2b8606(0x1323));_0x374c1c[_0x2b8606(0x69b)]=_0x2b8606(0xf3d),_0x374c1c[_0x2b8606(0x110d)]=_0x2b8606(0x82e)+_0x58b441[_0x2b8606(0x316)]+_0x2b8606(0xcbc)+new Date(_0x58b441[_0x2b8606(0xf16)])[_0x2b8606(0x1423)]()+_0x2b8606(0xab2),_0x374c1c[_0x2b8606(0xd85)](_0x2b8606(0x1122),()=>_0x13d91d(_0x58b441['id'])),_0x4376d8(_0x374c1c,()=>_0x5cad49(_0x58b441['id'])),_0x162c44[_0x2b8606(0x1079)](_0x374c1c);});}async function _0x13d91d(_0x4f87fd){const _0x11a17e=_0x204348,_0x186f31=_0x42f206[_0x11a17e(0x954)][_0xa42f18];if(!_0x186f31||!_0x186f31[_0x11a17e(0x546)])return;const _0x3d5c6e=_0x186f31[_0x11a17e(0x546)][_0x11a17e(0xb07)](_0x584679=>_0x584679['id']===_0x4f87fd);if(_0x3d5c6e){_0x573734=_0x3d5c6e;const _0x35f5a6=document[_0x11a17e(0x458)](_0x11a17e(0x781)),_0x3349db=document[_0x11a17e(0x458)](_0x11a17e(0xbab)),_0x164b3e=document[_0x11a17e(0x458)](_0x11a17e(0xcb9));_0x35f5a6[_0x11a17e(0x1a2)]=_0x3d5c6e[_0x11a17e(0x316)];const _0x1eda35=_0x5c8590(_0x3d5c6e[_0x11a17e(0x1316)])[_0x11a17e(0x90b)]('\x0a')[_0x11a17e(0xbf6)](_0x9d8f08=>_0x11a17e(0x639)+(_0x9d8f08||_0x11a17e(0x392))+'</p>')[_0x11a17e(0x56c)]('');_0x3349db['innerHTML']=_0x1eda35;const _0xd3f98f=await _0x17d534[_0x11a17e(0xb78)]['where']({'type':_0x11a17e(0x523),'content.id':_0x4f87fd})[_0x11a17e(0xb9)]();_0x164b3e[_0x11a17e(0x11c2)][_0x11a17e(0x1270)](_0x11a17e(0xfe1),!!_0xd3f98f),_0x3d0170(_0x11a17e(0x271));}}async function _0x17767e(){const _0x355132=_0x204348;if(!_0x573734||!_0xa42f18)return;const _0x376e6c=_0x573734,_0x1c466=_0x42f206[_0x355132(0x954)][_0xa42f18],_0x265373=document[_0x355132(0x458)](_0x355132(0xcb9)),_0x2aaf0d=await _0x17d534['favorites'][_0x355132(0x13c6)]({'type':_0x355132(0x523),'content.id':_0x376e6c['id']})[_0x355132(0xb9)]();if(_0x2aaf0d)await _0x17d534[_0x355132(0xb78)][_0x355132(0x195)](_0x2aaf0d['id']),_0x265373[_0x355132(0x11c2)][_0x355132(0x1097)]('active'),await _0x34fce8(_0x355132(0x1336),_0x355132(0xe6b));else{const _0x1a1e28={'type':'char_diary','content':{'id':_0x376e6c['id'],'title':_0x376e6c['title'],'content':_0x376e6c[_0x355132(0x1316)],'timestamp':_0x376e6c[_0x355132(0xf16)],'characterId':_0xa42f18,'characterName':_0x1c466['name']},'timestamp':Date[_0x355132(0x606)]()};await _0x17d534[_0x355132(0xb78)][_0x355132(0xa58)](_0x1a1e28),_0x265373['classList']['add'](_0x355132(0xfe1)),await _0x34fce8('操作成功',_0x355132(0xf3a));}}async function _0x392bc1(){const _0x4f3d36=_0x204348;if(!_0x195baa||!_0xa42f18)return;const _0x539e88=_0x195baa,_0x3826e2=_0x42f206[_0x4f3d36(0x954)][_0xa42f18],_0xc300f6=document[_0x4f3d36(0x458)]('favorite-memo-btn'),_0x3b03d1=await _0x17d534[_0x4f3d36(0xb78)][_0x4f3d36(0x13c6)]({'type':_0x4f3d36(0x49f),'content.id':_0x539e88['id']})[_0x4f3d36(0xb9)]();if(_0x3b03d1)await _0x17d534[_0x4f3d36(0xb78)][_0x4f3d36(0x195)](_0x3b03d1['id']),_0xc300f6[_0x4f3d36(0x11c2)][_0x4f3d36(0x1097)]('active'),await _0x34fce8(_0x4f3d36(0x1336),_0x4f3d36(0xe6b));else{const _0x159940={'type':_0x4f3d36(0x49f),'content':{'id':_0x539e88['id'],'title':_0x539e88['title'],'content':_0x539e88[_0x4f3d36(0x1316)],'timestamp':_0x539e88['timestamp'],'characterId':_0xa42f18,'characterName':_0x3826e2[_0x4f3d36(0x132a)]},'timestamp':Date['now']()};await _0x17d534[_0x4f3d36(0xb78)][_0x4f3d36(0xa58)](_0x159940),_0xc300f6[_0x4f3d36(0x11c2)]['add'](_0x4f3d36(0xfe1)),await _0x34fce8('操作成功',_0x4f3d36(0xf3a));}}async function _0x5cad49(_0x5173a3){const _0x1664f2=_0x204348,_0x5808cd=await _0x2532b9(_0x1664f2(0x292),_0x1664f2(0x857),{'confirmButtonClass':_0x1664f2(0x4d3)});if(_0x5808cd){const _0x333e99=_0x42f206[_0x1664f2(0x954)][_0xa42f18];_0x333e99['diary']=_0x333e99['diary'][_0x1664f2(0xaf1)](_0x105127=>_0x105127['id']!==_0x5173a3),await _0x17d534[_0x1664f2(0x954)][_0x1664f2(0xf3f)](_0x333e99),_0xfeaded();}}async function _0x57fcb3(){const _0x370e15=_0x204348,_0x20e752=document[_0x370e15(0x458)]('char-chat-list');_0x20e752[_0x370e15(0x110d)]='';const _0x175fbc=_0x42f206[_0x370e15(0x954)][_0xa42f18];if(!_0x175fbc)return;const _0x594993=_0x175fbc['settings'][_0x370e15(0xc7d)]||(_0x42f206[_0x370e15(0x551)][_0x370e15(0x308)]||'我'),_0x51f200=_0x175fbc[_0x370e15(0x1d5)][_0x370e15(0xaf1)](_0x4e39b2=>!_0x4e39b2[_0x370e15(0x7a0)])[_0x370e15(0x5b0)](-0x1)[0x0]||{'content':_0x370e15(0x10a0)};let _0x2c7d75='...';if(_0x51f200){if(typeof _0x51f200['content']==='string')_0x2c7d75=_0x51f200['content'];else{if(Array[_0x370e15(0x971)](_0x51f200['content'])&&_0x51f200[_0x370e15(0x1316)][0x0]?.['type']===_0x370e15(0x1072))_0x2c7d75='[图片]';else{if(_0x51f200[_0x370e15(0x259)]){const _0x262f4a={'voice_message':'[语音]','transfer':_0x370e15(0xbe5),'ai_image':_0x370e15(0xf72)};_0x2c7d75=_0x262f4a[_0x51f200[_0x370e15(0x259)]]||'['+_0x51f200[_0x370e15(0x259)]+']';}}}}const _0xd564db=_0x175fbc[_0x370e15(0xda2)]['myAvatar']||_0x4fd084,_0x1f7fd4=_0x175fbc['settings'][_0x370e15(0x66f)]||'';let _0x2916c0;_0x1f7fd4?_0x2916c0=_0x370e15(0xc06)+_0xd564db+'\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22'+_0x1f7fd4+_0x370e15(0x73e):_0x2916c0=_0x370e15(0x290)+_0xd564db+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>';const _0x45ad6f=document[_0x370e15(0xe7d)](_0x370e15(0x1323));_0x45ad6f['className']=_0x370e15(0xeee),_0x45ad6f[_0x370e15(0x1f4)][_0x370e15(0x10a9)]='-1',_0x45ad6f[_0x370e15(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2916c0+_0x370e15(0xdfa)+_0x594993+_0x370e15(0x325)+String(_0x2c7d75)[_0x370e15(0xa6d)](0x0,0x14)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x20e752[_0x370e15(0x1079)](_0x45ad6f);const _0x4b59af=await _0x17d534[_0x370e15(0x996)]['toArray'](),_0x433a2a=new Map(_0x4b59af[_0x370e15(0xbf6)](_0x2ffff5=>[_0x2ffff5[_0x370e15(0x132a)],_0x2ffff5])),_0x4b79b6=_0x175fbc[_0x370e15(0x9b0)]||[];if(_0x4b79b6[_0x370e15(0x131d)]===0x0&&!_0x45ad6f){_0x20e752[_0x370e15(0x110d)]=_0x370e15(0xde1);return;}_0x4b79b6[_0x370e15(0x12c2)]((_0x4f2589,_0x20c457)=>{const _0x193dc5=_0x370e15;if(_0x4f2589[_0x193dc5(0x259)]===_0x193dc5(0x3d3))return;const _0x54dc4d=document[_0x193dc5(0xe7d)](_0x193dc5(0x1323));_0x54dc4d[_0x193dc5(0x69b)]=_0x193dc5(0xeee),_0x54dc4d[_0x193dc5(0x1f4)]['conversationIndex']=_0x20c457;let _0x1857ea,_0xf5df28,_0x4ee3bf;if(_0x4f2589[_0x193dc5(0x259)]===_0x193dc5(0x1192)){_0x4ee3bf=_0x4f2589[_0x193dc5(0x12b3)]+_0x193dc5(0xcc4),_0x1857ea=_0x4f2589['messages']['slice'](-0x1)[0x0]||{'content':_0x193dc5(0x10a0)};const _0x578bd2=_0x193dc5(0x52b)+_0x4f2589[_0x193dc5(0x12b3)]+'\x27',_0x5d12b0=_0x42f206['globalSettings'][_0x193dc5(0xf0e)]?_0x193dc5(0x94c)+encodeURIComponent(_0x578bd2):_0x5448a9;_0xf5df28=_0x193dc5(0x642)+_0x5d12b0+_0x193dc5(0x599);}else{_0x4ee3bf=_0x4f2589[_0x193dc5(0x475)][_0x193dc5(0x132a)],_0x1857ea=_0x4f2589['messages'][_0x193dc5(0x5b0)](-0x1)[0x0]||{'content':_0x193dc5(0x10a0)};const _0x2e591c=_0x433a2a[_0x193dc5(0x36d)](_0x4ee3bf);let _0x2bc1fc=_0x2e591c&&_0x2e591c[_0x193dc5(0x5c6)]?_0x2e591c[_0x193dc5(0x5c6)]:_0x42f206[_0x193dc5(0xf0)][_0x193dc5(0xf0e)]?_0x193dc5(0x94c)+encodeURIComponent(_0x4f2589[_0x193dc5(0x475)][_0x193dc5(0x1238)]||_0x193dc5(0xd1f)):_0x482806;_0xf5df28=_0x193dc5(0x642)+_0x2bc1fc+_0x193dc5(0x599);}let _0x3f56e0=_0x193dc5(0x10a0);_0x1857ea&&_0x1857ea[_0x193dc5(0x1316)]&&(_0x3f56e0=_0x1857ea[_0x193dc5(0x1316)]),_0x54dc4d['innerHTML']=_0x193dc5(0x524)+_0xf5df28+_0x193dc5(0xb94)+_0x4ee3bf+_0x193dc5(0x7e1)+String(_0x3f56e0)['substring'](0x0,0x14)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x20e752[_0x193dc5(0x1079)](_0x54dc4d);});}async function _0x56b5c0(){const _0x413021=_0x204348;if(!_0xa42f18)return;const _0x3ba00f=_0x42f206['chats'][_0xa42f18];if(!_0x3ba00f)return;await _0x34fce8('请稍候...',_0x413021(0x1343)+_0x3ba00f['name']+_0x413021(0xc45));const {proxyUrl:_0x3b3904,apiKey:_0x517a33,model:_0x173d19}=_0x42f206[_0x413021(0x5cb)];if(!_0x3b3904||!_0x517a33||!_0x173d19){alert(_0x413021(0x3d9));return;}const _0x9f434=await _0x17d534[_0x413021(0x996)][_0x413021(0x511)](),_0x4342e8=_0x9f434[_0x413021(0xaf1)](_0x1a5a57=>_0x1a5a57[_0x413021(0x1114)]&&_0x1a5a57[_0x413021(0x1114)]['includes'](_0xa42f18));let _0x374ead=_0x413021(0xa22);_0x4342e8[_0x413021(0x131d)]>0x0?(_0x374ead+=_0x413021(0x46b),_0x4342e8[_0x413021(0x12c2)](_0x13c5ee=>{const _0x36aea4=_0x413021;_0x374ead+=_0x36aea4(0xa4b)+_0x13c5ee[_0x36aea4(0x132a)]+_0x36aea4(0xc7c)+_0x13c5ee[_0x36aea4(0x124d)]+'\x0a';})):_0x374ead+=_0x413021(0x1296);const _0x2a1780=_0x42f206[_0x413021(0x551)][_0x413021(0x308)]===_0x413021(0x852)||!_0x42f206[_0x413021(0x551)]['nickname']?'用户':_0x42f206['qzoneSettings'][_0x413021(0x308)],_0x42085e=_0x3ba00f['settings'][_0x413021(0xc7d)]||_0x2a1780,_0x315b37=_0x3ba00f['longTermMemory']&&_0x3ba00f[_0x413021(0x94a)][_0x413021(0x131d)]>0x0?_0x3ba00f['longTermMemory'][_0x413021(0xbf6)](_0x379dc9=>'-\x20(记录于\x20'+_0x1f0c92(_0x379dc9['timestamp'])+')\x20'+_0x379dc9['content'])[_0x413021(0x56c)]('\x0a'):'无',_0x5465c6=_0x3ba00f[_0x413021(0xda2)][_0x413021(0x125c)]||0xa,_0x1cbf8d=_0x3ba00f[_0x413021(0x1d5)][_0x413021(0x5b0)](-_0x5465c6)['map'](_0x249498=>(_0x249498[_0x413021(0xaeb)]===_0x413021(0xf86)?_0x42085e:_0x3ba00f[_0x413021(0x132a)])+':\x20'+String(_0x249498[_0x413021(0x1316)])[_0x413021(0xa6d)](0x0,0x1e)+'...')['join']('\x0a'),_0x381424=(_0x3ba00f[_0x413021(0xda2)][_0x413021(0x315)]||[])[_0x413021(0xbf6)](_0x2c84c9=>_0x42f206[_0x413021(0xab7)][_0x413021(0xb07)](_0x26cedc=>_0x26cedc['id']===_0x2c84c9))[_0x413021(0xaf1)](Boolean)[_0x413021(0xbf6)](_0xb1ae57=>_0x413021(0x221)+_0xb1ae57[_0x413021(0x132a)]+_0x413021(0xab8)+_0xb1ae57[_0x413021(0x1316)][_0x413021(0xaf1)](_0x1438a1=>_0x1438a1['enabled'])['map'](_0x3c6e47=>'-\x20'+_0x3c6e47[_0x413021(0x1316)])[_0x413021(0x56c)]('\x0a'))[_0x413021(0x56c)](''),_0x5c503b=_0x3ba00f['originalName']||_0x3ba00f[_0x413021(0x132a)],_0x1db868=_0x386294(_0x3ba00f),_0x5eed8b=_0x413021(0x11b7)+_0x3ba00f[_0x413021(0x132a)]+_0x413021(0x8e5)+_0x5c503b+'\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22'+_0x5c503b+_0x413021(0x4a7)+_0x5c503b+_0x413021(0x945)+_0x3ba00f[_0x413021(0xda2)]['aiPersona']+_0x413021(0x613)+_0x315b37+_0x413021(0x898)+_0x381424+_0x413021(0x6ef)+_0x1cbf8d+'\x0a'+_0x374ead+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x1db868+_0x413021(0x144);try{const _0x8c15d4=[{'role':_0x413021(0xf86),'content':_0x413021(0x4ce)}];let _0x4f58cc=_0x3b3904[_0x413021(0xd8d)](_0x413021(0xfe3)),_0x17c179=_0x5d73db(_0x173d19,_0x517a33,_0x5eed8b,_0x8c15d4);const _0x1b5498=_0x4f58cc?await fetch(_0x17c179[_0x413021(0x1377)],_0x17c179[_0x413021(0x76b)]):await fetch(_0x3b3904+_0x413021(0xd7),{'method':_0x413021(0x1312),'headers':{'Content-Type':_0x413021(0xa0e),'Authorization':_0x413021(0x8aa)+_0x517a33},'body':JSON['stringify']({'model':_0x173d19,'messages':[{'role':_0x413021(0x1370),'content':_0x5eed8b},..._0x8c15d4],'temperature':_0x42f206[_0x413021(0xf0)]['apiTemperature']||0.9})});if(!_0x1b5498['ok'])throw new Error('API\x20错误:\x20'+_0x1b5498[_0x413021(0xf0c)]);const _0x5d7f3e=await _0x1b5498[_0x413021(0xaef)](),_0x215c7a=getGeminiResponseText(_0x5d7f3e),_0x5050ea=_0x215c7a[_0x413021(0x41c)](/(\[[\s\S]*\])/);if(!_0x5050ea||!_0x5050ea[0x0])throw new Error(_0x413021(0x42f)+_0x215c7a);const _0x1d5e2a=_0x5050ea[0x0];let _0x21dba9;try{_0x21dba9=JSON[_0x413021(0x44c)](_0x1d5e2a);}catch(_0x23bb46){throw new Error(_0x413021(0xde0)+_0x23bb46['message']+_0x413021(0x12c4)+_0x215c7a);}_0x3ba00f[_0x413021(0x9b0)]=_0x21dba9,await _0x17d534['chats'][_0x413021(0xf3f)](_0x3ba00f),await _0x57fcb3();const _0x2052c4={'role':_0x413021(0x1370),'content':'[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','timestamp':Date[_0x413021(0x606)](),'isHidden':!![]};_0x3ba00f['history'][_0x413021(0x129e)](_0x2052c4),await _0x17d534[_0x413021(0x954)][_0x413021(0xf3f)](_0x3ba00f),_0x3ee822();}catch(_0x3a3ea5){console[_0x413021(0xb61)](_0x413021(0xb33),_0x3a3ea5),await _0x34fce8(_0x413021(0x47b),_0x413021(0x71b)+_0x3a3ea5['message']);}}async function _0x3e323a(){const _0x2663ca=_0x204348;if(!_0xa42f18)return;const _0x39c881=_0x42f206[_0x2663ca(0x954)][_0xa42f18];if(!_0x39c881)return;try{const {proxyUrl:_0x370947,apiKey:_0x5e21ad,model:_0x1db862}=_0x42f206[_0x2663ca(0x5cb)];if(!_0x370947||!_0x5e21ad||!_0x1db862)throw new Error(_0x2663ca(0xd5d));const _0x191916=parseInt(_0x39c881[_0x2663ca(0xda2)][_0x2663ca(0x125c)])||0xa,_0x36f4f7=_0x39c881[_0x2663ca(0x1d5)][_0x2663ca(0x5b0)](-_0x191916),_0x5ef8ff=_0x39c881[_0x2663ca(0xda2)][_0x2663ca(0xc7d)]||'我',_0x675406=_0x39c881['settings'][_0x2663ca(0x65f)]||'用户',_0x18d9a4='#\x20长期记忆\x20(必须严格遵守)\x0a'+(_0x39c881[_0x2663ca(0x94a)]&&_0x39c881[_0x2663ca(0x94a)][_0x2663ca(0x131d)]>0x0?_0x39c881[_0x2663ca(0x94a)][_0x2663ca(0xbf6)](_0x55a7c8=>'-\x20'+_0x55a7c8['content'])[_0x2663ca(0x56c)]('\x0a'):_0x2663ca(0xb86));let _0x4605d6='';if(_0x39c881[_0x2663ca(0xda2)]['linkedWorldBookIds']&&_0x39c881[_0x2663ca(0xda2)][_0x2663ca(0x315)][_0x2663ca(0x131d)]>0x0){const _0x3aef49=_0x39c881[_0x2663ca(0xda2)][_0x2663ca(0x315)][_0x2663ca(0xbf6)](_0x39c7c4=>{const _0x797cbe=_0x2663ca,_0x38f42f=_0x42f206[_0x797cbe(0xab7)]['find'](_0x47e972=>_0x47e972['id']===_0x39c7c4);if(!_0x38f42f||!Array[_0x797cbe(0x971)](_0x38f42f[_0x797cbe(0x1316)]))return'';const _0x1dd17d=_0x38f42f[_0x797cbe(0x1316)][_0x797cbe(0xaf1)](_0x1ba502=>_0x1ba502['enabled']!==![])[_0x797cbe(0xbf6)](_0x5018be=>_0x797cbe(0x111f)+(_0x5018be['comment']||_0x797cbe(0xfdc))+_0x797cbe(0x1440)+_0x5018be[_0x797cbe(0x1316)])[_0x797cbe(0x56c)]('');return _0x1dd17d?_0x797cbe(0x64a)+_0x38f42f[_0x797cbe(0x132a)]+'\x0a'+_0x1dd17d:'';})[_0x2663ca(0xaf1)](Boolean)[_0x2663ca(0x56c)]('');_0x3aef49&&(_0x4605d6='\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a'+_0x3aef49+'\x0a');}const _0x3b3409=_0x492011(_0x39c881,0x3,_0x2663ca(0xd92)),_0x359059=_0x492011(_0x39c881,0x6,_0x2663ca(0xd92)),_0x4c0668=_0x492011(_0x39c881,0x9,_0x2663ca(0xd92)),_0x44436b=_0x492011(_0x39c881,0x1,_0x2663ca(0x534)),_0x3b758c=_0x492011(_0x39c881,0x3,'days'),_0x116161=_0x492011(_0x39c881,0x7,_0x2663ca(0x534));let _0x33e263='';if(_0x3b3409||_0x359059||_0x4c0668||_0x44436b||_0x3b758c||_0x116161){_0x33e263+=_0x2663ca(0x592);if(_0x3b3409)_0x33e263+=_0x3b3409;if(_0x359059)_0x33e263+=_0x359059;if(_0x4c0668)_0x33e263+=_0x4c0668;if(_0x3b3409||_0x359059||_0x4c0668)_0x33e263+='\x0a';if(_0x44436b)_0x33e263+=_0x44436b;if(_0x3b758c)_0x33e263+=_0x3b758c;if(_0x116161)_0x33e263+=_0x116161;}const _0x5ea030=_0x18518f(_0x39c881),_0x28a54f=_0x2663ca(0x68a)+_0x39c881[_0x2663ca(0xa1)]+'”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20你的角色设定\x0a'+_0x39c881[_0x2663ca(0xda2)][_0x2663ca(0x31d)]+_0x2663ca(0x101d)+_0x5ea030+_0x2663ca(0xdf7)+_0x675406+'\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22'+_0x39c881['originalName']+'\x22\x0a-\x20**用户的备注**:\x20\x22'+_0x5ef8ff+'\x22\x0a'+_0x4605d6+'\x0a'+_0x18d9a4+'\x0a'+_0x33e263+'\x20\x0a-\x20**你们最后的对话**:\x0a'+_0x36f4f7[_0x2663ca(0xbf6)](_0x3542ee=>(_0x3542ee['role']===_0x2663ca(0xf86)?_0x5ef8ff:_0x39c881['name'])+':\x20'+String(_0x3542ee[_0x2663ca(0x1316)]))[_0x2663ca(0x56c)]('\x0a')+_0x2663ca(0x1446),_0x2f2fc4=_0x36f4f7[_0x2663ca(0xbf6)](_0x579ce4=>({'role':_0x579ce4[_0x2663ca(0xaeb)],'content':(_0x579ce4[_0x2663ca(0xaeb)]==='user'?_0x5ef8ff:_0x39c881[_0x2663ca(0x132a)])+':\x20'+String(_0x579ce4[_0x2663ca(0x1316)])}));let _0x28da37=_0x370947[_0x2663ca(0xd8d)](_0x2663ca(0xfe3)),_0x56f94d=_0x5d73db(_0x1db862,_0x5e21ad,_0x28a54f,_0x2f2fc4);const _0x238c05=_0x28da37?await fetch(_0x56f94d[_0x2663ca(0x1377)],_0x56f94d[_0x2663ca(0x76b)]):await fetch(_0x370947+'/v1/chat/completions',{'method':_0x2663ca(0x1312),'headers':{'Content-Type':_0x2663ca(0xa0e),'Authorization':'Bearer\x20'+_0x5e21ad},'body':JSON[_0x2663ca(0xc04)]({'model':_0x1db862,'messages':[{'role':'system','content':_0x28a54f},..._0x2f2fc4],'temperature':_0x42f206['globalSettings']['apiTemperature']||0.8})});if(!_0x238c05['ok'])throw new Error('API\x20请求失败:\x20'+(await _0x238c05[_0x2663ca(0xaef)]())['error']['message']);const _0x45f4dc=await _0x238c05['json'](),_0x55b2b1=getGeminiResponseText(_0x45f4dc),_0x163bd6=_0x418096(_0x55b2b1);if(!_0x163bd6||_0x163bd6[_0x2663ca(0x131d)]===0x0)throw new Error('AI返回了空内容。');let _0x2ec785=0x0,_0x3e50e9=Date[_0x2663ca(0x606)]();for(const _0x1be1fc of _0x163bd6){const _0x593ad6={'role':_0x2663ca(0xac3),'senderName':_0x39c881[_0x2663ca(0xa1)],'timestamp':_0x3e50e9++};let _0x1e7c7a=null;switch(_0x1be1fc[_0x2663ca(0x259)]){case _0x2663ca(0xdd5):_0x1e7c7a={..._0x593ad6,'content':String(_0x1be1fc[_0x2663ca(0x1316)]||_0x1be1fc[_0x2663ca(0x7aa)])};break;case _0x2663ca(0x869):if(_0x1be1fc[_0x2663ca(0x32e)]){const _0x5f50ac=_0x42f206[_0x2663ca(0x1294)][_0x2663ca(0xb07)](_0x36b2c2=>_0x36b2c2[_0x2663ca(0x132a)]===_0x1be1fc[_0x2663ca(0x32e)]);_0x5f50ac?_0x1e7c7a={..._0x593ad6,'type':_0x2663ca(0x869),'content':_0x5f50ac[_0x2663ca(0x1377)],'meaning':_0x5f50ac[_0x2663ca(0x132a)]}:(console[_0x2663ca(0x1b6)]('AI\x20(CPhone)\x20尝试使用一个不存在的表情:\x20\x22'+_0x1be1fc[_0x2663ca(0x32e)]+'\x22'),_0x1e7c7a={..._0x593ad6,'type':_0x2663ca(0xdd5),'content':_0x2663ca(0x21f)+_0x1be1fc[_0x2663ca(0x32e)]+']'});}else console[_0x2663ca(0x1b6)](_0x2663ca(0x78a),_0x1be1fc),_0x1e7c7a={..._0x593ad6,'type':_0x2663ca(0x869),'content':_0x1be1fc[_0x2663ca(0x1377)],'meaning':'未知表情'};break;}_0x1e7c7a&&(_0x39c881[_0x2663ca(0x1d5)][_0x2663ca(0x129e)](_0x1e7c7a),_0x2ec785++);}_0x2ec785>0x0&&(_0x39c881[_0x2663ca(0x12c9)]=(_0x39c881[_0x2663ca(0x12c9)]||0x0)+_0x2ec785),await _0x17d534['chats'][_0x2663ca(0xf3f)](_0x39c881),await _0x27be5e(),_0x2ec785>0x0&&_0x478393(_0x39c881['id'],_0x2663ca(0x897)+_0x2ec785+_0x2663ca(0xb53));}catch(_0x14896){console['error']('从CPhone推进真实对话失败:',_0x14896),await _0x34fce8(_0x2663ca(0x96d),_0x2663ca(0x1251)+_0x14896[_0x2663ca(0x7aa)]);}}async function _0x56e853(){const _0x11f95e=_0x204348;if(_0x239724||!_0xa42f18)return;_0x239724=!![];const _0x1f9ab9=document[_0x11f95e(0x458)](_0x11f95e(0x8ea)),_0xffc455=_0x42f206[_0x11f95e(0x954)][_0xa42f18];if(!_0xffc455){_0x239724=![];return;}_0x4c8ce6(_0x1f9ab9,_0x11f95e(0x76f));const _0x2119bd=_0x1f9ab9[_0x11f95e(0x94b)];await new Promise(_0x53fb62=>setTimeout(_0x53fb62,0x1f4));const _0x440478=_0xffc455[_0x11f95e(0x1d5)][_0x11f95e(0x131d)],_0x22804b=_0x42f206['globalSettings'][_0x11f95e(0x1365)]||0x32,_0x9c699d=_0x440478-_0x5b5e0c,_0x35b795=Math[_0x11f95e(0x538)](0x0,_0x9c699d-_0x22804b),_0x124ea5=_0xffc455[_0x11f95e(0x1d5)][_0x11f95e(0x5b0)](_0x35b795,_0x9c699d);_0x17adee(_0x1f9ab9);if(_0x124ea5[_0x11f95e(0x131d)]===0x0){_0x239724=![];return;}for(const _0x29f6c3 of _0x124ea5['reverse']()){const _0x37cc57={..._0x29f6c3,'role':_0x29f6c3[_0x11f95e(0xaeb)]==='user'?_0x11f95e(0xac3):_0x11f95e(0xf86)},_0x12784a={'id':_0x11f95e(0x29e),'isGroup':![],'name':_0xffc455[_0x11f95e(0x132a)],'settings':{..._0xffc455[_0x11f95e(0xda2)],'myAvatar':_0xffc455[_0x11f95e(0xda2)][_0x11f95e(0x9c7)],'myAvatarFrame':_0xffc455[_0x11f95e(0xda2)][_0x11f95e(0xce6)],'aiAvatar':_0xffc455['settings']['myAvatar'],'aiAvatarFrame':_0xffc455['settings']['myAvatarFrame']}},_0x33b1a3=await _0x4b8ea5(_0x37cc57,_0x12784a);_0x33b1a3&&_0x1f9ab9[_0x11f95e(0x13e2)](_0x33b1a3);}_0x5b5e0c+=_0x124ea5[_0x11f95e(0x131d)];const _0x5c2211=_0x1f9ab9[_0x11f95e(0x94b)];_0x1f9ab9['scrollTop']=_0x5c2211-_0x2119bd,_0x239724=![];}async function _0x5e2eeb(_0x2790fb){const _0x3ed54e=_0x204348,_0x1d6c5a=_0x42f206[_0x3ed54e(0x954)][_0xa42f18];if(!_0x1d6c5a)return;_0x3280ac=_0x2790fb===-0x1?'private_user':_0x1d6c5a[_0x3ed54e(0x9b0)][_0x2790fb]?.[_0x3ed54e(0x259)];const _0x46a571=document['getElementById'](_0x3ed54e(0x8ea));_0x46a571[_0x3ed54e(0x110d)]='',_0x46a571[_0x3ed54e(0x1f4)][_0x3ed54e(0xbdc)]=_0x1d6c5a[_0x3ed54e(0xda2)]['theme']||_0x3ed54e(0x1121);const _0x2966f6=document[_0x3ed54e(0x458)](_0x3ed54e(0xb3e))['classList'][_0x3ed54e(0x526)](_0x3ed54e(0x466));_0x46a571[_0x3ed54e(0x1104)][_0x3ed54e(0x11d7)]=_0x2966f6?_0x3ed54e(0x2e1):_0x3ed54e(0xe14);let _0x12d899,_0x1ea117=[];const _0x2c9a6f=await _0x17d534[_0x3ed54e(0x996)][_0x3ed54e(0x511)](),_0x3df6a2=new Map(_0x2c9a6f[_0x3ed54e(0xbf6)](_0x5f3558=>[_0x5f3558[_0x3ed54e(0x132a)],_0x5f3558]));if(_0x2790fb===-0x1){_0x3280ac=_0x3ed54e(0x3d3);const _0x116b49=document[_0x3ed54e(0x458)](_0x3ed54e(0x5e4)),_0x3f0432=document[_0x3ed54e(0x458)]('char-simulated-input');_0x46a571[_0x3ed54e(0x110d)]='',_0x116b49[_0x3ed54e(0x1a2)]=_0x1d6c5a[_0x3ed54e(0xda2)][_0x3ed54e(0xc7d)]||(_0x42f206[_0x3ed54e(0x551)][_0x3ed54e(0x308)]||'我'),_0x3f0432['placeholder']='与\x20'+(_0x1d6c5a[_0x3ed54e(0xda2)][_0x3ed54e(0xc7d)]||'我')+_0x3ed54e(0x117e),_0x5b5e0c=0x0,_0x239724=![];const _0x56b080=_0x1d6c5a[_0x3ed54e(0x1d5)],_0x189942=_0x42f206[_0x3ed54e(0xf0)][_0x3ed54e(0x1365)]||0x32,_0x51cec9=_0x56b080[_0x3ed54e(0x5b0)](-_0x189942);_0x12d899={'id':_0x3ed54e(0x29e),'isGroup':![],'name':_0x1d6c5a[_0x3ed54e(0x132a)],'settings':{..._0x1d6c5a[_0x3ed54e(0xda2)],'myAvatar':_0x1d6c5a[_0x3ed54e(0xda2)][_0x3ed54e(0x9c7)],'myAvatarFrame':_0x1d6c5a[_0x3ed54e(0xda2)][_0x3ed54e(0xce6)],'aiAvatar':_0x1d6c5a[_0x3ed54e(0xda2)][_0x3ed54e(0xa6)],'aiAvatarFrame':_0x1d6c5a[_0x3ed54e(0xda2)][_0x3ed54e(0x66f)]}},_0x1ea117=_0x51cec9[_0x3ed54e(0xbf6)](_0x8c6e57=>({..._0x8c6e57,'role':_0x8c6e57[_0x3ed54e(0xaeb)]===_0x3ed54e(0xf86)?_0x3ed54e(0xac3):_0x3ed54e(0xf86)})),_0x5b5e0c=_0x51cec9[_0x3ed54e(0x131d)];}else{const _0x2f93f5=_0x1d6c5a['simulatedConversations'][_0x2790fb];if(!_0x2f93f5)return;_0x3280ac=_0x2f93f5[_0x3ed54e(0x259)];const _0xffdef0=document[_0x3ed54e(0x458)](_0x3ed54e(0x5e4)),_0x544625=document[_0x3ed54e(0x458)](_0x3ed54e(0xd10));if(_0x2f93f5[_0x3ed54e(0x259)]===_0x3ed54e(0x1192))_0xffdef0[_0x3ed54e(0x1a2)]=_0x2f93f5[_0x3ed54e(0x12b3)]+'\x20('+(_0x2f93f5['participants']['length']+0x1)+')',_0x544625[_0x3ed54e(0x134b)]='在\x20'+_0x2f93f5['groupName']+_0x3ed54e(0x1127),_0x12d899={'id':_0x3ed54e(0x117a),'isGroup':!![],'name':_0x2f93f5['groupName'],'originalName':_0x1d6c5a[_0x3ed54e(0xa1)],'members':_0x2f93f5['participants'][_0x3ed54e(0xbf6)](_0x36e394=>{const _0x3a3740=_0x3ed54e,_0x367302=_0x3df6a2[_0x3a3740(0x36d)](_0x36e394[_0x3a3740(0x132a)]);let _0x24f29b=_0x367302&&_0x367302[_0x3a3740(0x5c6)]?_0x367302[_0x3a3740(0x5c6)]:_0x42f206[_0x3a3740(0xf0)][_0x3a3740(0xf0e)]?_0x3a3740(0x94c)+encodeURIComponent(_0x36e394[_0x3a3740(0x1238)]||_0x3a3740(0xd1f)):_0x482806;return{'originalName':_0x36e394[_0x3a3740(0x132a)],'groupNickname':_0x36e394[_0x3a3740(0x132a)],'avatar':_0x24f29b};}),'settings':{..._0x1d6c5a[_0x3ed54e(0xda2)],'myNickname':_0x1d6c5a[_0x3ed54e(0x132a)],'myAvatar':_0x1d6c5a[_0x3ed54e(0xda2)]['aiAvatar'],'myAvatarFrame':_0x1d6c5a[_0x3ed54e(0xda2)][_0x3ed54e(0xce6)]}};else{_0xffdef0[_0x3ed54e(0x1a2)]=_0x2f93f5[_0x3ed54e(0x475)]['name'],_0x544625[_0x3ed54e(0x134b)]='与\x20'+_0x2f93f5['participant'][_0x3ed54e(0x132a)]+_0x3ed54e(0x1000);const _0x4bbaea=_0x3df6a2[_0x3ed54e(0x36d)](_0x2f93f5['participant']['name']),_0x5afbc4=_0x4bbaea&&_0x4bbaea[_0x3ed54e(0x5c6)]?_0x4bbaea[_0x3ed54e(0x5c6)]:_0x42f206[_0x3ed54e(0xf0)][_0x3ed54e(0xf0e)]?_0x3ed54e(0x94c)+encodeURIComponent(_0x2f93f5['participant'][_0x3ed54e(0x1238)]||_0x3ed54e(0xd1f)):_0x482806;_0x12d899={'id':_0x3ed54e(0x1190),'isGroup':![],'name':_0x2f93f5[_0x3ed54e(0x475)][_0x3ed54e(0x132a)],'originalName':_0x1d6c5a[_0x3ed54e(0xa1)],'settings':{..._0x1d6c5a[_0x3ed54e(0xda2)],'myAvatar':_0x1d6c5a[_0x3ed54e(0xda2)][_0x3ed54e(0x9c7)],'myAvatarFrame':_0x1d6c5a[_0x3ed54e(0xda2)][_0x3ed54e(0xce6)],'aiAvatar':_0x5afbc4,'aiAvatarFrame':''}};}_0x1ea117=_0x2f93f5[_0x3ed54e(0x522)];}for(const _0x38deca of _0x1ea117){let _0x5dfa3b=_0x38deca['role'];if(_0x2790fb!==-0x1){const _0xbbfbfe=_0x38deca['sender']===(_0x1d6c5a['originalName']||_0x1d6c5a[_0x3ed54e(0x132a)]);_0x5dfa3b=_0xbbfbfe?'user':_0x3ed54e(0xac3);}const _0xe30e5f={'role':_0x5dfa3b,'senderName':_0x38deca['sender']||(_0x5dfa3b===_0x3ed54e(0xf86)?_0x12d899['settings']['myNickname']:_0x12d899[_0x3ed54e(0x132a)]),'timestamp':_0x38deca[_0x3ed54e(0xf16)]||Date[_0x3ed54e(0x606)]()+Math[_0x3ed54e(0x23a)]()};if(_0x38deca[_0x3ed54e(0x259)]===_0x3ed54e(0x869)&&_0x38deca[_0x3ed54e(0x32e)]){const _0x1f006a=_0x42f206[_0x3ed54e(0x1294)][_0x3ed54e(0xb07)](_0x50bf45=>_0x50bf45[_0x3ed54e(0x132a)]===_0x38deca[_0x3ed54e(0x32e)]);_0x1f006a?(_0xe30e5f['content']=_0x1f006a[_0x3ed54e(0x1377)],_0xe30e5f[_0x3ed54e(0x32e)]=_0x38deca[_0x3ed54e(0x32e)],_0xe30e5f['type']=_0x3ed54e(0x869)):(console[_0x3ed54e(0x1b6)](_0x3ed54e(0x952)+_0x38deca['meaning']+_0x3ed54e(0x889)),_0xe30e5f['content']=_0x3ed54e(0x21f)+_0x38deca[_0x3ed54e(0x32e)]+']',_0xe30e5f[_0x3ed54e(0x259)]=_0x3ed54e(0xdd5));}else _0xe30e5f['content']=_0x38deca[_0x3ed54e(0x1316)],_0xe30e5f[_0x3ed54e(0x259)]=_0x38deca[_0x3ed54e(0x259)]||_0x3ed54e(0xdd5);const _0x105b5a=await _0x4b8ea5(_0xe30e5f,_0x12d899);_0x105b5a&&_0x46a571['appendChild'](_0x105b5a);}_0x3d0170(_0x3ed54e(0x540)),setTimeout(()=>_0x46a571[_0x3ed54e(0x358)]=_0x46a571['scrollHeight'],0x0);}function _0x519e39(){const _0x1d1878=_0x204348;document[_0x1d1878(0x458)]('char-qq-transcript-modal')[_0x1d1878(0x11c2)][_0x1d1878(0x1097)](_0x1d1878(0x67d));}async function _0x104a23(){const _0x594464=_0x204348;if(!_0xa42f18)return;const _0xb3f9ff=_0x42f206[_0x594464(0x954)][_0xa42f18];if(!_0xb3f9ff){await _0x34fce8(_0x594464(0x96d),_0x594464(0xec3));return;}await _0x34fce8(_0x594464(0x12b9),_0x594464(0x1126)+_0xb3f9ff[_0x594464(0x132a)]+_0x594464(0xe0e));const {proxyUrl:_0x34acb8,apiKey:_0x3c51ff,model:_0x330c02}=_0x42f206[_0x594464(0x5cb)];if(!_0x34acb8||!_0x3c51ff||!_0x330c02){alert(_0x594464(0x3d9));return;}const _0xb57b18=_0x42f206[_0x594464(0x551)]['nickname']===_0x594464(0x852)||!_0x42f206['qzoneSettings']['nickname']?'用户':_0x42f206[_0x594464(0x551)][_0x594464(0x308)],_0x7f74c2=_0xb3f9ff[_0x594464(0x94a)]&&_0xb3f9ff[_0x594464(0x94a)][_0x594464(0x131d)]>0x0?_0xb3f9ff[_0x594464(0x94a)][_0x594464(0xbf6)](_0x485be4=>_0x594464(0x101)+_0x1f0c92(_0x485be4[_0x594464(0xf16)])+')\x20'+_0x485be4['content'])[_0x594464(0x56c)]('\x0a'):'无',_0x4b0f14=_0xb3f9ff[_0x594464(0xda2)][_0x594464(0x125c)]||0xa,_0x326195=_0xb3f9ff[_0x594464(0x1d5)]['slice'](-_0x4b0f14)[_0x594464(0xbf6)](_0xa21a47=>(_0xa21a47[_0x594464(0xaeb)]===_0x594464(0xf86)?_0xb57b18:_0xb3f9ff[_0x594464(0x132a)])+':\x20'+String(_0xa21a47[_0x594464(0x1316)])[_0x594464(0xa6d)](0x0,0x1e)+_0x594464(0x10a0))[_0x594464(0x56c)]('\x0a'),_0x2ee6b8=(_0xb3f9ff[_0x594464(0xda2)]['linkedWorldBookIds']||[])['map'](_0x4be4f1=>_0x42f206['worldBooks'][_0x594464(0xb07)](_0x2bed91=>_0x2bed91['id']===_0x4be4f1))[_0x594464(0xaf1)](Boolean)[_0x594464(0xbf6)](_0x313b7f=>_0x594464(0x221)+_0x313b7f[_0x594464(0x132a)]+_0x594464(0x10dc)+_0x313b7f[_0x594464(0x1316)][_0x594464(0xaf1)](_0x257829=>_0x257829[_0x594464(0x12fb)])[_0x594464(0xbf6)](_0x40bfc6=>'-\x20'+_0x40bfc6[_0x594464(0x1316)])[_0x594464(0x56c)]('\x0a'))[_0x594464(0x56c)](''),_0x5d0043=_0x492011(_0xb3f9ff,0x3,_0x594464(0xd92)),_0x5c373b=_0x492011(_0xb3f9ff,0x6,_0x594464(0xd92)),_0x5bf65d=_0x492011(_0xb3f9ff,0x9,_0x594464(0xd92)),_0x47230f=_0x492011(_0xb3f9ff,0x1,_0x594464(0x534)),_0x32f54b=_0x492011(_0xb3f9ff,0x3,_0x594464(0x534)),_0x10e185=_0x492011(_0xb3f9ff,0x7,_0x594464(0x534));let _0x1b5938='';if(_0x5d0043||_0x5c373b||_0x5bf65d||_0x47230f||_0x32f54b||_0x10e185){_0x1b5938+=_0x594464(0x592);if(_0x5d0043)_0x1b5938+=_0x5d0043;if(_0x5c373b)_0x1b5938+=_0x5c373b;if(_0x5bf65d)_0x1b5938+=_0x5bf65d;if(_0x5d0043||_0x5c373b||_0x5bf65d)_0x1b5938+='\x0a';if(_0x47230f)_0x1b5938+=_0x47230f;if(_0x32f54b)_0x1b5938+=_0x32f54b;if(_0x10e185)_0x1b5938+=_0x10e185;}const _0x2937e5=_0x594464(0x1e0)+_0xb3f9ff[_0x594464(0x132a)]+_0x594464(0xf53)+_0xb3f9ff[_0x594464(0xda2)][_0x594464(0x31d)]+'\x0a'+_0x7f74c2+'\x0a'+_0x2ee6b8+'\x0a'+_0x1b5938+_0x594464(0xa46)+_0xb57b18+_0x594464(0xc63)+_0x326195+'\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。';try{const _0x2e1aaf=[{'role':_0x594464(0xf86),'content':_0x594464(0x724)}];let _0x5d7fdc=_0x34acb8[_0x594464(0xd8d)]('generativelanguage'),_0x222254=_0x5d73db(_0x330c02,_0x3c51ff,_0x2937e5,_0x2e1aaf);const _0x24f1c6=_0x5d7fdc?await fetch(_0x222254[_0x594464(0x1377)],_0x222254[_0x594464(0x76b)]):await fetch(_0x34acb8+_0x594464(0xd7),{'method':_0x594464(0x1312),'headers':{'Content-Type':'application/json','Authorization':_0x594464(0x8aa)+_0x3c51ff},'body':JSON[_0x594464(0xc04)]({'model':_0x330c02,'messages':[{'role':_0x594464(0x1370),'content':_0x2937e5},..._0x2e1aaf],'temperature':_0x42f206[_0x594464(0xf0)][_0x594464(0xfdf)]||0.9})});if(!_0x24f1c6['ok'])throw new Error('API\x20错误:\x20'+_0x24f1c6['statusText']);const _0x5ddd9f=await _0x24f1c6[_0x594464(0xaef)](),_0x177b81=getGeminiResponseText(_0x5ddd9f),_0x18f064=_0x177b81['match'](/(\[[\s\S]*\])/);if(!_0x18f064||!_0x18f064[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x177b81);const _0x2b40e6=_0x18f064[0x0];let _0x3b5ad7;try{_0x3b5ad7=JSON[_0x594464(0x44c)](_0x2b40e6);}catch(_0x306b60){throw new Error(_0x594464(0xde0)+_0x306b60[_0x594464(0x7aa)]+_0x594464(0x12c4)+_0x177b81);}_0xb3f9ff[_0x594464(0x11d9)]=_0x3b5ad7,await _0x17d534[_0x594464(0x954)][_0x594464(0xf3f)](_0xb3f9ff),await _0x216409();}catch(_0x204895){console[_0x594464(0xb61)](_0x594464(0x5ec),_0x204895),await _0x34fce8(_0x594464(0x47b),_0x594464(0x12b5)+_0x204895[_0x594464(0x7aa)]);}}async function _0x216409(){const _0x520640=_0x204348,_0x28635c=document[_0x520640(0x458)](_0x520640(0x848));_0x28635c[_0x520640(0x110d)]='';if(!_0xa42f18)return;const _0x4d6352=_0x42f206[_0x520640(0x954)][_0xa42f18],_0x564c8a=_0x4d6352[_0x520640(0x11d9)]||[];if(_0x564c8a[_0x520640(0x131d)]===0x0){_0x28635c[_0x520640(0x110d)]=_0x520640(0x49c);return;}const _0x4bf96a=_0x520640(0x503);_0x564c8a[_0x520640(0x12c2)](_0x47bbda=>{const _0x2feb17=_0x520640,_0xfdf986=document[_0x2feb17(0xe7d)](_0x2feb17(0x1323));_0xfdf986[_0x2feb17(0x69b)]='char-photo-item',_0xfdf986[_0x2feb17(0x1f4)][_0x2feb17(0x4e9)]=_0x47bbda['description'],_0x28635c[_0x2feb17(0x1079)](_0xfdf986);if(_0x42f206[_0x2feb17(0xf0)][_0x2feb17(0xf0e)]){_0xfdf986[_0x2feb17(0x1104)][_0x2feb17(0x11d7)]=_0x2feb17(0xb8d);const _0x374f0b=/[^\x00-\x7F]/[_0x2feb17(0x9c0)](_0x47bbda[_0x2feb17(0xef)]),_0x5cc44a=_0x47bbda[_0x2feb17(0xef)]&&_0x47bbda['image_prompt'][_0x2feb17(0x2aa)]()&&!_0x374f0b,_0x24a3cf=_0x5cc44a?_0x47bbda[_0x2feb17(0xef)]:'a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting',_0x3958b8=_0x2feb17(0x94c)+encodeURIComponent(_0x24a3cf),_0x9b29c0=new Image();_0x9b29c0[_0x2feb17(0x11fa)]=function(){const _0x4963c7=_0x2feb17;_0xfdf986[_0x4963c7(0x1104)][_0x4963c7(0xf7)]=_0x4963c7(0xfa)+this[_0x4963c7(0x577)]+')';},_0x9b29c0['onerror']=function(){const _0xeb79c7=_0x2feb17;_0xfdf986[_0xeb79c7(0x1104)][_0xeb79c7(0xf7)]=_0xeb79c7(0xfa)+_0x4bf96a+')';},_0x9b29c0[_0x2feb17(0x577)]=_0x3958b8;}else{_0xfdf986['style']['backgroundColor']='#f0f2f5',_0xfdf986[_0x2feb17(0x1104)][_0x2feb17(0xded)]=_0x2feb17(0x10fa);const _0x22ec58=document[_0x2feb17(0xe7d)]('p');_0x22ec58[_0x2feb17(0x69b)]='char-photo-description',_0x22ec58[_0x2feb17(0x1a2)]=_0x47bbda[_0x2feb17(0x4e9)]||_0x2feb17(0xf52),_0xfdf986[_0x2feb17(0x1079)](_0x22ec58);}});}async function _0x5258ce(){const _0x379e0a=_0x204348;if(!_0xa42f18)return;const _0x45afd5=_0x42f206[_0x379e0a(0x954)][_0xa42f18];if(!_0x45afd5)return;await _0x34fce8('请稍候...',_0x379e0a(0xa35)+_0x45afd5['name']+_0x379e0a(0x1048));const {proxyUrl:_0x97600b,apiKey:_0x2e5005,model:_0x2d6d2e}=_0x42f206[_0x379e0a(0x5cb)];if(!_0x97600b||!_0x2e5005||!_0x2d6d2e){alert(_0x379e0a(0x12d5));return;}const _0x1b9b44=_0x42f206[_0x379e0a(0x551)][_0x379e0a(0x308)]===_0x379e0a(0x852)||!_0x42f206['qzoneSettings'][_0x379e0a(0x308)]?'用户':_0x42f206[_0x379e0a(0x551)][_0x379e0a(0x308)],_0x5119eb=_0x45afd5['longTermMemory']&&_0x45afd5[_0x379e0a(0x94a)][_0x379e0a(0x131d)]>0x0?_0x45afd5['longTermMemory'][_0x379e0a(0xbf6)](_0x481910=>_0x379e0a(0x101)+_0x1f0c92(_0x481910[_0x379e0a(0xf16)])+')\x20'+_0x481910[_0x379e0a(0x1316)])['join']('\x0a'):'无',_0x421341=_0x45afd5[_0x379e0a(0xda2)][_0x379e0a(0x125c)]||0xa,_0x5c2edf=_0x45afd5[_0x379e0a(0x1d5)][_0x379e0a(0x5b0)](-_0x421341)[_0x379e0a(0xbf6)](_0x4101cb=>(_0x4101cb[_0x379e0a(0xaeb)]===_0x379e0a(0xf86)?_0x1b9b44:_0x45afd5[_0x379e0a(0x132a)])+':\x20'+String(_0x4101cb[_0x379e0a(0x1316)])['substring'](0x0,0x1e)+_0x379e0a(0x10a0))[_0x379e0a(0x56c)]('\x0a'),_0x3d4d54=(_0x45afd5[_0x379e0a(0xda2)]['linkedWorldBookIds']||[])[_0x379e0a(0xbf6)](_0x44a5df=>_0x42f206[_0x379e0a(0xab7)]['find'](_0x420976=>_0x420976['id']===_0x44a5df))[_0x379e0a(0xaf1)](Boolean)[_0x379e0a(0xbf6)](_0x47404a=>'\x0a##\x20世界书《'+_0x47404a['name']+_0x379e0a(0x10dc)+_0x47404a[_0x379e0a(0x1316)][_0x379e0a(0xaf1)](_0x51dcba=>_0x51dcba['enabled'])['map'](_0x500d38=>'-\x20'+_0x500d38[_0x379e0a(0x1316)])['join']('\x0a'))['join'](''),_0x463509=_0x492011(_0x45afd5,0x3,_0x379e0a(0xd92)),_0x2b1263=_0x492011(_0x45afd5,0x6,_0x379e0a(0xd92)),_0x20b143=_0x492011(_0x45afd5,0x9,_0x379e0a(0xd92)),_0x6cce6b=_0x492011(_0x45afd5,0x1,_0x379e0a(0x534)),_0x4c4981=_0x492011(_0x45afd5,0x3,_0x379e0a(0x534)),_0x44dfaf=_0x492011(_0x45afd5,0x7,_0x379e0a(0x534));let _0x460857='';if(_0x463509||_0x2b1263||_0x20b143||_0x6cce6b||_0x4c4981||_0x44dfaf){_0x460857+=_0x379e0a(0x592);if(_0x463509)_0x460857+=_0x463509;if(_0x2b1263)_0x460857+=_0x2b1263;if(_0x20b143)_0x460857+=_0x20b143;if(_0x463509||_0x2b1263||_0x20b143)_0x460857+='\x0a';if(_0x6cce6b)_0x460857+=_0x6cce6b;if(_0x4c4981)_0x460857+=_0x4c4981;if(_0x44dfaf)_0x460857+=_0x44dfaf;}const _0x5b5de2=_0x45afd5[_0x379e0a(0xda2)][_0x379e0a(0x65f)]||_0x379e0a(0x213),_0x29748b=_0x379e0a(0x1e0)+_0x45afd5[_0x379e0a(0x132a)]+_0x379e0a(0x8fe)+_0x45afd5['settings'][_0x379e0a(0x31d)]+'\x0a-\x20**\x20你的聊天对象（用户）的人设**:'+_0x5b5de2+_0x379e0a(0xf93)+_0x5119eb+'\x0a'+_0x3d4d54+'\x0a'+_0x460857+'\x20\x0a-\x20**你最近和“'+_0x1b9b44+_0x379e0a(0xc63)+_0x5c2edf+_0x379e0a(0xcd2);try{const _0x2e12ac=[{'role':_0x379e0a(0xf86),'content':_0x379e0a(0x692)}];let _0x481f69=_0x97600b[_0x379e0a(0xd8d)](_0x379e0a(0xfe3)),_0x4950b6=_0x5d73db(_0x2d6d2e,_0x2e5005,_0x29748b,_0x2e12ac);const _0x32660a=_0x481f69?await fetch(_0x4950b6[_0x379e0a(0x1377)],_0x4950b6['data']):await fetch(_0x97600b+_0x379e0a(0xd7),{'method':_0x379e0a(0x1312),'headers':{'Content-Type':'application/json','Authorization':_0x379e0a(0x8aa)+_0x2e5005},'body':JSON[_0x379e0a(0xc04)]({'model':_0x2d6d2e,'messages':[{'role':_0x379e0a(0x1370),'content':_0x29748b},..._0x2e12ac],'temperature':_0x42f206[_0x379e0a(0xf0)][_0x379e0a(0xfdf)]||0.9})});if(!_0x32660a['ok'])throw new Error('API\x20错误:\x20'+_0x32660a[_0x379e0a(0xf0c)]);const _0xb65104=await _0x32660a[_0x379e0a(0xaef)](),_0x37695c=getGeminiResponseText(_0xb65104),_0x15b491=_0x37695c[_0x379e0a(0x41c)](/(\[[\s\S]*\])/);if(!_0x15b491||!_0x15b491[0x0])throw new Error(_0x379e0a(0x42f)+_0x37695c);const _0x9429f5=_0x15b491[0x0];let _0x291421;try{_0x291421=JSON[_0x379e0a(0x44c)](_0x9429f5);}catch(_0x21135){throw new Error(_0x379e0a(0xde0)+_0x21135[_0x379e0a(0x7aa)]+_0x379e0a(0x12c4)+_0x37695c);}_0x45afd5[_0x379e0a(0x83e)]=_0x291421,await _0x17d534['chats'][_0x379e0a(0xf3f)](_0x45afd5),await _0x586881();}catch(_0x374d84){console[_0x379e0a(0xb61)](_0x379e0a(0x8ad),_0x374d84),await _0x34fce8('生成失败','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x374d84[_0x379e0a(0x7aa)]);}}function _0x586881(){const _0x3fd5fe=_0x204348,_0x95e301=document[_0x3fd5fe(0x458)]('char-browser-history');_0x95e301[_0x3fd5fe(0x110d)]='';if(!_0xa42f18)return;const _0x3d48ef=_0x42f206[_0x3fd5fe(0x954)][_0xa42f18],_0x228f3d=_0x3d48ef[_0x3fd5fe(0x83e)]||[];if(_0x228f3d[_0x3fd5fe(0x131d)]===0x0){_0x95e301[_0x3fd5fe(0x110d)]=_0x3fd5fe(0x139a);return;}_0x228f3d[_0x3fd5fe(0x12c2)]((_0x38da19,_0x577e2a)=>{const _0x12bca0=_0x3fd5fe,_0x144d15=document['createElement'](_0x12bca0(0x1323));_0x144d15[_0x12bca0(0x69b)]=_0x12bca0(0x12d0),_0x144d15[_0x12bca0(0x110d)]=_0x12bca0(0xbfe)+_0x38da19[_0x12bca0(0x316)]+_0x12bca0(0x82c)+_0x38da19[_0x12bca0(0x1377)]+_0x12bca0(0x97e),_0x144d15[_0x12bca0(0xd85)]('click',()=>_0x564d79(_0x577e2a)),_0x95e301[_0x12bca0(0x1079)](_0x144d15);});}async function _0x564d79(_0x4bb99c){const _0x19356a=_0x204348,_0x3d9de5=_0x42f206['chats'][_0xa42f18],_0x168764=_0x3d9de5[_0x19356a(0x83e)][_0x4bb99c];if(!_0x168764)return;_0x25949e=_0x168764,_0x4d775d(_0x168764),_0x3d0170(_0x19356a(0x12fd));const _0x167124=document[_0x19356a(0x458)](_0x19356a(0x137e)),_0x2d6d9c=await _0x17d534[_0x19356a(0xb78)]['where']({'type':'char_browser_article','content.url':_0x168764[_0x19356a(0x1377)]})[_0x19356a(0xb9)]();_0x167124[_0x19356a(0x11c2)][_0x19356a(0x1270)]('active',!!_0x2d6d9c);}async function _0x476463(){const _0x2461a9=_0x204348;if(!_0x25949e||!_0xa42f18)return;const _0x30961b=_0x25949e,_0xac1853=_0x42f206['chats'][_0xa42f18],_0x4a604e=document[_0x2461a9(0x458)](_0x2461a9(0x137e)),_0x3621e5=await _0x17d534['favorites']['where']({'type':_0x2461a9(0xa38),'content.url':_0x30961b[_0x2461a9(0x1377)]})[_0x2461a9(0xb9)]();if(_0x3621e5)await _0x17d534[_0x2461a9(0xb78)]['delete'](_0x3621e5['id']),_0x4a604e[_0x2461a9(0x11c2)][_0x2461a9(0x1097)](_0x2461a9(0xfe1)),await _0x34fce8('操作成功','已取消收藏。');else{const _0xebd607={'type':_0x2461a9(0xa38),'content':{..._0x30961b,'characterId':_0xa42f18,'characterName':_0xac1853[_0x2461a9(0x132a)]},'timestamp':Date[_0x2461a9(0x606)]()};await _0x17d534[_0x2461a9(0xb78)][_0x2461a9(0xa58)](_0xebd607),_0x4a604e['classList'][_0x2461a9(0xa58)](_0x2461a9(0xfe1)),await _0x34fce8('操作成功','已成功收藏到“我的收藏”页面！');}}function _0x4d775d(_0x466424){const _0x267a69=_0x204348,_0x2b4df6=document[_0x267a69(0x458)](_0x267a69(0x656)),_0x48b459=document[_0x267a69(0x458)](_0x267a69(0x353));_0x2b4df6[_0x267a69(0x1a2)]=_0x466424[_0x267a69(0x316)],_0x48b459[_0x267a69(0x110d)]='',_0x466424[_0x267a69(0x259)]===_0x267a69(0xefe)?_0x48b459[_0x267a69(0x110d)]=_0x267a69(0x505)+(_0x466424[_0x267a69(0x316)]||'(无标题)')+_0x267a69(0xd36):_0x48b459[_0x267a69(0x110d)]=_0x267a69(0x639)+(_0x466424['content']||_0x267a69(0x129c))[_0x267a69(0x33b)](/\n/g,'</p><p>')+_0x267a69(0xd36);}async function _0x41d1e7(){const _0x2e4f91=_0x204348;if(!_0xa42f18)return;const _0x189dbd=_0x42f206[_0x2e4f91(0x954)][_0xa42f18];if(!_0x189dbd)return;await _0x34fce8(_0x2e4f91(0x12b9),'正在模拟“'+_0x189dbd[_0x2e4f91(0x132a)]+_0x2e4f91(0xf01));const {proxyUrl:_0x4e7388,apiKey:_0x5584f8,model:_0x1aebf9}=_0x42f206[_0x2e4f91(0x5cb)];if(!_0x4e7388||!_0x5584f8||!_0x1aebf9){alert(_0x2e4f91(0x12d5));return;}const _0x24d2ae=_0x42f206[_0x2e4f91(0x551)][_0x2e4f91(0x308)]==='{{user}}'||!_0x42f206[_0x2e4f91(0x551)][_0x2e4f91(0x308)]?'用户':_0x42f206[_0x2e4f91(0x551)][_0x2e4f91(0x308)],_0x3840cd=_0x189dbd[_0x2e4f91(0x94a)]&&_0x189dbd[_0x2e4f91(0x94a)][_0x2e4f91(0x131d)]>0x0?_0x189dbd[_0x2e4f91(0x94a)][_0x2e4f91(0xbf6)](_0xc255bf=>_0x2e4f91(0x101)+_0x1f0c92(_0xc255bf['timestamp'])+')\x20'+_0xc255bf[_0x2e4f91(0x1316)])[_0x2e4f91(0x56c)]('\x0a'):'无',_0x4c2afc=_0x189dbd[_0x2e4f91(0xda2)][_0x2e4f91(0x125c)]||0xa,_0x21aa89=_0x189dbd['history']['slice'](-_0x4c2afc)[_0x2e4f91(0xbf6)](_0x5268c3=>(_0x5268c3[_0x2e4f91(0xaeb)]===_0x2e4f91(0xf86)?_0x24d2ae:_0x189dbd[_0x2e4f91(0x132a)])+':\x20'+String(_0x5268c3[_0x2e4f91(0x1316)])[_0x2e4f91(0xa6d)](0x0,0x1e)+_0x2e4f91(0x10a0))['join']('\x0a'),_0x4780ad=(_0x189dbd[_0x2e4f91(0xda2)]['linkedWorldBookIds']||[])['map'](_0x3e534b=>_0x42f206[_0x2e4f91(0xab7)][_0x2e4f91(0xb07)](_0xf125bc=>_0xf125bc['id']===_0x3e534b))['filter'](Boolean)['map'](_0x2c6f67=>'\x0a##\x20世界书《'+_0x2c6f67[_0x2e4f91(0x132a)]+_0x2e4f91(0x10dc)+_0x2c6f67[_0x2e4f91(0x1316)][_0x2e4f91(0xaf1)](_0x149d84=>_0x149d84[_0x2e4f91(0x12fb)])[_0x2e4f91(0xbf6)](_0x5796d1=>'-\x20'+_0x5796d1[_0x2e4f91(0x1316)])[_0x2e4f91(0x56c)]('\x0a'))[_0x2e4f91(0x56c)](''),_0x1faac2=_0x492011(_0x189dbd,0x3,_0x2e4f91(0xd92)),_0xed0b8b=_0x492011(_0x189dbd,0x6,_0x2e4f91(0xd92)),_0x4ff06e=_0x492011(_0x189dbd,0x9,'hours'),_0x3402bf=_0x492011(_0x189dbd,0x1,_0x2e4f91(0x534)),_0x34387b=_0x492011(_0x189dbd,0x3,_0x2e4f91(0x534)),_0xbe9a14=_0x492011(_0x189dbd,0x7,_0x2e4f91(0x534));let _0x29771f='';if(_0x1faac2||_0xed0b8b||_0x4ff06e||_0x3402bf||_0x34387b||_0xbe9a14){_0x29771f+=_0x2e4f91(0x592);if(_0x1faac2)_0x29771f+=_0x1faac2;if(_0xed0b8b)_0x29771f+=_0xed0b8b;if(_0x4ff06e)_0x29771f+=_0x4ff06e;if(_0x1faac2||_0xed0b8b||_0x4ff06e)_0x29771f+='\x0a';if(_0x3402bf)_0x29771f+=_0x3402bf;if(_0x34387b)_0x29771f+=_0x34387b;if(_0xbe9a14)_0x29771f+=_0xbe9a14;}const _0x36e47c=_0x2e4f91(0x1e0)+_0x189dbd[_0x2e4f91(0x132a)]+_0x2e4f91(0x21b)+_0x189dbd[_0x2e4f91(0xda2)][_0x2e4f91(0x31d)]+_0x2e4f91(0xf93)+_0x3840cd+'\x0a'+_0x4780ad+'\x0a'+_0x29771f+_0x2e4f91(0xa46)+_0x24d2ae+_0x2e4f91(0xc63)+_0x21aa89+_0x2e4f91(0x1fc);try{const _0x53e4d5=[{'role':_0x2e4f91(0xf86),'content':_0x2e4f91(0x53f)}];let _0x43b652=_0x4e7388[_0x2e4f91(0xd8d)]('generativelanguage'),_0x231ccd=_0x5d73db(_0x1aebf9,_0x5584f8,_0x36e47c,_0x53e4d5);const _0x122181=_0x43b652?await fetch(_0x231ccd[_0x2e4f91(0x1377)],_0x231ccd[_0x2e4f91(0x76b)]):await fetch(_0x4e7388+_0x2e4f91(0xd7),{'method':'POST','headers':{'Content-Type':_0x2e4f91(0xa0e),'Authorization':'Bearer\x20'+_0x5584f8},'body':JSON[_0x2e4f91(0xc04)]({'model':_0x1aebf9,'messages':[{'role':_0x2e4f91(0x1370),'content':_0x36e47c},..._0x53e4d5],'temperature':_0x42f206[_0x2e4f91(0xf0)][_0x2e4f91(0xfdf)]||0.9})});if(!_0x122181['ok'])throw new Error(_0x2e4f91(0x676)+_0x122181['statusText']);const _0xcf3c20=await _0x122181[_0x2e4f91(0xaef)](),_0x4fdd6f=getGeminiResponseText(_0xcf3c20),_0x2a3bb2=_0x4fdd6f[_0x2e4f91(0x41c)](/({[\s\S]*})/);if(!_0x2a3bb2)throw new Error(_0x2e4f91(0x73a));const _0x5148b8=JSON[_0x2e4f91(0x44c)](_0x2a3bb2[0x0]);!_0x5148b8[_0x2e4f91(0xc4c)]&&(_0x5148b8[_0x2e4f91(0xc4c)]=[]),_0x189dbd[_0x2e4f91(0x3a7)]=_0x5148b8,await _0x17d534['chats'][_0x2e4f91(0xf3f)](_0x189dbd),await _0xae0e8();}catch(_0x4d3f3d){console['error'](_0x2e4f91(0x7d3),_0x4d3f3d),await _0x34fce8('生成失败',_0x2e4f91(0xf71)+_0x4d3f3d['message']);}}function _0x41d734(){const _0x34757b=_0x204348;_0x1b2183(),_0x3d0170(_0x34757b(0xe5c));}function _0x1b2183(){const _0x49c9f1=_0x204348,_0x445ad7=document[_0x49c9f1(0x458)](_0x49c9f1(0x850));_0x445ad7[_0x49c9f1(0x110d)]='';const _0x127fe2=_0x42f206[_0x49c9f1(0x954)][_0xa42f18],_0x244e00=_0x127fe2['simulatedTaobaoHistory']||{},_0x466e16=_0x244e00[_0x49c9f1(0xc4c)]||[],_0x463450=_0x244e00[_0x49c9f1(0x2e3)]||0x0,_0x597ea4=document[_0x49c9f1(0xe7d)]('div');_0x597ea4[_0x49c9f1(0x1104)]['cssText']=_0x49c9f1(0x3a6),_0x597ea4[_0x49c9f1(0x110d)]=_0x49c9f1(0x13e9)+_0x463450['toFixed'](0x2)+_0x49c9f1(0x9b4),_0x445ad7[_0x49c9f1(0x1079)](_0x597ea4);const _0x4c53ac=document[_0x49c9f1(0xe7d)]('h3');_0x4c53ac['textContent']=_0x49c9f1(0x1085),_0x4c53ac['style'][_0x49c9f1(0x11f)]='font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;',_0x445ad7[_0x49c9f1(0x1079)](_0x4c53ac);if(_0x466e16[_0x49c9f1(0x131d)]===0x0){_0x445ad7[_0x49c9f1(0x110d)]+=_0x49c9f1(0x3de);return;}_0x466e16[_0x49c9f1(0x12c2)](_0x3985d2=>{const _0x42e9bb=_0x49c9f1,_0x15ced4=document['createElement'](_0x42e9bb(0x1323));_0x15ced4[_0x42e9bb(0x1104)][_0x42e9bb(0x11f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x15ced4[_0x42e9bb(0x110d)]=_0x42e9bb(0x98a)+_0x3985d2[_0x42e9bb(0xce9)]+_0x42e9bb(0x664)+_0x3985d2[_0x42e9bb(0x13b2)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥'+(_0x3985d2['price']||0x0)['toFixed'](0x2)+_0x42e9bb(0x97e),_0x445ad7[_0x42e9bb(0x1079)](_0x15ced4);});}async function _0x13dd87(){const _0x1de571=_0x204348;if(!_0xa42f18)return;const _0x55bcac=_0x42f206[_0x1de571(0x954)][_0xa42f18];if(!_0x55bcac)return;await _0x34fce8(_0x1de571(0x12b9),_0x1de571(0x1126)+_0x55bcac['name']+'”分享TA的备忘录...');const {proxyUrl:_0x52d57c,apiKey:_0x5da185,model:_0x3d6d0a}=_0x42f206[_0x1de571(0x5cb)];if(!_0x52d57c||!_0x5da185||!_0x3d6d0a){alert(_0x1de571(0x3d9));return;}const _0x331a2=_0x42f206[_0x1de571(0x551)]['nickname']===_0x1de571(0x852)||!_0x42f206[_0x1de571(0x551)][_0x1de571(0x308)]?'用户':_0x42f206[_0x1de571(0x551)][_0x1de571(0x308)],_0x9627b1=_0x55bcac[_0x1de571(0x94a)]&&_0x55bcac[_0x1de571(0x94a)][_0x1de571(0x131d)]>0x0?_0x55bcac[_0x1de571(0x94a)]['map'](_0x96c9d3=>_0x1de571(0x101)+_0x1f0c92(_0x96c9d3[_0x1de571(0xf16)])+')\x20'+_0x96c9d3['content'])[_0x1de571(0x56c)]('\x0a'):'无',_0xf76606=_0x55bcac['settings'][_0x1de571(0x125c)]||0xa,_0x352b93=_0x55bcac[_0x1de571(0x1d5)][_0x1de571(0x5b0)](-_0xf76606)['map'](_0x421298=>(_0x421298[_0x1de571(0xaeb)]===_0x1de571(0xf86)?_0x331a2:_0x55bcac[_0x1de571(0x132a)])+':\x20'+String(_0x421298['content'])[_0x1de571(0xa6d)](0x0,0x1e)+'...')[_0x1de571(0x56c)]('\x0a'),_0x45e00e=(_0x55bcac[_0x1de571(0xda2)][_0x1de571(0x315)]||[])[_0x1de571(0xbf6)](_0xde7a08=>_0x42f206['worldBooks'][_0x1de571(0xb07)](_0x244bb2=>_0x244bb2['id']===_0xde7a08))['filter'](Boolean)[_0x1de571(0xbf6)](_0x8c8e5b=>'\x0a##\x20世界书《'+_0x8c8e5b['name']+_0x1de571(0x10dc)+_0x8c8e5b[_0x1de571(0x1316)]['filter'](_0x58b2c6=>_0x58b2c6[_0x1de571(0x12fb)])[_0x1de571(0xbf6)](_0xeb3859=>'-\x20'+_0xeb3859[_0x1de571(0x1316)])['join']('\x0a'))[_0x1de571(0x56c)](''),_0x2eaf69=_0x492011(_0x55bcac,0x3,'hours'),_0x57d2bd=_0x492011(_0x55bcac,0x6,_0x1de571(0xd92)),_0x54dfd1=_0x492011(_0x55bcac,0x9,'hours'),_0x364893=_0x492011(_0x55bcac,0x1,'days'),_0x44d0c8=_0x492011(_0x55bcac,0x3,_0x1de571(0x534)),_0x3a3c7d=_0x492011(_0x55bcac,0x7,_0x1de571(0x534));let _0x716534='';if(_0x2eaf69||_0x57d2bd||_0x54dfd1||_0x364893||_0x44d0c8||_0x3a3c7d){_0x716534+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x2eaf69)_0x716534+=_0x2eaf69;if(_0x57d2bd)_0x716534+=_0x57d2bd;if(_0x54dfd1)_0x716534+=_0x54dfd1;if(_0x2eaf69||_0x57d2bd||_0x54dfd1)_0x716534+='\x0a';if(_0x364893)_0x716534+=_0x364893;if(_0x44d0c8)_0x716534+=_0x44d0c8;if(_0x3a3c7d)_0x716534+=_0x3a3c7d;}const _0x5a9b9a=_0x55bcac[_0x1de571(0xda2)][_0x1de571(0x65f)]||_0x1de571(0x213),_0x4c8a01=_0x1de571(0x1e0)+_0x55bcac[_0x1de571(0x132a)]+_0x1de571(0x1210)+_0x55bcac[_0x1de571(0xda2)][_0x1de571(0x31d)]+'\x0a-\x20**\x20你的聊天对象（用户）的人设**:'+_0x5a9b9a+_0x1de571(0xf93)+_0x9627b1+'\x0a'+_0x45e00e+'\x0a'+_0x716534+_0x1de571(0x112f)+_0x331a2+'”的对话摘要**:\x0a'+_0x352b93+_0x1de571(0xac9);try{const _0x27df3e=[{'role':_0x1de571(0xf86),'content':_0x1de571(0x11e2)}];let _0x2960ee=_0x52d57c[_0x1de571(0xd8d)](_0x1de571(0xfe3)),_0x255d9b=_0x5d73db(_0x3d6d0a,_0x5da185,_0x4c8a01,_0x27df3e);const _0x3a84a8=_0x2960ee?await fetch(_0x255d9b[_0x1de571(0x1377)],_0x255d9b[_0x1de571(0x76b)]):await fetch(_0x52d57c+_0x1de571(0xd7),{'method':_0x1de571(0x1312),'headers':{'Content-Type':_0x1de571(0xa0e),'Authorization':_0x1de571(0x8aa)+_0x5da185},'body':JSON[_0x1de571(0xc04)]({'model':_0x3d6d0a,'messages':[{'role':'system','content':_0x4c8a01},..._0x27df3e],'temperature':_0x42f206['globalSettings'][_0x1de571(0xfdf)]||0.9})});if(!_0x3a84a8['ok']){const _0x160f3b=await _0x3a84a8[_0x1de571(0xaef)]()[_0x1de571(0x1135)](()=>null),_0x53f383=_0x160f3b?.[_0x1de571(0xb61)]?.[_0x1de571(0x7aa)]||_0x3a84a8[_0x1de571(0xf0c)];throw new Error(_0x1de571(0x676)+_0x3a84a8['status']+_0x1de571(0x7da)+_0x53f383);}const _0x156b7e=await _0x3a84a8[_0x1de571(0xaef)](),_0x41de8a=getGeminiResponseText(_0x156b7e),_0x475cb7=_0x41de8a[_0x1de571(0x41c)](/(\[[\s\S]*\])/);if(!_0x475cb7||!_0x475cb7[0x0])throw new Error(_0x1de571(0x42f)+_0x41de8a);const _0x20e92b=_0x475cb7[0x0];let _0x4084b4;try{_0x4084b4=JSON[_0x1de571(0x44c)](_0x20e92b);}catch(_0x1f6ae7){throw new Error('解析AI返回的JSON时出错:\x20'+_0x1f6ae7['message']+_0x1de571(0x12c4)+_0x41de8a);}if(!Array[_0x1de571(0x971)](_0x4084b4))throw new Error(_0x1de571(0x12cb)+JSON[_0x1de571(0xc04)](_0x4084b4));_0x55bcac[_0x1de571(0x356)]=_0x4084b4[_0x1de571(0xbf6)](_0x2cc23a=>({'id':Date[_0x1de571(0x606)]()+Math[_0x1de571(0x23a)](),'title':_0x2cc23a['title'],'content':_0x2cc23a['content']})),await _0x17d534[_0x1de571(0x954)][_0x1de571(0xf3f)](_0x55bcac),await _0x33e838();}catch(_0x526ce7){console[_0x1de571(0xb61)](_0x1de571(0xbac),_0x526ce7),await _0x34fce8(_0x1de571(0x47b),_0x1de571(0x38b)+_0x526ce7[_0x1de571(0x7aa)]);}}async function _0x5191d9(){const _0x4ad43d=_0x204348;if(!_0xa42f18)return;const _0x5f59e9=_0x42f206[_0x4ad43d(0x954)][_0xa42f18];if(!_0x5f59e9)return;await _0x34fce8(_0x4ad43d(0x12b9),_0x4ad43d(0x10dd)+_0x5f59e9[_0x4ad43d(0x132a)]+_0x4ad43d(0x875));const {proxyUrl:_0x488004,apiKey:_0x470002,model:_0x582b3f}=_0x42f206[_0x4ad43d(0x5cb)];if(!_0x488004||!_0x470002||!_0x582b3f){alert(_0x4ad43d(0x12d5));return;}const _0x752bb9=_0x42f206[_0x4ad43d(0x551)]['nickname']===_0x4ad43d(0x852)||!_0x42f206[_0x4ad43d(0x551)]['nickname']?'用户':_0x42f206['qzoneSettings'][_0x4ad43d(0x308)],_0x32cc88=_0x5f59e9[_0x4ad43d(0x94a)]&&_0x5f59e9[_0x4ad43d(0x94a)][_0x4ad43d(0x131d)]>0x0?_0x5f59e9[_0x4ad43d(0x94a)][_0x4ad43d(0xbf6)](_0x3c4b7c=>_0x4ad43d(0x101)+_0x1f0c92(_0x3c4b7c[_0x4ad43d(0xf16)])+')\x20'+_0x3c4b7c[_0x4ad43d(0x1316)])['join']('\x0a'):'无',_0x51abfb=_0x5f59e9['settings'][_0x4ad43d(0x125c)]||0xa,_0x411be6=_0x5f59e9[_0x4ad43d(0x1d5)][_0x4ad43d(0x5b0)](-_0x51abfb)[_0x4ad43d(0xbf6)](_0x3f2a5d=>(_0x3f2a5d[_0x4ad43d(0xaeb)]==='user'?_0x752bb9:_0x5f59e9[_0x4ad43d(0x132a)])+':\x20'+String(_0x3f2a5d['content'])[_0x4ad43d(0xa6d)](0x0,0x1e)+_0x4ad43d(0x10a0))[_0x4ad43d(0x56c)]('\x0a'),_0x39833e=(_0x5f59e9[_0x4ad43d(0xda2)]['linkedWorldBookIds']||[])[_0x4ad43d(0xbf6)](_0x3bb666=>_0x42f206[_0x4ad43d(0xab7)][_0x4ad43d(0xb07)](_0x576ab2=>_0x576ab2['id']===_0x3bb666))['filter'](Boolean)[_0x4ad43d(0xbf6)](_0x1932b5=>_0x4ad43d(0x221)+_0x1932b5[_0x4ad43d(0x132a)]+_0x4ad43d(0x10dc)+_0x1932b5[_0x4ad43d(0x1316)][_0x4ad43d(0xaf1)](_0x484281=>_0x484281[_0x4ad43d(0x12fb)])[_0x4ad43d(0xbf6)](_0x59174d=>'-\x20'+_0x59174d['content'])['join']('\x0a'))[_0x4ad43d(0x56c)](''),_0x173786=_0x492011(_0x5f59e9,0x3,_0x4ad43d(0xd92)),_0x25be28=_0x492011(_0x5f59e9,0x6,'hours'),_0x12943a=_0x492011(_0x5f59e9,0x9,_0x4ad43d(0xd92)),_0x39c0f5=_0x492011(_0x5f59e9,0x1,'days'),_0x3d7c31=_0x492011(_0x5f59e9,0x3,_0x4ad43d(0x534)),_0x52650e=_0x492011(_0x5f59e9,0x7,'days');let _0x1a04e5='';if(_0x173786||_0x25be28||_0x12943a||_0x39c0f5||_0x3d7c31||_0x52650e){_0x1a04e5+=_0x4ad43d(0x592);if(_0x173786)_0x1a04e5+=_0x173786;if(_0x25be28)_0x1a04e5+=_0x25be28;if(_0x12943a)_0x1a04e5+=_0x12943a;if(_0x173786||_0x25be28||_0x12943a)_0x1a04e5+='\x0a';if(_0x39c0f5)_0x1a04e5+=_0x39c0f5;if(_0x3d7c31)_0x1a04e5+=_0x3d7c31;if(_0x52650e)_0x1a04e5+=_0x52650e;}const _0x34674d=_0x4ad43d(0x1e0)+_0x5f59e9[_0x4ad43d(0x132a)]+'”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**'+new Date()[_0x4ad43d(0xf63)]()+_0x4ad43d(0x1131)+_0x5f59e9[_0x4ad43d(0xda2)][_0x4ad43d(0x31d)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0x32cc88+'\x0a'+_0x39833e+'\x0a'+_0x1a04e5+_0x4ad43d(0x112f)+_0x752bb9+_0x4ad43d(0xc63)+_0x411be6+_0x4ad43d(0x18e);try{const _0x5964bb=[{'role':'user','content':'请根据你的设定，生成你的高德地图足迹。'}];let _0x579011=_0x488004[_0x4ad43d(0xd8d)](_0x4ad43d(0xfe3)),_0x102ca2=_0x5d73db(_0x582b3f,_0x470002,_0x34674d,_0x5964bb);const _0x1925f7=_0x579011?await fetch(_0x102ca2[_0x4ad43d(0x1377)],_0x102ca2[_0x4ad43d(0x76b)]):await fetch(_0x488004+_0x4ad43d(0xd7),{'method':'POST','headers':{'Content-Type':_0x4ad43d(0xa0e),'Authorization':_0x4ad43d(0x8aa)+_0x470002},'body':JSON[_0x4ad43d(0xc04)]({'model':_0x582b3f,'messages':[{'role':_0x4ad43d(0x1370),'content':_0x34674d},..._0x5964bb],'temperature':_0x42f206[_0x4ad43d(0xf0)][_0x4ad43d(0xfdf)]||0.9})});if(!_0x1925f7['ok'])throw new Error(_0x4ad43d(0x676)+_0x1925f7['statusText']);const _0x2d1cf9=await _0x1925f7[_0x4ad43d(0xaef)](),_0x3fd56c=getGeminiResponseText(_0x2d1cf9),_0x45e25b=_0x3fd56c[_0x4ad43d(0x41c)](/(\[[\s\S]*\])/);if(!_0x45e25b||!_0x45e25b[0x0])throw new Error(_0x4ad43d(0x42f)+_0x3fd56c);const _0x43f062=_0x45e25b[0x0];let _0x3dacfb;try{_0x3dacfb=JSON['parse'](_0x43f062);}catch(_0xba1243){throw new Error(_0x4ad43d(0xde0)+_0xba1243[_0x4ad43d(0x7aa)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x3fd56c);}_0x5f59e9[_0x4ad43d(0xd1)]=_0x3dacfb,await _0x17d534[_0x4ad43d(0x954)][_0x4ad43d(0xf3f)](_0x5f59e9),await _0x4a1205();}catch(_0x3f49fc){console['error']('生成模拟足迹失败:',_0x3f49fc),await _0x34fce8('生成失败','无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20'+_0x3f49fc[_0x4ad43d(0x7aa)]);}}function _0x4a1205(){const _0x471e8f=_0x204348,_0x4f79de=document[_0x471e8f(0x458)](_0x471e8f(0x7dd));_0x4f79de[_0x471e8f(0x110d)]='';if(!_0xa42f18)return;const _0x3bd7f1=_0x42f206[_0x471e8f(0x954)][_0xa42f18],_0x5374bf=_0x3bd7f1[_0x471e8f(0xd1)]||[];if(_0x5374bf[_0x471e8f(0x131d)]===0x0){_0x4f79de[_0x471e8f(0x110d)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>';return;}_0x5374bf[_0x471e8f(0x12c2)](_0x31be7f=>{const _0x5bf109=_0x471e8f,_0x87ab17=document['createElement'](_0x5bf109(0x1323));_0x87ab17[_0x5bf109(0x69b)]='char-amap-item';let _0x5e7471='';if(_0x31be7f[_0x5bf109(0xef)]){const _0x1fa631=_0x5bf109(0x94c)+encodeURIComponent(_0x31be7f[_0x5bf109(0xef)]);_0x5e7471=_0x5bf109(0x12d6)+_0x1fa631+_0x5bf109(0x2b3)+_0x31be7f['comment']+_0x5bf109(0x13b7);}const _0x3eeb96=_0x31be7f[_0x5bf109(0xf16)]?_0x1f0c92(new Date(_0x31be7f[_0x5bf109(0xf16)])[_0x5bf109(0xf08)]()):'某个时间';_0x87ab17[_0x5bf109(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>'+_0x31be7f[_0x5bf109(0x14d)]+_0x5bf109(0x10d4)+_0x31be7f[_0x5bf109(0x854)]+_0x5bf109(0x43f)+_0x31be7f['comment'][_0x5bf109(0x33b)](/\n/g,'<br>')+_0x5bf109(0xc42)+_0x5e7471+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>'+_0x3eeb96+_0x5bf109(0xab2),_0x4f79de[_0x5bf109(0x1079)](_0x87ab17);});}async function _0x3b3f30(){const _0x28d79d=_0x204348;if(!_0xa42f18)return;const _0x569bea=_0x42f206['chats'][_0xa42f18];if(!_0x569bea)return;await _0x34fce8(_0x28d79d(0x12b9),_0x28d79d(0x1372)+_0x569bea[_0x28d79d(0x132a)]+_0x28d79d(0x3a9));const {proxyUrl:_0x151d69,apiKey:_0x462332,model:_0x5a2be4}=_0x42f206[_0x28d79d(0x5cb)];if(!_0x151d69||!_0x462332||!_0x5a2be4){alert(_0x28d79d(0x12d5));return;}const _0x598bab=_0x42f206[_0x28d79d(0x551)][_0x28d79d(0x308)]===_0x28d79d(0x852)||!_0x42f206[_0x28d79d(0x551)][_0x28d79d(0x308)]?'用户':_0x42f206[_0x28d79d(0x551)]['nickname'],_0x432f47=_0x569bea[_0x28d79d(0x94a)]&&_0x569bea[_0x28d79d(0x94a)][_0x28d79d(0x131d)]>0x0?_0x569bea[_0x28d79d(0x94a)][_0x28d79d(0xbf6)](_0x1844d5=>_0x28d79d(0x101)+_0x1f0c92(_0x1844d5[_0x28d79d(0xf16)])+')\x20'+_0x1844d5[_0x28d79d(0x1316)])[_0x28d79d(0x56c)]('\x0a'):'无',_0x40420a=_0x569bea[_0x28d79d(0xda2)]['maxMemory']||0xa,_0x454281=_0x569bea[_0x28d79d(0x1d5)][_0x28d79d(0x5b0)](-_0x40420a)['map'](_0x9f5023=>(_0x9f5023[_0x28d79d(0xaeb)]===_0x28d79d(0xf86)?_0x598bab:_0x569bea['name'])+':\x20'+String(_0x9f5023[_0x28d79d(0x1316)])[_0x28d79d(0xa6d)](0x0,0x1e)+_0x28d79d(0x10a0))[_0x28d79d(0x56c)]('\x0a'),_0x3a632b=(_0x569bea['settings'][_0x28d79d(0x315)]||[])['map'](_0x8d9acd=>_0x42f206[_0x28d79d(0xab7)][_0x28d79d(0xb07)](_0x4f7397=>_0x4f7397['id']===_0x8d9acd))[_0x28d79d(0xaf1)](Boolean)[_0x28d79d(0xbf6)](_0x5e7e87=>'\x0a##\x20世界书《'+_0x5e7e87['name']+'》设定:\x0a'+_0x5e7e87[_0x28d79d(0x1316)]['filter'](_0x1fe76c=>_0x1fe76c[_0x28d79d(0x12fb)])[_0x28d79d(0xbf6)](_0x390ef4=>'-\x20'+_0x390ef4[_0x28d79d(0x1316)])[_0x28d79d(0x56c)]('\x0a'))[_0x28d79d(0x56c)](''),_0x5c04c7=_0x492011(_0x569bea,0x3,'hours'),_0x3e1ce3=_0x492011(_0x569bea,0x6,'hours'),_0x2300a1=_0x492011(_0x569bea,0x9,_0x28d79d(0xd92)),_0x484da8=_0x492011(_0x569bea,0x1,_0x28d79d(0x534)),_0x1b28de=_0x492011(_0x569bea,0x3,'days'),_0x12e07b=_0x492011(_0x569bea,0x7,'days');let _0x94999c='';if(_0x5c04c7||_0x3e1ce3||_0x2300a1||_0x484da8||_0x1b28de||_0x12e07b){_0x94999c+=_0x28d79d(0x592);if(_0x5c04c7)_0x94999c+=_0x5c04c7;if(_0x3e1ce3)_0x94999c+=_0x3e1ce3;if(_0x2300a1)_0x94999c+=_0x2300a1;if(_0x5c04c7||_0x3e1ce3||_0x2300a1)_0x94999c+='\x0a';if(_0x484da8)_0x94999c+=_0x484da8;if(_0x1b28de)_0x94999c+=_0x1b28de;if(_0x12e07b)_0x94999c+=_0x12e07b;}const _0xf09df0=_0x28d79d(0x1e0)+_0x569bea['name']+'”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x569bea[_0x28d79d(0xda2)]['aiPersona']+_0x28d79d(0xf93)+_0x432f47+'\x0a'+_0x3a632b+'\x0a'+_0x94999c+'\x0a-\x20**你最近和“'+_0x598bab+_0x28d79d(0xc63)+_0x454281+_0x28d79d(0xd5e);try{const _0x118726=[{'role':_0x28d79d(0xf86),'content':'请根据你的设定，生成你的App使用记录。'}];let _0x526a1e=_0x151d69[_0x28d79d(0xd8d)](_0x28d79d(0xfe3)),_0x7334c9=_0x5d73db(_0x5a2be4,_0x462332,_0xf09df0,_0x118726);const _0xf9a08a=_0x526a1e?await fetch(_0x7334c9[_0x28d79d(0x1377)],_0x7334c9[_0x28d79d(0x76b)]):await fetch(_0x151d69+_0x28d79d(0xd7),{'method':_0x28d79d(0x1312),'headers':{'Content-Type':_0x28d79d(0xa0e),'Authorization':_0x28d79d(0x8aa)+_0x462332},'body':JSON[_0x28d79d(0xc04)]({'model':_0x5a2be4,'messages':[{'role':_0x28d79d(0x1370),'content':_0xf09df0},..._0x118726],'temperature':_0x42f206[_0x28d79d(0xf0)][_0x28d79d(0xfdf)]||0.9})});if(!_0xf9a08a['ok'])throw new Error(_0x28d79d(0x676)+_0xf9a08a[_0x28d79d(0xf0c)]);const _0x2b5f19=await _0xf9a08a[_0x28d79d(0xaef)](),_0x236ac3=getGeminiResponseText(_0x2b5f19),_0x185a71=_0x236ac3[_0x28d79d(0x33b)](/^```json\s*/,'')[_0x28d79d(0x33b)](/```$/,''),_0x52e911=JSON[_0x28d79d(0x44c)](_0x185a71);_0x569bea[_0x28d79d(0x5c9)]=_0x52e911,await _0x17d534[_0x28d79d(0x954)][_0x28d79d(0xf3f)](_0x569bea),await _0x4a498a();}catch(_0xc73cbb){console['error']('生成模拟App使用记录失败:',_0xc73cbb),await _0x34fce8(_0x28d79d(0x47b),'无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0xc73cbb[_0x28d79d(0x7aa)]);}}function _0x4a498a(){const _0x3a27ff=_0x204348,_0x222941=document[_0x3a27ff(0x458)]('char-usage-list');_0x222941[_0x3a27ff(0x110d)]='';if(!_0xa42f18)return;const _0x477416=_0x42f206[_0x3a27ff(0x954)][_0xa42f18],_0xcf6195=(_0x477416[_0x3a27ff(0x5c9)]||[])[_0x3a27ff(0xc12)]((_0x4dbea5,_0x204499)=>_0x204499[_0x3a27ff(0x773)]-_0x4dbea5[_0x3a27ff(0x773)]);if(_0xcf6195[_0x3a27ff(0x131d)]===0x0){_0x222941[_0x3a27ff(0x110d)]=_0x3a27ff(0x7ef);return;}_0xcf6195[_0x3a27ff(0x12c2)](_0x3be0ba=>{const _0x559969=_0x3a27ff,_0x2e62f9=document[_0x559969(0xe7d)]('div');_0x2e62f9['className']=_0x559969(0xa1a);const _0x202bdf=Math[_0x559969(0xbd5)](_0x3be0ba['usageTimeMinutes']/0x3c),_0x22fdc9=_0x3be0ba[_0x559969(0x773)]%0x3c;let _0x151498='';if(_0x202bdf>0x0)_0x151498+=_0x202bdf+'小时';if(_0x22fdc9>0x0)_0x151498+=_0x22fdc9+'分钟';if(!_0x151498)_0x151498=_0x559969(0x399);const _0x480162=_0x3be0ba[_0x559969(0xef)]||_0x559969(0x448)+_0x3be0ba['appName']+_0x559969(0xd5a),_0x90937b='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x480162);_0x2e62f9[_0x559969(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x90937b+'\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>'+_0x3be0ba[_0x559969(0x10c9)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>'+_0x3be0ba[_0x559969(0xc4f)]+_0x559969(0x2c6)+_0x151498+_0x559969(0xab2),_0x222941[_0x559969(0x1079)](_0x2e62f9);});}async function _0x1df9d1(){const _0xc21230=_0x204348;if(!_0xa42f18)return;const _0x206a1e=_0x42f206[_0xc21230(0x954)][_0xa42f18];if(!_0x206a1e)return;await _0x34fce8(_0xc21230(0x12b9),_0xc21230(0x1126)+_0x206a1e[_0xc21230(0x132a)]+_0xc21230(0x645));const {proxyUrl:_0xecf136,apiKey:_0x167993,model:_0xa00003}=_0x42f206[_0xc21230(0x5cb)];if(!_0xecf136||!_0x167993||!_0xa00003){alert(_0xc21230(0x3d9));return;}const _0x520ad6=_0x42f206['qzoneSettings']['nickname']==='{{user}}'||!_0x42f206[_0xc21230(0x551)][_0xc21230(0x308)]?'用户':_0x42f206['qzoneSettings'][_0xc21230(0x308)],_0x46033f=_0x206a1e[_0xc21230(0x94a)]&&_0x206a1e[_0xc21230(0x94a)][_0xc21230(0x131d)]>0x0?_0x206a1e['longTermMemory']['map'](_0x8d730c=>_0xc21230(0x101)+_0x1f0c92(_0x8d730c[_0xc21230(0xf16)])+')\x20'+_0x8d730c[_0xc21230(0x1316)])[_0xc21230(0x56c)]('\x0a'):'无',_0x408b63=_0x206a1e[_0xc21230(0xda2)]['maxMemory']||0xa,_0x34bfbd=_0x206a1e[_0xc21230(0x1d5)]['slice'](-_0x408b63)[_0xc21230(0xbf6)](_0xf9f022=>(_0xf9f022[_0xc21230(0xaeb)]===_0xc21230(0xf86)?_0x520ad6:_0x206a1e[_0xc21230(0x132a)])+':\x20'+String(_0xf9f022[_0xc21230(0x1316)])[_0xc21230(0xa6d)](0x0,0x1e)+'...')['join']('\x0a'),_0x1e1a36=(_0x206a1e[_0xc21230(0xda2)]['linkedWorldBookIds']||[])[_0xc21230(0xbf6)](_0x42ff27=>_0x42f206[_0xc21230(0xab7)]['find'](_0x561c95=>_0x561c95['id']===_0x42ff27))[_0xc21230(0xaf1)](Boolean)['map'](_0x41d60c=>'\x0a##\x20世界书《'+_0x41d60c[_0xc21230(0x132a)]+_0xc21230(0x10dc)+_0x41d60c[_0xc21230(0x1316)]['filter'](_0x47d5d8=>_0x47d5d8['enabled'])[_0xc21230(0xbf6)](_0x906fd8=>'-\x20'+_0x906fd8[_0xc21230(0x1316)])[_0xc21230(0x56c)]('\x0a'))[_0xc21230(0x56c)](''),_0x4acd5d=_0xc21230(0x393)+_0x206a1e[_0xc21230(0x132a)]+_0xc21230(0x870)+_0x206a1e[_0xc21230(0xda2)][_0xc21230(0x31d)]+_0xc21230(0xf93)+_0x46033f+'\x0a'+_0x1e1a36+'\x0a-\x20**你最近和“'+_0x520ad6+_0xc21230(0xc63)+_0x34bfbd+_0xc21230(0x1292);try{const _0x517bf4=[{'role':_0xc21230(0xf86),'content':_0xc21230(0x6c7)}];let _0x2921d9=_0xecf136[_0xc21230(0xd8d)](_0xc21230(0xfe3)),_0x2f7c80=_0x5d73db(_0xa00003,_0x167993,_0x4acd5d,_0x517bf4);const _0x564029=_0x2921d9?await fetch(_0x2f7c80[_0xc21230(0x1377)],_0x2f7c80['data']):await fetch(_0xecf136+_0xc21230(0xd7),{'method':_0xc21230(0x1312),'headers':{'Content-Type':_0xc21230(0xa0e),'Authorization':_0xc21230(0x8aa)+_0x167993},'body':JSON['stringify']({'model':_0xa00003,'messages':[{'role':_0xc21230(0x1370),'content':_0x4acd5d},..._0x517bf4],'temperature':_0x42f206[_0xc21230(0xf0)][_0xc21230(0xfdf)]||0x1})});if(!_0x564029['ok'])throw new Error(_0xc21230(0x676)+_0x564029[_0xc21230(0xf0c)]);const _0x3963bb=await _0x564029['json'](),_0x5316c9=getGeminiResponseText(_0x3963bb),_0x1fb5e2=_0x5316c9[_0xc21230(0x33b)](/^```json\s*/,'')['replace'](/```$/,''),_0x5d8cf0=JSON[_0xc21230(0x44c)](_0x1fb5e2);await _0x34fce8(_0xc21230(0x12b9),_0xc21230(0x5c4)+_0x5d8cf0['length']+_0xc21230(0x10e8));const _0x4fe5fd=_0x5d8cf0[_0xc21230(0xbf6)](async _0x3373a4=>{const _0x380262=_0xc21230;let _0x482c6b=await _0x15b651(_0x3373a4['songName'],_0x3373a4[_0x380262(0x8a6)]);(!_0x482c6b||_0x482c6b[_0x380262(0x131d)]===0x0)&&(_0x482c6b=await _0x2fab6d(_0x3373a4['songName']));if(_0x482c6b[_0x380262(0x131d)]>0x0)return _0x834247(_0x482c6b[0x0]);return console[_0x380262(0x1b6)](_0x380262(0x10f5)+_0x3373a4['songName']+_0x380262(0x7da)+_0x3373a4[_0x380262(0x8a6)]+'”'),null;}),_0x477de6=(await Promise['all'](_0x4fe5fd))[_0xc21230(0xaf1)](Boolean);_0x206a1e[_0xc21230(0xb34)]=_0x477de6,await _0x17d534['chats'][_0xc21230(0xf3f)](_0x206a1e),await _0x288ac5();}catch(_0x3b24b3){console[_0xc21230(0xb61)](_0xc21230(0x119e),_0x3b24b3),await _0x34fce8(_0xc21230(0x47b),_0xc21230(0x45d)+_0x3b24b3['message']);}}function _0x288ac5(){const _0x4d8b29=_0x204348,_0x26c349=document[_0x4d8b29(0x458)](_0x4d8b29(0xfae));_0x26c349[_0x4d8b29(0x110d)]='';if(!_0xa42f18)return;const _0x325003=_0x42f206[_0x4d8b29(0x954)][_0xa42f18],_0x2fde6d=_0x325003['simulatedMusicPlaylist']||[];if(_0x2fde6d['length']===0x0){_0x26c349[_0x4d8b29(0x110d)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>';return;}_0x2fde6d[_0x4d8b29(0x12c2)]((_0x3f285d,_0x4f599c)=>{const _0x325c4d=_0x4d8b29,_0x85e13a=document['createElement'](_0x325c4d(0x1323));_0x85e13a[_0x325c4d(0x69b)]=_0x325c4d(0xe73),_0x85e13a[_0x325c4d(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3f285d[_0x325c4d(0x847)]+'\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>'+_0x3f285d[_0x325c4d(0x132a)]+_0x325c4d(0xda9)+_0x3f285d['artist']+_0x325c4d(0xaa6),_0x85e13a[_0x325c4d(0xd85)](_0x325c4d(0x1122),()=>_0x1d0aa8(_0x3f285d)),_0x26c349[_0x325c4d(0x1079)](_0x85e13a);});}let _0x2dc716={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':'order','lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0x1d0aa8(_0x392d39){const _0x1e4f5f=_0x204348,_0x2b1687=document[_0x1e4f5f(0x458)](_0x1e4f5f(0x1013)),_0x3f0878=document[_0x1e4f5f(0x458)](_0x1e4f5f(0x100b));if(_0x2dc716[_0x1e4f5f(0x5fa)])clearInterval(_0x2dc716[_0x1e4f5f(0x5fa)]);_0x2b1687[_0x1e4f5f(0x16a)]();const _0x472f8a=_0x2dc716[_0x1e4f5f(0x4cc)]['findIndex'](_0x5185ed=>_0x5185ed['src']===_0x392d39[_0x1e4f5f(0x577)]);_0x472f8a>-0x1?_0x2dc716[_0x1e4f5f(0x4bd)]=_0x472f8a:(_0x2dc716[_0x1e4f5f(0x4cc)]=[_0x392d39],_0x2dc716[_0x1e4f5f(0x4bd)]=0x0);document[_0x1e4f5f(0x458)](_0x1e4f5f(0x1123))[_0x1e4f5f(0x1a2)]=_0x392d39[_0x1e4f5f(0x132a)],document[_0x1e4f5f(0x458)](_0x1e4f5f(0x79f))['textContent']=_0x392d39[_0x1e4f5f(0xd81)],document[_0x1e4f5f(0x458)](_0x1e4f5f(0x86a))[_0x1e4f5f(0x577)]=_0x392d39[_0x1e4f5f(0x847)],_0x2dc716[_0x1e4f5f(0x169)]=_0x3e0f49(_0x392d39[_0x1e4f5f(0x11ec)]||''),_0x3b5420();if(_0x392d39[_0x1e4f5f(0x7e9)]){const _0x21b975=new Blob([_0x392d39[_0x1e4f5f(0x577)]],{'type':_0x392d39[_0x1e4f5f(0x134d)]||_0x1e4f5f(0x80e)});_0x2b1687[_0x1e4f5f(0x577)]=URL[_0x1e4f5f(0x795)](_0x21b975);}else _0x2b1687['src']=_0x392d39[_0x1e4f5f(0x577)];_0x2b1687[_0x1e4f5f(0x1391)]()['catch'](_0x46e24a=>console[_0x1e4f5f(0xb61)]('音频播放失败:',_0x46e24a)),_0x2b1687[_0x1e4f5f(0xb24)]=()=>{const _0x33d323=_0x1e4f5f;document[_0x33d323(0x458)]('char-music-total-time')[_0x33d323(0x1a2)]=_0x3e09a2(_0x2b1687[_0x33d323(0x563)]),_0x2dc716[_0x33d323(0x5fa)]=setInterval(_0x53cf87,0x1f4);},_0x3f0878[_0x1e4f5f(0x11c2)][_0x1e4f5f(0xa58)]('visible');}function _0x2f4392(){const _0x3e57ce=_0x204348,_0x2ffe80=document['getElementById'](_0x3e57ce(0x100b)),_0x4df432=document[_0x3e57ce(0x458)](_0x3e57ce(0x1013));if(_0x2dc716[_0x3e57ce(0x5fa)])clearInterval(_0x2dc716[_0x3e57ce(0x5fa)]);_0x4df432[_0x3e57ce(0x16a)](),_0x4df432['src']='',_0x2ffe80[_0x3e57ce(0x11c2)][_0x3e57ce(0x1097)](_0x3e57ce(0x67d)),_0x2dc716[_0x3e57ce(0x1111)]=![],document[_0x3e57ce(0x458)]('char-vinyl-container')['classList'][_0x3e57ce(0x1097)]('spinning');}function _0x53cf87(){const _0x54e995=_0x204348,_0x276a18=document[_0x54e995(0x458)](_0x54e995(0x1013));if(!_0x276a18[_0x54e995(0x563)])return;const _0x2bdbbd=_0x276a18['currentTime'],_0x29b89d=_0x276a18['duration'];document[_0x54e995(0x458)](_0x54e995(0x1137))[_0x54e995(0x1104)][_0x54e995(0x1147)]=_0x2bdbbd/_0x29b89d*0x64+'%',document[_0x54e995(0x458)](_0x54e995(0x13d1))[_0x54e995(0x1a2)]=_0x3e09a2(_0x2bdbbd),_0x45d0de(_0x2bdbbd);}function _0x3b5420(){const _0x1da0ab=_0x204348,_0xbcc285=document['getElementById'](_0x1da0ab(0x8bd));_0xbcc285['innerHTML']='',_0x2dc716[_0x1da0ab(0x1204)]=-0x1;if(!_0x2dc716[_0x1da0ab(0x169)]||_0x2dc716['parsedLyrics'][_0x1da0ab(0x131d)]===0x0){_0xbcc285['innerHTML']=_0x1da0ab(0xbbd);return;}_0x2dc716[_0x1da0ab(0x169)]['forEach']((_0x4108d7,_0x21c971)=>{const _0x24e4f9=_0x1da0ab,_0x1a33e3=document[_0x24e4f9(0xe7d)]('p');_0x1a33e3[_0x24e4f9(0x1a2)]=_0x4108d7['text'],_0x1a33e3['dataset'][_0x24e4f9(0xb3)]=_0x21c971,_0xbcc285[_0x24e4f9(0x1079)](_0x1a33e3);});}function _0x45d0de(_0x18dee9){const _0x4755f2=_0x204348,_0x318750=_0x2dc716[_0x4755f2(0x169)];if(_0x318750['length']===0x0)return;let _0x282810=-0x1;for(let _0x336f7f=0x0;_0x336f7f<_0x318750[_0x4755f2(0x131d)];_0x336f7f++){if(_0x18dee9>=_0x318750[_0x336f7f][_0x4755f2(0x33e)])_0x282810=_0x336f7f;else break;}if(_0x282810===_0x2dc716['currentLyricIndex'])return;_0x2dc716[_0x4755f2(0x1204)]=_0x282810;const _0x29164b=document[_0x4755f2(0x458)]('char-music-lyrics'),_0x5cafa2=_0x29164b[_0x4755f2(0x102a)]('p');_0x5cafa2[_0x4755f2(0x12c2)](_0x1d85c6=>_0x1d85c6[_0x4755f2(0x11c2)][_0x4755f2(0x1097)]('active'));if(_0x282810>-0x1){const _0x3be632=_0x29164b['querySelector']('p[data-index=\x22'+_0x282810+'\x22]');if(_0x3be632){_0x3be632['classList'][_0x4755f2(0xa58)]('active');const _0x2acb5b=_0x29164b['clientHeight']/0x2-_0x3be632[_0x4755f2(0xbc5)]-_0x3be632[_0x4755f2(0xcdb)]/0x2;_0x5cafa2[_0x4755f2(0x12c2)](_0x3d9166=>{const _0x503d72=_0x4755f2;_0x3d9166['style'][_0x503d72(0xb7e)]=_0x503d72(0x6cb)+_0x2acb5b+_0x503d72(0xe13);});}}}function _0x36f907(){const _0x1e624f=_0x204348;if(_0x2dc716[_0x1e624f(0x4cc)]['length']===0x0)return;let _0x110622;switch(_0x2dc716[_0x1e624f(0x93a)]){case _0x1e624f(0x23a):_0x110622=Math['floor'](Math[_0x1e624f(0x23a)]()*_0x2dc716[_0x1e624f(0x4cc)]['length']);break;case _0x1e624f(0x2e0):_0x1d0aa8(_0x2dc716[_0x1e624f(0x4cc)][_0x2dc716[_0x1e624f(0x4bd)]]);return;case _0x1e624f(0x1ec):default:_0x110622=(_0x2dc716[_0x1e624f(0x4bd)]+0x1)%_0x2dc716[_0x1e624f(0x4cc)][_0x1e624f(0x131d)];break;}_0x1d0aa8(_0x2dc716[_0x1e624f(0x4cc)][_0x110622]);}function _0x53e3de(){const _0x32375d=_0x204348;if(_0x2dc716[_0x32375d(0x4cc)][_0x32375d(0x131d)]===0x0)return;const _0x55079=(_0x2dc716[_0x32375d(0x4bd)]-0x1+_0x2dc716['currentPlaylist'][_0x32375d(0x131d)])%_0x2dc716[_0x32375d(0x4cc)][_0x32375d(0x131d)];_0x1d0aa8(_0x2dc716[_0x32375d(0x4cc)][_0x55079]);}function _0x39f5c5(){const _0x426863=_0x204348,_0x4ead4c=[_0x426863(0x1ec),'random',_0x426863(0x2e0)],_0x189376=_0x4ead4c[_0x426863(0x893)](_0x2dc716[_0x426863(0x93a)]);_0x2dc716[_0x426863(0x93a)]=_0x4ead4c[(_0x189376+0x1)%_0x4ead4c[_0x426863(0x131d)]],document['getElementById'](_0x426863(0xb98))[_0x426863(0x1a2)]={'order':'顺序','random':'随机','single':'单曲'}[_0x2dc716[_0x426863(0x93a)]];}function _0x1d119b(){const _0xf901ed=_0x204348,_0x356106=document['getElementById']('char-audio-player'),_0x1350c8=document[_0xf901ed(0x458)](_0xf901ed(0x1154)),_0x712a46=document['getElementById'](_0xf901ed(0xf7c));_0x1350c8[_0xf901ed(0xd85)](_0xf901ed(0x1122),()=>{const _0x30b2=_0xf901ed;if(_0x356106[_0x30b2(0xf7a)]){if(_0x2dc716[_0x30b2(0x4bd)]>-0x1)_0x356106[_0x30b2(0x1391)]();}else _0x356106[_0x30b2(0x16a)]();}),_0x356106[_0xf901ed(0xb35)]=()=>{const _0x53627f=_0xf901ed;_0x1350c8[_0x53627f(0x110d)]=_0x53627f(0xd87),_0x712a46[_0x53627f(0x11c2)][_0x53627f(0xa58)]('spinning'),_0x2dc716[_0x53627f(0x1111)]=!![];},_0x356106[_0xf901ed(0xd32)]=()=>{const _0x3e574e=_0xf901ed;_0x1350c8[_0x3e574e(0x110d)]=_0x3e574e(0xd0e),_0x712a46[_0x3e574e(0x11c2)]['remove'](_0x3e574e(0x101f)),_0x2dc716[_0x3e574e(0x1111)]=![];},_0x356106['onended']=()=>{const _0x3c74c1=_0xf901ed;_0x712a46['classList'][_0x3c74c1(0x1097)](_0x3c74c1(0x101f)),_0x2dc716[_0x3c74c1(0x1111)]=![],_0x36f907();},document[_0xf901ed(0x458)](_0xf901ed(0x10c))[_0xf901ed(0xd85)](_0xf901ed(0x1122),_0x53e3de),document[_0xf901ed(0x458)](_0xf901ed(0x107f))['addEventListener'](_0xf901ed(0x1122),_0x36f907),document['getElementById']('char-music-mode-btn')[_0xf901ed(0xd85)]('click',_0x39f5c5),document[_0xf901ed(0x458)](_0xf901ed(0x93c))[_0xf901ed(0xd85)](_0xf901ed(0x1122),_0x18cfe1=>{const _0x3260d4=_0xf901ed;if(!_0x356106['duration'])return;const _0x649cf1=_0x18cfe1[_0x3260d4(0xdb2)],_0x5e4217=_0x18cfe1[_0x3260d4(0x12b4)];_0x356106[_0x3260d4(0x4b1)]=_0x5e4217/_0x649cf1[_0x3260d4(0x11e1)]*_0x356106[_0x3260d4(0x563)];});}async function _0x10bf4a(){const _0x24760a=_0x204348,_0x2ecaff=document['getElementById']('douban-posts-list');_0x2ecaff['innerHTML']='';const _0x150946=await _0x17d534[_0x24760a(0xaf9)][_0x24760a(0x50b)](_0x24760a(0xf16))['reverse']()[_0x24760a(0x511)]();if(_0x150946['length']===0x0){_0x2ecaff[_0x24760a(0x110d)]=_0x24760a(0xfd8);return;}_0x150946['forEach'](_0x6057fa=>{const _0x1a2a29=_0x24760a;let _0x3947ef;const _0x404d11=_0x6057fa[_0x1a2a29(0xb85)]?Object[_0x1a2a29(0x6eb)](_0x42f206['chats'])[_0x1a2a29(0xb07)](_0x13a68a=>!_0x13a68a[_0x1a2a29(0x726)]&&_0x13a68a[_0x1a2a29(0x132a)]===_0x6057fa[_0x1a2a29(0xb85)]):null;if(_0x404d11)_0x3947ef=_0x404d11[_0x1a2a29(0xda2)][_0x1a2a29(0x9c7)];else{const _0x2aee55=Object[_0x1a2a29(0x6eb)](_0x42f206[_0x1a2a29(0x954)])['find'](_0x3ffc5e=>!_0x3ffc5e['isGroup']&&_0x3ffc5e[_0x1a2a29(0x132a)]===_0x6057fa[_0x1a2a29(0x1176)]);if(_0x2aee55)_0x3947ef=_0x2aee55[_0x1a2a29(0xda2)]['aiAvatar'];else _0x6057fa[_0x1a2a29(0xe66)]?_0x3947ef='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x6057fa[_0x1a2a29(0xe66)]):_0x3947ef=_0x4fd084;}const _0x512238=document[_0x1a2a29(0xe7d)]('div');_0x512238[_0x1a2a29(0x69b)]=_0x1a2a29(0x7b3),_0x512238[_0x1a2a29(0xbe8)]=()=>_0x48cc0c(_0x6057fa['id']),_0x512238['innerHTML']=_0x1a2a29(0x8be)+_0x3947ef+_0x1a2a29(0x669)+_0x6057fa['authorName']+_0x1a2a29(0xfad)+_0x6057fa[_0x1a2a29(0x12b3)]+_0x1a2a29(0x86f)+_0x6057fa[_0x1a2a29(0x3b4)]+_0x1a2a29(0xe61)+_0x6057fa[_0x1a2a29(0x1316)][_0x1a2a29(0x33b)](/\n/g,'<br>')+_0x1a2a29(0xe86)+_0x6057fa[_0x1a2a29(0xcc)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20'+_0x6057fa['commentsCount']+_0x1a2a29(0xac8)+_0x1f0c92(_0x6057fa[_0x1a2a29(0xf16)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x2ecaff[_0x1a2a29(0x1079)](_0x512238);});}async function _0x2f5be7(){const _0xdafc04=_0x204348,_0x562836=_0x42f206[_0xdafc04(0xf0)]['doubanActiveCharacterIds']||[];if(_0x562836['length']===0x0){await _0x34fce8(_0xdafc04(0x450),_0xdafc04(0xd4d));return;}await _0x34fce8(_0xdafc04(0x12b9),_0xdafc04(0x279)+_0x562836[_0xdafc04(0x131d)]+'\x20位角色生成豆瓣动态...');const {proxyUrl:_0x2b79ba,apiKey:_0x190cd2,model:_0x60e248}=_0x42f206[_0xdafc04(0x5cb)];if(!_0x2b79ba||!_0x190cd2||!_0x60e248){alert(_0xdafc04(0x3d9));return;}const _0x2f3c3c=new Set();_0x562836['forEach'](_0x208e70=>{const _0x45f269=_0xdafc04,_0x118346=_0x42f206['chats'][_0x208e70];_0x118346&&_0x118346[_0x45f269(0xda2)][_0x45f269(0x315)]&&_0x118346['settings']['linkedWorldBookIds'][_0x45f269(0x12c2)](_0x49d22e=>_0x2f3c3c[_0x45f269(0xa58)](_0x49d22e));});let _0x53fe9e='';_0x2f3c3c['size']>0x0&&(_0x53fe9e+=_0xdafc04(0xf4a),_0x2f3c3c[_0xdafc04(0x12c2)](_0x3def29=>{const _0x4463c0=_0xdafc04,_0x14ac22=_0x42f206[_0x4463c0(0xab7)][_0x4463c0(0xb07)](_0x4c07a7=>_0x4c07a7['id']===_0x3def29);if(_0x14ac22){const _0x364d74=_0x14ac22[_0x4463c0(0x1316)][_0x4463c0(0xaf1)](_0x392966=>_0x392966[_0x4463c0(0x12fb)]!==![])[_0x4463c0(0xbf6)](_0x4845cf=>'-\x20'+_0x4845cf['content'])[_0x4463c0(0x56c)]('\x0a');_0x364d74&&(_0x53fe9e+=_0x4463c0(0x708)+_0x14ac22[_0x4463c0(0x132a)]+_0x4463c0(0x2a0)+_0x364d74);}}));const _0x1105a5=_0x42f206[_0xdafc04(0xab7)][_0xdafc04(0xb07)](_0x27f48d=>_0x27f48d[_0xdafc04(0x132a)]===_0xdafc04(0x104d));let _0x5ba68e='',_0x5e780f=[];_0x1105a5&&_0x1105a5['content'][_0xdafc04(0x12c2)](_0x401327=>{const _0x5d494c=_0xdafc04;_0x401327[_0x5d494c(0xcb4)][_0x5d494c(0xd8d)](_0x5d494c(0x1397))&&(_0x5ba68e+='\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a'+_0x401327['content']);if(_0x401327[_0x5d494c(0xcb4)]['includes']('NPC人设')){const _0x3b9b3e=_0x401327[_0x5d494c(0x1316)]['split']('\x0a');_0x3b9b3e[_0x5d494c(0x12c2)](_0x53db6c=>{const _0x29abdd=_0x5d494c,_0x5478b0=_0x53db6c[_0x29abdd(0x41c)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x5478b0&&_0x5e780f[_0x29abdd(0x129e)]({'name':_0x5478b0[0x1][_0x29abdd(0x2aa)](),'persona':_0x5478b0[0x2]['trim']()});});}});const _0x1df26e=_0x42f206[_0xdafc04(0x551)][_0xdafc04(0x308)]||'我',_0x1721af=_0x562836[_0xdafc04(0x131d)]>0x0&&_0x42f206[_0xdafc04(0x954)][_0x562836[0x0]]?_0x42f206[_0xdafc04(0x954)][_0x562836[0x0]]['settings'][_0xdafc04(0x65f)]:_0xdafc04(0x213);let _0x2651f2='';_0x562836[_0xdafc04(0x12c2)](_0x4498da=>{const _0x2e39ee=_0xdafc04,_0x5812d4=_0x42f206['chats'][_0x4498da];if(_0x5812d4){const _0x25a1f3=_0x5812d4['longTermMemory']&&_0x5812d4[_0x2e39ee(0x94a)][_0x2e39ee(0x131d)]>0x0?_0x5812d4[_0x2e39ee(0x94a)][_0x2e39ee(0xbf6)](_0x34afc6=>_0x34afc6['content'])[_0x2e39ee(0x56c)](';\x20'):'无',_0x3ead6c=_0x5812d4[_0x2e39ee(0x1d5)][_0x2e39ee(0x5b0)](-0xa)['map'](_0x2ea8a1=>(_0x2ea8a1['role']===_0x2e39ee(0xf86)?_0x1df26e:_0x5812d4['name'])+':\x20'+String(_0x2ea8a1[_0x2e39ee(0x1316)])['substring'](0x0,0x1e)+'...')[_0x2e39ee(0x56c)]('\x0a');_0x2651f2+=_0x2e39ee(0xcd6)+_0x5812d4[_0x2e39ee(0x132a)]+_0x2e39ee(0xf3b)+_0x5812d4[_0x2e39ee(0xda2)]['aiPersona']+_0x2e39ee(0x70d)+_0x25a1f3+_0x2e39ee(0x4a9)+_0x3ead6c+_0x2e39ee(0x4fa);}}),_0x5e780f[_0xdafc04(0x12c2)](_0xc6e228=>{const _0x12eca6=_0xdafc04;_0x2651f2+=_0x12eca6(0xcd6)+_0xc6e228[_0x12eca6(0x132a)]+_0x12eca6(0xf3b)+_0xc6e228[_0x12eca6(0x124d)]+'</persona>\x0a</character>\x0a';});const _0x451917=new Date(),_0x172b87=_0x451917[_0xdafc04(0xe43)](_0xdafc04(0xaa2),{'dateStyle':_0xdafc04(0xba7),'timeStyle':_0xdafc04(0xabe)}),_0x27543d=_0x42f206[_0xdafc04(0xf0)][_0xdafc04(0x69e)]||0xc,_0xf72ecb=_0x42f206[_0xdafc04(0xf0)][_0xdafc04(0x1274)]||0x14,_0x20fff1=_0xdafc04(0xa9)+_0x27543d+'到'+_0xf72ecb+_0xdafc04(0x1182)+_0x172b87+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“'+_0x1df26e+_0xdafc04(0xfe5)+_0x1df26e+_0xdafc04(0x12d1)+_0x5ba68e+'\x0a'+_0x53fe9e+'\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20'+_0x172b87+_0xdafc04(0xf6f)+_0x1df26e+_0xdafc04(0x7e)+_0x1721af+_0xdafc04(0x3f0)+_0x2651f2+_0xdafc04(0xa79);try{const _0x379989=[{'role':_0xdafc04(0xf86),'content':_0xdafc04(0xf12)}];let _0x192708=_0x2b79ba['includes'](_0xdafc04(0xfe3)),_0x2de7aa=_0x5d73db(_0x60e248,_0x190cd2,_0x20fff1,_0x379989);const _0x40f1cb=_0x192708?await fetch(_0x2de7aa[_0xdafc04(0x1377)],_0x2de7aa['data']):await fetch(_0x2b79ba+_0xdafc04(0xd7),{'method':_0xdafc04(0x1312),'headers':{'Content-Type':_0xdafc04(0xa0e),'Authorization':'Bearer\x20'+_0x190cd2},'body':JSON[_0xdafc04(0xc04)]({'model':_0x60e248,'messages':[{'role':_0xdafc04(0x1370),'content':_0x20fff1},..._0x379989],'temperature':_0x42f206[_0xdafc04(0xf0)][_0xdafc04(0xfdf)]||0x1})});if(!_0x40f1cb['ok'])throw new Error('API\x20错误:\x20'+_0x40f1cb['statusText']);const _0x452bb9=await _0x40f1cb['json'](),_0x3363cc=getGeminiResponseText(_0x452bb9),_0x2fee55=_0x3363cc[_0xdafc04(0x41c)](/\[[\s\S]*\]/);if(!_0x2fee55)throw new Error(_0xdafc04(0x42f)+_0x3363cc);const _0x4fa66c=JSON[_0xdafc04(0x44c)](_0x2fee55[0x0]);await _0x17d534[_0xdafc04(0xaf9)][_0xdafc04(0x415)](),await _0x17d534[_0xdafc04(0xaf9)][_0xdafc04(0xaad)](_0x4fa66c[_0xdafc04(0xbf6)](_0x22d4e7=>({..._0x22d4e7,'timestamp':Date[_0xdafc04(0x606)]()-Math['random']()*0x186a0}))),await _0x10bf4a();}catch(_0x477a8f){console[_0xdafc04(0xb61)]('生成豆瓣帖子失败:',_0x477a8f),await _0x34fce8('生成失败',_0xdafc04(0x1165)+_0x477a8f[_0xdafc04(0x7aa)]);}}async function _0x48cc0c(_0x5234c9){const _0xe8d140=_0x204348;_0x589d88(_0xe8d140(0x633)),_0x2c2275=_0x5234c9;const _0x1c2edb=await _0x17d534[_0xe8d140(0xaf9)][_0xe8d140(0x36d)](_0x5234c9);if(!_0x1c2edb){_0x589d88(_0xe8d140(0xca1));return;}document[_0xe8d140(0x458)](_0xe8d140(0xd58))[_0xe8d140(0x1a2)]=_0xe8d140(0xe58);let _0x3db28b=_0x4fd084,_0x3f1acb=_0x1c2edb[_0xe8d140(0x1176)];const _0x346816=_0x1c2edb[_0xe8d140(0xb85)]?Object[_0xe8d140(0x6eb)](_0x42f206[_0xe8d140(0x954)])[_0xe8d140(0xb07)](_0x396475=>!_0x396475[_0xe8d140(0x726)]&&_0x396475[_0xe8d140(0xa1)]===_0x1c2edb['authorOriginalName']):null;if(_0x346816)_0x3db28b=_0x346816[_0xe8d140(0xda2)][_0xe8d140(0x9c7)];else{const _0x21cc56=Object[_0xe8d140(0x6eb)](_0x42f206[_0xe8d140(0x954)])[_0xe8d140(0xb07)](_0x2b44cd=>!_0x2b44cd[_0xe8d140(0x726)]&&_0x2b44cd[_0xe8d140(0x132a)]===_0x1c2edb[_0xe8d140(0x1176)]);if(_0x21cc56)_0x3db28b=_0x21cc56[_0xe8d140(0xda2)]['aiAvatar'];else _0x1c2edb[_0xe8d140(0xe66)]&&(_0x3db28b=_0xe8d140(0x94c)+encodeURIComponent(_0x1c2edb[_0xe8d140(0xe66)]));}document['getElementById'](_0xe8d140(0xa63))['src']=_0x3db28b,document['getElementById'](_0xe8d140(0x404))['textContent']=_0x3f1acb,document[_0xe8d140(0x458)](_0xe8d140(0x517))[_0xe8d140(0x1a2)]=_0xe8d140(0x8f3)+_0x1c2edb[_0xe8d140(0x12b3)],document[_0xe8d140(0x458)]('douban-detail-post-title')['textContent']=_0x1c2edb[_0xe8d140(0x3b4)],document['getElementById']('douban-detail-content')[_0xe8d140(0x110d)]=_0x1c2edb['content'][_0xe8d140(0x33b)](/\n/g,_0xe8d140(0x1208)),document[_0xe8d140(0x458)](_0xe8d140(0x5e9))[_0xe8d140(0x577)]=_0x42f206[_0xe8d140(0x551)][_0xe8d140(0x5c6)],document['getElementById'](_0xe8d140(0xa8a))[_0xe8d140(0x8dd)]='';const _0xdef9dd=document[_0xe8d140(0x458)](_0xe8d140(0xf0f));_0xdef9dd['innerHTML']='';if(_0x1c2edb['comments']&&_0x1c2edb[_0xe8d140(0x946)][_0xe8d140(0x131d)]>0x0){const _0x587a5f=new Map();_0x1c2edb[_0xe8d140(0x946)][_0xe8d140(0x12c2)](_0x460f73=>{const _0x1a9ddd=_0xe8d140;let _0x5b9d8c=_0x4fd084;const _0x45c211=_0x42f206[_0x1a9ddd(0x551)][_0x1a9ddd(0x308)]||'我',_0x3c5635=_0x460f73['commenter'];if(_0x587a5f[_0x1a9ddd(0x31c)](_0x3c5635))_0x5b9d8c=_0x587a5f['get'](_0x3c5635);else{if(_0x3c5635===_0x45c211)_0x5b9d8c=_0x42f206[_0x1a9ddd(0x551)][_0x1a9ddd(0x5c6)];else{if(_0x3c5635===_0x1c2edb[_0x1a9ddd(0x1176)])_0x5b9d8c=_0x3db28b;else{const _0x422d5e=_0x460f73[_0x1a9ddd(0x5ae)]?Object[_0x1a9ddd(0x6eb)](_0x42f206['chats'])[_0x1a9ddd(0xb07)](_0xf6edc0=>!_0xf6edc0[_0x1a9ddd(0x726)]&&_0xf6edc0[_0x1a9ddd(0xa1)]===_0x460f73[_0x1a9ddd(0x5ae)]):null;if(_0x422d5e)_0x5b9d8c=_0x422d5e['settings']['aiAvatar'];else{const _0x50dfb9=Object[_0x1a9ddd(0x6eb)](_0x42f206['chats'])[_0x1a9ddd(0xb07)](_0x599551=>!_0x599551['isGroup']&&_0x599551[_0x1a9ddd(0x132a)]===_0x3c5635);if(_0x50dfb9)_0x5b9d8c=_0x50dfb9[_0x1a9ddd(0xda2)][_0x1a9ddd(0x9c7)];else _0x460f73[_0x1a9ddd(0x1238)]&&(_0x5b9d8c=_0x1a9ddd(0x94c)+encodeURIComponent(_0x460f73['avatar_prompt']));}}}_0x587a5f[_0x1a9ddd(0xe71)](_0x3c5635,_0x5b9d8c);}const _0x160f9c=document['createElement'](_0x1a9ddd(0x1323));_0x160f9c[_0x1a9ddd(0x69b)]=_0x1a9ddd(0xcc2),_0x160f9c['innerHTML']=_0x1a9ddd(0x434)+_0x5b9d8c+_0x1a9ddd(0x29c)+_0x3c5635+_0x1a9ddd(0xed)+_0x460f73[_0x1a9ddd(0xdd5)][_0x1a9ddd(0x33b)](/\n/g,'<br>')+_0x1a9ddd(0x6ed),_0xdef9dd[_0x1a9ddd(0x1079)](_0x160f9c);});}else _0xdef9dd[_0xe8d140(0x110d)]=_0xe8d140(0x7ac);const _0x2f082c=document[_0xe8d140(0x458)]('douban-detail-content-wrapper');if(_0x2f082c)_0x2f082c['scrollTop']=0x0;}async function _0x3f7dee(){const _0x1e76d9=_0x204348;if(!_0x2c2275)return;const _0xc91825=document['getElementById'](_0x1e76d9(0xa8a)),_0x21ae02=_0xc91825[_0x1e76d9(0x8dd)]['trim']();if(!_0x21ae02)return;const _0x31a1ba=await _0x17d534[_0x1e76d9(0xaf9)][_0x1e76d9(0x36d)](_0x2c2275);if(!_0x31a1ba)return;!_0x31a1ba[_0x1e76d9(0x946)]&&(_0x31a1ba['comments']=[]);const _0x3eace1=_0x42f206['qzoneSettings']['nickname']||'我';_0x31a1ba[_0x1e76d9(0x946)][_0x1e76d9(0x129e)]({'commenter':_0x3eace1,'text':_0x21ae02}),_0x31a1ba[_0x1e76d9(0x84b)]++,await _0x17d534[_0x1e76d9(0xaf9)]['put'](_0x31a1ba),_0xc91825['value']='',await _0x48cc0c(_0x2c2275);}async function _0x1c09ad(){const _0x33600c=_0x204348;if(!_0x2c2275)return;const _0x17f6ac=_0x2c2275,_0x537b00=await _0x17d534['doubanPosts'][_0x33600c(0x36d)](_0x17f6ac);if(!_0x537b00)return;const _0x3c6d98=_0x537b00[_0x33600c(0x946)]&&_0x537b00[_0x33600c(0x946)][_0x33600c(0x5b0)](-0x1)[0x0];if(!_0x3c6d98){alert(_0x33600c(0x680));return;}await _0x34fce8(_0x33600c(0x12b9),'正在请求AI角色们加入讨论...');try{const {proxyUrl:_0x1b7bdf,apiKey:_0x4c9eeb,model:_0x1cd19b}=_0x42f206[_0x33600c(0x5cb)];if(!_0x1b7bdf||!_0x4c9eeb||!_0x1cd19b)throw new Error('API未配置，无法生成内容。');const _0x3d25d3=_0x42f206[_0x33600c(0x551)][_0x33600c(0x308)]||'我',_0x1485f3=_0x42f206[_0x33600c(0x954)][Object[_0x33600c(0x634)](_0x42f206[_0x33600c(0x954)])[0x0]]?.[_0x33600c(0xda2)]['myPersona']||_0x33600c(0x213),_0x407f5f=new Map();_0x537b00['comments']&&_0x537b00[_0x33600c(0x946)][_0x33600c(0x12c2)](_0x40ba56=>{const _0x2bf7cc=_0x33600c,_0x3a99bb=(_0x42f206[_0x2bf7cc(0xf0)][_0x2bf7cc(0x9b1)]||[])[_0x2bf7cc(0x593)](_0x44350b=>_0x42f206[_0x2bf7cc(0x954)][_0x44350b]?.['name']===_0x40ba56[_0x2bf7cc(0xb52)]);!_0x3a99bb&&_0x40ba56[_0x2bf7cc(0x1238)]&&_0x407f5f[_0x2bf7cc(0xe71)](_0x40ba56[_0x2bf7cc(0xb52)],_0x40ba56[_0x2bf7cc(0x1238)]);});let _0x40dfcd=_0x33600c(0xd3c);_0x407f5f['size']>0x0?(_0x40dfcd+=_0x33600c(0x6b0),_0x407f5f[_0x33600c(0x12c2)]((_0x42ac96,_0x2f31b4)=>{const _0x4ecd32=_0x33600c;_0x40dfcd+=_0x4ecd32(0x1293)+_0x2f31b4+_0x4ecd32(0x619)+_0x42ac96+'\x22\x0a';})):_0x40dfcd+=_0x33600c(0x1105);const _0x3775cb=_0x42f206[_0x33600c(0xab7)]['find'](_0xd19f51=>_0xd19f51[_0x33600c(0x132a)]===_0x33600c(0x104d));let _0x1335b9=[];_0x3775cb&&_0x3775cb[_0x33600c(0x1316)]['forEach'](_0x4e55a7=>{const _0x9b69f0=_0x33600c;if(_0x4e55a7[_0x9b69f0(0xcb4)][_0x9b69f0(0xd8d)]('NPC人设')){const _0x4bcf7e=_0x4e55a7[_0x9b69f0(0x1316)][_0x9b69f0(0x90b)]('\x0a');_0x4bcf7e[_0x9b69f0(0x12c2)](_0x5a51b8=>{const _0x548c25=_0x9b69f0,_0x39f0c4=_0x5a51b8[_0x548c25(0x41c)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x39f0c4&&_0x1335b9['push']({'name':_0x39f0c4[0x1]['trim'](),'persona':_0x39f0c4[0x2][_0x548c25(0x2aa)]()});});}});let _0x18acaf='';const _0x1cc3bf=_0x42f206['globalSettings'][_0x33600c(0x9b1)]||[];_0x1cc3bf[_0x33600c(0x12c2)](_0x5bbe49=>{const _0x5062ee=_0x33600c,_0x5bc441=_0x42f206[_0x5062ee(0x954)][_0x5bbe49];if(_0x5bc441){const _0x1093f7=_0x5bc441[_0x5062ee(0x94a)]&&_0x5bc441[_0x5062ee(0x94a)][_0x5062ee(0x131d)]>0x0?_0x5bc441[_0x5062ee(0x94a)][_0x5062ee(0xbf6)](_0xd6de4d=>_0xd6de4d[_0x5062ee(0x1316)])[_0x5062ee(0x56c)](';\x20'):'无',_0x3f29ff=_0x5bc441[_0x5062ee(0x1d5)][_0x5062ee(0x5b0)](-0xa)[_0x5062ee(0xbf6)](_0xbe040d=>(_0xbe040d[_0x5062ee(0xaeb)]==='user'?_0x3d25d3:_0x5bc441[_0x5062ee(0x132a)])+':\x20'+String(_0xbe040d[_0x5062ee(0x1316)])[_0x5062ee(0xa6d)](0x0,0x1e)+_0x5062ee(0x10a0))[_0x5062ee(0x56c)]('\x0a');_0x18acaf+=_0x5062ee(0x12a6)+_0x5bc441[_0x5062ee(0x132a)]+':\x20'+_0x5bc441['settings'][_0x5062ee(0x31d)][_0x5062ee(0xa6d)](0x0,0x32)+_0x5062ee(0x7f8)+_0x1093f7+']\x20[最近对话:\x20'+_0x3f29ff+']';}}),_0x1335b9[_0x33600c(0x12c2)](_0x4c5ddf=>{const _0x40f46e=_0x33600c;_0x18acaf+=_0x40f46e(0x12a6)+_0x4c5ddf[_0x40f46e(0x132a)]+':\x20'+_0x4c5ddf[_0x40f46e(0x124d)];});const _0xb0601=new Date(),_0x5b20a6=_0xb0601['toLocaleString']('zh-CN',{'dateStyle':'full','timeStyle':_0x33600c(0xabe)}),_0x3b5f7f=_0x33600c(0xdb6)+_0x3d25d3+_0x33600c(0x673)+_0x5b20a6+_0x33600c(0xdd2)+_0x3d25d3+'”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“'+_0x3d25d3+'”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《'+_0x537b00[_0x33600c(0x3b4)]+_0x33600c(0x72d)+_0x537b00[_0x33600c(0x1176)]+'\x0a-\x20**帖子内容摘要**:\x20'+_0x537b00[_0x33600c(0x1316)]['substring'](0x0,0x64)+_0x33600c(0x4c0)+_0x537b00['comments'][_0x33600c(0xbf6)](_0x35b482=>'-\x20'+_0x35b482[_0x33600c(0xb52)]+':\x20'+_0x35b482[_0x33600c(0xdd5)])[_0x33600c(0x56c)]('\x0a')+'\x0a\x0a'+_0x40dfcd+_0x33600c(0xb29)+_0x5b20a6+_0x33600c(0x12be)+_0x3d25d3+_0x33600c(0x7e)+_0x1485f3+'\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a'+_0x18acaf+_0x33600c(0xa9b),_0x1f84cc=[{'role':_0x33600c(0xf86),'content':'请根据以上情景，生成新的评论。'}];let _0x45ce85=_0x1b7bdf[_0x33600c(0xd8d)](_0x33600c(0xfe3)),_0x526955=_0x5d73db(_0x1cd19b,_0x4c9eeb,_0x3b5f7f,_0x1f84cc);const _0x2d48ce=_0x45ce85?await fetch(_0x526955['url'],_0x526955['data']):await fetch(_0x1b7bdf+'/v1/chat/completions',{'method':_0x33600c(0x1312),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x4c9eeb},'body':JSON['stringify']({'model':_0x1cd19b,'messages':[{'role':_0x33600c(0x1370),'content':_0x3b5f7f},..._0x1f84cc],'temperature':_0x42f206['globalSettings'][_0x33600c(0xfdf)]||0x1})});if(!_0x2d48ce['ok'])throw new Error(_0x33600c(0x676)+_0x2d48ce[_0x33600c(0xf0c)]);const _0x3790ad=await _0x2d48ce[_0x33600c(0xaef)](),_0x579e9e=getGeminiResponseText(_0x3790ad),_0x5a655c=_0x579e9e['replace'](/^```json\s*/,'')[_0x33600c(0x33b)](/```$/,''),_0x1dd426=JSON[_0x33600c(0x44c)](_0x5a655c);Array['isArray'](_0x1dd426)&&_0x1dd426[_0x33600c(0x131d)]>0x0&&(_0x537b00[_0x33600c(0x946)][_0x33600c(0x129e)](..._0x1dd426),_0x537b00['commentsCount']+=_0x1dd426[_0x33600c(0x131d)],await _0x17d534[_0x33600c(0xaf9)][_0x33600c(0xf3f)](_0x537b00)),await _0x48cc0c(_0x17f6ac),_0x424532();}catch(_0x4a6a9f){console['error']('等待回复失败:',_0x4a6a9f),await _0x34fce8(_0x33600c(0x96d),_0x33600c(0xbe4)+_0x4a6a9f[_0x33600c(0x7aa)]);}}async function _0x35711a(){const _0x5b16d7=_0x204348,_0x5ace4f=document[_0x5b16d7(0x458)](_0x5b16d7(0x10e7)),_0x163f12=document[_0x5b16d7(0x458)](_0x5b16d7(0x8bb));_0x163f12[_0x5b16d7(0x110d)]='';const _0x9aa191=Object[_0x5b16d7(0x6eb)](_0x42f206['chats'])[_0x5b16d7(0xaf1)](_0x1cbe29=>!_0x1cbe29[_0x5b16d7(0x726)]),_0x6cc7a1=new Set(_0x42f206[_0x5b16d7(0xf0)]['doubanActiveCharacterIds']||[]);_0x9aa191[_0x5b16d7(0x131d)]===0x0?_0x163f12[_0x5b16d7(0x110d)]=_0x5b16d7(0x236):_0x9aa191[_0x5b16d7(0x12c2)](_0x3dd9b9=>{const _0x383f4a=_0x5b16d7,_0x2852a7=document[_0x383f4a(0xe7d)](_0x383f4a(0x1323));_0x2852a7[_0x383f4a(0x69b)]='contact-picker-item',_0x2852a7[_0x383f4a(0x110d)]=_0x383f4a(0xc30)+_0x3dd9b9['id']+'\x22\x20'+(_0x6cc7a1[_0x383f4a(0x31c)](_0x3dd9b9['id'])?'checked':'')+_0x383f4a(0xecb)+(_0x3dd9b9[_0x383f4a(0xda2)][_0x383f4a(0x9c7)]||_0x4fd084)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x3dd9b9[_0x383f4a(0x132a)]+_0x383f4a(0x144b),_0x163f12[_0x383f4a(0x1079)](_0x2852a7);}),_0x5ace4f['classList'][_0x5b16d7(0xa58)]('visible');}async function _0x41244a(){const _0x24bc06=_0x204348,_0x3a1080=document[_0x24bc06(0x102a)](_0x24bc06(0xe6e)),_0x2dfafd=Array[_0x24bc06(0xca2)](_0x3a1080)[_0x24bc06(0xbf6)](_0x21b517=>_0x21b517[_0x24bc06(0x1f4)][_0x24bc06(0xfca)]);_0x42f206['globalSettings'][_0x24bc06(0x9b1)]=_0x2dfafd,await _0x17d534[_0x24bc06(0xf0)][_0x24bc06(0xf3f)](_0x42f206[_0x24bc06(0xf0)]),document[_0x24bc06(0x458)](_0x24bc06(0x10e7))[_0x24bc06(0x11c2)]['remove'](_0x24bc06(0x67d)),await _0x2f5be7();}document['getElementById']('douban-cast-select-btn')['addEventListener'](_0x204348(0x1122),_0x35711a),document[_0x204348(0x458)](_0x204348(0xd64))[_0x204348(0xd85)]('click',()=>{const _0x4c137d=_0x204348;document[_0x4c137d(0x458)]('douban-cast-modal')[_0x4c137d(0x11c2)][_0x4c137d(0x1097)](_0x4c137d(0x67d));}),document['getElementById'](_0x204348(0x243))[_0x204348(0xd85)]('click',_0x41244a),document[_0x204348(0x458)]('douban-cast-list')[_0x204348(0xd85)](_0x204348(0x1122),_0x564524=>{const _0x264b01=_0x204348,_0x43b16b=_0x564524['target'][_0x264b01(0xe87)]('.contact-picker-item');if(_0x43b16b){const _0x2dce4e=_0x43b16b[_0x264b01(0x586)]('.douban-cast-checkbox');_0x2dce4e&&_0x564524[_0x264b01(0x12df)]!==_0x2dce4e&&(_0x2dce4e[_0x264b01(0x8f7)]=!_0x2dce4e[_0x264b01(0x8f7)]);}});async function _0x398e06(_0x20c325){const _0x50bcf7=_0x204348;if(!_0x20c325)return;const _0x547072=await _0x2532b9(_0x50bcf7(0xd37),_0x50bcf7(0x36a),{'confirmText':_0x50bcf7(0x2f0)});if(!_0x547072)return;try{const _0x332b66=await _0x20c325[_0x50bcf7(0xdd5)](),_0x56813f=JSON[_0x50bcf7(0x44c)](_0x332b66);if(!_0x56813f[_0x50bcf7(0xef2)]&&!_0x56813f['globalCss']&&!_0x56813f['appIcons'])throw new Error(_0x50bcf7(0xbed));Object[_0x50bcf7(0xece)](_0x42f206['globalSettings'],_0x56813f),await _0x17d534['globalSettings'][_0x50bcf7(0xf3f)](_0x42f206[_0x50bcf7(0xf0)]),_0x3f8328(),_0x4eca92(),_0x427694(),_0x3abb21(),_0x410076(_0x42f206['globalSettings']['globalCss']),_0x393d41(_0x42f206[_0x50bcf7(0xf0)][_0x50bcf7(0xafb)]),_0x3ad72c(),_0x19044c(),_0x3b3899(),await _0x34fce8(_0x50bcf7(0xf98),_0x50bcf7(0x652));}catch(_0x4bdba8){console[_0x50bcf7(0xb61)](_0x50bcf7(0x12d2),_0x4bdba8),await _0x34fce8('导入失败',_0x50bcf7(0x20e)+_0x4bdba8[_0x50bcf7(0x7aa)]);}}async function _0x59d5f7(_0x3f9a77){const _0x46eefc=_0x204348;console['log'](_0x46eefc(0x923)+_0x3f9a77['toFixed'](0x1)+_0x46eefc(0x10e));const _0x538ccb=Object[_0x46eefc(0x6eb)](_0x42f206[_0x46eefc(0x954)])[_0x46eefc(0xaf1)](_0x16e9a9=>!_0x16e9a9[_0x46eefc(0x726)]&&_0x16e9a9[_0x46eefc(0xda2)][_0x46eefc(0x12cd)]&&_0x16e9a9[_0x46eefc(0x569)]?.[_0x46eefc(0x13b2)]===_0x46eefc(0xe97));if(_0x538ccb[_0x46eefc(0x131d)]===0x0){console[_0x46eefc(0x7d1)](_0x46eefc(0x9de));return;}for(const _0x2aa941 of _0x538ccb){const _0x67e2f3=_0x2aa941[_0x46eefc(0xda2)][_0x46eefc(0x9c9)]||0xf,_0x240045=_0x2aa941[_0x46eefc(0x2d2)]?(Date[_0x46eefc(0x606)]()-_0x2aa941['lastActionTimestamp'])/(0x3e8*0x3c):Infinity;_0x3f9a77>_0x67e2f3&&_0x240045>_0x67e2f3&&(Math['random']()<0.3&&(console['log']('角色\x20\x22'+_0x2aa941[_0x46eefc(0x132a)]+_0x46eefc(0xd7b)),Math[_0x46eefc(0x23a)]()<0.7?await _0x481cbe(_0x2aa941['id']):console[_0x46eefc(0x7d1)](_0x46eefc(0x714)+_0x2aa941[_0x46eefc(0x132a)]+_0x46eefc(0xc9c))));}}function _0x58db26(){const _0x329458=_0x204348;if(!_0x42f206[_0x329458(0x81d)])return;const _0x5cb560=_0x42f206[_0x329458(0x954)][_0x42f206[_0x329458(0x81d)]];document[_0x329458(0x458)]('keyword-search-input')[_0x329458(0x8dd)]='',document[_0x329458(0x458)](_0x329458(0xa3))[_0x329458(0x8dd)]='',document[_0x329458(0x458)](_0x329458(0xde3))['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>',_0x589d88(_0x329458(0x13d6));}async function _0x3c8479(){const _0x585aef=_0x204348,_0x5c50b9=_0x42f206['chats'][_0x42f206[_0x585aef(0x81d)]];if(!_0x5c50b9)return;const _0x4707ff=document[_0x585aef(0x458)]('keyword-search-input')[_0x585aef(0x8dd)]['trim']()[_0x585aef(0xb15)](),_0x3c1c1f=document[_0x585aef(0x458)]('date-search-input')['value'];if(!_0x4707ff&&!_0x3c1c1f){alert('请输入关键词或选择一个日期。');return;}let _0x420954=_0x5c50b9['history'][_0x585aef(0xaf1)](_0x36ecae=>!_0x36ecae[_0x585aef(0x7a0)]);_0x4707ff&&(_0x420954=_0x420954[_0x585aef(0xaf1)](_0x16a312=>{const _0x59d238=_0x585aef;let _0x485a1a='';if(typeof _0x16a312['content']===_0x59d238(0x861))_0x485a1a=_0x16a312[_0x59d238(0x1316)];else{if(_0x16a312['type']===_0x59d238(0xefa))_0x485a1a=_0x16a312[_0x59d238(0x1316)];else{if(_0x16a312[_0x59d238(0x259)]===_0x59d238(0xb1e)||_0x16a312[_0x59d238(0x259)]===_0x59d238(0x305))_0x485a1a=_0x16a312[_0x59d238(0x1316)];else{if(_0x16a312[_0x59d238(0x259)]===_0x59d238(0x22b))_0x485a1a=(_0x16a312[_0x59d238(0x4d9)]||'')+'\x20'+(_0x16a312[_0x59d238(0x4e9)]||'');else _0x16a312['quote']&&(_0x485a1a=_0x16a312['content']);}}}return _0x485a1a[_0x59d238(0xb15)]()[_0x59d238(0xd8d)](_0x4707ff);}));if(_0x3c1c1f){const _0x52a46c=new Date(_0x3c1c1f),_0x3d4c22=new Date(_0x52a46c[_0x585aef(0xff8)](0x0,0x0,0x0,0x0))[_0x585aef(0xf08)](),_0x15cea7=new Date(_0x52a46c[_0x585aef(0xff8)](0x17,0x3b,0x3b,0x3e7))[_0x585aef(0xf08)]();_0x420954=_0x420954[_0x585aef(0xaf1)](_0x23af91=>_0x23af91[_0x585aef(0xf16)]>=_0x3d4c22&&_0x23af91[_0x585aef(0xf16)]<=_0x15cea7);}await _0x13b539(_0x420954);}async function _0x13b539(_0x355e13){const _0x957ebb=_0x204348,_0x2a42d2=document['getElementById'](_0x957ebb(0xde3)),_0x311155=_0x42f206[_0x957ebb(0x954)][_0x42f206[_0x957ebb(0x81d)]];_0x2a42d2[_0x957ebb(0x110d)]='';if(_0x355e13['length']===0x0){_0x2a42d2[_0x957ebb(0x110d)]=_0x957ebb(0x62a);return;}let _0x1dfb64='';for(const _0x237c55 of _0x355e13){const _0x25a601=new Date(_0x237c55[_0x957ebb(0xf16)]),_0x541c1a=_0x25a601[_0x957ebb(0x1423)]();if(_0x541c1a!==_0x1dfb64){const _0x2a5561=document[_0x957ebb(0xe7d)](_0x957ebb(0x1323));_0x2a5561['className']=_0x957ebb(0x12c7),_0x2a5561[_0x957ebb(0x1a2)]=_0x957ebb(0xba8)+_0x25a601[_0x957ebb(0xc2a)]()+'年'+(_0x25a601[_0x957ebb(0x63a)]()+0x1)+'月'+_0x25a601[_0x957ebb(0x14c)]()+_0x957ebb(0x1215),_0x2a42d2[_0x957ebb(0x1079)](_0x2a5561),_0x1dfb64=_0x541c1a;}const _0x2dbb33=await _0x4b8ea5(_0x237c55,_0x311155);_0x2dbb33&&(_0x2dbb33[_0x957ebb(0x1104)]['cursor']=_0x957ebb(0xa6b),_0x2dbb33['addEventListener']('click',()=>_0x53b93d(_0x237c55[_0x957ebb(0xf16)])),_0x2a42d2[_0x957ebb(0x1079)](_0x2dbb33));}}async function _0x53b93d(_0x9a51e6){const _0x3074db=_0x204348,_0x105470=_0x42f206['activeChatId'];if(!_0x105470)return;_0x589d88(_0x3074db(0xd99)),setTimeout(async()=>{const _0x47e4fb=_0x3074db,_0x52657b=document[_0x47e4fb(0x458)]('chat-messages'),_0x210ba0=_0x47e4fb(0x12da)+_0x9a51e6+'\x22]';let _0x35d10b=_0x52657b[_0x47e4fb(0x586)](_0x210ba0),_0x3a6610=0x0;const _0x4c85ef=0x14;while(!_0x35d10b&&_0x3a6610<_0x4c85ef){const _0x4be128=document[_0x47e4fb(0x458)](_0x47e4fb(0xde6));if(_0x4be128)console[_0x47e4fb(0x7d1)]('目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20'+(_0x3a6610+0x1)+')'),await _0x2a9557(),_0x35d10b=_0x52657b['querySelector'](_0x210ba0),_0x3a6610++;else break;}_0x11e348(_0x9a51e6);},0xc8);}async function _0x45119a(){const _0x5b49c7=_0x204348;document[_0x5b49c7(0x458)](_0x5b49c7(0x123b))['value']='',document[_0x5b49c7(0x458)]('date-search-input')[_0x5b49c7(0x8dd)]='',await _0x13b539(_0x42f206[_0x5b49c7(0x954)][_0x42f206[_0x5b49c7(0x81d)]][_0x5b49c7(0x1d5)][_0x5b49c7(0xaf1)](_0x51b206=>!_0x51b206[_0x5b49c7(0x7a0)]));}async function _0x2566cf(_0x2fd996=![],_0x596ebf=null,_0x83ae0e=null){const _0x4ea475=_0x204348,_0x3715a6=document[_0x4ea475(0x458)](_0x4ea475(0xc33)),_0xecee6c=document[_0x4ea475(0x458)]('my-frame-grid'),_0x4c984e=_0x42f206[_0x4ea475(0x954)][_0x42f206['activeChatId']];_0x3715a6[_0x4ea475(0x110d)]='',_0xecee6c[_0x4ea475(0x110d)]='';const _0x4e8049=await _0x17d534['customAvatarFrames'][_0x4ea475(0x511)](),_0x349c58=[..._0x3f8fb4,..._0x4e8049];document[_0x4ea475(0x586)](_0x4ea475(0x36c))['style'][_0x4ea475(0x4db)]=_0x2fd996?_0x4ea475(0x464):_0x4ea475(0x82b),document[_0x4ea475(0x458)](_0x4ea475(0x375))[_0x4ea475(0x1104)][_0x4ea475(0x4db)]='block',document[_0x4ea475(0x458)](_0x4ea475(0x6c0))['style'][_0x4ea475(0x4db)]=_0x4ea475(0x464),document[_0x4ea475(0x458)](_0x4ea475(0xaf8))['classList'][_0x4ea475(0xa58)](_0x4ea475(0xfe1)),document[_0x4ea475(0x458)](_0x4ea475(0x2fd))[_0x4ea475(0x11c2)][_0x4ea475(0x1097)]('active');if(_0x2fd996)_0x349c58[_0x4ea475(0x12c2)](_0x45e23a=>{const _0xc2f8af=_0x4ea475,_0x350e64=_0x14dd34(_0x45e23a,'my',_0x596ebf);_0x45e23a[_0xc2f8af(0x1377)]===_0x83ae0e&&_0x350e64['classList'][_0xc2f8af(0xa58)]('selected'),_0x3715a6[_0xc2f8af(0x1079)](_0x350e64);});else{const _0x589d34=_0x4c984e[_0x4ea475(0xda2)]['aiAvatar']||_0x4fd084,_0x324f2c=_0x4c984e['settings'][_0x4ea475(0xa6)]||(_0x4c984e['isGroup']?_0x502840:_0x4fd084);_0x349c58[_0x4ea475(0x12c2)](_0x483961=>{const _0x4f7026=_0x4ea475,_0x5004c9=_0x14dd34(_0x483961,'ai',_0x589d34);if(_0x483961['url']===_0x1216ef['ai'])_0x5004c9[_0x4f7026(0x11c2)][_0x4f7026(0xa58)](_0x4f7026(0x500));_0x3715a6[_0x4f7026(0x1079)](_0x5004c9);const _0x264748=_0x14dd34(_0x483961,'my',_0x324f2c);if(_0x483961[_0x4f7026(0x1377)]===_0x1216ef['my'])_0x264748[_0x4f7026(0x11c2)]['add']('selected');_0xecee6c[_0x4f7026(0x1079)](_0x264748);});}}function _0x14dd34(_0x9fc6e8,_0x34d232,_0x4d7819){const _0x58490f=_0x204348,_0x533498=document[_0x58490f(0xe7d)](_0x58490f(0x1323));_0x533498[_0x58490f(0x69b)]=_0x58490f(0x5fc),_0x533498[_0x58490f(0x1f4)][_0x58490f(0x141a)]=_0x9fc6e8[_0x58490f(0x1377)],_0x533498[_0x58490f(0x316)]=_0x9fc6e8[_0x58490f(0x132a)];const _0x23a9aa=typeof _0x9fc6e8['id']===_0x58490f(0x1117),_0x54d942=_0x23a9aa?_0x58490f(0x13c2)+_0x9fc6e8['id']+_0x58490f(0xcf3):'';return _0x533498['innerHTML']=_0x58490f(0x84c)+_0x54d942+_0x58490f(0x335)+_0x4d7819+_0x58490f(0xe5e)+(_0x9fc6e8[_0x58490f(0x1377)]?_0x58490f(0xfa9)+_0x9fc6e8['url']+'\x22\x20class=\x22preview-frame\x22>':'')+_0x58490f(0x104c),_0x533498[_0x58490f(0xd85)](_0x58490f(0x1122),_0x4dae4e=>{const _0xabe076=_0x58490f;if(_0x4dae4e['target'][_0xabe076(0x11c2)][_0xabe076(0x526)](_0xabe076(0x1d3)))return;if(_0x35df22){if(_0x23a9aa){const _0x33a23b=parseInt(_0x9fc6e8['id']);_0x533498[_0xabe076(0x11c2)][_0xabe076(0x1270)](_0xabe076(0x500)),_0x1e8e3d['has'](_0x33a23b)?_0x1e8e3d[_0xabe076(0x195)](_0x33a23b):_0x1e8e3d['add'](_0x33a23b),_0x38bad8();}}else{_0x1216ef[_0x34d232]=_0x9fc6e8[_0xabe076(0x1377)];const _0x1c3261=_0x34d232==='ai'?document[_0xabe076(0x458)](_0xabe076(0xc33)):document[_0xabe076(0x458)](_0xabe076(0x37a));_0x1c3261[_0xabe076(0x102a)](_0xabe076(0xbcd))[_0xabe076(0x12c2)](_0x2a6f8d=>_0x2a6f8d[_0xabe076(0x11c2)][_0xabe076(0x1097)](_0xabe076(0x500))),_0x533498[_0xabe076(0x11c2)][_0xabe076(0xa58)]('selected');}}),_0x533498;}async function _0x4663c7(){const _0x26d7ca=_0x204348,_0x354930=document[_0x26d7ca(0x458)](_0x26d7ca(0x4d5)),_0x459d02=await new Promise(_0x46999b=>{const _0x93bf1b=_0x26d7ca,_0x2e979d=_0x15cdc0=>{const _0x17ffe8=_0x1a5b;_0x46999b(_0x15cdc0[_0x17ffe8(0x12df)][_0x17ffe8(0x1a9)][0x0]||null),_0x354930[_0x17ffe8(0x13ac)]('change',_0x2e979d);};_0x354930[_0x93bf1b(0xd85)](_0x93bf1b(0x26a),_0x2e979d,{'once':!![]}),_0x354930['click']();});if(!_0x459d02)return;const _0x33f539=await _0x335e57(_0x26d7ca(0xd60),_0x26d7ca(0x184));if(!_0x33f539||!_0x33f539[_0x26d7ca(0x2aa)]())return;const _0x3adf93=await new Promise(_0x14a8ff=>{const _0x4030e6=_0x26d7ca,_0x3f8b4e=new FileReader();_0x3f8b4e[_0x4030e6(0x11fa)]=()=>_0x14a8ff(_0x3f8b4e[_0x4030e6(0x2ed)]),_0x3f8b4e[_0x4030e6(0x96e)](_0x459d02);});await _0x17d534['customAvatarFrames']['add']({'name':_0x33f539['trim'](),'url':_0x3adf93}),_0x2566cf(_0x1ccdc4);}async function _0x19084a(){const _0xd1757e=_0x204348,_0x26dd01=_0xd1757e(0x5bf),_0x5300f6=await _0x335e57(_0xd1757e(0xed8),_0xd1757e(0xa67),'',_0xd1757e(0xb43),_0xd1757e(0x1234)+_0x26dd01+_0xd1757e(0xd36));if(!_0x5300f6||!_0x5300f6[_0xd1757e(0x2aa)]())return;const _0x5b07a2=_0x5300f6[_0xd1757e(0x2aa)]()[_0xd1757e(0x90b)]('\x0a'),_0x1e7c68=[];let _0x4de996=0x0;for(const _0x3b2d40 of _0x5b07a2){const _0x57fdfb=_0x3b2d40[_0xd1757e(0x41c)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x57fdfb)_0x1e7c68[_0xd1757e(0x129e)]({'name':_0x57fdfb[0x1][_0xd1757e(0x2aa)](),'url':_0x57fdfb[0x2][_0xd1757e(0x2aa)]()});else _0x3b2d40[_0xd1757e(0x2aa)]()&&_0x4de996++;}_0x1e7c68[_0xd1757e(0x131d)]>0x0&&(await _0x17d534['customAvatarFrames'][_0xd1757e(0xaad)](_0x1e7c68),_0x2566cf(_0x1ccdc4),await _0x34fce8('导入成功','成功导入\x20'+_0x1e7c68['length']+_0xd1757e(0x9c3))),_0x4de996>0x0&&await _0x34fce8('部分失败','有\x20'+_0x4de996+_0xd1757e(0xc0d));}async function _0x432a58(_0x2c0e2c){const _0x78f78a=_0x204348,_0x3bb872=await _0x17d534[_0x78f78a(0xaa5)][_0x78f78a(0x36d)](_0x2c0e2c);if(!_0x3bb872)return;const _0x1198b1=await _0x2532b9(_0x78f78a(0x1ef),'确定要删除头像框\x20“'+_0x3bb872['name']+'”\x20吗？',{'confirmButtonClass':_0x78f78a(0x4d3)});_0x1198b1&&(await _0x17d534[_0x78f78a(0xaa5)][_0x78f78a(0x195)](_0x2c0e2c),_0x2566cf(_0x1ccdc4));}let _0x21ba61=0x0;const _0x5998fd=0x2;function _0x56b1e0(){const _0x3343bc=_0x204348,_0x2df1f4=document['getElementById'](_0x3343bc(0x2e6)),_0x440917=document['getElementById'](_0x3343bc(0x204)),_0x2d24a5=document[_0x3343bc(0x102a)]('.pagination-dot');let _0x1b87bb=0x0,_0x4dceae=0x0,_0x22b537=0x0,_0x2202f1=![],_0x4fd36b=!![];const _0xea3fa6=()=>{const _0x17948f=_0x3343bc;_0x440917[_0x17948f(0x1104)][_0x17948f(0xb7e)]=_0x17948f(0xd86)+_0x21ba61*(0x64/_0x5998fd)+'%)',_0x2d24a5[_0x17948f(0x12c2)]((_0x47e2e9,_0xd6c2a4)=>{const _0x42500f=_0x17948f;_0x47e2e9[_0x42500f(0x11c2)][_0x42500f(0x1270)](_0x42500f(0xfe1),_0xd6c2a4===_0x21ba61);});},_0x23fa2c=_0x1f62b0=>{const _0x79f7c7=_0x3343bc;_0x2202f1=!![],_0x4fd36b=!![],_0x1b87bb=_0x1f62b0[_0x79f7c7(0x259)][_0x79f7c7(0xd8d)]('mouse')?_0x1f62b0[_0x79f7c7(0xb60)]:_0x1f62b0[_0x79f7c7(0x73f)][0x0][_0x79f7c7(0xb60)],_0x4dceae=_0x1f62b0[_0x79f7c7(0x259)]['includes'](_0x79f7c7(0x38d))?_0x1f62b0['pageY']:_0x1f62b0[_0x79f7c7(0x73f)][0x0][_0x79f7c7(0x6f2)],_0x440917[_0x79f7c7(0x1104)][_0x79f7c7(0x41b)]=_0x79f7c7(0x464);},_0x3e5eec=_0xa0ae38=>{const _0x4d1be2=_0x3343bc;if(!_0x2202f1)return;const _0x3de163=_0xa0ae38[_0x4d1be2(0x259)][_0x4d1be2(0xd8d)](_0x4d1be2(0x38d))?_0xa0ae38['pageY']:_0xa0ae38[_0x4d1be2(0x73f)][0x0][_0x4d1be2(0x6f2)];_0x22b537=_0xa0ae38[_0x4d1be2(0x259)][_0x4d1be2(0xd8d)]('mouse')?_0xa0ae38[_0x4d1be2(0xb60)]:_0xa0ae38[_0x4d1be2(0x73f)][0x0][_0x4d1be2(0xb60)];const _0x386a15=_0x22b537-_0x1b87bb,_0x580712=_0x3de163-_0x4dceae;_0x4fd36b&&(Math[_0x4d1be2(0xc86)](_0x386a15)>0xa||Math['abs'](_0x580712)>0xa)&&(_0x4fd36b=![]);if(Math['abs'](_0x386a15)>Math[_0x4d1be2(0xc86)](_0x580712)){if(_0xa0ae38[_0x4d1be2(0x11da)])_0xa0ae38[_0x4d1be2(0xae3)]();_0x440917['style'][_0x4d1be2(0xb7e)]=_0x4d1be2(0x6fd)+_0x21ba61*(0x64/_0x5998fd)+_0x4d1be2(0x7b4)+_0x386a15+_0x4d1be2(0xe1d);}},_0x4e51a0=_0x25b26a=>{const _0x5b148f=_0x3343bc;if(!_0x2202f1)return;_0x2202f1=![],_0x440917[_0x5b148f(0x1104)][_0x5b148f(0x41b)]=_0x5b148f(0xc7);if(_0x4fd36b){_0xea3fa6();return;}const _0x4d26dd=_0x22b537-_0x1b87bb;if(Math[_0x5b148f(0xc86)](_0x4d26dd)>_0x2df1f4['offsetWidth']/0x4){if(_0x4d26dd>0x0&&_0x21ba61>0x0)_0x21ba61--;else _0x4d26dd<0x0&&_0x21ba61<_0x5998fd-0x1&&_0x21ba61++;}_0xea3fa6();};_0x2df1f4[_0x3343bc(0xd85)](_0x3343bc(0x7d2),_0x23fa2c),_0x2df1f4[_0x3343bc(0xd85)](_0x3343bc(0xc65),_0x3e5eec),_0x2df1f4[_0x3343bc(0xd85)](_0x3343bc(0x1120),_0x4e51a0),_0x2df1f4[_0x3343bc(0xd85)](_0x3343bc(0xcb1),_0x4e51a0),_0x2df1f4[_0x3343bc(0xd85)]('touchstart',_0x23fa2c,{'passive':![]}),_0x2df1f4[_0x3343bc(0xd85)]('touchmove',_0x3e5eec,{'passive':![]}),_0x2df1f4[_0x3343bc(0xd85)](_0x3343bc(0x2ba),_0x4e51a0);}let _0x59a56d=null;async function _0x48a85a(){const _0x127271=_0x204348;await _0xb81626(),_0x589d88(_0x127271(0x686));}async function _0xb81626(){const _0x2f9505=_0x204348,_0x4ba2b9=document[_0x2f9505(0x458)](_0x2f9505(0xe20)),_0x41e9ae=document[_0x2f9505(0x458)]('preset-content-container');_0x4ba2b9['innerHTML']='',_0x41e9ae['innerHTML']='';const [_0xf6fcb1,_0x2b9628]=await Promise[_0x2f9505(0xfe2)]([_0x17d534['presets'][_0x2f9505(0x511)](),_0x17d534[_0x2f9505(0xf54)][_0x2f9505(0x50b)](_0x2f9505(0x132a))[_0x2f9505(0x511)]()]);_0x42f206[_0x2f9505(0x843)]=_0xf6fcb1;if(_0xf6fcb1[_0x2f9505(0x131d)]===0x0){_0x41e9ae['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>';return;}const _0x369569=document[_0x2f9505(0xe7d)](_0x2f9505(0x986));_0x369569[_0x2f9505(0x69b)]=_0x2f9505(0x11a3),_0x369569['textContent']='全部',_0x369569[_0x2f9505(0x1f4)][_0x2f9505(0x5f7)]=_0x2f9505(0xfe2),_0x4ba2b9[_0x2f9505(0x1079)](_0x369569);const _0xe953f1=document['createElement'](_0x2f9505(0x1323));_0xe953f1['className']=_0x2f9505(0x687),_0xe953f1[_0x2f9505(0x1f4)][_0x2f9505(0x5f7)]=_0x2f9505(0xfe2),_0x41e9ae[_0x2f9505(0x1079)](_0xe953f1),_0x2b9628[_0x2f9505(0x12c2)](_0x45acb0=>{const _0x47375d=_0x2f9505,_0x266498=document[_0x47375d(0xe7d)]('button');_0x266498[_0x47375d(0x69b)]='world-book-tab',_0x266498['textContent']=_0x45acb0[_0x47375d(0x132a)],_0x266498[_0x47375d(0x1f4)][_0x47375d(0x5f7)]=String(_0x45acb0['id']),_0x4ba2b9['appendChild'](_0x266498);const _0xb08fa2=document[_0x47375d(0xe7d)]('div');_0xb08fa2[_0x47375d(0x69b)]='world-book-category-pane',_0xb08fa2['dataset']['categoryId']=String(_0x45acb0['id']),_0x41e9ae[_0x47375d(0x1079)](_0xb08fa2);});const _0x39ed1e=_0xf6fcb1[_0x2f9505(0x593)](_0x1503ed=>!_0x1503ed[_0x2f9505(0x5f7)]);if(_0x39ed1e){const _0x1567f7=document[_0x2f9505(0xe7d)](_0x2f9505(0x986));_0x1567f7['className']=_0x2f9505(0x4a5),_0x1567f7['textContent']=_0x2f9505(0x548),_0x1567f7[_0x2f9505(0x1f4)][_0x2f9505(0x5f7)]=_0x2f9505(0xbff),_0x4ba2b9[_0x2f9505(0x1079)](_0x1567f7);const _0x4e3a14=document[_0x2f9505(0xe7d)](_0x2f9505(0x1323));_0x4e3a14[_0x2f9505(0x69b)]=_0x2f9505(0xad),_0x4e3a14[_0x2f9505(0x1f4)][_0x2f9505(0x5f7)]=_0x2f9505(0xbff),_0x41e9ae[_0x2f9505(0x1079)](_0x4e3a14);}_0xf6fcb1['forEach'](_0x447580=>{const _0x510e6d=_0x2f9505,_0x39e099=_0x510e6d(0x79)+_0x447580[_0x510e6d(0x1316)][_0x510e6d(0x131d)]+'\x20个条目。',_0x4f495f=document['createElement'](_0x510e6d(0x1323));_0x4f495f[_0x510e6d(0x69b)]=_0x510e6d(0x104a),_0x4f495f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x447580['name']+_0x510e6d(0x717)+_0x39e099+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x4214eb=()=>_0x13d6b6(_0x447580['id']),_0x1f5fad=async()=>{const _0x29fa33=_0x510e6d,_0x262f35=await _0x2532b9(_0x29fa33(0xa68),_0x29fa33(0x1040)+_0x447580[_0x29fa33(0x132a)]+'》吗？',{'confirmButtonClass':'btn-danger'});_0x262f35&&(await _0x17d534[_0x29fa33(0x843)][_0x29fa33(0x195)](_0x447580['id']),_0x42f206[_0x29fa33(0x843)]=await _0x17d534['presets'][_0x29fa33(0x511)](),_0xb81626());};_0x4f495f[_0x510e6d(0xd85)](_0x510e6d(0x1122),_0x4214eb),_0x4376d8(_0x4f495f,_0x1f5fad);const _0x5c5ebf=_0x4f495f[_0x510e6d(0x350)](!![]);_0x5c5ebf[_0x510e6d(0xd85)]('click',_0x4214eb),_0x4376d8(_0x5c5ebf,_0x1f5fad),_0xe953f1[_0x510e6d(0x1079)](_0x5c5ebf);const _0x3fa61c=_0x447580[_0x510e6d(0x5f7)]?String(_0x447580[_0x510e6d(0x5f7)]):_0x510e6d(0xbff),_0x15f445=_0x41e9ae['querySelector'](_0x510e6d(0x85a)+_0x3fa61c+'\x22]');_0x15f445&&_0x15f445[_0x510e6d(0x1079)](_0x4f495f);}),document[_0x2f9505(0x102a)]('#preset-tabs\x20.world-book-tab')[_0x2f9505(0x12c2)](_0x242e1b=>{const _0x18eb0b=_0x2f9505;_0x242e1b[_0x18eb0b(0xd85)]('click',()=>_0x2473d0(_0x242e1b[_0x18eb0b(0x1f4)][_0x18eb0b(0x5f7)]));});}function _0x2473d0(_0x31daec){const _0x197d25=_0x204348;document[_0x197d25(0x102a)](_0x197d25(0x472))['forEach'](_0x32312a=>{const _0x396322=_0x197d25;_0x32312a[_0x396322(0x11c2)][_0x396322(0x1270)](_0x396322(0xfe1),_0x32312a['dataset']['categoryId']===_0x31daec);}),document[_0x197d25(0x102a)]('#preset-content-container\x20.world-book-category-pane')[_0x197d25(0x12c2)](_0x2fb235=>{const _0x2e3b11=_0x197d25;_0x2fb235[_0x2e3b11(0x11c2)][_0x2e3b11(0x1270)](_0x2e3b11(0xfe1),_0x2fb235[_0x2e3b11(0x1f4)][_0x2e3b11(0x5f7)]===_0x31daec);});}async function _0x13d6b6(_0x4e0641){const _0x2d343f=_0x204348;_0x589d88(_0x2d343f(0x5ad)),_0x59a56d=_0x4e0641;try{const [_0xca808f,_0x57e8ce]=await Promise['all']([_0x17d534['presets'][_0x2d343f(0x36d)](_0x4e0641),_0x17d534[_0x2d343f(0xf54)][_0x2d343f(0x511)]()]);if(!_0xca808f){console[_0x2d343f(0xb61)]('错误：尝试打开一个不存在的预设，ID:',_0x4e0641),await _0x34fce8('加载失败',_0x2d343f(0xaea)),_0x589d88(_0x2d343f(0x686));return;}setTimeout(()=>{const _0x170576=_0x2d343f;document['getElementById']('preset-editor-title')[_0x170576(0x1a2)]=_0xca808f['name'],document['getElementById'](_0x170576(0x1f2))[_0x170576(0x8dd)]=_0xca808f[_0x170576(0x132a)];const _0x5ab7eb=document[_0x170576(0x458)]('preset-category-select');_0x5ab7eb[_0x170576(0x110d)]='<option\x20value=\x22\x22>--\x20未分类\x20--</option>',_0x57e8ce['forEach'](_0x149cbc=>{const _0x1e0bd4=_0x170576,_0x4acd4e=document[_0x1e0bd4(0xe7d)](_0x1e0bd4(0x790));_0x4acd4e[_0x1e0bd4(0x8dd)]=_0x149cbc['id'],_0x4acd4e[_0x1e0bd4(0x1a2)]=_0x149cbc[_0x1e0bd4(0x132a)];if(_0xca808f[_0x1e0bd4(0x5f7)]===_0x149cbc['id'])_0x4acd4e[_0x1e0bd4(0x500)]=!![];_0x5ab7eb[_0x1e0bd4(0x1079)](_0x4acd4e);});const _0xf41ae4=document[_0x170576(0x458)](_0x170576(0xbd7));_0xf41ae4[_0x170576(0x110d)]='',Array[_0x170576(0x971)](_0xca808f['content'])&&_0xca808f['content'][_0x170576(0x131d)]>0x0?_0xca808f[_0x170576(0x1316)]['forEach'](_0x194f47=>{const _0x4f51a8=_0x170576,_0x4d993c=_0x5a7b43(_0x194f47);_0xf41ae4[_0x4f51a8(0x1079)](_0x4d993c);}):_0xf41ae4[_0x170576(0x110d)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>';},0x32);}catch(_0x4e74d5){console[_0x2d343f(0xb61)](_0x2d343f(0x294),_0x4e74d5),await _0x34fce8(_0x2d343f(0xe5),_0x2d343f(0xf8c)+_0x4e74d5[_0x2d343f(0x7aa)]),_0x589d88(_0x2d343f(0x686));}}function _0x5a7b43(_0x4c0921={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x558d4e=_0x204348,_0x892b19=document[_0x558d4e(0xe7d)](_0x558d4e(0x1323));_0x892b19[_0x558d4e(0x69b)]=_0x558d4e(0x351);const _0x5e958c=_0x4c0921[_0x558d4e(0x12fb)]!==![]?'checked':'';_0x892b19[_0x558d4e(0x110d)]=_0x558d4e(0xdf0)+_0x5e958c+_0x558d4e(0x4bc)+(_0x4c0921['comment']||'')+'\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22'+(_0x4c0921[_0x558d4e(0x634)]||[])['join'](',\x20')+'\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>'+(_0x4c0921['content']||'')+_0x558d4e(0x9fd),_0x892b19[_0x558d4e(0x586)](_0x558d4e(0xf3c))['addEventListener'](_0x558d4e(0x1122),()=>_0x892b19['remove']());const _0x2ad477=_0x892b19['querySelector'](_0x558d4e(0x3ae)),_0x115257=_0x892b19[_0x558d4e(0x586)](_0x558d4e(0xedc));return _0x2ad477['addEventListener'](_0x558d4e(0x1122),()=>{const _0x5e35cf=_0x558d4e,_0xbc995e=_0x115257[_0x5e35cf(0x1104)][_0x5e35cf(0x4db)]===_0x5e35cf(0x464);_0x115257[_0x5e35cf(0x1104)][_0x5e35cf(0x4db)]=_0xbc995e?'block':_0x5e35cf(0x464),_0x2ad477[_0x5e35cf(0x1a2)]=_0xbc995e?'收起':'展开';}),_0x892b19;}async function _0x1fc0a9(){const _0x231922=_0x204348;await _0x1eb8d5(),document['querySelector']('#group-management-modal\x20.modal-header\x20span')[_0x231922(0x1a2)]=_0x231922(0x7ea),document['getElementById'](_0x231922(0xbbe))[_0x231922(0xbe8)]=_0x2a2b86,document[_0x231922(0x458)](_0x231922(0x216))[_0x231922(0xbe8)]=_0x52c4f3=>{const _0xd3442b=_0x231922;_0x52c4f3[_0xd3442b(0x12df)][_0xd3442b(0x11c2)]['contains'](_0xd3442b(0xb6e))&&_0xf48032(parseInt(_0x52c4f3[_0xd3442b(0x12df)]['dataset']['id']));},document[_0x231922(0x458)](_0x231922(0x1e9))[_0x231922(0xbe8)]=()=>{const _0x3c33be=_0x231922;document['getElementById'](_0x3c33be(0xacc))[_0x3c33be(0x11c2)][_0x3c33be(0x1097)](_0x3c33be(0x67d)),_0xb81626();},document['getElementById']('group-management-modal')['classList'][_0x231922(0xa58)](_0x231922(0x67d));}async function _0x1eb8d5(){const _0x2726dc=_0x204348,_0x3838ce=document[_0x2726dc(0x458)](_0x2726dc(0x216)),_0x1f8798=await _0x17d534[_0x2726dc(0xf54)]['toArray']();_0x3838ce[_0x2726dc(0x110d)]='',_0x1f8798[_0x2726dc(0x131d)]===0x0&&(_0x3838ce[_0x2726dc(0x110d)]=_0x2726dc(0x88)),_0x1f8798[_0x2726dc(0x12c2)](_0x35bc8e=>{const _0x4ddbc2=_0x2726dc,_0x31dece=document[_0x4ddbc2(0xe7d)](_0x4ddbc2(0x1323));_0x31dece[_0x4ddbc2(0x69b)]=_0x4ddbc2(0x1078),_0x31dece[_0x4ddbc2(0x110d)]=_0x4ddbc2(0xbe0)+_0x35bc8e[_0x4ddbc2(0x132a)]+_0x4ddbc2(0x130c)+_0x35bc8e['id']+_0x4ddbc2(0xc54),_0x3838ce[_0x4ddbc2(0x1079)](_0x31dece);});}async function _0x2a2b86(){const _0xece29d=_0x204348,_0x176078=document[_0xece29d(0x458)](_0xece29d(0xd61)),_0x39664e=_0x176078[_0xece29d(0x8dd)]['trim']();if(!_0x39664e)return alert(_0xece29d(0x4ac));const _0x2b2954=await _0x17d534[_0xece29d(0xf54)]['where']('name')[_0xece29d(0x7db)](_0x39664e)[_0xece29d(0xb9)]();if(_0x2b2954)return alert(_0xece29d(0x269)+_0x39664e+_0xece29d(0x374));await _0x17d534[_0xece29d(0xf54)][_0xece29d(0xa58)]({'name':_0x39664e}),_0x176078['value']='',await _0x1eb8d5();}async function _0xf48032(_0x2ec3ed){const _0x165470=_0x204348,_0x28d36d=await _0x2532b9(_0x165470(0x1ef),_0x165470(0x463),{'confirmButtonClass':_0x165470(0x4d3)});_0x28d36d&&(await _0x17d534[_0x165470(0xf54)][_0x165470(0x195)](_0x2ec3ed),await _0x17d534[_0x165470(0x843)][_0x165470(0x13c6)](_0x165470(0x5f7))[_0x165470(0x7db)](_0x2ec3ed)[_0x165470(0x910)]({'categoryId':null}),_0x42f206['presets']=await _0x17d534['presets'][_0x165470(0x511)](),await _0x1eb8d5());}async function _0x13cd8a(_0x14e8bd){const _0x32feb4=_0x204348,_0x625f2c=_0x14e8bd[_0x32feb4(0x12df)][_0x32feb4(0x1a9)][0x0];if(!_0x625f2c)return;try{if(!_0x625f2c[_0x32feb4(0x132a)][_0x32feb4(0x1082)](_0x32feb4(0xb42)))throw new Error(_0x32feb4(0x12bd));const _0x8f2c91=await _0x625f2c[_0x32feb4(0xdd5)](),_0x17121f=JSON[_0x32feb4(0x44c)](_0x8f2c91);await _0x45279b(_0x17121f,_0x625f2c[_0x32feb4(0x132a)]);}catch(_0x147c99){console['error'](_0x32feb4(0xf22),_0x147c99),await _0x34fce8('导入失败',_0x32feb4(0xf09)+_0x147c99['message']);}finally{_0x14e8bd[_0x32feb4(0x12df)][_0x32feb4(0x8dd)]=null;}}async function _0x45279b(_0x59b393,_0x4bdc85){const _0x4e57b5=_0x204348;let _0x321800=[];if(Array['isArray'](_0x59b393[_0x4e57b5(0x5d7)])&&Array[_0x4e57b5(0x971)](_0x59b393[_0x4e57b5(0x45a)])&&_0x59b393[_0x4e57b5(0x45a)][_0x4e57b5(0x131d)]>0x0){console['log'](_0x4e57b5(0xc76));const _0xd5d7b2=new Map(_0x59b393[_0x4e57b5(0x5d7)][_0x4e57b5(0xbf6)](_0x5d8beb=>[_0x5d8beb['identifier'],_0x5d8beb])),_0x330c15=_0x59b393['prompt_order'][_0x4e57b5(0x1450)]((_0x554def,_0x386537)=>_0x386537[_0x4e57b5(0x1ec)]&&_0x386537[_0x4e57b5(0x1ec)][_0x4e57b5(0x131d)]>(_0x554def[_0x4e57b5(0x131d)]||0x0)?_0x386537['order']:_0x554def,[]);_0x330c15&&_0x330c15[_0x4e57b5(0x131d)]>0x0&&(_0x321800=_0x330c15[_0x4e57b5(0xbf6)](_0x94c75c=>{const _0x180be2=_0x4e57b5,_0x4b7e7a=_0xd5d7b2[_0x180be2(0x36d)](_0x94c75c[_0x180be2(0x5e2)]);if(_0x4b7e7a)return{'keys':[],'comment':_0x4b7e7a[_0x180be2(0x132a)]||_0x180be2(0x1223),'content':_0x4b7e7a[_0x180be2(0x1316)]||'','enabled':_0x94c75c[_0x180be2(0x12fb)]};return null;})['filter'](Boolean));}else{if(_0x59b393[_0x4e57b5(0x1309)]&&typeof _0x59b393[_0x4e57b5(0x1309)]===_0x4e57b5(0x620))console[_0x4e57b5(0x7d1)](_0x4e57b5(0x811)),Array['isArray'](_0x59b393['order'])?(console[_0x4e57b5(0x7d1)](_0x4e57b5(0x1399)),_0x321800=_0x59b393[_0x4e57b5(0x1ec)][_0x4e57b5(0xbf6)](_0x45d707=>_0x59b393[_0x4e57b5(0x1309)][_0x45d707])[_0x4e57b5(0xaf1)](Boolean)[_0x4e57b5(0xbf6)](_0x9e504=>({'keys':_0x9e504[_0x4e57b5(0x1278)]||[],'comment':_0x9e504['comment']||'无备注','content':_0x9e504[_0x4e57b5(0x1316)]||'','enabled':!_0x9e504[_0x4e57b5(0xa28)]}))):(console[_0x4e57b5(0x1b6)]('未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。'),_0x321800=Object[_0x4e57b5(0x6eb)](_0x59b393[_0x4e57b5(0x1309)])['map'](_0x216682=>({'keys':_0x216682[_0x4e57b5(0x1278)]||[],'comment':_0x216682[_0x4e57b5(0xcb4)]||_0x4e57b5(0xfdc),'content':_0x216682[_0x4e57b5(0x1316)]||'','enabled':!_0x216682[_0x4e57b5(0xa28)]})));else{if(Array[_0x4e57b5(0x971)](_0x59b393['prompts']))console[_0x4e57b5(0x7d1)](_0x4e57b5(0x93d)),_0x321800=_0x59b393[_0x4e57b5(0x5d7)][_0x4e57b5(0xbf6)](_0x320e5c=>({'keys':[],'comment':_0x320e5c[_0x4e57b5(0x132a)]||_0x4e57b5(0x1223),'content':_0x320e5c[_0x4e57b5(0x1316)]||'','enabled':!![]}));else throw new Error('文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。');}}_0x321800=_0x321800[_0x4e57b5(0xaf1)](_0x519d16=>_0x519d16[_0x4e57b5(0x1316)]);if(_0x321800[_0x4e57b5(0x131d)]===0x0){alert('这个预设文件中没有找到任何有效的提示词条目。');return;}const _0x1807ea=_0x4bdc85[_0x4e57b5(0x33b)](/\.json$/i,''),_0x1760ff=await _0x335e57(_0x4e57b5(0x1081),_0x4e57b5(0x98d),_0x1807ea);if(!_0x1760ff||!_0x1760ff[_0x4e57b5(0x2aa)]()){alert('导入已取消，因为未提供名称。');return;}const _0x2cd5d6={'id':_0x4e57b5(0x13b3)+Date[_0x4e57b5(0x606)](),'name':_0x1760ff[_0x4e57b5(0x2aa)](),'content':_0x321800,'categoryId':null};await _0x17d534[_0x4e57b5(0x843)][_0x4e57b5(0xa58)](_0x2cd5d6),_0x42f206[_0x4e57b5(0x843)]['push'](_0x2cd5d6),await _0xb81626(),await _0x34fce8(_0x4e57b5(0x5e0),_0x4e57b5(0x821)+_0x1760ff+'》。');}async function _0x5c8364(_0x4e71af){const _0x5cb8f4=_0x204348,_0x43d99f=document[_0x5cb8f4(0x458)](_0x5cb8f4(0xf00));if(!_0x43d99f)return;const _0x295e87=_0x42f206[_0x5cb8f4(0x843)]||[];_0x43d99f[_0x5cb8f4(0x110d)]='<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>',_0x295e87['forEach'](_0x51cba2=>{const _0x3373d2=_0x5cb8f4,_0xfc8e91=document[_0x3373d2(0xe7d)](_0x3373d2(0x790));_0xfc8e91[_0x3373d2(0x8dd)]=_0x51cba2['id'],_0xfc8e91['textContent']=_0x51cba2[_0x3373d2(0x132a)],_0x43d99f[_0x3373d2(0x1079)](_0xfc8e91);}),_0x4e71af[_0x5cb8f4(0xda2)][_0x5cb8f4(0xd13)]&&(_0x43d99f[_0x5cb8f4(0x8dd)]=_0x4e71af[_0x5cb8f4(0xda2)]['offlinePresetId']);}function _0x386f12(){const _0x3d6a0b=_0x204348,_0x2bafc3=document[_0x3d6a0b(0x458)](_0x3d6a0b(0xdcf));if(!_0x2bafc3)return;_0x2bafc3['innerHTML']='';let _0x152f64=_0x42f206[_0x3d6a0b(0xf0)][_0x3d6a0b(0x4b9)]||_0x2432c1;_0x152f64[_0x3d6a0b(0x12c2)](_0x463a20=>{const _0x1f1f47=_0x3d6a0b,_0x1241c9=document[_0x1f1f47(0x458)](_0x463a20);if(_0x1241c9){const _0x34b722=document['createElement']('div');_0x34b722[_0x1f1f47(0x69b)]=_0x1f1f47(0xf27),_0x34b722[_0x1f1f47(0xe7b)]=!![],_0x34b722[_0x1f1f47(0x1f4)][_0x1f1f47(0x273)]=_0x463a20,_0x34b722['innerHTML']=_0x1241c9[_0x1f1f47(0x110d)],_0x2bafc3[_0x1f1f47(0x1079)](_0x34b722);}});}function _0x442768(){const _0x32e874=_0x204348,_0x15be7d=document[_0x32e874(0x458)](_0x32e874(0xdcf));if(!_0x15be7d)return;let _0x124881=null;const _0x223a4a=_0x26b998=>{const _0x37b091=_0x32e874,_0x47b2fd=_0x26b998['target'][_0x37b091(0xe87)](_0x37b091(0x4f8));if(!_0x47b2fd)return;_0x124881=_0x47b2fd,_0x124881[_0x37b091(0x11c2)]['add']('dragging');if(_0x26b998[_0x37b091(0x11da)])_0x26b998[_0x37b091(0xae3)]();},_0x2e14b5=_0x527e4d=>{const _0x5aec7c=_0x32e874;if(!_0x124881)return;const _0x1589ee=_0x527e4d[_0x5aec7c(0x259)][_0x5aec7c(0xd8d)]('mouse')?_0x527e4d[_0x5aec7c(0xf21)]:_0x527e4d[_0x5aec7c(0x73f)][0x0]['clientX'],_0x47c398=_0x5e4015(_0x15be7d,_0x1589ee);_0x47c398==null?_0x15be7d['appendChild'](_0x124881):_0x15be7d[_0x5aec7c(0x4d4)](_0x124881,_0x47c398);},_0x14efd6=()=>{const _0x5de721=_0x32e874;if(!_0x124881)return;_0x124881[_0x5de721(0x11c2)][_0x5de721(0x1097)](_0x5de721(0x59c)),_0x124881=null,_0x544363();};_0x15be7d[_0x32e874(0xd85)]('mousedown',_0x223a4a),_0x15be7d[_0x32e874(0xd85)](_0x32e874(0xcbd),_0x223a4a,{'passive':![]}),_0x15be7d[_0x32e874(0xd85)](_0x32e874(0xc65),_0x2e14b5),_0x15be7d[_0x32e874(0xd85)](_0x32e874(0xfc2),_0x2e14b5,{'passive':![]}),_0x15be7d[_0x32e874(0xd85)]('mouseup',_0x14efd6),_0x15be7d[_0x32e874(0xd85)](_0x32e874(0xcb1),_0x14efd6),_0x15be7d[_0x32e874(0xd85)]('touchend',_0x14efd6);}function _0x5e4015(_0x33ad32,_0x26e3cb){const _0x4511cc=_0x204348,_0x482219=[..._0x33ad32[_0x4511cc(0x102a)]('.draggable-button-item:not(.dragging)')];return _0x482219['reduce']((_0x2234a5,_0x165eb6)=>{const _0x2d9e42=_0x4511cc,_0x1f183b=_0x165eb6[_0x2d9e42(0x89d)](),_0x45782e=_0x26e3cb-_0x1f183b['left']-_0x1f183b[_0x2d9e42(0x1147)]/0x2;return _0x45782e<0x0&&_0x45782e>_0x2234a5[_0x2d9e42(0x408)]?{'offset':_0x45782e,'element':_0x165eb6}:_0x2234a5;},{'offset':Number[_0x4511cc(0xf59)]})[_0x4511cc(0x29a)];}async function _0x544363(){const _0x5de438=_0x204348,_0x3e1294=document[_0x5de438(0x458)]('button-order-editor'),_0x1a4fa8=Array[_0x5de438(0xca2)](_0x3e1294['querySelectorAll'](_0x5de438(0x4f8)))[_0x5de438(0xbf6)](_0x30215d=>_0x30215d[_0x5de438(0x1f4)]['buttonId']);_0x42f206[_0x5de438(0xf0)][_0x5de438(0x4b9)]=_0x1a4fa8,await _0x17d534[_0x5de438(0xf0)][_0x5de438(0xf3f)](_0x42f206[_0x5de438(0xf0)]);}function _0x5d289b(){const _0x4b4a47=_0x204348,_0x538292=_0x42f206[_0x4b4a47(0xf0)][_0x4b4a47(0x4b9)];if(!_0x538292||!Array['isArray'](_0x538292)||_0x538292[_0x4b4a47(0x131d)]===0x0)return;const _0x313e65=document['getElementById']('chat-input-actions-top');if(!_0x313e65)return;_0x538292[_0x4b4a47(0x12c2)](_0x2a2b5b=>{const _0x463e7e=_0x4b4a47,_0x307756=document[_0x463e7e(0x458)](_0x2a2b5b);_0x307756&&_0x313e65[_0x463e7e(0x1079)](_0x307756);});}const _0x2432c1=[_0x204348(0xa89),_0x204348(0x622),_0x204348(0xa5f),'transfer-btn',_0x204348(0x10df),_0x204348(0x1b8),_0x204348(0x883),_0x204348(0x13ca),_0x204348(0xedf),_0x204348(0xed7),_0x204348(0x63c),'gomoku-btn','open-shopping-btn',_0x204348(0x13bf),_0x204348(0x54c),_0x204348(0x967),_0x204348(0x943),'show-announcement-board-btn','werewolf-game-btn',_0x204348(0x823),'open-nai-gallery-btn'];async function _0x309170(){const _0x3d08cd=_0x204348;_0x42f206[_0x3d08cd(0xf0)][_0x3d08cd(0x4b9)]=null,await _0x17d534['globalSettings'][_0x3d08cd(0xf3f)](_0x42f206['globalSettings']),_0x386f12(),_0x5d289b(),await _0x34fce8('成功','按钮顺序已恢复为默认设置！');}let _0x8cd5cd=[],_0x2f86b9=[];function _0x1fecd0(){const _0xf129bc=_0x204348,_0x3bf1ab=document['getElementById'](_0xf129bc(0x7ce));_0x8cd5cd=[],_0x2f86b9=[],_0x28bdee(),document['getElementById'](_0xf129bc(0x59a))[_0xf129bc(0x1104)][_0xf129bc(0x4db)]=_0xf129bc(0x82b),document[_0xf129bc(0x458)](_0xf129bc(0xfef))[_0xf129bc(0x1104)][_0xf129bc(0x4db)]='none',_0x3bf1ab[_0xf129bc(0x11c2)]['add'](_0xf129bc(0x67d));}function _0x28bdee(){const _0x2c42fd=_0x204348,_0x314ccd=document['getElementById'](_0x2c42fd(0x5ca));_0x314ccd[_0x2c42fd(0x110d)]='';const _0x42904f=document[_0x2c42fd(0xe7d)]('div');_0x42904f['className']=_0x2c42fd(0x70b),_0x42904f[_0x2c42fd(0x1f4)]['charId']=_0x2c42fd(0xf86),_0x42904f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+(_0x42f206[_0x2c42fd(0x551)][_0x2c42fd(0x308)]||'我')+_0x2c42fd(0x3c7),_0x314ccd[_0x2c42fd(0x1079)](_0x42904f),Object[_0x2c42fd(0x6eb)](_0x42f206[_0x2c42fd(0x954)])[_0x2c42fd(0x12c2)](_0x499bea=>{const _0x2f153d=_0x2c42fd;if(!_0x499bea[_0x2f153d(0x726)]){const _0x276f47=document['createElement'](_0x2f153d(0x1323));_0x276f47[_0x2f153d(0x69b)]=_0x2f153d(0x70b),_0x276f47[_0x2f153d(0x1f4)][_0x2f153d(0x58c)]=_0x499bea['id'],_0x276f47['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x499bea[_0x2f153d(0x132a)]+_0x2f153d(0xbc8),_0x314ccd[_0x2f153d(0x1079)](_0x276f47);}});}function _0x1f6909(){const _0x45da31=_0x204348,_0x3a4177=document[_0x45da31(0x458)](_0x45da31(0x1417));_0x3a4177['innerHTML']='';const _0x527fec=[{'id':'chat','name':_0x45da31(0xf2d),'description':_0x45da31(0xbf8)},{'id':_0x45da31(0xdbd),'name':_0x45da31(0x1c6),'description':_0x45da31(0x1350)},{'id':'calls','name':_0x45da31(0x9f8),'description':'将清空选定角色的所有通话记录。'},{'id':_0x45da31(0xd84),'name':'心声','description':_0x45da31(0xa01)},{'id':_0x45da31(0x414),'name':_0x45da31(0x77e),'description':'将清空选定角色的所有长期记忆。'},{'id':'favorites','name':'收藏','description':_0x45da31(0x4b2)},{'id':_0x45da31(0xace),'name':_0x45da31(0x12b),'description':_0x45da31(0xbd3)}];_0x527fec['forEach'](_0x4081b7=>{const _0x5a5950=_0x45da31,_0x201a6c=document[_0x5a5950(0xe7d)](_0x5a5950(0x1323));_0x201a6c[_0x5a5950(0x69b)]='clear-posts-item',_0x201a6c[_0x5a5950(0x1f4)][_0x5a5950(0xc43)]=_0x4081b7['id'],_0x201a6c['innerHTML']=_0x5a5950(0x3bb)+_0x4081b7[_0x5a5950(0x132a)]+_0x5a5950(0x56b)+_0x4081b7['description']+_0x5a5950(0x1019),_0x3a4177['appendChild'](_0x201a6c);});}function _0x7a9ec2(){const _0x3b119c=_0x204348,_0x5d6b60=document['querySelectorAll'](_0x3b119c(0xd63));if(_0x5d6b60[_0x3b119c(0x131d)]===0x0){alert(_0x3b119c(0xe36));return;}_0x8cd5cd=Array[_0x3b119c(0xca2)](_0x5d6b60)[_0x3b119c(0xbf6)](_0x9f473d=>_0x9f473d[_0x3b119c(0x1f4)][_0x3b119c(0x58c)]),_0x1f6909(),document[_0x3b119c(0x458)](_0x3b119c(0x59a))['style'][_0x3b119c(0x4db)]='none',document[_0x3b119c(0x458)](_0x3b119c(0xfef))[_0x3b119c(0x1104)]['display']=_0x3b119c(0x82b);}function _0x1b643d(){const _0x24860b=_0x204348;document[_0x24860b(0x458)]('data-clear-step-2')[_0x24860b(0x1104)][_0x24860b(0x4db)]='none',document[_0x24860b(0x458)]('data-clear-step-1')[_0x24860b(0x1104)]['display']=_0x24860b(0x82b),document[_0x24860b(0x102a)]('#data-clear-char-list\x20.clear-posts-item')[_0x24860b(0x12c2)](_0x41eb9c=>{const _0x554ee1=_0x24860b;_0x8cd5cd[_0x554ee1(0xd8d)](_0x41eb9c[_0x554ee1(0x1f4)][_0x554ee1(0x58c)])&&_0x41eb9c[_0x554ee1(0x11c2)][_0x554ee1(0xa58)](_0x554ee1(0x500));});}async function _0x41aa26(){const _0x27786b=_0x204348,_0x3939f5=document[_0x27786b(0x102a)](_0x27786b(0xc1c));if(_0x3939f5[_0x27786b(0x131d)]===0x0){alert(_0x27786b(0x11e6));return;}_0x2f86b9=Array[_0x27786b(0xca2)](_0x3939f5)[_0x27786b(0xbf6)](_0x272a2b=>_0x272a2b[_0x27786b(0x1f4)][_0x27786b(0xc43)]);const _0x311660=await _0x2532b9(_0x27786b(0x7bd),'此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？',{'confirmButtonClass':_0x27786b(0x4d3),'confirmText':_0x27786b(0x1ef)});if(!_0x311660)return;await _0x34fce8(_0x27786b(0x12b9),_0x27786b(0x1113));try{await _0x17d534[_0x27786b(0x9a7)]('rw',_0x17d534[_0x27786b(0x275)],async()=>{const _0x4d47ad=_0x27786b;for(const _0x180a3d of _0x8cd5cd){for(const _0x2bc7d2 of _0x2f86b9){if(_0x2bc7d2===_0x4d47ad(0x10f6)){if(_0x180a3d===_0x4d47ad(0xf86)){const _0x248cec=await _0x17d534[_0x4d47ad(0x954)][_0x4d47ad(0x511)]();for(const _0x34b843 of _0x248cec){_0x34b843[_0x4d47ad(0x1d5)]=_0x34b843['history'][_0x4d47ad(0xaf1)](_0x2b6717=>_0x2b6717[_0x4d47ad(0xaeb)]!==_0x4d47ad(0xf86)),await _0x17d534[_0x4d47ad(0x954)][_0x4d47ad(0xf3f)](_0x34b843);}}else{const _0x287933=await _0x17d534[_0x4d47ad(0x954)][_0x4d47ad(0x36d)](_0x180a3d);_0x287933&&(_0x287933['history']=[],_0x287933[_0x4d47ad(0xb0f)]=_0x4d47ad(0x10a0),_0x287933[_0x4d47ad(0x8eb)]=_0x4d47ad(0x10a0),Array['isArray'](_0x287933[_0x4d47ad(0x103)])&&(_0x287933[_0x4d47ad(0x103)]=[]),_0x287933[_0x4d47ad(0xda2)]&&(_0x287933['settings']['myNickname']='我'),await _0x17d534[_0x4d47ad(0x954)][_0x4d47ad(0xf3f)](_0x287933));}}if(_0x2bc7d2===_0x4d47ad(0xdbd)){const _0x5797a5=_0x180a3d==='user'?'user':_0x180a3d;await _0x17d534['qzonePosts']['where'](_0x4d47ad(0x1086))[_0x4d47ad(0x7db)](_0x5797a5)[_0x4d47ad(0x195)]();}_0x2bc7d2==='calls'&&_0x180a3d!==_0x4d47ad(0xf86)&&await _0x17d534[_0x4d47ad(0x920)][_0x4d47ad(0x13c6)](_0x4d47ad(0xfca))['equals'](_0x180a3d)[_0x4d47ad(0x195)]();if(_0x2bc7d2===_0x4d47ad(0xd84)&&_0x180a3d!==_0x4d47ad(0xf86)){const _0xa9e68=await _0x17d534['chats'][_0x4d47ad(0x36d)](_0x180a3d);_0xa9e68&&(_0xa9e68[_0x4d47ad(0x6b8)]=[],_0xa9e68['heartfeltVoice']=_0x4d47ad(0x10a0),_0xa9e68['randomJottings']=_0x4d47ad(0x10a0),await _0x17d534['chats']['put'](_0xa9e68));}if(_0x2bc7d2===_0x4d47ad(0x414)&&_0x180a3d!==_0x4d47ad(0xf86)){const _0x5630b0=await _0x17d534['chats'][_0x4d47ad(0x36d)](_0x180a3d);_0x5630b0&&(_0x5630b0[_0x4d47ad(0x94a)]=[],await _0x17d534[_0x4d47ad(0x954)][_0x4d47ad(0xf3f)](_0x5630b0));}_0x2bc7d2==='favorites'&&(_0x180a3d===_0x4d47ad(0xf86)?(await _0x17d534['favorites']['where'](_0x4d47ad(0x259))[_0x4d47ad(0x7db)](_0x4d47ad(0xe47))[_0x4d47ad(0xaf1)](_0x562654=>_0x562654[_0x4d47ad(0x1316)][_0x4d47ad(0x1086)]===_0x4d47ad(0xf86))[_0x4d47ad(0x195)](),await _0x17d534[_0x4d47ad(0xb78)]['where'](_0x4d47ad(0x259))[_0x4d47ad(0x7db)](_0x4d47ad(0x10e6))[_0x4d47ad(0xaf1)](_0x273967=>_0x273967[_0x4d47ad(0x1316)][_0x4d47ad(0xaeb)]==='user')['delete']()):(await _0x17d534[_0x4d47ad(0xb78)][_0x4d47ad(0x13c6)](_0x4d47ad(0x259))['equals'](_0x4d47ad(0x10e6))[_0x4d47ad(0x651)](_0x4dab5e=>_0x4dab5e[_0x4d47ad(0xfca)]===_0x180a3d)['delete'](),await _0x17d534[_0x4d47ad(0xb78)][_0x4d47ad(0x13c6)](_0x4d47ad(0x259))[_0x4d47ad(0x7db)](_0x4d47ad(0xe47))[_0x4d47ad(0xaf1)](_0x33423d=>_0x33423d[_0x4d47ad(0x1316)][_0x4d47ad(0x1086)]===_0x180a3d)[_0x4d47ad(0x195)](),await _0x17d534[_0x4d47ad(0xb78)][_0x4d47ad(0x13c6)]('type')[_0x4d47ad(0x7db)]('char_diary')[_0x4d47ad(0xaf1)](_0x250d62=>_0x250d62['content']['characterId']===_0x180a3d)[_0x4d47ad(0x195)](),await _0x17d534[_0x4d47ad(0xb78)]['where'](_0x4d47ad(0x259))[_0x4d47ad(0x7db)]('char_browser_article')[_0x4d47ad(0xaf1)](_0x5aedd=>_0x5aedd[_0x4d47ad(0x1316)][_0x4d47ad(0x92b)]===_0x180a3d)[_0x4d47ad(0x195)](),await _0x17d534[_0x4d47ad(0xb78)][_0x4d47ad(0x13c6)](_0x4d47ad(0x259))[_0x4d47ad(0x7db)]('char_memo')[_0x4d47ad(0xaf1)](_0x3858e0=>_0x3858e0[_0x4d47ad(0x1316)][_0x4d47ad(0x92b)]===_0x180a3d)[_0x4d47ad(0x195)]()));if(_0x2bc7d2==='cphone'&&_0x180a3d!=='user'){const _0x5e1f40=await _0x17d534['chats'][_0x4d47ad(0x36d)](_0x180a3d);_0x5e1f40&&(_0x5e1f40[_0x4d47ad(0x11d9)]=[],_0x5e1f40[_0x4d47ad(0x9b0)]=[],_0x5e1f40[_0x4d47ad(0x83e)]=[],_0x5e1f40[_0x4d47ad(0x3a7)]=null,_0x5e1f40[_0x4d47ad(0xd1)]=[],_0x5e1f40['simulatedAppUsage']=[],_0x5e1f40[_0x4d47ad(0xb34)]=[],_0x5e1f40[_0x4d47ad(0x546)]=[],_0x5e1f40['memos']=[],await _0x17d534[_0x4d47ad(0x954)][_0x4d47ad(0xf3f)](_0x5e1f40));}}}}),await _0x198396(),await _0x27be5e(),document[_0x27786b(0x458)](_0x27786b(0x7ce))[_0x27786b(0x11c2)][_0x27786b(0x1097)](_0x27786b(0x67d)),await _0x34fce8(_0x27786b(0x896),_0x27786b(0x46e));}catch(_0x3fa023){console[_0x27786b(0xb61)]('高级数据清理失败:',_0x3fa023),await _0x34fce8(_0x27786b(0x11c1),_0x27786b(0x137c)+_0x3fa023[_0x27786b(0x7aa)]);}}async function _0x4c0d82(_0x5c6e54,_0x4ac29a,_0x2dbc44){const _0x24d5cd=_0x204348,_0x20d741=_0x2dbc44[_0x24d5cd(0x586)](_0x24d5cd(0xdc1))[_0x24d5cd(0x647)],_0x476359=await _0xcd7475(_0x24d5cd(0x85c)+_0x20d741+_0x24d5cd(0x710),[{'text':_0x24d5cd(0xe85),'value':_0x24d5cd(0x1030)},{'text':_0x24d5cd(0x1e1),'value':_0x24d5cd(0x1377)}]);let _0x301734=null;if(_0x476359==='local')_0x301734=await _0x5f0541();else{if(_0x476359==='url'){const _0x20e242=_0x4ac29a===_0x24d5cd(0xace)?_0x42f206[_0x24d5cd(0xf0)][_0x24d5cd(0x6e8)][_0x5c6e54]:_0x42f206['globalSettings'][_0x24d5cd(0x6a3)][_0x5c6e54],_0x1bff9d=_0x20e242[_0x24d5cd(0x13ad)](_0x24d5cd(0x421)),_0x302848=_0x1bff9d?'':_0x20e242;_0x301734=await _0x335e57(_0x24d5cd(0x50a),_0x24d5cd(0x25d),_0x302848,'url');}}if(_0x301734&&_0x301734['trim']()){const _0x29c056=_0x301734[_0x24d5cd(0x2aa)]();_0x4ac29a===_0x24d5cd(0xace)?_0x42f206[_0x24d5cd(0xf0)][_0x24d5cd(0x6e8)][_0x5c6e54]=_0x29c056:_0x42f206[_0x24d5cd(0xf0)][_0x24d5cd(0x6a3)][_0x5c6e54]=_0x29c056,_0x2dbc44['querySelector'](_0x24d5cd(0xdc1))[_0x24d5cd(0x577)]=_0x29c056;}else _0x301734!==null&&alert(_0x24d5cd(0x5f4));}async function _0xb8f58c(){const _0x4cbdb1=_0x204348,_0x96adbd=await _0x2532b9(_0x4cbdb1(0x341),'此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>',{'confirmButtonClass':_0x4cbdb1(0x4d3),'confirmText':_0x4cbdb1(0x1094)});if(!_0x96adbd)return;await _0x34fce8('请稍候...',_0x4cbdb1(0xd90));let _0x257354={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console[_0x4cbdb1(0x7d1)](_0x4cbdb1(0xb20));const _0x366f2d=[_0x4cbdb1(0x954),_0x4cbdb1(0xf0),_0x4cbdb1(0x551),_0x4cbdb1(0x1294),_0x4cbdb1(0xaa5)],_0x1ae61a=[];for(const _0x3b6bf1 of _0x366f2d){const _0x5e7abb=_0x17d534['table'](_0x3b6bf1),_0x1c3365=await _0x5e7abb[_0x4cbdb1(0x511)]();_0x1ae61a[_0x4cbdb1(0x129e)]({'tableName':_0x3b6bf1,'records':_0x1c3365});}console[_0x4cbdb1(0x7d1)](_0x4cbdb1(0x78c));for(const _0x42f07d of _0x1ae61a){for(const _0x572f14 of _0x42f07d[_0x4cbdb1(0x962)]){await _0x4e6a4c(_0x572f14,_0x257354);}}console[_0x4cbdb1(0x7d1)](_0x4cbdb1(0xab0)),await _0x17d534[_0x4cbdb1(0x9a7)]('rw',_0x366f2d,async()=>{const _0x1fcd50=_0x4cbdb1;for(const _0xddef25 of _0x1ae61a){await _0x17d534[_0x1fcd50(0xca3)](_0xddef25[_0x1fcd50(0x403)])['bulkPut'](_0xddef25[_0x1fcd50(0x962)]);}});const _0x57172b=_0x257354['originalSize']-_0x257354[_0x4cbdb1(0x11b4)],_0x196a1f=_0x257354['originalSize']>0x0?(_0x57172b/_0x257354[_0x4cbdb1(0x6d3)]*0x64)['toFixed'](0x2):0x0;await _0x34fce8('压缩完成！','扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20'+_0x257354['found']+_0x4cbdb1(0x66b)+_0x257354[_0x4cbdb1(0x126)]+_0x4cbdb1(0xd74)+_0x257354[_0x4cbdb1(0x1361)]+_0x4cbdb1(0x5a8)+(_0x57172b/0x400/0x400)[_0x4cbdb1(0x800)](0x2)+_0x4cbdb1(0xa3a)+_0x196a1f+'%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。');}catch(_0x22892a){console[_0x4cbdb1(0xb61)]('图片压缩过程中发生错误:',_0x22892a),await _0x34fce8('压缩失败',_0x4cbdb1(0x137c)+_0x22892a['message']);}}function _0x192fff(_0x222b8d,_0x246c13=''){const _0x27b06c=_0x204348;let _0x3b2927=0x0;for(const _0x3645a3 in _0x222b8d){if(_0x222b8d[_0x27b06c(0x621)](_0x3645a3)){const _0x14a564=_0x222b8d[_0x3645a3];if(typeof _0x14a564===_0x27b06c(0x861)&&_0x14a564[_0x27b06c(0x13ad)](_0x27b06c(0x421))){const _0x27379a=_0x246c13===_0x27b06c(0xf0)&&(_0x3645a3===_0x27b06c(0xef2)||_0x3645a3===_0x27b06c(0x3bc)||_0x3645a3===_0x27b06c(0x203))||_0x246c13==='widgetData'||_0x246c13==='settings'&&_0x3645a3===_0x27b06c(0x13ed)||(_0x246c13===_0x27b06c(0x6a3)||_0x246c13===_0x27b06c(0x6e8));!_0x27379a&&(_0x3b2927+=_0x14a564['length']);}else typeof _0x14a564===_0x27b06c(0x620)&&_0x14a564!==null&&(_0x3b2927+=_0x192fff(_0x14a564,_0x3645a3));}}return _0x3b2927;}async function _0x22222a(){const _0xbba0ec=_0x204348,_0x59b231=document[_0xbba0ec(0x458)](_0xbba0ec(0xd3d));if(!_0x59b231)return;_0x59b231[_0xbba0ec(0x110d)]=_0xbba0ec(0xdf9);try{let _0xccdbb2=0x0;const _0x5d7cc1=[_0xbba0ec(0x954),_0xbba0ec(0xf0),_0xbba0ec(0x551),_0xbba0ec(0x1294),'customAvatarFrames'];for(const _0x17e2fc of _0x5d7cc1){const _0x1b4204=_0x17d534[_0xbba0ec(0xca3)](_0x17e2fc);await _0x1b4204[_0xbba0ec(0x678)](_0x548be0=>{_0xccdbb2+=_0x192fff(_0x548be0);});}const _0xd8e0a5=(_0xccdbb2/0x400/0x400)[_0xbba0ec(0x800)](0x2);_0x59b231['innerHTML']=_0xbba0ec(0x8fa)+_0xd8e0a5+_0xbba0ec(0x550);}catch(_0x3c39e7){console[_0xbba0ec(0xb61)](_0xbba0ec(0x867),_0x3c39e7),_0x59b231[_0xbba0ec(0x110d)]=_0xbba0ec(0x802);}}async function _0x4e6a4c(_0x5a17f6,_0x302d93,_0x7809e5=''){const _0x5e2f85=_0x204348;for(const _0x5bd86f in _0x5a17f6){if(_0x5a17f6[_0x5e2f85(0x621)](_0x5bd86f)){const _0x4d35bc=_0x5a17f6[_0x5bd86f];if(typeof _0x4d35bc===_0x5e2f85(0x861)&&_0x4d35bc[_0x5e2f85(0x13ad)]('data:image')){const _0x4c8428=_0x7809e5===_0x5e2f85(0xf0)&&(_0x5bd86f==='wallpaper'||_0x5bd86f===_0x5e2f85(0x3bc)||_0x5bd86f===_0x5e2f85(0x203))||_0x7809e5===_0x5e2f85(0x755)||_0x7809e5===_0x5e2f85(0xda2)&&_0x5bd86f===_0x5e2f85(0x13ed)||(_0x7809e5===_0x5e2f85(0x6a3)||_0x7809e5==='cphoneAppIcons');if(_0x4c8428)continue;_0x302d93[_0x5e2f85(0x28a)]++,_0x302d93[_0x5e2f85(0x6d3)]+=_0x4d35bc[_0x5e2f85(0x131d)];const _0x2b4e68=await _0x17fe40(_0x4d35bc);_0x2b4e68&&_0x2b4e68!==_0x4d35bc?(_0x5a17f6[_0x5bd86f]=_0x2b4e68,_0x302d93['compressed']++,_0x302d93['newSize']+=_0x2b4e68['length']):(_0x302d93['skipped']++,_0x302d93[_0x5e2f85(0x11b4)]+=_0x4d35bc[_0x5e2f85(0x131d)]);}else typeof _0x4d35bc==='object'&&_0x4d35bc!==null&&await _0x4e6a4c(_0x4d35bc,_0x302d93,_0x5bd86f);}}}async function _0x17fe40(_0x432a95){const _0x42f344=_0x204348;if(!_0x432a95['startsWith']('data:image'))return _0x432a95;try{const _0x4a45d7=await(await fetch(_0x432a95))[_0x42f344(0x43d)](),_0x4807e0={'maxSizeMB':0.5,'maxWidthOrHeight':0x320,'useWebWorker':!![],'initialQuality':0.5,'fileType':_0x42f344(0x229)};console[_0x42f344(0x7d1)](_0x42f344(0x51e)+(_0x4a45d7[_0x42f344(0x12a4)]/0x400/0x400)[_0x42f344(0x800)](0x2)+'\x20MB');const _0x271444=await imageCompression(_0x4a45d7,_0x4807e0);return console[_0x42f344(0x7d1)]('压缩完成，新的大小:\x20'+(_0x271444[_0x42f344(0x12a4)]/0x400/0x400)['toFixed'](0x2)+_0x42f344(0xe8)),new Promise((_0x45d91c,_0x56766a)=>{const _0x11c4fd=_0x42f344,_0x470604=new FileReader();_0x470604[_0x11c4fd(0x13a7)]=()=>_0x45d91c(_0x470604[_0x11c4fd(0x2ed)]),_0x470604['onerror']=_0x56766a,_0x470604[_0x11c4fd(0x96e)](_0x271444);});}catch(_0x32ff28){return console['error'](_0x42f344(0x93),_0x32ff28),_0x432a95;}}function _0x463118(_0xcd0bc4,_0x9cae1f){const _0x43d889=_0x204348;if(!_0xcd0bc4||!_0x9cae1f||typeof _0xcd0bc4!==_0x43d889(0x861)||typeof _0x9cae1f!==_0x43d889(0x861))return 0x0;const _0x56d52f=_0xcd0bc4[_0x43d889(0x90b)]('.')['map'](Number),_0x5bef79=_0x9cae1f[_0x43d889(0x90b)]('.')['map'](Number),_0x47e732=Math[_0x43d889(0x538)](_0x56d52f[_0x43d889(0x131d)],_0x5bef79[_0x43d889(0x131d)]);for(let _0x4c1193=0x0;_0x4c1193<_0x47e732;_0x4c1193++){const _0x3e70b7=_0x56d52f[_0x4c1193]||0x0,_0x388c64=_0x5bef79[_0x4c1193]||0x0;if(_0x3e70b7>_0x388c64)return 0x1;if(_0x3e70b7<_0x388c64)return-0x1;}return 0x0;}async function _0x52a5ca(){const _0x5bd9d3=_0x204348,_0x478113=_0x5bd9d3(0x338);try{const _0x289592=await fetch(_0x5bd9d3(0x564)+Date[_0x5bd9d3(0x606)]());if(!_0x289592['ok']){console['warn'](_0x5bd9d3(0xe54));return;}const _0x394d62=await _0x289592['text'](),_0x574586=document[_0x5bd9d3(0xe7d)](_0x5bd9d3(0x1323));_0x574586['innerHTML']=_0x394d62;const _0x2b16ee=_0x574586[_0x5bd9d3(0x586)](_0x5bd9d3(0xa39));if(!_0x2b16ee){console['error'](_0x5bd9d3(0x103f));return;}const _0x1e7dbd=_0x2b16ee[_0x5bd9d3(0x1f4)][_0x5bd9d3(0x768)],_0x23e04e=localStorage['getItem']('dismissedUpdateVersion');!_0x23e04e||_0x463118(_0x1e7dbd,_0x23e04e)>0x0?(console[_0x5bd9d3(0x7d1)](_0x5bd9d3(0xd07)+_0x1e7dbd+_0x5bd9d3(0x6aa)+(_0x23e04e||'无')+')'),_0x496dd6(_0x1e7dbd,_0x2b16ee['innerHTML'])):console[_0x5bd9d3(0x7d1)](_0x5bd9d3(0xb6d)+_0x1e7dbd+_0x5bd9d3(0xbc3));}catch(_0x1335a9){console[_0x5bd9d3(0xb61)](_0x5bd9d3(0x13f0),_0x1335a9);}}function _0x496dd6(_0x35ff98,_0x1fa7dc){const _0x30fcf8=_0x204348,_0xd9c076=document[_0x30fcf8(0x458)](_0x30fcf8(0x11b6)),_0x45cb6c=document['getElementById'](_0x30fcf8(0x1018)),_0x436d5b=document[_0x30fcf8(0x458)](_0x30fcf8(0xbfa)),_0x279779=document[_0x30fcf8(0x458)]('update-notice-dismiss-btn');_0x45cb6c[_0x30fcf8(0x110d)]=_0x1fa7dc,_0x436d5b[_0x30fcf8(0xbe8)]=()=>{const _0x50896d=_0x30fcf8;_0xd9c076[_0x50896d(0x11c2)]['remove'](_0x50896d(0x67d));},_0x279779[_0x30fcf8(0xbe8)]=()=>{const _0x551872=_0x30fcf8;localStorage[_0x551872(0xc93)](_0x551872(0x390),_0x35ff98),_0xd9c076['classList'][_0x551872(0x1097)](_0x551872(0x67d)),console[_0x551872(0x7d1)](_0x551872(0x5b5)+_0x35ff98);},_0xd9c076[_0x30fcf8(0x11c2)][_0x30fcf8(0xa58)](_0x30fcf8(0x67d));}function _0x101770(){const _0x2ebc5a=_0x204348,_0x2273b3=document[_0x2ebc5a(0x458)]('douban-settings-modal');document['getElementById'](_0x2ebc5a(0x93f))[_0x2ebc5a(0x8dd)]=_0x42f206[_0x2ebc5a(0xf0)][_0x2ebc5a(0x69e)]||0xc,document[_0x2ebc5a(0x458)](_0x2ebc5a(0x648))[_0x2ebc5a(0x8dd)]=_0x42f206[_0x2ebc5a(0xf0)]['doubanMaxPosts']||0x14,_0x2273b3[_0x2ebc5a(0x11c2)]['add'](_0x2ebc5a(0x67d));}async function _0x25e967(){const _0x3ab90d=_0x204348,_0x3fe07=document[_0x3ab90d(0x458)](_0x3ab90d(0x93f)),_0x34a4b1=document[_0x3ab90d(0x458)]('douban-max-posts-input'),_0x4a0536=parseInt(_0x3fe07['value']),_0x55e5d2=parseInt(_0x34a4b1[_0x3ab90d(0x8dd)]);if(isNaN(_0x4a0536)||isNaN(_0x55e5d2)||_0x4a0536<0x1||_0x55e5d2<0x1){alert(_0x3ab90d(0xcea));return;}if(_0x4a0536>_0x55e5d2){alert('最小帖子数不能大于最大帖子数！');return;}_0x42f206['globalSettings'][_0x3ab90d(0x69e)]=_0x4a0536,_0x42f206[_0x3ab90d(0xf0)][_0x3ab90d(0x1274)]=_0x55e5d2,await _0x17d534['globalSettings'][_0x3ab90d(0xf3f)](_0x42f206[_0x3ab90d(0xf0)]),document['getElementById'](_0x3ab90d(0x108a))[_0x3ab90d(0x11c2)][_0x3ab90d(0x1097)]('visible'),await _0x34fce8(_0x3ab90d(0x1355),_0x3ab90d(0x1178));}async function _0x2d697f(_0x3536c8){const _0x439a5c=_0x204348,_0x3e2793=document['getElementById'](_0x439a5c(0x13d8)),_0x511e83=document[_0x439a5c(0x458)](_0x439a5c(0x47a));_0x511e83[_0x439a5c(0x110d)]='';let _0x28d382=[];if(_0x3536c8===_0x439a5c(0x655)){const _0x3fa1e6=Object[_0x439a5c(0x6eb)](_0x42f206[_0x439a5c(0x954)])[_0x439a5c(0xaf1)](_0x24d877=>!_0x24d877['isGroup']),_0x13b809=await _0x17d534[_0x439a5c(0x996)][_0x439a5c(0x511)]();_0x28d382=[{'id':_0x439a5c(0xf86),'name':_0x42f206[_0x439a5c(0x551)]['nickname']||'我','originalName':_0x42f206[_0x439a5c(0x551)][_0x439a5c(0x308)]||'我','avatar':_0x42f206[_0x439a5c(0x551)][_0x439a5c(0x5c6)],'type':_0x439a5c(0xf86)},..._0x3fa1e6[_0x439a5c(0xbf6)](_0x3b0105=>({'id':_0x3b0105['id'],'name':_0x3b0105[_0x439a5c(0x132a)],'originalName':_0x3b0105['originalName'],'avatar':_0x3b0105[_0x439a5c(0xda2)][_0x439a5c(0x9c7)],'type':_0x439a5c(0x4c5)})),..._0x13b809[_0x439a5c(0xbf6)](_0x3782de=>({'id':_0x439a5c(0xa45)+_0x3782de['id'],'name':_0x3782de[_0x439a5c(0x132a)],'originalName':_0x3782de['name'],'avatar':_0x3782de[_0x439a5c(0x5c6)],'type':_0x439a5c(0xe55)}))],_0xd93c0f[_0x439a5c(0xfca)]=null;}else{const _0x1d4bc6=_0x42f206[_0x439a5c(0x954)][_0x42f206['activeChatId']];if(!_0x1d4bc6||!_0x1d4bc6[_0x439a5c(0x726)])return;_0x28d382=[{'id':_0x439a5c(0xf86),'name':_0x1d4bc6[_0x439a5c(0xda2)]['myNickname']||'我','originalName':_0x42f206[_0x439a5c(0x551)][_0x439a5c(0x308)]||'我','avatar':_0x1d4bc6[_0x439a5c(0xda2)][_0x439a5c(0xa6)],'type':'user'},..._0x1d4bc6['members'][_0x439a5c(0xbf6)](_0x5383a4=>{const _0x5d20ec=_0x439a5c,_0x3b9c1a=_0x42f206[_0x5d20ec(0x954)][_0x5383a4['id']],_0x3ce537=_0x5383a4[_0x5d20ec(0x5c6)]||(_0x3b9c1a?_0x3b9c1a[_0x5d20ec(0xda2)][_0x5d20ec(0x9c7)]:_0x482806);return{'id':_0x5383a4['id'],'name':_0x5383a4[_0x5d20ec(0x1118)],'originalName':_0x5383a4['originalName'],'avatar':_0x3ce537,'type':_0x5383a4['isNpc']?'npc':'character'};})],_0xd93c0f[_0x439a5c(0xfca)]=_0x42f206[_0x439a5c(0x81d)];}_0x28d382[_0x439a5c(0x12c2)](_0x16e9df=>{const _0x8aae89=_0x439a5c,_0x468b85=document[_0x8aae89(0xe7d)]('div');_0x468b85[_0x8aae89(0x69b)]=_0x8aae89(0x28c),_0x468b85[_0x8aae89(0x110d)]=_0x8aae89(0xdda)+JSON[_0x8aae89(0xc04)](_0x16e9df)+'\x27\x20'+(_0x16e9df[_0x8aae89(0x259)]==='user'?_0x8aae89(0x1125):_0x8aae89(0x8f7))+_0x8aae89(0x106b)+_0x16e9df[_0x8aae89(0x5c6)]+_0x8aae89(0x10f0)+_0x16e9df[_0x8aae89(0x132a)]+_0x8aae89(0x106a),_0x511e83['appendChild'](_0x468b85);}),_0x3e2793['classList'][_0x439a5c(0xa58)](_0x439a5c(0x67d));}async function _0x4b2b5a(){const _0x1e6093=_0x204348,_0x302ef4=document[_0x1e6093(0x102a)](_0x1e6093(0xaa3)),_0x5ea607=_0x302ef4['length'];let _0x959367=[];if(_0x5ea607===0x6)_0xd93c0f[_0x1e6093(0xc6c)]='6p',_0x959367=['狼人','狼人','平民','平民','预言家','猎人'];else{if(_0x5ea607===0x9)_0xd93c0f[_0x1e6093(0xc6c)]='9p',_0x959367=['狼人','狼人','狼人','平民','平民','平民',_0x1e6093(0x104b),'女巫','猎人'];else{if(_0x5ea607===0xc)_0xd93c0f[_0x1e6093(0xc6c)]='12p',_0x959367=['狼人','狼人','狼人','狼人','平民','平民','平民','平民','预言家','女巫','猎人','守卫'];else{alert('当前人数\x20'+_0x5ea607+_0x1e6093(0x9e1));return;}}}document['getElementById'](_0x1e6093(0x13d8))[_0x1e6093(0x11c2)][_0x1e6093(0x1097)](_0x1e6093(0x67d)),await _0x34fce8('正在发牌...','游戏即将开始，正在为各位玩家分配身份...');for(let _0x46debb=_0x959367['length']-0x1;_0x46debb>0x0;_0x46debb--){const _0x2b556e=Math['floor'](Math[_0x1e6093(0x23a)]()*(_0x46debb+0x1));[_0x959367[_0x46debb],_0x959367[_0x2b556e]]=[_0x959367[_0x2b556e],_0x959367[_0x46debb]];}const _0x513718=Array['from'](_0x302ef4)[_0x1e6093(0xbf6)](_0x3c3b65=>JSON[_0x1e6093(0x44c)](_0x3c3b65[_0x1e6093(0x1f4)][_0x1e6093(0x8ec)]));_0xd93c0f[_0x1e6093(0x258)]=[];for(let _0x54cdf7=0x0;_0x54cdf7<_0x513718[_0x1e6093(0x131d)];_0x54cdf7++){const _0x405d7a=_0x513718[_0x54cdf7],_0x698527=_0x959367[_0x54cdf7];let _0xfa9b92=_0x1e6093(0x8ce);if(_0x405d7a[_0x1e6093(0x259)]===_0x1e6093(0x4c5)){const _0x45c9bb=_0x42f206[_0x1e6093(0x954)][_0x405d7a['id']];_0xfa9b92=_0x45c9bb?_0x45c9bb['settings']['aiPersona']:_0x1e6093(0xe2b);}else{if(_0x405d7a[_0x1e6093(0x259)]===_0x1e6093(0xe55)){const _0x5e3b79=await _0x17d534[_0x1e6093(0x996)][_0x1e6093(0x511)](),_0xff513a=_0x5e3b79[_0x1e6093(0xb07)](_0x13f5dc=>_0x1e6093(0xa45)+_0x13f5dc['id']===_0x405d7a['id']);_0xfa9b92=_0xff513a?_0xff513a[_0x1e6093(0x124d)]:_0x1e6093(0x11c5);}else{if(_0x405d7a[_0x1e6093(0x259)]===_0x1e6093(0xf86)){const _0x3545b3=_0xd93c0f[_0x1e6093(0xfca)]?_0x42f206[_0x1e6093(0x954)][_0xd93c0f[_0x1e6093(0xfca)]]:null;_0xfa9b92=_0x3545b3?_0x3545b3[_0x1e6093(0xda2)][_0x1e6093(0x65f)]:_0x1e6093(0x44b);}}}const _0x180c59={..._0x405d7a,'role':_0x698527,'isAlive':!![],'character_persona':_0xfa9b92};_0x698527==='女巫'&&(_0x180c59[_0x1e6093(0x7ff)]=![],_0x180c59['poisonUsed']=![]),_0x698527==='守卫'&&(_0x180c59[_0x1e6093(0x677)]=null),_0xd93c0f['players'][_0x1e6093(0x129e)](_0x180c59);}_0xd93c0f[_0x1e6093(0x1196)]=!![],_0xd93c0f['currentDay']=0x1,_0xd93c0f[_0x1e6093(0x111c)]=_0x1e6093(0xf07),_0xd93c0f[_0x1e6093(0xe59)]=[],_0xd93c0f[_0x1e6093(0x79a)]=[];const _0x2d6412=_0x959367[_0x1e6093(0x1450)]((_0x424c21,_0x18747d)=>{return _0x424c21[_0x18747d]=(_0x424c21[_0x18747d]||0x0)+0x1,_0x424c21;},{}),_0x1a46e9=Object['entries'](_0x2d6412)[_0x1e6093(0xbf6)](([_0x40bc1e,_0x2b0862])=>_0x40bc1e+'\x20x'+_0x2b0862)[_0x1e6093(0x56c)]('、');_0x4906f0(_0x1e6093(0x587)+_0x5ea607+'人局，身份为\x20'+_0x1a46e9+'。');const _0x3c3cfe=_0xd93c0f[_0x1e6093(0x258)][_0x1e6093(0xb07)](_0x2c07ce=>_0x2c07ce['id']===_0x1e6093(0xf86));_0x45e6fd(),_0x589d88(_0x1e6093(0x12d3)),_0x5e5612(_0x3c3cfe['role']);}function _0x45e6fd(){const _0x57fb94=_0x204348,_0xd4fba4=document[_0x57fb94(0x458)]('werewolf-player-grid');_0xd4fba4['innerHTML']='';const _0x4c3037=[..._0xd93c0f[_0x57fb94(0x258)]]['sort']((_0x2fbda0,_0x574858)=>_0x2fbda0[_0x57fb94(0xbce)]-_0x574858['isAlive']);_0x4c3037[_0x57fb94(0x12c2)]((_0x2c448c,_0x27c333)=>{const _0x56f3f4=_0x57fb94,_0x506404=_0xd93c0f[_0x56f3f4(0x258)][_0x56f3f4(0x4a8)](_0x13998d=>_0x13998d['id']===_0x2c448c['id'])+0x1,_0x50f675=document[_0x56f3f4(0xe7d)](_0x56f3f4(0x1323));_0x50f675[_0x56f3f4(0x69b)]=_0x56f3f4(0xc2b);if(!_0x2c448c['isAlive'])_0x50f675['classList'][_0x56f3f4(0xa58)](_0x56f3f4(0x119b));_0x50f675[_0x56f3f4(0x110d)]=_0x56f3f4(0x442)+_0x2c448c[_0x56f3f4(0x5c6)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>'+_0x506404+'.\x20'+_0x2c448c[_0x56f3f4(0x132a)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0xd4fba4[_0x56f3f4(0x1079)](_0x50f675);});const _0x271fa4=document['getElementById']('werewolf-log');_0x271fa4['innerHTML']='';for(let _0x2fa09c=0x1;_0x2fa09c<=_0xd93c0f[_0x57fb94(0x1206)];_0x2fa09c++){const _0x4652ac=[..._0xd93c0f[_0x57fb94(0xe59)]['filter'](_0x1022d0=>_0x1022d0[_0x57fb94(0xf47)]===_0x2fa09c),..._0xd93c0f[_0x57fb94(0x79a)][_0x57fb94(0xaf1)](_0x404649=>_0x404649[_0x57fb94(0xf47)]===_0x2fa09c)][_0x57fb94(0xc12)]((_0x337bd0,_0x257d72)=>(_0x337bd0['timestamp']||0x0)-(_0x257d72[_0x57fb94(0xf16)]||0x0));if(_0x4652ac[_0x57fb94(0x131d)]>0x0){const _0x32bb1b=document[_0x57fb94(0xe7d)]('div');_0x32bb1b[_0x57fb94(0x69b)]='werewolf-log-entry\x20system',_0x32bb1b[_0x57fb94(0x1a2)]=_0x57fb94(0xa30)+_0x2fa09c+_0x57fb94(0xfa5),_0x32bb1b[_0x57fb94(0x1104)][_0x57fb94(0x11f)]=_0x57fb94(0xda3),_0x271fa4[_0x57fb94(0x1079)](_0x32bb1b),_0x4652ac[_0x57fb94(0x12c2)](_0x31efb4=>{const _0x1aea89=_0x57fb94,_0x2e1c6b=document['createElement'](_0x1aea89(0x1323));_0x2e1c6b[_0x1aea89(0x69b)]=_0x1aea89(0x958)+_0x31efb4[_0x1aea89(0x259)],_0x31efb4['type']==='dialogue'?_0x2e1c6b[_0x1aea89(0x110d)]=_0x1aea89(0x7f3)+_0x31efb4[_0x1aea89(0x132e)]+_0x1aea89(0x1061)+_0x31efb4[_0x1aea89(0x1316)]:_0x2e1c6b['textContent']=_0x31efb4[_0x1aea89(0x1316)],_0x271fa4[_0x1aea89(0x1079)](_0x2e1c6b);});}}_0x271fa4['scrollTop']=_0x271fa4[_0x57fb94(0x94b)];const _0x3793db={'start':_0x57fb94(0x5e3),'night':'第'+_0xd93c0f[_0x57fb94(0x1206)]+_0x57fb94(0x106e),'day':'第'+_0xd93c0f[_0x57fb94(0x1206)]+_0x57fb94(0x787),'discussion':'第'+_0xd93c0f[_0x57fb94(0x1206)]+'天\x20-\x20讨论','voting':'第'+_0xd93c0f[_0x57fb94(0x1206)]+_0x57fb94(0xad2),'gameover':_0x57fb94(0x138e)};document['getElementById'](_0x57fb94(0x58b))[_0x57fb94(0x1a2)]='狼人杀\x20-\x20'+(_0x3793db[_0xd93c0f[_0x57fb94(0x111c)]]||_0xd93c0f[_0x57fb94(0x111c)]);}function _0x5e5612(_0x4c3822){const _0x3e1e5=_0x204348,_0x5652e0={'狼人':_0x3e1e5(0xbec),'平民':_0x3e1e5(0x982),'预言家':_0x3e1e5(0x12e0),'猎人':'当你死亡时，你可以选择带走场上任意一名玩家。','女巫':_0x3e1e5(0xb9f),'守卫':_0x3e1e5(0x1de)};document[_0x3e1e5(0x458)](_0x3e1e5(0x12f4))[_0x3e1e5(0x1a2)]=_0x4c3822,document[_0x3e1e5(0x458)]('werewolf-role-description')[_0x3e1e5(0x1a2)]=_0x5652e0[_0x4c3822]||_0x3e1e5(0xcd7),document[_0x3e1e5(0x458)]('werewolf-role-modal')[_0x3e1e5(0x11c2)][_0x3e1e5(0xa58)](_0x3e1e5(0x67d));}async function _0x504297(){const _0x536d87=_0x204348;_0xd93c0f[_0x536d87(0x111c)]='第'+_0xd93c0f[_0x536d87(0x1206)]+'天\x20-\x20夜晚',_0xd93c0f[_0x536d87(0x469)]={},_0x4906f0(_0x536d87(0xb0)),_0x45e6fd(),document[_0x536d87(0x458)]('werewolf-action-bar')[_0x536d87(0x1104)][_0x536d87(0x4db)]=_0x536d87(0x464),document[_0x536d87(0x458)](_0x536d87(0x6f0))['style'][_0x536d87(0x4db)]=_0x536d87(0x464),await new Promise(_0x49b829=>setTimeout(_0x49b829,0x5dc));const _0x6745b8=_0xd93c0f['players']['find'](_0x46b7f0=>_0x46b7f0[_0x536d87(0xaeb)]==='守卫'&&_0x46b7f0[_0x536d87(0xbce)]);if(_0x6745b8){_0x4906f0('守卫请睁眼，请选择要守护的玩家。'),_0x45e6fd();let _0x18c540=null;if(_0x6745b8['id']===_0x536d87(0xf86))_0x18c540=await _0x5ae7ac(_0x536d87(0x750),_0x6745b8[_0x536d87(0x677)]);else{const _0x44786b=_0xd93c0f[_0x536d87(0x258)][_0x536d87(0xaf1)](_0x34dc66=>_0x34dc66['isAlive']&&_0x34dc66['id']!==_0x6745b8[_0x536d87(0x677)]);_0x44786b[_0x536d87(0x131d)]>0x0&&(_0x18c540=_0x44786b[Math[_0x536d87(0xbd5)](Math['random']()*_0x44786b[_0x536d87(0x131d)])]['id']);}_0x18c540&&(_0xd93c0f[_0x536d87(0x469)][_0x536d87(0x449)]=_0x18c540,_0x6745b8[_0x536d87(0x677)]=_0x18c540),_0x4906f0(_0x536d87(0xc34)),_0x45e6fd(),await new Promise(_0x2795a4=>setTimeout(_0x2795a4,0x5dc));}_0x4906f0('狼人请睁眼，请选择要刀的玩家。'),_0x45e6fd();const _0x17ba20=_0xd93c0f[_0x536d87(0x258)][_0x536d87(0xaf1)](_0x3912cf=>_0x3912cf[_0x536d87(0xaeb)]==='狼人'&&_0x3912cf[_0x536d87(0xbce)]),_0x561d56=_0x17ba20[_0x536d87(0x593)](_0x4822fb=>_0x4822fb['id']===_0x536d87(0xf86));let _0x1e09c2=null;_0xd93c0f['lastFailedAction']=_0x536d87(0xe2a);try{if(_0x561d56)_0x4906f0('你是狼人，请选择刀人目标。'),_0x45e6fd(),_0x1e09c2=await _0x57738c();else{if(_0xd93c0f[_0x536d87(0x1206)]===0x1){console[_0x536d87(0x7d1)](_0x536d87(0xd28));const _0x2a232e=_0xd93c0f[_0x536d87(0x258)][_0x536d87(0xaf1)](_0x4c973e=>_0x4c973e[_0x536d87(0xbce)]&&_0x4c973e[_0x536d87(0xaeb)]!=='狼人');_0x2a232e['length']>0x0&&(_0x1e09c2=_0x2a232e[Math[_0x536d87(0xbd5)](Math[_0x536d87(0x23a)]()*_0x2a232e[_0x536d87(0x131d)])]['id']);}else _0x1e09c2=await _0x19db48();}_0xd93c0f[_0x536d87(0xb28)]=null;}catch(_0xf6cfe6){console[_0x536d87(0xb61)](_0x536d87(0x52a),_0xf6cfe6),await _0x34fce8(_0x536d87(0x96d),'AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。'),document['getElementById'](_0x536d87(0x6f0))[_0x536d87(0x1104)][_0x536d87(0x4db)]=_0x536d87(0x1188);return;}_0xd93c0f[_0x536d87(0x469)][_0x536d87(0xa5a)]=_0x1e09c2,_0x4906f0(_0x536d87(0x241)),_0x45e6fd(),await new Promise(_0x10cd33=>setTimeout(_0x10cd33,0x5dc));const _0x1d991e=_0xd93c0f[_0x536d87(0x258)][_0x536d87(0xb07)](_0x84824=>_0x84824[_0x536d87(0xaeb)]==='女巫'&&_0x84824['isAlive']);if(_0x1d991e){_0x4906f0(_0x536d87(0x1218)),_0x45e6fd();const _0x12682e=_0xd93c0f[_0x536d87(0x258)][_0x536d87(0xb07)](_0x1fd155=>_0x1fd155['id']===_0xd93c0f[_0x536d87(0x469)][_0x536d87(0xa5a)]),_0x154b3e=_0xd93c0f[_0x536d87(0x469)][_0x536d87(0x449)]===_0xd93c0f[_0x536d87(0x469)][_0x536d87(0xa5a)],_0x4ad18f=_0x154b3e||!_0x12682e?null:_0x12682e;if(_0x1d991e['id']===_0x536d87(0xf86)){let _0x5b6011=await _0x55a293(_0x4ad18f,_0x1d991e);_0x5b6011[_0x536d87(0x133e)]&&(_0xd93c0f['nightActions'][_0x536d87(0x3fa)]=_0xd93c0f[_0x536d87(0x469)][_0x536d87(0xa5a)],_0x1d991e[_0x536d87(0x7ff)]=!![]),_0x5b6011[_0x536d87(0x2bc)]&&(_0xd93c0f[_0x536d87(0x469)][_0x536d87(0xafe)]=_0x5b6011[_0x536d87(0x2bc)],_0x1d991e[_0x536d87(0x109d)]=!![]);}else{if(!_0x1d991e['antidoteUsed']&&_0x4ad18f){let _0xc30caa=0x0;_0xd93c0f[_0x536d87(0x1206)]===0x1?_0xc30caa=0.3:_0xc30caa=0.8,console[_0x536d87(0x7d1)](_0x536d87(0x1157)+_0xd93c0f[_0x536d87(0x1206)]+_0x536d87(0x43e)+_0xc30caa*0x64+'%'),Math['random']()<_0xc30caa?(console[_0x536d87(0x7d1)](_0x536d87(0x128c)),_0xd93c0f[_0x536d87(0x469)][_0x536d87(0x3fa)]=_0xd93c0f[_0x536d87(0x469)]['killedId'],_0x1d991e[_0x536d87(0x7ff)]=!![]):console[_0x536d87(0x7d1)](_0x536d87(0x555));}if(!_0xd93c0f['nightActions']['savedId']&&!_0x1d991e[_0x536d87(0x109d)]&&Math[_0x536d87(0x23a)]()<0.5){const _0x51fd3a=_0xd93c0f['players'][_0x536d87(0xaf1)](_0x77dafe=>_0x77dafe[_0x536d87(0xbce)]&&_0x77dafe['id']!==_0xd93c0f[_0x536d87(0x469)][_0x536d87(0xa5a)]);if(_0x51fd3a['length']>0x0){const _0x510012=_0x51fd3a[Math['floor'](Math[_0x536d87(0x23a)]()*_0x51fd3a['length'])];_0xd93c0f[_0x536d87(0x469)][_0x536d87(0xafe)]=_0x510012['id'],_0x1d991e[_0x536d87(0x109d)]=!![],console[_0x536d87(0x7d1)](_0x536d87(0x13ba)+_0x510012[_0x536d87(0x132a)]);}}}_0x4906f0(_0x536d87(0x133b)),_0x45e6fd(),await new Promise(_0x571e84=>setTimeout(_0x571e84,0x5dc));}const _0x3f776b=_0xd93c0f['players'][_0x536d87(0xb07)](_0x451a0f=>_0x451a0f[_0x536d87(0xaeb)]===_0x536d87(0x104b)&&_0x451a0f['isAlive']);if(_0x3f776b){_0x4906f0(_0x536d87(0x1202)),_0x45e6fd();if(_0x3f776b['id']===_0x536d87(0xf86)){const _0xdecccc=await _0x5ae7ac('prophet'),_0x234d66=_0xd93c0f[_0x536d87(0x258)]['find'](_0x25b16a=>_0x25b16a['id']===_0xdecccc);if(_0x234d66){const _0x29179a=_0x234d66[_0x536d87(0xaeb)]==='狼人';await _0x34fce8(_0x536d87(0x4d1),_0x536d87(0x11b2)+_0x234d66[_0x536d87(0x132a)]+_0x536d87(0x3c4)+(_0x29179a?'狼人':'好人')),_0xd93c0f[_0x536d87(0x469)]['prophetCheck']={'target':_0xdecccc,'result':_0x29179a?'狼人':'好人'};}}else{const _0x41416d=_0xd93c0f['players'][_0x536d87(0xaf1)](_0x303f63=>_0x303f63[_0x536d87(0xbce)]&&_0x303f63['id']!==_0x3f776b['id']);if(_0x41416d[_0x536d87(0x131d)]>0x0){const _0x4e3bad=_0x41416d[Math[_0x536d87(0xbd5)](Math[_0x536d87(0x23a)]()*_0x41416d[_0x536d87(0x131d)])];_0xd93c0f[_0x536d87(0x469)][_0x536d87(0xc82)]={'target':_0x4e3bad['id'],'result':_0x4e3bad[_0x536d87(0xaeb)]==='狼人'?'狼人':'好人'};}}_0x4906f0(_0x536d87(0x7e3)),_0x45e6fd(),await new Promise(_0x3d2a3a=>setTimeout(_0x3d2a3a,0x5dc));}_0x2ed577();}async function _0x2ed577(){const _0x4f7182=_0x204348;_0xd93c0f[_0x4f7182(0x111c)]='第'+_0xd93c0f[_0x4f7182(0x1206)]+_0x4f7182(0x787),_0xd93c0f[_0x4f7182(0x105d)]={},_0x4906f0(_0x4f7182(0x1011));const {killedId:_0x4f44de,guardedId:_0x1eef37,savedId:_0x161eb4,poisonedId:_0x3f812f}=_0xd93c0f[_0x4f7182(0x469)],_0x239f79=new Set();_0x4f44de&&_0x4f44de!==_0x1eef37&&_0x4f44de!==_0x161eb4&&_0x239f79[_0x4f7182(0xa58)](_0x4f44de);_0x3f812f&&_0x239f79[_0x4f7182(0xa58)](_0x3f812f);if(_0x239f79[_0x4f7182(0x12a4)]===0x0)_0x4906f0(_0x4f7182(0x8ac));else for(const _0x1739fe of _0x239f79){const _0x20686f=_0xd93c0f[_0x4f7182(0x258)]['find'](_0x31d164=>_0x31d164['id']===_0x1739fe);if(_0x20686f&&_0x20686f['isAlive']){_0x20686f[_0x4f7182(0xbce)]=![],_0x4906f0(_0x4f7182(0xabc)+_0x20686f[_0x4f7182(0x132a)]+_0x4f7182(0x84));if(_0x20686f['role']==='猎人'){_0x4906f0('猎人死亡，请选择一名玩家带走！'),_0x45e6fd();let _0x378885=null;if(_0x20686f['id']===_0x4f7182(0xf86))_0x378885=await _0x5ae7ac(_0x4f7182(0x732));else{const _0x642b52=_0xd93c0f['players'][_0x4f7182(0xaf1)](_0x4e3170=>_0x4e3170[_0x4f7182(0xbce)]&&_0x4e3170['id']!==_0x20686f['id']);_0x642b52[_0x4f7182(0x131d)]>0x0&&(_0x378885=_0x642b52[Math[_0x4f7182(0xbd5)](Math[_0x4f7182(0x23a)]()*_0x642b52[_0x4f7182(0x131d)])]['id']);}const _0x138298=_0xd93c0f[_0x4f7182(0x258)]['find'](_0x2f1087=>_0x2f1087['id']===_0x378885);_0x138298&&(_0x138298[_0x4f7182(0xbce)]=![],_0x4906f0(_0x4f7182(0x627)+_0x138298['name']+'。'));}}}_0x45e6fd();if(_0x282413())return;await _0x557e0c();}async function _0x557e0c(){const _0x524ae3=_0x204348;_0x4906f0('现在开始讨论，请各位玩家依次发言。'),_0x45e6fd();const {proxyUrl:_0x404931,apiKey:_0x3cdec3,model:_0x1a1a91}=_0x42f206[_0x524ae3(0x5cb)];if(!_0x404931||!_0x3cdec3||!_0x1a1a91){alert(_0x524ae3(0xd5d));return;}const _0x20c7ee=_0x1426e2();_0xd93c0f['lastFailedAction']=_0x524ae3(0xe7c);try{await _0x34fce8('请稍候',_0x524ae3(0x11a4));let _0x31b7b5=_0x404931[_0x524ae3(0xd8d)](_0x524ae3(0xfe3)),_0x27e345=[{'role':_0x524ae3(0xf86),'content':'请所有AI角色根据你们的身份和人设开始发言。'}],_0x42d9a7=_0x5d73db(_0x1a1a91,_0x3cdec3,_0x20c7ee,_0x27e345);const _0x8a7f75=_0x31b7b5?await fetch(_0x42d9a7[_0x524ae3(0x1377)],_0x42d9a7[_0x524ae3(0x76b)]):await fetch(_0x404931+_0x524ae3(0xd7),{'method':_0x524ae3(0x1312),'headers':{'Content-Type':_0x524ae3(0xa0e),'Authorization':_0x524ae3(0x8aa)+_0x3cdec3},'body':JSON['stringify']({'model':_0x1a1a91,'messages':[{'role':'system','content':_0x20c7ee},..._0x27e345],'temperature':_0x42f206[_0x524ae3(0xf0)][_0x524ae3(0xfdf)]||0.95})});if(!_0x8a7f75['ok']){const _0xd65c50=await _0x8a7f75[_0x524ae3(0xaef)]();throw new Error(_0x524ae3(0x676)+_0xd65c50[_0x524ae3(0xb61)]['message']);}const _0x2e0ff1=await _0x8a7f75[_0x524ae3(0xaef)](),_0xa7fcd2=getGeminiResponseText(_0x2e0ff1),_0x3f74fb=_0xa7fcd2[_0x524ae3(0x41c)](/(\[[\s\S]*\])/);if(!_0x3f74fb)throw new Error('AI返回的讨论内容格式不正确。原始返回:\x20'+_0xa7fcd2);const _0x283580=JSON[_0x524ae3(0x44c)](_0x3f74fb[0x0]);for(const _0x253a9b of _0x283580){_0x253a9b[_0x524ae3(0xc47)]&&_0x253a9b[_0x524ae3(0x4d9)]&&(_0x1c6644(_0x253a9b[_0x524ae3(0xc47)],_0x253a9b['dialogue']),_0x45e6fd(),await new Promise(_0x24386f=>setTimeout(_0x24386f,0x5dc+Math['random']()*0x7d0)));}_0xd93c0f[_0x524ae3(0xb28)]=null;}catch(_0x51791f){console['error'](_0x524ae3(0xf9d),_0x51791f),await _0x34fce8(_0x524ae3(0x137b),_0x524ae3(0x7a6)+_0x51791f[_0x524ae3(0x7aa)]),document[_0x524ae3(0x458)](_0x524ae3(0x6f0))[_0x524ae3(0x1104)][_0x524ae3(0x4db)]=_0x524ae3(0x1188);return;}const _0x35e15a=_0xd93c0f[_0x524ae3(0x258)][_0x524ae3(0xb07)](_0x5f0ec4=>_0x5f0ec4['id']==='user'),_0x21b97f=document['getElementById']('werewolf-action-bar'),_0x41dcd5=document[_0x524ae3(0x458)](_0x524ae3(0x32f)),_0x33484d=document['getElementById'](_0x524ae3(0x65c)),_0x4e66e8=document[_0x524ae3(0x458)](_0x524ae3(0x129f));_0x21b97f[_0x524ae3(0x1104)][_0x524ae3(0x4db)]='flex';if(_0x35e15a&&_0x35e15a[_0x524ae3(0xbce)]){_0x41dcd5['textContent']=_0x524ae3(0xa9c),_0x33484d[_0x524ae3(0x1a2)]=_0x524ae3(0x979),_0x41dcd5[_0x524ae3(0x1104)][_0x524ae3(0x4db)]='block',_0x33484d[_0x524ae3(0x1104)][_0x524ae3(0x4db)]='block',_0x4e66e8[_0x524ae3(0xb18)]=![],_0x4e66e8[_0x524ae3(0x134b)]='轮到你发言了...',_0x4e66e8['focus']();const _0x4269fd=_0x41dcd5[_0x524ae3(0x350)](!![]);_0x41dcd5[_0x524ae3(0x135e)][_0x524ae3(0x3f2)](_0x4269fd,_0x41dcd5),_0x4269fd[_0x524ae3(0xd85)](_0x524ae3(0x1122),_0x1823ea);const _0x515b9c=_0x33484d[_0x524ae3(0x350)](!![]);_0x33484d['parentNode'][_0x524ae3(0x3f2)](_0x515b9c,_0x33484d),_0x515b9c[_0x524ae3(0xd85)]('click',_0x39b91e);}else{_0x4906f0(_0x524ae3(0x116a)),_0x45e6fd(),_0x41dcd5[_0x524ae3(0x1a2)]=_0x524ae3(0xec5),_0x33484d[_0x524ae3(0x1a2)]=_0x524ae3(0x3eb),_0x41dcd5['style'][_0x524ae3(0x4db)]=_0x524ae3(0x1188),_0x33484d[_0x524ae3(0x1104)]['display']=_0x524ae3(0x1188),_0x4e66e8[_0x524ae3(0xb18)]=!![],_0x4e66e8[_0x524ae3(0x134b)]=_0x524ae3(0xaa1);const _0x2528f6=_0x41dcd5[_0x524ae3(0x350)](!![]);_0x41dcd5[_0x524ae3(0x135e)][_0x524ae3(0x3f2)](_0x2528f6,_0x41dcd5),_0x2528f6['addEventListener'](_0x524ae3(0x1122),_0x4cfd49);const _0x3847c8=_0x33484d[_0x524ae3(0x350)](!![]);_0x33484d[_0x524ae3(0x135e)][_0x524ae3(0x3f2)](_0x3847c8,_0x33484d),_0x3847c8[_0x524ae3(0xd85)]('click',_0x105ffb);}}function _0x1426e2(){const _0x3c7c59=_0x204348,_0x568c4a=_0xd93c0f[_0x3c7c59(0x258)][_0x3c7c59(0xaf1)](_0x4af9d7=>_0x4af9d7[_0x3c7c59(0xbce)]),_0x36f1da=_0xd93c0f[_0x3c7c59(0x258)][_0x3c7c59(0xb07)](_0x46837d=>_0x46837d['id']==='user'),_0x11994a=_0x36f1da?_0x36f1da[_0x3c7c59(0x132a)]:'用户',_0x254d8a=_0x568c4a['some'](_0x295fe5=>_0x295fe5['id']===_0x3c7c59(0xf86));let _0x502015='#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a';_0x502015+='这是所有在场玩家的公开信息、人设和社交背景。\x0a',_0x568c4a[_0x3c7c59(0x12c2)]((_0x264dc1,_0x18b2d8)=>{const _0x3dcd5a=_0x3c7c59,_0x4d5598=_0xd93c0f['players'][_0x3dcd5a(0x4a8)](_0xc87ecb=>_0xc87ecb['id']===_0x264dc1['id'])+0x1;let _0x138a07='';const _0x3b51ce=_0x42f206[_0x3dcd5a(0x954)][_0x264dc1['id']];if(_0x3b51ce){const _0x2d2a43=_0x568c4a[_0x3dcd5a(0xaf1)](_0x34c393=>_0x34c393['id']!==_0x264dc1['id']&&_0x42f206[_0x3dcd5a(0x954)][_0x34c393['id']]&&_0x42f206[_0x3dcd5a(0x954)][_0x34c393['id']]['groupId']===_0x3b51ce[_0x3dcd5a(0x1437)]&&_0x3b51ce[_0x3dcd5a(0x1437)]!==null)[_0x3dcd5a(0xbf6)](_0x415ff5=>_0x415ff5[_0x3dcd5a(0x132a)])[_0x3dcd5a(0x56c)]('、');_0x2d2a43&&(_0x138a07+='-\x20**你的好友\x20(必须保护)**:\x20你和\x20'+_0x2d2a43+_0x3dcd5a(0x10d5));}_0x264dc1['id']!=='user'&&(_0x138a07+=_0x3dcd5a(0xb97)+_0x11994a+')的关系请参考你的人设、长期记忆和最近的对话。\x0a');_0x502015+=_0x3dcd5a(0xb7a)+_0x4d5598+_0x3dcd5a(0x934)+_0x264dc1['name']+'\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20'+_0x264dc1[_0x3dcd5a(0xa1)]+_0x3dcd5a(0x11a8)+(_0x264dc1['id']===_0x3dcd5a(0xf86)?_0x3dcd5a(0x776):_0x3dcd5a(0x5f3))+_0x3dcd5a(0x4c1)+_0x264dc1['character_persona']+'\x0a';if(_0x264dc1['type']===_0x3dcd5a(0x4c5)){const _0x46faab=_0x42f206[_0x3dcd5a(0x954)][_0x264dc1['id']];if(_0x46faab&&_0x46faab[_0x3dcd5a(0x94a)]&&_0x46faab[_0x3dcd5a(0x94a)]['length']>0x0){const _0x49a76a=_0x46faab[_0x3dcd5a(0x94a)][_0x3dcd5a(0xbf6)](_0x3e0d4d=>_0x3e0d4d[_0x3dcd5a(0x1316)])[_0x3dcd5a(0x56c)](';\x20');_0x502015+=_0x3dcd5a(0x772)+_0x49a76a+'\x0a';}}_0x138a07&&(_0x502015+='\x0a-\x20**你的社交关系\x20(必须参考)**:\x0a'+_0x138a07);});let _0x4c3eaf='#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a';_0x4c3eaf+='这是所有玩家都能听到的【公开信息】。\x0a';const _0xbf9f8d=_0xd93c0f[_0x3c7c59(0xe59)][_0x3c7c59(0xaf1)](_0x4a4f10=>_0x4a4f10['content'][_0x3c7c59(0xd8d)](_0x3c7c59(0xed2))&&_0x4a4f10[_0x3c7c59(0xf47)]===_0xd93c0f['currentDay']);_0xbf9f8d[_0x3c7c59(0x131d)]===0x0?_0x4c3eaf+='-\x20昨晚是平安夜，无人死亡。\x0a':_0xbf9f8d[_0x3c7c59(0x12c2)](_0x160098=>{const _0x5bba11=_0x3c7c59;_0x4c3eaf+='-\x20'+_0x160098[_0x5bba11(0x1316)]+'\x0a';});let _0xcb12ba=_0x3c7c59(0x681);if(_0xd93c0f[_0x3c7c59(0x1206)]>0x1)for(let _0x39924e=0x1;_0x39924e<_0xd93c0f[_0x3c7c59(0x1206)];_0x39924e++){_0xcb12ba+=_0x3c7c59(0xf9)+_0x39924e+_0x3c7c59(0xeb2);const _0x3dcc58=_0xd93c0f['gameLog'][_0x3c7c59(0xaf1)](_0x1c25f3=>_0x1c25f3[_0x3c7c59(0xf47)]===_0x39924e&&(_0x1c25f3[_0x3c7c59(0x1316)][_0x3c7c59(0xd8d)]('死亡')||_0x1c25f3[_0x3c7c59(0x1316)][_0x3c7c59(0xd8d)]('放逐')));_0x3dcc58[_0x3c7c59(0x131d)]>0x0?_0xcb12ba+=_0x3c7c59(0x7e5)+_0x3dcc58['map'](_0xa751c4=>_0xa751c4[_0x3c7c59(0x1316)])['join']('\x20')+'\x0a':_0xcb12ba+=_0x3c7c59(0x844);const _0xcb0135=_0xd93c0f[_0x3c7c59(0x79a)][_0x3c7c59(0xaf1)](_0x22f66e=>_0x22f66e[_0x3c7c59(0xf47)]===_0x39924e);_0xcb0135[_0x3c7c59(0x131d)]>0x0&&(_0xcb12ba+=_0x3c7c59(0x707)+_0xcb0135[_0x3c7c59(0xbf6)](_0x56f77a=>'-\x20'+_0x56f77a[_0x3c7c59(0x132e)]+':\x20'+_0x56f77a['content'])[_0x3c7c59(0x56c)]('\x0a')+'\x0a');}else _0xcb12ba+=_0x3c7c59(0x348);let _0x32b302='#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a';const _0x532301=_0xd93c0f[_0x3c7c59(0x79a)]['filter'](_0x1f909e=>_0x1f909e['day']===_0xd93c0f[_0x3c7c59(0x1206)]);_0x532301[_0x3c7c59(0x131d)]>0x0?_0x32b302+=_0x532301[_0x3c7c59(0xbf6)](_0x15d598=>_0x3c7c59(0x1293)+_0x15d598[_0x3c7c59(0x132e)]+'**:\x20'+_0x15d598[_0x3c7c59(0x1316)])[_0x3c7c59(0x56c)]('\x0a'):_0x32b302+=_0x3c7c59(0xc19);let _0x5ea1e2='\x0a#\x20【【【逻辑隔离与TGS三核思考\x20(最高优先级指令)】】】\x0a为了兼顾游戏逻辑和角色扮演，你【必须】在内部为【每一个AI角色】按顺序执行以下“三阶段思考”：\x0a\x0a##\x20阶段1：内部独立思考\x20(Internal\x20Monologue\x20Scratchpad)\x0a(这部分内容【绝对不能】出现在你最终的JSON输出中，这仅供你内部模拟使用)\x0a';_0x568c4a[_0x3c7c59(0x12c2)](_0x2aca45=>{const _0x1e8e84=_0x3c7c59;if(_0x2aca45['id']!==_0x1e8e84(0xf86)){const _0x2ed9c4=_0xd93c0f[_0x1e8e84(0x258)][_0x1e8e84(0x4a8)](_0xb8ed69=>_0xb8ed69['id']===_0x2aca45['id'])+0x1;_0x5ea1e2+=_0x1e8e84(0x320)+_0x2ed9c4+'号玩家:\x20'+_0x2aca45['name']+_0x1e8e84(0x2dd)+_0x2aca45[_0x1e8e84(0xa1)]+_0x1e8e84(0xf0d)+_0x2aca45[_0x1e8e84(0xaeb)]+_0x1e8e84(0xfcc);let _0x831b55='';if(_0x2aca45[_0x1e8e84(0xaeb)]==='狼人'){const _0x32aed8=_0xd93c0f[_0x1e8e84(0x258)][_0x1e8e84(0xaf1)](_0x2e7da=>_0x2e7da[_0x1e8e84(0xaeb)]==='狼人'&&_0x2e7da['id']!==_0x2aca45['id']&&_0x2e7da[_0x1e8e84(0xbce)])['map'](_0xda3023=>_0xda3023[_0x1e8e84(0x132a)])[_0x1e8e84(0x56c)]('、');_0x831b55+=_0x1e8e84(0x326)+(_0x32aed8||'无')+'\x0a';const _0x14a91b=_0xd93c0f[_0x1e8e84(0x258)]['find'](_0x5d284c=>_0x5d284c['id']===_0xd93c0f[_0x1e8e84(0x469)][_0x1e8e84(0xa5a)]);_0x831b55+='\x20\x20\x20\x20-\x20我们昨晚攻击了：'+(_0x14a91b?_0x14a91b['name']:'空刀')+'\x0a';}if(_0x2aca45[_0x1e8e84(0xaeb)]===_0x1e8e84(0x104b)&&_0xd93c0f[_0x1e8e84(0x469)][_0x1e8e84(0xc82)]){const _0x3ceedf=_0xd93c0f[_0x1e8e84(0x258)][_0x1e8e84(0xb07)](_0x3228cd=>_0x3228cd['id']===_0xd93c0f[_0x1e8e84(0x469)][_0x1e8e84(0xc82)][_0x1e8e84(0x12df)]);_0x831b55+='\x20\x20\x20\x20-\x20我昨晚查验了\x20'+_0x3ceedf[_0x1e8e84(0x132a)]+_0x1e8e84(0x10e4)+_0xd93c0f['nightActions']['prophetCheck'][_0x1e8e84(0x2ed)]+'】\x0a';}if(_0x2aca45[_0x1e8e84(0xaeb)]==='女巫'){if(_0xd93c0f[_0x1e8e84(0x469)][_0x1e8e84(0x3fa)]){const _0x34f094=_0xd93c0f[_0x1e8e84(0x258)][_0x1e8e84(0xb07)](_0x5376ad=>_0x5376ad['id']===_0xd93c0f[_0x1e8e84(0x469)][_0x1e8e84(0x3fa)]);_0x831b55+=_0x1e8e84(0xefb)+_0x34f094['name']+'。\x0a';}if(_0xd93c0f['nightActions'][_0x1e8e84(0xafe)]){const _0x3308f7=_0xd93c0f[_0x1e8e84(0x258)][_0x1e8e84(0xb07)](_0x3daecb=>_0x3daecb['id']===_0xd93c0f['nightActions'][_0x1e8e84(0xafe)]);_0x831b55+=_0x1e8e84(0x3d5)+_0x3308f7[_0x1e8e84(0x132a)]+'。\x0a';}_0x831b55+='\x20\x20\x20\x20-\x20我的解药：'+(_0x2aca45['antidoteUsed']?_0x1e8e84(0x796):_0x1e8e84(0x8b9))+'\x0a',_0x831b55+=_0x1e8e84(0xecf)+(_0x2aca45[_0x1e8e84(0x109d)]?_0x1e8e84(0x796):'未使用')+'\x0a';}if(_0x2aca45[_0x1e8e84(0xaeb)]==='守卫'){if(_0xd93c0f[_0x1e8e84(0x469)][_0x1e8e84(0x449)]){const _0x4474e9=_0xd93c0f[_0x1e8e84(0x258)][_0x1e8e84(0xb07)](_0x5ba4cd=>_0x5ba4cd['id']===_0xd93c0f[_0x1e8e84(0x469)]['guardedId']);_0x831b55+=_0x1e8e84(0x70c)+_0x4474e9[_0x1e8e84(0x132a)]+'。\x0a';}else _0x831b55+=_0x1e8e84(0x742);}_0x831b55===''&&(_0x831b55='\x20\x20\x20\x20-\x20我没有掌握任何特殊的夜晚信息。\x0a');_0x5ea1e2+=_0x831b55,_0x5ea1e2+=_0x1e8e84(0xf04)+_0x4c3eaf[_0x1e8e84(0x33b)](/\n/g,'\x20')+'\x0a\x20\x20\x20\x20-\x20**今日讨论**:\x20'+_0x32b302[_0x1e8e84(0x33b)](/\n/g,'\x20')+_0x1e8e84(0x818)+_0x2aca45['character_persona']+_0x1e8e84(0x119a);let _0xc265ab='';const _0x14e347=_0x42f206['chats'][_0x2aca45['id']];if(_0x14e347){const _0x23aa3a=_0x568c4a[_0x1e8e84(0xaf1)](_0x9dcc54=>_0x9dcc54['id']!==_0x2aca45['id']&&_0x42f206[_0x1e8e84(0x954)][_0x9dcc54['id']]&&_0x42f206[_0x1e8e84(0x954)][_0x9dcc54['id']][_0x1e8e84(0x1437)]===_0x14e347['groupId']&&_0x14e347['groupId']!==null)['map'](_0x2bebf4=>_0x2bebf4[_0x1e8e84(0x132a)])[_0x1e8e84(0x56c)]('、');_0x23aa3a&&(_0xc265ab+=_0x1e8e84(0xe75)+_0x23aa3a+_0x1e8e84(0x5e8));}_0x2aca45['id']!==_0x1e8e84(0xf86)&&(_0xc265ab+=_0x1e8e84(0xe75)+_0x11994a+_0x1e8e84(0xe49)),_0xc265ab===''&&(_0xc265ab=_0x1e8e84(0x492)),_0x5ea1e2+=_0xc265ab,_0x5ea1e2+=_0x1e8e84(0xd18)+_0x11994a+_0x1e8e84(0x1364)+(_0x532301[_0x1e8e84(0x131d)]>0x0?'其他人的发言':_0x1e8e84(0xd8a))+'，我的看法是...\x20我【必须】回应...\x0a3.\x20\x20**S\x20(Social\x20-\x20社交表演)**:\x20我要如何用我的【人设】和【社交关系】来包装我的发言？\x0a\x20\x20\x20\x20-\x20(例如：我的好友\x20'+_0x11994a+_0x1e8e84(0x106f)+_0x11994a+_0x1e8e84(0x4aa)+_0x2aca45['role']+_0x1e8e84(0x3ac)+_0x2aca45[_0x1e8e84(0xea7)][_0x1e8e84(0xa6d)](0x0,0x14)+_0x1e8e84(0x418);}}),_0x5ea1e2+=_0x3c7c59(0x99);const _0x263519=_0x3c7c59(0x13e0)+(_0x254d8a?'用户('+_0x11994a+')':'已死亡的用户('+_0x11994a+')')+_0x3c7c59(0x1388)+_0x502015+'\x0a\x0a#\x20游戏规则\x0a-\x20'+(_0xd93c0f['gameMode']===_0x3c7c59(0xe2c)?'屠边局：狼人杀死所有神职或所有平民即获胜。':_0x3c7c59(0x106))+'\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20'+_0xd93c0f['currentDay']+_0x3c7c59(0xbea)+_0x4c3eaf+_0x3c7c59(0xc1f)+_0x568c4a[_0x3c7c59(0xbf6)](_0x254a07=>_0x254a07['name']+'\x20('+(_0x254a07['id']===_0x3c7c59(0xf86)?'用户':'AI')+')')[_0x3c7c59(0x56c)](',\x20')+_0x3c7c59(0x1af)+_0x11994a+_0x3c7c59(0xc2)+_0xcb12ba+'\x0a\x0a#\x20'+_0x32b302+'\x0a\x0a'+_0x5ea1e2+_0x3c7c59(0xbf0);return _0x263519;}function _0x2bd6db(_0x5de608){const _0x26b404=_0x204348;let _0x14c6fa=_0x26b404(0x30a);const _0x5e7c6c=_0x5de608[_0x26b404(0xe59)]['find'](_0x309243=>_0x309243[_0x26b404(0x1316)][_0x26b404(0xd8d)]('胜利'))?.[_0x26b404(0x1316)]||_0x26b404(0x1276);_0x14c6fa+=_0x26b404(0x1161)+_0x5e7c6c+'\x0a\x0a',_0x14c6fa+=_0x26b404(0x1163),_0x5de608[_0x26b404(0x258)][_0x26b404(0x12c2)](_0x2db9d9=>{const _0x2895a5=_0x26b404,_0x4602f4=_0x2db9d9[_0x2895a5(0xbce)]?'存活':'已死亡';_0x14c6fa+='-\x20'+_0x2db9d9[_0x2895a5(0x132a)]+':\x20'+_0x2db9d9[_0x2895a5(0xaeb)]+'\x20('+_0x4602f4+')\x0a';}),_0x14c6fa+=_0x26b404(0x649);for(let _0x11a00f=0x1;_0x11a00f<=_0x5de608[_0x26b404(0x1206)];_0x11a00f++){_0x14c6fa+='\x0a**---\x20第\x20'+_0x11a00f+_0x26b404(0xeb2);const _0x52f57b=_0x5de608['gameLog'][_0x26b404(0xaf1)](_0x5b2deb=>_0x5b2deb['day']===_0x11a00f&&_0x5b2deb[_0x26b404(0x1316)][_0x26b404(0xd8d)]('死亡'));if(_0x52f57b[_0x26b404(0x131d)]>0x0)_0x14c6fa+=_0x26b404(0x5db)+_0x52f57b[_0x26b404(0xbf6)](_0x2950ab=>_0x2950ab[_0x26b404(0x1316)])['join']('\x20')+'\x0a';else(_0x11a00f>0x1||_0x11a00f===0x1&&_0x5de608['currentDay']>0x1)&&(_0x14c6fa+=_0x26b404(0x10cf));const _0x20cfdf=_0x5de608['discussionLog'][_0x26b404(0xaf1)](_0x15e225=>_0x15e225['day']===_0x11a00f);_0x20cfdf[_0x26b404(0x131d)]>0x0&&(_0x14c6fa+=_0x26b404(0xe9f)+_0x20cfdf['map'](_0xce0981=>'-\x20'+_0xce0981[_0x26b404(0x132e)]+':\x20'+_0xce0981[_0x26b404(0x1316)])[_0x26b404(0x56c)]('\x0a')+'\x0a');const _0x26c0b3=_0x5de608['gameLog']['find'](_0x59321e=>_0x59321e['day']===_0x11a00f&&_0x59321e['content'][_0x26b404(0xd8d)]('被投票放逐'));_0x26c0b3&&(_0x14c6fa+=_0x26b404(0xa92)+_0x26c0b3[_0x26b404(0x1316)]+'\x0a');}return _0x14c6fa+=_0x26b404(0x137f),_0x14c6fa;}async function _0x420d76(_0x47b04f){const _0x44bbd4=_0x204348;let _0x25df0f=0x0;for(const _0x25df29 of _0xd93c0f[_0x44bbd4(0x258)]){if(_0x25df29['type']===_0x44bbd4(0x4c5)){const _0x4aa5ba=_0x42f206[_0x44bbd4(0x954)][_0x25df29['id']];if(_0x4aa5ba){const _0x345503={'content':_0x47b04f,'timestamp':Date[_0x44bbd4(0x606)](),'source':'werewolf_summary'};!_0x4aa5ba[_0x44bbd4(0x94a)]&&(_0x4aa5ba[_0x44bbd4(0x94a)]=[]),_0x4aa5ba[_0x44bbd4(0x94a)]['push'](_0x345503),await _0x17d534[_0x44bbd4(0x954)][_0x44bbd4(0xf3f)](_0x4aa5ba),_0x25df0f++;}}}return _0x25df0f;}async function _0x57b416(){const _0x381121=_0x204348;if(!_0xd93c0f[_0x381121(0x1196)]&&_0xd93c0f[_0x381121(0x111c)]===_0x381121(0x100c)){await _0x34fce8(_0x381121(0x12b9),_0x381121(0x1075));try{const _0x140cf8=_0x2bd6db(_0xd93c0f),_0x750cb6=await _0x420d76(_0x140cf8);await _0x34fce8('成功',_0x381121(0x109)+_0x750cb6+_0x381121(0x140a));}catch(_0x415987){console[_0x381121(0xb61)]('手动注入狼人杀记忆失败:',_0x415987),await _0x34fce8('失败','手动注入记忆时出错:\x20'+_0x415987[_0x381121(0x7aa)]);}}else alert('游戏尚未结束，无法进行总结。');}async function _0x27d49d(_0x4ae32e){const _0x1b8f8c=_0x204348;_0xd93c0f[_0x1b8f8c(0x1196)]=![],_0xd93c0f[_0x1b8f8c(0x111c)]=_0x1b8f8c(0x100c),_0x4906f0(_0x4ae32e+'阵营胜利！'),document[_0x1b8f8c(0x458)]('werewolf-game-over-title')['textContent']=_0x4ae32e+'胜利！';let _0x56e8f0='';_0x4ae32e==='好人'?_0x56e8f0='所有狼人已被放逐，好人阵营获得了胜利！':_0x56e8f0='狼人数量已达到胜利条件，狼人阵营获得了胜利！';const _0x382111=document[_0x1b8f8c(0x458)]('werewolf-game-over-reason');_0x382111[_0x1b8f8c(0x1a2)]=_0x56e8f0;const _0x6a8b92=document['getElementById']('werewolf-role-reveal-list');_0x6a8b92['innerHTML']='';const _0x7deae4=[..._0xd93c0f['players']][_0x1b8f8c(0xc12)]((_0x456fa4,_0x2622ce)=>{const _0x194db2=_0x1b8f8c,_0x105908=_0xd93c0f[_0x194db2(0x258)][_0x194db2(0x4a8)](_0x1844df=>_0x1844df['id']===_0x456fa4['id']),_0x36ccf8=_0xd93c0f['players'][_0x194db2(0x4a8)](_0x598069=>_0x598069['id']===_0x2622ce['id']);return _0x105908-_0x36ccf8;});_0x7deae4[_0x1b8f8c(0x12c2)]((_0xb37663,_0x407a38)=>{const _0x14bf9b=_0x1b8f8c,_0x38582e=document[_0x14bf9b(0xe7d)](_0x14bf9b(0x1323));_0x38582e[_0x14bf9b(0x1104)][_0x14bf9b(0x11f)]=_0x14bf9b(0xdc5);if(_0x407a38===_0x7deae4[_0x14bf9b(0x131d)]-0x1)_0x38582e[_0x14bf9b(0x1104)][_0x14bf9b(0x265)]='none';const _0x19ade2=_0xb37663[_0x14bf9b(0xaeb)]==='狼人'?_0x14bf9b(0x881):_0x14bf9b(0x12dd);_0x38582e['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0xb37663[_0x14bf9b(0x5c6)]+_0x14bf9b(0x119d)+(_0xb37663[_0x14bf9b(0xbce)]?_0x14bf9b(0x464):_0x14bf9b(0x429))+_0x14bf9b(0xdb0)+(_0xb37663[_0x14bf9b(0xbce)]?'none':_0x14bf9b(0x133))+_0x14bf9b(0x22e)+(_0x407a38+0x1)+'.\x20'+_0xb37663[_0x14bf9b(0x132a)]+_0x14bf9b(0x20b)+_0x19ade2+_0x14bf9b(0x22e)+_0xb37663[_0x14bf9b(0xaeb)]+_0x14bf9b(0x1414),_0x6a8b92[_0x14bf9b(0x1079)](_0x38582e);}),document['getElementById'](_0x1b8f8c(0x9d0))[_0x1b8f8c(0x11c2)]['add'](_0x1b8f8c(0x67d));try{console['log'](_0x1b8f8c(0x122b));const _0x5af606=_0x2bd6db(_0xd93c0f),_0x42e44d=await generateAndInjectWerewolfMemories(_0x5af606);console['log'](_0x1b8f8c(0x80c)+_0x42e44d+'\x20位角色的记忆中。');}catch(_0x5b07be){console['error'](_0x1b8f8c(0xd30),_0x5b07be),_0x382111&&(_0x382111[_0x1b8f8c(0x110d)]+=_0x1b8f8c(0xcae));}}function _0x4906f0(_0x532ddd){const _0x3f192f=_0x204348;_0xd93c0f[_0x3f192f(0xe59)][_0x3f192f(0x129e)]({'type':'system','content':_0x532ddd,'timestamp':Date[_0x3f192f(0x606)](),'day':_0xd93c0f['currentDay']});}function _0x1c6644(_0x397b1b,_0xd8ac0f){const _0x369059=_0x204348;_0xd93c0f[_0x369059(0x79a)][_0x369059(0x129e)]({'type':'dialogue','speaker':_0x397b1b,'content':_0xd8ac0f,'timestamp':Date[_0x369059(0x606)](),'day':_0xd93c0f[_0x369059(0x1206)]});}function _0x5ae7ac(_0x40ea71){return new Promise(_0x5b2654=>{const _0x2e18ea=_0x1a5b,_0x90bddb=_0x2e18ea(0x124c)+_0x40ea71+_0x2e18ea(0x457),_0xa896de=_0x2e18ea(0x124c)+_0x40ea71+_0x2e18ea(0x12fa);let _0x530685='';if(_0x40ea71===_0x2e18ea(0x11db))_0x530685=_0x2e18ea(0xac1);if(_0x40ea71===_0x2e18ea(0x732))_0x530685=_0x2e18ea(0xd0a);if(_0x40ea71==='vote')_0x530685=_0x2e18ea(0xb56);const _0x5793c5=document['getElementById'](_0x90bddb),_0x53340a=document['getElementById'](_0xa896de),_0xef3f66=document['getElementById'](_0x530685);_0x53340a[_0x2e18ea(0x110d)]='';let _0x153ebf=null;const _0x397a57=_0xd93c0f['players'][_0x2e18ea(0xaf1)](_0x35c61c=>_0x35c61c[_0x2e18ea(0xbce)]&&(_0x40ea71===_0x2e18ea(0x732)||_0x40ea71==='vote'||_0x35c61c['id']!==_0x2e18ea(0xf86)));_0x397a57[_0x2e18ea(0x12c2)](_0x42062c=>{const _0x3067e7=_0x2e18ea,_0x153c9a=document[_0x3067e7(0xe7d)]('div');_0x153c9a[_0x3067e7(0x69b)]=_0x3067e7(0x37d),_0x153c9a[_0x3067e7(0x1f4)]['id']=_0x42062c['id'],_0x153c9a['innerHTML']=_0x3067e7(0xfa9)+_0x42062c['avatar']+_0x3067e7(0x940)+_0x42062c['name']+_0x3067e7(0xf82),_0x153c9a[_0x3067e7(0xbe8)]=()=>{const _0xcaa90c=_0x3067e7;_0x53340a[_0xcaa90c(0x102a)]('.selected')[_0xcaa90c(0x12c2)](_0x5d061a=>_0x5d061a[_0xcaa90c(0x11c2)][_0xcaa90c(0x1097)](_0xcaa90c(0x500))),_0x153c9a[_0xcaa90c(0x11c2)]['add'](_0xcaa90c(0x500)),_0x153ebf=_0x42062c['id'];},_0x53340a[_0x3067e7(0x1079)](_0x153c9a);});const _0x4f781b=_0xef3f66['cloneNode'](!![]);_0xef3f66[_0x2e18ea(0x135e)][_0x2e18ea(0x3f2)](_0x4f781b,_0xef3f66),_0x4f781b[_0x2e18ea(0xbe8)]=()=>{const _0xc94ff=_0x2e18ea;_0x153ebf?(_0x5793c5[_0xc94ff(0x11c2)]['remove']('visible'),_0x5b2654(_0x153ebf)):alert(_0xc94ff(0x120f));},_0x5793c5[_0x2e18ea(0x11c2)]['add'](_0x2e18ea(0x67d));});}function _0x57738c(){return new Promise(_0x4c664b=>{const _0xaf603b=_0x1a5b,_0x3748e9=document['getElementById'](_0xaf603b(0x9ae)),_0x20eb16=document[_0xaf603b(0x458)](_0xaf603b(0xd20)),_0x157814=document['getElementById'](_0xaf603b(0xcde)),_0x531f79=_0x3748e9[_0xaf603b(0x586)](_0xaf603b(0x146b)),_0x48722f=_0xd93c0f[_0xaf603b(0x258)]['filter'](_0x4bce85=>_0x4bce85[_0xaf603b(0xaeb)]==='狼人'&&_0x4bce85[_0xaf603b(0xbce)]),_0x315f1b=_0x48722f[_0xaf603b(0xaf1)](_0x26b873=>_0x26b873['id']!==_0xaf603b(0xf86))['map'](_0x3203ea=>_0x3203ea[_0xaf603b(0x132a)])[_0xaf603b(0x56c)]('、');_0x315f1b?_0x531f79['innerHTML']=_0xaf603b(0xeeb)+_0x315f1b+_0xaf603b(0xc32):_0x531f79[_0xaf603b(0x1a2)]=_0xaf603b(0x1036);_0x20eb16[_0xaf603b(0x110d)]='';let _0x17d9cb=null;const _0x57670a=_0xd93c0f['players']['filter'](_0x2a2eb3=>_0x2a2eb3['isAlive']&&_0x2a2eb3[_0xaf603b(0xaeb)]!=='狼人');_0x57670a['forEach'](_0x3273d7=>{const _0x5c74f4=_0xaf603b,_0x2e4194=document[_0x5c74f4(0xe7d)](_0x5c74f4(0x1323));_0x2e4194[_0x5c74f4(0x69b)]=_0x5c74f4(0x37d),_0x2e4194[_0x5c74f4(0x1f4)]['id']=_0x3273d7['id'],_0x2e4194[_0x5c74f4(0x110d)]='<img\x20src=\x22'+_0x3273d7[_0x5c74f4(0x5c6)]+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0x3273d7[_0x5c74f4(0x132a)]+_0x5c74f4(0xf82),_0x2e4194[_0x5c74f4(0xbe8)]=()=>{const _0x4fc4de=_0x5c74f4;_0x20eb16[_0x4fc4de(0x102a)](_0x4fc4de(0x155))['forEach'](_0x388aca=>_0x388aca[_0x4fc4de(0x11c2)][_0x4fc4de(0x1097)](_0x4fc4de(0x500))),_0x2e4194[_0x4fc4de(0x11c2)][_0x4fc4de(0xa58)](_0x4fc4de(0x500)),_0x17d9cb=_0x3273d7['id'];},_0x20eb16[_0x5c74f4(0x1079)](_0x2e4194);});const _0x3dca0f=_0x157814[_0xaf603b(0x350)](!![]);_0x157814[_0xaf603b(0x135e)][_0xaf603b(0x3f2)](_0x3dca0f,_0x157814),_0x3dca0f[_0xaf603b(0xbe8)]=()=>{const _0x25f704=_0xaf603b;_0x17d9cb?(_0x3748e9['classList'][_0x25f704(0x1097)](_0x25f704(0x67d)),_0x4c664b(_0x17d9cb)):alert(_0x25f704(0x120f));},_0x3748e9['classList'][_0xaf603b(0xa58)](_0xaf603b(0x67d));});}function _0x39b91e(){const _0x14f2d0=_0x204348,_0x56f72a=_0xd93c0f['players']['find'](_0x503550=>_0x503550['id']===_0x14f2d0(0xf86));if(!_0x56f72a||!_0x56f72a[_0x14f2d0(0xbce)])return;const _0x220017=document['getElementById'](_0x14f2d0(0x129f)),_0x2b038e=_0x220017['value'][_0x14f2d0(0x2aa)]();_0x2b038e&&(_0x1c6644(_0x56f72a[_0x14f2d0(0x132a)],_0x2b038e),_0x45e6fd()),document['getElementById'](_0x14f2d0(0xcfc))[_0x14f2d0(0x1104)][_0x14f2d0(0x4db)]=_0x14f2d0(0x464),_0x220017[_0x14f2d0(0x8dd)]='',_0x105ffb();}async function _0x4cfd49(){const _0x4422d7=_0x204348;_0x4906f0('你让大家继续讨论...'),_0x45e6fd();const _0x17ff88=document[_0x4422d7(0x458)]('werewolf-wait-reply-btn');if(_0x17ff88)_0x17ff88['disabled']=!![];await _0x34fce8(_0x4422d7(0xe4c),_0x4422d7(0xe9b));const {proxyUrl:_0x5a3da1,apiKey:_0x10c673,model:_0x530e65}=_0x42f206['apiConfig'];if(!_0x5a3da1||!_0x10c673||!_0x530e65){alert('API未配置，无法生成对话。');return;}const _0x3095e5=_0x1426e2();try{let _0x5190e9=_0x5a3da1['includes'](_0x4422d7(0xfe3)),_0x5b95a9=[{'role':_0x4422d7(0xf86),'content':_0x4422d7(0xb39)}],_0x49595c=_0x5d73db(_0x530e65,_0x10c673,_0x3095e5,_0x5b95a9);const _0x4ddd4a=_0x5190e9?await fetch(_0x49595c['url'],_0x49595c[_0x4422d7(0x76b)]):await fetch(_0x5a3da1+_0x4422d7(0xd7),{'method':_0x4422d7(0x1312),'headers':{'Content-Type':_0x4422d7(0xa0e),'Authorization':_0x4422d7(0x8aa)+_0x10c673},'body':JSON[_0x4422d7(0xc04)]({'model':_0x530e65,'messages':[{'role':_0x4422d7(0x1370),'content':_0x3095e5},..._0x5b95a9],'temperature':_0x42f206[_0x4422d7(0xf0)][_0x4422d7(0xfdf)]||0.9})});if(!_0x4ddd4a['ok']){const _0x1febf9=await _0x4ddd4a[_0x4422d7(0xaef)]();throw new Error(_0x4422d7(0x676)+_0x1febf9['error'][_0x4422d7(0x7aa)]);}const _0x1fbf36=await _0x4ddd4a['json'](),_0x20764a=getGeminiResponseText(_0x1fbf36),_0xceb26d=_0x20764a[_0x4422d7(0x41c)](/(\[[\s\S]*\])/);if(!_0xceb26d)throw new Error(_0x4422d7(0x42f)+_0x20764a);const _0x4faa1f=JSON[_0x4422d7(0x44c)](_0xceb26d[0x0]);for(const _0x486d52 of _0x4faa1f){_0x486d52[_0x4422d7(0xc47)]&&_0x486d52[_0x4422d7(0x4d9)]&&(_0x1c6644(_0x486d52['speaker_name'],_0x486d52[_0x4422d7(0x4d9)]),_0x45e6fd(),await new Promise(_0x4a03a8=>setTimeout(_0x4a03a8,0x5dc+Math['random']()*0x7d0)));}}catch(_0x1dd10b){console[_0x4422d7(0xb61)](_0x4422d7(0x276),_0x1dd10b),await _0x34fce8(_0x4422d7(0x137b),'错误:\x20'+_0x1dd10b['message']);}finally{if(_0x17ff88)_0x17ff88[_0x4422d7(0xb18)]=![];}}async function _0x1823ea(){const _0x1b7873=_0x204348,_0x4a2d0b=_0xd93c0f['players'][_0x1b7873(0xb07)](_0x4d3f1f=>_0x4d3f1f['id']===_0x1b7873(0xf86));if(!_0x4a2d0b||!_0x4a2d0b[_0x1b7873(0xbce)]){console[_0x1b7873(0x1b6)](_0x1b7873(0x130f));return;}const _0xc69066=document[_0x1b7873(0x458)](_0x1b7873(0x129f)),_0x4d984b=_0xc69066['value']['trim']();if(!_0x4d984b){alert(_0x1b7873(0xa91));return;}_0x1c6644(_0x4a2d0b[_0x1b7873(0x132a)],_0x4d984b),_0x45e6fd(),_0xc69066[_0x1b7873(0x8dd)]='',await _0x34fce8('请稍候','正在等待AI角色们对你的发言做出回应...');const {proxyUrl:_0x7f71fd,apiKey:_0x431f66,model:_0x535331}=_0x42f206[_0x1b7873(0x5cb)];if(!_0x7f71fd||!_0x431f66||!_0x535331){alert(_0x1b7873(0xd5d));return;}const _0x328e6d=_0x1426e2();try{let _0x444aa6=_0x7f71fd[_0x1b7873(0xd8d)](_0x1b7873(0xfe3)),_0x20ae7c=[{'role':'user','content':_0x1b7873(0x11f5)+_0x4a2d0b[_0x1b7873(0x132a)]+_0x1b7873(0x126b)}],_0x283366=_0x5d73db(_0x535331,_0x431f66,_0x328e6d,_0x20ae7c);const _0x4c6929=_0x444aa6?await fetch(_0x283366[_0x1b7873(0x1377)],_0x283366[_0x1b7873(0x76b)]):await fetch(_0x7f71fd+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x1b7873(0xa0e),'Authorization':_0x1b7873(0x8aa)+_0x431f66},'body':JSON[_0x1b7873(0xc04)]({'model':_0x535331,'messages':[{'role':_0x1b7873(0x1370),'content':_0x328e6d},..._0x20ae7c],'temperature':_0x42f206['globalSettings'][_0x1b7873(0xfdf)]||0.9})});if(!_0x4c6929['ok']){const _0x47354f=await _0x4c6929['json']();throw new Error('API\x20错误:\x20'+_0x47354f['error'][_0x1b7873(0x7aa)]);}const _0xce63df=await _0x4c6929[_0x1b7873(0xaef)](),_0x1d95fd=getGeminiResponseText(_0xce63df);let _0x4b635b;try{let _0x43ef35=_0x1d95fd[_0x1b7873(0x33b)](/^```json\s*/,'')['replace'](/```$/,'')[_0x1b7873(0x2aa)]();const _0x404d9d=_0x43ef35[_0x1b7873(0x893)]('['),_0x2c8688=_0x43ef35['lastIndexOf'](']');if(_0x404d9d===-0x1||_0x2c8688===-0x1||_0x2c8688<_0x404d9d)throw new Error(_0x1b7873(0x126d));const _0x55e5ac=_0x43ef35[_0x1b7873(0xa6d)](_0x404d9d,_0x2c8688+0x1);_0x4b635b=JSON[_0x1b7873(0x44c)](_0x55e5ac);}catch(_0x126fe7){if(_0x126fe7[_0x1b7873(0x7aa)]['includes'](_0x1b7873(0x128a))){console[_0x1b7873(0x1b6)](_0x1b7873(0x761));const _0x568569=_0x506e60=>{const _0x4248cb=_0x1b7873;let _0x3c2eca=![],_0x7c7d4e=![],_0x408bd5='';for(let _0x5a993e=0x0;_0x5a993e<_0x506e60['length'];_0x5a993e++){const _0x33a84b=_0x506e60[_0x5a993e];if(_0x7c7d4e){_0x408bd5+=_0x33a84b,_0x7c7d4e=![];continue;}if(_0x33a84b==='\x5c'){_0x408bd5+=_0x33a84b,_0x7c7d4e=!![];continue;}if(_0x33a84b==='\x22'){_0x408bd5+=_0x33a84b,_0x3c2eca=!_0x3c2eca;continue;}if(_0x3c2eca){if(_0x33a84b==='\x0a')_0x408bd5+='\x5cn';else{if(_0x33a84b==='\x0d')_0x408bd5+='\x5cr';else{if(_0x33a84b==='\x09')_0x408bd5+='\x5ct';else{if(_0x33a84b[_0x4248cb(0x12f3)](0x0)<0x20)continue;else _0x408bd5+=_0x33a84b;}}}}else _0x408bd5+=_0x33a84b;}return _0x408bd5;};let _0x3fadab=_0x1d95fd[_0x1b7873(0x33b)](/^```json\s*/,'')['replace'](/```$/,'')[_0x1b7873(0x2aa)]();const _0x16be88=_0x568569(_0x3fadab),_0xa67b2f=_0x16be88[_0x1b7873(0x41c)](/(\[[\s\S]*\])/);if(!_0xa67b2f)throw new Error(_0x1b7873(0xb3a));_0x4b635b=JSON['parse'](_0xa67b2f[0x0]);}else throw new Error(_0x1b7873(0xde0)+_0x126fe7[_0x1b7873(0x7aa)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x1d95fd);}for(const _0xe51150 of _0x4b635b){_0xe51150[_0x1b7873(0xc47)]&&_0xe51150[_0x1b7873(0x4d9)]&&(_0x1c6644(_0xe51150['speaker_name'],_0xe51150[_0x1b7873(0x4d9)]),_0x45e6fd(),await new Promise(_0x391631=>setTimeout(_0x391631,0x5dc+Math[_0x1b7873(0x23a)]()*0x7d0)));}}catch(_0x567dbf){console['error'](_0x1b7873(0x276),_0x567dbf),await _0x34fce8(_0x1b7873(0x137b),_0x1b7873(0x19e)+_0x567dbf[_0x1b7873(0x7aa)]);}}async function _0x105ffb(){const _0x507c6d=_0x204348;_0x4906f0(_0x507c6d(0x2f1)),_0x45e6fd(),_0xd93c0f[_0x507c6d(0x92)]={};let _0x5b816f=null;_0xd93c0f['lastFailedAction']='getVotes';try{_0x5b816f=await _0x2f5e71(),_0x5b816f&&_0x5b816f[_0x507c6d(0x12c2)](_0x1d1aba=>{const _0x4750b0=_0x507c6d,_0x145e45=_0xd93c0f[_0x4750b0(0x258)][_0x4750b0(0xb07)](_0x401967=>_0x401967[_0x4750b0(0x132a)]===_0x1d1aba[_0x4750b0(0x134f)]),_0x312eed=_0xd93c0f[_0x4750b0(0x258)]['find'](_0x5515ae=>_0x5515ae[_0x4750b0(0x132a)]===_0x1d1aba['vote_for_name']);_0x145e45&&_0x145e45['isAlive']&&_0x312eed&&(_0xd93c0f['votes'][_0x145e45[_0x4750b0(0x132a)]]=_0x312eed[_0x4750b0(0x132a)]);}),_0xd93c0f[_0x507c6d(0xb28)]=null;}catch(_0x2ce130){console['error']('AI投票决策API失败:',_0x2ce130),await _0x34fce8('操作失败',_0x507c6d(0x13c4)+_0x2ce130[_0x507c6d(0x7aa)]),document[_0x507c6d(0x458)](_0x507c6d(0x6f0))[_0x507c6d(0x1104)][_0x507c6d(0x4db)]=_0x507c6d(0x1188);return;}const _0x14bd63=_0xd93c0f[_0x507c6d(0x258)]['find'](_0x23152e=>_0x23152e['id']===_0x507c6d(0xf86));if(_0x14bd63&&_0x14bd63['isAlive']){_0x4906f0(_0x507c6d(0x1dd)),_0x45e6fd();const _0x3fa6aa=await _0x5ae7ac(_0x507c6d(0x5aa)),_0x15f1a5=_0xd93c0f[_0x507c6d(0x258)]['find'](_0x43076d=>_0x43076d['id']===_0x3fa6aa);_0x15f1a5&&(_0xd93c0f[_0x507c6d(0x92)][_0x14bd63['name']]=_0x15f1a5['name']);}_0x273b94();}async function _0x2f5e71(){const _0x24929e=_0x204348,{proxyUrl:_0x386fd8,apiKey:_0x9ddeb8,model:_0x364ee1}=_0x42f206['apiConfig'];if(!_0x386fd8||!_0x9ddeb8||!_0x364ee1)return null;const _0xf6a2d8=_0xd93c0f[_0x24929e(0x258)][_0x24929e(0xaf1)](_0x4a1f7c=>_0x4a1f7c['isAlive']&&_0x4a1f7c['id']!==_0x24929e(0xf86)),_0x3f18a7=_0xd93c0f['players'][_0x24929e(0xaf1)](_0x23b66b=>_0x23b66b[_0x24929e(0xbce)])[_0x24929e(0xbf6)](_0x3c0a62=>_0x3c0a62[_0x24929e(0x132a)]);let _0x31548f=_0x1426e2();_0x31548f+=_0x24929e(0x1a6)+_0x3f18a7['join'](',\x20')+'\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。';try{let _0x37e34a=_0x386fd8[_0x24929e(0xd8d)](_0x24929e(0xfe3)),_0x14275d=[{'role':_0x24929e(0xf86),'content':_0x24929e(0x103b)}],_0x300788=_0x5d73db(_0x364ee1,_0x9ddeb8,_0x31548f,_0x14275d);const _0x1c546b=_0x37e34a?await fetch(_0x300788[_0x24929e(0x1377)],_0x300788[_0x24929e(0x76b)]):await fetch(_0x386fd8+_0x24929e(0xd7),{'method':'POST','headers':{'Content-Type':_0x24929e(0xa0e),'Authorization':_0x24929e(0x8aa)+_0x9ddeb8},'body':JSON['stringify']({'model':_0x364ee1,'messages':[{'role':_0x24929e(0x1370),'content':_0x31548f},..._0x14275d],'temperature':_0x42f206[_0x24929e(0xf0)]['apiTemperature']||0.8})});if(!_0x1c546b['ok'])throw new Error((await _0x1c546b[_0x24929e(0xaef)]())[_0x24929e(0xb61)][_0x24929e(0x7aa)]);const _0x8a02cb=await _0x1c546b[_0x24929e(0xaef)](),_0x4fd2b1=getGeminiResponseText(_0x8a02cb);let _0x48ba43=_0x4fd2b1[_0x24929e(0x33b)](/^```json\s*/,'')['replace'](/```$/,'')[_0x24929e(0x2aa)]();const _0x2a77b5=_0x48ba43['indexOf']('['),_0x2fd822=_0x48ba43[_0x24929e(0x7d5)](']');if(_0x2a77b5===-0x1||_0x2fd822===-0x1||_0x2fd822<_0x2a77b5)throw new Error(_0x24929e(0x59d));const _0xafee9c=_0x48ba43[_0x24929e(0xa6d)](_0x2a77b5,_0x2fd822+0x1);try{const _0x136cf8=_0xafee9c[_0x24929e(0x41c)](/(\[[\s\S]*?\])/g);if(_0x136cf8&&_0x136cf8[_0x24929e(0x131d)]>0x0)return JSON['parse'](_0x136cf8[_0x136cf8[_0x24929e(0x131d)]-0x1]);return JSON[_0x24929e(0x44c)](_0xafee9c);}catch(_0x581c2b){throw new Error(_0x24929e(0xc5b)+_0x581c2b[_0x24929e(0x7aa)]+_0x24929e(0x12c4)+_0x4fd2b1);}}catch(_0x9db605){console[_0x24929e(0xb61)]('获取AI投票失败:',_0x9db605);throw new Error(_0x24929e(0x1456)+_0x9db605[_0x24929e(0x7aa)]);}}function _0x273b94(){const _0x2b2a8b=_0x204348,_0x15ac94={},_0x3e7dfb={};for(const _0x2d1698 in _0xd93c0f[_0x2b2a8b(0x92)]){const _0x324c88=_0xd93c0f[_0x2b2a8b(0x92)][_0x2d1698];_0x15ac94[_0x324c88]=(_0x15ac94[_0x324c88]||0x0)+0x1,!_0x3e7dfb[_0x324c88]&&(_0x3e7dfb[_0x324c88]=[]),_0x3e7dfb[_0x324c88]['push'](_0x2d1698);}let _0x5e33b4=0x0,_0x537405=[];for(const _0x1065e7 in _0x15ac94){const _0xdd81ce=_0x15ac94[_0x1065e7];if(_0xdd81ce>_0x5e33b4)_0x5e33b4=_0xdd81ce,_0x537405=[_0x1065e7];else _0xdd81ce===_0x5e33b4&&_0x537405[_0x2b2a8b(0x129e)](_0x1065e7);}_0x4906f0(_0x2b2a8b(0x5a2));for(const _0x2ae5dc in _0x3e7dfb){_0x4906f0(_0x2ae5dc+'\x20('+_0x3e7dfb[_0x2ae5dc]['length']+_0x2b2a8b(0x927)+_0x3e7dfb[_0x2ae5dc]['join']('、\x20'));}if(_0x537405[_0x2b2a8b(0x131d)]===0x1&&_0x5e33b4>0x0){const _0x45627c=_0xd93c0f[_0x2b2a8b(0x258)][_0x2b2a8b(0xb07)](_0x179f0e=>_0x179f0e[_0x2b2a8b(0x132a)]===_0x537405[0x0]);if(_0x45627c){_0x45627c[_0x2b2a8b(0xbce)]=![],_0x4906f0(_0x45627c[_0x2b2a8b(0x132a)]+_0x2b2a8b(0x12f9));if(_0x45627c[_0x2b2a8b(0xaeb)]==='猎人'){}}}else _0x4906f0(_0x2b2a8b(0x16c));_0x45e6fd();if(_0x282413())return;_0xd93c0f[_0x2b2a8b(0x1206)]++,_0x504297();}async function _0x19db48(){const _0xd7304e=_0x204348,{proxyUrl:_0x5757b1,apiKey:_0x4fbcf6,model:_0x51bf26}=_0x42f206[_0xd7304e(0x5cb)];if(!_0x5757b1||!_0x4fbcf6||!_0x51bf26)return null;const _0x3a2837=_0xd93c0f[_0xd7304e(0x258)]['filter'](_0x152869=>_0x152869[_0xd7304e(0xaeb)]==='狼人'&&_0x152869[_0xd7304e(0xbce)]),_0x2cf483=_0xd93c0f[_0xd7304e(0x258)][_0xd7304e(0xaf1)](_0x1e1083=>_0x1e1083[_0xd7304e(0xbce)]&&_0x1e1083['role']!=='狼人'),_0x4b2a8d=_0xd7304e(0x9e4)+_0x3a2837[_0xd7304e(0xbf6)](_0x44840b=>_0x44840b['name'])[_0xd7304e(0x56c)]('、\x20')+_0xd7304e(0xd91)+_0x2cf483[_0xd7304e(0xbf6)](_0x29aac3=>_0x29aac3[_0xd7304e(0x132a)])[_0xd7304e(0x56c)]('、\x20')+'\x0a-\x20**讨论摘要**:\x20\x0a'+_0xd93c0f[_0xd7304e(0x79a)][_0xd7304e(0xbf6)](_0x377f5a=>_0x377f5a[_0xd7304e(0x132e)]+':\x20'+_0x377f5a['content'])[_0xd7304e(0x56c)]('\x0a')+_0xd7304e(0xd4b);try{let _0x6c0974=_0x5757b1[_0xd7304e(0xd8d)](_0xd7304e(0xfe3)),_0x5175a1=[{'role':_0xd7304e(0xf86),'content':_0xd7304e(0x74a)}],_0x20135c=_0x5d73db(_0x51bf26,_0x4fbcf6,_0x4b2a8d,_0x5175a1);const _0x5dc3c3=_0x6c0974?await fetch(_0x20135c[_0xd7304e(0x1377)],_0x20135c['data']):await fetch(_0x5757b1+'/v1/chat/completions',{'method':_0xd7304e(0x1312),'headers':{'Content-Type':_0xd7304e(0xa0e),'Authorization':_0xd7304e(0x8aa)+_0x4fbcf6},'body':JSON['stringify']({'model':_0x51bf26,'messages':[{'role':_0xd7304e(0x1370),'content':_0x4b2a8d},..._0x5175a1],'temperature':_0x42f206['globalSettings'][_0xd7304e(0xfdf)]||0.8})});if(!_0x5dc3c3['ok'])throw new Error((await _0x5dc3c3['json']())[_0xd7304e(0xb61)]['message']);const _0x35a20f=await _0x5dc3c3['json'](),_0x418d5f=getGeminiResponseText(_0x35a20f),_0x489435=_0x418d5f[_0xd7304e(0x41c)](/({[\s\S]*})/);if(!_0x489435)throw new Error(_0xd7304e(0xe38));const _0x5cd42d=JSON[_0xd7304e(0x44c)](_0x489435[0x0]),_0x4b416f=_0xd93c0f[_0xd7304e(0x258)][_0xd7304e(0xb07)](_0x45d9e7=>_0x45d9e7[_0xd7304e(0x132a)]===_0x5cd42d['target_name']);return _0x4b416f?_0x4b416f['id']:null;}catch(_0x562695){return console[_0xd7304e(0xb61)](_0xd7304e(0x10ed),_0x562695),_0x2cf483[Math[_0xd7304e(0xbd5)](Math[_0xd7304e(0x23a)]()*_0x2cf483[_0xd7304e(0x131d)])]['id'];}}function _0x55a293(_0x977919,_0x4ca22f){return new Promise(_0x26a0a9=>{const _0xe54572=_0x1a5b,_0x127e0e=document['getElementById'](_0xe54572(0x101b)),_0x2fdde2=document['getElementById']('werewolf-witch-selection-list'),_0x59c0a5=document[_0xe54572(0x458)](_0xe54572(0x11e)),_0x4fa705=document[_0xe54572(0x458)](_0xe54572(0x924)),_0x35c3b4=document[_0xe54572(0x458)](_0xe54572(0x515));_0x2fdde2[_0xe54572(0x110d)]='';const _0x213f65=_0x4fa705['cloneNode'](!![]);_0x4fa705[_0xe54572(0x135e)][_0xe54572(0x3f2)](_0x213f65,_0x4fa705);const _0xd6fba0=_0x35c3b4['cloneNode'](!![]);_0x35c3b4['parentNode'][_0xe54572(0x3f2)](_0xd6fba0,_0x35c3b4),_0x213f65[_0xe54572(0x1104)][_0xe54572(0x4db)]=_0xe54572(0x1188),_0x213f65[_0xe54572(0xb18)]=!![];let _0x2c0de5={'save':![],'poison':null},_0x8b87a2=null;if(_0x977919&&!_0x4ca22f[_0xe54572(0x7ff)]){_0x59c0a5['textContent']=_0xe54572(0xabc)+_0x977919[_0xe54572(0x132a)]+_0xe54572(0x62b);const _0x4b6347=document[_0xe54572(0xe7d)]('button');_0x4b6347[_0xe54572(0x69b)]=_0xe54572(0x29b),_0x4b6347[_0xe54572(0x1a2)]=_0xe54572(0x1227),_0x4b6347[_0xe54572(0x1104)][_0xe54572(0xfda)]='20px',_0x4b6347[_0xe54572(0xbe8)]=()=>{const _0x87c68e=_0xe54572;_0x2c0de5[_0x87c68e(0x133e)]=!![],_0x127e0e[_0x87c68e(0x11c2)][_0x87c68e(0x1097)](_0x87c68e(0x67d)),_0x26a0a9(_0x2c0de5);},_0x2fdde2[_0xe54572(0x1079)](_0x4b6347);}else _0x977919?_0x59c0a5['textContent']='昨晚\x20'+_0x977919['name']+_0xe54572(0xa0a):_0x59c0a5[_0xe54572(0x1a2)]='昨晚是平安夜';if(!_0x4ca22f['poisonUsed']){const _0x31480a=document[_0xe54572(0xe7d)]('p');_0x31480a[_0xe54572(0x1a2)]=_0xe54572(0x899),_0x31480a['style'][_0xe54572(0x758)]=_0xe54572(0x1f3),_0x31480a[_0xe54572(0x1104)][_0xe54572(0xc1)]=_0xe54572(0xc2c),_0x2fdde2[_0xe54572(0x1079)](_0x31480a);const _0x4e333c=_0xd93c0f[_0xe54572(0x258)][_0xe54572(0xaf1)](_0x296255=>_0x296255[_0xe54572(0xbce)]&&_0x296255['id']!==_0x977919?.['id']);_0x4e333c['forEach'](_0x1cdc31=>{const _0xa9fd09=_0xe54572,_0x5a5614=document[_0xa9fd09(0xe7d)](_0xa9fd09(0x1323));_0x5a5614[_0xa9fd09(0x69b)]=_0xa9fd09(0x37d),_0x5a5614['dataset']['id']=_0x1cdc31['id'],_0x5a5614[_0xa9fd09(0x110d)]=_0xa9fd09(0xfa9)+_0x1cdc31['avatar']+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0x1cdc31[_0xa9fd09(0x132a)]+'</span>',_0x5a5614[_0xa9fd09(0xbe8)]=()=>{const _0x378d55=_0xa9fd09;_0x2fdde2[_0x378d55(0x102a)](_0x378d55(0x155))['forEach'](_0x2f92a0=>_0x2f92a0[_0x378d55(0x11c2)][_0x378d55(0x1097)]('selected')),_0x5a5614[_0x378d55(0x11c2)]['add'](_0x378d55(0x500)),_0x8b87a2=_0x1cdc31['id'],_0x213f65[_0x378d55(0xb18)]=![];},_0x2fdde2[_0xa9fd09(0x1079)](_0x5a5614);});}_0x213f65['onclick']=()=>{const _0x109bcd=_0xe54572;_0x8b87a2&&(_0x2c0de5[_0x109bcd(0x2bc)]=_0x8b87a2,_0x127e0e[_0x109bcd(0x11c2)]['remove'](_0x109bcd(0x67d)),_0x26a0a9(_0x2c0de5));},_0xd6fba0[_0xe54572(0xbe8)]=()=>{const _0x5ef59c=_0xe54572;_0x127e0e[_0x5ef59c(0x11c2)][_0x5ef59c(0x1097)]('visible'),_0x26a0a9(_0x2c0de5);},_0x127e0e['classList'][_0xe54572(0xa58)](_0xe54572(0x67d));});}async function _0x1e7cbe(){const _0xd5483a=_0x204348,_0x178d73=_0xd93c0f[_0xd5483a(0xb28)];if(!_0x178d73)return;document[_0xd5483a(0x458)]('werewolf-retry-btn')[_0xd5483a(0x1104)]['display']='none',await _0x34fce8('请稍候...','正在重试\x22'+_0x178d73+'\x22操作...');switch(_0x178d73){case'wolfKill':await _0x504297();break;case _0xd5483a(0xe7c):await _0x557e0c();break;case _0xd5483a(0xa2e):await _0x105ffb();break;}}function _0x282413(){const _0x376b9b=_0x204348,_0x53296e=_0xd93c0f[_0x376b9b(0x258)]['filter'](_0x34e9ac=>_0x34e9ac[_0x376b9b(0xbce)]),_0x68026e=_0x53296e[_0x376b9b(0xaf1)](_0x93fc65=>_0x93fc65[_0x376b9b(0xaeb)]==='狼人'),_0xc3bd0f=_0x53296e[_0x376b9b(0xaf1)](_0xe4776=>['预言家','女巫','猎人','守卫'][_0x376b9b(0xd8d)](_0xe4776[_0x376b9b(0xaeb)])),_0x52f171=_0x53296e[_0x376b9b(0xaf1)](_0x433108=>_0x433108[_0x376b9b(0xaeb)]==='平民');let _0x4b1d4a=null;if(_0x68026e['length']===0x0)_0x4b1d4a='好人';else{if(_0x68026e[_0x376b9b(0x131d)]>=_0xc3bd0f[_0x376b9b(0x131d)]+_0x52f171[_0x376b9b(0x131d)])_0x4b1d4a='狼人';else _0xd93c0f[_0x376b9b(0xc6c)]===_0x376b9b(0xe2c)?(_0xc3bd0f['length']===0x0||_0x52f171[_0x376b9b(0x131d)]===0x0)&&(_0x4b1d4a='狼人'):_0xc3bd0f['length']===0x0&&_0x52f171[_0x376b9b(0x131d)]===0x0&&(_0x4b1d4a='狼人');}if(_0x4b1d4a)return _0x27d49d(_0x4b1d4a),!![];return![];}async function _0x155b14(){const _0xc49b92=_0x204348,_0x149633=await _0x2532b9('确认操作',_0xc49b92(0xcac),{'confirmText':_0xc49b92(0x141c)});if(!_0x149633)return;await _0x34fce8('请稍候...',_0xc49b92(0x1106));try{const _0x132cfa=await _0x17d534[_0xc49b92(0x954)][_0xc49b92(0x511)]();let _0x1a632e=0x0;for(const _0x1c0e77 of _0x132cfa){let _0x3af67f=![];!Array[_0xc49b92(0x971)](_0x1c0e77[_0xc49b92(0x1d5)])&&(_0x1c0e77['history']=[],_0x3af67f=!![]),(typeof _0x1c0e77[_0xc49b92(0xda2)]!=='object'||_0x1c0e77['settings']===null)&&(_0x1c0e77[_0xc49b92(0xda2)]={},_0x3af67f=!![]),!_0x1c0e77[_0xc49b92(0x726)]&&!_0x1c0e77[_0xc49b92(0xa1)]&&(_0x1c0e77[_0xc49b92(0xa1)]=_0x1c0e77['name'],_0x3af67f=!![]),typeof _0x1c0e77[_0xc49b92(0x12c9)]===_0xc49b92(0x37c)&&(_0x1c0e77['unreadCount']=0x0,_0x3af67f=!![]),!Array['isArray'](_0x1c0e77[_0xc49b92(0x94a)])&&(_0x1c0e77[_0xc49b92(0x94a)]=[],_0x3af67f=!![]),_0x3af67f&&(_0x1a632e++,console[_0xc49b92(0x7d1)]('修复了角色\x20\x22'+_0x1c0e77[_0xc49b92(0x132a)]+_0xc49b92(0x128)+_0x1c0e77['id']+_0xc49b92(0xc0b)),await _0x17d534[_0xc49b92(0x954)][_0xc49b92(0xf3f)](_0x1c0e77)),_0x42f206['chats'][_0x1c0e77['id']]=_0x1c0e77;}_0x1a632e>0x0?(await _0x34fce8(_0xc49b92(0xb09),_0xc49b92(0xee)+_0x1a632e+_0xc49b92(0x2f6)),await _0x27be5e()):await _0x34fce8(_0xc49b92(0xa13),_0xc49b92(0x140));}catch(_0x332841){console['error'](_0xc49b92(0xd8b),_0x332841),await _0x34fce8(_0xc49b92(0x96d),_0xc49b92(0xaca)+_0x332841[_0xc49b92(0x7aa)]);}}function _0x4c8ce6(_0x384d7f,_0x40f61c='top'){const _0x400444=_0x204348;if(_0x384d7f[_0x400444(0x586)](_0x400444(0x109e)))return;const _0x405066=document[_0x400444(0xe7d)](_0x400444(0x1323));_0x405066[_0x400444(0x69b)]=_0x400444(0x5f2),_0x405066[_0x400444(0x110d)]=_0x400444(0xa16),_0x40f61c===_0x400444(0x151)?_0x384d7f[_0x400444(0x1079)](_0x405066):_0x384d7f['prepend'](_0x405066);}function _0x17adee(_0x1820cd){const _0x422a96=_0x204348,_0x109640=_0x1820cd['querySelector'](_0x422a96(0x109e));_0x109640&&_0x109640[_0x422a96(0x1097)]();}async function _0x87b746(){const _0x5bc8ce=_0x204348,_0x5182e8=document[_0x5bc8ce(0x458)]('delete-world-books-modal'),_0x51c251=document[_0x5bc8ce(0x458)](_0x5bc8ce(0xb19)),_0x2a6915=document[_0x5bc8ce(0x458)](_0x5bc8ce(0xfa4));_0x51c251[_0x5bc8ce(0x110d)]='',_0x2a6915['checked']=![];const _0x5b6e9a=await _0x17d534[_0x5bc8ce(0xab7)][_0x5bc8ce(0x511)]();_0x5b6e9a[_0x5bc8ce(0x131d)]===0x0?_0x51c251[_0x5bc8ce(0x110d)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>':_0x5b6e9a[_0x5bc8ce(0x12c2)](_0x3b5296=>{const _0x3d7fd4=_0x5bc8ce,_0x21211c=document[_0x3d7fd4(0xe7d)](_0x3d7fd4(0x1323));_0x21211c[_0x3d7fd4(0x69b)]=_0x3d7fd4(0x70b),_0x21211c[_0x3d7fd4(0x1f4)][_0x3d7fd4(0x2d4)]=_0x3b5296['id'],_0x21211c[_0x3d7fd4(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x3b5296[_0x3d7fd4(0x132a)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x51c251[_0x3d7fd4(0x1079)](_0x21211c);}),_0x5182e8[_0x5bc8ce(0x11c2)][_0x5bc8ce(0xa58)](_0x5bc8ce(0x67d));}async function _0x110b96(){const _0x1b4174=_0x204348,_0x557289=document[_0x1b4174(0x102a)]('#delete-world-books-list\x20.clear-posts-item.selected');if(_0x557289[_0x1b4174(0x131d)]===0x0){alert(_0x1b4174(0x1209));return;}const _0x2bfbb7=Array[_0x1b4174(0xca2)](_0x557289)[_0x1b4174(0xbf6)](_0x2b75c1=>_0x2b75c1[_0x1b4174(0x1f4)][_0x1b4174(0x2d4)]),_0x147e30=await _0x2532b9(_0x1b4174(0x7bd),_0x1b4174(0x98b)+_0x557289['length']+_0x1b4174(0xfc1),{'confirmButtonClass':_0x1b4174(0x4d3),'confirmText':_0x1b4174(0x1ef)});if(!_0x147e30)return;await _0x34fce8(_0x1b4174(0x12b9),_0x1b4174(0x662));try{await _0x17d534[_0x1b4174(0x9a7)]('rw',_0x17d534[_0x1b4174(0xab7)],_0x17d534[_0x1b4174(0x954)],async()=>{const _0x512c7c=_0x1b4174;await _0x17d534[_0x512c7c(0xab7)][_0x512c7c(0x1315)](_0x2bfbb7);const _0x4ef1b3=await _0x17d534[_0x512c7c(0x954)]['toArray']();for(const _0x71634 of _0x4ef1b3){if(_0x71634[_0x512c7c(0xda2)]&&Array[_0x512c7c(0x971)](_0x71634[_0x512c7c(0xda2)][_0x512c7c(0x315)])){const _0x23400d=_0x71634[_0x512c7c(0xda2)][_0x512c7c(0x315)][_0x512c7c(0x131d)];_0x71634[_0x512c7c(0xda2)][_0x512c7c(0x315)]=_0x71634[_0x512c7c(0xda2)][_0x512c7c(0x315)][_0x512c7c(0xaf1)](_0x2300ef=>!_0x2bfbb7[_0x512c7c(0xd8d)](_0x2300ef)),_0x71634[_0x512c7c(0xda2)][_0x512c7c(0x315)][_0x512c7c(0x131d)]<_0x23400d&&await _0x17d534[_0x512c7c(0x954)]['put'](_0x71634);}}}),_0x42f206[_0x1b4174(0xab7)]=_0x42f206[_0x1b4174(0xab7)][_0x1b4174(0xaf1)](_0x457294=>!_0x2bfbb7[_0x1b4174(0xd8d)](_0x457294['id'])),document[_0x1b4174(0x458)]('delete-world-books-modal')[_0x1b4174(0x11c2)][_0x1b4174(0x1097)](_0x1b4174(0x67d)),await _0x34fce8(_0x1b4174(0xa59),_0x557289[_0x1b4174(0x131d)]+_0x1b4174(0x10e2));}catch(_0x1f5d3d){console['error']('删除世界书失败:',_0x1f5d3d),await _0x34fce8(_0x1b4174(0xc8d),_0x1b4174(0x137c)+_0x1f5d3d[_0x1b4174(0x7aa)]);}}function _0x5ce695(){const _0x11e3c9=_0x204348;if(!_0x42f206[_0x11e3c9(0x81d)])return;const _0x35a292=_0x42f206[_0x11e3c9(0x81d)],_0x4dc0c6=document[_0x11e3c9(0x458)](_0x11e3c9(0x2c4)),_0x25ebac=document[_0x11e3c9(0x458)](_0x11e3c9(0x1369)),_0x5be9fd=document[_0x11e3c9(0x458)](_0x11e3c9(0xbd4));let _0x2f5d35=_0x3cef04[_0x35a292];if(_0x2f5d35&&_0x2f5d35[_0x11e3c9(0x1196)]){_0x2f5d35['isMinimized']&&_0x575094();_0x4dc0c6['style']['display']=_0x11e3c9(0x82b);return;}_0x3f142e(_0x35a292),_0x54901c(_0x35a292),_0x4dc0c6['style'][_0x11e3c9(0x4db)]=_0x11e3c9(0x82b),_0x25ebac[_0x11e3c9(0x11c2)][_0x11e3c9(0x1097)](_0x11e3c9(0x11cb)),_0x5be9fd['style'][_0x11e3c9(0x4db)]=_0x11e3c9(0x464);const _0x494233=document[_0x11e3c9(0x458)](_0x11e3c9(0xb3e)),_0x345ba3=_0x25ebac[_0x11e3c9(0x89d)](),_0x325d83=(_0x494233[_0x11e3c9(0x91c)]-_0x345ba3[_0x11e3c9(0x120b)])/0x2,_0x11e75e=(_0x494233['clientWidth']-_0x345ba3[_0x11e3c9(0x1147)])/0x2;_0x25ebac[_0x11e3c9(0x1104)][_0x11e3c9(0x76f)]=_0x325d83+'px',_0x25ebac['style']['left']=_0x11e75e+'px',_0x25ebac[_0x11e3c9(0x1104)]['transform']='';}function _0x3f142e(_0x4c74a1){const _0x73727a=_0x204348;_0x3cef04[_0x4c74a1]={'isActive':!![],'isMinimized':![],'title':_0x73727a(0x23e),'contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0xd64345(){const _0x1e68ea=_0x204348,_0x24eb96=_0x42f206[_0x1e68ea(0x81d)];if(!_0x24eb96||!_0x3cef04[_0x24eb96]||!_0x3cef04[_0x24eb96]['isActive'])return;document[_0x1e68ea(0x458)](_0x1e68ea(0x2c4))[_0x1e68ea(0x1104)][_0x1e68ea(0x4db)]='none',document[_0x1e68ea(0x458)]('reading-restore-btn')[_0x1e68ea(0x1104)][_0x1e68ea(0x4db)]=_0x1e68ea(0x464),document[_0x1e68ea(0x458)](_0x1e68ea(0x1369))[_0x1e68ea(0x11c2)][_0x1e68ea(0x1097)]('minimized'),_0x3cef04[_0x24eb96][_0x1e68ea(0x1196)]=![],console['log'](_0x1e68ea(0x7ee));}function _0x322ea6(){const _0x3938b6=_0x204348,_0x2473fc=_0x3cef04[_0x42f206['activeChatId']];if(!_0x2473fc||!_0x2473fc[_0x3938b6(0x1196)]||_0x2473fc[_0x3938b6(0xccd)])return;_0x2473fc[_0x3938b6(0xccd)]=!![],document[_0x3938b6(0x458)](_0x3938b6(0x1369))[_0x3938b6(0x11c2)][_0x3938b6(0xa58)](_0x3938b6(0x11cb)),document[_0x3938b6(0x458)](_0x3938b6(0xbd4))['style'][_0x3938b6(0x4db)]=_0x3938b6(0x82b);}function _0x575094(){const _0x365fd1=_0x204348,_0x4a8de2=_0x3cef04[_0x42f206[_0x365fd1(0x81d)]];if(!_0x4a8de2||!_0x4a8de2['isActive']||!_0x4a8de2[_0x365fd1(0xccd)])return;_0x4a8de2[_0x365fd1(0xccd)]=![],document[_0x365fd1(0x458)]('reading-restore-btn')['style']['display']=_0x365fd1(0x464),document[_0x365fd1(0x458)](_0x365fd1(0x1369))[_0x365fd1(0x11c2)][_0x365fd1(0x1097)]('minimized');}function _0x44b566(_0xdce3f2,_0xac2a50){const _0x226a27=_0x204348;let _0xea04df=0x0,_0x29a23a=0x0,_0x1c1c84=0x0,_0x4da17b=0x0;const _0x1f1d40=document[_0x226a27(0x458)](_0x226a27(0xb3e)),_0x448ec9=_0x54bc75=>{const _0x137e58=_0x226a27;if(_0x54bc75[_0x137e58(0x12df)][_0x137e58(0xe87)](_0x137e58(0x986)))return;if(_0xdce3f2[_0x137e58(0x1104)][_0x137e58(0xb7e)]){const _0x595523=_0xdce3f2[_0x137e58(0x89d)](),_0x2b8d30=_0xdce3f2[_0x137e58(0x127a)]['getBoundingClientRect']();_0xdce3f2[_0x137e58(0x1104)][_0x137e58(0x76f)]=_0x595523[_0x137e58(0x76f)]-_0x2b8d30[_0x137e58(0x76f)]+'px',_0xdce3f2[_0x137e58(0x1104)]['left']=_0x595523[_0x137e58(0x125)]-_0x2b8d30[_0x137e58(0x125)]+'px',_0xdce3f2[_0x137e58(0x1104)][_0x137e58(0xb7e)]='';}_0x54bc75['preventDefault']();const _0x4788ca=_0x54bc75['type']==='touchstart'?_0x54bc75[_0x137e58(0x73f)][0x0]:_0x54bc75;_0x1c1c84=_0x4788ca[_0x137e58(0xf21)],_0x4da17b=_0x4788ca[_0x137e58(0x1034)],document[_0x137e58(0xd85)](_0x137e58(0x1120),_0x579fdb),document['addEventListener'](_0x137e58(0xc65),_0x22d06c),document[_0x137e58(0xd85)](_0x137e58(0x2ba),_0x579fdb),document[_0x137e58(0xd85)]('touchmove',_0x22d06c);},_0x22d06c=_0x25e065=>{const _0x2250c4=_0x226a27,_0x36ef13=_0x25e065[_0x2250c4(0x259)]==='touchmove'?_0x25e065['touches'][0x0]:_0x25e065;_0xea04df=_0x1c1c84-_0x36ef13[_0x2250c4(0xf21)],_0x29a23a=_0x4da17b-_0x36ef13[_0x2250c4(0x1034)],_0x1c1c84=_0x36ef13[_0x2250c4(0xf21)],_0x4da17b=_0x36ef13[_0x2250c4(0x1034)];let _0x40ff61=_0xdce3f2[_0x2250c4(0xbc5)]-_0x29a23a,_0x1e08e2=_0xdce3f2['offsetLeft']-_0xea04df;const _0x55a6f9=_0x1f1d40[_0x2250c4(0x91c)]-_0xdce3f2[_0x2250c4(0xcdb)]-0xa,_0x1900d6=_0x1f1d40[_0x2250c4(0x11e1)]-_0xdce3f2['offsetWidth']-0xa;_0x40ff61=Math[_0x2250c4(0x538)](0xa,Math['min'](_0x40ff61,_0x55a6f9)),_0x1e08e2=Math[_0x2250c4(0x538)](0xa,Math[_0x2250c4(0x137)](_0x1e08e2,_0x1900d6)),_0xdce3f2[_0x2250c4(0x1104)][_0x2250c4(0x76f)]=_0x40ff61+'px',_0xdce3f2[_0x2250c4(0x1104)]['left']=_0x1e08e2+'px';},_0x579fdb=()=>{const _0x58853c=_0x226a27;document[_0x58853c(0x13ac)]('mouseup',_0x579fdb),document['removeEventListener'](_0x58853c(0xc65),_0x22d06c),document['removeEventListener']('touchend',_0x579fdb),document['removeEventListener'](_0x58853c(0xfc2),_0x22d06c);};_0xac2a50['addEventListener'](_0x226a27(0x7d2),_0x448ec9),_0xac2a50[_0x226a27(0xd85)]('touchstart',_0x448ec9);}function _0x54901c(_0x2d5d61){const _0x514c2d=_0x204348,_0x27254f=_0x3cef04[_0x2d5d61];if(!_0x27254f)return;const _0x1923c3=document[_0x514c2d(0x458)](_0x514c2d(0x1432)),_0x36cac3=document[_0x514c2d(0x458)](_0x514c2d(0x936)),_0x4b46c7=document['getElementById'](_0x514c2d(0x344)),_0xce5b4e=document['getElementById'](_0x514c2d(0x8e1)),_0x31099b=document[_0x514c2d(0x458)]('next-page-btn');_0x1923c3['textContent']=_0x27254f[_0x514c2d(0x316)];if(_0x27254f[_0x514c2d(0x41e)][_0x514c2d(0x131d)]===0x0)_0x36cac3[_0x514c2d(0x110d)]=_0x514c2d(0x123),_0x27254f['totalPages']=0x0,_0x27254f[_0x514c2d(0x10da)]=0x0;else{const _0x1a749d=_0x27254f[_0x514c2d(0x10da)]*_0x27254f[_0x514c2d(0x1197)],_0xb55cd3=_0x1a749d+_0x27254f[_0x514c2d(0x1197)];_0x36cac3[_0x514c2d(0x1a2)]=_0x27254f[_0x514c2d(0x41e)][_0x514c2d(0x5b0)](_0x1a749d,_0xb55cd3)[_0x514c2d(0x56c)]('\x0a');}_0x4b46c7[_0x514c2d(0x1a2)]=_0x27254f[_0x514c2d(0x10da)]+0x1+'\x20/\x20'+_0x27254f['totalPages'],_0xce5b4e[_0x514c2d(0xb18)]=_0x27254f[_0x514c2d(0x10da)]===0x0,_0x31099b[_0x514c2d(0xb18)]=_0x27254f[_0x514c2d(0x10da)]>=_0x27254f[_0x514c2d(0x9d9)]-0x1;}function _0x5c1c0c(){const _0x3af1c4=_0x204348,_0x31dacd=_0x3cef04[_0x42f206['activeChatId']];_0x31dacd&&_0x31dacd[_0x3af1c4(0x10da)]<_0x31dacd[_0x3af1c4(0x9d9)]-0x1&&(_0x31dacd[_0x3af1c4(0x10da)]++,_0x54901c(_0x42f206[_0x3af1c4(0x81d)]),document[_0x3af1c4(0x458)](_0x3af1c4(0x936))[_0x3af1c4(0x358)]=0x0,_0x3535c1(_0x31dacd['activeBookId'],_0x31dacd[_0x3af1c4(0x10da)]));}async function _0x3af5b2(){const _0x1da7a9=_0x204348,_0x348521=_0x3cef04[_0x42f206[_0x1da7a9(0x81d)]];_0x348521&&_0x348521[_0x1da7a9(0x10da)]>0x0&&(_0x348521[_0x1da7a9(0x10da)]--,_0x54901c(_0x42f206['activeChatId']),document[_0x1da7a9(0x458)](_0x1da7a9(0x936))['scrollTop']=0x0,await _0x3535c1(_0x348521[_0x1da7a9(0xf38)],_0x348521['currentPage']),await notifyAiOfPageTurn(_0x42f206[_0x1da7a9(0x81d)],_0x348521));}function _0xbeec95(){const _0x2e1776=_0x204348;document[_0x2e1776(0x458)](_0x2e1776(0xba))[_0x2e1776(0x1122)]();}async function _0x5f3fa1(_0x2da495){const _0x490cd8=_0x204348,_0xfaa8e7=new Uint8Array(_0x2da495);if(_0xfaa8e7[_0x490cd8(0x131d)]>=0x3&&_0xfaa8e7[0x0]===0xef&&_0xfaa8e7[0x1]===0xbb&&_0xfaa8e7[0x2]===0xbf)return console[_0x490cd8(0x7d1)](_0x490cd8(0x12a1)),new TextDecoder(_0x490cd8(0x144d))[_0x490cd8(0x1360)](_0xfaa8e7);if(_0xfaa8e7[_0x490cd8(0x131d)]>=0x2&&_0xfaa8e7[0x0]===0xff&&_0xfaa8e7[0x1]===0xfe)return console[_0x490cd8(0x7d1)]('检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。'),new TextDecoder(_0x490cd8(0x97a))[_0x490cd8(0x1360)](_0xfaa8e7);if(_0xfaa8e7['length']>=0x2&&_0xfaa8e7[0x0]===0xfe&&_0xfaa8e7[0x1]===0xff)return console[_0x490cd8(0x7d1)](_0x490cd8(0x75c)),new TextDecoder(_0x490cd8(0x79e))['decode'](_0xfaa8e7);try{console[_0x490cd8(0x7d1)](_0x490cd8(0xa1c));const _0x319ab2=new TextDecoder('utf-8',{'fatal':!![]})[_0x490cd8(0x1360)](_0xfaa8e7);return console[_0x490cd8(0x7d1)](_0x490cd8(0xbe9)),_0x319ab2;}catch(_0x2bb9e3){console['log']('UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...');try{const _0x224e05=new TextDecoder(_0x490cd8(0x1108))[_0x490cd8(0x1360)](_0xfaa8e7);return console[_0x490cd8(0x7d1)](_0x490cd8(0x10bf)),_0x224e05;}catch(_0xc8795f){console[_0x490cd8(0xb61)](_0x490cd8(0xf50),_0xc8795f);throw new Error(_0x490cd8(0x86e));}}}async function _0x5e81ef(_0x4a5729){const _0x217203=_0x204348,_0x2aeae4=_0x4a5729[_0x217203(0x12df)][_0x217203(0x1a9)][0x0];if(!_0x2aeae4)return;try{const _0x264077=await _0x2aeae4[_0x217203(0x1159)](),_0x51ec19=await _0x5f3fa1(_0x264077),_0x3f0e72=_0x2aeae4[_0x217203(0x132a)]['replace'](/\.txt$/i,''),_0x4b4cb7=await _0x17d534[_0x217203(0x1068)]['add']({'title':_0x3f0e72,'content':_0x51ec19,'lastOpened':Date[_0x217203(0x606)]()});await _0x5f2eb6(_0x4b4cb7),document[_0x217203(0x458)]('reading-library-modal')[_0x217203(0x11c2)][_0x217203(0x526)]('visible')&&_0x751204();}catch(_0xb6ef9b){console[_0x217203(0xb61)]('导入书籍失败:',_0xb6ef9b),await _0x34fce8(_0x217203(0xfc4),_0xb6ef9b['message']);}finally{_0x4a5729['target']['value']=null;}}async function _0x117d1f(){const _0xe48af2=_0x204348,_0x54a5a0=_0x42f206[_0xe48af2(0x81d)];if(!_0x54a5a0)return;const _0x527559=_0x3cef04[_0x54a5a0];if(!_0x527559||_0x527559['totalPages']<=0x1)return;const _0x330ff9=await _0x335e57(_0xe48af2(0xa73),_0xe48af2(0x1167)+_0x527559[_0xe48af2(0x9d9)]+')',_0x527559[_0xe48af2(0x10da)]+0x1);if(_0x330ff9===null)return;const _0x21a269=parseInt(_0x330ff9);if(isNaN(_0x21a269)||_0x21a269<0x1||_0x21a269>_0x527559[_0xe48af2(0x9d9)]){alert('请输入一个有效的页码！');return;}_0x527559[_0xe48af2(0x10da)]=_0x21a269-0x1,_0x54901c(_0x54a5a0),_0x3535c1(_0x527559[_0xe48af2(0xf38)],_0x527559['currentPage']);}async function _0x3535c1(_0x36a443,_0x92021a){const _0x2740d1=_0x204348;if(!_0x36a443)return;try{await _0x17d534['readingLibrary'][_0x2740d1(0x938)](_0x36a443,{'currentPage':_0x92021a});}catch(_0x386a24){console[_0x2740d1(0xb61)](_0x2740d1(0x822)+_0x36a443+_0x2740d1(0xfd1),_0x386a24);}}async function _0x5c1c0c(){const _0x3921cb=_0x204348,_0x3d135d=_0x3cef04[_0x42f206['activeChatId']];_0x3d135d&&_0x3d135d['currentPage']<_0x3d135d[_0x3921cb(0x9d9)]-0x1&&(_0x3d135d[_0x3921cb(0x10da)]++,_0x54901c(_0x42f206[_0x3921cb(0x81d)]),document[_0x3921cb(0x458)](_0x3921cb(0x936))[_0x3921cb(0x358)]=0x0,await _0x3535c1(_0x3d135d[_0x3921cb(0xf38)],_0x3d135d[_0x3921cb(0x10da)]),await notifyAiOfPageTurn(_0x42f206[_0x3921cb(0x81d)],_0x3d135d));}function _0x5b44ed(_0x3eeeba,_0x356ebc){const _0x32421f=_0x204348,_0x55b881=_0x42f206[_0x32421f(0x81d)];if(!_0x55b881)return;const _0x35cbf1=_0x3cef04[_0x55b881];_0x35cbf1['title']=_0x3eeeba[_0x32421f(0x33b)](/\.txt$/i,''),_0x35cbf1['contentLines']=_0x356ebc[_0x32421f(0x90b)](/\r\n?|\n/)['map'](_0x1abd4b=>_0x1abd4b[_0x32421f(0x33b)](/ +/g,'\x20')),_0x35cbf1['totalPages']=Math['ceil'](_0x35cbf1['contentLines'][_0x32421f(0x131d)]/_0x35cbf1['linesPerPage']),_0x35cbf1['currentPage']=0x0,_0x54901c(_0x55b881);}async function _0x2cda95(){const _0x2a210a=_0x204348;document[_0x2a210a(0x458)](_0x2a210a(0x2cd))[_0x2a210a(0x8dd)]='',await _0x751204(),document[_0x2a210a(0x458)](_0x2a210a(0xb3d))[_0x2a210a(0x11c2)][_0x2a210a(0xa58)](_0x2a210a(0x67d));}async function _0x751204(_0x450d87=''){const _0x19c38f=_0x204348,_0x2b6e0e=document[_0x19c38f(0x458)](_0x19c38f(0xfb6));let _0x1f8faf=await _0x17d534['readingLibrary'][_0x19c38f(0x50b)](_0x19c38f(0xf7b))[_0x19c38f(0x115b)]()[_0x19c38f(0x511)]();_0x2b6e0e[_0x19c38f(0x110d)]='';_0x450d87&&(_0x1f8faf=_0x1f8faf['filter'](_0x3077d1=>_0x3077d1[_0x19c38f(0x316)][_0x19c38f(0xb15)]()[_0x19c38f(0xd8d)](_0x450d87[_0x19c38f(0xb15)]())));if(_0x1f8faf['length']===0x0){const _0x3f92c8=_0x450d87?_0x19c38f(0xb9c):'书库是空的，点击“导入新书”添加第一本吧！';_0x2b6e0e[_0x19c38f(0x110d)]=_0x19c38f(0x594)+_0x3f92c8+_0x19c38f(0xd36);return;}_0x1f8faf[_0x19c38f(0x12c2)](_0x4f49a4=>{const _0x43073e=_0x19c38f,_0x1c096a=document['createElement'](_0x43073e(0x1323));_0x1c096a[_0x43073e(0x69b)]='existing-group-item',_0x1c096a[_0x43073e(0x110d)]=_0x43073e(0xaf2)+_0x4f49a4['id']+'\x22>'+_0x4f49a4['title']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22'+_0x4f49a4['id']+_0x43073e(0xd08),_0x2b6e0e['appendChild'](_0x1c096a);});}async function _0x5f2eb6(_0x5ecd62){const _0x415a21=_0x204348,_0x3f56cd=_0x42f206[_0x415a21(0x81d)];if(!_0x3f56cd)return;const _0x252ef5=await _0x17d534['readingLibrary'][_0x415a21(0x36d)](_0x5ecd62);if(!_0x252ef5){alert(_0x415a21(0x11a0));return;}await _0x17d534[_0x415a21(0x1068)]['update'](_0x5ecd62,{'lastOpened':Date['now']()});const _0x3de007=_0x3cef04[_0x3f56cd];_0x3de007[_0x415a21(0xf38)]=_0x5ecd62,_0x3de007[_0x415a21(0x316)]=_0x252ef5[_0x415a21(0x316)],_0x3de007['contentLines']=_0x252ef5['content'][_0x415a21(0x90b)](/\r\n?|\n/)[_0x415a21(0xbf6)](_0x1834b1=>_0x1834b1['replace'](/ +/g,'\x20')),_0x3de007[_0x415a21(0x9d9)]=Math[_0x415a21(0xec8)](_0x3de007[_0x415a21(0x41e)]['length']/_0x3de007[_0x415a21(0x1197)]),_0x3de007[_0x415a21(0x10da)]=_0x252ef5[_0x415a21(0x10da)]||0x0,_0x54901c(_0x3f56cd),document[_0x415a21(0x458)](_0x415a21(0x936))[_0x415a21(0x358)]=0x0,document['getElementById'](_0x415a21(0xb3d))[_0x415a21(0x11c2)][_0x415a21(0x1097)](_0x415a21(0x67d));}async function _0x134ccb(_0x59f9dc){const _0x342079=_0x204348,_0x1d996a=await _0x17d534[_0x342079(0x1068)][_0x342079(0x36d)](_0x59f9dc);if(!_0x1d996a)return;const _0x467ba1=await _0x2532b9(_0x342079(0x853),_0x342079(0x1040)+_0x1d996a['title']+_0x342079(0x8e2),{'confirmButtonClass':'btn-danger'});_0x467ba1&&(await _0x17d534[_0x342079(0x1068)][_0x342079(0x195)](_0x59f9dc),await _0x751204());}function _0x5b44ed(_0x592079,_0x1098f7){const _0x394c14=_0x204348,_0x16b4e2=_0x42f206[_0x394c14(0x81d)];if(!_0x16b4e2)return;const _0x3d2eb9=_0x3cef04[_0x16b4e2];_0x3d2eb9[_0x394c14(0x316)]=_0x592079[_0x394c14(0x33b)](/\.txt$/i,''),_0x3d2eb9[_0x394c14(0x41e)]=_0x1098f7[_0x394c14(0x90b)](/\r\n?|\n/),_0x3d2eb9[_0x394c14(0x9d9)]=Math[_0x394c14(0xec8)](_0x3d2eb9['contentLines']['length']/_0x3d2eb9[_0x394c14(0x1197)]),_0x3d2eb9['currentPage']=0x0,_0x54901c(_0x16b4e2);}function _0x44b566(_0x483a71,_0x476bd2){const _0x32c125=_0x204348;let _0x46ffee=0x0,_0x555997=0x0,_0x28f1c8=0x0,_0x41302d=0x0,_0x4612ee=![],_0x5c1b29=![];const _0x7be57f=document[_0x32c125(0x458)](_0x32c125(0xb3e)),_0x194fe2=_0x318697=>{const _0x34c7a9=_0x32c125;if(_0x483a71!==_0x476bd2&&_0x318697[_0x34c7a9(0x12df)][_0x34c7a9(0xe87)](_0x34c7a9(0x986)))return;_0x4612ee=!![],_0x5c1b29=![];const _0x18948e=_0x318697[_0x34c7a9(0x259)]==='touchstart'?_0x318697[_0x34c7a9(0x73f)][0x0]:_0x318697;_0x28f1c8=_0x18948e[_0x34c7a9(0xf21)],_0x41302d=_0x18948e[_0x34c7a9(0x1034)],_0x483a71[_0x34c7a9(0x1104)][_0x34c7a9(0x76f)]=_0x483a71['offsetTop']+'px',_0x483a71[_0x34c7a9(0x1104)]['left']=_0x483a71[_0x34c7a9(0xa4)]+'px',_0x483a71[_0x34c7a9(0x1104)][_0x34c7a9(0xb7e)]='',document['addEventListener']('mouseup',_0xa8846),document[_0x34c7a9(0xd85)](_0x34c7a9(0xc65),_0x2425cf),document[_0x34c7a9(0xd85)](_0x34c7a9(0x2ba),_0xa8846),document['addEventListener'](_0x34c7a9(0xfc2),_0x2425cf,{'passive':![]});},_0x2425cf=_0x4d954c=>{const _0x4f4bae=_0x32c125;if(!_0x4612ee)return;const _0x4105e4=_0x4d954c[_0x4f4bae(0x259)]===_0x4f4bae(0xfc2)?_0x4d954c[_0x4f4bae(0x73f)][0x0]:_0x4d954c,_0x5d4c34=_0x4105e4['clientX']-_0x28f1c8,_0x2053c2=_0x4105e4[_0x4f4bae(0x1034)]-_0x41302d;!_0x5c1b29&&(Math[_0x4f4bae(0xc86)](_0x5d4c34)>0x5||Math[_0x4f4bae(0xc86)](_0x2053c2)>0x5)&&(_0x5c1b29=!![]);_0x5c1b29&&_0x4d954c['cancelable']&&_0x4d954c[_0x4f4bae(0xae3)]();_0x46ffee=_0x28f1c8-_0x4105e4[_0x4f4bae(0xf21)],_0x555997=_0x41302d-_0x4105e4[_0x4f4bae(0x1034)],_0x28f1c8=_0x4105e4[_0x4f4bae(0xf21)],_0x41302d=_0x4105e4[_0x4f4bae(0x1034)];let _0x2455fb=_0x483a71[_0x4f4bae(0xbc5)]-_0x555997,_0x4a21e4=_0x483a71[_0x4f4bae(0xa4)]-_0x46ffee;const _0x592816=_0x7be57f[_0x4f4bae(0x91c)]-_0x483a71['offsetHeight']-0xa,_0x3ad1bb=_0x7be57f['clientWidth']-_0x483a71[_0x4f4bae(0x145e)]-0xa;_0x2455fb=Math['max'](0xa,Math['min'](_0x2455fb,_0x592816)),_0x4a21e4=Math['max'](0xa,Math[_0x4f4bae(0x137)](_0x4a21e4,_0x3ad1bb)),_0x483a71['style'][_0x4f4bae(0x76f)]=_0x2455fb+'px',_0x483a71[_0x4f4bae(0x1104)]['left']=_0x4a21e4+'px';},_0xa8846=()=>{const _0xdcbee7=_0x32c125;document[_0xdcbee7(0x13ac)]('mouseup',_0xa8846),document['removeEventListener'](_0xdcbee7(0xc65),_0x2425cf),document['removeEventListener']('touchend',_0xa8846),document[_0xdcbee7(0x13ac)](_0xdcbee7(0xfc2),_0x2425cf);if(!_0x4612ee)return;_0x4612ee=![],!_0x5c1b29&&_0x483a71[_0xdcbee7(0x1122)]();};_0x476bd2[_0x32c125(0xd85)](_0x32c125(0x7d2),_0x194fe2),_0x476bd2[_0x32c125(0xd85)]('touchstart',_0x194fe2,{'passive':![]});}function _0x322ea6(){const _0xb3dd6f=_0x204348,_0x24dc39=_0x3cef04[_0x42f206['activeChatId']];if(!_0x24dc39||!_0x24dc39[_0xb3dd6f(0x1196)])return;document[_0xb3dd6f(0x458)](_0xb3dd6f(0x1369))[_0xb3dd6f(0x11c2)][_0xb3dd6f(0xa58)](_0xb3dd6f(0x11cb)),document['getElementById'](_0xb3dd6f(0xbd4))[_0xb3dd6f(0x1104)][_0xb3dd6f(0x4db)]=_0xb3dd6f(0x82b),_0x24dc39[_0xb3dd6f(0xccd)]=!![];}function _0x575094(){const _0xe01e2a=_0x204348,_0x3765bf=_0x3cef04[_0x42f206[_0xe01e2a(0x81d)]];if(!_0x3765bf||!_0x3765bf[_0xe01e2a(0x1196)])return;document['getElementById'](_0xe01e2a(0xbd4))[_0xe01e2a(0x1104)][_0xe01e2a(0x4db)]=_0xe01e2a(0x464),document['getElementById'](_0xe01e2a(0x1369))[_0xe01e2a(0x11c2)][_0xe01e2a(0x1097)](_0xe01e2a(0x11cb)),_0x3765bf['isMinimized']=![];}function _0x341c49(_0x29ecfc,_0x12e077){let _0x5995f9;return function(..._0x32ffbe){const _0x500784=_0x1a5b,_0x4868cf=this;clearTimeout(_0x5995f9),_0x5995f9=setTimeout(()=>_0x29ecfc[_0x500784(0xc3e)](_0x4868cf,_0x32ffbe),_0x12e077);};}function _0x44f39e(_0x5e815c){const _0x275a67=_0x204348,_0x43c6f5=_0x3cef04[_0x5e815c];if(!_0x43c6f5||!_0x43c6f5['isActive'])return'';const _0x2e5413=_0x43c6f5[_0x275a67(0x316)]||_0x275a67(0xb7f);let _0x9f3a7c='',_0x51fe96='';if(_0x43c6f5['currentSnippet']&&_0x43c6f5['currentSnippet']['trim']())_0x9f3a7c=_0x43c6f5[_0x275a67(0x124)],_0x51fe96=_0x275a67(0xe4d);else{if(_0x43c6f5[_0x275a67(0x41e)][_0x275a67(0x131d)]>0x0){const _0xcadcbe=_0x43c6f5[_0x275a67(0x10da)]*_0x43c6f5[_0x275a67(0x1197)],_0x138356=_0xcadcbe+_0x43c6f5['linesPerPage'];_0x9f3a7c=_0x43c6f5[_0x275a67(0x41e)]['slice'](_0xcadcbe,_0x138356)[_0x275a67(0x56c)]('\x0a')[_0x275a67(0xa6d)](0x0,0xc8),_0x51fe96='当前页内容摘要';}else _0x9f3a7c=_0x275a67(0x135f),_0x51fe96='内容';}return _0x275a67(0x120c)+_0x2e5413+_0x275a67(0xf92)+_0x51fe96+_0x275a67(0x619)+_0x9f3a7c+_0x275a67(0x9b)+(_0x42f206[_0x275a67(0x954)][_0x5e815c]?.[_0x275a67(0xa1)]||_0x275a67(0xb3f))+_0x275a67(0x12ca);}function _0x40ddca(){const _0x172788=_0x204348,_0xba9d96=_0x42f206[_0x172788(0x81d)];if(!_0xba9d96||!_0x3cef04[_0xba9d96])return;const _0x5ef218=_0x3cef04[_0xba9d96],_0x32be38=document[_0x172788(0x458)]('reading-content'),_0x494405=_0x32be38[_0x172788(0x358)],_0x3e671e=_0x32be38['clientHeight'],_0x46dcea=_0x494405+_0x3e671e,_0x6456d8=0xf*1.8,_0x9b68d8=Math[_0x172788(0xbd5)](_0x494405/_0x6456d8),_0x3cd831=Math[_0x172788(0xec8)](_0x46dcea/_0x6456d8),_0xeb52c8=_0x5ef218[_0x172788(0x10da)]*_0x5ef218['linesPerPage']+_0x9b68d8,_0x2d6d5b=_0x5ef218[_0x172788(0x10da)]*_0x5ef218[_0x172788(0x1197)]+_0x3cd831;if(_0xeb52c8<0x0||_0xeb52c8>=_0x5ef218[_0x172788(0x41e)][_0x172788(0x131d)])return;const _0x33f629=_0x5ef218[_0x172788(0x41e)]['slice'](Math[_0x172788(0x538)](0x0,_0xeb52c8),Math[_0x172788(0x137)](_0x5ef218['contentLines']['length'],_0x2d6d5b))[_0x172788(0x56c)]('\x0a');_0x5ef218[_0x172788(0x124)]=_0x33f629;}function _0x575bad(){const _0x54a041=_0x204348,_0x21ffbe=document['getElementById']('silent-audio-player');if(_0x21ffbe){const _0x2f967a=_0x21ffbe['play']();_0x2f967a!==undefined&&_0x2f967a['then'](_0x24d5c9=>{const _0x34a6c9=_0x1a5b;console['log'](_0x34a6c9(0x12fc));})[_0x54a041(0x1135)](_0x21bf08=>{const _0x3306d6=_0x54a041;console[_0x3306d6(0x1b6)](_0x3306d6(0x3ed),_0x21bf08);});}}function _0x5bc960(){const _0x52df1c=_0x204348,_0x206375=document['getElementById']('silent-audio-player');_0x206375&&!_0x206375[_0x52df1c(0xf7a)]&&(_0x206375[_0x52df1c(0x16a)](),_0x206375[_0x52df1c(0x4b1)]=0x0,console['log'](_0x52df1c(0x383)));}async function _0x31bb35(_0x2b898b){const _0x449e92=_0x204348,_0x4b60ca=decodeURIComponent(_0x2b898b[_0x449e92(0x1f4)][_0x449e92(0xdd5)]),_0x341e91=_0x2b898b['dataset']['voiceId'],_0x584481=_0x2b898b['querySelector'](_0x449e92(0x2fc)),_0x3d8afd=_0x2b898b[_0x449e92(0x586)](_0x449e92(0x1134)),_0x1f90a3=document[_0x449e92(0x458)](_0x449e92(0x7a5));if(!_0x1f90a3['paused']&&_0x1f90a3[_0x449e92(0x1f4)][_0x449e92(0xe1c)]===_0x4b60ca&&_0x1f90a3[_0x449e92(0x1f4)][_0x449e92(0x4a3)]===_0x341e91){_0x1f90a3[_0x449e92(0x16a)]();return;}_0x1f90a3['pause'](),document[_0x449e92(0x102a)](_0x449e92(0x2fc))['forEach'](_0x324cbf=>_0x324cbf[_0x449e92(0x1a2)]='▶');const _0x257ea0='tts_'+_0x341e91+'_'+_0x4b60ca;let _0x42dc91=_0x42f206[_0x449e92(0xdca)][_0x449e92(0x36d)](_0x257ea0);if(_0x42dc91){console[_0x449e92(0x7d1)]('从缓存播放\x20TTS\x20音频...'),await _0x579ba3(_0x42dc91['url'],_0x42dc91[_0x449e92(0x259)],_0x4b60ca,_0x341e91,_0x2b898b);return;}console[_0x449e92(0x7d1)]('无缓存，正在请求\x20Minimax\x20TTS\x20API...');if(_0x584481)_0x584481[_0x449e92(0x1104)][_0x449e92(0x4db)]=_0x449e92(0x464);_0x3d8afd[_0x449e92(0x1104)][_0x449e92(0x4db)]=_0x449e92(0x1188);const {minimaxGroupId:_0xb0f825,minimaxApiKey:_0x5c7645}=_0x42f206['apiConfig'];if(!_0xb0f825||!_0x5c7645){await _0x34fce8(_0x449e92(0x1012),_0x449e92(0x8a2)),_0x3d8afd[_0x449e92(0x1104)][_0x449e92(0x4db)]=_0x449e92(0x464);if(_0x584481)_0x584481[_0x449e92(0x1104)][_0x449e92(0x4db)]=_0x449e92(0x82b);return;}try{const _0x237446=await fetch(_0x449e92(0x9f1)+_0xb0f825,{'method':_0x449e92(0x1312),'headers':{'Authorization':'Bearer\x20'+_0x5c7645,'Content-Type':_0x449e92(0xa0e)},'body':JSON[_0x449e92(0xc04)]({'text':_0x4b60ca,'voice_id':_0x341e91,'model':_0x42f206[_0x449e92(0x5cb)]['minimaxModel']||_0x449e92(0x201),'speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0x237446['ok']){let _0x3b552e='API\x20返回错误:\x20'+_0x237446[_0x449e92(0x13b2)];try{const _0x2072c0=await _0x237446['json']();_0x3b552e=_0x2072c0[_0x449e92(0x11a)]?.[_0x449e92(0x384)]||JSON[_0x449e92(0xc04)](_0x2072c0);}catch(_0x2ede51){_0x3b552e=await _0x237446[_0x449e92(0xdd5)]();}throw new Error(_0x3b552e);}const _0x3f02fb=await _0x237446[_0x449e92(0x43d)](),_0x33f534=URL[_0x449e92(0x795)](_0x3f02fb);await _0x579ba3(_0x33f534,_0x3f02fb['type'],_0x4b60ca,_0x341e91,_0x2b898b);const _0x549102=new FileReader();_0x549102[_0x449e92(0x13a7)]=function(){const _0x58cf12=_0x449e92;_0x42f206[_0x58cf12(0xdca)][_0x58cf12(0xe71)](_0x257ea0,{'url':_0x549102['result'],'type':_0x3f02fb['type']}),console[_0x58cf12(0x7d1)]('TTS\x20音频已保存到缓存。');},_0x549102[_0x449e92(0x96e)](_0x3f02fb);}catch(_0x424c1e){console[_0x449e92(0xb61)]('Minimax\x20TTS\x20API\x20调用失败:',_0x424c1e),await _0x34fce8(_0x449e92(0xc5),_0x449e92(0x19e)+_0x424c1e[_0x449e92(0x7aa)]);}finally{_0x3d8afd['style']['display']=_0x449e92(0x464);if(_0x584481)_0x584481[_0x449e92(0x1104)][_0x449e92(0x4db)]='flex';}}function _0x579ba3(_0x1ab134,_0x5de2a9,_0x3bf094,_0x27a992,_0x1812e4){return new Promise((_0x41017f,_0x2d8438)=>{const _0x44bd10=_0x1a5b,_0x2423e8=document[_0x44bd10(0x458)]('tts-audio-player');_0x2423e8[_0x44bd10(0x577)]=_0x1ab134,_0x2423e8[_0x44bd10(0x259)]=_0x5de2a9,_0x2423e8[_0x44bd10(0x1f4)][_0x44bd10(0xe1c)]=_0x3bf094,_0x2423e8[_0x44bd10(0x1f4)][_0x44bd10(0x4a3)]=_0x27a992;const _0x2802a0=_0x2423e8[_0x44bd10(0x1391)]();_0x2802a0!==undefined&&_0x2802a0[_0x44bd10(0x1260)](()=>{const _0x396358=_0x44bd10,_0x54ccee=_0x1812e4[_0x396358(0x586)]('.voice-play-btn');if(_0x54ccee)_0x54ccee['textContent']='❚❚';_0x41017f();})[_0x44bd10(0x1135)](_0x49ed8c=>{const _0x210e2d=_0x44bd10;console[_0x210e2d(0xb61)](_0x210e2d(0x82f),_0x49ed8c),_0x2d8438(_0x49ed8c);}),_0x2423e8[_0x44bd10(0x831)]=()=>{const _0x224ae6=_0x44bd10,_0x589528=_0x1812e4[_0x224ae6(0x586)]('.voice-play-btn');if(_0x589528)_0x589528[_0x224ae6(0x1a2)]='▶';},_0x2423e8[_0x44bd10(0xd32)]=()=>{const _0xfa62b0=_0x44bd10,_0x4963ab=_0x1812e4[_0xfa62b0(0x586)](_0xfa62b0(0x2fc));if(_0x4963ab)_0x4963ab[_0xfa62b0(0x1a2)]='▶';};});}function _0x128a08(_0x4e63af){const _0xdccb6e=_0x204348,_0x2b5cbb=_0x4e63af[_0xdccb6e(0xe87)](_0xdccb6e(0xd4f));if(!_0x2b5cbb)return;const _0x3d999f=_0x2b5cbb[_0xdccb6e(0x586)](_0xdccb6e(0x3a1)),_0x4d7095=decodeURIComponent(_0x4e63af[_0xdccb6e(0x1f4)][_0xdccb6e(0xdd5)]);_0x3d999f[_0xdccb6e(0x1104)][_0xdccb6e(0x4db)]==='block'?_0x3d999f['style'][_0xdccb6e(0x4db)]='none':(_0x3d999f[_0xdccb6e(0x1a2)]=_0x4d7095,_0x3d999f[_0xdccb6e(0x1104)][_0xdccb6e(0x4db)]='block');}async function _0x9f9531(){const _0x1dbfd7=_0x204348;await _0x2eacbd(),document['getElementById'](_0x1dbfd7(0x778))[_0x1dbfd7(0x11c2)][_0x1dbfd7(0xa58)]('visible');}async function _0x2eacbd(){const _0x464199=_0x204348,_0x4ca84b=document[_0x464199(0x458)](_0x464199(0x1367)),_0x5c9955=await _0x17d534[_0x464199(0x618)][_0x464199(0x511)]();_0x4ca84b[_0x464199(0x110d)]='';if(_0x5c9955['length']===0x0){_0x4ca84b[_0x464199(0x110d)]=_0x464199(0x88);return;}_0x5c9955['forEach'](_0x2cb252=>{const _0x394449=_0x464199,_0x3dc65c=document[_0x394449(0xe7d)](_0x394449(0x1323));_0x3dc65c[_0x394449(0x69b)]='existing-group-item',_0x3dc65c[_0x394449(0x110d)]=_0x394449(0xc8a)+_0x2cb252[_0x394449(0x132a)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x2cb252['id']+_0x394449(0x9be),_0x4ca84b[_0x394449(0x1079)](_0x3dc65c);});}async function _0x4a284f(){const _0x2f7122=_0x204348,_0x162619=document[_0x2f7122(0x458)](_0x2f7122(0x4ad)),_0x2bedec=_0x162619[_0x2f7122(0x8dd)]['trim']();if(!_0x2bedec)return alert(_0x2f7122(0x4ac));const _0x10403d=await _0x17d534[_0x2f7122(0x618)][_0x2f7122(0x13c6)]('name')[_0x2f7122(0x7db)](_0x2bedec)['first']();if(_0x10403d)return alert(_0x2f7122(0x269)+_0x2bedec+_0x2f7122(0x374));await _0x17d534[_0x2f7122(0x618)][_0x2f7122(0xa58)]({'name':_0x2bedec}),_0x162619[_0x2f7122(0x8dd)]='',await _0x2eacbd();}async function _0x4b54a0(_0x14afb1){const _0x54557d=_0x204348,_0x1a23c7=await _0x2532b9(_0x54557d(0x1ef),_0x54557d(0x48f),{'confirmButtonClass':_0x54557d(0x4d3)});_0x1a23c7&&(await _0x17d534['shoppingCategories'][_0x54557d(0x195)](_0x14afb1),await _0x17d534['shoppingProducts']['where'](_0x54557d(0x5f7))[_0x54557d(0x7db)](_0x14afb1)[_0x54557d(0x910)]({'categoryId':null}),await _0x2eacbd());}function _0x4aa268(_0x1060d1={}){const _0x141f2f=_0x204348,_0x702806=document[_0x141f2f(0x458)](_0x141f2f(0xb38)),_0xabcd51=document[_0x141f2f(0xe7d)]('div');return _0xabcd51[_0x141f2f(0x69b)]=_0x141f2f(0x493),_0xabcd51[_0x141f2f(0x110d)]=_0x141f2f(0x90d)+(_0x1060d1['name']||'')+_0x141f2f(0xe77)+(_0x1060d1[_0x141f2f(0x1043)]||'')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22'+(_0x1060d1['imageUrl']||_0x141f2f(0xdae))+_0x141f2f(0x595),_0xabcd51['querySelector'](_0x141f2f(0xf3c))[_0x141f2f(0xd85)](_0x141f2f(0x1122),()=>_0xabcd51[_0x141f2f(0x1097)]()),_0xabcd51['querySelector'](_0x141f2f(0x8c6))[_0x141f2f(0xd85)](_0x141f2f(0x1122),()=>{const _0xf4f087=_0x141f2f;_0xabcd51[_0xf4f087(0x586)](_0xf4f087(0x6bb))[_0xf4f087(0x1122)]();}),_0xabcd51['querySelector'](_0x141f2f(0x6bb))[_0x141f2f(0xd85)](_0x141f2f(0x26a),_0x1de599=>{const _0x155b79=_0x141f2f,_0xe27d53=_0x1de599[_0x155b79(0x12df)][_0x155b79(0x1a9)][0x0];if(_0xe27d53){const _0x3797c5=new FileReader();_0x3797c5[_0x155b79(0x11fa)]=_0x62367b=>{const _0xb2ceec=_0x155b79;_0xabcd51['querySelector'](_0xb2ceec(0x53b))[_0xb2ceec(0x577)]=_0x62367b[_0xb2ceec(0x12df)]['result'];},_0x3797c5[_0x155b79(0x96e)](_0xe27d53);}}),_0x702806['appendChild'](_0xabcd51),_0xabcd51;}async function _0x3ec6cd(_0x32ec89){const _0x12f7cf=_0x204348,_0x486631=await _0x17d534[_0x12f7cf(0x122c)][_0x12f7cf(0x36d)](_0x32ec89);if(!_0x486631||!_0x486631[_0x12f7cf(0xae6)]||_0x486631['variations'][_0x12f7cf(0x131d)]===0x0)return;const _0x3ab96f=document[_0x12f7cf(0x458)](_0x12f7cf(0x672));document['getElementById'](_0x12f7cf(0xb96))[_0x12f7cf(0x577)]=_0x486631[_0x12f7cf(0x2cc)],document[_0x12f7cf(0x458)](_0x12f7cf(0x33a))['textContent']=_0x486631[_0x12f7cf(0x132a)];const _0x35617f=document[_0x12f7cf(0x458)](_0x12f7cf(0xe98));_0x35617f[_0x12f7cf(0x110d)]='',_0x486631[_0x12f7cf(0xae6)][_0x12f7cf(0x12c2)]((_0x34664a,_0x12219c)=>{const _0x6e4a1d=_0x12f7cf,_0xb16277=document[_0x6e4a1d(0xe7d)](_0x6e4a1d(0x754));_0xb16277['type']=_0x6e4a1d(0x12b1),_0xb16277[_0x6e4a1d(0x132a)]=_0x6e4a1d(0xb8),_0xb16277['id']=_0x6e4a1d(0x62d)+_0x32ec89+'-'+_0x12219c,_0xb16277[_0x6e4a1d(0x8dd)]=_0x12219c,_0xb16277[_0x6e4a1d(0x1104)][_0x6e4a1d(0x4db)]=_0x6e4a1d(0x464);if(_0x12219c===0x0)_0xb16277[_0x6e4a1d(0x8f7)]=!![];const _0x59cc99=document[_0x6e4a1d(0xe7d)]('label');_0x59cc99[_0x6e4a1d(0x8c5)]=_0x6e4a1d(0x62d)+_0x32ec89+'-'+_0x12219c,_0x59cc99[_0x6e4a1d(0x1a2)]=_0x34664a[_0x6e4a1d(0x132a)],_0x59cc99[_0x6e4a1d(0x1104)][_0x6e4a1d(0x11f)]=_0x6e4a1d(0xf8b),_0x35617f[_0x6e4a1d(0x1079)](_0xb16277),_0x35617f['appendChild'](_0x59cc99);});const _0x31ab8f=()=>{const _0x81719=_0x12f7cf,_0x4963ef=_0x35617f[_0x81719(0x586)]('input[name=\x22variation-select\x22]:checked');_0x35617f['querySelectorAll']('label')[_0x81719(0x12c2)](_0x107019=>{const _0x5e4d7c=_0x81719;_0x107019[_0x5e4d7c(0x1104)][_0x5e4d7c(0x7dc)]=_0x5e4d7c(0x8f8),_0x107019[_0x5e4d7c(0x1104)][_0x5e4d7c(0x961)]='#333',_0x107019[_0x5e4d7c(0x1104)][_0x5e4d7c(0x11d7)]='white';});if(_0x4963ef){const _0xfb6bbc=_0x35617f[_0x81719(0x586)](_0x81719(0x1353)+_0x4963ef['id']+'\x22]');_0xfb6bbc['style'][_0x81719(0x7dc)]=_0x81719(0x1fa),_0xfb6bbc[_0x81719(0x1104)][_0x81719(0x961)]=_0x81719(0x1fa),_0xfb6bbc[_0x81719(0x1104)]['backgroundColor']=_0x81719(0x10d2);const _0x4aa846=_0x486631['variations'][parseInt(_0x4963ef[_0x81719(0x8dd)])];document[_0x81719(0x458)](_0x81719(0x542))[_0x81719(0x1a2)]='¥'+_0x4aa846[_0x81719(0x1043)][_0x81719(0x800)](0x2),_0x4aa846[_0x81719(0x2cc)]?document[_0x81719(0x458)](_0x81719(0xb96))[_0x81719(0x577)]=_0x4aa846[_0x81719(0x2cc)]:document['getElementById'](_0x81719(0xb96))[_0x81719(0x577)]=_0x486631['imageUrl'];}};_0x35617f['addEventListener'](_0x12f7cf(0x26a),_0x31ab8f),_0x31ab8f(),document[_0x12f7cf(0x458)](_0x12f7cf(0x70e))[_0x12f7cf(0x1a2)]='1';const _0x3beba6=document[_0x12f7cf(0x458)](_0x12f7cf(0x1466)),_0x149452=_0x3beba6['cloneNode'](!![]);_0x3beba6[_0x12f7cf(0x135e)][_0x12f7cf(0x3f2)](_0x149452,_0x3beba6),_0x149452[_0x12f7cf(0xd85)](_0x12f7cf(0x1122),async()=>{const _0x4a1dce=_0x12f7cf,_0x4c7e7b=_0x35617f[_0x4a1dce(0x586)]('input[name=\x22variation-select\x22]:checked'),_0x4b2043=parseInt(document[_0x4a1dce(0x458)]('variation-quantity-display')[_0x4a1dce(0x1a2)]);if(_0x4c7e7b){const _0x2a3202=_0x486631[_0x4a1dce(0xae6)][parseInt(_0x4c7e7b[_0x4a1dce(0x8dd)])];await _0x4185d9(_0x32ec89,_0x4b2043,_0x2a3202),_0x3ab96f[_0x4a1dce(0x11c2)][_0x4a1dce(0x1097)](_0x4a1dce(0x67d)),await _0x34fce8('成功',_0x4a1dce(0x5d1));}}),_0x3ab96f[_0x12f7cf(0x11c2)][_0x12f7cf(0xa58)]('visible');}function _0x431ff9(){const _0x3c0bbf=_0x204348,_0x245d7f=document[_0x3c0bbf(0x458)](_0x3c0bbf(0xef5));document[_0x3c0bbf(0x458)](_0x3c0bbf(0x9df))[_0x3c0bbf(0x8dd)]=_0x42f206['globalSettings'][_0x3c0bbf(0xfd6)]||0x3,document[_0x3c0bbf(0x458)](_0x3c0bbf(0x465))[_0x3c0bbf(0x8dd)]=_0x42f206['globalSettings'][_0x3c0bbf(0xd27)]||0x8,_0x245d7f[_0x3c0bbf(0x11c2)][_0x3c0bbf(0xa58)](_0x3c0bbf(0x67d));}async function _0x297918(){const _0x22e530=_0x204348,_0x552834=document[_0x22e530(0x458)]('shopping-category-count-input'),_0x12ca03=document[_0x22e530(0x458)](_0x22e530(0x465)),_0x4a16a7=parseInt(_0x552834[_0x22e530(0x8dd)]),_0x2b298d=parseInt(_0x12ca03[_0x22e530(0x8dd)]);if(isNaN(_0x4a16a7)||isNaN(_0x2b298d)||_0x4a16a7<0x1||_0x2b298d<0x1){alert(_0x22e530(0xcea));return;}_0x42f206[_0x22e530(0xf0)][_0x22e530(0xfd6)]=_0x4a16a7,_0x42f206[_0x22e530(0xf0)][_0x22e530(0xd27)]=_0x2b298d,await _0x17d534[_0x22e530(0xf0)]['put'](_0x42f206[_0x22e530(0xf0)]),document['getElementById'](_0x22e530(0xef5))[_0x22e530(0x11c2)][_0x22e530(0x1097)](_0x22e530(0x67d)),await _0x34fce8(_0x22e530(0x1355),_0x22e530(0x9da));}async function _0x43b9d6(){const _0x550883=_0x204348;if(!_0x42f206['activeChatId']){await _0x34fce8(_0x550883(0x96d),_0x550883(0xeb5));return;}const _0x4b4881=_0x42f206['chats'][_0x42f206[_0x550883(0x81d)]],_0x23fb73=await _0x2532b9('为“'+_0x4b4881['name']+'”生成商品？','此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？',{'confirmText':_0x550883(0x1285)});if(!_0x23fb73)return;await _0x34fce8('请稍候...','正在根据“'+_0x4b4881[_0x550883(0x132a)]+'”的特点生成专属商品...');const _0x5c5167=_0x42f206[_0x550883(0x5cb)][_0x550883(0x1380)]&&_0x42f206[_0x550883(0x5cb)][_0x550883(0x121d)]&&_0x42f206[_0x550883(0x5cb)][_0x550883(0xdc9)],{proxyUrl:_0xcb2363,apiKey:_0x89f445,model:_0xb56c41}=_0x5c5167?{'proxyUrl':_0x42f206[_0x550883(0x5cb)][_0x550883(0x1380)],'apiKey':_0x42f206[_0x550883(0x5cb)][_0x550883(0x121d)],'model':_0x42f206[_0x550883(0x5cb)][_0x550883(0xdc9)]}:_0x42f206[_0x550883(0x5cb)];if(!_0xcb2363||!_0x89f445||!_0xb56c41){await _0x34fce8('API未配置',_0x550883(0x36e));return;}const _0x326467=_0x42f206['globalSettings']['shoppingCategoryCount']||0x3,_0x5a774d=_0x42f206['globalSettings'][_0x550883(0xd27)]||0x8,_0xee4b9a=await _0x17d534[_0x550883(0x618)][_0x550883(0x511)]();let _0x4dfb98='';_0xee4b9a['length']>0x0&&(_0x4dfb98=_0x550883(0x805)+_0xee4b9a[_0x550883(0xbf6)](_0x3e9cdd=>'\x22'+_0x3e9cdd[_0x550883(0x132a)]+'\x22')['join'](',\x20')+']\x0a');const _0x359a73=_0x42f206[_0x550883(0x551)]['nickname']||'我',_0xe4ad63=_0x4b4881[_0x550883(0x94a)]&&_0x4b4881[_0x550883(0x94a)][_0x550883(0x131d)]>0x0?_0x4b4881['longTermMemory'][_0x550883(0xbf6)](_0x404fb4=>'-\x20(记录于\x20'+_0x1f0c92(_0x404fb4[_0x550883(0xf16)])+')\x20'+_0x404fb4['content'])[_0x550883(0x56c)]('\x0a'):'无',_0x18d08e=_0x4b4881['history'][_0x550883(0x5b0)](-0xa)['map'](_0x1d2efa=>(_0x1d2efa[_0x550883(0xaeb)]==='user'?_0x359a73:_0x4b4881[_0x550883(0x132a)])+':\x20'+String(_0x1d2efa['content'])[_0x550883(0xa6d)](0x0,0x1e)+_0x550883(0x10a0))[_0x550883(0x56c)]('\x0a');let _0x353d7f='';if(_0x4b4881[_0x550883(0xda2)]['linkedWorldBookIds']&&_0x4b4881[_0x550883(0xda2)][_0x550883(0x315)][_0x550883(0x131d)]>0x0){const _0x59d1b7=_0x4b4881[_0x550883(0xda2)][_0x550883(0x315)][_0x550883(0xbf6)](_0x1c375f=>{const _0x63b6a=_0x550883,_0x496e24=_0x42f206[_0x63b6a(0xab7)][_0x63b6a(0xb07)](_0x53e1b7=>_0x53e1b7['id']===_0x1c375f);if(!_0x496e24||!Array[_0x63b6a(0x971)](_0x496e24['content']))return'';const _0xf20789=_0x496e24[_0x63b6a(0x1316)][_0x63b6a(0xaf1)](_0x23b17a=>_0x23b17a[_0x63b6a(0x12fb)]!==![])[_0x63b6a(0xbf6)](_0x4849c0=>'-\x20'+_0x4849c0[_0x63b6a(0x1316)])[_0x63b6a(0x56c)]('\x0a');return _0xf20789?_0x63b6a(0x708)+_0x496e24[_0x63b6a(0x132a)]+_0x63b6a(0x2a0)+_0xf20789:'';})[_0x550883(0xaf1)](Boolean)[_0x550883(0x56c)]('');_0x59d1b7&&(_0x353d7f=_0x550883(0xff7)+_0x59d1b7+'\x0a');}const _0x58c181=_0x550883(0xc78)+_0x4b4881[_0x550883(0x132a)]+_0x550883(0x1e3)+_0x326467+_0x550883(0xf1a)+_0x5a774d+_0x550883(0x10ec)+_0x4b4881['name']+_0x550883(0xd3e)+_0x4b4881[_0x550883(0xda2)]['aiPersona']+_0x550883(0x9fc)+_0xe4ad63+_0x550883(0xe96)+_0x353d7f+'\x0a'+_0x4dfb98+_0x550883(0x134e)+_0x18d08e+_0x550883(0x35b)+_0x4b4881['name']+_0x550883(0xd6b);try{const _0x5b1b0c=[{'role':_0x550883(0xf86),'content':_0x550883(0x13f6)}];let _0x26c32e=_0xcb2363['includes'](_0x550883(0xfe3)),_0x42db3a=_0x5d73db(_0xb56c41,_0x89f445,_0x58c181,_0x5b1b0c);const _0x14a5b3=_0x26c32e?await fetch(_0x42db3a[_0x550883(0x1377)],_0x42db3a[_0x550883(0x76b)]):await fetch(_0xcb2363+_0x550883(0xd7),{'method':_0x550883(0x1312),'headers':{'Content-Type':'application/json','Authorization':_0x550883(0x8aa)+_0x89f445},'body':JSON[_0x550883(0xc04)]({'model':_0xb56c41,'messages':[{'role':'system','content':_0x58c181},..._0x5b1b0c],'temperature':_0x42f206[_0x550883(0xf0)]['apiTemperature']||0.9})});if(!_0x14a5b3['ok'])throw new Error(_0x550883(0x676)+_0x14a5b3[_0x550883(0xf0c)]);const _0xf79408=await _0x14a5b3[_0x550883(0xaef)](),_0x20dc49=getGeminiResponseText(_0xf79408),_0x5b1b85=_0x20dc49[_0x550883(0x41c)](/({[\s\S]*})/);if(!_0x5b1b85)throw new Error(_0x550883(0x73a));const _0x2719da=JSON[_0x550883(0x44c)](_0x5b1b85[0x0]);if(!_0x2719da[_0x550883(0x774)]||!Array['isArray'](_0x2719da[_0x550883(0x774)]))throw new Error(_0x550883(0xeac));await _0x17d534[_0x550883(0x9a7)]('rw',_0x17d534[_0x550883(0x122c)],_0x17d534['shoppingCategories'],async()=>{const _0x342f9a=_0x550883;for(const _0x1333e3 of _0x2719da[_0x342f9a(0x774)]){let _0xff453a;const _0x47360e=await _0x17d534[_0x342f9a(0x618)][_0x342f9a(0x13c6)]('name')['equalsIgnoreCase'](_0x1333e3[_0x342f9a(0x132a)])[_0x342f9a(0xb9)]();_0x47360e?_0xff453a=_0x47360e['id']:_0xff453a=await _0x17d534[_0x342f9a(0x618)]['add']({'name':_0x1333e3[_0x342f9a(0x132a)]});const _0x436aa1=_0x1333e3[_0x342f9a(0x7a)][_0x342f9a(0xbf6)](_0x5ba4f5=>{const _0x354906=_0x342f9a;return{'name':_0x5ba4f5[_0x354906(0x132a)],'price':_0x5ba4f5[_0x354906(0x1043)]||0x0,'description':_0x5ba4f5['description']||'','imageUrl':_0x354906(0x94c)+encodeURIComponent(_0x5ba4f5['image_prompt']),'variations':(_0x5ba4f5[_0x354906(0xae6)]||[])[_0x354906(0xbf6)](_0x2019d4=>({..._0x2019d4,'imageUrl':_0x354906(0x94c)+encodeURIComponent(_0x2019d4[_0x354906(0xef)])})),'categoryId':_0xff453a};});_0x436aa1['length']>0x0&&await _0x17d534[_0x342f9a(0x122c)][_0x342f9a(0xaad)](_0x436aa1);}}),activeShoppingCategoryId=_0x550883(0xfe2),await _0x1044f9(),await _0x34fce8(_0x550883(0xc9e),'为“'+_0x4b4881[_0x550883(0x132a)]+_0x550883(0xc90));}catch(_0x1719c2){console['error']('生成购物中心商品失败:',_0x1719c2),await _0x34fce8('生成失败',_0x550883(0x21e)+_0x1719c2['message']);}}async function _0xeff28(_0x2b2f71){const _0x1a9969=_0x204348,_0x325677=document[_0x1a9969(0x458)](_0x2b2f71);if(!_0x325677)return;const _0x47b6c9=await _0xcd7475(_0x1a9969(0x136e),[{'text':_0x1a9969(0xe85),'value':_0x1a9969(0x1030)},{'text':_0x1a9969(0x1e1),'value':_0x1a9969(0x1377)}]);let _0x39aee0=null;if(_0x47b6c9===_0x1a9969(0x1030))_0x39aee0=await _0x5f0541();else _0x47b6c9===_0x1a9969(0x1377)&&(_0x39aee0=await _0x335e57(_0x1a9969(0x136e),'请输入新的图片URL：',_0x325677['src'],_0x1a9969(0x1377)));if(_0x39aee0&&_0x39aee0[_0x1a9969(0x2aa)]()){const _0x3a79d9=_0x39aee0[_0x1a9969(0x2aa)]();_0x325677[_0x1a9969(0x577)]=_0x3a79d9,!_0x42f206['globalSettings']['widgetData']&&(_0x42f206['globalSettings'][_0x1a9969(0x755)]={}),_0x42f206[_0x1a9969(0xf0)][_0x1a9969(0x755)][_0x2b2f71]=_0x3a79d9,await _0x17d534['globalSettings']['put'](_0x42f206['globalSettings']),await _0x34fce8('成功','组件图片已更新！');}}window[_0x204348(0x1e6)]=_0xeff28;async function _0x1a5f49(){const _0x1d978b=_0x204348;if(!window[_0x1d978b(0xb9d)]||typeof JSZip===_0x1d978b(0x37c)){await _0x34fce8('库加载失败','无法启动导出，所需的核心库\x20(StreamSaver.js\x20或\x20JSZip)\x20未加载。请检查您的网络连接并刷新页面后重试。');return;}await _0x34fce8('正在准备分片导出...','即将开始打包您的完整备份文件。文件将以ZIP格式流式下载，请勿关闭页面。');const _0x50727a=streamSaver[_0x1d978b(0x16e)](_0x1d978b(0x205)+new Date()[_0x1d978b(0xf63)]()[_0x1d978b(0x90b)]('T')[0x0]+_0x1d978b(0x84a)),_0x4c0f60=new JSZip(),_0x2d8c3a=0x5f*0x400*0x400;let _0x44ba77=0x1,_0x5c2fb4={},_0xab2b72=0x0;const _0xc96f36=new TextEncoder();try{const _0x1a77db=_0x17d534['tables'][_0x1d978b(0xbf6)](_0x39fb13=>_0x39fb13[_0x1d978b(0x132a)]);for(const _0x5da411 of _0x1a77db){console[_0x1d978b(0x7d1)]('正在打包表:\x20'+_0x5da411+'...');const _0x137195=await _0x17d534[_0x1d978b(0xca3)](_0x5da411)[_0x1d978b(0x511)]();if(_0x137195['length']===0x0)continue;const _0x151660=JSON[_0x1d978b(0xc04)](_0x137195),_0x1e9f8e=_0xc96f36[_0x1d978b(0xedb)](_0x151660)[_0x1d978b(0x131d)];if(_0x1e9f8e>_0x2d8c3a){console[_0x1d978b(0x1b6)]('警告：表\x20\x22'+_0x5da411+_0x1d978b(0x5a6)+(_0x1e9f8e/0x400/0x400)[_0x1d978b(0x800)](0x2)+_0x1d978b(0xdc6));_0xab2b72>0x0&&(_0x4c0f60[_0x1d978b(0x67b)](_0x1d978b(0x138a)+_0x44ba77++ +_0x1d978b(0xb42),JSON['stringify']({'version':0x4,'type':_0x1d978b(0x5b0),'data':_0x5c2fb4})),_0x5c2fb4={},_0xab2b72=0x0);_0x5c2fb4[_0x5da411]=_0x137195,_0x4c0f60[_0x1d978b(0x67b)]('slice_'+_0x44ba77++ +_0x1d978b(0xb42),JSON[_0x1d978b(0xc04)]({'version':0x4,'type':_0x1d978b(0x5b0),'data':_0x5c2fb4})),_0x5c2fb4={},_0xab2b72=0x0;continue;}_0xab2b72>0x0&&_0xab2b72+_0x1e9f8e>_0x2d8c3a&&(console[_0x1d978b(0x7d1)](_0x1d978b(0xff6)+_0x44ba77+_0x1d978b(0x104e)+(_0xab2b72/0x400/0x400)[_0x1d978b(0x800)](0x2)+_0x1d978b(0x123d)),_0x4c0f60[_0x1d978b(0x67b)](_0x1d978b(0x138a)+_0x44ba77++ +'.json',JSON[_0x1d978b(0xc04)]({'version':0x4,'type':_0x1d978b(0x5b0),'data':_0x5c2fb4})),_0x5c2fb4={},_0xab2b72=0x0),_0x5c2fb4[_0x5da411]=_0x137195,_0xab2b72+=_0x1e9f8e;}_0xab2b72>0x0&&(console[_0x1d978b(0x7d1)](_0x1d978b(0x74b)+_0x44ba77+_0x1d978b(0x7a1)+(_0xab2b72/0x400/0x400)['toFixed'](0x2)+_0x1d978b(0xc2f)),_0x4c0f60[_0x1d978b(0x67b)]('slice_'+_0x44ba77+'.json',JSON['stringify']({'version':0x4,'type':_0x1d978b(0x5b0),'data':_0x5c2fb4})));console[_0x1d978b(0x7d1)](_0x1d978b(0xb99));const _0x2aef1c=_0x4c0f60[_0x1d978b(0x578)]({'type':_0x1d978b(0x43d),'streamFiles':!![]}),_0x210d2a=new ReadableStream({'start'(_0x53d76a){const _0x5b6c8f=_0x1d978b;_0x2aef1c['on']('data',_0x1f5dd2=>{const _0x14e858=_0x1a5b;_0x53d76a[_0x14e858(0x165)](_0x1f5dd2);})['on']('end',()=>{const _0x1a9004=_0x1a5b;console['log'](_0x1a9004(0xb1c)),_0x53d76a[_0x1a9004(0x11c4)]();})['on'](_0x5b6c8f(0xb61),_0x21ca97=>{const _0x284d01=_0x5b6c8f;console[_0x284d01(0xb61)](_0x284d01(0xc75),_0x21ca97),_0x53d76a['error'](_0x21ca97);})['resume']();}});await _0x210d2a[_0x1d978b(0x49a)](_0x50727a),await _0x34fce8(_0x1d978b(0xc38),_0x1d978b(0x1272));}catch(_0xb7c0e0){console[_0x1d978b(0xb61)](_0x1d978b(0xba1),_0xb7c0e0),await _0x34fce8('导出失败',_0x1d978b(0x9c8)+_0xb7c0e0[_0x1d978b(0x7aa)]);try{const _0x31581e=_0x50727a[_0x1d978b(0x5f9)]();_0x31581e[_0x1d978b(0xfc)](_0xb7c0e0);}catch(_0x1ae93f){}}}async function _0x15d78b(){const _0x2b6bef=_0x204348;if(!window[_0x2b6bef(0xb9d)]){alert(_0x2b6bef(0x79b));return;}await _0x34fce8('正在准备...',_0x2b6bef(0x828));const _0x22da9b=streamSaver[_0x2b6bef(0x16e)](_0x2b6bef(0x7eb)+new Date()[_0x2b6bef(0xf63)]()[_0x2b6bef(0x90b)]('T')[0x0]+'.json'),_0x49e0c6=_0x22da9b[_0x2b6bef(0x5f9)](),_0x18a27a=new TextEncoder();try{await _0x49e0c6[_0x2b6bef(0x1374)](_0x18a27a[_0x2b6bef(0xedb)](_0x2b6bef(0xe6a)+Date[_0x2b6bef(0x606)]()+_0x2b6bef(0x1307)));const _0x3f958c=await _0x17d534['tables']['map'](_0x61d42f=>_0x61d42f[_0x2b6bef(0x132a)]);for(let _0x567a87=0x0;_0x567a87<_0x3f958c[_0x2b6bef(0x131d)];_0x567a87++){const _0x34a543=_0x3f958c[_0x567a87],_0x57d594=_0x17d534[_0x2b6bef(0xca3)](_0x34a543);await _0x49e0c6[_0x2b6bef(0x1374)](_0x18a27a[_0x2b6bef(0xedb)]('\x22'+_0x34a543+_0x2b6bef(0x2ca)));let _0x1b0e50=!![];await _0x57d594[_0x2b6bef(0x678)](_0x1e373c=>{const _0x23ce34=_0x2b6bef;!_0x1b0e50&&_0x49e0c6[_0x23ce34(0x1374)](_0x18a27a[_0x23ce34(0xedb)](',\x0a')),_0x49e0c6['write'](_0x18a27a[_0x23ce34(0xedb)](JSON['stringify'](_0x1e373c))),_0x1b0e50=![];}),await _0x49e0c6[_0x2b6bef(0x1374)](_0x18a27a[_0x2b6bef(0xedb)]('\x0a]')),_0x567a87<_0x3f958c['length']-0x1&&await _0x49e0c6[_0x2b6bef(0x1374)](_0x18a27a[_0x2b6bef(0xedb)](',\x0a'));}await _0x49e0c6[_0x2b6bef(0x1374)](_0x18a27a[_0x2b6bef(0xedb)](_0x2b6bef(0xf9e)));}catch(_0x28e611){console[_0x2b6bef(0xb61)](_0x2b6bef(0x721),_0x28e611),await _0x34fce8(_0x2b6bef(0x99b),'在写入文件流时发生错误:\x20'+_0x28e611[_0x2b6bef(0x7aa)]);}finally{await _0x49e0c6[_0x2b6bef(0x11c4)]();}}async function _0x6ceee0(){const _0x5656d9=_0x204348;await _0x34fce8(_0x5656d9(0x50d),'正在读取所有数据到内存中，请稍候...');try{const _0x4bb392={'version':0x3,'timestamp':Date[_0x5656d9(0x606)](),'data':{}},_0x529555=_0x17d534[_0x5656d9(0x275)][_0x5656d9(0xbf6)](_0x15cc8b=>_0x15cc8b[_0x5656d9(0x132a)]);for(const _0x50e336 of _0x529555){const _0x7b8089=await _0x17d534[_0x5656d9(0xca3)](_0x50e336)[_0x5656d9(0x511)]();_0x4bb392[_0x5656d9(0x76b)][_0x50e336]=_0x7b8089,console[_0x5656d9(0x7d1)](_0x5656d9(0x112d)+_0x50e336+_0x5656d9(0xb31)+_0x7b8089[_0x5656d9(0x131d)]);}const _0x1dc417=new Blob([JSON[_0x5656d9(0xc04)](_0x4bb392,null,0x2)],{'type':_0x5656d9(0xa0e)}),_0x32f181=URL[_0x5656d9(0x795)](_0x1dc417),_0x5d859b=document[_0x5656d9(0xe7d)]('a');_0x5d859b[_0x5656d9(0x1173)]=_0x32f181,_0x5d859b[_0x5656d9(0x3c5)]=_0x5656d9(0xa8d)+new Date()[_0x5656d9(0xf63)]()['split']('T')[0x0]+'.json',_0x5d859b[_0x5656d9(0x1122)](),URL[_0x5656d9(0x30c)](_0x32f181),await _0x34fce8(_0x5656d9(0x12d8),_0x5656d9(0x5af));}catch(_0x1517e2){console['error'](_0x5656d9(0x1bb),_0x1517e2),await _0x34fce8(_0x5656d9(0x99b),'发生了一个错误:\x20'+_0x1517e2['message']);}}function _0x3fa630(){const _0x4570d2=_0x204348,_0x4e0c34=Object[_0x4570d2(0x6eb)](_0x42f206['chats'])[_0x4570d2(0x1450)]((_0x221593,_0x4a56c4)=>{const _0x2719aa=_0x4570d2;if(_0x4a56c4['id']===_0x42f206[_0x2719aa(0x81d)])return _0x221593;return _0x221593+(_0x4a56c4[_0x2719aa(0x12c9)]||0x0);},0x0),_0x905653=_0x116b59||0x0,_0x2c796b=_0x4e0c34+_0x905653,_0x37dd9d=document[_0x4570d2(0x458)](_0x4570d2(0x10a6));if(!_0x37dd9d)return;let _0x5a81f6=_0x37dd9d[_0x4570d2(0x586)](_0x4570d2(0x1409));!_0x5a81f6&&(_0x5a81f6=document['createElement'](_0x4570d2(0xd0)),_0x5a81f6[_0x4570d2(0x69b)]='unread-indicator',_0x37dd9d[_0x4570d2(0x1079)](_0x5a81f6));let _0x52caa0=_0x37dd9d[_0x4570d2(0x586)](_0x4570d2(0xc7f));_0x52caa0&&_0x52caa0[_0x4570d2(0x1097)](),_0x2c796b>0x0?(_0x5a81f6[_0x4570d2(0x1a2)]=_0x2c796b>0x63?_0x4570d2(0x13cb):_0x2c796b,_0x5a81f6['style']['display']=_0x4570d2(0x1188),_0x5a81f6['style'][_0x4570d2(0x194)]='20',_0x5a81f6[_0x4570d2(0x1104)][_0x4570d2(0xb7e)]=_0x4570d2(0x4f0)):_0x5a81f6[_0x4570d2(0x1104)][_0x4570d2(0x4db)]='none';}async function _0x389642(_0x226284){const _0x7c1b77=_0x204348,_0x9ced51=_0x226284===_0x7c1b77(0xbff)?{'id':_0x7c1b77(0xbff),'name':_0x7c1b77(0x548)}:await _0x17d534[_0x7c1b77(0x140b)][_0x7c1b77(0x36d)](_0x226284);if(!_0x9ced51){console[_0x7c1b77(0xb61)](_0x7c1b77(0x5b6),_0x226284);return;}const _0x553b97=document[_0x7c1b77(0x458)](_0x7c1b77(0x1332)),_0x528a96=document['getElementById']('sticker-binding-chat-list'),_0x2c666e=_0x553b97[_0x7c1b77(0x586)]('.modal-header\x20span');_0x528a96['innerHTML']='',_0x2c666e[_0x7c1b77(0x1a2)]=_0x7c1b77(0x9a0)+_0x9ced51[_0x7c1b77(0x132a)]+_0x7c1b77(0xb8b);const _0x39330e=Object['values'](_0x42f206[_0x7c1b77(0x954)])[_0x7c1b77(0xc12)]((_0x11435b,_0x45c485)=>_0x11435b[_0x7c1b77(0x132a)][_0x7c1b77(0x667)](_0x45c485[_0x7c1b77(0x132a)],_0x7c1b77(0xaa2)));_0x39330e[_0x7c1b77(0x12c2)](_0x556ca2=>{const _0x2bdf3=_0x7c1b77,_0x559cb7=Array[_0x2bdf3(0x971)](_0x556ca2[_0x2bdf3(0xda2)]?.[_0x2bdf3(0x10d6)])&&_0x556ca2[_0x2bdf3(0xda2)][_0x2bdf3(0x10d6)][_0x2bdf3(0xd8d)](_0x226284),_0x247ad8=document['createElement'](_0x2bdf3(0x1323));_0x247ad8[_0x2bdf3(0x69b)]='contact-picker-item',_0x247ad8['innerHTML']=_0x2bdf3(0x12a2)+_0x556ca2['id']+'\x22\x20'+(_0x559cb7?_0x2bdf3(0x8f7):'')+_0x2bdf3(0xfd2)+(_0x556ca2[_0x2bdf3(0x726)]?_0x556ca2[_0x2bdf3(0xda2)][_0x2bdf3(0xaf7)]:_0x556ca2[_0x2bdf3(0xda2)][_0x2bdf3(0x9c7)]||_0x4fd084)+_0x2bdf3(0x10f0)+_0x556ca2[_0x2bdf3(0x132a)]+_0x2bdf3(0x106a),_0x528a96[_0x2bdf3(0x1079)](_0x247ad8);}),document['getElementById'](_0x7c1b77(0x5c2))[_0x7c1b77(0xbe8)]=()=>_0x5d9fc9(_0x226284),document['getElementById'](_0x7c1b77(0x9ee))[_0x7c1b77(0xbe8)]=()=>_0x553b97[_0x7c1b77(0x11c2)][_0x7c1b77(0x1097)](_0x7c1b77(0x67d)),_0x553b97[_0x7c1b77(0x11c2)][_0x7c1b77(0xa58)](_0x7c1b77(0x67d));}async function _0x5d9fc9(_0x114451){const _0x4f602e=_0x204348,_0x5d3a00=new Set(Array['from'](document[_0x4f602e(0x102a)](_0x4f602e(0xdd0)))[_0x4f602e(0xbf6)](_0x4d92bc=>_0x4d92bc[_0x4f602e(0x1f4)][_0x4f602e(0xfca)])),_0x30449e=[];for(const _0x30ca79 in _0x42f206[_0x4f602e(0x954)]){const _0x119bd1=_0x42f206[_0x4f602e(0x954)][_0x30ca79];!Array[_0x4f602e(0x971)](_0x119bd1[_0x4f602e(0xda2)]['stickerCategoryIds'])&&(_0x119bd1[_0x4f602e(0xda2)][_0x4f602e(0x10d6)]=[]);const _0x2b0dd0=_0x119bd1[_0x4f602e(0xda2)]['stickerCategoryIds']['includes'](_0x114451),_0xb4647e=_0x5d3a00[_0x4f602e(0x31c)](_0x30ca79);if(_0x2b0dd0&&!_0xb4647e)_0x119bd1[_0x4f602e(0xda2)]['stickerCategoryIds']=_0x119bd1['settings'][_0x4f602e(0x10d6)][_0x4f602e(0xaf1)](_0x56ef3d=>_0x56ef3d!==_0x114451),_0x30449e['push'](_0x119bd1);else!_0x2b0dd0&&_0xb4647e&&(_0x119bd1[_0x4f602e(0xda2)]['stickerCategoryIds']['push'](_0x114451),_0x30449e[_0x4f602e(0x129e)](_0x119bd1));}_0x30449e[_0x4f602e(0x131d)]>0x0&&(await _0x17d534[_0x4f602e(0x954)][_0x4f602e(0x5b9)](_0x30449e),await _0x34fce8('保存成功','表情包分类绑定已更新！')),document[_0x4f602e(0x458)]('sticker-binding-modal')['classList'][_0x4f602e(0x1097)]('visible');}function _0x18518f(_0x56c55c){const _0x25f306=_0x204348;if(!_0x56c55c||!_0x56c55c[_0x25f306(0xda2)][_0x25f306(0x10d6)]||_0x56c55c[_0x25f306(0xda2)][_0x25f306(0x10d6)][_0x25f306(0x131d)]===0x0)return'';const _0x415823=_0x56c55c[_0x25f306(0xda2)][_0x25f306(0x10d6)];let _0x45688b=[];const _0x193cc3=new Set();_0x415823['forEach'](_0x235688=>{const _0xdb1216=_0x25f306;let _0x30af89;_0x235688==='uncategorized'?_0x30af89=_0x42f206[_0xdb1216(0x1294)][_0xdb1216(0xaf1)](_0x2ecf36=>!_0x2ecf36[_0xdb1216(0x5f7)]):_0x30af89=_0x42f206['userStickers'][_0xdb1216(0xaf1)](_0x1dbb64=>_0x1dbb64['categoryId']===_0x235688),_0x30af89['forEach'](_0x2a4123=>{const _0x380a3c=_0xdb1216;!_0x193cc3[_0x380a3c(0x31c)](_0x2a4123[_0x380a3c(0x132a)])&&(_0x45688b[_0x380a3c(0x129e)](_0x2a4123),_0x193cc3[_0x380a3c(0xa58)](_0x2a4123['name']));});});if(_0x45688b[_0x25f306(0x131d)]===0x0)return'';const _0x3ed017=_0x45688b[_0x25f306(0xbf6)](_0x169d22=>'-\x20'+_0x169d22[_0x25f306(0x132a)])[_0x25f306(0x56c)]('\x0a');return'\x0a#\x20可用表情包\x20(优先使用)\x0a-\x20请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a'+_0x3ed017+'\x0a';}function _0x386294(_0x56d5f8){const _0x1d3c21=_0x204348;if(!_0x56d5f8||!_0x56d5f8[_0x1d3c21(0x726)])return'';let _0x2befda=_0x1d3c21(0x4c6),_0x53d89c=![];return _0x56d5f8[_0x1d3c21(0xfa8)][_0x1d3c21(0x12c2)](_0x4ffea0=>{const _0x39f593=_0x1d3c21;if(_0x4ffea0['id']===_0x39f593(0xf86))return;const _0x4859e6=_0x42f206['chats'][_0x4ffea0['id']];if(_0x4859e6&&_0x4859e6[_0x39f593(0xda2)][_0x39f593(0x10d6)]&&_0x4859e6[_0x39f593(0xda2)]['stickerCategoryIds'][_0x39f593(0x131d)]>0x0){const _0x19b320=_0x4859e6['settings']['stickerCategoryIds'];let _0x1e3cab=[];const _0x530c74=new Set();_0x19b320['forEach'](_0x52ca74=>{const _0x110d6f=_0x39f593;let _0x13f4f1;_0x52ca74===_0x110d6f(0xbff)?_0x13f4f1=_0x42f206['userStickers'][_0x110d6f(0xaf1)](_0x47bb1f=>!_0x47bb1f[_0x110d6f(0x5f7)]):_0x13f4f1=_0x42f206[_0x110d6f(0x1294)][_0x110d6f(0xaf1)](_0x319d6b=>_0x319d6b['categoryId']===_0x52ca74),_0x13f4f1[_0x110d6f(0x12c2)](_0x4d77a9=>{const _0x5aacc8=_0x110d6f;!_0x530c74[_0x5aacc8(0x31c)](_0x4d77a9['name'])&&(_0x1e3cab[_0x5aacc8(0x129e)](_0x4d77a9),_0x530c74[_0x5aacc8(0xa58)](_0x4d77a9[_0x5aacc8(0x132a)]));});}),_0x1e3cab['length']>0x0&&(_0x53d89c=!![],_0x2befda+=_0x39f593(0xb7a)+_0x4ffea0[_0x39f593(0x1118)]+'\x20(本名:\x20'+_0x4ffea0[_0x39f593(0xa1)]+_0x39f593(0xc22),_0x2befda+=_0x1e3cab[_0x39f593(0xbf6)](_0xc10e16=>'-\x20'+_0xc10e16['name'])['join']('\x0a'));}}),_0x53d89c?_0x2befda:'';}function _0x224cd5(_0x44a349){const _0x5623be=_0x204348;if(!_0x44a349)return 0x0;return Math[_0x5623be(0xec8)](_0x44a349[_0x5623be(0x131d)]/1.5);}async function _0x3c8cf3(){const _0x30f7b5=_0x204348;if(!_0x42f206['activeChatId'])return 0x0;const _0x217dd0=_0x42f206[_0x30f7b5(0x954)][_0x42f206[_0x30f7b5(0x81d)]];if(!_0x217dd0)return 0x0;const _0x2ee873=parseInt(document[_0x30f7b5(0x458)](_0x30f7b5(0x13f7))[_0x30f7b5(0x8dd)])||0xa,_0x117d16=parseInt(document[_0x30f7b5(0x458)]('linked-memory-count')['value'])||0xa,_0x4c189d=document[_0x30f7b5(0x458)](_0x30f7b5(0xcfb))[_0x30f7b5(0x8f7)],_0x257c39=document[_0x30f7b5(0x458)](_0x30f7b5(0xd54))[_0x30f7b5(0x8dd)],_0x9cf5fb=document['getElementById'](_0x30f7b5(0x1349))[_0x30f7b5(0x8dd)];let _0x191c23='';const _0x2868a9=Array[_0x30f7b5(0xca2)](document[_0x30f7b5(0x102a)](_0x30f7b5(0x89a)))['map'](_0x381d57=>_0x381d57[_0x30f7b5(0x8dd)]['replace'](_0x30f7b5(0x549),''));if(_0x2868a9[_0x30f7b5(0x131d)]>0x0){const _0x12fd5d=_0x2868a9[_0x30f7b5(0xbf6)](_0x32d853=>{const _0x56073f=_0x30f7b5,_0x1dd798=_0x42f206['worldBooks'][_0x56073f(0xb07)](_0x88db9b=>_0x88db9b['id']===_0x32d853);if(!_0x1dd798||!Array[_0x56073f(0x971)](_0x1dd798[_0x56073f(0x1316)]))return'';return _0x1dd798[_0x56073f(0x1316)]['filter'](_0x20be65=>_0x20be65[_0x56073f(0x12fb)]!==![])['map'](_0xb37c5d=>_0xb37c5d['content'])[_0x56073f(0x56c)]('\x0a');})[_0x30f7b5(0xaf1)](Boolean)[_0x30f7b5(0x56c)]('\x0a');_0x191c23+=_0x12fd5d;}_0x217dd0['longTermMemory']&&_0x217dd0[_0x30f7b5(0x94a)][_0x30f7b5(0x131d)]>0x0&&(_0x191c23+=_0x217dd0[_0x30f7b5(0x94a)][_0x30f7b5(0xbf6)](_0x24e446=>_0x24e446[_0x30f7b5(0x1316)])['join']('\x0a'));const _0x8e9db1=document[_0x30f7b5(0x458)](_0x30f7b5(0x1468))[_0x30f7b5(0x8f7)];if(_0x8e9db1){const _0x5f327b=Array[_0x30f7b5(0xca2)](document[_0x30f7b5(0x102a)]('#linked-chats-checkboxes-container\x20input:checked'))[_0x30f7b5(0xbf6)](_0x1d8b73=>_0x1d8b73[_0x30f7b5(0x8dd)]);for(const _0x40c96b of _0x5f327b){const _0x258242=_0x42f206[_0x30f7b5(0x954)][_0x40c96b];_0x258242&&_0x258242[_0x30f7b5(0x1d5)][_0x30f7b5(0x131d)]>0x0&&(_0x191c23+=_0x258242[_0x30f7b5(0x1d5)][_0x30f7b5(0x5b0)](-_0x117d16)[_0x30f7b5(0xbf6)](_0x340543=>String(_0x340543['content']))['join']('\x0a'));}}_0x217dd0[_0x30f7b5(0x726)]?_0x217dd0[_0x30f7b5(0xfa8)][_0x30f7b5(0x12c2)](_0x2b62b2=>{const _0x466939=_0x30f7b5;_0x191c23+=_0x2b62b2[_0x466939(0x124d)];}):_0x191c23+=_0x257c39;_0x191c23+=_0x9cf5fb,_0x191c23+=_0x18518f(_0x217dd0);_0x217dd0[_0x30f7b5(0x726)]&&(_0x191c23+=_0x386294(_0x217dd0));if(!_0x217dd0[_0x30f7b5(0x726)]&&_0x4c189d){const _0x297c66=document[_0x30f7b5(0x458)](_0x30f7b5(0xf00))[_0x30f7b5(0x8dd)];if(_0x297c66){const _0x3d0fe6=_0x42f206[_0x30f7b5(0x843)][_0x30f7b5(0xb07)](_0x5a436c=>_0x5a436c['id']===_0x297c66);_0x3d0fe6&&(_0x191c23+=_0x3d0fe6[_0x30f7b5(0x1316)][_0x30f7b5(0xaf1)](_0x43895f=>_0x43895f[_0x30f7b5(0x12fb)]!==![])[_0x30f7b5(0xbf6)](_0x142411=>_0x142411[_0x30f7b5(0x1316)])[_0x30f7b5(0x56c)]('\x0a'));}}const _0x391842=_0x217dd0['history'][_0x30f7b5(0x5b0)](-_0x2ee873);return _0x191c23+=_0x391842[_0x30f7b5(0xbf6)](_0x19d433=>{const _0x5a9c13=_0x30f7b5;if(typeof _0x19d433[_0x5a9c13(0x1316)]===_0x5a9c13(0x861))return _0x19d433[_0x5a9c13(0x1316)];if(Array['isArray'](_0x19d433[_0x5a9c13(0x1316)]))return _0x19d433[_0x5a9c13(0x1316)][_0x5a9c13(0xbf6)](_0x158c38=>_0x158c38['text'])['join']('\x20');return'';})['join']('\x0a'),_0x224cd5(_0x191c23);}const _0xd65be6=_0x341c49(async()=>{const _0x4956b1=_0x204348,_0x116953=document[_0x4956b1(0x458)](_0x4956b1(0x11e7));if(!_0x116953)return;_0x116953[_0x4956b1(0x110d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>正在计算...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22>--</span>\x0a\x20\x20\x20\x20';try{const _0x12dfef=await _0x3c8cf3();_0x116953[_0x4956b1(0x110d)]=_0x4956b1(0xebd)+_0x12dfef+_0x4956b1(0xe26);}catch(_0x5a7ba1){console[_0x4956b1(0xb61)]('Token\x20calculation\x20error:',_0x5a7ba1),_0x116953[_0x4956b1(0x110d)]=_0x4956b1(0x1273);}},0x12c);async function _0x2b8248(){const _0x8b4ffe=_0x204348,_0x2476d9=document['getElementById'](_0x8b4ffe(0x6f6));_0x2476d9[_0x8b4ffe(0x110d)]='',_0x401c8c=[],_0x597e2e=0x0,_0x452dba=![];const _0x1ee4d8=[];try{const _0x2161e5=await _0x17d534[_0x8b4ffe(0x954)][_0x8b4ffe(0x511)]();for(const _0x4c4f2d of _0x2161e5){_0x4c4f2d[_0x8b4ffe(0x1d5)]&&_0x4c4f2d['history'][_0x8b4ffe(0x131d)]>0x0&&_0x4c4f2d[_0x8b4ffe(0x1d5)][_0x8b4ffe(0x12c2)](_0x55a2b5=>{const _0x50bb06=_0x8b4ffe;_0x55a2b5[_0x50bb06(0x259)]===_0x50bb06(0xb62)&&_0x55a2b5[_0x50bb06(0x2cc)]&&_0x1ee4d8['push']({'sourceType':'chat','imageUrl':_0x55a2b5[_0x50bb06(0x2cc)],'prompt':_0x55a2b5[_0x50bb06(0xb55)]||_0x55a2b5[_0x50bb06(0x367)]||_0x50bb06(0x1051),'chatId':_0x4c4f2d['id'],'msgTimestamp':_0x55a2b5[_0x50bb06(0xf16)]});});}}catch(_0x2c3a85){console['error'](_0x8b4ffe(0x829),_0x2c3a85);}try{const _0x3344d3=await _0x17d534[_0x8b4ffe(0x15b)][_0x8b4ffe(0x511)]();_0x3344d3[_0x8b4ffe(0x12c2)](_0x4287f1=>{const _0x54ba34=_0x8b4ffe;if(_0x4287f1[_0x54ba34(0x259)]==='naiimag'){const _0x5e28da=_0x4287f1[_0x54ba34(0x1277)]||(_0x4287f1[_0x54ba34(0x2cc)]?[_0x4287f1[_0x54ba34(0x2cc)]]:[]),_0x3ff3f3=Array['isArray'](_0x4287f1['prompt'])?_0x4287f1[_0x54ba34(0xb55)]:[_0x4287f1[_0x54ba34(0xb55)]||_0x54ba34(0x1051)];_0x5e28da[_0x54ba34(0x12c2)]((_0x35f164,_0xd22da4)=>{const _0x31f5e1=_0x54ba34;_0x1ee4d8['push']({'sourceType':_0x31f5e1(0xdbd),'imageUrl':_0x35f164,'prompt':_0x3ff3f3[_0xd22da4]||_0x3ff3f3[0x0],'postId':_0x4287f1['id'],'imageIndex':_0xd22da4});});}});}catch(_0x194ca5){console[_0x8b4ffe(0xb61)](_0x8b4ffe(0xa78),_0x194ca5);}_0x401c8c=_0x1ee4d8[_0x8b4ffe(0xc12)]((_0x4cbdb3,_0x141625)=>(_0x141625[_0x8b4ffe(0x9a)]||_0x141625[_0x8b4ffe(0x13bc)]||0x0)-(_0x4cbdb3[_0x8b4ffe(0x9a)]||_0x4cbdb3['postId']||0x0)),_0x401c8c[_0x8b4ffe(0x131d)]===0x0?_0x2476d9[_0x8b4ffe(0x110d)]=_0x8b4ffe(0x10a8):_0x65a796(),document[_0x8b4ffe(0x458)](_0x8b4ffe(0x12cf))['classList'][_0x8b4ffe(0xa58)](_0x8b4ffe(0x67d));}function _0x449cfc(_0x160ef9){const _0x341f2e=_0x204348,_0x4c1fb5=document[_0x341f2e(0x458)](_0x341f2e(0x6f6));if(_0x160ef9['length']===0x0&&_0x597e2e===0x0){_0x4c1fb5['innerHTML']=_0x341f2e(0x10a8);return;}const _0x518281=document[_0x341f2e(0xdb7)]();_0x160ef9['forEach']((_0x1ebfbc,_0x3907a7)=>{const _0x510377=_0x341f2e,_0x36ea4c=document[_0x510377(0xe7d)]('div');_0x36ea4c[_0x510377(0x69b)]=_0x510377(0x9ca),_0x36ea4c[_0x510377(0x316)]=_0x1ebfbc['prompt'];const _0x400dfb=_0x1ebfbc['sourceType']+'_'+(_0x1ebfbc['chatId']||_0x1ebfbc[_0x510377(0x13bc)])+'_'+(_0x1ebfbc[_0x510377(0x9a)]||_0x1ebfbc[_0x510377(0x10eb)]);_0x36ea4c['dataset'][_0x510377(0x1278)]=_0x400dfb,_0x36ea4c[_0x510377(0x1f4)][_0x510377(0x2cc)]=_0x1ebfbc['imageUrl'],_0x36ea4c['dataset'][_0x510377(0xb55)]=_0x1ebfbc[_0x510377(0xb55)],_0x36ea4c['innerHTML']=_0x510377(0x660)+_0x1ebfbc['imageUrl']+_0x510377(0xa51)+_0x1ebfbc[_0x510377(0xb55)]+_0x510377(0x106a),_0x518281[_0x510377(0x1079)](_0x36ea4c);}),_0x4c1fb5[_0x341f2e(0x1079)](_0x518281);}async function _0x65a796(){const _0x2aedfd=_0x204348;if(_0x452dba||_0x597e2e>=_0x401c8c[_0x2aedfd(0x131d)])return;_0x452dba=!![];const _0x354c68=document[_0x2aedfd(0x458)]('nai-gallery-grid');_0x4c8ce6(_0x354c68,_0x2aedfd(0x151)),setTimeout(()=>{const _0x31fb88=_0x2aedfd,_0x5bd817=_0x401c8c[_0x31fb88(0x5b0)](_0x597e2e,_0x597e2e+_0x4a8451);_0x17adee(_0x354c68),_0x5bd817['length']>0x0&&(_0x449cfc(_0x5bd817),_0x597e2e+=_0x5bd817[_0x31fb88(0x131d)]),_0x452dba=![];},0x1f4);}function _0x11fd97(){const _0x1859fc=_0x204348;_0x51e922=!_0x51e922;const _0x13e362=document[_0x1859fc(0x458)](_0x1859fc(0x6f6)),_0x2902ca=document[_0x1859fc(0x458)](_0x1859fc(0x2cb)),_0x272fba=document[_0x1859fc(0x458)](_0x1859fc(0xd7e)),_0x1e9038=document[_0x1859fc(0x458)](_0x1859fc(0x323));_0x13e362[_0x1859fc(0x11c2)][_0x1859fc(0x1270)](_0x1859fc(0x833),_0x51e922),_0x51e922?(_0x2902ca[_0x1859fc(0x1a2)]='完成',_0x272fba[_0x1859fc(0x1104)]['display']=_0x1859fc(0x82b),_0x905915[_0x1859fc(0x415)](),_0x1e9038['checked']=![],_0x5134c2()):(_0x2902ca['textContent']='管理',_0x272fba['style'][_0x1859fc(0x4db)]=_0x1859fc(0x464),_0x13e362[_0x1859fc(0x102a)](_0x1859fc(0xc66))[_0x1859fc(0x12c2)](_0x55468d=>_0x55468d[_0x1859fc(0x11c2)][_0x1859fc(0x1097)](_0x1859fc(0x500))));}function _0x5134c2(){const _0xca9f6=_0x204348,_0xcca863=document[_0xca9f6(0x458)](_0xca9f6(0xf79)),_0x30fc65=document[_0xca9f6(0x458)](_0xca9f6(0x2be)),_0x2d1dcc=_0x905915[_0xca9f6(0x12a4)];if(_0xcca863)_0xcca863['textContent']='删除\x20('+_0x2d1dcc+')';if(_0x30fc65)_0x30fc65[_0xca9f6(0x1a2)]=_0xca9f6(0xc6a)+_0x2d1dcc+')';}function _0x59938e(_0xf28943){const _0x4381ac=_0x204348,_0x42baef=_0xf28943[_0x4381ac(0x12df)]['closest'](_0x4381ac(0x24c));if(!_0x42baef)return;const _0x4a963a=_0x42baef[_0x4381ac(0x1f4)][_0x4381ac(0x1278)],_0x5bf157=_0x42baef[_0x4381ac(0x1f4)][_0x4381ac(0x2cc)],_0x4bb41a=_0x42baef[_0x4381ac(0x1f4)]['prompt'];if(_0xf28943[_0x4381ac(0x12df)][_0x4381ac(0xe87)](_0x4381ac(0x1284))){_0xf28943['stopPropagation'](),_0x213dd5(_0x5bf157,_0x4bb41a);return;}if(_0xf28943[_0x4381ac(0x12df)]['closest']('.nai-gallery-delete-btn')){_0xf28943[_0x4381ac(0x58e)](),_0xb8ff03(new Set([_0x4a963a]));return;}if(_0x51e922)_0x42baef['classList'][_0x4381ac(0x1270)](_0x4381ac(0x500)),_0x905915['has'](_0x4a963a)?_0x905915[_0x4381ac(0x195)](_0x4a963a):_0x905915[_0x4381ac(0xa58)](_0x4a963a),_0x5134c2();else{const _0xde8b6a=_0x4381ac(0x77a),_0x258c3d=_0x4381ac(0xd16)+_0x5bf157+'\x22\x20style=\x22max-width:\x20100%;\x20border-radius:\x208px;\x20box-shadow:\x200\x204px\x2010px\x20rgba(0,0,0,0.1);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x34fce8(_0xde8b6a,_0x258c3d);}}async function _0x49ce6f(){const _0x213ded=_0x204348,_0x39734c=_0x905915;if(_0x39734c[_0x213ded(0x12a4)]===0x0){alert(_0x213ded(0x12d7));return;}if(typeof JSZip===_0x213ded(0x37c)||!window[_0x213ded(0xb9d)]){await _0x34fce8(_0x213ded(0x712),_0x213ded(0x13c1));return;}await _0x34fce8(_0x213ded(0x12b9),_0x213ded(0xb87)+_0x39734c['size']+_0x213ded(0x141b));const _0x54beb0=new JSZip();let _0x2db45f=0x0;const _0x528c86=[];_0x39734c[_0x213ded(0x12c2)](_0x598158=>{const _0x18922c=_0x213ded,_0x42b3f1=document[_0x18922c(0x586)](_0x18922c(0x56f)+_0x598158+'\x22]');if(!_0x42b3f1)return;const _0xd2b39=_0x42b3f1[_0x18922c(0x1f4)][_0x18922c(0x2cc)],_0x31172e=_0x42b3f1['dataset'][_0x18922c(0xb55)],_0x24e694=_0x3fcb02(_0x31172e),_0x27df64=((async()=>{const _0x59f2fc=_0x18922c;try{let _0x53e622;if(_0xd2b39['startsWith'](_0x59f2fc(0xbe7))){const _0x2b24bc=await fetch(_0xd2b39);_0x53e622=await _0x2b24bc['blob']();}else{let _0x3bad34;try{_0x3bad34=await fetch(_0xd2b39,{'mode':_0x59f2fc(0xf1)});if(!_0x3bad34['ok'])throw new Error(_0x59f2fc(0x83a));}catch(_0x7d5c0b){console[_0x59f2fc(0x1b6)](_0x59f2fc(0x88b),_0x7d5c0b[_0x59f2fc(0x7aa)]);const _0x316bd9=_0xb80e9();let _0x435943=_0x316bd9[_0x59f2fc(0x413)]==='custom'?_0x316bd9['custom_proxy_url']:_0x316bd9[_0x59f2fc(0x413)];if(!_0x435943||_0x435943==='')_0x435943=_0x59f2fc(0x11ee);const _0x28963f=_0x435943+encodeURIComponent(_0xd2b39);_0x3bad34=await fetch(_0x28963f);}if(!_0x3bad34['ok'])throw new Error('Fetch\x20failed:\x20'+_0x3bad34[_0x59f2fc(0x13b2)]);_0x53e622=await _0x3bad34[_0x59f2fc(0x43d)]();}_0x54beb0['file'](_0x24e694,_0x53e622,{'binary':!![]});}catch(_0x5464b3){console[_0x59f2fc(0xb61)](_0x59f2fc(0x10d1)+_0xd2b39,_0x5464b3),_0x2db45f++;}})());_0x528c86['push'](_0x27df64);}),await Promise[_0x213ded(0xfe2)](_0x528c86);if(_0x2db45f===_0x39734c[_0x213ded(0x12a4)]){await _0x34fce8(_0x213ded(0x712),_0x213ded(0x6e6));return;}await _0x34fce8(_0x213ded(0x6a7),_0x213ded(0x115d));try{const _0x1eb76e=streamSaver[_0x213ded(0x16e)](_0x213ded(0x378)+Date[_0x213ded(0x606)]()+_0x213ded(0x84a)),_0x271ba5=_0x54beb0[_0x213ded(0x578)]({'type':_0x213ded(0x43d),'streamFiles':!![]}),_0x199390=new ReadableStream({'start'(_0x3643e4){const _0x39fa58=_0x213ded;_0x271ba5['on'](_0x39fa58(0x76b),_0x43622f=>{const _0x12eb02=_0x39fa58;_0x3643e4[_0x12eb02(0x165)](_0x43622f);})['on'](_0x39fa58(0xf19),()=>{const _0x403300=_0x39fa58;console[_0x403300(0x7d1)]('ZIP\x20流生成完毕。'),_0x3643e4[_0x403300(0x11c4)]();})['on'](_0x39fa58(0xb61),_0x5e847d=>{const _0x3576c2=_0x39fa58;console[_0x3576c2(0xb61)]('JSZip\x20流错误:',_0x5e847d),_0x3643e4[_0x3576c2(0xb61)](_0x5e847d);})[_0x39fa58(0x1366)]();}});await _0x199390[_0x213ded(0x49a)](_0x1eb76e),_0x2db45f>0x0&&_0x34fce8(_0x213ded(0xc5c),_0x213ded(0x9d)+(_0x39734c[_0x213ded(0x12a4)]-_0x2db45f)+_0x213ded(0x1252)+_0x2db45f+_0x213ded(0x5f0));}catch(_0x6a7477){console['error'](_0x213ded(0xa0b),_0x6a7477),await _0x34fce8('流式下载失败',_0x213ded(0x114f)+_0x6a7477[_0x213ded(0x7aa)]);}}async function _0xb8ff03(_0x2934ca=null){const _0x5d62d2=_0x204348,_0x110a84=_0x2934ca||_0x905915;if(_0x110a84[_0x5d62d2(0x12a4)]===0x0)return;const _0x32293a=await _0x2532b9(_0x5d62d2(0x1ef),_0x5d62d2(0x139d)+_0x110a84[_0x5d62d2(0x12a4)]+_0x5d62d2(0x2ce),{'confirmButtonClass':'btn-danger'});if(!_0x32293a)return;await _0x34fce8(_0x5d62d2(0x12b9),_0x5d62d2(0x662));let _0x4406d3=0x0;const _0x5110a2=new Map(),_0x5c1556=new Set(),_0x3e79b7=new Map(),_0x234773=new Set();for(const _0x55b7a0 of _0x110a84){if(_0x55b7a0['startsWith'](_0x5d62d2(0xb80))){const _0x5a0971=_0x55b7a0[_0x5d62d2(0x90b)]('_'),_0x5d726c=parseInt(_0x5a0971[0x1]);!isNaN(_0x5d726c)&&_0x234773[_0x5d62d2(0xa58)](_0x5d726c);}}const _0x40da2b=new Map();if(_0x234773[_0x5d62d2(0x12a4)]>0x0){const _0x142896=await _0x17d534[_0x5d62d2(0x15b)][_0x5d62d2(0x13c6)]('id')[_0x5d62d2(0xfd3)](Array[_0x5d62d2(0xca2)](_0x234773))['toArray']();_0x142896[_0x5d62d2(0x12c2)](_0x4c6c45=>_0x40da2b['set'](_0x4c6c45['id'],_0x4c6c45));}for(const _0xba74d1 of _0x110a84){const _0x89c20c=_0xba74d1[_0x5d62d2(0x90b)]('_');if(_0x89c20c[_0x5d62d2(0x131d)]<0x3){console['warn']('跳过格式错误的NAI图片Key:',_0xba74d1);continue;}const _0x1a1c09=_0x89c20c[0x0],_0x30bdeb=_0x89c20c[_0x5d62d2(0xdd4)](),_0x1b579b=_0x89c20c['slice'](0x1)['join']('_');if(_0x1a1c09===_0x5d62d2(0x10f6)){const _0x494e16=_0x1b579b,_0x3a4ee0=parseInt(_0x30bdeb);if(!_0x5110a2[_0x5d62d2(0x31c)](_0x494e16)){const _0x33c210=await _0x17d534['chats'][_0x5d62d2(0x36d)](_0x494e16);if(_0x33c210)_0x5110a2[_0x5d62d2(0xe71)](_0x494e16,_0x33c210);else{console[_0x5d62d2(0x1b6)](_0x5d62d2(0x1385)+_0x494e16+_0x5d62d2(0x20d));continue;}}const _0xd1004c=_0x5110a2[_0x5d62d2(0x36d)](_0x494e16);if(_0xd1004c&&_0xd1004c[_0x5d62d2(0x1d5)]){const _0x1d32b3=_0xd1004c[_0x5d62d2(0x1d5)][_0x5d62d2(0x131d)];_0xd1004c['history']=_0xd1004c[_0x5d62d2(0x1d5)][_0x5d62d2(0xaf1)](_0x3e0dfd=>_0x3e0dfd[_0x5d62d2(0xf16)]!==_0x3a4ee0),_0xd1004c['history'][_0x5d62d2(0x131d)]<_0x1d32b3&&(_0x4406d3++,_0x5110a2[_0x5d62d2(0xe71)](_0x494e16,_0xd1004c));}}else{if(_0x1a1c09===_0x5d62d2(0xdbd)){const _0x1a9190=parseInt(_0x1b579b),_0x344876=parseInt(_0x30bdeb),_0xe98ddb=_0x3e79b7['get'](_0x1a9190)||_0x40da2b['get'](_0x1a9190);if(!_0xe98ddb){console[_0x5d62d2(0x1b6)](_0x5d62d2(0x14b)+_0x1a9190+_0x5d62d2(0x20d));continue;}const _0x2d8326=_0xe98ddb['imageUrls']||(_0xe98ddb['imageUrl']?[_0xe98ddb[_0x5d62d2(0x2cc)]]:[]);if(_0x2d8326[_0x5d62d2(0x131d)]<=0x1)_0x5c1556[_0x5d62d2(0xa58)](_0x1a9190),_0x3e79b7[_0x5d62d2(0x31c)](_0x1a9190)&&_0x3e79b7[_0x5d62d2(0x195)](_0x1a9190);else{const _0x4fe47c=_0x2d8326[_0x344876];_0xe98ddb['imageUrls']=_0xe98ddb['imageUrls']['filter'](_0x51312b=>_0x51312b!==_0x4fe47c),_0xe98ddb[_0x5d62d2(0xb55)]&&Array['isArray'](_0xe98ddb[_0x5d62d2(0xb55)])&&_0xe98ddb['prompt'][_0x344876]&&_0xe98ddb[_0x5d62d2(0xb55)]['splice'](_0x344876,0x1),_0xe98ddb[_0x5d62d2(0x2cc)]=_0xe98ddb[_0x5d62d2(0x1277)][0x0]||null,_0x3e79b7['set'](_0x1a9190,_0xe98ddb);}_0x4406d3++;}}}try{await _0x17d534[_0x5d62d2(0x9a7)]('rw',_0x17d534['chats'],_0x17d534['qzonePosts'],async()=>{const _0x2d36e0=_0x5d62d2;_0x5110a2[_0x2d36e0(0x12a4)]>0x0&&await _0x17d534['chats']['bulkPut'](Array['from'](_0x5110a2[_0x2d36e0(0x6eb)]())),_0x3e79b7[_0x2d36e0(0x12a4)]>0x0&&await _0x17d534[_0x2d36e0(0x15b)][_0x2d36e0(0x5b9)](Array[_0x2d36e0(0xca2)](_0x3e79b7['values']())),_0x5c1556[_0x2d36e0(0x12a4)]>0x0&&await _0x17d534['qzonePosts']['bulkDelete'](Array['from'](_0x5c1556));}),_0x11fd97(),await _0x2b8248(),await _0x34fce8(_0x5d62d2(0xa59),_0x5d62d2(0x142a)+_0x4406d3+_0x5d62d2(0xdc0)),document[_0x5d62d2(0x458)](_0x5d62d2(0xd99))[_0x5d62d2(0x11c2)]['contains'](_0x5d62d2(0xfe1))&&_0x359c96(_0x42f206[_0x5d62d2(0x81d)]),document[_0x5d62d2(0x458)]('qzone-screen')['classList'][_0x5d62d2(0x526)]('active')&&_0x316550();}catch(_0xc3d352){console[_0x5d62d2(0xb61)]('批量删除NAI图片时出错:',_0xc3d352),await _0x34fce8(_0x5d62d2(0xc8d),'操作失败:\x20'+_0xc3d352[_0x5d62d2(0x7aa)]);}}function _0x3fcb02(_0x881270){const _0x207f1b=_0x204348,_0x1d8dc7=_0x881270||'NAI_Image';let _0x563c2b=_0x1d8dc7[_0x207f1b(0x33b)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')[_0x207f1b(0x33b)](/\s+/g,'_')[_0x207f1b(0xa6d)](0x0,0x1e);!_0x563c2b&&(_0x563c2b=_0x207f1b(0x1140));const _0x5a88f6=new Date()[_0x207f1b(0xf63)]()[_0x207f1b(0x33b)](/[-:]/g,'')[_0x207f1b(0x33b)]('T','_')[_0x207f1b(0x90b)]('.')[0x0];return _0x563c2b+'_'+_0x5a88f6+_0x207f1b(0x1224);}async function _0x261798(){const _0x5897a1=_0x204348;initLanguage();async function _0x13994d(_0x2a2d12){const _0x269327=_0x1a5b;if(!_0x2a2d12)return;try{const _0x2b5dc0=await _0x2a2d12[_0x269327(0xdd5)](),_0xc2b03=JSON[_0x269327(0x44c)](_0x2b5dc0);if(_0xc2b03[_0x269327(0x259)]===_0x269327(0x9b6))console[_0x269327(0x7d1)](_0x269327(0x4e3)),await _0x25bf0a(_0xc2b03);else{if(_0xc2b03[_0x269327(0x1309)]&&typeof _0xc2b03['entries']===_0x269327(0x620))console[_0x269327(0x7d1)]('检测到\x20Tavern\x20AI\x20世界书文件，执行兼容导入...'),await _0x12bd3d(_0xc2b03,_0x2a2d12[_0x269327(0x132a)]);else throw new Error(_0x269327(0x173));}}catch(_0x5d2b4e){console[_0x269327(0xb61)](_0x269327(0xa48),_0x5d2b4e),await _0x34fce8(_0x269327(0xfc4),_0x269327(0x20e)+_0x5d2b4e['message']);}}async function _0x12bd3d(_0x10744c,_0x577b58){const _0x261953=_0x1a5b,_0x246a47=_0x577b58[_0x261953(0x33b)](/\.json$/i,''),_0x33fca3=await _0x335e57(_0x261953(0xb1b),'请为这本设定集命名：',_0x246a47);if(!_0x33fca3||!_0x33fca3[_0x261953(0x2aa)]()){alert(_0x261953(0x8de));return;}const _0x4313c0=Object[_0x261953(0x6eb)](_0x10744c['entries'])['map'](_0x3b499b=>{const _0x210891=_0x261953;return{'keys':_0x3b499b[_0x210891(0x1278)]||[],'comment':_0x3b499b[_0x210891(0xcb4)]||_0x210891(0xfdc),'content':_0x3b499b[_0x210891(0x1316)]||'','enabled':!_0x3b499b[_0x210891(0xa28)]};})['filter'](_0x32e60d=>_0x32e60d['content']);if(_0x4313c0[_0x261953(0x131d)]===0x0){alert(_0x261953(0xba6));return;}const _0x4ae26f={'id':'wb_'+Date[_0x261953(0x606)](),'name':_0x33fca3[_0x261953(0x2aa)](),'content':_0x4313c0,'categoryId':null};await _0x17d534[_0x261953(0xab7)][_0x261953(0xa58)](_0x4ae26f),_0x42f206['worldBooks'][_0x261953(0x129e)](_0x4ae26f),await _0x1e4af5(),await _0x34fce8(_0x261953(0x5e0),'已成功从\x20Tavern\x20AI\x20文件导入设定集《'+_0x33fca3+'》。');}async function _0x339859(){const _0x25ffe1=_0x1a5b;try{const _0x533cc0=await _0x17d534[_0x25ffe1(0xab7)][_0x25ffe1(0x511)](),_0x7ab67=await _0x17d534[_0x25ffe1(0x110b)]['toArray']();if(_0x533cc0['length']===0x0&&_0x7ab67['length']===0x0){alert(_0x25ffe1(0xbb1));return;}const _0xef12da={'type':'EPhoneWorldBookBackup','version':0x1,'timestamp':Date[_0x25ffe1(0x606)](),'books':_0x533cc0,'categories':_0x7ab67},_0x29c062=new Blob([JSON[_0x25ffe1(0xc04)](_0xef12da,null,0x2)],{'type':_0x25ffe1(0xa0e)}),_0x1ab5c7=URL[_0x25ffe1(0x795)](_0x29c062),_0x2006de=document[_0x25ffe1(0xe7d)]('a');_0x2006de[_0x25ffe1(0x1173)]=_0x1ab5c7,_0x2006de[_0x25ffe1(0x3c5)]=_0x25ffe1(0x485)+new Date()[_0x25ffe1(0xf63)]()['split']('T')[0x0]+_0x25ffe1(0xb42),_0x2006de['click'](),URL[_0x25ffe1(0x30c)](_0x1ab5c7),await _0x34fce8(_0x25ffe1(0x12d8),_0x25ffe1(0xcab));}catch(_0x11d1d8){console[_0x25ffe1(0xb61)](_0x25ffe1(0xb41),_0x11d1d8),await _0x34fce8(_0x25ffe1(0x99b),'发生了一个错误:\x20'+_0x11d1d8[_0x25ffe1(0x7aa)]);}}async function _0x25bf0a(_0x41dd64){const _0x561e82=_0x1a5b;try{if(_0x41dd64[_0x561e82(0x259)]!==_0x561e82(0x9b6)||!_0x41dd64[_0x561e82(0x1327)])throw new Error(_0x561e82(0x1ad));const _0x3e86dc=await _0x2532b9(_0x561e82(0xe3),'这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！',{'confirmButtonClass':_0x561e82(0x4d3),'confirmText':_0x561e82(0xff)});if(!_0x3e86dc)return;await _0x17d534['transaction']('rw',_0x17d534[_0x561e82(0xab7)],_0x17d534[_0x561e82(0x110b)],async()=>{const _0x32c562=_0x561e82;await _0x17d534[_0x32c562(0xab7)]['clear'](),await _0x17d534[_0x32c562(0x110b)][_0x32c562(0x415)](),Array[_0x32c562(0x971)](_0x41dd64[_0x32c562(0x1327)])&&await _0x17d534[_0x32c562(0xab7)][_0x32c562(0x5b9)](_0x41dd64['books']),Array[_0x32c562(0x971)](_0x41dd64[_0x32c562(0x774)])&&await _0x17d534['worldBookCategories'][_0x32c562(0x5b9)](_0x41dd64['categories']);}),_0x42f206[_0x561e82(0xab7)]=await _0x17d534[_0x561e82(0xab7)]['toArray'](),await _0x1e4af5(),await _0x34fce8('导入成功',_0x561e82(0x171));}catch(_0x4739f7){console[_0x561e82(0xb61)]('导入世界书时出错:',_0x4739f7),await _0x34fce8('导入失败','文件解析或应用失败:\x20'+_0x4739f7['message']);}}const _0x1035c4=localStorage[_0x5897a1(0x127d)](_0x5897a1(0xc0f));if(_0x1035c4){const _0x5b434e=(Date[_0x5897a1(0x606)]()-parseInt(_0x1035c4))/(0x3e8*0x3c);_0x5b434e>0x5&&_0x59d5f7(_0x5b434e);}_0x1d119b(),window[_0x5897a1(0xee3)]=_0x589d88,window['openRenderingRulesScreen']=_0x48f044,window[_0x5897a1(0x98)]=_0x96fbb6,window[_0x5897a1(0x45f)]=_0x468a1b,window[_0x5897a1(0x814)]=_0x7d88d5,window[_0x5897a1(0x6cc)]=_0x2303f9,window[_0x5897a1(0x3cd)]=_0x41d734,window['switchToCharHomeScreen']=_0x280dc7,window[_0x5897a1(0x2b2)]=_0x169028;const _0x177802=document[_0x5897a1(0xe7d)]('div');_0x177802['id']=_0x5897a1(0xaf3),_0x177802['innerHTML']=_0x5897a1(0xb9b),document[_0x5897a1(0x458)](_0x5897a1(0x45c))['appendChild'](_0x177802);const _0xcb6f47=document[_0x5897a1(0xe7d)](_0x5897a1(0x1104));_0xcb6f47['id']='global-custom-style',document['head'][_0x5897a1(0x1079)](_0xcb6f47),_0xf96d9b[_0x5897a1(0xfec)]=document[_0x5897a1(0x458)](_0x5897a1(0xa42)),_0xf96d9b[_0x5897a1(0x1383)]=document[_0x5897a1(0x458)](_0x5897a1(0x4b5));const _0xeaca3f=localStorage[_0x5897a1(0x127d)](_0x5897a1(0x1271))||'light';_0x4c5063(_0xeaca3f);const _0x13022a=document[_0x5897a1(0xe7d)](_0x5897a1(0x1104));_0x13022a['id']=_0x5897a1(0x1052),document[_0x5897a1(0x2ec)][_0x5897a1(0x1079)](_0x13022a);const _0x1a94c2=document[_0x5897a1(0xe7d)]('style');_0x1a94c2['id']=_0x5897a1(0x111e),document[_0x5897a1(0x2ec)][_0x5897a1(0x1079)](_0x1a94c2),_0x1ff070('',_0x5897a1(0xf66),_0x5897a1(0x1052)),_0x1ff070('',_0x5897a1(0x5c5),_0x5897a1(0x111e)),window[_0x5897a1(0x1b4)]=_0x48f044,window[_0x5897a1(0xee3)]=_0x589d88,window[_0x5897a1(0x120d)]=_0x27be5e,window[_0x5897a1(0xe9e)]=_0x51cd3d,window[_0x5897a1(0x8e6)]=_0x3b3899,window[_0x5897a1(0xe2d)]=_0x1e4af5,await _0x198396(),_0x3ad72c(),await _0x595cef(),_0x410076(_0x42f206['globalSettings'][_0x5897a1(0x2d5)]);const _0x2988c6=parseInt(localStorage[_0x5897a1(0x127d)]('unreadPostsCount'))||0x0;_0x276281(_0x2988c6);_0x42f206['globalSettings']&&_0x42f206[_0x5897a1(0xf0)][_0x5897a1(0xafb)]&&_0x393d41(_0x42f206[_0x5897a1(0xf0)][_0x5897a1(0xafb)]);_0x325fa4(),setInterval(_0x325fa4,0x3e8*0x1e),_0x3f8328(),_0x40e49a(),_0x427694(),_0x19044c(),document[_0x5897a1(0x458)]('rules-tabs')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x48f27e=>{const _0x2df5c9=_0x5897a1;_0x48f27e['target']['classList'][_0x2df5c9(0x526)](_0x2df5c9(0x489))&&_0x582eaa(_0x48f27e[_0x2df5c9(0x12df)]['dataset'][_0x2df5c9(0x5f7)]);}),document[_0x5897a1(0x458)](_0x5897a1(0x27e))[_0x5897a1(0xd85)]('click',()=>_0x596560(null)),document[_0x5897a1(0x458)](_0x5897a1(0x81c))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x40fb5f=_0x5897a1;document[_0x40fb5f(0x458)](_0x40fb5f(0xa3b))['classList']['remove'](_0x40fb5f(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x231))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x35ee88),document[_0x5897a1(0x458)](_0x5897a1(0x13bf))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x3bbeac=_0x5897a1;if(_0x42f206['activeChatId']&&!_0x42f206[_0x3bbeac(0x954)][_0x42f206[_0x3bbeac(0x81d)]][_0x3bbeac(0x726)]){const _0x17cdea=_0x42f206[_0x3bbeac(0x954)][_0x42f206[_0x3bbeac(0x81d)]];_0x2ed67a(_0x17cdea['id'],_0x17cdea[_0x3bbeac(0xa1)]);}});let _0xe29c45=null;function _0x1ccf27(_0x4bcd9c){const _0x2edd74=_0x5897a1;_0xe29c45=_0x4bcd9c;const _0xf6e8e8=_0x42f206[_0x2edd74(0x954)][_0x42f206['activeChatId']],_0x1f825e=_0xf6e8e8['announcements'][_0x2edd74(0xb07)](_0x1ec955=>_0x1ec955['id']===_0x4bcd9c);if(!_0x1f825e)return;const _0x5a30e4=document[_0x2edd74(0x458)](_0x2edd74(0xeba));_0x5a30e4['textContent']=_0x1f825e[_0x2edd74(0x858)]?_0x2edd74(0x2db):_0x2edd74(0x2fb),document[_0x2edd74(0x458)](_0x2edd74(0x110))[_0x2edd74(0x11c2)]['add'](_0x2edd74(0x67d));}async function _0x135c92(){const _0x3777ef=_0x5897a1;if(!_0xe29c45)return;const _0x413daa=_0x42f206['chats'][_0x42f206[_0x3777ef(0x81d)]],_0x563e26=_0x413daa[_0x3777ef(0x3c8)][_0x3777ef(0xb07)](_0x49d96f=>_0x49d96f['id']===_0xe29c45);_0x563e26&&(_0x563e26[_0x3777ef(0x858)]=!_0x563e26[_0x3777ef(0x858)],await _0x17d534[_0x3777ef(0x954)][_0x3777ef(0xf3f)](_0x413daa),_0x5c7136()),document[_0x3777ef(0x458)]('announcement-actions-modal')['classList'][_0x3777ef(0x1097)]('visible');}async function _0x32362a(){const _0x25b299=_0x5897a1;if(!_0xe29c45)return;const _0x35c249=await _0x2532b9(_0x25b299(0x1ef),_0x25b299(0x131f),{'confirmButtonClass':_0x25b299(0x4d3)});if(_0x35c249){const _0x413899=_0x42f206[_0x25b299(0x954)][_0x42f206[_0x25b299(0x81d)]];_0x413899['announcements']=_0x413899['announcements'][_0x25b299(0xaf1)](_0x35d42f=>_0x35d42f['id']!==_0xe29c45),await _0x17d534[_0x25b299(0x954)][_0x25b299(0xf3f)](_0x413899),_0x5c7136();}document['getElementById'](_0x25b299(0x110))[_0x25b299(0x11c2)][_0x25b299(0x1097)](_0x25b299(0x67d));}document[_0x5897a1(0x458)]('custom-modal-cancel')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x424532),document['getElementById'](_0x5897a1(0x2b6))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x50aee5=>{const _0x423bd7=_0x5897a1;if(_0x50aee5[_0x423bd7(0x12df)]===_0x60019f)_0x424532();}),document[_0x5897a1(0x458)]('export-data-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x2275d7=_0x5897a1,_0x1c08e9=await _0xcd7475('选择导出方式',[{'text':'分片导出\x20(推荐，打包为ZIP，解压每个切片选择增量导入)','value':'slice'},{'text':'智能导出\x20(单个大文件，太大可能会导致导入不了)','value':_0x2275d7(0x729)},{'text':_0x2275d7(0x12c1),'value':_0x2275d7(0x43d)}]);if(_0x1c08e9===_0x2275d7(0x5b0))_0x1a5f49();else{if(_0x1c08e9===_0x2275d7(0x729))_0x15d78b();else _0x1c08e9===_0x2275d7(0x43d)&&_0x6ceee0();}}),document[_0x5897a1(0x458)](_0x5897a1(0xf57))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x15e238),document[_0x5897a1(0x458)](_0x5897a1(0xcfb))['addEventListener'](_0x5897a1(0x26a),_0x33be3b=>{const _0x2343f5=_0x5897a1;document['getElementById'](_0x2343f5(0x100e))['style']['display']=_0x33be3b['target']['checked']?_0x2343f5(0x1188):_0x2343f5(0x464);}),document[_0x5897a1(0x458)](_0x5897a1(0xfa3))[_0x5897a1(0xd85)]('click',()=>document[_0x5897a1(0x458)](_0x5897a1(0x9ad))['click']()),document['getElementById'](_0x5897a1(0x109b))['addEventListener']('change',_0x2ec4d7=>{const _0x4d2819=_0x5897a1;document[_0x4d2819(0x458)](_0x4d2819(0x7e4))[_0x4d2819(0x1104)][_0x4d2819(0x4db)]=_0x2ec4d7['target'][_0x4d2819(0x8f7)]?'block':_0x4d2819(0x464);}),document[_0x5897a1(0x458)](_0x5897a1(0x9ad))[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0xe19f9a=>_0x55c86e(_0xe19f9a['target'][_0x5897a1(0x1a9)][0x0])),document[_0x5897a1(0x458)](_0x5897a1(0x11fb))[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x516faa),document[_0x5897a1(0x458)](_0x5897a1(0x10a6))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x4394cb=_0x5897a1;_0x1130c4={},_0x1ff070('','#chat-messages',_0x4394cb(0x1052)),_0x1ff070('',_0x4394cb(0x5c5),_0x4394cb(0x111e)),_0x5bc130(),_0x42f206['activeChatId']=null,_0x589d88('chat-list-screen');}),document[_0x5897a1(0x458)](_0x5897a1(0x6b1))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x4929aa=_0x5897a1,_0x430534=await _0xcd7475('创建新聊天',[{'text':_0x4929aa(0xcb6),'value':_0x4929aa(0xc84)},{'text':'从角色卡导入\x20(.json/.png)','value':_0x4929aa(0x1444)}]);if(_0x430534===_0x4929aa(0xc84)){const _0x32bfcf=await _0x335e57(_0x4929aa(0x32d),'请输入你想为Ta设置的【备注名】(例如:\x20哥哥)');if(!_0x32bfcf||!_0x32bfcf[_0x4929aa(0x2aa)]())return;const _0x5ecfb0=await _0x335e57(_0x4929aa(0x6f1),_0x4929aa(0xe76));if(!_0x5ecfb0||!_0x5ecfb0[_0x4929aa(0x2aa)]())return;const _0x46cb86=_0x4929aa(0x12fe)+Date[_0x4929aa(0x606)](),_0x4a70a2={'id':_0x46cb86,'name':_0x32bfcf[_0x4929aa(0x2aa)](),'originalName':_0x5ecfb0['trim'](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':_0x4929aa(0xe97),'blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date[_0x4929aa(0x606)](),'isBusy':![]},'settings':{'aiPersona':_0x4929aa(0x528),'myPersona':_0x4929aa(0x44b),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x4fd084,'myAvatar':_0x4fd084,'background':'','theme':_0x4929aa(0x1121),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':_0x4929aa(0x12db)},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x42f206[_0x4929aa(0x954)][_0x46cb86]=_0x4a70a2,await _0x17d534[_0x4929aa(0x954)]['put'](_0x4a70a2),_0x27be5e();}else _0x430534==='import_card'&&document[_0x4929aa(0x458)](_0x4929aa(0x11fb))[_0x4929aa(0x1122)]();}),document[_0x5897a1(0x458)](_0x5897a1(0x2f7))[_0x5897a1(0xd85)]('click',_0x55a6d6),document['getElementById'](_0x5897a1(0x1ea))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>document['getElementById'](_0x5897a1(0x1156))[_0x5897a1(0x11c2)]['remove'](_0x5897a1(0x67d))),document[_0x5897a1(0x458)](_0x5897a1(0x9dc))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x460286),document['getElementById']('listen-together-btn')['addEventListener']('click',_0x96fbb6),document['getElementById'](_0x5897a1(0xc6))['addEventListener'](_0x5897a1(0x1122),()=>_0x361813(!![])),document[_0x5897a1(0x458)](_0x5897a1(0xcf9))['addEventListener'](_0x5897a1(0x1122),_0x4f6f89),document[_0x5897a1(0x458)](_0x5897a1(0x612))[_0x5897a1(0xd85)]('click',_0x4fd0ef),document[_0x5897a1(0x458)](_0x5897a1(0xb5d))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x106240),document[_0x5897a1(0x458)]('music-prev-btn')['addEventListener']('click',_0x14faf6),document[_0x5897a1(0x458)](_0x5897a1(0x209))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0xb6ae9a),document[_0x5897a1(0x458)](_0x5897a1(0x6d4))['addEventListener']('click',()=>{const _0x3ce67d=_0x5897a1;_0xe64ac7(),document[_0x3ce67d(0x458)](_0x3ce67d(0x602))['classList'][_0x3ce67d(0xa58)](_0x3ce67d(0x67d));}),document['getElementById'](_0x5897a1(0x3bd))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>document[_0x5897a1(0x458)](_0x5897a1(0x602))['classList']['remove']('visible')),document[_0x5897a1(0x458)]('add-song-url-btn')[_0x5897a1(0xd85)]('click',_0x2161d7),document[_0x5897a1(0x458)](_0x5897a1(0x31a))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>document[_0x5897a1(0x458)](_0x5897a1(0xd8e))['click']()),document[_0x5897a1(0x458)]('local-song-upload-input')['addEventListener'](_0x5897a1(0x26a),_0x2bd74c),document[_0x5897a1(0x458)](_0x5897a1(0x67c))['addEventListener'](_0x5897a1(0x1122),_0x25c0b0=>{const _0x192ff0=_0x5897a1,_0x1bd843=_0x25c0b0[_0x192ff0(0x12df)],_0x3bd3de=parseInt(_0x1bd843['dataset'][_0x192ff0(0xb3)]);if(isNaN(_0x3bd3de))return;if(_0x1bd843['classList'][_0x192ff0(0x526)]('album-art-btn'))_0x1ab71a(_0x3bd3de);else{if(_0x1bd843[_0x192ff0(0x11c2)][_0x192ff0(0x526)](_0x192ff0(0x11f1)))_0x97e5ff(_0x3bd3de);else{if(_0x1bd843['classList']['contains']('bg-btn'))_0x1a8029(_0x3bd3de);else _0x1bd843[_0x192ff0(0x11c2)][_0x192ff0(0x526)]('delete-track-btn')&&_0xfe0b79(_0x3bd3de);}}}),_0x112d48[_0x5897a1(0xd85)](_0x5897a1(0x1d4),()=>{const _0x54b83e=_0x5897a1;document[_0x54b83e(0x458)]('vinyl-view')[_0x54b83e(0x11c2)][_0x54b83e(0x1097)](_0x54b83e(0x101f)),_0x106240();});const _0x7d7a4f=document[_0x5897a1(0x458)](_0x5897a1(0x238));document['getElementById'](_0x5897a1(0x1346))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x204fec=_0x5897a1;_0x575bad();const _0x5409a2=_0x7d7a4f[_0x204fec(0x8dd)]['trim']();if(!_0x5409a2||!_0x42f206[_0x204fec(0x81d)])return;const _0x58da0e=_0x42f206[_0x204fec(0x954)][_0x42f206[_0x204fec(0x81d)]],_0x3003e3={'role':_0x204fec(0xf86),'content':_0x5409a2,'timestamp':Date['now']()};_0x9db598&&(_0x3003e3[_0x204fec(0xb92)]=_0x9db598),_0x5d5ee2(_0x3003e3,_0x58da0e),((async()=>{const _0x9f93d0=_0x204fec;_0x58da0e['history'][_0x9f93d0(0x129e)](_0x3003e3),await _0x17d534['chats'][_0x9f93d0(0xf3f)](_0x58da0e),_0x27be5e();})()),_0x7d7a4f[_0x204fec(0x8dd)]='',_0x7d7a4f[_0x204fec(0x1104)][_0x204fec(0x120b)]=_0x204fec(0xf29),_0x7d7a4f[_0x204fec(0x1248)](),_0xd2d593();}),document['getElementById']('wait-reply-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x3ee822),_0x7d7a4f[_0x5897a1(0xd85)]('keypress',_0x4f6107=>{const _0x4e6bb1=_0x5897a1;_0x4f6107[_0x4e6bb1(0x1278)]==='Enter'&&!_0x4f6107[_0x4e6bb1(0x637)]&&(_0x4f6107[_0x4e6bb1(0xae3)](),document[_0x4e6bb1(0x458)](_0x4e6bb1(0x1346))[_0x4e6bb1(0x1122)]());}),document['getElementById'](_0x5897a1(0xe2))['addEventListener']('change',async _0x36fe89=>{const _0x1a9580=_0x5897a1,_0x1696df=_0x36fe89[_0x1a9580(0x12df)][_0x1a9580(0x1a9)][0x0];if(_0x1696df){const _0x58fcad=await new Promise((_0x420eac,_0x1d0de8)=>{const _0x11e0dd=_0x1a9580,_0x2f3168=new FileReader();_0x2f3168[_0x11e0dd(0x11fa)]=()=>_0x420eac(_0x2f3168[_0x11e0dd(0x2ed)]),_0x2f3168['onerror']=()=>_0x1d0de8(_0x2f3168['error']),_0x2f3168[_0x11e0dd(0x96e)](_0x1696df);});_0x251566=_0x58fcad,_0x3b3899();}}),document['getElementById'](_0x5897a1(0x734))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x47435f=_0x5897a1;_0x251566&&(_0x42f206[_0x47435f(0xf0)][_0x47435f(0xef2)]=_0x251566),_0x42f206[_0x47435f(0xf0)][_0x47435f(0x2d5)]=document[_0x47435f(0x458)](_0x47435f(0xb1d))[_0x47435f(0x8dd)]['trim'](),_0x42f206[_0x47435f(0xf0)]['notificationSoundUrl']=document[_0x47435f(0x458)](_0x47435f(0xc49))[_0x47435f(0x8dd)][_0x47435f(0x2aa)](),_0x42f206['globalSettings'][_0x47435f(0x733)]=document[_0x47435f(0x458)](_0x47435f(0x217))['checked'],await _0x17d534['globalSettings'][_0x47435f(0xf3f)](_0x42f206[_0x47435f(0xf0)]),_0x3f8328(),_0x4eca92(),_0x251566=null,_0x427694(),_0x3abb21(),_0x410076(_0x42f206['globalSettings'][_0x47435f(0x2d5)]),_0x3ad72c(),alert(_0x47435f(0x2a4)),_0x589d88(_0x47435f(0x838));});const _0x1f5622=document['getElementById']('messages-view');_0x1f5622[_0x5897a1(0xd85)](_0x5897a1(0xf6a),()=>{const {scrollTop:_0x429e07,scrollHeight:_0x511203,clientHeight:_0x58c739}=_0x1f5622;_0x511203-_0x429e07-_0x58c739<_0x58c739&&(!_0x935422&&_0x438393());}),document[_0x5897a1(0x458)](_0x5897a1(0x9fa))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x1715e6=_0x5897a1;_0x42f206[_0x1715e6(0x5cb)][_0x1715e6(0x683)]=document[_0x1715e6(0x458)]('proxy-url')[_0x1715e6(0x8dd)]['trim'](),_0x42f206[_0x1715e6(0x5cb)][_0x1715e6(0x3fe)]=document[_0x1715e6(0x458)](_0x1715e6(0x361))[_0x1715e6(0x8dd)][_0x1715e6(0x2aa)](),_0x42f206[_0x1715e6(0x5cb)][_0x1715e6(0x49b)]=document[_0x1715e6(0x458)](_0x1715e6(0xc2d))[_0x1715e6(0x8dd)],_0x42f206[_0x1715e6(0x5cb)][_0x1715e6(0x657)]=document[_0x1715e6(0x458)](_0x1715e6(0xb2b))['value']['trim'](),_0x42f206['apiConfig'][_0x1715e6(0x770)]=document['getElementById']('minimax-api-key')['value'][_0x1715e6(0x2aa)](),_0x42f206[_0x1715e6(0x5cb)][_0x1715e6(0x1063)]=document[_0x1715e6(0x458)](_0x1715e6(0x537))[_0x1715e6(0x8dd)],_0x42f206['apiConfig']['secondaryProxyUrl']=document[_0x1715e6(0x458)]('secondary-proxy-url')[_0x1715e6(0x8dd)][_0x1715e6(0x2aa)](),_0x42f206[_0x1715e6(0x5cb)][_0x1715e6(0x121d)]=document[_0x1715e6(0x458)](_0x1715e6(0x494))['value']['trim'](),_0x42f206['apiConfig'][_0x1715e6(0xdc9)]=document[_0x1715e6(0x458)](_0x1715e6(0xbf3))[_0x1715e6(0x8dd)],await _0x17d534[_0x1715e6(0x5cb)][_0x1715e6(0xf3f)](_0x42f206[_0x1715e6(0x5cb)]);const _0x1f5136=document[_0x1715e6(0x458)](_0x1715e6(0xa87)),_0x2ee582=document[_0x1715e6(0x458)](_0x1715e6(0xd1b)),_0x2fd177=document['getElementById']('block-cooldown-input');_0x42f206[_0x1715e6(0xf0)][_0x1715e6(0x12cd)]=_0x1f5136[_0x1715e6(0x8f7)],_0x42f206[_0x1715e6(0xf0)]['backgroundActivityInterval']=parseInt(_0x2ee582[_0x1715e6(0x8dd)])||0x3c,_0x42f206[_0x1715e6(0xf0)][_0x1715e6(0x121b)]=parseFloat(_0x2fd177[_0x1715e6(0x8dd)])||0x1,_0x42f206[_0x1715e6(0xf0)][_0x1715e6(0xf0e)]=document[_0x1715e6(0x458)](_0x1715e6(0x9a4))[_0x1715e6(0x8f7)],_0x42f206['globalSettings'][_0x1715e6(0x1365)]=parseInt(document[_0x1715e6(0x458)](_0x1715e6(0xcff))['value'])||0x32,_0x42f206[_0x1715e6(0xf0)]['chatListRenderWindow']=parseInt(document['getElementById'](_0x1715e6(0x381))[_0x1715e6(0x8dd)])||0x1e,_0x42f206[_0x1715e6(0xf0)][_0x1715e6(0xfdf)]=parseFloat(document['getElementById'](_0x1715e6(0x59b))[_0x1715e6(0x8dd)]),await _0x17d534[_0x1715e6(0xf0)][_0x1715e6(0xf3f)](_0x42f206[_0x1715e6(0xf0)]),_0x2437fd();_0x42f206[_0x1715e6(0xf0)][_0x1715e6(0x12cd)]?(_0x27c212(),console['log'](_0x1715e6(0xbf4)+_0x42f206[_0x1715e6(0xf0)][_0x1715e6(0xc29)]+'秒')):console[_0x1715e6(0x7d1)](_0x1715e6(0xa15));const _0x211b23=document[_0x1715e6(0x458)]('novelai-switch')[_0x1715e6(0x8f7)],_0x4d93f5=document[_0x1715e6(0x458)](_0x1715e6(0x10d0))[_0x1715e6(0x8dd)],_0x10a9a6=document['getElementById'](_0x1715e6(0x40a))[_0x1715e6(0x8dd)][_0x1715e6(0x2aa)]();localStorage['setItem'](_0x1715e6(0xf42),_0x211b23),localStorage[_0x1715e6(0xc93)](_0x1715e6(0x10d0),_0x4d93f5),localStorage[_0x1715e6(0xc93)](_0x1715e6(0x40a),_0x10a9a6),alert('所有API与后台设置已保存!');});const _0x298454=document[_0x5897a1(0x458)](_0x5897a1(0x361));_0x298454[_0x5897a1(0xd85)]('focus',_0x2c4d01=>{const _0x5345aa=_0x5897a1;_0x2c4d01[_0x5345aa(0x12df)][_0x5345aa(0x837)](_0x5345aa(0x259),'text');}),_0x298454['addEventListener'](_0x5897a1(0x545),_0x42c1f9=>{const _0x144f0e=_0x5897a1;_0x42c1f9[_0x144f0e(0x12df)][_0x144f0e(0x837)](_0x144f0e(0x259),_0x144f0e(0x141f));});async function _0x6e93d5(_0x10e42d,_0x505db0,_0x455667){const _0xb55967=_0x5897a1,_0x78187=document[_0xb55967(0x458)](_0x10e42d)[_0xb55967(0x8dd)][_0xb55967(0x2aa)](),_0x568b68=document['getElementById'](_0x505db0)[_0xb55967(0x8dd)][_0xb55967(0x2aa)]();if(!_0x78187||!_0x568b68)return alert('请先填写对应的反代地址和密钥');try{let _0x45f087=_0x78187===GEMINI_API_URL;const _0x467bbe=await fetch(_0x45f087?GEMINI_API_URL+'?key='+getRandomValue(_0x568b68):_0x78187+_0xb55967(0xe65),_0x45f087?undefined:{'headers':{'Authorization':_0xb55967(0x8aa)+_0x568b68}});if(!_0x467bbe['ok'])throw new Error(_0xb55967(0xc5e));const _0x3bfa84=await _0x467bbe[_0xb55967(0xaef)]();let _0x42a748=_0x45f087?_0x3bfa84[_0xb55967(0x11e5)]['map'](_0x119085=>({'id':_0x119085['name']['split']('/')[0x1]||_0x119085[_0xb55967(0x132a)]})):_0x3bfa84[_0xb55967(0x76b)];const _0x11dade=document[_0xb55967(0x458)](_0x455667);_0x11dade[_0xb55967(0x110d)]='';const _0x155695=_0x455667===_0xb55967(0xc2d)?_0x42f206['apiConfig'][_0xb55967(0x49b)]:_0x42f206['apiConfig'][_0xb55967(0xdc9)];_0x42a748[_0xb55967(0x12c2)](_0x1de83d=>{const _0x21b9be=_0xb55967,_0xf99b21=document[_0x21b9be(0xe7d)](_0x21b9be(0x790));_0xf99b21[_0x21b9be(0x8dd)]=_0x1de83d['id'],_0xf99b21[_0x21b9be(0x1a2)]=_0x1de83d['id'];if(_0x1de83d['id']===_0x155695)_0xf99b21[_0x21b9be(0x500)]=!![];_0x11dade[_0x21b9be(0x1079)](_0xf99b21);}),alert(_0xb55967(0xe51));}catch(_0x16bdba){alert(_0xb55967(0x4dc)+_0x16bdba[_0xb55967(0x7aa)]);}}document['getElementById'](_0x5897a1(0x8c9))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x562a47=_0x5897a1;_0x6e93d5(_0x562a47(0x18d),_0x562a47(0x361),_0x562a47(0xc2d));}),document['getElementById']('fetch-secondary-models-btn')['addEventListener'](_0x5897a1(0x1122),()=>{const _0x2ad51f=_0x5897a1;_0x6e93d5(_0x2ad51f(0x132f),_0x2ad51f(0x494),_0x2ad51f(0xbf3));}),document[_0x5897a1(0x458)](_0x5897a1(0xf7e))['addEventListener'](_0x5897a1(0x1122),async()=>{const _0x2832fe=_0x5897a1,_0x4da906=await _0x335e57(_0x2832fe(0xd3f),_0x2832fe(0x89c));if(_0x4da906&&_0x4da906[_0x2832fe(0x2aa)]()){const _0x495996={'id':_0x2832fe(0x1141)+Date[_0x2832fe(0x606)](),'name':_0x4da906[_0x2832fe(0x2aa)](),'content':''};await _0x17d534[_0x2832fe(0xab7)][_0x2832fe(0xa58)](_0x495996),_0x42f206[_0x2832fe(0xab7)][_0x2832fe(0x129e)](_0x495996),_0x1e4af5(),_0x35b28c(_0x495996['id']);}}),document['getElementById'](_0x5897a1(0x13a2))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x268842=_0x5897a1;if(!_0x35398a)return;const _0x1684ac=_0x42f206[_0x268842(0xab7)][_0x268842(0xb07)](_0x5dfa8f=>_0x5dfa8f['id']===_0x35398a);if(!_0x1684ac)return;const _0x329831=document['getElementById'](_0x268842(0xfc7))[_0x268842(0x8dd)]['trim']();if(!_0x329831){alert('书名不能为空！');return;}_0x1684ac[_0x268842(0x132a)]=_0x329831;const _0x52c5e2=document[_0x268842(0x458)](_0x268842(0xd17))[_0x268842(0x8dd)];_0x1684ac['categoryId']=_0x52c5e2?parseInt(_0x52c5e2):null;const _0x1272f8=document[_0x268842(0x458)]('world-book-entries-container'),_0x119419=_0x1272f8[_0x268842(0x102a)](_0x268842(0x1425)),_0x3767b0=[];_0x119419[_0x268842(0x12c2)](_0xc2d8ba=>{const _0xba4aa1=_0x268842,_0x3944d1=_0xc2d8ba[_0xba4aa1(0x586)](_0xba4aa1(0x34a))['value'][_0xba4aa1(0x2aa)](),_0xf82af=_0xc2d8ba['querySelector'](_0xba4aa1(0xdd8))[_0xba4aa1(0x8dd)][_0xba4aa1(0x2aa)](),_0x19f745=_0xc2d8ba['querySelector'](_0xba4aa1(0x1142))[_0xba4aa1(0x8f7)];_0xf82af&&_0x3767b0[_0xba4aa1(0x129e)]({'comment':_0xc2d8ba[_0xba4aa1(0x586)](_0xba4aa1(0x744))['value'][_0xba4aa1(0x2aa)](),'keys':_0x3944d1?_0x3944d1[_0xba4aa1(0x90b)](',')[_0xba4aa1(0xbf6)](_0x3ad548=>_0x3ad548[_0xba4aa1(0x2aa)]())[_0xba4aa1(0xaf1)](_0xd9d498=>_0xd9d498):[],'content':_0xf82af,'enabled':_0x19f745});}),_0x1684ac[_0x268842(0x1316)]=_0x3767b0,await _0x17d534[_0x268842(0xab7)][_0x268842(0xf3f)](_0x1684ac),document[_0x268842(0x458)](_0x268842(0xf23))['textContent']=_0x329831,_0x35398a=null,_0x589d88(_0x268842(0x7d)),await _0x1e4af5();}),document[_0x5897a1(0x458)](_0x5897a1(0x13a0))[_0x5897a1(0xd85)]('click',async _0x43aa05=>{const _0x349a39=_0x5897a1,_0x36b13a=_0x43aa05[_0x349a39(0x12df)][_0x349a39(0xe87)](_0x349a39(0x72f));if(_0x36b13a){const _0x2aaec1=_0x42f206[_0x349a39(0x954)][_0x42f206[_0x349a39(0x81d)]];if(!_0x2aaec1)return;_0x128a08(_0x36b13a);const _0x3d7ccc=_0x36b13a[_0x349a39(0xe87)](_0x349a39(0xd4f)),_0x33d5fe=_0x3d7ccc?_0x3d7ccc[_0x349a39(0x586)](_0x349a39(0x3a1)):null;if(_0x36b13a[_0x349a39(0x1f4)][_0x349a39(0xbae)]&&_0x33d5fe&&_0x33d5fe[_0x349a39(0x1104)][_0x349a39(0x4db)]==='block'){if(_0x2aaec1['isGroup']){console[_0x349a39(0x7d1)]('这是一条群聊语音消息，已禁止发起TTS请求。');return;}if(_0x2aaec1[_0x349a39(0xda2)][_0x349a39(0x211)]===![]){console[_0x349a39(0x7d1)]('“'+_0x2aaec1[_0x349a39(0x132a)]+_0x349a39(0x2a9));return;}_0x31bb35(_0x36b13a);}return;}const _0xce2434=_0x43aa05['target'][_0x349a39(0xe87)](_0x349a39(0x4cd));if(_0xce2434){const _0x4239eb=_0xce2434[_0x349a39(0xe87)](_0x349a39(0xd4f));if(_0x4239eb){const _0x2e7ed9=parseInt(_0x4239eb['dataset']['timestamp']);if(!isNaN(_0x2e7ed9)){_0x10f1ca(_0x2e7ed9);return;}}}const _0x5cf0f1=_0x43aa05[_0x349a39(0x12df)]['closest']('.waimai-user-actions\x20button');if(_0x5cf0f1){const _0x17f296=_0x5cf0f1[_0x349a39(0xe87)](_0x349a39(0xd4f));if(_0x17f296){const _0x1f9137=parseInt(_0x17f296[_0x349a39(0x1f4)][_0x349a39(0xf16)]),_0x401ddc=_0x5cf0f1[_0x349a39(0x1f4)][_0x349a39(0x11a1)];if(!isNaN(_0x1f9137)&&_0x401ddc){await _0x43dd8d(_0x1f9137,_0x401ddc);return;}}}const _0x577a9f=_0x43aa05[_0x349a39(0x12df)][_0x349a39(0xe87)]('.post-deleted-placeholder');if(_0x577a9f){const _0x22d775=parseInt(_0x577a9f[_0x349a39(0x1f4)][_0x349a39(0x13bc)]);if(!isNaN(_0x22d775)){const _0x3d3579=await _0x17d534[_0x349a39(0x15b)][_0x349a39(0x36d)](_0x22d775);if(_0x3d3579){let _0x17e6c6='';const _0x4f2e42=_0x3d3579[_0x349a39(0x1086)]===_0x349a39(0xf86)?_0x42f206[_0x349a39(0x551)][_0x349a39(0x308)]:_0x42f206[_0x349a39(0x954)][_0x3d3579[_0x349a39(0x1086)]]?.[_0x349a39(0x132a)]||_0x349a39(0x11dc);if(_0x3d3579[_0x349a39(0x259)]===_0x349a39(0xb03))_0x17e6c6=_0x3d3579[_0x349a39(0x1316)];else{_0x17e6c6=_0x3d3579[_0x349a39(0xd2d)]||'';if(_0x3d3579[_0x349a39(0x2cc)])_0x17e6c6+='\x0a[图片]';if(_0x3d3579[_0x349a39(0x145)])_0x17e6c6+='\x0a[文字图内容:\x20'+_0x3d3579['hiddenContent']+']';}_0x34fce8('来自\x20'+_0x4f2e42+_0x349a39(0xf15),_0x17e6c6['replace'](/\n/g,'<br>'));}else _0x34fce8('提示',_0x349a39(0x82));}return;}const _0x4630e6=_0x43aa05[_0x349a39(0x12df)][_0x349a39(0xe87)](_0x349a39(0x13aa));if(_0x4630e6){const _0x8d7781=_0x4630e6[_0x349a39(0x1f4)]['description'];if(_0x8d7781)_0x34fce8(_0x349a39(0x6c),_0x8d7781);return;}const _0x5ca62c=_0x43aa05[_0x349a39(0x12df)][_0x349a39(0xe87)](_0x349a39(0x10a7));if(_0x5ca62c&&_0x5ca62c[_0x349a39(0x1f4)][_0x349a39(0xeb9)]){const _0x42b539=parseInt(_0x5ca62c[_0x349a39(0x1f4)]['originalTimestamp']);!isNaN(_0x42b539)&&_0x11e348(_0x42b539);}const _0x4994ce=_0x43aa05['target'][_0x349a39(0xe87)]('.gift-card');if(_0x4994ce){const _0x2e024e=_0x4994ce[_0x349a39(0xe87)]('.message-bubble');_0x2e024e&&_0x57eb69(parseInt(_0x2e024e['dataset'][_0x349a39(0xf16)]));}const _0x5b3a11=_0x43aa05[_0x349a39(0x12df)]['closest'](_0x349a39(0x576));if(_0x5b3a11){const _0x142179=_0x5b3a11[_0x349a39(0xe87)](_0x349a39(0xd4f));if(_0x142179&&_0x142179[_0x349a39(0x1f4)][_0x349a39(0xf16)]){const _0x122130=parseInt(_0x142179[_0x349a39(0x1f4)]['timestamp']);_0x442c2e(_0x122130);}}const _0x2f12f4=_0x43aa05[_0x349a39(0x12df)][_0x349a39(0xe87)](_0x349a39(0xbfb));if(_0x2f12f4){const _0x1d5feb=parseInt(_0x2f12f4[_0x349a39(0x1f4)][_0x349a39(0x2da)]);if(isNaN(_0x1d5feb))return;const _0x55a655=_0x43aa05['target'][_0x349a39(0xe87)](_0x349a39(0x6e3));if(_0x55a655&&!_0x2f12f4['classList'][_0x349a39(0x526)]('closed')){_0x5cde4c(_0x1d5feb,_0x55a655[_0x349a39(0x1f4)]['option']);return;}const _0x27267d=_0x43aa05[_0x349a39(0x12df)][_0x349a39(0xe87)](_0x349a39(0x3e5));if(_0x27267d){_0x2f12f4[_0x349a39(0x11c2)][_0x349a39(0x526)](_0x349a39(0xd9c))?_0x5503c9(_0x1d5feb):_0x2a3629(_0x1d5feb);return;}_0x2f12f4[_0x349a39(0x11c2)][_0x349a39(0x526)]('closed')&&_0x5503c9(_0x1d5feb);}const _0x34eeb4=_0x43aa05[_0x349a39(0x12df)]['closest'](_0x349a39(0xa04));if(_0x34eeb4){const _0x526b2d=_0x42f206[_0x349a39(0x954)][_0x42f206['activeChatId']],_0x3c286a=_0x34eeb4[_0x349a39(0xe87)](_0x349a39(0x11d1));if(_0x526b2d&&_0x3c286a){const _0x27e6ed=parseInt(_0x3c286a[_0x349a39(0x1f4)][_0x349a39(0xf16)]),_0x7c18ab=_0x526b2d[_0x349a39(0x1d5)][_0x349a39(0xb07)](_0x3c6535=>_0x3c6535[_0x349a39(0xf16)]===_0x27e6ed);if(_0x7c18ab&&_0x7c18ab[_0x349a39(0x624)]){let _0x1210c9='';const _0x4c3377=_0x7c18ab['recalledData'];_0x4c3377[_0x349a39(0x603)]===_0x349a39(0xdd5)?_0x1210c9='原文:\x20\x22'+_0x4c3377[_0x349a39(0x1f0)]+'\x22':_0x1210c9=_0x349a39(0xa5c)+_0x4c3377['originalType']+_0x349a39(0x108e),_0x34fce8(_0x349a39(0x85b),_0x1210c9);}}}const _0x98393d=_0x43aa05[_0x349a39(0x12df)][_0x349a39(0xe87)]('.link-share-card');if(_0x98393d&&_0x98393d[_0x349a39(0xe87)](_0x349a39(0x4a6))){const _0x14ce4c=parseInt(_0x98393d[_0x349a39(0x1f4)][_0x349a39(0xf16)]);_0x2d62fa(_0x14ce4c);}const _0x416cc3=_0x43aa05[_0x349a39(0x12df)][_0x349a39(0xe87)]('.message-bubble');if(_0x416cc3&&_0x416cc3[_0x349a39(0x11c2)][_0x349a39(0x526)]('ai')&&_0x416cc3[_0x349a39(0x11c2)][_0x349a39(0x526)](_0x349a39(0x27f))&&_0x416cc3[_0x349a39(0x1f4)]['status']===_0x349a39(0xdaa)){const _0x564f1e=parseInt(_0x416cc3[_0x349a39(0x1f4)][_0x349a39(0xf16)]);!isNaN(_0x564f1e)&&_0x6e71(_0x564f1e);}});const _0x51c816=document[_0x5897a1(0x458)](_0x5897a1(0x8b0)),_0x3b8cd2=document['querySelector'](_0x5897a1(0x10f9)),_0x1ec81b=document[_0x5897a1(0x458)]('world-book-checkboxes-container');function _0x4f8e8c(){const _0xff2485=_0x5897a1,_0x9fca0e=_0x1ec81b['querySelectorAll']('input:checked'),_0x5b64ad=document[_0xff2485(0x586)](_0xff2485(0xa66));if(_0x9fca0e[_0xff2485(0x131d)]===0x0)_0x5b64ad[_0xff2485(0x1a2)]=_0xff2485(0x963);else{if(_0x9fca0e[_0xff2485(0x131d)]>0x2)_0x5b64ad[_0xff2485(0x1a2)]=_0xff2485(0x103c)+_0x9fca0e['length']+'\x20本世界书';else{const _0xc5e449=Array['from'](_0x9fca0e)[_0xff2485(0xbf6)](_0x46f69b=>{const _0x2c6b0f=_0xff2485;return _0x46f69b[_0x2c6b0f(0x1389)][_0x2c6b0f(0x1a2)][_0x2c6b0f(0x2aa)]();});_0x5b64ad[_0xff2485(0x1a2)]=_0xc5e449[_0xff2485(0x56c)](',\x20');}}}_0x3b8cd2[_0x5897a1(0xd85)]('click',_0x536e07=>{const _0x111359=_0x5897a1;_0x536e07[_0x111359(0x58e)](),_0x1ec81b[_0x111359(0x11c2)][_0x111359(0x1270)]('visible'),_0x3b8cd2['classList'][_0x111359(0x1270)]('expanded');}),document[_0x5897a1(0x458)](_0x5897a1(0x80d))[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x4f8e8c),window[_0x5897a1(0xd85)]('click',_0x3c0f61=>{const _0x3dd7c4=_0x5897a1;!document[_0x3dd7c4(0x586)](_0x3dd7c4(0xb2e))['contains'](_0x3c0f61['target'])&&(_0x1ec81b['classList'][_0x3dd7c4(0x1097)]('visible'),_0x3b8cd2[_0x3dd7c4(0x11c2)][_0x3dd7c4(0x1097)](_0x3dd7c4(0x21c)));}),document[_0x5897a1(0x458)](_0x5897a1(0xa41))[_0x5897a1(0xd85)]('click',async()=>{const _0x4b1636=_0x5897a1;_0x54c2f8();if(!_0x42f206[_0x4b1636(0x81d)])return;const _0x2aa4a4=_0x42f206['chats'][_0x42f206[_0x4b1636(0x81d)]],_0xd41988=_0x2aa4a4['isGroup'],_0xc926fe=document[_0x4b1636(0x458)]('switch-greeting-group');!_0xd41988&&_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x13ea)]&&_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x13ea)][_0x4b1636(0x131d)]>0x0?_0xc926fe['style'][_0x4b1636(0x4db)]=_0x4b1636(0x1188):_0xc926fe[_0x4b1636(0x1104)]['display']=_0x4b1636(0x464);document[_0x4b1636(0x458)]('chat-name-group')[_0x4b1636(0x1104)][_0x4b1636(0x4db)]=_0x4b1636(0x1188),document['getElementById'](_0x4b1636(0xd42))[_0x4b1636(0x1104)]['display']=_0x4b1636(0x1188),document['getElementById'](_0x4b1636(0xfc3))[_0x4b1636(0x1104)][_0x4b1636(0x4db)]=_0x4b1636(0x1188),document[_0x4b1636(0x458)](_0x4b1636(0x121))['style'][_0x4b1636(0x4db)]=_0xd41988?'block':_0x4b1636(0x464),document[_0x4b1636(0x458)](_0x4b1636(0xc9))[_0x4b1636(0x1104)][_0x4b1636(0x4db)]=_0xd41988?_0x4b1636(0x464):_0x4b1636(0x1188),document['getElementById'](_0x4b1636(0x705))[_0x4b1636(0x1104)]['display']=_0xd41988?_0x4b1636(0x1188):_0x4b1636(0x464),document[_0x4b1636(0x458)](_0x4b1636(0xfff))[_0x4b1636(0x1104)][_0x4b1636(0x4db)]=_0xd41988?_0x4b1636(0x1188):'none',document['getElementById'](_0x4b1636(0x904))[_0x4b1636(0x1104)][_0x4b1636(0x4db)]=_0xd41988?'none':_0x4b1636(0x1188),document[_0x4b1636(0x458)](_0x4b1636(0x887))['style'][_0x4b1636(0x4db)]=_0xd41988?_0x4b1636(0x464):'block',document[_0x4b1636(0x458)](_0x4b1636(0x1463))['style'][_0x4b1636(0x4db)]=_0xd41988?_0x4b1636(0x464):_0x4b1636(0x1188),document[_0x4b1636(0x458)](_0x4b1636(0xdbb))['style'][_0x4b1636(0x4db)]=_0xd41988?_0x4b1636(0x464):_0x4b1636(0x1188),document['getElementById'](_0x4b1636(0xaa8))[_0x4b1636(0x1104)][_0x4b1636(0x4db)]=_0xd41988?'none':'block',document[_0x4b1636(0x458)]('inject-thought-group')[_0x4b1636(0x1104)][_0x4b1636(0x4db)]=_0xd41988?_0x4b1636(0x464):_0x4b1636(0x1188),document['getElementById'](_0x4b1636(0x496))[_0x4b1636(0x1104)]['display']=_0xd41988?_0x4b1636(0x464):'block',document['getElementById'](_0x4b1636(0x124a))[_0x4b1636(0x1104)]['display']=_0xd41988?_0x4b1636(0x464):_0x4b1636(0x1188),document[_0x4b1636(0x458)]('group-cooldown-group')['style'][_0x4b1636(0x4db)]=_0xd41988?_0x4b1636(0x1188):_0x4b1636(0x464),document['getElementById'](_0x4b1636(0x74e))['value']=_0x2aa4a4[_0x4b1636(0x132a)],document[_0x4b1636(0x458)](_0x4b1636(0x1349))[_0x4b1636(0x8dd)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x65f)],document['getElementById'](_0x4b1636(0x3c6))[_0x4b1636(0x577)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0xa6)]||(_0xd41988?_0x502840:_0x4fd084),document[_0x4b1636(0x458)](_0x4b1636(0x13f7))[_0x4b1636(0x8dd)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x125c)],document[_0x4b1636(0x458)](_0x4b1636(0xb89))[_0x4b1636(0x8dd)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x912)]||0xa;const _0x2600f1=document['getElementById'](_0x4b1636(0xddc)),_0x59d615=document['getElementById']('remove-bg-btn');_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x13ed)]?(_0x2600f1[_0x4b1636(0x577)]=_0x2aa4a4['settings'][_0x4b1636(0x13ed)],_0x2600f1[_0x4b1636(0x1104)][_0x4b1636(0x4db)]=_0x4b1636(0x1188),_0x59d615[_0x4b1636(0x1104)][_0x4b1636(0x4db)]=_0x4b1636(0x7bb)):(_0x2600f1[_0x4b1636(0x1104)][_0x4b1636(0x4db)]=_0x4b1636(0x464),_0x59d615[_0x4b1636(0x1104)]['display']=_0x4b1636(0x464));document[_0x4b1636(0x458)](_0x4b1636(0x519))[_0x4b1636(0x1104)]['display']=_0xd41988?'none':_0x4b1636(0x1188),document[_0x4b1636(0x458)](_0x4b1636(0xa0d))['style'][_0x4b1636(0x4db)]=_0xd41988?_0x4b1636(0x464):_0x4b1636(0x1188),document['getElementById'](_0x4b1636(0x109f))['style'][_0x4b1636(0x4db)]=_0xd41988?_0x4b1636(0x1188):_0x4b1636(0x464);const _0x269164=document[_0x4b1636(0x458)](_0x4b1636(0x109b)),_0x208d84=document[_0x4b1636(0x458)](_0x4b1636(0x7e4));_0x269164[_0x4b1636(0x8f7)]=_0x2aa4a4[_0x4b1636(0xda2)]['enableTimePerception'],_0x208d84['style']['display']=_0x269164[_0x4b1636(0x8f7)]?_0x4b1636(0x1188):_0x4b1636(0x464);const _0x3a0693=document[_0x4b1636(0x458)](_0x4b1636(0xd55)),_0x431650=Intl[_0x4b1636(0x11f7)]('timeZone');_0x3a0693[_0x4b1636(0x110d)]='',_0x431650[_0x4b1636(0x12c2)](_0x3ac875=>{const _0x4e2c95=_0x4b1636,_0x269d66=document[_0x4e2c95(0xe7d)](_0x4e2c95(0x790));_0x269d66[_0x4e2c95(0x8dd)]=_0x3ac875,_0x269d66[_0x4e2c95(0x1a2)]=_0x3ac875,_0x3a0693['appendChild'](_0x269d66);}),_0x3a0693['value']=_0x2aa4a4[_0x4b1636(0xda2)]['timeZone']||_0x4b1636(0x12db);if(_0xd41988)document[_0x4b1636(0x458)](_0x4b1636(0xd11))[_0x4b1636(0x8f7)]=_0x2aa4a4['settings'][_0x4b1636(0x12cd)],document[_0x4b1636(0x458)](_0x4b1636(0x15f))[_0x4b1636(0x8dd)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0xc7d)]||'',document[_0x4b1636(0x458)](_0x4b1636(0x1145))[_0x4b1636(0x577)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0xaf7)]||_0x5448a9,document[_0x4b1636(0x458)](_0x4b1636(0x1065))[_0x4b1636(0x8dd)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x9c9)]||0xa,document[_0x4b1636(0x458)](_0x4b1636(0xa0d))[_0x4b1636(0x1104)]['display']=_0x4b1636(0x464),_0x5ef0e8(_0x2aa4a4[_0x4b1636(0xfa8)]);else{document['getElementById']('single-char-background-activity-group')[_0x4b1636(0x1104)][_0x4b1636(0x4db)]=_0x4b1636(0x1188),document[_0x4b1636(0x458)]('char-background-activity-switch')[_0x4b1636(0x8f7)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x12cd)],document[_0x4b1636(0x458)]('inject-thought-toggle')[_0x4b1636(0x8f7)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x6a)];const _0x22309f=document[_0x4b1636(0x458)]('offline-mode-toggle'),_0x17ed68=document[_0x4b1636(0x458)](_0x4b1636(0x100e)),_0x58d6ae=document[_0x4b1636(0x458)](_0x4b1636(0x872)),_0x25a2fe=document[_0x4b1636(0x458)](_0x4b1636(0x281));_0x22309f['checked']=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x11a7)]||![],_0x17ed68[_0x4b1636(0x1104)][_0x4b1636(0x4db)]=_0x22309f[_0x4b1636(0x8f7)]?_0x4b1636(0x1188):_0x4b1636(0x464),_0x58d6ae['value']=_0x2aa4a4[_0x4b1636(0xda2)]['offlineMinLength']||0x64,_0x25a2fe[_0x4b1636(0x8dd)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x280)]||0x12c,await _0x5c8364(_0x2aa4a4),document[_0x4b1636(0x458)](_0x4b1636(0x11ac))[_0x4b1636(0x8dd)]=_0x2aa4a4['originalName'],document[_0x4b1636(0x458)]('ai-voice-id-input')[_0x4b1636(0x8dd)]=_0x2aa4a4['settings'][_0x4b1636(0x1077)]||'',document[_0x4b1636(0x458)](_0x4b1636(0x56a))[_0x4b1636(0x8f7)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x211)]!==![],document[_0x4b1636(0x458)]('ai-persona')[_0x4b1636(0x8dd)]=_0x2aa4a4['settings'][_0x4b1636(0x31d)],document['getElementById'](_0x4b1636(0x1055))['src']=_0x2aa4a4['settings'][_0x4b1636(0x9c7)]||_0x4fd084,document[_0x4b1636(0x458)](_0x4b1636(0xe4f))['value']=_0x2aa4a4['settings'][_0x4b1636(0xc7d)]||'我',document[_0x4b1636(0x458)](_0x4b1636(0x189))['value']=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x9c9)]||0xa;const _0x560665=document['getElementById'](_0x4b1636(0xb0d));_0x560665[_0x4b1636(0x110d)]='<option\x20value=\x22\x22>未分组</option>';const _0x243747=await _0x17d534[_0x4b1636(0x10a5)][_0x4b1636(0x511)]();_0x243747[_0x4b1636(0x12c2)](_0x1f4158=>{const _0x70fac0=_0x4b1636,_0x22727a=document[_0x70fac0(0xe7d)](_0x70fac0(0x790));_0x22727a[_0x70fac0(0x8dd)]=_0x1f4158['id'],_0x22727a['textContent']=_0x1f4158[_0x70fac0(0x132a)];if(_0x2aa4a4[_0x70fac0(0x1437)]===_0x1f4158['id'])_0x22727a[_0x70fac0(0x500)]=!![];_0x560665[_0x70fac0(0x1079)](_0x22727a);});const _0xe95a=_0x2aa4a4[_0x4b1636(0xda2)]['lyricsPosition']||{'vertical':'top','horizontal':_0x4b1636(0x1f3),'offset':0xa};document[_0x4b1636(0x458)](_0x4b1636(0x1054))[_0x4b1636(0x8dd)]=_0xe95a[_0x4b1636(0xdd3)],document['getElementById'](_0x4b1636(0x127c))[_0x4b1636(0x8dd)]=_0xe95a[_0x4b1636(0xf5e)],document[_0x4b1636(0x458)](_0x4b1636(0x9c6))[_0x4b1636(0x8dd)]=_0xe95a[_0x4b1636(0x408)];}const _0x38883=document['getElementById'](_0x4b1636(0x80d));_0x38883[_0x4b1636(0x110d)]='';const [_0x2df07c,_0x12538d]=await Promise[_0x4b1636(0xfe2)]([_0x17d534[_0x4b1636(0x110b)][_0x4b1636(0x511)](),_0x17d534[_0x4b1636(0xab7)][_0x4b1636(0x511)]()]),_0x133dc5=new Set(_0x2aa4a4[_0x4b1636(0xda2)]['linkedWorldBookIds']||[]);if(_0x12538d[_0x4b1636(0x131d)]===0x0)_0x38883['innerHTML']=_0x4b1636(0xf73);else{_0x2df07c[_0x4b1636(0x12c2)](_0x14eb19=>{const _0x280e23=_0x4b1636,_0x48fbf7=_0x12538d['filter'](_0x1dee37=>_0x1dee37[_0x280e23(0x5f7)]===_0x14eb19['id']);if(_0x48fbf7[_0x280e23(0x131d)]>0x0){const _0x345c7b=document[_0x280e23(0xe7d)]('h4');_0x345c7b[_0x280e23(0x1a2)]=_0x14eb19[_0x280e23(0x132a)],_0x345c7b[_0x280e23(0x1104)][_0x280e23(0x11f)]=_0x280e23(0x462),_0x38883['appendChild'](_0x345c7b),_0x48fbf7[_0x280e23(0x12c2)](_0x17420f=>{const _0x404942=_0x280e23,_0x5efe5e=_0x133dc5[_0x404942(0x31c)](_0x17420f['id']),_0x103ea7=document[_0x404942(0xe7d)](_0x404942(0x11af));_0x103ea7[_0x404942(0x110d)]=_0x404942(0x10fd)+_0x17420f['id']+'\x22\x20'+(_0x5efe5e?'checked':'')+'>\x20'+_0x17420f[_0x404942(0x132a)],_0x38883['appendChild'](_0x103ea7);});}});const _0x1cc463=_0x12538d[_0x4b1636(0xaf1)](_0x1ed6da=>!_0x1ed6da[_0x4b1636(0x5f7)]);if(_0x1cc463[_0x4b1636(0x131d)]>0x0){const _0xe9eade=document[_0x4b1636(0xe7d)]('h4');_0xe9eade['textContent']=_0x4b1636(0x548),_0xe9eade[_0x4b1636(0x1104)][_0x4b1636(0x11f)]=_0x4b1636(0x120a),_0x38883[_0x4b1636(0x1079)](_0xe9eade),_0x1cc463[_0x4b1636(0x12c2)](_0x377a01=>{const _0x37b530=_0x4b1636,_0xffdfcb=_0x133dc5[_0x37b530(0x31c)](_0x377a01['id']),_0x4591c9=document['createElement']('label');_0x4591c9[_0x37b530(0x110d)]=_0x37b530(0x10fd)+_0x377a01['id']+'\x22\x20'+(_0xffdfcb?_0x37b530(0x8f7):'')+'>\x20'+_0x377a01['name'],_0x38883['appendChild'](_0x4591c9);});}}_0x4f8e8c();const _0x20dab4=document[_0x4b1636(0x458)](_0x4b1636(0x1468)),_0x2db705=document[_0x4b1636(0x458)](_0x4b1636(0xdf4)),_0x13d947=document[_0x4b1636(0x458)](_0x4b1636(0x10bd)),_0x19cecd=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x1448)]||[];_0x20dab4[_0x4b1636(0x8f7)]=_0x19cecd[_0x4b1636(0x131d)]>0x0,_0x2db705[_0x4b1636(0x1104)][_0x4b1636(0x4db)]=_0x20dab4[_0x4b1636(0x8f7)]?_0x4b1636(0x1188):_0x4b1636(0x464),_0x13d947[_0x4b1636(0x110d)]='',Object['values'](_0x42f206[_0x4b1636(0x954)])[_0x4b1636(0x12c2)](_0x31492f=>{const _0x172ef5=_0x4b1636;if(_0x31492f['id']===_0x2aa4a4['id'])return;const _0x5d1d3f=_0x19cecd[_0x172ef5(0xd8d)](_0x31492f['id']),_0x16ac09=_0x31492f[_0x172ef5(0x726)]?_0x172ef5(0x13f3):_0x172ef5(0x35c),_0x18ef2c=document[_0x172ef5(0xe7d)]('label');_0x18ef2c[_0x172ef5(0x110d)]=_0x172ef5(0xf6)+_0x31492f['id']+'\x22\x20'+(_0x5d1d3f?_0x172ef5(0x8f7):'')+'>\x20'+_0x16ac09+'\x20'+_0x31492f[_0x172ef5(0x132a)],_0x13d947[_0x172ef5(0x1079)](_0x18ef2c);});function _0x5de92d(){const _0x225ddf=_0x4b1636,_0x5cb0a0=_0x13d947[_0x225ddf(0x102a)](_0x225ddf(0x18b)),_0x38d8a8=_0x2db705[_0x225ddf(0x586)](_0x225ddf(0xa66));if(_0x5cb0a0[_0x225ddf(0x131d)]===0x0)_0x38d8a8[_0x225ddf(0x1a2)]='--\x20点击选择\x20--';else _0x5cb0a0[_0x225ddf(0x131d)]>0x2?_0x38d8a8[_0x225ddf(0x1a2)]=_0x225ddf(0x103c)+_0x5cb0a0[_0x225ddf(0x131d)]+'\x20项':_0x38d8a8[_0x225ddf(0x1a2)]=Array[_0x225ddf(0xca2)](_0x5cb0a0)['map'](_0x4a1602=>_0x4a1602[_0x225ddf(0x1389)][_0x225ddf(0x1a2)]['trim']())[_0x225ddf(0x56c)](',\x20');}_0x5de92d(),_0x20dab4[_0x4b1636(0xd85)](_0x4b1636(0x26a),()=>{const _0x161ea3=_0x4b1636;_0x2db705[_0x161ea3(0x1104)][_0x161ea3(0x4db)]=_0x20dab4[_0x161ea3(0x8f7)]?_0x161ea3(0x1188):'none';});const _0x3049e8=_0x2db705[_0x4b1636(0x586)](_0x4b1636(0xe9)),_0x14cf1a=_0x3049e8[_0x4b1636(0x350)](!![]);_0x3049e8[_0x4b1636(0x135e)][_0x4b1636(0x3f2)](_0x14cf1a,_0x3049e8),_0x14cf1a[_0x4b1636(0xd85)](_0x4b1636(0x1122),_0x341d36=>{const _0x2e33f8=_0x4b1636;_0x341d36[_0x2e33f8(0x58e)](),_0x13d947[_0x2e33f8(0x11c2)][_0x2e33f8(0x1270)](_0x2e33f8(0x67d)),_0x14cf1a[_0x2e33f8(0x11c2)][_0x2e33f8(0x1270)](_0x2e33f8(0x21c));}),_0x13d947[_0x4b1636(0xd85)]('change',_0x5de92d);const _0x2b4264=document['querySelector'](_0x4b1636(0x2d7)+(_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0xbdc)]||_0x4b1636(0x1121))+'\x22]');if(_0x2b4264)_0x2b4264[_0x4b1636(0x8f7)]=!![];const _0x348b95=document[_0x4b1636(0x458)](_0x4b1636(0x3da));_0x348b95[_0x4b1636(0x8dd)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0xecd)]||0xd,document[_0x4b1636(0x458)]('font-size-value')[_0x4b1636(0x1a2)]=_0x348b95[_0x4b1636(0x8dd)]+'px';const _0x3d8f1d=document[_0x4b1636(0x458)](_0x4b1636(0x11bf));_0x3d8f1d['value']=_0x2aa4a4['settings'][_0x4b1636(0x7df)]||'',_0x83553f(),document[_0x4b1636(0x458)](_0x4b1636(0x813))[_0x4b1636(0x8f7)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x8fd)]||![],document[_0x4b1636(0x458)](_0x4b1636(0x13e5))[_0x4b1636(0x8dd)]=_0x2aa4a4[_0x4b1636(0xda2)][_0x4b1636(0x359)]||0x14,setTimeout(()=>{const _0x5702e5=_0x4b1636;_0xd65be6();const _0x2632ff=['ai-persona',_0x5702e5(0x1349),'max-memory',_0x5702e5(0xb89),_0x5702e5(0x813),_0x5702e5(0x13e5),_0x5702e5(0xcfb),_0x5702e5(0x872),_0x5702e5(0x281),'offline-preset-select'];_0x2632ff[_0x5702e5(0x12c2)](_0x109cbd=>{const _0x23e6d6=_0x5702e5,_0x438b55=document[_0x23e6d6(0x458)](_0x109cbd);_0x438b55&&_0x438b55[_0x23e6d6(0xd85)](_0x23e6d6(0x754),_0xd65be6);}),document[_0x5702e5(0x458)](_0x5702e5(0x80d))[_0x5702e5(0xd85)](_0x5702e5(0x26a),_0xd65be6),document[_0x5702e5(0x458)](_0x5702e5(0x10bd))[_0x5702e5(0xd85)](_0x5702e5(0x26a),_0xd65be6),document['getElementById'](_0x5702e5(0x1468))[_0x5702e5(0xd85)](_0x5702e5(0x26a),_0xd65be6);},0x64),_0x589d88(_0x4b1636(0x5d8));});function _0x5ef0e8(_0x4b6f9c){const _0x415eb3=_0x5897a1,_0x276326=document[_0x415eb3(0x458)](_0x415eb3(0x1039));_0x276326[_0x415eb3(0x110d)]='',_0x4b6f9c[_0x415eb3(0x12c2)](_0x28174c=>{const _0x2ee14e=_0x415eb3,_0x186b10=document[_0x2ee14e(0xe7d)](_0x2ee14e(0x1323));_0x186b10[_0x2ee14e(0x69b)]=_0x2ee14e(0xf02),_0x186b10[_0x2ee14e(0x1f4)][_0x2ee14e(0x1c9)]=_0x28174c['id'];const _0x45257e=_0x28174c[_0x2ee14e(0x5c6)]||(_0x42f206['chats'][_0x28174c['id']]?_0x42f206[_0x2ee14e(0x954)][_0x28174c['id']][_0x2ee14e(0xda2)][_0x2ee14e(0x9c7)]:_0x482806);_0x186b10['innerHTML']=_0x2ee14e(0xfa9)+_0x45257e+_0x2ee14e(0x298)+_0x28174c['groupNickname']+_0x2ee14e(0x135b)+_0x28174c[_0x2ee14e(0x1118)]+_0x2ee14e(0xb44),_0x186b10['addEventListener'](_0x2ee14e(0x1122),()=>_0x2b4039(_0x28174c['id'])),_0x276326[_0x2ee14e(0x1079)](_0x186b10);});}document[_0x5897a1(0x458)](_0x5897a1(0x75e))['addEventListener'](_0x5897a1(0x1122),async()=>{const _0x5b7e06=_0x5897a1;if(!_0x3b3bcb)return;const _0x4f180e=_0x42f206[_0x5b7e06(0x954)][_0x42f206[_0x5b7e06(0x81d)]],_0x410d7b=_0x4f180e[_0x5b7e06(0xfa8)]['find'](_0x159a1a=>_0x159a1a['id']===_0x3b3bcb);if(!_0x410d7b)return;const _0x12385e=document[_0x5b7e06(0x458)]('member-name-input')['value'][_0x5b7e06(0x2aa)]();if(!_0x12385e){alert(_0x5b7e06(0x339));return;}_0x410d7b['groupNickname']=_0x12385e,_0x410d7b[_0x5b7e06(0x124d)]=document[_0x5b7e06(0x458)](_0x5b7e06(0x332))['value'];const _0x43e0f9=document[_0x5b7e06(0x458)](_0x5b7e06(0xdb3))[_0x5b7e06(0x577)];_0x410d7b[_0x5b7e06(0x5c6)]=_0x43e0f9;const _0x2d6b62=_0x42f206['chats'][_0x410d7b['id']];_0x2d6b62&&(_0x2d6b62['settings'][_0x5b7e06(0x9c7)]=_0x43e0f9,await _0x17d534['chats']['put'](_0x2d6b62)),await _0x17d534[_0x5b7e06(0x954)][_0x5b7e06(0xf3f)](_0x4f180e),_0x5ef0e8(_0x4f180e['members']),document[_0x5b7e06(0x458)](_0x5b7e06(0x1344))['classList']['remove'](_0x5b7e06(0x67d)),_0x3b3bcb=null;});function _0x2b4039(_0x1d2d7f){const _0x45f572=_0x5897a1;_0x3b3bcb=_0x1d2d7f;const _0x9f93e7=_0x42f206[_0x45f572(0x954)][_0x42f206[_0x45f572(0x81d)]],_0x4f7aaa=_0x9f93e7[_0x45f572(0xfa8)][_0x45f572(0xb07)](_0x306bf8=>_0x306bf8['id']===_0x1d2d7f);if(!_0x4f7aaa)return;document['getElementById'](_0x45f572(0x1146))['value']=_0x4f7aaa[_0x45f572(0x1118)],document['getElementById'](_0x45f572(0x332))['value']=_0x4f7aaa[_0x45f572(0x124d)];const _0x4af457=_0x4f7aaa['avatar']||(_0x42f206[_0x45f572(0x954)][_0x4f7aaa['id']]?_0x42f206['chats'][_0x4f7aaa['id']]['settings']['aiAvatar']:_0x482806);document['getElementById'](_0x45f572(0xdb3))[_0x45f572(0x577)]=_0x4af457,document[_0x45f572(0x458)]('member-settings-modal')[_0x45f572(0x11c2)]['add'](_0x45f572(0x67d));}document[_0x5897a1(0x458)]('cancel-member-settings-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x289314=_0x5897a1;document['getElementById'](_0x289314(0x1344))[_0x289314(0x11c2)]['remove'](_0x289314(0x67d)),_0x3b3bcb=null;}),document[_0x5897a1(0x458)](_0x5897a1(0x75e))['addEventListener'](_0x5897a1(0x1122),async()=>{const _0x253bc9=_0x5897a1;if(!_0x3b3bcb)return;const _0x2357d9=_0x42f206['chats'][_0x42f206['activeChatId']],_0x45c5a2=_0x2357d9[_0x253bc9(0xfa8)][_0x253bc9(0xb07)](_0x57227d=>_0x57227d['id']===_0x3b3bcb);if(!_0x45c5a2)return;const _0xba8559=document[_0x253bc9(0x458)](_0x253bc9(0x1146))[_0x253bc9(0x8dd)]['trim']();if(!_0xba8559){alert(_0x253bc9(0x339));return;}_0x45c5a2[_0x253bc9(0x1118)]=_0xba8559,_0x45c5a2[_0x253bc9(0x124d)]=document[_0x253bc9(0x458)](_0x253bc9(0x332))[_0x253bc9(0x8dd)];const _0x184d70=document[_0x253bc9(0x458)](_0x253bc9(0xdb3))['src'];_0x45c5a2[_0x253bc9(0x5c6)]=_0x184d70;const _0x55b415=_0x42f206[_0x253bc9(0x954)][_0x45c5a2['id']];_0x55b415&&(_0x55b415[_0x253bc9(0xda2)][_0x253bc9(0x9c7)]=_0x184d70,await _0x17d534[_0x253bc9(0x954)]['put'](_0x55b415)),await _0x17d534[_0x253bc9(0x954)][_0x253bc9(0xf3f)](_0x2357d9),_0x5ef0e8(_0x2357d9[_0x253bc9(0xfa8)]),document[_0x253bc9(0x458)](_0x253bc9(0x1344))[_0x253bc9(0x11c2)]['remove'](_0x253bc9(0x67d)),_0x3b3bcb=null;}),document['getElementById'](_0x5897a1(0xc40))[_0x5897a1(0xd85)]('click',()=>{const _0xfd2e49=_0x5897a1;document['getElementById'](_0xfd2e49(0x1222))[_0xfd2e49(0x8f7)]=!![];}),document['getElementById'](_0x5897a1(0x48d))['addEventListener'](_0x5897a1(0x1122),async()=>{const _0x4c3c15=_0x5897a1;if(!_0x42f206['activeChatId'])return;const _0x2c3499=_0x42f206[_0x4c3c15(0x954)][_0x42f206[_0x4c3c15(0x81d)]],_0x27b5d1=_0x2c3499[_0x4c3c15(0xda2)]['isOfflineMode']||![],_0x4888fb=document[_0x4c3c15(0x458)](_0x4c3c15(0x74e))['value']['trim']();if(!_0x4888fb)return alert(_0x4c3c15(0x178));if(!_0x2c3499[_0x4c3c15(0x726)]&&_0x4888fb!==_0x2c3499[_0x4c3c15(0x132a)]){if(!_0x2c3499[_0x4c3c15(0x103)])_0x2c3499['nameHistory']=[];if(!_0x2c3499[_0x4c3c15(0x103)][_0x4c3c15(0xd8d)](_0x2c3499['name']))_0x2c3499[_0x4c3c15(0x103)][_0x4c3c15(0x129e)](_0x2c3499[_0x4c3c15(0x132a)]);}_0x2c3499[_0x4c3c15(0x132a)]=_0x4888fb;const _0x20c88d=document[_0x4c3c15(0x586)](_0x4c3c15(0x33d));_0x2c3499['settings'][_0x4c3c15(0xbdc)]=_0x20c88d?_0x20c88d[_0x4c3c15(0x8dd)]:'default',_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0xecd)]=parseInt(document[_0x4c3c15(0x458)](_0x4c3c15(0x3da))[_0x4c3c15(0x8dd)]),_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0x7df)]=document[_0x4c3c15(0x458)](_0x4c3c15(0x11bf))[_0x4c3c15(0x8dd)][_0x4c3c15(0x2aa)](),_0x2c3499[_0x4c3c15(0xda2)]['myPersona']=document[_0x4c3c15(0x458)](_0x4c3c15(0x1349))[_0x4c3c15(0x8dd)],_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0xa6)]=document['getElementById'](_0x4c3c15(0x3c6))[_0x4c3c15(0x577)],_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0x125c)]=parseInt(document['getElementById'](_0x4c3c15(0x13f7))[_0x4c3c15(0x8dd)])||0xa,_0x2c3499['settings']['linkedMemoryCount']=parseInt(document['getElementById'](_0x4c3c15(0xb89))[_0x4c3c15(0x8dd)])||0xa;const _0x420df0=document['querySelectorAll'](_0x4c3c15(0xa36)),_0x21adba=[];_0x420df0[_0x4c3c15(0x12c2)](_0x2f0aab=>{const _0x3cd55c=_0x4c3c15;_0x2f0aab[_0x3cd55c(0x8dd)][_0x3cd55c(0x13ad)](_0x3cd55c(0x549))&&_0x21adba['push'](_0x2f0aab[_0x3cd55c(0x8dd)]['replace'](_0x3cd55c(0x549),''));}),_0x2c3499['settings'][_0x4c3c15(0x315)]=_0x21adba;const _0x99d21e=document[_0x4c3c15(0x458)](_0x4c3c15(0x1468))['checked'];if(_0x99d21e){const _0x2a675d=document[_0x4c3c15(0x102a)]('#linked-chats-checkboxes-container\x20input:checked');_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0x1448)]=Array[_0x4c3c15(0xca2)](_0x2a675d)[_0x4c3c15(0xbf6)](_0x11293b=>_0x11293b[_0x4c3c15(0x8dd)]);}else _0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0x1448)]=[];_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0x8fd)]=document[_0x4c3c15(0x458)](_0x4c3c15(0x813))[_0x4c3c15(0x8f7)],_0x2c3499['settings']['autoMemoryInterval']=parseInt(document['getElementById'](_0x4c3c15(0x13e5))[_0x4c3c15(0x8dd)])||0x14,_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0x219)]=document[_0x4c3c15(0x458)]('time-perception-toggle')[_0x4c3c15(0x8f7)],_0x2c3499['settings'][_0x4c3c15(0xc7a)]=document[_0x4c3c15(0x458)](_0x4c3c15(0xd55))[_0x4c3c15(0x8dd)];if(_0x2c3499[_0x4c3c15(0x726)])_0x2c3499['settings'][_0x4c3c15(0x12cd)]=document[_0x4c3c15(0x458)](_0x4c3c15(0xd11))[_0x4c3c15(0x8f7)],_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0xc7d)]=document['getElementById'](_0x4c3c15(0x15f))[_0x4c3c15(0x8dd)]['trim'](),_0x2c3499[_0x4c3c15(0xda2)]['groupAvatar']=document[_0x4c3c15(0x458)](_0x4c3c15(0x1145))[_0x4c3c15(0x577)],_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0x9c9)]=parseInt(document['getElementById']('group-action-cooldown-input')[_0x4c3c15(0x8dd)])||0xa;else{_0x2c3499['settings']['enableBackgroundActivity']=document['getElementById']('char-background-activity-switch')[_0x4c3c15(0x8f7)];const _0x1e13e6=document['getElementById'](_0x4c3c15(0xcfb))[_0x4c3c15(0x8f7)];_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0x11a7)]=_0x1e13e6;if(_0x27b5d1===!![]&&_0x1e13e6===![]){const _0x4c9aa4={'role':_0x4c3c15(0x1370),'content':'[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','timestamp':Date[_0x4c3c15(0x606)](),'isHidden':!![]};_0x2c3499['history'][_0x4c3c15(0x129e)](_0x4c9aa4),console['log'](_0x4c3c15(0x13f5));}_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0x6a)]=document[_0x4c3c15(0x458)](_0x4c3c15(0x1169))[_0x4c3c15(0x8f7)],_0x2c3499['settings']['offlineMinLength']=parseInt(document[_0x4c3c15(0x458)](_0x4c3c15(0x872))['value'])||0x64,_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0x280)]=parseInt(document[_0x4c3c15(0x458)](_0x4c3c15(0x281))[_0x4c3c15(0x8dd)])||0x12c,_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0xd13)]=document[_0x4c3c15(0x458)](_0x4c3c15(0xf00))[_0x4c3c15(0x8dd)]||null;const _0x9b3348=document['getElementById'](_0x4c3c15(0x11ac))[_0x4c3c15(0x8dd)][_0x4c3c15(0x2aa)]();if(!_0x9b3348)return alert(_0x4c3c15(0x1454));_0x2c3499[_0x4c3c15(0xa1)]=_0x9b3348,_0x2c3499['settings']['aiPersona']=document[_0x4c3c15(0x458)](_0x4c3c15(0xd54))['value'],_0x2c3499['settings'][_0x4c3c15(0x1077)]=document[_0x4c3c15(0x458)](_0x4c3c15(0xb67))[_0x4c3c15(0x8dd)][_0x4c3c15(0x2aa)](),_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0x211)]=document[_0x4c3c15(0x458)](_0x4c3c15(0x56a))[_0x4c3c15(0x8f7)],_0x2c3499['settings'][_0x4c3c15(0x9c7)]=document[_0x4c3c15(0x458)](_0x4c3c15(0x1055))[_0x4c3c15(0x577)],_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0xc7d)]=document[_0x4c3c15(0x458)]('my-nickname-input')['value'][_0x4c3c15(0x2aa)]()||'我',_0x2c3499['settings']['actionCooldownMinutes']=parseInt(document[_0x4c3c15(0x458)](_0x4c3c15(0x189))[_0x4c3c15(0x8dd)])||0xa,_0x2c3499[_0x4c3c15(0xda2)]['lyricsPosition']={'vertical':document[_0x4c3c15(0x458)](_0x4c3c15(0x1054))[_0x4c3c15(0x8dd)],'horizontal':document[_0x4c3c15(0x458)](_0x4c3c15(0x127c))['value'],'offset':parseInt(document[_0x4c3c15(0x458)](_0x4c3c15(0x9c6))[_0x4c3c15(0x8dd)])||0xa};const _0xa3e294=document[_0x4c3c15(0x458)](_0x4c3c15(0xb0d))[_0x4c3c15(0x8dd)];_0x2c3499['groupId']=_0xa3e294?parseInt(_0xa3e294):null;}await _0x17d534['chats'][_0x4c3c15(0xf3f)](_0x2c3499),!_0x2c3499['isGroup']&&(await _0x5bef7a(_0x2c3499),await _0x249add(_0x2c3499)),_0x1c0fcf(_0x2c3499),_0x1ff070(_0x2c3499[_0x4c3c15(0xda2)][_0x4c3c15(0x7df)],_0x4c3c15(0xf66),'custom-bubble-style'),_0x589d88(_0x4c3c15(0xd99)),_0x359c96(_0x42f206['activeChatId']),_0x27be5e();}),document[_0x5897a1(0x458)](_0x5897a1(0x5d8))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x3f4fe6=>{const _0x2cf52f=_0x5897a1;_0x3f4fe6[_0x2cf52f(0x12df)][_0x2cf52f(0x11c2)]['contains'](_0x2cf52f(0x113f))&&_0x21c48c(_0x2cf52f(0x10f6));}),document[_0x5897a1(0x458)](_0x5897a1(0x1344))[_0x5897a1(0xd85)]('click',_0x834aa3=>{const _0x39f6f6=_0x5897a1;_0x834aa3[_0x39f6f6(0x12df)]['classList'][_0x39f6f6(0x526)]('change-frame-btn')&&_0x21c48c(_0x39f6f6(0x59e));});const _0x30a454=document[_0x5897a1(0x458)](_0x5897a1(0x1269)),_0x51ee61=document[_0x5897a1(0x458)](_0x5897a1(0xaf8)),_0x2b1a78=document[_0x5897a1(0x458)](_0x5897a1(0x2fd)),_0x34b40c=document[_0x5897a1(0x458)](_0x5897a1(0x375)),_0x232d5c=document[_0x5897a1(0x458)]('my-frame-content');document[_0x5897a1(0x458)](_0x5897a1(0x379))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x263dcb),document['getElementById'](_0x5897a1(0x506))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x4b0f15=_0x5897a1;_0x30a454['classList']['remove'](_0x4b0f15(0x67d)),_0x1ccdc4=![];}),_0x51ee61[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x558e5b=_0x5897a1;_0x51ee61[_0x558e5b(0x11c2)][_0x558e5b(0xa58)](_0x558e5b(0xfe1)),_0x2b1a78[_0x558e5b(0x11c2)][_0x558e5b(0x1097)]('active'),_0x34b40c['style'][_0x558e5b(0x4db)]=_0x558e5b(0x1188),_0x232d5c[_0x558e5b(0x1104)]['display']=_0x558e5b(0x464);}),_0x2b1a78[_0x5897a1(0xd85)]('click',()=>{const _0xc12584=_0x5897a1;_0x2b1a78['classList'][_0xc12584(0xa58)]('active'),_0x51ee61[_0xc12584(0x11c2)]['remove'](_0xc12584(0xfe1)),_0x232d5c[_0xc12584(0x1104)][_0xc12584(0x4db)]=_0xc12584(0x1188),_0x34b40c[_0xc12584(0x1104)][_0xc12584(0x4db)]=_0xc12584(0x464);}),document[_0x5897a1(0x458)](_0x5897a1(0xed5))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x58d945=_0x5897a1;if(!_0x42f206[_0x58d945(0x81d)])return;const _0x380398=_0x42f206[_0x58d945(0x954)][_0x42f206[_0x58d945(0x81d)]],_0x42680f=await _0x2532b9('清空聊天记录',_0x58d945(0x1189),{'confirmButtonClass':'btn-danger'});_0x42680f&&(_0x380398[_0x58d945(0x1d5)]=[],_0x380398[_0x58d945(0xb0f)]='...',_0x380398[_0x58d945(0x8eb)]='...',await _0x17d534[_0x58d945(0x954)]['put'](_0x380398),_0x359c96(_0x42f206[_0x58d945(0x81d)]),_0x27be5e(),_0x51c816[_0x58d945(0x11c2)][_0x58d945(0x1097)](_0x58d945(0x67d)));});const _0x3fed24=(_0x23f303,_0x2e05b6)=>{const _0x37ade3=_0x5897a1;document['getElementById'](_0x23f303)['addEventListener'](_0x37ade3(0x26a),async _0x348a35=>{const _0x572e1c=_0x37ade3,_0x18fc75=_0x348a35[_0x572e1c(0x12df)][_0x572e1c(0x1a9)][0x0];if(_0x18fc75){const _0x3f9a3e=await new Promise((_0x124322,_0x5c9d01)=>{const _0x2e6f51=_0x572e1c,_0x56fbc3=new FileReader();_0x56fbc3[_0x2e6f51(0x11fa)]=()=>_0x124322(_0x56fbc3[_0x2e6f51(0x2ed)]),_0x56fbc3[_0x2e6f51(0x4de)]=()=>_0x5c9d01(_0x56fbc3[_0x2e6f51(0xb61)]),_0x56fbc3['readAsDataURL'](_0x18fc75);});_0x2e05b6(_0x3f9a3e),_0x348a35['target'][_0x572e1c(0x8dd)]=null;}});};_0x3fed24(_0x5897a1(0xda5),_0x303ec8=>document[_0x5897a1(0x458)](_0x5897a1(0x1055))['src']=_0x303ec8),_0x3fed24('my-avatar-input',_0xefbfa0=>document['getElementById'](_0x5897a1(0x3c6))[_0x5897a1(0x577)]=_0xefbfa0),_0x3fed24(_0x5897a1(0x214),_0x16b13f=>document[_0x5897a1(0x458)](_0x5897a1(0x1145))[_0x5897a1(0x577)]=_0x16b13f),_0x3fed24('member-avatar-input',_0x3fe629=>document[_0x5897a1(0x458)]('member-avatar-preview')[_0x5897a1(0x577)]=_0x3fe629),_0x3fed24(_0x5897a1(0xcc3),_0x3d7d34=>{const _0x2d2640=_0x5897a1;if(_0x42f206[_0x2d2640(0x81d)]){_0x42f206[_0x2d2640(0x954)][_0x42f206[_0x2d2640(0x81d)]][_0x2d2640(0xda2)]['background']=_0x3d7d34;const _0x3a4979=document[_0x2d2640(0x458)](_0x2d2640(0xddc));_0x3a4979[_0x2d2640(0x577)]=_0x3d7d34,_0x3a4979[_0x2d2640(0x1104)][_0x2d2640(0x4db)]=_0x2d2640(0x1188),document[_0x2d2640(0x458)](_0x2d2640(0xdeb))[_0x2d2640(0x1104)][_0x2d2640(0x4db)]=_0x2d2640(0x7bb);}}),_0x3fed24(_0x5897a1(0x791),_0x4b4e8c=>document[_0x5897a1(0x458)](_0x5897a1(0x570))[_0x5897a1(0x577)]=_0x4b4e8c),document[_0x5897a1(0x458)](_0x5897a1(0xdeb))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x4058d1=_0x5897a1;if(_0x42f206['activeChatId']){_0x42f206['chats'][_0x42f206[_0x4058d1(0x81d)]]['settings'][_0x4058d1(0x13ed)]='';const _0x1c1f84=document[_0x4058d1(0x458)]('bg-preview');_0x1c1f84['src']='',_0x1c1f84[_0x4058d1(0x1104)][_0x4058d1(0x4db)]=_0x4058d1(0x464),document[_0x4058d1(0x458)]('remove-bg-btn')[_0x4058d1(0x1104)][_0x4058d1(0x4db)]=_0x4058d1(0x464);}});const _0x4665bf=document[_0x5897a1(0x458)](_0x5897a1(0x45c));document[_0x5897a1(0x458)](_0x5897a1(0xa89))[_0x5897a1(0xd85)]('click',()=>{const _0x526753=_0x5897a1,_0x24f977=_0x42f206[_0x526753(0x954)][_0x42f206[_0x526753(0x81d)]];_0x24f977&&_0x24f977[_0x526753(0xda2)][_0x526753(0x168)]?_0x414f54=_0x24f977['settings'][_0x526753(0x168)]:_0x414f54=_0x526753(0xfe2),_0x410b06(),_0x4665bf[_0x526753(0x11c2)][_0x526753(0xa58)](_0x526753(0x67d));}),document['getElementById'](_0x5897a1(0xa8b))[_0x5897a1(0xd85)]('click',()=>_0x4665bf['classList']['remove']('visible')),document[_0x5897a1(0x458)]('add-sticker-batch-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x1ff94e),document[_0x5897a1(0x458)](_0x5897a1(0x93e))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>document[_0x5897a1(0x458)](_0x5897a1(0xa86))[_0x5897a1(0x1122)]()),document[_0x5897a1(0x458)](_0x5897a1(0xa86))[_0x5897a1(0xd85)](_0x5897a1(0x26a),async _0x134f35=>{const _0x40634d=_0x5897a1,_0x199e83=_0x134f35['target'][_0x40634d(0x1a9)][0x0];if(!_0x199e83)return;const _0x15f289=new FileReader();_0x15f289[_0x40634d(0x96e)](_0x199e83),_0x15f289[_0x40634d(0x11fa)]=async()=>{const _0x1a6a68=_0x40634d,_0x552453=_0x15f289[_0x1a6a68(0x2ed)],_0x58bfe9=await _0x335e57('命名表情',_0x1a6a68(0x4b6));if(_0x58bfe9&&_0x58bfe9[_0x1a6a68(0x2aa)]()){const _0x22bd4d={'id':_0x1a6a68(0x5b7)+Date[_0x1a6a68(0x606)](),'url':_0x552453,'name':_0x58bfe9[_0x1a6a68(0x2aa)](),'categoryId':_0x414f54!==_0x1a6a68(0xfe2)&&_0x414f54!==_0x1a6a68(0xbff)?_0x414f54:null};await _0x17d534[_0x1a6a68(0x1294)][_0x1a6a68(0xa58)](_0x22bd4d),_0x42f206['userStickers'][_0x1a6a68(0x129e)](_0x22bd4d),_0x410b06();}else{if(_0x58bfe9!==null)alert(_0x1a6a68(0x3f6));}},_0x134f35[_0x40634d(0x12df)]['value']=null;}),document[_0x5897a1(0x458)](_0x5897a1(0xa5f))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>document['getElementById'](_0x5897a1(0x4f4))[_0x5897a1(0x1122)]()),document[_0x5897a1(0x458)](_0x5897a1(0x4f4))[_0x5897a1(0xd85)](_0x5897a1(0x26a),async _0x2d6643=>{const _0x492e3f=_0x5897a1,_0xef2b8a=_0x2d6643[_0x492e3f(0x12df)]['files'][0x0];if(!_0xef2b8a||!_0x42f206[_0x492e3f(0x81d)])return;const _0x119523=new FileReader();_0x119523[_0x492e3f(0x11fa)]=async _0x395c31=>{const _0x34c5c4=_0x492e3f,_0x180c86=_0x395c31['target'][_0x34c5c4(0x2ed)],_0x65430c=_0x42f206[_0x34c5c4(0x954)][_0x42f206[_0x34c5c4(0x81d)]],_0x5beb31={'role':_0x34c5c4(0xf86),'content':[{'type':'image_url','image_url':{'url':_0x180c86}}],'timestamp':Date[_0x34c5c4(0x606)]()};_0x65430c['history'][_0x34c5c4(0x129e)](_0x5beb31),await _0x17d534[_0x34c5c4(0x954)][_0x34c5c4(0xf3f)](_0x65430c),_0x5d5ee2(_0x5beb31,_0x65430c),_0x27be5e();},_0x119523[_0x492e3f(0x96e)](_0xef2b8a),_0x2d6643[_0x492e3f(0x12df)][_0x492e3f(0x8dd)]=null;}),document[_0x5897a1(0x458)](_0x5897a1(0x10df))[_0x5897a1(0xd85)]('click',async()=>{const _0x3c331d=_0x5897a1;if(!_0x42f206[_0x3c331d(0x81d)])return;const _0x2711b6=await _0x335e57(_0x3c331d(0xa5b),_0x3c331d(0xdce));if(_0x2711b6&&_0x2711b6[_0x3c331d(0x2aa)]()){const _0x4e14cc=_0x42f206[_0x3c331d(0x954)][_0x42f206[_0x3c331d(0x81d)]],_0x549863={'role':'user','type':_0x3c331d(0xefa),'content':_0x2711b6[_0x3c331d(0x2aa)](),'timestamp':Date[_0x3c331d(0x606)]()};_0x4e14cc['history']['push'](_0x549863),await _0x17d534[_0x3c331d(0x954)]['put'](_0x4e14cc),_0x5d5ee2(_0x549863,_0x4e14cc),_0x27be5e();}}),document[_0x5897a1(0x458)]('send-photo-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x19d696=_0x5897a1;if(!_0x42f206['activeChatId'])return;const _0x3661d6=await _0x335e57(_0x19d696(0xb8e),_0x19d696(0x318));if(_0x3661d6&&_0x3661d6[_0x19d696(0x2aa)]()){const _0x4ec995=_0x42f206[_0x19d696(0x954)][_0x42f206[_0x19d696(0x81d)]],_0xb1979d={'role':_0x19d696(0xf86),'type':_0x19d696(0x305),'content':_0x3661d6['trim'](),'timestamp':Date[_0x19d696(0x606)]()};_0x4ec995[_0x19d696(0x1d5)][_0x19d696(0x129e)](_0xb1979d),await _0x17d534[_0x19d696(0x954)]['put'](_0x4ec995),_0x5d5ee2(_0xb1979d,_0x4ec995),_0x27be5e();}});const _0xa23880=document[_0x5897a1(0x458)](_0x5897a1(0xd53));document[_0x5897a1(0x458)]('send-waimai-request-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x8906f9=_0x5897a1;_0xa23880[_0x8906f9(0x11c2)][_0x8906f9(0xa58)](_0x8906f9(0x67d));}),_0xa23880[_0x5897a1(0xd85)]('click',_0x1725f3=>{const _0x3eb05a=_0x5897a1;_0x1725f3[_0x3eb05a(0x12df)]===_0xa23880&&_0xa23880[_0x3eb05a(0x11c2)]['remove']('visible');}),document[_0x5897a1(0x458)](_0x5897a1(0x64e))['addEventListener'](_0x5897a1(0x1122),_0x4d2f70),document[_0x5897a1(0x458)](_0x5897a1(0x6d9))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x23514b=_0x5897a1;if(!_0x42f206['activeChatId'])return;const _0x4e0da1=document[_0x23514b(0x458)](_0x23514b(0x13fa)),_0x23e56c=document[_0x23514b(0x458)]('waimai-amount'),_0x6a42ee=_0x4e0da1[_0x23514b(0x8dd)][_0x23514b(0x2aa)](),_0x4504cc=parseFloat(_0x23e56c[_0x23514b(0x8dd)]);if(!_0x6a42ee||isNaN(_0x4504cc)||_0x4504cc<=0x0){alert(_0x23514b(0x86c));return;}const _0x3e8d9a=_0x42f206[_0x23514b(0x954)][_0x42f206[_0x23514b(0x81d)]],_0x46f24e=Date['now'](),_0x593995=_0x3e8d9a['isGroup']?_0x3e8d9a[_0x23514b(0xda2)]['myNickname']||'我':'我',_0x3b9540={'role':'user','senderName':_0x593995,'type':_0x23514b(0x1128),'productInfo':_0x6a42ee,'amount':_0x4504cc,'status':_0x23514b(0xdaa),'countdownEndTime':_0x46f24e+0xf*0x3c*0x3e8,'timestamp':_0x46f24e};_0x3e8d9a[_0x23514b(0x1d5)][_0x23514b(0x129e)](_0x3b9540),await _0x17d534[_0x23514b(0x954)]['put'](_0x3e8d9a),_0x5d5ee2(_0x3b9540,_0x3e8d9a),_0x27be5e(),_0x4e0da1['value']='',_0x23e56c[_0x23514b(0x8dd)]='',_0xa23880[_0x23514b(0x11c2)][_0x23514b(0x1097)](_0x23514b(0x67d));}),document[_0x5897a1(0x458)]('open-persona-library-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x22dc58),document[_0x5897a1(0x458)](_0x5897a1(0x96a))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x4141ab),document[_0x5897a1(0x458)](_0x5897a1(0x13b1))['addEventListener']('click',_0x38b283),document[_0x5897a1(0x458)](_0x5897a1(0xb16))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x72817d),document[_0x5897a1(0x458)](_0x5897a1(0x497))['addEventListener']('click',_0x49c1ff),document[_0x5897a1(0x458)](_0x5897a1(0x803))['addEventListener'](_0x5897a1(0x1122),_0x2c47c3),document[_0x5897a1(0x458)]('preset-action-delete')[_0x5897a1(0xd85)]('click',_0x3ce8a0),document[_0x5897a1(0x458)]('preset-action-cancel')[_0x5897a1(0xd85)]('click',_0x2f9fdc),document[_0x5897a1(0x458)](_0x5897a1(0x11be))[_0x5897a1(0xd85)]('click',_0x5bc130),document[_0x5897a1(0x458)](_0x5897a1(0xd05))[_0x5897a1(0xd85)]('click',async()=>{const _0x55a115=_0x5897a1;if(_0x3e3048['size']===0x0)return;const _0x5b3d8f=await _0x2532b9(_0x55a115(0x28e),'确定要删除选中的\x20'+_0x3e3048[_0x55a115(0x12a4)]+_0x55a115(0x2b5),{'confirmButtonClass':'btn-danger'});if(_0x5b3d8f){const _0x40139e=_0x42f206[_0x55a115(0x954)][_0x42f206[_0x55a115(0x81d)]];let _0x39dc6a=[];for(const _0x511587 of _0x3e3048){const _0x2efe7c=_0x40139e[_0x55a115(0x1d5)][_0x55a115(0xb07)](_0x1aeb4c=>_0x1aeb4c['timestamp']===_0x511587);_0x2efe7c&&_0x2efe7c[_0x55a115(0x259)]===_0x55a115(0x670)&&_0x39dc6a['push'](_0x55a115(0x47c)+_0x2efe7c[_0x55a115(0xbc9)]+_0x55a115(0x170)+_0x2efe7c[_0x55a115(0xf16)]+')');}_0x40139e['history']=_0x40139e[_0x55a115(0x1d5)][_0x55a115(0xaf1)](_0x185633=>!_0x3e3048[_0x55a115(0x31c)](_0x185633['timestamp']));let _0x25b2ec=_0x55a115(0x935);_0x39dc6a[_0x55a115(0x131d)]>0x0&&(_0x25b2ec+=_0x55a115(0x1268)+_0x39dc6a[_0x55a115(0x56c)]('；')+'。');_0x25b2ec+='\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。';const _0x18d341={'role':_0x55a115(0x1370),'content':'[系统提示：'+_0x25b2ec+']','timestamp':Date[_0x55a115(0x606)](),'isHidden':!![]};_0x40139e[_0x55a115(0x1d5)][_0x55a115(0x129e)](_0x18d341),await _0x17d534['chats'][_0x55a115(0xf3f)](_0x40139e),_0x359c96(_0x42f206['activeChatId']),_0x27be5e();}}),document[_0x5897a1(0x458)](_0x5897a1(0xdfc))[_0x5897a1(0xd85)]('click',async()=>{const _0x20aba1=_0x5897a1;if(_0x3e3048[_0x20aba1(0x12a4)]===0x0)return;const _0x32d772=await _0x2532b9('彻底删除消息','这将从历史记录中【永久抹除】这\x20'+_0x3e3048['size']+'\x20条消息，AI将完全遗忘它们的存在。确定吗？',{'confirmButtonClass':_0x20aba1(0x4d3),'confirmText':_0x20aba1(0x1326)});if(_0x32d772){const _0x99bb93=_0x42f206[_0x20aba1(0x954)][_0x42f206[_0x20aba1(0x81d)]];_0x99bb93[_0x20aba1(0x1d5)]=_0x99bb93[_0x20aba1(0x1d5)][_0x20aba1(0xaf1)](_0x18bdaf=>!_0x3e3048[_0x20aba1(0x31c)](_0x18bdaf['timestamp'])),await _0x17d534['chats']['put'](_0x99bb93),_0x359c96(_0x42f206['activeChatId']),_0x27be5e();}});const _0x30300c=document[_0x5897a1(0x458)]('font-url-input');_0x30300c['addEventListener'](_0x5897a1(0x754),()=>_0x393d41(_0x30300c['value'][_0x5897a1(0x2aa)](),!![])),document[_0x5897a1(0x458)]('save-font-btn')['addEventListener']('click',async()=>{const _0x504121=_0x5897a1,_0x4d8470=_0x30300c[_0x504121(0x8dd)]['trim']();if(!_0x4d8470){alert(_0x504121(0xe80));return;}_0x393d41(_0x4d8470,![]),_0x42f206['globalSettings'][_0x504121(0xafb)]=_0x4d8470,await _0x17d534[_0x504121(0xf0)]['put'](_0x42f206[_0x504121(0xf0)]),alert('字体已保存并应用！');}),document[_0x5897a1(0x458)](_0x5897a1(0x12f6))[_0x5897a1(0xd85)]('click',_0x40cf5c),document[_0x5897a1(0x102a)]('#chat-list-bottom-nav\x20.nav-item')[_0x5897a1(0x12c2)](_0x5e7aa4=>{const _0x39bc60=_0x5897a1;_0x5e7aa4[_0x39bc60(0xd85)]('click',()=>_0x2ecab9(_0x5e7aa4['dataset'][_0x39bc60(0x88c)]));}),document[_0x5897a1(0x458)](_0x5897a1(0x479))[_0x5897a1(0xd85)]('click',()=>_0x2ecab9('messages-view')),document[_0x5897a1(0x458)]('qzone-nickname')[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x263ea3=_0x5897a1,_0x5b92ad=await _0x335e57(_0x263ea3(0x4f7),'请输入新的昵称',_0x42f206[_0x263ea3(0x551)]['nickname']);_0x5b92ad&&_0x5b92ad[_0x263ea3(0x2aa)]()&&(_0x42f206[_0x263ea3(0x551)][_0x263ea3(0x308)]=_0x5b92ad[_0x263ea3(0x2aa)](),await _0x5ebe5c(),_0x6a6725());}),document[_0x5897a1(0x458)](_0x5897a1(0x865))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>document[_0x5897a1(0x458)](_0x5897a1(0x476))[_0x5897a1(0x1122)]()),document['getElementById'](_0x5897a1(0x501))['addEventListener'](_0x5897a1(0x1122),()=>document[_0x5897a1(0x458)](_0x5897a1(0x715))[_0x5897a1(0x1122)]()),document[_0x5897a1(0x458)](_0x5897a1(0x476))[_0x5897a1(0xd85)]('change',async _0x264900=>{const _0xe4c49d=_0x5897a1,_0x303a9a=_0x264900[_0xe4c49d(0x12df)]['files'][0x0];if(_0x303a9a){const _0x2bb51e=await new Promise(_0x23db6c=>{const _0xd2f6e8=_0xe4c49d,_0x1c9089=new FileReader();_0x1c9089['onload']=()=>_0x23db6c(_0x1c9089[_0xd2f6e8(0x2ed)]),_0x1c9089[_0xd2f6e8(0x96e)](_0x303a9a);});_0x42f206[_0xe4c49d(0x551)][_0xe4c49d(0x5c6)]=_0x2bb51e,await _0x5ebe5c(),_0x6a6725();}_0x264900[_0xe4c49d(0x12df)]['value']=null;}),document['getElementById'](_0x5897a1(0x715))['addEventListener'](_0x5897a1(0x26a),async _0x2ad60e=>{const _0xd2da6c=_0x5897a1,_0x5760a3=_0x2ad60e[_0xd2da6c(0x12df)][_0xd2da6c(0x1a9)][0x0];if(_0x5760a3){const _0x22e4c9=await new Promise(_0xcdef4c=>{const _0x33327b=_0xd2da6c,_0x231254=new FileReader();_0x231254['onload']=()=>_0xcdef4c(_0x231254[_0x33327b(0x2ed)]),_0x231254[_0x33327b(0x96e)](_0x5760a3);});_0x42f206[_0xd2da6c(0x551)][_0xd2da6c(0x72a)]=_0x22e4c9,await _0x5ebe5c(),_0x6a6725();}_0x2ad60e[_0xd2da6c(0x12df)][_0xd2da6c(0x8dd)]=null;}),document[_0x5897a1(0x458)](_0x5897a1(0xe79))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0xba36b1=_0x5897a1;_0x56eadb();const _0x4b5303=document[_0xba36b1(0x458)](_0xba36b1(0xbc4));_0x4b5303[_0xba36b1(0x1f4)][_0xba36b1(0x8d6)]=_0xba36b1(0xb03),_0x4b5303[_0xba36b1(0x586)](_0xba36b1(0xfdd))[_0xba36b1(0x1104)][_0xba36b1(0x4db)]=_0xba36b1(0x464),_0x4b5303['querySelector']('#image-mode-content')[_0xba36b1(0x1104)]['display']=_0xba36b1(0x464),_0x4b5303[_0xba36b1(0x586)](_0xba36b1(0x1a4))[_0xba36b1(0x1104)][_0xba36b1(0x4db)]=_0xba36b1(0x464),_0x4b5303[_0xba36b1(0x586)](_0xba36b1(0x12ed))[_0xba36b1(0x134b)]=_0xba36b1(0xf33);const _0x47b18=document[_0xba36b1(0x458)](_0xba36b1(0x5e7));_0x47b18[_0xba36b1(0x110d)]='';const _0x5a915c=await _0x17d534[_0xba36b1(0x10a5)][_0xba36b1(0x511)]();_0x5a915c[_0xba36b1(0x131d)]>0x0?_0x5a915c['forEach'](_0x1d0f65=>{const _0xccc31d=_0xba36b1,_0x3f2626=document[_0xccc31d(0xe7d)]('label');_0x3f2626[_0xccc31d(0x1104)][_0xccc31d(0x4db)]=_0xccc31d(0x1188),_0x3f2626[_0xccc31d(0x110d)]=_0xccc31d(0x1110)+_0x1d0f65['id']+_0xccc31d(0x382)+_0x1d0f65[_0xccc31d(0x132a)],_0x47b18[_0xccc31d(0x1079)](_0x3f2626);}):_0x47b18['innerHTML']='<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>',_0x4b5303['classList'][_0xba36b1(0xa58)](_0xba36b1(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x921))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x557bea=_0x5897a1;_0x56eadb();const _0x62915e=document[_0x557bea(0x458)](_0x557bea(0xbc4));_0x62915e[_0x557bea(0x1f4)][_0x557bea(0x8d6)]='complex',_0x62915e[_0x557bea(0x586)](_0x557bea(0xfdd))[_0x557bea(0x1104)][_0x557bea(0x4db)]='flex',_0x62915e[_0x557bea(0x586)](_0x557bea(0x303))['classList'][_0x557bea(0xa58)](_0x557bea(0xfe1)),_0x62915e[_0x557bea(0x586)](_0x557bea(0x1a4))[_0x557bea(0x11c2)]['remove'](_0x557bea(0xfe1)),_0x62915e[_0x557bea(0x586)](_0x557bea(0x12ed))[_0x557bea(0x134b)]=_0x557bea(0x780);const _0x273e33=document['getElementById']('post-visibility-groups');_0x273e33[_0x557bea(0x110d)]='';const _0x4b78ff=await _0x17d534[_0x557bea(0x10a5)][_0x557bea(0x511)]();_0x4b78ff['length']>0x0?_0x4b78ff[_0x557bea(0x12c2)](_0x5ac887=>{const _0x2d20d2=_0x557bea,_0x42f528=document[_0x2d20d2(0xe7d)](_0x2d20d2(0x11af));_0x42f528[_0x2d20d2(0x1104)][_0x2d20d2(0x4db)]=_0x2d20d2(0x1188),_0x42f528[_0x2d20d2(0x110d)]=_0x2d20d2(0x1110)+_0x5ac887['id']+_0x2d20d2(0x382)+_0x5ac887['name'],_0x273e33[_0x2d20d2(0x1079)](_0x42f528);}):_0x273e33['innerHTML']=_0x557bea(0xa1d),_0x62915e[_0x557bea(0x11c2)][_0x557bea(0xa58)](_0x557bea(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0xe7))['addEventListener']('click',async()=>{const _0x409924=_0x5897a1;await _0x212847(),_0x589d88(_0x409924(0x6e5));}),document['getElementById'](_0x5897a1(0xde2))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x324fa6=_0x5897a1;_0x589d88('chat-list-screen'),_0x2ecab9(_0x324fa6(0x1116));}),document[_0x5897a1(0x458)]('album-photos-back-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x11c840=_0x5897a1;_0x42f206['activeAlbumId']=null,_0x589d88(_0x11c840(0x6e5));}),document[_0x5897a1(0x458)](_0x5897a1(0x2b0))['addEventListener'](_0x5897a1(0x1122),()=>document[_0x5897a1(0x458)]('album-photo-input')['click']()),document['getElementById'](_0x5897a1(0xd12))[_0x5897a1(0xd85)](_0x5897a1(0x26a),async _0x2adb06=>{const _0x3ed505=_0x5897a1;if(!_0x42f206[_0x3ed505(0xe42)])return;const _0x564796=_0x2adb06[_0x3ed505(0x12df)][_0x3ed505(0x1a9)];if(!_0x564796[_0x3ed505(0x131d)])return;const _0x3c9afe=await _0x17d534[_0x3ed505(0x1001)]['get'](_0x42f206['activeAlbumId']);for(const _0x1a527c of _0x564796){const _0x1bee02=await new Promise(_0x27618e=>{const _0x5cf752=_0x3ed505,_0x4cec8d=new FileReader();_0x4cec8d[_0x5cf752(0x11fa)]=()=>_0x27618e(_0x4cec8d[_0x5cf752(0x2ed)]),_0x4cec8d[_0x5cf752(0x96e)](_0x1a527c);});await _0x17d534['qzonePhotos'][_0x3ed505(0xa58)]({'albumId':_0x42f206[_0x3ed505(0xe42)],'url':_0x1bee02,'createdAt':Date[_0x3ed505(0x606)]()});}const _0x3f185c=await _0x17d534['qzonePhotos'][_0x3ed505(0x13c6)](_0x3ed505(0x589))[_0x3ed505(0x7db)](_0x42f206[_0x3ed505(0xe42)])[_0x3ed505(0x1e5)](),_0x1715b2={'photoCount':_0x3f185c};if(!_0x3c9afe[_0x3ed505(0x111b)]||_0x3c9afe[_0x3ed505(0x139)][_0x3ed505(0xd8d)]('placeholder')){const _0x180ecd=await _0x17d534[_0x3ed505(0xe15)]['where'](_0x3ed505(0x589))[_0x3ed505(0x7db)](_0x42f206[_0x3ed505(0xe42)])[_0x3ed505(0xb9)]();if(_0x180ecd)_0x1715b2['coverUrl']=_0x180ecd[_0x3ed505(0x1377)];}await _0x17d534['qzoneAlbums'][_0x3ed505(0x938)](_0x42f206[_0x3ed505(0xe42)],_0x1715b2),await _0x582a64(),await _0x212847(),_0x2adb06[_0x3ed505(0x12df)][_0x3ed505(0x8dd)]=null,alert(_0x3ed505(0x63e));}),document['getElementById'](_0x5897a1(0x698))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async _0x3f044=>{const _0x5a4885=_0x5897a1,_0x3c3717=_0x3f044[_0x5a4885(0x12df)]['closest']('.photo-delete-btn'),_0x4c05f1=_0x3f044[_0x5a4885(0x12df)]['closest'](_0x5a4885(0x188));if(_0x3c3717){_0x3f044[_0x5a4885(0x58e)]();const _0x5b854e=parseInt(_0x3c3717[_0x5a4885(0x1f4)][_0x5a4885(0x930)]),_0x3bfba9=await _0x2532b9(_0x5a4885(0x975),_0x5a4885(0x1b2),{'confirmButtonClass':_0x5a4885(0x4d3)});if(_0x3bfba9){const _0x1c6b59=await _0x17d534[_0x5a4885(0xe15)][_0x5a4885(0x36d)](_0x5b854e);if(!_0x1c6b59)return;await _0x17d534[_0x5a4885(0xe15)][_0x5a4885(0x195)](_0x5b854e);const _0x5c3c15=await _0x17d534['qzoneAlbums']['get'](_0x42f206[_0x5a4885(0xe42)]),_0xc02725=(_0x5c3c15[_0x5a4885(0x111b)]||0x1)-0x1,_0x4ff5c4={'photoCount':_0xc02725};if(_0x5c3c15['coverUrl']===_0x1c6b59[_0x5a4885(0x1377)]){const _0x5c0b8a=await _0x17d534[_0x5a4885(0xe15)][_0x5a4885(0x13c6)]('albumId')[_0x5a4885(0x7db)](_0x42f206[_0x5a4885(0xe42)])[_0x5a4885(0xb9)]();_0x4ff5c4[_0x5a4885(0x139)]=_0x5c0b8a?_0x5c0b8a[_0x5a4885(0x1377)]:'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png';}await _0x17d534[_0x5a4885(0x1001)][_0x5a4885(0x938)](_0x42f206[_0x5a4885(0xe42)],_0x4ff5c4),await _0x582a64(),await _0x212847(),alert(_0x5a4885(0x4cb));}}else _0x4c05f1&&_0x5a099a(_0x4c05f1[_0x5a4885(0x577)]);}),document['getElementById'](_0x5897a1(0xd43))['addEventListener'](_0x5897a1(0x1122),_0x33e05f),document[_0x5897a1(0x458)](_0x5897a1(0x2e8))['addEventListener'](_0x5897a1(0x1122),_0x4d5106),document['getElementById'](_0x5897a1(0x11e0))['addEventListener'](_0x5897a1(0x1122),_0x58df2a),document[_0x5897a1(0xd85)]('keydown',_0x173b07=>{const _0x3f2d75=_0x5897a1;if(!_0x5a38a4[_0x3f2d75(0x12f8)])return;if(_0x173b07['key']===_0x3f2d75(0x9f9))_0x4d5106();else{if(_0x173b07[_0x3f2d75(0x1278)]===_0x3f2d75(0x6ca))_0x58df2a();else _0x173b07[_0x3f2d75(0x1278)]===_0x3f2d75(0x409)&&_0x33e05f();}}),document[_0x5897a1(0x458)](_0x5897a1(0xde9))['addEventListener'](_0x5897a1(0x1122),async()=>{const _0x3cbcc3=_0x5897a1,_0x1e20fb=await _0x335e57(_0x3cbcc3(0x4ea),_0x3cbcc3(0xf0b));if(_0x1e20fb&&_0x1e20fb[_0x3cbcc3(0x2aa)]()){const _0x4035ae={'name':_0x1e20fb[_0x3cbcc3(0x2aa)](),'coverUrl':'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','photoCount':0x0,'createdAt':Date[_0x3cbcc3(0x606)]()};await _0x17d534[_0x3cbcc3(0x1001)][_0x3cbcc3(0xa58)](_0x4035ae),await _0x212847(),alert('相册\x20\x22'+_0x1e20fb+_0x3cbcc3(0xd21));}else _0x1e20fb!==null&&alert(_0x3cbcc3(0x4e0));}),document[_0x5897a1(0x458)](_0x5897a1(0x72b))[_0x5897a1(0xd85)]('click',()=>document['getElementById'](_0x5897a1(0xbc4))[_0x5897a1(0x11c2)][_0x5897a1(0x1097)](_0x5897a1(0x67d))),document[_0x5897a1(0x458)](_0x5897a1(0xf06))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>document[_0x5897a1(0x458)](_0x5897a1(0x3ad))[_0x5897a1(0x1122)]()),document[_0x5897a1(0x458)](_0x5897a1(0x3ad))['addEventListener'](_0x5897a1(0x26a),_0x19a6ab=>{const _0x2babaa=_0x5897a1,_0x5926e7=_0x19a6ab[_0x2babaa(0x12df)][_0x2babaa(0x1a9)][0x0];if(_0x5926e7){const _0x16fb0e=new FileReader();_0x16fb0e[_0x2babaa(0x11fa)]=_0x4ce01a=>{const _0x3d6862=_0x2babaa;document[_0x3d6862(0x458)](_0x3d6862(0xfc9))[_0x3d6862(0x577)]=_0x4ce01a[_0x3d6862(0x12df)][_0x3d6862(0x2ed)],document[_0x3d6862(0x458)](_0x3d6862(0x103a))['classList'][_0x3d6862(0xa58)](_0x3d6862(0x67d)),document['getElementById'](_0x3d6862(0xb12))[_0x3d6862(0x1104)][_0x3d6862(0x4db)]=_0x3d6862(0x1188);},_0x16fb0e[_0x2babaa(0x96e)](_0x5926e7);}}),document[_0x5897a1(0x458)](_0x5897a1(0x5c1))[_0x5897a1(0xd85)]('click',async()=>{const _0xab5bf2=_0x5897a1,_0x26ff58=await _0x335e57('输入图片URL','请输入网络图片的链接','',_0xab5bf2(0x1377));_0x26ff58&&(document[_0xab5bf2(0x458)](_0xab5bf2(0xfc9))[_0xab5bf2(0x577)]=_0x26ff58,document['getElementById']('post-image-preview-container')['classList'][_0xab5bf2(0xa58)]('visible'),document[_0xab5bf2(0x458)]('post-image-desc-group')[_0xab5bf2(0x1104)]['display']=_0xab5bf2(0x1188));}),document[_0x5897a1(0x458)]('post-remove-image-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>_0x56eadb());const _0xd40ef9=document['getElementById'](_0x5897a1(0xccc)),_0x1f7b4b=document['getElementById'](_0x5897a1(0x3a4)),_0x17d23e=document[_0x5897a1(0x458)]('image-mode-content'),_0x295f94=document['getElementById'](_0x5897a1(0xb47));_0xd40ef9[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x114a8c=_0x5897a1;_0xd40ef9['classList'][_0x114a8c(0xa58)]('active'),_0x1f7b4b[_0x114a8c(0x11c2)][_0x114a8c(0x1097)](_0x114a8c(0xfe1)),_0x17d23e[_0x114a8c(0x11c2)][_0x114a8c(0xa58)](_0x114a8c(0xfe1)),_0x295f94[_0x114a8c(0x11c2)][_0x114a8c(0x1097)](_0x114a8c(0xfe1));}),_0x1f7b4b[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x1ec440=_0x5897a1;_0x1f7b4b[_0x1ec440(0x11c2)][_0x1ec440(0xa58)](_0x1ec440(0xfe1)),_0xd40ef9[_0x1ec440(0x11c2)]['remove'](_0x1ec440(0xfe1)),_0x295f94['classList'][_0x1ec440(0xa58)](_0x1ec440(0xfe1)),_0x17d23e[_0x1ec440(0x11c2)][_0x1ec440(0x1097)](_0x1ec440(0xfe1));}),document[_0x5897a1(0x458)](_0x5897a1(0x263))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x29b39f=_0x5897a1,_0x207768=document['getElementById'](_0x29b39f(0xbc4)),_0x5722e2=_0x207768['dataset'][_0x29b39f(0x8d6)],_0x2bd580=document[_0x29b39f(0x586)](_0x29b39f(0x39e))['value'];let _0x456812=null;_0x2bd580===_0x29b39f(0x950)&&(_0x456812=Array[_0x29b39f(0xca2)](document[_0x29b39f(0x102a)](_0x29b39f(0xa7c)))[_0x29b39f(0xbf6)](_0x221478=>parseInt(_0x221478[_0x29b39f(0x8dd)])));let _0x104c7b={};const _0x4197ab={'timestamp':Date[_0x29b39f(0x606)](),'authorId':'user','visibleGroupIds':_0x456812};if(_0x5722e2==='shuoshuo'){const _0x1f4db9=document['getElementById'](_0x29b39f(0x1314))[_0x29b39f(0x8dd)][_0x29b39f(0x2aa)]();if(!_0x1f4db9){alert(_0x29b39f(0xcf4));return;}_0x104c7b={..._0x4197ab,'type':_0x29b39f(0xb03),'content':_0x1f4db9};}else{const _0x3ae0c9=document[_0x29b39f(0x458)](_0x29b39f(0x1314))[_0x29b39f(0x8dd)][_0x29b39f(0x2aa)](),_0xb2105=document['getElementById'](_0x29b39f(0x585))[_0x29b39f(0x11c2)][_0x29b39f(0x526)](_0x29b39f(0xfe1));if(_0xb2105){const _0x492efb=document[_0x29b39f(0x458)](_0x29b39f(0xfc9))[_0x29b39f(0x577)],_0x4296ca=document['getElementById']('post-image-description')[_0x29b39f(0x8dd)][_0x29b39f(0x2aa)]();if(!_0x492efb||!(_0x492efb['startsWith']('http')||_0x492efb['startsWith'](_0x29b39f(0xbe7)))){alert(_0x29b39f(0xc9a));return;}if(!_0x4296ca){alert(_0x29b39f(0x3d6));return;}_0x104c7b={..._0x4197ab,'type':'image_post','publicText':_0x3ae0c9,'imageUrl':_0x492efb,'imageDescription':_0x4296ca};}else{const _0x2edaed=document[_0x29b39f(0x458)]('post-hidden-text')[_0x29b39f(0x8dd)]['trim']();if(!_0x2edaed){alert(_0x29b39f(0x4fd));return;}_0x104c7b={..._0x4197ab,'type':_0x29b39f(0x1237),'publicText':_0x3ae0c9,'hiddenContent':_0x2edaed};}}const _0x1e1b66=await _0x17d534[_0x29b39f(0x15b)][_0x29b39f(0xa58)](_0x104c7b);let _0x8f4ea4=_0x104c7b[_0x29b39f(0x1316)]||_0x104c7b['publicText']||_0x104c7b[_0x29b39f(0x343)]||_0x104c7b['hiddenContent']||_0x29b39f(0xd9b);_0x8f4ea4=_0x8f4ea4['substring'](0x0,0x32)+(_0x8f4ea4[_0x29b39f(0x131d)]>0x32?_0x29b39f(0x10a0):'');for(const _0x5c2597 in _0x42f206[_0x29b39f(0x954)]){const _0x4d81da=_0x42f206[_0x29b39f(0x954)][_0x5c2597];if(_0x4d81da[_0x29b39f(0x726)])continue;let _0x125f8d=![];const _0x4a6be4=_0x104c7b['visibleGroupIds'];if(!_0x4a6be4||_0x4a6be4[_0x29b39f(0x131d)]===0x0)_0x125f8d=!![];else _0x4d81da[_0x29b39f(0x1437)]&&_0x4a6be4[_0x29b39f(0xd8d)](_0x4d81da[_0x29b39f(0x1437)])&&(_0x125f8d=!![]);if(_0x125f8d){const _0x151dea={'role':_0x29b39f(0x1370),'content':_0x29b39f(0x8f1)+_0x1e1b66+_0x29b39f(0xaf4)+_0x8f4ea4+_0x29b39f(0x11aa),'timestamp':Date[_0x29b39f(0x606)](),'isHidden':!![]};_0x4d81da['history']['push'](_0x151dea),await _0x17d534[_0x29b39f(0x954)][_0x29b39f(0xf3f)](_0x4d81da);}}await _0x316550(),_0x207768[_0x29b39f(0x11c2)][_0x29b39f(0x1097)](_0x29b39f(0x67d)),alert(_0x29b39f(0x1020));});const _0x2b7a4f=document['getElementById'](_0x5897a1(0x1ca));let _0x4493a2={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0x5eef61(_0x30150e=null){const _0x33c933=_0x5897a1;document[_0x33c933(0x102a)](_0x33c933(0xf5a))[_0x33c933(0x12c2)](_0x2af033=>{const _0x3d0b01=_0x33c933;_0x2af033!==_0x30150e&&_0x2af033[_0x3d0b01(0x586)](_0x3d0b01(0x9f0))['classList']['remove'](_0x3d0b01(0x8d7));});}async function _0x26b76a(_0x50ba84){const _0x19b594=_0x5897a1;_0x50ba84['stopPropagation']();const _0x4e79dd=_0x50ba84[_0x19b594(0x12df)],_0x661fc1=_0x4e79dd['closest'](_0x19b594(0xd44));if(_0x661fc1){const _0xb850a5=_0x661fc1[_0x19b594(0xe87)](_0x19b594(0xf5a)),_0x44f4c9=parseInt(_0xb850a5[_0x19b594(0x1f4)][_0x19b594(0x13bc)]),_0x5066e4=parseInt(_0x661fc1[_0x19b594(0x1f4)][_0x19b594(0xd6c)]);if(isNaN(_0x44f4c9)||isNaN(_0x5066e4))return;const _0xb573da=_0x394ad5[_0x19b594(0xb07)](_0x5a8b2=>_0x5a8b2['id']===_0x44f4c9);if(!_0xb573da||!_0xb573da[_0x19b594(0x946)]||!_0xb573da[_0x19b594(0x946)][_0x5066e4])return;const _0x33622b=_0xb573da[_0x19b594(0x946)][_0x5066e4],_0x410e96=await _0x2532b9(_0x19b594(0x12af),_0x19b594(0x396),{'confirmButtonClass':_0x19b594(0x4d3)});if(_0x410e96){_0xb573da['comments']['splice'](_0x5066e4,0x1),await _0x17d534[_0x19b594(0x15b)][_0x19b594(0x938)](_0x44f4c9,{'comments':_0xb573da[_0x19b594(0x946)]});if(_0x33622b&&_0x33622b[_0x19b594(0x7a7)]===_0x42f206[_0x19b594(0x551)]['nickname']){console[_0x19b594(0x7d1)](_0x19b594(0x13af));const _0x540e0a=new Set();_0xb573da[_0x19b594(0x1086)]!=='user'&&_0x540e0a[_0x19b594(0xa58)](_0xb573da[_0x19b594(0x1086)]);if(_0x33622b['replyTo']){const _0x149965=Object[_0x19b594(0x6eb)](_0x42f206[_0x19b594(0x954)])[_0x19b594(0xb07)](_0x263704=>_0x263704[_0x19b594(0xa1)]===_0x33622b[_0x19b594(0xd75)]);_0x149965&&_0x540e0a[_0x19b594(0xa58)](_0x149965['id']);}const _0x22820f=(_0xb573da[_0x19b594(0xd2d)]||_0xb573da[_0x19b594(0x1316)]||'')[_0x19b594(0xa6d)](0x0,0x1e),_0x4bbeab=_0x42f206['qzoneSettings'][_0x19b594(0x308)];let _0x1f71c5;const _0x511924=_0x42f206[_0x19b594(0x1294)]['find'](_0x18819d=>_0x18819d[_0x19b594(0x1377)]===_0x33622b[_0x19b594(0xdd5)]);if(_0x511924)_0x1f71c5='用户\x27'+_0x4bbeab+_0x19b594(0x10b7)+_0x22820f+'”下，发送了一个表情评论，意思是：“'+_0x511924[_0x19b594(0x132a)]+'”。';else{if(_0x33622b[_0x19b594(0xd75)]){const _0x5c49e1=_0x4e0b74(_0x33622b[_0x19b594(0xd75)]);_0x1f71c5=_0x19b594(0xaa)+_0x4bbeab+_0x19b594(0x10b7)+_0x22820f+_0x19b594(0x83)+_0x5c49e1+_0x19b594(0x7cc)+_0x33622b[_0x19b594(0xdd5)]+'”。';}else _0x1f71c5='用户\x27'+_0x4bbeab+'\x27刚刚评论了你的动态“'+_0x22820f+_0x19b594(0xe2f)+_0x33622b[_0x19b594(0xdd5)]+'”。';}const _0x84a771=_0x19b594(0x12ec)+_0x1f71c5+_0x19b594(0xadd);for(const _0x80c96 of _0x540e0a){const _0x302687=_0x42f206[_0x19b594(0x954)][_0x80c96];if(_0x302687){const _0x15d114=_0x302687[_0x19b594(0x1d5)][_0x19b594(0x131d)];_0x302687['history']=_0x302687[_0x19b594(0x1d5)][_0x19b594(0xaf1)](_0x441f47=>!(_0x441f47[_0x19b594(0x7a0)]&&_0x441f47[_0x19b594(0xaeb)]==='system'&&_0x441f47[_0x19b594(0x1316)]===_0x84a771)),_0x302687['history'][_0x19b594(0x131d)]<_0x15d114&&(console[_0x19b594(0x7d1)]('在角色\x20\x22'+_0x302687[_0x19b594(0x132a)]+'\x22\x20的记忆中清除了1条关于已删除评论的通知。'),await _0x17d534[_0x19b594(0x954)][_0x19b594(0xf3f)](_0x302687));}}}await _0xb8d737(_0x44f4c9);}return;}const _0x1f40c5=_0x4e79dd['closest'](_0x19b594(0x224));if(_0x1f40c5){const _0x1a3bec=_0x1f40c5['closest']('.qzone-post-container');if(!_0x1a3bec)return;const _0x30138e=parseInt(_0x1a3bec[_0x19b594(0x1f4)][_0x19b594(0x13bc)]);_0xf96d9b[_0x19b594(0x12f8)]&&_0xf96d9b[_0x19b594(0x10a2)]===_0x30138e?_0x117c0b():_0x4fdb91(_0x30138e,_0x1f40c5);return;}const _0x2687be=_0x4e79dd[_0x19b594(0xe87)](_0x19b594(0xb8f));if(_0x2687be){const _0x9c62d1=parseInt(_0x2687be[_0x19b594(0x1f4)][_0x19b594(0x13bc)]),_0x4ecfdd=_0x2687be[_0x19b594(0x1f4)][_0x19b594(0x5ae)],_0x5eaae0=_0x2687be['dataset'][_0x19b594(0x354)];if(!_0x4ecfdd||!_0x5eaae0||_0x4ecfdd===_0x42f206[_0x19b594(0x551)][_0x19b594(0x308)]){_0x1c15cf(_0x2687be['closest']('.qzone-post-container'));return;}_0x22febf={'postId':_0x9c62d1,'replyToName':_0x4ecfdd,'replyToDisplayName':_0x5eaae0};const _0x402cf6=_0x2687be[_0x19b594(0xe87)](_0x19b594(0xf5a)),_0x3e4c5d=_0x402cf6[_0x19b594(0x586)](_0x19b594(0x118a));_0x3e4c5d[_0x19b594(0x134b)]=_0x19b594(0x1033)+_0x5eaae0+':',_0x3e4c5d['focus']();return;}if(_0x4e79dd[_0x19b594(0x11c2)][_0x19b594(0x526)]('post-actions-btn')){const _0x4b6b9d=_0x4e79dd[_0x19b594(0xe87)](_0x19b594(0xf5a));if(_0x4b6b9d&&_0x4b6b9d[_0x19b594(0x1f4)][_0x19b594(0x13bc)])_0xa011e1(parseInt(_0x4b6b9d[_0x19b594(0x1f4)][_0x19b594(0x13bc)]));return;}if(_0x4e79dd[_0x19b594(0xf13)]===_0x19b594(0x1071)&&_0x4e79dd['dataset']['hiddenText']){_0x34fce8(_0x19b594(0x5fd),_0x4e79dd[_0x19b594(0x1f4)][_0x19b594(0xa2b)]['replace'](/<br>/g,'\x0a'));return;}const _0x742b48=_0x4e79dd['closest'](_0x19b594(0xf5a));if(!_0x742b48)return;const _0x290319=parseInt(_0x742b48[_0x19b594(0x1f4)]['postId']);if(isNaN(_0x290319))return;if(_0x4e79dd[_0x19b594(0xe87)](_0x19b594(0xccb))){const _0x530ceb=await _0x2532b9(_0x19b594(0x91d),'确定要永久删除这条动态吗？',{'confirmButtonClass':_0x19b594(0x4d3)});_0x530ceb&&(_0x742b48[_0x19b594(0x1104)][_0x19b594(0x41b)]=_0x19b594(0x1275),_0x742b48[_0x19b594(0x1104)]['transform']=_0x19b594(0x4f0),_0x742b48[_0x19b594(0x1104)][_0x19b594(0x539)]='0',setTimeout(async()=>{const _0x142a73=_0x19b594;await _0x17d534['qzonePosts'][_0x142a73(0x195)](_0x290319);const _0x5e1812=_0x142a73(0x3b1)+_0x290319+')';for(const _0x2e6f34 in _0x42f206[_0x142a73(0x954)]){const _0x463a55=_0x42f206[_0x142a73(0x954)][_0x2e6f34],_0x446ee9=_0x463a55[_0x142a73(0x1d5)]['length'];_0x463a55[_0x142a73(0x1d5)]=_0x463a55[_0x142a73(0x1d5)]['filter'](_0x4ef0a2=>!(_0x4ef0a2['role']===_0x142a73(0x1370)&&_0x4ef0a2[_0x142a73(0x1316)]['includes'](_0x5e1812)));if(_0x463a55[_0x142a73(0x1d5)][_0x142a73(0x131d)]<_0x446ee9)await _0x17d534[_0x142a73(0x954)]['put'](_0x463a55);}await _0x316550(),alert(_0x142a73(0xacb));},0x12c));return;}const _0x491229=_0x4e79dd[_0x19b594(0xe87)](_0x19b594(0x653));if(_0x491229){if(_0x491229['classList'][_0x19b594(0x526)](_0x19b594(0x10c6))){_0x180ac7(_0x290319);return;}if(_0x491229[_0x19b594(0x11c2)][_0x19b594(0x526)](_0x19b594(0x46f))){const _0xfabde6=_0x394ad5['find'](_0x1f2515=>_0x1f2515['id']===_0x290319);if(!_0xfabde6)return;if(!_0xfabde6[_0x19b594(0x1be)])_0xfabde6[_0x19b594(0x1be)]=[];const _0x3a6b1d=_0x42f206[_0x19b594(0x551)][_0x19b594(0x308)],_0x5eea50=_0xfabde6[_0x19b594(0x1be)]['indexOf'](_0x3a6b1d);_0x5eea50>-0x1?_0xfabde6[_0x19b594(0x1be)][_0x19b594(0x9cf)](_0x5eea50,0x1):(_0xfabde6[_0x19b594(0x1be)][_0x19b594(0x129e)](_0x3a6b1d),_0x491229['classList'][_0x19b594(0xa58)](_0x19b594(0xe6c)),_0x491229[_0x19b594(0xd85)](_0x19b594(0x11bb),()=>_0x491229[_0x19b594(0x11c2)]['remove'](_0x19b594(0xe6c)),{'once':!![]})),await _0x17d534['qzonePosts']['update'](_0x290319,{'likes':_0xfabde6[_0x19b594(0x1be)]}),await _0xb8d737(_0x290319);}if(_0x491229[_0x19b594(0x11c2)][_0x19b594(0x526)](_0x19b594(0xc4))){const _0x5443d7=await _0x17d534[_0x19b594(0xb78)][_0x19b594(0x13c6)]({'type':_0x19b594(0xe47),'content.id':_0x290319})[_0x19b594(0xb9)]();if(_0x5443d7)await _0x17d534[_0x19b594(0xb78)][_0x19b594(0x195)](_0x5443d7['id']),await _0x34fce8('提示','已取消收藏');else{const _0x1963be=await _0x17d534[_0x19b594(0x15b)][_0x19b594(0x36d)](_0x290319);_0x1963be&&(await _0x17d534['favorites'][_0x19b594(0xa58)]({'type':_0x19b594(0xe47),'content':_0x1963be,'timestamp':Date[_0x19b594(0x606)]()}),await _0x34fce8('提示',_0x19b594(0x4be)));}await _0xb8d737(_0x290319);}return;}const _0x5965db=_0x4e79dd[_0x19b594(0xe87)](_0x19b594(0x161));if(_0x5965db){const _0x4bfb75=_0x742b48[_0x19b594(0x586)](_0x19b594(0x118a)),_0x879a0d=_0x4bfb75[_0x19b594(0x8dd)][_0x19b594(0x2aa)]();if(!_0x879a0d)return alert('评论内容不能为空哦！');const _0x5b0af0=_0x394ad5[_0x19b594(0xb07)](_0x4d8f81=>_0x4d8f81['id']===_0x290319);if(!_0x5b0af0)return;if(!_0x5b0af0[_0x19b594(0x946)])_0x5b0af0['comments']=[];const _0x11b82b={'commenterName':_0x42f206['qzoneSettings'][_0x19b594(0x308)],'text':_0x879a0d,'timestamp':Date[_0x19b594(0x606)](),'replyTo':_0x22febf&&_0x22febf[_0x19b594(0x13bc)]===_0x290319?_0x22febf[_0x19b594(0x6c8)]:null};_0x5b0af0[_0x19b594(0x946)][_0x19b594(0x129e)](_0x11b82b),await _0x17d534[_0x19b594(0x15b)][_0x19b594(0x938)](_0x290319,{'comments':_0x5b0af0['comments']});let _0x1900cb=(_0x5b0af0[_0x19b594(0xd2d)]||_0x5b0af0[_0x19b594(0x1316)]||'')[_0x19b594(0xa6d)](0x0,0x1e);const _0x3f034e=_0x42f206[_0x19b594(0x551)][_0x19b594(0x308)],_0x5caf1e=new Set();if(_0x5b0af0[_0x19b594(0x1086)]!==_0x19b594(0xf86))_0x5caf1e[_0x19b594(0xa58)](_0x5b0af0['authorId']);if(_0x11b82b[_0x19b594(0xd75)]&&_0x11b82b[_0x19b594(0xd75)]!==_0x3f034e){const _0x157b5f=Object[_0x19b594(0x6eb)](_0x42f206[_0x19b594(0x954)])[_0x19b594(0xb07)](_0x47a1d7=>_0x47a1d7['originalName']===_0x11b82b[_0x19b594(0xd75)]);if(_0x157b5f)_0x5caf1e[_0x19b594(0xa58)](_0x157b5f['id']);}for(const _0x419f13 of _0x5caf1e){const _0x502273=_0x42f206[_0x19b594(0x954)][_0x419f13];if(_0x502273&&!_0x502273[_0x19b594(0x726)]){const _0x3959b7=_0x42f206[_0x19b594(0x1294)]['find'](_0x435b94=>_0x435b94[_0x19b594(0x1377)]===_0x879a0d);let _0x5bb44e=_0x3959b7?'用户\x27'+_0x3f034e+_0x19b594(0x10b7)+_0x1900cb+'”下，发送了一个表情评论，意思是：“'+_0x3959b7[_0x19b594(0x132a)]+'”。':_0x11b82b['replyTo']?_0x19b594(0xaa)+_0x3f034e+'\x27刚刚在你的动态“'+_0x1900cb+_0x19b594(0x83)+_0x22febf[_0x19b594(0xd02)]+'\x27的评论，内容是：“'+_0x879a0d+'”。':_0x19b594(0xaa)+_0x3f034e+_0x19b594(0x5da)+_0x1900cb+_0x19b594(0xe2f)+_0x879a0d+'”。';const _0x2da72b={'role':'system','content':'[系统提示：'+_0x5bb44e+_0x19b594(0xadd),'timestamp':Date['now'](),'isHidden':!![]};_0x502273[_0x19b594(0x1d5)][_0x19b594(0x129e)](_0x2da72b),await _0x17d534[_0x19b594(0x954)]['put'](_0x502273);}}_0x4bfb75[_0x19b594(0x8dd)]='',_0x1c15cf(_0x742b48),await _0xb8d737(_0x290319);return;}}const _0x8323f9=_0x11ddaa=>{const _0x34c9b4=_0x5897a1,_0x2b831e=_0x11ddaa[_0x34c9b4(0x12df)];if(_0x2b831e['closest'](_0x34c9b4(0x83b)))return;const _0x4e2a78=_0x11ddaa[_0x34c9b4(0x12df)][_0x34c9b4(0xe87)](_0x34c9b4(0xf5a));if(!_0x4e2a78)return;_0x5eef61(_0x4e2a78),_0x4493a2[_0x34c9b4(0x112)]=_0x4e2a78,_0x4493a2[_0x34c9b4(0xb0b)]=!![],_0x4493a2['isClick']=!![],_0x4493a2[_0x34c9b4(0xe90)]=null,_0x4493a2[_0x34c9b4(0x2c3)]=_0x11ddaa[_0x34c9b4(0x259)][_0x34c9b4(0xd8d)](_0x34c9b4(0x38d))?_0x11ddaa[_0x34c9b4(0xb60)]:_0x11ddaa[_0x34c9b4(0x73f)][0x0][_0x34c9b4(0xb60)],_0x4493a2[_0x34c9b4(0x1184)]=_0x11ddaa[_0x34c9b4(0x259)]['includes'](_0x34c9b4(0x38d))?_0x11ddaa[_0x34c9b4(0x6f2)]:_0x11ddaa[_0x34c9b4(0x73f)][0x0][_0x34c9b4(0x6f2)],_0x4493a2[_0x34c9b4(0x112)][_0x34c9b4(0x586)]('.qzone-post-item')[_0x34c9b4(0x1104)][_0x34c9b4(0x41b)]=_0x34c9b4(0x464),document[_0x34c9b4(0xd85)](_0x34c9b4(0xc65),_0x3ddcca),document[_0x34c9b4(0xd85)](_0x34c9b4(0x1120),_0x375e35),document[_0x34c9b4(0xd85)](_0x34c9b4(0xfc2),_0x3ddcca,{'passive':![]}),document[_0x34c9b4(0xd85)](_0x34c9b4(0x2ba),_0x375e35);},_0x3ddcca=_0x1ffb57=>{const _0x3254e8=_0x5897a1;if(!_0x4493a2[_0x3254e8(0xb0b)]||!_0x4493a2['activeContainer'])return;const _0x38a675=_0x1ffb57['type']['includes'](_0x3254e8(0x38d))?_0x1ffb57['pageX']:_0x1ffb57[_0x3254e8(0x73f)][0x0][_0x3254e8(0xb60)],_0x1d2643=_0x1ffb57[_0x3254e8(0x259)][_0x3254e8(0xd8d)](_0x3254e8(0x38d))?_0x1ffb57[_0x3254e8(0x6f2)]:_0x1ffb57[_0x3254e8(0x73f)][0x0][_0x3254e8(0x6f2)],_0x12ac8e=_0x38a675-_0x4493a2[_0x3254e8(0x2c3)],_0x4103a6=_0x1d2643-_0x4493a2[_0x3254e8(0x1184)];_0x4493a2[_0x3254e8(0x8c8)]&&(Math[_0x3254e8(0xc86)](_0x12ac8e)>0x5||Math[_0x3254e8(0xc86)](_0x4103a6)>0x5)&&(_0x4493a2[_0x3254e8(0x8c8)]=![]);!_0x4493a2[_0x3254e8(0xe90)]&&(Math[_0x3254e8(0xc86)](_0x12ac8e)>Math['abs'](_0x4103a6)?_0x4493a2['swipeDirection']=_0x3254e8(0xf5e):_0x4493a2[_0x3254e8(0xe90)]=_0x3254e8(0xdd3));if(_0x4493a2[_0x3254e8(0xe90)]==='horizontal'){_0x1ffb57['preventDefault'](),_0x4493a2[_0x3254e8(0x1334)]=_0x38a675;let _0x4dd082=Math[_0x3254e8(0x137)](0x0,Math['max'](-0x5a,_0x12ac8e));_0x4493a2[_0x3254e8(0x112)][_0x3254e8(0x586)](_0x3254e8(0x9f0))['style'][_0x3254e8(0xb7e)]=_0x3254e8(0x307)+_0x4dd082+_0x3254e8(0xe13);}},_0x375e35=_0x171f2a=>{const _0x3fe104=_0x5897a1;document[_0x3fe104(0x13ac)](_0x3fe104(0xc65),_0x3ddcca),document[_0x3fe104(0x13ac)](_0x3fe104(0x1120),_0x375e35),document[_0x3fe104(0x13ac)](_0x3fe104(0xfc2),_0x3ddcca),document[_0x3fe104(0x13ac)](_0x3fe104(0x2ba),_0x375e35);if(!_0x4493a2[_0x3fe104(0xb0b)]||!_0x4493a2[_0x3fe104(0x112)])return;const _0x54fad3=_0x4493a2[_0x3fe104(0x112)][_0x3fe104(0x586)]('.qzone-post-item');_0x54fad3[_0x3fe104(0x1104)]['transition']='transform\x200.3s\x20ease';if(_0x4493a2['swipeDirection']==='horizontal'&&!_0x4493a2[_0x3fe104(0x8c8)]){const _0x302703=_0x171f2a[_0x3fe104(0x259)][_0x3fe104(0xd8d)](_0x3fe104(0x2ba))?_0x171f2a['changedTouches'][0x0][_0x3fe104(0xb60)]:_0x171f2a[_0x3fe104(0xb60)],_0x8137ef=_0x302703-_0x4493a2['startX'];_0x8137ef<-0x28?_0x54fad3['classList'][_0x3fe104(0xa58)](_0x3fe104(0x8d7)):_0x54fad3[_0x3fe104(0x11c2)][_0x3fe104(0x1097)](_0x3fe104(0x8d7));}_0x54fad3[_0x3fe104(0x1104)][_0x3fe104(0xb7e)]='',_0x4493a2[_0x3fe104(0xb0b)]=![],_0x4493a2[_0x3fe104(0x112)]=null,_0x4493a2[_0x3fe104(0xe90)]=null,_0x4493a2[_0x3fe104(0x8c8)]=!![];};_0x2b7a4f[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x26b76a),_0x2b7a4f[_0x5897a1(0xd85)](_0x5897a1(0x7d2),_0x8323f9),_0x2b7a4f['addEventListener'](_0x5897a1(0xcbd),_0x8323f9,{'passive':!![]}),_0x2b7a4f[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x48f3a3=>{const _0x86336c=_0x5897a1;_0x48f3a3[_0x86336c(0x12df)]&&_0x48f3a3[_0x86336c(0x12df)]['id']===_0x86336c(0x10db)&&_0x2b7986();}),document['getElementById'](_0x5897a1(0x1b1))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x5f3ba4=_0x5897a1;_0x42f206[_0x5f3ba4(0x81d)]&&_0x3073d5(_0x42f206[_0x5f3ba4(0x81d)]);}),document['getElementById']('api-preset-select')['addEventListener'](_0x5897a1(0x26a),_0x4a8495),document[_0x5897a1(0x458)](_0x5897a1(0x719))['addEventListener'](_0x5897a1(0x1122),_0x85b8f7),document[_0x5897a1(0x458)](_0x5897a1(0x10a1))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x2afadc),document[_0x5897a1(0x458)]('add-world-book-entry-btn')['addEventListener'](_0x5897a1(0x1122),()=>{const _0x5784e7=_0x5897a1,_0x4cb8e5=document[_0x5784e7(0x458)](_0x5784e7(0x1424));_0x4cb8e5[_0x5784e7(0x586)]('p')&&(_0x4cb8e5[_0x5784e7(0x110d)]='');const _0x49dd19=_0x3a75d2();_0x4cb8e5[_0x5784e7(0x1079)](_0x49dd19),_0x49dd19[_0x5784e7(0x586)](_0x5784e7(0xdd8))['focus']();}),document[_0x5897a1(0x458)](_0x5897a1(0x115e))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0xb46c8c),document['getElementById'](_0x5897a1(0xeb))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x33140a=>{const _0x2bfb6c=_0x5897a1;_0x33140a['target']&&_0x33140a[_0x2bfb6c(0x12df)]['id']===_0x2bfb6c(0x1090)&&_0x180228();}),document['getElementById'](_0x5897a1(0x6e2))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x2c364b),document[_0x5897a1(0x458)](_0x5897a1(0x2c1))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x1ec147),document[_0x5897a1(0x458)](_0x5897a1(0x7a3))['addEventListener'](_0x5897a1(0x1122),_0x36f04b=>{const _0x448eff=_0x5897a1;_0x36f04b[_0x448eff(0x12df)]['id']===_0x448eff(0x7a3)&&_0x36f04b[_0x448eff(0x12df)]['classList']['remove'](_0x448eff(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x420))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0xda8122),document[_0x5897a1(0x458)](_0x5897a1(0x1da))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x5b2438),document[_0x5897a1(0x458)](_0x5897a1(0x479))[_0x5897a1(0xd85)]('click',()=>_0x2ecab9(_0x5897a1(0x785))),document['getElementById'](_0x5897a1(0x146))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>_0x2ecab9(_0x5897a1(0x785)));const _0x42e201=document[_0x5897a1(0x458)](_0x5897a1(0xa21)),_0x3a73b3=document[_0x5897a1(0x458)]('favorites-search-clear-btn');_0x42e201[_0x5897a1(0xd85)](_0x5897a1(0x754),()=>{const _0x123df8=_0x5897a1,_0x387551=_0x42e201['value'][_0x123df8(0x2aa)]()[_0x123df8(0xb15)]();_0x3a73b3[_0x123df8(0x1104)]['display']=_0x387551?_0x123df8(0x1188):_0x123df8(0x464);if(!_0x387551){_0x2a636c(allFavoriteItems);return;}const _0x4033f3=allFavoriteItems[_0x123df8(0xaf1)](_0x279cfa=>{const _0xf10a91=_0x123df8;let _0x24f736='',_0x5188e7='';if(_0x279cfa[_0xf10a91(0x259)]===_0xf10a91(0xe47)){const _0x596611=_0x279cfa[_0xf10a91(0x1316)];_0x24f736+=(_0x596611[_0xf10a91(0xd2d)]||'')+'\x20'+(_0x596611[_0xf10a91(0x1316)]||'');if(_0x596611[_0xf10a91(0x1086)]===_0xf10a91(0xf86))_0x5188e7=_0x42f206[_0xf10a91(0x551)]['nickname'];else _0x42f206[_0xf10a91(0x954)][_0x596611[_0xf10a91(0x1086)]]&&(_0x5188e7=_0x42f206['chats'][_0x596611[_0xf10a91(0x1086)]][_0xf10a91(0x132a)]);}else{if(_0x279cfa['type']===_0xf10a91(0x10e6)){const _0x1fd672=_0x279cfa['content'];typeof _0x1fd672[_0xf10a91(0x1316)]===_0xf10a91(0x861)&&(_0x24f736=_0x1fd672[_0xf10a91(0x1316)]);const _0xc49bb6=_0x42f206[_0xf10a91(0x954)][_0x279cfa['chatId']];_0xc49bb6&&(_0x1fd672['role']===_0xf10a91(0xf86)?_0x5188e7=_0xc49bb6['isGroup']?_0xc49bb6[_0xf10a91(0xda2)]['myNickname']||'我':'我':_0x5188e7=_0xc49bb6[_0xf10a91(0x726)]?_0x1fd672[_0xf10a91(0x2a3)]:_0xc49bb6[_0xf10a91(0x132a)]);}}return _0x24f736[_0xf10a91(0xb15)]()['includes'](_0x387551)||_0x5188e7[_0xf10a91(0xb15)]()['includes'](_0x387551);});_0x2a636c(_0x4033f3);}),_0x3a73b3[_0x5897a1(0xd85)]('click',()=>{const _0x18c1fa=_0x5897a1;_0x42e201[_0x18c1fa(0x8dd)]='',_0x3a73b3[_0x18c1fa(0x1104)][_0x18c1fa(0x4db)]=_0x18c1fa(0x464),_0x2a636c(allFavoriteItems),_0x42e201[_0x18c1fa(0x1248)]();}),document[_0x5897a1(0x458)]('selection-favorite-btn')['addEventListener'](_0x5897a1(0x1122),async()=>{const _0x465569=_0x5897a1;if(_0x3e3048[_0x465569(0x12a4)]===0x0)return;const _0x292b77=_0x42f206[_0x465569(0x954)][_0x42f206['activeChatId']];if(!_0x292b77)return;const _0xec959d=[],_0x134d69=[..._0x3e3048];for(const _0x4f8fb1 of _0x134d69){const _0x2f99a3=await _0x17d534[_0x465569(0xb78)][_0x465569(0x13c6)]('originalTimestamp')[_0x465569(0x7db)](_0x4f8fb1)[_0x465569(0xb9)]();if(!_0x2f99a3){const _0x452bdd=_0x292b77[_0x465569(0x1d5)][_0x465569(0xb07)](_0x1c9926=>_0x1c9926[_0x465569(0xf16)]===_0x4f8fb1);_0x452bdd&&_0xec959d[_0x465569(0x129e)]({'type':'chat_message','content':_0x452bdd,'chatId':_0x42f206[_0x465569(0x81d)],'timestamp':Date[_0x465569(0x606)](),'originalTimestamp':_0x452bdd[_0x465569(0xf16)]});}}_0xec959d[_0x465569(0x131d)]>0x0?(await _0x17d534['favorites'][_0x465569(0xaad)](_0xec959d),allFavoriteItems=await _0x17d534[_0x465569(0xb78)][_0x465569(0x50b)](_0x465569(0xf16))[_0x465569(0x115b)]()['toArray'](),await _0x34fce8(_0x465569(0x6fa),_0x465569(0x13f)+_0xec959d[_0x465569(0x131d)]+'\x20条消息。')):await _0x34fce8('提示','选中的消息均已收藏过。'),_0x5bc130();});const _0x567b74=document[_0x5897a1(0x458)](_0x5897a1(0x874)),_0x537647=document[_0x5897a1(0x458)](_0x5897a1(0x13a9)),_0x5a322b=document['getElementById'](_0x5897a1(0x6da)),_0x8212dd=document[_0x5897a1(0x458)](_0x5897a1(0x588)),_0x19f6ee=document[_0x5897a1(0x458)](_0x5897a1(0x1331));_0x567b74[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x2dccf8=_0x5897a1;_0x188658=!_0x188658,_0x537647[_0x2dccf8(0x11c2)][_0x2dccf8(0x1270)](_0x2dccf8(0xd15),_0x188658),_0x188658?(_0x567b74[_0x2dccf8(0x1a2)]='完成',_0x5a322b[_0x2dccf8(0x1104)][_0x2dccf8(0x4db)]=_0x2dccf8(0x1188),_0x8212dd[_0x2dccf8(0x1104)][_0x2dccf8(0x4db)]=_0x2dccf8(0x464),_0x19f6ee['style'][_0x2dccf8(0x43a)]='80px'):(_0x567b74[_0x2dccf8(0x1a2)]='编辑',_0x5a322b[_0x2dccf8(0x1104)][_0x2dccf8(0x4db)]='none',_0x8212dd[_0x2dccf8(0x1104)][_0x2dccf8(0x4db)]=_0x2dccf8(0x82b),_0x19f6ee[_0x2dccf8(0x1104)]['paddingBottom']='',_0x38dccd[_0x2dccf8(0x415)](),document[_0x2dccf8(0x102a)](_0x2dccf8(0x5fe))[_0x2dccf8(0x12c2)](_0xa69961=>_0xa69961[_0x2dccf8(0x11c2)][_0x2dccf8(0x1097)](_0x2dccf8(0x500))),document['getElementById'](_0x2dccf8(0x1428))['textContent']=_0x2dccf8(0xb5f));}),document['getElementById'](_0x5897a1(0x1331))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x48c93=>{const _0x53b2a4=_0x5897a1,_0x18d22d=_0x48c93[_0x53b2a4(0x12df)],_0x59a2eb=_0x18d22d[_0x53b2a4(0xe87)](_0x53b2a4(0x11ba));if(_0x18d22d[_0x53b2a4(0xf13)]==='IMG'&&_0x18d22d['dataset'][_0x53b2a4(0xa2b)]){const _0x33636f=_0x18d22d[_0x53b2a4(0x1f4)][_0x53b2a4(0xa2b)];_0x34fce8(_0x53b2a4(0x5fd),_0x33636f[_0x53b2a4(0x33b)](/<br>/g,'\x0a'));return;}if(!_0x188658)return;if(!_0x59a2eb)return;const _0x5779f2=parseInt(_0x59a2eb[_0x53b2a4(0x1f4)][_0x53b2a4(0x75a)]);if(isNaN(_0x5779f2))return;_0x38dccd[_0x53b2a4(0x31c)](_0x5779f2)?(_0x38dccd['delete'](_0x5779f2),_0x59a2eb[_0x53b2a4(0x11c2)][_0x53b2a4(0x1097)](_0x53b2a4(0x500))):(_0x38dccd[_0x53b2a4(0xa58)](_0x5779f2),_0x59a2eb[_0x53b2a4(0x11c2)][_0x53b2a4(0xa58)](_0x53b2a4(0x500))),document[_0x53b2a4(0x458)](_0x53b2a4(0x1428))[_0x53b2a4(0x1a2)]=_0x53b2a4(0xeab)+_0x38dccd[_0x53b2a4(0x12a4)]+')';}),document['getElementById'](_0x5897a1(0x1428))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x17af9f=_0x5897a1;if(_0x38dccd[_0x17af9f(0x12a4)]===0x0)return;const _0x1dc604=await _0x2532b9(_0x17af9f(0x1ef),_0x17af9f(0x3b6)+_0x38dccd[_0x17af9f(0x12a4)]+'\x20条内容吗？',{'confirmButtonClass':_0x17af9f(0x4d3)});if(_0x1dc604){const _0x5bd411=[..._0x38dccd];await _0x17d534[_0x17af9f(0xb78)][_0x17af9f(0x1315)](_0x5bd411),await _0x34fce8(_0x17af9f(0xa59),_0x17af9f(0x1443)),allFavoriteItems=allFavoriteItems[_0x17af9f(0xaf1)](_0x5407cc=>!_0x5bd411[_0x17af9f(0xd8d)](_0x5407cc['id'])),_0x2a636c(allFavoriteItems),_0x567b74[_0x17af9f(0x1122)]();}});_0x42f206[_0x5897a1(0xf0)][_0x5897a1(0x12cd)]&&(_0x27c212(),console[_0x5897a1(0x7d1)](_0x5897a1(0x7c7)));document[_0x5897a1(0x102a)](_0x5897a1(0x247))['forEach'](_0x3f85a5=>{const _0x27c99a=_0x5897a1;_0x3f85a5[_0x27c99a(0xd85)](_0x27c99a(0x26a),_0x83553f);});const _0x28a478=document[_0x5897a1(0x458)](_0x5897a1(0x3da));_0x28a478[_0x5897a1(0xd85)]('input',()=>{const _0x2cf3b7=_0x5897a1;document[_0x2cf3b7(0x458)](_0x2cf3b7(0xdf2))[_0x2cf3b7(0x1a2)]=_0x28a478['value']+'px',_0x83553f();});const _0x718b06=document[_0x5897a1(0x458)](_0x5897a1(0x11bf));_0x718b06[_0x5897a1(0xd85)](_0x5897a1(0x754),_0x83553f),document[_0x5897a1(0x458)](_0x5897a1(0xc40))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x58ae87=_0x5897a1;document['getElementById'](_0x58ae87(0x1222))[_0x58ae87(0x8f7)]=!![],_0x83553f();}),document[_0x5897a1(0x458)](_0x5897a1(0x989))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x15ef36=_0x5897a1;document[_0x15ef36(0x458)](_0x15ef36(0x11bf))[_0x15ef36(0x8dd)]='',_0x83553f();}),document[_0x5897a1(0x458)](_0x5897a1(0x1054))[_0x5897a1(0xd85)]('change',_0x83553f),document[_0x5897a1(0x458)]('lyrics-horizontal-pos')['addEventListener'](_0x5897a1(0x26a),_0x83553f),document['getElementById'](_0x5897a1(0x9c6))[_0x5897a1(0xd85)]('input',_0x83553f),document[_0x5897a1(0x102a)](_0x5897a1(0xf1f))['forEach'](_0x1659b7=>{const _0x4af4d1=_0x5897a1;_0x1659b7[_0x4af4d1(0xd85)]('change',function(){const _0x5679d=_0x4af4d1,_0x4145fa=document[_0x5679d(0x458)](_0x5679d(0x5e7));this[_0x5679d(0x8dd)]===_0x5679d(0x950)||this[_0x5679d(0x8dd)]==='exclude'?_0x4145fa[_0x5679d(0x1104)]['display']='block':_0x4145fa['style'][_0x5679d(0x4db)]=_0x5679d(0x464);});}),document[_0x5897a1(0x458)](_0x5897a1(0xe94))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x397b28),document[_0x5897a1(0x458)](_0x5897a1(0x1e9))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x83fba6=_0x5897a1;document[_0x83fba6(0x458)](_0x83fba6(0xacc))['classList']['remove']('visible');const _0x2bcb9a=document[_0x83fba6(0x458)](_0x83fba6(0xa41));document['getElementById'](_0x83fba6(0x8b0))[_0x83fba6(0x11c2)][_0x83fba6(0x526)](_0x83fba6(0x67d))&&_0x2bcb9a['click']();}),document[_0x5897a1(0x458)](_0x5897a1(0xbbe))[_0x5897a1(0xd85)]('click',_0x3c9d04),document[_0x5897a1(0x458)](_0x5897a1(0x216))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x341f32=>{const _0x358caa=_0x5897a1;if(_0x341f32[_0x358caa(0x12df)][_0x358caa(0x11c2)][_0x358caa(0x526)]('delete-group-btn')){const _0x40746c=parseInt(_0x341f32[_0x358caa(0x12df)][_0x358caa(0x1f4)]['id']);_0x5b6c87(_0x40746c);}}),document[_0x5897a1(0x458)]('cancel-message-action-btn')['addEventListener'](_0x5897a1(0x1122),_0x2419bd),document[_0x5897a1(0x458)](_0x5897a1(0x1025))['addEventListener'](_0x5897a1(0x1122),_0x4d7e3a),document[_0x5897a1(0x458)](_0x5897a1(0x8d3))['addEventListener'](_0x5897a1(0x1122),_0x514169),document[_0x5897a1(0x458)]('recall-message-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x27a62f),document[_0x5897a1(0x458)]('select-message-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x51c53c=_0x362918;_0x2419bd(),_0x51c53c&&_0x2a3f29(_0x51c53c);}),document[_0x5897a1(0x458)](_0x5897a1(0x13a0))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x4a757f=>{const _0x2a6646=_0x5897a1,_0x5e72af=_0x4a757f[_0x2a6646(0x12df)]['closest'](_0x2a6646(0xd4f));if(!_0x5e72af)return;if(_0x5e72af['classList'][_0x2a6646(0x526)]('ai')&&_0x5e72af['classList'][_0x2a6646(0x526)](_0x2a6646(0x27f))&&_0x5e72af[_0x2a6646(0x1f4)][_0x2a6646(0x13b2)]==='pending'){const _0x249b31=parseInt(_0x5e72af[_0x2a6646(0x1f4)][_0x2a6646(0xf16)]);!isNaN(_0x249b31)&&_0x6e71(_0x249b31);}}),document[_0x5897a1(0x458)](_0x5897a1(0x12aa))[_0x5897a1(0xd85)]('click',()=>_0x547e97(_0x5897a1(0xae))),document[_0x5897a1(0x458)]('transfer-action-decline')[_0x5897a1(0xd85)]('click',()=>_0x547e97(_0x5897a1(0x62c))),document[_0x5897a1(0x458)](_0x5897a1(0x9db))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x455e8d),document[_0x5897a1(0x458)](_0x5897a1(0x11d6))['addEventListener'](_0x5897a1(0x1122),_0x37aa62),document[_0x5897a1(0x458)](_0x5897a1(0x9b3))['addEventListener'](_0x5897a1(0x1122),_0x3014c1),document[_0x5897a1(0x458)]('cancel-post-action-btn')['addEventListener'](_0x5897a1(0x1122),_0x562409),document[_0x5897a1(0x458)](_0x5897a1(0x1420))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x46e6a4=_0x5897a1;_0x589d88(_0x46e6a4(0x1302));}),document[_0x5897a1(0x458)](_0x5897a1(0xd96))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x2ee80b=>{const _0x2e6e95=_0x5897a1,_0x3dae80=_0x2ee80b[_0x2e6e95(0x12df)]['closest'](_0x2e6e95(0x7e0));if(!_0x3dae80)return;const _0x40a526=_0x3dae80[_0x2e6e95(0x1f4)][_0x2e6e95(0x95b)];_0x3dae80['classList'][_0x2e6e95(0x1270)](_0x2e6e95(0x500)),_0xd156da[_0x2e6e95(0x31c)](_0x40a526)?_0xd156da['delete'](_0x40a526):_0xd156da[_0x2e6e95(0xa58)](_0x40a526),_0x341807();}),document[_0x5897a1(0x458)](_0x5897a1(0x7de))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{_0x32daaa();}),document[_0x5897a1(0x458)](_0x5897a1(0x6be))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x24ffd6=_0x5897a1;_0x589d88(_0x24ffd6(0xd99)),document[_0x24ffd6(0x458)](_0x24ffd6(0xa41))[_0x24ffd6(0x1122)]();}),document[_0x5897a1(0x458)](_0x5897a1(0x1064))[_0x5897a1(0xd85)]('click',_0x199f3a=>{const _0x4f4d94=_0x5897a1;_0x199f3a[_0x4f4d94(0x12df)]['classList'][_0x4f4d94(0x526)](_0x4f4d94(0x1396))&&_0x13cc00(_0x199f3a['target'][_0x4f4d94(0x1f4)]['memberId']);}),document[_0x5897a1(0x458)](_0x5897a1(0xdfb))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x5e929a=_0x5897a1,_0x55ac49=document['getElementById']('confirm-contact-picker-btn'),_0x203de6=_0x55ac49['cloneNode'](!![]);_0x55ac49['parentNode'][_0x5e929a(0x3f2)](_0x203de6,_0x55ac49),_0x203de6['addEventListener'](_0x5e929a(0x1122),_0xd7e165),await _0xfd8b85();}),document['getElementById'](_0x5897a1(0xf8e))[_0x5897a1(0xd85)]('click',_0x22d590),document[_0x5897a1(0x458)](_0x5897a1(0x883))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0xd907d5),document['getElementById'](_0x5897a1(0x13ca))[_0x5897a1(0xd85)]('click',_0xd907d5),document['getElementById']('hang-up-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x4ffcb4),document[_0x5897a1(0x458)](_0x5897a1(0x12bc))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x5b86a7=_0x5897a1;_0x4a3337[_0x5b86a7(0x9a6)]=![],_0x589d88('chat-interface-screen');}),document[_0x5897a1(0x458)](_0x5897a1(0x888))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x39a661),document[_0x5897a1(0x458)](_0x5897a1(0x424))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x311477=_0x5897a1;_0x35c2b7();const _0x27a814=_0x42f206[_0x311477(0x954)][_0x4a3337[_0x311477(0x81d)]];if(!_0x27a814)return;if(_0x4a3337['isGroupCall']){_0x4a3337[_0x311477(0x130b)]=![];const _0x40d03b={'role':_0x311477(0x1370),'content':_0x311477(0xf35),'timestamp':Date[_0x311477(0x606)](),'isHidden':!![]};_0x27a814[_0x311477(0x1d5)][_0x311477(0x129e)](_0x40d03b),await _0x17d534[_0x311477(0x954)]['put'](_0x27a814),await _0x3ee822();}else{const _0xeb6151={'role':_0x311477(0xf86),'content':'我拒绝了你的视频通话请求。','timestamp':Date[_0x311477(0x606)]()};_0x27a814[_0x311477(0x1d5)][_0x311477(0x129e)](_0xeb6151),await _0x17d534[_0x311477(0x954)][_0x311477(0xf3f)](_0x27a814),_0x589d88('chat-interface-screen'),_0x5d5ee2(_0xeb6151,_0x27a814),_0x3ee822();}_0x4a3337[_0x311477(0x9a6)]=![];}),document[_0x5897a1(0x458)](_0x5897a1(0x1e2))['addEventListener']('click',async()=>{const _0xeec2a1=_0x5897a1;_0x35c2b7(),_0x4a3337[_0xeec2a1(0x6a0)]='ai',_0x4a3337[_0xeec2a1(0x130b)]=!![],_0x4a3337[_0xeec2a1(0x81d)]=_0x42f206['activeChatId'];if(_0x4a3337[_0xeec2a1(0x60a)]){const _0x5875cc=_0x42f206['chats'][_0x4a3337[_0xeec2a1(0x81d)]],_0x59e2df=_0x5875cc[_0xeec2a1(0xfa8)][_0xeec2a1(0xb07)](_0x21779b=>_0x21779b['name']===_0x4a3337[_0xeec2a1(0xa1e)]);_0x59e2df?_0x4a3337['participants']=[_0x59e2df]:_0x4a3337[_0xeec2a1(0x1008)]=[];}_0x309acd();}),document[_0x5897a1(0x458)](_0x5897a1(0x3e7))[_0x5897a1(0xd85)]('click',async()=>{const _0x473db3=_0x5897a1;if(!_0x4a3337['isActive'])return;const _0x518b18=document[_0x473db3(0x586)](_0x473db3(0xe00));_0x518b18&&_0x518b18['classList'][_0x473db3(0xa58)]('speaking');const _0x200228=await _0x335e57('你说',_0x473db3(0xd1e));_0x518b18&&_0x518b18[_0x473db3(0x11c2)]['remove'](_0x473db3(0x297)),_0x200228&&_0x200228[_0x473db3(0x2aa)]()&&_0x4db68a(_0x200228[_0x473db3(0x2aa)]());}),document[_0x5897a1(0x586)](_0x5897a1(0x1d8))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x4c9ffc=_0x5897a1;_0x188658&&document[_0x4c9ffc(0x458)]('favorites-edit-btn')['click'](),_0x2ecab9('memories-view'),_0x17ca04();}),document[_0x5897a1(0x458)](_0x5897a1(0x81b))[_0x5897a1(0xd85)]('click',()=>_0x2ecab9('messages-view')),document['getElementById'](_0x5897a1(0xfcf))[_0x5897a1(0xd85)]('click',async()=>{const _0x171e17=_0x5897a1,_0x35c8d6=document['getElementById'](_0x171e17(0x207))[_0x171e17(0x8dd)][_0x171e17(0x2aa)](),_0x170126=document['getElementById'](_0x171e17(0xa4c))[_0x171e17(0x8dd)];if(!_0x35c8d6||!_0x170126){alert(_0x171e17(0x5bd));return;}const _0xb7f154=new Date(_0x170126);if(isNaN(_0xb7f154)||_0xb7f154<=new Date()){alert(_0x171e17(0xf31));return;}const _0x4506fc={'authorId':_0x171e17(0xf86),'description':_0x35c8d6,'timestamp':Date[_0x171e17(0x606)](),'type':_0x171e17(0x536),'targetDate':_0xb7f154[_0x171e17(0xf08)]()};await _0x17d534[_0x171e17(0x414)]['add'](_0x4506fc),document[_0x171e17(0x458)](_0x171e17(0x3a3))[_0x171e17(0x11c2)]['remove'](_0x171e17(0x67d)),_0x17ca04();}),document[_0x5897a1(0x458)](_0x5897a1(0x646))['addEventListener'](_0x5897a1(0x1122),async()=>{const _0x47049b=_0x5897a1;if(!_0x42f206[_0x47049b(0x81d)]||_0x42f206[_0x47049b(0x954)][_0x42f206[_0x47049b(0x81d)]][_0x47049b(0x726)])return;const _0xbcfc0=_0x42f206['chats'][_0x42f206[_0x47049b(0x81d)]],_0x15073c=await _0x2532b9(_0x47049b(0xe64),_0x47049b(0x9d5)+_0xbcfc0[_0x47049b(0x132a)]+'”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。',{'confirmButtonClass':_0x47049b(0x4d3)});if(_0x15073c){_0xbcfc0[_0x47049b(0x569)][_0x47049b(0x13b2)]=_0x47049b(0x12e4),_0xbcfc0['relationship'][_0x47049b(0x1230)]=Date[_0x47049b(0x606)]();const _0x3c905f={'role':_0x47049b(0x1370),'content':_0x47049b(0x1212),'timestamp':Date['now']()+0x1,'isHidden':!![]};_0xbcfc0[_0x47049b(0x1d5)][_0x47049b(0x129e)](_0x3c905f),await _0x17d534[_0x47049b(0x954)][_0x47049b(0xf3f)](_0xbcfc0),document[_0x47049b(0x458)](_0x47049b(0x8b0))[_0x47049b(0x11c2)][_0x47049b(0x1097)](_0x47049b(0x67d)),_0x359c96(_0x42f206['activeChatId']),_0x27be5e();}}),document[_0x5897a1(0x458)](_0x5897a1(0x27c))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async _0xe2b18b=>{const _0x348862=_0x5897a1,_0x40fc93=_0x42f206[_0x348862(0x954)][_0x42f206[_0x348862(0x81d)]];if(!_0x40fc93)return;if(_0xe2b18b[_0x348862(0x12df)]['id']===_0x348862(0x981)){alert(_0x348862(0x114a)),await _0x1613f7(_0x40fc93['id']),_0x359c96(_0x40fc93['id']);return;}if(_0xe2b18b[_0x348862(0x12df)]['id']===_0x348862(0x703)){_0x40fc93[_0x348862(0x569)][_0x348862(0x13b2)]=_0x348862(0xe97),_0x40fc93['relationship'][_0x348862(0x1230)]=null;const _0x242078={'role':'system','content':'[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]','timestamp':Date[_0x348862(0x606)](),'isHidden':!![]};_0x40fc93[_0x348862(0x1d5)][_0x348862(0x129e)](_0x242078),await _0x17d534[_0x348862(0x954)]['put'](_0x40fc93),_0x359c96(_0x40fc93['id']),_0x27be5e(),_0x3ee822();}else{if(_0xe2b18b['target']['id']===_0x348862(0xea9)){_0x40fc93['relationship'][_0x348862(0x13b2)]=_0x348862(0xe97),_0x40fc93[_0x348862(0x569)]['applicationReason']='';const _0x338ecc={'role':_0x348862(0x1370),'type':_0x348862(0x3bf),'content':'你通过了“'+_0x40fc93[_0x348862(0x132a)]+_0x348862(0x10f2),'timestamp':Date[_0x348862(0x606)]()};_0x40fc93[_0x348862(0x1d5)]['push'](_0x338ecc);const _0x521ad4={'role':_0x348862(0xac3),'senderName':_0x40fc93['name'],'content':'太好了！我们又可以聊天啦！','timestamp':Date[_0x348862(0x606)]()+0x1};_0x40fc93[_0x348862(0x1d5)][_0x348862(0x129e)](_0x521ad4),await _0x17d534['chats'][_0x348862(0xf3f)](_0x40fc93),_0x359c96(_0x40fc93['id']),_0x27be5e();}else{if(_0xe2b18b[_0x348862(0x12df)]['id']===_0x348862(0x129b))_0x40fc93[_0x348862(0x569)]['status']=_0x348862(0x12e4),_0x40fc93[_0x348862(0x569)][_0x348862(0x1230)]=Date['now'](),_0x40fc93[_0x348862(0x569)]['applicationReason']='',await _0x17d534['chats'][_0x348862(0xf3f)](_0x40fc93),_0x359c96(_0x40fc93['id']);else{if(_0xe2b18b[_0x348862(0x12df)]['id']==='apply-friend-btn'){const _0x1d3f80=await _0x335e57(_0x348862(0xaf6),_0x348862(0x1101)+_0x40fc93['name']+'”说的申请理由：',_0x348862(0xeec));_0x1d3f80!==null&&(_0x40fc93[_0x348862(0x569)][_0x348862(0x13b2)]='pending_ai_approval',_0x40fc93[_0x348862(0x569)]['applicationReason']=_0x1d3f80,await _0x17d534[_0x348862(0x954)][_0x348862(0xf3f)](_0x40fc93),_0x359c96(_0x40fc93['id']),_0x27be5e(),_0x3ee822());}}}}}),document[_0x5897a1(0x458)](_0x5897a1(0x5c3))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x169b48),document[_0x5897a1(0x458)](_0x5897a1(0x6b2))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x25ec3d=_0x5897a1;document[_0x25ec3d(0x458)](_0x25ec3d(0x609))[_0x25ec3d(0x11c2)][_0x25ec3d(0x1097)](_0x25ec3d(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x8cb))['addEventListener'](_0x5897a1(0x1122),_0x2e6c96),document[_0x5897a1(0x458)](_0x5897a1(0xe37))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x28e1ba);const _0x394535=document[_0x5897a1(0x458)](_0x5897a1(0x2f4)),_0x9c8c67=document['getElementById']('rp-tab-direct'),_0x4f0df5=document[_0x5897a1(0x458)](_0x5897a1(0x2ea)),_0x58af26=document[_0x5897a1(0x458)](_0x5897a1(0x1042));_0x394535[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x34c435=_0x5897a1;_0x394535[_0x34c435(0x11c2)][_0x34c435(0xa58)]('active'),_0x9c8c67[_0x34c435(0x11c2)]['remove'](_0x34c435(0xfe1)),_0x4f0df5[_0x34c435(0x1104)]['display']=_0x34c435(0x1188),_0x58af26[_0x34c435(0x1104)][_0x34c435(0x4db)]='none';}),_0x9c8c67[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x292ccb=_0x5897a1;_0x9c8c67[_0x292ccb(0x11c2)][_0x292ccb(0xa58)](_0x292ccb(0xfe1)),_0x394535[_0x292ccb(0x11c2)][_0x292ccb(0x1097)](_0x292ccb(0xfe1)),_0x58af26[_0x292ccb(0x1104)][_0x292ccb(0x4db)]='block',_0x4f0df5['style'][_0x292ccb(0x4db)]=_0x292ccb(0x464);}),document[_0x5897a1(0x458)](_0x5897a1(0x314))[_0x5897a1(0xd85)](_0x5897a1(0x754),_0x4dd38f=>{const _0x559a46=_0x5897a1,_0x41e301=parseFloat(_0x4dd38f[_0x559a46(0x12df)][_0x559a46(0x8dd)])||0x0;document[_0x559a46(0x458)](_0x559a46(0x2a2))['textContent']='¥\x20'+_0x41e301['toFixed'](0x2);}),document[_0x5897a1(0x458)]('rp-direct-amount')[_0x5897a1(0xd85)](_0x5897a1(0x754),_0x4539a0=>{const _0x4eabf8=_0x5897a1,_0x2c8ffa=parseFloat(_0x4539a0[_0x4eabf8(0x12df)][_0x4eabf8(0x8dd)])||0x0;document[_0x4eabf8(0x458)](_0x4eabf8(0x131c))[_0x4eabf8(0x1a2)]='¥\x20'+_0x2c8ffa[_0x4eabf8(0x800)](0x2);}),document['getElementById'](_0x5897a1(0x13a0))[_0x5897a1(0xd85)]('click',_0x15f4f4=>{const _0x2958c1=_0x5897a1,_0x3893b7=_0x15f4f4[_0x2958c1(0x12df)][_0x2958c1(0xe87)](_0x2958c1(0x576));if(!_0x3893b7)return;const _0x5dc301=_0x3893b7[_0x2958c1(0xe87)](_0x2958c1(0xd4f));if(!_0x5dc301||!_0x5dc301['dataset'][_0x2958c1(0xf16)])return;const _0x482845=parseInt(_0x5dc301[_0x2958c1(0x1f4)][_0x2958c1(0xf16)]);_0x442c2e(_0x482845);}),document[_0x5897a1(0x458)](_0x5897a1(0xedf))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x441c13),document[_0x5897a1(0x458)]('add-poll-option-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x4a213a),document['getElementById'](_0x5897a1(0x679))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x40426a=_0x5897a1;document[_0x40426a(0x458)]('create-poll-modal')[_0x40426a(0x11c2)][_0x40426a(0x1097)](_0x40426a(0x67d));}),document[_0x5897a1(0x458)]('confirm-create-poll-btn')['addEventListener'](_0x5897a1(0x1122),_0x511d74),document['getElementById']('chat-messages')['addEventListener'](_0x5897a1(0x1122),_0x1c3761=>{const _0x45892b=_0x5897a1,_0x429211=_0x1c3761[_0x45892b(0x12df)][_0x45892b(0xe87)](_0x45892b(0xbfb));if(!_0x429211)return;const _0x228e24=parseInt(_0x429211[_0x45892b(0x1f4)][_0x45892b(0x2da)]);if(isNaN(_0x228e24))return;const _0x2f7411=_0x1c3761[_0x45892b(0x12df)][_0x45892b(0xe87)](_0x45892b(0x6e3));if(_0x2f7411&&!_0x429211[_0x45892b(0x11c2)][_0x45892b(0x526)]('closed')){_0x5cde4c(_0x228e24,_0x2f7411[_0x45892b(0x1f4)][_0x45892b(0x790)]);return;}const _0xcaa877=_0x1c3761[_0x45892b(0x12df)][_0x45892b(0xe87)]('.poll-action-btn');if(_0xcaa877){_0x429211[_0x45892b(0x11c2)]['contains'](_0x45892b(0xd9c))?_0x5503c9(_0x228e24):_0x2a3629(_0x228e24);return;}_0x429211[_0x45892b(0x11c2)][_0x45892b(0x526)](_0x45892b(0xd9c))&&_0x5503c9(_0x228e24);}),document[_0x5897a1(0x458)](_0x5897a1(0xc24))[_0x5897a1(0xd85)]('click',_0x5f1d35),document['getElementById'](_0x5897a1(0x4b4))['addEventListener']('click',()=>_0x14da5f('ai')),document[_0x5897a1(0x458)](_0x5897a1(0x57a))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>_0x14da5f(_0x5897a1(0x1192))),document['getElementById'](_0x5897a1(0xd2))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x124c42),document[_0x5897a1(0x458)]('add-ai-avatar-upload-btn')[_0x5897a1(0xd85)]('click',()=>{const _0xe16542=_0x5897a1;document[_0xe16542(0x458)](_0xe16542(0x1f8))['click']();}),document['getElementById'](_0x5897a1(0x1f8))[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x232d06),document[_0x5897a1(0x458)](_0x5897a1(0x74d))['addEventListener'](_0x5897a1(0x1122),_0x391191),document['getElementById'](_0x5897a1(0x783))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x52ed51),document[_0x5897a1(0x458)](_0x5897a1(0xff0))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0xcbc58f),document['getElementById'](_0x5897a1(0xfeb))[_0x5897a1(0xd85)]('click',()=>{const _0x4f89e5=_0x5897a1;document[_0x4f89e5(0x458)](_0x4f89e5(0x650))[_0x4f89e5(0x1122)]();}),document[_0x5897a1(0x458)](_0x5897a1(0x650))[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x2b45cd),document[_0x5897a1(0x458)](_0x5897a1(0x141))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x1889c2),document[_0x5897a1(0x458)](_0x5897a1(0x4e1))['addEventListener'](_0x5897a1(0x1122),_0x537260=>{const _0x5eccb5=_0x5897a1;if(_0x537260[_0x5eccb5(0x12df)][_0x5eccb5(0x11c2)]['contains'](_0x5eccb5(0x234))){const _0x42c26d=_0x537260[_0x5eccb5(0x12df)][_0x5eccb5(0xe87)](_0x5eccb5(0xed3)),_0x16a3c4=_0x42c26d[_0x5eccb5(0x1f4)][_0x5eccb5(0x6bd)];_0x16a3c4&&_0x4c0d82(_0x16a3c4,_0x5eccb5(0x1464),_0x42c26d);}}),document[_0x5897a1(0x458)](_0x5897a1(0x13a0))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x21a0c3=>{const _0x1d7d38=_0x5897a1,_0x2fe7ce=_0x21a0c3[_0x1d7d38(0x12df)][_0x1d7d38(0xe87)](_0x1d7d38(0x17d));if(_0x2fe7ce){const _0x35e18d=parseInt(_0x2fe7ce['dataset'][_0x1d7d38(0xf16)]);!isNaN(_0x35e18d)&&_0x1b6903(_0x35e18d);}}),document[_0x5897a1(0x458)](_0x5897a1(0xbba))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x3701f6=_0x5897a1;_0x589d88(_0x3701f6(0xd99));}),_0xf96d9b[_0x5897a1(0xfec)][_0x5897a1(0xd85)]('click',async _0x4ed073=>{const _0x182c88=_0x5897a1,_0x2cd208=_0x4ed073[_0x182c88(0x12df)][_0x182c88(0xe87)](_0x182c88(0x10ce));if(_0x2cd208&&_0xf96d9b[_0x182c88(0x10a2)]!==null){const _0x48a8f6=_0x2cd208[_0x182c88(0x1104)][_0x182c88(0xf7)]['slice'](0x5,-0x2),_0x47436a=_0x42f206[_0x182c88(0x1294)][_0x182c88(0xb07)](_0x11c8c8=>_0x11c8c8[_0x182c88(0x1377)]===_0x48a8f6);_0x47436a?await _0x4bce80(_0xf96d9b['activePostId'],_0x47436a):console[_0x182c88(0x1b6)]('在动态评论区点击了表情，但在表情库中未找到对象:',_0x48a8f6);}}),document['addEventListener']('click',_0x4931ed=>{const _0x56d10f=_0x5897a1;_0xf96d9b[_0x56d10f(0x12f8)]&&!_0xf96d9b[_0x56d10f(0xfec)][_0x56d10f(0x526)](_0x4931ed[_0x56d10f(0x12df)])&&!_0x4931ed['target']['closest'](_0x56d10f(0x224))&&_0x117c0b();}),document['getElementById']('share-link-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x5ced16),document[_0x5897a1(0x458)](_0x5897a1(0x10b6))['addEventListener']('click',()=>{const _0x1b34b6=_0x5897a1;document[_0x1b34b6(0x458)](_0x1b34b6(0x684))[_0x1b34b6(0x11c2)][_0x1b34b6(0x1097)](_0x1b34b6(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x244))['addEventListener']('click',_0x575939),document[_0x5897a1(0x458)]('theme-toggle-switch')[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x435af5),document[_0x5897a1(0x458)](_0x5897a1(0x63c))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x3d4cde),document['getElementById'](_0x5897a1(0x907))['addEventListener'](_0x5897a1(0x1122),_0x351a9b),document[_0x5897a1(0x458)](_0x5897a1(0x1b0))[_0x5897a1(0xd85)]('click',()=>{_0x589d88('chat-list-screen');}),document['getElementById'](_0x5897a1(0x349))['addEventListener'](_0x5897a1(0x1122),_0x32937f=>{const _0x51c933=_0x5897a1,_0x31d36b=_0x32937f[_0x51c933(0x12df)][_0x51c933(0xe87)](_0x51c933(0xa8c));_0x31d36b&&_0x31d36b[_0x51c933(0x1f4)][_0x51c933(0x12bb)]&&_0x39f00e(parseInt(_0x31d36b['dataset']['recordId']));}),document['getElementById'](_0x5897a1(0x10b4))[_0x5897a1(0xd85)]('click',()=>{const _0x1c3673=_0x5897a1;document[_0x1c3673(0x458)](_0x1c3673(0x452))[_0x1c3673(0x11c2)][_0x1c3673(0x1097)]('visible');}),document[_0x5897a1(0x458)](_0x5897a1(0x1250))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x570520),document[_0x5897a1(0x458)](_0x5897a1(0xba2))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x24a90a=_0x5897a1;_0x3e3048[_0x24a90a(0x12a4)]>0x0&&_0x5a5e55();}),document[_0x5897a1(0x458)](_0x5897a1(0xda1))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x155bc1),document['getElementById'](_0x5897a1(0xe3b))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x4ac182=_0x5897a1,_0x1f9866=_0x42f206[_0x4ac182(0x954)][_0x42f206[_0x4ac182(0x81d)]],_0x1ca993=Array[_0x4ac182(0xca2)](document['querySelectorAll'](_0x4ac182(0x7e7)))[_0x4ac182(0xbf6)](_0x57880c=>_0x57880c['dataset']['chatId']);if(_0x1ca993[_0x4ac182(0x131d)]===0x0){alert(_0x4ac182(0x215));return;}const _0x593e11=[],_0x570ad2=[..._0x3e3048][_0x4ac182(0xc12)]((_0x571000,_0x4913c9)=>_0x571000-_0x4913c9);for(const _0x1059c2 of _0x570ad2){const _0x4843a1=_0x1f9866[_0x4ac182(0x1d5)][_0x4ac182(0xb07)](_0x23a8c0=>_0x23a8c0[_0x4ac182(0xf16)]===_0x1059c2);_0x4843a1&&_0x593e11[_0x4ac182(0x129e)](_0x4843a1);}const _0x36cd40={'role':'user','senderName':_0x1f9866['isGroup']?_0x1f9866[_0x4ac182(0xda2)][_0x4ac182(0xc7d)]||'我':'我','type':_0x4ac182(0x12a0),'timestamp':Date[_0x4ac182(0x606)](),'payload':{'sourceChatName':_0x1f9866['name'],'title':_0x4ac182(0x140f)+_0x1f9866['name']+_0x4ac182(0xc8f),'sharedHistory':_0x593e11}};for(const _0x5a1858 of _0x1ca993){const _0x12a2f5=_0x42f206[_0x4ac182(0x954)][_0x5a1858];_0x12a2f5&&(_0x12a2f5[_0x4ac182(0x1d5)]['push'](_0x36cd40),await _0x17d534[_0x4ac182(0x954)]['put'](_0x12a2f5));}document[_0x4ac182(0x458)]('share-target-modal')[_0x4ac182(0x11c2)][_0x4ac182(0x1097)](_0x4ac182(0x67d)),_0x5bc130(),await _0x34fce8(_0x4ac182(0x757),_0x4ac182(0xfe8)+_0x1ca993[_0x4ac182(0x131d)]+_0x4ac182(0xcb0)),_0x27be5e();}),document[_0x5897a1(0x458)](_0x5897a1(0x1067))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x20b633=_0x5897a1;document[_0x20b633(0x458)](_0x20b633(0x1155))[_0x20b633(0x11c2)][_0x20b633(0x1097)]('visible');}),document[_0x5897a1(0x458)]('chat-messages')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x28a911=>{const _0x43a119=_0x5897a1,_0x1e2470=_0x28a911['target'][_0x43a119(0xe87)](_0x43a119(0x10f8));if(_0x1e2470&&_0x1e2470[_0x43a119(0xe87)](_0x43a119(0x4a6))){const _0x37a4b2=parseInt(_0x1e2470[_0x43a119(0x1f4)][_0x43a119(0xf16)]);_0x2d62fa(_0x37a4b2);}}),document[_0x5897a1(0x458)](_0x5897a1(0x713))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x82ef4d=_0x5897a1;document[_0x82ef4d(0x458)]('shared-history-viewer-modal')[_0x82ef4d(0x11c2)][_0x82ef4d(0x1097)](_0x82ef4d(0x67d));});async function _0x2d62fa(_0x10a0b3){const _0x56a670=_0x5897a1,_0x448f73=_0x42f206[_0x56a670(0x954)][_0x42f206[_0x56a670(0x81d)]];if(!_0x448f73)return;const _0x2f4af6=_0x448f73[_0x56a670(0x1d5)][_0x56a670(0xb07)](_0x32af0b=>_0x32af0b['timestamp']===_0x10a0b3);if(!_0x2f4af6){console[_0x56a670(0xb61)](_0x56a670(0x10be),_0x10a0b3),await _0x34fce8(_0x56a670(0x10fc),_0x56a670(0x9ce));return;}if(_0x2f4af6[_0x56a670(0x259)]===_0x56a670(0xbd0)){_0x1b6903(_0x10a0b3);return;}if(_0x2f4af6[_0x56a670(0x259)]===_0x56a670(0x12a0)){if(!_0x2f4af6[_0x56a670(0xdbc)]||!_0x2f4af6[_0x56a670(0xdbc)]['sharedHistory']){console[_0x56a670(0xb61)](_0x56a670(0x1452),_0x2f4af6),await _0x34fce8(_0x56a670(0x10fc),_0x56a670(0xa05));return;}}else{console[_0x56a670(0xb61)](_0x56a670(0x118b),_0x2f4af6[_0x56a670(0x259)]),await _0x34fce8(_0x56a670(0x10fc),_0x56a670(0xeaa));return;}const _0x560afe=document[_0x56a670(0x458)](_0x56a670(0xa09)),_0x53bdd1=document[_0x56a670(0x458)](_0x56a670(0xe0d)),_0x2d6c2c=document['getElementById'](_0x56a670(0xcb));_0x53bdd1['textContent']=_0x2f4af6[_0x56a670(0xdbc)][_0x56a670(0x316)],_0x2d6c2c[_0x56a670(0x110d)]='';const _0x23b0e1=document[_0x56a670(0xdb7)](),_0x5495c2=Object[_0x56a670(0x6eb)](_0x42f206[_0x56a670(0x954)])[_0x56a670(0xb07)](_0x348a20=>_0x348a20[_0x56a670(0x132a)]===_0x2f4af6[_0x56a670(0xdbc)]['sourceChatName'])||_0x448f73;for(const _0x8a45cd of _0x2f4af6[_0x56a670(0xdbc)][_0x56a670(0x1160)]){const _0x256b0d=await _0x4b8ea5(_0x8a45cd,_0x5495c2);_0x256b0d&&_0x23b0e1[_0x56a670(0x1079)](_0x256b0d);}_0x2d6c2c[_0x56a670(0x1079)](_0x23b0e1),_0x560afe['classList'][_0x56a670(0xa58)](_0x56a670(0x67d));}_0x112d48[_0x5897a1(0xd85)](_0x5897a1(0x57c),_0x2a7978),_0x112d48[_0x5897a1(0xd85)]('pause',()=>{const _0x104654=_0x5897a1;_0x59377b[_0x104654(0x1196)]&&(_0x59377b[_0x104654(0x1111)]=![],_0x481fb2());}),_0x112d48['addEventListener'](_0x5897a1(0x1391),()=>{const _0x4d7fbc=_0x5897a1;_0x59377b[_0x4d7fbc(0x1196)]&&(_0x59377b[_0x4d7fbc(0x1111)]=!![],_0x481fb2());}),document['getElementById'](_0x5897a1(0x67c))['addEventListener'](_0x5897a1(0x1122),async _0xc717e2=>{const _0x485b6f=_0x5897a1,_0x1b0ae6=_0xc717e2[_0x485b6f(0x12df)],_0x2e38d0=_0x1b0ae6[_0x485b6f(0xe87)](_0x485b6f(0xd48));if(_0x2e38d0){const _0x5ec21f=parseInt(_0x2e38d0['dataset']['index']);!isNaN(_0x5ec21f)&&await _0x1ab71a(_0x5ec21f);return;}const _0x4bd871=_0x1b0ae6[_0x485b6f(0xe87)](_0x485b6f(0xafd));if(_0x4bd871){const _0x3a1e04=parseInt(_0x4bd871[_0x485b6f(0x1f4)][_0x485b6f(0xb3)]);if(isNaN(_0x3a1e04))return;await _0x97e5ff(_0x3a1e04);return;}const _0x44c03c=_0x1b0ae6[_0x485b6f(0xe87)]('.delete-track-btn');if(_0x44c03c){const _0x5c06f4=parseInt(_0x44c03c[_0x485b6f(0x1f4)][_0x485b6f(0xb3)]);if(isNaN(_0x5c06f4))return;const _0x59824c=_0x59377b[_0x485b6f(0x1102)][_0x5c06f4],_0x49c06a=await _0x2532b9('删除歌曲',_0x485b6f(0xd98)+_0x59824c[_0x485b6f(0x132a)]+'》吗？');_0x49c06a&&_0xfe0b79(_0x5c06f4);return;}const _0x560fd9=_0x1b0ae6[_0x485b6f(0xe87)](_0x485b6f(0x532));if(_0x560fd9){const _0x387851=_0x560fd9['closest'](_0x485b6f(0xd7a)),_0x5d14f9=Array[_0x485b6f(0xca2)](_0x387851[_0x485b6f(0x1389)][_0x485b6f(0xf2e)])[_0x485b6f(0x893)](_0x387851);_0x5d14f9>-0x1&&_0x50e8cd(_0x5d14f9);}}),document[_0x5897a1(0x586)](_0x5897a1(0x840))['addEventListener'](_0x5897a1(0x1122),_0x3b1ec5=>{const _0xdba10=_0x5897a1;if(!_0x112d48[_0xdba10(0x563)])return;const _0x5b3e31=_0x3b1ec5[_0xdba10(0xdb2)],_0x167818=_0x5b3e31['clientWidth'],_0x3d0f84=_0x3b1ec5[_0xdba10(0x12b4)];_0x112d48[_0xdba10(0x4b1)]=_0x3d0f84/_0x167818*_0x112d48[_0xdba10(0x563)];}),document[_0x5897a1(0x458)]('chat-messages')['addEventListener'](_0x5897a1(0x1122),_0x2934cf=>{const _0x21b182=_0x5897a1,_0x330f6b=_0x2934cf[_0x21b182(0x12df)][_0x21b182(0xe87)](_0x21b182(0xa04));if(_0x330f6b){const _0x505907=_0x42f206['chats'][_0x42f206['activeChatId']],_0x231911=_0x330f6b['closest']('.message-wrapper');if(_0x505907&&_0x231911){const _0x95abe8=parseInt(_0x231911[_0x21b182(0x1f4)][_0x21b182(0xf16)]),_0x5a762f=_0x505907['history']['find'](_0x445c66=>_0x445c66['timestamp']===_0x95abe8);if(_0x5a762f&&_0x5a762f[_0x21b182(0x624)]){let _0xfec3e1='';const _0x101cf0=_0x5a762f[_0x21b182(0x624)];switch(_0x101cf0[_0x21b182(0x603)]){case _0x21b182(0xdd5):_0xfec3e1=_0x21b182(0x6c4)+_0x101cf0['originalContent']+'\x22';break;case _0x21b182(0x305):case'ai_image':case _0x21b182(0x1237):_0xfec3e1=_0x21b182(0x8a5)+_0x101cf0[_0x21b182(0x1f0)]+'\x22';break;case'voice_message':_0xfec3e1=_0x21b182(0xa9a)+_0x101cf0[_0x21b182(0x1f0)]+'\x22';break;case _0x21b182(0x869):_0xfec3e1=_0x21b182(0xe92)+(_0x101cf0['originalMeaning']||_0x21b182(0x285))+_0x21b182(0x411)+_0x101cf0[_0x21b182(0x1f0)];break;case'transfer':_0xfec3e1=_0x21b182(0x4c3);break;default:_0xfec3e1=_0x21b182(0xa5c)+_0x101cf0[_0x21b182(0x603)]+']类型的消息。\x0a内容:\x20'+JSON[_0x21b182(0xc04)](_0x101cf0[_0x21b182(0x1f0)]);break;}_0x34fce8('已撤回的消息',_0xfec3e1);}}}}),document['getElementById'](_0x5897a1(0x1415))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x33d53f),document[_0x5897a1(0x458)](_0x5897a1(0xd06))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x410cd9=_0x5897a1;document[_0x410cd9(0x458)](_0x410cd9(0x9f))[_0x410cd9(0x11c2)][_0x410cd9(0x1097)](_0x410cd9(0x67d)),_0x1e4af5();}),document[_0x5897a1(0x458)](_0x5897a1(0xb54))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x3284cc),document[_0x5897a1(0x458)](_0x5897a1(0x2d1))[_0x5897a1(0xd85)]('click',_0x3fb724=>{const _0x39702d=_0x5897a1;if(_0x3fb724['target'][_0x39702d(0x11c2)][_0x39702d(0x526)](_0x39702d(0xb6e))){const _0x300732=parseInt(_0x3fb724[_0x39702d(0x12df)][_0x39702d(0x1f4)]['id']);_0x266a3b(_0x300732);}}),document[_0x5897a1(0x458)](_0x5897a1(0x346))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x3b0765),document['getElementById'](_0x5897a1(0x30f))['addEventListener'](_0x5897a1(0x1122),_0x1d50d3),document[_0x5897a1(0x458)](_0x5897a1(0xd57))['addEventListener']('click',_0x306207),document[_0x5897a1(0x458)](_0x5897a1(0xa3e))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0xd2d593),document[_0x5897a1(0x458)](_0x5897a1(0x1ca))['addEventListener'](_0x5897a1(0x754),_0x3d2ee2=>{const _0x3da27f=_0x5897a1;if(!_0x3d2ee2[_0x3da27f(0x12df)][_0x3da27f(0xd2f)](_0x3da27f(0x118a)))return;const _0x3221c7=_0x3d2ee2[_0x3da27f(0x12df)],_0x3e1922=_0x3221c7['closest'](_0x3da27f(0xf5a));if(!_0x3e1922)return;const _0x421a65=_0x3e1922[_0x3da27f(0x586)]('.at-mention-popup'),_0x425aec=_0x3221c7['value'],_0x3f4f72=_0x425aec[_0x3da27f(0x41c)](/@([\p{L}\w]*)$/u);if(_0x3f4f72){const _0x36a7b5=new Set(),_0x207de9=_0x3e1922[_0x3da27f(0x586)](_0x3da27f(0xef4))?.[_0x3da27f(0x1a2)];if(_0x207de9)_0x36a7b5[_0x3da27f(0xa58)](_0x207de9);_0x3e1922[_0x3da27f(0x102a)](_0x3da27f(0xa03))[_0x3da27f(0x12c2)](_0x1c08cb=>{const _0x3a4687=_0x3da27f;_0x36a7b5[_0x3a4687(0xa58)](_0x1c08cb['textContent']['replace'](':',''));}),_0x36a7b5['delete'](_0x42f206[_0x3da27f(0x551)]['nickname']),_0x421a65[_0x3da27f(0x110d)]='';if(_0x36a7b5[_0x3da27f(0x12a4)]>0x0){const _0x332094=_0x3f4f72[0x1];_0x36a7b5[_0x3da27f(0x12c2)](_0x4c5881=>{const _0x532ba8=_0x3da27f;if(_0x4c5881[_0x532ba8(0xb15)]()[_0x532ba8(0xd8d)](_0x332094[_0x532ba8(0xb15)]())){const _0x45a625=document[_0x532ba8(0xe7d)]('div');_0x45a625[_0x532ba8(0x69b)]=_0x532ba8(0x9e),_0x45a625[_0x532ba8(0x1a2)]=_0x4c5881,_0x45a625[_0x532ba8(0xd85)](_0x532ba8(0x7d2),_0x37c013=>{const _0x43fc64=_0x532ba8;_0x37c013['preventDefault']();const _0x267339=_0x425aec[_0x43fc64(0xa6d)](0x0,_0x3f4f72[_0x43fc64(0xb3)])+('@'+_0x4c5881+'\x20');_0x3221c7[_0x43fc64(0x8dd)]=_0x267339,_0x421a65[_0x43fc64(0x1104)][_0x43fc64(0x4db)]=_0x43fc64(0x464),_0x3221c7[_0x43fc64(0x1248)]();}),_0x421a65[_0x532ba8(0x1079)](_0x45a625);}}),_0x421a65[_0x3da27f(0x1104)][_0x3da27f(0x4db)]=_0x421a65[_0x3da27f(0xf2e)][_0x3da27f(0x131d)]>0x0?_0x3da27f(0x1188):_0x3da27f(0x464);}else _0x421a65[_0x3da27f(0x1104)][_0x3da27f(0x4db)]=_0x3da27f(0x464);}else _0x421a65['style']['display']=_0x3da27f(0x464);}),document['getElementById'](_0x5897a1(0x1ca))[_0x5897a1(0xd85)](_0x5897a1(0x575),_0x4f1819=>{const _0x1ae7a5=_0x5897a1;if(_0x4f1819[_0x1ae7a5(0x12df)][_0x1ae7a5(0xd2f)](_0x1ae7a5(0x118a))){const _0x3e8e7b=_0x4f1819[_0x1ae7a5(0x12df)][_0x1ae7a5(0xe87)](_0x1ae7a5(0xf5a));if(_0x3e8e7b){const _0x36f089=_0x3e8e7b['querySelector'](_0x1ae7a5(0x7c5));_0x36f089&&setTimeout(()=>{const _0x5adfdf=_0x1ae7a5;_0x36f089[_0x5adfdf(0x1104)][_0x5adfdf(0x4db)]='none';},0xc8);}}});const _0x5df16f=document[_0x5897a1(0x458)](_0x5897a1(0x238)),_0x38b9c2=document['getElementById'](_0x5897a1(0xff5));_0x5df16f[_0x5897a1(0xd85)](_0x5897a1(0x754),()=>{const _0x297d98=_0x5897a1;if(!_0x42f206['activeChatId']||!_0x42f206[_0x297d98(0x954)][_0x42f206[_0x297d98(0x81d)]][_0x297d98(0x726)]){_0x38b9c2[_0x297d98(0x1104)][_0x297d98(0x4db)]=_0x297d98(0x464);return;}const _0x5be3af=_0x42f206[_0x297d98(0x954)][_0x42f206[_0x297d98(0x81d)]],_0x255905=_0x5df16f[_0x297d98(0x8dd)],_0x597c36=_0x255905['match'](/@([\p{L}\w]*)$/u);if(_0x597c36){const _0x593404=_0x5be3af[_0x297d98(0xda2)]['myNickname']||'我',_0x902005=_0x5be3af[_0x297d98(0xfa8)][_0x297d98(0xbf6)](_0x32520e=>_0x32520e[_0x297d98(0x1118)])[_0x297d98(0xaf1)](_0x5238b7=>_0x5238b7!==_0x593404);_0x38b9c2[_0x297d98(0x110d)]='';if(_0x902005[_0x297d98(0x131d)]>0x0){const _0x575e25=_0x597c36[0x1];_0x902005[_0x297d98(0x12c2)](_0x2ca9a2=>{const _0x10f8fc=_0x297d98;if(_0x2ca9a2[_0x10f8fc(0xb15)]()['includes'](_0x575e25[_0x10f8fc(0xb15)]())){const _0x397b26=document[_0x10f8fc(0xe7d)](_0x10f8fc(0x1323));_0x397b26[_0x10f8fc(0x69b)]=_0x10f8fc(0x9e),_0x397b26[_0x10f8fc(0x1a2)]=_0x2ca9a2,_0x397b26['addEventListener'](_0x10f8fc(0x7d2),_0x33e2b5=>{const _0x2b1d3a=_0x10f8fc;_0x33e2b5[_0x2b1d3a(0xae3)]();const _0x6ead0f=_0x255905[_0x2b1d3a(0xa6d)](0x0,_0x597c36[_0x2b1d3a(0xb3)])+('@'+_0x2ca9a2+'\x20');_0x5df16f[_0x2b1d3a(0x8dd)]=_0x6ead0f,_0x38b9c2[_0x2b1d3a(0x1104)][_0x2b1d3a(0x4db)]=_0x2b1d3a(0x464),_0x5df16f[_0x2b1d3a(0x1248)]();}),_0x38b9c2[_0x10f8fc(0x1079)](_0x397b26);}}),_0x38b9c2[_0x297d98(0x1104)][_0x297d98(0x4db)]=_0x38b9c2[_0x297d98(0xf2e)]['length']>0x0?_0x297d98(0x1188):_0x297d98(0x464);}else _0x38b9c2[_0x297d98(0x1104)]['display']=_0x297d98(0x464);}else _0x38b9c2[_0x297d98(0x1104)][_0x297d98(0x4db)]='none';}),_0x5df16f['addEventListener'](_0x5897a1(0x545),()=>{setTimeout(()=>{const _0x1c4391=_0x1a5b;_0x38b9c2[_0x1c4391(0x1104)][_0x1c4391(0x4db)]=_0x1c4391(0x464);},0xc8);}),document['getElementById']('publish-to-announcement-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x89000c),document[_0x5897a1(0x458)](_0x5897a1(0xd2a))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x5c7136),document[_0x5897a1(0x458)](_0x5897a1(0xfb9))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x135d48=_0x5897a1;document['getElementById'](_0x135d48(0x1376))[_0x135d48(0x11c2)][_0x135d48(0x1097)](_0x135d48(0x67d));}),document['getElementById']('announcement-board-content')[_0x5897a1(0xd85)]('click',_0x51925e=>{const _0x5365df=_0x5897a1;if(_0x51925e['target'][_0x5365df(0x11c2)]['contains'](_0x5365df(0x13f9))){const _0x54692b=_0x51925e[_0x5365df(0x12df)][_0x5365df(0x1f4)][_0x5365df(0x106d)];_0x54692b&&_0x1ccf27(_0x54692b);}}),document[_0x5897a1(0x458)](_0x5897a1(0xeba))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x135c92),document[_0x5897a1(0x458)]('announcement-action-delete')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x32362a),document['getElementById'](_0x5897a1(0x62e))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x1f9dcd=_0x5897a1;document[_0x1f9dcd(0x458)](_0x1f9dcd(0x110))[_0x1f9dcd(0x11c2)][_0x1f9dcd(0x1097)](_0x1f9dcd(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x11ad))['addEventListener'](_0x5897a1(0x1122),()=>{const _0xbdbcc5=_0x5897a1;document[_0xbdbcc5(0x458)](_0xbdbcc5(0xb1d))['value']='';}),document['getElementById'](_0x5897a1(0x107))['addEventListener']('click',_0x2f8e76),document[_0x5897a1(0x458)](_0x5897a1(0xdde))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{_0x589d88('chat-interface-screen');}),document[_0x5897a1(0x458)](_0x5897a1(0x4d6))[_0x5897a1(0xd85)]('click',_0x439285),document['getElementById'](_0x5897a1(0x156))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x5d1aeb),document['getElementById'](_0x5897a1(0x605))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x58c337=>{const _0x1d2c85=_0x5897a1,_0x2504d6=_0x58c337[_0x1d2c85(0x12df)]['closest'](_0x1d2c85(0xf84));if(_0x2504d6){_0x4993f6(_0x2504d6[_0x1d2c85(0x1f4)]['authorId'],parseInt(_0x2504d6['dataset']['memoryTimestamp']));return;}const _0x432bf9=_0x58c337[_0x1d2c85(0x12df)][_0x1d2c85(0xe87)](_0x1d2c85(0xfb));if(_0x432bf9){_0xdf6935(_0x432bf9[_0x1d2c85(0x1f4)][_0x1d2c85(0x1086)],parseInt(_0x432bf9[_0x1d2c85(0x1f4)][_0x1d2c85(0xe09)]));return;}}),document['getElementById'](_0x5897a1(0x140c))[_0x5897a1(0xd85)]('click',_0x1e0ac0),document[_0x5897a1(0x458)]('close-gomoku-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x3c0a25);const _0x291ef0=document[_0x5897a1(0x458)](_0x5897a1(0xac2));_0x291ef0[_0x5897a1(0xd85)](_0x5897a1(0xc65),_0x5c3403),_0x291ef0['addEventListener'](_0x5897a1(0x5bb),()=>_0xf69f1a(_0x42f206['activeChatId'])),_0x291ef0[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0xef301f),document[_0x5897a1(0x458)]('add-countdown-btn')[_0x5897a1(0xd85)]('click',()=>{const _0x1ad77e=_0x5897a1;document['getElementById'](_0x1ad77e(0x207))[_0x1ad77e(0x8dd)]='',document[_0x1ad77e(0x458)](_0x1ad77e(0xa4c))['value']='',document['getElementById'](_0x1ad77e(0x3a3))['classList']['add'](_0x1ad77e(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x7ae))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x36e8cf=_0x5897a1;document[_0x36e8cf(0x458)](_0x36e8cf(0x3a3))[_0x36e8cf(0x11c2)][_0x36e8cf(0x1097)](_0x36e8cf(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x1066))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x590b31),document[_0x5897a1(0x458)]('delete-call-message-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x3a1dbf),document[_0x5897a1(0x458)](_0x5897a1(0x61f))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x30a3c1),document[_0x5897a1(0x458)]('edit-last-response-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x575ece),document[_0x5897a1(0x458)](_0x5897a1(0x336))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x55707f=_0x5897a1;document['getElementById'](_0x55707f(0x6ac))[_0x55707f(0x11c2)][_0x55707f(0x1097)](_0x55707f(0x67d));}),document['getElementById'](_0x5897a1(0x342))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0xb84736),document[_0x5897a1(0x458)](_0x5897a1(0x7fd))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0xd495b4=_0x5897a1,_0x34ea90=document['getElementById']('ai-response-editor-container'),_0x5eddef=_0x6a940(_0xd495b4(0x6f));_0x34ea90['appendChild'](_0x5eddef),_0x5eddef['querySelector'](_0xd495b4(0xb43))[_0xd495b4(0x1248)]();}),document[_0x5897a1(0x458)](_0x5897a1(0x1328))['addEventListener'](_0x5897a1(0x1122),_0x2e9184),document[_0x5897a1(0x458)](_0x5897a1(0x124b))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x2ef045),document[_0x5897a1(0x458)](_0x5897a1(0xf95))['addEventListener'](_0x5897a1(0x1122),_0x40ccfc),document[_0x5897a1(0x458)](_0x5897a1(0xa18))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x25d893=_0x5897a1;document[_0x25d893(0x458)](_0x25d893(0xf6c))['click']();}),document['getElementById'](_0x5897a1(0xf6c))[_0x5897a1(0xd85)]('change',_0x25d7d3),document[_0x5897a1(0x458)]('add-my-avatar-batch-btn')[_0x5897a1(0xd85)]('click',async()=>{const _0x1218ad=_0x5897a1,_0x820091=_0x1218ad(0xf94),_0x4bdb70=await _0x335e57('批量导入头像',_0x820091,'',_0x1218ad(0xb43));_0x4bdb70&&_0x4bdb70[_0x1218ad(0x2aa)]()&&await _0x3c59eb(_0x4bdb70);}),document[_0x5897a1(0x458)]('open-shopping-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x23a932),document[_0x5897a1(0x458)](_0x5897a1(0xe02))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>_0x589d88('chat-interface-screen')),document[_0x5897a1(0x458)](_0x5897a1(0x22a))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x16d996),document[_0x5897a1(0x458)](_0x5897a1(0x13d4))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x23a932),document[_0x5897a1(0x458)](_0x5897a1(0x6b3))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x48d0d8),document[_0x5897a1(0x458)](_0x5897a1(0xee6))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0xc60527=_0x5897a1;document['getElementById']('gift-receipt-modal')[_0xc60527(0x11c2)][_0xc60527(0x1097)]('visible');}),document[_0x5897a1(0x458)](_0x5897a1(0xeff))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x1a8681=_0x5897a1;_0x314234=!_0x314234;const _0x12e581=document[_0x1a8681(0x458)]('manage-products-btn'),_0x224e1b=document[_0x1a8681(0x458)](_0x1a8681(0xea1)),_0x17d44b=document[_0x1a8681(0x458)](_0x1a8681(0xd65));_0x12e581['style'][_0x1a8681(0x961)]=_0x314234?'var(--accent-color)':'var(--text-primary)',_0x314234?(_0x224e1b[_0x1a8681(0x1104)]['display']=_0x1a8681(0x82b),_0x17d44b[_0x1a8681(0x1104)][_0x1a8681(0x43a)]='80px'):(_0x224e1b[_0x1a8681(0x1104)][_0x1a8681(0x4db)]=_0x1a8681(0x464),_0x17d44b[_0x1a8681(0x1104)][_0x1a8681(0x43a)]='',_0x4fc6cc[_0x1a8681(0x415)](),document[_0x1a8681(0x102a)](_0x1a8681(0x4e4))[_0x1a8681(0x12c2)](_0x1d332b=>_0x1d332b['classList'][_0x1a8681(0x1097)](_0x1a8681(0x500))),document[_0x1a8681(0x458)](_0x1a8681(0x11c))['textContent']=_0x1a8681(0xb5f),document[_0x1a8681(0x458)](_0x1a8681(0x11d0))[_0x1a8681(0x8f7)]=![]),_0x1044f9(),_0x2c1038();}),document[_0x5897a1(0x458)](_0x5897a1(0x10b8))[_0x5897a1(0xd85)]('click',()=>{const _0xd7078c=_0x5897a1;_0x314234?_0x24570e(null):alert(_0xd7078c(0xcfa));}),document[_0x5897a1(0x458)]('product-grid')[_0x5897a1(0xd85)](_0x5897a1(0x1122),async _0x388438=>{const _0x7be959=_0x5897a1,_0x546a86=_0x388438[_0x7be959(0x12df)][_0x7be959(0xe87)]('.product-item');if(!_0x546a86)return;const _0x3418bf=parseInt(_0x546a86[_0x7be959(0x1f4)]['id']);if(isNaN(_0x3418bf))return;if(_0x314234){if(_0x388438[_0x7be959(0x12df)][_0x7be959(0x11c2)][_0x7be959(0x526)](_0x7be959(0xab3))){_0x24570e(_0x3418bf);return;}if(_0x388438[_0x7be959(0x12df)]['classList'][_0x7be959(0x526)](_0x7be959(0x130a))){const _0x3c0b61=await _0x17d534['shoppingProducts']['get'](_0x3418bf);if(!_0x3c0b61)return;const _0x320570=await _0x2532b9(_0x7be959(0x1356),_0x7be959(0x42c)+_0x3c0b61['name']+_0x7be959(0x581),{'confirmButtonClass':_0x7be959(0x4d3)});_0x320570&&(await _0x17d534['shoppingProducts'][_0x7be959(0x195)](_0x3418bf),await _0x1044f9(),alert(_0x7be959(0x643)));return;}_0x546a86[_0x7be959(0x11c2)]['toggle']('selected');_0x4fc6cc['has'](_0x3418bf)?_0x4fc6cc[_0x7be959(0x195)](_0x3418bf):_0x4fc6cc[_0x7be959(0xa58)](_0x3418bf);document['getElementById'](_0x7be959(0x11c))[_0x7be959(0x1a2)]=_0x7be959(0xeab)+_0x4fc6cc['size']+')';return;}if(_0x388438[_0x7be959(0x12df)][_0x7be959(0x11c2)][_0x7be959(0x526)](_0x7be959(0xc6d))){const _0x2c9e55=await _0x17d534[_0x7be959(0x122c)][_0x7be959(0x36d)](_0x3418bf);_0x2c9e55['variations']&&_0x2c9e55[_0x7be959(0xae6)][_0x7be959(0x131d)]>0x0?_0x3ec6cd(_0x3418bf):(await _0x4185d9(_0x3418bf),await _0x34fce8('成功',_0x7be959(0x5d1)));return;}_0x546a86['contains'](_0x388438[_0x7be959(0x12df)])&&console[_0x7be959(0x7d1)]('点击了商品卡片:\x20'+_0x3418bf);}),document[_0x5897a1(0x458)](_0x5897a1(0x12d))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x49d5bb=>{const _0x5647c2=_0x5897a1,_0x13c97b=_0x49d5bb[_0x5647c2(0x12df)];_0x13c97b[_0x5647c2(0x11c2)][_0x5647c2(0x526)](_0x5647c2(0xcc7))&&_0x4434cf(parseInt(_0x13c97b[_0x5647c2(0x1f4)]['id']),-0x1),_0x13c97b[_0x5647c2(0x11c2)]['contains'](_0x5647c2(0x13e6))&&_0x4434cf(parseInt(_0x13c97b[_0x5647c2(0x1f4)]['id']),0x1),_0x13c97b[_0x5647c2(0x11c2)][_0x5647c2(0x526)](_0x5647c2(0x135))&&_0x3e435e();}),document[_0x5897a1(0x458)](_0x5897a1(0x4f1))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x1754bb=_0x5897a1;if(_0x6bbec1[_0x1754bb(0x131d)]===0x0)return;const _0x52c9d9=await _0x2532b9(_0x1754bb(0xfd9),'确定要清空购物车中的所有商品吗？');_0x52c9d9&&(_0x6bbec1=[],_0x4117ee(),_0x21ebe8());}),document[_0x5897a1(0x458)](_0x5897a1(0xe25))[_0x5897a1(0xd85)](_0x5897a1(0x26a),function(_0x2ea630){const _0x532ea7=_0x5897a1;document[_0x532ea7(0x102a)](_0x532ea7(0x1aa))[_0x532ea7(0x12c2)](_0xe513eb=>{const _0xbb774e=_0x532ea7;_0xe513eb[_0xbb774e(0x8f7)]=_0x2ea630[_0xbb774e(0x12df)][_0xbb774e(0x8f7)];}),_0x3e435e();}),document['getElementById'](_0x5897a1(0xfbb))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x501373=_0x5897a1;document[_0x501373(0x458)](_0x501373(0x99f))[_0x501373(0x11c2)][_0x501373(0x1097)](_0x501373(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x33f))[_0x5897a1(0xd85)]('click',_0x52834f),document[_0x5897a1(0x458)]('product-image-input')[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x5215d6=>{const _0x455728=_0x5897a1,_0xbc6b9b=_0x5215d6['target'][_0x455728(0x1a9)][0x0];if(_0xbc6b9b){const _0x3922a3=new FileReader();_0x3922a3[_0x455728(0x11fa)]=_0x58e50a=>{const _0x3e9638=_0x455728;document['getElementById'](_0x3e9638(0x1059))[_0x3e9638(0x577)]=_0x58e50a[_0x3e9638(0x12df)][_0x3e9638(0x2ed)];},_0x3922a3[_0x455728(0x96e)](_0xbc6b9b);}}),document['getElementById'](_0x5897a1(0x13a0))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x445a6d=>{const _0x5a4688=_0x5897a1,_0x49448e=_0x445a6d[_0x5a4688(0x12df)]['closest'](_0x5a4688(0x777));if(_0x49448e){const _0x24d8c0=_0x49448e[_0x5a4688(0xe87)](_0x5a4688(0xd4f));_0x24d8c0&&_0x57eb69(parseInt(_0x24d8c0[_0x5a4688(0x1f4)][_0x5a4688(0xf16)]));}}),document[_0x5897a1(0x458)](_0x5897a1(0xa95))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x10f9f8=_0x5897a1;document[_0x10f9f8(0x458)](_0x10f9f8(0x117f))['classList'][_0x10f9f8(0x1097)](_0x10f9f8(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x82d))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x36651c=_0x5897a1,_0x4f565c=Array[_0x36651c(0xca2)](document['querySelectorAll']('#gift-recipient-list\x20.contact-picker-item.selected'))['map'](_0x547296=>_0x547296[_0x36651c(0x1f4)][_0x36651c(0x1143)]);if(_0x4f565c[_0x36651c(0x131d)]===0x0){alert(_0x36651c(0x919));return;}const _0x245251=_0x6bbec1[_0x36651c(0xaf1)](_0xd84b11=>document[_0x36651c(0x586)](_0x36651c(0xb77)+_0xd84b11[_0x36651c(0x1371)]+'\x22]:checked'));await _0x20779e(_0x245251,_0x4f565c),document[_0x36651c(0x458)](_0x36651c(0x117f))['classList'][_0x36651c(0x1097)](_0x36651c(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x1225))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x270367=>{const _0x56d700=_0x5897a1,_0x26d223=_0x270367['target']['closest'](_0x56d700(0x7e0));_0x26d223&&_0x26d223[_0x56d700(0x11c2)][_0x56d700(0x1270)](_0x56d700(0x500));}),document['getElementById']('select-all-recipients')['addEventListener'](_0x5897a1(0x26a),function(_0x22b5f3){const _0x840355=_0x5897a1,_0x18891f=_0x22b5f3[_0x840355(0x12df)][_0x840355(0x8f7)];document[_0x840355(0x102a)]('#gift-recipient-list\x20.contact-picker-item')['forEach'](_0x5a6e57=>{const _0x56ae62=_0x840355;_0x5a6e57['classList'][_0x56ae62(0x1270)](_0x56ae62(0x500),_0x18891f);});}),document[_0x5897a1(0x458)](_0x5897a1(0x967))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x27f82c),document[_0x5897a1(0x458)]('regenerate-call-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x4dda16),document['getElementById'](_0x5897a1(0x943))[_0x5897a1(0xd85)]('click',_0x4aeb17),document[_0x5897a1(0x458)](_0x5897a1(0xf7d))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x228306=_0x5897a1,_0x59900c=document[_0x228306(0x458)]('notification-sound-player'),_0x20c111=document[_0x228306(0x458)](_0x228306(0xc49))[_0x228306(0x8dd)]['trim']()||_0x1bb61a;_0x59900c[_0x228306(0x577)]=_0x20c111,_0x59900c['play']()[_0x228306(0x1135)](_0x302c83=>alert(_0x228306(0xf91)));}),document[_0x5897a1(0x458)]('reset-sound-btn')['addEventListener'](_0x5897a1(0x1122),()=>{const _0x5ef96f=_0x5897a1;document[_0x5ef96f(0x458)]('notification-sound-url-input')[_0x5ef96f(0x8dd)]='',alert(_0x5ef96f(0xf5));}),document[_0x5897a1(0x458)](_0x5897a1(0x838))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x31e850=>{const _0x3da0f5=_0x5897a1,_0x22e813=_0x31e850['target'];_0x22e813[_0x3da0f5(0x11c2)][_0x3da0f5(0x526)]('editable-text')&&_0x4e676b(_0x22e813),_0x22e813['classList'][_0x3da0f5(0x526)](_0x3da0f5(0xd78))&&_0x4f58d3(_0x22e813);}),document[_0x5897a1(0x458)](_0x5897a1(0x160))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0xc54b55),document[_0x5897a1(0x458)](_0x5897a1(0x89f))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x4f6321=_0x5897a1;document[_0x4f6321(0x458)]('music-search-results-modal')[_0x4f6321(0x11c2)]['remove'](_0x4f6321(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x160))[_0x5897a1(0xd85)]('click',_0xc54b55),document[_0x5897a1(0x458)](_0x5897a1(0x89f))[_0x5897a1(0xd85)]('click',()=>{const _0x510a3a=_0x5897a1;document['getElementById'](_0x510a3a(0x1053))[_0x510a3a(0x11c2)][_0x510a3a(0x1097)](_0x510a3a(0x67d));}),document[_0x5897a1(0x458)]('select-all-music-search')['addEventListener'](_0x5897a1(0x26a),function(_0x2e6545){const _0x3fe879=_0x5897a1;document[_0x3fe879(0x102a)](_0x3fe879(0xfbc))[_0x3fe879(0x12c2)](_0x375ce2=>{const _0x5560cb=_0x3fe879;_0x375ce2['checked']=_0x2e6545[_0x5560cb(0x12df)][_0x5560cb(0x8f7)];});}),document[_0x5897a1(0x458)](_0x5897a1(0x10ef))['addEventListener'](_0x5897a1(0x1122),_0x5826fb=>{const _0x3c8fb8=_0x5897a1,_0x55edb8=_0x5826fb[_0x3c8fb8(0x12df)]['closest'](_0x3c8fb8(0xf8));if(_0x55edb8){const _0x126a8f=_0x55edb8[_0x3c8fb8(0x586)](_0x3c8fb8(0x357));_0x126a8f&&(_0x5826fb[_0x3c8fb8(0x12df)]!==_0x126a8f&&(_0x126a8f[_0x3c8fb8(0x8f7)]=!_0x126a8f[_0x3c8fb8(0x8f7)]));}}),document[_0x5897a1(0x458)](_0x5897a1(0x101a))[_0x5897a1(0xd85)]('click',async()=>{const _0x2650d5=_0x5897a1,_0xadb6f9=document[_0x2650d5(0x102a)](_0x2650d5(0x4e7));if(_0xadb6f9['length']===0x0){alert('请先选择要添加的歌曲。');return;}document[_0x2650d5(0x458)]('music-search-results-modal')[_0x2650d5(0x11c2)][_0x2650d5(0x1097)](_0x2650d5(0x67d)),await _0x34fce8(_0x2650d5(0x12b9),_0x2650d5(0x321)+_0xadb6f9[_0x2650d5(0x131d)]+_0x2650d5(0xea2));const _0x54054c=Array['from'](_0xadb6f9)[_0x2650d5(0xbf6)](_0x3e12bd=>JSON[_0x2650d5(0x44c)](_0x3e12bd['closest'](_0x2650d5(0xf8))[_0x2650d5(0x1f4)]['songJson']));let _0x1e6512=0x0,_0x424418=[];const _0x4e1275=_0x54054c[_0x2650d5(0xbf6)](_0x50832d=>_0x834247(_0x50832d)),_0x1e64b3=await Promise['all'](_0x4e1275);_0x1e64b3[_0x2650d5(0x12c2)]((_0x836e38,_0x419163)=>{const _0x976a66=_0x2650d5;_0x836e38?(_0x59377b[_0x976a66(0x1102)]['push'](_0x836e38),_0x1e6512++):_0x424418[_0x976a66(0x129e)](_0x54054c[_0x419163]['name']);});_0x1e6512>0x0&&(await _0x562193(),_0xe64ac7(),_0x59377b[_0x2650d5(0x4bd)]===-0x1&&(_0x59377b[_0x2650d5(0x4bd)]=_0x59377b[_0x2650d5(0x1102)][_0x2650d5(0x131d)]-_0x1e6512,_0x481fb2()));let _0x79aca1=_0x2650d5(0x40d)+_0x1e6512+_0x2650d5(0x103e);_0x424418[_0x2650d5(0x131d)]>0x0&&(_0x79aca1+='\x0a\x0a'+_0x424418[_0x2650d5(0x131d)]+_0x2650d5(0x1430)+_0x424418['join'](_0x2650d5(0x12a6))),await _0x34fce8(_0x2650d5(0x30e),_0x79aca1);}),document[_0x5897a1(0x458)](_0x5897a1(0x10ba))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x305923=_0x5897a1;document['getElementById']('music-visual-container')[_0x305923(0x11c2)]['toggle'](_0x305923(0xec1));}),document[_0x5897a1(0x458)](_0x5897a1(0x160))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0xc54b55),document['getElementById'](_0x5897a1(0x89f))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x30a245=_0x5897a1;document[_0x30a245(0x458)](_0x30a245(0x1053))[_0x30a245(0x11c2)][_0x30a245(0x1097)](_0x30a245(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x10ef))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x76b93c=>{const _0x31b545=_0x5897a1,_0x3e0a04=_0x76b93c[_0x31b545(0x12df)]['closest'](_0x31b545(0xf8));if(_0x3e0a04&&_0x3e0a04[_0x31b545(0x1f4)]['songJson']){const _0x5e8a6a=JSON[_0x31b545(0x44c)](_0x3e0a04[_0x31b545(0x1f4)][_0x31b545(0xb6c)]);handleSearchResultClick(_0x5e8a6a);}}),document['getElementById']('cleanup-songs-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x5eb173),document[_0x5897a1(0x458)](_0x5897a1(0xb7))['addEventListener'](_0x5897a1(0x1122),_0x5e04d2),document['getElementById'](_0x5897a1(0x26b))['addEventListener'](_0x5897a1(0x1122),_0x201074),document['getElementById'](_0x5897a1(0x35a))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x11971e),document[_0x5897a1(0x458)](_0x5897a1(0x217))[_0x5897a1(0xd85)](_0x5897a1(0x26a),()=>{const _0x29cb50=_0x5897a1;_0x42f206[_0x29cb50(0xf0)][_0x29cb50(0x733)]=document[_0x29cb50(0x458)](_0x29cb50(0x217))['checked'],_0x3ad72c();}),document[_0x5897a1(0x458)]('qzone-more-actions-btn')['addEventListener'](_0x5897a1(0x1122),_0x26079f),document[_0x5897a1(0x458)](_0x5897a1(0xcb8))['addEventListener']('click',()=>{const _0x50c3bf=_0x5897a1;document[_0x50c3bf(0x458)](_0x50c3bf(0xdc4))[_0x50c3bf(0x11c2)][_0x50c3bf(0x1097)](_0x50c3bf(0x67d));}),document['getElementById']('confirm-clear-posts-btn')[_0x5897a1(0xd85)]('click',_0x303e8b),document[_0x5897a1(0x458)](_0x5897a1(0x235))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x4e7d07=>{const _0x36a82a=_0x5897a1,_0x131af3=_0x4e7d07[_0x36a82a(0x12df)][_0x36a82a(0xe87)]('.clear-posts-item');_0x131af3&&_0x131af3[_0x36a82a(0x11c2)][_0x36a82a(0x1270)]('selected');}),document[_0x5897a1(0x458)](_0x5897a1(0x13ee))['addEventListener']('change',async _0x9318b8=>{const _0x42a07d=_0x5897a1,_0x13145d=_0x9318b8[_0x42a07d(0x12df)][_0x42a07d(0x1a9)][0x0];if(_0x13145d){const _0x84f651=await new Promise(_0x3e00ec=>{const _0x3e86db=_0x42a07d,_0x202214=new FileReader();_0x202214[_0x3e86db(0x11fa)]=()=>_0x3e00ec(_0x202214['result']),_0x202214['readAsDataURL'](_0x13145d);});_0x42f206[_0x42a07d(0xf0)][_0x42a07d(0x203)]=_0x84f651,_0x3b3899();}_0x9318b8[_0x42a07d(0x12df)]['value']=null;}),document[_0x5897a1(0x458)]('remove-global-bg-btn')[_0x5897a1(0xd85)]('click',()=>{const _0x50c8b1=_0x5897a1;_0x42f206[_0x50c8b1(0xf0)][_0x50c8b1(0x203)]='',_0x3b3899();}),document['getElementById']('save-wallpaper-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x57b72c=_0x5897a1;_0x251566&&(_0x42f206[_0x57b72c(0xf0)][_0x57b72c(0xef2)]=_0x251566),_0x42f206[_0x57b72c(0xf0)][_0x57b72c(0x2d5)]=document[_0x57b72c(0x458)](_0x57b72c(0xb1d))[_0x57b72c(0x8dd)][_0x57b72c(0x2aa)](),_0x42f206[_0x57b72c(0xf0)][_0x57b72c(0xee7)]=document[_0x57b72c(0x458)](_0x57b72c(0xc49))[_0x57b72c(0x8dd)][_0x57b72c(0x2aa)](),_0x42f206[_0x57b72c(0xf0)]['showStatusBar']=document[_0x57b72c(0x458)](_0x57b72c(0x217))[_0x57b72c(0x8f7)],await _0x17d534[_0x57b72c(0xf0)][_0x57b72c(0xf3f)](_0x42f206[_0x57b72c(0xf0)]),_0x3f8328(),_0x251566=null,_0x427694(),_0x410076(_0x42f206[_0x57b72c(0xf0)][_0x57b72c(0x2d5)]),_0x3ad72c(),alert(_0x57b72c(0x2a4)),_0x589d88(_0x57b72c(0x838));}),document['getElementById'](_0x5897a1(0x771))['addEventListener'](_0x5897a1(0x1122),async()=>{const _0x1d0401=_0x5897a1,_0x2a6a9f=await _0x335e57('网络图片',_0x1d0401(0xe22),'',_0x1d0401(0x1377));if(_0x2a6a9f&&_0x2a6a9f[_0x1d0401(0x2aa)]())_0x42f206[_0x1d0401(0xf0)][_0x1d0401(0x203)]=_0x2a6a9f[_0x1d0401(0x2aa)](),_0x3b3899();else _0x2a6a9f!==null&&alert('请输入有效的URL。');}),document[_0x5897a1(0x458)]('upload-ephone-bg-url-btn')[_0x5897a1(0xd85)]('click',async()=>{const _0x306ea5=_0x5897a1,_0x58d6dc=await _0x335e57(_0x306ea5(0x455),'请输入EPhone主屏幕的背景图片URL','','url');if(_0x58d6dc&&_0x58d6dc['trim']())_0x251566=_0x58d6dc[_0x306ea5(0x2aa)](),_0x3b3899();else _0x58d6dc!==null&&alert(_0x306ea5(0x985));}),document[_0x5897a1(0x458)](_0x5897a1(0x9e2))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x46f7a0=_0x5897a1,_0x2dec80=await _0x335e57(_0x46f7a0(0x264),_0x46f7a0(0x10d),'',_0x46f7a0(0x1377));if(_0x2dec80&&_0x2dec80[_0x46f7a0(0x2aa)]())_0x42f206['globalSettings'][_0x46f7a0(0x3bc)]=_0x2dec80[_0x46f7a0(0x2aa)](),_0x3b3899();else _0x2dec80!==null&&alert(_0x46f7a0(0x985));}),document[_0x5897a1(0x458)](_0x5897a1(0xea4))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x6472ce=_0x5897a1;_0x251566=null,_0x42f206[_0x6472ce(0xf0)][_0x6472ce(0xef2)]='',_0x3b3899();}),document[_0x5897a1(0x458)](_0x5897a1(0xa54))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0xc78a26=_0x5897a1;_0x42f206[_0xc78a26(0xf0)][_0xc78a26(0x3bc)]='',_0x3b3899();}),document[_0x5897a1(0x458)]('css-preset-select')[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x398c36),document[_0x5897a1(0x458)]('save-css-preset-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x10b0de),document[_0x5897a1(0x458)](_0x5897a1(0x2ac))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x239890),document[_0x5897a1(0x458)](_0x5897a1(0xbd8))[_0x5897a1(0xd85)]('change',_0x2aa9b6),document[_0x5897a1(0x458)]('save-font-preset-btn')['addEventListener'](_0x5897a1(0x1122),_0x22a641),document[_0x5897a1(0x458)](_0x5897a1(0xd0d))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x5c866c),document['getElementById']('theme-preset-select')[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x3dc0ec),document[_0x5897a1(0x458)](_0x5897a1(0xaaf))[_0x5897a1(0xd85)]('click',_0x413995),document[_0x5897a1(0x458)]('delete-theme-preset-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x23dd92),document[_0x5897a1(0x458)]('manage-sticker-categories-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x5152a6),document[_0x5897a1(0x458)](_0x5897a1(0xe34))[_0x5897a1(0xd85)]('click',()=>{const _0x44354b=_0x5897a1;document[_0x44354b(0x458)](_0x44354b(0x751))[_0x44354b(0x11c2)][_0x44354b(0x1097)](_0x44354b(0x67d)),_0x410b06();}),document[_0x5897a1(0x458)](_0x5897a1(0x102c))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0xa46a9),document[_0x5897a1(0x458)](_0x5897a1(0x1b9))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x3c3c4a=>{const _0x2b5f56=_0x5897a1;if(_0x3c3c4a[_0x2b5f56(0x12df)][_0x2b5f56(0x11c2)][_0x2b5f56(0x526)]('delete-group-btn')){const _0x1d8bd2=parseInt(_0x3c3c4a[_0x2b5f56(0x12df)][_0x2b5f56(0x1f4)]['id']);_0x54555d(_0x1d8bd2);}}),document[_0x5897a1(0x458)](_0x5897a1(0xf64))['addEventListener'](_0x5897a1(0x1122),_0x463220=>{const _0x593bf7=_0x5897a1;if(_0x463220['target']['classList']['contains']('sticker-category-tab')){const _0x435b10=_0x463220[_0x593bf7(0x12df)][_0x593bf7(0x1f4)][_0x593bf7(0x5f7)],_0x2d29a3=_0x435b10!==_0x593bf7(0xfe2)&&_0x435b10!==_0x593bf7(0xbff)?parseInt(_0x435b10):_0x435b10;_0x2b787b(_0x2d29a3);}}),document[_0x5897a1(0x458)](_0x5897a1(0x826))[_0x5897a1(0xd85)]('change',_0x1724c0),document[_0x5897a1(0x458)](_0x5897a1(0xb11))['addEventListener'](_0x5897a1(0x1122),_0x50ba68),document[_0x5897a1(0x458)](_0x5897a1(0x1103))['addEventListener']('click',()=>{const _0x2cbe8b=_0x5897a1;document['getElementById'](_0x2cbe8b(0x745))['click']();}),document[_0x5897a1(0x458)](_0x5897a1(0x745))[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x20d16e=>{const _0x4ef2ae=_0x5897a1,_0x6c23cc=_0x20d16e[_0x4ef2ae(0x12df)][_0x4ef2ae(0x1a9)][0x0];_0x6c23cc&&_0x4ccde3(_0x6c23cc),_0x20d16e[_0x4ef2ae(0x12df)][_0x4ef2ae(0x8dd)]=null;}),document[_0x5897a1(0x458)](_0x5897a1(0x13cd))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>_0x1cf6d2()),document['getElementById']('add-char-diary-btn')[_0x5897a1(0xd85)]('click',()=>openDiaryEditor()),document[_0x5897a1(0x458)](_0x5897a1(0xcb9))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x17767e),document[_0x5897a1(0x458)](_0x5897a1(0x137e))[_0x5897a1(0xd85)]('click',_0x476463),document[_0x5897a1(0x458)](_0x5897a1(0xfcb))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x392bc1),document['getElementById']('regenerate-char-qq-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x19a0a7=_0x5897a1;_0x34fce8(_0x19a0a7(0x397),_0x19a0a7(0x254));try{await Promise[_0x19a0a7(0xfe2)]([_0x56b5c0(),_0x3e323a()]),console[_0x19a0a7(0x7d1)](_0x19a0a7(0x12ee));}catch(_0x551009){console[_0x19a0a7(0xb61)](_0x19a0a7(0x13a6),_0x551009),await _0x34fce8(_0x19a0a7(0x96d),_0x19a0a7(0x373)+_0x551009['message']);}}),document['getElementById'](_0x5897a1(0x12e5))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x10ce58=>{const _0x259f0b=_0x5897a1,_0x41a718=_0x10ce58[_0x259f0b(0x12df)][_0x259f0b(0xe87)](_0x259f0b(0x728));if(_0x41a718&&_0x41a718[_0x259f0b(0x1f4)][_0x259f0b(0x10a9)]){const _0x1c3845=parseInt(_0x41a718[_0x259f0b(0x1f4)][_0x259f0b(0x10a9)]);!isNaN(_0x1c3845)&&_0x5e2eeb(_0x1c3845);}}),document[_0x5897a1(0x458)]('back-to-char-qq-list-btn')['addEventListener']('click',()=>{const _0x7ad158=_0x5897a1;_0x3d0170(_0x7ad158(0x5cc));});const _0x360c6b=document[_0x5897a1(0x458)](_0x5897a1(0x8ea)),_0x1ac8b6=()=>{const _0x2bb64c=_0x5897a1;if(_0x3280ac!==_0x2bb64c(0x3d3))return;if(_0x360c6b['scrollTop']<0x1&&!_0x239724){const _0x2d5494=_0x42f206[_0x2bb64c(0x954)][_0xa42f18]?.['history'][_0x2bb64c(0x131d)]||0x0;_0x2d5494>_0x5b5e0c&&_0x56e853();}};_0x360c6b[_0x5897a1(0xd85)](_0x5897a1(0xf6a),_0x1ac8b6),document['getElementById'](_0x5897a1(0x738))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{alert('这是模拟对话，无法发送消息哦~');}),document[_0x5897a1(0x458)](_0x5897a1(0xc39))['addEventListener'](_0x5897a1(0x1122),_0x104a23),document[_0x5897a1(0x458)](_0x5897a1(0x848))['addEventListener']('click',_0x5c3cd9=>{const _0x3d847d=_0x5897a1,_0x102809=_0x5c3cd9[_0x3d847d(0x12df)][_0x3d847d(0xe87)](_0x3d847d(0x185));if(_0x102809&&_0x102809[_0x3d847d(0x1f4)][_0x3d847d(0x4e9)]){const _0x27d055=_0x102809[_0x3d847d(0x1f4)][_0x3d847d(0x4e9)];_0x34fce8('照片详情',_0x27d055[_0x3d847d(0x33b)](/\n/g,_0x3d847d(0x1208)));}}),document[_0x5897a1(0x458)](_0x5897a1(0x10d8))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x5258ce),document[_0x5897a1(0x458)]('regenerate-char-taobao-btn')[_0x5897a1(0xd85)]('click',_0x41d1e7),document['getElementById'](_0x5897a1(0x1095))['addEventListener'](_0x5897a1(0x1122),_0x748504=>{const _0x47c3ca=_0x5897a1,_0x380aa7=_0x748504[_0x47c3ca(0x12df)][_0x47c3ca(0xe87)](_0x47c3ca(0x8d));if(_0x380aa7&&_0x380aa7[_0x47c3ca(0x1f4)][_0x47c3ca(0x14e)]){const _0x4afc39=_0x380aa7[_0x47c3ca(0x1f4)][_0x47c3ca(0x14e)];_0x34fce8('TA的想法...',_0x4afc39[_0x47c3ca(0x33b)](/\n/g,_0x47c3ca(0x1208)));}}),window[_0x5897a1(0x3cd)]=_0x41d734,document[_0x5897a1(0x458)](_0x5897a1(0x7ad))[_0x5897a1(0xd85)]('click',_0x13dd87),document['getElementById']('char-memo-detail-back-btn')['addEventListener'](_0x5897a1(0x1122),()=>_0x3d0170('char-memo-screen')),document[_0x5897a1(0x458)](_0x5897a1(0x51c))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x1c6cd7),document['getElementById']('add-char-diary-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x1114c5),document[_0x5897a1(0x458)](_0x5897a1(0xce7))[_0x5897a1(0xd85)]('click',()=>_0x3d0170(_0x5897a1(0xbc))),document[_0x5897a1(0x458)]('regenerate-char-amap-btn')['addEventListener'](_0x5897a1(0x1122),_0x5191d9),document[_0x5897a1(0x458)]('regenerate-char-usage-btn')[_0x5897a1(0xd85)]('click',_0x3b3f30),document[_0x5897a1(0x458)]('regenerate-char-music-btn')[_0x5897a1(0xd85)]('click',_0x1df9d1),document[_0x5897a1(0x458)](_0x5897a1(0x1138))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x2f4392),document['getElementById'](_0x5897a1(0x206))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x2f5be7),document[_0x5897a1(0x458)](_0x5897a1(0x206))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x2f5be7),document[_0x5897a1(0x458)](_0x5897a1(0x96b))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>_0x589d88(_0x5897a1(0xca1))),document[_0x5897a1(0x458)]('douban-send-comment-btn')['addEventListener'](_0x5897a1(0x1122),_0x3f7dee),document[_0x5897a1(0x458)](_0x5897a1(0xd23))['addEventListener'](_0x5897a1(0x1122),_0x1c09ad),document[_0x5897a1(0x458)](_0x5897a1(0x2b1))[_0x5897a1(0xd85)]('change',async _0x91263=>{const _0x139e42=_0x5897a1,_0x26f18d=_0x91263[_0x139e42(0x12df)][_0x139e42(0x1a9)][0x0];if(_0x26f18d){const _0x5d7739=await new Promise(_0x5f0964=>{const _0x4ccca3=_0x139e42,_0x2135d3=new FileReader();_0x2135d3[_0x4ccca3(0x11fa)]=()=>_0x5f0964(_0x2135d3[_0x4ccca3(0x2ed)]),_0x2135d3[_0x4ccca3(0x96e)](_0x26f18d);});_0x42f206['globalSettings'][_0x139e42(0x3bc)]=_0x5d7739,_0x3b3899();}}),document['getElementById'](_0x5897a1(0xea6))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x56ee0e=>{const _0x3e7397=_0x5897a1;if(_0x56ee0e[_0x3e7397(0x12df)][_0x3e7397(0x11c2)]['contains'](_0x3e7397(0x234))){const _0x3533d1=_0x56ee0e[_0x3e7397(0x12df)][_0x3e7397(0xe87)](_0x3e7397(0xed3)),_0x507e02=_0x3533d1[_0x3e7397(0x1f4)][_0x3e7397(0x6bd)];_0x507e02&&_0x4c0d82(_0x507e02,'cphone',_0x3533d1);}}),document['getElementById'](_0x5897a1(0xcfd))['addEventListener'](_0x5897a1(0x1122),()=>{const _0xf5eb51=_0x5897a1;document[_0xf5eb51(0x458)](_0xf5eb51(0x162))[_0xf5eb51(0x1122)]();}),document[_0x5897a1(0x458)](_0x5897a1(0x162))[_0x5897a1(0xd85)]('change',_0x57f393=>{const _0x534ec4=_0x5897a1,_0x3d7fa6=_0x57f393[_0x534ec4(0x12df)]['files'][0x0];_0x3d7fa6&&_0x398e06(_0x3d7fa6),_0x57f393[_0x534ec4(0x12df)][_0x534ec4(0x8dd)]=null;}),document[_0x5897a1(0xd85)]('visibilitychange',()=>{const _0x464ae0=_0x5897a1;document[_0x464ae0(0x1461)]===_0x464ae0(0x535)&&(localStorage['setItem'](_0x464ae0(0xc0f),Date[_0x464ae0(0x606)]()),console[_0x464ae0(0x7d1)](_0x464ae0(0x1279)));}),document['getElementById'](_0x5897a1(0xab9))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x339859),document[_0x5897a1(0x458)]('import-world-book-btn')['addEventListener'](_0x5897a1(0x1122),()=>{document['getElementById']('import-world-book-input')['click']();}),document[_0x5897a1(0x458)](_0x5897a1(0x2f8))[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x432173=>{const _0x47189e=_0x5897a1,_0x3b4462=_0x432173[_0x47189e(0x12df)][_0x47189e(0x1a9)][0x0];_0x3b4462&&_0x13994d(_0x3b4462),_0x432173[_0x47189e(0x12df)]['value']=null;}),document[_0x5897a1(0x458)](_0x5897a1(0x9a4))['addEventListener']('change',async _0x40a539=>{const _0x594b56=_0x5897a1,_0x433b87=_0x40a539['target']['checked'];_0x42f206[_0x594b56(0xf0)][_0x594b56(0xf0e)]=_0x433b87,await _0x17d534[_0x594b56(0xf0)]['put'](_0x42f206[_0x594b56(0xf0)]);const _0x5dda3c=document['querySelector'](_0x594b56(0x10c3));if(_0x5dda3c)switch(_0x5dda3c['id']){case'chat-interface-screen':_0x359c96(_0x42f206[_0x594b56(0x81d)]);break;case _0x594b56(0x1302):if(document[_0x594b56(0x458)](_0x594b56(0x1116))[_0x594b56(0x11c2)][_0x594b56(0x526)](_0x594b56(0xfe1)))_0x316550();if(document['getElementById'](_0x594b56(0x13a9))[_0x594b56(0x11c2)][_0x594b56(0x526)]('active'))_0x25490b();break;case _0x594b56(0xca1):_0x10bf4a();break;case _0x594b56(0x633):_0x48cc0c(_0x2c2275);break;case _0x594b56(0x9a1):const _0x1f454c=document['querySelector']('.char-screen.active');if(_0x1f454c)switch(_0x1f454c['id']){case _0x594b56(0x1362):_0x216409();break;case _0x594b56(0x640):_0xae0e8();break;case _0x594b56(0x12fd):const _0x471aaa=_0x42f206[_0x594b56(0x954)][_0xa42f18],_0x1c2be8=_0x471aaa[_0x594b56(0x83e)]||[],_0x34593d=_0x1c2be8[_0x594b56(0x131d)]>0x0?_0x1c2be8[_0x594b56(0x131d)]-0x1:0x0;_0x4d775d(_0x1c2be8[_0x34593d]);break;case _0x594b56(0xffe):_0x4a498a();break;case _0x594b56(0x5cc):_0x57fcb3();break;case _0x594b56(0x540):const _0x45169b=document['querySelector'](_0x594b56(0x12b8))?.[_0x594b56(0x1f4)][_0x594b56(0x10a9)]||0x0;_0x5e2eeb(parseInt(_0x45169b));break;}break;}_0x34fce8(_0x594b56(0xcec),_0x594b56(0xe62)+(_0x433b87?'开启':'关闭')+'。');}),document[_0x5897a1(0x458)](_0x5897a1(0xed4))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x58db26),document[_0x5897a1(0x458)](_0x5897a1(0x882))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{_0x589d88('chat-settings-screen');}),document[_0x5897a1(0x458)]('execute-search-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x3c8479),document[_0x5897a1(0x458)](_0x5897a1(0xe81))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x45119a),document['getElementById'](_0x5897a1(0x9e9))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x4663c7),document[_0x5897a1(0x458)]('batch-import-frames-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x19084a),document[_0x5897a1(0x586)](_0x5897a1(0x1d1))['addEventListener'](_0x5897a1(0x1122),_0x3b5985=>{const _0x3cc43f=_0x5897a1;if(_0x3b5985[_0x3cc43f(0x12df)][_0x3cc43f(0x11c2)][_0x3cc43f(0x526)]('delete-btn')){const _0x354d74=parseInt(_0x3b5985[_0x3cc43f(0x12df)]['dataset']['id']);!isNaN(_0x354d74)&&_0x432a58(_0x354d74);}}),_0x56b1e0(),window[_0x5897a1(0x6bf)]=_0x48a85a,document['getElementById'](_0x5897a1(0x69a))[_0x5897a1(0xd85)]('click',async()=>{const _0x32a455=_0x5897a1,_0x2b90ca=await _0x335e57('创建新预设','请输入预设名称');if(_0x2b90ca&&_0x2b90ca['trim']()){const _0x5733f9={'id':_0x32a455(0x13b3)+Date[_0x32a455(0x606)](),'name':_0x2b90ca[_0x32a455(0x2aa)](),'content':[]};await _0x17d534[_0x32a455(0x843)][_0x32a455(0xa58)](_0x5733f9),await _0xb81626(),_0x13d6b6(_0x5733f9['id']);}}),document[_0x5897a1(0x458)](_0x5897a1(0x142))['addEventListener'](_0x5897a1(0x1122),_0x1fc0a9),document['getElementById']('add-preset-entry-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x370fa5=_0x5897a1,_0x2b2b3c=document[_0x370fa5(0x458)]('preset-entries-container');_0x2b2b3c[_0x370fa5(0x586)]('p')&&(_0x2b2b3c[_0x370fa5(0x110d)]='');const _0x458efa=_0x5a7b43();_0x2b2b3c[_0x370fa5(0x1079)](_0x458efa),_0x458efa[_0x370fa5(0x586)]('.entry-content-textarea')[_0x370fa5(0x1248)]();}),document['getElementById'](_0x5897a1(0x6d1))['addEventListener'](_0x5897a1(0x1122),async()=>{const _0x12d89d=_0x5897a1;if(!_0x59a56d)return;const _0xff3e0a=await _0x17d534[_0x12d89d(0x843)][_0x12d89d(0x36d)](_0x59a56d);if(!_0xff3e0a)return;const _0x59098f=document[_0x12d89d(0x458)](_0x12d89d(0x1f2))['value'][_0x12d89d(0x2aa)]();if(!_0x59098f){alert(_0x12d89d(0x953));return;}_0xff3e0a[_0x12d89d(0x132a)]=_0x59098f,_0xff3e0a[_0x12d89d(0x5f7)]=parseInt(document[_0x12d89d(0x458)]('preset-category-select')[_0x12d89d(0x8dd)])||null;const _0x5cbfdd=document[_0x12d89d(0x458)](_0x12d89d(0xbd7)),_0x439035=_0x5cbfdd['querySelectorAll'](_0x12d89d(0x1425)),_0x36a552=[];_0x439035[_0x12d89d(0x12c2)](_0x3e32fb=>{const _0x34c451=_0x12d89d,_0x401aa9=_0x3e32fb['querySelector'](_0x34c451(0xdd8))[_0x34c451(0x8dd)][_0x34c451(0x2aa)]();_0x401aa9&&_0x36a552[_0x34c451(0x129e)]({'comment':_0x3e32fb[_0x34c451(0x586)](_0x34c451(0x744))[_0x34c451(0x8dd)][_0x34c451(0x2aa)](),'keys':(_0x3e32fb['querySelector'](_0x34c451(0x34a))[_0x34c451(0x8dd)]['trim']()||'')[_0x34c451(0x90b)](',')['map'](_0x1e80e8=>_0x1e80e8[_0x34c451(0x2aa)]())[_0x34c451(0xaf1)](Boolean),'content':_0x401aa9,'enabled':_0x3e32fb[_0x34c451(0x586)](_0x34c451(0x1142))[_0x34c451(0x8f7)]});}),_0xff3e0a[_0x12d89d(0x1316)]=_0x36a552,await _0x17d534['presets'][_0x12d89d(0xf3f)](_0xff3e0a),_0x59a56d=null,_0x589d88('preset-screen'),await _0xb81626();}),document[_0x5897a1(0x458)]('import-preset-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x34ea97=_0x5897a1;document[_0x34ea97(0x458)]('import-preset-input')[_0x34ea97(0x1122)]();}),document['getElementById'](_0x5897a1(0xc16))[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x13cd8a),document[_0x5897a1(0x458)](_0x5897a1(0xd0c))[_0x5897a1(0xd85)]('click',_0x309170),document['getElementById']('clear-specific-data-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x1fecd0),document[_0x5897a1(0x458)]('cancel-clear-wizard-btn-step1')[_0x5897a1(0xd85)]('click',()=>{const _0x57195b=_0x5897a1;document['getElementById'](_0x57195b(0x7ce))[_0x57195b(0x11c2)][_0x57195b(0x1097)](_0x57195b(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0xa7f))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x7a9ec2),document['getElementById'](_0x5897a1(0x9fb))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x1b643d),document[_0x5897a1(0x458)]('cancel-clear-wizard-btn-step2')['addEventListener'](_0x5897a1(0x1122),()=>{const _0x37a95e=_0x5897a1;document[_0x37a95e(0x458)](_0x37a95e(0x7ce))[_0x37a95e(0x11c2)][_0x37a95e(0x1097)](_0x37a95e(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0xe99))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x41aa26),document[_0x5897a1(0x458)](_0x5897a1(0x7ce))['addEventListener'](_0x5897a1(0x1122),_0x37b0ad=>{const _0x3887a0=_0x5897a1,_0x2f8737=_0x37b0ad[_0x3887a0(0x12df)]['closest'](_0x3887a0(0xcd1));_0x2f8737&&(_0x37b0ad[_0x3887a0(0x58e)](),_0x2f8737[_0x3887a0(0x11c2)]['toggle'](_0x3887a0(0x500)));}),document[_0x5897a1(0x458)]('data-clear-wizard-modal')[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x5ca4c2=>{const _0x39183d=_0x5897a1;if(_0x5ca4c2[_0x39183d(0x12df)]['id']===_0x39183d(0x565)){const _0x153ea7=_0x5ca4c2[_0x39183d(0x12df)][_0x39183d(0x8f7)];document['querySelectorAll'](_0x39183d(0x10e5))[_0x39183d(0x12c2)](_0x18b0b4=>{const _0x60617=_0x39183d;_0x18b0b4[_0x60617(0x11c2)][_0x60617(0x1270)](_0x60617(0x500),_0x153ea7);});}else{if(_0x5ca4c2[_0x39183d(0x12df)]['id']===_0x39183d(0x10fb)){const _0x54bc12=_0x5ca4c2[_0x39183d(0x12df)]['checked'];document[_0x39183d(0x102a)](_0x39183d(0x68f))[_0x39183d(0x12c2)](_0x2f06e2=>{const _0x559a8b=_0x39183d;_0x2f06e2[_0x559a8b(0x11c2)][_0x559a8b(0x1270)](_0x559a8b(0x500),_0x54bc12);});}}}),document['getElementById'](_0x5897a1(0x9d2))['addEventListener'](_0x5897a1(0x1122),_0xb8f58c),document[_0x5897a1(0x458)]('copy-message-btn')['addEventListener'](_0x5897a1(0x1122),_0x514169),document[_0x5897a1(0x458)]('copy-timestamp-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x2192f7),document[_0x5897a1(0x458)]('npc-list-back-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x5e8a34=_0x5897a1;_0x2ecab9(_0x5e8a34(0x785));}),document['getElementById'](_0x5897a1(0x125a))['addEventListener']('click',()=>_0x169028(null)),document['getElementById'](_0x5897a1(0x7c1))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x310485),document[_0x5897a1(0x458)](_0x5897a1(0x2f2))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x385c60=>{const _0x29bef5=_0x5897a1;_0x385c60['target']['id']===_0x29bef5(0x789)&&_0x354dc4();}),document[_0x5897a1(0x458)](_0x5897a1(0xef3))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x2c5b3b=_0x5897a1;document[_0x2c5b3b(0x458)](_0x2c5b3b(0x1031))[_0x2c5b3b(0x11c2)][_0x2c5b3b(0x1097)](_0x2c5b3b(0x67d)),document['getElementById'](_0x2c5b3b(0x2f2))['classList'][_0x2c5b3b(0x526)](_0x2c5b3b(0x67d))&&_0x169028(editingNpcId);}),document[_0x5897a1(0x458)](_0x5897a1(0xa65))['addEventListener'](_0x5897a1(0x1122),_0x39486c),document[_0x5897a1(0x458)](_0x5897a1(0x9ef))['addEventListener'](_0x5897a1(0x1122),_0x690c6=>{const _0x5ecd52=_0x5897a1;_0x690c6[_0x5ecd52(0x12df)][_0x5ecd52(0x11c2)][_0x5ecd52(0x526)](_0x5ecd52(0xb6e))&&_0x4028ec(parseInt(_0x690c6['target'][_0x5ecd52(0x1f4)]['id']));}),document[_0x5897a1(0x458)]('cancel-npc-editor-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x333d9d=_0x5897a1;document[_0x333d9d(0x458)](_0x333d9d(0x2f2))[_0x333d9d(0x11c2)]['remove'](_0x333d9d(0x67d));}),document[_0x5897a1(0x458)]('npc-avatar-input')[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x142f2b=>{const _0x3533a2=_0x5897a1,_0x3285b9=_0x142f2b[_0x3533a2(0x12df)][_0x3533a2(0x1a9)][0x0];if(_0x3285b9){const _0x13bc2c=new FileReader();_0x13bc2c[_0x3533a2(0x11fa)]=_0x4df9fb=>{const _0x2fd6a7=_0x3533a2;document[_0x2fd6a7(0x458)](_0x2fd6a7(0x144f))['src']=_0x4df9fb[_0x2fd6a7(0x12df)]['result'];},_0x13bc2c[_0x3533a2(0x96e)](_0x3285b9);}}),document[_0x5897a1(0x458)](_0x5897a1(0x27c))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x534612=>{const _0x30c2f4=_0x5897a1;if(_0x534612[_0x30c2f4(0x12df)]['id']===_0x30c2f4(0x918))_0x185b1e();else _0x534612['target']['id']===_0x30c2f4(0x5dc)&&_0x575ece();}),_0x4376d8(document['getElementById'](_0x5897a1(0x10ba)),()=>{const _0x5c4b26=_0x5897a1;_0x59377b[_0x5c4b26(0x4bd)]>-0x1&&_0x1ab71a(_0x59377b[_0x5c4b26(0x4bd)]);}),document[_0x5897a1(0x458)]('douban-settings-btn')['addEventListener'](_0x5897a1(0x1122),_0x101770),document[_0x5897a1(0x458)](_0x5897a1(0x112e))['addEventListener'](_0x5897a1(0x1122),_0x25e967),document[_0x5897a1(0x458)](_0x5897a1(0x1393))[_0x5897a1(0xd85)]('click',()=>{const _0x1ef0ec=_0x5897a1;document[_0x1ef0ec(0x458)](_0x1ef0ec(0x108a))[_0x1ef0ec(0x11c2)][_0x1ef0ec(0x1097)](_0x1ef0ec(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x13df))['addEventListener'](_0x5897a1(0x754),_0x237788=>{const _0x21e82e=_0x5897a1,_0xccfa25=_0x237788[_0x21e82e(0x12df)]['value'][_0x21e82e(0xb15)](),_0xdf49ee=document['getElementById'](_0x21e82e(0xd55));for(const _0x1e2abf of _0xdf49ee[_0x21e82e(0x8e9)]){const _0x638ba8=_0x1e2abf[_0x21e82e(0x1a2)][_0x21e82e(0xb15)]();_0x638ba8[_0x21e82e(0xd8d)](_0xccfa25)?_0x1e2abf['style']['display']='':_0x1e2abf['style']['display']='none';}}),window[_0x5897a1(0x1e4)]=_0x2d697f,document[_0x5897a1(0x458)](_0x5897a1(0x498))['addEventListener'](_0x5897a1(0x1122),()=>_0x2d697f(_0x5897a1(0x1192))),document['getElementById']('cancel-werewolf-lobby-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x1a99d7=_0x5897a1;document[_0x1a99d7(0x458)](_0x1a99d7(0x13d8))[_0x1a99d7(0x11c2)]['remove']('visible');}),document['getElementById'](_0x5897a1(0x1261))['addEventListener'](_0x5897a1(0x1122),_0x4b2b5a),document[_0x5897a1(0x458)](_0x5897a1(0xc89))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x4f5e7c=_0x5897a1;document['getElementById'](_0x4f5e7c(0x12ce))[_0x4f5e7c(0x11c2)]['remove'](_0x4f5e7c(0x67d)),_0x504297();}),document[_0x5897a1(0x458)](_0x5897a1(0xb4))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x30ae10=_0x5897a1,_0x5ac5f0=await _0x2532b9('退出游戏',_0x30ae10(0xf0a),{'confirmButtonClass':'btn-danger'});_0x5ac5f0&&(_0xd93c0f['isActive']=![],_0x589d88(_0xd93c0f[_0x30ae10(0xfca)]?_0x30ae10(0xd99):'home-screen'));}),document[_0x5897a1(0x458)](_0x5897a1(0x7cd))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x31f2b6=_0x5897a1;document[_0x31f2b6(0x458)](_0x31f2b6(0x9d0))['classList']['remove'](_0x31f2b6(0x67d)),_0x589d88(_0xd93c0f[_0x31f2b6(0xfca)]?'chat-list-screen':_0x31f2b6(0x838));}),document['getElementById'](_0x5897a1(0x317))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x3f4ff8=_0x5897a1;document[_0x3f4ff8(0x458)](_0x3f4ff8(0x9ae))['classList'][_0x3f4ff8(0x1097)]('visible');}),document[_0x5897a1(0x458)](_0x5897a1(0x1107))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x1eb977=_0x5897a1;document['getElementById'](_0x1eb977(0x13d8))['classList'][_0x1eb977(0x1097)](_0x1eb977(0x67d));}),document[_0x5897a1(0x458)](_0x5897a1(0x6f0))[_0x5897a1(0xd85)]('click',_0x1e7cbe),document['getElementById']('manual-werewolf-summary-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x57b416),document[_0x5897a1(0x458)](_0x5897a1(0xf4d))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x155b14),document['getElementById'](_0x5897a1(0x6e))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x87b746),document[_0x5897a1(0x458)](_0x5897a1(0xfdb))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x17ef9c=_0x5897a1;document[_0x17ef9c(0x458)]('delete-world-books-modal')['classList']['remove']('visible');}),document[_0x5897a1(0x458)](_0x5897a1(0x695))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x110b96),document['getElementById'](_0x5897a1(0xd38))['addEventListener'](_0x5897a1(0x1122),_0x4bb26c=>{const _0x3384c9=_0x5897a1,_0x2e0217=_0x4bb26c[_0x3384c9(0x12df)][_0x3384c9(0xe87)]('.clear-posts-item');_0x2e0217&&_0x2e0217[_0x3384c9(0x11c2)][_0x3384c9(0x1270)]('selected');if(_0x4bb26c[_0x3384c9(0x12df)]['id']==='select-all-world-books-for-clear'){const _0x5e6f10=_0x4bb26c[_0x3384c9(0x12df)]['checked'];document[_0x3384c9(0x102a)]('#delete-world-books-list\x20.clear-posts-item')[_0x3384c9(0x12c2)](_0x379430=>{const _0x4f94c9=_0x3384c9;_0x379430[_0x4f94c9(0x11c2)]['toggle'](_0x4f94c9(0x500),_0x5e6f10);});}}),document[_0x5897a1(0x458)](_0x5897a1(0xc1b))[_0x5897a1(0xd85)](_0x5897a1(0x754),()=>{_0x410b06(![]);}),document[_0x5897a1(0x458)]('sticker-category-tabs')[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x2b525d=>{const _0x4428bb=_0x5897a1;if(_0x2b525d[_0x4428bb(0x12df)]['classList'][_0x4428bb(0x526)](_0x4428bb(0x1226))){const _0x5130dd=_0x2b525d['target']['dataset'][_0x4428bb(0x5f7)],_0x33a982=_0x5130dd!==_0x4428bb(0xfe2)&&_0x5130dd!=='uncategorized'?parseInt(_0x5130dd):_0x5130dd;document[_0x4428bb(0x458)](_0x4428bb(0xc1b))[_0x4428bb(0x8dd)]='',_0x2b787b(_0x33a982);}});const _0x3e8719=document['getElementById'](_0x5897a1(0x13a0));_0x3e8719[_0x5897a1(0xd85)](_0x5897a1(0xf6a),()=>{const _0x383b7f=_0x5897a1;if(_0x3e8719['scrollTop']<0x1&&!_0x27b4ae){const _0x560c2a=_0x42f206[_0x383b7f(0x954)][_0x42f206['activeChatId']]?.[_0x383b7f(0x1d5)][_0x383b7f(0x131d)]||0x0;_0x560c2a>_0x36c81d&&_0x2a9557();}});const _0x266da6=document[_0x5897a1(0x458)](_0x5897a1(0xeb));_0x266da6[_0x5897a1(0xd85)](_0x5897a1(0xf6a),()=>{const _0xb1fa3a=_0x5897a1,{scrollTop:_0x2a0b2,scrollHeight:_0x37d74e,clientHeight:_0x422e43}=_0x266da6;if(_0x37d74e-_0x2a0b2<=_0x422e43+0x32&&!_0x92221f){const _0x2a0da7=_0x42f206[_0xb1fa3a(0x954)][_0x42f206['activeChatId']]?.['thoughtsHistory']['length']||0x0;_0x2a0da7>_0x23e903&&_0x180228();}});const _0x21d742=document[_0x5897a1(0x586)]('#qzone-screen\x20.qzone-content');_0x21d742['addEventListener'](_0x5897a1(0xf6a),()=>{const {scrollTop:_0x484617,scrollHeight:_0x2fcfd4,clientHeight:_0x3ad4d6}=_0x21d742;_0x2fcfd4-_0x484617<=_0x3ad4d6+0x64&&!_0x1a7b40&&(_0x394ad5['length']>_0x577f17&&_0x2b7986());});const _0x517e8b=document[_0x5897a1(0x458)]('nai-gallery-grid');_0x517e8b['addEventListener']('scroll',()=>{const _0x15c849=_0x5897a1,{scrollTop:_0x1fd020,scrollHeight:_0x3096d7,clientHeight:_0x179979}=_0x517e8b;_0x3096d7-_0x1fd020<=_0x179979+0x64&&!_0x452dba&&(_0x401c8c[_0x15c849(0x131d)]>_0x597e2e&&_0x65a796());}),document[_0x5897a1(0x458)](_0x5897a1(0x823))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x5ce695);const _0x2cb568=document[_0x5897a1(0x458)]('reading-restore-btn');_0x44b566(_0x2cb568,_0x2cb568),document[_0x5897a1(0x458)](_0x5897a1(0xb65))[_0x5897a1(0xd85)]('click',_0xd64345),document['getElementById']('open-reading-library-btn')['addEventListener'](_0x5897a1(0x1122),_0x2cda95),document['getElementById'](_0x5897a1(0x1194))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x5c1c0c),document[_0x5897a1(0x458)]('prev-page-btn')['addEventListener'](_0x5897a1(0x1122),_0x3af5b2),document[_0x5897a1(0x458)](_0x5897a1(0xba))[_0x5897a1(0xd85)]('change',_0x5e81ef),document[_0x5897a1(0x458)]('minimize-reading-btn')[_0x5897a1(0xd85)]('click',_0x322ea6),document['getElementById'](_0x5897a1(0xbd4))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x575094),_0x44b566(document['getElementById']('reading-window'),document[_0x5897a1(0x586)](_0x5897a1(0xd35))),document['getElementById'](_0x5897a1(0x1112))['addEventListener'](_0x5897a1(0x1122),_0x2cda95),document[_0x5897a1(0x458)](_0x5897a1(0xfab))['addEventListener']('click',()=>{const _0x14c233=_0x5897a1;document[_0x14c233(0x458)]('reading-library-modal')[_0x14c233(0x11c2)]['remove'](_0x14c233(0x67d));}),document['getElementById'](_0x5897a1(0xe48))['addEventListener']('click',_0xbeec95),document[_0x5897a1(0x458)](_0x5897a1(0xfb6))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x3c8dbb=>{const _0x43db43=_0x5897a1,_0xf6e915=_0x3c8dbb[_0x43db43(0x12df)];if(_0xf6e915[_0x43db43(0x11c2)][_0x43db43(0x526)](_0x43db43(0xc14))){const _0x22a832=parseInt(_0xf6e915[_0x43db43(0x1f4)][_0x43db43(0x2d4)]);_0x5f2eb6(_0x22a832);}else{if(_0xf6e915['classList']['contains'](_0x43db43(0xb6e))){const _0x57875b=parseInt(_0xf6e915['dataset'][_0x43db43(0x2d4)]);_0x134ccb(_0x57875b);}}}),document[_0x5897a1(0x458)](_0x5897a1(0x344))[_0x5897a1(0xd85)]('click',_0x117d1f),document[_0x5897a1(0x458)](_0x5897a1(0x2cd))[_0x5897a1(0xd85)](_0x5897a1(0x754),_0x22fba7=>{const _0x3cf0dc=_0x5897a1;_0x751204(_0x22fba7[_0x3cf0dc(0x12df)][_0x3cf0dc(0x8dd)]);});const _0x9568e2=_0x341c49(_0x40ddca,0x12c);document['getElementById']('reading-content')[_0x5897a1(0xd85)](_0x5897a1(0xf6a),_0x9568e2),document[_0x5897a1(0x458)](_0x5897a1(0x59b))[_0x5897a1(0xd85)](_0x5897a1(0x754),_0x3d8e77=>{const _0x11c5e2=_0x5897a1;document[_0x11c5e2(0x458)](_0x11c5e2(0x83c))['textContent']=_0x3d8e77[_0x11c5e2(0x12df)]['value'];});const _0x458b51=document['getElementById'](_0x5897a1(0x785));_0x458b51['addEventListener']('scroll',()=>{const {scrollTop:_0x2f10ff,scrollHeight:_0x9c67c9,clientHeight:_0x12582b}=_0x458b51;_0x9c67c9-_0x2f10ff<=_0x12582b+0x96&&!_0x935422&&_0x438393();}),document[_0x5897a1(0x458)](_0x5897a1(0x9c5))['addEventListener'](_0x5897a1(0x1122),_0x9f9531),document[_0x5897a1(0x458)](_0x5897a1(0x251))[_0x5897a1(0xd85)]('click',()=>{const _0x233fe2=_0x5897a1;document[_0x233fe2(0x458)]('product-category-manager-modal')[_0x233fe2(0x11c2)][_0x233fe2(0x1097)](_0x233fe2(0x67d)),_0x24570e(_0xa38baa);}),document[_0x5897a1(0x458)](_0x5897a1(0x129d))['addEventListener'](_0x5897a1(0x1122),_0x4a284f),document[_0x5897a1(0x458)](_0x5897a1(0x1367))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x29f602=>{const _0xf486d9=_0x5897a1;_0x29f602[_0xf486d9(0x12df)][_0xf486d9(0x11c2)]['contains'](_0xf486d9(0xb6e))&&_0x4b54a0(parseInt(_0x29f602[_0xf486d9(0x12df)][_0xf486d9(0x1f4)]['id']));}),document[_0x5897a1(0x458)](_0x5897a1(0x13a3))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>_0x4aa268()),document[_0x5897a1(0x458)](_0x5897a1(0x3c2))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x484f0d=_0x5897a1;document[_0x484f0d(0x458)]('variation-selection-modal')['classList']['remove']('visible');}),document['getElementById'](_0x5897a1(0x13ae))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x422514=_0x5897a1,_0x2da4b6=document[_0x422514(0x458)](_0x422514(0x70e));let _0x457251=parseInt(_0x2da4b6[_0x422514(0x1a2)]);if(_0x457251>0x1)_0x2da4b6[_0x422514(0x1a2)]=_0x457251-0x1;}),document[_0x5897a1(0x458)]('variation-increase-qty')[_0x5897a1(0xd85)]('click',()=>{const _0x486d5f=_0x5897a1,_0xdcaeb1=document[_0x486d5f(0x458)](_0x486d5f(0x70e));_0xdcaeb1[_0x486d5f(0x1a2)]=parseInt(_0xdcaeb1[_0x486d5f(0x1a2)])+0x1;}),document['getElementById'](_0x5897a1(0xd2b))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x3a843a=>{const _0x2e3d44=_0x5897a1;if(_0x3a843a[_0x2e3d44(0x12df)][_0x2e3d44(0x11c2)][_0x2e3d44(0x526)](_0x2e3d44(0x44f))){const _0x652fc3=_0x3a843a[_0x2e3d44(0x12df)][_0x2e3d44(0x1f4)]['categoryId']===_0x2e3d44(0xfe2)?_0x2e3d44(0xfe2):parseInt(_0x3a843a[_0x2e3d44(0x12df)][_0x2e3d44(0x1f4)][_0x2e3d44(0x5f7)]);_0x2d0216(_0x652fc3);}}),document[_0x5897a1(0x458)](_0x5897a1(0x94f))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x43b9d6),document['getElementById']('shopping-settings-btn')['addEventListener'](_0x5897a1(0x1122),_0x431ff9),document[_0x5897a1(0x458)](_0x5897a1(0xa44))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x297918),document['getElementById'](_0x5897a1(0xe8d))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x23020b=_0x5897a1;document['getElementById'](_0x23020b(0xef5))[_0x23020b(0x11c2)][_0x23020b(0x1097)]('visible');}),document['getElementById'](_0x5897a1(0x11d0))[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x1b4853=>{const _0x28c017=_0x5897a1,_0x15d5f0=_0x1b4853['target'][_0x28c017(0x8f7)],_0x4abc25=document[_0x28c017(0x102a)](_0x28c017(0xc13));_0x4abc25[_0x28c017(0x12c2)](_0x31f705=>{const _0x569393=_0x28c017,_0x4f8f0e=parseInt(_0x31f705[_0x569393(0x1f4)]['id']);_0x31f705[_0x569393(0x11c2)][_0x569393(0x1270)]('selected',_0x15d5f0),_0x15d5f0?_0x4fc6cc['add'](_0x4f8f0e):_0x4fc6cc[_0x569393(0x195)](_0x4f8f0e);}),document[_0x28c017(0x458)]('delete-selected-products-btn')[_0x28c017(0x1a2)]=_0x28c017(0xeab)+_0x4fc6cc[_0x28c017(0x12a4)]+')';}),document[_0x5897a1(0x458)]('delete-selected-products-btn')['addEventListener'](_0x5897a1(0x1122),async()=>{const _0x593497=_0x5897a1;if(_0x4fc6cc[_0x593497(0x12a4)]===0x0){alert(_0x593497(0xeea));return;}const _0x3ea4be=await _0x2532b9('确认删除',_0x593497(0xdb4)+_0x4fc6cc[_0x593497(0x12a4)]+_0x593497(0x10a3),{'confirmButtonClass':_0x593497(0x4d3)});_0x3ea4be&&(await _0x17d534[_0x593497(0x122c)][_0x593497(0x1315)]([..._0x4fc6cc]),document[_0x593497(0x458)]('manage-products-btn')[_0x593497(0x1122)](),await _0x1044f9(),await _0x34fce8('成功',_0x593497(0x8b)));}),document[_0x5897a1(0x458)](_0x5897a1(0x54b))['addEventListener'](_0x5897a1(0x26a),_0x49ef80),document[_0x5897a1(0x458)](_0x5897a1(0x1455))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x36714d),document[_0x5897a1(0x458)](_0x5897a1(0x149))['addEventListener'](_0x5897a1(0x1122),_0x730ec0),document[_0x5897a1(0x458)](_0x5897a1(0x759))[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x4490f2=>{const _0x1a21a2=_0x5897a1,_0x3951ee=document[_0x1a21a2(0x458)](_0x1a21a2(0xde8));_0x3951ee['style'][_0x1a21a2(0x4db)]=_0x4490f2[_0x1a21a2(0x12df)][_0x1a21a2(0x8f7)]?_0x1a21a2(0x1188):_0x1a21a2(0x464);}),document[_0x5897a1(0x458)]('novelai-key-toggle')['addEventListener']('click',function(){const _0x538b2a=_0x5897a1,_0x1463d1=document[_0x538b2a(0x458)](_0x538b2a(0x40a));_0x1463d1['type']===_0x538b2a(0x141f)?(_0x1463d1[_0x538b2a(0x259)]=_0x538b2a(0xdd5),this['textContent']='😌'):(_0x1463d1['type']=_0x538b2a(0x141f),this[_0x538b2a(0x1a2)]='🧐');}),document[_0x5897a1(0x458)](_0x5897a1(0x72))[_0x5897a1(0xd85)]('click',()=>{const _0x108dfd=_0x5897a1;_0x25b947(),document[_0x108dfd(0x458)]('novelai-settings-modal')[_0x108dfd(0x1104)][_0x108dfd(0x4db)]=_0x108dfd(0x82b);}),document[_0x5897a1(0x458)]('nai-cors-proxy')['addEventListener'](_0x5897a1(0x26a),_0x174fca=>{const _0x201691=_0x5897a1,_0x4d43dc=document[_0x201691(0x458)](_0x201691(0xbb));_0x174fca[_0x201691(0x12df)]['value']==='custom'?_0x4d43dc['style']['display']=_0x201691(0x1188):_0x4d43dc[_0x201691(0x1104)][_0x201691(0x4db)]=_0x201691(0x464);}),document[_0x5897a1(0x458)]('close-novelai-settings')[_0x5897a1(0xd85)]('click',()=>{const _0x219d7c=_0x5897a1;document[_0x219d7c(0x458)]('novelai-settings-modal')[_0x219d7c(0x1104)]['display']=_0x219d7c(0x464);}),document[_0x5897a1(0x458)](_0x5897a1(0xf6e))['addEventListener']('click',()=>{const _0x35c6d4=_0x5897a1;_0x49ce2f(),document['getElementById'](_0x35c6d4(0x12f7))['style'][_0x35c6d4(0x4db)]=_0x35c6d4(0x464),alert(_0x35c6d4(0xaac));}),document[_0x5897a1(0x458)](_0x5897a1(0xdef))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x590bf7=_0x5897a1;confirm(_0x590bf7(0x38f))&&_0x16a87b();}),document[_0x5897a1(0x458)](_0x5897a1(0x993))[_0x5897a1(0xd85)]('click',()=>{const _0x218774=_0x5897a1,_0x4aa9ea=document['getElementById'](_0x218774(0x40a))[_0x218774(0x8dd)][_0x218774(0x2aa)]();if(!_0x4aa9ea){alert(_0x218774(0x1152));return;}document[_0x218774(0x458)](_0x218774(0x7bf))[_0x218774(0x1104)][_0x218774(0x4db)]='flex',document[_0x218774(0x458)]('nai-test-result')[_0x218774(0x1104)]['display']=_0x218774(0x464),document['getElementById'](_0x218774(0x2b9))[_0x218774(0x1104)]['display']=_0x218774(0x464);}),document[_0x5897a1(0x458)](_0x5897a1(0xacd))['addEventListener'](_0x5897a1(0x1122),()=>{const _0x554481=_0x5897a1;document[_0x554481(0x458)](_0x554481(0x7bf))['style'][_0x554481(0x4db)]=_0x554481(0x464);}),document[_0x5897a1(0x458)](_0x5897a1(0x88f))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x2453b2=_0x5897a1;document[_0x2453b2(0x458)](_0x2453b2(0x7bf))[_0x2453b2(0x1104)][_0x2453b2(0x4db)]='none';}),document[_0x5897a1(0x458)](_0x5897a1(0xf4))['addEventListener']('click',async()=>{await _0x4d9797();}),document[_0x5897a1(0x458)](_0x5897a1(0x139f))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x1b946d=_0x5897a1,_0xb4ee55=document['getElementById'](_0x1b946d(0x64d)),_0x137e87=document[_0x1b946d(0xe7d)]('a');_0x137e87[_0x1b946d(0x1173)]=_0xb4ee55['src'],_0x137e87[_0x1b946d(0x3c5)]='novelai-generated-'+Date['now']()+_0x1b946d(0x1224),_0x137e87[_0x1b946d(0x1122)]();}),document[_0x5897a1(0x458)](_0x5897a1(0x1375))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x42c931=_0x5897a1;if(!_0x42f206[_0x42c931(0x81d)])return;const _0x581788=_0x42f206[_0x42c931(0x954)][_0x42f206['activeChatId']],_0x265199=_0x581788[_0x42c931(0xda2)][_0x42c931(0xe1a)]||{'promptSource':_0x42c931(0x1370),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x42c931(0x458)](_0x42c931(0xe6))[_0x42c931(0x8dd)]=_0x265199['characterPositivePrompt']||'',document[_0x42c931(0x458)](_0x42c931(0x4f3))['value']=_0x265199['characterNegativePrompt']||'',document[_0x42c931(0x458)](_0x42c931(0xf99))['style'][_0x42c931(0x4db)]=_0x42c931(0x82b);}),document[_0x5897a1(0x458)](_0x5897a1(0x10ad))[_0x5897a1(0xd85)]('click',()=>{const _0x29e710=_0x5897a1;document[_0x29e710(0x458)]('character-nai-prompts-modal')[_0x29e710(0x1104)][_0x29e710(0x4db)]=_0x29e710(0x464);}),document[_0x5897a1(0x458)](_0x5897a1(0x8ff))[_0x5897a1(0xd85)](_0x5897a1(0x1122),async()=>{const _0x3ce96c=_0x5897a1;if(!_0x42f206[_0x3ce96c(0x81d)])return;const _0x50b41a=_0x42f206[_0x3ce96c(0x954)][_0x42f206[_0x3ce96c(0x81d)]];!_0x50b41a[_0x3ce96c(0xda2)][_0x3ce96c(0xe1a)]&&(_0x50b41a['settings']['naiSettings']={'promptSource':'system'}),_0x50b41a[_0x3ce96c(0xda2)]['naiSettings']['characterPositivePrompt']=document[_0x3ce96c(0x458)](_0x3ce96c(0xe6))[_0x3ce96c(0x8dd)][_0x3ce96c(0x2aa)](),_0x50b41a[_0x3ce96c(0xda2)]['naiSettings'][_0x3ce96c(0x134a)]=document[_0x3ce96c(0x458)](_0x3ce96c(0x4f3))['value'][_0x3ce96c(0x2aa)](),console[_0x3ce96c(0x7d1)](_0x3ce96c(0xffb)),console['log'](_0x3ce96c(0x10b1),_0x50b41a['settings']['naiSettings'][_0x3ce96c(0x7f)]),console['log'](_0x3ce96c(0xe74),_0x50b41a[_0x3ce96c(0xda2)][_0x3ce96c(0xe1a)][_0x3ce96c(0x134a)]),console[_0x3ce96c(0x7d1)](_0x3ce96c(0xe3e),_0x50b41a['settings'][_0x3ce96c(0xe1a)]['promptSource']),await _0x17d534[_0x3ce96c(0x954)][_0x3ce96c(0xf3f)](_0x50b41a),document[_0x3ce96c(0x458)](_0x3ce96c(0xf99))['style'][_0x3ce96c(0x4db)]='none',alert('角色专属NAI提示词已保存！');}),document[_0x5897a1(0x458)](_0x5897a1(0xbb8))[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x489a8c=_0x5897a1;confirm(_0x489a8c(0x110a))&&(document[_0x489a8c(0x458)](_0x489a8c(0xe6))['value']='',document['getElementById'](_0x489a8c(0x4f3))[_0x489a8c(0x8dd)]='');}),document['getElementById'](_0x5897a1(0x405))['addEventListener']('click',()=>{const _0x2f2cb3=_0x5897a1;if(!_0x42f206[_0x2f2cb3(0x81d)])return;const _0x501920=_0x42f206['chats'][_0x42f206[_0x2f2cb3(0x81d)]],_0x1f9de3=_0x501920[_0x2f2cb3(0xda2)][_0x2f2cb3(0xe1a)]||{'promptSource':_0x2f2cb3(0x1370),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x2f2cb3(0x458)](_0x2f2cb3(0xe6))[_0x2f2cb3(0x8dd)]=_0x1f9de3[_0x2f2cb3(0x7f)]||'',document[_0x2f2cb3(0x458)]('character-nai-negative')['value']=_0x1f9de3['characterNegativePrompt']||'',document[_0x2f2cb3(0x458)](_0x2f2cb3(0xf99))[_0x2f2cb3(0x1104)][_0x2f2cb3(0x4db)]=_0x2f2cb3(0x82b);}),document[_0x5897a1(0x458)](_0x5897a1(0x1180))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x337868),document[_0x5897a1(0x458)](_0x5897a1(0xc57))['addEventListener'](_0x5897a1(0x26a),_0x1ff289),document[_0x5897a1(0x458)](_0x5897a1(0x66c))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0xd899aa),document['getElementById'](_0x5897a1(0x150))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x2833a7),document[_0x5897a1(0x458)](_0x5897a1(0x482))[_0x5897a1(0xd85)]('click',()=>{const _0xd1616=_0x5897a1;_0x3d0170(_0xd1616(0x640));}),document[_0x5897a1(0x458)](_0x5897a1(0x256))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x36c06f=>{const _0x5aeda8=_0x5897a1,_0x2652ba=_0x36c06f['target'][_0x5aeda8(0xe87)](_0x5aeda8(0x7e0));if(_0x2652ba){const _0x14770f=_0x2652ba[_0x5aeda8(0x586)](_0x5aeda8(0x1cc));_0x14770f&&_0x36c06f[_0x5aeda8(0x12df)]!==_0x14770f&&(_0x14770f[_0x5aeda8(0x8f7)]=!_0x14770f[_0x5aeda8(0x8f7)]);}});const _0xe03ec4=document[_0x5897a1(0x458)]('sticker-category-tabs');_0x4376d8(_0xe03ec4,_0xa5de36=>{const _0x4034c0=_0x5897a1,_0x582754=_0xa5de36[_0x4034c0(0x12df)]['closest'](_0x4034c0(0x6d2));if(_0x582754){_0xa5de36['preventDefault']();const _0x517b17=_0x582754[_0x4034c0(0x1f4)][_0x4034c0(0x5f7)];if(_0x517b17==='all'){_0x34fce8('提示',_0x4034c0(0x10b0));return;}const _0x1ab9df=_0x517b17==='uncategorized'?_0x4034c0(0xbff):parseInt(_0x517b17);_0x389642(_0x1ab9df);}}),document[_0x5897a1(0x458)](_0x5897a1(0xea3))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x2b8248),document['getElementById']('close-nai-gallery-btn')[_0x5897a1(0xd85)](_0x5897a1(0x1122),()=>{const _0x22c1fd=_0x5897a1;document['getElementById'](_0x22c1fd(0x12cf))[_0x22c1fd(0x11c2)]['remove']('visible');}),document[_0x5897a1(0x458)](_0x5897a1(0x2cb))[_0x5897a1(0xd85)](_0x5897a1(0x1122),_0x11fd97),document[_0x5897a1(0x458)](_0x5897a1(0x6f6))['addEventListener'](_0x5897a1(0x1122),_0x50fbff=>{_0x59938e(_0x50fbff);}),document[_0x5897a1(0x458)](_0x5897a1(0x323))[_0x5897a1(0xd85)](_0x5897a1(0x26a),_0x4ae9d3=>{const _0x2ba2a9=_0x5897a1,_0x151763=_0x4ae9d3[_0x2ba2a9(0x12df)][_0x2ba2a9(0x8f7)];document[_0x2ba2a9(0x102a)](_0x2ba2a9(0x4ed))[_0x2ba2a9(0x12c2)](_0x3fbe7f=>{const _0x486214=_0x2ba2a9;_0x3fbe7f['classList'][_0x486214(0x1270)](_0x486214(0x500),_0x151763);const _0x4acc23=_0x3fbe7f[_0x486214(0x1f4)][_0x486214(0x1278)];_0x151763?_0x905915['add'](_0x4acc23):_0x905915[_0x486214(0x195)](_0x4acc23);}),_0x5134c2();}),document[_0x5897a1(0x458)](_0x5897a1(0x2be))[_0x5897a1(0xd85)]('click',()=>_0x49ce6f()),document[_0x5897a1(0x458)]('delete-selected-nai-gallery-btn')['addEventListener'](_0x5897a1(0x1122),()=>_0xb8ff03()),_0x52a5ca(),_0x589d88('home-screen');}_0x261798();});
