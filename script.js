const _0x3b4352=_0x356e;(function(_0x4c9704,_0x194459){const _0x5b5208=_0x356e,_0x75748e=_0x4c9704();while(!![]){try{const _0x2fbb8c=parseInt(_0x5b5208(0x75a))/0x1*(-parseInt(_0x5b5208(0x1384))/0x2)+-parseInt(_0x5b5208(0x102e))/0x3+-parseInt(_0x5b5208(0xd46))/0x4+-parseInt(_0x5b5208(0x107c))/0x5*(-parseInt(_0x5b5208(0x12bb))/0x6)+parseInt(_0x5b5208(0xe12))/0x7*(-parseInt(_0x5b5208(0xe97))/0x8)+-parseInt(_0x5b5208(0x7e7))/0x9+parseInt(_0x5b5208(0x128d))/0xa;if(_0x2fbb8c===_0x194459)break;else _0x75748e['push'](_0x75748e['shift']());}catch(_0x3c7b0a){_0x75748e['push'](_0x75748e['shift']());}}}(_0xe858,0xc5538));'serviceWorker'in navigator&&window['addEventListener'](_0x3b4352(0x246),()=>{const _0x57ae07=_0x3b4352;navigator[_0x57ae07(0xbc6)][_0x57ae07(0x46e)](_0x57ae07(0x128b))['then'](_0x164752=>{const _0x352f89=_0x57ae07;console[_0x352f89(0x471)]('ServiceWorker\x20注册成功，作用域为:\x20',_0x164752[_0x352f89(0x812)]);})[_0x57ae07(0x1035)](_0x47571c=>{const _0x1462cb=_0x57ae07;console[_0x1462cb(0x471)](_0x1462cb(0xe5b),_0x47571c);});});!Array[_0x3b4352(0x4b4)][_0x3b4352(0xceb)]&&Object[_0x3b4352(0xae6)](Array[_0x3b4352(0x4b4)],_0x3b4352(0xceb),{'value':function(_0x9bb01e){const _0x45ca58=_0x3b4352;if(this==null)throw new TypeError('Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined');if(typeof _0x9bb01e!==_0x45ca58(0x1019))throw new TypeError('predicate\x20must\x20be\x20a\x20function');let _0x1c2560=Object(this),_0x21a744=_0x1c2560['length']>>>0x0,_0x4c070f=arguments[0x1],_0x508c82=_0x21a744-0x1;while(_0x508c82>=0x0){let _0x33bd55=_0x1c2560[_0x508c82];if(_0x9bb01e[_0x45ca58(0x4a8)](_0x4c070f,_0x33bd55,_0x508c82,_0x1c2560))return _0x508c82;_0x508c82--;}return-0x1;},'configurable':!![],'writable':!![]});let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],currentQzoneReplyContext=null,editingNpcId=null;function _0x356e(_0x1f240e,_0x1fd73d){const _0xe85821=_0xe858();return _0x356e=function(_0x356e42,_0x3aa23e){_0x356e42=_0x356e42-0x15a;let _0x4e5897=_0xe85821[_0x356e42];return _0x4e5897;},_0x356e(_0x1f240e,_0x1fd73d);}const GEMINI_API_URL=_0x3b4352(0x193);function getRandomValue(_0x4af6fd){const _0x3299b8=_0x3b4352;if(_0x4af6fd[_0x3299b8(0xced)](',')){const _0x204466=_0x4af6fd[_0x3299b8(0x55b)](',')[_0x3299b8(0x412)](_0x4e83b8=>_0x4e83b8['trim']()),_0x5d4baa=Math['floor'](Math['random']()*_0x204466[_0x3299b8(0x7aa)]);return _0x204466[_0x5d4baa];}return _0x4af6fd;}function isImage(_0x3c1958){const _0x17cd97=_0x3b4352;if(_0x3c1958[_0x17cd97(0xcad)]&&_0x3c1958['image_url'][_0x17cd97(0x11de)]){let _0x43828c=_0x3c1958['image_url'][_0x17cd97(0x11de)];const _0x54e8ae=_0x43828c[_0x17cd97(0x55b)](',')[0x1],_0x5dc1d5=_0x43828c[_0x17cd97(0x86c)](/^data:(.*);base64/)[0x1];return[{'text':_0x17cd97(0xeb5)},{'inline_data':{'mime_type':_0x5dc1d5,'data':_0x54e8ae}}];}return[];}function getGeminiResponseText(_0x4e16ac){const _0x3f49de=_0x3b4352;if(_0x4e16ac[_0x3f49de(0xd3b)]&&Array[_0x3f49de(0xbd6)](_0x4e16ac[_0x3f49de(0xd3b)])&&_0x4e16ac[_0x3f49de(0xd3b)][_0x3f49de(0x7aa)]>0x0&&_0x4e16ac[_0x3f49de(0xd3b)][0x0]['message']&&_0x4e16ac[_0x3f49de(0xd3b)][0x0][_0x3f49de(0x1288)][_0x3f49de(0x28c)])return _0x4e16ac['choices'][0x0][_0x3f49de(0x1288)][_0x3f49de(0x28c)];if(_0x4e16ac['candidates']&&Array[_0x3f49de(0xbd6)](_0x4e16ac['candidates'])&&_0x4e16ac['candidates'][_0x3f49de(0x7aa)]>0x0&&_0x4e16ac[_0x3f49de(0xb59)][0x0]['content']&&_0x4e16ac[_0x3f49de(0xb59)][0x0]['content'][_0x3f49de(0x496)])return _0x4e16ac['candidates'][0x0][_0x3f49de(0x28c)][_0x3f49de(0x496)][0x0][_0x3f49de(0xec9)];console[_0x3f49de(0x1fd)](_0x3f49de(0xada),_0x4e16ac);let _0x1476de=_0x3f49de(0x760);if(_0x4e16ac[_0x3f49de(0xb59)]&&Array[_0x3f49de(0xbd6)](_0x4e16ac[_0x3f49de(0xb59)])&&_0x4e16ac['candidates']['length']>0x0&&_0x4e16ac[_0x3f49de(0xb59)][0x0][_0x3f49de(0x12f6)]===_0x3f49de(0x2fb)){const _0x5f365d=_0x4e16ac['candidates'][0x0][_0x3f49de(0x52c)],_0x3da8e6=_0x5f365d['filter'](_0x25ff59=>_0x25ff59['probability']!==_0x3f49de(0xe5a)&&_0x25ff59[_0x3f49de(0x699)]!==_0x3f49de(0x9e9))[_0x3f49de(0x412)](_0xcbf1f7=>_0xcbf1f7[_0x3f49de(0x1369)]+'\x20(概率:\x20'+_0xcbf1f7[_0x3f49de(0x699)]+')')[_0x3f49de(0x1237)](',\x20');_0x1476de=_0x3f49de(0xe15)+(_0x3da8e6||'未知');}else{if(_0x4e16ac['promptFeedback']?.['blockReason']){const _0x4464a0=_0x4e16ac['promptFeedback'][_0x3f49de(0xc4a)],_0x5ecb43=_0x4e16ac[_0x3f49de(0xab0)][_0x3f49de(0x52c)]?.[_0x3f49de(0x412)](_0x3d63f8=>_0x3d63f8[_0x3f49de(0x1369)]+':\x20'+_0x3d63f8[_0x3f49de(0x699)])[_0x3f49de(0x1237)](',\x20');_0x1476de='内容因安全策略被屏蔽\x20(原因:\x20'+_0x4464a0+_0x3f49de(0x1356)+(_0x5ecb43||'无');}else _0x4e16ac[_0x3f49de(0x1fd)]&&(_0x1476de=_0x3f49de(0xbd8)+_0x4e16ac[_0x3f49de(0x1fd)]['message']);}throw new Error(_0x1476de);}function _0xe858(){const _0xe2a930=['请先点击扳手图标进入管理模式，才能添加新商品。','确认删除分类','</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>','var-','applicationReason','currentLyricIndex','请根据以上情景，生成新的评论。','outgoing-call-avatar','replyToDisplayName','padEnd','spectator','remove','manage-stickers-btn','更换“','products','toLowerCase','.rules-tab','lrc-upload-input','songName','https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20','https://i.postimg.cc/XY63sTS3/IMG-4393.gif','天\x20-\x20投票','\x20的外卖订单支付了\x20','最小帖子数不能大于最大帖子数！','my-avatar-preview','NovelAI设置已保存！','”分享TA的备忘录...','...”)','<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>','\x22\x20class=\x22avatar-frame\x22></div></div>','\x20本世界书已成功删除。','https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','speech','character_book','设置群名','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合“今天是','选定范围内的动态已被清空。','正在为所有AI角色生成并注入游戏记忆...','正在请求AI进行手动总结...','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','add-preset-btn','preset-action-edit','没有配置为后台活跃的角色，跳过模拟。','product-category-select','aiPersona','请输入有效的红包个数！','display','请选择一个目标。','delete-group-btn','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>','”生成商品？','smea','translateY(0px)','poll-question-input','create-post-modal','simulatedAppUsage','video-call-screen',')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]','[data-version]','\x20评论了动态]','https://i.postimg.cc/05DLr0yj/IMG-4427.gif','无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20','negative','\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a','请输入新的名称（留空则恢复默认）','为NPC\x20\x22','数据检查与修复失败:','rp-details-list','cancel-post-action-btn','\x20小时了。','\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>','css-preset-select','{{user}}','音频播放失败:','go-to-cart-btn','message','realimag','floor','./sw.js','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','30693930aIffnR','close-announcement-board-btn','npc-avatar-preview','offline-mode-group','(无内容)','book-upload-input','save-product-btn','status-bar-visible','已恢复默认字体。','confirm-gift-recipient-btn','character-profile-modal','”。\x0a','existing-categories-list','naiSettings','setAttribute','生成购物中心商品失败:','confirm-create-countdown-btn','rules-tab','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...','gift-recipient-modal','确认导入','offline-preset-select','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','click','cphone-icon-settings-grid','\x20天的讨论环节。\x0a','转发成功！','https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a','commentsCount',':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>','api-key','-\x20**姓名**:\x20','werewolf-wait-reply-btn','translateX(-50%)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20','frame_6','vote','import-new-book-btn-header','initiator','错误:\x20','狼人杀游戏总结已自动存入\x20','已切换到角色\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','stroke','1440HNXLSF','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20','preview-font-style','tables','将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。','https://i.postimg.cc/bJDMQVkj/IMG-7112.gif','save-world-book-btn','昨天\x20','-\x20(暂无)','\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？','favorites-list','#\x20对话示例\x0a','未发现需要迁移的旧红包数据。','avatar','char-music-cover','simulatedTaobaoHistory','无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20','frame_12','https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','imageDescription','\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a','import-btn','cphone-wallpaper-upload-input','pending_ai_approval','\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22','”的头像库','确定要永久删除这条心声记录吗？此操作不可恢复。','确定要从头像库中删除“','manage-my-avatar-library-btn','my-persona','[你发送了一张需要AI识别的图片，图片内容是：\x27','共享位置','https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','播放失败，请检查URL是否正确或浏览器是否支持该格式。','动态已删除。','的状态已更新为:\x20','persona-editor-modal','最终负面提示词:','AI已接收并理解了该图片的内容。','associatedWith','add-message-editor-block-btn','\x20死亡了。','诊断：在顶层\x20','reading-restore-btn','customCss','gomoku-board','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','transfer-cancel-btn','variation-decrease-qty','call_summary','selection-mode','请开始整合。','无共同好友','\x20(用户)</span>\x0a\x20\x20\x20\x20','manage-world-book-categories-btn','onloadend','请至少选择一个要清空的范围。','find','\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','finishReason','qzone-avatar-img','profile-thoughts-history-view','恭喜发财，大吉大利！','配置错误','lrcUpdateInterval','favorites-view','”准备好友申请...','doubanMinPosts','hasShown40','chatItem','预设已删除。','计算图片总大小时出错:','chat-settings-btn','https://i.postimg.cc/ThMMVfW4/10.jpg','\x20发布)\x0a','<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','https://i.postimg.cc/8kYShvrJ/90-UI-2.png','API未配置，无法生成对话。','AI方','smea_dyn','<span\x20style=\x22color:\x20red;\x22>未满足</span>','\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','记忆链接','确认精炼记忆？','select-message-btn','https://i.postimg.cc/63NmX03s/IMG-4366.gif','.comment-send-btn','qzone-sticker-panel','旁观模式AI发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。','删除表情','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','selection-screenshot-btn','\x20.message-bubble\x20$1','导演模式','<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22','currentVoiceId','\x20条旧的红包消息！页面将自动刷新以应用更改。','<p>','请AI角色们继续进行讨论。','activeAlbumId','[图片，描述:\x20','群聊通话中没有找到可作为总结主体的AI角色。','https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','musicLibrary','GBK\x20解码成功。','每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。','removeChild','char-taobao-screen','QQ音乐搜索API失败:','character-nai-negative','character','theme-preset-select','hiddenContent',')，开始总结...','https://i.postimg.cc/1zmcp66p/IMG-5973.gif','<button\x20class=\x22sticker-category-tab\x20','在这里输入图片描述','收到了格式不规范的AI指令（缺少type和content），已跳过:','<em>$1</em>','notification-sound-url-input','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','\x20当前时间是\x20','activePostId','EPhone-长截图-','”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20','书名不能为空！','photos-grid-page','currentTime','原文:\x20\x22','.entry-content-container','说说内容不能为空哦！','rule-editor-title','恭喜！','group-members-settings','customAvatarFrames','getItem','++id,\x20name,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp','rule-enabled-switch','https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','read-together-btn','正在等待AI角色们对你的发言做出回应...','clear-posts-modal','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','无人接听群聊邀请。','animate-like','<span\x20class=\x22commenter-name\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22','约定达成！','ai-avatar-preview','add-new-sticker-category-btn','avatar-frame-modal','请输入一个有效的URL或选择一个文件！',')。详情:\x20','生成成功！','cancel-wolf-kill-btn','游戏记忆已成功注入到\x20','\x20位角色的记忆中。','\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。','图片压缩过程中发生错误:','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','for_timestamp','.sender','无法解析预设文件。\x0a错误:\x20','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【【【长度铁律】】】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**','variation-quantity-display','<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>','model','latestTimestamp','网易云音乐搜索失败:','nai-smea','logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27','category','char-article-title','没有找到可导入的内容。请检查您粘贴的格式是否正确。','\x20\x20-\x20你评论说:\x20','imageCount','https://image.novelai.net/ai/generate-image-stream','\x20更换了你的头像]','\x20分享了一张NovelAI图片，prompt:\x20','nai-seed','status-bar-toggle-switch','https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','商品名称不能为空！','enableAutoMemory','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>','assistant','压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...','请输入新的封面图片链接','cssText','-\x20\x20\x20**NovelAI图片分享**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22name\x22:\x20\x22你的角色名\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20【禁止暴露这是novelai生成的图片!】\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20使用场景：当你想要基于当前对话情景、你的性格或上下文分享一张图片时使用。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。','分钟前','is-poll','TA的好友包括:\x20','ai-frame-tab','通话结束，时长\x20','npc-list','chat_','relationship','4FCroxT','paid','isEnabled','请先输入你的发言内容。','创建新规则','\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','选中的收藏已被移除。','is-realimag','push','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>','应用已返回前台，正在检查更新...','诊断：在\x20data.character_book\x20中找到世界书。','avatar_prompt','\x22\x20data-category-id=\x22all\x22>全部</button>','.participant-avatar-wrapper[data-participant-id=\x22','favorites-action-bar','https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','price','\x0a-\x20**讨论摘要**:\x20\x0a','</p>','你们已经有','post-actions-btn','commentIndex','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','select-all-chars-for-clear','https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','**[夜晚]**\x20','https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','\x20中找到世界书。','message-editor-container','\x20条消息，AI将完全遗忘它们的存在。确定吗？','清理失败','waimai-amount','variation-select','确认清理无效歌曲？','覆盖预设','正在发牌...','where','AI\x20\x22','）。]','https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','.variation-price-input','<p>♪\x20暂无歌词\x20♪</p>','favorites-delete-selected-btn','解析AI返回的投票JSON时出错:\x20','banner','\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','parentElement','favorites','native','pointer','mouseout','.selected-options-text','表情包分类绑定已更新！','wallpaper-preview','regenerate-call-btn','update_status','system','#douban-cast-list\x20.douban-cast-checkbox:checked','解析成功：通过强力提取模式。','”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。','\x20(图片描述:\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“','#delete-world-books-list\x20.clear-posts-item.selected','https://generativelanguage.googleapis.com/v1beta/models','我们的群聊','save-font-preset-btn','template',':\x20[发送了一个表情，意思是:\x20\x27','.info','isPinned','”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','char-wallet-screen','\x22\x20已经存在了！','无标题','memories','++id,\x20chatId,\x20timestamp,\x20customName','group-management-modal','bg-preview','share-link-btn','你现在在哪里呀？','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>','save-douban-cast-btn','无法生成新回复:\x20','timeZone','select-all-stickers-checkbox','reading-library-modal','彻底删除消息','save','压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...','message-bubble\x20post-deleted-placeholder','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','/9j/','checked','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“','highlighted','hasShown20','photo-viewer-prev-btn','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20','char_diary','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','AI返回了空内容。','正在读取所有数据到内存中，请稍候...',')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]','应用已切换到后台，记录当前时间。','当前群聊还没有公告哦。','upload-custom-frame-btn','添加\x20NPC','undefined','import-world-book-btn','\x0a#\x20可用表情包\x0a','new_name','ZIP\x20Blob\x20大小:','AI未能成功描述图片。','typing-indicator','\x0a#\x20身份与核心任务\x0a你正在扮演角色“','gap','你已经死亡，无法发言。请等待其他玩家发言结束。','originalPost','你们最近没有有效聊天记录。','投票结果：','product-item','https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','simulatedConversations','is-voice-message','”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20','<div\x20class=\x22post-images-grid\x20grid-','\x0a**内容:**\x0a','message-actions-modal','backgroundImage','检测到旧版完整备份文件，开始导入...','message-wrapper\x20system-pat','--chat-font-size','share_link','iconId','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','*对方按下了接听键...*','**关键词:**\x20','mouseup','nai-resolution','未知书籍','myAvatarFrame','¥\x200.00','groupAvatarLibrary','\x20发送了一个【拼手气红包】(时间戳:\x20','stickerId','https://i.postimg.cc/jCVK0fGL/IMG-6890.gif','https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','countdownEndTime','zh-CN','line-through','确定要删除与\x20\x22','add-my-avatar-upload-btn','\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20','.product-item.selected','AI返回的讨论内容格式不正确。原始返回:\x20','innerHTML','showStatusBar','小组风格','已返回我的手机','基础数据不完整，无法开始总结。','无法访问剪贴板。','.world-book-category-pane[data-category-id=\x22','AI投票决策API失败:','表情名不能为空！','ZIP文件内容:','\x0a-\x20**这是你们最近的对话历史**:\x0a','。等待对方处理。]','\x20的动态\x20(角色)','无人投票','error','\x22\x20触发带理由的好友申请决策流程...','quote','getBattery','werewolf-finish-speech-btn','轮到你发言了...','本地群头像上传及识别失败:','<span\x20class=\x22lucky-king-tag\x22>手气王</span>','消息已更新！','char-photo-description','\x22\x20触发专属决策流程...','精炼成功','</p><p>','\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','[发送了一条复杂消息，如卡片或转账]','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','请至少选择一种要清理的数据类型。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>','请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif','userStickers','生成的图片URL:','call-message-bubble\x20','open_red_packet','.message-editor-block','，人设:\x20','close-persona-library-btn','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20[','操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20','globalSettings','witch-do-nothing-btn','mes_example','.sticker-item.selected','werewolf-log-entry\x20','\x22]:checked','authorChatId','paddingBottom','\x0a#\x20对话者的角色设定\x0a','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20','offsetLeft','target','douban-send-comment-btn','你撤回了一条消息','\x20行的格式不正确，已被跳过。','\x22\x20(群名)\x20的消息。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a','nickname','生成模拟日记失败:','reply_content','发送照片','[一张图片，描述为：\x22','appendChild','announcement-actions-modal','你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','\x20的红包','stickerCategoryIds','fetch-models-btn','生成模拟淘宝记录失败:','将清空选定角色的心声和散记历史。','add-new-product-category-btn','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>','currentText','\x22\x20class=\x22chat-image\x22>','clipboard','bg-btn','page-indicator','wallpaper-upload-input','fetch-secondary-models-btn','”的记忆和人设，生成全新的社交动态...','》设定:\x0a','.rules-category-pane','levelchange','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>正在计算可压缩图片大小...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>--\x20MB</span>\x0a\x20\x20\x20\x20','load','从角色卡导入\x20(.json/.png)','short','一位神秘的NPC','主题预设已保存！','\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心新增】在这里添加“背景”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22','qzone-posts-list','https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','#post-public-text','检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','album-photo-input','.delete-memory-btn','heartfeltVoice','浏览器不支持电池状态API。','请先在API设置中配置好（主或副）API。','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','拼手气红包',')\x20领取了最后一个红包。红包已被领完，手气王是\x20','body','&id,\x20name,\x20categoryId','prompts','App记录','\x22）。你已经有一段时间没有和用户（','未知用户','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','notificationSoundUrl','char-music-play-pause-btn','对方撤回了一条消息','确定要删除头像框\x20“','video_call_response','shoppingCategoryCount','AI\x20发言失败','fontUrl','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','cphone','radio','！请对此事件发表评论。]','<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','frame_9','AI\x20的下棋指令无效或位置已被占据:','custom-modal-body','char-diary-detail-back-btn','https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','.loading-spinner','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','.voice-play-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>','char-amap-screen','group-avatar-preview','https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','tencent','personaPresets','https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','randomJottings','member-settings-modal','**内容:**\x0a','导演模式保存了一个无效的五子棋移动指令:','<button\x20class=\x22delete-btn\x22\x20data-id=\x22','你们没有在听歌。','https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','createElement','handleListenTogetherClick','rp-details-item','outgoing-call-name','AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20\x20\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20\x20\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20\x20\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20\x20\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20','content','waimai-timer-','扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20','cache','delete-api-preset-btn','douban-comment-item','请输入一个有效的数字（建议大于20）。','已删除最新心声，当前心声已回滚至上一条。','-\x20昨晚是平安夜，无人死亡。\x0a','clear-posts-list','.poll-action-btn','Escape','enableTimePerception','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','post-actions-modal','battery-alert-text','char_browser_article','post-visibility-groups','\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22','silent-audio-player','apply-friend-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</small>','“全部”分类无法被绑定。','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20','switch-greeting-group','first','检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。','https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','music-play-pause-btn','CELL_SIZE','isLocal','douban-detail-author','\x0a-\x20散记:\x20','\x22\x20中发现并修复了旧红包数据。','请根据你的设定，写一篇新日记。','https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','.music-search-checkbox','https://i.postimg.cc/xjpN4swz/IMG-7240.gif','world-book-tabs','\x22\x20创建了一个新约定:','已阵亡，还有30秒爆炸','请在此处粘贴完整的LRC格式歌词...',')\x20的残缺数据。','&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','已拒收对方转账','product-image-input','appearance','创建世界书','memory-card','regenerate-char-amap-btn','postTitle','playlist','”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a','预设名称不能为空！','”]\x20','生成中...','chat-name-input','save-theme-preset-btn','cancel-create-countdown-btn','\x20同步所有群聊内的名称信息...','请根据你的设定，生成你的相册内容。','chat-list','parse','audio-player','[发送了一条语音，内容是：\x27','margin','secondaryApiKey','AI\x20尝试评论一个不存在的表情:\x20\x22','packetType','douban-post-detail-screen','”，价值','chat-input-actions-top','recalled-animation','导演模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','\x22\x20class=\x22avatar-frame\x22></div>','minimax-model-select','\x22></div>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','postType','\x22操作...','waimai-product-info','.message-bubble','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22','\x0a\x0a现在，请生成这份歌单。','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>','动态已更新！','sort','API未配置，无法生成内容。','\x22\x20尝试执行未知的后台动作:','https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a','sticker-item','<input\x20type=\x22',')\x20为\x20','\x22\x20value=\x22','save-appearance-preset-btn','解析格式模板失败:','[群聊]','char-background-activity-switch','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','classList','\x22\x20创建成功！','chatRenderWindow','value','icon-setting-item','temp_user_chat_mirror','profile-history-icon-btn','mode','\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。','favorite-diary-btn','SAFETY','[表情:\x20\x27','clientWidth','\x22\x20的后台活动开关已关闭，本次跳过。','recipientName','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>','\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','cancel-clear-wizard-btn-step1','\x20的消息:\x20\x22','sticker_','ZIP解压失败:','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','https://i.postimg.cc/Y9d3BztC/1.png','图片格式处理失败:\x20','\x22\x20成功发布了一条新动态。','\x20->\x20','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','apiConfig','editable-text','check-and-fix-data-btn','originalContent','isBusy','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','collapsed','打开预设编辑器时发生严重错误:','blockedTimestamp','此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。','back-to-clear-step1-btn','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','此操作将永久删除您选择的\x20','werewolf-role-name','stickerCategories','minimized','传统导出\x20(兼容旧版或内存小的浏览器)','https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','nai-cors-proxy','from',')，并在对话中自然地体现出来。','\x0a-\x20**角色人设**:\x20','\x20更换了群头像','purchases','内容为空。','\x0a<character>\x0a\x20\x20<name>','https://i.postimg.cc/pddJj9zN/IMG-7094.gif','https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','%\x20+\x20','下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>','linkedWorldBookIds','请输入新的图片URL：','wait-reply-btn','使用解药救TA','steps','消息内容已复制到剪贴板。','请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)','artistName','selected','edit-post-btn','chat-lock-overlay','<p\x20class=\x22char-browser-image-description\x22>','压缩失败','upgrade','由于浏览器安全限制，AI切换的歌曲无法自动播放。请手动点击播放按钮\x20▶\x20继续欣赏。','确定发布','global-lyrics-bar','totalAmount','voted','memories-view','发布公告','werewolf-','回复\x20','拉取模型失败:\x20','<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>','\x22\x20决定去发一条动态...\x20(此处为模拟)','update_thoughts','</button>','https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','musicData','狼人请选择刀人对象','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>','\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【','phone-screen','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','\x0a\x0a将重置冷静期。','AI返回的行动中未找到有效的JSON数组。','\x22\x20class=\x22realimag-image\x22\x20alt=\x22NovelAI图片分享\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22\x20title=\x22','stickerCategoryId','</td><td\x20class=\x22item-subtotal\x22>¥','”下，回复了\x27','https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','.action-icon','）刚刚撤回了一条消息。撤回前的内容是：','swipeDirection','无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20','poison','chat-group-container','isDeleted','https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg','querySelectorAll','请先选择角色','appIcons','\x20[包含','你正在阅读的段落','product-category-tabs','search-result-item','https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','announcements','message-bubble\x20system-bubble','https://i.postimg.cc/05wnd389/IMG-4388.gif','is-transfer','\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','AI幻觉已被拦截！试图使用群名\x20(\x22','天\x20-\x20白天','target_timestamp','用户删除了自己的评论，开始清理AI记忆...','renderWorldBookScreenProxy','你已拒收','music-search-results-modal','每晚可以查验一个玩家的身份是好人还是狼人。','\x0a\x0a现在，请为所有【存活的AI角色】生成他们充满策略和博弈的发言。','https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','这个预设文件中没有找到任何有效的提示词条目。','https://i.postimg.cc/prsGKMBx/IMG-4370.gif',')\x20和情景的感知。','#vinyl-view\x20#music-player-cover','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.','shopping-screen','indexOf','”\x20已被删除。','<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>','regenerate-char-usage-btn','animate-in','https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','跳过一个无法解析为JSON的编辑块:','https://i.postimg.cc/B6T59xGK/IMG-7101.gif','旁观群聊至少需要选择2个成员。','guard','publish-to-announcement-btn','读书会话已关闭。','memberId','close-sticker-panel-btn','#\x20你的社交圈\x20(绑定的NPC)\x0a','</div><div\x20class=\x22gift-footer\x22>共','world-book-category-pane','文章详情','选中的头像框已成功删除。','tEXt','\x20转账\x20','https://files.catbox.moe/q6z5fc.jpeg','receiver','model-select','participants','请根据你的设定，生成你的浏览器记录。','cart-items-list','\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>','open-persona-library-btn','minimize-reading-btn','请输入歌手名','\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**','post-upload-local-btn','custom-modal-cancel','close-reading-btn','group','”这个信息，将其转换为【具体的公历日期】（例如：“约定了明天见面”应总结为“我们约定了','red-packet-details-modal','https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','frame-item','clearRect','[NovelAI图片:\x20','游戏结束','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','歌曲背景已更新！','memoryTimestamp','characterName','backgroundActivityInterval','\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','announcement-action-cancel','cancel-message-action-btn','.post-deleted-placeholder','book_','.lyric-line','\x20的外卖订单（时间戳:\x20','danger-option','frame_tech','marginTop','customName','https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','save-sticker-binding-btn','regenerate-char-taobao-btn','https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>','togglePlayerFullscreen','文章完整内容...','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>','”的长期记忆中。','”。]','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20','album-item','mouseleave','open-album-btn','onloadedmetadata','”的参考记忆','已取消收藏。','sticker',')，问题是：“','inject-thought-group','char-memo-list','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','product-category-tab','unreadCount',':generateContent?key=','conversationIndex','is-waimai-request','close-reading-library-btn-header','<option\x20value=\x22','variations','文字已更新！','请根据你的设定，生成你的淘宝购买记录和余额。','npc-action-cooldown-input','filter','import-appearance-btn','确认删除','删除约定','.nav-item[data-view=\x22qzone-screen\x22]','photo-viewer-close-btn','[系统提示：用户(','commenter','🚀\x20发送NAI请求:','.delete-track-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','suffix','见面”）。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过100个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','\x20请根据这个结果发表你的评论。]','分享新鲜事...','ai-original-name-group','char-vinyl-container','这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a','\x20(用户)</label>','#group-management-modal\x20.modal-header\x20span','existing-groups-list','novelai-test-modal','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','成功将群聊\x20\x22','rp-direct-greeting','\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22','购物中心生成设置已更新！','cancel-douban-cast-btn','linked-chats-checkboxes-container','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','countdown-title-input','disabled','EPhoneWorldBookBackup','\x0a-\x20**你的长期记忆**:\x0a','[你发送了一个表情，意思是：\x27','Bearer\x20','time','<span\x20class=\x22offline-dialogue\x22>','对方正在输入...','contains','remove-bg-btn','novelai-switch','\x20剩余红包将在','角色卡导入失败:','offlinePresetId','”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。','#listen-together-btn\x20img','scale(0.8)','group-video-call-btn','API\x20调用失败','absolute','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>','.screen.active','\x22,\x20\x22postId\x22:\x20456,\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','werewolf-player-selection-list','单个红包金额不能少于0.01元！','本地歌曲源错误:','\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a','map','检查更新时出错:','「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)','商店空空如也，点击“管理”添加商品吧！','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','switch-to-text-image-mode','当作\x20ZIP\x20文件处理...','.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a','游戏尚未结束，无法进行总结。','目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20','confirm-hunter-shot-btn','.com/','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','werewolf-selection-item',')，内容摘要是：“','字体预设已保存！','[系统提示：你刚刚成功将对用户的称呼修改为了“','authorAvatarPrompt','」的新会话吗？','toLocaleString','大小:','外观设置已成功导入并应用！','password','\x0a你必须严格遵守','送给了\x20','nai-test-error','hasOwnProperty','动态与互动','width','single','packet_timestamp','share-link-modal','📸\x20NovelAI图片生成开始，AI提供的prompt:','1px\x20solid\x20#e0e0e0','分享成功','请先在购物车中选择要结算的商品。','start-werewolf-game-btn','world-book-card','\x20被投票放逐。','渲染聊天项\x20[','用户\x20(','vinyl-view','isGroupCall','所有世界书数据已成功导出！','保存CSS预设','角色专属NAI提示词已保存！','ai-response-editor-modal','网络图片\x20(CPhone)','stores','has-frame','novelai-details','\x20\x0a-\x20**你最近和“','getMinutes','确定要删除选中的\x20','\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20','<div\x20class=\x22pinned-indicator\x22>📌</div>','[RealImag真实图片]','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','友善的评论是交流的起点','lineWidth','\x27的评论，内容是：“','\x22\x20的整个对话吗？此操作不可撤销。','imageUrl','waimai_order','-\x20你的解药状态：','请输入一个有效的页码！','https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','file','选择记忆所属角色','publisher','existing-product-categories-list','delete-selected-products-btn','（无文字内容）','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。','\x20本世界书','元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','API未配置','contact-picker-screen','\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“','handleWidgetImageChange','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','npc-background-activity-switch','delete-theme-preset-btn','stringify','favorites-edit-btn','.countdown-card\x20.timer','\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a','”的记忆\x20---\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22sticker-binding-checkbox\x22\x20data-chat-id=\x22','页面跳转','发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a','lastMemorySummaryTimestamp','register','maxMemory','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>','log','cphone-wallpaper-preview','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','call-history-list','长期记忆','search-history-screen','<img\x20src=\x22','all\x200.3s\x20ease','preset-action-delete','anime\x20person','qzone-screen','#custom-modal-body\x20.format-btn[data-type=\x22text\x22]','shared-history-viewer-title','.favorite-item-card','werewolf-kill-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','正在为角色“','外观设置','scenario','preCallContext','minimax-api-key','nextElementSibling','my-avatar-library-modal','chara','substring','https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','theme-default','type','导演/编辑模式保存(Sticker):\x20使用了\x20meaning\x20查找','”吗？','该消息发送已超过2分钟，无法撤回。','在动态评论区点击了表情，但在表情库中未找到对象:','isBgClear','】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22','.link-share-card','default_positive','#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a','parts','[图片生成失败:\x20','》:\x0a','selection-share-btn','你领取了\x20','button-order-editor','\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动。\x0a3.\x20\x20**【简洁性铁律】**:\x20每条个人记忆总结【绝对不能超过60个字】。\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我今天在群里和大家讨论了电影，感觉很开心。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我在群里和','点击下方上传','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>','https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','waimai-confirm-btn','.world-book-tab','export-data-btn','\x22\x20class=\x22chat-image\x22></div>','退出游戏','announcement-board-content','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20','add-group-avatar-batch-btn','call','arrayBuffer','sticker-binding-modal','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>','summary','targetDate','isDanger','现在开始讨论，请各位玩家依次发言。','确认操作','”的聊天记录','killedId','openNpcEditor','prototype','values','此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？','AI\x20(群聊后台)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','clientY','正在读取并解析备份文件...','\x20的已删除动态','AI返回的刀人目标格式不正确。','participant','\x0a-\x20**人设\x20(必须严格遵守)**:\x20','检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。','群聊\x20\x22','widgetData','https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','删除评论','qzone-post-container','\x20<span\x20class=\x22source\x22>','请输入要精炼的最近记忆条数\x20(最多\x20','”，内容是：“','请先在API设置中配置好（主或副）API以进行总结。','blocked_by_user','结束投票','char_book','确定要删除这篇日记吗？','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','totalBalance','文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。','data:\x20[DONE]','这个分类下还没有商品哦~','\x0a[图片生成失败:\x20','[V]','recordId','https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>','此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>','setDate','padStart','copy-post-btn','presets','nai-default-negative','https://i.postimg.cc/nryNzTXK/IMG-6915.gif','</name>\x0a\x20\x20<persona>','未选择书籍','toISOString','assign','点击处理','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','从\x20JSON.data\x20中提取图片数据','昨晚\x20','keypress','正在执行...','已成功批量导入\x20','coverUrl','\x20\x0a-\x20存活玩家:\x20','这是一条群聊语音消息，已禁止发起TTS请求。','sourceChatName','https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif','提示词配置','reading-window','<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>','#\x20场景设定\x0a','headers','✅\x20图片转换成功！🎨','\x0a-\x20**人设**:\x20','\x0a\x20\x20\x20\x20-\x20**书名**:\x20《','https://api.vkeys.cn/v2/music/tencent/lyric?id=','对方拒绝了你的视频通话请求。','.post-nickname','summaries','https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','删除\x20(0)','</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22','spinning','):\x20','add-new-product-btn','<div\x20class=\x22post-main-content\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>','change_user_nickname','shared-history-viewer-modal','status-bar-time','确定切换','请输入精炼后核心记忆的大致字数：','[表情:\x20',')\x20成功抢到了\x20','readAsText','https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','”图标','settings-preview-area','opacity','isSpectatorGroup','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>','检测到新版流式备份文件，开始导入...','https://i.postimg.cc/gkhf597g/IMG-6555.gif','\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','closed','#chat-list-bottom-nav\x20.nav-item','https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','statusText','getDate','NovelAI生成','请输入CPhone的背景图片URL','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>','playing','https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','preset-editor-screen','所有通话记录','rgba(0,\x200,\x200,\x200.4)','.delete-btn','chat-settings-modal','group_call_summary','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22','char-music-lyrics','最近\x2050\x20条','\x20条无效的','.cart-item-checkbox:checked','角色卡数据无效或缺少\x27name\x27字段。','showScreen','\x20的日记','safetyRatings','并评论说：“','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>','rp-direct-amount','lastUpdate','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>','相册\x20\x22','在执行组合操作时遇到错误:\x20','📋\x20直接粘贴歌词文本','邀请你视频通话','shuoshuo','恭喜你，你赢了！','message-bubble\x20','-\x20(ID:\x20','closest','确定要删除这条评论吗？','chat-search-results-list','导入失败','add-ai-avatar-upload-btn','\x20的动态\x20','char-main-date','files','select-all-products-checkbox','选择要精炼记忆的角色','lyric-line','</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>','renderQzoneScreenProxy','天亮了。','sender','cancel-ai-response-editor-btn','\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>','commenterDisplayName','更换歌曲背景','#delete-world-books-list\x20.clear-posts-item','.participant-avatar[data-participant-id=\x22','cancel-call-btn','\x20(这是你的帖子)','history','.chat-list-item[data-chat-id=\x22','outgoing-call-screen','douban-settings-modal','getFullYear',';\x22>','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“','💾\x20[专属弹窗]\x20保存角色NAI提示词','选择导出方式','###\x20玩家身份配置:\x0a','split','background','\x20觉得很赞</span></div>','sharedHistory','fill','\x22><div\x20class=\x22title\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','EPhone-Full-Backup-Legacy-','https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','-\x20\x20\x20**当前时间**:','anonymous','\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a','解析AI返回的JSON时出错:\x20','primaryKeys','add','\x22。\x0a','color','\x20条新消息','导演模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','正在模拟“','从CPhone推进真实对话失败:','(Timestamp:\x20','ZIP文件中未找到图片','image/png','source_name','text_image','imageProcessed','apiTemperature','狼人数量已达到胜利条件，狼人阵营获得了胜利！','chat-header-title','product-image-preview','\x20个自定义头像框吗？','我已了解风险，确认压缩','proxyUrl','waimai_response','world-book-screen','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','?key=','命名表情','https://i.postimg.cc/PJppkbvn/IMG-6918.gif','\x20位AI角色的长期记忆中！','#data-clear-type-list\x20.clear-posts-item','countdown-date-input','local','ai-voice-id-group','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','图片解压失败:\x20','”申请好友时发生错误：\x0a\x0a','frame_flower','isGroup','\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','在这里输入图片描述...','\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','通话记录','characterId','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','[语音]\x20内容:\x20\x22','chat-header-title-wrapper','time-perception-toggle','[图片]','(暂无评论)','accepted','\x20天\x20---','游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20','清理完成','.voice-transcript','blocked_by_ai','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“','cart-title','reading-library-search-input','global-bg-preview','nai-steps','https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','key','search-history-back-btn','bg-clear','member-avatar-preview',')\x20送出了一份礼物，收礼人是：','members','gameMode','play','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','button','moveTo','粘贴歌词','(无标题投票)','image/','readAsDataURL','pageY','检测到群聊\x20\x22','light','npc_','main','[约定达成]\x20','发生了一个错误:\x20','blur','.playlist-item-info','hours','API设置不完整，无法继续。','导出世界书时出错:','qzoneSettings','[系统提示：用户打开了五子棋棋盘，游戏开始了。]','syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','”的特点生成专属商品...','music-playlist-panel','\x22>...</div>','AbortError','#000000','.clear-posts-item','getVotes','close-char-music-player-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥','copy-message-btn','doubanActiveCharacterIds','visibilitychange','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','豆瓣设置已更新！下次重新生成时将生效。','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','music-return-btn','批量导入表情','投票结果','[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]','isAlive','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>','lyrics-vertical-pos','#sticker-binding-chat-list\x20.sticker-binding-checkbox:checked','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>','fontFamily','保存成功','waimai-request-modal','\x27\x20在你的动态(ID:\x20','请填写完整的约定标题和日期！','\x22\x20的独立行动失败:','reset-button-order-btn','.icon-setting-item','add-new-category-btn','人局，身份为\x20','聊天记录','world-book-category-pane\x20active','https://i.postimg.cc/PrcKH436/IMG-4376.gif','hang-up-btn','https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','”。请你回顾一下刚才和“','</span>','导入外观设置时出错:','\x0a##\x20','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','right','**\x20(本名:\x20','内心独白','gift-receipt-body','existing-sticker-categories-list','#gift-recipient-list\x20.contact-picker-item','switchToCharScreen','”才能使用\x20\x27open_red_packet\x27\x20指令领取。]','确定要恢复默认设置吗？','在导演模式保存时，遇到了未知的AI指令类型:','cphoneWallpaper','crossOrigin','unreadPostsCount','撤回了一条[','用户刚刚接听了你主动发起的视频通话。','flat','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','</span>:\x20','currentIndex','browser-title','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','.message-bubble.is-link-share','originalMeaning','网易云','\x20个新头像！','#data-clear-char-list\x20.clear-posts-item','open-memory-screen-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','memory-list-container','import-preset-btn','</p>\x0a\x20\x20\x20\x20','ai-persona-group','复制失败','panelEl','[图片]\x20','aiAvatarLibrary',',\x20内容:\x20\x22','\x22\x0a-\x20**用户的备注**:\x20\x22','calls','删除\x20(','groupMembers','custom-modal-confirm','.modal-header\x20span','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>','-\x20\x20\x20**公开发布NovelAI真实图片动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20[\x22图片1详细英文描述\x22,\x20\x22图片2详细英文描述\x22]}`\x20\x0a\x20\x20*\x20**prompt撰写**：你可以根据当前对话上下文、你的角色人设、以及你想表达的情感和氛围，来撰写详细而具体的prompt。详细程度由你根据具体情况自己决定，并不强制。\x0a\x20\x20*\x20例如：\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22','来自\x20','\x22\x20data-commenter-original-name=\x22','voter_name','announcement-board-modal','用户(','AI\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','scrollHeight','https://files.catbox.moe/','confirm-witch-poison-btn','无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','repostComment','删除分类后，该分类下的所有预设将变为“未分类”。确定吗？','scroll','狼人杀\x20-\x20','Cphone','lyrics-btn','add-my-avatar-url-btn','状态已更新','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','status','import_card','\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22','所有数据已成功恢复！应用即将刷新以应用所有更改。','\x20位角色生成豆瓣动态...','confirm-contact-picker-btn','antidoteUsed','https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif','rule-template-input','reply-preview-bar','confirm-prophet-check-btn','\x0a\x0a#\x20当前情景\x0a','sticker-category-tab','，点击查看</div></div>','confirmText','\x20\x20\x20正面:','group-avatar-group','请选择一个接收人！','最近\x20100\x20条','char-browser-article-screen','participant-avatar-wrapper','quality_toggle','input:checked','已死亡的用户(','\x27,\x20\x27bulangni\x27,\x20sans-serif','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','music-player-overlay','你们正在一起读书。','\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x20\x20\x20负面:','get','album','borderBottom','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>','linkedMemoryCount','save-preset-btn','ai_image','char-music-artist','save-character-nai-prompts-btn','AI返回的内容中未找到有效的JSON对象。','setTimeout','加载更早的会话','\x0a##\x20---\x20关于“','切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？','home-screen-pages-container','https://i.postimg.cc/fyyGgW61/IMG-7115.gif','关于“','你们的对话刚刚还在继续。','location','AI\x20角色\x20\x22','后台活动:\x20角色\x20\x22','”\x20将对你的称呼修改为\x20“','toDataURL','chats','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','》设定\x20(你可以将其中角色作为聊天对象):\x0a','<div\x20class=\x22spinner\x22></div>','user-speak-btn','quantity','[私聊]','flex','.delete-block-btn','delete-btn','你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','https://api.minimax.chat/v1/text_to_speech?GroupId=','\x22\x20data-commenter-display-name=\x22','tts_','red_packet','poll-options-container','此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。','call-timer','”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','uncategorized','请输入\x20歌名\x20或\x20歌名-歌手','https://i.postimg.cc/yx2m4nbs/IMG-7231.gif','上传成功！','检测到并成功修复了\x20','无法从\x20SSE\x20响应中提取图片数据','profile-random-jottings','.unread-indicator','cancel-product-editor-btn','https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','delete','确认替换','notification-content','部分导入失败','文件格式不正确，这不是一个有效的单聊备份文件。','♪\x20♪\x20♪','高德地图','\x0a**---\x20第\x20','status_text','视频通话刚刚结束','style','sticker-search-input','错误：找不到该成员的个人档案。','太好了！我们又可以聊天啦！','找不到这本书！','character-selection-screen','char_memo','结束发言','#custom-modal\x20.custom-modal-footer','member-management-screen','错误：找不到要转发的原始动态。','probability','cleanup-songs-btn','https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','char-photo-item',')\x20作者:\x20','用户已忽略版本:\x20','single-char-background-activity-group','summarize-recent-btn-header','zIndex','\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a','未知表情','”的出行足迹...','张图片','generativelanguage','bulkDelete','组件图片已更新！','last','modify','https://i.postimg.cc/xTk5xN49/IMG-7233.gif','下在(','variation-selected-price','.avatar','https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','角色\x20\x22','我的消息预览','####\x20','80px','transparent','json','main-chat-list-header','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','reset-nai-settings-btn','<strong>$1</strong>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>','-\x20**当前时间**:\x20','游戏即将开始，正在为各位玩家分配身份...','\x20\x20-\x20在群聊“','https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','请输入一个有效的图片URL！','qzone_delete_post','werewolf-retry-btn','创建群聊','\x0a\x0aAI原始返回内容:\x0a','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','https://i.postimg.cc/zvWGPjms/IMG-7090.gif','.png','”\x20的预设已存在。要覆盖它吗？','default_negative','https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','#e4b591','char-article-content','送给大家的礼物','确认抹除','sticker-action-bar','quote_reply','\x0a-\x20**身份**:\x20','\x20(最后互动于\x20','novelai-settings-btn','showWaimaiDetails:\x20找不到消息或消息类型不正确','myPersona','p[data-index=\x22','API设置','</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20','countdown','图片内容','”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20','is-acting','/v1/chat/completions','https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','char-music-item','确定要删除NPC\x20“','/v1/models','\x27刚刚在你的动态“','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20','https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','https://i.postimg.cc/fRV86FMq/IMG-4381.gif','<p><strong>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','手慢了','tableName','当前为渐变色','https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','”)下发送了一个表情评论，意思是：“','orderBy','boxSizing','save-rule-btn','一点心意','ai-action-cooldown-input','，我们一起见证了这个约定。','\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“','cphone-icon-img-','https://','#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a','-\x20**昵称:\x20','此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>','my-group-nickname-input','add-group-chat-btn','member','anno_','请至少选择一位收礼人。','#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：[','product-grid','-\x20\x20\x20**NovelAI真实图片分享\x20(在聊天中直接发送)**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20-\x20**【绝不能暴露是novelai生成的图片！】\x0a\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20-\x20使用场景：当你想要在【私聊对话中】直接给用户发送一张图片时使用。\x0a\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。\x0a\x20\x20\x20\x20-\x20注意：这会直接在聊天记录中显示图片，而不是发布到动态。','-\x20(空)','is-raw-html','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>','AI\x20(独立行动)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','完成(','https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','文章标题','</div><div\x20class=\x22description\x22>','global_css','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','streamSaver','regenerate-douban-btn','https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','还没有可供编辑的AI响应。请先让AI回复一次。','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“','char-music-player-modal','frame_7','rules-content-container','chat-list-render-window-input','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>','(无)','删除失败','douban-settings-btn','AI\x20(CPhone)\x20尝试使用一个不存在的表情:\x20\x22','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','此操作会将选定的\x20','char-browser-item','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting','my-avatar-library-title','found','https://i.postimg.cc/cLPP10Vm/4.jpg','preset-screen','12p','请输入标题','此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','\x20分钟)，本次独立行动跳过。','ai-avatar-upload-input','call-transcript-modal','正在准备...','-\x20你昨晚守护了\x20','字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a','导入外观设置','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“','close-shared-history-viewer-btn','https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','messages','share-location-btn','.frame-item:has(.delete-btn)','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','onload','无法找到对应的分享记录或记录已损坏。','API\x20请求失败，状态码:\x20','frame_14','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-10条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a2.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a3.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性，尽量让你的表情丰富多样，避免重复。。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20你的角色设定\x0a你必须严格遵守','toggle','chat-list-bottom-nav','switch-to-image-mode','[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','accept_transfer','\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“','incoming-call-modal','\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>','message-wrapper\x20','promptSource','change-frame-btn','size','group-action-cooldown-input','guardedId','count','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','participant-display-avatar','\x20领取</div>','post-hidden-text','touchstart','生成模拟歌单失败:','请先从下拉框中选择一个要删除的预设。','data-clear-step-1','Autoplay\x20was\x20prevented\x20by\x20the\x20browser.','char-usage-item','https://generativelanguage.googleapis.com/v1beta/models/','书库是空的，点击“导入新书”添加第一本吧！','无效链接:\x20','\x0a#\x20可用表情包\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','462885dbzyvl','reading-library-list','\x20行的格式不正确，已被系统跳过。','\x20条消息吗？这会通知AI这些消息已被删除。','create-new-member-btn','character-select-item','AI返回了空内容或未知格式。','正在接通...','world-book-editor-title','未检测到BOM，尝试使用\x20UTF-8\x20解码...','openPresetScreen','paidBy','var(--text-primary)','my-nickname-group','-\x20(记录于\x20','[发送了一张图片，描述为：\x27','棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a','contentLines','change','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','matches','.lyrics-btn','label','\x0a\x0a现在，请做出你的决定。','lastGuardedId','第一夜，执行本地随机刀人逻辑...','splice','cancelText','prepend','toCollection','endsWith','charging','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','change_user_avatar','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>','导入已取消，因为未提供名称。','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20表情使用指南\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>','找不到相册:','werewolf-game-over-title','在这里输入语音内容','请用文字描述您要发送的照片：','increase-qty-btn','[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','.call-record-card','hiddenText','placeholder.png','remove-global-bg-btn','全部记忆\x20(','preset-actions-modal','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（','[系统提示：用户手动结束了投票！最终结果为：','werewolf-log','date','.char-screen','\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20','确定要删除这条公告吗？此操作不可恢复。','\x20的红包已被领完','群聊已建立...','en-US','<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>','drawImage','#music-lyrics-container','.char-product-item','visibleTo','-\x20\x20\x20**对话状态**:\x20','https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','请输入一个\x202\x20到\x20','callRequester','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>','qzone-banner-img','repost-modal','请为这本设定集命名：','#\x20可用群头像列表\x0a','非图片格式，跳过压缩:','werewolf-player-grid','https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','length','transfer-btn','...”','show-announcement-board-btn','按钮顺序已恢复为默认设置！','object','请至少选择一个要删除的世界书。','translateX(-','手动注入记忆时出错:\x20','.sticker-binding-checkbox','诊断：未在此角色卡中找到任何有效的世界书数据。','identifier','postId','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','music-mode-btn','prophet','reset-character-nai-prompts-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','”思考后决定暂时不发送好友申请，将重置冷静期。','转账:\x20','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','video_call_request','status-bar-battery','\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#fullscreen-lyrics-container\x20.music-lyrics-list','noneOf','渲染规则\x20[',',\x20记录数:\x20','recipients','create-countdown-modal','search-results-list','AI已将新群头像命名为：“','amap','char-audio-player','single-lyric-display','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','shared-history-viewer-content','cancel-shopping-settings-btn','rp-tab-direct','async','已被用户删除','请稍候','mouse','你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！','qzone-sticker-grid','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','导入备份将完全覆盖您当前的所有数据。此操作不可撤销！确定要继续吗？','groupNickname','-\x20(头像库是空的，无法更换头像)','请根据以上设定开始你的决策。','https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','werewolf-witch-selection-list','<span\x20style=\x22color:\x20red;\x22>未运行</span>','进入投票','确定要永久删除这条动态吗？','\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。','”。请自然地接受这个新名字，不要对此感到惊讶。]','检查完成','将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。','无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20','1299159CnDFxu','\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','\x0a#\x20可用表情包\x20(优先使用)\x0a-\x20请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a','\x20\x20\x20promptSource:','font-url-input','then','order','操作失败:\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>','address','select-all-world-books-for-clear','my-frame-tab','startTime','https://i.postimg.cc/W40f9qtd/IMG-7098.gif','innerText','date-search-input','songJson','add-group-avatar-url-btn','添加网络歌曲','records','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','Response\x20status:','\x0a\x0a#\x20待整合的记忆要点列表\x0a','API请求失败:\x20','lineTo','\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a','center','confirm-variation-selection-btn','正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。','font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;','.message-bubble[data-timestamp=\x22','[系统提示：','”分享TA的私人歌单...','thoughts-history-list','》吗？','lyric','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','发送语音','clear-posts-item','#npc-association-list\x20input:checked','2-digit','正在批量添加\x20','scope','\x20的所有动态，且无法恢复！','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','add-ai-response-block-btn','rp-content-direct','block_user','browser','.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid','所有解析方案均失败！将返回原始文本。','确定要删除这条渲染规则吗？','className','avatarFrame','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg','cover','来自动态','”，金额是\x20','isMinimized','请输入相册名称','语音生成失败','未知作者','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','music-current-time','message-editor-block','cancel-frame-settings-btn','天\x20-\x20夜晚','https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','char-music-current-time','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','douban-detail-back-btn','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','keydown','删除分类及表情时出错:','alternateGreetings','visibility','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>','char-qq-conversation-screen','维基百科','最近支出','.icon-preview','ai-frame-content','用户描述的照片','UTF-8\x20解码成功。','inline-block','执行出错','char-simulated-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>计算图片大小时出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>Error</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','opened','成员们正在输入...','custom_proxy_url','char-wallet-content','https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','input[name=\x22theme-select\x22]:checked','save-wallpaper-btn','save-chat-settings-btn','height','#\x20长期记忆\x20(必须严格遵守)\x0a','}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','offline-mode-toggle','文章摘要...','游戏结束，开始自动总结并注入记忆...','manual','”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','api-settings-screen','reverse','cancel-persona-editor-btn','callRecords','total','https://i.postimg.cc/fRTF24jS/IMG-4430.gif','world-book-editor-screen','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','-\x20你昨晚用毒药毒了\x20','temp_group_chat','setItem','theme','\x20[社交背景:\x20','isNpc','退款来自\x20','外观预设已保存！','all','close-character-nai-prompts','novelai-model','请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。','linkedWorldBookId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请输入提示词！','\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”中，用户的昵称是“','match','persona-library-modal','border','getMonth','character-nai-prompts-btn','请输入头像的图片URL','post-public-text','location_share','清空动态时出错:','AI返回的数据不是一个数组。原始返回:\x20','globalCss','lastActionType','https://i.postimg.cc/90RBDh9K/IMG-6377.gif','\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','[系统提示：你\x20','编辑通话消息','个月前','offlineMinLength','</span></div><div\x20class=\x22gift-items-preview\x22>','chat-interface-screen','[收到一个外卖代付请求]','\x20的聊天','https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif','uc_preset','https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a','\x20→\x20','https://i.postimg.cc/28TsrxRV/IMG-6852.gif','https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','waimai-order-for-ai-btn','apply','传统导出数据时出错:','qzone-avatar-input','max','add-world-book-btn','naiimag','\x22\x20被唤醒，准备独立行动...','AI的五子棋移动指令包含无效坐标，已忽略:','.poll-option-item','\x0a-\x20**世界观**:\x20','import-single-chat-input','image_prompt','<em>','view','mousedown','https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','diary','rp-content-group','playMode','getElementById','礼物已成功送出！','countdown-card','swiped','worldBooks','world-book-group-container','批量导入头像框','audio/mpeg','渲染器','level','char-wallet-back-btn','-selection-list','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>','在此修改内容...','#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a','已成功收藏到“我的收藏”页面！','#e9ecef','确认清空','”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“','?nologo=true&width=1024&height=1024','**[讨论环节]**\x0a','一条动态','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>','is-gift','API格式不正确，角色\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【身份铁律】】】**:\x20用户的身份是【','</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','edit-call-message-btn','chat_message','\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a','\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。','secondary-model-select','avatar_name','<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>','小时前聊过。','所有音乐源都未能找到歌曲：“','[系统提示：你刚刚主动拉黑了用户。]','flexDirection','lyricsPosition','productId','\x20个表情包，且无法恢复！','\x0a}\x0a}','图片\x20Blob\x20创建成功，大小:','gameover','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','对方本名不能为空！','\x22\x20触发行动决策...','npcs','normal','https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','total-image-size-display','请输入新的图片URL','对方已拒收','https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','unread-indicator','originalType','AI生成的图片','流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。','char-album-screen','char-diary-detail-content','time-zone-select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','正在呼叫...','songs','https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','manage-frames-btn','\x20为你切歌:\x20《','offsetTop','”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20你的角色设定\x0a','】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22','\x22\x20处于行动冷却中，本次独立行动跳过。','replyTo','douban-my-comment-avatar','font','active','speaking','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','qzone_post','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','✅\x20清理完成！\x0a\x0a','shopping-category-count-input','npc-list-back-btn','\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。','minimaxVoiceId','hasShown10','https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','已成功从文件导入预设《','toFixed','\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','comment','novelai-generated-','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','这个分类下还没有表情哦~','导入世界书','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','正在扫描和修复数据...','round','本地头像上传及识别失败:','删除日记','photoCount','**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务铁律\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【至关重要】**:\x20当你发现“最近的动态列表”中，有你【感兴趣且还未互动过】的动态时，你**应该优先考虑**使用\x20\x27qzone_comment\x27\x20或\x20\x27qzone_like\x27\x20指令去进行互动，这比你自己发一条新动态更符合社交礼仪。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27[{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]\x27\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22)\x20作为角色名。消息内容:','AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','文件格式不正确，这不是一个有效的世界书备份文件。','一条[转账]消息已被撤回。','post-image-preview-container','rules-tabs','categories','<span\x20class=\x22diary-handwritten\x22>$1</span>','.json','静音音频已停止。','\x22\x20中有未领完的红包，正在生成抢红包指令...','offline_text','#data-clear-char-list\x20.clear-posts-item.selected','</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥','werewolf-action-bar','还没有人','current','reading-overlay','\x22\x20class=\x22avatar\x22>','。你可以使用\x20\x27vote\x27\x20指令参与投票。]','\x20.message-bubble.user\x20$1','.name','请根据以上设定，立即做出你的决定。','duration','\x22\x20data-description=\x22','frame_ribbon','https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','savedId','isGameOver','-\x20公告内容:\x20\x22','lastActionTimestamp','\x20其中包括以下投票：','https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','position','-\x20**','[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','https://i.postimg.cc/76Tj3g1B/IMG-4425.gif','置顶公告','”发送的、尚未领完的红包（时间戳:\x20','<input\x20type=\x22checkbox\x22\x20value=\x22book_','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','werewolf-game-btn','imageUrls','preset-avatar-preview','.red-packet-card','import-appearance-input','\x22\x20的记忆中清除了1条关于已删除评论的通知。','#gift-recipient-list\x20.contact-picker-item.selected','skipped','preset-content-container','\x0a-\x20**可以刀的玩家列表**:\x20','智能导出\x20(推荐，速度快，内存占用小)','douban-max-posts-input','transaction','📁\x20从本地上传','lrc','x-social-screen','rejected','编辑对方状态','heartfelt_voice','创建新聊天\x20(第1/2步)','open-shopping-btn','close-receipt-btn','【用户\x20(User)】','sticker-panel','speech-01','<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif',',\x20价格:\x20¥','chatId','100%','https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','renderWallpaperScreenProxy','reading-content','toBlob','charId','link-source-input','📤\x20发送请求到\x20NovelAI\x20API','导入书籍失败:','publicText','\x20的手机','post-image-description','clientHeight','qzoneGroups','检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。','选择精炼范围','\x20(本名:\x20','\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a','生成模拟备忘录失败:','照片详情','<br>','[系统提示：你于时间戳\x20','<div\x20class=\x22custom-title\x22>','character_persona','minimaxApiKey','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22post-content\x22>','诊断：在\x20extensions.character_book\x20中找到世界书。','https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','</persona>\x0a</character>\x0a','backgroundColor','<span\x20class=\x22group-name\x22>','\x20删除了自己的一条动态]','quality','\x22\x20(由\x20','\x0a\x0a#\x20','<div\x20class=\x22rp-claimed-info\x22>已被\x20','未知设定的角色','NEGATIVE_INFINITY','精炼失败',')\x20拒绝了\x20','positive','导演/编辑模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','无法自动播放静音音频（这在iOS首次加载时是正常现象）:','\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27','listen-together-btn','https://i.postimg.cc/htZppbS4/IMG-7107.gif','正在为您选择的\x20','来自“','\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22','favid','主API和副API均未配置或配置不完整。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','injectLatestThought','对方已收款','rp-direct-receiver','号玩家:\x20','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','music-exit-btn','secondaryProxyUrl','werewolf-game-over-reason','https://i.postimg.cc/50k390X8/IMG-6376.gif','choice','create-shuoshuo-btn','decrease-qty-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>','结算(',']\x20[最近对话:\x20','management-mode','确认覆盖','在这里输入回复内容','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。','product-category-manager-modal','#settings-preview-area','event_type','容错解析：策略3成功\x20(将整个返回文本作为摘要)','字体已保存并应用！','#data-clear-type-list\x20.clear-posts-item.selected','</div>\x0a\x20\x20\x20\x20','动态发布成功！','cfg_scale','reject','确认清空动态？','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','books','api-preset-select','确定要删除这个人设预设吗？此操作不可恢复。','》\x20-\x20','\x0a\x0a#\x20待总结的视频通话记录\x0a','fillRect','lucky','5px','isFullyClaimed','transform','正在根据“','✅\x20NAI图片生成成功！','isHidden','chat-list-action-cancel','upload-cphone-bg-url-btn','apiPresets','anyOf','选中的表情已成功删除。','群聊中没有成员有足够（2条以上）的记忆可供精炼。','px)','\x0a-\x20','text/event-stream','https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url(','appUsageLog','getHours','<div\x20class=\x22post-comments-container\x22>','my-avatar-group','已经一起听了','.thought-delete-btn','stream','\x22\x20class=\x22realimag-image\x22\x20alt=\x22图片','pollTimestamp','等待对方处理...','contact-picker-list','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','is_busy','https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','simulatedMusicPlaylist','world-book-category-select','decline','\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是','修改图片','\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','send-poll-btn','prophetCheck','preset_','删除头像','<span\x20style=\x22color:\x20red;\x22>已关闭</span>','成功导入\x20','\x20的动态\x20(NPC)','未知错误','dark','findIndex','AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。','\x20领取了\x20','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','renderChatListProxy','result','\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a','frame_13','\x20个商品吗？此操作不可恢复。','EPhone-Full-Backup-','请输入预设名称','delete-font-preset-btn','src','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','apiKey','\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a','qzone-more-actions-btn','LOW','NPC行动失败：API未配置。','确定要永久删除选中的\x20','nai-cfg-scale','add-char-diary-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>','\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','open-sticker-panel-btn','<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是','查验结果','https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','renderXSocialScreenProxy','请修改记忆要点：','werewolf-game-over-close-btn','Bilibili','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.pagination-dot','\x20元</div>','\x20票</span></div></div>','未知会话','gridEl','qzonePhotos','call-message-actions-modal','edit-message-btn','dialogue','clear-cart-btn','cancel-music-search-btn','名为\x20“','\x20\x20\x20characterNegativePrompt:','#reading-window\x20.reading-header','confirm-vote-btn','(无购买理由)','https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','url(','》吗？此操作不可撤销。','AI返回的change_music指令中，歌曲名无效或缺失:','.char-photo-item','accept-call-btn','\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a','[发送了一张图片，描述为：','从完整链接批量导入','has','\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20','offline-max-length-input','note','select-all-music-search','rule-regex-input','number','chat-render-window-input','revokeObjectURL','https://i.postimg.cc/DZshzKv6/IMG-5576.gif','通话消息已更新！','\x22\x20data-memory-timestamp=\x22','\x20首歌曲...','block-chat-btn','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','music-player-artist','https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','source','\x0a\x0a现在，请开始生成这组备忘录。','导入世界书时出错:','导入已取消，因为未提供书名。','通话名称已更新！','添加头像','add-song-url-btn','https://files.catbox.moe/r5heyt.gif','”。请你对此作出回应。]','\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a','**。','models','rp-group-total','werewolf-role-modal','theme-toggle-switch','data-clear-char-list','qzone-banner-container','rules-category-pane','cancel-red-packet-btn','transfer-confirm-btn','”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','.quoted-message','已撤回的消息','QQ音乐','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>','保存主题预设','网络图片\x20(EPhone)','world-book-tab','<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','选择一个开场白','\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22','transfer-amount','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.music-player-window','my-frame-content','.unread-count','manage-group-avatar-library-btn','shopping-product-count-input','char-qq-screen','photos','proxy-url','cancel-create-poll-btn','offsetX','”说的申请理由：','\x0a#\x20你的聊天对象（用户）的人设\x0a','.header','role','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>','authorName','.share-target-checkbox:checked','music-player-avatar-display','.recalled-message-placeholder','novelai-api-key','characterNegativePrompt','创建群聊至少需要选择2个联系人。','\x20条)','enableBackgroundActivity','cancel-member-settings-btn','无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20','请所有AI角色开始投票。','long','.upload-variation-image-btn','NPC人设','\x20元。','isClick','\x22\x20吗？','var(--accent-color)',')\x20时出错:','shoppingProducts','我是谁呀。','狼人杀AI讨论生成失败:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22','总结成功','\x20(图片描述:\x20“',')\x20刚刚投票给了\x20“','角色\x20“','【原动态内容:\x20','regenerate-char-diary-btn','novelai-test-btn','https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','persona-editor-title','https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','保存字体预设','\x22\x20placeholder=\x22','chat-at-mention-popup','entries','\x0a-\x20**','shopping-settings-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','char-browser-screen','\x20条内容吗？','werewolf-user-input','”的身份，开始你的客观总结。','qzone_like','photo-viewer-modal','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','\x20/\x20','最终正面提示词:','propel-btn','请你投票。','请输入EPhone主屏幕的背景图片URL','renderApiSettingsProxy','font-size-value','请输入有效的总金额！','转账给\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>','relative','frame_5','.music-search-checkbox:checked','voiceId','\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','渲染规则','删除规则','index','poll','add-new-group-btn','smooth','startY','\x20首歌曲，这可能需要一些时间...','未使用','change_remark_name','https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','isPlaying','preview-bubble-style','getTime','狼人请睁眼，请选择要刀的玩家。','send-direct-packet-btn','char-memo-detail-content','创建新相册','[系统消息]\x20','transcript-modal-title','keyword-search-input','自定义数量...','dataset','promptFeedback','https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','✅\x20检查完成，未发现任何冗余数据。','https://i.postimg.cc/wjH180kn/IMG-5566.gif','sendQzoneStickerComment:\x20找不到帖子:','歌曲查找失败:\x20AI请求的歌曲名\x22','href','#music-lyrics-container\x20#music-lyrics-list','simulatedAmapHistory','global','”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','.text','导演模式保存(Sticker):\x20使用了\x20meaning\x20查找','music-playlist-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','devicePixelRatio','浏览器','[一张图片，其隐藏文字为：\x22','column','warn','<option\x20value=\x22\x22>未分组</option>','draggable-button-item','product-variations-container','preset-entries-container','加载预设详情时发生错误:\x20','头像和人设不能都为空哦！','red-packet-modal','用户\x27','修复了角色\x20\x22','NPC\x20\x22','speaker','char-simulated-send-btn','.chat-group-header:not([data-has-listener=\x22true\x22])','AI\x20尝试赠送一个格式不正确的随机礼物:','AI\x20(','<span\x20class=\x22diary-emphasis\x22>$1</span>','导入\x20Tavern\x20AI\x20世界书','\x0a#\x20可用表情包\x20(优先使用)\x0a每个AI角色都被设置了专属表情包，在需要发送表情时，他们应该【优先】从自己的专属列表中选择。尽量让你的表情丰富多样，避免重复。\x0a','无法为不存在的分类打开绑定模态框:','ᗜωᗜ','https://i.postimg.cc/d0WCKxff/IMG-6932.gif','请输入一个有效的、未来的日期！','Gemini\x20API返回了非预期的格式:','memos','\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20','在导演模式中发现一个无效的JSON片段:','horizontal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20可用表情包\x0a\x20\x20\x20\x20\x20\x20\x20\x20','清空聊天记录','无结果','preset-category-select','video-call-main','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','participant-avatars-grid','defineProperty','char-product-item','请根据你的设定，生成你的高德地图足迹。','open-reading-library-btn','\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',')，祝福语是：“','50%','AI\x20(群聊后台)\x20尝试使用一个不存在的表情:\x20\x22','upload-sticker-btn','status-','”的投票(时间戳:\x20','#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a','close-novelai-settings','https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','\x20(时长:\x20','load-more-thoughts-btn','\x20你们之间已经有**','.qzone-post-container','cancel-npc-editor-btn','isOpen','save-persona-preset-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-','close-group-avatar-library-btn','冗余数据清理流程已启动...','persona-preset-item','昨晚是平安夜。','</span></div><div\x20class=\x22rp-type\x22>','borderColor','toggle-blur-btn','a\x20random\x20product','album-upload-photo-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','char-music-mode-btn','删除书籍','没有可供重新生成的AI响应。','确定要清空当前角色的NAI提示词配置吗？','commenterOriginalName','head','scrollTop','delete-appearance-preset-btn','https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','fontSize','receiverName','https://api.vkeys.cn/v2/music/netease?id=','</memory>\x0a\x20\x20<recent_dialogue_with_user>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>','refined','equals','正在执行清理操作，请不要关闭页面...','”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a4.请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥','<div\x20class=\x22avatar-group\x20','poll_timestamp','请你对此作出回应。]','personality','link-memory-toggle','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','padding','isDragging','你赢了','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>','div','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','writeText','fullscreen','🎬\x20推进剧情','board','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（','tagName','\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>','album-screen','gomoku_move',')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','###\x20最终结果:\x20','add-ai-avatar-url-btn','post-local-image-input','claimedBy','\x0a#\x20用户的角色\x0a-\x20**','.cart-item-checkbox[data-id=\x22','\x0a\x0a#\x20游戏规则\x0a-\x20','---\x20狼人杀对局完整复盘\x20---\x0a\x0a','</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥','流程启动','productInfo','player','确定要删除相册《','manage-products-btn','music-lyrics-list','在此修改，或点击上方按钮使用格式模板...','User\x20Avatar','photo-item','werewolf-game-over-modal','狼人行动API失败:','https://i.postimg.cc/wMxmCZVC/IMG-7099.gif','”回忆TA的相册照片...','world-book-tab\x20active','错误：尝试打开一个不存在的预设，ID:','cancel-contact-picker-btn','AI生图功能已','\x22><div\x20class=\x22member-name\x22>','.frame-item.selected','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','typing-status','werewolf-player-avatar','正在请求AI为新群头像命名...','groupId','time-zone-group','https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','remove-member-btn','删除世界书失败:','candidates','qzone-post-item','找不到这个预设的详细信息。','meaning','在写入文件流时发生错误:\x20','day','\x20分享了Ta的位置：\x27','.search-result-item','</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','未知App','”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','isOfflineMode','favorite-article-btn','”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','openCharWallet','rp-tab-group','请稍候...','gomoku-overlay','preset-editor-title','AI女巫决策：今天是第','parentNode','row','https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','global-custom-style','模拟器心跳\x20Tick...','++id,\x20type,\x20timestamp,\x20originalTimestamp','getWriter','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','equalsIgnoreCase','api-temperature-slider','onended','分类名不能为空！','成功移除了\x20','.comment-item','cancelable','api-temperature-value','.toggle-content-btn','pending_user_approval','test','件商品','gift-recipient-list','link','(未设置)','\x0a\x0a##\x20世界书:\x20','创建旁观群聊\x20(我围观)','导出单个聊天时出错:','\x0a##\x20---\x20来自','模型列表已更新','导出数据时出错:','\x20天\x20---**\x0a','<span>','世界书','char-usage-list','custom','reason','</span><span\x20class=\x22poll-option-votes\x22>','”\x20的详细角色信息。','download','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>','repost','IMG','children','正在请求“','<div\x20class=\x22source\x22>','groupName','请输入你想对“','确认拉黑','post-image-desc-group','translateX(calc(-','memory-screen-back-btn','\x20向对方发起了转账:\x20','question','temp_npc_chat','Minimax\x20TTS\x20API\x20调用失败:','toDateString','auto-memory-interval','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>','\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>','isAwaitingResponse','AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。','werewolf-game-screen','form-button','📸\x20动态NovelAI图片生成开始，共','.post-mode-switcher',']。当在对话历史中看到这些名字时，它们都指的是【你】自己。','”写一篇新日记...','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>','1024x1024','导演模式保存(Sticker):\x20使用了编辑器提供的完整JSON\x20(url\x20+\x20meaning)','compress-images-btn','global-css-input','新建备忘录','获取AI狼人目标失败:','预言家请睁眼，请选择要查验的玩家。','assign-group-section','确定要删除这个约定吗？','生成模拟聊天失败:','\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20','[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20','wb_','(无标题)','https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x20位群成员生成并注入了个性化记忆！','.entry-keys-input','serviceWorker','https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','生成图像','create-poll-modal',')的阅读进度失败:','\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20','getTimezoneOffset','pat-btn','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','）刚刚拍了拍你（','https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','compressed','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','-\x20**长期记忆\x20(必须参考)**:\x20','（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a','点击了商品卡片:\x20','isArray','updateListenTogetherIconProxy','API错误:\x20','chatListRenderWindow','ai-response-editor-container','<span>已</span><span>超</span><span>时</span>','未知发送者','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','member-avatar-input','确定要删除这张照片吗？此操作不可恢复。','originalTimestamp','profile-heartfelt-voice','99+','data:','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>','📋\x20请求体:','ephone-theme','enable-ai-drawing-switch','”的转账。]','font-preset-select','https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','group-avatar-library-modal','export-single-chat-btn','找不到主角\x20“','.format-btn','image','\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a','group-avatar-library-grid','等待回复失败:','错误：找不到要删除的分类。','spectator-propel-btn','send-photo-btn','focus','rule-name-input','join-call-btn','.avatar-group','<span\x20class=\x22offline-description\x22>','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥','npc-persona-input','.sticker-item','编辑规则','照片已删除。','[♪\x20','请根据你的设定，生成你的歌单。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20data-option=\x22','-\x20**对话状态**:\x20上次互动于\x20','删除歌曲','无备注','https://i.postimg.cc/B6KD52vz/IMG-7096.gif','✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)','来源网站','一位成员','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','home-screen','**[夜晚]**\x20平安夜。\x0a','declined','put','清空所有动态\x20(危险)','添加商品','clientX','.album-art-btn','import-data-input','[文字图]\x20','notification-sound-player','当前时间是\x20','longTermMemory','正在呼叫所有成员...','在这里输入文本...','https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','simulatedBrowserHistory','请根据你的设定，生成你的备忘录内容。','\x20的红包，金额为\x20','自动总结狼人杀游戏失败:','char-diary-list','</span>\x20:\x20<span>','#preset-tabs\x20.world-book-tab','.edit-memory-btn','https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','生成新日记失败:','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>','<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','本日核心议题','没有可导出的世界书数据。','.draggable-button-item:not(.dragging)','\x0a\x20\x20\x20\x20','\x22\x20更换了头像','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>','toArray','</div><br>是否用这条新记忆替换掉这些旧记忆？','netease','generate','”。只有“','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>','一个神秘的角色。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“','\x20发送了一张图片，图片内容描述为：\x27','++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','option','trim','请添加歌曲','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x20-\x20','导演模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','authorId','img','\x0a#\x20待总结的对话历史\x0a','手动注入狼人杀记忆失败:','操作成功','守卫已行动，守卫请闭眼。','这是模拟对话，无法发送消息哦~','[转账]','image-mode-content','myNickname','decision','blockReason','[ERROR:\x20','vertical','https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','delete-world-books-modal','caller-avatar','message-editor-block\x20variation-block','文件解析或应用失败:\x20','accept','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','并评论说：\x22','https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','</div>','.contact-picker-item[data-contact-id=\x22','timerId','检测到\x20EPhone\x20备份文件，执行标准导入...','delete-world-books-btn','some','[语音]','switchToCharHomeScreen','Caching\x20rendering\x20rules\x20for\x20chat:\x20','buttonId','.chat-group-content:last-of-type','.progress-bar','select-all-recipients','currentTarget','这是你们最近的对话：\x0a','repost-comment-input','守卫请睁眼，请选择要守护的玩家。','\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a2.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【','”。请你回顾一下你和“','rp-direct-total','https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','</span><span>','ai-response-editor-block','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','chat-input','<strong>','npc-editor-modal','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','设置已应用','bottom','元,\x20备注:\x20','https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif','\x0a###\x20条目:\x20','photo-viewer-next-btn','#ccc','pat_message','”生成这组【与角色高度相关】的商品数据。','确定要将“','qzone-banner-input','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥','GRID_SIZE','paused','translateX(','送出礼物','外观设置已保存并应用！','change-icon-btn','[语音消息:\x20','.entry-enabled-switch','\x22\x20发布了动态','transfer-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a-\x20**帖子内容摘要**:\x20','true','...\x0a-\x20**已有评论**:\x0a','</div></div>','group-avatar-library-title','已取消收藏','\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','char-memo-detail-screen','(空)','.world-book-category-pane','getContext','touchend','frame_11','群成员','在这里输入语音内容...','在同时执行两个函数时出错:','选择歌词导入方式','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','相册已成功删除。','werewolf-kill-selection-list','lastFailedAction','》吗？此操作将同时删除相册内的所有照片，且无法恢复。','https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','post-image-preview','is-link-share','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif','onplay','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','currentPlaylist','cors_proxy','已成功将\x20','data:image','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','\x20分钟，开始模拟后台活动...','image_url','loader-container','https://i.postimg.cc/13hhJ77p/IMG-4419.gif','设置精炼字数','categoryId','📁\x20从本地文件\x20(.lrc)','<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','”的对话摘要**:\x0a','offlineMaxLength','\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ai-avatar-library-grid','post_deleted_notice','char-usage-screen','✅\x20NAI图片','removeEventListener','\x20同步所有群聊内的头像...','char-amap-item','shift','\x22\x20记录了一条新回忆:','API\x20预设已保存！','\x22\x20已经存在了，换个名字吧！','帖子详情','[一张图片，其隐藏文字为：“','AI决策','\x22\x20(ID:\x20','editable-image','call-message-bubble\x20ai-speech','createdAt',',\x0a\x22data\x22:\x20{\x0a','.qzone-post-item','https://i.postimg.cc/k401K5g7/IMG-7304.jpg','days','cancel-reply-btn','内容加载失败...','正在分析“','请输入有效的正整数！','群聊人数不能少于2人。','[一张图片，描述为：“','close-novelai-test','。请收礼的角色表示感谢，其他角色可以自由发挥。]','world-book-checkboxes-container','.waimai-user-actions\x20button','items','btn-danger','waimai_request','\x20元。]','globalChatBackground','ai-avatar-library-modal','\x0a-\x20**长期记忆**:\x20','---\x20第\x20','确定要删除这条长期记忆吗？','」听歌。要结束并开始和「','char-product-grid','\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a-请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20','seed','application/json','你们没有在读书。','</textarea>','https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','my-avatar-input','data:\x20','--music-bg-image','findLastIndex','translateY(','includes','delete-transcript-btn','正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...','go-to-clear-step2-btn','”请求添加你为好友：<br><i>“','容错解析：策略1成功\x20(找到并解析了完整的JSON对象)','https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','(回复\x20','#avatar-frame-modal\x20.modal-body','当前通知版本\x20(','\x0a#\x20群成员列表\x20(你的总结目标)\x0a','dblclick','删除成功','change_group_name','#chat-messages','senderName','\x20发送了一条语音，内容是：\x27','busy','DOMContentLoaded','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>','https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','修改昵称','{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20','music-visual-container','\x0a\x0a\x0a\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','preventDefault','规则名称和正则表达式不能为空！','confirm-delete-world-books-btn','appearancePresets','sticker-grid','currentPhase','checked\x20disabled','https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','请为这个头像起个名字（例如：开心、哭泣）','编辑人设预设','presetCategories','expanded','select-all-frames-checkbox','++id,\x20title,\x20lastOpened','POST','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22','querySelector','qzone-avatar-container','save-css-preset-btn','<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>','album-back-btn','world-book-category-manager-modal','chat-list-item','custom-user-font','isClosed','API\x20返回错误:\x20','npc-list-view','#image-mode-content','save-ai-response-editor-btn','save-member-settings-btn','manage-ai-avatar-library-btn','*讨论记录*:\x0a','variation-selection-modal','上一条消息的发送时间是\x20','new-category-name-input','”的好友请求','link-title-input','已成功收藏\x20','select-all-types-for-clear','死亡了','favorites-search-input','角色专属','manage-sticker-categories-btn','https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>本地图片(头像/表情/头像框/等)大小:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22><strong>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','移出成员','group-members-group','JSZip库未加载，请刷新页面重试','music-time-counter','replaceChild','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','choices','member-persona-input','trans','originalSize','set','clear-search-btn','manage-groups-btn','lrcContent','链接分享','删除消息','\x27)\x22\x20data-comment=\x22','1046716JEElKB','文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。','image/jpeg','char-diary-detail-title','input[name=\x22theme-select\x22]','\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。','”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','import-world-book-input',')\x20内容:\x20\x22','”的身份，开始你的回忆梳理与精炼。','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','-\x20你昨晚空守了。\x0a','此操作将永久删除\x20','\x20元。此订单已完成。]','enable-tts-switch','myAvatar','call-history-title','8px','...\x22):\x20','\x22\x20id=\x22','.photo-thumb','对方消息预览','https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','选中的商品已成功删除。','\x20转发了\x20@','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>','ai-original-name-input','create_countdown','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','照片上传成功！','product-price-input','is-red-packet','my-persona-group','lorebook','严重警告！','\x20\x0a#\x20社交圈与动态\x0a','\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','cancel-rule-editor-btn','contactId','album-art-btn','add-existing-contact-btn','auto','currentDay','【重要提示】','https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','lyrics-active','disable','未知NPC','ready','readingLibrary','manual-summarize-btn','change_avatar','onchange','发言结束，现在开始投票。','load-more-qzone-btn','请根据角色列表，生成豆瓣小组帖子。','custom-prompt-input','block-cooldown-input','\x20条消息。','.cart-item-checkbox','span:first-child','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>',']\x20的正则表达式无效:','icon-settings-grid','<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>','.link-share-card[data-timestamp]','https://api.vkeys.cn/v2/music/tencent?id=','version','dark-mode','novelai-enabled','-9999px','https://i.postimg.cc/KYr2qRCK/1.jpg','wallpaper','variation','.call-message-bubble[data-timestamp=\x22','[系统提示：用户加入了通话]','custom-modal-overlay','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','data','close-gomoku-btn','forEach','”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','\x20回复了你。','close-sticker-category-manager-btn','transfer-sender-name','API错误响应:','recalledData','supportedValuesOf','导演/编辑模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','已删除最后一条心声，当前心声已重置。','.gift-card','”的记忆\x20(','preset-persona-input','已选\x20','delete-product-btn','狼人杀AI回应生成失败:','loadAsync','https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','\x0a-\x20**你最近和“','播放列表是空的，无需清理。','hunter','poisonedId','close-transcript-modal-btn',')\x20的可用表情:\x0a','getBoundingClientRect','<div\x20class=\x22poll-option-item\x20','你让大家继续讨论...','已使用','linked-memory-count','#chat-interface-screen\x20>\x20.header','你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','settings','AI返回了空的或格式不正确的总结内容。','(暂无有效聊天记录)\x0a','close-product-category-manager-btn','transfer-action-accept','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','show-avatars-btn','recalled_message','正在接收流式数据...','\x20个新表情！','添加完成！\x0a\x0a成功添加\x20','char-diary-screen','https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','random','.variation-image-preview','\x20的代付请求','**:\x20','margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','getUint32','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>','”量身定制的商品已上架！','操作已取消','setProperty','slice','contactType','inject-thought-toggle','aiAvatar','\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a','❌\x20动态NAI图片生成失败:','upload-ephone-bg-url-btn','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg','appName','https://...','world-book-content-container','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20','album-photos-screen','胜利！','.douban-cast-checkbox','transition','rule-card\x20','ruleId','char-music-progress-fill','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','confirm-create-post-btn','my-frame-grid','该预设包含\x20','天，救人概率为\x20','chat','setup','prev-page-btn','werewolf-game-title','转发了\x20@','收到了格式不规范的AI指令，已跳过:','totalPages','无法找到当前角色的数据。','currentPlayer','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','未知设定的NPC','正在请求AI进行记忆精炼...','**:\x20\x22','\x0a#\x20---\x20世界书设定结束\x20---\x0a','请输入你想说的内容：','加载NPC列表失败:','minimaxGroupId','system_message','rule-editor-modal','update','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>','simulatedAlbum','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/T2yKJ0DV/40.jpg','\x20的外卖代付请求（时间戳:\x20','.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar','无法找到或消息类型不匹配的分享链接:','payload','确定要删除表情\x20\x22','qzone-nickname','”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','delete-selected-stickers-btn','直接使用\x20base64\x20数据','字体URL不能为空！','当前人数\x20','<p\x20style=\x22font-size:12px;color:#888;\x22>','exit-werewolf-game-btn','AI女巫决定保留解药。','arc','abs','原作者','313733LgkIIY','myAvatarLibrary','...\x22)','内容因安全策略被屏蔽。触发类别:\x20','\x22>\x20','encode','正在导入表:\x20','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg','#\x20角色核心设定\x0a','regex','最后确认！','.selected','save-font-btn','maxWidth','npc-association-list','删除记录','decode','✅\x20图片显示成功！🎨','nai-custom-proxy-url','unshift','gift-receipt-modal',']\x20(ID:\x20','天黑请闭眼...','base_resp','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a','\x22>×</span>','。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','提取的图片大小:','douban-cast-list','未找到相关收藏','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','transfer-action-decline','已同步角色\x20','exclude',')\x20的棋步。','novelai-settings-modal','》的歌词已成功保存！','lastOpened','resolution','已成功加入购物车！','\x22\x20转发了动态\x20#','讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','\x0a\x0a现在，请生成新的评论。','touchmove','send_and_recall','openRenderingRulesScreen','\x22\x20class=\x22preview-frame\x22>','请选择今晚的目标。','https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','rp-details-summary','character-nai-positive','close-group-manager-btn','修复完成！','Response\x20headers:','https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','你们在','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','请根据你的设定，生成你的日记内容。','\x0a\x0a现在，请以“','placeholder','\x0a#\x20世界观设定\x20(必须参考)\x0a','确定要清空购物车中的所有商品吗？','收到\x20SSE\x20数据，大小:','表情含义','char-chat-list','wolfKill','\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>','#333','</td><td\x20class=\x22item-qty\x22>','autoMemoryInterval','NEGLIGIBLE','ServiceWorker\x20注册失败:\x20','分类\x20\x22','douban-min-posts-input','douban-cast-modal','AI\x20(CPhone)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','标题:\x20','备注名/群名不能为空！','[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]','\x20群里已经安静了','”移出群聊吗？','张RealImag图片:\x20','unblock-btn','编辑商品','https://i.postimg.cc/qRCtnMms/IMG-6145.gif','confirm-create-poll-btn','\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)','从\x20JSON.image\x20中提取图片数据','char-album-grid','utf-16be','qzoneAlbums','保存外观预设','image_post','totalElapsedTime','target_name','pageX','onpause','确定要结束这个投票吗？结束后将无法再进行投票。','加载失败','没有可供重新生成回复的用户消息。','\x20首歌曲获取失败:\x0a-\x20','开始清理','.comment-delete-btn','qzone_comment','message-bubble\x20recalled-message-placeholder','member-name-input','enableTts','\x0a#\x20你的任务\x0a你就是角色“','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>','[图片/文字图]\x20描述:\x20\x22','resolve','收到数据，类型:','请开始总结。','清空购物车','voice-message-btn','annoId','npcId','rules-tab\x20active','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','》吗？\x0a\x0a【【【警告】】】\x0a此操作将同时永久删除该分类下的\x20','reset-font-btn','</div><div\x20class=\x22transfer-amount\x22>¥\x20','cancel-clear-posts-btn','worldBookCategories','hidden','<span>删除</span>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>','numeric','bulkAdd','删除NPC','is-location-share','184HTNTwe','\x0a-\x20**最近与用户的互动**:\x20','lyrics-horizontal-pos','++id,\x20albumId','song_name','keys','thoughts','touches','\x22\x20data-poll-timestamp=\x22','qzonePosts','nai-test-negative','<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22','https://i.postimg.cc/k45sd8gn/IMG-6375.gif','\x22\x20点赞了动态\x20#','女巫已行动，女巫请闭眼。','send-waimai-request-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“','\x0a---\x20复盘结束\x20---','ArrowLeft','totalTime','请输入投票问题！','Character\x20Avatar','\x22\x20生成行动失败:','aiAvatarFrame','openCharApp','usageTimeMinutes','group_call_response','请输入歌名','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','visibilityState','用户向你发送了一张图片','group_','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。','minimaxModel','world_info','查看失败','existing-group-item','preset-tabs','删除相册','reset-theme-btn','请先在API设置中配置好API信息。','music-player-cover','已成功从\x20Tavern\x20AI\x20文件导入设定集《','数据库写入失败:\x20','https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','\x0a[文字图内容:\x20','请输入群聊的名字','update-notice-confirm-btn','无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20',':</span>\x20','text','\x0a\x20\x20-\x20**人设**:\x20','票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20','save-douban-settings-btn','-\x20**当前歌词**:\x20\x22','.incoming-call-content\x20.caller-text','dismissedUpdateVersion','ai-frame-grid','\x20的动态\x20(用户)','\x20的身份是：','import-card-input','each','申请成功！','character-phone-screen','\x22\x20评论了动态\x20#','正则表达式格式错误:\x20','sticker-category-manager-modal','解析成功：标准JSON数组格式。','https://www.myinstants.com/media/sounds/notification-sound-2.mp3','删除预设','reload','char-browser-history','\x22\x20alt=\x22','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','home-screen-pages','https://api.vkeys.cn/v2/music/netease/lyric?id=','无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20','sticker-category-tabs','nai-result-image','utf-8','导入\x20Tavern\x20预设','有点饿了，可以去找充电器惹','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22','add-npc-btn','newSize',')\x20已被用户忽略，无需显示。','werewolf-role-reveal-list','正在重试\x22','高级数据清理失败:','-\x20**对话状态**:\x20(暂无有效对话历史)','npc-editor-title','currentSnippet','申请失败','character-nai-prompts-modal','https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','bulkPut','自动总结成功：为\x20','regenerate-btn','npc-name-input','https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','my-group-nickname-group','sampler','请至少选择一个要清理的角色。','favorite-memo-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','.sticker-category-tab','请输入网络图片的链接','旁观模式AI尝试使用不存在的表情:\x20\x22','小时前','new-product-category-name-input','exec','-\x20你的毒药状态：','当你死亡时，你可以选择带走场上任意一名玩家。','[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“','rules-category-pane\x20active','\x22\x20class=\x22avatar-img\x22><img\x20src=\x22','生成模拟浏览器历史失败:','linkedMemoryChatIds','\x0a\x0a#\x20情景感知:\x0a\x20\x20\x20\x20','call-transcript-modal-body','生成模拟相册失败:','textContent','offsetWidth','API失败:\x20','clear-specific-data-btn','https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','[系统提示：你\x20(','，用户刚刚在\x20','正在等待AI角色们继续讨论...','now','\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','#outgoing-call-screen\x20.caller-text','✅\x20NAI提示词：使用系统配置','cphoneAppIcons','通话于\x20','commenterName','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22','custom-frame-upload-input','https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','请输入要添加的记忆要点：',':</strong>\x20','start','推进剧情失败:','&id,\x20url,\x20name,\x20categoryId','导出成功','cloneNode','findLast','请输入背景图片的URL','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','add-new-rule-btn','此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？','offline-min-length-input','first_mes','\x22\x20class=\x22participant-avatar\x22\x20title=\x22','#message-editor-container\x20textarea','批量导入格式错误，已跳过此行:','您的修改已保存！','contact-picker-item','custom-css-input','\x22\x20的独立行动API返回为空或格式不正确，本次跳过。','char-memo-screen','list-item','favorite-item-card','转账已被拒收','某个时间','back-to-char-qq-list-btn','.battery-text','frame_cat_ear','douban-post-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>','\x0a-\x20**最近对话摘要**:\x0a','创建普通群聊\x20(我参与)','white','https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','\x20\x0a-\x20**你们最后的对话**:\x0a','nai-quality-toggle','150','请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。','正在等待AI角色们进行激烈的讨论...','尝试打开一个不存在的世界书，ID:','mousemove','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','\x0a##\x20世界书《','\x27);\x22','doubanPosts','update-notice-body','动态RealImag图片生成:\x20','nai-smea-dyn','authorOriginalName','.at-mention-popup','ArrowRight','\x0a\x0a现在，请开始生成这组App使用记录。','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','world-book-name-input','专辑封面已更新！','ai-avatar-library-title','请为这组提示词预设命名：','paste','nai-diffusion-4','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','upload-global-bg-url-btn','发送好友申请','update-notice-modal','[系统提示：用户刚刚发布了一条动态(ID:\x20','https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','[系统提示：你接受了“','prompt_order','NPC\x20列表','<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>','\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','确定要将选中的商品作为礼物送出吗？','tts-audio-player','description','照片描述','commentCooldowns','\x22]\x20','*你按下了接听键...*','confirmButtonClass','name','后台活动模拟已停止。','[发送了一条语音，内容是：','isUserParticipating','\x20的礼物','指定的数据已成功清除。','cart-item-checkbox',';\x20font-style:\x20italic;\x22>','locationName','<span\x20style=\x22color:\x20green;\x22>运行中</span>','<s>$1</s>','tlyric','gift','”的长期记忆少于2条，无需进行精炼。','请输入有效的图片URL！','群里还没有任何消息。','\x20的浏览记录','保存书籍(ID:\x20','》及其下的表情已成功删除。','char-music-next-btn','正在为角色\x20','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20如果选择评论，优先回复那些提到了你或回复了你的评论。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20','\x0a-\x20**作者**:\x20','API\x20请求失败:\x20','++id,\x20name,\x20description','一位朋友','my-nickname-input','\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22','https://i.postimg.cc/43PhvxRq/IMG-6922.gif','doubanMaxPosts','15px','取消置顶','https://api.vkeys.cn/v2/music/tencent?word=','生成截图时发生错误，请检查控制台获取详情。','activeChatId','已恢复默认设置！','voice','gameLog','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','(这张照片没有描述)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22','product-editor-title','rp-details-greeting','在导演模式保存时，发现无效的指令对象，已跳过:','保存\x20API\x20预设','charAt','您的旧有记忆已被完整保留，未作任何修改。','分类《','data-clear-wizard-modal','change_group_avatar','update-notice-dismiss-btn','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22','\x20不支持。请选择6、9或12人。','repost-cancel-btn','ephoneLastActiveTimestamp','<span\x20style=\x22color:\x20green;\x22>是</span>','删除世界书','chat-settings-screen','char-conversation-partner-name',')}。\x0a-\x20**对话状态**:\x20','removeItem','pause','<span\x20class=\x22diary-underline\x22>$1</span>','default','variation-product-image','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“','sticker-upload-input','chatActionButtonsOrder','请根据以上设定，生成商品数据。','manage-preset-categories-btn','昨晚是平安夜','天核心议题','https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。','replace','合计:\x20¥','狼人已行动，狼人请闭眼。','music-total-time','createObjectURL','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','direct','你们正在一起听歌，','https://i.postimg.cc/yN3s8szM/IMG-4400.gif','ai-cooldown-group','createDocumentFragment','未知歌手','isActive','[系统提示：\x27','message-editor-modal','isTemporary','日\x20---','minimax-group-id','douban-posts-list','分享新鲜事...（非必填的公开文字）','》添加歌词吗？','https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','member-editor','自定义通话名称','profile-main-content','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22','actionCooldownMinutes','https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','setHours','数据迁移完成！总共修复了\x20','++id,\x20name,\x20type','张NovelAI图片:\x20','create_memory','video-call-btn','frame_8','nameHistory','add-selected-music-btn','qzone-post-delete-action','”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]','likes','\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20','你输了','rule-chat-id-select','chat-header-status','AI们的茶话会','-\x20用户在你们共同所在的群聊中的昵称如下：\x0a','API为空回，角色\x20\x22','write','https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','-\x20你的狼队友是：','thought-card','\x0a#\x20可用表情包\x0a\x20\x20\x20\x20','extensions','photo-viewer-image','[系统提示：用户（','豆瓣小组','🔧\x20检测到Chrome浏览器，启用headers兼容性处理','voice_message','\x20(已忽略版本:\x20','changedTouches','确认精炼','\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','开场\x20','歌曲信息','shoppingProductCount','ai-persona','\x0a\x0a现在，请继续这场对话。\x0a','left','http','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>','\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','fillStyle','input[value=\x22user\x22]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a---\x0a','更换图片','已成功加载外观预设：“','”\x20吗？','load-more-chats-btn','onerror','\x0a#\x20当前五子棋局势\x0a','请输入有效的字体URL。','\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>','novelai-settings','[图片内容:\x20','https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','https://image.pollinations.ai/prompt/','startX','function','</option>','\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20','&id','alt','my-avatar-library-grid','save-api-preset-btn','生成失败','（可选）输入后缀','#f0f2f5','\x20.message-bubble.ai\x20$1','ephone','back-from-member-management','background-activity-switch','<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20','insertBefore','[系统提示：用户\x20(','该条记录已成功删除。','font-size-slider','通话记录已成功总结并存入角色“','我通过了你的好友申请，我们现在是好友啦！','2546724lOnSzr','chat-list-action-delete','++id,\x20timestamp,\x20authorId','所有狼人已被放逐，好人阵营获得了胜利！','product-name-input','https://i.postimg.cc/fLTc42dg/IMG-4391.gif','options','catch','\x20\x20-\x20评论:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','add-char-memo-btn','找到图片文件:','请为这个新头像命名','导演/编辑模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','post-remove-image-btn','\x20行格式不正确，已被忽略。','个红包，共','将清空选定角色的所有对话消息、曾用备注和你的昵称。','请填写有效的商品信息和金额！','pending','为角色\x20\x22','\x20首歌曲的详细信息...','originalName','...','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>','cursor','无法推进剧情:\x20','.world-book-group-content','title','[图片:\x20','enabled','input','确定要删除预设\x20“','font-settings-screen','TA的想法...','https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png','-\x20你昨晚用解药救了\x20','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20','save-api-settings-btn','.select-box','at-mention-item','nai-test-status','请为这个表情命名\x20(例如：好耶、疑惑)','动态内容已复制到剪贴板。','您正和「','https://i.postimg.cc/XNkQTHvf/IMG-5561.gif','.message','.entry-comment-input','生成模拟足迹失败:','正在请求网易云音乐API:','<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20','transfer-actions-modal','gomoku-btn','确认送出礼物','cancel-werewolf-lobby-btn','renderingRules','world-book-entries-container','请根据你的设定，生成你的App使用记录。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20','\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。','世界书数据已成功恢复！','call-record-card','<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20','currentPage','delete-selected-frames-btn','<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>','请先填写NovelAI\x20API\x20Key！','clear','编辑消息','transfer','被投票放逐','请输入想跳转的页码\x20(1\x20-\x20','\x22\x20style=\x22display:block;\x22>×</button>','\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','.message-wrapper','请输入有效的URL。','19800VZHvPg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**','https://api.vkeys.cn/v2/music/netease?word=','\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。','我们的回忆','[系统提示：你刚刚成功将自己的备注名修改为了“','(今天是第一天，没有历史记录)\x0a','检测到视频通话请求，为角色\x20\x22','\x20(回复\x20','票):\x20','prompt','）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20','stopPropagation','更换专辑封面','groupAvatar','onclick','公用规则','greeting','确定要永久删除这条通话记录吗？此操作不可恢复。','<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>','这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。','discussionLog','请至少输入2个有效的投票选项！','群里已经安静了\x20','data-clear-step-2','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20','预言家已行动，预言家请闭眼。','✅\x20找到\x20final\x20事件的图片数据','\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“','delete-current-category-btn','.comment-input','sender-name','部分失败','-\x20用户的QZone昵称是\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>','linesPerPage','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','beginPath','group-character-nai-prompts-btn','song','douban-comment-input','add-sticker-batch-btn','amount','final','...\x22','border-box','<div\x20class=\x22poll-card\x20','NotAllowedError','close-playlist-btn','favorites-back-btn','handlePacketClick','播放被中断，这是正常行为:','gbk','private_user','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。','style=\x22background-image:\x20url(\x27','member-management-item','browser-back-btn','table','input[name=\x22visibility_group\x22]:checked','\x22\x20的本次后台活动跳过。原始回复:','local-song-upload-input','save-frame-settings-btn','werewolf-lobby-modal','后台活动模拟已自动启动。','announcement-action-delete','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>','渲染X社交页面','werewolf-role-confirm-btn','https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','parsedLyrics','douban-post-detail-title','）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a','fullscreen-active','选中的消息均已收藏过。','。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20','小时核心议题','「在这里输入对话内容」\x0a(在这里输入动作或环境描写)','rendering-rules-screen','new-group-name-input','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>','.post-avatar[data-author-id=\x22','”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20','https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','votes','lastIndexOf','char-home-screen','https://i.postimg.cc/wx72fhr2/IMG-5968.gif','https://i.postimg.cc/g2XykNGB/IMG-4727.gif','image-upload-input','delete-call-message-btn','API\x20错误:\x20','4.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20(','.qzone-post-container[data-post-id=\x22','\x22\x20中的成员信息更新','execute-search-btn','character-grid','操作失败','htmlFor','”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《','游戏配置：','groupHeader','清空动态时发生错误:\x20','add-countdown-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','switchToMyPhone','add-persona-preset-btn','-speech','删除失败，请查看控制台错误信息。','.werewolf-player-checkbox:checked','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','timeupdate','请输入你想为Ta设置的【备注名】(例如:\x20哥哥)','secondaryModel','font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);','none','announcement-action-pin','.sticker-item[data-sticker-id=\x22','usage','所有解码尝试均失败:','未知成员','characterPositivePrompt','暂无内容...','karras','\x27刚刚评论了你的动态“','transcript','syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','检测到\x20SSE\x20流式响应，开始解析...','https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','请为这个头像起个名字（例如：春日野餐、学习时间）','.variation-block','dragging','\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','要为《','share_card','[系统提示：你拒绝并退还了“','[表情]','load-more-btn','确定要删除这条记录吗？','<option\x20value=\x22global\x22>公用\x20(所有角色)</option>','发现新版本通知:\x20','toLocaleTimeString','shoppingCategories','\x0a[图片]','在聊天\x20\x22','<textarea\x20id=\x22','\x22\x20data-category-id=\x22','”\x20将备注修改为\x20“','<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22','请输入新的背景图片链接','\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20','.product-item','https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','block','\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','(在那次','douban-screen','预言家','is-card-like','”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','#text-image-mode-content','browser-screen','）完成了支付。此订单已关闭，其他成员不能再支付。]',')，接收人是“','cancel-delete-world-books-btn','activeBookId','close-rp-details-btn','.playlist-item','\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','group_summary_from_','itemName','ttsCache','https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','已成功导出所有数据！','获取更新通知文件失败。','cancel-advanced-editor-btn','下棋历史\x20(x,y坐标均从0开始):\x0a','https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','”的聊天记录已成功导出！','char-music-progress-bar','#product-grid\x20.product-item','”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','\x20条红包记录。','checkout-btn','++id,\x20name','offset','my-avatar-upload-input','albumId','\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a','top','AI女巫决定使用毒药，目标是:\x20','确定要从收藏夹中移除这\x20','selection-count','请先选择要添加的歌曲。','备忘录',']类型的消息','favoritedPostIds','导入成功','lyrics-offset-input','.entry-content-textarea','toLocaleDateString','.contact-picker-item','这是群里的第一条消息。','pop','nai-test-result','确定要拉黑“','timestamp','压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...','我拒绝了你的视频通话请求。','#ff8a80','thoughtsHistory','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>','【AI角色】','ai-avatar-group','comments','*事件*:\x20','\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','secondary-proxy-url','#\x20性格补充\x0a','\x20的图片消息替换为文字描述...','qzone','📝\x20使用','stickerMeaning','代付请求已被拒绝','.chat-group-content','frameUrl','相册名称不能为空！','gomoku-controls','\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片','visibleGroupIds','chat-list-title','检测到刚结束的通话，正在注入通话记录上下文...','min','random_jottings','发来了\x20','user','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','chat-messages','删除商品','persona','playlist-body',')\x20刚刚领取了红包\x20(时间戳:\x20','appearance-preset-select','callHistory','请输入书名','这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？','poisonUsed','nightActions','music-next-btn','NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。','preset-avatar-input','char-conversation-messages','\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a','npc','var(--text-secondary)','📊\x20使用模型:','100','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20','#char-chat-list\x20.chat-list-item','未分类','fullPrompt','，礼物是：','speaker_name','post-use-url-btn','\x0a-\x20**你们最后的对话摘要**:\x20\x0a','auto-memory-toggle','https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>','<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22','span','-\x20清理了\x20','sticker-binding-chat-list','share-target-modal','https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','addEventListener','long-term-memory-screen','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>','artist','persona-library-grid','[系统提示：五子棋游戏已结束。最终结果是：','vote_for_name','-\x20\x22','add-song-local-btn','\x22]\x20.avatar','”的购物习惯...','导入成功！','scrollIntoView','”下，发送了一个表情评论，意思是：“','导出失败','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','是否要使用毒药？','next-page-btn','background-interval-input','命名头像框','仅清空\x20','https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','正在开始清理冗余数据，请不要关闭页面...','\x20(角色)</label>','\x22\x20的独立后台活动开关已关闭，本次跳过。','messages-view','API请求失败\x20(','送给\x20','nai-diffusion-4-5-full','cleanup-data-btn','selection-erase-btn','music-player-song-title','album-photos-back-btn','”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','（无有效对话记录）','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','chat-list-screen','\x22\x20的本次后台活动跳过。','textarea','批量导入头像','精炼“','https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','EPhoneSingleChat','batch-import-frames-btn','blockCooldownHours','offsetParent','-\x20你们昨晚尝试攻击的玩家是：','product-editor-modal','删除动态','Content-Type:','旁观模式收到未知指令类型:','custom-modal-title','pat-animation','input[name=\x22theme-select\x22][value=\x22','secondary-api-key','isRefund','char-music-screen','bookId','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22','收藏成功！','输入图片URL',')\x20商品:\x20','删除分类后，该分类下的所有商品将变为“未分类”。确定吗？','”翻开TA的日记本...','<span\x20class=\x22speaker\x22>','activeContainer','&times;',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','通话中，','**[投票结果]**\x20','https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','这将用备份文件中的数据【完全覆盖】当前与“','\x0a-\x20**世界书设定**:\x20','url','流式导出过程中出错:','save-nai-settings-btn','#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a','reduce','nai-sampler','visible','typeId','userAgent','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>','https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','.unread-indicator.back-btn-indicator','char-music-player-title','charCodeAt','开始检查并迁移旧的红包数据...','replyToName','players','我们和好吧！','custom-bubble-style','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“','\x20个条目。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','请先配置NovelAI\x20API\x20Key！','user_photo','\x20---\x0a','font-preview','\x22\x20处于行动冷却中\x20(还剩\x20','douban-detail-comments-list','lyrics-position-group','close-ai-avatar-library-btn','ceil','不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。','复制成功','member-management-list','\x20的备忘录','commentText','确定要删除《','limit','https://corsproxy.io/?','upload-image-btn','Asia/Shanghai','分组\x20\x22','content-type','novelai-key-toggle','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','】，本名是【','\x20发送了一个【专属红包】(时间戳:\x20','is-ai-image','#avatar-frame-modal\x20.frame-tabs','</td><td\x20class=\x22item-price\x22>¥','豆瓣设定','ai_generated','群昵称不能为空！','总结通话记录时出错:','<div\x20class=\x22poll-options-list\x22>','nai-generate-btn','full','offsetHeight','quote-message-btn','recall-message-btn','pat_user','&id,\x20minimaxGroupId,\x20minimaxApiKey','chat-list-action-pin','创建新聊天\x20(第2/2步)','https://i.postimg.cc/fycfcvHf/IMG-6569.gif','startsWith','https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','string','\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。','https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','ai-voice-id-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。','iVBORw0KGgo','enableAiDrawing','无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20','https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','add-world-book-entry-btn','blob','group-avatar-upload-input','edit-last-response-btn','精炼长期记忆时出错:','你是狼人，请选择刀人目标。','rp-group-count','\x0a-\x20**你的曾用名**:\x20[','add-to-cart-btn','join','product-description-input','frame_10','friend','delete-world-books-list'];_0xe858=function(){return _0xe2a930;};return _0xe858();}document['addEventListener'](_0x3b4352(0xcff),()=>{const _0x41eae2=_0x3b4352;document[_0x41eae2(0x1193)](_0x41eae2(0x5cf),()=>{const _0xcc3bf3=_0x41eae2;document[_0xcc3bf3(0xeb4)]===_0xcc3bf3(0x11e4)&&(console['log'](_0xcc3bf3(0x15b)),navigator[_0xcc3bf3(0xbc6)][_0xcc3bf3(0xd78)][_0xcc3bf3(0x7ec)](_0x497404=>{const _0x4a8527=_0xcc3bf3;_0x497404[_0x4a8527(0xdfc)]();}));});function _0xa615f4(_0x32eaa3,_0x5875cc,_0x176018,_0x26d3fb){const _0x5dc5f2=_0x41eae2,_0x44fcf5=_0x5b873d[_0x5dc5f2(0x21a)]['apiTemperature']||0.8,_0x510fde={'user':_0x5dc5f2(0x116c),'assistant':_0x5dc5f2(0x1364),'system':_0x5dc5f2(0x116c)},_0x124ecc=[{'role':'user','parts':[{'text':_0x176018}]},{'role':'model','parts':[{'text':'好的，我明白了。我会严格遵守以上所有规则和设定。'}]},..._0x26d3fb[_0x5dc5f2(0x412)](_0x2f94bd=>{const _0x18a4fc=_0x5dc5f2,_0x226471=[];return Array['isArray'](_0x2f94bd[_0x18a4fc(0x28c)])?_0x2f94bd[_0x18a4fc(0x28c)][_0x18a4fc(0xd9a)](_0xeafdba=>{const _0x453084=_0x18a4fc;if(_0xeafdba[_0x453084(0x48c)]===_0x453084(0xec9))_0x226471[_0x453084(0x138c)]({'text':_0xeafdba[_0x453084(0xec9)]});else{if(_0xeafdba[_0x453084(0x48c)]===_0x453084(0xcad)&&_0xeafdba['image_url']&&_0xeafdba[_0x453084(0xcad)]['url']){const _0x1ac2fa=_0xeafdba[_0x453084(0xcad)][_0x453084(0x11de)],_0x27f380=_0x1ac2fa[_0x453084(0x55b)](',')[0x1],_0x443fb2=_0x1ac2fa[_0x453084(0x86c)](/^data:(.*);base64/);_0x443fb2&&_0x27f380&&_0x226471[_0x453084(0x138c)]({'inline_data':{'mime_type':_0x443fb2[0x1],'data':_0x27f380}});}}}):_0x226471[_0x18a4fc(0x138c)]({'text':String(_0x2f94bd[_0x18a4fc(0x28c)])}),{'role':_0x510fde[_0x2f94bd['role']],'parts':_0x226471};})];return{'url':_0x5dc5f2(0x755)+_0x32eaa3+_0x5dc5f2(0x3cf)+getRandomValue(_0x5875cc),'data':{'method':_0x5dc5f2(0xd14),'headers':{'Content-Type':'application/json'},'body':JSON[_0x5dc5f2(0x465)]({'contents':_0x124ecc,'generationConfig':{'temperature':_0x44fcf5}})}};}const _0x1a6951=new Dexie('GeminiChatDB'),_0x88819=[{'id':_0x41eae2(0x10f2),'url':'','name':'无'},{'id':_0x41eae2(0xf40),'url':'https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','name':'1'},{'id':_0x41eae2(0x91e),'url':_0x41eae2(0xfef),'name':'2'},{'id':_0x41eae2(0x58b),'url':_0x41eae2(0x1e5),'name':'3'},{'id':'frame_tech','url':_0x41eae2(0x122d),'name':'4'},{'id':_0x41eae2(0xa95),'url':_0x41eae2(0x366),'name':'5'},{'id':_0x41eae2(0x12b2),'url':'https://i.postimg.cc/63sDQKMm/IMG-6893.gif','name':'6'},{'id':'frame_7','url':_0x41eae2(0x27d),'name':'7'},{'id':_0x41eae2(0xfe1),'url':_0x41eae2(0xbc0),'name':'8'},{'id':_0x41eae2(0x26f),'url':_0x41eae2(0xdc5),'name':'9'},{'id':_0x41eae2(0x1239),'url':_0x41eae2(0x1310),'name':'10'},{'id':'frame_11','url':_0x41eae2(0xefb),'name':'11'},{'id':_0x41eae2(0x12cc),'url':_0x41eae2(0x377),'name':'12'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x1e6),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x49f),'name':'14'},{'id':_0x41eae2(0xf40),'url':'https://i.postimg.cc/kGgwJhPH/IMG-4374.gif','name':'1'},{'id':_0x41eae2(0x91e),'url':_0x41eae2(0x5e8),'name':'2'},{'id':_0x41eae2(0x58b),'url':_0x41eae2(0x6e5),'name':'3'},{'id':_0x41eae2(0x3b4),'url':_0x41eae2(0xa0b),'name':'4'},{'id':_0x41eae2(0xa95),'url':_0x41eae2(0x8d0),'name':'5'},{'id':_0x41eae2(0x12b2),'url':_0x41eae2(0x369),'name':'6'},{'id':'frame_7','url':'https://i.postimg.cc/RZNLhbbr/IMG-4389.gif','name':'7'},{'id':_0x41eae2(0xfe1),'url':_0x41eae2(0x1033),'name':'8'},{'id':'frame_9','url':_0x41eae2(0x1cd),'name':'9'},{'id':_0x41eae2(0x1239),'url':_0x41eae2(0x1251),'name':'10'},{'id':_0x41eae2(0xc96),'url':_0x41eae2(0xc76),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif','name':'12'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0xb70),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x250),'name':'14'},{'id':_0x41eae2(0xf40),'url':_0x41eae2(0xfc7),'name':'1'},{'id':_0x41eae2(0x91e),'url':_0x41eae2(0x12a9),'name':'2'},{'id':_0x41eae2(0x58b),'url':_0x41eae2(0xaa3),'name':'3'},{'id':'frame_tech','url':_0x41eae2(0x6be),'name':'4'},{'id':_0x41eae2(0xa95),'url':_0x41eae2(0x31e),'name':'5'},{'id':'frame_6','url':_0x41eae2(0x96a),'name':'6'},{'id':_0x41eae2(0x712),'url':_0x41eae2(0x925),'name':'7'},{'id':'frame_8','url':'https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','name':'8'},{'id':_0x41eae2(0x26f),'url':'https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','name':'9'},{'id':'frame_10','url':_0x41eae2(0xd5c),'name':'10'},{'id':_0x41eae2(0xc96),'url':_0x41eae2(0x1117),'name':'11'},{'id':_0x41eae2(0x12cc),'url':'https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','name':'12'},{'id':_0x41eae2(0x9de),'url':'https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x112c),'name':'14'},{'id':'frame_cat_ear','url':_0x41eae2(0x1192),'name':'1'},{'id':_0x41eae2(0x91e),'url':_0x41eae2(0x6af),'name':'2'},{'id':_0x41eae2(0x58b),'url':_0x41eae2(0xcaf),'name':'3'},{'id':'frame_tech','url':'https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','name':'4'},{'id':_0x41eae2(0xa95),'url':'https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','name':'5'},{'id':_0x41eae2(0x12b2),'url':_0x41eae2(0x2a8),'name':'6'},{'id':_0x41eae2(0x712),'url':_0x41eae2(0x92a),'name':'7'},{'id':_0x41eae2(0xfe1),'url':_0x41eae2(0x120d),'name':'8'},{'id':_0x41eae2(0x26f),'url':_0x41eae2(0x1279),'name':'9'},{'id':_0x41eae2(0x1239),'url':_0x41eae2(0xa25),'name':'10'},{'id':_0x41eae2(0xc96),'url':_0x41eae2(0x858),'name':'11'},{'id':_0x41eae2(0x12cc),'url':_0x41eae2(0x349),'name':'12'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x79f),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x563),'name':'14'},{'id':_0x41eae2(0xf40),'url':_0x41eae2(0x105d),'name':'1'},{'id':_0x41eae2(0x91e),'url':_0x41eae2(0xf23),'name':'2'},{'id':_0x41eae2(0x58b),'url':_0x41eae2(0xaf4),'name':'3'},{'id':'frame_tech','url':_0x41eae2(0x2b0),'name':'4'},{'id':_0x41eae2(0xa95),'url':_0x41eae2(0x10d5),'name':'5'},{'id':_0x41eae2(0x12b2),'url':_0x41eae2(0xa7a),'name':'6'},{'id':_0x41eae2(0x712),'url':_0x41eae2(0x3a2),'name':'7'},{'id':_0x41eae2(0xfe1),'url':_0x41eae2(0x7bf),'name':'8'},{'id':_0x41eae2(0x26f),'url':_0x41eae2(0x11a8),'name':'9'},{'id':'frame_10','url':_0x41eae2(0xa1d),'name':'10'},{'id':_0x41eae2(0xc96),'url':'https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','name':'11'},{'id':'frame_12','url':_0x41eae2(0x16a),'name':'12'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0xab3),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','name':'14'},{'id':_0x41eae2(0xf40),'url':'https://i.postimg.cc/CKgDNYVb/IMG-5577.gif','name':'1'},{'id':_0x41eae2(0x91e),'url':_0x41eae2(0xbd0),'name':'2'},{'id':_0x41eae2(0x58b),'url':_0x41eae2(0xbd0),'name':'3'},{'id':'frame_tech','url':_0x41eae2(0xc6b),'name':'4'},{'id':_0x41eae2(0xa95),'url':_0x41eae2(0x50a),'name':'5'},{'id':_0x41eae2(0x12b2),'url':_0x41eae2(0xd0d),'name':'6'},{'id':_0x41eae2(0x712),'url':'https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','name':'7'},{'id':'frame_8','url':_0x41eae2(0x51d),'name':'8'},{'id':_0x41eae2(0x26f),'url':_0x41eae2(0xbea),'name':'9'},{'id':_0x41eae2(0x1239),'url':_0x41eae2(0x10d4),'name':'10'},{'id':_0x41eae2(0xc96),'url':_0x41eae2(0xf46),'name':'11'},{'id':_0x41eae2(0x12cc),'url':_0x41eae2(0x1038),'name':'12'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x132e),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','name':'14'},{'id':'frame_cat_ear','url':_0x41eae2(0x12db),'name':'1'},{'id':_0x41eae2(0x91e),'url':'https://i.postimg.cc/9fQZ425b/IMG-5975.gif','name':'2'},{'id':_0x41eae2(0x58b),'url':_0x41eae2(0x11bc),'name':'3'},{'id':_0x41eae2(0x3b4),'url':_0x41eae2(0x134c),'name':'4'},{'id':_0x41eae2(0xa95),'url':_0x41eae2(0x48a),'name':'5'},{'id':_0x41eae2(0x12b2),'url':_0x41eae2(0xa23),'name':'6'},{'id':_0x41eae2(0x712),'url':_0x41eae2(0xe68),'name':'7'},{'id':'frame_8','url':_0x41eae2(0x5a5),'name':'8'},{'id':_0x41eae2(0x26f),'url':_0x41eae2(0x604),'name':'9'},{'id':_0x41eae2(0x1239),'url':'https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','name':'10'},{'id':_0x41eae2(0xc96),'url':'https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','name':'12'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0xc24),'name':'13'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','name':'14'},{'id':'frame_cat_ear','url':_0x41eae2(0x273),'name':'1'},{'id':'frame_ribbon','url':_0x41eae2(0xea3),'name':'2'},{'id':_0x41eae2(0x58b),'url':_0x41eae2(0x98b),'name':'3'},{'id':'frame_tech','url':_0x41eae2(0x878),'name':'4'},{'id':_0x41eae2(0xa95),'url':'https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','name':'5'},{'id':_0x41eae2(0x12b2),'url':_0x41eae2(0x24d),'name':'6'},{'id':_0x41eae2(0x712),'url':_0x41eae2(0x512),'name':'7'},{'id':'frame_8','url':_0x41eae2(0x7a9),'name':'8'},{'id':_0x41eae2(0x26f),'url':_0x41eae2(0x181),'name':'9'},{'id':_0x41eae2(0x1239),'url':'https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','name':'10'},{'id':_0x41eae2(0xc96),'url':_0x41eae2(0x683),'name':'11'},{'id':_0x41eae2(0x12cc),'url':_0x41eae2(0x11e8),'name':'12'},{'id':'frame_13','url':_0x41eae2(0x9f4),'name':'13'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','name':'14'},{'id':_0x41eae2(0xf40),'url':'https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','name':'1'},{'id':_0x41eae2(0x91e),'url':'https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','name':'2'},{'id':_0x41eae2(0x58b),'url':'https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','name':'3'},{'id':'frame_tech','url':_0x41eae2(0x1221),'name':'4'},{'id':_0x41eae2(0xa95),'url':_0x41eae2(0x375),'name':'5'},{'id':_0x41eae2(0x12b2),'url':_0x41eae2(0xcf3),'name':'6'},{'id':'frame_7','url':_0x41eae2(0x8e0),'name':'7'},{'id':_0x41eae2(0xfe1),'url':_0x41eae2(0xce7),'name':'8'},{'id':_0x41eae2(0x26f),'url':_0x41eae2(0x12cd),'name':'9'},{'id':'frame_10','url':_0x41eae2(0x1226),'name':'10'},{'id':_0x41eae2(0xc96),'url':_0x41eae2(0x888),'name':'11'},{'id':_0x41eae2(0x12cc),'url':_0x41eae2(0x887),'name':'12'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x11d9),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0xca0),'name':'14'},{'id':_0x41eae2(0xf40),'url':_0x41eae2(0x4d4),'name':'1'},{'id':_0x41eae2(0x91e),'url':_0x41eae2(0xf4f),'name':'2'},{'id':_0x41eae2(0x58b),'url':'https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','name':'3'},{'id':_0x41eae2(0x3b4),'url':_0x41eae2(0x516),'name':'4'},{'id':_0x41eae2(0xa95),'url':_0x41eae2(0x3ba),'name':'5'},{'id':_0x41eae2(0x12b2),'url':_0x41eae2(0x16c),'name':'6'},{'id':'frame_7','url':'https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','name':'7'},{'id':_0x41eae2(0xfe1),'url':_0x41eae2(0x1223),'name':'8'},{'id':_0x41eae2(0x26f),'url':'https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','name':'9'},{'id':_0x41eae2(0x1239),'url':_0x41eae2(0x4dc),'name':'10'},{'id':_0x41eae2(0xc96),'url':_0x41eae2(0x2e6),'name':'11'},{'id':_0x41eae2(0x12cc),'url':_0x41eae2(0xdab),'name':'12'},{'id':_0x41eae2(0x9de),'url':'https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0xad8),'name':'14'},{'id':'frame_11','url':_0x41eae2(0x10ff),'name':'11'},{'id':'frame_12','url':_0x41eae2(0x116d),'name':'12'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x10c1),'name':'13'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/sDFhySn3/IMG-6936.gif','name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0xf90),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x582),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x125c),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0xef6),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x94b),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','name':'14'},{'id':_0x41eae2(0x12cc),'url':_0x41eae2(0x9e5),'name':'12'},{'id':_0x41eae2(0x9de),'url':'https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','name':'13'},{'id':'frame_14','url':_0x41eae2(0xf16),'name':'14'},{'id':_0x41eae2(0x9de),'url':'https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x9b8),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x4c1),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x27a),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x454),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x6c9),'name':'14'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','name':'14'},{'id':'frame_13','url':_0x41eae2(0xbc7),'name':'13'},{'id':'frame_14','url':_0x41eae2(0x845),'name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x10d0),'name':'14'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/SNByPrf9/IMG-7005.gif','name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0xc55),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x69b),'name':'14'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','name':'14'},{'id':'frame_13','url':_0x41eae2(0xd74),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x4f9),'name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x284),'name':'14'},{'id':'frame_13','url':_0x41eae2(0x639),'name':'13'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0xab1),'name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0xa78),'name':'14'},{'id':_0x41eae2(0x9de),'url':'https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif','name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x6eb),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0xf66),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x1322),'name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x6e4),'name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x7b8),'name':'14'},{'id':_0x41eae2(0x9de),'url':'https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x1373),'name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0xb10),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x82b),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x118b),'name':'14'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','name':'14'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','name':'14'},{'id':'frame_13','url':_0x41eae2(0xe4a),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0xc1b),'name':'14'},{'id':'frame_14','url':_0x41eae2(0xe44),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x5ea),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x1016),'name':'14'},{'id':'frame_14','url':_0x41eae2(0xe2a),'name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x1131),'name':'14'},{'id':_0x41eae2(0x9de),'url':'https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0xd31),'name':'14'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','name':'14'},{'id':'frame_13','url':_0x41eae2(0xca4),'name':'13'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x70d),'name':'14'},{'id':'frame_14','url':_0x41eae2(0x2b2),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0xd01),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x7f4),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x4fa),'name':'13'},{'id':'frame_14','url':_0x41eae2(0xfda),'name':'14'},{'id':'frame_14','url':_0x41eae2(0x11da),'name':'14'},{'id':'frame_14','url':_0x41eae2(0x6ab),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0xb50),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x67c),'name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x882),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x328),'name':'13'},{'id':'frame_14','url':_0x41eae2(0x884),'name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0xec3),'name':'14'},{'id':'frame_14','url':_0x41eae2(0xc07),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x381),'name':'13'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x4ec),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x8d4),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x3b7),'name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x65f),'name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x124f),'name':'14'},{'id':'frame_13','url':_0x41eae2(0x9c7),'name':'13'},{'id':'frame_14','url':_0x41eae2(0x8f5),'name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x7dd),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0xbbf),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x6c5),'name':'14'},{'id':'frame_14','url':_0x41eae2(0x161),'name':'14'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/FzqHTBng/IMG-7093.gif','name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0xc4d),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x31f),'name':'14'},{'id':'frame_14','url':_0x41eae2(0xb48),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x11b6),'name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x383),'name':'14'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x97c),'name':'14'},{'id':_0x41eae2(0x9de),'url':'https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','name':'13'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0xb56),'name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0x329),'name':'14'},{'id':_0x41eae2(0x9de),'url':_0x41eae2(0x12c0),'name':'13'},{'id':_0x41eae2(0x739),'url':'https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','name':'14'},{'id':_0x41eae2(0x739),'url':_0x41eae2(0xfd4),'name':'14'}];let _0x5b873d={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map()},_0x42920c={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':_0x41eae2(0xdea),'nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0x59fed2=0x0;const _0x93b741=0xf;let _0x4cbc61=0x0;const _0x130525=0xa;let _0xbd77bc=[],_0x1f2ed8={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':_0x41eae2(0x7ed),'totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0x40df96={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x1e10c1=document[_0x41eae2(0x89d)](_0x41eae2(0x2cc));let _0x4de9bb=null,_0x17f18d=![],_0x105ba4=0x0,_0x10a81b=null,_0x2dde7e=![],_0x10313e='all',_0x2b125e=new Set(),_0x251560=null,_0x32afbb=![],_0x429d52=null,_0x3ac599=null,_0x58ae48=![],_0x456197=![],_0x4177cd=![],_0x34a523=![],_0x8d0923=[],_0x589eec=null,_0x204995=null,_0x15984b={},_0x1cefba=null,_0x521c79=null,_0x4c98af=null,_0x518175=null,_0x2b40cf=null,_0x363100=null,_0x38fb37=null,_0x37a4bf=[],_0x34a863=null,_0x20db4d=null,_0x512a2b=new Set(),_0x5219d8=null,_0x46d775=null,_0x2188b8=null,_0x5f2baa={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x111a81=0x0,_0x57e987=![],_0x397d2b=new Set(),_0x10707f=null;const _0x265fcc='https://i.postimg.cc/PxZrFFFL/o-o-1.jpg',_0x24462f=_0x41eae2(0x722),_0x15061e='https://i.postimg.cc/VkQfgzGJ/1.jpg',_0x660176=_0x41eae2(0x35e);let _0x388438,_0x2402b7={};const _0x3aca30=_0x41eae2(0xedc);let _0x404de6={},_0x2aadc5={},_0x2c50a8=null;const _0x4cdb37={'qq':_0x41eae2(0x899),'world-book':'https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','wallpaper':_0x41eae2(0x706),'renderer':_0x41eae2(0x5d2),'api-settings':_0x41eae2(0x731),'font':'https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','char-phone':_0x41eae2(0x6de),'douban':'https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','preset':_0x41eae2(0x81e),'tutorial':_0x41eae2(0x91f),'werewolf':_0x41eae2(0xccb),'x':_0x41eae2(0x308)},_0x413ad5={'qq':_0x41eae2(0x899),'album':'https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','browser':'https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','taobao':_0x41eae2(0x356),'memo':_0x41eae2(0xfbd),'diary':_0x41eae2(0x179),'amap':_0x41eae2(0x94f),'usage':_0x41eae2(0x70e),'music':_0x41eae2(0x1347),'ephone':_0x41eae2(0x6de)};let _0x1895e3=null;const _0x3b71b1=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0x3def71=0x0,_0x39cb9e=0x1,_0xe0717d={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0x31c04c;const _0x19651a=document[_0x41eae2(0x285)](_0x41eae2(0x68e));_0x19651a['id']='dynamic-font-style',document[_0x41eae2(0xb0d)]['appendChild'](_0x19651a);const _0x36bef4=document[_0x41eae2(0x89d)](_0x41eae2(0xd96)),_0x5c11ab=document[_0x41eae2(0x89d)](_0x41eae2(0x11c6)),_0x1bafb7=document[_0x41eae2(0x89d)](_0x41eae2(0x271)),_0x250768=document[_0x41eae2(0x89d)](_0x41eae2(0x61a)),_0x18a4ed=document[_0x41eae2(0x89d)](_0x41eae2(0x39d));let _0x40cb03;function _0x24ce2c(){const _0x451142=_0x41eae2;_0x36bef4['classList']['add'](_0x451142(0x11e4));}function _0x1ff3b5(){const _0x35db8a=_0x41eae2;_0x36bef4['classList']['remove'](_0x35db8a(0x11e4)),_0x250768['classList'][_0x35db8a(0x1247)]('btn-danger');if(_0x40cb03)_0x40cb03(null);}function _0x52994c(_0xb76347){const _0x5170c0=_0x41eae2,_0x1fb339=document['getElementById']('global-lyrics-bar'),_0x2f9e9a=_0xb76347[_0x5170c0(0xdb9)][_0x5170c0(0x8c5)]||{'vertical':_0x5170c0(0x113d),'horizontal':_0x5170c0(0x802),'offset':0xa};_0x1fb339['style']['top']=_0x5170c0(0xd71),_0x1fb339[_0x5170c0(0x68e)][_0x5170c0(0xc74)]=_0x5170c0(0xd71),_0x1fb339[_0x5170c0(0x68e)][_0x5170c0(0x1004)]='auto',_0x1fb339[_0x5170c0(0x68e)]['right']='auto',_0x1fb339['style']['transform']='none';_0x2f9e9a[_0x5170c0(0xc4c)]===_0x5170c0(0x113d)?_0x1fb339[_0x5170c0(0x68e)]['top']=_0x2f9e9a['offset']+'px':_0x1fb339[_0x5170c0(0x68e)][_0x5170c0(0xc74)]=_0x2f9e9a[_0x5170c0(0x1139)]+'px';switch(_0x2f9e9a[_0x5170c0(0xade)]){case _0x5170c0(0x1004):_0x1fb339[_0x5170c0(0x68e)][_0x5170c0(0x1004)]=_0x5170c0(0xf92);break;case _0x5170c0(0x5f0):_0x1fb339[_0x5170c0(0x68e)]['right']='15px';break;case _0x5170c0(0x802):default:_0x1fb339['style'][_0x5170c0(0x1004)]=_0x5170c0(0xaed),_0x1fb339[_0x5170c0(0x68e)][_0x5170c0(0x9ab)]=_0x5170c0(0x12b0);break;}}async function _0x2e779c(_0x36deab){const _0x258bc9=_0x41eae2,_0x7adad5=_0x36deab[_0x258bc9(0x225)][_0x258bc9(0x541)][0x0];if(!_0x7adad5)return;const _0x2d6743=await new Promise(_0x13560b=>{const _0x233d72=_0x258bc9,_0x252a6b=new FileReader();_0x252a6b[_0x233d72(0x736)]=()=>_0x13560b(_0x252a6b[_0x233d72(0x9dc)]),_0x252a6b[_0x233d72(0x5b4)](_0x7adad5);});await _0x532f76('请稍候...',_0x258bc9(0xb53));try{const _0x57dd16=await _0x26a634(_0x2d6743);if(!_0x57dd16)throw new Error(_0x258bc9(0x1c4));const _0x11977f=_0x5b873d[_0x258bc9(0x667)][_0x5b873d[_0x258bc9(0xf96)]];!_0x11977f['settings']['groupAvatarLibrary']&&(_0x11977f[_0x258bc9(0xdb9)][_0x258bc9(0x1e2)]=[]),_0x11977f[_0x258bc9(0xdb9)][_0x258bc9(0x1e2)][_0x258bc9(0x138c)]({'name':_0x57dd16,'url':_0x2d6743}),await _0x1a6951[_0x258bc9(0x667)][_0x258bc9(0xc0f)](_0x11977f),_0x5c4e69(),await _0x532f76(_0x258bc9(0x67d),_0x258bc9(0x7ca)+_0x57dd16+'”');}catch(_0x2a6648){console[_0x258bc9(0x1fd)](_0x258bc9(0x203),_0x2a6648),await _0x532f76('操作失败',_0x258bc9(0x1ae)+_0x2a6648[_0x258bc9(0x1288)]);}finally{_0x36deab[_0x258bc9(0x225)][_0x258bc9(0x2f4)]=null;}}async function _0x1abb11(_0x2bc9b8){const _0x4cde87=_0x41eae2,_0x57b345=_0x2bc9b8[_0x4cde87(0x225)][_0x4cde87(0x541)][0x0];if(!_0x57b345)return;const _0x20c32e=await new Promise(_0x5bd156=>{const _0x20145a=_0x4cde87,_0xe68420=new FileReader();_0xe68420[_0x20145a(0x736)]=()=>_0x5bd156(_0xe68420[_0x20145a(0x9dc)]),_0xe68420[_0x20145a(0x5b4)](_0x57b345);});await _0x532f76(_0x4cde87(0xb6a),'正在请求AI为新头像命名...');try{const _0x5fdb94=await _0x26a634(_0x20c32e);if(!_0x5fdb94)throw new Error(_0x4cde87(0x1c4));const _0x3a88e7=_0x5b873d[_0x4cde87(0x667)][_0x5b873d[_0x4cde87(0xf96)]];!_0x3a88e7[_0x4cde87(0xdb9)][_0x4cde87(0x614)]&&(_0x3a88e7[_0x4cde87(0xdb9)]['aiAvatarLibrary']=[]),_0x3a88e7[_0x4cde87(0xdb9)][_0x4cde87(0x614)][_0x4cde87(0x138c)]({'name':_0x5fdb94,'url':_0x20c32e}),await _0x1a6951['chats'][_0x4cde87(0xc0f)](_0x3a88e7),_0x4b997a(),await _0x532f76('上传成功！','AI已将新头像命名为：“'+_0x5fdb94+'”');}catch(_0x52f56e){console[_0x4cde87(0x1fd)](_0x4cde87(0x901),_0x52f56e),await _0x532f76(_0x4cde87(0x10de),_0x4cde87(0x1ae)+_0x52f56e[_0x4cde87(0x1288)]);}finally{_0x2bc9b8[_0x4cde87(0x225)][_0x4cde87(0x2f4)]=null;}}async function _0x26a634(_0x11e918){const _0x450728=_0x41eae2,_0x35ca46=_0x5b873d['apiConfig']['secondaryProxyUrl']&&_0x5b873d['apiConfig']['secondaryApiKey']&&_0x5b873d[_0x450728(0x30d)]['secondaryModel'],{proxyUrl:_0x4f006f,apiKey:_0x489c04,model:_0x1389f5}=_0x35ca46?{'proxyUrl':_0x5b873d[_0x450728(0x30d)][_0x450728(0x989)],'apiKey':_0x5b873d[_0x450728(0x30d)][_0x450728(0x2cf)],'model':_0x5b873d[_0x450728(0x30d)][_0x450728(0x10f0)]}:_0x5b873d[_0x450728(0x30d)];if(!_0x4f006f||!_0x489c04||!_0x1389f5)throw new Error(_0x450728(0x981));const _0x594fc5=_0x450728(0xf4a);let _0x536da6=_0x4f006f[_0x450728(0xced)]('generativelanguage'),_0x38f7c9;if(_0x536da6){const _0x4ce876=_0x11e918[_0x450728(0x86c)](/^data:(.*);base64/)[0x1],_0x39f1e1=_0x11e918[_0x450728(0x55b)](',')[0x1],_0x40a994={'contents':[{'parts':[{'text':_0x594fc5},{'inline_data':{'mime_type':_0x4ce876,'data':_0x39f1e1}}]}]};_0x38f7c9=await fetch(_0x4f006f+'/'+_0x1389f5+_0x450728(0x3cf)+_0x489c04,{'method':_0x450728(0xd14),'headers':{'Content-Type':'application/json'},'body':JSON[_0x450728(0x465)](_0x40a994)});}else{const _0x2ac243={'model':_0x1389f5,'messages':[{'role':_0x450728(0x116c),'content':[{'type':_0x450728(0xec9),'text':_0x594fc5},{'type':_0x450728(0xcad),'image_url':{'url':_0x11e918}}]}],'max_tokens':0x32};_0x38f7c9=await fetch(_0x4f006f+'/v1/chat/completions',{'method':_0x450728(0xd14),'headers':{'Content-Type':_0x450728(0xce4),'Authorization':_0x450728(0x3fb)+_0x489c04},'body':JSON[_0x450728(0x465)](_0x2ac243)});}if(!_0x38f7c9['ok']){const _0x358fe6=await _0x38f7c9[_0x450728(0x6b5)]();throw new Error(_0x450728(0x10d8)+_0x358fe6['error'][_0x450728(0x1288)]);}const _0x1b8b7b=await _0x38f7c9['json']();let _0x1990a0=_0x536da6?getGeminiResponseText(_0x1b8b7b):_0x1b8b7b[_0x450728(0xd3b)][0x0][_0x450728(0x1288)][_0x450728(0x28c)];return _0x1990a0[_0x450728(0xc3a)]()[_0x450728(0xfbf)](/["'“”‘’]/g,'');}async function _0x52ccfe(_0x53f576){const _0x4ecc5d=_0x41eae2;if(!_0x53f576||_0x53f576[_0x4ecc5d(0x58c)]){console[_0x4ecc5d(0xac3)](_0x4ecc5d(0x10fd));return;}const _0x2b3a4a=_0x53f576['id'],_0x2d3b12=_0x53f576[_0x4ecc5d(0xf74)],_0x14b789=_0x53f576[_0x4ecc5d(0x1045)];console['log'](_0x4ecc5d(0xf88)+_0x2b3a4a+_0x4ecc5d(0x2c8));for(const _0x53eb in _0x5b873d[_0x4ecc5d(0x667)]){const _0x2ee0cb=_0x5b873d[_0x4ecc5d(0x667)][_0x53eb];if(_0x2ee0cb[_0x4ecc5d(0x58c)]&&_0x2ee0cb[_0x4ecc5d(0x5ab)]){const _0x1dd91d=_0x2ee0cb[_0x4ecc5d(0x5ab)][_0x4ecc5d(0x12f4)](_0x4c7b13=>_0x4c7b13['id']===_0x2b3a4a);if(_0x1dd91d){let _0x3a5867=![];_0x1dd91d['groupNickname']!==_0x2d3b12&&(_0x1dd91d['groupNickname']=_0x2d3b12,_0x3a5867=!![]),_0x1dd91d[_0x4ecc5d(0x1045)]!==_0x14b789&&(_0x1dd91d[_0x4ecc5d(0x1045)]=_0x14b789,_0x3a5867=!![]),_0x3a5867&&(await _0x1a6951[_0x4ecc5d(0x667)]['put'](_0x2ee0cb),console[_0x4ecc5d(0x471)](_0x4ecc5d(0x3ef)+_0x2ee0cb[_0x4ecc5d(0xf74)]+_0x4ecc5d(0x10db)));}}}}async function _0x2f6a63(_0x363ae6){const _0x2f27c7=_0x41eae2;if(!_0x363ae6||_0x363ae6[_0x2f27c7(0x58c)]){console[_0x2f27c7(0xac3)](_0x2f27c7(0x5c3));return;}const _0x572f43=_0x363ae6['id'],_0xe007df=_0x363ae6[_0x2f27c7(0xdb9)][_0x2f27c7(0xdd3)];console['log'](_0x2f27c7(0xf88)+_0x572f43+_0x2f27c7(0xcbc));for(const _0x3f069e of Object[_0x2f27c7(0x4b5)](_0x5b873d[_0x2f27c7(0x667)])){if(_0x3f069e[_0x2f27c7(0x58c)]&&_0x3f069e[_0x2f27c7(0x5ab)]){const _0x5b235f=_0x3f069e[_0x2f27c7(0x5ab)][_0x2f27c7(0x12f4)](_0x128ad1=>_0x128ad1['id']===_0x572f43);_0x5b235f&&_0x5b235f['avatar']!==_0xe007df&&(_0x5b235f[_0x2f27c7(0x12c8)]=_0xe007df,await _0x1a6951[_0x2f27c7(0x667)][_0x2f27c7(0xc0f)](_0x3f069e),console[_0x2f27c7(0x471)]('成功将角色\x20'+_0x572f43+'\x20的新头像同步到群聊\x20\x22'+_0x3f069e['name']+'\x22'));}}}function _0xb9963e(_0x5af8c5,_0x18016d){const _0xb165a9=_0x41eae2;if(!_0x5af8c5||!_0x5af8c5[_0xb165a9(0x58c)]||!_0x18016d)return _0x18016d;const _0x3fce78=_0x5b873d[_0xb165a9(0x5c1)][_0xb165a9(0x22a)]||_0xb165a9(0x1285);if(_0x18016d===_0x3fce78)return _0x5af8c5[_0xb165a9(0xdb9)][_0xb165a9(0xc48)]||'我';const _0x5a1822=_0x5af8c5[_0xb165a9(0x5ab)][_0xb165a9(0x12f4)](_0x3288ae=>_0x3288ae[_0xb165a9(0x1045)]===_0x18016d);return _0x5a1822?_0x5a1822[_0xb165a9(0x7da)]:_0x18016d;}function _0x2bfca0(_0x49a7e9){const _0x38c0cc=_0x41eae2;document['querySelectorAll'](_0x38c0cc(0x124c))['forEach'](_0x34da01=>{const _0xf34f6c=_0x38c0cc;_0x34da01['classList'][_0xf34f6c(0x73b)](_0xf34f6c(0x8ea),_0x34da01[_0xf34f6c(0xaaf)][_0xf34f6c(0xcb1)]===_0x49a7e9);}),document[_0x38c0cc(0x35f)](_0x38c0cc(0x242))[_0x38c0cc(0xd9a)](_0x337865=>{const _0x14812f=_0x38c0cc;_0x337865[_0x14812f(0x2f1)][_0x14812f(0x73b)](_0x14812f(0x8ea),_0x337865[_0x14812f(0xaaf)][_0x14812f(0xcb1)]===_0x49a7e9);});}function _0x471a37(_0x2e363b){const _0x12dde6=_0x41eae2;if(!_0x2e363b)return'';if(_0x5b873d[_0x12dde6(0x5c1)]&&_0x2e363b===_0x5b873d['qzoneSettings'][_0x12dde6(0x22a)])return _0x5b873d[_0x12dde6(0x5c1)][_0x12dde6(0x22a)];let _0x2100e9=Object[_0x12dde6(0x4b5)](_0x5b873d[_0x12dde6(0x667)])[_0x12dde6(0x12f4)](_0xdae69=>!_0xdae69[_0x12dde6(0x58c)]&&_0xdae69[_0x12dde6(0x1045)]===_0x2e363b);if(_0x2100e9)return _0x2100e9[_0x12dde6(0xf74)];_0x2100e9=Object['values'](_0x5b873d[_0x12dde6(0x667)])[_0x12dde6(0x12f4)](_0x4e691b=>!_0x4e691b[_0x12dde6(0x58c)]&&(_0x4e691b['nameHistory']&&_0x4e691b['nameHistory'][_0x12dde6(0xced)](_0x2e363b)));if(_0x2100e9)return _0x2100e9[_0x12dde6(0xf74)];return _0x2e363b;}function _0x401262(_0x223b42,_0x2b13e7=null){const _0x56a554=_0x41eae2;if(!_0x223b42||typeof _0x223b42!=='string'||!_0x223b42[_0x56a554(0xced)]('@[['))return _0x223b42;return _0x223b42[_0x56a554(0xfbf)](/@\[\[([^\]]+)\]\]/g,(_0x36222d,_0x438110)=>{const _0x63ff17=_0x56a554,_0x21a813=_0x438110[_0x63ff17(0xc3a)]();let _0x506be9;return _0x2b13e7&&_0x2b13e7[_0x63ff17(0x58c)]?_0x506be9=_0xb9963e(_0x2b13e7,_0x21a813):_0x506be9=_0x471a37(_0x21a813),'@'+_0x506be9;});}function _0x4e2abc(_0x5b6b68,_0xc1dbb2,_0x2015cd={}){return new Promise(_0xd4a979=>{const _0x1294eb=_0x356e;_0x40cb03=_0xd4a979,_0x5c11ab['textContent']=_0x5b6b68,_0x1bafb7[_0x1294eb(0x1ef)]=_0x1294eb(0x131d)+_0xc1dbb2+'</p>';const _0x38a5a5=document['getElementById'](_0x1294eb(0x61a)),_0x2077d7=document[_0x1294eb(0x89d)](_0x1294eb(0x39d));_0x2077d7[_0x1294eb(0x68e)]['display']='block',_0x38a5a5['textContent']=_0x2015cd[_0x1294eb(0x640)]||'确定',_0x2077d7[_0x1294eb(0xf12)]=_0x2015cd[_0x1294eb(0x777)]||'取消',_0x2015cd[_0x1294eb(0xf73)]?_0x38a5a5[_0x1294eb(0x2f1)][_0x1294eb(0x569)](_0x2015cd[_0x1294eb(0xf73)]):_0x38a5a5['classList']['remove']('btn-danger'),_0x38a5a5['onclick']=()=>{_0xd4a979(!![]),_0x1ff3b5();},_0x2077d7[_0x1294eb(0x108b)]=()=>{_0xd4a979(![]),_0x1ff3b5();},_0x24ce2c();});}function _0x532f76(_0x5a2488,_0x3e4507){return new Promise(_0x56eaf8=>{const _0x39a5e7=_0x356e;_0x40cb03=_0x56eaf8,_0x5c11ab[_0x39a5e7(0xf12)]=_0x5a2488,_0x1bafb7[_0x39a5e7(0x1ef)]=_0x39a5e7(0x118c)+_0x3e4507+_0x39a5e7(0x164);const _0xff8cf4=document[_0x39a5e7(0x89d)]('custom-modal-confirm'),_0x2ffbe8=document[_0x39a5e7(0x89d)](_0x39a5e7(0x39d));_0x2ffbe8[_0x39a5e7(0x68e)][_0x39a5e7(0x126b)]=_0x39a5e7(0x10f2),_0xff8cf4[_0x39a5e7(0xf12)]='好的',_0xff8cf4['onclick']=()=>{const _0x599e7a=_0x39a5e7;_0x2ffbe8['style'][_0x599e7a(0x126b)]='block',_0xff8cf4['textContent']='确定',_0x56eaf8(!![]),_0x1ff3b5();},_0x24ce2c();});}function _0x34d246(_0x8ee5c4,_0x540e4f,_0x187f60='',_0x3d5533=_0x41eae2(0xec9),_0x58c426=''){return new Promise(_0x5447c8=>{const _0x3ab880=_0x356e;_0x40cb03=_0x5447c8,_0x5c11ab['textContent']=_0x8ee5c4;const _0x1411fc='custom-prompt-input',_0x54413e=_0x3d5533===_0x3ab880(0x11b9)?_0x3ab880(0x1110)+_0x1411fc+_0x3ab880(0xa7d)+_0x540e4f+'\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>'+_0x187f60+_0x3ab880(0xce6):_0x3ab880(0x2e9)+_0x3d5533+_0x3ab880(0xd59)+_0x1411fc+_0x3ab880(0xa7d)+_0x540e4f+_0x3ab880(0x2eb)+_0x187f60+'\x22>';_0x1bafb7[_0x3ab880(0x1ef)]=_0x58c426+_0x54413e;const _0x17434c=document[_0x3ab880(0x89d)](_0x1411fc);_0x1bafb7[_0x3ab880(0x35f)](_0x3ab880(0xbee))[_0x3ab880(0xd9a)](_0x528c75=>{const _0x2b7ce7=_0x3ab880;_0x528c75[_0x2b7ce7(0x1193)](_0x2b7ce7(0x12a5),()=>{const _0xe0f39b=_0x2b7ce7,_0x2c3588=_0x528c75[_0xe0f39b(0xaaf)][_0xe0f39b(0x196)];if(_0x2c3588)try{const _0xcd2c20=JSON[_0xe0f39b(0x2cb)](_0x2c3588);_0x17434c[_0xe0f39b(0x2f4)]=JSON[_0xe0f39b(0x465)](_0xcd2c20,null,0x2),_0x17434c[_0xe0f39b(0xbf6)]();}catch(_0x130265){console[_0xe0f39b(0x1fd)](_0xe0f39b(0x2ed),_0x130265);}});});const _0xe32d23=document[_0x3ab880(0x89d)](_0x3ab880(0x61a)),_0x5800a0=document['getElementById']('custom-modal-cancel');_0xe32d23['onclick']=()=>{const _0x472588=_0x3ab880;_0x5447c8(_0x17434c[_0x472588(0x2f4)]),_0x1ff3b5();},_0x5800a0['onclick']=()=>{_0x5447c8(null),_0x1ff3b5();},_0x24ce2c(),setTimeout(()=>_0x17434c[_0x3ab880(0xbf6)](),0x64);});}function _0x4d923b(_0x3a73b1,_0x2de8a9){return new Promise(_0x20929a=>{const _0x5ea6fe=_0x356e,_0x1d6932=document['getElementById'](_0x5ea6fe(0xd96)),_0x3c04cb=document[_0x5ea6fe(0x89d)](_0x5ea6fe(0x11c6)),_0x1a5ee2=document[_0x5ea6fe(0x89d)](_0x5ea6fe(0x271)),_0x469ca5=document['querySelector'](_0x5ea6fe(0x696));_0x3c04cb[_0x5ea6fe(0xf12)]=_0x3a73b1,_0x1a5ee2[_0x5ea6fe(0x1ef)]='',_0x469ca5[_0x5ea6fe(0x1ef)]='',_0x469ca5['style']['flexDirection']=_0x5ea6fe(0xac2),_0x2de8a9[_0x5ea6fe(0xd9a)](_0x644807=>{const _0x415059=_0x5ea6fe,_0x2efd09=document['createElement']('button');_0x2efd09[_0x415059(0xf12)]=_0x644807[_0x415059(0xec9)],_0x2efd09[_0x415059(0x108b)]=()=>{const _0x3ef40a=_0x415059;_0x1d6932[_0x3ef40a(0x2f1)][_0x3ef40a(0x1247)](_0x3ef40a(0x11e4)),_0x20929a(_0x644807[_0x3ef40a(0x2f4)]);},_0x469ca5[_0x415059(0x22f)](_0x2efd09);});const _0x20aa9f=document['createElement'](_0x5ea6fe(0x5af));_0x20aa9f[_0x5ea6fe(0xf12)]='取消',_0x20aa9f['style'][_0x5ea6fe(0x3b5)]=_0x5ea6fe(0xd57),_0x20aa9f[_0x5ea6fe(0x68e)]['borderRadius']='8px',_0x20aa9f[_0x5ea6fe(0x68e)]['backgroundColor']='#f0f0f0',_0x20aa9f[_0x5ea6fe(0x108b)]=()=>{const _0x144855=_0x5ea6fe;_0x1d6932[_0x144855(0x2f1)][_0x144855(0x1247)]('visible'),_0x20929a(null);},_0x469ca5[_0x5ea6fe(0x22f)](_0x20aa9f),_0x1d6932[_0x5ea6fe(0x2f1)]['add']('visible');})['finally'](()=>{const _0x523323=_0x356e,_0xf5a0d=document[_0x523323(0xd16)](_0x523323(0x696));_0xf5a0d['style'][_0x523323(0x8c4)]=_0x523323(0xb6f),_0xf5a0d[_0x523323(0x1ef)]=_0x523323(0xb07),document[_0x523323(0x89d)](_0x523323(0x39d))[_0x523323(0x1193)](_0x523323(0x12a5),_0x1ff3b5);});}async function _0x5e8d5a(){const _0x197826=_0x41eae2,_0x21f3de=await _0x4d923b('选择歌词导入方式',[{'text':_0x197826(0xcb2),'value':_0x197826(0x455)},{'text':_0x197826(0x534),'value':'paste'}]);if(_0x21f3de===_0x197826(0x455))return new Promise(_0xf8b819=>{const _0x90bc51=_0x197826,_0x4010b1=document[_0x90bc51(0x89d)]('lrc-upload-input'),_0x6e3474=_0x43c6b7=>{const _0x1704e0=_0x90bc51,_0x183710=_0x43c6b7['target']['files'][0x0];if(_0x183710){const _0x5c5cb3=new FileReader();_0x5c5cb3[_0x1704e0(0x736)]=_0x106960=>_0xf8b819(_0x106960['target'][_0x1704e0(0x9dc)]),_0x5c5cb3[_0x1704e0(0x1010)]=()=>_0xf8b819(''),_0x5c5cb3['readAsText'](_0x183710);}else _0xf8b819(null);_0x4010b1[_0x1704e0(0xcbb)]('change',_0x6e3474),_0x4010b1[_0x1704e0(0x2f4)]='';};_0x4010b1[_0x90bc51(0x1193)]('change',_0x6e3474,{'once':!![]}),_0x4010b1['click']();});else{if(_0x21f3de===_0x197826(0xf5f)){const _0x2aae32=await _0x34d246(_0x197826(0x5b1),'请在此处粘贴完整的LRC格式歌词...','','textarea');if(_0x2aae32){const _0x592453=_0x2aae32[_0x197826(0xfbf)](/\[/g,'\x0a[')['trim']();return _0x592453;}return _0x2aae32;}else return null;}}_0x1a6951[_0x41eae2(0xd8d)](0x27)[_0x41eae2(0x442)]({'doubanPosts':'++id,\x20timestamp','chats':_0x41eae2(0x2b8),'apiConfig':_0x41eae2(0x121e),'globalSettings':_0x41eae2(0x101c),'userStickers':_0x41eae2(0xf28),'worldBooks':_0x41eae2(0x25a),'worldBookCategories':'++id,\x20name','musicLibrary':_0x41eae2(0x101c),'personaPresets':_0x41eae2(0x101c),'qzoneSettings':_0x41eae2(0x101c),'qzonePosts':_0x41eae2(0x1030),'qzoneAlbums':'++id,\x20name,\x20createdAt','qzonePhotos':_0x41eae2(0xe9a),'favorites':_0x41eae2(0xb73),'qzoneGroups':_0x41eae2(0x1138),'memories':_0x41eae2(0xc38),'callRecords':_0x41eae2(0x19f),'shoppingProducts':_0x41eae2(0xf8c),'shoppingCategories':'++id,\x20name','apiPresets':_0x41eae2(0x1138),'renderingRules':'++id,\x20name,\x20chatId','appearancePresets':_0x41eae2(0xfdd),'stickerCategories':_0x41eae2(0x1138),'customAvatarFrames':'++id,\x20name','presets':_0x41eae2(0x25a),'presetCategories':'++id,\x20name','readingLibrary':_0x41eae2(0xd13),'npcs':_0x41eae2(0x1345)})[_0x41eae2(0x33a)](_0x54ef3a=>{const _0x3efa73=_0x41eae2;return _0x54ef3a[_0x3efa73(0x10b6)]('worldBooks')[_0x3efa73(0x779)]()[_0x3efa73(0x6aa)](_0x4b0ce8=>{const _0x13d7c8=_0x3efa73;if(typeof _0x4b0ce8['content']===_0x13d7c8(0x1224)&&_0x4b0ce8[_0x13d7c8(0x28c)][_0x13d7c8(0xc3a)]()!=='')_0x4b0ce8[_0x13d7c8(0x28c)]=[{'keys':[],'comment':'从旧版本迁移的条目','content':_0x4b0ce8[_0x13d7c8(0x28c)]}];else!Array['isArray'](_0x4b0ce8['content'])&&(_0x4b0ce8[_0x13d7c8(0x28c)]=[]);_0x4b0ce8[_0x13d7c8(0x28c)]['forEach'](_0x19d9f9=>{const _0x1890d5=_0x13d7c8;typeof _0x19d9f9['enabled']===_0x1890d5(0x1bf)&&(_0x19d9f9[_0x1890d5(0x104e)]=!![]);});});}),window['db']=_0x1a6951;function _0x4e6c15(_0x33e6c9){const _0x178aa8=_0x41eae2;_0x33e6c9==='chat-list-screen'&&(window[_0x178aa8(0x9db)](),_0x17a49c(_0x178aa8(0x11ac)));if(_0x33e6c9===_0x178aa8(0x853))window['renderApiSettingsProxy']();if(_0x33e6c9==='wallpaper-screen')window[_0x178aa8(0x950)]();if(_0x33e6c9===_0x178aa8(0x57e))window['renderWorldBookScreenProxy']();if(_0x33e6c9===_0x178aa8(0x93e))window[_0x178aa8(0x9f5)]();if(_0x33e6c9===_0x178aa8(0x111b))_0x2c6452();document[_0x178aa8(0x35f)]('.screen')[_0x178aa8(0xd9a)](_0x151931=>_0x151931['classList'][_0x178aa8(0x1247)](_0x178aa8(0x8ea)));const _0x237b2f=document['getElementById'](_0x33e6c9);if(_0x237b2f)_0x237b2f[_0x178aa8(0x2f1)][_0x178aa8(0x569)](_0x178aa8(0x8ea));if(_0x33e6c9===_0x178aa8(0x87f))window['updateListenTogetherIconProxy'](_0x5b873d[_0x178aa8(0xf96)]);_0x33e6c9===_0x178aa8(0x1051)&&(_0x2a4748(),document[_0x178aa8(0x89d)](_0x178aa8(0x7eb))['value']=_0x5b873d[_0x178aa8(0x21a)][_0x178aa8(0x268)]||'',_0x3866c6(_0x5b873d[_0x178aa8(0x21a)]['fontUrl']||'',!![]));}window[_0x41eae2(0xbd7)]=()=>{};function _0x17a49c(_0x1e678d){const _0x119b8d=_0x41eae2,_0x57880e=document[_0x119b8d(0x89d)](_0x119b8d(0x11b7)),_0x1b7baa={'messages-view':document[_0x119b8d(0x89d)]('messages-view'),'qzone-screen':document[_0x119b8d(0x89d)]('qzone-screen'),'favorites-view':document[_0x119b8d(0x89d)](_0x119b8d(0x12fc)),'memories-view':document['getElementById'](_0x119b8d(0x340)),'npc-list-view':document[_0x119b8d(0x89d)](_0x119b8d(0xd20))},_0x419009=document[_0x119b8d(0x89d)](_0x119b8d(0x6b6)),_0x1e3c93=document[_0x119b8d(0x89d)](_0x119b8d(0x73c));_0x57e987&&document[_0x119b8d(0x89d)](_0x119b8d(0x466))[_0x119b8d(0x12a5)]();Object['values'](_0x1b7baa)[_0x119b8d(0xd9a)](_0x5de129=>_0x5de129[_0x119b8d(0x2f1)][_0x119b8d(0x1247)]('active'));_0x1b7baa[_0x1e678d]&&_0x1b7baa[_0x1e678d][_0x119b8d(0x2f1)][_0x119b8d(0x569)](_0x119b8d(0x8ea));document[_0x119b8d(0x35f)](_0x119b8d(0x515))['forEach'](_0x1b9dbb=>{const _0x3639cc=_0x119b8d;_0x1b9dbb[_0x3639cc(0x2f1)][_0x3639cc(0x73b)](_0x3639cc(0x8ea),_0x1b9dbb[_0x3639cc(0xaaf)][_0x3639cc(0x897)]===_0x1e678d);});_0x1e678d==='messages-view'?(_0x419009[_0x119b8d(0x68e)][_0x119b8d(0x126b)]=_0x119b8d(0x66e),_0x1e3c93['style'][_0x119b8d(0x126b)]=_0x119b8d(0x66e)):(_0x419009[_0x119b8d(0x68e)][_0x119b8d(0x126b)]=_0x119b8d(0x10f2),_0x1e3c93[_0x119b8d(0x68e)][_0x119b8d(0x126b)]='none');_0x1e678d!==_0x119b8d(0x340)&&(_0x477f8e[_0x119b8d(0xd9a)](_0x17dc97=>clearInterval(_0x17dc97)),_0x477f8e=[]);switch(_0x1e678d){case _0x119b8d(0x47b):_0x1b7baa[_0x119b8d(0x47b)][_0x119b8d(0x68e)]['backgroundColor']=_0x119b8d(0x1022),_0x3cd1c0(0x0),_0x31bd17(),_0x155816();break;case'favorites-view':_0x1b7baa[_0x119b8d(0x12fc)][_0x119b8d(0x68e)][_0x119b8d(0x96c)]='#f9f9f9',_0x2e7944();break;case'messages-view':break;case _0x119b8d(0xd20):_0x32c7e8();break;}}function _0x238382(){const _0x4d2fc3=_0x41eae2;console[_0x4d2fc3(0x471)](_0x4d2fc3(0x10bf));}window['renderXSocialScreenProxy']=_0x238382;function _0x31bd17(){const _0x1132c3=_0x41eae2;if(_0x5b873d&&_0x5b873d['qzoneSettings']){const _0x3f019b=_0x5b873d['qzoneSettings'];document[_0x1132c3(0x89d)](_0x1132c3(0xe06))[_0x1132c3(0xf12)]=_0x3f019b[_0x1132c3(0x22a)],document[_0x1132c3(0x89d)](_0x1132c3(0x12f7))[_0x1132c3(0x9e3)]=_0x3f019b['avatar'],document[_0x1132c3(0x89d)](_0x1132c3(0x7a3))[_0x1132c3(0x9e3)]=_0x3f019b['banner'];}}window[_0x41eae2(0x546)]=_0x31bd17;async function _0x338aea(){const _0x3a4b8a=_0x41eae2;_0x1a6951&&_0x5b873d['qzoneSettings']&&await _0x1a6951[_0x3a4b8a(0x5c1)][_0x3a4b8a(0xc0f)](_0x5b873d[_0x3a4b8a(0x5c1)]);}function _0x3ddcc5(_0x2a0fcc){const _0x221731=_0x41eae2;if(!_0x2a0fcc)return'';const _0x5557a9=new Date(),_0x57d939=new Date(_0x2a0fcc),_0x5c7aea=Math[_0x221731(0x128a)]((_0x5557a9-_0x57d939)/0x3e8),_0xda8082=Math[_0x221731(0x128a)](_0x5c7aea/0x3c),_0x481c55=Math['floor'](_0xda8082/0x3c);if(_0xda8082<0x1)return'刚刚';if(_0xda8082<0x3c)return _0xda8082+_0x221731(0x137c);if(_0x481c55<0x18)return _0x481c55+'小时前';const _0x20bad3=_0x57d939[_0x221731(0x555)](),_0x1e9ffa=String(_0x57d939[_0x221731(0x86f)]()+0x1)[_0x221731(0x4d8)](0x2,'0'),_0x5daab3=String(_0x57d939[_0x221731(0x518)]())[_0x221731(0x4d8)](0x2,'0'),_0x546c27=String(_0x57d939[_0x221731(0x9bb)]())[_0x221731(0x4d8)](0x2,'0'),_0x536959=String(_0x57d939[_0x221731(0x446)]())['padStart'](0x2,'0');return _0x5557a9['getFullYear']()===_0x20bad3?_0x1e9ffa+'-'+_0x5daab3+'\x20'+_0x546c27+':'+_0x536959:_0x20bad3+'-'+_0x1e9ffa+'-'+_0x5daab3+'\x20'+_0x546c27+':'+_0x536959;}function _0x1aca28(_0x3a3b53){const _0x5b1386=_0x41eae2,_0x767e51=document[_0x5b1386(0xd16)](_0x5b1386(0x10da)+_0x3a3b53['id']+'\x22]'),_0x468b9=!!_0x767e51,_0x75f938=_0x468b9?_0x767e51:document[_0x5b1386(0x285)]('div');!_0x468b9&&(_0x75f938[_0x5b1386(0x81c)]=_0x5b1386(0x4c3),_0x75f938[_0x5b1386(0xaaf)][_0x5b1386(0x7b6)]=_0x3a3b53['id']);const _0x14cf57=_0x468b9?_0x75f938[_0x5b1386(0xd16)](_0x5b1386(0xcca)):document[_0x5b1386(0x285)](_0x5b1386(0xb25));!_0x468b9&&(_0x14cf57[_0x5b1386(0x81c)]=_0x5b1386(0xb5a));let _0x1c4221='',_0x3b3030='',_0x4d0a96=_0x5b873d[_0x5b1386(0x5c1)][_0x5b1386(0x12c8)];if(_0x3a3b53[_0x5b1386(0xc3f)]==='user')_0x1c4221=_0x5b873d['qzoneSettings'][_0x5b1386(0x12c8)],_0x3b3030=_0x5b873d[_0x5b1386(0x5c1)][_0x5b1386(0x22a)];else{if(_0x5b873d['chats'][_0x3a3b53[_0x5b1386(0xc3f)]]){const _0x3242df=_0x5b873d['chats'][_0x3a3b53[_0x5b1386(0xc3f)]];_0x1c4221=_0x3242df[_0x5b1386(0xdb9)][_0x5b1386(0xdd3)]||_0x265fcc,_0x3b3030=_0x3242df[_0x5b1386(0xf74)];}else _0x3b3030=_0x471a37(_0x3a3b53['authorOriginalName']),_0x1c4221=_0x265fcc;}function _0x42bb5a(_0x4b33ee){const _0x516981=_0x5b1386;let _0x44022f='';const _0xae8c9f=_0x4b33ee['publicText']?_0x516981(0x968)+_0x55b8e7(_0x4b33ee[_0x516981(0x957)])['replace'](/\n/g,'<br>')+_0x516981(0xc57):'';if(_0x4b33ee[_0x516981(0x48c)]===_0x516981(0x536))_0x44022f=_0x516981(0x134b)+_0x55b8e7(_0x4b33ee[_0x516981(0x28c)])['replace'](/\n/g,_0x516981(0x962))+_0x516981(0xc57);else{if(_0x4b33ee[_0x516981(0x48c)]===_0x516981(0xe70)&&_0x4b33ee[_0x516981(0x450)])_0x44022f=_0xae8c9f?_0xae8c9f+_0x516981(0x299)+_0x4b33ee[_0x516981(0x450)]+'\x22\x20class=\x22chat-image\x22></div>':_0x516981(0x477)+_0x4b33ee[_0x516981(0x450)]+'\x22\x20class=\x22chat-image\x22>';else{if(_0x4b33ee[_0x516981(0x48c)]===_0x516981(0x574)){const _0x54adc9=_0x5b873d[_0x516981(0x21a)]['enableAiDrawing']&&_0x4b33ee[_0x516981(0x895)]?'https://image.pollinations.ai/prompt/'+_0x4b33ee[_0x516981(0x895)]:_0x516981(0xd91);_0x44022f=_0xae8c9f?_0xae8c9f+_0x516981(0x299)+_0x54adc9+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x4b33ee[_0x516981(0x132c)]+_0x516981(0x2d9):_0x516981(0x477)+_0x54adc9+_0x516981(0xcab)+_0x4b33ee['hiddenContent']+'\x22>';}else{if(_0x4b33ee[_0x516981(0x48c)]===_0x516981(0x1289)){const _0x5bf0b8=_0x4b33ee[_0x516981(0x930)]||(_0x4b33ee[_0x516981(0x450)]?[_0x4b33ee[_0x516981(0x450)]]:[]);if(_0x5bf0b8[_0x516981(0x7aa)]>0x0){const _0x203142=_0x5bf0b8[_0x516981(0x7aa)];let _0x5e8ac6='';_0x5e8ac6='<div\x20class=\x22post-images-grid\x20grid-'+_0x203142+'\x22>',_0x5bf0b8[_0x516981(0xd9a)]((_0x2998d9,_0x278fcc)=>{const _0x5416c0=_0x516981;_0x5e8ac6+='<img\x20src=\x22'+_0x2998d9+_0x5416c0(0x9c1)+(_0x278fcc+0x1)+_0x5416c0(0x1013);}),_0x5e8ac6+=_0x516981(0xc57),_0x44022f=_0xae8c9f?''+_0xae8c9f+_0x5e8ac6:_0x5e8ac6;}}else{if(_0x4b33ee[_0x516981(0x48c)]===_0x516981(0x88f)){const _0x4b0bc6=_0x4b33ee[_0x516981(0x930)]||(_0x4b33ee[_0x516981(0x450)]?[_0x4b33ee[_0x516981(0x450)]]:[]);if(_0x4b0bc6[_0x516981(0x7aa)]>0x0){const _0x32e0f8=_0x4b0bc6['length'];let _0x1913c8='';_0x1913c8=_0x516981(0x1d1)+_0x32e0f8+'\x22>',_0x4b0bc6[_0x516981(0xd9a)]((_0x374a0b,_0x5d0a73)=>{const _0x44c6aa=_0x516981;_0x1913c8+=_0x44c6aa(0x477)+_0x374a0b+_0x44c6aa(0x1165)+(_0x5d0a73+0x1)+_0x44c6aa(0x1013);}),_0x1913c8+=_0x516981(0xc57),_0x44022f=_0xae8c9f?''+_0xae8c9f+_0x1913c8:_0x1913c8;}}}}}}return _0x44022f;}let _0x2b4760;if(_0x3a3b53[_0x5b1386(0x48c)]==='repost'){const _0x3b4e3a=_0x3a3b53[_0x5b1386(0x629)]?_0x5b1386(0x968)+_0x55b8e7(_0x3a3b53['repostComment'])['replace'](/\n/g,'<br>')+'</div>':'';let _0x3b7290=_0x265fcc,_0x2aff6f=_0x5b1386(0xe11);if(_0x3a3b53[_0x5b1386(0x1c9)][_0x5b1386(0xc3f)]===_0x5b1386(0x116c))_0x3b7290=_0x5b873d[_0x5b1386(0x5c1)][_0x5b1386(0x12c8)],_0x2aff6f=_0x5b873d['qzoneSettings'][_0x5b1386(0x22a)];else{const _0x161c36=_0x5b873d[_0x5b1386(0x667)][_0x3a3b53[_0x5b1386(0x1c9)][_0x5b1386(0xc3f)]];_0x161c36&&(_0x3b7290=_0x161c36['settings'][_0x5b1386(0xdd3)]||_0x265fcc),_0x2aff6f=_0x471a37(_0x3a3b53[_0x5b1386(0x1c9)]['authorOriginalName']);}_0x2b4760='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3b4e3a+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3b7290+_0x5b1386(0x30c)+_0x2aff6f+_0x5b1386(0x7bc)+_0x3ddcc5(_0x3a3b53[_0x5b1386(0x1c9)][_0x5b1386(0x114e)])+_0x5b1386(0x8a9)+_0x42bb5a(_0x3a3b53[_0x5b1386(0x1c9)])+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}else _0x2b4760=_0x5b1386(0x500)+_0x42bb5a(_0x3a3b53)+'</div>';let _0x4b5e80='';if(_0x3a3b53[_0x5b1386(0xfe6)]&&_0x3a3b53[_0x5b1386(0xfe6)][_0x5b1386(0x7aa)]>0x0){const _0x5ea0a6=_0x3a3b53[_0x5b1386(0xfe6)][_0x5b1386(0x412)](_0x311e79=>_0x471a37(_0x311e79))[_0x5b1386(0x1237)]('、');_0x4b5e80='<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>'+_0x5ea0a6+'\x20觉得很赞</span></div>';}let _0x3858dc='';_0x3a3b53[_0x5b1386(0x1157)]&&_0x3a3b53[_0x5b1386(0x1157)][_0x5b1386(0x7aa)]>0x0&&(_0x3858dc=_0x5b1386(0x9bc),_0x3a3b53[_0x5b1386(0x1157)][_0x5b1386(0xd9a)]((_0x3daaf4,_0x4a60bf)=>{const _0x1e05e1=_0x5b1386;if(typeof _0x3daaf4==='object'&&_0x3daaf4!==null&&_0x3daaf4['commenterName']){const _0x527137=_0x3daaf4['commenterName'],_0x465231=_0x471a37(_0x527137);let _0x247e35;_0x3b71b1['test'](_0x3daaf4['text'])?_0x247e35='<img\x20src=\x22'+_0x3daaf4['text']+_0x1e05e1(0x82d):_0x247e35=_0x55b8e7(_0x3daaf4['text']);let _0x50b1cc='';if(_0x3daaf4['replyTo']){const _0xfa06f7=_0x471a37(_0x3daaf4[_0x1e05e1(0x8e7)]);_0x50b1cc=_0x1e05e1(0x134f)+_0x465231+_0x1e05e1(0x318)+_0xfa06f7+_0x1e05e1(0x601)+_0x247e35;}else _0x50b1cc=_0x1e05e1(0x134f)+_0x465231+_0x1e05e1(0x601)+_0x247e35;_0x3858dc+=_0x1e05e1(0x1da)+_0x3a3b53['id']+_0x1e05e1(0x61f)+_0x527137+_0x1e05e1(0x673)+_0x465231+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>'+_0x50b1cc+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22'+_0x4a60bf+_0x1e05e1(0x217);}else _0x3858dc+=_0x1e05e1(0x6c4)+_0x55b8e7(String(_0x3daaf4))+_0x1e05e1(0x11f4);}),_0x3858dc+='</div>');const _0x24a54a=_0x5b873d[_0x5b1386(0x5c1)][_0x5b1386(0x22a)],_0x3571fc=_0x3a3b53[_0x5b1386(0xfe6)]&&_0x3a3b53[_0x5b1386(0xfe6)]['includes'](_0x24a54a),_0x222c56=_0x5b873d[_0x5b1386(0x1144)]&&_0x5b873d[_0x5b1386(0x1144)][_0x5b1386(0xa14)](_0x3a3b53['id']);let _0x273fe4='';_0x3a3b53[_0x5b1386(0x48c)]!==_0x5b1386(0xb95)&&(_0x273fe4=_0x5b1386(0x109e));_0x14cf57['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x1c4221+_0x5b1386(0x29e)+_0x3a3b53[_0x5b1386(0xc3f)]+_0x5b1386(0x7ef)+_0x3b3030+_0x5b1386(0x275)+_0x3ddcc5(_0x3a3b53['timestamp'])+_0x5b1386(0x1047)+_0x2b4760+_0x5b1386(0x868)+_0x273fe4+_0x5b1386(0xecc)+(_0x3571fc?_0x5b1386(0x8ea):'')+_0x5b1386(0x1055)+(_0x222c56?_0x5b1386(0x8ea):'')+_0x5b1386(0x987)+_0x4b5e80+_0x5b1386(0x12b9)+_0x3858dc+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x4d0a96+_0x5b1386(0xfa7);if(!_0x468b9){const _0x38d26b=document['createElement'](_0x5b1386(0xb25));_0x38d26b[_0x5b1386(0x81c)]=_0x5b1386(0xfe4),_0x38d26b['innerHTML']=_0x5b1386(0xe91),_0x75f938[_0x5b1386(0x22f)](_0x14cf57),_0x75f938[_0x5b1386(0x22f)](_0x38d26b);}return _0x75f938;}async function _0x2d4910(_0xd158ac){const _0x452710=_0x41eae2,_0x4cff77=await _0x1a6951[_0x452710(0xea0)][_0x452710(0x650)](_0xd158ac);if(!_0x4cff77){const _0x2f16a9=document[_0x452710(0xd16)]('.qzone-post-container[data-post-id=\x22'+_0xd158ac+'\x22]');if(_0x2f16a9)_0x2f16a9[_0x452710(0x1247)]();return;}const _0x457438=_0xbd77bc['findIndex'](_0x468ec9=>_0x468ec9['id']===_0xd158ac);if(_0x457438>-0x1)_0xbd77bc[_0x457438]=_0x4cff77;const _0x5a0618=await _0x1a6951[_0x452710(0x183)]['where'](_0x452710(0x48c))[_0x452710(0xb17)](_0x452710(0x8ed))['toArray']();_0x5b873d[_0x452710(0x1144)]=new Set(_0x5a0618[_0x452710(0x412)](_0x546127=>_0x546127[_0x452710(0x28c)]['id'])),_0x1aca28(_0x4cff77);}function _0x4ce38e(_0x5c8d35){const _0xa1ddfc=_0x41eae2,_0x51f5fb=Date[_0xa1ddfc(0xf1a)](),_0x287f57=Math[_0xa1ddfc(0x128a)]((_0x51f5fb-_0x5c8d35)/0x3e8),_0xac31ef=Math['floor'](_0x287f57/0x3c);if(_0xac31ef<0x2)return'刚刚';if(_0xac31ef<0x3c)return _0xac31ef+_0xa1ddfc(0x137c);const _0x31849f=Math[_0xa1ddfc(0x128a)](_0xac31ef/0x3c);if(_0x31849f<0x18)return _0x31849f+'小时前';const _0x5820a4=Math[_0xa1ddfc(0x128a)](_0x31849f/0x18);return _0x5820a4+'天前';}async function _0x1aca28(_0x44c56a){const _0x4badd1=_0x41eae2,_0x421640=document[_0x4badd1(0xd16)](_0x4badd1(0x10da)+_0x44c56a['id']+'\x22]'),_0x391c99=!!_0x421640,_0x535d87=_0x391c99?_0x421640:document[_0x4badd1(0x285)](_0x4badd1(0xb25));!_0x391c99&&(_0x535d87['className']=_0x4badd1(0x4c3),_0x535d87[_0x4badd1(0xaaf)]['postId']=_0x44c56a['id']);const _0x535a78=_0x391c99?_0x535d87[_0x4badd1(0xd16)](_0x4badd1(0xcca)):document[_0x4badd1(0x285)](_0x4badd1(0xb25));!_0x391c99&&(_0x535a78['className']=_0x4badd1(0xb5a));let _0x2e0826='',_0x2f7c1a='',_0x14584f=_0x5b873d['qzoneSettings']['avatar'];if(_0x44c56a['authorId']===_0x4badd1(0x116c))_0x2e0826=_0x5b873d[_0x4badd1(0x5c1)][_0x4badd1(0x12c8)],_0x2f7c1a=_0x5b873d['qzoneSettings'][_0x4badd1(0x22a)];else{if(_0x5b873d[_0x4badd1(0x667)][_0x44c56a[_0x4badd1(0xc3f)]]){const _0x21a484=_0x5b873d['chats'][_0x44c56a[_0x4badd1(0xc3f)]];_0x2e0826=_0x21a484['settings'][_0x4badd1(0xdd3)]||_0x265fcc,_0x2f7c1a=_0x21a484['name'];}else{if(String(_0x44c56a[_0x4badd1(0xc3f)])['startsWith'](_0x4badd1(0x5b8))){const _0x38cb49=parseInt(String(_0x44c56a['authorId'])[_0x4badd1(0xfbf)]('npc_',''));if(!isNaN(_0x38cb49)){const _0x19986b=await _0x1a6951[_0x4badd1(0x8ce)]['get'](_0x38cb49);_0x19986b?(_0x2e0826=_0x19986b[_0x4badd1(0x12c8)]||_0x15061e,_0x2f7c1a=_0x19986b[_0x4badd1(0xf74)]):(_0x2f7c1a=_0x44c56a[_0x4badd1(0xf56)]||_0x4badd1(0xd77),_0x2e0826=_0x15061e);}}else _0x2f7c1a=_0x471a37(_0x44c56a['authorOriginalName']),_0x2e0826=_0x265fcc;}}function _0xa60786(_0x59b51b){const _0x9c5def=_0x4badd1;let _0x23b92a='';const _0x11c9e8=_0x59b51b[_0x9c5def(0x957)]?_0x9c5def(0x968)+_0x55b8e7(_0x59b51b[_0x9c5def(0x957)])['replace'](/\n/g,'<br>')+_0x9c5def(0xc57):'';if(_0x59b51b['type']===_0x9c5def(0x536))_0x23b92a='<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>'+_0x55b8e7(_0x59b51b[_0x9c5def(0x28c)])[_0x9c5def(0xfbf)](/\n/g,'<br>')+_0x9c5def(0xc57);else{if(_0x59b51b[_0x9c5def(0x48c)]===_0x9c5def(0xe70)&&_0x59b51b[_0x9c5def(0x450)])_0x23b92a=_0x11c9e8?_0x11c9e8+_0x9c5def(0x299)+_0x59b51b[_0x9c5def(0x450)]+_0x9c5def(0x4a3):_0x9c5def(0x477)+_0x59b51b[_0x9c5def(0x450)]+'\x22\x20class=\x22chat-image\x22>';else{if(_0x59b51b[_0x9c5def(0x48c)]==='text_image'){const _0x44c33f=_0x5b873d[_0x9c5def(0x21a)][_0x9c5def(0x122b)]&&_0x59b51b[_0x9c5def(0x895)]?_0x9c5def(0x1017)+_0x59b51b['image_prompt']:_0x9c5def(0xd91);_0x23b92a=_0x11c9e8?_0x11c9e8+_0x9c5def(0x299)+_0x44c33f+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x59b51b[_0x9c5def(0x132c)]+'\x22></div>':_0x9c5def(0x477)+_0x44c33f+_0x9c5def(0xcab)+_0x59b51b[_0x9c5def(0x132c)]+'\x22>';}else{if(_0x59b51b[_0x9c5def(0x48c)]===_0x9c5def(0x1289)){const _0xad2495=_0x59b51b['imageUrls']||(_0x59b51b[_0x9c5def(0x450)]?[_0x59b51b[_0x9c5def(0x450)]]:[]);if(_0xad2495[_0x9c5def(0x7aa)]>0x0){const _0x169e3d=_0xad2495['length'];let _0x5d82aa='';_0x5d82aa=_0x9c5def(0x1d1)+_0x169e3d+'\x22>',_0xad2495[_0x9c5def(0xd9a)]((_0x3cf447,_0xa98efa)=>{const _0x19ac96=_0x9c5def;_0x5d82aa+=_0x19ac96(0x477)+_0x3cf447+_0x19ac96(0x9c1)+(_0xa98efa+0x1)+_0x19ac96(0x1013);}),_0x5d82aa+='</div>',_0x23b92a=_0x11c9e8?''+_0x11c9e8+_0x5d82aa:_0x5d82aa;}}else{if(_0x59b51b[_0x9c5def(0x48c)]===_0x9c5def(0x88f)){const _0x477c03=_0x59b51b['imageUrls']||(_0x59b51b[_0x9c5def(0x450)]?[_0x59b51b['imageUrl']]:[]);if(_0x477c03['length']>0x0){const _0x2a7cdd=_0x477c03['length'];let _0x365e5f='';_0x365e5f=_0x9c5def(0x1d1)+_0x2a7cdd+'\x22>',_0x477c03['forEach']((_0x3b073a,_0x3abd80)=>{const _0x1ddb91=_0x9c5def;_0x365e5f+=_0x1ddb91(0x477)+_0x3b073a+'\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片'+(_0x3abd80+0x1)+'\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>';}),_0x365e5f+='</div>',_0x23b92a=_0x11c9e8?''+_0x11c9e8+_0x365e5f:_0x365e5f;}}}}}}return _0x23b92a;}let _0x11c622;if(_0x44c56a[_0x4badd1(0x48c)]===_0x4badd1(0xb95)){const _0x313f88=_0x44c56a['repostComment']?_0x4badd1(0x968)+_0x44c56a[_0x4badd1(0x629)]['replace'](/\n/g,_0x4badd1(0x962))+'</div>':'';let _0x5cb517=_0x265fcc,_0x54f990='原作者';if(_0x44c56a[_0x4badd1(0x1c9)]['authorId']===_0x4badd1(0x116c))_0x5cb517=_0x5b873d[_0x4badd1(0x5c1)][_0x4badd1(0x12c8)],_0x54f990=_0x5b873d[_0x4badd1(0x5c1)]['nickname'];else{const _0x44f694=_0x5b873d[_0x4badd1(0x667)][_0x44c56a[_0x4badd1(0x1c9)][_0x4badd1(0xc3f)]];_0x44f694&&(_0x5cb517=_0x44f694[_0x4badd1(0xdb9)][_0x4badd1(0xdd3)]||_0x265fcc),_0x54f990=_0x471a37(_0x44c56a['originalPost'][_0x4badd1(0xf56)]);}_0x11c622=_0x4badd1(0x100a)+_0x313f88+_0x4badd1(0x3cc)+_0x5cb517+'\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@'+_0x54f990+_0x4badd1(0x7bc)+_0x3ddcc5(_0x44c56a[_0x4badd1(0x1c9)][_0x4badd1(0x114e)])+_0x4badd1(0x8a9)+_0xa60786(_0x44c56a[_0x4badd1(0x1c9)])+_0x4badd1(0x85a);}else _0x11c622=_0x4badd1(0x500)+_0xa60786(_0x44c56a)+_0x4badd1(0xc57);let _0x4932c4='';if(_0x44c56a[_0x4badd1(0xfe6)]&&_0x44c56a[_0x4badd1(0xfe6)][_0x4badd1(0x7aa)]>0x0){const _0x3d7865=_0x44c56a['likes'][_0x4badd1(0x412)](_0x52464f=>_0x471a37(_0x52464f))[_0x4badd1(0x1237)]('、');_0x4932c4=_0x4badd1(0xd8a)+_0x3d7865+_0x4badd1(0x55d);}let _0x1e312f='';_0x44c56a[_0x4badd1(0x1157)]&&_0x44c56a[_0x4badd1(0x1157)][_0x4badd1(0x7aa)]>0x0&&(_0x1e312f='<div\x20class=\x22post-comments-container\x22>',_0x44c56a[_0x4badd1(0x1157)][_0x4badd1(0xd9a)]((_0x400cd9,_0x255bb2)=>{const _0x1b107e=_0x4badd1;if(typeof _0x400cd9==='object'&&_0x400cd9!==null&&_0x400cd9['commenterName']){const _0x12bb27=_0x400cd9['commenterName'],_0xc3f368=_0x471a37(_0x12bb27);let _0x28c3db;_0x3b71b1[_0x1b107e(0xb80)](_0x400cd9[_0x1b107e(0xec9)])?_0x28c3db='<img\x20src=\x22'+_0x400cd9[_0x1b107e(0xec9)]+_0x1b107e(0x82d):_0x28c3db=_0x55b8e7(_0x400cd9[_0x1b107e(0xec9)]);let _0x4bc91e='';if(_0x400cd9['replyTo']){const _0x57eccd=_0x471a37(_0x400cd9[_0x1b107e(0x8e7)]);_0x4bc91e='<span\x20class=\x22commenter-name\x22>'+_0xc3f368+_0x1b107e(0x318)+_0x57eccd+_0x1b107e(0x601)+_0x28c3db;}else _0x4bc91e=_0x1b107e(0x134f)+_0xc3f368+'</span>:\x20'+_0x28c3db;_0x1e312f+=_0x1b107e(0x1da)+_0x44c56a['id']+_0x1b107e(0x61f)+_0x12bb27+_0x1b107e(0x673)+_0xc3f368+_0x1b107e(0x300)+_0x4bc91e+_0x1b107e(0x462)+_0x255bb2+_0x1b107e(0x217);}else _0x1e312f+='<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>'+String(_0x400cd9)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}),_0x1e312f+=_0x4badd1(0xc57));const _0x856bf1=_0x5b873d['qzoneSettings'][_0x4badd1(0x22a)],_0xc7cb86=_0x44c56a[_0x4badd1(0xfe6)]&&_0x44c56a[_0x4badd1(0xfe6)][_0x4badd1(0xced)](_0x856bf1),_0x646511=_0x5b873d['favoritedPostIds']&&_0x5b873d['favoritedPostIds'][_0x4badd1(0xa14)](_0x44c56a['id']);let _0x22aebf='';_0x44c56a[_0x4badd1(0x48c)]!==_0x4badd1(0xb95)&&(_0x22aebf=_0x4badd1(0x109e));_0x535a78['innerHTML']=_0x4badd1(0x1228)+_0x2e0826+_0x4badd1(0x29e)+_0x44c56a['authorId']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>'+_0x2f7c1a+_0x4badd1(0x275)+_0x3ddcc5(_0x44c56a[_0x4badd1(0x114e)])+_0x4badd1(0x1047)+_0x11c622+_0x4badd1(0x868)+_0x22aebf+_0x4badd1(0xecc)+(_0xc7cb86?'active':'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20'+(_0x646511?_0x4badd1(0x8ea):'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4932c4+_0x4badd1(0x12b9)+_0x1e312f+_0x4badd1(0x4e2)+_0x14584f+_0x4badd1(0xfa7);if(!_0x391c99){const _0x551d0d=document[_0x4badd1(0x285)](_0x4badd1(0xb25));_0x551d0d[_0x4badd1(0x81c)]=_0x4badd1(0xfe4),_0x551d0d[_0x4badd1(0x1ef)]=_0x4badd1(0xe91),_0x535d87[_0x4badd1(0x22f)](_0x535a78),_0x535d87['appendChild'](_0x551d0d);}return _0x535d87;}async function _0x2d4910(_0x2b700a){const _0x1b735e=_0x41eae2,_0x2c8fc3=await _0x1a6951[_0x1b735e(0xea0)][_0x1b735e(0x650)](_0x2b700a);if(!_0x2c8fc3){const _0x55c953=document[_0x1b735e(0xd16)](_0x1b735e(0x10da)+_0x2b700a+'\x22]');_0x55c953&&_0x55c953['remove']();return;}const _0x1f37a0=_0xbd77bc[_0x1b735e(0x9d7)](_0x30747a=>_0x30747a['id']===_0x2b700a);_0x1f37a0>-0x1&&(_0xbd77bc[_0x1f37a0]=_0x2c8fc3);const _0x3e4897=await _0x1a6951['favorites'][_0x1b735e(0x176)](_0x1b735e(0x48c))[_0x1b735e(0xb17)](_0x1b735e(0x8ed))[_0x1b735e(0xc2f)]();_0x5b873d[_0x1b735e(0x1144)]=new Set(_0x3e4897[_0x1b735e(0x412)](_0x46764e=>_0x46764e[_0x1b735e(0x28c)]['id'])),await _0x1aca28(_0x2c8fc3);}async function _0x155816(){const _0x19e189=_0x41eae2,_0x223a31=document['getElementById']('qzone-posts-list');if(!_0x223a31)return;const [_0x1893d0,_0x3cac30]=await Promise['all']([_0x1a6951[_0x19e189(0xea0)]['orderBy'](_0x19e189(0x114e))[_0x19e189(0x854)]()[_0x19e189(0x3d8)](_0xa7e6ca=>!_0xa7e6ca[_0x19e189(0x35d)])['toArray'](),_0x1a6951[_0x19e189(0x183)][_0x19e189(0x176)]('type')[_0x19e189(0xb17)]('qzone_post')[_0x19e189(0xc2f)]()]);_0xbd77bc=_0x1893d0,_0x5b873d['favoritedPostIds']=new Set(_0x3cac30[_0x19e189(0x412)](_0x521cc9=>_0x521cc9[_0x19e189(0x28c)]['id'])),_0x223a31['innerHTML']='',_0x4cbc61=0x0;if(_0xbd77bc['length']===0x0){_0x223a31[_0x19e189(0x1ef)]=_0x19e189(0xc2e);return;}_0xbf271b();}async function _0xbf271b(){const _0x2cbb56=_0x41eae2;if(_0x34a523)return;_0x34a523=!![];const _0x27c2ec=document[_0x2cbb56(0x89d)](_0x2cbb56(0x24c));if(!_0x27c2ec){_0x34a523=![];return;}_0x9ce0b2(_0x27c2ec,_0x2cbb56(0xc74)),setTimeout(async()=>{const _0x534302=_0x2cbb56;_0x216cac(_0x27c2ec);const _0x8535c3=_0x4cbc61,_0xa8472e=_0x4cbc61+_0x130525,_0x307516=_0xbd77bc[_0x534302(0xdd0)](_0x8535c3,_0xa8472e),_0x34d072=document[_0x534302(0xfc9)]();for(const _0x557a09 of _0x307516){const _0x1b14b9=await _0x1aca28(_0x557a09);_0x34d072[_0x534302(0x22f)](_0x1b14b9);}_0x27c2ec[_0x534302(0x22f)](_0x34d072),_0x4cbc61+=_0x307516[_0x534302(0x7aa)],_0x34a523=![];},0x1f4);}function _0x3733bf(_0x39a50a,_0x4caad6){const _0x3d9a20=_0x41eae2,_0x337d03=_0x40df96[_0x3d9a20(0x612)],_0xe29af8=_0x40df96['gridEl'];_0xe29af8[_0x3d9a20(0x1ef)]='';_0x5b873d[_0x3d9a20(0x210)][_0x3d9a20(0x7aa)]===0x0?_0xe29af8[_0x3d9a20(0x1ef)]=_0x3d9a20(0x1195):_0x5b873d[_0x3d9a20(0x210)][_0x3d9a20(0xd9a)](_0x163174=>{const _0x130cf0=_0x3d9a20,_0x5b3eb0=document[_0x130cf0(0x285)](_0x130cf0(0xb25));_0x5b3eb0[_0x130cf0(0x81c)]=_0x130cf0(0x2e8),_0x5b3eb0[_0x130cf0(0x68e)]['backgroundImage']='url('+_0x163174[_0x130cf0(0x11de)]+')',_0x5b3eb0[_0x130cf0(0x104c)]=_0x163174['name'],_0xe29af8[_0x130cf0(0x22f)](_0x5b3eb0);});const _0x2e369a=_0x4caad6[_0x3d9a20(0xdb2)](),_0x55eee2=document[_0x3d9a20(0x89d)](_0x3d9a20(0x34e))[_0x3d9a20(0xdb2)]();_0x337d03['style'][_0x3d9a20(0x126b)]=_0x3d9a20(0x66e);const _0x18b758=_0x337d03[_0x3d9a20(0xdb2)](),_0x32a771=_0x18b758[_0x3d9a20(0x84a)],_0x2f502a=_0x18b758[_0x3d9a20(0x42e)];_0x337d03[_0x3d9a20(0x68e)][_0x3d9a20(0x113d)]=_0x2e369a[_0x3d9a20(0x113d)]-_0x32a771-0x5-_0x55eee2['top']+'px';const _0xb3db66=_0x2e369a[_0x3d9a20(0x1004)]-_0x55eee2[_0x3d9a20(0x1004)];_0xb3db66+_0x2f502a>_0x55eee2[_0x3d9a20(0x42e)]?(_0x337d03[_0x3d9a20(0x68e)][_0x3d9a20(0x1004)]=_0x3d9a20(0xd71),_0x337d03['style'][_0x3d9a20(0x5f0)]=_0x3d9a20(0x9a9)):(_0x337d03[_0x3d9a20(0x68e)][_0x3d9a20(0x1004)]=_0xb3db66+'px',_0x337d03[_0x3d9a20(0x68e)][_0x3d9a20(0x5f0)]=_0x3d9a20(0xd71)),_0x40df96[_0x3d9a20(0xafa)]=!![],_0x40df96['activePostId']=_0x39a50a;}function _0x175ea0(){const _0x2de852=_0x41eae2;_0x40df96[_0x2de852(0xafa)]&&(_0x40df96[_0x2de852(0x612)][_0x2de852(0x68e)][_0x2de852(0x126b)]=_0x2de852(0x10f2),_0x40df96[_0x2de852(0xafa)]=![],_0x40df96[_0x2de852(0x1337)]=null);}async function _0xb65ee4(_0x4c25aa,_0x3aa655){const _0x233210=_0x41eae2;if(!_0x3aa655||!_0x3aa655[_0x233210(0x11de)])return;const _0x57e7c9=await _0x1a6951[_0x233210(0xea0)][_0x233210(0x650)](_0x4c25aa);if(!_0x57e7c9){console['error'](_0x233210(0xab4),_0x4c25aa);return;}!_0x57e7c9['comments']&&(_0x57e7c9[_0x233210(0x1157)]=[]);const _0x5d1834={'commenterName':_0x5b873d[_0x233210(0x5c1)][_0x233210(0x22a)],'text':_0x3aa655[_0x233210(0x11de)],'meaning':_0x3aa655[_0x233210(0xf74)],'timestamp':Date[_0x233210(0xf1a)]()};_0x57e7c9[_0x233210(0x1157)][_0x233210(0x138c)](_0x5d1834),await _0x1a6951[_0x233210(0xea0)]['update'](_0x4c25aa,{'comments':_0x57e7c9[_0x233210(0x1157)]}),_0x175ea0(),await _0x155816();const _0x38d3c6=(_0x57e7c9[_0x233210(0x957)]||_0x57e7c9[_0x233210(0x28c)]||'[图片动态]')[_0x233210(0x489)](0x0,0x1e);for(const _0x86f643 in _0x5b873d[_0x233210(0x667)]){const _0xa4bc24=_0x5b873d[_0x233210(0x667)][_0x86f643];if(!_0xa4bc24[_0x233210(0x58c)]){const _0x240e60=_0x233210(0xfcc)+_0x5b873d[_0x233210(0x5c1)]['nickname']+_0x233210(0x5df)+_0x4c25aa+',\x20内容摘要:\x20“'+_0x38d3c6+_0x233210(0x6ec)+_0x3aa655[_0x233210(0xf74)]+_0x233210(0xa2e),_0x58a966={'role':_0x233210(0x18c),'content':_0x240e60,'timestamp':Date[_0x233210(0xf1a)](),'isHidden':!![]};_0xa4bc24[_0x233210(0x551)][_0x233210(0x138c)](_0x58a966),await _0x1a6951[_0x233210(0x667)][_0x233210(0xc0f)](_0xa4bc24);}}}function _0x45cb2a(_0x1e0db8){const _0x3e26ba=_0x41eae2;_0x1895e3=_0x1e0db8,document[_0x3e26ba(0x89d)](_0x3e26ba(0xc66))[_0x3e26ba(0x2f4)]='',document['getElementById'](_0x3e26ba(0x7a4))[_0x3e26ba(0x2f1)][_0x3e26ba(0x569)]('visible');}function _0x21063f(){const _0x2b61e0=_0x41eae2;document[_0x2b61e0(0x89d)](_0x2b61e0(0x7a4))[_0x2b61e0(0x2f1)][_0x2b61e0(0x1247)]('visible'),_0x1895e3=null;}async function _0xd72845(){const _0x13d408=_0x41eae2;if(!_0x1895e3)return;const _0x89502b=document[_0x13d408(0x89d)](_0x13d408(0xc66))[_0x13d408(0x2f4)][_0x13d408(0xc3a)](),_0x1a835e=await _0x1a6951['qzonePosts'][_0x13d408(0x650)](_0x1895e3);if(!_0x1a835e){alert(_0x13d408(0x698)),_0x21063f();return;}const _0x2e228e={'type':_0x13d408(0xb95),'timestamp':Date['now'](),'authorId':_0x13d408(0x116c),'repostComment':_0x89502b,'originalPost':_0x1a835e,'visibleGroupIds':null};await _0x1a6951[_0x13d408(0xea0)][_0x13d408(0x569)](_0x2e228e),_0x21063f(),await _0x155816(),alert(_0x13d408(0x12a8));}function _0x1ad59f(_0x130868){const _0x1cad2e=_0x41eae2,_0x3a4211=document[_0x1cad2e(0x89d)]('favorites-list');_0x3a4211['innerHTML']='';if(_0x130868[_0x1cad2e(0x7aa)]===0x0){const _0x435d09=document[_0x1cad2e(0x89d)](_0x1cad2e(0xd2e))['value'],_0x2ad66b=_0x435d09?_0x1cad2e(0xe30):_0x1cad2e(0x7d6);_0x3a4211['innerHTML']=_0x1cad2e(0x77e)+_0x2ad66b+_0x1cad2e(0x164);return;}for(const _0x262d48 of _0x130868){const _0x4d07c1=document[_0x1cad2e(0x285)](_0x1cad2e(0xb25));_0x4d07c1[_0x1cad2e(0x81c)]=_0x1cad2e(0xf3b),_0x4d07c1['dataset'][_0x1cad2e(0x980)]=_0x262d48['id'];let _0x4ca4ae='',_0x34206a='',_0x482c95='',_0x147bf9='';if(_0x262d48[_0x1cad2e(0x48c)]===_0x1cad2e(0x8ed)){const _0x5ccafd=_0x262d48[_0x1cad2e(0x28c)];_0x482c95=_0x1cad2e(0x820);let _0x5f1a0b=_0x265fcc,_0x2b4849=_0x1cad2e(0x25e);if(_0x5ccafd[_0x1cad2e(0xc3f)]==='user')_0x5f1a0b=_0x5b873d[_0x1cad2e(0x5c1)][_0x1cad2e(0x12c8)],_0x2b4849=_0x5b873d[_0x1cad2e(0x5c1)]['nickname'];else _0x5b873d[_0x1cad2e(0x667)][_0x5ccafd[_0x1cad2e(0xc3f)]]&&(_0x5f1a0b=_0x5b873d[_0x1cad2e(0x667)][_0x5ccafd[_0x1cad2e(0xc3f)]][_0x1cad2e(0xdb9)][_0x1cad2e(0xdd3)],_0x2b4849=_0x5b873d[_0x1cad2e(0x667)][_0x5ccafd[_0x1cad2e(0xc3f)]][_0x1cad2e(0xf74)]);_0x4ca4ae=_0x1cad2e(0x477)+_0x5f1a0b+_0x1cad2e(0xca6)+_0x2b4849+_0x1cad2e(0xc8d);const _0x48fb4e=_0x5ccafd[_0x1cad2e(0x957)]?_0x1cad2e(0x968)+_0x5ccafd['publicText'][_0x1cad2e(0xfbf)](/\n/g,_0x1cad2e(0x962))+'</div>':'';if(_0x5ccafd['type']===_0x1cad2e(0x536))_0x34206a=_0x1cad2e(0x968)+_0x5ccafd['content'][_0x1cad2e(0xfbf)](/\n/g,_0x1cad2e(0x962))+_0x1cad2e(0xc57);else{if(_0x5ccafd[_0x1cad2e(0x48c)]===_0x1cad2e(0xe70)&&_0x5ccafd[_0x1cad2e(0x450)]){const _0x514665=_0x5b873d['globalSettings'][_0x1cad2e(0x122b)]&&_0x5ccafd[_0x1cad2e(0x895)]?_0x1cad2e(0x1017)+_0x5ccafd[_0x1cad2e(0x895)]:_0x1cad2e(0xd91);_0x34206a=_0x48fb4e?_0x48fb4e+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x514665+_0x1cad2e(0x4a3):_0x1cad2e(0x477)+_0x514665+_0x1cad2e(0x23a);}else{if(_0x5ccafd[_0x1cad2e(0x48c)]===_0x1cad2e(0x574)){const _0x99498e=_0x5b873d['globalSettings'][_0x1cad2e(0x122b)]&&_0x5ccafd[_0x1cad2e(0x895)]?'https://image.pollinations.ai/prompt/'+_0x5ccafd[_0x1cad2e(0x895)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x34206a=_0x48fb4e?_0x48fb4e+_0x1cad2e(0x299)+_0x99498e+_0x1cad2e(0xcab)+_0x5ccafd[_0x1cad2e(0x132c)]+_0x1cad2e(0x2d9):'<img\x20src=\x22'+_0x99498e+_0x1cad2e(0xcab)+_0x5ccafd[_0x1cad2e(0x132c)]+'\x22>';}}}let _0x14a0b9='';_0x5ccafd[_0x1cad2e(0xfe6)]&&_0x5ccafd[_0x1cad2e(0xfe6)][_0x1cad2e(0x7aa)]>0x0&&(_0x14a0b9=_0x1cad2e(0x588)+_0x5ccafd['likes'][_0x1cad2e(0x1237)]('、')+'\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>');let _0x3b4d67='';_0x5ccafd[_0x1cad2e(0x1157)]&&_0x5ccafd[_0x1cad2e(0x1157)][_0x1cad2e(0x7aa)]>0x0&&(_0x3b4d67=_0x1cad2e(0x9bc),_0x5ccafd[_0x1cad2e(0x1157)][_0x1cad2e(0xd9a)]((_0x278d38,_0x33b7d4)=>{const _0xea7a0a=_0x1cad2e;if(typeof _0x278d38==='object'&&_0x278d38!==null&&_0x278d38[_0xea7a0a(0xf20)]){const _0x120fa4=_0x278d38[_0xea7a0a(0xf20)],_0x1b1e27=_0x471a37(_0x120fa4);let _0x257bed;_0x3b71b1[_0xea7a0a(0xb80)](_0x278d38[_0xea7a0a(0xec9)])?_0x257bed=_0xea7a0a(0x477)+_0x278d38[_0xea7a0a(0xec9)]+_0xea7a0a(0x82d):_0x257bed=_0x278d38[_0xea7a0a(0xec9)];let _0x346a68='';if(_0x278d38[_0xea7a0a(0x8e7)]){const _0x5102b5=_0x471a37(_0x278d38[_0xea7a0a(0x8e7)]);_0x346a68=_0xea7a0a(0x134f)+_0x1b1e27+'</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>'+_0x5102b5+'</span>:\x20'+_0x257bed;}else _0x346a68=_0xea7a0a(0x134f)+_0x1b1e27+'</span>:\x20'+_0x257bed;_0x3b4d67+=_0xea7a0a(0x1da)+_0x5ccafd['id']+_0xea7a0a(0x61f)+_0x120fa4+_0xea7a0a(0x673)+_0x1b1e27+_0xea7a0a(0x74b)+_0x346a68+_0xea7a0a(0x71b)+_0x33b7d4+_0xea7a0a(0x120c);}else _0x3b4d67+=_0xea7a0a(0x926)+String(_0x278d38)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}),_0x3b4d67+=_0x1cad2e(0xc57)),_0x147bf9=''+_0x14a0b9+_0x3b4d67;}else{if(_0x262d48[_0x1cad2e(0x48c)]===_0x1cad2e(0x8bb)){const _0x2b0e87=_0x262d48[_0x1cad2e(0x28c)],_0x587bac=_0x5b873d[_0x1cad2e(0x667)][_0x262d48[_0x1cad2e(0x94d)]];if(!_0x587bac)continue;_0x482c95='来自与\x20'+_0x587bac[_0x1cad2e(0xf74)]+_0x1cad2e(0x881);const _0xd2c986=_0x2b0e87[_0x1cad2e(0xa57)]===_0x1cad2e(0x116c);let _0x4f8b88,_0x4b697e;if(_0xd2c986)_0x4f8b88=_0x587bac[_0x1cad2e(0x58c)]?_0x587bac[_0x1cad2e(0xdb9)][_0x1cad2e(0xc48)]||'我':'我',_0x4b697e=_0x587bac[_0x1cad2e(0xdb9)][_0x1cad2e(0xd55)]||(_0x587bac[_0x1cad2e(0x58c)]?_0x24462f:_0x265fcc);else{if(_0x587bac[_0x1cad2e(0x58c)]){const _0x2b4c48=_0x587bac[_0x1cad2e(0x5ab)][_0x1cad2e(0x12f4)](_0x499f93=>_0x499f93[_0x1cad2e(0x1045)]===_0x2b0e87[_0x1cad2e(0xcfc)]);_0x4f8b88=_0x2b0e87[_0x1cad2e(0xcfc)],_0x4b697e=_0x2b4c48?_0x2b4c48[_0x1cad2e(0x12c8)]:_0x15061e;}else _0x4f8b88=_0x587bac[_0x1cad2e(0xf74)],_0x4b697e=_0x587bac[_0x1cad2e(0xdb9)][_0x1cad2e(0xdd3)]||_0x265fcc;}_0x4ca4ae=_0x1cad2e(0x477)+_0x4b697e+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x4f8b88+'</div></div>';if(typeof _0x2b0e87[_0x1cad2e(0x28c)]==='string'&&_0x3b71b1['test'](_0x2b0e87[_0x1cad2e(0x28c)]))_0x34206a=_0x1cad2e(0x477)+_0x2b0e87[_0x1cad2e(0x28c)]+'\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>';else Array[_0x1cad2e(0xbd6)](_0x2b0e87[_0x1cad2e(0x28c)])&&_0x2b0e87[_0x1cad2e(0x28c)][0x0]?.[_0x1cad2e(0x48c)]===_0x1cad2e(0xcad)?_0x34206a=_0x1cad2e(0x477)+_0x2b0e87[_0x1cad2e(0x28c)][0x0][_0x1cad2e(0xcad)][_0x1cad2e(0x11de)]+_0x1cad2e(0x23a):_0x34206a=String(_0x2b0e87[_0x1cad2e(0x28c)]||'')[_0x1cad2e(0xfbf)](/\n/g,'<br>');}else{if(_0x262d48['type']===_0x1cad2e(0x1b6)){const _0x462a16=_0x262d48[_0x1cad2e(0x28c)];_0x482c95=_0x1cad2e(0x61e)+_0x462a16[_0x1cad2e(0x3aa)]+_0x1cad2e(0x52b);const _0x2fa827=_0x5b873d['chats'][_0x462a16['characterId']],_0x469f6f=_0x2fa827?_0x2fa827[_0x1cad2e(0xdb9)][_0x1cad2e(0xdd3)]:_0x265fcc;_0x4ca4ae=_0x1cad2e(0x477)+_0x469f6f+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x462a16['characterName']+_0x1cad2e(0xc8d);const _0x32a6cb=_0x462a16['content']||'',_0x1693ee=_0x55b8e7(_0x32a6cb)['replace'](/\n/g,_0x1cad2e(0x962));_0x34206a=_0x1cad2e(0x9c5)+_0x462a16[_0x1cad2e(0x104c)]+_0x1cad2e(0xa93)+_0x1693ee+_0x1cad2e(0x590);}else{if(_0x262d48[_0x1cad2e(0x48c)]===_0x1cad2e(0x29c)){const _0x53973b=_0x262d48[_0x1cad2e(0x28c)];_0x482c95=_0x1cad2e(0x61e)+_0x53973b[_0x1cad2e(0x3aa)]+_0x1cad2e(0xf84);const _0x4d9bab=_0x5b873d[_0x1cad2e(0x667)][_0x53973b[_0x1cad2e(0x592)]],_0x51bd6c=_0x4d9bab?_0x4d9bab[_0x1cad2e(0xdb9)][_0x1cad2e(0xdd3)]:_0x265fcc;_0x4ca4ae=_0x1cad2e(0x477)+_0x51bd6c+_0x1cad2e(0xca6)+_0x53973b[_0x1cad2e(0x3aa)]+_0x1cad2e(0xc8d),_0x34206a=_0x1cad2e(0x77c)+_0x53973b[_0x1cad2e(0x104c)]+_0x1cad2e(0xa89)+(_0x53973b[_0x1cad2e(0x28c)]||'')[_0x1cad2e(0xfbf)](/\n/g,_0x1cad2e(0x962))+_0x1cad2e(0x967);}else{if(_0x262d48[_0x1cad2e(0x48c)]===_0x1cad2e(0x694)){const _0x2277f9=_0x262d48['content'];_0x482c95=_0x1cad2e(0x61e)+_0x2277f9[_0x1cad2e(0x3aa)]+_0x1cad2e(0x1201);const _0x21a2cc=_0x5b873d['chats'][_0x2277f9['characterId']],_0x5c8c13=_0x21a2cc?_0x21a2cc[_0x1cad2e(0xdb9)]['aiAvatar']:_0x265fcc;_0x4ca4ae=_0x1cad2e(0x477)+_0x5c8c13+_0x1cad2e(0xca6)+_0x2277f9[_0x1cad2e(0x3aa)]+_0x1cad2e(0xc8d),_0x34206a=_0x1cad2e(0x6ba)+_0x2277f9[_0x1cad2e(0x104c)]+_0x1cad2e(0xc53)+_0x2277f9[_0x1cad2e(0x28c)][_0x1cad2e(0xfbf)](/\n/g,'<br>')+_0x1cad2e(0x99c);}}}}}_0x4d07c1[_0x1cad2e(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>'+_0x4ca4ae+_0x1cad2e(0xb99)+_0x482c95+_0x1cad2e(0x123e)+_0x34206a+_0x1cad2e(0x561)+_0x147bf9,_0x3a4211['appendChild'](_0x4d07c1);}}async function _0x2e7944(){const _0x559a80=_0x41eae2;allFavoriteItems=await _0x1a6951['favorites']['orderBy']('timestamp')[_0x559a80(0x854)]()[_0x559a80(0xc2f)]();const _0x7cc872=document[_0x559a80(0x89d)](_0x559a80(0xd2e)),_0x4bfdae=document['getElementById']('favorites-search-clear-btn');_0x7cc872[_0x559a80(0x2f4)]='',_0x4bfdae[_0x559a80(0x68e)][_0x559a80(0x126b)]=_0x559a80(0x10f2),_0x1ad59f(allFavoriteItems);}function _0x1b955a(){const _0x549dde=_0x41eae2;document['getElementById']('post-public-text')[_0x549dde(0x2f4)]='',document[_0x549dde(0x89d)](_0x549dde(0xca1))[_0x549dde(0x9e3)]='',document[_0x549dde(0x89d)](_0x549dde(0x959))['value']='',document[_0x549dde(0x89d)]('post-image-preview-container')[_0x549dde(0x2f1)][_0x549dde(0x1247)](_0x549dde(0x11e4)),document[_0x549dde(0x89d)](_0x549dde(0xb9d))[_0x549dde(0x68e)][_0x549dde(0x126b)]=_0x549dde(0x10f2),document[_0x549dde(0x89d)](_0x549dde(0xb36))['value']='',document[_0x549dde(0x89d)](_0x549dde(0x74e))[_0x549dde(0x2f4)]='',document['getElementById'](_0x549dde(0x73d))[_0x549dde(0x12a5)]();}async function _0x3c9306(){const _0x2278d6=_0x41eae2,_0x168de6=await _0x4e2abc('确认清理冗余数据？',_0x2278d6(0x316),{'confirmButtonClass':'btn-danger','confirmText':'确认清理'});if(!_0x168de6)return;await _0x532f76('请稍候...',_0x2278d6(0x11a9)),console[_0x2278d6(0x471)](_0x2278d6(0xaff));let _0x2dcc6f={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0x1a6951[_0x2278d6(0x93b)]('rw',_0x1a6951[_0x2278d6(0x12be)],async()=>{const _0x14a6ce=_0x2278d6,_0x4efb00=await _0x1a6951[_0x14a6ce(0x667)]['toArray'](),_0x4bb603=await _0x1a6951[_0x14a6ce(0x8ce)][_0x14a6ce(0xc2f)](),_0x172e1a=new Set(_0x4efb00['map'](_0x559bc5=>_0x559bc5['id'])),_0x913061=new Set(_0x4bb603[_0x14a6ce(0x412)](_0x2ebf9a=>'npc_'+_0x2ebf9a['id'])),_0x1ae74b=new Set(_0x4efb00[_0x14a6ce(0x3d8)](_0x2c634e=>!_0x2c634e[_0x14a6ce(0x58c)])['map'](_0x230e09=>_0x230e09[_0x14a6ce(0x1045)]));_0x1ae74b[_0x14a6ce(0x569)](_0x5b873d[_0x14a6ce(0x5c1)]['nickname']||_0x14a6ce(0x1285)),_0x4bb603[_0x14a6ce(0xd9a)](_0x399840=>_0x1ae74b['add'](_0x399840[_0x14a6ce(0xf74)]));for(const _0x168053 of _0x4efb00){let _0x424def=![];if(_0x168053[_0x14a6ce(0x58c)]&&_0x168053[_0x14a6ce(0x5ab)]){const _0x4cc850=_0x168053[_0x14a6ce(0x5ab)][_0x14a6ce(0x7aa)];_0x168053[_0x14a6ce(0x5ab)]=_0x168053[_0x14a6ce(0x5ab)][_0x14a6ce(0x3d8)](_0x25b898=>_0x172e1a[_0x14a6ce(0xa14)](_0x25b898['id'])||_0x913061['has'](_0x25b898['id'])),_0x168053[_0x14a6ce(0x5ab)]['length']<_0x4cc850&&(_0x2dcc6f[_0x14a6ce(0x619)]+=_0x4cc850-_0x168053['members'][_0x14a6ce(0x7aa)],_0x424def=!![]);}if(_0x168053[_0x14a6ce(0xdb9)]?.[_0x14a6ce(0xf0e)]?.[_0x14a6ce(0x7aa)]>0x0){const _0x17c42b=_0x168053[_0x14a6ce(0xdb9)][_0x14a6ce(0xf0e)][_0x14a6ce(0x7aa)];_0x168053[_0x14a6ce(0xdb9)][_0x14a6ce(0xf0e)]=_0x168053[_0x14a6ce(0xdb9)]['linkedMemoryChatIds'][_0x14a6ce(0x3d8)](_0x3ecca3=>_0x172e1a[_0x14a6ce(0xa14)](_0x3ecca3)),_0x168053[_0x14a6ce(0xdb9)][_0x14a6ce(0xf0e)][_0x14a6ce(0x7aa)]<_0x17c42b&&(_0x2dcc6f['chatLinks']+=_0x17c42b-_0x168053['settings'][_0x14a6ce(0xf0e)][_0x14a6ce(0x7aa)],_0x424def=!![]);}_0x424def&&await _0x1a6951[_0x14a6ce(0x667)]['put'](_0x168053);}const _0xa3a292=await _0x1a6951['qzonePosts']['toArray']();for(const _0x7b1103 of _0xa3a292){let _0x39b0db=![];const _0x176c9d=_0x7b1103['authorId']===_0x14a6ce(0x116c)||_0x172e1a['has'](_0x7b1103['authorId'])||_0x913061[_0x14a6ce(0xa14)](_0x7b1103['authorId']);if(!_0x176c9d){await _0x1a6951[_0x14a6ce(0xea0)][_0x14a6ce(0x684)](_0x7b1103['id']),_0x2dcc6f['posts']++;continue;}if(_0x7b1103[_0x14a6ce(0xfe6)]&&_0x7b1103[_0x14a6ce(0xfe6)][_0x14a6ce(0x7aa)]>0x0){const _0x451dde=_0x7b1103[_0x14a6ce(0xfe6)]['length'];_0x7b1103['likes']=_0x7b1103[_0x14a6ce(0xfe6)]['filter'](_0x27271f=>_0x1ae74b[_0x14a6ce(0xa14)](_0x27271f)),_0x7b1103[_0x14a6ce(0xfe6)][_0x14a6ce(0x7aa)]<_0x451dde&&(_0x2dcc6f['likes']+=_0x451dde-_0x7b1103[_0x14a6ce(0xfe6)][_0x14a6ce(0x7aa)],_0x39b0db=!![]);}if(_0x7b1103['comments']&&_0x7b1103['comments'][_0x14a6ce(0x7aa)]>0x0){const _0x1a1b24=_0x7b1103['comments'][_0x14a6ce(0x7aa)];_0x7b1103[_0x14a6ce(0x1157)]=_0x7b1103[_0x14a6ce(0x1157)]['filter'](_0x35261c=>{const _0x12c702=_0x14a6ce;if(typeof _0x35261c===_0x12c702(0x7af)&&_0x35261c['commenterName'])return _0x1ae74b[_0x12c702(0xa14)](_0x35261c[_0x12c702(0xf20)]);return!![];}),_0x7b1103['comments'][_0x14a6ce(0x7aa)]<_0x1a1b24&&(_0x2dcc6f[_0x14a6ce(0x1157)]+=_0x1a1b24-_0x7b1103[_0x14a6ce(0x1157)][_0x14a6ce(0x7aa)],_0x39b0db=!![]);}_0x39b0db&&await _0x1a6951[_0x14a6ce(0xea0)][_0x14a6ce(0xc0f)](_0x7b1103);}await _0x1a6951[_0x14a6ce(0x19e)]['where']('chatId')[_0x14a6ce(0x7c4)]([..._0x172e1a])[_0x14a6ce(0x684)]()[_0x14a6ce(0x7ec)](_0x104c6a=>_0x2dcc6f[_0x14a6ce(0x19e)]+=_0x104c6a),await _0x1a6951[_0x14a6ce(0x856)]['where'](_0x14a6ce(0x94d))[_0x14a6ce(0x7c4)]([..._0x172e1a])[_0x14a6ce(0x684)]()[_0x14a6ce(0x7ec)](_0x7477bb=>_0x2dcc6f[_0x14a6ce(0x856)]+=_0x7477bb);const _0x466be9=await _0x1a6951[_0x14a6ce(0x1067)][_0x14a6ce(0xc2f)]();for(const _0x4ea9a5 of _0x466be9){_0x4ea9a5['chatId']!==_0x14a6ce(0xab9)&&!_0x172e1a[_0x14a6ce(0xa14)](_0x4ea9a5[_0x14a6ce(0x94d)])&&(await _0x1a6951[_0x14a6ce(0x1067)][_0x14a6ce(0x684)](_0x4ea9a5['id']),_0x2dcc6f['renderingRules']++);}});let _0x446b6a=_0x2278d6(0x8ef),_0x586dd5=![];Object['entries'](_0x2dcc6f)[_0x2278d6(0xd9a)](([_0x532e1f,_0x368cd6])=>{const _0x4c3e4e=_0x2278d6;if(_0x368cd6>0x0){const _0x32b8c7={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':'通话记录','renderingRules':_0x4c3e4e(0xa99),'groupMembers':_0x4c3e4e(0xc97),'chatLinks':_0x4c3e4e(0x130d)};_0x446b6a+=_0x4c3e4e(0x118f)+_0x368cd6+_0x4c3e4e(0x527)+(_0x32b8c7[_0x532e1f]||_0x532e1f)+'。\x0a',_0x586dd5=!![];}});!_0x586dd5&&(_0x446b6a=_0x2278d6(0xab2));_0x446b6a+='\x0a建议刷新页面以确保所有更改生效。',await _0x532f76(_0x2278d6(0xc43),_0x446b6a);const _0x1f97ea=await _0x4e2abc('刷新页面？','为了确保所有数据同步，建议立即刷新页面。');_0x1f97ea&&location['reload']();}catch(_0x5c0f08){console[_0x2278d6(0x1fd)]('清理冗余数据时出错:',_0x5c0f08),await _0x532f76('清理失败','发生了一个错误:\x20'+_0x5c0f08[_0x2278d6(0x1288)]);}}async function _0x36bca8(){const _0x4c63af=_0x41eae2;try{const _0xb29c54={'version':0x1,'timestamp':Date['now']()},[_0x307f5b,_0x1228b5,_0x42f84f,_0xe78f5d,_0x4375a8,_0x3ea8b4,_0x2dbd76,_0x439c7e,_0xc915bc,_0x1bfc22,_0x459c26,_0x5afde3,_0x5a2f54,_0x5994d0,_0x3f6062,_0x1dc8f2,_0x27cf4d,_0x5eec2b,_0x5ae62d,_0x442ee6,_0x771fdd,_0x321a14,_0x5f4929,_0x5b2458,_0x3e62f8]=await Promise['all']([_0x1a6951['chats'][_0x4c63af(0xc2f)](),_0x1a6951[_0x4c63af(0x8a1)]['toArray'](),_0x1a6951[_0x4c63af(0x210)]['toArray'](),_0x1a6951[_0x4c63af(0x30d)][_0x4c63af(0x650)](_0x4c63af(0x5b9)),_0x1a6951['globalSettings']['get'](_0x4c63af(0x5b9)),_0x1a6951['personaPresets'][_0x4c63af(0xc2f)](),_0x1a6951[_0x4c63af(0x1323)][_0x4c63af(0x650)]('main'),_0x1a6951['qzoneSettings']['get'](_0x4c63af(0x5b9)),_0x1a6951[_0x4c63af(0xea0)][_0x4c63af(0xc2f)](),_0x1a6951['qzoneAlbums'][_0x4c63af(0xc2f)](),_0x1a6951[_0x4c63af(0xa00)][_0x4c63af(0xc2f)](),_0x1a6951[_0x4c63af(0x183)][_0x4c63af(0xc2f)](),_0x1a6951[_0x4c63af(0x95b)][_0x4c63af(0xc2f)](),_0x1a6951[_0x4c63af(0x19e)]['toArray'](),_0x1a6951[_0x4c63af(0xe8f)][_0x4c63af(0xc2f)](),_0x1a6951[_0x4c63af(0x9b1)][_0x4c63af(0xc2f)](),_0x1a6951[_0x4c63af(0xa6d)][_0x4c63af(0xc2f)](),_0x1a6951[_0x4c63af(0x856)][_0x4c63af(0xc2f)](),_0x1a6951['renderingRules'][_0x4c63af(0xc2f)](),_0x1a6951['doubanPosts'][_0x4c63af(0xc2f)](),_0x1a6951[_0x4c63af(0x31b)][_0x4c63af(0xc2f)](),_0x1a6951[_0x4c63af(0xd09)][_0x4c63af(0xc2f)](),_0x1a6951[_0x4c63af(0x4da)]['toArray'](),_0x1a6951[_0x4c63af(0xd10)]['toArray'](),_0x1a6951[_0x4c63af(0x8ce)][_0x4c63af(0xc2f)]()]);Object[_0x4c63af(0x4e0)](_0xb29c54,{'chats':_0x307f5b,'worldBooks':_0x1228b5,'userStickers':_0x42f84f,'apiConfig':_0xe78f5d,'globalSettings':_0x4375a8,'personaPresets':_0x3ea8b4,'musicLibrary':_0x2dbd76,'qzoneSettings':_0x439c7e,'qzonePosts':_0xc915bc,'qzoneAlbums':_0x1bfc22,'qzonePhotos':_0x459c26,'favorites':_0x5afde3,'qzoneGroups':_0x5a2f54,'memories':_0x5994d0,'worldBookCategories':_0x3f6062,'apiPresets':_0x1dc8f2,'shoppingProducts':_0x27cf4d,'callRecords':_0x5eec2b,'renderingRules':_0x5ae62d,'doubanPosts':_0x442ee6,'stickerCategories':_0x771fdd,'appearancePresets':_0x321a14,'presets':_0x5f4929,'presetCategories':_0x5b2458,'npcs':_0x3e62f8});const _0x5ae880=new Blob([JSON[_0x4c63af(0x465)](_0xb29c54,null,0x2)],{'type':_0x4c63af(0xce4)}),_0x2d6222=URL[_0x4c63af(0xfc3)](_0x5ae880),_0x4e8156=Object['assign'](document[_0x4c63af(0x285)]('a'),{'href':_0x2d6222,'download':_0x4c63af(0x9e0)+new Date()[_0x4c63af(0x4df)]()['split']('T')[0x0]+_0x4c63af(0x90d)});_0x4e8156['click'](),URL['revokeObjectURL'](_0x2d6222),await _0x532f76('导出成功','已成功导出所有数据！');}catch(_0x278059){console[_0x4c63af(0x1fd)](_0x4c63af(0xb8a),_0x278059),await _0x532f76(_0x4c63af(0x11a1),_0x4c63af(0x5bb)+_0x278059[_0x4c63af(0x1288)]);}}async function _0x4461fc(_0x38ced4){const _0x48d531=_0x41eae2;try{await _0x1a6951[_0x48d531(0x93b)]('rw',_0x1a6951[_0x48d531(0x12be)],async()=>{const _0x47c56d=_0x48d531;for(const _0x2f5f25 of _0x1a6951[_0x47c56d(0x12be)]){await _0x2f5f25[_0x47c56d(0x1073)]();}for(const _0x1ff36e in _0x38ced4){Array[_0x47c56d(0xbd6)](_0x38ced4[_0x1ff36e])&&(console[_0x47c56d(0x471)](_0x47c56d(0xe18)+_0x1ff36e+',\x20记录数:\x20'+_0x38ced4[_0x1ff36e][_0x47c56d(0x7aa)]),await _0x1a6951[_0x47c56d(0x10b6)](_0x1ff36e)[_0x47c56d(0xef7)](_0x38ced4[_0x1ff36e]));}});}catch(_0x4f31aa){throw new Error(_0x48d531(0xec2)+_0x4f31aa[_0x48d531(0x1288)]);}}async function _0x4b9490(_0x576167){const _0x3eacf7=_0x41eae2;if(!_0x576167)return;const _0x1df529=await _0x4e2abc(_0x3eacf7(0xd6a),_0x3eacf7(0x7d9),{'confirmButtonClass':_0x3eacf7(0xcd8)});if(!_0x1df529)return;await _0x532f76(_0x3eacf7(0xb6a),_0x3eacf7(0x4b9));try{const _0x9872f9=await _0x576167[_0x3eacf7(0xec9)](),_0x99288=JSON[_0x3eacf7(0x2cb)](_0x9872f9);if(_0x99288[_0x3eacf7(0xd98)]&&typeof _0x99288['data']===_0x3eacf7(0x7af)&&_0x99288['data'][_0x3eacf7(0x667)])console['log'](_0x3eacf7(0x511)),await _0x4461fc(_0x99288[_0x3eacf7(0xd98)]);else{if(_0x99288[_0x3eacf7(0x667)])console['log'](_0x3eacf7(0x1d5)),await _0x1b3d8b(_0x99288);else throw new Error(_0x3eacf7(0x10b2));}await _0x532f76(_0x3eacf7(0x1145),_0x3eacf7(0x635)),setTimeout(()=>{const _0x34af24=_0x3eacf7;window[_0x34af24(0x662)][_0x34af24(0xede)]();},0x5dc);}catch(_0x4d6ad8){console[_0x3eacf7(0x1fd)]('导入数据时出错:',_0x4d6ad8),await _0x532f76(_0x3eacf7(0x53d),_0x3eacf7(0xc51)+_0x4d6ad8['message']);}}async function _0x1b3d8b(_0x17fb90){const _0x99db80=_0x41eae2;try{await _0x1a6951[_0x99db80(0x93b)]('rw',_0x1a6951[_0x99db80(0x12be)],async()=>{const _0x5d398e=_0x99db80;await _0x1a6951[_0x5d398e(0x667)][_0x5d398e(0x1073)](),await _0x1a6951[_0x5d398e(0x8a1)]['clear']();for(const _0x2f6c2b of _0x1a6951[_0x5d398e(0x12be)]){await _0x2f6c2b[_0x5d398e(0x1073)]();}if(Array['isArray'](_0x17fb90[_0x5d398e(0x667)]))await _0x1a6951['chats'][_0x5d398e(0xef7)](_0x17fb90[_0x5d398e(0x667)]);if(Array[_0x5d398e(0xbd6)](_0x17fb90[_0x5d398e(0x8a1)]))await _0x1a6951[_0x5d398e(0x8a1)]['bulkPut'](_0x17fb90[_0x5d398e(0x8a1)]);if(Array[_0x5d398e(0xbd6)](_0x17fb90['userStickers']))await _0x1a6951['userStickers'][_0x5d398e(0xef7)](_0x17fb90[_0x5d398e(0x210)]);if(_0x17fb90[_0x5d398e(0x30d)])await _0x1a6951['apiConfig']['put'](_0x17fb90['apiConfig']);if(_0x17fb90[_0x5d398e(0x21a)])await _0x1a6951[_0x5d398e(0x21a)][_0x5d398e(0xc0f)](_0x17fb90[_0x5d398e(0x21a)]);if(Array['isArray'](_0x17fb90[_0x5d398e(0x27c)]))await _0x1a6951[_0x5d398e(0x27c)][_0x5d398e(0xef7)](_0x17fb90[_0x5d398e(0x27c)]);if(_0x17fb90[_0x5d398e(0x1323)])await _0x1a6951['musicLibrary'][_0x5d398e(0xc0f)](_0x17fb90[_0x5d398e(0x1323)]);if(_0x17fb90[_0x5d398e(0x5c1)])await _0x1a6951[_0x5d398e(0x5c1)][_0x5d398e(0xc0f)](_0x17fb90[_0x5d398e(0x5c1)]);if(Array[_0x5d398e(0xbd6)](_0x17fb90['qzonePosts']))await _0x1a6951[_0x5d398e(0xea0)][_0x5d398e(0xef7)](_0x17fb90[_0x5d398e(0xea0)]);if(Array[_0x5d398e(0xbd6)](_0x17fb90[_0x5d398e(0xe6e)]))await _0x1a6951[_0x5d398e(0xe6e)][_0x5d398e(0xef7)](_0x17fb90[_0x5d398e(0xe6e)]);if(Array[_0x5d398e(0xbd6)](_0x17fb90[_0x5d398e(0xa00)]))await _0x1a6951[_0x5d398e(0xa00)][_0x5d398e(0xef7)](_0x17fb90[_0x5d398e(0xa00)]);if(Array[_0x5d398e(0xbd6)](_0x17fb90[_0x5d398e(0x183)]))await _0x1a6951[_0x5d398e(0x183)][_0x5d398e(0xef7)](_0x17fb90[_0x5d398e(0x183)]);if(Array[_0x5d398e(0xbd6)](_0x17fb90[_0x5d398e(0x95b)]))await _0x1a6951[_0x5d398e(0x95b)][_0x5d398e(0xef7)](_0x17fb90[_0x5d398e(0x95b)]);if(Array[_0x5d398e(0xbd6)](_0x17fb90[_0x5d398e(0x19e)]))await _0x1a6951[_0x5d398e(0x19e)][_0x5d398e(0xef7)](_0x17fb90['memories']);if(Array[_0x5d398e(0xbd6)](_0x17fb90[_0x5d398e(0xe8f)]))await _0x1a6951[_0x5d398e(0xe8f)]['bulkPut'](_0x17fb90[_0x5d398e(0xe8f)]);if(Array['isArray'](_0x17fb90[_0x5d398e(0x9b1)]))await _0x1a6951[_0x5d398e(0x9b1)][_0x5d398e(0xef7)](_0x17fb90[_0x5d398e(0x9b1)]);if(Array[_0x5d398e(0xbd6)](_0x17fb90[_0x5d398e(0xa6d)]))await _0x1a6951['shoppingProducts'][_0x5d398e(0xef7)](_0x17fb90['shoppingProducts']);if(Array[_0x5d398e(0xbd6)](_0x17fb90[_0x5d398e(0x856)]))await _0x1a6951[_0x5d398e(0x856)][_0x5d398e(0xef7)](_0x17fb90[_0x5d398e(0x856)]);if(Array[_0x5d398e(0xbd6)](_0x17fb90[_0x5d398e(0x1067)]))await _0x1a6951[_0x5d398e(0x1067)][_0x5d398e(0xef7)](_0x17fb90[_0x5d398e(0x1067)]);if(Array[_0x5d398e(0xbd6)](_0x17fb90[_0x5d398e(0xf52)]))await _0x1a6951[_0x5d398e(0xf52)]['bulkPut'](_0x17fb90[_0x5d398e(0xf52)]);if(Array[_0x5d398e(0xbd6)](_0x17fb90[_0x5d398e(0x31b)]))await _0x1a6951[_0x5d398e(0x31b)][_0x5d398e(0xef7)](_0x17fb90['stickerCategories']);if(Array[_0x5d398e(0xbd6)](_0x17fb90['appearancePresets']))await _0x1a6951[_0x5d398e(0xd09)][_0x5d398e(0xef7)](_0x17fb90[_0x5d398e(0xd09)]);if(Array['isArray'](_0x17fb90[_0x5d398e(0x4da)]))await _0x1a6951['presets'][_0x5d398e(0xef7)](_0x17fb90['presets']);if(Array[_0x5d398e(0xbd6)](_0x17fb90['presetCategories']))await _0x1a6951['presetCategories']['bulkPut'](_0x17fb90[_0x5d398e(0xd10)]);if(Array[_0x5d398e(0xbd6)](_0x17fb90[_0x5d398e(0x8ce)]))await _0x1a6951[_0x5d398e(0x8ce)][_0x5d398e(0xef7)](_0x17fb90[_0x5d398e(0x8ce)]);});}catch(_0x50d6d3){throw new Error('旧版备份数据写入数据库失败:\x20'+_0x50d6d3[_0x99db80(0x1288)]);}}function _0x3866c6(_0x51f4ec,_0xe2daed=![]){const _0x37b27b=_0x41eae2;if(!_0x51f4ec){_0x19651a[_0x37b27b(0x1ef)]='',document['getElementById']('font-preview')['style'][_0x37b27b(0x5dc)]='';return;}const _0x520641=_0x37b27b(0xd1d),_0xe3a819='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27'+_0x520641+_0x37b27b(0x97a)+_0x51f4ec+_0x37b27b(0x70a);if(_0xe2daed){const _0x8f7432=document[_0x37b27b(0x89d)](_0x37b27b(0x12bd))||document['createElement'](_0x37b27b(0x68e));_0x8f7432['id']=_0x37b27b(0x12bd),_0x8f7432[_0x37b27b(0x1ef)]=_0xe3a819;if(!document[_0x37b27b(0x89d)]('preview-font-style'))document[_0x37b27b(0xb0d)]['appendChild'](_0x8f7432);document[_0x37b27b(0x89d)](_0x37b27b(0x11f8))[_0x37b27b(0x68e)][_0x37b27b(0x5dc)]='\x27'+_0x520641+_0x37b27b(0x64a);}else _0x19651a[_0x37b27b(0x1ef)]=_0x37b27b(0x982)+_0xe3a819+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27'+_0x520641+_0x37b27b(0x9ef);}async function _0x2508de(){const _0x31fb17=_0x41eae2;_0x19651a[_0x31fb17(0x1ef)]='',_0x5b873d[_0x31fb17(0x21a)][_0x31fb17(0x268)]='',await _0x1a6951[_0x31fb17(0x21a)]['put'](_0x5b873d[_0x31fb17(0x21a)]),document[_0x31fb17(0x89d)]('font-url-input')[_0x31fb17(0x2f4)]='',document[_0x31fb17(0x89d)](_0x31fb17(0x11f8))[_0x31fb17(0x68e)]['fontFamily']='',alert(_0x31fb17(0x1295));}async function _0x26875f(){const _0x58a3ee=_0x41eae2,[_0x40c4ad,_0x1ebd91,_0x11e77c,_0xceeaa3,_0x41e8e0,_0xa10f01,_0x2944c0,_0x42a16b,_0x24ac29,_0x1d40d8,_0x3b6c8a]=await Promise[_0x58a3ee(0x863)]([_0x1a6951[_0x58a3ee(0x667)][_0x58a3ee(0xc2f)](),_0x1a6951['apiConfig'][_0x58a3ee(0x650)](_0x58a3ee(0x5b9)),_0x1a6951['globalSettings'][_0x58a3ee(0x650)](_0x58a3ee(0x5b9)),_0x1a6951[_0x58a3ee(0x210)]['toArray'](),_0x1a6951[_0x58a3ee(0x8a1)][_0x58a3ee(0xc2f)](),_0x1a6951['musicLibrary'][_0x58a3ee(0x650)](_0x58a3ee(0x5b9)),_0x1a6951[_0x58a3ee(0x27c)][_0x58a3ee(0xc2f)](),_0x1a6951['qzoneSettings']['get'](_0x58a3ee(0x5b9)),_0x1a6951[_0x58a3ee(0x183)][_0x58a3ee(0x6ed)]('timestamp')[_0x58a3ee(0x854)]()[_0x58a3ee(0xc2f)](),_0x1a6951[_0x58a3ee(0x19e)][_0x58a3ee(0xc2f)](),_0x1a6951[_0x58a3ee(0x4da)]['toArray']()]);_0x5b873d['presets']=_0x3b6c8a||[];const _0x297aae={'id':'main','showStatusBar':![],'wallpaper':'linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0x4cdb37},'cphoneWallpaper':_0x58a3ee(0x1335),'cphoneAppIcons':{..._0x413ad5},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x5b873d['globalSettings']={..._0x297aae,..._0x11e77c||{}},_0x5b873d[_0x58a3ee(0x21a)][_0x58a3ee(0x361)]={..._0x297aae['appIcons'],..._0x5b873d[_0x58a3ee(0x21a)][_0x58a3ee(0x361)]||{}},_0x5b873d[_0x58a3ee(0x21a)]['cphoneAppIcons']={..._0x297aae[_0x58a3ee(0xf1e)],..._0x5b873d[_0x58a3ee(0x21a)][_0x58a3ee(0xf1e)]||{}},_0x40c4ad[_0x58a3ee(0xd9a)](_0x54107a=>{const _0x2bb7e4=_0x58a3ee;typeof _0x54107a[_0x2bb7e4(0xdb9)][_0x2bb7e4(0x298)]==='undefined'&&(_0x54107a['settings'][_0x2bb7e4(0x298)]=!![]),!_0x54107a[_0x2bb7e4(0xdb9)][_0x2bb7e4(0x8c5)]&&(_0x54107a[_0x2bb7e4(0xdb9)][_0x2bb7e4(0x8c5)]={'vertical':'top','horizontal':_0x2bb7e4(0x802),'offset':0xa}),!_0x54107a[_0x2bb7e4(0x58c)]&&!_0x54107a[_0x2bb7e4(0xdb9)][_0x2bb7e4(0xe13)]&&(_0x54107a[_0x2bb7e4(0xdb9)][_0x2bb7e4(0xe13)]=[]),!_0x54107a[_0x2bb7e4(0x58c)]&&typeof _0x54107a[_0x2bb7e4(0x1045)]==='undefined'&&(_0x54107a['originalName']=_0x54107a[_0x2bb7e4(0xf74)]);}),_0x5b873d[_0x58a3ee(0x667)]=_0x40c4ad[_0x58a3ee(0x11e2)]((_0xb0b9f2,_0x38245c)=>{const _0x4e4474=_0x58a3ee;if(typeof _0x38245c[_0x4e4474(0x3ce)]===_0x4e4474(0x1bf))_0x38245c[_0x4e4474(0x3ce)]=0x0;_0x38245c[_0x4e4474(0x58c)]&&(typeof _0x38245c['settings'][_0x4e4474(0xa61)]===_0x4e4474(0x1bf)&&(_0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0xa61)]=!![]),_0x38245c[_0x4e4474(0x5ab)]&&_0x38245c[_0x4e4474(0x5ab)][_0x4e4474(0x7aa)]>0x0&&_0x38245c[_0x4e4474(0x5ab)][0x0][_0x4e4474(0xf74)]&&_0x38245c[_0x4e4474(0x5ab)][_0x4e4474(0xd9a)](_0x4ee6d3=>{const _0x3c9323=_0x4e4474;typeof _0x4ee6d3[_0x3c9323(0x1045)]===_0x3c9323(0x1bf)&&(_0x4ee6d3[_0x3c9323(0x1045)]=_0x4ee6d3['name'],_0x4ee6d3[_0x3c9323(0x7da)]=_0x4ee6d3[_0x3c9323(0xf74)],delete _0x4ee6d3[_0x3c9323(0xf74)]);}));if(!_0x38245c[_0x4e4474(0xdb9)])_0x38245c[_0x4e4474(0xdb9)]={};typeof _0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0xfd9)]==='undefined'&&(_0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0xfd9)]=0xa);if(!_0x38245c['isGroup']&&!_0x38245c[_0x4e4474(0x632)])_0x38245c[_0x4e4474(0x632)]={'text':'在线','lastUpdate':Date[_0x4e4474(0xf1a)](),'isBusy':![]};if(!_0x38245c[_0x4e4474(0x58c)]&&!_0x38245c[_0x4e4474(0x1383)])_0x38245c[_0x4e4474(0x1383)]={'status':_0x4e4474(0x123a),'blockedTimestamp':null,'applicationReason':''};if(!_0x38245c[_0x4e4474(0x58c)]&&(!_0x38245c[_0x4e4474(0xdb9)]||!_0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0x614)])){if(!_0x38245c[_0x4e4474(0xdb9)])_0x38245c[_0x4e4474(0xdb9)]={};_0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0x614)]=[];}_0x38245c[_0x4e4474(0x58c)]&&(_0x38245c[_0x4e4474(0x5ab)]||[])['forEach'](_0xb3468a=>{const _0x249be9=_0x4e4474;if(typeof _0xb3468a['avatarFrame']===_0x249be9(0x1bf))_0xb3468a[_0x249be9(0x81d)]='';});if(!_0x38245c[_0x4e4474(0x34a)])_0x38245c['musicData']={'totalTime':0x0};_0x38245c[_0x4e4474(0xdb9)]&&_0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0x867)]&&!_0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0x32d)]&&(_0x38245c['settings'][_0x4e4474(0x32d)]=[_0x38245c['settings'][_0x4e4474(0x867)]],delete _0x38245c['settings'][_0x4e4474(0x867)]);if(typeof _0x38245c['isPinned']===_0x4e4474(0x1bf))_0x38245c[_0x4e4474(0x199)]=![];!_0x38245c[_0x4e4474(0x58c)]&&typeof _0x38245c['settings'][_0x4e4474(0xc48)]==='undefined'&&(_0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0xc48)]='我');if(_0x38245c[_0x4e4474(0x58c)]&&_0x38245c[_0x4e4474(0x5ab)]){let _0xde2e7e=![];_0x40c4ad[_0x4e4474(0xd9a)](_0x1610bf=>{const _0x21ac69=_0x4e4474;_0x1610bf['id']===_0x38245c['id']&&_0x1610bf[_0x21ac69(0x1045)]&&delete _0x1610bf[_0x21ac69(0x1045)];}),_0x38245c[_0x4e4474(0x5ab)][_0x4e4474(0xd9a)](_0x10ee8c=>{const _0x3ec5ee=_0x4e4474,_0x2d7b64=_0x40c4ad[_0x3ec5ee(0x12f4)](_0x16e3f4=>_0x16e3f4['id']===_0x10ee8c['id']);if(_0x2d7b64&&_0x2d7b64[_0x3ec5ee(0xdb9)]){const _0x33050d=_0x2d7b64['settings'][_0x3ec5ee(0xeae)]||'';_0x10ee8c[_0x3ec5ee(0x81d)]!==_0x33050d&&(_0x10ee8c[_0x3ec5ee(0x81d)]=_0x33050d,_0xde2e7e=!![]);}else typeof _0x10ee8c[_0x3ec5ee(0x81d)]===_0x3ec5ee(0x1bf)&&(_0x10ee8c['avatarFrame']='',_0xde2e7e=!![]);});if(_0xde2e7e)_0x1a6951[_0x4e4474(0x667)][_0x4e4474(0xc0f)](_0x38245c);}if(!_0x38245c['settings'][_0x4e4474(0x1375)])_0x38245c['settings'][_0x4e4474(0x1375)]=![];if(!_0x38245c[_0x4e4474(0xdb9)]['autoMemoryInterval'])_0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0xe59)]=0x14;if(!_0x38245c[_0x4e4474(0xc18)])_0x38245c[_0x4e4474(0xc18)]=[];if(!_0x38245c['lastMemorySummaryTimestamp'])_0x38245c[_0x4e4474(0x46d)]=0x0;if(!_0x38245c['isGroup']){typeof _0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0xa61)]==='undefined'&&(_0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0xa61)]=!![]);typeof _0x38245c['settings'][_0x4e4474(0xe7e)]==='undefined'&&(_0x38245c[_0x4e4474(0xdb9)]['enableTts']=![]);if(!_0x38245c[_0x4e4474(0x632)])_0x38245c['status']={'text':'在线','lastUpdate':Date[_0x4e4474(0xf1a)](),'isBusy':![]};if(!_0x38245c[_0x4e4474(0x1383)])_0x38245c[_0x4e4474(0x1383)]={'status':_0x4e4474(0x123a),'blockedTimestamp':null,'applicationReason':''};if(!_0x38245c[_0x4e4474(0xdb9)]||!_0x38245c['settings'][_0x4e4474(0x614)]){if(!_0x38245c[_0x4e4474(0xdb9)])_0x38245c['settings']={};_0x38245c['settings']['aiAvatarLibrary']=[];}if(typeof _0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0xb65)]==='undefined')_0x38245c['settings'][_0x4e4474(0xb65)]=![];if(typeof _0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0x87d)]==='undefined')_0x38245c['settings'][_0x4e4474(0x87d)]=0x64;if(typeof _0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0xcb5)]===_0x4e4474(0x1bf))_0x38245c[_0x4e4474(0xdb9)]['offlineMaxLength']=0x12c;typeof _0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0x983)]===_0x4e4474(0x1bf)&&(_0x38245c['settings'][_0x4e4474(0x983)]=![]);if(typeof _0x38245c['heartfeltVoice']===_0x4e4474(0x1bf))_0x38245c[_0x4e4474(0x253)]=_0x4e4474(0x1046);if(typeof _0x38245c[_0x4e4474(0x27e)]===_0x4e4474(0x1bf))_0x38245c[_0x4e4474(0x27e)]=_0x4e4474(0x1046);!Array['isArray'](_0x38245c[_0x4e4474(0x1152)])&&(_0x38245c['thoughtsHistory']=[]);}return typeof _0x38245c['settings'][_0x4e4474(0x233)]===_0x4e4474(0x1bf)&&(_0x38245c[_0x4e4474(0xdb9)]['stickerCategoryId']?_0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0x233)]=[_0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0x353)]]:_0x38245c['settings'][_0x4e4474(0x233)]=[],delete _0x38245c[_0x4e4474(0xdb9)][_0x4e4474(0x353)]),_0xb0b9f2[_0x38245c['id']]=_0x38245c,_0xb0b9f2;},{});const _0x4012c5=[];_0x1d40d8[_0x58a3ee(0xd9a)](_0x3737b0=>{const _0x4aedfe=_0x58a3ee;if(_0x3737b0[_0x4aedfe(0x48c)]===_0x4aedfe(0x1214)&&_0x3737b0[_0x4aedfe(0xa59)]&&!_0x3737b0['authorId']){const _0x2e891a=_0x40c4ad[_0x4aedfe(0x12f4)](_0x3d8121=>!_0x3d8121[_0x4aedfe(0x58c)]&&_0x3d8121[_0x4aedfe(0x1045)]===_0x3737b0[_0x4aedfe(0xa59)]);if(_0x2e891a)_0x3737b0[_0x4aedfe(0xc3f)]=_0x2e891a['id'],_0x4012c5[_0x4aedfe(0x138c)](_0x3737b0);else{const _0x90d6e4=_0x40c4ad[_0x4aedfe(0x12f4)](_0x36ff41=>!_0x36ff41['isGroup']&&_0x36ff41['name']===_0x3737b0[_0x4aedfe(0xa59)]);_0x90d6e4&&(_0x3737b0['authorId']=_0x90d6e4['id'],_0x4012c5['push'](_0x3737b0));}}}),_0x4012c5['length']>0x0&&await _0x1a6951['memories']['bulkPut'](_0x4012c5),_0x5b873d[_0x58a3ee(0x30d)]=_0x1ebd91||{'id':_0x58a3ee(0x5b9),'proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':'speech-01'},_0x5b873d[_0x58a3ee(0x210)]=_0xceeaa3||[],_0x5b873d[_0x58a3ee(0x8a1)]=_0x41e8e0||[],_0x1f2ed8[_0x58a3ee(0x2c0)]=_0xa10f01?.[_0x58a3ee(0x2c0)]||[],_0x5b873d[_0x58a3ee(0x27c)]=_0x2944c0||[],_0x5b873d[_0x58a3ee(0x5c1)]=_0x42a16b||{'id':_0x58a3ee(0x5b9),'nickname':'{{user}}','avatar':_0x58a3ee(0x391),'banner':_0x58a3ee(0xa2d)},allFavoriteItems=_0x24ac29||[];}async function _0x4ae954(){const _0x33bdaf=_0x41eae2;await _0x1a6951[_0x33bdaf(0x1323)][_0x33bdaf(0xc0f)]({'id':_0x33bdaf(0x5b9),'playlist':_0x1f2ed8[_0x33bdaf(0x2c0)]});}function _0x3123da(_0x399c32){const _0x36f00d=_0x41eae2;if(!_0x399c32)return'';const _0x4da9bb=new Date(_0x399c32),_0x593447=String(_0x4da9bb[_0x36f00d(0x9bb)]())[_0x36f00d(0x4d8)](0x2,'0'),_0x2f5bc9=String(_0x4da9bb[_0x36f00d(0x446)]())['padStart'](0x2,'0');return _0x593447+':'+_0x2f5bc9;}function _0x4ce38e(_0x1cd658){const _0x2335ae=_0x41eae2,_0x273dba=Date[_0x2335ae(0xf1a)](),_0x4f4120=Math[_0x2335ae(0x128a)]((_0x273dba-_0x1cd658)/0x3e8);if(_0x4f4120<0x3c)return'刚刚';const _0x1cd6f8=Math[_0x2335ae(0x128a)](_0x4f4120/0x3c);if(_0x1cd6f8<0x3c)return _0x1cd6f8+_0x2335ae(0x137c);const _0x89b2c1=Math[_0x2335ae(0x128a)](_0x1cd6f8/0x3c);if(_0x89b2c1<0x18)return _0x89b2c1+_0x2335ae(0xf05);const _0x13e213=Math[_0x2335ae(0x128a)](_0x89b2c1/0x18);if(_0x13e213<0x1e)return _0x13e213+'天前';const _0x487bcc=Math[_0x2335ae(0x128a)](_0x13e213/0x1e);if(_0x487bcc<0xc)return'大约'+_0x487bcc+_0x2335ae(0x87c);const _0x2b2da4=Math[_0x2335ae(0x128a)](_0x13e213/0x16d);return'大约'+_0x2b2da4+'年前';}function _0x231991(_0x186542){const _0x371290=_0x41eae2;if(!_0x186542)return'';const _0x228f26=new Date(),_0xc01ef3=new Date(_0x186542),_0x4a170e=String(_0xc01ef3[_0x371290(0x9bb)]())['padStart'](0x2,'0'),_0x3a43df=String(_0xc01ef3[_0x371290(0x446)]())[_0x371290(0x4d8)](0x2,'0'),_0x2cc801=_0x4a170e+':'+_0x3a43df;if(_0x228f26[_0x371290(0xba4)]()===_0xc01ef3[_0x371290(0xba4)]())return'今天\x20'+_0x2cc801;const _0x4a767c=new Date();_0x4a767c['setDate'](_0x228f26[_0x371290(0x518)]()-0x1);if(_0x4a767c['toDateString']()===_0xc01ef3[_0x371290(0xba4)]())return _0x371290(0x12c2)+_0x2cc801;if(_0x228f26[_0x371290(0x555)]()===_0xc01ef3[_0x371290(0x555)]()){const _0x5522a8=String(_0xc01ef3[_0x371290(0x86f)]()+0x1),_0x1af7d9=String(_0xc01ef3[_0x371290(0x518)]());return _0x5522a8+'月'+_0x1af7d9+'日\x20'+_0x2cc801;}const _0x3c5d21=_0xc01ef3[_0x371290(0x555)](),_0x57fc0f=String(_0xc01ef3[_0x371290(0x86f)]()+0x1),_0x161620=String(_0xc01ef3[_0x371290(0x518)]());return _0x3c5d21+'年'+_0x57fc0f+'月'+_0x161620+'日\x20'+_0x2cc801;}function _0x12d819(){const _0x1e17ac=_0x41eae2,_0x2b17e5=_0x15f1a9();document[_0x1e17ac(0x89d)](_0x1e17ac(0x1de))[_0x1e17ac(0x2f4)]=_0x2b17e5[_0x1e17ac(0xe3a)],document['getElementById'](_0x1e17ac(0x5a4))[_0x1e17ac(0x2f4)]=_0x2b17e5['steps'],document[_0x1e17ac(0x89d)](_0x1e17ac(0x9ec))[_0x1e17ac(0x2f4)]=_0x2b17e5['cfg_scale'],document[_0x1e17ac(0x89d)]('nai-sampler')[_0x1e17ac(0x2f4)]=_0x2b17e5[_0x1e17ac(0xefd)],document[_0x1e17ac(0x89d)]('nai-seed')[_0x1e17ac(0x2f4)]=_0x2b17e5[_0x1e17ac(0xce3)],document[_0x1e17ac(0x89d)]('nai-uc-preset')['value']=_0x2b17e5[_0x1e17ac(0x883)],document[_0x1e17ac(0x89d)]('nai-quality-toggle')[_0x1e17ac(0x1b0)]=_0x2b17e5[_0x1e17ac(0x647)],document[_0x1e17ac(0x89d)]('nai-smea')['checked']=_0x2b17e5[_0x1e17ac(0x1270)],document['getElementById'](_0x1e17ac(0xf55))[_0x1e17ac(0x1b0)]=_0x2b17e5[_0x1e17ac(0x130a)],document[_0x1e17ac(0x89d)]('nai-default-positive')[_0x1e17ac(0x2f4)]=_0x2b17e5[_0x1e17ac(0x494)],document[_0x1e17ac(0x89d)]('nai-default-negative')['value']=_0x2b17e5[_0x1e17ac(0x6c8)],document['getElementById'](_0x1e17ac(0x320))[_0x1e17ac(0x2f4)]=_0x2b17e5['cors_proxy'],document['getElementById'](_0x1e17ac(0xe24))[_0x1e17ac(0x2f4)]=_0x2b17e5['custom_proxy_url']||'';const _0x117cf=document[_0x1e17ac(0x89d)]('nai-custom-proxy-group');_0x117cf['style'][_0x1e17ac(0x126b)]=_0x2b17e5[_0x1e17ac(0xca8)]===_0x1e17ac(0xb8f)?_0x1e17ac(0x1118):'none';}function _0x485c97(){const _0x254555=_0x41eae2,_0x55ce74=document[_0x254555(0x89d)](_0x254555(0x401))[_0x254555(0x1b0)],_0x1280ca=document[_0x254555(0x89d)]('novelai-model')[_0x254555(0x2f4)],_0x12808c=document[_0x254555(0x89d)](_0x254555(0xa5d))['value'][_0x254555(0xc3a)]();localStorage[_0x254555(0x85d)](_0x254555(0xd8f),_0x55ce74),localStorage[_0x254555(0x85d)](_0x254555(0x865),_0x1280ca),localStorage[_0x254555(0x85d)]('novelai-api-key',_0x12808c);const _0x6e5c0d={'resolution':document[_0x254555(0x89d)]('nai-resolution')[_0x254555(0x2f4)],'steps':parseInt(document[_0x254555(0x89d)](_0x254555(0x5a4))['value']),'cfg_scale':parseFloat(document[_0x254555(0x89d)](_0x254555(0x9ec))[_0x254555(0x2f4)]),'sampler':document['getElementById'](_0x254555(0x11e3))[_0x254555(0x2f4)],'seed':parseInt(document[_0x254555(0x89d)](_0x254555(0x1371))[_0x254555(0x2f4)]),'uc_preset':parseInt(document[_0x254555(0x89d)]('nai-uc-preset')['value']),'quality_toggle':document[_0x254555(0x89d)](_0x254555(0xf48))[_0x254555(0x1b0)],'smea':document[_0x254555(0x89d)](_0x254555(0x1367))[_0x254555(0x1b0)],'smea_dyn':document[_0x254555(0x89d)](_0x254555(0xf55))[_0x254555(0x1b0)],'default_positive':document[_0x254555(0x89d)]('nai-default-positive')['value'],'default_negative':document['getElementById'](_0x254555(0x4db))[_0x254555(0x2f4)],'cors_proxy':document['getElementById'](_0x254555(0x320))[_0x254555(0x2f4)],'custom_proxy_url':document[_0x254555(0x89d)](_0x254555(0xe24))[_0x254555(0x2f4)]};localStorage[_0x254555(0x85d)](_0x254555(0x1014),JSON[_0x254555(0x465)](_0x6e5c0d));}function _0x1f3b99(){const _0x50a992=_0x41eae2;localStorage[_0x50a992(0xfb1)](_0x50a992(0x1014)),_0x12d819(),alert(_0x50a992(0xf97));}function _0x15f1a9(){const _0x222c50=_0x41eae2,_0x5b9f2a={'resolution':_0x222c50(0xbb1),'steps':0x1c,'cfg_scale':0x5,'sampler':'k_euler_ancestral','seed':-0x1,'uc_preset':0x1,'quality_toggle':!![],'smea':!![],'smea_dyn':![],'default_positive':'masterpiece,\x20best\x20quality,\x201girl,\x20beautiful,\x20detailed\x20face,\x20detailed\x20eyes,\x20long\x20hair,\x20anime\x20style','default_negative':'lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','cors_proxy':_0x222c50(0x1205),'custom_proxy_url':''},_0x5b75f8=localStorage[_0x222c50(0x1344)](_0x222c50(0x1014));if(_0x5b75f8)try{return{..._0x5b9f2a,...JSON[_0x222c50(0x2cb)](_0x5b75f8)};}catch(_0x117c2c){return _0x5b9f2a;}return _0x5b9f2a;}function _0x29c3f2(_0x2c5b84){const _0x48a5eb=_0x41eae2,_0x17425e=_0x15f1a9();if(!_0x2c5b84||!_0x5b873d[_0x48a5eb(0x667)][_0x2c5b84])return console[_0x48a5eb(0x471)]('⚠️\x20NAI提示词：没有角色，使用系统配置'),{'positive':_0x17425e[_0x48a5eb(0x494)],'negative':_0x17425e[_0x48a5eb(0x6c8)],'source':_0x48a5eb(0x18c)};const _0x2363c5=_0x5b873d[_0x48a5eb(0x667)][_0x2c5b84],_0x939413=_0x2363c5['settings']['naiSettings']||{};return _0x939413['promptSource']==='character'?(console[_0x48a5eb(0x471)]('✅\x20NAI提示词：使用角色配置'),console['log'](_0x48a5eb(0x641),_0x939413[_0x48a5eb(0x10f8)]||'(空)'),console['log'](_0x48a5eb(0x64f),_0x939413[_0x48a5eb(0xa5e)]||_0x48a5eb(0xc92)),{'positive':_0x939413['characterPositivePrompt']||'','negative':_0x939413['characterNegativePrompt']||'','source':_0x48a5eb(0x132a)}):(console[_0x48a5eb(0x471)](_0x48a5eb(0xf1d)),console['log'](_0x48a5eb(0x641),_0x17425e[_0x48a5eb(0x494)]||_0x48a5eb(0xc92)),console[_0x48a5eb(0x471)](_0x48a5eb(0x64f),_0x17425e['default_negative']||'(空)'),{'positive':_0x17425e['default_positive'],'negative':_0x17425e[_0x48a5eb(0x6c8)],'source':'system'});}async function _0x1c4840(){const _0x4e4e59=_0x41eae2,_0x48710f=document[_0x4e4e59(0x89d)](_0x4e4e59(0xa5d))[_0x4e4e59(0x2f4)][_0x4e4e59(0xc3a)](),_0x1ebb86=document[_0x4e4e59(0x89d)]('novelai-model')[_0x4e4e59(0x2f4)],_0x3db7e5=document['getElementById']('nai-test-prompt')['value']['trim']();if(!_0x48710f){alert(_0x4e4e59(0x11f5));return;}if(!_0x3db7e5){alert(_0x4e4e59(0x869));return;}const _0x38393e=_0x15f1a9(),_0x4b130d=document[_0x4e4e59(0x89d)](_0x4e4e59(0xea1))[_0x4e4e59(0x2f4)][_0x4e4e59(0xc3a)](),_0x54ea5a=document[_0x4e4e59(0x89d)](_0x4e4e59(0x1059)),_0x1bfda6=document[_0x4e4e59(0x89d)](_0x4e4e59(0x114c)),_0xacda12=document[_0x4e4e59(0x89d)](_0x4e4e59(0x42b)),_0x1ed0e0=document[_0x4e4e59(0x89d)](_0x4e4e59(0x1218));_0x54ea5a[_0x4e4e59(0x68e)]['display']=_0x4e4e59(0x1118),_0x1bfda6[_0x4e4e59(0x68e)][_0x4e4e59(0x126b)]='none',_0xacda12[_0x4e4e59(0x68e)]['display']=_0x4e4e59(0x10f2),_0x1ed0e0[_0x4e4e59(0x3f7)]=!![],_0x1ed0e0[_0x4e4e59(0xf12)]=_0x4e4e59(0x2c4);try{const [_0x561190,_0x681d67]=_0x38393e[_0x4e4e59(0xe3a)][_0x4e4e59(0x55b)]('x')[_0x4e4e59(0x412)](Number);let _0x3d5462;_0x1ebb86[_0x4e4e59(0xced)](_0x4e4e59(0xf60))?_0x3d5462={'input':_0x3db7e5,'model':_0x1ebb86,'action':_0x4e4e59(0xc32),'parameters':{'params_version':0x3,'width':_0x561190,'height':_0x681d67,'scale':_0x38393e[_0x4e4e59(0x99e)],'sampler':_0x38393e[_0x4e4e59(0xefd)],'steps':_0x38393e[_0x4e4e59(0x331)],'seed':_0x38393e['seed']===-0x1?Math[_0x4e4e59(0x128a)](Math[_0x4e4e59(0xdc6)]()*0x2540be3ff):_0x38393e[_0x4e4e59(0xce3)],'n_samples':0x1,'ucPreset':_0x38393e[_0x4e4e59(0x883)],'qualityToggle':_0x38393e[_0x4e4e59(0x647)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x4e4e59(0x10fa),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x3db7e5,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x4b130d,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x4b130d,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x3d5462={'input':_0x3db7e5,'model':_0x1ebb86,'action':_0x4e4e59(0xc32),'parameters':{'width':_0x561190,'height':_0x681d67,'scale':_0x38393e[_0x4e4e59(0x99e)],'sampler':_0x38393e[_0x4e4e59(0xefd)],'steps':_0x38393e[_0x4e4e59(0x331)],'seed':_0x38393e['seed']===-0x1?Math[_0x4e4e59(0x128a)](Math[_0x4e4e59(0xdc6)]()*0x2540be3ff):_0x38393e[_0x4e4e59(0xce3)],'n_samples':0x1,'ucPreset':_0x38393e[_0x4e4e59(0x883)],'qualityToggle':_0x38393e[_0x4e4e59(0x647)],'sm':_0x38393e[_0x4e4e59(0x1270)],'sm_dyn':_0x38393e[_0x4e4e59(0x130a)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x4e4e59(0x184),'negative_prompt':_0x4b130d}};console['log'](_0x4e4e59(0x955)),console[_0x4e4e59(0x471)](_0x4e4e59(0x1180),_0x1ebb86),console['log'](_0x4e4e59(0xbe5),JSON[_0x4e4e59(0x465)](_0x3d5462,null,0x2));let _0x4e256d;_0x1ebb86['includes']('nai-diffusion-4')?_0x4e256d=_0x4e4e59(0x136e):_0x4e256d='https://image.novelai.net/ai/generate-image';let _0x351210=_0x38393e[_0x4e4e59(0xca8)];_0x351210==='custom'&&(_0x351210=_0x38393e[_0x4e4e59(0x843)]||'');_0x351210&&_0x351210!==''&&(_0x4e256d=_0x351210+encodeURIComponent(_0x4e256d));const _0x327d7f=/Chrome/[_0x4e4e59(0xb80)](navigator[_0x4e4e59(0x11e6)])&&!/Edg/['test'](navigator[_0x4e4e59(0x11e6)]);let _0x2355eb={'method':_0x4e4e59(0xd14),'headers':{'Content-Type':_0x4e4e59(0xce4),'Authorization':_0x4e4e59(0x3fb)+_0x48710f},'body':JSON['stringify'](_0x3d5462)};if(_0x327d7f){console[_0x4e4e59(0x471)](_0x4e4e59(0xff8));const _0x13f638={};for(const [_0x15ec94,_0xeb5a6]of Object[_0x4e4e59(0xa7f)](_0x2355eb[_0x4e4e59(0x4f1)])){_0x13f638[_0x15ec94]=_0xeb5a6[_0x4e4e59(0xfbf)](/[^\x00-\xFF]/g,'');}_0x2355eb[_0x4e4e59(0x4f1)]=_0x13f638;}const _0x1ac3cc=await fetch(_0x4e256d,_0x2355eb);console[_0x4e4e59(0x471)](_0x4e4e59(0x7fd),_0x1ac3cc[_0x4e4e59(0x632)]),console[_0x4e4e59(0x471)]('Response\x20headers:',[..._0x1ac3cc[_0x4e4e59(0x4f1)][_0x4e4e59(0xa7f)]()]);if(!_0x1ac3cc['ok']){const _0x455eea=await _0x1ac3cc[_0x4e4e59(0xec9)]();console[_0x4e4e59(0x1fd)]('API错误响应:',_0x455eea);throw new Error(_0x4e4e59(0x11ad)+_0x1ac3cc[_0x4e4e59(0x632)]+_0x4e4e59(0x4fe)+_0x455eea);}const _0x58f379=_0x1ac3cc[_0x4e4e59(0x4f1)][_0x4e4e59(0x650)](_0x4e4e59(0x1209));console[_0x4e4e59(0x471)](_0x4e4e59(0x11c4),_0x58f379);let _0x5a3d0e;if(_0x58f379&&_0x58f379[_0x4e4e59(0xced)](_0x4e4e59(0x9b7))){console[_0x4e4e59(0x471)](_0x4e4e59(0x10fe)),_0x54ea5a[_0x4e4e59(0xf12)]=_0x4e4e59(0xdc1);const _0xf7a624=await _0x1ac3cc['text']();console[_0x4e4e59(0x471)](_0x4e4e59(0xe52),_0xf7a624[_0x4e4e59(0x7aa)]);const _0xdd9062=_0xf7a624[_0x4e4e59(0xc3a)]()['split']('\x0a');let _0x2b9b4c=null;for(let _0xe28c56=_0xdd9062[_0x4e4e59(0x7aa)]-0x1;_0xe28c56>=0x0;_0xe28c56--){const _0x3e426f=_0xdd9062[_0xe28c56][_0x4e4e59(0xc3a)]();if(_0x3e426f['startsWith']('data:\x20')&&_0x3e426f!==_0x4e4e59(0x4cf)){const _0x4eee43=_0x3e426f[_0x4e4e59(0x489)](0x6);try{const _0x2df0e4=JSON[_0x4e4e59(0x2cb)](_0x4eee43);if(_0x2df0e4[_0x4e4e59(0x998)]===_0x4e4e59(0x10a7)&&_0x2df0e4[_0x4e4e59(0xbef)]){_0x2b9b4c=_0x2df0e4[_0x4e4e59(0xbef)],console[_0x4e4e59(0x471)](_0x4e4e59(0x1097));break;}if(_0x2df0e4[_0x4e4e59(0xd98)]){_0x2b9b4c=_0x2df0e4[_0x4e4e59(0xd98)],console[_0x4e4e59(0x471)](_0x4e4e59(0x4e3));break;}if(_0x2df0e4[_0x4e4e59(0xbef)]){_0x2b9b4c=_0x2df0e4[_0x4e4e59(0xbef)],console[_0x4e4e59(0x471)](_0x4e4e59(0xe6b));break;}}catch(_0x37f7ec){_0x2b9b4c=_0x4eee43,console[_0x4e4e59(0x471)](_0x4e4e59(0xe09));break;}}}if(!_0x2b9b4c)throw new Error(_0x4e4e59(0x67f));const _0x5ecba3=_0x2b9b4c[_0x4e4e59(0x1222)](_0x4e4e59(0x122a)),_0x1500e7=_0x2b9b4c['startsWith'](_0x4e4e59(0x1af));if(_0x5ecba3||_0x1500e7){console['log'](_0x4e4e59(0xc08));const _0x556864=atob(_0x2b9b4c),_0x3c4d47=new Uint8Array(_0x556864['length']);for(let _0x5b0b2d=0x0;_0x5b0b2d<_0x556864[_0x4e4e59(0x7aa)];_0x5b0b2d++){_0x3c4d47[_0x5b0b2d]=_0x556864['charCodeAt'](_0x5b0b2d);}const _0xcf49d7=new Blob([_0x3c4d47],{'type':_0x5ecba3?_0x4e4e59(0x572):_0x4e4e59(0xd48)});console[_0x4e4e59(0x471)](_0x4e4e59(0x8c9),_0xcf49d7[_0x4e4e59(0x746)]);const _0x353b7d=URL[_0x4e4e59(0xfc3)](_0xcf49d7);document[_0x4e4e59(0x89d)]('nai-result-image')[_0x4e4e59(0x9e3)]=_0x353b7d,_0x54ea5a[_0x4e4e59(0x68e)][_0x4e4e59(0x126b)]='none',_0x1bfda6[_0x4e4e59(0x68e)][_0x4e4e59(0x126b)]=_0x4e4e59(0x1118),console['log'](_0x4e4e59(0xe23));return;}console[_0x4e4e59(0x471)](_0x4e4e59(0x418));const _0x389abc=atob(_0x2b9b4c),_0x4fd69f=new Uint8Array(_0x389abc[_0x4e4e59(0x7aa)]);for(let _0x1f2302=0x0;_0x1f2302<_0x389abc['length'];_0x1f2302++){_0x4fd69f[_0x1f2302]=_0x389abc[_0x4e4e59(0x11eb)](_0x1f2302);}_0x5a3d0e=new Blob([_0x4fd69f]),console[_0x4e4e59(0x471)](_0x4e4e59(0x1c3),_0x5a3d0e['size']);}else _0x5a3d0e=await _0x1ac3cc[_0x4e4e59(0x122f)](),console[_0x4e4e59(0x471)](_0x4e4e59(0xe83),_0x5a3d0e[_0x4e4e59(0x48c)],_0x4e4e59(0x426),_0x5a3d0e[_0x4e4e59(0x746)]);try{if(typeof JSZip===_0x4e4e59(0x1bf))throw new Error('JSZip库未加载，请刷新页面重试');_0x54ea5a[_0x4e4e59(0xf12)]='正在解压图片...';const _0xca3b73=await JSZip[_0x4e4e59(0xdaa)](_0x5a3d0e);console[_0x4e4e59(0x471)](_0x4e4e59(0x1f8),Object[_0x4e4e59(0xe9c)](_0xca3b73[_0x4e4e59(0x541)]));let _0x416d3b=null;for(let _0x543aa9 in _0xca3b73['files']){if(_0x543aa9[_0x4e4e59(0x86c)](/\.(png|jpg|jpeg|webp)$/i)){_0x416d3b=_0xca3b73[_0x4e4e59(0x541)][_0x543aa9],console['log']('找到图片文件:',_0x543aa9);break;}}if(!_0x416d3b)throw new Error(_0x4e4e59(0x571));const _0x50e05d=await _0x416d3b[_0x4e4e59(0x7d2)](_0x4e4e59(0x122f));console[_0x4e4e59(0x471)](_0x4e4e59(0xe2e),_0x50e05d['size']);const _0x184e05=URL[_0x4e4e59(0xfc3)](_0x50e05d);console[_0x4e4e59(0x471)](_0x4e4e59(0x211),_0x184e05),document[_0x4e4e59(0x89d)](_0x4e4e59(0xee6))['src']=_0x184e05,_0x54ea5a[_0x4e4e59(0x68e)][_0x4e4e59(0x126b)]=_0x4e4e59(0x10f2),_0x1bfda6[_0x4e4e59(0x68e)][_0x4e4e59(0x126b)]=_0x4e4e59(0x1118);}catch(_0x679540){console[_0x4e4e59(0x1fd)](_0x4e4e59(0x306),_0x679540),console[_0x4e4e59(0x471)]('尝试直接作为图片显示...');if(_0x5a3d0e['type'][_0x4e4e59(0x1222)](_0x4e4e59(0x5b3))){const _0x5ce74c=URL['createObjectURL'](_0x5a3d0e);document[_0x4e4e59(0x89d)]('nai-result-image')['src']=_0x5ce74c,_0x54ea5a['style'][_0x4e4e59(0x126b)]='none',_0x1bfda6[_0x4e4e59(0x68e)][_0x4e4e59(0x126b)]=_0x4e4e59(0x1118);}else throw new Error(_0x4e4e59(0x309)+_0x679540['message']);}}catch(_0x67ede0){console[_0x4e4e59(0x1fd)]('NovelAI生成失败:',_0x67ede0),_0x54ea5a[_0x4e4e59(0x68e)][_0x4e4e59(0x126b)]=_0x4e4e59(0x10f2),_0xacda12['style'][_0x4e4e59(0x126b)]=_0x4e4e59(0x1118),_0xacda12['textContent']='生成失败:\x20'+_0x67ede0[_0x4e4e59(0x1288)];}finally{_0x1ed0e0[_0x4e4e59(0x3f7)]=![],_0x1ed0e0[_0x4e4e59(0xf12)]=_0x4e4e59(0xbc8);}}function _0x23fbd5(_0x548ef7,_0x2c01ba){const _0x3a55d6=_0x41eae2;_0x4541bb(),clearTimeout(_0x388438);const _0x16047f=_0x5b873d[_0x3a55d6(0x667)][_0x548ef7];if(!_0x16047f)return;const _0x39c34d=document[_0x3a55d6(0x89d)]('notification-bar');document[_0x3a55d6(0x89d)]('notification-avatar')['src']=_0x16047f[_0x3a55d6(0xdb9)][_0x3a55d6(0xdd3)]||_0x16047f[_0x3a55d6(0xdb9)][_0x3a55d6(0x108a)]||_0x265fcc,document[_0x3a55d6(0x89d)](_0x3a55d6(0x686))[_0x3a55d6(0xd16)](_0x3a55d6(0x91a))[_0x3a55d6(0xf12)]=_0x16047f['name'],document[_0x3a55d6(0x89d)](_0x3a55d6(0x686))[_0x3a55d6(0xd16)](_0x3a55d6(0x105e))[_0x3a55d6(0xf12)]=_0x2c01ba,_0x39c34d[_0x3a55d6(0x2f1)][_0x3a55d6(0x1247)](_0x3a55d6(0x11e4)),void _0x39c34d[_0x3a55d6(0xf13)],_0x39c34d['classList'][_0x3a55d6(0x569)](_0x3a55d6(0x11e4));const _0x546aa7=_0x39c34d[_0x3a55d6(0xf2a)](!![]);_0x39c34d[_0x3a55d6(0xb6e)][_0x3a55d6(0xd38)](_0x546aa7,_0x39c34d),_0x546aa7[_0x3a55d6(0x1193)](_0x3a55d6(0x12a5),()=>{const _0x38aac5=_0x3a55d6;_0x597f5a(_0x548ef7),_0x546aa7['classList']['remove'](_0x38aac5(0x11e4));}),_0x388438=setTimeout(()=>{const _0x5c8d97=_0x3a55d6;_0x546aa7[_0x5c8d97(0x2f1)][_0x5c8d97(0x1247)](_0x5c8d97(0x11e4));},0xfa0),_0x255a31();}function _0x4e8690(){const _0xc001fc=_0x41eae2,_0x56cbc6=new Date(),_0x3f07b7=_0x56cbc6[_0xc001fc(0x110c)](_0xc001fc(0x1e8),{'hour':_0xc001fc(0x810),'minute':_0xc001fc(0x810)}),_0x12b111=_0x56cbc6['toLocaleDateString'](_0xc001fc(0x1e8),{'weekday':_0xc001fc(0xa65),'month':_0xc001fc(0xa65),'day':_0xc001fc(0xe93)});document[_0xc001fc(0x89d)](_0xc001fc(0x504))[_0xc001fc(0xf12)]=_0x3f07b7;}function _0x29a17f(_0x42ffdc){const _0x3cf0bb=_0x41eae2,_0x346aae=_0x42ffdc['trim']();if(_0x346aae[_0x3cf0bb(0x1222)]('[')&&_0x346aae[_0x3cf0bb(0x77a)](']'))try{const _0x1993a3=JSON['parse'](_0x346aae);if(Array[_0x3cf0bb(0xbd6)](_0x1993a3))return console[_0x3cf0bb(0x471)](_0x3cf0bb(0xedb)),_0x1993a3;}catch(_0x4f2b82){console['warn']('标准JSON数组解析失败，将尝试强力解析...');}const _0x17a0a4=_0x346aae[_0x3cf0bb(0x86c)](/{[^{}]*}/g);if(_0x17a0a4){const _0x5f2391=[];for(const _0x48287b of _0x17a0a4){try{const _0xd56cd7=JSON['parse'](_0x48287b);_0x5f2391[_0x3cf0bb(0x138c)](_0xd56cd7);}catch(_0xe41e77){console[_0x3cf0bb(0xac3)]('跳过一个无效的JSON片段:',_0x48287b);}}if(_0x5f2391['length']>0x0)return console['log'](_0x3cf0bb(0x18e)),_0x5f2391;}return console[_0x3cf0bb(0x1fd)](_0x3cf0bb(0x81a)),[{'type':_0x3cf0bb(0xec9),'content':_0x42ffdc}];}function _0x10282a(_0x3841fb=new Date()){const _0x535086=_0x41eae2,_0x48194e=_0x3841fb[_0x535086(0x9bb)]();if(_0x48194e>=0x0&&_0x48194e<0x5)return'凌晨';else{if(_0x48194e>=0x5&&_0x48194e<0x9)return'早上';else{if(_0x48194e>=0x9&&_0x48194e<0xd)return'上午';else{if(_0x48194e>=0xd&&_0x48194e<0x12)return'下午';else{if(_0x48194e>=0x12&&_0x48194e<0x18)return'晚上';}}}}return'现在';}async function _0x4bab7c(){const _0x22e832=_0x41eae2,_0xb9f14c=document[_0x22e832(0x89d)](_0x22e832(0x9a3));_0xb9f14c[_0x22e832(0x1ef)]=_0x22e832(0xd19);const _0x11f397=await _0x1a6951[_0x22e832(0x9b1)][_0x22e832(0xc2f)]();_0x11f397['forEach'](_0x4ea96f=>{const _0x2abbce=_0x22e832,_0x243b5d=document[_0x2abbce(0x285)](_0x2abbce(0xc39));_0x243b5d[_0x2abbce(0x2f4)]=_0x4ea96f['id'],_0x243b5d[_0x2abbce(0xf12)]=_0x4ea96f[_0x2abbce(0xf74)],_0xb9f14c['appendChild'](_0x243b5d);});const _0x367844=_0x5b873d['apiConfig'];let _0x39c095=null;for(const _0x61df9e of _0x11f397){if(_0x61df9e[_0x22e832(0x57c)]===_0x367844[_0x22e832(0x57c)]&&_0x61df9e[_0x22e832(0x9e6)]===_0x367844[_0x22e832(0x9e6)]&&_0x61df9e[_0x22e832(0x1364)]===_0x367844[_0x22e832(0x1364)]&&_0x61df9e[_0x22e832(0x989)]===_0x367844[_0x22e832(0x989)]&&_0x61df9e['secondaryApiKey']===_0x367844[_0x22e832(0x2cf)]&&_0x61df9e[_0x22e832(0x10f0)]===_0x367844['secondaryModel']&&(_0x61df9e[_0x22e832(0xdf9)]||'')===(_0x367844['minimaxGroupId']||'')&&(_0x61df9e[_0x22e832(0x966)]||'')===(_0x367844[_0x22e832(0x966)]||'')&&(_0x61df9e[_0x22e832(0xeb8)]||_0x22e832(0x947))===(_0x367844[_0x22e832(0xeb8)]||'speech-01')){_0x39c095=_0x61df9e['id'];break;}}_0x39c095?_0xb9f14c[_0x22e832(0x2f4)]=_0x39c095:_0xb9f14c[_0x22e832(0x2f4)]=_0x22e832(0x915);}async function _0x2e702d(){const _0x31b358=_0x41eae2,_0x3f3f91=document[_0x31b358(0x89d)](_0x31b358(0x9a3)),_0x5b6870=parseInt(_0x3f3f91[_0x31b358(0x2f4)]);if(isNaN(_0x5b6870))return;const _0x2ad224=await _0x1a6951[_0x31b358(0x9b1)][_0x31b358(0x650)](_0x5b6870);_0x2ad224&&(_0x5b873d['apiConfig']={'id':'main','proxyUrl':_0x2ad224[_0x31b358(0x57c)],'apiKey':_0x2ad224[_0x31b358(0x9e6)],'model':_0x2ad224[_0x31b358(0x1364)],'secondaryProxyUrl':_0x2ad224[_0x31b358(0x989)],'secondaryApiKey':_0x2ad224[_0x31b358(0x2cf)],'secondaryModel':_0x2ad224[_0x31b358(0x10f0)],'minimaxGroupId':_0x2ad224['minimaxGroupId'],'minimaxApiKey':_0x2ad224[_0x31b358(0x966)],'minimaxModel':_0x2ad224[_0x31b358(0xeb8)]},await _0x1a6951[_0x31b358(0x30d)][_0x31b358(0xc0f)](_0x5b873d[_0x31b358(0x30d)]),_0x146ab1(),document[_0x31b358(0x89d)]('fetch-models-btn')[_0x31b358(0x12a5)](),_0x2ad224['secondaryProxyUrl']&&_0x2ad224[_0x31b358(0x2cf)]&&document[_0x31b358(0x89d)]('fetch-secondary-models-btn')[_0x31b358(0x12a5)](),alert('已加载预设\x20“'+_0x2ad224[_0x31b358(0xf74)]+'”'));}async function _0x31b3a9(){const _0xa4056c=_0x41eae2,_0xb06a90=await _0x34d246(_0xa4056c(0xfa0),_0xa4056c(0x9e1));if(!_0xb06a90||!_0xb06a90['trim']())return;const _0x453fa3={'name':_0xb06a90[_0xa4056c(0xc3a)](),'proxyUrl':document[_0xa4056c(0x89d)]('proxy-url')[_0xa4056c(0x2f4)]['trim'](),'apiKey':document[_0xa4056c(0x89d)](_0xa4056c(0x12ad))[_0xa4056c(0x2f4)][_0xa4056c(0xc3a)](),'model':document[_0xa4056c(0x89d)](_0xa4056c(0x393))[_0xa4056c(0x2f4)],'secondaryProxyUrl':document[_0xa4056c(0x89d)](_0xa4056c(0x115a))[_0xa4056c(0x2f4)][_0xa4056c(0xc3a)](),'secondaryApiKey':document[_0xa4056c(0x89d)](_0xa4056c(0x11c9))[_0xa4056c(0x2f4)][_0xa4056c(0xc3a)](),'secondaryModel':document[_0xa4056c(0x89d)](_0xa4056c(0x8be))[_0xa4056c(0x2f4)],'minimaxGroupId':document[_0xa4056c(0x89d)]('minimax-group-id')[_0xa4056c(0x2f4)][_0xa4056c(0xc3a)](),'minimaxApiKey':document[_0xa4056c(0x89d)](_0xa4056c(0x485))['value']['trim'](),'minimaxModel':document['getElementById']('minimax-model-select')[_0xa4056c(0x2f4)]},_0x560aac=await _0x1a6951[_0xa4056c(0x9b1)][_0xa4056c(0x176)]('name')[_0xa4056c(0xb17)](_0x453fa3[_0xa4056c(0xf74)])[_0xa4056c(0x2a6)]();if(_0x560aac){const _0x1ec376=await _0x4e2abc(_0xa4056c(0x174),_0xa4056c(0xa06)+_0x453fa3[_0xa4056c(0xf74)]+_0xa4056c(0x6c7),{'confirmButtonClass':_0xa4056c(0xcd8)});if(!_0x1ec376)return;_0x453fa3['id']=_0x560aac['id'];}await _0x1a6951[_0xa4056c(0x9b1)]['put'](_0x453fa3),await _0x4bab7c(),alert(_0xa4056c(0xcc0));}async function _0x20091f(){const _0x335377=_0x41eae2,_0x2136d6=document['getElementById']('api-preset-select'),_0x1c02e3=parseInt(_0x2136d6[_0x335377(0x2f4)]);if(isNaN(_0x1c02e3)){alert(_0x335377(0x751));return;}const _0x28d72e=await _0x1a6951[_0x335377(0x9b1)][_0x335377(0x650)](_0x1c02e3);if(!_0x28d72e)return;const _0x4915ac=await _0x4e2abc('删除预设',_0x335377(0x1050)+_0x28d72e[_0x335377(0xf74)]+'”\x20吗？',{'confirmButtonClass':_0x335377(0xcd8)});_0x4915ac&&(await _0x1a6951[_0x335377(0x9b1)]['delete'](_0x1c02e3),await _0x4bab7c(),alert(_0x335377(0x1301)));}function _0x146ab1(){const _0x2e2f27=_0x41eae2;document['getElementById']('proxy-url')[_0x2e2f27(0x2f4)]=_0x5b873d[_0x2e2f27(0x30d)][_0x2e2f27(0x57c)]||'',document['getElementById']('api-key')['value']=_0x5b873d['apiConfig'][_0x2e2f27(0x9e6)]||'',document[_0x2e2f27(0x89d)]('secondary-proxy-url')['value']=_0x5b873d[_0x2e2f27(0x30d)][_0x2e2f27(0x989)]||'',document[_0x2e2f27(0x89d)]('secondary-api-key')[_0x2e2f27(0x2f4)]=_0x5b873d[_0x2e2f27(0x30d)][_0x2e2f27(0x2cf)]||'',document[_0x2e2f27(0x89d)](_0x2e2f27(0x1026))[_0x2e2f27(0x1b0)]=_0x5b873d[_0x2e2f27(0x21a)][_0x2e2f27(0xa61)]||![],document[_0x2e2f27(0x89d)](_0x2e2f27(0x11a5))[_0x2e2f27(0x2f4)]=_0x5b873d[_0x2e2f27(0x21a)][_0x2e2f27(0x3ab)]||0x3c,document[_0x2e2f27(0x89d)](_0x2e2f27(0xd81))['value']=_0x5b873d[_0x2e2f27(0x21a)][_0x2e2f27(0x11bf)]||0x1,document[_0x2e2f27(0x89d)](_0x2e2f27(0xbe7))[_0x2e2f27(0x1b0)]=_0x5b873d['globalSettings']['enableAiDrawing'],document[_0x2e2f27(0x89d)](_0x2e2f27(0xa1b))[_0x2e2f27(0x2f4)]=_0x5b873d[_0x2e2f27(0x21a)][_0x2e2f27(0x2f3)]||0x32,document[_0x2e2f27(0x89d)](_0x2e2f27(0x714))['value']=_0x5b873d[_0x2e2f27(0x21a)][_0x2e2f27(0xbd9)]||0x1e;const _0x5ca71e=document['getElementById'](_0x2e2f27(0xb77)),_0x5802b0=document[_0x2e2f27(0x89d)](_0x2e2f27(0xb7d)),_0x5ce2b4=_0x5b873d[_0x2e2f27(0x21a)][_0x2e2f27(0x576)]||0.8;_0x5ca71e[_0x2e2f27(0x2f4)]=_0x5ce2b4,_0x5802b0[_0x2e2f27(0xf12)]=_0x5ce2b4,document[_0x2e2f27(0x89d)](_0x2e2f27(0xfd0))[_0x2e2f27(0x2f4)]=_0x5b873d[_0x2e2f27(0x30d)][_0x2e2f27(0xdf9)]||'',document[_0x2e2f27(0x89d)](_0x2e2f27(0x485))[_0x2e2f27(0x2f4)]=_0x5b873d[_0x2e2f27(0x30d)][_0x2e2f27(0x966)]||'',document[_0x2e2f27(0x89d)](_0x2e2f27(0x2d8))[_0x2e2f27(0x2f4)]=_0x5b873d[_0x2e2f27(0x30d)][_0x2e2f27(0xeb8)]||_0x2e2f27(0x947),_0x4bab7c(),_0x1cdc57();}window[_0x41eae2(0xa8f)]=_0x146ab1;async function _0x32c7e8(){const _0x5e32c4=_0x41eae2,_0x2ebfa0=document[_0x5e32c4(0x89d)](_0x5e32c4(0x1381));_0x2ebfa0[_0x5e32c4(0x1ef)]='';const _0x3a1341=await _0x1a6951[_0x5e32c4(0x8ce)][_0x5e32c4(0xc2f)]();if(_0x3a1341[_0x5e32c4(0x7aa)]===0x0){_0x2ebfa0[_0x5e32c4(0x1ef)]=_0x5e32c4(0x4ab);return;}_0x3a1341[_0x5e32c4(0xd9a)](_0x20009d=>{const _0x4ef5e1=_0x5e32c4,_0x1b1c66=document['createElement'](_0x4ef5e1(0xb25));_0x1b1c66[_0x4ef5e1(0x81c)]='chat-list-item',_0x1b1c66['dataset'][_0x4ef5e1(0xe88)]=_0x20009d['id'],_0x1b1c66[_0x4ef5e1(0x1ef)]=_0x4ef5e1(0x8dd)+(_0x20009d[_0x4ef5e1(0x12c8)]||_0x15061e)+_0x4ef5e1(0x594)+_0x20009d[_0x4ef5e1(0xf74)]+_0x4ef5e1(0x7fc)+_0x20009d[_0x4ef5e1(0x1170)][_0x4ef5e1(0x489)](0x0,0x1e)+_0x4ef5e1(0x814),_0x1b1c66[_0x4ef5e1(0x1193)](_0x4ef5e1(0x12a5),()=>_0x39f7c8(_0x20009d['id'])),_0xefe9e2(_0x1b1c66,async()=>{await _0x4ae7af(_0x20009d['id']);}),_0x2ebfa0[_0x4ef5e1(0x22f)](_0x1b1c66);});}async function _0x39f7c8(_0x3b36a1=null){const _0x1b6f62=_0x41eae2;editingNpcId=_0x3b36a1;const _0x103d77=document[_0x1b6f62(0x89d)](_0x1b6f62(0xc71)),_0x42afed=document[_0x1b6f62(0x89d)](_0x1b6f62(0xef2)),_0x1acba7=document[_0x1b6f62(0x89d)](_0x1b6f62(0xefa)),_0x26fe9f=document[_0x1b6f62(0x89d)](_0x1b6f62(0xbfc)),_0x3def99=document['getElementById'](_0x1b6f62(0x128f)),_0x339401=document['getElementById'](_0x1b6f62(0xe20)),_0x2a805c=document[_0x1b6f62(0x89d)](_0x1b6f62(0x463)),_0x5bf479=document[_0x1b6f62(0x89d)](_0x1b6f62(0x3d7));_0x339401[_0x1b6f62(0x1ef)]='',_0x339401[_0x1b6f62(0x1ef)]+=_0x1b6f62(0x1027)+(_0x5b873d[_0x1b6f62(0x5c1)]['nickname']||'我')+_0x1b6f62(0x3ea),Object[_0x1b6f62(0x4b5)](_0x5b873d['chats'])['filter'](_0x143992=>!_0x143992[_0x1b6f62(0x58c)])[_0x1b6f62(0xd9a)](_0x2ed47a=>{const _0x474399=_0x1b6f62;_0x339401['innerHTML']+='<label><input\x20type=\x22checkbox\x22\x20value=\x22'+_0x2ed47a['id']+_0x474399(0xe16)+_0x2ed47a['name']+_0x474399(0x11aa);});if(_0x3b36a1){_0x42afed[_0x1b6f62(0xf12)]='编辑\x20NPC';const _0x391e85=await _0x1a6951[_0x1b6f62(0x8ce)]['get'](_0x3b36a1);_0x391e85&&(_0x1acba7['value']=_0x391e85[_0x1b6f62(0xf74)],_0x26fe9f[_0x1b6f62(0x2f4)]=_0x391e85[_0x1b6f62(0x1170)],_0x3def99[_0x1b6f62(0x9e3)]=_0x391e85[_0x1b6f62(0x12c8)]||_0x15061e,_0x2a805c[_0x1b6f62(0x1b0)]=_0x391e85[_0x1b6f62(0xa61)]!==![],_0x5bf479[_0x1b6f62(0x2f4)]=_0x391e85[_0x1b6f62(0xfd9)]||0xf,_0x391e85['associatedWith']&&Array[_0x1b6f62(0xbd6)](_0x391e85['associatedWith'])&&_0x391e85[_0x1b6f62(0x12e2)]['forEach'](_0x13095f=>{const _0x4181ca=_0x1b6f62,_0x1023ed=_0x339401[_0x4181ca(0xd16)]('input[value=\x22'+_0x13095f+'\x22]');if(_0x1023ed)_0x1023ed['checked']=!![];}));}else{_0x42afed['textContent']=_0x1b6f62(0x1be),_0x1acba7[_0x1b6f62(0x2f4)]='',_0x26fe9f[_0x1b6f62(0x2f4)]='',_0x3def99[_0x1b6f62(0x9e3)]=_0x15061e,_0x2a805c[_0x1b6f62(0x1b0)]=!![],_0x5bf479['value']=0xf;const _0x56b1cf=_0x339401[_0x1b6f62(0xd16)](_0x1b6f62(0x1009));if(_0x56b1cf)_0x56b1cf[_0x1b6f62(0x1b0)]=!![];}_0x103d77[_0x1b6f62(0x2f1)][_0x1b6f62(0x569)](_0x1b6f62(0x11e4));}async function _0xbf8ff6(){const _0x13202e=_0x41eae2,_0x1042a9=document[_0x13202e(0x89d)]('npc-name-input')[_0x13202e(0x2f4)][_0x13202e(0xc3a)](),_0x298623=document[_0x13202e(0x89d)]('npc-persona-input')[_0x13202e(0x2f4)]['trim']();if(!_0x1042a9||!_0x298623){alert('NPC的昵称和人设都不能为空！');return;}const _0xb9da1=Array[_0x13202e(0x321)](document[_0x13202e(0x35f)](_0x13202e(0x80f)))[_0x13202e(0x412)](_0x11dc45=>_0x11dc45[_0x13202e(0x2f4)]),_0x3fc755=document[_0x13202e(0x89d)](_0x13202e(0x463))[_0x13202e(0x1b0)],_0x22b439=parseInt(document['getElementById']('npc-action-cooldown-input')[_0x13202e(0x2f4)])||0xf,_0x166d2c={'name':_0x1042a9,'persona':_0x298623,'avatar':document[_0x13202e(0x89d)]('npc-avatar-preview')[_0x13202e(0x9e3)],'associatedWith':_0xb9da1,'enableBackgroundActivity':_0x3fc755,'actionCooldownMinutes':_0x22b439};if(editingNpcId)await _0x1a6951[_0x13202e(0x8ce)][_0x13202e(0xdfc)](editingNpcId,_0x166d2c);else{const _0x4b9a36=await _0x1a6951[_0x13202e(0x8ce)][_0x13202e(0x569)](_0x166d2c);if(_0x32afbb&&_0x5b873d[_0x13202e(0xf96)]){const _0x12c559=_0x5b873d[_0x13202e(0x667)][_0x5b873d['activeChatId']];_0x12c559[_0x13202e(0x58c)]&&(_0x12c559['members'][_0x13202e(0x138c)]({'id':_0x13202e(0x5b8)+_0x4b9a36,'originalName':_0x1042a9,'groupNickname':_0x1042a9,'persona':_0x298623,'avatar':_0x166d2c['avatar'],'isNpc':!![]}),await _0x1a6951[_0x13202e(0x667)][_0x13202e(0xc0f)](_0x12c559));}}document[_0x13202e(0x89d)](_0x13202e(0xc71))[_0x13202e(0x2f1)]['remove'](_0x13202e(0x11e4)),_0x32afbb?(_0x32afbb=![],_0x55b8af()):await _0x32c7e8();}async function _0x4ae7af(_0x4fe7b4){const _0x528627=_0x41eae2,_0x4b6e08=await _0x1a6951[_0x528627(0x8ce)][_0x528627(0x650)](_0x4fe7b4);if(!_0x4b6e08)return;const _0x1e26b3=await _0x4e2abc(_0x528627(0xe95),_0x528627(0x6e0)+_0x4b6e08[_0x528627(0xf74)]+_0x528627(0x100e),{'confirmButtonClass':_0x528627(0xcd8)});_0x1e26b3&&(await _0x1a6951[_0x528627(0x8ce)][_0x528627(0x684)](_0x4fe7b4),await _0x32c7e8());}let _0x29d60c=0x0;function _0x3cfe69(_0x5c5375){const _0x4a6124=_0x41eae2,_0x198108=document[_0x4a6124(0x285)]('div');return _0x198108[_0x4a6124(0x81c)]=_0x4a6124(0x35c),_0x198108[_0x4a6124(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x5c5375['name']+_0x4a6124(0x106a),_0x198108;}function _0x3dd421(_0x2c1252){const _0x521200=_0x41eae2,_0x44969d=document['getElementById']('chat-list'),_0xaf850a=document[_0x521200(0x89d)](_0x521200(0x100f));if(_0xaf850a)_0xaf850a[_0x521200(0x1247)]();const _0x3867d1=_0x29d60c,_0x2ec6be=_0x29d60c+CHAT_LIST_RENDER_WINDOW,_0x5bfeaa=_0x2c1252['slice'](_0x3867d1,_0x2ec6be),_0x4786eb=document[_0x521200(0xfc9)]();let _0xf0272d=_0x44969d[_0x521200(0xd16)]('.chat-group-content:last-of-type');_0x5bfeaa[_0x521200(0xd9a)](_0x4205c6=>{const _0x2420f5=_0x521200;if(_0x4205c6[_0x2420f5(0x48c)]===_0x2420f5(0x10e2)){const _0x2c596f=_0x3cfe69(_0x4205c6['group']);_0x4786eb[_0x2420f5(0x22f)](_0x2c596f),_0xf0272d=_0x2c596f['querySelector'](_0x2420f5(0x1161));}else{if(_0x4205c6['type']===_0x2420f5(0x1300)){const _0x4dc6bb=_0x1efd8b(_0x4205c6[_0x2420f5(0xde9)]);_0xf0272d&&_0x4205c6['chat'][_0x2420f5(0xb54)]?_0xf0272d[_0x2420f5(0x22f)](_0x4dc6bb):(_0x4786eb['appendChild'](_0x4dc6bb),_0xf0272d=null);}}}),_0x44969d['appendChild'](_0x4786eb),_0x29d60c+=_0x5bfeaa[_0x521200(0x7aa)],_0x2c1252[_0x521200(0x7aa)]>_0x29d60c&&_0x4cd81c(_0x44969d,_0x2c1252),document[_0x521200(0x35f)]('.chat-group-header')[_0x521200(0xd9a)](_0x418867=>{const _0x120f28=_0x521200,_0x550940=_0x418867['cloneNode'](!![]);_0x418867['parentNode'][_0x120f28(0xd38)](_0x550940,_0x418867),_0x550940[_0x120f28(0x1193)](_0x120f28(0x12a5),()=>{const _0xd3a8=_0x120f28;_0x550940['classList'][_0xd3a8(0x73b)](_0xd3a8(0x313)),_0x550940[_0xd3a8(0x486)][_0xd3a8(0x2f1)]['toggle'](_0xd3a8(0x313));});});}async function _0x413d78(){const _0x163243=_0x41eae2,_0x13ede3=document[_0x163243(0x89d)](_0x163243(0x2ca));_0x13ede3[_0x163243(0x1ef)]='';const _0x5ca95f=Object[_0x163243(0x4b5)](_0x5b873d['chats'])[_0x163243(0x2e3)]((_0x160500,_0x2ddef4)=>{const _0x4d0d4a=_0x163243,_0x571f55=(_0x2ddef4[_0x4d0d4a(0x199)]||![])-(_0x160500['isPinned']||![]);if(_0x571f55!==0x0)return _0x571f55;return(_0x2ddef4['history'][_0x4d0d4a(0xdd0)](-0x1)[0x0]?.[_0x4d0d4a(0x114e)]||0x0)-(_0x160500[_0x4d0d4a(0x551)][_0x4d0d4a(0xdd0)](-0x1)[0x0]?.[_0x4d0d4a(0x114e)]||0x0);}),_0x10e065=await _0x1a6951[_0x163243(0x95b)][_0x163243(0xc2f)]();if(_0x5ca95f[_0x163243(0x7aa)]===0x0){_0x13ede3[_0x163243(0x1ef)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>';return;}_0x10e065[_0x163243(0xd9a)](_0x27e7f8=>{const _0x5b9efb=_0x163243,_0x18f4f4=_0x5ca95f[_0x5b9efb(0x12f4)](_0x15e30a=>_0x15e30a[_0x5b9efb(0xb54)]===_0x27e7f8['id']);_0x27e7f8['latestTimestamp']=_0x18f4f4?_0x18f4f4[_0x5b9efb(0x551)][_0x5b9efb(0xdd0)](-0x1)[0x0]?.[_0x5b9efb(0x114e)]||0x0:0x0;}),_0x10e065['sort']((_0x423e41,_0x41cc22)=>_0x41cc22[_0x163243(0x1365)]-_0x423e41[_0x163243(0x1365)]),_0x8d0923=[];const _0x28c0b8=new Set();_0x10e065[_0x163243(0xd9a)](_0x180bdc=>{const _0x321d45=_0x163243,_0x839e65=_0x5ca95f[_0x321d45(0x3d8)](_0x3f51d6=>!_0x3f51d6['isGroup']&&_0x3f51d6['groupId']===_0x180bdc['id']);_0x839e65[_0x321d45(0x7aa)]>0x0&&(_0x8d0923['push']({'type':_0x321d45(0x10e2),'group':_0x180bdc}),_0x839e65[_0x321d45(0xd9a)](_0x93c2ea=>{const _0x24b249=_0x321d45;_0x8d0923['push']({'type':_0x24b249(0x1300),'chat':_0x93c2ea}),_0x28c0b8[_0x24b249(0x569)](_0x93c2ea['id']);}));}),_0x5ca95f[_0x163243(0xd9a)](_0x254782=>{const _0x49b38d=_0x163243;!_0x28c0b8[_0x49b38d(0xa14)](_0x254782['id'])&&_0x8d0923[_0x49b38d(0x138c)]({'type':_0x49b38d(0x1300),'chat':_0x254782});}),_0x29d60c=0x0,_0x3dd421();}function _0x3cfe69(_0x3fcd68){const _0x21da81=_0x41eae2,_0x4a0033=document[_0x21da81(0x285)](_0x21da81(0xb25));return _0x4a0033[_0x21da81(0x81c)]=_0x21da81(0x35c),_0x4a0033['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x3fcd68[_0x21da81(0xf74)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4a0033;}function _0x4cd81c(_0x3199d3,_0xe26441){const _0x89a7f5=_0x41eae2,_0x48e15f=document[_0x89a7f5(0x285)](_0x89a7f5(0x5af));_0x48e15f['id']='load-more-chats-btn',_0x48e15f[_0x89a7f5(0xf12)]=_0x89a7f5(0x65b),_0x48e15f[_0x89a7f5(0x81c)]=_0x89a7f5(0x1108),_0x48e15f[_0x89a7f5(0x1193)](_0x89a7f5(0x12a5),()=>_0x3dd421(_0xe26441),{'once':!![]}),_0x3199d3['prepend'](_0x48e15f);}function _0x3dd421(){const _0x2adaf1=_0x41eae2;if(_0x58ae48)return;const _0xf330b3=document[_0x2adaf1(0x89d)](_0x2adaf1(0x2ca)),_0x8b2a42=document['getElementById'](_0x2adaf1(0x11ac));if(!_0xf330b3||!_0x8b2a42)return;if(_0x29d60c>=_0x8d0923[_0x2adaf1(0x7aa)])return;_0x58ae48=!![];const _0x6e51cf=_0x29d60c===0x0,_0x256d88=()=>{const _0x440366=_0x2adaf1;_0x216cac(_0xf330b3);const _0x2b530b=_0x5b873d[_0x440366(0x21a)]['chatListRenderWindow']||0x1e,_0x57bfff=_0x29d60c,_0xdeb868=_0x29d60c+_0x2b530b,_0x53fc57=_0x8d0923[_0x440366(0xdd0)](_0x57bfff,_0xdeb868),_0x24e86a=document[_0x440366(0xfc9)]();let _0x3640ba=_0xf330b3[_0x440366(0xd16)](_0x440366(0xc61));_0x53fc57[_0x440366(0xd9a)](_0x1b3a44=>{const _0x5b3954=_0x440366;if(_0x1b3a44['type']===_0x5b3954(0x10e2)){const _0x38f79a=_0x3cfe69(_0x1b3a44[_0x5b3954(0x39f)]);_0x24e86a[_0x5b3954(0x22f)](_0x38f79a),_0x3640ba=_0x38f79a['querySelector'](_0x5b3954(0x1161));}else{if(_0x1b3a44['type']===_0x5b3954(0x1300)){const _0x45e19c=_0x1efd8b(_0x1b3a44[_0x5b3954(0xde9)]);if(_0x1b3a44['chat']['groupId']&&_0x3640ba)_0x3640ba[_0x5b3954(0x22f)](_0x45e19c);else{_0x24e86a[_0x5b3954(0x22f)](_0x45e19c);if(!_0x1b3a44[_0x5b3954(0xde9)][_0x5b3954(0xb54)])_0x3640ba=null;}}}}),_0xf330b3[_0x440366(0x22f)](_0x24e86a),_0x29d60c+=_0x53fc57[_0x440366(0x7aa)],_0xf330b3[_0x440366(0x35f)](_0x440366(0xad0))[_0x440366(0xd9a)](_0x3c2ba9=>{const _0x58106d=_0x440366;_0x3c2ba9[_0x58106d(0xaaf)]['hasListener']=_0x58106d(0xc8b),_0x3c2ba9[_0x58106d(0x1193)]('click',()=>{const _0x88ed7c=_0x58106d;_0x3c2ba9[_0x88ed7c(0x2f1)]['toggle'](_0x88ed7c(0x313)),_0x3c2ba9[_0x88ed7c(0x486)][_0x88ed7c(0x2f1)][_0x88ed7c(0x73b)](_0x88ed7c(0x313));});}),_0x58ae48=![],_0x8b2a42[_0x440366(0x624)]<=_0x8b2a42[_0x440366(0x95a)]&&_0x29d60c<_0x8d0923['length']&&_0x3dd421();};_0x6e51cf?_0x256d88():(_0x9ce0b2(_0xf330b3,_0x2adaf1(0xc74)),setTimeout(_0x256d88,0x1f4));}function _0x1efd8b(_0x517da1){const _0xf7402a=_0x41eae2;try{const _0x277918=_0x517da1[_0xf7402a(0x551)]['filter'](_0x2e3b68=>!_0x2e3b68[_0xf7402a(0x9ae)])[_0xf7402a(0xdd0)](-0x1)[0x0]||{};let _0x56686f;if(!_0x517da1[_0xf7402a(0x58c)]&&_0x517da1[_0xf7402a(0x1383)]?.[_0xf7402a(0x632)]===_0xf7402a(0xb7f))_0x56686f='<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20'+(_0x517da1[_0xf7402a(0x1383)][_0xf7402a(0x1240)]||'请求添加你为好友')+_0xf7402a(0x5ec);else{if(!_0x517da1[_0xf7402a(0x58c)]&&_0x517da1[_0xf7402a(0x1383)]?.[_0xf7402a(0x632)]==='blocked_by_ai')_0x56686f=_0xf7402a(0x9f1);else{if(_0x517da1[_0xf7402a(0x58c)]){if(_0x277918[_0xf7402a(0x48c)]===_0xf7402a(0xc7a))_0x56686f=_0xf7402a(0xaab)+_0x277918['content'];else{if(_0x277918['type']===_0xf7402a(0x1075))_0x56686f=_0xf7402a(0xc46);else{if(_0x277918['type']===_0xf7402a(0x656)||_0x277918[_0xf7402a(0x48c)]==='user_photo')_0x56686f='[照片]';else{if(_0x277918[_0xf7402a(0x48c)]===_0xf7402a(0xff9))_0x56686f=_0xf7402a(0xc5d);else{if(typeof _0x277918[_0xf7402a(0x28c)]===_0xf7402a(0x1224)&&_0x3b71b1['test'](_0x277918['content']))_0x56686f=_0x277918[_0xf7402a(0xb5c)]?_0xf7402a(0x507)+_0x277918[_0xf7402a(0xb5c)]+']':_0xf7402a(0x1107);else Array[_0xf7402a(0xbd6)](_0x277918[_0xf7402a(0x28c)])?_0x56686f='[图片]':_0x56686f=String(_0x277918[_0xf7402a(0x28c)]||'...')[_0xf7402a(0x489)](0x0,0x14);}}}}if(_0x277918[_0xf7402a(0xcfc)]&&_0x277918[_0xf7402a(0x48c)]!==_0xf7402a(0xc7a)){const _0x289828=_0xb9963e(_0x517da1,_0x277918[_0xf7402a(0xcfc)]);_0x56686f=_0x289828+':\x20'+_0x56686f;}}else{const _0x2ea5c0=_0x517da1['status']?.['text']||'在线';_0x56686f='['+_0x2ea5c0+']';}}}const _0x18e2a8=document[_0xf7402a(0x285)](_0xf7402a(0xb25));_0x18e2a8[_0xf7402a(0x81c)]='chat-list-item',_0x18e2a8[_0xf7402a(0xaaf)][_0xf7402a(0x94d)]=_0x517da1['id'];_0x517da1[_0xf7402a(0x199)]&&_0x18e2a8['classList'][_0xf7402a(0x569)]('pinned');const _0x50ff07=_0x517da1[_0xf7402a(0x58c)]?_0x517da1[_0xf7402a(0xdb9)]['groupAvatar']:_0x517da1['settings'][_0xf7402a(0xdd3)],_0x2eed1e=_0x517da1[_0xf7402a(0x58c)]?'':_0x517da1[_0xf7402a(0xdb9)][_0xf7402a(0xeae)]||'';let _0x5b32b0;_0x2eed1e?_0x5b32b0=_0xf7402a(0xea2)+(_0x50ff07||_0x265fcc)+'\x22\x20class=\x22avatar-img\x22><img\x20src=\x22'+_0x2eed1e+_0xf7402a(0x2d7):_0x5b32b0=_0xf7402a(0x477)+(_0x50ff07||_0x265fcc)+_0xf7402a(0x917);const _0x43626d=_0x2eed1e?_0xf7402a(0x443):'',_0x3c948f=_0xf7402a(0xb1b)+_0x43626d+'\x22>'+_0x5b32b0+'</div>';_0x18e2a8[_0xf7402a(0x1ef)]=_0xf7402a(0x631)+_0x3c948f+_0xf7402a(0x50f)+_0x517da1['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x517da1['isGroup']?'<span\x20class=\x22group-tag\x22>群聊</span>':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20'+(_0x517da1['isGroup']?_0xf7402a(0x117f):'#b5b5b5')+_0xf7402a(0xf7b)+_0x56686f+_0xf7402a(0x628);const _0x213955=_0x517da1[_0xf7402a(0x3ce)]||0x0,_0x16b703=_0x18e2a8['querySelector'](_0xf7402a(0xa4c));_0x213955>0x0?(_0x16b703[_0xf7402a(0xf12)]=_0x213955>0x63?_0xf7402a(0xbe2):_0x213955,_0x16b703['style'][_0xf7402a(0x126b)]='inline-flex'):_0x16b703['style']['display']=_0xf7402a(0x10f2);const _0x2fc769=_0x18e2a8[_0xf7402a(0xd16)]('.avatar-group');_0x2fc769&&(_0x2fc769[_0xf7402a(0x68e)][_0xf7402a(0x1049)]=_0xf7402a(0x185),_0x2fc769[_0xf7402a(0x1193)]('dblclick',_0x4b2540=>{const _0x17ee70=_0xf7402a;_0x4b2540[_0x17ee70(0x1088)]();const _0x507d38=_0x517da1[_0x17ee70(0x58c)]?_0x517da1[_0x17ee70(0xf74)]:_0x517da1[_0x17ee70(0x1045)];_0x167bd1(_0x517da1['id'],_0x507d38);}));const _0x166bbd=_0x18e2a8[_0xf7402a(0xd16)](_0xf7402a(0x198));return _0x166bbd&&_0x166bbd['addEventListener'](_0xf7402a(0x12a5),()=>_0x597f5a(_0x517da1['id'])),_0xefe9e2(_0x18e2a8,async _0xb92f73=>{const _0x5cbc5b=_0xf7402a,_0x282469=await _0x4f29ea(_0x517da1);switch(_0x282469){case'pin':_0x517da1[_0x5cbc5b(0x199)]=!_0x517da1[_0x5cbc5b(0x199)],await _0x1a6951['chats'][_0x5cbc5b(0xc0f)](_0x517da1),_0x413d78();break;case _0x5cbc5b(0x684):const _0x312006=await _0x4e2abc('删除对话',_0x5cbc5b(0x1ea)+_0x517da1['name']+_0x5cbc5b(0x44f),{'confirmButtonClass':'btn-danger'});if(_0x312006){_0x1f2ed8[_0x5cbc5b(0xfcb)]&&_0x1f2ed8[_0x5cbc5b(0xf96)]===_0x517da1['id']&&await _0x3a104a(![]);delete _0x5b873d[_0x5cbc5b(0x667)][_0x517da1['id']];if(_0x5b873d[_0x5cbc5b(0xf96)]===_0x517da1['id'])_0x5b873d['activeChatId']=null;await _0x1a6951[_0x5cbc5b(0x667)][_0x5cbc5b(0x684)](_0x517da1['id']),_0x413d78();}break;default:break;}}),_0x18e2a8;}catch(_0x1ec6f5){return console['error'](_0xf7402a(0x439)+(_0x517da1[_0xf7402a(0xf74)]||'未知')+_0xf7402a(0xe27)+_0x517da1['id']+_0xf7402a(0xa6c),_0x1ec6f5),null;}}async function _0x5b89df(_0x32a8b9){const _0x3e3648=_0x41eae2;_0x3fb5e8(),_0x35a054();const _0x51ff90=_0x5b873d['chats'][_0x32a8b9];if(!_0x51ff90)return;_0x4ec1fb();const _0x3f0c61=document[_0x3e3648(0x89d)](_0x3e3648(0x116e)),_0x2f2b2a=document[_0x3e3648(0x89d)]('chat-input-area'),_0x2cb9ac=document['getElementById'](_0x3e3648(0x337)),_0x460989=document[_0x3e3648(0x89d)]('chat-lock-content');_0x3f0c61[_0x3e3648(0xaaf)][_0x3e3648(0x85e)]=_0x51ff90[_0x3e3648(0xdb9)][_0x3e3648(0x85e)]||'default';const _0x1251bb=_0x51ff90[_0x3e3648(0xdb9)]['fontSize']||0xd;_0x3f0c61['style']['setProperty'](_0x3e3648(0x1d7),_0x1251bb+'px'),_0x5806c0(_0x51ff90[_0x3e3648(0xdb9)][_0x3e3648(0x12e7)]||'',_0x3e3648(0xcfb),'custom-bubble-style'),document[_0x3e3648(0x89d)](_0x3e3648(0x578))[_0x3e3648(0xf12)]=_0x51ff90['name'];const _0x1194c0=document[_0x3e3648(0x89d)](_0x3e3648(0xfea)),_0x5b1d1d=_0x1194c0[_0x3e3648(0xd16)]('.status-text');_0x51ff90['isGroup']?(_0x1194c0[_0x3e3648(0x68e)][_0x3e3648(0x126b)]='none',document[_0x3e3648(0x89d)](_0x3e3648(0x596))[_0x3e3648(0x68e)]['justifyContent']=_0x3e3648(0x802)):(_0x1194c0['style'][_0x3e3648(0x126b)]=_0x3e3648(0x66e),document['getElementById'](_0x3e3648(0x596))[_0x3e3648(0x68e)]['justifyContent']='flex-start',_0x5b1d1d[_0x3e3648(0xf12)]=_0x51ff90['status']?.['text']||'在线',_0x1194c0[_0x3e3648(0x2f1)][_0x3e3648(0x73b)](_0x3e3648(0xcfe),_0x51ff90['status']?.[_0x3e3648(0x311)]||![]));const _0x390071=document[_0x3e3648(0x89d)](_0x3e3648(0x87f)),_0x115a12=_0x51ff90['settings'][_0x3e3648(0x55c)],_0x3f32b2=_0x5b873d['globalSettings'][_0x3e3648(0xcdb)],_0x329951=document[_0x3e3648(0x89d)](_0x3e3648(0x34e))[_0x3e3648(0x2f1)]['contains']('dark-mode'),_0x4e92eb=_0x329951?_0x3e3648(0x5c8):_0x3e3648(0x1022);if(_0x115a12)_0x390071['style']['backgroundImage']=_0x3e3648(0xa0c)+_0x115a12+')',_0x390071[_0x3e3648(0x68e)][_0x3e3648(0x96c)]='transparent';else _0x3f32b2?(_0x390071['style'][_0x3e3648(0x1d4)]=_0x3e3648(0xa0c)+_0x3f32b2+')',_0x390071[_0x3e3648(0x68e)][_0x3e3648(0x96c)]=_0x3e3648(0x6b4)):(_0x390071[_0x3e3648(0x68e)][_0x3e3648(0x1d4)]=_0x3e3648(0x10f2),_0x390071[_0x3e3648(0x68e)][_0x3e3648(0x96c)]=_0x4e92eb);if(_0x51ff90[_0x3e3648(0x50e)])_0x2f2b2a[_0x3e3648(0x68e)][_0x3e3648(0x126b)]=_0x3e3648(0x10f2),_0x2cb9ac[_0x3e3648(0x68e)][_0x3e3648(0x126b)]=_0x3e3648(0x66e),_0x460989['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x3e3648(0x89d)](_0x3e3648(0xbf4))['onclick']=_0x5f21e2;else{_0x2f2b2a[_0x3e3648(0x68e)]['display']=_0x3e3648(0x66e),_0x2cb9ac['style']['display']=_0x3e3648(0x10f2),_0x460989[_0x3e3648(0x1ef)]='';if(!_0x51ff90['isGroup']&&_0x51ff90['relationship'][_0x3e3648(0x632)]!==_0x3e3648(0x123a)){_0x2cb9ac['style'][_0x3e3648(0x126b)]=_0x3e3648(0x66e),_0x2f2b2a[_0x3e3648(0x68e)]['visibility']=_0x3e3648(0xe90);let _0x2b6991='';switch(_0x51ff90[_0x3e3648(0x1383)][_0x3e3648(0x632)]){case'blocked_by_user':const _0x4f599e=_0x10707f!==null,_0x2babbf=_0x51ff90[_0x3e3648(0x1383)][_0x3e3648(0x315)],_0x44f7d4=_0x5b873d[_0x3e3648(0x21a)][_0x3e3648(0x11bf)]||0x1,_0x524741=_0x44f7d4*0x3c*0x3c*0x3e8,_0x4d3adf=Date[_0x3e3648(0xf1a)]()-_0x2babbf,_0x33adac=_0x4d3adf>_0x524741,_0x397106=Math['max'](0x0,Math['ceil']((_0x524741-_0x4d3adf)/(0x3e8*0x3c)));_0x2b6991=_0x3e3648(0x191)+_0x51ff90[_0x3e3648(0xf74)]+'”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20'+(_0x5b873d['globalSettings']['enableBackgroundActivity']?'<span\x20style=\x22color:\x20green;\x22>已开启</span>':_0x3e3648(0x9d2))+_0x3e3648(0x4a6)+(_0x4f599e?_0x3e3648(0xf7d):_0x3e3648(0x7df))+_0x3e3648(0x7a2)+_0x51ff90[_0x3e3648(0x1383)][_0x3e3648(0x632)]+'</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>'+_0x44f7d4+'</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20'+(_0x33adac?_0x3e3648(0xfac):_0x3e3648(0x9da)+_0x397106+'\x20分钟)</span>')+_0x3e3648(0x223)+(_0x33adac&&_0x5b873d['globalSettings'][_0x3e3648(0xa61)]?_0x3e3648(0x1071):_0x3e3648(0x130b))+_0x3e3648(0x11f1);break;case _0x3e3648(0x59f):_0x2b6991=_0x3e3648(0x7d8);break;case _0x3e3648(0xb7f):_0x2b6991=_0x3e3648(0x1037)+_0x51ff90[_0x3e3648(0xf74)]+_0x3e3648(0xcf1)+_0x51ff90[_0x3e3648(0x1383)]['applicationReason']+'”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';break;case _0x3e3648(0x12d2):_0x2b6991='<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>';break;}_0x460989[_0x3e3648(0x1ef)]=_0x2b6991;}else _0x2cb9ac[_0x3e3648(0x68e)][_0x3e3648(0x126b)]='none',_0x2f2b2a['style'][_0x3e3648(0x833)]=_0x3e3648(0x11e4);}_0x3f0c61[_0x3e3648(0x1ef)]='';const _0xaa3ea5=_0x51ff90['history'];_0x3def71=0x0;const _0x3da213=_0x5b873d['globalSettings']['chatRenderWindow']||0x32,_0x473a6a=_0xaa3ea5['slice'](-_0x3da213),_0xd66b9=[];let _0x12c6d8=0x0;for(const _0x2a263b of _0x473a6a){_0x12c6d8>0x0&&_0x2a263b[_0x3e3648(0x114e)]-_0x12c6d8>0x927c0&&_0xd66b9[_0x3e3648(0x138c)](Promise[_0x3e3648(0xe82)](_0x40d372(_0x2a263b[_0x3e3648(0x114e)]))),_0xd66b9[_0x3e3648(0x138c)](_0x1ed144(_0x2a263b,_0x51ff90,!![])),_0x12c6d8=_0x2a263b[_0x3e3648(0x114e)];}const _0x45e818=await Promise[_0x3e3648(0x863)](_0xd66b9),_0x58e783=document[_0x3e3648(0xfc9)]();_0x45e818[_0x3e3648(0x3d8)](Boolean)[_0x3e3648(0xd9a)](_0x5762cd=>_0x58e783[_0x3e3648(0x22f)](_0x5762cd)),_0x3f0c61['appendChild'](_0x58e783),_0x3def71=_0x473a6a[_0x3e3648(0x7aa)];const _0x2eaf38=document[_0x3e3648(0x285)](_0x3e3648(0xb25));_0x2eaf38['id']=_0x3e3648(0x1c5),_0x2eaf38[_0x3e3648(0x68e)][_0x3e3648(0x126b)]=_0x3e3648(0x10f2),_0x2eaf38[_0x3e3648(0xf12)]=_0x3e3648(0x3fe),_0x3f0c61[_0x3e3648(0x22f)](_0x2eaf38),setTimeout(()=>_0x3f0c61['scrollTop']=_0x3f0c61[_0x3e3648(0x624)],0x0);}async function _0x474038(){const _0x20d1f4=_0x41eae2;if(_0x456197)return;_0x456197=!![];const _0x319c91=document[_0x20d1f4(0x89d)]('chat-messages'),_0x18efe4=_0x5b873d['chats'][_0x5b873d[_0x20d1f4(0xf96)]];if(!_0x18efe4){_0x456197=![];return;}_0x9ce0b2(_0x319c91,_0x20d1f4(0x113d));const _0x431efd=_0x319c91[_0x20d1f4(0x624)];await new Promise(_0x1bc068=>setTimeout(_0x1bc068,0x1f4));const _0x270577=_0x18efe4[_0x20d1f4(0x551)][_0x20d1f4(0x7aa)],_0x11d224=_0x5b873d['globalSettings'][_0x20d1f4(0x2f3)]||0x32,_0x3b15b9=_0x270577-_0x3def71-_0x11d224,_0x5d6284=_0x270577-_0x3def71,_0x54589f=_0x18efe4[_0x20d1f4(0x551)][_0x20d1f4(0xdd0)](Math[_0x20d1f4(0x88d)](0x0,_0x3b15b9),_0x5d6284),_0x4154de=_0x319c91[_0x20d1f4(0xd16)]('.message-wrapper[data-timestamp]');let _0x414ce7=_0x4154de?parseInt(_0x4154de[_0x20d1f4(0xaaf)]['timestamp']):0x0;for(const _0x5121f9 of _0x54589f[_0x20d1f4(0x854)]()){if(_0x414ce7>0x0&&_0x414ce7-_0x5121f9['timestamp']>0x927c0){const _0x417c47=_0x40d372(_0x414ce7);_0x319c91['prepend'](_0x417c47);}await _0x27634f(_0x5121f9,_0x18efe4),_0x414ce7=_0x5121f9[_0x20d1f4(0x114e)];}_0x3def71+=_0x54589f['length'];const _0xc6363f=_0x319c91[_0x20d1f4(0x624)];_0x319c91['scrollTop']=_0xc6363f-_0x431efd,_0x216cac(_0x319c91),_0x456197=![];}function _0x245609(){const _0xb4b5a9=_0x41eae2;_0x46f316(),_0x2a0bb4();const _0x1068cf=document[_0xb4b5a9(0x89d)](_0xb4b5a9(0x189)),_0x4743ac=_0x5b873d['globalSettings'][_0xb4b5a9(0xd92)];_0x4743ac?(_0x1068cf[_0xb4b5a9(0x68e)][_0xb4b5a9(0x1d4)]=_0xb4b5a9(0xa0c)+_0x4743ac+')',_0x1068cf[_0xb4b5a9(0xf12)]=''):(_0x1068cf[_0xb4b5a9(0x68e)][_0xb4b5a9(0x1d4)]=_0xb4b5a9(0x64b),_0x1068cf[_0xb4b5a9(0xf12)]='当前为渐变色');const _0x3fe0f1=document[_0xb4b5a9(0x89d)](_0xb4b5a9(0x472)),_0x3ed967=_0x5b873d[_0xb4b5a9(0x21a)][_0xb4b5a9(0x5fa)];_0x3ed967?(_0x3fe0f1[_0xb4b5a9(0x68e)][_0xb4b5a9(0x1d4)]=_0xb4b5a9(0xa0c)+_0x3ed967+')',_0x3fe0f1[_0xb4b5a9(0xf12)]=''):(_0x3fe0f1['style']['backgroundImage']='linear-gradient(135deg,\x20#f6d365,\x20#fda085)',_0x3fe0f1[_0xb4b5a9(0xf12)]=_0xb4b5a9(0x6ea));const _0x2e716c=document[_0xb4b5a9(0x89d)](_0xb4b5a9(0x5a3)),_0x5dda1d=_0x5b873d[_0xb4b5a9(0x21a)][_0xb4b5a9(0xcdb)];_0x5dda1d?(_0x2e716c[_0xb4b5a9(0x68e)][_0xb4b5a9(0x1d4)]=_0xb4b5a9(0xa0c)+_0x5dda1d+')',_0x2e716c[_0xb4b5a9(0xf12)]='',document[_0xb4b5a9(0x89d)]('remove-global-bg-btn')[_0xb4b5a9(0x68e)][_0xb4b5a9(0x126b)]=_0xb4b5a9(0x83c)):(_0x2e716c[_0xb4b5a9(0x68e)]['backgroundImage']=_0xb4b5a9(0x10f2),_0x2e716c[_0xb4b5a9(0xf12)]=_0xb4b5a9(0x49d),document[_0xb4b5a9(0x89d)](_0xb4b5a9(0x78c))[_0xb4b5a9(0x68e)][_0xb4b5a9(0x126b)]='none'),_0x1edc49(),_0x5e86ec(),document[_0xb4b5a9(0x89d)]('global-css-input')['value']=_0x5b873d[_0xb4b5a9(0x21a)][_0xb4b5a9(0x876)]||'',document[_0xb4b5a9(0x89d)](_0xb4b5a9(0x1333))['value']=_0x5b873d[_0xb4b5a9(0x21a)][_0xb4b5a9(0x261)]||'',document[_0xb4b5a9(0x89d)]('status-bar-toggle-switch')[_0xb4b5a9(0x1b0)]=_0x5b873d[_0xb4b5a9(0x21a)][_0xb4b5a9(0x1f0)]||![],_0x279789(),_0x5842ae();}window[_0x41eae2(0x950)]=_0x245609;function _0x550834(){const _0x33711d=_0x41eae2,_0x46cde1=document[_0x33711d(0x89d)](_0x33711d(0xc0c)),_0x8366d9=_0x5b873d['globalSettings'][_0x33711d(0xd92)];_0x8366d9?_0x46cde1['style'][_0x33711d(0x1d4)]='url('+_0x8366d9+')':_0x46cde1['style'][_0x33711d(0x1d4)]='linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)';}function _0x253ca2(_0x22e4a4){const _0x355024=_0x41eae2;document[_0x355024(0x35f)](_0x355024(0x4a1))[_0x355024(0xd9a)](_0x4fb133=>{const _0x28e06e=_0x355024;_0x4fb133['classList'][_0x28e06e(0x73b)](_0x28e06e(0x8ea),_0x4fb133[_0x28e06e(0xaaf)][_0x28e06e(0xcb1)]===_0x22e4a4);}),document[_0x355024(0x35f)](_0x355024(0xc93))[_0x355024(0xd9a)](_0x45d96a=>{const _0x23e8d6=_0x355024;_0x45d96a[_0x23e8d6(0x2f1)][_0x23e8d6(0x73b)]('active',_0x45d96a['dataset']['categoryId']===_0x22e4a4);});}async function _0x317a18(){const _0x514ef5=_0x41eae2,_0x816795=document[_0x514ef5(0x89d)](_0x514ef5(0x2b3)),_0x38446f=document['getElementById'](_0x514ef5(0xddb));_0x816795['innerHTML']='',_0x38446f[_0x514ef5(0x1ef)]='';const [_0x3b6e49,_0x1a2c01]=await Promise['all']([_0x1a6951[_0x514ef5(0x8a1)]['toArray'](),_0x1a6951[_0x514ef5(0xe8f)][_0x514ef5(0x6ed)](_0x514ef5(0xf74))[_0x514ef5(0xc2f)]()]);_0x5b873d[_0x514ef5(0x8a1)]=_0x3b6e49;if(_0x3b6e49[_0x514ef5(0x7aa)]===0x0){_0x38446f[_0x514ef5(0x1ef)]=_0x514ef5(0x49e);return;}const _0x158ec5=document[_0x514ef5(0x285)](_0x514ef5(0x5af));_0x158ec5[_0x514ef5(0x81c)]=_0x514ef5(0xb4a),_0x158ec5[_0x514ef5(0xf12)]='全部',_0x158ec5[_0x514ef5(0xaaf)]['categoryId']=_0x514ef5(0x863),_0x816795[_0x514ef5(0x22f)](_0x158ec5);const _0x29b209=document[_0x514ef5(0x285)](_0x514ef5(0xb25));_0x29b209[_0x514ef5(0x81c)]=_0x514ef5(0x5e7),_0x29b209[_0x514ef5(0xaaf)][_0x514ef5(0xcb1)]='all',_0x38446f[_0x514ef5(0x22f)](_0x29b209),_0x1a2c01[_0x514ef5(0xd9a)](_0x51b946=>{const _0x54845f=_0x514ef5,_0x2e0253=document['createElement'](_0x54845f(0x5af));_0x2e0253[_0x54845f(0x81c)]=_0x54845f(0xa41),_0x2e0253[_0x54845f(0xf12)]=_0x51b946[_0x54845f(0xf74)],_0x2e0253[_0x54845f(0xaaf)][_0x54845f(0xcb1)]=String(_0x51b946['id']),_0x816795['appendChild'](_0x2e0253);const _0x5d962e=document[_0x54845f(0x285)](_0x54845f(0xb25));_0x5d962e[_0x54845f(0x81c)]=_0x54845f(0x38c),_0x5d962e[_0x54845f(0xaaf)]['categoryId']=String(_0x51b946['id']),_0x38446f[_0x54845f(0x22f)](_0x5d962e);});const _0x2dbec3=_0x3b6e49[_0x514ef5(0xc5c)](_0x2ed5a8=>!_0x2ed5a8[_0x514ef5(0xcb1)]);if(_0x2dbec3){const _0x503f4f=document['createElement'](_0x514ef5(0x5af));_0x503f4f[_0x514ef5(0x81c)]=_0x514ef5(0xa41),_0x503f4f['textContent']=_0x514ef5(0x1184),_0x503f4f[_0x514ef5(0xaaf)][_0x514ef5(0xcb1)]=_0x514ef5(0x67a),_0x816795[_0x514ef5(0x22f)](_0x503f4f);const _0x1b1e71=document[_0x514ef5(0x285)](_0x514ef5(0xb25));_0x1b1e71[_0x514ef5(0x81c)]=_0x514ef5(0x38c),_0x1b1e71['dataset'][_0x514ef5(0xcb1)]=_0x514ef5(0x67a),_0x38446f[_0x514ef5(0x22f)](_0x1b1e71);}_0x3b6e49[_0x514ef5(0xd9a)](_0x2c6377=>{const _0x2d71a6=_0x514ef5;let _0x5a8225=_0x2d71a6(0x10f9);if(Array[_0x2d71a6(0xbd6)](_0x2c6377[_0x2d71a6(0x28c)])&&_0x2c6377['content']['length']>0x0){const _0x4cb7c2=_0x2c6377['content'][0x0];_0x5a8225=_0x4cb7c2[_0x2d71a6(0x8f9)]||_0x4cb7c2['content']||'';}else typeof _0x2c6377[_0x2d71a6(0x28c)]===_0x2d71a6(0x1224)&&_0x2c6377[_0x2d71a6(0x28c)][_0x2d71a6(0xc3a)]()!==''&&(_0x5a8225=_0x2c6377[_0x2d71a6(0x28c)]);const _0x386685=document[_0x2d71a6(0x285)](_0x2d71a6(0xb25));_0x386685['className']=_0x2d71a6(0x437),_0x386685[_0x2d71a6(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x2c6377[_0x2d71a6(0xf74)]+_0x2d71a6(0x1316)+_0x5a8225+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x1d58e0=()=>_0xba561c(_0x2c6377['id']),_0x8c783b=async()=>{const _0x385623=_0x2d71a6,_0x57861d=await _0x4e2abc(_0x385623(0xfad),_0x385623(0x1203)+_0x2c6377[_0x385623(0xf74)]+_0x385623(0x80a),{'confirmButtonClass':_0x385623(0xcd8)});_0x57861d&&(await _0x1a6951['worldBooks'][_0x385623(0x684)](_0x2c6377['id']),_0x5b873d[_0x385623(0x8a1)]=_0x5b873d[_0x385623(0x8a1)][_0x385623(0x3d8)](_0x4cebc8=>_0x4cebc8['id']!==_0x2c6377['id']),_0x317a18());};_0x386685[_0x2d71a6(0x1193)]('click',_0x1d58e0),_0xefe9e2(_0x386685,_0x8c783b);const _0x4b319d=_0x386685[_0x2d71a6(0xf2a)](!![]);_0x4b319d[_0x2d71a6(0x1193)](_0x2d71a6(0x12a5),_0x1d58e0),_0xefe9e2(_0x4b319d,_0x8c783b),_0x29b209[_0x2d71a6(0x22f)](_0x4b319d);const _0x189570=_0x2c6377['categoryId']?String(_0x2c6377[_0x2d71a6(0xcb1)]):_0x2d71a6(0x67a),_0x37320f=_0x38446f[_0x2d71a6(0xd16)](_0x2d71a6(0x1f5)+_0x189570+'\x22]');_0x37320f&&_0x37320f[_0x2d71a6(0x22f)](_0x386685);}),document[_0x514ef5(0x35f)](_0x514ef5(0x4a1))[_0x514ef5(0xd9a)](_0x2b9fa9=>{const _0x3f6377=_0x514ef5;_0x2b9fa9[_0x3f6377(0x1193)]('click',()=>_0x253ca2(_0x2b9fa9[_0x3f6377(0xaaf)][_0x3f6377(0xcb1)]));});}function _0x505d35(_0x562b1c,_0x11ce9d){const _0x721bad=_0x41eae2,_0x4127d9=document[_0x721bad(0x285)](_0x721bad(0xb25));_0x4127d9[_0x721bad(0x81c)]=_0x721bad(0x8a2),_0x4127d9['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x562b1c+_0x721bad(0x3e2);const _0x10f0a1=_0x4127d9['querySelector'](_0x721bad(0x104b));return _0x11ce9d[_0x721bad(0x2e3)]((_0x9de3e2,_0x19fe1d)=>_0x9de3e2[_0x721bad(0xf74)]['localeCompare'](_0x19fe1d[_0x721bad(0xf74)],_0x721bad(0x1e8))),_0x11ce9d[_0x721bad(0xd9a)](_0x3fa321=>{const _0x29762a=_0x721bad;let _0x4772e1=_0x29762a(0x10f9);if(Array[_0x29762a(0xbd6)](_0x3fa321[_0x29762a(0x28c)])&&_0x3fa321[_0x29762a(0x28c)][_0x29762a(0x7aa)]>0x0){const _0x2a7dd3=_0x3fa321[_0x29762a(0x28c)][0x0];_0x4772e1=_0x2a7dd3[_0x29762a(0x8f9)]||_0x2a7dd3[_0x29762a(0x28c)]||'';}else typeof _0x3fa321[_0x29762a(0x28c)]===_0x29762a(0x1224)&&_0x3fa321[_0x29762a(0x28c)][_0x29762a(0xc3a)]()!==''&&(_0x4772e1=_0x3fa321[_0x29762a(0x28c)]);const _0x2d5da6=document[_0x29762a(0x285)](_0x29762a(0xb25));_0x2d5da6[_0x29762a(0x81c)]=_0x29762a(0xf3a),_0x2d5da6[_0x29762a(0xaaf)][_0x29762a(0x11cc)]=_0x3fa321['id'],_0x2d5da6[_0x29762a(0x1ef)]=_0x29762a(0xb26)+_0x3fa321['name']+_0x29762a(0xc28)+String(_0x4772e1)['substring'](0x0,0x32)+_0x29762a(0xb75),_0x2d5da6[_0x29762a(0x1193)](_0x29762a(0x12a5),()=>_0xba561c(_0x3fa321['id'])),_0xefe9e2(_0x2d5da6,async()=>{const _0x5c56d8=_0x29762a,_0x5c6f47=await _0x4e2abc(_0x5c56d8(0xfad),'确定要删除《'+_0x3fa321['name']+_0x5c56d8(0xa0d),{'confirmButtonClass':'btn-danger'});_0x5c6f47&&(await _0x1a6951['worldBooks'][_0x5c56d8(0x684)](_0x3fa321['id']),_0x5b873d[_0x5c56d8(0x8a1)]=_0x5b873d['worldBooks'][_0x5c56d8(0x3d8)](_0x1c57c4=>_0x1c57c4['id']!==_0x3fa321['id']),_0x317a18());}),_0x10f0a1['appendChild'](_0x2d5da6);}),_0x4127d9;}window[_0x41eae2(0x370)]=_0x317a18;async function _0xba561c(_0x438eba){const _0x2d3dd3=_0x41eae2;_0x4e6c15(_0x2d3dd3(0x859)),_0x429d52=_0x438eba;const [_0x3fbc29,_0x2cbd25]=await Promise[_0x2d3dd3(0x863)]([_0x1a6951[_0x2d3dd3(0x8a1)]['get'](_0x438eba),_0x1a6951['worldBookCategories'][_0x2d3dd3(0xc2f)]()]);if(!_0x3fbc29){console[_0x2d3dd3(0x1fd)](_0x2d3dd3(0xf4c),_0x438eba),_0x4e6c15(_0x2d3dd3(0x57e));return;}document[_0x2d3dd3(0x89d)](_0x2d3dd3(0x762))[_0x2d3dd3(0xf12)]=_0x3fbc29[_0x2d3dd3(0xf74)],document[_0x2d3dd3(0x89d)](_0x2d3dd3(0xf5b))[_0x2d3dd3(0x2f4)]=_0x3fbc29[_0x2d3dd3(0xf74)];const _0x6c97a=document['getElementById'](_0x2d3dd3(0x9c9));_0x6c97a['innerHTML']='<option\x20value=\x22\x22>--\x20未分类\x20--</option>',_0x2cbd25['forEach'](_0x47a076=>{const _0x20af8e=_0x2d3dd3,_0x49a2ef=document[_0x20af8e(0x285)](_0x20af8e(0xc39));_0x49a2ef[_0x20af8e(0x2f4)]=_0x47a076['id'],_0x49a2ef[_0x20af8e(0xf12)]=_0x47a076[_0x20af8e(0xf74)];if(_0x3fbc29['categoryId']===_0x47a076['id'])_0x49a2ef[_0x20af8e(0x335)]=!![];_0x6c97a['appendChild'](_0x49a2ef);});const _0x389018=document[_0x2d3dd3(0x89d)]('world-book-entries-container');_0x389018[_0x2d3dd3(0x1ef)]='',Array[_0x2d3dd3(0xbd6)](_0x3fbc29[_0x2d3dd3(0x28c)])&&_0x3fbc29[_0x2d3dd3(0x28c)][_0x2d3dd3(0x7aa)]>0x0?_0x3fbc29[_0x2d3dd3(0x28c)]['forEach'](_0x12293d=>{const _0x5381ff=_0x2d3dd3,_0x4e11cf=_0x348395(_0x12293d);_0x389018[_0x5381ff(0x22f)](_0x4e11cf);}):_0x389018[_0x2d3dd3(0x1ef)]=_0x2d3dd3(0x8ec);}async function _0x1e547a(_0x39e76b=!![]){const _0x1fdf1c=_0x41eae2,_0x52d6ee=document[_0x1fdf1c(0x89d)](_0x1fdf1c(0xd0a)),_0x37ecdb=document[_0x1fdf1c(0x89d)](_0x1fdf1c(0xee5)),_0x12e106=document['getElementById'](_0x1fdf1c(0x68f)),_0x3a98d8=_0x12e106[_0x1fdf1c(0x2f4)]['trim']()[_0x1fdf1c(0x124b)]();if(_0x39e76b){_0x37ecdb['innerHTML']='';const _0x3e41f6=await _0x1a6951[_0x1fdf1c(0x31b)][_0x1fdf1c(0xc2f)]();_0x37ecdb['innerHTML']+=_0x1fdf1c(0x132f)+(_0x10313e==='all'?'active':'')+_0x1fdf1c(0x15e),_0x3e41f6[_0x1fdf1c(0xd9a)](_0xd3b2ce=>{const _0x2c5672=_0x1fdf1c;_0x37ecdb[_0x2c5672(0x1ef)]+='<button\x20class=\x22sticker-category-tab\x20'+(_0x10313e===_0xd3b2ce['id']?_0x2c5672(0x8ea):'')+_0x2c5672(0x1111)+_0xd3b2ce['id']+'\x22>'+_0xd3b2ce[_0x2c5672(0xf74)]+_0x2c5672(0x348);}),_0x37ecdb['innerHTML']+=_0x1fdf1c(0x132f)+(_0x10313e===_0x1fdf1c(0x67a)?_0x1fdf1c(0x8ea):'')+_0x1fdf1c(0x1283);}_0x52d6ee['innerHTML']='';let _0x12c0f3;if(_0x10313e===_0x1fdf1c(0x863))_0x12c0f3=_0x5b873d['userStickers'];else _0x10313e===_0x1fdf1c(0x67a)?_0x12c0f3=_0x5b873d[_0x1fdf1c(0x210)][_0x1fdf1c(0x3d8)](_0x7191a7=>!_0x7191a7['categoryId']):_0x12c0f3=_0x5b873d[_0x1fdf1c(0x210)]['filter'](_0x233ab4=>_0x233ab4['categoryId']===_0x10313e);const _0x360463=_0x3a98d8?_0x12c0f3[_0x1fdf1c(0x3d8)](_0xf3412=>_0xf3412[_0x1fdf1c(0xf74)][_0x1fdf1c(0x124b)]()[_0x1fdf1c(0xced)](_0x3a98d8)):_0x12c0f3;if(_0x360463[_0x1fdf1c(0x7aa)]===0x0){const _0x413b21=_0x3a98d8?'找不到匹配的表情':_0x1fdf1c(0x8fc);_0x52d6ee['innerHTML']=_0x1fdf1c(0x1a4)+_0x413b21+_0x1fdf1c(0x164);return;}_0x360463[_0x1fdf1c(0xd9a)](_0xa69977=>{const _0x8b4bfe=_0x1fdf1c,_0x183f80=document[_0x8b4bfe(0x285)]('div');_0x183f80[_0x8b4bfe(0x81c)]=_0x8b4bfe(0x2e8),_0x183f80['title']=_0xa69977[_0x8b4bfe(0xf74)],_0x183f80[_0x8b4bfe(0xaaf)][_0x8b4bfe(0x1e4)]=_0xa69977['id'],_0x183f80[_0x8b4bfe(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url('+_0xa69977['url']+_0x8b4bfe(0xb33)+_0xa69977[_0x8b4bfe(0xf74)]+_0x8b4bfe(0xf9a),_0x183f80[_0x8b4bfe(0x1193)](_0x8b4bfe(0x12a5),()=>{_0x390bd1?_0x5199f7(_0x183f80):_0x2c063a(_0xa69977);});const _0x53a76b=document[_0x8b4bfe(0x285)](_0x8b4bfe(0xb25));_0x53a76b[_0x8b4bfe(0x81c)]=_0x8b4bfe(0x670),_0x53a76b[_0x8b4bfe(0x1ef)]=_0x8b4bfe(0x11d5),_0x53a76b[_0x8b4bfe(0x108b)]=async _0xcf21be=>{const _0x13f83c=_0x8b4bfe;_0xcf21be[_0x13f83c(0x1088)]();const _0x55066b=await _0x4e2abc(_0x13f83c(0x1315),_0x13f83c(0xe05)+_0xa69977['name']+_0x13f83c(0xa6a),{'confirmButtonClass':'btn-danger'});_0x55066b&&(await _0x1a6951['userStickers'][_0x13f83c(0x684)](_0xa69977['id']),_0x5b873d['userStickers']=_0x5b873d[_0x13f83c(0x210)][_0x13f83c(0x3d8)](_0x24c043=>_0x24c043['id']!==_0xa69977['id']),_0x1e547a());},_0x183f80[_0x8b4bfe(0x22f)](_0x53a76b),_0x52d6ee[_0x8b4bfe(0x22f)](_0x183f80);});}let _0x390bd1=![],_0x31db09=new Set();function _0x13a1f4(){const _0x62ca34=_0x41eae2;_0x390bd1=!_0x390bd1;const _0x173dff=document[_0x62ca34(0x89d)](_0x62ca34(0xd0a)),_0x34a9c7=document['getElementById']('manage-stickers-btn'),_0x42f7cd=document[_0x62ca34(0x89d)](_0x62ca34(0x6ce)),_0x5104c0=document[_0x62ca34(0x89d)](_0x62ca34(0x1a8));_0x173dff[_0x62ca34(0x2f1)][_0x62ca34(0x73b)](_0x62ca34(0x992),_0x390bd1),_0x390bd1?(_0x34a9c7[_0x62ca34(0xf12)]='完成',_0x42f7cd['style']['display']=_0x62ca34(0x66e),_0x31db09[_0x62ca34(0x1073)](),_0x5104c0[_0x62ca34(0x1b0)]=![],_0x4bc86b()):(_0x34a9c7['textContent']='管理',_0x42f7cd['style'][_0x62ca34(0x126b)]=_0x62ca34(0x10f2),_0x173dff[_0x62ca34(0x35f)](_0x62ca34(0x21d))[_0x62ca34(0xd9a)](_0x1a5ca3=>_0x1a5ca3[_0x62ca34(0x2f1)][_0x62ca34(0x1247)]('selected')));}function _0x4287a0(){const _0x2df96b=_0x41eae2,_0x4f37b4=document[_0x2df96b(0x89d)]('select-all-stickers-checkbox'),_0x26db96=_0x4f37b4[_0x2df96b(0x1b0)];let _0x10d2fd;if(_0x10313e===_0x2df96b(0x863))_0x10d2fd=_0x5b873d[_0x2df96b(0x210)];else _0x10313e==='uncategorized'?_0x10d2fd=_0x5b873d[_0x2df96b(0x210)][_0x2df96b(0x3d8)](_0x567633=>!_0x567633[_0x2df96b(0xcb1)]):_0x10d2fd=_0x5b873d['userStickers'][_0x2df96b(0x3d8)](_0x40fd81=>_0x40fd81[_0x2df96b(0xcb1)]===_0x10313e);_0x10d2fd['forEach'](_0x52b616=>{const _0xe6e0da=_0x2df96b,_0x41d440=_0x52b616['id'],_0x4a388d=document['querySelector'](_0xe6e0da(0x10f4)+_0x41d440+'\x22]');if(_0x26db96){_0x31db09[_0xe6e0da(0x569)](_0x41d440);if(_0x4a388d)_0x4a388d['classList'][_0xe6e0da(0x569)](_0xe6e0da(0x335));}else{_0x31db09[_0xe6e0da(0x684)](_0x41d440);if(_0x4a388d)_0x4a388d[_0xe6e0da(0x2f1)][_0xe6e0da(0x1247)](_0xe6e0da(0x335));}}),_0x4bc86b();}function _0x4bc86b(){const _0x246c25=_0x41eae2,_0x4e5eb9=document[_0x246c25(0x89d)](_0x246c25(0xe08));_0x4e5eb9[_0x246c25(0xf12)]=_0x246c25(0x618)+_0x31db09[_0x246c25(0x746)]+')';}function _0x5199f7(_0x21fb19){const _0x33c355=_0x41eae2;if(!_0x390bd1)return;const _0x2f704d=_0x21fb19[_0x33c355(0xaaf)][_0x33c355(0x1e4)];if(!_0x2f704d)return;_0x21fb19[_0x33c355(0x2f1)][_0x33c355(0x73b)](_0x33c355(0x335)),_0x31db09[_0x33c355(0xa14)](_0x2f704d)?_0x31db09['delete'](_0x2f704d):_0x31db09[_0x33c355(0x569)](_0x2f704d),_0x4bc86b();}async function _0x1268cc(){const _0x402a16=_0x41eae2;if(_0x31db09[_0x402a16(0x746)]===0x0)return;const _0x2468ec=await _0x4e2abc(_0x402a16(0x3da),_0x402a16(0x447)+_0x31db09[_0x402a16(0x746)]+'\x20个表情吗？此操作不可恢复。',{'confirmButtonClass':_0x402a16(0xcd8)});if(_0x2468ec){const _0x1c340a=[..._0x31db09];await _0x1a6951[_0x402a16(0x210)][_0x402a16(0x6a7)](_0x1c340a),_0x5b873d[_0x402a16(0x210)]=_0x5b873d[_0x402a16(0x210)]['filter'](_0x2708b0=>!_0x1c340a[_0x402a16(0xced)](_0x2708b0['id'])),_0x13a1f4(),_0x1e547a(),await _0x532f76(_0x402a16(0xcf9),_0x402a16(0x9b3));}}async function _0x49df57(){const _0x1ae25f=_0x41eae2,_0x4335a7=_0x1ae25f(0xe2b),_0x8b4669=await _0x34d246(_0x1ae25f(0x5d4),_0x4335a7,'','textarea');_0x8b4669&&_0x8b4669[_0x1ae25f(0xc3a)]()&&await _0x3a0e60(_0x8b4669);}async function _0x3a0e60(_0xe03304){const _0x25d91b=_0x41eae2,_0x402826=_0xe03304[_0x25d91b(0xc3a)]()[_0x25d91b(0x55b)]('\x0a'),_0x5083df=[],_0x47af48=_0x25d91b(0x625);let _0x177585=0x0;const _0x5996ee=_0x10313e!==_0x25d91b(0x863)&&_0x10313e!=='uncategorized'?_0x10313e:null;for(const _0x38a8a6 of _0x402826){const _0x4817fe=_0x38a8a6[_0x25d91b(0xc3a)]();if(!_0x4817fe||_0x4817fe[_0x25d91b(0xced)]('填入'))continue;const _0x2ff912=_0x4817fe[_0x25d91b(0x86c)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x2ff912){const _0x4dec20=_0x2ff912[0x1][_0x25d91b(0xc3a)](),_0x4e2b82=_0x2ff912[0x2][_0x25d91b(0xc3a)]();_0x5083df[_0x25d91b(0x138c)]({'id':_0x25d91b(0x305)+Date[_0x25d91b(0xf1a)]()+Math[_0x25d91b(0xdc6)](),'name':_0x4dec20,'url':_0x4e2b82,'categoryId':_0x5996ee});continue;}let _0x52c065=null,_0x479a95=null;const _0x1ac2a4=_0x4817fe['match'](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x1ac2a4)_0x52c065=_0x1ac2a4[0x1],_0x479a95=_0x1ac2a4[0x2];else{const _0x44e0b0=_0x4817fe[_0x25d91b(0x55b)](/\s+/);_0x44e0b0[_0x25d91b(0x7aa)]>=0x2&&(_0x479a95=_0x44e0b0[_0x25d91b(0x114b)](),_0x52c065=_0x44e0b0[_0x25d91b(0x1237)]('\x20'));}_0x52c065&&_0x479a95&&_0x479a95[_0x25d91b(0xced)]('.')?_0x5083df[_0x25d91b(0x138c)]({'id':_0x25d91b(0x305)+Date[_0x25d91b(0xf1a)]()+Math['random'](),'name':_0x52c065,'url':_0x47af48+_0x479a95,'categoryId':_0x5996ee}):(_0x177585++,console[_0x25d91b(0xac3)](_0x25d91b(0xf34),_0x4817fe));}_0x177585>0x0&&await _0x532f76(_0x25d91b(0x687),'有\x20'+_0x177585+_0x25d91b(0x75c));if(_0x5083df[_0x25d91b(0x7aa)]>0x0)await _0x1a6951[_0x25d91b(0x210)][_0x25d91b(0xe94)](_0x5083df),_0x5b873d[_0x25d91b(0x210)][_0x25d91b(0x138c)](..._0x5083df),_0x1e547a(),await _0x532f76(_0x25d91b(0x1145),_0x25d91b(0x4e7)+_0x5083df[_0x25d91b(0x7aa)]+_0x25d91b(0xdc2));else _0x177585===0x0&&alert(_0x25d91b(0x136b));}function _0x52933b(_0x1b191d){const _0x1c3f3b=_0x41eae2,_0x28f6af=_0x1c3f3b(0x806)+_0x1b191d+'\x22]',_0x1aaf46=document['querySelector'](_0x28f6af);_0x1aaf46?(_0x1aaf46[_0x1c3f3b(0x119f)]({'behavior':_0x1c3f3b(0xa9e),'block':_0x1c3f3b(0x802)}),_0x1aaf46[_0x1c3f3b(0x2f1)][_0x1c3f3b(0x569)](_0x1c3f3b(0x1b2)),setTimeout(()=>{const _0x1989dc=_0x1c3f3b;document[_0x1989dc(0x259)]['contains'](_0x1aaf46)&&_0x1aaf46[_0x1989dc(0x2f1)]['remove'](_0x1989dc(0x1b2));},0x5dc)):alert('找不到原始消息。可能已被删除或位于更早的历史记录中。');}async function _0x1ed144(_0x2b2d7f,_0x297280){const _0xebac63=_0x41eae2;if(_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0xdc0)){const _0x33f202=document[_0xebac63(0x285)](_0xebac63(0xb25));_0x33f202[_0xebac63(0x81c)]=_0xebac63(0x1d6),_0x33f202[_0xebac63(0xaaf)][_0xebac63(0x114e)]=_0x2b2d7f[_0xebac63(0x114e)];const _0x29a869=document[_0xebac63(0x285)](_0xebac63(0xb25));return _0x29a869['className']=_0xebac63(0xe7c),_0x29a869[_0xebac63(0xaaf)][_0xebac63(0x114e)]=_0x2b2d7f[_0xebac63(0x114e)],_0x29a869[_0xebac63(0xf12)]=_0x2b2d7f[_0xebac63(0x28c)],_0x33f202['appendChild'](_0x29a869),_0xefe9e2(_0x33f202,()=>_0x57d678(_0x2b2d7f['timestamp'])),_0x33f202['addEventListener'](_0xebac63(0x12a5),()=>{_0x17f18d&&_0x465a2d(_0x2b2d7f['timestamp']);}),_0x33f202;}else{if(_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0xcb8)){const _0xce55df=document[_0xebac63(0x285)](_0xebac63(0xb25));_0xce55df[_0xebac63(0x81c)]=_0xebac63(0x1d6),_0xce55df[_0xebac63(0xaaf)][_0xebac63(0x114e)]=_0x2b2d7f[_0xebac63(0x114e)];const _0x4db5e1=document[_0xebac63(0x285)](_0xebac63(0xb25));return _0x4db5e1[_0xebac63(0x81c)]=_0xebac63(0x1ad),_0x4db5e1[_0xebac63(0xaaf)][_0xebac63(0x7b6)]=_0x2b2d7f[_0xebac63(0x7b6)],_0x4db5e1[_0xebac63(0xf12)]=_0x2b2d7f[_0xebac63(0x28c)],_0xce55df[_0xebac63(0x22f)](_0x4db5e1),_0xefe9e2(_0xce55df,()=>_0x57d678(_0x2b2d7f[_0xebac63(0x114e)])),_0xce55df[_0xebac63(0x1193)](_0xebac63(0x12a5),()=>{const _0x21f4f4=_0xebac63;_0x17f18d&&_0x465a2d(_0x2b2d7f[_0x21f4f4(0x114e)]);}),_0xce55df;}}if(_0x2b2d7f[_0xebac63(0x9ae)])return null;if(_0x2b2d7f[_0xebac63(0x48c)]==='pat_message'){const _0x14daf2=document[_0xebac63(0x285)](_0xebac63(0xb25));_0x14daf2[_0xebac63(0x81c)]=_0xebac63(0x1d6);const _0x485fb4=document[_0xebac63(0x285)](_0xebac63(0xb25));return _0x485fb4[_0xebac63(0x81c)]='message-bubble\x20system-bubble',_0x485fb4[_0xebac63(0xaaf)][_0xebac63(0x114e)]=_0x2b2d7f[_0xebac63(0x114e)],_0x485fb4[_0xebac63(0xf12)]=_0x2b2d7f[_0xebac63(0x28c)],_0x14daf2[_0xebac63(0x22f)](_0x485fb4),_0xefe9e2(_0x14daf2,()=>_0x57d678(_0x2b2d7f[_0xebac63(0x114e)])),_0x14daf2[_0xebac63(0x1193)](_0xebac63(0x12a5),()=>{const _0x8945d=_0xebac63;if(_0x17f18d)_0x465a2d(_0x2b2d7f[_0x8945d(0x114e)]);}),_0x14daf2;}const _0x4e4d94=_0x2b2d7f['role']==='user',_0x4f50c3=_0x297280[_0xebac63(0xdb9)][_0xebac63(0xc48)]||'我',_0x1b2a25=document[_0xebac63(0x285)](_0xebac63(0xb25));_0x1b2a25[_0xebac63(0x81c)]=_0xebac63(0x743)+(_0x4e4d94?_0xebac63(0x116c):'ai');if(_0x297280[_0xebac63(0x58c)]&&!_0x4e4d94){const _0x1b4887=_0x297280['members']['find'](_0x1b157b=>_0x1b157b['originalName']===_0x2b2d7f['senderName']),_0x39e2ee=document['createElement']('div');_0x39e2ee['className']=_0xebac63(0x109b),_0x39e2ee[_0xebac63(0xf12)]=_0x1b4887?_0x1b4887[_0xebac63(0x7da)]:_0x2b2d7f[_0xebac63(0xcfc)]||_0xebac63(0x10f7),_0x1b2a25['appendChild'](_0x39e2ee);}const _0x1e2576=document['createElement'](_0xebac63(0xb25));_0x1e2576['className']=_0xebac63(0x538)+(_0x4e4d94?_0xebac63(0x116c):'ai'),_0x1e2576[_0xebac63(0xaaf)][_0xebac63(0x114e)]=_0x2b2d7f[_0xebac63(0x114e)];const _0x35ed78=document[_0xebac63(0x285)]('span');_0x35ed78[_0xebac63(0x81c)]='timestamp',_0x35ed78[_0xebac63(0xf12)]=_0x3123da(_0x2b2d7f[_0xebac63(0x114e)]);let _0x10c387,_0x463474='';if(_0x4e4d94)_0x10c387=_0x297280[_0xebac63(0xdb9)][_0xebac63(0xd55)]||(_0x297280[_0xebac63(0x58c)]?_0x24462f:_0x265fcc),_0x463474=_0x297280[_0xebac63(0xdb9)][_0xebac63(0x1e0)]||'';else{if(_0x297280[_0xebac63(0x58c)]){const _0x188bcd=_0x297280[_0xebac63(0x5ab)][_0xebac63(0x12f4)](_0x357bf9=>_0x357bf9[_0xebac63(0x1045)]===_0x2b2d7f[_0xebac63(0xcfc)]);if(_0x188bcd){const _0x44a10d=_0x5b873d[_0xebac63(0x667)][_0x188bcd['id']];_0x10c387=_0x188bcd[_0xebac63(0x12c8)]||(_0x44a10d?_0x44a10d['settings'][_0xebac63(0xdd3)]:_0x15061e),_0x463474=_0x188bcd[_0xebac63(0x81d)]||(_0x44a10d?_0x44a10d[_0xebac63(0xdb9)][_0xebac63(0xeae)]:'');}else _0x10c387=_0x15061e,_0x463474='';}else _0x10c387=_0x297280['settings']['aiAvatar']||_0x265fcc,_0x463474=_0x297280[_0xebac63(0xdb9)][_0xebac63(0xeae)]||'';}let _0x38a7cf;_0x463474?_0x38a7cf=_0xebac63(0xea2)+_0x10c387+_0xebac63(0xf0c)+_0x463474+_0xebac63(0x2d7):_0x38a7cf='<img\x20src=\x22'+_0x10c387+_0xebac63(0x917);const _0x527268=_0x463474?_0xebac63(0x443):'',_0x56b42c=_0xebac63(0xb1b)+_0x527268+'\x22>'+_0x38a7cf+_0xebac63(0xc57);let _0x2301e9,_0x1b0779='';if(_0x2b2d7f[_0xebac63(0x1ff)]){const _0x26f4e8=_0xb9963e(_0x297280,_0x2b2d7f[_0xebac63(0x1ff)][_0xebac63(0xcfc)]),_0x33a05e=String(_0x2b2d7f[_0xebac63(0x1ff)][_0xebac63(0x28c)]||'');_0x1b0779=_0xebac63(0x2df)+_0x2b2d7f[_0xebac63(0x1ff)]['timestamp']+'\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20'+_0x26f4e8+_0xebac63(0x12ac)+_0x33a05e+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}let _0x49a44b=_0x2b2d7f[_0xebac63(0x28c)];if(typeof _0x49a44b===_0xebac63(0x1224)&&_0x49a44b[_0xebac63(0xc3a)]()['startsWith']('<')&&_0x49a44b['trim']()[_0xebac63(0x77a)]('>'))_0x2301e9=_0x49a44b,_0x1e2576[_0xebac63(0x2f1)][_0xebac63(0x569)](_0xebac63(0x702));else{if(_0x2b2d7f[_0xebac63(0x48c)]==='offline_text'||_0x2b2d7f['type']===_0xebac63(0x1d8)||_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0x1105)||_0x2b2d7f[_0xebac63(0x48c)]==='location_share'||_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0x656)||_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0x11f6)||_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0xff9)||_0x2b2d7f['type']===_0xebac63(0x1075)||_0x2b2d7f[_0xebac63(0x48c)]==='waimai_request'||_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0x451)||_0x2b2d7f['type']==='red_packet'||_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0xa9c)||_0x2b2d7f['type']===_0xebac63(0xf80)||_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0x1289)||_0x2b2d7f[_0xebac63(0x48c)]==='naiimag'){if(_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0x910)){const _0x5be0da=_0x2b2d7f[_0xebac63(0x28c)]||((_0x2b2d7f['dialogue']||'')+'\x20'+(_0x2b2d7f[_0xebac63(0xf6e)]||''))[_0xebac63(0xc3a)](),_0x363334=/(「.*?」|“.*?”)/g,_0x299b9b=_0x5be0da['split'](_0x363334)[_0xebac63(0x3d8)](_0x262948=>_0x262948);_0x2301e9=_0x299b9b[_0xebac63(0x412)](_0x3c1b2c=>{const _0x5a461e=_0xebac63;return _0x3c1b2c['startsWith']('「')||_0x3c1b2c[_0x5a461e(0x1222)]('“')?_0x5a461e(0x3fd)+_0x55b8e7(_0x3c1b2c)+_0x5a461e(0x5ec):_0x5a461e(0xbfa)+_0x55b8e7(_0x3c1b2c[_0x5a461e(0xc3a)]())[_0x5a461e(0xfbf)](/\n/g,'<br>')+_0x5a461e(0x5ec);})[_0xebac63(0x1237)]('');}else{if(_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0x1d8))_0x1e2576['classList'][_0xebac63(0x569)](_0xebac63(0xca2),_0xebac63(0x111d)),_0x2301e9=_0xebac63(0x131a)+_0x2b2d7f[_0xebac63(0x114e)]+'\x22><div\x20class=\x22title\x22>'+(_0x2b2d7f['title']||_0xebac63(0x19d))+_0xebac63(0x708)+(_0x2b2d7f['description']||'点击查看详情...')+'</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>'+(_0x2b2d7f[_0xebac63(0x573)]||_0xebac63(0xd43))+'</span></div></div>';else{if(_0x2b2d7f['type']===_0xebac63(0x1105))_0x1e2576[_0xebac63(0x2f1)][_0xebac63(0x569)](_0xebac63(0xca2),_0xebac63(0x111d)),_0x2301e9=_0xebac63(0xfa8)+_0x2b2d7f[_0xebac63(0x114e)]+_0xebac63(0x560)+_0x2b2d7f['payload'][_0xebac63(0x104c)]+'</div><div\x20class=\x22description\x22>共\x20'+_0x2b2d7f['payload']['sharedHistory'][_0xebac63(0x7aa)]+'\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>';else{if(_0x2b2d7f['type']===_0xebac63(0x873)){_0x1e2576[_0xebac63(0x2f1)][_0xebac63(0x569)](_0xebac63(0xe96),_0xebac63(0x111d));let _0xaa8017;if(_0x2b2d7f[_0xebac63(0x450)])_0xaa8017=_0x2b2d7f[_0xebac63(0x450)];else _0x5b873d[_0xebac63(0x21a)]['enableAiDrawing']&&_0x2b2d7f[_0xebac63(0x895)]?_0xaa8017='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x2b2d7f['image_prompt']):_0xaa8017='https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg';const _0x4050cd=_0xebac63(0x10b3)+_0xaa8017+_0xebac63(0xf51);_0x2301e9=_0xebac63(0x345)+_0x2b2d7f[_0xebac63(0x28c)]+_0xebac63(0x6d7)+_0x4050cd+'><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>';}else{if(_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0x11f6)||_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0x656)){_0x1e2576[_0xebac63(0x2f1)][_0xebac63(0x569)](_0xebac63(0x1210),_0xebac63(0x111d));const _0x2d9e0d=_0x2b2d7f['type']===_0xebac63(0x11f6)?_0xebac63(0x83a):_0xebac63(0x8d8),_0x28061b=_0x5b873d['globalSettings'][_0xebac63(0x122b)]&&_0x2b2d7f[_0xebac63(0x895)]?_0xebac63(0x1017)+_0x2b2d7f[_0xebac63(0x895)]:_0xebac63(0xd91);_0x2301e9=_0xebac63(0x477)+_0x28061b+_0xebac63(0x634)+_0x2d9e0d+_0xebac63(0x91d)+_0x2b2d7f[_0xebac63(0x28c)]+'\x22>';}else{if(_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0x88f))_0x1e2576[_0xebac63(0x2f1)][_0xebac63(0x569)](_0xebac63(0x138b),_0xebac63(0x111d)),_0x2301e9=_0xebac63(0x477)+_0x2b2d7f[_0xebac63(0x450)]+_0xebac63(0x352)+(_0x2b2d7f[_0xebac63(0x1185)]||_0x2b2d7f['prompt']||_0xebac63(0x519))+'\x22>';else{if(_0x2b2d7f['type']===_0xebac63(0xff9)){_0x1e2576['classList'][_0xebac63(0x569)](_0xebac63(0x1cf),'is-card-like');const _0x3bbd04=Math[_0xebac63(0x88d)](0x1,Math[_0xebac63(0x900)]((_0x2b2d7f[_0xebac63(0x28c)]||'')['length']/0x5)),_0x438e3f='0:'+String(_0x3bbd04)[_0xebac63(0x4d8)](0x2,'0')+'\x27\x27',_0x156b23='<div></div><div></div><div></div><div></div><div></div>';if(_0x4e4d94)_0x2301e9=_0xebac63(0x5ae)+encodeURIComponent(_0x2b2d7f[_0xebac63(0x28c)])+_0xebac63(0x57f)+_0x156b23+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>'+_0x438e3f+_0xebac63(0x668);else{const _0xe0199b=!_0x297280['isGroup']&&_0x297280[_0xebac63(0xdb9)][_0xebac63(0xe7e)]!==![],_0x95d2a5=_0x297280['settings'][_0xebac63(0x8f3)]||'female-shaonv-jingpin',_0x553fed=_0xe0199b?'data-voice-id=\x22'+_0x95d2a5+'\x22':'';_0x2301e9=_0xebac63(0x5ae)+encodeURIComponent(_0x2b2d7f[_0xebac63(0x28c)])+'\x22\x20'+_0x553fed+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>'+_0x156b23+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>'+_0x438e3f+_0xebac63(0x668);}}else{if(_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0x1075)){_0x1e2576[_0xebac63(0x2f1)][_0xebac63(0x569)](_0xebac63(0x36a),_0xebac63(0x111d));let _0x2cc217,_0x2a82b5;const _0x291eb4=_0x297280['isGroup']?_0x297280[_0xebac63(0xdb9)]['myNickname']||'我':'我',_0x35e7fc=_0xb9963e(_0x297280,_0x2b2d7f[_0xebac63(0xcfc)]),_0x27a0d6=_0xb9963e(_0x297280,_0x2b2d7f['receiverName']||_0x297280['name']);if(_0x4e4d94){if(_0x2b2d7f[_0xebac63(0x11ca)])_0x2cc217='退款给\x20'+_0x27a0d6,_0x2a82b5='已拒收对方转账';else{_0x2cc217=_0xebac63(0xa92)+_0x27a0d6;if(_0x2b2d7f[_0xebac63(0x632)]===_0xebac63(0x59a))_0x2a82b5=_0xebac63(0x984);else{if(_0x2b2d7f[_0xebac63(0x632)]===_0xebac63(0xc0e))_0x2a82b5=_0xebac63(0x8d3);else _0x2a82b5=_0x2b2d7f[_0xebac63(0xa17)]||_0xebac63(0x9c3);}}}else{if(_0x2b2d7f[_0xebac63(0x11ca)])_0x2cc217=_0xebac63(0x861)+_0x35e7fc,_0x2a82b5=_0xebac63(0xf3c);else{if(_0x2b2d7f['receiverName']===_0x291eb4){_0x2cc217=_0xebac63(0xa92)+_0x291eb4;if(_0x2b2d7f[_0xebac63(0x632)]==='accepted')_0x2a82b5='你已收款';else{if(_0x2b2d7f[_0xebac63(0x632)]==='declined')_0x2a82b5=_0xebac63(0x371);else _0x1e2576[_0xebac63(0x68e)][_0xebac63(0x1049)]=_0xebac63(0x185),_0x1e2576[_0xebac63(0xaaf)][_0xebac63(0x632)]='pending',_0x2a82b5=_0x2b2d7f[_0xebac63(0xa17)]||_0xebac63(0x4e1);}}else _0x2cc217=_0xebac63(0x7be)+_0x35e7fc+_0xebac63(0x886)+_0x27a0d6,_0x2a82b5=_0x2b2d7f[_0xebac63(0xa17)]||'群聊内转账';}}const _0x4cd43a=_0xebac63(0x3be);_0x2301e9=_0xebac63(0x1259)+_0x4cd43a+'\x20'+_0x2cc217+_0xebac63(0xe8d)+Number(_0x2b2d7f['amount'])[_0xebac63(0x8f7)](0x2)+'</div><div\x20class=\x22transfer-note\x22>'+_0x2a82b5+_0xebac63(0xc8d);}else{if(_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0xcd9)){_0x1e2576[_0xebac63(0x2f1)][_0xebac63(0x569)](_0xebac63(0x3d1),_0xebac63(0x111d));if(_0x2b2d7f[_0xebac63(0x632)]==='paid'||_0x2b2d7f[_0xebac63(0x632)]===_0xebac63(0x93f))_0x1e2576['classList'][_0xebac63(0x569)](_0xebac63(0xaf0)+_0x2b2d7f[_0xebac63(0x632)]);const _0x37e78f=_0xb9963e(_0x297280,_0x2b2d7f['senderName']),_0x1c0709=_0xebac63(0x61e)+_0x37e78f+_0xebac63(0xdc8);let _0xecf462='';_0x2b2d7f[_0xebac63(0x632)]===_0xebac63(0x1042)&&!_0x4e4d94&&(_0xecf462='<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>'),_0x2301e9=_0xebac63(0x4ef)+_0x1c0709+_0xebac63(0x912)+Number(_0x2b2d7f[_0xebac63(0x10a6)])['toFixed'](0x2)+_0xebac63(0xafd)+_0x2b2d7f[_0xebac63(0x114e)]+_0xebac63(0x397)+_0xecf462+'</div>',setTimeout(()=>{const _0xa6c2e7=_0xebac63;if(_0x2b2d7f[_0xa6c2e7(0x632)]===_0xa6c2e7(0x1042)){const _0x4e478f=document[_0xa6c2e7(0x89d)](_0xa6c2e7(0x28d)+_0x2b2d7f[_0xa6c2e7(0x114e)]);if(_0x4e478f){const _0x1ffc8e=_0x34bb9a(_0x4e478f,_0x2b2d7f[_0xa6c2e7(0x1e7)]);_0x15984b[_0x2b2d7f['timestamp']]=_0x1ffc8e;}}},0x0);}else{if(_0x2b2d7f[_0xebac63(0x48c)]==='waimai_order'){_0x1e2576[_0xebac63(0x2f1)][_0xebac63(0x569)](_0xebac63(0x3d1),_0xebac63(0x111d));const _0x1c311b=_0xb9963e(_0x297280,_0x2b2d7f['senderName']);let _0x26b7d6='你';_0x297280[_0xebac63(0x58c)]&&(_0x26b7d6=_0xb9963e(_0x297280,_0x2b2d7f[_0xebac63(0x2ff)])),_0x2301e9=_0xebac63(0x4d5)+_0x1c311b+'\x20已为'+_0x26b7d6+_0xebac63(0x32c)+_0x2b2d7f[_0xebac63(0xb3e)]+_0xebac63(0xc7e)+Number(_0x2b2d7f['amount'])['toFixed'](0x2)+_0xebac63(0x846);}else{if(_0x2b2d7f[_0xebac63(0x48c)]===_0xebac63(0x675)){_0x1e2576[_0xebac63(0x2f1)][_0xebac63(0x569)](_0xebac63(0xd67),_0xebac63(0x111d));const _0x1716ad=_0x5b873d['qzoneSettings']['nickname']||_0xebac63(0x1285),_0x30f14d=_0x2b2d7f['isFullyClaimed'],_0x374066=_0x2b2d7f[_0xebac63(0xb37)]&&_0x2b2d7f[_0xebac63(0xb37)][_0x1716ad];let _0x184f23='',_0x458745='',_0x58023b=_0xebac63(0x257);_0x30f14d&&(_0x184f23=_0xebac63(0x841));if(_0x2b2d7f[_0xebac63(0x2d1)]===_0xebac63(0xfc5)){const _0x32a428=_0xb9963e(_0x297280,_0x2b2d7f[_0xebac63(0xb12)]);_0x58023b='专属红包:\x20给\x20'+_0x32a428;if(Object[_0xebac63(0xe9c)](_0x2b2d7f[_0xebac63(0xb37)]||{})[_0xebac63(0x7aa)]>0x0)_0x184f23='opened';}if(_0x374066){const _0x262aef=_0x2b2d7f[_0xebac63(0xb37)][_0x1716ad]||0x0;_0x458745=_0xebac63(0x106e)+_0x262aef[_0xebac63(0x8f7)](0x2)+_0xebac63(0x9fc);}else{if(_0x30f14d)_0x458745=_0xebac63(0x948);else{if(_0x2b2d7f[_0xebac63(0x2d1)]===_0xebac63(0xfc5)&&Object[_0xebac63(0xe9c)](_0x2b2d7f[_0xebac63(0xb37)]||{})['length']>0x0){const _0x3f7dd0=_0xb9963e(_0x297280,_0x2b2d7f[_0xebac63(0xb12)]);_0x458745=_0xebac63(0x972)+_0x3f7dd0+_0xebac63(0x74d);}}}_0x2301e9='<div\x20class=\x22red-packet-card\x20'+_0x184f23+_0xebac63(0x510)+(_0x2b2d7f[_0xebac63(0x108d)]||_0xebac63(0x12f9))+_0xebac63(0xb02)+_0x58023b+_0xebac63(0xc57)+_0x458745+_0xebac63(0xc57);}else{if(_0x2b2d7f['type']==='poll'){_0x1e2576[_0xebac63(0x2f1)][_0xebac63(0x569)](_0xebac63(0x137d),'is-card-like');const _0x38ad7b=_0x2b2d7f['question']||_0x2b2d7f[_0xebac63(0x28c)]||_0xebac63(0x5b2);let _0x4b0937=0x0;const _0x22ef97={};for(const _0x473dae in _0x2b2d7f[_0xebac63(0x10d1)]){const _0x37863e=_0x2b2d7f[_0xebac63(0x10d1)][_0x473dae][_0xebac63(0x7aa)];_0x22ef97[_0x473dae]=_0x37863e,_0x4b0937+=_0x37863e;}const _0x31613b=_0x5b873d[_0xebac63(0x5c1)][_0xebac63(0x22a)]||'{{user}}';let _0x52f04f=null;for(const _0x1b2339 in _0x2b2d7f[_0xebac63(0x10d1)]){if(_0x2b2d7f[_0xebac63(0x10d1)][_0x1b2339][_0xebac63(0xced)](_0x31613b)){_0x52f04f=_0x1b2339;break;}}let _0xc4b9c2=_0xebac63(0x1217);_0x2b2d7f[_0xebac63(0x1034)][_0xebac63(0xd9a)](_0x4001e6=>{const _0x529d44=_0xebac63,_0x37f58f=_0x22ef97[_0x4001e6]||0x0,_0x430536=_0x4b0937>0x0?_0x37f58f/_0x4b0937*0x64:0x0,_0x5b2fc4=_0x52f04f===_0x4001e6;_0xc4b9c2+=_0x529d44(0xdb3)+(_0x5b2fc4?_0x529d44(0x33f):'')+_0x529d44(0xc03)+_0x4001e6+_0x529d44(0xa15)+_0x430536+'%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>'+_0x4001e6+_0x529d44(0xb91)+_0x37f58f+_0x529d44(0x9fd);}),_0xc4b9c2+=_0xebac63(0xc57);let _0x528435=_0x2b2d7f['isClosed']?'<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20'+_0x4b0937+'\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>':'<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20'+_0x4b0937+_0xebac63(0x8b4);_0x2301e9=_0xebac63(0x10aa)+(_0x2b2d7f[_0xebac63(0xd1e)]?_0xebac63(0x514):'')+_0xebac63(0xe9f)+_0x2b2d7f['timestamp']+'\x22><div\x20class=\x22poll-question\x22>'+_0x38ad7b+_0xebac63(0xc57)+_0xc4b9c2+_0x528435+'</div>';}else{if(_0x2b2d7f['type']===_0xebac63(0xf80)){_0x1e2576['classList'][_0xebac63(0x569)](_0xebac63(0x8b5),_0xebac63(0x111d));let _0x19c807;const _0x331d14=_0x297280[_0xebac63(0xdb9)][_0xebac63(0xc48)]||'我';if(_0x297280[_0xebac63(0x58c)]){if(_0x2b2d7f[_0xebac63(0x7c7)]&&_0x2b2d7f[_0xebac63(0x7c7)][_0xebac63(0x7aa)]>0x0){const _0x419046=_0x2b2d7f[_0xebac63(0x7c7)][_0xebac63(0x412)](_0x18939d=>_0xb9963e(_0x297280,_0x18939d));_0x419046['length']===0x1?_0x19c807=_0xebac63(0x11ae)+_0x419046[0x0]+_0xebac63(0xf78):_0x19c807=_0xebac63(0x11ae)+_0x419046[_0xebac63(0xdd0)](0x0,0x2)[_0xebac63(0x1237)]('、')+'等人的礼物';}else _0x19c807=_0xebac63(0x6cc);}else{if(_0x4e4d94)_0x19c807=_0xebac63(0x11ae)+_0x297280[_0xebac63(0xf74)]+_0xebac63(0xf78);else{const _0xbe549c=_0x297280[_0xebac63(0xdb9)][_0xebac63(0xc48)]||'你';_0x19c807=_0xebac63(0x11ae)+_0xbe549c+_0xebac63(0xf78);}}const _0x303d95=_0x2b2d7f[_0xebac63(0xcd7)]['slice'](0x0,0x3);let _0xfca26b='';_0x303d95[_0xebac63(0xd9a)](_0x2fd5dc=>{const _0x4c941a=_0xebac63;_0xfca26b+=_0x4c941a(0x118d)+_0x2fd5dc[_0x4c941a(0x450)]+_0x4c941a(0xba7)+_0x2fd5dc[_0x4c941a(0xf74)]+'</span><span\x20class=\x22gift-preview-quantity\x22>x'+_0x2fd5dc[_0x4c941a(0x66c)]+'</span></div>';});let _0x9e80c9='';_0x2b2d7f[_0xebac63(0xcd7)]['length']>0x3&&(_0x9e80c9='\x20等'+_0x2b2d7f[_0xebac63(0xcd7)][_0xebac63(0x7aa)]+'件商品'),_0x2301e9='<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>'+_0x19c807+_0xebac63(0x87e)+_0xfca26b+_0xebac63(0x38b)+_0x2b2d7f['items'][_0xebac63(0x7aa)]+_0xebac63(0xb81)+_0x9e80c9+_0xebac63(0x63f);}}}}}}}}}}}}}}else{const _0x8410de=String(_0x49a44b);let _0x38a6dc=await _0x1eb7df(_0x8410de,_0x297280['id']);if(_0x38a6dc!==_0x8410de)_0x2301e9=_0x38a6dc,_0x1e2576[_0xebac63(0x2f1)][_0xebac63(0x569)]('is-card-like');else{if(Array[_0xebac63(0xbd6)](_0x2b2d7f['content'])&&_0x2b2d7f[_0xebac63(0x28c)][0x0]?.['type']===_0xebac63(0xcad)){const _0x3e18cb=_0x2b2d7f[_0xebac63(0x28c)][0x0][_0xebac63(0xcad)]['url'];_0x2301e9='<img\x20src=\x22'+_0x3e18cb+'\x22\x20class=\x22chat-image\x22>';}else{if(_0x3b71b1[_0xebac63(0xb80)](_0x38a6dc))_0x1e2576[_0xebac63(0x2f1)][_0xebac63(0x569)]('is-sticker',_0xebac63(0x111d)),_0x2301e9=_0xebac63(0x477)+_0x38a6dc+_0xebac63(0xee0)+(_0x2b2d7f['meaning']||'Sticker')+'\x22\x20class=\x22sticker-image\x22>';else{let _0x3cda76=_0x401262(_0x38a6dc,_0x297280);_0x2301e9=_0x55b8e7(_0x3cda76)['replace'](/\n/g,_0xebac63(0x962));}}}}}_0x1e2576[_0xebac63(0x1ef)]=_0xebac63(0x12b9)+_0x56b42c+_0xebac63(0x9fa)+_0x1b0779+_0xebac63(0x100a)+_0x2301e9+_0xebac63(0xc02),_0x1b2a25[_0xebac63(0x22f)](_0x1e2576),_0x1b2a25['appendChild'](_0x35ed78),_0xefe9e2(_0x1b2a25,()=>_0x57d678(_0x2b2d7f[_0xebac63(0x114e)])),_0x1b2a25['addEventListener'](_0xebac63(0x12a5),()=>{const _0x2ab1c3=_0xebac63;if(_0x17f18d)_0x465a2d(_0x2b2d7f[_0x2ab1c3(0x114e)]);});if(!_0x4e4d94){const _0x3a6596=_0x1b2a25[_0xebac63(0xd16)](_0xebac63(0xbf9));_0x3a6596&&(_0x3a6596['style'][_0xebac63(0x1049)]=_0xebac63(0x185),!_0x297280[_0xebac63(0x58c)]?_0x3a6596[_0xebac63(0x1193)](_0xebac63(0x12a5),_0x5c15d6=>{const _0x42fa57=_0xebac63;_0x5c15d6[_0x42fa57(0x1088)](),_0xdae43c(_0x297280['id']);}):_0x3a6596[_0xebac63(0x1193)](_0xebac63(0xcf8),_0x3634d2=>{const _0x1c98f9=_0xebac63;_0x3634d2[_0x1c98f9(0x1088)](),_0x167bd1(_0x297280['id'],_0x2b2d7f[_0x1c98f9(0xcfc)]);}));}return _0x1b2a25;}async function _0x27634f(_0x3d55af,_0x3b8171){const _0x23ae1a=_0x41eae2,_0x4421b=document['getElementById'](_0x23ae1a(0x116e)),_0x704d97=await _0x1ed144(_0x3d55af,_0x3b8171);if(!_0x704d97)return;const _0x50825e=document[_0x23ae1a(0x89d)](_0x23ae1a(0x1108));_0x50825e?_0x4421b[_0x23ae1a(0x1028)](_0x704d97,_0x50825e['nextSibling']):_0x4421b[_0x23ae1a(0x778)](_0x704d97);}async function _0x58deee(_0x33666b,_0x45f8fb,_0x3c94db=![]){const _0xe32c32=_0x41eae2,_0x43f2f2=document[_0xe32c32(0x89d)](_0xe32c32(0x116e)),_0x11c687=document['getElementById'](_0xe32c32(0x1c5)),_0x398766=_0x45f8fb[_0xe32c32(0x551)][_0xe32c32(0x3d8)](_0x72e3f0=>!_0x72e3f0[_0xe32c32(0x9ae)])[_0xe32c32(0x114b)]();if(_0x398766&&_0x33666b[_0xe32c32(0x114e)]-_0x398766['timestamp']>0x927c0){const _0x15fda5=_0x40d372(_0x33666b[_0xe32c32(0x114e)]);_0x43f2f2[_0xe32c32(0x1028)](_0x15fda5,_0x11c687);}const _0x4db023=await _0x1ed144(_0x33666b,_0x45f8fb);if(!_0x4db023)return;_0x33666b[_0xe32c32(0xa57)]===_0xe32c32(0x1377)&&!_0x3c94db&&_0x4541bb(),!_0x3c94db&&_0x4db023[_0xe32c32(0x2f1)][_0xe32c32(0x569)](_0xe32c32(0x380)),_0x43f2f2['insertBefore'](_0x4db023,_0x11c687),!_0x3c94db&&(_0x43f2f2['scrollTop']=_0x43f2f2[_0xe32c32(0x624)],_0x3def71++);}async function _0x597f5a(_0xc95954){const _0x4f6b20=_0x41eae2;_0x5b873d[_0x4f6b20(0xf96)]=_0xc95954;const _0x1c532e=_0x5b873d[_0x4f6b20(0x667)][_0xc95954];if(!_0x1c532e)return;_0x1c532e[_0x4f6b20(0x3ce)]>0x0&&(_0x1c532e[_0x4f6b20(0x3ce)]=0x0,await _0x1a6951[_0x4f6b20(0x667)][_0x4f6b20(0xc0f)](_0x1c532e));_0x52994c(_0x1c532e),_0x5b89df(_0xc95954),_0x4e6c15(_0x4f6b20(0x87f)),window['updateListenTogetherIconProxy'](_0x5b873d[_0x4f6b20(0xf96)]);const _0x36fc0a=_0x1c532e['isGroup']||![];_0xf49309(_0x36fc0a),document[_0x4f6b20(0x89d)](_0x4f6b20(0x7ad))[_0x4f6b20(0x68e)][_0x4f6b20(0x126b)]=_0x36fc0a?_0x4f6b20(0x66e):'none';const _0x279d8f=document[_0x4f6b20(0x89d)](_0x4f6b20(0xbcd));_0x279d8f&&(_0x279d8f[_0x4f6b20(0x68e)][_0x4f6b20(0x126b)]=_0x36fc0a?_0x4f6b20(0x10f2):_0x4f6b20(0x66e));const _0x2c3bce=document[_0x4f6b20(0x89d)](_0x4f6b20(0xa8c)),_0xc9731e=document[_0x4f6b20(0x89d)](_0x4f6b20(0x943)),_0x404a21=document[_0x4f6b20(0x89d)]('gomoku-btn'),_0x4219fa=document['getElementById']('werewolf-game-btn');_0xc9731e&&_0x404a21&&_0x4219fa&&_0x2c3bce&&(_0xc9731e[_0x4f6b20(0x68e)][_0x4f6b20(0x126b)]=_0x4f6b20(0x66e),_0x404a21[_0x4f6b20(0x68e)][_0x4f6b20(0x126b)]=_0x36fc0a?_0x4f6b20(0x10f2):_0x4f6b20(0x66e),_0x4219fa[_0x4f6b20(0x68e)][_0x4f6b20(0x126b)]=_0x36fc0a?_0x4f6b20(0x66e):_0x4f6b20(0x10f2),_0x2c3bce['style'][_0x4f6b20(0x126b)]=_0x36fc0a?'none':_0x4f6b20(0x66e)),_0x255a31(),!_0x1c532e[_0x4f6b20(0x58c)]&&_0x1c532e[_0x4f6b20(0x1383)]?.[_0x4f6b20(0x632)]===_0x4f6b20(0x12d2)&&(console[_0x4f6b20(0x471)]('检测到好友申请待处理状态，为角色\x20\x22'+_0x1c532e[_0x4f6b20(0xf74)]+'\x22\x20自动触发AI响应...'),_0x2e3505()),document[_0x4f6b20(0x89d)](_0x4f6b20(0x9ce))[_0x4f6b20(0x68e)]['display']=_0x36fc0a?_0x4f6b20(0x66e):'none';}function _0x405b57(_0x5cb2df,_0xe1cf1f){const _0xf38209=_0x41eae2,_0x35f65a=_0xe1cf1f?_0xf38209(0x569):'remove',_0xf74c58=_0xb695bd=>{const _0x280bf4=_0xf38209;_0xb695bd&&_0xb695bd[_0x280bf4(0x2f1)][_0x35f65a]('is-acting');},_0x29e8f5=document['querySelector'](_0xf38209(0x552)+_0x5cb2df+_0xf38209(0x119c));_0xf74c58(_0x29e8f5);const _0x3d6430=document[_0xf38209(0x35f)](_0xf38209(0x10ce)+_0x5cb2df+'\x22]');_0x3d6430[_0xf38209(0xd9a)](_0xf74c58);const _0x27958e=document[_0xf38209(0xd16)](_0xf38209(0x54e)+_0x5cb2df+'\x22]');_0xf74c58(_0x27958e);}async function _0x5f21e2(){const _0x75b1ea=_0x41eae2;if(!_0x5b873d[_0x75b1ea(0xf96)])return;const _0x1dbd25=_0x5b873d[_0x75b1ea(0xf96)],_0x4266e1=_0x5b873d[_0x75b1ea(0x667)][_0x1dbd25];lastRawAiResponse='',lastResponseTimestamps=[];const _0x3bc568=document[_0x75b1ea(0x89d)](_0x75b1ea(0xbf4));_0x3bc568&&(_0x3bc568[_0x75b1ea(0x3f7)]=!![],_0x3bc568[_0x75b1ea(0xf12)]='思考中...');_0x405b57(_0x1dbd25,!![]);try{const {proxyUrl:_0x312a73,apiKey:_0x32275f,model:_0x566b1b}=_0x5b873d[_0x75b1ea(0x30d)];if(!_0x312a73||!_0x32275f||!_0x566b1b)throw new Error(_0x75b1ea(0x1308));const _0x201f13=parseInt(_0x4266e1[_0x75b1ea(0xdb9)]['maxMemory'])||0xa,_0x37ecae=_0x4266e1[_0x75b1ea(0x551)][_0x75b1ea(0xdd0)](-_0x201f13);let _0x2e4e50='';if(_0x4266e1[_0x75b1ea(0xdb9)][_0x75b1ea(0x32d)]&&_0x4266e1[_0x75b1ea(0xdb9)][_0x75b1ea(0x32d)][_0x75b1ea(0x7aa)]>0x0){const _0x22d5b7=_0x4266e1[_0x75b1ea(0xdb9)][_0x75b1ea(0x32d)][_0x75b1ea(0x412)](_0x4be93f=>{const _0x2a253e=_0x75b1ea,_0x241b89=_0x5b873d[_0x2a253e(0x8a1)][_0x2a253e(0x12f4)](_0x5cecde=>_0x5cecde['id']===_0x4be93f);if(!_0x241b89||!Array[_0x2a253e(0xbd6)](_0x241b89[_0x2a253e(0x28c)]))return'';const _0x458bf7=_0x241b89[_0x2a253e(0x28c)][_0x2a253e(0x3d8)](_0x14111b=>_0x14111b[_0x2a253e(0x104e)]!==![])[_0x2a253e(0x412)](_0x9b51ae=>{const _0x2dc3d6=_0x2a253e;let _0x9284ae='\x0a###\x20条目:\x20'+(_0x9b51ae[_0x2dc3d6(0x8f9)]||_0x2dc3d6(0xc06))+'\x0a';if(_0x9b51ae['keys'][_0x2dc3d6(0x7aa)]>0x0)_0x9284ae+='**关键词:**\x20'+_0x9b51ae[_0x2dc3d6(0xe9c)][_0x2dc3d6(0x1237)](',\x20')+'\x0a';return _0x9284ae+='**内容:**\x0a'+_0x9b51ae[_0x2dc3d6(0x28c)],_0x9284ae;})[_0x2a253e(0x1237)]('');return _0x458bf7?_0x2a253e(0xb85)+_0x241b89[_0x2a253e(0xf74)]+'\x0a'+_0x458bf7:'';})[_0x75b1ea(0x3d8)](Boolean)[_0x75b1ea(0x1237)]('');_0x22d5b7&&(_0x2e4e50=_0x75b1ea(0x312)+_0x22d5b7+_0x75b1ea(0xdf6));}let _0x3c0910='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0x992da4=![];_0x4266e1[_0x75b1ea(0x5ab)][_0x75b1ea(0xd9a)](_0x280a33=>{const _0x187fed=_0x75b1ea,_0x2fca2d=_0x5b873d['chats'][_0x280a33['id']];_0x2fca2d&&_0x2fca2d[_0x187fed(0xc18)]&&_0x2fca2d[_0x187fed(0xc18)][_0x187fed(0x7aa)]>0x0&&(_0x3c0910+=_0x187fed(0x65c)+_0x280a33[_0x187fed(0x7da)]+'”的记忆\x20---\x0a',_0x3c0910+=_0x2fca2d[_0x187fed(0xc18)][_0x187fed(0x412)](_0x97792e=>_0x187fed(0x768)+_0x4ce38e(_0x97792e[_0x187fed(0x114e)])+')\x20'+_0x97792e[_0x187fed(0x28c)])['join']('\x0a'),_0x992da4=!![]);});!_0x992da4&&(_0x3c0910+=_0x75b1ea(0x12c3));let _0x51e69f='';const _0x3403e5=_0x4266e1[_0x75b1ea(0xdb9)][_0x75b1ea(0x654)]||0xa;if(_0x4266e1[_0x75b1ea(0xdb9)]['linkedMemoryChatIds']&&_0x4266e1[_0x75b1ea(0xdb9)][_0x75b1ea(0xf0e)]['length']>0x0){}const _0xab4164=_0x4266e1[_0x75b1ea(0x5ab)][_0x75b1ea(0x412)](_0x20065e=>_0x75b1ea(0x928)+_0x20065e['groupNickname']+_0x75b1ea(0x5f1)+_0x20065e[_0x75b1ea(0x1045)]+'):\x20'+_0x20065e[_0x75b1ea(0x1170)])['join']('\x0a'),_0x21a11b=_0x4f684e(_0x4266e1),_0xb675c7=_0x75b1ea(0x740)+_0x4266e1[_0x75b1ea(0xf74)]+_0x75b1ea(0xb19)+_0x4266e1[_0x75b1ea(0xf74)]+_0x75b1ea(0x8bc)+_0x3c0910+'\x0a'+_0x2e4e50+'\x0a'+_0x51e69f+_0x75b1ea(0x1f9)+_0x37ecae[_0x75b1ea(0x412)](_0x136ce5=>_0xb9963e(_0x4266e1,_0x136ce5[_0x75b1ea(0xcfc)])+':\x20'+_0x136ce5[_0x75b1ea(0x28c)])[_0x75b1ea(0x1237)]('\x0a')+_0x75b1ea(0x58f)+_0xab4164+_0x75b1ea(0x1c1)+_0x21a11b+_0x75b1ea(0x411),_0x4d3c19=_0x37ecae[_0x75b1ea(0x412)](_0xc053f0=>({'role':_0x75b1ea(0x116c),'content':_0xb9963e(_0x4266e1,_0xc053f0['senderName'])+':\x20'+_0xc053f0[_0x75b1ea(0x28c)]}));let _0x133230=_0x312a73[_0x75b1ea(0xced)]('generativelanguage.googleapis.com'),_0x488054;if(_0x133230){let _0x2af227=_0xa615f4(_0x566b1b,_0x32275f,_0xb675c7,_0x4d3c19);_0x488054=await fetch(_0x2af227['url'],_0x2af227[_0x75b1ea(0xd98)]);}else _0x488054=await fetch(_0x312a73+_0x75b1ea(0x6dd),{'method':'POST','headers':{'Content-Type':_0x75b1ea(0xce4),'Authorization':_0x75b1ea(0x3fb)+_0x32275f},'body':JSON[_0x75b1ea(0x465)]({'model':_0x566b1b,'messages':[{'role':'system','content':_0xb675c7},..._0x4d3c19],'temperature':_0x5b873d[_0x75b1ea(0x21a)][_0x75b1ea(0x576)]||0.9})});if(!_0x488054['ok']){const _0x242d92=await _0x488054[_0x75b1ea(0x6b5)]()[_0x75b1ea(0x1035)](()=>({'error':{'message':_0x488054[_0x75b1ea(0x517)]}}));throw new Error(_0x75b1ea(0xf8b)+_0x488054[_0x75b1ea(0x632)]+'\x20-\x20'+(_0x242d92[_0x75b1ea(0x1fd)]?.['message']||_0x75b1ea(0x9d5)));}const _0xf63b4=await _0x488054['json'](),_0x269bb9=getGeminiResponseText(_0xf63b4);lastRawAiResponse=_0x269bb9;const _0x1a1a7d=_0x29a17f(_0x269bb9);let _0xe159e0=Date[_0x75b1ea(0xf1a)]();for(const _0x4dbfee of _0x1a1a7d){if(!_0x4dbfee||!_0x4dbfee[_0x75b1ea(0x48c)]||!_0x4dbfee[_0x75b1ea(0xf74)])continue;let _0x35c4d0=null;const _0x2f302d=_0xe159e0++;lastResponseTimestamps[_0x75b1ea(0x138c)](_0x2f302d);const _0x234b48={'role':'assistant','senderName':_0x4dbfee[_0x75b1ea(0xf74)],'timestamp':_0x2f302d};switch(_0x4dbfee['type']){case _0x75b1ea(0xec9):_0x35c4d0={..._0x234b48,'content':_0x4dbfee['content']};break;case _0x75b1ea(0x3c8):if(_0x4dbfee[_0x75b1ea(0xb5c)]){const _0xf02dd4=_0x5b873d[_0x75b1ea(0x210)][_0x75b1ea(0x12f4)](_0x4af5c2=>_0x4af5c2[_0x75b1ea(0xf74)]===_0x4dbfee[_0x75b1ea(0xb5c)]);_0xf02dd4?_0x35c4d0={..._0x234b48,'type':_0x75b1ea(0x3c8),'content':_0xf02dd4[_0x75b1ea(0x11de)],'meaning':_0xf02dd4[_0x75b1ea(0xf74)]}:(console[_0x75b1ea(0xac3)](_0x75b1ea(0xf04)+_0x4dbfee[_0x75b1ea(0xb5c)]+'\x22'),_0x35c4d0={..._0x234b48,'type':'text','content':_0x75b1ea(0x507)+_0x4dbfee['meaning']+']'});}else console[_0x75b1ea(0xac3)](_0x75b1ea(0x1313),_0x4dbfee);break;case _0x75b1ea(0x656):_0x35c4d0={..._0x234b48,'type':'ai_image','content':_0x4dbfee[_0x75b1ea(0xf6e)],'image_prompt':_0x4dbfee[_0x75b1ea(0x895)]};break;case _0x75b1ea(0xff9):_0x35c4d0={..._0x234b48,'type':_0x75b1ea(0xff9),'content':_0x4dbfee[_0x75b1ea(0x28c)]};break;case'quote_reply':const _0x2be1a5=_0x4266e1[_0x75b1ea(0x551)][_0x75b1ea(0x12f4)](_0x239cc3=>_0x239cc3[_0x75b1ea(0x114e)]===_0x4dbfee[_0x75b1ea(0x36e)]);_0x2be1a5?_0x35c4d0={..._0x234b48,'content':_0x4dbfee[_0x75b1ea(0x22c)],'quote':{'timestamp':_0x2be1a5['timestamp'],'senderName':_0x2be1a5[_0x75b1ea(0xcfc)],'content':String(_0x2be1a5['content']||'')[_0x75b1ea(0x489)](0x0,0x32)}}:_0x35c4d0={..._0x234b48,'content':_0x4dbfee[_0x75b1ea(0x22c)]};break;default:console[_0x75b1ea(0xac3)](_0x75b1ea(0x11c5),_0x4dbfee[_0x75b1ea(0x48c)]);continue;}_0x35c4d0&&(_0x4266e1['history'][_0x75b1ea(0x138c)](_0x35c4d0),_0x58deee(_0x35c4d0,_0x4266e1),await new Promise(_0x493d55=>setTimeout(_0x493d55,Math[_0x75b1ea(0xdc6)]()*0x4b0+0x320)));}await _0x1a6951[_0x75b1ea(0x667)][_0x75b1ea(0xc0f)](_0x4266e1),_0x413d78();}catch(_0x2ef300){console['error']('旁观模式推进剧情失败:',_0x2ef300),await _0x532f76(_0x75b1ea(0x10de),'无法推进剧情:\x20'+_0x2ef300[_0x75b1ea(0x1288)]);}finally{_0x3bc568&&(_0x3bc568[_0x75b1ea(0x3f7)]=![],_0x3bc568[_0x75b1ea(0xf12)]=_0x75b1ea(0xb29)),_0x405b57(_0x1dbd25,![]);}}async function _0x2e3505(){const _0x118c17=_0x41eae2;if(!_0x5b873d[_0x118c17(0xf96)])return;const _0x2fd04d=_0x5b873d[_0x118c17(0xf96)],_0x1a4b35=_0x5b873d[_0x118c17(0x667)][_0x5b873d[_0x118c17(0xf96)]],_0xd28886=document[_0x118c17(0x89d)]('chat-interface-screen')[_0x118c17(0x2f1)][_0x118c17(0x3ff)]('active')&&_0x5b873d[_0x118c17(0xf96)]===_0x2fd04d;_0x405b57(_0x2fd04d,!![]);const _0x42afe3=document['getElementById'](_0x118c17(0x578)),_0x17bda5=document[_0x118c17(0x89d)](_0x118c17(0x1c5)),_0xa116ce=document[_0x118c17(0xd16)](_0x118c17(0x552)+_0x2fd04d+'\x22]'),_0x35db98=_0xa116ce?_0xa116ce['querySelector'](_0x118c17(0x6ae)):null;_0x35db98&&_0x35db98['classList'][_0x118c17(0x569)](_0x118c17(0x6dc));_0x1a4b35[_0x118c17(0x58c)]?_0x17bda5&&(_0x17bda5[_0x118c17(0xf12)]=_0x118c17(0x842),_0x17bda5[_0x118c17(0x68e)][_0x118c17(0x126b)]='block'):_0x42afe3&&(_0x42afe3['style'][_0x118c17(0x50d)]=0x0,setTimeout(()=>{const _0x187ccc=_0x118c17;_0x42afe3[_0x187ccc(0xf12)]=_0x187ccc(0x3fe),_0x42afe3[_0x187ccc(0x2f1)]['add'](_0x187ccc(0xb51)),_0x42afe3[_0x187ccc(0x68e)][_0x187ccc(0x50d)]=0x1;},0xc8));let _0x3752d4=![];try{const {proxyUrl:_0x415b60,apiKey:_0xbca131,model:_0x14ed4d}=_0x5b873d[_0x118c17(0x30d)];if(!_0x415b60||!_0xbca131||!_0x14ed4d){alert('请先在API设置中配置反代地址、密钥并选择模型。');if(_0x1a4b35[_0x118c17(0x58c)]){if(_0x17bda5)_0x17bda5['style']['display']=_0x118c17(0x10f2);}else _0x42afe3&&_0x5b873d[_0x118c17(0x667)][_0x2fd04d]&&(_0x42afe3[_0x118c17(0xf12)]=_0x5b873d['chats'][_0x2fd04d]['name'],_0x42afe3['classList'][_0x118c17(0x1247)]('typing-status'));return;}const _0x160228=_0x1a4b35[_0x118c17(0x551)]['slice'](-0x1)[0x0],_0x5b3601=_0x160228&&_0x160228['role']===_0x118c17(0x18c)&&_0x160228['content'][_0x118c17(0xced)]('视频通话请求');if(_0x5b3601){console[_0x118c17(0x471)](_0x118c17(0x1083)+_0x1a4b35[_0x118c17(0xf74)]+_0x118c17(0x207));let _0x13479b;_0x1a4b35[_0x118c17(0x58c)]?_0x13479b=_0x118c17(0xd5f)+_0x1a4b35['members']['map'](_0x4648e3=>'-\x20'+_0x4648e3[_0x118c17(0x7da)]+_0x118c17(0x95e)+_0x4648e3[_0x118c17(0x1045)]+'):\x20'+_0x4648e3[_0x118c17(0x1170)])[_0x118c17(0x1237)]('\x0a')+_0x118c17(0xeb7):_0x13479b=_0x118c17(0xb62)+_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x1269)]+_0x118c17(0x1229);const _0x245082=[{'role':'user','content':_0x13479b}];try{let _0x437b71=_0xa615f4(_0x14ed4d,_0xbca131,_0x13479b,_0x245082),_0x38ca7f=_0x415b60===GEMINI_API_URL;const _0x3a0022=_0x38ca7f?await fetch(_0x437b71[_0x118c17(0x11de)],_0x437b71[_0x118c17(0xd98)]):await fetch(_0x415b60+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x118c17(0xce4),'Authorization':_0x118c17(0x3fb)+_0xbca131},'body':JSON[_0x118c17(0x465)]({'model':_0x14ed4d,'messages':_0x245082,'temperature':0.7})});if(!_0x3a0022['ok'])throw new Error('API失败:\x20'+(await _0x3a0022['json']())['error'][_0x118c17(0x1288)]);const _0x316d21=await _0x3a0022[_0x118c17(0x6b5)](),_0x4ab024=getGeminiResponseText(_0x316d21),_0x1f8396=_0x29a17f(_0x4ab024);let _0x4e506f=![];for(const _0xafea93 of _0x1f8396){if(_0xafea93[_0x118c17(0x48c)]==='video_call_response'){_0x333dc7['isAwaitingResponse']=![];if(_0xafea93[_0x118c17(0xc49)]===_0x118c17(0xc52))_0x11ad56();else{const _0x2c2763={'role':'assistant','content':_0x118c17(0x4f6),'timestamp':Date['now']()};_0x1a4b35[_0x118c17(0x551)]['push'](_0x2c2763),await _0x1a6951[_0x118c17(0x667)][_0x118c17(0xc0f)](_0x1a4b35),_0x4e6c15(_0x118c17(0x87f)),_0x5b89df(_0x2fd04d);}_0x4e506f=!![];break;}if(_0xafea93[_0x118c17(0x48c)]===_0x118c17(0xeb1)){if(_0xafea93[_0x118c17(0xc49)]===_0x118c17(0x1237)){const _0x28506d=_0x1a4b35[_0x118c17(0x5ab)][_0x118c17(0x12f4)](_0x193d74=>_0x193d74[_0x118c17(0x1045)]===_0xafea93[_0x118c17(0xf74)]);_0x28506d&&!_0x333dc7[_0x118c17(0x394)]['some'](_0x4a5433=>_0x4a5433['id']===_0x28506d['id'])&&_0x333dc7['participants']['push'](_0x28506d);}_0x4e506f=!![];}}_0x4e506f&&_0x333dc7['isGroupCall']&&(_0x333dc7[_0x118c17(0xba8)]=![],_0x333dc7['participants'][_0x118c17(0x7aa)]>0x0?_0x11ad56():(_0x333dc7={..._0x333dc7,'isAwaitingResponse':![],'participants':[]},_0x4e6c15(_0x118c17(0x87f)),alert(_0x118c17(0x134d))));}catch(_0x5b98d0){console['error']('处理通话请求时API出错:',_0x5b98d0);const _0x3a83ed=_0x1a4b35[_0x118c17(0x58c)]?_0x1a4b35['members'][_0x118c17(0x412)](_0x37f249=>({'type':_0x118c17(0xeb1),'name':_0x37f249[_0x118c17(0x1045)],'decision':_0x118c17(0x9ca)})):[{'type':_0x118c17(0x265),'decision':_0x118c17(0x99f)}];if(_0x1a4b35[_0x118c17(0x58c)])_0x333dc7[_0x118c17(0xba8)]=![],_0x333dc7[_0x118c17(0x394)]=[],alert(_0x118c17(0x134d)),_0x4e6c15('chat-interface-screen');else{const _0x128df9={'role':_0x118c17(0x1377),'content':_0x118c17(0x4f6),'timestamp':Date[_0x118c17(0xf1a)]()};_0x1a4b35['history']['push'](_0x128df9),await _0x1a6951[_0x118c17(0x667)][_0x118c17(0xc0f)](_0x1a4b35),_0x4e6c15(_0x118c17(0x87f)),_0x5b89df(_0x2fd04d);}}finally{_0x405b57(_0x2fd04d,![]);return;}}if(!_0x1a4b35['isGroup']&&_0x1a4b35[_0x118c17(0x1383)]?.[_0x118c17(0x632)]===_0x118c17(0x12d2)){console[_0x118c17(0x471)](_0x118c17(0x1043)+_0x1a4b35[_0x118c17(0xf74)]+_0x118c17(0x1fe));const _0x13d6e3=_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x3d8)](_0x5d73af=>!_0x5d73af[_0x118c17(0x9ae)])[_0x118c17(0xdd0)](-0xa,-0x5)[_0x118c17(0x412)](_0x5f2359=>{const _0x12c080=_0x118c17,_0x20e43f=_0x5f2359['role']===_0x12c080(0x116c)?'用户':_0x1a4b35['name'];return _0x20e43f+':\x20'+String(_0x5f2359[_0x12c080(0x28c)])[_0x12c080(0x489)](0x0,0x32)+_0x12c080(0x1046);})[_0x118c17(0x1237)]('\x0a'),_0x3934b2=_0x118c17(0xc36)+_0x1a4b35[_0x118c17(0xf74)]+_0x118c17(0x111e)+_0x1a4b35['settings'][_0x118c17(0x1269)]+_0x118c17(0x1b1)+_0x1a4b35[_0x118c17(0x1383)]['applicationReason']+_0x118c17(0x8d5)+(_0x13d6e3||_0x118c17(0x11b5))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20';try{const _0x274132=[{'role':_0x118c17(0x18c),'content':_0x3934b2},{'role':'user','content':_0x118c17(0x91b)}];let _0x18354c=_0x415b60===GEMINI_API_URL,_0x44822c=_0xa615f4(_0x14ed4d,_0xbca131,_0x3934b2,[{'role':_0x118c17(0x116c),'content':_0x118c17(0x91b)}]);const _0xa72028=_0x18354c?await fetch(_0x44822c[_0x118c17(0x11de)],_0x44822c[_0x118c17(0xd98)]):await fetch(_0x415b60+_0x118c17(0x6dd),{'method':_0x118c17(0xd14),'headers':{'Content-Type':_0x118c17(0xce4),'Authorization':_0x118c17(0x3fb)+_0xbca131},'body':JSON[_0x118c17(0x465)]({'model':_0x14ed4d,'messages':_0x274132,'temperature':_0x5b873d[_0x118c17(0x21a)][_0x118c17(0x576)]||0.8})});if(!_0xa72028['ok'])throw new Error(_0x118c17(0xf14)+(await _0xa72028[_0x118c17(0x6b5)]())['error']['message']);const _0x3a4b5a=await _0xa72028[_0x118c17(0x6b5)](),_0x2b6319=getGeminiResponseText(_0x3a4b5a)[_0x118c17(0xfbf)](/^```json\s*/,'')['replace'](/```$/,'')['trim'](),_0x52be78=JSON[_0x118c17(0x2cb)](_0x2b6319);if(_0x52be78['decision']===_0x118c17(0xc52)){_0x1a4b35['relationship'][_0x118c17(0x632)]=_0x118c17(0x123a);const _0x1a8728={'role':_0x118c17(0x1377),'senderName':_0x1a4b35[_0x118c17(0xf74)],'content':_0x52be78[_0x118c17(0xb90)],'timestamp':Date['now']()};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x1a8728);}else{_0x1a4b35[_0x118c17(0x1383)][_0x118c17(0x632)]=_0x118c17(0x59f);const _0x19071d={'role':'assistant','senderName':_0x1a4b35[_0x118c17(0xf74)],'content':_0x52be78[_0x118c17(0xb90)],'timestamp':Date[_0x118c17(0xf1a)]()};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x19071d);}_0x1a4b35['relationship'][_0x118c17(0x1240)]='',await _0x1a6951[_0x118c17(0x667)][_0x118c17(0xc0f)](_0x1a4b35),_0x5b89df(_0x2fd04d),_0x413d78();}catch(_0x54f598){_0x1a4b35[_0x118c17(0x1383)][_0x118c17(0x632)]=_0x118c17(0x59f),await _0x1a6951[_0x118c17(0x667)][_0x118c17(0xc0f)](_0x1a4b35),await _0x532f76(_0x118c17(0xef4),_0x118c17(0x6e3)+_0x54f598['message']),_0x5b89df(_0x2fd04d);}return;}let _0x1164ca='';const _0x573974=new Date(),_0x69bfa=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x1a7)]||'Asia/Shanghai',_0x399d48=_0x573974[_0x118c17(0x425)]('zh-CN',{'timeZone':_0x69bfa,'dateStyle':_0x118c17(0x1219),'timeStyle':_0x118c17(0x248)}),_0x2f5fad=new Date(_0x573974[_0x118c17(0x425)](_0x118c17(0x798),{'timeZone':_0x69bfa})),_0xa18beb=_0x10282a(_0x2f5fad);let _0x493b2e,_0x3f7622;const _0x4fc6f6=_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x3d8)](_0x563fad=>_0x563fad[_0x118c17(0x9ae)])[_0x118c17(0x114b)]();if(_0x4fc6f6&&_0x4fc6f6[_0x118c17(0x28c)]['includes'](_0x118c17(0x68d))){const _0x388646=await _0x1a6951[_0x118c17(0x856)]['where'](_0x118c17(0x94d))[_0x118c17(0xb17)](_0x2fd04d)[_0x118c17(0x6a9)]();if(_0x388646&&_0x388646[_0x118c17(0x10fc)]){console[_0x118c17(0x471)](_0x118c17(0x1168));const _0x418356=_0x388646[_0x118c17(0x10fc)][_0x118c17(0x412)](_0x1fb795=>{const _0x48919c=_0x118c17,_0x4dfb55=_0x1fb795[_0x48919c(0xa57)]==='user'?_0x1a4b35[_0x48919c(0xdb9)][_0x48919c(0xc48)]||'我':_0x1fb795[_0x48919c(0xcfc)];return _0x4dfb55+':\x20'+_0x1fb795[_0x48919c(0x28c)];})[_0x118c17(0x1237)]('\x0a');_0x1164ca=_0x118c17(0x6a2)+_0x418356+'\x0a---\x0a';}}const _0x5cdd46=_0x141deb(_0x404de6[_0x2fd04d]);let _0x58c8b4='';if(_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x32d)]&&_0x1a4b35['settings'][_0x118c17(0x32d)][_0x118c17(0x7aa)]>0x0){const _0x45967f=_0x1a4b35['settings'][_0x118c17(0x32d)]['map'](_0x583579=>{const _0x5d185f=_0x118c17,_0x2d79da=_0x5b873d[_0x5d185f(0x8a1)]['find'](_0x4844fb=>_0x4844fb['id']===_0x583579);if(!_0x2d79da||!Array['isArray'](_0x2d79da['content']))return'';const _0x356383=_0x2d79da[_0x5d185f(0x28c)]['filter'](_0x36181b=>_0x36181b[_0x5d185f(0x104e)]!==![])[_0x5d185f(0x412)](_0x264489=>{const _0x13c23b=_0x5d185f;let _0x54e89c=_0x13c23b(0xc77)+(_0x264489[_0x13c23b(0x8f9)]||'无备注')+'\x0a';return _0x264489['keys'][_0x13c23b(0x7aa)]>0x0&&(_0x54e89c+=_0x13c23b(0x1dc)+_0x264489[_0x13c23b(0xe9c)][_0x13c23b(0x1237)](',\x20')+'\x0a'),_0x54e89c+=_0x13c23b(0x280)+_0x264489['content'],_0x54e89c;})[_0x5d185f(0x1237)]('');return _0x356383?_0x5d185f(0xb85)+_0x2d79da[_0x5d185f(0xf74)]+'\x0a'+_0x356383:'';})[_0x118c17(0x3d8)](Boolean)['join']('');_0x45967f&&(_0x58c8b4=_0x118c17(0x312)+_0x45967f+_0x118c17(0xdf6));}let _0x36fede='';if(_0x1f2ed8[_0x118c17(0xfcb)]&&_0x1f2ed8['activeChatId']===_0x2fd04d){const _0x8dd399=_0x1f2ed8[_0x118c17(0x602)]>-0x1?_0x1f2ed8[_0x118c17(0x2c0)][_0x1f2ed8[_0x118c17(0x602)]]:null,_0x29f30e=_0x1f2ed8[_0x118c17(0x2c0)][_0x118c17(0x412)](_0x2ab8f7=>'\x22'+_0x2ab8f7[_0x118c17(0xf74)]+'\x22')[_0x118c17(0x1237)](',\x20');let _0x38f3b1='';if(_0x8dd399&&_0x1f2ed8[_0x118c17(0x10c2)]&&_0x1f2ed8[_0x118c17(0x10c2)][_0x118c17(0x7aa)]>0x0&&_0x1f2ed8[_0x118c17(0x1241)]>-0x1){const _0x56ef12=_0x1f2ed8[_0x118c17(0x10c2)][_0x1f2ed8[_0x118c17(0x1241)]],_0x40b8fb=_0x1f2ed8['parsedLyrics'][_0x118c17(0xdd0)](_0x1f2ed8['currentLyricIndex']+0x1,_0x1f2ed8['currentLyricIndex']+0x3);_0x38f3b1+=_0x118c17(0xece)+_0x56ef12[_0x118c17(0xec9)]+'\x22\x0a',_0x40b8fb[_0x118c17(0x7aa)]>0x0&&(_0x38f3b1+='-\x20**即将演唱**:\x20'+_0x40b8fb[_0x118c17(0x412)](_0x61b76d=>'\x22'+_0x61b76d[_0x118c17(0xec9)]+'\x22')[_0x118c17(0x1237)](_0x118c17(0xa8a))+'\x0a');}_0x36fede='\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20'+(_0x8dd399?'《'+_0x8dd399[_0x118c17(0xf74)]+_0x118c17(0x9a5)+_0x8dd399[_0x118c17(0x1196)]:'无')+_0x118c17(0x218)+_0x29f30e+']\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x38f3b1+_0x118c17(0xca3);}const _0x4e82ad=parseInt(_0x1a4b35[_0x118c17(0xdb9)]['maxMemory'])||0xa,_0x59fa17=_0x1a4b35['history'][_0x118c17(0xdd0)](-_0x4e82ad);let _0x19fccf='';const _0xb23744=_0x1a4b35['history'][_0x118c17(0xceb)](_0x1b469=>_0x1b469[_0x118c17(0xa57)]==='assistant'),_0x1d5cfa=_0x1a4b35[_0x118c17(0x551)][_0x118c17(0xdd0)](_0xb23744+0x1),_0x5a48ea=_0x1d5cfa[_0x118c17(0x12f4)](_0x2002d4=>_0x2002d4[_0x118c17(0x48c)]===_0x118c17(0x1105));if(_0x5a48ea){const _0x594dec=_0x5a48ea['payload'],_0x2dc537=_0x594dec[_0x118c17(0x55e)][_0x118c17(0x412)](_0x9d631a=>{const _0x127598=_0x118c17,_0x55a815=_0x9d631a[_0x127598(0xcfc)]||(_0x9d631a[_0x127598(0xa57)]===_0x127598(0x116c)?_0x1a4b35[_0x127598(0xdb9)][_0x127598(0xc48)]||'我':_0x127598(0xbdc));let _0x21df95='';if(_0x9d631a[_0x127598(0x48c)]===_0x127598(0xff9))_0x21df95=_0x127598(0xc85)+_0x9d631a[_0x127598(0x28c)]+']';else{if(_0x9d631a['type']==='ai_image')_0x21df95=_0x127598(0x104d)+_0x9d631a[_0x127598(0xf6e)]+']';else{if(_0x9d631a[_0x127598(0x48c)]===_0x127598(0x1289))_0x21df95=_0x127598(0x44a);else{if(_0x9d631a[_0x127598(0x48c)]===_0x127598(0x88f))_0x21df95=_0x127598(0x3a5)+_0x9d631a[_0x127598(0x1086)]+']';else _0x21df95=String(_0x9d631a[_0x127598(0x28c)]);}}}return _0x55a815+':\x20'+_0x21df95;})[_0x118c17(0x1237)]('\x0a');_0x19fccf=_0x118c17(0x83f)+_0x594dec[_0x118c17(0x4eb)]+_0x118c17(0x1339)+_0x2dc537+_0x118c17(0x10ed);}let _0x3782ba='';const _0x58aa5b=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x654)]||0xa;if(_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xf0e)]&&_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xf0e)][_0x118c17(0x7aa)]>0x0){const _0x420676=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xf0e)][_0x118c17(0x3d8)](_0x5af15a=>_0x5af15a!==_0x2fd04d);if(_0x420676['length']>0x0){const _0x55f704=_0x420676[_0x118c17(0x412)](_0x40cd79=>{const _0x2504b3=_0x118c17,_0x544395=_0x5b873d[_0x2504b3(0x667)][_0x40cd79];if(!_0x544395)return null;const _0x5a4c3e=_0x544395[_0x2504b3(0x551)][_0x2504b3(0xdd0)](-0x1);return{'chat':_0x544395,'latestTimestamp':_0x5a4c3e?_0x5a4c3e[_0x2504b3(0x114e)]:0x0};})[_0x118c17(0x3d8)](Boolean);_0x55f704[_0x118c17(0x2e3)]((_0x5b52ea,_0x52bb26)=>_0x52bb26['latestTimestamp']-_0x5b52ea['latestTimestamp']),_0x3782ba+='\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a';for(const _0x14ee28 of _0x55f704){const _0x502499=_0x14ee28[_0x118c17(0xde9)],_0x447483=_0x502499[_0x118c17(0x58c)]?'[群聊]':_0x118c17(0x66d),_0x2a3971=_0x14ee28['latestTimestamp']>0x0?'\x20(最后互动于\x20'+_0x4ce38e(_0x14ee28[_0x118c17(0x1365)])+')':'';_0x3782ba+=_0x118c17(0xb88)+_0x447483+'“'+_0x502499[_0x118c17(0xf74)]+'”的参考记忆'+_0x2a3971+_0x118c17(0x11f7);const _0x11b3bf=_0x502499[_0x118c17(0x551)][_0x118c17(0xdd0)](-_0x58aa5b),_0x179fef=_0x11b3bf['filter'](_0xf8c1ed=>!String(_0xf8c1ed[_0x118c17(0x28c)])[_0x118c17(0xced)]('已被用户删除'));_0x179fef['length']>0x0?_0x179fef[_0x118c17(0xd9a)](_0x3d20bb=>{const _0x40b873=_0x118c17,_0x1f4364=_0x3d20bb[_0x40b873(0xa57)]===_0x40b873(0x116c)?_0x502499[_0x40b873(0xdb9)][_0x40b873(0xc48)]||'我':_0x3d20bb[_0x40b873(0xcfc)]||_0x502499[_0x40b873(0xf74)];let _0x198815=String(_0x3d20bb[_0x40b873(0x28c)]);if(_0x3d20bb['type']===_0x40b873(0x656)||_0x3d20bb[_0x40b873(0x48c)]===_0x40b873(0x11f6))_0x198815=_0x40b873(0xa12)+_0x3d20bb[_0x40b873(0x28c)]+']';else _0x3d20bb['type']==='voice_message'&&(_0x198815='[发送了一条语音，内容是：'+_0x3d20bb[_0x40b873(0x28c)]+']');const _0x242fea=_0x4ce38e(_0x3d20bb[_0x40b873(0x114e)]);_0x3782ba+='('+_0x242fea+')\x20'+_0x1f4364+':\x20'+_0x198815+'\x0a';}):_0x3782ba+='(暂无有效聊天记录)\x0a';}}}console[_0x118c17(0x471)]('本次发送给AI的【挂载记忆】内容如下：\x0a',_0x3782ba);if(_0x1a4b35[_0x118c17(0x58c)]){let _0x1c9689='';const _0xe61c90=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x654)]||0xa;if(_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xf0e)]&&_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xf0e)]['length']>0x0){const _0x40d171=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xf0e)]['filter'](_0x1ce205=>_0x1ce205!==_0x2fd04d);if(_0x40d171[_0x118c17(0x7aa)]>0x0){const _0x4c45e6=_0x40d171[_0x118c17(0x412)](_0x5e9f3c=>{const _0x529546=_0x118c17,_0x1ce3e6=_0x5b873d['chats'][_0x5e9f3c];if(!_0x1ce3e6)return null;const _0x2b1ac7=_0x1ce3e6[_0x529546(0x551)][_0x529546(0xdd0)](-0x1);return{'chat':_0x1ce3e6,'latestTimestamp':_0x2b1ac7?_0x2b1ac7[_0x529546(0x114e)]:0x0};})['filter'](Boolean);_0x4c45e6['sort']((_0x5a1876,_0x9b3a31)=>_0x9b3a31['latestTimestamp']-_0x5a1876[_0x118c17(0x1365)]),_0x1c9689+=_0x118c17(0x801);for(const _0xc28904 of _0x4c45e6){const _0x19e981=_0xc28904[_0x118c17(0xde9)],_0x4d9d64=_0x19e981['isGroup']?_0x118c17(0x2ee):_0x118c17(0x66d),_0x427b9e=_0xc28904['latestTimestamp']>0x0?_0x118c17(0x6d1)+_0x4ce38e(_0xc28904[_0x118c17(0x1365)])+')':'';_0x1c9689+='\x0a##\x20---\x20来自'+_0x4d9d64+'“'+_0x19e981[_0x118c17(0xf74)]+_0x118c17(0x3c6)+_0x427b9e+_0x118c17(0x11f7);const _0x3d8b0d=_0x19e981['history'][_0x118c17(0xdd0)](-_0xe61c90),_0x453b93=_0x3d8b0d[_0x118c17(0x3d8)](_0x244a37=>!String(_0x244a37[_0x118c17(0x28c)])[_0x118c17(0xced)](_0x118c17(0x7d3)));_0x453b93[_0x118c17(0x7aa)]>0x0?_0x453b93[_0x118c17(0xd9a)](_0x34adfd=>{const _0x482ce9=_0x118c17,_0xbf3d9a=_0x34adfd[_0x482ce9(0xa57)]==='user'?_0x19e981[_0x482ce9(0xdb9)]['myNickname']||'我':_0x34adfd[_0x482ce9(0xcfc)]||_0x19e981[_0x482ce9(0xf74)];let _0x30ba41=String(_0x34adfd[_0x482ce9(0x28c)]);if(_0x34adfd[_0x482ce9(0x48c)]===_0x482ce9(0x656)||_0x34adfd[_0x482ce9(0x48c)]==='user_photo')_0x30ba41=_0x482ce9(0xa12)+_0x34adfd['content']+']';else _0x34adfd[_0x482ce9(0x48c)]===_0x482ce9(0xff9)&&(_0x30ba41=_0x482ce9(0xf76)+_0x34adfd['content']+']');_0x1c9689+=_0xbf3d9a+':\x20'+_0x30ba41+'\x0a';}):_0x1c9689+=_0x118c17(0xdbb);}}}let _0x3a7b25=_0x118c17(0x6f6),_0x140388=![];_0x1a4b35[_0x118c17(0x5ab)][_0x118c17(0xd9a)](_0x11414b=>{const _0x40ad32=_0x118c17,_0x5cb5ab=_0x5b873d['chats'][_0x11414b['id']];_0x5cb5ab&&_0x5cb5ab[_0x40ad32(0xc18)]&&_0x5cb5ab[_0x40ad32(0xc18)][_0x40ad32(0x7aa)]>0x0&&(_0x3a7b25+=_0x40ad32(0x65c)+_0x11414b['groupNickname']+_0x40ad32(0x469),_0x3a7b25+=_0x5cb5ab[_0x40ad32(0xc18)][_0x40ad32(0x412)](_0x4116c6=>_0x40ad32(0x768)+_0x4ce38e(_0x4116c6[_0x40ad32(0x114e)])+')\x20'+_0x4116c6[_0x40ad32(0x28c)])[_0x40ad32(0x1237)]('\x0a'),_0x140388=!![]);});!_0x140388&&(_0x3a7b25+=_0x118c17(0x12c3));let _0x3925ba='',_0x201763=![];if(_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x298)]){const _0x1cb42c=_0x59fa17[_0x118c17(0xdd0)](-0x1)[0x0];if(_0x1cb42c){const _0x34a68d=_0x231991(_0x1cb42c[_0x118c17(0x114e)]);_0x3925ba=_0x118c17(0xd27)+_0x34a68d+'。';const _0x50d557=(Date[_0x118c17(0xf1a)]()-_0x1cb42c[_0x118c17(0x114e)])/(0x3e8*0x3c*0x3c);if(_0x50d557>0x3){_0x201763=!![];const _0x540285=Math[_0x118c17(0x128a)](_0x50d557/0x18);_0x3925ba+=_0x118c17(0xe63)+(_0x540285>0x0?_0x540285+'天':Math[_0x118c17(0x128a)](_0x50d557)+'小时')+'。';}}else _0x3925ba=_0x118c17(0x114a);}const _0x23a417=await _0x1a6951['shoppingProducts'][_0x118c17(0xc2f)]();let _0x367e02='';_0x23a417[_0x118c17(0x7aa)]>0x0&&(_0x367e02=_0x118c17(0x127c),_0x23a417['forEach'](_0x43fd96=>{const _0xa36bf8=_0x118c17;_0x367e02+=_0xa36bf8(0x539)+_0x43fd96['id']+_0xa36bf8(0x11d0)+_0x43fd96[_0xa36bf8(0xf74)]+_0xa36bf8(0x94c)+_0x43fd96[_0xa36bf8(0x162)][_0xa36bf8(0x8f7)](0x2)+'\x0a';}));let _0x4b2367=_0x1a4b35['members'][_0x118c17(0x412)](_0x58a1a8=>{const _0x5267b1=_0x118c17,_0x5e876c=_0x5b873d['chats'][_0x58a1a8['id']];let _0x4d4043=_0x5267b1(0x12ef);if(_0x5e876c&&_0x5e876c['groupId']){const _0x3413ec=Object[_0x5267b1(0x4b5)](_0x5b873d['chats'])['filter'](_0x1b49bc=>!_0x1b49bc[_0x5267b1(0x58c)]&&_0x1b49bc['id']!==_0x58a1a8['id']&&_0x1b49bc[_0x5267b1(0xb54)]===_0x5e876c[_0x5267b1(0xb54)]);_0x3413ec[_0x5267b1(0x7aa)]>0x0&&(_0x4d4043=_0x5267b1(0x137e)+_0x3413ec[_0x5267b1(0x412)](_0x581ba9=>_0x581ba9[_0x5267b1(0xf74)])[_0x5267b1(0x1237)]('、\x20'));}return _0x5267b1(0x928)+_0x58a1a8[_0x5267b1(0x7da)]+_0x5267b1(0x5f1)+_0x58a1a8['originalName']+'):\x20'+_0x58a1a8[_0x5267b1(0x1170)]+_0x5267b1(0x85f)+_0x4d4043+']';})[_0x118c17(0x1237)]('\x0a');const _0x3f2c45=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xc48)]||'我',_0x1152aa=_0x5b873d[_0x118c17(0x5c1)][_0x118c17(0x22a)]||_0x118c17(0x1285);let _0x4fff93='';const _0x2f0427=(_0x1a4b35[_0x118c17(0x367)]||[])[_0x118c17(0x3d8)](_0x2985b0=>_0x2985b0[_0x118c17(0x199)]);_0x2f0427['length']>0x0&&(_0x4fff93+='\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a',_0x2f0427[_0x118c17(0xd9a)](_0x4c073b=>{const _0x54ded2=_0x118c17,_0x3b482=_0x1a4b35['history'][_0x54ded2(0x12f4)](_0x58f95b=>_0x58f95b[_0x54ded2(0x114e)]===_0x4c073b['messageTimestamp']);if(_0x3b482){let _0x596dbf=String(_0x3b482[_0x54ded2(0x28c)]||'');_0x3b482[_0x54ded2(0x48c)]===_0x54ded2(0x656)&&(_0x596dbf=_0x54ded2(0x1015)+_0x596dbf+']'),_0x4fff93+=_0x54ded2(0x922)+_0x596dbf+_0x54ded2(0x970)+_0x4c073b[_0x54ded2(0x457)]+_0x54ded2(0x1305);}}),_0x4fff93+='---\x0a');const _0x4b37ce=_0x1a4b35['members'][_0x118c17(0x412)](_0xf4dc13=>_0xf4dc13[_0x118c17(0x1045)]),_0x5d4f19=_0x118c17(0x6fe)+_0x4b37ce['join']('、\x20')+']';let _0x4acd9b=_0x118c17(0x7a6);_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x1e2)]&&_0x1a4b35['settings']['groupAvatarLibrary'][_0x118c17(0x7aa)]>0x0?_0x4acd9b+=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x1e2)][_0x118c17(0x412)](_0x300f87=>'-\x20'+_0x300f87['name'])[_0x118c17(0x1237)]('\x0a'):_0x4acd9b+=_0x118c17(0x7db);const _0x165d9a=_0x3c8588(_0x2fd04d),_0x4f357b=_0x247dd3(_0x1a4b35,0x3,'hours'),_0x491f90=_0x247dd3(_0x1a4b35,0x6,'hours'),_0x4fa268=_0x247dd3(_0x1a4b35,0x9,_0x118c17(0x5be)),_0x2e86aa=_0x247dd3(_0x1a4b35,0x1,_0x118c17(0xccc)),_0x5714ce=_0x247dd3(_0x1a4b35,0x3,_0x118c17(0xccc)),_0x37a97e=_0x247dd3(_0x1a4b35,0x7,_0x118c17(0xccc));let _0x30fe61='';if(_0x4f357b||_0x491f90||_0x4fa268||_0x2e86aa||_0x5714ce||_0x37a97e){_0x30fe61+=_0x118c17(0x9e7);if(_0x4f357b)_0x30fe61+=_0x4f357b;if(_0x491f90)_0x30fe61+=_0x491f90;if(_0x4fa268)_0x30fe61+=_0x4fa268;if(_0x4f357b||_0x491f90||_0x4fa268)_0x30fe61+='\x0a';if(_0x2e86aa)_0x30fe61+=_0x2e86aa;if(_0x5714ce)_0x30fe61+=_0x5714ce;if(_0x37a97e)_0x30fe61+=_0x37a97e;}const _0xc063c6=_0x4f684e(_0x1a4b35);_0x493b2e=_0x118c17(0xc68)+_0x3f2c45+_0x118c17(0x120e)+_0x1152aa+_0x118c17(0x8e5)+_0x3f2c45+'\x22\x20(用户)\x20或\x20\x22'+_0x1a4b35[_0x118c17(0xf74)]+_0x118c17(0x229)+(_0x1a4b35['settings'][_0x118c17(0x298)]?_0x118c17(0x10d9)+_0x399d48+_0x118c17(0x378)+(_0x201763?_0x118c17(0xd73)+_0x3925ba+'\x20你应该让角色们主动开启新话题来打破沉默。':''):'')+_0x118c17(0xf5a)+(_0x165d9a?_0x118c17(0x64d)+_0x165d9a:_0x118c17(0xce5))+_0x118c17(0x781)+_0x1a4b35['name']+'\x0a'+(_0x1a4b35[_0x118c17(0xdb9)]['enableTimePerception']?_0x118c17(0xc04)+_0x3925ba:'')+'\x0a\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a'+_0x4b2367+_0x118c17(0xb38)+_0x3f2c45+'**:\x20'+_0x1a4b35['settings'][_0x118c17(0x6d4)]+_0x118c17(0x468)+_0x58c8b4+'\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a'+_0x3a7b25+'\x0a'+(_0x1a4b35[_0x118c17(0xc18)]&&_0x1a4b35[_0x118c17(0xc18)][_0x118c17(0x7aa)]>0x0?_0x1a4b35[_0x118c17(0xc18)][_0x118c17(0x412)](_0xe9114c=>'-\x20'+_0xe9114c[_0x118c17(0x28c)])['join']('\x0a'):_0x118c17(0x12c3))+'\x0a'+_0x30fe61+'\x0a'+_0x1c9689+'\x0a'+_0x36fede+'\x0a'+_0x19fccf+'\x0a'+_0x4acd9b+_0x118c17(0x1c1)+_0xc063c6+'\x0a'+_0x5d4f19+'\x0a'+_0x1164ca+'\x0a#\x20可用指令列表\x20(按需组合使用)\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a'+(localStorage[_0x118c17(0x1344)](_0x118c17(0xd8f))===_0x118c17(0xc8b)?_0x118c17(0x137b):'')+_0x118c17(0x995),_0x3f7622=_0x59fa17[_0x118c17(0x412)](_0x396ef2=>{const _0xde7c29=_0x118c17,_0x205651=_0x396ef2['role']==='user'?_0x3f2c45:_0x396ef2['senderName'];let _0x168729=''+_0x205651;if(_0x396ef2[_0xde7c29(0x1ff)]){const _0x111813=String(_0x396ef2[_0xde7c29(0x1ff)][_0xde7c29(0x28c)]||'')['substring'](0x0,0x32);_0x168729+=_0xde7c29(0x1084)+_0x396ef2[_0xde7c29(0x1ff)]['senderName']+'\x20的消息:\x20\x22'+_0x111813+_0xde7c29(0xe14);}_0x168729+=':\x20';let _0x5a220b;if(_0x396ef2['type']==='user_photo')_0x5a220b='['+_0x205651+'\x20发送了一张图片，内容是：\x27'+_0x396ef2[_0xde7c29(0x28c)]+'\x27]';else{if(_0x396ef2['type']==='ai_image')_0x5a220b='['+_0x205651+_0xde7c29(0xc37)+_0x396ef2[_0xde7c29(0x28c)]+'\x27]';else{if(_0x396ef2[_0xde7c29(0x48c)]===_0xde7c29(0x1289))_0x5a220b='['+_0x205651+'\x20分享了一张RealImag真实图片]';else{if(_0x396ef2['type']==='naiimag')_0x5a220b='['+_0x205651+_0xde7c29(0x1370)+_0x396ef2[_0xde7c29(0x1086)]+']';else{if(_0x396ef2['type']===_0xde7c29(0xff9))_0x5a220b='['+_0x205651+_0xde7c29(0xcfd)+_0x396ef2['content']+'\x27]';else{if(_0x396ef2['type']===_0xde7c29(0x1075))_0x5a220b='['+_0x396ef2[_0xde7c29(0xcfc)]+'\x20向\x20'+_0x396ef2['receiverName']+_0xde7c29(0x390)+_0x396ef2[_0xde7c29(0x10a6)]+_0xde7c29(0xc75)+_0x396ef2['note']+']';else{if(_0x396ef2[_0xde7c29(0x48c)]==='location_share')_0x5a220b='['+_0x205651+_0xde7c29(0xb5f)+_0x396ef2[_0xde7c29(0x28c)]+'\x27]';else{if(_0x396ef2[_0xde7c29(0x48c)]===_0xde7c29(0xb95)){const _0x573311=_0x396ef2[_0xde7c29(0x629)]?_0xde7c29(0x52d)+_0x396ef2[_0xde7c29(0x629)]+'”':'';let _0x2361af='原作者';const _0x41f2ff=_0x396ef2[_0xde7c29(0x1c9)]['authorId'];if(_0x41f2ff===_0xde7c29(0x116c))_0x2361af=_0x5b873d[_0xde7c29(0x5c1)][_0xde7c29(0x22a)];else _0x5b873d['chats'][_0x41f2ff]&&(_0x2361af=_0x5b873d[_0xde7c29(0x667)][_0x41f2ff][_0xde7c29(0xf74)]);let _0x209684;const _0x3e0023=_0x396ef2[_0xde7c29(0x1c9)];if(_0x3e0023[_0xde7c29(0x48c)]==='text_image')_0x209684=_0xde7c29(0xc15)+(_0x3e0023[_0xde7c29(0x957)]||'')+_0xde7c29(0xa72)+(_0x3e0023['hiddenContent']||'')['substring'](0x0,0x28)+_0xde7c29(0x1258);else _0x3e0023[_0xde7c29(0x48c)]==='image_post'?_0x209684='[图片]\x20'+(_0x3e0023[_0xde7c29(0x957)]||'')+_0xde7c29(0xa72)+(_0x3e0023['imageDescription']||'')[_0xde7c29(0x489)](0x0,0x28)+'...”)':_0x209684='“'+(_0x3e0023['content']||'')[_0xde7c29(0x489)](0x0,0x28)+_0xde7c29(0x7ac);_0x5a220b='['+_0x205651+_0xde7c29(0xd5e)+_0x2361af+'\x20的动态\x20'+_0x573311+'【原动态内容:\x20'+_0x209684+'】]';}else{if(_0x396ef2[_0xde7c29(0x48c)]===_0xde7c29(0xcd9))_0x396ef2['status']===_0xde7c29(0x1385)?_0x5a220b='[系统提示：'+_0x396ef2[_0xde7c29(0x765)]+'\x20为\x20'+_0x205651+_0xde7c29(0x1253)+_0x396ef2[_0xde7c29(0x10a6)]+_0xde7c29(0xd53):_0x5a220b='['+_0x205651+'\x20发起了外卖代付请求，商品是“'+_0x396ef2['productInfo']+_0xde7c29(0x821)+_0x396ef2['amount']+'\x20元，订单时间戳为\x20'+_0x396ef2[_0xde7c29(0x114e)]+']';else{if(_0x396ef2[_0xde7c29(0x48c)]===_0xde7c29(0x675)){const _0x1f740f=_0x396ef2[_0xde7c29(0xcfc)]===_0x3f2c45?_0xde7c29(0x43a)+_0x3f2c45+')':_0x396ef2[_0xde7c29(0xcfc)];let _0x4bfc92;_0x396ef2[_0xde7c29(0x2d1)]===_0xde7c29(0xfc5)?_0x4bfc92=_0xde7c29(0x807)+_0x1f740f+_0xde7c29(0x120f)+_0x396ef2['timestamp']+_0xde7c29(0x1123)+_0x396ef2[_0xde7c29(0xb12)]+_0xde7c29(0xc33)+_0x396ef2[_0xde7c29(0xb12)]+_0xde7c29(0x5f7):_0x4bfc92='[系统提示：'+_0x1f740f+_0xde7c29(0x1e3)+_0x396ef2['timestamp']+_0xde7c29(0xaec)+_0x396ef2[_0xde7c29(0x108d)]+_0xde7c29(0xfe5),_0x5a220b=_0x4bfc92;}else{if(_0x396ef2[_0xde7c29(0x48c)]==='gift'){const _0x3f2e18=_0x396ef2[_0xde7c29(0xa57)]==='user'?_0x3f2c45:_0xb9963e(_0x1a4b35,_0x396ef2[_0xde7c29(0xcfc)]),_0x10d4ae=_0x396ef2[_0xde7c29(0xcd7)][_0xde7c29(0x412)](_0x80f3e=>_0x80f3e[_0xde7c29(0xf74)]+'\x20x'+_0x80f3e[_0xde7c29(0x66c)])[_0xde7c29(0x1237)]('、\x20');let _0x12e64f='';if(_0x396ef2[_0xde7c29(0x7c7)]&&_0x396ef2[_0xde7c29(0x7c7)][_0xde7c29(0x7aa)]>0x0){const _0x153ecc=_0x396ef2['recipients'][_0xde7c29(0x412)](_0x283049=>_0xb9963e(_0x1a4b35,_0x283049))[_0xde7c29(0x1237)]('、\x20');_0x12e64f=_0xde7c29(0x42a)+_0x153ecc;}else _0x12e64f='送给了大家一份礼物';return _0x5a220b='[系统提示：'+_0x3f2e18+'\x20'+_0x12e64f+_0xde7c29(0x1186)+_0x10d4ae+']',{'role':_0xde7c29(0x116c),'content':_0x5a220b};}else{if(_0x396ef2['type']===_0xde7c29(0xa9c)){const _0x385a2e=Object['values'](_0x396ef2[_0xde7c29(0x10d1)]||{})[_0xde7c29(0x5ff)]()[_0xde7c29(0x1237)](',\x20')||_0xde7c29(0x914);_0x5a220b=_0xde7c29(0x807)+_0x396ef2['senderName']+'\x20发起了一个投票\x20(时间戳:\x20'+_0x396ef2[_0xde7c29(0x114e)]+_0xde7c29(0x3c9)+_0x396ef2[_0xde7c29(0xba1)]+'”，选项有：['+_0x396ef2[_0xde7c29(0x1034)][_0xde7c29(0x1237)](',\x20')+']。目前投票的人有：'+_0x385a2e+_0xde7c29(0x918);}else{if(_0x396ef2['meaning'])_0x5a220b=_0x205651+_0xde7c29(0x197)+_0x396ef2[_0xde7c29(0xb5c)]+'\x27]';else{if(Array[_0xde7c29(0xbd6)](_0x396ef2[_0xde7c29(0x28c)]))return{'role':_0xde7c29(0x116c),'content':[..._0x396ef2[_0xde7c29(0x28c)],{'type':_0xde7c29(0xec9),'text':_0x168729}]};else _0x5a220b=''+_0x168729+_0x396ef2['content'];}}}}}}}}}}}}}return{'role':_0xde7c29(0x116c),'content':_0x5a220b};})[_0x118c17(0x3d8)](Boolean);}else{const _0x4a5473=_0x1a4b35[_0x118c17(0xdb9)]['isOfflineMode'],_0x4a5e62=_0x5ae1ee(_0x1a4b35);let _0x3ee0b8='';_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x983)]&&_0x1a4b35['heartfeltVoice']&&!_0x4a5473&&(_0x3ee0b8=_0x118c17(0xfe7)+_0x1a4b35[_0x118c17(0x253)]+_0x118c17(0x2ad)+_0x1a4b35[_0x118c17(0x27e)]+'\x0a');let _0x102011='';const _0x560e0d=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x654)]||0xa;if(_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xf0e)]&&_0x1a4b35[_0x118c17(0xdb9)]['linkedMemoryChatIds'][_0x118c17(0x7aa)]>0x0){const _0xb5124d=_0x1a4b35['settings'][_0x118c17(0xf0e)]['filter'](_0x2d4493=>_0x2d4493!==_0x2fd04d);if(_0xb5124d[_0x118c17(0x7aa)]>0x0){const _0x292844=_0xb5124d[_0x118c17(0x412)](_0x561227=>{const _0x13a677=_0x118c17,_0x4a1f0b=_0x5b873d[_0x13a677(0x667)][_0x561227];if(!_0x4a1f0b)return null;const _0x37b1ed=_0x4a1f0b[_0x13a677(0x551)][_0x13a677(0xdd0)](-0x1)[0x0];return{'chat':_0x4a1f0b,'latestTimestamp':_0x37b1ed?_0x37b1ed[_0x13a677(0x114e)]:0x0};})[_0x118c17(0x3d8)](Boolean);_0x292844[_0x118c17(0x2e3)]((_0x51f810,_0x581c34)=>_0x581c34[_0x118c17(0x1365)]-_0x51f810[_0x118c17(0x1365)]),_0x102011+='\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a';for(const _0x5f061b of _0x292844){const _0xfbdad2=_0x5f061b[_0x118c17(0xde9)],_0xfe45be=_0xfbdad2[_0x118c17(0x58c)]?_0x118c17(0x2ee):_0x118c17(0x66d),_0x27f39c=_0x5f061b[_0x118c17(0x1365)]>0x0?_0x118c17(0x6d1)+_0x4ce38e(_0x5f061b[_0x118c17(0x1365)])+')':'';_0x102011+=_0x118c17(0xb88)+_0xfe45be+'“'+_0xfbdad2[_0x118c17(0xf74)]+_0x118c17(0x3c6)+_0x27f39c+'\x20---\x0a';const _0x27708a=_0xfbdad2[_0x118c17(0x551)]['slice'](-_0x560e0d),_0x22890d=_0x27708a[_0x118c17(0x3d8)](_0x308f35=>!String(_0x308f35['content'])[_0x118c17(0xced)](_0x118c17(0x7d3)));_0x22890d[_0x118c17(0x7aa)]>0x0?_0x22890d[_0x118c17(0xd9a)](_0x11c328=>{const _0x382228=_0x118c17,_0x5ef41f=_0x11c328['role']==='user'?_0xfbdad2[_0x382228(0xdb9)][_0x382228(0xc48)]||'我':_0x11c328[_0x382228(0xcfc)]||_0xfbdad2[_0x382228(0xf74)];let _0x1f959c=String(_0x11c328[_0x382228(0x28c)]);if(_0x11c328['type']===_0x382228(0x656)||_0x11c328[_0x382228(0x48c)]===_0x382228(0x11f6))_0x1f959c=_0x382228(0xa12)+_0x11c328[_0x382228(0x28c)]+']';else _0x11c328['type']===_0x382228(0xff9)&&(_0x1f959c=_0x382228(0xf76)+_0x11c328[_0x382228(0x28c)]+']');const _0x5beebc=_0x4ce38e(_0x11c328[_0x382228(0x114e)]);_0x102011+='('+_0x5beebc+')\x20'+_0x5ef41f+':\x20'+_0x1f959c+'\x0a';}):_0x102011+='(暂无有效聊天记录)\x0a';}}}const _0x201d08=await _0x1a6951[_0x118c17(0xa6d)][_0x118c17(0xc2f)]();let _0x308962='';_0x201d08['length']>0x0&&(_0x308962='\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a',_0x201d08[_0x118c17(0xd9a)](_0x1e1275=>{const _0x93accf=_0x118c17;_0x308962+=_0x93accf(0x539)+_0x1e1275['id']+_0x93accf(0x11d0)+_0x1e1275[_0x93accf(0xf74)]+_0x93accf(0x94c)+_0x1e1275[_0x93accf(0x162)][_0x93accf(0x8f7)](0x2)+'\x0a';}));if(_0x4a5473){const _0x27f890=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x87d)]||0x64,_0x2638a9=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xcb5)]||0x12c,_0x1217de=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xc48)]||'我';let _0x427128='';if(_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x404)]){const _0xe6443d=_0x5b873d[_0x118c17(0x4da)][_0x118c17(0x12f4)](_0x4529b3=>_0x4529b3['id']===_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x404)]);if(_0xe6443d&&Array[_0x118c17(0xbd6)](_0xe6443d['content'])){const _0x4997df=_0xe6443d[_0x118c17(0x28c)]['filter'](_0x22ee2e=>_0x22ee2e[_0x118c17(0x104e)]!==![])[_0x118c17(0x412)](_0x2a3ca3=>'-\x20'+_0x2a3ca3[_0x118c17(0x28c)])[_0x118c17(0x1237)]('\x0a');_0x4997df&&(_0x427128=_0x118c17(0x113c)+_0x4997df+_0x118c17(0x100b));}}_0x493b2e='\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22'+_0x1a4b35['originalName']+_0x118c17(0x101b)+_0x427128+'\x0a#\x20你的角色设定：\x0a你必须严格遵守'+_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x1269)]+'\x0a\x0a#\x20对话者的角色设定\x0a'+_0x1a4b35[_0x118c17(0xdb9)]['myPersona']+'\x0a\x0a#\x20供你参考的信息\x0a'+(_0x1a4b35[_0x118c17(0xdb9)]['enableTimePerception']?_0x118c17(0x6bb)+_0x399d48+'\x20('+_0xa18beb+')':'')+_0x118c17(0x429)+_0x58c8b4+_0x118c17(0x117d)+(_0x1a4b35['longTermMemory']&&_0x1a4b35[_0x118c17(0xc18)][_0x118c17(0x7aa)]>0x0?_0x1a4b35[_0x118c17(0xc18)][_0x118c17(0x412)](_0x5e2db6=>'-\x20'+_0x5e2db6['content'])[_0x118c17(0x1237)]('\x0a'):_0x118c17(0x12c3))+'\x0a\x0a'+_0x102011+_0x118c17(0x1189)+_0x59fa17[_0x118c17(0x412)](_0x45436c=>{const _0x4931bf=_0x118c17;let _0x11167c=(_0x45436c['role']===_0x4931bf(0x116c)?_0x1217de:_0x1a4b35[_0x4931bf(0xf74)])+':\x20';return _0x45436c[_0x4931bf(0x48c)]===_0x4931bf(0x910)?_0x11167c+='「'+(_0x45436c['dialogue']||'')+'」\x20'+(_0x45436c[_0x4931bf(0xf6e)]||''):_0x11167c+=String(_0x45436c[_0x4931bf(0x28c)]),_0x11167c;})['join']('\x0a')+'\x0a\x0a\x0a\x20#\x20【格式铁律\x20(最高优先级)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，格式如下:\x0a\x20\x20\x20\x20`[{\x22type\x22:\x20\x22offline_text\x22,\x20\x22content\x22:\x20\x22在这里写入你创作的、混合了对话和描写的完整段落。\x22}]`\x0a2.\x20\x20**【内容风格】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由地将对话穿插在描写的任何位置，实现自然分段。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a3.\x20\x20**【禁止】**:\x20绝对禁止在\x20`content`\x20字段中出现\x20\x22dialogue\x22\x20或\x20\x22description\x22\x20这两个词。\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**'+_0x27f890+'到'+_0x2638a9+_0x118c17(0x72d),_0x3f7622=_0x59fa17['map'](_0x25c3dd=>{const _0x1842d3=_0x118c17;if(_0x25c3dd[_0x1842d3(0x9ae)])return null;if(_0x25c3dd[_0x1842d3(0x48c)]===_0x1842d3(0x910)){const _0x245ee6=_0x25c3dd[_0x1842d3(0xa57)]==='user'?_0x1a4b35['settings'][_0x1842d3(0xc48)]||'我':_0x1a4b35[_0x1842d3(0xf74)];let _0x698d53='';if(_0x25c3dd[_0x1842d3(0x28c)])_0x698d53=_0x25c3dd['content'];else{const _0x45d24b=_0x25c3dd[_0x1842d3(0xa03)]?'「'+_0x25c3dd['dialogue']+'」':'',_0x151861=_0x25c3dd[_0x1842d3(0xf6e)]?'('+_0x25c3dd['description']+')':'';_0x698d53=(_0x45d24b+'\x20'+_0x151861)[_0x1842d3(0xc3a)]();}return{'role':_0x25c3dd['role'],'content':_0x245ee6+':\x20'+_0x698d53};}if(_0x25c3dd[_0x1842d3(0xa57)]==='user'){const _0x43c795=_0x1217de+':\x20';let _0x458e29='';if(Array['isArray'](_0x25c3dd[_0x1842d3(0x28c)])&&_0x25c3dd[_0x1842d3(0x28c)][0x0]?.[_0x1842d3(0x48c)]==='image_url')return{'role':_0x1842d3(0x116c),'content':[{'type':_0x1842d3(0xec9),'text':_0x43c795},..._0x25c3dd[_0x1842d3(0x28c)]]};if(_0x25c3dd[_0x1842d3(0x1ff)]){const _0x385485=String(_0x25c3dd['quote'][_0x1842d3(0x28c)]||'')[_0x1842d3(0x489)](0x0,0x32);_0x458e29+='(回复\x20'+_0x25c3dd['quote']['senderName']+_0x1842d3(0x304)+_0x385485+_0x1842d3(0xd58)+_0x25c3dd[_0x1842d3(0x28c)];}else _0x458e29+=_0x25c3dd['content'];if(_0x25c3dd[_0x1842d3(0x48c)]===_0x1842d3(0x11f6))return{'role':'user','content':_0x43c795+_0x1842d3(0x12d9)+_0x25c3dd[_0x1842d3(0x28c)]+'\x27]'};if(_0x25c3dd['type']===_0x1842d3(0xff9))return{'role':_0x1842d3(0x116c),'content':_0x43c795+'[你发送了一条语音消息，内容是：\x27'+_0x25c3dd[_0x1842d3(0x28c)]+'\x27]'};if(_0x25c3dd[_0x1842d3(0x48c)]===_0x1842d3(0x1075))return{'role':_0x1842d3(0x116c),'content':_0x43c795+'[系统提示：你于时间戳\x20'+_0x25c3dd[_0x1842d3(0x114e)]+_0x1842d3(0xba0)+_0x25c3dd[_0x1842d3(0x10a6)]+'元,\x20备注:\x20'+_0x25c3dd[_0x1842d3(0xa17)]+_0x1842d3(0x1fa)};if(_0x25c3dd[_0x1842d3(0x48c)]===_0x1842d3(0xcd9))return{'role':_0x1842d3(0x116c),'content':_0x43c795+_0x1842d3(0x963)+_0x25c3dd['timestamp']+'\x20发起了外卖代付请求，商品是“'+_0x25c3dd[_0x1842d3(0xb3e)]+'”，金额是\x20'+_0x25c3dd[_0x1842d3(0x10a6)]+_0x1842d3(0xcda)};else{if(_0x25c3dd[_0x1842d3(0x48c)]===_0x1842d3(0xf80)){const _0x2783bf=_0x25c3dd[_0x1842d3(0xcd7)][_0x1842d3(0x412)](_0x31f32d=>_0x31f32d[_0x1842d3(0xf74)]+'\x20x'+_0x31f32d[_0x1842d3(0x66c)])[_0x1842d3(0x1237)]('、\x20');let _0x256827=_0x1a4b35['isGroup']?_0x1842d3(0x42a)+_0x25c3dd[_0x1842d3(0x7c7)][_0x1842d3(0x412)](_0x5865c5=>_0xb9963e(_0x1a4b35,_0x5865c5))['join']('、\x20'):'送给了\x20'+_0x1a4b35['name'];return{'role':_0x1842d3(0x116c),'content':_0x43c795+_0x1842d3(0x87a)+_0x256827+_0x1842d3(0x1186)+_0x2783bf+']'};}}if(_0x25c3dd[_0x1842d3(0xb5c)])return{'role':_0x1842d3(0x116c),'content':_0x43c795+_0x1842d3(0x3fa)+_0x25c3dd[_0x1842d3(0xb5c)]+'\x27]'};return{'role':_0x25c3dd['role'],'content':_0x43c795+_0x458e29};}else{if(_0x25c3dd[_0x1842d3(0xa57)]===_0x1842d3(0x1377)){let _0x1ce7c7={'type':_0x25c3dd[_0x1842d3(0x48c)]||_0x1842d3(0xec9)};if(_0x25c3dd['type']===_0x1842d3(0x3c8))_0x1ce7c7[_0x1842d3(0x11de)]=_0x25c3dd[_0x1842d3(0x28c)],_0x1ce7c7[_0x1842d3(0xb5c)]=_0x25c3dd['meaning'];else{if(_0x25c3dd[_0x1842d3(0x48c)]===_0x1842d3(0x1075))_0x1ce7c7['amount']=_0x25c3dd['amount'],_0x1ce7c7[_0x1842d3(0xa17)]=_0x25c3dd[_0x1842d3(0xa17)];else _0x25c3dd[_0x1842d3(0x48c)]===_0x1842d3(0xcd9)?(_0x1ce7c7[_0x1842d3(0xb3e)]=_0x25c3dd[_0x1842d3(0xb3e)],_0x1ce7c7[_0x1842d3(0x10a6)]=_0x25c3dd['amount']):_0x25c3dd[_0x1842d3(0x1ff)]?_0x1ce7c7['quote_reply']={'target_sender':_0x25c3dd[_0x1842d3(0x1ff)][_0x1842d3(0xcfc)],'target_content':_0x25c3dd['quote'][_0x1842d3(0x28c)],'reply_content':_0x25c3dd[_0x1842d3(0x28c)]}:_0x1ce7c7[_0x1842d3(0x28c)]=_0x25c3dd[_0x1842d3(0x28c)];}const _0x555837=JSON[_0x1842d3(0x465)]([_0x1ce7c7]);return{'role':'assistant','content':_0x1842d3(0x570)+_0x25c3dd[_0x1842d3(0x114e)]+')\x20'+_0x555837};}}return null;})[_0x118c17(0x3d8)](Boolean);}else{let _0xd7c861='';_0x1a4b35[_0x118c17(0xfe2)]&&_0x1a4b35[_0x118c17(0xfe2)][_0x118c17(0x7aa)]>0x0&&(_0xd7c861=_0x118c17(0x1235)+_0x1a4b35[_0x118c17(0xfe2)]['join'](',\x20')+_0x118c17(0xbae));let _0x4d7406='';const _0x1c9d5d=_0x5b873d[_0x118c17(0x5c1)][_0x118c17(0x22a)]||'用户';_0x4d7406+=_0x118c17(0x109d)+_0x1c9d5d+'\x22。\x0a';const _0x382ff1=Object[_0x118c17(0x4b5)](_0x5b873d[_0x118c17(0x667)]),_0x22cc48=_0x382ff1[_0x118c17(0x3d8)](_0x10f615=>_0x10f615[_0x118c17(0x58c)]&&_0x10f615[_0x118c17(0x5ab)][_0x118c17(0xc5c)](_0x344b4c=>_0x344b4c['id']===_0x1a4b35['id']));_0x22cc48['length']>0x0&&(_0x4d7406+=_0x118c17(0xfec),_0x22cc48['forEach'](_0xaa86ec=>{const _0x27c972=_0x118c17,_0x57d177=_0xaa86ec[_0x27c972(0xdb9)][_0x27c972(0xc48)]||_0x1c9d5d;_0x4d7406+=_0x27c972(0x6bd)+_0xaa86ec[_0x27c972(0xf74)]+_0x27c972(0x86b)+_0x57d177+'”。\x0a';}));_0x4d7406+=_0x118c17(0xee1);let _0x32172d='';const _0x40de35=_0x382ff1[_0x118c17(0x3d8)](_0x32417e=>!_0x32417e[_0x118c17(0x58c)]&&_0x32417e['id']!==_0x1a4b35['id']&&_0x32417e[_0x118c17(0xb54)]===_0x1a4b35[_0x118c17(0xb54)]&&_0x1a4b35[_0x118c17(0xb54)]!==null);_0x40de35[_0x118c17(0x7aa)]>0x0&&(_0x32172d+=_0x118c17(0x12cf),_0x40de35[_0x118c17(0xd9a)](_0x53d8b5=>{const _0x3c8bda=_0x118c17;_0x32172d+=_0x3c8bda(0x6f7)+_0x53d8b5[_0x3c8bda(0xf74)]+_0x3c8bda(0x5f1)+_0x53d8b5[_0x3c8bda(0x1045)]+')\x0a';}));const _0x1a9f00=await _0x1a6951[_0x118c17(0xea0)][_0x118c17(0x6ed)](_0x118c17(0x114e))['reverse']()[_0x118c17(0x1204)](0xa)[_0x118c17(0xc2f)](),_0x26a77a=_0x4a3d6c(_0x1a9f00,_0x1a4b35);let _0x4d6ce7='';if(_0x26a77a[_0x118c17(0x7aa)]>0x0){_0x4d6ce7=_0x118c17(0xa2f);const _0x5cbe51=_0x1a4b35['originalName'];for(const _0x550e56 of _0x26a77a){let _0x3c18be;if(_0x550e56['authorId']==='user')_0x3c18be=_0x5b873d[_0x118c17(0x5c1)]['nickname'];else{if(String(_0x550e56[_0x118c17(0xc3f)])[_0x118c17(0x1222)](_0x118c17(0x5b8)))_0x3c18be=_0x550e56[_0x118c17(0xf56)]||_0x118c17(0x249);else{const _0x102493=_0x5b873d[_0x118c17(0x667)][_0x550e56[_0x118c17(0xc3f)]];_0x3c18be=_0x102493?_0x102493['name']:_0x118c17(0xf8d);}}if(_0x550e56['authorId']===_0x2fd04d)_0x3c18be+=_0x118c17(0x550);let _0x1fb51d;if(_0x550e56[_0x118c17(0x48c)]===_0x118c17(0xb95)){const _0x2f027c=_0x550e56[_0x118c17(0x629)]?_0x118c17(0xc54)+_0x550e56['repostComment']+'\x22':'';let _0x4154ca='原作者';const _0x30bdce=_0x550e56[_0x118c17(0x1c9)]['authorId'];if(_0x30bdce===_0x118c17(0x116c))_0x4154ca=_0x5b873d['qzoneSettings'][_0x118c17(0x22a)];else _0x5b873d[_0x118c17(0x667)][_0x30bdce]&&(_0x4154ca=_0x5b873d[_0x118c17(0x667)][_0x30bdce][_0x118c17(0xf74)]);let _0x33ffb1;const _0x1111fd=_0x550e56['originalPost'];if(_0x1111fd[_0x118c17(0x48c)]===_0x118c17(0x574))_0x33ffb1=_0x118c17(0xc15)+(_0x1111fd[_0x118c17(0x957)]||'')+_0x118c17(0x190)+(_0x1111fd['hiddenContent']||'')[_0x118c17(0x489)](0x0,0x28)+_0x118c17(0xe14);else _0x1111fd[_0x118c17(0x48c)]===_0x118c17(0xe70)?_0x33ffb1=_0x118c17(0x613)+(_0x1111fd[_0x118c17(0x957)]||'')+_0x118c17(0x190)+(_0x1111fd[_0x118c17(0x12ce)]||'')['substring'](0x0,0x28)+_0x118c17(0xe14):_0x33ffb1='\x22'+(_0x1111fd['content']||'')[_0x118c17(0x489)](0x0,0x28)+_0x118c17(0x10a8);_0x1fb51d=_0x118c17(0xded)+_0x4154ca+'\x20的动态\x20'+_0x2f027c+_0x118c17(0xa75)+_0x33ffb1+'】';}else{if(_0x550e56[_0x118c17(0x48c)]===_0x118c17(0x574))_0x1fb51d=('[一张图片，其隐藏文字为：\x22'+_0x550e56['hiddenContent']+_0x118c17(0xf71)+(_0x550e56[_0x118c17(0x957)]||''))['substring'](0x0,0x32)+_0x118c17(0x1046);else{if(_0x550e56[_0x118c17(0x48c)]===_0x118c17(0xe70))_0x1fb51d=(_0x118c17(0x22e)+_0x550e56[_0x118c17(0x12ce)]+_0x118c17(0xf71)+(_0x550e56[_0x118c17(0x957)]||''))[_0x118c17(0x489)](0x0,0x32)+_0x118c17(0x1046);else{if(_0x550e56['type']===_0x118c17(0x1289)&&_0x550e56['prompt']){const _0x5b5524=Array[_0x118c17(0xbd6)](_0x550e56['prompt'])?_0x550e56['prompt']:[_0x550e56[_0x118c17(0x1086)]];_0x1fb51d=(_0x550e56[_0x118c17(0x957)]||'')+(_0x118c17(0x362)+_0x5b5524['length']+_0x118c17(0xe65)+_0x5b5524[_0x118c17(0x1237)](',\x20')+']');}else{if(_0x550e56[_0x118c17(0x48c)]===_0x118c17(0x88f)&&_0x550e56['prompt']){const _0x4e1f7d=Array[_0x118c17(0xbd6)](_0x550e56[_0x118c17(0x1086)])?_0x550e56[_0x118c17(0x1086)]:[_0x550e56[_0x118c17(0x1086)]];_0x1fb51d=(_0x550e56[_0x118c17(0x957)]||'')+(_0x118c17(0x362)+_0x4e1f7d[_0x118c17(0x7aa)]+_0x118c17(0xfde)+_0x4e1f7d[_0x118c17(0x1237)](',\x20')+']');}else _0x1fb51d=String(_0x550e56[_0x118c17(0x957)]||_0x550e56['content']||_0x118c17(0x8b3))['substring'](0x0,0x32)+'...';}}}}_0x4d6ce7+=_0x118c17(0x539)+_0x550e56['id']+_0x118c17(0x69d)+_0x3c18be+_0x118c17(0x615)+_0x1fb51d+'\x22\x0a';if(_0x550e56['comments']&&_0x550e56['comments'][_0x118c17(0x7aa)]>0x0)for(const _0x21fd8f of _0x550e56[_0x118c17(0x1157)]){if(typeof _0x21fd8f===_0x118c17(0x7af)&&_0x21fd8f[_0x118c17(0xf20)]){const _0x51ea1d=_0x471a37(_0x21fd8f[_0x118c17(0xf20)]);let _0x1ee507=_0x21fd8f[_0x118c17(0xb5c)]?'[表情:\x20\x27'+_0x21fd8f[_0x118c17(0xb5c)]+'\x27]':_0x21fd8f[_0x118c17(0xec9)];_0x21fd8f[_0x118c17(0xf20)]===_0x5cbe51?_0x4d6ce7+=_0x118c17(0x136c)+_0x1ee507+'\x0a':_0x4d6ce7+='\x20\x20-\x20评论:\x20'+_0x51ea1d+_0x118c17(0x95e)+_0x21fd8f[_0x118c17(0xf20)]+_0x118c17(0x4fe)+_0x1ee507+'\x0a';}}}}const _0x5d241d=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xc48)]||'我';let _0xe4a0a='',_0x306fac=![];if(_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x298)]){const _0x1dc971=_0x59fa17[_0x118c17(0xf2b)](_0x4d66b0=>_0x4d66b0[_0x118c17(0xa57)]===_0x118c17(0x116c)&&!_0x4d66b0['isHidden']),_0x33d68f=_0x59fa17[_0x118c17(0xf2b)](_0x2a2b39=>_0x2a2b39[_0x118c17(0xa57)]===_0x118c17(0x1377)&&!_0x2a2b39[_0x118c17(0x9ae)]);if(_0x1dc971){const _0x543b39=_0x231991(_0x1dc971[_0x118c17(0x114e)]);if(_0x33d68f){const _0x51c015=_0x231991(_0x33d68f[_0x118c17(0x114e)]);_0xe4a0a='-\x20**对话状态**:\x20你的上一条消息发送于\x20'+_0x51c015+_0x118c17(0xf18)+_0x543b39+_0x118c17(0xd9c);const _0xf09726=(_0x1dc971['timestamp']-_0x33d68f[_0x118c17(0x114e)])/(0x3e8*0x3c*0x3c);if(_0xf09726>0x3){_0x306fac=!![];const _0x476acb=Math[_0x118c17(0x128a)](_0xf09726/0x18);_0xe4a0a+=_0x118c17(0xaf7)+(_0x476acb>0x0?_0x476acb+'天':Math[_0x118c17(0x128a)](_0xf09726)+'小时')+_0x118c17(0xb2e)+_0xa18beb+'）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。';}}else _0xe4a0a='-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20'+_0x543b39+'。';}else _0xe4a0a=_0x118c17(0xef1);}const _0x22a8c3=_0x3c8588(_0x2fd04d),_0x244005=_0x247dd3(_0x1a4b35,0x3,_0x118c17(0x5be)),_0x4f04bb=_0x247dd3(_0x1a4b35,0x6,'hours'),_0xeff307=_0x247dd3(_0x1a4b35,0x9,_0x118c17(0x5be)),_0x1e0bcb=_0x247dd3(_0x1a4b35,0x1,_0x118c17(0xccc)),_0x68194b=_0x247dd3(_0x1a4b35,0x3,_0x118c17(0xccc)),_0x52f9f3=_0x247dd3(_0x1a4b35,0x7,_0x118c17(0xccc));let _0x51ed00='';if(_0x244005||_0x4f04bb||_0xeff307||_0x1e0bcb||_0x68194b||_0x52f9f3){_0x51ed00+=_0x118c17(0x10cc);if(_0x244005)_0x51ed00+=_0x244005;if(_0x4f04bb)_0x51ed00+=_0x4f04bb;if(_0xeff307)_0x51ed00+=_0xeff307;if(_0x244005||_0x4f04bb||_0xeff307)_0x51ed00+='\x0a';if(_0x1e0bcb)_0x51ed00+=_0x1e0bcb;if(_0x68194b)_0x51ed00+=_0x68194b;if(_0x52f9f3)_0x51ed00+=_0x52f9f3;}_0x493b2e='\x0a#\x20身份与核心任务\x0a你正在扮演角色“'+_0x1a4b35['originalName']+_0x118c17(0x73a)+_0x1a4b35[_0x118c17(0xdb9)]['aiPersona']+'\x0a'+_0x3ee0b8+_0x118c17(0x222)+_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x6d4)]+_0x118c17(0x63d)+(_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x298)]?_0x118c17(0x6bb)+_0x399d48+'\x20('+_0xa18beb+')':'')+'\x0a'+_0xe4a0a+'\x0a#\x20世界观\x20(必须严格遵守)\x0a'+_0x58c8b4+'\x0a'+_0x102011+_0x118c17(0x1079)+(_0x1a4b35[_0x118c17(0xc18)]&&_0x1a4b35['longTermMemory'][_0x118c17(0x7aa)]>0x0?_0x1a4b35[_0x118c17(0xc18)][_0x118c17(0x412)](_0x2e560b=>'-\x20'+_0x2e560b['content'])[_0x118c17(0x1237)]('\x0a'):_0x118c17(0x12c3))+'\x0a'+_0x51ed00+_0x118c17(0x1119)+_0x1a4b35[_0x118c17(0x1045)]+_0x118c17(0x4cc)+_0x1a4b35[_0x118c17(0xf74)]+_0x118c17(0x6f3)+_0x5d241d+_0x118c17(0x1d0)+_0x4d7406+_0x118c17(0xc2c)+_0xd7c861+_0x118c17(0x1c1)+_0x4a5e62+'\x0a'+_0x19fccf+'\x0a'+_0x1164ca+_0x118c17(0xd6b)+_0x32172d+'\x0a'+_0x4d6ce7+_0x118c17(0xf0f)+(_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x298)]?'-\x20**时间**:\x20你必须感知到当前是\x20'+_0x399d48+'\x20('+_0xa18beb+_0x118c17(0x322):'')+_0x118c17(0x9cd)+(_0x36fede?_0x118c17(0xfc6)+_0x36fede:_0x118c17(0x283))+'\x0a\x20\x20\x20\x20-\x20**读书**:\x20'+(_0x22a8c3?_0x118c17(0x64d)+_0x22a8c3:'你们没有在读书。')+_0x118c17(0x36b)+(_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x614)]&&_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x614)]['length']>0x0?_0x1a4b35['settings']['aiAvatarLibrary'][_0x118c17(0x412)](_0xcb0c4=>'-\x20'+_0xcb0c4[_0x118c17(0xf74)])['join']('\x0a'):'-\x20(空)')+_0x118c17(0x71a)+(_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xe13)]&&_0x1a4b35[_0x118c17(0xdb9)]['myAvatarLibrary'][_0x118c17(0x7aa)]>0x0?_0x1a4b35[_0x118c17(0xdb9)]['myAvatarLibrary'][_0x118c17(0x412)](_0x8a358=>'-\x20'+_0x8a358[_0x118c17(0xf74)])[_0x118c17(0x1237)]('\x0a'):_0x118c17(0x701))+'\x0a-\x20\x20\x20**五子棋局势**:\x20'+_0x5cdd46+_0x118c17(0xd05)+(localStorage['getItem'](_0x118c17(0xd8f))===_0x118c17(0xc8b)?_0x118c17(0x700):'')+'\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a'+(localStorage[_0x118c17(0x1344)](_0x118c17(0xd8f))===_0x118c17(0xc8b)?_0x118c17(0x61d):'')+'\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22'+_0x1a4b35['originalName']+_0x118c17(0x879)+_0x1a4b35[_0x118c17(0x1045)]+_0x118c17(0x40d)+_0x1a4b35[_0x118c17(0x1045)]+'\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22'+_0x1a4b35[_0x118c17(0x1045)]+'\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。',_0x3f7622=_0x59fa17['map'](_0x1cd12a=>{const _0x4a76bc=_0x118c17;if(_0x1cd12a[_0x4a76bc(0x9ae)]&&_0x1cd12a[_0x4a76bc(0xa57)]===_0x4a76bc(0x18c))return{'role':_0x4a76bc(0x116c),'content':_0x1cd12a[_0x4a76bc(0x28c)]};else{if(_0x1cd12a[_0x4a76bc(0x9ae)])return null;}if(_0x1cd12a['type']==='offline_text'){const _0x34558f=_0x1cd12a[_0x4a76bc(0xa57)]==='user'?_0x1a4b35['settings'][_0x4a76bc(0xc48)]||'我':_0x1a4b35['name'];let _0x30ef11='';if(_0x1cd12a[_0x4a76bc(0x28c)])_0x30ef11=_0x1cd12a[_0x4a76bc(0x28c)];else{const _0x3ce1e5=_0x1cd12a[_0x4a76bc(0xa03)]?'「'+_0x1cd12a['dialogue']+'」':'',_0x357ba7=_0x1cd12a[_0x4a76bc(0xf6e)]?'('+_0x1cd12a['description']+')':'';_0x30ef11=(_0x3ce1e5+'\x20'+_0x357ba7)[_0x4a76bc(0xc3a)]();}return{'role':_0x1cd12a[_0x4a76bc(0xa57)],'content':_0x4a76bc(0x570)+_0x1cd12a[_0x4a76bc(0x114e)]+')\x20'+_0x34558f+':\x20'+_0x30ef11};}if(_0x1cd12a[_0x4a76bc(0xa57)]===_0x4a76bc(0x116c)){const _0x443b63=_0x4a76bc(0x570)+_0x1cd12a[_0x4a76bc(0x114e)]+')\x20';let _0x1e23f5='';if(Array[_0x4a76bc(0xbd6)](_0x1cd12a[_0x4a76bc(0x28c)])&&_0x1cd12a[_0x4a76bc(0x28c)][0x0]?.[_0x4a76bc(0x48c)]===_0x4a76bc(0xcad))return{'role':_0x4a76bc(0x116c),'content':[{'type':_0x4a76bc(0xec9),'text':_0x443b63},..._0x1cd12a['content']]};if(_0x1cd12a[_0x4a76bc(0x1ff)]){const _0x50c795=String(_0x1cd12a[_0x4a76bc(0x1ff)][_0x4a76bc(0x28c)]||'')['substring'](0x0,0x32);_0x1e23f5+=_0x4a76bc(0xcf4)+_0x1cd12a[_0x4a76bc(0x1ff)][_0x4a76bc(0xcfc)]+'\x20的消息:\x20\x22'+_0x50c795+_0x4a76bc(0xd58)+_0x1cd12a[_0x4a76bc(0x28c)];}else _0x1e23f5+=_0x1cd12a[_0x4a76bc(0x28c)];if(_0x1cd12a[_0x4a76bc(0x48c)]==='user_photo')return{'role':'user','content':_0x443b63+_0x4a76bc(0x12d9)+_0x1cd12a[_0x4a76bc(0x28c)]+'\x27]'};if(_0x1cd12a[_0x4a76bc(0x48c)]===_0x4a76bc(0xff9))return{'role':'user','content':_0x443b63+'[你发送了一条语音消息，内容是：\x27'+_0x1cd12a[_0x4a76bc(0x28c)]+'\x27]'};if(_0x1cd12a['type']===_0x4a76bc(0x1075))return{'role':'user','content':_0x443b63+_0x4a76bc(0x963)+_0x1cd12a[_0x4a76bc(0x114e)]+'\x20向对方发起了转账:\x20'+_0x1cd12a[_0x4a76bc(0x10a6)]+_0x4a76bc(0xc75)+_0x1cd12a[_0x4a76bc(0xa17)]+'。等待对方处理。]'};if(_0x1cd12a[_0x4a76bc(0x48c)]===_0x4a76bc(0xcd9))return{'role':'user','content':_0x443b63+'[系统提示：你于时间戳\x20'+_0x1cd12a[_0x4a76bc(0x114e)]+'\x20发起了外卖代付请求，商品是“'+_0x1cd12a[_0x4a76bc(0xb3e)]+_0x4a76bc(0x821)+_0x1cd12a[_0x4a76bc(0x10a6)]+'\x20元。]'};else{if(_0x1cd12a[_0x4a76bc(0x48c)]===_0x4a76bc(0xf80)){const _0x369cec=_0x1cd12a['items'][_0x4a76bc(0x412)](_0xc70e04=>_0xc70e04['name']+'\x20x'+_0xc70e04[_0x4a76bc(0x66c)])['join']('、\x20');let _0x1b8708=_0x1a4b35['isGroup']?_0x4a76bc(0x42a)+_0x1cd12a[_0x4a76bc(0x7c7)][_0x4a76bc(0x412)](_0xcc844e=>_0xb9963e(_0x1a4b35,_0xcc844e))[_0x4a76bc(0x1237)]('、\x20'):_0x4a76bc(0x42a)+_0x1a4b35[_0x4a76bc(0xf74)];return{'role':_0x4a76bc(0x116c),'content':_0x443b63+'[系统提示：你\x20'+_0x1b8708+_0x4a76bc(0x1186)+_0x369cec+']'};}}if(_0x1cd12a[_0x4a76bc(0xb5c)])return{'role':_0x4a76bc(0x116c),'content':_0x443b63+_0x4a76bc(0x3fa)+_0x1cd12a[_0x4a76bc(0xb5c)]+'\x27]'};return{'role':_0x1cd12a['role'],'content':_0x443b63+_0x1e23f5};}else{if(_0x1cd12a[_0x4a76bc(0xa57)]===_0x4a76bc(0x1377)){let _0x5c5c61={'type':_0x1cd12a['type']||_0x4a76bc(0xec9)};if(_0x1cd12a[_0x4a76bc(0x48c)]===_0x4a76bc(0x3c8))_0x5c5c61[_0x4a76bc(0x11de)]=_0x1cd12a[_0x4a76bc(0x28c)],_0x5c5c61[_0x4a76bc(0xb5c)]=_0x1cd12a[_0x4a76bc(0xb5c)];else{if(_0x1cd12a[_0x4a76bc(0x48c)]==='transfer')_0x5c5c61[_0x4a76bc(0x10a6)]=_0x1cd12a[_0x4a76bc(0x10a6)],_0x5c5c61['note']=_0x1cd12a[_0x4a76bc(0xa17)];else _0x1cd12a[_0x4a76bc(0x48c)]==='waimai_request'?(_0x5c5c61[_0x4a76bc(0xb3e)]=_0x1cd12a[_0x4a76bc(0xb3e)],_0x5c5c61[_0x4a76bc(0x10a6)]=_0x1cd12a['amount']):_0x1cd12a[_0x4a76bc(0x1ff)]?_0x5c5c61['quote_reply']={'target_sender':_0x1cd12a[_0x4a76bc(0x1ff)][_0x4a76bc(0xcfc)],'target_content':_0x1cd12a[_0x4a76bc(0x1ff)]['content'],'reply_content':_0x1cd12a['content']}:_0x5c5c61[_0x4a76bc(0x28c)]=_0x1cd12a[_0x4a76bc(0x28c)];}const _0x38a314=JSON[_0x4a76bc(0x465)]([_0x5c5c61]);return{'role':_0x4a76bc(0x1377),'content':_0x4a76bc(0x570)+_0x1cd12a['timestamp']+')\x20'+_0x38a314};}}return null;})[_0x118c17(0x3d8)](Boolean);if(!_0x1a4b35['isGroup']&&_0x1a4b35[_0x118c17(0x1383)]?.[_0x118c17(0x632)]===_0x118c17(0x12d2)){const _0x1d5cbe=_0x1a4b35[_0x118c17(0x551)]['filter'](_0x170570=>!_0x170570[_0x118c17(0x9ae)])[_0x118c17(0xdd0)](-0xa)[_0x118c17(0x412)](_0x240737=>{const _0x1a79fa=_0x118c17,_0x1017bb=_0x240737[_0x1a79fa(0xa57)]==='user'?'用户':_0x1a4b35[_0x1a79fa(0xf74)];return _0x1017bb+':\x20'+String(_0x240737[_0x1a79fa(0x28c)])[_0x1a79fa(0x489)](0x0,0x32)+'...';})['join']('\x0a'),_0xf6c464={'role':_0x118c17(0x116c),'content':_0x118c17(0xea7)+_0x1a4b35[_0x118c17(0x1383)][_0x118c17(0x1240)]+'”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1d5cbe+_0x118c17(0x17f)};_0x3f7622['push'](_0xf6c464);}}}let _0x33d732=_0x415b60===GEMINI_API_URL,_0x17964d=_0xa615f4(_0x14ed4d,_0xbca131,_0x493b2e,_0x3f7622),_0x3fa441;try{_0x3fa441=_0x33d732?await fetch(_0x17964d[_0x118c17(0x11de)],_0x17964d['data']):await fetch(_0x415b60+_0x118c17(0x6dd),{'method':_0x118c17(0xd14),'headers':{'Content-Type':'application/json','Authorization':_0x118c17(0x3fb)+_0xbca131},'body':JSON['stringify']({'model':_0x14ed4d,'messages':[{'role':_0x118c17(0x18c),'content':_0x493b2e},..._0x3f7622],'temperature':_0x5b873d['globalSettings'][_0x118c17(0x576)]||0.8,'stream':![]})});}catch(_0x588ccc){throw new Error('网络请求失败:\x20'+_0x588ccc[_0x118c17(0x1288)]);}if(!_0x3fa441['ok']){let _0x1cb5f9=_0x118c17(0xd1f)+_0x3fa441['status']+'\x20'+_0x3fa441[_0x118c17(0x517)];try{const _0x32e759=await _0x3fa441[_0x118c17(0x6b5)]();_0x32e759[_0x118c17(0x1fd)]&&_0x32e759[_0x118c17(0x1fd)][_0x118c17(0x1288)]?_0x1cb5f9+=_0x118c17(0xc3d)+_0x32e759['error'][_0x118c17(0x1288)]:_0x1cb5f9+=_0x118c17(0xc3d)+JSON[_0x118c17(0x465)](_0x32e759);}catch(_0xfee6ac){_0x1cb5f9+='\x20-\x20响应内容:\x20'+await _0x3fa441[_0x118c17(0xec9)]();}throw new Error(_0x1cb5f9);}const _0x109afb=await _0x3fa441[_0x118c17(0x6b5)](),_0x54667b=getGeminiResponseText(_0x109afb);lastRawAiResponse=_0x54667b,lastResponseTimestamps=[],_0x1a4b35[_0x118c17(0x551)]=_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x3d8)](_0x448b06=>!_0x448b06[_0x118c17(0xfce)]);const _0x3cc643=_0x29a17f(_0x54667b);let _0xa4deff=[];if(_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xb65)]){let _0x186a54={'content':[],'dialogue':[],'description':[]};for(const _0x3ed1b0 of _0x3cc643){if(_0x3ed1b0[_0x118c17(0x48c)]===_0x118c17(0x910)){if(_0x3ed1b0[_0x118c17(0x28c)])_0x186a54[_0x118c17(0x28c)][_0x118c17(0x138c)](_0x3ed1b0[_0x118c17(0x28c)]);else{if(_0x3ed1b0[_0x118c17(0xa03)])_0x186a54[_0x118c17(0xa03)][_0x118c17(0x138c)](_0x3ed1b0[_0x118c17(0xa03)]);if(_0x3ed1b0[_0x118c17(0xf6e)])_0x186a54['description']['push'](_0x3ed1b0['description']);}}else(_0x186a54[_0x118c17(0x28c)][_0x118c17(0x7aa)]>0x0||_0x186a54['dialogue']['length']>0x0||_0x186a54[_0x118c17(0xf6e)][_0x118c17(0x7aa)]>0x0)&&(_0x186a54[_0x118c17(0x28c)][_0x118c17(0x7aa)]>0x0&&_0xa4deff[_0x118c17(0x138c)]({'type':_0x118c17(0x910),'content':_0x186a54['content'][_0x118c17(0x1237)]('\x0a')}),(_0x186a54['dialogue'][_0x118c17(0x7aa)]>0x0||_0x186a54[_0x118c17(0xf6e)]['length']>0x0)&&_0xa4deff[_0x118c17(0x138c)]({'type':_0x118c17(0x910),'dialogue':_0x186a54[_0x118c17(0xa03)][_0x118c17(0x1237)]('\x0a'),'description':_0x186a54['description'][_0x118c17(0x1237)]('\x0a')}),_0x186a54={'content':[],'dialogue':[],'description':[]}),_0xa4deff[_0x118c17(0x138c)](_0x3ed1b0);}_0x186a54[_0x118c17(0x28c)][_0x118c17(0x7aa)]>0x0&&_0xa4deff[_0x118c17(0x138c)]({'type':_0x118c17(0x910),'content':_0x186a54[_0x118c17(0x28c)]['join']('\x0a')}),(_0x186a54[_0x118c17(0xa03)]['length']>0x0||_0x186a54[_0x118c17(0xf6e)][_0x118c17(0x7aa)]>0x0)&&_0xa4deff[_0x118c17(0x138c)]({'type':_0x118c17(0x910),'dialogue':_0x186a54[_0x118c17(0xa03)][_0x118c17(0x1237)]('\x0a'),'description':_0x186a54[_0x118c17(0xf6e)][_0x118c17(0x1237)]('\x0a')});}else _0xa4deff=_0x3cc643;const _0x61fb62=_0x1a4b35['history'][_0x118c17(0x3d8)](_0x94a240=>_0x94a240['role']==='user'&&!_0x94a240[_0x118c17(0x9ae)])[_0x118c17(0x114b)]();if(_0x61fb62&&Array[_0x118c17(0xbd6)](_0x61fb62[_0x118c17(0x28c)])&&_0x61fb62['content'][0x0]?.[_0x118c17(0x48c)]===_0x118c17(0xcad)&&!_0x61fb62[_0x118c17(0x575)]){const _0x17de98=_0x3cc643[_0x118c17(0x12f4)](_0x20bda2=>_0x20bda2[_0x118c17(0x48c)]===_0x118c17(0xec9));let _0x14c873;_0x17de98&&(_0x17de98[_0x118c17(0x28c)]||_0x17de98[_0x118c17(0x1288)])?_0x14c873=String(_0x17de98[_0x118c17(0x28c)]||_0x17de98[_0x118c17(0x1288)])['trim']():_0x14c873=_0x118c17(0x12e1);const _0x1b09f8=_0x1a4b35['history'][_0x118c17(0x9d7)](_0x4fb8ae=>_0x4fb8ae[_0x118c17(0x114e)]===_0x61fb62[_0x118c17(0x114e)]);if(_0x1b09f8>-0x1){console[_0x118c17(0x471)]('识图优化：正在将时间戳为\x20'+_0x61fb62['timestamp']+_0x118c17(0x115c));const _0x515da0=_0x118c17(0xf0a)+_0x14c873+'”]';_0x1a4b35[_0x118c17(0x551)][_0x1b09f8][_0x118c17(0x28c)]=_0x515da0,_0x1a4b35[_0x118c17(0x551)][_0x1b09f8][_0x118c17(0x575)]=!![],_0x1a4b35[_0x118c17(0x551)][_0x1b09f8][_0x118c17(0x48c)]=_0x118c17(0xec9);}}const _0x45000b=document[_0x118c17(0x89d)](_0x118c17(0x87f))['classList'][_0x118c17(0x3ff)](_0x118c17(0x8ea))&&_0x5b873d[_0x118c17(0xf96)]===_0x2fd04d;let _0x50147c=![],_0x297782=Date['now'](),_0x1f3f2e=[],_0x3cd3b4=![];for(const _0x48361e of _0xa4deff){_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xe7e)]!==![]&&_0x48361e[_0x118c17(0x48c)]===_0x118c17(0xec9)&&typeof _0x48361e[_0x118c17(0x28c)]===_0x118c17(0x1224)&&_0x48361e[_0x118c17(0x28c)][_0x118c17(0xc3a)]()['startsWith']('[V]')&&(_0x48361e['type']=_0x118c17(0xff9),_0x48361e['content']=_0x48361e[_0x118c17(0x28c)][_0x118c17(0xfbf)](_0x118c17(0x4d2),'')['trim']());if(_0x1a4b35[_0x118c17(0x58c)]&&_0x48361e['name']&&_0x48361e[_0x118c17(0xf74)]===_0x1a4b35[_0x118c17(0xf74)]){console[_0x118c17(0x1fd)]('AI幻觉已被拦截！试图使用群名\x20(\x22'+_0x1a4b35[_0x118c17(0xf74)]+_0x118c17(0x905),_0x48361e);continue;}if(!_0x48361e||typeof _0x48361e!==_0x118c17(0x7af)){console[_0x118c17(0xac3)](_0x118c17(0xdee),_0x48361e);continue;}if(!_0x48361e[_0x118c17(0x48c)]){if(_0x1a4b35['isGroup']&&_0x48361e['name']&&_0x48361e['message'])_0x48361e[_0x118c17(0x48c)]=_0x118c17(0xec9);else{if(_0x48361e['content'])_0x48361e[_0x118c17(0x48c)]=_0x118c17(0xec9);else{console[_0x118c17(0xac3)](_0x118c17(0x1331),_0x48361e);continue;}}}if(_0x48361e['type']==='video_call_response'){_0x333dc7[_0x118c17(0xba8)]=![];if(_0x48361e['decision']===_0x118c17(0xc52))_0x11ad56();else{const _0x5beb08={'role':_0x118c17(0x1377),'content':_0x118c17(0x4f6),'timestamp':Date[_0x118c17(0xf1a)]()};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x5beb08),await _0x1a6951['chats'][_0x118c17(0xc0f)](_0x1a4b35),_0x4e6c15(_0x118c17(0x87f)),_0x5b89df(_0x2fd04d);}_0x50147c=!![];break;}if(_0x48361e[_0x118c17(0x48c)]==='group_call_response'){if(_0x48361e[_0x118c17(0xc49)]===_0x118c17(0x1237)){const _0x2413ea=_0x1a4b35[_0x118c17(0x5ab)][_0x118c17(0x12f4)](_0x5576e2=>_0x5576e2[_0x118c17(0x1045)]===_0x48361e[_0x118c17(0xf74)]);_0x2413ea&&!_0x333dc7[_0x118c17(0x394)][_0x118c17(0xc5c)](_0x2ea85b=>_0x2ea85b['id']===_0x2413ea['id'])&&_0x333dc7[_0x118c17(0x394)][_0x118c17(0x138c)](_0x2413ea);}_0x50147c=!![];continue;}if(_0x1a4b35[_0x118c17(0x58c)]&&_0x48361e[_0x118c17(0xf74)]&&_0x48361e[_0x118c17(0xf74)]===_0x1a4b35[_0x118c17(0xf74)]){console['error'](_0x118c17(0x36c)+_0x1a4b35[_0x118c17(0xf74)]+'\x22)\x20作为角色名。消息内容:',_0x48361e);continue;}if(_0x1a4b35[_0x118c17(0x58c)]&&!_0x48361e[_0x118c17(0xf74)]){console['error']('AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:',_0x48361e);continue;}let _0x4e33f6=null;const _0x5691d3=_0x297782++,_0x2222c1={'role':_0x118c17(0x1377),'senderName':_0x48361e[_0x118c17(0xf74)]||_0x1a4b35['name'],'timestamp':_0x5691d3};lastResponseTimestamps[_0x118c17(0x138c)](_0x5691d3);switch(_0x48361e[_0x118c17(0x48c)]){case'update_thoughts':if(!_0x1a4b35['isGroup']){_0x48361e['heartfelt_voice']&&(_0x1a4b35['heartfeltVoice']=String(_0x48361e[_0x118c17(0x941)]));_0x48361e[_0x118c17(0x116a)]&&(_0x1a4b35[_0x118c17(0x27e)]=String(_0x48361e[_0x118c17(0x116a)]));!Array[_0x118c17(0xbd6)](_0x1a4b35[_0x118c17(0x1152)])&&(_0x1a4b35[_0x118c17(0x1152)]=[]);_0x1a4b35[_0x118c17(0x1152)][_0x118c17(0x138c)]({'heartfeltVoice':_0x1a4b35[_0x118c17(0x253)],'randomJottings':_0x1a4b35[_0x118c17(0x27e)],'timestamp':Date['now']()});_0x1a4b35[_0x118c17(0x1152)][_0x118c17(0x7aa)]>0x32&&_0x1a4b35[_0x118c17(0x1152)][_0x118c17(0xcbe)]();const _0x2ffbc6=_0x118c17(0xbbc)+_0x1a4b35['heartfeltVoice']+_0x118c17(0x2ad)+_0x1a4b35['randomJottings'],_0x5cd45e={'role':_0x118c17(0x18c),'content':_0x2ffbc6,'timestamp':Date[_0x118c17(0xf1a)](),'isHidden':!![]};}continue;case _0x118c17(0x502):if(!_0x1a4b35[_0x118c17(0x58c)]&&_0x48361e[_0x118c17(0x1c2)]){const _0x3d62a8=_0x48361e['new_name'][_0x118c17(0xc3a)]();if(_0x3d62a8){_0x1a4b35['settings'][_0x118c17(0xc48)]=_0x3d62a8;const _0x3dfc2a={'role':_0x118c17(0x18c),'type':'pat_message','content':'“'+_0x1a4b35[_0x118c17(0xf74)]+_0x118c17(0x665)+_0x3d62a8+'”','timestamp':_0x297782++};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x3dfc2a);const _0x8868cf={'role':_0x118c17(0x18c),'content':_0x118c17(0x422)+_0x3d62a8+_0x118c17(0x3c0),'timestamp':_0x297782++,'isHidden':!![]};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x8868cf),_0x45000b&&_0x58deee(_0x3dfc2a,_0x1a4b35);}}continue;case'change_remark_name':if(!_0x1a4b35['isGroup']&&_0x48361e[_0x118c17(0x1c2)]){const _0x2273c6=_0x1a4b35[_0x118c17(0xf74)],_0x4201d3=_0x48361e[_0x118c17(0x1c2)]['trim']();if(_0x4201d3&&_0x4201d3!==_0x2273c6){!_0x1a4b35[_0x118c17(0xfe2)]&&(_0x1a4b35['nameHistory']=[]);!_0x1a4b35['nameHistory'][_0x118c17(0xced)](_0x2273c6)&&_0x1a4b35['nameHistory'][_0x118c17(0x138c)](_0x2273c6);_0x1a4b35[_0x118c17(0xf74)]=_0x4201d3;const _0x45ddc3={'role':'system','type':_0x118c17(0xc7a),'content':'“'+_0x1a4b35['originalName']+_0x118c17(0x1112)+_0x4201d3+'”','timestamp':_0x297782++};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x45ddc3);const _0x1d258a={'role':_0x118c17(0x18c),'content':_0x118c17(0x1081)+_0x4201d3+_0x118c17(0x7e3),'timestamp':_0x297782++,'isHidden':!![]};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x1d258a),_0x45000b&&(_0x58deee(_0x45ddc3,_0x1a4b35),document[_0x118c17(0x89d)](_0x118c17(0x578))[_0x118c17(0xf12)]=_0x4201d3),await _0x52ccfe(_0x1a4b35);}}continue;case'change_avatar':{const _0x29e27e=_0x48361e[_0x118c17(0xf74)],_0xf2d077=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x614)][_0x118c17(0x12f4)](_0x39f05e=>_0x39f05e[_0x118c17(0xf74)]===_0x29e27e);if(_0xf2d077){_0x1a4b35['settings']['aiAvatar']=_0xf2d077[_0x118c17(0x11de)];const _0x46268b={'role':_0x118c17(0x18c),'type':'pat_message','content':'['+_0x1a4b35[_0x118c17(0xf74)]+'\x20更换了头像]','timestamp':Date[_0x118c17(0xf1a)]()};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x46268b),await _0x2f6a63(_0x1a4b35),_0x45000b&&(_0x58deee(_0x46268b,_0x1a4b35),_0x5b89df(_0x2fd04d));}continue;}case _0x118c17(0x77d):{const _0x5f1170=_0x48361e[_0x118c17(0xf74)],_0x51582f=_0x1a4b35['settings']['myAvatarLibrary'][_0x118c17(0x12f4)](_0x4ed172=>_0x4ed172[_0x118c17(0xf74)]===_0x5f1170);if(_0x51582f){_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xd55)]=_0x51582f['url'];const _0x5d6d1f={'role':_0x118c17(0x18c),'type':_0x118c17(0xc7a),'content':'['+_0x1a4b35[_0x118c17(0xf74)]+_0x118c17(0x136f),'timestamp':Date['now']()};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x5d6d1f),_0x45000b&&(_0x58deee(_0x5d6d1f,_0x1a4b35),_0x5b89df(_0x2fd04d));}continue;}case'gomoku_move':{const _0x48a8b8=parseInt(_0x48361e['x']),_0x131064=parseInt(_0x48361e['y']);!isNaN(_0x48a8b8)&&!isNaN(_0x131064)?_0xa18ee9({'x':_0x48a8b8,'y':_0x131064}):console[_0x118c17(0xac3)](_0x118c17(0x891),_0x48361e);continue;}case _0x118c17(0x57d):const _0x57edc3=_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x9d7)](_0x2fd845=>_0x2fd845[_0x118c17(0x114e)]===_0x48361e[_0x118c17(0x135e)]);if(_0x57edc3>-0x1){const _0x26480d=_0x1a4b35['history'][_0x57edc3];_0x26480d[_0x118c17(0x632)]=_0x48361e[_0x118c17(0x632)],_0x26480d['paidBy']=_0x48361e[_0x118c17(0x632)]===_0x118c17(0x1385)?_0x48361e[_0x118c17(0xf74)]:null;}continue;case _0x118c17(0x8ed):const _0x4b654a={'type':_0x48361e[_0x118c17(0x2db)],'content':_0x48361e[_0x118c17(0x28c)]||'','publicText':_0x48361e['publicText']||'','hiddenContent':_0x48361e[_0x118c17(0x132c)]||'','timestamp':Date['now'](),'authorId':_0x2fd04d,'authorGroupId':_0x1a4b35[_0x118c17(0xb54)],'visibleGroupIds':null};if(_0x48361e[_0x118c17(0x2db)]==='realimag'&&_0x48361e[_0x118c17(0x1086)]){const _0x92654d=Array[_0x118c17(0xbd6)](_0x48361e[_0x118c17(0x1086)])?_0x48361e[_0x118c17(0x1086)][_0x118c17(0xdd0)](0x0,0x9):[_0x48361e[_0x118c17(0x1086)]];_0x4b654a['imageUrls']=_0x92654d[_0x118c17(0x412)](_0x6a634=>{const _0x504c86=_0x118c17,_0x3554af=encodeURIComponent(_0x6a634);return'https://image.pollinations.ai/prompt/'+_0x3554af+_0x504c86(0x8b1);}),_0x92654d['length']===0x1&&(_0x4b654a[_0x118c17(0x450)]=_0x4b654a['imageUrls'][0x0]),_0x4b654a[_0x118c17(0x1086)]=_0x48361e[_0x118c17(0x1086)],_0x4b654a['imageCount']=_0x92654d[_0x118c17(0x7aa)],console[_0x118c17(0x471)](_0x118c17(0xf54)+_0x92654d[_0x118c17(0x7aa)]+'张',_0x4b654a[_0x118c17(0x930)]);}if(_0x48361e[_0x118c17(0x2db)]===_0x118c17(0x88f)&&_0x48361e[_0x118c17(0x1086)])try{const _0x407304=Array['isArray'](_0x48361e[_0x118c17(0x1086)])?_0x48361e[_0x118c17(0x1086)]['slice'](0x0,0x2):[_0x48361e[_0x118c17(0x1086)]];console[_0x118c17(0x471)](_0x118c17(0xbac)+_0x407304[_0x118c17(0x7aa)]+_0x118c17(0x6a5));const _0x2ae267=[];for(let _0x4664dc=0x0;_0x4664dc<_0x407304[_0x118c17(0x7aa)];_0x4664dc++){const _0x167d5e=_0x407304[_0x4664dc];console[_0x118c17(0x471)]('生成第'+(_0x4664dc+0x1)+'张图片，prompt:',_0x167d5e);const _0x319e78=_0x29c3f2(_0x1a4b35['id']),_0xb12f9f=_0x167d5e+',\x20'+_0x319e78[_0x118c17(0x977)],_0x50c6a2=_0x319e78[_0x118c17(0x127b)];console[_0x118c17(0x471)]('📝\x20使用'+(_0x319e78[_0x118c17(0xa26)]===_0x118c17(0x132a)?_0x118c17(0xd2f):'系统')+_0x118c17(0x4ed)),console['log'](_0x118c17(0xa8b),_0xb12f9f),console[_0x118c17(0x471)]('最终负面提示词:',_0x50c6a2);const _0x581d37=localStorage[_0x118c17(0x1344)]('novelai-api-key'),_0x1bf035=localStorage[_0x118c17(0x1344)](_0x118c17(0x865))||_0x118c17(0x11af),_0x122abd=_0x15f1a9();if(!_0x581d37)throw new Error(_0x118c17(0x117a));const [_0x112156,_0x1bdee6]=_0x122abd[_0x118c17(0xe3a)][_0x118c17(0x55b)]('x')[_0x118c17(0x412)](Number);let _0x1a4996;_0x1bf035[_0x118c17(0xced)](_0x118c17(0xf60))?_0x1a4996={'input':_0xb12f9f,'model':_0x1bf035,'action':_0x118c17(0xc32),'parameters':{'params_version':0x3,'width':_0x112156,'height':_0x1bdee6,'scale':_0x122abd[_0x118c17(0x99e)],'sampler':_0x122abd[_0x118c17(0xefd)],'steps':_0x122abd['steps'],'seed':_0x122abd[_0x118c17(0xce3)]===-0x1?Math[_0x118c17(0x128a)](Math['random']()*0x2540be3ff):_0x122abd['seed'],'n_samples':0x1,'ucPreset':_0x122abd[_0x118c17(0x883)],'qualityToggle':_0x122abd[_0x118c17(0x647)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x118c17(0x10fa),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0xb12f9f,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x50c6a2,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x50c6a2,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x1a4996={'input':_0xb12f9f,'model':_0x1bf035,'action':'generate','parameters':{'width':_0x112156,'height':_0x1bdee6,'scale':_0x122abd[_0x118c17(0x99e)],'sampler':_0x122abd[_0x118c17(0xefd)],'steps':_0x122abd[_0x118c17(0x331)],'seed':_0x122abd['seed']===-0x1?Math[_0x118c17(0x128a)](Math['random']()*0x2540be3ff):_0x122abd[_0x118c17(0xce3)],'n_samples':0x1,'ucPreset':_0x122abd[_0x118c17(0x883)],'qualityToggle':_0x122abd['quality_toggle'],'sm':_0x122abd[_0x118c17(0x1270)],'sm_dyn':_0x122abd[_0x118c17(0x130a)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x118c17(0x184),'negative_prompt':_0x50c6a2}};console[_0x118c17(0x471)]('🚀\x20发送NAI请求:',_0x1a4996);let _0x394b5f;_0x1bf035['includes'](_0x118c17(0xf60))?_0x394b5f='https://image.novelai.net/ai/generate-image-stream':_0x394b5f='https://image.novelai.net/ai/generate-image';let _0x567ee0=_0x122abd['cors_proxy'];_0x567ee0==='custom'&&(_0x567ee0=_0x122abd[_0x118c17(0x843)]||'');_0x567ee0&&_0x567ee0!==''&&(_0x394b5f=_0x567ee0+encodeURIComponent(_0x394b5f));const _0x56055e=await fetch(_0x394b5f,{'method':_0x118c17(0xd14),'headers':{'Content-Type':_0x118c17(0xce4),'Authorization':_0x118c17(0x3fb)+_0x581d37},'body':JSON[_0x118c17(0x465)](_0x1a4996)});console[_0x118c17(0x471)](_0x118c17(0x7fd),_0x56055e[_0x118c17(0x632)]),console['log'](_0x118c17(0xe49),[..._0x56055e[_0x118c17(0x4f1)][_0x118c17(0xa7f)]()]);if(!_0x56055e['ok']){const _0x2b7686=await _0x56055e[_0x118c17(0xec9)]();console['error'](_0x118c17(0xd9f),_0x2b7686);throw new Error('API请求失败\x20('+_0x56055e['status']+_0x118c17(0x4fe)+_0x2b7686);}const _0x5d38a2=_0x56055e[_0x118c17(0x4f1)][_0x118c17(0x650)](_0x118c17(0x1209));console[_0x118c17(0x471)](_0x118c17(0x11c4),_0x5d38a2);let _0x524ca6,_0x5e8d2d;if(_0x5d38a2&&_0x5d38a2[_0x118c17(0xced)]('text/event-stream')){console[_0x118c17(0x471)](_0x118c17(0x10fe));const _0x59c959=await _0x56055e['text']();console[_0x118c17(0x471)](_0x118c17(0xe52),_0x59c959[_0x118c17(0x7aa)]);const _0x4565d5=_0x59c959[_0x118c17(0xc3a)]()[_0x118c17(0x55b)]('\x0a');let _0x5ae076=null;for(let _0x1ba500=_0x4565d5[_0x118c17(0x7aa)]-0x1;_0x1ba500>=0x0;_0x1ba500--){const _0x5edbb5=_0x4565d5[_0x1ba500][_0x118c17(0xc3a)]();if(_0x5edbb5[_0x118c17(0x1222)](_0x118c17(0xce9))&&_0x5edbb5!=='data:\x20[DONE]'){const _0x31a888=_0x5edbb5['substring'](0x6);try{const _0x3a2563=JSON[_0x118c17(0x2cb)](_0x31a888);if(_0x3a2563[_0x118c17(0x998)]===_0x118c17(0x10a7)&&_0x3a2563['image']){_0x5ae076=_0x3a2563[_0x118c17(0xbef)],console[_0x118c17(0x471)]('✅\x20找到\x20final\x20事件的图片数据');break;}if(_0x3a2563[_0x118c17(0xd98)]){_0x5ae076=_0x3a2563['data'],console[_0x118c17(0x471)](_0x118c17(0x4e3));break;}if(_0x3a2563[_0x118c17(0xbef)]){_0x5ae076=_0x3a2563[_0x118c17(0xbef)],console[_0x118c17(0x471)](_0x118c17(0xe6b));break;}}catch(_0x1bb7a2){_0x5ae076=_0x31a888,console[_0x118c17(0x471)]('直接使用\x20base64\x20数据');break;}}}if(!_0x5ae076)throw new Error(_0x118c17(0x67f));const _0x5ad544=_0x5ae076[_0x118c17(0x1222)](_0x118c17(0x122a)),_0x290bbc=_0x5ae076[_0x118c17(0x1222)](_0x118c17(0x1af));if(_0x5ad544||_0x290bbc){console[_0x118c17(0x471)](_0x118c17(0xc08));const _0x3af143=atob(_0x5ae076),_0x2c0b59=new Uint8Array(_0x3af143[_0x118c17(0x7aa)]);for(let _0x348963=0x0;_0x348963<_0x3af143['length'];_0x348963++){_0x2c0b59[_0x348963]=_0x3af143['charCodeAt'](_0x348963);}const _0x5ec57f=new Blob([_0x2c0b59],{'type':_0x5ad544?_0x118c17(0x572):_0x118c17(0xd48)});console[_0x118c17(0x471)](_0x118c17(0x8c9),_0x5ec57f[_0x118c17(0x746)]);const _0x2709e8=new FileReader();_0x5e8d2d=await new Promise((_0x329ac2,_0x217d24)=>{const _0x114890=_0x118c17;_0x2709e8[_0x114890(0x12f2)]=()=>_0x329ac2(_0x2709e8[_0x114890(0x9dc)]),_0x2709e8['onerror']=_0x217d24,_0x2709e8[_0x114890(0x5b4)](_0x5ec57f);}),console[_0x118c17(0x471)](_0x118c17(0x4f2));}else{console[_0x118c17(0x471)](_0x118c17(0x418));const _0x2645d4=atob(_0x5ae076),_0x466db7=new Uint8Array(_0x2645d4[_0x118c17(0x7aa)]);for(let _0x14260b=0x0;_0x14260b<_0x2645d4[_0x118c17(0x7aa)];_0x14260b++){_0x466db7[_0x14260b]=_0x2645d4[_0x118c17(0x11eb)](_0x14260b);}_0x524ca6=new Blob([_0x466db7]),console[_0x118c17(0x471)](_0x118c17(0x1c3),_0x524ca6['size']);}}else _0x524ca6=await _0x56055e[_0x118c17(0x122f)](),console['log'](_0x118c17(0xe83),_0x524ca6[_0x118c17(0x48c)],_0x118c17(0x426),_0x524ca6[_0x118c17(0x746)]);if(!_0x5e8d2d&&_0x524ca6)try{if(typeof JSZip===_0x118c17(0x1bf))throw new Error(_0x118c17(0xd36));const _0xc27317=await JSZip[_0x118c17(0xdaa)](_0x524ca6);console[_0x118c17(0x471)](_0x118c17(0x1f8),Object[_0x118c17(0xe9c)](_0xc27317[_0x118c17(0x541)]));let _0x4bb0fb=null;for(let _0x5c20ac in _0xc27317[_0x118c17(0x541)]){if(_0x5c20ac[_0x118c17(0x86c)](/\.(png|jpg|jpeg|webp)$/i)){_0x4bb0fb=_0xc27317[_0x118c17(0x541)][_0x5c20ac],console['log'](_0x118c17(0x103a),_0x5c20ac);break;}}if(!_0x4bb0fb)throw new Error('ZIP文件中未找到图片');const _0x291227=await _0x4bb0fb['async'](_0x118c17(0x122f));console['log'](_0x118c17(0xe2e),_0x291227['size']);const _0x2201cf=new FileReader();_0x5e8d2d=await new Promise((_0x485ae4,_0xad8116)=>{const _0x1e5b3a=_0x118c17;_0x2201cf[_0x1e5b3a(0x12f2)]=()=>_0x485ae4(_0x2201cf[_0x1e5b3a(0x9dc)]),_0x2201cf[_0x1e5b3a(0x1010)]=_0xad8116,_0x2201cf[_0x1e5b3a(0x5b4)](_0x291227);}),console[_0x118c17(0x471)]('✅\x20图片解压成功！');}catch(_0x57d8a6){console['error'](_0x118c17(0x306),_0x57d8a6);throw new Error(_0x118c17(0x589)+_0x57d8a6['message']);}console[_0x118c17(0x471)](_0x118c17(0xcba)+(_0x4664dc+0x1)+_0x118c17(0x1357)),_0x2ae267[_0x118c17(0x138c)](_0x5e8d2d);}_0x4b654a[_0x118c17(0x930)]=_0x2ae267,_0x2ae267[_0x118c17(0x7aa)]===0x1&&(_0x4b654a[_0x118c17(0x450)]=_0x2ae267[0x0]),_0x4b654a['prompt']=_0x48361e[_0x118c17(0x1086)],_0x4b654a[_0x118c17(0x136d)]=_0x2ae267[_0x118c17(0x7aa)],console['log']('✅\x20动态NovelAI图片全部生成完成:\x20'+_0x2ae267[_0x118c17(0x7aa)]+'张');}catch(_0x12474f){console[_0x118c17(0x1fd)](_0x118c17(0xdd5),_0x12474f),_0x4b654a['content']=(_0x4b654a[_0x118c17(0x28c)]||_0x4b654a[_0x118c17(0x957)]||'')+(_0x118c17(0x4d1)+_0x12474f[_0x118c17(0x1288)]+']');}await _0x1a6951[_0x118c17(0xea0)][_0x118c17(0x569)](_0x4b654a),_0x3cd1c0(_0x111a81+0x1);_0x45000b&&document['getElementById']('qzone-screen')['classList'][_0x118c17(0x3ff)](_0x118c17(0x8ea))&&await _0x155816();continue;case'qzone_comment':{const _0x2393e8=await _0x1a6951[_0x118c17(0xea0)][_0x118c17(0x650)](parseInt(_0x48361e[_0x118c17(0x7b6)]));if(_0x2393e8){if(!_0x2393e8[_0x118c17(0x1157)])_0x2393e8[_0x118c17(0x1157)]=[];const _0x585d06=_0x48361e[_0x118c17(0xf74)]||_0x1a4b35[_0x118c17(0x1045)],_0x36405f=(_0x1930d4,_0xd9192a=null,_0x206b53=null)=>({'commenterName':_0x585d06,'text':_0x401262(_0x1930d4,_0x1a4b35),'meaning':_0xd9192a,'replyTo':_0x206b53,'timestamp':Date['now']()});if(_0x48361e['stickerMeaning']){const _0x49d95c=_0x5b873d[_0x118c17(0x210)][_0x118c17(0x12f4)](_0x11c292=>_0x11c292[_0x118c17(0xf74)]===_0x48361e['stickerMeaning']);_0x49d95c?_0x2393e8[_0x118c17(0x1157)][_0x118c17(0x138c)](_0x36405f(_0x49d95c[_0x118c17(0x11de)],_0x49d95c[_0x118c17(0xf74)],_0x48361e[_0x118c17(0x8e7)]||null)):(console[_0x118c17(0xac3)](_0x118c17(0x2d0)+_0x48361e[_0x118c17(0x115f)]+'\x22'),_0x2393e8[_0x118c17(0x1157)][_0x118c17(0x138c)](_0x36405f(_0x118c17(0x507)+_0x48361e[_0x118c17(0x115f)]+']',null,_0x48361e[_0x118c17(0x8e7)]||null)));}else{if(Array[_0x118c17(0xbd6)](_0x48361e[_0x118c17(0x1157)]))_0x48361e[_0x118c17(0x1157)][_0x118c17(0xd9a)](_0x4c8d78=>{const _0xacc19b=_0x118c17;typeof _0x4c8d78===_0xacc19b(0x1224)&&_0x4c8d78[_0xacc19b(0xc3a)]()&&_0x2393e8[_0xacc19b(0x1157)][_0xacc19b(0x138c)](_0x36405f(_0x4c8d78,null,_0x48361e[_0xacc19b(0x8e7)]||null));});else typeof _0x48361e[_0x118c17(0x1202)]===_0x118c17(0x1224)&&_0x48361e[_0x118c17(0x1202)][_0x118c17(0xc3a)]()&&_0x2393e8['comments'][_0x118c17(0x138c)](_0x36405f(_0x48361e[_0x118c17(0x1202)],null,_0x48361e[_0x118c17(0x8e7)]||null));}await _0x1a6951['qzonePosts'][_0x118c17(0xdfc)](_0x2393e8['id'],{'comments':_0x2393e8[_0x118c17(0x1157)]}),_0x3cd1c0(_0x111a81+0x1),console[_0x118c17(0x471)](_0x118c17(0x664)+_0x1a4b35[_0x118c17(0xf74)]+_0x118c17(0xed8)+_0x48361e[_0x118c17(0x7b6)]);if(!_0x1a4b35['commentCooldowns'])_0x1a4b35[_0x118c17(0xf70)]={};_0x1a4b35[_0x118c17(0xf70)][_0x48361e[_0x118c17(0x7b6)]]=Date[_0x118c17(0xf1a)]();}continue;}case'qzone_like':const _0x5d0828=await _0x1a6951['qzonePosts'][_0x118c17(0x650)](parseInt(_0x48361e[_0x118c17(0x7b6)]));if(_0x5d0828){if(!_0x5d0828['likes'])_0x5d0828['likes']=[];!_0x5d0828[_0x118c17(0xfe6)][_0x118c17(0xced)](_0x1a4b35[_0x118c17(0xf74)])&&(_0x5d0828[_0x118c17(0xfe6)][_0x118c17(0x138c)](_0x1a4b35[_0x118c17(0xf74)]),await _0x1a6951[_0x118c17(0xea0)][_0x118c17(0xdfc)](_0x5d0828['id'],{'likes':_0x5d0828[_0x118c17(0xfe6)]}),_0x3cd1c0(_0x111a81+0x1),_0x45000b&&document[_0x118c17(0x89d)]('qzone-screen')['classList'][_0x118c17(0x3ff)]('active')&&await _0x155816());}continue;case _0x118c17(0xb95):{const _0x4ba5ba=await _0x1a6951['qzonePosts'][_0x118c17(0x650)](parseInt(_0x48361e[_0x118c17(0x7b6)]));if(_0x4ba5ba){const _0x82e817={'type':_0x118c17(0xb95),'timestamp':Date['now'](),'authorId':_0x2fd04d,'authorGroupId':_0x1a4b35[_0x118c17(0xb54)],'repostComment':_0x48361e['comment']||'','originalPost':_0x4ba5ba,'visibleGroupIds':null};await _0x1a6951[_0x118c17(0xea0)][_0x118c17(0x569)](_0x82e817),_0x3cd1c0(_0x111a81+0x1),console[_0x118c17(0x471)](_0x118c17(0x664)+_0x1a4b35[_0x118c17(0xf74)]+'\x22\x20转发了动态\x20#'+_0x48361e[_0x118c17(0x7b6)]);}continue;}case _0x118c17(0x7c0):!_0x333dc7[_0x118c17(0xfcb)]&&!_0x333dc7[_0x118c17(0xba8)]&&(_0x5b873d[_0x118c17(0xf96)]=_0x2fd04d,_0x333dc7[_0x118c17(0xf96)]=_0x2fd04d,_0x333dc7['isAwaitingResponse']=!![],_0x333dc7[_0x118c17(0x43c)]=_0x1a4b35[_0x118c17(0x58c)],_0x333dc7[_0x118c17(0x7a1)]=_0x48361e[_0x118c17(0xf74)]||_0x1a4b35[_0x118c17(0xf74)],_0x714251());continue;case'group_call_request':!_0x333dc7[_0x118c17(0xfcb)]&&!_0x333dc7[_0x118c17(0xba8)]&&(_0x5b873d[_0x118c17(0xf96)]=_0x2fd04d,_0x333dc7[_0x118c17(0xba8)]=!![],_0x333dc7['isGroupCall']=!![],_0x333dc7[_0x118c17(0x12b5)]='ai',_0x333dc7['callRequester']=_0x48361e[_0x118c17(0xf74)],_0x714251());continue;case _0x118c17(0x121d):let _0x34c349;if(_0x1a4b35['isGroup']){const _0x13f5f8=_0x1a4b35[_0x118c17(0x5ab)]['find'](_0x1d9deb=>_0x1d9deb[_0x118c17(0x1045)]===_0x48361e[_0x118c17(0xf74)]);_0x34c349=_0x13f5f8?_0x13f5f8[_0x118c17(0x7da)]:_0x48361e[_0x118c17(0xf74)];}else _0x34c349=_0x1a4b35['name'];const _0x4e8557=_0x48361e[_0x118c17(0x3e3)]?'\x20'+_0x48361e['suffix'][_0x118c17(0xc3a)]():'',_0x315b7e=_0x34c349+'\x20拍了拍我'+_0x4e8557,_0x4e985e={'role':_0x118c17(0x18c),'type':_0x118c17(0xc7a),'content':_0x315b7e,'timestamp':Date[_0x118c17(0xf1a)]()};_0x1a4b35['history'][_0x118c17(0x138c)](_0x4e985e);if(_0x45000b){const _0x5856e1=document['getElementById']('phone-screen');_0x5856e1[_0x118c17(0x2f1)]['remove'](_0x118c17(0x11c7)),void _0x5856e1[_0x118c17(0xf13)],_0x5856e1[_0x118c17(0x2f1)][_0x118c17(0x569)](_0x118c17(0x11c7)),setTimeout(()=>_0x5856e1[_0x118c17(0x2f1)][_0x118c17(0x1247)](_0x118c17(0x11c7)),0x1f4),_0x58deee(_0x4e985e,_0x1a4b35);}else _0x23fbd5(_0x2fd04d,_0x315b7e);continue;case _0x118c17(0x18b):_0x1a4b35[_0x118c17(0x632)][_0x118c17(0xec9)]=_0x48361e[_0x118c17(0x68c)],_0x1a4b35[_0x118c17(0x632)][_0x118c17(0x311)]=_0x48361e[_0x118c17(0x9c6)]||![],_0x1a4b35['status']['lastUpdate']=Date[_0x118c17(0xf1a)]();const _0xcfba87={'role':_0x118c17(0x18c),'type':_0x118c17(0xc7a),'content':'['+_0x1a4b35[_0x118c17(0xf74)]+_0x118c17(0x12de)+_0x48361e[_0x118c17(0x68c)]+']','timestamp':Date[_0x118c17(0xf1a)]()};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0xcfba87);_0x45000b&&_0x58deee(_0xcfba87,_0x1a4b35);_0x413d78();continue;case _0x118c17(0x873):_0x4e33f6={..._0x2222c1,'type':_0x118c17(0x873),'content':_0x48361e['content']};break;case'change_music':if(_0x1f2ed8[_0x118c17(0xfcb)]&&_0x1f2ed8[_0x118c17(0xf96)]===_0x2fd04d){const _0x2f3cda=_0x48361e[_0x118c17(0xe9b)]||_0x48361e[_0x118c17(0x10a3)]||_0x48361e[_0x118c17(0xf74)];if(typeof _0x2f3cda===_0x118c17(0x1224)&&_0x2f3cda[_0x118c17(0xc3a)]()){const _0x4ac334=_0x2f3cda[_0x118c17(0xfbf)](/^\[?\d+\]?[\s.-]*/,'')[_0x118c17(0xc3a)](),_0x41b5cf=_0x1f2ed8[_0x118c17(0x2c0)][_0x118c17(0x9d7)](_0x20afe9=>_0x20afe9['name'][_0x118c17(0x124b)]()===_0x4ac334[_0x118c17(0x124b)]());if(_0x41b5cf>-0x1){_0x1eec83(_0x41b5cf);const _0x50a1f1=_0x1f2ed8[_0x118c17(0x2c0)][_0x41b5cf];let _0x274d2f;if(_0x1a4b35[_0x118c17(0x58c)]){const _0x2a8545=_0x1a4b35['members']['find'](_0x3baf13=>_0x3baf13[_0x118c17(0x1045)]===_0x48361e[_0x118c17(0xf74)]);_0x274d2f=_0x2a8545?_0x2a8545[_0x118c17(0x7da)]:_0x48361e[_0x118c17(0xf74)];}else _0x274d2f=_0x1a4b35['name'];const _0x534de8={'role':_0x118c17(0x18c),'type':'pat_message','content':_0x118c17(0xc00)+_0x274d2f+_0x118c17(0x8e2)+_0x50a1f1[_0x118c17(0xf74)]+'》\x20-\x20'+_0x50a1f1[_0x118c17(0x1196)]+']','timestamp':Date['now']()};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x534de8),_0x45000b&&_0x58deee(_0x534de8,_0x1a4b35);}else console[_0x118c17(0xac3)](_0x118c17(0xab5)+_0x2f3cda+'\x22(处理后为\x22'+_0x4ac334+'\x22)\x20在播放列表中未找到。');}else console[_0x118c17(0x1fd)](_0x118c17(0xa0e),_0x48361e);}continue;case _0x118c17(0xfdf):const _0x12ec4d={'chatId':_0x2fd04d,'authorId':_0x2fd04d,'description':_0x48361e['description'],'timestamp':Date[_0x118c17(0xf1a)](),'type':_0x118c17(0x1214)};await _0x1a6951[_0x118c17(0x19e)][_0x118c17(0x569)](_0x12ec4d),console['log']('AI\x20\x22'+_0x1a4b35['name']+_0x118c17(0xcbf),_0x48361e[_0x118c17(0xf6e)]);continue;case _0x118c17(0xd63):const _0x3f97da=new Date(_0x48361e[_0x118c17(0x792)]);if(!isNaN(_0x3f97da)&&_0x3f97da>new Date()){const _0x1ee4a3={'chatId':_0x2fd04d,'authorId':_0x2fd04d,'description':_0x48361e[_0x118c17(0x104c)],'timestamp':Date['now'](),'type':_0x118c17(0x6d8),'targetDate':_0x3f97da[_0x118c17(0xaa6)]()};await _0x1a6951[_0x118c17(0x19e)][_0x118c17(0x569)](_0x1ee4a3),console[_0x118c17(0x471)](_0x118c17(0x177)+_0x1a4b35['name']+_0x118c17(0x2b4),_0x48361e[_0x118c17(0x104c)]);}continue;case _0x118c17(0x817):if(!_0x1a4b35[_0x118c17(0x58c)]){_0x1a4b35[_0x118c17(0x1383)][_0x118c17(0x632)]=_0x118c17(0x59f);const _0x538b7e={'role':_0x118c17(0x18c),'content':_0x118c17(0x8c3),'timestamp':Date[_0x118c17(0xf1a)](),'isHidden':!![]};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x538b7e),await _0x1a6951[_0x118c17(0x667)][_0x118c17(0xc0f)](_0x1a4b35);_0x45000b&&_0x5b89df(_0x2fd04d);_0x413d78();break;}continue;case'friend_request_response':!_0x1a4b35['isGroup']&&_0x1a4b35[_0x118c17(0x1383)]?.['status']===_0x118c17(0x12d2)&&(_0x48361e['decision']===_0x118c17(0xc52)?(_0x1a4b35[_0x118c17(0x1383)][_0x118c17(0x632)]='friend',_0x4e33f6={..._0x2222c1,'content':_0x118c17(0x102d)}):(_0x1a4b35[_0x118c17(0x1383)]['status']='blocked_by_ai',_0x4e33f6={..._0x2222c1,'content':'抱歉，我拒绝了你的好友申请。'}),_0x1a4b35[_0x118c17(0x1383)][_0x118c17(0x1240)]='');break;case _0x118c17(0xa9c):const _0x4aa4ca=typeof _0x48361e[_0x118c17(0x1034)]==='string'?_0x48361e[_0x118c17(0x1034)][_0x118c17(0x55b)]('\x0a')[_0x118c17(0x3d8)](_0x2fa484=>_0x2fa484[_0x118c17(0xc3a)]()):Array[_0x118c17(0xbd6)](_0x48361e[_0x118c17(0x1034)])?_0x48361e[_0x118c17(0x1034)]:[];if(_0x4aa4ca[_0x118c17(0x7aa)]<0x2)continue;_0x4e33f6={..._0x2222c1,'type':_0x118c17(0xa9c),'question':_0x48361e[_0x118c17(0xba1)],'options':_0x4aa4ca,'votes':{},'isClosed':![]};break;case _0x118c17(0xf80):{const {itemName:_0x1de907,itemPrice:_0x5c4834,image_prompt:_0x3c8407}=_0x48361e;if(_0x1de907&&!isNaN(parseFloat(_0x5c4834))&&_0x3c8407){const _0x27f377='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x3c8407);_0x4e33f6={..._0x2222c1,'type':'gift','items':[{'name':_0x1de907,'price':parseFloat(_0x5c4834),'imageUrl':_0x27f377,'quantity':0x1}],'total':parseFloat(_0x5c4834),'recipients':_0x48361e[_0x118c17(0x7c7)]||null};}else console['warn'](_0x118c17(0xad1),_0x48361e);break;}case _0x118c17(0x12b3):const _0x17841e=_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x12f4)](_0x5bde59=>_0x5bde59[_0x118c17(0x114e)]===_0x48361e[_0x118c17(0xb1c)]);_0x17841e&&!_0x17841e[_0x118c17(0xd1e)]&&(Object['keys'](_0x17841e[_0x118c17(0x10d1)])[_0x118c17(0xd9a)](_0x10db66=>{const _0x48fc28=_0x118c17,_0x1aaa66=_0x17841e[_0x48fc28(0x10d1)][_0x10db66]['indexOf'](_0x48361e['name']);_0x1aaa66>-0x1&&_0x17841e[_0x48fc28(0x10d1)][_0x10db66][_0x48fc28(0x776)](_0x1aaa66,0x1);}),!_0x17841e[_0x118c17(0x10d1)][_0x48361e[_0x118c17(0x98c)]]&&(_0x17841e[_0x118c17(0x10d1)][_0x48361e[_0x118c17(0x98c)]]=[]),!_0x17841e[_0x118c17(0x10d1)][_0x48361e[_0x118c17(0x98c)]]['includes'](_0x48361e[_0x118c17(0xf74)])&&_0x17841e[_0x118c17(0x10d1)][_0x48361e[_0x118c17(0x98c)]]['push'](_0x48361e[_0x118c17(0xf74)]),_0x45000b&&_0x5b89df(_0x2fd04d));continue;case _0x118c17(0x675):_0x4e33f6={..._0x2222c1,..._0x48361e,'totalAmount':_0x48361e['amount'],'claimedBy':{},'isFullyClaimed':![]};_0x48361e[_0x118c17(0x392)]&&(_0x4e33f6[_0x118c17(0xb12)]=_0x48361e[_0x118c17(0x392)],delete _0x4e33f6[_0x118c17(0x392)]);break;case _0x118c17(0x213):const _0xc1a047=_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x12f4)](_0x5c8d10=>_0x5c8d10[_0x118c17(0x114e)]===_0x48361e[_0x118c17(0x430)]),_0x20de7d=_0x48361e[_0x118c17(0xf74)],_0x516cfd=_0x1a4b35[_0x118c17(0x5ab)][_0x118c17(0xc5c)](_0x2a37fd=>_0x2a37fd[_0x118c17(0x1045)]===_0x20de7d);if(!_0x516cfd){console[_0x118c17(0xac3)]('AI\x20角色\x20\x22'+_0x20de7d+_0x118c17(0x135b));continue;}if(_0xc1a047&&_0xc1a047['packetType']===_0x118c17(0xfc5)){if(_0xc1a047[_0x118c17(0xb12)]!==_0x48361e[_0x118c17(0xf74)]){console[_0x118c17(0xac3)](_0x118c17(0x663)+_0x48361e[_0x118c17(0xf74)]+'\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20'+_0xc1a047[_0x118c17(0xb12)]+')。操作已被拦截。');continue;}}if(_0xc1a047&&!_0xc1a047[_0x118c17(0x9aa)]&&!(_0xc1a047[_0x118c17(0xb37)]&&_0xc1a047['claimedBy'][_0x48361e[_0x118c17(0xf74)]])){let _0x17803b=0x0;const _0x339d48=_0xc1a047[_0x118c17(0x33e)]-Object[_0x118c17(0x4b5)](_0xc1a047[_0x118c17(0xb37)]||{})[_0x118c17(0x11e2)]((_0x427de3,_0x2a211c)=>_0x427de3+_0x2a211c,0x0),_0x4230d5=_0xc1a047['count']-Object[_0x118c17(0xe9c)](_0xc1a047[_0x118c17(0xb37)]||{})[_0x118c17(0x7aa)];if(_0x4230d5>0x0){if(_0xc1a047[_0x118c17(0x2d1)]===_0x118c17(0xfc5))_0x17803b=_0xc1a047[_0x118c17(0x33e)];else{if(_0x4230d5===0x1)_0x17803b=_0x339d48;else{const _0x556468=0.01,_0x3c73fe=_0x339d48-(_0x4230d5-0x1)*_0x556468;_0x17803b=Math[_0x118c17(0xdc6)]()*(_0x3c73fe-_0x556468)+_0x556468;}}_0x17803b=parseFloat(_0x17803b[_0x118c17(0x8f7)](0x2));if(!_0xc1a047[_0x118c17(0xb37)])_0xc1a047['claimedBy']={};_0xc1a047[_0x118c17(0xb37)][_0x48361e['name']]=_0x17803b;const _0x2cee37=_0x1a4b35[_0x118c17(0x5ab)][_0x118c17(0x12f4)](_0xb2feea=>_0xb2feea[_0x118c17(0x1045)]===_0x48361e[_0x118c17(0xf74)]),_0xfd78e2=_0x2cee37?_0x2cee37[_0x118c17(0x7da)]:_0x48361e[_0x118c17(0xf74)],_0xd9d91c=_0xb9963e(_0x1a4b35,_0xc1a047['senderName']),_0x5af3df={'role':_0x118c17(0x18c),'type':'pat_message','content':_0xfd78e2+_0x118c17(0x9d9)+_0xd9d91c+_0x118c17(0x232),'timestamp':Date[_0x118c17(0xf1a)]()};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x5af3df);let _0x4d0204=_0x118c17(0xf17)+_0xfd78e2+_0x118c17(0x508)+_0x17803b['toFixed'](0x2)+_0x118c17(0xa68);if(Object[_0x118c17(0xe9c)](_0xc1a047[_0x118c17(0xb37)])[_0x118c17(0x7aa)]>=_0xc1a047[_0x118c17(0x749)]){_0xc1a047['isFullyClaimed']=!![];const _0x24f5bb={'role':_0x118c17(0x18c),'type':'pat_message','content':_0xd9d91c+'\x20的红包已被领完','timestamp':Date[_0x118c17(0xf1a)]()+0x1};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x24f5bb);let _0x89ab49={'name':'','amount':-0x1};_0xc1a047[_0x118c17(0x2d1)]==='lucky'&&_0xc1a047[_0x118c17(0x749)]>0x1&&Object['entries'](_0xc1a047['claimedBy'])[_0x118c17(0xd9a)](([_0x42bbeb,_0x1e920d])=>{_0x1e920d>_0x89ab49['amount']&&(_0x89ab49={'name':_0x42bbeb,'amount':_0x1e920d});});if(_0x89ab49[_0x118c17(0xf74)]){const _0x4180e8=_0x1a4b35[_0x118c17(0x5ab)][_0x118c17(0x12f4)](_0x48e208=>_0x48e208[_0x118c17(0x1045)]===_0x89ab49[_0x118c17(0xf74)]),_0x3c2de8=_0x4180e8?_0x4180e8['groupNickname']:_0x89ab49['name'];_0x4d0204+='\x20红包已被领完，手气王是\x20'+_0x3c2de8+'！';}else _0x4d0204+='\x20红包已被领完。';}_0x4d0204+=_0x118c17(0x3e5);const _0xbb864e={'role':_0x118c17(0x18c),'content':_0x4d0204,'timestamp':Date[_0x118c17(0xf1a)]()+0x2,'isHidden':!![]};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0xbb864e);}_0x45000b&&(_0x5b89df(_0x2fd04d),_0x413d78());}continue;case _0x118c17(0x73f):{const _0x5e5071=_0x1a4b35['history'][_0x118c17(0x9d7)](_0x1af704=>_0x1af704[_0x118c17(0x114e)]===_0x48361e[_0x118c17(0x135e)]);if(_0x5e5071>-0x1){const _0x4424db=_0x1a4b35[_0x118c17(0x551)][_0x5e5071];_0x4424db['status']=_0x118c17(0x59a);}continue;}case'decline_transfer':{const _0x42aac4=_0x1a4b35['history']['findIndex'](_0x54a813=>_0x54a813['timestamp']===_0x48361e[_0x118c17(0x135e)]);if(_0x42aac4>-0x1){const _0x289121=_0x1a4b35[_0x118c17(0x551)][_0x42aac4];_0x289121['status']=_0x118c17(0xc0e);const _0x58373e={'role':'assistant','senderName':_0x1a4b35[_0x118c17(0xf74)],'type':_0x118c17(0x1075),'isRefund':!![],'amount':_0x289121[_0x118c17(0x10a6)],'note':'转账已被拒收','timestamp':_0x297782++};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x58373e),_0x45000b&&(_0x58deee(_0x58373e,_0x1a4b35),_0x5b89df(_0x2fd04d));}continue;}case _0x118c17(0xcfa):if(_0x1a4b35[_0x118c17(0x58c)]&&_0x48361e[_0x118c17(0x1c2)]){const _0x157da9=_0x48361e[_0x118c17(0x1c2)][_0x118c17(0xc3a)](),_0x44743b=_0x1a4b35[_0x118c17(0x5ab)][_0x118c17(0x412)](_0x1e0148=>_0x1e0148['originalName']);if(_0x44743b['includes'](_0x157da9)){console[_0x118c17(0xac3)](_0x118c17(0xad2)+_0x48361e[_0x118c17(0xf74)]+')\x20试图将群名更改为成员名\x20(\x22'+_0x157da9+'\x22)。操作已被程序阻止。');continue;}_0x1a4b35[_0x118c17(0xf74)]=_0x157da9;const _0x261788=_0x1a4b35[_0x118c17(0x5ab)]['find'](_0x26bef7=>_0x26bef7[_0x118c17(0x1045)]===_0x48361e[_0x118c17(0xf74)]),_0x5b3b66=_0x261788?_0x261788[_0x118c17(0x7da)]:_0x48361e[_0x118c17(0xf74)],_0x20a199={'role':_0x118c17(0x18c),'type':_0x118c17(0xc7a),'content':_0x5b3b66+'\x20将群名修改为\x20“'+_0x1a4b35[_0x118c17(0xf74)]+'”','timestamp':_0x297782++};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x20a199),_0x45000b&&(_0x58deee(_0x20a199,_0x1a4b35),document[_0x118c17(0x89d)](_0x118c17(0x578))[_0x118c17(0xf12)]=_0x1a4b35[_0x118c17(0xf74)]);}continue;case _0x118c17(0xaa2):if(!_0x1a4b35[_0x118c17(0x58c)]&&_0x48361e[_0x118c17(0x1c2)]){const _0x3b8630=_0x1a4b35[_0x118c17(0xf74)],_0x2be30f=_0x48361e[_0x118c17(0x1c2)][_0x118c17(0xc3a)]();if(_0x2be30f&&_0x2be30f!==_0x3b8630){!_0x1a4b35[_0x118c17(0xfe2)]&&(_0x1a4b35[_0x118c17(0xfe2)]=[]);!_0x1a4b35[_0x118c17(0xfe2)][_0x118c17(0xced)](_0x3b8630)&&_0x1a4b35[_0x118c17(0xfe2)][_0x118c17(0x138c)](_0x3b8630);_0x1a4b35[_0x118c17(0xf74)]=_0x2be30f;const _0x387f9e={'role':_0x118c17(0x18c),'type':_0x118c17(0xc7a),'content':'“'+_0x1a4b35[_0x118c17(0x1045)]+_0x118c17(0x1112)+_0x2be30f+'”','timestamp':_0x297782++};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x387f9e);const _0x1504e5={'role':'system','content':'[系统提示：你刚刚成功将自己的备注名修改为了“'+_0x2be30f+'”。请自然地接受这个新名字，不要对此感到惊讶。]','timestamp':_0x297782++,'isHidden':!![]};_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x1504e5),_0x45000b&&(_0x58deee(_0x387f9e,_0x1a4b35),document[_0x118c17(0x89d)](_0x118c17(0x578))[_0x118c17(0xf12)]=_0x2be30f),await _0x52ccfe(_0x1a4b35);}}continue;case _0x118c17(0xfa5):if(_0x1a4b35[_0x118c17(0x58c)]&&_0x48361e[_0x118c17(0x8bf)]){const _0x373e80=_0x48361e[_0x118c17(0x8bf)],_0x2a446f=_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0x1e2)]||[],_0x2095ad=_0x2a446f[_0x118c17(0x12f4)](_0x44a227=>_0x44a227[_0x118c17(0xf74)]===_0x373e80);if(_0x2095ad){_0x1a4b35[_0x118c17(0xdb9)]['groupAvatar']=_0x2095ad[_0x118c17(0x11de)];const _0x13449f=_0x1a4b35[_0x118c17(0x5ab)][_0x118c17(0x12f4)](_0x32d441=>_0x32d441[_0x118c17(0x1045)]===_0x48361e[_0x118c17(0xf74)]),_0x18b32b=_0x13449f?_0x13449f[_0x118c17(0x7da)]:_0x48361e[_0x118c17(0xf74)],_0x162b83={'role':_0x118c17(0x18c),'type':_0x118c17(0xc7a),'content':_0x18b32b+_0x118c17(0x324),'timestamp':_0x297782++};_0x1a4b35[_0x118c17(0x551)]['push'](_0x162b83),_0x45000b&&_0x58deee(_0x162b83,_0x1a4b35);}else console[_0x118c17(0xac3)]('AI\x20尝试使用一个不存在的群头像:\x20\x22'+_0x373e80+'\x22');}continue;case _0x118c17(0xdfa):_0x4e33f6={'role':_0x118c17(0x18c),'type':_0x118c17(0xc7a),'content':_0x48361e[_0x118c17(0x28c)],'timestamp':Date[_0x118c17(0xf1a)]()};break;case'share_link':_0x4e33f6={..._0x2222c1,'type':_0x118c17(0x1d8),'title':_0x48361e['title'],'description':_0x48361e[_0x118c17(0xf6e)],'source_name':_0x48361e[_0x118c17(0x573)],'content':_0x48361e['content']};break;case _0x118c17(0x6cf):const _0x6c97aa=_0x1a4b35['history']['find'](_0x422940=>_0x422940['timestamp']===_0x48361e[_0x118c17(0x36e)]);if(_0x6c97aa){const _0x193056={'timestamp':_0x6c97aa['timestamp'],'senderName':_0x6c97aa[_0x118c17(0xcfc)]||(_0x6c97aa['role']===_0x118c17(0x116c)?_0x1a4b35[_0x118c17(0xdb9)][_0x118c17(0xc48)]||'我':_0x1a4b35[_0x118c17(0xf74)]),'content':String(_0x6c97aa['content']||'')[_0x118c17(0x489)](0x0,0x32)};_0x4e33f6={..._0x2222c1,'content':_0x48361e['reply_content'],'quote':_0x193056};}else _0x4e33f6={..._0x2222c1,'content':_0x48361e[_0x118c17(0x22c)]};break;case _0x118c17(0xe40):{if(!_0x45000b)continue;const _0x78cdb3={..._0x2222c1,'content':_0x48361e['content']},_0x3c0b28=_0x1ed144(_0x78cdb3,_0x1a4b35);_0x58deee(_0x78cdb3,_0x1a4b35,!![]),await new Promise(_0x60ef6d=>setTimeout(_0x60ef6d,Math[_0x118c17(0xdc6)]()*0x3e8+0x5dc));const _0x328e73=document['querySelector'](_0x118c17(0x806)+_0x78cdb3['timestamp']+'\x22]')?.[_0x118c17(0x53a)](_0x118c17(0x107a));if(_0x328e73){_0x328e73[_0x118c17(0x2f1)][_0x118c17(0x569)](_0x118c17(0x2d5)),await new Promise(_0x982c23=>setTimeout(_0x982c23,0x12c));const _0x5ed7e9={'role':_0x118c17(0x1377),'senderName':_0x48361e['name']||_0x1a4b35[_0x118c17(0xf74)],'type':_0x118c17(0xdc0),'content':_0x118c17(0x263),'timestamp':_0x78cdb3[_0x118c17(0x114e)],'recalledData':{'originalType':_0x118c17(0xec9),'originalContent':_0x48361e['content']}},_0x29634c=_0x1a4b35['history'][_0x118c17(0x9d7)](_0x3a1e48=>_0x3a1e48[_0x118c17(0x114e)]===_0x78cdb3[_0x118c17(0x114e)]);_0x29634c>-0x1?_0x1a4b35['history'][_0x29634c]=_0x5ed7e9:_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x138c)](_0x5ed7e9);const _0x123b6b=await _0x1ed144(_0x5ed7e9,_0x1a4b35);document[_0x118c17(0x259)][_0x118c17(0x3ff)](_0x328e73)&&_0x328e73['parentNode'][_0x118c17(0xd38)](_0x123b6b,_0x328e73);}continue;}case _0x118c17(0xec9):_0x4e33f6={..._0x2222c1,'content':String(_0x48361e[_0x118c17(0x28c)]||_0x48361e[_0x118c17(0x1288)])};break;case _0x118c17(0x3c8):if(_0x48361e[_0x118c17(0xb5c)]){const _0x31fb39=_0x5b873d[_0x118c17(0x210)][_0x118c17(0x12f4)](_0x5a61b0=>_0x5a61b0[_0x118c17(0xf74)]===_0x48361e[_0x118c17(0xb5c)]);_0x31fb39?_0x4e33f6={..._0x2222c1,'type':'sticker','content':_0x31fb39[_0x118c17(0x11de)],'meaning':_0x31fb39[_0x118c17(0xf74)]}:(console[_0x118c17(0xac3)]('AI\x20尝试使用一个不存在的表情:\x20\x22'+_0x48361e[_0x118c17(0xb5c)]+'\x22'),_0x4e33f6={..._0x2222c1,'type':_0x118c17(0xec9),'content':_0x118c17(0x507)+_0x48361e['meaning']+']'});}else console[_0x118c17(0xac3)](_0x118c17(0x623),_0x48361e),_0x4e33f6={..._0x2222c1,'type':'sticker','content':_0x48361e['url'],'meaning':_0x118c17(0x6a3)};break;case'ai_image':_0x4e33f6={..._0x2222c1,'type':'ai_image','content':_0x48361e['description'],'image_prompt':_0x48361e['image_prompt']};break;case _0x118c17(0xff9):_0x4e33f6={..._0x2222c1,'type':_0x118c17(0xff9),'content':_0x48361e[_0x118c17(0x28c)]};break;case _0x118c17(0x1075):_0x4e33f6={..._0x2222c1,'type':_0x118c17(0x1075),'amount':_0x48361e[_0x118c17(0x10a6)],'note':_0x48361e[_0x118c17(0xa17)],'receiverName':_0x48361e['receiver']||'我'};break;case'waimai_request':_0x4e33f6={..._0x2222c1,'type':_0x118c17(0xcd9),'productInfo':_0x48361e[_0x118c17(0xb3e)],'amount':_0x48361e['amount'],'status':_0x118c17(0x1042),'countdownEndTime':Date[_0x118c17(0xf1a)]()+0xf*0x3c*0x3e8};break;case _0x118c17(0x451):_0x4e33f6={..._0x2222c1,'type':_0x118c17(0x451),'productInfo':_0x48361e[_0x118c17(0xb3e)],'amount':_0x48361e[_0x118c17(0x10a6)],'greeting':_0x48361e[_0x118c17(0x108d)],'recipientName':_0x48361e[_0x118c17(0x2ff)]||null};break;case _0x118c17(0x910):_0x4e33f6={..._0x2222c1,..._0x48361e};break;case _0x118c17(0x88f):try{console['log'](_0x118c17(0x432),_0x48361e[_0x118c17(0x1086)]);const _0x1ef0da=_0x29c3f2(_0x1a4b35['id']),_0x33cc87=_0x48361e['prompt']||'a\x20beautiful\x20scene',_0x459dee=_0x33cc87+',\x20'+_0x1ef0da[_0x118c17(0x977)],_0x5e9687=_0x1ef0da[_0x118c17(0x127b)];console[_0x118c17(0x471)](_0x118c17(0x115e)+(_0x1ef0da['source']===_0x118c17(0x132a)?_0x118c17(0xd2f):'系统')+'提示词配置'),console['log'](_0x118c17(0xa8b),_0x459dee),console[_0x118c17(0x471)](_0x118c17(0x12e0),_0x5e9687);const _0x5ca2e8=localStorage[_0x118c17(0x1344)]('novelai-api-key'),_0xd51d21=localStorage[_0x118c17(0x1344)](_0x118c17(0x865))||'nai-diffusion-4-5-full',_0x392806=_0x15f1a9();if(!_0x5ca2e8)throw new Error(_0x118c17(0x117a));const [_0x3344c9,_0x120d97]=_0x392806['resolution']['split']('x')[_0x118c17(0x412)](Number);let _0x5d2d13;_0xd51d21[_0x118c17(0xced)]('nai-diffusion-4')?_0x5d2d13={'input':_0x459dee,'model':_0xd51d21,'action':_0x118c17(0xc32),'parameters':{'params_version':0x3,'width':_0x3344c9,'height':_0x120d97,'scale':_0x392806[_0x118c17(0x99e)],'sampler':_0x392806[_0x118c17(0xefd)],'steps':_0x392806['steps'],'seed':_0x392806[_0x118c17(0xce3)]===-0x1?Math[_0x118c17(0x128a)](Math[_0x118c17(0xdc6)]()*0x2540be3ff):_0x392806['seed'],'n_samples':0x1,'ucPreset':_0x392806[_0x118c17(0x883)],'qualityToggle':_0x392806[_0x118c17(0x647)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x118c17(0x10fa),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x459dee,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x5e9687,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x5e9687,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x5d2d13={'input':_0x459dee,'model':_0xd51d21,'action':_0x118c17(0xc32),'parameters':{'width':_0x3344c9,'height':_0x120d97,'scale':_0x392806[_0x118c17(0x99e)],'sampler':_0x392806['sampler'],'steps':_0x392806[_0x118c17(0x331)],'seed':_0x392806[_0x118c17(0xce3)]===-0x1?Math[_0x118c17(0x128a)](Math['random']()*0x2540be3ff):_0x392806['seed'],'n_samples':0x1,'ucPreset':_0x392806[_0x118c17(0x883)],'qualityToggle':_0x392806[_0x118c17(0x647)],'sm':_0x392806['smea'],'sm_dyn':_0x392806[_0x118c17(0x130a)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':'native','negative_prompt':_0x5e9687}};console[_0x118c17(0x471)](_0x118c17(0x3e0),_0x5d2d13);let _0x53b6a0;_0xd51d21[_0x118c17(0xced)](_0x118c17(0xf60))?_0x53b6a0=_0x118c17(0x136e):_0x53b6a0='https://image.novelai.net/ai/generate-image';let _0x4a1922=_0x392806['cors_proxy'];_0x4a1922===_0x118c17(0xb8f)&&(_0x4a1922=_0x392806[_0x118c17(0x843)]||'');_0x4a1922&&_0x4a1922!==''&&(_0x53b6a0=_0x4a1922+encodeURIComponent(_0x53b6a0));const _0x36a49f=await fetch(_0x53b6a0,{'method':_0x118c17(0xd14),'headers':{'Content-Type':_0x118c17(0xce4),'Authorization':_0x118c17(0x3fb)+_0x5ca2e8},'body':JSON[_0x118c17(0x465)](_0x5d2d13)});console[_0x118c17(0x471)](_0x118c17(0x7fd),_0x36a49f['status']),console[_0x118c17(0x471)]('Response\x20headers:',[..._0x36a49f[_0x118c17(0x4f1)][_0x118c17(0xa7f)]()]);if(!_0x36a49f['ok']){const _0xea840e=await _0x36a49f[_0x118c17(0xec9)]();console['error'](_0x118c17(0xd9f),_0xea840e);throw new Error('API请求失败\x20('+_0x36a49f['status']+_0x118c17(0x4fe)+_0xea840e);}const _0x551a0e=_0x36a49f[_0x118c17(0x4f1)]['get']('content-type');console[_0x118c17(0x471)](_0x118c17(0x11c4),_0x551a0e);let _0x226100,_0x4d1cb5;if(_0x551a0e&&_0x551a0e[_0x118c17(0xced)](_0x118c17(0x9b7))){console[_0x118c17(0x471)](_0x118c17(0x10fe));const _0x3c68bb=await _0x36a49f[_0x118c17(0xec9)]();console[_0x118c17(0x471)](_0x118c17(0xe52),_0x3c68bb['length']);const _0x2bd6a3=_0x3c68bb[_0x118c17(0xc3a)]()[_0x118c17(0x55b)]('\x0a');let _0x1ac322=null;for(let _0x409889=_0x2bd6a3[_0x118c17(0x7aa)]-0x1;_0x409889>=0x0;_0x409889--){const _0x3f5408=_0x2bd6a3[_0x409889][_0x118c17(0xc3a)]();if(_0x3f5408[_0x118c17(0x1222)](_0x118c17(0xce9))&&_0x3f5408!=='data:\x20[DONE]'){const _0xacfe19=_0x3f5408['substring'](0x6);try{const _0x22e623=JSON[_0x118c17(0x2cb)](_0xacfe19);if(_0x22e623[_0x118c17(0x998)]===_0x118c17(0x10a7)&&_0x22e623[_0x118c17(0xbef)]){_0x1ac322=_0x22e623[_0x118c17(0xbef)],console[_0x118c17(0x471)]('✅\x20找到\x20final\x20事件的图片数据');break;}if(_0x22e623[_0x118c17(0xd98)]){_0x1ac322=_0x22e623[_0x118c17(0xd98)],console[_0x118c17(0x471)](_0x118c17(0x4e3));break;}if(_0x22e623[_0x118c17(0xbef)]){_0x1ac322=_0x22e623[_0x118c17(0xbef)],console[_0x118c17(0x471)]('从\x20JSON.image\x20中提取图片数据');break;}}catch(_0x323d8b){_0x1ac322=_0xacfe19,console['log'](_0x118c17(0xe09));break;}}}if(!_0x1ac322)throw new Error(_0x118c17(0x67f));const _0x19262f=_0x1ac322[_0x118c17(0x1222)](_0x118c17(0x122a)),_0x1e5d12=_0x1ac322[_0x118c17(0x1222)](_0x118c17(0x1af));if(_0x19262f||_0x1e5d12){console[_0x118c17(0x471)](_0x118c17(0xc08));const _0x5536f3=atob(_0x1ac322),_0x127f96=new Uint8Array(_0x5536f3[_0x118c17(0x7aa)]);for(let _0x36ac00=0x0;_0x36ac00<_0x5536f3['length'];_0x36ac00++){_0x127f96[_0x36ac00]=_0x5536f3['charCodeAt'](_0x36ac00);}const _0x12154e=new Blob([_0x127f96],{'type':_0x19262f?'image/png':_0x118c17(0xd48)});console[_0x118c17(0x471)](_0x118c17(0x8c9),_0x12154e[_0x118c17(0x746)]);const _0x5830f5=new FileReader();_0x4d1cb5=await new Promise((_0x2194ea,_0x314e78)=>{const _0x2ee5d1=_0x118c17;_0x5830f5[_0x2ee5d1(0x12f2)]=()=>_0x2194ea(_0x5830f5[_0x2ee5d1(0x9dc)]),_0x5830f5[_0x2ee5d1(0x1010)]=_0x314e78,_0x5830f5[_0x2ee5d1(0x5b4)](_0x12154e);}),console['log']('✅\x20图片转换成功！🎨');}else{console[_0x118c17(0x471)](_0x118c17(0x418));const _0x43da4e=atob(_0x1ac322),_0x4520b9=new Uint8Array(_0x43da4e[_0x118c17(0x7aa)]);for(let _0x617fdb=0x0;_0x617fdb<_0x43da4e[_0x118c17(0x7aa)];_0x617fdb++){_0x4520b9[_0x617fdb]=_0x43da4e[_0x118c17(0x11eb)](_0x617fdb);}_0x226100=new Blob([_0x4520b9]),console[_0x118c17(0x471)](_0x118c17(0x1c3),_0x226100[_0x118c17(0x746)]);}}else _0x226100=await _0x36a49f['blob'](),console['log'](_0x118c17(0xe83),_0x226100[_0x118c17(0x48c)],_0x118c17(0x426),_0x226100[_0x118c17(0x746)]);if(!_0x4d1cb5&&_0x226100)try{if(typeof JSZip===_0x118c17(0x1bf))throw new Error(_0x118c17(0xd36));const _0x4644f7=await JSZip[_0x118c17(0xdaa)](_0x226100);console[_0x118c17(0x471)](_0x118c17(0x1f8),Object['keys'](_0x4644f7['files']));let _0x41cd68=null;for(let _0x3067a0 in _0x4644f7[_0x118c17(0x541)]){if(_0x3067a0[_0x118c17(0x86c)](/\.(png|jpg|jpeg|webp)$/i)){_0x41cd68=_0x4644f7[_0x118c17(0x541)][_0x3067a0],console[_0x118c17(0x471)](_0x118c17(0x103a),_0x3067a0);break;}}if(!_0x41cd68)throw new Error('ZIP文件中未找到图片');const _0x3925b8=await _0x41cd68[_0x118c17(0x7d2)]('blob');console[_0x118c17(0x471)](_0x118c17(0xe2e),_0x3925b8[_0x118c17(0x746)]);const _0xbb7399=new FileReader();_0x4d1cb5=await new Promise((_0x1d48c5,_0x23a939)=>{const _0x4b560d=_0x118c17;_0xbb7399[_0x4b560d(0x12f2)]=()=>_0x1d48c5(_0xbb7399[_0x4b560d(0x9dc)]),_0xbb7399[_0x4b560d(0x1010)]=_0x23a939,_0xbb7399[_0x4b560d(0x5b4)](_0x3925b8);}),console[_0x118c17(0x471)]('✅\x20图片解压成功！');}catch(_0x23a9f1){console[_0x118c17(0x1fd)]('ZIP解压失败:',_0x23a9f1);throw new Error('图片解压失败:\x20'+_0x23a9f1[_0x118c17(0x1288)]);}console[_0x118c17(0x471)](_0x118c17(0x9ad)),_0x4e33f6={..._0x2222c1,'type':_0x118c17(0x88f),'imageUrl':_0x4d1cb5,'prompt':_0x33cc87,'fullPrompt':_0x459dee};}catch(_0x27c22e){console['error']('❌\x20NAI图片生成失败:',_0x27c22e),_0x4e33f6={..._0x2222c1,'content':_0x118c17(0x497)+_0x27c22e[_0x118c17(0x1288)]+']'};}break;default:console['warn']('收到了未知的AI指令类型:',_0x48361e[_0x118c17(0x48c)]);break;}if(_0x4e33f6){_0x1a4b35['history']['push'](_0x4e33f6);!_0x45000b&&(_0x1a4b35['unreadCount']=(_0x1a4b35[_0x118c17(0x3ce)]||0x0)+0x1);if(!_0x45000b&&!_0x3cd3b4){let _0xfe969f;switch(_0x4e33f6['type']){case _0x118c17(0x1075):_0xfe969f='[收到一笔转账]';break;case _0x118c17(0xcd9):_0xfe969f=_0x118c17(0x880);break;case _0x118c17(0x656):_0xfe969f=_0x118c17(0x598);break;case'voice_message':_0xfe969f=_0x118c17(0xc5d);break;case'sticker':_0xfe969f=_0x4e33f6[_0x118c17(0xb5c)]?_0x118c17(0x507)+_0x4e33f6[_0x118c17(0xb5c)]+']':'[表情]';break;case _0x118c17(0x910):_0xfe969f=_0x4e33f6['dialogue']?'「'+_0x4e33f6[_0x118c17(0xa03)]+'」':'['+_0x4e33f6[_0x118c17(0xf6e)][_0x118c17(0x489)](0x0,0x14)+'...]';break;default:_0xfe969f=String(_0x4e33f6[_0x118c17(0x28c)]||'');}const _0x4f88e4=_0x1a4b35[_0x118c17(0x58c)]?_0x4e33f6[_0x118c17(0xcfc)]+':\x20'+_0xfe969f:_0xfe969f;_0x23fbd5(_0x2fd04d,_0x4f88e4[_0x118c17(0x489)](0x0,0x28)+(_0x4f88e4['length']>0x28?_0x118c17(0x1046):'')),_0x3cd3b4=!![];}_0x45000b&&(_0x58deee(_0x4e33f6,_0x1a4b35),await new Promise(_0x3fbcac=>setTimeout(_0x3fbcac,Math[_0x118c17(0xdc6)]()*0x708+0x3e8)));}}_0x50147c&&_0x333dc7[_0x118c17(0x43c)]&&(_0x333dc7[_0x118c17(0xba8)]=![],_0x333dc7['participants'][_0x118c17(0x7aa)]>0x0?_0x11ad56():(_0x333dc7={..._0x333dc7,'isAwaitingResponse':![],'participants':[]},_0x4e6c15(_0x118c17(0x87f)),alert(_0x118c17(0x134d))));if(_0x3752d4){await _0x2e3505();return;}await _0x1a6951[_0x118c17(0x667)][_0x118c17(0xc0f)](_0x1a4b35);const _0x2291e6=_0x3cc643[_0x118c17(0xc5c)](_0x90ab98=>_0x90ab98['type']===_0x118c17(0x8ed)||_0x90ab98['type']===_0x118c17(0xa87)||_0x90ab98[_0x118c17(0x48c)]==='qzone_comment'||_0x90ab98['type']===_0x118c17(0xb95));_0x2291e6&&(console[_0x118c17(0x471)]('检测到AI执行了动态操作，立即刷新好友动态页面。'),await _0x155816());}catch(_0xa7beb9){_0x1a4b35[_0x118c17(0x551)]=_0x1a4b35[_0x118c17(0x551)][_0x118c17(0x3d8)](_0x2de1d5=>!_0x2de1d5['isTemporary']),!_0x1a4b35[_0x118c17(0x58c)]&&_0x1a4b35[_0x118c17(0x1383)]?.[_0x118c17(0x632)]===_0x118c17(0x12d2)?(_0x1a4b35[_0x118c17(0x1383)]['status']=_0x118c17(0x59f),await _0x532f76('申请失败','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20'+_0xa7beb9[_0x118c17(0x1288)])):await _0x532f76(_0x118c17(0x409),_0x118c17(0x46c)+_0xa7beb9['message']),!_0x1a4b35['isGroup']&&_0x1a4b35['relationship']?.[_0x118c17(0x632)]===_0x118c17(0x59f)&&await _0x1a6951['chats'][_0x118c17(0xc0f)](_0x1a4b35),_0x333dc7[_0x118c17(0xba8)]=![];}finally{_0x405b57(_0x2fd04d,![]),_0x1a4b35[_0x118c17(0x58c)]?_0x17bda5&&(_0x17bda5['style'][_0x118c17(0x126b)]=_0x118c17(0x10f2)):_0x42afe3&&_0x5b873d[_0x118c17(0x667)][_0x2fd04d]&&(_0x42afe3[_0x118c17(0x68e)][_0x118c17(0x50d)]=0x0,setTimeout(()=>{const _0x50fd87=_0x118c17;_0x42afe3[_0x50fd87(0xf12)]=_0x5b873d[_0x50fd87(0x667)][_0x2fd04d][_0x50fd87(0xf74)],_0x42afe3[_0x50fd87(0x2f1)][_0x50fd87(0x1247)](_0x50fd87(0xb51)),_0x42afe3[_0x50fd87(0x68e)][_0x50fd87(0x50d)]=0x1;},0xc8)),_0x413d78(),_0xd28886&&_0x402388(_0x2fd04d),_0x47fec8();}}async function _0x2c063a(_0x1def9){const _0x1755b7=_0x41eae2;if(!_0x5b873d[_0x1755b7(0xf96)])return;const _0x3ae61d=_0x5b873d[_0x1755b7(0x667)][_0x5b873d[_0x1755b7(0xf96)]],_0x1b5c51={'role':_0x1755b7(0x116c),'content':_0x1def9[_0x1755b7(0x11de)],'meaning':_0x1def9[_0x1755b7(0xf74)],'timestamp':Date[_0x1755b7(0xf1a)]()};_0x3ae61d[_0x1755b7(0x551)][_0x1755b7(0x138c)](_0x1b5c51),await _0x1a6951[_0x1755b7(0x667)][_0x1755b7(0xc0f)](_0x3ae61d),_0x58deee(_0x1b5c51,_0x3ae61d),_0x413d78(),document['getElementById']('sticker-panel')[_0x1755b7(0x2f1)][_0x1755b7(0x1247)]('visible');}async function _0x1f42bb(){const _0x461402=_0x41eae2;if(!_0x5b873d[_0x461402(0xf96)])return;const _0x41f18a=document[_0x461402(0x89d)](_0x461402(0xa48)),_0x5bf37f=document[_0x461402(0x89d)]('transfer-note'),_0xffa46a=parseFloat(_0x41f18a[_0x461402(0x2f4)]),_0x565a4f=_0x5bf37f['value'][_0x461402(0xc3a)]();if(isNaN(_0xffa46a)||_0xffa46a<0x0){alert('请输入有效的金额(必须大于0)！');return;}const _0x3ce95d=_0x5b873d[_0x461402(0x667)][_0x5b873d[_0x461402(0xf96)]],_0x34d492=_0x3ce95d['isGroup']?_0x3ce95d[_0x461402(0xdb9)][_0x461402(0xc48)]||'我':'我',_0x47653a=_0x3ce95d[_0x461402(0x58c)]?'群聊':_0x3ce95d[_0x461402(0xf74)],_0x384ecd={'role':'user','type':_0x461402(0x1075),'amount':_0xffa46a,'note':_0x565a4f,'senderName':_0x34d492,'receiverName':_0x47653a,'timestamp':Date[_0x461402(0xf1a)]()};_0x3ce95d[_0x461402(0x551)][_0x461402(0x138c)](_0x384ecd),await _0x1a6951[_0x461402(0x667)][_0x461402(0xc0f)](_0x3ce95d),_0x58deee(_0x384ecd,_0x3ce95d),_0x413d78(),document[_0x461402(0x89d)](_0x461402(0xc88))[_0x461402(0x2f1)]['remove'](_0x461402(0x11e4)),_0x41f18a[_0x461402(0x2f4)]='',_0x5bf37f[_0x461402(0x2f4)]='';}async function _0x3bccb8(){const _0x56c817=_0x41eae2;if(!_0x5b873d[_0x56c817(0xf96)])return;const _0x2c8693=document[_0x56c817(0x89d)](_0x56c817(0x2dd)),_0x65ef4a=document[_0x56c817(0x89d)]('waimai-amount'),_0x557a74=_0x2c8693['value'][_0x56c817(0xc3a)](),_0x26dc78=parseFloat(_0x65ef4a['value']);if(!_0x557a74||isNaN(_0x26dc78)||_0x26dc78<=0x0){alert(_0x56c817(0x1041));return;}const _0x408d88=_0x5b873d[_0x56c817(0x667)][_0x5b873d[_0x56c817(0xf96)]],_0x5b4560=Date[_0x56c817(0xf1a)](),_0x5402bf=_0x408d88['isGroup']?_0x408d88[_0x56c817(0xdb9)]['myNickname']||'我':'我',_0x591b13={'role':_0x56c817(0x116c),'senderName':_0x5402bf,'type':'waimai_order','productInfo':_0x557a74,'amount':_0x26dc78,'timestamp':_0x5b4560};_0x408d88[_0x56c817(0x551)][_0x56c817(0x138c)](_0x591b13);const _0x541239={'role':_0x56c817(0x18c),'content':_0x56c817(0x3de)+_0x5402bf+')为你点了一份外卖作为【礼物】。外卖内容是“'+_0x557a74+_0x56c817(0x2d3)+_0x26dc78+_0x56c817(0x45d),'timestamp':_0x5b4560+0x1,'isHidden':!![]};_0x408d88['history'][_0x56c817(0x138c)](_0x541239),await _0x1a6951[_0x56c817(0x667)][_0x56c817(0xc0f)](_0x408d88),_0x58deee(_0x591b13,_0x408d88),_0x413d78(),_0x2c8693['value']='',_0x65ef4a['value']='',document[_0x56c817(0x89d)](_0x56c817(0x5de))[_0x56c817(0x2f1)]['remove'](_0x56c817(0x11e4));}async function _0x998a83(){const _0x1978ad=_0x41eae2;if(!_0x5b873d[_0x1978ad(0xf96)])return;const _0x98e19c=await _0x34d246(_0x1978ad(0x12da),_0x1978ad(0x1a3),'');if(!_0x98e19c||!_0x98e19c[_0x1978ad(0xc3a)]())return;const _0x69a643=_0x1978ad(0xc0b),_0x4aae28=_0x5b873d['chats'][_0x5b873d[_0x1978ad(0xf96)]],_0x9c3d32={'role':_0x1978ad(0x116c),'type':_0x1978ad(0x873),'content':_0x98e19c[_0x1978ad(0xc3a)](),'imageUrl':_0x69a643,'timestamp':Date['now']()};_0x4aae28[_0x1978ad(0x551)][_0x1978ad(0x138c)](_0x9c3d32),await _0x1a6951[_0x1978ad(0x667)][_0x1978ad(0xc0f)](_0x4aae28),_0x58deee(_0x9c3d32,_0x4aae28),_0x413d78();}function _0x3bf0ee(_0x1fdf11){const _0x32f60e=_0x41eae2;if(_0x17f18d)return;_0x17f18d=!![],document[_0x32f60e(0x89d)]('chat-interface-screen')[_0x32f60e(0x2f1)]['add'](_0x32f60e(0x12ed)),_0x465a2d(_0x1fdf11);}function _0x4ec1fb(){const _0x4b6bfb=_0x41eae2;_0x35a054();if(!_0x17f18d)return;_0x17f18d=![],document['getElementById'](_0x4b6bfb(0x87f))['classList'][_0x4b6bfb(0x1247)](_0x4b6bfb(0x12ed)),_0x2b125e['forEach'](_0x37ff43=>{const _0x42836e=_0x4b6bfb,_0x381f63=document[_0x42836e(0xd16)](_0x42836e(0x806)+_0x37ff43+'\x22]');if(_0x381f63)_0x381f63[_0x42836e(0x2f1)][_0x42836e(0x1247)](_0x42836e(0x335));}),_0x2b125e['clear']();}function _0x465a2d(_0x25733a){const _0x4193ed=_0x41eae2,_0x1f9c79=document[_0x4193ed(0xd16)](_0x4193ed(0x806)+_0x25733a+'\x22]');if(!_0x1f9c79)return;_0x2b125e[_0x4193ed(0xa14)](_0x25733a)?(_0x2b125e[_0x4193ed(0x684)](_0x25733a),_0x1f9c79[_0x4193ed(0x2f1)][_0x4193ed(0x1247)](_0x4193ed(0x335))):(_0x2b125e['add'](_0x25733a),_0x1f9c79[_0x4193ed(0x2f1)]['add'](_0x4193ed(0x335))),document[_0x4193ed(0x89d)](_0x4193ed(0x1140))[_0x4193ed(0xf12)]=_0x4193ed(0xda7)+_0x2b125e[_0x4193ed(0x746)]+'\x20条',_0x2b125e[_0x4193ed(0x746)]===0x0&&_0x4ec1fb();}function _0xefe9e2(_0x1485c9,_0x3bce2b){const _0x175645=_0x41eae2;let _0x1a2174;const _0x4d6840=_0x2cb4f7=>{const _0x2c3b80=_0x356e;if(_0x17f18d)return;_0x2cb4f7['preventDefault'](),_0x1a2174=window[_0x2c3b80(0x65a)](()=>_0x3bce2b(_0x2cb4f7),0x1f4);},_0x26ddfe=()=>clearTimeout(_0x1a2174);_0x1485c9[_0x175645(0x1193)](_0x175645(0x898),_0x4d6840),_0x1485c9[_0x175645(0x1193)](_0x175645(0x1dd),_0x26ddfe),_0x1485c9[_0x175645(0x1193)]('mouseleave',_0x26ddfe),_0x1485c9[_0x175645(0x1193)](_0x175645(0x74f),_0x4d6840,{'passive':!![]}),_0x1485c9[_0x175645(0x1193)]('touchend',_0x26ddfe),_0x1485c9[_0x175645(0x1193)]('touchmove',_0x26ddfe);}async function _0x14f55b(){const _0x2f9b04=_0x41eae2,_0x3fd3d7=_0x5b873d[_0x2f9b04(0xf96)];if(!_0x3fd3d7)return;if(!_0x1f2ed8[_0x2f9b04(0xfcb)]){_0x52c162(_0x3fd3d7);return;}if(_0x1f2ed8[_0x2f9b04(0xf96)]===_0x3fd3d7)document[_0x2f9b04(0x89d)](_0x2f9b04(0x64c))[_0x2f9b04(0x2f1)][_0x2f9b04(0x569)](_0x2f9b04(0x11e4));else{const _0x142774=_0x5b873d[_0x2f9b04(0x667)][_0x1f2ed8[_0x2f9b04(0xf96)]]?.[_0x2f9b04(0xf74)]||'未知',_0x2c167f=_0x5b873d[_0x2f9b04(0x667)][_0x3fd3d7]?.['name']||'当前',_0x3d43b2=await _0x4e2abc('切换听歌对象',_0x2f9b04(0x105c)+_0x142774+_0x2f9b04(0xce0)+_0x2c167f+_0x2f9b04(0x424),{'confirmButtonClass':_0x2f9b04(0xcd8)});_0x3d43b2&&(await _0x3a104a(!![]),await new Promise(_0x1680c4=>setTimeout(_0x1680c4,0x32)),_0x52c162(_0x3fd3d7));}}async function _0x52c162(_0x341e75){const _0xd79774=_0x41eae2,_0x432cdd=_0x5b873d[_0xd79774(0x667)][_0x341e75];if(!_0x432cdd)return;_0x1f2ed8[_0xd79774(0xe71)]=_0x432cdd[_0xd79774(0x34a)][_0xd79774(0xeaa)]||0x0,_0x1f2ed8['isActive']=!![],_0x1f2ed8[_0xd79774(0xf96)]=_0x341e75;_0x1f2ed8[_0xd79774(0x2c0)][_0xd79774(0x7aa)]>0x0?_0x1f2ed8[_0xd79774(0x602)]=0x0:_0x1f2ed8[_0xd79774(0x602)]=-0x1;if(_0x1f2ed8[_0xd79774(0xc59)])clearInterval(_0x1f2ed8[_0xd79774(0xc59)]);_0x1f2ed8[_0xd79774(0xc59)]=setInterval(()=>{_0x1f2ed8['isPlaying']&&(_0x1f2ed8['totalElapsedTime']++,_0x507edc());},0x3e8),_0x2f3a2e(),_0x45027b(),document[_0xd79774(0x89d)]('music-player-overlay')[_0xd79774(0x2f1)][_0xd79774(0x569)](_0xd79774(0x11e4));}async function _0x3a104a(_0x36162f=!![]){const _0x25dc27=_0x41eae2;if(!_0x1f2ed8[_0x25dc27(0xfcb)])return;const _0x484038=_0x1f2ed8['activeChatId'];document[_0x25dc27(0x89d)](_0x25dc27(0x33d))['classList'][_0x25dc27(0x1247)]('visible');const _0x56165d=async()=>{const _0x5a84ff=_0x25dc27;if(_0x1f2ed8[_0x5a84ff(0xc59)])clearInterval(_0x1f2ed8['timerId']);if(_0x1f2ed8[_0x5a84ff(0xaa4)])_0x1e10c1[_0x5a84ff(0xfb2)]();if(_0x36162f&&_0x484038&&_0x5b873d[_0x5a84ff(0x667)][_0x484038]){const _0x3e9d13=_0x5b873d['chats'][_0x484038];_0x3e9d13[_0x5a84ff(0x34a)][_0x5a84ff(0xeaa)]=_0x1f2ed8[_0x5a84ff(0xe71)],await _0x1a6951[_0x5a84ff(0x667)][_0x5a84ff(0xc0f)](_0x3e9d13);}_0x1f2ed8[_0x5a84ff(0xfcb)]=![],_0x1f2ed8[_0x5a84ff(0xf96)]=null,_0x1f2ed8[_0x5a84ff(0xe71)]=0x0,_0x1f2ed8['timerId']=null,_0x12aeff(_0x484038,!![]);};_0x42a798(_0x56165d);}function _0x494176(){_0x42a798();}function _0x12aeff(_0x1a14ea,_0x2ab035=![]){const _0x553047=_0x41eae2,_0x2328ad=document['querySelector'](_0x553047(0x406));if(!_0x2328ad)return;if(_0x2ab035||!_0x1f2ed8[_0x553047(0xfcb)]||_0x1f2ed8[_0x553047(0xf96)]!==_0x1a14ea){_0x2328ad[_0x553047(0x9e3)]=_0x553047(0x1307),_0x2328ad['className']='';return;}_0x2328ad[_0x553047(0x9e3)]=_0x553047(0x1053),_0x2328ad[_0x553047(0x2f1)][_0x553047(0x569)]('rotating');if(_0x1f2ed8[_0x553047(0xaa4)])_0x2328ad[_0x553047(0x2f1)][_0x553047(0x1247)](_0x553047(0xc80));else _0x2328ad[_0x553047(0x2f1)][_0x553047(0x569)](_0x553047(0xc80));}window[_0x41eae2(0xbd7)]=_0x12aeff;function _0x2f3a2e(){const _0x331e4a=_0x41eae2;_0x12aeff(_0x1f2ed8[_0x331e4a(0xf96)]),_0x507edc();const _0x1d9fe2=document[_0x331e4a(0x89d)](_0x331e4a(0x11b2)),_0x49c634=document[_0x331e4a(0x89d)](_0x331e4a(0xa24)),_0x1fd7a8=document[_0x331e4a(0x89d)]('music-play-pause-btn');if(_0x1f2ed8['currentIndex']>-0x1&&_0x1f2ed8[_0x331e4a(0x2c0)][_0x331e4a(0x7aa)]>0x0){const _0x586b87=_0x1f2ed8['playlist'][_0x1f2ed8[_0x331e4a(0x602)]];_0x1d9fe2[_0x331e4a(0xf12)]=_0x586b87[_0x331e4a(0xf74)],_0x49c634[_0x331e4a(0xf12)]=_0x586b87[_0x331e4a(0x1196)];}else _0x1d9fe2[_0x331e4a(0xf12)]=_0x331e4a(0xc3b),_0x49c634[_0x331e4a(0xf12)]=_0x331e4a(0x1046);_0x1fd7a8[_0x331e4a(0xf12)]=_0x1f2ed8[_0x331e4a(0xaa4)]?'❚❚':'▶';}function _0x507edc(){const _0xfc6343=_0x41eae2,_0x2f9c01=(_0x1f2ed8[_0xfc6343(0xe71)]/0xe10)[_0xfc6343(0x8f7)](0x1);document[_0xfc6343(0x89d)](_0xfc6343(0xd37))[_0xfc6343(0xf12)]=_0xfc6343(0x9be)+_0x2f9c01+'小时';}function _0x45027b(){const _0x3cd119=_0x41eae2,_0x4b0ec1=document[_0x3cd119(0x89d)](_0x3cd119(0x1171));_0x4b0ec1['innerHTML']='';if(_0x1f2ed8[_0x3cd119(0x2c0)][_0x3cd119(0x7aa)]===0x0){_0x4b0ec1[_0x3cd119(0x1ef)]=_0x3cd119(0xf6a);return;}_0x1f2ed8[_0x3cd119(0x2c0)][_0x3cd119(0xd9a)]((_0x4a1962,_0x103674)=>{const _0x30e81f=_0x3cd119,_0x237e70=document[_0x30e81f(0x285)](_0x30e81f(0xb25));_0x237e70['className']='playlist-item';if(_0x103674===_0x1f2ed8['currentIndex'])_0x237e70[_0x30e81f(0x2f1)][_0x30e81f(0x569)](_0x30e81f(0x51c));_0x237e70['innerHTML']='\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x4a1962[_0x30e81f(0xf74)]+_0x30e81f(0x7b7)+_0x4a1962[_0x30e81f(0x1196)]+_0x30e81f(0x4fc)+_0x103674+_0x30e81f(0x12d3)+_0x103674+_0x30e81f(0x24b)+_0x103674+_0x30e81f(0x3f1)+_0x103674+'\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a',_0x237e70['querySelector'](_0x30e81f(0x5bd))[_0x30e81f(0x1193)](_0x30e81f(0x12a5),()=>_0x1eec83(_0x103674)),_0x4b0ec1[_0x30e81f(0x22f)](_0x237e70);});}async function _0x24160d(){const _0x520e34=_0x41eae2;if(_0x1e10c1['paused']){if(_0x1f2ed8[_0x520e34(0x602)]===-0x1&&_0x1f2ed8[_0x520e34(0x2c0)][_0x520e34(0x7aa)]>0x0)_0x1eec83(0x0);else _0x1f2ed8[_0x520e34(0x602)]>-0x1&&_0x1eec83(_0x1f2ed8[_0x520e34(0x602)]);}else _0x1e10c1[_0x520e34(0xfb2)](),await _0x1607b5('暂停了音乐');}function _0x23b31a(){const _0x3dcc8b=_0x41eae2;if(_0x1f2ed8[_0x3dcc8b(0x2c0)][_0x3dcc8b(0x7aa)]===0x0)return;let _0x3f3040;switch(_0x1f2ed8[_0x3dcc8b(0x89c)]){case _0x3dcc8b(0xdc6):_0x3f3040=Math[_0x3dcc8b(0x128a)](Math['random']()*_0x1f2ed8['playlist'][_0x3dcc8b(0x7aa)]);break;case _0x3dcc8b(0x42f):_0x1eec83(_0x1f2ed8[_0x3dcc8b(0x602)]);return;case _0x3dcc8b(0x7ed):default:_0x3f3040=(_0x1f2ed8[_0x3dcc8b(0x602)]+0x1)%_0x1f2ed8[_0x3dcc8b(0x2c0)][_0x3dcc8b(0x7aa)];break;}_0x1eec83(_0x3f3040);}function _0x1fd61a(){const _0x50a5fd=_0x41eae2;if(_0x1f2ed8[_0x50a5fd(0x2c0)][_0x50a5fd(0x7aa)]===0x0)return;const _0x148b9=(_0x1f2ed8[_0x50a5fd(0x602)]-0x1+_0x1f2ed8['playlist']['length'])%_0x1f2ed8[_0x50a5fd(0x2c0)][_0x50a5fd(0x7aa)];_0x1eec83(_0x148b9);}function _0x29681b(){const _0x1f09f0=_0x41eae2,_0x5795d3=[_0x1f09f0(0x7ed),'random',_0x1f09f0(0x42f)],_0x5f018a=_0x5795d3[_0x1f09f0(0x37c)](_0x1f2ed8['playMode']);_0x1f2ed8[_0x1f09f0(0x89c)]=_0x5795d3[(_0x5f018a+0x1)%_0x5795d3[_0x1f09f0(0x7aa)]],document[_0x1f09f0(0x89d)]('music-mode-btn')['textContent']={'order':'顺序','random':'随机','single':'单曲'}[_0x1f2ed8[_0x1f09f0(0x89c)]];}async function _0x2e13a0(){const _0x2f135d=_0x41eae2,_0x5db030=await _0x34d246(_0x2f135d(0x7f9),'请输入歌曲的URL','',_0x2f135d(0x11de));if(!_0x5db030)return;const _0x33e2b9=await _0x34d246('歌曲信息','请输入歌名');if(!_0x33e2b9)return;const _0x3aeaf5=await _0x34d246('歌曲信息',_0x2f135d(0x39a));if(!_0x3aeaf5)return;_0x1f2ed8[_0x2f135d(0x2c0)][_0x2f135d(0x138c)]({'name':_0x33e2b9,'artist':_0x3aeaf5,'src':_0x5db030,'isLocal':![]}),await _0x4ae954(),_0x45027b(),_0x1f2ed8[_0x2f135d(0x602)]===-0x1&&(_0x1f2ed8[_0x2f135d(0x602)]=_0x1f2ed8[_0x2f135d(0x2c0)]['length']-0x1,_0x2f3a2e());}async function _0x50e2bc(_0x42f9ed){const _0x4e0d74=_0x41eae2,_0x5802ec=_0x42f9ed[_0x4e0d74(0x225)]['files'];if(!_0x5802ec[_0x4e0d74(0x7aa)])return;for(const _0x28b9c8 of _0x5802ec){let _0x97133f=_0x28b9c8['name']['replace'](/\.[^/.]+$/,'');_0x97133f=await _0x34d246(_0x4e0d74(0x1000),_0x4e0d74(0xeb2),_0x97133f);if(_0x97133f===null)continue;const _0x5a98f2=await _0x34d246('歌曲信息','请输入歌手名',_0x4e0d74(0xfca));if(_0x5a98f2===null)continue;const _0x534424=await _0x28b9c8[_0x4e0d74(0x4a9)]();let _0x2d9e5c='';const _0x7f0c10=await _0x4e2abc('导入歌词',_0x4e0d74(0x1104)+_0x97133f+_0x4e0d74(0xfd3));_0x7f0c10&&(_0x2d9e5c=await _0x5e8d5a()||''),_0x1f2ed8[_0x4e0d74(0x2c0)][_0x4e0d74(0x138c)]({'name':_0x97133f,'artist':_0x5a98f2,'src':_0x534424,'fileType':_0x28b9c8[_0x4e0d74(0x48c)],'isLocal':!![],'lrcContent':_0x2d9e5c,'cover':_0x4e0d74(0xdd8)});}await _0x4ae954(),_0x45027b(),_0x1f2ed8[_0x4e0d74(0x602)]===-0x1&&_0x1f2ed8['playlist'][_0x4e0d74(0x7aa)]>0x0&&(_0x1f2ed8[_0x4e0d74(0x602)]=0x0,_0x2f3a2e()),_0x42f9ed[_0x4e0d74(0x225)][_0x4e0d74(0x2f4)]=null;}async function _0x1eec83(_0x542dd4){const _0x367984=_0x41eae2;if(_0x542dd4<0x0||_0x542dd4>=_0x1f2ed8[_0x367984(0x2c0)][_0x367984(0x7aa)])return;_0x1e10c1[_0x367984(0xfb2)](),_0x1f2ed8[_0x367984(0x602)]=_0x542dd4;const _0x55f639=_0x1f2ed8[_0x367984(0x2c0)][_0x542dd4],_0x4a55a4=_0x5b873d['chats'][_0x1f2ed8['activeChatId']],_0xfdf1a3=document[_0x367984(0x89d)]('music-player-avatar-display');if(_0x4a55a4&&_0xfdf1a3){_0xfdf1a3['innerHTML']='';const _0xa952ea=_0x4a55a4[_0x367984(0x58c)]?_0x4a55a4[_0x367984(0x5ab)][_0x367984(0x12f4)](_0x4f1e84=>_0x4f1e84[_0x367984(0x1045)]===_0x55f639['artist'])?.['avatar']||_0x265fcc:_0x4a55a4[_0x367984(0xdb9)][_0x367984(0xdd3)]||_0x265fcc,_0x2560a6=_0x4a55a4[_0x367984(0xdb9)][_0x367984(0xd55)]||_0x265fcc,_0x181c3f=document[_0x367984(0x285)](_0x367984(0xc40));_0x181c3f['src']=_0xa952ea,_0x181c3f[_0x367984(0x81c)]=_0x367984(0x74c),_0x181c3f['alt']=_0x367984(0xeac),_0xfdf1a3['appendChild'](_0x181c3f);const _0x1251c0=document[_0x367984(0x285)](_0x367984(0xc40));_0x1251c0['src']=_0x2560a6,_0x1251c0['className']='participant-display-avatar',_0x1251c0[_0x367984(0x101d)]=_0x367984(0xb44),_0xfdf1a3['appendChild'](_0x1251c0);}const _0x318845=document[_0x367984(0xd16)](_0x367984(0xa4a)),_0x34f4a6=document[_0x367984(0x89d)](_0x367984(0xb04));_0x318845&&(_0x318845[_0x367984(0x68e)][_0x367984(0xdcf)](_0x367984(0xcea),_0x55f639[_0x367984(0x55c)]?_0x367984(0xa0c)+_0x55f639[_0x367984(0x55c)]+')':_0x367984(0x10f2)),_0x318845[_0x367984(0x2f1)][_0x367984(0x73b)](_0x367984(0x5a8),!!_0x55f639['isBgClear']));_0x34f4a6&&_0x34f4a6[_0x367984(0x2f1)][_0x367984(0x73b)](_0x367984(0x8ea),!!_0x55f639[_0x367984(0x491)]);document[_0x367984(0x89d)](_0x367984(0xd04))[_0x367984(0x2f1)]['remove'](_0x367984(0xd75));const _0x2c92b6=document[_0x367984(0x89d)](_0x367984(0xec0));_0x2c92b6&&(_0x2c92b6['src']=_0x55f639[_0x367984(0x81f)]||_0x367984(0xdd8));await _0x1607b5('将歌曲切换为了《'+_0x55f639[_0x367984(0xf74)]+'》'),_0x1f2ed8[_0x367984(0x10c2)]=_0x39f66b(_0x55f639[_0x367984(0xd42)]||''),_0x1673be();const _0x3de8db=document[_0x367984(0x89d)](_0x367984(0x7cd));_0x3de8db&&(!_0x1f2ed8[_0x367984(0x10c2)]||_0x1f2ed8[_0x367984(0x10c2)][_0x367984(0x7aa)]===0x0?_0x3de8db['textContent']='纯音乐，请欣赏':_0x3de8db['textContent']='♪\x20♪\x20♪');if(_0x55f639[_0x367984(0x2ab)]&&_0x55f639[_0x367984(0x9e3)]instanceof ArrayBuffer){const _0x44f5bf=new Blob([_0x55f639[_0x367984(0x9e3)]],{'type':_0x55f639['fileType']||_0x367984(0x8a4)});_0x1e10c1[_0x367984(0x9e3)]=URL[_0x367984(0xfc3)](_0x44f5bf);}else{if(_0x55f639['isLocal']&&_0x55f639[_0x367984(0x9e3)]instanceof Blob)_0x1e10c1[_0x367984(0x9e3)]=URL[_0x367984(0xfc3)](_0x55f639[_0x367984(0x9e3)]);else{if(!_0x55f639[_0x367984(0x2ab)])_0x1e10c1['src']=_0x55f639[_0x367984(0x9e3)];else{console[_0x367984(0x1fd)](_0x367984(0x410),_0x55f639);return;}}}const _0x3d880f=_0x1e10c1['play']();_0x3d880f!==undefined&&_0x3d880f[_0x367984(0x1035)](_0x5a48cb=>{const _0x190a72=_0x367984;if(_0x5a48cb[_0x190a72(0xf74)]===_0x190a72(0x10ab))console[_0x190a72(0xac3)](_0x190a72(0x753)),_0x1e10c1[_0x190a72(0xfb2)](),_0x532f76('播放已暂停',_0x190a72(0x33b));else _0x5a48cb[_0x190a72(0xf74)]!==_0x190a72(0x5c7)&&console['error']('Playback\x20error:',_0x5a48cb);});_0x45027b(),_0x2f3a2e(),_0x4d0c38();const _0x29556e=document[_0x367984(0x89d)](_0x367984(0x33d));_0x1f2ed8[_0x367984(0x10c2)]&&_0x1f2ed8[_0x367984(0x10c2)][_0x367984(0x7aa)]>0x0?(_0x29556e[_0x367984(0xf12)]='♪',_0x29556e['classList'][_0x367984(0x569)](_0x367984(0x11e4))):_0x29556e[_0x367984(0x2f1)][_0x367984(0x1247)]('visible');}async function _0x2ab862(_0x4be31b){const _0x4aec20=_0x41eae2;if(_0x4be31b<0x0||_0x4be31b>=_0x1f2ed8[_0x4aec20(0x2c0)][_0x4aec20(0x7aa)])return;const _0x211dc7=await _0x4d923b(_0x4aec20(0x54c),[{'text':_0x4aec20(0x93c),'value':'local'},{'text':'🌐\x20使用网络URL','value':_0x4aec20(0x11de)}]);let _0x40af58=null;if(_0x211dc7===_0x4aec20(0x586))_0x40af58=await _0x240760();else _0x211dc7===_0x4aec20(0x11de)&&(_0x40af58=await _0x34d246(_0x4aec20(0x11cf),_0x4aec20(0x1114),'',_0x4aec20(0x11de)));if(_0x40af58&&_0x40af58['trim']()){_0x1f2ed8[_0x4aec20(0x2c0)][_0x4be31b][_0x4aec20(0x55c)]=_0x40af58[_0x4aec20(0xc3a)](),await _0x4ae954();if(_0x1f2ed8[_0x4aec20(0x602)]===_0x4be31b){const _0x1192c5=document[_0x4aec20(0xd16)](_0x4aec20(0xa4a));_0x1192c5[_0x4aec20(0x68e)][_0x4aec20(0xdcf)](_0x4aec20(0xcea),_0x4aec20(0xa0c)+_0x40af58[_0x4aec20(0xc3a)]()+')');}await _0x532f76('成功',_0x4aec20(0x3a8));}}async function _0x124c87(_0x3cf08a){const _0x22198b=_0x41eae2;if(_0x3cf08a<0x0||_0x3cf08a>=_0x1f2ed8['playlist']['length'])return;const _0x399f6b=await _0x4d923b(_0x22198b(0x1089),[{'text':_0x22198b(0x93c),'value':_0x22198b(0x586)},{'text':'🌐\x20使用网络URL','value':_0x22198b(0x11de)}]);let _0x39c4f1=null;if(_0x399f6b===_0x22198b(0x586))_0x39c4f1=await _0x240760();else _0x399f6b==='url'&&(_0x39c4f1=await _0x34d246('输入图片URL',_0x22198b(0x1379),'',_0x22198b(0x11de)));if(_0x39c4f1&&_0x39c4f1[_0x22198b(0xc3a)]()){_0x1f2ed8[_0x22198b(0x2c0)][_0x3cf08a][_0x22198b(0x81f)]=_0x39c4f1[_0x22198b(0xc3a)](),await _0x4ae954();if(_0x1f2ed8['currentIndex']===_0x3cf08a){document['getElementById'](_0x22198b(0xec0))[_0x22198b(0x9e3)]=_0x39c4f1[_0x22198b(0xc3a)]();const _0x2ec115=document[_0x22198b(0xd16)](_0x22198b(0x379));if(_0x2ec115)_0x2ec115['src']=_0x39c4f1['trim']();}await _0x532f76('成功',_0x22198b(0xf5c));}}async function _0x141d2c(_0x4077f0){const _0x2053b2=_0x41eae2;if(_0x4077f0<0x0||_0x4077f0>=_0x1f2ed8[_0x2053b2(0x2c0)][_0x2053b2(0x7aa)])return;const _0x2cd11a=_0x1f2ed8[_0x2053b2(0x2c0)][_0x4077f0],_0x477f8a=_0x1f2ed8['isPlaying']&&_0x1f2ed8[_0x2053b2(0x602)]===_0x4077f0;if(_0x2cd11a[_0x2053b2(0x2ab)]&&_0x1e10c1[_0x2053b2(0x9e3)]['startsWith']('blob:')&&_0x1f2ed8['currentIndex']===_0x4077f0)URL[_0x2053b2(0xa1c)](_0x1e10c1[_0x2053b2(0x9e3)]);_0x1f2ed8['playlist'][_0x2053b2(0x776)](_0x4077f0,0x1),await _0x4ae954();if(_0x1f2ed8[_0x2053b2(0x2c0)]['length']===0x0){if(_0x1f2ed8[_0x2053b2(0xaa4)])_0x1e10c1[_0x2053b2(0xfb2)]();_0x1e10c1[_0x2053b2(0x9e3)]='',_0x1f2ed8['currentIndex']=-0x1,_0x1f2ed8['isPlaying']=![];}else{if(_0x477f8a)_0x23b31a();else{if(_0x1f2ed8[_0x2053b2(0x602)]>=_0x4077f0)_0x1f2ed8[_0x2053b2(0x602)]=Math[_0x2053b2(0x88d)](0x0,_0x1f2ed8[_0x2053b2(0x602)]-0x1);}}_0x2f3a2e(),_0x45027b();}async function _0x50e2bc(_0x525a61){const _0x4c671a=_0x41eae2,_0xd886d=_0x525a61[_0x4c671a(0x225)][_0x4c671a(0x541)];if(!_0xd886d[_0x4c671a(0x7aa)])return;for(const _0x255054 of _0xd886d){let _0x4b3ad9=_0x255054[_0x4c671a(0xf74)][_0x4c671a(0xfbf)](/\.[^/.]+$/,'');_0x4b3ad9=await _0x34d246(_0x4c671a(0x1000),_0x4c671a(0xeb2),_0x4b3ad9);if(_0x4b3ad9===null)continue;const _0x4897c3=await _0x34d246('歌曲信息',_0x4c671a(0x39a),_0x4c671a(0xfca));if(_0x4897c3===null)continue;let _0xba2f77='';const _0x6673e1=await _0x4e2abc('导入歌词','要为《'+_0x4b3ad9+_0x4c671a(0xfd3));_0x6673e1&&(_0xba2f77=await _0x5e8d5a()||''),_0x1f2ed8[_0x4c671a(0x2c0)][_0x4c671a(0x138c)]({'name':_0x4b3ad9,'artist':_0x4897c3,'src':_0x255054,'isLocal':!![],'lrcContent':_0xba2f77});}await _0x4ae954(),_0x45027b(),_0x1f2ed8['currentIndex']===-0x1&&_0x1f2ed8['playlist'][_0x4c671a(0x7aa)]>0x0&&(_0x1f2ed8[_0x4c671a(0x602)]=0x0,_0x2f3a2e()),_0x525a61[_0x4c671a(0x225)][_0x4c671a(0x2f4)]=null;}async function _0x141d2c(_0xa6c6cc){const _0x48b9d0=_0x41eae2;if(_0xa6c6cc<0x0||_0xa6c6cc>=_0x1f2ed8[_0x48b9d0(0x2c0)][_0x48b9d0(0x7aa)])return;const _0x49e0a6=_0x1f2ed8['playlist'][_0xa6c6cc],_0x4694e1=_0x1f2ed8[_0x48b9d0(0xaa4)]&&_0x1f2ed8[_0x48b9d0(0x602)]===_0xa6c6cc;if(_0x49e0a6[_0x48b9d0(0x2ab)]&&_0x1e10c1[_0x48b9d0(0x9e3)][_0x48b9d0(0x1222)]('blob:')&&_0x1f2ed8['currentIndex']===_0xa6c6cc)URL[_0x48b9d0(0xa1c)](_0x1e10c1[_0x48b9d0(0x9e3)]);_0x1f2ed8[_0x48b9d0(0x2c0)]['splice'](_0xa6c6cc,0x1),await _0x4ae954();if(_0x1f2ed8[_0x48b9d0(0x2c0)][_0x48b9d0(0x7aa)]===0x0){if(_0x1f2ed8['isPlaying'])_0x1e10c1['pause']();_0x1e10c1[_0x48b9d0(0x9e3)]='',_0x1f2ed8[_0x48b9d0(0x602)]=-0x1,_0x1f2ed8[_0x48b9d0(0xaa4)]=![];}else{if(_0x4694e1)_0x23b31a();else{if(_0x1f2ed8[_0x48b9d0(0x602)]>=_0xa6c6cc)_0x1f2ed8[_0x48b9d0(0x602)]=Math[_0x48b9d0(0x88d)](0x0,_0x1f2ed8[_0x48b9d0(0x602)]-0x1);}}_0x2f3a2e(),_0x45027b();}const _0x54865a=document[_0x41eae2(0x89d)](_0x41eae2(0x86d)),_0x44616d=document[_0x41eae2(0x89d)](_0x41eae2(0x12df)),_0x48446b=document[_0x41eae2(0x89d)](_0x41eae2(0x78e));function _0x4556a6(){const _0x54ca60=_0x41eae2;_0x1e01a0(),_0x54865a['classList'][_0x54ca60(0x569)](_0x54ca60(0x11e4));}function _0x4af853(){const _0x31129b=_0x41eae2;_0x54865a['classList'][_0x31129b(0x1247)](_0x31129b(0x11e4));}function _0x1e01a0(){const _0x35df93=_0x41eae2,_0x4d9e73=document[_0x35df93(0x89d)](_0x35df93(0x1197));_0x4d9e73[_0x35df93(0x1ef)]='';if(_0x5b873d[_0x35df93(0x27c)][_0x35df93(0x7aa)]===0x0){_0x4d9e73['innerHTML']=_0x35df93(0xbd2);return;}_0x5b873d[_0x35df93(0x27c)][_0x35df93(0xd9a)](_0x2aebf8=>{const _0x40d671=_0x35df93,_0x529f7c=document[_0x40d671(0x285)](_0x40d671(0xb25));_0x529f7c[_0x40d671(0x81c)]=_0x40d671(0xb00),_0x529f7c['style'][_0x40d671(0x1d4)]='url('+_0x2aebf8[_0x40d671(0x12c8)]+')',_0x529f7c[_0x40d671(0xaaf)]['presetId']=_0x2aebf8['id'],_0x529f7c['addEventListener'](_0x40d671(0x12a5),()=>_0x2c39e1(_0x2aebf8['id'])),_0xefe9e2(_0x529f7c,()=>_0x3af887(_0x2aebf8['id'])),_0x4d9e73[_0x40d671(0x22f)](_0x529f7c);});}function _0x3af887(_0xa8ed8){const _0x493ce4=_0x41eae2;_0x589eec=_0xa8ed8,_0x48446b[_0x493ce4(0x2f1)][_0x493ce4(0x569)](_0x493ce4(0x11e4));}function _0x5b4fad(){const _0xcaf1e1=_0x41eae2;_0x48446b[_0xcaf1e1(0x2f1)]['remove']('visible'),_0x589eec=null;}function _0x2c39e1(_0x473e32){const _0x475b32=_0x41eae2,_0x39f1bb=_0x5b873d[_0x475b32(0x27c)][_0x475b32(0x12f4)](_0x9a2c5a=>_0x9a2c5a['id']===_0x473e32);_0x39f1bb&&(document[_0x475b32(0x89d)](_0x475b32(0x1255))['src']=_0x39f1bb['avatar'],document[_0x475b32(0x89d)](_0x475b32(0x12d8))[_0x475b32(0x2f4)]=_0x39f1bb[_0x475b32(0x1170)]),_0x4af853();}function _0x132dfc(){const _0x512960=_0x41eae2;_0x589eec=null,document[_0x512960(0x89d)](_0x512960(0xa79))[_0x512960(0xf12)]='添加人设预设',document[_0x512960(0x89d)]('preset-avatar-preview')['src']=_0x265fcc,document[_0x512960(0x89d)](_0x512960(0xda6))['value']='',_0x44616d[_0x512960(0x2f1)][_0x512960(0x569)](_0x512960(0x11e4));}function _0x315b00(){const _0x3cd478=_0x41eae2,_0x2b80fe=_0x5b873d[_0x3cd478(0x27c)][_0x3cd478(0x12f4)](_0x394133=>_0x394133['id']===_0x589eec);if(!_0x2b80fe)return;document[_0x3cd478(0x89d)]('persona-editor-title')[_0x3cd478(0xf12)]=_0x3cd478(0xd0f),document[_0x3cd478(0x89d)](_0x3cd478(0x931))[_0x3cd478(0x9e3)]=_0x2b80fe['avatar'],document[_0x3cd478(0x89d)](_0x3cd478(0xda6))['value']=_0x2b80fe[_0x3cd478(0x1170)],_0x48446b[_0x3cd478(0x2f1)][_0x3cd478(0x1247)](_0x3cd478(0x11e4)),_0x44616d[_0x3cd478(0x2f1)][_0x3cd478(0x569)](_0x3cd478(0x11e4));}async function _0x105645(){const _0x3c2e05=_0x41eae2,_0x3959e2=await _0x4e2abc(_0x3c2e05(0xedd),_0x3c2e05(0x9a4),{'confirmButtonClass':'btn-danger'});_0x3959e2&&_0x589eec&&(await _0x1a6951[_0x3c2e05(0x27c)][_0x3c2e05(0x684)](_0x589eec),_0x5b873d[_0x3c2e05(0x27c)]=_0x5b873d[_0x3c2e05(0x27c)][_0x3c2e05(0x3d8)](_0x3bd628=>_0x3bd628['id']!==_0x589eec),_0x5b4fad(),_0x1e01a0());}function _0x1d48ab(){const _0x1f8053=_0x41eae2;_0x44616d[_0x1f8053(0x2f1)]['remove'](_0x1f8053(0x11e4)),_0x589eec=null;}async function _0x1cdeca(){const _0x2fcecb=_0x41eae2,_0x2cad45=document[_0x2fcecb(0x89d)](_0x2fcecb(0x931))['src'],_0x188a85=document[_0x2fcecb(0x89d)](_0x2fcecb(0xda6))['value'][_0x2fcecb(0xc3a)]();if(_0x2cad45===_0x265fcc&&!_0x188a85){alert(_0x2fcecb(0xac9));return;}if(_0x589eec){const _0x27fc97=_0x5b873d['personaPresets']['find'](_0x318485=>_0x318485['id']===_0x589eec);_0x27fc97&&(_0x27fc97[_0x2fcecb(0x12c8)]=_0x2cad45,_0x27fc97['persona']=_0x188a85,await _0x1a6951[_0x2fcecb(0x27c)]['put'](_0x27fc97));}else{const _0x18e99f={'id':_0x2fcecb(0x9d0)+Date[_0x2fcecb(0xf1a)](),'avatar':_0x2cad45,'persona':_0x188a85};await _0x1a6951[_0x2fcecb(0x27c)]['add'](_0x18e99f),_0x5b873d[_0x2fcecb(0x27c)][_0x2fcecb(0x138c)](_0x18e99f);}_0x1e01a0(),_0x1d48ab();}const _0x18ab48=document[_0x41eae2(0x89d)]('battery-alert-modal');function _0x2ef029(_0x33da21,_0x3123fa){const _0xa46a22=_0x41eae2;clearTimeout(_0x31c04c),document[_0xa46a22(0x89d)]('battery-alert-image')[_0xa46a22(0x9e3)]=_0x33da21,document[_0xa46a22(0x89d)](_0xa46a22(0x29b))[_0xa46a22(0xf12)]=_0x3123fa,_0x18ab48['classList']['add'](_0xa46a22(0x11e4));const _0x3799ee=()=>{const _0x888903=_0xa46a22;_0x18ab48[_0x888903(0x2f1)]['remove'](_0x888903(0x11e4)),_0x18ab48[_0x888903(0xcbb)]('click',_0x3799ee);};_0x18ab48[_0xa46a22(0x1193)](_0xa46a22(0x12a5),_0x3799ee),_0x31c04c=setTimeout(_0x3799ee,0x7d0);}function _0x2cd7bd(_0x16b5ac){const _0x32f02a=_0x41eae2,_0x284a20=document[_0x32f02a(0x89d)](_0x32f02a(0x7c1)),_0x173a0d=_0x284a20[_0x32f02a(0xd16)]('.battery-level'),_0x149077=_0x284a20[_0x32f02a(0xd16)](_0x32f02a(0xf3f)),_0x55e252=Math['floor'](_0x16b5ac[_0x32f02a(0x8a6)]*0x64);_0x173a0d['style'][_0x32f02a(0x42e)]=_0x55e252+'%',_0x149077[_0x32f02a(0xf12)]=_0x55e252+'%',_0x16b5ac[_0x32f02a(0x77b)]?_0x284a20['classList'][_0x32f02a(0x569)](_0x32f02a(0x77b)):_0x284a20[_0x32f02a(0x2f1)]['remove'](_0x32f02a(0x77b));}function _0x593651(_0xddead2){const _0x1590d0=_0x41eae2;_0x2cd7bd(_0xddead2);const _0x4181e3=_0xddead2[_0x1590d0(0x8a6)];!_0xddead2[_0x1590d0(0x77b)]&&(_0x4181e3<=0.4&&_0x39cb9e>0.4&&!_0xe0717d['hasShown40']&&(_0x2ef029(_0x1590d0(0xe00),_0x1590d0(0xee9)),_0xe0717d[_0x1590d0(0x12ff)]=!![]),_0x4181e3<=0.2&&_0x39cb9e>0.2&&!_0xe0717d[_0x1590d0(0x1b3)]&&(_0x2ef029('https://i.postimg.cc/qB9zbKs9/20.jpg','赶紧的充电，要饿死了'),_0xe0717d[_0x1590d0(0x1b3)]=!![]),_0x4181e3<=0.1&&_0x39cb9e>0.1&&!_0xe0717d[_0x1590d0(0x8f4)]&&(_0x2ef029(_0x1590d0(0x1304),_0x1590d0(0x2b5)),_0xe0717d['hasShown10']=!![]));if(_0x4181e3>0.4)_0xe0717d[_0x1590d0(0x12ff)]=![];if(_0x4181e3>0.2)_0xe0717d['hasShown20']=![];if(_0x4181e3>0.1)_0xe0717d[_0x1590d0(0x8f4)]=![];_0x39cb9e=_0x4181e3;}async function _0x269813(){const _0x35d7c0=_0x41eae2;if(_0x35d7c0(0x200)in navigator)try{const _0x1bded3=await navigator[_0x35d7c0(0x200)]();_0x39cb9e=_0x1bded3[_0x35d7c0(0x8a6)],_0x593651(_0x1bded3),_0x1bded3['addEventListener'](_0x35d7c0(0x243),()=>_0x593651(_0x1bded3)),_0x1bded3['addEventListener']('chargingchange',()=>{_0x593651(_0x1bded3),_0x1bded3['charging']&&_0x2ef029('https://i.postimg.cc/3NDQ0dWG/image.jpg','窝爱泥，电量吃饱饱');});}catch(_0x3ca79c){console[_0x35d7c0(0x1fd)]('无法获取电池信息:',_0x3ca79c),document['querySelector']('.battery-text')[_0x35d7c0(0xf12)]=_0x35d7c0(0xad7);}else console[_0x35d7c0(0x471)](_0x35d7c0(0x254)),document['querySelector'](_0x35d7c0(0xf3f))[_0x35d7c0(0xf12)]=_0x35d7c0(0xad7);}async function _0x3e4f60(){const _0x1ce293=_0x41eae2,_0x5a78ee=document['getElementById']('album-grid-page');if(!_0x5a78ee)return;const _0x27b05e=await _0x1a6951[_0x1ce293(0xe6e)][_0x1ce293(0x6ed)](_0x1ce293(0xcc8))[_0x1ce293(0x854)]()[_0x1ce293(0xc2f)]();_0x5a78ee[_0x1ce293(0x1ef)]='';if(_0x27b05e[_0x1ce293(0x7aa)]===0x0){_0x5a78ee[_0x1ce293(0x1ef)]=_0x1ce293(0x244);return;}_0x27b05e[_0x1ce293(0xd9a)](_0x4567a9=>{const _0x3de20a=_0x1ce293,_0x58e346=document['createElement']('div');_0x58e346[_0x3de20a(0x81c)]=_0x3de20a(0x3c2),_0x58e346[_0x3de20a(0x1ef)]=_0x3de20a(0x9b9)+_0x4567a9[_0x3de20a(0x4e8)]+');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>'+_0x4567a9[_0x3de20a(0xf74)]+_0x3de20a(0x782)+(_0x4567a9[_0x3de20a(0x903)]||0x0)+'\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x58e346['addEventListener']('click',()=>{_0x8fcf4e(_0x4567a9['id']);}),_0xefe9e2(_0x58e346,async()=>{const _0x25421e=_0x3de20a,_0x1e6c01=await _0x4e2abc(_0x25421e(0xebd),_0x25421e(0xb40)+_0x4567a9['name']+_0x25421e(0xc9f),{'confirmButtonClass':_0x25421e(0xcd8)});_0x1e6c01&&(await _0x1a6951[_0x25421e(0xa00)][_0x25421e(0x176)](_0x25421e(0x113b))[_0x25421e(0xb17)](_0x4567a9['id'])[_0x25421e(0x684)](),await _0x1a6951['qzoneAlbums'][_0x25421e(0x684)](_0x4567a9['id']),await _0x3e4f60(),alert(_0x25421e(0xc9c)));}),_0x5a78ee[_0x3de20a(0x22f)](_0x58e346);});}async function _0x8fcf4e(_0x47d5d9){const _0x54aa9d=_0x41eae2;_0x5b873d[_0x54aa9d(0x131f)]=_0x47d5d9,await _0x2403bf(),_0x4e6c15(_0x54aa9d(0xddd));}async function _0x2403bf(){const _0x26a11b=_0x41eae2;if(!_0x5b873d[_0x26a11b(0x131f)])return;const _0x458d30=document[_0x26a11b(0x89d)]('photos-grid-page'),_0x555b50=document[_0x26a11b(0x89d)]('album-photos-title'),_0x5cd292=await _0x1a6951[_0x26a11b(0xe6e)]['get'](_0x5b873d[_0x26a11b(0x131f)]);if(!_0x5cd292){console[_0x26a11b(0x1fd)](_0x26a11b(0x783),_0x5b873d[_0x26a11b(0x131f)]),_0x4e6c15(_0x26a11b(0xb31));return;}_0x555b50[_0x26a11b(0xf12)]=_0x5cd292['name'];const _0xe55dfe=await _0x1a6951[_0x26a11b(0xa00)][_0x26a11b(0x176)]('albumId')[_0x26a11b(0xb17)](_0x5b873d[_0x26a11b(0x131f)])[_0x26a11b(0xc2f)]();_0x458d30[_0x26a11b(0x1ef)]='',_0xe55dfe['length']===0x0?_0x458d30['innerHTML']='<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>':_0xe55dfe[_0x26a11b(0xd9a)](_0x1c3314=>{const _0x44c439=_0x26a11b,_0x1dcb83=document[_0x44c439(0x285)](_0x44c439(0xb25));_0x1dcb83[_0x44c439(0x81c)]=_0x44c439(0xb45),_0x1dcb83['innerHTML']=_0x44c439(0x60c)+_0x1c3314[_0x44c439(0x11de)]+'\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22'+_0x1c3314['id']+_0x44c439(0x58d),_0x458d30[_0x44c439(0x22f)](_0x1dcb83);});}async function _0x48ec29(_0x53d6b4){const _0x4fcd5c=_0x41eae2;if(!_0x5b873d['activeAlbumId'])return;const _0x38ef23=await _0x1a6951[_0x4fcd5c(0xa00)][_0x4fcd5c(0x176)](_0x4fcd5c(0x113b))[_0x4fcd5c(0xb17)](_0x5b873d[_0x4fcd5c(0x131f)])[_0x4fcd5c(0xc2f)]();_0x5f2baa['photos']=_0x38ef23[_0x4fcd5c(0x412)](_0x135545=>_0x135545['url']),_0x5f2baa[_0x4fcd5c(0x602)]=_0x5f2baa[_0x4fcd5c(0xa50)][_0x4fcd5c(0x9d7)](_0x5bcbd6=>_0x5bcbd6===_0x53d6b4);if(_0x5f2baa[_0x4fcd5c(0x602)]===-0x1)return;document[_0x4fcd5c(0x89d)](_0x4fcd5c(0xa88))['classList'][_0x4fcd5c(0x569)](_0x4fcd5c(0x11e4)),_0x54dde2(),_0x5f2baa[_0x4fcd5c(0xafa)]=!![];}function _0x54dde2(){const _0x7efdb7=_0x41eae2;if(_0x5f2baa[_0x7efdb7(0x602)]===-0x1)return;const _0xe7d86f=document['getElementById'](_0x7efdb7(0xff5)),_0x1b0600=document['getElementById'](_0x7efdb7(0x1b4)),_0x31a722=document['getElementById'](_0x7efdb7(0xc78));_0xe7d86f[_0x7efdb7(0x68e)][_0x7efdb7(0x50d)]=0x0,setTimeout(()=>{const _0x22d3e0=_0x7efdb7;_0xe7d86f[_0x22d3e0(0x9e3)]=_0x5f2baa['photos'][_0x5f2baa[_0x22d3e0(0x602)]],_0xe7d86f['style']['opacity']=0x1;},0x64),_0x1b0600[_0x7efdb7(0x3f7)]=_0x5f2baa[_0x7efdb7(0x602)]===0x0,_0x31a722[_0x7efdb7(0x3f7)]=_0x5f2baa[_0x7efdb7(0x602)]===_0x5f2baa[_0x7efdb7(0xa50)]['length']-0x1;}function _0x41230c(){const _0x254a1b=_0x41eae2;_0x5f2baa[_0x254a1b(0x602)]<_0x5f2baa[_0x254a1b(0xa50)][_0x254a1b(0x7aa)]-0x1&&(_0x5f2baa['currentIndex']++,_0x54dde2());}function _0x39ecae(){const _0x5b6582=_0x41eae2;_0x5f2baa[_0x5b6582(0x602)]>0x0&&(_0x5f2baa[_0x5b6582(0x602)]--,_0x54dde2());}function _0x35e483(){const _0x48b212=_0x41eae2;document[_0x48b212(0x89d)]('photo-viewer-modal')['classList'][_0x48b212(0x1247)]('visible'),_0x5f2baa[_0x48b212(0xafa)]=![],_0x5f2baa[_0x48b212(0xa50)]=[],_0x5f2baa['currentIndex']=-0x1,document[_0x48b212(0x89d)]('photo-viewer-image')[_0x48b212(0x9e3)]='';}function _0x3cd1c0(_0x1973ab){const _0x66bef6=_0x41eae2;_0x111a81=_0x1973ab,localStorage[_0x66bef6(0x85d)](_0x66bef6(0x5fc),_0x1973ab);const _0x4b73ef=document[_0x66bef6(0xd16)](_0x66bef6(0x3dc)),_0x191f8e=_0x4b73ef[_0x66bef6(0xd16)](_0x66bef6(0x118e));let _0x869e2f=_0x4b73ef['querySelector'](_0x66bef6(0x681));_0x1973ab>0x0?(!_0x869e2f&&(_0x869e2f=document[_0x66bef6(0x285)](_0x66bef6(0x118e)),_0x869e2f[_0x66bef6(0x81c)]=_0x66bef6(0x8d6),_0x191f8e['style'][_0x66bef6(0x927)]=_0x66bef6(0xa94),_0x191f8e[_0x66bef6(0x22f)](_0x869e2f)),_0x869e2f['textContent']=_0x1973ab>0x63?'99+':_0x1973ab,_0x869e2f[_0x66bef6(0x68e)]['display']=_0x66bef6(0x1118)):_0x869e2f&&(_0x869e2f[_0x66bef6(0x68e)]['display']=_0x66bef6(0x10f2)),_0x255a31();}function _0x2eecae(){const _0x20e8c3=_0x41eae2;if(_0x10707f)return;const _0x1438b0=_0x5b873d[_0x20e8c3(0x21a)][_0x20e8c3(0x3ab)]||0x3c;_0x10707f=setInterval(_0x3a3302,_0x1438b0*0x3e8),_0x1093fc();}function _0x3355bb(){_0x10707f&&(clearInterval(_0x10707f),_0x10707f=null),_0x47fec8();}async function _0x3a3302(){const _0x2a8763=_0x41eae2;console[_0x2a8763(0x471)](_0x2a8763(0xb72));if(!_0x5b873d[_0x2a8763(0x21a)][_0x2a8763(0xa61)]){_0x3355bb();return;}const _0x3f5063=Object[_0x2a8763(0x4b5)](_0x5b873d[_0x2a8763(0x667)])[_0x2a8763(0x3d8)](_0x93230f=>!_0x93230f['isGroup']);_0x3f5063['forEach'](_0x209c71=>{const _0x29fb1a=_0x2a8763;if(_0x209c71[_0x29fb1a(0x1383)]?.[_0x29fb1a(0x632)]===_0x29fb1a(0x4c8)){const _0x3c71c2=_0x209c71[_0x29fb1a(0x1383)][_0x29fb1a(0x315)];if(!_0x3c71c2)return;const _0x4591f3=Date[_0x29fb1a(0xf1a)]()-_0x3c71c2,_0x2449d6=(_0x5b873d['globalSettings'][_0x29fb1a(0x11bf)]||0x1)*0x3c*0x3c*0x3e8;_0x4591f3>_0x2449d6&&(_0x209c71[_0x29fb1a(0x1383)][_0x29fb1a(0x632)]='pending_system_reflection',_0x53ef51(_0x209c71['id']));}else{if(_0x209c71[_0x29fb1a(0x1383)]?.[_0x29fb1a(0x632)]===_0x29fb1a(0x123a)&&_0x209c71['id']!==_0x5b873d[_0x29fb1a(0xf96)]){if(_0x209c71[_0x29fb1a(0xdb9)][_0x29fb1a(0xa61)]===![]){console[_0x29fb1a(0x471)](_0x29fb1a(0x6b0)+_0x209c71[_0x29fb1a(0xf74)]+_0x29fb1a(0x11ab));return;}Math[_0x29fb1a(0xdc6)]()<0.2&&(console[_0x29fb1a(0x471)]('角色\x20\x22'+_0x209c71[_0x29fb1a(0xf74)]+_0x29fb1a(0x890)),_0xd587f4(_0x209c71['id']));}}});const _0x3b4ea2=Object[_0x2a8763(0x4b5)](_0x5b873d[_0x2a8763(0x667)])[_0x2a8763(0x3d8)](_0x3ae811=>_0x3ae811['isGroup']);_0x3b4ea2['forEach'](_0x14e9ee=>{const _0x5178b1=_0x2a8763;if(_0x14e9ee[_0x5178b1(0xdb9)][_0x5178b1(0xa61)]===![]){console[_0x5178b1(0x471)](_0x5178b1(0x4bf)+_0x14e9ee[_0x5178b1(0xf74)]+_0x5178b1(0x2fe));return;}_0x14e9ee['id']!==_0x5b873d[_0x5178b1(0xf96)]&&Math[_0x5178b1(0xdc6)]()<0.1&&(console[_0x5178b1(0x471)](_0x5178b1(0x4bf)+_0x14e9ee['name']+'\x22\x20被唤醒，准备独立行动...'),_0x1d1f6c(_0x14e9ee['id']));});try{const _0x165330=await _0x1a6951[_0x2a8763(0x8ce)][_0x2a8763(0xc2f)]();if(_0x165330['length']===0x0)return;const _0x42ff1f=await _0x1a6951['qzonePosts'][_0x2a8763(0x6ed)](_0x2a8763(0x114e))[_0x2a8763(0x854)]()[_0x2a8763(0x1204)](0xa)[_0x2a8763(0xc2f)]();for(const _0x3fda81 of _0x165330){if(_0x3fda81[_0x2a8763(0xa61)]===![])continue;const _0x413679=_0x3fda81['actionCooldownMinutes']||0xf;if(_0x3fda81[_0x2a8763(0x923)]){const _0x4e121f=(Date[_0x2a8763(0xf1a)]()-_0x3fda81[_0x2a8763(0x923)])/(0x3e8*0x3c);if(_0x4e121f<_0x413679)continue;}if(Math[_0x2a8763(0xdc6)]()>0.3)continue;const _0x9a840e=[];for(const _0x35af11 of _0x42ff1f){if(_0x35af11[_0x2a8763(0xc3f)]==='npc_'+_0x3fda81['id'])continue;const _0x1fbac2=_0x35af11[_0x2a8763(0x1157)]?.[_0x2a8763(0xc5c)](_0x1e635f=>_0x1e635f[_0x2a8763(0x8e7)]===_0x3fda81[_0x2a8763(0xf74)]),_0x242ac4=_0x35af11[_0x2a8763(0x1157)]?.[_0x2a8763(0xdd0)](-0x1)[0x0]?.[_0x2a8763(0xf20)];if(_0x242ac4===_0x3fda81[_0x2a8763(0xf74)])continue;let _0x35ed67=![];if(_0x35af11[_0x2a8763(0xc3f)]===_0x2a8763(0x116c)||_0x35af11[_0x2a8763(0xc3f)][_0x2a8763(0x1222)]('chat_'))_0x3fda81['associatedWith']['includes'](_0x35af11[_0x2a8763(0xc3f)])&&(_0x35ed67=!![]);else{if(_0x35af11[_0x2a8763(0xc3f)][_0x2a8763(0x1222)](_0x2a8763(0x5b8))){const _0x289c6c=parseInt(_0x35af11[_0x2a8763(0xc3f)][_0x2a8763(0xfbf)](_0x2a8763(0x5b8),'')),_0x499970=await _0x1a6951['npcs'][_0x2a8763(0x650)](_0x289c6c);if(_0x499970&&_0x499970[_0x2a8763(0x12e2)]){const _0x344c41=_0x3fda81[_0x2a8763(0x12e2)][_0x2a8763(0x3d8)](_0x5b4d97=>_0x499970[_0x2a8763(0x12e2)]['includes'](_0x5b4d97));_0x344c41[_0x2a8763(0x7aa)]>0x0&&(_0x35ed67=!![]);}}}(_0x35ed67||_0x1fbac2)&&_0x9a840e[_0x2a8763(0x138c)](_0x35af11);}if(_0x9a840e['length']>0x0||Math[_0x2a8763(0xdc6)]()<0.2){console[_0x2a8763(0x471)]('NPC\x20\x22'+_0x3fda81[_0x2a8763(0xf74)]+_0x2a8763(0x8cd));const _0x5c69e0=await _0x2f2f82(_0x3fda81,_0x9a840e);if(_0x5c69e0&&_0x5c69e0[_0x2a8763(0x7aa)]>0x0){for(const _0x259360 of _0x5c69e0){if(_0x259360[_0x2a8763(0x48c)]==='qzone_comment'){const _0xb2ba45=await _0x1a6951[_0x2a8763(0xea0)][_0x2a8763(0x650)](_0x259360[_0x2a8763(0x7b6)]);if(_0xb2ba45){if(!_0xb2ba45['comments'])_0xb2ba45[_0x2a8763(0x1157)]=[];_0xb2ba45[_0x2a8763(0x1157)][_0x2a8763(0x138c)]({'commenterName':_0x3fda81[_0x2a8763(0xf74)],'text':_0x259360[_0x2a8763(0x1202)],'replyTo':_0x259360['replyTo']||null,'timestamp':Date['now']()+Math[_0x2a8763(0xdc6)]()}),await _0x1a6951[_0x2a8763(0xea0)][_0x2a8763(0xdfc)](_0x259360[_0x2a8763(0x7b6)],{'comments':_0xb2ba45[_0x2a8763(0x1157)]}),_0x3cd1c0(_0x111a81+0x1);}}else{if(_0x259360[_0x2a8763(0x48c)]===_0x2a8763(0x8ed)){const _0x3cccc7={'type':_0x259360[_0x2a8763(0x2db)]||_0x2a8763(0x536),'content':_0x259360[_0x2a8763(0x28c)],'timestamp':Date['now'](),'authorId':_0x2a8763(0x5b8)+_0x3fda81['id'],'authorOriginalName':_0x3fda81[_0x2a8763(0xf74)],'visibleTo':_0x3fda81[_0x2a8763(0x12e2)],'likes':[],'comments':[],'isDeleted':![]};await _0x1a6951[_0x2a8763(0xea0)]['add'](_0x3cccc7),console['log'](_0x2a8763(0xacd)+_0x3fda81[_0x2a8763(0xf74)]+_0x2a8763(0x30a)),_0x3cd1c0(_0x111a81+0x1);}}}await _0x1a6951[_0x2a8763(0x8ce)]['update'](_0x3fda81['id'],{'lastActionTimestamp':Date[_0x2a8763(0xf1a)]()}),document[_0x2a8763(0x89d)]('qzone-screen')[_0x2a8763(0x2f1)][_0x2a8763(0x3ff)](_0x2a8763(0x8ea))&&await _0x155816();}}}}catch(_0x253c4c){console['error']('处理NPC后台活动时出错:',_0x253c4c);}}async function _0x2f2f82(_0x4d0f52,_0x2b7a6b){const _0x191455=_0x41eae2,{proxyUrl:_0x54a74d,apiKey:_0x189f19,model:_0x33c024}=_0x5b873d[_0x191455(0x30d)];if(!_0x54a74d||!_0x189f19||!_0x33c024)return console[_0x191455(0x1fd)](_0x191455(0x9ea)),null;let _0x5b0780='#\x20你的互动对象\x20(用户和其他角色)\x0a';const _0xf9902b=_0x5b873d[_0x191455(0x5c1)][_0x191455(0x22a)]||'我',_0x26d105=_0x5b873d['chats'][Object[_0x191455(0xe9c)](_0x5b873d['chats'])[0x0]]?.[_0x191455(0xdb9)][_0x191455(0x6d4)]||_0x191455(0xb84);_0x5b0780+='-\x20**'+_0xf9902b+'\x20(用户)**:\x20'+_0x26d105+'\x0a';_0x4d0f52['associatedWith']&&_0x4d0f52[_0x191455(0x12e2)][_0x191455(0x7aa)]>0x0&&_0x4d0f52[_0x191455(0x12e2)][_0x191455(0xd9a)](_0x4037ac=>{const _0x31482e=_0x191455,_0x2fc86f=_0x5b873d[_0x31482e(0x667)][_0x4037ac];_0x2fc86f&&!_0x2fc86f['isGroup']&&(_0x5b0780+=_0x31482e(0x928)+_0x2fc86f[_0x31482e(0xf74)]+_0x31482e(0x95e)+_0x2fc86f[_0x31482e(0x1045)]+')**:\x20'+_0x2fc86f[_0x31482e(0xdb9)][_0x31482e(0x1269)]+'\x0a');});const _0x93720c=(await Promise[_0x191455(0x863)](_0x2b7a6b['map'](async _0xb275ec=>{const _0x5aa736=_0x191455;let _0x2a0559=_0x5aa736(0x825);if(_0xb275ec[_0x5aa736(0xc3f)]===_0x5aa736(0x116c))_0x2a0559=_0x5b873d[_0x5aa736(0x5c1)][_0x5aa736(0x22a)]||'用户';else{if(_0xb275ec[_0x5aa736(0xc3f)][_0x5aa736(0x1222)](_0x5aa736(0x1382)))_0x2a0559=_0x471a37(_0xb275ec[_0x5aa736(0xf56)]||_0xb275ec['authorId']);else{if(_0xb275ec[_0x5aa736(0xc3f)]['startsWith'](_0x5aa736(0x5b8))){const _0x9fa25d=parseInt(_0xb275ec[_0x5aa736(0xc3f)]['replace'](_0x5aa736(0x5b8),'')),_0x568b50=await _0x1a6951[_0x5aa736(0x8ce)][_0x5aa736(0x650)](_0x9fa25d);_0x568b50&&(_0x2a0559=_0x568b50[_0x5aa736(0xf74)]);}}}const _0x47e868=(_0xb275ec[_0x5aa736(0x1157)]||[])[_0x5aa736(0x412)](_0x484853=>{const _0x53727d=_0x5aa736;if(typeof _0x484853===_0x53727d(0x7af)&&_0x484853[_0x53727d(0xf20)]){const _0x3d9751=_0x471a37(_0x484853['commenterName']);return _0x53727d(0x928)+_0x3d9751+_0x53727d(0xdc9)+_0x484853[_0x53727d(0xec9)];}return'-\x20'+_0x484853;})[_0x5aa736(0x1237)]('\x0a');return'\x0a---\x0a###\x20帖子ID:\x20'+_0xb275ec['id']+_0x5aa736(0xf8a)+_0x2a0559+'\x0a-\x20**内容摘要**:\x20'+(_0xb275ec[_0x5aa736(0x28c)]||_0xb275ec['publicText']||'')[_0x5aa736(0x489)](0x0,0x96)+_0x5aa736(0xc8c)+(_0x47e868||_0x5aa736(0x599))+_0x5aa736(0x100b);})))[_0x191455(0x1237)]('\x0a'),_0x217633=_0x191455(0x5b8)+_0x4d0f52['id'],_0xc9094c=Date[_0x191455(0xf1a)]()-0xc*0x3c*0x3c*0x3e8,_0x5a727d=await _0x1a6951['qzonePosts'][_0x191455(0x176)]('authorId')['equals'](_0x217633)['and'](_0x4f02ac=>_0x4f02ac[_0x191455(0x114e)]>_0xc9094c)[_0x191455(0xc2f)]();let _0xfeba8d='';_0x5a727d['length']>0x0&&(_0xfeba8d='\x0a#\x20【【【行为倾向指令\x20(高优先级)】】】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【首要任务】应该是去**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【应该避免】再次发布新动态，除非你有一个非常紧急或绝佳的新想法。\x0a');const _0x4a036b=_0x191455(0x557)+_0x4d0f52[_0x191455(0xf74)]+'”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a'+_0xfeba8d+_0x191455(0xf89)+_0x4d0f52[_0x191455(0xf74)]+_0x191455(0x4f3)+_0x4d0f52['persona']+'\x0a\x0a'+_0x5b0780+_0x191455(0x2e7)+_0x93720c+_0x191455(0x1225);try{const _0x4040ea=[{'role':_0x191455(0x116c),'content':'请根据你的设定，开始你的行动。'}];let _0x459318=_0x54a74d['includes']('generativelanguage'),_0x5b7956=_0xa615f4(_0x33c024,_0x189f19,_0x4a036b,_0x4040ea);const _0x248f30=_0x459318?await fetch(_0x5b7956[_0x191455(0x11de)],_0x5b7956['data']):await fetch(_0x54a74d+_0x191455(0x6dd),{'method':'POST','headers':{'Content-Type':_0x191455(0xce4),'Authorization':_0x191455(0x3fb)+_0x189f19},'body':JSON['stringify']({'model':_0x33c024,'messages':[{'role':'system','content':_0x4a036b},..._0x4040ea],'temperature':_0x5b873d[_0x191455(0x21a)]['apiTemperature']||0.9})});if(!_0x248f30['ok'])throw new Error(_0x191455(0x10d8)+_0x248f30[_0x191455(0x517)]);const _0x36052a=await _0x248f30[_0x191455(0x6b5)](),_0x1609a6=getGeminiResponseText(_0x36052a),_0x18eb0f=_0x1609a6[_0x191455(0x86c)](/(\[[\s\S]*\])/);if(!_0x18eb0f)throw new Error(_0x191455(0x351));return JSON['parse'](_0x18eb0f[0x0]);}catch(_0x35716f){return console['error'](_0x191455(0x127e)+_0x4d0f52['name']+_0x191455(0xead),_0x35716f),null;}}async function _0xd587f4(_0xfa1feb){const _0x477255=_0x41eae2,_0x1dc811=_0x5b873d['chats'][_0xfa1feb];if(!_0x1dc811)return;const _0x1e8e95=_0x1dc811[_0x477255(0xdb9)][_0x477255(0xfd9)]||0xa;if(_0x1dc811['lastActionTimestamp']){const _0x335ec1=(Date[_0x477255(0xf1a)]()-_0x1dc811[_0x477255(0x923)])/(0x3e8*0x3c);if(_0x335ec1<_0x1e8e95){console[_0x477255(0x471)](_0x477255(0x6b0)+_0x1dc811[_0x477255(0xf74)]+_0x477255(0x11f9)+Math[_0x477255(0x900)](_0x1e8e95-_0x335ec1)+_0x477255(0x728));return;}}_0x405b57(_0xfa1feb,!![]);const {proxyUrl:_0x3e2dcc,apiKey:_0x45876f,model:_0xee54ed}=_0x5b873d[_0x477255(0x30d)];if(!_0x3e2dcc||!_0x45876f||!_0xee54ed)return;const _0x3cb0ab=_0x5b873d[_0x477255(0x5c1)][_0x477255(0x22a)],_0x42cddb=new Date(),_0x5b1a43=_0x1dc811['settings'][_0x477255(0x1a7)]||_0x477255(0x1207),_0x4808ce=_0x42cddb[_0x477255(0x425)](_0x477255(0x1e8),{'timeZone':_0x5b1a43,'dateStyle':'full','timeStyle':_0x477255(0x248)}),_0x21c011=new Date(_0x42cddb[_0x477255(0x425)](_0x477255(0x798),{'timeZone':_0x5b1a43}));let _0x46b09b='',_0x2fcf25='',_0x3853a1,_0x47d755=![];const _0x4b446a=_0x1dc811[_0x477255(0xdb9)][_0x477255(0x46f)]||0xa,_0x2b44c2=_0x1dc811[_0x477255(0x551)][_0x477255(0x3d8)](_0x549c40=>!_0x549c40['isHidden'])[_0x477255(0xdd0)](-_0x4b446a),_0x168f00=_0x1dc811[_0x477255(0x551)][_0x477255(0x3d8)](_0x418d2b=>!_0x418d2b[_0x477255(0x9ae)])[_0x477255(0xdd0)](-0x1)[0x0];if(_0x1dc811[_0x477255(0xdb9)]['enableTimePerception']){_0x46b09b=_0x10282a(_0x21c011);const _0x3a91f9=_0x1dc811['history']['filter'](_0x4bde47=>!_0x4bde47[_0x477255(0x9ae)])[_0x477255(0xdd0)](-0x1)[0x0],_0xa9f8a9=new Date();let _0x1c6221='',_0x3ba0b0=![];if(_0x3a91f9){const _0x44a00d=new Date(_0x3a91f9[_0x477255(0x114e)]),_0x30f514=(_0xa9f8a9-_0x44a00d)/(0x3e8*0x3c*0x3c);if(_0x30f514>0xc){_0x3ba0b0=!![];const _0xd8a743=Math[_0x477255(0x128a)](_0x30f514/0x18);_0x1c6221=_0x477255(0x165)+(_0xd8a743>0x0?_0xd8a743+'天':Math[_0x477255(0x128a)](_0x30f514)+'小时')+'没有聊天了。';}else{const _0x274021=Math[_0x477255(0x128a)](_0x30f514*0x3c);if(_0x274021<0x5)_0x1c6221=_0x477255(0x661);else _0x274021<0x3c?_0x1c6221=_0x477255(0xe4b)+_0x274021+'分钟前聊过。':_0x1c6221=_0x477255(0xe4b)+Math[_0x477255(0x128a)](_0x30f514)+_0x477255(0x8c1);}}else _0x3ba0b0=!![],_0x1c6221='这是你们的第一次互动。';let _0x85d5e6='你们最近没有有效聊天记录。';_0x2b44c2['length']>0x0&&(_0x85d5e6=_0x477255(0xc65)+_0x2b44c2[_0x477255(0x412)](_0x3f1d7f=>{const _0x3113ab=_0x477255,_0x40f51a=_0x3f1d7f[_0x3113ab(0xa57)]===_0x3113ab(0x116c)?_0x3cb0ab:_0x1dc811[_0x3113ab(0xf74)];return _0x40f51a+':\x20'+String(_0x3f1d7f[_0x3113ab(0x28c)])[_0x3113ab(0x489)](0x0,0x32)+_0x3113ab(0x1046);})['join']('\x0a')),_0x3ba0b0?_0x3853a1='[情景提示]\x20'+_0x1c6221+_0x477255(0x1336)+_0x4808ce+_0x477255(0x419)+_0x85d5e6:_0x3853a1=''+_0x85d5e6;}else _0x2b44c2[_0x477255(0x7aa)]>0x0?_0x3853a1=_0x477255(0xc65)+_0x2b44c2['map'](_0x571d72=>{const _0x53a11c=_0x477255,_0x3dd1ed=_0x571d72[_0x53a11c(0xa57)]===_0x53a11c(0x116c)?_0x3cb0ab:_0x1dc811[_0x53a11c(0xf74)];return _0x3dd1ed+':\x20'+String(_0x571d72[_0x53a11c(0x28c)])[_0x53a11c(0x489)](0x0,0x32)+'...';})['join']('\x0a'):_0x3853a1=_0x477255(0x1ca);const _0x5b994a=await _0x1a6951[_0x477255(0xea0)]['orderBy'](_0x477255(0x114e))[_0x477255(0x854)]()['limit'](0x5)[_0x477255(0xc2f)](),_0x1df1c7=_0x4a3d6c(_0x5b994a,_0x1dc811),_0x76bbd6=_0x1df1c7[_0x477255(0x3d8)](_0x3f48d5=>_0x3f48d5['authorId']===_0xfa1feb);let _0x426536='';_0x76bbd6['length']>0x0&&(_0x426536='\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a',_0x76bbd6['forEach'](_0x2b65d0=>{const _0x49bdef=_0x477255;let _0x420fdf=(_0x2b65d0[_0x49bdef(0x957)]||_0x2b65d0[_0x49bdef(0x28c)]||_0x49bdef(0x8b3))[_0x49bdef(0x489)](0x0,0x28)+_0x49bdef(0x1046);_0x426536+=_0x49bdef(0x539)+_0x2b65d0['id']+_0x49bdef(0xd4e)+_0x420fdf+'\x22\x0a';}));let _0x5a2ed8=[];_0x1df1c7[_0x477255(0x7aa)]>0x0&&(_0x5a2ed8=_0x1df1c7['map'](_0x405617=>{const _0x45496a=_0x477255;let _0x17a56b;if(_0x405617[_0x45496a(0x48c)]===_0x45496a(0x574))_0x17a56b=(_0x45496a(0xcc3)+_0x405617[_0x45496a(0x132c)]+_0x45496a(0x2c3)+(_0x405617[_0x45496a(0x957)]||''))[_0x45496a(0x489)](0x0,0x32)+_0x45496a(0x1046);else _0x405617[_0x45496a(0x48c)]===_0x45496a(0xe70)?_0x17a56b=('[一张图片，描述为：“'+_0x405617[_0x45496a(0x12ce)]+_0x45496a(0x2c3)+(_0x405617[_0x45496a(0x957)]||''))[_0x45496a(0x489)](0x0,0x32)+'...':_0x17a56b=String(_0x405617[_0x45496a(0x957)]||_0x405617[_0x45496a(0x28c)]||_0x45496a(0x8b3))['substring'](0x0,0x32)+'...';return _0x45496a(0x119a)+_0x17a56b+'\x22';}));let _0x7e5438='';_0x5a2ed8['length']>0x0&&(_0x7e5438=_0x477255(0xc89)+_0x5a2ed8[_0x477255(0x1237)]('\x0a')+_0x477255(0x12e9));let _0x199575='';if(_0x1dc811[_0x477255(0xdb9)]['linkedWorldBookIds']&&_0x1dc811['settings']['linkedWorldBookIds']['length']>0x0){const _0x436dbb=_0x1dc811['settings'][_0x477255(0x32d)][_0x477255(0x412)](_0x178bd3=>{const _0x31bb53=_0x477255,_0x185e63=_0x5b873d[_0x31bb53(0x8a1)][_0x31bb53(0x12f4)](_0x204d5a=>_0x204d5a['id']===_0x178bd3);if(!_0x185e63||!Array[_0x31bb53(0xbd6)](_0x185e63[_0x31bb53(0x28c)]))return'';const _0x26222a=_0x185e63[_0x31bb53(0x28c)][_0x31bb53(0x3d8)](_0x52843d=>_0x52843d[_0x31bb53(0x104e)]!==![])[_0x31bb53(0x412)](_0x4e7307=>{const _0x10b99e=_0x31bb53;let _0x4394ed=_0x10b99e(0xc77)+(_0x4e7307['comment']||_0x10b99e(0xc06))+'\x0a';return _0x4e7307[_0x10b99e(0xe9c)][_0x10b99e(0x7aa)]>0x0&&(_0x4394ed+=_0x10b99e(0x1dc)+_0x4e7307[_0x10b99e(0xe9c)]['join'](',\x20')+'\x0a'),_0x4394ed+=_0x10b99e(0x280)+_0x4e7307['content'],_0x4394ed;})[_0x31bb53(0x1237)]('');return _0x26222a?_0x31bb53(0xb85)+_0x185e63[_0x31bb53(0xf74)]+'\x0a'+_0x26222a:'';})[_0x477255(0x3d8)](Boolean)[_0x477255(0x1237)]('');_0x436dbb&&(_0x199575=_0x477255(0x312)+_0x436dbb+_0x477255(0xdf6));}let _0x5e05a2='';const _0x5ea845=_0x1dc811[_0x477255(0xdb9)][_0x477255(0x654)]||0xa;if(_0x1dc811[_0x477255(0xdb9)]['linkedMemoryChatIds']&&_0x1dc811[_0x477255(0xdb9)]['linkedMemoryChatIds'][_0x477255(0x7aa)]>0x0){const _0x50e935=_0x1dc811[_0x477255(0xdb9)][_0x477255(0xf0e)][_0x477255(0x412)](_0xd5ac6=>{const _0x4bebf1=_0x477255,_0x3be522=_0x5b873d[_0x4bebf1(0x667)][_0xd5ac6];if(!_0x3be522)return null;const _0x3d36d0=_0x3be522[_0x4bebf1(0x551)]['slice'](-0x1)[0x0];return{'chat':_0x3be522,'latestTimestamp':_0x3d36d0?_0x3d36d0['timestamp']:0x0};})[_0x477255(0x3d8)](Boolean);_0x50e935['sort']((_0x23b9e2,_0xd46dae)=>_0xd46dae[_0x477255(0x1365)]-_0x23b9e2['latestTimestamp']),_0x5e05a2+=_0x477255(0x34f);for(const _0x3a77f3 of _0x50e935){const _0xb25b8e=_0x3a77f3['chat'],_0x5d7f19=_0xb25b8e[_0x477255(0x58c)]?_0x477255(0x2ee):'[私聊]',_0x5888d0=_0x3a77f3['latestTimestamp']>0x0?_0x477255(0x6d1)+_0x4ce38e(_0x3a77f3[_0x477255(0x1365)])+')':'';_0x5e05a2+=_0x477255(0xb88)+_0x5d7f19+'“'+_0xb25b8e['name']+_0x477255(0x3c6)+_0x5888d0+_0x477255(0x11f7);const _0x5e0491=_0xb25b8e[_0x477255(0x551)][_0x477255(0xdd0)](-_0x5ea845),_0xd20c6f=_0x5e0491['filter'](_0x2a15ba=>!String(_0x2a15ba[_0x477255(0x28c)])[_0x477255(0xced)](_0x477255(0x7d3)));_0xd20c6f[_0x477255(0x7aa)]>0x0?_0xd20c6f[_0x477255(0xd9a)](_0x1c5ed7=>{const _0xadfd7=_0x477255,_0x5343c5=_0x1c5ed7[_0xadfd7(0xa57)]===_0xadfd7(0x116c)?_0xb25b8e[_0xadfd7(0xdb9)][_0xadfd7(0xc48)]||'我':_0x1c5ed7[_0xadfd7(0xcfc)]||_0xb25b8e[_0xadfd7(0xf74)];let _0x40b14d=String(_0x1c5ed7[_0xadfd7(0x28c)]);if(_0x1c5ed7[_0xadfd7(0x48c)]===_0xadfd7(0x656)||_0x1c5ed7[_0xadfd7(0x48c)]==='user_photo')_0x40b14d=_0xadfd7(0xa12)+_0x1c5ed7[_0xadfd7(0x28c)]+']';else _0x1c5ed7[_0xadfd7(0x48c)]===_0xadfd7(0xff9)&&(_0x40b14d=_0xadfd7(0xf76)+_0x1c5ed7[_0xadfd7(0x28c)]+']');_0x5e05a2+=_0x5343c5+':\x20'+_0x40b14d+'\x0a';}):_0x5e05a2+='(暂无有效聊天记录)\x0a';}}let _0x52e8d6='';if(_0x1df1c7['length']>0x0){let _0x1e4966='\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a';for(const _0x54e0d6 of _0x1df1c7){let _0x1484d2;if(_0x54e0d6[_0x477255(0xc3f)]==='user')_0x1484d2=_0x5b873d[_0x477255(0x5c1)][_0x477255(0x22a)];else{if(String(_0x54e0d6[_0x477255(0xc3f)])[_0x477255(0x1222)]('npc_'))_0x1484d2=_0x54e0d6[_0x477255(0xf56)]||_0x477255(0x249);else{const _0x4e68dd=_0x5b873d[_0x477255(0x667)][_0x54e0d6[_0x477255(0xc3f)]];_0x1484d2=_0x4e68dd?_0x4e68dd[_0x477255(0xf74)]:_0x477255(0xf8d);}}if(_0x54e0d6[_0x477255(0xc3f)]===_0xfa1feb)_0x1484d2+='\x20(这是你的帖子)';let _0x175c56;if(_0x54e0d6[_0x477255(0x48c)]===_0x477255(0xb95)){const _0x560945=_0x54e0d6['repostComment']?_0x477255(0xc54)+_0x54e0d6[_0x477255(0x629)]+'\x22':'';let _0x56660d=_0x477255(0xe11);const _0x2eac56=_0x54e0d6[_0x477255(0x1c9)]['authorId'];if(_0x2eac56===_0x477255(0x116c))_0x56660d=_0x5b873d[_0x477255(0x5c1)]['nickname'];else _0x5b873d[_0x477255(0x667)][_0x2eac56]&&(_0x56660d=_0x5b873d[_0x477255(0x667)][_0x2eac56]['name']);let _0x313816;const _0x17daa1=_0x54e0d6[_0x477255(0x1c9)];if(_0x17daa1['type']==='text_image')_0x313816='[文字图]\x20'+(_0x17daa1[_0x477255(0x957)]||'')+_0x477255(0x190)+(_0x17daa1[_0x477255(0x132c)]||'')[_0x477255(0x489)](0x0,0x28)+_0x477255(0xe14);else _0x17daa1[_0x477255(0x48c)]==='image_post'?_0x313816=_0x477255(0x613)+(_0x17daa1[_0x477255(0x957)]||'')+_0x477255(0x190)+(_0x17daa1[_0x477255(0x12ce)]||'')[_0x477255(0x489)](0x0,0x28)+_0x477255(0xe14):_0x313816='\x22'+(_0x17daa1[_0x477255(0x28c)]||'')[_0x477255(0x489)](0x0,0x28)+_0x477255(0x10a8);_0x175c56='转发了\x20@'+_0x56660d+_0x477255(0x53f)+_0x560945+_0x477255(0xa75)+_0x313816+'】';}else{if(_0x54e0d6[_0x477255(0x48c)]===_0x477255(0x574))_0x175c56=(_0x477255(0xac1)+_0x54e0d6[_0x477255(0x132c)]+_0x477255(0xf71)+(_0x54e0d6['publicText']||''))[_0x477255(0x489)](0x0,0x32)+_0x477255(0x1046);else{if(_0x54e0d6['type']===_0x477255(0xe70))_0x175c56=('[一张图片，描述为：\x22'+_0x54e0d6[_0x477255(0x12ce)]+_0x477255(0xf71)+(_0x54e0d6[_0x477255(0x957)]||''))[_0x477255(0x489)](0x0,0x32)+'...';else{if(_0x54e0d6[_0x477255(0x48c)]==='realimag'&&_0x54e0d6['prompt']){const _0x1fcbc4=Array['isArray'](_0x54e0d6['prompt'])?_0x54e0d6[_0x477255(0x1086)]:[_0x54e0d6['prompt']];_0x175c56=(_0x54e0d6[_0x477255(0x957)]||'')+('\x20[包含'+_0x1fcbc4[_0x477255(0x7aa)]+_0x477255(0xe65)+_0x1fcbc4[_0x477255(0x1237)](',\x20')+']');}else{if(_0x54e0d6[_0x477255(0x48c)]===_0x477255(0x88f)&&_0x54e0d6['prompt']){const _0x6740ca=Array[_0x477255(0xbd6)](_0x54e0d6['prompt'])?_0x54e0d6[_0x477255(0x1086)]:[_0x54e0d6[_0x477255(0x1086)]];_0x175c56=(_0x54e0d6[_0x477255(0x957)]||'')+(_0x477255(0x362)+_0x6740ca[_0x477255(0x7aa)]+_0x477255(0xfde)+_0x6740ca['join'](',\x20')+']');}else _0x175c56=String(_0x54e0d6[_0x477255(0x957)]||_0x54e0d6[_0x477255(0x28c)]||_0x477255(0x8b3))[_0x477255(0x489)](0x0,0x32)+_0x477255(0x1046);}}}}_0x1e4966+='-\x20(ID:\x20'+_0x54e0d6['id']+_0x477255(0x69d)+_0x1484d2+_0x477255(0x615)+_0x175c56+'\x22\x0a';if(_0x54e0d6['comments']&&_0x54e0d6[_0x477255(0x1157)][_0x477255(0x7aa)]>0x0)for(const _0x1eee58 of _0x54e0d6[_0x477255(0x1157)]){if(typeof _0x1eee58==='object'&&_0x1eee58[_0x477255(0xf20)]){const _0x115fbe=_0x471a37(_0x1eee58['commenterName']);let _0x39ced1=_0x1eee58[_0x477255(0xb5c)]?_0x477255(0x2fc)+_0x1eee58[_0x477255(0xb5c)]+'\x27]':_0x1eee58[_0x477255(0xec9)];_0x1eee58[_0x477255(0xf20)]===_0x1dc811[_0x477255(0x1045)]?_0x1e4966+=_0x477255(0x136c)+_0x39ced1+'\x0a':_0x1e4966+=_0x477255(0x1036)+_0x115fbe+_0x477255(0x95e)+_0x1eee58[_0x477255(0xf20)]+_0x477255(0x4fe)+_0x39ced1+'\x0a';}}}_0x52e8d6=_0x1e4966;}const _0x330479=_0x477255(0x495)+(_0x1dc811['longTermMemory']&&_0x1dc811[_0x477255(0xc18)][_0x477255(0x7aa)]>0x0?_0x1dc811[_0x477255(0xc18)]['map'](_0x4eb891=>_0x477255(0x768)+_0x4ce38e(_0x4eb891[_0x477255(0x114e)])+')\x20'+_0x4eb891[_0x477255(0x28c)])[_0x477255(0x1237)]('\x0a'):_0x477255(0x12c3)),_0x141c6e=_0x247dd3(_0x1dc811,0x3,_0x477255(0x5be)),_0x4d6fb4=_0x247dd3(_0x1dc811,0x6,_0x477255(0x5be)),_0x31dc63=_0x247dd3(_0x1dc811,0x9,_0x477255(0x5be)),_0x304ea8=_0x247dd3(_0x1dc811,0x1,_0x477255(0xccc)),_0x3eb511=_0x247dd3(_0x1dc811,0x3,_0x477255(0xccc)),_0x4237d7=_0x247dd3(_0x1dc811,0x7,'days');let _0x538b5a='';if(_0x141c6e||_0x4d6fb4||_0x31dc63||_0x304ea8||_0x3eb511||_0x4237d7){_0x538b5a+=_0x477255(0x10cc);if(_0x141c6e)_0x538b5a+=_0x141c6e;if(_0x4d6fb4)_0x538b5a+=_0x4d6fb4;if(_0x31dc63)_0x538b5a+=_0x31dc63;if(_0x141c6e||_0x4d6fb4||_0x31dc63)_0x538b5a+='\x0a';if(_0x304ea8)_0x538b5a+=_0x304ea8;if(_0x3eb511)_0x538b5a+=_0x3eb511;if(_0x4237d7)_0x538b5a+=_0x4237d7;}const _0x36e681=_0x5ae1ee(_0x1dc811),_0x5e9e3b=_0x477255(0xbc2)+_0x1dc811[_0x477255(0xf74)]+'\x22的角色（你的本名是\x22'+_0x1dc811[_0x477255(0x1045)]+_0x477255(0x25d)+_0x3cb0ab+_0x477255(0x10c4)+(_0x1dc811[_0x477255(0xdb9)][_0x477255(0x298)]?_0x477255(0x9cb)+_0x4808ce+'\x20('+_0x46b09b+_0x477255(0xfb0)+_0x2fcf25+'\x0a'+(_0x47d755?'【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！':''):'')+_0x477255(0x107d)+(_0x1dc811['lastActionType']||'无')+_0x477255(0x904)+_0x7e5438+_0x477255(0x12e9)+_0x426536+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20'+_0x1dc811[_0x477255(0xdb9)][_0x477255(0x1269)]+_0x477255(0x12e9)+_0x199575+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x1dc811[_0x477255(0xc18)]&&_0x1dc811[_0x477255(0xc18)][_0x477255(0x7aa)]>0x0?_0x1dc811[_0x477255(0xc18)]['map'](_0x14a38c=>_0x477255(0x768)+_0x4ce38e(_0x14a38c[_0x477255(0x114e)])+')\x20'+_0x14a38c[_0x477255(0x28c)])[_0x477255(0x1237)]('\x0a'):'无')+_0x477255(0x12e9)+_0x538b5a+'\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5e05a2+_0x477255(0x12e9)+(_0x1dc811['settings'][_0x477255(0x298)]?_0x477255(0x564)+_0x4808ce+'\x20('+_0x46b09b+')':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x1dc811[_0x477255(0xdb9)]['enableTimePerception']?_0x477255(0x79e)+_0x2fcf25:'')+_0x477255(0x758)+_0x36e681+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20'+_0x3853a1+_0x477255(0x12e9)+_0x52e8d6+'\x0a',_0x2c2da1=[{'role':_0x477255(0x18c),'content':_0x5e9e3b},..._0x2b44c2[_0x477255(0x412)](_0x25b09e=>{const _0x17bc75=_0x477255,_0x303efe=_0x25b09e[_0x17bc75(0xa57)]===_0x17bc75(0x116c)?_0x3cb0ab:_0x1dc811[_0x17bc75(0xf74)];let _0xac1503=_0x25b09e[_0x17bc75(0x28c)];return typeof _0xac1503!==_0x17bc75(0x1224)&&(_0xac1503=JSON['stringify'](_0xac1503)),{'role':_0x25b09e[_0x17bc75(0xa57)],'content':_0x303efe+':\x20'+_0xac1503};})];try{const _0x381688=[{'role':'user','content':_0x5e9e3b+_0x477255(0x9dd)+_0x52e8d6}];console[_0x477255(0x471)]('正在为后台活动发送API请求\x20(\x22'+_0x1dc811[_0x477255(0xf74)]+'\x22)');let _0x4ebeec=_0x3e2dcc===GEMINI_API_URL,_0x3d1620=_0xa615f4(_0xee54ed,_0x45876f,_0x5e9e3b,_0x381688);const _0x27c36a=_0x4ebeec?await fetch(_0x3d1620[_0x477255(0x11de)],_0x3d1620[_0x477255(0xd98)]):await fetch(_0x3e2dcc+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x477255(0x3fb)+_0x45876f},'body':JSON[_0x477255(0x465)]({'model':_0xee54ed,'messages':_0x381688,'temperature':_0x5b873d[_0x477255(0x21a)][_0x477255(0x576)]||0.9})});if(!_0x27c36a['ok']){const _0x2c9743=await _0x27c36a['json']();throw new Error(_0x477255(0x7ff)+_0x27c36a[_0x477255(0x632)]+_0x477255(0xc3d)+JSON[_0x477255(0x465)](_0x2c9743));}const _0x35112d=await _0x27c36a['json'](),_0x303528=_0x4ebeec?getGeminiResponseText(_0x35112d):_0x35112d['choices'][0x0][_0x477255(0x1288)][_0x477255(0x28c)];if(!_0x303528||_0x303528[_0x477255(0xc3a)]()===''){console[_0x477255(0xac3)](_0x477255(0xfed)+_0x1dc811['name']+_0x477255(0x11b8));return;}const _0x5d2e54=_0x29a17f(_0x303528);if(!_0x5d2e54||_0x5d2e54['length']===0x0){console[_0x477255(0xac3)](_0x477255(0x8b6)+_0x1dc811[_0x477255(0xf74)]+_0x477255(0x10b8),_0x303528);return;}let _0x18b107=Date[_0x477255(0xf1a)](),_0x3d598d=![];const _0x413e1b=[];for(const _0x8f8e41 of _0x5d2e54){const _0x263fde=String(_0x8f8e41['content']||''),_0x22c937=_0x263fde[_0x477255(0xc3a)]()['startsWith']('<')&&_0x263fde[_0x477255(0xc3a)]()[_0x477255(0x77a)]('>');if(_0x8f8e41[_0x477255(0x48c)]===_0x477255(0xec9)&&!_0x22c937&&_0x263fde[_0x477255(0xced)]('\x0a')){const _0x5dd904=_0x263fde['split'](/\n+/)[_0x477255(0x3d8)](_0x1d8eef=>_0x1d8eef['trim']());_0x5dd904[_0x477255(0xd9a)](_0x1dafb5=>{const _0x581003=_0x477255;_0x413e1b[_0x581003(0x138c)]({..._0x8f8e41,'content':_0x1dafb5});});}else _0x413e1b['push'](_0x8f8e41);}for(const _0x100e57 of _0x413e1b){_0x1dc811[_0x477255(0x877)]=_0x100e57[_0x477255(0x48c)],_0x1dc811['lastActionTimestamp']=_0x18b107;let _0x4c342f=null;const _0x616b00={'role':'assistant','senderName':_0x1dc811['originalName'],'timestamp':_0x18b107++};let _0x1c80f8=null;switch(_0x100e57[_0x477255(0x48c)]){case _0x477255(0x6c0):{const _0x88e7b8=parseInt(_0x100e57[_0x477255(0x7b6)]),_0xca50e=await _0x1a6951[_0x477255(0xea0)][_0x477255(0x650)](_0x88e7b8);if(_0xca50e&&_0xca50e[_0x477255(0xc3f)]===_0xfa1feb){await _0x1a6951['qzonePosts'][_0x477255(0xdfc)](_0x88e7b8,{'isDeleted':!![]});document[_0x477255(0x89d)](_0x477255(0x47b))[_0x477255(0x2f1)][_0x477255(0x3ff)](_0x477255(0x8ea))&&_0x155816();const _0x6f7a3={'role':_0x477255(0x18c),'type':'post_deleted_notice','content':'['+_0x1dc811[_0x477255(0xf74)]+_0x477255(0x96e),'postId':_0x88e7b8,'timestamp':_0x18b107++};_0x1dc811[_0x477255(0x551)]['push'](_0x6f7a3),isViewingThisChat?_0x58deee(_0x6f7a3,_0x1dc811):(_0x1dc811[_0x477255(0x3ce)]=(_0x1dc811['unreadCount']||0x0)+0x1,_0x23fbd5(_0xfa1feb,'['+_0x1dc811[_0x477255(0xf74)]+_0x477255(0x96e)),_0x3d598d=!![]);}else console['warn'](_0x477255(0x177)+_0x1dc811['name']+'\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20'+_0x100e57[_0x477255(0x7b6)]+')');continue;}case _0x477255(0xec9):_0x4c342f={..._0x616b00,'content':_0x100e57[_0x477255(0x28c)]};break;case _0x477255(0x656):_0x4c342f={..._0x616b00,'type':_0x477255(0x656),'content':_0x100e57[_0x477255(0xf6e)]};break;case _0x477255(0x3c8):if(_0x100e57['meaning']){const _0x45ef6c=_0x5b873d[_0x477255(0x210)][_0x477255(0x12f4)](_0xd62e91=>_0xd62e91[_0x477255(0xf74)]===_0x100e57['meaning']);_0x45ef6c?_0x4c342f={..._0x616b00,'type':'sticker','content':_0x45ef6c[_0x477255(0x11de)],'meaning':_0x45ef6c['name']}:(console['warn']('AI\x20(独立行动)\x20尝试使用一个不存在的表情:\x20\x22'+_0x100e57['meaning']+'\x22'),_0x4c342f={..._0x616b00,'type':_0x477255(0xec9),'content':_0x477255(0x507)+_0x100e57[_0x477255(0xb5c)]+']'});}else console[_0x477255(0xac3)](_0x477255(0x704),_0x100e57),_0x4c342f={..._0x616b00,'type':_0x477255(0x3c8),'content':_0x100e57[_0x477255(0x11de)],'meaning':_0x477255(0x6a3)};break;case'update_status':_0x1dc811[_0x477255(0x632)][_0x477255(0xec9)]=_0x100e57['status_text'],_0x1dc811[_0x477255(0x632)][_0x477255(0x311)]=_0x100e57['is_busy']||![],_0x1dc811[_0x477255(0x632)][_0x477255(0x530)]=Date[_0x477255(0xf1a)]();break;case _0x477255(0x8ed):const _0x20baea={'type':_0x100e57['postType'],'content':_0x100e57[_0x477255(0x28c)]||'','publicText':_0x100e57['publicText']||'','hiddenContent':_0x100e57[_0x477255(0x132c)]||'','image_prompt':_0x100e57['image_prompt']||'','timestamp':Date['now'](),'authorId':_0xfa1feb,'authorOriginalName':_0x1dc811[_0x477255(0x1045)],'authorGroupId':_0x1dc811[_0x477255(0xb54)],'visibleGroupIds':null};await _0x1a6951[_0x477255(0xea0)][_0x477255(0x569)](_0x20baea),_0x3cd1c0(_0x111a81+0x1),console[_0x477255(0x471)](_0x477255(0x664)+_0x1dc811[_0x477255(0xf74)]+_0x477255(0xc87));break;case _0x477255(0xb95):const _0x4d719b=await _0x1a6951[_0x477255(0xea0)]['get'](parseInt(_0x100e57[_0x477255(0x7b6)]));if(_0x4d719b){const _0x11e30c={'type':_0x477255(0xb95),'timestamp':Date[_0x477255(0xf1a)](),'authorId':_0xfa1feb,'authorGroupId':_0x1dc811['groupId'],'authorOriginalName':_0x1dc811[_0x477255(0x1045)],'repostComment':_0x100e57['comment']||'','originalPost':_0x4d719b,'visibleGroupIds':null};await _0x1a6951[_0x477255(0xea0)][_0x477255(0x569)](_0x11e30c),_0x3cd1c0(_0x111a81+0x1),console[_0x477255(0x471)](_0x477255(0x664)+_0x1dc811['name']+_0x477255(0xe3c)+_0x100e57[_0x477255(0x7b6)]);}break;case _0x477255(0xa87):const _0x243654=await _0x1a6951[_0x477255(0xea0)][_0x477255(0x650)](parseInt(_0x100e57[_0x477255(0x7b6)]));if(_0x243654){if(!_0x243654['likes'])_0x243654['likes']=[];!_0x243654[_0x477255(0xfe6)][_0x477255(0xced)](_0x1dc811[_0x477255(0x1045)])&&(_0x243654[_0x477255(0xfe6)][_0x477255(0x138c)](_0x1dc811['originalName']),await _0x1a6951[_0x477255(0xea0)][_0x477255(0xdfc)](_0x243654['id'],{'likes':_0x243654['likes']}),_0x3cd1c0(_0x111a81+0x1),console[_0x477255(0x471)](_0x477255(0x664)+_0x1dc811[_0x477255(0xf74)]+_0x477255(0xea4)+_0x100e57[_0x477255(0x7b6)]));}break;case'qzone_comment':{const _0xfc77a8=await _0x1a6951['qzonePosts'][_0x477255(0x650)](parseInt(_0x100e57[_0x477255(0x7b6)]));if(_0xfc77a8){if(!_0xfc77a8[_0x477255(0x1157)])_0xfc77a8[_0x477255(0x1157)]=[];const _0x2377bf=_0x100e57[_0x477255(0xf74)]||_0x1dc811[_0x477255(0x1045)],_0x123e4f=(_0x58c428,_0x51cda3=null,_0x394a4f=null)=>({'commenterName':_0x2377bf,'text':_0x401262(_0x58c428,_0x1dc811),'meaning':_0x51cda3,'replyTo':_0x394a4f,'timestamp':Date['now']()});if(_0x100e57['stickerMeaning']){const _0x98f9ec=_0x5b873d[_0x477255(0x210)][_0x477255(0x12f4)](_0x34a9ef=>_0x34a9ef[_0x477255(0xf74)]===_0x100e57[_0x477255(0x115f)]);_0x98f9ec?_0xfc77a8[_0x477255(0x1157)]['push'](_0x123e4f(_0x98f9ec['url'],_0x98f9ec[_0x477255(0xf74)],_0x100e57['replyTo']||null)):(console[_0x477255(0xac3)](_0x477255(0x2d0)+_0x100e57['stickerMeaning']+'\x22'),_0xfc77a8[_0x477255(0x1157)][_0x477255(0x138c)](_0x123e4f(_0x477255(0x507)+_0x100e57[_0x477255(0x115f)]+']',null,_0x100e57[_0x477255(0x8e7)]||null)));}else{if(Array['isArray'](_0x100e57[_0x477255(0x1157)]))_0x100e57[_0x477255(0x1157)][_0x477255(0xd9a)](_0x1bb59d=>{const _0x1284e7=_0x477255;typeof _0x1bb59d===_0x1284e7(0x1224)&&_0x1bb59d[_0x1284e7(0xc3a)]()&&_0xfc77a8['comments'][_0x1284e7(0x138c)](_0x123e4f(_0x1bb59d,null,_0x100e57[_0x1284e7(0x8e7)]||null));});else typeof _0x100e57['commentText']===_0x477255(0x1224)&&_0x100e57[_0x477255(0x1202)][_0x477255(0xc3a)]()&&_0xfc77a8[_0x477255(0x1157)][_0x477255(0x138c)](_0x123e4f(_0x100e57[_0x477255(0x1202)],null,_0x100e57[_0x477255(0x8e7)]||null));}await _0x1a6951[_0x477255(0xea0)][_0x477255(0xdfc)](_0xfc77a8['id'],{'comments':_0xfc77a8['comments']}),_0x3cd1c0(_0x111a81+0x1),console[_0x477255(0x471)](_0x477255(0x664)+_0x1dc811[_0x477255(0xf74)]+_0x477255(0xed8)+_0x100e57[_0x477255(0x7b6)]);if(!_0x1dc811['commentCooldowns'])_0x1dc811[_0x477255(0xf70)]={};_0x1dc811['commentCooldowns'][_0x100e57[_0x477255(0x7b6)]]=Date[_0x477255(0xf1a)]();}continue;}case _0x477255(0x7c0):!_0x333dc7['isActive']&&!_0x333dc7[_0x477255(0xba8)]&&(_0x333dc7[_0x477255(0xba8)]=!![],_0x333dc7[_0x477255(0xf96)]=_0xfa1feb,_0x333dc7[_0x477255(0x43c)]=![],_0x333dc7['callRequester']=_0x1dc811[_0x477255(0xf74)],_0x714251());break;default:console['warn'](_0x477255(0x6b0)+_0x1dc811['name']+_0x477255(0x2e5),_0x100e57[_0x477255(0x48c)]);break;case _0x477255(0xd7b):{const _0x473a85=_0x100e57[_0x477255(0xf74)],_0xdb10de=_0x1dc811[_0x477255(0xdb9)][_0x477255(0x614)]['find'](_0x8cc99f=>_0x8cc99f[_0x477255(0xf74)]===_0x473a85);_0xdb10de&&(_0x1dc811[_0x477255(0xdb9)][_0x477255(0xdd3)]=_0xdb10de[_0x477255(0x11de)],await _0x2f6a63(_0x1dc811),visibleSystemMessage={'content':'['+_0x1dc811[_0x477255(0xf74)]+'\x20更换了头像]'},console[_0x477255(0x471)](_0x477255(0x664)+_0x1dc811['name']+_0x477255(0xc2d)));break;}}if(_0x4c342f){_0x1dc811[_0x477255(0x551)][_0x477255(0x138c)](_0x4c342f),_0x1dc811[_0x477255(0x3ce)]=(_0x1dc811[_0x477255(0x3ce)]||0x0)+0x1;if(!_0x3d598d){let _0x31340b=_0x4c342f[_0x477255(0x48c)]===_0x477255(0x656)?_0x477255(0x598):_0x4c342f[_0x477255(0x28c)]||'';_0x23fbd5(_0xfa1feb,_0x31340b),_0x3d598d=!![];}}}await _0x1a6951[_0x477255(0x667)][_0x477255(0xc0f)](_0x1dc811);}catch(_0x21cfdc){console[_0x477255(0x1fd)](_0x477255(0x6b0)+_0x1dc811[_0x477255(0xf74)]+_0x477255(0x5e1),_0x21cfdc);}finally{_0x405b57(_0xfa1feb,![]),_0x413d78(),document[_0x477255(0x89d)](_0x477255(0x47b))['classList']['contains'](_0x477255(0x8ea))&&_0x155816();}}async function _0x1d1f6c(_0x1d82dc){const _0x284562=_0x41eae2,_0x57df3a=_0x5b873d['chats'][_0x1d82dc];if(!_0x57df3a||!_0x57df3a[_0x284562(0x58c)])return;const _0x18b07f=_0x57df3a[_0x284562(0xdb9)][_0x284562(0xfd9)]||0xa;if(_0x57df3a['lastActionTimestamp']){const _0x49f950=(Date[_0x284562(0xf1a)]()-_0x57df3a[_0x284562(0x923)])/(0x3e8*0x3c);if(_0x49f950<_0x18b07f){console[_0x284562(0x471)](_0x284562(0x4bf)+_0x57df3a[_0x284562(0xf74)]+_0x284562(0x8e6));return;}}const {proxyUrl:_0x72ddc5,apiKey:_0x2c0730,model:_0x9fa95d}=_0x5b873d[_0x284562(0x30d)];if(!_0x72ddc5||!_0x2c0730||!_0x9fa95d)return;const _0x3a655c=_0x57df3a[_0x284562(0xdb9)][_0x284562(0xc48)]||'我',_0xe700df=new Date();let _0x509d80;const _0x426182=_0x57df3a[_0x284562(0x551)][_0x284562(0x3d8)](_0x5db5e6=>!_0x5db5e6['isHidden'])[_0x284562(0xdd0)](-0x5),_0x44d2b7=_0x426182[_0x284562(0x12f4)](_0x40a390=>_0x40a390[_0x284562(0x48c)]===_0x284562(0x675)&&!_0x40a390['isFullyClaimed']);if(_0x44d2b7){const _0x172970=_0xb9963e(_0x57df3a,_0x44d2b7[_0x284562(0xcfc)]);console[_0x284562(0x471)](_0x284562(0x5b6)+_0x57df3a[_0x284562(0xf74)]+_0x284562(0x90f)),_0x509d80=_0x284562(0xfb6)+_0x172970+_0x284562(0x92c)+_0x44d2b7['timestamp']+_0x284562(0x1087)+_0x44d2b7[_0x284562(0x114e)]+_0x284562(0x84c);}else{let _0x3e84ee='';const _0x363dc5=_0x57df3a[_0x284562(0xdb9)][_0x284562(0x1a7)]||_0x284562(0x1207),_0xd88468=_0xe700df[_0x284562(0x425)](_0x284562(0x1e8),{'timeZone':_0x363dc5,'dateStyle':'full','timeStyle':'short'}),_0x5bd1d9=new Date(_0xe700df[_0x284562(0x425)](_0x284562(0x798),{'timeZone':_0x363dc5}));if(_0x57df3a[_0x284562(0xdb9)][_0x284562(0x298)]){const _0x303e54=_0x57df3a[_0x284562(0x551)][_0x284562(0x3d8)](_0x40a3d9=>!_0x40a3d9[_0x284562(0x9ae)])[_0x284562(0xdd0)](-0x1)[0x0];if(_0x303e54){const _0x3925a9=new Date(_0x303e54['timestamp']),_0xfed96c=(_0xe700df-_0x3925a9)/(0x3e8*0x3c);_0xfed96c>0x3c?_0x3e84ee=_0x284562(0x1093)+Math[_0x284562(0x900)](_0xfed96c/0x3c)+_0x284562(0x1282):_0x3e84ee='群里在'+Math[_0x284562(0x128a)](_0xfed96c)+'分钟前有人聊过。';}else _0x3e84ee=_0x284562(0xf83);}let _0x26083c=_0x284562(0x1ca);const _0x484331=_0x57df3a[_0x284562(0xdb9)][_0x284562(0x46f)]||0xa,_0x1fde27=_0x57df3a[_0x284562(0x551)][_0x284562(0x3d8)](_0x22eda0=>!_0x22eda0['isHidden'])['slice'](-_0x484331);_0x1fde27[_0x284562(0x7aa)]>0x0&&(_0x26083c='这是你们最近的对话：\x0a'+_0x1fde27[_0x284562(0x412)](_0x3b3fdb=>{const _0x2d7d20=_0x284562,_0x282429=_0x3b3fdb[_0x2d7d20(0xa57)]===_0x2d7d20(0x116c)?_0x3a655c:_0xb9963e(_0x57df3a,_0x3b3fdb[_0x2d7d20(0xcfc)]),_0x48eb4d=String(_0x3b3fdb[_0x2d7d20(0x28c)]||_0x3b3fdb[_0x2d7d20(0x1288)]||'')['substring'](0x0,0x32);return _0x282429+':\x20'+_0x48eb4d+'...';})['join']('\x0a'));const _0x9009d5=_0x57df3a['members'][_0x284562(0x412)](_0x87cd48=>'-\x20**'+_0x87cd48[_0x284562(0x7da)]+_0x284562(0x5f1)+_0x87cd48['originalName']+'):\x20'+_0x87cd48[_0x284562(0x1170)])['join']('\x0a');let _0x15eb2e='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0x8dc6ca=![];_0x57df3a[_0x284562(0x5ab)][_0x284562(0xd9a)](_0x422d08=>{const _0x1dbcfa=_0x284562,_0x3e3cc9=_0x5b873d[_0x1dbcfa(0x667)][_0x422d08['id']];_0x3e3cc9&&_0x3e3cc9[_0x1dbcfa(0xc18)]&&_0x3e3cc9[_0x1dbcfa(0xc18)][_0x1dbcfa(0x7aa)]>0x0&&(_0x15eb2e+=_0x1dbcfa(0x65c)+_0x422d08[_0x1dbcfa(0x7da)]+'”的记忆\x20---\x0a',_0x15eb2e+=_0x3e3cc9[_0x1dbcfa(0xc18)][_0x1dbcfa(0x412)](_0x18be8d=>'-\x20'+_0x18be8d[_0x1dbcfa(0x28c)])[_0x1dbcfa(0x1237)]('\x0a'),_0x8dc6ca=!![]);});!_0x8dc6ca&&(_0x15eb2e+='-\x20(暂无)');let _0x2ef592='';if(_0x57df3a[_0x284562(0xdb9)]['linkedWorldBookIds']&&_0x57df3a[_0x284562(0xdb9)][_0x284562(0x32d)][_0x284562(0x7aa)]>0x0){const _0x3f13b7=_0x57df3a[_0x284562(0xdb9)][_0x284562(0x32d)]['map'](_0x541477=>{const _0x52134d=_0x284562,_0x5bc1be=_0x5b873d[_0x52134d(0x8a1)][_0x52134d(0x12f4)](_0x1bb0b9=>_0x1bb0b9['id']===_0x541477);if(!_0x5bc1be||!Array['isArray'](_0x5bc1be[_0x52134d(0x28c)]))return'';const _0x261c7a=_0x5bc1be['content'][_0x52134d(0x3d8)](_0x2fc2bc=>_0x2fc2bc[_0x52134d(0x104e)]!==![])[_0x52134d(0x412)](_0x4aa0cc=>{const _0x211d3d=_0x52134d;let _0x1a4812=_0x211d3d(0xc77)+(_0x4aa0cc['comment']||_0x211d3d(0xc06))+'\x0a';return _0x4aa0cc[_0x211d3d(0xe9c)][_0x211d3d(0x7aa)]>0x0&&(_0x1a4812+=_0x211d3d(0x1dc)+_0x4aa0cc[_0x211d3d(0xe9c)][_0x211d3d(0x1237)](',\x20')+'\x0a'),_0x1a4812+=_0x211d3d(0x280)+_0x4aa0cc[_0x211d3d(0x28c)],_0x1a4812;})[_0x52134d(0x1237)]('');return _0x261c7a?'\x0a\x0a##\x20世界书:\x20'+_0x5bc1be[_0x52134d(0xf74)]+'\x0a'+_0x261c7a:'';})[_0x284562(0x3d8)](Boolean)[_0x284562(0x1237)]('');_0x3f13b7&&(_0x2ef592=_0x284562(0x312)+_0x3f13b7+_0x284562(0xdf6));}let _0x51dd45='';const _0x56d5cf=_0x57df3a[_0x284562(0xdb9)][_0x284562(0x654)]||0xa;if(_0x57df3a[_0x284562(0xdb9)][_0x284562(0xf0e)]&&_0x57df3a[_0x284562(0xdb9)][_0x284562(0xf0e)][_0x284562(0x7aa)]>0x0){const _0x578192=_0x57df3a[_0x284562(0xdb9)][_0x284562(0xf0e)][_0x284562(0x412)](_0x16357c=>{const _0x5964c0=_0x284562,_0x6d43a8=_0x5b873d[_0x5964c0(0x667)][_0x16357c];if(!_0x6d43a8)return null;const _0xfbc59d=_0x6d43a8[_0x5964c0(0x551)][_0x5964c0(0xdd0)](-0x1)[0x0];return{'chat':_0x6d43a8,'latestTimestamp':_0xfbc59d?_0xfbc59d[_0x5964c0(0x114e)]:0x0};})[_0x284562(0x3d8)](Boolean);_0x578192[_0x284562(0x2e3)]((_0x17ee2d,_0x523276)=>_0x523276['latestTimestamp']-_0x17ee2d[_0x284562(0x1365)]),_0x51dd45+=_0x284562(0x801);for(const _0x5dd725 of _0x578192){const _0x401e4a=_0x5dd725[_0x284562(0xde9)],_0x1b9bce=_0x401e4a[_0x284562(0x58c)]?_0x284562(0x2ee):_0x284562(0x66d),_0x5b4510=_0x5dd725['latestTimestamp']>0x0?_0x284562(0x6d1)+_0x4ce38e(_0x5dd725[_0x284562(0x1365)])+')':'';_0x51dd45+=_0x284562(0xb88)+_0x1b9bce+'“'+_0x401e4a[_0x284562(0xf74)]+_0x284562(0x3c6)+_0x5b4510+'\x20---\x0a';const _0xf48a52=_0x401e4a[_0x284562(0x551)][_0x284562(0xdd0)](-_0x56d5cf),_0x257958=_0xf48a52[_0x284562(0x3d8)](_0x4d7ffd=>!String(_0x4d7ffd['content'])['includes'](_0x284562(0x7d3)));_0x257958['length']>0x0?_0x257958[_0x284562(0xd9a)](_0x5ce539=>{const _0x708053=_0x284562,_0x32bea0=_0x5ce539['role']===_0x708053(0x116c)?_0x401e4a[_0x708053(0xdb9)]['myNickname']||'我':_0x5ce539[_0x708053(0xcfc)]||_0x401e4a[_0x708053(0xf74)];let _0x64106=String(_0x5ce539[_0x708053(0x28c)]);if(_0x5ce539['type']==='ai_image'||_0x5ce539[_0x708053(0x48c)]===_0x708053(0x11f6))_0x64106=_0x708053(0xa12)+_0x5ce539[_0x708053(0x28c)]+']';else _0x5ce539['type']===_0x708053(0xff9)&&(_0x64106=_0x708053(0xf76)+_0x5ce539[_0x708053(0x28c)]+']');_0x51dd45+=_0x32bea0+':\x20'+_0x64106+'\x0a';}):_0x51dd45+=_0x284562(0xdbb);}}const _0x1542e2=await _0x1a6951[_0x284562(0xea0)]['orderBy'](_0x284562(0x114e))[_0x284562(0x854)]()[_0x284562(0x1204)](0x5)[_0x284562(0xc2f)]();let _0x42518c='';const _0x30fee6=new Set();for(const _0x33dd8a of _0x57df3a[_0x284562(0x5ab)]){const _0x15be90=_0x5b873d['chats'][_0x33dd8a['id']];if(_0x15be90){const _0x4f00ab=_0x4a3d6c(_0x1542e2,_0x15be90);_0x4f00ab['forEach'](_0x277ab0=>_0x30fee6[_0x284562(0x569)](_0x277ab0));}}const _0x407223=new Set(_0x57df3a[_0x284562(0x5ab)][_0x284562(0x412)](_0x2018f7=>_0x2018f7[_0x284562(0x1045)])),_0x342302=[..._0x30fee6][_0x284562(0x3d8)](_0x1f04f4=>{const _0x1617d2=_0x284562,_0x1a358e=_0x1f04f4[_0x1617d2(0xfe6)]&&_0x1f04f4[_0x1617d2(0xfe6)][_0x1617d2(0xc5c)](_0x5ea49a=>_0x407223[_0x1617d2(0xa14)](_0x5ea49a)),_0x42ae08=_0x1f04f4[_0x1617d2(0x1157)]&&_0x1f04f4[_0x1617d2(0x1157)][_0x1617d2(0xc5c)](_0x22662d=>typeof _0x22662d==='object'&&_0x407223[_0x1617d2(0xa14)](_0x22662d[_0x1617d2(0xf20)]));return!_0x1a358e&&!_0x42ae08;});if(_0x342302[_0x284562(0x7aa)]>0x0){let _0x545bd6=_0x284562(0xdd4);for(const _0x3bcd63 of _0x342302){let _0x17ebd6=_0x3bcd63[_0x284562(0xc3f)]==='user'?_0x3a655c:_0x5b873d[_0x284562(0x667)][_0x3bcd63[_0x284562(0xc3f)]]?.[_0x284562(0xf74)]||_0x284562(0xf8d),_0x2fa217;if(_0x3bcd63[_0x284562(0x48c)]===_0x284562(0xb95)){const _0x14d011=_0x3bcd63[_0x284562(0x629)]?'并评论说：“'+_0x3bcd63['repostComment']+'”':'';let _0x207c2b='原作者';const _0x44bf0b=_0x3bcd63[_0x284562(0x1c9)][_0x284562(0xc3f)];if(_0x44bf0b===_0x284562(0x116c))_0x207c2b=_0x5b873d['qzoneSettings'][_0x284562(0x22a)];else _0x5b873d['chats'][_0x44bf0b]&&(_0x207c2b=_0x5b873d[_0x284562(0x667)][_0x44bf0b][_0x284562(0xf74)]);let _0x519a4a;const _0x1659f1=_0x3bcd63[_0x284562(0x1c9)];if(_0x1659f1[_0x284562(0x48c)]===_0x284562(0x574))_0x519a4a=_0x284562(0xc15)+(_0x1659f1[_0x284562(0x957)]||'')+_0x284562(0xa72)+(_0x1659f1[_0x284562(0x132c)]||'')[_0x284562(0x489)](0x0,0x28)+'...”)';else _0x1659f1[_0x284562(0x48c)]===_0x284562(0xe70)?_0x519a4a=_0x284562(0x613)+(_0x1659f1[_0x284562(0x957)]||'')+_0x284562(0xa72)+(_0x1659f1[_0x284562(0x12ce)]||'')[_0x284562(0x489)](0x0,0x28)+'...”)':_0x519a4a='“'+(_0x1659f1[_0x284562(0x28c)]||'')['substring'](0x0,0x28)+'...”';_0x2fa217=_0x284562(0xded)+_0x207c2b+_0x284562(0x53f)+_0x14d011+_0x284562(0xa75)+_0x519a4a+'】';}else{if(_0x3bcd63[_0x284562(0x48c)]===_0x284562(0x574))_0x2fa217=(_0x284562(0xcc3)+_0x3bcd63['hiddenContent']+'”]\x20'+(_0x3bcd63[_0x284562(0x957)]||''))['substring'](0x0,0x32)+'...';else _0x3bcd63[_0x284562(0x48c)]===_0x284562(0xe70)?_0x2fa217=(_0x284562(0xcd2)+_0x3bcd63[_0x284562(0x12ce)]+_0x284562(0x2c3)+(_0x3bcd63[_0x284562(0x957)]||''))[_0x284562(0x489)](0x0,0x32)+_0x284562(0x1046):_0x2fa217=String(_0x3bcd63[_0x284562(0x957)]||_0x3bcd63[_0x284562(0x28c)]||_0x284562(0x8b3))['substring'](0x0,0x32)+_0x284562(0x1046);}_0x545bd6+=_0x284562(0x539)+_0x3bcd63['id']+_0x284562(0x69d)+_0x17ebd6+',\x20内容:\x20\x22'+_0x2fa217+'\x22\x0a';if(_0x3bcd63[_0x284562(0x1157)]&&_0x3bcd63['comments'][_0x284562(0x7aa)]>0x0)for(const _0x5ec979 of _0x3bcd63[_0x284562(0x1157)]){if(typeof _0x5ec979==='object'&&_0x5ec979[_0x284562(0xf20)]){const _0x29f99a=_0x471a37(_0x5ec979[_0x284562(0xf20)]);let _0x384ce8=_0x5ec979[_0x284562(0xb5c)]?'[表情:\x20\x27'+_0x5ec979[_0x284562(0xb5c)]+'\x27]':_0x5ec979['text'];_0x545bd6+=_0x284562(0x1036)+_0x29f99a+'\x20(本名:\x20'+_0x5ec979[_0x284562(0xf20)]+'):\x20'+_0x384ce8+'\x0a';}}}_0x42518c=_0x545bd6;}const _0x36d3d7=_0x247dd3(_0x57df3a,0x3,_0x284562(0x5be)),_0x533337=_0x247dd3(_0x57df3a,0x6,_0x284562(0x5be)),_0x1a5646=_0x247dd3(_0x57df3a,0x9,_0x284562(0x5be)),_0x30e5da=_0x247dd3(_0x57df3a,0x1,_0x284562(0xccc)),_0x5455cb=_0x247dd3(_0x57df3a,0x3,_0x284562(0xccc)),_0x40588f=_0x247dd3(_0x57df3a,0x7,'days');let _0xd56408='';if(_0x36d3d7||_0x533337||_0x1a5646||_0x30e5da||_0x5455cb||_0x40588f){_0xd56408+='\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a';if(_0x36d3d7)_0xd56408+=_0x36d3d7;if(_0x533337)_0xd56408+=_0x533337;if(_0x1a5646)_0xd56408+=_0x1a5646;if(_0x36d3d7||_0x533337||_0x1a5646)_0xd56408+='\x0a';if(_0x30e5da)_0xd56408+=_0x30e5da;if(_0x5455cb)_0xd56408+=_0x5455cb;if(_0x40588f)_0xd56408+=_0x40588f;}const _0x27bc6a=_0x4f684e(_0x57df3a);_0x509d80=_0x284562(0x5a0)+_0x57df3a[_0x284562(0xf74)]+_0x284562(0xd60)+(_0x57df3a[_0x284562(0xdb9)][_0x284562(0x298)]?_0x284562(0xc17)+_0xd88468+'。':'')+_0x284562(0x12e9)+(_0x3e84ee?_0x3e84ee+'\x20':'')+_0x284562(0x8fe)+_0x15eb2e+_0x284562(0xa70)+_0x3a655c+_0x284562(0xce2)+_0x57df3a[_0x284562(0xf74)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2ef592+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x57df3a[_0x284562(0xc18)]&&_0x57df3a[_0x284562(0xc18)][_0x284562(0x7aa)]>0x0?_0x57df3a[_0x284562(0xc18)][_0x284562(0x412)](_0x29a3dc=>'-\x20'+_0x29a3dc[_0x284562(0x28c)])[_0x284562(0x1237)]('\x0a'):_0x284562(0x12c3))+_0x284562(0x86a)+_0xd56408+_0x284562(0x12e9)+_0x51dd45+_0x284562(0x2a1)+_0x9009d5+_0x284562(0xadf)+_0x27bc6a+_0x284562(0x39b)+_0x3a655c+'**:\x20'+_0x57df3a['settings'][_0x284562(0x6d4)]+_0x284562(0xae4)+_0x26083c+_0x284562(0x8b9)+_0x42518c+_0x284562(0xe32);}const _0xef27bc=_0x57df3a[_0x284562(0x551)][_0x284562(0x3d8)](_0x449e59=>!_0x449e59[_0x284562(0x9ae)])[_0x284562(0xdd0)](-0xa),_0x25e642=[{'role':_0x284562(0x18c),'content':_0x509d80},..._0xef27bc[_0x284562(0x412)](_0x38f214=>{const _0x2793a5=_0x284562,_0x202bf6=_0x38f214[_0x2793a5(0xa57)]===_0x2793a5(0x116c)?_0x3a655c:_0xb9963e(_0x57df3a,_0x38f214[_0x2793a5(0xcfc)]);let _0x56f122=_0x38f214[_0x2793a5(0x28c)];if(_0x38f214['type']==='ai_image'||_0x38f214[_0x2793a5(0x48c)]==='user_photo')_0x56f122=_0x2793a5(0x769)+_0x38f214[_0x2793a5(0x28c)]+'\x27]';else{if(_0x38f214['type']==='voice_message')_0x56f122=_0x2793a5(0x2cd)+_0x38f214[_0x2793a5(0x28c)]+'\x27]';else typeof _0x56f122!=='string'&&(_0x56f122=_0x2793a5(0x20b));}return{'role':_0x2793a5(0x116c),'content':_0x202bf6+':\x20'+_0x56f122};})];try{const _0x455fa3=[{'role':_0x284562(0x116c),'content':_0x509d80}];let _0xa00334=_0x72ddc5===GEMINI_API_URL,_0x5dc601=_0xa615f4(_0x9fa95d,_0x2c0730,_0x509d80,_0x455fa3);const _0x14285a=_0xa00334?await fetch(_0x5dc601['url'],_0x5dc601[_0x284562(0xd98)]):await fetch(_0x72ddc5+_0x284562(0x6dd),{'method':_0x284562(0xd14),'headers':{'Content-Type':_0x284562(0xce4),'Authorization':_0x284562(0x3fb)+_0x2c0730},'body':JSON[_0x284562(0x465)]({'model':_0x9fa95d,'messages':_0x455fa3,'temperature':_0x5b873d[_0x284562(0x21a)][_0x284562(0x576)]||0.9})});if(!_0x14285a['ok'])throw new Error((await _0x14285a[_0x284562(0x6b5)]())['error'][_0x284562(0x1288)]);const _0x30d70b=await _0x14285a[_0x284562(0x6b5)](),_0x590e0b=_0xa00334?_0x30d70b[_0x284562(0xb59)][0x0][_0x284562(0x28c)][_0x284562(0x496)][0x0][_0x284562(0xec9)]:_0x30d70b[_0x284562(0xd3b)][0x0][_0x284562(0x1288)][_0x284562(0x28c)],_0x19a768=_0x29a17f(_0x590e0b);if(!_0x19a768||_0x19a768[_0x284562(0x7aa)]===0x0){console[_0x284562(0xac3)](_0x284562(0x4bf)+_0x57df3a[_0x284562(0xf74)]+_0x284562(0xf38));return;}let _0x542dc7=Date['now'](),_0x539059=![],_0x47a203='',_0x1530a0='';const _0x5ed958=[];for(const _0x14e20b of _0x19a768){const _0x4ff09a=String(_0x14e20b['content']||''),_0x324cce=_0x4ff09a[_0x284562(0xc3a)]()[_0x284562(0x1222)]('<')&&_0x4ff09a[_0x284562(0xc3a)]()['endsWith']('>');if(_0x14e20b[_0x284562(0x48c)]===_0x284562(0xec9)&&!_0x324cce&&_0x4ff09a['includes']('\x0a')){const _0x1c1b82=_0x4ff09a['split'](/\n+/)['filter'](_0x173f69=>_0x173f69['trim']());_0x1c1b82[_0x284562(0xd9a)](_0x225730=>{const _0x498dda=_0x284562;_0x5ed958[_0x498dda(0x138c)]({..._0x14e20b,'content':_0x225730});});}else _0x5ed958[_0x284562(0x138c)](_0x14e20b);}for(const _0x589fc0 of _0x5ed958){if(!_0x589fc0||!_0x589fc0[_0x284562(0x48c)]||!_0x589fc0[_0x284562(0xf74)])continue;const _0x4ce516=_0xb9963e(_0x57df3a,_0x589fc0[_0x284562(0xf74)]);let _0x207a7d=null,_0x9332f8=null;const _0x1d40fb={'role':'assistant','senderName':_0x589fc0[_0x284562(0xf74)],'timestamp':_0x542dc7++};if(_0x589fc0[_0x284562(0x48c)]===_0x284562(0x213)){const _0x228ce0=_0x57df3a[_0x284562(0x551)][_0x284562(0x12f4)](_0x30f7ff=>_0x30f7ff[_0x284562(0x114e)]===_0x589fc0[_0x284562(0x430)]);if(_0x228ce0&&!_0x228ce0[_0x284562(0x9aa)]&&!(_0x228ce0[_0x284562(0xb37)]&&_0x228ce0[_0x284562(0xb37)][_0x589fc0[_0x284562(0xf74)]])){let _0x5d2613=0x0;const _0x40a3df=_0x228ce0[_0x284562(0x33e)]-Object['values'](_0x228ce0[_0x284562(0xb37)]||{})[_0x284562(0x11e2)]((_0x23ba3b,_0x28dd49)=>_0x23ba3b+_0x28dd49,0x0),_0x57bc14=_0x228ce0[_0x284562(0x749)]-Object[_0x284562(0xe9c)](_0x228ce0[_0x284562(0xb37)]||{})[_0x284562(0x7aa)];if(_0x57bc14>0x0){if(_0x57bc14===0x1)_0x5d2613=_0x40a3df;else{const _0x11dafc=0.01,_0x20a59f=_0x40a3df-(_0x57bc14-0x1)*_0x11dafc;_0x5d2613=Math[_0x284562(0xdc6)]()*(_0x20a59f-_0x11dafc)+_0x11dafc;}_0x5d2613=parseFloat(_0x5d2613['toFixed'](0x2));if(!_0x228ce0[_0x284562(0xb37)])_0x228ce0[_0x284562(0xb37)]={};_0x228ce0['claimedBy'][_0x589fc0['name']]=_0x5d2613,_0x57df3a[_0x284562(0x551)][_0x284562(0x138c)]({'role':'system','type':_0x284562(0xc7a),'content':_0x4ce516+'\x20领取了\x20'+_0xb9963e(_0x57df3a,_0x228ce0[_0x284562(0xcfc)])+_0x284562(0x232),'timestamp':Date['now']()});let _0x77bb88=_0x284562(0xf17)+_0x4ce516+_0x284562(0x508)+_0x5d2613['toFixed'](0x2)+'\x20元。';if(Object[_0x284562(0xe9c)](_0x228ce0[_0x284562(0xb37)])[_0x284562(0x7aa)]>=_0x228ce0['count']){_0x228ce0[_0x284562(0x9aa)]=!![],_0x57df3a[_0x284562(0x551)]['push']({'role':_0x284562(0x18c),'type':_0x284562(0xc7a),'content':_0xb9963e(_0x57df3a,_0x228ce0[_0x284562(0xcfc)])+_0x284562(0x796),'timestamp':Date['now']()+0x1});let _0xc91e16={'name':'','amount':-0x1};Object['entries'](_0x228ce0[_0x284562(0xb37)])[_0x284562(0xd9a)](([_0x5a0503,_0x4a1444])=>{const _0x16bade=_0x284562;_0x4a1444>_0xc91e16[_0x16bade(0x10a6)]&&(_0xc91e16={'name':_0x5a0503,'amount':_0x4a1444});});if(_0xc91e16[_0x284562(0xf74)]){const _0x5e5465=_0xb9963e(_0x57df3a,_0xc91e16[_0x284562(0xf74)]);_0x77bb88+='\x20红包已被领完，手气王是\x20'+_0x5e5465+'！';}}_0x77bb88+=_0x284562(0x3e5),_0x57df3a['history'][_0x284562(0x138c)]({'role':_0x284562(0x18c),'content':_0x77bb88,'timestamp':Date[_0x284562(0xf1a)]()+0x2,'isHidden':!![]});}}_0x539059=!![];continue;}switch(_0x589fc0[_0x284562(0x48c)]){case _0x284562(0x3c8):if(_0x589fc0['meaning']){const _0x5456c2=_0x5b873d['userStickers']['find'](_0x3ce217=>_0x3ce217[_0x284562(0xf74)]===_0x589fc0['meaning']);_0x5456c2?_0x9332f8={..._0x1d40fb,'type':_0x284562(0x3c8),'content':_0x5456c2[_0x284562(0x11de)],'meaning':_0x5456c2['name']}:(console[_0x284562(0xac3)](_0x284562(0xaee)+_0x589fc0[_0x284562(0xb5c)]+'\x22'),_0x9332f8={..._0x1d40fb,'type':_0x284562(0xec9),'content':_0x284562(0x507)+_0x589fc0['meaning']+']'});}else console[_0x284562(0xac3)](_0x284562(0x4b7),_0x589fc0),_0x9332f8={..._0x1d40fb,'type':_0x284562(0x3c8),'content':_0x589fc0[_0x284562(0x11de)],'meaning':_0x284562(0x6a3)};break;case _0x284562(0x8ed):const _0x308496={'type':_0x589fc0[_0x284562(0x2db)]||_0x284562(0x536),'content':_0x589fc0[_0x284562(0x28c)],'timestamp':Date['now'](),'authorId':_0x5b873d['chats'][Object[_0x284562(0xe9c)](_0x5b873d[_0x284562(0x667)])[_0x284562(0x12f4)](_0x3ad8ec=>_0x5b873d['chats'][_0x3ad8ec]['originalName']===_0x589fc0[_0x284562(0xf74)])]?.['id']||_0x589fc0['name'],'authorOriginalName':_0x589fc0[_0x284562(0xf74)],'visibleGroupIds':null};await _0x1a6951[_0x284562(0xea0)]['add'](_0x308496),_0x3cd1c0(_0x111a81+0x1),_0x207a7d={'content':'['+_0x4ce516+'\x20发布了一条新动态]'};break;case _0x284562(0xe7b):const _0x176093=await _0x1a6951['qzonePosts'][_0x284562(0x650)](parseInt(_0x589fc0[_0x284562(0x7b6)]));if(_0x176093){if(!_0x176093['comments'])_0x176093[_0x284562(0x1157)]=[];_0x176093[_0x284562(0x1157)][_0x284562(0x138c)]({'commenterName':_0x589fc0[_0x284562(0xf74)],'text':_0x589fc0[_0x284562(0x1202)],'timestamp':Date[_0x284562(0xf1a)]()}),await _0x1a6951['qzonePosts'][_0x284562(0xdfc)](_0x176093['id'],{'comments':_0x176093[_0x284562(0x1157)]}),_0x3cd1c0(_0x111a81+0x1),_0x207a7d={'content':'['+_0x4ce516+_0x284562(0x1278)};}break;case'qzone_like':const _0x112b90=await _0x1a6951['qzonePosts'][_0x284562(0x650)](parseInt(_0x589fc0['postId']));if(_0x112b90){if(!_0x112b90['likes'])_0x112b90['likes']=[];!_0x112b90[_0x284562(0xfe6)][_0x284562(0xced)](_0x589fc0[_0x284562(0xf74)])&&(_0x112b90[_0x284562(0xfe6)][_0x284562(0x138c)](_0x589fc0['name']),await _0x1a6951[_0x284562(0xea0)][_0x284562(0xdfc)](_0x112b90['id'],{'likes':_0x112b90[_0x284562(0xfe6)]}),_0x3cd1c0(_0x111a81+0x1),_0x207a7d={'content':'['+_0x4ce516+'\x20点赞了动态]'});}break;case _0x284562(0x656):_0x9332f8={..._0x1d40fb,'type':_0x284562(0x656),'content':_0x589fc0[_0x284562(0xf6e)],'image_prompt':msgData[_0x284562(0x895)]};break;default:if(_0x589fc0[_0x284562(0x48c)]==='poll'){const _0x3d5afb=typeof _0x589fc0[_0x284562(0x1034)]===_0x284562(0x1224)?_0x589fc0[_0x284562(0x1034)]['split']('\x0a')[_0x284562(0x3d8)](_0x3c6057=>_0x3c6057['trim']()):Array[_0x284562(0xbd6)](_0x589fc0[_0x284562(0x1034)])?_0x589fc0[_0x284562(0x1034)]:[];if(_0x3d5afb[_0x284562(0x7aa)]<0x2)continue;_0x9332f8={..._0x1d40fb,..._0x589fc0,'options':_0x3d5afb,'votes':{},'isClosed':![]};}else{const _0xaffe61=_0x589fc0[_0x284562(0x28c)]||_0x589fc0['message'];_0x9332f8={..._0x1d40fb,..._0x589fc0};if(_0xaffe61)_0x9332f8[_0x284562(0x28c)]=_0xaffe61;}break;}if(_0x207a7d)_0x57df3a[_0x284562(0x551)]['push']({'role':_0x284562(0x18c),'type':_0x284562(0xc7a),'content':_0x207a7d['content'],'timestamp':_0x542dc7++});else _0x9332f8&&(_0x57df3a[_0x284562(0x551)]['push'](_0x9332f8),!_0x1530a0&&(_0x1530a0=_0x4ce516,_0x47a203=_0x9332f8['type']===_0x284562(0x656)?'[图片]':_0x9332f8['content']||'['+_0x9332f8[_0x284562(0x48c)]+']'));_0x539059=!![];}_0x539059&&(_0x57df3a[_0x284562(0x923)]=Date[_0x284562(0xf1a)](),_0x57df3a[_0x284562(0x3ce)]=(_0x57df3a[_0x284562(0x3ce)]||0x0)+_0x19a768[_0x284562(0x3d8)](_0x53ffa7=>_0x53ffa7['type']!=='qzone_post'&&_0x53ffa7[_0x284562(0x48c)]!==_0x284562(0xe7b)&&_0x53ffa7[_0x284562(0x48c)]!==_0x284562(0xa87))[_0x284562(0x7aa)],_0x1530a0&&_0x47a203&&_0x23fbd5(_0x1d82dc,_0x1530a0+':\x20'+_0x47a203),await _0x1a6951[_0x284562(0x667)][_0x284562(0xc0f)](_0x57df3a));}catch(_0x7cb17c){console[_0x284562(0x1fd)]('群聊\x20\x22'+_0x57df3a[_0x284562(0xf74)]+_0x284562(0x5e1),_0x7cb17c);}finally{_0x413d78();}}function _0x5806c0(_0x409a5d,_0x1b7ff6,_0x1d66e3){const _0x7e64d6=_0x41eae2,_0x3ac18a=document[_0x7e64d6(0x89d)](_0x1d66e3);if(!_0x3ac18a)return;if(!_0x409a5d||_0x409a5d['trim']()===''){_0x3ac18a[_0x7e64d6(0x1ef)]='';return;}const _0x190c6f=_0x409a5d[_0x7e64d6(0xfbf)](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x1b7ff6+_0x7e64d6(0x919))[_0x7e64d6(0xfbf)](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x1b7ff6+_0x7e64d6(0x1023))['replace'](/\s*\.message-bubble\s+([^{]+\{)/g,_0x1b7ff6+_0x7e64d6(0x1318));_0x3ac18a[_0x7e64d6(0x1ef)]=_0x190c6f;}async function _0x540a41(){const _0x1041d0=_0x41eae2;if(!_0x5b873d[_0x1041d0(0xf96)])return;const _0x26f269=_0x5b873d[_0x1041d0(0x667)][_0x5b873d[_0x1041d0(0xf96)]],_0x1b899f=document[_0x1041d0(0x89d)](_0x1041d0(0x50c));if(!_0x1b899f)return;const _0x8eede6=document[_0x1041d0(0xd16)](_0x1041d0(0x847))?.['value']||_0x1041d0(0xfb4),_0x5e2256=document['getElementById'](_0x1041d0(0x102b))[_0x1041d0(0x2f4)],_0x5bee0e=document[_0x1041d0(0x89d)](_0x1041d0(0xf37))[_0x1041d0(0x2f4)],_0x19cc96=_0x26f269[_0x1041d0(0xdb9)][_0x1041d0(0x55c)];_0x1b899f['dataset'][_0x1041d0(0x85e)]=_0x8eede6,_0x1b899f[_0x1041d0(0x68e)]['setProperty'](_0x1041d0(0x1d7),_0x5e2256+'px');_0x19cc96&&_0x19cc96[_0x1041d0(0x1222)](_0x1041d0(0xcaa))?(_0x1b899f[_0x1041d0(0x68e)][_0x1041d0(0x1d4)]=_0x1041d0(0xa0c)+_0x19cc96+')',_0x1b899f[_0x1041d0(0x68e)]['backgroundColor']=_0x1041d0(0x6b4)):(_0x1b899f[_0x1041d0(0x68e)][_0x1041d0(0x1d4)]=_0x1041d0(0x10f2),_0x1b899f[_0x1041d0(0x68e)][_0x1041d0(0x55c)]=_0x19cc96||_0x1041d0(0x1022));_0x1b899f['innerHTML']='';const _0x3422d8={'role':'ai','content':_0x1041d0(0xd5b),'timestamp':0x1,'senderName':_0x26f269[_0x1041d0(0xf74)]},_0x57cfc0=await _0x1ed144(_0x3422d8,_0x26f269);if(_0x57cfc0)_0x1b899f['appendChild'](_0x57cfc0);const _0x2dcd={'role':_0x1041d0(0x116c),'content':_0x1041d0(0x6b1),'timestamp':0x2},_0x57887c=await _0x1ed144(_0x2dcd,_0x26f269);if(_0x57887c)_0x1b899f['appendChild'](_0x57887c);const _0x46488e=document[_0x1041d0(0x285)]('div');_0x46488e[_0x1041d0(0x68e)][_0x1041d0(0x137a)]=_0x1041d0(0x6e7),_0x46488e['textContent']='♪\x20歌词位置预览\x20♪',_0x1b899f['appendChild'](_0x46488e);const _0x1b741f=document['getElementById'](_0x1041d0(0x5d9))[_0x1041d0(0x2f4)],_0x3320ec=document[_0x1041d0(0x89d)](_0x1041d0(0xe99))['value'],_0x51d3d1=parseInt(document[_0x1041d0(0x89d)](_0x1041d0(0x1146))['value'])||0xa;_0x1b741f===_0x1041d0(0x113d)?_0x46488e[_0x1041d0(0x68e)][_0x1041d0(0x113d)]=_0x51d3d1+'px':_0x46488e['style'][_0x1041d0(0xc74)]=_0x51d3d1+'px';switch(_0x3320ec){case _0x1041d0(0x1004):_0x46488e[_0x1041d0(0x68e)]['left']=_0x1041d0(0xf92);break;case _0x1041d0(0x5f0):_0x46488e[_0x1041d0(0x68e)][_0x1041d0(0x5f0)]=_0x1041d0(0xf92);break;default:_0x46488e[_0x1041d0(0x68e)][_0x1041d0(0x1004)]=_0x1041d0(0xaed),_0x46488e['style'][_0x1041d0(0x9ab)]='translateX(-50%)';break;}_0x5806c0(_0x5bee0e,_0x1041d0(0x997),_0x1041d0(0xaa5));}async function _0xd3fe66(){const _0x6bfa24=_0x41eae2;await _0xd5e0db(),document[_0x6bfa24(0x89d)](_0x6bfa24(0x1a0))['classList'][_0x6bfa24(0x569)](_0x6bfa24(0x11e4));}async function _0xd5e0db(){const _0x2d4946=_0x41eae2,_0x322335=document['getElementById'](_0x2d4946(0x3ec)),_0x4780ae=await _0x1a6951[_0x2d4946(0x95b)][_0x2d4946(0xc2f)]();_0x322335[_0x2d4946(0x1ef)]='',_0x4780ae[_0x2d4946(0x7aa)]===0x0&&(_0x322335[_0x2d4946(0x1ef)]=_0x2d4946(0x2e1)),_0x4780ae['forEach'](_0x17165b=>{const _0x2d0e7d=_0x2d4946,_0x1148d2=document[_0x2d0e7d(0x285)](_0x2d0e7d(0xb25));_0x1148d2['className']=_0x2d0e7d(0xebb),_0x1148d2[_0x2d0e7d(0x1ef)]=_0x2d0e7d(0xa45)+_0x17165b[_0x2d0e7d(0xf74)]+_0x2d0e7d(0xe4c)+_0x17165b['id']+_0x2d0e7d(0xd39),_0x322335[_0x2d0e7d(0x22f)](_0x1148d2);});}async function _0x58e920(){const _0x4e77e5=_0x41eae2,_0x5e435e=document[_0x4e77e5(0x89d)](_0x4e77e5(0x10cb)),_0x36763f=_0x5e435e[_0x4e77e5(0x2f4)][_0x4e77e5(0xc3a)]();if(!_0x36763f){alert('分组名不能为空！');return;}const _0x32ba66=await _0x1a6951['qzoneGroups'][_0x4e77e5(0x176)]('name')[_0x4e77e5(0xb17)](_0x36763f)[_0x4e77e5(0x2a6)]();if(_0x32ba66){alert(_0x4e77e5(0x1208)+_0x36763f+_0x4e77e5(0xcc1));return;}await _0x1a6951[_0x4e77e5(0x95b)][_0x4e77e5(0x569)]({'name':_0x36763f}),_0x5e435e[_0x4e77e5(0x2f4)]='',await _0xd5e0db();}async function _0x440cb8(_0x2b851c){const _0x4b7bb8=_0x41eae2,_0x5339a7=await _0x4e2abc(_0x4b7bb8(0x3da),'删除分组后，该组内的好友将变为“未分组”。确定要删除吗？',{'confirmButtonClass':'btn-danger'});if(_0x5339a7){await _0x1a6951[_0x4b7bb8(0x95b)][_0x4b7bb8(0x684)](_0x2b851c);const _0x1dcc7f=await _0x1a6951[_0x4b7bb8(0x667)][_0x4b7bb8(0x176)](_0x4b7bb8(0xb54))[_0x4b7bb8(0xb17)](_0x2b851c)[_0x4b7bb8(0xc2f)]();for(const _0x2bbd3e of _0x1dcc7f){_0x2bbd3e['groupId']=null,await _0x1a6951[_0x4b7bb8(0x667)][_0x4b7bb8(0xc0f)](_0x2bbd3e);if(_0x5b873d[_0x4b7bb8(0x667)][_0x2bbd3e['id']])_0x5b873d['chats'][_0x2bbd3e['id']][_0x4b7bb8(0xb54)]=null;}await _0xd5e0db();}}function _0x57d678(_0x38cf19){const _0x4a13f9=_0x41eae2,_0x3122a3=_0x5b873d[_0x4a13f9(0x667)][_0x5b873d[_0x4a13f9(0xf96)]];document[_0x4a13f9(0x89d)](_0x4a13f9(0x386))['style'][_0x4a13f9(0x126b)]=_0x3122a3['isGroup']?_0x4a13f9(0x1118):_0x4a13f9(0x10f2);if(_0x17f18d)return;_0x1cefba=_0x38cf19,document[_0x4a13f9(0x89d)](_0x4a13f9(0x1d3))[_0x4a13f9(0x2f1)][_0x4a13f9(0x569)](_0x4a13f9(0x11e4));}function _0x5348af(){const _0x407ed3=_0x41eae2;document['getElementById'](_0x407ed3(0x1d3))[_0x407ed3(0x2f1)]['remove'](_0x407ed3(0x11e4)),_0x1cefba=null;}async function _0x1e1f69(){const _0x397888=_0x41eae2;if(!_0x1cefba)return;const _0x36cc53=_0x1cefba,_0x466cfc=_0x5b873d[_0x397888(0x667)][_0x5b873d[_0x397888(0xf96)]],_0x1a8d91=_0x466cfc[_0x397888(0x551)][_0x397888(0x12f4)](_0x364d59=>_0x364d59[_0x397888(0x114e)]===_0x36cc53);if(!_0x1a8d91)return;_0x5348af();let _0x119d84;const _0x534cff=_0x1a8d91[_0x397888(0x48c)]&&[_0x397888(0xff9),'ai_image',_0x397888(0x1075),_0x397888(0x1d8)][_0x397888(0xced)](_0x1a8d91[_0x397888(0x48c)]);if(_0x534cff){let _0x44b920={'type':_0x1a8d91['type']};if(_0x1a8d91['type']===_0x397888(0xff9))_0x44b920[_0x397888(0x28c)]=_0x1a8d91[_0x397888(0x28c)];else{if(_0x1a8d91[_0x397888(0x48c)]===_0x397888(0x656))_0x44b920['description']=_0x1a8d91['content'];else{if(_0x1a8d91['type']===_0x397888(0x1075))_0x44b920[_0x397888(0x10a6)]=_0x1a8d91[_0x397888(0x10a6)],_0x44b920[_0x397888(0xa17)]=_0x1a8d91[_0x397888(0xa17)];else _0x1a8d91['type']===_0x397888(0x1d8)&&(_0x44b920[_0x397888(0x104c)]=_0x1a8d91[_0x397888(0x104c)],_0x44b920[_0x397888(0xf6e)]=_0x1a8d91[_0x397888(0xf6e)],_0x44b920[_0x397888(0x573)]=_0x1a8d91[_0x397888(0x573)],_0x44b920[_0x397888(0x28c)]=_0x1a8d91['content']);}}_0x119d84=JSON[_0x397888(0x465)](_0x44b920,null,0x2);}else typeof _0x1a8d91[_0x397888(0x28c)]===_0x397888(0x7af)?_0x119d84=JSON['stringify'](_0x1a8d91[_0x397888(0x28c)],null,0x2):_0x119d84=_0x1a8d91['content'];const _0x1d0c7d={'voice':{'type':_0x397888(0xff9),'content':'在这里输入语音内容'},'image':{'type':_0x397888(0x656),'description':_0x397888(0x1330)},'transfer':{'type':_0x397888(0x1075),'amount':5.2,'note':_0x397888(0x6f0)},'link':{'type':_0x397888(0x1d8),'title':_0x397888(0x707),'description':'文章摘要...','source_name':'来源网站','content':_0x397888(0x3bd)}},_0x454f41=_0x397888(0x600)+JSON[_0x397888(0x465)](_0x1d0c7d[_0x397888(0xf98)])+_0x397888(0x11a2)+JSON[_0x397888(0x465)](_0x1d0c7d[_0x397888(0xbef)])+'\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x397888(0x465)](_0x1d0c7d[_0x397888(0x1075)])+'\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x1d0c7d['link'])+_0x397888(0xc72),_0x496347=await _0x34d246(_0x397888(0x1074),_0x397888(0xb43),_0x119d84,_0x397888(0x11b9),_0x454f41);_0x496347!==null&&await _0x17e14b(_0x36cc53,_0x496347,!![]);}async function _0x502654(){const _0xa910c3=_0x41eae2;if(!_0x1cefba)return;const _0x56c2d9=_0x5b873d[_0xa910c3(0x667)][_0x5b873d['activeChatId']],_0x13c777=_0x56c2d9['history']['find'](_0x479536=>_0x479536[_0xa910c3(0x114e)]===_0x1cefba);if(!_0x13c777)return;let _0x2b7cf6;typeof _0x13c777[_0xa910c3(0x28c)]==='object'?_0x2b7cf6=JSON[_0xa910c3(0x465)](_0x13c777[_0xa910c3(0x28c)]):_0x2b7cf6=String(_0x13c777[_0xa910c3(0x28c)]);try{await navigator[_0xa910c3(0x23b)]['writeText'](_0x2b7cf6),await _0x532f76(_0xa910c3(0x11ff),_0xa910c3(0x332));}catch(_0x1953dd){await _0x532f76('复制失败',_0xa910c3(0x1f4));}_0x5348af();}async function _0x2a7688(){const _0x4afdb1=_0x41eae2;if(!_0x1cefba)return;try{await navigator['clipboard'][_0x4afdb1(0xb27)](_0x1cefba),await _0x532f76(_0x4afdb1(0x11ff),'消息时间戳\x20'+_0x1cefba+'\x20已复制到剪贴板。');}catch(_0x19b8af){await _0x532f76(_0x4afdb1(0x611),_0x4afdb1(0x1f4));}_0x5348af();}function _0x3ef6ab(_0x15ff14=''){const _0x4505fa=_0x41eae2,_0x280991=document[_0x4505fa(0x285)]('div');_0x280991[_0x4505fa(0x81c)]=_0x4505fa(0x828);const _0xe25c5d={'voice':{'type':_0x4505fa(0xff9),'content':_0x4505fa(0x785)},'image':{'type':_0x4505fa(0x656),'description':_0x4505fa(0x1330)},'transfer':{'type':'transfer','amount':5.2,'note':'一点心意'},'link':{'type':_0x4505fa(0x1d8),'title':_0x4505fa(0x707),'description':_0x4505fa(0x84f),'source_name':_0x4505fa(0xc09),'content':_0x4505fa(0x3bd)},'offline':{'type':_0x4505fa(0x910),'content':_0x4505fa(0x10c9)},'quote':{'type':_0x4505fa(0x6cf),'target_timestamp':0x499602d2,'reply_content':_0x4505fa(0x994)}};return _0x280991[_0x4505fa(0x1ef)]=_0x4505fa(0x3a7)+_0x15ff14+_0x4505fa(0x76d)+JSON[_0x4505fa(0x465)](_0xe25c5d['voice'])+'\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x4505fa(0x465)](_0xe25c5d[_0x4505fa(0xbef)])+'\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0xe25c5d[_0x4505fa(0x1075)])+_0x4505fa(0x25f)+JSON[_0x4505fa(0x465)](_0xe25c5d[_0x4505fa(0xb83)])+_0x4505fa(0x20c)+JSON['stringify'](_0xe25c5d['offline'])+_0x4505fa(0x8f8)+JSON['stringify'](_0xe25c5d['quote'])+'\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x280991[_0x4505fa(0xd16)](_0x4505fa(0x66f))['addEventListener'](_0x4505fa(0x12a5),()=>{const _0x5bcaef=_0x4505fa;document['querySelectorAll'](_0x5bcaef(0x214))[_0x5bcaef(0x7aa)]>0x1?_0x280991[_0x5bcaef(0x1247)]():alert('至少需要保留一条消息。');}),_0x280991['querySelectorAll'](_0x4505fa(0xbee))[_0x4505fa(0xd9a)](_0xa23b39=>{const _0x2f9e9d=_0x4505fa;_0xa23b39[_0x2f9e9d(0x1193)](_0x2f9e9d(0x12a5),()=>{const _0x2dd84a=_0x2f9e9d,_0x1a6554=_0xa23b39[_0x2dd84a(0xaaf)][_0x2dd84a(0x196)],_0xa49955=_0x280991[_0x2dd84a(0xd16)](_0x2dd84a(0x11b9));if(_0x1a6554&&_0xa49955)try{const _0x3bd155=JSON[_0x2dd84a(0x2cb)](_0x1a6554);_0xa49955[_0x2dd84a(0x2f4)]=JSON[_0x2dd84a(0x465)](_0x3bd155,null,0x2),_0xa49955[_0x2dd84a(0xbf6)]();}catch(_0x4af301){console[_0x2dd84a(0x1fd)](_0x2dd84a(0x2ed),_0x4af301);}});}),_0x280991;}function _0x1c739d(){const _0x431aac=_0x41eae2;if(!_0x1cefba)return;const _0x20a342=_0x1cefba,_0x3a9c71=_0x5b873d[_0x431aac(0x667)][_0x5b873d[_0x431aac(0xf96)]],_0x375a93=_0x3a9c71[_0x431aac(0x551)][_0x431aac(0x12f4)](_0x50676e=>_0x50676e['timestamp']===_0x20a342);if(!_0x375a93)return;_0x5348af();const _0x5b35c6=document[_0x431aac(0x89d)](_0x431aac(0xfcd)),_0x40e0f3=document[_0x431aac(0x89d)](_0x431aac(0x16e));_0x40e0f3[_0x431aac(0x1ef)]='';let _0x45765d;if(_0x375a93['quote']){const _0x5f2e54={'type':_0x431aac(0x6cf),'target_timestamp':_0x375a93['quote'][_0x431aac(0x114e)],'reply_content':_0x375a93[_0x431aac(0x28c)]};_0x45765d=JSON[_0x431aac(0x465)](_0x5f2e54,null,0x2);}else{if(_0x375a93[_0x431aac(0x48c)]&&[_0x431aac(0xff9),_0x431aac(0x656),_0x431aac(0x1075),_0x431aac(0x910),_0x431aac(0x1d8)][_0x431aac(0xced)](_0x375a93[_0x431aac(0x48c)])){let _0x228d28={'type':_0x375a93[_0x431aac(0x48c)]};if(_0x375a93[_0x431aac(0x48c)]===_0x431aac(0xff9))_0x228d28[_0x431aac(0x28c)]=_0x375a93['content'];else{if(_0x375a93['type']===_0x431aac(0x656))_0x228d28[_0x431aac(0xf6e)]=_0x375a93['content'];else{if(_0x375a93[_0x431aac(0x48c)]===_0x431aac(0x1075))_0x228d28[_0x431aac(0x10a6)]=_0x375a93['amount'],_0x228d28[_0x431aac(0xa17)]=_0x375a93[_0x431aac(0xa17)];else{if(_0x375a93[_0x431aac(0x48c)]===_0x431aac(0x910))_0x375a93[_0x431aac(0x28c)]?_0x228d28[_0x431aac(0x28c)]=_0x375a93[_0x431aac(0x28c)]:(_0x228d28['dialogue']=_0x375a93['dialogue'],_0x228d28[_0x431aac(0xf6e)]=_0x375a93[_0x431aac(0xf6e)]);else _0x375a93['type']===_0x431aac(0x1d8)&&(_0x228d28[_0x431aac(0x104c)]=_0x375a93[_0x431aac(0x104c)],_0x228d28[_0x431aac(0xf6e)]=_0x375a93[_0x431aac(0xf6e)],_0x228d28[_0x431aac(0x573)]=_0x375a93[_0x431aac(0x573)],_0x228d28[_0x431aac(0x28c)]=_0x375a93[_0x431aac(0x28c)]);}}}_0x45765d=JSON[_0x431aac(0x465)](_0x228d28,null,0x2);}else typeof _0x375a93[_0x431aac(0x28c)]===_0x431aac(0x7af)?_0x45765d=JSON[_0x431aac(0x465)](_0x375a93['content'],null,0x2):_0x45765d=_0x375a93[_0x431aac(0x28c)];}const _0x5ea0ef=_0x3ef6ab(_0x45765d);_0x40e0f3[_0x431aac(0x22f)](_0x5ea0ef);const _0x7405f9=document[_0x431aac(0x89d)](_0x431aac(0x12e3)),_0x1530b4=_0x7405f9[_0x431aac(0xf2a)](!![]);_0x7405f9['parentNode'][_0x431aac(0xd38)](_0x1530b4,_0x7405f9),_0x1530b4[_0x431aac(0x1193)](_0x431aac(0x12a5),()=>{const _0x2b2093=_0x431aac,_0xeb8f8d=_0x3ef6ab();_0x40e0f3[_0x2b2093(0x22f)](_0xeb8f8d),_0xeb8f8d[_0x2b2093(0xd16)](_0x2b2093(0x11b9))[_0x2b2093(0xbf6)]();});const _0x46b413=document[_0x431aac(0x89d)](_0x431aac(0x112f)),_0x5950a5=_0x46b413[_0x431aac(0xf2a)](!![]);_0x46b413[_0x431aac(0xb6e)]['replaceChild'](_0x5950a5,_0x46b413),_0x5950a5[_0x431aac(0x1193)](_0x431aac(0x12a5),()=>{const _0xfdb9f7=_0x431aac;_0x5b35c6[_0xfdb9f7(0x2f1)][_0xfdb9f7(0x1247)](_0xfdb9f7(0x11e4));});const _0x41ce9a=document[_0x431aac(0x89d)]('save-advanced-editor-btn'),_0x8b0f9a=_0x41ce9a[_0x431aac(0xf2a)](!![]);_0x41ce9a[_0x431aac(0xb6e)]['replaceChild'](_0x8b0f9a,_0x41ce9a),_0x8b0f9a['addEventListener'](_0x431aac(0x12a5),()=>{_0x17e14b(_0x20a342);}),_0x5b35c6[_0x431aac(0x2f1)][_0x431aac(0x569)](_0x431aac(0x11e4));}async function _0x502654(){const _0x33ac98=_0x41eae2;if(!_0x1cefba)return;const _0x46c584=_0x5b873d[_0x33ac98(0x667)][_0x5b873d[_0x33ac98(0xf96)]],_0x4fbe51=_0x46c584[_0x33ac98(0x551)]['find'](_0x2d00d8=>_0x2d00d8[_0x33ac98(0x114e)]===_0x1cefba);if(!_0x4fbe51)return;let _0x555b3b;if(_0x4fbe51[_0x33ac98(0x48c)]===_0x33ac98(0x910))_0x4fbe51[_0x33ac98(0x28c)]?_0x555b3b=_0x4fbe51['content']:_0x555b3b='「'+(_0x4fbe51[_0x33ac98(0xa03)]||'')+'」\x0a'+(_0x4fbe51[_0x33ac98(0xf6e)]||'');else typeof _0x4fbe51[_0x33ac98(0x28c)]===_0x33ac98(0x7af)?_0x555b3b=JSON[_0x33ac98(0x465)](_0x4fbe51[_0x33ac98(0x28c)]):_0x555b3b=String(_0x4fbe51['content']);try{await navigator[_0x33ac98(0x23b)][_0x33ac98(0xb27)](_0x555b3b),await _0x532f76('复制成功',_0x33ac98(0x332));}catch(_0x325337){await _0x532f76(_0x33ac98(0x611),'无法访问剪贴板。');}_0x5348af();}function _0x17997b(_0x1f9ee7){const _0x2b15e9=_0x41eae2,_0x33d7d0=_0x1f9ee7[_0x2b15e9(0xc3a)]();if(_0x33d7d0[_0x2b15e9(0x1222)]('{')&&_0x33d7d0['endsWith']('}'))try{const _0x165e21=JSON[_0x2b15e9(0x2cb)](_0x33d7d0);if(_0x165e21['type'])return _0x165e21;}catch(_0x5e7099){}if(_0x3b71b1[_0x2b15e9(0xb80)](_0x33d7d0))return{'type':'sticker','content':_0x33d7d0};return{'type':_0x2b15e9(0xec9),'content':_0x33d7d0};}async function _0x17e14b(_0x1a6178,_0x338f1f=null){const _0x244e73=_0x41eae2;if(!_0x1a6178)return;const _0x17b983=_0x5b873d[_0x244e73(0x667)][_0x5b873d[_0x244e73(0xf96)]],_0x25c466=_0x17b983[_0x244e73(0x551)][_0x244e73(0x9d7)](_0x439dec=>_0x439dec['timestamp']===_0x1a6178);if(_0x25c466===-0x1)return;const _0x459f2f=_0x17b983[_0x244e73(0x551)][_0x25c466];let _0x3382d5=[];const _0x514207=_0x338f1f!==null?[_0x338f1f]:Array['from'](document[_0x244e73(0x35f)](_0x244e73(0xf33)))['map'](_0x3c5d35=>_0x3c5d35[_0x244e73(0x2f4)]);for(const _0x26e599 of _0x514207){if(!_0x26e599['trim']())continue;const _0x3009cf=_0x17997b(_0x26e599['trim']()),_0x1ce0f4={'role':_0x459f2f['role'],'senderName':_0x459f2f[_0x244e73(0xcfc)],'timestamp':_0x459f2f[_0x244e73(0x114e)]};switch(_0x3009cf['type']){case _0x244e73(0xec9):_0x1ce0f4[_0x244e73(0x48c)]=_0x244e73(0xec9),_0x1ce0f4[_0x244e73(0x28c)]=_0x3009cf['content'];break;case _0x244e73(0x910):_0x1ce0f4[_0x244e73(0x48c)]=_0x244e73(0x910);_0x3009cf[_0x244e73(0x28c)]?_0x1ce0f4['content']=_0x3009cf[_0x244e73(0x28c)]:(_0x1ce0f4['dialogue']=_0x3009cf[_0x244e73(0xa03)],_0x1ce0f4[_0x244e73(0xf6e)]=_0x3009cf[_0x244e73(0xf6e)]);break;case _0x244e73(0x6cf):_0x1ce0f4[_0x244e73(0x48c)]=_0x244e73(0x6cf),_0x1ce0f4['content']=_0x3009cf['reply_content'];const _0xb07a09=_0x17b983[_0x244e73(0x551)][_0x244e73(0x12f4)](_0x1fd670=>_0x1fd670['timestamp']===_0x3009cf[_0x244e73(0x36e)]);if(_0xb07a09){let _0x482f63=_0xb07a09[_0x244e73(0xcfc)];_0xb07a09[_0x244e73(0xa57)]===_0x244e73(0x116c)&&(_0x482f63=_0x5b873d[_0x244e73(0x5c1)][_0x244e73(0x22a)]||_0x244e73(0x1285)),_0x1ce0f4[_0x244e73(0x1ff)]={'timestamp':_0x3009cf[_0x244e73(0x36e)],'senderName':_0x482f63,'content':String(_0xb07a09[_0x244e73(0x28c)]||'')};}else _0x1ce0f4[_0x244e73(0x1ff)]={'timestamp':_0x3009cf[_0x244e73(0x36e)],'senderName':_0x244e73(0x25e),'content':'原始消息已删除或不存在'};break;case'voice_message':case'ai_image':case _0x244e73(0x11f6):_0x1ce0f4['type']=_0x3009cf[_0x244e73(0x48c)],_0x1ce0f4['content']=_0x3009cf[_0x244e73(0x28c)]||_0x3009cf[_0x244e73(0xf6e)];if(_0x3009cf[_0x244e73(0xb5c)])_0x1ce0f4['meaning']=_0x3009cf['meaning'];break;case _0x244e73(0x3c8):{_0x1ce0f4[_0x244e73(0x48c)]=_0x244e73(0x3c8);let _0x4ec926=![];if(_0x3009cf['meaning']){const _0x2c026d=_0x5b873d[_0x244e73(0x210)]['find'](_0x5ce8a2=>_0x5ce8a2[_0x244e73(0xf74)]===_0x3009cf['meaning']);_0x2c026d?(_0x1ce0f4['content']=_0x2c026d['url'],_0x1ce0f4[_0x244e73(0xb5c)]=_0x2c026d[_0x244e73(0xf74)],console['log'](_0x244e73(0x48d)),_0x4ec926=!![]):(_0x1ce0f4[_0x244e73(0x48c)]='text',_0x1ce0f4[_0x244e73(0x28c)]=_0x244e73(0x507)+_0x3009cf[_0x244e73(0xb5c)]+']',console[_0x244e73(0xac3)](_0x244e73(0xda2),_0x3009cf[_0x244e73(0xb5c)]),_0x4ec926=!![]);}if(!_0x4ec926&&_0x3009cf[_0x244e73(0x11de)]){_0x1ce0f4[_0x244e73(0x28c)]=_0x3009cf[_0x244e73(0x11de)];const _0x10d095=_0x5b873d[_0x244e73(0x210)][_0x244e73(0x12f4)](_0x444679=>_0x444679[_0x244e73(0x11de)]===_0x3009cf[_0x244e73(0x11de)]);if(_0x3009cf['meaning']&&(!_0x10d095||_0x10d095[_0x244e73(0xf74)]===_0x3009cf[_0x244e73(0xb5c)]))_0x1ce0f4['meaning']=_0x3009cf[_0x244e73(0xb5c)];else _0x10d095?_0x1ce0f4['meaning']=_0x10d095['name']:_0x1ce0f4[_0x244e73(0xb5c)]='未知表情';console[_0x244e73(0x471)](_0x244e73(0x103c),_0x1ce0f4[_0x244e73(0xb5c)]),_0x4ec926=!![];}if(!_0x4ec926&&_0x3009cf[_0x244e73(0x28c)]&&typeof _0x3009cf['content']===_0x244e73(0x1224)&&_0x3b71b1[_0x244e73(0xb80)](_0x3009cf['content'])){_0x1ce0f4[_0x244e73(0x28c)]=_0x3009cf[_0x244e73(0x28c)];const _0x2440a0=_0x5b873d[_0x244e73(0x210)][_0x244e73(0x12f4)](_0x1e797b=>_0x1e797b['url']===_0x3009cf[_0x244e73(0x28c)]);_0x1ce0f4[_0x244e73(0xb5c)]=_0x2440a0?_0x2440a0[_0x244e73(0xf74)]:'未知表情',console[_0x244e73(0x471)]('导演/编辑模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:',_0x1ce0f4[_0x244e73(0xb5c)]),_0x4ec926=!![];}if(!_0x4ec926){console[_0x244e73(0x1fd)](_0x244e73(0x978),_0x3009cf);continue;}break;}case _0x244e73(0x1075):_0x1ce0f4[_0x244e73(0x48c)]='transfer',_0x1ce0f4[_0x244e73(0x10a6)]=_0x3009cf['amount'],_0x1ce0f4[_0x244e73(0xa17)]=_0x3009cf[_0x244e73(0xa17)];break;case _0x244e73(0x1d8):_0x1ce0f4[_0x244e73(0x48c)]=_0x244e73(0x1d8),_0x1ce0f4[_0x244e73(0x104c)]=_0x3009cf[_0x244e73(0x104c)],_0x1ce0f4[_0x244e73(0xf6e)]=_0x3009cf[_0x244e73(0xf6e)],_0x1ce0f4['source_name']=_0x3009cf[_0x244e73(0x573)],_0x1ce0f4[_0x244e73(0x28c)]=_0x3009cf[_0x244e73(0x28c)];break;default:Object[_0x244e73(0x4e0)](_0x1ce0f4,_0x3009cf);break;}_0x3382d5[_0x244e73(0x138c)](_0x1ce0f4);}if(_0x3382d5[_0x244e73(0x7aa)]===0x0){document['getElementById']('message-editor-modal')['classList'][_0x244e73(0x1247)](_0x244e73(0x11e4));return;}_0x17b983[_0x244e73(0x551)][_0x244e73(0x776)](_0x25c466,0x1,..._0x3382d5);let _0x49210a=_0x1a6178;for(let _0x536c2b=_0x25c466;_0x536c2b<_0x17b983['history'][_0x244e73(0x7aa)];_0x536c2b++){_0x17b983['history'][_0x536c2b][_0x244e73(0x114e)]=_0x49210a,_0x49210a++;}await _0x1a6951[_0x244e73(0x667)]['put'](_0x17b983),document[_0x244e73(0x89d)]('message-editor-modal')[_0x244e73(0x2f1)][_0x244e73(0x1247)](_0x244e73(0x11e4)),_0x5b89df(_0x5b873d[_0x244e73(0xf96)]),await _0x532f76('成功',_0x244e73(0x205));}function _0x3486fb(_0x23194d){const _0x3c28ef=_0x41eae2;_0x46d775=_0x23194d,document[_0x3c28ef(0x89d)](_0x3c28ef(0x29a))['classList'][_0x3c28ef(0x569)](_0x3c28ef(0x11e4));}function _0x16ef3c(){const _0x393592=_0x41eae2;document[_0x393592(0x89d)](_0x393592(0x29a))[_0x393592(0x2f1)][_0x393592(0x1247)](_0x393592(0x11e4)),_0x46d775=null;}async function _0x4243dc(){const _0x4ac291=_0x41eae2;if(!_0x46d775)return;const _0x46340a=_0x46d775,_0x1eaac1=await _0x1a6951[_0x4ac291(0xea0)][_0x4ac291(0x650)](_0x46340a);if(!_0x1eaac1)return;_0x16ef3c();let _0x5bbe46;if(_0x1eaac1['type']==='shuoshuo')_0x5bbe46=_0x1eaac1[_0x4ac291(0x28c)];else{const _0x523af1={'type':_0x1eaac1[_0x4ac291(0x48c)],'publicText':_0x1eaac1['publicText']||''};if(_0x1eaac1[_0x4ac291(0x48c)]==='image_post')_0x523af1[_0x4ac291(0x450)]=_0x1eaac1[_0x4ac291(0x450)],_0x523af1[_0x4ac291(0x12ce)]=_0x1eaac1[_0x4ac291(0x12ce)];else _0x1eaac1[_0x4ac291(0x48c)]===_0x4ac291(0x574)&&(_0x523af1[_0x4ac291(0x132c)]=_0x1eaac1['hiddenContent']);_0x5bbe46=JSON[_0x4ac291(0x465)](_0x523af1,null,0x2);}const _0x3405af={'shuoshuo':'在这里输入说说的内容...','image':{'type':_0x4ac291(0xe70),'publicText':'','imageUrl':_0x4ac291(0xdda),'imageDescription':''},'text_image':{'type':_0x4ac291(0x574),'publicText':'','hiddenContent':''}},_0x24073a=_0x4ac291(0xc3c)+JSON['stringify'](_0x3405af[_0x4ac291(0xbef)])+_0x4ac291(0xf6b)+JSON[_0x4ac291(0x465)](_0x3405af[_0x4ac291(0x574)])+_0x4ac291(0x20a),_0x16eb41=await _0x34d246('编辑动态',_0x4ac291(0x8aa),_0x5bbe46,_0x4ac291(0x11b9),_0x24073a);setTimeout(()=>{const _0x184cda=_0x4ac291,_0x50ff62=document[_0x184cda(0xd16)](_0x184cda(0x47c));_0x50ff62&&_0x50ff62['addEventListener'](_0x184cda(0x12a5),()=>{const _0x2f6cd4=_0x184cda,_0x153371=document[_0x2f6cd4(0x89d)](_0x2f6cd4(0xd80));_0x153371[_0x2f6cd4(0x2f4)]=_0x3405af[_0x2f6cd4(0x536)],_0x153371['focus']();});},0x64),_0x16eb41!==null&&await _0x4b1b94(_0x46340a,_0x16eb41);}async function _0x4b1b94(_0x8abe01,_0x18a5ce){const _0x1da2c5=_0x41eae2,_0x1d2d91=await _0x1a6951['qzonePosts'][_0x1da2c5(0x650)](_0x8abe01);if(!_0x1d2d91)return;const _0xd5eca9=_0x18a5ce[_0x1da2c5(0xc3a)]();try{const _0x5501de=JSON[_0x1da2c5(0x2cb)](_0xd5eca9);_0x1d2d91[_0x1da2c5(0x48c)]=_0x5501de['type']||'image_post',_0x1d2d91[_0x1da2c5(0x957)]=_0x5501de[_0x1da2c5(0x957)]||'',_0x1d2d91[_0x1da2c5(0x450)]=_0x5501de[_0x1da2c5(0x450)]||'',_0x1d2d91[_0x1da2c5(0x12ce)]=_0x5501de[_0x1da2c5(0x12ce)]||'',_0x1d2d91[_0x1da2c5(0x132c)]=_0x5501de[_0x1da2c5(0x132c)]||'',_0x1d2d91['content']='';}catch(_0x2ea095){_0x1d2d91[_0x1da2c5(0x48c)]='shuoshuo',_0x1d2d91[_0x1da2c5(0x28c)]=_0xd5eca9,_0x1d2d91['publicText']='',_0x1d2d91['imageUrl']='',_0x1d2d91[_0x1da2c5(0x12ce)]='',_0x1d2d91[_0x1da2c5(0x132c)]='';}await _0x1a6951[_0x1da2c5(0xea0)][_0x1da2c5(0xc0f)](_0x1d2d91),await _0x155816(),await _0x532f76('成功',_0x1da2c5(0x2e2));}async function _0x57ff2c(){const _0x5c0917=_0x41eae2;if(!_0x46d775)return;const _0x1dd556=await _0x1a6951[_0x5c0917(0xea0)][_0x5c0917(0x650)](_0x46d775);if(!_0x1dd556)return;let _0x1ff010=_0x1dd556[_0x5c0917(0x28c)]||_0x1dd556[_0x5c0917(0x957)]||_0x1dd556[_0x5c0917(0x132c)]||_0x1dd556['imageDescription']||_0x5c0917(0x45a);try{await navigator['clipboard'][_0x5c0917(0xb27)](_0x1ff010),await _0x532f76(_0x5c0917(0x11ff),_0x5c0917(0x105b));}catch(_0x866ff9){await _0x532f76(_0x5c0917(0x611),_0x5c0917(0x1f4));}_0x16ef3c();}let _0x469765=new Set();async function _0x7044d6(){const _0x4b0df0=_0x41eae2,_0x3778e8=await _0x4d923b(_0x4b0df0(0x6c2),[{'text':_0x4b0df0(0xf44),'value':'normal'},{'text':_0x4b0df0(0xb86),'value':'spectator'}]);if(_0x3778e8===_0x4b0df0(0x8cf)){_0x469765[_0x4b0df0(0x1073)]();const _0x130a95=document[_0x4b0df0(0x89d)](_0x4b0df0(0x637)),_0x14e200=_0x130a95[_0x4b0df0(0xf2a)](!![]);_0x130a95[_0x4b0df0(0xb6e)][_0x4b0df0(0xd38)](_0x14e200,_0x130a95),_0x14e200[_0x4b0df0(0x1193)](_0x4b0df0(0x12a5),_0x289763),await _0x1d5341(),_0x4e6c15(_0x4b0df0(0x45f));}else _0x3778e8===_0x4b0df0(0x1246)&&_0xfa6ca7();}async function _0xfa6ca7(){const _0x5a035e=_0x41eae2;_0x469765['clear']();const _0x2429e9=document[_0x5a035e(0x89d)](_0x5a035e(0x637)),_0x4b288d=_0x2429e9[_0x5a035e(0xf2a)](!![]);_0x2429e9[_0x5a035e(0xb6e)]['replaceChild'](_0x4b288d,_0x2429e9),_0x4b288d[_0x5a035e(0x1193)]('click',_0x14b52b),await _0x2e8497(),_0x4e6c15(_0x5a035e(0x45f));}async function _0x2e8497(){const _0x5dd0df=_0x41eae2,_0x4d978a=document[_0x5dd0df(0x89d)](_0x5dd0df(0x9c4));_0x4d978a['innerHTML']='';const _0x40e4f3=Object['values'](_0x5b873d['chats'])[_0x5dd0df(0x3d8)](_0x3b7964=>!_0x3b7964[_0x5dd0df(0x58c)]),_0x264076=await _0x1a6951['npcs'][_0x5dd0df(0xc2f)]();if(_0x40e4f3[_0x5dd0df(0x7aa)]===0x0&&_0x264076[_0x5dd0df(0x7aa)]===0x0){_0x4d978a[_0x5dd0df(0x1ef)]=_0x5dd0df(0xd61);return;}_0x40e4f3[_0x5dd0df(0xd9a)](_0x1dc0c9=>{const _0x51b86f=_0x5dd0df,_0x23c241=document[_0x51b86f(0x285)]('div');_0x23c241[_0x51b86f(0x81c)]='contact-picker-item',_0x23c241[_0x51b86f(0xaaf)][_0x51b86f(0xd6e)]=_0x1dc0c9['id'],_0x23c241[_0x51b86f(0x1ef)]=_0x51b86f(0x28a)+(_0x1dc0c9['settings'][_0x51b86f(0xdd3)]||_0x265fcc)+_0x51b86f(0xc6e)+_0x1dc0c9[_0x51b86f(0xf74)]+_0x51b86f(0x111f),_0x4d978a['appendChild'](_0x23c241);}),_0x264076[_0x5dd0df(0xd9a)](_0x58aebb=>{const _0x50abb0=_0x5dd0df,_0x39a756=document[_0x50abb0(0x285)](_0x50abb0(0xb25));_0x39a756[_0x50abb0(0x81c)]=_0x50abb0(0xf36),_0x39a756[_0x50abb0(0xaaf)][_0x50abb0(0xd6e)]=_0x58aebb['id'],_0x39a756[_0x50abb0(0xaaf)][_0x50abb0(0x860)]=_0x50abb0(0xc8b),_0x39a756['innerHTML']=_0x50abb0(0x28a)+(_0x58aebb['avatar']||_0x15061e)+_0x50abb0(0xc6e)+_0x58aebb[_0x50abb0(0xf74)]+'\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4d978a[_0x50abb0(0x22f)](_0x39a756);}),_0x453fc3();}async function _0x14b52b(){const _0x1a6352=_0x41eae2;if(_0x469765[_0x1a6352(0x746)]<0x2){alert(_0x1a6352(0x384));return;}const _0x128fca=await _0x34d246('设置群名',_0x1a6352(0xec5),_0x1a6352(0xfeb));if(!_0x128fca||!_0x128fca['trim']())return;const _0x20fe35='group_'+Date[_0x1a6352(0xf1a)](),_0x5b7963=[],_0xa73abc=await _0x1a6951[_0x1a6352(0x8ce)][_0x1a6352(0xc2f)]();for(const _0xeb28ff of _0x469765){const _0x34960e=document[_0x1a6352(0xd16)](_0x1a6352(0xc58)+_0xeb28ff+'\x22]')['dataset'][_0x1a6352(0x860)]===_0x1a6352(0xc8b);if(_0x34960e){const _0x1cc29a=_0xa73abc[_0x1a6352(0x12f4)](_0x4d2aa2=>_0x4d2aa2['id']===parseInt(_0xeb28ff));_0x1cc29a&&_0x5b7963[_0x1a6352(0x138c)]({'id':_0x1a6352(0x5b8)+_0x1cc29a['id'],'originalName':_0x1cc29a['name'],'groupNickname':_0x1cc29a[_0x1a6352(0xf74)],'persona':_0x1cc29a[_0x1a6352(0x1170)],'avatar':_0x1cc29a[_0x1a6352(0x12c8)]||_0x15061e,'isNpc':!![]});}else{const _0x33f359=_0x5b873d['chats'][_0xeb28ff];_0x33f359&&_0x5b7963[_0x1a6352(0x138c)]({'id':_0xeb28ff,'originalName':_0x33f359[_0x1a6352(0x1045)],'groupNickname':_0x33f359[_0x1a6352(0xf74)],'persona':_0x33f359['settings'][_0x1a6352(0x1269)],'avatar':_0x33f359['settings'][_0x1a6352(0xdd3)]||_0x265fcc,'isNpc':![]});}}const _0x35a548={'id':_0x20fe35,'name':_0x128fca['trim'](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x5b7963,'settings':{'maxMemory':0xa,'groupAvatar':_0x660176,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':_0x1a6352(0x18c),'content':'[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','timestamp':Date['now'](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x5b873d['chats'][_0x20fe35]=_0x35a548,await _0x1a6951[_0x1a6352(0x667)][_0x1a6352(0xc0f)](_0x35a548),await _0x413d78(),_0x4e6c15(_0x1a6352(0x11b7)),_0x597f5a(_0x20fe35);}async function _0x1d5341(){const _0xcf0382=_0x41eae2,_0x1687ab=document[_0xcf0382(0x89d)](_0xcf0382(0x9c4));_0x1687ab[_0xcf0382(0x1ef)]='';const _0x363c05=Object[_0xcf0382(0x4b5)](_0x5b873d[_0xcf0382(0x667)])[_0xcf0382(0x3d8)](_0x276f51=>!_0x276f51[_0xcf0382(0x58c)]),_0x32069c=await _0x1a6951['npcs'][_0xcf0382(0xc2f)]();if(_0x363c05[_0xcf0382(0x7aa)]===0x0&&_0x32069c[_0xcf0382(0x7aa)]===0x0){_0x1687ab['innerHTML']='<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>';return;}_0x363c05['forEach'](_0x15c572=>{const _0x305554=_0xcf0382,_0xb953f9=document[_0x305554(0x285)](_0x305554(0xb25));_0xb953f9[_0x305554(0x81c)]='contact-picker-item',_0xb953f9[_0x305554(0xaaf)]['contactId']=_0x15c572['id'],_0xb953f9[_0x305554(0x1ef)]=_0x305554(0x28a)+(_0x15c572[_0x305554(0xdb9)][_0x305554(0xdd3)]||_0x265fcc)+_0x305554(0xc6e)+_0x15c572[_0x305554(0xf74)]+_0x305554(0x111f),_0x1687ab[_0x305554(0x22f)](_0xb953f9);}),_0x32069c['forEach'](_0x148c70=>{const _0x5f51ff=_0xcf0382,_0x5959ef=document[_0x5f51ff(0x285)](_0x5f51ff(0xb25));_0x5959ef[_0x5f51ff(0x81c)]=_0x5f51ff(0xf36),_0x5959ef[_0x5f51ff(0xaaf)][_0x5f51ff(0xd6e)]=_0x5f51ff(0x5b8)+_0x148c70['id'],_0x5959ef[_0x5f51ff(0x1ef)]=_0x5f51ff(0x28a)+(_0x148c70[_0x5f51ff(0x12c8)]||_0x15061e)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x148c70[_0x5f51ff(0xf74)]+_0x5f51ff(0xa7b),_0x1687ab[_0x5f51ff(0x22f)](_0x5959ef);}),_0x453fc3();}function _0x453fc3(){const _0x3166a5=_0x41eae2,_0x221921=document[_0x3166a5(0x89d)](_0x3166a5(0x637));_0x221921[_0x3166a5(0xf12)]=_0x3166a5(0x705)+_0x469765[_0x3166a5(0x746)]+')',_0x221921[_0x3166a5(0x3f7)]=_0x469765['size']<0x2;}async function _0x289763(){const _0x19c8c4=_0x41eae2;if(_0x469765['size']<0x2){alert(_0x19c8c4(0xa5f));return;}const _0x2b13ad=await _0x34d246(_0x19c8c4(0x125f),_0x19c8c4(0xec5),_0x19c8c4(0x194));if(!_0x2b13ad||!_0x2b13ad[_0x19c8c4(0xc3a)]())return;const _0x193ece=_0x19c8c4(0xeb6)+Date[_0x19c8c4(0xf1a)](),_0x88f09f=[],_0x1d8fa0=await _0x1a6951[_0x19c8c4(0x8ce)][_0x19c8c4(0xc2f)]();for(const _0x56fa71 of _0x469765){if(_0x56fa71['startsWith'](_0x19c8c4(0x5b8))){const _0x1d02a2=parseInt(_0x56fa71[_0x19c8c4(0xfbf)]('npc_','')),_0x20bb2c=_0x1d8fa0[_0x19c8c4(0x12f4)](_0x2e62c7=>_0x2e62c7['id']===_0x1d02a2);_0x20bb2c&&_0x88f09f['push']({'id':_0x56fa71,'originalName':_0x20bb2c[_0x19c8c4(0xf74)],'groupNickname':_0x20bb2c[_0x19c8c4(0xf74)],'persona':_0x20bb2c[_0x19c8c4(0x1170)],'avatar':_0x20bb2c[_0x19c8c4(0x12c8)]||_0x15061e,'isNpc':!![]});}else{const _0x375900=_0x5b873d[_0x19c8c4(0x667)][_0x56fa71];_0x375900&&_0x88f09f[_0x19c8c4(0x138c)]({'id':_0x56fa71,'originalName':_0x375900[_0x19c8c4(0x1045)],'groupNickname':_0x375900[_0x19c8c4(0xf74)],'persona':_0x375900['settings'][_0x19c8c4(0x1269)],'avatar':_0x375900[_0x19c8c4(0xdb9)][_0x19c8c4(0xdd3)]||_0x265fcc,'isNpc':![]});}}const _0x4a385c={'id':_0x193ece,'name':_0x2b13ad['trim'](),'isGroup':!![],'members':_0x88f09f,'settings':{'myPersona':_0x19c8c4(0xa6e),'myNickname':'我','maxMemory':0xa,'groupAvatar':_0x660176,'myAvatar':_0x24462f,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x5b873d[_0x19c8c4(0x667)][_0x193ece]=_0x4a385c,await _0x1a6951[_0x19c8c4(0x667)]['put'](_0x4a385c),await _0x413d78(),_0x4e6c15('chat-list-screen'),_0x597f5a(_0x193ece);}function _0x55b8af(){const _0x6c4d28=_0x41eae2;if(!_0x5b873d[_0x6c4d28(0xf96)]||!_0x5b873d[_0x6c4d28(0x667)][_0x5b873d[_0x6c4d28(0xf96)]]['isGroup'])return;_0x13d315(),_0x4e6c15(_0x6c4d28(0x697));}function _0x13d315(){const _0xf1e20d=_0x41eae2,_0x53bc51=document[_0xf1e20d(0x89d)]('member-management-list'),_0x423020=_0x5b873d[_0xf1e20d(0x667)][_0x5b873d['activeChatId']];_0x53bc51['innerHTML']='',_0x423020['members']['forEach'](_0x54ba36=>{const _0x478bde=_0xf1e20d,_0x225245=document[_0x478bde(0x285)](_0x478bde(0xb25));_0x225245[_0x478bde(0x81c)]=_0x478bde(0x10b4),_0x225245[_0x478bde(0x1ef)]=_0x478bde(0x10e6)+_0x54ba36[_0x478bde(0x12c8)]+_0x478bde(0x256)+_0x54ba36[_0x478bde(0x7da)]+_0x478bde(0xeea)+_0x54ba36['id']+_0x478bde(0xcb6),_0x53bc51[_0x478bde(0x22f)](_0x225245);});}async function _0x4dd754(_0x455194){const _0x1fdb74=_0x41eae2,_0xa7aeb1=_0x5b873d[_0x1fdb74(0x667)][_0x5b873d[_0x1fdb74(0xf96)]],_0x427d2e=_0xa7aeb1[_0x1fdb74(0x5ab)][_0x1fdb74(0x9d7)](_0x193be9=>_0x193be9['id']===_0x455194);if(_0x427d2e===-0x1)return;if(_0xa7aeb1[_0x1fdb74(0x5ab)]['length']<=0x2){alert(_0x1fdb74(0xcd1));return;}const _0x459603=_0xa7aeb1[_0x1fdb74(0x5ab)][_0x427d2e][_0x1fdb74(0x7da)],_0x5701ac=await _0x4e2abc(_0x1fdb74(0xd34),_0x1fdb74(0xc7c)+_0x459603+_0x1fdb74(0xe64),{'confirmButtonClass':'btn-danger'});_0x5701ac&&(_0xa7aeb1[_0x1fdb74(0x5ab)][_0x1fdb74(0x776)](_0x427d2e,0x1),await _0x1a6951[_0x1fdb74(0x667)][_0x1fdb74(0xc0f)](_0xa7aeb1),_0x13d315(),document[_0x1fdb74(0x89d)](_0x1fdb74(0x1303))['click']());}async function _0x382232(){const _0x43ed13=_0x41eae2,_0x4b1954=document[_0x43ed13(0x89d)](_0x43ed13(0x637)),_0x292317=_0x4b1954[_0x43ed13(0xf2a)](!![]);_0x4b1954[_0x43ed13(0xb6e)]['replaceChild'](_0x292317,_0x4b1954),_0x292317[_0x43ed13(0x1193)]('click',_0x2f3814),await _0x391167(),_0x4e6c15('contact-picker-screen');}async function _0x391167(){const _0x5af704=_0x41eae2,_0x32a95b=document[_0x5af704(0x89d)](_0x5af704(0x9c4));_0x32a95b[_0x5af704(0x1ef)]='',_0x469765[_0x5af704(0x1073)]();const _0x451e11=_0x5b873d[_0x5af704(0x667)][_0x5b873d[_0x5af704(0xf96)]],_0x5e4b37=new Set(_0x451e11[_0x5af704(0x5ab)]['map'](_0x27a589=>_0x27a589['id'])),_0x27e288=Object[_0x5af704(0x4b5)](_0x5b873d[_0x5af704(0x667)])[_0x5af704(0x3d8)](_0xe95077=>!_0xe95077[_0x5af704(0x58c)]&&!_0x5e4b37['has'](_0xe95077['id'])),_0x2a5000=(await _0x1a6951[_0x5af704(0x8ce)][_0x5af704(0xc2f)]())['filter'](_0x5e9179=>!_0x5e4b37[_0x5af704(0xa14)](_0x5af704(0x5b8)+_0x5e9179['id']));_0x27e288[_0x5af704(0x7aa)]===0x0&&_0x2a5000['length']===0x0?(_0x32a95b[_0x5af704(0x1ef)]=_0x5af704(0x11e7),document[_0x5af704(0x89d)](_0x5af704(0x637))[_0x5af704(0x68e)][_0x5af704(0x126b)]=_0x5af704(0x10f2)):(document[_0x5af704(0x89d)](_0x5af704(0x637))[_0x5af704(0x68e)]['display']='block',_0x27e288['forEach'](_0x31cc4c=>{const _0x8ce2b8=_0x5af704,_0x439f56=document['createElement'](_0x8ce2b8(0xb25));_0x439f56['className']=_0x8ce2b8(0xf36),_0x439f56[_0x8ce2b8(0xaaf)][_0x8ce2b8(0xd6e)]=_0x31cc4c['id'],_0x439f56[_0x8ce2b8(0xaaf)]['contactType']=_0x8ce2b8(0x132a),_0x439f56[_0x8ce2b8(0x1ef)]=_0x8ce2b8(0xf2d)+(_0x31cc4c[_0x8ce2b8(0xdb9)]['aiAvatar']||_0x265fcc)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x31cc4c[_0x8ce2b8(0xf74)]+_0x8ce2b8(0x5ef),_0x32a95b[_0x8ce2b8(0x22f)](_0x439f56);}),_0x2a5000[_0x5af704(0xd9a)](_0x22fd5f=>{const _0x8db6e5=_0x5af704,_0x2f4feb=document['createElement'](_0x8db6e5(0xb25));_0x2f4feb[_0x8db6e5(0x81c)]=_0x8db6e5(0xf36),_0x2f4feb['dataset'][_0x8db6e5(0xd6e)]='npc_'+_0x22fd5f['id'],_0x2f4feb['dataset']['contactType']=_0x8db6e5(0x117e),_0x2f4feb[_0x8db6e5(0xaaf)][_0x8db6e5(0xe88)]=_0x22fd5f['id'],_0x2f4feb['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x22fd5f['avatar']||_0x15061e)+_0x8db6e5(0x269)+_0x22fd5f[_0x8db6e5(0xf74)]+_0x8db6e5(0x780),_0x32a95b[_0x8db6e5(0x22f)](_0x2f4feb);})),_0x453fc3();}async function _0x2f3814(){const _0x17b837=_0x41eae2;if(_0x469765[_0x17b837(0x746)]===0x0){alert('请至少选择一个要添加的联系人。');return;}const _0x271c82=_0x5b873d['chats'][_0x5b873d[_0x17b837(0xf96)]],_0x1ee4c8=await _0x1a6951['npcs'][_0x17b837(0xc2f)]();for(const _0x5c330d of _0x469765){const _0x624906=document[_0x17b837(0xd16)](_0x17b837(0xc58)+_0x5c330d+'\x22]');if(!_0x624906)continue;const _0x598bd4=_0x624906[_0x17b837(0xaaf)][_0x17b837(0xdd1)];if(_0x598bd4===_0x17b837(0x132a)){const _0x1ca702=_0x5b873d[_0x17b837(0x667)][_0x5c330d];_0x1ca702&&_0x271c82[_0x17b837(0x5ab)][_0x17b837(0x138c)]({'id':_0x5c330d,'originalName':_0x1ca702['originalName'],'groupNickname':_0x1ca702[_0x17b837(0xf74)],'persona':_0x1ca702[_0x17b837(0xdb9)]['aiPersona'],'avatar':_0x1ca702[_0x17b837(0xdb9)]['aiAvatar']||_0x265fcc,'isNpc':![]});}else{if(_0x598bd4===_0x17b837(0x117e)){const _0x5b455e=parseInt(_0x624906[_0x17b837(0xaaf)][_0x17b837(0xe88)]),_0x2a0e7f=_0x1ee4c8[_0x17b837(0x12f4)](_0x2fe438=>_0x2fe438['id']===_0x5b455e);_0x2a0e7f&&_0x271c82[_0x17b837(0x5ab)]['push']({'id':'npc_'+_0x5b455e,'originalName':_0x2a0e7f[_0x17b837(0xf74)],'groupNickname':_0x2a0e7f[_0x17b837(0xf74)],'persona':_0x2a0e7f[_0x17b837(0x1170)],'avatar':_0x2a0e7f[_0x17b837(0x12c8)]||_0x15061e,'isNpc':!![]});}}}await _0x1a6951[_0x17b837(0x667)][_0x17b837(0xc0f)](_0x271c82),_0x55b8af();}function _0x49430b(){_0x32afbb=!![],_0x39f7c8(null);}function _0x34bb9a(_0x14b148,_0x2494b8){const _0xddb20e=setInterval(()=>{const _0x503f5c=_0x356e,_0x305d3f=Date[_0x503f5c(0xf1a)](),_0x3fbc78=_0x2494b8-_0x305d3f;if(_0x3fbc78<0x0){clearInterval(_0xddb20e),_0x14b148[_0x503f5c(0x1ef)]=_0x503f5c(0xbdb);return;}const _0x463792=Math[_0x503f5c(0x128a)](_0x3fbc78%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x425c62=Math[_0x503f5c(0x128a)](_0x3fbc78%(0x3e8*0x3c)/0x3e8),_0x59f9ac=String(_0x463792)[_0x503f5c(0x4d8)](0x2,'0'),_0x47db38=String(_0x425c62)[_0x503f5c(0x4d8)](0x2,'0');_0x14b148[_0x503f5c(0x1ef)]=_0x503f5c(0xb8c)+_0x59f9ac[_0x503f5c(0xfa1)](0x0)+'</span><span>'+_0x59f9ac[_0x503f5c(0xfa1)](0x1)+_0x503f5c(0xc21)+_0x47db38[_0x503f5c(0xfa1)](0x0)+_0x503f5c(0xc6c)+_0x47db38[_0x503f5c(0xfa1)](0x1)+_0x503f5c(0x5ec);},0x3e8);return _0xddb20e;}function _0x35a054(){for(const _0x2f00d0 in _0x15984b){clearInterval(_0x15984b[_0x2f00d0]);}_0x15984b={};}async function _0x52d938(_0x4a3daa){const _0x212e34=_0x41eae2,_0x164859=_0x5b873d['chats'][_0x5b873d[_0x212e34(0xf96)]];if(!_0x164859)return;const _0x1becff=_0x164859[_0x212e34(0x551)][_0x212e34(0x12f4)](_0x57f6d0=>_0x57f6d0[_0x212e34(0x114e)]===_0x4a3daa);if(!_0x1becff||![_0x212e34(0xcd9),'waimai_order'][_0x212e34(0xced)](_0x1becff['type'])){console[_0x212e34(0x1fd)](_0x212e34(0x6d3),_0x4a3daa);return;}let _0xada223='';if(_0x1becff[_0x212e34(0x48c)]===_0x212e34(0xcd9)){let _0x294597;switch(_0x1becff[_0x212e34(0x632)]){case'paid':const _0x568a0b=_0x1becff[_0x212e34(0x765)]||'对方',_0x3d10c9=_0xb9963e(_0x164859,_0x568a0b);_0x294597='由\x20'+_0x3d10c9+'\x20为您代付成功';break;case _0x212e34(0x93f):_0x294597=_0x212e34(0x1160);break;default:_0x294597='等待对方处理';break;}_0xada223=_0x212e34(0x128c)+_0x1becff[_0x212e34(0xb3e)]+_0x212e34(0xbfb)+Number(_0x1becff['amount'])[_0x212e34(0x8f7)](0x2)+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20'+_0x294597+_0x212e34(0xff0);}else{if(_0x1becff[_0x212e34(0x48c)]==='waimai_order'){let _0x4fd6c6,_0xfa6d95;_0x164859[_0x212e34(0x58c)]?(_0x4fd6c6=_0xb9963e(_0x164859,_0x1becff[_0x212e34(0xcfc)]),_0xfa6d95=_0xb9963e(_0x164859,_0x1becff[_0x212e34(0x2ff)])):_0x1becff[_0x212e34(0xa57)]===_0x212e34(0x116c)?(_0x4fd6c6=_0x164859['settings']['myNickname']||'我',_0xfa6d95=_0x164859[_0x212e34(0xf74)]):(_0x4fd6c6=_0x164859[_0x212e34(0xf74)],_0xfa6d95=_0x164859[_0x212e34(0xdb9)][_0x212e34(0xc48)]||'我'),_0xada223=_0x212e34(0x1182)+_0x4fd6c6+_0x212e34(0x74a)+_0xfa6d95+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20'+_0x1becff[_0x212e34(0xb3e)]+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥'+Number(_0x1becff[_0x212e34(0x10a6)])[_0x212e34(0x8f7)](0x2)+_0x212e34(0xff0);}}await _0x532f76('订单详情',_0xada223);}async function _0x562c24(_0x1a57b7,_0x251459){const _0x1703bb=_0x41eae2,_0x188757=_0x5b873d[_0x1703bb(0x667)][_0x5b873d[_0x1703bb(0xf96)]];if(!_0x188757)return;const _0x132f1c=_0x188757[_0x1703bb(0x551)][_0x1703bb(0x9d7)](_0x1712f1=>_0x1712f1[_0x1703bb(0x114e)]===_0x1a57b7);if(_0x132f1c===-0x1)return;const _0x5c86d4=_0x188757[_0x1703bb(0x551)][_0x132f1c];_0x5c86d4[_0x1703bb(0x632)]=_0x251459;let _0x3e4b86;const _0x3c754f=_0x188757[_0x1703bb(0x58c)]?_0x188757[_0x1703bb(0xdb9)][_0x1703bb(0xc48)]||'我':'我';_0x251459===_0x1703bb(0x1385)?(_0x5c86d4['paidBy']=_0x3c754f,_0x3e4b86=_0x1703bb(0xf17)+_0x3c754f+')\x20为\x20'+_0x5c86d4[_0x1703bb(0xcfc)]+_0x1703bb(0x3b2)+_0x1a57b7+_0x1703bb(0x1122)):_0x3e4b86='[系统提示：你\x20('+_0x3c754f+_0x1703bb(0x976)+_0x5c86d4[_0x1703bb(0xcfc)]+_0x1703bb(0xe01)+_0x1a57b7+_0x1703bb(0x178);const _0x5871cb={'role':'system','content':_0x3e4b86,'timestamp':Date[_0x1703bb(0xf1a)](),'isHidden':!![]};_0x188757[_0x1703bb(0x551)]['push'](_0x5871cb),await _0x1a6951['chats'][_0x1703bb(0xc0f)](_0x188757),_0x5b89df(_0x5b873d[_0x1703bb(0xf96)]);}let _0x333dc7={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x14a16a=null;async function _0x350e64(){const _0x3358cd=_0x41eae2;if(!_0x5b873d[_0x3358cd(0xf96)]||_0x333dc7['isActive']||_0x333dc7[_0x3358cd(0xba8)])return;const _0x33ebaa=_0x5b873d[_0x3358cd(0x667)][_0x5b873d[_0x3358cd(0xf96)]];_0x333dc7[_0x3358cd(0x43c)]=_0x33ebaa['isGroup'],_0x333dc7[_0x3358cd(0xba8)]=!![],_0x333dc7[_0x3358cd(0x12b5)]=_0x3358cd(0x116c),_0x333dc7[_0x3358cd(0xf96)]=_0x33ebaa['id'],_0x333dc7[_0x3358cd(0xf77)]=!![];_0x33ebaa[_0x3358cd(0x58c)]?(document[_0x3358cd(0x89d)]('outgoing-call-avatar')[_0x3358cd(0x9e3)]=_0x33ebaa[_0x3358cd(0xdb9)][_0x3358cd(0xd55)]||_0x24462f,document[_0x3358cd(0x89d)](_0x3358cd(0x288))['textContent']=_0x33ebaa[_0x3358cd(0xdb9)][_0x3358cd(0xc48)]||'我'):(document[_0x3358cd(0x89d)](_0x3358cd(0x1243))['src']=_0x33ebaa['settings'][_0x3358cd(0xdd3)]||_0x265fcc,document[_0x3358cd(0x89d)](_0x3358cd(0x288))[_0x3358cd(0xf12)]=_0x33ebaa[_0x3358cd(0xf74)]);document[_0x3358cd(0xd16)](_0x3358cd(0xf1c))['textContent']=_0x33ebaa['isGroup']?_0x3358cd(0xc19):_0x3358cd(0x8de),_0x4e6c15(_0x3358cd(0x553));const _0x211393={'role':'system','content':_0x33ebaa['isGroup']?'[系统提示：用户\x20('+(_0x33ebaa[_0x3358cd(0xdb9)][_0x3358cd(0xc48)]||'我')+_0x3358cd(0x1ba):'[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]','timestamp':Date[_0x3358cd(0xf1a)](),'isHidden':!![]};_0x33ebaa[_0x3358cd(0x551)][_0x3358cd(0x138c)](_0x211393),await _0x1a6951[_0x3358cd(0x667)][_0x3358cd(0xc0f)](_0x33ebaa),await _0x2e3505();}function _0x11ad56(){const _0x2e3be0=_0x41eae2,_0x17f608=_0x5b873d[_0x2e3be0(0x667)][_0x333dc7[_0x2e3be0(0xf96)]];if(!_0x17f608)return;_0x333dc7['isActive']=!![],_0x333dc7[_0x2e3be0(0xba8)]=![],_0x333dc7['startTime']=Date[_0x2e3be0(0xf1a)](),_0x333dc7[_0x2e3be0(0x1174)]=[];const _0x483601=_0x17f608[_0x2e3be0(0x551)]['slice'](-0xa);_0x333dc7[_0x2e3be0(0x484)]=_0x483601[_0x2e3be0(0x412)](_0x887cd6=>{const _0x39e559=_0x2e3be0,_0x43eaad=_0x887cd6['role']===_0x39e559(0x116c)?_0x17f608[_0x39e559(0xdb9)][_0x39e559(0xc48)]||'我':_0x887cd6[_0x39e559(0xcfc)]||_0x17f608[_0x39e559(0xf74)];return _0x43eaad+':\x20'+String(_0x887cd6['content'])[_0x39e559(0x489)](0x0,0x32)+_0x39e559(0x1046);})[_0x2e3be0(0x1237)]('\x0a'),_0x277f5e(),document[_0x2e3be0(0x89d)](_0x2e3be0(0xae3))[_0x2e3be0(0x1ef)]=_0x2e3be0(0x896)+(_0x333dc7['isGroupCall']?_0x2e3be0(0x797):_0x2e3be0(0x761))+'</em>',_0x4e6c15(_0x2e3be0(0x1275)),document[_0x2e3be0(0x89d)]('user-speak-btn')['style']['display']=_0x333dc7[_0x2e3be0(0xf77)]?'block':_0x2e3be0(0x10f2),document['getElementById'](_0x2e3be0(0xbf8))[_0x2e3be0(0x68e)][_0x2e3be0(0x126b)]=_0x333dc7[_0x2e3be0(0xf77)]?_0x2e3be0(0x10f2):_0x2e3be0(0x1118);if(_0x14a16a)clearInterval(_0x14a16a);_0x14a16a=setInterval(_0x525d4d,0x3e8),_0x525d4d(),_0x2c1fe5();}async function _0x308ed3(){const _0x2d218b=_0x41eae2;if(!_0x333dc7[_0x2d218b(0xfcb)])return;const _0x23f96f=Math[_0x2d218b(0x128a)]((Date['now']()-_0x333dc7[_0x2d218b(0x7f3)])/0x3e8),_0xe31cb8=Math['floor'](_0x23f96f/0x3c)+'分'+_0x23f96f%0x3c+'秒',_0x4b4a79=_0x2d218b(0x1380)+_0xe31cb8,_0x1ec857=_0x5b873d[_0x2d218b(0x667)][_0x333dc7[_0x2d218b(0xf96)]];if(_0x1ec857){const _0x4d2054=[];_0x333dc7[_0x2d218b(0x43c)]?(_0x333dc7[_0x2d218b(0x394)][_0x2d218b(0xd9a)](_0x293678=>_0x4d2054[_0x2d218b(0x138c)]({'name':_0x293678[_0x2d218b(0x1045)],'avatar':_0x293678['avatar']})),_0x333dc7[_0x2d218b(0xf77)]&&_0x4d2054[_0x2d218b(0xe25)]({'name':_0x1ec857[_0x2d218b(0xdb9)]['myNickname']||'我','avatar':_0x1ec857[_0x2d218b(0xdb9)][_0x2d218b(0xd55)]||_0x24462f})):(_0x4d2054[_0x2d218b(0x138c)]({'name':_0x1ec857['name'],'avatar':_0x1ec857[_0x2d218b(0xdb9)][_0x2d218b(0xdd3)]||_0x265fcc}),_0x4d2054[_0x2d218b(0xe25)]({'name':'我','avatar':_0x1ec857[_0x2d218b(0xdb9)][_0x2d218b(0xd55)]||_0x265fcc}));const _0x39a766={'chatId':_0x333dc7[_0x2d218b(0xf96)],'timestamp':Date[_0x2d218b(0xf1a)](),'duration':_0x23f96f,'participants':_0x4d2054,'transcript':[..._0x333dc7[_0x2d218b(0x1174)]]};await _0x1a6951[_0x2d218b(0x856)][_0x2d218b(0x569)](_0x39a766),console[_0x2d218b(0x471)]('通话记录已保存:',_0x39a766);let _0x9d5cd0={'role':_0x333dc7['initiator']===_0x2d218b(0x116c)?_0x2d218b(0x116c):_0x2d218b(0x1377),'content':_0x4b4a79,'timestamp':Date[_0x2d218b(0xf1a)]()};_0x1ec857[_0x2d218b(0x58c)]&&_0x9d5cd0[_0x2d218b(0xa57)]===_0x2d218b(0x1377)&&(_0x9d5cd0[_0x2d218b(0xcfc)]=_0x333dc7[_0x2d218b(0x7a1)]||_0x1ec857['members'][0x0]?.[_0x2d218b(0x1045)]||_0x1ec857[_0x2d218b(0xf74)]);_0x1ec857[_0x2d218b(0x551)][_0x2d218b(0x138c)](_0x9d5cd0);const _0x32b344=_0x333dc7[_0x2d218b(0x1174)][_0x2d218b(0x412)](_0x3c50ce=>{const _0x1a899a=_0x2d218b,_0x316c69=_0x3c50ce[_0x1a899a(0xa57)]===_0x1a899a(0x116c)?_0x1ec857[_0x1a899a(0xdb9)][_0x1a899a(0xc48)]||'我':_0x3c50ce['senderName'];return _0x316c69+':\x20'+_0x3c50ce['content'];})[_0x2d218b(0x1237)]('\x0a');_0x402bd9(_0x1ec857['id'],_0x32b344);const _0x55f7c7={'role':_0x2d218b(0x18c),'content':'[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','timestamp':Date['now']()+0x1,'isHidden':!![]};_0x1ec857[_0x2d218b(0x551)][_0x2d218b(0x138c)](_0x55f7c7),await _0x1a6951[_0x2d218b(0x667)]['put'](_0x1ec857);}clearInterval(_0x14a16a),_0x14a16a=null,_0x333dc7={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x1ec857&&(_0x597f5a(_0x1ec857['id']),_0x2e3505());}function _0x277f5e(){const _0x359eff=_0x41eae2,_0x3d7761=document[_0x359eff(0x89d)](_0x359eff(0xae5));_0x3d7761[_0x359eff(0x1ef)]='';const _0x77fbc2=_0x5b873d[_0x359eff(0x667)][_0x333dc7[_0x359eff(0xf96)]];if(!_0x77fbc2)return;let _0x12bd01=[];_0x333dc7[_0x359eff(0x43c)]?(_0x12bd01=[..._0x333dc7[_0x359eff(0x394)]],_0x333dc7[_0x359eff(0xf77)]&&_0x12bd01[_0x359eff(0xe25)]({'id':'user','name':_0x77fbc2[_0x359eff(0xdb9)][_0x359eff(0xc48)]||'我','avatar':_0x77fbc2[_0x359eff(0xdb9)][_0x359eff(0xd55)]||_0x24462f})):_0x12bd01[_0x359eff(0x138c)]({'id':'ai','name':_0x77fbc2[_0x359eff(0xf74)],'avatar':_0x77fbc2[_0x359eff(0xdb9)]['aiAvatar']||_0x265fcc}),_0x12bd01[_0x359eff(0xd9a)](_0x4e5d4a=>{const _0x45d397=_0x359eff,_0x29c3ff=document[_0x45d397(0x285)]('div');_0x29c3ff[_0x45d397(0x81c)]=_0x45d397(0x646),_0x29c3ff[_0x45d397(0xaaf)]['participantId']=_0x4e5d4a['id'];const _0x534216=_0x4e5d4a[_0x45d397(0x7da)]||_0x4e5d4a['name'];_0x29c3ff[_0x45d397(0x1ef)]=_0x45d397(0x8dd)+_0x4e5d4a[_0x45d397(0x12c8)]+'\x22\x20class=\x22participant-avatar\x22\x20alt=\x22'+_0x534216+_0x45d397(0x238)+_0x534216+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x3d7761['appendChild'](_0x29c3ff);});}function _0x476866(){const _0x175b63=_0x41eae2;if(!_0x333dc7[_0x175b63(0xfcb)]||_0x333dc7[_0x175b63(0xf77)])return;_0x333dc7[_0x175b63(0xf77)]=!![],_0x277f5e(),document[_0x175b63(0x89d)](_0x175b63(0x66b))[_0x175b63(0x68e)]['display']=_0x175b63(0x1118),document[_0x175b63(0x89d)](_0x175b63(0xbf8))[_0x175b63(0x68e)]['display']='none',_0x2c1fe5(_0x175b63(0xd95));}function _0x525d4d(){const _0x3fdc47=_0x41eae2;if(!_0x333dc7['isActive'])return;const _0xbc09be=Math[_0x3fdc47(0x128a)]((Date[_0x3fdc47(0xf1a)]()-_0x333dc7[_0x3fdc47(0x7f3)])/0x3e8),_0x56388a=Math['floor'](_0xbc09be/0x3c),_0x3bc3a1=_0xbc09be%0x3c;document[_0x3fdc47(0x89d)](_0x3fdc47(0x678))[_0x3fdc47(0xf12)]=String(_0x56388a)[_0x3fdc47(0x4d8)](0x2,'0')+':'+String(_0x3bc3a1)[_0x3fdc47(0x4d8)](0x2,'0');}function _0x714251(){const _0xb003ec=_0x41eae2,_0x2a9cc2=_0x5b873d['chats'][_0x5b873d[_0xb003ec(0xf96)]];if(!_0x2a9cc2)return;if(_0x2a9cc2['isGroup']){const _0x5ba60c=_0x333dc7[_0xb003ec(0x7a1)]||_0x2a9cc2[_0xb003ec(0x5ab)][0x0]?.['name']||_0xb003ec(0xc0a);document[_0xb003ec(0x89d)](_0xb003ec(0xc4f))['src']=_0x2a9cc2[_0xb003ec(0xdb9)][_0xb003ec(0x108a)]||_0x660176,document[_0xb003ec(0x89d)]('caller-name')[_0xb003ec(0xf12)]=_0x2a9cc2['name'],document['querySelector'](_0xb003ec(0xecf))[_0xb003ec(0xf12)]=_0x5ba60c+'\x20邀请你加入群视频';}else document[_0xb003ec(0x89d)](_0xb003ec(0xc4f))[_0xb003ec(0x9e3)]=_0x2a9cc2[_0xb003ec(0xdb9)][_0xb003ec(0xdd3)]||_0x265fcc,document[_0xb003ec(0x89d)]('caller-name')['textContent']=_0x2a9cc2[_0xb003ec(0xf74)],document[_0xb003ec(0xd16)](_0xb003ec(0xecf))[_0xb003ec(0xf12)]=_0xb003ec(0x535);document[_0xb003ec(0x89d)](_0xb003ec(0x741))['classList'][_0xb003ec(0x569)](_0xb003ec(0x11e4));}function _0x48c9d4(){const _0x4469ee=_0x41eae2;document[_0x4469ee(0x89d)](_0x4469ee(0x741))[_0x4469ee(0x2f1)][_0x4469ee(0x1247)](_0x4469ee(0x11e4));}async function _0x2c1fe5(_0x4b95ea=null){const _0x2b562a=_0x41eae2;if(!_0x333dc7[_0x2b562a(0xfcb)])return;const _0xc2cbf6=_0x5b873d[_0x2b562a(0x667)][_0x333dc7[_0x2b562a(0xf96)]],{proxyUrl:_0x1e780b,apiKey:_0x44ecb8,model:_0x5ac7c6}=_0x5b873d[_0x2b562a(0x30d)],_0x47b96b=document[_0x2b562a(0x89d)](_0x2b562a(0xae3)),_0x22fcd4=_0xc2cbf6['settings']['myNickname']||'我';let _0x2f49b7='';if(_0xc2cbf6[_0x2b562a(0xdb9)][_0x2b562a(0x32d)]&&_0xc2cbf6[_0x2b562a(0xdb9)][_0x2b562a(0x32d)]['length']>0x0){const _0x50dbf0=_0xc2cbf6[_0x2b562a(0xdb9)][_0x2b562a(0x32d)][_0x2b562a(0x412)](_0x4467be=>{const _0xba21c=_0x2b562a,_0xb1b39a=_0x5b873d[_0xba21c(0x8a1)][_0xba21c(0x12f4)](_0x336553=>_0x336553['id']===_0x4467be);return _0xb1b39a&&_0xb1b39a[_0xba21c(0x28c)]?_0xba21c(0xb85)+_0xb1b39a['name']+'\x0a'+_0xb1b39a[_0xba21c(0x28c)]:'';})[_0x2b562a(0x3d8)](Boolean)[_0x2b562a(0x1237)]('');_0x50dbf0&&(_0x2f49b7=_0x2b562a(0x312)+_0x50dbf0+_0x2b562a(0xdf6));}if(_0x4b95ea&&_0x333dc7[_0x2b562a(0xf77)]){const _0x8c556c=Date[_0x2b562a(0xf1a)](),_0x1ea2bb=document[_0x2b562a(0x285)](_0x2b562a(0xb25));_0x1ea2bb['className']='call-message-bubble\x20user-speech',_0x1ea2bb[_0x2b562a(0xf12)]=_0x4b95ea,_0x1ea2bb[_0x2b562a(0xaaf)]['timestamp']=_0x8c556c,_0xefe9e2(_0x1ea2bb,()=>_0x29eebd(_0x8c556c)),_0x47b96b[_0x2b562a(0x22f)](_0x1ea2bb),_0x47b96b[_0x2b562a(0xb0e)]=_0x47b96b[_0x2b562a(0x624)],_0x333dc7[_0x2b562a(0x1174)][_0x2b562a(0x138c)]({'role':_0x2b562a(0x116c),'content':_0x4b95ea,'timestamp':_0x8c556c});}let _0x28d19c;if(_0x333dc7[_0x2b562a(0x43c)]){const _0x1947fc=_0x333dc7[_0x2b562a(0x394)][_0x2b562a(0x412)](_0x4e215e=>_0x4e215e['name']);_0x333dc7[_0x2b562a(0xf77)]&&_0x1947fc[_0x2b562a(0xe25)](_0x22fcd4),_0x28d19c=_0x2b562a(0x8b7)+_0x22fcd4+_0x2b562a(0x492)+_0x22fcd4+'\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x333dc7[_0x2b562a(0x484)]+_0x2b562a(0x12b1)+_0x1947fc[_0x2b562a(0x1237)]('、\x20')+_0x2b562a(0x10c7)+_0x2f49b7+'\x20//\x20<--\x20【核心】注入世界书\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}else{let _0x3092af=_0x333dc7['initiator']===_0x2b562a(0x116c)?'你刚刚接听了用户的视频通话请求。':_0x2b562a(0x5fe);_0x28d19c=_0x2b562a(0x1095)+_0xc2cbf6[_0x2b562a(0xf74)]+'\x20('+_0xc2cbf6[_0x2b562a(0xdb9)][_0x2b562a(0x1269)]+')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“'+_0xc2cbf6[_0x2b562a(0xf74)]+_0x2b562a(0x78f)+_0x22fcd4+_0x2b562a(0x215)+_0xc2cbf6['settings'][_0x2b562a(0x6d4)]+'）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**'+_0x3092af+'**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x333dc7[_0x2b562a(0x484)]+_0x2b562a(0xc9b);}const _0x50cd4b=[{'role':_0x2b562a(0x18c),'content':_0x28d19c},..._0x333dc7['callHistory'][_0x2b562a(0x412)](_0x3ef2e9=>({'role':_0x3ef2e9[_0x2b562a(0xa57)],'content':_0x3ef2e9[_0x2b562a(0x28c)]}))];if(_0x333dc7['callHistory'][_0x2b562a(0x7aa)]===0x0){const _0x429fa5=_0x333dc7[_0x2b562a(0x12b5)]===_0x2b562a(0x116c)?_0x2b562a(0xf72):_0x2b562a(0x1db);_0x50cd4b[_0x2b562a(0x138c)]({'role':_0x2b562a(0x116c),'content':_0x429fa5});}try{let _0x3af52d=_0x1e780b===GEMINI_API_URL,_0x4ff569=_0xa615f4(_0x5ac7c6,_0x44ecb8,_0x28d19c,_0x50cd4b);const _0x41a593=_0x3af52d?await fetch(_0x4ff569[_0x2b562a(0x11de)],_0x4ff569[_0x2b562a(0xd98)]):await fetch(_0x1e780b+'/v1/chat/completions',{'method':_0x2b562a(0xd14),'headers':{'Content-Type':_0x2b562a(0xce4),'Authorization':_0x2b562a(0x3fb)+_0x44ecb8},'body':JSON['stringify']({'model':_0x5ac7c6,'messages':_0x50cd4b,'temperature':_0x5b873d[_0x2b562a(0x21a)]['apiTemperature']||0.8})});if(!_0x41a593['ok'])throw new Error((await _0x41a593[_0x2b562a(0x6b5)]())[_0x2b562a(0x1fd)][_0x2b562a(0x1288)]);const _0x46034b=await _0x41a593[_0x2b562a(0x6b5)](),_0x1d5814=_0x3af52d?_0x46034b[_0x2b562a(0xb59)][0x0][_0x2b562a(0x28c)]['parts'][0x0]['text']:_0x46034b[_0x2b562a(0xd3b)][0x0][_0x2b562a(0x1288)][_0x2b562a(0x28c)],_0x22dff7=_0x47b96b[_0x2b562a(0xd16)]('em');if(_0x22dff7)_0x22dff7[_0x2b562a(0x1247)]();if(_0x333dc7[_0x2b562a(0x43c)]){const _0x1e2ad3=_0x29a17f(_0x1d5814);_0x1e2ad3[_0x2b562a(0xd9a)](_0x40ac7f=>{const _0x1c1960=_0x2b562a;if(!_0x40ac7f[_0x1c1960(0xf74)]||_0x40ac7f['name']===_0x22fcd4||!_0x40ac7f['speech'])return;const _0x3fc792=Date[_0x1c1960(0xf1a)]()+Math[_0x1c1960(0xdc6)](),_0x4223a2=document[_0x1c1960(0x285)](_0x1c1960(0xb25));_0x4223a2[_0x1c1960(0x81c)]=_0x1c1960(0xcc7),_0x4223a2[_0x1c1960(0x1ef)]=_0x1c1960(0xc70)+_0x40ac7f[_0x1c1960(0xf74)]+_0x1c1960(0xf25)+_0x40ac7f[_0x1c1960(0x125d)],_0x4223a2['dataset']['timestamp']=_0x3fc792,_0xefe9e2(_0x4223a2,()=>_0x29eebd(_0x3fc792)),_0x47b96b['appendChild'](_0x4223a2),_0x333dc7['callHistory'][_0x1c1960(0x138c)]({'role':_0x1c1960(0x1377),'content':_0x40ac7f[_0x1c1960(0xf74)]+':\x20'+_0x40ac7f[_0x1c1960(0x125d)],'timestamp':_0x3fc792});const _0x5a94c3=_0x333dc7[_0x1c1960(0x394)][_0x1c1960(0x12f4)](_0x56babf=>_0x56babf[_0x1c1960(0xf74)]===_0x40ac7f['name']);if(_0x5a94c3){const _0x262667=document[_0x1c1960(0xd16)](_0x1c1960(0x15f)+_0x5a94c3['id']+'\x22]\x20.participant-avatar');_0x262667&&(_0x262667['classList']['add'](_0x1c1960(0x8eb)),setTimeout(()=>_0x262667['classList'][_0x1c1960(0x1247)](_0x1c1960(0x8eb)),0x7d0));}});}else{const _0x4141a8=Date[_0x2b562a(0xf1a)](),_0xdae4e0=document[_0x2b562a(0x285)](_0x2b562a(0xb25));_0xdae4e0[_0x2b562a(0x81c)]='call-message-bubble\x20ai-speech',_0xdae4e0[_0x2b562a(0xf12)]=_0x1d5814,_0xdae4e0[_0x2b562a(0xaaf)][_0x2b562a(0x114e)]=_0x4141a8,_0xefe9e2(_0xdae4e0,()=>_0x29eebd(_0x4141a8)),_0x47b96b[_0x2b562a(0x22f)](_0xdae4e0),_0x333dc7['callHistory'][_0x2b562a(0x138c)]({'role':_0x2b562a(0x1377),'content':_0x1d5814,'timestamp':_0x4141a8});const _0xab2def=document['querySelector']('.participant-avatar-wrapper\x20.participant-avatar');_0xab2def&&(_0xab2def[_0x2b562a(0x2f1)]['add'](_0x2b562a(0x8eb)),setTimeout(()=>_0xab2def['classList']['remove']('speaking'),0x7d0));}_0x47b96b[_0x2b562a(0xb0e)]=_0x47b96b['scrollHeight'];}catch(_0x50eea0){const _0x224fbd=document[_0x2b562a(0x285)](_0x2b562a(0xb25));_0x224fbd[_0x2b562a(0x81c)]='call-message-bubble\x20ai-speech',_0x224fbd[_0x2b562a(0x68e)]['color']=_0x2b562a(0x1151),_0x224fbd[_0x2b562a(0xf12)]='[ERROR:\x20'+_0x50eea0[_0x2b562a(0x1288)]+']',_0x47b96b[_0x2b562a(0x22f)](_0x224fbd),_0x47b96b[_0x2b562a(0xb0e)]=_0x47b96b[_0x2b562a(0x624)],_0x333dc7[_0x2b562a(0x1174)]['push']({'role':'assistant','content':_0x2b562a(0xc4b)+_0x50eea0[_0x2b562a(0x1288)]+']'});}}function _0xf49309(_0x19a51f){const _0x42de23=_0x41eae2;document[_0x42de23(0x89d)](_0x42de23(0xfe0))[_0x42de23(0x68e)][_0x42de23(0x126b)]=_0x19a51f?_0x42de23(0x10f2):_0x42de23(0x66e),document[_0x42de23(0x89d)]('group-video-call-btn')['style'][_0x42de23(0x126b)]=_0x19a51f?_0x42de23(0x66e):_0x42de23(0x10f2);}async function _0x562c24(_0x55fd4a,_0x58a5ba){const _0x252daa=_0x41eae2,_0x49f60f=_0x5b873d[_0x252daa(0x667)][_0x5b873d[_0x252daa(0xf96)]];if(!_0x49f60f)return;const _0x525e00=_0x49f60f['history']['findIndex'](_0xe7fb4e=>_0xe7fb4e[_0x252daa(0x114e)]===_0x55fd4a);if(_0x525e00===-0x1)return;const _0x2973a5=_0x49f60f['history'][_0x525e00];_0x2973a5[_0x252daa(0x632)]=_0x58a5ba;let _0x2158a0;const _0x53bf05=_0x49f60f[_0x252daa(0x58c)]?_0x49f60f[_0x252daa(0xdb9)][_0x252daa(0xc48)]||'我':'我';_0x58a5ba===_0x252daa(0x1385)?(_0x2973a5[_0x252daa(0x765)]=_0x53bf05,_0x2158a0=_0x252daa(0xf17)+_0x53bf05+_0x252daa(0x2ea)+_0x2973a5[_0x252daa(0xcfc)]+_0x252daa(0x3b2)+_0x55fd4a+_0x252daa(0x1122)):_0x2158a0='[系统提示：你\x20('+_0x53bf05+_0x252daa(0x976)+_0x2973a5[_0x252daa(0xcfc)]+_0x252daa(0xe01)+_0x55fd4a+_0x252daa(0x178);const _0x5a3115={'role':_0x252daa(0x18c),'content':_0x2158a0,'timestamp':Date[_0x252daa(0xf1a)](),'isHidden':!![]};_0x49f60f[_0x252daa(0x551)][_0x252daa(0x138c)](_0x5a3115),await _0x1a6951[_0x252daa(0x667)]['put'](_0x49f60f),_0x5b89df(_0x5b873d['activeChatId']),_0x58a5ba==='paid'&&_0x2e3505();}async function _0x167bd1(_0x41d477,_0x5ee6d4){const _0x6a4164=_0x41eae2,_0x309f2b=_0x5b873d[_0x6a4164(0x667)][_0x41d477];if(!_0x309f2b)return;let _0x2e45d4;_0x309f2b[_0x6a4164(0x58c)]?_0x2e45d4=_0xb9963e(_0x309f2b,_0x5ee6d4):_0x2e45d4=_0x309f2b[_0x6a4164(0xf74)];const _0x280ca2=document[_0x6a4164(0x89d)](_0x6a4164(0x34e));_0x280ca2[_0x6a4164(0x2f1)][_0x6a4164(0x1247)](_0x6a4164(0x11c7)),void _0x280ca2[_0x6a4164(0xf13)],_0x280ca2[_0x6a4164(0x2f1)][_0x6a4164(0x569)](_0x6a4164(0x11c7));const _0x3aae0d=await _0x34d246('你拍了拍\x20“'+_0x2e45d4+'”',_0x6a4164(0x1021),'',_0x6a4164(0xec9));if(_0x3aae0d===null)return;const _0x664b83=_0xb9963e(_0x309f2b,_0x5b873d['qzoneSettings'][_0x6a4164(0x22a)]),_0x26f828=_0x664b83+'\x20拍了拍\x20“'+_0x2e45d4+'”\x20'+_0x3aae0d[_0x6a4164(0xc3a)](),_0x5535e9={'role':'system','type':_0x6a4164(0xc7a),'content':_0x26f828,'timestamp':Date['now']()};_0x309f2b[_0x6a4164(0x551)][_0x6a4164(0x138c)](_0x5535e9);const _0x4c6760=_0x6a4164(0xff6)+_0x664b83+_0x6a4164(0xbcf)+_0x5ee6d4+'）'+_0x3aae0d[_0x6a4164(0xc3a)]()+'。请你对此作出回应。]',_0x4fffc4={'role':_0x6a4164(0x18c),'content':_0x4c6760,'timestamp':Date[_0x6a4164(0xf1a)]()+0x1,'isHidden':!![]};_0x309f2b['history'][_0x6a4164(0x138c)](_0x4fffc4),await _0x1a6951['chats'][_0x6a4164(0xc0f)](_0x309f2b),_0x5b873d[_0x6a4164(0xf96)]===_0x41d477&&_0x58deee(_0x5535e9,_0x309f2b),await _0x413d78();}let _0x2b2917=null,_0x3c91a0=![],_0x12474b=new Set();function _0x29eebd(_0x2e0f8e){const _0x3f6ed2=_0x41eae2;_0x2b2917=_0x2e0f8e,document[_0x3f6ed2(0x89d)]('call-message-actions-modal')[_0x3f6ed2(0x2f1)][_0x3f6ed2(0x569)](_0x3f6ed2(0x11e4));}function _0x320481(){const _0x35f3c7=_0x41eae2;document[_0x35f3c7(0x89d)](_0x35f3c7(0xa01))[_0x35f3c7(0x2f1)][_0x35f3c7(0x1247)](_0x35f3c7(0x11e4)),_0x2b2917=null;}async function _0x1669bc(){const _0x7893ae=_0x41eae2;if(!_0x2b2917)return;const _0x37692f=_0x2b2917,_0x2b9968=_0x333dc7[_0x7893ae(0x1174)][_0x7893ae(0x12f4)](_0x5e7d4d=>_0x5e7d4d['timestamp']===_0x37692f);if(!_0x2b9968)return;_0x320481();let _0x7aa7b7=_0x2b9968[_0x7893ae(0x28c)];if(_0x333dc7['isGroupCall']&&_0x2b9968[_0x7893ae(0xa57)]==='assistant'){const _0x3516d5=_0x2b9968[_0x7893ae(0x28c)][_0x7893ae(0x55b)](':\x20');_0x3516d5['length']>0x1&&(_0x7aa7b7=_0x3516d5[_0x7893ae(0xdd0)](0x1)[_0x7893ae(0x1237)](':\x20'));}const _0x3b3a1e=await _0x34d246(_0x7893ae(0x87b),_0x7893ae(0x8aa),_0x7aa7b7,_0x7893ae(0x11b9));_0x3b3a1e!==null&&await _0x374392(_0x37692f,_0x3b3a1e);}async function _0x374392(_0x1ade66,_0x260c6a){const _0x3d65d8=_0x41eae2,_0x2e73d6=_0x333dc7['callHistory'][_0x3d65d8(0x12f4)](_0x37bff4=>_0x37bff4['timestamp']===_0x1ade66);if(_0x2e73d6){let _0x4c7c50=_0x260c6a;if(_0x333dc7['isGroupCall']&&_0x2e73d6[_0x3d65d8(0xa57)]===_0x3d65d8(0x1377)){const _0x273c86=_0x2e73d6[_0x3d65d8(0x28c)][_0x3d65d8(0x55b)](':\x20'),_0x4dc779=_0x273c86[0x0];_0x4c7c50=_0x4dc779+':\x20'+_0x260c6a;}_0x2e73d6['content']=_0x4c7c50;const _0x28e1b0=document[_0x3d65d8(0xd16)](_0x3d65d8(0xd94)+_0x1ade66+'\x22]');if(_0x28e1b0){if(_0x333dc7[_0x3d65d8(0x43c)]&&_0x2e73d6['role']===_0x3d65d8(0x1377)){const _0x173e79=_0x2e73d6['content'][_0x3d65d8(0x55b)](':\x20'),_0x141bd0=_0x173e79[0x0];_0x28e1b0[_0x3d65d8(0x1ef)]=_0x3d65d8(0xc70)+_0x141bd0+_0x3d65d8(0xf25)+_0x260c6a;}else _0x28e1b0[_0x3d65d8(0xf12)]=_0x260c6a;}}await _0x532f76('成功',_0x3d65d8(0xa1e));}async function _0x3985d8(){const _0x1baa6f=_0x41eae2;if(!_0x2b2917)return;const _0x5bcaa0=await _0x4e2abc(_0x1baa6f(0xd44),'确定要删除这条通话消息吗？',{'confirmButtonClass':_0x1baa6f(0xcd8)});if(_0x5bcaa0){const _0x23df2b=_0x2b2917;_0x320481();const _0x1478c4=_0x333dc7[_0x1baa6f(0x1174)][_0x1baa6f(0x9d7)](_0x3b641d=>_0x3b641d[_0x1baa6f(0x114e)]===_0x23df2b);_0x1478c4>-0x1&&_0x333dc7[_0x1baa6f(0x1174)]['splice'](_0x1478c4,0x1);const _0xe89297=document[_0x1baa6f(0xd16)](_0x1baa6f(0xd94)+_0x23df2b+'\x22]');_0xe89297&&_0xe89297[_0x1baa6f(0x1247)]();}else _0x320481();}function _0x4c3bea(_0x54bc38){const _0xe90c5c=_0x41eae2;_0x376b26=_0x54bc38;const _0x27fd0d=_0x5b873d['chats'][_0x5b873d['activeChatId']],_0x53b849=_0x27fd0d['history'][_0xe90c5c(0x12f4)](_0x472b55=>_0x472b55[_0xe90c5c(0x114e)]===_0x54bc38);_0x53b849&&(document['getElementById']('transfer-sender-name')[_0xe90c5c(0xf12)]=_0x53b849[_0xe90c5c(0xcfc)]),document[_0xe90c5c(0x89d)]('transfer-actions-modal')[_0xe90c5c(0x2f1)]['add'](_0xe90c5c(0x11e4));}function _0x5a2370(){const _0x5f64af=_0x41eae2;document['getElementById'](_0x5f64af(0x1063))['classList'][_0x5f64af(0x1247)](_0x5f64af(0x11e4)),_0x376b26=null;}async function _0x477dc9(_0x1545b3){const _0x1affd1=_0x41eae2;if(!_0x376b26)return;const _0x7d7463=_0x376b26,_0xd20be2=_0x5b873d['chats'][_0x5b873d[_0x1affd1(0xf96)]],_0x1cadc3=_0xd20be2[_0x1affd1(0x551)][_0x1affd1(0x9d7)](_0x48f2c7=>_0x48f2c7[_0x1affd1(0x114e)]===_0x7d7463);if(_0x1cadc3===-0x1)return;const _0x5b86ce=_0xd20be2[_0x1affd1(0x551)][_0x1cadc3];_0x5b86ce['status']=_0x1545b3;let _0x4b6262;if(_0x1545b3===_0x1affd1(0xc0e)){const _0x9341a4={'role':'user','type':_0x1affd1(0x1075),'isRefund':!![],'amount':_0x5b86ce[_0x1affd1(0x10a6)],'note':_0x1affd1(0x2b9),'timestamp':Date[_0x1affd1(0xf1a)]()};_0xd20be2[_0x1affd1(0x551)][_0x1affd1(0x138c)](_0x9341a4),_0x4b6262=_0x1affd1(0x1106)+_0x5b86ce[_0x1affd1(0xcfc)]+_0x1affd1(0xbe8);}else _0x4b6262=_0x1affd1(0xf67)+_0x5b86ce[_0x1affd1(0xcfc)]+'”的转账。]';const _0x276eb5={'role':_0x1affd1(0x18c),'content':_0x4b6262,'timestamp':Date[_0x1affd1(0xf1a)]()+0x1,'isHidden':!![]};_0xd20be2[_0x1affd1(0x551)][_0x1affd1(0x138c)](_0x276eb5),await _0x1a6951[_0x1affd1(0x667)]['put'](_0xd20be2),_0x5a2370(),_0x5b89df(_0x5b873d[_0x1affd1(0xf96)]),_0x413d78();}function _0x4bca60(_0x1510f5){const _0x1fce57=_0x41eae2;_0x5219d8=null;if(_0x1510f5){const _0x2c0b97=_0x1510f5[_0x1fce57(0xd16)](_0x1fce57(0x109a));_0x2c0b97&&(_0x2c0b97[_0x1fce57(0xe4f)]=_0x1fce57(0x44c));}}async function _0xa1c3d1(){const _0x52c8fe=_0x41eae2,_0x6f3614=document[_0x52c8fe(0x89d)]('memories-list');_0x6f3614[_0x52c8fe(0x1ef)]='';const _0x3b8596=await _0x1a6951['memories']['orderBy'](_0x52c8fe(0x114e))[_0x52c8fe(0x854)]()['toArray']();if(_0x3b8596[_0x52c8fe(0x7aa)]===0x0){_0x6f3614[_0x52c8fe(0x1ef)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>';return;}_0x3b8596[_0x52c8fe(0x2e3)]((_0x1a1b46,_0x2ff63e)=>{const _0x50497e=_0x52c8fe,_0x598a9d=_0x1a1b46[_0x50497e(0x48c)]===_0x50497e(0x6d8)&&_0x1a1b46[_0x50497e(0x4ad)]>Date[_0x50497e(0xf1a)](),_0x4bdc23=_0x2ff63e['type']===_0x50497e(0x6d8)&&_0x2ff63e[_0x50497e(0x4ad)]>Date[_0x50497e(0xf1a)]();if(_0x598a9d&&!_0x4bdc23)return-0x1;if(!_0x598a9d&&_0x4bdc23)return 0x1;if(_0x598a9d&&_0x4bdc23)return _0x1a1b46['targetDate']-_0x2ff63e[_0x50497e(0x4ad)];return 0x0;}),_0x3b8596[_0x52c8fe(0xd9a)](_0x59948e=>{const _0x6011a9=_0x52c8fe;let _0x526bf0;_0x59948e[_0x6011a9(0x48c)]===_0x6011a9(0x6d8)&&_0x59948e[_0x6011a9(0x4ad)]>Date['now']()?_0x526bf0=_0x35ca25(_0x59948e):_0x526bf0=_0x1e0e2f(_0x59948e),_0x6f3614[_0x6011a9(0x22f)](_0x526bf0);}),_0x3f9825();}function _0x1e0e2f(_0x17519e){const _0x54a6c5=_0x41eae2,_0x236881=document['createElement'](_0x54a6c5(0xb25));_0x236881['className']=_0x54a6c5(0x2bd);const _0x2739e1=new Date(_0x17519e[_0x54a6c5(0x114e)]),_0xef8db1=_0x2739e1[_0x54a6c5(0x555)]()+'-'+String(_0x2739e1[_0x54a6c5(0x86f)]()+0x1)['padStart'](0x2,'0')+'-'+String(_0x2739e1[_0x54a6c5(0x518)]())[_0x54a6c5(0x4d8)](0x2,'0')+'\x20'+String(_0x2739e1[_0x54a6c5(0x9bb)]())['padStart'](0x2,'0')+':'+String(_0x2739e1['getMinutes']())[_0x54a6c5(0x4d8)](0x2,'0');let _0x43dd2b,_0x28bb7d;if(_0x17519e[_0x54a6c5(0x48c)]===_0x54a6c5(0x6d8)&&_0x17519e[_0x54a6c5(0x4ad)])_0x43dd2b=_0x54a6c5(0x5ba)+_0x17519e[_0x54a6c5(0xf6e)],_0x28bb7d=_0x55b8e7('在\x20'+new Date(_0x17519e[_0x54a6c5(0x4ad)])[_0x54a6c5(0x425)]()+_0x54a6c5(0x6f2))[_0x54a6c5(0xfbf)](/\n/g,_0x54a6c5(0x962));else{let _0x513946=_0x54a6c5(0x1080);if(_0x17519e[_0x54a6c5(0xc3f)]){const _0x1f7440=_0x5b873d[_0x54a6c5(0x667)][_0x17519e[_0x54a6c5(0xc3f)]];_0x1f7440?_0x513946=_0x1f7440['name']:_0x513946=_0x17519e[_0x54a6c5(0xa59)]||'一位朋友';}else _0x17519e[_0x54a6c5(0xa59)]&&(_0x513946=_0x17519e[_0x54a6c5(0xa59)]);_0x43dd2b=_0x513946+_0x54a6c5(0x52b),_0x28bb7d=_0x55b8e7(_0x17519e[_0x54a6c5(0xf6e)]);}return _0x236881['innerHTML']=_0x54a6c5(0x34c)+_0xef8db1+_0x54a6c5(0xe92)+_0x43dd2b+_0x54a6c5(0xba6)+_0x28bb7d+_0x54a6c5(0x590),_0xefe9e2(_0x236881,async()=>{const _0x1668ca=_0x54a6c5,_0x4ce9e5=await _0x4e2abc(_0x1668ca(0xe21),_0x1668ca(0x1109),{'confirmButtonClass':_0x1668ca(0xcd8)});_0x4ce9e5&&(await _0x1a6951[_0x1668ca(0x19e)][_0x1668ca(0x684)](_0x17519e['id']),_0xa1c3d1());}),_0x236881;}function _0x35ca25(_0x12137e){const _0x1e9568=_0x41eae2,_0x2f3840=document[_0x1e9568(0x285)](_0x1e9568(0xb25));_0x2f3840['className']=_0x1e9568(0x89f);const _0x5d941d=new Date(_0x12137e[_0x1e9568(0x4ad)]),_0x426789=_0x5d941d[_0x1e9568(0x425)](_0x1e9568(0x1e8),{'dateStyle':'full','timeStyle':_0x1e9568(0x248)});return _0x2f3840['innerHTML']=_0x1e9568(0x480)+_0x12137e[_0x1e9568(0xf6e)]+_0x1e9568(0x76e)+_0x12137e[_0x1e9568(0x4ad)]+_0x1e9568(0x448)+_0x426789+_0x1e9568(0x590),_0xefe9e2(_0x2f3840,async()=>{const _0x28e595=_0x1e9568,_0x59f4ef=await _0x4e2abc(_0x28e595(0x3db),_0x28e595(0xbb9),{'confirmButtonClass':_0x28e595(0xcd8)});_0x59f4ef&&(await _0x1a6951[_0x28e595(0x19e)][_0x28e595(0x684)](_0x12137e['id']),_0xa1c3d1());}),_0x2f3840;}let _0x477f8e=[];function _0x3f9825(){const _0x11e013=_0x41eae2;_0x477f8e[_0x11e013(0xd9a)](_0x14c92e=>clearInterval(_0x14c92e)),_0x477f8e=[],document[_0x11e013(0x35f)](_0x11e013(0x467))[_0x11e013(0xd9a)](_0x2146a4=>{const _0x546a10=_0x11e013,_0x3f354c=parseInt(_0x2146a4[_0x546a10(0xaaf)]['targetDate']);let _0x45111d;const _0x9f8c74=()=>{const _0x8dbb0=_0x546a10,_0x4f8331=Date[_0x8dbb0(0xf1a)](),_0x1d85bc=_0x3f354c-_0x4f8331;if(_0x1d85bc<0x0){_0x2146a4[_0x8dbb0(0xf12)]=_0x8dbb0(0x1351),clearInterval(_0x45111d),setTimeout(()=>_0xa1c3d1(),0x7d0);return;}const _0xe9a119=Math[_0x8dbb0(0x128a)](_0x1d85bc/(0x3e8*0x3c*0x3c*0x18)),_0x4f5546=Math[_0x8dbb0(0x128a)](_0x1d85bc%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x5d9900=Math[_0x8dbb0(0x128a)](_0x1d85bc%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x38586d=Math['floor'](_0x1d85bc%(0x3e8*0x3c)/0x3e8);_0x2146a4[_0x8dbb0(0xf12)]=_0xe9a119+'天\x20'+_0x4f5546+'时\x20'+_0x5d9900+'分\x20'+_0x38586d+'秒';};_0x9f8c74(),_0x45111d=setInterval(_0x9f8c74,0x3e8),_0x477f8e['push'](_0x45111d);});}async function _0x53ef51(_0x4334c4){const _0x4dc778=_0x41eae2,_0x521456=_0x5b873d[_0x4dc778(0x667)][_0x4334c4];if(!_0x521456)return;await _0x532f76(_0x4dc778(0xb3d),_0x4dc778(0x481)+_0x521456[_0x4dc778(0xf74)]+_0x4dc778(0x12fd));const {proxyUrl:_0x240324,apiKey:_0x268f53,model:_0x513430}=_0x5b873d[_0x4dc778(0x30d)];if(!_0x240324||!_0x268f53||!_0x513430){await _0x532f76(_0x4dc778(0x12fa),_0x4dc778(0x5bf));return;}const _0x2122e0=_0x521456[_0x4dc778(0x551)][_0x4dc778(0xdd0)](-0x5)[_0x4dc778(0x412)](_0x30c90c=>{const _0x1f9bfc=_0x4dc778,_0x1d0c9b=_0x30c90c[_0x1f9bfc(0xa57)]===_0x1f9bfc(0x116c)?_0x521456['settings'][_0x1f9bfc(0xc48)]||'我':_0x30c90c[_0x1f9bfc(0xcfc)]||_0x521456['name'];return _0x1d0c9b+':\x20'+String(_0x30c90c['content'])['substring'](0x0,0x32)+_0x1f9bfc(0x1046);})[_0x4dc778(0x1237)]('\x0a');let _0x4b2681='';if(_0x521456['settings'][_0x4dc778(0x32d)]&&_0x521456[_0x4dc778(0xdb9)][_0x4dc778(0x32d)][_0x4dc778(0x7aa)]>0x0){const _0x5e0ca0=_0x521456[_0x4dc778(0xdb9)][_0x4dc778(0x32d)]['map'](_0x223e69=>{const _0x4a8bca=_0x4dc778,_0x55854e=_0x5b873d[_0x4a8bca(0x8a1)][_0x4a8bca(0x12f4)](_0x11bd72=>_0x11bd72['id']===_0x223e69);if(!_0x55854e||!Array[_0x4a8bca(0xbd6)](_0x55854e[_0x4a8bca(0x28c)]))return'';const _0x83adcb=_0x55854e[_0x4a8bca(0x28c)]['map'](_0xb4a64b=>{const _0x55d34d=_0x4a8bca;let _0x130d2f='\x0a###\x20条目:\x20'+(_0xb4a64b['comment']||'无备注')+'\x0a';return _0xb4a64b[_0x55d34d(0xe9c)][_0x55d34d(0x7aa)]>0x0&&(_0x130d2f+=_0x55d34d(0x1dc)+_0xb4a64b[_0x55d34d(0xe9c)]['join'](',\x20')+'\x0a'),_0x130d2f+=_0x55d34d(0x280)+_0xb4a64b['content'],_0x130d2f;})[_0x4a8bca(0x1237)]('\x0a');return _0x83adcb?_0x4a8bca(0xb85)+_0x55854e['name']+'\x0a'+_0x83adcb:'';})[_0x4dc778(0x3d8)](Boolean)[_0x4dc778(0x1237)]('');_0x5e0ca0&&(_0x4b2681=_0x4dc778(0x12aa)+_0x5e0ca0+'\x0a');}const _0x5d2b97=_0x4dc778(0xc36)+_0x521456[_0x4dc778(0xf74)]+_0x4dc778(0x6da)+_0x521456[_0x4dc778(0xdb9)]['aiPersona']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4b2681+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2122e0+_0x4dc778(0x12bc);try{const _0x4c52ac=[{'role':_0x4dc778(0x18c),'content':_0x5d2b97},{'role':'user','content':_0x4dc778(0x7dc)}];let _0x769e36=_0x240324===GEMINI_API_URL,_0x591328=_0xa615f4(_0x513430,_0x268f53,_0x5d2b97,_0x4c52ac);const _0x19f4bf=_0x769e36?await fetch(_0x591328[_0x4dc778(0x11de)],_0x591328[_0x4dc778(0xd98)]):await fetch(_0x240324+_0x4dc778(0x6dd),{'method':'POST','headers':{'Content-Type':_0x4dc778(0xce4),'Authorization':_0x4dc778(0x3fb)+_0x268f53},'body':JSON[_0x4dc778(0x465)]({'model':_0x513430,'messages':_0x4c52ac,'temperature':_0x5b873d[_0x4dc778(0x21a)][_0x4dc778(0x576)]||0.9})});if(!_0x19f4bf['ok']){const _0x3a263b=await _0x19f4bf[_0x4dc778(0x6b5)]();throw new Error(_0x4dc778(0xf8b)+_0x19f4bf[_0x4dc778(0x632)]+_0x4dc778(0xc3d)+_0x3a263b['error'][_0x4dc778(0x1288)]);}const _0x39fffe=await _0x19f4bf['json']();let _0xe2a8ca=_0x769e36?_0x39fffe[_0x4dc778(0xb59)][0x0]['content'][_0x4dc778(0x496)][0x0][_0x4dc778(0xec9)]:_0x39fffe[_0x4dc778(0xd3b)][0x0][_0x4dc778(0x1288)][_0x4dc778(0x28c)];_0xe2a8ca=_0xe2a8ca[_0x4dc778(0xfbf)](/^```json\s*/,'')[_0x4dc778(0xfbf)](/```$/,'');const _0x2064b2=_0xe2a8ca['trim'](),_0x518cb6=JSON[_0x4dc778(0x2cb)](_0x2064b2);_0x518cb6['decision']==='apply'&&_0x518cb6[_0x4dc778(0xb90)]?(_0x521456[_0x4dc778(0x1383)][_0x4dc778(0x632)]=_0x4dc778(0xb7f),_0x521456[_0x4dc778(0x1383)][_0x4dc778(0x1240)]=_0x518cb6[_0x4dc778(0xb90)],_0x5b873d[_0x4dc778(0x667)][_0x4334c4]=_0x521456,_0x413d78(),await _0x532f76(_0x4dc778(0xed6),'“'+_0x521456['name']+'”已向你发送好友申请。请返回聊天列表查看。')):(await _0x532f76(_0x4dc778(0xcc4),'“'+_0x521456[_0x4dc778(0xf74)]+_0x4dc778(0x7bd)),_0x521456['relationship'][_0x4dc778(0x632)]=_0x4dc778(0x4c8),_0x521456[_0x4dc778(0x1383)]['blockedTimestamp']=Date[_0x4dc778(0xf1a)]());}catch(_0x2ba8e0){await _0x532f76(_0x4dc778(0x83d),'为“'+_0x521456[_0x4dc778(0xf74)]+_0x4dc778(0x58a)+_0x2ba8e0[_0x4dc778(0x1288)]+_0x4dc778(0x350)),_0x521456[_0x4dc778(0x1383)][_0x4dc778(0x632)]=_0x4dc778(0x4c8),_0x521456['relationship']['blockedTimestamp']=Date[_0x4dc778(0xf1a)]();}finally{await _0x1a6951[_0x4dc778(0x667)][_0x4dc778(0xc0f)](_0x521456),_0x5b89df(_0x4334c4);}}function _0xcefb8b(){const _0x153670=_0x41eae2;if(!_0x5b873d[_0x153670(0xf96)])return;const _0x266b3f=_0x5b873d[_0x153670(0x667)][_0x5b873d['activeChatId']];_0x266b3f[_0x153670(0x58c)]?_0x4130ea():document[_0x153670(0x89d)]('transfer-modal')['classList'][_0x153670(0x569)](_0x153670(0x11e4));}function _0x4130ea(){const _0x228c88=_0x41eae2,_0x551f33=document[_0x228c88(0x89d)](_0x228c88(0xaca)),_0x52d2fb=_0x5b873d[_0x228c88(0x667)][_0x5b873d[_0x228c88(0xf96)]];document[_0x228c88(0x89d)]('rp-group-amount')['value']='',document[_0x228c88(0x89d)](_0x228c88(0x1234))['value']='',document[_0x228c88(0x89d)]('rp-group-greeting')['value']='',document[_0x228c88(0x89d)](_0x228c88(0x52f))[_0x228c88(0x2f4)]='',document[_0x228c88(0x89d)](_0x228c88(0x3f0))[_0x228c88(0x2f4)]='',document[_0x228c88(0x89d)](_0x228c88(0xa32))[_0x228c88(0xf12)]=_0x228c88(0x1e1),document[_0x228c88(0x89d)](_0x228c88(0xc6a))[_0x228c88(0xf12)]='¥\x200.00';const _0x1f9626=document[_0x228c88(0x89d)](_0x228c88(0x985));_0x1f9626[_0x228c88(0x1ef)]='',_0x52d2fb[_0x228c88(0x5ab)][_0x228c88(0xd9a)](_0x599450=>{const _0x3256bb=_0x228c88,_0x24b37a=document[_0x3256bb(0x285)](_0x3256bb(0xc39));_0x24b37a[_0x3256bb(0x2f4)]=_0x599450[_0x3256bb(0x1045)],_0x24b37a[_0x3256bb(0xf12)]=_0x599450['groupNickname'],_0x1f9626[_0x3256bb(0x22f)](_0x24b37a);}),document['getElementById'](_0x228c88(0xb69))[_0x228c88(0x12a5)](),_0x551f33[_0x228c88(0x2f1)][_0x228c88(0x569)]('visible');}async function _0x3ddd65(){const _0x529b09=_0x41eae2,_0x57fc74=_0x5b873d[_0x529b09(0x667)][_0x5b873d[_0x529b09(0xf96)]],_0x34ede4=parseFloat(document['getElementById']('rp-group-amount')['value']),_0x22d8d9=parseInt(document[_0x529b09(0x89d)]('rp-group-count')[_0x529b09(0x2f4)]),_0x4ab37d=document[_0x529b09(0x89d)]('rp-group-greeting')['value'][_0x529b09(0xc3a)]();if(isNaN(_0x34ede4)||_0x34ede4<=0x0){alert(_0x529b09(0xa91));return;}if(isNaN(_0x22d8d9)||_0x22d8d9<=0x0){alert(_0x529b09(0x126a));return;}if(_0x34ede4/_0x22d8d9<0.01){alert(_0x529b09(0x40f));return;}const _0xe07cd9=_0x57fc74[_0x529b09(0xdb9)][_0x529b09(0xc48)]||'我',_0x2c3dee={'role':'user','senderName':_0xe07cd9,'type':_0x529b09(0x675),'packetType':_0x529b09(0x9a8),'timestamp':Date[_0x529b09(0xf1a)](),'totalAmount':_0x34ede4,'count':_0x22d8d9,'greeting':_0x4ab37d||'恭喜发财，大吉大利！','claimedBy':{},'isFullyClaimed':![]};_0x57fc74[_0x529b09(0x551)]['push'](_0x2c3dee),await _0x1a6951['chats'][_0x529b09(0xc0f)](_0x57fc74),_0x58deee(_0x2c3dee,_0x57fc74),_0x413d78(),document[_0x529b09(0x89d)](_0x529b09(0xaca))['classList'][_0x529b09(0x1247)]('visible');}async function _0x55c90b(){const _0x32bf1f=_0x41eae2,_0x1ef473=_0x5b873d[_0x32bf1f(0x667)][_0x5b873d[_0x32bf1f(0xf96)]],_0x3e03b7=parseFloat(document[_0x32bf1f(0x89d)]('rp-direct-amount')[_0x32bf1f(0x2f4)]),_0x421690=document['getElementById']('rp-direct-receiver')[_0x32bf1f(0x2f4)],_0x22d082=document['getElementById'](_0x32bf1f(0x3f0))[_0x32bf1f(0x2f4)][_0x32bf1f(0xc3a)]();if(isNaN(_0x3e03b7)||_0x3e03b7<=0x0){alert('请输入有效的金额！');return;}if(!_0x421690){alert(_0x32bf1f(0x643));return;}const _0x5e0865=_0x1ef473['settings'][_0x32bf1f(0xc48)]||'我',_0x30dc44={'role':_0x32bf1f(0x116c),'senderName':_0x5e0865,'type':'red_packet','packetType':'direct','timestamp':Date[_0x32bf1f(0xf1a)](),'totalAmount':_0x3e03b7,'count':0x1,'greeting':_0x22d082||'给你准备了一个红包','receiverName':_0x421690,'claimedBy':{},'isFullyClaimed':![]};_0x1ef473[_0x32bf1f(0x551)]['push'](_0x30dc44),await _0x1a6951[_0x32bf1f(0x667)][_0x32bf1f(0xc0f)](_0x1ef473),_0x58deee(_0x30dc44,_0x1ef473),_0x413d78(),document[_0x32bf1f(0x89d)](_0x32bf1f(0xaca))[_0x32bf1f(0x2f1)][_0x32bf1f(0x1247)](_0x32bf1f(0x11e4));}async function _0x3d2fbc(_0x55e59f){const _0x486a00=_0x41eae2,_0x5a675f=_0x5b873d[_0x486a00(0xf96)],_0x258e4a=await _0x1a6951[_0x486a00(0x667)][_0x486a00(0x650)](_0x5a675f);if(!_0x258e4a)return;_0x5b873d[_0x486a00(0x667)][_0x5a675f]=_0x258e4a;const _0x1e096f=_0x258e4a[_0x486a00(0x551)][_0x486a00(0x12f4)](_0x590178=>_0x590178[_0x486a00(0x114e)]===_0x55e59f);if(!_0x1e096f)return;const _0x18021e=_0x5b873d[_0x486a00(0x5c1)]['nickname']||_0x486a00(0x1285),_0x10054b=_0x1e096f[_0x486a00(0xb37)]&&_0x1e096f[_0x486a00(0xb37)][_0x18021e];if(_0x1e096f[_0x486a00(0x2d1)]===_0x486a00(0xfc5)&&_0x1e096f[_0x486a00(0xb12)]!==_0x18021e&&Object['keys'](_0x1e096f['claimedBy'])[_0x486a00(0x7aa)]>0x0||_0x1e096f[_0x486a00(0x9aa)]||_0x10054b){_0x118349(_0x1e096f);return;}const _0x5e6f8e=await _0xa6009b(_0x1e096f);_0x5e6f8e!==null&&(await _0x5b89df(_0x5a675f),await _0x532f76(_0x486a00(0x1341),'你领取了\x20'+_0xb9963e(_0x258e4a,_0x1e096f['senderName'])+_0x486a00(0xc1e)+_0x5e6f8e[_0x486a00(0x8f7)](0x2)+_0x486a00(0xa68)));const _0x843d08=_0x5b873d[_0x486a00(0x667)][_0x5a675f][_0x486a00(0x551)][_0x486a00(0x12f4)](_0x123b69=>_0x123b69[_0x486a00(0x114e)]===_0x55e59f);_0x843d08&&_0x118349(_0x843d08);}async function _0xa6009b(_0x587351){const _0x1d79bd=_0x41eae2,_0x161344=_0x5b873d[_0x1d79bd(0x667)][_0x5b873d[_0x1d79bd(0xf96)]];let _0x2548e1=Date[_0x1d79bd(0xf1a)]();const _0x594431=_0x5b873d['qzoneSettings'][_0x1d79bd(0x22a)]||'{{user}}',_0xe42ab2=_0x587351[_0x1d79bd(0x749)]-Object['keys'](_0x587351[_0x1d79bd(0xb37)]||{})['length'];if(_0xe42ab2<=0x0)return _0x587351[_0x1d79bd(0x9aa)]=!![],await _0x1a6951['chats']['put'](_0x161344),await _0x532f76(_0x1d79bd(0x6e8),'红包已被领完！'),null;let _0x3a04a9=0x0;const _0x5a39c6=_0x587351['totalAmount']-Object[_0x1d79bd(0x4b5)](_0x587351['claimedBy']||{})[_0x1d79bd(0x11e2)]((_0x56db98,_0x1da2fc)=>_0x56db98+_0x1da2fc,0x0);if(_0x587351[_0x1d79bd(0x2d1)]==='lucky'){if(_0xe42ab2===0x1)_0x3a04a9=_0x5a39c6;else{const _0x5903fb=0.01,_0x1cabf2=_0x5a39c6-(_0xe42ab2-0x1)*_0x5903fb;_0x3a04a9=Math[_0x1d79bd(0xdc6)]()*(_0x1cabf2-_0x5903fb)+_0x5903fb;}}else _0x3a04a9=_0x587351[_0x1d79bd(0x33e)];_0x3a04a9=parseFloat(_0x3a04a9['toFixed'](0x2));if(!_0x587351[_0x1d79bd(0xb37)])_0x587351[_0x1d79bd(0xb37)]={};_0x587351[_0x1d79bd(0xb37)][_0x594431]=_0x3a04a9;const _0x298583=Object[_0x1d79bd(0xe9c)](_0x587351['claimedBy'])[_0x1d79bd(0x7aa)]>=_0x587351[_0x1d79bd(0x749)];_0x298583&&(_0x587351[_0x1d79bd(0x9aa)]=!![]);const _0x1fb1da=_0xb9963e(_0x161344,_0x594431),_0x2cd8a4=_0xb9963e(_0x161344,_0x587351[_0x1d79bd(0xcfc)]),_0x5c48fc={'role':_0x1d79bd(0x18c),'type':_0x1d79bd(0xc7a),'content':_0x1d79bd(0x49a)+_0x2cd8a4+'\x20的红包','timestamp':_0x2548e1++};_0x161344[_0x1d79bd(0x551)][_0x1d79bd(0x138c)](_0x5c48fc);let _0x12a7fb;if(_0x298583){const _0x208434={'role':_0x1d79bd(0x18c),'type':_0x1d79bd(0xc7a),'content':_0x2cd8a4+'\x20的红包已被领完','timestamp':_0x2548e1++};_0x161344['history'][_0x1d79bd(0x138c)](_0x208434);let _0x1f6570={'name':'','amount':-0x1};_0x587351[_0x1d79bd(0x2d1)]===_0x1d79bd(0x9a8)&&_0x587351[_0x1d79bd(0x749)]>0x1&&Object[_0x1d79bd(0xa7f)](_0x587351[_0x1d79bd(0xb37)])[_0x1d79bd(0xd9a)](([_0x167248,_0x1e29b5])=>{_0x1e29b5>_0x1f6570['amount']&&(_0x1f6570={'name':_0x167248,'amount':_0x1e29b5});});const _0x4cdc6d=_0x1f6570['name']?_0xb9963e(_0x161344,_0x1f6570['name']):'无';_0x12a7fb=_0x1d79bd(0x1029)+_0x1fb1da+_0x1d79bd(0x258)+_0x4cdc6d+_0x1d79bd(0x26c);}else _0x12a7fb=_0x1d79bd(0x1029)+_0x1fb1da+_0x1d79bd(0x1172)+_0x587351['timestamp']+_0x1d79bd(0x1276);const _0x45deca={'role':'system','content':_0x12a7fb,'timestamp':_0x2548e1++,'isHidden':!![]};return _0x161344['history'][_0x1d79bd(0x138c)](_0x45deca),await _0x1a6951[_0x1d79bd(0x667)]['put'](_0x161344),_0x3a04a9;}async function _0x118349(_0x37d1bc){const _0x4e6e49=_0x41eae2;if(!_0x37d1bc){console[_0x4e6e49(0x1fd)]('showRedPacketDetails收到了无效的packet对象');return;}const _0x5c607e=_0x5b873d['chats'][_0x5b873d[_0x4e6e49(0xf96)]];if(!_0x5c607e)return;const _0xa210f5=document[_0x4e6e49(0x89d)](_0x4e6e49(0x3a1)),_0x1f68a6=_0x5b873d[_0x4e6e49(0x5c1)][_0x4e6e49(0x22a)]||_0x4e6e49(0x1285),_0x43565e=_0xb9963e(_0x5c607e,_0x37d1bc['senderName']);document[_0x4e6e49(0x89d)]('rp-details-sender')['textContent']=_0x43565e,document[_0x4e6e49(0x89d)](_0x4e6e49(0xf9e))[_0x4e6e49(0xf12)]=_0x37d1bc[_0x4e6e49(0x108d)]||_0x4e6e49(0x12f9);const _0x5bed4e=document['getElementById']('rp-details-my-amount');_0x37d1bc[_0x4e6e49(0xb37)]&&_0x37d1bc[_0x4e6e49(0xb37)][_0x1f68a6]?(_0x5bed4e[_0x4e6e49(0xd16)](_0x4e6e49(0xd84))[_0x4e6e49(0xf12)]=_0x37d1bc[_0x4e6e49(0xb37)][_0x1f68a6]['toFixed'](0x2),_0x5bed4e[_0x4e6e49(0x68e)][_0x4e6e49(0x126b)]=_0x4e6e49(0x1118)):_0x5bed4e[_0x4e6e49(0x68e)][_0x4e6e49(0x126b)]=_0x4e6e49(0x10f2);const _0x52ef56=Object[_0x4e6e49(0xe9c)](_0x37d1bc[_0x4e6e49(0xb37)]||{})[_0x4e6e49(0x7aa)],_0x48105c=Object[_0x4e6e49(0x4b5)](_0x37d1bc[_0x4e6e49(0xb37)]||{})[_0x4e6e49(0x11e2)]((_0x289b19,_0x550b83)=>_0x289b19+_0x550b83,0x0);let _0x4dcc47=_0x52ef56+'/'+_0x37d1bc[_0x4e6e49(0x749)]+_0x4e6e49(0x103f)+_0x48105c['toFixed'](0x2)+'/'+_0x37d1bc[_0x4e6e49(0x33e)]['toFixed'](0x2)+'元。';if(!_0x37d1bc[_0x4e6e49(0x9aa)]&&_0x52ef56<_0x37d1bc[_0x4e6e49(0x749)]){const _0x4db916=Math[_0x4e6e49(0x128a)]((_0x37d1bc[_0x4e6e49(0x114e)]+0x18*0x3c*0x3c*0x3e8-Date[_0x4e6e49(0xf1a)]())/(0x3e8*0x3c*0x3c));if(_0x4db916>0x0)_0x4dcc47+=_0x4e6e49(0x402)+_0x4db916+'小时内退还。';}document[_0x4e6e49(0x89d)](_0x4e6e49(0xe45))[_0x4e6e49(0xf12)]=_0x4dcc47;const _0x19015a=document[_0x4e6e49(0x89d)](_0x4e6e49(0x1280));_0x19015a[_0x4e6e49(0x1ef)]='';const _0x37b821=Object['entries'](_0x37d1bc[_0x4e6e49(0xb37)]||{});let _0x17324={'name':'','amount':-0x1};_0x37d1bc['packetType']===_0x4e6e49(0x9a8)&&_0x37d1bc[_0x4e6e49(0x9aa)]&&_0x37b821[_0x4e6e49(0x7aa)]>0x1&&_0x37b821['forEach'](([_0x51bd6e,_0x568f71])=>{const _0x3b868b=_0x4e6e49;_0x568f71>_0x17324[_0x3b868b(0x10a6)]&&(_0x17324={'name':_0x51bd6e,'amount':_0x568f71});}),_0x37b821[_0x4e6e49(0x2e3)]((_0x3a153f,_0x81460)=>_0x81460[0x1]-_0x3a153f[0x1]),_0x37b821['forEach'](([_0x1628eb,_0x1e589e])=>{const _0x525666=_0x4e6e49,_0x2e9347=document[_0x525666(0x285)](_0x525666(0xb25));_0x2e9347['className']=_0x525666(0x287);let _0x155a5f='';_0x17324[_0x525666(0xf74)]&&_0x1628eb===_0x17324[_0x525666(0xf74)]&&(_0x155a5f=_0x525666(0x204));const _0x294c8b=_0xb9963e(_0x5c607e,_0x1628eb);_0x2e9347[_0x525666(0x1ef)]=_0x525666(0x759)+_0x294c8b+_0x525666(0x61c)+_0x1e589e[_0x525666(0x8f7)](0x2)+_0x525666(0x1159)+_0x155a5f+_0x525666(0x12b9),_0x19015a[_0x525666(0x22f)](_0x2e9347);}),_0xa210f5[_0x4e6e49(0x2f1)][_0x4e6e49(0x569)]('visible');}document[_0x41eae2(0x89d)](_0x41eae2(0x1126))[_0x41eae2(0x1193)](_0x41eae2(0x12a5),()=>{const _0x5a3d44=_0x41eae2;document[_0x5a3d44(0x89d)](_0x5a3d44(0x3a1))['classList'][_0x5a3d44(0x1247)]('visible');}),window[_0x41eae2(0x10ae)]=_0x3d2fbc;function _0x57e37d(){const _0x44a1a2=_0x41eae2,_0x2a69e4=document[_0x44a1a2(0x89d)]('create-poll-modal');document['getElementById']('poll-question-input')[_0x44a1a2(0x2f4)]='';const _0x368ee6=document[_0x44a1a2(0x89d)](_0x44a1a2(0x676));_0x368ee6[_0x44a1a2(0x1ef)]='',_0x1744ca(),_0x1744ca(),_0x2a69e4['classList'][_0x44a1a2(0x569)](_0x44a1a2(0x11e4));}function _0x1744ca(){const _0xe17d35=_0x41eae2,_0x271430=document[_0xe17d35(0x89d)](_0xe17d35(0x676)),_0x49f83e=document[_0xe17d35(0x285)](_0xe17d35(0xb25));_0x49f83e[_0xe17d35(0x81c)]='poll-option-input-wrapper',_0x49f83e[_0xe17d35(0x1ef)]=_0xe17d35(0x949),_0x49f83e[_0xe17d35(0xd16)]('.remove-option-btn')[_0xe17d35(0x1193)](_0xe17d35(0x12a5),()=>{const _0x510c5d=_0xe17d35;_0x271430[_0x510c5d(0xb97)][_0x510c5d(0x7aa)]>0x2?_0x49f83e['remove']():alert('投票至少需要2个选项。');}),_0x271430[_0xe17d35(0x22f)](_0x49f83e);}async function _0xa87e11(){const _0x2250e1=_0x41eae2;if(!_0x5b873d['activeChatId'])return;const _0x39d0de=document[_0x2250e1(0x89d)](_0x2250e1(0x1272))[_0x2250e1(0x2f4)][_0x2250e1(0xc3a)]();if(!_0x39d0de){alert(_0x2250e1(0xeab));return;}const _0x1da255=Array[_0x2250e1(0x321)](document[_0x2250e1(0x35f)]('.poll-option-input'))[_0x2250e1(0x412)](_0x7c6829=>_0x7c6829[_0x2250e1(0x2f4)][_0x2250e1(0xc3a)]())[_0x2250e1(0x3d8)](_0x30b6e0=>_0x30b6e0);if(_0x1da255[_0x2250e1(0x7aa)]<0x2){alert(_0x2250e1(0x1092));return;}const _0x19621e=_0x5b873d[_0x2250e1(0x667)][_0x5b873d[_0x2250e1(0xf96)]],_0x36fc74=_0x19621e[_0x2250e1(0x58c)]?_0x19621e[_0x2250e1(0xdb9)][_0x2250e1(0xc48)]||'我':'我',_0x1681ff={'role':_0x2250e1(0x116c),'senderName':_0x36fc74,'type':_0x2250e1(0xa9c),'timestamp':Date['now'](),'question':_0x39d0de,'options':_0x1da255,'votes':{},'isClosed':![]};_0x19621e[_0x2250e1(0x551)][_0x2250e1(0x138c)](_0x1681ff),await _0x1a6951[_0x2250e1(0x667)][_0x2250e1(0xc0f)](_0x19621e),_0x58deee(_0x1681ff,_0x19621e),_0x413d78(),document[_0x2250e1(0x89d)]('create-poll-modal')[_0x2250e1(0x2f1)][_0x2250e1(0x1247)](_0x2250e1(0x11e4));}async function _0x360cbe(_0x291a01,_0x3014f6){const _0x51fda2=_0x41eae2,_0x1b2434=_0x5b873d[_0x51fda2(0x667)][_0x5b873d[_0x51fda2(0xf96)]],_0x38b8c7=_0x1b2434[_0x51fda2(0x551)]['find'](_0x6dc62=>_0x6dc62[_0x51fda2(0x114e)]===_0x291a01),_0x74117=_0x1b2434['isGroup']?_0x1b2434[_0x51fda2(0xdb9)][_0x51fda2(0xc48)]||'我':'我';if(!_0x38b8c7||_0x38b8c7[_0x51fda2(0xd1e)]){_0x38b8c7&&_0x38b8c7[_0x51fda2(0xd1e)]&&_0x3f862b(_0x291a01);return;}const _0x293134=_0x38b8c7[_0x51fda2(0x10d1)][_0x3014f6]&&_0x38b8c7[_0x51fda2(0x10d1)][_0x3014f6][_0x51fda2(0xced)](_0x74117);if(!_0x293134){for(const _0x538933 in _0x38b8c7[_0x51fda2(0x10d1)]){const _0x18d75d=_0x38b8c7['votes'][_0x538933]['indexOf'](_0x74117);_0x18d75d>-0x1&&_0x38b8c7['votes'][_0x538933][_0x51fda2(0x776)](_0x18d75d,0x1);}!_0x38b8c7[_0x51fda2(0x10d1)][_0x3014f6]&&(_0x38b8c7['votes'][_0x3014f6]=[]),_0x38b8c7[_0x51fda2(0x10d1)][_0x3014f6]['push'](_0x74117);}let _0x476aaf=null;!_0x293134&&(_0x476aaf=_0x51fda2(0x1029)+_0x74117+_0x51fda2(0xa73)+_0x3014f6+_0x51fda2(0x3c0));if(_0x476aaf){const _0x4039ed={'role':_0x51fda2(0x18c),'content':_0x476aaf,'timestamp':Date[_0x51fda2(0xf1a)](),'isHidden':!![]};_0x1b2434[_0x51fda2(0x551)]['push'](_0x4039ed);}await _0x1a6951['chats'][_0x51fda2(0xc0f)](_0x1b2434),_0x5b89df(_0x5b873d[_0x51fda2(0xf96)]);}async function _0x5a32ad(_0x191daf){const _0x42fb0d=_0x41eae2,_0x4c74b5=_0x5b873d[_0x42fb0d(0x667)][_0x5b873d[_0x42fb0d(0xf96)]],_0x246aa8=_0x4c74b5['history'][_0x42fb0d(0x12f4)](_0x196ee=>_0x196ee[_0x42fb0d(0x114e)]===_0x191daf);if(!_0x246aa8||_0x246aa8[_0x42fb0d(0xd1e)])return;const _0x427392=await _0x4e2abc(_0x42fb0d(0x4c9),_0x42fb0d(0xe75));if(_0x427392){_0x246aa8[_0x42fb0d(0xd1e)]=!![];const _0x1aa95c=_0x246aa8[_0x42fb0d(0x1034)][_0x42fb0d(0x412)](_0x378332=>'“'+_0x378332+'”('+(_0x246aa8['votes'][_0x378332]?.[_0x42fb0d(0x7aa)]||0x0)+'票)')[_0x42fb0d(0x1237)]('，'),_0x3dfbf4=_0x42fb0d(0x790)+_0x1aa95c+'。]',_0x180af5={'role':_0x42fb0d(0x18c),'content':_0x3dfbf4,'timestamp':Date['now'](),'isHidden':!![]};_0x4c74b5['history'][_0x42fb0d(0x138c)](_0x180af5),await _0x1a6951[_0x42fb0d(0x667)]['put'](_0x4c74b5),_0x5b89df(_0x5b873d[_0x42fb0d(0xf96)]);}}function _0x3f862b(_0x3bfab0){const _0x16e2f2=_0x41eae2,_0x2fcdea=_0x5b873d[_0x16e2f2(0x667)][_0x5b873d[_0x16e2f2(0xf96)]],_0x122204=_0x2fcdea['history']['find'](_0x35d54e=>_0x35d54e[_0x16e2f2(0x114e)]===_0x3bfab0);if(!_0x122204||!_0x122204[_0x16e2f2(0xd1e)])return;let _0x41f390=_0x16e2f2(0x6e6)+_0x122204[_0x16e2f2(0xba1)]+_0x16e2f2(0x301);Object[_0x16e2f2(0xe9c)](_0x122204[_0x16e2f2(0x10d1)])[_0x16e2f2(0x7aa)]===0x0?_0x41f390+=_0x16e2f2(0x1363):_0x122204[_0x16e2f2(0x1034)][_0x16e2f2(0xd9a)](_0x3a21a5=>{const _0x211eff=_0x16e2f2,_0x534efb=_0x122204['votes'][_0x3a21a5]||[],_0xceb749=_0x534efb['map'](_0x1e2851=>_0xb9963e(_0x2fcdea,_0x1e2851))[_0x211eff(0x1237)]('、\x20');_0x41f390+=_0x211eff(0xb94)+_0x3a21a5+'\x20('+_0x534efb[_0x211eff(0x7aa)]+_0x211eff(0xecb)+(_0x534efb[_0x211eff(0x7aa)]>0x0?_0xceb749:_0x211eff(0x1fc))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x532f76(_0x16e2f2(0x5d5),_0x41f390);}function _0x20bcc0(){const _0x3fe15e=_0x41eae2;if(!_0x5b873d[_0x3fe15e(0xf96)])return;const _0x493e33=_0x5b873d[_0x3fe15e(0x667)][_0x5b873d[_0x3fe15e(0xf96)]];document[_0x3fe15e(0x89d)](_0x3fe15e(0xf5d))[_0x3fe15e(0xf12)]='“'+_0x493e33['name']+_0x3fe15e(0x12d4),_0x4b997a(),document[_0x3fe15e(0x89d)]('ai-avatar-library-modal')[_0x3fe15e(0x2f1)][_0x3fe15e(0x569)](_0x3fe15e(0x11e4));}function _0x4b997a(){const _0x9edddc=_0x41eae2,_0x73c168=document[_0x9edddc(0x89d)](_0x9edddc(0xcb7));_0x73c168[_0x9edddc(0x1ef)]='';const _0x1da212=_0x5b873d[_0x9edddc(0x667)][_0x5b873d[_0x9edddc(0xf96)]],_0x1bd883=_0x1da212['settings']['aiAvatarLibrary']||[];if(_0x1bd883['length']===0x0){_0x73c168[_0x9edddc(0x1ef)]=_0x9edddc(0x5db);return;}_0x1bd883[_0x9edddc(0xd9a)]((_0x13101a,_0x4fcfba)=>{const _0x791ca1=_0x9edddc,_0x28da95=document[_0x791ca1(0x285)](_0x791ca1(0xb25));_0x28da95['className']='sticker-item',_0x28da95[_0x791ca1(0x104c)]=_0x13101a['name'],_0x28da95['innerHTML']=_0x791ca1(0x8cb)+_0x13101a[_0x791ca1(0x11de)]+_0x791ca1(0x11d6)+_0x13101a[_0x791ca1(0xf74)]+_0x791ca1(0xf9a);const _0x3565e8=document[_0x791ca1(0x285)](_0x791ca1(0xb25));_0x3565e8[_0x791ca1(0x81c)]=_0x791ca1(0x670),_0x3565e8[_0x791ca1(0x1ef)]='×',_0x3565e8['style']['display']=_0x791ca1(0x1118),_0x3565e8['onclick']=async _0x197b06=>{const _0x1730cd=_0x791ca1;_0x197b06['stopPropagation']();const _0x4c947b=await _0x4e2abc(_0x1730cd(0x9d1),_0x1730cd(0x12d6)+_0x13101a[_0x1730cd(0xf74)]+_0x1730cd(0x48e),{'confirmButtonClass':_0x1730cd(0xcd8)});_0x4c947b&&(_0x1da212[_0x1730cd(0xdb9)][_0x1730cd(0x614)][_0x1730cd(0x776)](_0x4fcfba,0x1),await _0x1a6951[_0x1730cd(0x667)][_0x1730cd(0xc0f)](_0x1da212),_0x4b997a());},_0x28da95[_0x791ca1(0x22f)](_0x3565e8),_0x73c168[_0x791ca1(0x22f)](_0x28da95);});}async function _0xf65337(){const _0x125d78=_0x41eae2,_0x2e7920=await _0x34d246(_0x125d78(0xa2b),_0x125d78(0xd0e));if(!_0x2e7920||!_0x2e7920[_0x125d78(0xc3a)]())return;const _0xf9f2de=await _0x34d246(_0x125d78(0xa2b),_0x125d78(0x871),'',_0x125d78(0x11de));if(!_0xf9f2de||!_0xf9f2de[_0x125d78(0xc3a)]()[_0x125d78(0x1222)](_0x125d78(0x1005))){alert(_0x125d78(0xf82));return;}const _0x4918db=_0x5b873d[_0x125d78(0x667)][_0x5b873d[_0x125d78(0xf96)]];!_0x4918db[_0x125d78(0xdb9)][_0x125d78(0x614)]&&(_0x4918db[_0x125d78(0xdb9)]['aiAvatarLibrary']=[]),_0x4918db['settings'][_0x125d78(0x614)]['push']({'name':_0x2e7920[_0x125d78(0xc3a)](),'url':_0xf9f2de[_0x125d78(0xc3a)]()}),await _0x1a6951['chats'][_0x125d78(0xc0f)](_0x4918db),_0x4b997a();}function _0xba1279(){const _0x3a9249=_0x41eae2;document['getElementById'](_0x3a9249(0xcdc))['classList'][_0x3a9249(0x1247)]('visible');}function _0x46ebd3(){const _0x528bdc=_0x41eae2;if(!_0x5b873d[_0x528bdc(0xf96)])return;const _0x278ce7=_0x5b873d['chats'][_0x5b873d[_0x528bdc(0xf96)]];document[_0x528bdc(0x89d)](_0x528bdc(0x720))[_0x528bdc(0xf12)]='“'+(_0x278ce7[_0x528bdc(0xdb9)][_0x528bdc(0xc48)]||'我')+_0x528bdc(0x12d4),_0x5bcf6c(),document[_0x528bdc(0x89d)](_0x528bdc(0x487))[_0x528bdc(0x2f1)][_0x528bdc(0x569)](_0x528bdc(0x11e4));}function _0x5bcf6c(){const _0x1aa273=_0x41eae2,_0xba1940=document[_0x1aa273(0x89d)](_0x1aa273(0x101e));_0xba1940['innerHTML']='';const _0x5c7066=_0x5b873d[_0x1aa273(0x667)][_0x5b873d[_0x1aa273(0xf96)]],_0x56d08f=_0x5c7066[_0x1aa273(0xdb9)][_0x1aa273(0xe13)]||[];if(_0x56d08f[_0x1aa273(0x7aa)]===0x0){_0xba1940[_0x1aa273(0x1ef)]='<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>';return;}_0x56d08f[_0x1aa273(0xd9a)]((_0x5911c4,_0x813b15)=>{const _0x9700e5=_0x1aa273,_0x20bf41=document[_0x9700e5(0x285)](_0x9700e5(0xb25));_0x20bf41[_0x9700e5(0x81c)]=_0x9700e5(0x2e8),_0x20bf41[_0x9700e5(0x104c)]=_0x5911c4[_0x9700e5(0xf74)],_0x20bf41[_0x9700e5(0x1ef)]=_0x9700e5(0x8cb)+_0x5911c4['url']+_0x9700e5(0x11d6)+_0x5911c4['name']+_0x9700e5(0xf9a);const _0xec168=document[_0x9700e5(0x285)](_0x9700e5(0xb25));_0xec168['className']=_0x9700e5(0x670),_0xec168[_0x9700e5(0x1ef)]='×',_0xec168[_0x9700e5(0x68e)][_0x9700e5(0x126b)]=_0x9700e5(0x1118),_0xec168[_0x9700e5(0x108b)]=async _0x339111=>{const _0x28531c=_0x9700e5;_0x339111[_0x28531c(0x1088)]();const _0x1e539d=await _0x4e2abc(_0x28531c(0x9d1),'确定要从你的头像库中删除“'+_0x5911c4['name']+_0x28531c(0x48e),{'confirmButtonClass':'btn-danger'});_0x1e539d&&(_0x5c7066[_0x28531c(0xdb9)][_0x28531c(0xe13)][_0x28531c(0x776)](_0x813b15,0x1),await _0x1a6951[_0x28531c(0x667)][_0x28531c(0xc0f)](_0x5c7066),_0x5bcf6c());},_0x20bf41['appendChild'](_0xec168),_0xba1940['appendChild'](_0x20bf41);});}async function _0x5eb1e5(){const _0xa54187=_0x41eae2,_0x490492=await _0x34d246(_0xa54187(0xa2b),_0xa54187(0xd0e));if(!_0x490492||!_0x490492['trim']())return;const _0xadc82f=await _0x34d246(_0xa54187(0xa2b),'请输入头像的图片URL','',_0xa54187(0x11de));if(!_0xadc82f||!_0xadc82f[_0xa54187(0xc3a)]()[_0xa54187(0x1222)](_0xa54187(0x1005))){alert('请输入有效的图片URL！');return;}const _0x118ded=_0x5b873d[_0xa54187(0x667)][_0x5b873d[_0xa54187(0xf96)]];!_0x118ded[_0xa54187(0xdb9)][_0xa54187(0xe13)]&&(_0x118ded[_0xa54187(0xdb9)][_0xa54187(0xe13)]=[]),_0x118ded[_0xa54187(0xdb9)][_0xa54187(0xe13)][_0xa54187(0x138c)]({'name':_0x490492['trim'](),'url':_0xadc82f[_0xa54187(0xc3a)]()}),await _0x1a6951[_0xa54187(0x667)]['put'](_0x118ded),_0x5bcf6c();}async function _0x137803(_0x5eaed7){const _0x5e58a8=_0x41eae2,_0x4afd3a=_0x5eaed7[_0x5e58a8(0x225)]['files'][0x0];if(!_0x4afd3a)return;const _0x5bca79=await new Promise(_0x55dbaf=>{const _0x160813=_0x5e58a8,_0x36cc1b=new FileReader();_0x36cc1b[_0x160813(0x736)]=()=>_0x55dbaf(_0x36cc1b[_0x160813(0x9dc)]),_0x36cc1b[_0x160813(0x5b4)](_0x4afd3a);}),_0x4d0497=await _0x34d246('命名头像',_0x5e58a8(0x103b));if(!_0x4d0497||!_0x4d0497['trim']())return;const _0x44b0de=_0x5b873d[_0x5e58a8(0x667)][_0x5b873d['activeChatId']];!_0x44b0de['settings'][_0x5e58a8(0xe13)]&&(_0x44b0de[_0x5e58a8(0xdb9)][_0x5e58a8(0xe13)]=[]),_0x44b0de['settings'][_0x5e58a8(0xe13)][_0x5e58a8(0x138c)]({'name':_0x4d0497[_0x5e58a8(0xc3a)](),'url':_0x5bca79}),await _0x1a6951[_0x5e58a8(0x667)][_0x5e58a8(0xc0f)](_0x44b0de),_0x5bcf6c(),_0x5eaed7['target'][_0x5e58a8(0x2f4)]=null;}async function _0x3294ef(_0x530a2c){const _0x1271ae=_0x41eae2,_0x235f78=_0x5b873d['chats'][_0x5b873d[_0x1271ae(0xf96)]];if(!_0x235f78)return;const _0x71d90=_0x530a2c[_0x1271ae(0xc3a)]()[_0x1271ae(0x55b)]('\x0a'),_0x276ddd=[],_0x18dbe4='https://files.catbox.moe/';let _0x185b86=0x0;for(const _0x3be7be of _0x71d90){const _0x4c9420=_0x3be7be[_0x1271ae(0xc3a)]();if(!_0x4c9420||_0x4c9420[_0x1271ae(0xced)](_0x1271ae(0x1005))||_0x4c9420['includes']('填入'))continue;let _0xa7d6e0=null,_0x11d42b=null;const _0x13b25c=_0x4c9420[_0x1271ae(0x86c)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x13b25c)_0xa7d6e0=_0x13b25c[0x1],_0x11d42b=_0x13b25c[0x2];else{const _0xb64d71=_0x4c9420[_0x1271ae(0x55b)](/\s+/);_0xb64d71['length']>=0x2&&(_0x11d42b=_0xb64d71[_0x1271ae(0x114b)](),_0xa7d6e0=_0xb64d71[_0x1271ae(0x1237)]('\x20'));}_0xa7d6e0&&_0x11d42b&&_0x11d42b['includes']('.')?_0x276ddd[_0x1271ae(0x138c)]({'name':_0xa7d6e0,'url':_0x18dbe4+_0x11d42b}):_0x185b86++;}if(_0x185b86>0x0)await _0x532f76(_0x1271ae(0x687),'有\x20'+_0x185b86+_0x1271ae(0x228));if(_0x276ddd[_0x1271ae(0x7aa)]>0x0){if(!_0x235f78[_0x1271ae(0xdb9)][_0x1271ae(0xe13)])_0x235f78['settings'][_0x1271ae(0xe13)]=[];_0x235f78[_0x1271ae(0xdb9)][_0x1271ae(0xe13)][_0x1271ae(0x138c)](..._0x276ddd),await _0x1a6951[_0x1271ae(0x667)][_0x1271ae(0xc0f)](_0x235f78),_0x5bcf6c(),await _0x532f76(_0x1271ae(0x1145),_0x1271ae(0x4e7)+_0x276ddd[_0x1271ae(0x7aa)]+'\x20个新头像！');}else _0x185b86===0x0&&alert('没有找到可导入的内容。');}function _0x18627c(){const _0x5cd9ad=_0x41eae2;document['getElementById'](_0x5cd9ad(0x487))[_0x5cd9ad(0x2f1)][_0x5cd9ad(0x1247)](_0x5cd9ad(0x11e4));}function _0x317636(){const _0x3d188f=_0x41eae2;if(!_0x5b873d[_0x3d188f(0xf96)])return;const _0x4c75bb=_0x5b873d['chats'][_0x5b873d[_0x3d188f(0xf96)]];document[_0x3d188f(0x89d)](_0x3d188f(0xc8e))[_0x3d188f(0xf12)]='“'+_0x4c75bb[_0x3d188f(0xf74)]+_0x3d188f(0x12d4),_0x5c4e69(),document[_0x3d188f(0x89d)](_0x3d188f(0xbeb))[_0x3d188f(0x2f1)][_0x3d188f(0x569)](_0x3d188f(0x11e4));}function _0x5c4e69(){const _0x3ed510=_0x41eae2,_0x3f71e1=document['getElementById'](_0x3ed510(0xbf1));_0x3f71e1[_0x3ed510(0x1ef)]='';const _0x1b2f27=_0x5b873d['chats'][_0x5b873d[_0x3ed510(0xf96)]],_0x5ab60b=_0x1b2f27[_0x3ed510(0xdb9)]['groupAvatarLibrary']||[];if(_0x5ab60b[_0x3ed510(0x7aa)]===0x0){_0x3f71e1[_0x3ed510(0x1ef)]=_0x3ed510(0x5db);return;}_0x5ab60b['forEach']((_0x24654d,_0x3464ee)=>{const _0x30e6f8=_0x3ed510,_0x167544=document[_0x30e6f8(0x285)](_0x30e6f8(0xb25));_0x167544[_0x30e6f8(0x81c)]=_0x30e6f8(0x2e8),_0x167544['title']=_0x24654d['name'],_0x167544['innerHTML']=_0x30e6f8(0x8cb)+_0x24654d[_0x30e6f8(0x11de)]+_0x30e6f8(0x11d6)+_0x24654d[_0x30e6f8(0xf74)]+_0x30e6f8(0xf9a);const _0x1a3fa6=document[_0x30e6f8(0x285)]('div');_0x1a3fa6[_0x30e6f8(0x81c)]=_0x30e6f8(0x670),_0x1a3fa6['innerHTML']='×',_0x1a3fa6[_0x30e6f8(0x68e)]['display']=_0x30e6f8(0x1118),_0x1a3fa6[_0x30e6f8(0x108b)]=async _0x2242f4=>{const _0x198e26=_0x30e6f8;_0x2242f4[_0x198e26(0x1088)]();const _0x549a2e=await _0x4e2abc('删除头像',_0x198e26(0x12d6)+_0x24654d[_0x198e26(0xf74)]+_0x198e26(0x48e),{'confirmButtonClass':_0x198e26(0xcd8)});_0x549a2e&&(_0x1b2f27[_0x198e26(0xdb9)]['groupAvatarLibrary']['splice'](_0x3464ee,0x1),await _0x1a6951[_0x198e26(0x667)][_0x198e26(0xc0f)](_0x1b2f27),_0x5c4e69());},_0x167544[_0x30e6f8(0x22f)](_0x1a3fa6),_0x3f71e1[_0x30e6f8(0x22f)](_0x167544);});}async function _0x4d1223(){const _0x5666bd=_0x41eae2,_0x4f7dc3=await _0x34d246(_0x5666bd(0xa2b),_0x5666bd(0x1100));if(!_0x4f7dc3||!_0x4f7dc3['trim']())return;const _0x12f0dd=await _0x34d246(_0x5666bd(0xa2b),_0x5666bd(0x871),'',_0x5666bd(0x11de));if(!_0x12f0dd||!_0x12f0dd[_0x5666bd(0xc3a)]()[_0x5666bd(0x1222)](_0x5666bd(0x1005))){alert(_0x5666bd(0xf82));return;}const _0x8601ff=_0x5b873d[_0x5666bd(0x667)][_0x5b873d['activeChatId']];!_0x8601ff[_0x5666bd(0xdb9)]['groupAvatarLibrary']&&(_0x8601ff[_0x5666bd(0xdb9)][_0x5666bd(0x1e2)]=[]),_0x8601ff['settings'][_0x5666bd(0x1e2)][_0x5666bd(0x138c)]({'name':_0x4f7dc3[_0x5666bd(0xc3a)](),'url':_0x12f0dd['trim']()}),await _0x1a6951[_0x5666bd(0x667)][_0x5666bd(0xc0f)](_0x8601ff),_0x5c4e69();}function _0x4eff60(){const _0x44092b=_0x41eae2;document[_0x44092b(0x89d)]('group-avatar-library-modal')[_0x44092b(0x2f1)][_0x44092b(0x1247)](_0x44092b(0x11e4));}async function _0x1ef92f(_0x178839){const _0x2e7361=_0x41eae2,_0x561736=_0x2e7361(0x92e),_0x19926c=await _0x34d246(_0x2e7361(0x11ba),_0x561736,'',_0x2e7361(0x11b9));_0x19926c&&_0x19926c[_0x2e7361(0xc3a)]()&&await _0x1211dd(_0x178839,_0x19926c);}async function _0x1211dd(_0x4cf06c,_0x4ee721){const _0x1d57af=_0x41eae2,_0x4c21e9=_0x5b873d['chats'][_0x5b873d[_0x1d57af(0xf96)]];if(!_0x4c21e9)return;const _0x3509b4=_0x4ee721['trim']()[_0x1d57af(0x55b)]('\x0a'),_0x4106e0=[],_0x90e9f2='https://files.catbox.moe/';let _0x46867c=0x0;for(const _0x36b268 of _0x3509b4){const _0x48dd38=_0x36b268['trim']();if(!_0x48dd38||_0x48dd38['includes'](_0x1d57af(0x1005))||_0x48dd38[_0x1d57af(0xced)]('填入'))continue;let _0x31cc01=null,_0x5eac15=null;const _0x1a4cbc=_0x48dd38[_0x1d57af(0x86c)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x1a4cbc)_0x31cc01=_0x1a4cbc[0x1],_0x5eac15=_0x1a4cbc[0x2];else{const _0x176418=_0x48dd38[_0x1d57af(0x55b)](/\s+/);_0x176418[_0x1d57af(0x7aa)]>=0x2&&(_0x5eac15=_0x176418[_0x1d57af(0x114b)](),_0x31cc01=_0x176418[_0x1d57af(0x1237)]('\x20'));}_0x31cc01&&_0x5eac15&&_0x5eac15[_0x1d57af(0xced)]('.')?_0x4106e0[_0x1d57af(0x138c)]({'name':_0x31cc01,'url':_0x90e9f2+_0x5eac15}):(_0x46867c++,console[_0x1d57af(0xac3)]('批量导入格式错误，已跳过此行:',_0x48dd38));}_0x46867c>0x0&&await _0x532f76('部分导入失败','有\x20'+_0x46867c+_0x1d57af(0x75c));if(_0x4106e0[_0x1d57af(0x7aa)]>0x0){if(_0x4cf06c==='ai'){if(!_0x4c21e9[_0x1d57af(0xdb9)]['aiAvatarLibrary'])_0x4c21e9[_0x1d57af(0xdb9)][_0x1d57af(0x614)]=[];_0x4c21e9[_0x1d57af(0xdb9)][_0x1d57af(0x614)][_0x1d57af(0x138c)](..._0x4106e0),await _0x1a6951[_0x1d57af(0x667)][_0x1d57af(0xc0f)](_0x4c21e9),_0x4b997a();}else{if(_0x4cf06c===_0x1d57af(0x39f)){if(!_0x4c21e9[_0x1d57af(0xdb9)][_0x1d57af(0x1e2)])_0x4c21e9[_0x1d57af(0xdb9)][_0x1d57af(0x1e2)]=[];_0x4c21e9[_0x1d57af(0xdb9)][_0x1d57af(0x1e2)][_0x1d57af(0x138c)](..._0x4106e0),await _0x1a6951[_0x1d57af(0x667)]['put'](_0x4c21e9),_0x5c4e69();}}await _0x532f76(_0x1d57af(0x1145),_0x1d57af(0x4e7)+_0x4106e0['length']+_0x1d57af(0x608));}else _0x46867c===0x0&&alert('没有找到可导入的内容。请检查您粘贴的格式是否正确。');}async function _0x4fda4a(){const _0x370308=_0x41eae2,_0x1520e6=await _0x34d246('添加头像',_0x370308(0x1100));if(!_0x1520e6||!_0x1520e6['trim']())return;const _0x23bf80=await _0x34d246(_0x370308(0xa2b),_0x370308(0x871),'','url');if(!_0x23bf80||!_0x23bf80[_0x370308(0xc3a)]()['startsWith'](_0x370308(0x1005))){alert(_0x370308(0xf82));return;}const _0x3548d2=_0x5b873d[_0x370308(0x667)][_0x5b873d[_0x370308(0xf96)]];!_0x3548d2[_0x370308(0xdb9)][_0x370308(0x1e2)]&&(_0x3548d2[_0x370308(0xdb9)][_0x370308(0x1e2)]=[]),_0x3548d2[_0x370308(0xdb9)][_0x370308(0x1e2)][_0x370308(0x138c)]({'name':_0x1520e6[_0x370308(0xc3a)](),'url':_0x23bf80[_0x370308(0xc3a)]()}),await _0x1a6951['chats']['put'](_0x3548d2),_0x5c4e69();}function _0x4f29ea(_0x3c75bb){return new Promise(_0x32d460=>{const _0x541752=_0x356e,_0x4370bd=document[_0x541752(0x89d)]('chat-list-actions-modal'),_0x3002bd=document[_0x541752(0x89d)](_0x541752(0x121f)),_0x3d7a94=document[_0x541752(0x89d)](_0x541752(0x102f)),_0x62cbb9=document[_0x541752(0x89d)](_0x541752(0x9af));_0x3002bd[_0x541752(0xf12)]=_0x3c75bb[_0x541752(0x199)]?_0x541752(0xf93):'置顶聊天';const _0x56ca8d=_0x3002bd['cloneNode'](!![]);_0x3002bd[_0x541752(0xb6e)][_0x541752(0xd38)](_0x56ca8d,_0x3002bd),_0x56ca8d['onclick']=()=>{const _0x56d3c8=_0x541752;_0x4370bd[_0x56d3c8(0x2f1)][_0x56d3c8(0x1247)](_0x56d3c8(0x11e4)),_0x32d460('pin');};const _0x12183c=_0x3d7a94[_0x541752(0xf2a)](!![]);_0x3d7a94[_0x541752(0xb6e)][_0x541752(0xd38)](_0x12183c,_0x3d7a94),_0x12183c[_0x541752(0x108b)]=()=>{const _0x312de7=_0x541752;_0x4370bd[_0x312de7(0x2f1)][_0x312de7(0x1247)](_0x312de7(0x11e4)),_0x32d460('delete');};const _0x55854a=_0x62cbb9[_0x541752(0xf2a)](!![]);_0x62cbb9[_0x541752(0xb6e)][_0x541752(0xd38)](_0x55854a,_0x62cbb9),_0x55854a[_0x541752(0x108b)]=()=>{const _0x4d3ccd=_0x541752;_0x4370bd[_0x4d3ccd(0x2f1)][_0x4d3ccd(0x1247)](_0x4d3ccd(0x11e4)),_0x32d460(null);},_0x4370bd[_0x541752(0x2f1)][_0x541752(0x569)](_0x541752(0x11e4));});}function _0x35a5b0(){const _0x441993=_0x41eae2,_0x42c430=document[_0x441993(0x89d)](_0x441993(0xed7)),_0x468c45=_0x5b873d[_0x441993(0x21a)][_0x441993(0x5fa)];_0x468c45?_0x42c430[_0x441993(0x68e)][_0x441993(0x1d4)]='url('+_0x468c45+')':_0x42c430[_0x441993(0x68e)][_0x441993(0x1d4)]=_0x441993(0x1335);}function _0x3a9268(){const _0x540955=_0x41eae2;if(!_0x5b873d[_0x540955(0x21a)][_0x540955(0xf1e)])return;for(const _0x5a2a52 in _0x5b873d[_0x540955(0x21a)][_0x540955(0xf1e)]){const _0xdc1ab7=document[_0x540955(0x89d)](_0x540955(0x6f4)+_0x5a2a52);_0xdc1ab7&&(_0xdc1ab7[_0x540955(0x9e3)]=_0x5b873d['globalSettings']['cphoneAppIcons'][_0x5a2a52]);}}function _0x5e86ec(){const _0x9afd95=_0x41eae2,_0x32e692=document['getElementById'](_0x9afd95(0x12a6));if(!_0x32e692)return;_0x32e692[_0x9afd95(0x1ef)]='';const _0x37cd92={'qq':'QQ','album':'相册','browser':_0x9afd95(0xac0),'taobao':'淘宝','memo':_0x9afd95(0x1142),'diary':'日记','amap':_0x9afd95(0x68a),'usage':_0x9afd95(0x25c),'music':_0x9afd95(0x607),'ephone':'Ephone'};for(const _0x1043e2 in _0x5b873d[_0x9afd95(0x21a)][_0x9afd95(0xf1e)]){const _0x417445=_0x5b873d['globalSettings']['cphoneAppIcons'][_0x1043e2],_0x5e82cd=_0x37cd92[_0x1043e2]||_0x9afd95(0xb63),_0x1df55b=document[_0x9afd95(0x285)](_0x9afd95(0xb25));_0x1df55b[_0x9afd95(0x81c)]=_0x9afd95(0x2f5),_0x1df55b['dataset'][_0x9afd95(0x1d9)]=_0x1043e2,_0x1df55b[_0x9afd95(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22'+_0x417445+_0x9afd95(0xee0)+_0x5e82cd+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x32e692[_0x9afd95(0x22f)](_0x1df55b);}}function _0x337978(){const _0x17bae2=_0x41eae2;if(!_0x5b873d[_0x17bae2(0x21a)][_0x17bae2(0x361)])return;for(const _0x59af65 in _0x5b873d[_0x17bae2(0x21a)][_0x17bae2(0x361)]){const _0x500c0b=document['getElementById']('icon-img-'+_0x59af65);_0x500c0b&&(_0x500c0b[_0x17bae2(0x9e3)]=_0x5b873d['globalSettings'][_0x17bae2(0x361)][_0x59af65]);}}function _0x1edc49(){const _0x49a344=_0x41eae2,_0x34ae2c=document[_0x49a344(0x89d)](_0x49a344(0xd89));if(!_0x34ae2c)return;_0x34ae2c['innerHTML']='';const _0x51c8da={'qq':'QQ','world-book':_0x49a344(0xb8d),'wallpaper':_0x49a344(0x482),'renderer':_0x49a344(0x8a5),'api-settings':_0x49a344(0x6d6),'font':'字体','char-phone':_0x49a344(0x62d),'douban':_0x49a344(0xff7),'preset':'预设','tutorial':'教程','werewolf':'狼人杀','x':'X'};for(const _0x1aacc6 in _0x5b873d[_0x49a344(0x21a)]['appIcons']){const _0x50ae49=_0x5b873d[_0x49a344(0x21a)][_0x49a344(0x361)][_0x1aacc6],_0x2cb716=_0x51c8da[_0x1aacc6]||_0x49a344(0x62d),_0x2e9028=document[_0x49a344(0x285)]('div');_0x2e9028[_0x49a344(0x81c)]=_0x49a344(0x2f5),_0x2e9028['dataset'][_0x49a344(0x1d9)]=_0x1aacc6,_0x2e9028['innerHTML']=_0x49a344(0xfd8)+_0x50ae49+_0x49a344(0xee0)+_0x2cb716+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x34ae2c['appendChild'](_0x2e9028);}}function _0x16e66e(_0x204a49){const _0x44e583=_0x41eae2;if(!_0x5b873d[_0x44e583(0xf96)])return;const _0x1b3353=_0x5b873d[_0x44e583(0x667)][_0x5b873d['activeChatId']];if(!_0x1b3353||!_0x1b3353[_0x44e583(0x551)])return;const _0x5bea07=_0x1b3353[_0x44e583(0x551)]['find'](_0x50a4db=>_0x50a4db[_0x44e583(0x114e)]===_0x204a49);if(!_0x5bea07||_0x5bea07[_0x44e583(0x48c)]!=='share_link'){console[_0x44e583(0x1fd)](_0x44e583(0xe03),_0x204a49);return;}document[_0x44e583(0x89d)](_0x44e583(0x603))['textContent']=_0x5bea07[_0x44e583(0x573)]||_0x44e583(0x38d);const _0x3d03af=document[_0x44e583(0x89d)]('browser-content');_0x3d03af[_0x44e583(0x1ef)]=_0x44e583(0xd00)+(_0x5bea07[_0x44e583(0x104c)]||'无标题')+_0x44e583(0xb61)+(_0x5bea07[_0x44e583(0x573)]||'未知')+_0x44e583(0x5d0)+(_0x5bea07[_0x44e583(0x28c)]||_0x44e583(0x326))['replace'](/\n/g,_0x44e583(0x209))+_0x44e583(0xdff),_0x4e6c15(_0x44e583(0x1121));}function _0x29b7af(){const _0x1bbce1=_0x41eae2;_0x4e6c15(_0x1bbce1(0x87f));}function _0x29b7af(){_0x4e6c15('chat-interface-screen');}function _0x463ec2(){const _0x146449=_0x41eae2;if(!_0x5b873d[_0x146449(0xf96)])return;document[_0x146449(0x89d)](_0x146449(0xd2a))[_0x146449(0x2f4)]='',document['getElementById']('link-description-input')['value']='',document[_0x146449(0x89d)](_0x146449(0x954))[_0x146449(0x2f4)]='',document[_0x146449(0x89d)]('link-content-input')['value']='',document['getElementById'](_0x146449(0x431))['classList'][_0x146449(0x569)]('visible');}async function _0x939b11(){const _0x14d6a6=_0x41eae2;if(!_0x5b873d['activeChatId'])return;const _0x41ac24=document[_0x14d6a6(0x89d)](_0x14d6a6(0xd2a))[_0x14d6a6(0x2f4)][_0x14d6a6(0xc3a)]();if(!_0x41ac24){alert('标题是必填项哦！');return;}const _0x199190=document[_0x14d6a6(0x89d)]('link-description-input')[_0x14d6a6(0x2f4)][_0x14d6a6(0xc3a)](),_0x4c35fa=document[_0x14d6a6(0x89d)](_0x14d6a6(0x954))[_0x14d6a6(0x2f4)][_0x14d6a6(0xc3a)](),_0x5ef6cb=document['getElementById']('link-content-input')['value'][_0x14d6a6(0xc3a)](),_0x10d8a7=_0x5b873d[_0x14d6a6(0x667)][_0x5b873d[_0x14d6a6(0xf96)]],_0x349a64={'role':'user','type':'share_link','timestamp':Date[_0x14d6a6(0xf1a)](),'title':_0x41ac24,'description':_0x199190,'source_name':_0x4c35fa,'content':_0x5ef6cb,'thumbnail_url':null};_0x10d8a7[_0x14d6a6(0x551)][_0x14d6a6(0x138c)](_0x349a64),await _0x1a6951['chats'][_0x14d6a6(0xc0f)](_0x10d8a7),_0x58deee(_0x349a64,_0x10d8a7),_0x413d78(),document[_0x14d6a6(0x89d)](_0x14d6a6(0x431))['classList']['remove']('visible');}function _0x4a3d6c(_0x1d88b0,_0xcaa59b){const _0x592c74=_0x41eae2;if(!_0xcaa59b||!_0xcaa59b['id'])return[];const _0x5bfbe0=_0xcaa59b[_0x592c74(0xb54)],_0x127888=_0xcaa59b['id'];return _0x1d88b0[_0x592c74(0x3d8)](_0x19c0db=>{const _0xd89619=_0x592c74;if(_0x19c0db[_0xd89619(0xc3f)]===_0xd89619(0x116c)){if(_0x19c0db['visibleGroupIds']&&_0x19c0db[_0xd89619(0x1166)][_0xd89619(0x7aa)]>0x0)return _0x5bfbe0&&_0x19c0db['visibleGroupIds']['includes'](_0x5bfbe0);return!![];}if(String(_0x19c0db[_0xd89619(0xc3f)])[_0xd89619(0x1222)](_0xd89619(0x5b8))){if(Array['isArray'](_0x19c0db[_0xd89619(0x79d)]))return _0x19c0db['visibleTo'][_0xd89619(0xced)](_0x127888);return![];}const _0x343100=_0x5b873d[_0xd89619(0x667)][_0x19c0db[_0xd89619(0xc3f)]];if(!_0x343100)return![];const _0xd3ad=_0x343100[_0xd89619(0xb54)],_0x3bdb50=_0xd3ad&&_0x5bfbe0&&_0xd3ad===_0x5bfbe0,_0x344529=!_0xd3ad&&!_0x5bfbe0;return _0x3bdb50||_0x344529;});}function _0x2bb324(_0x12a30a){const _0x33837f=_0x41eae2,_0x493a2=document[_0x33837f(0x89d)](_0x33837f(0x34e)),_0x293668=document[_0x33837f(0x89d)](_0x33837f(0xa34)),_0x413822=_0x12a30a===_0x33837f(0x9d6);_0x493a2['classList'][_0x33837f(0x73b)](_0x33837f(0xd8e),_0x413822),_0x293668&&(_0x293668['checked']=_0x413822),localStorage[_0x33837f(0x85d)](_0x33837f(0xbe6),_0x12a30a);}function _0x4a76dc(){const _0x4e09f6=_0x41eae2,_0x555da0=document['getElementById']('theme-toggle-switch'),_0x791ad0=_0x555da0[_0x4e09f6(0x1b0)]?_0x4e09f6(0x9d6):_0x4e09f6(0x5b7);_0x2bb324(_0x791ad0);}function _0x10e170(){const _0x402b25=_0x41eae2;if(!_0x5b873d[_0x402b25(0xf96)])return;_0x531379(),_0x4e6c15('long-term-memory-screen');}function _0x531379(){const _0x1e8577=_0x41eae2,_0x59e136=document[_0x1e8577(0x89d)](_0x1e8577(0x60d)),_0x411a60=_0x5b873d[_0x1e8577(0x667)][_0x5b873d[_0x1e8577(0xf96)]];_0x59e136[_0x1e8577(0x1ef)]='';let _0x522a00=[];_0x411a60[_0x1e8577(0x58c)]?_0x411a60[_0x1e8577(0x5ab)][_0x1e8577(0xd9a)](_0x45dbd7=>{const _0x3c2efa=_0x1e8577,_0x439987=_0x5b873d[_0x3c2efa(0x667)][_0x45dbd7['id']];if(_0x439987&&_0x439987[_0x3c2efa(0xc18)]){const _0x3fa836=_0x439987[_0x3c2efa(0xc18)][_0x3c2efa(0x412)](_0x454e99=>({..._0x454e99,'authorName':_0x45dbd7['groupNickname'],'authorChatId':_0x45dbd7['id']}));_0x522a00[_0x3c2efa(0x138c)](..._0x3fa836);}}):_0x411a60[_0x1e8577(0xc18)]&&(_0x522a00=_0x411a60[_0x1e8577(0xc18)]['map'](_0x4ea12d=>({..._0x4ea12d,'authorName':_0x411a60[_0x1e8577(0xf74)],'authorChatId':_0x411a60['id']})));if(_0x522a00[_0x1e8577(0x7aa)]===0x0){_0x59e136[_0x1e8577(0x1ef)]=_0x1e8577(0xc34);return;}_0x522a00[_0x1e8577(0x2e3)]((_0x584959,_0x4fd5e6)=>_0x4fd5e6[_0x1e8577(0x114e)]-_0x584959[_0x1e8577(0x114e)]),_0x522a00[_0x1e8577(0xd9a)]((_0x13174a,_0x2c141d)=>{const _0x3ba989=_0x1e8577,_0x3e494f=document[_0x3ba989(0x285)]('div');_0x3e494f[_0x3ba989(0x81c)]=_0x3ba989(0x2bd),_0x3e494f['style']['cursor']=_0x3ba989(0xfb4),_0x3e494f[_0x3ba989(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20'+_0x13174a[_0x3ba989(0xa59)]+_0x3ba989(0x7c2)+_0x13174a[_0x3ba989(0x28c)][_0x3ba989(0xfbf)](/\n/g,_0x3ba989(0x962))+_0x3ba989(0x10e5)+_0x13174a['authorChatId']+'\x22\x20data-memory-timestamp=\x22'+_0x13174a[_0x3ba989(0x114e)]+_0x3ba989(0xf8f)+_0x13174a[_0x3ba989(0x220)]+_0x3ba989(0xa1f)+_0x13174a[_0x3ba989(0x114e)]+_0x3ba989(0xa98),_0x59e136[_0x3ba989(0x22f)](_0x3e494f);});}async function _0x2a9872(){const _0x22a5bd=_0x41eae2,_0x78baf=_0x5b873d[_0x22a5bd(0x667)][_0x5b873d[_0x22a5bd(0xf96)]];if(!_0x78baf)return;let _0x4cdc48=_0x78baf;if(_0x78baf[_0x22a5bd(0x58c)]){const _0xad8e56=_0x78baf[_0x22a5bd(0x5ab)][_0x22a5bd(0x412)](_0x257325=>({'text':'为“'+_0x257325[_0x22a5bd(0x7da)]+'”添加记忆','value':_0x257325['id']})),_0xebc1cb=await _0x4d923b(_0x22a5bd(0x456),_0xad8e56);if(!_0xebc1cb)return;_0x4cdc48=_0x5b873d[_0x22a5bd(0x667)][_0xebc1cb];if(!_0x4cdc48){alert(_0x22a5bd(0x690));return;}}const _0x438e5c=await _0x34d246('为“'+_0x4cdc48['name']+'”添加记忆',_0x22a5bd(0xf24),'',_0x22a5bd(0x11b9));if(_0x438e5c&&_0x438e5c[_0x22a5bd(0xc3a)]()){if(!_0x4cdc48[_0x22a5bd(0xc18)])_0x4cdc48['longTermMemory']=[];_0x4cdc48[_0x22a5bd(0xc18)][_0x22a5bd(0x138c)]({'content':_0x438e5c['trim'](),'timestamp':Date[_0x22a5bd(0xf1a)](),'source':_0x22a5bd(0x851)}),await _0x1a6951[_0x22a5bd(0x667)][_0x22a5bd(0xc0f)](_0x4cdc48),_0x531379();}}async function _0x464208(_0x98884c,_0x4cb45e){const _0x45a82b=_0x41eae2,_0x451efd=_0x5b873d[_0x45a82b(0x667)][_0x98884c];if(!_0x451efd||!_0x451efd[_0x45a82b(0xc18)])return;const _0x2a1429=_0x451efd[_0x45a82b(0xc18)][_0x45a82b(0x9d7)](_0x360a93=>_0x360a93[_0x45a82b(0x114e)]===_0x4cb45e);if(_0x2a1429===-0x1)return;const _0x17a9bb=_0x451efd[_0x45a82b(0xc18)][_0x2a1429],_0x1f48b9=await _0x34d246('编辑记忆',_0x45a82b(0x9f6),_0x17a9bb[_0x45a82b(0x28c)],_0x45a82b(0x11b9));_0x1f48b9&&_0x1f48b9[_0x45a82b(0xc3a)]()&&(_0x17a9bb['content']=_0x1f48b9[_0x45a82b(0xc3a)](),await _0x1a6951['chats'][_0x45a82b(0xc0f)](_0x451efd),_0x531379());}async function _0x25adb2(_0x544f4d,_0x4d4e7c){const _0x195795=_0x41eae2,_0x5702fc=await _0x4e2abc('确认删除',_0x195795(0xcdf),{'confirmButtonClass':'btn-danger'});if(_0x5702fc){const _0x150e0a=_0x5b873d[_0x195795(0x667)][_0x544f4d];if(!_0x150e0a||!_0x150e0a[_0x195795(0xc18)])return;_0x150e0a[_0x195795(0xc18)]=_0x150e0a['longTermMemory']['filter'](_0x40a8a3=>_0x40a8a3[_0x195795(0x114e)]!==_0x4d4e7c),await _0x1a6951['chats'][_0x195795(0xc0f)](_0x150e0a),_0x531379();}}async function _0x20365f(){const _0x12b3c1=_0x41eae2,_0x19e68e=await _0x4e2abc(_0x12b3c1(0x4b0),_0x12b3c1(0x1176));_0x19e68e&&await _0xaaa6a2(_0x5b873d['activeChatId'],!![]);}async function _0x402388(_0x23ed72){const _0x485524=_0x41eae2,_0x5294eb=_0x5b873d[_0x485524(0x667)][_0x23ed72];if(!_0x5294eb||!_0x5294eb['settings'][_0x485524(0x1375)])return;const _0x3eea77=_0x5294eb[_0x485524(0x46d)]||0x0,_0x26de91=_0x5294eb[_0x485524(0x551)]['filter'](_0x459141=>_0x459141['timestamp']>_0x3eea77&&!_0x459141[_0x485524(0x9ae)]);_0x26de91['length']>=_0x5294eb[_0x485524(0xdb9)][_0x485524(0xe59)]&&(console[_0x485524(0x471)]('达到自动总结阈值\x20('+_0x26de91[_0x485524(0x7aa)]+'/'+_0x5294eb[_0x485524(0xdb9)][_0x485524(0xe59)]+_0x485524(0x132d)),await _0xaaa6a2(_0x23ed72));}async function _0x402bd9(_0x5753a5,_0x4b0731){const _0x4ccbf7=_0x41eae2,_0x464f1b=_0x5b873d[_0x4ccbf7(0x667)][_0x5753a5];if(!_0x464f1b||!_0x4b0731)throw new Error(_0x4ccbf7(0x1f3));const _0x270388=_0x5b873d[_0x4ccbf7(0x5c1)][_0x4ccbf7(0x22a)]||'用户';let _0x52bb0e,_0x265567=_0x464f1b;const _0x53dea8=new Date()[_0x4ccbf7(0x1148)](_0x4ccbf7(0x1e8),{'year':_0x4ccbf7(0xe93),'month':'long','day':_0x4ccbf7(0xe93)});if(_0x464f1b['isGroup']){let _0x1d0dab=null;_0x333dc7['callRequester']&&(_0x1d0dab=_0x464f1b[_0x4ccbf7(0x5ab)]['find'](_0x46d999=>_0x46d999[_0x4ccbf7(0x1045)]===_0x333dc7[_0x4ccbf7(0x7a1)]));!_0x1d0dab&&(_0x1d0dab=_0x464f1b[_0x4ccbf7(0x5ab)][_0x4ccbf7(0x12f4)](_0x37b037=>_0x37b037['id']!==_0x4ccbf7(0x116c)&&_0x333dc7['participants'][_0x4ccbf7(0xc5c)](_0xa2dca7=>_0xa2dca7['id']===_0x37b037['id'])));!_0x1d0dab&&(_0x1d0dab=_0x464f1b[_0x4ccbf7(0x5ab)][_0x4ccbf7(0x12f4)](_0x526b83=>_0x526b83['id']!==_0x4ccbf7(0x116c)));if(!_0x1d0dab)throw new Error(_0x4ccbf7(0x1321));const _0x207718=_0x5b873d['chats'][_0x1d0dab['id']];if(!_0x207718)throw new Error(_0x4ccbf7(0xbed)+_0x1d0dab['groupNickname']+_0x4ccbf7(0xb92));const _0x23c018=_0x464f1b[_0x4ccbf7(0xdb9)]['myPersona']||'(未设置)';_0x52bb0e='\x0a#\x20你的任务\x0a你就是角色“'+_0x1d0dab['originalName']+'”。请你回顾一下刚才和\x20“'+_0x270388+_0x4ccbf7(0xd9b)+_0x53dea8+_0x4ccbf7(0xeb3)+_0x53dea8+_0x4ccbf7(0x307)+_0x207718['settings']['aiPersona']+_0x4ccbf7(0x135d)+_0x23c018+'\x0a\x0a#\x20待总结的群组视频通话记录\x0a'+_0x4b0731+_0x4ccbf7(0xe4e)+_0x1d0dab[_0x4ccbf7(0x1045)]+_0x4ccbf7(0xa86),_0x265567=_0x207718;}else _0x52bb0e='\x0a#\x20你的任务\x0a你就是角色“'+_0x464f1b['originalName']+_0x4ccbf7(0x5eb)+_0x270388+_0x4ccbf7(0x11b4)+_0x53dea8+_0x4ccbf7(0x1264)+_0x53dea8+'”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a'+_0x464f1b[_0x4ccbf7(0xdb9)][_0x4ccbf7(0x1269)]+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x464f1b[_0x4ccbf7(0xdb9)]['myPersona']+_0x4ccbf7(0x9a6)+_0x4b0731+_0x4ccbf7(0xe4e)+_0x464f1b['originalName']+'”的身份，开始你的客观总结。';try{const _0x53309d=_0x5b873d['apiConfig']['secondaryProxyUrl']&&_0x5b873d[_0x4ccbf7(0x30d)][_0x4ccbf7(0x2cf)]&&_0x5b873d['apiConfig'][_0x4ccbf7(0x10f0)],{proxyUrl:_0x258c52,apiKey:_0x5ea63c,model:_0x24a723}=_0x53309d?{'proxyUrl':_0x5b873d[_0x4ccbf7(0x30d)][_0x4ccbf7(0x989)],'apiKey':_0x5b873d['apiConfig']['secondaryApiKey'],'model':_0x5b873d[_0x4ccbf7(0x30d)][_0x4ccbf7(0x10f0)]}:_0x5b873d[_0x4ccbf7(0x30d)];if(!_0x258c52||!_0x5ea63c||!_0x24a723)throw new Error('API未配置，无法进行总结。');let _0x118ad1=_0x258c52[_0x4ccbf7(0xced)]('generativelanguage'),_0x253898=_0xa615f4(_0x24a723,_0x5ea63c,_0x52bb0e,[{'role':_0x4ccbf7(0x116c),'content':_0x4ccbf7(0xe84)}]);const _0x21e5aa=_0x118ad1?await fetch(_0x253898[_0x4ccbf7(0x11de)],_0x253898[_0x4ccbf7(0xd98)]):await fetch(_0x258c52+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x4ccbf7(0xce4),'Authorization':'Bearer\x20'+_0x5ea63c},'body':JSON['stringify']({'model':_0x24a723,'messages':[{'role':_0x4ccbf7(0x18c),'content':_0x52bb0e},{'role':_0x4ccbf7(0x116c),'content':'请开始总结。'}],'temperature':0.1})});if(!_0x21e5aa['ok']){const _0x143e81=await _0x21e5aa[_0x4ccbf7(0x6b5)]()[_0x4ccbf7(0x1035)](()=>({'error':{'message':_0x21e5aa['statusText']}}));throw new Error(_0x4ccbf7(0xf8b)+_0x21e5aa['status']+_0x4ccbf7(0xc3d)+_0x143e81[_0x4ccbf7(0x1fd)][_0x4ccbf7(0x1288)]);}const _0x5a4b09=await _0x21e5aa[_0x4ccbf7(0x6b5)]();let _0x2268a7=_0x118ad1?getGeminiResponseText(_0x5a4b09):_0x5a4b09[_0x4ccbf7(0xd3b)][0x0][_0x4ccbf7(0x1288)][_0x4ccbf7(0x28c)];_0x2268a7=_0x2268a7[_0x4ccbf7(0xfbf)](/^```json\s*/,'')[_0x4ccbf7(0xfbf)](/```$/,'')[_0x4ccbf7(0xc3a)]();const _0x174da9=JSON[_0x4ccbf7(0x2cb)](_0x2268a7);if(_0x174da9[_0x4ccbf7(0x4ac)]&&_0x174da9[_0x4ccbf7(0x4ac)][_0x4ccbf7(0xc3a)]()){const _0x160aa4={'content':_0x4ccbf7(0x111a)+(_0x464f1b['isGroup']?'群聊':'')+_0x4ccbf7(0x11d7)+_0x174da9['summary'][_0x4ccbf7(0xc3a)]()+')','timestamp':Date['now'](),'source':_0x464f1b['isGroup']?_0x4ccbf7(0x523):_0x4ccbf7(0x12ec)};if(!_0x265567[_0x4ccbf7(0xc18)])_0x265567[_0x4ccbf7(0xc18)]=[];return _0x265567[_0x4ccbf7(0xc18)][_0x4ccbf7(0x138c)](_0x160aa4),await _0x1a6951[_0x4ccbf7(0x667)][_0x4ccbf7(0xc0f)](_0x265567),console[_0x4ccbf7(0x471)](_0x4ccbf7(0x102c)+_0x265567[_0x4ccbf7(0xf74)]+_0x4ccbf7(0x3bf)),!![];}else throw new Error('AI返回了空的或格式不正确的总结内容。');}catch(_0x567608){console['error'](_0x4ccbf7(0x1216),_0x567608);throw _0x567608;}}function _0x1d8174(_0x3d0bd9){const _0x597022=_0x41eae2,_0x50976d=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么','为什么','哪个','一些','这个','那个','还有']),_0x54433f=_0x3d0bd9[_0x597022(0x86c)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x2195d8=new Map();let _0x4c1ab1=0x0;_0x54433f[_0x597022(0xd9a)](_0x1d6c82=>{const _0x5ce81f=_0x597022;if(_0x1d6c82[_0x5ce81f(0x7aa)]>0x1&&!_0x50976d['has'](_0x1d6c82)){const _0x58815a=(_0x2195d8['get'](_0x1d6c82)||0x0)+0x1;_0x2195d8['set'](_0x1d6c82,_0x58815a);if(_0x58815a>_0x4c1ab1)_0x4c1ab1=_0x58815a;}});const _0x12d247=[],_0x75d521=[],_0x222c06=_0x4c1ab1*0.9,_0x5f37e2=_0x4c1ab1*0.6;_0x2195d8[_0x597022(0xd9a)]((_0x1c1560,_0x3cd680)=>{const _0x3959b6=_0x597022;if(_0x1c1560>=_0x222c06)_0x12d247[_0x3959b6(0x138c)](_0x3cd680);else _0x1c1560>=_0x5f37e2&&_0x75d521[_0x3959b6(0x138c)](_0x3cd680);});const _0x30eee1=new Set(_0x12d247),_0x2b9819=_0x75d521['filter'](_0x38318c=>!_0x30eee1[_0x597022(0xa14)](_0x38318c))['slice'](0x0,0x5);return{'coreKeywords':_0x12d247['slice'](0x0,0x3),'situationalKeywords':_0x2b9819};}function _0x247dd3(_0x22301f,_0x2657e5,_0x5c0424){const _0x2bdd54=_0x41eae2;let _0x4733a4;_0x5c0424===_0x2bdd54(0x5be)?_0x4733a4=Date[_0x2bdd54(0xf1a)]()-_0x2657e5*0x3c*0x3c*0x3e8:_0x4733a4=Date[_0x2bdd54(0xf1a)]()-_0x2657e5*0x18*0x3c*0x3c*0x3e8;const _0x1cc55b=_0x22301f[_0x2bdd54(0x551)][_0x2bdd54(0x3d8)](_0xc2053f=>_0xc2053f[_0x2bdd54(0x114e)]>_0x4733a4&&!_0xc2053f[_0x2bdd54(0x9ae)]);if(_0x1cc55b[_0x2bdd54(0x7aa)]<0x3)return'';const _0x31a346=_0x1cc55b[_0x2bdd54(0x412)](_0x31350d=>{const _0x46c70a=_0x2bdd54;if(typeof _0x31350d['content']===_0x46c70a(0x1224))return _0x31350d['content'];if(_0x31350d['type']===_0x46c70a(0xff9))return _0x31350d[_0x46c70a(0x28c)];if(_0x31350d[_0x46c70a(0x48c)]===_0x46c70a(0x910))return(_0x31350d[_0x46c70a(0xa03)]||'')+'\x20'+(_0x31350d['description']||'');return'';})[_0x2bdd54(0x1237)]('\x20'),_0x5ee174=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0x540274=_0x31a346[_0x2bdd54(0x86c)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x31d2d4=new Map();_0x540274[_0x2bdd54(0xd9a)](_0x1b6dcc=>{const _0x3c4745=_0x2bdd54;_0x1b6dcc['length']>0x1&&!_0x5ee174[_0x3c4745(0xa14)](_0x1b6dcc)&&_0x31d2d4[_0x3c4745(0xd3f)](_0x1b6dcc,(_0x31d2d4[_0x3c4745(0x650)](_0x1b6dcc)||0x0)+0x1);});const _0x575355=[..._0x31d2d4[_0x2bdd54(0xa7f)]()][_0x2bdd54(0x2e3)]((_0x48e00e,_0x5c3b51)=>_0x5c3b51[0x1]-_0x48e00e[0x1])['map'](_0x5202cc=>_0x5202cc[0x0]);if(_0x575355[_0x2bdd54(0x7aa)]===0x0)return'';let _0x2bc38d;return _0x5c0424==='hours'?_0x2bc38d='最近'+_0x2657e5+_0x2bdd54(0x10c8):_0x2657e5===0x1?_0x2bc38d=_0x2bdd54(0xc29):_0x2bc38d='最近'+_0x2657e5+_0x2bdd54(0xfbc),_0x2bdd54(0xa80)+_0x2bc38d+'**:\x20关于\x20**'+_0x575355['slice'](0x0,0x3)['join']('、\x20')+_0x2bdd54(0xa30);}function _0x26d410(_0x1d6392){const _0x5b6a90=_0x41eae2;if(!_0x1d6392||typeof _0x1d6392!==_0x5b6a90(0x1224))return null;const _0x5a3cfb=_0x1d6392[_0x5b6a90(0xfbf)](/^```json\s*/,'')[_0x5b6a90(0xfbf)](/```$/,'')['trim'](),_0x21c3fe=_0x5a3cfb[_0x5b6a90(0x86c)](/{[\s\S]*}/);if(_0x21c3fe)try{const _0xf1d663=JSON[_0x5b6a90(0x2cb)](_0x21c3fe[0x0]);return console['log'](_0x5b6a90(0xcf2)),_0xf1d663;}catch(_0x3da575){console['warn'](_0x5b6a90(0x12a0));}const _0x559401=_0x5a3cfb[_0x5b6a90(0x86c)](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0x559401&&_0x559401[0x1])return console[_0x5b6a90(0x471)]('容错解析：策略2成功\x20(提取了summary字段内容)'),{'summary':_0x559401[0x1]['replace'](/\\"/g,'\x22')};if(_0x5a3cfb)return console[_0x5b6a90(0x471)](_0x5b6a90(0x999)),{'summary':_0x5a3cfb};return null;}async function _0xce0120(_0x571c65){const _0x25c839=_0x41eae2;let _0x37bef7=_0x5b873d[_0x25c839(0x667)][_0x571c65];if(!_0x37bef7)return;let _0x2c8f53=_0x37bef7;if(_0x37bef7[_0x25c839(0x58c)]){const _0x276fc0=_0x37bef7[_0x25c839(0x5ab)][_0x25c839(0x412)](_0x998dea=>{const _0x56e24c=_0x25c839,_0x3d2485=_0x5b873d['chats'][_0x998dea['id']];if(_0x3d2485&&_0x3d2485[_0x56e24c(0xc18)]&&_0x3d2485[_0x56e24c(0xc18)]['length']>=0x2)return{'text':_0x56e24c(0x11bb)+_0x998dea[_0x56e24c(0x7da)]+_0x56e24c(0xda5)+_0x3d2485[_0x56e24c(0xc18)][_0x56e24c(0x7aa)]+'条)','value':_0x998dea['id']};return null;})[_0x25c839(0x3d8)](Boolean);if(_0x276fc0['length']===0x0){alert(_0x25c839(0x9b4));return;}const _0x30a6ea=await _0x4d923b(_0x25c839(0x543),_0x276fc0);if(!_0x30a6ea)return;_0x2c8f53=_0x5b873d[_0x25c839(0x667)][_0x30a6ea];}if(!_0x2c8f53['longTermMemory']||_0x2c8f53[_0x25c839(0xc18)][_0x25c839(0x7aa)]<0x2){alert('“'+_0x2c8f53[_0x25c839(0xf74)]+_0x25c839(0xf81));return;}const _0x441968=_0x2c8f53[_0x25c839(0xc18)][_0x25c839(0x7aa)],_0x486a7f=await _0x4d923b(_0x25c839(0x95d),[{'text':_0x25c839(0x78d)+_0x441968+'条)','value':'all'},{'text':'最近\x2020\x20条','value':'20'},{'text':_0x25c839(0x526),'value':'50'},{'text':_0x25c839(0x644),'value':_0x25c839(0x1181)},{'text':_0x25c839(0xaae),'value':_0x25c839(0xb8f)}][_0x25c839(0x3d8)](_0x328a2e=>_0x328a2e['value']===_0x25c839(0x863)||_0x328a2e[_0x25c839(0x2f4)]===_0x25c839(0xb8f)||parseInt(_0x328a2e['value'])<_0x441968));if(_0x486a7f===null)return;let _0x410cd1,_0x5ba32a=_0x441968;if(_0x486a7f===_0x25c839(0x863))_0x410cd1=[..._0x2c8f53['longTermMemory']];else{if(_0x486a7f===_0x25c839(0xb8f)){const _0x25b16a=await _0x34d246('自定义数量',_0x25c839(0x4c5)+_0x441968+_0x25c839(0xa60));if(_0x25b16a===null)return;const _0x4b486c=parseInt(_0x25b16a);if(isNaN(_0x4b486c)||_0x4b486c<0x2||_0x4b486c>_0x441968){alert(_0x25c839(0x7a0)+_0x441968+'\x20之间的有效数字。');return;}_0x5ba32a=_0x4b486c,_0x410cd1=_0x2c8f53['longTermMemory']['slice'](-_0x5ba32a);}else _0x5ba32a=parseInt(_0x486a7f),_0x5ba32a>=_0x441968?(_0x410cd1=[..._0x2c8f53[_0x25c839(0xc18)]],_0x5ba32a=_0x441968):_0x410cd1=_0x2c8f53[_0x25c839(0xc18)][_0x25c839(0xdd0)](-_0x5ba32a);}const _0x4de810=await _0x34d246(_0x25c839(0xcb0),_0x25c839(0x506),_0x25c839(0xf49));if(_0x4de810===null)return;const _0x2a0ea7=parseInt(_0x4de810);if(isNaN(_0x2a0ea7)||_0x2a0ea7<0x14){alert(_0x25c839(0x292));return;}const _0x1cbc04=await _0x4e2abc(_0x25c839(0x130e),_0x25c839(0x71c)+_0x5ba32a+'\x20条长期记忆发送给AI，总结成大约\x20'+_0x2a0ea7+_0x25c839(0x12c4),{'confirmButtonClass':_0x25c839(0xcd8),'confirmText':_0x25c839(0xffc)});if(!_0x1cbc04)return;const _0x4290b9=_0x410cd1['map'](_0xaa40c6=>'-\x20'+_0xaa40c6[_0x25c839(0x28c)])[_0x25c839(0x1237)]('\x0a'),_0x595dce=_0x5b873d['qzoneSettings'][_0x25c839(0x22a)]||'用户',_0x1f653a=new Date()[_0x25c839(0x1148)]('zh-CN',{'year':_0x25c839(0xe93),'month':'long','day':'numeric'}),_0x37d25d=_0x25c839(0xe7f)+_0x2c8f53[_0x25c839(0x1045)]+_0x25c839(0xc69)+_0x595dce+'”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x1f653a+_0x25c839(0x9f2)+_0x1f653a+_0x25c839(0x1361)+_0x2a0ea7+'\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a'+_0x2c8f53[_0x25c839(0xdb9)][_0x25c839(0x1269)]+_0x25c839(0x135d)+_0x2c8f53[_0x25c839(0xdb9)]['myPersona']+_0x25c839(0x7fe)+_0x4290b9+'\x0a\x0a现在，请以“'+_0x2c8f53[_0x25c839(0x1045)]+_0x25c839(0xd4f);await _0x532f76(_0x25c839(0xb6a),_0x25c839(0xdf4));try{const _0x169ba4=_0x5b873d[_0x25c839(0x30d)]['secondaryProxyUrl']&&_0x5b873d[_0x25c839(0x30d)][_0x25c839(0x2cf)]&&_0x5b873d[_0x25c839(0x30d)][_0x25c839(0x10f0)],{proxyUrl:_0x50a3a6,apiKey:_0x3ef93c,model:_0x235bf9}=_0x169ba4?{'proxyUrl':_0x5b873d[_0x25c839(0x30d)][_0x25c839(0x989)],'apiKey':_0x5b873d[_0x25c839(0x30d)][_0x25c839(0x2cf)],'model':_0x5b873d[_0x25c839(0x30d)]['secondaryModel']}:_0x5b873d[_0x25c839(0x30d)];if(!_0x50a3a6||!_0x3ef93c||!_0x235bf9)throw new Error(_0x25c839(0x4c7));let _0x28f7d1=_0x50a3a6[_0x25c839(0xced)]('generativelanguage'),_0x785622=_0xa615f4(_0x235bf9,_0x3ef93c,_0x37d25d,[{'role':_0x25c839(0x116c),'content':_0x25c839(0x12ee)}]);const _0x48370=_0x28f7d1?await fetch(_0x785622[_0x25c839(0x11de)],_0x785622['data']):await fetch(_0x50a3a6+_0x25c839(0x6dd),{'method':_0x25c839(0xd14),'headers':{'Content-Type':_0x25c839(0xce4),'Authorization':_0x25c839(0x3fb)+_0x3ef93c},'body':JSON[_0x25c839(0x465)]({'model':_0x235bf9,'messages':[{'role':_0x25c839(0x18c),'content':_0x37d25d},{'role':'user','content':_0x25c839(0x12ee)}],'temperature':0.2})});if(!_0x48370['ok'])throw new Error('API\x20错误:\x20'+_0x48370[_0x25c839(0x517)]);const _0x905af7=await _0x48370[_0x25c839(0x6b5)]();let _0x3e1f77=_0x28f7d1?getGeminiResponseText(_0x905af7):_0x905af7[_0x25c839(0xd3b)][0x0]['message'][_0x25c839(0x28c)];const _0x17e79c=_0x26d410(_0x3e1f77);if(_0x17e79c&&_0x17e79c['summary']&&typeof _0x17e79c[_0x25c839(0x4ac)]===_0x25c839(0x1224)&&_0x17e79c[_0x25c839(0x4ac)]['trim']()){const _0xf85ba3=await _0x4e2abc('精炼完成，请确认','AI已将您的\x20'+_0x5ba32a+'\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>'+_0x17e79c[_0x25c839(0x4ac)]['trim']()+_0x25c839(0xc30),{'confirmText':_0x25c839(0x685),'cancelText':'保留旧的','confirmButtonClass':_0x25c839(0xcd8)});if(_0xf85ba3){const _0x52c48c={'content':_0x17e79c[_0x25c839(0x4ac)]['trim'](),'timestamp':Date['now'](),'source':_0x25c839(0xb16)},_0xb63dc9=_0x441968-_0x5ba32a,_0x4111db=_0xb63dc9>0x0?_0x2c8f53[_0x25c839(0xc18)][_0x25c839(0xdd0)](0x0,_0xb63dc9):[];_0x2c8f53[_0x25c839(0xc18)]=[..._0x4111db,_0x52c48c],_0x2c8f53[_0x25c839(0x46d)]=Date[_0x25c839(0xf1a)](),await _0x1a6951['chats'][_0x25c839(0xc0f)](_0x2c8f53),document[_0x25c839(0x89d)](_0x25c839(0x1194))[_0x25c839(0x2f1)][_0x25c839(0x3ff)](_0x25c839(0x8ea))&&_0x531379(),await _0x532f76(_0x25c839(0x208),_0x25c839(0xca9)+_0x5ba32a+'\x20条记忆精炼为\x201\x20条核心记忆！');}else await _0x532f76(_0x25c839(0xdce),_0x25c839(0xfa2));}else throw new Error(_0x25c839(0xdba));}catch(_0x21e88c){console[_0x25c839(0x1fd)](_0x25c839(0x1232),_0x21e88c),await _0x532f76(_0x25c839(0x975),'操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20'+_0x21e88c[_0x25c839(0x1288)]);}}async function _0xaaa6a2(_0x353347,_0xf51ac6=![]){const _0x4058ce=_0x41eae2,_0x135fcd=_0x5b873d[_0x4058ce(0x667)][_0x353347];if(!_0x135fcd)return;const _0x5d858b=_0x135fcd[_0x4058ce(0x46d)]||0x0,_0x4baa19=_0xf51ac6?_0x135fcd['history'][_0x4058ce(0x3d8)](_0x522460=>!_0x522460[_0x4058ce(0x9ae)]||_0x522460[_0x4058ce(0xa57)]===_0x4058ce(0x18c)&&_0x522460[_0x4058ce(0x28c)][_0x4058ce(0xced)](_0x4058ce(0x5f2)))[_0x4058ce(0xdd0)](-(_0x135fcd[_0x4058ce(0xdb9)][_0x4058ce(0xe59)]||0x14)):_0x135fcd[_0x4058ce(0x551)][_0x4058ce(0x3d8)](_0x4b9f0f=>_0x4b9f0f[_0x4058ce(0x114e)]>_0x5d858b&&(!_0x4b9f0f[_0x4058ce(0x9ae)]||_0x4b9f0f[_0x4058ce(0xa57)]==='system'&&_0x4b9f0f['content'][_0x4058ce(0xced)](_0x4058ce(0x5f2))));if(_0x4baa19[_0x4058ce(0x7aa)]<0x5){if(_0xf51ac6)alert('最近的消息太少，无法进行有意义的总结。');return;}const _0x7cc1e9=_0x5b873d[_0x4058ce(0x5c1)][_0x4058ce(0x22a)]||'用户',_0x5246c9=_0x4baa19['map'](_0x134eed=>{const _0x5c265e=_0x4058ce;if(_0x134eed[_0x5c265e(0x9ae)]&&_0x134eed['role']==='system'&&_0x134eed[_0x5c265e(0x28c)][_0x5c265e(0xced)](_0x5c265e(0x5f2)))return _0x134eed[_0x5c265e(0x28c)];let _0x533a8;_0x134eed[_0x5c265e(0xa57)]===_0x5c265e(0x116c)?_0x533a8=_0x7cc1e9:_0x533a8=_0x134eed[_0x5c265e(0xcfc)]||_0x135fcd[_0x5c265e(0x1045)];let _0x34a42d='';if(_0x134eed['type']===_0x5c265e(0x910)){if(_0x134eed[_0x5c265e(0x28c)])_0x34a42d=_0x134eed[_0x5c265e(0x28c)];else{const _0x7c0e7d=_0x134eed['dialogue']?'「'+_0x134eed[_0x5c265e(0xa03)]+'」':'',_0x5f1512=_0x134eed['description']?'('+_0x134eed[_0x5c265e(0xf6e)]+')':'';_0x34a42d=(_0x7c0e7d+'\x20'+_0x5f1512)[_0x5c265e(0xc3a)]();}}else _0x34a42d=String(_0x134eed[_0x5c265e(0x28c)]);return _0x533a8+':\x20'+_0x34a42d;})[_0x4058ce(0x1237)]('\x0a');let _0x18cf58;if(_0x135fcd[_0x4058ce(0x58c)])_0x18cf58=_0x4058ce(0x49c)+_0x7cc1e9+'聊了关于生日派对的事，我们约好了10月1日见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a'+_0x5246c9+_0x4058ce(0xcf7)+_0x135fcd['members']['map'](_0x1c8525=>'-\x20'+_0x1c8525['groupNickname']+_0x4058ce(0x95e)+_0x1c8525[_0x4058ce(0x1045)]+')')[_0x4058ce(0x1237)]('\x0a')+_0x4058ce(0x8f2);else{const _0x5858c1=new Date()[_0x4058ce(0x1148)]('zh-CN',{'year':_0x4058ce(0xe93),'month':_0x4058ce(0xa65),'day':_0x4058ce(0xe93)});_0x18cf58='\x0a#\x20你的任务\x0a你就是角色“'+_0x135fcd[_0x4058ce(0x1045)]+_0x4058ce(0x5eb)+_0x7cc1e9+_0x4058ce(0x19a)+_0x5858c1+_0x4058ce(0x1260)+_0x5858c1+_0x4058ce(0x3a0)+new Date(Date['now']()+0x5265c00)[_0x4058ce(0x1148)](_0x4058ce(0x1e8),{'month':_0x4058ce(0xa65),'day':_0x4058ce(0xe93)})+_0x4058ce(0x3e4)+_0x135fcd[_0x4058ce(0xdb9)][_0x4058ce(0x1269)]+_0x4058ce(0xa55)+_0x135fcd[_0x4058ce(0xdb9)][_0x4058ce(0x6d4)]+_0x4058ce(0xc41)+_0x5246c9+_0x4058ce(0xe4e)+_0x135fcd['originalName']+_0x4058ce(0xa86);}try{const _0x5eeabe=_0x5b873d[_0x4058ce(0x30d)][_0x4058ce(0x989)]&&_0x5b873d[_0x4058ce(0x30d)][_0x4058ce(0x2cf)]&&_0x5b873d[_0x4058ce(0x30d)]['secondaryModel'],{proxyUrl:_0xd76e98,apiKey:_0x8e8af4,model:_0x3bb6e9}=_0x5eeabe?{'proxyUrl':_0x5b873d[_0x4058ce(0x30d)]['secondaryProxyUrl'],'apiKey':_0x5b873d['apiConfig'][_0x4058ce(0x2cf)],'model':_0x5b873d[_0x4058ce(0x30d)][_0x4058ce(0x10f0)]}:_0x5b873d[_0x4058ce(0x30d)];if(!_0xd76e98||!_0x8e8af4||!_0x3bb6e9)throw new Error(_0x4058ce(0x45e));let _0x33d572=_0xd76e98['includes'](_0x4058ce(0x6a6)),_0x468c44=_0xa615f4(_0x3bb6e9,_0x8e8af4,_0x18cf58,[{'role':_0x4058ce(0x116c),'content':_0x4058ce(0xe84)}]);const _0x218d43=_0x33d572?await fetch(_0x468c44[_0x4058ce(0x11de)],_0x468c44[_0x4058ce(0xd98)]):await fetch(_0xd76e98+_0x4058ce(0x6dd),{'method':'POST','headers':{'Content-Type':_0x4058ce(0xce4),'Authorization':_0x4058ce(0x3fb)+_0x8e8af4},'body':JSON['stringify']({'model':_0x3bb6e9,'messages':[{'role':_0x4058ce(0x18c),'content':_0x18cf58},{'role':'user','content':'请开始总结。'}],'temperature':0.2})});if(!_0x218d43['ok'])throw new Error('API\x20错误:\x20'+_0x218d43[_0x4058ce(0x517)]);const _0x5cb765=await _0x218d43['json']();let _0x5849f4=_0x33d572?getGeminiResponseText(_0x5cb765):_0x5cb765['choices'][0x0]['message']['content'];_0x5849f4=_0x5849f4[_0x4058ce(0xfbf)](/^```json\s*/,'')[_0x4058ce(0xfbf)](/```$/,'')[_0x4058ce(0xc3a)]();const _0x346354=JSON[_0x4058ce(0x2cb)](_0x5849f4);if(_0x135fcd[_0x4058ce(0x58c)]){if(_0x346354[_0x4058ce(0x4f8)]&&typeof _0x346354[_0x4058ce(0x4f8)]===_0x4058ce(0x7af)){let _0x106d63=0x0;for(const _0x19de1d in _0x346354[_0x4058ce(0x4f8)]){const _0x7f12f2=_0x346354[_0x4058ce(0x4f8)][_0x19de1d];if(_0x7f12f2&&_0x7f12f2[_0x4058ce(0xc3a)]()){const _0x1ef91b=Object[_0x4058ce(0x4b5)](_0x5b873d[_0x4058ce(0x667)])[_0x4058ce(0x12f4)](_0x49aa88=>_0x49aa88['originalName']===_0x19de1d);if(_0x1ef91b){const _0x3a6715={'content':_0x7f12f2[_0x4058ce(0xc3a)](),'timestamp':Date[_0x4058ce(0xf1a)](),'source':_0x4058ce(0x1129)+_0x135fcd[_0x4058ce(0xf74)]};if(!_0x1ef91b['longTermMemory'])_0x1ef91b[_0x4058ce(0xc18)]=[];_0x1ef91b[_0x4058ce(0xc18)]['push'](_0x3a6715),await _0x1a6951[_0x4058ce(0x667)]['put'](_0x1ef91b),_0x106d63++;}}}if(_0x106d63>0x0)console[_0x4058ce(0x471)](_0x4058ce(0xef8)+_0x106d63+_0x4058ce(0xbc4));else throw new Error(_0x4058ce(0xdba));}else throw new Error(_0x4058ce(0xba9));}else{if(_0x346354[_0x4058ce(0x4ac)]&&_0x346354[_0x4058ce(0x4ac)][_0x4058ce(0xc3a)]()){const _0x3530e7={'content':_0x346354[_0x4058ce(0x4ac)][_0x4058ce(0xc3a)](),'timestamp':Date[_0x4058ce(0xf1a)](),'source':_0x4058ce(0xd71)};_0x135fcd[_0x4058ce(0xc18)]['push'](_0x3530e7),await _0x1a6951['chats'][_0x4058ce(0xc0f)](_0x135fcd),console[_0x4058ce(0x471)]('自动总结成功：已成功添加\x201\x20条新的长期记忆！');}else throw new Error(_0x4058ce(0xdba));}_0x135fcd[_0x4058ce(0x46d)]=_0x4baa19[_0x4058ce(0xdd0)](-0x1)[0x0][_0x4058ce(0x114e)],await _0x1a6951['chats'][_0x4058ce(0xc0f)](_0x135fcd),document['getElementById'](_0x4058ce(0x1194))[_0x4058ce(0x2f1)]['contains'](_0x4058ce(0x8ea))&&_0x531379();}catch(_0x1df922){console[_0x4058ce(0x1fd)]('总结长期记忆时出错:',_0x1df922),await _0x532f76('总结失败',_0x4058ce(0x7ee)+_0x1df922[_0x4058ce(0x1288)]);}}function _0x1a8ff5(){const _0x8b8952=_0x41eae2;if(!_0x1cefba)return;const _0x432773=_0x5b873d[_0x8b8952(0x667)][_0x5b873d[_0x8b8952(0xf96)]],_0x5054f6=_0x432773[_0x8b8952(0x551)]['find'](_0x18ce40=>_0x18ce40[_0x8b8952(0x114e)]===_0x1cefba);if(!_0x5054f6)return;let _0x1f9689;_0x5054f6[_0x8b8952(0xa57)]===_0x8b8952(0x116c)?_0x1f9689=_0x432773[_0x8b8952(0x58c)]?_0x432773[_0x8b8952(0xdb9)][_0x8b8952(0xc48)]||'我':'我':_0x432773[_0x8b8952(0x58c)]?_0x1f9689=_0xb9963e(_0x432773,_0x5054f6[_0x8b8952(0xcfc)]):_0x1f9689=_0x432773[_0x8b8952(0xf74)];const _0x8cbab3=String(_0x5054f6[_0x8b8952(0x28c)]||'');let _0x2a0602='';if(typeof _0x5054f6['content']==='string'&&_0x3b71b1['test'](_0x5054f6[_0x8b8952(0x28c)]))_0x2a0602=_0x8b8952(0x1107);else{if(_0x5054f6[_0x8b8952(0x48c)]===_0x8b8952(0x656)||_0x5054f6[_0x8b8952(0x48c)]===_0x8b8952(0x11f6))_0x2a0602='[图片]';else _0x5054f6[_0x8b8952(0x48c)]===_0x8b8952(0xff9)?_0x2a0602=_0x8b8952(0xc5d):_0x2a0602=_0x8cbab3['substring'](0x0,0x32)+(_0x8cbab3[_0x8b8952(0x7aa)]>0x32?_0x8b8952(0x1046):'');}_0x204995={'timestamp':_0x5054f6[_0x8b8952(0x114e)],'senderName':_0x1f9689,'content':_0x8cbab3};const _0x66c109=document[_0x8b8952(0x89d)](_0x8b8952(0x63b));_0x66c109[_0x8b8952(0xd16)](_0x8b8952(0x135f))['textContent']='回复\x20'+_0x204995[_0x8b8952(0xcfc)]+':',_0x66c109[_0x8b8952(0xd16)](_0x8b8952(0xabb))[_0x8b8952(0xf12)]=_0x2a0602,_0x66c109[_0x8b8952(0x68e)]['display']=_0x8b8952(0x1118),_0x5348af(),document[_0x8b8952(0x89d)](_0x8b8952(0xc6f))[_0x8b8952(0xbf6)]();}function _0x2c11ff(){const _0x3a9de2=_0x41eae2;_0x204995=null,document[_0x3a9de2(0x89d)](_0x3a9de2(0x63b))['style'][_0x3a9de2(0x126b)]=_0x3a9de2(0x10f2);}let _0x376b26=null;function _0x4c3bea(_0x23de96){const _0x35343d=_0x41eae2;_0x376b26=_0x23de96;const _0x33d0a1=_0x5b873d[_0x35343d(0x667)][_0x5b873d[_0x35343d(0xf96)]],_0x1b7edd=_0x33d0a1['history'][_0x35343d(0x12f4)](_0x49b8c1=>_0x49b8c1[_0x35343d(0x114e)]===_0x23de96);_0x1b7edd&&(document[_0x35343d(0x89d)](_0x35343d(0xd9e))[_0x35343d(0xf12)]=_0x1b7edd['senderName']),document['getElementById'](_0x35343d(0x1063))[_0x35343d(0x2f1)][_0x35343d(0x569)](_0x35343d(0x11e4));}function _0x5a2370(){const _0x49aa1d=_0x41eae2;document[_0x49aa1d(0x89d)](_0x49aa1d(0x1063))['classList'][_0x49aa1d(0x1247)](_0x49aa1d(0x11e4)),_0x376b26=null;}async function _0x477dc9(_0x457ac6){const _0x19b170=_0x41eae2;if(!_0x376b26)return;const _0x327ec9=_0x376b26,_0x21ecff=_0x5b873d['chats'][_0x5b873d[_0x19b170(0xf96)]],_0x59039f=_0x21ecff['history'][_0x19b170(0x9d7)](_0x2a604b=>_0x2a604b['timestamp']===_0x327ec9);if(_0x59039f===-0x1)return;const _0x368415=_0x21ecff[_0x19b170(0x551)][_0x59039f];_0x368415[_0x19b170(0x632)]=_0x457ac6;let _0x185311;if(_0x457ac6===_0x19b170(0xc0e)){const _0x3c0b4c={'role':_0x19b170(0x116c),'type':'transfer','isRefund':!![],'amount':_0x368415[_0x19b170(0x10a6)],'note':_0x19b170(0x2b9),'timestamp':Date[_0x19b170(0xf1a)]()};_0x21ecff[_0x19b170(0x551)][_0x19b170(0x138c)](_0x3c0b4c),_0x185311='[系统提示：你拒绝并退还了“'+_0x368415['senderName']+_0x19b170(0xbe8);}else _0x185311='[系统提示：你接受了“'+_0x368415[_0x19b170(0xcfc)]+'”的转账。]';const _0x33c3ea={'role':_0x19b170(0x18c),'content':_0x185311,'timestamp':Date[_0x19b170(0xf1a)]()+0x1,'isHidden':!![]};_0x21ecff[_0x19b170(0x551)][_0x19b170(0x138c)](_0x33c3ea),await _0x1a6951[_0x19b170(0x667)]['put'](_0x21ecff),_0x5a2370(),_0x5b89df(_0x5b873d[_0x19b170(0xf96)]),_0x413d78();}async function _0xc6b8c(){const _0x135db8=_0x41eae2;_0x4e6c15('call-history-screen');const _0x4d30fd=document['getElementById'](_0x135db8(0x474)),_0xb6a6ad=document[_0x135db8(0x89d)](_0x135db8(0xd56));_0x4d30fd['innerHTML']='',_0xb6a6ad[_0x135db8(0xf12)]=_0x135db8(0x51f);const _0x3fe209=await _0x1a6951['callRecords'][_0x135db8(0x6ed)](_0x135db8(0x114e))[_0x135db8(0x854)]()[_0x135db8(0xc2f)]();if(_0x3fe209[_0x135db8(0x7aa)]===0x0){_0x4d30fd[_0x135db8(0x1ef)]=_0x135db8(0x9ee);return;}_0x3fe209['forEach'](_0x235391=>{const _0x4b3f97=_0x135db8,_0x4b1051=_0x21d873(_0x235391);_0xefe9e2(_0x4b1051,async()=>{const _0x542f9f=_0x356e,_0x4ff125=await _0x34d246(_0x542f9f(0xfd6),_0x542f9f(0x127d),_0x235391['customName']||'');if(_0x4ff125===null)return;await _0x1a6951[_0x542f9f(0x856)]['update'](_0x235391['id'],{'customName':_0x4ff125[_0x542f9f(0xc3a)]()}),await _0xc6b8c(),await _0x532f76('成功',_0x542f9f(0xa2a));}),_0x4d30fd[_0x4b3f97(0x22f)](_0x4b1051);});}function _0x21d873(_0x40c7d8){const _0x54c55e=_0x41eae2,_0x36b567=document[_0x54c55e(0x285)](_0x54c55e(0xb25));_0x36b567['className']=_0x54c55e(0x106d),_0x36b567[_0x54c55e(0xaaf)][_0x54c55e(0x4d3)]=_0x40c7d8['id'];const _0x40d14f=_0x5b873d[_0x54c55e(0x667)][_0x40c7d8[_0x54c55e(0x94d)]],_0x42d1a9=_0x40d14f?_0x40d14f[_0x54c55e(0xf74)]:_0x54c55e(0x9fe),_0x54ef24=new Date(_0x40c7d8[_0x54c55e(0x114e)]),_0x57203f=_0x54ef24[_0x54c55e(0x555)]()+'-'+String(_0x54ef24[_0x54c55e(0x86f)]()+0x1)[_0x54c55e(0x4d8)](0x2,'0')+'-'+String(_0x54ef24['getDate']())[_0x54c55e(0x4d8)](0x2,'0')+'\x20'+String(_0x54ef24[_0x54c55e(0x9bb)]())[_0x54c55e(0x4d8)](0x2,'0')+':'+String(_0x54ef24[_0x54c55e(0x446)]())['padStart'](0x2,'0'),_0x1e53b9=Math[_0x54c55e(0x128a)](_0x40c7d8[_0x54c55e(0x91c)]/0x3c)+'分'+_0x40c7d8[_0x54c55e(0x91c)]%0x3c+'秒',_0x16d754=_0x40c7d8[_0x54c55e(0x394)][_0x54c55e(0x412)](_0x1747d4=>_0x54c55e(0x477)+_0x1747d4[_0x54c55e(0x12c8)]+_0x54c55e(0xee0)+_0x1747d4['name']+_0x54c55e(0xf32)+_0x1747d4[_0x54c55e(0xf74)]+'\x22>')[_0x54c55e(0x1237)]('');return _0x36b567[_0x54c55e(0x1ef)]=_0x54c55e(0x10be)+_0x57203f+_0x54c55e(0x834)+_0x1e53b9+_0x54c55e(0xa49)+(_0x40c7d8[_0x54c55e(0x3b6)]?_0x54c55e(0x964)+_0x40c7d8[_0x54c55e(0x3b6)]+_0x54c55e(0xc57):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>'+_0x16d754+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20'+_0x42d1a9+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x36b567;}async function _0x2446e1(_0x3ba763){const _0x427325=_0x41eae2,_0xde5a00=await _0x1a6951[_0x427325(0x856)][_0x427325(0x650)](_0x3ba763);if(!_0xde5a00)return;const _0xd56a52=document[_0x427325(0x89d)](_0x427325(0x72a)),_0x4547e4=document[_0x427325(0x89d)](_0x427325(0xaac)),_0x1fa4ca=document[_0x427325(0x89d)](_0x427325(0xf10));_0x4547e4['textContent']=_0x427325(0xf1f)+new Date(_0xde5a00[_0x427325(0x114e)])[_0x427325(0x425)]()+_0x427325(0xaf5)+Math[_0x427325(0x128a)](_0xde5a00[_0x427325(0x91c)]/0x3c)+'分'+_0xde5a00[_0x427325(0x91c)]%0x3c+'秒)',_0x1fa4ca[_0x427325(0x1ef)]='';const _0xc94a0=document['getElementById'](_0x427325(0xcee)),_0xc5198e=document[_0x427325(0x89d)](_0x427325(0xd7a));!_0xde5a00['transcript']||_0xde5a00[_0x427325(0x10fc)]['length']===0x0?(_0x1fa4ca[_0x427325(0x1ef)]=_0x427325(0xb24),_0xc5198e[_0x427325(0x68e)]['display']='none'):(_0xc5198e[_0x427325(0x68e)][_0x427325(0x126b)]=_0x427325(0x1118),_0xde5a00[_0x427325(0x10fc)][_0x427325(0xd9a)](_0x2ab483=>{const _0x5c8805=_0x427325,_0x896e84=document[_0x5c8805(0x285)]('div');_0x896e84[_0x5c8805(0x81c)]='transcript-entry\x20'+_0x2ab483[_0x5c8805(0xa57)],_0x896e84[_0x5c8805(0xf12)]=_0x2ab483['content'],_0x1fa4ca[_0x5c8805(0x22f)](_0x896e84);}));const _0x2e16b0=_0xc94a0[_0x427325(0xf2a)](!![]);_0xc94a0[_0x427325(0xb6e)]['replaceChild'](_0x2e16b0,_0xc94a0);const _0x1f6037=_0xc5198e[_0x427325(0xf2a)](!![]);_0xc5198e[_0x427325(0xb6e)][_0x427325(0xd38)](_0x1f6037,_0xc5198e),_0x2e16b0[_0x427325(0x1193)]('click',async()=>{const _0x27489d=_0x427325,_0x693429=await _0x4e2abc(_0x27489d(0x3da),_0x27489d(0x108e),{'confirmButtonClass':_0x27489d(0xcd8)});_0x693429&&(_0xd56a52[_0x27489d(0x2f1)][_0x27489d(0x1247)](_0x27489d(0x11e4)),await _0x1a6951[_0x27489d(0x856)][_0x27489d(0x684)](_0x3ba763),await _0xc6b8c(),alert('通话记录已删除。'));}),_0x1f6037['addEventListener']('click',async()=>{const _0x5a368b=_0x427325,_0x2351a8=await _0x4e2abc(_0x5a368b(0x4b0),'这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？',{'confirmText':'确认总结'});if(!_0x2351a8)return;_0xd56a52[_0x5a368b(0x2f1)][_0x5a368b(0x1247)]('visible');const _0xacde38=_0x5b873d['chats'][_0xde5a00[_0x5a368b(0x94d)]];if(!_0xacde38){alert('错误：找不到该通话记录所属的聊天对象。');return;}await _0x532f76(_0x5a368b(0xb6a),_0x5a368b(0x1263));try{const _0x165e0e=_0xde5a00['transcript']['map'](_0x1bedc1=>{const _0x2eedca=_0x5a368b,_0x355b3d=_0x1bedc1['role']===_0x2eedca(0x116c)?_0xacde38[_0x2eedca(0xdb9)][_0x2eedca(0xc48)]||'我':_0x1bedc1[_0x2eedca(0xcfc)]||_0xacde38[_0x2eedca(0xf74)];return _0x355b3d+':\x20'+_0x1bedc1['content'];})[_0x5a368b(0x1237)]('\x0a');await _0x402bd9(_0xde5a00[_0x5a368b(0x94d)],_0x165e0e),await _0x532f76(_0x5a368b(0xa71),'手动总结已完成！新的记忆已添加到“'+_0xacde38[_0x5a368b(0xf74)]+_0x5a368b(0x3bf));}catch(_0x34c7f0){await _0x532f76('总结失败',_0x5a368b(0x219)+_0x34c7f0[_0x5a368b(0x1288)]);}});const _0x31947e=document[_0x427325(0x89d)](_0x427325(0xdb0)),_0x5b3b8c=_0x31947e['cloneNode'](!![]);_0x31947e[_0x427325(0xb6e)][_0x427325(0xd38)](_0x5b3b8c,_0x31947e),_0x5b3b8c['addEventListener'](_0x427325(0x12a5),()=>{const _0x22fabd=_0x427325;_0xd56a52[_0x22fabd(0x2f1)][_0x22fabd(0x1247)]('visible');}),_0xd56a52[_0x427325(0x2f1)][_0x427325(0x569)](_0x427325(0x11e4));}async function _0xcbb571(){const _0x5d3849=_0x41eae2;if(!_0x5b873d[_0x5d3849(0xf96)]||_0x5b873d[_0x5d3849(0x667)][_0x5b873d[_0x5d3849(0xf96)]][_0x5d3849(0x58c)])return;const _0x3b2e18=_0x5b873d['chats'][_0x5b873d[_0x5d3849(0xf96)]],_0x322042=await _0x34d246(_0x5d3849(0x940),'请输入对方现在的新状态：',_0x3b2e18[_0x5d3849(0x632)]['text']);_0x322042!==null&&(_0x3b2e18[_0x5d3849(0x632)][_0x5d3849(0xec9)]=_0x322042[_0x5d3849(0xc3a)]()||'在线',_0x3b2e18[_0x5d3849(0x632)]['isBusy']=![],_0x3b2e18[_0x5d3849(0x632)]['lastUpdate']=Date[_0x5d3849(0xf1a)](),await _0x1a6951[_0x5d3849(0x667)][_0x5d3849(0xc0f)](_0x3b2e18),_0x5b89df(_0x5b873d[_0x5d3849(0xf96)]),_0x413d78(),await _0x532f76(_0x5d3849(0x630),'“'+_0x3b2e18[_0x5d3849(0xf74)]+'”的当前状态已更新为：'+_0x3b2e18[_0x5d3849(0x632)][_0x5d3849(0xec9)]));}async function _0xeae11b(){const _0x16301f=_0x41eae2,_0x4f10a8=document[_0x16301f(0x89d)](_0x16301f(0x1191)),_0x3e3e14=document[_0x16301f(0x89d)]('share-target-list');_0x3e3e14[_0x16301f(0x1ef)]='';const _0x532023=Object[_0x16301f(0x4b5)](_0x5b873d[_0x16301f(0x667)]);_0x532023['forEach'](_0x4d1496=>{const _0x55cba6=_0x16301f,_0x3222d5=document[_0x55cba6(0x285)](_0x55cba6(0xb25));_0x3222d5['className']=_0x55cba6(0xf36),_0x3222d5[_0x55cba6(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22'+_0x4d1496['id']+_0x55cba6(0x12f5)+(_0x4d1496[_0x55cba6(0x58c)]?_0x4d1496['settings']['groupAvatar']:_0x4d1496[_0x55cba6(0xdb9)][_0x55cba6(0xdd3)]||_0x265fcc)+_0x55cba6(0x256)+_0x4d1496[_0x55cba6(0xf74)]+_0x55cba6(0xdbe),_0x3e3e14[_0x55cba6(0x22f)](_0x3222d5);}),_0x4f10a8['classList'][_0x16301f(0x569)]('visible');}function _0x42a798(_0x514aec){const _0x763a97=_0x41eae2,_0xdf9ee2=document['getElementById'](_0x763a97(0x64c));if(!_0xdf9ee2[_0x763a97(0x2f1)][_0x763a97(0x3ff)]('visible')){if(_0x514aec)_0x514aec();return;}_0xdf9ee2[_0x763a97(0x2f1)][_0x763a97(0x1247)](_0x763a97(0x11e4)),setTimeout(()=>{const _0x3cb127=_0x763a97;document['getElementById']('music-playlist-panel')[_0x3cb127(0x2f1)]['remove'](_0x3cb127(0x11e4));if(_0x514aec)_0x514aec();},0x190);}function _0x39f66b(_0x4de053){const _0x1958bb=_0x41eae2;if(!_0x4de053)return[];const _0x174978=String(_0x4de053)[_0x1958bb(0x55b)](/\r\n?|\n/),_0x4f4590=[],_0x21cdf8=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0x1b97e8 of _0x174978){const _0x1b35d5=_0x1b97e8[_0x1958bb(0xfbf)](_0x21cdf8,'')[_0x1958bb(0xc3a)]();if(!_0x1b35d5)continue;_0x21cdf8['lastIndex']=0x0;let _0x557f6a;while((_0x557f6a=_0x21cdf8[_0x1958bb(0xf07)](_0x1b97e8))!==null){const _0x5e189f=parseInt(_0x557f6a[0x1],0xa),_0x32f57e=parseInt(_0x557f6a[0x2],0xa),_0x223a97=parseInt(_0x557f6a[0x3][_0x1958bb(0x1245)](0x3,'0'),0xa),_0x1f43f6=_0x5e189f*0x3c+_0x32f57e+_0x223a97/0x3e8;_0x4f4590[_0x1958bb(0x138c)]({'time':_0x1f43f6,'text':_0x1b35d5});}}return _0x4f4590['sort']((_0x5b22e7,_0x24db00)=>_0x5b22e7[_0x1958bb(0x3fc)]-_0x24db00[_0x1958bb(0x3fc)]);}function _0x1673be(){const _0x2f39e7=_0x41eae2,_0x240918=document[_0x2f39e7(0x89d)](_0x2f39e7(0xb42));_0x240918[_0x2f39e7(0x1ef)]='';if(!_0x1f2ed8[_0x2f39e7(0x10c2)]||_0x1f2ed8[_0x2f39e7(0x10c2)][_0x2f39e7(0x7aa)]===0x0){_0x240918[_0x2f39e7(0x1ef)]=_0x2f39e7(0x108f);return;}_0x1f2ed8[_0x2f39e7(0x10c2)][_0x2f39e7(0xd9a)]((_0x335e1d,_0x30b21b)=>{const _0x2a7da0=_0x2f39e7,_0x185dd7=document[_0x2a7da0(0x285)](_0x2a7da0(0xb25));_0x185dd7['className']=_0x2a7da0(0x544),_0x185dd7[_0x2a7da0(0xf12)]=_0x335e1d[_0x2a7da0(0xec9)],_0x185dd7['dataset'][_0x2a7da0(0xa9b)]=_0x30b21b,_0x240918[_0x2a7da0(0x22f)](_0x185dd7);}),_0x240918[_0x2f39e7(0x68e)][_0x2f39e7(0x9ab)]=_0x2f39e7(0x1271);}function _0x2b1217(_0x2734d7){const _0x29868b=_0x41eae2;if(_0x1f2ed8[_0x29868b(0x10c2)][_0x29868b(0x7aa)]===0x0)return;let _0x479e16=-0x1;for(let _0x52aaa3=0x0;_0x52aaa3<_0x1f2ed8[_0x29868b(0x10c2)][_0x29868b(0x7aa)];_0x52aaa3++){if(_0x2734d7>=_0x1f2ed8[_0x29868b(0x10c2)][_0x52aaa3]['time'])_0x479e16=_0x52aaa3;else break;}if(_0x479e16===_0x1f2ed8['currentLyricIndex'])return;_0x1f2ed8['currentLyricIndex']=_0x479e16,_0x4c53ed();const _0x495295=document[_0x29868b(0x89d)](_0x29868b(0x7cd));_0x495295&&(_0x479e16>-0x1&&_0x1f2ed8[_0x29868b(0x10c2)][_0x479e16]?_0x495295[_0x29868b(0xf12)]=_0x1f2ed8['parsedLyrics'][_0x479e16][_0x29868b(0xec9)]:_0x495295[_0x29868b(0xf12)]=_0x29868b(0x689));const _0x1fa951=document['getElementById'](_0x29868b(0x33d));_0x1fa951[_0x29868b(0x2f1)][_0x29868b(0x3ff)](_0x29868b(0x11e4))&&(_0x479e16>-0x1&&_0x1f2ed8[_0x29868b(0x10c2)][_0x479e16]?_0x1fa951['textContent']=_0x1f2ed8[_0x29868b(0x10c2)][_0x479e16][_0x29868b(0xec9)]:_0x1fa951['textContent']='♪');}function _0x4c53ed(_0x4fa6fd=![]){const _0x2f110c=_0x41eae2,_0x10cda3=_0x4fa6fd?_0x2f110c(0x7c3):_0x2f110c(0xab7),_0x1ffe2d=_0x4fa6fd?'#fullscreen-lyrics-container':_0x2f110c(0x79b),_0x21c0fe=document[_0x2f110c(0xd16)](_0x10cda3),_0x19285e=document[_0x2f110c(0xd16)](_0x1ffe2d);if(!_0x21c0fe||!_0x19285e)return;const _0x2de4eb=_0x21c0fe['querySelectorAll'](_0x2f110c(0x3b1));_0x2de4eb[_0x2f110c(0xd9a)](_0x5de2c4=>_0x5de2c4[_0x2f110c(0x2f1)][_0x2f110c(0x1247)]('active'));if(_0x1f2ed8[_0x2f110c(0x1241)]===-0x1){_0x21c0fe[_0x2f110c(0x68e)][_0x2f110c(0x9ab)]=_0x2f110c(0x1271);return;}const _0x5b203a=_0x21c0fe[_0x2f110c(0xd16)]('.lyric-line[data-index=\x22'+_0x1f2ed8[_0x2f110c(0x1241)]+'\x22]');if(_0x5b203a){_0x5b203a[_0x2f110c(0x2f1)][_0x2f110c(0x569)](_0x2f110c(0x8ea));const _0x5cf1c3=_0x19285e['offsetHeight'],_0x39e93b=_0x5cf1c3/2.2-_0x5b203a[_0x2f110c(0x8e3)]-_0x5b203a['offsetHeight']/0x2;_0x21c0fe[_0x2f110c(0x68e)][_0x2f110c(0x9ab)]=_0x2f110c(0xcec)+_0x39e93b+_0x2f110c(0x9b5);}}function _0x1c2ac5(_0x183f18){const _0x34d463=_0x41eae2;if(isNaN(_0x183f18)||_0x183f18<0x0)return'0:00';const _0x20a4b5=Math[_0x34d463(0x128a)](_0x183f18/0x3c),_0x568190=Math[_0x34d463(0x128a)](_0x183f18%0x3c);return _0x20a4b5+':'+String(_0x568190)['padStart'](0x2,'0');}let _0x46e281=0x0,_0xca57e1;function _0x4d0c38(){_0xca57e1&&cancelAnimationFrame(_0xca57e1);function _0x4ab2cd(){const _0x544796=_0x356e;if(!_0x1f2ed8[_0x544796(0xaa4)]||!_0x1e10c1[_0x544796(0x91c)])return;const _0x16ee4c=performance[_0x544796(0xf1a)](),_0x5e63c0=_0x1e10c1[_0x544796(0x133c)],_0x4728b1=_0x1e10c1[_0x544796(0x91c)],_0x312360=_0x5e63c0/_0x4728b1*0x64;document[_0x544796(0x89d)]('music-progress-fill')[_0x544796(0x68e)][_0x544796(0x42e)]=_0x312360+'%',_0x16ee4c-_0x46e281>0x3e8&&(document[_0x544796(0x89d)](_0x544796(0x827))[_0x544796(0xf12)]=_0x1c2ac5(_0x5e63c0),document[_0x544796(0x89d)](_0x544796(0xfc2))[_0x544796(0xf12)]=_0x1c2ac5(_0x4728b1),_0x46e281=_0x16ee4c),_0x2b1217(_0x5e63c0),_0xca57e1=requestAnimationFrame(_0x4ab2cd);}_0xca57e1=requestAnimationFrame(_0x4ab2cd);}function _0xe23b1b(){const _0x386dd6=_0x41eae2;if(!lastRawAiResponse){alert(_0x386dd6(0x70f));return;}const _0x5866c1=document[_0x386dd6(0x89d)](_0x386dd6(0x440)),_0x4f3fb3=document[_0x386dd6(0x89d)](_0x386dd6(0xbda));_0x4f3fb3[_0x386dd6(0x1ef)]='';const _0x3fb002=lastRawAiResponse[_0x386dd6(0x86c)](/{[^{}]*}/g);if(_0x3fb002)_0x3fb002[_0x386dd6(0xd9a)](_0x2f6918=>{const _0x483961=_0x386dd6;try{const _0x4fc610=JSON[_0x483961(0x2cb)](_0x2f6918),_0x33c4fb=JSON[_0x483961(0x465)](_0x4fc610,null,0x2),_0x33e467=_0x328eb7(_0x33c4fb);_0x4f3fb3[_0x483961(0x22f)](_0x33e467);}catch(_0x4f92c9){const _0x5b2a8a=_0x328eb7(_0x2f6918);_0x4f3fb3['appendChild'](_0x5b2a8a),console[_0x483961(0xac3)](_0x483961(0xadd),_0x2f6918);}});else{const _0x172322=_0x328eb7(lastRawAiResponse);_0x4f3fb3[_0x386dd6(0x22f)](_0x172322);}_0x5866c1['classList']['add'](_0x386dd6(0x11e4));}function _0x328eb7(_0xa31d5=''){const _0x54fb97=_0x41eae2,_0x11fdec=document[_0x54fb97(0x285)](_0x54fb97(0xb25));_0x11fdec[_0x54fb97(0x81c)]=_0x54fb97(0xc6d);const _0xee01b6={'text':{'type':_0x54fb97(0xec9),'content':_0x54fb97(0xc1a)},'sticker':{'type':'sticker','url':'https://...','meaning':_0x54fb97(0xe53)},'image':{'type':_0x54fb97(0x656),'description':_0x54fb97(0x58e)},'voice':{'type':_0x54fb97(0xff9),'content':_0x54fb97(0xc98)},'transfer':{'type':_0x54fb97(0x1075),'amount':5.2,'note':_0x54fb97(0x6f0)},'offline':{'type':_0x54fb97(0x910),'content':_0x54fb97(0x414)},'quote':{'type':'quote_reply','target_timestamp':0x499602d2,'reply_content':_0x54fb97(0x994)}};return _0x11fdec[_0x54fb97(0x1ef)]=_0x54fb97(0xf61)+_0xa31d5+_0x54fb97(0x76d)+JSON[_0x54fb97(0x465)](_0xee01b6[_0x54fb97(0xec9)])+_0x54fb97(0x64e)+JSON['stringify'](_0xee01b6[_0x54fb97(0x3c8)])+_0x54fb97(0x1128)+JSON['stringify'](_0xee01b6[_0x54fb97(0xbef)])+_0x54fb97(0x473)+JSON['stringify'](_0xee01b6['voice'])+_0x54fb97(0xffe)+JSON[_0x54fb97(0x465)](_0xee01b6[_0x54fb97(0x1075)])+_0x54fb97(0x25f)+JSON[_0x54fb97(0x465)](_0xee01b6['offline'])+_0x54fb97(0x8f8)+JSON['stringify'](_0xee01b6[_0x54fb97(0x1ff)])+_0x54fb97(0x3f5),_0x11fdec[_0x54fb97(0xd16)](_0x54fb97(0x66f))[_0x54fb97(0x1193)]('click',()=>{const _0x41d3c2=_0x54fb97;_0x11fdec[_0x41d3c2(0x1247)]();}),_0x11fdec['querySelectorAll'](_0x54fb97(0xbee))[_0x54fb97(0xd9a)](_0x351f33=>{const _0x3d1295=_0x54fb97;_0x351f33[_0x3d1295(0x1193)]('click',()=>{const _0x323eec=_0x3d1295,_0x4b2944=_0x351f33[_0x323eec(0xaaf)]['template'],_0x4c6a21=_0x11fdec['querySelector']('textarea');if(_0x4b2944&&_0x4c6a21)try{const _0x5ea410=JSON[_0x323eec(0x2cb)](_0x4b2944);_0x4c6a21['value']=JSON[_0x323eec(0x465)](_0x5ea410,null,0x2),_0x4c6a21[_0x323eec(0xbf6)]();}catch(_0x100ba3){console[_0x323eec(0x1fd)](_0x323eec(0x2ed),_0x100ba3);}});}),_0x11fdec;}async function _0x3181f9(){const _0x3874fd=_0x41eae2,_0x34e2bd=_0x5b873d['chats'][_0x5b873d[_0x3874fd(0xf96)]];if(!_0x34e2bd)return;const _0x5eed27=document[_0x3874fd(0x89d)](_0x3874fd(0xbda)),_0xf97e6=_0x5eed27[_0x3874fd(0x35f)]('textarea'),_0x58a418=Array[_0x3874fd(0x321)](_0xf97e6)[_0x3874fd(0x412)](_0x222344=>_0x222344[_0x3874fd(0x2f4)][_0x3874fd(0xc3a)]())[_0x3874fd(0x3d8)](Boolean);if(_0x58a418[_0x3874fd(0x7aa)]===0x0){_0x34e2bd[_0x3874fd(0x551)]=_0x34e2bd[_0x3874fd(0x551)]['filter'](_0xea6c60=>!lastResponseTimestamps['includes'](_0xea6c60[_0x3874fd(0x114e)])),await _0x1a6951['chats']['put'](_0x34e2bd),_0x5b89df(_0x5b873d[_0x3874fd(0xf96)]),_0x413d78(),document[_0x3874fd(0x89d)]('ai-response-editor-modal')[_0x3874fd(0x2f1)]['remove'](_0x3874fd(0x11e4)),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0x2a25c6=[];for(const _0x4b4296 of _0x58a418){try{const _0x5357aa=JSON[_0x3874fd(0x2cb)](_0x4b4296);_0x2a25c6['push'](_0x5357aa);}catch(_0x5f483c){console[_0x3874fd(0xac3)](_0x3874fd(0x382),_0x4b4296);}}_0x34e2bd[_0x3874fd(0x551)]=_0x34e2bd[_0x3874fd(0x551)][_0x3874fd(0x3d8)](_0x3f44a8=>!lastResponseTimestamps[_0x3874fd(0xced)](_0x3f44a8[_0x3874fd(0x114e)]));let _0x33fe42=[],_0x3577c1=Date[_0x3874fd(0xf1a)]();for(const _0x56622b of _0x2a25c6){if(!_0x56622b||typeof _0x56622b!==_0x3874fd(0x7af)||!_0x56622b['type']){console[_0x3874fd(0xac3)](_0x3874fd(0xf9f),_0x56622b);continue;}let _0x5b8a7c=null;const _0x859559={'role':_0x3874fd(0x1377),'senderName':_0x56622b[_0x3874fd(0xf74)]||_0x34e2bd['originalName'],'timestamp':_0x3577c1++};switch(_0x56622b['type']){case _0x3874fd(0xec9):_0x5b8a7c={..._0x859559,'content':String(_0x56622b['content']||_0x56622b[_0x3874fd(0x1288)])};break;case'sticker':{let _0xca0382=![];if(_0x56622b[_0x3874fd(0x11de)]&&_0x56622b[_0x3874fd(0xb5c)])_0x5b8a7c={..._0x859559,'type':_0x3874fd(0x3c8),'content':_0x56622b[_0x3874fd(0x11de)],'meaning':_0x56622b[_0x3874fd(0xb5c)]},console[_0x3874fd(0x471)](_0x3874fd(0xbb2)),_0xca0382=!![];else{if(_0x56622b['meaning']){const _0x365b83=_0x5b873d[_0x3874fd(0x210)][_0x3874fd(0x12f4)](_0x48b8fc=>_0x48b8fc[_0x3874fd(0xf74)]===_0x56622b[_0x3874fd(0xb5c)]);_0x365b83?(_0x5b8a7c={..._0x859559,'type':_0x3874fd(0x3c8),'content':_0x365b83[_0x3874fd(0x11de)],'meaning':_0x365b83[_0x3874fd(0xf74)]},console[_0x3874fd(0x471)](_0x3874fd(0xabc)),_0xca0382=!![]):(_0x5b8a7c={..._0x859559,'type':'text','content':_0x3874fd(0x507)+_0x56622b['meaning']+']'},console[_0x3874fd(0xac3)]('导演模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:',_0x56622b[_0x3874fd(0xb5c)]),_0xca0382=!![]);}else{if(_0x56622b[_0x3874fd(0x11de)]){_0x5b8a7c={..._0x859559,'type':_0x3874fd(0x3c8),'content':_0x56622b[_0x3874fd(0x11de)]};const _0x2f73d4=_0x5b873d[_0x3874fd(0x210)][_0x3874fd(0x12f4)](_0x339ed8=>_0x339ed8[_0x3874fd(0x11de)]===_0x56622b[_0x3874fd(0x11de)]);_0x5b8a7c['meaning']=_0x2f73d4?_0x2f73d4[_0x3874fd(0xf74)]:_0x3874fd(0x6a3),console[_0x3874fd(0x471)](_0x3874fd(0xc3e),_0x5b8a7c[_0x3874fd(0xb5c)]),_0xca0382=!![];}else{if(_0x56622b[_0x3874fd(0x28c)]&&typeof _0x56622b[_0x3874fd(0x28c)]===_0x3874fd(0x1224)&&_0x3b71b1[_0x3874fd(0xb80)](_0x56622b['content'])){_0x5b8a7c={..._0x859559,'type':_0x3874fd(0x3c8),'content':_0x56622b[_0x3874fd(0x28c)]};const _0x53b66b=_0x5b873d['userStickers'][_0x3874fd(0x12f4)](_0x246477=>_0x246477[_0x3874fd(0x11de)]===_0x56622b['content']);_0x5b8a7c['meaning']=_0x53b66b?_0x53b66b['name']:_0x3874fd(0x6a3),console[_0x3874fd(0x471)](_0x3874fd(0x56d),_0x5b8a7c[_0x3874fd(0xb5c)]),_0xca0382=!![];}}}}if(!_0xca0382){console[_0x3874fd(0x1fd)](_0x3874fd(0x2d6),_0x56622b);continue;}break;}case _0x3874fd(0x656):_0x5b8a7c={..._0x859559,'type':_0x3874fd(0x656),'content':_0x56622b['description']};break;case _0x3874fd(0xff9):_0x5b8a7c={..._0x859559,'type':_0x3874fd(0xff9),'content':_0x56622b[_0x3874fd(0x28c)]};break;case _0x3874fd(0x1075):_0x5b8a7c={..._0x859559,'type':_0x3874fd(0x1075),'amount':_0x56622b[_0x3874fd(0x10a6)],'note':_0x56622b[_0x3874fd(0xa17)],'receiverName':_0x56622b['receiver']||'我'};break;case _0x3874fd(0xcd9):_0x5b8a7c={..._0x859559,'type':_0x3874fd(0xcd9),'productInfo':_0x56622b[_0x3874fd(0xb3e)],'amount':_0x56622b[_0x3874fd(0x10a6)],'status':'pending','countdownEndTime':Date[_0x3874fd(0xf1a)]()+0xf*0x3c*0x3e8};break;case'offline_text':_0x5b8a7c={..._0x859559,..._0x56622b};break;case _0x3874fd(0xb32):{const _0x1932e8=_0x404de6[_0x34e2bd['id']];if(_0x1932e8){const _0x25d562=_0x1932e8['history'][_0x3874fd(0xceb)](_0x1e75fa=>_0x1e75fa[_0x3874fd(0xb3f)]===0x2);if(_0x25d562>-0x1){const _0x2983ee=_0x1932e8['history'][_0x25d562];_0x1932e8[_0x3874fd(0xb2a)][_0x2983ee['y']][_0x2983ee['x']]=0x0,_0x1932e8[_0x3874fd(0x551)][_0x3874fd(0x776)](_0x25d562,0x1),console['log']('导演模式悔棋：已撤销AI在\x20('+_0x2983ee['x']+',\x20'+_0x2983ee['y']+_0x3874fd(0xe36));}}const _0x1c29c3=parseInt(_0x56622b['x']),_0x30c263=parseInt(_0x56622b['y']);!isNaN(_0x1c29c3)&&!isNaN(_0x30c263)?_0xa18ee9({'x':_0x1c29c3,'y':_0x30c263},!![]):console[_0x3874fd(0xac3)](_0x3874fd(0x281),_0x56622b);continue;}case _0x3874fd(0x347):{if(!_0x34e2bd['isGroup']){_0x56622b[_0x3874fd(0x941)]&&(_0x34e2bd[_0x3874fd(0x253)]=String(_0x56622b['heartfelt_voice']));_0x56622b[_0x3874fd(0x116a)]&&(_0x34e2bd['randomJottings']=String(_0x56622b[_0x3874fd(0x116a)]));!Array['isArray'](_0x34e2bd[_0x3874fd(0x1152)])&&(_0x34e2bd[_0x3874fd(0x1152)]=[]);_0x34e2bd[_0x3874fd(0x1152)][_0x3874fd(0x138c)]({'heartfeltVoice':_0x34e2bd[_0x3874fd(0x253)],'randomJottings':_0x34e2bd[_0x3874fd(0x27e)],'timestamp':Date[_0x3874fd(0xf1a)]()});_0x34e2bd[_0x3874fd(0x1152)][_0x3874fd(0x7aa)]>0x32&&_0x34e2bd[_0x3874fd(0x1152)][_0x3874fd(0xcbe)]();const _0xe94ce3=_0x3874fd(0xbbc)+_0x34e2bd['heartfeltVoice']+_0x3874fd(0x2ad)+_0x34e2bd[_0x3874fd(0x27e)],_0x5af61c={'role':_0x3874fd(0x18c),'content':_0xe94ce3,'timestamp':Date[_0x3874fd(0xf1a)](),'isHidden':!![]};}continue;}case _0x3874fd(0x6cf):{const _0x1af649=_0x34e2bd[_0x3874fd(0x551)][_0x3874fd(0x12f4)](_0x583810=>_0x583810[_0x3874fd(0x114e)]===_0x56622b['target_timestamp']);let _0x1f4ec2=null;if(_0x1af649){let _0x308cad=_0x1af649[_0x3874fd(0xcfc)];_0x1af649[_0x3874fd(0xa57)]===_0x3874fd(0x116c)&&(_0x308cad=_0x34e2bd['isGroup']?_0x34e2bd[_0x3874fd(0xdb9)][_0x3874fd(0xc48)]||'我':_0x5b873d['qzoneSettings'][_0x3874fd(0x22a)]||_0x3874fd(0x1285)),_0x1f4ec2={'timestamp':_0x56622b['target_timestamp'],'senderName':_0x308cad,'content':String(_0x1af649[_0x3874fd(0x28c)]||'')};}else _0x1f4ec2={'timestamp':_0x56622b[_0x3874fd(0x36e)],'senderName':_0x3874fd(0x25e),'content':'原始消息已删除或不存在'};_0x5b8a7c={..._0x859559,'content':_0x56622b[_0x3874fd(0x22c)],'quote':_0x1f4ec2};break;}default:console[_0x3874fd(0xac3)](_0x3874fd(0x5f9),_0x56622b[_0x3874fd(0x48c)]);break;}_0x5b8a7c&&(_0x34e2bd[_0x3874fd(0x551)][_0x3874fd(0x138c)](_0x5b8a7c),_0x33fe42[_0x3874fd(0x138c)](_0x5b8a7c['timestamp']));}await _0x1a6951[_0x3874fd(0x667)]['put'](_0x34e2bd),_0x5b89df(_0x5b873d[_0x3874fd(0xf96)]),_0x413d78(),document['getElementById'](_0x3874fd(0x440))['classList'][_0x3874fd(0x1247)](_0x3874fd(0x11e4)),lastRawAiResponse=_0x58a418['join']('\x0a\x0a'),lastResponseTimestamps=_0x33fe42,await _0x532f76(_0x3874fd(0x1319),_0x3874fd(0xf35));}async function _0x4fa558(){const _0x1fe926=_0x41eae2;if(!_0x1cefba)return;const _0x50857c=0x2*0x3c*0x3e8,_0x477879=_0x1cefba,_0x58ba3b=Date[_0x1fe926(0xf1a)]();if(_0x58ba3b-_0x477879>_0x50857c){_0x5348af(),await _0x532f76(_0x1fe926(0x10de),_0x1fe926(0x48f));return;}await _0x14dcb6(_0x477879,!![]),_0x5348af();}async function _0x14dcb6(_0x1450f3,_0x4846f9){const _0x15ee62=_0x41eae2,_0x528e8c=_0x5b873d[_0x15ee62(0x667)][_0x5b873d['activeChatId']];if(!_0x528e8c)return;const _0x51f89b=_0x528e8c[_0x15ee62(0x551)][_0x15ee62(0x9d7)](_0x1c00dd=>_0x1c00dd[_0x15ee62(0x114e)]===_0x1450f3);if(_0x51f89b===-0x1)return;const _0x10cd68=_0x528e8c[_0x15ee62(0x551)][_0x51f89b],_0x324d37={'originalType':_0x10cd68['type']||_0x15ee62(0xec9),'originalContent':_0x10cd68['content'],'originalMeaning':_0x10cd68[_0x15ee62(0xb5c)],'originalQuote':_0x10cd68[_0x15ee62(0x1ff)]};_0x10cd68[_0x15ee62(0x48c)]=_0x15ee62(0xdc0),_0x10cd68[_0x15ee62(0x28c)]=_0x4846f9?_0x15ee62(0x227):'对方撤回了一条消息',_0x10cd68[_0x15ee62(0xda0)]=_0x324d37,delete _0x10cd68[_0x15ee62(0xb5c)],delete _0x10cd68['quote'];if(_0x4846f9){const _0x31a442=_0x528e8c[_0x15ee62(0x58c)]?_0x528e8c[_0x15ee62(0xdb9)]['myNickname']||'我':'我';let _0x1b61c5='';if(_0x324d37[_0x15ee62(0x8d7)]==='sticker')_0x1b61c5='[表情，含义:\x20'+(_0x324d37['originalMeaning']||'未知')+']';else _0x324d37[_0x15ee62(0x8d7)]==='ai_image'||_0x324d37[_0x15ee62(0x8d7)]===_0x15ee62(0x11f6)?_0x1b61c5=_0x15ee62(0x1320)+_0x324d37['originalContent']+']':_0x1b61c5='“'+String(_0x324d37['originalContent'])+'”';const _0xd6d24e={'role':_0x15ee62(0x18c),'content':_0x15ee62(0xff6)+_0x31a442+_0x15ee62(0x358)+_0x1b61c5+_0x15ee62(0xe2d),'timestamp':Date['now'](),'isHidden':!![]};_0x528e8c['history'][_0x15ee62(0x138c)](_0xd6d24e);}await _0x1a6951[_0x15ee62(0x667)][_0x15ee62(0xc0f)](_0x528e8c),_0x5b89df(_0x5b873d[_0x15ee62(0xf96)]),_0x4846f9&&(_0x413d78(),_0x2e3505());}async function _0x2d7414(){const _0xad5654=_0x41eae2;await _0x1f7649(),document[_0xad5654(0x89d)](_0xad5654(0xd1b))[_0xad5654(0x2f1)][_0xad5654(0x569)](_0xad5654(0x11e4));}async function _0x1f7649(){const _0x249fde=_0x41eae2,_0x26711c=document[_0x249fde(0x89d)](_0x249fde(0x1299)),_0x27bfd7=await _0x1a6951[_0x249fde(0xe8f)][_0x249fde(0xc2f)]();_0x26711c['innerHTML']='',_0x27bfd7[_0x249fde(0x7aa)]===0x0&&(_0x26711c[_0x249fde(0x1ef)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>'),_0x27bfd7['forEach'](_0x4f6e98=>{const _0x15ddc9=_0x249fde,_0x340ae3=document[_0x15ddc9(0x285)](_0x15ddc9(0xb25));_0x340ae3[_0x15ddc9(0x81c)]=_0x15ddc9(0xebb),_0x340ae3[_0x15ddc9(0x1ef)]=_0x15ddc9(0xa45)+_0x4f6e98[_0x15ddc9(0xf74)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x4f6e98['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x26711c[_0x15ddc9(0x22f)](_0x340ae3);});}async function _0x47670a(){const _0x1a653e=_0x41eae2,_0xd92782=document['getElementById'](_0x1a653e(0xd28)),_0xe2642=_0xd92782[_0x1a653e(0x2f4)][_0x1a653e(0xc3a)]();if(!_0xe2642){alert(_0x1a653e(0xb79));return;}const _0x4bbc4d=await _0x1a6951['worldBookCategories'][_0x1a653e(0x176)](_0x1a653e(0xf74))[_0x1a653e(0xb17)](_0xe2642)[_0x1a653e(0x2a6)]();if(_0x4bbc4d){alert(_0x1a653e(0xe5c)+_0xe2642+'\x22\x20已经存在了！');return;}await _0x1a6951[_0x1a653e(0xe8f)]['add']({'name':_0xe2642}),_0xd92782['value']='',await _0x1f7649();}async function _0x2e91c1(_0x4c5734){const _0x36fa53=_0x41eae2,_0x172d1d=await _0x4e2abc(_0x36fa53(0x3da),'删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？',{'confirmButtonClass':_0x36fa53(0xcd8)});if(_0x172d1d){await _0x1a6951[_0x36fa53(0xe8f)]['delete'](_0x4c5734);const _0xf6c0f9=await _0x1a6951[_0x36fa53(0x8a1)][_0x36fa53(0x176)](_0x36fa53(0xcb1))[_0x36fa53(0xb17)](_0x4c5734)[_0x36fa53(0xc2f)]();for(const _0x75ffc0 of _0xf6c0f9){_0x75ffc0[_0x36fa53(0xcb1)]=null,await _0x1a6951[_0x36fa53(0x8a1)][_0x36fa53(0xc0f)](_0x75ffc0);const _0x4df74b=_0x5b873d[_0x36fa53(0x8a1)][_0x36fa53(0x12f4)](_0x327861=>_0x327861['id']===_0x75ffc0['id']);if(_0x4df74b)_0x4df74b[_0x36fa53(0xcb1)]=null;}await _0x1f7649();}}async function _0x3c61b0(){const _0x1f6316=_0x41eae2;if(!_0x1cefba)return;const _0xcecc36=_0x1cefba;_0x5348af();const _0x598195=_0x5b873d[_0x1f6316(0x667)][_0x5b873d['activeChatId']],_0x5e483b=_0x598195['history'][_0x1f6316(0x12f4)](_0x528206=>_0x528206[_0x1f6316(0x114e)]===_0xcecc36);if(!_0x5e483b)return;let _0x1962fd=String(_0x5e483b['content']||'')[_0x1f6316(0x489)](0x0,0x32)+'...';if(_0x5e483b[_0x1f6316(0x48c)]===_0x1f6316(0x656))_0x1962fd=_0x1f6316(0x613)+_0x1962fd;const _0x4f7e5c=await _0x4e2abc(_0x1f6316(0x341),'确定要将以下消息发布到公告板吗？\x0a\x0a“'+_0x1962fd+'”',{'confirmText':_0x1f6316(0x33c)});if(_0x4f7e5c){const _0x30f533=_0x598195['settings'][_0x1f6316(0xc48)]||'我';!Array[_0x1f6316(0xbd6)](_0x598195[_0x1f6316(0x367)])&&(_0x598195[_0x1f6316(0x367)]=[]);const _0xc1db77={'id':_0x1f6316(0x6fc)+Date[_0x1f6316(0xf1a)](),'messageTimestamp':_0xcecc36,'publisher':_0x30f533,'publishedAt':Date[_0x1f6316(0xf1a)](),'isPinned':![]};_0x598195[_0x1f6316(0x367)][_0x1f6316(0x138c)](_0xc1db77);const _0x2ee293={'role':_0x1f6316(0x18c),'type':_0x1f6316(0xc7a),'content':_0x30f533+'\x20发布了一条新公告','timestamp':Date[_0x1f6316(0xf1a)]()};_0x598195[_0x1f6316(0x551)][_0x1f6316(0x138c)](_0x2ee293),await _0x1a6951[_0x1f6316(0x667)][_0x1f6316(0xc0f)](_0x598195),_0x58deee(_0x2ee293,_0x598195),_0x413d78(),await _0x532f76('成功','公告已发布！');}}async function _0x187280(){const _0x2b7ab1=_0x41eae2,_0x21b8bb=_0x5b873d[_0x2b7ab1(0x667)][_0x5b873d[_0x2b7ab1(0xf96)]],_0x39d7c5=_0x21b8bb[_0x2b7ab1(0x367)]||[];if(!_0x21b8bb||_0x39d7c5[_0x2b7ab1(0x7aa)]===0x0){_0x532f76('提示',_0x2b7ab1(0x1bc));return;}const _0x365a14=document['getElementById'](_0x2b7ab1(0x4a5));_0x365a14[_0x2b7ab1(0x1ef)]='',_0x39d7c5[_0x2b7ab1(0x2e3)]((_0x410060,_0x41cd69)=>(_0x41cd69[_0x2b7ab1(0x199)]?0x1:0x0)-(_0x410060[_0x2b7ab1(0x199)]?0x1:0x0));for(const _0x3ca000 of _0x39d7c5){const _0x4e3cb4=_0x21b8bb[_0x2b7ab1(0x551)]['find'](_0x595f80=>_0x595f80['timestamp']===_0x3ca000['messageTimestamp']),_0x37c099=document['createElement']('div');_0x37c099[_0x2b7ab1(0x81c)]='announcement-item-wrapper';if(_0x4e3cb4){const _0x19f2ef=await _0x1ed144(_0x4e3cb4,_0x21b8bb);_0x19f2ef&&_0x37c099[_0x2b7ab1(0x22f)](_0x19f2ef);}else _0x37c099[_0x2b7ab1(0x1ef)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>';_0x3ca000[_0x2b7ab1(0x199)]&&(_0x37c099[_0x2b7ab1(0x1ef)]+=_0x2b7ab1(0x449)),_0x37c099['innerHTML']+=_0x2b7ab1(0x1113)+_0x3ca000['id']+_0x2b7ab1(0x5c6),_0x365a14[_0x2b7ab1(0x22f)](_0x37c099);}document[_0x2b7ab1(0x89d)](_0x2b7ab1(0x621))[_0x2b7ab1(0x2f1)][_0x2b7ab1(0x569)](_0x2b7ab1(0x11e4));}let _0x434873=null;function _0x3fabd4(_0x1f8c6b){const _0x232d67=_0x41eae2;_0x434873=_0x1f8c6b;const _0x4e2a29=_0x5b873d[_0x232d67(0x667)][_0x5b873d[_0x232d67(0xf96)]],_0x438ad9=_0x4e2a29[_0x232d67(0x367)][_0x232d67(0x12f4)](_0x242af7=>_0x242af7['id']===_0x1f8c6b);if(!_0x438ad9)return;const _0x51765d=document[_0x232d67(0x89d)]('announcement-action-pin');_0x51765d['textContent']=_0x438ad9['isPinned']?_0x232d67(0xf93):'置顶公告',document[_0x232d67(0x89d)](_0x232d67(0x230))[_0x232d67(0x2f1)][_0x232d67(0x569)](_0x232d67(0x11e4));}async function _0xbdbfed(){const _0x2d488a=_0x41eae2;if(!_0x434873)return;const _0x52ca08=_0x5b873d[_0x2d488a(0x667)][_0x5b873d[_0x2d488a(0xf96)]],_0x4a3684=_0x52ca08['announcements'][_0x2d488a(0x12f4)](_0x545a9d=>_0x545a9d['id']===_0x434873);_0x4a3684&&(_0x4a3684[_0x2d488a(0x199)]=!_0x4a3684['isPinned'],await _0x1a6951[_0x2d488a(0x667)][_0x2d488a(0xc0f)](_0x52ca08),_0x187280()),document[_0x2d488a(0x89d)](_0x2d488a(0x230))['classList'][_0x2d488a(0x1247)]('visible');}async function _0x24f40f(){const _0x42189b=_0x41eae2;if(!_0x434873)return;const _0x3c3874=await _0x4e2abc(_0x42189b(0x3da),_0x42189b(0x795),{'confirmButtonClass':_0x42189b(0xcd8)});if(_0x3c3874){const _0x51387e=_0x5b873d[_0x42189b(0x667)][_0x5b873d[_0x42189b(0xf96)]];_0x51387e[_0x42189b(0x367)]=_0x51387e[_0x42189b(0x367)]['filter'](_0x171a23=>_0x171a23['id']!==_0x434873),await _0x1a6951['chats'][_0x42189b(0xc0f)](_0x51387e),_0x187280();}document[_0x42189b(0x89d)](_0x42189b(0x230))[_0x42189b(0x2f1)][_0x42189b(0x1247)](_0x42189b(0x11e4));}let _0x217004=![],_0x392e3f={'ai':null,'my':null};function _0x35e688(_0x498b64=_0x41eae2(0xde9)){const _0x4ddcc4=_0x41eae2,_0x378c54=document[_0x4ddcc4(0x89d)](_0x4ddcc4(0x1354));if(!_0x5b873d['activeChatId'])return;const _0x3ef786=_0x5b873d[_0x4ddcc4(0x667)][_0x5b873d[_0x4ddcc4(0xf96)]];_0x217004=_0x498b64===_0x4ddcc4(0x6fb);if(_0x217004){const _0x15cab2=_0x3ef786[_0x4ddcc4(0x5ab)]['find'](_0x5ac95d=>_0x5ac95d['id']===_0x251560);if(!_0x15cab2)return;_0x392e3f['my']=_0x15cab2['avatarFrame']||'',_0x491371(!![],_0x15cab2[_0x4ddcc4(0x12c8)],_0x15cab2[_0x4ddcc4(0x81d)]);}else _0x392e3f['ai']=_0x3ef786['settings'][_0x4ddcc4(0xeae)]||'',_0x392e3f['my']=_0x3ef786['settings']['myAvatarFrame']||'',_0x491371(![]);_0x378c54['classList'][_0x4ddcc4(0x569)]('visible');}function _0x491371(_0xb7bd78=![],_0x1296d5=null,_0x581c7d=null){const _0x5e834e=_0x41eae2,_0x3e62ab=document[_0x5e834e(0x89d)](_0x5e834e(0xed1)),_0x5d425e=document[_0x5e834e(0x89d)](_0x5e834e(0xde6)),_0x2833d1=_0x5b873d[_0x5e834e(0x667)][_0x5b873d[_0x5e834e(0xf96)]];_0x3e62ab[_0x5e834e(0x1ef)]='',_0x5d425e[_0x5e834e(0x1ef)]='',document[_0x5e834e(0xd16)](_0x5e834e(0x1211))[_0x5e834e(0x68e)]['display']=_0xb7bd78?_0x5e834e(0x10f2):_0x5e834e(0x66e),document[_0x5e834e(0x89d)](_0x5e834e(0x839))[_0x5e834e(0x68e)][_0x5e834e(0x126b)]='block',document[_0x5e834e(0x89d)]('my-frame-content')[_0x5e834e(0x68e)][_0x5e834e(0x126b)]=_0x5e834e(0x10f2),document[_0x5e834e(0x89d)](_0x5e834e(0x137f))[_0x5e834e(0x2f1)][_0x5e834e(0x569)](_0x5e834e(0x8ea)),document[_0x5e834e(0x89d)](_0x5e834e(0x7f2))['classList']['remove']('active');if(_0xb7bd78)_0x88819[_0x5e834e(0xd9a)](_0x21dcd9=>{const _0x5192eb=_0x5e834e,_0x135108=_0x5b4a94(_0x21dcd9,'my',_0x1296d5);_0x21dcd9[_0x5192eb(0x11de)]===_0x581c7d&&_0x135108[_0x5192eb(0x2f1)]['add'](_0x5192eb(0x335)),_0x3e62ab[_0x5192eb(0x22f)](_0x135108);});else{const _0x1d9ffb=_0x2833d1[_0x5e834e(0xdb9)][_0x5e834e(0xdd3)]||_0x265fcc,_0x4ad9fb=_0x2833d1[_0x5e834e(0xdb9)][_0x5e834e(0xd55)]||(_0x2833d1['isGroup']?_0x24462f:_0x265fcc);_0x88819[_0x5e834e(0xd9a)](_0x4ebadd=>{const _0x3683dd=_0x5e834e,_0x2887fe=_0x5b4a94(_0x4ebadd,'ai',_0x1d9ffb);if(_0x4ebadd[_0x3683dd(0x11de)]===_0x392e3f['ai'])_0x2887fe[_0x3683dd(0x2f1)][_0x3683dd(0x569)]('selected');_0x3e62ab[_0x3683dd(0x22f)](_0x2887fe);const _0x4d4fca=_0x5b4a94(_0x4ebadd,'my',_0x4ad9fb);if(_0x4ebadd[_0x3683dd(0x11de)]===_0x392e3f['my'])_0x4d4fca['classList'][_0x3683dd(0x569)](_0x3683dd(0x335));_0x5d425e[_0x3683dd(0x22f)](_0x4d4fca);});}}function _0x5b4a94(_0x98c13,_0x3fa537,_0x5dddf5){const _0x498c80=_0x41eae2,_0x167ac=document[_0x498c80(0x285)]('div');return _0x167ac[_0x498c80(0x81c)]=_0x498c80(0x3a3),_0x167ac[_0x498c80(0xaaf)][_0x498c80(0x1162)]=_0x98c13[_0x498c80(0x11de)],_0x167ac[_0x498c80(0x104c)]=_0x98c13[_0x498c80(0xf74)],_0x167ac[_0x498c80(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x5dddf5+_0x498c80(0x10a0)+(_0x98c13['url']?_0x498c80(0x477)+_0x98c13[_0x498c80(0x11de)]+_0x498c80(0xe42):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x167ac[_0x498c80(0x1193)](_0x498c80(0x12a5),()=>{const _0x186f93=_0x498c80;_0x392e3f[_0x3fa537]=_0x98c13['url'];const _0x2b59b3=_0x3fa537==='ai'?document[_0x186f93(0x89d)](_0x186f93(0xed1)):document['getElementById'](_0x186f93(0xde6));_0x2b59b3['querySelectorAll']('.frame-item')[_0x186f93(0xd9a)](_0x58f7c5=>_0x58f7c5[_0x186f93(0x2f1)][_0x186f93(0x1247)](_0x186f93(0x335))),_0x167ac[_0x186f93(0x2f1)]['add'](_0x186f93(0x335));}),_0x167ac;}async function _0x85357e(){const _0x307f8e=_0x41eae2;if(!_0x5b873d[_0x307f8e(0xf96)])return;const _0x5eadd5=_0x5b873d[_0x307f8e(0x667)][_0x5b873d[_0x307f8e(0xf96)]];if(_0x217004){const _0x57a1b4=_0x5eadd5[_0x307f8e(0x5ab)][_0x307f8e(0x12f4)](_0x36f951=>_0x36f951['id']===_0x251560);_0x57a1b4&&(_0x57a1b4[_0x307f8e(0x81d)]=_0x392e3f['my']);}else _0x5eadd5[_0x307f8e(0xdb9)][_0x307f8e(0xeae)]=_0x392e3f['ai'],_0x5eadd5[_0x307f8e(0xdb9)][_0x307f8e(0x1e0)]=_0x392e3f['my'];await _0x1a6951['chats'][_0x307f8e(0xc0f)](_0x5eadd5);if(!_0x217004&&!_0x5eadd5[_0x307f8e(0x58c)]){const _0x85967e=_0x5eadd5['id'];for(const _0x250e56 of Object[_0x307f8e(0x4b5)](_0x5b873d[_0x307f8e(0x667)])){if(_0x250e56[_0x307f8e(0x58c)]&&_0x250e56[_0x307f8e(0x5ab)]){const _0x47cb47=_0x250e56[_0x307f8e(0x5ab)][_0x307f8e(0x12f4)](_0x3e9ae1=>_0x3e9ae1['id']===_0x85967e);_0x47cb47&&(_0x47cb47['avatarFrame']=_0x5eadd5[_0x307f8e(0xdb9)][_0x307f8e(0xeae)],await _0x1a6951['chats'][_0x307f8e(0xc0f)](_0x250e56),console['log'](_0x307f8e(0xe34)+_0x85967e+'\x20的头像框到群聊\x20\x22'+_0x250e56[_0x307f8e(0xf74)]+'\x22'));}}}document[_0x307f8e(0x89d)]('avatar-frame-modal')[_0x307f8e(0x2f1)][_0x307f8e(0x1247)](_0x307f8e(0x11e4)),_0x5b89df(_0x5b873d[_0x307f8e(0xf96)]),alert('头像框已保存并同步！'),_0x217004=![];}function _0x3d8c90(){const _0x5c9d4d=_0x41eae2;_0x3c91a0=!_0x3c91a0;const _0x2adfa1=document[_0x5c9d4d(0x89d)](_0x5c9d4d(0x8e1)),_0x4a58f7=document[_0x5c9d4d(0x89d)]('frame-action-bar'),_0x5659bb=document[_0x5c9d4d(0x89d)](_0x5c9d4d(0xd12));document['querySelectorAll']('.frame-grid')[_0x5c9d4d(0xd9a)](_0x496749=>{const _0x48ef24=_0x5c9d4d;_0x496749[_0x48ef24(0x2f1)][_0x48ef24(0x73b)](_0x48ef24(0x992),_0x3c91a0);}),_0x3c91a0?(_0x2adfa1[_0x5c9d4d(0xf12)]='完成',_0x4a58f7[_0x5c9d4d(0x68e)]['display']=_0x5c9d4d(0x66e),_0x12474b[_0x5c9d4d(0x1073)](),_0x5659bb[_0x5c9d4d(0x1b0)]=![],_0x4209e0()):(_0x2adfa1[_0x5c9d4d(0xf12)]='管理',_0x4a58f7[_0x5c9d4d(0x68e)]['display']='none',document[_0x5c9d4d(0x35f)](_0x5c9d4d(0xb4f))[_0x5c9d4d(0xd9a)](_0x522dcb=>{const _0x3a427a=_0x5c9d4d;_0x522dcb[_0x3a427a(0x2f1)][_0x3a427a(0x1247)](_0x3a427a(0x335));}));}function _0x4209e0(){const _0x39c791=_0x41eae2,_0x1be9f0=document[_0x39c791(0x89d)](_0x39c791(0x1070));_0x1be9f0[_0x39c791(0xf12)]=_0x39c791(0x618)+_0x12474b['size']+')';}function _0x2a52e0(){const _0x1e6605=_0x41eae2,_0x4df530=document[_0x1e6605(0x89d)]('select-all-frames-checkbox')[_0x1e6605(0x1b0)],_0x1ac7aa=document['querySelector'](_0x1e6605(0x819));if(!_0x1ac7aa)return;_0x1ac7aa['querySelectorAll'](_0x1e6605(0x734))['forEach'](_0x129714=>{const _0x234940=_0x1e6605,_0x17b643=parseInt(_0x129714[_0x234940(0xd16)](_0x234940(0x521))[_0x234940(0xaaf)]['id']);if(isNaN(_0x17b643))return;_0x129714['classList'][_0x234940(0x73b)](_0x234940(0x335),_0x4df530),_0x4df530?_0x12474b['add'](_0x17b643):_0x12474b[_0x234940(0x684)](_0x17b643);}),_0x4209e0();}async function _0x53942b(){const _0x220d4e=_0x41eae2;if(_0x12474b[_0x220d4e(0x746)]===0x0)return;const _0x2cf11c=await _0x4e2abc(_0x220d4e(0x3da),_0x220d4e(0x9eb)+_0x12474b[_0x220d4e(0x746)]+_0x220d4e(0x57a),{'confirmButtonClass':_0x220d4e(0xcd8)});if(_0x2cf11c){const _0x2e1da5=[..._0x12474b];await _0x1a6951[_0x220d4e(0x1343)][_0x220d4e(0x6a7)](_0x2e1da5),_0x3d8c90(),_0x491371(_0x217004),await _0x532f76(_0x220d4e(0xcf9),_0x220d4e(0x38e));}}function _0x446f71(_0x5cbfbb){const _0x50b95c=_0x41eae2,_0x1fe178=document[_0x50b95c(0x89d)](_0x50b95c(0xb71));_0x1fe178&&(_0x1fe178[_0x50b95c(0x1ef)]=_0x5cbfbb||'');}async function _0x1607b5(_0xe978eb){const _0x74d9ef=_0x41eae2;if(!_0x1f2ed8['isActive']||!_0x1f2ed8[_0x74d9ef(0xf96)])return;const _0x4e9fd1=_0x5b873d[_0x74d9ef(0x667)][_0x1f2ed8[_0x74d9ef(0xf96)]];if(!_0x4e9fd1)return;const _0x2fc04b=_0x4e9fd1[_0x74d9ef(0x58c)]?_0x4e9fd1[_0x74d9ef(0xdb9)][_0x74d9ef(0xc48)]||'我':'我',_0x2e4135=_0x74d9ef(0x1029)+_0x2fc04b+')\x20'+_0xe978eb+']',_0x49460b={'role':_0x74d9ef(0x18c),'content':_0x2e4135,'timestamp':Date[_0x74d9ef(0xf1a)](),'isHidden':!![]};_0x4e9fd1[_0x74d9ef(0x551)][_0x74d9ef(0x138c)](_0x49460b),await _0x1a6951[_0x74d9ef(0x667)][_0x74d9ef(0xc0f)](_0x4e9fd1);}async function _0x9deaed(){const _0x5bf609=_0x41eae2;if(_0x2b125e['size']===0x0)return;const _0x2d9334=_0x5b873d[_0x5bf609(0x667)][_0x5b873d[_0x5bf609(0xf96)]];if(!_0x2d9334)return;const _0x4f8589=document[_0x5bf609(0x89d)](_0x5bf609(0x1317)),_0x359632=_0x4f8589[_0x5bf609(0xf12)];_0x4f8589[_0x5bf609(0xf12)]=_0x5bf609(0x2c4),_0x4f8589[_0x5bf609(0x3f7)]=!![];const _0x450d02=document['createElement'](_0x5bf609(0xb25)),_0xfabfd8=document[_0x5bf609(0x89d)]('phone-screen');_0x450d02[_0x5bf609(0x68e)][_0x5bf609(0x42e)]=_0xfabfd8[_0x5bf609(0xf13)]+'px',_0x450d02[_0x5bf609(0x68e)][_0x5bf609(0x927)]=_0x5bf609(0x40a),_0x450d02[_0x5bf609(0x68e)][_0x5bf609(0x113d)]=_0x5bf609(0xd90),_0x450d02['style'][_0x5bf609(0x1004)]=_0x5bf609(0xd90),_0x450d02['style'][_0x5bf609(0x126b)]=_0x5bf609(0x66e),_0x450d02[_0x5bf609(0x68e)][_0x5bf609(0x8c4)]=_0x5bf609(0xac2),_0x450d02[_0x5bf609(0x68e)][_0x5bf609(0x84a)]=_0x5bf609(0xd71);const _0x2c5ae4=document['getElementById'](_0x5bf609(0x87f));_0x450d02[_0x5bf609(0x68e)]['backgroundImage']=_0x2c5ae4[_0x5bf609(0x68e)][_0x5bf609(0x1d4)],_0x450d02[_0x5bf609(0x68e)][_0x5bf609(0x96c)]=_0x2c5ae4[_0x5bf609(0x68e)][_0x5bf609(0x96c)]||(document[_0x5bf609(0x89d)](_0x5bf609(0x34e))['classList'][_0x5bf609(0x3ff)](_0x5bf609(0xd8e))?_0x5bf609(0x5c8):_0x5bf609(0x1022));const _0x567173=document[_0x5bf609(0x285)](_0x5bf609(0x68e));_0x567173[_0x5bf609(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x5bf609(0xb0d)][_0x5bf609(0x22f)](_0x567173);try{const _0x52454f=_0x2c5ae4[_0x5bf609(0xd16)](_0x5bf609(0xa56))[_0x5bf609(0xf2a)](!![]);_0x52454f['classList'][_0x5bf609(0x569)]('cloned-header');const _0x1214d4=document['createElement'](_0x5bf609(0xb25)),_0x28ebc8=document['getElementById']('chat-messages');_0x1214d4[_0x5bf609(0x68e)][_0x5bf609(0x126b)]=_0x5bf609(0x66e),_0x1214d4[_0x5bf609(0x68e)]['flexDirection']=_0x5bf609(0xac2),_0x1214d4[_0x5bf609(0x68e)][_0x5bf609(0x1c7)]='20px',_0x1214d4[_0x5bf609(0x68e)][_0x5bf609(0xb21)]='10px\x2015px\x2020px\x2015px',_0x1214d4[_0x5bf609(0x68e)][_0x5bf609(0x42e)]=_0x5bf609(0x94e),_0x1214d4[_0x5bf609(0x68e)][_0x5bf609(0x6ee)]=_0x5bf609(0x10a9),_0x1214d4[_0x5bf609(0xaaf)][_0x5bf609(0x85e)]=_0x28ebc8[_0x5bf609(0xaaf)][_0x5bf609(0x85e)],_0x1214d4[_0x5bf609(0x68e)][_0x5bf609(0xdcf)]('--chat-font-size',_0x28ebc8['style']['getPropertyValue'](_0x5bf609(0x1d7)));const _0x13cc05=_0x2c5ae4[_0x5bf609(0xd16)]('#chat-input-area')[_0x5bf609(0xf2a)](!![]),_0x1ca425=[..._0x2b125e]['sort']((_0x4cbf28,_0x1fb461)=>_0x4cbf28-_0x1fb461);_0x1ca425[_0x5bf609(0xd9a)](_0x3b3627=>{const _0x2c0bf1=_0x5bf609,_0x37a365=document['querySelector'](_0x2c0bf1(0x806)+_0x3b3627+'\x22]');if(_0x37a365){const _0x2f9224=_0x37a365[_0x2c0bf1(0x53a)]('.message-wrapper');_0x2f9224&&_0x1214d4[_0x2c0bf1(0x22f)](_0x2f9224[_0x2c0bf1(0xf2a)](!![]));}}),_0x450d02[_0x5bf609(0x22f)](_0x52454f),_0x450d02[_0x5bf609(0x22f)](_0x1214d4),_0x450d02[_0x5bf609(0x22f)](_0x13cc05),document[_0x5bf609(0x259)][_0x5bf609(0x22f)](_0x450d02);const _0xa38358=Array['from'](_0x450d02['getElementsByTagName'](_0x5bf609(0xc40))),_0x3a0160=_0xa38358[_0x5bf609(0x412)](_0x662b97=>new Promise((_0x47ec31,_0x5c61d8)=>{const _0x12a59b=_0x5bf609;if(_0x662b97[_0x12a59b(0x9e3)][_0x12a59b(0x1222)](_0x12a59b(0xbe3))){_0x47ec31();return;}const _0x56e702=new Image();_0x56e702[_0x12a59b(0x5fb)]=_0x12a59b(0x565),_0x56e702[_0x12a59b(0x736)]=_0x47ec31,_0x56e702[_0x12a59b(0x1010)]=_0x47ec31,_0x56e702[_0x12a59b(0x9e3)]=_0x662b97[_0x12a59b(0x9e3)];}));await Promise[_0x5bf609(0x863)](_0x3a0160);const _0x2e130a=await html2canvas(_0x450d02,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window[_0x5bf609(0xabf)]||0x2});_0x2e130a[_0x5bf609(0x952)](function(_0x5498fb){const _0x5989de=_0x5bf609,_0x43511e=URL[_0x5989de(0xfc3)](_0x5498fb),_0x415dd6=document[_0x5989de(0x285)]('a');_0x415dd6[_0x5989de(0xb93)]=_0x5989de(0x1338)+_0x2d9334[_0x5989de(0xf74)]+'-'+Date[_0x5989de(0xf1a)]()+'.png',_0x415dd6[_0x5989de(0xab6)]=_0x43511e,document['body'][_0x5989de(0x22f)](_0x415dd6),_0x415dd6[_0x5989de(0x12a5)](),document[_0x5989de(0x259)][_0x5989de(0x1326)](_0x415dd6),URL[_0x5989de(0xa1c)](_0x43511e);},_0x5bf609(0x572));}catch(_0x6c2ef4){console['error']('长截图生成失败:',_0x6c2ef4),await _0x532f76(_0x5bf609(0x1020),_0x5bf609(0xf95));}finally{document[_0x5bf609(0x259)]['removeChild'](_0x450d02),document[_0x5bf609(0xb0d)][_0x5bf609(0x1326)](_0x567173),_0x4f8589[_0x5bf609(0xf12)]=_0x359632,_0x4f8589['disabled']=![],_0x4ec1fb();}}function _0x55b8e7(_0x5b2f09){const _0x3077e4=_0x41eae2;if(!_0x5b2f09||typeof _0x5b2f09!==_0x3077e4(0x1224))return'';return _0x5b2f09=_0x5b2f09[_0x3077e4(0xfbf)](/!h\{(.*?)\}/g,'<span\x20class=\x22diary-highlight\x22>$1</span>'),_0x5b2f09=_0x5b2f09[_0x3077e4(0xfbf)](/!u\{(.*?)\}/g,_0x3077e4(0xfb3)),_0x5b2f09=_0x5b2f09[_0x3077e4(0xfbf)](/!e\{(.*?)\}/g,_0x3077e4(0xad3)),_0x5b2f09=_0x5b2f09[_0x3077e4(0xfbf)](/!w\{(.*?)\}/g,_0x3077e4(0x90c)),_0x5b2f09=_0x5b2f09['replace'](/!m\{(.*?)\}/g,'<span\x20class=\x22diary-messy\x22>$1</span>'),_0x5b2f09=_0x5b2f09['replace'](/\|\|(.*?)\|\|/g,'<span\x20class=\x22spoiler\x22>$1</span>'),_0x5b2f09=_0x5b2f09['replace'](/\*\*(.*?)\*\*/g,_0x3077e4(0x6b9)),_0x5b2f09=_0x5b2f09[_0x3077e4(0xfbf)](/\~\~(.*?)\~\~/g,_0x3077e4(0xf7e)),_0x5b2f09=_0x5b2f09['replace'](/\*(.*?)\*/g,_0x3077e4(0x1332)),_0x5b2f09;}async function _0x56b1bd(){const _0x862937=_0x41eae2;console[_0x862937(0x471)](_0x862937(0x11ec));let _0x5073ba=0x0;const _0x4db93a=Object[_0x862937(0x4b5)](_0x5b873d[_0x862937(0x667)]);for(const _0x3de3ad of _0x4db93a){let _0x468b31=![];for(const _0x351426 of _0x3de3ad[_0x862937(0x551)]){_0x351426[_0x862937(0x48c)]===_0x862937(0x675)&&_0x351426['packetType']===_0x862937(0xfc5)&&_0x351426[_0x862937(0xa57)]===_0x862937(0x1377)&&_0x351426['hasOwnProperty'](_0x862937(0x392))&&!_0x351426[_0x862937(0x42c)](_0x862937(0xb12))&&(_0x351426[_0x862937(0xb12)]=_0x351426[_0x862937(0x392)],delete _0x351426[_0x862937(0x392)],_0x468b31=!![],_0x5073ba++);}_0x468b31&&(console[_0x862937(0x471)](_0x862937(0x110f)+_0x3de3ad['name']+_0x862937(0x2ae)),await _0x1a6951[_0x862937(0x667)][_0x862937(0xc0f)](_0x3de3ad));}_0x5073ba>0x0?(console[_0x862937(0x471)](_0x862937(0xfdc)+_0x5073ba+_0x862937(0x1136)),alert(_0x862937(0x67e)+_0x5073ba+_0x862937(0x131c)),location[_0x862937(0xede)]()):console[_0x862937(0x471)](_0x862937(0x12c7));}function _0xdae43c(_0x4cefef){const _0x29021a=_0x41eae2,_0x2b8aef=_0x5b873d[_0x29021a(0x667)][_0x4cefef];if(!_0x2b8aef||_0x2b8aef[_0x29021a(0x58c)])return;document[_0x29021a(0x89d)](_0x29021a(0xbe1))[_0x29021a(0xf12)]=_0x2b8aef[_0x29021a(0x253)]||_0x29021a(0x1046),document[_0x29021a(0x89d)](_0x29021a(0x680))[_0x29021a(0xf12)]=_0x2b8aef['randomJottings']||_0x29021a(0x1046);const _0x1a2d9f=document[_0x29021a(0x89d)](_0x29021a(0x1297));_0x1a2d9f[_0x29021a(0x2f1)][_0x29021a(0x569)]('visible');}function _0x4485ad(){const _0x191d51=_0x41eae2;document[_0x191d51(0x89d)]('profile-main-content')[_0x191d51(0x68e)][_0x191d51(0x126b)]=_0x191d51(0x10f2),document['getElementById'](_0x191d51(0x12f8))['style'][_0x191d51(0x126b)]=_0x191d51(0x66e),_0x29fdd3();}function _0x3178c9(){const _0x4b6ac6=_0x41eae2;document[_0x4b6ac6(0x89d)]('profile-thoughts-history-view')[_0x4b6ac6(0x68e)][_0x4b6ac6(0x126b)]=_0x4b6ac6(0x10f2),document[_0x4b6ac6(0x89d)](_0x4b6ac6(0xfd7))[_0x4b6ac6(0x68e)][_0x4b6ac6(0x126b)]=_0x4b6ac6(0x66e);}function _0x29fdd3(){const _0x291a44=_0x41eae2,_0x143b75=document[_0x291a44(0x89d)](_0x291a44(0x809)),_0x2a82e7=_0x5b873d['chats'][_0x5b873d[_0x291a44(0xf96)]];_0x143b75['innerHTML']='';if(!_0x2a82e7||!_0x2a82e7[_0x291a44(0x1152)]||_0x2a82e7[_0x291a44(0x1152)][_0x291a44(0x7aa)]===0x0){_0x143b75[_0x291a44(0x1ef)]=_0x291a44(0x126e);return;}const _0x34e20c=[..._0x2a82e7['thoughtsHistory']][_0x291a44(0x854)](),_0x35d317=_0x34e20c['slice'](0x0,_0x93b741);_0x35d317[_0x291a44(0xd9a)](_0xb5313=>{const _0x988174=_0x291a44,_0x1640dc=_0x273186(_0xb5313);_0x143b75[_0x988174(0x22f)](_0x1640dc);}),_0x59fed2=_0x35d317[_0x291a44(0x7aa)],_0x34e20c[_0x291a44(0x7aa)]>_0x59fed2&&appendLoadMoreThoughtsButton(_0x143b75);}async function _0x113155(){const _0x1951dc=_0x41eae2;if(_0x4177cd)return;_0x4177cd=!![];const _0x52f185=document[_0x1951dc(0x89d)](_0x1951dc(0x809)),_0x3ecbb9=_0x5b873d[_0x1951dc(0x667)][_0x5b873d[_0x1951dc(0xf96)]];if(!_0x3ecbb9){_0x4177cd=![];return;}_0x9ce0b2(_0x52f185,_0x1951dc(0xc74)),await new Promise(_0x5099b0=>setTimeout(_0x5099b0,0x1f4));const _0x1a697b=[..._0x3ecbb9[_0x1951dc(0x1152)]]['reverse'](),_0x27ef31=_0x1a697b[_0x1951dc(0x7aa)],_0x581c9c=_0x59fed2,_0x29f3f7=_0x59fed2+_0x93b741,_0x2d319b=_0x1a697b['slice'](_0x581c9c,_0x29f3f7);_0x216cac(_0x52f185),_0x2d319b[_0x1951dc(0xd9a)](_0x3cefc1=>{const _0x1f4511=_0x1951dc,_0x1c4a3b=_0x273186(_0x3cefc1);_0x52f185[_0x1f4511(0x22f)](_0x1c4a3b);}),_0x59fed2+=_0x2d319b['length'],_0x4177cd=![];}function _0x273186(_0x2e824e){const _0x5dd3ee=_0x41eae2,_0x582459=document[_0x5dd3ee(0x285)](_0x5dd3ee(0xb25));_0x582459['className']=_0x5dd3ee(0xff2);const _0x5e101f=new Date(_0x2e824e[_0x5dd3ee(0x114e)]),_0xd6eb82=_0x5e101f['getFullYear']()+'-'+String(_0x5e101f[_0x5dd3ee(0x86f)]()+0x1)[_0x5dd3ee(0x4d8)](0x2,'0')+'-'+String(_0x5e101f['getDate']())[_0x5dd3ee(0x4d8)](0x2,'0')+'\x20'+String(_0x5e101f[_0x5dd3ee(0x9bb)]())[_0x5dd3ee(0x4d8)](0x2,'0')+':'+String(_0x5e101f['getMinutes']())[_0x5dd3ee(0x4d8)](0x2,'0');return _0x582459[_0x5dd3ee(0x1ef)]=_0x5dd3ee(0xd15)+_0x2e824e['timestamp']+_0x5dd3ee(0xe56)+_0xd6eb82+_0x5dd3ee(0x826)+_0x2e824e[_0x5dd3ee(0x253)]+_0x5dd3ee(0xc56)+_0x2e824e[_0x5dd3ee(0x27e)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x582459;}async function _0x86773a(_0x2b2fb8){const _0x5ed424=_0x41eae2,_0x1fa9f7=_0x2b2fb8[_0x5ed424(0x225)]['files'][0x0];if(!_0x1fa9f7)return;try{let _0xb62527,_0x5f379a=null;if(_0x1fa9f7[_0x5ed424(0xf74)][_0x5ed424(0x77a)](_0x5ed424(0x90d))){const _0x53a11f=await _0x1fa9f7['text']();_0xb62527=JSON['parse'](_0x53a11f);}else{if(_0x1fa9f7['name'][_0x5ed424(0x77a)](_0x5ed424(0x6c6))){const _0x327510=await _0x1fa9f7[_0x5ed424(0x4a9)]();_0xb62527=await _0x440e37(_0x327510),_0x5f379a=await new Promise(_0x1f75aa=>{const _0x35f668=_0x5ed424,_0x4cab2=new FileReader();_0x4cab2[_0x35f668(0x736)]=()=>_0x1f75aa(_0x4cab2[_0x35f668(0x9dc)]),_0x4cab2[_0x35f668(0x5b4)](_0x1fa9f7);});}else throw new Error(_0x5ed424(0x11fe));}await _0x4065cc(_0xb62527,_0x5f379a);}catch(_0x2cbcea){console[_0x5ed424(0x1fd)](_0x5ed424(0x403),_0x2cbcea),await _0x532f76(_0x5ed424(0x53d),'无法解析角色卡文件。\x0a错误:\x20'+_0x2cbcea[_0x5ed424(0x1288)]);}finally{_0x2b2fb8[_0x5ed424(0x225)][_0x5ed424(0x2f4)]=null;}}function _0x440e37(_0x19b7bb){return new Promise((_0x2e0c05,_0x1c2e3d)=>{const _0x3bb1f0=_0x356e,_0x479bc2=new DataView(_0x19b7bb);if(_0x479bc2[_0x3bb1f0(0xdcb)](0x0)!==0x89504e47||_0x479bc2[_0x3bb1f0(0xdcb)](0x4)!==0xd0a1a0a)return _0x1c2e3d(new Error('文件不是一个有效的PNG。'));let _0x28c568=0x8;const _0x3ccc8a=new TextDecoder();while(_0x28c568<_0x479bc2['byteLength']){const _0x59b2ae=_0x479bc2['getUint32'](_0x28c568),_0x2c9f2d=_0x3ccc8a['decode'](_0x19b7bb[_0x3bb1f0(0xdd0)](_0x28c568+0x4,_0x28c568+0x8));if(_0x2c9f2d===_0x3bb1f0(0x38f)){const _0x5c5948=new Uint8Array(_0x19b7bb,_0x28c568+0x8,_0x59b2ae),_0x22b358=_0x5c5948[_0x3bb1f0(0x37c)](0x0);if(_0x22b358!==-0x1){const _0x52fd14=_0x3ccc8a[_0x3bb1f0(0xe22)](_0x5c5948[_0x3bb1f0(0xdd0)](0x0,_0x22b358));if(_0x52fd14===_0x3bb1f0(0x488)){const _0x378398=_0x3ccc8a['decode'](_0x5c5948[_0x3bb1f0(0xdd0)](_0x22b358+0x1));try{const _0x25abb5=atob(_0x378398),_0x26f8b7=new Uint8Array(_0x25abb5[_0x3bb1f0(0x7aa)]);for(let _0x2e37ce=0x0;_0x2e37ce<_0x25abb5['length'];_0x2e37ce++){_0x26f8b7[_0x2e37ce]=_0x25abb5[_0x3bb1f0(0x11eb)](_0x2e37ce);}const _0x570b9a=new TextDecoder(_0x3bb1f0(0xee7))['decode'](_0x26f8b7);_0x2e0c05(JSON[_0x3bb1f0(0x2cb)](_0x570b9a));return;}catch(_0xd587b2){return _0x1c2e3d(new Error('在PNG中找到角色数据，但解码或解析失败。错误:\x20'+_0xd587b2['message']));}}}}_0x28c568+=0x4+0x4+_0x59b2ae+0x4;}_0x1c2e3d(new Error('在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。'));});}function _0x201779(_0x3ad248){const _0x493246=_0x41eae2;if(_0x3ad248[_0x493246(0xd98)]?.[_0x493246(0x125e)]?.[_0x493246(0xa7f)]?.[_0x493246(0x7aa)]>0x0)return console[_0x493246(0x471)](_0x493246(0x15c)),_0x3ad248['data'][_0x493246(0x125e)][_0x493246(0xa7f)];if(_0x3ad248[_0x493246(0xff4)]?.[_0x493246(0x125e)]?.[_0x493246(0xa7f)]?.[_0x493246(0x7aa)]>0x0)return console[_0x493246(0x471)](_0x493246(0x969)),_0x3ad248[_0x493246(0xff4)]['character_book'][_0x493246(0xa7f)];if(_0x3ad248['data']?.[_0x493246(0xff4)]?.[_0x493246(0x125e)]?.['entries']?.[_0x493246(0x7aa)]>0x0)return console[_0x493246(0x471)]('诊断：在\x20data.extensions.character_book\x20中找到世界书。'),_0x3ad248[_0x493246(0xd98)]['extensions']['character_book']['entries'];const _0x456d14=[_0x493246(0x125e),_0x493246(0xd69),_0x493246(0xeb9),_0x493246(0x4ca)];for(const _0x584b7a of _0x456d14){if(_0x3ad248[_0x584b7a]?.['entries']?.[_0x493246(0x7aa)]>0x0)return console[_0x493246(0x471)](_0x493246(0x12e5)+_0x584b7a+_0x493246(0x16d)),_0x3ad248[_0x584b7a]['entries'];}return console[_0x493246(0x471)](_0x493246(0x7b4)),null;}async function _0x4065cc(_0x3856d3,_0xaf3bb0=null){const _0x153d8f=_0x41eae2,_0x4237a8=_0x3856d3[_0x153d8f(0xd98)]||_0x3856d3;if(!_0x4237a8['name'])throw new Error(_0x153d8f(0x529));let _0x46c103=null;const _0x11cc14=_0x201779(_0x3856d3);if(_0x11cc14){const _0x22d3e8=_0x11cc14[_0x153d8f(0x3d8)](_0x268e61=>_0x268e61[_0x153d8f(0x104e)]&&_0x268e61['content'])['map'](_0x5ea635=>({'keys':_0x5ea635['keys']||[],'comment':_0x5ea635[_0x153d8f(0x8f9)]||'','content':_0x5ea635[_0x153d8f(0x28c)][_0x153d8f(0xfbf)](/<memory>|<\/memory>/g,'')[_0x153d8f(0xc3a)]()}));if(_0x22d3e8[_0x153d8f(0x7aa)]>0x0){const _0x519c8d={'id':'wb_'+Date[_0x153d8f(0xf1a)](),'name':_0x4237a8[_0x153d8f(0xf74)]+'的设定集','content':_0x22d3e8,'categoryId':null};await _0x1a6951['worldBooks'][_0x153d8f(0x569)](_0x519c8d),_0x5b873d[_0x153d8f(0x8a1)][_0x153d8f(0x138c)](_0x519c8d),_0x46c103=_0x519c8d['id'];}}let _0x58e38f=_0x4237a8[_0x153d8f(0xf6e)]||_0x3856d3[_0x153d8f(0xf6e)]||'无';_0x58e38f=_0x58e38f[_0x153d8f(0xfbf)](/```yaml/g,'')[_0x153d8f(0xfbf)](/```/g,'')[_0x153d8f(0xfbf)](/<\/?info>/g,'')[_0x153d8f(0xfbf)](/<\/?character>/g,'')[_0x153d8f(0xfbf)](/<\/?writing_rule>/g,'')[_0x153d8f(0xfbf)](/\[OOC：.*?\]/g,'')['trim']();let _0x392666=_0x153d8f(0xe1a)+_0x58e38f+'\x0a\x0a';if(_0x4237a8[_0x153d8f(0xb1e)])_0x392666+=_0x153d8f(0x115b)+_0x4237a8['personality']+'\x0a\x0a';if(_0x4237a8[_0x153d8f(0x483)])_0x392666+=_0x153d8f(0x4f0)+_0x4237a8[_0x153d8f(0x483)]+'\x0a\x0a';if(_0x4237a8[_0x153d8f(0x21c)])_0x392666+=_0x153d8f(0x12c6)+_0x4237a8['mes_example']+'\x0a\x0a';const _0x231676=_0x4237a8['name'],_0x4dcbc4=_0x4237a8[_0x153d8f(0xf74)],_0x5944e1=_0x153d8f(0x1382)+Date[_0x153d8f(0xf1a)](),_0xabe6ae={'id':_0x5944e1,'name':_0x231676[_0x153d8f(0xc3a)](),'originalName':_0x4dcbc4[_0x153d8f(0xc3a)](),'isGroup':![],'relationship':{'status':'friend'},'status':{'text':'在线','lastUpdate':Date[_0x153d8f(0xf1a)](),'isBusy':![]},'settings':{'aiPersona':_0x392666,'myPersona':_0x153d8f(0xa6e),'maxMemory':0xa,'aiAvatar':_0x265fcc,'myAvatar':_0x265fcc,'background':'','theme':_0x153d8f(0xfb4),'fontSize':0xd,'customCss':'','linkedWorldBookIds':_0x46c103?[_0x46c103]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0xaf3bb0&&(_0xabe6ae[_0x153d8f(0xdb9)]['aiAvatar']=_0xaf3bb0,_0xabe6ae[_0x153d8f(0xdb9)][_0x153d8f(0x614)][_0x153d8f(0x138c)]({'name':'默认头像','url':_0xaf3bb0}));const _0x15aa20=_0x4237a8[_0x153d8f(0xf31)]||_0x3856d3[_0x153d8f(0xf31)];if(_0x15aa20&&typeof _0x15aa20===_0x153d8f(0x1224)){const _0x4a9ed0=document[_0x153d8f(0x285)](_0x153d8f(0xb25));_0x4a9ed0[_0x153d8f(0x1ef)]=_0x15aa20;const _0xbb6d58=(_0x4a9ed0[_0x153d8f(0xf12)]||_0x4a9ed0[_0x153d8f(0x7f5)]||'')['replace'](/原作者UR.*?开局/s,'')[_0x153d8f(0xc3a)]();_0xbb6d58&&_0xabe6ae['history'][_0x153d8f(0x138c)]({'role':_0x153d8f(0x1377),'senderName':_0xabe6ae[_0x153d8f(0x1045)],'content':_0xbb6d58,'timestamp':Date['now']()});}_0x5b873d['chats'][_0x5944e1]=_0xabe6ae,await _0x1a6951[_0x153d8f(0x667)]['put'](_0xabe6ae),_0x413d78();let _0x585410=_0x153d8f(0xa74)+_0xabe6ae[_0x153d8f(0xf74)]+'”\x20已成功导入！';_0x46c103&&(_0x585410+='\x0a\x0a其专属的“世界书”也已自动创建并关联。'),await _0x532f76('导入成功！',_0x585410);}async function _0x1c8748(){const _0x15ce4a=_0x41eae2;if(!_0x5b873d[_0x15ce4a(0xf96)])return;const _0x446873=_0x5b873d['chats'][_0x5b873d[_0x15ce4a(0xf96)]],_0x5e6c2c=_0x446873['settings']['alternateGreetings'];if(!_0x5e6c2c||_0x5e6c2c[_0x15ce4a(0x7aa)]===0x0){alert('这个角色没有可用的备选开场白。');return;}const _0x4a18cd=_0x5e6c2c[_0x15ce4a(0x412)]((_0x34e020,_0x11db77)=>{const _0x543b67=_0x15ce4a,_0x4f12be=_0x34e020['replace'](/<[^>]*>/g,'')[_0x543b67(0xc3a)]()[_0x543b67(0x489)](0x0,0x14);return{'text':_0x543b67(0xfff)+(_0x11db77+0x1)+':\x20'+_0x4f12be+_0x543b67(0x1046),'value':_0x11db77};}),_0x246f34=await _0x4d923b(_0x15ce4a(0xa46),_0x4a18cd);if(_0x246f34!==null){const _0x1e6806=await _0x4e2abc('确认操作',_0x15ce4a(0x65d),{'confirmButtonClass':_0x15ce4a(0xcd8),'confirmText':_0x15ce4a(0x505)});if(_0x1e6806){const _0x38a4d0=_0x5e6c2c[_0x246f34],_0x2c2e35={'role':_0x15ce4a(0x1377),'senderName':_0x446873['originalName'],'content':_0x38a4d0,'timestamp':Date[_0x15ce4a(0xf1a)]()};_0x446873[_0x15ce4a(0x551)]=[_0x2c2e35],await _0x1a6951['chats'][_0x15ce4a(0xc0f)](_0x446873),_0x5b89df(_0x446873['id']),document['getElementById']('chat-settings-modal')['classList'][_0x15ce4a(0x1247)](_0x15ce4a(0x11e4)),await _0x532f76('成功','已切换到新的开场故事！');}}}function _0x348395(_0x2c42ce={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x32a3b3=_0x41eae2,_0x125a36=document['createElement'](_0x32a3b3(0xb25));_0x125a36[_0x32a3b3(0x81c)]=_0x32a3b3(0x828);const _0x4906aa=_0x2c42ce[_0x32a3b3(0x104e)]!==![]?'checked':'';return _0x125a36[_0x32a3b3(0x1ef)]=_0x32a3b3(0x180)+_0x4906aa+_0x32a3b3(0xf4e)+(_0x2c42ce['comment']||'')+_0x32a3b3(0x1007)+(_0x2c42ce[_0x32a3b3(0xe9c)]||[])['join'](',\x20')+_0x32a3b3(0x302)+(_0x2c42ce[_0x32a3b3(0x28c)]||'')+_0x32a3b3(0xd50),_0x125a36[_0x32a3b3(0xd16)]('.delete-block-btn')[_0x32a3b3(0x1193)](_0x32a3b3(0x12a5),()=>{const _0x4fb905=_0x32a3b3;_0x125a36[_0x4fb905(0x1247)]();}),_0x125a36;}async function _0x57088d(){const _0x5cc9ba=_0x41eae2;if(!_0x5b873d[_0x5cc9ba(0xf96)])return;const _0xe84811=_0x5b873d['activeChatId'],_0x48c4ab=document[_0x5cc9ba(0x89d)](_0x5cc9ba(0xb6b));if(!_0x48c4ab[_0x5cc9ba(0x2f1)][_0x5cc9ba(0x3ff)](_0x5cc9ba(0x11e4))){const _0x4f13f3=document['querySelector'](_0x5cc9ba(0xdb7));_0x48c4ab[_0x5cc9ba(0x68e)]['top']=_0x4f13f3['offsetHeight']+'px',_0x48c4ab[_0x5cc9ba(0x68e)]['display']=_0x5cc9ba(0x1118),(!_0x404de6[_0xe84811]||!_0x404de6[_0xe84811][_0x5cc9ba(0xfcb)])&&_0x5449b2(_0xe84811),_0x2c4e2b(_0xe84811),setTimeout(async()=>{const _0x19cc7c=_0x5cc9ba;_0x48c4ab[_0x19cc7c(0x2f1)][_0x19cc7c(0x569)](_0x19cc7c(0x11e4));const _0x219b0d={'role':_0x19cc7c(0x18c),'content':_0x19cc7c(0x5c2),'timestamp':Date[_0x19cc7c(0xf1a)](),'isHidden':!![]};_0x5b873d[_0x19cc7c(0x667)][_0xe84811][_0x19cc7c(0x551)][_0x19cc7c(0x138c)](_0x219b0d),await _0x1a6951[_0x19cc7c(0x667)][_0x19cc7c(0xc0f)](_0x5b873d[_0x19cc7c(0x667)][_0xe84811]);},0xa);}else await _0x5ce586();}async function _0x5ce586(){const _0x40f427=_0x41eae2;if(!_0x5b873d[_0x40f427(0xf96)])return;const _0x4525f8=_0x5b873d[_0x40f427(0xf96)],_0x475360=document[_0x40f427(0x89d)](_0x40f427(0xb6b));_0x475360[_0x40f427(0x2f1)][_0x40f427(0x1247)](_0x40f427(0x11e4)),setTimeout(()=>{const _0x36fe61=_0x40f427;_0x475360['style']['display']=_0x36fe61(0x10f2);},0x12c);if(_0x404de6[_0x4525f8]){_0x404de6[_0x4525f8][_0x40f427(0xfcb)]=![];const _0x373c8e={'role':_0x40f427(0x18c),'content':_0x40f427(0x788),'timestamp':Date[_0x40f427(0xf1a)](),'isHidden':!![]};_0x5b873d[_0x40f427(0x667)][_0x4525f8]['history'][_0x40f427(0x138c)](_0x373c8e),await _0x1a6951['chats'][_0x40f427(0xc0f)](_0x5b873d[_0x40f427(0x667)][_0x4525f8]);}}function _0x5449b2(_0x373dd3){const _0x2633d1=_0x41eae2,_0x207bff=document[_0x2633d1(0x89d)](_0x2633d1(0x12e8)),_0x2cc450=document['getElementById'](_0x2633d1(0xb6b)),_0x298cbf=document[_0x2633d1(0x89d)](_0x2633d1(0x1164)),_0x4e9ff2=_0x2cc450[_0x2633d1(0xf13)]-0x28,_0x568d51=_0x2cc450[_0x2633d1(0x121a)]-_0x298cbf['offsetHeight']-0x28,_0x4ae7ca=Math[_0x2633d1(0x128a)](Math[_0x2633d1(0x1169)](_0x4e9ff2,_0x568d51)),_0x3038c9=0xf,_0x372032=Math[_0x2633d1(0x128a)](_0x4ae7ca/_0x3038c9),_0x1fa76b=_0x372032*_0x3038c9;_0x207bff[_0x2633d1(0x42e)]=_0x1fa76b,_0x207bff[_0x2633d1(0x84a)]=_0x1fa76b,_0x404de6[_0x373dd3]={'isActive':!![],'board':Array(_0x3038c9)[_0x2633d1(0x55f)](0x0)['map'](()=>Array(_0x3038c9)[_0x2633d1(0x55f)](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0x3038c9,'CELL_SIZE':_0x372032};}function _0x2c4e2b(_0x1d94ea){const _0x5ea3b5=_0x41eae2,_0x4f62b5=_0x404de6[_0x1d94ea];if(!_0x4f62b5)return;const _0x2f0192=document['getElementById']('gomoku-board'),_0x4a3e84=_0x2f0192[_0x5ea3b5(0xc94)]('2d'),{GRID_SIZE:_0xc8d9e,CELL_SIZE:_0x53be2e}=_0x4f62b5,_0x112ecf=_0x53be2e/0x2;_0x4a3e84[_0x5ea3b5(0x3a4)](0x0,0x0,_0x2f0192[_0x5ea3b5(0x42e)],_0x2f0192[_0x5ea3b5(0x84a)]),_0x4a3e84['fillStyle']=_0x5ea3b5(0x6ca),_0x4a3e84[_0x5ea3b5(0x9a7)](0x0,0x0,_0x2f0192[_0x5ea3b5(0x42e)],_0x2f0192['height']),_0x4a3e84['strokeStyle']='#5b3a29',_0x4a3e84[_0x5ea3b5(0x44d)]=0x1;for(let _0x12342a=0x0;_0x12342a<_0xc8d9e;_0x12342a++){_0x4a3e84[_0x5ea3b5(0x10a1)](),_0x4a3e84[_0x5ea3b5(0x5b0)](_0x112ecf,_0x112ecf+_0x12342a*_0x53be2e),_0x4a3e84['lineTo'](_0x2f0192[_0x5ea3b5(0x42e)]-_0x112ecf,_0x112ecf+_0x12342a*_0x53be2e),_0x4a3e84['stroke'](),_0x4a3e84['beginPath'](),_0x4a3e84[_0x5ea3b5(0x5b0)](_0x112ecf+_0x12342a*_0x53be2e,_0x112ecf),_0x4a3e84[_0x5ea3b5(0x800)](_0x112ecf+_0x12342a*_0x53be2e,_0x2f0192['height']-_0x112ecf),_0x4a3e84[_0x5ea3b5(0x12ba)]();}for(let _0x27e208=0x0;_0x27e208<_0xc8d9e;_0x27e208++){for(let _0x36664d=0x0;_0x36664d<_0xc8d9e;_0x36664d++){_0x4f62b5[_0x5ea3b5(0xb2a)][_0x27e208][_0x36664d]!==0x0&&_0x13a173(_0x4a3e84,_0x36664d,_0x27e208,_0x4f62b5[_0x5ea3b5(0xb2a)][_0x27e208][_0x36664d],_0x4f62b5);}}}function _0x13a173(_0xc9dcd5,_0x5ecabc,_0x9afc15,_0x4eacc2,_0x59ab8a){const _0x4eae21=_0x41eae2,{CELL_SIZE:_0x23413b}=_0x59ab8a,_0x5b5bac=_0x23413b/0x2,_0x16be88=_0x23413b/0x2-0x2;_0xc9dcd5[_0x4eae21(0x10a1)](),_0xc9dcd5[_0x4eae21(0xe0f)](_0x5b5bac+_0x5ecabc*_0x23413b,_0x5b5bac+_0x9afc15*_0x23413b,_0x16be88,0x0,0x2*Math['PI']),_0x4eacc2===0x1?_0xc9dcd5[_0x4eae21(0x1008)]='black':_0xc9dcd5['fillStyle']=_0x4eae21(0xf45),_0xc9dcd5[_0x4eae21(0x55f)]();}function _0x3d47ac(_0xc0d5e9){const _0x1cfbd8=_0x41eae2,_0x4b4060=_0x5b873d[_0x1cfbd8(0xf96)],_0xc807e=_0x404de6[_0x4b4060];if(!_0xc807e||_0xc807e[_0x1cfbd8(0x921)]||_0xc807e[_0x1cfbd8(0xdf1)]!==0x1)return;const _0x394b03=document[_0x1cfbd8(0x89d)](_0x1cfbd8(0x12e8)),_0x27b0d7=_0x394b03[_0x1cfbd8(0xc94)]('2d'),_0x57d163=_0x394b03[_0x1cfbd8(0xdb2)](),_0x5c16a0=_0xc0d5e9[_0x1cfbd8(0xc12)]-_0x57d163[_0x1cfbd8(0x1004)],_0x2d3db3=_0xc0d5e9['clientY']-_0x57d163[_0x1cfbd8(0x113d)],_0x1a27f4=Math['round']((_0x5c16a0-_0xc807e[_0x1cfbd8(0x2aa)]/0x2)/_0xc807e['CELL_SIZE']),_0x47d464=Math[_0x1cfbd8(0x900)]((_0x2d3db3-_0xc807e[_0x1cfbd8(0x2aa)]/0x2)/_0xc807e[_0x1cfbd8(0x2aa)]);_0x2c4e2b(_0x4b4060);if(_0x1a27f4>=0x0&&_0x1a27f4<_0xc807e[_0x1cfbd8(0xc7f)]&&_0x47d464>=0x0&&_0x47d464<_0xc807e[_0x1cfbd8(0xc7f)]&&_0xc807e[_0x1cfbd8(0xb2a)][_0x47d464][_0x1a27f4]===0x0){const _0x58e321=_0xc807e[_0x1cfbd8(0x2aa)]/0x2-0x2;_0x27b0d7[_0x1cfbd8(0x10a1)](),_0x27b0d7[_0x1cfbd8(0xe0f)](_0xc807e['CELL_SIZE']/0x2+_0x1a27f4*_0xc807e['CELL_SIZE'],_0xc807e[_0x1cfbd8(0x2aa)]/0x2+_0x47d464*_0xc807e[_0x1cfbd8(0x2aa)],_0x58e321,0x0,0x2*Math['PI']),_0x27b0d7['fillStyle']=_0x1cfbd8(0x520),_0x27b0d7['fill']();}}function _0x2afbd4(_0x5c4998){const _0x30814f=_0x41eae2,_0x2e0e3d=_0x5b873d[_0x30814f(0xf96)],_0x4cb0e7=_0x404de6[_0x2e0e3d];if(!_0x4cb0e7||_0x4cb0e7[_0x30814f(0x921)]||_0x4cb0e7[_0x30814f(0xdf1)]!==0x1)return;const _0x562d26=document['getElementById'](_0x30814f(0x12e8)),_0x16d4b3=_0x562d26[_0x30814f(0xdb2)](),_0xd5ca12=_0x5c4998[_0x30814f(0xc12)]-_0x16d4b3[_0x30814f(0x1004)],_0x587b3d=_0x5c4998[_0x30814f(0x4b8)]-_0x16d4b3[_0x30814f(0x113d)],_0xda858a=Math[_0x30814f(0x900)]((_0xd5ca12-_0x4cb0e7[_0x30814f(0x2aa)]/0x2)/_0x4cb0e7[_0x30814f(0x2aa)]),_0x7c38bb=Math['round']((_0x587b3d-_0x4cb0e7[_0x30814f(0x2aa)]/0x2)/_0x4cb0e7['CELL_SIZE']);_0xda858a>=0x0&&_0xda858a<_0x4cb0e7[_0x30814f(0xc7f)]&&_0x7c38bb>=0x0&&_0x7c38bb<_0x4cb0e7[_0x30814f(0xc7f)]&&_0x4cb0e7['board'][_0x7c38bb][_0xda858a]===0x0&&(_0x4cb0e7[_0x30814f(0xb2a)][_0x7c38bb][_0xda858a]=0x1,_0x4cb0e7[_0x30814f(0x551)][_0x30814f(0x138c)]({'x':_0xda858a,'y':_0x7c38bb,'player':0x1}),_0x2c4e2b(_0x2e0e3d),_0x4f920a(_0xda858a,_0x7c38bb,0x1,_0x4cb0e7)?(_0x4cb0e7[_0x30814f(0x921)]=!![],setTimeout(()=>alert(_0x30814f(0x537)),0x64),_0xe5e573('user')):_0x4cb0e7[_0x30814f(0xdf1)]=0x2);}function _0xa18ee9(_0x27bd8d,_0x791d2=![]){const _0x44e034=_0x41eae2,_0x39649b=_0x5b873d[_0x44e034(0xf96)],_0x501c1f=_0x404de6[_0x39649b];if(!_0x501c1f||_0x501c1f[_0x44e034(0x921)])return;if(!_0x791d2&&_0x501c1f['currentPlayer']!==0x2)return;const {x:_0x5c0076,y:_0x5b2c32}=_0x27bd8d;_0x5c0076>=0x0&&_0x5c0076<_0x501c1f[_0x44e034(0xc7f)]&&_0x5b2c32>=0x0&&_0x5b2c32<_0x501c1f[_0x44e034(0xc7f)]&&_0x501c1f['board'][_0x5b2c32][_0x5c0076]===0x0?(_0x501c1f['board'][_0x5b2c32][_0x5c0076]=0x2,_0x501c1f['history'][_0x44e034(0x138c)]({'x':_0x5c0076,'y':_0x5b2c32,'player':0x2}),_0x2c4e2b(_0x39649b),_0x4f920a(_0x5c0076,_0x5b2c32,0x2,_0x501c1f)?(_0x501c1f[_0x44e034(0x921)]=!![],setTimeout(()=>alert('AI\x20获胜了！'),0x64),_0xe5e573('ai')):_0x501c1f[_0x44e034(0xdf1)]=0x1):(console[_0x44e034(0xac3)](_0x44e034(0x270),_0x27bd8d),_0x501c1f[_0x44e034(0xdf1)]=0x1);}function _0x4f920a(_0x38a1e8,_0x4dfab4,_0x26d1bb,_0x11b5e1){const {board:_0x18b2b5,GRID_SIZE:_0x350fcc}=_0x11b5e1,_0x3ab874=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x5ae8c9,_0x1a6a5d]of _0x3ab874){let _0x515113=0x1;for(let _0x18aea4=0x1;_0x18aea4<0x5;_0x18aea4++){const _0x422497=_0x38a1e8+_0x18aea4*_0x5ae8c9,_0x4e9635=_0x4dfab4+_0x18aea4*_0x1a6a5d;if(_0x422497>=0x0&&_0x422497<_0x350fcc&&_0x4e9635>=0x0&&_0x4e9635<_0x350fcc&&_0x18b2b5[_0x4e9635][_0x422497]===_0x26d1bb)_0x515113++;else break;}for(let _0x3284fc=0x1;_0x3284fc<0x5;_0x3284fc++){const _0x57d8e2=_0x38a1e8-_0x3284fc*_0x5ae8c9,_0xaadeb1=_0x4dfab4-_0x3284fc*_0x1a6a5d;if(_0x57d8e2>=0x0&&_0x57d8e2<_0x350fcc&&_0xaadeb1>=0x0&&_0xaadeb1<_0x350fcc&&_0x18b2b5[_0xaadeb1][_0x57d8e2]===_0x26d1bb)_0x515113++;else break;}if(_0x515113>=0x5)return!![];}return![];}function _0x141deb(_0x2e9dd0){const _0x421222=_0x41eae2;if(!_0x2e9dd0||!_0x2e9dd0['isActive'])return'';let _0x171b1e=_0x421222(0x76a);_0x171b1e+=_0x2e9dd0[_0x421222(0xb2a)]['map'](_0x30e606=>_0x30e606[_0x421222(0x1237)]('\x20'))[_0x421222(0x1237)]('\x0a');let _0x43c156=_0x421222(0x1130);return _0x43c156+=_0x2e9dd0[_0x421222(0x551)][_0x421222(0x412)](_0x5e5982=>'玩家'+_0x5e5982['player']+_0x421222(0x6ac)+_0x5e5982['x']+','+_0x5e5982['y']+')')['join'](_0x421222(0x30b)),_0x421222(0x1011)+_0x171b1e+_0x421222(0x971)+_0x43c156+_0x421222(0xbf0);}async function _0xe5e573(_0x23d72a){const _0x3d200f=_0x41eae2,_0xdac12a=_0x5b873d[_0x3d200f(0xf96)],_0x411ab3=_0x5b873d[_0x3d200f(0x667)][_0xdac12a];if(!_0x411ab3)return;const _0x1bc3fd=_0x411ab3[_0x3d200f(0x58c)]?_0x411ab3[_0x3d200f(0xdb9)][_0x3d200f(0xc48)]||'我':'我',_0x5a5df0=_0x411ab3['isGroup']?_0x3d200f(0x1309):_0x411ab3[_0x3d200f(0xf74)],_0xb5052b=_0x23d72a==='user'?_0x1bc3fd:_0x5a5df0,_0x2a3e99=_0x23d72a===_0x3d200f(0x116c)?_0x3d200f(0xfe8):_0x3d200f(0xb23),_0x45e26d=_0x3d200f(0x1198)+_0xb5052b+'\x20获胜。也就是说，'+_0x2a3e99+'。]',_0xefbbb={'role':_0x3d200f(0x18c),'content':_0x45e26d,'timestamp':Date[_0x3d200f(0xf1a)](),'isHidden':!![]};_0x411ab3[_0x3d200f(0x551)]['push'](_0xefbbb),await _0x1a6951[_0x3d200f(0x667)]['put'](_0x411ab3),console['log'](_0x3d200f(0x59c)+_0x23d72a);}let _0x5331a4=![];async function _0xdeaaf2(){const _0x48a999=_0x41eae2,_0x112ddf=document[_0x48a999(0x89d)](_0x48a999(0x6ff)),_0x2e86b0=document['getElementById']('product-category-tabs'),_0x927ff6=document[_0x48a999(0x89d)](_0x48a999(0x37b));_0x112ddf['innerHTML']='',_0x2e86b0['innerHTML']='';const [_0x313e54,_0x41404a]=await Promise[_0x48a999(0x863)]([_0x1a6951[_0x48a999(0xa6d)]['toArray'](),_0x1a6951[_0x48a999(0x110d)]['orderBy'](_0x48a999(0xf74))['toArray']()]);_0x927ff6[_0x48a999(0x2f1)][_0x48a999(0x73b)](_0x48a999(0x992),_0x5331a4);const _0x5806d2=document['createElement'](_0x48a999(0x5af));_0x5806d2[_0x48a999(0x81c)]=_0x48a999(0x3cd),_0x5806d2[_0x48a999(0xf12)]='全部',_0x5806d2['dataset']['categoryId']=_0x48a999(0x863);if(activeShoppingCategoryId===_0x48a999(0x863))_0x5806d2[_0x48a999(0x2f1)][_0x48a999(0x569)]('active');_0x2e86b0['appendChild'](_0x5806d2),_0x41404a['forEach'](_0x13c18d=>{const _0x4628b7=_0x48a999,_0x1ad779=document[_0x4628b7(0x285)]('button');_0x1ad779[_0x4628b7(0x81c)]='product-category-tab',_0x1ad779[_0x4628b7(0xf12)]=_0x13c18d[_0x4628b7(0xf74)],_0x1ad779['dataset'][_0x4628b7(0xcb1)]=_0x13c18d['id'];if(activeShoppingCategoryId===_0x13c18d['id'])_0x1ad779[_0x4628b7(0x2f1)][_0x4628b7(0x569)](_0x4628b7(0x8ea));_0x2e86b0[_0x4628b7(0x22f)](_0x1ad779);});let _0xe902ac;activeShoppingCategoryId===_0x48a999(0x863)?_0xe902ac=_0x313e54:_0xe902ac=_0x313e54[_0x48a999(0x3d8)](_0x24edcf=>_0x24edcf[_0x48a999(0xcb1)]===activeShoppingCategoryId);if(_0xe902ac[_0x48a999(0x7aa)]===0x0){const _0x2d1829=activeShoppingCategoryId===_0x48a999(0x863)?'商店空空如也，点击“管理”添加商品吧！':_0x48a999(0x4d0);_0x112ddf[_0x48a999(0x1ef)]=_0x48a999(0x416)+_0x2d1829+_0x48a999(0x164);return;}_0xe902ac[_0x48a999(0xd9a)](_0x438f26=>{const _0x24649c=_0x48a999,_0x295f4e=document[_0x24649c(0x285)](_0x24649c(0xb25));_0x295f4e['className']=_0x24649c(0x1cc),_0x295f4e[_0x24649c(0xaaf)]['id']=_0x438f26['id'];const _0x35bc4d='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x295f4e[_0x24649c(0x1ef)]=_0x24649c(0x100a)+_0x35bc4d+_0x24649c(0x10e6)+_0x438f26[_0x24649c(0x450)]+'\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>'+_0x438f26[_0x24649c(0xf74)]+_0x24649c(0x9f9)+_0x438f26['price']['toFixed'](0x2)+_0x24649c(0x1153),_0x112ddf[_0x24649c(0x22f)](_0x295f4e);});}function _0x4aa7d7(_0x12f8af){activeShoppingCategoryId=_0x12f8af,_0xdeaaf2(),_0x507e14();}function _0x507e14(){const _0x1b1d2d=_0x41eae2,_0x407200=document[_0x1b1d2d(0x89d)](_0x1b1d2d(0x1099));if(!_0x407200)return;const _0x319b27=_0x5331a4&&activeShoppingCategoryId!==_0x1b1d2d(0x863);_0x407200[_0x1b1d2d(0x68e)]['display']=_0x319b27?_0x1b1d2d(0x66e):_0x1b1d2d(0x10f2);}async function _0x1e694a(){const _0x3e729a=_0x41eae2;if(activeShoppingCategoryId===_0x3e729a(0x863))return;const _0xe7b6ac=activeShoppingCategoryId,_0x3b8d9e=await _0x1a6951[_0x3e729a(0x110d)][_0x3e729a(0x650)](_0xe7b6ac);if(!_0x3b8d9e){alert(_0x3e729a(0xbf3));return;}const _0x32fbe1='确定要永久删除分类\x20“'+_0x3b8d9e[_0x3e729a(0xf74)]+_0x3e729a(0x18f),_0x1842a4=await _0x4e2abc(_0x3e729a(0x123d),_0x32fbe1,{'confirmButtonClass':'btn-danger','confirmText':_0x3e729a(0x3da)});_0x1842a4&&(await _0x480a54(_0xe7b6ac),activeShoppingCategoryId=_0x3e729a(0x863),await _0xdeaaf2(),_0x507e14(),await _0x532f76('成功','分类\x20“'+_0x3b8d9e['name']+_0x3e729a(0x37d)));}async function _0x2bef11(){const _0x5210f5=_0x41eae2;activeShoppingCategoryId=_0x5210f5(0x863),await _0xdeaaf2(),_0x4e6c15(_0x5210f5(0x37b)),_0x507e14();}async function _0xdeaaf2(){const _0x11c4ef=_0x41eae2,_0x5a4572=document[_0x11c4ef(0x89d)](_0x11c4ef(0x6ff)),_0x5a30ab=document[_0x11c4ef(0x89d)](_0x11c4ef(0x364)),_0x11fe0d=document[_0x11c4ef(0x89d)](_0x11c4ef(0x37b));_0x5a4572['innerHTML']='',_0x5a30ab['innerHTML']='';const [_0x5e8c6e,_0x31d730]=await Promise[_0x11c4ef(0x863)]([_0x1a6951[_0x11c4ef(0xa6d)][_0x11c4ef(0xc2f)](),_0x1a6951[_0x11c4ef(0x110d)]['orderBy'](_0x11c4ef(0xf74))[_0x11c4ef(0xc2f)]()]);_0x11fe0d[_0x11c4ef(0x2f1)][_0x11c4ef(0x73b)](_0x11c4ef(0x992),_0x5331a4);const _0x209b21=document[_0x11c4ef(0x285)]('button');_0x209b21['className']=_0x11c4ef(0x3cd),_0x209b21[_0x11c4ef(0xf12)]='全部',_0x209b21[_0x11c4ef(0xaaf)][_0x11c4ef(0xcb1)]=_0x11c4ef(0x863);if(activeShoppingCategoryId===_0x11c4ef(0x863))_0x209b21[_0x11c4ef(0x2f1)][_0x11c4ef(0x569)](_0x11c4ef(0x8ea));_0x5a30ab[_0x11c4ef(0x22f)](_0x209b21),_0x31d730['forEach'](_0x5f189d=>{const _0x454452=_0x11c4ef,_0x6a304f=document['createElement'](_0x454452(0x5af));_0x6a304f[_0x454452(0x81c)]=_0x454452(0x3cd),_0x6a304f[_0x454452(0xf12)]=_0x5f189d[_0x454452(0xf74)],_0x6a304f[_0x454452(0xaaf)][_0x454452(0xcb1)]=_0x5f189d['id'];if(activeShoppingCategoryId===_0x5f189d['id'])_0x6a304f[_0x454452(0x2f1)]['add'](_0x454452(0x8ea));_0x5a30ab[_0x454452(0x22f)](_0x6a304f);});let _0x29acb3;activeShoppingCategoryId===_0x11c4ef(0x863)?_0x29acb3=_0x5e8c6e:_0x29acb3=_0x5e8c6e['filter'](_0x321da9=>_0x321da9[_0x11c4ef(0xcb1)]===activeShoppingCategoryId);if(_0x29acb3[_0x11c4ef(0x7aa)]===0x0){const _0x49cd99=activeShoppingCategoryId==='all'?_0x11c4ef(0x415):_0x11c4ef(0x4d0);_0x5a4572[_0x11c4ef(0x1ef)]='<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>'+_0x49cd99+'</p>';return;}_0x29acb3[_0x11c4ef(0xd9a)](_0x2540bc=>{const _0x155530=_0x11c4ef,_0x3f429d=document[_0x155530(0x285)]('div');_0x3f429d[_0x155530(0x81c)]=_0x155530(0x1cc),_0x3f429d[_0x155530(0xaaf)]['id']=_0x2540bc['id'];const _0x5da067=_0x5331a4?_0x155530(0xaeb):'';_0x3f429d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5da067+_0x155530(0x8dd)+_0x2540bc['imageUrl']+_0x155530(0x727)+_0x2540bc[_0x155530(0xf74)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>'+_0x2540bc[_0x155530(0x162)][_0x155530(0x8f7)](0x2)+_0x155530(0x2da),_0x5a4572[_0x155530(0x22f)](_0x3f429d);});}async function _0x193b17(_0x4701c3,_0x5d8f32=0x1,_0x2428c7=null){const _0x186223=_0x41eae2,_0x50fa43=_0x2428c7?_0x37a4bf[_0x186223(0x12f4)](_0x55a7a1=>_0x55a7a1[_0x186223(0x8c6)]===_0x4701c3&&_0x55a7a1['variation']?.['name']===_0x2428c7[_0x186223(0xf74)]):_0x37a4bf[_0x186223(0x12f4)](_0x18f7d5=>_0x18f7d5[_0x186223(0x8c6)]===_0x4701c3&&!_0x18f7d5[_0x186223(0xd93)]);if(_0x50fa43)_0x50fa43[_0x186223(0x66c)]+=_0x5d8f32;else{const _0xd49764=await _0x1a6951['shoppingProducts'][_0x186223(0x650)](_0x4701c3);_0xd49764&&_0x37a4bf[_0x186223(0x138c)]({'productId':_0xd49764['id'],'quantity':_0x5d8f32,'variation':_0x2428c7});}_0x20ae6e();}function _0x3a0b64(_0x193f9d,_0x146a57){const _0x54d301=_0x41eae2,_0x8293f5=_0x37a4bf[_0x54d301(0x9d7)](_0x512f9d=>_0x512f9d[_0x54d301(0x8c6)]===_0x193f9d);_0x8293f5>-0x1&&(_0x37a4bf[_0x8293f5][_0x54d301(0x66c)]+=_0x146a57,_0x37a4bf[_0x8293f5][_0x54d301(0x66c)]<=0x0&&_0x37a4bf['splice'](_0x8293f5,0x1),_0x20ae6e(),_0x453595());}function _0x20ae6e(){const _0x380d94=_0x41eae2,_0x2b6a93=_0x37a4bf['reduce']((_0x496e3d,_0x508b5b)=>_0x496e3d+_0x508b5b[_0x380d94(0x66c)],0x0);document[_0x380d94(0x89d)]('cart-count')[_0x380d94(0xf12)]=_0x2b6a93,document[_0x380d94(0x89d)](_0x380d94(0x5a1))[_0x380d94(0xf12)]='购物车('+_0x2b6a93+')',document[_0x380d94(0x89d)](_0x380d94(0x1137))[_0x380d94(0xf12)]=_0x380d94(0x990)+_0x2b6a93+')';}function _0x1920c7(){_0x453595(),_0x4e6c15('cart-screen');}async function _0x453595(){const _0x13ada3=_0x41eae2,_0x36ca90=document[_0x13ada3(0x89d)](_0x13ada3(0x396));_0x36ca90[_0x13ada3(0x1ef)]='';let _0x4fe6ac=0x0;if(_0x37a4bf[_0x13ada3(0x7aa)]===0x0)_0x36ca90['innerHTML']=_0x13ada3(0x531);else{const _0x202534=_0x37a4bf[_0x13ada3(0x412)](_0x444271=>_0x444271[_0x13ada3(0x8c6)]),_0x1043b0=await _0x1a6951[_0x13ada3(0xa6d)]['where']('id')['anyOf'](_0x202534)[_0x13ada3(0xc2f)](),_0x3dcf82=new Map(_0x1043b0[_0x13ada3(0x412)](_0x511612=>[_0x511612['id'],_0x511612]));_0x37a4bf[_0x13ada3(0xd9a)](_0x94f189=>{const _0xb4aae7=_0x13ada3,_0x2ae4e8=_0x3dcf82['get'](_0x94f189[_0xb4aae7(0x8c6)]);if(_0x2ae4e8){const _0x807ff0=document['createElement'](_0xb4aae7(0xb25));_0x807ff0[_0xb4aae7(0x81c)]='cart-item';const _0x2f6428=_0x94f189['variation']?_0xb4aae7(0x26d)+_0x94f189[_0xb4aae7(0xd93)][_0xb4aae7(0xf74)]+_0xb4aae7(0xc57):'';_0x807ff0['innerHTML']=_0xb4aae7(0xf9c)+_0x2ae4e8['id']+_0xb4aae7(0xd3a)+(_0x94f189[_0xb4aae7(0xd93)]?.[_0xb4aae7(0x450)]||_0x2ae4e8['imageUrl'])+_0xb4aae7(0xb30)+_0x2ae4e8['name']+_0xb4aae7(0x260)+_0x2f6428+_0xb4aae7(0xb1a)+(_0x94f189[_0xb4aae7(0xd93)]?.[_0xb4aae7(0x162)]||_0x2ae4e8[_0xb4aae7(0x162)])['toFixed'](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22'+_0x2ae4e8['id']+_0xb4aae7(0xc26)+_0x94f189[_0xb4aae7(0x66c)]+_0xb4aae7(0xf21)+_0x2ae4e8['id']+_0xb4aae7(0x3ac),_0x36ca90[_0xb4aae7(0x22f)](_0x807ff0);}});}_0x38d994();}async function _0x38d994(){const _0xf28429=_0x41eae2;let _0x4041ad=0x0;const _0x2de644=document['querySelectorAll'](_0xf28429(0x528)),_0x262560=Array[_0xf28429(0x321)](_0x2de644)[_0xf28429(0x412)](_0x537fa2=>parseInt(_0x537fa2['dataset']['id']));if(_0x262560[_0xf28429(0x7aa)]>0x0){const _0x305282=await _0x1a6951[_0xf28429(0xa6d)][_0xf28429(0x176)]('id')[_0xf28429(0x9b2)](_0x262560)[_0xf28429(0xc2f)](),_0x4f28fc=new Map(_0x305282[_0xf28429(0x412)](_0x1ca356=>[_0x1ca356['id'],_0x1ca356]));_0x37a4bf[_0xf28429(0xd9a)](_0x3c7689=>{const _0x478cd6=_0xf28429;if(_0x262560[_0x478cd6(0xced)](_0x3c7689[_0x478cd6(0x8c6)])){const _0x578b92=_0x4f28fc[_0x478cd6(0x650)](_0x3c7689[_0x478cd6(0x8c6)]);if(_0x578b92){const _0x262797=_0x3c7689['variation']?_0x3c7689[_0x478cd6(0xd93)][_0x478cd6(0x162)]:_0x578b92['price'];_0x4041ad+=_0x262797*_0x3c7689[_0x478cd6(0x66c)];}}});}document[_0xf28429(0x89d)]('cart-total')['textContent']=_0xf28429(0xfc0)+_0x4041ad[_0xf28429(0x8f7)](0x2);}async function _0x336d81(){const _0x4ad7d4=_0x41eae2,_0x5ca484=_0x5b873d[_0x4ad7d4(0x667)][_0x5b873d[_0x4ad7d4(0xf96)]];if(!_0x5ca484||!_0x5ca484[_0x4ad7d4(0x58c)])return;const _0x19959a=document['getElementById'](_0x4ad7d4(0x12a1)),_0x2eddd3=document[_0x4ad7d4(0x89d)](_0x4ad7d4(0xb82));_0x2eddd3['innerHTML']='';const _0x3795e4=_0x5ca484[_0x4ad7d4(0xdb9)][_0x4ad7d4(0xc48)]||'我',_0x4a2bed=_0x5ca484[_0x4ad7d4(0x5ab)][_0x4ad7d4(0x3d8)](_0x1532e5=>_0x1532e5[_0x4ad7d4(0x7da)]!==_0x3795e4);_0x4a2bed[_0x4ad7d4(0xd9a)](_0x3b569b=>{const _0x28f5a3=_0x4ad7d4,_0x1791b9=document['createElement'](_0x28f5a3(0xb25));_0x1791b9[_0x28f5a3(0x81c)]=_0x28f5a3(0xf36),_0x1791b9['dataset'][_0x28f5a3(0x2ff)]=_0x3b569b[_0x28f5a3(0x1045)],_0x1791b9[_0x28f5a3(0x1ef)]=_0x28f5a3(0xd33)+(_0x3b569b[_0x28f5a3(0x12c8)]||_0x15061e)+_0x28f5a3(0x256)+_0x3b569b[_0x28f5a3(0x7da)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2eddd3[_0x28f5a3(0x22f)](_0x1791b9);}),document[_0x4ad7d4(0x89d)](_0x4ad7d4(0xc63))[_0x4ad7d4(0x1b0)]=![],_0x19959a['classList'][_0x4ad7d4(0x569)](_0x4ad7d4(0x11e4));}async function _0x4c4a5e(){const _0x2e3b3d=_0x41eae2,_0x571c90=_0x5b873d[_0x2e3b3d(0x667)][_0x5b873d['activeChatId']],_0x32c7ac=_0x37a4bf[_0x2e3b3d(0x3d8)](_0x1759bc=>document[_0x2e3b3d(0xd16)](_0x2e3b3d(0xb39)+_0x1759bc[_0x2e3b3d(0x8c6)]+'\x22]:checked'));if(_0x32c7ac[_0x2e3b3d(0x7aa)]===0x0){alert(_0x2e3b3d(0x435));return;}if(_0x571c90['isGroup'])_0x336d81();else{const _0x2efe88=await _0x4e2abc(_0x2e3b3d(0x1065),_0x2e3b3d(0xf6c),{'confirmText':_0x2e3b3d(0xc82)});_0x2efe88&&await _0x1ecaab(_0x32c7ac);}}async function _0x1ecaab(_0x5d4902,_0x12a83f=null){const _0x41f939=_0x41eae2;if(!_0x5b873d[_0x41f939(0xf96)])return;const _0x2989d9=_0x5b873d[_0x41f939(0x667)][_0x5b873d[_0x41f939(0xf96)]],_0x1eb3ec=_0x5d4902[_0x41f939(0x412)](_0x316a2b=>_0x316a2b[_0x41f939(0x8c6)]),_0x2c3844=await _0x1a6951[_0x41f939(0xa6d)][_0x41f939(0x176)]('id')[_0x41f939(0x9b2)](_0x1eb3ec)['toArray'](),_0x9d6f39=new Map(_0x2c3844[_0x41f939(0x412)](_0x6ecdc9=>[_0x6ecdc9['id'],_0x6ecdc9])),_0x2571b0=_0x5d4902[_0x41f939(0x412)](_0x1aa9e8=>{const _0x5cefa6=_0x41f939,_0xcbfa8a=_0x9d6f39[_0x5cefa6(0x650)](_0x1aa9e8[_0x5cefa6(0x8c6)]);return _0x1aa9e8[_0x5cefa6(0xd93)]?{'name':_0xcbfa8a[_0x5cefa6(0xf74)]+'\x20-\x20'+_0x1aa9e8[_0x5cefa6(0xd93)][_0x5cefa6(0xf74)],'price':_0x1aa9e8['variation'][_0x5cefa6(0x162)],'imageUrl':_0x1aa9e8[_0x5cefa6(0xd93)]['imageUrl']||_0xcbfa8a[_0x5cefa6(0x450)],'quantity':_0x1aa9e8[_0x5cefa6(0x66c)]}:{'name':_0xcbfa8a[_0x5cefa6(0xf74)],'price':_0xcbfa8a[_0x5cefa6(0x162)],'imageUrl':_0xcbfa8a[_0x5cefa6(0x450)],'quantity':_0x1aa9e8[_0x5cefa6(0x66c)]};}),_0x4c3c95={'role':_0x41f939(0x116c),'type':_0x41f939(0xf80),'timestamp':Date['now'](),'items':_0x2571b0,'total':_0x2571b0['reduce']((_0x32213e,_0x1ad1d0)=>_0x32213e+_0x1ad1d0[_0x41f939(0x162)]*_0x1ad1d0[_0x41f939(0x66c)],0x0),'recipients':_0x12a83f};_0x2989d9['history'][_0x41f939(0x138c)](_0x4c3c95);if(_0x12a83f&&_0x12a83f[_0x41f939(0x7aa)]>0x0){const _0x4a31c0=_0x12a83f[_0x41f939(0x412)](_0x3d352d=>_0xb9963e(_0x2989d9,_0x3d352d))[_0x41f939(0x1237)]('、'),_0x2e7ec4={'role':_0x41f939(0x18c),'content':_0x41f939(0x1029)+(_0x2989d9[_0x41f939(0xdb9)][_0x41f939(0xc48)]||'我')+_0x41f939(0x5aa)+_0x4a31c0+_0x41f939(0xcd4),'timestamp':Date[_0x41f939(0xf1a)]()+0x1,'isHidden':!![]};_0x2989d9[_0x41f939(0x551)]['push'](_0x2e7ec4);}await _0x1a6951[_0x41f939(0x667)]['put'](_0x2989d9),_0x58deee(_0x4c3c95,_0x2989d9),_0x413d78(),_0x37a4bf=_0x37a4bf[_0x41f939(0x3d8)](_0x85db57=>!_0x5d4902[_0x41f939(0xc5c)](_0x4cf296=>_0x4cf296['productId']===_0x85db57['productId'])),_0x20ae6e(),_0x4e6c15(_0x41f939(0x87f)),await _0x532f76('成功',_0x41f939(0x89e));}function _0x6f4bad(_0x3d3f01){const _0x11e375=_0x41eae2,_0x2eeeae=_0x5b873d[_0x11e375(0x667)][_0x5b873d[_0x11e375(0xf96)]],_0x111a91=_0x2eeeae[_0x11e375(0x551)][_0x11e375(0x12f4)](_0x5e49ca=>_0x5e49ca['timestamp']===_0x3d3f01);if(!_0x111a91||_0x111a91[_0x11e375(0x48c)]!==_0x11e375(0xf80))return;const _0x3f5ceb=document[_0x11e375(0x89d)](_0x11e375(0x5f3));let _0x356b21='';_0x111a91['items'][_0x11e375(0xd9a)](_0x1c9bf0=>{const _0x381ed5=_0x11e375;_0x356b21+='<tr><td\x20class=\x22item-name\x22>'+_0x1c9bf0[_0x381ed5(0xf74)]+_0x381ed5(0xe58)+_0x1c9bf0[_0x381ed5(0x66c)]+_0x381ed5(0x1212)+_0x1c9bf0[_0x381ed5(0x162)][_0x381ed5(0x8f7)](0x2)+_0x381ed5(0x354)+(_0x1c9bf0[_0x381ed5(0x162)]*_0x1c9bf0[_0x381ed5(0x66c)])['toFixed'](0x2)+'</td></tr>';}),_0x3f5ceb[_0x11e375(0x1ef)]=_0x11e375(0x1062)+new Date(_0x111a91['timestamp'])[_0x11e375(0x425)]()+_0x11e375(0x545)+_0x356b21+_0x11e375(0xb3c)+_0x111a91[_0x11e375(0x857)][_0x11e375(0x8f7)](0x2)+_0x11e375(0xbc1),document[_0x11e375(0x89d)](_0x11e375(0xe26))[_0x11e375(0x2f1)][_0x11e375(0x569)](_0x11e375(0x11e4));}async function _0x4bdf9e(_0x33fb34=null){const _0x8cd73b=_0x41eae2;_0x34a863=_0x33fb34;const _0x546143=document[_0x8cd73b(0x89d)](_0x8cd73b(0x11c2)),_0x496a6b=document[_0x8cd73b(0x89d)](_0x8cd73b(0xf9d)),_0x3cf08f=document[_0x8cd73b(0x89d)](_0x8cd73b(0x1032)),_0x67212d=document[_0x8cd73b(0x89d)](_0x8cd73b(0xd66)),_0x3cee67=document[_0x8cd73b(0x89d)](_0x8cd73b(0x1238)),_0x3d3779=document[_0x8cd73b(0x89d)](_0x8cd73b(0x579)),_0x4c802d=document[_0x8cd73b(0x89d)](_0x8cd73b(0x1268)),_0x4909c2=document[_0x8cd73b(0x89d)](_0x8cd73b(0xac6));_0x4909c2[_0x8cd73b(0x1ef)]='',_0x4c802d['innerHTML']=_0x8cd73b(0x71e);const _0x571c23=await _0x1a6951['shoppingCategories']['toArray']();_0x571c23['forEach'](_0x3c17e9=>{const _0x3f8cd1=_0x8cd73b,_0x2243d3=document[_0x3f8cd1(0x285)]('option');_0x2243d3[_0x3f8cd1(0x2f4)]=_0x3c17e9['id'],_0x2243d3[_0x3f8cd1(0xf12)]=_0x3c17e9['name'],_0x4c802d[_0x3f8cd1(0x22f)](_0x2243d3);});if(_0x33fb34){_0x496a6b['textContent']=_0x8cd73b(0xe67);const _0x51581f=await _0x1a6951[_0x8cd73b(0xa6d)]['get'](_0x33fb34);_0x3cf08f[_0x8cd73b(0x2f4)]=_0x51581f['name'],_0x67212d[_0x8cd73b(0x2f4)]=_0x51581f[_0x8cd73b(0x162)],_0x3cee67['value']=_0x51581f['description']||'',_0x3d3779[_0x8cd73b(0x9e3)]=_0x51581f[_0x8cd73b(0x450)],_0x4c802d[_0x8cd73b(0x2f4)]=_0x51581f['categoryId']||'',_0x51581f[_0x8cd73b(0x3d4)]&&_0x51581f[_0x8cd73b(0x3d4)]['length']>0x0&&_0x51581f[_0x8cd73b(0x3d4)][_0x8cd73b(0xd9a)](_0xcd66bd=>_0x455dc1(_0xcd66bd));}else _0x496a6b[_0x8cd73b(0xf12)]=_0x8cd73b(0xc11),_0x3cf08f[_0x8cd73b(0x2f4)]='',_0x67212d[_0x8cd73b(0x2f4)]='',_0x3cee67[_0x8cd73b(0x2f4)]='',_0x3d3779['src']=_0x8cd73b(0xe19),_0x4c802d[_0x8cd73b(0x2f4)]='';_0x546143[_0x8cd73b(0x2f1)]['add'](_0x8cd73b(0x11e4));}async function _0x3e1497(){const _0x13c55c=_0x41eae2,_0x2ed6ec=document['getElementById']('product-name-input')['value'][_0x13c55c(0xc3a)](),_0x18abf1=parseFloat(document['getElementById'](_0x13c55c(0xd66))[_0x13c55c(0x2f4)]),_0x2140ea=document['getElementById'](_0x13c55c(0x1238))[_0x13c55c(0x2f4)][_0x13c55c(0xc3a)](),_0x536256=document[_0x13c55c(0x89d)](_0x13c55c(0x579))[_0x13c55c(0x9e3)],_0x310617=parseInt(document[_0x13c55c(0x89d)]('product-category-select')['value'])||null;if(!_0x2ed6ec){alert(_0x13c55c(0x1374));return;}if(isNaN(_0x18abf1)||_0x18abf1<0x0){alert('请输入有效的默认价格！');return;}const _0x4734a2=[];document['querySelectorAll'](_0x13c55c(0x1101))[_0x13c55c(0xd9a)](_0x346519=>{const _0x5ac814=_0x13c55c,_0x1b5091=_0x346519[_0x5ac814(0xd16)]('.variation-name-input')['value']['trim'](),_0x4c29b5=parseFloat(_0x346519[_0x5ac814(0xd16)](_0x5ac814(0x17a))[_0x5ac814(0x2f4)]),_0x2a3b42=_0x346519[_0x5ac814(0xd16)](_0x5ac814(0xdc7))[_0x5ac814(0x9e3)];_0x1b5091&&!isNaN(_0x4c29b5)&&_0x4c29b5>=0x0&&_0x4734a2[_0x5ac814(0x138c)]({'name':_0x1b5091,'price':_0x4c29b5,'imageUrl':_0x2a3b42[_0x5ac814(0xced)](_0x5ac814(0x78b))?null:_0x2a3b42});});const _0x1226ea={'name':_0x2ed6ec,'price':_0x18abf1,'description':_0x2140ea,'imageUrl':_0x536256,'categoryId':_0x310617,'variations':_0x4734a2};_0x34a863?await _0x1a6951[_0x13c55c(0xa6d)][_0x13c55c(0xdfc)](_0x34a863,_0x1226ea):await _0x1a6951[_0x13c55c(0xa6d)]['add'](_0x1226ea),document['getElementById'](_0x13c55c(0x11c2))[_0x13c55c(0x2f1)][_0x13c55c(0x1247)](_0x13c55c(0x11e4)),await _0xdeaaf2();}async function _0x324186(){const _0x42bbec=_0x41eae2;await _0x3f0031(),_0x4e6c15(_0x42bbec(0x10ca));}async function _0x3f0031(){const _0x22937a=_0x41eae2,_0x2c6f72=document[_0x22937a(0x89d)]('rules-tabs'),_0x22d2b0=document['getElementById']('rules-content-container');_0x2c6f72[_0x22937a(0x1ef)]='',_0x22d2b0[_0x22937a(0x1ef)]='';const _0x31df97=await _0x1a6951[_0x22937a(0x1067)][_0x22937a(0xc2f)]();if(_0x31df97['length']===0x0){_0x22d2b0[_0x22937a(0x1ef)]=_0x22937a(0x51b);return;}const _0x2c0ece=document[_0x22937a(0x285)](_0x22937a(0x5af));_0x2c0ece['className']='rules-tab\x20active',_0x2c0ece[_0x22937a(0xf12)]=_0x22937a(0x108c),_0x2c0ece[_0x22937a(0xaaf)][_0x22937a(0xcb1)]=_0x22937a(0xab9),_0x2c6f72[_0x22937a(0x22f)](_0x2c0ece);const _0xcba623=document[_0x22937a(0x285)](_0x22937a(0xb25));_0xcba623['className']=_0x22937a(0xf0b),_0xcba623[_0x22937a(0xaaf)][_0x22937a(0xcb1)]=_0x22937a(0xab9),_0x22d2b0[_0x22937a(0x22f)](_0xcba623);const _0x36033a=Object['values'](_0x5b873d[_0x22937a(0x667)])[_0x22937a(0x3d8)](_0x231509=>!_0x231509[_0x22937a(0x58c)]&&_0x31df97['some'](_0x54a56d=>_0x54a56d[_0x22937a(0x94d)]===_0x231509['id']));_0x36033a[_0x22937a(0xd9a)](_0x4d1b63=>{const _0xbffdf0=_0x22937a,_0x35174c=document[_0xbffdf0(0x285)](_0xbffdf0(0x5af));_0x35174c['className']=_0xbffdf0(0x129e),_0x35174c[_0xbffdf0(0xf12)]=_0x4d1b63[_0xbffdf0(0xf74)],_0x35174c[_0xbffdf0(0xaaf)][_0xbffdf0(0xcb1)]=_0x4d1b63['id'],_0x2c6f72['appendChild'](_0x35174c);const _0x2ac3c9=document[_0xbffdf0(0x285)](_0xbffdf0(0xb25));_0x2ac3c9[_0xbffdf0(0x81c)]='rules-category-pane',_0x2ac3c9[_0xbffdf0(0xaaf)][_0xbffdf0(0xcb1)]=_0x4d1b63['id'],_0x22d2b0[_0xbffdf0(0x22f)](_0x2ac3c9);}),_0x31df97[_0x22937a(0xd9a)](_0x3e6536=>{const _0x12e7d5=_0x22937a,_0x13e5f0=_0x29d78c(_0x3e6536),_0x324e60=_0x22d2b0[_0x12e7d5(0xd16)]('.rules-category-pane[data-category-id=\x22'+_0x3e6536[_0x12e7d5(0x94d)]+'\x22]');_0x324e60&&_0x324e60[_0x12e7d5(0x22f)](_0x13e5f0);}),document[_0x22937a(0x35f)](_0x22937a(0x124c))[_0x22937a(0xd9a)](_0x29ffb8=>{const _0x2a77f7=_0x22937a;_0x29ffb8[_0x2a77f7(0x1193)](_0x2a77f7(0x12a5),()=>_0x2bfca0(_0x29ffb8[_0x2a77f7(0xaaf)][_0x2a77f7(0xcb1)]));});}function _0x29d78c(_0x57902b){const _0x269340=_0x41eae2,_0x555c42=document[_0x269340(0x285)](_0x269340(0xb25));return _0x555c42[_0x269340(0x81c)]=_0x269340(0xde1)+(_0x57902b['isEnabled']?_0x269340(0x104e):''),_0x555c42[_0x269340(0xaaf)][_0x269340(0xde2)]=_0x57902b['id'],_0x555c42[_0x269340(0x1ef)]=_0x269340(0xb2d)+_0x57902b[_0x269340(0xf74)]+_0x269340(0x3ee)+_0x57902b[_0x269340(0xe1b)]+_0x269340(0x590),_0x555c42[_0x269340(0x1193)](_0x269340(0x12a5),()=>_0x179d3f(_0x57902b['id'])),_0xefe9e2(_0x555c42,()=>_0x23c010(_0x57902b['id'])),_0x555c42;}async function _0x179d3f(_0x557380=null){const _0x4546f6=_0x41eae2;_0x3ac599=_0x557380;const _0x545e9a=document[_0x4546f6(0x89d)](_0x4546f6(0xdfb)),_0x49d060=document['getElementById']('rule-editor-title'),_0x3ec740=document[_0x4546f6(0x89d)](_0x4546f6(0xbf7)),_0x43b8e7=document[_0x4546f6(0x89d)](_0x4546f6(0xfe9)),_0x5e24d3=document[_0x4546f6(0x89d)](_0x4546f6(0xa19)),_0x5a512e=document['getElementById']('rule-template-input'),_0x465004=document['getElementById'](_0x4546f6(0x1346));_0x43b8e7['innerHTML']=_0x4546f6(0x110a),Object[_0x4546f6(0x4b5)](_0x5b873d[_0x4546f6(0x667)])[_0x4546f6(0x3d8)](_0x2c2cc0=>!_0x2c2cc0['isGroup'])[_0x4546f6(0xd9a)](_0x28801c=>{const _0x32b7d5=_0x4546f6;_0x43b8e7['innerHTML']+=_0x32b7d5(0x3d3)+_0x28801c['id']+'\x22>'+_0x28801c[_0x32b7d5(0xf74)]+_0x32b7d5(0x101a);});if(_0x557380){_0x49d060[_0x4546f6(0xf12)]=_0x4546f6(0xbfe);const _0x787603=await _0x1a6951[_0x4546f6(0x1067)][_0x4546f6(0x650)](_0x557380);_0x3ec740['value']=_0x787603['name'],_0x43b8e7[_0x4546f6(0x2f4)]=_0x787603[_0x4546f6(0x94d)],_0x5e24d3[_0x4546f6(0x2f4)]=_0x787603[_0x4546f6(0xe1b)],_0x5a512e[_0x4546f6(0x2f4)]=_0x787603[_0x4546f6(0x196)],_0x465004[_0x4546f6(0x1b0)]=_0x787603['isEnabled'];}else _0x49d060[_0x4546f6(0xf12)]=_0x4546f6(0x1388),_0x3ec740[_0x4546f6(0x2f4)]='',_0x43b8e7[_0x4546f6(0x2f4)]=_0x4546f6(0xab9),_0x5e24d3[_0x4546f6(0x2f4)]='',_0x5a512e[_0x4546f6(0x2f4)]='',_0x465004['checked']=!![];_0x545e9a[_0x4546f6(0x2f1)][_0x4546f6(0x569)]('visible');}async function _0x4abcbf(){const _0x1793f4=_0x41eae2,_0x12a9ce=document[_0x1793f4(0x89d)](_0x1793f4(0xbf7))['value'][_0x1793f4(0xc3a)](),_0x5699e7=document['getElementById'](_0x1793f4(0xa19))[_0x1793f4(0x2f4)][_0x1793f4(0xc3a)]();if(!_0x12a9ce||!_0x5699e7){alert('规则名称和正则表达式不能为空！');return;}try{new RegExp(_0x5699e7);}catch(_0x443c41){alert(_0x1793f4(0xed9)+_0x443c41[_0x1793f4(0x1288)]);return;}const _0x42da78={'name':_0x12a9ce,'chatId':document[_0x1793f4(0x89d)](_0x1793f4(0xfe9))[_0x1793f4(0x2f4)],'regex':_0x5699e7,'template':document[_0x1793f4(0x89d)](_0x1793f4(0x63a))[_0x1793f4(0x2f4)],'isEnabled':document[_0x1793f4(0x89d)](_0x1793f4(0x1346))['checked']};_0x3ac599?await _0x1a6951[_0x1793f4(0x1067)]['update'](_0x3ac599,_0x42da78):await _0x1a6951[_0x1793f4(0x1067)][_0x1793f4(0x569)](_0x42da78),document[_0x1793f4(0x89d)]('rule-editor-modal')[_0x1793f4(0x2f1)][_0x1793f4(0x1247)](_0x1793f4(0x11e4)),await _0x3f0031();}async function _0x23c010(_0x82f24d){const _0x1686fb=_0x41eae2,_0x2909d4=await _0x4e2abc(_0x1686fb(0xa9a),_0x1686fb(0x81b),{'confirmButtonClass':_0x1686fb(0xcd8)});_0x2909d4&&(await _0x1a6951['renderingRules'][_0x1686fb(0x684)](_0x82f24d),await _0x3f0031());}async function _0x1eb7df(_0xda355c,_0x42053f){const _0x2b1fa0=_0x41eae2;if(_0xda355c[_0x2b1fa0(0xc3a)]()[_0x2b1fa0(0x1222)]('<')||!_0xda355c[_0x2b1fa0(0xced)]('[')&&!_0xda355c[_0x2b1fa0(0xced)]('{'))return _0xda355c;const _0x227570=await _0x1a6951[_0x2b1fa0(0x1067)][_0x2b1fa0(0x176)](_0x2b1fa0(0x94d))[_0x2b1fa0(0xb17)](_0x2b1fa0(0xab9))['or'](_0x2b1fa0(0x94d))[_0x2b1fa0(0xb17)](_0x42053f)[_0x2b1fa0(0xc2f)]();let _0x18e903=_0xda355c;for(const _0x150a4c of _0x227570[_0x2b1fa0(0x3d8)](_0x37c042=>_0x37c042[_0x2b1fa0(0x1386)])){try{const _0x53d27c=new RegExp(_0x150a4c[_0x2b1fa0(0xe1b)],'g');_0x53d27c[_0x2b1fa0(0xb80)](_0x18e903)&&(_0x18e903=_0x18e903[_0x2b1fa0(0xfbf)](_0x53d27c,_0x150a4c['template']));}catch(_0x1e61ae){console[_0x2b1fa0(0x1fd)](_0x2b1fa0(0x7c5)+_0x150a4c[_0x2b1fa0(0xf74)]+_0x2b1fa0(0xd88),_0x1e61ae);}}return _0x18e903;}async function _0x324186(){const _0x18d4a2=_0x41eae2;await _0x3f0031(),_0x4e6c15(_0x18d4a2(0x10ca));}async function _0x3f0031(){const _0x3f4480=_0x41eae2,_0x4e91a=document['getElementById'](_0x3f4480(0x90a)),_0x25bfe5=document[_0x3f4480(0x89d)](_0x3f4480(0x713));_0x4e91a[_0x3f4480(0x1ef)]='',_0x25bfe5[_0x3f4480(0x1ef)]='';const _0x2971f9=await _0x1a6951[_0x3f4480(0x1067)][_0x3f4480(0xc2f)]();if(_0x2971f9['length']===0x0){_0x25bfe5[_0x3f4480(0x1ef)]=_0x3f4480(0x51b);return;}const _0x57b51a=document[_0x3f4480(0x285)]('button');_0x57b51a[_0x3f4480(0x81c)]=_0x3f4480(0xe89),_0x57b51a[_0x3f4480(0xf12)]=_0x3f4480(0x108c),_0x57b51a[_0x3f4480(0xaaf)][_0x3f4480(0xcb1)]=_0x3f4480(0xab9),_0x4e91a[_0x3f4480(0x22f)](_0x57b51a);const _0x18c6a5=document[_0x3f4480(0x285)]('div');_0x18c6a5[_0x3f4480(0x81c)]='rules-category-pane\x20active',_0x18c6a5[_0x3f4480(0xaaf)][_0x3f4480(0xcb1)]='global',_0x25bfe5[_0x3f4480(0x22f)](_0x18c6a5);const _0x20bea2=Object['values'](_0x5b873d[_0x3f4480(0x667)])[_0x3f4480(0x3d8)](_0x1213d3=>!_0x1213d3['isGroup']&&_0x2971f9['some'](_0x249d00=>_0x249d00[_0x3f4480(0x94d)]===_0x1213d3['id']));_0x20bea2[_0x3f4480(0xd9a)](_0xa0970f=>{const _0x399e30=_0x3f4480,_0x2860e4=document[_0x399e30(0x285)]('button');_0x2860e4['className']='rules-tab',_0x2860e4['textContent']=_0xa0970f[_0x399e30(0xf74)],_0x2860e4[_0x399e30(0xaaf)]['categoryId']=_0xa0970f['id'],_0x4e91a['appendChild'](_0x2860e4);const _0x5e6b8f=document[_0x399e30(0x285)](_0x399e30(0xb25));_0x5e6b8f['className']=_0x399e30(0xa37),_0x5e6b8f[_0x399e30(0xaaf)][_0x399e30(0xcb1)]=_0xa0970f['id'],_0x25bfe5[_0x399e30(0x22f)](_0x5e6b8f);}),_0x2971f9[_0x3f4480(0xd9a)](_0x271d86=>{const _0x4e8c0b=_0x3f4480,_0x249ddd=_0x29d78c(_0x271d86),_0x4b4190=_0x25bfe5[_0x4e8c0b(0xd16)]('.rules-category-pane[data-category-id=\x22'+_0x271d86[_0x4e8c0b(0x94d)]+'\x22]');_0x4b4190&&_0x4b4190['appendChild'](_0x249ddd);}),document[_0x3f4480(0x35f)](_0x3f4480(0x124c))['forEach'](_0x242a62=>{const _0x107f6b=_0x3f4480;_0x242a62[_0x107f6b(0x1193)](_0x107f6b(0x12a5),()=>_0x2bfca0(_0x242a62[_0x107f6b(0xaaf)][_0x107f6b(0xcb1)]));});}function _0x29d78c(_0x2600eb){const _0x542bd2=_0x41eae2,_0x2b28d3=document[_0x542bd2(0x285)]('div');return _0x2b28d3['className']=_0x542bd2(0xde1)+(_0x2600eb[_0x542bd2(0x1386)]?_0x542bd2(0x104e):''),_0x2b28d3[_0x542bd2(0xaaf)][_0x542bd2(0xde2)]=_0x2600eb['id'],_0x2b28d3[_0x542bd2(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x2600eb[_0x542bd2(0xf74)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0x2600eb[_0x542bd2(0xe1b)]+_0x542bd2(0x590),_0x2b28d3['addEventListener'](_0x542bd2(0x12a5),()=>_0x179d3f(_0x2600eb['id'])),_0xefe9e2(_0x2b28d3,()=>_0x23c010(_0x2600eb['id'])),_0x2b28d3;}async function _0x179d3f(_0x8fb53a=null){const _0x42e2c5=_0x41eae2;_0x3ac599=_0x8fb53a;const _0x51e1c4=document[_0x42e2c5(0x89d)](_0x42e2c5(0xdfb)),_0x5a6bf0=document['getElementById'](_0x42e2c5(0x1340)),_0x421f59=document[_0x42e2c5(0x89d)]('rule-name-input'),_0x3c9ad7=document['getElementById'](_0x42e2c5(0xfe9)),_0x1c064d=document[_0x42e2c5(0x89d)](_0x42e2c5(0xa19)),_0x430704=document[_0x42e2c5(0x89d)](_0x42e2c5(0x63a)),_0x56f0fe=document[_0x42e2c5(0x89d)]('rule-enabled-switch');_0x3c9ad7[_0x42e2c5(0x1ef)]=_0x42e2c5(0x110a),Object[_0x42e2c5(0x4b5)](_0x5b873d['chats'])[_0x42e2c5(0x3d8)](_0x5a01eb=>!_0x5a01eb['isGroup'])['forEach'](_0x5e8464=>{const _0x4ba1fa=_0x42e2c5;_0x3c9ad7['innerHTML']+=_0x4ba1fa(0x3d3)+_0x5e8464['id']+'\x22>'+_0x5e8464[_0x4ba1fa(0xf74)]+'</option>';});if(_0x8fb53a){_0x5a6bf0[_0x42e2c5(0xf12)]=_0x42e2c5(0xbfe);const _0xd84d62=await _0x1a6951[_0x42e2c5(0x1067)]['get'](_0x8fb53a);_0x421f59[_0x42e2c5(0x2f4)]=_0xd84d62[_0x42e2c5(0xf74)],_0x3c9ad7[_0x42e2c5(0x2f4)]=_0xd84d62[_0x42e2c5(0x94d)],_0x1c064d[_0x42e2c5(0x2f4)]=_0xd84d62[_0x42e2c5(0xe1b)],_0x430704[_0x42e2c5(0x2f4)]=_0xd84d62['template'],_0x56f0fe[_0x42e2c5(0x1b0)]=_0xd84d62[_0x42e2c5(0x1386)];}else _0x5a6bf0[_0x42e2c5(0xf12)]=_0x42e2c5(0x1388),_0x421f59[_0x42e2c5(0x2f4)]='',_0x3c9ad7[_0x42e2c5(0x2f4)]='global',_0x1c064d[_0x42e2c5(0x2f4)]='',_0x430704[_0x42e2c5(0x2f4)]='',_0x56f0fe[_0x42e2c5(0x1b0)]=!![];_0x51e1c4['classList'][_0x42e2c5(0x569)]('visible');}async function _0x4abcbf(){const _0x438241=_0x41eae2,_0x2bff4e=document[_0x438241(0x89d)](_0x438241(0xbf7))[_0x438241(0x2f4)]['trim'](),_0x2f443a=document['getElementById'](_0x438241(0xa19))[_0x438241(0x2f4)]['trim']();if(!_0x2bff4e||!_0x2f443a){alert(_0x438241(0xd07));return;}try{new RegExp(_0x2f443a);}catch(_0x5acece){alert(_0x438241(0xed9)+_0x5acece[_0x438241(0x1288)]);return;}const _0x5d4ca8={'name':_0x2bff4e,'chatId':document[_0x438241(0x89d)](_0x438241(0xfe9))[_0x438241(0x2f4)],'regex':_0x2f443a,'template':document[_0x438241(0x89d)](_0x438241(0x63a))[_0x438241(0x2f4)],'isEnabled':document[_0x438241(0x89d)](_0x438241(0x1346))[_0x438241(0x1b0)]};_0x3ac599?await _0x1a6951[_0x438241(0x1067)]['update'](_0x3ac599,_0x5d4ca8):await _0x1a6951[_0x438241(0x1067)][_0x438241(0x569)](_0x5d4ca8),document[_0x438241(0x89d)](_0x438241(0xdfb))[_0x438241(0x2f1)][_0x438241(0x1247)](_0x438241(0x11e4)),await _0x3f0031();}async function _0x23c010(_0x3bf992){const _0x2de6cf=_0x41eae2,_0x42ba23=await _0x4e2abc(_0x2de6cf(0xa9a),_0x2de6cf(0x81b),{'confirmButtonClass':_0x2de6cf(0xcd8)});_0x42ba23&&(await _0x1a6951[_0x2de6cf(0x1067)][_0x2de6cf(0x684)](_0x3bf992),await _0x3f0031());}async function _0x1eb7df(_0x59a9ea,_0x8a7125){const _0xdbb758=_0x41eae2;if(_0x59a9ea[_0xdbb758(0xc3a)]()[_0xdbb758(0x1222)]('<')||!_0x59a9ea[_0xdbb758(0xced)]('[')&&!_0x59a9ea['includes']('{'))return _0x59a9ea;if(!_0x2402b7[_0x8a7125]){console[_0xdbb758(0x471)](_0xdbb758(0xc5f)+_0x8a7125);const _0x4f6b64=await _0x1a6951[_0xdbb758(0x1067)][_0xdbb758(0x176)](_0xdbb758(0x94d))[_0xdbb758(0xb17)](_0xdbb758(0xab9))['or']('chatId')[_0xdbb758(0xb17)](_0x8a7125)[_0xdbb758(0xc2f)]();_0x2402b7[_0x8a7125]=_0x4f6b64[_0xdbb758(0x3d8)](_0x53ebae=>_0x53ebae[_0xdbb758(0x1386)]);}const _0x4bc562=_0x2402b7[_0x8a7125];let _0x3e2d93=_0x59a9ea;for(const _0x547177 of _0x4bc562){try{const _0x78b0e=new RegExp(_0x547177['regex'],'g');let _0x1d33d4=_0x3e2d93;_0x78b0e[_0xdbb758(0xb80)](_0x1d33d4)&&(_0x3e2d93=_0x3e2d93[_0xdbb758(0xfbf)](_0x78b0e,_0x547177[_0xdbb758(0x196)]));}catch(_0x214fa0){console[_0xdbb758(0x1fd)](_0xdbb758(0x7c5)+_0x547177[_0xdbb758(0xf74)]+_0xdbb758(0xd88),_0x214fa0);}}return _0x3e2d93;}function _0x160da7(_0x57cae8){const _0x5783cd=_0x41eae2;if(!_0x57cae8)return'';const _0x1e3390=new Date(),_0x1b7be0=new Date(_0x57cae8),_0xd963fd=String(_0x1b7be0[_0x5783cd(0x9bb)]())['padStart'](0x2,'0'),_0x539eec=String(_0x1b7be0[_0x5783cd(0x446)]())[_0x5783cd(0x4d8)](0x2,'0'),_0x277570=_0xd963fd+':'+_0x539eec;if(_0x1e3390['toDateString']()===_0x1b7be0['toDateString']())return _0x277570;const _0x551f4b=new Date();_0x551f4b[_0x5783cd(0x4d7)](_0x1e3390[_0x5783cd(0x518)]()-0x1);if(_0x551f4b[_0x5783cd(0xba4)]()===_0x1b7be0['toDateString']())return _0x5783cd(0x12c2)+_0x277570;const _0x568ea9=_0x1b7be0[_0x5783cd(0x555)](),_0x4a00ef=String(_0x1b7be0['getMonth']()+0x1)[_0x5783cd(0x4d8)](0x2,'0'),_0x2e7f54=String(_0x1b7be0[_0x5783cd(0x518)]())[_0x5783cd(0x4d8)](0x2,'0');return _0x1e3390[_0x5783cd(0x555)]()===_0x568ea9?_0x4a00ef+'月'+_0x2e7f54+'日\x20'+_0x277570:_0x568ea9+'年'+_0x4a00ef+'月'+_0x2e7f54+'日\x20'+_0x277570;}function _0x40d372(_0xd2b4de){const _0x154339=_0x41eae2,_0x21e037=document[_0x154339(0x285)]('div');_0x21e037[_0x154339(0x81c)]=_0x154339(0x1d6);const _0x386b24=document[_0x154339(0x285)](_0x154339(0xb25));return _0x386b24[_0x154339(0x81c)]=_0x154339(0x368),_0x386b24[_0x154339(0xf12)]=_0x160da7(_0xd2b4de),_0x21e037[_0x154339(0x22f)](_0x386b24),_0x21e037;}async function _0x4e653b(){const _0x36f4ce=_0x41eae2,_0x251f53=_0x5b873d[_0x36f4ce(0x667)][_0x5b873d[_0x36f4ce(0xf96)]];if(!_0x251f53||!lastResponseTimestamps||lastResponseTimestamps[_0x36f4ce(0x7aa)]===0x0){alert(_0x36f4ce(0xb0a));return;}_0x251f53[_0x36f4ce(0x551)]=_0x251f53['history']['filter'](_0x22a2c6=>!lastResponseTimestamps[_0x36f4ce(0xced)](_0x22a2c6[_0x36f4ce(0x114e)])),await _0x1a6951[_0x36f4ce(0x667)][_0x36f4ce(0xc0f)](_0x251f53),await _0x5b89df(_0x5b873d[_0x36f4ce(0xf96)]),_0x5f21e2();}async function _0x173ebd(){const _0xcd4059=_0x41eae2,_0x432c8a=_0x5b873d['chats'][_0x5b873d['activeChatId']];if(!_0x432c8a)return;const _0x823d5=_0x432c8a[_0xcd4059(0x551)]['findLastIndex'](_0x31e9ed=>_0x31e9ed[_0xcd4059(0xa57)]===_0xcd4059(0x116c)&&!_0x31e9ed[_0xcd4059(0x9ae)]);if(_0x823d5===-0x1){alert(_0xcd4059(0xe77));return;}const _0x37162c=_0x432c8a[_0xcd4059(0x551)][_0xcd4059(0xceb)](_0x361509=>_0x361509[_0xcd4059(0xa57)]===_0xcd4059(0x1377));if(_0x37162c<_0x823d5){alert('AI\x20尚未对您的最后一条消息做出回应，无法重新生成。');return;}_0x432c8a[_0xcd4059(0x551)][_0xcd4059(0x776)](_0x823d5+0x1),await _0x1a6951[_0xcd4059(0x667)]['put'](_0x432c8a),await _0x5b89df(_0x5b873d['activeChatId']),await _0x2e3505();}async function _0x5dfdbe(){const _0x14ec57=_0x41eae2;if(!_0x333dc7[_0x14ec57(0xfcb)])return;const _0xe79209=_0x333dc7[_0x14ec57(0x1174)][_0x14ec57(0xceb)](_0x196fb5=>_0x196fb5[_0x14ec57(0xa57)]===_0x14ec57(0x116c));if(_0xe79209===-0x1){alert('通话中还没有你的发言，无法重新生成回应。');return;}_0x333dc7[_0x14ec57(0x1174)][_0x14ec57(0x776)](_0xe79209+0x1);const _0x3ba028=document[_0x14ec57(0x89d)](_0x14ec57(0xae3));_0x3ba028[_0x14ec57(0x1ef)]='',_0x333dc7['callHistory']['forEach'](_0x384134=>{const _0x1f6753=_0x14ec57,_0x5c1793=document[_0x1f6753(0x285)](_0x1f6753(0xb25));_0x5c1793[_0x1f6753(0x81c)]=_0x1f6753(0x212)+_0x384134[_0x1f6753(0xa57)]+_0x1f6753(0x10ea),_0x5c1793[_0x1f6753(0xaaf)][_0x1f6753(0x114e)]=_0x384134[_0x1f6753(0x114e)],_0x384134[_0x1f6753(0xa57)]===_0x1f6753(0x116c)?_0x5c1793[_0x1f6753(0xf12)]=_0x384134[_0x1f6753(0x28c)]:_0x5c1793[_0x1f6753(0x1ef)]=_0x384134['content'],_0xefe9e2(_0x5c1793,()=>_0x29eebd(_0x384134[_0x1f6753(0x114e)])),_0x3ba028[_0x1f6753(0x22f)](_0x5c1793);}),_0x3ba028[_0x14ec57(0xb0e)]=_0x3ba028[_0x14ec57(0x624)],_0x2c1fe5(null);}async function _0x52a46a(){const _0x3a3aba=_0x41eae2,_0x36be47=_0x5b873d[_0x3a3aba(0x667)][_0x5b873d[_0x3a3aba(0xf96)]];if(!_0x36be47)return;_0x405b57(_0x36be47['id'],!![]);const _0x203a5f=document[_0x3a3aba(0x89d)](_0x3a3aba(0x578));!_0x36be47[_0x3a3aba(0x58c)]&&(_0x203a5f[_0x3a3aba(0x68e)][_0x3a3aba(0x50d)]=0x0,setTimeout(()=>{const _0xa770fb=_0x3a3aba;_0x203a5f[_0xa770fb(0xf12)]=_0xa770fb(0x3fe),_0x203a5f[_0xa770fb(0x2f1)][_0xa770fb(0x569)]('typing-status'),_0x203a5f[_0xa770fb(0x68e)]['opacity']=0x1;},0xc8));try{const {proxyUrl:_0x2cf5c5,apiKey:_0x177df7,model:_0x3f9abf}=_0x5b873d[_0x3a3aba(0x30d)];if(!_0x2cf5c5||!_0x177df7||!_0x3f9abf)throw new Error(_0x3a3aba(0x45e));const _0x22266c=parseInt(_0x36be47[_0x3a3aba(0xdb9)]['maxMemory'])||0xa,_0x5a02e1=_0x36be47[_0x3a3aba(0x551)][_0x3a3aba(0xdd0)](-_0x22266c),_0x2f7dbb=new Date(),_0x45a567=new Date(_0x2f7dbb[_0x3a3aba(0xaa6)]()+_0x2f7dbb[_0x3a3aba(0xbcc)]()*0xea60+0x36ee80*0x8),_0x1f1ecb=_0x45a567[_0x3a3aba(0x425)](_0x3a3aba(0x1e8),{'timeZone':_0x3a3aba(0x1207),'dateStyle':_0x3a3aba(0x1219),'timeStyle':_0x3a3aba(0x248)}),_0x3b90fd=_0x10282a(_0x45a567),_0x36d186=_0x36be47[_0x3a3aba(0xdb9)][_0x3a3aba(0xc48)]||'我';let _0x1878ed='';if(_0x36be47[_0x3a3aba(0xdb9)][_0x3a3aba(0x32d)]&&_0x36be47[_0x3a3aba(0xdb9)]['linkedWorldBookIds'][_0x3a3aba(0x7aa)]>0x0){const _0x5584d8=_0x36be47[_0x3a3aba(0xdb9)]['linkedWorldBookIds'][_0x3a3aba(0x412)](_0x151aa0=>{const _0x375f54=_0x3a3aba,_0x4bd651=_0x5b873d[_0x375f54(0x8a1)][_0x375f54(0x12f4)](_0x3ed7c3=>_0x3ed7c3['id']===_0x151aa0);if(!_0x4bd651||!Array['isArray'](_0x4bd651['content']))return'';const _0x4c0d4c=_0x4bd651[_0x375f54(0x28c)]['filter'](_0x5ec44e=>_0x5ec44e[_0x375f54(0x104e)]!==![])[_0x375f54(0x412)](_0x29336d=>{const _0x55f57d=_0x375f54;let _0x23f167=_0x55f57d(0xc77)+(_0x29336d['comment']||'无备注')+'\x0a';if(_0x29336d[_0x55f57d(0xe9c)][_0x55f57d(0x7aa)]>0x0)_0x23f167+=_0x55f57d(0x1dc)+_0x29336d[_0x55f57d(0xe9c)][_0x55f57d(0x1237)](',\x20')+'\x0a';return _0x23f167+='**内容:**\x0a'+_0x29336d['content'],_0x23f167;})[_0x375f54(0x1237)]('');return _0x4c0d4c?_0x375f54(0xb85)+_0x4bd651[_0x375f54(0xf74)]+'\x0a'+_0x4c0d4c:'';})[_0x3a3aba(0x3d8)](Boolean)[_0x3a3aba(0x1237)]('');_0x5584d8&&(_0x1878ed=_0x3a3aba(0x312)+_0x5584d8+_0x3a3aba(0xdf6));}let _0x38347e='';if(_0x1f2ed8[_0x3a3aba(0xfcb)]&&_0x1f2ed8[_0x3a3aba(0xf96)]===_0x36be47['id']){const _0x4084dc=_0x1f2ed8['currentIndex']>-0x1?_0x1f2ed8[_0x3a3aba(0x2c0)][_0x1f2ed8[_0x3a3aba(0x602)]]:null;_0x38347e=_0x3a3aba(0xe6a);}const _0x1279a9=_0x141deb(_0x404de6[_0x36be47['id']]);let _0x460eda='';_0x36be47[_0x3a3aba(0xfe2)]&&_0x36be47['nameHistory'][_0x3a3aba(0x7aa)]>0x0&&(_0x460eda=_0x3a3aba(0x1235)+_0x36be47[_0x3a3aba(0xfe2)][_0x3a3aba(0x1237)](',\x20')+_0x3a3aba(0xbae));let _0x2b68a0='';const _0x48435e=_0x5b873d[_0x3a3aba(0x5c1)][_0x3a3aba(0x22a)]||'用户';_0x2b68a0+=_0x3a3aba(0x109d)+_0x48435e+_0x3a3aba(0x56a);const _0x551d44=Object['values'](_0x5b873d[_0x3a3aba(0x667)])[_0x3a3aba(0x3d8)](_0x39eba4=>_0x39eba4['isGroup']&&_0x39eba4[_0x3a3aba(0x5ab)][_0x3a3aba(0xc5c)](_0x30a829=>_0x30a829['id']===_0x36be47['id']));_0x551d44['length']>0x0&&(_0x2b68a0+=_0x3a3aba(0xfec),_0x551d44[_0x3a3aba(0xd9a)](_0x51bab7=>{const _0x538aba=_0x3a3aba,_0x1d280c=_0x51bab7['settings'][_0x538aba(0xc48)]||_0x48435e;_0x2b68a0+=_0x538aba(0x6bd)+_0x51bab7[_0x538aba(0xf74)]+'”中，用户的昵称是“'+_0x1d280c+_0x538aba(0x1298);}));_0x2b68a0+=_0x3a3aba(0xee1);const _0x2cdbec=_0x5ae1ee(_0x36be47),_0x57f05d=_0x3a3aba(0x1c6)+_0x36be47['originalName']+_0x3a3aba(0x2a4)+_0x1f1ecb+'\x20('+_0x3b90fd+')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20'+(_0x38347e?_0x3a3aba(0xfc6)+_0x38347e:'你们没有在听歌。')+_0x3a3aba(0xf1b)+(_0x36be47['longTermMemory']&&_0x36be47['longTermMemory'][_0x3a3aba(0x7aa)]>0x0?_0x36be47[_0x3a3aba(0xc18)]['map'](_0x26a49b=>'-\x20'+_0x26a49b[_0x3a3aba(0x28c)])['join']('\x0a'):_0x3a3aba(0x12c3))+'\x0a\x0a#\x20你的角色设定\x0a'+_0x36be47['settings']['aiPersona']+_0x3a3aba(0xd6c)+_0x36be47['originalName']+_0x3a3aba(0x4cc)+_0x36be47[_0x3a3aba(0xf74)]+_0x3a3aba(0x8b0)+_0x36d186+_0x3a3aba(0x1d0)+_0x2b68a0+_0x3a3aba(0xc2c)+_0x460eda+'\x0a\x20\x20\x20\x20'+_0x1878ed+_0x3a3aba(0xff3)+_0x2cdbec+_0x3a3aba(0xc90)+(_0x36be47[_0x3a3aba(0xdb9)]['aiAvatarLibrary']&&_0x36be47['settings'][_0x3a3aba(0x614)][_0x3a3aba(0x7aa)]>0x0?_0x36be47[_0x3a3aba(0xdb9)][_0x3a3aba(0x614)][_0x3a3aba(0x412)](_0x5b6c6a=>'-\x20'+_0x5b6c6a['name'])[_0x3a3aba(0x1237)]('\x0a'):_0x3a3aba(0x701))+_0x3a3aba(0x71a)+(_0x36be47[_0x3a3aba(0xdb9)][_0x3a3aba(0xe13)]&&_0x36be47[_0x3a3aba(0xdb9)][_0x3a3aba(0xe13)][_0x3a3aba(0x7aa)]>0x0?_0x36be47['settings'][_0x3a3aba(0xe13)]['map'](_0x35ffee=>'-\x20'+_0x35ffee[_0x3a3aba(0xf74)])[_0x3a3aba(0x1237)]('\x0a'):'-\x20(空)')+_0x3a3aba(0xa11)+_0x36be47[_0x3a3aba(0xdb9)][_0x3a3aba(0x6d4)]+_0x3a3aba(0x1103),_0x9bf18a=_0x5a02e1[_0x3a3aba(0x412)](_0x29b1e5=>({'role':_0x29b1e5['role'],'content':String(_0x29b1e5['content'])}));_0x9bf18a[_0x3a3aba(0x138c)]({'role':_0x3a3aba(0x116c),'content':_0x3a3aba(0xe62)});let _0x4956a3=_0x2cf5c5===GEMINI_API_URL,_0x5a4f8c=_0xa615f4(_0x3f9abf,_0x177df7,_0x57f05d,_0x9bf18a);const _0x3c848b=_0x4956a3?await fetch(_0x5a4f8c[_0x3a3aba(0x11de)],_0x5a4f8c[_0x3a3aba(0xd98)]):await fetch(_0x2cf5c5+_0x3a3aba(0x6dd),{'method':_0x3a3aba(0xd14),'headers':{'Content-Type':_0x3a3aba(0xce4),'Authorization':_0x3a3aba(0x3fb)+_0x177df7},'body':JSON[_0x3a3aba(0x465)]({'model':_0x3f9abf,'messages':[{'role':_0x3a3aba(0x18c),'content':_0x57f05d},..._0x9bf18a],'temperature':_0x5b873d[_0x3a3aba(0x21a)][_0x3a3aba(0x576)]||0.8})});if(!_0x3c848b['ok']){const _0x48707c=await _0x3c848b[_0x3a3aba(0x6b5)]();throw new Error('API\x20请求失败:\x20'+_0x48707c[_0x3a3aba(0x1fd)][_0x3a3aba(0x1288)]);}const _0x2c686d=await _0x3c848b[_0x3a3aba(0x6b5)](),_0x407b46=getGeminiResponseText(_0x2c686d),_0x282842=_0x29a17f(_0x407b46),_0x31767e=[];for(const _0x4810d of _0x282842){if(_0x4810d['type']===_0x3a3aba(0xec9)&&typeof _0x4810d[_0x3a3aba(0x28c)]===_0x3a3aba(0x1224)&&_0x4810d[_0x3a3aba(0x28c)][_0x3a3aba(0xced)]('\x0a')){const _0x1f8aa2=_0x4810d[_0x3a3aba(0x28c)][_0x3a3aba(0x55b)](/\n+/)[_0x3a3aba(0x3d8)](_0x1610ea=>_0x1610ea[_0x3a3aba(0xc3a)]());_0x1f8aa2['forEach'](_0x41f222=>{const _0x5c5edd=_0x3a3aba;_0x31767e[_0x5c5edd(0x138c)]({..._0x4810d,'content':_0x41f222});});}else _0x31767e[_0x3a3aba(0x138c)](_0x4810d);}let _0x174daf=Date[_0x3a3aba(0xf1a)]();for(const _0x508545 of _0x31767e){const _0x4a6527={'role':_0x3a3aba(0x1377),'senderName':_0x36be47[_0x3a3aba(0x1045)],'timestamp':_0x174daf++,'content':_0x508545[_0x3a3aba(0x28c)]||_0x508545['message'],'type':_0x508545[_0x3a3aba(0x48c)]||_0x3a3aba(0xec9)};if(_0x508545['type']===_0x3a3aba(0x347)){if(!_0x36be47['isGroup']){if(_0x508545[_0x3a3aba(0x941)])_0x36be47[_0x3a3aba(0x253)]=String(_0x508545[_0x3a3aba(0x941)]);if(_0x508545['random_jottings'])_0x36be47[_0x3a3aba(0x27e)]=String(_0x508545['random_jottings']);}continue;}_0x36be47[_0x3a3aba(0x551)][_0x3a3aba(0x138c)](_0x4a6527),_0x58deee(_0x4a6527,_0x36be47),await new Promise(_0x5ac2a1=>setTimeout(_0x5ac2a1,Math[_0x3a3aba(0xdc6)]()*0x3e8+0x320));}await _0x1a6951['chats'][_0x3a3aba(0xc0f)](_0x36be47),_0x413d78();}catch(_0x2bf9cb){console[_0x3a3aba(0x1fd)](_0x3a3aba(0xf27),_0x2bf9cb),await _0x532f76(_0x3a3aba(0x10de),_0x3a3aba(0x104a)+_0x2bf9cb[_0x3a3aba(0x1288)]);}finally{_0x405b57(_0x36be47['id'],![]);if(!_0x36be47[_0x3a3aba(0x58c)]&&document[_0x3a3aba(0x89d)](_0x3a3aba(0x578))){const _0x3dc5c0=document[_0x3a3aba(0x89d)]('chat-header-title');_0x3dc5c0[_0x3a3aba(0x68e)][_0x3a3aba(0x50d)]=0x0,setTimeout(()=>{const _0x21af36=_0x3a3aba;_0x3dc5c0[_0x21af36(0xf12)]=_0x36be47[_0x21af36(0xf74)],_0x3dc5c0['classList'][_0x21af36(0x1247)](_0x21af36(0xb51)),_0x3dc5c0[_0x21af36(0x68e)][_0x21af36(0x50d)]=0x1;},0xc8);}}}function _0x4541bb(){const _0xc516c5=_0x41eae2,_0x5d19d2=document[_0xc516c5(0x89d)](_0xc516c5(0xc16)),_0x1299ae=_0x5b873d[_0xc516c5(0x21a)][_0xc516c5(0x261)]||_0x3aca30;_0x1299ae&&_0x1299ae[_0xc516c5(0xc3a)]()&&(_0x5d19d2[_0xc516c5(0x9e3)]=_0x1299ae,_0x5d19d2[_0xc516c5(0x5ad)]()[_0xc516c5(0x1035)](_0x3176ae=>console['log'](_0xc516c5(0x10af),_0x3176ae)));}function _0x178a6e(){const _0xd9dac=_0x41eae2;if(!_0x5b873d['globalSettings'][_0xd9dac(0x4c0)])return;for(const _0x5ad911 in _0x5b873d[_0xd9dac(0x21a)][_0xd9dac(0x4c0)]){const _0x5e8acd=document[_0xd9dac(0x89d)](_0x5ad911),_0x57a2b8=_0x5b873d['globalSettings'][_0xd9dac(0x4c0)][_0x5ad911];_0x5e8acd&&(_0x5e8acd['tagName']===_0xd9dac(0xb96)?_0x5e8acd[_0xd9dac(0x9e3)]=_0x57a2b8:_0x5e8acd[_0xd9dac(0xf12)]=_0x57a2b8);}}function _0x240760(){return new Promise(_0x57485a=>{const _0x21cad1=_0x356e,_0x113d66=document[_0x21cad1(0x285)](_0x21cad1(0x104f));_0x113d66[_0x21cad1(0x48c)]=_0x21cad1(0x455),_0x113d66[_0x21cad1(0xc52)]='image/*',_0x113d66[_0x21cad1(0xd7c)]=_0x4d81d8=>{const _0xdaf6ff=_0x21cad1,_0x2ddb37=_0x4d81d8['target']['files'][0x0];if(_0x2ddb37){const _0x3b5a3b=new FileReader();_0x3b5a3b[_0xdaf6ff(0x736)]=_0x53fdbf=>{const _0x59fd80=_0xdaf6ff;_0x57485a(_0x53fdbf[_0x59fd80(0x225)][_0x59fd80(0x9dc)]);},_0x3b5a3b['readAsDataURL'](_0x2ddb37);}else _0x57485a(null);},_0x113d66[_0x21cad1(0x12a5)]();});}async function _0x1823d1(_0x2fb545){const _0x4d0c88=_0x41eae2,_0x5486a0=_0x2fb545['id'],_0x5c3aac=_0x2fb545[_0x4d0c88(0xf12)],_0x3e23b8=await _0x34d246('修改文字','请输入新的内容：',_0x5c3aac);if(_0x3e23b8!==null&&_0x3e23b8[_0x4d0c88(0xc3a)]()!==''){const _0x2b6fc4=_0x3e23b8[_0x4d0c88(0xc3a)]();_0x2fb545[_0x4d0c88(0xf12)]=_0x2b6fc4,_0x5b873d[_0x4d0c88(0x21a)]['widgetData'][_0x5486a0]=_0x2b6fc4,await _0x1a6951[_0x4d0c88(0x21a)][_0x4d0c88(0xc0f)](_0x5b873d[_0x4d0c88(0x21a)]),alert(_0x4d0c88(0x3d5));}}async function _0x178f2e(_0x5dc847){const _0x46535f=_0x41eae2,_0x13b1cd=_0x5dc847['id'],_0x33c4fc=await _0x4d923b(_0x46535f(0x9cc),[{'text':_0x46535f(0x93c),'value':_0x46535f(0x586)},{'text':'🌐\x20使用网络URL','value':_0x46535f(0x11de)}]);let _0x59d1db=null;if(_0x33c4fc==='local')_0x59d1db=await _0x240760();else _0x33c4fc===_0x46535f(0x11de)&&(_0x59d1db=await _0x34d246(_0x46535f(0x9cc),_0x46535f(0x32e),_0x5dc847['src'],'url'));if(_0x59d1db&&_0x59d1db[_0x46535f(0xc3a)]()){const _0xc75366=_0x59d1db[_0x46535f(0xc3a)]();_0x5dc847[_0x46535f(0x9e3)]=_0xc75366,_0x5b873d['globalSettings'][_0x46535f(0x4c0)][_0x13b1cd]=_0xc75366,await _0x1a6951[_0x46535f(0x21a)][_0x46535f(0xc0f)](_0x5b873d[_0x46535f(0x21a)]),alert('图片已更新！');}else _0x33c4fc===_0x46535f(0x11de)&&_0x59d1db!==null&&alert(_0x46535f(0x6bf));}const _0x541cc3={'getSongCache'(_0x521969,_0x330bde){const _0xed00d6=_0x41eae2,_0x315a95=(_0x330bde||_0xed00d6(0x863))+':'+_0x521969;if(_0x5b873d[_0xed00d6(0x28f)]&&_0x5b873d[_0xed00d6(0x28f)][_0xed00d6(0x8df)]){const _0x5bd572=_0x5b873d[_0xed00d6(0x28f)][_0xed00d6(0x8df)][_0xed00d6(0x650)](_0x315a95);if(_0x5bd572&&Date[_0xed00d6(0xf1a)]()-_0x5bd572[_0xed00d6(0x114e)]<0x36ee80)return _0x5bd572[_0xed00d6(0xd98)];}return null;},'setSongCache'(_0x2f3a83,_0x545912,_0x3213fe){const _0x1a3f8f=_0x41eae2,_0xf5c68d=(_0x3213fe||_0x1a3f8f(0x863))+':'+_0x2f3a83;if(!_0x5b873d[_0x1a3f8f(0x28f)])_0x5b873d[_0x1a3f8f(0x28f)]={};if(!_0x5b873d[_0x1a3f8f(0x28f)][_0x1a3f8f(0x8df)])_0x5b873d[_0x1a3f8f(0x28f)][_0x1a3f8f(0x8df)]=new Map();_0x5b873d[_0x1a3f8f(0x28f)][_0x1a3f8f(0x8df)][_0x1a3f8f(0xd3f)](_0xf5c68d,{'data':_0x545912,'timestamp':Date['now']()});}};typeof Http_Get_External===_0x41eae2(0x1bf)&&(window['Http_Get_External']=function(_0x7dac72){return new Promise(_0x448a97=>{const _0x22f9b1=_0x356e;fetch(_0x7dac72)[_0x22f9b1(0x7ec)](_0x2980a3=>_0x2980a3[_0x22f9b1(0x6b5)]()[_0x22f9b1(0x1035)](()=>_0x2980a3[_0x22f9b1(0xec9)]()))[_0x22f9b1(0x7ec)](_0x448a97)['catch'](()=>_0x448a97(null));});});async function _0xeb8a38(_0x439dcd){return await Http_Get_External(_0x439dcd);}function _0xdb0451(_0x508f0e){return new Promise(_0x41394f=>{const _0x5bd0f1=_0x356e,_0x1be9b3=new Audio();_0x1be9b3[_0x5bd0f1(0x1193)]('loadedmetadata',()=>_0x41394f(!![]),{'once':!![]}),_0x1be9b3['addEventListener'](_0x5bd0f1(0x1fd),()=>_0x41394f(![]),{'once':!![]}),_0x1be9b3[_0x5bd0f1(0x9e3)]=_0x508f0e;});}async function _0x5f9806(_0x2ce1b0,_0x5dc094){const _0x4ccfc8=_0x41eae2;try{let _0x319a23=_0x2ce1b0[_0x4ccfc8(0xfbf)](/\s/g,'');_0x5dc094&&(_0x319a23+='\x20'+_0x5dc094[_0x4ccfc8(0xfbf)](/\s/g,''));const _0x1c341b=_0x4ccfc8(0x107e)+encodeURIComponent(_0x319a23);console['log'](_0x4ccfc8(0x1061),_0x1c341b);const _0x1fc3bd=await fetch(_0x1c341b);if(!_0x1fc3bd['ok'])throw new Error(_0x4ccfc8(0x738)+_0x1fc3bd[_0x4ccfc8(0x632)]);const _0xd05f6a=await _0x1fc3bd[_0x4ccfc8(0x6b5)]();if(_0xd05f6a['code']!==0xc8||!_0xd05f6a[_0x4ccfc8(0xd98)]||_0xd05f6a[_0x4ccfc8(0xd98)][_0x4ccfc8(0x7aa)]===0x0)return console[_0x4ccfc8(0x471)]('网易云音乐API未返回有效结果:',_0xd05f6a),[];return _0xd05f6a['data'][_0x4ccfc8(0x412)](_0x25636e=>({'name':_0x25636e[_0x4ccfc8(0x10a3)],'artist':_0x25636e['singer'],'id':_0x25636e['id'],'cover':_0x25636e[_0x4ccfc8(0x81f)]||_0x4ccfc8(0xd64),'source':'netease'}))['slice'](0x0,0x1e);}catch(_0x1ae3cf){return console[_0x4ccfc8(0x1fd)](_0x4ccfc8(0x1366),_0x1ae3cf),[];}}async function _0x2d7764(_0x11f133){const _0x583fc9=_0x41eae2;try{_0x11f133=_0x11f133[_0x583fc9(0xfbf)](/\s/g,'');const _0x2bb86f=await _0xeb8a38(_0x583fc9(0xf94)+encodeURIComponent(_0x11f133));if(!_0x2bb86f?.[_0x583fc9(0xd98)]?.[_0x583fc9(0x7aa)])return[];return _0x2bb86f['data']['map'](_0x485c09=>({'name':_0x485c09[_0x583fc9(0x10a3)],'artist':_0x485c09['singer'],'id':_0x485c09['id'],'cover':_0x485c09[_0x583fc9(0x81f)]||_0x583fc9(0xdd8),'source':_0x583fc9(0x27b)}))[_0x583fc9(0xdd0)](0x0,0x1e);}catch(_0x1a1b5d){return console[_0x583fc9(0x1fd)](_0x583fc9(0x1328),_0x1a1b5d),[];}}async function _0x35b0bf(){const _0x1f64f6=_0x41eae2,_0x12c761=await _0x34d246('搜索歌曲',_0x1f64f6(0x67b));if(!_0x12c761||!_0x12c761[_0x1f64f6(0xc3a)]())return;await _0x532f76('请稍候...','正在全网搜索歌曲资源...');let _0x5f5c08=_0x12c761[_0x1f64f6(0xc3a)](),_0x395026='';if(_0x12c761[_0x1f64f6(0xced)]('-')||_0x12c761['includes']('–')){const _0x1f484f=_0x12c761['split'](/[-–]/);_0x5f5c08=_0x1f484f[0x0][_0x1f64f6(0xc3a)](),_0x395026=_0x1f484f[_0x1f64f6(0xdd0)](0x1)['join']('\x20')['trim']();}const [_0x54db1d,_0x19db29]=await Promise[_0x1f64f6(0x863)]([_0x5f9806(_0x5f5c08,_0x395026),_0x2d7764(_0x5f5c08)]),_0x47a3ca=[..._0x54db1d,..._0x19db29];if(_0x47a3ca['length']===0x0){await _0x532f76(_0x1f64f6(0xae1),'抱歉，未能找到相关歌曲。');return;}const _0x231201=document['getElementById'](_0x1f64f6(0x372)),_0x35d983=document[_0x1f64f6(0x89d)](_0x1f64f6(0x7c9));_0x35d983[_0x1f64f6(0x1ef)]='',document[_0x1f64f6(0x89d)](_0x1f64f6(0xa18))[_0x1f64f6(0x1b0)]=![],_0x47a3ca[_0x1f64f6(0xd9a)](_0x287fd3=>{const _0x14b682=_0x1f64f6,_0x104fe0=document[_0x14b682(0x285)]('div');_0x104fe0[_0x14b682(0x81c)]=_0x14b682(0x365),_0x104fe0['dataset']['songJson']=JSON[_0x14b682(0x465)](_0x287fd3),_0x104fe0['innerHTML']=_0x14b682(0x6b7)+_0x287fd3[_0x14b682(0xf74)]+_0x14b682(0xafc)+_0x287fd3['artist']+_0x14b682(0x4c4)+(_0x287fd3[_0x14b682(0xa26)]==='netease'?_0x14b682(0x607):_0x14b682(0xa3d))+'</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x35d983[_0x14b682(0x22f)](_0x104fe0);}),_0x231201[_0x1f64f6(0x2f1)][_0x1f64f6(0x569)](_0x1f64f6(0x11e4));}async function _0x35a340(_0x22335a){const _0x257689=_0x41eae2;let _0x55a6a5=null,_0x4b68e2=_0x22335a[_0x257689(0xa26)];const _0x8ce3c5=_0x22335a[_0x257689(0xa26)]==='netease'?_0x257689(0xb13)+_0x22335a['id']:'https://api.vkeys.cn/v2/music/tencent?id='+_0x22335a['id'];let _0x10b1f7=await _0xeb8a38(_0x8ce3c5);_0x10b1f7?.[_0x257689(0xd98)]?.['url']&&(_0x55a6a5={'url':_0x10b1f7[_0x257689(0xd98)][_0x257689(0x11de)],'id':_0x22335a['id'],'source':_0x22335a[_0x257689(0xa26)]});if(!_0x55a6a5){const _0x5f09c9=_0x22335a['source']===_0x257689(0xc31)?'tencent':_0x257689(0xc31),_0x1883df=_0x5f09c9===_0x257689(0x27b)?await _0x2d7764(_0x22335a['name']):await _0x5f9806(_0x22335a[_0x257689(0xf74)],_0x22335a[_0x257689(0x1196)]);if(_0x1883df['length']>0x0){const _0x286178=_0x5f09c9===_0x257689(0xc31)?_0x257689(0xb13)+_0x1883df[0x0]['id']:_0x257689(0xd8c)+_0x1883df[0x0]['id'],_0x4c0d18=await _0xeb8a38(_0x286178);_0x4c0d18?.[_0x257689(0xd98)]?.[_0x257689(0x11de)]&&(_0x55a6a5={'url':_0x4c0d18[_0x257689(0xd98)][_0x257689(0x11de)],'id':_0x1883df[0x0]['id'],'source':_0x5f09c9},_0x4b68e2=_0x5f09c9);}}if(_0x55a6a5){_0x55a6a5[_0x257689(0x11de)]&&typeof _0x55a6a5[_0x257689(0x11de)]===_0x257689(0x1224)&&(_0x55a6a5[_0x257689(0x11de)]=_0x55a6a5['url']['replace'](/^http:\/\//i,'https://'));_0x22335a['cover']&&typeof _0x22335a[_0x257689(0x81f)]===_0x257689(0x1224)&&(_0x22335a['cover']=_0x22335a[_0x257689(0x81f)][_0x257689(0xfbf)](/^http:\/\//i,_0x257689(0x6f5)));const _0x2da695=await _0x167dd5(_0x55a6a5['id'],_0x4b68e2)||'';return{'name':_0x22335a[_0x257689(0xf74)],'artist':_0x22335a['artist'],'src':_0x55a6a5[_0x257689(0x11de)],'cover':_0x22335a[_0x257689(0x81f)],'isLocal':![],'lrcContent':_0x2da695};}return null;}async function _0x167dd5(_0x3c9cc1,_0x20e3bb){const _0x8a0108=_0x41eae2,_0x4a3c81=_0x20e3bb==='netease'?_0x8a0108(0xee3)+_0x3c9cc1:_0x8a0108(0x4f5)+_0x3c9cc1,_0x1069d3=await _0xeb8a38(_0x4a3c81);if(_0x1069d3?.['data']){const _0x5467c1=_0x1069d3[_0x8a0108(0xd98)][_0x8a0108(0x93d)]||_0x1069d3[_0x8a0108(0xd98)][_0x8a0108(0x80b)]||'',_0x70c100=_0x1069d3['data'][_0x8a0108(0xd3d)]||_0x1069d3[_0x8a0108(0xd98)][_0x8a0108(0xf7f)]||'';return _0x5467c1+'\x0a'+_0x70c100;}return'';}async function _0x765d9f(_0xcff58){const _0x4698a0=_0x41eae2;if(_0xcff58<0x0||_0xcff58>=_0x1f2ed8[_0x4698a0(0x2c0)]['length'])return;const _0x50abef=await _0x4d923b(_0x4698a0(0xc9a),[{'text':_0x4698a0(0xcb2),'value':_0x4698a0(0x455)},{'text':_0x4698a0(0x534),'value':_0x4698a0(0xf5f)}]);let _0x1b1cbc=null;if(_0x50abef==='file')_0x1b1cbc=await new Promise(_0x38af97=>{const _0x4dcb72=_0x4698a0,_0x373068=document['getElementById'](_0x4dcb72(0x124d)),_0x2239d7=_0xbab7ea=>{const _0x33a12c=_0x4dcb72,_0xbd20f6=_0xbab7ea[_0x33a12c(0x225)][_0x33a12c(0x541)][0x0];if(_0xbd20f6){const _0x359bbf=new FileReader();_0x359bbf[_0x33a12c(0x736)]=_0xc037a0=>_0x38af97(_0xc037a0[_0x33a12c(0x225)][_0x33a12c(0x9dc)]),_0x359bbf['onerror']=()=>_0x38af97(null),_0x359bbf[_0x33a12c(0x509)](_0xbd20f6);}else _0x38af97(null);_0x373068[_0x33a12c(0xcbb)](_0x33a12c(0x76c),_0x2239d7),_0x373068[_0x33a12c(0x2f4)]='';};_0x373068[_0x4dcb72(0x1193)](_0x4dcb72(0x76c),_0x2239d7,{'once':!![]}),_0x373068[_0x4dcb72(0x12a5)]();});else{if(_0x50abef===_0x4698a0(0xf5f)){const _0x325cef=await _0x34d246(_0x4698a0(0x5b1),_0x4698a0(0x2b6),'',_0x4698a0(0x11b9));if(_0x325cef)_0x1b1cbc=_0x325cef[_0x4698a0(0xfbf)](/\[/g,'\x0a[')[_0x4698a0(0xc3a)]();}}_0x1b1cbc!==null&&(_0x1f2ed8['playlist'][_0xcff58]['lrcContent']=_0x1b1cbc,await _0x4ae954(),_0x1f2ed8[_0x4698a0(0x602)]===_0xcff58&&(_0x1f2ed8[_0x4698a0(0x10c2)]=_0x39f66b(_0x1b1cbc),_0x1673be(),_0x4c53ed()),await _0x532f76('成功','《'+_0x1f2ed8[_0x4698a0(0x2c0)][_0xcff58]['name']+_0x4698a0(0xe38)));}async function _0x983ea5(){const _0x582a15=_0x41eae2;if(_0x1f2ed8[_0x582a15(0x602)]===-0x1)return;const _0x5dc16a=_0x1f2ed8[_0x582a15(0x2c0)][_0x1f2ed8[_0x582a15(0x602)]];if(!_0x5dc16a)return;_0x5dc16a[_0x582a15(0x491)]=!_0x5dc16a['isBgClear'],await _0x4ae954();const _0x1e8cda=document[_0x582a15(0xd16)](_0x582a15(0xa4a)),_0x2e09ac=document[_0x582a15(0x89d)](_0x582a15(0xb04));_0x1e8cda[_0x582a15(0x2f1)]['toggle']('bg-clear',_0x5dc16a[_0x582a15(0x491)]),_0x2e09ac[_0x582a15(0x2f1)][_0x582a15(0x73b)]('active',_0x5dc16a[_0x582a15(0x491)]);}function _0x14c50b(){const _0x3c89cd=_0x41eae2,_0x183a47=document[_0x3c89cd(0x89d)](_0x3c89cd(0xa5b)),_0x10c6c3=document[_0x3c89cd(0x89d)](_0x3c89cd(0xdbf));_0x183a47&&_0x10c6c3&&(_0x183a47[_0x3c89cd(0x2f1)]['toggle'](_0x3c89cd(0x11e4)),_0x10c6c3[_0x3c89cd(0x2f1)]['toggle'](_0x3c89cd(0x8ea)));}function _0x5abadd(){const _0x567663=_0x41eae2,_0x5e887e=document[_0x567663(0xd16)](_0x567663(0xa4a)),_0x560301=document[_0x567663(0x89d)](_0x567663(0x64c));_0x5e887e&&_0x560301&&(_0x5e887e['classList'][_0x567663(0x73b)](_0x567663(0xb28)),_0x560301[_0x567663(0x2f1)][_0x567663(0x73b)](_0x567663(0x10c5)));}window[_0x41eae2(0x3bc)]=_0x5abadd;async function _0x217c27(){const _0x521e53=_0x41eae2;if(_0x1f2ed8[_0x521e53(0x2c0)][_0x521e53(0x7aa)]===0x0){alert(_0x521e53(0xdad));return;}const _0x499a58=await _0x4e2abc(_0x521e53(0x173),_0x521e53(0x677),{'confirmText':_0x521e53(0xe79)});if(!_0x499a58)return;await _0x532f76('请稍候...','正在检查\x20'+_0x1f2ed8[_0x521e53(0x2c0)][_0x521e53(0x7aa)]+_0x521e53(0xaa0));const _0x2f11df=_0x1f2ed8[_0x521e53(0x2c0)][_0x521e53(0x7aa)],_0x45d345=[],_0x3a40af=[],_0x5bcbe7=_0x1f2ed8['playlist']['map'](async _0x5c328f=>{const _0x51ed3c=_0x521e53;if(_0x5c328f[_0x51ed3c(0x2ab)]){_0x45d345[_0x51ed3c(0x138c)](_0x5c328f);return;}const _0x34881b=await _0xdb0451(_0x5c328f[_0x51ed3c(0x9e3)]);_0x34881b?_0x45d345[_0x51ed3c(0x138c)](_0x5c328f):(_0x3a40af[_0x51ed3c(0x138c)](_0x5c328f[_0x51ed3c(0xf74)]),console[_0x51ed3c(0xac3)](_0x51ed3c(0x757)+_0x5c328f['name']+_0x51ed3c(0xc3d)+_0x5c328f['src']));});await Promise[_0x521e53(0x863)](_0x5bcbe7);const _0x7f88e9=_0x2f11df-_0x45d345[_0x521e53(0x7aa)];if(_0x7f88e9>0x0){const _0xd8c83d=_0x1f2ed8['playlist'][_0x1f2ed8[_0x521e53(0x602)]],_0x5cc2b4=_0x3a40af[_0x521e53(0xced)](_0xd8c83d?.[_0x521e53(0xf74)]);_0x1f2ed8[_0x521e53(0x2c0)]=_0x45d345,await _0x4ae954();if(_0x5cc2b4)_0x1e10c1['pause'](),_0x1e10c1[_0x521e53(0x9e3)]='',_0x1f2ed8[_0x521e53(0x602)]=_0x1f2ed8[_0x521e53(0x2c0)]['length']>0x0?0x0:-0x1,_0x1f2ed8[_0x521e53(0xaa4)]=![];else _0xd8c83d&&(_0x1f2ed8['currentIndex']=_0x1f2ed8[_0x521e53(0x2c0)][_0x521e53(0x9d7)](_0x250be1=>_0x250be1[_0x521e53(0x9e3)]===_0xd8c83d[_0x521e53(0x9e3)]));_0x45027b(),_0x2f3a2e(),await _0x532f76(_0x521e53(0x59d),_0x521e53(0xb7a)+_0x7f88e9+'\x20首无效歌曲:\x0a\x0a-\x20'+_0x3a40af[_0x521e53(0x1237)](_0x521e53(0x9b6)));}else await _0x532f76(_0x521e53(0x7e4),'所有歌曲链接均有效，无需清理！');}function _0x203037(){const _0x88629d=_0x41eae2,_0x2337bb=document[_0x88629d(0x89d)](_0x88629d(0x34e));_0x2337bb[_0x88629d(0x2f1)][_0x88629d(0x73b)](_0x88629d(0x1294),!!_0x5b873d[_0x88629d(0x21a)][_0x88629d(0x1f0)]);}async function _0x501d5e(){const _0x267dbe=_0x41eae2,_0x468b11=document['getElementById']('clear-posts-modal'),_0x53affe=document[_0x267dbe(0x89d)]('clear-posts-list');_0x53affe['innerHTML']='';const _0x30f6a3=[];_0x30f6a3[_0x267dbe(0x138c)]({'text':_0x267dbe(0xc10),'value':_0x267dbe(0x863),'isDanger':!![]});const _0xd0b021=_0x5b873d[_0x267dbe(0x5c1)][_0x267dbe(0x22a)]||'我';_0x30f6a3['push']({'text':_0x267dbe(0x11a7)+_0xd0b021+_0x267dbe(0xed2),'value':_0x267dbe(0x116c)}),Object[_0x267dbe(0x4b5)](_0x5b873d[_0x267dbe(0x667)])[_0x267dbe(0xd9a)](_0x33297e=>{const _0x413156=_0x267dbe;!_0x33297e[_0x413156(0x58c)]&&_0x30f6a3['push']({'text':_0x413156(0x11a7)+_0x33297e[_0x413156(0xf74)]+_0x413156(0x1fb),'value':_0x33297e['id']});});try{const _0x1fa7ab=await _0x1a6951[_0x267dbe(0x8ce)]['toArray']();_0x1fa7ab['length']>0x0&&(_0x30f6a3[_0x267dbe(0x138c)]({'isSeparator':!![],'text':_0x267dbe(0xf69)}),_0x1fa7ab[_0x267dbe(0xd9a)](_0x53dc13=>{const _0x3aed53=_0x267dbe;_0x30f6a3[_0x3aed53(0x138c)]({'text':_0x3aed53(0x11a7)+_0x53dc13[_0x3aed53(0xf74)]+_0x3aed53(0x9d4),'value':'npc_'+_0x53dc13['id']});}));}catch(_0x524dde){console[_0x267dbe(0x1fd)](_0x267dbe(0xdf8),_0x524dde);}_0x30f6a3[_0x267dbe(0xd9a)](_0x54a316=>{const _0x497260=_0x267dbe;if(_0x54a316['isSeparator']){const _0x244910=document[_0x497260(0x285)](_0x497260(0xb25));_0x244910[_0x497260(0xf12)]=_0x54a316[_0x497260(0xec9)],_0x244910[_0x497260(0x68e)][_0x497260(0x137a)]=_0x497260(0xb20),_0x53affe[_0x497260(0x22f)](_0x244910);return;}const _0x4fc52d=document['createElement'](_0x497260(0xb25));_0x4fc52d[_0x497260(0x81c)]=_0x497260(0x80e),_0x54a316[_0x497260(0x4ae)]&&_0x4fc52d[_0x497260(0x2f1)][_0x497260(0x569)](_0x497260(0x3b3)),_0x4fc52d['dataset']['targetId']=_0x54a316[_0x497260(0x2f4)],_0x4fc52d['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x54a316[_0x497260(0xec9)]+_0x497260(0xf9a),_0x53affe['appendChild'](_0x4fc52d);}),_0x468b11[_0x267dbe(0x2f1)][_0x267dbe(0x569)](_0x267dbe(0x11e4));}async function _0x584136(){const _0x337450=_0x41eae2,_0x611c13=document[_0x337450(0x35f)]('#clear-posts-list\x20.clear-posts-item.selected');if(_0x611c13['length']===0x0){alert(_0x337450(0x12f3));return;}const _0x2bfdec=Array[_0x337450(0x321)](_0x611c13)['map'](_0x58d53d=>_0x58d53d['dataset']['targetId']);let _0x235b89=[];_0x2bfdec[_0x337450(0xced)](_0x337450(0x863))?_0x235b89[_0x337450(0x138c)]('所有动态'):(_0x2bfdec[_0x337450(0xced)](_0x337450(0x116c))&&_0x235b89[_0x337450(0x138c)]('“'+_0x5b873d['qzoneSettings'][_0x337450(0x22a)]+'”'),_0x2bfdec[_0x337450(0xd9a)](_0xb5b35c=>{const _0x56efae=_0x337450,_0x1eddaa=_0x5b873d[_0x56efae(0x667)][_0xb5b35c];_0x1eddaa&&_0x235b89[_0x56efae(0x138c)]('“'+_0x1eddaa['name']+'”');}));const _0x5a757b=_0x337450(0xd52)+_0x235b89[_0x337450(0x1237)]('、\x20')+_0x337450(0x813),_0x30a798=await _0x4e2abc(_0x337450(0x9a0),_0x5a757b,{'confirmButtonClass':'btn-danger','confirmText':_0x337450(0x8ae)});if(!_0x30a798)return;try{_0x2bfdec[_0x337450(0xced)](_0x337450(0x863))?await _0x1a6951[_0x337450(0xea0)]['clear']():await _0x1a6951['qzonePosts'][_0x337450(0x176)](_0x337450(0xc3f))[_0x337450(0x9b2)](_0x2bfdec)['delete'](),_0xbd77bc=await _0x1a6951[_0x337450(0xea0)][_0x337450(0x6ed)](_0x337450(0x114e))[_0x337450(0x854)]()[_0x337450(0xc2f)](),_0x4cbc61=0x0,await _0x155816(),document[_0x337450(0x89d)](_0x337450(0x134a))[_0x337450(0x2f1)]['remove'](_0x337450(0x11e4)),await _0x532f76(_0x337450(0xc43),_0x337450(0x1261));}catch(_0x57a587){console['error'](_0x337450(0x874),_0x57a587),await _0x532f76(_0x337450(0x10de),_0x337450(0x10e3)+_0x57a587['message']);}}async function _0x4f0f22(_0x42cc8e){const _0x168637=_0x41eae2,_0x5811b0=await _0x4e2abc(_0x168637(0x3da),_0x168637(0x12d5),{'confirmButtonClass':_0x168637(0xcd8),'confirmText':'确认删除'});if(_0x5811b0){const _0x5d13f0=_0x5b873d[_0x168637(0x667)][_0x5b873d['activeChatId']];if(!_0x5d13f0||!_0x5d13f0[_0x168637(0x1152)])return;const _0x94d203=_0x5d13f0[_0x168637(0x1152)][_0x168637(0x9d7)](_0x224337=>_0x224337[_0x168637(0x114e)]===_0x42cc8e);if(_0x94d203===-0x1)return;const _0x86d719=_0x94d203===_0x5d13f0[_0x168637(0x1152)][_0x168637(0x7aa)]-0x1;_0x5d13f0[_0x168637(0x1152)]=_0x5d13f0[_0x168637(0x1152)][_0x168637(0x3d8)](_0x322557=>_0x322557['timestamp']!==_0x42cc8e);if(_0x86d719){if(_0x5d13f0['thoughtsHistory'][_0x168637(0x7aa)]>0x0){const _0x5c94dd=_0x5d13f0[_0x168637(0x1152)][_0x5d13f0['thoughtsHistory'][_0x168637(0x7aa)]-0x1];_0x5d13f0[_0x168637(0x253)]=_0x5c94dd[_0x168637(0x253)],_0x5d13f0[_0x168637(0x27e)]=_0x5c94dd['randomJottings'];const _0x139f38=document[_0x168637(0x89d)]('profile-heartfelt-voice'),_0x44fbca=document['getElementById']('profile-random-jottings');if(_0x139f38)_0x139f38[_0x168637(0xf12)]=_0x5d13f0[_0x168637(0x253)];if(_0x44fbca)_0x44fbca['textContent']=_0x5d13f0[_0x168637(0x27e)];console[_0x168637(0x471)](_0x168637(0x293));}else{_0x5d13f0[_0x168637(0x253)]=_0x168637(0x1046),_0x5d13f0[_0x168637(0x27e)]=_0x168637(0x1046);const _0x473f55=document[_0x168637(0x89d)]('profile-heartfelt-voice'),_0x377efa=document[_0x168637(0x89d)]('profile-random-jottings');if(_0x473f55)_0x473f55[_0x168637(0xf12)]=_0x5d13f0[_0x168637(0x253)];if(_0x377efa)_0x377efa[_0x168637(0xf12)]=_0x5d13f0[_0x168637(0x27e)];console[_0x168637(0x471)](_0x168637(0xda3));}}await _0x1a6951[_0x168637(0x667)]['put'](_0x5d13f0),_0x29fdd3(),await _0x532f76('成功',_0x168637(0x102a));}}document['getElementById']('thoughts-history-list')[_0x41eae2(0x1193)](_0x41eae2(0x12a5),_0x374556=>{const _0x57065e=_0x41eae2,_0x315b09=_0x374556[_0x57065e(0x225)]['closest'](_0x57065e(0x9bf));if(_0x315b09){const _0x3d2da0=parseInt(_0x315b09[_0x57065e(0xaaf)][_0x57065e(0x114e)]);!isNaN(_0x3d2da0)&&_0x4f0f22(_0x3d2da0);}});async function _0x46f316(){const _0x1d8644=_0x41eae2,_0x2c1e65=document[_0x1d8644(0x89d)](_0x1d8644(0x1284));_0x2c1e65[_0x1d8644(0x1ef)]=_0x1d8644(0xf01);const _0x4f246f=await _0x1a6951[_0x1d8644(0xd09)][_0x1d8644(0x176)](_0x1d8644(0x48c))[_0x1d8644(0xb17)](_0x1d8644(0x709))[_0x1d8644(0xc2f)]();_0x4f246f[_0x1d8644(0xd9a)](_0x157ebd=>{const _0x1669d4=_0x1d8644,_0x1a9c8d=document['createElement']('option');_0x1a9c8d['value']=_0x157ebd['id'],_0x1a9c8d['textContent']=_0x157ebd[_0x1669d4(0xf74)],_0x2c1e65[_0x1669d4(0x22f)](_0x1a9c8d);});}async function _0xa4ad3a(){const _0x37b90d=_0x41eae2,_0x45dabb=document[_0x37b90d(0x89d)]('css-preset-select'),_0xf48737=parseInt(_0x45dabb[_0x37b90d(0x2f4)]);if(isNaN(_0xf48737))return;const _0x4c1ed5=await _0x1a6951[_0x37b90d(0xd09)]['get'](_0xf48737);if(_0x4c1ed5){const _0x5f3f91=document['getElementById']('global-css-input');_0x5f3f91[_0x37b90d(0x2f4)]=_0x4c1ed5['value'],_0x446f71(_0x4c1ed5['value']);}}async function _0x7d087a(){const _0x194eef=_0x41eae2,_0x3dec4c=await _0x34d246(_0x194eef(0x43e),_0x194eef(0x9e1));if(!_0x3dec4c||!_0x3dec4c[_0x194eef(0xc3a)]())return;const _0x180fcc=document[_0x194eef(0x89d)](_0x194eef(0xbb4))[_0x194eef(0x2f4)],_0x2dfdbb=await _0x1a6951[_0x194eef(0xd09)]['where']({'name':_0x3dec4c[_0x194eef(0xc3a)](),'type':_0x194eef(0x709)})['first']();if(_0x2dfdbb){const _0x520c10=await _0x4e2abc(_0x194eef(0x174),_0x194eef(0xa06)+_0x3dec4c[_0x194eef(0xc3a)]()+_0x194eef(0x6c7),{'confirmButtonClass':_0x194eef(0xcd8)});if(!_0x520c10)return;await _0x1a6951[_0x194eef(0xd09)][_0x194eef(0xdfc)](_0x2dfdbb['id'],{'value':_0x180fcc});}else await _0x1a6951[_0x194eef(0xd09)][_0x194eef(0x569)]({'name':_0x3dec4c[_0x194eef(0xc3a)](),'type':_0x194eef(0x709),'value':_0x180fcc});await _0x46f316(),alert('CSS\x20预设已保存！');}async function _0x4fce88(){const _0x446a7e=_0x41eae2,_0x423fa8=document[_0x446a7e(0x89d)]('css-preset-select'),_0x51bcb7=parseInt(_0x423fa8[_0x446a7e(0x2f4)]);if(isNaN(_0x51bcb7)){alert('请先从下拉框中选择一个要删除的预设。');return;}const _0x2c457d=await _0x1a6951['appearancePresets'][_0x446a7e(0x650)](_0x51bcb7);if(!_0x2c457d)return;const _0x4d75b8=await _0x4e2abc(_0x446a7e(0xedd),_0x446a7e(0x1050)+_0x2c457d['name']+_0x446a7e(0x100e),{'confirmButtonClass':_0x446a7e(0xcd8)});_0x4d75b8&&(await _0x1a6951['appearancePresets'][_0x446a7e(0x684)](_0x51bcb7),await _0x46f316(),alert(_0x446a7e(0x1301)));}async function _0x2a4748(){const _0x3df1af=_0x41eae2,_0x2ad52d=document[_0x3df1af(0x89d)]('font-preset-select');_0x2ad52d[_0x3df1af(0x1ef)]=_0x3df1af(0xf01);const _0x22c14f=await _0x1a6951[_0x3df1af(0xd09)][_0x3df1af(0x176)](_0x3df1af(0x48c))['equals'](_0x3df1af(0x8e9))[_0x3df1af(0xc2f)]();_0x22c14f['forEach'](_0x5c9198=>{const _0x287135=_0x3df1af,_0xc951bd=document[_0x287135(0x285)](_0x287135(0xc39));_0xc951bd['value']=_0x5c9198['id'],_0xc951bd['textContent']=_0x5c9198[_0x287135(0xf74)],_0x2ad52d[_0x287135(0x22f)](_0xc951bd);});}async function _0x3bfb4e(){const _0x114228=_0x41eae2,_0x241ba9=document['getElementById'](_0x114228(0xbe9)),_0x5273b2=parseInt(_0x241ba9[_0x114228(0x2f4)]);if(isNaN(_0x5273b2))return;const _0x47fcb8=await _0x1a6951[_0x114228(0xd09)][_0x114228(0x650)](_0x5273b2);if(_0x47fcb8){const _0x451fe1=document[_0x114228(0x89d)]('font-url-input');_0x451fe1[_0x114228(0x2f4)]=_0x47fcb8[_0x114228(0x2f4)],_0x3866c6(_0x47fcb8[_0x114228(0x2f4)],!![]);}}async function _0x5d4308(){const _0x4e18ac=_0x41eae2,_0x4ea8e6=await _0x34d246(_0x4e18ac(0xa7c),_0x4e18ac(0x9e1));if(!_0x4ea8e6||!_0x4ea8e6['trim']())return;const _0xba62cf=document['getElementById'](_0x4e18ac(0x7eb))[_0x4e18ac(0x2f4)][_0x4e18ac(0xc3a)]();if(!_0xba62cf){alert(_0x4e18ac(0xe0a));return;}const _0x356a4b=await _0x1a6951['appearancePresets'][_0x4e18ac(0x176)]({'name':_0x4ea8e6['trim'](),'type':_0x4e18ac(0x8e9)})[_0x4e18ac(0x2a6)]();if(_0x356a4b){const _0x6c31aa=await _0x4e2abc(_0x4e18ac(0x174),'名为\x20“'+_0x4ea8e6[_0x4e18ac(0xc3a)]()+_0x4e18ac(0x6c7),{'confirmButtonClass':_0x4e18ac(0xcd8)});if(!_0x6c31aa)return;await _0x1a6951[_0x4e18ac(0xd09)][_0x4e18ac(0xdfc)](_0x356a4b['id'],{'value':_0xba62cf});}else await _0x1a6951['appearancePresets']['add']({'name':_0x4ea8e6[_0x4e18ac(0xc3a)](),'type':_0x4e18ac(0x8e9),'value':_0xba62cf});await _0x2a4748(),alert(_0x4e18ac(0x421));}async function _0x2b9729(){const _0x4da722=_0x41eae2,_0x1dc6ea=document[_0x4da722(0x89d)]('font-preset-select'),_0x20517f=parseInt(_0x1dc6ea['value']);if(isNaN(_0x20517f)){alert(_0x4da722(0x751));return;}const _0x17185a=await _0x1a6951[_0x4da722(0xd09)][_0x4da722(0x650)](_0x20517f);if(!_0x17185a)return;const _0x5ecfed=await _0x4e2abc(_0x4da722(0xedd),_0x4da722(0x1050)+_0x17185a[_0x4da722(0xf74)]+_0x4da722(0x100e),{'confirmButtonClass':_0x4da722(0xcd8)});_0x5ecfed&&(await _0x1a6951[_0x4da722(0xd09)][_0x4da722(0x684)](_0x20517f),await _0x2a4748(),alert(_0x4da722(0x1301)));}async function _0x2a0bb4(){const _0x19f067=_0x41eae2,_0x2df088=document[_0x19f067(0x89d)](_0x19f067(0x1173));_0x2df088[_0x19f067(0x1ef)]=_0x19f067(0xf01);const _0x48b1f6=await _0x1a6951['appearancePresets']['where'](_0x19f067(0x48c))[_0x19f067(0xb17)](_0x19f067(0x2bb))[_0x19f067(0xc2f)]();_0x48b1f6[_0x19f067(0xd9a)](_0x42dadf=>{const _0x19fe49=_0x19f067,_0x5802e3=document[_0x19fe49(0x285)]('option');_0x5802e3[_0x19fe49(0x2f4)]=_0x42dadf['id'],_0x5802e3[_0x19fe49(0xf12)]=_0x42dadf['name'],_0x2df088[_0x19fe49(0x22f)](_0x5802e3);});const _0x3648b9={'wallpaper':_0x5b873d[_0x19f067(0x21a)][_0x19f067(0xd92)],'cphoneWallpaper':_0x5b873d[_0x19f067(0x21a)][_0x19f067(0x5fa)],'globalChatBackground':_0x5b873d[_0x19f067(0x21a)][_0x19f067(0xcdb)],'appIcons':_0x5b873d['globalSettings']['appIcons'],'cphoneAppIcons':_0x5b873d[_0x19f067(0x21a)][_0x19f067(0xf1e)],'chatActionButtonsOrder':_0x5b873d['globalSettings']['chatActionButtonsOrder'],'theme':localStorage[_0x19f067(0x1344)](_0x19f067(0xbe6))||_0x19f067(0x5b7),'showStatusBar':_0x5b873d[_0x19f067(0x21a)][_0x19f067(0x1f0)],'notificationSoundUrl':_0x5b873d[_0x19f067(0x21a)][_0x19f067(0x261)],'widgetData':_0x5b873d[_0x19f067(0x21a)][_0x19f067(0x4c0)]};let _0x32cdf9=null;for(const _0x418986 of _0x48b1f6){if(JSON[_0x19f067(0x465)](_0x418986['value'])===JSON[_0x19f067(0x465)](_0x3648b9)){_0x32cdf9=_0x418986['id'];break;}}_0x32cdf9?_0x2df088[_0x19f067(0x2f4)]=_0x32cdf9:_0x2df088['value']='';}async function _0x329cad(){const _0x579b87=_0x41eae2,_0x17dcc1=document[_0x579b87(0x89d)](_0x579b87(0x1173)),_0x205f1b=parseInt(_0x17dcc1[_0x579b87(0x2f4)]);if(isNaN(_0x205f1b))return;const _0x1a09a1=await _0x1a6951[_0x579b87(0xd09)][_0x579b87(0x650)](_0x205f1b);if(_0x1a09a1&&_0x1a09a1[_0x579b87(0x2f4)]){const _0x1aa4f0=_0x1a09a1['value'];Object[_0x579b87(0x4e0)](_0x5b873d[_0x579b87(0x21a)],_0x1aa4f0),_0x2bb324(_0x1aa4f0[_0x579b87(0x85e)]||_0x579b87(0x5b7)),await _0x1a6951[_0x579b87(0x21a)]['put'](_0x5b873d[_0x579b87(0x21a)]),_0x550834(),_0x35a5b0(),_0x337978(),_0x3a9268(),_0x203037(),_0x178a6e(),_0x245609(),alert(_0x579b87(0x100d)+_0x1a09a1[_0x579b87(0xf74)]+'”');}}async function _0x25b915(){const _0x37dc8d=_0x41eae2,_0x5e87a9=await _0x34d246(_0x37dc8d(0xe6f),_0x37dc8d(0x9e1));if(!_0x5e87a9||!_0x5e87a9[_0x37dc8d(0xc3a)]())return;const _0x223819={'wallpaper':_0x5b873d['globalSettings'][_0x37dc8d(0xd92)],'cphoneWallpaper':_0x5b873d[_0x37dc8d(0x21a)][_0x37dc8d(0x5fa)],'globalChatBackground':_0x5b873d[_0x37dc8d(0x21a)][_0x37dc8d(0xcdb)],'appIcons':_0x5b873d[_0x37dc8d(0x21a)][_0x37dc8d(0x361)],'cphoneAppIcons':_0x5b873d[_0x37dc8d(0x21a)][_0x37dc8d(0xf1e)],'chatActionButtonsOrder':_0x5b873d[_0x37dc8d(0x21a)][_0x37dc8d(0xfb8)],'theme':localStorage[_0x37dc8d(0x1344)](_0x37dc8d(0xbe6))||_0x37dc8d(0x5b7),'showStatusBar':_0x5b873d['globalSettings'][_0x37dc8d(0x1f0)],'notificationSoundUrl':_0x5b873d[_0x37dc8d(0x21a)][_0x37dc8d(0x261)],'widgetData':_0x5b873d['globalSettings'][_0x37dc8d(0x4c0)]},_0x5b4f8a=await _0x1a6951[_0x37dc8d(0xd09)][_0x37dc8d(0x176)]({'name':_0x5e87a9[_0x37dc8d(0xc3a)](),'type':'appearance'})['first']();if(_0x5b4f8a){const _0x2db80a=await _0x4e2abc(_0x37dc8d(0x174),_0x37dc8d(0xa06)+_0x5e87a9['trim']()+_0x37dc8d(0x6c7),{'confirmButtonClass':_0x37dc8d(0xcd8)});if(!_0x2db80a)return;await _0x1a6951['appearancePresets'][_0x37dc8d(0xdfc)](_0x5b4f8a['id'],{'value':_0x223819});}else await _0x1a6951['appearancePresets'][_0x37dc8d(0x569)]({'name':_0x5e87a9[_0x37dc8d(0xc3a)](),'type':_0x37dc8d(0x2bb),'value':_0x223819});await _0x2a0bb4(),alert(_0x37dc8d(0x862));}async function _0x5f8843(){const _0xb0c54e=_0x41eae2,_0x7b300f=document[_0xb0c54e(0x89d)]('appearance-preset-select'),_0x497b35=parseInt(_0x7b300f[_0xb0c54e(0x2f4)]);if(isNaN(_0x497b35)){alert(_0xb0c54e(0x751));return;}const _0x5846fe=await _0x1a6951[_0xb0c54e(0xd09)][_0xb0c54e(0x650)](_0x497b35);if(!_0x5846fe)return;const _0xdfc8d9=await _0x4e2abc('删除预设',_0xb0c54e(0x1050)+_0x5846fe[_0xb0c54e(0xf74)]+_0xb0c54e(0x100e),{'confirmButtonClass':_0xb0c54e(0xcd8)});_0xdfc8d9&&(await _0x1a6951[_0xb0c54e(0xd09)][_0xb0c54e(0x684)](_0x497b35),await _0x2a0bb4(),alert('预设已删除。'));}async function _0x4cb1f8(){const _0x46e605=_0x41eae2,_0xfa4d40=document[_0x46e605(0x89d)](_0x46e605(0x132b));_0xfa4d40[_0x46e605(0x1ef)]=_0x46e605(0xf01);const _0x22fe3a=await _0x1a6951[_0x46e605(0xd09)][_0x46e605(0x176)](_0x46e605(0x48c))['equals']('bubble_theme')['toArray']();_0x22fe3a['forEach'](_0x7f3602=>{const _0x1fd613=_0x46e605,_0x3f2ff4=document[_0x1fd613(0x285)](_0x1fd613(0xc39));_0x3f2ff4[_0x1fd613(0x2f4)]=_0x7f3602['id'],_0x3f2ff4[_0x1fd613(0xf12)]=_0x7f3602[_0x1fd613(0xf74)],_0xfa4d40['appendChild'](_0x3f2ff4);});}async function _0x137610(){const _0x2ede26=_0x41eae2,_0x4d2c9f=document[_0x2ede26(0x89d)](_0x2ede26(0x132b)),_0x3d19c2=parseInt(_0x4d2c9f[_0x2ede26(0x2f4)]);if(isNaN(_0x3d19c2))return;const _0xe36e2b=await _0x1a6951[_0x2ede26(0xd09)][_0x2ede26(0x650)](_0x3d19c2);if(_0xe36e2b){const _0x1432f5=_0xe36e2b[_0x2ede26(0x2f4)]['base']||'default',_0x311c68=_0xe36e2b['value'][_0x2ede26(0xb8f)]||'',_0x478622=document[_0x2ede26(0xd16)](_0x2ede26(0x11c8)+_0x1432f5+'\x22]');_0x478622&&(_0x478622[_0x2ede26(0x1b0)]=!![]);const _0x1ee745=document[_0x2ede26(0x89d)](_0x2ede26(0xf37));_0x1ee745[_0x2ede26(0x2f4)]=_0x311c68,_0x540a41();}}async function _0x3885ca(){const _0xf5c678=_0x41eae2,_0xa8dde9=await _0x34d246(_0xf5c678(0xa3f),'请输入预设名称');if(!_0xa8dde9||!_0xa8dde9[_0xf5c678(0xc3a)]())return;const _0x4507c7=document['querySelector'](_0xf5c678(0x847)),_0x2a1742=_0x4507c7?_0x4507c7[_0xf5c678(0x2f4)]:_0xf5c678(0xfb4),_0x33dfbd=document['getElementById'](_0xf5c678(0xf37))[_0xf5c678(0x2f4)][_0xf5c678(0xc3a)](),_0x30916c={'base':_0x2a1742,'custom':_0x33dfbd},_0x5460c3=await _0x1a6951[_0xf5c678(0xd09)][_0xf5c678(0x176)]({'name':_0xa8dde9[_0xf5c678(0xc3a)](),'type':'bubble_theme'})[_0xf5c678(0x2a6)]();if(_0x5460c3){const _0x2dd03f=await _0x4e2abc(_0xf5c678(0x174),_0xf5c678(0xa06)+_0xa8dde9[_0xf5c678(0xc3a)]()+_0xf5c678(0x6c7),{'confirmButtonClass':_0xf5c678(0xcd8)});if(!_0x2dd03f)return;await _0x1a6951[_0xf5c678(0xd09)][_0xf5c678(0xdfc)](_0x5460c3['id'],{'value':_0x30916c});}else await _0x1a6951[_0xf5c678(0xd09)][_0xf5c678(0x569)]({'name':_0xa8dde9['trim'](),'type':'bubble_theme','value':_0x30916c});await _0x4cb1f8(),alert(_0xf5c678(0x24a));}async function _0x529bc7(){const _0x2dd852=_0x41eae2,_0x127d8a=document[_0x2dd852(0x89d)](_0x2dd852(0x132b)),_0x4186e5=parseInt(_0x127d8a[_0x2dd852(0x2f4)]);if(isNaN(_0x4186e5)){alert(_0x2dd852(0x751));return;}const _0x581a13=await _0x1a6951[_0x2dd852(0xd09)][_0x2dd852(0x650)](_0x4186e5);if(!_0x581a13)return;const _0x138a2d=await _0x4e2abc(_0x2dd852(0xedd),_0x2dd852(0x1050)+_0x581a13[_0x2dd852(0xf74)]+_0x2dd852(0x100e),{'confirmButtonClass':_0x2dd852(0xcd8)});_0x138a2d&&(await _0x1a6951['appearancePresets'][_0x2dd852(0x684)](_0x4186e5),await _0x4cb1f8(),alert(_0x2dd852(0x1301)));}async function _0x80f825(){const _0x5c9525=_0x41eae2;await _0x5e5175(),document['getElementById'](_0x5c9525(0xeda))[_0x5c9525(0x2f1)][_0x5c9525(0x569)](_0x5c9525(0x11e4));}async function _0x5e5175(){const _0x1a85a8=_0x41eae2,_0x432e09=document[_0x1a85a8(0x89d)](_0x1a85a8(0x5f4)),_0x111801=await _0x1a6951[_0x1a85a8(0x31b)][_0x1a85a8(0xc2f)]();_0x432e09[_0x1a85a8(0x1ef)]='';if(_0x111801[_0x1a85a8(0x7aa)]===0x0){_0x432e09[_0x1a85a8(0x1ef)]=_0x1a85a8(0x10e7);return;}_0x111801[_0x1a85a8(0xd9a)](_0x5ba005=>{const _0x4a373d=_0x1a85a8,_0x2fed1e=document[_0x4a373d(0x285)](_0x4a373d(0xb25));_0x2fed1e['className']=_0x4a373d(0xebb),_0x2fed1e[_0x4a373d(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x5ba005[_0x4a373d(0xf74)]+_0x4a373d(0xe4c)+_0x5ba005['id']+_0x4a373d(0xd39),_0x432e09[_0x4a373d(0x22f)](_0x2fed1e);});}async function _0x8baf88(){const _0xefb8fe=_0x41eae2,_0x25331e=document[_0xefb8fe(0x89d)]('new-sticker-category-name-input'),_0x57b4f2=_0x25331e[_0xefb8fe(0x2f4)][_0xefb8fe(0xc3a)]();if(!_0x57b4f2){alert(_0xefb8fe(0xb79));return;}const _0x4d32f0=await _0x1a6951['stickerCategories'][_0xefb8fe(0x176)](_0xefb8fe(0xf74))[_0xefb8fe(0xb17)](_0x57b4f2)[_0xefb8fe(0x2a6)]();if(_0x4d32f0){alert(_0xefb8fe(0xe5c)+_0x57b4f2+'\x22\x20已经存在了！');return;}await _0x1a6951[_0xefb8fe(0x31b)][_0xefb8fe(0x569)]({'name':_0x57b4f2}),_0x25331e['value']='',await _0x5e5175();}async function _0x49fd0a(_0x5e1605){const _0x1dd82f=_0x41eae2,_0x415b5a=await _0x1a6951[_0x1dd82f(0x31b)]['get'](_0x5e1605);if(!_0x415b5a)return;const _0x2c5473=await _0x1a6951['userStickers']['where'](_0x1dd82f(0xcb1))[_0x1dd82f(0xb17)](_0x5e1605)[_0x1dd82f(0x749)](),_0xe90ab7=_0x2c5473>0x0?'确定要删除分类《'+_0x415b5a[_0x1dd82f(0xf74)]+_0x1dd82f(0xe8b)+_0x2c5473+_0x1dd82f(0x8c7):'确定要删除分类《'+_0x415b5a[_0x1dd82f(0xf74)]+_0x1dd82f(0x80a),_0x6ecc53=await _0x4e2abc(_0x1dd82f(0x123d),_0xe90ab7,{'confirmButtonClass':'btn-danger'});if(_0x6ecc53)try{await _0x1a6951['transaction']('rw',_0x1a6951[_0x1dd82f(0x31b)],_0x1a6951['userStickers'],async()=>{const _0x5b4951=_0x1dd82f,_0x35158e=await _0x1a6951[_0x5b4951(0x210)]['where'](_0x5b4951(0xcb1))['equals'](_0x5e1605)[_0x5b4951(0x568)]();_0x35158e[_0x5b4951(0x7aa)]>0x0&&await _0x1a6951['userStickers'][_0x5b4951(0x6a7)](_0x35158e),await _0x1a6951['stickerCategories'][_0x5b4951(0x684)](_0x5e1605);}),_0x5b873d['userStickers']=await _0x1a6951[_0x1dd82f(0x210)][_0x1dd82f(0xc2f)](),_0x10313e===_0x5e1605&&(_0x10313e=_0x1dd82f(0x863)),await _0x5e5175(),await _0x1e547a(),alert(_0x1dd82f(0xfa3)+_0x415b5a['name']+_0x1dd82f(0xf86));}catch(_0x5f28d2){console[_0x1dd82f(0x1fd)](_0x1dd82f(0x831),_0x5f28d2),alert(_0x1dd82f(0x10eb));}}function _0x41c302(_0x54c00c){const _0xd2da75=_0x41eae2;_0x10313e=_0x54c00c,document[_0xd2da75(0x35f)](_0xd2da75(0xf02))['forEach'](_0xb1225a=>{const _0x1826ef=_0xd2da75;_0xb1225a[_0x1826ef(0x2f1)][_0x1826ef(0x73b)](_0x1826ef(0x8ea),String(_0xb1225a[_0x1826ef(0xaaf)]['categoryId'])===String(_0x54c00c));}),_0x1e547a(![]);const _0x4dda60=document['getElementById']('select-all-stickers-checkbox');if(_0x4dda60)_0x4dda60[_0xd2da75(0x1b0)]=![];}async function _0x1245eb(){const _0x103681=_0x41eae2;if(!_0x5b873d[_0x103681(0xf96)])return;const _0x38f40d=_0x5b873d[_0x103681(0x667)][_0x5b873d[_0x103681(0xf96)]];if(!_0x38f40d)return;try{const _0x3ca812={'type':_0x103681(0x11bd),'version':0x1,'chatData':_0x38f40d},_0x314750=new Blob([JSON['stringify'](_0x3ca812,null,0x2)],{'type':_0x103681(0xce4)}),_0x2a5ccb=URL[_0x103681(0xfc3)](_0x314750),_0x4862c8=document[_0x103681(0x285)]('a');_0x4862c8[_0x103681(0xab6)]=_0x2a5ccb,_0x4862c8[_0x103681(0xb93)]='EPhone-Chat-'+_0x38f40d[_0x103681(0xf74)]+'-'+new Date()['toISOString']()[_0x103681(0x55b)]('T')[0x0]+'.json',_0x4862c8['click'](),URL[_0x103681(0xa1c)](_0x2a5ccb),await _0x532f76(_0x103681(0xf29),'与“'+_0x38f40d[_0x103681(0xf74)]+_0x103681(0x1132));}catch(_0x5441c2){console[_0x103681(0x1fd)](_0x103681(0xb87),_0x5441c2),await _0x532f76('导出失败','发生了一个错误:\x20'+_0x5441c2[_0x103681(0x1288)]);}}async function _0x230ae7(_0x5e0a8a){const _0x3e75a7=_0x41eae2;if(!_0x5e0a8a||!_0x5b873d[_0x3e75a7(0xf96)])return;const _0x42bca6=_0x5b873d[_0x3e75a7(0xf96)],_0x3911d3=_0x5b873d[_0x3e75a7(0x667)][_0x42bca6];try{const _0x4bd5ac=await _0x5e0a8a[_0x3e75a7(0xec9)](),_0x4d4b78=JSON[_0x3e75a7(0x2cb)](_0x4bd5ac);if(_0x4d4b78[_0x3e75a7(0x48c)]!==_0x3e75a7(0x11bd)||!_0x4d4b78['chatData'])throw new Error(_0x3e75a7(0x688));const _0x3a194c=await _0x4e2abc(_0x3e75a7(0xd6a),_0x3e75a7(0x11dc)+_0x3911d3[_0x3e75a7(0xf74)]+_0x3e75a7(0xb64),{'confirmButtonClass':_0x3e75a7(0xcd8),'confirmText':'确认覆盖'});if(!_0x3a194c)return;const _0x16268b=_0x4d4b78['chatData'];_0x16268b['id']=_0x42bca6,await _0x1a6951[_0x3e75a7(0x667)]['put'](_0x16268b),_0x5b873d[_0x3e75a7(0x667)][_0x42bca6]=_0x16268b,await _0x532f76(_0x3e75a7(0x1145),'聊天记录已成功覆盖！正在刷新界面...'),_0x5b89df(_0x42bca6),_0x413d78(),document[_0x3e75a7(0x89d)](_0x3e75a7(0x1303))[_0x3e75a7(0x12a5)]();}catch(_0x137840){console['error']('导入单个聊天时出错:',_0x137840),await _0x532f76(_0x3e75a7(0x53d),'文件解析或应用失败:\x20'+_0x137840[_0x3e75a7(0x1288)]);}}function _0x44e8e1(){const _0x326812=_0x41eae2;_0x59f51a(),_0x4e6c15(_0x326812(0x693));}function _0x59f51a(){const _0xa8bd3d=_0x41eae2,_0x34f470=document['getElementById'](_0xa8bd3d(0x10dd));_0x34f470[_0xa8bd3d(0x1ef)]='';const _0x2b89d8=Object['values'](_0x5b873d['chats'])[_0xa8bd3d(0x3d8)](_0x433b00=>!_0x433b00[_0xa8bd3d(0x58c)]);if(_0x2b89d8[_0xa8bd3d(0x7aa)]===0x0){_0x34f470[_0xa8bd3d(0x1ef)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>';return;}_0x2b89d8[_0xa8bd3d(0xd9a)](_0x341484=>{const _0x2c8eb6=_0xa8bd3d,_0x4dcbe8=document[_0x2c8eb6(0x285)]('div');_0x4dcbe8[_0x2c8eb6(0x81c)]=_0x2c8eb6(0x75f),_0x4dcbe8[_0x2c8eb6(0x1ef)]=_0x2c8eb6(0x8dd)+(_0x341484[_0x2c8eb6(0xdb9)][_0x2c8eb6(0xdd3)]||_0x265fcc)+_0x2c8eb6(0xc6e)+_0x341484[_0x2c8eb6(0xf74)]+_0x2c8eb6(0xf9a),_0x4dcbe8[_0x2c8eb6(0x1193)]('click',()=>_0x33b0b5(_0x341484['id'])),_0x34f470[_0x2c8eb6(0x22f)](_0x4dcbe8);});}async function _0x33b0b5(_0x42c318){const _0x39c520=_0x41eae2;_0x521c79=_0x42c318,console[_0x39c520(0x471)](_0x39c520(0x12b8)+_0x42c318+_0x39c520(0x958)),_0x35a5b0(),_0x3a9268(),_0x2295aa(),_0x4e6c15(_0x39c520(0xed7));}function _0x5e942e(){const _0x477339=_0x41eae2;_0x521c79=null,console['log'](_0x477339(0x1f2)),_0x4e6c15('home-screen');}function _0x2295aa(){const _0x19c14a=_0x41eae2,_0x1ab01a=new Date(),_0x573de6=_0x1ab01a[_0x19c14a(0x110c)](_0x19c14a(0x1e8),{'hour':_0x19c14a(0x810),'minute':_0x19c14a(0x810)}),_0x467e69=_0x1ab01a[_0x19c14a(0x1148)](_0x19c14a(0x1e8),{'weekday':_0x19c14a(0xa65),'month':_0x19c14a(0xa65),'day':'numeric'});document[_0x19c14a(0x89d)]('char-main-time')[_0x19c14a(0xf12)]=_0x573de6,document[_0x19c14a(0x89d)](_0x19c14a(0x540))[_0x19c14a(0xf12)]=_0x467e69,_0x16d75b('char-home-screen');}function _0x16d75b(_0x3bf9de){const _0x6bdfee=_0x41eae2;document['querySelectorAll'](_0x6bdfee(0x793))[_0x6bdfee(0xd9a)](_0x132db0=>_0x132db0[_0x6bdfee(0x2f1)][_0x6bdfee(0x1247)](_0x6bdfee(0x8ea))),document[_0x6bdfee(0x89d)](_0x3bf9de)[_0x6bdfee(0x2f1)][_0x6bdfee(0x569)](_0x6bdfee(0x8ea));}window[_0x41eae2(0x5f6)]=_0x16d75b;async function _0x3b9633(_0x58e3e0){const _0xcbe3ca=_0x41eae2;if(!_0x521c79)return;const _0x577851=_0x5b873d[_0xcbe3ca(0x667)][_0x521c79];await _0x412dd2(_0x521c79,_0x58e3e0);switch(_0x58e3e0){case'qq':_0x314477(),_0x16d75b('char-qq-screen');break;case _0xcbe3ca(0x651):_0x2ae346(),_0x16d75b('char-album-screen');break;case _0xcbe3ca(0x818):_0x469ccb(),_0x16d75b(_0xcbe3ca(0xa83));break;case'taobao':_0x59b018(),_0x16d75b(_0xcbe3ca(0x1327));break;case'memo':_0x1360e3(),_0x16d75b(_0xcbe3ca(0xf39));break;case _0xcbe3ca(0x89a):_0x30d726(),_0x16d75b(_0xcbe3ca(0xdc4));break;case _0xcbe3ca(0x7cb):_0x266f11(),_0x16d75b(_0xcbe3ca(0x278));break;case'music':_0x543fd0(),_0x16d75b(_0xcbe3ca(0x11cb));break;case _0xcbe3ca(0x10f5):_0x482765(),_0x16d75b(_0xcbe3ca(0xcb9));break;}}async function _0x2ae346(){const _0x527853=_0x41eae2,_0x288545=document[_0x527853(0x89d)](_0x527853(0xe6c));_0x288545[_0x527853(0x1ef)]='';if(!_0x521c79)return;const _0x565f14=_0x5b873d[_0x527853(0x667)][_0x521c79],_0x476b62=_0x565f14['simulatedAlbum']||[];if(_0x476b62['length']===0x0){_0x288545[_0x527853(0x1ef)]=_0x527853(0x277);return;}const _0x5eea30=_0x527853(0xd91);_0x476b62[_0x527853(0xd9a)](_0x32a7bb=>{const _0x58db80=_0x527853,_0x278c08=document['createElement'](_0x58db80(0xb25));_0x278c08['className']=_0x58db80(0x69c),_0x278c08[_0x58db80(0xaaf)]['description']=_0x32a7bb['description'],_0x288545[_0x58db80(0x22f)](_0x278c08);if(_0x5b873d[_0x58db80(0x21a)]['enableAiDrawing']){_0x278c08[_0x58db80(0x68e)][_0x58db80(0x96c)]=_0x58db80(0x8ad);const _0x3020d6=/[^\x00-\x7F]/[_0x58db80(0xb80)](_0x32a7bb[_0x58db80(0x895)]),_0x20c18a=_0x32a7bb[_0x58db80(0x895)]&&_0x32a7bb['image_prompt']['trim']()&&!_0x3020d6,_0x55764e=_0x20c18a?_0x32a7bb[_0x58db80(0x895)]:'a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting',_0x1af191=_0x58db80(0x1017)+encodeURIComponent(_0x55764e),_0xa6d8dd=new Image();_0xa6d8dd['onload']=function(){const _0x596109=_0x58db80;_0x278c08[_0x596109(0x68e)][_0x596109(0x1d4)]=_0x596109(0xa0c)+this[_0x596109(0x9e3)]+')';},_0xa6d8dd[_0x58db80(0x1010)]=function(){const _0x52aa72=_0x58db80;_0x278c08[_0x52aa72(0x68e)][_0x52aa72(0x1d4)]=_0x52aa72(0xa0c)+_0x5eea30+')';},_0xa6d8dd[_0x58db80(0x9e3)]=_0x1af191;}else{_0x278c08[_0x58db80(0x68e)][_0x58db80(0x96c)]='#f0f2f5',_0x278c08[_0x58db80(0x68e)][_0x58db80(0x86e)]='1px\x20solid\x20#e0e0e0';const _0x15bcae=document[_0x58db80(0x285)]('p');_0x15bcae[_0x58db80(0x81c)]=_0x58db80(0x206),_0x15bcae[_0x58db80(0xf12)]=_0x32a7bb[_0x58db80(0xf6e)]||_0x58db80(0xf9b),_0x278c08[_0x58db80(0x22f)](_0x15bcae);}});}function _0x469ccb(){const _0x46d596=_0x41eae2,_0x2d78bd=document[_0x46d596(0x89d)](_0x46d596(0xedf));_0x2d78bd[_0x46d596(0x1ef)]='';if(!_0x521c79)return;const _0x17d362=_0x5b873d[_0x46d596(0x667)][_0x521c79],_0x1ff4dc=[_0x17d362[_0x46d596(0xf74)],'爱好','旅游','美食','新闻',..._0x17d362[_0x46d596(0xdb9)]['aiPersona'][_0x46d596(0x55b)](/，|。|\s/)[_0x46d596(0xdd0)](0x0,0x5)],_0x3a3d07=['知乎',_0x46d596(0x9f8),'小红书','微博',_0x46d596(0x836)];for(let _0x1d17d4=0x0;_0x1d17d4<0xf;_0x1d17d4++){const _0x4b445c=_0x1ff4dc[Math[_0x46d596(0x128a)](Math[_0x46d596(0xdc6)]()*_0x1ff4dc['length'])],_0x52ccd5=_0x3a3d07[Math[_0x46d596(0x128a)](Math[_0x46d596(0xdc6)]()*_0x3a3d07[_0x46d596(0x7aa)])],_0x34affe=document[_0x46d596(0x285)](_0x46d596(0xb25));_0x34affe[_0x46d596(0x81c)]=_0x46d596(0x71d),_0x34affe[_0x46d596(0x1ef)]=_0x46d596(0x26e)+_0x4b445c+_0x46d596(0xc3d)+_0x52ccd5+_0x46d596(0x37a)+_0x52ccd5[_0x46d596(0x124b)]()+_0x46d596(0x41d)+_0x4b445c+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x2d78bd['appendChild'](_0x34affe);}}function _0x59b018(){const _0x68f573=_0x41eae2,_0x5bf078=document[_0x68f573(0x89d)](_0x68f573(0xce1));_0x5bf078[_0x68f573(0x1ef)]='';if(!_0x521c79)return;const _0x28265f=_0x5b873d[_0x68f573(0x667)][_0x521c79],_0x4b19a7=_0x28265f[_0x68f573(0x12ca)]?.[_0x68f573(0x325)]||[];if(_0x4b19a7[_0x68f573(0x7aa)]===0x0){_0x5bf078[_0x68f573(0x1ef)]=_0x68f573(0xbe4);return;}_0x4b19a7[_0x68f573(0xd9a)](_0x5b425f=>{const _0x232908=_0x68f573,_0x136c5e=document[_0x232908(0x285)]('div');_0x136c5e[_0x232908(0x81c)]=_0x232908(0xae7),_0x136c5e[_0x232908(0xaaf)][_0x232908(0xb90)]=_0x5b425f['reason'];let _0x3114b8;if(_0x5b873d[_0x232908(0x21a)][_0x232908(0x122b)]){const _0x519a08=_0x232908(0x1017)+encodeURIComponent(_0x5b425f[_0x232908(0x895)]||_0x232908(0xb05));_0x3114b8=_0x232908(0x477)+_0x519a08+'\x22\x20class=\x22product-image\x22>';}else _0x3114b8=_0x232908(0x501)+(_0x5b425f[_0x232908(0xb90)]||_0x232908(0xa0a))+_0x232908(0xde4);_0x136c5e[_0x232908(0x1ef)]=_0x232908(0x100a)+_0x3114b8+_0x232908(0x41e)+_0x5b425f['itemName']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>'+(_0x5b425f[_0x232908(0x162)]||0x0)[_0x232908(0x8f7)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>'+_0x5b425f['status']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x5bf078[_0x232908(0x22f)](_0x136c5e);});}function _0x4b6625(){const _0x1d8122=_0x41eae2;_0x16d75b(_0x1d8122(0x10d3));}function _0x760ba8(){const _0x4e8dcd=_0x41eae2,_0xe42cae=document['getElementById'](_0x4e8dcd(0xe54));_0xe42cae[_0x4e8dcd(0x1ef)]='';if(!_0x521c79)return;const _0xd5a02b=Object['values'](_0x5b873d['chats'])[_0x4e8dcd(0x3d8)](_0x1cc8b3=>{const _0x4e9216=_0x4e8dcd;if(_0x1cc8b3['id']===_0x521c79)return!![];if(_0x1cc8b3['isGroup']&&_0x1cc8b3[_0x4e9216(0x5ab)][_0x4e9216(0xc5c)](_0x5a49d8=>_0x5a49d8['id']===_0x521c79))return!![];return![];});_0xd5a02b['forEach'](_0xd95098=>{const _0x38144e=_0x4e8dcd,_0x1ca6c7=_0x1efd8b(_0xd95098);_0xe42cae[_0x38144e(0x22f)](_0x1ca6c7);});}async function _0x412dd2(_0x2d6097,_0x160fee){const _0x3aabcf=_0x41eae2,_0x91bc2a=_0x5b873d[_0x3aabcf(0x667)][_0x2d6097];if(!_0x91bc2a)return;!_0x91bc2a[_0x3aabcf(0x9ba)]&&(_0x91bc2a[_0x3aabcf(0x9ba)]=[]),_0x91bc2a['appUsageLog']['push']({'appName':_0x160fee,'timestamp':Date[_0x3aabcf(0xf1a)]()}),_0x91bc2a[_0x3aabcf(0x9ba)]['length']>0x32&&_0x91bc2a[_0x3aabcf(0x9ba)][_0x3aabcf(0xcbe)](),await _0x1a6951[_0x3aabcf(0x667)][_0x3aabcf(0xc0f)](_0x91bc2a);}function _0x482765(){const _0x7f7754=_0x41eae2,_0xb0bf48=document['getElementById'](_0x7f7754(0xb8e));_0xb0bf48[_0x7f7754(0x1ef)]='';const _0x2301a5=_0x5b873d['chats'][_0x521c79],_0x26c3fa=(_0x2301a5[_0x7f7754(0x9ba)]||[])['slice']()[_0x7f7754(0x854)]();if(_0x26c3fa[_0x7f7754(0x7aa)]===0x0){_0xb0bf48[_0x7f7754(0x1ef)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>';return;}const _0x39cdb1={'qq':'QQ','album':'相册','browser':_0x7f7754(0xac0),'taobao':'淘宝','memo':_0x7f7754(0x1142),'diary':'日记','amap':'高德地图','usage':_0x7f7754(0x25c)};_0x26c3fa[_0x7f7754(0xd9a)](_0x2eb6dd=>{const _0x3ec57f=_0x7f7754,_0x52aa65=document[_0x3ec57f(0x285)](_0x3ec57f(0xb25));_0x52aa65[_0x3ec57f(0x81c)]='usage-item',_0x52aa65[_0x3ec57f(0x1ef)]=_0x3ec57f(0x10cd)+new Date(_0x2eb6dd[_0x3ec57f(0x114e)])[_0x3ec57f(0x425)]()+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>'+(_0x39cdb1[_0x2eb6dd[_0x3ec57f(0xdd9)]]||_0x2eb6dd[_0x3ec57f(0xdd9)])+_0x3ec57f(0x8b8),_0xb0bf48[_0x3ec57f(0x22f)](_0x52aa65);});}async function _0x172a34(_0x27ef24){const _0x3cd8a6=_0x41eae2,_0x5ee4bb=_0x5b873d[_0x3cd8a6(0x667)][_0x521c79];if(!_0x5ee4bb)return;const _0xf05fc7={'role':'assistant','senderName':_0x5ee4bb[_0x3cd8a6(0x1045)],'type':_0x3cd8a6(0x873),'content':_0x27ef24,'imageUrl':_0x3cd8a6(0xc0b),'timestamp':Date['now']()};_0x5ee4bb[_0x3cd8a6(0x551)]['push'](_0xf05fc7),await _0x1a6951['chats'][_0x3cd8a6(0xc0f)](_0x5ee4bb),_0x5b873d[_0x3cd8a6(0xf96)]===_0x521c79&&_0x58deee(_0xf05fc7,_0x5ee4bb),await _0x532f76('分享成功','“'+_0x5ee4bb[_0x3cd8a6(0xf74)]+'”\x20的位置已发送到你们的聊天中。');}async function _0x5a8a1a(_0x259cb9){const _0x5a7bec=_0x41eae2,_0x5cf901=_0x5b873d[_0x5a7bec(0x667)][_0x521c79];if(!_0x5cf901||!_0x5cf901[_0x5a7bec(0xadb)])return;const _0xed3004=_0x5cf901[_0x5a7bec(0xadb)]['find'](_0x34cdc7=>_0x34cdc7['id']===_0x259cb9);if(_0xed3004){_0x38fb37=_0xed3004;const _0x1089df=document[_0x5a7bec(0x89d)]('char-memo-detail-title'),_0x34c0a3=document[_0x5a7bec(0x89d)](_0x5a7bec(0xaa9)),_0xbd2929=document[_0x5a7bec(0x89d)](_0x5a7bec(0xeff));if(_0x1089df)_0x1089df[_0x5a7bec(0xf12)]=_0xed3004[_0x5a7bec(0x104c)];if(_0x34c0a3)_0x34c0a3['value']=_0xed3004[_0x5a7bec(0x28c)];const _0x4043f8=await _0x1a6951['favorites'][_0x5a7bec(0x176)]({'type':_0x5a7bec(0x694),'content.id':_0x259cb9})[_0x5a7bec(0x2a6)]();_0xbd2929[_0x5a7bec(0x2f1)][_0x5a7bec(0x73b)](_0x5a7bec(0x8ea),!!_0x4043f8),_0x16d75b(_0x5a7bec(0xc91));}}function _0x1360e3(){const _0x2b9023=_0x41eae2,_0xd3a60a=document[_0x2b9023(0x89d)](_0x2b9023(0x3cb));_0xd3a60a[_0x2b9023(0x1ef)]='';const _0x4b4a7d=_0x5b873d['chats'][_0x521c79],_0x512e08=(_0x4b4a7d[_0x2b9023(0xadb)]||[])[_0x2b9023(0xdd0)]()[_0x2b9023(0x854)]();if(_0x512e08[_0x2b9023(0x7aa)]===0x0){_0xd3a60a[_0x2b9023(0x1ef)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>';return;}_0x512e08[_0x2b9023(0xd9a)](_0x369f0f=>{const _0x5ea454=_0x2b9023,_0x51f723=document[_0x5ea454(0x285)](_0x5ea454(0xb25));_0x51f723[_0x5ea454(0x81c)]=_0x5ea454(0xf3a),_0x51f723['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>'+_0x369f0f['title']+_0x5ea454(0xd87)+(_0x369f0f[_0x5ea454(0x28c)]||'')[_0x5ea454(0x55b)]('\x0a')[0x0]+_0x5ea454(0x967),_0x51f723[_0x5ea454(0x1193)]('click',()=>_0x5a8a1a(_0x369f0f['id'])),_0xefe9e2(_0x51f723,()=>deleteMemo(_0x369f0f['id'])),_0xd3a60a['appendChild'](_0x51f723);});}async function _0x4e7a61(_0x1e020e=null){const _0xace2e7=_0x41eae2;_0x4c98af=null;const _0x5f1e6c=await _0x34d246(_0xace2e7(0xbb5),_0xace2e7(0x725));if(_0x5f1e6c===null||!_0x5f1e6c[_0xace2e7(0xc3a)]())return;const _0x44434d=await _0x34d246(_0xace2e7(0xe60)+_0x5f1e6c,'请输入备忘录内容','',_0xace2e7(0x11b9));_0x44434d!==null&&(await _0x2ac5a5({'title':_0x5f1e6c['trim'](),'content':_0x44434d}),_0x16d75b('char-memo-screen'));}async function _0x2ac5a5(_0x2fd810){const _0x19a66d=_0x41eae2,_0x59a9b9=_0x5b873d[_0x19a66d(0x667)][_0x521c79];if(!_0x59a9b9[_0x19a66d(0xadb)])_0x59a9b9[_0x19a66d(0xadb)]=[];_0x59a9b9[_0x19a66d(0xadb)][_0x19a66d(0x138c)]({'id':Date['now'](),'title':_0x2fd810['title'],'content':_0x2fd810[_0x19a66d(0x28c)]}),await _0x1a6951[_0x19a66d(0x667)]['put'](_0x59a9b9),_0x1360e3();}async function _0x2ac5a5(_0x325b1a){const _0x337071=_0x41eae2,_0x5607f3=_0x5b873d[_0x337071(0x667)][_0x521c79];if(!_0x5607f3[_0x337071(0xadb)])_0x5607f3[_0x337071(0xadb)]=[];if(_0x4c98af){const _0x1f4390=_0x5607f3['memos']['find'](_0xd2a04f=>_0xd2a04f['id']===_0x4c98af);if(_0x1f4390)_0x1f4390[_0x337071(0x28c)]=_0x325b1a;}else _0x5607f3['memos'][_0x337071(0x138c)]({'id':Date[_0x337071(0xf1a)](),'content':_0x325b1a});await _0x1a6951[_0x337071(0x667)][_0x337071(0xc0f)](_0x5607f3),_0x1360e3(),_0x4c98af=null;}async function _0x25db10(){const _0x4280c5=_0x41eae2;if(!_0x521c79)return;const _0x396b6d=_0x5b873d['chats'][_0x521c79];if(!_0x396b6d)return;await _0x532f76(_0x4280c5(0xb6a),_0x4280c5(0xb98)+_0x396b6d[_0x4280c5(0xf74)]+_0x4280c5(0x11d2));const {proxyUrl:_0x2841df,apiKey:_0x174b36,model:_0x5dbe26}=_0x5b873d['apiConfig'];if(!_0x2841df||!_0x174b36||!_0x5dbe26){alert(_0x4280c5(0xebf));return;}const _0x1f9f2a=_0x5b873d[_0x4280c5(0x5c1)][_0x4280c5(0x22a)]===_0x4280c5(0x1285)||!_0x5b873d['qzoneSettings']['nickname']?'用户':_0x5b873d[_0x4280c5(0x5c1)][_0x4280c5(0x22a)],_0x598640=_0x396b6d[_0x4280c5(0xc18)]&&_0x396b6d[_0x4280c5(0xc18)]['length']>0x0?_0x396b6d[_0x4280c5(0xc18)]['map'](_0x42578d=>_0x4280c5(0x768)+_0x4ce38e(_0x42578d['timestamp'])+')\x20'+_0x42578d['content'])[_0x4280c5(0x1237)]('\x0a'):'无',_0x2895c6=_0x396b6d[_0x4280c5(0xdb9)][_0x4280c5(0x46f)]||0xa,_0x14a392=_0x396b6d[_0x4280c5(0x551)][_0x4280c5(0xdd0)](-_0x2895c6)[_0x4280c5(0x412)](_0x877dfc=>(_0x877dfc[_0x4280c5(0xa57)]===_0x4280c5(0x116c)?_0x1f9f2a:_0x396b6d[_0x4280c5(0xf74)])+':\x20'+String(_0x877dfc[_0x4280c5(0x28c)])['substring'](0x0,0x1e)+_0x4280c5(0x1046))[_0x4280c5(0x1237)]('\x0a'),_0x1e8198=(_0x396b6d[_0x4280c5(0xdb9)][_0x4280c5(0x32d)]||[])[_0x4280c5(0x412)](_0x392697=>_0x5b873d[_0x4280c5(0x8a1)][_0x4280c5(0x12f4)](_0x19c2c3=>_0x19c2c3['id']===_0x392697))['filter'](Boolean)[_0x4280c5(0x412)](_0x6da1cf=>_0x4280c5(0xf50)+_0x6da1cf[_0x4280c5(0xf74)]+_0x4280c5(0x241)+_0x6da1cf[_0x4280c5(0x28c)]['filter'](_0x302e23=>_0x302e23[_0x4280c5(0x104e)])[_0x4280c5(0x412)](_0x145994=>'-\x20'+_0x145994[_0x4280c5(0x28c)])[_0x4280c5(0x1237)]('\x0a'))[_0x4280c5(0x1237)](''),_0x3e344e=_0x247dd3(_0x396b6d,0x3,_0x4280c5(0x5be)),_0x3be2b9=_0x247dd3(_0x396b6d,0x6,_0x4280c5(0x5be)),_0x248b8a=_0x247dd3(_0x396b6d,0x9,_0x4280c5(0x5be)),_0x3db813=_0x247dd3(_0x396b6d,0x1,_0x4280c5(0xccc)),_0x8b6b2b=_0x247dd3(_0x396b6d,0x3,'days'),_0x4a0cc8=_0x247dd3(_0x396b6d,0x7,'days');let _0x56dd2c='';if(_0x3e344e||_0x3be2b9||_0x248b8a||_0x3db813||_0x8b6b2b||_0x4a0cc8){_0x56dd2c+=_0x4280c5(0x10cc);if(_0x3e344e)_0x56dd2c+=_0x3e344e;if(_0x3be2b9)_0x56dd2c+=_0x3be2b9;if(_0x248b8a)_0x56dd2c+=_0x248b8a;if(_0x3e344e||_0x3be2b9||_0x248b8a)_0x56dd2c+='\x0a';if(_0x3db813)_0x56dd2c+=_0x3db813;if(_0x8b6b2b)_0x56dd2c+=_0x8b6b2b;if(_0x4a0cc8)_0x56dd2c+=_0x4a0cc8;}const _0x4a9770=_0x4280c5(0xdd7)+_0x396b6d[_0x4280c5(0xf74)]+_0x4280c5(0x852)+new Date()[_0x4280c5(0x1148)](_0x4280c5(0x1e8))+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“'+_0x1f9f2a+_0x4280c5(0x32a)+_0x396b6d['settings'][_0x4280c5(0x1269)]+_0x4280c5(0x3f9)+_0x598640+'\x0a'+_0x1e8198+'\x0a'+_0x56dd2c+'\x20\x0a-\x20**你最近和“'+_0x1f9f2a+_0x4280c5(0xcb4)+_0x14a392+_0x4280c5(0x1314);try{const _0x52746a=[{'role':_0x4280c5(0x116c),'content':_0x4280c5(0xe4d)}];let _0x5edcca=_0x2841df[_0x4280c5(0xced)](_0x4280c5(0x6a6)),_0x2b9fca=_0xa615f4(_0x5dbe26,_0x174b36,_0x4a9770,_0x52746a);const _0x4c8c7e=_0x5edcca?await fetch(_0x2b9fca[_0x4280c5(0x11de)],_0x2b9fca['data']):await fetch(_0x2841df+'/v1/chat/completions',{'method':_0x4280c5(0xd14),'headers':{'Content-Type':'application/json','Authorization':_0x4280c5(0x3fb)+_0x174b36},'body':JSON[_0x4280c5(0x465)]({'model':_0x5dbe26,'messages':[{'role':'system','content':_0x4a9770},..._0x52746a],'temperature':_0x5b873d[_0x4280c5(0x21a)]['apiTemperature']||0.95})});if(!_0x4c8c7e['ok'])throw new Error(_0x4280c5(0x10d8)+_0x4c8c7e[_0x4280c5(0x517)]);const _0x2c3735=await _0x4c8c7e[_0x4280c5(0x6b5)](),_0x30550f=getGeminiResponseText(_0x2c3735),_0x428462=_0x30550f[_0x4280c5(0x86c)](/(\[[\s\S]*\])/);if(!_0x428462||!_0x428462[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x30550f);const _0x528ccf=_0x428462[0x0];let _0x171914;try{_0x171914=JSON[_0x4280c5(0x2cb)](_0x528ccf);}catch(_0x5e298c){throw new Error(_0x4280c5(0x567)+_0x5e298c[_0x4280c5(0x1288)]+_0x4280c5(0x6c3)+_0x30550f);}_0x396b6d['diary']=_0x171914[_0x4280c5(0x412)](_0x106799=>({'id':Date[_0x4280c5(0xf1a)]()+Math[_0x4280c5(0xdc6)](),'title':_0x106799[_0x4280c5(0x104c)],'content':_0x106799[_0x4280c5(0x28c)],'timestamp':Date['now']()})),await _0x1a6951[_0x4280c5(0x667)][_0x4280c5(0xc0f)](_0x396b6d),await _0x30d726();}catch(_0x4e9163){console[_0x4280c5(0x1fd)](_0x4280c5(0x22b),_0x4e9163),await _0x532f76(_0x4280c5(0x1020),_0x4280c5(0x7e6)+_0x4e9163[_0x4280c5(0x1288)]);}}async function _0x388909(){const _0x4b6144=_0x41eae2;if(!_0x521c79)return;const _0x4dfeb8=_0x5b873d['chats'][_0x521c79];if(!_0x4dfeb8)return;await _0x532f76('请稍候...','正在请求“'+_0x4dfeb8['name']+_0x4b6144(0xbaf));const {proxyUrl:_0x26d255,apiKey:_0x6815ee,model:_0x2400a2}=_0x5b873d['apiConfig'];if(!_0x26d255||!_0x6815ee||!_0x2400a2)return;const _0x4d2629=_0x5b873d[_0x4b6144(0x5c1)][_0x4b6144(0x22a)]===_0x4b6144(0x1285)||!_0x5b873d['qzoneSettings']['nickname']?'用户':_0x5b873d[_0x4b6144(0x5c1)][_0x4b6144(0x22a)],_0x35bbf2=_0x4dfeb8[_0x4b6144(0xc18)]&&_0x4dfeb8['longTermMemory'][_0x4b6144(0x7aa)]>0x0?_0x4dfeb8[_0x4b6144(0xc18)][_0x4b6144(0x412)](_0x573aa7=>_0x4b6144(0x768)+_0x4ce38e(_0x573aa7[_0x4b6144(0x114e)])+')\x20'+_0x573aa7[_0x4b6144(0x28c)])[_0x4b6144(0x1237)]('\x0a'):'无',_0xe4f536=_0x4dfeb8['settings'][_0x4b6144(0x46f)]||0xa,_0x2b0a96=_0x4dfeb8['history']['slice'](-_0xe4f536)['map'](_0x46deb7=>(_0x46deb7['role']===_0x4b6144(0x116c)?_0x4d2629:_0x4dfeb8[_0x4b6144(0xf74)])+':\x20'+String(_0x46deb7['content'])[_0x4b6144(0x489)](0x0,0x1e)+_0x4b6144(0x1046))[_0x4b6144(0x1237)]('\x0a'),_0x377dfc=(_0x4dfeb8['settings'][_0x4b6144(0x32d)]||[])['map'](_0x2536a0=>_0x5b873d[_0x4b6144(0x8a1)][_0x4b6144(0x12f4)](_0x37b754=>_0x37b754['id']===_0x2536a0))[_0x4b6144(0x3d8)](Boolean)[_0x4b6144(0x412)](_0x26da6f=>_0x4b6144(0xf50)+_0x26da6f['name']+_0x4b6144(0x241)+_0x26da6f[_0x4b6144(0x28c)][_0x4b6144(0x3d8)](_0x3dce9c=>_0x3dce9c[_0x4b6144(0x104e)])[_0x4b6144(0x412)](_0x5a606d=>'-\x20'+_0x5a606d['content'])[_0x4b6144(0x1237)]('\x0a'))[_0x4b6144(0x1237)](''),_0x5b59db=_0x4b6144(0xa22)+_0x4dfeb8[_0x4b6144(0xf74)]+'”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**'+new Date()[_0x4b6144(0x1148)]('zh-CN')+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x4dfeb8[_0x4b6144(0xdb9)][_0x4b6144(0x1269)]+_0x4b6144(0x3f9)+_0x35bbf2+'\x0a'+_0x377dfc+_0x4b6144(0xdac)+_0x4d2629+'”的对话摘要**:\x0a'+_0x2b0a96+_0x4b6144(0x7e2);try{const _0x1b41bb=[{'role':_0x4b6144(0x116c),'content':_0x4b6144(0x2af)}];let _0x277f47=_0x26d255[_0x4b6144(0xced)](_0x4b6144(0x6a6)),_0x1a06f6=_0xa615f4(_0x2400a2,_0x6815ee,_0x5b59db,_0x1b41bb);const _0x491524=_0x277f47?await fetch(_0x1a06f6[_0x4b6144(0x11de)],_0x1a06f6[_0x4b6144(0xd98)]):await fetch(_0x26d255+_0x4b6144(0x6dd),{'method':_0x4b6144(0xd14),'headers':{'Content-Type':_0x4b6144(0xce4),'Authorization':_0x4b6144(0x3fb)+_0x6815ee},'body':JSON['stringify']({'model':_0x2400a2,'messages':[{'role':_0x4b6144(0x18c),'content':_0x5b59db},..._0x1b41bb],'temperature':_0x5b873d[_0x4b6144(0x21a)][_0x4b6144(0x576)]||0.95})});if(!_0x491524['ok'])throw new Error('API\x20错误:\x20'+_0x491524[_0x4b6144(0x517)]);const _0x532e51=await _0x491524[_0x4b6144(0x6b5)](),_0x45d1f3=getGeminiResponseText(_0x532e51),_0x1b36d3=_0x45d1f3['match'](/(\[[\s\S]*\])/);if(!_0x1b36d3||!_0x1b36d3[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x45d1f3);const _0x23691b=_0x1b36d3[0x0];let _0x4d6b30;try{_0x4d6b30=JSON[_0x4b6144(0x2cb)](_0x23691b)[0x0];}catch(_0xfa00b2){throw new Error('解析AI返回的JSON时出错:\x20'+_0xfa00b2[_0x4b6144(0x1288)]+_0x4b6144(0x6c3)+_0x45d1f3);}if(!_0x4dfeb8[_0x4b6144(0x89a)])_0x4dfeb8['diary']=[];_0x4dfeb8[_0x4b6144(0x89a)][_0x4b6144(0x138c)]({'id':Date[_0x4b6144(0xf1a)](),'title':_0x4d6b30['title'],'content':_0x4d6b30['content'],'timestamp':Date[_0x4b6144(0xf1a)]()}),await _0x1a6951[_0x4b6144(0x667)][_0x4b6144(0xc0f)](_0x4dfeb8),await _0x30d726();}catch(_0x3c7469){console[_0x4b6144(0x1fd)](_0x4b6144(0xc25),_0x3c7469),await _0x532f76(_0x4b6144(0x1020),_0x4b6144(0x12b6)+_0x3c7469[_0x4b6144(0x1288)]);}}function _0x30d726(){const _0x2723e3=_0x41eae2,_0xb81e95=document['getElementById'](_0x2723e3(0xc20));_0xb81e95[_0x2723e3(0x1ef)]='';const _0x17584e=_0x5b873d[_0x2723e3(0x667)][_0x521c79],_0x5ac217=(_0x17584e[_0x2723e3(0x89a)]||[])['slice']()[_0x2723e3(0x854)]();if(_0x5ac217[_0x2723e3(0x7aa)]===0x0){_0xb81e95[_0x2723e3(0x1ef)]=_0x2723e3(0xdfd);return;}_0x5ac217['forEach'](_0x1cfb5e=>{const _0x350c2a=_0x2723e3,_0x4f3e6b=document[_0x350c2a(0x285)](_0x350c2a(0xb25));_0x4f3e6b[_0x350c2a(0x81c)]='list-item',_0x4f3e6b[_0x350c2a(0x1ef)]=_0x350c2a(0xb26)+_0x1cfb5e[_0x350c2a(0x104c)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>'+new Date(_0x1cfb5e[_0x350c2a(0x114e)])[_0x350c2a(0x1148)]()+_0x350c2a(0xb75),_0x4f3e6b[_0x350c2a(0x1193)]('click',()=>_0x1b9da1(_0x1cfb5e['id'])),_0xefe9e2(_0x4f3e6b,()=>_0x3d0756(_0x1cfb5e['id'])),_0xb81e95[_0x350c2a(0x22f)](_0x4f3e6b);});}async function _0x1b9da1(_0x400399){const _0x5308e2=_0x41eae2,_0x5e97c9=_0x5b873d['chats'][_0x521c79];if(!_0x5e97c9||!_0x5e97c9[_0x5308e2(0x89a)])return;const _0x485531=_0x5e97c9['diary']['find'](_0x42eabd=>_0x42eabd['id']===_0x400399);if(_0x485531){_0x2b40cf=_0x485531;const _0xa1c91=document[_0x5308e2(0x89d)](_0x5308e2(0xd49)),_0x27954b=document[_0x5308e2(0x89d)](_0x5308e2(0x8db)),_0x16ac4e=document[_0x5308e2(0x89d)]('favorite-diary-btn');_0xa1c91['textContent']=_0x485531[_0x5308e2(0x104c)];const _0x489e10=_0x55b8e7(_0x485531[_0x5308e2(0x28c)])[_0x5308e2(0x55b)]('\x0a')[_0x5308e2(0x412)](_0x5005f5=>'<p>'+(_0x5005f5||'&nbsp;')+_0x5308e2(0x164))['join']('');_0x27954b[_0x5308e2(0x1ef)]=_0x489e10;const _0x5643c6=await _0x1a6951[_0x5308e2(0x183)]['where']({'type':_0x5308e2(0x1b6),'content.id':_0x400399})[_0x5308e2(0x2a6)]();_0x16ac4e['classList']['toggle']('active',!!_0x5643c6),_0x16d75b('char-diary-detail-screen');}}async function _0xabb58f(){const _0x4b551c=_0x41eae2;if(!_0x2b40cf||!_0x521c79)return;const _0x54692a=_0x2b40cf,_0x2904cb=_0x5b873d[_0x4b551c(0x667)][_0x521c79],_0x5ebc3f=document[_0x4b551c(0x89d)](_0x4b551c(0x2fa)),_0x31e748=await _0x1a6951[_0x4b551c(0x183)][_0x4b551c(0x176)]({'type':_0x4b551c(0x1b6),'content.id':_0x54692a['id']})[_0x4b551c(0x2a6)]();if(_0x31e748)await _0x1a6951[_0x4b551c(0x183)][_0x4b551c(0x684)](_0x31e748['id']),_0x5ebc3f[_0x4b551c(0x2f1)]['remove']('active'),await _0x532f76(_0x4b551c(0xc43),_0x4b551c(0x3c7));else{const _0xabff50={'type':_0x4b551c(0x1b6),'content':{'id':_0x54692a['id'],'title':_0x54692a['title'],'content':_0x54692a[_0x4b551c(0x28c)],'timestamp':_0x54692a[_0x4b551c(0x114e)],'characterId':_0x521c79,'characterName':_0x2904cb['name']},'timestamp':Date[_0x4b551c(0xf1a)]()};await _0x1a6951[_0x4b551c(0x183)][_0x4b551c(0x569)](_0xabff50),_0x5ebc3f[_0x4b551c(0x2f1)][_0x4b551c(0x569)](_0x4b551c(0x8ea)),await _0x532f76('操作成功',_0x4b551c(0x8ac));}}async function _0x4cc961(){const _0x4f3dc9=_0x41eae2;if(!_0x38fb37||!_0x521c79)return;const _0x198ec9=_0x38fb37,_0x3361aa=_0x5b873d['chats'][_0x521c79],_0x1e1b17=document[_0x4f3dc9(0x89d)](_0x4f3dc9(0xeff)),_0x2e6c19=await _0x1a6951[_0x4f3dc9(0x183)][_0x4f3dc9(0x176)]({'type':'char_memo','content.id':_0x198ec9['id']})[_0x4f3dc9(0x2a6)]();if(_0x2e6c19)await _0x1a6951['favorites'][_0x4f3dc9(0x684)](_0x2e6c19['id']),_0x1e1b17['classList']['remove'](_0x4f3dc9(0x8ea)),await _0x532f76('操作成功',_0x4f3dc9(0x3c7));else{const _0x410af7={'type':'char_memo','content':{'id':_0x198ec9['id'],'title':_0x198ec9['title'],'content':_0x198ec9[_0x4f3dc9(0x28c)],'timestamp':_0x198ec9[_0x4f3dc9(0x114e)],'characterId':_0x521c79,'characterName':_0x3361aa[_0x4f3dc9(0xf74)]},'timestamp':Date['now']()};await _0x1a6951[_0x4f3dc9(0x183)][_0x4f3dc9(0x569)](_0x410af7),_0x1e1b17['classList'][_0x4f3dc9(0x569)](_0x4f3dc9(0x8ea)),await _0x532f76('操作成功',_0x4f3dc9(0x8ac));}}async function _0x3d0756(_0x16a554){const _0x3a3c23=_0x41eae2,_0x364443=await _0x4e2abc(_0x3a3c23(0x902),_0x3a3c23(0x4cb),{'confirmButtonClass':_0x3a3c23(0xcd8)});if(_0x364443){const _0x2fe8e0=_0x5b873d[_0x3a3c23(0x667)][_0x521c79];_0x2fe8e0['diary']=_0x2fe8e0[_0x3a3c23(0x89a)][_0x3a3c23(0x3d8)](_0x5a0061=>_0x5a0061['id']!==_0x16a554),await _0x1a6951[_0x3a3c23(0x667)][_0x3a3c23(0xc0f)](_0x2fe8e0),_0x30d726();}}async function _0x314477(){const _0x4dc7d9=_0x41eae2,_0x456981=document[_0x4dc7d9(0x89d)](_0x4dc7d9(0xe54));_0x456981[_0x4dc7d9(0x1ef)]='';const _0x4dfb7e=_0x5b873d[_0x4dc7d9(0x667)][_0x521c79];if(!_0x4dfb7e)return;const _0x5cacd1=_0x4dfb7e[_0x4dc7d9(0xdb9)]['myNickname']||(_0x5b873d[_0x4dc7d9(0x5c1)]['nickname']||'我'),_0x560c06=_0x4dfb7e[_0x4dc7d9(0x551)][_0x4dc7d9(0x3d8)](_0x5d51d6=>!_0x5d51d6[_0x4dc7d9(0x9ae)])[_0x4dc7d9(0xdd0)](-0x1)[0x0]||{'content':'...'};let _0x51bb1b='...';if(_0x560c06){if(typeof _0x560c06[_0x4dc7d9(0x28c)]==='string')_0x51bb1b=_0x560c06['content'];else{if(Array[_0x4dc7d9(0xbd6)](_0x560c06[_0x4dc7d9(0x28c)])&&_0x560c06[_0x4dc7d9(0x28c)][0x0]?.[_0x4dc7d9(0x48c)]===_0x4dc7d9(0xcad))_0x51bb1b='[图片]';else{if(_0x560c06['type']){const _0x29a9d9={'voice_message':_0x4dc7d9(0xc5d),'transfer':_0x4dc7d9(0xc46),'ai_image':_0x4dc7d9(0x598)};_0x51bb1b=_0x29a9d9[_0x560c06[_0x4dc7d9(0x48c)]]||'['+_0x560c06[_0x4dc7d9(0x48c)]+']';}}}}const _0x151c36=_0x4dfb7e[_0x4dc7d9(0xdb9)][_0x4dc7d9(0xd55)]||_0x265fcc,_0x44d8a3=_0x4dfb7e[_0x4dc7d9(0xdb9)]['myAvatarFrame']||'';let _0x9cf693;_0x44d8a3?_0x9cf693=_0x4dc7d9(0xcb3)+_0x151c36+_0x4dc7d9(0xa47)+_0x44d8a3+_0x4dc7d9(0x125a):_0x9cf693=_0x4dc7d9(0x1306)+_0x151c36+_0x4dc7d9(0x1006);const _0x2cdbb7=document[_0x4dc7d9(0x285)]('div');_0x2cdbb7[_0x4dc7d9(0x81c)]=_0x4dc7d9(0xd1c),_0x2cdbb7[_0x4dc7d9(0xaaf)][_0x4dc7d9(0x3d0)]='-1',_0x2cdbb7[_0x4dc7d9(0x1ef)]=_0x4dc7d9(0x12e9)+_0x9cf693+_0x4dc7d9(0x7ce)+_0x5cacd1+_0x4dc7d9(0x1b7)+String(_0x51bb1b)[_0x4dc7d9(0x489)](0x0,0x14)+_0x4dc7d9(0xfc4),_0x456981[_0x4dc7d9(0x22f)](_0x2cdbb7);const _0x501786=await _0x1a6951[_0x4dc7d9(0x8ce)][_0x4dc7d9(0xc2f)](),_0x2975b2=new Map(_0x501786[_0x4dc7d9(0x412)](_0x5cc772=>[_0x5cc772[_0x4dc7d9(0xf74)],_0x5cc772])),_0x339619=_0x4dfb7e['simulatedConversations']||[];if(_0x339619[_0x4dc7d9(0x7aa)]===0x0&&!_0x2cdbb7){_0x456981[_0x4dc7d9(0x1ef)]=_0x4dc7d9(0xb15);return;}_0x339619[_0x4dc7d9(0xd9a)]((_0x398fce,_0x12650d)=>{const _0x35b034=_0x4dc7d9;if(_0x398fce[_0x35b034(0x48c)]==='private_user')return;const _0x427a61=document[_0x35b034(0x285)](_0x35b034(0xb25));_0x427a61[_0x35b034(0x81c)]=_0x35b034(0xd1c),_0x427a61['dataset']['conversationIndex']=_0x12650d;let _0x3a97c1,_0x405058,_0x5af909;if(_0x398fce[_0x35b034(0x48c)]===_0x35b034(0x39f)){_0x5af909=_0x398fce[_0x35b034(0xb9a)]+'\x20<span\x20class=\x22group-tag\x22>群</span>',_0x3a97c1=_0x398fce[_0x35b034(0x732)][_0x35b034(0xdd0)](-0x1)[0x0]||{'content':'...'};const _0x22c96a=_0x35b034(0x1368)+_0x398fce[_0x35b034(0xb9a)]+'\x27',_0x3878ab=_0x5b873d[_0x35b034(0x21a)]['enableAiDrawing']?_0x35b034(0x1017)+encodeURIComponent(_0x22c96a):_0x660176;_0x405058=_0x35b034(0x593)+_0x3878ab+_0x35b034(0x168);}else{_0x5af909=_0x398fce[_0x35b034(0x4bc)][_0x35b034(0xf74)],_0x3a97c1=_0x398fce[_0x35b034(0x732)]['slice'](-0x1)[0x0]||{'content':_0x35b034(0x1046)};const _0x4ce32a=_0x2975b2[_0x35b034(0x650)](_0x5af909);let _0x4a0800=_0x4ce32a&&_0x4ce32a[_0x35b034(0x12c8)]?_0x4ce32a[_0x35b034(0x12c8)]:_0x5b873d[_0x35b034(0x21a)][_0x35b034(0x122b)]?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x398fce[_0x35b034(0x4bc)]['avatar_prompt']||'anime\x20person'):_0x15061e;_0x405058=_0x35b034(0x593)+_0x4a0800+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>';}let _0x1a2a25=_0x35b034(0x1046);_0x3a97c1&&_0x3a97c1[_0x35b034(0x28c)]&&(_0x1a2a25=_0x3a97c1[_0x35b034(0x28c)]),_0x427a61[_0x35b034(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x405058+_0x35b034(0x50f)+_0x5af909+_0x35b034(0x7fc)+String(_0x1a2a25)[_0x35b034(0x489)](0x0,0x14)+_0x35b034(0x814),_0x456981['appendChild'](_0x427a61);});}async function _0x42e397(){const _0x5fcb4d=_0x41eae2;if(!_0x521c79)return;const _0x19237d=_0x5b873d[_0x5fcb4d(0x667)][_0x521c79];if(!_0x19237d)return;await _0x532f76('请稍候...',_0x5fcb4d(0x9ac)+_0x19237d[_0x5fcb4d(0xf74)]+_0x5fcb4d(0x240));const {proxyUrl:_0x174ea5,apiKey:_0x1cacfb,model:_0x50961e}=_0x5b873d['apiConfig'];if(!_0x174ea5||!_0x1cacfb||!_0x50961e){alert(_0x5fcb4d(0xebf));return;}const _0xaf3e85=await _0x1a6951['npcs'][_0x5fcb4d(0xc2f)](),_0x5be74e=_0xaf3e85[_0x5fcb4d(0x3d8)](_0x39f4d8=>_0x39f4d8[_0x5fcb4d(0x12e2)]&&_0x39f4d8['associatedWith']['includes'](_0x521c79));let _0x1de5d0=_0x5fcb4d(0x38a);_0x5be74e['length']>0x0?(_0x1de5d0+=_0x5fcb4d(0x3e9),_0x5be74e['forEach'](_0x40f9fe=>{const _0xa418c4=_0x5fcb4d;_0x1de5d0+=_0xa418c4(0x12ae)+_0x40f9fe[_0xa418c4(0xf74)]+_0xa418c4(0xeca)+_0x40f9fe[_0xa418c4(0x1170)]+'\x0a';})):_0x1de5d0+=_0x5fcb4d(0xbd4);const _0x592c83=_0x5b873d['qzoneSettings']['nickname']===_0x5fcb4d(0x1285)||!_0x5b873d[_0x5fcb4d(0x5c1)][_0x5fcb4d(0x22a)]?'用户':_0x5b873d[_0x5fcb4d(0x5c1)][_0x5fcb4d(0x22a)],_0x476653=_0x19237d[_0x5fcb4d(0xdb9)][_0x5fcb4d(0xc48)]||_0x592c83,_0x68cd0c=_0x19237d[_0x5fcb4d(0xc18)]&&_0x19237d[_0x5fcb4d(0xc18)][_0x5fcb4d(0x7aa)]>0x0?_0x19237d[_0x5fcb4d(0xc18)][_0x5fcb4d(0x412)](_0x4b20e8=>_0x5fcb4d(0x768)+_0x4ce38e(_0x4b20e8[_0x5fcb4d(0x114e)])+')\x20'+_0x4b20e8[_0x5fcb4d(0x28c)])[_0x5fcb4d(0x1237)]('\x0a'):'无',_0x186c0a=_0x19237d['settings'][_0x5fcb4d(0x46f)]||0xa,_0x4bc656=_0x19237d[_0x5fcb4d(0x551)][_0x5fcb4d(0xdd0)](-_0x186c0a)[_0x5fcb4d(0x412)](_0x5a32f5=>(_0x5a32f5[_0x5fcb4d(0xa57)]===_0x5fcb4d(0x116c)?_0x476653:_0x19237d[_0x5fcb4d(0xf74)])+':\x20'+String(_0x5a32f5['content'])['substring'](0x0,0x1e)+'...')[_0x5fcb4d(0x1237)]('\x0a'),_0x1dedff=(_0x19237d[_0x5fcb4d(0xdb9)]['linkedWorldBookIds']||[])[_0x5fcb4d(0x412)](_0xad812d=>_0x5b873d[_0x5fcb4d(0x8a1)][_0x5fcb4d(0x12f4)](_0xb2cea0=>_0xb2cea0['id']===_0xad812d))['filter'](Boolean)[_0x5fcb4d(0x412)](_0x11c5db=>_0x5fcb4d(0xf50)+_0x11c5db[_0x5fcb4d(0xf74)]+_0x5fcb4d(0x669)+_0x11c5db[_0x5fcb4d(0x28c)][_0x5fcb4d(0x3d8)](_0x3c2c57=>_0x3c2c57[_0x5fcb4d(0x104e)])[_0x5fcb4d(0x412)](_0x1641d7=>'-\x20'+_0x1641d7['content'])[_0x5fcb4d(0x1237)]('\x0a'))[_0x5fcb4d(0x1237)](''),_0x254e23=_0x19237d[_0x5fcb4d(0x1045)]||_0x19237d[_0x5fcb4d(0xf74)],_0x569ac0=_0x4f684e(_0x19237d),_0x46bc2a=_0x5fcb4d(0x11f2)+_0x19237d[_0x5fcb4d(0xf74)]+_0x5fcb4d(0xe07)+_0x254e23+'\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22'+_0x254e23+_0x5fcb4d(0x7e8)+_0x254e23+'\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员2\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20'+_0x19237d[_0x5fcb4d(0xdb9)][_0x5fcb4d(0x1269)]+'\x0a-\x20**你的长期记忆**:\x20'+_0x68cd0c+_0x5fcb4d(0x893)+_0x1dedff+_0x5fcb4d(0xe98)+_0x4bc656+'\x0a'+_0x1de5d0+'\x0a#\x20可用表情包\x0a'+_0x569ac0+_0x5fcb4d(0x8bd);try{const _0x5ab6a5=[{'role':_0x5fcb4d(0x116c),'content':'请根据你的设定，生成模拟聊天记录。'}];let _0x5892df=_0x174ea5[_0x5fcb4d(0xced)](_0x5fcb4d(0x6a6)),_0x1c715d=_0xa615f4(_0x50961e,_0x1cacfb,_0x46bc2a,_0x5ab6a5);const _0x542098=_0x5892df?await fetch(_0x1c715d[_0x5fcb4d(0x11de)],_0x1c715d[_0x5fcb4d(0xd98)]):await fetch(_0x174ea5+'/v1/chat/completions',{'method':_0x5fcb4d(0xd14),'headers':{'Content-Type':_0x5fcb4d(0xce4),'Authorization':_0x5fcb4d(0x3fb)+_0x1cacfb},'body':JSON[_0x5fcb4d(0x465)]({'model':_0x50961e,'messages':[{'role':_0x5fcb4d(0x18c),'content':_0x46bc2a},..._0x5ab6a5],'temperature':_0x5b873d[_0x5fcb4d(0x21a)][_0x5fcb4d(0x576)]||0.9})});if(!_0x542098['ok'])throw new Error('API\x20错误:\x20'+_0x542098[_0x5fcb4d(0x517)]);const _0x3cd965=await _0x542098[_0x5fcb4d(0x6b5)](),_0x3746fa=getGeminiResponseText(_0x3cd965),_0x5446ba=_0x3746fa['match'](/(\[[\s\S]*\])/);if(!_0x5446ba||!_0x5446ba[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x3746fa);const _0x818596=_0x5446ba[0x0];let _0x5b5677;try{_0x5b5677=JSON[_0x5fcb4d(0x2cb)](_0x818596);}catch(_0x14224f){throw new Error('解析AI返回的JSON时出错:\x20'+_0x14224f[_0x5fcb4d(0x1288)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x3746fa);}_0x19237d['simulatedConversations']=_0x5b5677,await _0x1a6951[_0x5fcb4d(0x667)][_0x5fcb4d(0xc0f)](_0x19237d),await _0x314477();const _0x300ab4={'role':_0x5fcb4d(0x18c),'content':'[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','timestamp':Date[_0x5fcb4d(0xf1a)](),'isHidden':!![]};_0x19237d['history'][_0x5fcb4d(0x138c)](_0x300ab4),await _0x1a6951['chats'][_0x5fcb4d(0xc0f)](_0x19237d),_0x2e3505();}catch(_0x2a5f93){console[_0x5fcb4d(0x1fd)](_0x5fcb4d(0xbba),_0x2a5f93),await _0x532f76(_0x5fcb4d(0x1020),_0x5fcb4d(0xec7)+_0x2a5f93[_0x5fcb4d(0x1288)]);}}async function _0x3ecef3(){const _0x4e28d0=_0x41eae2;if(!_0x521c79)return;const _0x2e84be=_0x5b873d['chats'][_0x521c79];if(!_0x2e84be)return;try{const {proxyUrl:_0x16aadc,apiKey:_0x221e6d,model:_0x1082c5}=_0x5b873d[_0x4e28d0(0x30d)];if(!_0x16aadc||!_0x221e6d||!_0x1082c5)throw new Error('API未配置，无法生成对话。');const _0x503a1a=parseInt(_0x2e84be[_0x4e28d0(0xdb9)][_0x4e28d0(0x46f)])||0xa,_0x250f1f=_0x2e84be['history'][_0x4e28d0(0xdd0)](-_0x503a1a),_0x2b5499=_0x2e84be[_0x4e28d0(0xdb9)]['myNickname']||'我',_0x1395b7=_0x2e84be['settings'][_0x4e28d0(0x6d4)]||'用户',_0x185cd1=_0x4e28d0(0x84b)+(_0x2e84be[_0x4e28d0(0xc18)]&&_0x2e84be[_0x4e28d0(0xc18)][_0x4e28d0(0x7aa)]>0x0?_0x2e84be[_0x4e28d0(0xc18)][_0x4e28d0(0x412)](_0x208f94=>'-\x20'+_0x208f94[_0x4e28d0(0x28c)])[_0x4e28d0(0x1237)]('\x0a'):_0x4e28d0(0x12c3));let _0x4cd8df='';if(_0x2e84be[_0x4e28d0(0xdb9)][_0x4e28d0(0x32d)]&&_0x2e84be[_0x4e28d0(0xdb9)][_0x4e28d0(0x32d)][_0x4e28d0(0x7aa)]>0x0){const _0x198679=_0x2e84be['settings']['linkedWorldBookIds'][_0x4e28d0(0x412)](_0x35a4a6=>{const _0x52094c=_0x4e28d0,_0x5958db=_0x5b873d[_0x52094c(0x8a1)]['find'](_0x1a2710=>_0x1a2710['id']===_0x35a4a6);if(!_0x5958db||!Array[_0x52094c(0xbd6)](_0x5958db[_0x52094c(0x28c)]))return'';const _0x44dfd7=_0x5958db[_0x52094c(0x28c)]['filter'](_0x3c6d02=>_0x3c6d02[_0x52094c(0x104e)]!==![])[_0x52094c(0x412)](_0x3e92fc=>_0x52094c(0xc77)+(_0x3e92fc[_0x52094c(0x8f9)]||_0x52094c(0xc06))+_0x52094c(0x1d2)+_0x3e92fc['content'])[_0x52094c(0x1237)]('');return _0x44dfd7?_0x52094c(0xb85)+_0x5958db[_0x52094c(0xf74)]+'\x0a'+_0x44dfd7:'';})[_0x4e28d0(0x3d8)](Boolean)['join']('');_0x198679&&(_0x4cd8df=_0x4e28d0(0x12aa)+_0x198679+'\x0a');}const _0x545d67=_0x247dd3(_0x2e84be,0x3,'hours'),_0x4edb24=_0x247dd3(_0x2e84be,0x6,_0x4e28d0(0x5be)),_0x50816c=_0x247dd3(_0x2e84be,0x9,_0x4e28d0(0x5be)),_0x101cb3=_0x247dd3(_0x2e84be,0x1,'days'),_0x4923d2=_0x247dd3(_0x2e84be,0x3,_0x4e28d0(0xccc)),_0x418478=_0x247dd3(_0x2e84be,0x7,'days');let _0x12936e='';if(_0x545d67||_0x4edb24||_0x50816c||_0x101cb3||_0x4923d2||_0x418478){_0x12936e+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x545d67)_0x12936e+=_0x545d67;if(_0x4edb24)_0x12936e+=_0x4edb24;if(_0x50816c)_0x12936e+=_0x50816c;if(_0x545d67||_0x4edb24||_0x50816c)_0x12936e+='\x0a';if(_0x101cb3)_0x12936e+=_0x101cb3;if(_0x4923d2)_0x12936e+=_0x4923d2;if(_0x418478)_0x12936e+=_0x418478;}const _0x1dae94=_0x5ae1ee(_0x2e84be),_0x204649='\x0a#\x20你的核心任务\x0a你正在扮演角色“'+_0x2e84be[_0x4e28d0(0x1045)]+_0x4e28d0(0x8e4)+_0x2e84be[_0x4e28d0(0xdb9)][_0x4e28d0(0x1269)]+_0x4e28d0(0x1c1)+_0x1dae94+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x1395b7+_0x4e28d0(0x97f)+_0x2e84be[_0x4e28d0(0x1045)]+_0x4e28d0(0x616)+_0x2b5499+'\x22\x0a'+_0x4cd8df+'\x0a'+_0x185cd1+'\x0a'+_0x12936e+_0x4e28d0(0xf47)+_0x250f1f[_0x4e28d0(0x412)](_0x2b857e=>(_0x2b857e[_0x4e28d0(0xa57)]===_0x4e28d0(0x116c)?_0x2b5499:_0x2e84be['name'])+':\x20'+String(_0x2b857e[_0x4e28d0(0x28c)]))[_0x4e28d0(0x1237)]('\x0a')+_0x4e28d0(0x1003),_0x315a6f=_0x250f1f[_0x4e28d0(0x412)](_0x45b0cc=>({'role':_0x45b0cc[_0x4e28d0(0xa57)],'content':(_0x45b0cc[_0x4e28d0(0xa57)]==='user'?_0x2b5499:_0x2e84be[_0x4e28d0(0xf74)])+':\x20'+String(_0x45b0cc[_0x4e28d0(0x28c)])}));let _0x43b860=_0x16aadc[_0x4e28d0(0xced)](_0x4e28d0(0x6a6)),_0x2f03c3=_0xa615f4(_0x1082c5,_0x221e6d,_0x204649,_0x315a6f);const _0x49b526=_0x43b860?await fetch(_0x2f03c3[_0x4e28d0(0x11de)],_0x2f03c3['data']):await fetch(_0x16aadc+_0x4e28d0(0x6dd),{'method':_0x4e28d0(0xd14),'headers':{'Content-Type':_0x4e28d0(0xce4),'Authorization':'Bearer\x20'+_0x221e6d},'body':JSON[_0x4e28d0(0x465)]({'model':_0x1082c5,'messages':[{'role':_0x4e28d0(0x18c),'content':_0x204649},..._0x315a6f],'temperature':_0x5b873d[_0x4e28d0(0x21a)][_0x4e28d0(0x576)]||0.8})});if(!_0x49b526['ok'])throw new Error(_0x4e28d0(0xf8b)+(await _0x49b526[_0x4e28d0(0x6b5)]())[_0x4e28d0(0x1fd)][_0x4e28d0(0x1288)]);const _0x468305=await _0x49b526[_0x4e28d0(0x6b5)](),_0x599918=getGeminiResponseText(_0x468305),_0x5ed2dc=_0x29a17f(_0x599918);if(!_0x5ed2dc||_0x5ed2dc[_0x4e28d0(0x7aa)]===0x0)throw new Error(_0x4e28d0(0x1b8));let _0x9b3ae9=0x0,_0x50b8e8=Date[_0x4e28d0(0xf1a)]();for(const _0x3e92af of _0x5ed2dc){const _0x3a19a0={'role':_0x4e28d0(0x1377),'senderName':_0x2e84be['originalName'],'timestamp':_0x50b8e8++};let _0x2c188e=null;switch(_0x3e92af['type']){case _0x4e28d0(0xec9):_0x2c188e={..._0x3a19a0,'content':String(_0x3e92af[_0x4e28d0(0x28c)]||_0x3e92af[_0x4e28d0(0x1288)])};break;case _0x4e28d0(0x3c8):if(_0x3e92af[_0x4e28d0(0xb5c)]){const _0x53d801=_0x5b873d[_0x4e28d0(0x210)][_0x4e28d0(0x12f4)](_0x36d5a7=>_0x36d5a7['name']===_0x3e92af['meaning']);_0x53d801?_0x2c188e={..._0x3a19a0,'type':_0x4e28d0(0x3c8),'content':_0x53d801[_0x4e28d0(0x11de)],'meaning':_0x53d801[_0x4e28d0(0xf74)]}:(console[_0x4e28d0(0xac3)](_0x4e28d0(0x719)+_0x3e92af['meaning']+'\x22'),_0x2c188e={..._0x3a19a0,'type':'text','content':_0x4e28d0(0x507)+_0x3e92af[_0x4e28d0(0xb5c)]+']'});}else console[_0x4e28d0(0xac3)](_0x4e28d0(0xe5f),_0x3e92af),_0x2c188e={..._0x3a19a0,'type':_0x4e28d0(0x3c8),'content':_0x3e92af[_0x4e28d0(0x11de)],'meaning':_0x4e28d0(0x6a3)};break;}_0x2c188e&&(_0x2e84be[_0x4e28d0(0x551)][_0x4e28d0(0x138c)](_0x2c188e),_0x9b3ae9++);}_0x9b3ae9>0x0&&(_0x2e84be[_0x4e28d0(0x3ce)]=(_0x2e84be['unreadCount']||0x0)+_0x9b3ae9),await _0x1a6951[_0x4e28d0(0x667)][_0x4e28d0(0xc0f)](_0x2e84be),await _0x413d78(),_0x9b3ae9>0x0&&_0x23fbd5(_0x2e84be['id'],_0x4e28d0(0x116b)+_0x9b3ae9+_0x4e28d0(0x56c));}catch(_0x2ae52e){console[_0x4e28d0(0x1fd)](_0x4e28d0(0x56f),_0x2ae52e),await _0x532f76(_0x4e28d0(0x10de),_0x4e28d0(0x1a6)+_0x2ae52e[_0x4e28d0(0x1288)]);}}async function _0x41fe2c(){const _0x445cc3=_0x41eae2;if(_0x2dde7e||!_0x521c79)return;_0x2dde7e=!![];const _0x3b27cc=document[_0x445cc3(0x89d)](_0x445cc3(0x117c)),_0x2b190e=_0x5b873d[_0x445cc3(0x667)][_0x521c79];if(!_0x2b190e){_0x2dde7e=![];return;}_0x9ce0b2(_0x3b27cc,_0x445cc3(0x113d));const _0x4048c8=_0x3b27cc[_0x445cc3(0x624)];await new Promise(_0x25227a=>setTimeout(_0x25227a,0x1f4));const _0x83240d=_0x2b190e[_0x445cc3(0x551)][_0x445cc3(0x7aa)],_0x3b81bf=_0x5b873d[_0x445cc3(0x21a)][_0x445cc3(0x2f3)]||0x32,_0x15985b=_0x83240d-_0x105ba4,_0x1300fe=Math[_0x445cc3(0x88d)](0x0,_0x15985b-_0x3b81bf),_0x4f287d=_0x2b190e[_0x445cc3(0x551)][_0x445cc3(0xdd0)](_0x1300fe,_0x15985b);_0x216cac(_0x3b27cc);if(_0x4f287d[_0x445cc3(0x7aa)]===0x0){_0x2dde7e=![];return;}for(const _0xb08aa5 of _0x4f287d[_0x445cc3(0x854)]()){const _0x56a7d8={..._0xb08aa5,'role':_0xb08aa5[_0x445cc3(0xa57)]===_0x445cc3(0x116c)?_0x445cc3(0x1377):_0x445cc3(0x116c)},_0x136f47={'id':_0x445cc3(0x2f6),'isGroup':![],'name':_0x2b190e[_0x445cc3(0xf74)],'settings':{..._0x2b190e[_0x445cc3(0xdb9)],'myAvatar':_0x2b190e['settings']['aiAvatar'],'myAvatarFrame':_0x2b190e['settings'][_0x445cc3(0xeae)],'aiAvatar':_0x2b190e[_0x445cc3(0xdb9)][_0x445cc3(0xd55)],'aiAvatarFrame':_0x2b190e[_0x445cc3(0xdb9)][_0x445cc3(0x1e0)]}},_0x22067c=await _0x1ed144(_0x56a7d8,_0x136f47);_0x22067c&&_0x3b27cc['prepend'](_0x22067c);}_0x105ba4+=_0x4f287d[_0x445cc3(0x7aa)];const _0x520f8c=_0x3b27cc['scrollHeight'];_0x3b27cc[_0x445cc3(0xb0e)]=_0x520f8c-_0x4048c8,_0x2dde7e=![];}async function _0xad8c09(_0x29dbc0){const _0x58f5ff=_0x41eae2,_0x8aff07=_0x5b873d['chats'][_0x521c79];if(_0x29dbc0===-0x1){_0x10a81b=_0x58f5ff(0x10b1);const _0x2108d8=document[_0x58f5ff(0x89d)](_0x58f5ff(0xfaf)),_0x38c056=document['getElementById'](_0x58f5ff(0x117c)),_0x44c521=document[_0x58f5ff(0x89d)](_0x58f5ff(0x83e));_0x38c056['innerHTML']='',_0x2108d8[_0x58f5ff(0xf12)]=_0x8aff07[_0x58f5ff(0xdb9)][_0x58f5ff(0xc48)]||(_0x5b873d['qzoneSettings'][_0x58f5ff(0x22a)]||'我'),_0x44c521[_0x58f5ff(0xe4f)]='与\x20'+(_0x8aff07['settings'][_0x58f5ff(0xc48)]||'我')+'\x20的对话\x20(只读)',_0x105ba4=0x0,_0x2dde7e=![];const _0x4ba644=_0x8aff07['history'],_0x54eec4=_0x5b873d[_0x58f5ff(0x21a)][_0x58f5ff(0x2f3)]||0x32,_0x2fb092=_0x4ba644[_0x58f5ff(0xdd0)](-_0x54eec4),_0x1892cb={'id':_0x58f5ff(0x2f6),'isGroup':![],'name':_0x8aff07['name'],'settings':{..._0x8aff07[_0x58f5ff(0xdb9)],'myAvatar':_0x8aff07[_0x58f5ff(0xdb9)][_0x58f5ff(0xdd3)],'myAvatarFrame':_0x8aff07['settings'][_0x58f5ff(0xeae)],'aiAvatar':_0x8aff07[_0x58f5ff(0xdb9)][_0x58f5ff(0xd55)],'aiAvatarFrame':_0x8aff07[_0x58f5ff(0xdb9)][_0x58f5ff(0x1e0)]}};for(const _0x2249fb of _0x2fb092){const _0x3391f3={..._0x2249fb,'role':_0x2249fb['role']==='user'?_0x58f5ff(0x1377):'user'},_0x59ddb6=await _0x1ed144(_0x3391f3,_0x1892cb);_0x59ddb6&&_0x38c056[_0x58f5ff(0x22f)](_0x59ddb6);}_0x105ba4=_0x2fb092['length'],_0x16d75b(_0x58f5ff(0x835)),setTimeout(()=>_0x38c056[_0x58f5ff(0xb0e)]=_0x38c056[_0x58f5ff(0x624)],0x0);return;}const _0x46e167=_0x8aff07[_0x58f5ff(0x1ce)][_0x29dbc0];if(!_0x46e167)return;_0x10a81b=_0x46e167[_0x58f5ff(0x48c)];const _0x4abf6a=await _0x1a6951['npcs']['toArray'](),_0x2900ca=new Map(_0x4abf6a[_0x58f5ff(0x412)](_0x9fd0d0=>[_0x9fd0d0[_0x58f5ff(0xf74)],_0x9fd0d0])),_0x1e3540=document[_0x58f5ff(0x89d)](_0x58f5ff(0xfaf)),_0x597b90=document[_0x58f5ff(0x89d)](_0x58f5ff(0x117c)),_0x14d210=document[_0x58f5ff(0x89d)](_0x58f5ff(0x83e));_0x597b90['innerHTML']='',_0x597b90[_0x58f5ff(0xaaf)][_0x58f5ff(0x85e)]=_0x8aff07[_0x58f5ff(0xdb9)][_0x58f5ff(0x85e)]||'default';const _0x5252d6=document[_0x58f5ff(0x89d)](_0x58f5ff(0x34e))[_0x58f5ff(0x2f1)][_0x58f5ff(0x3ff)]('dark-mode');_0x597b90[_0x58f5ff(0x68e)]['backgroundColor']=_0x5252d6?_0x58f5ff(0x5c8):_0x58f5ff(0x1022);let _0x3b535d;if(_0x46e167[_0x58f5ff(0x48c)]==='group'){_0x1e3540[_0x58f5ff(0xf12)]=_0x46e167[_0x58f5ff(0xb9a)]+'\x20('+(_0x46e167[_0x58f5ff(0x394)][_0x58f5ff(0x7aa)]+0x1)+')',_0x14d210[_0x58f5ff(0xe4f)]='在\x20'+_0x46e167['groupName']+'\x20中聊天',_0x3b535d={'id':_0x58f5ff(0x85c),'isGroup':!![],'name':_0x46e167[_0x58f5ff(0xb9a)],'originalName':_0x8aff07['originalName'],'members':_0x46e167[_0x58f5ff(0x394)][_0x58f5ff(0x412)](_0x259851=>{const _0x2dbeaa=_0x58f5ff,_0x3e536a=_0x2900ca['get'](_0x259851[_0x2dbeaa(0xf74)]);let _0x51bf97=_0x3e536a&&_0x3e536a[_0x2dbeaa(0x12c8)]?_0x3e536a['avatar']:_0x5b873d['globalSettings'][_0x2dbeaa(0x122b)]?_0x2dbeaa(0x1017)+encodeURIComponent(_0x259851['avatar_prompt']||_0x2dbeaa(0x47a)):_0x15061e;return{'originalName':_0x259851['name'],'groupNickname':_0x259851[_0x2dbeaa(0xf74)],'avatar':_0x51bf97};}),'settings':{..._0x8aff07['settings'],'myNickname':_0x8aff07[_0x58f5ff(0xf74)],'myAvatar':_0x8aff07[_0x58f5ff(0xdb9)]['aiAvatar'],'myAvatarFrame':_0x8aff07[_0x58f5ff(0xdb9)][_0x58f5ff(0xeae)]}};for(const _0x3a13c2 of _0x46e167['messages']){const _0x5b04c7=_0x3a13c2[_0x58f5ff(0x548)]===(_0x8aff07[_0x58f5ff(0x1045)]||_0x8aff07[_0x58f5ff(0xf74)]),_0x552cbe=_0x5b04c7?'user':_0x58f5ff(0x1377),_0x6098ce={'role':_0x552cbe,'senderName':_0x3a13c2[_0x58f5ff(0x548)],'content':_0x3a13c2[_0x58f5ff(0x28c)],'timestamp':Date[_0x58f5ff(0xf1a)]()+Math['random']()},_0x4d7dae=await _0x1ed144(_0x6098ce,_0x3b535d);_0x4d7dae&&_0x597b90[_0x58f5ff(0x22f)](_0x4d7dae);}}else{_0x1e3540[_0x58f5ff(0xf12)]=_0x46e167[_0x58f5ff(0x4bc)][_0x58f5ff(0xf74)],_0x14d210['placeholder']='与\x20'+_0x46e167[_0x58f5ff(0x4bc)][_0x58f5ff(0xf74)]+'\x20的对话';const _0x1b2a36=_0x2900ca[_0x58f5ff(0x650)](_0x46e167[_0x58f5ff(0x4bc)][_0x58f5ff(0xf74)]),_0x4b92d2=_0x1b2a36&&_0x1b2a36[_0x58f5ff(0x12c8)]?_0x1b2a36[_0x58f5ff(0x12c8)]:_0x5b873d['globalSettings']['enableAiDrawing']?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x46e167[_0x58f5ff(0x4bc)][_0x58f5ff(0x15d)]||_0x58f5ff(0x47a)):_0x15061e;_0x3b535d={'id':_0x58f5ff(0xba2),'isGroup':![],'name':_0x46e167[_0x58f5ff(0x4bc)][_0x58f5ff(0xf74)],'originalName':_0x8aff07[_0x58f5ff(0x1045)],'settings':{..._0x8aff07[_0x58f5ff(0xdb9)],'myAvatar':_0x8aff07[_0x58f5ff(0xdb9)][_0x58f5ff(0xdd3)],'myAvatarFrame':_0x8aff07[_0x58f5ff(0xdb9)][_0x58f5ff(0xeae)],'aiAvatar':_0x4b92d2,'aiAvatarFrame':''}};for(const _0x4f2e57 of _0x46e167[_0x58f5ff(0x732)]){const _0x48efbd=_0x4f2e57[_0x58f5ff(0x548)]===(_0x8aff07[_0x58f5ff(0x1045)]||_0x8aff07[_0x58f5ff(0xf74)]),_0x38d5ea=_0x48efbd?_0x58f5ff(0x116c):_0x58f5ff(0x1377),_0x27fc4d={'role':_0x38d5ea,'senderName':_0x4f2e57[_0x58f5ff(0x548)],'content':_0x4f2e57[_0x58f5ff(0x28c)],'timestamp':Date[_0x58f5ff(0xf1a)]()+Math[_0x58f5ff(0xdc6)]()},_0x58fc3c=await _0x1ed144(_0x27fc4d,_0x3b535d);_0x58fc3c&&_0x597b90[_0x58f5ff(0x22f)](_0x58fc3c);}}_0x16d75b(_0x58f5ff(0x835)),_0x597b90[_0x58f5ff(0xb0e)]=_0x597b90[_0x58f5ff(0x624)];}function _0x2b16cb(){const _0x596a95=_0x41eae2;document[_0x596a95(0x89d)]('char-qq-transcript-modal')[_0x596a95(0x2f1)][_0x596a95(0x1247)](_0x596a95(0x11e4));}async function _0x34a168(){const _0x5eca21=_0x41eae2;if(!_0x521c79)return;const _0xef033a=_0x5b873d[_0x5eca21(0x667)][_0x521c79];if(!_0xef033a){await _0x532f76(_0x5eca21(0x10de),_0x5eca21(0xdf0));return;}await _0x532f76('请稍候...',_0x5eca21(0xb98)+_0xef033a[_0x5eca21(0xf74)]+_0x5eca21(0xb49));const {proxyUrl:_0x403d18,apiKey:_0x91a6b7,model:_0x3a95f1}=_0x5b873d[_0x5eca21(0x30d)];if(!_0x403d18||!_0x91a6b7||!_0x3a95f1){alert(_0x5eca21(0xebf));return;}const _0x3da944=_0x5b873d['qzoneSettings'][_0x5eca21(0x22a)]===_0x5eca21(0x1285)||!_0x5b873d[_0x5eca21(0x5c1)]['nickname']?'用户':_0x5b873d[_0x5eca21(0x5c1)]['nickname'],_0x7c39c1=_0xef033a['longTermMemory']&&_0xef033a[_0x5eca21(0xc18)]['length']>0x0?_0xef033a[_0x5eca21(0xc18)][_0x5eca21(0x412)](_0x12c34d=>_0x5eca21(0x768)+_0x4ce38e(_0x12c34d[_0x5eca21(0x114e)])+')\x20'+_0x12c34d['content'])[_0x5eca21(0x1237)]('\x0a'):'无',_0x323b3a=_0xef033a[_0x5eca21(0xdb9)]['maxMemory']||0xa,_0x63656b=_0xef033a['history'][_0x5eca21(0xdd0)](-_0x323b3a)['map'](_0x41897b=>(_0x41897b[_0x5eca21(0xa57)]==='user'?_0x3da944:_0xef033a[_0x5eca21(0xf74)])+':\x20'+String(_0x41897b[_0x5eca21(0x28c)])['substring'](0x0,0x1e)+_0x5eca21(0x1046))[_0x5eca21(0x1237)]('\x0a'),_0x2aad24=(_0xef033a[_0x5eca21(0xdb9)][_0x5eca21(0x32d)]||[])[_0x5eca21(0x412)](_0x2b8bf5=>_0x5b873d[_0x5eca21(0x8a1)][_0x5eca21(0x12f4)](_0x17e8b6=>_0x17e8b6['id']===_0x2b8bf5))[_0x5eca21(0x3d8)](Boolean)[_0x5eca21(0x412)](_0x4d9781=>'\x0a##\x20世界书《'+_0x4d9781['name']+_0x5eca21(0x241)+_0x4d9781['content'][_0x5eca21(0x3d8)](_0x39aa01=>_0x39aa01[_0x5eca21(0x104e)])[_0x5eca21(0x412)](_0x2ef1dc=>'-\x20'+_0x2ef1dc[_0x5eca21(0x28c)])[_0x5eca21(0x1237)]('\x0a'))[_0x5eca21(0x1237)](''),_0x436098=_0x247dd3(_0xef033a,0x3,_0x5eca21(0x5be)),_0x22fde3=_0x247dd3(_0xef033a,0x6,'hours'),_0x2e9cbd=_0x247dd3(_0xef033a,0x9,_0x5eca21(0x5be)),_0x457b2a=_0x247dd3(_0xef033a,0x1,'days'),_0x5bdc13=_0x247dd3(_0xef033a,0x3,_0x5eca21(0xccc)),_0x434f33=_0x247dd3(_0xef033a,0x7,_0x5eca21(0xccc));let _0x13c160='';if(_0x436098||_0x22fde3||_0x2e9cbd||_0x457b2a||_0x5bdc13||_0x434f33){_0x13c160+=_0x5eca21(0x10cc);if(_0x436098)_0x13c160+=_0x436098;if(_0x22fde3)_0x13c160+=_0x22fde3;if(_0x2e9cbd)_0x13c160+=_0x2e9cbd;if(_0x436098||_0x22fde3||_0x2e9cbd)_0x13c160+='\x0a';if(_0x457b2a)_0x13c160+=_0x457b2a;if(_0x5bdc13)_0x13c160+=_0x5bdc13;if(_0x434f33)_0x13c160+=_0x434f33;}const _0x196afa=_0x5eca21(0x2f0)+_0xef033a[_0x5eca21(0xf74)]+_0x5eca21(0xb67)+_0xef033a[_0x5eca21(0xdb9)]['aiPersona']+'\x0a'+_0x7c39c1+'\x0a'+_0x2aad24+'\x0a'+_0x13c160+_0x5eca21(0x445)+_0x3da944+'”的对话摘要**:\x0a'+_0x63656b+_0x5eca21(0xd4b);try{const _0x1b3ac5=[{'role':_0x5eca21(0x116c),'content':_0x5eca21(0x2c9)}];let _0x1c69e9=_0x403d18['includes']('generativelanguage'),_0x42e34c=_0xa615f4(_0x3a95f1,_0x91a6b7,_0x196afa,_0x1b3ac5);const _0x180467=_0x1c69e9?await fetch(_0x42e34c['url'],_0x42e34c[_0x5eca21(0xd98)]):await fetch(_0x403d18+'/v1/chat/completions',{'method':_0x5eca21(0xd14),'headers':{'Content-Type':_0x5eca21(0xce4),'Authorization':'Bearer\x20'+_0x91a6b7},'body':JSON[_0x5eca21(0x465)]({'model':_0x3a95f1,'messages':[{'role':_0x5eca21(0x18c),'content':_0x196afa},..._0x1b3ac5],'temperature':_0x5b873d[_0x5eca21(0x21a)][_0x5eca21(0x576)]||0.9})});if(!_0x180467['ok'])throw new Error(_0x5eca21(0x10d8)+_0x180467[_0x5eca21(0x517)]);const _0x8b88bb=await _0x180467[_0x5eca21(0x6b5)](),_0x49b1dc=getGeminiResponseText(_0x8b88bb),_0x1910f2=_0x49b1dc[_0x5eca21(0x86c)](/(\[[\s\S]*\])/);if(!_0x1910f2||!_0x1910f2[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x49b1dc);const _0x481214=_0x1910f2[0x0];let _0x437012;try{_0x437012=JSON[_0x5eca21(0x2cb)](_0x481214);}catch(_0x53a757){throw new Error(_0x5eca21(0x567)+_0x53a757[_0x5eca21(0x1288)]+_0x5eca21(0x6c3)+_0x49b1dc);}_0xef033a[_0x5eca21(0xdfe)]=_0x437012,await _0x1a6951[_0x5eca21(0x667)][_0x5eca21(0xc0f)](_0xef033a),await _0x2ae346();}catch(_0x565a5d){console[_0x5eca21(0x1fd)](_0x5eca21(0xf11),_0x565a5d),await _0x532f76(_0x5eca21(0x1020),_0x5eca21(0xee4)+_0x565a5d[_0x5eca21(0x1288)]);}}async function _0x2ae346(){const _0x17fbf3=_0x41eae2,_0x316931=document[_0x17fbf3(0x89d)](_0x17fbf3(0xe6c));_0x316931['innerHTML']='';if(!_0x521c79)return;const _0x423185=_0x5b873d[_0x17fbf3(0x667)][_0x521c79],_0x153e37=_0x423185[_0x17fbf3(0xdfe)]||[];if(_0x153e37[_0x17fbf3(0x7aa)]===0x0){_0x316931['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>';return;}const _0x1a752f='https://i.postimg.cc/KYr2qRCK/1.jpg';_0x153e37[_0x17fbf3(0xd9a)](_0x5b0653=>{const _0xcc6758=_0x17fbf3,_0x115fb8=document[_0xcc6758(0x285)](_0xcc6758(0xb25));_0x115fb8[_0xcc6758(0x81c)]=_0xcc6758(0x69c),_0x115fb8[_0xcc6758(0xaaf)][_0xcc6758(0xf6e)]=_0x5b0653['description'],_0x316931['appendChild'](_0x115fb8);if(_0x5b873d[_0xcc6758(0x21a)][_0xcc6758(0x122b)]){_0x115fb8['style'][_0xcc6758(0x96c)]=_0xcc6758(0x8ad);const _0x2fb694=/[^\x00-\x7F]/[_0xcc6758(0xb80)](_0x5b0653[_0xcc6758(0x895)]),_0x4dbb87=_0x5b0653['image_prompt']&&_0x5b0653['image_prompt'][_0xcc6758(0xc3a)]()&&!_0x2fb694,_0xcb40d7=_0x4dbb87?_0x5b0653[_0xcc6758(0x895)]:_0xcc6758(0x71f),_0xb65d75=_0xcc6758(0x1017)+encodeURIComponent(_0xcb40d7),_0x35eddc=new Image();_0x35eddc[_0xcc6758(0x736)]=function(){const _0x1d1270=_0xcc6758;_0x115fb8[_0x1d1270(0x68e)]['backgroundImage']=_0x1d1270(0xa0c)+this[_0x1d1270(0x9e3)]+')';},_0x35eddc[_0xcc6758(0x1010)]=function(){const _0x3d9660=_0xcc6758;_0x115fb8[_0x3d9660(0x68e)]['backgroundImage']=_0x3d9660(0xa0c)+_0x1a752f+')';},_0x35eddc['src']=_0xb65d75;}else{_0x115fb8[_0xcc6758(0x68e)]['backgroundColor']=_0xcc6758(0x1022),_0x115fb8[_0xcc6758(0x68e)][_0xcc6758(0x86e)]=_0xcc6758(0x433);const _0x30f94a=document[_0xcc6758(0x285)]('p');_0x30f94a[_0xcc6758(0x81c)]=_0xcc6758(0x206),_0x30f94a['textContent']=_0x5b0653[_0xcc6758(0xf6e)]||'(这张照片没有描述)',_0x115fb8[_0xcc6758(0x22f)](_0x30f94a);}});}async function _0xdc6bcf(){const _0x581e56=_0x41eae2;if(!_0x521c79)return;const _0x51b6f8=_0x5b873d[_0x581e56(0x667)][_0x521c79];if(!_0x51b6f8)return;await _0x532f76(_0x581e56(0xb6a),_0x581e56(0x56e)+_0x51b6f8[_0x581e56(0xf74)]+'”的网上冲浪足迹...');const {proxyUrl:_0xeb9473,apiKey:_0x15cbdc,model:_0x39bb75}=_0x5b873d['apiConfig'];if(!_0xeb9473||!_0x15cbdc||!_0x39bb75){alert(_0x581e56(0x2e4));return;}const _0x1f2feb=_0x5b873d[_0x581e56(0x5c1)][_0x581e56(0x22a)]==='{{user}}'||!_0x5b873d[_0x581e56(0x5c1)][_0x581e56(0x22a)]?'用户':_0x5b873d[_0x581e56(0x5c1)][_0x581e56(0x22a)],_0x1fd686=_0x51b6f8[_0x581e56(0xc18)]&&_0x51b6f8['longTermMemory'][_0x581e56(0x7aa)]>0x0?_0x51b6f8[_0x581e56(0xc18)][_0x581e56(0x412)](_0x51934c=>_0x581e56(0x768)+_0x4ce38e(_0x51934c[_0x581e56(0x114e)])+')\x20'+_0x51934c['content'])[_0x581e56(0x1237)]('\x0a'):'无',_0xd7b872=_0x51b6f8[_0x581e56(0xdb9)][_0x581e56(0x46f)]||0xa,_0xb62bb2=_0x51b6f8['history']['slice'](-_0xd7b872)[_0x581e56(0x412)](_0x377f90=>(_0x377f90[_0x581e56(0xa57)]===_0x581e56(0x116c)?_0x1f2feb:_0x51b6f8[_0x581e56(0xf74)])+':\x20'+String(_0x377f90[_0x581e56(0x28c)])[_0x581e56(0x489)](0x0,0x1e)+_0x581e56(0x1046))[_0x581e56(0x1237)]('\x0a'),_0x5ee15e=(_0x51b6f8[_0x581e56(0xdb9)][_0x581e56(0x32d)]||[])[_0x581e56(0x412)](_0x315740=>_0x5b873d[_0x581e56(0x8a1)][_0x581e56(0x12f4)](_0x3d3ca5=>_0x3d3ca5['id']===_0x315740))[_0x581e56(0x3d8)](Boolean)['map'](_0x4a1000=>_0x581e56(0xf50)+_0x4a1000['name']+_0x581e56(0x241)+_0x4a1000[_0x581e56(0x28c)][_0x581e56(0x3d8)](_0x31ec59=>_0x31ec59[_0x581e56(0x104e)])['map'](_0x5a972f=>'-\x20'+_0x5a972f[_0x581e56(0x28c)])[_0x581e56(0x1237)]('\x0a'))['join'](''),_0x1d4928=_0x247dd3(_0x51b6f8,0x3,'hours'),_0x23190a=_0x247dd3(_0x51b6f8,0x6,_0x581e56(0x5be)),_0x375719=_0x247dd3(_0x51b6f8,0x9,_0x581e56(0x5be)),_0x3ca25c=_0x247dd3(_0x51b6f8,0x1,_0x581e56(0xccc)),_0x38c147=_0x247dd3(_0x51b6f8,0x3,_0x581e56(0xccc)),_0x55b312=_0x247dd3(_0x51b6f8,0x7,_0x581e56(0xccc));let _0x270667='';if(_0x1d4928||_0x23190a||_0x375719||_0x3ca25c||_0x38c147||_0x55b312){_0x270667+=_0x581e56(0x10cc);if(_0x1d4928)_0x270667+=_0x1d4928;if(_0x23190a)_0x270667+=_0x23190a;if(_0x375719)_0x270667+=_0x375719;if(_0x1d4928||_0x23190a||_0x375719)_0x270667+='\x0a';if(_0x3ca25c)_0x270667+=_0x3ca25c;if(_0x38c147)_0x270667+=_0x38c147;if(_0x55b312)_0x270667+=_0x55b312;}const _0x59e911=_0x581e56(0x2f0)+_0x51b6f8[_0x581e56(0xf74)]+_0x581e56(0xa3a)+_0x51b6f8[_0x581e56(0xdb9)][_0x581e56(0x1269)]+_0x581e56(0x3f9)+_0x1fd686+'\x0a'+_0x5ee15e+'\x0a'+_0x270667+'\x20\x0a-\x20**你最近和“'+_0x1f2feb+_0x581e56(0xcb4)+_0xb62bb2+_0x581e56(0x107f);try{const _0x28b30b=[{'role':'user','content':_0x581e56(0x395)}];let _0x4ec0ee=_0xeb9473['includes'](_0x581e56(0x6a6)),_0x1a048b=_0xa615f4(_0x39bb75,_0x15cbdc,_0x59e911,_0x28b30b);const _0x5eefcc=_0x4ec0ee?await fetch(_0x1a048b[_0x581e56(0x11de)],_0x1a048b[_0x581e56(0xd98)]):await fetch(_0xeb9473+_0x581e56(0x6dd),{'method':_0x581e56(0xd14),'headers':{'Content-Type':_0x581e56(0xce4),'Authorization':'Bearer\x20'+_0x15cbdc},'body':JSON['stringify']({'model':_0x39bb75,'messages':[{'role':_0x581e56(0x18c),'content':_0x59e911},..._0x28b30b],'temperature':_0x5b873d[_0x581e56(0x21a)][_0x581e56(0x576)]||0.9})});if(!_0x5eefcc['ok'])throw new Error(_0x581e56(0x10d8)+_0x5eefcc['statusText']);const _0x35f3f8=await _0x5eefcc[_0x581e56(0x6b5)](),_0x1037c7=getGeminiResponseText(_0x35f3f8),_0x114ad4=_0x1037c7[_0x581e56(0x86c)](/(\[[\s\S]*\])/);if(!_0x114ad4||!_0x114ad4[0x0])throw new Error(_0x581e56(0x9a1)+_0x1037c7);const _0x52b584=_0x114ad4[0x0];let _0xff2773;try{_0xff2773=JSON[_0x581e56(0x2cb)](_0x52b584);}catch(_0x8e8bd5){throw new Error(_0x581e56(0x567)+_0x8e8bd5[_0x581e56(0x1288)]+_0x581e56(0x6c3)+_0x1037c7);}_0x51b6f8[_0x581e56(0xc1c)]=_0xff2773,await _0x1a6951[_0x581e56(0x667)][_0x581e56(0xc0f)](_0x51b6f8),await _0x469ccb();}catch(_0x5e9bec){console[_0x581e56(0x1fd)](_0x581e56(0xf0d),_0x5e9bec),await _0x532f76(_0x581e56(0x1020),_0x581e56(0x1b5)+_0x5e9bec[_0x581e56(0x1288)]);}}function _0x469ccb(){const _0x14b395=_0x41eae2,_0x4b0048=document[_0x14b395(0x89d)]('char-browser-history');_0x4b0048['innerHTML']='';if(!_0x521c79)return;const _0x256967=_0x5b873d[_0x14b395(0x667)][_0x521c79],_0x1fb4eb=_0x256967['simulatedBrowserHistory']||[];if(_0x1fb4eb[_0x14b395(0x7aa)]===0x0){_0x4b0048[_0x14b395(0x1ef)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>';return;}_0x1fb4eb[_0x14b395(0xd9a)]((_0x4c6a8e,_0x57bede)=>{const _0x4e0e29=_0x14b395,_0x490edf=document[_0x4e0e29(0x285)]('div');_0x490edf[_0x4e0e29(0x81c)]=_0x4e0e29(0x71d),_0x490edf[_0x4e0e29(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x4c6a8e['title']+_0x4e0e29(0x5d8)+_0x4c6a8e[_0x4e0e29(0x11de)]+_0x4e0e29(0x967),_0x490edf['addEventListener'](_0x4e0e29(0x12a5),()=>_0x242d8b(_0x57bede)),_0x4b0048[_0x4e0e29(0x22f)](_0x490edf);});}async function _0x242d8b(_0x59ac49){const _0x4eb876=_0x41eae2,_0x41cff8=_0x5b873d[_0x4eb876(0x667)][_0x521c79],_0x126ed9=_0x41cff8[_0x4eb876(0xc1c)][_0x59ac49];if(!_0x126ed9)return;_0x363100=_0x126ed9,_0x50520(_0x126ed9),_0x16d75b(_0x4eb876(0x645));const _0x392ba1=document[_0x4eb876(0x89d)](_0x4eb876(0xb66)),_0x3b470d=await _0x1a6951[_0x4eb876(0x183)][_0x4eb876(0x176)]({'type':_0x4eb876(0x29c),'content.url':_0x126ed9[_0x4eb876(0x11de)]})['first']();_0x392ba1[_0x4eb876(0x2f1)][_0x4eb876(0x73b)](_0x4eb876(0x8ea),!!_0x3b470d);}async function _0x1edb8b(){const _0x5173c7=_0x41eae2;if(!_0x363100||!_0x521c79)return;const _0x120d55=_0x363100,_0x154745=_0x5b873d[_0x5173c7(0x667)][_0x521c79],_0x6c61b6=document[_0x5173c7(0x89d)](_0x5173c7(0xb66)),_0x46df17=await _0x1a6951[_0x5173c7(0x183)][_0x5173c7(0x176)]({'type':_0x5173c7(0x29c),'content.url':_0x120d55[_0x5173c7(0x11de)]})[_0x5173c7(0x2a6)]();if(_0x46df17)await _0x1a6951[_0x5173c7(0x183)]['delete'](_0x46df17['id']),_0x6c61b6['classList'][_0x5173c7(0x1247)](_0x5173c7(0x8ea)),await _0x532f76(_0x5173c7(0xc43),'已取消收藏。');else{const _0x5917ec={'type':_0x5173c7(0x29c),'content':{..._0x120d55,'characterId':_0x521c79,'characterName':_0x154745['name']},'timestamp':Date[_0x5173c7(0xf1a)]()};await _0x1a6951[_0x5173c7(0x183)][_0x5173c7(0x569)](_0x5917ec),_0x6c61b6[_0x5173c7(0x2f1)][_0x5173c7(0x569)](_0x5173c7(0x8ea)),await _0x532f76(_0x5173c7(0xc43),_0x5173c7(0x8ac));}}function _0x50520(_0xc328b9){const _0xc292ab=_0x41eae2,_0x17f6ae=document[_0xc292ab(0x89d)](_0xc292ab(0x136a)),_0x4d82fe=document[_0xc292ab(0x89d)](_0xc292ab(0x6cb));_0x17f6ae[_0xc292ab(0xf12)]=_0xc328b9['title'],_0x4d82fe[_0xc292ab(0x1ef)]='',_0xc328b9['type']===_0xc292ab(0xbef)?_0x4d82fe[_0xc292ab(0x1ef)]=_0xc292ab(0x338)+(_0xc328b9['title']||_0xc292ab(0xbbe))+_0xc292ab(0x164):_0x4d82fe['innerHTML']=_0xc292ab(0x131d)+(_0xc328b9['content']||_0xc292ab(0xcce))[_0xc292ab(0xfbf)](/\n/g,_0xc292ab(0x209))+_0xc292ab(0x164);}async function _0x2dafb4(){const _0x5a6a40=_0x41eae2;if(!_0x521c79)return;const _0xaf5958=_0x5b873d[_0x5a6a40(0x667)][_0x521c79];if(!_0xaf5958)return;await _0x532f76(_0x5a6a40(0xb6a),'正在模拟“'+_0xaf5958[_0x5a6a40(0xf74)]+_0x5a6a40(0x119d));const {proxyUrl:_0x3483a4,apiKey:_0x1b1029,model:_0x3e741f}=_0x5b873d[_0x5a6a40(0x30d)];if(!_0x3483a4||!_0x1b1029||!_0x3e741f){alert(_0x5a6a40(0x2e4));return;}const _0x281fa4=_0x5b873d[_0x5a6a40(0x5c1)][_0x5a6a40(0x22a)]===_0x5a6a40(0x1285)||!_0x5b873d[_0x5a6a40(0x5c1)][_0x5a6a40(0x22a)]?'用户':_0x5b873d['qzoneSettings'][_0x5a6a40(0x22a)],_0x4430db=_0xaf5958[_0x5a6a40(0xc18)]&&_0xaf5958[_0x5a6a40(0xc18)][_0x5a6a40(0x7aa)]>0x0?_0xaf5958[_0x5a6a40(0xc18)][_0x5a6a40(0x412)](_0x1c7053=>_0x5a6a40(0x768)+_0x4ce38e(_0x1c7053[_0x5a6a40(0x114e)])+')\x20'+_0x1c7053[_0x5a6a40(0x28c)])[_0x5a6a40(0x1237)]('\x0a'):'无',_0x3ee4bb=_0xaf5958[_0x5a6a40(0xdb9)][_0x5a6a40(0x46f)]||0xa,_0x22dcb1=_0xaf5958[_0x5a6a40(0x551)][_0x5a6a40(0xdd0)](-_0x3ee4bb)[_0x5a6a40(0x412)](_0x2b46db=>(_0x2b46db[_0x5a6a40(0xa57)]===_0x5a6a40(0x116c)?_0x281fa4:_0xaf5958[_0x5a6a40(0xf74)])+':\x20'+String(_0x2b46db[_0x5a6a40(0x28c)])[_0x5a6a40(0x489)](0x0,0x1e)+'...')['join']('\x0a'),_0x3a6bcf=(_0xaf5958['settings'][_0x5a6a40(0x32d)]||[])[_0x5a6a40(0x412)](_0x14db4e=>_0x5b873d[_0x5a6a40(0x8a1)][_0x5a6a40(0x12f4)](_0x283238=>_0x283238['id']===_0x14db4e))[_0x5a6a40(0x3d8)](Boolean)[_0x5a6a40(0x412)](_0x1094a4=>_0x5a6a40(0xf50)+_0x1094a4[_0x5a6a40(0xf74)]+'》设定:\x0a'+_0x1094a4['content'][_0x5a6a40(0x3d8)](_0x2c4dd0=>_0x2c4dd0['enabled'])['map'](_0x2556ab=>'-\x20'+_0x2556ab[_0x5a6a40(0x28c)])[_0x5a6a40(0x1237)]('\x0a'))[_0x5a6a40(0x1237)](''),_0x23e4b7=_0x247dd3(_0xaf5958,0x3,_0x5a6a40(0x5be)),_0x16b26b=_0x247dd3(_0xaf5958,0x6,'hours'),_0x2a9236=_0x247dd3(_0xaf5958,0x9,'hours'),_0x4e4134=_0x247dd3(_0xaf5958,0x1,_0x5a6a40(0xccc)),_0x891ad2=_0x247dd3(_0xaf5958,0x3,_0x5a6a40(0xccc)),_0x28af3c=_0x247dd3(_0xaf5958,0x7,_0x5a6a40(0xccc));let _0x262172='';if(_0x23e4b7||_0x16b26b||_0x2a9236||_0x4e4134||_0x891ad2||_0x28af3c){_0x262172+=_0x5a6a40(0x10cc);if(_0x23e4b7)_0x262172+=_0x23e4b7;if(_0x16b26b)_0x262172+=_0x16b26b;if(_0x2a9236)_0x262172+=_0x2a9236;if(_0x23e4b7||_0x16b26b||_0x2a9236)_0x262172+='\x0a';if(_0x4e4134)_0x262172+=_0x4e4134;if(_0x891ad2)_0x262172+=_0x891ad2;if(_0x28af3c)_0x262172+=_0x28af3c;}const _0x54af9a='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0xaf5958[_0x5a6a40(0xf74)]+_0x5a6a40(0xd4c)+_0xaf5958['settings']['aiPersona']+_0x5a6a40(0x3f9)+_0x4430db+'\x0a'+_0x3a6bcf+'\x0a'+_0x262172+_0x5a6a40(0x445)+_0x281fa4+_0x5a6a40(0xcb4)+_0x22dcb1+_0x5a6a40(0xfbe);try{const _0x4dc495=[{'role':_0x5a6a40(0x116c),'content':_0x5a6a40(0x3d6)}];let _0x5cba68=_0x3483a4['includes'](_0x5a6a40(0x6a6)),_0x50b100=_0xa615f4(_0x3e741f,_0x1b1029,_0x54af9a,_0x4dc495);const _0x191569=_0x5cba68?await fetch(_0x50b100[_0x5a6a40(0x11de)],_0x50b100[_0x5a6a40(0xd98)]):await fetch(_0x3483a4+_0x5a6a40(0x6dd),{'method':_0x5a6a40(0xd14),'headers':{'Content-Type':_0x5a6a40(0xce4),'Authorization':'Bearer\x20'+_0x1b1029},'body':JSON[_0x5a6a40(0x465)]({'model':_0x3e741f,'messages':[{'role':_0x5a6a40(0x18c),'content':_0x54af9a},..._0x4dc495],'temperature':_0x5b873d[_0x5a6a40(0x21a)][_0x5a6a40(0x576)]||0.9})});if(!_0x191569['ok'])throw new Error('API\x20错误:\x20'+_0x191569[_0x5a6a40(0x517)]);const _0x1a4072=await _0x191569[_0x5a6a40(0x6b5)](),_0x278838=getGeminiResponseText(_0x1a4072),_0x124760=_0x278838[_0x5a6a40(0x86c)](/({[\s\S]*})/);if(!_0x124760)throw new Error(_0x5a6a40(0x659));const _0x55180f=JSON[_0x5a6a40(0x2cb)](_0x124760[0x0]);!_0x55180f[_0x5a6a40(0x325)]&&(_0x55180f[_0x5a6a40(0x325)]=[]),_0xaf5958[_0x5a6a40(0x12ca)]=_0x55180f,await _0x1a6951[_0x5a6a40(0x667)][_0x5a6a40(0xc0f)](_0xaf5958),await _0x59b018();}catch(_0x37ff81){console[_0x5a6a40(0x1fd)](_0x5a6a40(0x235),_0x37ff81),await _0x532f76(_0x5a6a40(0x1020),'无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x37ff81[_0x5a6a40(0x1288)]);}}function _0x2ca778(){const _0x206780=_0x41eae2;_0x5d050b(),_0x16d75b(_0x206780(0x19b));}function _0x5d050b(){const _0x24f434=_0x41eae2,_0xef0bf8=document[_0x24f434(0x89d)](_0x24f434(0x844));_0xef0bf8[_0x24f434(0x1ef)]='';const _0x1e413d=_0x5b873d[_0x24f434(0x667)][_0x521c79],_0x48e140=_0x1e413d[_0x24f434(0x12ca)]||{},_0x54d61a=_0x48e140[_0x24f434(0x325)]||[],_0xeecf57=_0x48e140[_0x24f434(0x4cd)]||0x0,_0x27eaf3=document[_0x24f434(0x285)](_0x24f434(0xb25));_0x27eaf3[_0x24f434(0x68e)][_0x24f434(0x137a)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20',_0x27eaf3['innerHTML']=_0x24f434(0x5cc)+_0xeecf57['toFixed'](0x2)+_0x24f434(0x60f),_0xef0bf8[_0x24f434(0x22f)](_0x27eaf3);const _0xb02294=document[_0x24f434(0x285)]('h3');_0xb02294[_0x24f434(0xf12)]=_0x24f434(0x837),_0xb02294[_0x24f434(0x68e)][_0x24f434(0x137a)]=_0x24f434(0x805),_0xef0bf8['appendChild'](_0xb02294);if(_0x54d61a[_0x24f434(0x7aa)]===0x0){_0xef0bf8[_0x24f434(0x1ef)]+=_0x24f434(0x1154);return;}_0x54d61a[_0x24f434(0xd9a)](_0x503281=>{const _0x107a66=_0x24f434,_0x4bfdc1=document['createElement'](_0x107a66(0xb25));_0x4bfdc1[_0x107a66(0x68e)][_0x107a66(0x137a)]=_0x107a66(0x8fb),_0x4bfdc1['innerHTML']=_0x107a66(0x20e)+_0x503281[_0x107a66(0x112a)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>'+_0x503281[_0x107a66(0x632)]+_0x107a66(0xd86)+(_0x503281['price']||0x0)[_0x107a66(0x8f7)](0x2)+_0x107a66(0x967),_0xef0bf8['appendChild'](_0x4bfdc1);});}async function _0x131ab5(){const _0x14f4a6=_0x41eae2;if(!_0x521c79)return;const _0x5297fe=_0x5b873d['chats'][_0x521c79];if(!_0x5297fe)return;await _0x532f76('请稍候...',_0x14f4a6(0xb98)+_0x5297fe[_0x14f4a6(0xf74)]+_0x14f4a6(0x1257));const {proxyUrl:_0x184d10,apiKey:_0x57e96f,model:_0x6489c3}=_0x5b873d[_0x14f4a6(0x30d)];if(!_0x184d10||!_0x57e96f||!_0x6489c3){alert('请先在API设置中配置好API信息。');return;}const _0xc71851=_0x5b873d[_0x14f4a6(0x5c1)][_0x14f4a6(0x22a)]==='{{user}}'||!_0x5b873d[_0x14f4a6(0x5c1)]['nickname']?'用户':_0x5b873d[_0x14f4a6(0x5c1)][_0x14f4a6(0x22a)],_0x59f77b=_0x5297fe[_0x14f4a6(0xc18)]&&_0x5297fe['longTermMemory'][_0x14f4a6(0x7aa)]>0x0?_0x5297fe[_0x14f4a6(0xc18)][_0x14f4a6(0x412)](_0x5c31a3=>_0x14f4a6(0x768)+_0x4ce38e(_0x5c31a3[_0x14f4a6(0x114e)])+')\x20'+_0x5c31a3[_0x14f4a6(0x28c)])[_0x14f4a6(0x1237)]('\x0a'):'无',_0x46b1bc=_0x5297fe[_0x14f4a6(0xdb9)][_0x14f4a6(0x46f)]||0xa,_0x591f30=_0x5297fe[_0x14f4a6(0x551)][_0x14f4a6(0xdd0)](-_0x46b1bc)[_0x14f4a6(0x412)](_0x3f2e52=>(_0x3f2e52[_0x14f4a6(0xa57)]==='user'?_0xc71851:_0x5297fe[_0x14f4a6(0xf74)])+':\x20'+String(_0x3f2e52[_0x14f4a6(0x28c)])[_0x14f4a6(0x489)](0x0,0x1e)+'...')[_0x14f4a6(0x1237)]('\x0a'),_0x126101=(_0x5297fe[_0x14f4a6(0xdb9)]['linkedWorldBookIds']||[])[_0x14f4a6(0x412)](_0x58ea82=>_0x5b873d[_0x14f4a6(0x8a1)][_0x14f4a6(0x12f4)](_0x180537=>_0x180537['id']===_0x58ea82))[_0x14f4a6(0x3d8)](Boolean)[_0x14f4a6(0x412)](_0x4054b1=>_0x14f4a6(0xf50)+_0x4054b1[_0x14f4a6(0xf74)]+'》设定:\x0a'+_0x4054b1[_0x14f4a6(0x28c)]['filter'](_0x1c958a=>_0x1c958a[_0x14f4a6(0x104e)])[_0x14f4a6(0x412)](_0x9e1cae=>'-\x20'+_0x9e1cae[_0x14f4a6(0x28c)])[_0x14f4a6(0x1237)]('\x0a'))['join'](''),_0x14922e=_0x247dd3(_0x5297fe,0x3,'hours'),_0x1c76e6=_0x247dd3(_0x5297fe,0x6,_0x14f4a6(0x5be)),_0x497346=_0x247dd3(_0x5297fe,0x9,_0x14f4a6(0x5be)),_0x31ead6=_0x247dd3(_0x5297fe,0x1,_0x14f4a6(0xccc)),_0x169222=_0x247dd3(_0x5297fe,0x3,_0x14f4a6(0xccc)),_0x3edcc0=_0x247dd3(_0x5297fe,0x7,_0x14f4a6(0xccc));let _0x165c0a='';if(_0x14922e||_0x1c76e6||_0x497346||_0x31ead6||_0x169222||_0x3edcc0){_0x165c0a+=_0x14f4a6(0x10cc);if(_0x14922e)_0x165c0a+=_0x14922e;if(_0x1c76e6)_0x165c0a+=_0x1c76e6;if(_0x497346)_0x165c0a+=_0x497346;if(_0x14922e||_0x1c76e6||_0x497346)_0x165c0a+='\x0a';if(_0x31ead6)_0x165c0a+=_0x31ead6;if(_0x169222)_0x165c0a+=_0x169222;if(_0x3edcc0)_0x165c0a+=_0x3edcc0;}const _0x29f190='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x5297fe[_0x14f4a6(0xf74)]+'”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x5297fe[_0x14f4a6(0xdb9)]['aiPersona']+_0x14f4a6(0x3f9)+_0x59f77b+'\x0a'+_0x126101+'\x0a'+_0x165c0a+_0x14f4a6(0xdac)+_0xc71851+_0x14f4a6(0xcb4)+_0x591f30+_0x14f4a6(0xa27);try{const _0x3a487a=[{'role':_0x14f4a6(0x116c),'content':_0x14f4a6(0xc1d)}];let _0x444606=_0x184d10[_0x14f4a6(0xced)](_0x14f4a6(0x6a6)),_0xafd8d1=_0xa615f4(_0x6489c3,_0x57e96f,_0x29f190,_0x3a487a);const _0x3270d9=_0x444606?await fetch(_0xafd8d1[_0x14f4a6(0x11de)],_0xafd8d1[_0x14f4a6(0xd98)]):await fetch(_0x184d10+_0x14f4a6(0x6dd),{'method':_0x14f4a6(0xd14),'headers':{'Content-Type':_0x14f4a6(0xce4),'Authorization':'Bearer\x20'+_0x57e96f},'body':JSON[_0x14f4a6(0x465)]({'model':_0x6489c3,'messages':[{'role':_0x14f4a6(0x18c),'content':_0x29f190},..._0x3a487a],'temperature':_0x5b873d[_0x14f4a6(0x21a)][_0x14f4a6(0x576)]||0.9})});if(!_0x3270d9['ok']){const _0xa44b05=await _0x3270d9['json']()[_0x14f4a6(0x1035)](()=>null),_0x1c3086=_0xa44b05?.[_0x14f4a6(0x1fd)]?.[_0x14f4a6(0x1288)]||_0x3270d9['statusText'];throw new Error(_0x14f4a6(0x10d8)+_0x3270d9[_0x14f4a6(0x632)]+_0x14f4a6(0xc3d)+_0x1c3086);}const _0x13caab=await _0x3270d9[_0x14f4a6(0x6b5)](),_0x141d8a=getGeminiResponseText(_0x13caab),_0xbe7988=_0x141d8a['match'](/(\[[\s\S]*\])/);if(!_0xbe7988||!_0xbe7988[0x0])throw new Error(_0x14f4a6(0x9a1)+_0x141d8a);const _0x22f52d=_0xbe7988[0x0];let _0x35b9e;try{_0x35b9e=JSON['parse'](_0x22f52d);}catch(_0x277e71){throw new Error(_0x14f4a6(0x567)+_0x277e71['message']+'\x0a\x0aAI原始返回内容:\x0a'+_0x141d8a);}if(!Array[_0x14f4a6(0xbd6)](_0x35b9e))throw new Error(_0x14f4a6(0x875)+JSON[_0x14f4a6(0x465)](_0x35b9e));_0x5297fe['memos']=_0x35b9e['map'](_0x57e1ad=>({'id':Date[_0x14f4a6(0xf1a)]()+Math[_0x14f4a6(0xdc6)](),'title':_0x57e1ad[_0x14f4a6(0x104c)],'content':_0x57e1ad[_0x14f4a6(0x28c)]})),await _0x1a6951[_0x14f4a6(0x667)][_0x14f4a6(0xc0f)](_0x5297fe),await _0x1360e3();}catch(_0x1241a9){console[_0x14f4a6(0x1fd)](_0x14f4a6(0x960),_0x1241a9),await _0x532f76(_0x14f4a6(0x1020),_0x14f4a6(0x627)+_0x1241a9[_0x14f4a6(0x1288)]);}}async function _0x444d91(){const _0x4e98f5=_0x41eae2;if(!_0x521c79)return;const _0x4dc260=_0x5b873d['chats'][_0x521c79];if(!_0x4dc260)return;await _0x532f76(_0x4e98f5(0xb6a),'正在生成“'+_0x4dc260[_0x4e98f5(0xf74)]+_0x4e98f5(0x6a4));const {proxyUrl:_0x452a8d,apiKey:_0x1aaab8,model:_0x21431e}=_0x5b873d[_0x4e98f5(0x30d)];if(!_0x452a8d||!_0x1aaab8||!_0x21431e){alert('API未配置，无法生成内容。');return;}const _0x5a8f75=_0x5b873d['qzoneSettings'][_0x4e98f5(0x22a)]===_0x4e98f5(0x1285)||!_0x5b873d['qzoneSettings'][_0x4e98f5(0x22a)]?'用户':_0x5b873d[_0x4e98f5(0x5c1)][_0x4e98f5(0x22a)],_0x255be8=_0x4dc260[_0x4e98f5(0xc18)]&&_0x4dc260['longTermMemory'][_0x4e98f5(0x7aa)]>0x0?_0x4dc260['longTermMemory']['map'](_0x558a0d=>'-\x20(记录于\x20'+_0x4ce38e(_0x558a0d[_0x4e98f5(0x114e)])+')\x20'+_0x558a0d[_0x4e98f5(0x28c)])[_0x4e98f5(0x1237)]('\x0a'):'无',_0x44fd5f=_0x4dc260['settings'][_0x4e98f5(0x46f)]||0xa,_0xf5bead=_0x4dc260[_0x4e98f5(0x551)]['slice'](-_0x44fd5f)[_0x4e98f5(0x412)](_0x1504ca=>(_0x1504ca[_0x4e98f5(0xa57)]===_0x4e98f5(0x116c)?_0x5a8f75:_0x4dc260[_0x4e98f5(0xf74)])+':\x20'+String(_0x1504ca[_0x4e98f5(0x28c)])[_0x4e98f5(0x489)](0x0,0x1e)+_0x4e98f5(0x1046))[_0x4e98f5(0x1237)]('\x0a'),_0x8fa6e5=(_0x4dc260[_0x4e98f5(0xdb9)][_0x4e98f5(0x32d)]||[])[_0x4e98f5(0x412)](_0x1031ca=>_0x5b873d[_0x4e98f5(0x8a1)][_0x4e98f5(0x12f4)](_0x22a0cb=>_0x22a0cb['id']===_0x1031ca))['filter'](Boolean)['map'](_0x282c26=>_0x4e98f5(0xf50)+_0x282c26[_0x4e98f5(0xf74)]+_0x4e98f5(0x241)+_0x282c26[_0x4e98f5(0x28c)][_0x4e98f5(0x3d8)](_0x1bdd68=>_0x1bdd68[_0x4e98f5(0x104e)])['map'](_0x36b919=>'-\x20'+_0x36b919[_0x4e98f5(0x28c)])[_0x4e98f5(0x1237)]('\x0a'))['join'](''),_0x245e36=_0x247dd3(_0x4dc260,0x3,_0x4e98f5(0x5be)),_0x5605cb=_0x247dd3(_0x4dc260,0x6,_0x4e98f5(0x5be)),_0x3d34f2=_0x247dd3(_0x4dc260,0x9,_0x4e98f5(0x5be)),_0x29f856=_0x247dd3(_0x4dc260,0x1,_0x4e98f5(0xccc)),_0x59616c=_0x247dd3(_0x4dc260,0x3,_0x4e98f5(0xccc)),_0x25dfa3=_0x247dd3(_0x4dc260,0x7,'days');let _0x3c6616='';if(_0x245e36||_0x5605cb||_0x3d34f2||_0x29f856||_0x59616c||_0x25dfa3){_0x3c6616+=_0x4e98f5(0x10cc);if(_0x245e36)_0x3c6616+=_0x245e36;if(_0x5605cb)_0x3c6616+=_0x5605cb;if(_0x3d34f2)_0x3c6616+=_0x3d34f2;if(_0x245e36||_0x5605cb||_0x3d34f2)_0x3c6616+='\x0a';if(_0x29f856)_0x3c6616+=_0x29f856;if(_0x59616c)_0x3c6616+=_0x59616c;if(_0x25dfa3)_0x3c6616+=_0x25dfa3;}const _0x40d640=_0x4e98f5(0x2f0)+_0x4dc260['name']+_0x4e98f5(0x11db)+new Date()['toISOString']()+_0x4e98f5(0x94a)+_0x4dc260[_0x4e98f5(0xdb9)][_0x4e98f5(0x1269)]+_0x4e98f5(0x3f9)+_0x255be8+'\x0a'+_0x8fa6e5+'\x0a'+_0x3c6616+_0x4e98f5(0xdac)+_0x5a8f75+'”的对话摘要**:\x0a'+_0xf5bead+'\x0a\x0a现在，请开始生成这组足迹记录。';try{const _0x243ff7=[{'role':'user','content':_0x4e98f5(0xae8)}];let _0x4898c8=_0x452a8d[_0x4e98f5(0xced)](_0x4e98f5(0x6a6)),_0x1c962a=_0xa615f4(_0x21431e,_0x1aaab8,_0x40d640,_0x243ff7);const _0x3d26bf=_0x4898c8?await fetch(_0x1c962a[_0x4e98f5(0x11de)],_0x1c962a[_0x4e98f5(0xd98)]):await fetch(_0x452a8d+'/v1/chat/completions',{'method':_0x4e98f5(0xd14),'headers':{'Content-Type':_0x4e98f5(0xce4),'Authorization':_0x4e98f5(0x3fb)+_0x1aaab8},'body':JSON[_0x4e98f5(0x465)]({'model':_0x21431e,'messages':[{'role':_0x4e98f5(0x18c),'content':_0x40d640},..._0x243ff7],'temperature':_0x5b873d[_0x4e98f5(0x21a)]['apiTemperature']||0.9})});if(!_0x3d26bf['ok'])throw new Error('API\x20错误:\x20'+_0x3d26bf[_0x4e98f5(0x517)]);const _0x1b3326=await _0x3d26bf[_0x4e98f5(0x6b5)](),_0x2d146a=getGeminiResponseText(_0x1b3326),_0x1473e1=_0x2d146a[_0x4e98f5(0x86c)](/(\[[\s\S]*\])/);if(!_0x1473e1||!_0x1473e1[0x0])throw new Error(_0x4e98f5(0x9a1)+_0x2d146a);const _0x5735e9=_0x1473e1[0x0];let _0x1351e1;try{_0x1351e1=JSON[_0x4e98f5(0x2cb)](_0x5735e9);}catch(_0x234aaa){throw new Error(_0x4e98f5(0x567)+_0x234aaa[_0x4e98f5(0x1288)]+_0x4e98f5(0x6c3)+_0x2d146a);}_0x4dc260[_0x4e98f5(0xab8)]=_0x1351e1,await _0x1a6951[_0x4e98f5(0x667)][_0x4e98f5(0xc0f)](_0x4dc260),await _0x266f11();}catch(_0x5d3cba){console['error'](_0x4e98f5(0x1060),_0x5d3cba),await _0x532f76('生成失败',_0x4e98f5(0x122c)+_0x5d3cba[_0x4e98f5(0x1288)]);}}function _0x266f11(){const _0x1fdc2a=_0x41eae2,_0x403c5e=document[_0x1fdc2a(0x89d)]('char-amap-list');_0x403c5e[_0x1fdc2a(0x1ef)]='';if(!_0x521c79)return;const _0x4d036c=_0x5b873d[_0x1fdc2a(0x667)][_0x521c79],_0x4c0dde=_0x4d036c[_0x1fdc2a(0xab8)]||[];if(_0x4c0dde['length']===0x0){_0x403c5e[_0x1fdc2a(0x1ef)]=_0x1fdc2a(0x98f);return;}_0x4c0dde[_0x1fdc2a(0xd9a)](_0x3ee327=>{const _0x123985=_0x1fdc2a,_0x33222f=document['createElement']('div');_0x33222f[_0x123985(0x81c)]=_0x123985(0xcbd);let _0xd25ffb='';if(_0x3ee327[_0x123985(0x895)]){const _0xe26857='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x3ee327[_0x123985(0x895)]);_0xd25ffb=_0x123985(0xa42)+_0xe26857+_0x123985(0xd45)+_0x3ee327['comment']+'\x22></div>';}const _0x35efa9=_0x3ee327[_0x123985(0x114e)]?_0x4ce38e(new Date(_0x3ee327['timestamp'])[_0x123985(0xaa6)]()):_0x123985(0xf3d);_0x33222f['innerHTML']=_0x123985(0xf42)+_0x3ee327[_0x123985(0xf7c)]+_0x123985(0xe80)+_0x3ee327[_0x123985(0x7f0)]+_0x123985(0x703)+_0x3ee327['comment'][_0x123985(0xfbf)](/\n/g,_0x123985(0x962))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xd25ffb+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>'+_0x35efa9+_0x123985(0xb75),_0x403c5e[_0x123985(0x22f)](_0x33222f);});}async function _0x419c04(){const _0x71de56=_0x41eae2;if(!_0x521c79)return;const _0xf75b0d=_0x5b873d[_0x71de56(0x667)][_0x521c79];if(!_0xf75b0d)return;await _0x532f76(_0x71de56(0xb6a),_0x71de56(0xccf)+_0xf75b0d[_0x71de56(0xf74)]+'”的手机使用习惯...');const {proxyUrl:_0x5894d6,apiKey:_0x2004d1,model:_0x198f30}=_0x5b873d[_0x71de56(0x30d)];if(!_0x5894d6||!_0x2004d1||!_0x198f30){alert(_0x71de56(0x2e4));return;}const _0x5dc046=_0x5b873d['qzoneSettings'][_0x71de56(0x22a)]===_0x71de56(0x1285)||!_0x5b873d['qzoneSettings'][_0x71de56(0x22a)]?'用户':_0x5b873d['qzoneSettings'][_0x71de56(0x22a)],_0x3407ae=_0xf75b0d[_0x71de56(0xc18)]&&_0xf75b0d['longTermMemory'][_0x71de56(0x7aa)]>0x0?_0xf75b0d[_0x71de56(0xc18)][_0x71de56(0x412)](_0x52d0b8=>_0x71de56(0x768)+_0x4ce38e(_0x52d0b8[_0x71de56(0x114e)])+')\x20'+_0x52d0b8[_0x71de56(0x28c)])[_0x71de56(0x1237)]('\x0a'):'无',_0x463c88=_0xf75b0d['settings'][_0x71de56(0x46f)]||0xa,_0x482e82=_0xf75b0d['history']['slice'](-_0x463c88)[_0x71de56(0x412)](_0xd55738=>(_0xd55738['role']===_0x71de56(0x116c)?_0x5dc046:_0xf75b0d[_0x71de56(0xf74)])+':\x20'+String(_0xd55738['content'])[_0x71de56(0x489)](0x0,0x1e)+_0x71de56(0x1046))[_0x71de56(0x1237)]('\x0a'),_0x4d5787=(_0xf75b0d['settings'][_0x71de56(0x32d)]||[])[_0x71de56(0x412)](_0x105bd9=>_0x5b873d['worldBooks'][_0x71de56(0x12f4)](_0x3d8a5a=>_0x3d8a5a['id']===_0x105bd9))[_0x71de56(0x3d8)](Boolean)[_0x71de56(0x412)](_0x52a6ab=>'\x0a##\x20世界书《'+_0x52a6ab['name']+_0x71de56(0x241)+_0x52a6ab['content'][_0x71de56(0x3d8)](_0xbd863b=>_0xbd863b[_0x71de56(0x104e)])['map'](_0x25376c=>'-\x20'+_0x25376c[_0x71de56(0x28c)])[_0x71de56(0x1237)]('\x0a'))[_0x71de56(0x1237)](''),_0x36446c=_0x247dd3(_0xf75b0d,0x3,'hours'),_0x1bf654=_0x247dd3(_0xf75b0d,0x6,_0x71de56(0x5be)),_0x2a6cce=_0x247dd3(_0xf75b0d,0x9,'hours'),_0x4f8231=_0x247dd3(_0xf75b0d,0x1,_0x71de56(0xccc)),_0x1608fe=_0x247dd3(_0xf75b0d,0x3,'days'),_0x2a2155=_0x247dd3(_0xf75b0d,0x7,_0x71de56(0xccc));let _0x590c8f='';if(_0x36446c||_0x1bf654||_0x2a6cce||_0x4f8231||_0x1608fe||_0x2a2155){_0x590c8f+=_0x71de56(0x10cc);if(_0x36446c)_0x590c8f+=_0x36446c;if(_0x1bf654)_0x590c8f+=_0x1bf654;if(_0x2a6cce)_0x590c8f+=_0x2a6cce;if(_0x36446c||_0x1bf654||_0x2a6cce)_0x590c8f+='\x0a';if(_0x4f8231)_0x590c8f+=_0x4f8231;if(_0x1608fe)_0x590c8f+=_0x1608fe;if(_0x2a2155)_0x590c8f+=_0x2a2155;}const _0x5927a0='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0xf75b0d['name']+_0x71de56(0x8af)+_0xf75b0d[_0x71de56(0xdb9)][_0x71de56(0x1269)]+_0x71de56(0x3f9)+_0x3407ae+'\x0a'+_0x4d5787+'\x0a'+_0x590c8f+'\x0a-\x20**你最近和“'+_0x5dc046+_0x71de56(0xcb4)+_0x482e82+_0x71de56(0xf59);try{const _0x4ab6c9=[{'role':_0x71de56(0x116c),'content':_0x71de56(0x1069)}];let _0x4f7448=_0x5894d6[_0x71de56(0xced)]('generativelanguage'),_0x3361ab=_0xa615f4(_0x198f30,_0x2004d1,_0x5927a0,_0x4ab6c9);const _0x3c3137=_0x4f7448?await fetch(_0x3361ab[_0x71de56(0x11de)],_0x3361ab[_0x71de56(0xd98)]):await fetch(_0x5894d6+'/v1/chat/completions',{'method':_0x71de56(0xd14),'headers':{'Content-Type':_0x71de56(0xce4),'Authorization':_0x71de56(0x3fb)+_0x2004d1},'body':JSON['stringify']({'model':_0x198f30,'messages':[{'role':_0x71de56(0x18c),'content':_0x5927a0},..._0x4ab6c9],'temperature':_0x5b873d[_0x71de56(0x21a)][_0x71de56(0x576)]||0.9})});if(!_0x3c3137['ok'])throw new Error(_0x71de56(0x10d8)+_0x3c3137[_0x71de56(0x517)]);const _0xfc4c59=await _0x3c3137['json'](),_0x303fd8=getGeminiResponseText(_0xfc4c59),_0x501ee4=_0x303fd8[_0x71de56(0xfbf)](/^```json\s*/,'')[_0x71de56(0xfbf)](/```$/,''),_0x158228=JSON[_0x71de56(0x2cb)](_0x501ee4);_0xf75b0d[_0x71de56(0x1274)]=_0x158228,await _0x1a6951[_0x71de56(0x667)][_0x71de56(0xc0f)](_0xf75b0d),await _0x482765();}catch(_0x183d18){console[_0x71de56(0x1fd)]('生成模拟App使用记录失败:',_0x183d18),await _0x532f76(_0x71de56(0x1020),_0x71de56(0xa63)+_0x183d18[_0x71de56(0x1288)]);}}function _0x482765(){const _0x367e3c=_0x41eae2,_0xedc775=document[_0x367e3c(0x89d)](_0x367e3c(0xb8e));_0xedc775[_0x367e3c(0x1ef)]='';if(!_0x521c79)return;const _0x48b238=_0x5b873d[_0x367e3c(0x667)][_0x521c79],_0x1eed4e=(_0x48b238[_0x367e3c(0x1274)]||[])[_0x367e3c(0x2e3)]((_0x15d816,_0x5e9256)=>_0x5e9256[_0x367e3c(0xeb0)]-_0x15d816[_0x367e3c(0xeb0)]);if(_0x1eed4e[_0x367e3c(0x7aa)]===0x0){_0xedc775[_0x367e3c(0x1ef)]=_0x367e3c(0xa58);return;}_0x1eed4e[_0x367e3c(0xd9a)](_0x279e38=>{const _0xcb8b14=_0x367e3c,_0x2798fa=document[_0xcb8b14(0x285)]('div');_0x2798fa[_0xcb8b14(0x81c)]=_0xcb8b14(0x754);const _0x3285eb=Math[_0xcb8b14(0x128a)](_0x279e38['usageTimeMinutes']/0x3c),_0x2af5ea=_0x279e38[_0xcb8b14(0xeb0)]%0x3c;let _0x347a3a='';if(_0x3285eb>0x0)_0x347a3a+=_0x3285eb+'小时';if(_0x2af5ea>0x0)_0x347a3a+=_0x2af5ea+'分钟';if(!_0x347a3a)_0x347a3a='小于1分钟';const _0x34a54b=_0x279e38[_0xcb8b14(0x895)]||'modern\x20app\x20icon\x20for\x20'+_0x279e38[_0xcb8b14(0xdd9)]+',\x20flat\x20design,\x20simple',_0xe2f3f6=_0xcb8b14(0x1017)+encodeURIComponent(_0x34a54b);_0x2798fa[_0xcb8b14(0x1ef)]=_0xcb8b14(0x10e6)+_0xe2f3f6+'\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>'+_0x279e38[_0xcb8b14(0xdd9)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>'+_0x279e38['category']+_0xcb8b14(0x715)+_0x347a3a+_0xcb8b14(0xb75),_0xedc775[_0xcb8b14(0x22f)](_0x2798fa);});}async function _0x30b2ae(){const _0x1f83fd=_0x41eae2;if(!_0x521c79)return;const _0x3088a1=_0x5b873d[_0x1f83fd(0x667)][_0x521c79];if(!_0x3088a1)return;await _0x532f76('请稍候...',_0x1f83fd(0xb98)+_0x3088a1[_0x1f83fd(0xf74)]+_0x1f83fd(0x808));const {proxyUrl:_0x2eeea5,apiKey:_0xb1fc4a,model:_0x1fbe4e}=_0x5b873d[_0x1f83fd(0x30d)];if(!_0x2eeea5||!_0xb1fc4a||!_0x1fbe4e){alert(_0x1f83fd(0xebf));return;}const _0x2405f7=_0x5b873d[_0x1f83fd(0x5c1)][_0x1f83fd(0x22a)]===_0x1f83fd(0x1285)||!_0x5b873d[_0x1f83fd(0x5c1)]['nickname']?'用户':_0x5b873d[_0x1f83fd(0x5c1)][_0x1f83fd(0x22a)],_0x5ed08b=_0x3088a1[_0x1f83fd(0xc18)]&&_0x3088a1[_0x1f83fd(0xc18)][_0x1f83fd(0x7aa)]>0x0?_0x3088a1[_0x1f83fd(0xc18)]['map'](_0x2fbbfe=>_0x1f83fd(0x768)+_0x4ce38e(_0x2fbbfe[_0x1f83fd(0x114e)])+')\x20'+_0x2fbbfe[_0x1f83fd(0x28c)])[_0x1f83fd(0x1237)]('\x0a'):'无',_0x2afa38=_0x3088a1[_0x1f83fd(0xdb9)][_0x1f83fd(0x46f)]||0xa,_0x3afdb0=_0x3088a1[_0x1f83fd(0x551)][_0x1f83fd(0xdd0)](-_0x2afa38)[_0x1f83fd(0x412)](_0x5a8921=>(_0x5a8921[_0x1f83fd(0xa57)]===_0x1f83fd(0x116c)?_0x2405f7:_0x3088a1[_0x1f83fd(0xf74)])+':\x20'+String(_0x5a8921[_0x1f83fd(0x28c)])[_0x1f83fd(0x489)](0x0,0x1e)+'...')[_0x1f83fd(0x1237)]('\x0a'),_0xe7150a=(_0x3088a1[_0x1f83fd(0xdb9)]['linkedWorldBookIds']||[])[_0x1f83fd(0x412)](_0x2a6a12=>_0x5b873d[_0x1f83fd(0x8a1)][_0x1f83fd(0x12f4)](_0x34fdca=>_0x34fdca['id']===_0x2a6a12))[_0x1f83fd(0x3d8)](Boolean)[_0x1f83fd(0x412)](_0x58f213=>_0x1f83fd(0xf50)+_0x58f213[_0x1f83fd(0xf74)]+'》设定:\x0a'+_0x58f213[_0x1f83fd(0x28c)][_0x1f83fd(0x3d8)](_0xae7eed=>_0xae7eed[_0x1f83fd(0x104e)])[_0x1f83fd(0x412)](_0x2ee736=>'-\x20'+_0x2ee736[_0x1f83fd(0x28c)])['join']('\x0a'))[_0x1f83fd(0x1237)](''),_0x58bf26=_0x1f83fd(0x460)+_0x3088a1[_0x1f83fd(0xf74)]+_0x1f83fd(0xaba)+_0x3088a1[_0x1f83fd(0xdb9)]['aiPersona']+_0x1f83fd(0x3f9)+_0x5ed08b+'\x0a'+_0xe7150a+_0x1f83fd(0xdac)+_0x2405f7+_0x1f83fd(0xcb4)+_0x3afdb0+_0x1f83fd(0x2e0);try{const _0x333100=[{'role':_0x1f83fd(0x116c),'content':_0x1f83fd(0xc01)}];let _0x4c43c6=_0x2eeea5['includes'](_0x1f83fd(0x6a6)),_0x1cd361=_0xa615f4(_0x1fbe4e,_0xb1fc4a,_0x58bf26,_0x333100);const _0x30a1bb=_0x4c43c6?await fetch(_0x1cd361[_0x1f83fd(0x11de)],_0x1cd361[_0x1f83fd(0xd98)]):await fetch(_0x2eeea5+_0x1f83fd(0x6dd),{'method':_0x1f83fd(0xd14),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0xb1fc4a},'body':JSON[_0x1f83fd(0x465)]({'model':_0x1fbe4e,'messages':[{'role':_0x1f83fd(0x18c),'content':_0x58bf26},..._0x333100],'temperature':_0x5b873d[_0x1f83fd(0x21a)]['apiTemperature']||0x1})});if(!_0x30a1bb['ok'])throw new Error('API\x20错误:\x20'+_0x30a1bb['statusText']);const _0x2d40a3=await _0x30a1bb[_0x1f83fd(0x6b5)](),_0x2737fe=getGeminiResponseText(_0x2d40a3),_0x4b61a5=_0x2737fe[_0x1f83fd(0xfbf)](/^```json\s*/,'')['replace'](/```$/,''),_0x4489cd=JSON[_0x1f83fd(0x2cb)](_0x4b61a5);await _0x532f76(_0x1f83fd(0xb6a),'歌单已生成，正在从网络获取\x20'+_0x4489cd[_0x1f83fd(0x7aa)]+_0x1f83fd(0x1044));const _0x1937b7=_0x4489cd['map'](async _0x55f37c=>{const _0x172bfd=_0x1f83fd;let _0x1c4ee9=await _0x5f9806(_0x55f37c[_0x172bfd(0x124e)],_0x55f37c['artistName']);(!_0x1c4ee9||_0x1c4ee9[_0x172bfd(0x7aa)]===0x0)&&(_0x1c4ee9=await _0x2d7764(_0x55f37c[_0x172bfd(0x124e)]));if(_0x1c4ee9[_0x172bfd(0x7aa)]>0x0)return _0x35a340(_0x1c4ee9[0x0]);return console['warn'](_0x172bfd(0x8c2)+_0x55f37c[_0x172bfd(0x124e)]+'\x20-\x20'+_0x55f37c[_0x172bfd(0x334)]+'”'),null;}),_0x54d423=(await Promise[_0x1f83fd(0x863)](_0x1937b7))['filter'](Boolean);_0x3088a1['simulatedMusicPlaylist']=_0x54d423,await _0x1a6951[_0x1f83fd(0x667)][_0x1f83fd(0xc0f)](_0x3088a1),await _0x543fd0();}catch(_0x799648){console[_0x1f83fd(0x1fd)](_0x1f83fd(0x750),_0x799648),await _0x532f76('生成失败',_0x1f83fd(0x127a)+_0x799648[_0x1f83fd(0x1288)]);}}function _0x543fd0(){const _0x4f0659=_0x41eae2,_0x2cc1b5=document[_0x4f0659(0x89d)]('char-music-list');_0x2cc1b5[_0x4f0659(0x1ef)]='';if(!_0x521c79)return;const _0x5da715=_0x5b873d[_0x4f0659(0x667)][_0x521c79],_0x65ae45=_0x5da715['simulatedMusicPlaylist']||[];if(_0x65ae45[_0x4f0659(0x7aa)]===0x0){_0x2cc1b5['innerHTML']=_0x4f0659(0x653);return;}_0x65ae45[_0x4f0659(0xd9a)]((_0x20a756,_0x3bfc7a)=>{const _0x35eebe=_0x4f0659,_0x41f409=document[_0x35eebe(0x285)](_0x35eebe(0xb25));_0x41f409[_0x35eebe(0x81c)]=_0x35eebe(0x6df),_0x41f409[_0x35eebe(0x1ef)]=_0x35eebe(0x8dd)+_0x20a756[_0x35eebe(0x81f)]+_0x35eebe(0x54a)+_0x20a756[_0x35eebe(0xf74)]+_0x35eebe(0x3bb)+_0x20a756[_0x35eebe(0x1196)]+_0x35eebe(0x7fb),_0x41f409[_0x35eebe(0x1193)](_0x35eebe(0x12a5),()=>_0x41dcea(_0x20a756)),_0x2cc1b5['appendChild'](_0x41f409);});}let _0x676769={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':_0x41eae2(0x7ed),'lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0x41dcea(_0x329f0d){const _0x3a5c9a=_0x41eae2,_0x27e548=document[_0x3a5c9a(0x89d)]('char-audio-player'),_0xc8b414=document[_0x3a5c9a(0x89d)](_0x3a5c9a(0x711));if(_0x676769[_0x3a5c9a(0x12fb)])clearInterval(_0x676769['lrcUpdateInterval']);_0x27e548[_0x3a5c9a(0xfb2)]();const _0x2c87e2=_0x676769[_0x3a5c9a(0xca7)][_0x3a5c9a(0x9d7)](_0x1e2902=>_0x1e2902['src']===_0x329f0d[_0x3a5c9a(0x9e3)]);_0x2c87e2>-0x1?_0x676769[_0x3a5c9a(0x602)]=_0x2c87e2:(_0x676769[_0x3a5c9a(0xca7)]=[_0x329f0d],_0x676769['currentIndex']=0x0);document['getElementById'](_0x3a5c9a(0x11ea))['textContent']=_0x329f0d['name'],document['getElementById'](_0x3a5c9a(0x657))[_0x3a5c9a(0xf12)]=_0x329f0d[_0x3a5c9a(0x1196)],document['getElementById'](_0x3a5c9a(0x12c9))['src']=_0x329f0d[_0x3a5c9a(0x81f)],_0x676769['parsedLyrics']=_0x39f66b(_0x329f0d[_0x3a5c9a(0xd42)]||''),_0x970ae9();if(_0x329f0d[_0x3a5c9a(0x2ab)]){const _0x2e6f84=new Blob([_0x329f0d[_0x3a5c9a(0x9e3)]],{'type':_0x329f0d['fileType']||_0x3a5c9a(0x8a4)});_0x27e548[_0x3a5c9a(0x9e3)]=URL[_0x3a5c9a(0xfc3)](_0x2e6f84);}else _0x27e548[_0x3a5c9a(0x9e3)]=_0x329f0d[_0x3a5c9a(0x9e3)];_0x27e548['play']()['catch'](_0x2f2dbe=>console[_0x3a5c9a(0x1fd)](_0x3a5c9a(0x1286),_0x2f2dbe)),_0x27e548[_0x3a5c9a(0x3c5)]=()=>{const _0x426f48=_0x3a5c9a;document[_0x426f48(0x89d)]('char-music-total-time')[_0x426f48(0xf12)]=_0x1c2ac5(_0x27e548['duration']),_0x676769['lrcUpdateInterval']=setInterval(_0x14130c,0x1f4);},_0xc8b414[_0x3a5c9a(0x2f1)]['add'](_0x3a5c9a(0x11e4));}function _0x25ec1a(){const _0x3daa35=_0x41eae2,_0xf0c772=document[_0x3daa35(0x89d)](_0x3daa35(0x711)),_0x16fe25=document[_0x3daa35(0x89d)](_0x3daa35(0x7cc));if(_0x676769[_0x3daa35(0x12fb)])clearInterval(_0x676769['lrcUpdateInterval']);_0x16fe25['pause'](),_0x16fe25[_0x3daa35(0x9e3)]='',_0xf0c772[_0x3daa35(0x2f1)][_0x3daa35(0x1247)](_0x3daa35(0x11e4)),_0x676769[_0x3daa35(0xaa4)]=![],document[_0x3daa35(0x89d)](_0x3daa35(0x3e8))[_0x3daa35(0x2f1)][_0x3daa35(0x1247)](_0x3daa35(0x4fd));}function _0x14130c(){const _0x523c12=_0x41eae2,_0x32e474=document[_0x523c12(0x89d)](_0x523c12(0x7cc));if(!_0x32e474[_0x523c12(0x91c)])return;const _0x361bc4=_0x32e474[_0x523c12(0x133c)],_0x902ea8=_0x32e474['duration'];document['getElementById'](_0x523c12(0xde3))[_0x523c12(0x68e)][_0x523c12(0x42e)]=_0x361bc4/_0x902ea8*0x64+'%',document[_0x523c12(0x89d)](_0x523c12(0x82c))[_0x523c12(0xf12)]=_0x1c2ac5(_0x361bc4),_0x2c98da(_0x361bc4);}function _0x970ae9(){const _0x542fa1=_0x41eae2,_0x4463b9=document['getElementById'](_0x542fa1(0x525));_0x4463b9[_0x542fa1(0x1ef)]='',_0x676769[_0x542fa1(0x1241)]=-0x1;if(!_0x676769[_0x542fa1(0x10c2)]||_0x676769[_0x542fa1(0x10c2)][_0x542fa1(0x7aa)]===0x0){_0x4463b9[_0x542fa1(0x1ef)]=_0x542fa1(0x17b);return;}_0x676769[_0x542fa1(0x10c2)][_0x542fa1(0xd9a)]((_0x37ca69,_0x5f31f4)=>{const _0x57619c=_0x542fa1,_0x27e54b=document['createElement']('p');_0x27e54b[_0x57619c(0xf12)]=_0x37ca69[_0x57619c(0xec9)],_0x27e54b[_0x57619c(0xaaf)][_0x57619c(0xa9b)]=_0x5f31f4,_0x4463b9[_0x57619c(0x22f)](_0x27e54b);});}function _0x2c98da(_0x44f461){const _0x69c650=_0x41eae2,_0x412ab9=_0x676769[_0x69c650(0x10c2)];if(_0x412ab9[_0x69c650(0x7aa)]===0x0)return;let _0x507a12=-0x1;for(let _0x5cae82=0x0;_0x5cae82<_0x412ab9[_0x69c650(0x7aa)];_0x5cae82++){if(_0x44f461>=_0x412ab9[_0x5cae82][_0x69c650(0x3fc)])_0x507a12=_0x5cae82;else break;}if(_0x507a12===_0x676769[_0x69c650(0x1241)])return;_0x676769[_0x69c650(0x1241)]=_0x507a12;const _0x5b0bf6=document['getElementById'](_0x69c650(0x525)),_0x5a810c=_0x5b0bf6[_0x69c650(0x35f)]('p');_0x5a810c[_0x69c650(0xd9a)](_0x28337e=>_0x28337e[_0x69c650(0x2f1)][_0x69c650(0x1247)](_0x69c650(0x8ea)));if(_0x507a12>-0x1){const _0x31848e=_0x5b0bf6[_0x69c650(0xd16)](_0x69c650(0x6d5)+_0x507a12+'\x22]');if(_0x31848e){_0x31848e[_0x69c650(0x2f1)][_0x69c650(0x569)](_0x69c650(0x8ea));const _0x5242e7=_0x5b0bf6[_0x69c650(0x95a)]/0x2-_0x31848e['offsetTop']-_0x31848e[_0x69c650(0x121a)]/0x2;_0x5a810c[_0x69c650(0xd9a)](_0x3a45f2=>{const _0x40e240=_0x69c650;_0x3a45f2['style'][_0x40e240(0x9ab)]=_0x40e240(0xcec)+_0x5242e7+'px)';});}}}function _0x1f3c14(){const _0x1d9bbf=_0x41eae2;if(_0x676769[_0x1d9bbf(0xca7)][_0x1d9bbf(0x7aa)]===0x0)return;let _0x2d3818;switch(_0x676769[_0x1d9bbf(0x89c)]){case _0x1d9bbf(0xdc6):_0x2d3818=Math[_0x1d9bbf(0x128a)](Math['random']()*_0x676769[_0x1d9bbf(0xca7)]['length']);break;case _0x1d9bbf(0x42f):_0x41dcea(_0x676769[_0x1d9bbf(0xca7)][_0x676769[_0x1d9bbf(0x602)]]);return;case'order':default:_0x2d3818=(_0x676769[_0x1d9bbf(0x602)]+0x1)%_0x676769[_0x1d9bbf(0xca7)]['length'];break;}_0x41dcea(_0x676769[_0x1d9bbf(0xca7)][_0x2d3818]);}function _0x1b5219(){const _0xf067fe=_0x41eae2;if(_0x676769['currentPlaylist'][_0xf067fe(0x7aa)]===0x0)return;const _0x54e1e7=(_0x676769[_0xf067fe(0x602)]-0x1+_0x676769[_0xf067fe(0xca7)]['length'])%_0x676769[_0xf067fe(0xca7)][_0xf067fe(0x7aa)];_0x41dcea(_0x676769['currentPlaylist'][_0x54e1e7]);}function _0x10d3f0(){const _0x1cd3c9=_0x41eae2,_0x4b3ff7=[_0x1cd3c9(0x7ed),_0x1cd3c9(0xdc6),'single'],_0x1cb83b=_0x4b3ff7[_0x1cd3c9(0x37c)](_0x676769[_0x1cd3c9(0x89c)]);_0x676769[_0x1cd3c9(0x89c)]=_0x4b3ff7[(_0x1cb83b+0x1)%_0x4b3ff7['length']],document[_0x1cd3c9(0x89d)](_0x1cd3c9(0xb08))[_0x1cd3c9(0xf12)]={'order':'顺序','random':'随机','single':'单曲'}[_0x676769[_0x1cd3c9(0x89c)]];}function _0x3396d6(){const _0x6ea680=_0x41eae2,_0x4c4b2d=document[_0x6ea680(0x89d)](_0x6ea680(0x7cc)),_0x2fce28=document[_0x6ea680(0x89d)](_0x6ea680(0x262)),_0x1935b6=document[_0x6ea680(0x89d)](_0x6ea680(0x3e8));_0x2fce28[_0x6ea680(0x1193)](_0x6ea680(0x12a5),()=>{const _0x1d5302=_0x6ea680;if(_0x4c4b2d['paused']){if(_0x676769[_0x1d5302(0x602)]>-0x1)_0x4c4b2d[_0x1d5302(0x5ad)]();}else _0x4c4b2d[_0x1d5302(0xfb2)]();}),_0x4c4b2d[_0x6ea680(0xca5)]=()=>{const _0x5dfa28=_0x6ea680;_0x2fce28[_0x5dfa28(0x1ef)]='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>',_0x1935b6[_0x5dfa28(0x2f1)][_0x5dfa28(0x569)]('spinning'),_0x676769[_0x5dfa28(0xaa4)]=!![];},_0x4c4b2d['onpause']=()=>{const _0x2d9959=_0x6ea680;_0x2fce28['innerHTML']=_0x2d9959(0xd85),_0x1935b6['classList'][_0x2d9959(0x1247)](_0x2d9959(0x4fd)),_0x676769[_0x2d9959(0xaa4)]=![];},_0x4c4b2d['onended']=()=>{const _0x4ce551=_0x6ea680;_0x1935b6[_0x4ce551(0x2f1)][_0x4ce551(0x1247)]('spinning'),_0x676769[_0x4ce551(0xaa4)]=![],_0x1f3c14();},document['getElementById']('char-music-prev-btn')[_0x6ea680(0x1193)](_0x6ea680(0x12a5),_0x1b5219),document[_0x6ea680(0x89d)](_0x6ea680(0xf87))[_0x6ea680(0x1193)]('click',_0x1f3c14),document['getElementById']('char-music-mode-btn')[_0x6ea680(0x1193)]('click',_0x10d3f0),document[_0x6ea680(0x89d)](_0x6ea680(0x1133))[_0x6ea680(0x1193)](_0x6ea680(0x12a5),_0x5439c7=>{const _0x2fa670=_0x6ea680;if(!_0x4c4b2d[_0x2fa670(0x91c)])return;const _0x25b65a=_0x5439c7[_0x2fa670(0xc64)],_0x57fa17=_0x5439c7[_0x2fa670(0xa53)];_0x4c4b2d['currentTime']=_0x57fa17/_0x25b65a['clientWidth']*_0x4c4b2d[_0x2fa670(0x91c)];});}async function _0x2c6452(){const _0x252634=_0x41eae2,_0x3b021a=document[_0x252634(0x89d)](_0x252634(0xfd1));_0x3b021a[_0x252634(0x1ef)]='';const _0x46114a=await _0x1a6951[_0x252634(0xf52)][_0x252634(0x6ed)](_0x252634(0x114e))['reverse']()[_0x252634(0xc2f)]();if(_0x46114a[_0x252634(0x7aa)]===0x0){_0x3b021a['innerHTML']=_0x252634(0x60b);return;}_0x46114a[_0x252634(0xd9a)](_0x4a155e=>{const _0x422436=_0x252634;let _0x3cecb1;const _0x589fab=_0x4a155e['authorOriginalName']?Object[_0x422436(0x4b5)](_0x5b873d['chats'])[_0x422436(0x12f4)](_0x1e7d71=>!_0x1e7d71[_0x422436(0x58c)]&&_0x1e7d71['name']===_0x4a155e[_0x422436(0xf56)]):null;if(_0x589fab)_0x3cecb1=_0x589fab[_0x422436(0xdb9)]['aiAvatar'];else{const _0x59ff5f=Object[_0x422436(0x4b5)](_0x5b873d[_0x422436(0x667)])[_0x422436(0x12f4)](_0x10dddb=>!_0x10dddb['isGroup']&&_0x10dddb[_0x422436(0xf74)]===_0x4a155e[_0x422436(0xa59)]);if(_0x59ff5f)_0x3cecb1=_0x59ff5f[_0x422436(0xdb9)][_0x422436(0xdd3)];else _0x4a155e[_0x422436(0x423)]?_0x3cecb1=_0x422436(0x1017)+encodeURIComponent(_0x4a155e['authorAvatarPrompt']):_0x3cecb1=_0x265fcc;}const _0x5eb4b9=document[_0x422436(0x285)](_0x422436(0xb25));_0x5eb4b9[_0x422436(0x81c)]=_0x422436(0xf41),_0x5eb4b9[_0x422436(0x108b)]=()=>_0x19b539(_0x4a155e['id']),_0x5eb4b9[_0x422436(0x1ef)]=_0x422436(0xe8a)+_0x3cecb1+_0x422436(0x1334)+_0x4a155e[_0x422436(0xa59)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20'+_0x4a155e[_0x422436(0xb9a)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>'+_0x4a155e[_0x422436(0x2bf)]+_0x422436(0x1048)+_0x4a155e[_0x422436(0x28c)]['replace'](/\n/g,_0x422436(0x962))+_0x422436(0x6db)+_0x4a155e['likesCount']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20'+_0x4a155e[_0x422436(0x12ab)]+_0x422436(0xdcc)+_0x4ce38e(_0x4a155e[_0x422436(0x114e)])+_0x422436(0xa44),_0x3b021a[_0x422436(0x22f)](_0x5eb4b9);});}async function _0x147d3c(){const _0x452ecd=_0x41eae2,_0x25b9a2=_0x5b873d[_0x452ecd(0x21a)]['doubanActiveCharacterIds']||[];if(_0x25b9a2[_0x452ecd(0x7aa)]===0x0){await _0x532f76(_0x452ecd(0x360),'请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。');return;}await _0x532f76(_0x452ecd(0xb6a),_0x452ecd(0x97d)+_0x25b9a2[_0x452ecd(0x7aa)]+_0x452ecd(0x636));const {proxyUrl:_0x2ef061,apiKey:_0xff1586,model:_0x45cf29}=_0x5b873d[_0x452ecd(0x30d)];if(!_0x2ef061||!_0xff1586||!_0x45cf29){alert(_0x452ecd(0xebf));return;}const _0x5e35a6=new Set();_0x25b9a2[_0x452ecd(0xd9a)](_0x5c8460=>{const _0x25a79f=_0x452ecd,_0x29588c=_0x5b873d['chats'][_0x5c8460];_0x29588c&&_0x29588c[_0x25a79f(0xdb9)][_0x25a79f(0x32d)]&&_0x29588c[_0x25a79f(0xdb9)][_0x25a79f(0x32d)][_0x25a79f(0xd9a)](_0x579b74=>_0x5e35a6[_0x25a79f(0x569)](_0x579b74));});let _0x17c45b='';_0x5e35a6['size']>0x0&&(_0x17c45b+='\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a',_0x5e35a6[_0x452ecd(0xd9a)](_0x34498a=>{const _0x943ce=_0x452ecd,_0x5a6d65=_0x5b873d['worldBooks'][_0x943ce(0x12f4)](_0x4d7e74=>_0x4d7e74['id']===_0x34498a);if(_0x5a6d65){const _0x1d4aaa=_0x5a6d65[_0x943ce(0x28c)][_0x943ce(0x3d8)](_0x18901f=>_0x18901f[_0x943ce(0x104e)]!==![])[_0x943ce(0x412)](_0x4f3fd2=>'-\x20'+_0x4f3fd2['content'])['join']('\x0a');_0x1d4aaa&&(_0x17c45b+='\x0a##\x20来自《'+_0x5a6d65['name']+_0x943ce(0x498)+_0x1d4aaa);}}));const _0x46a9ee=_0x5b873d[_0x452ecd(0x8a1)][_0x452ecd(0x12f4)](_0x356f5d=>_0x356f5d[_0x452ecd(0xf74)]===_0x452ecd(0x1213));let _0x5c03d8='',_0x28a6be=[];_0x46a9ee&&_0x46a9ee[_0x452ecd(0x28c)][_0x452ecd(0xd9a)](_0x34128b=>{const _0x1cf086=_0x452ecd;_0x34128b['comment']['includes'](_0x1cf086(0x1f1))&&(_0x5c03d8+=_0x1cf086(0x95f)+_0x34128b[_0x1cf086(0x28c)]);if(_0x34128b[_0x1cf086(0x8f9)][_0x1cf086(0xced)](_0x1cf086(0xa67))){const _0x369f58=_0x34128b[_0x1cf086(0x28c)]['split']('\x0a');_0x369f58['forEach'](_0x17dc8b=>{const _0x23ce5e=_0x1cf086,_0xe9d9a6=_0x17dc8b[_0x23ce5e(0x86c)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0xe9d9a6&&_0x28a6be['push']({'name':_0xe9d9a6[0x1][_0x23ce5e(0xc3a)](),'persona':_0xe9d9a6[0x2]['trim']()});});}});const _0x138b03=_0x5b873d['qzoneSettings'][_0x452ecd(0x22a)]||'我',_0x48c558=_0x25b9a2['length']>0x0&&_0x5b873d[_0x452ecd(0x667)][_0x25b9a2[0x0]]?_0x5b873d[_0x452ecd(0x667)][_0x25b9a2[0x0]][_0x452ecd(0xdb9)]['myPersona']:_0x452ecd(0xb84);let _0x30d5e4='';_0x25b9a2[_0x452ecd(0xd9a)](_0x477138=>{const _0x31c5de=_0x452ecd,_0x524945=_0x5b873d[_0x31c5de(0x667)][_0x477138];if(_0x524945){const _0xf32486=_0x524945['longTermMemory']&&_0x524945[_0x31c5de(0xc18)][_0x31c5de(0x7aa)]>0x0?_0x524945['longTermMemory'][_0x31c5de(0x412)](_0x1f6542=>_0x1f6542[_0x31c5de(0x28c)])['join'](';\x20'):'无',_0xcbab4=_0x524945[_0x31c5de(0x551)][_0x31c5de(0xdd0)](-0xa)[_0x31c5de(0x412)](_0x17ae80=>(_0x17ae80[_0x31c5de(0xa57)]===_0x31c5de(0x116c)?_0x138b03:_0x524945[_0x31c5de(0xf74)])+':\x20'+String(_0x17ae80[_0x31c5de(0x28c)])[_0x31c5de(0x489)](0x0,0x1e)+_0x31c5de(0x1046))[_0x31c5de(0x1237)]('\x0a');_0x30d5e4+='\x0a<character>\x0a\x20\x20<name>'+_0x524945[_0x31c5de(0xf74)]+_0x31c5de(0x4dd)+_0x524945[_0x31c5de(0xdb9)][_0x31c5de(0x1269)]+'</persona>\x0a\x20\x20<memory>'+_0xf32486+_0x31c5de(0xb14)+_0xcbab4+'</recent_dialogue_with_user>\x0a</character>\x0a';}}),_0x28a6be[_0x452ecd(0xd9a)](_0x28b034=>{const _0x1f6041=_0x452ecd;_0x30d5e4+=_0x1f6041(0x327)+_0x28b034[_0x1f6041(0xf74)]+_0x1f6041(0x4dd)+_0x28b034['persona']+_0x1f6041(0x96b);});const _0x325e0a=new Date(),_0x46ecd9=_0x325e0a[_0x452ecd(0x425)](_0x452ecd(0x1e8),{'dateStyle':_0x452ecd(0x1219),'timeStyle':_0x452ecd(0x248)}),_0x42b68b=_0x5b873d[_0x452ecd(0x21a)][_0x452ecd(0x12fe)]||0xc,_0x263f02=_0x5b873d[_0x452ecd(0x21a)][_0x452ecd(0xf91)]||0x14,_0x178281=_0x452ecd(0x34d)+_0x42b68b+'到'+_0x263f02+_0x452ecd(0x84d)+_0x46ecd9+_0x452ecd(0x82f)+_0x138b03+_0x452ecd(0x710)+_0x138b03+_0x452ecd(0x2c1)+_0x5c03d8+'\x0a'+_0x17c45b+_0x452ecd(0xbbb)+_0x46ecd9+_0x452ecd(0xffd)+_0x138b03+_0x452ecd(0x4f3)+_0x48c558+_0x452ecd(0xaea)+_0x30d5e4+_0x452ecd(0x106b);try{const _0x114d13=[{'role':_0x452ecd(0x116c),'content':_0x452ecd(0xd7f)}];let _0x3a892f=_0x2ef061[_0x452ecd(0xced)](_0x452ecd(0x6a6)),_0x4aaeec=_0xa615f4(_0x45cf29,_0xff1586,_0x178281,_0x114d13);const _0x3c8514=_0x3a892f?await fetch(_0x4aaeec[_0x452ecd(0x11de)],_0x4aaeec[_0x452ecd(0xd98)]):await fetch(_0x2ef061+_0x452ecd(0x6dd),{'method':'POST','headers':{'Content-Type':_0x452ecd(0xce4),'Authorization':_0x452ecd(0x3fb)+_0xff1586},'body':JSON[_0x452ecd(0x465)]({'model':_0x45cf29,'messages':[{'role':_0x452ecd(0x18c),'content':_0x178281},..._0x114d13],'temperature':_0x5b873d[_0x452ecd(0x21a)][_0x452ecd(0x576)]||0x1})});if(!_0x3c8514['ok'])throw new Error(_0x452ecd(0x10d8)+_0x3c8514['statusText']);const _0x2d2c3f=await _0x3c8514[_0x452ecd(0x6b5)](),_0x230b09=getGeminiResponseText(_0x2d2c3f),_0x62bf55=_0x230b09['match'](/\[[\s\S]*\]/);if(!_0x62bf55)throw new Error(_0x452ecd(0x9a1)+_0x230b09);const _0x4930f1=JSON[_0x452ecd(0x2cb)](_0x62bf55[0x0]);await _0x1a6951[_0x452ecd(0xf52)][_0x452ecd(0x1073)](),await _0x1a6951[_0x452ecd(0xf52)][_0x452ecd(0xe94)](_0x4930f1[_0x452ecd(0x412)](_0x341fb9=>({..._0x341fb9,'timestamp':Date[_0x452ecd(0xf1a)]()-Math[_0x452ecd(0xdc6)]()*0x186a0}))),await _0x2c6452();}catch(_0xe779e7){console[_0x452ecd(0x1fd)]('生成豆瓣帖子失败:',_0xe779e7),await _0x532f76(_0x452ecd(0x1020),'无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20'+_0xe779e7[_0x452ecd(0x1288)]);}}async function _0x19b539(_0x17ded7){const _0x4ada74=_0x41eae2;_0x4e6c15('douban-post-detail-screen'),_0x2188b8=_0x17ded7;const _0x4c41ed=await _0x1a6951['doubanPosts'][_0x4ada74(0x650)](_0x17ded7);if(!_0x4c41ed){_0x4e6c15(_0x4ada74(0x111b));return;}document[_0x4ada74(0x89d)](_0x4ada74(0x10c3))[_0x4ada74(0xf12)]=_0x4ada74(0xcc2);let _0x52e4b2=_0x265fcc,_0x407570=_0x4c41ed[_0x4ada74(0xa59)];const _0x27d27a=_0x4c41ed['authorOriginalName']?Object['values'](_0x5b873d[_0x4ada74(0x667)])[_0x4ada74(0x12f4)](_0x593da3=>!_0x593da3['isGroup']&&_0x593da3[_0x4ada74(0x1045)]===_0x4c41ed[_0x4ada74(0xf56)]):null;if(_0x27d27a)_0x52e4b2=_0x27d27a[_0x4ada74(0xdb9)][_0x4ada74(0xdd3)];else{const _0x57cde9=Object[_0x4ada74(0x4b5)](_0x5b873d[_0x4ada74(0x667)])[_0x4ada74(0x12f4)](_0x4e9044=>!_0x4e9044['isGroup']&&_0x4e9044[_0x4ada74(0xf74)]===_0x4c41ed[_0x4ada74(0xa59)]);if(_0x57cde9)_0x52e4b2=_0x57cde9[_0x4ada74(0xdb9)][_0x4ada74(0xdd3)];else _0x4c41ed[_0x4ada74(0x423)]&&(_0x52e4b2=_0x4ada74(0x1017)+encodeURIComponent(_0x4c41ed[_0x4ada74(0x423)]));}document[_0x4ada74(0x89d)]('douban-detail-avatar')[_0x4ada74(0x9e3)]=_0x52e4b2,document[_0x4ada74(0x89d)](_0x4ada74(0x2ac))['textContent']=_0x407570,document['getElementById']('douban-detail-group')[_0x4ada74(0xf12)]='来自\x20'+_0x4c41ed[_0x4ada74(0xb9a)],document[_0x4ada74(0x89d)]('douban-detail-post-title')[_0x4ada74(0xf12)]=_0x4c41ed[_0x4ada74(0x2bf)],document[_0x4ada74(0x89d)]('douban-detail-content')[_0x4ada74(0x1ef)]=_0x4c41ed['content'][_0x4ada74(0xfbf)](/\n/g,_0x4ada74(0x962)),document[_0x4ada74(0x89d)](_0x4ada74(0x8e8))[_0x4ada74(0x9e3)]=_0x5b873d[_0x4ada74(0x5c1)][_0x4ada74(0x12c8)],document[_0x4ada74(0x89d)](_0x4ada74(0x10a4))[_0x4ada74(0x2f4)]='';const _0x51edd9=document[_0x4ada74(0x89d)](_0x4ada74(0x11fa));_0x51edd9[_0x4ada74(0x1ef)]='';if(_0x4c41ed['comments']&&_0x4c41ed[_0x4ada74(0x1157)][_0x4ada74(0x7aa)]>0x0){const _0x485513=new Map();_0x4c41ed[_0x4ada74(0x1157)][_0x4ada74(0xd9a)](_0xe037bb=>{const _0x58036b=_0x4ada74;let _0x40898e=_0x265fcc;const _0x1b8482=_0x5b873d[_0x58036b(0x5c1)]['nickname']||'我',_0x59eadd=_0xe037bb[_0x58036b(0x3df)];if(_0x485513[_0x58036b(0xa14)](_0x59eadd))_0x40898e=_0x485513[_0x58036b(0x650)](_0x59eadd);else{if(_0x59eadd===_0x1b8482)_0x40898e=_0x5b873d[_0x58036b(0x5c1)][_0x58036b(0x12c8)];else{if(_0x59eadd===_0x4c41ed[_0x58036b(0xa59)])_0x40898e=_0x52e4b2;else{const _0x4a9639=_0xe037bb['commenterOriginalName']?Object[_0x58036b(0x4b5)](_0x5b873d[_0x58036b(0x667)])[_0x58036b(0x12f4)](_0x28dfc2=>!_0x28dfc2['isGroup']&&_0x28dfc2[_0x58036b(0x1045)]===_0xe037bb['commenterOriginalName']):null;if(_0x4a9639)_0x40898e=_0x4a9639[_0x58036b(0xdb9)][_0x58036b(0xdd3)];else{const _0x50ac58=Object[_0x58036b(0x4b5)](_0x5b873d[_0x58036b(0x667)])['find'](_0x1e5f1c=>!_0x1e5f1c[_0x58036b(0x58c)]&&_0x1e5f1c[_0x58036b(0xf74)]===_0x59eadd);if(_0x50ac58)_0x40898e=_0x50ac58['settings'][_0x58036b(0xdd3)];else _0xe037bb['avatar_prompt']&&(_0x40898e=_0x58036b(0x1017)+encodeURIComponent(_0xe037bb['avatar_prompt']));}}}_0x485513[_0x58036b(0xd3f)](_0x59eadd,_0x40898e);}const _0x2d1462=document[_0x58036b(0x285)](_0x58036b(0xb25));_0x2d1462[_0x58036b(0x81c)]=_0x58036b(0x291),_0x2d1462[_0x58036b(0x1ef)]=_0x58036b(0x8ee)+_0x40898e+_0x58036b(0x742)+_0x59eadd+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>'+_0xe037bb[_0x58036b(0xec9)][_0x58036b(0xfbf)](/\n/g,_0x58036b(0x962))+_0x58036b(0x80c),_0x51edd9['appendChild'](_0x2d1462);});}else _0x51edd9[_0x4ada74(0x1ef)]='<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>';const _0x3a26e7=document[_0x4ada74(0x89d)]('douban-detail-content-wrapper');if(_0x3a26e7)_0x3a26e7[_0x4ada74(0xb0e)]=0x0;}async function _0x52619e(){const _0x4df53e=_0x41eae2;if(!_0x2188b8)return;const _0xe71358=document[_0x4df53e(0x89d)](_0x4df53e(0x10a4)),_0xfade22=_0xe71358[_0x4df53e(0x2f4)][_0x4df53e(0xc3a)]();if(!_0xfade22)return;const _0x4aa7cf=await _0x1a6951[_0x4df53e(0xf52)][_0x4df53e(0x650)](_0x2188b8);if(!_0x4aa7cf)return;!_0x4aa7cf['comments']&&(_0x4aa7cf[_0x4df53e(0x1157)]=[]);const _0x1cecd1=_0x5b873d[_0x4df53e(0x5c1)][_0x4df53e(0x22a)]||'我';_0x4aa7cf[_0x4df53e(0x1157)][_0x4df53e(0x138c)]({'commenter':_0x1cecd1,'text':_0xfade22}),_0x4aa7cf[_0x4df53e(0x12ab)]++,await _0x1a6951['doubanPosts'][_0x4df53e(0xc0f)](_0x4aa7cf),_0xe71358[_0x4df53e(0x2f4)]='',await _0x19b539(_0x2188b8);}async function _0x36b704(){const _0x27b948=_0x41eae2;if(!_0x2188b8)return;const _0x396b37=_0x2188b8,_0xe8b104=await _0x1a6951[_0x27b948(0xf52)]['get'](_0x396b37);if(!_0xe8b104)return;const _0x2cbea1=_0xe8b104[_0x27b948(0x1157)]&&_0xe8b104[_0x27b948(0x1157)][_0x27b948(0xdd0)](-0x1)[0x0];if(!_0x2cbea1){alert('还没有任何评论，无法等待回复。');return;}await _0x532f76(_0x27b948(0xb6a),'正在请求AI角色们加入讨论...');try{const {proxyUrl:_0x5138d0,apiKey:_0x56d605,model:_0x3b1260}=_0x5b873d[_0x27b948(0x30d)];if(!_0x5138d0||!_0x56d605||!_0x3b1260)throw new Error('API未配置，无法生成内容。');const _0x1ad56a=_0x5b873d[_0x27b948(0x5c1)][_0x27b948(0x22a)]||'我',_0x5e77c8=_0x5b873d['chats'][Object[_0x27b948(0xe9c)](_0x5b873d[_0x27b948(0x667)])[0x0]]?.[_0x27b948(0xdb9)][_0x27b948(0x6d4)]||_0x27b948(0xb84),_0x16b37b=new Map();_0xe8b104[_0x27b948(0x1157)]&&_0xe8b104[_0x27b948(0x1157)][_0x27b948(0xd9a)](_0x2c54d7=>{const _0x3e9234=_0x27b948,_0x260798=(_0x5b873d[_0x3e9234(0x21a)][_0x3e9234(0x5ce)]||[])['some'](_0x9e8d54=>_0x5b873d[_0x3e9234(0x667)][_0x9e8d54]?.[_0x3e9234(0xf74)]===_0x2c54d7[_0x3e9234(0x3df)]);!_0x260798&&_0x2c54d7[_0x3e9234(0x15d)]&&_0x16b37b[_0x3e9234(0xd3f)](_0x2c54d7['commenter'],_0x2c54d7['avatar_prompt']);});let _0x4625ca=_0x27b948(0x885);_0x16b37b[_0x27b948(0x746)]>0x0?(_0x4625ca+='如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a',_0x16b37b[_0x27b948(0xd9a)]((_0x3d777b,_0x43c348)=>{const _0x283014=_0x27b948;_0x4625ca+='-\x20**'+_0x43c348+_0x283014(0xdf5)+_0x3d777b+'\x22\x0a';})):_0x4625ca+='（当前帖子还没有路人NPC发表评论。）\x0a';const _0xbdfa6b=_0x5b873d[_0x27b948(0x8a1)]['find'](_0x3173aa=>_0x3173aa[_0x27b948(0xf74)]===_0x27b948(0x1213));let _0x25e60e=[];_0xbdfa6b&&_0xbdfa6b['content']['forEach'](_0x4186fc=>{const _0x1dab51=_0x27b948;if(_0x4186fc[_0x1dab51(0x8f9)][_0x1dab51(0xced)](_0x1dab51(0xa67))){const _0x15bc82=_0x4186fc[_0x1dab51(0x28c)][_0x1dab51(0x55b)]('\x0a');_0x15bc82['forEach'](_0x2fbbb6=>{const _0x1fafdd=_0x1dab51,_0x40fe22=_0x2fbbb6['match'](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x40fe22&&_0x25e60e[_0x1fafdd(0x138c)]({'name':_0x40fe22[0x1][_0x1fafdd(0xc3a)](),'persona':_0x40fe22[0x2][_0x1fafdd(0xc3a)]()});});}});let _0x2e6410='';const _0x28cd10=_0x5b873d[_0x27b948(0x21a)]['doubanActiveCharacterIds']||[];_0x28cd10[_0x27b948(0xd9a)](_0x3b055d=>{const _0x10bb87=_0x27b948,_0x417b84=_0x5b873d[_0x10bb87(0x667)][_0x3b055d];if(_0x417b84){const _0x1b1dee=_0x417b84['longTermMemory']&&_0x417b84[_0x10bb87(0xc18)][_0x10bb87(0x7aa)]>0x0?_0x417b84[_0x10bb87(0xc18)]['map'](_0x2964b3=>_0x2964b3['content'])[_0x10bb87(0x1237)](';\x20'):'无',_0x1af0a1=_0x417b84['history'][_0x10bb87(0xdd0)](-0xa)[_0x10bb87(0x412)](_0x476d82=>(_0x476d82[_0x10bb87(0xa57)]===_0x10bb87(0x116c)?_0x1ad56a:_0x417b84[_0x10bb87(0xf74)])+':\x20'+String(_0x476d82[_0x10bb87(0x28c)])[_0x10bb87(0x489)](0x0,0x1e)+_0x10bb87(0x1046))['join']('\x0a');_0x2e6410+=_0x10bb87(0x9b6)+_0x417b84[_0x10bb87(0xf74)]+':\x20'+_0x417b84[_0x10bb87(0xdb9)][_0x10bb87(0x1269)]['substring'](0x0,0x32)+'...\x20[记忆:\x20'+_0x1b1dee+_0x10bb87(0x991)+_0x1af0a1+']';}}),_0x25e60e[_0x27b948(0xd9a)](_0x4faf3b=>{const _0x1270c7=_0x27b948;_0x2e6410+=_0x1270c7(0x9b6)+_0x4faf3b[_0x1270c7(0xf74)]+':\x20'+_0x4faf3b[_0x1270c7(0x1170)];});const _0x1323e2=new Date(),_0x9a392b=_0x1323e2[_0x27b948(0x425)](_0x27b948(0x1e8),{'dateStyle':'full','timeStyle':_0x27b948(0x248)}),_0x31c14b=_0x27b948(0x72f)+_0x1ad56a+_0x27b948(0x1135)+_0x9a392b+_0x27b948(0xbdd)+_0x1ad56a+'”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“'+_0x1ad56a+_0x27b948(0x10e0)+_0xe8b104[_0x27b948(0x2bf)]+'》\x0a-\x20**发帖人**:\x20'+_0xe8b104['authorName']+_0x27b948(0xc8a)+_0xe8b104[_0x27b948(0x28c)][_0x27b948(0x489)](0x0,0x64)+_0x27b948(0xc8c)+_0xe8b104[_0x27b948(0x1157)][_0x27b948(0x412)](_0x4d09d9=>'-\x20'+_0x4d09d9['commenter']+':\x20'+_0x4d09d9[_0x27b948(0xec9)])[_0x27b948(0x1237)]('\x0a')+'\x0a\x0a'+_0x4625ca+_0x27b948(0xbbb)+_0x9a392b+'\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20'+_0x1ad56a+_0x27b948(0x4f3)+_0x5e77c8+_0x27b948(0x566)+_0x2e6410+_0x27b948(0xe3e),_0x1b2d49=[{'role':'user','content':_0x27b948(0x1242)}];let _0x114c83=_0x5138d0[_0x27b948(0xced)](_0x27b948(0x6a6)),_0x5cda21=_0xa615f4(_0x3b1260,_0x56d605,_0x31c14b,_0x1b2d49);const _0x53b2de=_0x114c83?await fetch(_0x5cda21['url'],_0x5cda21['data']):await fetch(_0x5138d0+_0x27b948(0x6dd),{'method':_0x27b948(0xd14),'headers':{'Content-Type':_0x27b948(0xce4),'Authorization':'Bearer\x20'+_0x56d605},'body':JSON[_0x27b948(0x465)]({'model':_0x3b1260,'messages':[{'role':_0x27b948(0x18c),'content':_0x31c14b},..._0x1b2d49],'temperature':_0x5b873d[_0x27b948(0x21a)][_0x27b948(0x576)]||0x1})});if(!_0x53b2de['ok'])throw new Error('API\x20错误:\x20'+_0x53b2de[_0x27b948(0x517)]);const _0x2af7d5=await _0x53b2de[_0x27b948(0x6b5)](),_0x6c6b=getGeminiResponseText(_0x2af7d5),_0x300bc1=_0x6c6b[_0x27b948(0xfbf)](/^```json\s*/,'')[_0x27b948(0xfbf)](/```$/,''),_0x53f9c2=JSON['parse'](_0x300bc1);Array['isArray'](_0x53f9c2)&&_0x53f9c2[_0x27b948(0x7aa)]>0x0&&(_0xe8b104[_0x27b948(0x1157)][_0x27b948(0x138c)](..._0x53f9c2),_0xe8b104[_0x27b948(0x12ab)]+=_0x53f9c2[_0x27b948(0x7aa)],await _0x1a6951[_0x27b948(0xf52)][_0x27b948(0xc0f)](_0xe8b104)),await _0x19b539(_0x396b37),_0x1ff3b5();}catch(_0x4b56eb){console[_0x27b948(0x1fd)](_0x27b948(0xbf2),_0x4b56eb),await _0x532f76(_0x27b948(0x10de),_0x27b948(0x12cb)+_0x4b56eb[_0x27b948(0x1288)]);}}async function _0x25307a(){const _0x329e79=_0x41eae2,_0x46bf21=document[_0x329e79(0x89d)](_0x329e79(0xe5e)),_0x4ee402=document['getElementById'](_0x329e79(0xe2f));_0x4ee402[_0x329e79(0x1ef)]='';const _0x5c1b12=Object['values'](_0x5b873d['chats'])[_0x329e79(0x3d8)](_0x2eddfa=>!_0x2eddfa[_0x329e79(0x58c)]),_0x5c4bff=new Set(_0x5b873d[_0x329e79(0x21a)][_0x329e79(0x5ce)]||[]);_0x5c1b12[_0x329e79(0x7aa)]===0x0?_0x4ee402[_0x329e79(0x1ef)]=_0x329e79(0x1376):_0x5c1b12['forEach'](_0xe5ce33=>{const _0x2ff157=_0x329e79,_0x2eae11=document[_0x2ff157(0x285)](_0x2ff157(0xb25));_0x2eae11['className']='contact-picker-item',_0x2eae11[_0x2ff157(0x1ef)]=_0x2ff157(0x1350)+_0xe5ce33['id']+'\x22\x20'+(_0x5c4bff[_0x2ff157(0xa14)](_0xe5ce33['id'])?_0x2ff157(0x1b0):'')+_0x2ff157(0x120b)+(_0xe5ce33[_0x2ff157(0xdb9)][_0x2ff157(0xdd3)]||_0x265fcc)+_0x2ff157(0x269)+_0xe5ce33['name']+_0x2ff157(0xa43),_0x4ee402[_0x2ff157(0x22f)](_0x2eae11);}),_0x46bf21[_0x329e79(0x2f1)][_0x329e79(0x569)](_0x329e79(0x11e4));}async function _0x37c762(){const _0x36d905=_0x41eae2,_0x11e4ad=document['querySelectorAll'](_0x36d905(0x18d)),_0x359bf1=Array[_0x36d905(0x321)](_0x11e4ad)[_0x36d905(0x412)](_0x2f2aa7=>_0x2f2aa7[_0x36d905(0xaaf)]['chatId']);_0x5b873d[_0x36d905(0x21a)][_0x36d905(0x5ce)]=_0x359bf1,await _0x1a6951[_0x36d905(0x21a)][_0x36d905(0xc0f)](_0x5b873d[_0x36d905(0x21a)]),document[_0x36d905(0x89d)](_0x36d905(0xe5e))[_0x36d905(0x2f1)]['remove'](_0x36d905(0x11e4)),await _0x147d3c();}document[_0x41eae2(0x89d)]('douban-cast-select-btn')[_0x41eae2(0x1193)](_0x41eae2(0x12a5),_0x25307a),document[_0x41eae2(0x89d)](_0x41eae2(0x3f3))[_0x41eae2(0x1193)](_0x41eae2(0x12a5),()=>{const _0x29e7ec=_0x41eae2;document[_0x29e7ec(0x89d)]('douban-cast-modal')[_0x29e7ec(0x2f1)][_0x29e7ec(0x1247)](_0x29e7ec(0x11e4));}),document[_0x41eae2(0x89d)](_0x41eae2(0x1a5))[_0x41eae2(0x1193)](_0x41eae2(0x12a5),_0x37c762),document[_0x41eae2(0x89d)](_0x41eae2(0xe2f))[_0x41eae2(0x1193)]('click',_0x4fef76=>{const _0x135766=_0x41eae2,_0x1ea48d=_0x4fef76[_0x135766(0x225)][_0x135766(0x53a)](_0x135766(0x1149));if(_0x1ea48d){const _0x4c3887=_0x1ea48d[_0x135766(0xd16)](_0x135766(0xddf));_0x4c3887&&_0x4fef76['target']!==_0x4c3887&&(_0x4c3887['checked']=!_0x4c3887[_0x135766(0x1b0)]);}});async function _0x2aba74(_0x226652){const _0x500567=_0x41eae2;if(!_0x226652)return;const _0x3a854c=await _0x4e2abc(_0x500567(0x72e),'这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？',{'confirmText':_0x500567(0x12a2)});if(!_0x3a854c)return;try{const _0x2d3f26=await _0x226652[_0x500567(0xec9)](),_0x2d1454=JSON[_0x500567(0x2cb)](_0x2d3f26);if(!_0x2d1454[_0x500567(0xd92)]&&!_0x2d1454[_0x500567(0x876)]&&!_0x2d1454[_0x500567(0x361)])throw new Error('文件格式不正确，缺少关键的外观设置项。');Object['assign'](_0x5b873d['globalSettings'],_0x2d1454),await _0x1a6951[_0x500567(0x21a)][_0x500567(0xc0f)](_0x5b873d[_0x500567(0x21a)]),_0x550834(),_0x35a5b0(),_0x337978(),_0x3a9268(),_0x446f71(_0x5b873d['globalSettings'][_0x500567(0x876)]),_0x3866c6(_0x5b873d[_0x500567(0x21a)][_0x500567(0x268)]),_0x203037(),_0x178a6e(),_0x245609(),await _0x532f76(_0x500567(0x1145),_0x500567(0x427));}catch(_0x445f17){console[_0x500567(0x1fd)](_0x500567(0x5ed),_0x445f17),await _0x532f76(_0x500567(0x53d),_0x500567(0xc51)+_0x445f17['message']);}}async function _0xe7764f(_0x4550d9){const _0x30f312=_0x41eae2;console['log']('检测到应用离线了\x20'+_0x4550d9['toFixed'](0x1)+_0x30f312(0xcac));const _0xb87cb2=Object[_0x30f312(0x4b5)](_0x5b873d[_0x30f312(0x667)])[_0x30f312(0x3d8)](_0x511005=>!_0x511005[_0x30f312(0x58c)]&&_0x511005['settings'][_0x30f312(0xa61)]&&_0x511005[_0x30f312(0x1383)]?.[_0x30f312(0x632)]===_0x30f312(0x123a));if(_0xb87cb2[_0x30f312(0x7aa)]===0x0){console[_0x30f312(0x471)](_0x30f312(0x1267));return;}for(const _0x553287 of _0xb87cb2){const _0xa8b1ff=_0x553287[_0x30f312(0xdb9)][_0x30f312(0xfd9)]||0xf,_0x296b88=_0x553287[_0x30f312(0x923)]?(Date[_0x30f312(0xf1a)]()-_0x553287[_0x30f312(0x923)])/(0x3e8*0x3c):Infinity;_0x4550d9>_0xa8b1ff&&_0x296b88>_0xa8b1ff&&(Math['random']()<0.3&&(console[_0x30f312(0x471)](_0x30f312(0x6b0)+_0x553287[_0x30f312(0xf74)]+'\x22\x20触发了后台行动！'),Math[_0x30f312(0xdc6)]()<0.7?await _0xd587f4(_0x553287['id']):console[_0x30f312(0x471)](_0x30f312(0x6b0)+_0x553287[_0x30f312(0xf74)]+_0x30f312(0x346))));}}function _0x496b64(){const _0x2ef57c=_0x41eae2;if(!_0x5b873d[_0x2ef57c(0xf96)])return;const _0x4ca1c9=_0x5b873d[_0x2ef57c(0x667)][_0x5b873d['activeChatId']];document[_0x2ef57c(0x89d)](_0x2ef57c(0xaad))[_0x2ef57c(0x2f4)]='',document[_0x2ef57c(0x89d)]('date-search-input')['value']='',document[_0x2ef57c(0x89d)]('chat-search-results-list')[_0x2ef57c(0x1ef)]=_0x2ef57c(0xbb0),_0x4e6c15(_0x2ef57c(0x476));}async function _0x3d06ef(){const _0x5b27=_0x41eae2,_0x27e61a=_0x5b873d[_0x5b27(0x667)][_0x5b873d[_0x5b27(0xf96)]];if(!_0x27e61a)return;const _0x474e86=document[_0x5b27(0x89d)](_0x5b27(0xaad))[_0x5b27(0x2f4)]['trim']()['toLowerCase'](),_0x377b23=document[_0x5b27(0x89d)](_0x5b27(0x7f6))[_0x5b27(0x2f4)];if(!_0x474e86&&!_0x377b23){alert('请输入关键词或选择一个日期。');return;}let _0x2a3f47=_0x27e61a[_0x5b27(0x551)][_0x5b27(0x3d8)](_0x5896f5=>!_0x5896f5[_0x5b27(0x9ae)]);_0x474e86&&(_0x2a3f47=_0x2a3f47[_0x5b27(0x3d8)](_0x44f2d4=>{const _0x1cc606=_0x5b27;let _0xc6fe7='';if(typeof _0x44f2d4[_0x1cc606(0x28c)]===_0x1cc606(0x1224))_0xc6fe7=_0x44f2d4['content'];else{if(_0x44f2d4[_0x1cc606(0x48c)]==='voice_message')_0xc6fe7=_0x44f2d4[_0x1cc606(0x28c)];else{if(_0x44f2d4['type']===_0x1cc606(0x656)||_0x44f2d4['type']==='user_photo')_0xc6fe7=_0x44f2d4[_0x1cc606(0x28c)];else{if(_0x44f2d4['type']===_0x1cc606(0x910))_0xc6fe7=(_0x44f2d4[_0x1cc606(0xa03)]||'')+'\x20'+(_0x44f2d4[_0x1cc606(0xf6e)]||'');else _0x44f2d4[_0x1cc606(0x1ff)]&&(_0xc6fe7=_0x44f2d4[_0x1cc606(0x28c)]);}}}return _0xc6fe7['toLowerCase']()[_0x1cc606(0xced)](_0x474e86);}));if(_0x377b23){const _0x4d3ef5=new Date(_0x377b23),_0x598f15=new Date(_0x4d3ef5[_0x5b27(0xfdb)](0x0,0x0,0x0,0x0))['getTime'](),_0x4beac3=new Date(_0x4d3ef5['setHours'](0x17,0x3b,0x3b,0x3e7))[_0x5b27(0xaa6)]();_0x2a3f47=_0x2a3f47[_0x5b27(0x3d8)](_0x1a1897=>_0x1a1897[_0x5b27(0x114e)]>=_0x598f15&&_0x1a1897[_0x5b27(0x114e)]<=_0x4beac3);}await _0xc60136(_0x2a3f47);}async function _0xc60136(_0x1ca90f){const _0x37f4b6=_0x41eae2,_0x40c9d4=document['getElementById'](_0x37f4b6(0x53c)),_0x168812=_0x5b873d[_0x37f4b6(0x667)][_0x5b873d[_0x37f4b6(0xf96)]];_0x40c9d4[_0x37f4b6(0x1ef)]='';if(_0x1ca90f[_0x37f4b6(0x7aa)]===0x0){_0x40c9d4[_0x37f4b6(0x1ef)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>';return;}let _0x2d24ba='';for(const _0x4b3c74 of _0x1ca90f){const _0x13edc4=new Date(_0x4b3c74['timestamp']),_0x5a6992=_0x13edc4[_0x37f4b6(0x1148)]();if(_0x5a6992!==_0x2d24ba){const _0x46f222=document[_0x37f4b6(0x285)]('div');_0x46f222[_0x37f4b6(0x81c)]='date-separator',_0x46f222[_0x37f4b6(0xf12)]='---\x20'+_0x13edc4[_0x37f4b6(0x555)]()+'年'+(_0x13edc4['getMonth']()+0x1)+'月'+_0x13edc4[_0x37f4b6(0x518)]()+_0x37f4b6(0xfcf),_0x40c9d4[_0x37f4b6(0x22f)](_0x46f222),_0x2d24ba=_0x5a6992;}const _0x2875bc=await _0x1ed144(_0x4b3c74,_0x168812);_0x2875bc&&(_0x2875bc[_0x37f4b6(0x68e)][_0x37f4b6(0x1049)]=_0x37f4b6(0x185),_0x2875bc[_0x37f4b6(0x1193)](_0x37f4b6(0x12a5),()=>_0x31f3f2(_0x4b3c74[_0x37f4b6(0x114e)])),_0x40c9d4['appendChild'](_0x2875bc));}}async function _0x31f3f2(_0x500c78){const _0x3d35de=_0x41eae2,_0x573f2b=_0x5b873d[_0x3d35de(0xf96)];if(!_0x573f2b)return;_0x4e6c15(_0x3d35de(0x87f)),setTimeout(async()=>{const _0x2c9397=_0x3d35de,_0x51bdbb=document[_0x2c9397(0x89d)](_0x2c9397(0x116e)),_0x3e3598='.message-bubble[data-timestamp=\x22'+_0x500c78+'\x22]';let _0x331a18=_0x51bdbb[_0x2c9397(0xd16)](_0x3e3598),_0x384f33=0x0;const _0x1364fa=0x14;while(!_0x331a18&&_0x384f33<_0x1364fa){const _0x212d21=document[_0x2c9397(0x89d)](_0x2c9397(0x1108));if(_0x212d21)console[_0x2c9397(0x471)](_0x2c9397(0x41b)+(_0x384f33+0x1)+')'),await _0x474038(),_0x331a18=_0x51bdbb['querySelector'](_0x3e3598),_0x384f33++;else break;}_0x52933b(_0x500c78);},0xc8);}async function _0x3cc400(){const _0x572184=_0x41eae2;document['getElementById'](_0x572184(0xaad))[_0x572184(0x2f4)]='',document[_0x572184(0x89d)](_0x572184(0x7f6))[_0x572184(0x2f4)]='',await _0xc60136(_0x5b873d[_0x572184(0x667)][_0x5b873d['activeChatId']][_0x572184(0x551)][_0x572184(0x3d8)](_0x2d422b=>!_0x2d422b['isHidden']));}async function _0x491371(_0x2aec5b=![],_0xaa75a0=null,_0x41fff6=null){const _0x299576=_0x41eae2,_0xf3332=document[_0x299576(0x89d)]('ai-frame-grid'),_0x4bebe2=document[_0x299576(0x89d)](_0x299576(0xde6)),_0x10013c=_0x5b873d[_0x299576(0x667)][_0x5b873d[_0x299576(0xf96)]];_0xf3332[_0x299576(0x1ef)]='',_0x4bebe2['innerHTML']='';const _0x411f35=await _0x1a6951[_0x299576(0x1343)][_0x299576(0xc2f)](),_0x502878=[..._0x88819,..._0x411f35];document['querySelector'](_0x299576(0x1211))[_0x299576(0x68e)][_0x299576(0x126b)]=_0x2aec5b?_0x299576(0x10f2):'flex',document[_0x299576(0x89d)](_0x299576(0x839))['style'][_0x299576(0x126b)]=_0x299576(0x1118),document['getElementById'](_0x299576(0xa4b))['style'][_0x299576(0x126b)]=_0x299576(0x10f2),document[_0x299576(0x89d)](_0x299576(0x137f))[_0x299576(0x2f1)]['add'](_0x299576(0x8ea)),document[_0x299576(0x89d)]('my-frame-tab')[_0x299576(0x2f1)]['remove'](_0x299576(0x8ea));if(_0x2aec5b)_0x502878[_0x299576(0xd9a)](_0x5b70f4=>{const _0x592de8=_0x299576,_0x20473e=_0x5b4a94(_0x5b70f4,'my',_0xaa75a0);_0x5b70f4[_0x592de8(0x11de)]===_0x41fff6&&_0x20473e[_0x592de8(0x2f1)]['add']('selected'),_0xf3332[_0x592de8(0x22f)](_0x20473e);});else{const _0x1834b5=_0x10013c[_0x299576(0xdb9)][_0x299576(0xdd3)]||_0x265fcc,_0x420ad5=_0x10013c[_0x299576(0xdb9)]['myAvatar']||(_0x10013c[_0x299576(0x58c)]?_0x24462f:_0x265fcc);_0x502878[_0x299576(0xd9a)](_0x4e40eb=>{const _0x2636a3=_0x299576,_0x240ed6=_0x5b4a94(_0x4e40eb,'ai',_0x1834b5);if(_0x4e40eb[_0x2636a3(0x11de)]===_0x392e3f['ai'])_0x240ed6[_0x2636a3(0x2f1)][_0x2636a3(0x569)]('selected');_0xf3332[_0x2636a3(0x22f)](_0x240ed6);const _0x143efe=_0x5b4a94(_0x4e40eb,'my',_0x420ad5);if(_0x4e40eb['url']===_0x392e3f['my'])_0x143efe[_0x2636a3(0x2f1)]['add'](_0x2636a3(0x335));_0x4bebe2[_0x2636a3(0x22f)](_0x143efe);});}}function _0x5b4a94(_0x1ca2bd,_0x216b69,_0x2fd379){const _0x597adc=_0x41eae2,_0xa53046=document[_0x597adc(0x285)](_0x597adc(0xb25));_0xa53046['className']=_0x597adc(0x3a3),_0xa53046[_0x597adc(0xaaf)][_0x597adc(0x1162)]=_0x1ca2bd[_0x597adc(0x11de)],_0xa53046['title']=_0x1ca2bd[_0x597adc(0xf74)];const _0x3fc69d=typeof _0x1ca2bd['id']===_0x597adc(0xa1a),_0x20c8e9=_0x3fc69d?_0x597adc(0x282)+_0x1ca2bd['id']+_0x597adc(0x1078):'';return _0xa53046[_0x597adc(0x1ef)]=_0x597adc(0x12e9)+_0x20c8e9+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x2fd379+'\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x1ca2bd[_0x597adc(0x11de)]?'<img\x20src=\x22'+_0x1ca2bd[_0x597adc(0x11de)]+'\x22\x20class=\x22preview-frame\x22>':'')+_0x597adc(0xc2c),_0xa53046[_0x597adc(0x1193)]('click',_0x4ad364=>{const _0x58cbd6=_0x597adc;if(_0x4ad364[_0x58cbd6(0x225)][_0x58cbd6(0x2f1)][_0x58cbd6(0x3ff)](_0x58cbd6(0x670)))return;if(_0x3c91a0){if(_0x3fc69d){const _0x1470d2=parseInt(_0x1ca2bd['id']);_0xa53046[_0x58cbd6(0x2f1)][_0x58cbd6(0x73b)](_0x58cbd6(0x335)),_0x12474b[_0x58cbd6(0xa14)](_0x1470d2)?_0x12474b['delete'](_0x1470d2):_0x12474b['add'](_0x1470d2),_0x4209e0();}}else{_0x392e3f[_0x216b69]=_0x1ca2bd['url'];const _0x7ba2d4=_0x216b69==='ai'?document[_0x58cbd6(0x89d)]('ai-frame-grid'):document[_0x58cbd6(0x89d)](_0x58cbd6(0xde6));_0x7ba2d4[_0x58cbd6(0x35f)]('.frame-item')[_0x58cbd6(0xd9a)](_0x308fb1=>_0x308fb1[_0x58cbd6(0x2f1)][_0x58cbd6(0x1247)](_0x58cbd6(0x335))),_0xa53046[_0x58cbd6(0x2f1)][_0x58cbd6(0x569)](_0x58cbd6(0x335));}}),_0xa53046;}async function _0x4a5441(){const _0x1a14f5=_0x41eae2,_0x2cbc3d=document[_0x1a14f5(0x89d)](_0x1a14f5(0xf22)),_0x296751=await new Promise(_0x2a32f9=>{const _0x512586=_0x1a14f5,_0x559034=_0x3ad90b=>{const _0x4a4a2d=_0x356e;_0x2a32f9(_0x3ad90b[_0x4a4a2d(0x225)][_0x4a4a2d(0x541)][0x0]||null),_0x2cbc3d[_0x4a4a2d(0xcbb)]('change',_0x559034);};_0x2cbc3d['addEventListener'](_0x512586(0x76c),_0x559034,{'once':!![]}),_0x2cbc3d[_0x512586(0x12a5)]();});if(!_0x296751)return;const _0x5045a5=await _0x34d246(_0x1a14f5(0x11a6),'请为这个新头像框起个名字');if(!_0x5045a5||!_0x5045a5[_0x1a14f5(0xc3a)]())return;const _0x323efb=await new Promise(_0x35892c=>{const _0x3463f2=_0x1a14f5,_0x3cbb59=new FileReader();_0x3cbb59[_0x3463f2(0x736)]=()=>_0x35892c(_0x3cbb59['result']),_0x3cbb59[_0x3463f2(0x5b4)](_0x296751);});await _0x1a6951[_0x1a14f5(0x1343)][_0x1a14f5(0x569)]({'name':_0x5045a5[_0x1a14f5(0xc3a)](),'url':_0x323efb}),_0x491371(_0x217004);}async function _0x3a9bee(){const _0x13b491=_0x41eae2,_0x303502=_0x13b491(0x20f),_0x4fed12=await _0x34d246(_0x13b491(0x8a3),_0x13b491(0xa13),'',_0x13b491(0x11b9),_0x13b491(0xe0c)+_0x303502+_0x13b491(0x164));if(!_0x4fed12||!_0x4fed12[_0x13b491(0xc3a)]())return;const _0xf1028a=_0x4fed12[_0x13b491(0xc3a)]()[_0x13b491(0x55b)]('\x0a'),_0xf23175=[];let _0xe5de15=0x0;for(const _0x4106ba of _0xf1028a){const _0x232af6=_0x4106ba['match'](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x232af6)_0xf23175[_0x13b491(0x138c)]({'name':_0x232af6[0x1][_0x13b491(0xc3a)](),'url':_0x232af6[0x2][_0x13b491(0xc3a)]()});else _0x4106ba[_0x13b491(0xc3a)]()&&_0xe5de15++;}_0xf23175[_0x13b491(0x7aa)]>0x0&&(await _0x1a6951[_0x13b491(0x1343)][_0x13b491(0xe94)](_0xf23175),_0x491371(_0x217004),await _0x532f76('导入成功',_0x13b491(0x9d3)+_0xf23175[_0x13b491(0x7aa)]+'\x20个新头像框！')),_0xe5de15>0x0&&await _0x532f76(_0x13b491(0x109c),'有\x20'+_0xe5de15+_0x13b491(0x103e));}async function _0xaa109d(_0x46f051){const _0x4874ed=_0x41eae2,_0x14af53=await _0x1a6951[_0x4874ed(0x1343)][_0x4874ed(0x650)](_0x46f051);if(!_0x14af53)return;const _0x3baba3=await _0x4e2abc(_0x4874ed(0x3da),_0x4874ed(0x264)+_0x14af53[_0x4874ed(0xf74)]+_0x4874ed(0x100e),{'confirmButtonClass':_0x4874ed(0xcd8)});_0x3baba3&&(await _0x1a6951['customAvatarFrames'][_0x4874ed(0x684)](_0x46f051),_0x491371(_0x217004));}let _0x788c66=0x0;const _0x1e39b4=0x2;function _0x13c70d(){const _0xa32c79=_0x41eae2,_0x8c8934=document[_0xa32c79(0x89d)](_0xa32c79(0x65e)),_0x49f667=document['getElementById'](_0xa32c79(0xee2)),_0x3e927f=document[_0xa32c79(0x35f)](_0xa32c79(0x9fb));let _0x57379e=0x0,_0xf2fff=0x0,_0x5eff5c=0x0,_0x54fd41=![],_0x66efc=!![];const _0x55e99e=()=>{const _0x4dd4e4=_0xa32c79;_0x49f667['style'][_0x4dd4e4(0x9ab)]=_0x4dd4e4(0x7b1)+_0x788c66*(0x64/_0x1e39b4)+'%)',_0x3e927f[_0x4dd4e4(0xd9a)]((_0x3d52cc,_0x37dbef)=>{const _0x45429a=_0x4dd4e4;_0x3d52cc[_0x45429a(0x2f1)][_0x45429a(0x73b)]('active',_0x37dbef===_0x788c66);});},_0x56171d=_0x252437=>{const _0x1a3177=_0xa32c79;_0x54fd41=!![],_0x66efc=!![],_0x57379e=_0x252437[_0x1a3177(0x48c)]['includes'](_0x1a3177(0x7d5))?_0x252437[_0x1a3177(0xe73)]:_0x252437['touches'][0x0][_0x1a3177(0xe73)],_0xf2fff=_0x252437[_0x1a3177(0x48c)][_0x1a3177(0xced)](_0x1a3177(0x7d5))?_0x252437[_0x1a3177(0x5b5)]:_0x252437[_0x1a3177(0xe9e)][0x0][_0x1a3177(0x5b5)],_0x49f667[_0x1a3177(0x68e)][_0x1a3177(0xde0)]=_0x1a3177(0x10f2);},_0x13f02d=_0x55753e=>{const _0x5d28ad=_0xa32c79;if(!_0x54fd41)return;const _0x30a9d4=_0x55753e[_0x5d28ad(0x48c)]['includes'](_0x5d28ad(0x7d5))?_0x55753e[_0x5d28ad(0x5b5)]:_0x55753e[_0x5d28ad(0xe9e)][0x0][_0x5d28ad(0x5b5)];_0x5eff5c=_0x55753e[_0x5d28ad(0x48c)][_0x5d28ad(0xced)](_0x5d28ad(0x7d5))?_0x55753e[_0x5d28ad(0xe73)]:_0x55753e['touches'][0x0]['pageX'];const _0x276301=_0x5eff5c-_0x57379e,_0x370448=_0x30a9d4-_0xf2fff;_0x66efc&&(Math[_0x5d28ad(0xe10)](_0x276301)>0xa||Math[_0x5d28ad(0xe10)](_0x370448)>0xa)&&(_0x66efc=![]);if(Math['abs'](_0x276301)>Math[_0x5d28ad(0xe10)](_0x370448)){if(_0x55753e[_0x5d28ad(0xb7c)])_0x55753e[_0x5d28ad(0xd06)]();_0x49f667[_0x5d28ad(0x68e)]['transform']=_0x5d28ad(0xb9e)+_0x788c66*(0x64/_0x1e39b4)+_0x5d28ad(0x32b)+_0x276301+'px))';}},_0x2c85ca=_0x36a917=>{const _0x534331=_0xa32c79;if(!_0x54fd41)return;_0x54fd41=![],_0x49f667['style']['transition']='transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)';if(_0x66efc){_0x55e99e();return;}const _0x4f551c=_0x5eff5c-_0x57379e;if(Math['abs'](_0x4f551c)>_0x8c8934[_0x534331(0xf13)]/0x4){if(_0x4f551c>0x0&&_0x788c66>0x0)_0x788c66--;else _0x4f551c<0x0&&_0x788c66<_0x1e39b4-0x1&&_0x788c66++;}_0x55e99e();};_0x8c8934[_0xa32c79(0x1193)](_0xa32c79(0x898),_0x56171d),_0x8c8934[_0xa32c79(0x1193)](_0xa32c79(0xf4d),_0x13f02d),_0x8c8934['addEventListener'](_0xa32c79(0x1dd),_0x2c85ca),_0x8c8934[_0xa32c79(0x1193)](_0xa32c79(0x3c3),_0x2c85ca),_0x8c8934['addEventListener'](_0xa32c79(0x74f),_0x56171d,{'passive':![]}),_0x8c8934[_0xa32c79(0x1193)](_0xa32c79(0xe3f),_0x13f02d,{'passive':![]}),_0x8c8934[_0xa32c79(0x1193)](_0xa32c79(0xc95),_0x2c85ca);}let _0xa98184=null;async function _0x530a32(){await _0x50d15c(),_0x4e6c15('preset-screen');}async function _0x50d15c(){const _0x1dddce=_0x41eae2,_0x4f953e=document['getElementById'](_0x1dddce(0xebc)),_0x292af6=document['getElementById'](_0x1dddce(0x937));_0x4f953e[_0x1dddce(0x1ef)]='',_0x292af6[_0x1dddce(0x1ef)]='';const [_0x4a94a0,_0x4d19dd]=await Promise[_0x1dddce(0x863)]([_0x1a6951[_0x1dddce(0x4da)][_0x1dddce(0xc2f)](),_0x1a6951[_0x1dddce(0xd10)][_0x1dddce(0x6ed)](_0x1dddce(0xf74))['toArray']()]);_0x5b873d[_0x1dddce(0x4da)]=_0x4a94a0;if(_0x4a94a0['length']===0x0){_0x292af6['innerHTML']=_0x1dddce(0x40b);return;}const _0x281472=document['createElement'](_0x1dddce(0x5af));_0x281472['className']=_0x1dddce(0xb4a),_0x281472['textContent']='全部',_0x281472[_0x1dddce(0xaaf)][_0x1dddce(0xcb1)]=_0x1dddce(0x863),_0x4f953e[_0x1dddce(0x22f)](_0x281472);const _0x490815=document[_0x1dddce(0x285)](_0x1dddce(0xb25));_0x490815['className']='world-book-category-pane\x20active',_0x490815[_0x1dddce(0xaaf)][_0x1dddce(0xcb1)]='all',_0x292af6[_0x1dddce(0x22f)](_0x490815),_0x4d19dd[_0x1dddce(0xd9a)](_0x14fe3d=>{const _0xa07869=_0x1dddce,_0x6ff2f5=document[_0xa07869(0x285)](_0xa07869(0x5af));_0x6ff2f5[_0xa07869(0x81c)]='world-book-tab',_0x6ff2f5[_0xa07869(0xf12)]=_0x14fe3d[_0xa07869(0xf74)],_0x6ff2f5[_0xa07869(0xaaf)][_0xa07869(0xcb1)]=String(_0x14fe3d['id']),_0x4f953e['appendChild'](_0x6ff2f5);const _0x2c1082=document[_0xa07869(0x285)](_0xa07869(0xb25));_0x2c1082['className']='world-book-category-pane',_0x2c1082[_0xa07869(0xaaf)][_0xa07869(0xcb1)]=String(_0x14fe3d['id']),_0x292af6[_0xa07869(0x22f)](_0x2c1082);});const _0x2feb05=_0x4a94a0[_0x1dddce(0xc5c)](_0x5d6a6a=>!_0x5d6a6a[_0x1dddce(0xcb1)]);if(_0x2feb05){const _0x3d15ed=document[_0x1dddce(0x285)](_0x1dddce(0x5af));_0x3d15ed[_0x1dddce(0x81c)]=_0x1dddce(0xa41),_0x3d15ed['textContent']=_0x1dddce(0x1184),_0x3d15ed[_0x1dddce(0xaaf)]['categoryId']=_0x1dddce(0x67a),_0x4f953e[_0x1dddce(0x22f)](_0x3d15ed);const _0x16e83b=document[_0x1dddce(0x285)](_0x1dddce(0xb25));_0x16e83b['className']=_0x1dddce(0x38c),_0x16e83b['dataset'][_0x1dddce(0xcb1)]='uncategorized',_0x292af6['appendChild'](_0x16e83b);}_0x4a94a0[_0x1dddce(0xd9a)](_0x22f670=>{const _0x7264ca=_0x1dddce,_0x3c0f35=_0x7264ca(0xde7)+_0x22f670['content'][_0x7264ca(0x7aa)]+_0x7264ca(0x11f3),_0x4fffd8=document['createElement'](_0x7264ca(0xb25));_0x4fffd8[_0x7264ca(0x81c)]=_0x7264ca(0x437),_0x4fffd8[_0x7264ca(0x1ef)]=_0x7264ca(0xabe)+_0x22f670[_0x7264ca(0xf74)]+_0x7264ca(0x12a4)+_0x3c0f35+_0x7264ca(0x967);const _0xa186ab=()=>_0x5a63f5(_0x22f670['id']),_0x4ef689=async()=>{const _0x58839e=_0x7264ca,_0x481d8d=await _0x4e2abc(_0x58839e(0xedd),_0x58839e(0x1203)+_0x22f670[_0x58839e(0xf74)]+_0x58839e(0x80a),{'confirmButtonClass':'btn-danger'});_0x481d8d&&(await _0x1a6951['presets'][_0x58839e(0x684)](_0x22f670['id']),_0x5b873d[_0x58839e(0x4da)]=await _0x1a6951[_0x58839e(0x4da)][_0x58839e(0xc2f)](),_0x50d15c());};_0x4fffd8[_0x7264ca(0x1193)](_0x7264ca(0x12a5),_0xa186ab),_0xefe9e2(_0x4fffd8,_0x4ef689);const _0x323a14=_0x4fffd8['cloneNode'](!![]);_0x323a14['addEventListener'](_0x7264ca(0x12a5),_0xa186ab),_0xefe9e2(_0x323a14,_0x4ef689),_0x490815['appendChild'](_0x323a14);const _0x221b4c=_0x22f670[_0x7264ca(0xcb1)]?String(_0x22f670[_0x7264ca(0xcb1)]):_0x7264ca(0x67a),_0x57d55c=_0x292af6[_0x7264ca(0xd16)](_0x7264ca(0x1f5)+_0x221b4c+'\x22]');_0x57d55c&&_0x57d55c[_0x7264ca(0x22f)](_0x4fffd8);}),document[_0x1dddce(0x35f)]('#preset-tabs\x20.world-book-tab')[_0x1dddce(0xd9a)](_0x3c7c8e=>{const _0x3e1ae9=_0x1dddce;_0x3c7c8e['addEventListener'](_0x3e1ae9(0x12a5),()=>_0x1a7c27(_0x3c7c8e[_0x3e1ae9(0xaaf)][_0x3e1ae9(0xcb1)]));});}function _0x1a7c27(_0xe434b7){const _0xc5b8d6=_0x41eae2;document[_0xc5b8d6(0x35f)](_0xc5b8d6(0xc22))['forEach'](_0x8fed68=>{const _0x2e4fb4=_0xc5b8d6;_0x8fed68[_0x2e4fb4(0x2f1)][_0x2e4fb4(0x73b)](_0x2e4fb4(0x8ea),_0x8fed68[_0x2e4fb4(0xaaf)][_0x2e4fb4(0xcb1)]===_0xe434b7);}),document['querySelectorAll']('#preset-content-container\x20.world-book-category-pane')['forEach'](_0x50ab6e=>{const _0x1be0dd=_0xc5b8d6;_0x50ab6e[_0x1be0dd(0x2f1)]['toggle']('active',_0x50ab6e[_0x1be0dd(0xaaf)][_0x1be0dd(0xcb1)]===_0xe434b7);});}async function _0x5a63f5(_0x4e4c4f){const _0x2b84ce=_0x41eae2;_0x4e6c15(_0x2b84ce(0x51e)),_0xa98184=_0x4e4c4f;try{const [_0x24d67e,_0x4242e6]=await Promise[_0x2b84ce(0x863)]([_0x1a6951[_0x2b84ce(0x4da)]['get'](_0x4e4c4f),_0x1a6951[_0x2b84ce(0xd10)][_0x2b84ce(0xc2f)]()]);if(!_0x24d67e){console[_0x2b84ce(0x1fd)](_0x2b84ce(0xb4b),_0x4e4c4f),await _0x532f76('加载失败',_0x2b84ce(0xb5b)),_0x4e6c15(_0x2b84ce(0x723));return;}setTimeout(()=>{const _0x2b8865=_0x2b84ce;document['getElementById'](_0x2b8865(0xb6c))[_0x2b8865(0xf12)]=_0x24d67e[_0x2b8865(0xf74)],document[_0x2b8865(0x89d)]('preset-name-input')['value']=_0x24d67e[_0x2b8865(0xf74)];const _0xe007e7=document['getElementById'](_0x2b8865(0xae2));_0xe007e7[_0x2b8865(0x1ef)]=_0x2b8865(0x71e),_0x4242e6['forEach'](_0xd0336a=>{const _0x35ed0b=_0x2b8865,_0x20b65b=document[_0x35ed0b(0x285)](_0x35ed0b(0xc39));_0x20b65b[_0x35ed0b(0x2f4)]=_0xd0336a['id'],_0x20b65b[_0x35ed0b(0xf12)]=_0xd0336a[_0x35ed0b(0xf74)];if(_0x24d67e[_0x35ed0b(0xcb1)]===_0xd0336a['id'])_0x20b65b[_0x35ed0b(0x335)]=!![];_0xe007e7[_0x35ed0b(0x22f)](_0x20b65b);});const _0x25ea4f=document[_0x2b8865(0x89d)]('preset-entries-container');_0x25ea4f['innerHTML']='',Array[_0x2b8865(0xbd6)](_0x24d67e[_0x2b8865(0x28c)])&&_0x24d67e['content'][_0x2b8865(0x7aa)]>0x0?_0x24d67e[_0x2b8865(0x28c)]['forEach'](_0x1c0249=>{const _0x19e9f6=_0x7c949e(_0x1c0249);_0x25ea4f['appendChild'](_0x19e9f6);}):_0x25ea4f[_0x2b8865(0x1ef)]=_0x2b8865(0x8ec);},0x32);}catch(_0x3bcff1){console[_0x2b84ce(0x1fd)](_0x2b84ce(0x314),_0x3bcff1),await _0x532f76(_0x2b84ce(0xe76),_0x2b84ce(0xac8)+_0x3bcff1[_0x2b84ce(0x1288)]),_0x4e6c15('preset-screen');}}function _0x7c949e(_0x4e1ead={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x3f5c46=_0x41eae2,_0x90be6a=document[_0x3f5c46(0x285)](_0x3f5c46(0xb25));_0x90be6a['className']=_0x3f5c46(0x828);const _0x33158a=_0x4e1ead[_0x3f5c46(0x104e)]!==![]?_0x3f5c46(0x1b0):'';_0x90be6a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20'+_0x33158a+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22'+(_0x4e1ead[_0x3f5c46(0x8f9)]||'')+_0x3f5c46(0x1389)+(_0x4e1ead['keys']||[])[_0x3f5c46(0x1237)](',\x20')+_0x3f5c46(0x130c)+(_0x4e1ead[_0x3f5c46(0x28c)]||'')+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x90be6a[_0x3f5c46(0xd16)]('.delete-block-btn')[_0x3f5c46(0x1193)](_0x3f5c46(0x12a5),()=>_0x90be6a['remove']());const _0x1af6e6=_0x90be6a['querySelector'](_0x3f5c46(0xb7e)),_0x17ecbd=_0x90be6a[_0x3f5c46(0xd16)](_0x3f5c46(0x133e));return _0x1af6e6[_0x3f5c46(0x1193)](_0x3f5c46(0x12a5),()=>{const _0x549680=_0x3f5c46,_0x24434a=_0x17ecbd[_0x549680(0x68e)][_0x549680(0x126b)]==='none';_0x17ecbd[_0x549680(0x68e)][_0x549680(0x126b)]=_0x24434a?_0x549680(0x1118):'none',_0x1af6e6[_0x549680(0xf12)]=_0x24434a?'收起':'展开';}),_0x90be6a;}async function _0x216bb7(){const _0x1d6207=_0x41eae2;await _0x25bd08(),document[_0x1d6207(0xd16)](_0x1d6207(0x3eb))[_0x1d6207(0xf12)]='管理预设分类',document['getElementById'](_0x1d6207(0xa9d))['onclick']=_0x274659,document[_0x1d6207(0x89d)]('existing-groups-list')[_0x1d6207(0x108b)]=_0xa2a00e=>{const _0x586fcd=_0x1d6207;_0xa2a00e['target'][_0x586fcd(0x2f1)][_0x586fcd(0x3ff)](_0x586fcd(0x126d))&&_0x175fab(parseInt(_0xa2a00e[_0x586fcd(0x225)][_0x586fcd(0xaaf)]['id']));},document[_0x1d6207(0x89d)](_0x1d6207(0xe47))[_0x1d6207(0x108b)]=()=>{const _0x4c9801=_0x1d6207;document[_0x4c9801(0x89d)](_0x4c9801(0x1a0))['classList'][_0x4c9801(0x1247)]('visible'),_0x50d15c();},document['getElementById'](_0x1d6207(0x1a0))[_0x1d6207(0x2f1)]['add'](_0x1d6207(0x11e4));}async function _0x25bd08(){const _0x4def09=_0x41eae2,_0x2790f6=document[_0x4def09(0x89d)](_0x4def09(0x3ec)),_0x318b82=await _0x1a6951[_0x4def09(0xd10)][_0x4def09(0xc2f)]();_0x2790f6['innerHTML']='',_0x318b82[_0x4def09(0x7aa)]===0x0&&(_0x2790f6[_0x4def09(0x1ef)]=_0x4def09(0x10e7)),_0x318b82[_0x4def09(0xd9a)](_0x12b273=>{const _0x32b2c3=_0x4def09,_0x40d385=document[_0x32b2c3(0x285)](_0x32b2c3(0xb25));_0x40d385[_0x32b2c3(0x81c)]=_0x32b2c3(0xebb),_0x40d385[_0x32b2c3(0x1ef)]=_0x32b2c3(0x96d)+_0x12b273[_0x32b2c3(0xf74)]+'</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x12b273['id']+_0x32b2c3(0xe2c),_0x2790f6[_0x32b2c3(0x22f)](_0x40d385);});}async function _0x274659(){const _0x489d50=_0x41eae2,_0x45b876=document[_0x489d50(0x89d)]('new-group-name-input'),_0x1b8542=_0x45b876[_0x489d50(0x2f4)][_0x489d50(0xc3a)]();if(!_0x1b8542)return alert(_0x489d50(0xb79));const _0x272574=await _0x1a6951[_0x489d50(0xd10)][_0x489d50(0x176)](_0x489d50(0xf74))[_0x489d50(0xb17)](_0x1b8542)[_0x489d50(0x2a6)]();if(_0x272574)return alert(_0x489d50(0xe5c)+_0x1b8542+'\x22\x20已经存在了！');await _0x1a6951['presetCategories'][_0x489d50(0x569)]({'name':_0x1b8542}),_0x45b876[_0x489d50(0x2f4)]='',await _0x25bd08();}async function _0x175fab(_0x3ad63f){const _0x19dcc9=_0x41eae2,_0x1ffc4d=await _0x4e2abc(_0x19dcc9(0x3da),_0x19dcc9(0x62a),{'confirmButtonClass':'btn-danger'});_0x1ffc4d&&(await _0x1a6951[_0x19dcc9(0xd10)][_0x19dcc9(0x684)](_0x3ad63f),await _0x1a6951[_0x19dcc9(0x4da)][_0x19dcc9(0x176)](_0x19dcc9(0xcb1))['equals'](_0x3ad63f)[_0x19dcc9(0x6aa)]({'categoryId':null}),_0x5b873d[_0x19dcc9(0x4da)]=await _0x1a6951[_0x19dcc9(0x4da)]['toArray'](),await _0x25bd08());}async function _0x47a7d9(_0x3257e4){const _0x21c527=_0x41eae2,_0x105469=_0x3257e4[_0x21c527(0x225)][_0x21c527(0x541)][0x0];if(!_0x105469)return;try{if(!_0x105469[_0x21c527(0xf74)][_0x21c527(0x77a)](_0x21c527(0x90d)))throw new Error(_0x21c527(0xd47));const _0x1b8fc2=await _0x105469[_0x21c527(0xec9)](),_0x27937f=JSON['parse'](_0x1b8fc2);await _0x108ca7(_0x27937f,_0x105469['name']);}catch(_0x150add){console[_0x21c527(0x1fd)]('预设导入失败:',_0x150add),await _0x532f76(_0x21c527(0x53d),_0x21c527(0x1360)+_0x150add[_0x21c527(0x1288)]);}finally{_0x3257e4['target'][_0x21c527(0x2f4)]=null;}}async function _0x108ca7(_0x32a008,_0x297fb5){const _0x404d42=_0x41eae2;let _0x2da070=[];if(Array[_0x404d42(0xbd6)](_0x32a008[_0x404d42(0x25b)])&&Array[_0x404d42(0xbd6)](_0x32a008[_0x404d42(0xf68)])&&_0x32a008[_0x404d42(0xf68)][_0x404d42(0x7aa)]>0x0){console[_0x404d42(0x471)](_0x404d42(0x95c));const _0x32b226=new Map(_0x32a008[_0x404d42(0x25b)][_0x404d42(0x412)](_0x1c56ee=>[_0x1c56ee[_0x404d42(0x7b5)],_0x1c56ee])),_0x37bd65=_0x32a008['prompt_order'][_0x404d42(0x11e2)]((_0xf77abc,_0xec6d6c)=>_0xec6d6c[_0x404d42(0x7ed)]&&_0xec6d6c[_0x404d42(0x7ed)][_0x404d42(0x7aa)]>(_0xf77abc[_0x404d42(0x7aa)]||0x0)?_0xec6d6c[_0x404d42(0x7ed)]:_0xf77abc,[]);_0x37bd65&&_0x37bd65['length']>0x0&&(_0x2da070=_0x37bd65[_0x404d42(0x412)](_0xc937a5=>{const _0xa9ce50=_0x404d42,_0x214a97=_0x32b226['get'](_0xc937a5[_0xa9ce50(0x7b5)]);if(_0x214a97)return{'keys':[],'comment':_0x214a97['name']||'无标题','content':_0x214a97[_0xa9ce50(0x28c)]||'','enabled':_0xc937a5[_0xa9ce50(0x104e)]};return null;})['filter'](Boolean));}else{if(_0x32a008[_0x404d42(0xa7f)]&&typeof _0x32a008[_0x404d42(0xa7f)]===_0x404d42(0x7af))console[_0x404d42(0x471)]('检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。'),Array[_0x404d42(0xbd6)](_0x32a008[_0x404d42(0x7ed)])?(console[_0x404d42(0x471)](_0x404d42(0x24f)),_0x2da070=_0x32a008[_0x404d42(0x7ed)]['map'](_0x2f8b06=>_0x32a008['entries'][_0x2f8b06])[_0x404d42(0x3d8)](Boolean)[_0x404d42(0x412)](_0x66471e=>({'keys':_0x66471e[_0x404d42(0x5a6)]||[],'comment':_0x66471e[_0x404d42(0x8f9)]||_0x404d42(0xc06),'content':_0x66471e[_0x404d42(0x28c)]||'','enabled':!_0x66471e[_0x404d42(0xd76)]}))):(console[_0x404d42(0xac3)]('未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。'),_0x2da070=Object[_0x404d42(0x4b5)](_0x32a008[_0x404d42(0xa7f)])[_0x404d42(0x412)](_0x599d11=>({'keys':_0x599d11[_0x404d42(0x5a6)]||[],'comment':_0x599d11[_0x404d42(0x8f9)]||_0x404d42(0xc06),'content':_0x599d11[_0x404d42(0x28c)]||'','enabled':!_0x599d11['disable']})));else{if(Array['isArray'](_0x32a008[_0x404d42(0x25b)]))console[_0x404d42(0x471)](_0x404d42(0x4be)),_0x2da070=_0x32a008[_0x404d42(0x25b)]['map'](_0x30eed8=>({'keys':[],'comment':_0x30eed8[_0x404d42(0xf74)]||_0x404d42(0x19d),'content':_0x30eed8['content']||'','enabled':!![]}));else throw new Error(_0x404d42(0x4ce));}}_0x2da070=_0x2da070[_0x404d42(0x3d8)](_0x46db93=>_0x46db93['content']);if(_0x2da070[_0x404d42(0x7aa)]===0x0){alert(_0x404d42(0x376));return;}const _0x2947ed=_0x297fb5[_0x404d42(0xfbf)](/\.json$/i,''),_0x2bd567=await _0x34d246(_0x404d42(0xee8),_0x404d42(0xf5e),_0x2947ed);if(!_0x2bd567||!_0x2bd567[_0x404d42(0xc3a)]()){alert(_0x404d42(0x77f));return;}const _0x4139cd={'id':_0x404d42(0x9d0)+Date['now'](),'name':_0x2bd567[_0x404d42(0xc3a)](),'content':_0x2da070,'categoryId':null};await _0x1a6951['presets'][_0x404d42(0x569)](_0x4139cd),_0x5b873d[_0x404d42(0x4da)]['push'](_0x4139cd),await _0x50d15c(),await _0x532f76('导入成功！',_0x404d42(0x8f6)+_0x2bd567+'》。');}async function _0x3d6ad3(_0x1bf669){const _0x195f22=_0x41eae2,_0x485e16=document['getElementById'](_0x195f22(0x12a3));if(!_0x485e16)return;const _0x24fe29=_0x5b873d[_0x195f22(0x4da)]||[];_0x485e16[_0x195f22(0x1ef)]='<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>',_0x24fe29[_0x195f22(0xd9a)](_0x1628ed=>{const _0x1174c7=_0x195f22,_0xecd8ab=document['createElement'](_0x1174c7(0xc39));_0xecd8ab[_0x1174c7(0x2f4)]=_0x1628ed['id'],_0xecd8ab[_0x1174c7(0xf12)]=_0x1628ed[_0x1174c7(0xf74)],_0x485e16[_0x1174c7(0x22f)](_0xecd8ab);}),_0x1bf669[_0x195f22(0xdb9)]['offlinePresetId']&&(_0x485e16[_0x195f22(0x2f4)]=_0x1bf669[_0x195f22(0xdb9)][_0x195f22(0x404)]);}function _0x279789(){const _0x55bbcd=_0x41eae2,_0x5872d0=document[_0x55bbcd(0x89d)](_0x55bbcd(0x49b));if(!_0x5872d0)return;_0x5872d0[_0x55bbcd(0x1ef)]='';let _0x4d1808=_0x5b873d[_0x55bbcd(0x21a)][_0x55bbcd(0xfb8)]||_0x2f5fcd;_0x4d1808[_0x55bbcd(0xd9a)](_0x565b9c=>{const _0xc3038b=_0x55bbcd,_0x1705a6=document[_0xc3038b(0x89d)](_0x565b9c);if(_0x1705a6){const _0x24100e=document[_0xc3038b(0x285)](_0xc3038b(0xb25));_0x24100e[_0xc3038b(0x81c)]=_0xc3038b(0xac5),_0x24100e['draggable']=!![],_0x24100e[_0xc3038b(0xaaf)][_0xc3038b(0xc60)]=_0x565b9c,_0x24100e[_0xc3038b(0x1ef)]=_0x1705a6[_0xc3038b(0x1ef)],_0x5872d0[_0xc3038b(0x22f)](_0x24100e);}});}function _0x5842ae(){const _0x4b147e=_0x41eae2,_0x2619a5=document[_0x4b147e(0x89d)](_0x4b147e(0x49b));if(!_0x2619a5)return;let _0x5cc5f7=null;const _0x51e353=_0x50cd90=>{const _0x35d52e=_0x4b147e,_0xe7ac24=_0x50cd90[_0x35d52e(0x225)][_0x35d52e(0x53a)]('.draggable-button-item');if(!_0xe7ac24)return;_0x5cc5f7=_0xe7ac24,_0x5cc5f7['classList']['add'](_0x35d52e(0x1102));if(_0x50cd90['cancelable'])_0x50cd90[_0x35d52e(0xd06)]();},_0x1dd87d=_0x2c42a1=>{const _0x311a9b=_0x4b147e;if(!_0x5cc5f7)return;const _0x328f75=_0x2c42a1[_0x311a9b(0x48c)][_0x311a9b(0xced)](_0x311a9b(0x7d5))?_0x2c42a1[_0x311a9b(0xc12)]:_0x2c42a1[_0x311a9b(0xe9e)][0x0][_0x311a9b(0xc12)],_0x3421cb=_0x200eb6(_0x2619a5,_0x328f75);_0x3421cb==null?_0x2619a5[_0x311a9b(0x22f)](_0x5cc5f7):_0x2619a5[_0x311a9b(0x1028)](_0x5cc5f7,_0x3421cb);},_0xe259ef=()=>{const _0x21107a=_0x4b147e;if(!_0x5cc5f7)return;_0x5cc5f7[_0x21107a(0x2f1)][_0x21107a(0x1247)](_0x21107a(0x1102)),_0x5cc5f7=null,_0x2d00a0();};_0x2619a5[_0x4b147e(0x1193)](_0x4b147e(0x898),_0x51e353),_0x2619a5['addEventListener'](_0x4b147e(0x74f),_0x51e353,{'passive':![]}),_0x2619a5[_0x4b147e(0x1193)](_0x4b147e(0xf4d),_0x1dd87d),_0x2619a5[_0x4b147e(0x1193)]('touchmove',_0x1dd87d,{'passive':![]}),_0x2619a5[_0x4b147e(0x1193)](_0x4b147e(0x1dd),_0xe259ef),_0x2619a5[_0x4b147e(0x1193)]('mouseleave',_0xe259ef),_0x2619a5['addEventListener'](_0x4b147e(0xc95),_0xe259ef);}function _0x200eb6(_0x56dcc8,_0x33a8cf){const _0x410b38=_0x41eae2,_0x21ef9c=[..._0x56dcc8['querySelectorAll'](_0x410b38(0xc2b))];return _0x21ef9c[_0x410b38(0x11e2)]((_0x4ff494,_0x454a79)=>{const _0x50ddb7=_0x410b38,_0x5b8df7=_0x454a79[_0x50ddb7(0xdb2)](),_0x2423a7=_0x33a8cf-_0x5b8df7['left']-_0x5b8df7[_0x50ddb7(0x42e)]/0x2;return _0x2423a7<0x0&&_0x2423a7>_0x4ff494[_0x50ddb7(0x1139)]?{'offset':_0x2423a7,'element':_0x454a79}:_0x4ff494;},{'offset':Number[_0x410b38(0x974)]})['element'];}async function _0x2d00a0(){const _0x5a99f6=_0x41eae2,_0x1de65d=document['getElementById'](_0x5a99f6(0x49b)),_0x202fb9=Array[_0x5a99f6(0x321)](_0x1de65d[_0x5a99f6(0x35f)]('.draggable-button-item'))['map'](_0x2f73e5=>_0x2f73e5[_0x5a99f6(0xaaf)]['buttonId']);_0x5b873d[_0x5a99f6(0x21a)][_0x5a99f6(0xfb8)]=_0x202fb9,await _0x1a6951[_0x5a99f6(0x21a)]['put'](_0x5b873d[_0x5a99f6(0x21a)]);}function _0x3fb5e8(){const _0xbdc72e=_0x41eae2,_0x411859=_0x5b873d[_0xbdc72e(0x21a)][_0xbdc72e(0xfb8)];if(!_0x411859||!Array[_0xbdc72e(0xbd6)](_0x411859)||_0x411859[_0xbdc72e(0x7aa)]===0x0)return;const _0x37947e=document[_0xbdc72e(0x89d)](_0xbdc72e(0x2d4));if(!_0x37947e)return;_0x411859[_0xbdc72e(0xd9a)](_0x237119=>{const _0x106ae3=_0xbdc72e,_0x499aa0=document[_0x106ae3(0x89d)](_0x237119);_0x499aa0&&_0x37947e['appendChild'](_0x499aa0);});}const _0x2f5fcd=[_0x41eae2(0x9f0),_0x41eae2(0xbf5),_0x41eae2(0x1206),_0x41eae2(0x7ab),'voice-message-btn',_0x41eae2(0xea6),'video-call-btn',_0x41eae2(0x408),_0x41eae2(0x9ce),_0x41eae2(0x1a2),_0x41eae2(0x733),_0x41eae2(0x1064),_0x41eae2(0x943),_0x41eae2(0xbcd),_0x41eae2(0x1231),_0x41eae2(0xef9),_0x41eae2(0xa8c),_0x41eae2(0x7ad),_0x41eae2(0x92f),_0x41eae2(0x1348)];async function _0x386f77(){const _0xf801f5=_0x41eae2;_0x5b873d[_0xf801f5(0x21a)][_0xf801f5(0xfb8)]=null,await _0x1a6951['globalSettings'][_0xf801f5(0xc0f)](_0x5b873d[_0xf801f5(0x21a)]),_0x279789(),_0x3fb5e8(),await _0x532f76('成功',_0xf801f5(0x7ae));}let _0x5c7ed0=[],_0x758d01=[];function _0x3cfd84(){const _0x5f0c91=_0x41eae2,_0x5a9ec9=document[_0x5f0c91(0x89d)](_0x5f0c91(0xfa4));_0x5c7ed0=[],_0x758d01=[],_0x5e1451(),document['getElementById']('data-clear-step-1')[_0x5f0c91(0x68e)][_0x5f0c91(0x126b)]=_0x5f0c91(0x66e),document[_0x5f0c91(0x89d)]('data-clear-step-2')[_0x5f0c91(0x68e)][_0x5f0c91(0x126b)]='none',_0x5a9ec9[_0x5f0c91(0x2f1)]['add']('visible');}function _0x5e1451(){const _0x24cdd5=_0x41eae2,_0xf8692a=document[_0x24cdd5(0x89d)](_0x24cdd5(0xa35));_0xf8692a['innerHTML']='';const _0x4e5c73=document[_0x24cdd5(0x285)](_0x24cdd5(0xb25));_0x4e5c73['className']=_0x24cdd5(0x80e),_0x4e5c73[_0x24cdd5(0xaaf)][_0x24cdd5(0x953)]=_0x24cdd5(0x116c),_0x4e5c73[_0x24cdd5(0x1ef)]=_0x24cdd5(0xa82)+(_0x5b873d['qzoneSettings'][_0x24cdd5(0x22a)]||'我')+_0x24cdd5(0x12f0),_0xf8692a[_0x24cdd5(0x22f)](_0x4e5c73),Object[_0x24cdd5(0x4b5)](_0x5b873d[_0x24cdd5(0x667)])[_0x24cdd5(0xd9a)](_0x147c1c=>{const _0x171183=_0x24cdd5;if(!_0x147c1c[_0x171183(0x58c)]){const _0x2d2509=document[_0x171183(0x285)](_0x171183(0xb25));_0x2d2509['className']=_0x171183(0x80e),_0x2d2509['dataset'][_0x171183(0x953)]=_0x147c1c['id'],_0x2d2509[_0x171183(0x1ef)]=_0x171183(0xd97)+_0x147c1c[_0x171183(0xf74)]+'\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xf8692a[_0x171183(0x22f)](_0x2d2509);}});}function _0x5e3685(){const _0x3fc34c=_0x41eae2,_0x307e54=document[_0x3fc34c(0x89d)]('data-clear-type-list');_0x307e54['innerHTML']='';const _0x3641a7=[{'id':'chat','name':_0x3fc34c(0x5e6),'description':_0x3fc34c(0x1040)},{'id':'qzone','name':_0x3fc34c(0x42d),'description':'将清空选定角色的所有动态、评论和点赞。'},{'id':_0x3fc34c(0x617),'name':_0x3fc34c(0x591),'description':'将清空选定角色的所有通话记录。'},{'id':'thoughts','name':'心声','description':_0x3fc34c(0x236)},{'id':_0x3fc34c(0x19e),'name':_0x3fc34c(0x475),'description':'将清空选定角色的所有长期记忆。'},{'id':'favorites','name':'收藏','description':_0x3fc34c(0x7e5)},{'id':'cphone','name':'Cphone数据\x20(CPhone)','description':_0x3fc34c(0x12bf)}];_0x3641a7[_0x3fc34c(0xd9a)](_0x190468=>{const _0x47cff4=_0x3fc34c,_0x421516=document[_0x47cff4(0x285)](_0x47cff4(0xb25));_0x421516[_0x47cff4(0x81c)]=_0x47cff4(0x80e),_0x421516[_0x47cff4(0xaaf)][_0x47cff4(0x11e5)]=_0x190468['id'],_0x421516[_0x47cff4(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x190468['name']+_0x47cff4(0x470)+_0x190468[_0x47cff4(0xf6e)]+_0x47cff4(0x129f),_0x307e54[_0x47cff4(0x22f)](_0x421516);});}function _0x156a3e(){const _0xce709f=_0x41eae2,_0x47aa97=document[_0xce709f(0x35f)](_0xce709f(0x911));if(_0x47aa97[_0xce709f(0x7aa)]===0x0){alert(_0xce709f(0xefe));return;}_0x5c7ed0=Array[_0xce709f(0x321)](_0x47aa97)[_0xce709f(0x412)](_0x53c18d=>_0x53c18d[_0xce709f(0xaaf)][_0xce709f(0x953)]),_0x5e3685(),document[_0xce709f(0x89d)](_0xce709f(0x752))[_0xce709f(0x68e)][_0xce709f(0x126b)]=_0xce709f(0x10f2),document[_0xce709f(0x89d)]('data-clear-step-2')[_0xce709f(0x68e)][_0xce709f(0x126b)]=_0xce709f(0x66e);}function _0x576fcc(){const _0x4c0b14=_0x41eae2;document['getElementById'](_0x4c0b14(0x1094))[_0x4c0b14(0x68e)][_0x4c0b14(0x126b)]=_0x4c0b14(0x10f2),document[_0x4c0b14(0x89d)]('data-clear-step-1')[_0x4c0b14(0x68e)]['display']=_0x4c0b14(0x66e),document['querySelectorAll'](_0x4c0b14(0x609))[_0x4c0b14(0xd9a)](_0x286f2f=>{const _0x2944f2=_0x4c0b14;_0x5c7ed0['includes'](_0x286f2f[_0x2944f2(0xaaf)]['charId'])&&_0x286f2f[_0x2944f2(0x2f1)]['add'](_0x2944f2(0x335));});}async function _0x42c418(){const _0xc7d8f0=_0x41eae2,_0xa276d7=document[_0xc7d8f0(0x35f)](_0xc7d8f0(0x99b));if(_0xa276d7['length']===0x0){alert(_0xc7d8f0(0x20d));return;}_0x758d01=Array[_0xc7d8f0(0x321)](_0xa276d7)[_0xc7d8f0(0x412)](_0x44d2fb=>_0x44d2fb['dataset'][_0xc7d8f0(0x11e5)]);const _0x4988eb=await _0x4e2abc(_0xc7d8f0(0xe1c),_0xc7d8f0(0x726),{'confirmButtonClass':_0xc7d8f0(0xcd8),'confirmText':_0xc7d8f0(0x3da)});if(!_0x4988eb)return;await _0x532f76(_0xc7d8f0(0xb6a),_0xc7d8f0(0xb18));try{await _0x1a6951[_0xc7d8f0(0x93b)]('rw',_0x1a6951['tables'],async()=>{const _0x1bf827=_0xc7d8f0;for(const _0x47da7f of _0x5c7ed0){for(const _0x211a51 of _0x758d01){if(_0x211a51===_0x1bf827(0xde9)){if(_0x47da7f==='user'){const _0x588629=await _0x1a6951[_0x1bf827(0x667)][_0x1bf827(0xc2f)]();for(const _0x4b1981 of _0x588629){_0x4b1981[_0x1bf827(0x551)]=_0x4b1981['history'][_0x1bf827(0x3d8)](_0x12860b=>_0x12860b[_0x1bf827(0xa57)]!==_0x1bf827(0x116c)),await _0x1a6951[_0x1bf827(0x667)][_0x1bf827(0xc0f)](_0x4b1981);}}else{const _0x123270=await _0x1a6951[_0x1bf827(0x667)][_0x1bf827(0x650)](_0x47da7f);_0x123270&&(_0x123270[_0x1bf827(0x551)]=[],_0x123270[_0x1bf827(0x253)]=_0x1bf827(0x1046),_0x123270[_0x1bf827(0x27e)]=_0x1bf827(0x1046),Array[_0x1bf827(0xbd6)](_0x123270[_0x1bf827(0xfe2)])&&(_0x123270[_0x1bf827(0xfe2)]=[]),_0x123270[_0x1bf827(0xdb9)]&&(_0x123270[_0x1bf827(0xdb9)][_0x1bf827(0xc48)]='我'),await _0x1a6951['chats'][_0x1bf827(0xc0f)](_0x123270));}}if(_0x211a51===_0x1bf827(0x115d)){const _0x2e38d0=_0x47da7f===_0x1bf827(0x116c)?'user':_0x47da7f;await _0x1a6951[_0x1bf827(0xea0)][_0x1bf827(0x176)](_0x1bf827(0xc3f))[_0x1bf827(0xb17)](_0x2e38d0)[_0x1bf827(0x684)]();}_0x211a51===_0x1bf827(0x617)&&_0x47da7f!==_0x1bf827(0x116c)&&await _0x1a6951[_0x1bf827(0x856)][_0x1bf827(0x176)](_0x1bf827(0x94d))['equals'](_0x47da7f)['delete']();if(_0x211a51===_0x1bf827(0xe9d)&&_0x47da7f!==_0x1bf827(0x116c)){const _0x4f4070=await _0x1a6951[_0x1bf827(0x667)][_0x1bf827(0x650)](_0x47da7f);_0x4f4070&&(_0x4f4070['thoughtsHistory']=[],_0x4f4070[_0x1bf827(0x253)]=_0x1bf827(0x1046),_0x4f4070[_0x1bf827(0x27e)]=_0x1bf827(0x1046),await _0x1a6951['chats'][_0x1bf827(0xc0f)](_0x4f4070));}if(_0x211a51===_0x1bf827(0x19e)&&_0x47da7f!=='user'){const _0x4b588b=await _0x1a6951[_0x1bf827(0x667)][_0x1bf827(0x650)](_0x47da7f);_0x4b588b&&(_0x4b588b[_0x1bf827(0xc18)]=[],await _0x1a6951[_0x1bf827(0x667)][_0x1bf827(0xc0f)](_0x4b588b));}_0x211a51===_0x1bf827(0x183)&&(_0x47da7f===_0x1bf827(0x116c)?(await _0x1a6951[_0x1bf827(0x183)][_0x1bf827(0x176)]('type')[_0x1bf827(0xb17)]('qzone_post')['filter'](_0x260979=>_0x260979[_0x1bf827(0x28c)]['authorId']===_0x1bf827(0x116c))[_0x1bf827(0x684)](),await _0x1a6951['favorites']['where'](_0x1bf827(0x48c))[_0x1bf827(0xb17)](_0x1bf827(0x8bb))[_0x1bf827(0x3d8)](_0x14d830=>_0x14d830[_0x1bf827(0x28c)][_0x1bf827(0xa57)]===_0x1bf827(0x116c))[_0x1bf827(0x684)]()):(await _0x1a6951['favorites'][_0x1bf827(0x176)](_0x1bf827(0x48c))[_0x1bf827(0xb17)]('chat_message')['and'](_0x33ed9b=>_0x33ed9b['chatId']===_0x47da7f)[_0x1bf827(0x684)](),await _0x1a6951[_0x1bf827(0x183)][_0x1bf827(0x176)](_0x1bf827(0x48c))[_0x1bf827(0xb17)](_0x1bf827(0x8ed))[_0x1bf827(0x3d8)](_0x3caee9=>_0x3caee9[_0x1bf827(0x28c)]['authorId']===_0x47da7f)['delete'](),await _0x1a6951[_0x1bf827(0x183)][_0x1bf827(0x176)]('type')[_0x1bf827(0xb17)](_0x1bf827(0x1b6))['filter'](_0x13d058=>_0x13d058[_0x1bf827(0x28c)][_0x1bf827(0x592)]===_0x47da7f)[_0x1bf827(0x684)](),await _0x1a6951[_0x1bf827(0x183)]['where'](_0x1bf827(0x48c))['equals'](_0x1bf827(0x29c))[_0x1bf827(0x3d8)](_0x576e8f=>_0x576e8f[_0x1bf827(0x28c)][_0x1bf827(0x592)]===_0x47da7f)['delete'](),await _0x1a6951[_0x1bf827(0x183)]['where']('type')['equals'](_0x1bf827(0x694))[_0x1bf827(0x3d8)](_0x215f02=>_0x215f02[_0x1bf827(0x28c)][_0x1bf827(0x592)]===_0x47da7f)[_0x1bf827(0x684)]()));if(_0x211a51===_0x1bf827(0x26a)&&_0x47da7f!==_0x1bf827(0x116c)){const _0x6395f9=await _0x1a6951[_0x1bf827(0x667)][_0x1bf827(0x650)](_0x47da7f);_0x6395f9&&(_0x6395f9['simulatedAlbum']=[],_0x6395f9[_0x1bf827(0x1ce)]=[],_0x6395f9['simulatedBrowserHistory']=[],_0x6395f9[_0x1bf827(0x12ca)]=null,_0x6395f9[_0x1bf827(0xab8)]=[],_0x6395f9[_0x1bf827(0x1274)]=[],_0x6395f9[_0x1bf827(0x9c8)]=[],_0x6395f9[_0x1bf827(0x89a)]=[],_0x6395f9['memos']=[],await _0x1a6951[_0x1bf827(0x667)][_0x1bf827(0xc0f)](_0x6395f9));}}}}),await _0x26875f(),await _0x413d78(),document[_0xc7d8f0(0x89d)](_0xc7d8f0(0xfa4))['classList']['remove']('visible'),await _0x532f76(_0xc7d8f0(0x59d),_0xc7d8f0(0xf79));}catch(_0x5f2406){console[_0xc7d8f0(0x1fd)](_0xc7d8f0(0xef0),_0x5f2406),await _0x532f76(_0xc7d8f0(0x170),_0xc7d8f0(0x7ee)+_0x5f2406[_0xc7d8f0(0x1288)]);}}async function _0x5627c5(_0x185e58,_0x16cb22,_0x38aecc){const _0x301f12=_0x41eae2,_0x1ac7cb=_0x38aecc[_0x301f12(0xd16)](_0x301f12(0x838))['alt'],_0x2469a3=await _0x4d923b(_0x301f12(0x1249)+_0x1ac7cb+_0x301f12(0x50b),[{'text':'📁\x20从本地上传','value':_0x301f12(0x586)},{'text':'🌐\x20使用网络URL','value':_0x301f12(0x11de)}]);let _0x3384da=null;if(_0x2469a3==='local')_0x3384da=await _0x240760();else{if(_0x2469a3===_0x301f12(0x11de)){const _0x18a255=_0x16cb22===_0x301f12(0x26a)?_0x5b873d[_0x301f12(0x21a)][_0x301f12(0xf1e)][_0x185e58]:_0x5b873d[_0x301f12(0x21a)][_0x301f12(0x361)][_0x185e58],_0x51fe54=_0x18a255[_0x301f12(0x1222)](_0x301f12(0xcaa)),_0x1ef469=_0x51fe54?'':_0x18a255;_0x3384da=await _0x34d246('更换图标',_0x301f12(0x8d2),_0x1ef469,_0x301f12(0x11de));}}if(_0x3384da&&_0x3384da[_0x301f12(0xc3a)]()){const _0x56e9d1=_0x3384da[_0x301f12(0xc3a)]();_0x16cb22===_0x301f12(0x26a)?_0x5b873d[_0x301f12(0x21a)]['cphoneAppIcons'][_0x185e58]=_0x56e9d1:_0x5b873d['globalSettings']['appIcons'][_0x185e58]=_0x56e9d1,_0x38aecc['querySelector'](_0x301f12(0x838))['src']=_0x56e9d1;}else _0x3384da!==null&&alert(_0x301f12(0x1355));}async function _0x169b12(){const _0x3ef412=_0x41eae2,_0x588ba0=await _0x4e2abc('确认压缩图片？',_0x3ef412(0x6f8),{'confirmButtonClass':_0x3ef412(0xcd8),'confirmText':_0x3ef412(0x57b)});if(!_0x588ba0)return;await _0x532f76(_0x3ef412(0xb6a),'正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...');let _0x327d77={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console['log'](_0x3ef412(0x1378));const _0x1c9124=[_0x3ef412(0x667),'globalSettings',_0x3ef412(0x5c1),'userStickers','customAvatarFrames'],_0x4ccd67=[];for(const _0x145070 of _0x1c9124){const _0x106e97=_0x1a6951[_0x3ef412(0x10b6)](_0x145070),_0x173e26=await _0x106e97[_0x3ef412(0xc2f)]();_0x4ccd67[_0x3ef412(0x138c)]({'tableName':_0x145070,'records':_0x173e26});}console['log'](_0x3ef412(0x114f));for(const _0x45f5c9 of _0x4ccd67){for(const _0x5437e7 of _0x45f5c9[_0x3ef412(0x7fa)]){await _0x2c2137(_0x5437e7,_0x327d77);}}console[_0x3ef412(0x471)](_0x3ef412(0x1ac)),await _0x1a6951[_0x3ef412(0x93b)]('rw',_0x1c9124,async()=>{const _0x31a406=_0x3ef412;for(const _0x2ffb8c of _0x4ccd67){await _0x1a6951[_0x31a406(0x10b6)](_0x2ffb8c[_0x31a406(0x6e9)])[_0x31a406(0xef7)](_0x2ffb8c[_0x31a406(0x7fa)]);}});const _0x29cd79=_0x327d77[_0x3ef412(0xd3e)]-_0x327d77[_0x3ef412(0xeec)],_0x5a71b5=_0x327d77[_0x3ef412(0xd3e)]>0x0?(_0x29cd79/_0x327d77[_0x3ef412(0xd3e)]*0x64)[_0x3ef412(0x8f7)](0x2):0x0;await _0x532f76('压缩完成！',_0x3ef412(0x28e)+_0x327d77[_0x3ef412(0x721)]+_0x3ef412(0x794)+_0x327d77[_0x3ef412(0xbd1)]+_0x3ef412(0x3c1)+_0x327d77[_0x3ef412(0x936)]+_0x3ef412(0x52e)+(_0x29cd79/0x400/0x400)['toFixed'](0x2)+'\x20MB</strong>\x20(压缩率\x20'+_0x5a71b5+'%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。');}catch(_0x4b5adc){console[_0x3ef412(0x1fd)](_0x3ef412(0x135c),_0x4b5adc),await _0x532f76(_0x3ef412(0x339),_0x3ef412(0x7ee)+_0x4b5adc[_0x3ef412(0x1288)]);}}function _0x2b0a07(_0x22d8ec,_0x23c0a6=''){const _0x24a808=_0x41eae2;let _0x6db2b6=0x0;for(const _0xde07d1 in _0x22d8ec){if(_0x22d8ec[_0x24a808(0x42c)](_0xde07d1)){const _0x540002=_0x22d8ec[_0xde07d1];if(typeof _0x540002===_0x24a808(0x1224)&&_0x540002['startsWith'](_0x24a808(0xcaa))){const _0x5d8108=_0x23c0a6==='globalSettings'&&(_0xde07d1==='wallpaper'||_0xde07d1==='cphoneWallpaper'||_0xde07d1==='globalChatBackground')||_0x23c0a6===_0x24a808(0x4c0)||_0x23c0a6===_0x24a808(0xdb9)&&_0xde07d1===_0x24a808(0x55c)||(_0x23c0a6==='appIcons'||_0x23c0a6===_0x24a808(0xf1e));!_0x5d8108&&(_0x6db2b6+=_0x540002['length']);}else typeof _0x540002===_0x24a808(0x7af)&&_0x540002!==null&&(_0x6db2b6+=_0x2b0a07(_0x540002,_0xde07d1));}}return _0x6db2b6;}async function _0x1cdc57(){const _0x292a45=_0x41eae2,_0x2f78ce=document[_0x292a45(0x89d)](_0x292a45(0x8d1));if(!_0x2f78ce)return;_0x2f78ce[_0x292a45(0x1ef)]=_0x292a45(0x245);try{let _0x3505e8=0x0;const _0x5454f3=[_0x292a45(0x667),_0x292a45(0x21a),_0x292a45(0x5c1),_0x292a45(0x210),_0x292a45(0x1343)];for(const _0x3a6c0e of _0x5454f3){const _0x2ce038=_0x1a6951[_0x292a45(0x10b6)](_0x3a6c0e);await _0x2ce038[_0x292a45(0xed5)](_0x1e7492=>{_0x3505e8+=_0x2b0a07(_0x1e7492);});}const _0x42ffea=(_0x3505e8/0x400/0x400)[_0x292a45(0x8f7)](0x2);_0x2f78ce[_0x292a45(0x1ef)]=_0x292a45(0xd32)+_0x42ffea+'\x20MB</strong></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}catch(_0x44f240){console[_0x292a45(0x1fd)](_0x292a45(0x1302),_0x44f240),_0x2f78ce[_0x292a45(0x1ef)]=_0x292a45(0x840);}}async function _0x2c2137(_0x2e48ad,_0x4b98aa,_0x20a1f1=''){const _0x59bea5=_0x41eae2;for(const _0x1e2236 in _0x2e48ad){if(_0x2e48ad[_0x59bea5(0x42c)](_0x1e2236)){const _0x4607d1=_0x2e48ad[_0x1e2236];if(typeof _0x4607d1===_0x59bea5(0x1224)&&_0x4607d1[_0x59bea5(0x1222)]('data:image')){const _0x10b8df=_0x20a1f1===_0x59bea5(0x21a)&&(_0x1e2236===_0x59bea5(0xd92)||_0x1e2236===_0x59bea5(0x5fa)||_0x1e2236===_0x59bea5(0xcdb))||_0x20a1f1===_0x59bea5(0x4c0)||_0x20a1f1===_0x59bea5(0xdb9)&&_0x1e2236===_0x59bea5(0x55c)||(_0x20a1f1===_0x59bea5(0x361)||_0x20a1f1===_0x59bea5(0xf1e));if(_0x10b8df)continue;_0x4b98aa[_0x59bea5(0x721)]++,_0x4b98aa[_0x59bea5(0xd3e)]+=_0x4607d1[_0x59bea5(0x7aa)];const _0x2d988d=await _0x4830da(_0x4607d1);_0x2d988d&&_0x2d988d!==_0x4607d1?(_0x2e48ad[_0x1e2236]=_0x2d988d,_0x4b98aa[_0x59bea5(0xbd1)]++,_0x4b98aa[_0x59bea5(0xeec)]+=_0x2d988d[_0x59bea5(0x7aa)]):(_0x4b98aa['skipped']++,_0x4b98aa[_0x59bea5(0xeec)]+=_0x4607d1[_0x59bea5(0x7aa)]);}else typeof _0x4607d1===_0x59bea5(0x7af)&&_0x4607d1!==null&&await _0x2c2137(_0x4607d1,_0x4b98aa,_0x1e2236);}}}function _0x4830da(_0x37e51d,_0x54963d={}){return new Promise(_0x4df4eb=>{const _0x155054=_0x356e;if(!_0x37e51d[_0x155054(0x1222)](_0x155054(0xcaa))){console[_0x155054(0xac3)](_0x155054(0x7a7),_0x37e51d[_0x155054(0x489)](0x0,0x32)+_0x155054(0x1046)),_0x4df4eb(_0x37e51d);return;}const _0x58f45e=_0x54963d[_0x155054(0x96f)]||0.5,_0x4fe29a=_0x54963d[_0x155054(0xe1f)]||0x320,_0x5a7e1a=new Image();_0x5a7e1a[_0x155054(0x736)]=()=>{const _0x58ff9f=_0x155054;let _0x26d316=_0x5a7e1a[_0x58ff9f(0x42e)],_0x2a8ebe=_0x5a7e1a[_0x58ff9f(0x84a)];_0x26d316>_0x4fe29a&&(_0x2a8ebe=Math[_0x58ff9f(0x900)](_0x4fe29a/_0x26d316*_0x2a8ebe),_0x26d316=_0x4fe29a);const _0x41dab2=document[_0x58ff9f(0x285)]('canvas');_0x41dab2[_0x58ff9f(0x42e)]=_0x26d316,_0x41dab2[_0x58ff9f(0x84a)]=_0x2a8ebe;const _0x58371a=_0x41dab2[_0x58ff9f(0xc94)]('2d');_0x58371a[_0x58ff9f(0x79a)](_0x5a7e1a,0x0,0x0,_0x26d316,_0x2a8ebe);const _0x13ad04=_0x41dab2[_0x58ff9f(0x666)](_0x58ff9f(0xd48),_0x58f45e);_0x4df4eb(_0x13ad04);},_0x5a7e1a[_0x155054(0x1010)]=()=>{const _0x1e652c=_0x155054;console['warn']('加载图片失败，跳过压缩:',_0x37e51d[_0x1e652c(0x489)](0x0,0x32)+'...'),_0x4df4eb(_0x37e51d);},_0x5a7e1a[_0x155054(0x9e3)]=_0x37e51d;});}async function _0x28312f(){const _0x13e61e=_0x41eae2,_0x287c28='1.0';try{const _0x5aa9a3=await fetch('update-notice.html?_='+Date[_0x13e61e(0xf1a)]());if(!_0x5aa9a3['ok']){console[_0x13e61e(0xac3)](_0x13e61e(0x112e));return;}const _0x2db188=await _0x5aa9a3['text'](),_0x41d60f=document['createElement'](_0x13e61e(0xb25));_0x41d60f[_0x13e61e(0x1ef)]=_0x2db188;const _0x36f178=_0x41d60f['querySelector'](_0x13e61e(0x1277));if(!_0x36f178){console['error']('更新通知文件中缺少\x20data-version\x20属性。');return;}const _0x9c54f8=_0x36f178[_0x13e61e(0xaaf)][_0x13e61e(0xd8d)],_0x599c20=localStorage[_0x13e61e(0x1344)]('dismissedUpdateVersion');_0x9c54f8>_0x599c20?(console[_0x13e61e(0x471)](_0x13e61e(0x110b)+_0x9c54f8+_0x13e61e(0xffa)+_0x599c20+')'),_0x28de0e(_0x9c54f8,_0x36f178[_0x13e61e(0x1ef)])):console[_0x13e61e(0x471)](_0x13e61e(0xcf6)+_0x9c54f8+_0x13e61e(0xeed));}catch(_0x529fff){console['error'](_0x13e61e(0x413),_0x529fff);}}function _0x28de0e(_0x3532aa,_0x157c28){const _0x2e76ca=_0x41eae2,_0x597100=document[_0x2e76ca(0x89d)](_0x2e76ca(0xf64)),_0x2585fd=document[_0x2e76ca(0x89d)](_0x2e76ca(0xf53)),_0x42884b=document[_0x2e76ca(0x89d)](_0x2e76ca(0xec6)),_0x272f28=document[_0x2e76ca(0x89d)](_0x2e76ca(0xfa6));_0x2585fd[_0x2e76ca(0x1ef)]=_0x157c28,_0x42884b[_0x2e76ca(0x108b)]=()=>{const _0x338253=_0x2e76ca;_0x597100[_0x338253(0x2f1)]['remove']('visible');},_0x272f28[_0x2e76ca(0x108b)]=()=>{const _0x19c551=_0x2e76ca;localStorage[_0x19c551(0x85d)](_0x19c551(0xed0),_0x3532aa),_0x597100[_0x19c551(0x2f1)][_0x19c551(0x1247)](_0x19c551(0x11e4)),console[_0x19c551(0x471)](_0x19c551(0x69e)+_0x3532aa);},_0x597100[_0x2e76ca(0x2f1)][_0x2e76ca(0x569)](_0x2e76ca(0x11e4));}function _0x4542e9(){const _0xbc5612=_0x41eae2,_0x48a8a4=document['getElementById'](_0xbc5612(0x554));document[_0xbc5612(0x89d)](_0xbc5612(0xe5d))[_0xbc5612(0x2f4)]=_0x5b873d[_0xbc5612(0x21a)][_0xbc5612(0x12fe)]||0xc,document['getElementById'](_0xbc5612(0x93a))[_0xbc5612(0x2f4)]=_0x5b873d['globalSettings'][_0xbc5612(0xf91)]||0x14,_0x48a8a4[_0xbc5612(0x2f1)][_0xbc5612(0x569)](_0xbc5612(0x11e4));}async function _0x5086ab(){const _0x375fc2=_0x41eae2,_0x13a463=document[_0x375fc2(0x89d)](_0x375fc2(0xe5d)),_0x179ff2=document[_0x375fc2(0x89d)](_0x375fc2(0x93a)),_0x2f7f71=parseInt(_0x13a463['value']),_0xb31f93=parseInt(_0x179ff2['value']);if(isNaN(_0x2f7f71)||isNaN(_0xb31f93)||_0x2f7f71<0x1||_0xb31f93<0x1){alert(_0x375fc2(0xcd0));return;}if(_0x2f7f71>_0xb31f93){alert(_0x375fc2(0x1254));return;}_0x5b873d[_0x375fc2(0x21a)]['doubanMinPosts']=_0x2f7f71,_0x5b873d['globalSettings']['doubanMaxPosts']=_0xb31f93,await _0x1a6951['globalSettings'][_0x375fc2(0xc0f)](_0x5b873d[_0x375fc2(0x21a)]),document[_0x375fc2(0x89d)](_0x375fc2(0x554))[_0x375fc2(0x2f1)]['remove'](_0x375fc2(0x11e4)),await _0x532f76(_0x375fc2(0x5dd),_0x375fc2(0x5d1));}async function _0x3a2507(_0xac225){const _0x58db98=_0x41eae2,_0xf33984=document[_0x58db98(0x89d)](_0x58db98(0x10bb)),_0x5f5502=document['getElementById'](_0x58db98(0x40e));_0x5f5502['innerHTML']='';let _0x47d7a3=[];if(_0xac225==='global'){const _0x3ad9ff=Object[_0x58db98(0x4b5)](_0x5b873d['chats'])[_0x58db98(0x3d8)](_0x38be19=>!_0x38be19['isGroup']),_0x513e37=await _0x1a6951[_0x58db98(0x8ce)][_0x58db98(0xc2f)]();_0x47d7a3=[{'id':_0x58db98(0x116c),'name':_0x5b873d[_0x58db98(0x5c1)][_0x58db98(0x22a)]||'我','originalName':_0x5b873d[_0x58db98(0x5c1)][_0x58db98(0x22a)]||'我','avatar':_0x5b873d[_0x58db98(0x5c1)][_0x58db98(0x12c8)],'type':_0x58db98(0x116c)},..._0x3ad9ff[_0x58db98(0x412)](_0x2951b3=>({'id':_0x2951b3['id'],'name':_0x2951b3[_0x58db98(0xf74)],'originalName':_0x2951b3[_0x58db98(0x1045)],'avatar':_0x2951b3[_0x58db98(0xdb9)]['aiAvatar'],'type':_0x58db98(0x132a)})),..._0x513e37['map'](_0x43690d=>({'id':_0x58db98(0x5b8)+_0x43690d['id'],'name':_0x43690d[_0x58db98(0xf74)],'originalName':_0x43690d[_0x58db98(0xf74)],'avatar':_0x43690d[_0x58db98(0x12c8)],'type':_0x58db98(0x117e)}))],_0x42920c[_0x58db98(0x94d)]=null;}else{const _0xfccc91=_0x5b873d['chats'][_0x5b873d['activeChatId']];if(!_0xfccc91||!_0xfccc91['isGroup'])return;_0x47d7a3=[{'id':_0x58db98(0x116c),'name':_0xfccc91[_0x58db98(0xdb9)][_0x58db98(0xc48)]||'我','originalName':_0x5b873d['qzoneSettings'][_0x58db98(0x22a)]||'我','avatar':_0xfccc91[_0x58db98(0xdb9)]['myAvatar'],'type':_0x58db98(0x116c)},..._0xfccc91['members'][_0x58db98(0x412)](_0x432eaa=>{const _0xfb71b6=_0x58db98,_0x34a09a=_0x5b873d[_0xfb71b6(0x667)][_0x432eaa['id']],_0x51791e=_0x432eaa[_0xfb71b6(0x12c8)]||(_0x34a09a?_0x34a09a[_0xfb71b6(0xdb9)]['aiAvatar']:_0x15061e);return{'id':_0x432eaa['id'],'name':_0x432eaa[_0xfb71b6(0x7da)],'originalName':_0x432eaa['originalName'],'avatar':_0x51791e,'type':_0x432eaa[_0xfb71b6(0x860)]?_0xfb71b6(0x117e):_0xfb71b6(0x132a)};})],_0x42920c[_0x58db98(0x94d)]=_0x5b873d['activeChatId'];}_0x47d7a3[_0x58db98(0xd9a)](_0x357823=>{const _0x113c30=_0x58db98,_0x1eb21e=document[_0x113c30(0x285)](_0x113c30(0xb25));_0x1eb21e['className']='contact-picker-item',_0x1eb21e[_0x113c30(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27'+JSON[_0x113c30(0x465)](_0x357823)+'\x27\x20'+(_0x357823[_0x113c30(0x48c)]===_0x113c30(0x116c)?_0x113c30(0xd0c):_0x113c30(0x1b0))+_0x113c30(0xdf2)+_0x357823[_0x113c30(0x12c8)]+_0x113c30(0xc6e)+_0x357823[_0x113c30(0xf74)]+_0x113c30(0xf9a),_0x5f5502['appendChild'](_0x1eb21e);}),_0xf33984[_0x58db98(0x2f1)][_0x58db98(0x569)](_0x58db98(0x11e4));}async function _0x243672(){const _0x41fb49=_0x41eae2,_0x312baf=document['querySelectorAll'](_0x41fb49(0x10ec)),_0x2a177f=_0x312baf[_0x41fb49(0x7aa)];let _0x36fbd0=[];if(_0x2a177f===0x6)_0x42920c[_0x41fb49(0x5ac)]='6p',_0x36fbd0=['狼人','狼人','平民','平民','预言家','猎人'];else{if(_0x2a177f===0x9)_0x42920c[_0x41fb49(0x5ac)]='9p',_0x36fbd0=['狼人','狼人','狼人','平民','平民','平民',_0x41fb49(0x111c),'女巫','猎人'];else{if(_0x2a177f===0xc)_0x42920c[_0x41fb49(0x5ac)]=_0x41fb49(0x724),_0x36fbd0=['狼人','狼人','狼人','狼人','平民','平民','平民','平民','预言家','女巫','猎人','守卫'];else{alert(_0x41fb49(0xe0b)+_0x2a177f+_0x41fb49(0xfa9));return;}}}document['getElementById'](_0x41fb49(0x10bb))[_0x41fb49(0x2f1)][_0x41fb49(0x1247)](_0x41fb49(0x11e4)),await _0x532f76(_0x41fb49(0x175),_0x41fb49(0x6bc));for(let _0x4da9d1=_0x36fbd0[_0x41fb49(0x7aa)]-0x1;_0x4da9d1>0x0;_0x4da9d1--){const _0x554a62=Math['floor'](Math['random']()*(_0x4da9d1+0x1));[_0x36fbd0[_0x4da9d1],_0x36fbd0[_0x554a62]]=[_0x36fbd0[_0x554a62],_0x36fbd0[_0x4da9d1]];}const _0x139ac5=Array[_0x41fb49(0x321)](_0x312baf)['map'](_0x441cc5=>JSON[_0x41fb49(0x2cb)](_0x441cc5[_0x41fb49(0xaaf)]['playerJson']));_0x42920c[_0x41fb49(0x11ee)]=[];for(let _0x1ea921=0x0;_0x1ea921<_0x139ac5[_0x41fb49(0x7aa)];_0x1ea921++){const _0x123de1=_0x139ac5[_0x1ea921],_0xac88b7=_0x36fbd0[_0x1ea921];let _0xe134d='一个普通玩家';if(_0x123de1[_0x41fb49(0x48c)]===_0x41fb49(0x132a)){const _0x23b5db=_0x5b873d[_0x41fb49(0x667)][_0x123de1['id']];_0xe134d=_0x23b5db?_0x23b5db[_0x41fb49(0xdb9)][_0x41fb49(0x1269)]:_0x41fb49(0x973);}else{if(_0x123de1[_0x41fb49(0x48c)]===_0x41fb49(0x117e)){const _0x34d49b=await _0x1a6951['npcs'][_0x41fb49(0xc2f)](),_0xda2052=_0x34d49b[_0x41fb49(0x12f4)](_0x14a2f2=>_0x41fb49(0x5b8)+_0x14a2f2['id']===_0x123de1['id']);_0xe134d=_0xda2052?_0xda2052[_0x41fb49(0x1170)]:_0x41fb49(0xdf3);}else{if(_0x123de1[_0x41fb49(0x48c)]===_0x41fb49(0x116c)){const _0x2d552f=_0x42920c[_0x41fb49(0x94d)]?_0x5b873d[_0x41fb49(0x667)][_0x42920c['chatId']]:null;_0xe134d=_0x2d552f?_0x2d552f[_0x41fb49(0xdb9)]['myPersona']:_0x41fb49(0xa6e);}}}const _0x453a18={..._0x123de1,'role':_0xac88b7,'isAlive':!![],'character_persona':_0xe134d};_0xac88b7==='女巫'&&(_0x453a18[_0x41fb49(0x638)]=![],_0x453a18['poisonUsed']=![]),_0xac88b7==='守卫'&&(_0x453a18[_0x41fb49(0x774)]=null),_0x42920c[_0x41fb49(0x11ee)][_0x41fb49(0x138c)](_0x453a18);}_0x42920c[_0x41fb49(0xfcb)]=!![],_0x42920c[_0x41fb49(0xd72)]=0x1,_0x42920c['currentPhase']=_0x41fb49(0xf26),_0x42920c[_0x41fb49(0xf99)]=[],_0x42920c[_0x41fb49(0x1091)]=[];const _0x4ea99f=_0x36fbd0['reduce']((_0x902bc2,_0x4f23bf)=>{return _0x902bc2[_0x4f23bf]=(_0x902bc2[_0x4f23bf]||0x0)+0x1,_0x902bc2;},{}),_0x34a52a=Object[_0x41fb49(0xa7f)](_0x4ea99f)['map'](([_0xa188f1,_0x22b311])=>_0xa188f1+'\x20x'+_0x22b311)[_0x41fb49(0x1237)]('、');_0x2fd1ad(_0x41fb49(0x10e1)+_0x2a177f+_0x41fb49(0x5e5)+_0x34a52a+'。');const _0xbf5116=_0x42920c[_0x41fb49(0x11ee)]['find'](_0x4a3254=>_0x4a3254['id']==='user');_0x12aee4(),_0x4e6c15(_0x41fb49(0xbaa)),_0x1eb39b(_0xbf5116['role']);}function _0x12aee4(){const _0x38c2d2=_0x41eae2,_0x4ebe00=document[_0x38c2d2(0x89d)](_0x38c2d2(0x7a8));_0x4ebe00[_0x38c2d2(0x1ef)]='';const _0xa8da9b=[..._0x42920c[_0x38c2d2(0x11ee)]][_0x38c2d2(0x2e3)]((_0x2fd6ed,_0x4d83e1)=>_0x2fd6ed['isAlive']-_0x4d83e1[_0x38c2d2(0x5d7)]);_0xa8da9b[_0x38c2d2(0xd9a)]((_0x3d6c87,_0x5f0665)=>{const _0x46d1f9=_0x38c2d2,_0x5a351a=_0x42920c[_0x46d1f9(0x11ee)][_0x46d1f9(0x9d7)](_0x2db8a7=>_0x2db8a7['id']===_0x3d6c87['id'])+0x1,_0x381d58=document['createElement'](_0x46d1f9(0xb25));_0x381d58[_0x46d1f9(0x81c)]=_0x46d1f9(0xb52);if(!_0x3d6c87[_0x46d1f9(0x5d7)])_0x381d58[_0x46d1f9(0x2f1)]['add']('dead');_0x381d58[_0x46d1f9(0x1ef)]=_0x46d1f9(0x8dd)+_0x3d6c87[_0x46d1f9(0x12c8)]+_0x46d1f9(0xa3e)+_0x5a351a+'.\x20'+_0x3d6c87[_0x46d1f9(0xf74)]+_0x46d1f9(0xf9a),_0x4ebe00[_0x46d1f9(0x22f)](_0x381d58);});const _0x3e9410=document[_0x38c2d2(0x89d)](_0x38c2d2(0x791));_0x3e9410[_0x38c2d2(0x1ef)]='';for(let _0x28a47d=0x1;_0x28a47d<=_0x42920c['currentDay'];_0x28a47d++){const _0x59545f=[..._0x42920c[_0x38c2d2(0xf99)][_0x38c2d2(0x3d8)](_0xdb35e=>_0xdb35e[_0x38c2d2(0xb5e)]===_0x28a47d),..._0x42920c[_0x38c2d2(0x1091)]['filter'](_0x1c54bc=>_0x1c54bc[_0x38c2d2(0xb5e)]===_0x28a47d)][_0x38c2d2(0x2e3)]((_0x5af652,_0xecc47e)=>(_0x5af652[_0x38c2d2(0x114e)]||0x0)-(_0xecc47e[_0x38c2d2(0x114e)]||0x0));if(_0x59545f['length']>0x0){const _0x1fcb2a=document[_0x38c2d2(0x285)](_0x38c2d2(0xb25));_0x1fcb2a[_0x38c2d2(0x81c)]='werewolf-log-entry\x20system',_0x1fcb2a[_0x38c2d2(0xf12)]=_0x38c2d2(0xcde)+_0x28a47d+_0x38c2d2(0x59b),_0x1fcb2a['style'][_0x38c2d2(0x137a)]=_0x38c2d2(0x10f1),_0x3e9410[_0x38c2d2(0x22f)](_0x1fcb2a),_0x59545f['forEach'](_0x5aaa6d=>{const _0x150865=_0x38c2d2,_0xbd6347=document['createElement'](_0x150865(0xb25));_0xbd6347[_0x150865(0x81c)]=_0x150865(0x21e)+_0x5aaa6d[_0x150865(0x48c)],_0x5aaa6d[_0x150865(0x48c)]==='dialogue'?_0xbd6347[_0x150865(0x1ef)]=_0x150865(0x11d3)+_0x5aaa6d[_0x150865(0xace)]+_0x150865(0xec8)+_0x5aaa6d[_0x150865(0x28c)]:_0xbd6347[_0x150865(0xf12)]=_0x5aaa6d['content'],_0x3e9410[_0x150865(0x22f)](_0xbd6347);});}}_0x3e9410['scrollTop']=_0x3e9410[_0x38c2d2(0x624)];const _0x39003c={'start':'游戏开始','night':'第'+_0x42920c[_0x38c2d2(0xd72)]+'天\x20-\x20夜晚','day':'第'+_0x42920c[_0x38c2d2(0xd72)]+_0x38c2d2(0x36d),'discussion':'第'+_0x42920c[_0x38c2d2(0xd72)]+'天\x20-\x20讨论','voting':'第'+_0x42920c[_0x38c2d2(0xd72)]+_0x38c2d2(0x1252),'gameover':_0x38c2d2(0x3a6)};document[_0x38c2d2(0x89d)](_0x38c2d2(0xdec))[_0x38c2d2(0xf12)]=_0x38c2d2(0x62c)+(_0x39003c[_0x42920c['currentPhase']]||_0x42920c[_0x38c2d2(0xd0b)]);}function _0x1eb39b(_0x22cc1b){const _0x1e7d52=_0x41eae2,_0x187665={'狼人':_0x1e7d52(0x671),'平民':_0x1e7d52(0xdb8),'预言家':_0x1e7d52(0x373),'猎人':_0x1e7d52(0xf09),'女巫':_0x1e7d52(0x231),'守卫':_0x1e7d52(0x1325)};document[_0x1e7d52(0x89d)](_0x1e7d52(0x31a))[_0x1e7d52(0xf12)]=_0x22cc1b,document['getElementById']('werewolf-role-description')['textContent']=_0x187665[_0x22cc1b]||_0x1e7d52(0xc35),document['getElementById'](_0x1e7d52(0xa33))[_0x1e7d52(0x2f1)][_0x1e7d52(0x569)](_0x1e7d52(0x11e4));}async function _0x36c121(){const _0x82cfe=_0x41eae2;_0x42920c['currentPhase']='第'+_0x42920c[_0x82cfe(0xd72)]+_0x82cfe(0x82a),_0x42920c[_0x82cfe(0x1178)]={},_0x2fd1ad(_0x82cfe(0xe28)),_0x12aee4(),document['getElementById']('werewolf-action-bar')[_0x82cfe(0x68e)]['display']='none',document['getElementById'](_0x82cfe(0x6c1))['style'][_0x82cfe(0x126b)]='none',await new Promise(_0x5dd255=>setTimeout(_0x5dd255,0x5dc));const _0x12733c=_0x42920c[_0x82cfe(0x11ee)][_0x82cfe(0x12f4)](_0x3058c2=>_0x3058c2[_0x82cfe(0xa57)]==='守卫'&&_0x3058c2[_0x82cfe(0x5d7)]);if(_0x12733c){_0x2fd1ad(_0x82cfe(0xc67)),_0x12aee4();let _0x46f4d6=null;if(_0x12733c['id']===_0x82cfe(0x116c))_0x46f4d6=await _0x3deb51(_0x82cfe(0x385),_0x12733c[_0x82cfe(0x774)]);else{const _0x55ef03=_0x42920c['players'][_0x82cfe(0x3d8)](_0x291bef=>_0x291bef[_0x82cfe(0x5d7)]&&_0x291bef['id']!==_0x12733c[_0x82cfe(0x774)]);_0x55ef03['length']>0x0&&(_0x46f4d6=_0x55ef03[Math[_0x82cfe(0x128a)](Math[_0x82cfe(0xdc6)]()*_0x55ef03[_0x82cfe(0x7aa)])]['id']);}_0x46f4d6&&(_0x42920c[_0x82cfe(0x1178)]['guardedId']=_0x46f4d6,_0x12733c[_0x82cfe(0x774)]=_0x46f4d6),_0x2fd1ad(_0x82cfe(0xc44)),_0x12aee4(),await new Promise(_0x4e1866=>setTimeout(_0x4e1866,0x5dc));}_0x2fd1ad(_0x82cfe(0xaa7)),_0x12aee4();const _0x5c29c2=_0x42920c[_0x82cfe(0x11ee)]['filter'](_0x502b5e=>_0x502b5e['role']==='狼人'&&_0x502b5e[_0x82cfe(0x5d7)]),_0xfeedf3=_0x5c29c2[_0x82cfe(0xc5c)](_0xcc88e4=>_0xcc88e4['id']===_0x82cfe(0x116c));let _0x3d93cd=null;_0x42920c[_0x82cfe(0xc9e)]='wolfKill';try{if(_0xfeedf3)_0x2fd1ad(_0x82cfe(0x1233)),_0x12aee4(),_0x3d93cd=await _0x5d5d12();else{if(_0x42920c[_0x82cfe(0xd72)]===0x1){console['log'](_0x82cfe(0x775));const _0x4221b3=_0x42920c['players'][_0x82cfe(0x3d8)](_0x22eac7=>_0x22eac7['isAlive']&&_0x22eac7['role']!=='狼人');_0x4221b3[_0x82cfe(0x7aa)]>0x0&&(_0x3d93cd=_0x4221b3[Math[_0x82cfe(0x128a)](Math[_0x82cfe(0xdc6)]()*_0x4221b3[_0x82cfe(0x7aa)])]['id']);}else _0x3d93cd=await _0x1211da();}_0x42920c[_0x82cfe(0xc9e)]=null;}catch(_0x4b9416){console['error'](_0x82cfe(0xb47),_0x4b9416),await _0x532f76(_0x82cfe(0x10de),_0x82cfe(0x9d8)),document[_0x82cfe(0x89d)](_0x82cfe(0x6c1))['style'][_0x82cfe(0x126b)]=_0x82cfe(0x1118);return;}_0x42920c[_0x82cfe(0x1178)]['killedId']=_0x3d93cd,_0x2fd1ad(_0x82cfe(0xfc1)),_0x12aee4(),await new Promise(_0x46f30e=>setTimeout(_0x46f30e,0x5dc));const _0x4b4568=_0x42920c[_0x82cfe(0x11ee)]['find'](_0x254225=>_0x254225[_0x82cfe(0xa57)]==='女巫'&&_0x254225[_0x82cfe(0x5d7)]);if(_0x4b4568){_0x2fd1ad('女巫请睁眼。'),_0x12aee4();const _0x3bdb62=_0x42920c[_0x82cfe(0x11ee)]['find'](_0x2a1ea9=>_0x2a1ea9['id']===_0x42920c['nightActions']['killedId']),_0x5f4d75=_0x42920c[_0x82cfe(0x1178)][_0x82cfe(0x748)]===_0x42920c['nightActions'][_0x82cfe(0x4b2)],_0x1e3a19=_0x5f4d75||!_0x3bdb62?null:_0x3bdb62;if(_0x4b4568['id']===_0x82cfe(0x116c)){let _0x51bcf0=await _0x50820a(_0x1e3a19,_0x4b4568);_0x51bcf0[_0x82cfe(0x1ab)]&&(_0x42920c[_0x82cfe(0x1178)][_0x82cfe(0x920)]=_0x42920c[_0x82cfe(0x1178)][_0x82cfe(0x4b2)],_0x4b4568[_0x82cfe(0x638)]=!![]),_0x51bcf0[_0x82cfe(0x35b)]&&(_0x42920c[_0x82cfe(0x1178)][_0x82cfe(0xdaf)]=_0x51bcf0[_0x82cfe(0x35b)],_0x4b4568['poisonUsed']=!![]);}else{if(!_0x4b4568[_0x82cfe(0x638)]&&_0x1e3a19){let _0x26e0ee=0x0;_0x42920c[_0x82cfe(0xd72)]===0x1?_0x26e0ee=0.3:_0x26e0ee=0.8,console[_0x82cfe(0x471)](_0x82cfe(0xb6d)+_0x42920c[_0x82cfe(0xd72)]+_0x82cfe(0xde8)+_0x26e0ee*0x64+'%'),Math[_0x82cfe(0xdc6)]()<_0x26e0ee?(console[_0x82cfe(0x471)]('AI女巫决定使用解药！'),_0x42920c['nightActions'][_0x82cfe(0x920)]=_0x42920c['nightActions'][_0x82cfe(0x4b2)],_0x4b4568[_0x82cfe(0x638)]=!![]):console['log'](_0x82cfe(0xe0e));}if(!_0x42920c[_0x82cfe(0x1178)][_0x82cfe(0x920)]&&!_0x4b4568[_0x82cfe(0x1177)]&&Math[_0x82cfe(0xdc6)]()<0.5){const _0xa9d33d=_0x42920c['players'][_0x82cfe(0x3d8)](_0x545a83=>_0x545a83[_0x82cfe(0x5d7)]&&_0x545a83['id']!==_0x42920c[_0x82cfe(0x1178)]['killedId']);if(_0xa9d33d['length']>0x0){const _0x107376=_0xa9d33d[Math[_0x82cfe(0x128a)](Math[_0x82cfe(0xdc6)]()*_0xa9d33d[_0x82cfe(0x7aa)])];_0x42920c['nightActions']['poisonedId']=_0x107376['id'],_0x4b4568[_0x82cfe(0x1177)]=!![],console[_0x82cfe(0x471)](_0x82cfe(0x113e)+_0x107376[_0x82cfe(0xf74)]);}}}_0x2fd1ad(_0x82cfe(0xea5)),_0x12aee4(),await new Promise(_0x50a1e8=>setTimeout(_0x50a1e8,0x5dc));}const _0x3f424b=_0x42920c[_0x82cfe(0x11ee)][_0x82cfe(0x12f4)](_0x13d109=>_0x13d109[_0x82cfe(0xa57)]===_0x82cfe(0x111c)&&_0x13d109[_0x82cfe(0x5d7)]);if(_0x3f424b){_0x2fd1ad(_0x82cfe(0xbb7)),_0x12aee4();if(_0x3f424b['id']===_0x82cfe(0x116c)){const _0x4fef08=await _0x3deb51(_0x82cfe(0x7ba)),_0x4d4889=_0x42920c[_0x82cfe(0x11ee)][_0x82cfe(0x12f4)](_0x42ab48=>_0x42ab48['id']===_0x4fef08);if(_0x4d4889){const _0x36e779=_0x4d4889[_0x82cfe(0xa57)]==='狼人';await _0x532f76(_0x82cfe(0x9f3),'你查验的玩家\x20'+_0x4d4889[_0x82cfe(0xf74)]+_0x82cfe(0xed3)+(_0x36e779?'狼人':'好人')),_0x42920c[_0x82cfe(0x1178)][_0x82cfe(0x9cf)]={'target':_0x4fef08,'result':_0x36e779?'狼人':'好人'};}}else{const _0x42b439=_0x42920c[_0x82cfe(0x11ee)][_0x82cfe(0x3d8)](_0x4dace4=>_0x4dace4['isAlive']&&_0x4dace4['id']!==_0x3f424b['id']);if(_0x42b439[_0x82cfe(0x7aa)]>0x0){const _0x1dd99e=_0x42b439[Math[_0x82cfe(0x128a)](Math[_0x82cfe(0xdc6)]()*_0x42b439[_0x82cfe(0x7aa)])];_0x42920c['nightActions'][_0x82cfe(0x9cf)]={'target':_0x1dd99e['id'],'result':_0x1dd99e[_0x82cfe(0xa57)]==='狼人'?'狼人':'好人'};}}_0x2fd1ad(_0x82cfe(0x1096)),_0x12aee4(),await new Promise(_0x1bc661=>setTimeout(_0x1bc661,0x5dc));}_0x118ca6();}async function _0x118ca6(){const _0x14df60=_0x41eae2;_0x42920c[_0x14df60(0xd0b)]='第'+_0x42920c['currentDay']+_0x14df60(0x36d),_0x42920c['voteResults']={},_0x2fd1ad(_0x14df60(0x547));const {killedId:_0x28ac10,guardedId:_0x145986,savedId:_0x3ebfa0,poisonedId:_0x2deca6}=_0x42920c[_0x14df60(0x1178)],_0x1f6831=new Set();_0x28ac10&&_0x28ac10!==_0x145986&&_0x28ac10!==_0x3ebfa0&&_0x1f6831[_0x14df60(0x569)](_0x28ac10);_0x2deca6&&_0x1f6831[_0x14df60(0x569)](_0x2deca6);if(_0x1f6831[_0x14df60(0x746)]===0x0)_0x2fd1ad(_0x14df60(0xb01));else for(const _0xa77afe of _0x1f6831){const _0x45fb9c=_0x42920c[_0x14df60(0x11ee)][_0x14df60(0x12f4)](_0x3e386c=>_0x3e386c['id']===_0xa77afe);if(_0x45fb9c&&_0x45fb9c[_0x14df60(0x5d7)]){_0x45fb9c[_0x14df60(0x5d7)]=![],_0x2fd1ad('昨晚\x20'+_0x45fb9c['name']+_0x14df60(0x12e4));if(_0x45fb9c[_0x14df60(0xa57)]==='猎人'){_0x2fd1ad('猎人死亡，请选择一名玩家带走！'),_0x12aee4();let _0x5d75d8=null;if(_0x45fb9c['id']===_0x14df60(0x116c))_0x5d75d8=await _0x3deb51(_0x14df60(0xdae));else{const _0x36da2f=_0x42920c['players'][_0x14df60(0x3d8)](_0x17e627=>_0x17e627['isAlive']&&_0x17e627['id']!==_0x45fb9c['id']);_0x36da2f[_0x14df60(0x7aa)]>0x0&&(_0x5d75d8=_0x36da2f[Math[_0x14df60(0x128a)](Math['random']()*_0x36da2f[_0x14df60(0x7aa)])]['id']);}const _0x108f89=_0x42920c[_0x14df60(0x11ee)][_0x14df60(0x12f4)](_0x2c1706=>_0x2c1706['id']===_0x5d75d8);_0x108f89&&(_0x108f89['isAlive']=![],_0x2fd1ad('猎人带走了\x20'+_0x108f89['name']+'。'));}}}_0x12aee4();if(_0x44a5d6())return;await _0x1d5842();}async function _0x1d5842(){const _0x4d1b94=_0x41eae2;_0x2fd1ad(_0x4d1b94(0x4af)),_0x12aee4();const {proxyUrl:_0x39f5ec,apiKey:_0x2baaad,model:_0x5b924b}=_0x5b873d[_0x4d1b94(0x30d)];if(!_0x39f5ec||!_0x2baaad||!_0x5b924b){alert(_0x4d1b94(0x1308));return;}const _0x57fea5=_0x4aad6();_0x42920c[_0x4d1b94(0xc9e)]='startDiscussion';try{await _0x532f76(_0x4d1b94(0x7d4),_0x4d1b94(0xf4b));let _0x3348e3=_0x39f5ec[_0x4d1b94(0xced)](_0x4d1b94(0x6a6)),_0x16f387=[{'role':_0x4d1b94(0x116c),'content':'请所有AI角色根据你们的身份和人设开始发言。'}],_0x4b2364=_0xa615f4(_0x5b924b,_0x2baaad,_0x57fea5,_0x16f387);const _0x19941f=_0x3348e3?await fetch(_0x4b2364[_0x4d1b94(0x11de)],_0x4b2364[_0x4d1b94(0xd98)]):await fetch(_0x39f5ec+_0x4d1b94(0x6dd),{'method':_0x4d1b94(0xd14),'headers':{'Content-Type':'application/json','Authorization':_0x4d1b94(0x3fb)+_0x2baaad},'body':JSON[_0x4d1b94(0x465)]({'model':_0x5b924b,'messages':[{'role':_0x4d1b94(0x18c),'content':_0x57fea5},..._0x16f387],'temperature':_0x5b873d[_0x4d1b94(0x21a)][_0x4d1b94(0x576)]||0.95})});if(!_0x19941f['ok']){const _0x54e4b9=await _0x19941f['json']();throw new Error(_0x4d1b94(0x10d8)+_0x54e4b9[_0x4d1b94(0x1fd)][_0x4d1b94(0x1288)]);}const _0x1af972=await _0x19941f[_0x4d1b94(0x6b5)](),_0x2ac5ec=getGeminiResponseText(_0x1af972),_0x349f14=_0x2ac5ec[_0x4d1b94(0x86c)](/(\[[\s\S]*\])/);if(!_0x349f14)throw new Error(_0x4d1b94(0x1ee)+_0x2ac5ec);const _0x5bf2ee=JSON[_0x4d1b94(0x2cb)](_0x349f14[0x0]);for(const _0x2d2e48 of _0x5bf2ee){_0x2d2e48[_0x4d1b94(0x1187)]&&_0x2d2e48[_0x4d1b94(0xa03)]&&(_0x70a9b9(_0x2d2e48[_0x4d1b94(0x1187)],_0x2d2e48[_0x4d1b94(0xa03)]),_0x12aee4(),await new Promise(_0x346006=>setTimeout(_0x346006,0x5dc+Math['random']()*0x7d0)));}_0x42920c[_0x4d1b94(0xc9e)]=null;}catch(_0x410a38){console[_0x4d1b94(0x1fd)](_0x4d1b94(0xa6f),_0x410a38),await _0x532f76(_0x4d1b94(0x267),_0x4d1b94(0xe3d)+_0x410a38[_0x4d1b94(0x1288)]),document['getElementById'](_0x4d1b94(0x6c1))['style'][_0x4d1b94(0x126b)]='block';return;}const _0x575e8d=_0x42920c[_0x4d1b94(0x11ee)]['find'](_0x5da55d=>_0x5da55d['id']===_0x4d1b94(0x116c)),_0x21c6b6=document[_0x4d1b94(0x89d)](_0x4d1b94(0x913)),_0x3947c6=document[_0x4d1b94(0x89d)](_0x4d1b94(0x12af)),_0x391155=document['getElementById'](_0x4d1b94(0x201)),_0x17dc58=document[_0x4d1b94(0x89d)](_0x4d1b94(0xa85));_0x21c6b6[_0x4d1b94(0x68e)][_0x4d1b94(0x126b)]=_0x4d1b94(0x66e);if(_0x575e8d&&_0x575e8d['isAlive']){_0x3947c6[_0x4d1b94(0xf12)]='等待回应',_0x391155[_0x4d1b94(0xf12)]=_0x4d1b94(0x695),_0x3947c6[_0x4d1b94(0x68e)][_0x4d1b94(0x126b)]=_0x4d1b94(0x1118),_0x391155[_0x4d1b94(0x68e)][_0x4d1b94(0x126b)]=_0x4d1b94(0x1118),_0x17dc58[_0x4d1b94(0x3f7)]=![],_0x17dc58[_0x4d1b94(0xe4f)]=_0x4d1b94(0x202),_0x17dc58['focus']();const _0x41facb=_0x3947c6[_0x4d1b94(0xf2a)](!![]);_0x3947c6[_0x4d1b94(0xb6e)][_0x4d1b94(0xd38)](_0x41facb,_0x3947c6),_0x41facb[_0x4d1b94(0x1193)](_0x4d1b94(0x12a5),_0x4d7c0e);const _0x530776=_0x391155[_0x4d1b94(0xf2a)](!![]);_0x391155[_0x4d1b94(0xb6e)][_0x4d1b94(0xd38)](_0x530776,_0x391155),_0x530776[_0x4d1b94(0x1193)](_0x4d1b94(0x12a5),_0x3a064e);}else{_0x2fd1ad(_0x4d1b94(0x1c8)),_0x12aee4(),_0x3947c6[_0x4d1b94(0xf12)]='继续讨论',_0x391155[_0x4d1b94(0xf12)]=_0x4d1b94(0x7e0),_0x3947c6[_0x4d1b94(0x68e)][_0x4d1b94(0x126b)]=_0x4d1b94(0x1118),_0x391155[_0x4d1b94(0x68e)][_0x4d1b94(0x126b)]=_0x4d1b94(0x1118),_0x17dc58['disabled']=!![],_0x17dc58[_0x4d1b94(0xe4f)]='你已死亡，正在围观...';const _0x339e6e=_0x3947c6[_0x4d1b94(0xf2a)](!![]);_0x3947c6[_0x4d1b94(0xb6e)][_0x4d1b94(0xd38)](_0x339e6e,_0x3947c6),_0x339e6e[_0x4d1b94(0x1193)](_0x4d1b94(0x12a5),_0x344c8d);const _0x468b80=_0x391155[_0x4d1b94(0xf2a)](!![]);_0x391155['parentNode']['replaceChild'](_0x468b80,_0x391155),_0x468b80['addEventListener'](_0x4d1b94(0x12a5),_0x31345e);}}function _0x4aad6(){const _0x45093f=_0x41eae2,_0x30688b=_0x42920c[_0x45093f(0x11ee)][_0x45093f(0x3d8)](_0x42ddcc=>_0x42ddcc[_0x45093f(0x5d7)]),_0x572e97=_0x42920c['players'][_0x45093f(0x12f4)](_0x589b3d=>_0x589b3d['id']==='user'),_0x5581ee=_0x572e97?_0x572e97['name']:'用户',_0x20e141=_0x30688b[_0x45093f(0xc5c)](_0x55e31e=>_0x55e31e['id']===_0x45093f(0x116c));let _0x2608d1='#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a';_0x30688b['forEach']((_0x17b2a8,_0x302ad6)=>{const _0x1ae859=_0x45093f,_0x937ff3=_0x42920c[_0x1ae859(0x11ee)][_0x1ae859(0x9d7)](_0xbbde0=>_0xbbde0['id']===_0x17b2a8['id'])+0x1;_0x2608d1+=_0x1ae859(0x5ee)+_0x937ff3+_0x1ae859(0x986)+_0x17b2a8[_0x1ae859(0xf74)]+_0x1ae859(0xadc)+_0x17b2a8[_0x1ae859(0x1045)]+_0x1ae859(0x6d0)+(_0x17b2a8['id']==='user'?_0x1ae859(0x945):_0x1ae859(0x1155))+_0x1ae859(0x4bd)+_0x17b2a8[_0x1ae859(0x965)]+'\x0a';if(_0x17b2a8[_0x1ae859(0x48c)]===_0x1ae859(0x132a)){const _0x5ce792=_0x5b873d['chats'][_0x17b2a8['id']];if(_0x5ce792&&_0x5ce792[_0x1ae859(0xc18)]&&_0x5ce792[_0x1ae859(0xc18)][_0x1ae859(0x7aa)]>0x0){const _0x44adc8=_0x5ce792['longTermMemory']['map'](_0x20ae04=>_0x20ae04[_0x1ae859(0x28c)])[_0x1ae859(0x1237)](';\x20');_0x2608d1+=_0x1ae859(0xbd3)+_0x44adc8+'\x0a';}}});let _0x21821f=_0x45093f(0x8ab);const _0x364f86=_0x42920c[_0x45093f(0xf99)][_0x45093f(0x3d8)](_0x150e92=>_0x150e92[_0x45093f(0x28c)][_0x45093f(0xced)](_0x45093f(0xd2d))&&_0x150e92[_0x45093f(0xb5e)]===_0x42920c[_0x45093f(0xd72)]);_0x364f86[_0x45093f(0x7aa)]===0x0?_0x21821f+=_0x45093f(0x294):_0x364f86[_0x45093f(0xd9a)](_0x936fe6=>{_0x21821f+='-\x20'+_0x936fe6['content']+'\x0a';});let _0x2d0857=_0x45093f(0xaf2);if(_0x42920c[_0x45093f(0xd72)]>0x1)for(let _0x13c354=0x1;_0x13c354<_0x42920c[_0x45093f(0xd72)];_0x13c354++){_0x2d0857+=_0x45093f(0x68b)+_0x13c354+_0x45093f(0xb8b);const _0x32f279=_0x42920c['gameLog'][_0x45093f(0x3d8)](_0x50b2f0=>_0x50b2f0[_0x45093f(0xb5e)]===_0x13c354&&(_0x50b2f0[_0x45093f(0x28c)]['includes']('死亡')||_0x50b2f0[_0x45093f(0x28c)][_0x45093f(0xced)]('放逐')));_0x32f279[_0x45093f(0x7aa)]>0x0?_0x2d0857+=_0x45093f(0x1158)+_0x32f279['map'](_0x198973=>_0x198973[_0x45093f(0x28c)])[_0x45093f(0x1237)]('\x20')+'\x0a':_0x2d0857+='*事件*:\x20平安夜，无人出局。\x0a';const _0x20432d=_0x42920c[_0x45093f(0x1091)][_0x45093f(0x3d8)](_0x13f82a=>_0x13f82a['day']===_0x13c354);_0x20432d[_0x45093f(0x7aa)]>0x0&&(_0x2d0857+=_0x45093f(0xd25)+_0x20432d['map'](_0x308c15=>'-\x20'+_0x308c15['speaker']+':\x20'+_0x308c15[_0x45093f(0x28c)])[_0x45093f(0x1237)]('\x0a')+'\x0a');}else _0x2d0857+=_0x45093f(0x1082);let _0x39e4a8='###\x20你的秘密信息\x20(此部分只有你作为AI导演能看到)\x0a';_0x30688b[_0x45093f(0xd9a)](_0x3979d6=>{const _0x3d6162=_0x45093f;if(_0x3979d6['id']!==_0x3d6162(0x116c)){_0x39e4a8+=_0x3d6162(0x6b2)+_0x3979d6[_0x3d6162(0xf74)]+'的秘密档案：\x0a-\x20你的狼人杀身份是：【'+_0x3979d6[_0x3d6162(0xa57)]+'】\x0a';if(_0x3979d6[_0x3d6162(0xa57)]==='狼人'){const _0x4d0064=_0x42920c['players']['filter'](_0x5b3f5e=>_0x5b3f5e[_0x3d6162(0xa57)]==='狼人'&&_0x5b3f5e['id']!==_0x3979d6['id'])['map'](_0x20aae1=>_0x20aae1[_0x3d6162(0xf74)])[_0x3d6162(0x1237)]('、');_0x39e4a8+=_0x3d6162(0xff1)+(_0x4d0064||'无')+'\x0a';const _0x47c958=_0x42920c['players']['find'](_0x4e62ce=>_0x4e62ce['id']===_0x42920c[_0x3d6162(0x1178)]['killedId']);_0x39e4a8+=_0x3d6162(0x11c1)+(_0x47c958?_0x47c958[_0x3d6162(0xf74)]:'空刀')+'\x0a';}if(_0x3979d6[_0x3d6162(0xa57)]==='预言家'&&_0x42920c[_0x3d6162(0x1178)]['prophetCheck']){const _0x42452f=_0x42920c[_0x3d6162(0x11ee)][_0x3d6162(0x12f4)](_0x5258b7=>_0x5258b7['id']===_0x42920c[_0x3d6162(0x1178)][_0x3d6162(0x9cf)]['target']);_0x39e4a8+='-\x20你昨晚查验了\x20'+_0x42452f[_0x3d6162(0xf74)]+'，TA的身份是：【'+_0x42920c[_0x3d6162(0x1178)][_0x3d6162(0x9cf)]['result']+'】\x0a';}if(_0x3979d6[_0x3d6162(0xa57)]==='女巫'){if(_0x42920c[_0x3d6162(0x1178)][_0x3d6162(0x920)]){const _0x115893=_0x42920c['players'][_0x3d6162(0x12f4)](_0x383a85=>_0x383a85['id']===_0x42920c[_0x3d6162(0x1178)][_0x3d6162(0x920)]);_0x39e4a8+=_0x3d6162(0x1054)+_0x115893[_0x3d6162(0xf74)]+'。\x0a';}if(_0x42920c['nightActions']['poisonedId']){const _0x2ecdbb=_0x42920c[_0x3d6162(0x11ee)][_0x3d6162(0x12f4)](_0x3b1af9=>_0x3b1af9['id']===_0x42920c[_0x3d6162(0x1178)][_0x3d6162(0xdaf)]);_0x39e4a8+=_0x3d6162(0x85b)+_0x2ecdbb[_0x3d6162(0xf74)]+'。\x0a';}_0x39e4a8+=_0x3d6162(0x452)+(_0x3979d6[_0x3d6162(0x638)]?_0x3d6162(0xdb5):_0x3d6162(0xaa1))+'\x0a',_0x39e4a8+=_0x3d6162(0xf08)+(_0x3979d6[_0x3d6162(0x1177)]?_0x3d6162(0xdb5):_0x3d6162(0xaa1))+'\x0a';}if(_0x3979d6[_0x3d6162(0xa57)]==='守卫'){if(_0x42920c[_0x3d6162(0x1178)][_0x3d6162(0x748)]){const _0x491425=_0x42920c['players'][_0x3d6162(0x12f4)](_0x2cef92=>_0x2cef92['id']===_0x42920c[_0x3d6162(0x1178)][_0x3d6162(0x748)]);_0x39e4a8+=_0x3d6162(0x72c)+_0x491425[_0x3d6162(0xf74)]+'。\x0a';}else _0x39e4a8+=_0x3d6162(0xd51);}_0x39e4a8+='\x0a';}});let _0x48fb79=_0x45093f(0x11e1);const _0x23521b=_0x42920c[_0x45093f(0x1091)][_0x45093f(0x3d8)](_0x30cf22=>_0x30cf22[_0x45093f(0xb5e)]===_0x42920c['currentDay']);_0x23521b['length']>0x0?_0x48fb79+=_0x23521b[_0x45093f(0x412)](_0x143cf0=>'-\x20**'+_0x143cf0[_0x45093f(0xace)]+_0x45093f(0xdc9)+_0x143cf0[_0x45093f(0x28c)])[_0x45093f(0x1237)]('\x0a'):_0x48fb79+='(你是第一个发言的人)';const _0x318e66='\x0a#\x20你的任务\x0a你是一个狼人杀游戏导演。你的任务是扮演【除了'+(_0x20e141?_0x45093f(0x622)+_0x5581ee+')':_0x45093f(0x649)+_0x5581ee+')')+'以外】的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a'+_0x2608d1+_0x45093f(0xb3a)+(_0x42920c[_0x45093f(0x5ac)]===_0x45093f(0x724)?'屠边局：狼人杀死所有神职或所有平民即获胜。':'屠城局：狼人杀死所有好人即获胜。')+_0x45093f(0xbcb)+_0x42920c[_0x45093f(0xd72)]+_0x45093f(0x12a7)+_0x21821f+_0x45093f(0x4e9)+_0x30688b[_0x45093f(0x412)](_0xbd73f5=>_0xbd73f5[_0x45093f(0xf74)]+'\x20('+(_0xbd73f5['id']===_0x45093f(0x116c)?'用户':'AI')+')')[_0x45093f(0x1237)](',\x20')+_0x45093f(0x28b)+_0x5581ee+'\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a\x0a//\x20【核心修改2】明确了JSON格式中\x20speaker_name\x20和对话中称呼的不同要求\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20'+_0x2d0857+_0x45093f(0x971)+_0x48fb79+'\x0a\x0a'+_0x39e4a8+_0x45093f(0x374);return _0x318e66;}function _0x1dc526(_0x29f2a0){const _0x55b2b8=_0x41eae2;let _0x55f7d6=_0x55b2b8(0xb3b);const _0x437ee7=_0x29f2a0['gameLog']['find'](_0x12a9db=>_0x12a9db[_0x55b2b8(0x28c)][_0x55b2b8(0xced)]('胜利'))?.[_0x55b2b8(0x28c)]||'胜负未分';_0x55f7d6+=_0x55b2b8(0xb34)+_0x437ee7+'\x0a\x0a',_0x55f7d6+=_0x55b2b8(0x55a),_0x29f2a0[_0x55b2b8(0x11ee)][_0x55b2b8(0xd9a)](_0x14c5a6=>{const _0x1a8b2f=_0x55b2b8,_0x5e1f06=_0x14c5a6[_0x1a8b2f(0x5d7)]?'存活':'已死亡';_0x55f7d6+='-\x20'+_0x14c5a6[_0x1a8b2f(0xf74)]+':\x20'+_0x14c5a6[_0x1a8b2f(0xa57)]+'\x20('+_0x5e1f06+')\x0a';}),_0x55f7d6+='\x0a###\x20详细对局流程:\x0a';for(let _0x5324c4=0x1;_0x5324c4<=_0x29f2a0[_0x55b2b8(0xd72)];_0x5324c4++){_0x55f7d6+='\x0a**---\x20第\x20'+_0x5324c4+_0x55b2b8(0xb8b);const _0x22a255=_0x29f2a0[_0x55b2b8(0xf99)][_0x55b2b8(0x3d8)](_0x5a528e=>_0x5a528e[_0x55b2b8(0xb5e)]===_0x5324c4&&_0x5a528e['content'][_0x55b2b8(0xced)]('死亡'));if(_0x22a255[_0x55b2b8(0x7aa)]>0x0)_0x55f7d6+=_0x55b2b8(0x16b)+_0x22a255['map'](_0x3b50b0=>_0x3b50b0[_0x55b2b8(0x28c)])['join']('\x20')+'\x0a';else(_0x5324c4>0x1||_0x5324c4===0x1&&_0x29f2a0[_0x55b2b8(0xd72)]>0x1)&&(_0x55f7d6+=_0x55b2b8(0xc0d));const _0x2bb3f3=_0x29f2a0['discussionLog'][_0x55b2b8(0x3d8)](_0x1f8882=>_0x1f8882[_0x55b2b8(0xb5e)]===_0x5324c4);_0x2bb3f3[_0x55b2b8(0x7aa)]>0x0&&(_0x55f7d6+=_0x55b2b8(0x8b2)+_0x2bb3f3[_0x55b2b8(0x412)](_0xacab=>'-\x20'+_0xacab[_0x55b2b8(0xace)]+':\x20'+_0xacab[_0x55b2b8(0x28c)])['join']('\x0a')+'\x0a');const _0x513786=_0x29f2a0[_0x55b2b8(0xf99)][_0x55b2b8(0x12f4)](_0x185cf2=>_0x185cf2[_0x55b2b8(0xb5e)]===_0x5324c4&&_0x185cf2['content'][_0x55b2b8(0xced)](_0x55b2b8(0x1076)));_0x513786&&(_0x55f7d6+=_0x55b2b8(0x11d8)+_0x513786[_0x55b2b8(0x28c)]+'\x0a');}return _0x55f7d6+=_0x55b2b8(0xea8),_0x55f7d6;}async function _0x236398(_0xae95f4){const _0x5da86a=_0x41eae2;let _0x16f0cf=0x0;for(const _0x3cfee6 of _0x42920c[_0x5da86a(0x11ee)]){if(_0x3cfee6['type']===_0x5da86a(0x132a)){const _0x427ef6=_0x5b873d[_0x5da86a(0x667)][_0x3cfee6['id']];if(_0x427ef6){const _0x5913a9={'content':_0xae95f4,'timestamp':Date['now'](),'source':'werewolf_summary'};!_0x427ef6[_0x5da86a(0xc18)]&&(_0x427ef6[_0x5da86a(0xc18)]=[]),_0x427ef6[_0x5da86a(0xc18)][_0x5da86a(0x138c)](_0x5913a9),await _0x1a6951[_0x5da86a(0x667)]['put'](_0x427ef6),_0x16f0cf++;}}}return _0x16f0cf;}async function _0x3f146d(){const _0x34b728=_0x41eae2;if(!_0x42920c[_0x34b728(0xfcb)]&&_0x42920c[_0x34b728(0xd0b)]===_0x34b728(0x8ca)){await _0x532f76(_0x34b728(0xb6a),_0x34b728(0x1262));try{const _0xcb6e06=_0x1dc526(_0x42920c),_0x1669b1=await _0x236398(_0xcb6e06);await _0x532f76('成功',_0x34b728(0x1359)+_0x1669b1+_0x34b728(0x583));}catch(_0x6abcbb){console['error'](_0x34b728(0xc42),_0x6abcbb),await _0x532f76('失败',_0x34b728(0x7b2)+_0x6abcbb[_0x34b728(0x1288)]);}}else alert(_0x34b728(0x41a));}async function _0x1f3d8a(_0x1f12b9){const _0x43967a=_0x41eae2;_0x42920c[_0x43967a(0xfcb)]=![],_0x42920c['currentPhase']='gameover',_0x2fd1ad(_0x1f12b9+'阵营胜利！'),document[_0x43967a(0x89d)](_0x43967a(0x784))['textContent']=_0x1f12b9+_0x43967a(0xdde);let _0x5233a3='';_0x1f12b9==='好人'?_0x5233a3=_0x43967a(0x1031):_0x5233a3=_0x43967a(0x577);const _0x262f38=document['getElementById'](_0x43967a(0x98a));_0x262f38[_0x43967a(0xf12)]=_0x5233a3;const _0x2a1b82=document[_0x43967a(0x89d)](_0x43967a(0xeee));_0x2a1b82[_0x43967a(0x1ef)]='';const _0x273579=[..._0x42920c['players']][_0x43967a(0x2e3)]((_0x40c568,_0x448ddf)=>{const _0x418674=_0x43967a,_0x38ba97=_0x42920c[_0x418674(0x11ee)][_0x418674(0x9d7)](_0x1fe0b6=>_0x1fe0b6['id']===_0x40c568['id']),_0x3a7334=_0x42920c[_0x418674(0x11ee)]['findIndex'](_0x1d67d1=>_0x1d67d1['id']===_0x448ddf['id']);return _0x38ba97-_0x3a7334;});_0x273579[_0x43967a(0xd9a)]((_0x4a5042,_0x35f208)=>{const _0x2a63db=_0x43967a,_0x459972=document[_0x2a63db(0x285)](_0x2a63db(0xb25));_0x459972['style'][_0x2a63db(0x137a)]='display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;';if(_0x35f208===_0x273579[_0x2a63db(0x7aa)]-0x1)_0x459972['style'][_0x2a63db(0x652)]='none';const _0x4d08b9=_0x4a5042[_0x2a63db(0xa57)]==='狼人'?'#ff4d4d':'#52c41a';_0x459972[_0x2a63db(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x4a5042[_0x2a63db(0x12c8)]+_0x2a63db(0x1ec)+(_0x4a5042['isAlive']?_0x2a63db(0x10f2):'grayscale(100%)')+';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20'+(_0x4a5042['isAlive']?_0x2a63db(0x10f2):_0x2a63db(0x1e9))+_0x2a63db(0x556)+(_0x35f208+0x1)+'.\x20'+_0x4a5042['name']+_0x2a63db(0xddc)+_0x4d08b9+_0x2a63db(0x556)+_0x4a5042[_0x2a63db(0xa57)]+'</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2a1b82['appendChild'](_0x459972);}),document[_0x43967a(0x89d)](_0x43967a(0xb46))[_0x43967a(0x2f1)][_0x43967a(0x569)](_0x43967a(0x11e4));try{console[_0x43967a(0x471)](_0x43967a(0x850));const _0x3d201a=_0x1dc526(_0x42920c),_0x4845df=await generateAndInjectWerewolfMemories(_0x3d201a);console['log'](_0x43967a(0x12b7)+_0x4845df+_0x43967a(0x135a));}catch(_0x12bb4c){console[_0x43967a(0x1fd)](_0x43967a(0xc1f),_0x12bb4c),_0x262f38&&(_0x262f38[_0x43967a(0x1ef)]+=_0x43967a(0x37e));}}function _0x2fd1ad(_0x53f8c2){const _0x50071d=_0x41eae2;_0x42920c[_0x50071d(0xf99)][_0x50071d(0x138c)]({'type':_0x50071d(0x18c),'content':_0x53f8c2,'timestamp':Date[_0x50071d(0xf1a)](),'day':_0x42920c[_0x50071d(0xd72)]});}function _0x70a9b9(_0x3afe7f,_0x4290e4){const _0xba4944=_0x41eae2;_0x42920c['discussionLog'][_0xba4944(0x138c)]({'type':'dialogue','speaker':_0x3afe7f,'content':_0x4290e4,'timestamp':Date[_0xba4944(0xf1a)](),'day':_0x42920c[_0xba4944(0xd72)]});}function _0x3deb51(_0x51afbc){return new Promise(_0x4c0ea1=>{const _0x1aabbb=_0x356e,_0x401e38=_0x1aabbb(0x342)+_0x51afbc+'-modal',_0x2ca3d5=_0x1aabbb(0x342)+_0x51afbc+_0x1aabbb(0x8a8);let _0x148d89='';if(_0x51afbc===_0x1aabbb(0x7ba))_0x148d89=_0x1aabbb(0x63c);if(_0x51afbc===_0x1aabbb(0xdae))_0x148d89=_0x1aabbb(0x41c);if(_0x51afbc===_0x1aabbb(0x12b3))_0x148d89=_0x1aabbb(0xa09);const _0x38c198=document[_0x1aabbb(0x89d)](_0x401e38),_0x2e9cfe=document['getElementById'](_0x2ca3d5),_0xa081e7=document[_0x1aabbb(0x89d)](_0x148d89);_0x2e9cfe[_0x1aabbb(0x1ef)]='';let _0x2c307c=null;const _0x4de316=_0x42920c['players'][_0x1aabbb(0x3d8)](_0x2abc27=>_0x2abc27[_0x1aabbb(0x5d7)]&&(_0x51afbc==='hunter'||_0x51afbc===_0x1aabbb(0x12b3)||_0x2abc27['id']!==_0x1aabbb(0x116c)));_0x4de316[_0x1aabbb(0xd9a)](_0xc24729=>{const _0x3eb5a8=_0x1aabbb,_0x11ce52=document[_0x3eb5a8(0x285)](_0x3eb5a8(0xb25));_0x11ce52[_0x3eb5a8(0x81c)]=_0x3eb5a8(0x41f),_0x11ce52[_0x3eb5a8(0xaaf)]['id']=_0xc24729['id'],_0x11ce52[_0x3eb5a8(0x1ef)]='<img\x20src=\x22'+_0xc24729[_0x3eb5a8(0x12c8)]+_0x3eb5a8(0xbce)+_0xc24729['name']+_0x3eb5a8(0x5ec),_0x11ce52[_0x3eb5a8(0x108b)]=()=>{const _0x17557a=_0x3eb5a8;_0x2e9cfe[_0x17557a(0x35f)](_0x17557a(0xe1d))[_0x17557a(0xd9a)](_0x252604=>_0x252604['classList']['remove'](_0x17557a(0x335))),_0x11ce52[_0x17557a(0x2f1)]['add'](_0x17557a(0x335)),_0x2c307c=_0xc24729['id'];},_0x2e9cfe['appendChild'](_0x11ce52);});const _0x13388c=_0xa081e7[_0x1aabbb(0xf2a)](!![]);_0xa081e7[_0x1aabbb(0xb6e)][_0x1aabbb(0xd38)](_0x13388c,_0xa081e7),_0x13388c[_0x1aabbb(0x108b)]=()=>{const _0x5dc829=_0x1aabbb;_0x2c307c?(_0x38c198[_0x5dc829(0x2f1)][_0x5dc829(0x1247)](_0x5dc829(0x11e4)),_0x4c0ea1(_0x2c307c)):alert(_0x5dc829(0x126c));},_0x38c198[_0x1aabbb(0x2f1)][_0x1aabbb(0x569)](_0x1aabbb(0x11e4));});}function _0x5d5d12(){return new Promise(_0x119343=>{const _0x391515=_0x356e,_0x79a7fe=document[_0x391515(0x89d)](_0x391515(0x47f)),_0x3d9fe0=document[_0x391515(0x89d)](_0x391515(0xc9d)),_0x18d93e=document['getElementById']('confirm-wolf-kill-btn'),_0x27152b=_0x79a7fe[_0x391515(0xd16)](_0x391515(0x61b)),_0x2a4e4b=_0x42920c[_0x391515(0x11ee)]['filter'](_0x4ab870=>_0x4ab870[_0x391515(0xa57)]==='狼人'&&_0x4ab870[_0x391515(0x5d7)]),_0x2905ae=_0x2a4e4b[_0x391515(0x3d8)](_0x260b0d=>_0x260b0d['id']!=='user')[_0x391515(0x412)](_0x55bdf0=>_0x55bdf0[_0x391515(0xf74)])[_0x391515(0x1237)]('、');_0x2905ae?_0x27152b[_0x391515(0x1ef)]=_0x391515(0x1250)+_0x2905ae+_0x391515(0x2a2):_0x27152b[_0x391515(0xf12)]=_0x391515(0x34b);_0x3d9fe0[_0x391515(0x1ef)]='';let _0x2e1dcb=null;const _0x2d6d3d=_0x42920c['players'][_0x391515(0x3d8)](_0xb290f4=>_0xb290f4[_0x391515(0x5d7)]&&_0xb290f4[_0x391515(0xa57)]!=='狼人');_0x2d6d3d[_0x391515(0xd9a)](_0x11f395=>{const _0x7d37eb=_0x391515,_0x44b34c=document[_0x7d37eb(0x285)](_0x7d37eb(0xb25));_0x44b34c[_0x7d37eb(0x81c)]=_0x7d37eb(0x41f),_0x44b34c['dataset']['id']=_0x11f395['id'],_0x44b34c[_0x7d37eb(0x1ef)]=_0x7d37eb(0x477)+_0x11f395[_0x7d37eb(0x12c8)]+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0x11f395[_0x7d37eb(0xf74)]+_0x7d37eb(0x5ec),_0x44b34c[_0x7d37eb(0x108b)]=()=>{const _0xd370ef=_0x7d37eb;_0x3d9fe0[_0xd370ef(0x35f)]('.selected')['forEach'](_0xfe6d16=>_0xfe6d16[_0xd370ef(0x2f1)][_0xd370ef(0x1247)]('selected')),_0x44b34c[_0xd370ef(0x2f1)][_0xd370ef(0x569)]('selected'),_0x2e1dcb=_0x11f395['id'];},_0x3d9fe0[_0x7d37eb(0x22f)](_0x44b34c);});const _0x1f152e=_0x18d93e[_0x391515(0xf2a)](!![]);_0x18d93e[_0x391515(0xb6e)][_0x391515(0xd38)](_0x1f152e,_0x18d93e),_0x1f152e[_0x391515(0x108b)]=()=>{const _0x4d3110=_0x391515;_0x2e1dcb?(_0x79a7fe[_0x4d3110(0x2f1)][_0x4d3110(0x1247)](_0x4d3110(0x11e4)),_0x119343(_0x2e1dcb)):alert(_0x4d3110(0x126c));},_0x79a7fe[_0x391515(0x2f1)][_0x391515(0x569)](_0x391515(0x11e4));});}function _0x3a064e(){const _0x6ba53=_0x41eae2,_0x572bea=_0x42920c['players']['find'](_0x356482=>_0x356482['id']===_0x6ba53(0x116c));if(!_0x572bea||!_0x572bea[_0x6ba53(0x5d7)])return;const _0x32c55f=document['getElementById'](_0x6ba53(0xa85)),_0x5b1b0a=_0x32c55f[_0x6ba53(0x2f4)]['trim']();_0x5b1b0a&&(_0x70a9b9(_0x572bea[_0x6ba53(0xf74)],_0x5b1b0a),_0x12aee4()),document[_0x6ba53(0x89d)](_0x6ba53(0x913))[_0x6ba53(0x68e)][_0x6ba53(0x126b)]=_0x6ba53(0x10f2),_0x32c55f[_0x6ba53(0x2f4)]='',_0x31345e();}async function _0x344c8d(){const _0x3ada21=_0x41eae2;_0x2fd1ad(_0x3ada21(0xdb4)),_0x12aee4();const _0x8cdb63=document[_0x3ada21(0x89d)](_0x3ada21(0x12af));if(_0x8cdb63)_0x8cdb63[_0x3ada21(0x3f7)]=!![];await _0x532f76(_0x3ada21(0x7d4),_0x3ada21(0xf19));const {proxyUrl:_0x3318d0,apiKey:_0x1673b2,model:_0x3f89a3}=_0x5b873d['apiConfig'];if(!_0x3318d0||!_0x1673b2||!_0x3f89a3){alert(_0x3ada21(0x1308));return;}const _0x36f405=_0x4aad6();try{let _0x2bbb79=_0x3318d0[_0x3ada21(0xced)](_0x3ada21(0x6a6)),_0x475f4a=[{'role':'user','content':_0x3ada21(0x131e)}],_0x3da629=_0xa615f4(_0x3f89a3,_0x1673b2,_0x36f405,_0x475f4a);const _0x2a94c6=_0x2bbb79?await fetch(_0x3da629[_0x3ada21(0x11de)],_0x3da629[_0x3ada21(0xd98)]):await fetch(_0x3318d0+_0x3ada21(0x6dd),{'method':_0x3ada21(0xd14),'headers':{'Content-Type':'application/json','Authorization':_0x3ada21(0x3fb)+_0x1673b2},'body':JSON[_0x3ada21(0x465)]({'model':_0x3f89a3,'messages':[{'role':_0x3ada21(0x18c),'content':_0x36f405},..._0x475f4a],'temperature':_0x5b873d[_0x3ada21(0x21a)][_0x3ada21(0x576)]||0.9})});if(!_0x2a94c6['ok']){const _0x2d1fb7=await _0x2a94c6['json']();throw new Error(_0x3ada21(0x10d8)+_0x2d1fb7['error'][_0x3ada21(0x1288)]);}const _0x105353=await _0x2a94c6[_0x3ada21(0x6b5)](),_0x415baf=getGeminiResponseText(_0x105353),_0x251cbf=_0x415baf['match'](/(\[[\s\S]*\])/);if(!_0x251cbf)throw new Error(_0x3ada21(0x9a1)+_0x415baf);const _0x12dc56=JSON[_0x3ada21(0x2cb)](_0x251cbf[0x0]);for(const _0x3ffe5f of _0x12dc56){_0x3ffe5f[_0x3ada21(0x1187)]&&_0x3ffe5f[_0x3ada21(0xa03)]&&(_0x70a9b9(_0x3ffe5f[_0x3ada21(0x1187)],_0x3ffe5f[_0x3ada21(0xa03)]),_0x12aee4(),await new Promise(_0x167da3=>setTimeout(_0x167da3,0x5dc+Math[_0x3ada21(0xdc6)]()*0x7d0)));}}catch(_0x20160f){console['error'](_0x3ada21(0xda9),_0x20160f),await _0x532f76(_0x3ada21(0x267),_0x3ada21(0x12b6)+_0x20160f[_0x3ada21(0x1288)]);}finally{if(_0x8cdb63)_0x8cdb63[_0x3ada21(0x3f7)]=![];}}async function _0x4d7c0e(){const _0x26d7ad=_0x41eae2,_0x476128=_0x42920c[_0x26d7ad(0x11ee)][_0x26d7ad(0x12f4)](_0x4f88c2=>_0x4f88c2['id']===_0x26d7ad(0x116c));if(!_0x476128||!_0x476128['isAlive']){console[_0x26d7ad(0xac3)]('handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。');return;}const _0x5d9190=document[_0x26d7ad(0x89d)](_0x26d7ad(0xa85)),_0x2931c9=_0x5d9190[_0x26d7ad(0x2f4)]['trim']();if(!_0x2931c9){alert(_0x26d7ad(0x1387));return;}_0x70a9b9(_0x476128[_0x26d7ad(0xf74)],_0x2931c9),_0x12aee4(),_0x5d9190[_0x26d7ad(0x2f4)]='',await _0x532f76(_0x26d7ad(0x7d4),_0x26d7ad(0x1349));const {proxyUrl:_0x582032,apiKey:_0x71fee0,model:_0x2f0d05}=_0x5b873d[_0x26d7ad(0x30d)];if(!_0x582032||!_0x71fee0||!_0x2f0d05){alert('API未配置，无法生成对话。');return;}const _0x3e45dd=_0x4aad6();try{let _0x1f2cdc=_0x582032[_0x26d7ad(0xced)](_0x26d7ad(0x6a6)),_0x3b8ea0=[{'role':_0x26d7ad(0x116c),'content':'现在，请所有AI角色针对刚刚的发言（特别是\x27'+_0x476128[_0x26d7ad(0xf74)]+'\x27的发言）继续进行讨论。'}],_0x24c2ac=_0xa615f4(_0x2f0d05,_0x71fee0,_0x3e45dd,_0x3b8ea0);const _0x23bf7c=_0x1f2cdc?await fetch(_0x24c2ac[_0x26d7ad(0x11de)],_0x24c2ac[_0x26d7ad(0xd98)]):await fetch(_0x582032+_0x26d7ad(0x6dd),{'method':'POST','headers':{'Content-Type':_0x26d7ad(0xce4),'Authorization':_0x26d7ad(0x3fb)+_0x71fee0},'body':JSON[_0x26d7ad(0x465)]({'model':_0x2f0d05,'messages':[{'role':_0x26d7ad(0x18c),'content':_0x3e45dd},..._0x3b8ea0],'temperature':_0x5b873d[_0x26d7ad(0x21a)]['apiTemperature']||0.9})});if(!_0x23bf7c['ok']){const _0x2222b4=await _0x23bf7c[_0x26d7ad(0x6b5)]();throw new Error(_0x26d7ad(0x10d8)+_0x2222b4[_0x26d7ad(0x1fd)]['message']);}const _0x294ea3=await _0x23bf7c['json'](),_0x25962a=getGeminiResponseText(_0x294ea3),_0x4528f9=_0x25962a[_0x26d7ad(0x86c)](/(\[[\s\S]*\])/);if(!_0x4528f9)throw new Error(_0x26d7ad(0x9a1)+_0x25962a);const _0x399116=JSON[_0x26d7ad(0x2cb)](_0x4528f9[0x0]);for(const _0x567147 of _0x399116){_0x567147[_0x26d7ad(0x1187)]&&_0x567147[_0x26d7ad(0xa03)]&&(_0x70a9b9(_0x567147[_0x26d7ad(0x1187)],_0x567147['dialogue']),_0x12aee4(),await new Promise(_0x46251c=>setTimeout(_0x46251c,0x5dc+Math[_0x26d7ad(0xdc6)]()*0x7d0)));}}catch(_0x144e93){console[_0x26d7ad(0x1fd)](_0x26d7ad(0xda9),_0x144e93),await _0x532f76(_0x26d7ad(0x267),_0x26d7ad(0x12b6)+_0x144e93[_0x26d7ad(0x1288)]);}}async function _0x31345e(){const _0x4d878f=_0x41eae2;_0x2fd1ad(_0x4d878f(0xd7d)),_0x12aee4(),_0x42920c['votes']={};let _0x1eb871=null;_0x42920c[_0x4d878f(0xc9e)]='getVotes';try{_0x1eb871=await _0x30cd95(),_0x1eb871&&_0x1eb871[_0x4d878f(0xd9a)](_0x83d1e2=>{const _0x2f3458=_0x4d878f,_0x5aec1d=_0x42920c['players']['find'](_0x5acae6=>_0x5acae6[_0x2f3458(0xf74)]===_0x83d1e2[_0x2f3458(0x620)]),_0x21b45f=_0x42920c[_0x2f3458(0x11ee)][_0x2f3458(0x12f4)](_0x493701=>_0x493701[_0x2f3458(0xf74)]===_0x83d1e2[_0x2f3458(0x1199)]);_0x5aec1d&&_0x5aec1d[_0x2f3458(0x5d7)]&&_0x21b45f&&(_0x42920c['votes'][_0x5aec1d[_0x2f3458(0xf74)]]=_0x21b45f[_0x2f3458(0xf74)]);}),_0x42920c[_0x4d878f(0xc9e)]=null;}catch(_0xc726ad){console['error'](_0x4d878f(0x1f6),_0xc726ad),await _0x532f76('操作失败',_0x4d878f(0x906)+_0xc726ad[_0x4d878f(0x1288)]),document['getElementById']('werewolf-retry-btn')[_0x4d878f(0x68e)][_0x4d878f(0x126b)]=_0x4d878f(0x1118);return;}const _0x16fa5d=_0x42920c['players'][_0x4d878f(0x12f4)](_0x2c4fc3=>_0x2c4fc3['id']===_0x4d878f(0x116c));if(_0x16fa5d&&_0x16fa5d[_0x4d878f(0x5d7)]){_0x2fd1ad(_0x4d878f(0xa8d)),_0x12aee4();const _0x534607=await _0x3deb51(_0x4d878f(0x12b3)),_0x569b2e=_0x42920c['players'][_0x4d878f(0x12f4)](_0x5a0a73=>_0x5a0a73['id']===_0x534607);_0x569b2e&&(_0x42920c[_0x4d878f(0x10d1)][_0x16fa5d[_0x4d878f(0xf74)]]=_0x569b2e[_0x4d878f(0xf74)]);}_0x4fe768();}async function _0x30cd95(){const _0x581177=_0x41eae2,{proxyUrl:_0x527818,apiKey:_0x287956,model:_0x4d51b0}=_0x5b873d[_0x581177(0x30d)];if(!_0x527818||!_0x287956||!_0x4d51b0)return null;const _0x88fd7=_0x42920c[_0x581177(0x11ee)][_0x581177(0x3d8)](_0x5a4581=>_0x5a4581[_0x581177(0x5d7)]&&_0x5a4581['id']!=='user'),_0x3141a6=_0x42920c['players'][_0x581177(0x3d8)](_0x32fd0e=>_0x32fd0e['isAlive'])['map'](_0x45b837=>_0x45b837[_0x581177(0xf74)]);let _0x4e4a37=_0x4aad6();_0x4e4a37+='\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20'+_0x3141a6[_0x581177(0x1237)](',\x20')+'\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。';try{let _0x520266=_0x527818[_0x581177(0xced)](_0x581177(0x6a6)),_0x816018=[{'role':_0x581177(0x116c),'content':_0x581177(0xa64)}],_0x5a869e=_0xa615f4(_0x4d51b0,_0x287956,_0x4e4a37,_0x816018);const _0x513672=_0x520266?await fetch(_0x5a869e[_0x581177(0x11de)],_0x5a869e['data']):await fetch(_0x527818+_0x581177(0x6dd),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x287956},'body':JSON[_0x581177(0x465)]({'model':_0x4d51b0,'messages':[{'role':_0x581177(0x18c),'content':_0x4e4a37},..._0x816018],'temperature':_0x5b873d[_0x581177(0x21a)][_0x581177(0x576)]||0.8})});if(!_0x513672['ok'])throw new Error((await _0x513672['json']())[_0x581177(0x1fd)][_0x581177(0x1288)]);const _0x53b062=await _0x513672[_0x581177(0x6b5)](),_0x20fcdd=getGeminiResponseText(_0x53b062);let _0x204b7d=_0x20fcdd[_0x581177(0xfbf)](/^```json\s*/,'')['replace'](/```$/,'')['trim']();const _0xa0a2d4=_0x204b7d[_0x581177(0x37c)]('['),_0x2d03ec=_0x204b7d[_0x581177(0x10d2)](']');if(_0xa0a2d4===-0x1||_0x2d03ec===-0x1||_0x2d03ec<_0xa0a2d4)throw new Error('AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。');const _0x4f16bf=_0x204b7d[_0x581177(0x489)](_0xa0a2d4,_0x2d03ec+0x1);try{const _0x38e993=_0x4f16bf[_0x581177(0x86c)](/(\[[\s\S]*?\])/g);if(_0x38e993&&_0x38e993[_0x581177(0x7aa)]>0x0)return JSON[_0x581177(0x2cb)](_0x38e993[_0x38e993[_0x581177(0x7aa)]-0x1]);return JSON[_0x581177(0x2cb)](_0x4f16bf);}catch(_0x1c2fce){throw new Error(_0x581177(0x17d)+_0x1c2fce['message']+'\x0a\x0aAI原始返回内容:\x0a'+_0x20fcdd);}}catch(_0x4745e6){console[_0x581177(0x1fd)]('获取AI投票失败:',_0x4745e6);throw new Error('获取AI投票决策失败:\x20'+_0x4745e6['message']);}}function _0x4fe768(){const _0x555de5=_0x41eae2,_0x1a74ef={},_0x340053={};for(const _0x270ef7 in _0x42920c[_0x555de5(0x10d1)]){const _0xa7ad4b=_0x42920c[_0x555de5(0x10d1)][_0x270ef7];_0x1a74ef[_0xa7ad4b]=(_0x1a74ef[_0xa7ad4b]||0x0)+0x1,!_0x340053[_0xa7ad4b]&&(_0x340053[_0xa7ad4b]=[]),_0x340053[_0xa7ad4b][_0x555de5(0x138c)](_0x270ef7);}let _0x5794f4=0x0,_0x3c3e9d=[];for(const _0x1b13c3 in _0x1a74ef){const _0xe90eb8=_0x1a74ef[_0x1b13c3];if(_0xe90eb8>_0x5794f4)_0x5794f4=_0xe90eb8,_0x3c3e9d=[_0x1b13c3];else _0xe90eb8===_0x5794f4&&_0x3c3e9d[_0x555de5(0x138c)](_0x1b13c3);}_0x2fd1ad(_0x555de5(0x1cb));for(const _0x5e2a45 in _0x340053){_0x2fd1ad(_0x5e2a45+'\x20('+_0x340053[_0x5e2a45][_0x555de5(0x7aa)]+_0x555de5(0x1085)+_0x340053[_0x5e2a45][_0x555de5(0x1237)]('、\x20'));}if(_0x3c3e9d[_0x555de5(0x7aa)]===0x1&&_0x5794f4>0x0){const _0x4a1a98=_0x42920c[_0x555de5(0x11ee)]['find'](_0x2b7685=>_0x2b7685[_0x555de5(0xf74)]===_0x3c3e9d[0x0]);if(_0x4a1a98){_0x4a1a98[_0x555de5(0x5d7)]=![],_0x2fd1ad(_0x4a1a98[_0x555de5(0xf74)]+_0x555de5(0x438));if(_0x4a1a98[_0x555de5(0xa57)]==='猎人'){}}}else _0x2fd1ad('平票或无人投票，此轮无人出局。');_0x12aee4();if(_0x44a5d6())return;_0x42920c[_0x555de5(0xd72)]++,_0x36c121();}async function _0x1211da(){const _0x48256e=_0x41eae2,{proxyUrl:_0x4aeb0d,apiKey:_0x2ef3f3,model:_0x15b1e6}=_0x5b873d['apiConfig'];if(!_0x4aeb0d||!_0x2ef3f3||!_0x15b1e6)return null;const _0x3dd1ea=_0x42920c[_0x48256e(0x11ee)][_0x48256e(0x3d8)](_0xde811b=>_0xde811b[_0x48256e(0xa57)]==='狼人'&&_0xde811b[_0x48256e(0x5d7)]),_0x23700e=_0x42920c['players']['filter'](_0x54d912=>_0x54d912['isAlive']&&_0x54d912['role']!=='狼人'),_0x29b7c5=_0x48256e(0x1115)+_0x3dd1ea['map'](_0x46f3a6=>_0x46f3a6[_0x48256e(0xf74)])[_0x48256e(0x1237)]('、\x20')+_0x48256e(0x938)+_0x23700e[_0x48256e(0x412)](_0x5373e0=>_0x5373e0[_0x48256e(0xf74)])['join']('、\x20')+_0x48256e(0x163)+_0x42920c[_0x48256e(0x1091)][_0x48256e(0x412)](_0x341489=>_0x341489[_0x48256e(0xace)]+':\x20'+_0x341489[_0x48256e(0x28c)])[_0x48256e(0x1237)]('\x0a')+_0x48256e(0x773);try{let _0x2e1409=_0x4aeb0d[_0x48256e(0xced)](_0x48256e(0x6a6)),_0x1e1fea=[{'role':'user','content':_0x48256e(0xe43)}],_0x124896=_0xa615f4(_0x15b1e6,_0x2ef3f3,_0x29b7c5,_0x1e1fea);const _0x6ba314=_0x2e1409?await fetch(_0x124896[_0x48256e(0x11de)],_0x124896['data']):await fetch(_0x4aeb0d+_0x48256e(0x6dd),{'method':_0x48256e(0xd14),'headers':{'Content-Type':_0x48256e(0xce4),'Authorization':'Bearer\x20'+_0x2ef3f3},'body':JSON[_0x48256e(0x465)]({'model':_0x15b1e6,'messages':[{'role':_0x48256e(0x18c),'content':_0x29b7c5},..._0x1e1fea],'temperature':_0x5b873d[_0x48256e(0x21a)]['apiTemperature']||0.8})});if(!_0x6ba314['ok'])throw new Error((await _0x6ba314[_0x48256e(0x6b5)]())[_0x48256e(0x1fd)][_0x48256e(0x1288)]);const _0x3fafe0=await _0x6ba314[_0x48256e(0x6b5)](),_0x3aa987=getGeminiResponseText(_0x3fafe0),_0x172674=_0x3aa987['match'](/({[\s\S]*})/);if(!_0x172674)throw new Error(_0x48256e(0x4bb));const _0x1ccdb2=JSON[_0x48256e(0x2cb)](_0x172674[0x0]),_0x401e65=_0x42920c[_0x48256e(0x11ee)]['find'](_0x1696a7=>_0x1696a7[_0x48256e(0xf74)]===_0x1ccdb2[_0x48256e(0xe72)]);return _0x401e65?_0x401e65['id']:null;}catch(_0x2b4f99){return console[_0x48256e(0x1fd)](_0x48256e(0xbb6),_0x2b4f99),_0x23700e[Math[_0x48256e(0x128a)](Math[_0x48256e(0xdc6)]()*_0x23700e['length'])]['id'];}}function _0x50820a(_0x1ae305,_0x33ee6a){return new Promise(_0x1f5f16=>{const _0x38068e=_0x356e,_0x2821f7=document[_0x38068e(0x89d)]('werewolf-witch-modal'),_0x2ae5ce=document[_0x38068e(0x89d)](_0x38068e(0x7de)),_0x26aaab=document[_0x38068e(0x89d)]('witch-modal-title'),_0x348b9c=document[_0x38068e(0x89d)](_0x38068e(0x626)),_0x16124b=document[_0x38068e(0x89d)](_0x38068e(0x21b));_0x2ae5ce[_0x38068e(0x1ef)]='';const _0x9858a1=_0x348b9c[_0x38068e(0xf2a)](!![]);_0x348b9c['parentNode']['replaceChild'](_0x9858a1,_0x348b9c);const _0x5b0e24=_0x16124b['cloneNode'](!![]);_0x16124b['parentNode']['replaceChild'](_0x5b0e24,_0x16124b),_0x9858a1[_0x38068e(0x68e)]['display']=_0x38068e(0x1118),_0x9858a1[_0x38068e(0x3f7)]=!![];let _0x53648f={'save':![],'poison':null},_0x45ac0b=null;if(_0x1ae305&&!_0x33ee6a[_0x38068e(0x638)]){_0x26aaab[_0x38068e(0xf12)]=_0x38068e(0x4e4)+_0x1ae305[_0x38068e(0xf74)]+'\x20被刀了';const _0x553ca4=document[_0x38068e(0x285)]('button');_0x553ca4[_0x38068e(0x81c)]=_0x38068e(0xbab),_0x553ca4[_0x38068e(0xf12)]=_0x38068e(0x330),_0x553ca4[_0x38068e(0x68e)][_0x38068e(0x2ce)]='20px',_0x553ca4[_0x38068e(0x108b)]=()=>{const _0x4ae1f0=_0x38068e;_0x53648f['save']=!![],_0x2821f7[_0x4ae1f0(0x2f1)][_0x4ae1f0(0x1247)](_0x4ae1f0(0x11e4)),_0x1f5f16(_0x53648f);},_0x2ae5ce['appendChild'](_0x553ca4);}else _0x1ae305?_0x26aaab['textContent']=_0x38068e(0x4e4)+_0x1ae305[_0x38068e(0xf74)]+'\x20被刀了\x20(你没有解药了)':_0x26aaab[_0x38068e(0xf12)]=_0x38068e(0xfbb);if(!_0x33ee6a[_0x38068e(0x1177)]){const _0x4d620d=document[_0x38068e(0x285)]('p');_0x4d620d[_0x38068e(0xf12)]=_0x38068e(0x11a3),_0x4d620d['style']['textAlign']=_0x38068e(0x802),_0x4d620d['style'][_0x38068e(0x3b5)]='20px',_0x2ae5ce[_0x38068e(0x22f)](_0x4d620d);const _0x3e3563=_0x42920c['players'][_0x38068e(0x3d8)](_0x4b2a78=>_0x4b2a78['isAlive']&&_0x4b2a78['id']!==_0x1ae305?.['id']);_0x3e3563[_0x38068e(0xd9a)](_0x33113c=>{const _0x5eeb51=_0x38068e,_0x91af73=document[_0x5eeb51(0x285)](_0x5eeb51(0xb25));_0x91af73['className']=_0x5eeb51(0x41f),_0x91af73['dataset']['id']=_0x33113c['id'],_0x91af73[_0x5eeb51(0x1ef)]=_0x5eeb51(0x477)+_0x33113c[_0x5eeb51(0x12c8)]+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0x33113c[_0x5eeb51(0xf74)]+_0x5eeb51(0x5ec),_0x91af73[_0x5eeb51(0x108b)]=()=>{const _0x3f0822=_0x5eeb51;_0x2ae5ce['querySelectorAll'](_0x3f0822(0xe1d))[_0x3f0822(0xd9a)](_0xc1adc9=>_0xc1adc9['classList'][_0x3f0822(0x1247)]('selected')),_0x91af73[_0x3f0822(0x2f1)]['add'](_0x3f0822(0x335)),_0x45ac0b=_0x33113c['id'],_0x9858a1[_0x3f0822(0x3f7)]=![];},_0x2ae5ce[_0x5eeb51(0x22f)](_0x91af73);});}_0x9858a1[_0x38068e(0x108b)]=()=>{const _0x344127=_0x38068e;_0x45ac0b&&(_0x53648f[_0x344127(0x35b)]=_0x45ac0b,_0x2821f7[_0x344127(0x2f1)]['remove'](_0x344127(0x11e4)),_0x1f5f16(_0x53648f));},_0x5b0e24[_0x38068e(0x108b)]=()=>{const _0x1df7c2=_0x38068e;_0x2821f7[_0x1df7c2(0x2f1)]['remove'](_0x1df7c2(0x11e4)),_0x1f5f16(_0x53648f);},_0x2821f7[_0x38068e(0x2f1)]['add']('visible');});}async function _0x10fc16(){const _0x4eca06=_0x41eae2,_0xe077aa=_0x42920c['lastFailedAction'];if(!_0xe077aa)return;document['getElementById'](_0x4eca06(0x6c1))[_0x4eca06(0x68e)][_0x4eca06(0x126b)]=_0x4eca06(0x10f2),await _0x532f76(_0x4eca06(0xb6a),_0x4eca06(0xeef)+_0xe077aa+_0x4eca06(0x2dc));switch(_0xe077aa){case _0x4eca06(0xe55):await _0x36c121();break;case'startDiscussion':await _0x1d5842();break;case _0x4eca06(0x5ca):await _0x31345e();break;}}function _0x44a5d6(){const _0x58c2c4=_0x41eae2,_0x59ac07=_0x42920c[_0x58c2c4(0x11ee)][_0x58c2c4(0x3d8)](_0x38ce45=>_0x38ce45[_0x58c2c4(0x5d7)]),_0x37efd2=_0x59ac07['filter'](_0x56b07d=>_0x56b07d[_0x58c2c4(0xa57)]==='狼人'),_0x4d0495=_0x59ac07[_0x58c2c4(0x3d8)](_0x516ec2=>['预言家','女巫','猎人','守卫'][_0x58c2c4(0xced)](_0x516ec2[_0x58c2c4(0xa57)])),_0x407881=_0x59ac07[_0x58c2c4(0x3d8)](_0x3fe118=>_0x3fe118[_0x58c2c4(0xa57)]==='平民');let _0x33c21e=null;if(_0x37efd2['length']===0x0)_0x33c21e='好人';else{if(_0x37efd2['length']>=_0x4d0495[_0x58c2c4(0x7aa)]+_0x407881[_0x58c2c4(0x7aa)])_0x33c21e='狼人';else _0x42920c['gameMode']==='12p'?(_0x4d0495[_0x58c2c4(0x7aa)]===0x0||_0x407881[_0x58c2c4(0x7aa)]===0x0)&&(_0x33c21e='狼人'):_0x4d0495[_0x58c2c4(0x7aa)]===0x0&&_0x407881['length']===0x0&&(_0x33c21e='狼人');}if(_0x33c21e)return _0x1f3d8a(_0x33c21e),!![];return![];}async function _0x13b202(){const _0x31403e=_0x41eae2,_0x42dea8=await _0x4e2abc('确认操作',_0x31403e(0x4d6),{'confirmText':'开始检查'});if(!_0x42dea8)return;await _0x532f76(_0x31403e(0xb6a),_0x31403e(0x8ff));try{const _0x30a650=await _0x1a6951[_0x31403e(0x667)][_0x31403e(0xc2f)]();let _0x455900=0x0;for(const _0x2871c of _0x30a650){let _0x3eb5fa=![];!Array[_0x31403e(0xbd6)](_0x2871c[_0x31403e(0x551)])&&(_0x2871c[_0x31403e(0x551)]=[],_0x3eb5fa=!![]),(typeof _0x2871c[_0x31403e(0xdb9)]!=='object'||_0x2871c[_0x31403e(0xdb9)]===null)&&(_0x2871c[_0x31403e(0xdb9)]={},_0x3eb5fa=!![]),!_0x2871c['isGroup']&&!_0x2871c['originalName']&&(_0x2871c[_0x31403e(0x1045)]=_0x2871c[_0x31403e(0xf74)],_0x3eb5fa=!![]),typeof _0x2871c[_0x31403e(0x3ce)]===_0x31403e(0x1bf)&&(_0x2871c['unreadCount']=0x0,_0x3eb5fa=!![]),!Array[_0x31403e(0xbd6)](_0x2871c[_0x31403e(0xc18)])&&(_0x2871c[_0x31403e(0xc18)]=[],_0x3eb5fa=!![]),_0x3eb5fa&&(_0x455900++,console[_0x31403e(0x471)](_0x31403e(0xacc)+_0x2871c[_0x31403e(0xf74)]+_0x31403e(0xcc5)+_0x2871c['id']+_0x31403e(0x2b7)),await _0x1a6951[_0x31403e(0x667)][_0x31403e(0xc0f)](_0x2871c)),_0x5b873d['chats'][_0x2871c['id']]=_0x2871c;}_0x455900>0x0?(await _0x532f76(_0x31403e(0xe48),'成功检查并修复了\x20'+_0x455900+'\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。'),await _0x413d78()):await _0x532f76(_0x31403e(0x7e4),'未发现任何需要修复的数据问题。');}catch(_0x1942d1){console[_0x31403e(0x1fd)](_0x31403e(0x127f),_0x1942d1),await _0x532f76(_0x31403e(0x10de),'执行检查时发生错误:\x20'+_0x1942d1['message']);}}function _0x9ce0b2(_0xf8f1a0,_0x5cd4bb=_0x41eae2(0x113d)){const _0x131d33=_0x41eae2;if(_0xf8f1a0['querySelector']('.loader-container'))return;const _0x40e69e=document[_0x131d33(0x285)]('div');_0x40e69e[_0x131d33(0x81c)]=_0x131d33(0xcae),_0x40e69e[_0x131d33(0x1ef)]=_0x131d33(0x66a),_0x5cd4bb==='bottom'?_0xf8f1a0[_0x131d33(0x22f)](_0x40e69e):_0xf8f1a0[_0x131d33(0x778)](_0x40e69e);}function _0x216cac(_0x4f897f){const _0x1d1323=_0x41eae2,_0x54fae7=_0x4f897f[_0x1d1323(0xd16)]('.loader-container');_0x54fae7&&_0x54fae7['remove']();}async function _0xbc2a8(){const _0x372b3e=_0x41eae2,_0x2e4969=document['getElementById'](_0x372b3e(0xc4e)),_0x462b8d=document[_0x372b3e(0x89d)](_0x372b3e(0x123b)),_0x837bfa=document[_0x372b3e(0x89d)]('select-all-world-books-for-clear');_0x462b8d[_0x372b3e(0x1ef)]='',_0x837bfa[_0x372b3e(0x1b0)]=![];const _0x13fb4a=await _0x1a6951[_0x372b3e(0x8a1)][_0x372b3e(0xc2f)]();_0x13fb4a[_0x372b3e(0x7aa)]===0x0?_0x462b8d[_0x372b3e(0x1ef)]=_0x372b3e(0x15a):_0x13fb4a[_0x372b3e(0xd9a)](_0x29ead1=>{const _0x202ab7=_0x372b3e,_0x378ff7=document[_0x202ab7(0x285)](_0x202ab7(0xb25));_0x378ff7[_0x202ab7(0x81c)]=_0x202ab7(0x80e),_0x378ff7[_0x202ab7(0xaaf)][_0x202ab7(0x11cc)]=_0x29ead1['id'],_0x378ff7['innerHTML']=_0x202ab7(0xd97)+_0x29ead1[_0x202ab7(0xf74)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x462b8d[_0x202ab7(0x22f)](_0x378ff7);}),_0x2e4969[_0x372b3e(0x2f1)][_0x372b3e(0x569)]('visible');}async function _0x2d67fe(){const _0x4d4399=_0x41eae2,_0x171339=document[_0x4d4399(0x35f)](_0x4d4399(0x192));if(_0x171339[_0x4d4399(0x7aa)]===0x0){alert(_0x4d4399(0x7b0));return;}const _0xfe44f4=Array[_0x4d4399(0x321)](_0x171339)[_0x4d4399(0x412)](_0x4ff87e=>_0x4ff87e['dataset'][_0x4d4399(0x11cc)]),_0x5e0761=await _0x4e2abc(_0x4d4399(0xe1c),_0x4d4399(0x319)+_0x171339[_0x4d4399(0x7aa)]+'\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！',{'confirmButtonClass':'btn-danger','confirmText':_0x4d4399(0x3da)});if(!_0x5e0761)return;await _0x532f76(_0x4d4399(0xb6a),'正在执行删除操作...');try{await _0x1a6951[_0x4d4399(0x93b)]('rw',_0x1a6951[_0x4d4399(0x8a1)],_0x1a6951[_0x4d4399(0x667)],async()=>{const _0xd517ab=_0x4d4399;await _0x1a6951[_0xd517ab(0x8a1)][_0xd517ab(0x6a7)](_0xfe44f4);const _0x418d8c=await _0x1a6951['chats'][_0xd517ab(0xc2f)]();for(const _0x820f7e of _0x418d8c){if(_0x820f7e[_0xd517ab(0xdb9)]&&Array[_0xd517ab(0xbd6)](_0x820f7e[_0xd517ab(0xdb9)][_0xd517ab(0x32d)])){const _0x2a3e59=_0x820f7e['settings'][_0xd517ab(0x32d)]['length'];_0x820f7e['settings']['linkedWorldBookIds']=_0x820f7e['settings']['linkedWorldBookIds'][_0xd517ab(0x3d8)](_0x48a8cf=>!_0xfe44f4[_0xd517ab(0xced)](_0x48a8cf)),_0x820f7e['settings']['linkedWorldBookIds'][_0xd517ab(0x7aa)]<_0x2a3e59&&await _0x1a6951[_0xd517ab(0x667)][_0xd517ab(0xc0f)](_0x820f7e);}}}),_0x5b873d[_0x4d4399(0x8a1)]=_0x5b873d['worldBooks'][_0x4d4399(0x3d8)](_0x56a2c0=>!_0xfe44f4['includes'](_0x56a2c0['id'])),document[_0x4d4399(0x89d)]('delete-world-books-modal')['classList'][_0x4d4399(0x1247)](_0x4d4399(0x11e4)),await _0x532f76(_0x4d4399(0xcf9),_0x171339[_0x4d4399(0x7aa)]+_0x4d4399(0x125b));}catch(_0x5ae19b){console['error'](_0x4d4399(0xb58),_0x5ae19b),await _0x532f76(_0x4d4399(0x717),_0x4d4399(0x7ee)+_0x5ae19b[_0x4d4399(0x1288)]);}}function _0x8788e(){const _0x4f8b20=_0x41eae2;if(!_0x5b873d['activeChatId'])return;const _0xc9b738=_0x5b873d[_0x4f8b20(0xf96)],_0xab0bb1=document[_0x4f8b20(0x89d)](_0x4f8b20(0x916)),_0x59cadf=document[_0x4f8b20(0x89d)](_0x4f8b20(0x4ee)),_0x5accd1=document['getElementById'](_0x4f8b20(0x12e6));let _0x2c287c=_0x2aadc5[_0xc9b738];if(_0x2c287c&&_0x2c287c[_0x4f8b20(0xfcb)]){_0x2c287c[_0x4f8b20(0x822)]&&_0x1ea546();_0xab0bb1[_0x4f8b20(0x68e)][_0x4f8b20(0x126b)]='flex';return;}_0x1c25bb(_0xc9b738),_0x3e3d30(_0xc9b738),_0xab0bb1['style']['display']=_0x4f8b20(0x66e),_0x59cadf[_0x4f8b20(0x2f1)]['remove']('minimized'),_0x5accd1[_0x4f8b20(0x68e)][_0x4f8b20(0x126b)]='none';const _0x4a8a4f=document[_0x4f8b20(0x89d)](_0x4f8b20(0x34e)),_0x3dc6fe=_0x59cadf[_0x4f8b20(0xdb2)](),_0x26c2fb=(_0x4a8a4f['clientHeight']-_0x3dc6fe[_0x4f8b20(0x84a)])/0x2,_0x482090=(_0x4a8a4f[_0x4f8b20(0x2fd)]-_0x3dc6fe['width'])/0x2;_0x59cadf['style'][_0x4f8b20(0x113d)]=_0x26c2fb+'px',_0x59cadf[_0x4f8b20(0x68e)][_0x4f8b20(0x1004)]=_0x482090+'px',_0x59cadf['style'][_0x4f8b20(0x9ab)]='';}function _0x1c25bb(_0x8b32f6){const _0x36ba3e=_0x41eae2;_0x2aadc5[_0x8b32f6]={'isActive':!![],'isMinimized':![],'title':_0x36ba3e(0x4de),'contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0x4ed3f0(){const _0x2d6182=_0x41eae2,_0x52adcd=_0x5b873d[_0x2d6182(0xf96)];if(!_0x52adcd||!_0x2aadc5[_0x52adcd]||!_0x2aadc5[_0x52adcd]['isActive'])return;document[_0x2d6182(0x89d)](_0x2d6182(0x916))[_0x2d6182(0x68e)][_0x2d6182(0x126b)]=_0x2d6182(0x10f2),document[_0x2d6182(0x89d)]('reading-restore-btn')['style'][_0x2d6182(0x126b)]=_0x2d6182(0x10f2),document[_0x2d6182(0x89d)](_0x2d6182(0x4ee))[_0x2d6182(0x2f1)][_0x2d6182(0x1247)](_0x2d6182(0x31c)),_0x2aadc5[_0x52adcd][_0x2d6182(0xfcb)]=![],console[_0x2d6182(0x471)](_0x2d6182(0x387));}function _0x3ed521(){const _0x445639=_0x41eae2,_0x5dd79c=_0x2aadc5[_0x5b873d[_0x445639(0xf96)]];if(!_0x5dd79c||!_0x5dd79c['isActive']||_0x5dd79c[_0x445639(0x822)])return;_0x5dd79c[_0x445639(0x822)]=!![],document[_0x445639(0x89d)]('reading-window')[_0x445639(0x2f1)]['add'](_0x445639(0x31c)),document[_0x445639(0x89d)]('reading-restore-btn')['style'][_0x445639(0x126b)]='flex';}function _0x1ea546(){const _0x5704a6=_0x41eae2,_0x4cbfa1=_0x2aadc5[_0x5b873d[_0x5704a6(0xf96)]];if(!_0x4cbfa1||!_0x4cbfa1[_0x5704a6(0xfcb)]||!_0x4cbfa1[_0x5704a6(0x822)])return;_0x4cbfa1[_0x5704a6(0x822)]=![],document[_0x5704a6(0x89d)](_0x5704a6(0x12e6))[_0x5704a6(0x68e)][_0x5704a6(0x126b)]='none',document[_0x5704a6(0x89d)](_0x5704a6(0x4ee))[_0x5704a6(0x2f1)][_0x5704a6(0x1247)]('minimized');}function _0xac139e(_0x14ca57,_0x253b66){const _0x21dd82=_0x41eae2;let _0x2844f8=0x0,_0x2fd5e1=0x0,_0x416018=0x0,_0x2c6105=0x0;const _0x44652b=document[_0x21dd82(0x89d)](_0x21dd82(0x34e)),_0x38da05=_0x5233c1=>{const _0x1ac823=_0x21dd82;if(_0x5233c1[_0x1ac823(0x225)][_0x1ac823(0x53a)]('button'))return;if(_0x14ca57[_0x1ac823(0x68e)][_0x1ac823(0x9ab)]){const _0x2c273b=_0x14ca57['getBoundingClientRect'](),_0x3aa080=_0x14ca57[_0x1ac823(0x11c0)][_0x1ac823(0xdb2)]();_0x14ca57['style'][_0x1ac823(0x113d)]=_0x2c273b[_0x1ac823(0x113d)]-_0x3aa080['top']+'px',_0x14ca57[_0x1ac823(0x68e)][_0x1ac823(0x1004)]=_0x2c273b[_0x1ac823(0x1004)]-_0x3aa080['left']+'px',_0x14ca57[_0x1ac823(0x68e)]['transform']='';}_0x5233c1['preventDefault']();const _0x4446c8=_0x5233c1[_0x1ac823(0x48c)]===_0x1ac823(0x74f)?_0x5233c1['touches'][0x0]:_0x5233c1;_0x416018=_0x4446c8['clientX'],_0x2c6105=_0x4446c8[_0x1ac823(0x4b8)],document[_0x1ac823(0x1193)](_0x1ac823(0x1dd),_0x21a9ad),document[_0x1ac823(0x1193)](_0x1ac823(0xf4d),_0x3e67cc),document[_0x1ac823(0x1193)]('touchend',_0x21a9ad),document[_0x1ac823(0x1193)](_0x1ac823(0xe3f),_0x3e67cc);},_0x3e67cc=_0x240e09=>{const _0x5e991c=_0x21dd82,_0x1bd5cd=_0x240e09[_0x5e991c(0x48c)]===_0x5e991c(0xe3f)?_0x240e09[_0x5e991c(0xe9e)][0x0]:_0x240e09;_0x2844f8=_0x416018-_0x1bd5cd[_0x5e991c(0xc12)],_0x2fd5e1=_0x2c6105-_0x1bd5cd[_0x5e991c(0x4b8)],_0x416018=_0x1bd5cd[_0x5e991c(0xc12)],_0x2c6105=_0x1bd5cd[_0x5e991c(0x4b8)];let _0x509b4f=_0x14ca57['offsetTop']-_0x2fd5e1,_0x14c3e6=_0x14ca57[_0x5e991c(0x224)]-_0x2844f8;const _0x48296f=_0x44652b['clientHeight']-_0x14ca57['offsetHeight']-0xa,_0x451cc4=_0x44652b[_0x5e991c(0x2fd)]-_0x14ca57[_0x5e991c(0xf13)]-0xa;_0x509b4f=Math[_0x5e991c(0x88d)](0xa,Math['min'](_0x509b4f,_0x48296f)),_0x14c3e6=Math[_0x5e991c(0x88d)](0xa,Math[_0x5e991c(0x1169)](_0x14c3e6,_0x451cc4)),_0x14ca57[_0x5e991c(0x68e)][_0x5e991c(0x113d)]=_0x509b4f+'px',_0x14ca57[_0x5e991c(0x68e)][_0x5e991c(0x1004)]=_0x14c3e6+'px';},_0x21a9ad=()=>{const _0x3a2932=_0x21dd82;document[_0x3a2932(0xcbb)](_0x3a2932(0x1dd),_0x21a9ad),document['removeEventListener'](_0x3a2932(0xf4d),_0x3e67cc),document[_0x3a2932(0xcbb)](_0x3a2932(0xc95),_0x21a9ad),document[_0x3a2932(0xcbb)]('touchmove',_0x3e67cc);};_0x253b66[_0x21dd82(0x1193)](_0x21dd82(0x898),_0x38da05),_0x253b66[_0x21dd82(0x1193)](_0x21dd82(0x74f),_0x38da05);}function _0x3e3d30(_0x1bd74c){const _0x48b27c=_0x41eae2,_0x334765=_0x2aadc5[_0x1bd74c];if(!_0x334765)return;const _0x47265f=document[_0x48b27c(0x89d)]('reading-title'),_0x3c9f23=document[_0x48b27c(0x89d)](_0x48b27c(0x951)),_0x278fad=document[_0x48b27c(0x89d)]('page-indicator'),_0x500d08=document[_0x48b27c(0x89d)](_0x48b27c(0xdeb)),_0x236325=document['getElementById'](_0x48b27c(0x11a4));_0x47265f['textContent']=_0x334765['title'];if(_0x334765[_0x48b27c(0x76b)][_0x48b27c(0x7aa)]===0x0)_0x3c9f23['innerHTML']=_0x48b27c(0xc27),_0x334765[_0x48b27c(0xdef)]=0x0,_0x334765['currentPage']=0x0;else{const _0x294ea0=_0x334765['currentPage']*_0x334765[_0x48b27c(0x109f)],_0x466069=_0x294ea0+_0x334765['linesPerPage'];_0x3c9f23[_0x48b27c(0xf12)]=_0x334765[_0x48b27c(0x76b)]['slice'](_0x294ea0,_0x466069)[_0x48b27c(0x1237)]('\x0a');}_0x278fad[_0x48b27c(0xf12)]=_0x334765[_0x48b27c(0x106f)]+0x1+_0x48b27c(0xa8a)+_0x334765[_0x48b27c(0xdef)],_0x500d08[_0x48b27c(0x3f7)]=_0x334765[_0x48b27c(0x106f)]===0x0,_0x236325[_0x48b27c(0x3f7)]=_0x334765[_0x48b27c(0x106f)]>=_0x334765[_0x48b27c(0xdef)]-0x1;}function _0xa63197(){const _0x33f9bb=_0x41eae2,_0x1903d5=_0x2aadc5[_0x5b873d['activeChatId']];_0x1903d5&&_0x1903d5['currentPage']<_0x1903d5[_0x33f9bb(0xdef)]-0x1&&(_0x1903d5[_0x33f9bb(0x106f)]++,_0x3e3d30(_0x5b873d[_0x33f9bb(0xf96)]),document['getElementById'](_0x33f9bb(0x951))[_0x33f9bb(0xb0e)]=0x0,_0x1ea23b(_0x1903d5[_0x33f9bb(0x1125)],_0x1903d5[_0x33f9bb(0x106f)]));}async function _0x1834ac(){const _0x4b2cb8=_0x41eae2,_0x5b2846=_0x2aadc5[_0x5b873d[_0x4b2cb8(0xf96)]];_0x5b2846&&_0x5b2846[_0x4b2cb8(0x106f)]>0x0&&(_0x5b2846[_0x4b2cb8(0x106f)]--,_0x3e3d30(_0x5b873d[_0x4b2cb8(0xf96)]),document[_0x4b2cb8(0x89d)](_0x4b2cb8(0x951))[_0x4b2cb8(0xb0e)]=0x0,await _0x1ea23b(_0x5b2846[_0x4b2cb8(0x1125)],_0x5b2846[_0x4b2cb8(0x106f)]),await notifyAiOfPageTurn(_0x5b873d[_0x4b2cb8(0xf96)],_0x5b2846));}function _0x2a2d03(){const _0x46bdd6=_0x41eae2;document['getElementById'](_0x46bdd6(0x1292))[_0x46bdd6(0x12a5)]();}async function _0x318bcd(_0x454c67){const _0x3ef321=_0x41eae2,_0x29381f=new Uint8Array(_0x454c67);if(_0x29381f[_0x3ef321(0x7aa)]>=0x3&&_0x29381f[0x0]===0xef&&_0x29381f[0x1]===0xbb&&_0x29381f[0x2]===0xbf)return console[_0x3ef321(0x471)](_0x3ef321(0x2a7)),new TextDecoder(_0x3ef321(0xee7))[_0x3ef321(0xe22)](_0x29381f);if(_0x29381f[_0x3ef321(0x7aa)]>=0x2&&_0x29381f[0x0]===0xff&&_0x29381f[0x1]===0xfe)return console[_0x3ef321(0x471)]('检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。'),new TextDecoder('utf-16le')[_0x3ef321(0xe22)](_0x29381f);if(_0x29381f[_0x3ef321(0x7aa)]>=0x2&&_0x29381f[0x0]===0xfe&&_0x29381f[0x1]===0xff)return console['log']('检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。'),new TextDecoder(_0x3ef321(0xe6d))[_0x3ef321(0xe22)](_0x29381f);try{console[_0x3ef321(0x471)](_0x3ef321(0x763));const _0x166d9e=new TextDecoder(_0x3ef321(0xee7),{'fatal':!![]})[_0x3ef321(0xe22)](_0x29381f);return console[_0x3ef321(0x471)](_0x3ef321(0x83b)),_0x166d9e;}catch(_0x39e5cb){console[_0x3ef321(0x471)]('UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...');try{const _0x137de4=new TextDecoder(_0x3ef321(0x10b0))[_0x3ef321(0xe22)](_0x29381f);return console[_0x3ef321(0x471)](_0x3ef321(0x1324)),_0x137de4;}catch(_0x204702){console['error'](_0x3ef321(0x10f6),_0x204702);throw new Error('无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。');}}}async function _0x1854a(_0x27e921){const _0x1247bb=_0x41eae2,_0x454582=_0x27e921[_0x1247bb(0x225)][_0x1247bb(0x541)][0x0];if(!_0x454582)return;try{const _0x28d4c9=await _0x454582[_0x1247bb(0x4a9)](),_0x1f15a6=await _0x318bcd(_0x28d4c9),_0x19ed54=_0x454582[_0x1247bb(0xf74)]['replace'](/\.txt$/i,''),_0x12ac29=await _0x1a6951['readingLibrary'][_0x1247bb(0x569)]({'title':_0x19ed54,'content':_0x1f15a6,'lastOpened':Date[_0x1247bb(0xf1a)]()});await _0x8eac59(_0x12ac29),document[_0x1247bb(0x89d)](_0x1247bb(0x1a9))[_0x1247bb(0x2f1)]['contains'](_0x1247bb(0x11e4))&&_0x261968();}catch(_0x2ac705){console[_0x1247bb(0x1fd)](_0x1247bb(0x956),_0x2ac705),await _0x532f76(_0x1247bb(0x53d),_0x2ac705[_0x1247bb(0x1288)]);}finally{_0x27e921['target'][_0x1247bb(0x2f4)]=null;}}async function _0x453a00(){const _0x5b2f22=_0x41eae2,_0x579f16=_0x5b873d[_0x5b2f22(0xf96)];if(!_0x579f16)return;const _0x267546=_0x2aadc5[_0x579f16];if(!_0x267546||_0x267546[_0x5b2f22(0xdef)]<=0x1)return;const _0x2b8933=await _0x34d246(_0x5b2f22(0x46b),_0x5b2f22(0x1077)+_0x267546[_0x5b2f22(0xdef)]+')',_0x267546[_0x5b2f22(0x106f)]+0x1);if(_0x2b8933===null)return;const _0x189ffe=parseInt(_0x2b8933);if(isNaN(_0x189ffe)||_0x189ffe<0x1||_0x189ffe>_0x267546[_0x5b2f22(0xdef)]){alert(_0x5b2f22(0x453));return;}_0x267546[_0x5b2f22(0x106f)]=_0x189ffe-0x1,_0x3e3d30(_0x579f16),_0x1ea23b(_0x267546['activeBookId'],_0x267546[_0x5b2f22(0x106f)]);}async function _0x1ea23b(_0x5a6180,_0x55f106){const _0x494bb2=_0x41eae2;if(!_0x5a6180)return;try{await _0x1a6951['readingLibrary'][_0x494bb2(0xdfc)](_0x5a6180,{'currentPage':_0x55f106});}catch(_0x3101bd){console[_0x494bb2(0x1fd)](_0x494bb2(0xf85)+_0x5a6180+_0x494bb2(0xbca),_0x3101bd);}}async function _0xa63197(){const _0x5e1f4c=_0x41eae2,_0x44bb5f=_0x2aadc5[_0x5b873d[_0x5e1f4c(0xf96)]];_0x44bb5f&&_0x44bb5f[_0x5e1f4c(0x106f)]<_0x44bb5f[_0x5e1f4c(0xdef)]-0x1&&(_0x44bb5f['currentPage']++,_0x3e3d30(_0x5b873d[_0x5e1f4c(0xf96)]),document[_0x5e1f4c(0x89d)](_0x5e1f4c(0x951))[_0x5e1f4c(0xb0e)]=0x0,await _0x1ea23b(_0x44bb5f[_0x5e1f4c(0x1125)],_0x44bb5f[_0x5e1f4c(0x106f)]),await notifyAiOfPageTurn(_0x5b873d[_0x5e1f4c(0xf96)],_0x44bb5f));}function _0x34140c(_0x565ee2,_0x443445){const _0x2b904f=_0x41eae2,_0x4cfcd8=_0x5b873d[_0x2b904f(0xf96)];if(!_0x4cfcd8)return;const _0x3c325c=_0x2aadc5[_0x4cfcd8];_0x3c325c[_0x2b904f(0x104c)]=_0x565ee2[_0x2b904f(0xfbf)](/\.txt$/i,''),_0x3c325c['contentLines']=_0x443445[_0x2b904f(0x55b)](/\r\n?|\n/)[_0x2b904f(0x412)](_0x1d8d9b=>_0x1d8d9b['replace'](/ +/g,'\x20')),_0x3c325c[_0x2b904f(0xdef)]=Math['ceil'](_0x3c325c['contentLines'][_0x2b904f(0x7aa)]/_0x3c325c[_0x2b904f(0x109f)]),_0x3c325c[_0x2b904f(0x106f)]=0x0,_0x3e3d30(_0x4cfcd8);}async function _0x17af5(){const _0x24e17c=_0x41eae2;document['getElementById'](_0x24e17c(0x5a2))[_0x24e17c(0x2f4)]='',await _0x261968(),document['getElementById']('reading-library-modal')[_0x24e17c(0x2f1)][_0x24e17c(0x569)](_0x24e17c(0x11e4));}async function _0x261968(_0x420d1d=''){const _0xfeb159=_0x41eae2,_0xed2bc4=document['getElementById'](_0xfeb159(0x75b));let _0x3beaa1=await _0x1a6951[_0xfeb159(0xd79)][_0xfeb159(0x6ed)](_0xfeb159(0xe39))['reverse']()[_0xfeb159(0xc2f)]();_0xed2bc4['innerHTML']='';_0x420d1d&&(_0x3beaa1=_0x3beaa1[_0xfeb159(0x3d8)](_0x545714=>_0x545714[_0xfeb159(0x104c)][_0xfeb159(0x124b)]()[_0xfeb159(0xced)](_0x420d1d[_0xfeb159(0x124b)]())));if(_0x3beaa1[_0xfeb159(0x7aa)]===0x0){const _0x3cdeaf=_0x420d1d?'找不到匹配的书籍':_0xfeb159(0x756);_0xed2bc4[_0xfeb159(0x1ef)]=_0xfeb159(0x77e)+_0x3cdeaf+_0xfeb159(0x164);return;}_0x3beaa1[_0xfeb159(0xd9a)](_0x29bea6=>{const _0x50cea9=_0xfeb159,_0x42bda4=document[_0x50cea9(0x285)](_0x50cea9(0xb25));_0x42bda4[_0x50cea9(0x81c)]=_0x50cea9(0xebb),_0x42bda4[_0x50cea9(0x1ef)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22'+_0x29bea6['id']+'\x22>'+_0x29bea6[_0x50cea9(0x104c)]+_0x50cea9(0x524)+_0x29bea6['id']+_0x50cea9(0x513),_0xed2bc4[_0x50cea9(0x22f)](_0x42bda4);});}async function _0x8eac59(_0x3498db){const _0x53dd57=_0x41eae2,_0x37d788=_0x5b873d['activeChatId'];if(!_0x37d788)return;const _0x2d6839=await _0x1a6951['readingLibrary']['get'](_0x3498db);if(!_0x2d6839){alert(_0x53dd57(0x692));return;}await _0x1a6951['readingLibrary'][_0x53dd57(0xdfc)](_0x3498db,{'lastOpened':Date['now']()});const _0x37c7bc=_0x2aadc5[_0x37d788];_0x37c7bc[_0x53dd57(0x1125)]=_0x3498db,_0x37c7bc['title']=_0x2d6839[_0x53dd57(0x104c)],_0x37c7bc[_0x53dd57(0x76b)]=_0x2d6839[_0x53dd57(0x28c)][_0x53dd57(0x55b)](/\r\n?|\n/)[_0x53dd57(0x412)](_0x7d58cb=>_0x7d58cb[_0x53dd57(0xfbf)](/ +/g,'\x20')),_0x37c7bc['totalPages']=Math[_0x53dd57(0x11fd)](_0x37c7bc['contentLines'][_0x53dd57(0x7aa)]/_0x37c7bc[_0x53dd57(0x109f)]),_0x37c7bc[_0x53dd57(0x106f)]=_0x2d6839['currentPage']||0x0,_0x3e3d30(_0x37d788),document['getElementById']('reading-content')['scrollTop']=0x0,document[_0x53dd57(0x89d)](_0x53dd57(0x1a9))[_0x53dd57(0x2f1)]['remove']('visible');}async function _0x4ae83c(_0x3ec706){const _0xbb9544=_0x41eae2,_0x49370f=await _0x1a6951['readingLibrary']['get'](_0x3ec706);if(!_0x49370f)return;const _0x65adbc=await _0x4e2abc(_0xbb9544(0xb09),_0xbb9544(0x1203)+_0x49370f[_0xbb9544(0x104c)]+_0xbb9544(0x80a),{'confirmButtonClass':_0xbb9544(0xcd8)});_0x65adbc&&(await _0x1a6951[_0xbb9544(0xd79)][_0xbb9544(0x684)](_0x3ec706),await _0x261968());}function _0x34140c(_0x2e3585,_0x2e9cb5){const _0x5c79b9=_0x41eae2,_0x53b56a=_0x5b873d['activeChatId'];if(!_0x53b56a)return;const _0xd92a11=_0x2aadc5[_0x53b56a];_0xd92a11[_0x5c79b9(0x104c)]=_0x2e3585['replace'](/\.txt$/i,''),_0xd92a11[_0x5c79b9(0x76b)]=_0x2e9cb5[_0x5c79b9(0x55b)](/\r\n?|\n/),_0xd92a11[_0x5c79b9(0xdef)]=Math['ceil'](_0xd92a11['contentLines'][_0x5c79b9(0x7aa)]/_0xd92a11[_0x5c79b9(0x109f)]),_0xd92a11['currentPage']=0x0,_0x3e3d30(_0x53b56a);}function _0xac139e(_0x5ebd60,_0x2ee86a){const _0x41b3a6=_0x41eae2;let _0x4e0c09=0x0,_0x872097=0x0,_0x3d276e=0x0,_0x3f0beb=0x0,_0x55d0d2=![],_0x40f17e=![];const _0x58c3a7=document[_0x41b3a6(0x89d)](_0x41b3a6(0x34e)),_0x4fa738=_0x2813e3=>{const _0x2f9558=_0x41b3a6;if(_0x5ebd60!==_0x2ee86a&&_0x2813e3[_0x2f9558(0x225)]['closest'](_0x2f9558(0x5af)))return;_0x55d0d2=!![],_0x40f17e=![];const _0x56f615=_0x2813e3[_0x2f9558(0x48c)]===_0x2f9558(0x74f)?_0x2813e3[_0x2f9558(0xe9e)][0x0]:_0x2813e3;_0x3d276e=_0x56f615[_0x2f9558(0xc12)],_0x3f0beb=_0x56f615['clientY'],_0x5ebd60[_0x2f9558(0x68e)][_0x2f9558(0x113d)]=_0x5ebd60['offsetTop']+'px',_0x5ebd60['style'][_0x2f9558(0x1004)]=_0x5ebd60[_0x2f9558(0x224)]+'px',_0x5ebd60[_0x2f9558(0x68e)]['transform']='',document[_0x2f9558(0x1193)](_0x2f9558(0x1dd),_0x32d76d),document[_0x2f9558(0x1193)](_0x2f9558(0xf4d),_0x1fc0f9),document['addEventListener']('touchend',_0x32d76d),document[_0x2f9558(0x1193)](_0x2f9558(0xe3f),_0x1fc0f9,{'passive':![]});},_0x1fc0f9=_0x4fb1bd=>{const _0x30eb61=_0x41b3a6;if(!_0x55d0d2)return;const _0x26c622=_0x4fb1bd[_0x30eb61(0x48c)]===_0x30eb61(0xe3f)?_0x4fb1bd[_0x30eb61(0xe9e)][0x0]:_0x4fb1bd,_0x44053e=_0x26c622[_0x30eb61(0xc12)]-_0x3d276e,_0x4f3b21=_0x26c622[_0x30eb61(0x4b8)]-_0x3f0beb;!_0x40f17e&&(Math[_0x30eb61(0xe10)](_0x44053e)>0x5||Math[_0x30eb61(0xe10)](_0x4f3b21)>0x5)&&(_0x40f17e=!![]);_0x40f17e&&_0x4fb1bd[_0x30eb61(0xb7c)]&&_0x4fb1bd[_0x30eb61(0xd06)]();_0x4e0c09=_0x3d276e-_0x26c622[_0x30eb61(0xc12)],_0x872097=_0x3f0beb-_0x26c622[_0x30eb61(0x4b8)],_0x3d276e=_0x26c622[_0x30eb61(0xc12)],_0x3f0beb=_0x26c622['clientY'];let _0x22cc98=_0x5ebd60[_0x30eb61(0x8e3)]-_0x872097,_0x959e3a=_0x5ebd60['offsetLeft']-_0x4e0c09;const _0x1e67c3=_0x58c3a7[_0x30eb61(0x95a)]-_0x5ebd60[_0x30eb61(0x121a)]-0xa,_0x4faa4b=_0x58c3a7[_0x30eb61(0x2fd)]-_0x5ebd60[_0x30eb61(0xf13)]-0xa;_0x22cc98=Math[_0x30eb61(0x88d)](0xa,Math['min'](_0x22cc98,_0x1e67c3)),_0x959e3a=Math[_0x30eb61(0x88d)](0xa,Math[_0x30eb61(0x1169)](_0x959e3a,_0x4faa4b)),_0x5ebd60['style']['top']=_0x22cc98+'px',_0x5ebd60[_0x30eb61(0x68e)][_0x30eb61(0x1004)]=_0x959e3a+'px';},_0x32d76d=()=>{const _0x166f10=_0x41b3a6;document[_0x166f10(0xcbb)]('mouseup',_0x32d76d),document[_0x166f10(0xcbb)]('mousemove',_0x1fc0f9),document[_0x166f10(0xcbb)](_0x166f10(0xc95),_0x32d76d),document[_0x166f10(0xcbb)](_0x166f10(0xe3f),_0x1fc0f9);if(!_0x55d0d2)return;_0x55d0d2=![],!_0x40f17e&&_0x5ebd60[_0x166f10(0x12a5)]();};_0x2ee86a['addEventListener']('mousedown',_0x4fa738),_0x2ee86a[_0x41b3a6(0x1193)]('touchstart',_0x4fa738,{'passive':![]});}function _0x3ed521(){const _0x2661b5=_0x41eae2,_0x480d47=_0x2aadc5[_0x5b873d[_0x2661b5(0xf96)]];if(!_0x480d47||!_0x480d47[_0x2661b5(0xfcb)])return;document[_0x2661b5(0x89d)](_0x2661b5(0x4ee))['classList']['add'](_0x2661b5(0x31c)),document['getElementById'](_0x2661b5(0x12e6))[_0x2661b5(0x68e)][_0x2661b5(0x126b)]=_0x2661b5(0x66e),_0x480d47['isMinimized']=!![];}function _0x1ea546(){const _0x5b29af=_0x41eae2,_0x542a26=_0x2aadc5[_0x5b873d[_0x5b29af(0xf96)]];if(!_0x542a26||!_0x542a26['isActive'])return;document[_0x5b29af(0x89d)](_0x5b29af(0x12e6))[_0x5b29af(0x68e)]['display']=_0x5b29af(0x10f2),document[_0x5b29af(0x89d)](_0x5b29af(0x4ee))['classList']['remove'](_0x5b29af(0x31c)),_0x542a26['isMinimized']=![];}function _0x31ad99(_0x5932af,_0x43ec4e){let _0xeef5ee;return function(..._0x250ea3){const _0x4351eb=_0x356e,_0x2ffa70=this;clearTimeout(_0xeef5ee),_0xeef5ee=setTimeout(()=>_0x5932af[_0x4351eb(0x88a)](_0x2ffa70,_0x250ea3),_0x43ec4e);};}function _0x3c8588(_0x44510e){const _0x5e8ccd=_0x41eae2,_0x54c65b=_0x2aadc5[_0x44510e];if(!_0x54c65b||!_0x54c65b['isActive'])return'';const _0x4cb6da=_0x54c65b[_0x5e8ccd(0x104c)]||_0x5e8ccd(0x1df);let _0xd6b6aa='',_0x1af442='';if(_0x54c65b['currentSnippet']&&_0x54c65b[_0x5e8ccd(0xef3)]['trim']())_0xd6b6aa=_0x54c65b['currentSnippet'],_0x1af442=_0x5e8ccd(0x363);else{if(_0x54c65b['contentLines'][_0x5e8ccd(0x7aa)]>0x0){const _0x43229c=_0x54c65b[_0x5e8ccd(0x106f)]*_0x54c65b[_0x5e8ccd(0x109f)],_0x299f3c=_0x43229c+_0x54c65b[_0x5e8ccd(0x109f)];_0xd6b6aa=_0x54c65b[_0x5e8ccd(0x76b)][_0x5e8ccd(0xdd0)](_0x43229c,_0x299f3c)[_0x5e8ccd(0x1237)]('\x0a')[_0x5e8ccd(0x489)](0x0,0xc8),_0x1af442='当前页内容摘要';}else _0xd6b6aa=_0x5e8ccd(0x1291),_0x1af442='内容';}return _0x5e8ccd(0x4f4)+_0x4cb6da+'》\x0a\x20\x20\x20\x20-\x20**'+_0x1af442+_0x5e8ccd(0xdf5)+_0xd6b6aa+'...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】('+(_0x5b873d['chats'][_0x44510e]?.[_0x5e8ccd(0x1045)]||'AI角色')+')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a';}function _0x477252(){const _0x5dd9d9=_0x41eae2,_0x39021b=_0x5b873d['activeChatId'];if(!_0x39021b||!_0x2aadc5[_0x39021b])return;const _0x3dc4d2=_0x2aadc5[_0x39021b],_0x439704=document[_0x5dd9d9(0x89d)]('reading-content'),_0x7cce33=_0x439704[_0x5dd9d9(0xb0e)],_0x43e2f5=_0x439704[_0x5dd9d9(0x95a)],_0x1d152f=_0x7cce33+_0x43e2f5,_0x1faaf2=0xf*1.8,_0x3e49f8=Math[_0x5dd9d9(0x128a)](_0x7cce33/_0x1faaf2),_0x1ffecf=Math[_0x5dd9d9(0x11fd)](_0x1d152f/_0x1faaf2),_0x24a8a4=_0x3dc4d2['currentPage']*_0x3dc4d2[_0x5dd9d9(0x109f)]+_0x3e49f8,_0x47c683=_0x3dc4d2[_0x5dd9d9(0x106f)]*_0x3dc4d2[_0x5dd9d9(0x109f)]+_0x1ffecf;if(_0x24a8a4<0x0||_0x24a8a4>=_0x3dc4d2['contentLines'][_0x5dd9d9(0x7aa)])return;const _0x1b5753=_0x3dc4d2['contentLines'][_0x5dd9d9(0xdd0)](Math['max'](0x0,_0x24a8a4),Math['min'](_0x3dc4d2[_0x5dd9d9(0x76b)][_0x5dd9d9(0x7aa)],_0x47c683))['join']('\x0a');_0x3dc4d2['currentSnippet']=_0x1b5753;}function _0x1093fc(){const _0x5f1b25=_0x41eae2,_0x5b0ebf=document['getElementById'](_0x5f1b25(0x29f));if(_0x5b0ebf){const _0x2defe4=_0x5b0ebf['play']();_0x2defe4!==undefined&&_0x2defe4['then'](_0x2eba9e=>{console['log']('静音音频已启动，用于后台活动保活。');})[_0x5f1b25(0x1035)](_0x2ec756=>{const _0x3fa174=_0x5f1b25;console[_0x3fa174(0xac3)](_0x3fa174(0x979),_0x2ec756);});}}function _0x47fec8(){const _0x1cecd7=_0x41eae2,_0x52b6f4=document[_0x1cecd7(0x89d)](_0x1cecd7(0x29f));_0x52b6f4&&!_0x52b6f4[_0x1cecd7(0xc80)]&&(_0x52b6f4[_0x1cecd7(0xfb2)](),_0x52b6f4[_0x1cecd7(0x133c)]=0x0,console[_0x1cecd7(0x471)](_0x1cecd7(0x90e)));}async function _0x35af80(_0x527dd7){const _0x2bd910=_0x41eae2,_0xdfe1ce=decodeURIComponent(_0x527dd7[_0x2bd910(0xaaf)][_0x2bd910(0xec9)]),_0x369f5c=_0x527dd7[_0x2bd910(0xaaf)][_0x2bd910(0xa97)],_0x1321ea=_0x527dd7[_0x2bd910(0xd16)]('.voice-play-btn'),_0x5dd0f9=_0x527dd7[_0x2bd910(0xd16)](_0x2bd910(0x274)),_0x24dcc3=document[_0x2bd910(0x89d)](_0x2bd910(0xf6d));if(!_0x24dcc3[_0x2bd910(0xc80)]&&_0x24dcc3['dataset'][_0x2bd910(0x239)]===_0xdfe1ce&&_0x24dcc3[_0x2bd910(0xaaf)][_0x2bd910(0x131b)]===_0x369f5c){_0x24dcc3['pause']();return;}_0x24dcc3[_0x2bd910(0xfb2)](),document['querySelectorAll']('.voice-play-btn')['forEach'](_0x517c50=>_0x517c50['textContent']='▶');const _0x3818e0=_0x2bd910(0x674)+_0x369f5c+'_'+_0xdfe1ce;let _0x51969e=_0x5b873d[_0x2bd910(0x112b)][_0x2bd910(0x650)](_0x3818e0);if(_0x51969e){console[_0x2bd910(0x471)]('从缓存播放\x20TTS\x20音频...'),await _0x40958a(_0x51969e[_0x2bd910(0x11de)],_0x51969e['type'],_0xdfe1ce,_0x369f5c,_0x527dd7);return;}console[_0x2bd910(0x471)]('无缓存，正在请求\x20Minimax\x20TTS\x20API...');if(_0x1321ea)_0x1321ea[_0x2bd910(0x68e)][_0x2bd910(0x126b)]=_0x2bd910(0x10f2);_0x5dd0f9[_0x2bd910(0x68e)][_0x2bd910(0x126b)]='block';const {minimaxGroupId:_0x26e3bc,minimaxApiKey:_0x11d286}=_0x5b873d[_0x2bd910(0x30d)];if(!_0x26e3bc||!_0x11d286){await _0x532f76(_0x2bd910(0x12fa),'请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。'),_0x5dd0f9[_0x2bd910(0x68e)]['display']=_0x2bd910(0x10f2);if(_0x1321ea)_0x1321ea[_0x2bd910(0x68e)][_0x2bd910(0x126b)]=_0x2bd910(0x66e);return;}try{const _0x56422e=await fetch(_0x2bd910(0x672)+_0x26e3bc,{'method':'POST','headers':{'Authorization':'Bearer\x20'+_0x11d286,'Content-Type':_0x2bd910(0xce4)},'body':JSON[_0x2bd910(0x465)]({'text':_0xdfe1ce,'voice_id':_0x369f5c,'model':_0x5b873d[_0x2bd910(0x30d)][_0x2bd910(0xeb8)]||_0x2bd910(0x947),'speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0x56422e['ok']){let _0x47f74a='API\x20返回错误:\x20'+_0x56422e[_0x2bd910(0x632)];try{const _0x4442fe=await _0x56422e[_0x2bd910(0x6b5)]();_0x47f74a=_0x4442fe[_0x2bd910(0xe29)]?.['status_msg']||JSON[_0x2bd910(0x465)](_0x4442fe);}catch(_0x317abf){_0x47f74a=await _0x56422e[_0x2bd910(0xec9)]();}throw new Error(_0x47f74a);}const _0x5f0fb3=await _0x56422e[_0x2bd910(0x122f)](),_0x4d93c4=URL['createObjectURL'](_0x5f0fb3);await _0x40958a(_0x4d93c4,_0x5f0fb3[_0x2bd910(0x48c)],_0xdfe1ce,_0x369f5c,_0x527dd7);const _0x2d9a60=new FileReader();_0x2d9a60[_0x2bd910(0x12f2)]=function(){const _0x5c3a10=_0x2bd910;_0x5b873d[_0x5c3a10(0x112b)][_0x5c3a10(0xd3f)](_0x3818e0,{'url':_0x2d9a60[_0x5c3a10(0x9dc)],'type':_0x5f0fb3['type']}),console[_0x5c3a10(0x471)]('TTS\x20音频已保存到缓存。');},_0x2d9a60[_0x2bd910(0x5b4)](_0x5f0fb3);}catch(_0x3f543e){console[_0x2bd910(0x1fd)](_0x2bd910(0xba3),_0x3f543e),await _0x532f76(_0x2bd910(0x824),'错误:\x20'+_0x3f543e[_0x2bd910(0x1288)]);}finally{_0x5dd0f9[_0x2bd910(0x68e)]['display']=_0x2bd910(0x10f2);if(_0x1321ea)_0x1321ea['style'][_0x2bd910(0x126b)]='flex';}}function _0x40958a(_0x4efbde,_0x1d1269,_0x4633d2,_0x16f683,_0x466a19){return new Promise((_0x2c8d46,_0x5149d8)=>{const _0x100129=_0x356e,_0x355fd5=document[_0x100129(0x89d)](_0x100129(0xf6d));_0x355fd5[_0x100129(0x9e3)]=_0x4efbde,_0x355fd5[_0x100129(0x48c)]=_0x1d1269,_0x355fd5[_0x100129(0xaaf)][_0x100129(0x239)]=_0x4633d2,_0x355fd5[_0x100129(0xaaf)]['currentVoiceId']=_0x16f683;const _0x97fc77=_0x355fd5['play']();_0x97fc77!==undefined&&_0x97fc77['then'](()=>{const _0x136e25=_0x100129,_0x3c26c4=_0x466a19[_0x136e25(0xd16)]('.voice-play-btn');if(_0x3c26c4)_0x3c26c4[_0x136e25(0xf12)]='❚❚';_0x2c8d46();})[_0x100129(0x1035)](_0x4a3578=>{const _0x25a8c1=_0x100129;console['error'](_0x25a8c1(0x1286),_0x4a3578),_0x5149d8(_0x4a3578);}),_0x355fd5[_0x100129(0xb78)]=()=>{const _0x18a24c=_0x100129,_0x35ecb0=_0x466a19['querySelector'](_0x18a24c(0x276));if(_0x35ecb0)_0x35ecb0[_0x18a24c(0xf12)]='▶';},_0x355fd5[_0x100129(0xe74)]=()=>{const _0x297e25=_0x100129,_0x13ed73=_0x466a19[_0x297e25(0xd16)](_0x297e25(0x276));if(_0x13ed73)_0x13ed73['textContent']='▶';};});}function _0x271da1(_0x2d0704){const _0x2aedea=_0x41eae2,_0xbffaa=_0x2d0704[_0x2aedea(0x53a)]('.message-bubble');if(!_0xbffaa)return;const _0x544261=_0xbffaa[_0x2aedea(0xd16)]('.voice-transcript'),_0x4afe6d=decodeURIComponent(_0x2d0704[_0x2aedea(0xaaf)]['text']);_0x544261[_0x2aedea(0x68e)][_0x2aedea(0x126b)]===_0x2aedea(0x1118)?_0x544261[_0x2aedea(0x68e)][_0x2aedea(0x126b)]=_0x2aedea(0x10f2):(_0x544261[_0x2aedea(0xf12)]=_0x4afe6d,_0x544261[_0x2aedea(0x68e)][_0x2aedea(0x126b)]='block');}async function _0x4209ee(){const _0x52b5b2=_0x41eae2;await _0x23d47f(),document['getElementById']('product-category-manager-modal')[_0x52b5b2(0x2f1)]['add'](_0x52b5b2(0x11e4));}async function _0x23d47f(){const _0x1b70f2=_0x41eae2,_0x574307=document[_0x1b70f2(0x89d)](_0x1b70f2(0x458)),_0x21f270=await _0x1a6951[_0x1b70f2(0x110d)][_0x1b70f2(0xc2f)]();_0x574307['innerHTML']='';if(_0x21f270[_0x1b70f2(0x7aa)]===0x0){_0x574307['innerHTML']=_0x1b70f2(0x10e7);return;}_0x21f270[_0x1b70f2(0xd9a)](_0x9b1e0f=>{const _0x462d10=_0x1b70f2,_0x129815=document['createElement'](_0x462d10(0xb25));_0x129815['className']=_0x462d10(0xebb),_0x129815[_0x462d10(0x1ef)]=_0x462d10(0xf00)+_0x9b1e0f[_0x462d10(0xf74)]+_0x462d10(0x735)+_0x9b1e0f['id']+_0x462d10(0xe31),_0x574307[_0x462d10(0x22f)](_0x129815);});}async function _0x8044c(){const _0x110d86=_0x41eae2,_0x1296a5=document[_0x110d86(0x89d)](_0x110d86(0xf06)),_0x1db19c=_0x1296a5['value'][_0x110d86(0xc3a)]();if(!_0x1db19c)return alert('分类名不能为空！');const _0x9ec9ab=await _0x1a6951[_0x110d86(0x110d)][_0x110d86(0x176)](_0x110d86(0xf74))['equals'](_0x1db19c)['first']();if(_0x9ec9ab)return alert(_0x110d86(0xe5c)+_0x1db19c+_0x110d86(0x19c));await _0x1a6951[_0x110d86(0x110d)][_0x110d86(0x569)]({'name':_0x1db19c}),_0x1296a5['value']='',await _0x23d47f();}async function _0x480a54(_0xdc96ad){const _0x201d7f=_0x41eae2,_0x193450=await _0x4e2abc(_0x201d7f(0x3da),_0x201d7f(0x11d1),{'confirmButtonClass':_0x201d7f(0xcd8)});_0x193450&&(await _0x1a6951[_0x201d7f(0x110d)][_0x201d7f(0x684)](_0xdc96ad),await _0x1a6951['shoppingProducts']['where'](_0x201d7f(0xcb1))[_0x201d7f(0xb17)](_0xdc96ad)['modify']({'categoryId':null}),await _0x23d47f());}function _0x455dc1(_0x525db1={}){const _0x573e90=_0x41eae2,_0x6b9cbe=document[_0x573e90(0x89d)](_0x573e90(0xac6)),_0x3e0155=document[_0x573e90(0x285)](_0x573e90(0xb25));return _0x3e0155[_0x573e90(0x81c)]=_0x573e90(0xc50),_0x3e0155['innerHTML']=_0x573e90(0xb2b)+(_0x525db1[_0x573e90(0xf74)]||'')+_0x573e90(0xb2c)+(_0x525db1[_0x573e90(0x162)]||'')+_0x573e90(0x11cd)+(_0x525db1[_0x573e90(0x450)]||'https://i.postimg.cc/PqYp5T5M/image.png')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x3e0155['querySelector']('.delete-block-btn')[_0x573e90(0x1193)](_0x573e90(0x12a5),()=>_0x3e0155[_0x573e90(0x1247)]()),_0x3e0155[_0x573e90(0xd16)](_0x573e90(0xa66))[_0x573e90(0x1193)](_0x573e90(0x12a5),()=>{const _0x210493=_0x573e90;_0x3e0155['querySelector']('.variation-image-input')[_0x210493(0x12a5)]();}),_0x3e0155[_0x573e90(0xd16)]('.variation-image-input')[_0x573e90(0x1193)](_0x573e90(0x76c),_0x3bc083=>{const _0x4e111a=_0x573e90,_0x134dff=_0x3bc083[_0x4e111a(0x225)][_0x4e111a(0x541)][0x0];if(_0x134dff){const _0x41e443=new FileReader();_0x41e443['onload']=_0x469470=>{const _0x2ae0e8=_0x4e111a;_0x3e0155[_0x2ae0e8(0xd16)]('.variation-image-preview')['src']=_0x469470[_0x2ae0e8(0x225)][_0x2ae0e8(0x9dc)];},_0x41e443['readAsDataURL'](_0x134dff);}}),_0x6b9cbe[_0x573e90(0x22f)](_0x3e0155),_0x3e0155;}async function _0x248079(_0x4001fd){const _0xecda01=_0x41eae2,_0x257289=await _0x1a6951[_0xecda01(0xa6d)][_0xecda01(0x650)](_0x4001fd);if(!_0x257289||!_0x257289[_0xecda01(0x3d4)]||_0x257289[_0xecda01(0x3d4)][_0xecda01(0x7aa)]===0x0)return;const _0x563a0f=document['getElementById'](_0xecda01(0xd26));document[_0xecda01(0x89d)](_0xecda01(0xfb5))['src']=_0x257289[_0xecda01(0x450)],document[_0xecda01(0x89d)]('variation-product-name')[_0xecda01(0xf12)]=_0x257289[_0xecda01(0xf74)];const _0x1dc867=document['getElementById']('variation-options-container');_0x1dc867[_0xecda01(0x1ef)]='',_0x257289[_0xecda01(0x3d4)]['forEach']((_0xa09751,_0x3fa4d9)=>{const _0x377069=_0xecda01,_0x448801=document[_0x377069(0x285)](_0x377069(0x104f));_0x448801['type']=_0x377069(0x26b),_0x448801[_0x377069(0xf74)]=_0x377069(0x172),_0x448801['id']=_0x377069(0x123f)+_0x4001fd+'-'+_0x3fa4d9,_0x448801['value']=_0x3fa4d9,_0x448801[_0x377069(0x68e)][_0x377069(0x126b)]=_0x377069(0x10f2);if(_0x3fa4d9===0x0)_0x448801[_0x377069(0x1b0)]=!![];const _0x230e49=document[_0x377069(0x285)](_0x377069(0x772));_0x230e49[_0x377069(0x10df)]='var-'+_0x4001fd+'-'+_0x3fa4d9,_0x230e49[_0x377069(0xf12)]=_0xa09751[_0x377069(0xf74)],_0x230e49[_0x377069(0x68e)][_0x377069(0x137a)]=_0x377069(0x9e4),_0x1dc867['appendChild'](_0x448801),_0x1dc867[_0x377069(0x22f)](_0x230e49);});const _0x683ab3=()=>{const _0x54ab28=_0xecda01,_0xfb2e6=_0x1dc867['querySelector']('input[name=\x22variation-select\x22]:checked');_0x1dc867[_0x54ab28(0x35f)](_0x54ab28(0x772))['forEach'](_0x34385e=>{const _0x2c6f8e=_0x54ab28;_0x34385e['style'][_0x2c6f8e(0xb03)]=_0x2c6f8e(0xc79),_0x34385e[_0x2c6f8e(0x68e)][_0x2c6f8e(0x56b)]=_0x2c6f8e(0xe57),_0x34385e[_0x2c6f8e(0x68e)][_0x2c6f8e(0x96c)]='white';});if(_0xfb2e6){const _0x5ae1a3=_0x1dc867['querySelector']('label[for=\x22'+_0xfb2e6['id']+'\x22]');_0x5ae1a3[_0x54ab28(0x68e)][_0x54ab28(0xb03)]=_0x54ab28(0xa6b),_0x5ae1a3[_0x54ab28(0x68e)][_0x54ab28(0x56b)]='var(--accent-color)',_0x5ae1a3['style'][_0x54ab28(0x96c)]='#e7f3ff';const _0x49bb37=_0x257289[_0x54ab28(0x3d4)][parseInt(_0xfb2e6[_0x54ab28(0x2f4)])];document[_0x54ab28(0x89d)](_0x54ab28(0x6ad))[_0x54ab28(0xf12)]='¥'+_0x49bb37['price'][_0x54ab28(0x8f7)](0x2),_0x49bb37[_0x54ab28(0x450)]?document[_0x54ab28(0x89d)]('variation-product-image')[_0x54ab28(0x9e3)]=_0x49bb37[_0x54ab28(0x450)]:document[_0x54ab28(0x89d)](_0x54ab28(0xfb5))['src']=_0x257289['imageUrl'];}};_0x1dc867['addEventListener'](_0xecda01(0x76c),_0x683ab3),_0x683ab3(),document['getElementById'](_0xecda01(0x1362))[_0xecda01(0xf12)]='1';const _0xe18a06=document[_0xecda01(0x89d)](_0xecda01(0x803)),_0x4b79e3=_0xe18a06[_0xecda01(0xf2a)](!![]);_0xe18a06['parentNode'][_0xecda01(0xd38)](_0x4b79e3,_0xe18a06),_0x4b79e3['addEventListener'](_0xecda01(0x12a5),async()=>{const _0x4166e5=_0xecda01,_0x384113=_0x1dc867['querySelector']('input[name=\x22variation-select\x22]:checked'),_0x3e062a=parseInt(document[_0x4166e5(0x89d)]('variation-quantity-display')['textContent']);if(_0x384113){const _0x2600d1=_0x257289[_0x4166e5(0x3d4)][parseInt(_0x384113['value'])];await _0x193b17(_0x4001fd,_0x3e062a,_0x2600d1),_0x563a0f[_0x4166e5(0x2f1)][_0x4166e5(0x1247)](_0x4166e5(0x11e4)),await _0x532f76('成功',_0x4166e5(0xe3b));}}),_0x563a0f[_0xecda01(0x2f1)][_0xecda01(0x569)](_0xecda01(0x11e4));}function _0x4d916b(){const _0x3c12b0=_0x41eae2,_0x208cc1=document[_0x3c12b0(0x89d)](_0x3c12b0(0xa81));document[_0x3c12b0(0x89d)]('shopping-category-count-input')['value']=_0x5b873d[_0x3c12b0(0x21a)][_0x3c12b0(0x266)]||0x3,document[_0x3c12b0(0x89d)](_0x3c12b0(0xa4e))[_0x3c12b0(0x2f4)]=_0x5b873d[_0x3c12b0(0x21a)][_0x3c12b0(0x1001)]||0x8,_0x208cc1[_0x3c12b0(0x2f1)]['add'](_0x3c12b0(0x11e4));}async function _0x36944a(){const _0x555638=_0x41eae2,_0x31d567=document[_0x555638(0x89d)](_0x555638(0x8f0)),_0x18dfe5=document['getElementById']('shopping-product-count-input'),_0x223bb9=parseInt(_0x31d567['value']),_0x2d8d93=parseInt(_0x18dfe5[_0x555638(0x2f4)]);if(isNaN(_0x223bb9)||isNaN(_0x2d8d93)||_0x223bb9<0x1||_0x2d8d93<0x1){alert('请输入有效的正整数！');return;}_0x5b873d[_0x555638(0x21a)]['shoppingCategoryCount']=_0x223bb9,_0x5b873d[_0x555638(0x21a)][_0x555638(0x1001)]=_0x2d8d93,await _0x1a6951['globalSettings'][_0x555638(0xc0f)](_0x5b873d[_0x555638(0x21a)]),document[_0x555638(0x89d)](_0x555638(0xa81))['classList'][_0x555638(0x1247)](_0x555638(0x11e4)),await _0x532f76(_0x555638(0x5dd),_0x555638(0x3f2));}async function _0x3b7c26(){const _0x219518=_0x41eae2;if(!_0x5b873d[_0x219518(0xf96)]){await _0x532f76('操作失败',_0x219518(0x866));return;}const _0xa80c80=_0x5b873d[_0x219518(0x667)][_0x5b873d[_0x219518(0xf96)]],_0x419541=await _0x4e2abc('为“'+_0xa80c80[_0x219518(0xf74)]+_0x219518(0x126f),_0x219518(0xf2f),{'confirmText':'确认生成'});if(!_0x419541)return;await _0x532f76(_0x219518(0xb6a),_0x219518(0x9ac)+_0xa80c80[_0x219518(0xf74)]+_0x219518(0x5c4));const _0x3135f3=_0x5b873d['apiConfig'][_0x219518(0x989)]&&_0x5b873d[_0x219518(0x30d)][_0x219518(0x2cf)]&&_0x5b873d[_0x219518(0x30d)][_0x219518(0x10f0)],{proxyUrl:_0x1764b1,apiKey:_0x3c274b,model:_0x4cf680}=_0x3135f3?{'proxyUrl':_0x5b873d[_0x219518(0x30d)][_0x219518(0x989)],'apiKey':_0x5b873d[_0x219518(0x30d)]['secondaryApiKey'],'model':_0x5b873d[_0x219518(0x30d)][_0x219518(0x10f0)]}:_0x5b873d[_0x219518(0x30d)];if(!_0x1764b1||!_0x3c274b||!_0x4cf680){await _0x532f76(_0x219518(0x45e),_0x219518(0x255));return;}const _0x4c0e0d=_0x5b873d[_0x219518(0x21a)][_0x219518(0x266)]||0x3,_0x8c6768=_0x5b873d['globalSettings']['shoppingProductCount']||0x8,_0x5a4309=await _0x1a6951[_0x219518(0x110d)][_0x219518(0xc2f)]();let _0x3ca8b3='';_0x5a4309[_0x219518(0x7aa)]>0x0&&(_0x3ca8b3='\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20['+_0x5a4309[_0x219518(0x412)](_0x45e199=>'\x22'+_0x45e199[_0x219518(0xf74)]+'\x22')[_0x219518(0x1237)](',\x20')+']\x0a');const _0x4d6b85=_0x5b873d['qzoneSettings'][_0x219518(0x22a)]||'我',_0x410827=_0xa80c80[_0x219518(0xc18)]&&_0xa80c80[_0x219518(0xc18)][_0x219518(0x7aa)]>0x0?_0xa80c80['longTermMemory'][_0x219518(0x412)](_0x435a03=>_0x219518(0x768)+_0x4ce38e(_0x435a03[_0x219518(0x114e)])+')\x20'+_0x435a03[_0x219518(0x28c)])[_0x219518(0x1237)]('\x0a'):'无',_0x4e33c2=_0xa80c80[_0x219518(0x551)]['slice'](-0xa)[_0x219518(0x412)](_0x499f64=>(_0x499f64[_0x219518(0xa57)]===_0x219518(0x116c)?_0x4d6b85:_0xa80c80['name'])+':\x20'+String(_0x499f64['content'])[_0x219518(0x489)](0x0,0x1e)+'...')['join']('\x0a');let _0x1fe538='';if(_0xa80c80[_0x219518(0xdb9)][_0x219518(0x32d)]&&_0xa80c80[_0x219518(0xdb9)][_0x219518(0x32d)][_0x219518(0x7aa)]>0x0){const _0x3d6104=_0xa80c80[_0x219518(0xdb9)][_0x219518(0x32d)][_0x219518(0x412)](_0x1640ac=>{const _0x204d90=_0x219518,_0x2bad6e=_0x5b873d[_0x204d90(0x8a1)][_0x204d90(0x12f4)](_0xc3514=>_0xc3514['id']===_0x1640ac);if(!_0x2bad6e||!Array['isArray'](_0x2bad6e['content']))return'';const _0x4a0a14=_0x2bad6e['content'][_0x204d90(0x3d8)](_0x46bd09=>_0x46bd09['enabled']!==![])[_0x204d90(0x412)](_0xbf5d96=>'-\x20'+_0xbf5d96[_0x204d90(0x28c)])[_0x204d90(0x1237)]('\x0a');return _0x4a0a14?'\x0a##\x20来自《'+_0x2bad6e[_0x204d90(0xf74)]+_0x204d90(0x498)+_0x4a0a14:'';})[_0x219518(0x3d8)](Boolean)[_0x219518(0x1237)]('');_0x3d6104&&(_0x1fe538=_0x219518(0xe50)+_0x3d6104+'\x0a');}const _0x1ae883=_0x219518(0x1098)+_0xa80c80[_0x219518(0xf74)]+_0x219518(0x10cf)+_0x4c0e0d+'\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20'+_0x8c6768+'\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20'+_0xa80c80['name']+_0x219518(0x323)+_0xa80c80['settings']['aiPersona']+_0x219518(0xcdd)+_0x410827+_0x219518(0x11dd)+_0x1fe538+'\x0a'+_0x3ca8b3+_0x219518(0xf43)+_0x4e33c2+_0x219518(0x44b)+_0xa80c80[_0x219518(0xf74)]+_0x219518(0xc7b);try{const _0x5b24c4=[{'role':_0x219518(0x116c),'content':_0x219518(0xfb9)}];let _0xebf2bd=_0x1764b1[_0x219518(0xced)](_0x219518(0x6a6)),_0x2ebc60=_0xa615f4(_0x4cf680,_0x3c274b,_0x1ae883,_0x5b24c4);const _0x1cb607=_0xebf2bd?await fetch(_0x2ebc60[_0x219518(0x11de)],_0x2ebc60[_0x219518(0xd98)]):await fetch(_0x1764b1+_0x219518(0x6dd),{'method':'POST','headers':{'Content-Type':_0x219518(0xce4),'Authorization':'Bearer\x20'+_0x3c274b},'body':JSON[_0x219518(0x465)]({'model':_0x4cf680,'messages':[{'role':'system','content':_0x1ae883},..._0x5b24c4],'temperature':_0x5b873d[_0x219518(0x21a)]['apiTemperature']||0.9})});if(!_0x1cb607['ok'])throw new Error(_0x219518(0x10d8)+_0x1cb607[_0x219518(0x517)]);const _0x2be10=await _0x1cb607[_0x219518(0x6b5)](),_0x1bd28f=getGeminiResponseText(_0x2be10),_0x188bea=_0x1bd28f['match'](/({[\s\S]*})/);if(!_0x188bea)throw new Error('AI返回的内容中未找到有效的JSON对象。');const _0x1f3a48=JSON['parse'](_0x188bea[0x0]);if(!_0x1f3a48[_0x219518(0x90b)]||!Array[_0x219518(0xbd6)](_0x1f3a48[_0x219518(0x90b)]))throw new Error(_0x219518(0x289));await _0x1a6951[_0x219518(0x93b)]('rw',_0x1a6951[_0x219518(0xa6d)],_0x1a6951['shoppingCategories'],async()=>{const _0x57b089=_0x219518;for(const _0x3b38e5 of _0x1f3a48[_0x57b089(0x90b)]){let _0x4d70b1;const _0x58d983=await _0x1a6951[_0x57b089(0x110d)]['where']('name')[_0x57b089(0xb76)](_0x3b38e5[_0x57b089(0xf74)])[_0x57b089(0x2a6)]();_0x58d983?_0x4d70b1=_0x58d983['id']:_0x4d70b1=await _0x1a6951[_0x57b089(0x110d)]['add']({'name':_0x3b38e5[_0x57b089(0xf74)]});const _0x2c7e5d=_0x3b38e5[_0x57b089(0x124a)]['map'](_0x28559c=>{const _0x2120ec=_0x57b089;return{'name':_0x28559c[_0x2120ec(0xf74)],'price':_0x28559c[_0x2120ec(0x162)]||0x0,'description':_0x28559c[_0x2120ec(0xf6e)]||'','imageUrl':'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x28559c[_0x2120ec(0x895)]),'variations':(_0x28559c[_0x2120ec(0x3d4)]||[])[_0x2120ec(0x412)](_0x445afa=>({..._0x445afa,'imageUrl':_0x2120ec(0x1017)+encodeURIComponent(_0x445afa[_0x2120ec(0x895)])})),'categoryId':_0x4d70b1};});_0x2c7e5d[_0x57b089(0x7aa)]>0x0&&await _0x1a6951[_0x57b089(0xa6d)][_0x57b089(0xe94)](_0x2c7e5d);}}),activeShoppingCategoryId='all',await _0xdeaaf2(),await _0x532f76(_0x219518(0x1357),'为“'+_0xa80c80[_0x219518(0xf74)]+_0x219518(0xdcd));}catch(_0x19ccf6){console['error'](_0x219518(0x129c),_0x19ccf6),await _0x532f76(_0x219518(0x1020),_0x219518(0x35a)+_0x19ccf6['message']);}}async function _0x57b1d1(_0x25bf8b){const _0x4c5510=_0x41eae2,_0x35f346=document[_0x4c5510(0x89d)](_0x25bf8b);if(!_0x35f346)return;const _0x4a49ef=await _0x4d923b(_0x4c5510(0x100c),[{'text':'📁\x20从本地上传','value':_0x4c5510(0x586)},{'text':'🌐\x20使用网络URL','value':_0x4c5510(0x11de)}]);let _0x290b39=null;if(_0x4a49ef===_0x4c5510(0x586))_0x290b39=await _0x240760();else _0x4a49ef===_0x4c5510(0x11de)&&(_0x290b39=await _0x34d246('更换图片',_0x4c5510(0x32e),_0x35f346[_0x4c5510(0x9e3)],_0x4c5510(0x11de)));if(_0x290b39&&_0x290b39[_0x4c5510(0xc3a)]()){const _0x4fb410=_0x290b39[_0x4c5510(0xc3a)]();_0x35f346[_0x4c5510(0x9e3)]=_0x4fb410,!_0x5b873d[_0x4c5510(0x21a)][_0x4c5510(0x4c0)]&&(_0x5b873d[_0x4c5510(0x21a)][_0x4c5510(0x4c0)]={}),_0x5b873d[_0x4c5510(0x21a)][_0x4c5510(0x4c0)][_0x25bf8b]=_0x4fb410,await _0x1a6951[_0x4c5510(0x21a)][_0x4c5510(0xc0f)](_0x5b873d[_0x4c5510(0x21a)]),await _0x532f76('成功',_0x4c5510(0x6a8));}}window[_0x41eae2(0x461)]=_0x57b1d1;async function _0x3455f9(){const _0x4a66c0=_0x41eae2;if(!window[_0x4a66c0(0x70b)]){alert(_0x4a66c0(0x8d9));return;}await _0x532f76(_0x4a66c0(0x72b),'即将开始下载您的完整备份文件。下载过程中请勿关闭页面。');const _0x3ac4e2=streamSaver['createWriteStream']('EPhone-Full-Backup-Streamed-'+new Date()[_0x4a66c0(0x4df)]()[_0x4a66c0(0x55b)]('T')[0x0]+_0x4a66c0(0x90d)),_0x15b9dc=_0x3ac4e2[_0x4a66c0(0xb74)](),_0xdb3043=new TextEncoder();try{await _0x15b9dc[_0x4a66c0(0xfee)](_0xdb3043[_0x4a66c0(0xe17)](_0x4a66c0(0xd03)+Date['now']()+_0x4a66c0(0xcc9)));const _0x14d45f=await _0x1a6951[_0x4a66c0(0x12be)][_0x4a66c0(0x412)](_0x5ccfd3=>_0x5ccfd3[_0x4a66c0(0xf74)]);for(let _0x39d3a2=0x0;_0x39d3a2<_0x14d45f[_0x4a66c0(0x7aa)];_0x39d3a2++){const _0x5839bb=_0x14d45f[_0x39d3a2],_0x33d596=_0x1a6951[_0x4a66c0(0x10b6)](_0x5839bb);await _0x15b9dc[_0x4a66c0(0xfee)](_0xdb3043[_0x4a66c0(0xe17)]('\x22'+_0x5839bb+'\x22:\x20[\x0a'));let _0x3c0e74=!![];await _0x33d596['each'](_0x44eb45=>{const _0x4419a5=_0x4a66c0;!_0x3c0e74&&_0x15b9dc[_0x4419a5(0xfee)](_0xdb3043[_0x4419a5(0xe17)](',\x0a')),_0x15b9dc[_0x4419a5(0xfee)](_0xdb3043[_0x4419a5(0xe17)](JSON[_0x4419a5(0x465)](_0x44eb45))),_0x3c0e74=![];}),await _0x15b9dc['write'](_0xdb3043[_0x4a66c0(0xe17)]('\x0a]')),_0x39d3a2<_0x14d45f['length']-0x1&&await _0x15b9dc[_0x4a66c0(0xfee)](_0xdb3043[_0x4a66c0(0xe17)](',\x0a'));}await _0x15b9dc[_0x4a66c0(0xfee)](_0xdb3043[_0x4a66c0(0xe17)](_0x4a66c0(0x8c8)));}catch(_0x4c9c60){console[_0x4a66c0(0x1fd)](_0x4a66c0(0x11df),_0x4c9c60),await _0x532f76(_0x4a66c0(0x11a1),_0x4a66c0(0xb5d)+_0x4c9c60['message']);}finally{await _0x15b9dc['close']();}}async function _0x3e656f(){const _0x1e2d0a=_0x41eae2;await _0x532f76(_0x1e2d0a(0x72b),_0x1e2d0a(0x1b9));try{const _0x74a870={'version':0x3,'timestamp':Date[_0x1e2d0a(0xf1a)](),'data':{}},_0x192b91=_0x1a6951[_0x1e2d0a(0x12be)][_0x1e2d0a(0x412)](_0x1a2a0c=>_0x1a2a0c[_0x1e2d0a(0xf74)]);for(const _0x34c427 of _0x192b91){const _0x573018=await _0x1a6951[_0x1e2d0a(0x10b6)](_0x34c427)['toArray']();_0x74a870[_0x1e2d0a(0xd98)][_0x34c427]=_0x573018,console[_0x1e2d0a(0x471)]('已打包表:\x20'+_0x34c427+_0x1e2d0a(0x7c6)+_0x573018[_0x1e2d0a(0x7aa)]);}const _0x145050=new Blob([JSON[_0x1e2d0a(0x465)](_0x74a870,null,0x2)],{'type':_0x1e2d0a(0xce4)}),_0x412b17=URL[_0x1e2d0a(0xfc3)](_0x145050),_0x506084=document[_0x1e2d0a(0x285)]('a');_0x506084['href']=_0x412b17,_0x506084[_0x1e2d0a(0xb93)]=_0x1e2d0a(0x562)+new Date()[_0x1e2d0a(0x4df)]()[_0x1e2d0a(0x55b)]('T')[0x0]+_0x1e2d0a(0x90d),_0x506084['click'](),URL['revokeObjectURL'](_0x412b17),await _0x532f76(_0x1e2d0a(0xf29),_0x1e2d0a(0x112d));}catch(_0x3b17f8){console[_0x1e2d0a(0x1fd)](_0x1e2d0a(0x88b),_0x3b17f8),await _0x532f76(_0x1e2d0a(0x11a1),_0x1e2d0a(0x5bb)+_0x3b17f8['message']);}}function _0x255a31(){const _0x25b104=_0x41eae2,_0x50700d=Object[_0x25b104(0x4b5)](_0x5b873d[_0x25b104(0x667)])[_0x25b104(0x11e2)]((_0x3c7b50,_0x589cfb)=>{const _0x4c788d=_0x25b104;if(_0x589cfb['id']===_0x5b873d[_0x4c788d(0xf96)])return _0x3c7b50;return _0x3c7b50+(_0x589cfb['unreadCount']||0x0);},0x0),_0x4a6299=_0x111a81||0x0,_0x24c3b0=_0x50700d+_0x4a6299,_0x2dfd37=document[_0x25b104(0x89d)]('back-to-list-btn');if(!_0x2dfd37)return;let _0x51a7c9=_0x2dfd37[_0x25b104(0xd16)](_0x25b104(0x681));!_0x51a7c9&&(_0x51a7c9=document['createElement']('span'),_0x51a7c9[_0x25b104(0x81c)]=_0x25b104(0x8d6),_0x2dfd37[_0x25b104(0x22f)](_0x51a7c9));let _0x560606=_0x2dfd37[_0x25b104(0xd16)](_0x25b104(0x11e9));_0x560606&&_0x560606[_0x25b104(0x1247)](),_0x24c3b0>0x0?(_0x51a7c9[_0x25b104(0xf12)]=_0x24c3b0>0x63?_0x25b104(0xbe2):_0x24c3b0,_0x51a7c9['style'][_0x25b104(0x126b)]='block',_0x51a7c9[_0x25b104(0x68e)][_0x25b104(0x6a1)]='20',_0x51a7c9[_0x25b104(0x68e)][_0x25b104(0x9ab)]=_0x25b104(0x407)):_0x51a7c9['style'][_0x25b104(0x126b)]='none';}async function _0x550126(_0x8325bf){const _0x5e7c17=_0x41eae2,_0x3433fe=_0x8325bf==='uncategorized'?{'id':_0x5e7c17(0x67a),'name':'未分类'}:await _0x1a6951['stickerCategories'][_0x5e7c17(0x650)](_0x8325bf);if(!_0x3433fe){console[_0x5e7c17(0x1fd)](_0x5e7c17(0xad6),_0x8325bf);return;}const _0x22801d=document[_0x5e7c17(0x89d)](_0x5e7c17(0x4aa)),_0x33fc07=document[_0x5e7c17(0x89d)](_0x5e7c17(0x1190)),_0x4f9f64=_0x22801d[_0x5e7c17(0xd16)](_0x5e7c17(0x61b));_0x33fc07[_0x5e7c17(0x1ef)]='',_0x4f9f64[_0x5e7c17(0xf12)]='将分类\x20“'+_0x3433fe[_0x5e7c17(0xf74)]+'”\x20绑定到...';const _0x8102de=Object[_0x5e7c17(0x4b5)](_0x5b873d[_0x5e7c17(0x667)])[_0x5e7c17(0x2e3)]((_0x570f1d,_0x1e22d8)=>_0x570f1d[_0x5e7c17(0xf74)]['localeCompare'](_0x1e22d8[_0x5e7c17(0xf74)],_0x5e7c17(0x1e8)));_0x8102de[_0x5e7c17(0xd9a)](_0x5add55=>{const _0x31446f=_0x5e7c17,_0x417d6c=_0x5add55['settings'][_0x31446f(0x233)]['includes'](_0x8325bf),_0x4e8f81=document[_0x31446f(0x285)](_0x31446f(0xb25));_0x4e8f81[_0x31446f(0x81c)]=_0x31446f(0xf36),_0x4e8f81[_0x31446f(0x1ef)]=_0x31446f(0x46a)+_0x5add55['id']+'\x22\x20'+(_0x417d6c?_0x31446f(0x1b0):'')+_0x31446f(0xbc3)+(_0x5add55[_0x31446f(0x58c)]?_0x5add55[_0x31446f(0xdb9)][_0x31446f(0x108a)]:_0x5add55['settings'][_0x31446f(0xdd3)]||_0x265fcc)+_0x31446f(0xc6e)+_0x5add55[_0x31446f(0xf74)]+_0x31446f(0xf9a),_0x33fc07[_0x31446f(0x22f)](_0x4e8f81);}),document[_0x5e7c17(0x89d)](_0x5e7c17(0x3b8))[_0x5e7c17(0x108b)]=()=>_0x4f23be(_0x8325bf),document[_0x5e7c17(0x89d)]('cancel-sticker-binding-btn')['onclick']=()=>_0x22801d['classList'][_0x5e7c17(0x1247)]('visible'),_0x22801d[_0x5e7c17(0x2f1)][_0x5e7c17(0x569)](_0x5e7c17(0x11e4));}async function _0x4f23be(_0x32c1f5){const _0x4d643b=_0x41eae2,_0x5a18a3=new Set(Array['from'](document['querySelectorAll'](_0x4d643b(0x5da)))[_0x4d643b(0x412)](_0x52cffa=>_0x52cffa['dataset']['chatId'])),_0x592635=[];for(const _0x5b88e4 in _0x5b873d[_0x4d643b(0x667)]){const _0x4ca64d=_0x5b873d['chats'][_0x5b88e4];!Array[_0x4d643b(0xbd6)](_0x4ca64d[_0x4d643b(0xdb9)]['stickerCategoryIds'])&&(_0x4ca64d['settings'][_0x4d643b(0x233)]=[]);const _0x4e5ce4=_0x4ca64d[_0x4d643b(0xdb9)][_0x4d643b(0x233)][_0x4d643b(0xced)](_0x32c1f5),_0xf7ab99=_0x5a18a3[_0x4d643b(0xa14)](_0x5b88e4);if(_0x4e5ce4&&!_0xf7ab99)_0x4ca64d[_0x4d643b(0xdb9)][_0x4d643b(0x233)]=_0x4ca64d[_0x4d643b(0xdb9)][_0x4d643b(0x233)][_0x4d643b(0x3d8)](_0x243612=>_0x243612!==_0x32c1f5),_0x592635[_0x4d643b(0x138c)](_0x4ca64d);else!_0x4e5ce4&&_0xf7ab99&&(_0x4ca64d[_0x4d643b(0xdb9)][_0x4d643b(0x233)][_0x4d643b(0x138c)](_0x32c1f5),_0x592635[_0x4d643b(0x138c)](_0x4ca64d));}_0x592635['length']>0x0&&(await _0x1a6951['chats'][_0x4d643b(0xef7)](_0x592635),await _0x532f76(_0x4d643b(0x5dd),_0x4d643b(0x188))),document[_0x4d643b(0x89d)]('sticker-binding-modal')[_0x4d643b(0x2f1)][_0x4d643b(0x1247)](_0x4d643b(0x11e4));}function _0x5ae1ee(_0x3b6eec){const _0x59ccbf=_0x41eae2;if(!_0x3b6eec||!_0x3b6eec[_0x59ccbf(0xdb9)]['stickerCategoryIds']||_0x3b6eec['settings'][_0x59ccbf(0x233)][_0x59ccbf(0x7aa)]===0x0)return'';const _0x1a954d=_0x3b6eec[_0x59ccbf(0xdb9)][_0x59ccbf(0x233)];let _0x25a2f8=[];const _0x30809f=new Set();_0x1a954d[_0x59ccbf(0xd9a)](_0x63185c=>{const _0x83dc85=_0x59ccbf;let _0x1fae75;_0x63185c===_0x83dc85(0x67a)?_0x1fae75=_0x5b873d[_0x83dc85(0x210)][_0x83dc85(0x3d8)](_0x476d04=>!_0x476d04[_0x83dc85(0xcb1)]):_0x1fae75=_0x5b873d[_0x83dc85(0x210)][_0x83dc85(0x3d8)](_0x53e407=>_0x53e407[_0x83dc85(0xcb1)]===_0x63185c),_0x1fae75[_0x83dc85(0xd9a)](_0x4f2501=>{const _0x5b47e7=_0x83dc85;!_0x30809f[_0x5b47e7(0xa14)](_0x4f2501[_0x5b47e7(0xf74)])&&(_0x25a2f8[_0x5b47e7(0x138c)](_0x4f2501),_0x30809f['add'](_0x4f2501[_0x5b47e7(0xf74)]));});});if(_0x25a2f8['length']===0x0)return'';const _0x259f53=_0x25a2f8[_0x59ccbf(0x412)](_0x23367b=>'-\x20'+_0x23367b[_0x59ccbf(0xf74)])[_0x59ccbf(0x1237)]('\x0a');return _0x59ccbf(0x7e9)+_0x259f53+'\x0a';}function _0x4f684e(_0x177fb3){const _0x285bbd=_0x41eae2;if(!_0x177fb3||!_0x177fb3[_0x285bbd(0x58c)])return'';let _0x75c80e=_0x285bbd(0xad5),_0x37ed14=![];return _0x177fb3[_0x285bbd(0x5ab)][_0x285bbd(0xd9a)](_0x30cb5c=>{const _0x3c6b6d=_0x285bbd;if(_0x30cb5c['id']==='user')return;const _0x3f8a8c=_0x5b873d[_0x3c6b6d(0x667)][_0x30cb5c['id']];if(_0x3f8a8c&&_0x3f8a8c['settings'][_0x3c6b6d(0x233)]&&_0x3f8a8c[_0x3c6b6d(0xdb9)][_0x3c6b6d(0x233)][_0x3c6b6d(0x7aa)]>0x0){const _0xf5f8ef=_0x3f8a8c[_0x3c6b6d(0xdb9)]['stickerCategoryIds'];let _0x3c199c=[];const _0x29ad2b=new Set();_0xf5f8ef[_0x3c6b6d(0xd9a)](_0x5890ec=>{const _0x42a800=_0x3c6b6d;let _0x331c6f;_0x5890ec===_0x42a800(0x67a)?_0x331c6f=_0x5b873d['userStickers'][_0x42a800(0x3d8)](_0x393ce7=>!_0x393ce7[_0x42a800(0xcb1)]):_0x331c6f=_0x5b873d[_0x42a800(0x210)][_0x42a800(0x3d8)](_0x184c64=>_0x184c64[_0x42a800(0xcb1)]===_0x5890ec),_0x331c6f[_0x42a800(0xd9a)](_0x3e54c0=>{const _0x23c3d2=_0x42a800;!_0x29ad2b[_0x23c3d2(0xa14)](_0x3e54c0[_0x23c3d2(0xf74)])&&(_0x3c199c[_0x23c3d2(0x138c)](_0x3e54c0),_0x29ad2b[_0x23c3d2(0x569)](_0x3e54c0['name']));});}),_0x3c199c[_0x3c6b6d(0x7aa)]>0x0&&(_0x37ed14=!![],_0x75c80e+=_0x3c6b6d(0x5ee)+_0x30cb5c['groupNickname']+_0x3c6b6d(0x95e)+_0x30cb5c[_0x3c6b6d(0x1045)]+_0x3c6b6d(0xdb1),_0x75c80e+=_0x3c199c['map'](_0x56a4f8=>'-\x20'+_0x56a4f8['name'])['join']('\x0a'));}}),_0x37ed14?_0x75c80e:'';}async function _0x217de5(){const _0x54b568=_0x41eae2;async function _0x17b746(_0x5db2a4){const _0x562fd5=_0x356e;if(!_0x5db2a4)return;try{const _0x5d1b0f=await _0x5db2a4[_0x562fd5(0xec9)](),_0x166874=JSON[_0x562fd5(0x2cb)](_0x5d1b0f);if(_0x166874[_0x562fd5(0x48c)]===_0x562fd5(0x3f8))console[_0x562fd5(0x471)](_0x562fd5(0xc5a)),await _0x46bd0d(_0x166874);else{if(_0x166874[_0x562fd5(0xa7f)]&&typeof _0x166874['entries']===_0x562fd5(0x7af))console[_0x562fd5(0x471)]('检测到\x20Tavern\x20AI\x20世界书文件，执行兼容导入...'),await _0x171770(_0x166874,_0x5db2a4[_0x562fd5(0xf74)]);else throw new Error(_0x562fd5(0x45b));}}catch(_0x12efeb){console[_0x562fd5(0x1fd)]('导入世界书时出错:',_0x12efeb),await _0x532f76(_0x562fd5(0x53d),_0x562fd5(0xc51)+_0x12efeb['message']);}}async function _0x171770(_0x5a7ce5,_0x5b2333){const _0x368f90=_0x356e,_0x3021f9=_0x5b2333[_0x368f90(0xfbf)](/\.json$/i,''),_0xabfb97=await _0x34d246(_0x368f90(0xad4),_0x368f90(0x7a5),_0x3021f9);if(!_0xabfb97||!_0xabfb97[_0x368f90(0xc3a)]()){alert(_0x368f90(0xa29));return;}const _0x587018=Object['values'](_0x5a7ce5['entries'])[_0x368f90(0x412)](_0x16cb9f=>{const _0x3a47de=_0x368f90;return{'keys':_0x16cb9f['key']||[],'comment':_0x16cb9f[_0x3a47de(0x8f9)]||_0x3a47de(0xc06),'content':_0x16cb9f[_0x3a47de(0x28c)]||'','enabled':!_0x16cb9f['disable']};})[_0x368f90(0x3d8)](_0x1b933e=>_0x1b933e['content']);if(_0x587018[_0x368f90(0x7aa)]===0x0){alert(_0x368f90(0x1090));return;}const _0x5e2d80={'id':_0x368f90(0xbbd)+Date[_0x368f90(0xf1a)](),'name':_0xabfb97[_0x368f90(0xc3a)](),'content':_0x587018,'categoryId':null};await _0x1a6951[_0x368f90(0x8a1)][_0x368f90(0x569)](_0x5e2d80),_0x5b873d[_0x368f90(0x8a1)]['push'](_0x5e2d80),await _0x317a18(),await _0x532f76(_0x368f90(0x119e),_0x368f90(0xec1)+_0xabfb97+'》。');}async function _0x23e48b(){const _0x232126=_0x356e;try{const _0x597582=await _0x1a6951[_0x232126(0x8a1)][_0x232126(0xc2f)](),_0x57ffc5=await _0x1a6951[_0x232126(0xe8f)][_0x232126(0xc2f)]();if(_0x597582['length']===0x0&&_0x57ffc5[_0x232126(0x7aa)]===0x0){alert(_0x232126(0xc2a));return;}const _0x346dc1={'type':_0x232126(0x3f8),'version':0x1,'timestamp':Date['now'](),'books':_0x597582,'categories':_0x57ffc5},_0x43cc7f=new Blob([JSON[_0x232126(0x465)](_0x346dc1,null,0x2)],{'type':_0x232126(0xce4)}),_0x2fc094=URL['createObjectURL'](_0x43cc7f),_0x1b0c21=document[_0x232126(0x285)]('a');_0x1b0c21['href']=_0x2fc094,_0x1b0c21[_0x232126(0xb93)]='EPhone-WorldBooks-'+new Date()['toISOString']()[_0x232126(0x55b)]('T')[0x0]+'.json',_0x1b0c21[_0x232126(0x12a5)](),URL['revokeObjectURL'](_0x2fc094),await _0x532f76(_0x232126(0xf29),_0x232126(0x43d));}catch(_0x5d7358){console[_0x232126(0x1fd)](_0x232126(0x5c0),_0x5d7358),await _0x532f76(_0x232126(0x11a1),_0x232126(0x5bb)+_0x5d7358[_0x232126(0x1288)]);}}async function _0x46bd0d(_0x3632f2){const _0x18818f=_0x356e;try{if(_0x3632f2[_0x18818f(0x48c)]!==_0x18818f(0x3f8)||!_0x3632f2[_0x18818f(0x9a2)])throw new Error(_0x18818f(0x907));const _0x5b64ee=await _0x4e2abc(_0x18818f(0x8fd),'这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！',{'confirmButtonClass':_0x18818f(0xcd8),'confirmText':_0x18818f(0x993)});if(!_0x5b64ee)return;await _0x1a6951[_0x18818f(0x93b)]('rw',_0x1a6951[_0x18818f(0x8a1)],_0x1a6951[_0x18818f(0xe8f)],async()=>{const _0x5c432a=_0x18818f;await _0x1a6951['worldBooks'][_0x5c432a(0x1073)](),await _0x1a6951[_0x5c432a(0xe8f)]['clear'](),Array[_0x5c432a(0xbd6)](_0x3632f2[_0x5c432a(0x9a2)])&&await _0x1a6951[_0x5c432a(0x8a1)]['bulkPut'](_0x3632f2[_0x5c432a(0x9a2)]),Array[_0x5c432a(0xbd6)](_0x3632f2[_0x5c432a(0x90b)])&&await _0x1a6951[_0x5c432a(0xe8f)][_0x5c432a(0xef7)](_0x3632f2[_0x5c432a(0x90b)]);}),_0x5b873d[_0x18818f(0x8a1)]=await _0x1a6951[_0x18818f(0x8a1)][_0x18818f(0xc2f)](),await _0x317a18(),await _0x532f76(_0x18818f(0x1145),_0x18818f(0x106c));}catch(_0x441bd4){console[_0x18818f(0x1fd)](_0x18818f(0xa28),_0x441bd4),await _0x532f76(_0x18818f(0x53d),_0x18818f(0xc51)+_0x441bd4['message']);}}const _0x8ec488=localStorage[_0x54b568(0x1344)](_0x54b568(0xfab));if(_0x8ec488){const _0x432b5f=(Date[_0x54b568(0xf1a)]()-parseInt(_0x8ec488))/(0x3e8*0x3c);_0x432b5f>0x5&&_0xe7764f(_0x432b5f);}_0x3396d6(),window[_0x54b568(0x52a)]=_0x4e6c15,window[_0x54b568(0xe41)]=_0x324186,window[_0x54b568(0x286)]=_0x14f55b,window['openCharacterSelector']=_0x44e8e1,window[_0x54b568(0xeaf)]=_0x3b9633,window[_0x54b568(0x10e8)]=_0x5e942e,window['openCharWallet']=_0x2ca778,window[_0x54b568(0xc5e)]=_0x4b6625,window[_0x54b568(0x4b3)]=_0x39f7c8;const _0x182ec5=document[_0x54b568(0x285)](_0x54b568(0xb25));_0x182ec5['id']=_0x54b568(0x6ce),_0x182ec5['innerHTML']=_0x54b568(0x799),document[_0x54b568(0x89d)](_0x54b568(0x946))[_0x54b568(0x22f)](_0x182ec5);const _0x505cf4=document['createElement'](_0x54b568(0x68e));_0x505cf4['id']=_0x54b568(0xb71),document[_0x54b568(0xb0d)][_0x54b568(0x22f)](_0x505cf4),_0x40df96[_0x54b568(0x612)]=document[_0x54b568(0x89d)](_0x54b568(0x1312)),_0x40df96[_0x54b568(0x9ff)]=document[_0x54b568(0x89d)](_0x54b568(0x7d7));const _0x3943e1=localStorage[_0x54b568(0x1344)]('ephone-theme')||'light';_0x2bb324(_0x3943e1);const _0x4bad95=document[_0x54b568(0x285)](_0x54b568(0x68e));_0x4bad95['id']='custom-bubble-style',document['head'][_0x54b568(0x22f)](_0x4bad95);const _0x1e5899=document[_0x54b568(0x285)](_0x54b568(0x68e));_0x1e5899['id']=_0x54b568(0xaa5),document['head'][_0x54b568(0x22f)](_0x1e5899),_0x5806c0('',_0x54b568(0xcfb),_0x54b568(0x11f0)),_0x5806c0('','#settings-preview-area',_0x54b568(0xaa5)),window[_0x54b568(0xe41)]=_0x324186,window[_0x54b568(0x52a)]=_0x4e6c15,window['renderChatListProxy']=_0x413d78,window['renderApiSettingsProxy']=_0x146ab1,window[_0x54b568(0x950)]=_0x245609,window[_0x54b568(0x370)]=_0x317a18,await _0x26875f(),_0x203037(),await _0x56b1bd(),_0x446f71(_0x5b873d[_0x54b568(0x21a)][_0x54b568(0x876)]);const _0x338504=parseInt(localStorage[_0x54b568(0x1344)]('unreadPostsCount'))||0x0;_0x3cd1c0(_0x338504);_0x5b873d[_0x54b568(0x21a)]&&_0x5b873d['globalSettings'][_0x54b568(0x268)]&&_0x3866c6(_0x5b873d['globalSettings'][_0x54b568(0x268)]);_0x4e8690(),setInterval(_0x4e8690,0x3e8*0x1e),_0x550834(),_0x269813(),_0x337978(),_0x178a6e(),document[_0x54b568(0x89d)](_0x54b568(0x90a))[_0x54b568(0x1193)]('click',_0x4ce1a9=>{const _0x4457cc=_0x54b568;_0x4ce1a9[_0x4457cc(0x225)][_0x4457cc(0x2f1)]['contains'](_0x4457cc(0x129e))&&_0x2bfca0(_0x4ce1a9[_0x4457cc(0x225)][_0x4457cc(0xaaf)][_0x4457cc(0xcb1)]);}),document[_0x54b568(0x89d)](_0x54b568(0xf2e))['addEventListener']('click',()=>_0x179d3f(null)),document[_0x54b568(0x89d)](_0x54b568(0xd6d))[_0x54b568(0x1193)]('click',()=>{const _0x1f5f75=_0x54b568;document[_0x1f5f75(0x89d)](_0x1f5f75(0xdfb))[_0x1f5f75(0x2f1)][_0x1f5f75(0x1247)](_0x1f5f75(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0x6ef))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x4abcbf),document['getElementById'](_0x54b568(0xbcd))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x38d336=_0x54b568;if(_0x5b873d['activeChatId']&&!_0x5b873d[_0x38d336(0x667)][_0x5b873d[_0x38d336(0xf96)]][_0x38d336(0x58c)]){const _0x14ff61=_0x5b873d['chats'][_0x5b873d['activeChatId']];_0x167bd1(_0x14ff61['id'],_0x14ff61[_0x38d336(0x1045)]);}});let _0x342fb2=null;function _0x53599d(_0x3e6efa){const _0xd6997c=_0x54b568;_0x342fb2=_0x3e6efa;const _0x3bb468=_0x5b873d[_0xd6997c(0x667)][_0x5b873d[_0xd6997c(0xf96)]],_0x29be67=_0x3bb468[_0xd6997c(0x367)]['find'](_0x386ece=>_0x386ece['id']===_0x3e6efa);if(!_0x29be67)return;const _0x1caa44=document['getElementById'](_0xd6997c(0x10f3));_0x1caa44[_0xd6997c(0xf12)]=_0x29be67['isPinned']?_0xd6997c(0xf93):_0xd6997c(0x92b),document[_0xd6997c(0x89d)](_0xd6997c(0x230))[_0xd6997c(0x2f1)][_0xd6997c(0x569)](_0xd6997c(0x11e4));}async function _0x140364(){const _0x6bd937=_0x54b568;if(!_0x342fb2)return;const _0x185388=_0x5b873d[_0x6bd937(0x667)][_0x5b873d[_0x6bd937(0xf96)]],_0x3e4b9b=_0x185388[_0x6bd937(0x367)]['find'](_0x3342aa=>_0x3342aa['id']===_0x342fb2);_0x3e4b9b&&(_0x3e4b9b[_0x6bd937(0x199)]=!_0x3e4b9b[_0x6bd937(0x199)],await _0x1a6951[_0x6bd937(0x667)]['put'](_0x185388),_0x187280()),document['getElementById'](_0x6bd937(0x230))[_0x6bd937(0x2f1)][_0x6bd937(0x1247)]('visible');}async function _0x3947fd(){const _0x5bf318=_0x54b568;if(!_0x342fb2)return;const _0x4339bb=await _0x4e2abc('确认删除',_0x5bf318(0x795),{'confirmButtonClass':'btn-danger'});if(_0x4339bb){const _0x1a57d4=_0x5b873d[_0x5bf318(0x667)][_0x5b873d[_0x5bf318(0xf96)]];_0x1a57d4['announcements']=_0x1a57d4['announcements'][_0x5bf318(0x3d8)](_0x59fe35=>_0x59fe35['id']!==_0x342fb2),await _0x1a6951[_0x5bf318(0x667)]['put'](_0x1a57d4),_0x187280();}document[_0x5bf318(0x89d)](_0x5bf318(0x230))[_0x5bf318(0x2f1)][_0x5bf318(0x1247)]('visible');}document[_0x54b568(0x89d)](_0x54b568(0x39d))[_0x54b568(0x1193)]('click',_0x1ff3b5),document[_0x54b568(0x89d)](_0x54b568(0xd96))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x441b9d=>{if(_0x441b9d['target']===_0x36bef4)_0x1ff3b5();}),document['getElementById'](_0x54b568(0x4a2))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x5915c8=_0x54b568,_0x3b0aa0=await _0x4d923b(_0x5915c8(0x559),[{'text':_0x5915c8(0x939),'value':_0x5915c8(0x9c0)},{'text':_0x5915c8(0x31d),'value':_0x5915c8(0x122f)}]);if(_0x3b0aa0==='stream')_0x3455f9();else _0x3b0aa0===_0x5915c8(0x122f)&&_0x3e656f();}),document[_0x54b568(0x89d)](_0x54b568(0x11b0))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x3c9306),document[_0x54b568(0x89d)](_0x54b568(0x84e))[_0x54b568(0x1193)]('change',_0x4729a3=>{const _0xdce801=_0x54b568;document[_0xdce801(0x89d)]('offline-mode-options')['style'][_0xdce801(0x126b)]=_0x4729a3['target']['checked']?_0xdce801(0x1118):_0xdce801(0x10f2);}),document['getElementById'](_0x54b568(0x12d0))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>document[_0x54b568(0x89d)](_0x54b568(0xc14))[_0x54b568(0x12a5)]()),document[_0x54b568(0x89d)](_0x54b568(0x597))[_0x54b568(0x1193)](_0x54b568(0x76c),_0x4d1ccd=>{const _0x34b95b=_0x54b568;document[_0x34b95b(0x89d)](_0x34b95b(0xb55))[_0x34b95b(0x68e)][_0x34b95b(0x126b)]=_0x4d1ccd[_0x34b95b(0x225)]['checked']?_0x34b95b(0x1118):_0x34b95b(0x10f2);}),document[_0x54b568(0x89d)](_0x54b568(0xc14))[_0x54b568(0x1193)]('change',_0x52cad8=>_0x4b9490(_0x52cad8[_0x54b568(0x225)][_0x54b568(0x541)][0x0])),document[_0x54b568(0x89d)](_0x54b568(0xed4))[_0x54b568(0x1193)]('change',_0x86773a),document[_0x54b568(0x89d)]('back-to-list-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x126420=_0x54b568;_0x2402b7={},_0x5806c0('',_0x126420(0xcfb),_0x126420(0x11f0)),_0x5806c0('','#settings-preview-area',_0x126420(0xaa5)),_0x4ec1fb(),_0x5b873d['activeChatId']=null,_0x4e6c15(_0x126420(0x11b7));}),document[_0x54b568(0x89d)]('add-chat-btn')[_0x54b568(0x1193)]('click',async()=>{const _0x4c2ff0=_0x54b568,_0x8ee994=await _0x4d923b('创建新聊天',[{'text':'手动创建角色','value':_0x4c2ff0(0x851)},{'text':_0x4c2ff0(0x247),'value':'import_card'}]);if(_0x8ee994==='manual'){const _0x5b53b3=await _0x34d246(_0x4c2ff0(0x942),_0x4c2ff0(0x10ef));if(!_0x5b53b3||!_0x5b53b3[_0x4c2ff0(0xc3a)]())return;const _0x1d59fd=await _0x34d246(_0x4c2ff0(0x1220),_0x4c2ff0(0x333));if(!_0x1d59fd||!_0x1d59fd[_0x4c2ff0(0xc3a)]())return;const _0xcb4937=_0x4c2ff0(0x1382)+Date[_0x4c2ff0(0xf1a)](),_0x284921={'id':_0xcb4937,'name':_0x5b53b3[_0x4c2ff0(0xc3a)](),'originalName':_0x1d59fd['trim'](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':_0x4c2ff0(0x123a),'blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date[_0x4c2ff0(0xf1a)](),'isBusy':![]},'settings':{'aiPersona':'这是一个通过手动创建的角色。','myPersona':_0x4c2ff0(0xa6e),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x265fcc,'myAvatar':_0x265fcc,'background':'','theme':_0x4c2ff0(0xfb4),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':'Asia/Shanghai'},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x5b873d[_0x4c2ff0(0x667)][_0xcb4937]=_0x284921,await _0x1a6951[_0x4c2ff0(0x667)][_0x4c2ff0(0xc0f)](_0x284921),_0x413d78();}else _0x8ee994===_0x4c2ff0(0x633)&&document[_0x4c2ff0(0x89d)](_0x4c2ff0(0xed4))['click']();}),document[_0x54b568(0x89d)](_0x54b568(0x6fa))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x7044d6),document['getElementById'](_0x54b568(0x12ea))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>document['getElementById'](_0x54b568(0xc88))['classList']['remove']('visible')),document[_0x54b568(0x89d)](_0x54b568(0xa39))[_0x54b568(0x1193)]('click',_0x1f42bb),document[_0x54b568(0x89d)](_0x54b568(0x97b))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x14f55b),document[_0x54b568(0x89d)](_0x54b568(0x988))[_0x54b568(0x1193)]('click',()=>_0x3a104a(!![])),document[_0x54b568(0x89d)](_0x54b568(0x5d3))[_0x54b568(0x1193)]('click',_0x494176),document['getElementById'](_0x54b568(0x2a9))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x24160d),document[_0x54b568(0x89d)](_0x54b568(0x1179))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x23b31a),document['getElementById']('music-prev-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x1fd61a),document[_0x54b568(0x89d)](_0x54b568(0x7b9))[_0x54b568(0x1193)]('click',_0x29681b),document[_0x54b568(0x89d)](_0x54b568(0xabd))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x36275d=_0x54b568;_0x45027b(),document[_0x36275d(0x89d)](_0x36275d(0x5c5))[_0x36275d(0x2f1)][_0x36275d(0x569)](_0x36275d(0x11e4));}),document['getElementById'](_0x54b568(0x10ac))['addEventListener']('click',()=>document[_0x54b568(0x89d)]('music-playlist-panel')[_0x54b568(0x2f1)]['remove'](_0x54b568(0x11e4))),document[_0x54b568(0x89d)](_0x54b568(0xa2c))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x2e13a0),document['getElementById'](_0x54b568(0x119b))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>document[_0x54b568(0x89d)]('local-song-upload-input')[_0x54b568(0x12a5)]()),document[_0x54b568(0x89d)](_0x54b568(0x10b9))[_0x54b568(0x1193)](_0x54b568(0x76c),_0x50e2bc),document[_0x54b568(0x89d)](_0x54b568(0x1171))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x3d55a9=>{const _0x27e949=_0x54b568,_0x1050b9=_0x3d55a9['target'],_0x16c950=parseInt(_0x1050b9[_0x27e949(0xaaf)]['index']);if(isNaN(_0x16c950))return;if(_0x1050b9['classList']['contains'](_0x27e949(0xd6f)))_0x124c87(_0x16c950);else{if(_0x1050b9[_0x27e949(0x2f1)]['contains'](_0x27e949(0x62e)))_0x765d9f(_0x16c950);else{if(_0x1050b9[_0x27e949(0x2f1)][_0x27e949(0x3ff)](_0x27e949(0x23c)))_0x2ab862(_0x16c950);else _0x1050b9['classList']['contains']('delete-track-btn')&&_0x141d2c(_0x16c950);}}}),_0x1e10c1[_0x54b568(0x1193)]('ended',()=>{const _0x5b164b=_0x54b568;document['getElementById'](_0x5b164b(0x43b))[_0x5b164b(0x2f1)][_0x5b164b(0x1247)]('spinning'),_0x23b31a();});const _0x24c2dc=document[_0x54b568(0x89d)](_0x54b568(0xc6f));document[_0x54b568(0x89d)]('send-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x27f6eb=_0x54b568;_0x1093fc();const _0x5d47ff=_0x24c2dc[_0x27f6eb(0x2f4)][_0x27f6eb(0xc3a)]();if(!_0x5d47ff||!_0x5b873d[_0x27f6eb(0xf96)])return;const _0x218b26=_0x5b873d[_0x27f6eb(0x667)][_0x5b873d[_0x27f6eb(0xf96)]],_0x4358f0={'role':'user','content':_0x5d47ff,'timestamp':Date[_0x27f6eb(0xf1a)]()};_0x204995&&(_0x4358f0['quote']=_0x204995),_0x58deee(_0x4358f0,_0x218b26),((async()=>{const _0x5179bd=_0x27f6eb;_0x218b26[_0x5179bd(0x551)]['push'](_0x4358f0),await _0x1a6951[_0x5179bd(0x667)][_0x5179bd(0xc0f)](_0x218b26),_0x413d78();})()),_0x24c2dc[_0x27f6eb(0x2f4)]='',_0x24c2dc[_0x27f6eb(0x68e)]['height']=_0x27f6eb(0xd71),_0x24c2dc[_0x27f6eb(0xbf6)](),_0x2c11ff();}),document['getElementById'](_0x54b568(0x32f))[_0x54b568(0x1193)]('click',_0x2e3505),_0x24c2dc[_0x54b568(0x1193)](_0x54b568(0x4e5),_0x51d5c2=>{const _0x574331=_0x54b568;_0x51d5c2['key']==='Enter'&&!_0x51d5c2['shiftKey']&&(_0x51d5c2[_0x574331(0xd06)](),document[_0x574331(0x89d)]('send-btn')['click']());}),document[_0x54b568(0x89d)](_0x54b568(0x23e))[_0x54b568(0x1193)](_0x54b568(0x76c),async _0x383053=>{const _0xb582b3=_0x54b568,_0x3dbf61=_0x383053[_0xb582b3(0x225)][_0xb582b3(0x541)][0x0];if(_0x3dbf61){const _0x5f0460=await new Promise((_0x126b23,_0x3ae6f5)=>{const _0x4b0a6e=_0xb582b3,_0x3ec86a=new FileReader();_0x3ec86a['onload']=()=>_0x126b23(_0x3ec86a[_0x4b0a6e(0x9dc)]),_0x3ec86a[_0x4b0a6e(0x1010)]=()=>_0x3ae6f5(_0x3ec86a[_0x4b0a6e(0x1fd)]),_0x3ec86a[_0x4b0a6e(0x5b4)](_0x3dbf61);});_0x4de9bb=_0x5f0460,_0x245609();}}),document[_0x54b568(0x89d)]('save-wallpaper-btn')[_0x54b568(0x1193)]('click',async()=>{const _0x5b2d0d=_0x54b568;_0x4de9bb&&(_0x5b873d[_0x5b2d0d(0x21a)][_0x5b2d0d(0xd92)]=_0x4de9bb),_0x5b873d[_0x5b2d0d(0x21a)][_0x5b2d0d(0x876)]=document['getElementById']('global-css-input')['value']['trim'](),_0x5b873d['globalSettings']['notificationSoundUrl']=document[_0x5b2d0d(0x89d)](_0x5b2d0d(0x1333))[_0x5b2d0d(0x2f4)][_0x5b2d0d(0xc3a)](),_0x5b873d['globalSettings'][_0x5b2d0d(0x1f0)]=document[_0x5b2d0d(0x89d)](_0x5b2d0d(0x1372))['checked'],await _0x1a6951[_0x5b2d0d(0x21a)][_0x5b2d0d(0xc0f)](_0x5b873d[_0x5b2d0d(0x21a)]),_0x550834(),_0x35a5b0(),_0x4de9bb=null,_0x337978(),_0x3a9268(),_0x446f71(_0x5b873d[_0x5b2d0d(0x21a)][_0x5b2d0d(0x876)]),_0x203037(),alert(_0x5b2d0d(0xc83)),_0x4e6c15(_0x5b2d0d(0xc0c));});const _0x4fb605=document['getElementById']('messages-view');_0x4fb605[_0x54b568(0x1193)](_0x54b568(0x62b),()=>{const {scrollTop:_0x15d8cd,scrollHeight:_0x219762,clientHeight:_0x1bd357}=_0x4fb605;_0x219762-_0x15d8cd-_0x1bd357<_0x1bd357&&(!_0x58ae48&&_0x3dd421());}),document[_0x54b568(0x89d)](_0x54b568(0x1056))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x208f89=_0x54b568;_0x5b873d[_0x208f89(0x30d)][_0x208f89(0x57c)]=document['getElementById'](_0x208f89(0xa51))[_0x208f89(0x2f4)][_0x208f89(0xc3a)](),_0x5b873d['apiConfig'][_0x208f89(0x9e6)]=document[_0x208f89(0x89d)](_0x208f89(0x12ad))[_0x208f89(0x2f4)][_0x208f89(0xc3a)](),_0x5b873d[_0x208f89(0x30d)]['model']=document[_0x208f89(0x89d)](_0x208f89(0x393))[_0x208f89(0x2f4)],_0x5b873d['apiConfig'][_0x208f89(0xdf9)]=document[_0x208f89(0x89d)]('minimax-group-id')['value'][_0x208f89(0xc3a)](),_0x5b873d[_0x208f89(0x30d)]['minimaxApiKey']=document[_0x208f89(0x89d)](_0x208f89(0x485))[_0x208f89(0x2f4)][_0x208f89(0xc3a)](),_0x5b873d[_0x208f89(0x30d)][_0x208f89(0xeb8)]=document[_0x208f89(0x89d)](_0x208f89(0x2d8))[_0x208f89(0x2f4)],_0x5b873d[_0x208f89(0x30d)]['secondaryProxyUrl']=document[_0x208f89(0x89d)](_0x208f89(0x115a))[_0x208f89(0x2f4)]['trim'](),_0x5b873d[_0x208f89(0x30d)][_0x208f89(0x2cf)]=document[_0x208f89(0x89d)](_0x208f89(0x11c9))[_0x208f89(0x2f4)][_0x208f89(0xc3a)](),_0x5b873d[_0x208f89(0x30d)][_0x208f89(0x10f0)]=document[_0x208f89(0x89d)]('secondary-model-select')['value'],await _0x1a6951[_0x208f89(0x30d)][_0x208f89(0xc0f)](_0x5b873d['apiConfig']);const _0x19acc5=document[_0x208f89(0x89d)](_0x208f89(0x1026)),_0xc9e031=document[_0x208f89(0x89d)](_0x208f89(0x11a5)),_0x2c9c20=document[_0x208f89(0x89d)](_0x208f89(0xd81));_0x5b873d[_0x208f89(0x21a)][_0x208f89(0xa61)]=_0x19acc5['checked'],_0x5b873d[_0x208f89(0x21a)][_0x208f89(0x3ab)]=parseInt(_0xc9e031[_0x208f89(0x2f4)])||0x3c,_0x5b873d[_0x208f89(0x21a)]['blockCooldownHours']=parseFloat(_0x2c9c20[_0x208f89(0x2f4)])||0x1,_0x5b873d[_0x208f89(0x21a)]['enableAiDrawing']=document[_0x208f89(0x89d)](_0x208f89(0xbe7))[_0x208f89(0x1b0)],_0x5b873d['globalSettings'][_0x208f89(0x2f3)]=parseInt(document[_0x208f89(0x89d)](_0x208f89(0xa1b))[_0x208f89(0x2f4)])||0x32,_0x5b873d[_0x208f89(0x21a)][_0x208f89(0xbd9)]=parseInt(document[_0x208f89(0x89d)](_0x208f89(0x714))[_0x208f89(0x2f4)])||0x1e,_0x5b873d['globalSettings'][_0x208f89(0x576)]=parseFloat(document[_0x208f89(0x89d)]('api-temperature-slider')[_0x208f89(0x2f4)]),await _0x1a6951[_0x208f89(0x21a)][_0x208f89(0xc0f)](_0x5b873d['globalSettings']),_0x3355bb(),_0x5b873d[_0x208f89(0x21a)][_0x208f89(0xa61)]?(_0x2eecae(),console['log']('后台活动模拟已启动，间隔:\x20'+_0x5b873d['globalSettings']['backgroundActivityInterval']+'秒')):console[_0x208f89(0x471)](_0x208f89(0xf75)),alert('所有API与后台设置已保存!');});const _0xcd81a2=document['getElementById'](_0x54b568(0x12ad));_0xcd81a2[_0x54b568(0x1193)]('focus',_0xb97ae1=>{const _0x36547c=_0x54b568;_0xb97ae1[_0x36547c(0x225)][_0x36547c(0x129b)](_0x36547c(0x48c),_0x36547c(0xec9));}),_0xcd81a2[_0x54b568(0x1193)]('blur',_0x5b5ec5=>{const _0x55188b=_0x54b568;_0x5b5ec5['target'][_0x55188b(0x129b)]('type',_0x55188b(0x428));});async function _0xd27981(_0x4a5cee,_0x4ed632,_0x483f91){const _0xb6b7e6=_0x54b568,_0x589231=document[_0xb6b7e6(0x89d)](_0x4a5cee)['value'][_0xb6b7e6(0xc3a)](),_0x3d262d=document['getElementById'](_0x4ed632)[_0xb6b7e6(0x2f4)][_0xb6b7e6(0xc3a)]();if(!_0x589231||!_0x3d262d)return alert('请先填写对应的反代地址和密钥');try{let _0x10e314=_0x589231===GEMINI_API_URL;const _0x4d31d7=await fetch(_0x10e314?GEMINI_API_URL+_0xb6b7e6(0x580)+getRandomValue(_0x3d262d):_0x589231+_0xb6b7e6(0x6e1),_0x10e314?undefined:{'headers':{'Authorization':_0xb6b7e6(0x3fb)+_0x3d262d}});if(!_0x4d31d7['ok'])throw new Error('无法获取模型列表');const _0x9c959c=await _0x4d31d7[_0xb6b7e6(0x6b5)]();let _0xafc8ec=_0x10e314?_0x9c959c[_0xb6b7e6(0xa31)][_0xb6b7e6(0x412)](_0x1aba5c=>({'id':_0x1aba5c[_0xb6b7e6(0xf74)]['split']('/')[0x1]||_0x1aba5c[_0xb6b7e6(0xf74)]})):_0x9c959c['data'];const _0x39b791=document[_0xb6b7e6(0x89d)](_0x483f91);_0x39b791[_0xb6b7e6(0x1ef)]='';const _0x313a6f=_0x483f91===_0xb6b7e6(0x393)?_0x5b873d[_0xb6b7e6(0x30d)][_0xb6b7e6(0x1364)]:_0x5b873d[_0xb6b7e6(0x30d)][_0xb6b7e6(0x10f0)];_0xafc8ec[_0xb6b7e6(0xd9a)](_0x311700=>{const _0x3e0a44=_0xb6b7e6,_0x38f88e=document[_0x3e0a44(0x285)](_0x3e0a44(0xc39));_0x38f88e['value']=_0x311700['id'],_0x38f88e[_0x3e0a44(0xf12)]=_0x311700['id'];if(_0x311700['id']===_0x313a6f)_0x38f88e[_0x3e0a44(0x335)]=!![];_0x39b791[_0x3e0a44(0x22f)](_0x38f88e);}),alert(_0xb6b7e6(0xb89));}catch(_0x3f4da5){alert(_0xb6b7e6(0x344)+_0x3f4da5[_0xb6b7e6(0x1288)]);}}document['getElementById'](_0x54b568(0x234))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x2495a6=_0x54b568;_0xd27981('proxy-url',_0x2495a6(0x12ad),_0x2495a6(0x393));}),document[_0x54b568(0x89d)](_0x54b568(0x23f))['addEventListener'](_0x54b568(0x12a5),()=>{const _0x29864f=_0x54b568;_0xd27981(_0x29864f(0x115a),_0x29864f(0x11c9),_0x29864f(0x8be));}),document[_0x54b568(0x89d)](_0x54b568(0x88e))['addEventListener']('click',async()=>{const _0x30a040=_0x54b568,_0x14e6e8=await _0x34d246(_0x30a040(0x2bc),_0x30a040(0x1175));if(_0x14e6e8&&_0x14e6e8[_0x30a040(0xc3a)]()){const _0xf8db66={'id':_0x30a040(0xbbd)+Date['now'](),'name':_0x14e6e8[_0x30a040(0xc3a)](),'content':''};await _0x1a6951[_0x30a040(0x8a1)][_0x30a040(0x569)](_0xf8db66),_0x5b873d['worldBooks'][_0x30a040(0x138c)](_0xf8db66),_0x317a18(),_0xba561c(_0xf8db66['id']);}}),document[_0x54b568(0x89d)](_0x54b568(0x12c1))[_0x54b568(0x1193)]('click',async()=>{const _0x5f3fa8=_0x54b568;if(!_0x429d52)return;const _0x3e9c24=_0x5b873d[_0x5f3fa8(0x8a1)][_0x5f3fa8(0x12f4)](_0x5c43bf=>_0x5c43bf['id']===_0x429d52);if(!_0x3e9c24)return;const _0xbb0b52=document[_0x5f3fa8(0x89d)](_0x5f3fa8(0xf5b))[_0x5f3fa8(0x2f4)]['trim']();if(!_0xbb0b52){alert(_0x5f3fa8(0x133a));return;}_0x3e9c24[_0x5f3fa8(0xf74)]=_0xbb0b52;const _0x3a09f2=document['getElementById']('world-book-category-select')[_0x5f3fa8(0x2f4)];_0x3e9c24[_0x5f3fa8(0xcb1)]=_0x3a09f2?parseInt(_0x3a09f2):null;const _0x48e344=document[_0x5f3fa8(0x89d)](_0x5f3fa8(0x1068)),_0x5c6daf=_0x48e344['querySelectorAll'](_0x5f3fa8(0x214)),_0x23db46=[];_0x5c6daf[_0x5f3fa8(0xd9a)](_0x4cd40b=>{const _0x48dc5e=_0x5f3fa8,_0x1b5ec1=_0x4cd40b[_0x48dc5e(0xd16)](_0x48dc5e(0xbc5))[_0x48dc5e(0x2f4)]['trim'](),_0x2339b5=_0x4cd40b[_0x48dc5e(0xd16)](_0x48dc5e(0x1147))[_0x48dc5e(0x2f4)][_0x48dc5e(0xc3a)](),_0x3df18e=_0x4cd40b[_0x48dc5e(0xd16)](_0x48dc5e(0xc86))['checked'];_0x2339b5&&_0x23db46[_0x48dc5e(0x138c)]({'comment':_0x4cd40b['querySelector'](_0x48dc5e(0x105f))[_0x48dc5e(0x2f4)][_0x48dc5e(0xc3a)](),'keys':_0x1b5ec1?_0x1b5ec1[_0x48dc5e(0x55b)](',')[_0x48dc5e(0x412)](_0x5007f4=>_0x5007f4[_0x48dc5e(0xc3a)]())['filter'](_0x2b6069=>_0x2b6069):[],'content':_0x2339b5,'enabled':_0x3df18e});}),_0x3e9c24['content']=_0x23db46,await _0x1a6951[_0x5f3fa8(0x8a1)][_0x5f3fa8(0xc0f)](_0x3e9c24),document[_0x5f3fa8(0x89d)](_0x5f3fa8(0x762))[_0x5f3fa8(0xf12)]=_0xbb0b52,_0x429d52=null,_0x4e6c15('world-book-screen'),await _0x317a18();}),document['getElementById'](_0x54b568(0x116e))[_0x54b568(0x1193)](_0x54b568(0x12a5),async _0x25e8ef=>{const _0x12b033=_0x54b568,_0x51b8c1=_0x25e8ef[_0x12b033(0x225)][_0x12b033(0x53a)]('.voice-message-body[data-text]');if(_0x51b8c1){const _0x3bf92d=_0x5b873d[_0x12b033(0x667)][_0x5b873d[_0x12b033(0xf96)]];if(!_0x3bf92d)return;_0x271da1(_0x51b8c1);const _0x3486b8=_0x51b8c1[_0x12b033(0x53a)]('.message-bubble'),_0x4eb5ca=_0x3486b8?_0x3486b8[_0x12b033(0xd16)](_0x12b033(0x59e)):null;if(_0x51b8c1[_0x12b033(0xaaf)][_0x12b033(0xa97)]&&_0x4eb5ca&&_0x4eb5ca[_0x12b033(0x68e)][_0x12b033(0x126b)]===_0x12b033(0x1118)){if(_0x3bf92d[_0x12b033(0x58c)]){console[_0x12b033(0x471)](_0x12b033(0x4ea));return;}if(_0x3bf92d[_0x12b033(0xdb9)]['enableTts']===![]){console[_0x12b033(0x471)]('“'+_0x3bf92d['name']+'”的TTS功能已关闭，已禁止发起TTS请求。');return;}_0x35af80(_0x51b8c1);}return;}const _0x2856e6=_0x25e8ef[_0x12b033(0x225)][_0x12b033(0x53a)]('.waimai-details-btn');if(_0x2856e6){const _0x37fdeb=_0x2856e6[_0x12b033(0x53a)]('.message-bubble');if(_0x37fdeb){const _0xc0238b=parseInt(_0x37fdeb[_0x12b033(0xaaf)][_0x12b033(0x114e)]);if(!isNaN(_0xc0238b)){_0x52d938(_0xc0238b);return;}}}const _0x598f89=_0x25e8ef[_0x12b033(0x225)]['closest'](_0x12b033(0xcd6));if(_0x598f89){const _0x77762f=_0x598f89[_0x12b033(0x53a)](_0x12b033(0x2de));if(_0x77762f){const _0x1bdf89=parseInt(_0x77762f[_0x12b033(0xaaf)][_0x12b033(0x114e)]),_0x25cd7d=_0x598f89[_0x12b033(0xaaf)]['choice'];if(!isNaN(_0x1bdf89)&&_0x25cd7d){await _0x562c24(_0x1bdf89,_0x25cd7d);return;}}}const _0x3bacb2=_0x25e8ef[_0x12b033(0x225)][_0x12b033(0x53a)](_0x12b033(0x3af));if(_0x3bacb2){const _0x2f6cf=parseInt(_0x3bacb2[_0x12b033(0xaaf)][_0x12b033(0x7b6)]);if(!isNaN(_0x2f6cf)){const _0x4f9400=await _0x1a6951['qzonePosts'][_0x12b033(0x650)](_0x2f6cf);if(_0x4f9400){let _0x17f829='';const _0x79d69a=_0x4f9400[_0x12b033(0xc3f)]===_0x12b033(0x116c)?_0x5b873d[_0x12b033(0x5c1)][_0x12b033(0x22a)]:_0x5b873d[_0x12b033(0x667)][_0x4f9400[_0x12b033(0xc3f)]]?.[_0x12b033(0xf74)]||'未知作者';if(_0x4f9400['type']===_0x12b033(0x536))_0x17f829=_0x4f9400['content'];else{_0x17f829=_0x4f9400[_0x12b033(0x957)]||'';if(_0x4f9400[_0x12b033(0x450)])_0x17f829+=_0x12b033(0x110e);if(_0x4f9400[_0x12b033(0x132c)])_0x17f829+=_0x12b033(0xec4)+_0x4f9400[_0x12b033(0x132c)]+']';}_0x532f76(_0x12b033(0x61e)+_0x79d69a+_0x12b033(0x4ba),_0x17f829[_0x12b033(0xfbf)](/\n/g,'<br>'));}else _0x532f76('提示','这条动态的原始数据已被彻底清除。');}return;}const _0x1b5313=_0x25e8ef[_0x12b033(0x225)]['closest']('.ai-generated-image');if(_0x1b5313){const _0x5ee86d=_0x1b5313[_0x12b033(0xaaf)][_0x12b033(0xf6e)];if(_0x5ee86d)_0x532f76(_0x12b033(0xf6f),_0x5ee86d);return;}const _0x24f717=_0x25e8ef[_0x12b033(0x225)][_0x12b033(0x53a)](_0x12b033(0xa3b));if(_0x24f717&&_0x24f717[_0x12b033(0xaaf)][_0x12b033(0xbe0)]){const _0x2c9f71=parseInt(_0x24f717[_0x12b033(0xaaf)][_0x12b033(0xbe0)]);!isNaN(_0x2c9f71)&&_0x52933b(_0x2c9f71);}const _0x2d7f37=_0x25e8ef[_0x12b033(0x225)][_0x12b033(0x53a)]('.gift-card');if(_0x2d7f37){const _0x5856b7=_0x2d7f37['closest'](_0x12b033(0x2de));_0x5856b7&&_0x6f4bad(parseInt(_0x5856b7[_0x12b033(0xaaf)][_0x12b033(0x114e)]));}const _0x425b52=_0x25e8ef[_0x12b033(0x225)][_0x12b033(0x53a)](_0x12b033(0x932));if(_0x425b52){const _0x21e19e=_0x425b52[_0x12b033(0x53a)](_0x12b033(0x2de));if(_0x21e19e&&_0x21e19e[_0x12b033(0xaaf)][_0x12b033(0x114e)]){const _0x210104=parseInt(_0x21e19e[_0x12b033(0xaaf)][_0x12b033(0x114e)]);_0x3d2fbc(_0x210104);}}const _0x38d064=_0x25e8ef[_0x12b033(0x225)][_0x12b033(0x53a)]('.poll-card');if(_0x38d064){const _0x51ccfc=parseInt(_0x38d064['dataset'][_0x12b033(0x9c2)]);if(isNaN(_0x51ccfc))return;const _0x52fc34=_0x25e8ef['target'][_0x12b033(0x53a)](_0x12b033(0x892));if(_0x52fc34&&!_0x38d064['classList'][_0x12b033(0x3ff)]('closed')){_0x360cbe(_0x51ccfc,_0x52fc34[_0x12b033(0xaaf)][_0x12b033(0xc39)]);return;}const _0x1bec04=_0x25e8ef[_0x12b033(0x225)][_0x12b033(0x53a)]('.poll-action-btn');if(_0x1bec04){_0x38d064[_0x12b033(0x2f1)]['contains']('closed')?_0x3f862b(_0x51ccfc):_0x5a32ad(_0x51ccfc);return;}_0x38d064[_0x12b033(0x2f1)]['contains'](_0x12b033(0x514))&&_0x3f862b(_0x51ccfc);}const _0x46b1d2=_0x25e8ef[_0x12b033(0x225)][_0x12b033(0x53a)](_0x12b033(0xa5c));if(_0x46b1d2){const _0x37fee8=_0x5b873d[_0x12b033(0x667)][_0x5b873d[_0x12b033(0xf96)]],_0x3726f2=_0x46b1d2['closest'](_0x12b033(0x107a));if(_0x37fee8&&_0x3726f2){const _0x5aebe5=parseInt(_0x3726f2[_0x12b033(0xaaf)][_0x12b033(0x114e)]),_0xc871ee=_0x37fee8[_0x12b033(0x551)]['find'](_0x2ad9f0=>_0x2ad9f0['timestamp']===_0x5aebe5);if(_0xc871ee&&_0xc871ee[_0x12b033(0xda0)]){let _0x36743b='';const _0x11c8df=_0xc871ee[_0x12b033(0xda0)];_0x11c8df['originalType']==='text'?_0x36743b=_0x12b033(0x133d)+_0x11c8df[_0x12b033(0x310)]+'\x22':_0x36743b=_0x12b033(0x5fd)+_0x11c8df[_0x12b033(0x8d7)]+_0x12b033(0x1143),_0x532f76('已撤回的消息',_0x36743b);}}}const _0x3be9c7=_0x25e8ef[_0x12b033(0x225)]['closest']('.link-share-card');if(_0x3be9c7&&_0x3be9c7[_0x12b033(0x53a)](_0x12b033(0x605))){const _0x59ca0e=parseInt(_0x3be9c7[_0x12b033(0xaaf)]['timestamp']);_0x48f0ef(_0x59ca0e);}const _0x5e9b97=_0x25e8ef[_0x12b033(0x225)][_0x12b033(0x53a)](_0x12b033(0x2de));if(_0x5e9b97&&_0x5e9b97[_0x12b033(0x2f1)][_0x12b033(0x3ff)]('ai')&&_0x5e9b97[_0x12b033(0x2f1)][_0x12b033(0x3ff)](_0x12b033(0x36a))&&_0x5e9b97[_0x12b033(0xaaf)][_0x12b033(0x632)]===_0x12b033(0x1042)){const _0x5c1da3=parseInt(_0x5e9b97[_0x12b033(0xaaf)]['timestamp']);!isNaN(_0x5c1da3)&&_0x4c3bea(_0x5c1da3);}});const _0x767aac=document[_0x54b568(0x89d)](_0x54b568(0x522)),_0x6efc1d=document[_0x54b568(0xd16)]('.custom-multiselect\x20.select-box'),_0xc03e79=document[_0x54b568(0x89d)](_0x54b568(0xcd5));function _0x15de9c(){const _0x4694b9=_0x54b568,_0x3e77f3=_0xc03e79[_0x4694b9(0x35f)](_0x4694b9(0x648)),_0x41abe9=document[_0x4694b9(0xd16)](_0x4694b9(0x187));if(_0x3e77f3[_0x4694b9(0x7aa)]===0x0)_0x41abe9[_0x4694b9(0xf12)]='--\x20点击选择\x20--';else{if(_0x3e77f3[_0x4694b9(0x7aa)]>0x2)_0x41abe9[_0x4694b9(0xf12)]='已选择\x20'+_0x3e77f3['length']+_0x4694b9(0x45c);else{const _0x3a1647=Array[_0x4694b9(0x321)](_0x3e77f3)[_0x4694b9(0x412)](_0x3a2185=>{const _0x189a9e=_0x4694b9;return _0x3a2185[_0x189a9e(0x182)][_0x189a9e(0xf12)][_0x189a9e(0xc3a)]();});_0x41abe9[_0x4694b9(0xf12)]=_0x3a1647['join'](',\x20');}}}_0x6efc1d['addEventListener'](_0x54b568(0x12a5),_0x2dda12=>{const _0xfe5f9d=_0x54b568;_0x2dda12[_0xfe5f9d(0x1088)](),_0xc03e79['classList'][_0xfe5f9d(0x73b)](_0xfe5f9d(0x11e4)),_0x6efc1d[_0xfe5f9d(0x2f1)][_0xfe5f9d(0x73b)](_0xfe5f9d(0xd11));}),document[_0x54b568(0x89d)](_0x54b568(0xcd5))['addEventListener'](_0x54b568(0x76c),_0x15de9c),window[_0x54b568(0x1193)](_0x54b568(0x12a5),_0xdb1cbd=>{const _0x2c23d5=_0x54b568;!document[_0x2c23d5(0xd16)]('.custom-multiselect')[_0x2c23d5(0x3ff)](_0xdb1cbd[_0x2c23d5(0x225)])&&(_0xc03e79[_0x2c23d5(0x2f1)]['remove'](_0x2c23d5(0x11e4)),_0x6efc1d[_0x2c23d5(0x2f1)]['remove'](_0x2c23d5(0xd11)));}),document[_0x54b568(0x89d)]('chat-settings-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x494278=_0x54b568;_0x4cb1f8();if(!_0x5b873d[_0x494278(0xf96)])return;const _0x1736d7=_0x5b873d[_0x494278(0x667)][_0x5b873d['activeChatId']],_0x7b95e9=_0x1736d7['isGroup'],_0x5478bb=document[_0x494278(0x89d)](_0x494278(0x2a5));!_0x7b95e9&&_0x1736d7['settings'][_0x494278(0x832)]&&_0x1736d7[_0x494278(0xdb9)][_0x494278(0x832)]['length']>0x0?_0x5478bb[_0x494278(0x68e)][_0x494278(0x126b)]='block':_0x5478bb['style'][_0x494278(0x126b)]=_0x494278(0x10f2);document[_0x494278(0x89d)]('chat-name-group')[_0x494278(0x68e)]['display']=_0x494278(0x1118),document[_0x494278(0x89d)](_0x494278(0xd68))[_0x494278(0x68e)][_0x494278(0x126b)]='block',document[_0x494278(0x89d)](_0x494278(0x9bd))[_0x494278(0x68e)]['display']=_0x494278(0x1118),document['getElementById'](_0x494278(0xefc))[_0x494278(0x68e)][_0x494278(0x126b)]=_0x7b95e9?'block':'none',document[_0x494278(0x89d)](_0x494278(0x767))[_0x494278(0x68e)][_0x494278(0x126b)]=_0x7b95e9?'none':'block',document['getElementById'](_0x494278(0x642))['style']['display']=_0x7b95e9?_0x494278(0x1118):_0x494278(0x10f2),document[_0x494278(0x89d)](_0x494278(0xd35))[_0x494278(0x68e)]['display']=_0x7b95e9?_0x494278(0x1118):'none',document['getElementById'](_0x494278(0x610))['style'][_0x494278(0x126b)]=_0x7b95e9?_0x494278(0x10f2):_0x494278(0x1118),document[_0x494278(0x89d)](_0x494278(0x1156))[_0x494278(0x68e)][_0x494278(0x126b)]=_0x7b95e9?_0x494278(0x10f2):'block',document[_0x494278(0x89d)](_0x494278(0xbb8))[_0x494278(0x68e)][_0x494278(0x126b)]=_0x7b95e9?_0x494278(0x10f2):_0x494278(0x1118),document[_0x494278(0x89d)](_0x494278(0x3e7))[_0x494278(0x68e)]['display']=_0x7b95e9?_0x494278(0x10f2):_0x494278(0x1118),document[_0x494278(0x89d)](_0x494278(0x587))[_0x494278(0x68e)]['display']=_0x7b95e9?_0x494278(0x10f2):'block',document[_0x494278(0x89d)](_0x494278(0x3ca))['style']['display']=_0x7b95e9?_0x494278(0x10f2):_0x494278(0x1118),document[_0x494278(0x89d)](_0x494278(0x1290))[_0x494278(0x68e)][_0x494278(0x126b)]=_0x7b95e9?_0x494278(0x10f2):_0x494278(0x1118),document[_0x494278(0x89d)](_0x494278(0xfc8))[_0x494278(0x68e)][_0x494278(0x126b)]=_0x7b95e9?_0x494278(0x10f2):_0x494278(0x1118),document[_0x494278(0x89d)]('group-cooldown-group')['style'][_0x494278(0x126b)]=_0x7b95e9?_0x494278(0x1118):_0x494278(0x10f2),document['getElementById'](_0x494278(0x2c5))[_0x494278(0x2f4)]=_0x1736d7[_0x494278(0xf74)],document[_0x494278(0x89d)](_0x494278(0x12d8))[_0x494278(0x2f4)]=_0x1736d7['settings']['myPersona'],document['getElementById'](_0x494278(0x1255))[_0x494278(0x9e3)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0xd55)]||(_0x7b95e9?_0x24462f:_0x265fcc),document[_0x494278(0x89d)]('max-memory')['value']=_0x1736d7[_0x494278(0xdb9)][_0x494278(0x46f)],document[_0x494278(0x89d)](_0x494278(0xdb6))[_0x494278(0x2f4)]=_0x1736d7['settings']['linkedMemoryCount']||0xa;const _0x2a5ec6=document[_0x494278(0x89d)](_0x494278(0x1a1)),_0x1aee3e=document[_0x494278(0x89d)](_0x494278(0x400));_0x1736d7[_0x494278(0xdb9)]['background']?(_0x2a5ec6[_0x494278(0x9e3)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0x55c)],_0x2a5ec6['style'][_0x494278(0x126b)]=_0x494278(0x1118),_0x1aee3e[_0x494278(0x68e)][_0x494278(0x126b)]='inline-block'):(_0x2a5ec6[_0x494278(0x68e)][_0x494278(0x126b)]=_0x494278(0x10f2),_0x1aee3e['style'][_0x494278(0x126b)]=_0x494278(0x10f2));document[_0x494278(0x89d)](_0x494278(0x11fb))['style'][_0x494278(0x126b)]=_0x7b95e9?_0x494278(0x10f2):'block',document['getElementById'](_0x494278(0x69f))[_0x494278(0x68e)][_0x494278(0x126b)]=_0x7b95e9?_0x494278(0x10f2):_0x494278(0x1118),document[_0x494278(0x89d)]('group-background-activity-group')['style'][_0x494278(0x126b)]=_0x7b95e9?_0x494278(0x1118):'none';const _0x1fb5ff=document[_0x494278(0x89d)](_0x494278(0x597)),_0x8c3724=document[_0x494278(0x89d)](_0x494278(0xb55));_0x1fb5ff[_0x494278(0x1b0)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0x298)],_0x8c3724[_0x494278(0x68e)][_0x494278(0x126b)]=_0x1fb5ff[_0x494278(0x1b0)]?_0x494278(0x1118):'none';const _0x4bbd74=document[_0x494278(0x89d)]('time-zone-select'),_0x151deb=Intl[_0x494278(0xda1)](_0x494278(0x1a7));_0x4bbd74[_0x494278(0x1ef)]='',_0x151deb[_0x494278(0xd9a)](_0x17779f=>{const _0xda135f=_0x494278,_0x3a5d7f=document[_0xda135f(0x285)]('option');_0x3a5d7f[_0xda135f(0x2f4)]=_0x17779f,_0x3a5d7f[_0xda135f(0xf12)]=_0x17779f,_0x4bbd74[_0xda135f(0x22f)](_0x3a5d7f);}),_0x4bbd74['value']=_0x1736d7['settings'][_0x494278(0x1a7)]||_0x494278(0x1207);if(_0x7b95e9)document['getElementById']('group-background-activity-switch')[_0x494278(0x1b0)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0xa61)],document[_0x494278(0x89d)](_0x494278(0x6f9))[_0x494278(0x2f4)]=_0x1736d7['settings'][_0x494278(0xc48)]||'',document[_0x494278(0x89d)](_0x494278(0x279))[_0x494278(0x9e3)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0x108a)]||_0x660176,document[_0x494278(0x89d)](_0x494278(0x747))[_0x494278(0x2f4)]=_0x1736d7[_0x494278(0xdb9)]['actionCooldownMinutes']||0xa,document['getElementById'](_0x494278(0x69f))['style'][_0x494278(0x126b)]=_0x494278(0x10f2),_0x2b33fd(_0x1736d7[_0x494278(0x5ab)]);else{document['getElementById'](_0x494278(0x69f))[_0x494278(0x68e)][_0x494278(0x126b)]='block',document[_0x494278(0x89d)](_0x494278(0x2ef))['checked']=_0x1736d7[_0x494278(0xdb9)][_0x494278(0xa61)],document[_0x494278(0x89d)](_0x494278(0xdd2))['checked']=_0x1736d7[_0x494278(0xdb9)][_0x494278(0x983)];const _0xd24f44=document[_0x494278(0x89d)](_0x494278(0x84e)),_0x538350=document[_0x494278(0x89d)]('offline-mode-options'),_0x10c92b=document[_0x494278(0x89d)](_0x494278(0xf30)),_0xbd2f7a=document[_0x494278(0x89d)]('offline-max-length-input');_0xd24f44[_0x494278(0x1b0)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0xb65)]||![],_0x538350[_0x494278(0x68e)]['display']=_0xd24f44[_0x494278(0x1b0)]?_0x494278(0x1118):_0x494278(0x10f2),_0x10c92b[_0x494278(0x2f4)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0x87d)]||0x64,_0xbd2f7a[_0x494278(0x2f4)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0xcb5)]||0x12c,await _0x3d6ad3(_0x1736d7),document[_0x494278(0x89d)]('ai-original-name-input')[_0x494278(0x2f4)]=_0x1736d7[_0x494278(0x1045)],document[_0x494278(0x89d)]('ai-voice-id-input')['value']=_0x1736d7[_0x494278(0xdb9)]['minimaxVoiceId']||'',document[_0x494278(0x89d)](_0x494278(0xd54))[_0x494278(0x1b0)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0xe7e)]!==![],document[_0x494278(0x89d)](_0x494278(0x1002))[_0x494278(0x2f4)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0x1269)],document['getElementById'](_0x494278(0x1352))[_0x494278(0x9e3)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0xdd3)]||_0x265fcc,document[_0x494278(0x89d)](_0x494278(0xf8e))[_0x494278(0x2f4)]=_0x1736d7[_0x494278(0xdb9)]['myNickname']||'我',document[_0x494278(0x89d)]('ai-action-cooldown-input')[_0x494278(0x2f4)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0xfd9)]||0xa;const _0x5af256=document[_0x494278(0x89d)]('assign-group-select');_0x5af256[_0x494278(0x1ef)]=_0x494278(0xac4);const _0x1c1441=await _0x1a6951['qzoneGroups'][_0x494278(0xc2f)]();_0x1c1441[_0x494278(0xd9a)](_0x11fee4=>{const _0x599ca1=_0x494278,_0x58e877=document[_0x599ca1(0x285)]('option');_0x58e877[_0x599ca1(0x2f4)]=_0x11fee4['id'],_0x58e877[_0x599ca1(0xf12)]=_0x11fee4[_0x599ca1(0xf74)];if(_0x1736d7[_0x599ca1(0xb54)]===_0x11fee4['id'])_0x58e877[_0x599ca1(0x335)]=!![];_0x5af256['appendChild'](_0x58e877);});const _0x47da66=_0x1736d7[_0x494278(0xdb9)][_0x494278(0x8c5)]||{'vertical':_0x494278(0x113d),'horizontal':_0x494278(0x802),'offset':0xa};document['getElementById'](_0x494278(0x5d9))[_0x494278(0x2f4)]=_0x47da66[_0x494278(0xc4c)],document[_0x494278(0x89d)](_0x494278(0xe99))['value']=_0x47da66[_0x494278(0xade)],document[_0x494278(0x89d)](_0x494278(0x1146))[_0x494278(0x2f4)]=_0x47da66[_0x494278(0x1139)];}const _0x2fd3b3=document[_0x494278(0x89d)]('world-book-checkboxes-container');_0x2fd3b3['innerHTML']='';const [_0x213fcd,_0x1ad554]=await Promise[_0x494278(0x863)]([_0x1a6951[_0x494278(0xe8f)][_0x494278(0xc2f)](),_0x1a6951[_0x494278(0x8a1)][_0x494278(0xc2f)]()]),_0xa854f=new Set(_0x1736d7['settings'][_0x494278(0x32d)]||[]);if(_0x1ad554[_0x494278(0x7aa)]===0x0)_0x2fd3b3['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>';else{_0x213fcd[_0x494278(0xd9a)](_0x511e89=>{const _0x207b17=_0x494278,_0x12dc76=_0x1ad554[_0x207b17(0x3d8)](_0x4d3e1d=>_0x4d3e1d[_0x207b17(0xcb1)]===_0x511e89['id']);if(_0x12dc76[_0x207b17(0x7aa)]>0x0){const _0x1c84db=document[_0x207b17(0x285)]('h4');_0x1c84db[_0x207b17(0xf12)]=_0x511e89['name'],_0x1c84db[_0x207b17(0x68e)][_0x207b17(0x137a)]=_0x207b17(0xdca),_0x2fd3b3['appendChild'](_0x1c84db),_0x12dc76[_0x207b17(0xd9a)](_0x448847=>{const _0x5dceb3=_0x207b17,_0x5f0079=_0xa854f[_0x5dceb3(0xa14)](_0x448847['id']),_0x3af13b=document[_0x5dceb3(0x285)](_0x5dceb3(0x772));_0x3af13b[_0x5dceb3(0x1ef)]=_0x5dceb3(0x92d)+_0x448847['id']+'\x22\x20'+(_0x5f0079?_0x5dceb3(0x1b0):'')+'>\x20'+_0x448847[_0x5dceb3(0xf74)],_0x2fd3b3[_0x5dceb3(0x22f)](_0x3af13b);});}});const _0x28732b=_0x1ad554[_0x494278(0x3d8)](_0x45981d=>!_0x45981d['categoryId']);if(_0x28732b[_0x494278(0x7aa)]>0x0){const _0x34b76e=document['createElement']('h4');_0x34b76e[_0x494278(0xf12)]=_0x494278(0x1184),_0x34b76e[_0x494278(0x68e)][_0x494278(0x137a)]='margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;',_0x2fd3b3[_0x494278(0x22f)](_0x34b76e),_0x28732b['forEach'](_0x2d9fdb=>{const _0x55ba7e=_0x494278,_0x27f8d6=_0xa854f[_0x55ba7e(0xa14)](_0x2d9fdb['id']),_0x3becba=document[_0x55ba7e(0x285)](_0x55ba7e(0x772));_0x3becba[_0x55ba7e(0x1ef)]='<input\x20type=\x22checkbox\x22\x20value=\x22book_'+_0x2d9fdb['id']+'\x22\x20'+(_0x27f8d6?'checked':'')+'>\x20'+_0x2d9fdb[_0x55ba7e(0xf74)],_0x2fd3b3['appendChild'](_0x3becba);});}}_0x15de9c();const _0xfc098e=document[_0x494278(0x89d)](_0x494278(0xb1f)),_0x1886ea=document[_0x494278(0x89d)]('linked-memory-selection'),_0x40533d=document[_0x494278(0x89d)](_0x494278(0x3f4)),_0x5ef74d=_0x1736d7['settings'][_0x494278(0xf0e)]||[];_0xfc098e['checked']=_0x5ef74d[_0x494278(0x7aa)]>0x0,_0x1886ea[_0x494278(0x68e)][_0x494278(0x126b)]=_0xfc098e['checked']?_0x494278(0x1118):_0x494278(0x10f2),_0x40533d[_0x494278(0x1ef)]='',Object[_0x494278(0x4b5)](_0x5b873d['chats'])[_0x494278(0xd9a)](_0x32a52a=>{const _0x701bd1=_0x494278;if(_0x32a52a['id']===_0x1736d7['id'])return;const _0x289321=_0x5ef74d[_0x701bd1(0xced)](_0x32a52a['id']),_0x59121b=_0x32a52a[_0x701bd1(0x58c)]?_0x701bd1(0x2ee):'[私聊]',_0x449fe3=document['createElement'](_0x701bd1(0x772));_0x449fe3[_0x701bd1(0x1ef)]='<input\x20type=\x22checkbox\x22\x20value=\x22'+_0x32a52a['id']+'\x22\x20'+(_0x289321?_0x701bd1(0x1b0):'')+'>\x20'+_0x59121b+'\x20'+_0x32a52a['name'],_0x40533d[_0x701bd1(0x22f)](_0x449fe3);});function _0x50b6fd(){const _0x3b6db3=_0x494278,_0x15011e=_0x40533d['querySelectorAll']('input:checked'),_0x5ee843=_0x1886ea[_0x3b6db3(0xd16)]('.selected-options-text');if(_0x15011e[_0x3b6db3(0x7aa)]===0x0)_0x5ee843['textContent']='--\x20点击选择\x20--';else _0x15011e[_0x3b6db3(0x7aa)]>0x2?_0x5ee843[_0x3b6db3(0xf12)]='已选择\x20'+_0x15011e[_0x3b6db3(0x7aa)]+'\x20项':_0x5ee843['textContent']=Array[_0x3b6db3(0x321)](_0x15011e)[_0x3b6db3(0x412)](_0x42b6ef=>_0x42b6ef[_0x3b6db3(0x182)][_0x3b6db3(0xf12)]['trim']())['join'](',\x20');}_0x50b6fd(),_0xfc098e['addEventListener'](_0x494278(0x76c),()=>{const _0x471372=_0x494278;_0x1886ea['style']['display']=_0xfc098e[_0x471372(0x1b0)]?_0x471372(0x1118):_0x471372(0x10f2);});const _0x54a6fc=_0x1886ea[_0x494278(0xd16)](_0x494278(0x1057)),_0x2b1324=_0x54a6fc[_0x494278(0xf2a)](!![]);_0x54a6fc[_0x494278(0xb6e)][_0x494278(0xd38)](_0x2b1324,_0x54a6fc),_0x2b1324[_0x494278(0x1193)](_0x494278(0x12a5),_0x40bc78=>{const _0x4e1390=_0x494278;_0x40bc78[_0x4e1390(0x1088)](),_0x40533d[_0x4e1390(0x2f1)][_0x4e1390(0x73b)](_0x4e1390(0x11e4)),_0x2b1324[_0x4e1390(0x2f1)]['toggle'](_0x4e1390(0xd11));}),_0x40533d[_0x494278(0x1193)](_0x494278(0x76c),_0x50b6fd);const _0x54a9d5=document[_0x494278(0xd16)](_0x494278(0x11c8)+(_0x1736d7[_0x494278(0xdb9)]['theme']||_0x494278(0xfb4))+'\x22]');if(_0x54a9d5)_0x54a9d5[_0x494278(0x1b0)]=!![];const _0x3f94d5=document[_0x494278(0x89d)]('font-size-slider');_0x3f94d5['value']=_0x1736d7[_0x494278(0xdb9)]['fontSize']||0xd,document['getElementById']('font-size-value')[_0x494278(0xf12)]=_0x3f94d5['value']+'px';const _0x248f7a=document[_0x494278(0x89d)](_0x494278(0xf37));_0x248f7a[_0x494278(0x2f4)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0x12e7)]||'',_0x540a41(),document[_0x494278(0x89d)](_0x494278(0x118a))[_0x494278(0x1b0)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0x1375)]||![],document[_0x494278(0x89d)](_0x494278(0xba5))[_0x494278(0x2f4)]=_0x1736d7[_0x494278(0xdb9)][_0x494278(0xe59)]||0x14,_0x4e6c15('chat-settings-screen');});function _0x2b33fd(_0x3156e2){const _0x408894=_0x54b568,_0x5aed4a=document[_0x408894(0x89d)](_0x408894(0x1342));_0x5aed4a[_0x408894(0x1ef)]='',_0x3156e2[_0x408894(0xd9a)](_0x1e9399=>{const _0x1529c1=_0x408894,_0x457ea7=document[_0x1529c1(0x285)]('div');_0x457ea7[_0x1529c1(0x81c)]=_0x1529c1(0xfd5),_0x457ea7[_0x1529c1(0xaaf)][_0x1529c1(0x388)]=_0x1e9399['id'];const _0x43fe7a=_0x1e9399[_0x1529c1(0x12c8)]||(_0x5b873d[_0x1529c1(0x667)][_0x1e9399['id']]?_0x5b873d['chats'][_0x1e9399['id']]['settings'][_0x1529c1(0xdd3)]:_0x15061e);_0x457ea7[_0x1529c1(0x1ef)]='<img\x20src=\x22'+_0x43fe7a+_0x1529c1(0xee0)+_0x1e9399[_0x1529c1(0x7da)]+_0x1529c1(0xb4e)+_0x1e9399[_0x1529c1(0x7da)]+'</div>',_0x457ea7[_0x1529c1(0x1193)]('click',()=>_0x496def(_0x1e9399['id'])),_0x5aed4a['appendChild'](_0x457ea7);});}document[_0x54b568(0x89d)](_0x54b568(0xd23))['addEventListener'](_0x54b568(0x12a5),async()=>{const _0x36b1c7=_0x54b568;if(!_0x251560)return;const _0x1eb8ed=_0x5b873d[_0x36b1c7(0x667)][_0x5b873d[_0x36b1c7(0xf96)]],_0x59e36f=_0x1eb8ed[_0x36b1c7(0x5ab)][_0x36b1c7(0x12f4)](_0xea77ac=>_0xea77ac['id']===_0x251560);if(!_0x59e36f)return;const _0x770607=document['getElementById'](_0x36b1c7(0xe7d))[_0x36b1c7(0x2f4)][_0x36b1c7(0xc3a)]();if(!_0x770607){alert('群昵称不能为空！');return;}_0x59e36f[_0x36b1c7(0x7da)]=_0x770607,_0x59e36f[_0x36b1c7(0x1170)]=document[_0x36b1c7(0x89d)]('member-persona-input')[_0x36b1c7(0x2f4)];const _0x1d7a82=document['getElementById'](_0x36b1c7(0x5a9))[_0x36b1c7(0x9e3)];_0x59e36f[_0x36b1c7(0x12c8)]=_0x1d7a82;const _0x1da017=_0x5b873d[_0x36b1c7(0x667)][_0x59e36f['id']];_0x1da017&&(_0x1da017[_0x36b1c7(0xdb9)][_0x36b1c7(0xdd3)]=_0x1d7a82,await _0x1a6951['chats']['put'](_0x1da017)),await _0x1a6951[_0x36b1c7(0x667)][_0x36b1c7(0xc0f)](_0x1eb8ed),_0x2b33fd(_0x1eb8ed[_0x36b1c7(0x5ab)]),document[_0x36b1c7(0x89d)](_0x36b1c7(0x27f))[_0x36b1c7(0x2f1)][_0x36b1c7(0x1247)](_0x36b1c7(0x11e4)),_0x251560=null;});function _0x496def(_0x2b8e39){const _0x41e942=_0x54b568;_0x251560=_0x2b8e39;const _0xed33b4=_0x5b873d[_0x41e942(0x667)][_0x5b873d[_0x41e942(0xf96)]],_0x4b596f=_0xed33b4['members'][_0x41e942(0x12f4)](_0x12acf2=>_0x12acf2['id']===_0x2b8e39);if(!_0x4b596f)return;document[_0x41e942(0x89d)]('member-name-input')[_0x41e942(0x2f4)]=_0x4b596f[_0x41e942(0x7da)],document[_0x41e942(0x89d)](_0x41e942(0xd3c))[_0x41e942(0x2f4)]=_0x4b596f[_0x41e942(0x1170)];const _0x7db865=_0x4b596f[_0x41e942(0x12c8)]||(_0x5b873d[_0x41e942(0x667)][_0x4b596f['id']]?_0x5b873d[_0x41e942(0x667)][_0x4b596f['id']][_0x41e942(0xdb9)]['aiAvatar']:_0x15061e);document[_0x41e942(0x89d)](_0x41e942(0x5a9))[_0x41e942(0x9e3)]=_0x7db865,document['getElementById'](_0x41e942(0x27f))[_0x41e942(0x2f1)][_0x41e942(0x569)](_0x41e942(0x11e4));}document[_0x54b568(0x89d)](_0x54b568(0xa62))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x30512c=_0x54b568;document[_0x30512c(0x89d)]('member-settings-modal')[_0x30512c(0x2f1)][_0x30512c(0x1247)](_0x30512c(0x11e4)),_0x251560=null;}),document[_0x54b568(0x89d)]('save-member-settings-btn')['addEventListener'](_0x54b568(0x12a5),async()=>{const _0x455660=_0x54b568;if(!_0x251560)return;const _0x1d06d4=_0x5b873d[_0x455660(0x667)][_0x5b873d[_0x455660(0xf96)]],_0x224c33=_0x1d06d4[_0x455660(0x5ab)][_0x455660(0x12f4)](_0x483751=>_0x483751['id']===_0x251560);if(!_0x224c33)return;const _0x354e27=document['getElementById'](_0x455660(0xe7d))[_0x455660(0x2f4)][_0x455660(0xc3a)]();if(!_0x354e27){alert(_0x455660(0x1215));return;}_0x224c33['groupNickname']=_0x354e27,_0x224c33[_0x455660(0x1170)]=document[_0x455660(0x89d)](_0x455660(0xd3c))[_0x455660(0x2f4)];const _0x3c3ce9=document['getElementById']('member-avatar-preview')['src'];_0x224c33[_0x455660(0x12c8)]=_0x3c3ce9;const _0x2674a0=_0x5b873d[_0x455660(0x667)][_0x224c33['id']];_0x2674a0&&(_0x2674a0['settings']['aiAvatar']=_0x3c3ce9,await _0x1a6951[_0x455660(0x667)][_0x455660(0xc0f)](_0x2674a0)),await _0x1a6951[_0x455660(0x667)]['put'](_0x1d06d4),_0x2b33fd(_0x1d06d4[_0x455660(0x5ab)]),document[_0x455660(0x89d)]('member-settings-modal')[_0x455660(0x2f1)][_0x455660(0x1247)]('visible'),_0x251560=null;}),document[_0x54b568(0x89d)](_0x54b568(0xebe))[_0x54b568(0x1193)]('click',()=>{const _0xda8777=_0x54b568;document[_0xda8777(0x89d)]('theme-default')['checked']=!![];}),document[_0x54b568(0x89d)](_0x54b568(0x849))['addEventListener'](_0x54b568(0x12a5),async()=>{const _0x2261c3=_0x54b568;if(!_0x5b873d[_0x2261c3(0xf96)])return;const _0x439077=_0x5b873d[_0x2261c3(0x667)][_0x5b873d[_0x2261c3(0xf96)]],_0xdfc5bb=_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0xb65)]||![],_0x281cf5=document[_0x2261c3(0x89d)](_0x2261c3(0x2c5))[_0x2261c3(0x2f4)]['trim']();if(!_0x281cf5)return alert(_0x2261c3(0xe61));if(!_0x439077[_0x2261c3(0x58c)]&&_0x281cf5!==_0x439077['name']){if(!_0x439077[_0x2261c3(0xfe2)])_0x439077[_0x2261c3(0xfe2)]=[];if(!_0x439077['nameHistory']['includes'](_0x439077[_0x2261c3(0xf74)]))_0x439077[_0x2261c3(0xfe2)][_0x2261c3(0x138c)](_0x439077[_0x2261c3(0xf74)]);}_0x439077[_0x2261c3(0xf74)]=_0x281cf5;const _0x21483a=document[_0x2261c3(0xd16)](_0x2261c3(0x847));_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0x85e)]=_0x21483a?_0x21483a[_0x2261c3(0x2f4)]:_0x2261c3(0xfb4),_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0xb11)]=parseInt(document[_0x2261c3(0x89d)](_0x2261c3(0x102b))[_0x2261c3(0x2f4)]),_0x439077[_0x2261c3(0xdb9)]['customCss']=document['getElementById']('custom-css-input')[_0x2261c3(0x2f4)][_0x2261c3(0xc3a)](),_0x439077['settings'][_0x2261c3(0x6d4)]=document[_0x2261c3(0x89d)](_0x2261c3(0x12d8))[_0x2261c3(0x2f4)],_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0xd55)]=document[_0x2261c3(0x89d)](_0x2261c3(0x1255))['src'],_0x439077['settings'][_0x2261c3(0x46f)]=parseInt(document[_0x2261c3(0x89d)]('max-memory')[_0x2261c3(0x2f4)])||0xa,_0x439077[_0x2261c3(0xdb9)]['linkedMemoryCount']=parseInt(document[_0x2261c3(0x89d)](_0x2261c3(0xdb6))['value'])||0xa;const _0x3eff4d=document['querySelectorAll']('#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked'),_0x3c0733=[];_0x3eff4d[_0x2261c3(0xd9a)](_0x5a6398=>{const _0x3cd89f=_0x2261c3;_0x5a6398[_0x3cd89f(0x2f4)]['startsWith'](_0x3cd89f(0x3b0))&&_0x3c0733[_0x3cd89f(0x138c)](_0x5a6398[_0x3cd89f(0x2f4)][_0x3cd89f(0xfbf)](_0x3cd89f(0x3b0),''));}),_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0x32d)]=_0x3c0733;const _0x2a69ae=document['getElementById'](_0x2261c3(0xb1f))[_0x2261c3(0x1b0)];if(_0x2a69ae){const _0x48b000=document['querySelectorAll']('#linked-chats-checkboxes-container\x20input:checked');_0x439077[_0x2261c3(0xdb9)]['linkedMemoryChatIds']=Array[_0x2261c3(0x321)](_0x48b000)[_0x2261c3(0x412)](_0x89fd5c=>_0x89fd5c[_0x2261c3(0x2f4)]);}else _0x439077[_0x2261c3(0xdb9)]['linkedMemoryChatIds']=[];_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0x1375)]=document[_0x2261c3(0x89d)]('auto-memory-toggle')[_0x2261c3(0x1b0)],_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0xe59)]=parseInt(document['getElementById'](_0x2261c3(0xba5))[_0x2261c3(0x2f4)])||0x14,_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0x298)]=document['getElementById']('time-perception-toggle')[_0x2261c3(0x1b0)],_0x439077[_0x2261c3(0xdb9)]['timeZone']=document['getElementById']('time-zone-select')[_0x2261c3(0x2f4)];if(_0x439077[_0x2261c3(0x58c)])_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0xa61)]=document[_0x2261c3(0x89d)]('group-background-activity-switch')['checked'],_0x439077['settings']['myNickname']=document['getElementById'](_0x2261c3(0x6f9))[_0x2261c3(0x2f4)]['trim'](),_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0x108a)]=document[_0x2261c3(0x89d)](_0x2261c3(0x279))[_0x2261c3(0x9e3)],_0x439077[_0x2261c3(0xdb9)]['actionCooldownMinutes']=parseInt(document[_0x2261c3(0x89d)](_0x2261c3(0x747))['value'])||0xa;else{_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0xa61)]=document['getElementById'](_0x2261c3(0x2ef))[_0x2261c3(0x1b0)];const _0x2f4098=document[_0x2261c3(0x89d)](_0x2261c3(0x84e))[_0x2261c3(0x1b0)];_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0xb65)]=_0x2f4098;if(_0xdfc5bb===!![]&&_0x2f4098===![]){const _0x8dc077={'role':_0x2261c3(0x18c),'content':_0x2261c3(0x73e),'timestamp':Date['now'](),'isHidden':!![]};_0x439077[_0x2261c3(0x551)][_0x2261c3(0x138c)](_0x8dc077),console[_0x2261c3(0x471)]('已成功注入“切换到线上模式”的系统指令。');}_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0x983)]=document['getElementById']('inject-thought-toggle')[_0x2261c3(0x1b0)],_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0x87d)]=parseInt(document[_0x2261c3(0x89d)](_0x2261c3(0xf30))[_0x2261c3(0x2f4)])||0x64,_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0xcb5)]=parseInt(document[_0x2261c3(0x89d)](_0x2261c3(0xa16))['value'])||0x12c,_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0x404)]=document[_0x2261c3(0x89d)](_0x2261c3(0x12a3))[_0x2261c3(0x2f4)]||null;const _0x2008ca=document['getElementById'](_0x2261c3(0xd62))[_0x2261c3(0x2f4)][_0x2261c3(0xc3a)]();if(!_0x2008ca)return alert(_0x2261c3(0x8cc));_0x439077['originalName']=_0x2008ca,_0x439077[_0x2261c3(0xdb9)]['aiPersona']=document['getElementById'](_0x2261c3(0x1002))['value'],_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0x8f3)]=document[_0x2261c3(0x89d)](_0x2261c3(0x1227))[_0x2261c3(0x2f4)][_0x2261c3(0xc3a)](),_0x439077['settings']['enableTts']=document['getElementById'](_0x2261c3(0xd54))['checked'],_0x439077['settings'][_0x2261c3(0xdd3)]=document[_0x2261c3(0x89d)](_0x2261c3(0x1352))[_0x2261c3(0x9e3)],_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0xc48)]=document[_0x2261c3(0x89d)](_0x2261c3(0xf8e))['value'][_0x2261c3(0xc3a)]()||'我',_0x439077[_0x2261c3(0xdb9)]['actionCooldownMinutes']=parseInt(document[_0x2261c3(0x89d)](_0x2261c3(0x6f1))['value'])||0xa,_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0x8c5)]={'vertical':document[_0x2261c3(0x89d)](_0x2261c3(0x5d9))['value'],'horizontal':document[_0x2261c3(0x89d)](_0x2261c3(0xe99))[_0x2261c3(0x2f4)],'offset':parseInt(document[_0x2261c3(0x89d)](_0x2261c3(0x1146))[_0x2261c3(0x2f4)])||0xa};const _0x163554=document[_0x2261c3(0x89d)]('assign-group-select')['value'];_0x439077['groupId']=_0x163554?parseInt(_0x163554):null;}await _0x1a6951[_0x2261c3(0x667)]['put'](_0x439077),!_0x439077[_0x2261c3(0x58c)]&&(await _0x52ccfe(_0x439077),await _0x2f6a63(_0x439077)),_0x52994c(_0x439077),_0x5806c0(_0x439077[_0x2261c3(0xdb9)][_0x2261c3(0x12e7)],'#chat-messages',_0x2261c3(0x11f0)),_0x4e6c15(_0x2261c3(0x87f)),_0x5b89df(_0x5b873d[_0x2261c3(0xf96)]),_0x413d78();}),document[_0x54b568(0x89d)](_0x54b568(0xfae))[_0x54b568(0x1193)]('click',_0x3a1696=>{const _0x48e69b=_0x54b568;_0x3a1696[_0x48e69b(0x225)][_0x48e69b(0x2f1)][_0x48e69b(0x3ff)](_0x48e69b(0x745))&&_0x35e688(_0x48e69b(0xde9));}),document[_0x54b568(0x89d)](_0x54b568(0x27f))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x13b630=>{const _0x1f3cb6=_0x54b568;_0x13b630[_0x1f3cb6(0x225)][_0x1f3cb6(0x2f1)][_0x1f3cb6(0x3ff)](_0x1f3cb6(0x745))&&_0x35e688(_0x1f3cb6(0x6fb));});const _0x5e0941=document[_0x54b568(0x89d)](_0x54b568(0x1354)),_0x4b0228=document[_0x54b568(0x89d)](_0x54b568(0x137f)),_0x185d43=document[_0x54b568(0x89d)](_0x54b568(0x7f2)),_0x16ea1c=document['getElementById'](_0x54b568(0x839)),_0x4dd501=document['getElementById'](_0x54b568(0xa4b));document[_0x54b568(0x89d)](_0x54b568(0x10ba))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x85357e),document[_0x54b568(0x89d)](_0x54b568(0x829))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{_0x5e0941['classList']['remove']('visible'),_0x217004=![];}),_0x4b0228['addEventListener'](_0x54b568(0x12a5),()=>{const _0x3c0c28=_0x54b568;_0x4b0228[_0x3c0c28(0x2f1)][_0x3c0c28(0x569)]('active'),_0x185d43[_0x3c0c28(0x2f1)]['remove'](_0x3c0c28(0x8ea)),_0x16ea1c[_0x3c0c28(0x68e)][_0x3c0c28(0x126b)]=_0x3c0c28(0x1118),_0x4dd501['style'][_0x3c0c28(0x126b)]=_0x3c0c28(0x10f2);}),_0x185d43[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x3d7668=_0x54b568;_0x185d43[_0x3d7668(0x2f1)]['add'](_0x3d7668(0x8ea)),_0x4b0228[_0x3d7668(0x2f1)][_0x3d7668(0x1247)](_0x3d7668(0x8ea)),_0x4dd501[_0x3d7668(0x68e)][_0x3d7668(0x126b)]=_0x3d7668(0x1118),_0x16ea1c[_0x3d7668(0x68e)][_0x3d7668(0x126b)]=_0x3d7668(0x10f2);}),document[_0x54b568(0x89d)]('clear-chat-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x4a1f75=_0x54b568;if(!_0x5b873d[_0x4a1f75(0xf96)])return;const _0x29d380=_0x5b873d[_0x4a1f75(0x667)][_0x5b873d[_0x4a1f75(0xf96)]],_0x4b17c7=await _0x4e2abc(_0x4a1f75(0xae0),_0x4a1f75(0x4b6),{'confirmButtonClass':_0x4a1f75(0xcd8)});_0x4b17c7&&(_0x29d380['history']=[],_0x29d380[_0x4a1f75(0x253)]='...',_0x29d380['randomJottings']=_0x4a1f75(0x1046),await _0x1a6951[_0x4a1f75(0x667)][_0x4a1f75(0xc0f)](_0x29d380),_0x5b89df(_0x5b873d['activeChatId']),_0x413d78(),_0x767aac[_0x4a1f75(0x2f1)][_0x4a1f75(0x1247)](_0x4a1f75(0x11e4)));});const _0x26c59c=(_0x35da72,_0x5e44e1)=>{const _0x33c897=_0x54b568;document[_0x33c897(0x89d)](_0x35da72)[_0x33c897(0x1193)](_0x33c897(0x76c),async _0x561b32=>{const _0xd38fc7=_0x33c897,_0x4305a7=_0x561b32[_0xd38fc7(0x225)][_0xd38fc7(0x541)][0x0];if(_0x4305a7){const _0x27a0c5=await new Promise((_0x5b96e4,_0xa41cd3)=>{const _0x1a773e=_0xd38fc7,_0x502f79=new FileReader();_0x502f79[_0x1a773e(0x736)]=()=>_0x5b96e4(_0x502f79[_0x1a773e(0x9dc)]),_0x502f79['onerror']=()=>_0xa41cd3(_0x502f79[_0x1a773e(0x1fd)]),_0x502f79['readAsDataURL'](_0x4305a7);});_0x5e44e1(_0x27a0c5),_0x561b32[_0xd38fc7(0x225)]['value']=null;}});};_0x26c59c('ai-avatar-input',_0x54db04=>document[_0x54b568(0x89d)](_0x54b568(0x1352))[_0x54b568(0x9e3)]=_0x54db04),_0x26c59c(_0x54b568(0xce8),_0x560b0c=>document[_0x54b568(0x89d)](_0x54b568(0x1255))[_0x54b568(0x9e3)]=_0x560b0c),_0x26c59c('group-avatar-input',_0x4e8a8d=>document[_0x54b568(0x89d)](_0x54b568(0x279))['src']=_0x4e8a8d),_0x26c59c(_0x54b568(0xbde),_0x588d60=>document[_0x54b568(0x89d)]('member-avatar-preview')['src']=_0x588d60),_0x26c59c('bg-input',_0x475379=>{const _0x161f5c=_0x54b568;if(_0x5b873d['activeChatId']){_0x5b873d[_0x161f5c(0x667)][_0x5b873d[_0x161f5c(0xf96)]][_0x161f5c(0xdb9)][_0x161f5c(0x55c)]=_0x475379;const _0xd6f8cd=document['getElementById'](_0x161f5c(0x1a1));_0xd6f8cd[_0x161f5c(0x9e3)]=_0x475379,_0xd6f8cd[_0x161f5c(0x68e)][_0x161f5c(0x126b)]=_0x161f5c(0x1118),document[_0x161f5c(0x89d)](_0x161f5c(0x400))[_0x161f5c(0x68e)][_0x161f5c(0x126b)]=_0x161f5c(0x83c);}}),_0x26c59c(_0x54b568(0x117b),_0xa9dd16=>document[_0x54b568(0x89d)](_0x54b568(0x931))[_0x54b568(0x9e3)]=_0xa9dd16),document[_0x54b568(0x89d)](_0x54b568(0x400))[_0x54b568(0x1193)]('click',()=>{const _0x569277=_0x54b568;if(_0x5b873d[_0x569277(0xf96)]){_0x5b873d[_0x569277(0x667)][_0x5b873d[_0x569277(0xf96)]][_0x569277(0xdb9)][_0x569277(0x55c)]='';const _0x4e922a=document[_0x569277(0x89d)](_0x569277(0x1a1));_0x4e922a[_0x569277(0x9e3)]='',_0x4e922a[_0x569277(0x68e)]['display']='none',document['getElementById']('remove-bg-btn')[_0x569277(0x68e)][_0x569277(0x126b)]='none';}});const _0x3301cc=document[_0x54b568(0x89d)](_0x54b568(0x946));document[_0x54b568(0x89d)]('open-sticker-panel-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x2834ca=_0x54b568,_0xc74e5=_0x5b873d[_0x2834ca(0x667)][_0x5b873d[_0x2834ca(0xf96)]];_0xc74e5&&_0xc74e5[_0x2834ca(0xdb9)][_0x2834ca(0x353)]?_0x10313e=_0xc74e5[_0x2834ca(0xdb9)][_0x2834ca(0x353)]:_0x10313e=_0x2834ca(0x863),_0x1e547a(),_0x3301cc[_0x2834ca(0x2f1)][_0x2834ca(0x569)](_0x2834ca(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0x389))['addEventListener'](_0x54b568(0x12a5),()=>_0x3301cc[_0x54b568(0x2f1)][_0x54b568(0x1247)](_0x54b568(0x11e4))),document[_0x54b568(0x89d)](_0x54b568(0x10a5))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x49df57),document[_0x54b568(0x89d)](_0x54b568(0xaef))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>document[_0x54b568(0x89d)](_0x54b568(0xfb7))[_0x54b568(0x12a5)]()),document[_0x54b568(0x89d)](_0x54b568(0xfb7))[_0x54b568(0x1193)](_0x54b568(0x76c),async _0x4c3893=>{const _0x4c2ce4=_0x54b568,_0x26183f=_0x4c3893[_0x4c2ce4(0x225)][_0x4c2ce4(0x541)][0x0];if(!_0x26183f)return;const _0x2d3d67=new FileReader();_0x2d3d67[_0x4c2ce4(0x5b4)](_0x26183f),_0x2d3d67['onload']=async()=>{const _0x181e21=_0x4c2ce4,_0xbe4bff=_0x2d3d67[_0x181e21(0x9dc)],_0x31b959=await _0x34d246(_0x181e21(0x581),_0x181e21(0x105a));if(_0x31b959&&_0x31b959['trim']()){const _0x489618={'id':_0x181e21(0x305)+Date[_0x181e21(0xf1a)](),'url':_0xbe4bff,'name':_0x31b959[_0x181e21(0xc3a)](),'categoryId':_0x10313e!==_0x181e21(0x863)&&_0x10313e!==_0x181e21(0x67a)?_0x10313e:null};await _0x1a6951['userStickers'][_0x181e21(0x569)](_0x489618),_0x5b873d[_0x181e21(0x210)]['push'](_0x489618),_0x1e547a();}else{if(_0x31b959!==null)alert(_0x181e21(0x1f7));}},_0x4c3893[_0x4c2ce4(0x225)][_0x4c2ce4(0x2f4)]=null;}),document[_0x54b568(0x89d)](_0x54b568(0x1206))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>document[_0x54b568(0x89d)](_0x54b568(0x10d6))[_0x54b568(0x12a5)]()),document[_0x54b568(0x89d)]('image-upload-input')[_0x54b568(0x1193)](_0x54b568(0x76c),async _0x1cff51=>{const _0x4a76f1=_0x54b568,_0x297710=_0x1cff51['target'][_0x4a76f1(0x541)][0x0];if(!_0x297710||!_0x5b873d['activeChatId'])return;const _0xd30f2f=new FileReader();_0xd30f2f[_0x4a76f1(0x736)]=async _0x733226=>{const _0x47e36d=_0x4a76f1,_0x3122e9=_0x733226['target'][_0x47e36d(0x9dc)],_0x43cd5c=_0x5b873d[_0x47e36d(0x667)][_0x5b873d[_0x47e36d(0xf96)]],_0x148445={'role':_0x47e36d(0x116c),'content':[{'type':_0x47e36d(0xcad),'image_url':{'url':_0x3122e9}}],'timestamp':Date[_0x47e36d(0xf1a)]()};_0x43cd5c[_0x47e36d(0x551)][_0x47e36d(0x138c)](_0x148445),await _0x1a6951[_0x47e36d(0x667)][_0x47e36d(0xc0f)](_0x43cd5c),_0x58deee(_0x148445,_0x43cd5c),_0x413d78();},_0xd30f2f[_0x4a76f1(0x5b4)](_0x297710),_0x1cff51[_0x4a76f1(0x225)][_0x4a76f1(0x2f4)]=null;}),document['getElementById'](_0x54b568(0xe86))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x1a6b85=_0x54b568;if(!_0x5b873d[_0x1a6b85(0xf96)])return;const _0x3affd4=await _0x34d246(_0x1a6b85(0x80d),_0x1a6b85(0xdf7));if(_0x3affd4&&_0x3affd4[_0x1a6b85(0xc3a)]()){const _0x4d0637=_0x5b873d[_0x1a6b85(0x667)][_0x5b873d['activeChatId']],_0x33ca2f={'role':_0x1a6b85(0x116c),'type':_0x1a6b85(0xff9),'content':_0x3affd4['trim'](),'timestamp':Date[_0x1a6b85(0xf1a)]()};_0x4d0637['history'][_0x1a6b85(0x138c)](_0x33ca2f),await _0x1a6951[_0x1a6b85(0x667)]['put'](_0x4d0637),_0x58deee(_0x33ca2f,_0x4d0637),_0x413d78();}}),document[_0x54b568(0x89d)](_0x54b568(0xbf5))['addEventListener'](_0x54b568(0x12a5),async()=>{const _0x56052d=_0x54b568;if(!_0x5b873d[_0x56052d(0xf96)])return;const _0x2b43cf=await _0x34d246(_0x56052d(0x22d),_0x56052d(0x786));if(_0x2b43cf&&_0x2b43cf['trim']()){const _0x1cafd9=_0x5b873d[_0x56052d(0x667)][_0x5b873d['activeChatId']],_0x2730ae={'role':_0x56052d(0x116c),'type':_0x56052d(0x11f6),'content':_0x2b43cf[_0x56052d(0xc3a)](),'timestamp':Date[_0x56052d(0xf1a)]()};_0x1cafd9[_0x56052d(0x551)]['push'](_0x2730ae),await _0x1a6951['chats'][_0x56052d(0xc0f)](_0x1cafd9),_0x58deee(_0x2730ae,_0x1cafd9),_0x413d78();}});const _0x4aa26a=document['getElementById'](_0x54b568(0x5de));document[_0x54b568(0x89d)](_0x54b568(0xea6))[_0x54b568(0x1193)]('click',()=>{_0x4aa26a['classList']['add']('visible');}),_0x4aa26a[_0x54b568(0x1193)]('click',_0x25fee7=>{const _0x26cf2d=_0x54b568;_0x25fee7[_0x26cf2d(0x225)]===_0x4aa26a&&_0x4aa26a['classList'][_0x26cf2d(0x1247)](_0x26cf2d(0x11e4));}),document['getElementById'](_0x54b568(0x889))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x3bccb8),document[_0x54b568(0x89d)](_0x54b568(0x4a0))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x2d554f=_0x54b568;if(!_0x5b873d[_0x2d554f(0xf96)])return;const _0x217479=document[_0x2d554f(0x89d)](_0x2d554f(0x2dd)),_0x4003f8=document['getElementById'](_0x2d554f(0x171)),_0x45d177=_0x217479[_0x2d554f(0x2f4)][_0x2d554f(0xc3a)](),_0x51221d=parseFloat(_0x4003f8[_0x2d554f(0x2f4)]);if(!_0x45d177||isNaN(_0x51221d)||_0x51221d<=0x0){alert(_0x2d554f(0x1041));return;}const _0x75b0b4=_0x5b873d['chats'][_0x5b873d[_0x2d554f(0xf96)]],_0x18109f=Date[_0x2d554f(0xf1a)](),_0x2764e0=_0x75b0b4['isGroup']?_0x75b0b4['settings'][_0x2d554f(0xc48)]||'我':'我',_0xcb87b0={'role':_0x2d554f(0x116c),'senderName':_0x2764e0,'type':'waimai_request','productInfo':_0x45d177,'amount':_0x51221d,'status':'pending','countdownEndTime':_0x18109f+0xf*0x3c*0x3e8,'timestamp':_0x18109f};_0x75b0b4[_0x2d554f(0x551)][_0x2d554f(0x138c)](_0xcb87b0),await _0x1a6951['chats'][_0x2d554f(0xc0f)](_0x75b0b4),_0x58deee(_0xcb87b0,_0x75b0b4),_0x413d78(),_0x217479[_0x2d554f(0x2f4)]='',_0x4003f8['value']='',_0x4aa26a[_0x2d554f(0x2f1)]['remove'](_0x2d554f(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0x398))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x4556a6),document[_0x54b568(0x89d)](_0x54b568(0x216))['addEventListener']('click',_0x4af853),document[_0x54b568(0x89d)](_0x54b568(0x10e9))[_0x54b568(0x1193)]('click',_0x132dfc),document[_0x54b568(0x89d)](_0x54b568(0x855))[_0x54b568(0x1193)]('click',_0x1d48ab),document['getElementById'](_0x54b568(0xafb))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x1cdeca),document['getElementById'](_0x54b568(0x1266))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x315b00),document['getElementById'](_0x54b568(0x479))[_0x54b568(0x1193)]('click',_0x105645),document[_0x54b568(0x89d)]('preset-action-cancel')[_0x54b568(0x1193)]('click',_0x5b4fad),document[_0x54b568(0x89d)]('selection-cancel-btn')[_0x54b568(0x1193)]('click',_0x4ec1fb),document[_0x54b568(0x89d)]('selection-soft-delete-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0xc18218=_0x54b568;if(_0x2b125e[_0xc18218(0x746)]===0x0)return;const _0x17af62=await _0x4e2abc('删除消息',_0xc18218(0x447)+_0x2b125e[_0xc18218(0x746)]+_0xc18218(0x75d),{'confirmButtonClass':_0xc18218(0xcd8)});if(_0x17af62){const _0x4a3ea6=_0x5b873d[_0xc18218(0x667)][_0x5b873d['activeChatId']];let _0x1a5aa4=[];for(const _0x45aaf4 of _0x2b125e){const _0x27963e=_0x4a3ea6[_0xc18218(0x551)][_0xc18218(0x12f4)](_0x42b13d=>_0x42b13d[_0xc18218(0x114e)]===_0x45aaf4);_0x27963e&&_0x27963e[_0xc18218(0x48c)]===_0xc18218(0xa9c)&&_0x1a5aa4[_0xc18218(0x138c)](_0xc18218(0x660)+_0x27963e[_0xc18218(0xba1)]+_0xc18218(0xaf1)+_0x27963e['timestamp']+')');}_0x4a3ea6[_0xc18218(0x551)]=_0x4a3ea6[_0xc18218(0x551)][_0xc18218(0x3d8)](_0x1fedf2=>!_0x2b125e[_0xc18218(0xa14)](_0x1fedf2[_0xc18218(0x114e)]));let _0x133b92='一些之前的消息已被用户删除。';_0x1a5aa4[_0xc18218(0x7aa)]>0x0&&(_0x133b92+=_0xc18218(0x924)+_0x1a5aa4['join']('；')+'。');_0x133b92+=_0xc18218(0x2f9);const _0x562de8={'role':'system','content':'[系统提示：'+_0x133b92+']','timestamp':Date[_0xc18218(0xf1a)](),'isHidden':!![]};_0x4a3ea6[_0xc18218(0x551)]['push'](_0x562de8),await _0x1a6951[_0xc18218(0x667)][_0xc18218(0xc0f)](_0x4a3ea6),_0x5b89df(_0x5b873d['activeChatId']),_0x413d78();}}),document[_0x54b568(0x89d)](_0x54b568(0x11b1))['addEventListener']('click',async()=>{const _0x46a14f=_0x54b568;if(_0x2b125e[_0x46a14f(0x746)]===0x0)return;const _0x4d2bf1=await _0x4e2abc(_0x46a14f(0x1aa),'这将从历史记录中【永久抹除】这\x20'+_0x2b125e[_0x46a14f(0x746)]+_0x46a14f(0x16f),{'confirmButtonClass':_0x46a14f(0xcd8),'confirmText':_0x46a14f(0x6cd)});if(_0x4d2bf1){const _0x508d6c=_0x5b873d[_0x46a14f(0x667)][_0x5b873d[_0x46a14f(0xf96)]];_0x508d6c[_0x46a14f(0x551)]=_0x508d6c[_0x46a14f(0x551)][_0x46a14f(0x3d8)](_0x23c70d=>!_0x2b125e[_0x46a14f(0xa14)](_0x23c70d[_0x46a14f(0x114e)])),await _0x1a6951[_0x46a14f(0x667)][_0x46a14f(0xc0f)](_0x508d6c),_0x5b89df(_0x5b873d[_0x46a14f(0xf96)]),_0x413d78();}});const _0x3acbe0=document['getElementById'](_0x54b568(0x7eb));_0x3acbe0[_0x54b568(0x1193)](_0x54b568(0x104f),()=>_0x3866c6(_0x3acbe0[_0x54b568(0x2f4)][_0x54b568(0xc3a)](),!![])),document[_0x54b568(0x89d)](_0x54b568(0xe1e))['addEventListener'](_0x54b568(0x12a5),async()=>{const _0x47a089=_0x54b568,_0x297c31=_0x3acbe0[_0x47a089(0x2f4)]['trim']();if(!_0x297c31){alert(_0x47a089(0x1012));return;}_0x3866c6(_0x297c31,![]),_0x5b873d[_0x47a089(0x21a)][_0x47a089(0x268)]=_0x297c31,await _0x1a6951[_0x47a089(0x21a)][_0x47a089(0xc0f)](_0x5b873d[_0x47a089(0x21a)]),alert(_0x47a089(0x99a));}),document['getElementById'](_0x54b568(0xe8c))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x2508de),document[_0x54b568(0x35f)](_0x54b568(0x515))[_0x54b568(0xd9a)](_0xe75a3b=>{const _0x20d35d=_0x54b568;_0xe75a3b[_0x20d35d(0x1193)](_0x20d35d(0x12a5),()=>_0x17a49c(_0xe75a3b[_0x20d35d(0xaaf)]['view']));}),document[_0x54b568(0x89d)]('qzone-back-btn')['addEventListener'](_0x54b568(0x12a5),()=>_0x17a49c('messages-view')),document[_0x54b568(0x89d)](_0x54b568(0xe06))['addEventListener']('click',async()=>{const _0x476b2a=_0x54b568,_0x5556ce=await _0x34d246(_0x476b2a(0xd02),'请输入新的昵称',_0x5b873d[_0x476b2a(0x5c1)][_0x476b2a(0x22a)]);_0x5556ce&&_0x5556ce[_0x476b2a(0xc3a)]()&&(_0x5b873d[_0x476b2a(0x5c1)]['nickname']=_0x5556ce[_0x476b2a(0xc3a)](),await _0x338aea(),_0x31bd17());}),document[_0x54b568(0x89d)](_0x54b568(0xd17))['addEventListener']('click',()=>document[_0x54b568(0x89d)](_0x54b568(0x88c))[_0x54b568(0x12a5)]()),document[_0x54b568(0x89d)](_0x54b568(0xa36))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>document[_0x54b568(0x89d)](_0x54b568(0xc7d))[_0x54b568(0x12a5)]()),document['getElementById'](_0x54b568(0x88c))[_0x54b568(0x1193)](_0x54b568(0x76c),async _0x58bf16=>{const _0x465c92=_0x54b568,_0x1e8427=_0x58bf16[_0x465c92(0x225)][_0x465c92(0x541)][0x0];if(_0x1e8427){const _0xe05629=await new Promise(_0xf899de=>{const _0x5a6a2e=_0x465c92,_0x1386b6=new FileReader();_0x1386b6[_0x5a6a2e(0x736)]=()=>_0xf899de(_0x1386b6[_0x5a6a2e(0x9dc)]),_0x1386b6[_0x5a6a2e(0x5b4)](_0x1e8427);});_0x5b873d[_0x465c92(0x5c1)][_0x465c92(0x12c8)]=_0xe05629,await _0x338aea(),_0x31bd17();}_0x58bf16['target']['value']=null;}),document[_0x54b568(0x89d)](_0x54b568(0xc7d))[_0x54b568(0x1193)](_0x54b568(0x76c),async _0x3c4e8c=>{const _0x2ff8d7=_0x54b568,_0x373a5d=_0x3c4e8c[_0x2ff8d7(0x225)][_0x2ff8d7(0x541)][0x0];if(_0x373a5d){const _0x1e8d55=await new Promise(_0x9de4c6=>{const _0x334ed9=_0x2ff8d7,_0x59215c=new FileReader();_0x59215c[_0x334ed9(0x736)]=()=>_0x9de4c6(_0x59215c[_0x334ed9(0x9dc)]),_0x59215c[_0x334ed9(0x5b4)](_0x373a5d);});_0x5b873d[_0x2ff8d7(0x5c1)][_0x2ff8d7(0x17e)]=_0x1e8d55,await _0x338aea(),_0x31bd17();}_0x3c4e8c['target'][_0x2ff8d7(0x2f4)]=null;}),document['getElementById'](_0x54b568(0x98d))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x4daba1=_0x54b568;_0x1b955a();const _0x50319e=document[_0x4daba1(0x89d)]('create-post-modal');_0x50319e[_0x4daba1(0xaaf)][_0x4daba1(0x2f8)]=_0x4daba1(0x536),_0x50319e[_0x4daba1(0xd16)](_0x4daba1(0xbad))[_0x4daba1(0x68e)][_0x4daba1(0x126b)]='none',_0x50319e['querySelector'](_0x4daba1(0xd21))[_0x4daba1(0x68e)][_0x4daba1(0x126b)]=_0x4daba1(0x10f2),_0x50319e[_0x4daba1(0xd16)](_0x4daba1(0x1120))[_0x4daba1(0x68e)]['display']=_0x4daba1(0x10f2),_0x50319e[_0x4daba1(0xd16)](_0x4daba1(0x24e))['placeholder']=_0x4daba1(0x3e6);const _0x4eb995=document[_0x4daba1(0x89d)](_0x4daba1(0x29d));_0x4eb995[_0x4daba1(0x1ef)]='';const _0x58af07=await _0x1a6951['qzoneGroups'][_0x4daba1(0xc2f)]();_0x58af07[_0x4daba1(0x7aa)]>0x0?_0x58af07[_0x4daba1(0xd9a)](_0x3da54d=>{const _0x3ad910=_0x4daba1,_0x109cad=document[_0x3ad910(0x285)](_0x3ad910(0x772));_0x109cad[_0x3ad910(0x68e)][_0x3ad910(0x126b)]=_0x3ad910(0x1118),_0x109cad['innerHTML']=_0x3ad910(0x76f)+_0x3da54d['id']+_0x3ad910(0xe16)+_0x3da54d[_0x3ad910(0xf74)],_0x4eb995[_0x3ad910(0x22f)](_0x109cad);}):_0x4eb995['innerHTML']=_0x4daba1(0x8c0),_0x50319e[_0x4daba1(0x2f1)][_0x4daba1(0x569)](_0x4daba1(0x11e4));}),document[_0x54b568(0x89d)]('create-post-btn')[_0x54b568(0x1193)]('click',async()=>{const _0x197b6f=_0x54b568;_0x1b955a();const _0x2b0f77=document['getElementById']('create-post-modal');_0x2b0f77[_0x197b6f(0xaaf)]['mode']='complex',_0x2b0f77['querySelector'](_0x197b6f(0xbad))['style'][_0x197b6f(0x126b)]=_0x197b6f(0x66e),_0x2b0f77[_0x197b6f(0xd16)](_0x197b6f(0xd21))[_0x197b6f(0x2f1)][_0x197b6f(0x569)]('active'),_0x2b0f77[_0x197b6f(0xd16)](_0x197b6f(0x1120))[_0x197b6f(0x2f1)][_0x197b6f(0x1247)](_0x197b6f(0x8ea)),_0x2b0f77[_0x197b6f(0xd16)]('#post-public-text')['placeholder']=_0x197b6f(0xfd2);const _0x310de0=document[_0x197b6f(0x89d)](_0x197b6f(0x29d));_0x310de0['innerHTML']='';const _0x2832bb=await _0x1a6951[_0x197b6f(0x95b)][_0x197b6f(0xc2f)]();_0x2832bb[_0x197b6f(0x7aa)]>0x0?_0x2832bb[_0x197b6f(0xd9a)](_0x35442c=>{const _0x312011=_0x197b6f,_0x56ffee=document[_0x312011(0x285)](_0x312011(0x772));_0x56ffee[_0x312011(0x68e)][_0x312011(0x126b)]=_0x312011(0x1118),_0x56ffee[_0x312011(0x1ef)]=_0x312011(0x76f)+_0x35442c['id']+_0x312011(0xe16)+_0x35442c['name'],_0x310de0[_0x312011(0x22f)](_0x56ffee);}):_0x310de0[_0x197b6f(0x1ef)]='<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>',_0x2b0f77[_0x197b6f(0x2f1)]['add']('visible');}),document[_0x54b568(0x89d)](_0x54b568(0x3c4))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0xcf4948=_0x54b568;await _0x3e4f60(),_0x4e6c15(_0xcf4948(0xb31));}),document[_0x54b568(0x89d)](_0x54b568(0xd1a))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x2dbe94=_0x54b568;_0x4e6c15(_0x2dbe94(0x11b7)),_0x17a49c(_0x2dbe94(0x47b));}),document[_0x54b568(0x89d)](_0x54b568(0x11b3))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x294e9b=_0x54b568;_0x5b873d[_0x294e9b(0x131f)]=null,_0x4e6c15(_0x294e9b(0xb31));}),document[_0x54b568(0x89d)](_0x54b568(0xb06))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>document[_0x54b568(0x89d)](_0x54b568(0x251))['click']()),document[_0x54b568(0x89d)]('album-photo-input')[_0x54b568(0x1193)](_0x54b568(0x76c),async _0x400b81=>{const _0x3c75d4=_0x54b568;if(!_0x5b873d[_0x3c75d4(0x131f)])return;const _0x30b2c6=_0x400b81[_0x3c75d4(0x225)][_0x3c75d4(0x541)];if(!_0x30b2c6[_0x3c75d4(0x7aa)])return;const _0x50c7fc=await _0x1a6951[_0x3c75d4(0xe6e)][_0x3c75d4(0x650)](_0x5b873d[_0x3c75d4(0x131f)]);for(const _0x5bb968 of _0x30b2c6){const _0x310786=await new Promise(_0x2f7622=>{const _0x4af38b=_0x3c75d4,_0x3264be=new FileReader();_0x3264be[_0x4af38b(0x736)]=()=>_0x2f7622(_0x3264be[_0x4af38b(0x9dc)]),_0x3264be[_0x4af38b(0x5b4)](_0x5bb968);});await _0x1a6951['qzonePhotos'][_0x3c75d4(0x569)]({'albumId':_0x5b873d[_0x3c75d4(0x131f)],'url':_0x310786,'createdAt':Date[_0x3c75d4(0xf1a)]()});}const _0x552c62=await _0x1a6951['qzonePhotos'][_0x3c75d4(0x176)]('albumId')[_0x3c75d4(0xb17)](_0x5b873d[_0x3c75d4(0x131f)])[_0x3c75d4(0x749)](),_0x54ccbd={'photoCount':_0x552c62};if(!_0x50c7fc['photoCount']||_0x50c7fc['coverUrl'][_0x3c75d4(0xced)](_0x3c75d4(0xe4f))){const _0x3225fb=await _0x1a6951[_0x3c75d4(0xa00)]['where'](_0x3c75d4(0x113b))[_0x3c75d4(0xb17)](_0x5b873d[_0x3c75d4(0x131f)])[_0x3c75d4(0x2a6)]();if(_0x3225fb)_0x54ccbd['coverUrl']=_0x3225fb[_0x3c75d4(0x11de)];}await _0x1a6951['qzoneAlbums'][_0x3c75d4(0xdfc)](_0x5b873d[_0x3c75d4(0x131f)],_0x54ccbd),await _0x2403bf(),await _0x3e4f60(),_0x400b81[_0x3c75d4(0x225)]['value']=null,alert(_0x3c75d4(0xd65));}),document['getElementById'](_0x54b568(0x133b))[_0x54b568(0x1193)](_0x54b568(0x12a5),async _0x2f8828=>{const _0x4cd013=_0x54b568,_0xdd18cc=_0x2f8828['target'][_0x4cd013(0x53a)]('.photo-delete-btn'),_0x1f7b54=_0x2f8828['target'][_0x4cd013(0x53a)](_0x4cd013(0xd5a));if(_0xdd18cc){_0x2f8828['stopPropagation']();const _0x49e9f7=parseInt(_0xdd18cc[_0x4cd013(0xaaf)]['photoId']),_0x3e2460=await _0x4e2abc('删除照片',_0x4cd013(0xbdf),{'confirmButtonClass':_0x4cd013(0xcd8)});if(_0x3e2460){const _0x4d99c7=await _0x1a6951[_0x4cd013(0xa00)]['get'](_0x49e9f7);if(!_0x4d99c7)return;await _0x1a6951['qzonePhotos'][_0x4cd013(0x684)](_0x49e9f7);const _0x4002e7=await _0x1a6951[_0x4cd013(0xe6e)]['get'](_0x5b873d['activeAlbumId']),_0x4093f5=(_0x4002e7[_0x4cd013(0x903)]||0x1)-0x1,_0x21a74e={'photoCount':_0x4093f5};if(_0x4002e7[_0x4cd013(0x4e8)]===_0x4d99c7['url']){const _0x1f9ffc=await _0x1a6951['qzonePhotos'][_0x4cd013(0x176)](_0x4cd013(0x113b))[_0x4cd013(0xb17)](_0x5b873d[_0x4cd013(0x131f)])[_0x4cd013(0x2a6)]();_0x21a74e[_0x4cd013(0x4e8)]=_0x1f9ffc?_0x1f9ffc[_0x4cd013(0x11de)]:_0x4cd013(0xd64);}await _0x1a6951[_0x4cd013(0xe6e)]['update'](_0x5b873d['activeAlbumId'],_0x21a74e),await _0x2403bf(),await _0x3e4f60(),alert(_0x4cd013(0xbff));}}else _0x1f7b54&&_0x48ec29(_0x1f7b54['src']);}),document[_0x54b568(0x89d)](_0x54b568(0x3dd))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x35e483),document[_0x54b568(0x89d)](_0x54b568(0xc78))['addEventListener'](_0x54b568(0x12a5),_0x41230c),document['getElementById'](_0x54b568(0x1b4))[_0x54b568(0x1193)]('click',_0x39ecae),document[_0x54b568(0x1193)](_0x54b568(0x830),_0x237bf4=>{const _0x2d24f1=_0x54b568;if(!_0x5f2baa[_0x2d24f1(0xafa)])return;if(_0x237bf4[_0x2d24f1(0x5a6)]===_0x2d24f1(0xf58))_0x41230c();else{if(_0x237bf4[_0x2d24f1(0x5a6)]===_0x2d24f1(0xea9))_0x39ecae();else _0x237bf4[_0x2d24f1(0x5a6)]===_0x2d24f1(0x297)&&_0x35e483();}}),document['getElementById']('create-album-btn-page')[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x7ab3ac=_0x54b568,_0x18cb9c=await _0x34d246(_0x7ab3ac(0xaaa),_0x7ab3ac(0x823));if(_0x18cb9c&&_0x18cb9c['trim']()){const _0x5cceb2={'name':_0x18cb9c[_0x7ab3ac(0xc3a)](),'coverUrl':'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','photoCount':0x0,'createdAt':Date[_0x7ab3ac(0xf1a)]()};await _0x1a6951[_0x7ab3ac(0xe6e)]['add'](_0x5cceb2),await _0x3e4f60(),alert(_0x7ab3ac(0x532)+_0x18cb9c+_0x7ab3ac(0x2f2));}else _0x18cb9c!==null&&alert(_0x7ab3ac(0x1163));}),document[_0x54b568(0x89d)]('cancel-create-post-btn')['addEventListener'](_0x54b568(0x12a5),()=>document[_0x54b568(0x89d)](_0x54b568(0x1273))[_0x54b568(0x2f1)][_0x54b568(0x1247)](_0x54b568(0x11e4))),document['getElementById'](_0x54b568(0x39c))['addEventListener'](_0x54b568(0x12a5),()=>document[_0x54b568(0x89d)](_0x54b568(0xb36))[_0x54b568(0x12a5)]()),document[_0x54b568(0x89d)]('post-local-image-input')[_0x54b568(0x1193)]('change',_0x2cf45a=>{const _0x1b5227=_0x54b568,_0x308c54=_0x2cf45a['target'][_0x1b5227(0x541)][0x0];if(_0x308c54){const _0x3622e1=new FileReader();_0x3622e1[_0x1b5227(0x736)]=_0xa20344=>{const _0x1ed006=_0x1b5227;document[_0x1ed006(0x89d)](_0x1ed006(0xca1))[_0x1ed006(0x9e3)]=_0xa20344['target'][_0x1ed006(0x9dc)],document['getElementById']('post-image-preview-container')[_0x1ed006(0x2f1)]['add'](_0x1ed006(0x11e4)),document[_0x1ed006(0x89d)](_0x1ed006(0xb9d))[_0x1ed006(0x68e)][_0x1ed006(0x126b)]=_0x1ed006(0x1118);},_0x3622e1[_0x1b5227(0x5b4)](_0x308c54);}}),document['getElementById'](_0x54b568(0x1188))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x42b71d=_0x54b568,_0x316be7=await _0x34d246(_0x42b71d(0x11cf),_0x42b71d(0xf03),'',_0x42b71d(0x11de));_0x316be7&&(document[_0x42b71d(0x89d)](_0x42b71d(0xca1))['src']=_0x316be7,document['getElementById'](_0x42b71d(0x909))[_0x42b71d(0x2f1)][_0x42b71d(0x569)](_0x42b71d(0x11e4)),document[_0x42b71d(0x89d)](_0x42b71d(0xb9d))[_0x42b71d(0x68e)][_0x42b71d(0x126b)]='block');}),document[_0x54b568(0x89d)](_0x54b568(0x103d))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>_0x1b955a());const _0x4b1d85=document[_0x54b568(0x89d)](_0x54b568(0x73d)),_0x124bef=document[_0x54b568(0x89d)](_0x54b568(0x417)),_0x5b7b03=document[_0x54b568(0x89d)](_0x54b568(0xc47)),_0x1aa732=document[_0x54b568(0x89d)]('text-image-mode-content');_0x4b1d85[_0x54b568(0x1193)]('click',()=>{const _0x59933b=_0x54b568;_0x4b1d85[_0x59933b(0x2f1)][_0x59933b(0x569)](_0x59933b(0x8ea)),_0x124bef[_0x59933b(0x2f1)][_0x59933b(0x1247)]('active'),_0x5b7b03[_0x59933b(0x2f1)][_0x59933b(0x569)](_0x59933b(0x8ea)),_0x1aa732[_0x59933b(0x2f1)][_0x59933b(0x1247)](_0x59933b(0x8ea));}),_0x124bef[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x1bc314=_0x54b568;_0x124bef[_0x1bc314(0x2f1)]['add'](_0x1bc314(0x8ea)),_0x4b1d85['classList']['remove']('active'),_0x1aa732['classList'][_0x1bc314(0x569)]('active'),_0x5b7b03[_0x1bc314(0x2f1)][_0x1bc314(0x1247)](_0x1bc314(0x8ea));}),document[_0x54b568(0x89d)](_0x54b568(0xde5))[_0x54b568(0x1193)]('click',async()=>{const _0x184369=_0x54b568,_0x3f2361=document['getElementById']('create-post-modal'),_0x1ff861=_0x3f2361[_0x184369(0xaaf)][_0x184369(0x2f8)],_0x1b485c=document[_0x184369(0xd16)]('input[name=\x22visibility\x22]:checked')[_0x184369(0x2f4)];let _0x62890a=null;_0x1b485c==='include'&&(_0x62890a=Array[_0x184369(0x321)](document[_0x184369(0x35f)](_0x184369(0x10b7)))[_0x184369(0x412)](_0x734e00=>parseInt(_0x734e00[_0x184369(0x2f4)])));let _0x4d247f={};const _0x4c354e={'timestamp':Date[_0x184369(0xf1a)](),'authorId':'user','visibleGroupIds':_0x62890a};if(_0x1ff861===_0x184369(0x536)){const _0x294ec3=document[_0x184369(0x89d)](_0x184369(0x872))[_0x184369(0x2f4)][_0x184369(0xc3a)]();if(!_0x294ec3){alert(_0x184369(0x133f));return;}_0x4d247f={..._0x4c354e,'type':_0x184369(0x536),'content':_0x294ec3};}else{const _0x3a70ef=document['getElementById']('post-public-text')['value'][_0x184369(0xc3a)](),_0x2eacc0=document[_0x184369(0x89d)](_0x184369(0xc47))['classList'][_0x184369(0x3ff)](_0x184369(0x8ea));if(_0x2eacc0){const _0x4f08b4=document['getElementById'](_0x184369(0xca1))['src'],_0x104d99=document[_0x184369(0x89d)](_0x184369(0x959))[_0x184369(0x2f4)][_0x184369(0xc3a)]();if(!_0x4f08b4||!(_0x4f08b4['startsWith'](_0x184369(0x1005))||_0x4f08b4[_0x184369(0x1222)](_0x184369(0xbe3)))){alert('请先添加一张图片再发布动态哦！');return;}if(!_0x104d99){alert('请为你的图片添加一个简单的描述（必填，给AI看的）！');return;}_0x4d247f={..._0x4c354e,'type':_0x184369(0xe70),'publicText':_0x3a70ef,'imageUrl':_0x4f08b4,'imageDescription':_0x104d99};}else{const _0x45952a=document[_0x184369(0x89d)](_0x184369(0x74e))['value'][_0x184369(0xc3a)]();if(!_0x45952a){alert('请输入文字图描述！');return;}_0x4d247f={..._0x4c354e,'type':_0x184369(0x574),'publicText':_0x3a70ef,'hiddenContent':_0x45952a};}}const _0x5320c2=await _0x1a6951['qzonePosts']['add'](_0x4d247f);let _0x45c94b=_0x4d247f[_0x184369(0x28c)]||_0x4d247f[_0x184369(0x957)]||_0x4d247f[_0x184369(0x12ce)]||_0x4d247f[_0x184369(0x132c)]||_0x184369(0x45a);_0x45c94b=_0x45c94b[_0x184369(0x489)](0x0,0x32)+(_0x45c94b[_0x184369(0x7aa)]>0x32?_0x184369(0x1046):'');for(const _0x3c7286 in _0x5b873d[_0x184369(0x667)]){const _0x4c9f80=_0x5b873d[_0x184369(0x667)][_0x3c7286];if(_0x4c9f80[_0x184369(0x58c)])continue;let _0x29afc7=![];const _0x665cf9=_0x4d247f[_0x184369(0x1166)];if(!_0x665cf9||_0x665cf9['length']===0x0)_0x29afc7=!![];else _0x4c9f80['groupId']&&_0x665cf9['includes'](_0x4c9f80[_0x184369(0xb54)])&&(_0x29afc7=!![]);if(_0x29afc7){const _0x4ad804={'role':_0x184369(0x18c),'content':_0x184369(0xf65)+_0x5320c2+_0x184369(0x420)+_0x45c94b+_0x184369(0x679),'timestamp':Date[_0x184369(0xf1a)](),'isHidden':!![]};_0x4c9f80[_0x184369(0x551)][_0x184369(0x138c)](_0x4ad804),await _0x1a6951['chats'][_0x184369(0xc0f)](_0x4c9f80);}}await _0x155816(),_0x3f2361[_0x184369(0x2f1)][_0x184369(0x1247)](_0x184369(0x11e4)),alert(_0x184369(0x99d));});const _0x3e5245=document[_0x54b568(0x89d)]('qzone-posts-list');let _0x1d368e={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0x42b616(_0xb8213a=null){const _0x120973=_0x54b568;document[_0x120973(0x35f)](_0x120973(0xaf8))['forEach'](_0x11a075=>{const _0x5ec302=_0x120973;_0x11a075!==_0xb8213a&&_0x11a075['querySelector']('.qzone-post-item')['classList'][_0x5ec302(0x1247)](_0x5ec302(0x8a0));});}async function _0x4e63b4(_0x5deffd){const _0x17217e=_0x54b568;_0x5deffd[_0x17217e(0x1088)]();const _0x52b348=_0x5deffd[_0x17217e(0x225)],_0xd2b103=_0x52b348[_0x17217e(0x53a)](_0x17217e(0xe7a));if(_0xd2b103){const _0x4e9c8f=_0xd2b103['closest'](_0x17217e(0xaf8)),_0x11a7d0=parseInt(_0x4e9c8f[_0x17217e(0xaaf)][_0x17217e(0x7b6)]),_0x58c956=parseInt(_0xd2b103[_0x17217e(0xaaf)][_0x17217e(0x167)]);if(isNaN(_0x11a7d0)||isNaN(_0x58c956))return;const _0xa568=_0xbd77bc[_0x17217e(0x12f4)](_0x5f3dcb=>_0x5f3dcb['id']===_0x11a7d0);if(!_0xa568||!_0xa568[_0x17217e(0x1157)]||!_0xa568[_0x17217e(0x1157)][_0x58c956])return;const _0x41f821=_0xa568[_0x17217e(0x1157)][_0x58c956],_0x131974=await _0x4e2abc(_0x17217e(0x4c2),_0x17217e(0x53b),{'confirmButtonClass':_0x17217e(0xcd8)});if(_0x131974){_0xa568[_0x17217e(0x1157)][_0x17217e(0x776)](_0x58c956,0x1),await _0x1a6951[_0x17217e(0xea0)][_0x17217e(0xdfc)](_0x11a7d0,{'comments':_0xa568['comments']});if(_0x41f821&&_0x41f821[_0x17217e(0xf20)]===_0x5b873d[_0x17217e(0x5c1)][_0x17217e(0x22a)]){console[_0x17217e(0x471)](_0x17217e(0x36f));const _0x3c6623=new Set();_0xa568[_0x17217e(0xc3f)]!==_0x17217e(0x116c)&&_0x3c6623[_0x17217e(0x569)](_0xa568[_0x17217e(0xc3f)]);if(_0x41f821[_0x17217e(0x8e7)]){const _0x52baaf=Object[_0x17217e(0x4b5)](_0x5b873d[_0x17217e(0x667)])['find'](_0x500d01=>_0x500d01[_0x17217e(0x1045)]===_0x41f821[_0x17217e(0x8e7)]);_0x52baaf&&_0x3c6623[_0x17217e(0x569)](_0x52baaf['id']);}const _0x135999=(_0xa568[_0x17217e(0x957)]||_0xa568[_0x17217e(0x28c)]||'')[_0x17217e(0x489)](0x0,0x1e),_0x528df3=_0x5b873d[_0x17217e(0x5c1)][_0x17217e(0x22a)];let _0x5b837c;const _0x3332d1=_0x5b873d[_0x17217e(0x210)]['find'](_0x1dcf79=>_0x1dcf79[_0x17217e(0x11de)]===_0x41f821[_0x17217e(0xec9)]);if(_0x3332d1)_0x5b837c=_0x17217e(0xacb)+_0x528df3+_0x17217e(0x6e2)+_0x135999+_0x17217e(0x11a0)+_0x3332d1[_0x17217e(0xf74)]+'”。';else{if(_0x41f821[_0x17217e(0x8e7)]){const _0x16b0fb=_0x471a37(_0x41f821[_0x17217e(0x8e7)]);_0x5b837c=_0x17217e(0xacb)+_0x528df3+_0x17217e(0x6e2)+_0x135999+_0x17217e(0x355)+_0x16b0fb+_0x17217e(0x44e)+_0x41f821[_0x17217e(0xec9)]+'”。';}else _0x5b837c=_0x17217e(0xacb)+_0x528df3+'\x27刚刚评论了你的动态“'+_0x135999+_0x17217e(0x4c6)+_0x41f821[_0x17217e(0xec9)]+'”。';}const _0x397269='[系统提示：'+_0x5b837c+_0x17217e(0xb1d);for(const _0x198c0d of _0x3c6623){const _0x4bd24b=_0x5b873d[_0x17217e(0x667)][_0x198c0d];if(_0x4bd24b){const _0x22e05a=_0x4bd24b[_0x17217e(0x551)][_0x17217e(0x7aa)];_0x4bd24b[_0x17217e(0x551)]=_0x4bd24b[_0x17217e(0x551)][_0x17217e(0x3d8)](_0x25e9c6=>!(_0x25e9c6[_0x17217e(0x9ae)]&&_0x25e9c6[_0x17217e(0xa57)]===_0x17217e(0x18c)&&_0x25e9c6[_0x17217e(0x28c)]===_0x397269)),_0x4bd24b[_0x17217e(0x551)][_0x17217e(0x7aa)]<_0x22e05a&&(console[_0x17217e(0x471)]('在角色\x20\x22'+_0x4bd24b[_0x17217e(0xf74)]+_0x17217e(0x934)),await _0x1a6951[_0x17217e(0x667)][_0x17217e(0xc0f)](_0x4bd24b));}}}await _0x2d4910(_0x11a7d0);}return;}const _0x111f02=_0x52b348['closest']('.comment-sticker-btn');if(_0x111f02){const _0x1e7dda=_0x111f02[_0x17217e(0x53a)](_0x17217e(0xaf8));if(!_0x1e7dda)return;const _0x2a57e9=parseInt(_0x1e7dda[_0x17217e(0xaaf)][_0x17217e(0x7b6)]);_0x40df96[_0x17217e(0xafa)]&&_0x40df96['activePostId']===_0x2a57e9?_0x175ea0():_0x3733bf(_0x2a57e9,_0x111f02);return;}const _0x449954=_0x52b348[_0x17217e(0x53a)](_0x17217e(0xb7b));if(_0x449954){const _0x374d4b=parseInt(_0x449954[_0x17217e(0xaaf)][_0x17217e(0x7b6)]),_0x1f9beb=_0x449954[_0x17217e(0xaaf)][_0x17217e(0xb0c)],_0x192c1b=_0x449954[_0x17217e(0xaaf)][_0x17217e(0x54b)];if(!_0x1f9beb||!_0x192c1b||_0x1f9beb===_0x5b873d[_0x17217e(0x5c1)]['nickname']){_0x4bca60(_0x449954[_0x17217e(0x53a)]('.qzone-post-container'));return;}_0x5219d8={'postId':_0x374d4b,'replyToName':_0x1f9beb,'replyToDisplayName':_0x192c1b};const _0x519f84=_0x449954[_0x17217e(0x53a)]('.qzone-post-container'),_0x3121e7=_0x519f84['querySelector'](_0x17217e(0x109a));_0x3121e7[_0x17217e(0xe4f)]=_0x17217e(0x343)+_0x192c1b+':',_0x3121e7['focus']();return;}if(_0x52b348[_0x17217e(0x2f1)][_0x17217e(0x3ff)](_0x17217e(0x166))){const _0x1bac8a=_0x52b348[_0x17217e(0x53a)](_0x17217e(0xaf8));if(_0x1bac8a&&_0x1bac8a[_0x17217e(0xaaf)][_0x17217e(0x7b6)])_0x3486fb(parseInt(_0x1bac8a[_0x17217e(0xaaf)][_0x17217e(0x7b6)]));return;}if(_0x52b348[_0x17217e(0xb2f)]===_0x17217e(0xb96)&&_0x52b348[_0x17217e(0xaaf)][_0x17217e(0x78a)]){_0x532f76('图片内容',_0x52b348[_0x17217e(0xaaf)][_0x17217e(0x78a)]['replace'](/<br>/g,'\x0a'));return;}const _0x21d1bb=_0x52b348[_0x17217e(0x53a)](_0x17217e(0xaf8));if(!_0x21d1bb)return;const _0x4f5e99=parseInt(_0x21d1bb[_0x17217e(0xaaf)][_0x17217e(0x7b6)]);if(isNaN(_0x4f5e99))return;if(_0x52b348['closest']('.qzone-post-delete-action')){const _0x4c6776=await _0x4e2abc(_0x17217e(0x11c3),_0x17217e(0x7e1),{'confirmButtonClass':_0x17217e(0xcd8)});_0x4c6776&&(_0x21d1bb[_0x17217e(0x68e)][_0x17217e(0xde0)]=_0x17217e(0x478),_0x21d1bb[_0x17217e(0x68e)]['transform']='scale(0.8)',_0x21d1bb[_0x17217e(0x68e)]['opacity']='0',setTimeout(async()=>{const _0x5d9b65=_0x17217e;await _0x1a6951[_0x5d9b65(0xea0)]['delete'](_0x4f5e99);const _0x5468e6='(ID:\x20'+_0x4f5e99+')';for(const _0x2f7804 in _0x5b873d[_0x5d9b65(0x667)]){const _0x310618=_0x5b873d[_0x5d9b65(0x667)][_0x2f7804],_0xdfb664=_0x310618[_0x5d9b65(0x551)]['length'];_0x310618[_0x5d9b65(0x551)]=_0x310618[_0x5d9b65(0x551)][_0x5d9b65(0x3d8)](_0x2fb5ff=>!(_0x2fb5ff[_0x5d9b65(0xa57)]==='system'&&_0x2fb5ff[_0x5d9b65(0x28c)][_0x5d9b65(0xced)](_0x5468e6)));if(_0x310618['history']['length']<_0xdfb664)await _0x1a6951['chats'][_0x5d9b65(0xc0f)](_0x310618);}await _0x155816(),alert(_0x5d9b65(0x12dd));},0x12c));return;}const _0x5ae7cc=_0x52b348[_0x17217e(0x53a)](_0x17217e(0x357));if(_0x5ae7cc){if(_0x5ae7cc[_0x17217e(0x2f1)]['contains'](_0x17217e(0xb95))){_0x45cb2a(_0x4f5e99);return;}if(_0x5ae7cc[_0x17217e(0x2f1)][_0x17217e(0x3ff)]('like')){const _0x232ff2=_0xbd77bc[_0x17217e(0x12f4)](_0x3fac34=>_0x3fac34['id']===_0x4f5e99);if(!_0x232ff2)return;if(!_0x232ff2[_0x17217e(0xfe6)])_0x232ff2[_0x17217e(0xfe6)]=[];const _0x526841=_0x5b873d[_0x17217e(0x5c1)]['nickname'],_0x2c8a7a=_0x232ff2[_0x17217e(0xfe6)][_0x17217e(0x37c)](_0x526841);_0x2c8a7a>-0x1?_0x232ff2[_0x17217e(0xfe6)]['splice'](_0x2c8a7a,0x1):(_0x232ff2[_0x17217e(0xfe6)]['push'](_0x526841),_0x5ae7cc[_0x17217e(0x2f1)][_0x17217e(0x569)](_0x17217e(0x134e)),_0x5ae7cc[_0x17217e(0x1193)]('animationend',()=>_0x5ae7cc[_0x17217e(0x2f1)][_0x17217e(0x1247)]('animate-like'),{'once':!![]})),await _0x1a6951[_0x17217e(0xea0)][_0x17217e(0xdfc)](_0x4f5e99,{'likes':_0x232ff2[_0x17217e(0xfe6)]}),await _0x2d4910(_0x4f5e99);}if(_0x5ae7cc[_0x17217e(0x2f1)][_0x17217e(0x3ff)]('favorite')){const _0x58aa65=await _0x1a6951[_0x17217e(0x183)][_0x17217e(0x176)]({'type':_0x17217e(0x8ed),'content.id':_0x4f5e99})[_0x17217e(0x2a6)]();if(_0x58aa65)await _0x1a6951[_0x17217e(0x183)][_0x17217e(0x684)](_0x58aa65['id']),await _0x532f76('提示',_0x17217e(0xc8f));else{const _0xbf0ef3=await _0x1a6951[_0x17217e(0xea0)]['get'](_0x4f5e99);_0xbf0ef3&&(await _0x1a6951[_0x17217e(0x183)][_0x17217e(0x569)]({'type':_0x17217e(0x8ed),'content':_0xbf0ef3,'timestamp':Date['now']()}),await _0x532f76('提示',_0x17217e(0x11ce)));}await _0x2d4910(_0x4f5e99);}return;}const _0x3a2c21=_0x52b348['closest'](_0x17217e(0x1311));if(_0x3a2c21){const _0x83de00=_0x21d1bb[_0x17217e(0xd16)](_0x17217e(0x109a)),_0x268a21=_0x83de00[_0x17217e(0x2f4)][_0x17217e(0xc3a)]();if(!_0x268a21)return alert('评论内容不能为空哦！');const _0x91df9=_0xbd77bc[_0x17217e(0x12f4)](_0x1db7af=>_0x1db7af['id']===_0x4f5e99);if(!_0x91df9)return;if(!_0x91df9[_0x17217e(0x1157)])_0x91df9[_0x17217e(0x1157)]=[];const _0x1c178a={'commenterName':_0x5b873d[_0x17217e(0x5c1)][_0x17217e(0x22a)],'text':_0x268a21,'timestamp':Date[_0x17217e(0xf1a)](),'replyTo':_0x5219d8&&_0x5219d8[_0x17217e(0x7b6)]===_0x4f5e99?_0x5219d8[_0x17217e(0x11ed)]:null};_0x91df9[_0x17217e(0x1157)][_0x17217e(0x138c)](_0x1c178a),await _0x1a6951[_0x17217e(0xea0)][_0x17217e(0xdfc)](_0x4f5e99,{'comments':_0x91df9[_0x17217e(0x1157)]});let _0x162995=(_0x91df9[_0x17217e(0x957)]||_0x91df9[_0x17217e(0x28c)]||'')[_0x17217e(0x489)](0x0,0x1e);const _0x424270=_0x5b873d['qzoneSettings']['nickname'],_0x2f7b69=new Set();if(_0x91df9[_0x17217e(0xc3f)]!==_0x17217e(0x116c))_0x2f7b69[_0x17217e(0x569)](_0x91df9[_0x17217e(0xc3f)]);if(_0x1c178a[_0x17217e(0x8e7)]&&_0x1c178a[_0x17217e(0x8e7)]!==_0x424270){const _0x4e1840=Object['values'](_0x5b873d[_0x17217e(0x667)])[_0x17217e(0x12f4)](_0x96b590=>_0x96b590[_0x17217e(0x1045)]===_0x1c178a[_0x17217e(0x8e7)]);if(_0x4e1840)_0x2f7b69[_0x17217e(0x569)](_0x4e1840['id']);}for(const _0x19c70b of _0x2f7b69){const _0x91fa18=_0x5b873d[_0x17217e(0x667)][_0x19c70b];if(_0x91fa18&&!_0x91fa18[_0x17217e(0x58c)]){const _0x45f6f7=_0x5b873d[_0x17217e(0x210)]['find'](_0x7f4589=>_0x7f4589[_0x17217e(0x11de)]===_0x268a21);let _0x46891f=_0x45f6f7?_0x17217e(0xacb)+_0x424270+_0x17217e(0x6e2)+_0x162995+_0x17217e(0x11a0)+_0x45f6f7['name']+'”。':_0x1c178a[_0x17217e(0x8e7)]?_0x17217e(0xacb)+_0x424270+'\x27刚刚在你的动态“'+_0x162995+_0x17217e(0x355)+_0x5219d8[_0x17217e(0x1244)]+'\x27的评论，内容是：“'+_0x268a21+'”。':_0x17217e(0xacb)+_0x424270+_0x17217e(0x10fb)+_0x162995+_0x17217e(0x4c6)+_0x268a21+'”。';const _0x2f9d8a={'role':_0x17217e(0x18c),'content':_0x17217e(0x807)+_0x46891f+'请你对此作出回应。]','timestamp':Date[_0x17217e(0xf1a)](),'isHidden':!![]};_0x91fa18[_0x17217e(0x551)]['push'](_0x2f9d8a),await _0x1a6951[_0x17217e(0x667)][_0x17217e(0xc0f)](_0x91fa18);}}_0x83de00[_0x17217e(0x2f4)]='',_0x4bca60(_0x21d1bb),await _0x2d4910(_0x4f5e99);return;}}const _0x13e15a=_0x21add5=>{const _0x280425=_0x54b568,_0x2c88ef=_0x21add5['target'];if(_0x2c88ef[_0x280425(0x53a)]('.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper'))return;const _0x9ca5cb=_0x21add5[_0x280425(0x225)][_0x280425(0x53a)](_0x280425(0xaf8));if(!_0x9ca5cb)return;_0x42b616(_0x9ca5cb),_0x1d368e['activeContainer']=_0x9ca5cb,_0x1d368e['isDragging']=!![],_0x1d368e[_0x280425(0xa69)]=!![],_0x1d368e[_0x280425(0x359)]=null,_0x1d368e[_0x280425(0x1018)]=_0x21add5[_0x280425(0x48c)][_0x280425(0xced)](_0x280425(0x7d5))?_0x21add5[_0x280425(0xe73)]:_0x21add5[_0x280425(0xe9e)][0x0][_0x280425(0xe73)],_0x1d368e['startY']=_0x21add5[_0x280425(0x48c)]['includes'](_0x280425(0x7d5))?_0x21add5[_0x280425(0x5b5)]:_0x21add5[_0x280425(0xe9e)][0x0][_0x280425(0x5b5)],_0x1d368e['activeContainer'][_0x280425(0xd16)]('.qzone-post-item')[_0x280425(0x68e)][_0x280425(0xde0)]=_0x280425(0x10f2),document['addEventListener'](_0x280425(0xf4d),_0x4b6d97),document[_0x280425(0x1193)](_0x280425(0x1dd),_0x348188),document[_0x280425(0x1193)](_0x280425(0xe3f),_0x4b6d97,{'passive':![]}),document[_0x280425(0x1193)](_0x280425(0xc95),_0x348188);},_0x4b6d97=_0x4b2652=>{const _0x1cb66a=_0x54b568;if(!_0x1d368e['isDragging']||!_0x1d368e['activeContainer'])return;const _0x391ed4=_0x4b2652['type'][_0x1cb66a(0xced)](_0x1cb66a(0x7d5))?_0x4b2652['pageX']:_0x4b2652['touches'][0x0]['pageX'],_0x5c5fc3=_0x4b2652[_0x1cb66a(0x48c)]['includes'](_0x1cb66a(0x7d5))?_0x4b2652[_0x1cb66a(0x5b5)]:_0x4b2652[_0x1cb66a(0xe9e)][0x0][_0x1cb66a(0x5b5)],_0x487024=_0x391ed4-_0x1d368e[_0x1cb66a(0x1018)],_0x1d79e1=_0x5c5fc3-_0x1d368e[_0x1cb66a(0xa9f)];_0x1d368e[_0x1cb66a(0xa69)]&&(Math[_0x1cb66a(0xe10)](_0x487024)>0x5||Math[_0x1cb66a(0xe10)](_0x1d79e1)>0x5)&&(_0x1d368e['isClick']=![]);!_0x1d368e['swipeDirection']&&(Math[_0x1cb66a(0xe10)](_0x487024)>Math[_0x1cb66a(0xe10)](_0x1d79e1)?_0x1d368e[_0x1cb66a(0x359)]=_0x1cb66a(0xade):_0x1d368e[_0x1cb66a(0x359)]='vertical');if(_0x1d368e[_0x1cb66a(0x359)]===_0x1cb66a(0xade)){_0x4b2652[_0x1cb66a(0xd06)](),_0x1d368e['currentX']=_0x391ed4;let _0x394f87=Math[_0x1cb66a(0x1169)](0x0,Math[_0x1cb66a(0x88d)](-0x5a,_0x487024));_0x1d368e[_0x1cb66a(0x11d4)][_0x1cb66a(0xd16)]('.qzone-post-item')[_0x1cb66a(0x68e)]['transform']=_0x1cb66a(0xc81)+_0x394f87+'px)';}},_0x348188=_0x425b6f=>{const _0x37f950=_0x54b568;document['removeEventListener'](_0x37f950(0xf4d),_0x4b6d97),document[_0x37f950(0xcbb)](_0x37f950(0x1dd),_0x348188),document[_0x37f950(0xcbb)](_0x37f950(0xe3f),_0x4b6d97),document[_0x37f950(0xcbb)](_0x37f950(0xc95),_0x348188);if(!_0x1d368e[_0x37f950(0xb22)]||!_0x1d368e[_0x37f950(0x11d4)])return;const _0x419fc3=_0x1d368e[_0x37f950(0x11d4)][_0x37f950(0xd16)](_0x37f950(0xcca));_0x419fc3['style']['transition']='transform\x200.3s\x20ease';if(_0x1d368e[_0x37f950(0x359)]==='horizontal'&&!_0x1d368e['isClick']){const _0x211c5a=_0x425b6f[_0x37f950(0x48c)]['includes']('touchend')?_0x425b6f[_0x37f950(0xffb)][0x0][_0x37f950(0xe73)]:_0x425b6f['pageX'],_0x214292=_0x211c5a-_0x1d368e[_0x37f950(0x1018)];_0x214292<-0x28?_0x419fc3[_0x37f950(0x2f1)][_0x37f950(0x569)](_0x37f950(0x8a0)):_0x419fc3['classList']['remove'](_0x37f950(0x8a0));}_0x419fc3[_0x37f950(0x68e)]['transform']='',_0x1d368e['isDragging']=![],_0x1d368e[_0x37f950(0x11d4)]=null,_0x1d368e[_0x37f950(0x359)]=null,_0x1d368e[_0x37f950(0xa69)]=!![];};_0x3e5245[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x4e63b4),_0x3e5245['addEventListener']('mousedown',_0x13e15a),_0x3e5245['addEventListener'](_0x54b568(0x74f),_0x13e15a,{'passive':!![]}),_0x3e5245[_0x54b568(0x1193)]('click',_0x58c78b=>{const _0x4985e6=_0x54b568;_0x58c78b['target']&&_0x58c78b[_0x4985e6(0x225)]['id']===_0x4985e6(0xd7e)&&_0xbf271b();}),document[_0x54b568(0x89d)]('refine-memory-btn-header')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x82fdc7=_0x54b568;_0x5b873d[_0x82fdc7(0xf96)]&&_0xce0120(_0x5b873d[_0x82fdc7(0xf96)]);}),document['getElementById'](_0x54b568(0x9a3))[_0x54b568(0x1193)](_0x54b568(0x76c),_0x2e702d),document[_0x54b568(0x89d)](_0x54b568(0x101f))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x31b3a9),document[_0x54b568(0x89d)](_0x54b568(0x290))['addEventListener']('click',_0x20091f),document['getElementById'](_0x54b568(0x122e))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x4d6dfe=_0x54b568,_0x48b032=document[_0x4d6dfe(0x89d)](_0x4d6dfe(0x1068));_0x48b032[_0x4d6dfe(0xd16)]('p')&&(_0x48b032[_0x4d6dfe(0x1ef)]='');const _0x2f904a=_0x348395();_0x48b032[_0x4d6dfe(0x22f)](_0x2f904a),_0x2f904a['querySelector']('.entry-content-textarea')['focus']();}),document['getElementById']('switch-greeting-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x1c8748),document[_0x54b568(0x89d)](_0x54b568(0x809))[_0x54b568(0x1193)]('click',_0x494aee=>{const _0x1183d0=_0x54b568;_0x494aee[_0x1183d0(0x225)]&&_0x494aee[_0x1183d0(0x225)]['id']===_0x1183d0(0xaf6)&&_0x113155();}),document[_0x54b568(0x89d)](_0x54b568(0x2f7))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x4485ad),document[_0x54b568(0x89d)]('history-back-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x3178c9),document[_0x54b568(0x89d)]('character-profile-modal')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x35f0e6=>{const _0x100a28=_0x54b568;_0x35f0e6['target']['id']===_0x100a28(0x1297)&&_0x35f0e6[_0x100a28(0x225)]['classList']['remove'](_0x100a28(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0x1248))[_0x54b568(0x1193)]('click',_0x13a1f4),document[_0x54b568(0x89d)](_0x54b568(0xe08))[_0x54b568(0x1193)]('click',_0x1268cc),document[_0x54b568(0x89d)]('qzone-back-btn')['addEventListener'](_0x54b568(0x12a5),()=>_0x17a49c(_0x54b568(0x11ac))),document[_0x54b568(0x89d)](_0x54b568(0x10ad))['addEventListener'](_0x54b568(0x12a5),()=>_0x17a49c(_0x54b568(0x11ac)));const _0xe7b313=document[_0x54b568(0x89d)](_0x54b568(0xd2e)),_0x135e56=document[_0x54b568(0x89d)]('favorites-search-clear-btn');_0xe7b313['addEventListener'](_0x54b568(0x104f),()=>{const _0x1b7b26=_0x54b568,_0x2b9155=_0xe7b313[_0x1b7b26(0x2f4)][_0x1b7b26(0xc3a)]()[_0x1b7b26(0x124b)]();_0x135e56[_0x1b7b26(0x68e)][_0x1b7b26(0x126b)]=_0x2b9155?_0x1b7b26(0x1118):'none';if(!_0x2b9155){_0x1ad59f(allFavoriteItems);return;}const _0x16196b=allFavoriteItems[_0x1b7b26(0x3d8)](_0x51af6a=>{const _0x40f571=_0x1b7b26;let _0x360217='',_0x18f635='';if(_0x51af6a[_0x40f571(0x48c)]===_0x40f571(0x8ed)){const _0x37ffee=_0x51af6a[_0x40f571(0x28c)];_0x360217+=(_0x37ffee[_0x40f571(0x957)]||'')+'\x20'+(_0x37ffee[_0x40f571(0x28c)]||'');if(_0x37ffee[_0x40f571(0xc3f)]===_0x40f571(0x116c))_0x18f635=_0x5b873d[_0x40f571(0x5c1)][_0x40f571(0x22a)];else _0x5b873d[_0x40f571(0x667)][_0x37ffee[_0x40f571(0xc3f)]]&&(_0x18f635=_0x5b873d[_0x40f571(0x667)][_0x37ffee['authorId']]['name']);}else{if(_0x51af6a[_0x40f571(0x48c)]==='chat_message'){const _0x308bcb=_0x51af6a[_0x40f571(0x28c)];typeof _0x308bcb[_0x40f571(0x28c)]===_0x40f571(0x1224)&&(_0x360217=_0x308bcb['content']);const _0x49ebd7=_0x5b873d[_0x40f571(0x667)][_0x51af6a[_0x40f571(0x94d)]];_0x49ebd7&&(_0x308bcb[_0x40f571(0xa57)]==='user'?_0x18f635=_0x49ebd7[_0x40f571(0x58c)]?_0x49ebd7[_0x40f571(0xdb9)][_0x40f571(0xc48)]||'我':'我':_0x18f635=_0x49ebd7[_0x40f571(0x58c)]?_0x308bcb[_0x40f571(0xcfc)]:_0x49ebd7['name']);}}return _0x360217['toLowerCase']()[_0x40f571(0xced)](_0x2b9155)||_0x18f635[_0x40f571(0x124b)]()[_0x40f571(0xced)](_0x2b9155);});_0x1ad59f(_0x16196b);}),_0x135e56[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0xc1ae89=_0x54b568;_0xe7b313[_0xc1ae89(0x2f4)]='',_0x135e56[_0xc1ae89(0x68e)][_0xc1ae89(0x126b)]=_0xc1ae89(0x10f2),_0x1ad59f(allFavoriteItems),_0xe7b313[_0xc1ae89(0xbf6)]();}),document[_0x54b568(0x89d)]('selection-favorite-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x543363=_0x54b568;if(_0x2b125e[_0x543363(0x746)]===0x0)return;const _0x977e11=_0x5b873d[_0x543363(0x667)][_0x5b873d[_0x543363(0xf96)]];if(!_0x977e11)return;const _0x57e97b=[],_0x420041=[..._0x2b125e];for(const _0x359b31 of _0x420041){const _0x43d1b8=await _0x1a6951[_0x543363(0x183)]['where'](_0x543363(0xbe0))[_0x543363(0xb17)](_0x359b31)[_0x543363(0x2a6)]();if(!_0x43d1b8){const _0x207ca=_0x977e11[_0x543363(0x551)]['find'](_0x355fd7=>_0x355fd7[_0x543363(0x114e)]===_0x359b31);_0x207ca&&_0x57e97b[_0x543363(0x138c)]({'type':_0x543363(0x8bb),'content':_0x207ca,'chatId':_0x5b873d[_0x543363(0xf96)],'timestamp':Date[_0x543363(0xf1a)](),'originalTimestamp':_0x207ca['timestamp']});}}_0x57e97b[_0x543363(0x7aa)]>0x0?(await _0x1a6951[_0x543363(0x183)][_0x543363(0xe94)](_0x57e97b),allFavoriteItems=await _0x1a6951[_0x543363(0x183)][_0x543363(0x6ed)](_0x543363(0x114e))[_0x543363(0x854)]()[_0x543363(0xc2f)](),await _0x532f76('收藏成功',_0x543363(0xd2b)+_0x57e97b['length']+_0x543363(0xd82))):await _0x532f76('提示',_0x543363(0x10c6)),_0x4ec1fb();});const _0x46b1cb=document[_0x54b568(0x89d)]('favorites-edit-btn'),_0x44248e=document[_0x54b568(0x89d)](_0x54b568(0x12fc)),_0x4510ea=document['getElementById'](_0x54b568(0x160)),_0x389074=document[_0x54b568(0x89d)]('chat-list-bottom-nav'),_0x25dc29=document[_0x54b568(0x89d)](_0x54b568(0x12c5));_0x46b1cb[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0xdf0459=_0x54b568;_0x57e987=!_0x57e987,_0x44248e[_0xdf0459(0x2f1)][_0xdf0459(0x73b)]('selection-mode',_0x57e987),_0x57e987?(_0x46b1cb['textContent']='完成',_0x4510ea[_0xdf0459(0x68e)][_0xdf0459(0x126b)]='block',_0x389074[_0xdf0459(0x68e)][_0xdf0459(0x126b)]=_0xdf0459(0x10f2),_0x25dc29[_0xdf0459(0x68e)]['paddingBottom']=_0xdf0459(0x6b3)):(_0x46b1cb[_0xdf0459(0xf12)]='编辑',_0x4510ea[_0xdf0459(0x68e)]['display']='none',_0x389074[_0xdf0459(0x68e)][_0xdf0459(0x126b)]=_0xdf0459(0x66e),_0x25dc29['style'][_0xdf0459(0x221)]='',_0x397d2b['clear'](),document[_0xdf0459(0x35f)]('.favorite-item-card.selected')[_0xdf0459(0xd9a)](_0x210c93=>_0x210c93[_0xdf0459(0x2f1)]['remove'](_0xdf0459(0x335))),document['getElementById'](_0xdf0459(0x17c))[_0xdf0459(0xf12)]=_0xdf0459(0x4fb));}),document[_0x54b568(0x89d)]('favorites-list')['addEventListener'](_0x54b568(0x12a5),_0x26466b=>{const _0x43db5d=_0x54b568,_0x3bd064=_0x26466b['target'],_0x3eff8f=_0x3bd064[_0x43db5d(0x53a)](_0x43db5d(0x47e));if(_0x3bd064[_0x43db5d(0xb2f)]==='IMG'&&_0x3bd064['dataset']['hiddenText']){const _0x16c6fb=_0x3bd064[_0x43db5d(0xaaf)][_0x43db5d(0x78a)];_0x532f76(_0x43db5d(0x6d9),_0x16c6fb[_0x43db5d(0xfbf)](/<br>/g,'\x0a'));return;}if(!_0x57e987)return;if(!_0x3eff8f)return;const _0xc5402c=parseInt(_0x3eff8f[_0x43db5d(0xaaf)][_0x43db5d(0x980)]);if(isNaN(_0xc5402c))return;_0x397d2b[_0x43db5d(0xa14)](_0xc5402c)?(_0x397d2b[_0x43db5d(0x684)](_0xc5402c),_0x3eff8f[_0x43db5d(0x2f1)]['remove']('selected')):(_0x397d2b['add'](_0xc5402c),_0x3eff8f['classList'][_0x43db5d(0x569)](_0x43db5d(0x335))),document['getElementById'](_0x43db5d(0x17c))[_0x43db5d(0xf12)]='删除\x20('+_0x397d2b[_0x43db5d(0x746)]+')';}),document['getElementById'](_0x54b568(0x17c))['addEventListener'](_0x54b568(0x12a5),async()=>{const _0x2e81aa=_0x54b568;if(_0x397d2b[_0x2e81aa(0x746)]===0x0)return;const _0x46d1ea=await _0x4e2abc(_0x2e81aa(0x3da),_0x2e81aa(0x113f)+_0x397d2b[_0x2e81aa(0x746)]+_0x2e81aa(0xa84),{'confirmButtonClass':_0x2e81aa(0xcd8)});if(_0x46d1ea){const _0x4ea81b=[..._0x397d2b];await _0x1a6951[_0x2e81aa(0x183)][_0x2e81aa(0x6a7)](_0x4ea81b),await _0x532f76('删除成功',_0x2e81aa(0x138a)),allFavoriteItems=allFavoriteItems[_0x2e81aa(0x3d8)](_0x407765=>!_0x4ea81b['includes'](_0x407765['id'])),_0x1ad59f(allFavoriteItems),_0x46b1cb[_0x2e81aa(0x12a5)]();}});_0x5b873d[_0x54b568(0x21a)][_0x54b568(0xa61)]&&(_0x2eecae(),console[_0x54b568(0x471)](_0x54b568(0x10bc)));document[_0x54b568(0x35f)](_0x54b568(0xd4a))[_0x54b568(0xd9a)](_0x561f13=>{const _0x3a86d1=_0x54b568;_0x561f13['addEventListener'](_0x3a86d1(0x76c),_0x540a41);});const _0x180a4b=document[_0x54b568(0x89d)]('font-size-slider');_0x180a4b[_0x54b568(0x1193)](_0x54b568(0x104f),()=>{const _0x41ed7a=_0x54b568;document[_0x41ed7a(0x89d)](_0x41ed7a(0xa90))[_0x41ed7a(0xf12)]=_0x180a4b[_0x41ed7a(0x2f4)]+'px',_0x540a41();});const _0x182d0e=document[_0x54b568(0x89d)](_0x54b568(0xf37));_0x182d0e['addEventListener'](_0x54b568(0x104f),_0x540a41),document[_0x54b568(0x89d)](_0x54b568(0xebe))[_0x54b568(0x1193)]('click',()=>{const _0x9a3b26=_0x54b568;document[_0x9a3b26(0x89d)](_0x9a3b26(0x48b))[_0x9a3b26(0x1b0)]=!![],_0x540a41();}),document[_0x54b568(0x89d)]('reset-custom-css-btn')[_0x54b568(0x1193)]('click',()=>{const _0x2d79b2=_0x54b568;document[_0x2d79b2(0x89d)](_0x2d79b2(0xf37))['value']='',_0x540a41();}),document[_0x54b568(0x89d)]('lyrics-vertical-pos')[_0x54b568(0x1193)]('change',_0x540a41),document[_0x54b568(0x89d)](_0x54b568(0xe99))[_0x54b568(0x1193)]('change',_0x540a41),document['getElementById']('lyrics-offset-input')[_0x54b568(0x1193)]('input',_0x540a41),document[_0x54b568(0x35f)]('input[name=\x22visibility\x22]')[_0x54b568(0xd9a)](_0x3de585=>{const _0x4ce0cd=_0x54b568;_0x3de585[_0x4ce0cd(0x1193)](_0x4ce0cd(0x76c),function(){const _0x2ffea6=_0x4ce0cd,_0x36a98f=document[_0x2ffea6(0x89d)](_0x2ffea6(0x29d));this[_0x2ffea6(0x2f4)]==='include'||this[_0x2ffea6(0x2f4)]===_0x2ffea6(0xe35)?_0x36a98f['style'][_0x2ffea6(0x126b)]=_0x2ffea6(0x1118):_0x36a98f[_0x2ffea6(0x68e)][_0x2ffea6(0x126b)]='none';});}),document[_0x54b568(0x89d)](_0x54b568(0xd41))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0xd3fe66),document[_0x54b568(0x89d)](_0x54b568(0xe47))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x4a9aa3=_0x54b568;document[_0x4a9aa3(0x89d)](_0x4a9aa3(0x1a0))[_0x4a9aa3(0x2f1)]['remove'](_0x4a9aa3(0x11e4));const _0x445506=document[_0x4a9aa3(0x89d)](_0x4a9aa3(0x1303));document[_0x4a9aa3(0x89d)](_0x4a9aa3(0x522))[_0x4a9aa3(0x2f1)][_0x4a9aa3(0x3ff)]('visible')&&_0x445506[_0x4a9aa3(0x12a5)]();}),document[_0x54b568(0x89d)](_0x54b568(0xa9d))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x58e920),document['getElementById'](_0x54b568(0x3ec))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x2f8848=>{const _0x4dcd5e=_0x54b568;if(_0x2f8848[_0x4dcd5e(0x225)][_0x4dcd5e(0x2f1)][_0x4dcd5e(0x3ff)](_0x4dcd5e(0x126d))){const _0x42f9ef=parseInt(_0x2f8848[_0x4dcd5e(0x225)][_0x4dcd5e(0xaaf)]['id']);_0x440cb8(_0x42f9ef);}}),document['getElementById'](_0x54b568(0x3ae))['addEventListener'](_0x54b568(0x12a5),_0x5348af),document[_0x54b568(0x89d)](_0x54b568(0xa02))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x1c739d),document['getElementById']('copy-message-btn')[_0x54b568(0x1193)]('click',_0x502654),document[_0x54b568(0x89d)](_0x54b568(0x121c))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x4fa558),document[_0x54b568(0x89d)](_0x54b568(0x130f))[_0x54b568(0x1193)]('click',()=>{const _0x437aa7=_0x1cefba;_0x5348af(),_0x437aa7&&_0x3bf0ee(_0x437aa7);}),document[_0x54b568(0x89d)](_0x54b568(0x116e))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x330dcb=>{const _0x5e2287=_0x54b568,_0x1ee1d3=_0x330dcb[_0x5e2287(0x225)][_0x5e2287(0x53a)]('.message-bubble');if(!_0x1ee1d3)return;if(_0x1ee1d3[_0x5e2287(0x2f1)][_0x5e2287(0x3ff)]('ai')&&_0x1ee1d3[_0x5e2287(0x2f1)][_0x5e2287(0x3ff)](_0x5e2287(0x36a))&&_0x1ee1d3[_0x5e2287(0xaaf)]['status']==='pending'){const _0x54790f=parseInt(_0x1ee1d3[_0x5e2287(0xaaf)]['timestamp']);!isNaN(_0x54790f)&&_0x4c3bea(_0x54790f);}}),document[_0x54b568(0x89d)](_0x54b568(0xdbd))[_0x54b568(0x1193)]('click',()=>_0x477dc9('accepted')),document['getElementById'](_0x54b568(0xe33))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>_0x477dc9(_0x54b568(0xc0e))),document['getElementById']('transfer-action-cancel')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x5a2370),document['getElementById'](_0x54b568(0x336))['addEventListener'](_0x54b568(0x12a5),_0x4243dc),document[_0x54b568(0x89d)](_0x54b568(0x4d9))[_0x54b568(0x1193)]('click',_0x57ff2c),document['getElementById'](_0x54b568(0x1281))[_0x54b568(0x1193)]('click',_0x16ef3c),document[_0x54b568(0x89d)](_0x54b568(0xb4c))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{_0x4e6c15('chat-list-screen');}),document['getElementById'](_0x54b568(0x9c4))[_0x54b568(0x1193)]('click',_0x3415d3=>{const _0x550469=_0x54b568,_0x84d250=_0x3415d3[_0x550469(0x225)][_0x550469(0x53a)](_0x550469(0x1149));if(!_0x84d250)return;const _0x14cf7c=_0x84d250[_0x550469(0xaaf)][_0x550469(0xd6e)];_0x84d250[_0x550469(0x2f1)]['toggle']('selected'),_0x469765['has'](_0x14cf7c)?_0x469765['delete'](_0x14cf7c):_0x469765[_0x550469(0x569)](_0x14cf7c),_0x453fc3();}),document['getElementById']('manage-members-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{_0x55b8af();}),document[_0x54b568(0x89d)](_0x54b568(0x1025))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x58e742=_0x54b568;_0x4e6c15(_0x58e742(0x87f)),document[_0x58e742(0x89d)](_0x58e742(0x1303))['click']();}),document[_0x54b568(0x89d)](_0x54b568(0x1200))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x1c5332=>{const _0x1ba05d=_0x54b568;_0x1c5332[_0x1ba05d(0x225)][_0x1ba05d(0x2f1)]['contains'](_0x1ba05d(0xb57))&&_0x4dd754(_0x1c5332['target']['dataset'][_0x1ba05d(0x388)]);}),document[_0x54b568(0x89d)](_0x54b568(0xd70))['addEventListener'](_0x54b568(0x12a5),async()=>{const _0x457836=_0x54b568,_0x5ad2ee=document[_0x457836(0x89d)](_0x457836(0x637)),_0x3a7315=_0x5ad2ee[_0x457836(0xf2a)](!![]);_0x5ad2ee[_0x457836(0xb6e)][_0x457836(0xd38)](_0x3a7315,_0x5ad2ee),_0x3a7315[_0x457836(0x1193)](_0x457836(0x12a5),_0x2f3814),await _0x382232();}),document['getElementById'](_0x54b568(0x75e))[_0x54b568(0x1193)]('click',_0x49430b),document[_0x54b568(0x89d)](_0x54b568(0xfe0))[_0x54b568(0x1193)]('click',_0x350e64),document['getElementById'](_0x54b568(0x408))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x350e64),document['getElementById'](_0x54b568(0x5e9))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x308ed3),document[_0x54b568(0x89d)](_0x54b568(0x54f))[_0x54b568(0x1193)]('click',()=>{const _0xda51cf=_0x54b568;_0x333dc7[_0xda51cf(0xba8)]=![],_0x4e6c15(_0xda51cf(0x87f));}),document[_0x54b568(0x89d)]('join-call-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x476866),document[_0x54b568(0x89d)]('decline-call-btn')[_0x54b568(0x1193)]('click',async()=>{const _0x440e52=_0x54b568;_0x48c9d4();const _0x4da91c=_0x5b873d['chats'][_0x333dc7[_0x440e52(0xf96)]];if(!_0x4da91c)return;if(_0x333dc7['isGroupCall']){_0x333dc7[_0x440e52(0xf77)]=![];const _0x340cc5={'role':_0x440e52(0x18c),'content':'[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','timestamp':Date[_0x440e52(0xf1a)](),'isHidden':!![]};_0x4da91c['history']['push'](_0x340cc5),await _0x1a6951[_0x440e52(0x667)][_0x440e52(0xc0f)](_0x4da91c),await _0x2e3505();}else{const _0x2a3663={'role':_0x440e52(0x116c),'content':_0x440e52(0x1150),'timestamp':Date[_0x440e52(0xf1a)]()};_0x4da91c[_0x440e52(0x551)][_0x440e52(0x138c)](_0x2a3663),await _0x1a6951[_0x440e52(0x667)][_0x440e52(0xc0f)](_0x4da91c),_0x4e6c15(_0x440e52(0x87f)),_0x58deee(_0x2a3663,_0x4da91c),_0x2e3505();}_0x333dc7[_0x440e52(0xba8)]=![];}),document[_0x54b568(0x89d)](_0x54b568(0xa10))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x264c0=_0x54b568;_0x48c9d4(),_0x333dc7[_0x264c0(0x12b5)]='ai',_0x333dc7[_0x264c0(0xf77)]=!![],_0x333dc7[_0x264c0(0xf96)]=_0x5b873d[_0x264c0(0xf96)];if(_0x333dc7['isGroupCall']){const _0x5a5759=_0x5b873d[_0x264c0(0x667)][_0x333dc7[_0x264c0(0xf96)]],_0x5b63ac=_0x5a5759[_0x264c0(0x5ab)][_0x264c0(0x12f4)](_0x444a6a=>_0x444a6a[_0x264c0(0xf74)]===_0x333dc7[_0x264c0(0x7a1)]);_0x5b63ac?_0x333dc7[_0x264c0(0x394)]=[_0x5b63ac]:_0x333dc7[_0x264c0(0x394)]=[];}_0x11ad56();}),document[_0x54b568(0x89d)](_0x54b568(0x66b))['addEventListener']('click',async()=>{const _0x3531e3=_0x54b568;if(!_0x333dc7[_0x3531e3(0xfcb)])return;const _0x485e89=document['querySelector'](_0x3531e3(0xe02));_0x485e89&&_0x485e89[_0x3531e3(0x2f1)][_0x3531e3(0x569)](_0x3531e3(0x8eb));const _0x47dfa9=await _0x34d246('你说','请输入你想说的话...');_0x485e89&&_0x485e89['classList']['remove'](_0x3531e3(0x8eb)),_0x47dfa9&&_0x47dfa9[_0x3531e3(0xc3a)]()&&_0x2c1fe5(_0x47dfa9[_0x3531e3(0xc3a)]());}),document[_0x54b568(0xd16)]('.nav-item[data-view=\x22memories-view\x22]')['addEventListener']('click',()=>{const _0x186dca=_0x54b568;_0x57e987&&document[_0x186dca(0x89d)](_0x186dca(0x466))[_0x186dca(0x12a5)](),_0x17a49c(_0x186dca(0x340)),_0xa1c3d1();}),document[_0x54b568(0x89d)]('memories-back-btn')[_0x54b568(0x1193)]('click',()=>_0x17a49c(_0x54b568(0x11ac))),document[_0x54b568(0x89d)](_0x54b568(0x129d))['addEventListener'](_0x54b568(0x12a5),async()=>{const _0x3caef0=_0x54b568,_0x9bd368=document[_0x3caef0(0x89d)]('countdown-title-input')[_0x3caef0(0x2f4)][_0x3caef0(0xc3a)](),_0x6d64f6=document[_0x3caef0(0x89d)](_0x3caef0(0x585))['value'];if(!_0x9bd368||!_0x6d64f6){alert(_0x3caef0(0x5e0));return;}const _0x194f6f=new Date(_0x6d64f6);if(isNaN(_0x194f6f)||_0x194f6f<=new Date()){alert(_0x3caef0(0xad9));return;}const _0x3fa49a={'authorId':'user','description':_0x9bd368,'timestamp':Date[_0x3caef0(0xf1a)](),'type':_0x3caef0(0x6d8),'targetDate':_0x194f6f['getTime']()};await _0x1a6951[_0x3caef0(0x19e)]['add'](_0x3fa49a),document['getElementById'](_0x3caef0(0x7c8))['classList'][_0x3caef0(0x1247)]('visible'),_0xa1c3d1();}),document[_0x54b568(0x89d)](_0x54b568(0xa21))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x4e776e=_0x54b568;if(!_0x5b873d[_0x4e776e(0xf96)]||_0x5b873d[_0x4e776e(0x667)][_0x5b873d[_0x4e776e(0xf96)]][_0x4e776e(0x58c)])return;const _0x331b39=_0x5b873d[_0x4e776e(0x667)][_0x5b873d['activeChatId']],_0x531169=await _0x4e2abc(_0x4e776e(0xb9c),_0x4e776e(0x114d)+_0x331b39[_0x4e776e(0xf74)]+_0x4e776e(0x405),{'confirmButtonClass':_0x4e776e(0xcd8)});if(_0x531169){_0x331b39[_0x4e776e(0x1383)][_0x4e776e(0x632)]=_0x4e776e(0x4c8),_0x331b39[_0x4e776e(0x1383)][_0x4e776e(0x315)]=Date[_0x4e776e(0xf1a)]();const _0x21dd63={'role':'system','content':_0x4e776e(0x929),'timestamp':Date[_0x4e776e(0xf1a)]()+0x1,'isHidden':!![]};_0x331b39[_0x4e776e(0x551)][_0x4e776e(0x138c)](_0x21dd63),await _0x1a6951[_0x4e776e(0x667)][_0x4e776e(0xc0f)](_0x331b39),document[_0x4e776e(0x89d)](_0x4e776e(0x522))[_0x4e776e(0x2f1)]['remove'](_0x4e776e(0x11e4)),_0x5b89df(_0x5b873d[_0x4e776e(0xf96)]),_0x413d78();}}),document[_0x54b568(0x89d)](_0x54b568(0x337))['addEventListener'](_0x54b568(0x12a5),async _0x374cf6=>{const _0x262cc6=_0x54b568,_0x452214=_0x5b873d[_0x262cc6(0x667)][_0x5b873d[_0x262cc6(0xf96)]];if(!_0x452214)return;if(_0x374cf6['target']['id']==='force-apply-check-btn'){alert(_0x262cc6(0x804)),await _0x53ef51(_0x452214['id']),_0x5b89df(_0x452214['id']);return;}if(_0x374cf6['target']['id']===_0x262cc6(0xe66)){_0x452214[_0x262cc6(0x1383)][_0x262cc6(0x632)]=_0x262cc6(0x123a),_0x452214[_0x262cc6(0x1383)][_0x262cc6(0x315)]=null;const _0x16e6ef={'role':_0x262cc6(0x18c),'content':_0x262cc6(0x5d6),'timestamp':Date[_0x262cc6(0xf1a)](),'isHidden':!![]};_0x452214[_0x262cc6(0x551)][_0x262cc6(0x138c)](_0x16e6ef),await _0x1a6951['chats'][_0x262cc6(0xc0f)](_0x452214),_0x5b89df(_0x452214['id']),_0x413d78(),_0x2e3505();}else{if(_0x374cf6[_0x262cc6(0x225)]['id']==='accept-friend-btn'){_0x452214[_0x262cc6(0x1383)][_0x262cc6(0x632)]='friend',_0x452214['relationship'][_0x262cc6(0x1240)]='';const _0xb9ca88={'role':_0x262cc6(0x18c),'type':_0x262cc6(0xc7a),'content':'你通过了“'+_0x452214['name']+_0x262cc6(0xd29),'timestamp':Date[_0x262cc6(0xf1a)]()};_0x452214['history'][_0x262cc6(0x138c)](_0xb9ca88);const _0x4cc546={'role':_0x262cc6(0x1377),'senderName':_0x452214['name'],'content':_0x262cc6(0x691),'timestamp':Date[_0x262cc6(0xf1a)]()+0x1};_0x452214[_0x262cc6(0x551)][_0x262cc6(0x138c)](_0x4cc546),await _0x1a6951[_0x262cc6(0x667)]['put'](_0x452214),_0x5b89df(_0x452214['id']),_0x413d78();}else{if(_0x374cf6[_0x262cc6(0x225)]['id']==='reject-friend-btn')_0x452214[_0x262cc6(0x1383)][_0x262cc6(0x632)]=_0x262cc6(0x4c8),_0x452214[_0x262cc6(0x1383)][_0x262cc6(0x315)]=Date[_0x262cc6(0xf1a)](),_0x452214[_0x262cc6(0x1383)][_0x262cc6(0x1240)]='',await _0x1a6951['chats'][_0x262cc6(0xc0f)](_0x452214),_0x5b89df(_0x452214['id']);else{if(_0x374cf6[_0x262cc6(0x225)]['id']===_0x262cc6(0x2a0)){const _0x30d0a1=await _0x34d246(_0x262cc6(0xf63),_0x262cc6(0xb9b)+_0x452214['name']+_0x262cc6(0xa54),_0x262cc6(0x11ef));_0x30d0a1!==null&&(_0x452214[_0x262cc6(0x1383)][_0x262cc6(0x632)]=_0x262cc6(0x12d2),_0x452214[_0x262cc6(0x1383)][_0x262cc6(0x1240)]=_0x30d0a1,await _0x1a6951['chats'][_0x262cc6(0xc0f)](_0x452214),_0x5b89df(_0x452214['id']),_0x413d78(),_0x2e3505());}}}}}),document[_0x54b568(0x89d)](_0x54b568(0x7ab))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0xcefb8b),document[_0x54b568(0x89d)](_0x54b568(0xa38))[_0x54b568(0x1193)]('click',()=>{const _0x278a31=_0x54b568;document[_0x278a31(0x89d)](_0x278a31(0xaca))['classList'][_0x278a31(0x1247)]('visible');}),document['getElementById']('send-group-packet-btn')[_0x54b568(0x1193)]('click',_0x3ddd65),document[_0x54b568(0x89d)](_0x54b568(0xaa8))[_0x54b568(0x1193)]('click',_0x55c90b);const _0x594f97=document['getElementById'](_0x54b568(0xb69)),_0x4562a9=document['getElementById'](_0x54b568(0x7d1)),_0x5569e0=document[_0x54b568(0x89d)](_0x54b568(0x89b)),_0x5543b9=document[_0x54b568(0x89d)](_0x54b568(0x816));_0x594f97[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x39b07d=_0x54b568;_0x594f97[_0x39b07d(0x2f1)]['add'](_0x39b07d(0x8ea)),_0x4562a9['classList'][_0x39b07d(0x1247)](_0x39b07d(0x8ea)),_0x5569e0[_0x39b07d(0x68e)][_0x39b07d(0x126b)]=_0x39b07d(0x1118),_0x5543b9[_0x39b07d(0x68e)][_0x39b07d(0x126b)]=_0x39b07d(0x10f2);}),_0x4562a9[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x16ce7b=_0x54b568;_0x4562a9[_0x16ce7b(0x2f1)][_0x16ce7b(0x569)](_0x16ce7b(0x8ea)),_0x594f97[_0x16ce7b(0x2f1)][_0x16ce7b(0x1247)](_0x16ce7b(0x8ea)),_0x5543b9[_0x16ce7b(0x68e)][_0x16ce7b(0x126b)]=_0x16ce7b(0x1118),_0x5569e0['style'][_0x16ce7b(0x126b)]='none';}),document['getElementById']('rp-group-amount')[_0x54b568(0x1193)](_0x54b568(0x104f),_0x1a3bd2=>{const _0x212574=_0x54b568,_0x5bd2ca=parseFloat(_0x1a3bd2[_0x212574(0x225)][_0x212574(0x2f4)])||0x0;document[_0x212574(0x89d)](_0x212574(0xa32))[_0x212574(0xf12)]='¥\x20'+_0x5bd2ca['toFixed'](0x2);}),document['getElementById'](_0x54b568(0x52f))[_0x54b568(0x1193)](_0x54b568(0x104f),_0x7c7043=>{const _0xde2805=_0x54b568,_0x331ac7=parseFloat(_0x7c7043[_0xde2805(0x225)][_0xde2805(0x2f4)])||0x0;document[_0xde2805(0x89d)](_0xde2805(0xc6a))[_0xde2805(0xf12)]='¥\x20'+_0x331ac7[_0xde2805(0x8f7)](0x2);}),document[_0x54b568(0x89d)](_0x54b568(0x116e))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x10df48=>{const _0x497efc=_0x54b568,_0x360205=_0x10df48[_0x497efc(0x225)]['closest']('.red-packet-card');if(!_0x360205)return;const _0x1f8a74=_0x360205[_0x497efc(0x53a)]('.message-bubble');if(!_0x1f8a74||!_0x1f8a74[_0x497efc(0xaaf)][_0x497efc(0x114e)])return;const _0x5c6ab0=parseInt(_0x1f8a74[_0x497efc(0xaaf)]['timestamp']);_0x3d2fbc(_0x5c6ab0);}),document[_0x54b568(0x89d)](_0x54b568(0x9ce))['addEventListener'](_0x54b568(0x12a5),_0x57e37d),document[_0x54b568(0x89d)]('add-poll-option-btn')[_0x54b568(0x1193)]('click',_0x1744ca),document[_0x54b568(0x89d)](_0x54b568(0xa52))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x4a6be8=_0x54b568;document[_0x4a6be8(0x89d)](_0x4a6be8(0xbc9))['classList'][_0x4a6be8(0x1247)](_0x4a6be8(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0xe69))[_0x54b568(0x1193)]('click',_0xa87e11),document[_0x54b568(0x89d)]('chat-messages')[_0x54b568(0x1193)]('click',_0x536fca=>{const _0x218f65=_0x54b568,_0xbe70ff=_0x536fca[_0x218f65(0x225)][_0x218f65(0x53a)]('.poll-card');if(!_0xbe70ff)return;const _0x3c9c0d=parseInt(_0xbe70ff[_0x218f65(0xaaf)][_0x218f65(0x9c2)]);if(isNaN(_0x3c9c0d))return;const _0x1e6720=_0x536fca[_0x218f65(0x225)][_0x218f65(0x53a)](_0x218f65(0x892));if(_0x1e6720&&!_0xbe70ff[_0x218f65(0x2f1)]['contains'](_0x218f65(0x514))){_0x360cbe(_0x3c9c0d,_0x1e6720[_0x218f65(0xaaf)][_0x218f65(0xc39)]);return;}const _0x262ac7=_0x536fca[_0x218f65(0x225)][_0x218f65(0x53a)](_0x218f65(0x296));if(_0x262ac7){_0xbe70ff[_0x218f65(0x2f1)][_0x218f65(0x3ff)](_0x218f65(0x514))?_0x3f862b(_0x3c9c0d):_0x5a32ad(_0x3c9c0d);return;}_0xbe70ff[_0x218f65(0x2f1)][_0x218f65(0x3ff)](_0x218f65(0x514))&&_0x3f862b(_0x3c9c0d);}),document['getElementById'](_0x54b568(0xd24))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x20bcc0),document['getElementById']('add-ai-avatar-batch-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>_0x1ef92f('ai')),document[_0x54b568(0x89d)](_0x54b568(0x4a7))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>_0x1ef92f(_0x54b568(0x39f))),document[_0x54b568(0x89d)](_0x54b568(0xb35))['addEventListener'](_0x54b568(0x12a5),_0xf65337),document[_0x54b568(0x89d)](_0x54b568(0x53e))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x39444c=_0x54b568;document[_0x39444c(0x89d)](_0x39444c(0x729))[_0x39444c(0x12a5)]();}),document[_0x54b568(0x89d)]('ai-avatar-upload-input')[_0x54b568(0x1193)](_0x54b568(0x76c),_0x1abb11),document[_0x54b568(0x89d)](_0x54b568(0x11fc))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0xba1279),document[_0x54b568(0x89d)](_0x54b568(0xa4d))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x317636),document[_0x54b568(0x89d)](_0x54b568(0x7f8))[_0x54b568(0x1193)]('click',_0x4fda4a),document[_0x54b568(0x89d)]('add-group-avatar-upload-btn')['addEventListener'](_0x54b568(0x12a5),()=>{const _0x58c4ec=_0x54b568;document[_0x58c4ec(0x89d)]('group-avatar-upload-input')[_0x58c4ec(0x12a5)]();}),document[_0x54b568(0x89d)](_0x54b568(0x1230))[_0x54b568(0x1193)](_0x54b568(0x76c),_0x2e779c),document[_0x54b568(0x89d)](_0x54b568(0xafe))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x4eff60),document[_0x54b568(0x89d)](_0x54b568(0xd89))[_0x54b568(0x1193)]('click',_0x154252=>{const _0x5980a3=_0x54b568;if(_0x154252['target']['classList'][_0x5980a3(0x3ff)](_0x5980a3(0xc84))){const _0x1d93c9=_0x154252[_0x5980a3(0x225)][_0x5980a3(0x53a)](_0x5980a3(0x5e3)),_0x43de0f=_0x1d93c9['dataset'][_0x5980a3(0x1d9)];_0x43de0f&&_0x5627c5(_0x43de0f,_0x5980a3(0x1024),_0x1d93c9);}}),document[_0x54b568(0x89d)](_0x54b568(0x116e))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x234a0a=>{const _0x4c7e85=_0x54b568,_0x52e79f=_0x234a0a[_0x4c7e85(0x225)][_0x4c7e85(0x53a)](_0x4c7e85(0x493));if(_0x52e79f){const _0x3643f2=parseInt(_0x52e79f['dataset'][_0x4c7e85(0x114e)]);!isNaN(_0x3643f2)&&_0x16e66e(_0x3643f2);}}),document[_0x54b568(0x89d)](_0x54b568(0x10b5))[_0x54b568(0x1193)]('click',()=>{const _0x215957=_0x54b568;_0x4e6c15(_0x215957(0x87f));}),_0x40df96[_0x54b568(0x612)][_0x54b568(0x1193)](_0x54b568(0x12a5),async _0x44a7a8=>{const _0x40b029=_0x54b568,_0x4de2c2=_0x44a7a8[_0x40b029(0x225)][_0x40b029(0x53a)](_0x40b029(0xbfd));if(_0x4de2c2&&_0x40df96[_0x40b029(0x1337)]!==null){const _0x631ed0=_0x4de2c2[_0x40b029(0x68e)][_0x40b029(0x1d4)][_0x40b029(0xdd0)](0x5,-0x2),_0x313cac=_0x5b873d['userStickers'][_0x40b029(0x12f4)](_0x165043=>_0x165043[_0x40b029(0x11de)]===_0x631ed0);_0x313cac?await _0xb65ee4(_0x40df96['activePostId'],_0x313cac):console[_0x40b029(0xac3)](_0x40b029(0x490),_0x631ed0);}}),document[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x3a356b=>{const _0x25ab87=_0x54b568;_0x40df96[_0x25ab87(0xafa)]&&!_0x40df96['panelEl']['contains'](_0x3a356b[_0x25ab87(0x225)])&&!_0x3a356b[_0x25ab87(0x225)][_0x25ab87(0x53a)]('.comment-sticker-btn')&&_0x175ea0();}),document['getElementById'](_0x54b568(0x1a2))['addEventListener'](_0x54b568(0x12a5),_0x463ec2),document['getElementById']('cancel-share-link-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0xf9e022=_0x54b568;document[_0xf9e022(0x89d)](_0xf9e022(0x431))[_0xf9e022(0x2f1)]['remove']('visible');}),document['getElementById']('confirm-share-link-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x939b11),document[_0x54b568(0x89d)](_0x54b568(0xa34))[_0x54b568(0x1193)]('change',_0x4a76dc),document[_0x54b568(0x89d)](_0x54b568(0x733))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x998a83),document[_0x54b568(0x89d)](_0x54b568(0x1167))[_0x54b568(0x1193)]('click',_0xc6b8c),document[_0x54b568(0x89d)]('call-history-back-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x408407=_0x54b568;_0x4e6c15(_0x408407(0x11b7));}),document[_0x54b568(0x89d)]('call-history-list')['addEventListener'](_0x54b568(0x12a5),_0x5e66b9=>{const _0x4868f9=_0x54b568,_0x4efe3c=_0x5e66b9[_0x4868f9(0x225)][_0x4868f9(0x53a)](_0x4868f9(0x789));_0x4efe3c&&_0x4efe3c['dataset'][_0x4868f9(0x4d3)]&&_0x2446e1(parseInt(_0x4efe3c['dataset'][_0x4868f9(0x4d3)]));}),document[_0x54b568(0x89d)]('close-call-transcript-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x5210c3=_0x54b568;document['getElementById'](_0x5210c3(0x72a))[_0x5210c3(0x2f1)][_0x5210c3(0x1247)](_0x5210c3(0x11e4));}),document[_0x54b568(0x89d)]('chat-header-status')[_0x54b568(0x1193)]('click',_0xcbb571),document['getElementById'](_0x54b568(0x499))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{_0x2b125e['size']>0x0&&_0xeae11b();}),document[_0x54b568(0x89d)](_0x54b568(0x1317))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x9deaed),document['getElementById']('confirm-share-target-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x263267=_0x54b568,_0xb3d1e2=_0x5b873d[_0x263267(0x667)][_0x5b873d['activeChatId']],_0x2f8077=Array[_0x263267(0x321)](document[_0x263267(0x35f)](_0x263267(0xa5a)))[_0x263267(0x412)](_0x79f319=>_0x79f319[_0x263267(0xaaf)][_0x263267(0x94d)]);if(_0x2f8077[_0x263267(0x7aa)]===0x0){alert('请至少选择一个要分享的聊天。');return;}const _0x3fc133=[],_0x211bc8=[..._0x2b125e][_0x263267(0x2e3)]((_0x566cc7,_0x1b4055)=>_0x566cc7-_0x1b4055);for(const _0x5ab763 of _0x211bc8){const _0x4a6a0a=_0xb3d1e2[_0x263267(0x551)][_0x263267(0x12f4)](_0x230cfd=>_0x230cfd[_0x263267(0x114e)]===_0x5ab763);_0x4a6a0a&&_0x3fc133[_0x263267(0x138c)](_0x4a6a0a);}const _0x3d5c98={'role':_0x263267(0x116c),'senderName':_0xb3d1e2[_0x263267(0x58c)]?_0xb3d1e2[_0x263267(0xdb9)][_0x263267(0xc48)]||'我':'我','type':'share_card','timestamp':Date[_0x263267(0xf1a)](),'payload':{'sourceChatName':_0xb3d1e2[_0x263267(0xf74)],'title':_0x263267(0x97e)+_0xb3d1e2[_0x263267(0xf74)]+_0x263267(0x4b1),'sharedHistory':_0x3fc133}};for(const _0x4e18f8 of _0x2f8077){const _0x12415f=_0x5b873d['chats'][_0x4e18f8];_0x12415f&&(_0x12415f['history'][_0x263267(0x138c)](_0x3d5c98),await _0x1a6951[_0x263267(0x667)]['put'](_0x12415f));}document[_0x263267(0x89d)]('share-target-modal')[_0x263267(0x2f1)]['remove']('visible'),_0x4ec1fb(),await _0x532f76(_0x263267(0x434),'聊天记录已成功分享到\x20'+_0x2f8077['length']+'\x20个会话中。'),_0x413d78();}),document[_0x54b568(0x89d)]('cancel-share-target-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x2fa619=_0x54b568;document[_0x2fa619(0x89d)](_0x2fa619(0x1191))['classList'][_0x2fa619(0x1247)]('visible');}),document[_0x54b568(0x89d)](_0x54b568(0x116e))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x33379f=>{const _0x3d304f=_0x54b568,_0x1e5f89=_0x33379f[_0x3d304f(0x225)][_0x3d304f(0x53a)](_0x3d304f(0xd8b));if(_0x1e5f89&&_0x1e5f89[_0x3d304f(0x53a)](_0x3d304f(0x605))){const _0x1bdbe0=parseInt(_0x1e5f89[_0x3d304f(0xaaf)][_0x3d304f(0x114e)]);_0x48f0ef(_0x1bdbe0);}}),document[_0x54b568(0x89d)](_0x54b568(0x730))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x3538f7=_0x54b568;document[_0x3538f7(0x89d)](_0x3538f7(0x503))[_0x3538f7(0x2f1)]['remove'](_0x3538f7(0x11e4));});async function _0x48f0ef(_0x3c7ed2){const _0x212aa0=_0x54b568,_0x11f143=_0x5b873d[_0x212aa0(0x667)][_0x5b873d[_0x212aa0(0xf96)]],_0x5d4ced=_0x11f143[_0x212aa0(0x551)][_0x212aa0(0x12f4)](_0x152ac8=>_0x152ac8['timestamp']===_0x3c7ed2);if(!_0x5d4ced||_0x5d4ced[_0x212aa0(0x48c)]!==_0x212aa0(0x1105)||!_0x5d4ced[_0x212aa0(0xe04)]){console[_0x212aa0(0x1fd)]('无法找到或消息类型/内容不匹配的分享记录:',_0x3c7ed2),await _0x532f76(_0x212aa0(0xeba),_0x212aa0(0x737));return;}const _0x287972=document[_0x212aa0(0x89d)]('shared-history-viewer-modal'),_0x13befa=document['getElementById'](_0x212aa0(0x47d)),_0x5d4c93=document[_0x212aa0(0x89d)](_0x212aa0(0x7cf));_0x13befa['textContent']=_0x5d4ced[_0x212aa0(0xe04)]['title'],_0x5d4c93[_0x212aa0(0x1ef)]='';const _0x5f44f9=document[_0x212aa0(0xfc9)](),_0x1528c3=Object[_0x212aa0(0x4b5)](_0x5b873d[_0x212aa0(0x667)])[_0x212aa0(0x12f4)](_0x5b708e=>_0x5b708e[_0x212aa0(0xf74)]===_0x5d4ced[_0x212aa0(0xe04)][_0x212aa0(0x4eb)])||_0x11f143;for(const _0x45e6f9 of _0x5d4ced[_0x212aa0(0xe04)][_0x212aa0(0x55e)]){const _0x2685da=await _0x1ed144(_0x45e6f9,_0x1528c3);_0x2685da&&_0x5f44f9[_0x212aa0(0x22f)](_0x2685da);}_0x5d4c93[_0x212aa0(0x22f)](_0x5f44f9),_0x287972[_0x212aa0(0x2f1)][_0x212aa0(0x569)](_0x212aa0(0x11e4));}_0x1e10c1[_0x54b568(0x1193)](_0x54b568(0x10ee),_0x4d0c38),_0x1e10c1[_0x54b568(0x1193)](_0x54b568(0xfb2),()=>{const _0x45464c=_0x54b568;_0x1f2ed8[_0x45464c(0xfcb)]&&(_0x1f2ed8[_0x45464c(0xaa4)]=![],_0x2f3a2e());}),_0x1e10c1['addEventListener'](_0x54b568(0x5ad),()=>{const _0x2b5e90=_0x54b568;_0x1f2ed8[_0x2b5e90(0xfcb)]&&(_0x1f2ed8[_0x2b5e90(0xaa4)]=!![],_0x2f3a2e());}),document[_0x54b568(0x89d)]('playlist-body')[_0x54b568(0x1193)]('click',async _0x47ef73=>{const _0x505f84=_0x54b568,_0x3e24bf=_0x47ef73[_0x505f84(0x225)],_0x512702=_0x3e24bf[_0x505f84(0x53a)](_0x505f84(0xc13));if(_0x512702){const _0x272957=parseInt(_0x512702['dataset'][_0x505f84(0xa9b)]);!isNaN(_0x272957)&&await _0x124c87(_0x272957);return;}const _0x10bc61=_0x3e24bf[_0x505f84(0x53a)](_0x505f84(0x771));if(_0x10bc61){const _0x520ca7=parseInt(_0x10bc61[_0x505f84(0xaaf)]['index']);if(isNaN(_0x520ca7))return;await _0x765d9f(_0x520ca7);return;}const _0x107b4b=_0x3e24bf[_0x505f84(0x53a)](_0x505f84(0x3e1));if(_0x107b4b){const _0x4fa079=parseInt(_0x107b4b['dataset']['index']);if(isNaN(_0x4fa079))return;const _0x36f0b3=_0x1f2ed8[_0x505f84(0x2c0)][_0x4fa079],_0x8942f0=await _0x4e2abc(_0x505f84(0xc05),'确定要从播放列表中删除《'+_0x36f0b3[_0x505f84(0xf74)]+_0x505f84(0x80a));_0x8942f0&&_0x141d2c(_0x4fa079);return;}const _0x47df47=_0x3e24bf['closest'](_0x505f84(0x5bd));if(_0x47df47){const _0x569211=_0x47df47[_0x505f84(0x53a)](_0x505f84(0x1127)),_0x357882=Array['from'](_0x569211[_0x505f84(0x182)][_0x505f84(0xb97)])[_0x505f84(0x37c)](_0x569211);_0x357882>-0x1&&_0x1eec83(_0x357882);}}),document[_0x54b568(0xd16)](_0x54b568(0xc62))[_0x54b568(0x1193)]('click',_0xde9a57=>{const _0x419efb=_0x54b568;if(!_0x1e10c1['duration'])return;const _0x3a0d47=_0xde9a57['currentTarget'],_0x3763b1=_0x3a0d47[_0x419efb(0x2fd)],_0x547a28=_0xde9a57[_0x419efb(0xa53)];_0x1e10c1[_0x419efb(0x133c)]=_0x547a28/_0x3763b1*_0x1e10c1[_0x419efb(0x91c)];}),document[_0x54b568(0x89d)](_0x54b568(0x116e))[_0x54b568(0x1193)]('click',_0x28b76b=>{const _0xde69ed=_0x54b568,_0x45aa23=_0x28b76b[_0xde69ed(0x225)][_0xde69ed(0x53a)]('.recalled-message-placeholder');if(_0x45aa23){const _0x37f87a=_0x5b873d[_0xde69ed(0x667)][_0x5b873d[_0xde69ed(0xf96)]],_0x4851cd=_0x45aa23['closest'](_0xde69ed(0x107a));if(_0x37f87a&&_0x4851cd){const _0x48c6a5=parseInt(_0x4851cd['dataset'][_0xde69ed(0x114e)]),_0xe99662=_0x37f87a[_0xde69ed(0x551)][_0xde69ed(0x12f4)](_0x5b7ce3=>_0x5b7ce3[_0xde69ed(0x114e)]===_0x48c6a5);if(_0xe99662&&_0xe99662[_0xde69ed(0xda0)]){let _0x4590b5='';const _0x37a4d7=_0xe99662[_0xde69ed(0xda0)];switch(_0x37a4d7['originalType']){case'text':_0x4590b5=_0xde69ed(0x133d)+_0x37a4d7[_0xde69ed(0x310)]+'\x22';break;case _0xde69ed(0x11f6):case _0xde69ed(0x656):case _0xde69ed(0x574):_0x4590b5=_0xde69ed(0xe81)+_0x37a4d7[_0xde69ed(0x310)]+'\x22';break;case'voice_message':_0x4590b5=_0xde69ed(0x595)+_0x37a4d7['originalContent']+'\x22';break;case _0xde69ed(0x3c8):_0x4590b5='[表情]\x20含义:\x20\x22'+(_0x37a4d7[_0xde69ed(0x606)]||_0xde69ed(0x716))+'\x22\x20\x0a\x20URL:\x20'+_0x37a4d7[_0xde69ed(0x310)];break;case _0xde69ed(0x1075):_0x4590b5=_0xde69ed(0x908);break;default:_0x4590b5=_0xde69ed(0x5fd)+_0x37a4d7[_0xde69ed(0x8d7)]+']类型的消息。\x0a内容:\x20'+JSON[_0xde69ed(0x465)](_0x37a4d7[_0xde69ed(0x310)]);break;}_0x532f76(_0xde69ed(0xa3c),_0x4590b5);}}}}),document[_0x54b568(0x89d)](_0x54b568(0x12f1))['addEventListener'](_0x54b568(0x12a5),_0x2d7414),document[_0x54b568(0x89d)]('close-category-manager-btn')[_0x54b568(0x1193)]('click',()=>{const _0x11a81d=_0x54b568;document['getElementById'](_0x11a81d(0xd1b))[_0x11a81d(0x2f1)]['remove'](_0x11a81d(0x11e4)),_0x317a18();}),document['getElementById'](_0x54b568(0x5e4))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x47670a),document[_0x54b568(0x89d)](_0x54b568(0x1299))[_0x54b568(0x1193)]('click',_0x82e9a4=>{const _0x33aaa7=_0x54b568;if(_0x82e9a4[_0x33aaa7(0x225)][_0x33aaa7(0x2f1)][_0x33aaa7(0x3ff)](_0x33aaa7(0x126d))){const _0xe149f0=parseInt(_0x82e9a4[_0x33aaa7(0x225)]['dataset']['id']);_0x2e91c1(_0xe149f0);}}),document[_0x54b568(0x89d)](_0x54b568(0xfaa))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x21063f),document['getElementById']('repost-confirm-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0xd72845),document[_0x54b568(0x89d)](_0x54b568(0x121b))['addEventListener'](_0x54b568(0x12a5),_0x1a8ff5),document[_0x54b568(0x89d)](_0x54b568(0xccd))[_0x54b568(0x1193)]('click',_0x2c11ff),document[_0x54b568(0x89d)](_0x54b568(0x24c))['addEventListener'](_0x54b568(0x104f),_0x4455a4=>{const _0x1ce218=_0x54b568;if(!_0x4455a4[_0x1ce218(0x225)][_0x1ce218(0x770)](_0x1ce218(0x109a)))return;const _0xd8087b=_0x4455a4[_0x1ce218(0x225)],_0x4455af=_0xd8087b[_0x1ce218(0x53a)](_0x1ce218(0xaf8));if(!_0x4455af)return;const _0x1a8eef=_0x4455af['querySelector'](_0x1ce218(0xf57)),_0x14e6ce=_0xd8087b[_0x1ce218(0x2f4)],_0x1614da=_0x14e6ce[_0x1ce218(0x86c)](/@([\p{L}\w]*)$/u);if(_0x1614da){const _0x24a75a=new Set(),_0x2d52c1=_0x4455af[_0x1ce218(0xd16)](_0x1ce218(0x4f7))?.[_0x1ce218(0xf12)];if(_0x2d52c1)_0x24a75a[_0x1ce218(0x569)](_0x2d52c1);_0x4455af[_0x1ce218(0x35f)]('.commenter-name')[_0x1ce218(0xd9a)](_0xb9cd67=>{const _0x39a58b=_0x1ce218;_0x24a75a[_0x39a58b(0x569)](_0xb9cd67[_0x39a58b(0xf12)]['replace'](':',''));}),_0x24a75a['delete'](_0x5b873d[_0x1ce218(0x5c1)][_0x1ce218(0x22a)]),_0x1a8eef[_0x1ce218(0x1ef)]='';if(_0x24a75a['size']>0x0){const _0x4296e6=_0x1614da[0x1];_0x24a75a[_0x1ce218(0xd9a)](_0x1d577b=>{const _0x3e8ac0=_0x1ce218;if(_0x1d577b[_0x3e8ac0(0x124b)]()[_0x3e8ac0(0xced)](_0x4296e6[_0x3e8ac0(0x124b)]())){const _0x579626=document[_0x3e8ac0(0x285)]('div');_0x579626[_0x3e8ac0(0x81c)]=_0x3e8ac0(0x1058),_0x579626[_0x3e8ac0(0xf12)]=_0x1d577b,_0x579626[_0x3e8ac0(0x1193)](_0x3e8ac0(0x898),_0x46e52f=>{const _0x3bbeee=_0x3e8ac0;_0x46e52f['preventDefault']();const _0x58f22b=_0x14e6ce['substring'](0x0,_0x1614da['index'])+('@'+_0x1d577b+'\x20');_0xd8087b[_0x3bbeee(0x2f4)]=_0x58f22b,_0x1a8eef[_0x3bbeee(0x68e)][_0x3bbeee(0x126b)]='none',_0xd8087b[_0x3bbeee(0xbf6)]();}),_0x1a8eef[_0x3e8ac0(0x22f)](_0x579626);}}),_0x1a8eef['style'][_0x1ce218(0x126b)]=_0x1a8eef[_0x1ce218(0xb97)][_0x1ce218(0x7aa)]>0x0?_0x1ce218(0x1118):_0x1ce218(0x10f2);}else _0x1a8eef[_0x1ce218(0x68e)][_0x1ce218(0x126b)]='none';}else _0x1a8eef[_0x1ce218(0x68e)][_0x1ce218(0x126b)]=_0x1ce218(0x10f2);}),document['getElementById']('qzone-posts-list')[_0x54b568(0x1193)]('focusout',_0xdf6f8e=>{const _0x2ca4c1=_0x54b568;if(_0xdf6f8e[_0x2ca4c1(0x225)][_0x2ca4c1(0x770)](_0x2ca4c1(0x109a))){const _0x116282=_0xdf6f8e['target'][_0x2ca4c1(0x53a)](_0x2ca4c1(0xaf8));if(_0x116282){const _0x276b47=_0x116282[_0x2ca4c1(0xd16)]('.at-mention-popup');_0x276b47&&setTimeout(()=>{const _0x2efd8e=_0x2ca4c1;_0x276b47[_0x2efd8e(0x68e)][_0x2efd8e(0x126b)]=_0x2efd8e(0x10f2);},0xc8);}}});const _0x23ffe3=document[_0x54b568(0x89d)](_0x54b568(0xc6f)),_0x47c48a=document['getElementById'](_0x54b568(0xa7e));_0x23ffe3[_0x54b568(0x1193)](_0x54b568(0x104f),()=>{const _0xbbbac=_0x54b568;if(!_0x5b873d[_0xbbbac(0xf96)]||!_0x5b873d[_0xbbbac(0x667)][_0x5b873d[_0xbbbac(0xf96)]][_0xbbbac(0x58c)]){_0x47c48a[_0xbbbac(0x68e)]['display']=_0xbbbac(0x10f2);return;}const _0x3d1573=_0x5b873d[_0xbbbac(0x667)][_0x5b873d[_0xbbbac(0xf96)]],_0xbdd0e7=_0x23ffe3['value'],_0x3c4698=_0xbdd0e7[_0xbbbac(0x86c)](/@([\p{L}\w]*)$/u);if(_0x3c4698){const _0x41056e=_0x3d1573['settings']['myNickname']||'我',_0x1f9c88=_0x3d1573[_0xbbbac(0x5ab)][_0xbbbac(0x412)](_0x247c74=>_0x247c74[_0xbbbac(0x7da)])[_0xbbbac(0x3d8)](_0x384aff=>_0x384aff!==_0x41056e);_0x47c48a[_0xbbbac(0x1ef)]='';if(_0x1f9c88[_0xbbbac(0x7aa)]>0x0){const _0x3c138e=_0x3c4698[0x1];_0x1f9c88['forEach'](_0x1dafa6=>{const _0x1b2a5c=_0xbbbac;if(_0x1dafa6[_0x1b2a5c(0x124b)]()[_0x1b2a5c(0xced)](_0x3c138e['toLowerCase']())){const _0x1fe119=document[_0x1b2a5c(0x285)](_0x1b2a5c(0xb25));_0x1fe119[_0x1b2a5c(0x81c)]=_0x1b2a5c(0x1058),_0x1fe119['textContent']=_0x1dafa6,_0x1fe119[_0x1b2a5c(0x1193)](_0x1b2a5c(0x898),_0x17c42f=>{const _0x2b054e=_0x1b2a5c;_0x17c42f[_0x2b054e(0xd06)]();const _0x52b0bf=_0xbdd0e7[_0x2b054e(0x489)](0x0,_0x3c4698[_0x2b054e(0xa9b)])+('@'+_0x1dafa6+'\x20');_0x23ffe3[_0x2b054e(0x2f4)]=_0x52b0bf,_0x47c48a[_0x2b054e(0x68e)][_0x2b054e(0x126b)]='none',_0x23ffe3[_0x2b054e(0xbf6)]();}),_0x47c48a[_0x1b2a5c(0x22f)](_0x1fe119);}}),_0x47c48a[_0xbbbac(0x68e)][_0xbbbac(0x126b)]=_0x47c48a[_0xbbbac(0xb97)][_0xbbbac(0x7aa)]>0x0?_0xbbbac(0x1118):_0xbbbac(0x10f2);}else _0x47c48a[_0xbbbac(0x68e)][_0xbbbac(0x126b)]=_0xbbbac(0x10f2);}else _0x47c48a[_0xbbbac(0x68e)][_0xbbbac(0x126b)]=_0xbbbac(0x10f2);}),_0x23ffe3['addEventListener'](_0x54b568(0x5bc),()=>{setTimeout(()=>{const _0x387513=_0x356e;_0x47c48a[_0x387513(0x68e)][_0x387513(0x126b)]='none';},0xc8);}),document[_0x54b568(0x89d)](_0x54b568(0x386))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x3c61b0),document[_0x54b568(0x89d)](_0x54b568(0x7ad))[_0x54b568(0x1193)]('click',_0x187280),document[_0x54b568(0x89d)](_0x54b568(0x128e))[_0x54b568(0x1193)]('click',()=>{const _0x2ff07f=_0x54b568;document[_0x2ff07f(0x89d)](_0x2ff07f(0x621))['classList'][_0x2ff07f(0x1247)](_0x2ff07f(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0x4a5))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x4ef742=>{const _0x1f72f4=_0x54b568;if(_0x4ef742['target'][_0x1f72f4(0x2f1)]['contains']('announcement-item-actions')){const _0x2d9bfa=_0x4ef742[_0x1f72f4(0x225)][_0x1f72f4(0xaaf)][_0x1f72f4(0xe87)];_0x2d9bfa&&_0x53599d(_0x2d9bfa);}}),document['getElementById'](_0x54b568(0x10f3))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x140364),document[_0x54b568(0x89d)](_0x54b568(0x10bd))[_0x54b568(0x1193)]('click',_0x3947fd),document[_0x54b568(0x89d)](_0x54b568(0x3ad))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x5a0b7e=_0x54b568;document['getElementById']('announcement-actions-modal')[_0x5a0b7e(0x2f1)]['remove'](_0x5a0b7e(0x11e4));}),document[_0x54b568(0x89d)]('reset-global-css-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x6003ac=_0x54b568;document[_0x6003ac(0x89d)](_0x6003ac(0xbb4))['value']='';}),document[_0x54b568(0x89d)](_0x54b568(0x60a))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x10e170),document['getElementById'](_0x54b568(0xb9f))['addEventListener'](_0x54b568(0x12a5),()=>{const _0x10a230=_0x54b568;_0x4e6c15(_0x10a230(0x87f));}),document[_0x54b568(0x89d)]('add-manual-memory-btn-header')[_0x54b568(0x1193)]('click',_0x2a9872),document['getElementById'](_0x54b568(0x6a0))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x20365f),document[_0x54b568(0x89d)](_0x54b568(0x60d))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x17269a=>{const _0x721b60=_0x54b568,_0x3795f0=_0x17269a['target'][_0x721b60(0x53a)](_0x721b60(0xc23));if(_0x3795f0){_0x464208(_0x3795f0[_0x721b60(0xaaf)][_0x721b60(0xc3f)],parseInt(_0x3795f0[_0x721b60(0xaaf)][_0x721b60(0x3a9)]));return;}const _0x28c727=_0x17269a['target'][_0x721b60(0x53a)](_0x721b60(0x252));if(_0x28c727){_0x25adb2(_0x28c727[_0x721b60(0xaaf)][_0x721b60(0xc3f)],parseInt(_0x28c727['dataset'][_0x721b60(0x3a9)]));return;}}),document[_0x54b568(0x89d)]('gomoku-btn')['addEventListener']('click',_0x57088d),document[_0x54b568(0x89d)](_0x54b568(0xd99))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x5ce586);const _0x3bbebc=document['getElementById']('gomoku-board');_0x3bbebc[_0x54b568(0x1193)]('mousemove',_0x3d47ac),_0x3bbebc[_0x54b568(0x1193)](_0x54b568(0x186),()=>_0x2c4e2b(_0x5b873d[_0x54b568(0xf96)])),_0x3bbebc['addEventListener'](_0x54b568(0x12a5),_0x2afbd4),document['getElementById'](_0x54b568(0x10e4))[_0x54b568(0x1193)]('click',()=>{const _0x2c1be7=_0x54b568;document[_0x2c1be7(0x89d)](_0x2c1be7(0x3f6))[_0x2c1be7(0x2f4)]='',document[_0x2c1be7(0x89d)](_0x2c1be7(0x585))[_0x2c1be7(0x2f4)]='',document[_0x2c1be7(0x89d)]('create-countdown-modal')[_0x2c1be7(0x2f1)][_0x2c1be7(0x569)](_0x2c1be7(0x11e4));}),document['getElementById'](_0x54b568(0x2c7))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x1452af=_0x54b568;document[_0x1452af(0x89d)]('create-countdown-modal')[_0x1452af(0x2f1)][_0x1452af(0x1247)](_0x1452af(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0x8ba))['addEventListener'](_0x54b568(0x12a5),_0x1669bc),document[_0x54b568(0x89d)](_0x54b568(0x10d7))['addEventListener']('click',_0x3985d8),document[_0x54b568(0x89d)]('cancel-call-message-action-btn')[_0x54b568(0x1193)]('click',_0x320481),document['getElementById'](_0x54b568(0x1231))[_0x54b568(0x1193)]('click',_0xe23b1b),document[_0x54b568(0x89d)](_0x54b568(0x549))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x437e82=_0x54b568;document[_0x437e82(0x89d)](_0x437e82(0x440))[_0x437e82(0x2f1)][_0x437e82(0x1247)](_0x437e82(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0xd22))[_0x54b568(0x1193)]('click',_0x3181f9),document['getElementById'](_0x54b568(0x815))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0xdc1949=_0x54b568,_0x1fe208=document[_0xdc1949(0x89d)](_0xdc1949(0xbda)),_0x28d503=_0x328eb7('{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}');_0x1fe208[_0xdc1949(0x22f)](_0x28d503),_0x28d503[_0xdc1949(0xd16)](_0xdc1949(0x11b9))[_0xdc1949(0xbf6)]();}),document[_0x54b568(0x89d)](_0x54b568(0x12d7))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x46ebd3),document[_0x54b568(0x89d)]('close-my-avatar-library-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x18627c),document[_0x54b568(0x89d)](_0x54b568(0x62f))[_0x54b568(0x1193)]('click',_0x5eb1e5),document[_0x54b568(0x89d)](_0x54b568(0x1eb))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x179357=_0x54b568;document[_0x179357(0x89d)]('my-avatar-upload-input')[_0x179357(0x12a5)]();}),document['getElementById'](_0x54b568(0x113a))[_0x54b568(0x1193)](_0x54b568(0x76c),_0x137803),document[_0x54b568(0x89d)]('add-my-avatar-batch-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x5df798=_0x54b568,_0x2d7325=_0x5df798(0x92e),_0x2fdef7=await _0x34d246(_0x5df798(0x11ba),_0x2d7325,'',_0x5df798(0x11b9));_0x2fdef7&&_0x2fdef7['trim']()&&await _0x3294ef(_0x2fdef7);}),document[_0x54b568(0x89d)](_0x54b568(0x943))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x2bef11),document[_0x54b568(0x89d)]('shopping-back-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>_0x4e6c15('chat-interface-screen')),document[_0x54b568(0x89d)](_0x54b568(0x1287))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x1920c7),document[_0x54b568(0x89d)]('cart-back-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x2bef11),document[_0x54b568(0x89d)]('checkout-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x4c4a5e),document[_0x54b568(0x89d)](_0x54b568(0x944))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x15e500=_0x54b568;document['getElementById']('gift-receipt-modal')[_0x15e500(0x2f1)]['remove'](_0x15e500(0x11e4));}),document['getElementById'](_0x54b568(0xb41))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x201ab1=_0x54b568;_0x5331a4=!_0x5331a4;const _0x11fd20=document['getElementById'](_0x201ab1(0xb41)),_0x543058=document['getElementById']('shopping-action-bar'),_0x11d671=document[_0x201ab1(0x89d)](_0x201ab1(0x6ff));_0x11fd20['style'][_0x201ab1(0x56b)]=_0x5331a4?_0x201ab1(0xa6b):_0x201ab1(0x766),_0x5331a4?(_0x543058[_0x201ab1(0x68e)][_0x201ab1(0x126b)]=_0x201ab1(0x66e),_0x11d671['style'][_0x201ab1(0x221)]=_0x201ab1(0x6b3)):(_0x543058[_0x201ab1(0x68e)]['display']=_0x201ab1(0x10f2),_0x11d671[_0x201ab1(0x68e)][_0x201ab1(0x221)]='',_0x512a2b[_0x201ab1(0x1073)](),document[_0x201ab1(0x35f)](_0x201ab1(0x1ed))[_0x201ab1(0xd9a)](_0x229285=>_0x229285[_0x201ab1(0x2f1)][_0x201ab1(0x1247)](_0x201ab1(0x335))),document[_0x201ab1(0x89d)]('delete-selected-products-btn')['textContent']='删除\x20(0)',document[_0x201ab1(0x89d)](_0x201ab1(0x542))[_0x201ab1(0x1b0)]=![]),_0xdeaaf2(),_0x507e14();}),document['getElementById'](_0x54b568(0x4ff))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x4a9ef8=_0x54b568;_0x5331a4?_0x4bdf9e(null):alert(_0x4a9ef8(0x123c));}),document['getElementById'](_0x54b568(0x6ff))[_0x54b568(0x1193)](_0x54b568(0x12a5),async _0x1e2e25=>{const _0x51bdc3=_0x54b568,_0x4934cc=_0x1e2e25[_0x51bdc3(0x225)][_0x51bdc3(0x53a)](_0x51bdc3(0x1116));if(!_0x4934cc)return;const _0x2b5183=parseInt(_0x4934cc['dataset']['id']);if(isNaN(_0x2b5183))return;if(_0x5331a4){if(_0x1e2e25[_0x51bdc3(0x225)][_0x51bdc3(0x2f1)][_0x51bdc3(0x3ff)]('edit-product-btn')){_0x4bdf9e(_0x2b5183);return;}if(_0x1e2e25[_0x51bdc3(0x225)][_0x51bdc3(0x2f1)][_0x51bdc3(0x3ff)](_0x51bdc3(0xda8))){const _0xa5711d=await _0x1a6951[_0x51bdc3(0xa6d)][_0x51bdc3(0x650)](_0x2b5183);if(!_0xa5711d)return;const _0x392930=await _0x4e2abc(_0x51bdc3(0x116f),'确定要永久删除商品\x20“'+_0xa5711d['name']+_0x51bdc3(0x100e),{'confirmButtonClass':_0x51bdc3(0xcd8)});_0x392930&&(await _0x1a6951[_0x51bdc3(0xa6d)]['delete'](_0x2b5183),await _0xdeaaf2(),alert('商品已删除。'));return;}_0x4934cc[_0x51bdc3(0x2f1)][_0x51bdc3(0x73b)](_0x51bdc3(0x335));_0x512a2b[_0x51bdc3(0xa14)](_0x2b5183)?_0x512a2b[_0x51bdc3(0x684)](_0x2b5183):_0x512a2b[_0x51bdc3(0x569)](_0x2b5183);document['getElementById'](_0x51bdc3(0x459))[_0x51bdc3(0xf12)]=_0x51bdc3(0x618)+_0x512a2b[_0x51bdc3(0x746)]+')';return;}if(_0x1e2e25[_0x51bdc3(0x225)][_0x51bdc3(0x2f1)][_0x51bdc3(0x3ff)](_0x51bdc3(0x1236))){const _0x562c76=await _0x1a6951[_0x51bdc3(0xa6d)][_0x51bdc3(0x650)](_0x2b5183);_0x562c76[_0x51bdc3(0x3d4)]&&_0x562c76['variations']['length']>0x0?_0x248079(_0x2b5183):(await _0x193b17(_0x2b5183),await _0x532f76('成功',_0x51bdc3(0xe3b)));return;}_0x4934cc['contains'](_0x1e2e25[_0x51bdc3(0x225)])&&console[_0x51bdc3(0x471)](_0x51bdc3(0xbd5)+_0x2b5183);}),document[_0x54b568(0x89d)](_0x54b568(0x396))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x51c4c4=>{const _0x45cac3=_0x54b568,_0x18a667=_0x51c4c4[_0x45cac3(0x225)];_0x18a667[_0x45cac3(0x2f1)]['contains'](_0x45cac3(0x98e))&&_0x3a0b64(parseInt(_0x18a667[_0x45cac3(0xaaf)]['id']),-0x1),_0x18a667[_0x45cac3(0x2f1)][_0x45cac3(0x3ff)](_0x45cac3(0x787))&&_0x3a0b64(parseInt(_0x18a667['dataset']['id']),0x1),_0x18a667[_0x45cac3(0x2f1)][_0x45cac3(0x3ff)](_0x45cac3(0xf7a))&&_0x38d994();}),document[_0x54b568(0x89d)](_0x54b568(0xa04))['addEventListener'](_0x54b568(0x12a5),async()=>{const _0x3b30a1=_0x54b568;if(_0x37a4bf[_0x3b30a1(0x7aa)]===0x0)return;const _0x3aea2e=await _0x4e2abc(_0x3b30a1(0xe85),_0x3b30a1(0xe51));_0x3aea2e&&(_0x37a4bf=[],_0x20ae6e(),_0x453595());}),document[_0x54b568(0x89d)]('select-all-cart-items')[_0x54b568(0x1193)](_0x54b568(0x76c),function(_0x1d6d4b){const _0x3b657e=_0x54b568;document[_0x3b657e(0x35f)](_0x3b657e(0xd83))['forEach'](_0x488a86=>{const _0x5a4cfa=_0x3b657e;_0x488a86[_0x5a4cfa(0x1b0)]=_0x1d6d4b[_0x5a4cfa(0x225)][_0x5a4cfa(0x1b0)];}),_0x38d994();}),document[_0x54b568(0x89d)](_0x54b568(0x682))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x29dcaa=_0x54b568;document[_0x29dcaa(0x89d)](_0x29dcaa(0x11c2))['classList'][_0x29dcaa(0x1247)](_0x29dcaa(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0x1293))[_0x54b568(0x1193)]('click',_0x3e1497),document[_0x54b568(0x89d)](_0x54b568(0x2ba))[_0x54b568(0x1193)](_0x54b568(0x76c),_0x4d8ed3=>{const _0x32286f=_0x54b568,_0x2b0186=_0x4d8ed3[_0x32286f(0x225)]['files'][0x0];if(_0x2b0186){const _0x1c5fab=new FileReader();_0x1c5fab[_0x32286f(0x736)]=_0x3bdf27=>{const _0x55614d=_0x32286f;document['getElementById'](_0x55614d(0x579))[_0x55614d(0x9e3)]=_0x3bdf27[_0x55614d(0x225)][_0x55614d(0x9dc)];},_0x1c5fab['readAsDataURL'](_0x2b0186);}}),document[_0x54b568(0x89d)](_0x54b568(0x116e))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x16518e=>{const _0x9068d=_0x54b568,_0x38a7d=_0x16518e[_0x9068d(0x225)]['closest'](_0x9068d(0xda4));if(_0x38a7d){const _0x475357=_0x38a7d[_0x9068d(0x53a)](_0x9068d(0x2de));_0x475357&&_0x6f4bad(parseInt(_0x475357[_0x9068d(0xaaf)][_0x9068d(0x114e)]));}}),document[_0x54b568(0x89d)]('cancel-gift-recipient-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x587d34=_0x54b568;document['getElementById'](_0x587d34(0x12a1))[_0x587d34(0x2f1)][_0x587d34(0x1247)](_0x587d34(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0x1296))['addEventListener'](_0x54b568(0x12a5),async()=>{const _0x210854=_0x54b568,_0x10bcac=Array[_0x210854(0x321)](document['querySelectorAll'](_0x210854(0x935)))[_0x210854(0x412)](_0x1b6d84=>_0x1b6d84[_0x210854(0xaaf)][_0x210854(0x2ff)]);if(_0x10bcac[_0x210854(0x7aa)]===0x0){alert(_0x210854(0x6fd));return;}const _0x5b2ed9=_0x37a4bf[_0x210854(0x3d8)](_0x578a83=>document['querySelector']('.cart-item-checkbox[data-id=\x22'+_0x578a83['productId']+_0x210854(0x21f)));await _0x1ecaab(_0x5b2ed9,_0x10bcac),document[_0x210854(0x89d)](_0x210854(0x12a1))[_0x210854(0x2f1)][_0x210854(0x1247)](_0x210854(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0xb82))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x2462df=>{const _0x42c8f8=_0x54b568,_0x3da1d7=_0x2462df[_0x42c8f8(0x225)]['closest'](_0x42c8f8(0x1149));_0x3da1d7&&_0x3da1d7[_0x42c8f8(0x2f1)][_0x42c8f8(0x73b)](_0x42c8f8(0x335));}),document[_0x54b568(0x89d)](_0x54b568(0xc63))[_0x54b568(0x1193)](_0x54b568(0x76c),function(_0x11370b){const _0x2fa0ff=_0x54b568,_0x34eb49=_0x11370b[_0x2fa0ff(0x225)]['checked'];document[_0x2fa0ff(0x35f)](_0x2fa0ff(0x5f5))['forEach'](_0x556585=>{const _0x13cf79=_0x2fa0ff;_0x556585[_0x13cf79(0x2f1)]['toggle']('selected',_0x34eb49);});}),document[_0x54b568(0x89d)]('regenerate-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x173ebd),document[_0x54b568(0x89d)](_0x54b568(0x18a))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x5dfdbe),document[_0x54b568(0x89d)](_0x54b568(0xa8c))['addEventListener'](_0x54b568(0x12a5),_0x52a46a),document[_0x54b568(0x89d)]('test-sound-btn')['addEventListener'](_0x54b568(0x12a5),()=>{const _0x56a6f2=_0x54b568,_0xa1b021=document[_0x56a6f2(0x89d)](_0x56a6f2(0xc16)),_0x3e0378=document[_0x56a6f2(0x89d)]('notification-sound-url-input')[_0x56a6f2(0x2f4)][_0x56a6f2(0xc3a)]()||_0x3aca30;_0xa1b021['src']=_0x3e0378,_0xa1b021[_0x56a6f2(0x5ad)]()['catch'](_0x2b85e2=>alert(_0x56a6f2(0x12dc)));}),document[_0x54b568(0x89d)]('reset-sound-btn')[_0x54b568(0x1193)]('click',()=>{const _0x3821cd=_0x54b568;document[_0x3821cd(0x89d)](_0x3821cd(0x1333))['value']='',alert('已重置为默认提示音，点击“保存所有外观设置”后生效。');}),document['getElementById'](_0x54b568(0xc0c))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x348481=>{const _0x39bb0d=_0x54b568,_0x46705d=_0x348481['target'];_0x46705d[_0x39bb0d(0x2f1)]['contains'](_0x39bb0d(0x30e))&&_0x1823d1(_0x46705d),_0x46705d[_0x39bb0d(0x2f1)][_0x39bb0d(0x3ff)](_0x39bb0d(0xcc6))&&_0x178f2e(_0x46705d);}),document['getElementById']('add-song-search-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x35b0bf),document[_0x54b568(0x89d)](_0x54b568(0xa05))['addEventListener'](_0x54b568(0x12a5),()=>{const _0x4a7e7b=_0x54b568;document[_0x4a7e7b(0x89d)](_0x4a7e7b(0x372))['classList'][_0x4a7e7b(0x1247)](_0x4a7e7b(0x11e4));}),document[_0x54b568(0x89d)]('add-song-search-btn')['addEventListener'](_0x54b568(0x12a5),_0x35b0bf),document['getElementById']('cancel-music-search-btn')['addEventListener'](_0x54b568(0x12a5),()=>{const _0x4ffeac=_0x54b568;document[_0x4ffeac(0x89d)](_0x4ffeac(0x372))['classList']['remove'](_0x4ffeac(0x11e4));}),document['getElementById'](_0x54b568(0xa18))[_0x54b568(0x1193)](_0x54b568(0x76c),function(_0x2db0ea){const _0x32a452=_0x54b568;document[_0x32a452(0x35f)]('#search-results-list\x20.music-search-checkbox')[_0x32a452(0xd9a)](_0x536569=>{const _0x21cf19=_0x32a452;_0x536569[_0x21cf19(0x1b0)]=_0x2db0ea['target']['checked'];});}),document[_0x54b568(0x89d)]('search-results-list')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0xa255a3=>{const _0x312644=_0x54b568,_0x51257b=_0xa255a3['target'][_0x312644(0x53a)](_0x312644(0xb60));if(_0x51257b){const _0x2f4110=_0x51257b[_0x312644(0xd16)](_0x312644(0x2b1));_0x2f4110&&(_0xa255a3['target']!==_0x2f4110&&(_0x2f4110[_0x312644(0x1b0)]=!_0x2f4110[_0x312644(0x1b0)]));}}),document[_0x54b568(0x89d)](_0x54b568(0xfe3))[_0x54b568(0x1193)]('click',async()=>{const _0x54ef36=_0x54b568,_0x32896c=document[_0x54ef36(0x35f)](_0x54ef36(0xa96));if(_0x32896c[_0x54ef36(0x7aa)]===0x0){alert(_0x54ef36(0x1141));return;}document['getElementById'](_0x54ef36(0x372))['classList'][_0x54ef36(0x1247)](_0x54ef36(0x11e4)),await _0x532f76(_0x54ef36(0xb6a),_0x54ef36(0x811)+_0x32896c['length']+_0x54ef36(0xa20));const _0x294a28=Array[_0x54ef36(0x321)](_0x32896c)[_0x54ef36(0x412)](_0x3e0fd4=>JSON[_0x54ef36(0x2cb)](_0x3e0fd4[_0x54ef36(0x53a)]('.search-result-item')[_0x54ef36(0xaaf)][_0x54ef36(0x7f7)]));let _0x5ae428=0x0,_0x5725a=[];const _0x3b4914=_0x294a28[_0x54ef36(0x412)](_0x30fafe=>_0x35a340(_0x30fafe)),_0x44f019=await Promise[_0x54ef36(0x863)](_0x3b4914);_0x44f019['forEach']((_0x57f1c3,_0x5a865f)=>{const _0xdd89c1=_0x54ef36;_0x57f1c3?(_0x1f2ed8[_0xdd89c1(0x2c0)][_0xdd89c1(0x138c)](_0x57f1c3),_0x5ae428++):_0x5725a['push'](_0x294a28[_0x5a865f][_0xdd89c1(0xf74)]);});_0x5ae428>0x0&&(await _0x4ae954(),_0x45027b(),_0x1f2ed8[_0x54ef36(0x602)]===-0x1&&(_0x1f2ed8['currentIndex']=_0x1f2ed8[_0x54ef36(0x2c0)]['length']-_0x5ae428,_0x2f3a2e()));let _0x339dbc=_0x54ef36(0xdc3)+_0x5ae428+'\x20首歌曲。';_0x5725a[_0x54ef36(0x7aa)]>0x0&&(_0x339dbc+='\x0a\x0a'+_0x5725a[_0x54ef36(0x7aa)]+_0x54ef36(0xe78)+_0x5725a[_0x54ef36(0x1237)](_0x54ef36(0x9b6))),await _0x532f76('操作结果',_0x339dbc);}),document[_0x54b568(0x89d)]('music-visual-container')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x95833b=_0x54b568;document[_0x95833b(0x89d)]('music-visual-container')[_0x95833b(0x2f1)][_0x95833b(0x73b)]('lyrics-active');}),document['getElementById']('add-song-search-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x35b0bf),document[_0x54b568(0x89d)](_0x54b568(0xa05))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x395aeb=_0x54b568;document['getElementById'](_0x395aeb(0x372))[_0x395aeb(0x2f1)]['remove'](_0x395aeb(0x11e4));}),document[_0x54b568(0x89d)]('search-results-list')['addEventListener']('click',_0x4c53d4=>{const _0x29cf3d=_0x54b568,_0x1c1370=_0x4c53d4[_0x29cf3d(0x225)][_0x29cf3d(0x53a)](_0x29cf3d(0xb60));if(_0x1c1370&&_0x1c1370[_0x29cf3d(0xaaf)][_0x29cf3d(0x7f7)]){const _0xe1f6b=JSON[_0x29cf3d(0x2cb)](_0x1c1370[_0x29cf3d(0xaaf)][_0x29cf3d(0x7f7)]);handleSearchResultClick(_0xe1f6b);}}),document[_0x54b568(0x89d)](_0x54b568(0x69a))[_0x54b568(0x1193)]('click',_0x217c27),document[_0x54b568(0x89d)](_0x54b568(0xb04))[_0x54b568(0x1193)]('click',_0x983ea5),document[_0x54b568(0x89d)]('toggle-fullscreen-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x5abadd),document[_0x54b568(0x89d)]('show-avatars-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x14c50b),document[_0x54b568(0x89d)](_0x54b568(0x1372))['addEventListener'](_0x54b568(0x76c),()=>{const _0x40e8fc=_0x54b568;_0x5b873d[_0x40e8fc(0x21a)][_0x40e8fc(0x1f0)]=document[_0x40e8fc(0x89d)](_0x40e8fc(0x1372))[_0x40e8fc(0x1b0)],_0x203037();}),document[_0x54b568(0x89d)](_0x54b568(0x9e8))[_0x54b568(0x1193)]('click',_0x501d5e),document[_0x54b568(0x89d)](_0x54b568(0xe8e))[_0x54b568(0x1193)]('click',()=>{const _0x2144ac=_0x54b568;document['getElementById']('clear-posts-modal')[_0x2144ac(0x2f1)][_0x2144ac(0x1247)](_0x2144ac(0x11e4));}),document['getElementById']('confirm-clear-posts-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x584136),document[_0x54b568(0x89d)](_0x54b568(0x295))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x1c0ce7=>{const _0x12666a=_0x54b568,_0x20de18=_0x1c0ce7[_0x12666a(0x225)]['closest']('.clear-posts-item');_0x20de18&&_0x20de18[_0x12666a(0x2f1)][_0x12666a(0x73b)](_0x12666a(0x335));}),document[_0x54b568(0x89d)]('global-bg-input')[_0x54b568(0x1193)]('change',async _0x328e7f=>{const _0x355d65=_0x54b568,_0x2dd851=_0x328e7f[_0x355d65(0x225)][_0x355d65(0x541)][0x0];if(_0x2dd851){const _0x4a8818=await new Promise(_0x28b867=>{const _0x51a24c=_0x355d65,_0x542ea7=new FileReader();_0x542ea7['onload']=()=>_0x28b867(_0x542ea7[_0x51a24c(0x9dc)]),_0x542ea7['readAsDataURL'](_0x2dd851);});_0x5b873d[_0x355d65(0x21a)][_0x355d65(0xcdb)]=_0x4a8818,_0x245609();}_0x328e7f['target'][_0x355d65(0x2f4)]=null;}),document[_0x54b568(0x89d)](_0x54b568(0x78c))[_0x54b568(0x1193)]('click',()=>{const _0x4fae19=_0x54b568;_0x5b873d[_0x4fae19(0x21a)][_0x4fae19(0xcdb)]='',_0x245609();}),document[_0x54b568(0x89d)](_0x54b568(0x848))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x2645d2=_0x54b568;_0x4de9bb&&(_0x5b873d[_0x2645d2(0x21a)][_0x2645d2(0xd92)]=_0x4de9bb),_0x5b873d[_0x2645d2(0x21a)][_0x2645d2(0x876)]=document[_0x2645d2(0x89d)](_0x2645d2(0xbb4))['value']['trim'](),_0x5b873d[_0x2645d2(0x21a)][_0x2645d2(0x261)]=document[_0x2645d2(0x89d)](_0x2645d2(0x1333))[_0x2645d2(0x2f4)][_0x2645d2(0xc3a)](),_0x5b873d[_0x2645d2(0x21a)]['showStatusBar']=document[_0x2645d2(0x89d)](_0x2645d2(0x1372))['checked'],await _0x1a6951[_0x2645d2(0x21a)][_0x2645d2(0xc0f)](_0x5b873d['globalSettings']),_0x550834(),_0x4de9bb=null,_0x337978(),_0x446f71(_0x5b873d[_0x2645d2(0x21a)]['globalCss']),_0x203037(),alert(_0x2645d2(0xc83)),_0x4e6c15(_0x2645d2(0xc0c));}),document[_0x54b568(0x89d)](_0x54b568(0xf62))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x1822db=_0x54b568,_0x423106=await _0x34d246('网络图片',_0x1822db(0xf2c),'',_0x1822db(0x11de));if(_0x423106&&_0x423106['trim']())_0x5b873d[_0x1822db(0x21a)]['globalChatBackground']=_0x423106[_0x1822db(0xc3a)](),_0x245609();else _0x423106!==null&&alert(_0x1822db(0x107b));}),document[_0x54b568(0x89d)](_0x54b568(0xdd6))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x3e4c1c=_0x54b568,_0x2929dc=await _0x34d246(_0x3e4c1c(0xa40),_0x3e4c1c(0xa8e),'',_0x3e4c1c(0x11de));if(_0x2929dc&&_0x2929dc[_0x3e4c1c(0xc3a)]())_0x4de9bb=_0x2929dc['trim'](),_0x245609();else _0x2929dc!==null&&alert('请输入有效的URL。');}),document['getElementById'](_0x54b568(0x9b0))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x21273a=_0x54b568,_0x24a172=await _0x34d246(_0x21273a(0x441),_0x21273a(0x51a),'','url');if(_0x24a172&&_0x24a172['trim']())_0x5b873d['globalSettings']['cphoneWallpaper']=_0x24a172['trim'](),_0x245609();else _0x24a172!==null&&alert('请输入有效的URL。');}),document[_0x54b568(0x89d)]('remove-ephone-bg-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x1be94e=_0x54b568;_0x4de9bb=null,_0x5b873d[_0x1be94e(0x21a)]['wallpaper']='',_0x245609();}),document[_0x54b568(0x89d)]('remove-cphone-bg-btn')[_0x54b568(0x1193)]('click',()=>{const _0x5ad549=_0x54b568;_0x5b873d[_0x5ad549(0x21a)][_0x5ad549(0x5fa)]='',_0x245609();}),document['getElementById']('css-preset-select')[_0x54b568(0x1193)](_0x54b568(0x76c),_0xa4ad3a),document['getElementById'](_0x54b568(0xd18))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x7d087a),document['getElementById']('delete-css-preset-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x4fce88),document['getElementById']('font-preset-select')[_0x54b568(0x1193)]('change',_0x3bfb4e),document[_0x54b568(0x89d)](_0x54b568(0x195))['addEventListener'](_0x54b568(0x12a5),_0x5d4308),document[_0x54b568(0x89d)](_0x54b568(0x9e2))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x2b9729),document[_0x54b568(0x89d)](_0x54b568(0x132b))['addEventListener'](_0x54b568(0x76c),_0x137610),document['getElementById'](_0x54b568(0x2c6))['addEventListener']('click',_0x3885ca),document[_0x54b568(0x89d)](_0x54b568(0x464))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x529bc7),document['getElementById'](_0x54b568(0xd30))[_0x54b568(0x1193)]('click',_0x80f825),document[_0x54b568(0x89d)](_0x54b568(0xd9d))[_0x54b568(0x1193)]('click',()=>{const _0x4c7209=_0x54b568;document[_0x4c7209(0x89d)](_0x4c7209(0xeda))['classList'][_0x4c7209(0x1247)](_0x4c7209(0x11e4)),_0x1e547a();}),document[_0x54b568(0x89d)](_0x54b568(0x1353))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x8baf88),document[_0x54b568(0x89d)](_0x54b568(0x5f4))['addEventListener'](_0x54b568(0x12a5),_0x61a42f=>{const _0x1680fa=_0x54b568;if(_0x61a42f[_0x1680fa(0x225)][_0x1680fa(0x2f1)]['contains'](_0x1680fa(0x126d))){const _0x559c71=parseInt(_0x61a42f[_0x1680fa(0x225)][_0x1680fa(0xaaf)]['id']);_0x49fd0a(_0x559c71);}}),document[_0x54b568(0x89d)](_0x54b568(0xee5))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x46e88=>{const _0xefbdb0=_0x54b568;if(_0x46e88[_0xefbdb0(0x225)]['classList'][_0xefbdb0(0x3ff)](_0xefbdb0(0x63e))){const _0x4393fc=_0x46e88[_0xefbdb0(0x225)][_0xefbdb0(0xaaf)][_0xefbdb0(0xcb1)],_0x271c36=_0x4393fc!==_0xefbdb0(0x863)&&_0x4393fc!==_0xefbdb0(0x67a)?parseInt(_0x4393fc):_0x4393fc;_0x41c302(_0x271c36);}}),document[_0x54b568(0x89d)](_0x54b568(0x1a8))[_0x54b568(0x1193)](_0x54b568(0x76c),_0x4287a0),document[_0x54b568(0x89d)](_0x54b568(0xbec))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x1245eb),document[_0x54b568(0x89d)]('import-single-chat-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x5bfdec=_0x54b568;document[_0x5bfdec(0x89d)](_0x5bfdec(0x894))[_0x5bfdec(0x12a5)]();}),document[_0x54b568(0x89d)]('import-single-chat-input')[_0x54b568(0x1193)](_0x54b568(0x76c),_0x45b40a=>{const _0x31e493=_0x54b568,_0x19dbd9=_0x45b40a[_0x31e493(0x225)]['files'][0x0];_0x19dbd9&&_0x230ae7(_0x19dbd9),_0x45b40a[_0x31e493(0x225)][_0x31e493(0x2f4)]=null;}),document[_0x54b568(0x89d)](_0x54b568(0x1039))['addEventListener']('click',()=>_0x4e7a61()),document['getElementById'](_0x54b568(0x9ed))['addEventListener'](_0x54b568(0x12a5),()=>openDiaryEditor()),document['getElementById'](_0x54b568(0x2fa))[_0x54b568(0x1193)]('click',_0xabb58f),document[_0x54b568(0x89d)](_0x54b568(0xb66))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x1edb8b),document['getElementById']('favorite-memo-btn')['addEventListener'](_0x54b568(0x12a5),_0x4cc961),document[_0x54b568(0x89d)]('regenerate-char-qq-btn')[_0x54b568(0x1193)]('click',async()=>{const _0x3084b6=_0x54b568;_0x532f76(_0x3084b6(0x4e6),_0x3084b6(0xcef));try{await Promise[_0x3084b6(0x863)]([_0x42e397(),_0x3ecef3()]),console[_0x3084b6(0x471)]('CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。');}catch(_0x833dfd){console[_0x3084b6(0x1fd)](_0x3084b6(0xc99),_0x833dfd),await _0x532f76(_0x3084b6(0x10de),_0x3084b6(0x533)+_0x833dfd[_0x3084b6(0x1288)]);}}),document[_0x54b568(0x89d)](_0x54b568(0xe54))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x3d64bc=>{const _0x1b5658=_0x54b568,_0x55e8be=_0x3d64bc[_0x1b5658(0x225)]['closest']('.chat-list-item');if(_0x55e8be&&_0x55e8be['dataset'][_0x1b5658(0x3d0)]){const _0x2be5af=parseInt(_0x55e8be[_0x1b5658(0xaaf)][_0x1b5658(0x3d0)]);!isNaN(_0x2be5af)&&_0xad8c09(_0x2be5af);}}),document[_0x54b568(0x89d)](_0x54b568(0xf3e))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{_0x16d75b('char-qq-screen');});const _0x4af6bc=document['getElementById']('char-conversation-messages'),_0x3623bc=()=>{const _0x14cc78=_0x54b568;if(_0x10a81b!==_0x14cc78(0x10b1))return;if(_0x4af6bc[_0x14cc78(0xb0e)]<0x1&&!_0x2dde7e){const _0x2f0e85=_0x5b873d[_0x14cc78(0x667)][_0x521c79]?.['history']['length']||0x0;_0x2f0e85>_0x105ba4&&_0x41fe2c();}};_0x4af6bc[_0x54b568(0x1193)](_0x54b568(0x62b),_0x3623bc),document[_0x54b568(0x89d)](_0x54b568(0xacf))['addEventListener'](_0x54b568(0x12a5),()=>{const _0xa71b27=_0x54b568;alert(_0xa71b27(0xc45));}),document[_0x54b568(0x89d)]('regenerate-char-album-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x34a168),document[_0x54b568(0x89d)](_0x54b568(0xe6c))[_0x54b568(0x1193)]('click',_0x43c207=>{const _0x19a433=_0x54b568,_0x4c171d=_0x43c207[_0x19a433(0x225)][_0x19a433(0x53a)](_0x19a433(0xa0f));if(_0x4c171d&&_0x4c171d[_0x19a433(0xaaf)][_0x19a433(0xf6e)]){const _0x30da50=_0x4c171d[_0x19a433(0xaaf)][_0x19a433(0xf6e)];_0x532f76(_0x19a433(0x961),_0x30da50['replace'](/\n/g,_0x19a433(0x962)));}}),document['getElementById']('regenerate-char-browser-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0xdc6bcf),document['getElementById'](_0x54b568(0x3b9))[_0x54b568(0x1193)]('click',_0x2dafb4),document[_0x54b568(0x89d)](_0x54b568(0xce1))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x528f24=>{const _0x1d82df=_0x54b568,_0x19e60f=_0x528f24[_0x1d82df(0x225)][_0x1d82df(0x53a)](_0x1d82df(0x79c));if(_0x19e60f&&_0x19e60f[_0x1d82df(0xaaf)][_0x1d82df(0xb90)]){const _0x5b907e=_0x19e60f[_0x1d82df(0xaaf)]['reason'];_0x532f76(_0x1d82df(0x1052),_0x5b907e[_0x1d82df(0xfbf)](/\n/g,_0x1d82df(0x962)));}}),window[_0x54b568(0xb68)]=_0x2ca778,document[_0x54b568(0x89d)]('regenerate-char-memo-btn')[_0x54b568(0x1193)]('click',_0x131ab5),document[_0x54b568(0x89d)]('char-memo-detail-back-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>_0x16d75b(_0x54b568(0xf39))),document[_0x54b568(0x89d)](_0x54b568(0xa76))[_0x54b568(0x1193)]('click',_0x25db10),document['getElementById'](_0x54b568(0x9ed))['addEventListener'](_0x54b568(0x12a5),_0x388909),document[_0x54b568(0x89d)](_0x54b568(0x272))[_0x54b568(0x1193)]('click',()=>_0x16d75b(_0x54b568(0xdc4))),document[_0x54b568(0x89d)](_0x54b568(0x2be))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x444d91),document[_0x54b568(0x89d)](_0x54b568(0x37f))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x419c04),document[_0x54b568(0x89d)]('regenerate-char-music-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x30b2ae),document[_0x54b568(0x89d)](_0x54b568(0x5cb))['addEventListener']('click',_0x25ec1a),document['getElementById'](_0x54b568(0x70c))[_0x54b568(0x1193)]('click',_0x147d3c),document[_0x54b568(0x89d)](_0x54b568(0x70c))[_0x54b568(0x1193)]('click',_0x147d3c),document[_0x54b568(0x89d)](_0x54b568(0x82e))[_0x54b568(0x1193)]('click',()=>_0x4e6c15(_0x54b568(0x111b))),document[_0x54b568(0x89d)](_0x54b568(0x226))[_0x54b568(0x1193)]('click',_0x52619e),document['getElementById']('douban-wait-reply-btn')['addEventListener'](_0x54b568(0x12a5),_0x36b704),document[_0x54b568(0x89d)](_0x54b568(0x12d1))[_0x54b568(0x1193)](_0x54b568(0x76c),async _0xe98339=>{const _0x52f9f2=_0x54b568,_0x2c4ce1=_0xe98339[_0x52f9f2(0x225)][_0x52f9f2(0x541)][0x0];if(_0x2c4ce1){const _0x22c924=await new Promise(_0x2c28e8=>{const _0x45f017=_0x52f9f2,_0x1ad0e0=new FileReader();_0x1ad0e0[_0x45f017(0x736)]=()=>_0x2c28e8(_0x1ad0e0[_0x45f017(0x9dc)]),_0x1ad0e0[_0x45f017(0x5b4)](_0x2c4ce1);});_0x5b873d[_0x52f9f2(0x21a)][_0x52f9f2(0x5fa)]=_0x22c924,_0x245609();}}),document[_0x54b568(0x89d)](_0x54b568(0x12a6))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x5bfb55=>{const _0x3b680d=_0x54b568;if(_0x5bfb55[_0x3b680d(0x225)][_0x3b680d(0x2f1)][_0x3b680d(0x3ff)]('change-icon-btn')){const _0x13ca32=_0x5bfb55[_0x3b680d(0x225)][_0x3b680d(0x53a)]('.icon-setting-item'),_0x3c8c15=_0x13ca32[_0x3b680d(0xaaf)]['iconId'];_0x3c8c15&&_0x5627c5(_0x3c8c15,_0x3b680d(0x26a),_0x13ca32);}}),document[_0x54b568(0x89d)](_0x54b568(0x3d9))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x1da08a=_0x54b568;document['getElementById']('import-appearance-input')[_0x1da08a(0x12a5)]();}),document[_0x54b568(0x89d)](_0x54b568(0x933))[_0x54b568(0x1193)]('change',_0x13979d=>{const _0x1f4266=_0x54b568,_0x201223=_0x13979d[_0x1f4266(0x225)][_0x1f4266(0x541)][0x0];_0x201223&&_0x2aba74(_0x201223),_0x13979d[_0x1f4266(0x225)][_0x1f4266(0x2f4)]=null;}),document[_0x54b568(0x1193)](_0x54b568(0x5cf),()=>{const _0x1f7068=_0x54b568;document[_0x1f7068(0xeb4)]===_0x1f7068(0xe90)&&(localStorage['setItem'](_0x1f7068(0xfab),Date[_0x1f7068(0xf1a)]()),console[_0x1f7068(0x471)](_0x1f7068(0x1bb)));}),document[_0x54b568(0x89d)]('export-world-book-btn')['addEventListener'](_0x54b568(0x12a5),_0x23e48b),document[_0x54b568(0x89d)](_0x54b568(0x1c0))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x4fbe6b=_0x54b568;document['getElementById'](_0x4fbe6b(0xd4d))['click']();}),document['getElementById']('import-world-book-input')[_0x54b568(0x1193)](_0x54b568(0x76c),_0x38445f=>{const _0x3e2e91=_0x54b568,_0x110f80=_0x38445f[_0x3e2e91(0x225)][_0x3e2e91(0x541)][0x0];_0x110f80&&_0x17b746(_0x110f80),_0x38445f['target'][_0x3e2e91(0x2f4)]=null;}),document[_0x54b568(0x89d)]('enable-ai-drawing-switch')['addEventListener']('change',async _0x30f4c3=>{const _0x590a11=_0x54b568,_0x5247c4=_0x30f4c3[_0x590a11(0x225)][_0x590a11(0x1b0)];_0x5b873d[_0x590a11(0x21a)]['enableAiDrawing']=_0x5247c4,await _0x1a6951[_0x590a11(0x21a)][_0x590a11(0xc0f)](_0x5b873d[_0x590a11(0x21a)]);const _0x1c9acb=document[_0x590a11(0xd16)](_0x590a11(0x40c));if(_0x1c9acb)switch(_0x1c9acb['id']){case _0x590a11(0x87f):_0x5b89df(_0x5b873d[_0x590a11(0xf96)]);break;case'chat-list-screen':if(document['getElementById'](_0x590a11(0x47b))[_0x590a11(0x2f1)]['contains'](_0x590a11(0x8ea)))_0x155816();if(document['getElementById']('favorites-view')['classList'][_0x590a11(0x3ff)](_0x590a11(0x8ea)))_0x2e7944();break;case'douban-screen':_0x2c6452();break;case _0x590a11(0x2d2):_0x19b539(_0x2188b8);break;case _0x590a11(0xed7):const _0x552e3a=document[_0x590a11(0xd16)]('.char-screen.active');if(_0x552e3a)switch(_0x552e3a['id']){case _0x590a11(0x8da):_0x2ae346();break;case _0x590a11(0x1327):_0x59b018();break;case _0x590a11(0x645):const _0x56cf26=_0x5b873d[_0x590a11(0x667)][_0x521c79],_0x3bc653=_0x56cf26[_0x590a11(0xc1c)]||[],_0x12f2bf=_0x3bc653[_0x590a11(0x7aa)]>0x0?_0x3bc653[_0x590a11(0x7aa)]-0x1:0x0;_0x50520(_0x3bc653[_0x12f2bf]);break;case _0x590a11(0xcb9):_0x482765();break;case _0x590a11(0xa4f):_0x314477();break;case'char-qq-conversation-screen':const _0xf54758=document[_0x590a11(0xd16)](_0x590a11(0x1183))?.[_0x590a11(0xaaf)][_0x590a11(0x3d0)]||0x0;_0xad8c09(parseInt(_0xf54758));break;}break;}_0x532f76(_0x590a11(0xc73),_0x590a11(0xb4d)+(_0x5247c4?'开启':'关闭')+'。');}),document[_0x54b568(0x89d)]('search-history-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x496b64),document[_0x54b568(0x89d)](_0x54b568(0x5a7))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x135bfc=_0x54b568;_0x4e6c15(_0x135bfc(0xfae));}),document[_0x54b568(0x89d)](_0x54b568(0x10dc))['addEventListener'](_0x54b568(0x12a5),_0x3d06ef),document['getElementById'](_0x54b568(0xd40))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x3cc400),document[_0x54b568(0x89d)](_0x54b568(0x1bd))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x4a5441),document[_0x54b568(0x89d)](_0x54b568(0x11be))[_0x54b568(0x1193)]('click',_0x3a9bee),document[_0x54b568(0xd16)](_0x54b568(0xcf5))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x33dfe8=>{const _0x319cee=_0x54b568;if(_0x33dfe8[_0x319cee(0x225)][_0x319cee(0x2f1)]['contains'](_0x319cee(0x670))){const _0x31ac1d=parseInt(_0x33dfe8[_0x319cee(0x225)][_0x319cee(0xaaf)]['id']);!isNaN(_0x31ac1d)&&_0xaa109d(_0x31ac1d);}}),_0x13c70d(),window[_0x54b568(0x764)]=_0x530a32,document[_0x54b568(0x89d)](_0x54b568(0x1265))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x43c665=_0x54b568,_0x1f69ae=await _0x34d246('创建新预设','请输入预设名称');if(_0x1f69ae&&_0x1f69ae[_0x43c665(0xc3a)]()){const _0x368ea5={'id':_0x43c665(0x9d0)+Date[_0x43c665(0xf1a)](),'name':_0x1f69ae['trim'](),'content':[]};await _0x1a6951[_0x43c665(0x4da)][_0x43c665(0x569)](_0x368ea5),await _0x50d15c(),_0x5a63f5(_0x368ea5['id']);}}),document[_0x54b568(0x89d)](_0x54b568(0xfba))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x216bb7),document[_0x54b568(0x89d)]('add-preset-entry-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x28cfab=_0x54b568,_0x5e5a4f=document[_0x28cfab(0x89d)](_0x28cfab(0xac7));_0x5e5a4f[_0x28cfab(0xd16)]('p')&&(_0x5e5a4f[_0x28cfab(0x1ef)]='');const _0x3406bd=_0x7c949e();_0x5e5a4f[_0x28cfab(0x22f)](_0x3406bd),_0x3406bd[_0x28cfab(0xd16)]('.entry-content-textarea')[_0x28cfab(0xbf6)]();}),document[_0x54b568(0x89d)](_0x54b568(0x655))['addEventListener'](_0x54b568(0x12a5),async()=>{const _0x2d0a48=_0x54b568;if(!_0xa98184)return;const _0x3a8da7=await _0x1a6951[_0x2d0a48(0x4da)][_0x2d0a48(0x650)](_0xa98184);if(!_0x3a8da7)return;const _0x7a0cd0=document[_0x2d0a48(0x89d)]('preset-name-input')[_0x2d0a48(0x2f4)][_0x2d0a48(0xc3a)]();if(!_0x7a0cd0){alert(_0x2d0a48(0x2c2));return;}_0x3a8da7[_0x2d0a48(0xf74)]=_0x7a0cd0,_0x3a8da7['categoryId']=parseInt(document['getElementById']('preset-category-select')['value'])||null;const _0x353fe3=document[_0x2d0a48(0x89d)]('preset-entries-container'),_0x288003=_0x353fe3[_0x2d0a48(0x35f)](_0x2d0a48(0x214)),_0x4c9268=[];_0x288003['forEach'](_0x1d6b07=>{const _0x17053d=_0x2d0a48,_0x552509=_0x1d6b07[_0x17053d(0xd16)](_0x17053d(0x1147))[_0x17053d(0x2f4)][_0x17053d(0xc3a)]();_0x552509&&_0x4c9268[_0x17053d(0x138c)]({'comment':_0x1d6b07[_0x17053d(0xd16)](_0x17053d(0x105f))[_0x17053d(0x2f4)]['trim'](),'keys':(_0x1d6b07[_0x17053d(0xd16)](_0x17053d(0xbc5))[_0x17053d(0x2f4)][_0x17053d(0xc3a)]()||'')[_0x17053d(0x55b)](',')[_0x17053d(0x412)](_0x3bc787=>_0x3bc787[_0x17053d(0xc3a)]())[_0x17053d(0x3d8)](Boolean),'content':_0x552509,'enabled':_0x1d6b07[_0x17053d(0xd16)](_0x17053d(0xc86))[_0x17053d(0x1b0)]});}),_0x3a8da7['content']=_0x4c9268,await _0x1a6951['presets'][_0x2d0a48(0xc0f)](_0x3a8da7),_0xa98184=null,_0x4e6c15('preset-screen'),await _0x50d15c();}),document[_0x54b568(0x89d)](_0x54b568(0x60e))[_0x54b568(0x1193)]('click',()=>{const _0x12f9df=_0x54b568;document[_0x12f9df(0x89d)]('import-preset-input')[_0x12f9df(0x12a5)]();}),document[_0x54b568(0x89d)]('import-preset-input')['addEventListener'](_0x54b568(0x76c),_0x47a7d9),document['getElementById'](_0x54b568(0x5e2))[_0x54b568(0x1193)]('click',_0x386f77),document['getElementById'](_0x54b568(0xf15))['addEventListener'](_0x54b568(0x12a5),_0x3cfd84),document['getElementById'](_0x54b568(0x303))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x51ec81=_0x54b568;document[_0x51ec81(0x89d)](_0x51ec81(0xfa4))['classList']['remove']('visible');}),document[_0x54b568(0x89d)](_0x54b568(0xcf0))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x156a3e),document['getElementById'](_0x54b568(0x317))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x576fcc),document[_0x54b568(0x89d)]('cancel-clear-wizard-btn-step2')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x41e708=_0x54b568;document['getElementById']('data-clear-wizard-modal')['classList'][_0x41e708(0x1247)]('visible');}),document['getElementById']('confirm-final-clear-btn')[_0x54b568(0x1193)]('click',_0x42c418),document[_0x54b568(0x89d)]('data-clear-wizard-modal')[_0x54b568(0x1193)]('click',_0x802969=>{const _0x2287e4=_0x54b568,_0x2d766f=_0x802969[_0x2287e4(0x225)]['closest'](_0x2287e4(0x5c9));_0x2d766f&&(_0x802969[_0x2287e4(0x1088)](),_0x2d766f['classList'][_0x2287e4(0x73b)](_0x2287e4(0x335)));}),document[_0x54b568(0x89d)](_0x54b568(0xfa4))['addEventListener'](_0x54b568(0x76c),_0x2676b5=>{const _0x28e920=_0x54b568;if(_0x2676b5[_0x28e920(0x225)]['id']===_0x28e920(0x169)){const _0x1fe18f=_0x2676b5[_0x28e920(0x225)][_0x28e920(0x1b0)];document[_0x28e920(0x35f)](_0x28e920(0x609))[_0x28e920(0xd9a)](_0x4d2092=>{const _0x36e5e3=_0x28e920;_0x4d2092[_0x36e5e3(0x2f1)][_0x36e5e3(0x73b)](_0x36e5e3(0x335),_0x1fe18f);});}else{if(_0x2676b5[_0x28e920(0x225)]['id']===_0x28e920(0xd2c)){const _0x2312a6=_0x2676b5[_0x28e920(0x225)][_0x28e920(0x1b0)];document[_0x28e920(0x35f)](_0x28e920(0x584))[_0x28e920(0xd9a)](_0x48d685=>{const _0x59b064=_0x28e920;_0x48d685[_0x59b064(0x2f1)][_0x59b064(0x73b)]('selected',_0x2312a6);});}}}),document['getElementById'](_0x54b568(0xbb3))['addEventListener'](_0x54b568(0x12a5),_0x169b12),document['getElementById'](_0x54b568(0x5cd))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x502654),document[_0x54b568(0x89d)]('copy-timestamp-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x2a7688),document[_0x54b568(0x89d)](_0x54b568(0x8f1))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x4df3d8=_0x54b568;_0x17a49c(_0x4df3d8(0x11ac));}),document[_0x54b568(0x89d)](_0x54b568(0xeeb))['addEventListener'](_0x54b568(0x12a5),()=>_0x39f7c8(null)),document[_0x54b568(0x89d)]('save-npc-btn')[_0x54b568(0x1193)]('click',_0xbf8ff6),document[_0x54b568(0x89d)](_0x54b568(0xaf9))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0xbc2f91=_0x54b568;document[_0xbc2f91(0x89d)](_0xbc2f91(0xc71))[_0xbc2f91(0x2f1)][_0xbc2f91(0x1247)](_0xbc2f91(0x11e4));}),document[_0x54b568(0x89d)]('npc-avatar-input')['addEventListener'](_0x54b568(0x76c),_0x170bfb=>{const _0x35a33e=_0x54b568,_0x16b7e8=_0x170bfb[_0x35a33e(0x225)][_0x35a33e(0x541)][0x0];if(_0x16b7e8){const _0x10cce9=new FileReader();_0x10cce9[_0x35a33e(0x736)]=_0xa58d1=>{const _0x34429e=_0x35a33e;document[_0x34429e(0x89d)](_0x34429e(0x128f))['src']=_0xa58d1['target'][_0x34429e(0x9dc)];},_0x10cce9[_0x35a33e(0x5b4)](_0x16b7e8);}}),document[_0x54b568(0x89d)](_0x54b568(0x337))['addEventListener'](_0x54b568(0x12a5),_0x55ea9f=>{if(_0x55ea9f['target']['id']==='spectator-reroll-btn')_0x4e653b();else _0x55ea9f['target']['id']==='spectator-edit-btn'&&_0xe23b1b();}),_0xefe9e2(document['getElementById'](_0x54b568(0xd04)),()=>{const _0x331fb7=_0x54b568;_0x1f2ed8[_0x331fb7(0x602)]>-0x1&&_0x124c87(_0x1f2ed8[_0x331fb7(0x602)]);}),document[_0x54b568(0x89d)](_0x54b568(0x718))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x4542e9),document[_0x54b568(0x89d)](_0x54b568(0xecd))['addEventListener']('click',_0x5086ab),document['getElementById']('cancel-douban-settings-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x105764=_0x54b568;document[_0x105764(0x89d)](_0x105764(0x554))[_0x105764(0x2f1)][_0x105764(0x1247)](_0x105764(0x11e4));}),document[_0x54b568(0x89d)]('time-zone-search-input')['addEventListener'](_0x54b568(0x104f),_0x5a8cdf=>{const _0x98e32b=_0x54b568,_0x16c1b8=_0x5a8cdf['target']['value'][_0x98e32b(0x124b)](),_0x4d90f0=document['getElementById'](_0x98e32b(0x8dc));for(const _0x110cd1 of _0x4d90f0['options']){const _0x3d1737=_0x110cd1[_0x98e32b(0xf12)][_0x98e32b(0x124b)]();_0x3d1737[_0x98e32b(0xced)](_0x16c1b8)?_0x110cd1[_0x98e32b(0x68e)][_0x98e32b(0x126b)]='':_0x110cd1[_0x98e32b(0x68e)][_0x98e32b(0x126b)]='none';}}),window['openWerewolfLobby']=_0x3a2507,document[_0x54b568(0x89d)](_0x54b568(0x92f))[_0x54b568(0x1193)]('click',()=>_0x3a2507(_0x54b568(0x39f))),document[_0x54b568(0x89d)](_0x54b568(0x1066))[_0x54b568(0x1193)]('click',()=>{const _0xc992b4=_0x54b568;document['getElementById']('werewolf-lobby-modal')[_0xc992b4(0x2f1)][_0xc992b4(0x1247)](_0xc992b4(0x11e4));}),document['getElementById'](_0x54b568(0x436))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x243672),document[_0x54b568(0x89d)](_0x54b568(0x10c0))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x8bf5f8=_0x54b568;document[_0x8bf5f8(0x89d)](_0x8bf5f8(0xa33))[_0x8bf5f8(0x2f1)][_0x8bf5f8(0x1247)](_0x8bf5f8(0x11e4)),_0x36c121();}),document[_0x54b568(0x89d)](_0x54b568(0xe0d))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x26f7fc=_0x54b568,_0x3574e7=await _0x4e2abc(_0x26f7fc(0x4a4),'确定要退出当前这局狼人杀吗？游戏进度将不会被保存。',{'confirmButtonClass':'btn-danger'});_0x3574e7&&(_0x42920c[_0x26f7fc(0xfcb)]=![],_0x4e6c15(_0x42920c[_0x26f7fc(0x94d)]?_0x26f7fc(0x87f):_0x26f7fc(0xc0c)));}),document['getElementById'](_0x54b568(0x9f7))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x22e3b7=_0x54b568;document[_0x22e3b7(0x89d)]('werewolf-game-over-modal')[_0x22e3b7(0x2f1)][_0x22e3b7(0x1247)](_0x22e3b7(0x11e4)),_0x4e6c15(_0x42920c['chatId']?'chat-list-screen':_0x22e3b7(0xc0c));}),document['getElementById'](_0x54b568(0x1358))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0xbb504d=_0x54b568;document['getElementById'](_0xbb504d(0x47f))[_0xbb504d(0x2f1)][_0xbb504d(0x1247)]('visible');}),document['getElementById'](_0x54b568(0x1066))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x38d5d0=_0x54b568;document['getElementById']('werewolf-lobby-modal')[_0x38d5d0(0x2f1)][_0x38d5d0(0x1247)](_0x38d5d0(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0x6c1))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x10fc16),document['getElementById']('manual-werewolf-summary-btn')[_0x54b568(0x1193)]('click',_0x3f146d),document[_0x54b568(0x89d)](_0x54b568(0x30f))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x13b202),document[_0x54b568(0x89d)](_0x54b568(0xc5b))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0xbc2a8),document[_0x54b568(0x89d)](_0x54b568(0x1124))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x33eb0a=_0x54b568;document[_0x33eb0a(0x89d)](_0x33eb0a(0xc4e))['classList'][_0x33eb0a(0x1247)](_0x33eb0a(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0xd08))['addEventListener']('click',_0x2d67fe),document[_0x54b568(0x89d)](_0x54b568(0xc4e))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x5cf05b=>{const _0x1d01ed=_0x54b568,_0x7049de=_0x5cf05b[_0x1d01ed(0x225)]['closest']('.clear-posts-item');_0x7049de&&_0x7049de[_0x1d01ed(0x2f1)][_0x1d01ed(0x73b)](_0x1d01ed(0x335));if(_0x5cf05b[_0x1d01ed(0x225)]['id']===_0x1d01ed(0x7f1)){const _0x1e69d8=_0x5cf05b[_0x1d01ed(0x225)][_0x1d01ed(0x1b0)];document['querySelectorAll'](_0x1d01ed(0x54d))[_0x1d01ed(0xd9a)](_0x1af499=>{const _0x23bc59=_0x1d01ed;_0x1af499[_0x23bc59(0x2f1)][_0x23bc59(0x73b)]('selected',_0x1e69d8);});}}),document[_0x54b568(0x89d)](_0x54b568(0x68f))[_0x54b568(0x1193)](_0x54b568(0x104f),()=>{_0x1e547a(![]);}),document[_0x54b568(0x89d)](_0x54b568(0xee5))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x1d8b62=>{const _0x160e36=_0x54b568;if(_0x1d8b62[_0x160e36(0x225)]['classList'][_0x160e36(0x3ff)](_0x160e36(0x63e))){const _0x8f4017=_0x1d8b62[_0x160e36(0x225)][_0x160e36(0xaaf)][_0x160e36(0xcb1)],_0x321270=_0x8f4017!==_0x160e36(0x863)&&_0x8f4017!==_0x160e36(0x67a)?parseInt(_0x8f4017):_0x8f4017;document['getElementById'](_0x160e36(0x68f))[_0x160e36(0x2f4)]='',_0x41c302(_0x321270);}});const _0x109098=document['getElementById'](_0x54b568(0x116e));_0x109098[_0x54b568(0x1193)]('scroll',()=>{const _0x2ef083=_0x54b568;if(_0x109098[_0x2ef083(0xb0e)]<0x1&&!_0x456197){const _0xbbb99b=_0x5b873d['chats'][_0x5b873d['activeChatId']]?.[_0x2ef083(0x551)][_0x2ef083(0x7aa)]||0x0;_0xbbb99b>_0x3def71&&_0x474038();}});const _0x2fdebc=document[_0x54b568(0x89d)](_0x54b568(0x809));_0x2fdebc[_0x54b568(0x1193)](_0x54b568(0x62b),()=>{const _0x2ff953=_0x54b568,{scrollTop:_0x90fe3,scrollHeight:_0x550b48,clientHeight:_0x51bcff}=_0x2fdebc;if(_0x550b48-_0x90fe3<=_0x51bcff+0x32&&!_0x4177cd){const _0x10da07=_0x5b873d['chats'][_0x5b873d[_0x2ff953(0xf96)]]?.[_0x2ff953(0x1152)][_0x2ff953(0x7aa)]||0x0;_0x10da07>_0x59fed2&&_0x113155();}});const _0x36ea3e=document[_0x54b568(0xd16)]('#qzone-screen\x20.qzone-content');_0x36ea3e['addEventListener'](_0x54b568(0x62b),()=>{const _0x2ef869=_0x54b568,{scrollTop:_0x3b6798,scrollHeight:_0x25b61e,clientHeight:_0x618b3a}=_0x36ea3e;_0x25b61e-_0x3b6798<=_0x618b3a+0x64&&!_0x34a523&&(_0xbd77bc[_0x2ef869(0x7aa)]>_0x4cbc61&&_0xbf271b());}),document[_0x54b568(0x89d)](_0x54b568(0x1348))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x8788e);const _0x4198c6=document['getElementById']('reading-restore-btn');_0xac139e(_0x4198c6,_0x4198c6),document[_0x54b568(0x89d)](_0x54b568(0x39e))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x4ed3f0),document[_0x54b568(0x89d)](_0x54b568(0xae9))[_0x54b568(0x1193)]('click',_0x17af5),document['getElementById']('next-page-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0xa63197),document['getElementById'](_0x54b568(0xdeb))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x1834ac),document[_0x54b568(0x89d)]('book-upload-input')[_0x54b568(0x1193)](_0x54b568(0x76c),_0x1854a),document['getElementById'](_0x54b568(0x399))[_0x54b568(0x1193)]('click',_0x3ed521),document[_0x54b568(0x89d)](_0x54b568(0x12e6))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x1ea546),_0xac139e(document['getElementById'](_0x54b568(0x4ee)),document[_0x54b568(0xd16)](_0x54b568(0xa08))),document[_0x54b568(0x89d)](_0x54b568(0xae9))['addEventListener'](_0x54b568(0x12a5),_0x17af5),document[_0x54b568(0x89d)](_0x54b568(0x3d2))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x278586=_0x54b568;document[_0x278586(0x89d)](_0x278586(0x1a9))[_0x278586(0x2f1)][_0x278586(0x1247)](_0x278586(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0x12b4))[_0x54b568(0x1193)]('click',_0x2a2d03),document['getElementById']('reading-library-list')[_0x54b568(0x1193)]('click',_0x5bd0d6=>{const _0x5ac855=_0x54b568,_0x4054b7=_0x5bd0d6['target'];if(_0x4054b7[_0x5ac855(0x2f1)][_0x5ac855(0x3ff)]('group-name')){const _0x2ec7bf=parseInt(_0x4054b7[_0x5ac855(0xaaf)][_0x5ac855(0x11cc)]);_0x8eac59(_0x2ec7bf);}else{if(_0x4054b7['classList'][_0x5ac855(0x3ff)](_0x5ac855(0x126d))){const _0x48efd0=parseInt(_0x4054b7[_0x5ac855(0xaaf)]['bookId']);_0x4ae83c(_0x48efd0);}}}),document[_0x54b568(0x89d)](_0x54b568(0x23d))['addEventListener']('click',_0x453a00),document[_0x54b568(0x89d)](_0x54b568(0x5a2))[_0x54b568(0x1193)](_0x54b568(0x104f),_0x2801d9=>{const _0x83fa=_0x54b568;_0x261968(_0x2801d9[_0x83fa(0x225)][_0x83fa(0x2f4)]);});const _0x92755e=_0x31ad99(_0x477252,0x12c);document[_0x54b568(0x89d)](_0x54b568(0x951))[_0x54b568(0x1193)]('scroll',_0x92755e),document[_0x54b568(0x89d)](_0x54b568(0xb77))[_0x54b568(0x1193)](_0x54b568(0x104f),_0x133f5b=>{const _0x2e3039=_0x54b568;document[_0x2e3039(0x89d)]('api-temperature-value')['textContent']=_0x133f5b[_0x2e3039(0x225)]['value'];});const _0x408234=document[_0x54b568(0x89d)]('messages-view');_0x408234['addEventListener'](_0x54b568(0x62b),()=>{const {scrollTop:_0x10f61a,scrollHeight:_0x53809f,clientHeight:_0x4d7128}=_0x408234;_0x53809f-_0x10f61a<=_0x4d7128+0x96&&!_0x58ae48&&_0x3dd421();}),document[_0x54b568(0x89d)]('manage-product-categories-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x4209ee),document[_0x54b568(0x89d)](_0x54b568(0xdbc))['addEventListener'](_0x54b568(0x12a5),()=>{const _0x253433=_0x54b568;document[_0x253433(0x89d)](_0x253433(0x996))['classList']['remove'](_0x253433(0x11e4)),_0x4bdf9e(_0x34a863);}),document[_0x54b568(0x89d)](_0x54b568(0x237))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x8044c),document[_0x54b568(0x89d)](_0x54b568(0x458))[_0x54b568(0x1193)]('click',_0x392ad8=>{const _0x2c9d87=_0x54b568;_0x392ad8[_0x2c9d87(0x225)][_0x2c9d87(0x2f1)][_0x2c9d87(0x3ff)](_0x2c9d87(0x126d))&&_0x480a54(parseInt(_0x392ad8[_0x2c9d87(0x225)][_0x2c9d87(0xaaf)]['id']));}),document[_0x54b568(0x89d)]('add-product-variation-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>_0x455dc1()),document[_0x54b568(0x89d)]('cancel-variation-selection-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x4f4511=_0x54b568;document[_0x4f4511(0x89d)](_0x4f4511(0xd26))[_0x4f4511(0x2f1)][_0x4f4511(0x1247)](_0x4f4511(0x11e4));}),document[_0x54b568(0x89d)](_0x54b568(0x12eb))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x320dd5=_0x54b568,_0x52895c=document[_0x320dd5(0x89d)](_0x320dd5(0x1362));let _0xce33c8=parseInt(_0x52895c[_0x320dd5(0xf12)]);if(_0xce33c8>0x1)_0x52895c['textContent']=_0xce33c8-0x1;}),document[_0x54b568(0x89d)]('variation-increase-qty')['addEventListener'](_0x54b568(0x12a5),()=>{const _0x293bfb=_0x54b568,_0x4e87e7=document[_0x293bfb(0x89d)]('variation-quantity-display');_0x4e87e7[_0x293bfb(0xf12)]=parseInt(_0x4e87e7['textContent'])+0x1;}),document[_0x54b568(0x89d)](_0x54b568(0x364))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0xf6e9a4=>{const _0x43755c=_0x54b568;if(_0xf6e9a4['target'][_0x43755c(0x2f1)][_0x43755c(0x3ff)]('product-category-tab')){const _0x3ee766=_0xf6e9a4[_0x43755c(0x225)][_0x43755c(0xaaf)]['categoryId']==='all'?_0x43755c(0x863):parseInt(_0xf6e9a4[_0x43755c(0x225)][_0x43755c(0xaaf)][_0x43755c(0xcb1)]);_0x4aa7d7(_0x3ee766);}}),document[_0x54b568(0x89d)]('generate-shopping-items-btn')['addEventListener']('click',_0x3b7c26),document[_0x54b568(0x89d)]('shopping-settings-btn')[_0x54b568(0x1193)]('click',_0x4d916b),document[_0x54b568(0x89d)]('save-shopping-settings-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x36944a),document[_0x54b568(0x89d)](_0x54b568(0x7d0))['addEventListener']('click',()=>{const _0x14b184=_0x54b568;document[_0x14b184(0x89d)](_0x14b184(0xa81))[_0x14b184(0x2f1)][_0x14b184(0x1247)](_0x14b184(0x11e4));}),document['getElementById'](_0x54b568(0x542))[_0x54b568(0x1193)]('change',_0x501e47=>{const _0x3f5b1c=_0x54b568,_0x423f35=_0x501e47[_0x3f5b1c(0x225)][_0x3f5b1c(0x1b0)],_0x53a148=document[_0x3f5b1c(0x35f)](_0x3f5b1c(0x1134));_0x53a148[_0x3f5b1c(0xd9a)](_0x1ed838=>{const _0x28847a=_0x3f5b1c,_0x5e9d79=parseInt(_0x1ed838[_0x28847a(0xaaf)]['id']);_0x1ed838[_0x28847a(0x2f1)]['toggle'](_0x28847a(0x335),_0x423f35),_0x423f35?_0x512a2b['add'](_0x5e9d79):_0x512a2b[_0x28847a(0x684)](_0x5e9d79);}),document[_0x3f5b1c(0x89d)](_0x3f5b1c(0x459))[_0x3f5b1c(0xf12)]='删除\x20('+_0x512a2b[_0x3f5b1c(0x746)]+')';}),document['getElementById'](_0x54b568(0x459))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x4b6684=_0x54b568;if(_0x512a2b['size']===0x0){alert('请先选择要删除的商品。');return;}const _0x57261c=await _0x4e2abc(_0x4b6684(0x3da),'确定要永久删除选中的\x20'+_0x512a2b[_0x4b6684(0x746)]+_0x4b6684(0x9df),{'confirmButtonClass':_0x4b6684(0xcd8)});_0x57261c&&(await _0x1a6951['shoppingProducts'][_0x4b6684(0x6a7)]([..._0x512a2b]),document[_0x4b6684(0x89d)](_0x4b6684(0xb41))[_0x4b6684(0x12a5)](),await _0xdeaaf2(),await _0x532f76('成功',_0x4b6684(0xd5d)));}),document[_0x54b568(0x89d)](_0x54b568(0x1173))[_0x54b568(0x1193)](_0x54b568(0x76c),_0x329cad),document[_0x54b568(0x89d)](_0x54b568(0x2ec))[_0x54b568(0x1193)]('click',_0x25b915),document[_0x54b568(0x89d)](_0x54b568(0xb0f))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x5f8843),document['getElementById'](_0x54b568(0x401))['addEventListener']('change',_0x5136bf=>{const _0xcca27b=_0x54b568,_0x3967bd=document[_0xcca27b(0x89d)](_0xcca27b(0x444));_0x3967bd[_0xcca27b(0x68e)][_0xcca27b(0x126b)]=_0x5136bf['target'][_0xcca27b(0x1b0)]?'block':_0xcca27b(0x10f2);}),document['getElementById'](_0x54b568(0x120a))[_0x54b568(0x1193)](_0x54b568(0x12a5),function(){const _0x59dd21=_0x54b568,_0x459d81=document['getElementById'](_0x59dd21(0xa5d));_0x459d81[_0x59dd21(0x48c)]===_0x59dd21(0x428)?(_0x459d81[_0x59dd21(0x48c)]=_0x59dd21(0xec9),this['textContent']='😌'):(_0x459d81[_0x59dd21(0x48c)]=_0x59dd21(0x428),this[_0x59dd21(0xf12)]='🧐');}),document[_0x54b568(0x89d)](_0x54b568(0x6d2))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x35b3e1=_0x54b568;_0x12d819(),document[_0x35b3e1(0x89d)](_0x35b3e1(0xe37))[_0x35b3e1(0x68e)][_0x35b3e1(0x126b)]=_0x35b3e1(0x66e);}),document['getElementById'](_0x54b568(0x320))['addEventListener'](_0x54b568(0x76c),_0x934d54=>{const _0x532d15=_0x54b568,_0x4fd3cd=document['getElementById']('nai-custom-proxy-group');_0x934d54[_0x532d15(0x225)][_0x532d15(0x2f4)]===_0x532d15(0xb8f)?_0x4fd3cd[_0x532d15(0x68e)]['display']=_0x532d15(0x1118):_0x4fd3cd[_0x532d15(0x68e)][_0x532d15(0x126b)]='none';}),document[_0x54b568(0x89d)](_0x54b568(0xaf3))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x52092d=_0x54b568;document[_0x52092d(0x89d)](_0x52092d(0xe37))['style'][_0x52092d(0x126b)]=_0x52092d(0x10f2);}),document[_0x54b568(0x89d)](_0x54b568(0x11e0))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x1b2ba4=_0x54b568;_0x485c97(),document[_0x1b2ba4(0x89d)](_0x1b2ba4(0xe37))[_0x1b2ba4(0x68e)][_0x1b2ba4(0x126b)]=_0x1b2ba4(0x10f2),alert(_0x1b2ba4(0x1256));}),document[_0x54b568(0x89d)](_0x54b568(0x6b8))[_0x54b568(0x1193)]('click',()=>{const _0x597405=_0x54b568;confirm(_0x597405(0x5f8))&&_0x1f3b99();}),document[_0x54b568(0x89d)](_0x54b568(0xa77))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x2cb5f4=_0x54b568,_0x3a7a04=document[_0x2cb5f4(0x89d)](_0x2cb5f4(0xa5d))[_0x2cb5f4(0x2f4)][_0x2cb5f4(0xc3a)]();if(!_0x3a7a04){alert(_0x2cb5f4(0x1072));return;}document['getElementById'](_0x2cb5f4(0x3ed))['style'][_0x2cb5f4(0x126b)]=_0x2cb5f4(0x66e),document[_0x2cb5f4(0x89d)](_0x2cb5f4(0x114c))[_0x2cb5f4(0x68e)]['display']='none',document[_0x2cb5f4(0x89d)]('nai-test-error')[_0x2cb5f4(0x68e)][_0x2cb5f4(0x126b)]=_0x2cb5f4(0x10f2);}),document[_0x54b568(0x89d)](_0x54b568(0xcd3))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x5b9649=_0x54b568;document[_0x5b9649(0x89d)](_0x5b9649(0x3ed))['style'][_0x5b9649(0x126b)]=_0x5b9649(0x10f2);}),document[_0x54b568(0x89d)]('close-nai-test-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x70ef93=_0x54b568;document[_0x70ef93(0x89d)](_0x70ef93(0x3ed))[_0x70ef93(0x68e)][_0x70ef93(0x126b)]='none';}),document[_0x54b568(0x89d)](_0x54b568(0x1218))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{await _0x1c4840();}),document['getElementById']('nai-download-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x5cf49d=_0x54b568,_0x3b8e1a=document[_0x5cf49d(0x89d)](_0x5cf49d(0xee6)),_0xa2064d=document[_0x5cf49d(0x285)]('a');_0xa2064d[_0x5cf49d(0xab6)]=_0x3b8e1a[_0x5cf49d(0x9e3)],_0xa2064d[_0x5cf49d(0xb93)]=_0x5cf49d(0x8fa)+Date['now']()+_0x5cf49d(0x6c6),_0xa2064d[_0x5cf49d(0x12a5)]();}),document[_0x54b568(0x89d)](_0x54b568(0x870))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x3eb144=_0x54b568;if(!_0x5b873d[_0x3eb144(0xf96)])return;const _0x4054f2=_0x5b873d['chats'][_0x5b873d['activeChatId']],_0x43609d=_0x4054f2[_0x3eb144(0xdb9)]['naiSettings']||{'promptSource':'system','characterPositivePrompt':'','characterNegativePrompt':''};document[_0x3eb144(0x89d)](_0x3eb144(0xe46))['value']=_0x43609d[_0x3eb144(0x10f8)]||'',document[_0x3eb144(0x89d)](_0x3eb144(0x1329))['value']=_0x43609d[_0x3eb144(0xa5e)]||'',document['getElementById'](_0x3eb144(0xef5))[_0x3eb144(0x68e)][_0x3eb144(0x126b)]='flex';}),document[_0x54b568(0x89d)](_0x54b568(0x864))[_0x54b568(0x1193)]('click',()=>{const _0x581265=_0x54b568;document['getElementById'](_0x581265(0xef5))[_0x581265(0x68e)][_0x581265(0x126b)]=_0x581265(0x10f2);}),document[_0x54b568(0x89d)](_0x54b568(0x658))[_0x54b568(0x1193)](_0x54b568(0x12a5),async()=>{const _0x328ff5=_0x54b568;if(!_0x5b873d['activeChatId'])return;const _0x568acc=_0x5b873d[_0x328ff5(0x667)][_0x5b873d[_0x328ff5(0xf96)]];!_0x568acc['settings'][_0x328ff5(0x129a)]&&(_0x568acc['settings']['naiSettings']={'promptSource':'system'}),_0x568acc['settings'][_0x328ff5(0x129a)][_0x328ff5(0x10f8)]=document[_0x328ff5(0x89d)]('character-nai-positive')[_0x328ff5(0x2f4)]['trim'](),_0x568acc[_0x328ff5(0xdb9)]['naiSettings'][_0x328ff5(0xa5e)]=document[_0x328ff5(0x89d)](_0x328ff5(0x1329))[_0x328ff5(0x2f4)][_0x328ff5(0xc3a)](),console[_0x328ff5(0x471)](_0x328ff5(0x558)),console['log']('\x20\x20\x20characterPositivePrompt:',_0x568acc[_0x328ff5(0xdb9)][_0x328ff5(0x129a)]['characterPositivePrompt']),console[_0x328ff5(0x471)](_0x328ff5(0xa07),_0x568acc[_0x328ff5(0xdb9)][_0x328ff5(0x129a)][_0x328ff5(0xa5e)]),console['log'](_0x328ff5(0x7ea),_0x568acc[_0x328ff5(0xdb9)]['naiSettings'][_0x328ff5(0x744)]),await _0x1a6951[_0x328ff5(0x667)]['put'](_0x568acc),document[_0x328ff5(0x89d)](_0x328ff5(0xef5))[_0x328ff5(0x68e)]['display']=_0x328ff5(0x10f2),alert(_0x328ff5(0x43f));}),document[_0x54b568(0x89d)](_0x54b568(0x7bb))['addEventListener'](_0x54b568(0x12a5),()=>{const _0x334485=_0x54b568;confirm(_0x334485(0xb0b))&&(document[_0x334485(0x89d)]('character-nai-positive')['value']='',document[_0x334485(0x89d)](_0x334485(0x1329))[_0x334485(0x2f4)]='');}),document[_0x54b568(0x89d)](_0x54b568(0x10a2))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x4b3b4e=_0x54b568;if(!_0x5b873d['activeChatId'])return;const _0x1e7bab=_0x5b873d[_0x4b3b4e(0x667)][_0x5b873d[_0x4b3b4e(0xf96)]],_0x1566e2=_0x1e7bab[_0x4b3b4e(0xdb9)][_0x4b3b4e(0x129a)]||{'promptSource':'system','characterPositivePrompt':'','characterNegativePrompt':''};document[_0x4b3b4e(0x89d)](_0x4b3b4e(0xe46))['value']=_0x1566e2['characterPositivePrompt']||'',document[_0x4b3b4e(0x89d)]('character-nai-negative')[_0x4b3b4e(0x2f4)]=_0x1566e2['characterNegativePrompt']||'',document[_0x4b3b4e(0x89d)](_0x4b3b4e(0xef5))[_0x4b3b4e(0x68e)][_0x4b3b4e(0x126b)]=_0x4b3b4e(0x66e);}),document['getElementById']('manage-frames-btn')[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x3d8c90),document[_0x54b568(0x89d)]('select-all-frames-checkbox')[_0x54b568(0x1193)](_0x54b568(0x76c),_0x2a52e0),document[_0x54b568(0x89d)](_0x54b568(0x1070))['addEventListener']('click',_0x53942b),document[_0x54b568(0x89d)](_0x54b568(0x1099))[_0x54b568(0x1193)](_0x54b568(0x12a5),_0x1e694a),document[_0x54b568(0x89d)](_0x54b568(0x8a7))[_0x54b568(0x1193)](_0x54b568(0x12a5),()=>{const _0x4eac48=_0x54b568;_0x16d75b(_0x4eac48(0x1327));}),document[_0x54b568(0x89d)](_0x54b568(0x1190))[_0x54b568(0x1193)]('click',_0x239fd4=>{const _0x1a3f4a=_0x54b568,_0x1c97cd=_0x239fd4[_0x1a3f4a(0x225)][_0x1a3f4a(0x53a)](_0x1a3f4a(0x1149));if(_0x1c97cd){const _0x13db7a=_0x1c97cd['querySelector'](_0x1a3f4a(0x7b3));_0x13db7a&&_0x239fd4[_0x1a3f4a(0x225)]!==_0x13db7a&&(_0x13db7a[_0x1a3f4a(0x1b0)]=!_0x13db7a[_0x1a3f4a(0x1b0)]);}});const _0x5b3c8b=document[_0x54b568(0x89d)](_0x54b568(0xee5));_0xefe9e2(_0x5b3c8b,_0x3babda=>{const _0x3c84e0=_0x54b568,_0x4db323=_0x3babda[_0x3c84e0(0x225)][_0x3c84e0(0x53a)](_0x3c84e0(0xf02));if(_0x4db323){_0x3babda[_0x3c84e0(0xd06)]();const _0x3a8b27=_0x4db323[_0x3c84e0(0xaaf)][_0x3c84e0(0xcb1)];if(_0x3a8b27===_0x3c84e0(0x863)){_0x532f76('提示',_0x3c84e0(0x2a3));return;}const _0x5581a5=_0x3a8b27==='uncategorized'?_0x3c84e0(0x67a):parseInt(_0x3a8b27);_0x550126(_0x5581a5);}}),_0x28312f(),_0x4e6c15('home-screen');}_0x217de5();});
