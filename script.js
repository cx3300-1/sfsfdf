const _0x5195a0=_0x42ed;(function(_0x49e2e3,_0x51866d){const _0xcd18d0=_0x42ed,_0x5db866=_0x49e2e3();while(!![]){try{const _0x42304b=parseInt(_0xcd18d0(0x10c3))/0x1+parseInt(_0xcd18d0(0x342))/0x2*(-parseInt(_0xcd18d0(0x58b))/0x3)+-parseInt(_0xcd18d0(0x1343))/0x4*(parseInt(_0xcd18d0(0x128e))/0x5)+-parseInt(_0xcd18d0(0x9cf))/0x6+parseInt(_0xcd18d0(0xfef))/0x7*(parseInt(_0xcd18d0(0xae))/0x8)+parseInt(_0xcd18d0(0x968))/0x9+-parseInt(_0xcd18d0(0xd25))/0xa*(-parseInt(_0xcd18d0(0x5a5))/0xb);if(_0x42304b===_0x51866d)break;else _0x5db866['push'](_0x5db866['shift']());}catch(_0x584914){_0x5db866['push'](_0x5db866['shift']());}}}(_0x821e,0x2deba));const translations={'zh-CN':{'save':'保存','cancel':'取消','confirm':'确定','edit':'编辑','done':'完成','add':'添加','back':'返回','next':_0x5195a0(0xc4c),'close':'关闭','reset':'重置','upload':'上传','send':'发送','manage':'管理','share':'分享','delete':'删除','publish':'发布','refresh':'刷新','search':'搜索','remove':'移除','finish':'结束','details':'详情','settings':'设置','title':'标题','content':'内容','category':'分类','name':'名称','description':'描述','status':'状态','ok':'好的','error':'错误','success':'成功','warning':'警告','loading':_0x5195a0(0x12ff),'processing':_0x5195a0(0xada),'pleaseWait':'请稍候...','languageChangedAlert':_0x5195a0(0x99c),'homeAppQQ':'QQ','homeAppWorldBook':'世界书','homeAppAppearance':_0x5195a0(0x10fc),'homeAppRenderer':_0x5195a0(0x1031),'homeAppApiSettings':'设置','homeAppFont':'字体','homeAppCPhone':_0x5195a0(0x403),'homeAppDouban':'豆瓣','homeAppPreset':'预设','homeAppTutorial':'教程','homeAppWerewolf':'狼人杀','homeAppX':'X','chatListTitle':'消息','navMessages':'消息','navQzone':'动态','navMemories':'回忆','navFavorites':'收藏','navNpcList':_0x5195a0(0xe2),'qzoneTitle':'好友动态','qzoneActionShuoshuo':'说说','qzoneActionPost':'动态','qzoneActionAlbum':'相册','cphoneTitleSelect':_0x5195a0(0x546),'cphoneAppQQ':'QQ','cphoneAppAlbum':'相册','cphoneAppBrowser':'浏览器','cphoneAppTaobao':'淘宝','cphoneAppMemo':_0x5195a0(0x29f),'cphoneAppDiary':'日记','cphoneAppAmap':_0x5195a0(0x5e6),'cphoneAppUsage':'App记录','cphoneAppMusic':'网易云','cphoneAppEphone':'Ephone','cphoneAppFootprints':'足迹','cphoneAlbumTitle':_0x5195a0(0x9b4),'cphoneBrowserTitle':_0x5195a0(0xecc),'cphoneTaobaoTitle':_0x5195a0(0x21a),'cphoneWalletTitle':'钱包','cphoneMemoTitle':'备忘录','cphoneDiaryTitle':'日记','cphoneUsageTitle':_0x5195a0(0x1327),'cphoneMusicTitle':_0x5195a0(0x1322),'cphoneArticleTitle':'文章','cphoneSimulatedChatPlaceholder':_0x5195a0(0x259),'worldBookTitle':_0x5195a0(0x70e),'worldBookEditorTitle':_0x5195a0(0x110a),'worldBookEntryEditorTitle':_0x5195a0(0x270),'worldBookNameLabel':'书名','worldBookCategoryLabel':'分类','worldBookEntriesLabel':_0x5195a0(0xe57),'worldBookAddEntryBtn':_0x5195a0(0x111f),'worldBookNamePlaceholder':_0x5195a0(0x3bd),'worldBookImportTitle':_0x5195a0(0xb30),'presetTitle':'预设','presetEditorTitle':_0x5195a0(0x64b),'presetNameLabel':_0x5195a0(0xb03),'presetCategoryLabel':'分类','presetEntriesLabel':_0x5195a0(0xe57),'presetAddEntryBtn':'[+]\x20添加新条目','tutorialTitle':'教程','apiSettingsTitle':_0x5195a0(0x1f2),'languageLabel':'语言','apiPresetManagement':_0x5195a0(0x2e2),'apiPresetSelectLabel':'选择或切换预设','apiPrimarySettings':_0x5195a0(0x1cf),'apiProxyUrlLabel':'反代地址\x20(不需要添加/v1噢~)','apiKeyLabel':_0x5195a0(0x202),'apiModelLabel':'模型','apiFetchModelsBtn':_0x5195a0(0x12a),'apiSecondarySettings':_0x5195a0(0xd9d),'apiSecondaryProxyUrlLabel':_0x5195a0(0xa25),'apiSecondaryKeyLabel':_0x5195a0(0xbae),'apiSecondaryModelLabel':_0x5195a0(0x3a0),'apiFetchSecondaryModelsBtn':_0x5195a0(0xf0c),'apiBgActivitySettings':_0x5195a0(0xc8c),'apiEnableBgActivityLabel':'启用后台角色活动','apiBgIntervalLabel':'后台活动检测间隔\x20(秒)','apiBlockCooldownLabel':_0x5195a0(0xc17),'apiTtsSettings':_0x5195a0(0xd1),'apiTtsModelLabel':_0x5195a0(0x1310),'apiPerformanceSettings':_0x5195a0(0xe08),'apiChatListRenderWindowLabel':_0x5195a0(0xfb4),'apiChatRenderWindowLabel':_0x5195a0(0xba7),'apiImageGenSettings':_0x5195a0(0x13a7),'apiEnableImageGenLabel':_0x5195a0(0x87c),'apiEnableNovelAILabel':'启用\x20NovelAI\x20图像生成','apiNovelAIModelLabel':_0x5195a0(0xe8a),'apiNovelAIKeyLabel':'NovelAI\x20API\x20Key','apiNovelAIGenSettingsBtn':_0x5195a0(0x9d0),'apiNovelAITestBtn':_0x5195a0(0xf4e),'apiStorageOptimization':_0x5195a0(0x944),'apiCompressImagesBtn':_0x5195a0(0x11bb),'apiSaveAllBtn':_0x5195a0(0xdb4),'apiExportDataBtn':'导出数据','apiImportDataBtn':_0x5195a0(0x947),'apiCleanupDataBtn':_0x5195a0(0x6e0),'apiDeleteWorldBooksBtn':_0x5195a0(0x463),'apiAdvancedCleanupBtn':_0x5195a0(0x135b),'apiCheckAndFixDataBtn':_0x5195a0(0xe24),'chatHeaderOnline':'在线','chatHeaderLongTermMemory':'长期记忆','chatHeaderListenTogether':'一起听','chatHeaderChatSettings':_0x5195a0(0x1e5),'chatSelectionCancel':'取消','chatSelectionScreenshot':_0x5195a0(0xedf),'chatSelectionFavorite':'收藏','chatSelectionShare':'分享','chatSelectionSoftDelete':_0x5195a0(0xe69),'chatSelectionHardDelete':_0x5195a0(0xdec),'chatReplyTo':'回复','chatInputPlaceholder':_0x5195a0(0xfce),'chatWaitForReply':_0x5195a0(0x67f),'appearanceTitle':_0x5195a0(0x10fc),'appearanceSaveAll':_0x5195a0(0x4fc),'fontSettingsTitle':_0x5195a0(0x43f),'fontPresetManagement':_0x5195a0(0xd84),'fontFileUrlLabel':'字体文件URL\x20(.ttf,\x20.otf,\x20.woff等)','fontPreviewLabel':'实时预览','fontPreviewText1':'你好世界\x20Hello\x20World','fontPreviewText2':_0x5195a0(0x9c),'fontSaveAndApply':_0x5195a0(0x661),'fontResetDefault':_0x5195a0(0x32d),'rendererTitle':'渲染规则','rendererEditorTitle':_0x5195a0(0x1361),'rendererCreateTitle':'创建新规则','rendererRuleName':_0x5195a0(0x84b),'rendererBindScope':_0x5195a0(0x35b),'rendererScopeGlobal':'公用\x20(所有角色)','rendererRegex':_0x5195a0(0x6e1),'rendererHtmlTemplate':_0x5195a0(0x1052),'rendererEnableRule':_0x5195a0(0xcbc),'myAlbumTitle':_0x5195a0(0xf80),'albumPhotosTitle':_0x5195a0(0x4e4),'npcEditorTitleAdd':_0x5195a0(0x133),'npcEditorTitleEdit':_0x5195a0(0x1337),'npcAvatarLabel':'NPC\x20头像','npcUploadAvatar':_0x5195a0(0x2a2),'npcNicknameLabel':_0x5195a0(0x9d8),'npcPersonaLabel':_0x5195a0(0x68a),'npcEnableBgActivity':_0x5195a0(0xa84),'npcActionCooldown':'独立行动冷却\x20(分钟)','npcAssociatedChars':_0x5195a0(0x5a7)},'en':{'save':_0x5195a0(0xd11),'cancel':_0x5195a0(0x22f),'confirm':_0x5195a0(0xe6),'edit':_0x5195a0(0x1211),'done':_0x5195a0(0x38f),'add':_0x5195a0(0x877),'back':_0x5195a0(0xe1e),'next':_0x5195a0(0x4c0),'close':_0x5195a0(0xea4),'reset':_0x5195a0(0x1213),'upload':_0x5195a0(0x493),'send':_0x5195a0(0x234),'manage':'Manage','share':_0x5195a0(0x423),'delete':_0x5195a0(0x132d),'publish':_0x5195a0(0xfb0),'refresh':_0x5195a0(0x56e),'search':'Search','remove':'Remove','finish':_0x5195a0(0x124d),'details':_0x5195a0(0x505),'settings':_0x5195a0(0x1390),'title':_0x5195a0(0xef4),'content':'Content','category':'Category','name':'Name','description':_0x5195a0(0x2f4),'status':_0x5195a0(0x9de),'ok':'OK','error':_0x5195a0(0x19b),'success':_0x5195a0(0xf87),'warning':'Warning','loading':_0x5195a0(0x6c4),'processing':_0x5195a0(0x622),'pleaseWait':'Please\x20wait...','languageChangedAlert':_0x5195a0(0x10bf),'homeAppQQ':'QQ','homeAppWorldBook':_0x5195a0(0xc22),'homeAppAppearance':_0x5195a0(0x151),'homeAppRenderer':_0x5195a0(0x1339),'homeAppApiSettings':_0x5195a0(0x1390),'homeAppFont':_0x5195a0(0xc83),'homeAppCPhone':_0x5195a0(0x403),'homeAppDouban':_0x5195a0(0xca9),'homeAppPreset':_0x5195a0(0x12d1),'homeAppTutorial':'Tutorial','homeAppWerewolf':_0x5195a0(0x279),'homeAppX':'X','chatListTitle':_0x5195a0(0xdc7),'navMessages':_0x5195a0(0xdc7),'navQzone':'Moments','navMemories':_0x5195a0(0xe42),'navFavorites':_0x5195a0(0x68f),'navNpcList':_0x5195a0(0xf78),'qzoneTitle':_0x5195a0(0x912),'qzoneActionShuoshuo':_0x5195a0(0x9de),'qzoneActionPost':'Post','qzoneActionAlbum':'Album','cphoneTitleSelect':_0x5195a0(0xeb8),'cphoneAppQQ':'QQ','cphoneAppAlbum':_0x5195a0(0x123e),'cphoneAppBrowser':'Browser','cphoneAppTaobao':_0x5195a0(0x350),'cphoneAppMemo':_0x5195a0(0x1125),'cphoneAppDiary':'Diary','cphoneAppAmap':_0x5195a0(0xd2c),'cphoneAppUsage':_0x5195a0(0x4c9),'cphoneAppMusic':_0x5195a0(0x10c1),'cphoneAppEphone':_0x5195a0(0x1034),'cphoneAppFootprints':'Footprints','cphoneAlbumTitle':_0x5195a0(0x57f),'cphoneBrowserTitle':_0x5195a0(0x12a5),'cphoneTaobaoTitle':_0x5195a0(0xbaa),'cphoneWalletTitle':'Wallet','cphoneMemoTitle':_0x5195a0(0x1125),'cphoneDiaryTitle':_0x5195a0(0x488),'cphoneUsageTitle':_0x5195a0(0xc98),'cphoneMusicTitle':_0x5195a0(0x1398),'cphoneArticleTitle':'Article','cphoneSimulatedChatPlaceholder':_0x5195a0(0x10d3),'worldBookTitle':_0x5195a0(0xc22),'worldBookEditorTitle':_0x5195a0(0x195),'worldBookEntryEditorTitle':_0x5195a0(0x7b2),'worldBookNameLabel':_0x5195a0(0xe2d),'worldBookCategoryLabel':_0x5195a0(0xb58),'worldBookEntriesLabel':'Content\x20Entries','worldBookAddEntryBtn':_0x5195a0(0x40e),'worldBookNamePlaceholder':_0x5195a0(0x8b5),'worldBookImportTitle':_0x5195a0(0xe29),'presetTitle':_0x5195a0(0x12d1),'presetEditorTitle':'Edit\x20Preset','presetNameLabel':_0x5195a0(0x3b3),'presetCategoryLabel':_0x5195a0(0xb58),'presetEntriesLabel':_0x5195a0(0x442),'presetAddEntryBtn':_0x5195a0(0x40e),'tutorialTitle':_0x5195a0(0x103),'apiSettingsTitle':_0x5195a0(0xbf4),'languageLabel':_0x5195a0(0x116),'apiPresetManagement':_0x5195a0(0xb6c),'apiPresetSelectLabel':'Select\x20or\x20Switch\x20Preset','apiPrimarySettings':_0x5195a0(0x5cd),'apiProxyUrlLabel':_0x5195a0(0xbd2),'apiKeyLabel':_0x5195a0(0xf0),'apiModelLabel':'Model','apiFetchModelsBtn':_0x5195a0(0x4d1),'apiSecondarySettings':_0x5195a0(0xbb9),'apiSecondaryProxyUrlLabel':_0x5195a0(0x1c9),'apiSecondaryKeyLabel':_0x5195a0(0x11ea),'apiSecondaryModelLabel':'Secondary\x20Model','apiFetchSecondaryModelsBtn':_0x5195a0(0x1e9),'apiTemperatureLabel':_0x5195a0(0xc62),'apiBgActivitySettings':_0x5195a0(0x9e6),'apiEnableBgActivityLabel':_0x5195a0(0x465),'apiBgIntervalLabel':_0x5195a0(0x54f),'apiBlockCooldownLabel':_0x5195a0(0x818),'apiTtsSettings':'Voice\x20Message\x20Settings\x20(Minimax\x20TTS)','apiTtsModelLabel':'Voice\x20Model','apiPerformanceSettings':_0x5195a0(0x74c),'apiChatListRenderWindowLabel':_0x5195a0(0x1cd),'apiChatRenderWindowLabel':_0x5195a0(0x1247),'apiImageGenSettings':'Image\x20Generation\x20Settings','apiEnableImageGenLabel':'Enable\x20AI\x20Image\x20Generation','apiEnableNovelAILabel':_0x5195a0(0x12e3),'apiNovelAIModelLabel':_0x5195a0(0xb82),'apiNovelAIKeyLabel':'NovelAI\x20API\x20Key','apiNovelAIGenSettingsBtn':_0x5195a0(0xb1d),'apiNovelAITestBtn':'Test\x20Generation','apiStorageOptimization':_0x5195a0(0xc53),'apiCompressImagesBtn':_0x5195a0(0xf32),'apiSaveAllBtn':_0x5195a0(0xc44),'apiExportDataBtn':_0x5195a0(0xb21),'apiImportDataBtn':_0x5195a0(0x766),'apiCleanupDataBtn':_0x5195a0(0x3a7),'apiDeleteWorldBooksBtn':_0x5195a0(0x2bc),'apiAdvancedCleanupBtn':'Advanced\x20Data\x20Cleanup','apiCheckAndFixDataBtn':_0x5195a0(0x642),'chatHeaderOnline':'Online','chatHeaderLongTermMemory':_0x5195a0(0x979),'chatHeaderListenTogether':'Listen\x20Together','chatHeaderChatSettings':'Chat\x20Settings','chatSelectionCancel':_0x5195a0(0x22f),'chatSelectionScreenshot':_0x5195a0(0xc7d),'chatSelectionFavorite':_0x5195a0(0x1290),'chatSelectionShare':_0x5195a0(0x423),'chatSelectionSoftDelete':_0x5195a0(0xcf5),'chatSelectionHardDelete':_0x5195a0(0x576),'chatReplyTo':'Reply\x20to','chatInputPlaceholder':'Type\x20a\x20message...','chatWaitForReply':_0x5195a0(0xba9),'appearanceTitle':_0x5195a0(0xceb),'appearanceSaveAll':_0x5195a0(0x1377),'fontSettingsTitle':_0x5195a0(0xa6f),'fontPresetManagement':'Font\x20Preset\x20Management','fontFileUrlLabel':'Font\x20File\x20URL\x20(.ttf,\x20.otf,\x20.woff,\x20etc.)','fontPreviewLabel':_0x5195a0(0x706),'fontPreviewText1':'Hello\x20World\x20你好世界','fontPreviewText2':_0x5195a0(0x11c7),'fontSaveAndApply':_0x5195a0(0xe4b),'fontResetDefault':_0x5195a0(0xf04),'rendererTitle':_0x5195a0(0xd26),'rendererEditorTitle':_0x5195a0(0x863),'rendererCreateTitle':'Create\x20New\x20Rule','rendererRuleName':_0x5195a0(0xa91),'rendererBindScope':_0x5195a0(0xbbb),'rendererScopeGlobal':_0x5195a0(0xb79),'rendererRegex':_0x5195a0(0xcd6),'rendererHtmlTemplate':'HTML\x20Template\x20(use\x20$1,\x20$2)','rendererEnableRule':'Enable\x20Rule','myAlbumTitle':_0x5195a0(0x786),'albumPhotosTitle':_0x5195a0(0x847),'npcEditorTitleAdd':_0x5195a0(0x491),'npcEditorTitleEdit':'Edit\x20NPC','npcAvatarLabel':'NPC\x20Avatar','npcUploadAvatar':_0x5195a0(0x38d),'npcNicknameLabel':_0x5195a0(0x156),'npcPersonaLabel':_0x5195a0(0x6e3),'npcEnableBgActivity':_0x5195a0(0x85d),'npcActionCooldown':_0x5195a0(0x3a9),'npcAssociatedChars':'Associated\x20Characters\x20(NPC\x20will\x20comment\x20on\x20their\x20moments)'}};function _0x42ed(_0x3da450,_0x85b94){const _0x821e06=_0x821e();return _0x42ed=function(_0x42ed4c,_0x5562a1){_0x42ed4c=_0x42ed4c-0x8d;let _0x533ed7=_0x821e06[_0x42ed4c];return _0x533ed7;},_0x42ed(_0x3da450,_0x85b94);}let currentLanguage=_0x5195a0(0xafb);function setLanguage(_0x44c6ae){const _0x34bdde=_0x5195a0;!translations[_0x44c6ae]&&(console['warn'](_0x34bdde(0x90b)+_0x44c6ae+_0x34bdde(0xe7e)),_0x44c6ae=_0x34bdde(0xafb)),currentLanguage=_0x44c6ae,localStorage[_0x34bdde(0x16a)]('ephone-language',_0x44c6ae),document['documentElement']['lang']=_0x44c6ae,document[_0x34bdde(0x400)](_0x34bdde(0xfc3))[_0x34bdde(0x19c)](_0x293b0b=>{const _0x12b267=_0x34bdde,_0x5775a2=_0x293b0b[_0x12b267(0x8a9)](_0x12b267(0x829));translations[_0x44c6ae][_0x5775a2]&&(_0x293b0b[_0x12b267(0x138e)]=translations[_0x44c6ae][_0x5775a2]);}),document[_0x34bdde(0x400)](_0x34bdde(0xd34))[_0x34bdde(0x19c)](_0x1bb762=>{const _0x5410f8=_0x34bdde,_0x5d41c4=_0x1bb762[_0x5410f8(0x8a9)]('data-lang-key-placeholder');translations[_0x44c6ae][_0x5d41c4]&&(_0x1bb762['placeholder']=translations[_0x44c6ae][_0x5d41c4]);}),document['querySelectorAll'](_0x34bdde(0x9b8))['forEach'](_0x151b9c=>{const _0x48f007=_0x34bdde,_0xce75b=_0x151b9c[_0x48f007(0x8a9)](_0x48f007(0xc03));translations[_0x44c6ae][_0xce75b]&&(_0x151b9c[_0x48f007(0xf3a)]=translations[_0x44c6ae][_0xce75b]);});}function initLanguage(){const _0x188e1b=_0x5195a0,_0x4f82c1=localStorage[_0x188e1b(0xb2)](_0x188e1b(0xc5d))||_0x188e1b(0xafb),_0x4ef976=document['getElementById']('language-select');_0x4ef976&&(_0x4ef976[_0x188e1b(0x1be)]=_0x4f82c1,_0x4ef976[_0x188e1b(0x271)](_0x188e1b(0x173),_0x271d81=>{const _0x41b1dd=_0x188e1b,_0x54927c=_0x271d81['target']['value'];alert(translations[_0x54927c]['languageChangedAlert']),localStorage[_0x41b1dd(0x16a)]('ephone-language',_0x54927c),setTimeout(()=>window[_0x41b1dd(0x130c)][_0x41b1dd(0x114a)](),0x64);})),setLanguage(_0x4f82c1);}'serviceWorker'in navigator&&window[_0x5195a0(0x271)]('load',()=>{const _0x48fa13=_0x5195a0;navigator[_0x48fa13(0x1271)][_0x48fa13(0xbd6)](_0x48fa13(0x680))[_0x48fa13(0x1c1)](_0x35885c=>{const _0xa0e677=_0x48fa13;console[_0xa0e677(0xe72)]('ServiceWorker\x20注册成功，作用域为:\x20',_0x35885c[_0xa0e677(0xafe)]);})[_0x48fa13(0xa27)](_0x304ac9=>{const _0x1b960=_0x48fa13;console[_0x1b960(0xe72)](_0x1b960(0x68d),_0x304ac9);});});!Array[_0x5195a0(0xfcb)][_0x5195a0(0xdef)]&&Object['defineProperty'](Array['prototype'],_0x5195a0(0xdef),{'value':function(_0xafa04){const _0x523532=_0x5195a0;if(this==null)throw new TypeError(_0x523532(0x153));if(typeof _0xafa04!==_0x523532(0x6a0))throw new TypeError(_0x523532(0x1008));let _0x3a4b5d=Object(this),_0x2d1033=_0x3a4b5d[_0x523532(0xfde)]>>>0x0,_0x57154c=arguments[0x1],_0x4f60d6=_0x2d1033-0x1;while(_0x4f60d6>=0x0){let _0x428c4b=_0x3a4b5d[_0x4f60d6];if(_0xafa04[_0x523532(0x977)](_0x57154c,_0x428c4b,_0x4f60d6,_0x3a4b5d))return _0x4f60d6;_0x4f60d6--;}return-0x1;},'configurable':!![],'writable':!![]});let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],currentQzoneReplyContext=null,editingNpcId=null;function _0x821e(){const _0x5d4a05=['memory-list-container','[V]','https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','无缓存，正在请求\x20Minimax\x20TTS\x20API...','保存成功','confirm-final-clear-btn','totalBalance','用户已忽略版本:\x20','remove','<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','pat-btn','TA的歌单','</name>\x0a\x20\x20<persona>','my-avatar-preview','AI已将新头像命名为：“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','App使用记录','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','doubanPosts','readAsDataURL','\x20\x20-\x20你评论说:\x20','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','Delete','font-url-input','repost-comment-input','preview-bubble-style','\x0a#\x20可用表情包\x20(优先使用)\x0a每个AI角色都被设置了专属表情包，在需要发送表情时，他们应该【优先】从自己的专属列表中选择。尽量让你的表情丰富多样，避免重复。\x0a','图片解压失败:\x20','小时前','\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“','已撤回的消息','https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','编辑\x20NPC','mouseup','Renderer','https://i.postimg.cc/43PhvxRq/IMG-6922.gif','member-management-item','likes','容错解析：策略3成功\x20(将整个返回文本作为摘要)','char-memo-detail-content','确定要删除这张照片吗？此操作不可恢复。','该消息发送已超过2分钟，无法撤回。','send-direct-packet-btn','https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','56sBoeCG','open-persona-library-btn','无法推进剧情:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22','你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','marginTop','longTermMemory','[发送了一张图片，描述为：','char-music-player-title','\x20的红包','nai-test-error','prophetCheck','ArrowRight','packetType','delete-selected-frames-btn','流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。','https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','delete-btn','inline-flex','new-product-category-name-input','✅\x20检查完成，未发现任何冗余数据。',')\x20内容:\x20\x22','isGameOver','form-button','高级数据清理','\x0a#\x20当前五子棋局势\x0a','请根据你的设定，生成你的淘宝购买记录和余额。','chat','人局，身份为\x20','char-browser-item','编辑规则','doubanMinPosts','novelai-settings','private_user','album-back-btn','toLocaleTimeString','\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','slice','px))','readingLibrary','outgoing-call-screen','contact-picker-item','无法获取电池信息:','获取AI投票决策失败:\x20','open_red_packet','reading-content','increase-qty-btn','自动总结成功：为\x20','导入单个聊天时出错:','npc-avatar-input','group-avatar-upload-input','无法解析角色卡文件。\x0a错误:\x20','Save\x20All\x20Appearance\x20Settings','狼人行动API失败:','appName','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','input:checked','https://generativelanguage.googleapis.com/v1beta/models/','此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>','cancel-gift-recipient-btn','save-sticker-binding-btn','injectLatestThought','delete-call-message-btn','动态已删除。','world-book-group-container','”翻开TA的日记本...','votes','”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','ai-avatar-library-grid','文件格式不正确，缺少关键的外观设置项。','无效链接:\x20','旧版备份数据写入数据库失败:\x20','无备注','manage-products-btn','导演/编辑模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','textContent','save-nai-settings-btn','Settings','bulkAdd','bg-clear','ai-avatar-preview','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','为了确保所有数据同步，建议立即刷新页面。','openWerewolfLobby','for_timestamp','Their\x20Playlist','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','对方消息预览','AI返回的行动中未找到有效的JSON数组。','\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20','ai-response-editor-block','诊断：在\x20data.character_book\x20中找到世界书。','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','昨晚是平安夜','qzone-avatar-input','#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a','已选择\x20','.action-icon','暂停了音乐','生图功能设置','char-diary-list','小于1分钟','gomoku-board','\x0a你必须严格遵守','\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20','confirm-share-link-btn','preset-content-container','character-select-item','生成成功！','nai-test-prompt','</p><p>','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','shopping-settings-btn','blockedTimestamp','error','reason','选中的表情已成功删除。','selection-cancel-btn','这是字体预览效果，12345。','https://corsproxy.io/?','#52c41a','（无有效对话记录）','character','请填写有效的商品信息和金额！','ZIP解压失败:','#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked','已死亡','名为\x20“','copy-message-btn','myAvatarLibrary','select-all-music-search','请输入EPhone主屏幕的背景图片URL','目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20','trans','table','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>','856aJnVaH','https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','》\x0a\x20\x20\x20\x20-\x20**','system','getItem','删除分组后，该组内的好友将变为“未分组”。确定要删除吗？','<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>','ai-avatar-group','isUserParticipating','\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>','正在导入表:\x20','ai-action-cooldown-input','input','commenterName','死亡了','\x0a\x0aAI原始返回内容:\x0a','</small>','manual-summarize-btn','globalSettings','静音音频已停止。','gomoku-controls','无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>',')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','\x20(图片描述:\x20“','<div\x20class=\x22spinner\x22></div>','手动创建角色','spectator-propel-btn','确认操作','https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','已加载预设\x20“','\x22\x20处于行动冷却中，本次独立行动跳过。','\x20的已删除动态','创建群聊','selection-soft-delete-btn','语音消息设置\x20(Minimax\x20TTS)','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>','enableAutoMemory','”，价值','getWriter','解析格式模板失败:','settings-preview-area','ai-original-name-input','请至少选择一个要分享的聊天。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.','setTimeout','\x0a---\x0a###\x20帖子ID:\x20','AI返回的讨论内容格式不正确。原始返回:\x20','startDiscussion','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','sticker-panel','npc-list-back-btn','NPC','1.0','\x0a\x0a其专属的“世界书”也已自动创建并关联。','change-icon-btn','Confirm','https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22','lastOpened','-modal','choice','.frame-item.selected','\x20\x20\x20promptSource:','contactType','\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>','API\x20Key','input[name=\x22theme-select\x22]:checked','https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','.world-book-category-pane','删除分类及表情时出错:','状态已更新','删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？','https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','fullscreen','你赢了','检测到\x20SSE\x20流式响应，开始解析...','\x0a##\x20世界书《','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>','第一夜，执行本地随机刀人逻辑...','++id,\x20name','正在请求“','https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','select-all-world-books-for-clear','\x22\x20data-category-id=\x22all\x22>全部</button>','Tutorial','通话中，','#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a','将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。','”的聊天记录','quote-message-btn','\x20分钟，开始模拟后台活动...','\x0a#\x20【行为倾向指令\x20(高优先级)】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【唯一任务】就是**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【绝对禁止】再次发布新动态，除非你收到了直接的指令或有一个对剧情发展至关重要的、紧急的新想法。\x0a','我们和好吧！','正在接收流式数据...','https://files.catbox.moe/','清空购物车','new-group-name-input','<p>','请输入备忘录内容','world-book-tab','对方拒绝了你的视频通话请求。','&nbsp;','rule-editor-title','Language','associatedWith','dataset','.selected-options-text','”\x20将备注修改为\x20“','battery-alert-modal','\x20元。]','world-book-content-container','正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。','(未设置)','wb_','qzone_like','isEnabled','狼人请睁眼，请选择要刀的玩家。','transparent','你们正在一起读书。','blockReason','\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22','请先点击扳手图标进入管理模式，才能添加新商品。','拉取主模型','渲染规则\x20[','群成员','\x20首歌曲获取失败:\x0a-\x20','\x20分钟)，本次独立行动跳过。','ZIP文件内容:','https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','char-browser-screen','onloadend','添加\x20NPC','parse','proxy-url','修复完成！','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>','.voice-play-btn','lyrics-btn','.text','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20','[表情]\x20含义:\x20\x22','update-notice-body','setAttribute','ttsCache','[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]','k_euler_ancestral','\x22\x20在库中未找到。','#custom-modal\x20.custom-modal-footer','countdown','\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。','save-advanced-editor-btn','enable-tts-switch','配置错误','-9999px','确认抹除','text/event-stream','video_call_response','manage-frames-btn','Appearance','chat-list-action-delete','Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined','”。请自然地接受这个新名字，不要对此感到惊讶。]','\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a','NPC\x20Nickname','TTS\x20音频已保存到缓存。','npc-action-cooldown-input','char-music-artist','location_share','char-music-lyrics','AI返回的刀人目标格式不正确。','\x20同步所有群聊内的头像...','import-new-book-btn-header','<span\x20style=\x22color:\x20green;\x22>已开启</span>','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','check-and-fix-data-btn','css-preset-select','home-screen-pages-container','你刚刚接听了用户的视频通话请求。','add-song-search-btn','渲染规则','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','rule-card\x20','probability','setItem','.incoming-call-content\x20.caller-text','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','https://i.postimg.cc/cLPP10Vm/4.jpg','album-photo-input','https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','chat-list-action-cancel','代付请求已被拒绝','.screen','change','\x0a-\x20**内容摘要**:\x20','minimized','8px','请开始总结。','group-avatar-library-title','refined','\x20个新头像！','warn','手动注入狼人杀记忆失败:','target_timestamp','分组名不能为空！','auto-memory-interval','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','猎人带走了\x20','button','\x22\x20吗？','save-api-settings-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','blur','cloned-header','pinned','toLowerCase','imageUrls','originalType','》:\x0a','请选择一个目标。','这是模拟对话，无法发送消息哦~','date','rp-details-item','close-novelai-settings','favorite-diary-btn','each','sticker-item','Edit\x20World\x20Book','检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。','”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','https://i.postimg.cc/g2XykNGB/IMG-4727.gif','一条动态','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','Error','forEach','https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','compress-images-btn','\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。','所有动态','selection-screenshot-btn','isGroup','get','标题:\x20','world-book-tabs','https://i.postimg.cc/qRCtnMms/IMG-6145.gif','is_busy','char-diary-detail-title','confirm-delete-world-books-btn','\x20你应该让角色们主动开启新话题来打破沉默。','元,\x20备注:\x20','generativelanguage.googleapis.com','pending','cssText','未选择书籍','https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','送出礼物','cover','start','nai-steps','[发送了一条语音，内容是：\x27','一些之前的消息已被用户删除。','\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。','\x20(图片描述:\x20\x22','API为空回，角色\x20\x22','”\x20的位置已发送到你们的聊天中。','status_text','mouse','错误:\x20','value','修改图片','容错解析：策略2成功\x20(提取了summary字段内容)','then','EPhoneWorldBookBackup','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','成功将角色\x20','\x0a-\x20','flex-start','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','time','Secondary\x20Proxy\x20URL','selection-erase-btn','trim','currentPage','Chat\x20List\x20Batch\x20Load\x20Count','expanded','主API设置\x20(用于聊天)','latestTimestamp','system_message','.char-product-item','https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','novelai-model','douban-max-posts-input','repost-confirm-btn','在这里输入回复内容','linkedMemoryCount','nai-smea-dyn','https://i.postimg.cc/zvWGPjms/IMG-7090.gif','rules-tab','<div\x20class=\x22avatar-group\x20','文章摘要...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','--chat-font-size','recordId','*讨论记录*:\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>','...\x20[记忆:\x20','等待回应','聊天设置','beginPath','现在开始讨论，请各位玩家依次发言。','recalled_message','Fetch\x20Secondary\x20Models','cancel-werewolf-lobby-btn','已同步角色\x20','导出成功','狼人杀','chat-settings-btn','photo-viewer-next-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>','已成功加入购物车！','API\x20设置','renderWorldBookScreenProxy','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','lrcUpdateInterval','.search-result-item','请输入有效的URL。','default_positive','is-acting','推进剧情失败:','删除日记','更换“','shoppingCategoryCount','status','[图片，描述:\x20','\x22\x20class=\x22chat-image\x22></div>','profile-random-jottings','密钥\x20(API\x20Key)','blocked_by_ai','已选\x20','https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','.commenter-name','world-book-category-pane\x20active','manage-my-avatar-library-btn','shiftKey','novelai-api-key','\x22\x20(群名)\x20的消息。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a','linkedMemoryChatIds','history-back-btn','处理通话请求时API出错:','post-image-preview','清空聊天记录','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20','bulkDelete','songJson','my-avatar-library-modal','messageTimestamp','\x20的礼物','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','userAgent','horizontal','TA的淘宝订单','我已了解风险，确认压缩','opened','share-link-btn','》设定\x20(你可以将其中角色作为聊天对象):\x0a','toArray','旁观群聊至少需要选择2个成员。','showStatusBar','10px\x2015px\x2020px\x2015px','NPC人设','chat-list-bottom-nav','preset-editor-title','toISOString','buttonId','请至少选择一种要清理的数据类型。','reading-restore-btn','导演/编辑模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','最小帖子数不能大于最大帖子数！','hasShown40','sticker-search-input','match','Cancel','add-persona-preset-btn','status-bar-time','正在全网搜索歌曲资源...','内心独白','Send','.entry-keys-input','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>','-\x20你昨晚用解药救了\x20','https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','正在请求网易云音乐API:','group_call_response','总结失败','\x0a\x20\x20\x20\x20-\x20**书名**:\x20《','操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20','shuoshuo','》及其下的表情已成功删除。','crossOrigin',')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]','https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','\x20其中包括以下投票：','请先选择角色','\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**','-selection-list','\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','message-editor-container','close-playlist-btn','getTime','npc-list','\x20条红包记录。','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22','is-gift','delete-world-books-list','加载失败','chat-name-group','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ai-response-editor-container','-\x20**对话状态**:\x20上次互动于\x20','在导演模式保存时，发现无效的指令对象，已跳过:','quantity','push','这是模拟对话，无法发送消息','#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a','new_name','canvas','[系统消息]\x20','发送照片','”。只有“','未知用户','[表情:\x20','add-my-avatar-batch-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','<input\x20type=\x22checkbox\x22\x20value=\x22book_',',\x20内容:\x20\x22','自定义通话名称','在角色\x20\x22','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>','visibleTo','group-members-settings','copy-post-btn','删除照片','shared-history-viewer-content','first','https://i.postimg.cc/htZppbS4/IMG-7107.gif','编辑条目','addEventListener','page-indicator','image/','charCodeAt','model-select','setDate','\x0a\x0a#\x20待总结的群组视频通话记录\x0a','尝试打开一个不存在的世界书，ID:','Werewolf','block','https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','）。]','(无购买理由)','正在扫描和修复数据...','models','onpause','font-preset-select','music-visual-container','originalName','覆盖预设','https://i.postimg.cc/nryNzTXK/IMG-6915.gif','blockCooldownHours','检测到视频通话请求，为角色\x20\x22','网络图片\x20(EPhone)','\x22\x20class=\x22participant-avatar\x22\x20alt=\x22','AI已将新群头像命名为：“','专辑封面已更新！','\x22操作...','handlePacketClick','placeholder.png','data:\x20[DONE]','[发送了一条语音，内容是：','在导演模式保存时，遇到了未知的AI指令类型:','\x22\x20处于行动冷却中\x20(还剩\x20','getUint32','share-link-modal','每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。','\x22><div\x20class=\x22poll-question\x22>','解析成功：标准JSON数组格式。','like','sticker-grid','</p>','disabled','\x27的发言）继续进行讨论。','https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','#ccc','备忘录','close-char-music-player-btn','</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>','上传头像','checked','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','recipientName','heartfelt_voice','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22','未知表情','压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...','flex','simulatedTaobaoHistory','狼人杀AI回应生成失败:','导入\x20Tavern\x20AI\x20世界书','后台活动模拟已自动启动。','”下，回复了\x27','add-existing-contact-btn','preview-font-style','favorites-delete-selected-btn','编辑商品','secondary-model-select','rule-enabled-switch','display','请先在API设置中配置好API信息。','preset-actions-modal','从\x20JSON.image\x20中提取图片数据','global-custom-style','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20','Delete\x20World\x20Books','offline-max-length-input','data-clear-step-1','https://api.vkeys.cn/v2/music/netease?id=','photo-viewer-image','”。]','group_','focusout','dismissedUpdateVersion','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','font-size-value','”的当前状态已更新为：','participant-avatar-wrapper','天\x20-\x20白天','这是一条群聊语音消息，已禁止发起TTS请求。','发现新版本通知:\x20','[系统提示：你\x20','time-zone-group','”添加记忆','https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','请输入要添加的记忆要点：','我通过了你的好友申请，我们现在是好友啦！','确定要永久删除商品\x20“','is-ai-image','尝试直接作为图片显示...','packet_timestamp','my-avatar-library-grid','\x20\x0a-\x20**你们最后的对话**:\x0a','部分导入失败','sticker-upload-input','》设定:\x0a','开始清理','App记录','</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20','\x20请根据这个结果发表你的评论。]','天亮了。','请输入关键词或选择一个日期。','\x20票</span></div></div>','API\x20预设管理','\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','”\x20的详细角色信息。','请在此处粘贴完整的LRC格式歌词...','-\x20**当前时间**:\x20','未知的分享卡片类型:','未知会话','touchend','(无标题投票)','.chat-list-item[data-chat-id=\x22','https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','call-timer','聊了关于生日派对的事，我们约好了10月1日见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a','\x22><div\x20class=\x22member-name\x22>','existing-groups-list','splice','hours','并评论说：\x22','Description','#text-image-mode-content','.variation-block','werewolf-game-screen','”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a','\x20(回复\x20','url','\x20天的讨论环节。\x0a','请输入歌名','无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20','char-music-next-btn','刷新页面？','steps','生成新日记失败:','4.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20(','char-memo-screen','说说内容不能为空哦！','group-avatar-group','批量导入表情','”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x20分钟)</span>','delete-world-books-modal','preset-persona-input','local','chat-list-item','请为这个头像起个名字（例如：开心、哭泣）','translateX(-','receiverName','[语音]','total-image-size-display','++id,\x20name,\x20createdAt','dblclick','正则表达式格式错误:\x20','https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png','https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','custom-modal-cancel','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','该预设包含\x20','isTemporary','我拒绝了你的视频通话请求。','<input\x20type=\x22','sticker-category-tab','<p><strong>','https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','checked\x20disabled','ai-cooldown-group','visibilitychange','文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。','shoppingProductCount','\x22\x20成功发布了一条新动态。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','成员们正在输入...','entries','ai-persona-group','douban-settings-modal','removeItem','恢复默认字体','\x20(用户)**:\x20','presets','Cphone数据\x20(CPhone)','originalSize','groupAvatar','\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>','scroll','.link-share-card','\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a','https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','通话记录已删除。','currentVoiceId','在此修改，或点击上方按钮使用格式模板...','本地头像上传及识别失败:','global_css','isSeparator','input[name=\x22visibility\x22]','appIcons','\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','164958HfwPpi','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>','保留旧的','send-photo-btn','https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20位AI角色的长期记忆中！','https://image.novelai.net/ai/generate-image','groupAvatarLibrary','world-book-tab\x20active','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>','regenerate-char-memo-btn','找不到相册:','loader-container','Taobao','\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20','view','\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20','-\x20\x20\x20**当前时间**:','compressed','levelchange','prompt','\x20\x0a-\x20**你最近和“','并评论说：“','qzonePosts','绑定范围','unread-indicator','char_book','selected','save-npc-btn','\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','-\x20\x20\x20**NovelAI图片分享**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22name\x22:\x20\x22你的角色名\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20【禁止暴露这是novelai生成的图片!】\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20使用场景：当你想要基于当前对话情景、你的性格或上下文分享一张图片时使用。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。','请添加歌曲','收到\x20SSE\x20数据，大小:','from','https://i.postimg.cc/kGgwJhPH/IMG-4374.gif','++id,\x20timestamp','更换图标','检测到好友申请待处理状态，为角色\x20\x22','{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}','.remove-option-btn','[一张图片，描述为：\x22','scrollHeight','ai-persona','请根据你的设定，生成你的相册内容。','请为这个头像起个名字（例如：春日野餐、学习时间）','\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20','switch-to-text-image-mode','createdAt','offset','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。','[系统提示：用户加入了通话]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','show-announcement-board-btn','\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a','htmlFor','sticker','**内容:**\x0a','toDateString','paste','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>','在聊天\x20\x22','getElementById','confirm-clear-posts-btn','成功将群聊\x20\x22','\x22\x20data-category-id=\x22','char-main-time','songs','createDocumentFragment','lastIndexOf','cphone-wallpaper-upload-input','close-shared-history-viewer-btn','Upload\x20Avatar','\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22','Done','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>','.delete-btn','\x20的对话','normal','**:\x20\x22','添加网络歌曲','https://generativelanguage.googleapis.com/v1beta/models','\x22\x20的本次后台活动跳过。原始回复:','标准JSON数组解析失败，将尝试强力解析...','exec','\x20的消息:\x20\x22','点击处理','.entry-content-textarea','旁观模式收到未知指令类型:','昨天\x20','副模型','\x0a\x0a现在，请生成这份歌单。','touchmove','frame-item','此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？','表情含义','closed','Cleanup\x20Redundant\x20Data','\x0a#\x20用户的角色\x0a-\x20**','Independent\x20Action\x20Cooldown\x20(min)','lastIndex','char-usage-item','\x20条长期记忆发送给AI，总结成大约\x20','prompt_order','messages','usageTimeMinutes','add-preset-entry-btn','date-separator','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>本地图片(头像/表情/头像框/等)大小:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22><strong>','Preset\x20Name','paused','artistName','.favorite-item-card','timestamp','\x0a-\x20**你的长期记忆**:\x0a','preset-category-select','已删除最新心声，当前心声已回滚至上一条。','歌单已生成，正在从网络获取\x20','favorites-action-bar','请输入世界书的名称...','totalAmount','https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','renderApiSettingsProxy','”思考后决定暂时不发送好友申请，将重置冷静期。','is-transfer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20','newSize','群聊中没有成员有足够（2条以上）的记忆可供精炼。','nai-uc-preset','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>','[表情，含义:\x20','\x22\x20(用户)\x20或\x20\x22','<span\x20style=\x22color:\x20red;\x22>未运行</span>','https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','<span\x20class=\x22group-name\x22>','容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...','📊\x20使用模型:','accept','\x20的红包，金额为\x20','创建群聊至少需要选择2个联系人。','\x0a#\x20可用指令列表\x20(按需组合使用)\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','participant-display-avatar','.qzone-post-delete-action','\x20\x20\x20正面:','</strong>\x20Tokens</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','add-new-rule-btn','char-music-prev-btn','\x0a\x0a\x0a\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','**关键词:**\x20','char-amap-list','dark-mode','收到了格式不规范的AI指令（缺少type和content），已跳过:','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','https://i.postimg.cc/8kYShvrJ/90-UI-2.png','close-character-nai-prompts','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>','music-prev-btn','请输入新的图片URL','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22','”量身定制的商品已上架！','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','\x0a\x0a将重置冷静期。','statusText','fontSize','offline-mode-options','#search-results-list\x20.music-search-checkbox','<br>','全部记忆\x20(','char-usage-list','API未配置','simulatedAlbum','image/jpeg','-\x20用户在你们共同所在的群聊中的昵称如下：\x0a','douban-min-posts-input','\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','create_memory','https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','variation','include','stringify','https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a','ready','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','querySelectorAll','.com/','left','CPhone','角色专属NAI提示词已保存！','）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**','pat-animation','.sticker-binding-checkbox','generate','请根据你的设定，生成你的备忘录内容。','请为这个表情命名\x20(例如：好耶、疑惑)','**\x20(本名:\x20','unreadCount','isActive','[+]\x20Add\x20New\x20Entry','onerror','all\x200.3s\x20ease','lastGuardedId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','mousedown','.entry-enabled-switch','background','<div\x20class=\x22post-main-content\x22>','delete-world-books-btn','\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','message-bubble\x20','基础数据不完整，无法开始总结。','my-persona','selection-mode','close-rp-details-btn','totalElapsedTime','复制失败','body','pageX','https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','Share','open-sticker-panel-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','rp-details-greeting','import-single-chat-input','message-actions-modal','女巫已行动，女巫请闭眼。','<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>','async','.post-deleted-placeholder','(无内容)','recall-message-btn','选中的头像框已成功删除。','<s>$1</s>','.chat-group-content:last-of-type','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“','确定要永久删除这条通话记录吗？此操作不可恢复。','selection-share-btn','member-management-screen','change_avatar','.rules-tab','共享位置','myAvatar','update-notice-modal','char-diary-detail-back-btn','\x20个会话中。','从\x20JSON.data\x20中提取图片数据','字体设置','”的身份，开始你的回忆梳理与精炼。','temp_group_chat','Content\x20Entries','cancel-call-message-action-btn','https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','\x20位角色的记忆中。','data:image','scrollIntoView','music','tEXt','char-music-cover','masterpiece,\x20best\x20quality,\x201girl,\x20beautiful,\x20detailed\x20face,\x20detailed\x20eyes,\x20long\x20hair,\x20anime\x20style','++id,\x20timestamp,\x20authorId','.countdown-card\x20.timer','offline_text','删除表情','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','data-clear-char-list','chat-lock-overlay','group-character-nai-prompts-btn','sendQzoneStickerComment:\x20找不到帖子:','诊断：在顶层\x20','my-avatar-input','\x22\x20id=\x22','https://i.postimg.cc/B6T59xGK/IMG-7101.gif','Sticker','确定要退出当前这局狼人杀吗？游戏进度将不会被保存。','https://i.postimg.cc/50k390X8/IMG-6376.gif','innerHTML','&id','https://i.postimg.cc/90RBDh9K/IMG-6377.gif','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>','https://i.postimg.cc/k401K5g7/IMG-7304.jpg','name','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','删除世界书','”的长期记忆中。','Enable\x20Background\x20Character\x20Activity','cancel-music-search-btn','werewolf-game-btn','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','DOMContentLoaded','char-diary-screen','load-more-qzone-btn','offline','ceil','character-nai-negative','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“','message-bubble\x20post-deleted-placeholder','openNpcEditor','favorites-edit-btn','请输入头像的图片URL','.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20','close-gomoku-btn','CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。','没有聊天了。','send_and_recall','musicData','cancelable','ruleId','padEnd','cart-back-btn','.product-item','正在请求AI为新群头像命名...','\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20[','image','appUsageLog','.variation-image-input','无法为不存在的分类打开绑定模态框:','close-sticker-panel-btn','.format-btn','Diary','图片格式处理失败:\x20','所有API与后台设置已保存!','records','persona','等人的礼物','ai-frame-grid','book_','cphone-icon-settings-grid','Add\x20NPC','https://i.postimg.cc/FzqHTBng/IMG-7093.gif','Upload','#fullscreen-lyrics-container','var(--text-secondary)','callRequester','img','AI\x20(','notification-content','add-my-avatar-upload-btn','\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','通话消息已更新！','sticker_','product-editor-modal','confirm-vote-btn','<option\x20value=\x22','home-screen','apiKey','poison','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg','---\x0a','请稍候...','EPhone-Full-Backup-Legacy-','群聊已建立...','https://i.postimg.cc/1zmcp66p/IMG-5973.gif','gap','level','custom-bubble-style','正在请求AI角色们加入讨论...','create-poll-modal','女巫请睁眼。','删除\x20(0)','orderBy','nai-cors-proxy','#avatar-frame-modal\x20.frame-tabs','「在这里输入对话内容」\x0a(在这里输入动作或环境描写)','解析AI返回的JSON时出错:\x20','#gift-recipient-list\x20.contact-picker-item','execute-search-btn','clear','正在分析“','请输入一个有效的URL或选择一个文件！','15px','toBlob','请稍候','AI女巫决定使用毒药，目标是:\x20','错误：找不到要转发的原始动态。','Next','group_call_request','\x0a-\x20**','<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20','撤回了一条[','senderName','\x22\x20评论了动态\x20#','streamSaver','contact-picker-screen','App\x20Usage','anime\x20person','char-music-current-time','.lyric-line','.screen.active','<div\x20class=\x22red-packet-card\x20','置顶公告','\x0a\x0a现在，请继续这场对话。\x0a','Fetch\x20Primary\x20Models','api-key','\x20条内容吗？','AI返回了空内容。',']\x20[最近对话:\x20','无法找到对应的分享记录或记录已损坏。','date-search-input','favorite','accept-call-btn','close-ai-avatar-library-btn','置顶聊天','**[讨论环节]**\x0a','char-home-screen','链接分享','<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27','解析成功：通过强力提取模式。','audio-player','\x22]\x20','[NovelAI图片:\x20','相册名称','请输入歌手名','hiddenContent','#custom-modal-body\x20.format-btn[data-type=\x22text\x22]','post-actions-modal','规则名称和正则表达式不能为空！','已成功批量导入\x20','renderXSocialScreenProxy','novelai-generated-','showWaimaiDetails:\x20找不到消息或消息类型不正确','还没有任何评论，无法等待回复。','修改文字','检测到并成功修复了\x20','players','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','accepted','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','chat-search-results-list','add-new-product-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','thoughtsHistory','scrollTop','close-receipt-btn','清空所有动态\x20(危险)','保存所有外观设置','件商品','custom','rules-tabs','confirm-create-post-btn','post-visibility-groups','messages-view','\x22\x20class=\x22avatar-frame\x22></div>','char-music-player-modal','Details','battery-alert-text','正在为后台活动发送API请求\x20(\x22','<strong>$1</strong>','退款给\x20','qzone-banner-container','simulatedBrowserHistory','persona-editor-title','狼人已行动，狼人请闭眼。','\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是','API错误:\x20','完成(','offsetTop','\x20为您代付成功','killedId','head','.qzone-post-container[data-post-id=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting','\x0a#\x20世界观\x20(必须严格遵守)\x0a','myAvatarFrame','werewolf-game-over-modal','btn-danger','生成模拟相册失败:','保存书籍(ID:\x20','import-appearance-btn','正在呼叫所有成员...','</div><div\x20class=\x22transfer-amount\x22>¥\x20','isPinned','group-background-activity-switch','-\x20(空)','.nav-item[data-view=\x22qzone-screen\x22]','你们最近没有有效聊天记录。','NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。','播放已暂停','input[name=\x22variation-select\x22]:checked','确认送出礼物','character-grid','authorOriginalName','<span>已</span><span>超</span><span>时</span>','char-product-item','myNickname','[系统提示：用户打开了五子棋棋盘，游戏开始了。]','douban-detail-back-btn','\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','sticker-category-manager-modal','group_call_summary','import-preset-input','\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a','分类名不能为空！','npc-background-activity-switch','\x20已复制到剪贴板。','contentLines','\x22\x20data-description=\x22','\x20条消息吗？这会通知AI这些消息已被删除。',')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','message-editor-block\x20variation-block','theme','转发成功！','.chat-group-header','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','variation-select','touches','preset-entries-container','选择一部手机','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','translateY(0px)','https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','应用已返回前台，正在检查更新...','hiddenText','请输入新的图片URL：','Background\x20Activity\x20Interval\x20(sec)','.comment-input','.message','<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','play','post-use-url-btn','className','characterNegativePrompt','label','confirmButtonClass','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>',')的阅读进度失败:','\x20的日记','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>','\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','flexDirection','.progress-bar','已死亡的用户(','AI女巫决定使用解药！','</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥','https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','isArray','选择歌词导入方式','https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','music-player-avatar-display','encode','商店空空如也，点击“管理”添加商品吧！','未发现需要迁移的旧红包数据。','确定要将以下消息发布到公告板吗？\x0a\x0a“','IMG','Refresh','clear-cart-btn','.header','qzoneSettings','检测到应用离线了\x20','main-chat-list-header','切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？','\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Erase','Response\x20status:','”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','frame_cat_ear','<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','\x20觉得很赞</span></div>','\x20首无效歌曲:\x0a\x0a-\x20','最近\x2020\x20条','negative','Their\x20Album','my-avatar-upload-input','openCharWallet','发来了\x20','收藏成功','https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','【AI角色】','预设已删除。','\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22','NotAllowedError','[群聊]','3DWRZRg','closest','{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20','AI\x20\x22','offlineMinLength','custom_proxy_url','确定要删除这条渲染规则吗？','在写入文件流时发生错误:\x20','suffix','狼人杀游戏总结已自动存入\x20','werewolf-player-avatar','https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','tagName','content-type','分类\x20“','确定要永久删除选中的\x20','playlist-body','frame_7','https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif','decline','management-mode','AI\x20(群聊后台)\x20尝试使用一个不存在的表情:\x20\x22','EPhone-Full-Backup-','icon-img-','原始消息已删除或不存在','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>','11pHSEiZ','reply_content','关联的角色\x20(NPC会去评论这些角色的动态)','cart-item','”的投票(时间戳:\x20','”的参考记忆','AI返回的内容中未找到有效的JSON对象。','https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','arc','\x20的新头像同步到群聊\x20\x22','<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>','gameMode','music-playlist-panel','-\x20\x20\x20**公开发布NovelAI真实图片动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20[\x22图片1详细英文描述\x22,\x20\x22图片2详细英文描述\x22]}`\x20\x0a\x20\x20*\x20**prompt撰写**：你可以根据当前对话上下文、你的角色人设、以及你想表达的情感和氛围，来撰写详细而具体的prompt。详细程度由你根据具体情况自己决定，并不强制。\x0a\x20\x20*\x20例如：\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22','equals','无法生成新回复:\x20','https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','werewolf-role-modal','</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>','memories-view','toCollection','set','sticker-binding-chat-list','\x20条无效的','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','authorChatId','.comment-send-btn','witch-do-nothing-btn','https://image.pollinations.ai/prompt/','frame_11','没有可供重新生成回复的用户消息。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','favorites','正在为您选择的\x20','click','\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x0a-\x20**最近对话摘要**:\x0a','post_deleted_notice','memos','ai-frame-content','Primary\x20API\x20Settings\x20(for\x20Chat)','random','novelai-settings-btn','wallpaper','rejected','...\x22):\x20','请输入有效的金额！','groupName','精炼“','张图片，prompt:','当前群聊还没有公告哦。','artist','NPC行动失败：API未配置。','qzone-more-actions-btn','speech','lyrics-active','recalledData','诊断：在\x20data.extensions.character_book\x20中找到世界书。','favorite-article-btn','notification-sound-player','call-history-list','精炼失败','gomoku-btn','维基百科','existing-sticker-categories-list','高德地图','variation-product-name','span:first-child','请你对此作出回应。]','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>','\x22\x20决定去发一条动态...\x20(此处为模拟)','widgetData','dialogue','✅\x20找到\x20final\x20事件的图片数据','</div><div\x20class=\x22gift-footer\x22>共','正在为角色“','writeText','错误：找不到该成员的个人档案。','\x0a**---\x20第\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>','\x0a-\x20**长期记忆**:\x20','”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20你的任务\x0a你是一个狼人杀游戏导演。你的任务是扮演【除了','message','offsetWidth','candidates','commenterOriginalName','编辑记忆','isDeleted','https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','world-book-editor-screen','persona-library-modal','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','应用已切换到后台，记录当前时间。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cancelText','\x0a##\x20','请输入有效的金额(必须大于0)！','char-memo-detail-back-btn','未发现任何需要修复的数据问题。','default_negative','primaryKeys','post-actions-btn','点击查看详情...','drawImage','currentTime','的设定集','is-card-like','lucky','werewolf-','\x20转账\x20','确认删除','通话记录已成功总结并存入角色“','shopping-product-count-input','分组\x20\x22','\x0a\x0a#\x20待整合的记忆要点列表\x0a','\x22>\x20','clear-posts-item','global-lyrics-bar','来自动态','#e4b591','browser-screen','确定要永久删除分类\x20“','删除分类后，该分类下的所有预设将变为“未分类”。确定吗？','Processing...','onended','linkedWorldBookId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','appearance-preset-select','#listen-together-btn\x20img','你们正在一起听歌，','正在根据“','\x22\x20data-commenter-display-name=\x22','\x0a#\x20世界观设定\x20(必须参考)\x0a','所有通话记录','”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《','category','rules-category-pane','clientHeight','remove-member-btn','speaking','https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','20px','用户向你发送了一张图片','\x0a-\x20**这是你们最近的对话历史**:\x0a','\x20\x20\x20负面:','📝\x20使用','\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20','devicePixelRatio','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','waimai_response','notification-sound-url-input','isLocal','记忆链接','\x22\x20的本次后台活动跳过。','#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a','Data\x20Check\x20&\x20Repair','cart-count','\x27刚刚在你的动态“',')\x20送出了一份礼物，收礼人是：','\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>','banner','clear-specific-data-btn','line-through','bg-btn','编辑预设','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','call-transcript-modal','\x0a-\x20**\x20你的聊天对象（用户）的人设**:','所有数据已成功恢复！应用即将刷新以应用所有更改。','char-vinyl-container','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<option\x20value=\x22\x22>未分组</option>','导演模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','shopping-category-count-input','style','npcs','resolution','胜利！','douban-detail-avatar','preset-avatar-input','https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','UTF-8\x20解码成功。','5px','确定要删除这篇日记吗？','switchToCharHomeScreen','上传成功！','保存并应用','char-conversation-messages','收到了未知的AI指令类型:','---\x20狼人杀对局完整复盘\x20---\x0a\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','\x20小时了。','.loader-container','\x0a-\x20**你最近和“','\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。','公告已发布！','keys','group-name','delete-font-preset-btn','user','[表情]','cleanup-songs-btn','”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a4.请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','import-appearance-input','apiConfig','werewolf-game-over-reason','.entry-content-container','导演/编辑模式保存(Sticker):\x20使用了\x20meaning\x20查找','go-to-cart-btn','被投票放逐','createObjectURL','isMinimized','票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','originalMeaning','-\x20**昵称:\x20','chat-render-window-input','等待回复','./sw.js','playMode','#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a','这将用备份文件中的数据【完全覆盖】当前与“','[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]','\x0a#\x20待总结的对话历史\x0a','backgroundActivityInterval','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','NPC\x20人设','数据库写入失败:\x20','rule-editor-modal','ServiceWorker\x20注册失败:\x20','text_image','Favorites','npc-avatar-preview','x-social-screen','lineTo','.png','chatData','close','https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','localeCompare','custom-modal-body','center','modern\x20app\x20icon\x20for\x20','</div>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22','variation-quantity-display','\x27的评论，内容是：“',')\x20为\x20','function','.battery-text','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','聊天记录','\x0a##\x20---\x20关于“','product-category-tab','请输入有效的图片URL！','[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','lastUpdate','\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22','，人设:\x20','douban-detail-post-title',')\x20的可用表情:\x0a','rp-group-amount','”]\x20','text','#delete-world-books-list\x20.clear-posts-item.selected','postId','<div\x20class=\x22poll-card\x20','diary','[图片]\x20','表情包分类绑定已更新！','save-font-btn','请输入有效的默认价格！','transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)','将清空选定角色的所有对话消息、曾用备注和你的昵称。','\x20当前时间是\x20','\x27刚刚评论了你的动态“','novelai-switch','where','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','message-wrapper\x20system-pat','.comment-item','werewolf-selection-item','\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心新增】在这里添加“背景”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','Loading...','确定切换','search-history-back-btn','promptSource','小组风格','备注名/群名不能为空！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','isNpc','show-avatars-btn','customCss','participantId','cancel-call-btn','offline-mode-group','syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','自定义数量','preCallContext','【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！','share-target-modal','https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','cancel-douban-cast-btn','applicationReason','rp-details-list','shopping-screen','命名头像框','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥','\x20条新消息','\x22\x20生成行动失败:','清理冗余数据','正则表达式\x20(使用g作为标志)','char-chat-list','NPC\x20Persona','\x20天\x20---','✅\x20NAI提示词：使用系统配置','panelEl','var(--text-primary)','”，选项有：[','\x22(处理后为\x22','你们没有在读书。','productId','books','parsedLyrics','smea_dyn','导演模式保存(Sticker):\x20使用了\x20meaning\x20查找','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','send-poll-btn','borderColor','计算图片总大小时出错:','照片上传成功！','帖子详情','close-reading-library-btn-header','contactId','请先选择要删除的商品。','\x0a\x0a##\x20世界书:\x20','.nav-item[data-view=\x22memories-view\x22]','lastMemorySummaryTimestamp','player','[♪\x20','#music-lyrics-container\x20#music-lyrics-list','NPC\x20\x22','ZIP\x20Blob\x20大小:','recalled-animation','</textarea>','anonymous','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','Live\x20Preview','此操作将永久删除您选择的\x20','.sender','replace','custom-prompt-input','https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“','toFixed','世界书','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','[收到一笔转账]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“','.variation-price-input','\x20(最后互动于\x20','https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif','share-target-list','https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>','.selected','请根据以上设定开始你的决策。','photo-viewer-modal','-\x20**','minimax-api-key','网络图片','shopping-settings-modal','的状态已更新为:\x20','\x20向对方发起了转账:\x20','[系统提示：你于时间戳\x20','\x22\x20class=\x22sticker-image\x22>','werewolf-game-title','(ID:\x20','ai-avatar-upload-input','isSpectatorGroup','favorites-back-btn','.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar','在这里输入语音内容...','qzone-back-btn','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20你的首要任务是检查“待处理的帖子列表”。如果列表中有你可以回应的帖子（特别是那些有新评论或提到你的），你【必须】优先进行评论或回复，而不是发布新动态。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20','回复\x20','stickerCategories','import-world-book-input','最近支出','currentText','请输入背景图片的URL','外观设置已成功导入并应用！','hang-up-btn','lyrics-vertical-pos','#post-public-text','</span></div></div>','https://i.postimg.cc/05DLr0yj/IMG-4427.gif','\x20条消息，AI将完全遗忘它们的存在。确定吗？','repost-modal','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>','查看失败','open-shopping-btn','#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a','请输入\x20歌名\x20或\x20歌名-歌手','Response\x20headers:','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','commentIndex','rules-category-pane\x20active','product-category-select','abs','.sticker-item.selected','\x22。\x0a','AI幻觉已被拦截！试图使用群名\x20(\x22','(你是第一个发言的人)','\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a','https://api.vkeys.cn/v2/music/tencent?word=','search-history-btn','Performance\x20&\x20Display\x20Settings','visibleGroupIds','角色专属','\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？','AI生图功能已','）完成了支付。此订单已关闭，其他成员不能再支付。]','lastActionType',')\x20成功抢到了\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','char-music-progress-bar','https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','friend','请所有AI角色根据你们的身份和人设开始发言。','delete-theme-preset-btn','photo-item','#fullscreen-lyrics-container\x20.music-lyrics-list','》吗？','\x22\x20class=\x22avatar-img\x22><img\x20src=\x22','”才能使用\x20\x27open_red_packet\x27\x20指令领取。]','本日核心议题','[语音]\x20内容:\x20\x22','first_mes','一位神秘的NPC','#000000','save-product-btn','\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a','Import\x20Backup\x20File','已经一起听了','复制成功','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','cleanup-data-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','values','linked-memory-count','”的长期记忆少于2条，无需进行精炼。','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>','歌曲背景已更新！','search-results-list','test-sound-btn','[系统提示：用户手动结束了投票！最终结果为：','note','findLast','font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;','.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper','count','add-char-diary-btn','您的修改已保存！','已使用','\x20位群成员生成并注入了个性化记忆！','https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','gomoku-overlay','https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','正在模拟“','secondaryModel','请求添加你为好友','获取AI狼人目标失败:','label[for=\x22','My\x20Albums','save-world-book-btn','\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20','\x22\x20data-commenter-original-name=\x22','werewolf-witch-modal','paidBy','https://i.postimg.cc/RZNLhbbr/IMG-4389.gif','cfg_scale','\x20获胜。也就是说，','”这个信息，将其转换为【具体的公历日期】（例如：“约定了明天见面”应总结为“我们约定了','”\x20绑定到...','好的，我明白了。我会严格遵守以上所有规则和设定。','characterId','getHours','character-profile-modal','模型列表已更新','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>','data-clear-type-list','--music-bg-image',')\x20刚刚领取了红包\x20(时间戳:\x20','获取AI投票失败:','receiver','送给了大家一份礼物','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','50%','safetyRatings','customName','张图片','post-image-desc-group','删除\x20(','该条记录已成功删除。','本地群头像上传及识别失败:','在这里输入语音内容','call-history-title','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20','totalTime','赶紧的充电，要饿死了','#reading-window\x20.reading-header','</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22','-\x20(暂无)','netease','群昵称不能为空！','分享成功','Edit\x20Entry','📤\x20发送请求到\x20NovelAI\x20API','\x0a\x0a#\x20对话者的角色设定\x0a','confirm-gift-recipient-btn','custom-modal-title','renderChatListProxy','文件不是一个有效的PNG。','nai-test-result','close-persona-library-btn','globalChatBackground','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20','image/png','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','cancel-contact-picker-btn','existing-group-item','reading-overlay','offline-mode-toggle','fullscreen-active','block-cooldown-input','toDataURL','[系统提示：用户（','.qzone-post-container','一位成员','prepend','\x20\x20\x20characterPositivePrompt:','char-background-activity-switch','scenario','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','characterPositivePrompt','minimax-model-select','is-link-share','\x20的外卖订单（时间戳:\x20','[系统提示：','正在为角色\x20','\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','.comment-sticker-btn','https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','正在请求AI为新头像命名...','今天\x20','{{user}}','https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','wait-reply-btn',']。目前投票的人有：','meaning','导演模式','确定要删除预设\x20“','游戏结束','select-all-frames-checkbox','listen-together-btn','Character\x20Avatar','AI女巫决定保留解药。','压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...','解析AI返回的投票JSON时出错:\x20','书名不能为空！','\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。','qzone-posts-list','分钟前','**。','https://i.postimg.cc/SNByPrf9/IMG-7005.gif','读书会话已关闭。','music-search-results-modal','https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','fetch-models-btn','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20','lyrics-horizontal-pos','naiimag','窝爱泥，电量吃饱饱','getBattery','添加头像','select-all-recipients','生成模拟备忘录失败:','aiAvatarLibrary','\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','表情名不能为空！','div','投票至少需要2个选项。','guard','blob','\x0a**内容:**\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','minimaxApiKey','屠城局：狼人杀死所有好人即获胜。','singer','.sticker-item[data-sticker-id=\x22','.unread-indicator','天黑请闭眼...','删除NPC','导出单个聊天时出错:','bubble_theme','https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','lastActionTimestamp','handleWidgetImageChange','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。','确定要删除这条长期记忆吗？','char-qq-screen','确认清理无效歌曲？','https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','找不到主角\x20“','prompts','group-avatar-library-grid','AI\x20(群聊后台)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','AI\x20Block\x20Cooldown\x20(hours)','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>','padding','文章完整内容...','next-page-btn','请根据角色列表，生成豆瓣小组帖子。','cursor','使用解药救TA','theme-toggle-switch','请填写完整的约定标题和日期！','你已拒收','userStickers','仅清空\x20','setHours','\x22\x20创建成功！','photo-viewer-prev-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','data-lang-key','openCharApp','playerJson','编辑消息','pending_system_reflection','https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。','\x20发布了一条新公告','狼人请选择刀人对象','你拍了拍\x20“','.upload-variation-image-btn','https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','.name','\x22\x20中的成员信息更新','\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','cart-item-checkbox','生成模拟淘宝记录失败:','天\x20-\x20夜晚','这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','keyword-search-input','search-result-item','save-appearance-preset-btn','发生了一个错误:\x20','创建新规则','add-world-book-entry-btn','https://i.postimg.cc/13hhJ77p/IMG-4419.gif','novelai-enabled','Album\x20Name','positive','product-editor-title','.red-packet-card','规则名称','\x0a-\x20散记:\x20','此操作会将选定的\x20','werewolf-log','\x0a#\x20---\x20世界书设定结束\x20---\x0a','voted','无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20','fill','ai-avatar-library-title','https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','replyTo','#data-clear-type-list\x20.clear-posts-item','请输入预设名称','确定要从你的头像库中删除“','cancel-red-packet-btn','API\x20错误:\x20','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>','world-book-category-select','Enable\x20Independent\x20Background\x20Activity','-\x20(ID:\x20','preset-tabs','GeminiChatDB','photos','chat-interface-screen','Edit\x20Rule','chats','狼人数量已达到胜利条件，狼人阵营获得了胜利！','歌曲查找失败:\x20AI请求的歌曲名\x22','你查验的玩家\x20','photos-grid-page','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','【重要提示】','clearRect','[语音消息:\x20','长截图生成失败:','QQ音乐','对方已收款','shift','char-taobao-screen','\x20天\x20---**\x0a','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22','world-book-category-manager-modal','<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>','swipeDirection','Add','vinyl-view','删除失败，请查看控制台错误信息。','character-phone-screen','char-photo-description','启用AI生图功能','后台活动:\x20角色\x20\x22','bg-input','”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','backgroundImage','\x20个自定义头像框吗？','characterName','文件格式不正确，这不是一个有效的单聊备份文件。','\x22\x20data-memory-timestamp=\x22','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','settings','select-all-chars-for-clear','isAlive','AI女巫决策：今天是第','头像和人设不能都为空哦！','music-time-counter','<option\x20value=\x22global\x22>公用\x20(所有角色)</option>','confirm-wolf-kill-btn','world-book-screen','\x20的浏览记录','object','从旧版本迁移的条目','api-preset-select','groupHeader','<p>♪\x20暂无歌词\x20♪</p>','frame_flower','API设置','selection-count','\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a','请输入文字图描述！','<span\x20class=\x22commenter-name\x22>','你已死亡，正在围观...','querySelector','undefined','https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20','pointer','music-mode-btn','<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>','single','offline-preset-select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>正在计算可压缩图片大小...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>--\x20MB</span>\x0a\x20\x20\x20\x20','\x0a-\x20**帖子内容摘要**:\x20','mes_example','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22','getAttribute','><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>','未知设定的角色','[图片生成失败:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','.modal-header\x20span','charging','照片已删除。','在这里输入说说的内容...','文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>','\x22\x20的独立行动失败:','Enter\x20the\x20name\x20of\x20the\x20world\x20book...','导入已取消，因为未提供书名。',')\x20和情景的感知。','renderQzoneScreenProxy','\x22\x20中有未领完的红包，正在生成抢红包指令...','AbortError','豆瓣小组','.custom-multiselect\x20.select-box','</div><br>是否用这条新记忆替换掉这些旧记忆？','export-data-btn','gbk','公用规则','add-sticker-batch-btn','shoppingCategories','\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','”下，发送了一个表情评论，意思是：“','AI\x20尚未对您的最后一条消息做出回应，无法重新生成。','data','accept-friend-btn','char-audio-player','”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20','-\x20\x20\x20**对话状态**:\x20','请输入一个有效的图片URL！','\x22\x20data-option=\x22','transcript','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg','imageDescription','add-world-book-btn','handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','group-action-cooldown-input','source_name','enableBackgroundActivity','”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。','开始检查','image_prompt','clear-posts-list','stream','已取消收藏。','cancel-clear-wizard-btn-step1','\x20→\x20','char-conversation-partner-name','JSZip库未加载，请刷新页面重试','\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a','https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','member-avatar-input','enabled','save','product-category-tabs','AI\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','下在(','#sticker-binding-chat-list\x20.sticker-binding-checkbox:checked','matches','songName','\x20[包含','AI角色','为NPC\x20\x22','chat-input','toggle','button-order-editor','请根据你的设定，开始你的行动。','https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','preset_','<textarea\x20id=\x22','https://i.postimg.cc/9fQZ425b/IMG-5975.gif','exclude','”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','regenerate-char-music-btn','检测到刚结束的通话，正在注入通话记录上下文...','backgroundColor','请先选择要添加的歌曲。','product-grid','quote','api-temperature-value','https://www.myinstants.com/media/sounds/notification-sound-2.mp3','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。','options','AI方','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20','\x20为\x20','rotating','transfer','送给大家的礼物','Language\x20\x22','你们已经有','product-image-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.music-search-checkbox','\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27','Moments','var(--accent-color)','load-more-thoughts-btn','rp-group-count','https://i.postimg.cc/XY63sTS3/IMG-4393.gif','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','link','-\x20**即将演唱**:\x20','currentPlayer','playlist','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','消息时间戳\x20','生成失败','sender','hasShown20','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>','chat-header-title-wrapper','transform','theme-preset-select','rp-group-greeting','<span\x20class=\x22spoiler\x22>$1</span>','https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','back-to-list-btn','renderingRules','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','将分类\x20“','gift-recipient-list','werewolf-witch-selection-list','提示词配置','AI\x20尝试评论一个不存在的表情:\x20\x22','https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','请根据以上设定，立即做出你的决定。','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','\x22\x20data-poll-timestamp=\x22','global','custom-user-font','originalTimestamp','”，金额是\x20','视频通话请求','douban-send-comment-btn','inject-thought-toggle','reading-library-modal','delete-transcript-btn','close-my-avatar-library-btn','import-data-input','profile-heartfelt-voice','save-douban-settings-btn','++id,\x20name,\x20chatId','请至少选择一个要清空的范围。','cphoneAppIcons','存储空间优化','成功导入\x20','来自与\x20','导入备份文件','%\x20+\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','share_link','https://i.postimg.cc/DZshzKv6/IMG-5576.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','最后确认！','申请失败','POST','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','已拒收对方转账','amap','paddingBottom','\x20转发了\x20@','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','update-notice.html?_=','aiAvatarFrame','在动态评论区点击了表情，但在表情库中未找到对象:','items','board','https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','[私聊]','\x22\x20\x0a\x20URL:\x20','彻底删除消息','commentsCount','manage-ai-avatar-library-btn','最终正面提示词:','<div></div><div></div><div></div><div></div><div></div>','logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27','reset-character-nai-prompts-btn','key','memories','狼人杀AI讨论生成失败:','2982933aLUWYK','chat-header-title','合计:\x20¥','https://i.postimg.cc/xjpN4swz/IMG-7240.gif','\x22\x20class=\x22realimag-image\x22\x20alt=\x22NovelAI图片分享\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22\x20title=\x22','paid','waimai-amount','setup','product-item','delete','分享新鲜事...','cancel-share-target-btn','isDanger','未知发送者','currentPlaylist','call','相册已成功删除。','Long-term\x20Memory','-\x20**时间**:\x20你必须感知到当前是\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22\x20style=\x22color:\x20red;\x22>计算出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','upload-image-btn','getPropertyValue','检查完成','https://i.postimg.cc/B6KD52vz/IMG-7096.gif','gift','cache','#image-mode-content','\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','渲染X社交页面','[你发送了一张需要AI识别的图片，图片内容是：\x27','contains','[系统提示：你刚刚成功将自己的备注名修改为了“','[系统提示：你\x20(','filter','loadedmetadata','-\x20**对话状态**:\x20你的上一条消息发送于\x20','\x20.message-bubble.user\x20$1','恭喜！','npcId','waimai_request','accept_transfer','werewolf_summary','总结通话记录时出错:','top','gift-receipt-modal','\x22\x20记录了一条新回忆:','char_diary','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（','</td><td\x20class=\x22item-subtotal\x22>¥','\x20的所有动态，且无法恢复！','offsetLeft','语言已切换，页面即将刷新以应用更改。','targetId','\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。','https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif','\x20的外卖代付请求（时间戳:\x20',']\x20(ID:\x20','https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','lyrics-offset-input','manage-group-avatar-library-btn','typing-status','participants','[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20','incoming-call-modal','主API和副API均未配置或配置不完整。','<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>','.custom-multiselect','create_countdown','分享新鲜事...（非必填的公开文字）','更新通知文件中缺少\x20data-version\x20属性。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','.chat-group-content','获取更新通知文件失败。','#\x20角色核心设定\x0a','json','TA的相册','确定要删除头像框\x20“','\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>','[data-lang-key-title]','#avatar-frame-modal\x20.modal-body','这条动态的原始数据已被彻底清除。','werewolf-role-reveal-list','delete-selected-products-btn','</td><td\x20class=\x22item-qty\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','2-digit','put','delete-group-btn','思考中...','manage-members-btn','iVBORw0KGgo','getBoundingClientRect','reset-font-btn','gift-receipt-body','天核心议题','📋\x20请求体:','Content-Type:','-\x20你昨晚用毒药毒了\x20','\x0a-\x20**作者**:\x20','\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。','transfer-actions-modal','2091546eIEhru','生成设置','\x20红包已被领完，手气王是\x20','cancel-product-editor-btn','发送语音','纯音乐，请欣赏','autoMemoryInterval','clear-chat-btn','#delete-world-books-list\x20.clear-posts-item','NPC\x20昵称','处理NPC后台活动时出错:','groupNickname','”移出群聊吗？','groupMembers','\x20回复了你。','Status','<span\x20class=\x22offline-description\x22>','游戏结束，开始自动总结并注入记忆...','<div\x20class=\x22custom-title\x22>','favorite-item-card','\x0a[文字图内容:\x20','本地歌曲源错误:','spectator','Background\x20Activity\x20Settings','\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)','删除记录','\x20的头像框到群聊\x20\x22','请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','(Timestamp:\x20','，点击查看</div></div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','导入\x20Tavern\x20预设','qzone-banner-img','跳过一个无法解析为JSON的编辑块:','cancel-clear-posts-btn','https://i.postimg.cc/Y9d3BztC/1.png','**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务铁律\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【至关重要】**:\x20当你发现“最近的动态列表”中，有你【感兴趣且还未互动过】的动态时，你**应该优先考虑**使用\x20\x27qzone_comment\x27\x20或\x20\x27qzone_like\x27\x20指令去进行互动，这比你自己发一条新动态更符合社交礼仪。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27[{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]\x27\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20','novelai-details','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合“今天是','playlist-item','<input\x20type=\x22checkbox\x22\x20value=\x22','existing-product-categories-list','\x20位角色生成豆瓣动态...','严重警告！','AI\x20获胜了！','custom-css-input','group-management-modal','rules-content-container','相册\x20\x22','💾\x20[专属弹窗]\x20保存角色NAI提示词','npc','删除成功','\x20分享了一张NovelAI图片，prompt:\x20','\x20\x20-\x20在群聊“','.contact-picker-item','个月前','\x0a-\x20**你的长期记忆**:\x20','📸\x20动态NovelAI图片生成开始，共','Escape','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','动态内容已复制到剪贴板。','</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','time-zone-search-input','”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','right','poll-question-input','[一张图片，其隐藏文字为：\x22','<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20','<span\x20class=\x22offline-dialogue\x22>','isClosed','正在为所有AI角色生成并注入游戏记忆...','price','nai-quality-toggle','char_browser_article','worldBookCategories','NovelAI生成','reject','正在等待AI角色们继续讨论...','.playlist-item','werewolf-wait-reply-btn','cart-title','data-clear-step-2','旁观模式推进剧情失败:','副反代地址','游戏尚未结束，无法进行总结。','catch','getMinutes','add-ai-response-block-btn','werewolf-kill-selection-list','toLocaleString','(无)','column','[照片]','replyToName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','chat-lock-content','https://i.postimg.cc/VkQfgzGJ/1.jpg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','群聊\x20\x22','join','my-frame-tab','导演模式保存(Sticker):\x20使用了编辑器提供的完整JSON\x20(url\x20+\x20meaning)','purchases','world-book-checkboxes-container','totalPages','confirm-share-target-btn','character-nai-positive','图片已更新！','AI\x20尝试使用一个不存在的表情:\x20\x22','https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','已删除最后一条心声，当前心声已重置。',')\x20试图将群名更改为成员名\x20(\x22','✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)','memories-back-btn','https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','.avatar-group','variation-product-image','add-chat-btn','douban-cast-list','apiTemperature','.unread-indicator.back-btn-indicator','https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','拼手气红包','发送好友申请','voice_message','go-to-clear-step2-btn','这是你们的第一次互动。','heartfeltVoice','-\x20**姓名**:\x20','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','操作失败','浏览器不支持电池状态API。','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。','创建新预设','选择记忆所属角色','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','删除消息','call-history-back-btn','identifier','确认清空','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','auto','red-packet-modal','默认头像','.delete-track-btn','simulatedConversations','chatId','.icon-preview','usage-item','送给\x20','https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','extensions','type','poisonedId','isBusy','导演模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','Font\x20Settings','none','typing-indicator','native','ai-response-editor-modal','timeZone','lastFailedAction','.participant-avatar-wrapper[data-participant-id=\x22','正在开始清理冗余数据，请不要关闭页面...','countdown-card','map','*事件*:\x20','生成模拟歌单失败:','结束投票','生成的图片URL:',')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“','enableTts','delete-api-preset-btn','call-message-actions-modal','<em>$1</em>','spectator-reroll-btn','启用独立后台活动','https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','result','\x20评论了动态]','EPhoneSingleChat','编辑对方状态','(无标题)','cphone','\x20的动态\x20(NPC)','assign','聊天记录分享卡片数据损坏:','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>','-\x20**长期记忆\x20(必须参考)**:\x20','Rule\x20Name','直接使用\x20base64\x20数据','werewolf-player-grid','imageUrl','[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]','生成截图时发生错误，请检查控制台获取详情。','photoCount','未使用','正在批量添加\x20','切换听歌对象','[系统提示：\x27','char-diary-detail-screen','无法找到分享记录:','\x22\x20创建了一个新约定:','join-call-btn','\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。','🚀\x20发送NAI请求:','删除预设','</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','轮到你发言了...','secondary-api-key','拉取模型失败:\x20','请选择今晚的目标。','号玩家:\x20','此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20','你通过了“','未分类','lineWidth','请至少输入2个有效的投票选项！','poll-options-container','导入成功','karras','网络请求失败:\x20','stickerCategoryId','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>','douban-screen','https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','通话于\x20','订单详情','favorites-view','nickname','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>','width','\x20发起了外卖代付请求，商品是“','secondaryProxyUrl','添加商品','has-frame','total','add-group-avatar-url-btn','<span\x20style=\x22color:\x20green;\x22>运行中</span>','选中的收藏已被移除。','album-grid-page','<span\x20class=\x22diary-messy\x22>$1</span>','++id,\x20name,\x20type','.rules-category-pane[data-category-id=\x22','world-book-name-input','event_type','非图片格式，跳过压缩:','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','minimaxGroupId','\x0a\x0a现在，请为所有【存活的AI角色】生成他们充满策略和博弈的发言。','minimaxVoiceId','”。请你回顾一下刚才和“','character-nai-prompts-btn','</span></div>','此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。','remove-bg-btn','”\x20的预设已存在。要覆盖它吗？','https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','成功移除了\x20','load-more-btn','处理中...','chatListRenderWindow','EPhone-长截图-','此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。','variations','\x20为你切歌:\x20《','这个角色没有可用的备选开场白。','检测到AI执行了动态操作，立即刷新好友动态页面。','#char-chat-list\x20.chat-list-item','switch-greeting-group','https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','nai-custom-proxy-group','导入歌词','现在，请所有AI角色针对刚刚的发言（特别是\x27','\x20发布了一条新动态]','&id,\x20url,\x20name,\x20categoryId','你让大家继续讨论...','switch-to-image-mode','http','选择要精炼记忆的角色','font-preview','EPhone-Chat-','网易云音乐搜索失败:','data:','select-all-cart-items','max','reset-custom-css-btn','summarize-recent-btn-header','请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)','”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥','update','string','zh-CN',')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]','♪\x20♪\x20♪','scope','命名头像','save-ai-response-editor-btn','https://i.postimg.cc/jCVK0fGL/IMG-6890.gif','用户描述的照片','预设名称','removeEventListener',')\x20拒绝了\x20','version','请至少选择一个要添加的联系人。','在此修改内容...','change_music','https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','要为《','操作失败:\x20','(这张照片没有描述)','https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','通话记录','”的记忆\x20---\x0a','arrayBuffer','\x20-\x20','这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？','mouseleave','icon-settings-grid','currentPhase','char-simulated-input','执行出错',']类型的消息','ended','确定要从播放列表中删除《','Generation\x20Settings','\x22\x20被唤醒，准备独立行动...','Bilibili','hasShown10','Export\x20Data','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20','qzone-post-item','message-bubble\x20system-bubble','LOW','\x20[社交背景:\x20','https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','call-record-card','getDate','&id,\x20name,\x20categoryId','pageY','currentIndex','选中的消息均已收藏过。','数据检查与修复失败:','从角色卡导入\x20(.json/.png)','导入世界书','检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。','\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a\x0a//\x20【核心修改2】明确了JSON格式中\x20speaker_name\x20和对话中称呼的不同要求\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20','✅\x20清理完成！\x0a\x0a','生成中...','decline-call-btn','守卫已行动，守卫请闭眼。','》吗？此操作不可撤销。','#e9ecef','claimedBy','commentText','\x20点赞了动态]','animationend','#\x20场景设定\x0a','删除头像','API错误响应:','\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a','确认覆盖','”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','chatActionButtonsOrder','正在等待AI角色们对你的发言做出回应...','world-book-category-pane','currentSnippet','avatar','openCharacterSelector','charId','。等待对方处理。]','sampler','npc-persona-input','</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','chat-list','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','页面跳转','close-sticker-category-manager-btn','music-lyrics-list','预言家','收到了格式不规范的AI指令，已跳过:','offsetParent','\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','Category','.gift-card','personality','onload','search-history-screen','\x20行的格式不正确，已被系统跳过。','\x20红包已被领完。','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>','headers','确定要删除这条公告吗？此操作不可恢复。','检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。','spectator-edit-btn','天\x20-\x20讨论','\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','是否要使用毒药？','https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','enableAiDrawing','通话名称已更新！','API\x20Preset\x20Management','is-location-share','https://i.postimg.cc/76Tj3g1B/IMG-4425.gif','请先在API设置中配置好（主或副）API。','werewolf-action-bar','#f0f2f5','cancel-create-poll-btn','\x27\x20在你的动态(ID:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>','(今天是第一天，没有历史记录)\x0a','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>','检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。','\x20(概率:\x20','Global\x20(All\x20Characters)','.call-record-card','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>','📁\x20从本地文件\x20(.lrc)','转账给\x20','无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20','确定要从头像库中删除“','【原动态内容:\x20',')，并在对话中自然地体现出来。','NovelAI\x20Model','API\x20请求失败:\x20','”的网上冲浪足迹...','无法自动播放静音音频（这在iOS首次加载时是正常现象）:','qzoneAlbums','https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','save-css-preset-btn','等待对方处理','\x22\x20的独立后台活动开关已关闭，本次跳过。','toLocaleDateString','确定要删除选中的\x20','bulkPut','音频播放失败:','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。','收藏成功！','https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','\x0a-\x20**世界观**:\x20','”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>','即将开始下载您的完整备份文件。下载过程中请勿关闭页面。','link-description-input','TA的好友包括:\x20','票):\x20',')为你点了一份外卖作为【礼物】。外卖内容是“','url(','toggle-fullscreen-btn','\x22><div\x20class=\x22title\x22>','rgba(0,\x200,\x200,\x200.4)','?key=','frame_14','radio','https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','novelai-test-modal','categoryId','default','substring','preset-action-cancel','聊天界面初始加载条数','originalPost','Wait\x20for\x20Reply','Their\x20Taobao\x20Orders','API未配置，无法生成内容。','\x20元</div>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>','副密钥','旁观模式AI发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','.message-bubble','创建新聊天\x20(第1/2步)','height','group-avatar-library-modal','选择一个开场白','\x20行的格式不正确，已被跳过。','member','gift-recipient-modal','请根据你的设定，写一篇新日记。','Secondary\x20API\x20Settings\x20(for\x20Summarization)','</persona>\x0a</character>\x0a','Binding\x20Scope','图片\x20Blob\x20创建成功，大小:','\x22)\x20在播放列表中未找到。','chat_message','getElementsByTagName','qzone-banner-input','border','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','角色\x20\x22','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','isHidden','.toggle-content-btn','[你发送了一条语音消息，内容是：\x27','shopping-action-bar','请根据以上情景，生成新的评论。','lrc','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','chara','检测到新版流式备份文件，开始导入...','你们没有在听歌。','\x20<span\x20class=\x22group-tag\x22>群</span>','.clear-posts-item','！请对此事件发表评论。]','Proxy\x20URL\x20(No\x20/v1\x20needed~)','nai-test-status','children','.waimai-details-btn','register','”发送的、尚未领完的红包（时间戳:\x20','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>','voice-message-btn','change_user_avatar','recipients','publicText','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','1024x1024','lorebook','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','savedId','*你按下了接听键...*','bottom','网易云','\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','User\x20Avatar','file','字体预设已保存！','.share-target-checkbox:checked','presetCategories','https://i.postimg.cc/wMxmCZVC/IMG-7099.gif','长期记忆','https://i.postimg.cc/KYr2qRCK/1.jpg','confirm-contact-picker-btn','\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)','light','\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a','char-music-progress-fill','</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','API\x20Settings','\x0a\x20\x20\x20\x20','确定要删除《','\x20(时长:\x20','waimai-timer-','long-term-memory-screen','用户刚刚接听了你主动发起的视频通话。','请为这本设定集命名：','[系统提示：你拒绝并退还了“','SAFETY','AI决策','add','px)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>','isGroupCall','data-lang-key-title','variation-selection-modal','未知作者','true','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','精炼长期记忆时出错:','announcement-action-delete','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','静音音频已启动，用于后台活动保活。','qzone-screen','notification-bar','span','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','”的身份，开始你的客观总结。','API\x20调用失败','分钟前聊过。','AI生成的图片','close-category-manager-btn','add-manual-memory-btn-header','.message-bubble.is-link-share','AI被拉黑后冷静期\x20(小时)','decode','恭喜你，你赢了！','豆瓣设定','qzone_comment','生成购物中心商品失败:','char-browser-article-screen','保存CSS预设','margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','https://files.catbox.moe/q6z5fc.jpeg','my-group-nickname-input','World\x20Book','<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22','\x0a\x0a#\x20你的角色设定\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22','0:00','confirm-prophet-check-btn','请输入要精炼的最近记忆条数\x20(最多\x20','margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','-\x20昨晚是平安夜，无人死亡。\x0a','randomJottings','</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20','douban-cast-modal','read-together-btn','</td></tr>','https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20','这是一个通过手动创建的角色。','limit','”中，用户的昵称是“','[系统提示：用户刚刚发布了一条动态(ID:\x20','Asia/Shanghai','.music-player-window','\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a','检测到\x20Tavern\x20AI\x20世界书文件，执行兼容导入...','image-mode-content','album-photos-title','proxyUrl','[data-version]','handleListenTogetherClick','douban-detail-content-wrapper','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20','设置群名','✅\x20NAI图片生成成功！','Save\x20All\x20Settings','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','currentX','update_status','\x0a[图片]','已成功从文件导入预设《','照片详情','preset-name-input','下一步','\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22','close-call-transcript-btn','pop','onclick','无法解析预设文件。\x0a错误:\x20','fillStyle','Storage\x20Optimization','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“','\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20表情使用指南\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','reading-library-list','frame_6','在导演模式中发现一个无效的JSON片段:','frameUrl','错误：找不到该通话记录所属的聊天对象。','\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。','ephone-language','min','clipboard','<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20','🌐\x20使用网络URL','API\x20Temperature','uc_preset','startX','hunter','生成模拟足迹失败:','\x20\x0a#\x20社交圈与动态\x0a','at-mention-item','确定要将“','\x0a###\x20条目:\x20','nai-resolution','select-all-products-checkbox','API未配置，无法生成对话。','传统导出\x20(兼容旧版或内存小的浏览器)','”生成商品？','itemName','</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>','游戏即将开始，正在为各位玩家分配身份...','close-product-category-manager-btn','请输入对方现在的新状态：','设置已应用','smea','currentDay','\x0a#\x20你的聊天对象（用户）的人设\x0a','请修改记忆要点：','\x20\x20\x20characterNegativePrompt:','send-waimai-request-btn','\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a','Long\x20Screenshot','最近\x2050\x20条','正在执行删除操作...','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','昨晚\x20','导出世界书时出错:','Fonts','[系统提示：你刚刚成功将对用户的称呼修改为了“','\x22\x20alt=\x22','a\x20beautiful\x20scene','所有解析方案均失败！将返回原始文本。',',\x0a\x22data\x22:\x20{\x0a','导入成功！','world-book-entries-container','\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20','后台活动设置','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','\x22\x20placeholder=\x22','antidoteUsed','borderRadius','-\x20\x20\x20**NovelAI真实图片分享\x20(在聊天中直接发送)**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20-\x20**【绝不能暴露是novelai生成的图片！】\x0a\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20-\x20使用场景：当你想要在【私聊对话中】直接给用户发送一张图片时使用。\x0a\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。\x0a\x20\x20\x20\x20-\x20注意：这会直接在聊天记录中显示图片，而不是发布到动态。','complex','disable','https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','已成功收藏到“我的收藏”页面！','dragging','”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','App\x20Usage\x20Log','.photo-thumb','(回复\x20','抱歉，未能找到相关歌曲。','\x20条消息。','<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>','sticker-binding-modal','font','无结果','https://i.postimg.cc/XNkQTHvf/IMG-5561.gif',')\x20时出错:','无人接听群聊邀请。','unblock-btn','offlinePresetId','my-avatar-library-title','\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a-请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20','question','Douban','bookId','translateX(-50%)','\x20(本名:\x20','comments','avatar_prompt','照片描述','utf-16be','这个预设文件中没有找到任何有效的提示词条目。','<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22','char-article-title','pause','发言结束，现在开始投票。','批量导入格式错误，已跳过此行:','touchstart','char-qq-conversation-screen','https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','”的聊天记录已成功导出！','请输入有效的字体URL。','启用规则','”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20','post-image-description','musicLibrary','assign-group-select','friend_request_response','[一张图片，其隐藏文字为：“','edit-message-btn','压缩失败','”生成这组【与角色高度相关】的商品数据。','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','qzone-post-delete-action','\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“','.thought-delete-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>','borderBottom','hidden','message-bubble\x20recalled-message-placeholder','chatRenderWindow','pending_ai_approval','\x22\x20value=\x22','」听歌。要结束并开始和「','[图片动态]','innerText','keydown','\x20<span\x20class=\x22source\x22>','Regular\x20Expression\x20(use\x20g\x20flag)','\x20领取了\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>','member-name-input','add-poll-option-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','sticker-action-bar','openRenderingRulesScreen','has','switch-greeting-btn','无法访问剪贴板。','https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','”\x20吗？','.icon-setting-item','swiped','sender-name','clientX','\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>','reset-button-order-btn','noneOf','Appearance\x20Settings','”的好友请求','正在读取所有数据到内存中，请稍候...','已阵亡，还有30秒爆炸','”\x20已被删除。','repost','https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','申请成功！','customAvatarFrames','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20','Delete\x20(Notify\x20AI)','variation-decrease-qty','图片内容','commenterDisplayName','nameHistory','reading-window','post-image-preview-container','已恢复默认设置！','voice','memberId','getContext','#group-management-modal\x20.modal-header\x20span','.sticker-item','一个普通玩家','确定要删除分类《','save-rule-btn','狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20','ᗜωᗜ','commentCooldowns','history','frame_5','isClick','”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20','\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20',')。操作已被拦截。','variation-selected-price','”的转账。]','#vinyl-view\x20#music-player-cover','Save','find','”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]','[转账]',')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','memo','”请求添加你为好友：<br><i>“','shoppingProducts','请为这个新头像命名','聊天记录已成功覆盖！正在刷新界面...','postTitle','activeBookId','ai-original-name-group','nai-seed','https://i.postimg.cc/fRV86FMq/IMG-4381.gif','#linked-chats-checkboxes-container\x20input:checked','”的购物习惯...','char-diary-detail-content','</option>','source','3094090VbEcxV','Rendering\x20Rules','\x22\x0a-\x20**用户的备注**:\x20\x22','确认导入','无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20','。请收礼的角色表示感谢，其他角色可以自由发挥。]','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','Amap','lyric','请根据你的设定，生成你的App使用记录。','您的旧有记忆已被完整保留，未作任何修改。','https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','werewolf-lobby-modal','payload','.json','[data-lang-key-placeholder]','通话记录已保存:','rp-direct-total','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥','transfer-action-decline','还没有可供编辑的AI响应。请先让AI回复一次。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>',']\x20的正则表达式无效:','导演模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','删除失败','auto-memory-toggle','announcements','删除评论','群聊通话中没有找到可作为总结主体的AI角色。','imageProcessed','group-background-activity-group',';\x20font-style:\x20italic;\x22>','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','endsWith','chat-settings-modal','announcement-board-modal','custom-modal-confirm','image-upload-input','close-nai-test-btn','global-css-input','member-settings-modal','create-shuoshuo-btn','npc-list-view','removeChild','delete-track-btn','粘贴歌词','hasOwnProperty','Bearer\x20','[系统提示：你刚刚主动拉黑了用户。]','nai-cfg-scale','[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','create-post-modal','Cphone','toggle-blur-btn','gridEl','”。请你回顾一下刚才和\x20“','https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','announcement-board-content','...”','\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','》添加歌词吗？','waimai_order','-\x20**当前歌词**:\x20\x22','chat-name-input','werewolf-user-input','.contact-picker-item[data-contact-id=\x22','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','”\x20已成功导入！','timerId','从缓存播放\x20TTS\x20音频...','back-from-member-management','++id,\x20type,\x20timestamp,\x20originalTimestamp','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20','请输入投票问题！','。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','test','</span>','\x20的红包已被领完','\x22\x20点赞了动态\x20#','<span>删除</span>','播放失败，请检查URL是否正确或浏览器是否支持该格式。','memoryTimestamp',')**:\x20','template','preset-avatar-preview','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>','message-editor-block','alt','上一条消息的发送时间是\x20','\x0a\x0a\x0a\x20#\x20【格式铁律\x20(最高优先级)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，格式如下:\x0a\x20\x20\x20\x20`[{\x22type\x22:\x20\x22offline_text\x22,\x20\x22content\x22:\x20\x22在这里写入你创作的、混合了对话和描写的完整段落。\x22}]`\x0a2.\x20\x20**【内容风格】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由地将对话穿插在描写的任何位置，实现自然分段。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a3.\x20\x20**【禁止】**:\x20绝对禁止在\x20`content`\x20字段中出现\x20\x22dialogue\x22\x20或\x20\x22description\x22\x20这两个词。\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**','https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','aiPersona','字体预设管理','rp-direct-receiver','动态已更新！','\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a','####\x20','没有可导出的世界书数据。','delete-selected-stickers-btn','\x22></div>','theme-default','last','long','douban-my-comment-avatar','80px','qzone_post','\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','coverUrl','https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','ephone-theme','full','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','linesPerPage','create-new-member-btn','summary','https://i.postimg.cc/d0WCKxff/IMG-6932.gif','副API设置\x20(用于总结长期记忆)','请所有AI角色开始投票。',')\x20的残缺数据。','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','NEGATIVE_INFINITY','caller-avatar',')\x20商品:\x20','char-memo-list','poll_timestamp','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','删除分类后，该分类下的所有商品将变为“未分类”。确定吗？','input[name=\x22visibility\x22]:checked','placeholder','<div\x20class=\x22post-content\x22>','music-player-overlay','frame_12','werewolf-kill-modal','final','https://i.postimg.cc/yN3s8szM/IMG-4400.gif','1px\x20solid\x20#e0e0e0','char-article-content','select-all-stickers-checkbox','\x22的角色（你的本名是\x22','保存所有设置','每晚可以查验一个玩家的身份是好人还是狼人。','promptFeedback','自动总结狼人杀游戏失败:','transcript-modal-title','callRecords','werewolf-log-entry\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20更换了头像','UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...','猎人死亡，请选择一名玩家带走！','upload-global-bg-url-btn',')，内容摘要是：“','visibilityState','https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','generativelanguage','检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。','将歌曲切换为了《','var-','Messages','检测到旧版完整备份文件，开始导入...','大小:','audio/mpeg','https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','is-realimag','.poll-action-btn','++id,\x20name,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp','inline-block','生成第',')\x20的棋步。','open-memory-screen-btn','\x22\x20class=\x22preview-frame\x22>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>','请输入提示词！','\x20是同一个分组的好友。\x0a','openPresetScreen','\x0a-\x20**身份**:\x20','douban-post-item','char-music-play-pause-btn','\x20的代付请求','正在准备...','\x20个新表情！',')，问题是：“','\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a','\x0a\x0a#\x20游戏规则\x0a-\x20','member-persona-input','appearance','”回忆TA的相册照片...','enable-ai-drawing-switch','active','在这里输入图片描述','red-packet-details-modal','-\x20(记录于\x20','status-bar-toggle-switch','api-settings-screen','togglePlayerFullscreen','彻底删除','wallpaper-upload-input','floor','findLastIndex','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','（无文字内容）','https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','duration','music-player-cover','压缩完成！','iconId','add-new-group-btn','getFullYear','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','*对方按下了接听键...*','<span\x20style=\x22color:\x20green;\x22>是</span>','transition','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','无标题','\x22\x20(ID:\x20','无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20','\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','在执行组合操作时遇到错误:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','找不到原始消息。可能已被删除或位于更早的历史记录中。','\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20','generate-shopping-items-btn','性能与显示设置','skipped','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>','speaker_name','导入外观设置时出错:','is-waimai-request','direct','female-shaonv-jingpin','\x0a-\x20**你的曾用名**:\x20[','lyricsPosition','greeting','voiceId','style=\x22background-image:\x20url(\x27','不支持的分享类型。','preset-action-edit','transaction','data:\x20','\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20','.qzone-post-item','createElement','speaker','字体URL不能为空！','Back','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','-\x20清理了\x20','.select-box','group-avatar-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22','数据检查与修复','my-nickname-input','-speech','amount','change_remark_name','Import\x20World\x20Book','custom-frame-upload-input','管理预设分类','custom-modal-overlay','Book\x20Name','#ff4d4d','post-hidden-text','categories','fetch-secondary-models-btn',':generateContent?key=','cart-screen','🔧\x20检测到Chrome浏览器，启用headers兼容性处理','initiator','chatItem','findIndex','部分失败','AI\x20发言失败',')\x20刚刚投票给了\x20“','检查更新时出错:','round','[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','locationName','change_group_avatar','order','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','Memories','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','\x20中聊天','add-ai-avatar-batch-btn','已成功导出所有数据！','char-music-list','\x0a\x0a现在，请以“','Save\x20and\x20Apply','\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','transfer-btn','删除书籍','icon-setting-item','[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','checkout-btn','豆瓣设置已更新！下次重新生成时将生效。','isAwaitingResponse','https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','\x27)\x22\x20data-comment=\x22','.playlist-item-info','内容条目','replaceChild','createWriteStream','member-avatar-preview','upload-custom-frame-btn','chat-settings-screen','group_summary_from_','is-poll','外观预设已保存！','\x22\x20已经存在了！',')\x20作者:\x20','关于“','myPersona','save-douban-cast-btn','\x20不支持。请选择6、9或12人。','fillRect','offlineMaxLength','commenter','删除(通知AI)','my-nickname-group','currentTarget','https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','prophet','unshift','请输入有效的正整数！','”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20你的角色设定\x0a','char-photo-item','log','block_user','temp_npc_chat','\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a','time-zone-select','choices','恭喜发财，大吉大利！','clientWidth','announcement-action-pin','novelai-key-toggle','\x0a<character>\x0a\x20\x20<name>','add-group-chat-btn','\x22\x20not\x20found.\x20Defaulting\x20to\x20\x27zh-CN\x27.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url(','char-music-screen','isOpen','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','upload-sticker-btn','.poll-option-input','未检测到BOM，尝试使用\x20UTF-8\x20解码...','请输入一个有效的数字（建议大于20）。','preset-action-delete','https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','music-play-pause-btn','NovelAI\x20模型','cart-items-list','linkedWorldBookIds','》吗？此操作将同时删除相册内的所有照片，且无法恢复。','decision','商品名称不能为空！','”图标','appendChild','delete-css-preset-btn','-\x20**与用户的关系**:\x20你和用户(','preventDefault','99+','discussionLog','favorites-search-clear-btn','margin','remove-global-bg-btn','（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a','(暂无评论)','张NovelAI图片:\x20','image_post','char-memo-detail-screen','my-frame-grid','isPlaying','post-local-image-input','我是谁呀。','<span\x20class=\x22group-tag\x22>群聊</span>','Close','”吗？','https://i.postimg.cc/wx72fhr2/IMG-5968.gif','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>','.voice-transcript','npc-association-list','https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','my-group-nickname-group','create-post-btn','.delete-memory-btn','#qzone-screen\x20.qzone-content','<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>','font-size-slider','找不到这个预设的详细信息。','supportedValuesOf','sticker-category-tabs','poisonUsed','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Select\x20a\x20Phone','getVotes','photoId','qzone-sticker-grid','save-character-nai-prompts-btn','歌曲信息','用户删除了自己的评论，开始清理AI记忆...','.cart-item-checkbox[data-id=\x22','您正和「','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','new-category-name-input','.pagination-dot','--\x20点击选择\x20--','frame_tech','\x0a---\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','[系统提示：你接受了“','apply','video-call-main','memories-list','TA的浏览器历史','border-box','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','当作\x20ZIP\x20文件处理...','user_photo','请输入一个有效的页码！','<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>','\x0a#\x20可用表情包\x20(优先使用)\x0a-\x20请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a','》的歌词已成功保存！','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','participant-avatars-grid','pat_message','AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。','用户\x27','<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22','请先填写NovelAI\x20API\x20Key！','prev-page-btn','focus','长截图','[文字图]\x20','description','includes','红包已被领完！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。','如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a','-\x20你昨晚空守了。\x0a','\x0a#\x20你的任务\x0a你就是角色“','API格式不正确，角色\x20\x22','\x20死亡了。','\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员2\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20','renderWallpaperScreenProxy','fileType','ai-frame-tab','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','.lyrics-btn','max-memory','\x0a#\x20你的核心任务\x0a你正在扮演角色“','所有音乐源都未能找到歌曲：“','nai-generate-btn','Title','alternateGreetings','确定要删除NPC\x20“','\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22','rp-details-my-amount','请输入新的昵称','对方正在输入...','已成功加载外观预设：“','高级数据清理失败:','frame_13','avatarFrame','cancel-reply-btn','\x0a[图片生成失败:\x20','vertical','clear-posts-modal','change-frame-btn','Reset\x20to\x20Default\x20Font','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','正在呼叫...','product-description-input','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20','\x20发送了一张图片，内容是：\x27','https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','update_thoughts','拉取副模型','profile-thoughts-history-view','</div><div\x20class=\x22transfer-note\x22>','播放列表是空的，无需清理。','guardedId','导出失败','确定要永久删除这条动态吗？','分钟前有人聊过。','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','offsetX','请根据你的设定，生成你的高德地图足迹。','worldBooks','当前人数\x20','caller-name','”。\x0a','分类\x20\x22','确认清理冗余数据？','\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你【不是】一个单纯的游戏玩家，你是一个【有感情、有记忆、有社交关系】的角色。你在游戏中的所有发言和行为，都【必须】首先符合你的人设以及你与其他玩家的既有关系。\x0a-\x20**朋友**:\x20如果你和某个玩家是朋友，你应该在发言时倾向于保护TA，为TA的发言寻找合理解释，除非有确凿的证据。\x0a-\x20**敌人/情敌**:\x20如果你和某个玩家有矛盾，你可以借机在游戏中攻击TA，质疑TA的发言，甚至在你是狼人时优先刀掉TA。\x0a-\x20**恋人/暗恋对象**:\x20你会无条件地信任TA，保护TA，甚至愿意为TA牺牲。\x0a你的社交关系比游戏本身的胜负更重要！\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20\x20\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20\x20\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20\x20\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20\x20\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20','song',':\x20[发送了一个表情，意思是:\x20\x27','padStart','https://','blocked_by_user','\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20','activeAlbumId','random_jottings','\x20被刀了\x20(你没有解药了)','你们在','成功检查并修复了\x20','apiPresets','\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a','已成功将\x20','globalCss','」的新会话吗？','originalContent','角色卡数据无效或缺少\x27name\x27字段。','https://i.postimg.cc/wjH180kn/IMG-5566.gif','music-player-song-title','Compress\x20Local\x20Images','propel-btn','music-exit-btn','rule-regex-input','announcement-action-cancel','https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','tts_','**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（','title','\x20的外卖订单支付了\x20','assistant','https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','检测到群聊\x20\x22','https://api.vkeys.cn/v2/music/netease?word=','manage-world-book-categories-btn','\x20更换了你的头像]','.poll-card','确认总结','.frame-item','regenerate-char-usage-btn','activePostId','无共同好友','tlyric','isOfflineMode','[图片/文字图]\x20描述:\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','close-announcement-board-btn','grayscale(100%)','测试生成','getMonth','group-members-group','转发了\x20@','pending_user_approval','<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20','red_packet','transfer-action-cancel','.at-mention-popup','open-reading-library-btn','https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.cart-item-checkbox','创建新聊天','rule-chat-id-select','AI返回了空的或格式不正确的总结内容。','taobao','reduce','请先在API设置中配置好（主或副）API以进行总结。','https://i.postimg.cc/PrcKH436/IMG-4376.gif','qzone-post-container','https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','》\x20-\x20','正在请求AI进行手动总结...','\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','dark','.sticker-category-tab','\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>','src','parts','\x20.message-bubble\x20$1','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“','</span></div><div\x20class=\x22rp-type\x22>','startTime','#5b3a29','reject-friend-btn','**:\x20关于\x20**','\x20发送了一个【拼手气红包】(时间戳:\x20','**:\x20','浏览器','NPCs','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','frame_9','novelai-settings-modal','#chat-messages','input[name=\x22theme-select\x22][value=\x22','确认拉黑','我的相册','douban-comment-item','speech-01','\x20\x20-\x20评论:\x20','npc-editor-modal','\x22)。操作已被程序阻止。','GBK\x20解码成功。','Success','✅\x20图片解压成功！','请输入有效的红包个数！','<img\x20src=\x22','.frame-grid','isRefund','announcement-item-wrapper','”的记忆\x20(','font-settings-screen','https://i.postimg.cc/PJppkbvn/IMG-6918.gif','我的消息预览','position','手慢了','product-category-manager-modal','favorite-memo-btn','.recalled-message-placeholder','送给了\x20','frame_10','share_card','maxWidth','import_card','actionCooldownMinutes','商品已删除。','product-name-input','外观设置已保存并应用！','browser-back-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>','home-screen-pages','.frame-item:has(.delete-btn)','group-video-call-btn','相册名称不能为空！','无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20','\x0a\x0a现在，请生成新的评论。','\x20/\x20','p[data-index=\x22','\x0a#\x20身份与核心任务\x0a你正在扮演角色“','target','未知歌手','https://...','\x22\x20中发现并修复了旧红包数据。','#chat-interface-screen\x20>\x20.header','Publish','cancel-sticker-binding-btn','原文:\x20\x22','<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>','聊天列表每次加载条数','cancel-advanced-editor-btn','absolute','and','douban-comment-input','你撤回了一条消息','https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','gomoku_move','regex','onloadedmetadata','AI\x20尝试赠送一个格式不正确的随机礼物:','input[value=\x22user\x22]','“全部”分类无法被绑定。','short','语音生成失败','[data-lang-key]','.chat-list-item','activeChatId','<strong>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>','enableTimePerception','clientY','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','prototype','rp-content-group','refine-memory-btn-header','输入消息...','charAt','https://i.postimg.cc/PqYp5T5M/image.png','请根据你的设定，生成模拟聊天记录。','declined','rule-template-input','char-music-mode-btn','activeContainer','正在重试\x22','https://api.vkeys.cn/v2/music/tencent?id=','status-','分享的聊天记录已损坏。','notification-avatar','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20','wolfKill','load-more-chats-btn','length','cancel-share-link-btn','Playback\x20error:','reset-sound-btn','确定要拉黑“','switchToCharScreen','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','textarea','正在执行...','https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','music-next-btn','memory-screen-back-btn','保存字体预设','#clear-posts-list\x20.clear-posts-item.selected','*事件*:\x20平安夜，无人出局。\x0a','购物中心生成设置已更新！','outgoing-call-name','9681ivRDit','<span\x20style=\x22color:\x20red;\x22>已关闭</span>','rp-details-sender','finishReason','transfer-confirm-btn','++id,\x20title,\x20lastOpened','为什么','qzone-nickname','天，救人概率为\x20','选择导出方式','manual','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','</span><span>','已切换到新的开场故事！','请先填写对应的反代地址和密钥','nai-diffusion-4','对方撤回了一条消息','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20','日\x20---','》\x0a-\x20**发帖人**:\x20','当前时间是\x20','</span>:\x20','single-lyric-display','product-variations-container','.poll-option-item','predicate\x20must\x20be\x20a\x20function','user-speak-btn','下棋历史\x20(x,y坐标均从0开始):\x0a','确认生成','\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>','wallpaper-screen','typeId','isFullyClaimed','cancel-wolf-kill-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','（可选）输入后缀','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【身份铁律】】】**:\x20用户的身份是【','<span\x20class=\x22diary-emphasis\x22>$1</span>','讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','novelai-test-btn','collapsed','请根据以上设定，生成商品数据。','\x0a-\x20**你们最后的对话摘要**:\x20\x0a','#\x20可用群头像列表\x0a','\x22\x20发布了动态','游戏开始','.status-text','AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。','product-image-preview','chatLinks','.variation-image-preview','currentLyricIndex','...','douban-cast-select-btn','call-transcript-modal-body','.favorite-item-card.selected','quality_toggle','<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20','model','请开始整合。','ai-avatar-input','\x20-\x20响应内容:\x20','\x22\x20class=\x22chat-image\x22>','渲染器','cancel-frame-settings-btn','操作已取消','Ephone','找不到匹配的书籍','某个时间','</div>\x0a\x20\x20\x20\x20','quote_reply','publish-to-announcement-btn','群里还没有任何消息。','days','data-clear-wizard-modal','vote','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22','.rules-category-pane','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>','模拟表情含义\x20\x22','https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','\x0a#\x20群成员列表\x20(你的总结目标)\x0a','status_msg','summaries','https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','ai-voice-id-input','正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...','minimaxModel','save-theme-preset-btn','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','抱歉，我拒绝了你的好友申请。','send-btn','pin','ai_image','repostComment','HTML\x20模板\x20(用\x20$1,\x20$2\x20引用)','请根据你的设定，生成你的日记内容。','utf-16le','导入书籍失败:','手动总结已完成！新的记忆已添加到“','进入投票','请输入有效的总金额！','聊天记录已成功分享到\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>','没有找到可导入的内容。','char-browser-history','split','chat-header-status','seed',']类型的消息。\x0a内容:\x20','当前通知版本\x20(','错误：尝试打开一个不存在的预设，ID:','\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片','”\x20将对你的称呼修改为\x20“','lrcContent','base_resp','邀请你视频通话','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>','自动总结成功：已成功添加\x201\x20条新的长期记忆！','AI\x20尝试使用一个不存在的群头像:\x20\x22','werewolf-player-selection-list','add-my-avatar-url-btn','visible','reset-nai-settings-btn','copy-timestamp-btn','cancel-create-post-btn','boxSizing','”的记忆和人设，生成全新的社交动态...','avatar_name','移出成员','\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！','changedTouches','https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','清理完成','https://i.postimg.cc/ThMMVfW4/10.jpg','AI们的茶话会','**[夜晚]**\x20平安夜。\x0a','📁\x20从本地上传','repost-cancel-btn','edit-last-response-btn','.world-book-category-pane[data-category-id=\x22','link-memory-toggle','color','fontUrl','selection-favorite-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>','\x22\x20(由\x20','nextSibling','reverse','reading-library-search-input','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','API\x20预设已保存！','https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','AI\x20(CPhone)\x20尝试使用一个不存在的表情:\x20\x22','now','导入失败','qzoneGroups','\x20---\x0a','waimai-request-modal','”的TTS功能已关闭，已禁止发起TTS请求。','call-message-bubble\x20ai-speech','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>','\x20首歌曲。','.message-wrapper','来自\x20','thoughts-history-list','linked-memory-selection','\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a','.char-screen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27','group','[系统提示：五子棋游戏已结束。最终结果是：','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','option','添加完成！\x0a\x0a成功添加\x20','已成功注入“切换到线上模式”的系统指令。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20触发了后台行动！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','world_info','点击下方上传','conversationIndex','确定要删除与\x20\x22','token-count-display','scale(0.8)','请输入新的内容：','link-source-input','char-memo-detail-title','AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','draggable-button-item','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','---\x20第\x20','isDragging',';\x22>','frame_8','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif','my-frame-content','发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a','transfer-sender-name','AI\x20角色\x20\x22','href','无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20','”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20','Language\x20switched.\x20The\x20page\x20will\x20reload\x20to\x20apply\x20changes.','https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','Music','equalsIgnoreCase','68711uTMJtp','https://image.novelai.net/ai/generate-image-stream','add-song-url-btn','countdown-date-input','\x0a-\x20**人设**:\x20','sharedHistory','cors_proxy','group-avatar-preview','readAsText','修改昵称','12p','✅\x20图片转换成功！🎨','justifyContent','save-chat-settings-btn','ephoneLastActiveTimestamp','提取的图片大小:','This\x20is\x20a\x20simulated\x20chat,\x20messages\x20cannot\x20be\x20sent','avatar-frame-modal','NPC\x20列表','cancel-variation-selection-btn','打开预设编辑器时发生严重错误:','等待回复失败:','.ai-generated-image','冗余数据清理流程已启动...','\x0a-\x20**最近与用户的互动**:\x20','chargingchange','无法从\x20SSE\x20响应中提取图片数据','AI\x20(独立行动)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a','add-new-product-category-btn','favorites-search-input','取消置顶','main','.draggable-button-item','personaPresets','https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','npc-name-input','cancel-douban-settings-btn','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','password','检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。','opacity','https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22','tables','<div\x20class=\x22post-comments-container\x22>','tencent','mode','确认清理','switchToMyPhone','pollTimestamp','updateListenTogetherIconProxy','upgrade','doubanActiveCharacterIds','\x0a\x0a#\x20情景感知:\x0a\x20\x20\x20\x20','通话中还没有你的发言，无法重新生成回应。','</p>\x0a\x20\x20\x20\x20','外观设置','++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','save-preset-btn','role','rule-name-input','annoId','frame_ribbon','import-single-chat-btn','album-item','indexOf','暂无内容...','\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动。\x0a3.\x20\x20**【简洁性铁律】**:\x20每条个人记忆总结【绝对不能超过60个字】。\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我今天在群里和大家讨论了电影，感觉很开心。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我在群里和','https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','save-api-preset-btn','编辑世界书','video-call-btn','GRID_SIZE','本次发送给AI的【挂载记忆】内容如下：\x0a','download','https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','.message-bubble[data-timestamp=\x22','请输入一个\x202\x20到\x20','请先从下拉框中选择一个要删除的预设。','https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','delete-appearance-preset-btn','music-playlist-btn','小红书','-\x20**你的好友**:\x20你和\x20','当前为渐变色','评论内容不能为空哦！','\x20元。','网易云音乐API未返回有效结果:','write','animate-like','[+]\x20添加新条目','cphoneWallpaper','close-reading-btn','startsWith','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','Memo','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','likesCount','\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“','relationship','minimax-group-id','album-screen','[ERROR:\x20','.photo-delete-btn','music-player-artist',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','calls','nai-smea','\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','secondaryApiKey','确认删除分类','确定要清空当前角色的NAI提示词配置吗？','maxMemory','世界书数据已成功恢复！','silent-audio-player','视频通话刚刚结束','...”)','#ff8a80','没有配置为后台活跃的角色，跳过模拟。','\x22]\x20.participant-avatar','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>','/9j/','save-frame-settings-btn','day','remove-ephone-bg-btn','https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','天\x20-\x20投票','char_memo','.entry-comment-input','https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','reload','nightActions',':</span>\x20','product-price-input','📋\x20直接粘贴歌词文本','stickerMeaning','ai_generated','back-to-clear-step1-btn','call-message-bubble\x20user-speech','不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>','.draggable-button-item:not(.dragging)','appearancePresets','\x20(用户)</label>','\x20的对话\x20(只读)','https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>','\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','export-world-book-btn','cancel-shopping-settings-btn','open-album-btn','rp-tab-group','douban-post-detail-screen','<span\x20class=\x22diary-underline\x22>$1</span>','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','\x20条旧的红包消息！页面将自动刷新以应用更改。','%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>','song_name','生成模拟日记失败:','[图片]','character_book','...\x22','profile-main-content','Http_Get_External','qzone-avatar-img','world-book-editor-title','(空)','.lyric-line[data-index=\x22','”的手机使用习惯...','spinning','\x20个表情包，且无法恢复！','\x22）。你已经有一段时间没有和用户（','add-new-sticker-category-btn','targetDate','”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','white','contact-picker-list','flat','cloneNode','decline_transfer','simulatedAmapHistory','#data-clear-char-list\x20.clear-posts-item.selected','https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','已重置为默认提示音，点击“保存所有外观设置”后生效。','#preset-tabs\x20.world-book-tab','https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>','callHistory','files','char-album-grid','translateY(','\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','editable-text','https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','api-temperature-slider','browser','create-countdown-modal','<span\x20class=\x22diary-handwritten\x22>$1</span>','modify','https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','import-btn','你已经死亡，无法发言。请等待其他玩家发言结束。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>','image/*','输入图片URL','chat_','CELL_SIZE','内容因安全策略被屏蔽\x20(原因:\x20','classList','bg-preview','assign-group-section','revokeObjectURL','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','input[name=\x22theme-select\x22]','background-activity-switch','\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22','cancel-post-action-btn','AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:','由于浏览器安全限制，AI切换的歌曲无法自动播放。请手动点击播放按钮\x20▶\x20继续欣赏。','groupId','rp-direct-amount','ZIP文件中未找到图片',':</strong>\x20','shared-history-viewer-modal','当你死亡时，你可以选择带走场上任意一名玩家。','...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】(','更换图片','\x0a\x0a现在，请开始生成这组备忘录。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://api.vkeys.cn/v2/music/netease/lyric?id=','\x0a\x0a#\x20当前情景\x0a','”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','.cart-item-checkbox:checked',':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>','</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥','content','生成模拟聊天失败:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20','poll','code','一键压缩本地图片','AI的五子棋移动指令包含无效坐标，已忽略:','-\x20你的毒药状态：','ArrowLeft','\x20(这是你的帖子)','@[[','🎬\x20推进剧情','阵营胜利！','无法获取模型列表','.delete-block-btn','insertBefore','chat-list-action-pin','This\x20is\x20a\x20font\x20preview\x20effect,\x2012345.','albumId','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>','isBgClear','nai-diffusion-4-5-full','收到数据，类型:','确定发布','notificationSoundUrl','chat-messages','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>','QQ音乐搜索API失败:','请先在API设置中配置反代地址、密钥并选择模型。','请输入相册名称','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','tableName','群里在','EPhone-Full-Backup-Streamed-','查验结果','[系统提示：用户\x20(','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>正在计算...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22>--</span>\x0a\x20\x20\x20\x20','.world-book-tab','import-preset-btn','✅\x20动态NovelAI图片全部生成完成:\x20','frame-action-bar','call_summary','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','\x20的动态\x20','album','https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','删除相册','preset-screen','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','容错解析：策略1成功\x20(找到并解析了完整的JSON对象)','.battery-level','Secondary\x20API\x20Key','未知设定的NPC','https://i.postimg.cc/prsGKMBx/IMG-4370.gif','\x20.message-bubble.ai\x20$1','-\x20你的狼队友是：','waimai-product-info','application/json','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','\x20的图片消息替换为文字描述...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22','#\x20你的互动对象\x20(用户和其他角色)\x0a','一点心意','chat-input-actions-top','chat-list-screen','chat-group-container','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','后台活动模拟已停止。','data-voice-id=\x22','char-product-grid','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20','\x0a##\x20---\x20来自','请用文字描述您要发送的照片：','phone-screen','，我们一起见证了这个约定。','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【【【长度铁律】】】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**','\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','已打包表:\x20','API请求失败\x20(','setProperty','【用户\x20(User)】','background-interval-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“','确定要恢复默认设置吗？','existing-categories-list','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','moveTo','，礼物是：','”的对话摘要**:\x0a','这是你们最近的对话：\x0a','Edit','add-group-avatar-batch-btn','Reset','”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','message-editor-modal','<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>','无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20','qzonePhotos','识图优化：正在将时间戳为\x20','stickerCategoryIds','rules-tab\x20active','transfer-note','#chat-list-bottom-nav\x20.nav-item','aiAvatar','save-member-settings-btn','-\x20用户的QZone昵称是\x20\x22','favid','批量导入头像','clear-search-btn','将清空选定角色的心声和散记历史。','删除规则','#npc-association-list\x20input:checked','https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','[收到一个外卖代付请求]','variation-options-container','的秘密档案：\x0a-\x20你的狼人杀身份是：【','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','未知NPC','image_url','<button\x20class=\x22sticker-category-tab\x20','postType','\x20发送了一条语音，内容是：\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','...\x0a-\x20**已有评论**:\x0a','manage-sticker-categories-btn','”分享TA的备忘录...','AI未能成功描述图片。','naiSettings','未知错误','，用户刚刚在\x20','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','imageCount','manage-product-categories-btn','a\x20random\x20product','找到图片文件:','Album','participant','size','导演模式保存了一个无效的五子棋移动指令:',')，祝福语是：“','cancel-clear-wizard-btn-step2','npc_','parentNode','utf-8','Chat\x20View\x20Initial\x20Load\x20Count','apply-friend-btn','(暂无有效聊天记录)\x0a','\x22\x20已经存在了，换个名字吧！','nai-test-negative','nai-sampler','Finish','https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','reply-preview-bar','游戏配置：','</span><span\x20class=\x22gift-preview-quantity\x22>x','authorName','#b5b5b5','https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20','编辑人设预设','https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20','在同时执行两个函数时出错:','comment','edit-post-btn','shopping-back-btn','请输入新的封面图片链接','请输入书名','当前页内容摘要','\x20更换了群头像','请输入新的背景图片链接','友善的评论是交流的起点','add-countdown-btn','\x20发送了一张图片，图片内容描述为：\x27','已被用户删除','\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“','save-wallpaper-btn','消息已更新！','gameLog','/v1/chat/completions','见面”）。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过100个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','highlighted','time-perception-toggle','\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','AI投票决策API失败:','serviceWorker','\x20向\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>','video_call_request','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>','\x20发布)\x0a','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a','regenerate-douban-btn','\x22\x20转发了动态\x20#','.link-share-card[data-timestamp]','presetId','list-item','rp-content-direct','请根据你的设定，生成你的浏览器记录。','\x20个条目。','announcement-item-actions','all','manage-preset-categories-btn','指定的数据已成功清除。',')}。\x0a-\x20**对话状态**:\x20','#data-clear-char-list\x20.clear-posts-item','mousemove','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','uncategorized','countdownEndTime','错误：找不到要删除的分类。','<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>','85135OeiUir','member-management-list','Favorite','https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','</span></div><div\x20class=\x22gift-items-preview\x22>','busy','offsetHeight','link-content-input','sort','index','werewolf-retry-btn','<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>','请为你的图片添加一个简单的描述（必填，给AI看的）！','close-group-manager-btn','.post-mode-switcher','正在接通...','rp-direct-greeting',')。详情:\x20','loadAsync','https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','mouseout','delete-product-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','Their\x20Browser\x20History','members','）刚刚撤回了一条消息。撤回前的内容是：','):\x20','qzone','post-public-text','Token\x20calculation\x20error:','精炼完成，请确认','\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20','<div\x20class=\x22post-images-grid\x20grid-','”说的申请理由：','请输入群聊的名字','productInfo','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','创建世界书','qzone-avatar-container','编辑通话消息','你现在在哪里呀？','按钮顺序已恢复为默认设置！','¥\x200.00','syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','原作者','操作成功','https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','block-chat-btn','cphone-icon-img-','Caching\x20rendering\x20rules\x20for\x20chat:\x20','转账已被拒收','\x22)\x20作为角色名。消息内容:','regenerate-char-amap-btn','”申请好友时发生错误：\x0a\x0a','regenerate-char-taobao-btn','来源网站','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','fontFamily','favoritedPostIds','https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','offline-min-length-input','这个分类下还没有商品哦~','正在读取并解析备份文件...','cancel-message-action-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>计算图片大小时出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>Error</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','/v1/models','lyric-line','Presets','\x0a-\x20**角色人设**:\x20','选定范围内的动态已被清空。','add-to-cart-btn','篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','单个红包金额不能少于0.01元！','清理失败','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','++id,\x20chatId,\x20timestamp,\x20customName','select-all-types-for-clear','announcement-actions-modal','#settings-preview-area','旁观模式AI尝试使用不存在的表情:\x20\x22','back-to-char-qq-list-btn','更换歌曲背景','数据迁移完成！总共修复了\x20','150','++id,\x20albumId','Enable\x20NovelAI\x20Image\x20Generation','startY','未知书籍','正在检查\x20','小时内退还。','variation-increase-qty','...\x22)','select-message-btn','battery-alert-image','numeric','加载更早的会话','nai-default-positive','favorites-list','</div></div>','en-US','一位朋友','parentElement','文件解析或应用失败:\x20','nai-result-image','draggable','transfer-cancel-btn','secondary-proxy-url','single-char-background-activity-group','\x22\x20触发行动决策...','some','fullPrompt','新建备忘录','\x20本世界书已成功删除。','加载中...','text-image-mode-content','authorId','character-nai-prompts-modal','\x22]:checked','sourceChatName','你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20','rp-details-summary','import-card-input','”的特点生成专属商品...','simulatedMusicPlaylist','share-location-btn','location','\x20删除了自己的一条动态]','清空动态时发生错误:\x20','.message-editor-block','语音模型\x20(Model)','stopPropagation','请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。','请先配置NovelAI\x20API\x20Key！','anyOf'];_0x821e=function(){return _0x5d4a05;};return _0x821e();}const GEMINI_API_URL=_0x5195a0(0x397);function getRandomValue(_0x8afda0){const _0x3a9c14=_0x5195a0;if(_0x8afda0[_0x3a9c14(0xee2)](',')){const _0x4b8ca7=_0x8afda0[_0x3a9c14(0x105d)](',')[_0x3a9c14(0xa79)](_0x435e72=>_0x435e72[_0x3a9c14(0x1cb)]()),_0x220229=Math['floor'](Math['random']()*_0x4b8ca7[_0x3a9c14(0xfde)]);return _0x4b8ca7[_0x220229];}return _0x8afda0;}function isImage(_0x2229fa){const _0x33b6bd=_0x5195a0;if(_0x2229fa[_0x33b6bd(0x122d)]&&_0x2229fa[_0x33b6bd(0x122d)][_0x33b6bd(0x2fa)]){let _0xe0de2a=_0x2229fa[_0x33b6bd(0x122d)]['url'];const _0x4f798c=_0xe0de2a[_0x33b6bd(0x105d)](',')[0x1],_0x22ddfd=_0xe0de2a[_0x33b6bd(0x22e)](/^data:(.*);base64/)[0x1];return[{'text':_0x33b6bd(0x635)},{'inline_data':{'mime_type':_0x22ddfd,'data':_0x4f798c}}];}return[];}function getGeminiResponseText(_0x113412){const _0x289015=_0x5195a0;if(_0x113412[_0x289015(0xe77)]&&Array['isArray'](_0x113412[_0x289015(0xe77)])&&_0x113412['choices'][_0x289015(0xfde)]>0x0&&_0x113412['choices'][0x0][_0x289015(0x5f8)]&&_0x113412[_0x289015(0xe77)][0x0][_0x289015(0x5f8)][_0x289015(0x11b6)])return _0x113412[_0x289015(0xe77)][0x0][_0x289015(0x5f8)][_0x289015(0x11b6)];if(_0x113412[_0x289015(0x5fa)]&&Array[_0x289015(0x565)](_0x113412['candidates'])&&_0x113412[_0x289015(0x5fa)]['length']>0x0&&_0x113412[_0x289015(0x5fa)][0x0][_0x289015(0x11b6)]&&_0x113412['candidates'][0x0][_0x289015(0x11b6)][_0x289015(0xf6d)])return _0x113412['candidates'][0x0][_0x289015(0x11b6)][_0x289015(0xf6d)][0x0][_0x289015(0x6af)];console[_0x289015(0x98)]('Gemini\x20API返回了非预期的格式:',_0x113412);let _0x74833c='AI返回了空内容或未知格式。';if(_0x113412[_0x289015(0x5fa)]&&Array[_0x289015(0x565)](_0x113412[_0x289015(0x5fa)])&&_0x113412[_0x289015(0x5fa)][_0x289015(0xfde)]>0x0&&_0x113412[_0x289015(0x5fa)][0x0][_0x289015(0xff2)]===_0x289015(0xbfd)){const _0x235425=_0x113412['candidates'][0x0][_0x289015(0x7a0)],_0x5a847d=_0x235425[_0x289015(0x98a)](_0xfb78ba=>_0xfb78ba[_0x289015(0x169)]!=='NEGLIGIBLE'&&_0xfb78ba[_0x289015(0x169)]!==_0x289015(0xb25))['map'](_0x1f7684=>_0x1f7684[_0x289015(0x62e)]+_0x289015(0xb78)+_0x1f7684[_0x289015(0x169)]+')')[_0x289015(0xa35)](',\x20');_0x74833c='内容因安全策略被屏蔽。触发类别:\x20'+(_0x5a847d||'未知');}else{if(_0x113412[_0x289015(0xdb6)]?.['blockReason']){const _0x5650b6=_0x113412[_0x289015(0xdb6)][_0x289015(0x126)],_0x28aca2=_0x113412[_0x289015(0xdb6)][_0x289015(0x7a0)]?.['map'](_0x39998a=>_0x39998a['category']+':\x20'+_0x39998a[_0x289015(0x169)])[_0x289015(0xa35)](',\x20');_0x74833c=_0x289015(0x1199)+_0x5650b6+_0x289015(0x129f)+(_0x28aca2||'无');}else _0x113412[_0x289015(0x98)]&&(_0x74833c=_0x289015(0x50f)+_0x113412[_0x289015(0x98)]['message']);}throw new Error(_0x74833c);}document['addEventListener'](_0x5195a0(0x469),()=>{const _0x549949=_0x5195a0;document[_0x549949(0x271)](_0x549949(0x323),()=>{const _0x20f473=_0x549949;document['visibilityState']===_0x20f473(0x106d)&&(console[_0x20f473(0xe72)](_0x20f473(0x54c)),navigator[_0x20f473(0x1271)][_0x20f473(0x3fe)]['then'](_0x49382f=>{const _0x26b686=_0x20f473;_0x49382f[_0x26b686(0xaf9)]();}));});function _0x112768(_0x5ee692,_0x209270,_0x368770,_0x43a812){const _0x3dd375=_0x549949,_0x45dd0f=_0x41df36[_0x3dd375(0xc0)]['apiTemperature']||0.8,_0x3ae511={'user':_0x3dd375(0x66e),'assistant':_0x3dd375(0x102c),'system':'user'},_0x33cc1c=[{'role':_0x3dd375(0x66e),'parts':[{'text':_0x368770}]},{'role':_0x3dd375(0x102c),'parts':[{'text':_0x3dd375(0x791)}]},..._0x43a812['map'](_0x5680b5=>{const _0x47a998=_0x3dd375,_0x5e7730=[];return Array[_0x47a998(0x565)](_0x5680b5[_0x47a998(0x11b6)])?_0x5680b5[_0x47a998(0x11b6)][_0x47a998(0x19c)](_0xd80c=>{const _0x6b57a6=_0x47a998;if(_0xd80c[_0x6b57a6(0xa6b)]==='text')_0x5e7730[_0x6b57a6(0x258)]({'text':_0xd80c[_0x6b57a6(0x6af)]});else{if(_0xd80c[_0x6b57a6(0xa6b)]===_0x6b57a6(0x122d)&&_0xd80c[_0x6b57a6(0x122d)]&&_0xd80c[_0x6b57a6(0x122d)][_0x6b57a6(0x2fa)]){const _0xbbda1c=_0xd80c[_0x6b57a6(0x122d)][_0x6b57a6(0x2fa)],_0x39ee83=_0xbbda1c['split'](',')[0x1],_0x7c0e79=_0xbbda1c[_0x6b57a6(0x22e)](/^data:(.*);base64/);_0x7c0e79&&_0x39ee83&&_0x5e7730[_0x6b57a6(0x258)]({'inline_data':{'mime_type':_0x7c0e79[0x1],'data':_0x39ee83}});}}}):_0x5e7730[_0x47a998(0x258)]({'text':String(_0x5680b5[_0x47a998(0x11b6)])}),{'role':_0x3ae511[_0x5680b5['role']],'parts':_0x5e7730};})];return{'url':_0x3dd375(0x137c)+_0x5ee692+_0x3dd375(0xe32)+getRandomValue(_0x209270),'data':{'method':_0x3dd375(0x94f),'headers':{'Content-Type':'application/json'},'body':JSON[_0x3dd375(0x3fb)]({'contents':_0x33cc1c,'generationConfig':{'temperature':_0x45dd0f}})}};}const _0x342df8=new Dexie(_0x549949(0x860)),_0x3ee27f=[{'id':_0x549949(0xa70),'url':'','name':'无'},{'id':_0x549949(0x579),'url':_0x549949(0x80c),'name':'1'},{'id':_0x549949(0x1102),'url':_0x549949(0x82e),'name':'2'},{'id':_0x549949(0x895),'url':_0x549949(0xb01),'name':'3'},{'id':_0x549949(0xec5),'url':'https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','name':'4'},{'id':_0x549949(0xd09),'url':_0x549949(0xfe7),'name':'5'},{'id':_0x549949(0xc57),'url':'https://i.postimg.cc/63sDQKMm/IMG-6893.gif','name':'6'},{'id':_0x549949(0x59c),'url':_0x549949(0xe7),'name':'7'},{'id':_0x549949(0x10b5),'url':'https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','name':'8'},{'id':_0x549949(0xf7b),'url':_0x549949(0xa69),'name':'9'},{'id':'frame_10','url':'https://i.postimg.cc/63NmX03s/IMG-4366.gif','name':'10'},{'id':'frame_11','url':_0x549949(0xb66),'name':'11'},{'id':_0x549949(0xdac),'url':_0x549949(0x11ec),'name':'12'},{'id':_0x549949(0xefd),'url':_0x549949(0x8e1),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0xd30),'name':'14'},{'id':_0x549949(0x579),'url':_0x549949(0x366),'name':'1'},{'id':_0x549949(0x1102),'url':_0x549949(0xf62),'name':'2'},{'id':_0x549949(0x895),'url':_0x549949(0xd1f),'name':'3'},{'id':_0x549949(0xec5),'url':_0x549949(0x16f),'name':'4'},{'id':'frame_5','url':'https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','name':'5'},{'id':'frame_6','url':'https://i.postimg.cc/05wnd389/IMG-4388.gif','name':'6'},{'id':_0x549949(0x59c),'url':_0x549949(0x78c),'name':'7'},{'id':_0x549949(0x10b5),'url':'https://i.postimg.cc/fLTc42dg/IMG-4391.gif','name':'8'},{'id':_0x549949(0xf7b),'url':'https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','name':'9'},{'id':'frame_10','url':_0x549949(0x916),'name':'10'},{'id':_0x549949(0x5c2),'url':'https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif','name':'11'},{'id':_0x549949(0xdac),'url':_0x549949(0x99f),'name':'12'},{'id':'frame_13','url':_0x549949(0x65b),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x54b),'name':'14'},{'id':_0x549949(0x579),'url':_0x549949(0xdaf),'name':'1'},{'id':'frame_ribbon','url':'https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','name':'2'},{'id':_0x549949(0x895),'url':'https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','name':'3'},{'id':_0x549949(0xec5),'url':_0x549949(0x3fc),'name':'4'},{'id':_0x549949(0xd09),'url':_0x549949(0x346),'name':'5'},{'id':_0x549949(0xc57),'url':_0x549949(0x854),'name':'6'},{'id':_0x549949(0x59c),'url':_0x549949(0x1d3),'name':'7'},{'id':_0x549949(0x10b5),'url':'https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','name':'8'},{'id':_0x549949(0xf7b),'url':_0x549949(0x12c9),'name':'9'},{'id':_0x549949(0xf98),'url':_0x549949(0x1336),'name':'10'},{'id':_0x549949(0x5c2),'url':_0x549949(0x124e),'name':'11'},{'id':_0x549949(0xdac),'url':_0x549949(0xf7),'name':'12'},{'id':_0x549949(0xefd),'url':_0x549949(0x927),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x12bc),'name':'14'},{'id':_0x549949(0x579),'url':_0x549949(0x839),'name':'1'},{'id':_0x549949(0x1102),'url':_0x549949(0x27b),'name':'2'},{'id':_0x549949(0x895),'url':_0x549949(0x845),'name':'3'},{'id':_0x549949(0xec5),'url':_0x549949(0x29d),'name':'4'},{'id':_0x549949(0xd09),'url':'https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','name':'5'},{'id':'frame_6','url':_0x549949(0x130),'name':'6'},{'id':_0x549949(0x59c),'url':_0x549949(0xb6e),'name':'7'},{'id':'frame_8','url':_0x549949(0x780),'name':'8'},{'id':_0x549949(0xf7b),'url':_0x549949(0x737),'name':'9'},{'id':_0x549949(0xf98),'url':_0x549949(0x205),'name':'10'},{'id':_0x549949(0x5c2),'url':'https://i.postimg.cc/fRTF24jS/IMG-4430.gif','name':'11'},{'id':_0x549949(0xdac),'url':'https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','name':'12'},{'id':_0x549949(0xefd),'url':_0x549949(0x1353),'name':'13'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','name':'14'},{'id':'frame_cat_ear','url':_0x549949(0xca1),'name':'1'},{'id':_0x549949(0x1102),'url':_0x549949(0xb91),'name':'2'},{'id':_0x549949(0x895),'url':'https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','name':'3'},{'id':_0x549949(0xec5),'url':_0x549949(0x930),'name':'4'},{'id':_0x549949(0xd09),'url':_0x549949(0x198),'name':'5'},{'id':_0x549949(0xc57),'url':_0x549949(0x361),'name':'6'},{'id':_0x549949(0x59c),'url':_0x549949(0xb87),'name':'7'},{'id':_0x549949(0x10b5),'url':_0x549949(0x553),'name':'8'},{'id':_0x549949(0xf7b),'url':_0x549949(0xcb),'name':'9'},{'id':'frame_10','url':_0x549949(0x94b),'name':'10'},{'id':_0x549949(0x5c2),'url':_0x549949(0x1227),'name':'11'},{'id':_0x549949(0xdac),'url':_0x549949(0xeac),'name':'12'},{'id':_0x549949(0xefd),'url':_0x549949(0xf30),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0xab6),'name':'14'},{'id':_0x549949(0x579),'url':'https://i.postimg.cc/CKgDNYVb/IMG-5577.gif','name':'1'},{'id':_0x549949(0x1102),'url':_0x549949(0xd5f),'name':'2'},{'id':_0x549949(0x895),'url':_0x549949(0xd5f),'name':'3'},{'id':_0x549949(0xec5),'url':_0x549949(0xf64),'name':'4'},{'id':_0x549949(0xd09),'url':'https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','name':'5'},{'id':_0x549949(0xc57),'url':_0x549949(0xdcb),'name':'6'},{'id':_0x549949(0x59c),'url':'https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','name':'7'},{'id':'frame_8','url':_0x549949(0x1317),'name':'8'},{'id':'frame_9','url':_0x549949(0x1182),'name':'9'},{'id':_0x549949(0xf98),'url':_0x549949(0xea6),'name':'10'},{'id':'frame_11','url':_0x549949(0x838),'name':'11'},{'id':_0x549949(0xdac),'url':_0x549949(0xba1),'name':'12'},{'id':_0x549949(0xefd),'url':_0x549949(0x4a9),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0xab7),'name':'14'},{'id':_0x549949(0x579),'url':'https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','name':'1'},{'id':_0x549949(0x1102),'url':_0x549949(0x8f6),'name':'2'},{'id':_0x549949(0x895),'url':_0x549949(0xd82),'name':'3'},{'id':'frame_tech','url':'https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','name':'4'},{'id':_0x549949(0xd09),'url':'https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','name':'5'},{'id':_0x549949(0xc57),'url':_0x549949(0xdc2),'name':'6'},{'id':_0x549949(0x59c),'url':_0x549949(0x1a6),'name':'7'},{'id':_0x549949(0x10b5),'url':_0x549949(0x705),'name':'8'},{'id':_0x549949(0xf7b),'url':_0x549949(0xfe4),'name':'9'},{'id':'frame_10','url':_0x549949(0x95b),'name':'10'},{'id':'frame_11','url':_0x549949(0x5fe),'name':'11'},{'id':_0x549949(0xdac),'url':'https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','name':'12'},{'id':'frame_13','url':_0x549949(0x70b),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x564),'name':'14'},{'id':_0x549949(0x579),'url':_0x549949(0x1159),'name':'1'},{'id':_0x549949(0x1102),'url':'https://i.postimg.cc/k45sd8gn/IMG-6375.gif','name':'2'},{'id':_0x549949(0x895),'url':_0x549949(0x45b),'name':'3'},{'id':_0x549949(0xec5),'url':_0x549949(0x45e),'name':'4'},{'id':_0x549949(0xd09),'url':'https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','name':'5'},{'id':_0x549949(0xc57),'url':'https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','name':'6'},{'id':_0x549949(0x59c),'url':'https://i.postimg.cc/gkhf597g/IMG-6555.gif','name':'7'},{'id':_0x549949(0x10b5),'url':_0x549949(0xaf),'name':'8'},{'id':_0x549949(0xf7b),'url':_0x549949(0xf37),'name':'9'},{'id':_0x549949(0xf98),'url':'https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','name':'10'},{'id':_0x549949(0x5c2),'url':_0x549949(0xa44),'name':'11'},{'id':_0x549949(0xdac),'url':_0x549949(0x596),'name':'12'},{'id':_0x549949(0xefd),'url':_0x549949(0x1124),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x584),'name':'14'},{'id':'frame_cat_ear','url':_0x549949(0x8f9),'name':'1'},{'id':'frame_ribbon','url':'https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','name':'2'},{'id':_0x549949(0x895),'url':_0x549949(0x3d8),'name':'3'},{'id':'frame_tech','url':'https://i.postimg.cc/fycfcvHf/IMG-6569.gif','name':'4'},{'id':_0x549949(0xd09),'url':'https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','name':'5'},{'id':_0x549949(0xc57),'url':_0x549949(0xa3f),'name':'6'},{'id':'frame_7','url':'https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','name':'7'},{'id':_0x549949(0x10b5),'url':'https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','name':'8'},{'id':_0x549949(0xf7b),'url':_0x549949(0x696),'name':'9'},{'id':_0x549949(0xf98),'url':_0x549949(0xdf3),'name':'10'},{'id':'frame_11','url':_0x549949(0xb69),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/28TsrxRV/IMG-6852.gif','name':'12'},{'id':_0x549949(0xefd),'url':'https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x118a),'name':'14'},{'id':_0x549949(0x579),'url':'https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','name':'1'},{'id':_0x549949(0x1102),'url':'https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','name':'2'},{'id':_0x549949(0x895),'url':_0x549949(0x9a2),'name':'3'},{'id':_0x549949(0xec5),'url':'https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','name':'4'},{'id':'frame_5','url':_0x549949(0xfba),'name':'5'},{'id':'frame_6','url':_0x549949(0x10ed),'name':'6'},{'id':'frame_7','url':_0x549949(0xce1),'name':'7'},{'id':_0x549949(0x10b5),'url':'https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','name':'8'},{'id':_0x549949(0xf7b),'url':_0x549949(0xad7),'name':'9'},{'id':_0x549949(0xf98),'url':_0x549949(0x285),'name':'10'},{'id':_0x549949(0x5c2),'url':_0x549949(0x7f0),'name':'11'},{'id':_0x549949(0xdac),'url':'https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','name':'12'},{'id':_0x549949(0xefd),'url':_0x549949(0x124f),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0xd9c),'name':'14'},{'id':_0x549949(0x5c2),'url':_0x549949(0x77e),'name':'11'},{'id':_0x549949(0xdac),'url':_0x549949(0x12c6),'name':'12'},{'id':'frame_13','url':_0x549949(0x444),'name':'13'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/sDFhySn3/IMG-6936.gif','name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0x133a),'name':'13'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0xf90),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0xc94),'name':'14'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0x3cb),'name':'13'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif','name':'14'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','name':'14'},{'id':_0x549949(0xdac),'url':_0x549949(0x1077),'name':'12'},{'id':_0x549949(0xefd),'url':_0x549949(0x756),'name':'13'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','name':'14'},{'id':'frame_13','url':_0x549949(0xd94),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0xe45),'name':'14'},{'id':_0x549949(0xefd),'url':'https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','name':'13'},{'id':'frame_14','url':_0x549949(0x1258),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0xf7a),'name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0x242),'name':'13'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','name':'14'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0x317),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x2cf),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0xb27),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x7ed),'name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0xf59),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x5b5),'name':'14'},{'id':'frame_13','url':_0x549949(0x12a1),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x238),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x567),'name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0x714),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x110f),'name':'14'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','name':'14'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','name':'14'},{'id':'frame_13','url':_0x549949(0x1145),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x1113),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x422),'name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0x89e),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x19d),'name':'14'},{'id':'frame_14','url':_0x549949(0x315),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x3f8),'name':'14'},{'id':'frame_13','url':_0x549949(0xe54),'name':'13'},{'id':'frame_14','url':_0x549949(0x8f3),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x813),'name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0x54a),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','name':'14'},{'id':'frame_14','url':_0x549949(0x108b),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0xb0a),'name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0x1047),'name':'13'},{'id':'frame_14','url':_0x549949(0xcb9),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0xa4c),'name':'14'},{'id':'frame_13','url':_0x549949(0x76a),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0xc07),'name':'14'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0x11e3),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0xe6c),'name':'14'},{'id':'frame_14','url':_0x549949(0x100),'name':'14'},{'id':_0x549949(0xefd),'url':'https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif','name':'13'},{'id':'frame_14','url':_0x549949(0xe88),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x5ac),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x96b),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x633),'name':'14'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/W40f9qtd/IMG-7098.gif','name':'14'},{'id':_0x549949(0xefd),'url':'https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x6d6),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0xb50),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/xTk5xN49/IMG-7233.gif','name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0x1320),'name':'13'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/yx2m4nbs/IMG-7231.gif','name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x7d6),'name':'14'},{'id':_0x549949(0xefd),'url':'https://i.postimg.cc/pddJj9zN/IMG-7094.gif','name':'13'},{'id':'frame_14','url':_0x549949(0x834),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x1191),'name':'14'},{'id':'frame_14','url':_0x549949(0x97f),'name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0xae4),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x10e6),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x59d),'name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0x1255),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x1108),'name':'14'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/fyyGgW61/IMG-7115.gif','name':'14'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0xb0f),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x1149),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x1b0),'name':'14'},{'id':_0x549949(0xefd),'url':'https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x1da),'name':'14'},{'id':'frame_14','url':_0x549949(0x716),'name':'14'},{'id':'frame_14','url':_0x549949(0x492),'name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0x2ec),'name':'13'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0xbeb),'name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0xdfa),'name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0x458),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x10c0),'name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x26f),'name':'14'},{'id':_0x549949(0xefd),'url':_0x549949(0xa85),'name':'13'},{'id':_0x549949(0xb9f),'url':'https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','name':'14'},{'id':_0x549949(0xb9f),'url':_0x549949(0x1043),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/bJDMQVkj/IMG-7112.gif','name':'13'},{'id':_0x549949(0xb9f),'url':_0x549949(0xcf1),'name':'14'},{'id':'frame_14','url':_0x549949(0x337),'name':'14'}];let _0x41df36={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map()},_0x22cd06={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':_0x549949(0x96f),'nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0x237e84=0x0;const _0x4cfe50=0xf;let _0x482fde=0x0;const _0x2ef398=0xa;let _0x3c5f19=[],_0x40e606={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':_0x549949(0xe40),'totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0x438dad={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x17f24d=document['getElementById'](_0x549949(0x4e1));let _0x422ebc=null,_0x80fd3b=![],_0x12646a=0x0,_0x1b52d4=null,_0x219308=![],_0x45a6e6=_0x549949(0x1282),_0x4f051e=new Set(),_0x5f3c03=null,_0x4ac0e8=![],_0x5a1c70=null,_0x223e60=null,_0x4c00a8=![],_0x6a317c=![],_0x13b461=![],_0x6da8df=![],_0x50e27e=[],_0x401ae0=null,_0x4ddca6=null,_0x33206f={},_0x7c8ee8=null,_0x18c6a2=null,_0x5bdf0e=null,_0x142211=null,_0x5c2bda=null,_0x4df75e=null,_0x140106=null,_0x51a1bd=[],_0x34229b=null,_0x183f15=null,_0x403266=new Set(),_0x57bd10=null,_0x5efd5e=null,_0x5af1a3=null,_0x4b0146={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x3a006f=0x0,_0x281701=![],_0x48f82c=new Set(),_0x595b58=null;const _0x5dc108='https://i.postimg.cc/PxZrFFFL/o-o-1.jpg',_0x188ace=_0x549949(0x16d),_0x59100f=_0x549949(0xa32),_0x3e0950='https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg';let _0x5309e6,_0x30d5f3={};const _0x39eb4d=_0x549949(0x901);let _0x35c099={},_0x566c51={},_0x28b235=null;const _0x4a76c3={'qq':_0x549949(0x7db),'world-book':_0x549949(0x1291),'wallpaper':_0x549949(0xd46),'renderer':_0x549949(0xd6a),'api-settings':_0x549949(0x3bf),'font':'https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','char-phone':'https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','douban':_0x549949(0xf2),'preset':'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg','tutorial':_0x549949(0xf0a),'werewolf':_0x549949(0x460),'x':_0x549949(0x9f4)},_0x2ed233={'qq':'https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','album':_0x549949(0x1291),'browser':'https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','taobao':'https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','memo':_0x549949(0xf3d),'diary':_0x549949(0x320),'amap':_0x549949(0xc30),'usage':_0x549949(0x1342),'music':_0x549949(0x117f),'ephone':'https://i.postimg.cc/pXj9h20L/IMG-7275.jpg'};let _0x247f89=null;const _0x49f222=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0x2cf31b=0x0,_0x1f189a=0x1,_0x4c2e9e={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0x3c6bf2;const _0x2883c6=document[_0x549949(0xe1b)](_0x549949(0x655));_0x2883c6['id']='dynamic-font-style',document['head']['appendChild'](_0x2883c6);const _0x107627=document['getElementById'](_0x549949(0xe2c)),_0x24d45f=document[_0x549949(0x383)](_0x549949(0x7b6)),_0x32165b=document[_0x549949(0x383)]('custom-modal-body'),_0x1171d7=document[_0x549949(0x383)](_0x549949(0xd4a)),_0x325f7e=document['getElementById'](_0x549949(0x318));let _0x38a70c;function _0x48fc69(){const _0x3cf14b=_0x549949;_0x107627[_0x3cf14b(0x119a)][_0x3cf14b(0xbff)](_0x3cf14b(0x106d));}function _0x4a895a(){const _0x4740d7=_0x549949;_0x107627[_0x4740d7(0x119a)][_0x4740d7(0x131d)](_0x4740d7(0x106d)),_0x1171d7[_0x4740d7(0x119a)][_0x4740d7(0x131d)](_0x4740d7(0x51b));if(_0x38a70c)_0x38a70c(null);}function _0x368cae(_0x5229eb){const _0x28a1e3=_0x549949,_0x28fbb8=document[_0x28a1e3(0x383)](_0x28a1e3(0x61c)),_0x2b02ab=_0x5229eb['settings'][_0x28a1e3(0xe11)]||{'vertical':'top','horizontal':_0x28a1e3(0x699),'offset':0xa};_0x28fbb8[_0x28a1e3(0x655)][_0x28a1e3(0x994)]=_0x28a1e3(0xa60),_0x28fbb8[_0x28a1e3(0x655)][_0x28a1e3(0xbe3)]=_0x28a1e3(0xa60),_0x28fbb8[_0x28a1e3(0x655)][_0x28a1e3(0x402)]=_0x28a1e3(0xa60),_0x28fbb8[_0x28a1e3(0x655)]['right']='auto',_0x28fbb8['style']['transform']=_0x28a1e3(0xa70);_0x2b02ab[_0x28a1e3(0xf01)]==='top'?_0x28fbb8['style'][_0x28a1e3(0x994)]=_0x2b02ab[_0x28a1e3(0x375)]+'px':_0x28fbb8[_0x28a1e3(0x655)][_0x28a1e3(0xbe3)]=_0x2b02ab[_0x28a1e3(0x375)]+'px';switch(_0x2b02ab[_0x28a1e3(0x219)]){case _0x28a1e3(0x402):_0x28fbb8[_0x28a1e3(0x655)][_0x28a1e3(0x402)]=_0x28a1e3(0x4bb);break;case'right':_0x28fbb8[_0x28a1e3(0x655)][_0x28a1e3(0xa12)]=_0x28a1e3(0x4bb);break;case'center':default:_0x28fbb8[_0x28a1e3(0x655)][_0x28a1e3(0x402)]=_0x28a1e3(0x79f),_0x28fbb8[_0x28a1e3(0x655)]['transform']=_0x28a1e3(0xcab);break;}}async function _0x57649c(_0x33b1ec){const _0x55db21=_0x549949,_0x32c3c4=_0x33b1ec[_0x55db21(0xfab)][_0x55db21(0x1185)][0x0];if(!_0x32c3c4)return;const _0x351436=await new Promise(_0x11c48b=>{const _0x434483=_0x55db21,_0xf4c94d=new FileReader();_0xf4c94d[_0x434483(0xb5b)]=()=>_0x11c48b(_0xf4c94d[_0x434483(0xa86)]),_0xf4c94d['readAsDataURL'](_0x32c3c4);});await _0x296ef9(_0x55db21(0x4a6),_0x55db21(0x480));try{const _0x20f6bc=await _0x363adf(_0x351436);if(!_0x20f6bc)throw new Error(_0x55db21(0x1235));const _0x2f8afd=_0x41df36[_0x55db21(0x864)][_0x41df36[_0x55db21(0xfc5)]];!_0x2f8afd[_0x55db21(0x886)][_0x55db21(0x34a)]&&(_0x2f8afd[_0x55db21(0x886)][_0x55db21(0x34a)]=[]),_0x2f8afd[_0x55db21(0x886)][_0x55db21(0x34a)]['push']({'name':_0x20f6bc,'url':_0x351436}),await _0x342df8['chats']['put'](_0x2f8afd),_0xa3062b(),await _0x296ef9(_0x55db21(0x660),_0x55db21(0x28a)+_0x20f6bc+'”');}catch(_0x2ddecb){console[_0x55db21(0x98)](_0x55db21(0x7a6),_0x2ddecb),await _0x296ef9(_0x55db21(0xa55),'无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20'+_0x2ddecb[_0x55db21(0x5f8)]);}finally{_0x33b1ec[_0x55db21(0xfab)]['value']=null;}}async function _0x51f2f8(_0x339bd2){const _0x53edf4=_0x549949,_0x36e44a=_0x339bd2[_0x53edf4(0xfab)][_0x53edf4(0x1185)][0x0];if(!_0x36e44a)return;const _0x516a93=await new Promise(_0x418d3=>{const _0x1d5ab2=_0x53edf4,_0x4cab3d=new FileReader();_0x4cab3d['onload']=()=>_0x418d3(_0x4cab3d[_0x1d5ab2(0xa86)]),_0x4cab3d[_0x1d5ab2(0x132a)](_0x36e44a);});await _0x296ef9(_0x53edf4(0x4a6),_0x53edf4(0x7d8));try{const _0x185800=await _0x363adf(_0x516a93);if(!_0x185800)throw new Error(_0x53edf4(0x1235));const _0x403bf2=_0x41df36[_0x53edf4(0x864)][_0x41df36[_0x53edf4(0xfc5)]];!_0x403bf2[_0x53edf4(0x886)][_0x53edf4(0x7fa)]&&(_0x403bf2[_0x53edf4(0x886)]['aiAvatarLibrary']=[]),_0x403bf2[_0x53edf4(0x886)]['aiAvatarLibrary'][_0x53edf4(0x258)]({'name':_0x185800,'url':_0x516a93}),await _0x342df8[_0x53edf4(0x864)][_0x53edf4(0x9c0)](_0x403bf2),_0x10dc94(),await _0x296ef9(_0x53edf4(0x660),_0x53edf4(0x1325)+_0x185800+'”');}catch(_0x25f059){console[_0x53edf4(0x98)](_0x53edf4(0x33b),_0x25f059),await _0x296ef9(_0x53edf4(0xa55),_0x53edf4(0xed5)+_0x25f059[_0x53edf4(0x5f8)]);}finally{_0x339bd2[_0x53edf4(0xfab)][_0x53edf4(0x1be)]=null;}}async function _0x363adf(_0x27bb94){const _0x1ff918=_0x549949,_0x34c452=_0x41df36['apiConfig']['secondaryProxyUrl']&&_0x41df36[_0x1ff918(0x673)][_0x1ff918(0x1135)]&&_0x41df36[_0x1ff918(0x673)][_0x1ff918(0x782)],{proxyUrl:_0x34fa94,apiKey:_0x43c126,model:_0x23c9e3}=_0x34c452?{'proxyUrl':_0x41df36[_0x1ff918(0x673)]['secondaryProxyUrl'],'apiKey':_0x41df36['apiConfig'][_0x1ff918(0x1135)],'model':_0x41df36[_0x1ff918(0x673)]['secondaryModel']}:_0x41df36[_0x1ff918(0x673)];if(!_0x34fa94||!_0x43c126||!_0x23c9e3)throw new Error(_0x1ff918(0x9a9));const _0x247515='请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。';let _0x3ab302=_0x34fa94[_0x1ff918(0xee2)](_0x1ff918(0xdc3)),_0x31de8d;if(_0x3ab302){const _0x258488=_0x27bb94[_0x1ff918(0x22e)](/^data:(.*);base64/)[0x1],_0x153518=_0x27bb94[_0x1ff918(0x105d)](',')[0x1],_0x258283={'contents':[{'parts':[{'text':_0x247515},{'inline_data':{'mime_type':_0x258488,'data':_0x153518}}]}]};_0x31de8d=await fetch(_0x34fa94+'/'+_0x23c9e3+':generateContent?key='+_0x43c126,{'method':_0x1ff918(0x94f),'headers':{'Content-Type':_0x1ff918(0x11f0)},'body':JSON[_0x1ff918(0x3fb)](_0x258283)});}else{const _0x4fe613={'model':_0x23c9e3,'messages':[{'role':'user','content':[{'type':_0x1ff918(0x6af),'text':_0x247515},{'type':'image_url','image_url':{'url':_0x27bb94}}]}],'max_tokens':0x32};_0x31de8d=await fetch(_0x34fa94+_0x1ff918(0x126b),{'method':_0x1ff918(0x94f),'headers':{'Content-Type':_0x1ff918(0x11f0),'Authorization':_0x1ff918(0xd55)+_0x43c126},'body':JSON[_0x1ff918(0x3fb)](_0x4fe613)});}if(!_0x31de8d['ok']){const _0x398dcd=await _0x31de8d[_0x1ff918(0x9b3)]();throw new Error('API\x20错误:\x20'+_0x398dcd[_0x1ff918(0x98)][_0x1ff918(0x5f8)]);}const _0x4696b6=await _0x31de8d['json']();let _0x1ffcbc=_0x3ab302?getGeminiResponseText(_0x4696b6):_0x4696b6[_0x1ff918(0xe77)][0x0][_0x1ff918(0x5f8)][_0x1ff918(0x11b6)];return _0x1ffcbc[_0x1ff918(0x1cb)]()[_0x1ff918(0x709)](/["'“”‘’]/g,'');}async function _0x2d549c(_0x23dec2){const _0x492f7c=_0x549949;if(!_0x23dec2||_0x23dec2[_0x492f7c(0x1a2)]){console[_0x492f7c(0x17b)](_0x492f7c(0x12b9));return;}const _0x48cb44=_0x23dec2['id'],_0x27a91b=_0x23dec2['name'],_0x83e235=_0x23dec2['originalName'];console[_0x492f7c(0xe72)](_0x492f7c(0x7d3)+_0x48cb44+'\x20同步所有群聊内的名称信息...');for(const _0x573c3e in _0x41df36['chats']){const _0x2747ee=_0x41df36[_0x492f7c(0x864)][_0x573c3e];if(_0x2747ee[_0x492f7c(0x1a2)]&&_0x2747ee[_0x492f7c(0x12a6)]){const _0x2f3678=_0x2747ee['members']['find'](_0x509f48=>_0x509f48['id']===_0x48cb44);if(_0x2f3678){let _0x3da3cb=![];_0x2f3678['groupNickname']!==_0x27a91b&&(_0x2f3678[_0x492f7c(0x9da)]=_0x27a91b,_0x3da3cb=!![]),_0x2f3678[_0x492f7c(0x283)]!==_0x83e235&&(_0x2f3678['originalName']=_0x83e235,_0x3da3cb=!![]),_0x3da3cb&&(await _0x342df8[_0x492f7c(0x864)][_0x492f7c(0x9c0)](_0x2747ee),console[_0x492f7c(0xe72)](_0x492f7c(0x385)+_0x2747ee[_0x492f7c(0x461)]+_0x492f7c(0x836)));}}}}async function _0x4fddd3(_0x4d8480){const _0x4e14e4=_0x549949;if(!_0x4d8480||_0x4d8480['isGroup']){console[_0x4e14e4(0x17b)](_0x4e14e4(0x6d1));return;}const _0x1093cb=_0x4d8480['id'],_0x375f4e=_0x4d8480[_0x4e14e4(0x886)][_0x4e14e4(0x121e)];console[_0x4e14e4(0xe72)](_0x4e14e4(0x7d3)+_0x1093cb+_0x4e14e4(0x15d));for(const _0x15073c of Object[_0x4e14e4(0x76d)](_0x41df36[_0x4e14e4(0x864)])){if(_0x15073c[_0x4e14e4(0x1a2)]&&_0x15073c[_0x4e14e4(0x12a6)]){const _0x20ee2d=_0x15073c[_0x4e14e4(0x12a6)][_0x4e14e4(0xd12)](_0x19436f=>_0x19436f['id']===_0x1093cb);_0x20ee2d&&_0x20ee2d['avatar']!==_0x375f4e&&(_0x20ee2d[_0x4e14e4(0xb47)]=_0x375f4e,await _0x342df8[_0x4e14e4(0x864)][_0x4e14e4(0x9c0)](_0x15073c),console[_0x4e14e4(0xe72)](_0x4e14e4(0x1c4)+_0x1093cb+_0x4e14e4(0x5ae)+_0x15073c[_0x4e14e4(0x461)]+'\x22'));}}}function _0x54d0ab(_0x4b07d2,_0x18b8bf){const _0x8807b1=_0x549949;if(!_0x4b07d2||!_0x4b07d2['isGroup']||!_0x18b8bf)return _0x18b8bf;const _0x2da800=_0x41df36[_0x8807b1(0x571)][_0x8807b1(0xabb)]||_0x8807b1(0x7da);if(_0x18b8bf===_0x2da800)return _0x4b07d2[_0x8807b1(0x886)]['myNickname']||'我';const _0x3597c7=_0x4b07d2[_0x8807b1(0x12a6)]['find'](_0x133ae0=>_0x133ae0[_0x8807b1(0x283)]===_0x18b8bf);return _0x3597c7?_0x3597c7[_0x8807b1(0x9da)]:_0x18b8bf;}function _0x179abd(_0x10edf8){const _0x4863d3=_0x549949;document[_0x4863d3(0x400)]('.rules-tab')[_0x4863d3(0x19c)](_0x272a6a=>{const _0x441f21=_0x4863d3;_0x272a6a[_0x441f21(0x119a)][_0x441f21(0x8f0)](_0x441f21(0xde5),_0x272a6a[_0x441f21(0x118)][_0x441f21(0xba3)]===_0x10edf8);}),document[_0x4863d3(0x400)](_0x4863d3(0x103f))[_0x4863d3(0x19c)](_0x476c22=>{const _0x176443=_0x4863d3;_0x476c22[_0x176443(0x119a)][_0x176443(0x8f0)]('active',_0x476c22[_0x176443(0x118)]['categoryId']===_0x10edf8);});}function _0x5641f2(_0x574c2c){const _0x1eb9a6=_0x549949;if(!_0x574c2c)return'';if(_0x41df36[_0x1eb9a6(0x571)]&&_0x574c2c===_0x41df36[_0x1eb9a6(0x571)][_0x1eb9a6(0xabb)])return _0x41df36[_0x1eb9a6(0x571)]['nickname'];let _0x595790=Object[_0x1eb9a6(0x76d)](_0x41df36[_0x1eb9a6(0x864)])[_0x1eb9a6(0xd12)](_0x6918f4=>!_0x6918f4[_0x1eb9a6(0x1a2)]&&_0x6918f4[_0x1eb9a6(0x283)]===_0x574c2c);if(_0x595790)return _0x595790[_0x1eb9a6(0x461)];_0x595790=Object[_0x1eb9a6(0x76d)](_0x41df36[_0x1eb9a6(0x864)])[_0x1eb9a6(0xd12)](_0x1ab10d=>!_0x1ab10d[_0x1eb9a6(0x1a2)]&&(_0x1ab10d[_0x1eb9a6(0xcf9)]&&_0x1ab10d[_0x1eb9a6(0xcf9)][_0x1eb9a6(0xee2)](_0x574c2c)));if(_0x595790)return _0x595790[_0x1eb9a6(0x461)];return _0x574c2c;}function _0x1d0461(_0x3029bd,_0x44dc48=null){const _0x53b94d=_0x549949;if(!_0x3029bd||typeof _0x3029bd!==_0x53b94d(0xafa)||!_0x3029bd[_0x53b94d(0xee2)](_0x53b94d(0x11c0)))return _0x3029bd;return _0x3029bd['replace'](/@\[\[([^\]]+)\]\]/g,(_0x2270df,_0xe311bc)=>{const _0x4e887b=_0x53b94d,_0x17e77f=_0xe311bc[_0x4e887b(0x1cb)]();let _0x3d8c13;return _0x44dc48&&_0x44dc48[_0x4e887b(0x1a2)]?_0x3d8c13=_0x54d0ab(_0x44dc48,_0x17e77f):_0x3d8c13=_0x5641f2(_0x17e77f),'@'+_0x3d8c13;});}function _0x23a88b(_0x3749a3,_0x5dd538,_0x1881d1={}){return new Promise(_0x26580e=>{const _0x2330e0=_0x42ed;_0x38a70c=_0x26580e,_0x24d45f[_0x2330e0(0x138e)]=_0x3749a3,_0x32165b['innerHTML']=_0x2330e0(0x110)+_0x5dd538+_0x2330e0(0x29a);const _0x995908=document[_0x2330e0(0x383)](_0x2330e0(0xd4a)),_0x264402=document['getElementById'](_0x2330e0(0x318));_0x264402['style']['display']=_0x2330e0(0x27a),_0x995908['textContent']=_0x1881d1['confirmText']||'确定',_0x264402[_0x2330e0(0x138e)]=_0x1881d1[_0x2330e0(0x605)]||'取消',_0x1881d1[_0x2330e0(0x559)]?_0x995908['classList'][_0x2330e0(0xbff)](_0x1881d1[_0x2330e0(0x559)]):_0x995908[_0x2330e0(0x119a)][_0x2330e0(0x131d)]('btn-danger'),_0x995908[_0x2330e0(0xc50)]=()=>{_0x26580e(!![]),_0x4a895a();},_0x264402[_0x2330e0(0xc50)]=()=>{_0x26580e(![]),_0x4a895a();},_0x48fc69();});}function _0x296ef9(_0x28f870,_0x2907f7){return new Promise(_0x35424d=>{const _0x17469e=_0x42ed;_0x38a70c=_0x35424d,_0x24d45f[_0x17469e(0x138e)]=_0x28f870,_0x32165b[_0x17469e(0x45c)]=_0x17469e(0x42b)+_0x2907f7+'</p>';const _0x540750=document[_0x17469e(0x383)](_0x17469e(0xd4a)),_0xf95f8=document[_0x17469e(0x383)](_0x17469e(0x318));_0xf95f8['style'][_0x17469e(0x2b6)]=_0x17469e(0xa70),_0x540750[_0x17469e(0x138e)]='好的',_0x540750[_0x17469e(0xc50)]=()=>{const _0x25a82f=_0x17469e;_0xf95f8[_0x25a82f(0x655)][_0x25a82f(0x2b6)]='block',_0x540750[_0x25a82f(0x138e)]='确定',_0x35424d(!![]),_0x4a895a();},_0x48fc69();});}function _0x12e332(_0x2ae380,_0x4162b6,_0xbc02fe='',_0x26dac4=_0x549949(0x6af),_0x36f00e=''){return new Promise(_0x10c9d4=>{const _0x330591=_0x42ed;_0x38a70c=_0x10c9d4,_0x24d45f['textContent']=_0x2ae380;const _0xf85897='custom-prompt-input',_0x3c5da7=_0x26dac4==='textarea'?_0x330591(0x8f5)+_0xf85897+_0x330591(0xc8e)+_0x4162b6+'\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>'+_0xbc02fe+_0x330591(0x702):_0x330591(0x31d)+_0x26dac4+_0x330591(0x457)+_0xf85897+_0x330591(0xc8e)+_0x4162b6+_0x330591(0xcd0)+_0xbc02fe+'\x22>';_0x32165b[_0x330591(0x45c)]=_0x36f00e+_0x3c5da7;const _0x476567=document['getElementById'](_0xf85897);_0x32165b[_0x330591(0x400)](_0x330591(0x487))[_0x330591(0x19c)](_0x117f99=>{const _0x1361f9=_0x330591;_0x117f99[_0x1361f9(0x271)]('click',()=>{const _0x16b5e3=_0x1361f9,_0x47f798=_0x117f99[_0x16b5e3(0x118)]['template'];if(_0x47f798)try{const _0x313c3a=JSON[_0x16b5e3(0x134)](_0x47f798);_0x476567[_0x16b5e3(0x1be)]=JSON[_0x16b5e3(0x3fb)](_0x313c3a,null,0x2),_0x476567[_0x16b5e3(0xede)]();}catch(_0x21f369){console[_0x16b5e3(0x98)](_0x16b5e3(0xd6),_0x21f369);}});});const _0x554799=document[_0x330591(0x383)]('custom-modal-confirm'),_0x2365bf=document['getElementById'](_0x330591(0x318));_0x554799[_0x330591(0xc50)]=()=>{const _0x27c346=_0x330591;_0x10c9d4(_0x476567[_0x27c346(0x1be)]),_0x4a895a();},_0x2365bf[_0x330591(0xc50)]=()=>{_0x10c9d4(null),_0x4a895a();},_0x48fc69(),setTimeout(()=>_0x476567[_0x330591(0xede)](),0x64);});}function _0x2d60a4(_0x2abe60,_0xae2091){return new Promise(_0x4d91cc=>{const _0x310152=_0x42ed,_0x450dd9=document[_0x310152(0x383)]('custom-modal-overlay'),_0x28b491=document['getElementById'](_0x310152(0x7b6)),_0x44eedf=document[_0x310152(0x383)](_0x310152(0x698)),_0x4193c8=document[_0x310152(0x89c)](_0x310152(0x144));_0x28b491[_0x310152(0x138e)]=_0x2abe60,_0x44eedf[_0x310152(0x45c)]='',_0x4193c8[_0x310152(0x45c)]='',_0x4193c8[_0x310152(0x655)]['flexDirection']=_0x310152(0xa2d),_0xae2091[_0x310152(0x19c)](_0x557f91=>{const _0x4aad2e=_0x310152,_0x1ef5bd=document[_0x4aad2e(0xe1b)](_0x4aad2e(0x182));_0x1ef5bd[_0x4aad2e(0x138e)]=_0x557f91[_0x4aad2e(0x6af)],_0x1ef5bd[_0x4aad2e(0xc50)]=()=>{const _0x55d392=_0x4aad2e;_0x450dd9[_0x55d392(0x119a)][_0x55d392(0x131d)](_0x55d392(0x106d)),_0x4d91cc(_0x557f91[_0x55d392(0x1be)]);},_0x4193c8[_0x4aad2e(0xe91)](_0x1ef5bd);});const _0x16f507=document['createElement'](_0x310152(0x182));_0x16f507['textContent']='取消',_0x16f507[_0x310152(0x655)][_0x310152(0x1348)]=_0x310152(0x176),_0x16f507[_0x310152(0x655)][_0x310152(0xc90)]=_0x310152(0x176),_0x16f507[_0x310152(0x655)][_0x310152(0x8fc)]='#f0f0f0',_0x16f507[_0x310152(0xc50)]=()=>{const _0x50581e=_0x310152;_0x450dd9[_0x50581e(0x119a)][_0x50581e(0x131d)](_0x50581e(0x106d)),_0x4d91cc(null);},_0x4193c8['appendChild'](_0x16f507),_0x450dd9[_0x310152(0x119a)]['add'](_0x310152(0x106d));})['finally'](()=>{const _0x3daba1=_0x42ed,_0x293b77=document[_0x3daba1(0x89c)](_0x3daba1(0x144));_0x293b77[_0x3daba1(0x655)][_0x3daba1(0x55f)]='row',_0x293b77[_0x3daba1(0x45c)]=_0x3daba1(0x412),document[_0x3daba1(0x383)](_0x3daba1(0x318))[_0x3daba1(0x271)]('click',_0x4a895a);});}async function _0x27633a(){const _0x559d2f=_0x549949,_0x3746fd=await _0x2d60a4('选择歌词导入方式',[{'text':_0x559d2f(0xb7c),'value':'file'},{'text':_0x559d2f(0x114e),'value':_0x559d2f(0x380)}]);if(_0x3746fd===_0x559d2f(0xbe7))return new Promise(_0x15e661=>{const _0x4d5377=_0x559d2f,_0x3c7914=document[_0x4d5377(0x383)]('lrc-upload-input'),_0x1e64f1=_0x2a7038=>{const _0x3f8d3f=_0x4d5377,_0x33bbeb=_0x2a7038[_0x3f8d3f(0xfab)]['files'][0x0];if(_0x33bbeb){const _0x1ffbee=new FileReader();_0x1ffbee[_0x3f8d3f(0xb5b)]=_0x505916=>_0x15e661(_0x505916['target'][_0x3f8d3f(0xa86)]),_0x1ffbee[_0x3f8d3f(0x40f)]=()=>_0x15e661(''),_0x1ffbee[_0x3f8d3f(0x10cb)](_0x33bbeb);}else _0x15e661(null);_0x3c7914[_0x3f8d3f(0xb04)]('change',_0x1e64f1),_0x3c7914[_0x3f8d3f(0x1be)]='';};_0x3c7914[_0x4d5377(0x271)](_0x4d5377(0x173),_0x1e64f1,{'once':!![]}),_0x3c7914[_0x4d5377(0x5c7)]();});else{if(_0x3746fd===_0x559d2f(0x380)){const _0x35e2f5=await _0x12e332(_0x559d2f(0xd53),'请在此处粘贴完整的LRC格式歌词...','',_0x559d2f(0xfe5));if(_0x35e2f5){const _0x589e41=_0x35e2f5[_0x559d2f(0x709)](/\[/g,'\x0a[')['trim']();return _0x589e41;}return _0x35e2f5;}else return null;}}_0x342df8[_0x549949(0xb06)](0x27)['stores']({'doubanPosts':_0x549949(0x367),'chats':'&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','apiConfig':'&id,\x20minimaxGroupId,\x20minimaxApiKey','globalSettings':'&id','userStickers':_0x549949(0xae9),'worldBooks':_0x549949(0xb2a),'worldBookCategories':_0x549949(0xfe),'musicLibrary':_0x549949(0x45d),'personaPresets':'&id','qzoneSettings':_0x549949(0x45d),'qzonePosts':_0x549949(0x44c),'qzoneAlbums':_0x549949(0x312),'qzonePhotos':_0x549949(0x12e2),'favorites':_0x549949(0xd6f),'qzoneGroups':'++id,\x20name','memories':_0x549949(0x10fd),'callRecords':_0x549949(0x12d9),'shoppingProducts':'++id,\x20name,\x20description','shoppingCategories':'++id,\x20name','apiPresets':_0x549949(0xfe),'renderingRules':_0x549949(0x941),'appearancePresets':_0x549949(0xac8),'stickerCategories':'++id,\x20name','customAvatarFrames':_0x549949(0xfe),'presets':'&id,\x20name,\x20categoryId','presetCategories':'++id,\x20name','readingLibrary':_0x549949(0xff4),'npcs':_0x549949(0xdce)})[_0x549949(0x10f7)](_0x4c4ad7=>{const _0x54c22e=_0x549949;return _0x4c4ad7[_0x54c22e(0xac)](_0x54c22e(0xf17))[_0x54c22e(0x5b9)]()['modify'](_0x31f563=>{const _0x5d914a=_0x54c22e;if(typeof _0x31f563[_0x5d914a(0x11b6)]===_0x5d914a(0xafa)&&_0x31f563['content'][_0x5d914a(0x1cb)]()!=='')_0x31f563['content']=[{'keys':[],'comment':_0x5d914a(0x891),'content':_0x31f563[_0x5d914a(0x11b6)]}];else!Array['isArray'](_0x31f563[_0x5d914a(0x11b6)])&&(_0x31f563[_0x5d914a(0x11b6)]=[]);_0x31f563[_0x5d914a(0x11b6)][_0x5d914a(0x19c)](_0x39b79f=>{const _0x53aabc=_0x5d914a;typeof _0x39b79f[_0x53aabc(0x8e4)]===_0x53aabc(0x89d)&&(_0x39b79f[_0x53aabc(0x8e4)]=!![]);});});}),window['db']=_0x342df8;function _0x105acd(_0x2253a1){const _0x15a3ed=_0x549949;_0x2253a1==='chat-list-screen'&&(window['renderChatListProxy'](),_0x18bbbb('messages-view'));if(_0x2253a1===_0x15a3ed(0xdea))window['renderApiSettingsProxy']();if(_0x2253a1===_0x15a3ed(0x100e))window[_0x15a3ed(0xeeb)]();if(_0x2253a1===_0x15a3ed(0x88e))window['renderWorldBookScreenProxy']();if(_0x2253a1===_0x15a3ed(0x691))window[_0x15a3ed(0x4eb)]();if(_0x2253a1===_0x15a3ed(0xab5))_0x1c4178();document[_0x15a3ed(0x400)](_0x15a3ed(0x172))[_0x15a3ed(0x19c)](_0x4be07f=>_0x4be07f[_0x15a3ed(0x119a)][_0x15a3ed(0x131d)]('active'));const _0x1913a0=document[_0x15a3ed(0x383)](_0x2253a1);if(_0x1913a0)_0x1913a0['classList']['add'](_0x15a3ed(0xde5));if(_0x2253a1==='chat-interface-screen')window[_0x15a3ed(0x10f6)](_0x41df36[_0x15a3ed(0xfc5)]);_0x2253a1===_0x15a3ed(0xf8f)&&(_0x55c558(),document[_0x15a3ed(0x383)]('font-url-input')[_0x15a3ed(0x1be)]=_0x41df36[_0x15a3ed(0xc0)][_0x15a3ed(0x1082)]||'',_0x59518a(_0x41df36[_0x15a3ed(0xc0)][_0x15a3ed(0x1082)]||'',!![]));}window[_0x549949(0x10f6)]=()=>{};function _0x18bbbb(_0x5973a0){const _0x5eef9a=_0x549949,_0x106e6c=document[_0x5eef9a(0x383)](_0x5eef9a(0x11f7)),_0x5ddf4c={'messages-view':document[_0x5eef9a(0x383)]('messages-view'),'qzone-screen':document[_0x5eef9a(0x383)](_0x5eef9a(0xc0c)),'favorites-view':document[_0x5eef9a(0x383)]('favorites-view'),'memories-view':document[_0x5eef9a(0x383)](_0x5eef9a(0x5b8)),'npc-list-view':document[_0x5eef9a(0x383)](_0x5eef9a(0xd50))},_0x2773f0=document[_0x5eef9a(0x383)](_0x5eef9a(0x573)),_0x347f48=document[_0x5eef9a(0x383)](_0x5eef9a(0x224));_0x281701&&document[_0x5eef9a(0x383)](_0x5eef9a(0x472))[_0x5eef9a(0x5c7)]();Object[_0x5eef9a(0x76d)](_0x5ddf4c)[_0x5eef9a(0x19c)](_0x45381c=>_0x45381c[_0x5eef9a(0x119a)][_0x5eef9a(0x131d)](_0x5eef9a(0xde5)));_0x5ddf4c[_0x5973a0]&&_0x5ddf4c[_0x5973a0][_0x5eef9a(0x119a)][_0x5eef9a(0xbff)](_0x5eef9a(0xde5));document[_0x5eef9a(0x400)](_0x5eef9a(0x121d))['forEach'](_0x4aed86=>{const _0x4af9f1=_0x5eef9a;_0x4aed86['classList'][_0x4af9f1(0x8f0)](_0x4af9f1(0xde5),_0x4aed86['dataset'][_0x4af9f1(0x352)]===_0x5973a0);});_0x5973a0==='messages-view'?(_0x2773f0[_0x5eef9a(0x655)][_0x5eef9a(0x2b6)]=_0x5eef9a(0x2aa),_0x347f48[_0x5eef9a(0x655)]['display']=_0x5eef9a(0x2aa)):(_0x2773f0[_0x5eef9a(0x655)]['display']='none',_0x347f48[_0x5eef9a(0x655)][_0x5eef9a(0x2b6)]=_0x5eef9a(0xa70));_0x5973a0!==_0x5eef9a(0x5b8)&&(_0x2f690a[_0x5eef9a(0x19c)](_0x543e3e=>clearInterval(_0x543e3e)),_0x2f690a=[]);switch(_0x5973a0){case'qzone-screen':_0x5ddf4c[_0x5eef9a(0xc0c)][_0x5eef9a(0x655)][_0x5eef9a(0x8fc)]=_0x5eef9a(0xb71),_0x4c6ee1(0x0),_0x4a8610(),_0x476b70();break;case _0x5eef9a(0xaba):_0x5ddf4c[_0x5eef9a(0xaba)]['style'][_0x5eef9a(0x8fc)]='#f9f9f9',_0x32454e();break;case _0x5eef9a(0x502):break;case _0x5eef9a(0xd50):_0x1c4547();break;}}function _0x5d5105(){const _0x3777c0=_0x549949;console[_0x3777c0(0xe72)](_0x3777c0(0x985));}window[_0x549949(0x4eb)]=_0x5d5105;function _0x4a8610(){const _0x42dcd7=_0x549949;if(_0x41df36&&_0x41df36[_0x42dcd7(0x571)]){const _0x381b16=_0x41df36[_0x42dcd7(0x571)];document[_0x42dcd7(0x383)](_0x42dcd7(0xff6))[_0x42dcd7(0x138e)]=_0x381b16[_0x42dcd7(0xabb)],document[_0x42dcd7(0x383)](_0x42dcd7(0x116c))[_0x42dcd7(0xf6c)]=_0x381b16[_0x42dcd7(0xb47)],document[_0x42dcd7(0x383)](_0x42dcd7(0x9f1))['src']=_0x381b16['banner'];}}window[_0x549949(0x8b8)]=_0x4a8610;async function _0x1cf554(){const _0x2a25c1=_0x549949;_0x342df8&&_0x41df36[_0x2a25c1(0x571)]&&await _0x342df8[_0x2a25c1(0x571)][_0x2a25c1(0x9c0)](_0x41df36[_0x2a25c1(0x571)]);}function _0xd7cdd4(_0x280013){const _0x31e422=_0x549949;if(!_0x280013)return'';const _0x30af72=new Date(),_0x1e1e94=new Date(_0x280013),_0x1306a2=Math[_0x31e422(0xdee)]((_0x30af72-_0x1e1e94)/0x3e8),_0x2cc811=Math[_0x31e422(0xdee)](_0x1306a2/0x3c),_0x37f41b=Math[_0x31e422(0xdee)](_0x2cc811/0x3c);if(_0x2cc811<0x1)return'刚刚';if(_0x2cc811<0x3c)return _0x2cc811+'分钟前';if(_0x37f41b<0x18)return _0x37f41b+_0x31e422(0x1333);const _0x1aff0f=_0x1e1e94[_0x31e422(0xdf9)](),_0x14ee7e=String(_0x1e1e94[_0x31e422(0xf4f)]()+0x1)[_0x31e422(0xf20)](0x2,'0'),_0x2bb644=String(_0x1e1e94[_0x31e422(0xb29)]())[_0x31e422(0xf20)](0x2,'0'),_0x101f21=String(_0x1e1e94[_0x31e422(0x793)]())[_0x31e422(0xf20)](0x2,'0'),_0x179b7d=String(_0x1e1e94[_0x31e422(0xa28)]())['padStart'](0x2,'0');return _0x30af72['getFullYear']()===_0x1aff0f?_0x14ee7e+'-'+_0x2bb644+'\x20'+_0x101f21+':'+_0x179b7d:_0x1aff0f+'-'+_0x14ee7e+'-'+_0x2bb644+'\x20'+_0x101f21+':'+_0x179b7d;}function _0x24ffe0(_0x43675a){const _0x30d03f=_0x549949,_0x20238d=document[_0x30d03f(0x89c)](_0x30d03f(0x515)+_0x43675a['id']+'\x22]'),_0x191bfd=!!_0x20238d,_0x4ed219=_0x191bfd?_0x20238d:document[_0x30d03f(0xe1b)]('div');!_0x191bfd&&(_0x4ed219['className']=_0x30d03f(0xf63),_0x4ed219[_0x30d03f(0x118)]['postId']=_0x43675a['id']);const _0x2dfb24=_0x191bfd?_0x4ed219['querySelector'](_0x30d03f(0xe1a)):document['createElement']('div');!_0x191bfd&&(_0x2dfb24[_0x30d03f(0x556)]='qzone-post-item');let _0xfafb0b='',_0x55f83b='',_0x5b0e6e=_0x41df36[_0x30d03f(0x571)][_0x30d03f(0xb47)];if(_0x43675a[_0x30d03f(0x1301)]==='user')_0xfafb0b=_0x41df36[_0x30d03f(0x571)][_0x30d03f(0xb47)],_0x55f83b=_0x41df36['qzoneSettings'][_0x30d03f(0xabb)];else{if(_0x41df36[_0x30d03f(0x864)][_0x43675a[_0x30d03f(0x1301)]]){const _0xd13bbf=_0x41df36[_0x30d03f(0x864)][_0x43675a[_0x30d03f(0x1301)]];_0xfafb0b=_0xd13bbf[_0x30d03f(0x886)]['aiAvatar']||_0x5dc108,_0x55f83b=_0xd13bbf[_0x30d03f(0x461)];}else _0x55f83b=_0x5641f2(_0x43675a[_0x30d03f(0x52b)]),_0xfafb0b=_0x5dc108;}function _0x268466(_0x3fe96b){const _0x382c99=_0x30d03f;let _0x356467='';const _0x458c49=_0x3fe96b[_0x382c99(0xbdc)]?_0x382c99(0xdaa)+_0x350d3e(_0x3fe96b[_0x382c99(0xbdc)])[_0x382c99(0x709)](/\n/g,_0x382c99(0x3ee))+_0x382c99(0x69b):'';if(_0x3fe96b[_0x382c99(0xa6b)]===_0x382c99(0x23e))_0x356467=_0x382c99(0x390)+_0x350d3e(_0x3fe96b[_0x382c99(0x11b6)])[_0x382c99(0x709)](/\n/g,_0x382c99(0x3ee))+_0x382c99(0x69b);else{if(_0x3fe96b['type']===_0x382c99(0xe9d)&&_0x3fe96b[_0x382c99(0xa94)])_0x356467=_0x458c49?_0x458c49+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x3fe96b[_0x382c99(0xa94)]+_0x382c99(0x200):'<img\x20src=\x22'+_0x3fe96b[_0x382c99(0xa94)]+'\x22\x20class=\x22chat-image\x22>';else{if(_0x3fe96b[_0x382c99(0xa6b)]==='text_image'){const _0xc87940=_0x41df36[_0x382c99(0xc0)][_0x382c99(0xb6a)]&&_0x3fe96b[_0x382c99(0x8d8)]?_0x382c99(0x5c1)+_0x3fe96b['image_prompt']:_0x382c99(0xbed);_0x356467=_0x458c49?_0x458c49+_0x382c99(0xd63)+_0xc87940+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x3fe96b['hiddenContent']+'\x22></div>':_0x382c99(0xf8a)+_0xc87940+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x3fe96b[_0x382c99(0x4e6)]+'\x22>';}else{if(_0x3fe96b[_0x382c99(0xa6b)]===_0x382c99(0x7f4)){const _0x433ed1=_0x3fe96b[_0x382c99(0x18a)]||(_0x3fe96b['imageUrl']?[_0x3fe96b['imageUrl']]:[]);if(_0x433ed1[_0x382c99(0xfde)]>0x0){const _0x3ba0a5=_0x433ed1['length'];let _0x3ce8d2='';_0x3ce8d2='<div\x20class=\x22post-images-grid\x20grid-'+_0x3ba0a5+'\x22>',_0x433ed1[_0x382c99(0x19c)]((_0x40a2a6,_0x3efdf9)=>{const _0x27b071=_0x382c99;_0x3ce8d2+=_0x27b071(0xf8a)+_0x40a2a6+_0x27b071(0x1063)+(_0x3efdf9+0x1)+_0x27b071(0x646);}),_0x3ce8d2+=_0x382c99(0x69b),_0x356467=_0x458c49?''+_0x458c49+_0x3ce8d2:_0x3ce8d2;}}}}}return _0x356467;}let _0x3c5378;if(_0x43675a[_0x30d03f(0xa6b)]===_0x30d03f(0xcf0)){const _0x436063=_0x43675a['repostComment']?_0x30d03f(0xdaa)+_0x350d3e(_0x43675a['repostComment'])[_0x30d03f(0x709)](/\n/g,_0x30d03f(0x3ee))+'</div>':'';let _0xd80a66=_0x5dc108,_0x50c5d2=_0x30d03f(0x12ba);if(_0x43675a[_0x30d03f(0xba8)][_0x30d03f(0x1301)]===_0x30d03f(0x66e))_0xd80a66=_0x41df36[_0x30d03f(0x571)][_0x30d03f(0xb47)],_0x50c5d2=_0x41df36[_0x30d03f(0x571)][_0x30d03f(0xabb)];else{const _0x492db2=_0x41df36[_0x30d03f(0x864)][_0x43675a[_0x30d03f(0xba8)]['authorId']];_0x492db2&&(_0xd80a66=_0x492db2[_0x30d03f(0x886)][_0x30d03f(0x121e)]||_0x5dc108),_0x50c5d2=_0x5641f2(_0x43675a['originalPost'][_0x30d03f(0x52b)]);}_0x3c5378='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x436063+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0xd80a66+_0x30d03f(0x11e7)+_0x50c5d2+_0x30d03f(0x11f1)+_0xd7cdd4(_0x43675a[_0x30d03f(0xba8)]['timestamp'])+_0x30d03f(0xb74)+_0x268466(_0x43675a[_0x30d03f(0xba8)])+_0x30d03f(0x253);}else _0x3c5378=_0x30d03f(0x416)+_0x268466(_0x43675a)+_0x30d03f(0x69b);let _0x88d228='';if(_0x43675a['likes']&&_0x43675a[_0x30d03f(0x133c)][_0x30d03f(0xfde)]>0x0){const _0x3d9bd3=_0x43675a[_0x30d03f(0x133c)][_0x30d03f(0xa79)](_0x2d35f3=>_0x5641f2(_0x2d35f3))[_0x30d03f(0xa35)]('、');_0x88d228='<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>'+_0x3d9bd3+_0x30d03f(0x57b);}let _0x4dae47='';_0x43675a[_0x30d03f(0xcad)]&&_0x43675a[_0x30d03f(0xcad)]['length']>0x0&&(_0x4dae47=_0x30d03f(0x10f0),_0x43675a['comments'][_0x30d03f(0x19c)]((_0x569159,_0x4709c6)=>{const _0x547d8d=_0x30d03f;if(typeof _0x569159==='object'&&_0x569159!==null&&_0x569159[_0x547d8d(0xbb)]){const _0x63d9cc=_0x569159['commenterName'],_0x58450b=_0x5641f2(_0x63d9cc);let _0x48d6fd;_0x49f222[_0x547d8d(0xd73)](_0x569159[_0x547d8d(0x6af)])?_0x48d6fd=_0x547d8d(0xf8a)+_0x569159[_0x547d8d(0x6af)]+_0x547d8d(0x687):_0x48d6fd=_0x350d3e(_0x569159[_0x547d8d(0x6af)]);let _0x548946='';if(_0x569159[_0x547d8d(0x855)]){const _0x57edbe=_0x5641f2(_0x569159[_0x547d8d(0x855)]);_0x548946=_0x547d8d(0x89a)+_0x58450b+_0x547d8d(0xc8d)+_0x57edbe+_0x547d8d(0x1004)+_0x48d6fd;}else _0x548946='<span\x20class=\x22commenter-name\x22>'+_0x58450b+_0x547d8d(0x1004)+_0x48d6fd;_0x4dae47+=_0x547d8d(0x132c)+_0x43675a['id']+_0x547d8d(0x789)+_0x63d9cc+'\x22\x20data-commenter-display-name=\x22'+_0x58450b+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>'+_0x548946+_0x547d8d(0x949)+_0x4709c6+_0x547d8d(0x1013);}else _0x4dae47+=_0x547d8d(0x137a)+_0x350d3e(String(_0x569159))+_0x547d8d(0x7be);}),_0x4dae47+='</div>');const _0x112404=_0x41df36[_0x30d03f(0x571)][_0x30d03f(0xabb)],_0x4dcaec=_0x43675a[_0x30d03f(0x133c)]&&_0x43675a[_0x30d03f(0x133c)][_0x30d03f(0xee2)](_0x112404),_0x23a643=_0x41df36[_0x30d03f(0x12c8)]&&_0x41df36[_0x30d03f(0x12c8)][_0x30d03f(0xcde)](_0x43675a['id']);let _0x311519='';_0x43675a[_0x30d03f(0xa6b)]!==_0x30d03f(0xcf0)&&(_0x311519='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>');_0x2dfb24[_0x30d03f(0x45c)]=_0x30d03f(0xdf1)+_0xfafb0b+_0x30d03f(0xc4d)+_0x43675a[_0x30d03f(0x1301)]+_0x30d03f(0x11d0)+_0x55f83b+_0x30d03f(0x1f4)+_0xd7cdd4(_0x43675a['timestamp'])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3c5378+_0x30d03f(0x131f)+_0x311519+_0x30d03f(0xdf0)+(_0x4dcaec?'active':'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20'+(_0x23a643?_0x30d03f(0xde5):'')+_0x30d03f(0xbc2)+_0x88d228+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4dae47+_0x30d03f(0x426)+_0x5b0e6e+_0x30d03f(0x651);if(!_0x191bfd){const _0x35327b=document[_0x30d03f(0xe1b)](_0x30d03f(0x7fd));_0x35327b[_0x30d03f(0x556)]=_0x30d03f(0xcc7),_0x35327b['innerHTML']=_0x30d03f(0xd77),_0x4ed219[_0x30d03f(0xe91)](_0x2dfb24),_0x4ed219[_0x30d03f(0xe91)](_0x35327b);}return _0x4ed219;}async function _0x1ef318(_0x382021){const _0x266199=_0x549949,_0x12c5a8=await _0x342df8[_0x266199(0x35a)][_0x266199(0x1a3)](_0x382021);if(!_0x12c5a8){const _0x4a702b=document[_0x266199(0x89c)](_0x266199(0x515)+_0x382021+'\x22]');if(_0x4a702b)_0x4a702b[_0x266199(0x131d)]();return;}const _0x54d4e7=_0x3c5f19['findIndex'](_0x1b3432=>_0x1b3432['id']===_0x382021);if(_0x54d4e7>-0x1)_0x3c5f19[_0x54d4e7]=_0x12c5a8;const _0x1fc6ea=await _0x342df8[_0x266199(0x5c5)][_0x266199(0x6bd)]('type')['equals']('qzone_post')['toArray']();_0x41df36[_0x266199(0x12c8)]=new Set(_0x1fc6ea['map'](_0xec5221=>_0xec5221['content']['id'])),_0x24ffe0(_0x12c5a8);}function _0xa3fdac(_0x326564){const _0x23a808=_0x549949,_0x3902dd=Date[_0x23a808(0x108d)](),_0x4806c9=Math[_0x23a808(0xdee)]((_0x3902dd-_0x326564)/0x3e8),_0x5e106d=Math['floor'](_0x4806c9/0x3c);if(_0x5e106d<0x2)return'刚刚';if(_0x5e106d<0x3c)return _0x5e106d+_0x23a808(0x7eb);const _0x4bdc1c=Math[_0x23a808(0xdee)](_0x5e106d/0x3c);if(_0x4bdc1c<0x18)return _0x4bdc1c+_0x23a808(0x1333);const _0x538832=Math['floor'](_0x4bdc1c/0x18);return _0x538832+'天前';}async function _0x24ffe0(_0x23fb40){const _0x4571ed=_0x549949,_0x4391d3=document[_0x4571ed(0x89c)](_0x4571ed(0x515)+_0x23fb40['id']+'\x22]'),_0x5a3a45=!!_0x4391d3,_0x262a6e=_0x5a3a45?_0x4391d3:document[_0x4571ed(0xe1b)](_0x4571ed(0x7fd));!_0x5a3a45&&(_0x262a6e[_0x4571ed(0x556)]=_0x4571ed(0xf63),_0x262a6e['dataset']['postId']=_0x23fb40['id']);const _0xaf8fe9=_0x5a3a45?_0x262a6e[_0x4571ed(0x89c)](_0x4571ed(0xe1a)):document['createElement'](_0x4571ed(0x7fd));!_0x5a3a45&&(_0xaf8fe9['className']=_0x4571ed(0xb23));let _0xb04968='',_0x5039cd='',_0xaec06b=_0x41df36[_0x4571ed(0x571)][_0x4571ed(0xb47)];if(_0x23fb40[_0x4571ed(0x1301)]===_0x4571ed(0x66e))_0xb04968=_0x41df36[_0x4571ed(0x571)]['avatar'],_0x5039cd=_0x41df36[_0x4571ed(0x571)][_0x4571ed(0xabb)];else{if(_0x41df36[_0x4571ed(0x864)][_0x23fb40[_0x4571ed(0x1301)]]){const _0xa1fbfd=_0x41df36[_0x4571ed(0x864)][_0x23fb40[_0x4571ed(0x1301)]];_0xb04968=_0xa1fbfd['settings']['aiAvatar']||_0x5dc108,_0x5039cd=_0xa1fbfd[_0x4571ed(0x461)];}else{if(String(_0x23fb40[_0x4571ed(0x1301)])['startsWith']('npc_')){const _0x1a6a58=parseInt(String(_0x23fb40[_0x4571ed(0x1301)])[_0x4571ed(0x709)]('npc_',''));if(!isNaN(_0x1a6a58)){const _0x572358=await _0x342df8[_0x4571ed(0x656)]['get'](_0x1a6a58);_0x572358?(_0xb04968=_0x572358[_0x4571ed(0xb47)]||_0x59100f,_0x5039cd=_0x572358[_0x4571ed(0x461)]):(_0x5039cd=_0x23fb40[_0x4571ed(0x52b)]||_0x4571ed(0x122c),_0xb04968=_0x59100f);}}else _0x5039cd=_0x5641f2(_0x23fb40[_0x4571ed(0x52b)]),_0xb04968=_0x5dc108;}}function _0x1a9ef1(_0x16a7dd){const _0x33c68a=_0x4571ed;let _0xb65b16='';const _0x5077f3=_0x16a7dd[_0x33c68a(0xbdc)]?_0x33c68a(0xdaa)+_0x350d3e(_0x16a7dd[_0x33c68a(0xbdc)])[_0x33c68a(0x709)](/\n/g,_0x33c68a(0x3ee))+_0x33c68a(0x69b):'';if(_0x16a7dd[_0x33c68a(0xa6b)]===_0x33c68a(0x23e))_0xb65b16=_0x33c68a(0x390)+_0x350d3e(_0x16a7dd[_0x33c68a(0x11b6)])['replace'](/\n/g,'<br>')+_0x33c68a(0x69b);else{if(_0x16a7dd['type']===_0x33c68a(0xe9d)&&_0x16a7dd[_0x33c68a(0xa94)])_0xb65b16=_0x5077f3?_0x5077f3+_0x33c68a(0xd63)+_0x16a7dd['imageUrl']+_0x33c68a(0x200):'<img\x20src=\x22'+_0x16a7dd[_0x33c68a(0xa94)]+'\x22\x20class=\x22chat-image\x22>';else{if(_0x16a7dd[_0x33c68a(0xa6b)]===_0x33c68a(0x68e)){const _0x448ad1=_0x41df36[_0x33c68a(0xc0)][_0x33c68a(0xb6a)]&&_0x16a7dd[_0x33c68a(0x8d8)]?_0x33c68a(0x5c1)+_0x16a7dd[_0x33c68a(0x8d8)]:_0x33c68a(0xbed);_0xb65b16=_0x5077f3?_0x5077f3+_0x33c68a(0xd63)+_0x448ad1+_0x33c68a(0x1114)+_0x16a7dd[_0x33c68a(0x4e6)]+_0x33c68a(0xd8b):_0x33c68a(0xf8a)+_0x448ad1+_0x33c68a(0x1114)+_0x16a7dd[_0x33c68a(0x4e6)]+'\x22>';}else{if(_0x16a7dd[_0x33c68a(0xa6b)]===_0x33c68a(0x7f4)){const _0x1ea042=_0x16a7dd[_0x33c68a(0x18a)]||(_0x16a7dd[_0x33c68a(0xa94)]?[_0x16a7dd[_0x33c68a(0xa94)]]:[]);if(_0x1ea042['length']>0x0){const _0xa87eca=_0x1ea042['length'];let _0x333c0d='';_0x333c0d=_0x33c68a(0x12ae)+_0xa87eca+'\x22>',_0x1ea042[_0x33c68a(0x19c)]((_0x15e0f9,_0xc36080)=>{const _0x450649=_0x33c68a;_0x333c0d+=_0x450649(0xf8a)+_0x15e0f9+_0x450649(0x1063)+(_0xc36080+0x1)+'\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>';}),_0x333c0d+=_0x33c68a(0x69b),_0xb65b16=_0x5077f3?''+_0x5077f3+_0x333c0d:_0x333c0d;}}}}}return _0xb65b16;}let _0x892319;if(_0x23fb40['type']==='repost'){const _0x10c4ef=_0x23fb40[_0x4571ed(0x1051)]?'<div\x20class=\x22post-content\x22>'+_0x23fb40[_0x4571ed(0x1051)][_0x4571ed(0x709)](/\n/g,_0x4571ed(0x3ee))+_0x4571ed(0x69b):'';let _0x16bd7f=_0x5dc108,_0x2f46c0=_0x4571ed(0x12ba);if(_0x23fb40[_0x4571ed(0xba8)][_0x4571ed(0x1301)]==='user')_0x16bd7f=_0x41df36['qzoneSettings'][_0x4571ed(0xb47)],_0x2f46c0=_0x41df36[_0x4571ed(0x571)][_0x4571ed(0xabb)];else{const _0x1de775=_0x41df36['chats'][_0x23fb40[_0x4571ed(0xba8)]['authorId']];_0x1de775&&(_0x16bd7f=_0x1de775[_0x4571ed(0x886)]['aiAvatar']||_0x5dc108),_0x2f46c0=_0x5641f2(_0x23fb40[_0x4571ed(0xba8)]['authorOriginalName']);}_0x892319=_0x4571ed(0xc45)+_0x10c4ef+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x16bd7f+'\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@'+_0x2f46c0+_0x4571ed(0x11f1)+_0xd7cdd4(_0x23fb40['originalPost'][_0x4571ed(0x3b7)])+_0x4571ed(0xb74)+_0x1a9ef1(_0x23fb40[_0x4571ed(0xba8)])+_0x4571ed(0x253);}else _0x892319='<div\x20class=\x22post-main-content\x22>'+_0x1a9ef1(_0x23fb40)+'</div>';let _0x1ee300='';if(_0x23fb40['likes']&&_0x23fb40['likes'][_0x4571ed(0xfde)]>0x0){const _0xad4624=_0x23fb40['likes']['map'](_0x50a574=>_0x5641f2(_0x50a574))[_0x4571ed(0xa35)]('、');_0x1ee300=_0x4571ed(0xfb3)+_0xad4624+_0x4571ed(0x57b);}let _0x3e5b12='';_0x23fb40[_0x4571ed(0xcad)]&&_0x23fb40[_0x4571ed(0xcad)][_0x4571ed(0xfde)]>0x0&&(_0x3e5b12=_0x4571ed(0x10f0),_0x23fb40[_0x4571ed(0xcad)][_0x4571ed(0x19c)]((_0xbc5956,_0x337b33)=>{const _0x1aa0f9=_0x4571ed;if(typeof _0xbc5956==='object'&&_0xbc5956!==null&&_0xbc5956[_0x1aa0f9(0xbb)]){const _0x38eb80=_0xbc5956[_0x1aa0f9(0xbb)],_0x91bcbb=_0x5641f2(_0x38eb80);let _0x136f2f;_0x49f222[_0x1aa0f9(0xd73)](_0xbc5956[_0x1aa0f9(0x6af)])?_0x136f2f=_0x1aa0f9(0xf8a)+_0xbc5956[_0x1aa0f9(0x6af)]+_0x1aa0f9(0x687):_0x136f2f=_0x350d3e(_0xbc5956[_0x1aa0f9(0x6af)]);let _0x1a1743='';if(_0xbc5956[_0x1aa0f9(0x855)]){const _0x2b340c=_0x5641f2(_0xbc5956[_0x1aa0f9(0x855)]);_0x1a1743=_0x1aa0f9(0x89a)+_0x91bcbb+_0x1aa0f9(0xc8d)+_0x2b340c+'</span>:\x20'+_0x136f2f;}else _0x1a1743=_0x1aa0f9(0x89a)+_0x91bcbb+_0x1aa0f9(0x1004)+_0x136f2f;_0x3e5b12+=_0x1aa0f9(0x132c)+_0x23fb40['id']+_0x1aa0f9(0x789)+_0x38eb80+_0x1aa0f9(0x62a)+_0x91bcbb+_0x1aa0f9(0x4f4)+_0x1a1743+_0x1aa0f9(0x949)+_0x337b33+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}else _0x3e5b12+='<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>'+String(_0xbc5956)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}),_0x3e5b12+=_0x4571ed(0x69b));const _0x3d7040=_0x41df36[_0x4571ed(0x571)]['nickname'],_0x49dde9=_0x23fb40[_0x4571ed(0x133c)]&&_0x23fb40[_0x4571ed(0x133c)][_0x4571ed(0xee2)](_0x3d7040),_0x50217c=_0x41df36[_0x4571ed(0x12c8)]&&_0x41df36[_0x4571ed(0x12c8)][_0x4571ed(0xcde)](_0x23fb40['id']);let _0x36581c='';_0x23fb40['type']!==_0x4571ed(0xcf0)&&(_0x36581c='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>');_0xaf8fe9[_0x4571ed(0x45c)]=_0x4571ed(0xdf1)+_0xb04968+'\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22'+_0x23fb40['authorId']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>'+_0x5039cd+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0xd7cdd4(_0x23fb40[_0x4571ed(0x3b7)])+_0x4571ed(0x5c4)+_0x892319+_0x4571ed(0x131f)+_0x36581c+_0x4571ed(0xdf0)+(_0x49dde9?'active':'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20'+(_0x50217c?_0x4571ed(0xde5):'')+_0x4571ed(0xbc2)+_0x1ee300+_0x4571ed(0x13b)+_0x3e5b12+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0xaec06b+_0x4571ed(0x651);if(!_0x5a3a45){const _0x9aec84=document[_0x4571ed(0xe1b)]('div');_0x9aec84[_0x4571ed(0x556)]=_0x4571ed(0xcc7),_0x9aec84['innerHTML']=_0x4571ed(0xd77),_0x262a6e[_0x4571ed(0xe91)](_0xaf8fe9),_0x262a6e['appendChild'](_0x9aec84);}return _0x262a6e;}async function _0x1ef318(_0x43d7b9){const _0x250fc0=_0x549949,_0x5f0340=await _0x342df8['qzonePosts']['get'](_0x43d7b9);if(!_0x5f0340){const _0x1d48cf=document['querySelector'](_0x250fc0(0x515)+_0x43d7b9+'\x22]');_0x1d48cf&&_0x1d48cf[_0x250fc0(0x131d)]();return;}const _0x1fe9db=_0x3c5f19['findIndex'](_0x33b3d7=>_0x33b3d7['id']===_0x43d7b9);_0x1fe9db>-0x1&&(_0x3c5f19[_0x1fe9db]=_0x5f0340);const _0x7c0c1e=await _0x342df8[_0x250fc0(0x5c5)][_0x250fc0(0x6bd)](_0x250fc0(0xa6b))[_0x250fc0(0x5b3)](_0x250fc0(0xd91))[_0x250fc0(0x21f)]();_0x41df36[_0x250fc0(0x12c8)]=new Set(_0x7c0c1e[_0x250fc0(0xa79)](_0x59684f=>_0x59684f[_0x250fc0(0x11b6)]['id'])),await _0x24ffe0(_0x5f0340);}async function _0x476b70(){const _0x3d0534=_0x549949,_0x3afb05=document[_0x3d0534(0x383)](_0x3d0534(0x7ea));if(!_0x3afb05)return;const [_0x4f3256,_0x47effd]=await Promise[_0x3d0534(0x1282)]([_0x342df8[_0x3d0534(0x35a)][_0x3d0534(0x4b1)](_0x3d0534(0x3b7))[_0x3d0534(0x1087)]()['filter'](_0x4350f3=>!_0x4350f3[_0x3d0534(0x5fd)])[_0x3d0534(0x21f)](),_0x342df8['favorites'][_0x3d0534(0x6bd)]('type')['equals'](_0x3d0534(0xd91))[_0x3d0534(0x21f)]()]);_0x3c5f19=_0x4f3256,_0x41df36[_0x3d0534(0x12c8)]=new Set(_0x47effd[_0x3d0534(0xa79)](_0x568c2d=>_0x568c2d[_0x3d0534(0x11b6)]['id'])),_0x3afb05[_0x3d0534(0x45c)]='',_0x482fde=0x0;if(_0x3c5f19[_0x3d0534(0xfde)]===0x0){_0x3afb05[_0x3d0534(0x45c)]=_0x3d0534(0x1094);return;}_0x5addec();}async function _0x5addec(){const _0x294919=_0x549949;if(_0x6da8df)return;_0x6da8df=!![];const _0x11078c=document[_0x294919(0x383)](_0x294919(0x7ea));if(!_0x11078c){_0x6da8df=![];return;}_0x38d82d(_0x11078c,'bottom'),setTimeout(async()=>{const _0x2807e1=_0x294919;_0x3a7b5e(_0x11078c);const _0x247f71=_0x482fde,_0x196c75=_0x482fde+_0x2ef398,_0x393c35=_0x3c5f19[_0x2807e1(0x1368)](_0x247f71,_0x196c75),_0x4f7281=document['createDocumentFragment']();for(const _0x29fc0b of _0x393c35){const _0x3a4be0=await _0x24ffe0(_0x29fc0b);_0x4f7281[_0x2807e1(0xe91)](_0x3a4be0);}_0x11078c[_0x2807e1(0xe91)](_0x4f7281),_0x482fde+=_0x393c35[_0x2807e1(0xfde)],_0x6da8df=![];},0x1f4);}function _0x3d58e7(_0x1a53dc,_0x41afb6){const _0x5270f4=_0x549949,_0x32ff59=_0x438dad[_0x5270f4(0x6e6)],_0x3be338=_0x438dad[_0x5270f4(0xd5d)];_0x3be338['innerHTML']='';_0x41df36[_0x5270f4(0x823)][_0x5270f4(0xfde)]===0x0?_0x3be338[_0x5270f4(0x45c)]=_0x5270f4(0x8b3):_0x41df36[_0x5270f4(0x823)][_0x5270f4(0x19c)](_0x2ff9e3=>{const _0x1fb030=_0x5270f4,_0x59dc02=document[_0x1fb030(0xe1b)](_0x1fb030(0x7fd));_0x59dc02[_0x1fb030(0x556)]='sticker-item',_0x59dc02[_0x1fb030(0x655)][_0x1fb030(0x880)]=_0x1fb030(0xb9a)+_0x2ff9e3[_0x1fb030(0x2fa)]+')',_0x59dc02['title']=_0x2ff9e3[_0x1fb030(0x461)],_0x3be338[_0x1fb030(0xe91)](_0x59dc02);});const _0x101b2c=_0x41afb6[_0x5270f4(0x9c5)](),_0x2584f3=document['getElementById'](_0x5270f4(0x1200))[_0x5270f4(0x9c5)]();_0x32ff59[_0x5270f4(0x655)]['display']=_0x5270f4(0x2aa);const _0x2e8f2f=_0x32ff59[_0x5270f4(0x9c5)](),_0x2157e6=_0x2e8f2f['height'],_0x4218b7=_0x2e8f2f[_0x5270f4(0xabd)];_0x32ff59[_0x5270f4(0x655)][_0x5270f4(0x994)]=_0x101b2c[_0x5270f4(0x994)]-_0x2157e6-0x5-_0x2584f3[_0x5270f4(0x994)]+'px';const _0x174bcb=_0x101b2c[_0x5270f4(0x402)]-_0x2584f3['left'];_0x174bcb+_0x4218b7>_0x2584f3[_0x5270f4(0xabd)]?(_0x32ff59['style']['left']='auto',_0x32ff59[_0x5270f4(0x655)][_0x5270f4(0xa12)]=_0x5270f4(0x65d)):(_0x32ff59[_0x5270f4(0x655)][_0x5270f4(0x402)]=_0x174bcb+'px',_0x32ff59[_0x5270f4(0x655)][_0x5270f4(0xa12)]=_0x5270f4(0xa60)),_0x438dad[_0x5270f4(0xe81)]=!![],_0x438dad[_0x5270f4(0xf46)]=_0x1a53dc;}function _0x2ff22a(){const _0x28264d=_0x549949;_0x438dad[_0x28264d(0xe81)]&&(_0x438dad['panelEl'][_0x28264d(0x655)][_0x28264d(0x2b6)]=_0x28264d(0xa70),_0x438dad['isOpen']=![],_0x438dad[_0x28264d(0xf46)]=null);}async function _0x40afd3(_0x49e8d2,_0x608bf5){const _0x1b661a=_0x549949;if(!_0x608bf5||!_0x608bf5[_0x1b661a(0x2fa)])return;const _0x52320e=await _0x342df8[_0x1b661a(0x35a)][_0x1b661a(0x1a3)](_0x49e8d2);if(!_0x52320e){console[_0x1b661a(0x98)](_0x1b661a(0x454),_0x49e8d2);return;}!_0x52320e[_0x1b661a(0xcad)]&&(_0x52320e[_0x1b661a(0xcad)]=[]);const _0x25cc01={'commenterName':_0x41df36[_0x1b661a(0x571)][_0x1b661a(0xabb)],'text':_0x608bf5[_0x1b661a(0x2fa)],'meaning':_0x608bf5[_0x1b661a(0x461)],'timestamp':Date['now']()};_0x52320e[_0x1b661a(0xcad)][_0x1b661a(0x258)](_0x25cc01),await _0x342df8['qzonePosts'][_0x1b661a(0xaf9)](_0x49e8d2,{'comments':_0x52320e['comments']}),_0x2ff22a(),await _0x476b70();const _0x4f4534=(_0x52320e[_0x1b661a(0xbdc)]||_0x52320e[_0x1b661a(0x11b6)]||_0x1b661a(0xcd2))[_0x1b661a(0xba5)](0x0,0x1e);for(const _0x27afa1 in _0x41df36[_0x1b661a(0x864)]){const _0x9142af=_0x41df36[_0x1b661a(0x864)][_0x27afa1];if(!_0x9142af[_0x1b661a(0x1a2)]){const _0x3ddb5e=_0x1b661a(0xa9b)+_0x41df36[_0x1b661a(0x571)][_0x1b661a(0xabb)]+_0x1b661a(0xb73)+_0x49e8d2+',\x20内容摘要:\x20“'+_0x4f4534+'”)下发送了一个表情评论，意思是：“'+_0x608bf5[_0x1b661a(0x461)]+'”。请你对此作出回应。]',_0x3c5a32={'role':_0x1b661a(0xb1),'content':_0x3ddb5e,'timestamp':Date[_0x1b661a(0x108d)](),'isHidden':!![]};_0x9142af[_0x1b661a(0xd08)]['push'](_0x3c5a32),await _0x342df8[_0x1b661a(0x864)][_0x1b661a(0x9c0)](_0x9142af);}}}function _0x3a75d2(_0xf61f48){const _0x6a1b3a=_0x549949;_0x247f89=_0xf61f48,document[_0x6a1b3a(0x383)](_0x6a1b3a(0x132f))[_0x6a1b3a(0x1be)]='',document[_0x6a1b3a(0x383)](_0x6a1b3a(0x739))[_0x6a1b3a(0x119a)]['add'](_0x6a1b3a(0x106d));}function _0x2386f0(){const _0xfda724=_0x549949;document[_0xfda724(0x383)]('repost-modal')[_0xfda724(0x119a)][_0xfda724(0x131d)](_0xfda724(0x106d)),_0x247f89=null;}async function _0x372cc6(){const _0x468a98=_0x549949;if(!_0x247f89)return;const _0x4f6dc7=document[_0x468a98(0x383)]('repost-comment-input')['value'][_0x468a98(0x1cb)](),_0x3417ec=await _0x342df8[_0x468a98(0x35a)]['get'](_0x247f89);if(!_0x3417ec){alert(_0x468a98(0x4bf)),_0x2386f0();return;}const _0x81c123={'type':_0x468a98(0xcf0),'timestamp':Date[_0x468a98(0x108d)](),'authorId':_0x468a98(0x66e),'repostComment':_0x4f6dc7,'originalPost':_0x3417ec,'visibleGroupIds':null};await _0x342df8[_0x468a98(0x35a)]['add'](_0x81c123),_0x2386f0(),await _0x476b70(),alert(_0x468a98(0x540));}function _0x462ca7(_0x4dee7a){const _0x5481a0=_0x549949,_0x564d18=document['getElementById']('favorites-list');_0x564d18[_0x5481a0(0x45c)]='';if(_0x4dee7a[_0x5481a0(0xfde)]===0x0){const _0x53e4cc=document[_0x5481a0(0x383)](_0x5481a0(0x10e1))['value'],_0x139b9d=_0x53e4cc?'未找到相关收藏':_0x5481a0(0x1127);_0x564d18[_0x5481a0(0x45c)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>'+_0x139b9d+_0x5481a0(0x29a);return;}for(const _0x4287c6 of _0x4dee7a){const _0x308ebc=document['createElement'](_0x5481a0(0x7fd));_0x308ebc[_0x5481a0(0x556)]=_0x5481a0(0x9e2),_0x308ebc[_0x5481a0(0x118)]['favid']=_0x4287c6['id'];let _0x13852c='',_0x5487df='',_0x4d03f7='',_0x39c873='';if(_0x4287c6[_0x5481a0(0xa6b)]==='qzone_post'){const _0x320b7a=_0x4287c6[_0x5481a0(0x11b6)];_0x4d03f7=_0x5481a0(0x61d);let _0x379c0a=_0x5dc108,_0x2d70c5=_0x5481a0(0x260);if(_0x320b7a[_0x5481a0(0x1301)]===_0x5481a0(0x66e))_0x379c0a=_0x41df36[_0x5481a0(0x571)]['avatar'],_0x2d70c5=_0x41df36[_0x5481a0(0x571)][_0x5481a0(0xabb)];else _0x41df36[_0x5481a0(0x864)][_0x320b7a[_0x5481a0(0x1301)]]&&(_0x379c0a=_0x41df36[_0x5481a0(0x864)][_0x320b7a[_0x5481a0(0x1301)]][_0x5481a0(0x886)]['aiAvatar'],_0x2d70c5=_0x41df36[_0x5481a0(0x864)][_0x320b7a[_0x5481a0(0x1301)]]['name']);_0x13852c=_0x5481a0(0xf8a)+_0x379c0a+_0x5481a0(0x1123)+_0x2d70c5+'</div></div>';const _0x3d9d07=_0x320b7a[_0x5481a0(0xbdc)]?'<div\x20class=\x22post-content\x22>'+_0x320b7a[_0x5481a0(0xbdc)][_0x5481a0(0x709)](/\n/g,_0x5481a0(0x3ee))+'</div>':'';if(_0x320b7a['type']===_0x5481a0(0x23e))_0x5487df=_0x5481a0(0xdaa)+_0x320b7a[_0x5481a0(0x11b6)][_0x5481a0(0x709)](/\n/g,_0x5481a0(0x3ee))+'</div>';else{if(_0x320b7a['type']===_0x5481a0(0xe9d)&&_0x320b7a[_0x5481a0(0xa94)]){const _0x2e1ff4=_0x41df36[_0x5481a0(0xc0)]['enableAiDrawing']&&_0x320b7a[_0x5481a0(0x8d8)]?_0x5481a0(0x5c1)+_0x320b7a[_0x5481a0(0x8d8)]:_0x5481a0(0xbed);_0x5487df=_0x3d9d07?_0x3d9d07+_0x5481a0(0xd63)+_0x2e1ff4+_0x5481a0(0x200):_0x5481a0(0xf8a)+_0x2e1ff4+_0x5481a0(0x1030);}else{if(_0x320b7a[_0x5481a0(0xa6b)]===_0x5481a0(0x68e)){const _0x307a5a=_0x41df36['globalSettings']['enableAiDrawing']&&_0x320b7a[_0x5481a0(0x8d8)]?'https://image.pollinations.ai/prompt/'+_0x320b7a[_0x5481a0(0x8d8)]:_0x5481a0(0xbed);_0x5487df=_0x3d9d07?_0x3d9d07+_0x5481a0(0xd63)+_0x307a5a+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x320b7a['hiddenContent']+_0x5481a0(0xd8b):_0x5481a0(0xf8a)+_0x307a5a+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x320b7a[_0x5481a0(0x4e6)]+'\x22>';}}}let _0x4e7c10='';_0x320b7a[_0x5481a0(0x133c)]&&_0x320b7a[_0x5481a0(0x133c)][_0x5481a0(0xfde)]>0x0&&(_0x4e7c10='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+_0x320b7a['likes'][_0x5481a0(0xa35)]('、')+'\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>');let _0x47f243='';_0x320b7a[_0x5481a0(0xcad)]&&_0x320b7a[_0x5481a0(0xcad)][_0x5481a0(0xfde)]>0x0&&(_0x47f243=_0x5481a0(0x10f0),_0x320b7a[_0x5481a0(0xcad)][_0x5481a0(0x19c)]((_0xa26d1,_0xd6dad6)=>{const _0x442437=_0x5481a0;if(typeof _0xa26d1===_0x442437(0x890)&&_0xa26d1!==null&&_0xa26d1[_0x442437(0xbb)]){const _0x5e414d=_0xa26d1[_0x442437(0xbb)],_0x53bbd2=_0x5641f2(_0x5e414d);let _0x5429cd;_0x49f222[_0x442437(0xd73)](_0xa26d1[_0x442437(0x6af)])?_0x5429cd=_0x442437(0xf8a)+_0xa26d1[_0x442437(0x6af)]+_0x442437(0x687):_0x5429cd=_0xa26d1[_0x442437(0x6af)];let _0x403a67='';if(_0xa26d1[_0x442437(0x855)]){const _0x24b31d=_0x5641f2(_0xa26d1['replyTo']);_0x403a67=_0x442437(0x89a)+_0x53bbd2+'</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>'+_0x24b31d+'</span>:\x20'+_0x5429cd;}else _0x403a67='<span\x20class=\x22commenter-name\x22>'+_0x53bbd2+_0x442437(0x1004)+_0x5429cd;_0x47f243+=_0x442437(0x132c)+_0x320b7a['id']+'\x22\x20data-commenter-original-name=\x22'+_0x5e414d+_0x442437(0x62a)+_0x53bbd2+_0x442437(0x984)+_0x403a67+_0x442437(0x118b)+_0xd6dad6+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}else _0x47f243+=_0x442437(0x217)+String(_0xa26d1)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}),_0x47f243+=_0x5481a0(0x69b)),_0x39c873=''+_0x4e7c10+_0x47f243;}else{if(_0x4287c6[_0x5481a0(0xa6b)]===_0x5481a0(0xbbe)){const _0x2526c1=_0x4287c6['content'],_0x41a2b4=_0x41df36['chats'][_0x4287c6[_0x5481a0(0xa65)]];if(!_0x41a2b4)continue;_0x4d03f7=_0x5481a0(0x946)+_0x41a2b4['name']+'\x20的聊天';const _0x2e78f7=_0x2526c1[_0x5481a0(0x10ff)]===_0x5481a0(0x66e);let _0x58b055,_0xcf8687;if(_0x2e78f7)_0x58b055=_0x41a2b4['isGroup']?_0x41a2b4[_0x5481a0(0x886)]['myNickname']||'我':'我',_0xcf8687=_0x41a2b4['settings']['myAvatar']||(_0x41a2b4[_0x5481a0(0x1a2)]?_0x188ace:_0x5dc108);else{if(_0x41a2b4[_0x5481a0(0x1a2)]){const _0x3cd149=_0x41a2b4[_0x5481a0(0x12a6)][_0x5481a0(0xd12)](_0x203377=>_0x203377[_0x5481a0(0x283)]===_0x2526c1['senderName']);_0x58b055=_0x2526c1['senderName'],_0xcf8687=_0x3cd149?_0x3cd149[_0x5481a0(0xb47)]:_0x59100f;}else _0x58b055=_0x41a2b4[_0x5481a0(0x461)],_0xcf8687=_0x41a2b4[_0x5481a0(0x886)][_0x5481a0(0x121e)]||_0x5dc108;}_0x13852c='<img\x20src=\x22'+_0xcf8687+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x58b055+_0x5481a0(0x12f0);if(typeof _0x2526c1[_0x5481a0(0x11b6)]===_0x5481a0(0xafa)&&_0x49f222['test'](_0x2526c1[_0x5481a0(0x11b6)]))_0x5487df=_0x5481a0(0xf8a)+_0x2526c1[_0x5481a0(0x11b6)]+'\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>';else Array[_0x5481a0(0x565)](_0x2526c1[_0x5481a0(0x11b6)])&&_0x2526c1['content'][0x0]?.['type']==='image_url'?_0x5487df='<img\x20src=\x22'+_0x2526c1[_0x5481a0(0x11b6)][0x0][_0x5481a0(0x122d)][_0x5481a0(0x2fa)]+_0x5481a0(0x1030):_0x5487df=String(_0x2526c1['content']||'')[_0x5481a0(0x709)](/\n/g,'<br>');}else{if(_0x4287c6[_0x5481a0(0xa6b)]==='char_diary'){const _0x392389=_0x4287c6['content'];_0x4d03f7=_0x5481a0(0x1097)+_0x392389[_0x5481a0(0x882)]+_0x5481a0(0x55c);const _0x41fcc5=_0x41df36[_0x5481a0(0x864)][_0x392389[_0x5481a0(0x792)]],_0x367144=_0x41fcc5?_0x41fcc5[_0x5481a0(0x886)][_0x5481a0(0x121e)]:_0x5dc108;_0x13852c='<img\x20src=\x22'+_0x367144+_0x5481a0(0x1123)+_0x392389[_0x5481a0(0x882)]+_0x5481a0(0x12f0);const _0x4ba8be=_0x392389[_0x5481a0(0x11b6)]||'',_0xda5bf1=_0x350d3e(_0x4ba8be)[_0x5481a0(0x709)](/\n/g,_0x5481a0(0x3ee));_0x5487df=_0x5481a0(0x548)+_0x392389['title']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>'+_0xda5bf1+_0x5481a0(0xdf);}else{if(_0x4287c6['type']==='char_browser_article'){const _0x25b217=_0x4287c6['content'];_0x4d03f7=_0x5481a0(0x1097)+_0x25b217[_0x5481a0(0x882)]+_0x5481a0(0x88f);const _0x5567a5=_0x41df36[_0x5481a0(0x864)][_0x25b217[_0x5481a0(0x792)]],_0x129547=_0x5567a5?_0x5567a5[_0x5481a0(0x886)][_0x5481a0(0x121e)]:_0x5dc108;_0x13852c=_0x5481a0(0xf8a)+_0x129547+_0x5481a0(0x1123)+_0x25b217[_0x5481a0(0x882)]+'</div></div>',_0x5487df='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>'+_0x25b217[_0x5481a0(0xf3a)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>'+(_0x25b217[_0x5481a0(0x11b6)]||'')[_0x5481a0(0x709)](/\n/g,_0x5481a0(0x3ee))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}else{if(_0x4287c6[_0x5481a0(0xa6b)]===_0x5481a0(0x1147)){const _0xa6ef91=_0x4287c6[_0x5481a0(0x11b6)];_0x4d03f7=_0x5481a0(0x1097)+_0xa6ef91[_0x5481a0(0x882)]+'\x20的备忘录';const _0x4a740e=_0x41df36[_0x5481a0(0x864)][_0xa6ef91['characterId']],_0x270ac7=_0x4a740e?_0x4a740e['settings'][_0x5481a0(0x121e)]:_0x5dc108;_0x13852c=_0x5481a0(0xf8a)+_0x270ac7+_0x5481a0(0x1123)+_0xa6ef91[_0x5481a0(0x882)]+_0x5481a0(0x12f0),_0x5487df=_0x5481a0(0x1084)+_0xa6ef91['title']+_0x5481a0(0x6be)+_0xa6ef91['content'][_0x5481a0(0x709)](/\n/g,_0x5481a0(0x3ee))+_0x5481a0(0x1037);}}}}}_0x308ebc[_0x5481a0(0x45c)]=_0x5481a0(0x1e2)+_0x13852c+'<div\x20class=\x22source\x22>'+_0x4d03f7+_0x5481a0(0x2a1)+_0x5487df+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x39c873,_0x564d18[_0x5481a0(0xe91)](_0x308ebc);}}async function _0x32454e(){const _0x565df5=_0x549949;allFavoriteItems=await _0x342df8['favorites'][_0x565df5(0x4b1)]('timestamp')['reverse']()[_0x565df5(0x21f)]();const _0x2c0810=document[_0x565df5(0x383)](_0x565df5(0x10e1)),_0x3d108b=document[_0x565df5(0x383)](_0x565df5(0xe97));_0x2c0810[_0x565df5(0x1be)]='',_0x3d108b[_0x565df5(0x655)][_0x565df5(0x2b6)]=_0x565df5(0xa70),_0x462ca7(allFavoriteItems);}function _0x316248(){const _0x1383e2=_0x549949;document['getElementById'](_0x1383e2(0x12aa))['value']='',document[_0x1383e2(0x383)](_0x1383e2(0x20f))[_0x1383e2(0xf6c)]='',document[_0x1383e2(0x383)](_0x1383e2(0xcbe))[_0x1383e2(0x1be)]='',document[_0x1383e2(0x383)]('post-image-preview-container')[_0x1383e2(0x119a)][_0x1383e2(0x131d)](_0x1383e2(0x106d)),document[_0x1383e2(0x383)](_0x1383e2(0x7a3))['style'][_0x1383e2(0x2b6)]='none',document[_0x1383e2(0x383)](_0x1383e2(0xea1))[_0x1383e2(0x1be)]='',document[_0x1383e2(0x383)](_0x1383e2(0xe2f))['value']='',document[_0x1383e2(0x383)](_0x1383e2(0xaeb))['click']();}async function _0x287130(){const _0x380cce=_0x549949,_0x5342db=await _0x23a88b(_0x380cce(0xf1c),_0x380cce(0xadd),{'confirmButtonClass':_0x380cce(0x51b),'confirmText':_0x380cce(0x10f3)});if(!_0x5342db)return;await _0x296ef9(_0x380cce(0x4a6),_0x380cce(0xa77)),console[_0x380cce(0xe72)](_0x380cce(0x10da));let _0x48190c={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0x342df8[_0x380cce(0xe17)]('rw',_0x342df8['tables'],async()=>{const _0x2253e4=_0x380cce,_0x32201f=await _0x342df8['chats'][_0x2253e4(0x21f)](),_0x8e552d=await _0x342df8[_0x2253e4(0x656)][_0x2253e4(0x21f)](),_0x1b485e=new Set(_0x32201f[_0x2253e4(0xa79)](_0x1fc8d1=>_0x1fc8d1['id'])),_0x2a775f=new Set(_0x8e552d[_0x2253e4(0xa79)](_0x176f3f=>'npc_'+_0x176f3f['id'])),_0x47c0bd=new Set(_0x32201f[_0x2253e4(0x98a)](_0x195df8=>!_0x195df8[_0x2253e4(0x1a2)])[_0x2253e4(0xa79)](_0x854fd6=>_0x854fd6[_0x2253e4(0x283)]));_0x47c0bd['add'](_0x41df36['qzoneSettings'][_0x2253e4(0xabb)]||'{{user}}'),_0x8e552d[_0x2253e4(0x19c)](_0x4a40e6=>_0x47c0bd[_0x2253e4(0xbff)](_0x4a40e6['name']));for(const _0x3cfe08 of _0x32201f){let _0x209049=![];if(_0x3cfe08['isGroup']&&_0x3cfe08[_0x2253e4(0x12a6)]){const _0x4319a0=_0x3cfe08[_0x2253e4(0x12a6)][_0x2253e4(0xfde)];_0x3cfe08[_0x2253e4(0x12a6)]=_0x3cfe08[_0x2253e4(0x12a6)][_0x2253e4(0x98a)](_0x49d977=>_0x1b485e[_0x2253e4(0xcde)](_0x49d977['id'])||_0x2a775f[_0x2253e4(0xcde)](_0x49d977['id'])),_0x3cfe08[_0x2253e4(0x12a6)][_0x2253e4(0xfde)]<_0x4319a0&&(_0x48190c[_0x2253e4(0x9dc)]+=_0x4319a0-_0x3cfe08[_0x2253e4(0x12a6)][_0x2253e4(0xfde)],_0x209049=!![]);}if(_0x3cfe08[_0x2253e4(0x886)]?.['linkedMemoryChatIds']?.[_0x2253e4(0xfde)]>0x0){const _0x95984b=_0x3cfe08[_0x2253e4(0x886)][_0x2253e4(0x20c)]['length'];_0x3cfe08[_0x2253e4(0x886)][_0x2253e4(0x20c)]=_0x3cfe08[_0x2253e4(0x886)][_0x2253e4(0x20c)][_0x2253e4(0x98a)](_0x45b2a8=>_0x1b485e[_0x2253e4(0xcde)](_0x45b2a8)),_0x3cfe08[_0x2253e4(0x886)][_0x2253e4(0x20c)][_0x2253e4(0xfde)]<_0x95984b&&(_0x48190c[_0x2253e4(0x1023)]+=_0x95984b-_0x3cfe08[_0x2253e4(0x886)]['linkedMemoryChatIds'][_0x2253e4(0xfde)],_0x209049=!![]);}_0x209049&&await _0x342df8[_0x2253e4(0x864)][_0x2253e4(0x9c0)](_0x3cfe08);}const _0x2a3f41=await _0x342df8[_0x2253e4(0x35a)][_0x2253e4(0x21f)]();for(const _0x5c0cd3 of _0x2a3f41){let _0x9dd265=![];const _0x2ce891=_0x5c0cd3[_0x2253e4(0x1301)]===_0x2253e4(0x66e)||_0x1b485e[_0x2253e4(0xcde)](_0x5c0cd3[_0x2253e4(0x1301)])||_0x2a775f[_0x2253e4(0xcde)](_0x5c0cd3[_0x2253e4(0x1301)]);if(!_0x2ce891){await _0x342df8[_0x2253e4(0x35a)][_0x2253e4(0x971)](_0x5c0cd3['id']),_0x48190c['posts']++;continue;}if(_0x5c0cd3['likes']&&_0x5c0cd3[_0x2253e4(0x133c)][_0x2253e4(0xfde)]>0x0){const _0x3ec7b3=_0x5c0cd3[_0x2253e4(0x133c)][_0x2253e4(0xfde)];_0x5c0cd3[_0x2253e4(0x133c)]=_0x5c0cd3['likes'][_0x2253e4(0x98a)](_0x20bb77=>_0x47c0bd[_0x2253e4(0xcde)](_0x20bb77)),_0x5c0cd3[_0x2253e4(0x133c)][_0x2253e4(0xfde)]<_0x3ec7b3&&(_0x48190c[_0x2253e4(0x133c)]+=_0x3ec7b3-_0x5c0cd3['likes'][_0x2253e4(0xfde)],_0x9dd265=!![]);}if(_0x5c0cd3['comments']&&_0x5c0cd3[_0x2253e4(0xcad)][_0x2253e4(0xfde)]>0x0){const _0x27e2fa=_0x5c0cd3[_0x2253e4(0xcad)][_0x2253e4(0xfde)];_0x5c0cd3[_0x2253e4(0xcad)]=_0x5c0cd3[_0x2253e4(0xcad)][_0x2253e4(0x98a)](_0x2f3e2c=>{const _0x5d9d9b=_0x2253e4;if(typeof _0x2f3e2c===_0x5d9d9b(0x890)&&_0x2f3e2c['commenterName'])return _0x47c0bd['has'](_0x2f3e2c['commenterName']);return!![];}),_0x5c0cd3['comments'][_0x2253e4(0xfde)]<_0x27e2fa&&(_0x48190c[_0x2253e4(0xcad)]+=_0x27e2fa-_0x5c0cd3[_0x2253e4(0xcad)][_0x2253e4(0xfde)],_0x9dd265=!![]);}_0x9dd265&&await _0x342df8[_0x2253e4(0x35a)][_0x2253e4(0x9c0)](_0x5c0cd3);}await _0x342df8[_0x2253e4(0x966)][_0x2253e4(0x6bd)]('chatId')[_0x2253e4(0xcea)]([..._0x1b485e])['delete']()[_0x2253e4(0x1c1)](_0x3118f7=>_0x48190c[_0x2253e4(0x966)]+=_0x3118f7),await _0x342df8[_0x2253e4(0xdb9)][_0x2253e4(0x6bd)](_0x2253e4(0xa65))['noneOf']([..._0x1b485e])['delete']()[_0x2253e4(0x1c1)](_0xd59b8c=>_0x48190c[_0x2253e4(0xdb9)]+=_0xd59b8c);const _0x2a4a20=await _0x342df8[_0x2253e4(0x929)][_0x2253e4(0x21f)]();for(const _0x4af14b of _0x2a4a20){_0x4af14b[_0x2253e4(0xa65)]!==_0x2253e4(0x934)&&!_0x1b485e[_0x2253e4(0xcde)](_0x4af14b['chatId'])&&(await _0x342df8[_0x2253e4(0x929)]['delete'](_0x4af14b['id']),_0x48190c[_0x2253e4(0x929)]++);}});let _0x2e9aef=_0x380cce(0xb33),_0x2183ee=![];Object[_0x380cce(0x329)](_0x48190c)[_0x380cce(0x19c)](([_0x5f3e84,_0x4261bb])=>{const _0x492587=_0x380cce;if(_0x4261bb>0x0){const _0x4226a2={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':_0x492587(0xb10),'renderingRules':_0x492587(0x166),'groupMembers':_0x492587(0x12c),'chatLinks':_0x492587(0x63f)};_0x2e9aef+=_0x492587(0xe20)+_0x4261bb+_0x492587(0x5bc)+(_0x4226a2[_0x5f3e84]||_0x5f3e84)+'。\x0a',_0x2183ee=!![];}});!_0x2183ee&&(_0x2e9aef=_0x380cce(0x1357));_0x2e9aef+='\x0a建议刷新页面以确保所有更改生效。',await _0x296ef9(_0x380cce(0x12bb),_0x2e9aef);const _0x33d46f=await _0x23a88b(_0x380cce(0x2ff),_0x380cce(0x1395));_0x33d46f&&location[_0x380cce(0x114a)]();}catch(_0x3a6801){console[_0x380cce(0x98)]('清理冗余数据时出错:',_0x3a6801),await _0x296ef9(_0x380cce(0x12d7),_0x380cce(0x842)+_0x3a6801[_0x380cce(0x5f8)]);}}async function _0x4ce4e7(){const _0x23cdbb=_0x549949;try{const _0x4f1f56={'version':0x1,'timestamp':Date['now']()},[_0x3428a5,_0xaba760,_0x1b0021,_0x3626dd,_0x49241e,_0x44364e,_0x50bf38,_0x59baed,_0xa9e192,_0x36546e,_0x4b24cd,_0x589a8e,_0x2b9b14,_0x22f933,_0x2c7877,_0x191a70,_0x237ed0,_0xe2b6e8,_0x677502,_0x4a28f8,_0x10d03f,_0x44d725,_0x4794a6,_0x55e0d0,_0x2bf476]=await Promise[_0x23cdbb(0x1282)]([_0x342df8[_0x23cdbb(0x864)]['toArray'](),_0x342df8[_0x23cdbb(0xf17)][_0x23cdbb(0x21f)](),_0x342df8['userStickers'][_0x23cdbb(0x21f)](),_0x342df8[_0x23cdbb(0x673)][_0x23cdbb(0x1a3)](_0x23cdbb(0x10e3)),_0x342df8[_0x23cdbb(0xc0)][_0x23cdbb(0x1a3)](_0x23cdbb(0x10e3)),_0x342df8[_0x23cdbb(0x10e5)][_0x23cdbb(0x21f)](),_0x342df8[_0x23cdbb(0xcbf)][_0x23cdbb(0x1a3)](_0x23cdbb(0x10e3)),_0x342df8[_0x23cdbb(0x571)][_0x23cdbb(0x1a3)](_0x23cdbb(0x10e3)),_0x342df8['qzonePosts'][_0x23cdbb(0x21f)](),_0x342df8['qzoneAlbums']['toArray'](),_0x342df8[_0x23cdbb(0x1218)][_0x23cdbb(0x21f)](),_0x342df8[_0x23cdbb(0x5c5)][_0x23cdbb(0x21f)](),_0x342df8[_0x23cdbb(0x108f)][_0x23cdbb(0x21f)](),_0x342df8[_0x23cdbb(0x966)][_0x23cdbb(0x21f)](),_0x342df8[_0x23cdbb(0xa1c)]['toArray'](),_0x342df8[_0x23cdbb(0xf29)][_0x23cdbb(0x21f)](),_0x342df8['shoppingProducts']['toArray'](),_0x342df8[_0x23cdbb(0xdb9)]['toArray'](),_0x342df8['renderingRules'][_0x23cdbb(0x21f)](),_0x342df8[_0x23cdbb(0x1329)][_0x23cdbb(0x21f)](),_0x342df8[_0x23cdbb(0x72d)][_0x23cdbb(0x21f)](),_0x342df8[_0x23cdbb(0x1156)][_0x23cdbb(0x21f)](),_0x342df8[_0x23cdbb(0x32f)]['toArray'](),_0x342df8[_0x23cdbb(0xbea)][_0x23cdbb(0x21f)](),_0x342df8[_0x23cdbb(0x656)][_0x23cdbb(0x21f)]()]);Object[_0x23cdbb(0xa8d)](_0x4f1f56,{'chats':_0x3428a5,'worldBooks':_0xaba760,'userStickers':_0x1b0021,'apiConfig':_0x3626dd,'globalSettings':_0x49241e,'personaPresets':_0x44364e,'musicLibrary':_0x50bf38,'qzoneSettings':_0x59baed,'qzonePosts':_0xa9e192,'qzoneAlbums':_0x36546e,'qzonePhotos':_0x4b24cd,'favorites':_0x589a8e,'qzoneGroups':_0x2b9b14,'memories':_0x22f933,'worldBookCategories':_0x2c7877,'apiPresets':_0x191a70,'shoppingProducts':_0x237ed0,'callRecords':_0xe2b6e8,'renderingRules':_0x677502,'doubanPosts':_0x4a28f8,'stickerCategories':_0x10d03f,'appearancePresets':_0x44d725,'presets':_0x4794a6,'presetCategories':_0x55e0d0,'npcs':_0x2bf476});const _0x51721c=new Blob([JSON[_0x23cdbb(0x3fb)](_0x4f1f56,null,0x2)],{'type':'application/json'}),_0x537107=URL[_0x23cdbb(0x679)](_0x51721c),_0x429f54=Object[_0x23cdbb(0xa8d)](document[_0x23cdbb(0xe1b)]('a'),{'href':_0x537107,'download':_0x23cdbb(0x5a1)+new Date()[_0x23cdbb(0x226)]()[_0x23cdbb(0x105d)]('T')[0x0]+_0x23cdbb(0xd33)});_0x429f54[_0x23cdbb(0x5c7)](),URL[_0x23cdbb(0x119d)](_0x537107),await _0x296ef9('导出成功',_0x23cdbb(0xe48));}catch(_0x14d16c){console[_0x23cdbb(0x98)]('导出数据时出错:',_0x14d16c),await _0x296ef9(_0x23cdbb(0xf11),'发生了一个错误:\x20'+_0x14d16c[_0x23cdbb(0x5f8)]);}}async function _0x3157e1(_0x2608fc){const _0x57a7e6=_0x549949;try{await _0x342df8[_0x57a7e6(0xe17)]('rw',_0x342df8[_0x57a7e6(0x10ef)],async()=>{const _0x540fc9=_0x57a7e6;for(const _0x1fd1ed of _0x342df8['tables']){await _0x1fd1ed['clear']();}for(const _0xd82959 in _0x2608fc){Array[_0x540fc9(0x565)](_0x2608fc[_0xd82959])&&(console[_0x540fc9(0xe72)](_0x540fc9(0xb8)+_0xd82959+',\x20记录数:\x20'+_0x2608fc[_0xd82959][_0x540fc9(0xfde)]),await _0x342df8[_0x540fc9(0xac)](_0xd82959)[_0x540fc9(0xb8d)](_0x2608fc[_0xd82959]));}});}catch(_0x1f43d6){throw new Error(_0x57a7e6(0x68b)+_0x1f43d6[_0x57a7e6(0x5f8)]);}}async function _0x5b22a4(_0x3e5e2c){const _0x2855cd=_0x549949;if(!_0x3e5e2c)return;const _0x1d48f8=await _0x23a88b('严重警告！','导入备份将完全覆盖您当前的所有数据。此操作不可撤销！确定要继续吗？',{'confirmButtonClass':_0x2855cd(0x51b)});if(!_0x1d48f8)return;await _0x296ef9(_0x2855cd(0x4a6),_0x2855cd(0x12cc));try{const _0x5a72bb=await _0x3e5e2c[_0x2855cd(0x6af)](),_0x4c2657=JSON['parse'](_0x5a72bb);if(_0x4c2657[_0x2855cd(0x8c6)]&&typeof _0x4c2657[_0x2855cd(0x8c6)]==='object'&&_0x4c2657['data']['chats'])console[_0x2855cd(0xe72)](_0x2855cd(0xbcd)),await _0x3157e1(_0x4c2657[_0x2855cd(0x8c6)]);else{if(_0x4c2657['chats'])console[_0x2855cd(0xe72)](_0x2855cd(0xdc8)),await _0x46c3ab(_0x4c2657);else throw new Error(_0x2855cd(0xb8f));}await _0x296ef9(_0x2855cd(0xab0),_0x2855cd(0x64f)),setTimeout(()=>{const _0x43b1f9=_0x2855cd;window[_0x43b1f9(0x130c)][_0x43b1f9(0x114a)]();},0x5dc);}catch(_0x2a0cbf){console[_0x2855cd(0x98)]('导入数据时出错:',_0x2a0cbf),await _0x296ef9(_0x2855cd(0x108e),_0x2855cd(0x12f4)+_0x2a0cbf[_0x2855cd(0x5f8)]);}}async function _0x46c3ab(_0xfdae0b){const _0x4e77f0=_0x549949;try{await _0x342df8[_0x4e77f0(0xe17)]('rw',_0x342df8['tables'],async()=>{const _0x5c4819=_0x4e77f0;await _0x342df8[_0x5c4819(0x864)]['clear'](),await _0x342df8[_0x5c4819(0xf17)][_0x5c4819(0x4b8)]();for(const _0x25c8bf of _0x342df8[_0x5c4819(0x10ef)]){await _0x25c8bf[_0x5c4819(0x4b8)]();}if(Array[_0x5c4819(0x565)](_0xfdae0b[_0x5c4819(0x864)]))await _0x342df8[_0x5c4819(0x864)][_0x5c4819(0xb8d)](_0xfdae0b[_0x5c4819(0x864)]);if(Array[_0x5c4819(0x565)](_0xfdae0b[_0x5c4819(0xf17)]))await _0x342df8[_0x5c4819(0xf17)][_0x5c4819(0xb8d)](_0xfdae0b[_0x5c4819(0xf17)]);if(Array['isArray'](_0xfdae0b['userStickers']))await _0x342df8['userStickers']['bulkPut'](_0xfdae0b[_0x5c4819(0x823)]);if(_0xfdae0b[_0x5c4819(0x673)])await _0x342df8[_0x5c4819(0x673)][_0x5c4819(0x9c0)](_0xfdae0b[_0x5c4819(0x673)]);if(_0xfdae0b['globalSettings'])await _0x342df8[_0x5c4819(0xc0)][_0x5c4819(0x9c0)](_0xfdae0b[_0x5c4819(0xc0)]);if(Array['isArray'](_0xfdae0b['personaPresets']))await _0x342df8['personaPresets'][_0x5c4819(0xb8d)](_0xfdae0b[_0x5c4819(0x10e5)]);if(_0xfdae0b['musicLibrary'])await _0x342df8['musicLibrary'][_0x5c4819(0x9c0)](_0xfdae0b[_0x5c4819(0xcbf)]);if(_0xfdae0b[_0x5c4819(0x571)])await _0x342df8[_0x5c4819(0x571)]['put'](_0xfdae0b[_0x5c4819(0x571)]);if(Array[_0x5c4819(0x565)](_0xfdae0b['qzonePosts']))await _0x342df8[_0x5c4819(0x35a)][_0x5c4819(0xb8d)](_0xfdae0b['qzonePosts']);if(Array[_0x5c4819(0x565)](_0xfdae0b['qzoneAlbums']))await _0x342df8[_0x5c4819(0xb86)][_0x5c4819(0xb8d)](_0xfdae0b[_0x5c4819(0xb86)]);if(Array['isArray'](_0xfdae0b[_0x5c4819(0x1218)]))await _0x342df8[_0x5c4819(0x1218)]['bulkPut'](_0xfdae0b[_0x5c4819(0x1218)]);if(Array['isArray'](_0xfdae0b[_0x5c4819(0x5c5)]))await _0x342df8[_0x5c4819(0x5c5)]['bulkPut'](_0xfdae0b[_0x5c4819(0x5c5)]);if(Array['isArray'](_0xfdae0b[_0x5c4819(0x108f)]))await _0x342df8[_0x5c4819(0x108f)][_0x5c4819(0xb8d)](_0xfdae0b[_0x5c4819(0x108f)]);if(Array[_0x5c4819(0x565)](_0xfdae0b[_0x5c4819(0x966)]))await _0x342df8[_0x5c4819(0x966)][_0x5c4819(0xb8d)](_0xfdae0b['memories']);if(Array[_0x5c4819(0x565)](_0xfdae0b[_0x5c4819(0xa1c)]))await _0x342df8[_0x5c4819(0xa1c)][_0x5c4819(0xb8d)](_0xfdae0b['worldBookCategories']);if(Array[_0x5c4819(0x565)](_0xfdae0b[_0x5c4819(0xf29)]))await _0x342df8[_0x5c4819(0xf29)][_0x5c4819(0xb8d)](_0xfdae0b[_0x5c4819(0xf29)]);if(Array[_0x5c4819(0x565)](_0xfdae0b[_0x5c4819(0xd18)]))await _0x342df8['shoppingProducts'][_0x5c4819(0xb8d)](_0xfdae0b[_0x5c4819(0xd18)]);if(Array[_0x5c4819(0x565)](_0xfdae0b[_0x5c4819(0xdb9)]))await _0x342df8[_0x5c4819(0xdb9)][_0x5c4819(0xb8d)](_0xfdae0b[_0x5c4819(0xdb9)]);if(Array[_0x5c4819(0x565)](_0xfdae0b[_0x5c4819(0x929)]))await _0x342df8[_0x5c4819(0x929)][_0x5c4819(0xb8d)](_0xfdae0b['renderingRules']);if(Array[_0x5c4819(0x565)](_0xfdae0b['doubanPosts']))await _0x342df8[_0x5c4819(0x1329)][_0x5c4819(0xb8d)](_0xfdae0b[_0x5c4819(0x1329)]);if(Array[_0x5c4819(0x565)](_0xfdae0b[_0x5c4819(0x72d)]))await _0x342df8[_0x5c4819(0x72d)][_0x5c4819(0xb8d)](_0xfdae0b['stickerCategories']);if(Array[_0x5c4819(0x565)](_0xfdae0b[_0x5c4819(0x1156)]))await _0x342df8[_0x5c4819(0x1156)][_0x5c4819(0xb8d)](_0xfdae0b[_0x5c4819(0x1156)]);if(Array[_0x5c4819(0x565)](_0xfdae0b[_0x5c4819(0x32f)]))await _0x342df8[_0x5c4819(0x32f)][_0x5c4819(0xb8d)](_0xfdae0b[_0x5c4819(0x32f)]);if(Array[_0x5c4819(0x565)](_0xfdae0b['presetCategories']))await _0x342df8[_0x5c4819(0xbea)][_0x5c4819(0xb8d)](_0xfdae0b['presetCategories']);if(Array[_0x5c4819(0x565)](_0xfdae0b['npcs']))await _0x342df8[_0x5c4819(0x656)][_0x5c4819(0xb8d)](_0xfdae0b['npcs']);});}catch(_0x3122c8){throw new Error(_0x4e77f0(0x138a)+_0x3122c8[_0x4e77f0(0x5f8)]);}}function _0x59518a(_0x5b8c24,_0x3695c9=![]){const _0x355cd3=_0x549949;if(!_0x5b8c24){_0x2883c6[_0x355cd3(0x45c)]='',document[_0x355cd3(0x383)](_0x355cd3(0xaee))[_0x355cd3(0x655)][_0x355cd3(0x12c7)]='';return;}const _0x5d178e=_0x355cd3(0x935),_0x230d8d=_0x355cd3(0x147)+_0x5d178e+_0x355cd3(0x911)+_0x5b8c24+_0x355cd3(0x7d7);if(_0x3695c9){const _0x3f1d2d=document[_0x355cd3(0x383)]('preview-font-style')||document[_0x355cd3(0xe1b)]('style');_0x3f1d2d['id']=_0x355cd3(0x2b1),_0x3f1d2d['innerHTML']=_0x230d8d;if(!document['getElementById'](_0x355cd3(0x2b1)))document[_0x355cd3(0x514)]['appendChild'](_0x3f1d2d);document[_0x355cd3(0x383)](_0x355cd3(0xaee))['style'][_0x355cd3(0x12c7)]='\x27'+_0x5d178e+'\x27,\x20\x27bulangni\x27,\x20sans-serif';}else _0x2883c6['innerHTML']=_0x355cd3(0xa30)+_0x230d8d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27'+_0x5d178e+_0x355cd3(0xc5b);}async function _0x6f8659(){const _0x16f47d=_0x549949;_0x2883c6[_0x16f47d(0x45c)]='',_0x41df36[_0x16f47d(0xc0)][_0x16f47d(0x1082)]='',await _0x342df8[_0x16f47d(0xc0)][_0x16f47d(0x9c0)](_0x41df36[_0x16f47d(0xc0)]),document[_0x16f47d(0x383)](_0x16f47d(0x132e))[_0x16f47d(0x1be)]='',document[_0x16f47d(0x383)](_0x16f47d(0xaee))['style'][_0x16f47d(0x12c7)]='',alert('已恢复默认字体。');}async function _0x28f04a(){const _0x4fe1af=_0x549949,[_0x5b5d89,_0x41fe79,_0x146600,_0x2471c9,_0x4190fd,_0x5cfc7c,_0x12c509,_0x595f9d,_0x31b5fe,_0x4c81ed,_0x19dcbc]=await Promise['all']([_0x342df8[_0x4fe1af(0x864)][_0x4fe1af(0x21f)](),_0x342df8[_0x4fe1af(0x673)][_0x4fe1af(0x1a3)](_0x4fe1af(0x10e3)),_0x342df8[_0x4fe1af(0xc0)][_0x4fe1af(0x1a3)](_0x4fe1af(0x10e3)),_0x342df8[_0x4fe1af(0x823)][_0x4fe1af(0x21f)](),_0x342df8[_0x4fe1af(0xf17)][_0x4fe1af(0x21f)](),_0x342df8['musicLibrary'][_0x4fe1af(0x1a3)](_0x4fe1af(0x10e3)),_0x342df8[_0x4fe1af(0x10e5)][_0x4fe1af(0x21f)](),_0x342df8[_0x4fe1af(0x571)][_0x4fe1af(0x1a3)](_0x4fe1af(0x10e3)),_0x342df8[_0x4fe1af(0x5c5)][_0x4fe1af(0x4b1)]('timestamp')[_0x4fe1af(0x1087)]()[_0x4fe1af(0x21f)](),_0x342df8['memories'][_0x4fe1af(0x21f)](),_0x342df8[_0x4fe1af(0x32f)][_0x4fe1af(0x21f)]()]);_0x41df36[_0x4fe1af(0x32f)]=_0x19dcbc||[];const _0x5ab2b1={'id':_0x4fe1af(0x10e3),'showStatusBar':![],'wallpaper':_0x4fe1af(0x109f),'fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0x4a76c3},'cphoneWallpaper':_0x4fe1af(0x917),'cphoneAppIcons':{..._0x2ed233},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x41df36[_0x4fe1af(0xc0)]={..._0x5ab2b1,..._0x146600||{}},_0x41df36['globalSettings'][_0x4fe1af(0x33f)]={..._0x5ab2b1[_0x4fe1af(0x33f)],..._0x41df36[_0x4fe1af(0xc0)][_0x4fe1af(0x33f)]||{}},_0x41df36[_0x4fe1af(0xc0)][_0x4fe1af(0x943)]={..._0x5ab2b1['cphoneAppIcons'],..._0x41df36['globalSettings'][_0x4fe1af(0x943)]||{}},_0x5b5d89[_0x4fe1af(0x19c)](_0x36f3d6=>{const _0x2fef10=_0x4fe1af;typeof _0x36f3d6[_0x2fef10(0x886)]['enableTimePerception']===_0x2fef10(0x89d)&&(_0x36f3d6[_0x2fef10(0x886)][_0x2fef10(0xfc8)]=!![]),!_0x36f3d6[_0x2fef10(0x886)][_0x2fef10(0xe11)]&&(_0x36f3d6['settings'][_0x2fef10(0xe11)]={'vertical':_0x2fef10(0x994),'horizontal':_0x2fef10(0x699),'offset':0xa}),!_0x36f3d6[_0x2fef10(0x1a2)]&&!_0x36f3d6['settings'][_0x2fef10(0xa7)]&&(_0x36f3d6[_0x2fef10(0x886)][_0x2fef10(0xa7)]=[]),!_0x36f3d6[_0x2fef10(0x1a2)]&&typeof _0x36f3d6[_0x2fef10(0x283)]==='undefined'&&(_0x36f3d6['originalName']=_0x36f3d6[_0x2fef10(0x461)]);}),_0x41df36[_0x4fe1af(0x864)]=_0x5b5d89[_0x4fe1af(0xf60)]((_0xfbecce,_0x1d1510)=>{const _0x31efe6=_0x4fe1af;if(typeof _0x1d1510[_0x31efe6(0x40c)]==='undefined')_0x1d1510[_0x31efe6(0x40c)]=0x0;_0x1d1510['isGroup']&&(typeof _0x1d1510[_0x31efe6(0x886)]['enableBackgroundActivity']===_0x31efe6(0x89d)&&(_0x1d1510[_0x31efe6(0x886)][_0x31efe6(0x8d5)]=!![]),_0x1d1510[_0x31efe6(0x12a6)]&&_0x1d1510[_0x31efe6(0x12a6)][_0x31efe6(0xfde)]>0x0&&_0x1d1510[_0x31efe6(0x12a6)][0x0]['name']&&_0x1d1510['members'][_0x31efe6(0x19c)](_0x3576b4=>{const _0x510dcb=_0x31efe6;typeof _0x3576b4['originalName']==='undefined'&&(_0x3576b4['originalName']=_0x3576b4[_0x510dcb(0x461)],_0x3576b4[_0x510dcb(0x9da)]=_0x3576b4[_0x510dcb(0x461)],delete _0x3576b4[_0x510dcb(0x461)]);}));if(!_0x1d1510[_0x31efe6(0x886)])_0x1d1510[_0x31efe6(0x886)]={};typeof _0x1d1510['settings'][_0x31efe6(0xf9c)]===_0x31efe6(0x89d)&&(_0x1d1510[_0x31efe6(0x886)][_0x31efe6(0xf9c)]=0xa);if(!_0x1d1510['isGroup']&&!_0x1d1510[_0x31efe6(0x1fe)])_0x1d1510[_0x31efe6(0x1fe)]={'text':'在线','lastUpdate':Date[_0x31efe6(0x108d)](),'isBusy':![]};if(!_0x1d1510[_0x31efe6(0x1a2)]&&!_0x1d1510[_0x31efe6(0x112b)])_0x1d1510[_0x31efe6(0x112b)]={'status':_0x31efe6(0x757),'blockedTimestamp':null,'applicationReason':''};if(!_0x1d1510[_0x31efe6(0x1a2)]&&(!_0x1d1510[_0x31efe6(0x886)]||!_0x1d1510[_0x31efe6(0x886)][_0x31efe6(0x7fa)])){if(!_0x1d1510['settings'])_0x1d1510[_0x31efe6(0x886)]={};_0x1d1510['settings']['aiAvatarLibrary']=[];}_0x1d1510[_0x31efe6(0x1a2)]&&(_0x1d1510[_0x31efe6(0x12a6)]||[])[_0x31efe6(0x19c)](_0x52c3a2=>{const _0xc6f7ed=_0x31efe6;if(typeof _0x52c3a2[_0xc6f7ed(0xefe)]===_0xc6f7ed(0x89d))_0x52c3a2[_0xc6f7ed(0xefe)]='';});if(!_0x1d1510['musicData'])_0x1d1510[_0x31efe6(0x47a)]={'totalTime':0x0};_0x1d1510[_0x31efe6(0x886)]&&_0x1d1510['settings'][_0x31efe6(0x624)]&&!_0x1d1510['settings'][_0x31efe6(0xe8c)]&&(_0x1d1510[_0x31efe6(0x886)][_0x31efe6(0xe8c)]=[_0x1d1510[_0x31efe6(0x886)][_0x31efe6(0x624)]],delete _0x1d1510['settings'][_0x31efe6(0x624)]);if(typeof _0x1d1510['isPinned']==='undefined')_0x1d1510[_0x31efe6(0x521)]=![];!_0x1d1510[_0x31efe6(0x1a2)]&&typeof _0x1d1510['settings'][_0x31efe6(0x52e)]==='undefined'&&(_0x1d1510[_0x31efe6(0x886)][_0x31efe6(0x52e)]='我');if(_0x1d1510[_0x31efe6(0x1a2)]&&_0x1d1510[_0x31efe6(0x12a6)]){let _0x3bdc=![];_0x5b5d89[_0x31efe6(0x19c)](_0xbc2e2=>{const _0x5c2255=_0x31efe6;_0xbc2e2['id']===_0x1d1510['id']&&_0xbc2e2[_0x5c2255(0x283)]&&delete _0xbc2e2['originalName'];}),_0x1d1510[_0x31efe6(0x12a6)][_0x31efe6(0x19c)](_0x51ae44=>{const _0x249ba2=_0x31efe6,_0x71e585=_0x5b5d89[_0x249ba2(0xd12)](_0x2796f1=>_0x2796f1['id']===_0x51ae44['id']);if(_0x71e585&&_0x71e585[_0x249ba2(0x886)]){const _0x52e0bd=_0x71e585[_0x249ba2(0x886)]['aiAvatarFrame']||'';_0x51ae44[_0x249ba2(0xefe)]!==_0x52e0bd&&(_0x51ae44['avatarFrame']=_0x52e0bd,_0x3bdc=!![]);}else typeof _0x51ae44['avatarFrame']==='undefined'&&(_0x51ae44[_0x249ba2(0xefe)]='',_0x3bdc=!![]);});if(_0x3bdc)_0x342df8[_0x31efe6(0x864)][_0x31efe6(0x9c0)](_0x1d1510);}if(!_0x1d1510[_0x31efe6(0x886)][_0x31efe6(0xd3)])_0x1d1510[_0x31efe6(0x886)]['enableAutoMemory']=![];if(!_0x1d1510[_0x31efe6(0x886)][_0x31efe6(0x9d5)])_0x1d1510[_0x31efe6(0x886)]['autoMemoryInterval']=0x14;if(!_0x1d1510[_0x31efe6(0x1349)])_0x1d1510[_0x31efe6(0x1349)]=[];if(!_0x1d1510[_0x31efe6(0x6fb)])_0x1d1510['lastMemorySummaryTimestamp']=0x0;if(!_0x1d1510[_0x31efe6(0x1a2)]){typeof _0x1d1510[_0x31efe6(0x886)][_0x31efe6(0x8d5)]===_0x31efe6(0x89d)&&(_0x1d1510[_0x31efe6(0x886)][_0x31efe6(0x8d5)]=!![]);typeof _0x1d1510['settings']['enableTts']==='undefined'&&(_0x1d1510[_0x31efe6(0x886)][_0x31efe6(0xa7f)]=![]);if(!_0x1d1510['status'])_0x1d1510[_0x31efe6(0x1fe)]={'text':'在线','lastUpdate':Date[_0x31efe6(0x108d)](),'isBusy':![]};if(!_0x1d1510['relationship'])_0x1d1510[_0x31efe6(0x112b)]={'status':'friend','blockedTimestamp':null,'applicationReason':''};if(!_0x1d1510[_0x31efe6(0x886)]||!_0x1d1510[_0x31efe6(0x886)]['aiAvatarLibrary']){if(!_0x1d1510[_0x31efe6(0x886)])_0x1d1510['settings']={};_0x1d1510['settings'][_0x31efe6(0x7fa)]=[];}if(typeof _0x1d1510['settings'][_0x31efe6(0xf49)]===_0x31efe6(0x89d))_0x1d1510[_0x31efe6(0x886)][_0x31efe6(0xf49)]=![];if(typeof _0x1d1510['settings']['offlineMinLength']===_0x31efe6(0x89d))_0x1d1510['settings'][_0x31efe6(0x58f)]=0x64;if(typeof _0x1d1510[_0x31efe6(0x886)][_0x31efe6(0xe67)]==='undefined')_0x1d1510['settings'][_0x31efe6(0xe67)]=0x12c;typeof _0x1d1510[_0x31efe6(0x886)][_0x31efe6(0x1380)]===_0x31efe6(0x89d)&&(_0x1d1510['settings'][_0x31efe6(0x1380)]=![]);if(typeof _0x1d1510['heartfeltVoice']===_0x31efe6(0x89d))_0x1d1510[_0x31efe6(0xa52)]=_0x31efe6(0x1026);if(typeof _0x1d1510['randomJottings']===_0x31efe6(0x89d))_0x1d1510['randomJottings']=_0x31efe6(0x1026);!Array['isArray'](_0x1d1510['thoughtsHistory'])&&(_0x1d1510['thoughtsHistory']=[]);}return typeof _0x1d1510[_0x31efe6(0x886)][_0x31efe6(0x121a)]===_0x31efe6(0x89d)&&(_0x1d1510['settings'][_0x31efe6(0xab3)]?_0x1d1510['settings'][_0x31efe6(0x121a)]=[_0x1d1510['settings'][_0x31efe6(0xab3)]]:_0x1d1510[_0x31efe6(0x886)][_0x31efe6(0x121a)]=[],delete _0x1d1510['settings']['stickerCategoryId']),_0xfbecce[_0x1d1510['id']]=_0x1d1510,_0xfbecce;},{});const _0x551db8=[];_0x4c81ed['forEach'](_0x2adc14=>{const _0x1af1da=_0x4fe1af;if(_0x2adc14[_0x1af1da(0xa6b)]===_0x1af1da(0x1150)&&_0x2adc14[_0x1af1da(0x1253)]&&!_0x2adc14[_0x1af1da(0x1301)]){const _0x23123a=_0x5b5d89[_0x1af1da(0xd12)](_0x21a739=>!_0x21a739['isGroup']&&_0x21a739[_0x1af1da(0x283)]===_0x2adc14['authorName']);if(_0x23123a)_0x2adc14[_0x1af1da(0x1301)]=_0x23123a['id'],_0x551db8['push'](_0x2adc14);else{const _0x203607=_0x5b5d89[_0x1af1da(0xd12)](_0x248f7b=>!_0x248f7b[_0x1af1da(0x1a2)]&&_0x248f7b[_0x1af1da(0x461)]===_0x2adc14[_0x1af1da(0x1253)]);_0x203607&&(_0x2adc14[_0x1af1da(0x1301)]=_0x203607['id'],_0x551db8[_0x1af1da(0x258)](_0x2adc14));}}}),_0x551db8[_0x4fe1af(0xfde)]>0x0&&await _0x342df8[_0x4fe1af(0x966)][_0x4fe1af(0xb8d)](_0x551db8),_0x41df36[_0x4fe1af(0x673)]=_0x41fe79||{'id':_0x4fe1af(0x10e3),'proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':_0x4fe1af(0xf82)},_0x41df36[_0x4fe1af(0x823)]=_0x2471c9||[],_0x41df36[_0x4fe1af(0xf17)]=_0x4190fd||[],_0x40e606[_0x4fe1af(0x91b)]=_0x5cfc7c?.[_0x4fe1af(0x91b)]||[],_0x41df36[_0x4fe1af(0x10e5)]=_0x12c509||[],_0x41df36['qzoneSettings']=_0x595f9d||{'id':_0x4fe1af(0x10e3),'nickname':_0x4fe1af(0x7da),'avatar':_0x4fe1af(0xc20),'banner':'https://files.catbox.moe/r5heyt.gif'},allFavoriteItems=_0x31b5fe||[];}async function _0x534851(){const _0x251de7=_0x549949;await _0x342df8[_0x251de7(0xcbf)][_0x251de7(0x9c0)]({'id':_0x251de7(0x10e3),'playlist':_0x40e606['playlist']});}function _0x3f0b6d(_0x512154){const _0x1ed688=_0x549949;if(!_0x512154)return'';const _0x51701e=new Date(_0x512154),_0xdef530=String(_0x51701e[_0x1ed688(0x793)]())[_0x1ed688(0xf20)](0x2,'0'),_0x528cd0=String(_0x51701e[_0x1ed688(0xa28)]())[_0x1ed688(0xf20)](0x2,'0');return _0xdef530+':'+_0x528cd0;}function _0xa3fdac(_0x2d0afc){const _0x500349=_0x549949,_0x69331=Date[_0x500349(0x108d)](),_0x126b23=Math[_0x500349(0xdee)]((_0x69331-_0x2d0afc)/0x3e8);if(_0x126b23<0x3c)return'刚刚';const _0x44f068=Math['floor'](_0x126b23/0x3c);if(_0x44f068<0x3c)return _0x44f068+_0x500349(0x7eb);const _0x1fc60d=Math['floor'](_0x44f068/0x3c);if(_0x1fc60d<0x18)return _0x1fc60d+'小时前';const _0x2d4b17=Math['floor'](_0x1fc60d/0x18);if(_0x2d4b17<0x1e)return _0x2d4b17+'天前';const _0x5d3a1f=Math[_0x500349(0xdee)](_0x2d4b17/0x1e);if(_0x5d3a1f<0xc)return'大约'+_0x5d3a1f+_0x500349(0xa08);const _0x49a4bb=Math[_0x500349(0xdee)](_0x2d4b17/0x16d);return'大约'+_0x49a4bb+'年前';}function _0x2235d5(_0x512c8c){const _0x4a93f7=_0x549949;if(!_0x512c8c)return'';const _0x37ec88=new Date(),_0x11b5ee=new Date(_0x512c8c),_0x299afd=String(_0x11b5ee['getHours']())[_0x4a93f7(0xf20)](0x2,'0'),_0xcf0e1e=String(_0x11b5ee['getMinutes']())['padStart'](0x2,'0'),_0x29c3b3=_0x299afd+':'+_0xcf0e1e;if(_0x37ec88['toDateString']()===_0x11b5ee[_0x4a93f7(0x37f)]())return _0x4a93f7(0x7d9)+_0x29c3b3;const _0xc094af=new Date();_0xc094af[_0x4a93f7(0x276)](_0x37ec88[_0x4a93f7(0xb29)]()-0x1);if(_0xc094af[_0x4a93f7(0x37f)]()===_0x11b5ee[_0x4a93f7(0x37f)]())return _0x4a93f7(0x39f)+_0x29c3b3;if(_0x37ec88[_0x4a93f7(0xdf9)]()===_0x11b5ee[_0x4a93f7(0xdf9)]()){const _0xcb5f49=String(_0x11b5ee[_0x4a93f7(0xf4f)]()+0x1),_0x157aff=String(_0x11b5ee[_0x4a93f7(0xb29)]());return _0xcb5f49+'月'+_0x157aff+'日\x20'+_0x29c3b3;}const _0xf45f65=_0x11b5ee['getFullYear'](),_0xce88a3=String(_0x11b5ee[_0x4a93f7(0xf4f)]()+0x1),_0x49f383=String(_0x11b5ee['getDate']());return _0xf45f65+'年'+_0xce88a3+'月'+_0x49f383+'日\x20'+_0x29c3b3;}function _0x257943(){const _0x18f62c=_0x549949,_0xb658fa=_0x4eb791();document['getElementById']('nai-resolution')['value']=_0xb658fa[_0x18f62c(0x657)],document[_0x18f62c(0x383)](_0x18f62c(0x1b4))[_0x18f62c(0x1be)]=_0xb658fa[_0x18f62c(0x300)],document[_0x18f62c(0x383)](_0x18f62c(0xd57))['value']=_0xb658fa[_0x18f62c(0x78d)],document[_0x18f62c(0x383)]('nai-sampler')[_0x18f62c(0x1be)]=_0xb658fa[_0x18f62c(0xb4b)],document[_0x18f62c(0x383)](_0x18f62c(0xd1e))[_0x18f62c(0x1be)]=_0xb658fa[_0x18f62c(0x105f)],document[_0x18f62c(0x383)](_0x18f62c(0x3c6))[_0x18f62c(0x1be)]=_0xb658fa['uc_preset'],document[_0x18f62c(0x383)](_0x18f62c(0xa1a))[_0x18f62c(0x2a3)]=_0xb658fa[_0x18f62c(0x102a)],document['getElementById'](_0x18f62c(0x1133))[_0x18f62c(0x2a3)]=_0xb658fa[_0x18f62c(0xc76)],document[_0x18f62c(0x383)](_0x18f62c(0x1d9))[_0x18f62c(0x2a3)]=_0xb658fa['smea_dyn'],document['getElementById'](_0x18f62c(0x12ee))[_0x18f62c(0x1be)]=_0xb658fa[_0x18f62c(0x1f8)],document['getElementById']('nai-default-negative')[_0x18f62c(0x1be)]=_0xb658fa[_0x18f62c(0x60a)],document['getElementById'](_0x18f62c(0x4b2))['value']=_0xb658fa['cors_proxy'],document[_0x18f62c(0x383)]('nai-custom-proxy-url')[_0x18f62c(0x1be)]=_0xb658fa[_0x18f62c(0x590)]||'';const _0x4a24d8=document[_0x18f62c(0x383)](_0x18f62c(0xae5));_0x4a24d8[_0x18f62c(0x655)][_0x18f62c(0x2b6)]=_0xb658fa[_0x18f62c(0x10c9)]===_0x18f62c(0x4fe)?_0x18f62c(0x27a):_0x18f62c(0xa70);}function _0x403e88(){const _0x238d21=_0x549949,_0x46acf2=document[_0x238d21(0x383)](_0x238d21(0x6bc))[_0x238d21(0x2a3)],_0x39610b=document[_0x238d21(0x383)](_0x238d21(0x1d4))[_0x238d21(0x1be)],_0x4fab3b=document['getElementById'](_0x238d21(0x20a))[_0x238d21(0x1be)][_0x238d21(0x1cb)]();localStorage[_0x238d21(0x16a)]('novelai-enabled',_0x46acf2),localStorage[_0x238d21(0x16a)](_0x238d21(0x1d4),_0x39610b),localStorage['setItem'](_0x238d21(0x20a),_0x4fab3b);const _0x403426={'resolution':document[_0x238d21(0x383)](_0x238d21(0xc6b))[_0x238d21(0x1be)],'steps':parseInt(document[_0x238d21(0x383)]('nai-steps')[_0x238d21(0x1be)]),'cfg_scale':parseFloat(document[_0x238d21(0x383)](_0x238d21(0xd57))[_0x238d21(0x1be)]),'sampler':document[_0x238d21(0x383)](_0x238d21(0x124c))['value'],'seed':parseInt(document['getElementById']('nai-seed')[_0x238d21(0x1be)]),'uc_preset':parseInt(document['getElementById'](_0x238d21(0x3c6))['value']),'quality_toggle':document[_0x238d21(0x383)](_0x238d21(0xa1a))[_0x238d21(0x2a3)],'smea':document[_0x238d21(0x383)](_0x238d21(0x1133))[_0x238d21(0x2a3)],'smea_dyn':document[_0x238d21(0x383)](_0x238d21(0x1d9))[_0x238d21(0x2a3)],'default_positive':document[_0x238d21(0x383)]('nai-default-positive')[_0x238d21(0x1be)],'default_negative':document[_0x238d21(0x383)]('nai-default-negative')['value'],'cors_proxy':document['getElementById']('nai-cors-proxy')[_0x238d21(0x1be)],'custom_proxy_url':document['getElementById']('nai-custom-proxy-url')[_0x238d21(0x1be)]};localStorage[_0x238d21(0x16a)](_0x238d21(0x1363),JSON[_0x238d21(0x3fb)](_0x403426));}function _0x3b8d28(){const _0x1945d7=_0x549949;localStorage[_0x1945d7(0x32c)](_0x1945d7(0x1363)),_0x257943(),alert(_0x1945d7(0xcfc));}function _0x4eb791(){const _0x38e9e7=_0x549949,_0x275dc0={'resolution':_0x38e9e7(0xbde),'steps':0x1c,'cfg_scale':0x5,'sampler':_0x38e9e7(0x142),'seed':-0x1,'uc_preset':0x1,'quality_toggle':!![],'smea':!![],'smea_dyn':![],'default_positive':_0x38e9e7(0x44b),'default_negative':_0x38e9e7(0xf14),'cors_proxy':_0x38e9e7(0x9d),'custom_proxy_url':''},_0x134f32=localStorage[_0x38e9e7(0xb2)](_0x38e9e7(0x1363));if(_0x134f32)try{return{..._0x275dc0,...JSON[_0x38e9e7(0x134)](_0x134f32)};}catch(_0x4aa9d5){return _0x275dc0;}return _0x275dc0;}function _0x51675f(_0x4ed8d8){const _0x34d7e2=_0x549949,_0x188e84=_0x4eb791();if(!_0x4ed8d8||!_0x41df36[_0x34d7e2(0x864)][_0x4ed8d8])return console[_0x34d7e2(0xe72)]('⚠️\x20NAI提示词：没有角色，使用系统配置'),{'positive':_0x188e84[_0x34d7e2(0x1f8)],'negative':_0x188e84[_0x34d7e2(0x60a)],'source':'system'};const _0x363373=_0x41df36['chats'][_0x4ed8d8],_0x43cf52=_0x363373[_0x34d7e2(0x886)][_0x34d7e2(0x1236)]||{};return _0x43cf52[_0x34d7e2(0x6c7)]==='character'?(console[_0x34d7e2(0xe72)]('✅\x20NAI提示词：使用角色配置'),console['log']('\x20\x20\x20正面:',_0x43cf52['characterPositivePrompt']||_0x34d7e2(0x116e)),console[_0x34d7e2(0xe72)](_0x34d7e2(0x637),_0x43cf52[_0x34d7e2(0x557)]||_0x34d7e2(0x116e)),{'positive':_0x43cf52['characterPositivePrompt']||'','negative':_0x43cf52['characterNegativePrompt']||'','source':_0x34d7e2(0xa0)}):(console[_0x34d7e2(0xe72)](_0x34d7e2(0x6e5)),console[_0x34d7e2(0xe72)](_0x34d7e2(0x3d6),_0x188e84[_0x34d7e2(0x1f8)]||_0x34d7e2(0x116e)),console['log'](_0x34d7e2(0x637),_0x188e84[_0x34d7e2(0x60a)]||_0x34d7e2(0x116e)),{'positive':_0x188e84[_0x34d7e2(0x1f8)],'negative':_0x188e84['default_negative'],'source':_0x34d7e2(0xb1)});}async function _0x17d555(){const _0x41c615=_0x549949,_0x45102b=document['getElementById'](_0x41c615(0x20a))[_0x41c615(0x1be)][_0x41c615(0x1cb)](),_0x44a8f8=document[_0x41c615(0x383)]('novelai-model')['value'],_0x4b881b=document[_0x41c615(0x383)](_0x41c615(0x93))[_0x41c615(0x1be)][_0x41c615(0x1cb)]();if(!_0x45102b){alert(_0x41c615(0x1313));return;}if(!_0x4b881b){alert(_0x41c615(0xdd5));return;}const _0x4b6608=_0x4eb791(),_0x311b83=document[_0x41c615(0x383)](_0x41c615(0x124b))[_0x41c615(0x1be)][_0x41c615(0x1cb)](),_0x44b5b5=document[_0x41c615(0x383)](_0x41c615(0xbd3)),_0x4fc2f9=document[_0x41c615(0x383)](_0x41c615(0x7b9)),_0x1d3e7d=document[_0x41c615(0x383)](_0x41c615(0x134d)),_0x53b85f=document['getElementById'](_0x41c615(0xef3));_0x44b5b5[_0x41c615(0x655)]['display']=_0x41c615(0x27a),_0x4fc2f9[_0x41c615(0x655)][_0x41c615(0x2b6)]=_0x41c615(0xa70),_0x1d3e7d[_0x41c615(0x655)][_0x41c615(0x2b6)]=_0x41c615(0xa70),_0x53b85f[_0x41c615(0x29b)]=!![],_0x53b85f[_0x41c615(0x138e)]=_0x41c615(0xb34);try{const [_0x187a92,_0x1501d2]=_0x4b6608[_0x41c615(0x657)][_0x41c615(0x105d)]('x')[_0x41c615(0xa79)](Number);let _0x4470c5;_0x44a8f8['includes'](_0x41c615(0xffe))?_0x4470c5={'input':_0x4b881b,'model':_0x44a8f8,'action':'generate','parameters':{'params_version':0x3,'width':_0x187a92,'height':_0x1501d2,'scale':_0x4b6608[_0x41c615(0x78d)],'sampler':_0x4b6608['sampler'],'steps':_0x4b6608[_0x41c615(0x300)],'seed':_0x4b6608[_0x41c615(0x105f)]===-0x1?Math[_0x41c615(0xdee)](Math[_0x41c615(0x5ce)]()*0x2540be3ff):_0x4b6608[_0x41c615(0x105f)],'n_samples':0x1,'ucPreset':_0x4b6608['uc_preset'],'qualityToggle':_0x4b6608[_0x41c615(0x102a)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x41c615(0xab1),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x4b881b,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x311b83,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x311b83,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x4470c5={'input':_0x4b881b,'model':_0x44a8f8,'action':_0x41c615(0x408),'parameters':{'width':_0x187a92,'height':_0x1501d2,'scale':_0x4b6608[_0x41c615(0x78d)],'sampler':_0x4b6608[_0x41c615(0xb4b)],'steps':_0x4b6608[_0x41c615(0x300)],'seed':_0x4b6608[_0x41c615(0x105f)]===-0x1?Math['floor'](Math[_0x41c615(0x5ce)]()*0x2540be3ff):_0x4b6608[_0x41c615(0x105f)],'n_samples':0x1,'ucPreset':_0x4b6608['uc_preset'],'qualityToggle':_0x4b6608[_0x41c615(0x102a)],'sm':_0x4b6608[_0x41c615(0xc76)],'sm_dyn':_0x4b6608['smea_dyn'],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x41c615(0xa72),'negative_prompt':_0x311b83}};console[_0x41c615(0xe72)](_0x41c615(0x7b3)),console[_0x41c615(0xe72)](_0x41c615(0x3cf),_0x44a8f8),console['log'](_0x41c615(0x9c9),JSON['stringify'](_0x4470c5,null,0x2));let _0x4544ea;_0x44a8f8['includes']('nai-diffusion-4')?_0x4544ea=_0x41c615(0x10c4):_0x4544ea=_0x41c615(0x349);let _0x4da0ca=_0x4b6608[_0x41c615(0x10c9)];_0x4da0ca==='custom'&&(_0x4da0ca=_0x4b6608[_0x41c615(0x590)]||'');_0x4da0ca&&_0x4da0ca!==''&&(_0x4544ea=_0x4da0ca+encodeURIComponent(_0x4544ea));const _0x5eab54=/Chrome/['test'](navigator[_0x41c615(0x218)])&&!/Edg/[_0x41c615(0xd73)](navigator['userAgent']);let _0x193ac4={'method':'POST','headers':{'Content-Type':_0x41c615(0x11f0),'Authorization':'Bearer\x20'+_0x45102b},'body':JSON['stringify'](_0x4470c5)};if(_0x5eab54){console['log'](_0x41c615(0xe34));const _0x325509={};for(const [_0x35c9ff,_0x3e9089]of Object['entries'](_0x193ac4[_0x41c615(0xb60)])){_0x325509[_0x35c9ff]=_0x3e9089[_0x41c615(0x709)](/[^\x00-\xFF]/g,'');}_0x193ac4[_0x41c615(0xb60)]=_0x325509;}const _0x547157=await fetch(_0x4544ea,_0x193ac4);console['log'](_0x41c615(0x577),_0x547157['status']),console[_0x41c615(0xe72)](_0x41c615(0x73f),[..._0x547157[_0x41c615(0xb60)][_0x41c615(0x329)]()]);if(!_0x547157['ok']){const _0x18be1d=await _0x547157[_0x41c615(0x6af)]();console['error'](_0x41c615(0xb3f),_0x18be1d);throw new Error(_0x41c615(0x1205)+_0x547157[_0x41c615(0x1fe)]+_0x41c615(0x12a8)+_0x18be1d);}const _0x219db9=_0x547157[_0x41c615(0xb60)][_0x41c615(0x1a3)](_0x41c615(0x598));console[_0x41c615(0xe72)](_0x41c615(0x9ca),_0x219db9);let _0x113f31;if(_0x219db9&&_0x219db9[_0x41c615(0xee2)](_0x41c615(0x14e))){console[_0x41c615(0xe72)](_0x41c615(0xfa)),_0x44b5b5[_0x41c615(0x138e)]=_0x41c615(0x10c);const _0x1f3b12=await _0x547157[_0x41c615(0x6af)]();console[_0x41c615(0xe72)](_0x41c615(0x364),_0x1f3b12[_0x41c615(0xfde)]);const _0x3d4b19=_0x1f3b12[_0x41c615(0x1cb)]()['split']('\x0a');let _0xf0517e=null;for(let _0x4bec43=_0x3d4b19[_0x41c615(0xfde)]-0x1;_0x4bec43>=0x0;_0x4bec43--){const _0x106d53=_0x3d4b19[_0x4bec43][_0x41c615(0x1cb)]();if(_0x106d53[_0x41c615(0x1122)]('data:\x20')&&_0x106d53!==_0x41c615(0x28f)){const _0x3e158e=_0x106d53['substring'](0x6);try{const _0x1225ba=JSON[_0x41c615(0x134)](_0x3e158e);if(_0x1225ba[_0x41c615(0xacb)]===_0x41c615(0xdae)&&_0x1225ba[_0x41c615(0x482)]){_0xf0517e=_0x1225ba[_0x41c615(0x482)],console[_0x41c615(0xe72)](_0x41c615(0x5ee));break;}if(_0x1225ba['data']){_0xf0517e=_0x1225ba[_0x41c615(0x8c6)],console[_0x41c615(0xe72)](_0x41c615(0x43e));break;}if(_0x1225ba[_0x41c615(0x482)]){_0xf0517e=_0x1225ba['image'],console[_0x41c615(0xe72)](_0x41c615(0x2b9));break;}}catch(_0x1c56a3){_0xf0517e=_0x3e158e,console[_0x41c615(0xe72)](_0x41c615(0xa92));break;}}}if(!_0xf0517e)throw new Error(_0x41c615(0x10dd));const _0x4285ba=_0xf0517e['startsWith'](_0x41c615(0x9c4)),_0x177c4a=_0xf0517e[_0x41c615(0x1122)](_0x41c615(0x1141));if(_0x4285ba||_0x177c4a){console['log'](_0x41c615(0xa42));const _0x51dbe7=atob(_0xf0517e),_0x4c9387=new Uint8Array(_0x51dbe7[_0x41c615(0xfde)]);for(let _0x5db87b=0x0;_0x5db87b<_0x51dbe7[_0x41c615(0xfde)];_0x5db87b++){_0x4c9387[_0x5db87b]=_0x51dbe7[_0x41c615(0x274)](_0x5db87b);}const _0x5828fc=new Blob([_0x4c9387],{'type':_0x4285ba?_0x41c615(0x7bd):_0x41c615(0x3f3)});console[_0x41c615(0xe72)]('图片\x20Blob\x20创建成功，大小:',_0x5828fc[_0x41c615(0x1240)]);const _0x12bfb5=URL[_0x41c615(0x679)](_0x5828fc);document[_0x41c615(0x383)]('nai-result-image')[_0x41c615(0xf6c)]=_0x12bfb5,_0x44b5b5[_0x41c615(0x655)][_0x41c615(0x2b6)]=_0x41c615(0xa70),_0x4fc2f9[_0x41c615(0x655)][_0x41c615(0x2b6)]='block',console['log']('✅\x20图片显示成功！🎨');return;}console[_0x41c615(0xe72)]('当作\x20ZIP\x20文件处理...');const _0x1ef98f=atob(_0xf0517e),_0x3ff1da=new Uint8Array(_0x1ef98f[_0x41c615(0xfde)]);for(let _0x5c6bfc=0x0;_0x5c6bfc<_0x1ef98f[_0x41c615(0xfde)];_0x5c6bfc++){_0x3ff1da[_0x5c6bfc]=_0x1ef98f['charCodeAt'](_0x5c6bfc);}_0x113f31=new Blob([_0x3ff1da]),console['log']('ZIP\x20Blob\x20大小:',_0x113f31[_0x41c615(0x1240)]);}else _0x113f31=await _0x547157[_0x41c615(0x800)](),console['log'](_0x41c615(0x11cc),_0x113f31['type'],'大小:',_0x113f31['size']);try{if(typeof JSZip===_0x41c615(0x89d))throw new Error('JSZip库未加载，请刷新页面重试');_0x44b5b5['textContent']='正在解压图片...';const _0x4329e8=await JSZip[_0x41c615(0x12a0)](_0x113f31);console[_0x41c615(0xe72)](_0x41c615(0x12f),Object['keys'](_0x4329e8[_0x41c615(0x1185)]));let _0x8b05cd=null;for(let _0x242fb2 in _0x4329e8[_0x41c615(0x1185)]){if(_0x242fb2[_0x41c615(0x22e)](/\.(png|jpg|jpeg|webp)$/i)){_0x8b05cd=_0x4329e8['files'][_0x242fb2],console[_0x41c615(0xe72)]('找到图片文件:',_0x242fb2);break;}}if(!_0x8b05cd)throw new Error(_0x41c615(0x11a8));const _0x3e9e7a=await _0x8b05cd[_0x41c615(0x42c)](_0x41c615(0x800));console['log']('提取的图片大小:',_0x3e9e7a[_0x41c615(0x1240)]);const _0x4a1170=URL[_0x41c615(0x679)](_0x3e9e7a);console[_0x41c615(0xe72)](_0x41c615(0xa7d),_0x4a1170),document['getElementById']('nai-result-image')[_0x41c615(0xf6c)]=_0x4a1170,_0x44b5b5[_0x41c615(0x655)][_0x41c615(0x2b6)]='none',_0x4fc2f9[_0x41c615(0x655)]['display']=_0x41c615(0x27a);}catch(_0x323c77){console[_0x41c615(0x98)](_0x41c615(0xa2),_0x323c77),console[_0x41c615(0xe72)](_0x41c615(0x2d4));if(_0x113f31['type'][_0x41c615(0x1122)](_0x41c615(0x273))){const _0x4c65ab=URL[_0x41c615(0x679)](_0x113f31);document[_0x41c615(0x383)](_0x41c615(0x12f5))[_0x41c615(0xf6c)]=_0x4c65ab,_0x44b5b5['style'][_0x41c615(0x2b6)]=_0x41c615(0xa70),_0x4fc2f9[_0x41c615(0x655)][_0x41c615(0x2b6)]=_0x41c615(0x27a);}else throw new Error(_0x41c615(0x489)+_0x323c77[_0x41c615(0x5f8)]);}}catch(_0x520b31){console[_0x41c615(0x98)]('NovelAI生成失败:',_0x520b31),_0x44b5b5[_0x41c615(0x655)][_0x41c615(0x2b6)]=_0x41c615(0xa70),_0x1d3e7d[_0x41c615(0x655)][_0x41c615(0x2b6)]=_0x41c615(0x27a),_0x1d3e7d[_0x41c615(0x138e)]='生成失败:\x20'+_0x520b31[_0x41c615(0x5f8)];}finally{_0x53b85f[_0x41c615(0x29b)]=![],_0x53b85f[_0x41c615(0x138e)]='生成图像';}}function _0x193863(_0x26aa2a,_0x302d57){const _0xbbc0b0=_0x549949;_0x1d7250(),clearTimeout(_0x5309e6);const _0x359aa5=_0x41df36[_0xbbc0b0(0x864)][_0x26aa2a];if(!_0x359aa5)return;const _0x3d27d1=document[_0xbbc0b0(0x383)](_0xbbc0b0(0xc0d));document[_0xbbc0b0(0x383)](_0xbbc0b0(0xfda))[_0xbbc0b0(0xf6c)]=_0x359aa5[_0xbbc0b0(0x886)][_0xbbc0b0(0x121e)]||_0x359aa5[_0xbbc0b0(0x886)][_0xbbc0b0(0x332)]||_0x5dc108,document[_0xbbc0b0(0x383)](_0xbbc0b0(0x499))[_0xbbc0b0(0x89c)](_0xbbc0b0(0x835))['textContent']=_0x359aa5[_0xbbc0b0(0x461)],document['getElementById'](_0xbbc0b0(0x499))[_0xbbc0b0(0x89c)](_0xbbc0b0(0x551))[_0xbbc0b0(0x138e)]=_0x302d57,_0x3d27d1[_0xbbc0b0(0x119a)][_0xbbc0b0(0x131d)](_0xbbc0b0(0x106d)),void _0x3d27d1[_0xbbc0b0(0x5f9)],_0x3d27d1[_0xbbc0b0(0x119a)][_0xbbc0b0(0xbff)](_0xbbc0b0(0x106d));const _0x1e83c6=_0x3d27d1['cloneNode'](!![]);_0x3d27d1[_0xbbc0b0(0x1245)][_0xbbc0b0(0xe58)](_0x1e83c6,_0x3d27d1),_0x1e83c6['addEventListener'](_0xbbc0b0(0x5c7),()=>{const _0x914dca=_0xbbc0b0;_0x4a08c7(_0x26aa2a),_0x1e83c6['classList'][_0x914dca(0x131d)](_0x914dca(0x106d));}),_0x5309e6=setTimeout(()=>{const _0x4a209c=_0xbbc0b0;_0x1e83c6[_0x4a209c(0x119a)][_0x4a209c(0x131d)](_0x4a209c(0x106d));},0xfa0),_0x44666e();}function _0x66af34(){const _0x84577e=_0x549949,_0x2a63ad=new Date(),_0x43982e=_0x2a63ad[_0x84577e(0x1366)](_0x84577e(0xafb),{'hour':'2-digit','minute':_0x84577e(0x9bf)}),_0xe74529=_0x2a63ad['toLocaleDateString']('zh-CN',{'weekday':'long','month':_0x84577e(0xd8e),'day':_0x84577e(0x12ec)});document[_0x84577e(0x383)](_0x84577e(0x231))[_0x84577e(0x138e)]=_0x43982e;}function _0x28b8fa(_0x53d590){const _0x4227b5=_0x549949,_0x304604=_0x53d590[_0x4227b5(0x1cb)]();if(_0x304604[_0x4227b5(0x1122)]('[')&&_0x304604['endsWith'](']'))try{const _0x40b727=JSON['parse'](_0x304604);if(Array[_0x4227b5(0x565)](_0x40b727))return console[_0x4227b5(0xe72)](_0x4227b5(0x297)),_0x40b727;}catch(_0x36da3b){console[_0x4227b5(0x17b)](_0x4227b5(0x399));}const _0x149925=_0x304604[_0x4227b5(0x22e)](/{[^{}]*}/g);if(_0x149925){const _0x1bd051=[];for(const _0x1487e2 of _0x149925){try{const _0x4a7e70=JSON['parse'](_0x1487e2);_0x1bd051[_0x4227b5(0x258)](_0x4a7e70);}catch(_0x50b44c){console[_0x4227b5(0x17b)]('跳过一个无效的JSON片段:',_0x1487e2);}}if(_0x1bd051['length']>0x0)return console[_0x4227b5(0xe72)](_0x4227b5(0x4e0)),_0x1bd051;}return console[_0x4227b5(0x98)](_0x4227b5(0xc87)),[{'type':_0x4227b5(0x6af),'content':_0x53d590}];}function _0x1ccf3f(_0x3bac02=new Date()){const _0x1c9324=_0x3bac02['getHours']();if(_0x1c9324>=0x0&&_0x1c9324<0x5)return'凌晨';else{if(_0x1c9324>=0x5&&_0x1c9324<0x9)return'早上';else{if(_0x1c9324>=0x9&&_0x1c9324<0xd)return'上午';else{if(_0x1c9324>=0xd&&_0x1c9324<0x12)return'下午';else{if(_0x1c9324>=0x12&&_0x1c9324<0x18)return'晚上';}}}}return'现在';}async function _0x4b3784(){const _0x57289f=_0x549949,_0x55bb03=document[_0x57289f(0x383)](_0x57289f(0x892));_0x55bb03[_0x57289f(0x45c)]=_0x57289f(0xc9d);const _0x41daac=await _0x342df8[_0x57289f(0xf29)][_0x57289f(0x21f)]();_0x41daac['forEach'](_0x580712=>{const _0x2dca0a=_0x57289f,_0x4ed21b=document[_0x2dca0a(0xe1b)](_0x2dca0a(0x10a0));_0x4ed21b['value']=_0x580712['id'],_0x4ed21b[_0x2dca0a(0x138e)]=_0x580712[_0x2dca0a(0x461)],_0x55bb03[_0x2dca0a(0xe91)](_0x4ed21b);});const _0x415772=_0x41df36['apiConfig'];let _0x43d138=null;for(const _0x2d623e of _0x41daac){if(_0x2d623e[_0x57289f(0xc3c)]===_0x415772['proxyUrl']&&_0x2d623e[_0x57289f(0x4a2)]===_0x415772[_0x57289f(0x4a2)]&&_0x2d623e[_0x57289f(0x102c)]===_0x415772[_0x57289f(0x102c)]&&_0x2d623e['secondaryProxyUrl']===_0x415772[_0x57289f(0xabf)]&&_0x2d623e['secondaryApiKey']===_0x415772['secondaryApiKey']&&_0x2d623e[_0x57289f(0x782)]===_0x415772['secondaryModel']&&(_0x2d623e[_0x57289f(0xace)]||'')===(_0x415772[_0x57289f(0xace)]||'')&&(_0x2d623e[_0x57289f(0x803)]||'')===(_0x415772[_0x57289f(0x803)]||'')&&(_0x2d623e['minimaxModel']||_0x57289f(0xf82))===(_0x415772[_0x57289f(0x104a)]||_0x57289f(0xf82))){_0x43d138=_0x2d623e['id'];break;}}_0x43d138?_0x55bb03[_0x57289f(0x1be)]=_0x43d138:_0x55bb03[_0x57289f(0x1be)]='current';}async function _0x494bc3(){const _0x255788=_0x549949,_0x5b223b=document['getElementById'](_0x255788(0x892)),_0x3e680d=parseInt(_0x5b223b['value']);if(isNaN(_0x3e680d))return;const _0x5a8dde=await _0x342df8[_0x255788(0xf29)][_0x255788(0x1a3)](_0x3e680d);_0x5a8dde&&(_0x41df36['apiConfig']={'id':_0x255788(0x10e3),'proxyUrl':_0x5a8dde[_0x255788(0xc3c)],'apiKey':_0x5a8dde['apiKey'],'model':_0x5a8dde['model'],'secondaryProxyUrl':_0x5a8dde[_0x255788(0xabf)],'secondaryApiKey':_0x5a8dde[_0x255788(0x1135)],'secondaryModel':_0x5a8dde[_0x255788(0x782)],'minimaxGroupId':_0x5a8dde['minimaxGroupId'],'minimaxApiKey':_0x5a8dde[_0x255788(0x803)],'minimaxModel':_0x5a8dde[_0x255788(0x104a)]},await _0x342df8[_0x255788(0x673)][_0x255788(0x9c0)](_0x41df36[_0x255788(0x673)]),_0x5d2ce6(),document['getElementById'](_0x255788(0x7f1))[_0x255788(0x5c7)](),_0x5a8dde[_0x255788(0xabf)]&&_0x5a8dde[_0x255788(0x1135)]&&document[_0x255788(0x383)](_0x255788(0xe31))[_0x255788(0x5c7)](),alert(_0x255788(0xcc)+_0x5a8dde['name']+'”'));}async function _0x4ddcc3(){const _0x43009c=_0x549949,_0x3ade0b=await _0x12e332('保存\x20API\x20预设',_0x43009c(0x857));if(!_0x3ade0b||!_0x3ade0b['trim']())return;const _0x2a5eb8={'name':_0x3ade0b[_0x43009c(0x1cb)](),'proxyUrl':document['getElementById'](_0x43009c(0x135))['value'][_0x43009c(0x1cb)](),'apiKey':document['getElementById'](_0x43009c(0x4d2))[_0x43009c(0x1be)][_0x43009c(0x1cb)](),'model':document[_0x43009c(0x383)](_0x43009c(0x275))['value'],'secondaryProxyUrl':document['getElementById'](_0x43009c(0x12f8))['value']['trim'](),'secondaryApiKey':document[_0x43009c(0x383)]('secondary-api-key')[_0x43009c(0x1be)][_0x43009c(0x1cb)](),'secondaryModel':document[_0x43009c(0x383)](_0x43009c(0x2b4))[_0x43009c(0x1be)],'minimaxGroupId':document[_0x43009c(0x383)](_0x43009c(0x112c))[_0x43009c(0x1be)][_0x43009c(0x1cb)](),'minimaxApiKey':document[_0x43009c(0x383)](_0x43009c(0x71c))[_0x43009c(0x1be)][_0x43009c(0x1cb)](),'minimaxModel':document['getElementById'](_0x43009c(0x7cf))['value']},_0x445371=await _0x342df8['apiPresets']['where'](_0x43009c(0x461))[_0x43009c(0x5b3)](_0x2a5eb8['name'])['first']();if(_0x445371){const _0x4637a6=await _0x23a88b(_0x43009c(0x284),_0x43009c(0xa5)+_0x2a5eb8['name']+_0x43009c(0xad6),{'confirmButtonClass':_0x43009c(0x51b)});if(!_0x4637a6)return;_0x2a5eb8['id']=_0x445371['id'];}await _0x342df8[_0x43009c(0xf29)]['put'](_0x2a5eb8),await _0x4b3784(),alert(_0x43009c(0x108a));}async function _0x3fda06(){const _0x3649e7=_0x549949,_0x4e824a=document['getElementById'](_0x3649e7(0x892)),_0x3d646d=parseInt(_0x4e824a['value']);if(isNaN(_0x3d646d)){alert(_0x3649e7(0x1112));return;}const _0x50744c=await _0x342df8[_0x3649e7(0xf29)][_0x3649e7(0x1a3)](_0x3d646d);if(!_0x50744c)return;const _0x448c2b=await _0x23a88b(_0x3649e7(0xaa2),_0x3649e7(0x7e0)+_0x50744c[_0x3649e7(0x461)]+'”\x20吗？',{'confirmButtonClass':_0x3649e7(0x51b)});_0x448c2b&&(await _0x342df8[_0x3649e7(0xf29)][_0x3649e7(0x971)](_0x3d646d),await _0x4b3784(),alert(_0x3649e7(0x587)));}function _0x5d2ce6(){const _0x34b39f=_0x549949;document[_0x34b39f(0x383)](_0x34b39f(0x135))[_0x34b39f(0x1be)]=_0x41df36[_0x34b39f(0x673)][_0x34b39f(0xc3c)]||'',document[_0x34b39f(0x383)]('api-key')[_0x34b39f(0x1be)]=_0x41df36[_0x34b39f(0x673)]['apiKey']||'',document[_0x34b39f(0x383)](_0x34b39f(0x12f8))[_0x34b39f(0x1be)]=_0x41df36['apiConfig'][_0x34b39f(0xabf)]||'',document[_0x34b39f(0x383)](_0x34b39f(0xaa5))[_0x34b39f(0x1be)]=_0x41df36[_0x34b39f(0x673)][_0x34b39f(0x1135)]||'',document[_0x34b39f(0x383)](_0x34b39f(0x11a1))[_0x34b39f(0x2a3)]=_0x41df36['globalSettings']['enableBackgroundActivity']||![],document[_0x34b39f(0x383)](_0x34b39f(0x1208))[_0x34b39f(0x1be)]=_0x41df36[_0x34b39f(0xc0)][_0x34b39f(0x686)]||0x3c,document['getElementById']('block-cooldown-input')['value']=_0x41df36[_0x34b39f(0xc0)][_0x34b39f(0x286)]||0x1,document[_0x34b39f(0x383)](_0x34b39f(0xde4))[_0x34b39f(0x2a3)]=_0x41df36[_0x34b39f(0xc0)]['enableAiDrawing'],document['getElementById'](_0x34b39f(0x67e))[_0x34b39f(0x1be)]=_0x41df36[_0x34b39f(0xc0)][_0x34b39f(0xcce)]||0x32,document[_0x34b39f(0x383)]('chat-list-render-window-input')['value']=_0x41df36[_0x34b39f(0xc0)][_0x34b39f(0xadb)]||0x1e;const _0x1a876e=document[_0x34b39f(0x383)]('api-temperature-slider'),_0xa51ad6=document[_0x34b39f(0x383)](_0x34b39f(0x900)),_0x355b98=_0x41df36[_0x34b39f(0xc0)][_0x34b39f(0xa4a)]||0.8;_0x1a876e[_0x34b39f(0x1be)]=_0x355b98,_0xa51ad6[_0x34b39f(0x138e)]=_0x355b98,document[_0x34b39f(0x383)](_0x34b39f(0x112c))[_0x34b39f(0x1be)]=_0x41df36[_0x34b39f(0x673)][_0x34b39f(0xace)]||'',document['getElementById'](_0x34b39f(0x71c))[_0x34b39f(0x1be)]=_0x41df36[_0x34b39f(0x673)][_0x34b39f(0x803)]||'',document['getElementById']('minimax-model-select')[_0x34b39f(0x1be)]=_0x41df36['apiConfig']['minimaxModel']||_0x34b39f(0xf82);const _0xa02346=localStorage[_0x34b39f(0xb2)](_0x34b39f(0x846))===_0x34b39f(0xc06),_0x177d67=localStorage[_0x34b39f(0xb2)]('novelai-model')||_0x34b39f(0x11cb),_0x318c70=localStorage['getItem'](_0x34b39f(0x20a))||'';document['getElementById'](_0x34b39f(0x6bc))[_0x34b39f(0x2a3)]=_0xa02346,document['getElementById']('novelai-model')['value']=_0x177d67,document[_0x34b39f(0x383)]('novelai-api-key')['value']=_0x318c70,document['getElementById'](_0x34b39f(0x9f6))[_0x34b39f(0x655)][_0x34b39f(0x2b6)]=_0xa02346?_0x34b39f(0x27a):_0x34b39f(0xa70),_0x4b3784(),_0x576e53();}window[_0x549949(0x3c0)]=_0x5d2ce6;async function _0x1c4547(){const _0x20096d=_0x549949,_0x1382b1=document[_0x20096d(0x383)](_0x20096d(0x24c));_0x1382b1['innerHTML']='';const _0x1763bb=await _0x342df8[_0x20096d(0x656)][_0x20096d(0x21f)]();if(_0x1763bb[_0x20096d(0xfde)]===0x0){_0x1382b1['innerHTML']=_0x20096d(0x1068);return;}_0x1763bb[_0x20096d(0x19c)](_0x4ffacf=>{const _0xc10b15=_0x20096d,_0x42e3a2=document[_0xc10b15(0xe1b)](_0xc10b15(0x7fd));_0x42e3a2[_0xc10b15(0x556)]=_0xc10b15(0x30c),_0x42e3a2[_0xc10b15(0x118)][_0xc10b15(0x98f)]=_0x4ffacf['id'],_0x42e3a2[_0xc10b15(0x45c)]=_0xc10b15(0xe1f)+(_0x4ffacf['avatar']||_0x59100f)+_0xc10b15(0x92a)+_0x4ffacf[_0xc10b15(0x461)]+_0xc10b15(0x828)+_0x4ffacf[_0xc10b15(0x48c)][_0xc10b15(0xba5)](0x0,0x1e)+_0xc10b15(0x1128),_0x42e3a2[_0xc10b15(0x271)](_0xc10b15(0x5c7),()=>_0x1ffa1b(_0x4ffacf['id'])),_0x3e15d1(_0x42e3a2,async()=>{await _0x51bb02(_0x4ffacf['id']);}),_0x1382b1[_0xc10b15(0xe91)](_0x42e3a2);});}async function _0x1ffa1b(_0x594771=null){const _0x1bfa8a=_0x549949;editingNpcId=_0x594771;const _0x279644=document['getElementById'](_0x1bfa8a(0xf84)),_0x4da347=document[_0x1bfa8a(0x383)]('npc-editor-title'),_0x35446c=document['getElementById']('npc-name-input'),_0xfe180f=document[_0x1bfa8a(0x383)](_0x1bfa8a(0xb4c)),_0x5d47f9=document['getElementById'](_0x1bfa8a(0x690)),_0x3e29bd=document[_0x1bfa8a(0x383)](_0x1bfa8a(0xeab)),_0x53688c=document[_0x1bfa8a(0x383)]('npc-background-activity-switch'),_0x3892c1=document['getElementById'](_0x1bfa8a(0x158));_0x3e29bd[_0x1bfa8a(0x45c)]='',_0x3e29bd[_0x1bfa8a(0x45c)]+=_0x1bfa8a(0xc60)+(_0x41df36['qzoneSettings']['nickname']||'我')+_0x1bfa8a(0x1157),Object[_0x1bfa8a(0x76d)](_0x41df36[_0x1bfa8a(0x864)])[_0x1bfa8a(0x98a)](_0x10599f=>!_0x10599f[_0x1bfa8a(0x1a2)])['forEach'](_0x5f0f9e=>{const _0x40ee1e=_0x1bfa8a;_0x3e29bd['innerHTML']+='<label><input\x20type=\x22checkbox\x22\x20value=\x22'+_0x5f0f9e['id']+_0x40ee1e(0x61a)+_0x5f0f9e[_0x40ee1e(0x461)]+'\x20(角色)</label>';});if(_0x594771){_0x4da347[_0x1bfa8a(0x138e)]='编辑\x20NPC';const _0x4afefa=await _0x342df8[_0x1bfa8a(0x656)]['get'](_0x594771);_0x4afefa&&(_0x35446c[_0x1bfa8a(0x1be)]=_0x4afefa[_0x1bfa8a(0x461)],_0xfe180f[_0x1bfa8a(0x1be)]=_0x4afefa[_0x1bfa8a(0x48c)],_0x5d47f9[_0x1bfa8a(0xf6c)]=_0x4afefa['avatar']||_0x59100f,_0x53688c['checked']=_0x4afefa[_0x1bfa8a(0x8d5)]!==![],_0x3892c1[_0x1bfa8a(0x1be)]=_0x4afefa[_0x1bfa8a(0xf9c)]||0xf,_0x4afefa['associatedWith']&&Array[_0x1bfa8a(0x565)](_0x4afefa[_0x1bfa8a(0x117)])&&_0x4afefa[_0x1bfa8a(0x117)][_0x1bfa8a(0x19c)](_0x17e625=>{const _0x3bd2f3=_0x1bfa8a,_0x4320b8=_0x3e29bd[_0x3bd2f3(0x89c)]('input[value=\x22'+_0x17e625+'\x22]');if(_0x4320b8)_0x4320b8['checked']=!![];}));}else{_0x4da347[_0x1bfa8a(0x138e)]=_0x1bfa8a(0x133),_0x35446c[_0x1bfa8a(0x1be)]='',_0xfe180f[_0x1bfa8a(0x1be)]='',_0x5d47f9['src']=_0x59100f,_0x53688c['checked']=!![],_0x3892c1[_0x1bfa8a(0x1be)]=0xf;const _0x5ed36a=_0x3e29bd[_0x1bfa8a(0x89c)](_0x1bfa8a(0xfbf));if(_0x5ed36a)_0x5ed36a[_0x1bfa8a(0x2a3)]=!![];}_0x279644[_0x1bfa8a(0x119a)][_0x1bfa8a(0xbff)]('visible');}async function _0x353131(){const _0x51b347=_0x549949,_0x4ed950=document['getElementById'](_0x51b347(0x10e7))['value'][_0x51b347(0x1cb)](),_0x536475=document[_0x51b347(0x383)](_0x51b347(0xb4c))[_0x51b347(0x1be)][_0x51b347(0x1cb)]();if(!_0x4ed950||!_0x536475){alert('NPC的昵称和人设都不能为空！');return;}const _0x3847ea=Array['from'](document[_0x51b347(0x400)](_0x51b347(0x1226)))[_0x51b347(0xa79)](_0x243554=>_0x243554[_0x51b347(0x1be)]),_0x120e13=document[_0x51b347(0x383)](_0x51b347(0x537))[_0x51b347(0x2a3)],_0x4be1b6=parseInt(document[_0x51b347(0x383)]('npc-action-cooldown-input')[_0x51b347(0x1be)])||0xf,_0x5e5fb8={'name':_0x4ed950,'persona':_0x536475,'avatar':document['getElementById'](_0x51b347(0x690))[_0x51b347(0xf6c)],'associatedWith':_0x3847ea,'enableBackgroundActivity':_0x120e13,'actionCooldownMinutes':_0x4be1b6};if(editingNpcId)await _0x342df8[_0x51b347(0x656)]['update'](editingNpcId,_0x5e5fb8);else{const _0x4eeb30=await _0x342df8[_0x51b347(0x656)]['add'](_0x5e5fb8);if(_0x4ac0e8&&_0x41df36[_0x51b347(0xfc5)]){const _0x35c6ce=_0x41df36[_0x51b347(0x864)][_0x41df36[_0x51b347(0xfc5)]];_0x35c6ce['isGroup']&&(_0x35c6ce[_0x51b347(0x12a6)][_0x51b347(0x258)]({'id':'npc_'+_0x4eeb30,'originalName':_0x4ed950,'groupNickname':_0x4ed950,'persona':_0x536475,'avatar':_0x5e5fb8[_0x51b347(0xb47)],'isNpc':!![]}),await _0x342df8[_0x51b347(0x864)]['put'](_0x35c6ce));}}document['getElementById'](_0x51b347(0xf84))[_0x51b347(0x119a)][_0x51b347(0x131d)](_0x51b347(0x106d)),_0x4ac0e8?(_0x4ac0e8=![],_0x1a842f()):await _0x1c4547();}async function _0x51bb02(_0x5aeb2c){const _0x3d09fd=_0x549949,_0x2d4ab8=await _0x342df8[_0x3d09fd(0x656)][_0x3d09fd(0x1a3)](_0x5aeb2c);if(!_0x2d4ab8)return;const _0x399bb6=await _0x23a88b(_0x3d09fd(0x809),_0x3d09fd(0xef6)+_0x2d4ab8['name']+_0x3d09fd(0xce2),{'confirmButtonClass':_0x3d09fd(0x51b)});_0x399bb6&&(await _0x342df8[_0x3d09fd(0x656)]['delete'](_0x5aeb2c),await _0x1c4547());}let _0x29fc55=0x0;function _0x12ef40(_0x1cdbca){const _0x2b091e=_0x549949,_0x2699d1=document[_0x2b091e(0xe1b)](_0x2b091e(0x7fd));return _0x2699d1['className']=_0x2b091e(0x11f8),_0x2699d1[_0x2b091e(0x45c)]=_0x2b091e(0x11e0)+_0x1cdbca[_0x2b091e(0x461)]+_0x2b091e(0xf08),_0x2699d1;}function _0x3c093a(_0x3627a9){const _0x3510c5=_0x549949,_0x1b1cc8=document['getElementById']('chat-list'),_0x35c518=document[_0x3510c5(0x383)](_0x3510c5(0xfdd));if(_0x35c518)_0x35c518['remove']();const _0x40d5f9=_0x29fc55,_0x51785b=_0x29fc55+CHAT_LIST_RENDER_WINDOW,_0x22fb61=_0x3627a9['slice'](_0x40d5f9,_0x51785b),_0x299d3b=document[_0x3510c5(0x389)]();let _0x4f721c=_0x1b1cc8[_0x3510c5(0x89c)](_0x3510c5(0x432));_0x22fb61[_0x3510c5(0x19c)](_0xc31907=>{const _0x2615ab=_0x3510c5;if(_0xc31907[_0x2615ab(0xa6b)]==='groupHeader'){const _0x457e2a=_0x12ef40(_0xc31907[_0x2615ab(0x109d)]);_0x299d3b[_0x2615ab(0xe91)](_0x457e2a),_0x4f721c=_0x457e2a[_0x2615ab(0x89c)](_0x2615ab(0x9b0));}else{if(_0xc31907[_0x2615ab(0xa6b)]===_0x2615ab(0xe36)){const _0x49006e=_0x3c2a51(_0xc31907['chat']);_0x4f721c&&_0xc31907['chat']['groupId']?_0x4f721c['appendChild'](_0x49006e):(_0x299d3b['appendChild'](_0x49006e),_0x4f721c=null);}}}),_0x1b1cc8[_0x3510c5(0xe91)](_0x299d3b),_0x29fc55+=_0x22fb61[_0x3510c5(0xfde)],_0x3627a9[_0x3510c5(0xfde)]>_0x29fc55&&_0x48fe01(_0x1b1cc8,_0x3627a9),document[_0x3510c5(0x400)](_0x3510c5(0x541))['forEach'](_0x5429c1=>{const _0x2d85ee=_0x3510c5,_0x4c4961=_0x5429c1['cloneNode'](!![]);_0x5429c1[_0x2d85ee(0x1245)][_0x2d85ee(0xe58)](_0x4c4961,_0x5429c1),_0x4c4961[_0x2d85ee(0x271)](_0x2d85ee(0x5c7),()=>{const _0x3e791c=_0x2d85ee;_0x4c4961[_0x3e791c(0x119a)][_0x3e791c(0x8f0)](_0x3e791c(0x101a)),_0x4c4961['nextElementSibling'][_0x3e791c(0x119a)][_0x3e791c(0x8f0)](_0x3e791c(0x101a));});});}async function _0x25558e(){const _0x39eb06=_0x549949,_0x57483b=document['getElementById'](_0x39eb06(0xb4e));_0x57483b[_0x39eb06(0x45c)]='';const _0x23ef7a=Object['values'](_0x41df36[_0x39eb06(0x864)])[_0x39eb06(0x1296)]((_0x51c650,_0x51936b)=>{const _0x26451c=_0x39eb06,_0x5998af=(_0x51936b[_0x26451c(0x521)]||![])-(_0x51c650['isPinned']||![]);if(_0x5998af!==0x0)return _0x5998af;return(_0x51936b[_0x26451c(0xd08)][_0x26451c(0x1368)](-0x1)[0x0]?.[_0x26451c(0x3b7)]||0x0)-(_0x51c650['history'][_0x26451c(0x1368)](-0x1)[0x0]?.[_0x26451c(0x3b7)]||0x0);}),_0x3084fa=await _0x342df8[_0x39eb06(0x108f)]['toArray']();if(_0x23ef7a[_0x39eb06(0xfde)]===0x0){_0x57483b[_0x39eb06(0x45c)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>';return;}_0x3084fa[_0x39eb06(0x19c)](_0x4fd304=>{const _0x4017b0=_0x39eb06,_0x334c43=_0x23ef7a[_0x4017b0(0xd12)](_0x2bb1a0=>_0x2bb1a0[_0x4017b0(0x11a6)]===_0x4fd304['id']);_0x4fd304[_0x4017b0(0x1d0)]=_0x334c43?_0x334c43[_0x4017b0(0xd08)][_0x4017b0(0x1368)](-0x1)[0x0]?.[_0x4017b0(0x3b7)]||0x0:0x0;}),_0x3084fa[_0x39eb06(0x1296)]((_0x474c02,_0x30b9d0)=>_0x30b9d0[_0x39eb06(0x1d0)]-_0x474c02[_0x39eb06(0x1d0)]),_0x50e27e=[];const _0x29f34d=new Set();_0x23ef7a['forEach'](_0x47d48e=>{const _0x6fca5c=_0x39eb06;_0x47d48e[_0x6fca5c(0x521)]&&(_0x50e27e[_0x6fca5c(0x258)]({'type':_0x6fca5c(0xe36),'chat':_0x47d48e}),_0x29f34d[_0x6fca5c(0xbff)](_0x47d48e['id']));}),_0x3084fa['forEach'](_0x131974=>{const _0x49192a=_0x39eb06,_0x32f960=_0x23ef7a[_0x49192a(0x98a)](_0x5cb027=>!_0x5cb027[_0x49192a(0x521)]&&!_0x5cb027['isGroup']&&_0x5cb027[_0x49192a(0x11a6)]===_0x131974['id']);_0x32f960['length']>0x0&&(_0x50e27e['push']({'type':_0x49192a(0x893),'group':_0x131974}),_0x32f960[_0x49192a(0x19c)](_0x48080b=>{const _0x1feace=_0x49192a;_0x50e27e[_0x1feace(0x258)]({'type':_0x1feace(0xe36),'chat':_0x48080b}),_0x29f34d[_0x1feace(0xbff)](_0x48080b['id']);}));}),_0x23ef7a[_0x39eb06(0x19c)](_0x40a7f0=>{const _0x19b3b1=_0x39eb06;!_0x29f34d['has'](_0x40a7f0['id'])&&(_0x50e27e['push']({'type':_0x19b3b1(0xe36),'chat':_0x40a7f0}),_0x29f34d[_0x19b3b1(0xbff)](_0x40a7f0['id']));}),_0x29fc55=0x0,_0x3c093a();}function _0x12ef40(_0x2e3f10){const _0x3b7c32=_0x549949,_0x51a0b1=document[_0x3b7c32(0xe1b)](_0x3b7c32(0x7fd));return _0x51a0b1[_0x3b7c32(0x556)]=_0x3b7c32(0x11f8),_0x51a0b1[_0x3b7c32(0x45c)]=_0x3b7c32(0x94c)+_0x2e3f10[_0x3b7c32(0x461)]+_0x3b7c32(0xeb7),_0x51a0b1;}function _0x48fe01(_0x162d35,_0x47f525){const _0x40e766=_0x549949,_0x28b7a0=document[_0x40e766(0xe1b)]('button');_0x28b7a0['id']='load-more-chats-btn',_0x28b7a0[_0x40e766(0x138e)]=_0x40e766(0x12ed),_0x28b7a0['className']='load-more-btn',_0x28b7a0[_0x40e766(0x271)]('click',()=>_0x3c093a(_0x47f525),{'once':!![]}),_0x162d35[_0x40e766(0x7c9)](_0x28b7a0);}function _0x3c093a(){const _0x533e38=_0x549949;if(_0x4c00a8)return;const _0x14b421=document['getElementById'](_0x533e38(0xb4e)),_0x3d4f27=document['getElementById'](_0x533e38(0x502));if(!_0x14b421||!_0x3d4f27)return;if(_0x29fc55>=_0x50e27e[_0x533e38(0xfde)])return;_0x4c00a8=!![];const _0x2de17f=_0x29fc55===0x0,_0x562d9a=()=>{const _0x3d6df2=_0x533e38;_0x3a7b5e(_0x14b421);const _0x50efa8=_0x41df36[_0x3d6df2(0xc0)][_0x3d6df2(0xadb)]||0x1e,_0x2d6e6f=_0x29fc55,_0x3ea397=_0x29fc55+_0x50efa8,_0x3562ee=_0x50e27e[_0x3d6df2(0x1368)](_0x2d6e6f,_0x3ea397),_0x37a444=document[_0x3d6df2(0x389)]();let _0x2dc1f4=_0x14b421[_0x3d6df2(0x89c)](_0x3d6df2(0x432));_0x3562ee[_0x3d6df2(0x19c)](_0x5e5aa1=>{const _0xf193d4=_0x3d6df2;if(_0x5e5aa1[_0xf193d4(0xa6b)]===_0xf193d4(0x893)){const _0x545243=_0x12ef40(_0x5e5aa1['group']);_0x37a444[_0xf193d4(0xe91)](_0x545243),_0x2dc1f4=_0x545243[_0xf193d4(0x89c)](_0xf193d4(0x9b0));}else{if(_0x5e5aa1[_0xf193d4(0xa6b)]==='chatItem'){const _0x49432e=_0x3c2a51(_0x5e5aa1[_0xf193d4(0x135e)]);if(_0x5e5aa1[_0xf193d4(0x135e)][_0xf193d4(0x11a6)]&&_0x2dc1f4)_0x2dc1f4[_0xf193d4(0xe91)](_0x49432e);else{_0x37a444[_0xf193d4(0xe91)](_0x49432e);if(!_0x5e5aa1[_0xf193d4(0x135e)][_0xf193d4(0x11a6)])_0x2dc1f4=null;}}}}),_0x14b421[_0x3d6df2(0xe91)](_0x37a444),_0x29fc55+=_0x3562ee['length'],_0x14b421['querySelectorAll']('.chat-group-header:not([data-has-listener=\x22true\x22])')[_0x3d6df2(0x19c)](_0x4e924c=>{const _0x2d6bd3=_0x3d6df2;_0x4e924c[_0x2d6bd3(0x118)]['hasListener']=_0x2d6bd3(0xc06),_0x4e924c[_0x2d6bd3(0x271)](_0x2d6bd3(0x5c7),()=>{const _0x1c993c=_0x2d6bd3;_0x4e924c['classList'][_0x1c993c(0x8f0)](_0x1c993c(0x101a)),_0x4e924c['nextElementSibling']['classList']['toggle']('collapsed');});}),_0x4c00a8=![],_0x3d4f27[_0x3d6df2(0x36d)]<=_0x3d4f27['clientHeight']&&_0x29fc55<_0x50e27e['length']&&_0x3c093a();};_0x2de17f?_0x562d9a():(_0x38d82d(_0x14b421,_0x533e38(0xbe3)),setTimeout(_0x562d9a,0x1f4));}function _0x3c2a51(_0x55001c){const _0x2bbac9=_0x549949;try{const _0x392a7f=_0x55001c[_0x2bbac9(0xd08)][_0x2bbac9(0x98a)](_0x1e20be=>!_0x1e20be[_0x2bbac9(0xbc5)])[_0x2bbac9(0x1368)](-0x1)[0x0]||{};let _0x29ebb4;if(!_0x55001c[_0x2bbac9(0x1a2)]&&_0x55001c['relationship']?.[_0x2bbac9(0x1fe)]===_0x2bbac9(0xf52))_0x29ebb4=_0x2bbac9(0x102b)+(_0x55001c['relationship'][_0x2bbac9(0x6d8)]||_0x2bbac9(0x783))+_0x2bbac9(0xd74);else{if(!_0x55001c[_0x2bbac9(0x1a2)]&&_0x55001c['relationship']?.['status']===_0x2bbac9(0x203))_0x29ebb4=_0x2bbac9(0x5af);else{if(_0x55001c[_0x2bbac9(0x1a2)]){if(_0x392a7f['type']===_0x2bbac9(0xed8))_0x29ebb4=_0x2bbac9(0x25d)+_0x392a7f[_0x2bbac9(0x11b6)];else{if(_0x392a7f[_0x2bbac9(0xa6b)]===_0x2bbac9(0x909))_0x29ebb4=_0x2bbac9(0xd14);else{if(_0x392a7f[_0x2bbac9(0xa6b)]===_0x2bbac9(0x1050)||_0x392a7f[_0x2bbac9(0xa6b)]===_0x2bbac9(0xed0))_0x29ebb4=_0x2bbac9(0xa2e);else{if(_0x392a7f['type']===_0x2bbac9(0xa4f))_0x29ebb4='[语音]';else{if(typeof _0x392a7f['content']===_0x2bbac9(0xafa)&&_0x49f222[_0x2bbac9(0xd73)](_0x392a7f[_0x2bbac9(0x11b6)]))_0x29ebb4=_0x392a7f['meaning']?'[表情:\x20'+_0x392a7f[_0x2bbac9(0x7de)]+']':'[表情]';else Array['isArray'](_0x392a7f[_0x2bbac9(0x11b6)])?_0x29ebb4='[图片]':_0x29ebb4=String(_0x392a7f[_0x2bbac9(0x11b6)]||_0x2bbac9(0x1026))[_0x2bbac9(0xba5)](0x0,0x14);}}}}if(_0x392a7f[_0x2bbac9(0x4c5)]&&_0x392a7f[_0x2bbac9(0xa6b)]!==_0x2bbac9(0xed8)){const _0x3deeef=_0x54d0ab(_0x55001c,_0x392a7f[_0x2bbac9(0x4c5)]);_0x29ebb4=_0x3deeef+':\x20'+_0x29ebb4;}}else{const _0x2c71b5=_0x55001c['status']?.[_0x2bbac9(0x6af)]||'在线';_0x29ebb4='['+_0x2c71b5+']';}}}const _0x30cd67=document[_0x2bbac9(0xe1b)]('div');_0x30cd67['className']=_0x2bbac9(0x30c),_0x30cd67[_0x2bbac9(0x118)][_0x2bbac9(0xa65)]=_0x55001c['id'];_0x55001c[_0x2bbac9(0x521)]&&_0x30cd67[_0x2bbac9(0x119a)]['add'](_0x2bbac9(0x188));const _0x453eb6=_0x55001c[_0x2bbac9(0x1a2)]?_0x55001c['settings'][_0x2bbac9(0x332)]:_0x55001c[_0x2bbac9(0x886)][_0x2bbac9(0x121e)],_0x12f54f=_0x55001c['isGroup']?'':_0x55001c['settings'][_0x2bbac9(0x957)]||'';let _0x30d34b;_0x12f54f?_0x30d34b='<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22'+(_0x453eb6||_0x5dc108)+_0x2bbac9(0x75d)+_0x12f54f+_0x2bbac9(0x503):_0x30d34b=_0x2bbac9(0xf8a)+(_0x453eb6||_0x5dc108)+'\x22\x20class=\x22avatar\x22>';const _0x21e6a5=_0x12f54f?_0x2bbac9(0xac1):'',_0x35b1ec=_0x2bbac9(0x1dc)+_0x21e6a5+'\x22>'+_0x30d34b+_0x2bbac9(0x69b);_0x30cd67['innerHTML']=_0x2bbac9(0x122b)+_0x35b1ec+_0x2bbac9(0xa5f)+_0x55001c[_0x2bbac9(0x461)]+_0x2bbac9(0x704)+(_0x55001c[_0x2bbac9(0x1a2)]?_0x2bbac9(0xea3):'')+_0x2bbac9(0xb22)+(_0x55001c[_0x2bbac9(0x1a2)]?_0x2bbac9(0x495):_0x2bbac9(0x1254))+_0x2bbac9(0xd44)+_0x29ebb4+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0xe2a866=_0x55001c['unreadCount']||0x0,_0x10c0d2=_0x30cd67['querySelector']('.unread-count');_0xe2a866>0x0?(_0x10c0d2[_0x2bbac9(0x138e)]=_0xe2a866>0x63?_0x2bbac9(0xe95):_0xe2a866,_0x10c0d2[_0x2bbac9(0x655)][_0x2bbac9(0x2b6)]=_0x2bbac9(0x1355)):_0x10c0d2[_0x2bbac9(0x655)][_0x2bbac9(0x2b6)]=_0x2bbac9(0xa70);const _0x582795=_0x30cd67['querySelector'](_0x2bbac9(0xa46));_0x582795&&(_0x582795[_0x2bbac9(0x655)]['cursor']=_0x2bbac9(0x8a0),_0x582795[_0x2bbac9(0x271)]('dblclick',_0x5650d5=>{const _0x2459c7=_0x2bbac9;_0x5650d5[_0x2459c7(0x1311)]();const _0xa599c6=_0x55001c[_0x2459c7(0x1a2)]?_0x55001c[_0x2459c7(0x461)]:_0x55001c[_0x2459c7(0x283)];_0x70854a(_0x55001c['id'],_0xa599c6);}));const _0x4acda1=_0x30cd67[_0x2bbac9(0x89c)]('.info');return _0x4acda1&&_0x4acda1[_0x2bbac9(0x271)]('click',()=>_0x4a08c7(_0x55001c['id'])),_0x3e15d1(_0x30cd67,async _0x402669=>{const _0x5da935=_0x2bbac9,_0x1c7d06=await _0x4b38f1(_0x55001c);switch(_0x1c7d06){case _0x5da935(0x104f):_0x55001c['isPinned']=!_0x55001c[_0x5da935(0x521)],await _0x342df8[_0x5da935(0x864)][_0x5da935(0x9c0)](_0x55001c),_0x25558e();break;case _0x5da935(0x971):const _0x291acb=await _0x23a88b('删除对话',_0x5da935(0x10a9)+_0x55001c[_0x5da935(0x461)]+'\x22\x20的整个对话吗？此操作不可撤销。',{'confirmButtonClass':'btn-danger'});if(_0x291acb){_0x40e606['isActive']&&_0x40e606[_0x5da935(0xfc5)]===_0x55001c['id']&&await _0x1e6479(![]);delete _0x41df36[_0x5da935(0x864)][_0x55001c['id']];if(_0x41df36[_0x5da935(0xfc5)]===_0x55001c['id'])_0x41df36[_0x5da935(0xfc5)]=null;await _0x342df8[_0x5da935(0x864)][_0x5da935(0x971)](_0x55001c['id']),_0x25558e();}break;default:break;}}),_0x30cd67;}catch(_0xae82cb){return console['error']('渲染聊天项\x20['+(_0x55001c[_0x2bbac9(0x461)]||'未知')+_0x2bbac9(0x9a1)+_0x55001c['id']+_0x2bbac9(0xca2),_0xae82cb),null;}}async function _0x409076(_0x4b4ba9){const _0x498b73=_0x549949;_0x9b7052(),_0x55d47a();const _0xef860f=_0x41df36[_0x498b73(0x864)][_0x4b4ba9];if(!_0xef860f)return;_0x11c2ba();const _0x115dd7=document[_0x498b73(0x383)](_0x498b73(0x11cf)),_0x1ca948=document[_0x498b73(0x383)]('chat-input-area'),_0x160004=document['getElementById']('chat-lock-overlay'),_0x1cd1ab=document[_0x498b73(0x383)](_0x498b73(0xa31));_0x115dd7[_0x498b73(0x118)]['theme']=_0xef860f[_0x498b73(0x886)]['theme']||_0x498b73(0xba4);const _0x4ec037=_0xef860f[_0x498b73(0x886)][_0x498b73(0x3eb)]||0xd;_0x115dd7[_0x498b73(0x655)]['setProperty'](_0x498b73(0x1df),_0x4ec037+'px'),_0x5810fc(_0xef860f['settings']['customCss']||'',_0x498b73(0xf7d),_0x498b73(0x4ac)),document['getElementById'](_0x498b73(0x969))[_0x498b73(0x138e)]=_0xef860f[_0x498b73(0x461)];const _0xd86df0=document[_0x498b73(0x383)](_0x498b73(0x105e)),_0x461d99=_0xd86df0['querySelector'](_0x498b73(0x1020));_0xef860f[_0x498b73(0x1a2)]?(_0xd86df0[_0x498b73(0x655)][_0x498b73(0x2b6)]=_0x498b73(0xa70),document[_0x498b73(0x383)](_0x498b73(0x922))['style'][_0x498b73(0x10cf)]='center'):(_0xd86df0[_0x498b73(0x655)]['display']=_0x498b73(0x2aa),document[_0x498b73(0x383)](_0x498b73(0x922))['style'][_0x498b73(0x10cf)]=_0x498b73(0x1c6),_0x461d99[_0x498b73(0x138e)]=_0xef860f[_0x498b73(0x1fe)]?.[_0x498b73(0x6af)]||'在线',_0xd86df0[_0x498b73(0x119a)]['toggle'](_0x498b73(0x1293),_0xef860f[_0x498b73(0x1fe)]?.[_0x498b73(0xa6d)]||![]));const _0x14637d=document[_0x498b73(0x383)](_0x498b73(0x862)),_0x1f87d8=_0xef860f[_0x498b73(0x886)][_0x498b73(0x415)],_0x550bc4=_0x41df36[_0x498b73(0xc0)][_0x498b73(0x7bb)],_0x1f9f5e=document['getElementById']('phone-screen')[_0x498b73(0x119a)][_0x498b73(0x987)]('dark-mode'),_0x19fd82=_0x1f9f5e?_0x498b73(0x763):_0x498b73(0xb71);if(_0x1f87d8)_0x14637d[_0x498b73(0x655)]['backgroundImage']='url('+_0x1f87d8+')',_0x14637d['style']['backgroundColor']=_0x498b73(0x124);else _0x550bc4?(_0x14637d[_0x498b73(0x655)]['backgroundImage']=_0x498b73(0xb9a)+_0x550bc4+')',_0x14637d[_0x498b73(0x655)][_0x498b73(0x8fc)]=_0x498b73(0x124)):(_0x14637d[_0x498b73(0x655)]['backgroundImage']='none',_0x14637d[_0x498b73(0x655)][_0x498b73(0x8fc)]=_0x19fd82);if(_0xef860f[_0x498b73(0x726)])_0x1ca948[_0x498b73(0x655)][_0x498b73(0x2b6)]=_0x498b73(0xa70),_0x160004[_0x498b73(0x655)]['display']=_0x498b73(0x2aa),_0x1cd1ab[_0x498b73(0x45c)]=_0x498b73(0x11af),document['getElementById'](_0x498b73(0xc9))[_0x498b73(0xc50)]=_0x41e5ce;else{_0x1ca948[_0x498b73(0x655)][_0x498b73(0x2b6)]=_0x498b73(0x2aa),_0x160004[_0x498b73(0x655)][_0x498b73(0x2b6)]='none',_0x1cd1ab[_0x498b73(0x45c)]='';if(!_0xef860f['isGroup']&&_0xef860f[_0x498b73(0x112b)][_0x498b73(0x1fe)]!==_0x498b73(0x757)){_0x160004['style'][_0x498b73(0x2b6)]='flex',_0x1ca948[_0x498b73(0x655)]['visibility']='hidden';let _0x266ecc='';switch(_0xef860f[_0x498b73(0x112b)]['status']){case'blocked_by_user':const _0x4f801a=_0x595b58!==null,_0xb0e08a=_0xef860f[_0x498b73(0x112b)][_0x498b73(0x97)],_0x1995dd=_0x41df36[_0x498b73(0xc0)][_0x498b73(0x286)]||0x1,_0x56ebcd=_0x1995dd*0x3c*0x3c*0x3e8,_0x551876=Date[_0x498b73(0x108d)]()-_0xb0e08a,_0x180e22=_0x551876>_0x56ebcd,_0x228f15=Math[_0x498b73(0xaf3)](0x0,Math[_0x498b73(0x46d)]((_0x56ebcd-_0x551876)/(0x3e8*0x3c)));_0x266ecc='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“'+_0xef860f['name']+_0x498b73(0x1176)+(_0x41df36[_0x498b73(0xc0)][_0x498b73(0x8d5)]?_0x498b73(0x15f):_0x498b73(0xff0))+_0x498b73(0x2bb)+(_0x4f801a?_0x498b73(0xac4):_0x498b73(0x3ca))+_0x498b73(0xb7b)+_0xef860f[_0x498b73(0x112b)][_0x498b73(0x1fe)]+_0x498b73(0xbd8)+_0x1995dd+_0x498b73(0x1000)+(_0x180e22?_0x498b73(0xdfc):_0x498b73(0x1277)+_0x228f15+_0x498b73(0x308))+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20'+(_0x180e22&&_0x41df36[_0x498b73(0xc0)][_0x498b73(0x8d5)]?_0x498b73(0x1216):'<span\x20style=\x22color:\x20red;\x22>未满足</span>')+_0x498b73(0x10a5);break;case'blocked_by_ai':_0x266ecc=_0x498b73(0x542);break;case _0x498b73(0xf52):_0x266ecc=_0x498b73(0x1288)+_0xef860f[_0x498b73(0x461)]+_0x498b73(0xd17)+_0xef860f[_0x498b73(0x112b)][_0x498b73(0x6d8)]+'”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';break;case'pending_ai_approval':_0x266ecc=_0x498b73(0x131e);break;}_0x1cd1ab[_0x498b73(0x45c)]=_0x266ecc;}else _0x160004[_0x498b73(0x655)][_0x498b73(0x2b6)]=_0x498b73(0xa70),_0x1ca948['style']['visibility']=_0x498b73(0x106d);}_0x115dd7['innerHTML']='';const _0x5db0af=_0xef860f[_0x498b73(0xd08)];_0x2cf31b=0x0;const _0x3075ba=_0x41df36[_0x498b73(0xc0)]['chatRenderWindow']||0x32,_0xd822a1=_0x5db0af['slice'](-_0x3075ba),_0x16a7fb=[];let _0x563797=0x0;for(const _0x3703f3 of _0xd822a1){_0x563797>0x0&&_0x3703f3[_0x498b73(0x3b7)]-_0x563797>0x927c0&&_0x16a7fb[_0x498b73(0x258)](Promise['resolve'](_0x49e7d1(_0x3703f3[_0x498b73(0x3b7)]))),_0x16a7fb[_0x498b73(0x258)](_0x152d98(_0x3703f3,_0xef860f,!![])),_0x563797=_0x3703f3[_0x498b73(0x3b7)];}const _0x7df758=await Promise[_0x498b73(0x1282)](_0x16a7fb),_0x74d0a6=document[_0x498b73(0x389)]();_0x7df758[_0x498b73(0x98a)](Boolean)[_0x498b73(0x19c)](_0x551c94=>_0x74d0a6[_0x498b73(0xe91)](_0x551c94)),_0x115dd7['appendChild'](_0x74d0a6),_0x2cf31b=_0xd822a1[_0x498b73(0xfde)];const _0x20204f=document['createElement'](_0x498b73(0x7fd));_0x20204f['id']='typing-indicator',_0x20204f[_0x498b73(0x655)][_0x498b73(0x2b6)]=_0x498b73(0xa70),_0x20204f[_0x498b73(0x138e)]=_0x498b73(0xefa),_0x115dd7['appendChild'](_0x20204f),setTimeout(()=>_0x115dd7['scrollTop']=_0x115dd7[_0x498b73(0x36d)],0x0);}async function _0x28355d(){const _0x3cdefd=_0x549949;if(_0x6a317c)return;_0x6a317c=!![];const _0x477a7c=document[_0x3cdefd(0x383)](_0x3cdefd(0x11cf)),_0x1b30c8=_0x41df36['chats'][_0x41df36[_0x3cdefd(0xfc5)]];if(!_0x1b30c8){_0x6a317c=![];return;}_0x38d82d(_0x477a7c,_0x3cdefd(0x994));const _0x17cd99=_0x477a7c[_0x3cdefd(0x36d)];await new Promise(_0x524be9=>setTimeout(_0x524be9,0x1f4));const _0x12d8d6=_0x1b30c8[_0x3cdefd(0xd08)][_0x3cdefd(0xfde)],_0x123afb=_0x41df36[_0x3cdefd(0xc0)]['chatRenderWindow']||0x32,_0x5ec138=_0x12d8d6-_0x2cf31b-_0x123afb,_0x1619f7=_0x12d8d6-_0x2cf31b,_0x1029a4=_0x1b30c8['history'][_0x3cdefd(0x1368)](Math['max'](0x0,_0x5ec138),_0x1619f7),_0x3f0d0=_0x477a7c[_0x3cdefd(0x89c)]('.message-wrapper[data-timestamp]');let _0x3ddda6=_0x3f0d0?parseInt(_0x3f0d0[_0x3cdefd(0x118)][_0x3cdefd(0x3b7)]):0x0;for(const _0x19f1a5 of _0x1029a4[_0x3cdefd(0x1087)]()){if(_0x3ddda6>0x0&&_0x3ddda6-_0x19f1a5['timestamp']>0x927c0){const _0x24bf28=_0x49e7d1(_0x3ddda6);_0x477a7c[_0x3cdefd(0x7c9)](_0x24bf28);}await _0x40e080(_0x19f1a5,_0x1b30c8),_0x3ddda6=_0x19f1a5[_0x3cdefd(0x3b7)];}_0x2cf31b+=_0x1029a4[_0x3cdefd(0xfde)];const _0x2f1f01=_0x477a7c['scrollHeight'];_0x477a7c[_0x3cdefd(0x4f9)]=_0x2f1f01-_0x17cd99,_0x3a7b5e(_0x477a7c),_0x6a317c=![];}function _0x446010(){const _0xec9d6a=_0x549949;_0x4ff67e(),_0x4a451b();const _0x4bc6d1=document[_0xec9d6a(0x383)]('wallpaper-preview'),_0x663bf5=_0x41df36[_0xec9d6a(0xc0)][_0xec9d6a(0x5d0)];_0x663bf5?(_0x4bc6d1[_0xec9d6a(0x655)]['backgroundImage']=_0xec9d6a(0xb9a)+_0x663bf5+')',_0x4bc6d1['textContent']=''):(_0x4bc6d1['style'][_0xec9d6a(0x880)]=_0xec9d6a(0x109f),_0x4bc6d1[_0xec9d6a(0x138e)]=_0xec9d6a(0x1119));const _0x1468d6=document['getElementById']('cphone-wallpaper-preview'),_0x39d80b=_0x41df36[_0xec9d6a(0xc0)][_0xec9d6a(0x1120)];_0x39d80b?(_0x1468d6[_0xec9d6a(0x655)]['backgroundImage']=_0xec9d6a(0xb9a)+_0x39d80b+')',_0x1468d6[_0xec9d6a(0x138e)]=''):(_0x1468d6[_0xec9d6a(0x655)][_0xec9d6a(0x880)]='linear-gradient(135deg,\x20#f6d365,\x20#fda085)',_0x1468d6[_0xec9d6a(0x138e)]=_0xec9d6a(0x1119));const _0x3b46f3=document[_0xec9d6a(0x383)]('global-bg-preview'),_0x541c9f=_0x41df36[_0xec9d6a(0xc0)]['globalChatBackground'];_0x541c9f?(_0x3b46f3[_0xec9d6a(0x655)][_0xec9d6a(0x880)]=_0xec9d6a(0xb9a)+_0x541c9f+')',_0x3b46f3['textContent']='',document['getElementById']('remove-global-bg-btn')[_0xec9d6a(0x655)][_0xec9d6a(0x2b6)]=_0xec9d6a(0xdcf)):(_0x3b46f3[_0xec9d6a(0x655)][_0xec9d6a(0x880)]=_0xec9d6a(0xa70),_0x3b46f3[_0xec9d6a(0x138e)]=_0xec9d6a(0x10a7),document['getElementById'](_0xec9d6a(0xe99))[_0xec9d6a(0x655)][_0xec9d6a(0x2b6)]=_0xec9d6a(0xa70)),_0xd31dcf(),_0x2727d9(),document['getElementById']('global-css-input')[_0xec9d6a(0x1be)]=_0x41df36[_0xec9d6a(0xc0)][_0xec9d6a(0xf2c)]||'',document[_0xec9d6a(0x383)]('notification-sound-url-input')[_0xec9d6a(0x1be)]=_0x41df36[_0xec9d6a(0xc0)][_0xec9d6a(0x11ce)]||'',document[_0xec9d6a(0x383)](_0xec9d6a(0xde9))[_0xec9d6a(0x2a3)]=_0x41df36[_0xec9d6a(0xc0)][_0xec9d6a(0x221)]||![],_0x4bc6a4(),_0x35e329();}window[_0x549949(0xeeb)]=_0x446010;function _0x31bb8c(){const _0x5cb005=_0x549949,_0xb9ba3=document[_0x5cb005(0x383)]('home-screen'),_0x1866e0=_0x41df36[_0x5cb005(0xc0)][_0x5cb005(0x5d0)];_0x1866e0?_0xb9ba3[_0x5cb005(0x655)][_0x5cb005(0x880)]=_0x5cb005(0xb9a)+_0x1866e0+')':_0xb9ba3[_0x5cb005(0x655)][_0x5cb005(0x880)]='linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)';}function _0x4b7a07(_0x4a2f58){const _0xab7e3c=_0x549949;document[_0xab7e3c(0x400)](_0xab7e3c(0x11db))[_0xab7e3c(0x19c)](_0x11838b=>{const _0x39d2d3=_0xab7e3c;_0x11838b[_0x39d2d3(0x119a)][_0x39d2d3(0x8f0)](_0x39d2d3(0xde5),_0x11838b[_0x39d2d3(0x118)][_0x39d2d3(0xba3)]===_0x4a2f58);}),document[_0xab7e3c(0x400)](_0xab7e3c(0xf3))[_0xab7e3c(0x19c)](_0x490488=>{const _0x29e4e6=_0xab7e3c;_0x490488[_0x29e4e6(0x119a)]['toggle'](_0x29e4e6(0xde5),_0x490488[_0x29e4e6(0x118)][_0x29e4e6(0xba3)]===_0x4a2f58);});}async function _0x11e574(){const _0x11d9e1=_0x549949,_0x327fe1=document[_0x11d9e1(0x383)](_0x11d9e1(0x1a5)),_0xc80625=document['getElementById'](_0x11d9e1(0x11d));_0x327fe1[_0x11d9e1(0x45c)]='',_0xc80625[_0x11d9e1(0x45c)]='';const [_0x470d0b,_0x569ebf]=await Promise[_0x11d9e1(0x1282)]([_0x342df8[_0x11d9e1(0xf17)][_0x11d9e1(0x21f)](),_0x342df8[_0x11d9e1(0xa1c)][_0x11d9e1(0x4b1)](_0x11d9e1(0x461))[_0x11d9e1(0x21f)]()]);_0x41df36['worldBooks']=_0x470d0b;if(_0x470d0b[_0x11d9e1(0xfde)]===0x0){_0xc80625[_0x11d9e1(0x45c)]=_0x11d9e1(0xad);return;}const _0x5420d1=document[_0x11d9e1(0xe1b)]('button');_0x5420d1[_0x11d9e1(0x556)]=_0x11d9e1(0x34b),_0x5420d1[_0x11d9e1(0x138e)]='全部',_0x5420d1['dataset']['categoryId']=_0x11d9e1(0x1282),_0x327fe1[_0x11d9e1(0xe91)](_0x5420d1);const _0x336ec6=document[_0x11d9e1(0xe1b)]('div');_0x336ec6[_0x11d9e1(0x556)]=_0x11d9e1(0x207),_0x336ec6[_0x11d9e1(0x118)]['categoryId']=_0x11d9e1(0x1282),_0xc80625['appendChild'](_0x336ec6),_0x569ebf[_0x11d9e1(0x19c)](_0x520c5d=>{const _0x3f8e1e=_0x11d9e1,_0xadc0e5=document[_0x3f8e1e(0xe1b)](_0x3f8e1e(0x182));_0xadc0e5['className']=_0x3f8e1e(0x112),_0xadc0e5[_0x3f8e1e(0x138e)]=_0x520c5d[_0x3f8e1e(0x461)],_0xadc0e5[_0x3f8e1e(0x118)][_0x3f8e1e(0xba3)]=String(_0x520c5d['id']),_0x327fe1[_0x3f8e1e(0xe91)](_0xadc0e5);const _0x356f2c=document[_0x3f8e1e(0xe1b)](_0x3f8e1e(0x7fd));_0x356f2c['className']=_0x3f8e1e(0xb45),_0x356f2c[_0x3f8e1e(0x118)]['categoryId']=String(_0x520c5d['id']),_0xc80625[_0x3f8e1e(0xe91)](_0x356f2c);});const _0xeb98f2=_0x470d0b['some'](_0x152b6d=>!_0x152b6d[_0x11d9e1(0xba3)]);if(_0xeb98f2){const _0x562701=document[_0x11d9e1(0xe1b)](_0x11d9e1(0x182));_0x562701['className']=_0x11d9e1(0x112),_0x562701[_0x11d9e1(0x138e)]=_0x11d9e1(0xaac),_0x562701[_0x11d9e1(0x118)][_0x11d9e1(0xba3)]=_0x11d9e1(0x1289),_0x327fe1[_0x11d9e1(0xe91)](_0x562701);const _0xcc4af7=document[_0x11d9e1(0xe1b)](_0x11d9e1(0x7fd));_0xcc4af7[_0x11d9e1(0x556)]='world-book-category-pane',_0xcc4af7[_0x11d9e1(0x118)][_0x11d9e1(0xba3)]=_0x11d9e1(0x1289),_0xc80625[_0x11d9e1(0xe91)](_0xcc4af7);}_0x470d0b[_0x11d9e1(0x19c)](_0x330716=>{const _0x4e3a03=_0x11d9e1;let _0x2ebada=_0x4e3a03(0x1106);if(Array['isArray'](_0x330716[_0x4e3a03(0x11b6)])&&_0x330716[_0x4e3a03(0x11b6)][_0x4e3a03(0xfde)]>0x0){const _0x58a550=_0x330716['content'][0x0];_0x2ebada=_0x58a550[_0x4e3a03(0x125b)]||_0x58a550[_0x4e3a03(0x11b6)]||'';}else typeof _0x330716['content']===_0x4e3a03(0xafa)&&_0x330716[_0x4e3a03(0x11b6)][_0x4e3a03(0x1cb)]()!==''&&(_0x2ebada=_0x330716[_0x4e3a03(0x11b6)]);const _0x4c64b6=document[_0x4e3a03(0xe1b)]('div');_0x4c64b6[_0x4e3a03(0x556)]='world-book-card',_0x4c64b6['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x330716[_0x4e3a03(0x461)]+_0x4e3a03(0x4f7)+_0x2ebada+_0x4e3a03(0x802);const _0x5dad0d=()=>_0x4dda11(_0x330716['id']),_0x15af10=async()=>{const _0xb996af=_0x4e3a03,_0x434530=await _0x23a88b('删除世界书',_0xb996af(0xbf6)+_0x330716[_0xb996af(0x461)]+_0xb996af(0x75c),{'confirmButtonClass':_0xb996af(0x51b)});_0x434530&&(await _0x342df8[_0xb996af(0xf17)][_0xb996af(0x971)](_0x330716['id']),_0x41df36[_0xb996af(0xf17)]=_0x41df36['worldBooks'][_0xb996af(0x98a)](_0x1a6b91=>_0x1a6b91['id']!==_0x330716['id']),_0x11e574());};_0x4c64b6['addEventListener']('click',_0x5dad0d),_0x3e15d1(_0x4c64b6,_0x15af10);const _0x381fd7=_0x4c64b6[_0x4e3a03(0x117b)](!![]);_0x381fd7['addEventListener'](_0x4e3a03(0x5c7),_0x5dad0d),_0x3e15d1(_0x381fd7,_0x15af10),_0x336ec6['appendChild'](_0x381fd7);const _0x517cb8=_0x330716[_0x4e3a03(0xba3)]?String(_0x330716['categoryId']):_0x4e3a03(0x1289),_0x5538de=_0xc80625[_0x4e3a03(0x89c)](_0x4e3a03(0x107f)+_0x517cb8+'\x22]');_0x5538de&&_0x5538de[_0x4e3a03(0xe91)](_0x4c64b6);}),document[_0x11d9e1(0x400)](_0x11d9e1(0x11db))[_0x11d9e1(0x19c)](_0x3692d7=>{const _0x5a682c=_0x11d9e1;_0x3692d7[_0x5a682c(0x271)]('click',()=>_0x4b7a07(_0x3692d7[_0x5a682c(0x118)][_0x5a682c(0xba3)]));});}function _0x43863c(_0x448d57,_0xaa5a78){const _0xcf55bc=_0x549949,_0x52d02e=document[_0xcf55bc(0xe1b)](_0xcf55bc(0x7fd));_0x52d02e[_0xcf55bc(0x556)]=_0xcf55bc(0x1383),_0x52d02e[_0xcf55bc(0x45c)]=_0xcf55bc(0xa33)+_0x448d57+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x4d83aa=_0x52d02e[_0xcf55bc(0x89c)]('.world-book-group-content');return _0xaa5a78[_0xcf55bc(0x1296)]((_0x4ea770,_0x3d0a09)=>_0x4ea770[_0xcf55bc(0x461)][_0xcf55bc(0x697)](_0x3d0a09[_0xcf55bc(0x461)],'zh-CN')),_0xaa5a78['forEach'](_0x2e8e52=>{const _0x49673a=_0xcf55bc;let _0x4d05a7='暂无内容...';if(Array['isArray'](_0x2e8e52[_0x49673a(0x11b6)])&&_0x2e8e52[_0x49673a(0x11b6)]['length']>0x0){const _0xea9479=_0x2e8e52[_0x49673a(0x11b6)][0x0];_0x4d05a7=_0xea9479[_0x49673a(0x125b)]||_0xea9479[_0x49673a(0x11b6)]||'';}else typeof _0x2e8e52[_0x49673a(0x11b6)]==='string'&&_0x2e8e52['content'][_0x49673a(0x1cb)]()!==''&&(_0x4d05a7=_0x2e8e52[_0x49673a(0x11b6)]);const _0x4e6cde=document['createElement']('div');_0x4e6cde[_0x49673a(0x556)]=_0x49673a(0x127d),_0x4e6cde[_0x49673a(0x118)][_0x49673a(0xcaa)]=_0x2e8e52['id'],_0x4e6cde[_0x49673a(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>'+_0x2e8e52[_0x49673a(0x461)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>'+String(_0x4d05a7)['substring'](0x0,0x32)+_0x49673a(0x802),_0x4e6cde[_0x49673a(0x271)](_0x49673a(0x5c7),()=>_0x4dda11(_0x2e8e52['id'])),_0x3e15d1(_0x4e6cde,async()=>{const _0x35e05b=_0x49673a,_0x34338e=await _0x23a88b(_0x35e05b(0x463),_0x35e05b(0xbf6)+_0x2e8e52[_0x35e05b(0x461)]+_0x35e05b(0xb37),{'confirmButtonClass':_0x35e05b(0x51b)});_0x34338e&&(await _0x342df8[_0x35e05b(0xf17)]['delete'](_0x2e8e52['id']),_0x41df36[_0x35e05b(0xf17)]=_0x41df36[_0x35e05b(0xf17)][_0x35e05b(0x98a)](_0xef4077=>_0xef4077['id']!==_0x2e8e52['id']),_0x11e574());}),_0x4d83aa['appendChild'](_0x4e6cde);}),_0x52d02e;}window[_0x549949(0x1f3)]=_0x11e574;async function _0x4dda11(_0x2f840a){const _0x3ccc96=_0x549949;_0x105acd(_0x3ccc96(0x5ff)),_0x5a1c70=_0x2f840a;const [_0x533f93,_0x2b7db5]=await Promise[_0x3ccc96(0x1282)]([_0x342df8['worldBooks']['get'](_0x2f840a),_0x342df8['worldBookCategories'][_0x3ccc96(0x21f)]()]);if(!_0x533f93){console['error'](_0x3ccc96(0x278),_0x2f840a),_0x105acd(_0x3ccc96(0x88e));return;}document[_0x3ccc96(0x383)](_0x3ccc96(0x116d))[_0x3ccc96(0x138e)]=_0x533f93[_0x3ccc96(0x461)],document[_0x3ccc96(0x383)](_0x3ccc96(0xaca))[_0x3ccc96(0x1be)]=_0x533f93[_0x3ccc96(0x461)];const _0x538dae=document[_0x3ccc96(0x383)]('world-book-category-select');_0x538dae[_0x3ccc96(0x45c)]='<option\x20value=\x22\x22>--\x20未分类\x20--</option>',_0x2b7db5[_0x3ccc96(0x19c)](_0x5de448=>{const _0x547a1a=_0x3ccc96,_0x54b4c0=document[_0x547a1a(0xe1b)](_0x547a1a(0x10a0));_0x54b4c0[_0x547a1a(0x1be)]=_0x5de448['id'],_0x54b4c0[_0x547a1a(0x138e)]=_0x5de448[_0x547a1a(0x461)];if(_0x533f93[_0x547a1a(0xba3)]===_0x5de448['id'])_0x54b4c0['selected']=!![];_0x538dae[_0x547a1a(0xe91)](_0x54b4c0);});const _0x75bd66=document['getElementById']('world-book-entries-container');_0x75bd66[_0x3ccc96(0x45c)]='',Array['isArray'](_0x533f93[_0x3ccc96(0x11b6)])&&_0x533f93[_0x3ccc96(0x11b6)]['length']>0x0?_0x533f93[_0x3ccc96(0x11b6)][_0x3ccc96(0x19c)](_0x2ea109=>{const _0x180445=_0x3ccc96,_0x2a8d62=_0x31c05(_0x2ea109);_0x75bd66[_0x180445(0xe91)](_0x2a8d62);}):_0x75bd66['innerHTML']=_0x3ccc96(0x63b);}async function _0x59fe05(_0x35fcd5=!![]){const _0x48f6d7=_0x549949,_0x1cc73a=document[_0x48f6d7(0x383)]('sticker-grid'),_0xd29f34=document[_0x48f6d7(0x383)](_0x48f6d7(0xeb5)),_0x49999c=document[_0x48f6d7(0x383)](_0x48f6d7(0x22d)),_0x34f465=_0x49999c[_0x48f6d7(0x1be)][_0x48f6d7(0x1cb)]()[_0x48f6d7(0x189)]();if(_0x35fcd5){_0xd29f34[_0x48f6d7(0x45c)]='';const _0x562697=await _0x342df8[_0x48f6d7(0x72d)][_0x48f6d7(0x21f)]();_0xd29f34['innerHTML']+=_0x48f6d7(0x122e)+(_0x45a6e6===_0x48f6d7(0x1282)?_0x48f6d7(0xde5):'')+_0x48f6d7(0x102),_0x562697[_0x48f6d7(0x19c)](_0x523fde=>{const _0x4c297e=_0x48f6d7;_0xd29f34[_0x4c297e(0x45c)]+=_0x4c297e(0x122e)+(_0x45a6e6===_0x523fde['id']?_0x4c297e(0xde5):'')+_0x4c297e(0x386)+_0x523fde['id']+'\x22>'+_0x523fde[_0x4c297e(0x461)]+'</button>';}),_0xd29f34[_0x48f6d7(0x45c)]+=_0x48f6d7(0x122e)+(_0x45a6e6===_0x48f6d7(0x1289)?_0x48f6d7(0xde5):'')+_0x48f6d7(0xb7);}_0x1cc73a[_0x48f6d7(0x45c)]='';let _0x5bfe9e;if(_0x45a6e6===_0x48f6d7(0x1282))_0x5bfe9e=_0x41df36[_0x48f6d7(0x823)];else _0x45a6e6===_0x48f6d7(0x1289)?_0x5bfe9e=_0x41df36['userStickers'][_0x48f6d7(0x98a)](_0x328c98=>!_0x328c98['categoryId']):_0x5bfe9e=_0x41df36[_0x48f6d7(0x823)][_0x48f6d7(0x98a)](_0xaecbfc=>_0xaecbfc['categoryId']===_0x45a6e6);const _0x3cbe4a=_0x34f465?_0x5bfe9e[_0x48f6d7(0x98a)](_0x4a98e3=>_0x4a98e3[_0x48f6d7(0x461)][_0x48f6d7(0x189)]()['includes'](_0x34f465)):_0x5bfe9e;if(_0x3cbe4a[_0x48f6d7(0xfde)]===0x0){const _0x565645=_0x34f465?'找不到匹配的表情':'这个分类下还没有表情哦~';_0x1cc73a[_0x48f6d7(0x45c)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>'+_0x565645+_0x48f6d7(0x29a);return;}_0x3cbe4a[_0x48f6d7(0x19c)](_0x340be1=>{const _0xe505c=_0x48f6d7,_0x46d6f3=document[_0xe505c(0xe1b)](_0xe505c(0x7fd));_0x46d6f3[_0xe505c(0x556)]=_0xe505c(0x194),_0x46d6f3[_0xe505c(0xf3a)]=_0x340be1[_0xe505c(0x461)],_0x46d6f3[_0xe505c(0x118)]['stickerId']=_0x340be1['id'],_0x46d6f3[_0xe505c(0x45c)]=_0xe505c(0x3ff)+_0x340be1['url']+_0xe505c(0xc5)+_0x340be1[_0xe505c(0x461)]+_0xe505c(0xf79),_0x46d6f3[_0xe505c(0x271)](_0xe505c(0x5c7),()=>{_0x10f4b7?_0x29bced(_0x46d6f3):_0x1788df(_0x340be1);});const _0xe0552a=document[_0xe505c(0xe1b)](_0xe505c(0x7fd));_0xe0552a[_0xe505c(0x556)]='delete-btn',_0xe0552a[_0xe505c(0x45c)]='&times;',_0xe0552a[_0xe505c(0xc50)]=async _0x1b8075=>{const _0x32de1f=_0xe505c;_0x1b8075[_0x32de1f(0x1311)]();const _0x3cbc94=await _0x23a88b(_0x32de1f(0x44f),'确定要删除表情\x20\x22'+_0x340be1[_0x32de1f(0x461)]+_0x32de1f(0x183),{'confirmButtonClass':_0x32de1f(0x51b)});_0x3cbc94&&(await _0x342df8['userStickers'][_0x32de1f(0x971)](_0x340be1['id']),_0x41df36[_0x32de1f(0x823)]=_0x41df36['userStickers']['filter'](_0x4b61b8=>_0x4b61b8['id']!==_0x340be1['id']),_0x59fe05());},_0x46d6f3[_0xe505c(0xe91)](_0xe0552a),_0x1cc73a[_0xe505c(0xe91)](_0x46d6f3);});}let _0x10f4b7=![],_0x624584=new Set();function _0x40ba5a(){const _0x8586c7=_0x549949;_0x10f4b7=!_0x10f4b7;const _0xd136bf=document['getElementById'](_0x8586c7(0x299)),_0x33855f=document[_0x8586c7(0x383)]('manage-stickers-btn'),_0x415d4e=document[_0x8586c7(0x383)]('sticker-action-bar'),_0xde0c36=document[_0x8586c7(0x383)](_0x8586c7(0xdb2));_0xd136bf['classList'][_0x8586c7(0x8f0)](_0x8586c7(0x59f),_0x10f4b7),_0x10f4b7?(_0x33855f['textContent']='完成',_0x415d4e[_0x8586c7(0x655)][_0x8586c7(0x2b6)]=_0x8586c7(0x2aa),_0x624584[_0x8586c7(0x4b8)](),_0xde0c36[_0x8586c7(0x2a3)]=![],_0x191950()):(_0x33855f[_0x8586c7(0x138e)]='管理',_0x415d4e[_0x8586c7(0x655)][_0x8586c7(0x2b6)]=_0x8586c7(0xa70),_0xd136bf['querySelectorAll'](_0x8586c7(0x745))[_0x8586c7(0x19c)](_0x51e77e=>_0x51e77e[_0x8586c7(0x119a)]['remove'](_0x8586c7(0x35e))));}function _0x2b8bed(){const _0x38fac2=_0x549949,_0x397f2a=document['getElementById'](_0x38fac2(0xdb2)),_0x2fcc3f=_0x397f2a[_0x38fac2(0x2a3)];let _0x23646c;if(_0x45a6e6===_0x38fac2(0x1282))_0x23646c=_0x41df36[_0x38fac2(0x823)];else _0x45a6e6===_0x38fac2(0x1289)?_0x23646c=_0x41df36['userStickers'][_0x38fac2(0x98a)](_0x4c05da=>!_0x4c05da[_0x38fac2(0xba3)]):_0x23646c=_0x41df36['userStickers'][_0x38fac2(0x98a)](_0x565394=>_0x565394['categoryId']===_0x45a6e6);_0x23646c[_0x38fac2(0x19c)](_0x430b3d=>{const _0x11a129=_0x38fac2,_0x404de8=_0x430b3d['id'],_0x3c0d01=document[_0x11a129(0x89c)](_0x11a129(0x806)+_0x404de8+'\x22]');if(_0x2fcc3f){_0x624584['add'](_0x404de8);if(_0x3c0d01)_0x3c0d01[_0x11a129(0x119a)][_0x11a129(0xbff)](_0x11a129(0x35e));}else{_0x624584[_0x11a129(0x971)](_0x404de8);if(_0x3c0d01)_0x3c0d01[_0x11a129(0x119a)][_0x11a129(0x131d)](_0x11a129(0x35e));}}),_0x191950();}function _0x191950(){const _0x18c18e=_0x549949,_0x1b6550=document['getElementById'](_0x18c18e(0xd8a));_0x1b6550['textContent']='删除\x20('+_0x624584['size']+')';}function _0x29bced(_0x1fedfa){const _0x35578c=_0x549949;if(!_0x10f4b7)return;const _0x5a5992=_0x1fedfa[_0x35578c(0x118)]['stickerId'];if(!_0x5a5992)return;_0x1fedfa[_0x35578c(0x119a)][_0x35578c(0x8f0)](_0x35578c(0x35e)),_0x624584[_0x35578c(0xcde)](_0x5a5992)?_0x624584[_0x35578c(0x971)](_0x5a5992):_0x624584[_0x35578c(0xbff)](_0x5a5992),_0x191950();}async function _0x56c34b(){const _0x1809af=_0x549949;if(_0x624584[_0x1809af(0x1240)]===0x0)return;const _0x3e190d=await _0x23a88b(_0x1809af(0x615),_0x1809af(0xb8c)+_0x624584[_0x1809af(0x1240)]+'\x20个表情吗？此操作不可恢复。',{'confirmButtonClass':_0x1809af(0x51b)});if(_0x3e190d){const _0x56dc80=[..._0x624584];await _0x342df8[_0x1809af(0x823)]['bulkDelete'](_0x56dc80),_0x41df36[_0x1809af(0x823)]=_0x41df36[_0x1809af(0x823)][_0x1809af(0x98a)](_0x2e8309=>!_0x56dc80[_0x1809af(0xee2)](_0x2e8309['id'])),_0x40ba5a(),_0x59fe05(),await _0x296ef9(_0x1809af(0xa04),_0x1809af(0x9a));}}async function _0x521c50(){const _0x21b858=_0x549949,_0x53b490=_0x21b858(0x1278),_0x56e47c=await _0x12e332(_0x21b858(0x306),_0x53b490,'',_0x21b858(0xfe5));_0x56e47c&&_0x56e47c[_0x21b858(0x1cb)]()&&await _0x2f8b7b(_0x56e47c);}async function _0x2f8b7b(_0x5782e7){const _0x5890a4=_0x549949,_0x468226=_0x5782e7[_0x5890a4(0x1cb)]()[_0x5890a4(0x105d)]('\x0a'),_0x4302c4=[],_0x250fdb=_0x5890a4(0x10d);let _0x591254=0x0;const _0xef7efc=_0x45a6e6!==_0x5890a4(0x1282)&&_0x45a6e6!==_0x5890a4(0x1289)?_0x45a6e6:null;for(const _0xf41a8a of _0x468226){const _0x54e927=_0xf41a8a[_0x5890a4(0x1cb)]();if(!_0x54e927||_0x54e927[_0x5890a4(0xee2)]('填入'))continue;const _0xb6bfa1=_0x54e927[_0x5890a4(0x22e)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0xb6bfa1){const _0x59a8b3=_0xb6bfa1[0x1][_0x5890a4(0x1cb)](),_0x2562d6=_0xb6bfa1[0x2][_0x5890a4(0x1cb)]();_0x4302c4[_0x5890a4(0x258)]({'id':_0x5890a4(0x49d)+Date[_0x5890a4(0x108d)]()+Math[_0x5890a4(0x5ce)](),'name':_0x59a8b3,'url':_0x2562d6,'categoryId':_0xef7efc});continue;}let _0x4699d7=null,_0x26c5df=null;const _0xe05475=_0x54e927['match'](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0xe05475)_0x4699d7=_0xe05475[0x1],_0x26c5df=_0xe05475[0x2];else{const _0x420615=_0x54e927[_0x5890a4(0x105d)](/\s+/);_0x420615[_0x5890a4(0xfde)]>=0x2&&(_0x26c5df=_0x420615['pop'](),_0x4699d7=_0x420615[_0x5890a4(0xa35)]('\x20'));}_0x4699d7&&_0x26c5df&&_0x26c5df[_0x5890a4(0xee2)]('.')?_0x4302c4['push']({'id':_0x5890a4(0x49d)+Date[_0x5890a4(0x108d)]()+Math['random'](),'name':_0x4699d7,'url':_0x250fdb+_0x26c5df,'categoryId':_0xef7efc}):(_0x591254++,console[_0x5890a4(0x17b)](_0x5890a4(0xcb6),_0x54e927));}_0x591254>0x0&&await _0x296ef9('部分导入失败','有\x20'+_0x591254+_0x5890a4(0xb5d));if(_0x4302c4[_0x5890a4(0xfde)]>0x0)await _0x342df8[_0x5890a4(0x823)]['bulkAdd'](_0x4302c4),_0x41df36[_0x5890a4(0x823)]['push'](..._0x4302c4),_0x59fe05(),await _0x296ef9('导入成功',_0x5890a4(0x4ea)+_0x4302c4['length']+_0x5890a4(0xddd));else _0x591254===0x0&&alert('没有找到可导入的内容。请检查您粘贴的格式是否正确。');}function _0x110168(_0x3c1e4c){const _0x5c4a1e=_0x549949,_0x5da209=_0x5c4a1e(0x1110)+_0x3c1e4c+'\x22]',_0x2e88ab=document[_0x5c4a1e(0x89c)](_0x5da209);_0x2e88ab?(_0x2e88ab[_0x5c4a1e(0x447)]({'behavior':'smooth','block':'center'}),_0x2e88ab[_0x5c4a1e(0x119a)]['add'](_0x5c4a1e(0x126d)),setTimeout(()=>{const _0x18290d=_0x5c4a1e;document['body'][_0x18290d(0x987)](_0x2e88ab)&&_0x2e88ab['classList'][_0x18290d(0x131d)](_0x18290d(0x126d));},0x5dc)):alert(_0x5c4a1e(0xe05));}async function _0x152d98(_0x43224b,_0x4597eb){const _0x1f766e=_0x549949;if(_0x43224b['type']==='recalled_message'){const _0x52d747=document[_0x1f766e(0xe1b)]('div');_0x52d747[_0x1f766e(0x556)]=_0x1f766e(0x6bf),_0x52d747[_0x1f766e(0x118)][_0x1f766e(0x3b7)]=_0x43224b['timestamp'];const _0x5879db=document[_0x1f766e(0xe1b)]('div');return _0x5879db['className']=_0x1f766e(0xccd),_0x5879db[_0x1f766e(0x118)][_0x1f766e(0x3b7)]=_0x43224b[_0x1f766e(0x3b7)],_0x5879db[_0x1f766e(0x138e)]=_0x43224b[_0x1f766e(0x11b6)],_0x52d747['appendChild'](_0x5879db),_0x3e15d1(_0x52d747,()=>_0xe2646(_0x43224b[_0x1f766e(0x3b7)])),_0x52d747[_0x1f766e(0x271)](_0x1f766e(0x5c7),()=>{const _0xe46662=_0x1f766e;_0x80fd3b&&_0x4c3eff(_0x43224b[_0xe46662(0x3b7)]);}),_0x52d747;}else{if(_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0x5ca)){const _0x978aed=document[_0x1f766e(0xe1b)](_0x1f766e(0x7fd));_0x978aed[_0x1f766e(0x556)]=_0x1f766e(0x6bf),_0x978aed[_0x1f766e(0x118)][_0x1f766e(0x3b7)]=_0x43224b[_0x1f766e(0x3b7)];const _0x3b3c8b=document[_0x1f766e(0xe1b)](_0x1f766e(0x7fd));return _0x3b3c8b['className']=_0x1f766e(0x470),_0x3b3c8b[_0x1f766e(0x118)][_0x1f766e(0x6b1)]=_0x43224b['postId'],_0x3b3c8b[_0x1f766e(0x138e)]=_0x43224b['content'],_0x978aed[_0x1f766e(0xe91)](_0x3b3c8b),_0x3e15d1(_0x978aed,()=>_0xe2646(_0x43224b['timestamp'])),_0x978aed[_0x1f766e(0x271)](_0x1f766e(0x5c7),()=>{const _0xc62f82=_0x1f766e;_0x80fd3b&&_0x4c3eff(_0x43224b[_0xc62f82(0x3b7)]);}),_0x978aed;}}if(_0x43224b[_0x1f766e(0xbc5)])return null;if(_0x43224b['type']===_0x1f766e(0xed8)){const _0xb89b6b=document[_0x1f766e(0xe1b)]('div');_0xb89b6b[_0x1f766e(0x556)]=_0x1f766e(0x6bf);const _0x196130=document[_0x1f766e(0xe1b)]('div');return _0x196130['className']=_0x1f766e(0xb24),_0x196130[_0x1f766e(0x118)][_0x1f766e(0x3b7)]=_0x43224b[_0x1f766e(0x3b7)],_0x196130[_0x1f766e(0x138e)]=_0x43224b[_0x1f766e(0x11b6)],_0xb89b6b[_0x1f766e(0xe91)](_0x196130),_0x3e15d1(_0xb89b6b,()=>_0xe2646(_0x43224b[_0x1f766e(0x3b7)])),_0xb89b6b['addEventListener'](_0x1f766e(0x5c7),()=>{if(_0x80fd3b)_0x4c3eff(_0x43224b['timestamp']);}),_0xb89b6b;}const _0x244f4e=_0x43224b[_0x1f766e(0x10ff)]==='user',_0x59debe=_0x4597eb[_0x1f766e(0x886)][_0x1f766e(0x52e)]||'我',_0x3fb333=document[_0x1f766e(0xe1b)]('div');_0x3fb333[_0x1f766e(0x556)]='message-wrapper\x20'+(_0x244f4e?_0x1f766e(0x66e):'ai');if(_0x4597eb[_0x1f766e(0x1a2)]&&!_0x244f4e){const _0x2ba70e=_0x4597eb[_0x1f766e(0x12a6)][_0x1f766e(0xd12)](_0x56cedf=>_0x56cedf[_0x1f766e(0x283)]===_0x43224b['senderName']),_0x4271a5=document[_0x1f766e(0xe1b)](_0x1f766e(0x7fd));_0x4271a5[_0x1f766e(0x556)]=_0x1f766e(0xce5),_0x4271a5[_0x1f766e(0x138e)]=_0x2ba70e?_0x2ba70e['groupNickname']:_0x43224b[_0x1f766e(0x4c5)]||'未知成员',_0x3fb333[_0x1f766e(0xe91)](_0x4271a5);}const _0x4f9d69=document[_0x1f766e(0xe1b)](_0x1f766e(0x7fd));_0x4f9d69[_0x1f766e(0x556)]=_0x1f766e(0x419)+(_0x244f4e?_0x1f766e(0x66e):'ai'),_0x4f9d69['dataset'][_0x1f766e(0x3b7)]=_0x43224b[_0x1f766e(0x3b7)];const _0x29217d=document['createElement'](_0x1f766e(0xc0e));_0x29217d[_0x1f766e(0x556)]=_0x1f766e(0x3b7),_0x29217d['textContent']=_0x3f0b6d(_0x43224b[_0x1f766e(0x3b7)]);let _0x101ea1,_0x3a9df7='';if(_0x244f4e)_0x101ea1=_0x4597eb['settings'][_0x1f766e(0x43a)]||(_0x4597eb[_0x1f766e(0x1a2)]?_0x188ace:_0x5dc108),_0x3a9df7=_0x4597eb[_0x1f766e(0x886)][_0x1f766e(0x519)]||'';else{if(_0x4597eb[_0x1f766e(0x1a2)]){const _0x42671b=_0x4597eb[_0x1f766e(0x12a6)][_0x1f766e(0xd12)](_0x5a818e=>_0x5a818e[_0x1f766e(0x283)]===_0x43224b['senderName']);if(_0x42671b){const _0x2cb01e=_0x41df36['chats'][_0x42671b['id']];_0x101ea1=_0x42671b['avatar']||(_0x2cb01e?_0x2cb01e[_0x1f766e(0x886)][_0x1f766e(0x121e)]:_0x59100f),_0x3a9df7=_0x42671b['avatarFrame']||(_0x2cb01e?_0x2cb01e['settings'][_0x1f766e(0x957)]:'');}else _0x101ea1=_0x59100f,_0x3a9df7='';}else _0x101ea1=_0x4597eb[_0x1f766e(0x886)]['aiAvatar']||_0x5dc108,_0x3a9df7=_0x4597eb[_0x1f766e(0x886)][_0x1f766e(0x957)]||'';}let _0x7aab4a;_0x3a9df7?_0x7aab4a='<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22'+_0x101ea1+_0x1f766e(0x75d)+_0x3a9df7+'\x22\x20class=\x22avatar-frame\x22></div>':_0x7aab4a='<img\x20src=\x22'+_0x101ea1+'\x22\x20class=\x22avatar\x22>';const _0x57529f=_0x3a9df7?_0x1f766e(0xac1):'',_0x5cfda4=_0x1f766e(0x1dc)+_0x57529f+'\x22>'+_0x7aab4a+_0x1f766e(0x69b);let _0x2a64df,_0x367a70='';if(_0x43224b[_0x1f766e(0x8ff)]){const _0x441fb4=_0x54d0ab(_0x4597eb,_0x43224b[_0x1f766e(0x8ff)][_0x1f766e(0x4c5)]),_0x291a80=String(_0x43224b[_0x1f766e(0x8ff)][_0x1f766e(0x11b6)]||'');_0x367a70='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22'+_0x43224b['quote'][_0x1f766e(0x3b7)]+_0x1f766e(0x353)+_0x441fb4+_0x1f766e(0x11b4)+_0x291a80+_0x1f766e(0x253);}let _0x47eb56=_0x43224b[_0x1f766e(0x11b6)];if(typeof _0x47eb56===_0x1f766e(0xafa)&&_0x47eb56[_0x1f766e(0x1cb)]()[_0x1f766e(0x1122)]('<')&&_0x47eb56[_0x1f766e(0x1cb)]()[_0x1f766e(0xd47)]('>'))_0x2a64df=_0x47eb56,_0x4f9d69[_0x1f766e(0x119a)][_0x1f766e(0xbff)]('is-raw-html');else{if(_0x43224b['type']==='offline_text'||_0x43224b['type']===_0x1f766e(0x94a)||_0x43224b[_0x1f766e(0xa6b)]==='share_card'||_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0x15a)||_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0x1050)||_0x43224b['type']==='user_photo'||_0x43224b['type']==='voice_message'||_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0x909)||_0x43224b['type']===_0x1f766e(0x990)||_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0xd65)||_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0xf55)||_0x43224b['type']==='poll'||_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0x980)||_0x43224b['type']==='realimag'||_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0x7f4)){if(_0x43224b['type']===_0x1f766e(0x44e)){const _0x358828=_0x43224b['content']||((_0x43224b[_0x1f766e(0x5ed)]||'')+'\x20'+(_0x43224b[_0x1f766e(0xee1)]||''))[_0x1f766e(0x1cb)](),_0x3811a3=/(「.*?」|“.*?”)/g,_0x449030=_0x358828[_0x1f766e(0x105d)](_0x3811a3)['filter'](_0x175e44=>_0x175e44);_0x2a64df=_0x449030[_0x1f766e(0xa79)](_0x48cc3d=>{const _0x2572c7=_0x1f766e;return _0x48cc3d[_0x2572c7(0x1122)]('「')||_0x48cc3d['startsWith']('“')?_0x2572c7(0xa16)+_0x350d3e(_0x48cc3d)+_0x2572c7(0xd74):_0x2572c7(0x9df)+_0x350d3e(_0x48cc3d[_0x2572c7(0x1cb)]())[_0x2572c7(0x709)](/\n/g,_0x2572c7(0x3ee))+_0x2572c7(0xd74);})[_0x1f766e(0xa35)]('');}else{if(_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0x94a))_0x4f9d69[_0x1f766e(0x119a)]['add'](_0x1f766e(0x7d0),_0x1f766e(0x611)),_0x2a64df=_0x1f766e(0xcb2)+_0x43224b[_0x1f766e(0x3b7)]+'\x22><div\x20class=\x22title\x22>'+(_0x43224b[_0x1f766e(0xf3a)]||_0x1f766e(0xdff))+'</div><div\x20class=\x22description\x22>'+(_0x43224b['description']||_0x1f766e(0x60d))+_0x1f766e(0x5b7)+(_0x43224b[_0x1f766e(0x8d4)]||_0x1f766e(0x4de))+_0x1f766e(0x736);else{if(_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0xf99))_0x4f9d69[_0x1f766e(0x119a)][_0x1f766e(0xbff)](_0x1f766e(0x7d0),'is-card-like'),_0x2a64df=_0x1f766e(0xedb)+_0x43224b[_0x1f766e(0x3b7)]+_0x1f766e(0xb9c)+_0x43224b[_0x1f766e(0xd32)][_0x1f766e(0xf3a)]+'</div><div\x20class=\x22description\x22>共\x20'+_0x43224b[_0x1f766e(0xd32)]['sharedHistory'][_0x1f766e(0xfde)]+_0x1f766e(0x1183);else{if(_0x43224b['type']==='location_share'){_0x4f9d69['classList']['add'](_0x1f766e(0xb6d),_0x1f766e(0x611));let _0x28784c;if(_0x43224b[_0x1f766e(0xa94)])_0x28784c=_0x43224b[_0x1f766e(0xa94)];else _0x41df36[_0x1f766e(0xc0)]['enableAiDrawing']&&_0x43224b[_0x1f766e(0x8d8)]?_0x28784c='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x43224b['image_prompt']):_0x28784c=_0x1f766e(0x3cc);const _0x529660=_0x1f766e(0xe14)+_0x28784c+'\x27);\x22';_0x2a64df='<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>'+_0x43224b['content']+_0x1f766e(0x2dd)+_0x529660+_0x1f766e(0x8aa);}else{if(_0x43224b['type']===_0x1f766e(0xed0)||_0x43224b['type']==='ai_image'){_0x4f9d69[_0x1f766e(0x119a)]['add'](_0x1f766e(0x2d3),'is-card-like');const _0x494561=_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0xed0)?_0x1f766e(0xb02):_0x1f766e(0xc13),_0x3de526=_0x41df36['globalSettings']['enableAiDrawing']&&_0x43224b[_0x1f766e(0x8d8)]?'https://image.pollinations.ai/prompt/'+_0x43224b[_0x1f766e(0x8d8)]:_0x1f766e(0xbed);_0x2a64df=_0x1f766e(0xf8a)+_0x3de526+'\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22'+_0x494561+_0x1f766e(0x53a)+_0x43224b[_0x1f766e(0x11b6)]+'\x22>';}else{if(_0x43224b['type']===_0x1f766e(0x7f4))_0x4f9d69[_0x1f766e(0x119a)]['add'](_0x1f766e(0xdcc),'is-card-like'),_0x2a64df=_0x1f766e(0xf8a)+_0x43224b[_0x1f766e(0xa94)]+_0x1f766e(0x96c)+(_0x43224b[_0x1f766e(0x12fc)]||_0x43224b['prompt']||_0x1f766e(0xa1d))+'\x22>';else{if(_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0xa4f)){_0x4f9d69[_0x1f766e(0x119a)][_0x1f766e(0xbff)]('is-voice-message',_0x1f766e(0x611));const _0xb1248b=Math[_0x1f766e(0xaf3)](0x1,Math[_0x1f766e(0xe3c)]((_0x43224b[_0x1f766e(0x11b6)]||'')['length']/0x5)),_0x3546e3='0:'+String(_0xb1248b)['padStart'](0x2,'0')+'\x27\x27',_0x1b9d22=_0x1f766e(0x962);if(_0x244f4e)_0x2a64df=_0x1f766e(0xfca)+encodeURIComponent(_0x43224b[_0x1f766e(0x11b6)])+_0x1f766e(0x1328)+_0x1b9d22+_0x1f766e(0x70f)+_0x3546e3+_0x1f766e(0x90f);else{const _0x395c6a=!_0x4597eb['isGroup']&&_0x4597eb['settings'][_0x1f766e(0xa7f)]!==![],_0x1735c0=_0x4597eb[_0x1f766e(0x886)][_0x1f766e(0xad0)]||_0x1f766e(0xe0f),_0x18eb71=_0x395c6a?_0x1f766e(0x11fb)+_0x1735c0+'\x22':'';_0x2a64df=_0x1f766e(0xfca)+encodeURIComponent(_0x43224b['content'])+'\x22\x20'+_0x18eb71+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>'+_0x1b9d22+_0x1f766e(0x9af)+_0x3546e3+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}else{if(_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0x909)){_0x4f9d69[_0x1f766e(0x119a)][_0x1f766e(0xbff)](_0x1f766e(0x3c2),_0x1f766e(0x611));let _0x18117f,_0x4dee18;const _0x3f5909=_0x4597eb['isGroup']?_0x4597eb['settings'][_0x1f766e(0x52e)]||'我':'我',_0x188882=_0x54d0ab(_0x4597eb,_0x43224b['senderName']),_0x1db547=_0x54d0ab(_0x4597eb,_0x43224b[_0x1f766e(0x30f)]||_0x4597eb[_0x1f766e(0x461)]);if(_0x244f4e){if(_0x43224b[_0x1f766e(0xf8c)])_0x18117f=_0x1f766e(0x509)+_0x1db547,_0x4dee18=_0x1f766e(0x951);else{_0x18117f=_0x1f766e(0xb7d)+_0x1db547;if(_0x43224b[_0x1f766e(0x1fe)]===_0x1f766e(0x4f3))_0x4dee18=_0x1f766e(0x86f);else{if(_0x43224b['status']===_0x1f766e(0xfd2))_0x4dee18='对方已拒收';else _0x4dee18=_0x43224b[_0x1f766e(0x775)]||'等待对方处理...';}}}else{if(_0x43224b[_0x1f766e(0xf8c)])_0x18117f='退款来自\x20'+_0x188882,_0x4dee18=_0x1f766e(0x12c0);else{if(_0x43224b[_0x1f766e(0x30f)]===_0x3f5909){_0x18117f=_0x1f766e(0xb7d)+_0x3f5909;if(_0x43224b[_0x1f766e(0x1fe)]===_0x1f766e(0x4f3))_0x4dee18='你已收款';else{if(_0x43224b[_0x1f766e(0x1fe)]===_0x1f766e(0xfd2))_0x4dee18=_0x1f766e(0x822);else _0x4f9d69[_0x1f766e(0x655)][_0x1f766e(0x81e)]=_0x1f766e(0x8a0),_0x4f9d69['dataset'][_0x1f766e(0x1fe)]='pending',_0x4dee18=_0x43224b[_0x1f766e(0x775)]||_0x1f766e(0x39c);}}else _0x18117f='转账:\x20'+_0x188882+_0x1f766e(0x8dd)+_0x1db547,_0x4dee18=_0x43224b[_0x1f766e(0x775)]||'群聊内转账';}}const _0x594215='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>';_0x2a64df=_0x1f766e(0x128c)+_0x594215+'\x20'+_0x18117f+_0x1f766e(0x520)+Number(_0x43224b['amount'])[_0x1f766e(0x70d)](0x2)+_0x1f766e(0xf0e)+_0x4dee18+'</div></div>';}else{if(_0x43224b['type']===_0x1f766e(0x990)){_0x4f9d69[_0x1f766e(0x119a)]['add'](_0x1f766e(0xe0d),'is-card-like');if(_0x43224b[_0x1f766e(0x1fe)]===_0x1f766e(0x96d)||_0x43224b['status']===_0x1f766e(0x5d1))_0x4f9d69[_0x1f766e(0x119a)][_0x1f766e(0xbff)](_0x1f766e(0xfd8)+_0x43224b['status']);const _0x5e1695=_0x54d0ab(_0x4597eb,_0x43224b['senderName']),_0x426e86=_0x1f766e(0x1097)+_0x5e1695+_0x1f766e(0xddb);let _0xd5d0a2='';_0x43224b['status']===_0x1f766e(0x1ad)&&!_0x244f4e&&(_0xd5d0a2=_0x1f766e(0xeb1)),_0x2a64df=_0x1f766e(0x875)+_0x426e86+_0x1f766e(0x11b5)+Number(_0x43224b[_0x1f766e(0xe27)])[_0x1f766e(0x70d)](0x2)+'</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-'+_0x43224b[_0x1f766e(0x3b7)]+'\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>'+_0xd5d0a2+_0x1f766e(0x69b),setTimeout(()=>{const _0x126f7c=_0x1f766e;if(_0x43224b[_0x126f7c(0x1fe)]===_0x126f7c(0x1ad)){const _0x10360b=document[_0x126f7c(0x383)](_0x126f7c(0xbf8)+_0x43224b['timestamp']);if(_0x10360b){const _0xb7ba31=_0x5cd583(_0x10360b,_0x43224b[_0x126f7c(0x128a)]);_0x33206f[_0x43224b[_0x126f7c(0x3b7)]]=_0xb7ba31;}}},0x0);}else{if(_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0xd65)){_0x4f9d69[_0x1f766e(0x119a)]['add'](_0x1f766e(0xe0d),_0x1f766e(0x611));const _0x41203d=_0x54d0ab(_0x4597eb,_0x43224b[_0x1f766e(0x4c5)]);let _0x3fcc23='你';_0x4597eb[_0x1f766e(0x1a2)]&&(_0x3fcc23=_0x54d0ab(_0x4597eb,_0x43224b[_0x1f766e(0x2a5)])),_0x2a64df=_0x1f766e(0xc01)+_0x41203d+'\x20已为'+_0x3fcc23+'下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>'+_0x43224b[_0x1f766e(0x12b1)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥'+Number(_0x43224b['amount'])[_0x1f766e(0x70d)](0x2)+_0x1f766e(0x754);}else{if(_0x43224b[_0x1f766e(0xa6b)]===_0x1f766e(0xf55)){_0x4f9d69['classList'][_0x1f766e(0xbff)]('is-red-packet',_0x1f766e(0x611));const _0x39edd2=_0x41df36['qzoneSettings']['nickname']||_0x1f766e(0x7da),_0x200dcc=_0x43224b['isFullyClaimed'],_0x3340d7=_0x43224b[_0x1f766e(0xb39)]&&_0x43224b[_0x1f766e(0xb39)][_0x39edd2];let _0x55d1ac='',_0x1f8185='',_0x16344f=_0x1f766e(0xa4d);_0x200dcc&&(_0x55d1ac=_0x1f766e(0x21c));if(_0x43224b[_0x1f766e(0x1350)]===_0x1f766e(0xe0e)){const _0x59e601=_0x54d0ab(_0x4597eb,_0x43224b[_0x1f766e(0x30f)]);_0x16344f='专属红包:\x20给\x20'+_0x59e601;if(Object['keys'](_0x43224b[_0x1f766e(0xb39)]||{})[_0x1f766e(0xfde)]>0x0)_0x55d1ac=_0x1f766e(0x21c);}if(_0x3340d7){const _0x29b6d1=_0x43224b[_0x1f766e(0xb39)][_0x39edd2]||0x0;_0x1f8185=_0x1f766e(0xa15)+_0x29b6d1[_0x1f766e(0x70d)](0x2)+_0x1f766e(0xbac);}else{if(_0x200dcc)_0x1f8185=_0x1f766e(0x8a2);else{if(_0x43224b[_0x1f766e(0x1350)]==='direct'&&Object['keys'](_0x43224b['claimedBy']||{})['length']>0x0){const _0x3e2203=_0x54d0ab(_0x4597eb,_0x43224b['receiverName']);_0x1f8185='<div\x20class=\x22rp-claimed-info\x22>已被\x20'+_0x3e2203+'\x20领取</div>';}}}_0x2a64df=_0x1f766e(0x4ce)+_0x55d1ac+_0x1f766e(0xf6b)+(_0x43224b[_0x1f766e(0xe12)]||'恭喜发财，大吉大利！')+_0x1f766e(0xf70)+_0x16344f+_0x1f766e(0x69b)+_0x1f8185+_0x1f766e(0x69b);}else{if(_0x43224b['type']===_0x1f766e(0x11b9)){_0x4f9d69[_0x1f766e(0x119a)][_0x1f766e(0xbff)](_0x1f766e(0xe5e),_0x1f766e(0x611));const _0x4b7be7=_0x43224b[_0x1f766e(0xca8)]||_0x43224b[_0x1f766e(0x11b6)]||_0x1f766e(0x2ea);let _0x377149=0x0;const _0x1cbb4e={};for(const _0x8f3d9d in _0x43224b[_0x1f766e(0x1385)]){const _0x12dab4=_0x43224b[_0x1f766e(0x1385)][_0x8f3d9d][_0x1f766e(0xfde)];_0x1cbb4e[_0x8f3d9d]=_0x12dab4,_0x377149+=_0x12dab4;}const _0x1db508=_0x41df36[_0x1f766e(0x571)][_0x1f766e(0xabb)]||_0x1f766e(0x7da);let _0x30c6e3=null;for(const _0x53b032 in _0x43224b['votes']){if(_0x43224b[_0x1f766e(0x1385)][_0x53b032][_0x1f766e(0xee2)](_0x1db508)){_0x30c6e3=_0x53b032;break;}}let _0x582e07='<div\x20class=\x22poll-options-list\x22>';_0x43224b[_0x1f766e(0x904)][_0x1f766e(0x19c)](_0x10e9aa=>{const _0x5c8204=_0x1f766e,_0x352867=_0x1cbb4e[_0x10e9aa]||0x0,_0x3e78dc=_0x377149>0x0?_0x352867/_0x377149*0x64:0x0,_0x1efe0d=_0x30c6e3===_0x10e9aa;_0x582e07+='<div\x20class=\x22poll-option-item\x20'+(_0x1efe0d?_0x5c8204(0x850):'')+_0x5c8204(0x8cc)+_0x10e9aa+_0x5c8204(0x100c)+_0x3e78dc+_0x5c8204(0x1164)+_0x10e9aa+'</span><span\x20class=\x22poll-option-votes\x22>'+_0x352867+_0x5c8204(0x2e1);}),_0x582e07+='</div>';let _0x2bc5a6=_0x43224b['isClosed']?_0x1f766e(0x4c3)+_0x377149+_0x1f766e(0xb5f):_0x1f766e(0x4c3)+_0x377149+'\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>';_0x2a64df=_0x1f766e(0x6b2)+(_0x43224b[_0x1f766e(0xa17)]?_0x1f766e(0x3a6):'')+_0x1f766e(0x933)+_0x43224b['timestamp']+_0x1f766e(0x296)+_0x4b7be7+_0x1f766e(0x69b)+_0x582e07+_0x2bc5a6+'</div>';}else{if(_0x43224b[_0x1f766e(0xa6b)]==='gift'){_0x4f9d69[_0x1f766e(0x119a)][_0x1f766e(0xbff)](_0x1f766e(0x24f),'is-card-like');let _0x27d692;const _0xd4cd27=_0x4597eb[_0x1f766e(0x886)]['myNickname']||'我';if(_0x4597eb[_0x1f766e(0x1a2)]){if(_0x43224b['recipients']&&_0x43224b[_0x1f766e(0xbdb)][_0x1f766e(0xfde)]>0x0){const _0x5b32fb=_0x43224b[_0x1f766e(0xbdb)]['map'](_0x583d99=>_0x54d0ab(_0x4597eb,_0x583d99));_0x5b32fb[_0x1f766e(0xfde)]===0x1?_0x27d692=_0x1f766e(0xa68)+_0x5b32fb[0x0]+_0x1f766e(0x216):_0x27d692=_0x1f766e(0xa68)+_0x5b32fb[_0x1f766e(0x1368)](0x0,0x2)[_0x1f766e(0xa35)]('、')+_0x1f766e(0x48d);}else _0x27d692=_0x1f766e(0x90a);}else{if(_0x244f4e)_0x27d692=_0x1f766e(0xa68)+_0x4597eb['name']+_0x1f766e(0x216);else{const _0x1820cf=_0x4597eb[_0x1f766e(0x886)][_0x1f766e(0x52e)]||'你';_0x27d692=_0x1f766e(0xa68)+_0x1820cf+'\x20的礼物';}}const _0x2f683d=_0x43224b[_0x1f766e(0x959)][_0x1f766e(0x1368)](0x0,0x3);let _0x101dc5='';_0x2f683d['forEach'](_0x2e9a4f=>{const _0x2c9d29=_0x1f766e;_0x101dc5+=_0x2c9d29(0x128)+_0x2e9a4f['imageUrl']+_0x2c9d29(0xef)+_0x2e9a4f[_0x2c9d29(0x461)]+_0x2c9d29(0x1252)+_0x2e9a4f[_0x2c9d29(0x257)]+_0x2c9d29(0xad3);});let _0x173843='';_0x43224b['items']['length']>0x3&&(_0x173843='\x20等'+_0x43224b[_0x1f766e(0x959)][_0x1f766e(0xfde)]+_0x1f766e(0x4fd)),_0x2a64df=_0x1f766e(0xb4)+_0x27d692+_0x1f766e(0x1292)+_0x101dc5+_0x1f766e(0x5ef)+_0x43224b[_0x1f766e(0x959)][_0x1f766e(0xfde)]+_0x1f766e(0x4fd)+_0x173843+_0x1f766e(0x9ee);}}}}}}}}}}}}}}else{const _0x1c1ac7=String(_0x47eb56);let _0x493d6b=await _0x63723d(_0x1c1ac7,_0x4597eb['id']);if(_0x493d6b!==_0x1c1ac7)_0x2a64df=_0x493d6b,_0x4f9d69[_0x1f766e(0x119a)]['add'](_0x1f766e(0x611));else{if(Array[_0x1f766e(0x565)](_0x43224b['content'])&&_0x43224b[_0x1f766e(0x11b6)][0x0]?.[_0x1f766e(0xa6b)]==='image_url'){const _0x34ef72=_0x43224b[_0x1f766e(0x11b6)][0x0]['image_url']['url'];_0x2a64df=_0x1f766e(0xf8a)+_0x34ef72+'\x22\x20class=\x22chat-image\x22>';}else{if(_0x49f222['test'](_0x493d6b))_0x4f9d69['classList']['add']('is-sticker',_0x1f766e(0x611)),_0x2a64df='<img\x20src=\x22'+_0x493d6b+_0x1f766e(0xc85)+(_0x43224b[_0x1f766e(0x7de)]||_0x1f766e(0x459))+_0x1f766e(0x722);else{let _0x198b78=_0x1d0461(_0x493d6b,_0x4597eb);_0x2a64df=_0x350d3e(_0x198b78)[_0x1f766e(0x709)](/\n/g,_0x1f766e(0x3ee));}}}}}_0x4f9d69[_0x1f766e(0x45c)]=_0x1f766e(0x13b)+_0x5cfda4+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x367a70+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2a64df+_0x1f766e(0x1394),_0x3fb333[_0x1f766e(0xe91)](_0x4f9d69),_0x3fb333['appendChild'](_0x29217d),_0x3e15d1(_0x3fb333,()=>_0xe2646(_0x43224b[_0x1f766e(0x3b7)])),_0x3fb333[_0x1f766e(0x271)](_0x1f766e(0x5c7),()=>{const _0x2efec1=_0x1f766e;if(_0x80fd3b)_0x4c3eff(_0x43224b[_0x2efec1(0x3b7)]);});if(!_0x244f4e){const _0x4e3d61=_0x3fb333[_0x1f766e(0x89c)]('.avatar-group');_0x4e3d61&&(_0x4e3d61[_0x1f766e(0x655)]['cursor']=_0x1f766e(0x8a0),!_0x4597eb['isGroup']?_0x4e3d61['addEventListener']('click',_0x3b5fc6=>{const _0x3745e8=_0x1f766e;_0x3b5fc6[_0x3745e8(0x1311)](),_0x5acfa5(_0x4597eb['id']);}):_0x4e3d61['addEventListener'](_0x1f766e(0x313),_0x103d6d=>{_0x103d6d['stopPropagation'](),_0x70854a(_0x4597eb['id'],_0x43224b['senderName']);}));}return _0x3fb333;}async function _0x40e080(_0x1a15b2,_0x280f64){const _0x126605=_0x549949,_0x2ac3c7=document[_0x126605(0x383)](_0x126605(0x11cf)),_0x4f5807=await _0x152d98(_0x1a15b2,_0x280f64);if(!_0x4f5807)return;const _0x595b76=document[_0x126605(0x383)](_0x126605(0xad9));_0x595b76?_0x2ac3c7['insertBefore'](_0x4f5807,_0x595b76[_0x126605(0x1086)]):_0x2ac3c7['prepend'](_0x4f5807);}async function _0x323467(_0x5ad338,_0x3463f7,_0x547ecb=![]){const _0x2fb9b1=_0x549949,_0x2af42c=document[_0x2fb9b1(0x383)](_0x2fb9b1(0x11cf)),_0x275b6a=document[_0x2fb9b1(0x383)](_0x2fb9b1(0xa71)),_0x56a119=_0x3463f7[_0x2fb9b1(0xd08)][_0x2fb9b1(0x98a)](_0x213540=>!_0x213540[_0x2fb9b1(0xbc5)])[_0x2fb9b1(0xc4f)]();if(_0x56a119&&_0x5ad338['timestamp']-_0x56a119['timestamp']>0x927c0){const _0x551a7d=_0x49e7d1(_0x5ad338['timestamp']);_0x2af42c[_0x2fb9b1(0x11c5)](_0x551a7d,_0x275b6a);}const _0x5be06b=await _0x152d98(_0x5ad338,_0x3463f7);if(!_0x5be06b)return;_0x5ad338[_0x2fb9b1(0x10ff)]===_0x2fb9b1(0xf3c)&&!_0x547ecb&&_0x1d7250(),!_0x547ecb&&_0x5be06b['classList']['add']('animate-in'),_0x2af42c[_0x2fb9b1(0x11c5)](_0x5be06b,_0x275b6a),!_0x547ecb&&(_0x2af42c[_0x2fb9b1(0x4f9)]=_0x2af42c[_0x2fb9b1(0x36d)],_0x2cf31b++);}async function _0x4a08c7(_0x2b8813){const _0x3a82d0=_0x549949;_0x41df36['activeChatId']=_0x2b8813;const _0x8335a4=_0x41df36['chats'][_0x2b8813];if(!_0x8335a4)return;_0x8335a4[_0x3a82d0(0x40c)]>0x0&&(_0x8335a4['unreadCount']=0x0,await _0x342df8[_0x3a82d0(0x864)][_0x3a82d0(0x9c0)](_0x8335a4));_0x368cae(_0x8335a4),_0x409076(_0x2b8813),_0x105acd(_0x3a82d0(0x862)),window[_0x3a82d0(0x10f6)](_0x41df36[_0x3a82d0(0xfc5)]);const _0x4fb831=_0x8335a4[_0x3a82d0(0x1a2)]||![];_0x3b2799(_0x4fb831),document[_0x3a82d0(0x383)](_0x3a82d0(0x37a))[_0x3a82d0(0x655)][_0x3a82d0(0x2b6)]=_0x4fb831?_0x3a82d0(0x2aa):_0x3a82d0(0xa70);const _0x1eee00=document[_0x3a82d0(0x383)](_0x3a82d0(0x1321));_0x1eee00&&(_0x1eee00[_0x3a82d0(0x655)][_0x3a82d0(0x2b6)]=_0x4fb831?_0x3a82d0(0xa70):_0x3a82d0(0x2aa));const _0x529a5e=document['getElementById'](_0x3a82d0(0xf33)),_0x21ec79=document[_0x3a82d0(0x383)](_0x3a82d0(0x73c)),_0x500179=document[_0x3a82d0(0x383)](_0x3a82d0(0x5e3)),_0xbeb2d5=document[_0x3a82d0(0x383)](_0x3a82d0(0x467));_0x21ec79&&_0x500179&&_0xbeb2d5&&_0x529a5e&&(_0x21ec79[_0x3a82d0(0x655)][_0x3a82d0(0x2b6)]='flex',_0x500179['style']['display']=_0x4fb831?_0x3a82d0(0xa70):_0x3a82d0(0x2aa),_0xbeb2d5['style']['display']=_0x4fb831?'flex':_0x3a82d0(0xa70),_0x529a5e[_0x3a82d0(0x655)]['display']=_0x4fb831?_0x3a82d0(0xa70):'flex'),_0x44666e(),!_0x8335a4[_0x3a82d0(0x1a2)]&&_0x8335a4[_0x3a82d0(0x112b)]?.[_0x3a82d0(0x1fe)]===_0x3a82d0(0xccf)&&(console[_0x3a82d0(0xe72)](_0x3a82d0(0x369)+_0x8335a4[_0x3a82d0(0x461)]+'\x22\x20自动触发AI响应...'),_0x11e743()),document[_0x3a82d0(0x383)](_0x3a82d0(0x6f1))[_0x3a82d0(0x655)][_0x3a82d0(0x2b6)]=_0x4fb831?_0x3a82d0(0x2aa):_0x3a82d0(0xa70);}function _0x2f64f8(_0x274ceb,_0x109c9d){const _0x244f4d=_0x549949,_0x4c5366=_0x109c9d?'add':_0x244f4d(0x131d),_0x12309c=_0x1d52db=>{const _0x33648f=_0x244f4d;_0x1d52db&&_0x1d52db[_0x33648f(0x119a)][_0x4c5366](_0x33648f(0x1f9));},_0x2fcd44=document[_0x244f4d(0x89c)](_0x244f4d(0x2eb)+_0x274ceb+'\x22]\x20.avatar');_0x12309c(_0x2fcd44);const _0x3e1beb=document[_0x244f4d(0x400)]('.post-avatar[data-author-id=\x22'+_0x274ceb+'\x22]');_0x3e1beb[_0x244f4d(0x19c)](_0x12309c);const _0x1357b2=document[_0x244f4d(0x89c)]('.participant-avatar[data-participant-id=\x22'+_0x274ceb+'\x22]');_0x12309c(_0x1357b2);}async function _0x41e5ce(){const _0x21b66b=_0x549949;if(!_0x41df36['activeChatId'])return;const _0x508f19=_0x41df36[_0x21b66b(0xfc5)],_0x3f8330=_0x41df36[_0x21b66b(0x864)][_0x508f19];lastRawAiResponse='',lastResponseTimestamps=[];const _0x6e002c=document[_0x21b66b(0x383)](_0x21b66b(0xc9));_0x6e002c&&(_0x6e002c[_0x21b66b(0x29b)]=!![],_0x6e002c[_0x21b66b(0x138e)]=_0x21b66b(0x9c2));_0x2f64f8(_0x508f19,!![]);try{const {proxyUrl:_0x1a455a,apiKey:_0x153046,model:_0x160164}=_0x41df36[_0x21b66b(0x673)];if(!_0x1a455a||!_0x153046||!_0x160164)throw new Error(_0x21b66b(0xc6d));const _0x504774=parseInt(_0x3f8330[_0x21b66b(0x886)]['maxMemory'])||0xa,_0x1ca438=_0x3f8330[_0x21b66b(0xd08)]['slice'](-_0x504774);let _0x364419='';if(_0x3f8330[_0x21b66b(0x886)]['linkedWorldBookIds']&&_0x3f8330[_0x21b66b(0x886)][_0x21b66b(0xe8c)][_0x21b66b(0xfde)]>0x0){const _0x564b79=_0x3f8330['settings'][_0x21b66b(0xe8c)]['map'](_0x401779=>{const _0x1b46bb=_0x21b66b,_0x2696bf=_0x41df36['worldBooks'][_0x1b46bb(0xd12)](_0x40d30b=>_0x40d30b['id']===_0x401779);if(!_0x2696bf||!Array['isArray'](_0x2696bf['content']))return'';const _0x534285=_0x2696bf['content'][_0x1b46bb(0x98a)](_0x190e06=>_0x190e06['enabled']!==![])[_0x1b46bb(0xa79)](_0xd51507=>{const _0x4418e8=_0x1b46bb;let _0x1c4ec4='\x0a###\x20条目:\x20'+(_0xd51507[_0x4418e8(0x125b)]||_0x4418e8(0x138b))+'\x0a';if(_0xd51507['keys'][_0x4418e8(0xfde)]>0x0)_0x1c4ec4+='**关键词:**\x20'+_0xd51507[_0x4418e8(0x66b)][_0x4418e8(0xa35)](',\x20')+'\x0a';return _0x1c4ec4+=_0x4418e8(0x37e)+_0xd51507['content'],_0x1c4ec4;})[_0x1b46bb(0xa35)]('');return _0x534285?_0x1b46bb(0x6f9)+_0x2696bf[_0x1b46bb(0x461)]+'\x0a'+_0x534285:'';})['filter'](Boolean)[_0x21b66b(0xa35)]('');_0x564b79&&(_0x364419='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x564b79+_0x21b66b(0x84f));}let _0x2a69c5=_0x21b66b(0x73d),_0x31e8d3=![];_0x3f8330['members'][_0x21b66b(0x19c)](_0x15dd48=>{const _0x47f186=_0x21b66b,_0x5eb005=_0x41df36[_0x47f186(0x864)][_0x15dd48['id']];_0x5eb005&&_0x5eb005[_0x47f186(0x1349)]&&_0x5eb005[_0x47f186(0x1349)][_0x47f186(0xfde)]>0x0&&(_0x2a69c5+=_0x47f186(0x6a4)+_0x15dd48[_0x47f186(0x9da)]+_0x47f186(0xb11),_0x2a69c5+=_0x5eb005['longTermMemory'][_0x47f186(0xa79)](_0x505ba6=>'-\x20(记录于\x20'+_0xa3fdac(_0x505ba6[_0x47f186(0x3b7)])+')\x20'+_0x505ba6[_0x47f186(0x11b6)])['join']('\x0a'),_0x31e8d3=!![]);});!_0x31e8d3&&(_0x2a69c5+=_0x21b66b(0x7ae));let _0x43937b='';const _0x3cb9ef=_0x3f8330['settings'][_0x21b66b(0x1d8)]||0xa;if(_0x3f8330['settings'][_0x21b66b(0x20c)]&&_0x3f8330[_0x21b66b(0x886)][_0x21b66b(0x20c)][_0x21b66b(0xfde)]>0x0){}const _0x53ab56=_0x3f8330[_0x21b66b(0x12a6)][_0x21b66b(0xa79)](_0x12918c=>_0x21b66b(0x71b)+_0x12918c[_0x21b66b(0x9da)]+'**\x20(本名:\x20'+_0x12918c[_0x21b66b(0x283)]+_0x21b66b(0x12a8)+_0x12918c[_0x21b66b(0x48c)])[_0x21b66b(0xa35)]('\x0a'),_0x45cf9f=_0x37dbe7(_0x3f8330),_0x32ecc1='\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“'+_0x3f8330[_0x21b66b(0x461)]+_0x21b66b(0x671)+_0x3f8330[_0x21b66b(0x461)]+_0x21b66b(0x8e0)+_0x2a69c5+'\x0a'+_0x364419+'\x0a'+_0x43937b+_0x21b66b(0x636)+_0x1ca438[_0x21b66b(0xa79)](_0xc0d48a=>_0x54d0ab(_0x3f8330,_0xc0d48a['senderName'])+':\x20'+_0xc0d48a[_0x21b66b(0x11b6)])['join']('\x0a')+_0x21b66b(0xd87)+_0x53ab56+_0x21b66b(0x109a)+_0x45cf9f+_0x21b66b(0xe75),_0x8c4717=_0x1ca438[_0x21b66b(0xa79)](_0x19882a=>({'role':_0x21b66b(0x66e),'content':_0x54d0ab(_0x3f8330,_0x19882a[_0x21b66b(0x4c5)])+':\x20'+_0x19882a[_0x21b66b(0x11b6)]}));let _0xa581=_0x1a455a['includes'](_0x21b66b(0x1ac)),_0x1d2caf;if(_0xa581){let _0x147be8=_0x112768(_0x160164,_0x153046,_0x32ecc1,_0x8c4717);_0x1d2caf=await fetch(_0x147be8['url'],_0x147be8['data']);}else _0x1d2caf=await fetch(_0x1a455a+_0x21b66b(0x126b),{'method':_0x21b66b(0x94f),'headers':{'Content-Type':_0x21b66b(0x11f0),'Authorization':_0x21b66b(0xd55)+_0x153046},'body':JSON[_0x21b66b(0x3fb)]({'model':_0x160164,'messages':[{'role':_0x21b66b(0xb1),'content':_0x32ecc1},..._0x8c4717],'temperature':_0x41df36['globalSettings'][_0x21b66b(0xa4a)]||0.9})});if(!_0x1d2caf['ok']){const _0xab5c8=await _0x1d2caf['json']()['catch'](()=>({'error':{'message':_0x1d2caf[_0x21b66b(0x3ea)]}}));throw new Error(_0x21b66b(0xb83)+_0x1d2caf[_0x21b66b(0x1fe)]+_0x21b66b(0xb13)+(_0xab5c8[_0x21b66b(0x98)]?.[_0x21b66b(0x5f8)]||_0x21b66b(0x1237)));}const _0x1672f7=await _0x1d2caf[_0x21b66b(0x9b3)](),_0x210f21=getGeminiResponseText(_0x1672f7);lastRawAiResponse=_0x210f21;const _0x4a1212=_0x28b8fa(_0x210f21);let _0x4e8138=Date[_0x21b66b(0x108d)]();for(const _0x477495 of _0x4a1212){if(!_0x477495||!_0x477495[_0x21b66b(0xa6b)]||!_0x477495['name'])continue;let _0x4ceacf=null;const _0x48946d=_0x4e8138++;lastResponseTimestamps[_0x21b66b(0x258)](_0x48946d);const _0xb632a7={'role':_0x21b66b(0xf3c),'senderName':_0x477495[_0x21b66b(0x461)],'timestamp':_0x48946d};switch(_0x477495['type']){case _0x21b66b(0x6af):_0x4ceacf={..._0xb632a7,'content':_0x477495[_0x21b66b(0x11b6)]};break;case _0x21b66b(0x37d):if(_0x477495[_0x21b66b(0x7de)]){const _0x11a6c1=_0x41df36['userStickers']['find'](_0x8aa0ab=>_0x8aa0ab[_0x21b66b(0x461)]===_0x477495['meaning']);_0x11a6c1?_0x4ceacf={..._0xb632a7,'type':_0x21b66b(0x37d),'content':_0x11a6c1[_0x21b66b(0x2fa)],'meaning':_0x11a6c1[_0x21b66b(0x461)]}:(console['warn'](_0x21b66b(0x12dd)+_0x477495[_0x21b66b(0x7de)]+'\x22'),_0x4ceacf={..._0xb632a7,'type':_0x21b66b(0x6af),'content':_0x21b66b(0x261)+_0x477495['meaning']+']'});}else console[_0x21b66b(0x17b)](_0x21b66b(0xbaf),_0x477495);break;case'ai_image':_0x4ceacf={..._0xb632a7,'type':_0x21b66b(0x1050),'content':_0x477495[_0x21b66b(0xee1)],'image_prompt':_0x477495[_0x21b66b(0x8d8)]};break;case _0x21b66b(0xa4f):_0x4ceacf={..._0xb632a7,'type':'voice_message','content':_0x477495[_0x21b66b(0x11b6)]};break;case'quote_reply':const _0x5e2a9a=_0x3f8330['history'][_0x21b66b(0xd12)](_0xe24bd7=>_0xe24bd7['timestamp']===_0x477495[_0x21b66b(0x17d)]);_0x5e2a9a?_0x4ceacf={..._0xb632a7,'content':_0x477495[_0x21b66b(0x5a6)],'quote':{'timestamp':_0x5e2a9a[_0x21b66b(0x3b7)],'senderName':_0x5e2a9a[_0x21b66b(0x4c5)],'content':String(_0x5e2a9a[_0x21b66b(0x11b6)]||'')[_0x21b66b(0xba5)](0x0,0x32)}}:_0x4ceacf={..._0xb632a7,'content':_0x477495['reply_content']};break;default:console[_0x21b66b(0x17b)](_0x21b66b(0x39e),_0x477495[_0x21b66b(0xa6b)]);continue;}_0x4ceacf&&(_0x3f8330['history'][_0x21b66b(0x258)](_0x4ceacf),_0x323467(_0x4ceacf,_0x3f8330),await new Promise(_0x6050c0=>setTimeout(_0x6050c0,Math[_0x21b66b(0x5ce)]()*0x4b0+0x320)));}await _0x342df8['chats'][_0x21b66b(0x9c0)](_0x3f8330),_0x25558e();}catch(_0x2b0134){console['error'](_0x21b66b(0xa24),_0x2b0134),await _0x296ef9(_0x21b66b(0xa55),_0x21b66b(0x1345)+_0x2b0134[_0x21b66b(0x5f8)]);}finally{_0x6e002c&&(_0x6e002c[_0x21b66b(0x29b)]=![],_0x6e002c[_0x21b66b(0x138e)]=_0x21b66b(0x11c1)),_0x2f64f8(_0x508f19,![]);}}async function _0x11e743(){const _0x140d17=_0x549949;if(!_0x41df36[_0x140d17(0xfc5)])return;const _0x350226=_0x41df36[_0x140d17(0xfc5)],_0x897d3a=_0x41df36['chats'][_0x41df36[_0x140d17(0xfc5)]],_0x1b6065=document['getElementById']('chat-interface-screen')[_0x140d17(0x119a)][_0x140d17(0x987)](_0x140d17(0xde5))&&_0x41df36['activeChatId']===_0x350226;_0x2f64f8(_0x350226,!![]);const _0x32f204=document['getElementById']('chat-header-title'),_0x1a872e=document[_0x140d17(0x383)](_0x140d17(0xa71)),_0x410b04=document['querySelector']('.chat-list-item[data-chat-id=\x22'+_0x350226+'\x22]'),_0xb0ed64=_0x410b04?_0x410b04[_0x140d17(0x89c)]('.avatar'):null;_0xb0ed64&&_0xb0ed64[_0x140d17(0x119a)][_0x140d17(0xbff)](_0x140d17(0x1f9));_0x897d3a[_0x140d17(0x1a2)]?_0x1a872e&&(_0x1a872e['textContent']=_0x140d17(0x328),_0x1a872e[_0x140d17(0x655)]['display']=_0x140d17(0x27a)):_0x32f204&&(_0x32f204[_0x140d17(0x655)][_0x140d17(0x10ec)]=0x0,setTimeout(()=>{const _0x4b7928=_0x140d17;_0x32f204['textContent']='对方正在输入...',_0x32f204[_0x4b7928(0x119a)][_0x4b7928(0xbff)]('typing-status'),_0x32f204[_0x4b7928(0x655)][_0x4b7928(0x10ec)]=0x1;},0xc8));let _0x183d39=![];try{const {proxyUrl:_0x4e67e2,apiKey:_0x28daf2,model:_0x4d7092}=_0x41df36['apiConfig'];if(!_0x4e67e2||!_0x28daf2||!_0x4d7092){alert(_0x140d17(0x11d2));if(_0x897d3a[_0x140d17(0x1a2)]){if(_0x1a872e)_0x1a872e['style'][_0x140d17(0x2b6)]=_0x140d17(0xa70);}else _0x32f204&&_0x41df36[_0x140d17(0x864)][_0x350226]&&(_0x32f204[_0x140d17(0x138e)]=_0x41df36[_0x140d17(0x864)][_0x350226][_0x140d17(0x461)],_0x32f204[_0x140d17(0x119a)][_0x140d17(0x131d)]('typing-status'));return;}const _0x159432=_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x1368)](-0x1)[0x0],_0x33747c=_0x159432&&_0x159432[_0x140d17(0x10ff)]===_0x140d17(0xb1)&&_0x159432[_0x140d17(0x11b6)][_0x140d17(0xee2)](_0x140d17(0x938));if(_0x33747c){console[_0x140d17(0xe72)](_0x140d17(0x287)+_0x897d3a[_0x140d17(0x461)]+'\x22\x20触发专属决策流程...');let _0x536a0f;_0x897d3a[_0x140d17(0x1a2)]?_0x536a0f='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x897d3a[_0x140d17(0x12a6)][_0x140d17(0xa79)](_0x44e975=>'-\x20'+_0x44e975[_0x140d17(0x9da)]+'\x20(本名:\x20'+_0x44e975[_0x140d17(0x283)]+_0x140d17(0x12a8)+_0x44e975[_0x140d17(0x48c)])['join']('\x0a')+_0x140d17(0x80f):_0x536a0f='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x897d3a['settings'][_0x140d17(0xd83)]+_0x140d17(0xee4);const _0x57fb19=[{'role':_0x140d17(0x66e),'content':_0x536a0f}];try{let _0x412780=_0x112768(_0x4d7092,_0x28daf2,_0x536a0f,_0x57fb19),_0x4fdd3e=_0x4e67e2===GEMINI_API_URL;const _0x8c1432=_0x4fdd3e?await fetch(_0x412780[_0x140d17(0x2fa)],_0x412780['data']):await fetch(_0x4e67e2+_0x140d17(0x126b),{'method':_0x140d17(0x94f),'headers':{'Content-Type':_0x140d17(0x11f0),'Authorization':'Bearer\x20'+_0x28daf2},'body':JSON[_0x140d17(0x3fb)]({'model':_0x4d7092,'messages':_0x57fb19,'temperature':0.7})});if(!_0x8c1432['ok'])throw new Error('API失败:\x20'+(await _0x8c1432[_0x140d17(0x9b3)]())['error'][_0x140d17(0x5f8)]);const _0x92f499=await _0x8c1432[_0x140d17(0x9b3)](),_0x4226c6=getGeminiResponseText(_0x92f499),_0x419db4=_0x28b8fa(_0x4226c6);let _0x427b77=![];for(const _0x1505cc of _0x419db4){if(_0x1505cc[_0x140d17(0xa6b)]===_0x140d17(0x14f)){_0x4f60f2['isAwaitingResponse']=![];if(_0x1505cc[_0x140d17(0xe8e)]===_0x140d17(0x3d0))_0x267991();else{const _0x33daea={'role':_0x140d17(0xf3c),'content':_0x140d17(0x113),'timestamp':Date[_0x140d17(0x108d)]()};_0x897d3a['history'][_0x140d17(0x258)](_0x33daea),await _0x342df8[_0x140d17(0x864)][_0x140d17(0x9c0)](_0x897d3a),_0x105acd(_0x140d17(0x862)),_0x409076(_0x350226);}_0x427b77=!![];break;}if(_0x1505cc['type']===_0x140d17(0x23a)){if(_0x1505cc[_0x140d17(0xe8e)]===_0x140d17(0xa35)){const _0x48c26a=_0x897d3a['members'][_0x140d17(0xd12)](_0x291e39=>_0x291e39[_0x140d17(0x283)]===_0x1505cc['name']);_0x48c26a&&!_0x4f60f2[_0x140d17(0x9a6)][_0x140d17(0x12fb)](_0x2f5390=>_0x2f5390['id']===_0x48c26a['id'])&&_0x4f60f2[_0x140d17(0x9a6)][_0x140d17(0x258)](_0x48c26a);}_0x427b77=!![];}}_0x427b77&&_0x4f60f2[_0x140d17(0xc02)]&&(_0x4f60f2[_0x140d17(0xe53)]=![],_0x4f60f2[_0x140d17(0x9a6)]['length']>0x0?_0x267991():(_0x4f60f2={..._0x4f60f2,'isAwaitingResponse':![],'participants':[]},_0x105acd(_0x140d17(0x862)),alert(_0x140d17(0xca3))));}catch(_0x43e811){console[_0x140d17(0x98)](_0x140d17(0x20e),_0x43e811);const _0x47f8f3=_0x897d3a[_0x140d17(0x1a2)]?_0x897d3a['members']['map'](_0x1dbe00=>({'type':_0x140d17(0x23a),'name':_0x1dbe00['originalName'],'decision':_0x140d17(0x59e)})):[{'type':_0x140d17(0x14f),'decision':_0x140d17(0xa1e)}];if(_0x897d3a[_0x140d17(0x1a2)])_0x4f60f2[_0x140d17(0xe53)]=![],_0x4f60f2[_0x140d17(0x9a6)]=[],alert(_0x140d17(0xca3)),_0x105acd(_0x140d17(0x862));else{const _0x2cc3b9={'role':_0x140d17(0xf3c),'content':_0x140d17(0x113),'timestamp':Date[_0x140d17(0x108d)]()};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0x2cc3b9),await _0x342df8['chats']['put'](_0x897d3a),_0x105acd(_0x140d17(0x862)),_0x409076(_0x350226);}}finally{_0x2f64f8(_0x350226,![]);return;}}if(!_0x897d3a[_0x140d17(0x1a2)]&&_0x897d3a[_0x140d17(0x112b)]?.[_0x140d17(0x1fe)]===_0x140d17(0xccf)){console[_0x140d17(0xe72)]('为角色\x20\x22'+_0x897d3a[_0x140d17(0x461)]+'\x22\x20触发带理由的好友申请决策流程...');const _0x128812=_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x98a)](_0x4ff9ec=>!_0x4ff9ec[_0x140d17(0xbc5)])['slice'](-0xa,-0x5)['map'](_0xc35df7=>{const _0x1ef426=_0x140d17,_0xf5e061=_0xc35df7[_0x1ef426(0x10ff)]==='user'?'用户':_0x897d3a[_0x1ef426(0x461)];return _0xf5e061+':\x20'+String(_0xc35df7[_0x1ef426(0x11b6)])['substring'](0x0,0x32)+_0x1ef426(0x1026);})['join']('\x0a'),_0x55ccfe=_0x140d17(0x1209)+_0x897d3a[_0x140d17(0x461)]+_0x140d17(0xd0b)+_0x897d3a[_0x140d17(0x886)][_0x140d17(0xd83)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“'+_0x897d3a[_0x140d17(0x112b)]['applicationReason']+_0x140d17(0x578)+(_0x128812||_0x140d17(0x9f))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20';try{const _0x28acde=[{'role':_0x140d17(0xb1),'content':_0x55ccfe},{'role':_0x140d17(0x66e),'content':_0x140d17(0x931)}];let _0x45bc45=_0x4e67e2===GEMINI_API_URL,_0x36ca2f=_0x112768(_0x4d7092,_0x28daf2,_0x55ccfe,[{'role':_0x140d17(0x66e),'content':_0x140d17(0x931)}]);const _0x313608=_0x45bc45?await fetch(_0x36ca2f[_0x140d17(0x2fa)],_0x36ca2f['data']):await fetch(_0x4e67e2+'/v1/chat/completions',{'method':_0x140d17(0x94f),'headers':{'Content-Type':_0x140d17(0x11f0),'Authorization':_0x140d17(0xd55)+_0x28daf2},'body':JSON[_0x140d17(0x3fb)]({'model':_0x4d7092,'messages':_0x28acde,'temperature':_0x41df36[_0x140d17(0xc0)][_0x140d17(0xa4a)]||0.8})});if(!_0x313608['ok'])throw new Error('API失败:\x20'+(await _0x313608[_0x140d17(0x9b3)]())[_0x140d17(0x98)][_0x140d17(0x5f8)]);const _0x437a15=await _0x313608[_0x140d17(0x9b3)](),_0x5a4cad=getGeminiResponseText(_0x437a15)[_0x140d17(0x709)](/^```json\s*/,'')[_0x140d17(0x709)](/```$/,'')[_0x140d17(0x1cb)](),_0x1864fd=JSON['parse'](_0x5a4cad);if(_0x1864fd['decision']===_0x140d17(0x3d0)){_0x897d3a[_0x140d17(0x112b)][_0x140d17(0x1fe)]='friend';const _0x3f5e64={'role':_0x140d17(0xf3c),'senderName':_0x897d3a[_0x140d17(0x461)],'content':_0x1864fd[_0x140d17(0x99)],'timestamp':Date['now']()};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0x3f5e64);}else{_0x897d3a[_0x140d17(0x112b)][_0x140d17(0x1fe)]='blocked_by_ai';const _0x2c7660={'role':_0x140d17(0xf3c),'senderName':_0x897d3a[_0x140d17(0x461)],'content':_0x1864fd['reason'],'timestamp':Date[_0x140d17(0x108d)]()};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0x2c7660);}_0x897d3a[_0x140d17(0x112b)][_0x140d17(0x6d8)]='',await _0x342df8['chats'][_0x140d17(0x9c0)](_0x897d3a),_0x409076(_0x350226),_0x25558e();}catch(_0x1eacd1){_0x897d3a[_0x140d17(0x112b)]['status']=_0x140d17(0x203),await _0x342df8['chats'][_0x140d17(0x9c0)](_0x897d3a),await _0x296ef9('申请失败',_0x140d17(0x1306)+_0x1eacd1[_0x140d17(0x5f8)]),_0x409076(_0x350226);}return;}let _0x1e9d70='';const _0x571b2b=new Date(),_0x2d2f3a=_0x897d3a[_0x140d17(0x886)][_0x140d17(0xa74)]||_0x140d17(0xc36),_0x2b8b90=_0x571b2b['toLocaleString'](_0x140d17(0xafb),{'timeZone':_0x2d2f3a,'dateStyle':'full','timeStyle':_0x140d17(0xfc1)}),_0x2cfdc2=new Date(_0x571b2b['toLocaleString']('en-US',{'timeZone':_0x2d2f3a})),_0x3df235=_0x1ccf3f(_0x2cfdc2);let _0x307319,_0x3009ad;const _0x14c704=_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x98a)](_0x4186e0=>_0x4186e0[_0x140d17(0xbc5)])[_0x140d17(0xc4f)]();if(_0x14c704&&_0x14c704[_0x140d17(0x11b6)][_0x140d17(0xee2)](_0x140d17(0x113b))){const _0x6fa8c2=await _0x342df8[_0x140d17(0xdb9)]['where']('chatId')[_0x140d17(0x5b3)](_0x350226)[_0x140d17(0xd8d)]();if(_0x6fa8c2&&_0x6fa8c2[_0x140d17(0x8cd)]){console[_0x140d17(0xe72)](_0x140d17(0x8fb));const _0x57835e=_0x6fa8c2['transcript']['map'](_0x537141=>{const _0x1dc9ea=_0x140d17,_0x138c0a=_0x537141['role']==='user'?_0x897d3a[_0x1dc9ea(0x886)]['myNickname']||'我':_0x537141[_0x1dc9ea(0x4c5)];return _0x138c0a+':\x20'+_0x537141[_0x1dc9ea(0x11b6)];})[_0x140d17(0xa35)]('\x0a');_0x1e9d70=_0x140d17(0x247)+_0x57835e+_0x140d17(0xec6);}}const _0x16a8b2=_0x4e577c(_0x35c099[_0x350226]);let _0x51028d='';if(_0x897d3a[_0x140d17(0x886)][_0x140d17(0xe8c)]&&_0x897d3a[_0x140d17(0x886)]['linkedWorldBookIds'][_0x140d17(0xfde)]>0x0){const _0x50b068=_0x897d3a['settings'][_0x140d17(0xe8c)][_0x140d17(0xa79)](_0x3cb35d=>{const _0x4539cc=_0x140d17,_0x51839c=_0x41df36['worldBooks'][_0x4539cc(0xd12)](_0x3ab432=>_0x3ab432['id']===_0x3cb35d);if(!_0x51839c||!Array['isArray'](_0x51839c[_0x4539cc(0x11b6)]))return'';const _0x5aea9b=_0x51839c[_0x4539cc(0x11b6)][_0x4539cc(0x98a)](_0x5de4ff=>_0x5de4ff[_0x4539cc(0x8e4)]!==![])[_0x4539cc(0xa79)](_0x462783=>{const _0x5e997c=_0x4539cc;let _0x1a44fc=_0x5e997c(0xc6a)+(_0x462783['comment']||_0x5e997c(0x138b))+'\x0a';return _0x462783['keys'][_0x5e997c(0xfde)]>0x0&&(_0x1a44fc+=_0x5e997c(0x3dc)+_0x462783[_0x5e997c(0x66b)][_0x5e997c(0xa35)](',\x20')+'\x0a'),_0x1a44fc+=_0x5e997c(0x37e)+_0x462783[_0x5e997c(0x11b6)],_0x1a44fc;})[_0x4539cc(0xa35)]('');return _0x5aea9b?_0x4539cc(0x6f9)+_0x51839c[_0x4539cc(0x461)]+'\x0a'+_0x5aea9b:'';})[_0x140d17(0x98a)](Boolean)[_0x140d17(0xa35)]('');_0x50b068&&(_0x51028d='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x50b068+_0x140d17(0x84f));}let _0x28a264='';if(_0x40e606[_0x140d17(0x40d)]&&_0x40e606['activeChatId']===_0x350226){const _0x27106a=_0x40e606[_0x140d17(0xb2c)]>-0x1?_0x40e606[_0x140d17(0x91b)][_0x40e606['currentIndex']]:null,_0x305fad=_0x40e606[_0x140d17(0x91b)][_0x140d17(0xa79)](_0x327d0f=>'\x22'+_0x327d0f[_0x140d17(0x461)]+'\x22')['join'](',\x20');let _0x562463='';if(_0x27106a&&_0x40e606['parsedLyrics']&&_0x40e606[_0x140d17(0x6ed)]['length']>0x0&&_0x40e606[_0x140d17(0x1025)]>-0x1){const _0x4fb298=_0x40e606[_0x140d17(0x6ed)][_0x40e606['currentLyricIndex']],_0x3f9ba2=_0x40e606[_0x140d17(0x6ed)][_0x140d17(0x1368)](_0x40e606[_0x140d17(0x1025)]+0x1,_0x40e606['currentLyricIndex']+0x3);_0x562463+=_0x140d17(0xd66)+_0x4fb298[_0x140d17(0x6af)]+'\x22\x0a',_0x3f9ba2['length']>0x0&&(_0x562463+=_0x140d17(0x919)+_0x3f9ba2['map'](_0x10063a=>'\x22'+_0x10063a[_0x140d17(0x6af)]+'\x22')[_0x140d17(0xa35)]('\x20/\x20')+'\x0a');}_0x28a264=_0x140d17(0x9b6)+(_0x27106a?'《'+_0x27106a[_0x140d17(0x461)]+_0x140d17(0xf65)+_0x27106a[_0x140d17(0x5d8)]:'无')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20['+_0x305fad+_0x140d17(0xf54)+_0x562463+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}const _0x3aed93=parseInt(_0x897d3a['settings'][_0x140d17(0x1138)])||0xa,_0x46e6a0=_0x897d3a['history']['slice'](-_0x3aed93);let _0x3d222c='';const _0x52f373=_0x897d3a['history'][_0x140d17(0xdef)](_0x29782b=>_0x29782b['role']===_0x140d17(0xf3c)),_0x43c432=_0x897d3a['history'][_0x140d17(0x1368)](_0x52f373+0x1),_0x388fcd=_0x43c432['find'](_0x35493a=>_0x35493a[_0x140d17(0xa6b)]==='share_card');if(_0x388fcd){const _0x411111=_0x388fcd['payload'],_0x4ad728=_0x411111[_0x140d17(0x10c8)][_0x140d17(0xa79)](_0x17f13e=>{const _0x142abd=_0x140d17,_0x1c69d7=_0x17f13e[_0x142abd(0x4c5)]||(_0x17f13e['role']==='user'?_0x897d3a[_0x142abd(0x886)][_0x142abd(0x52e)]||'我':_0x142abd(0x975));let _0x111c62='';if(_0x17f13e[_0x142abd(0xa6b)]==='voice_message')_0x111c62=_0x142abd(0x86c)+_0x17f13e[_0x142abd(0x11b6)]+']';else{if(_0x17f13e['type']===_0x142abd(0x1050))_0x111c62='[图片:\x20'+_0x17f13e[_0x142abd(0xee1)]+']';else{if(_0x17f13e[_0x142abd(0xa6b)]===_0x142abd(0x7f4))_0x111c62=_0x142abd(0x4e3)+_0x17f13e['prompt']+']';else _0x111c62=String(_0x17f13e['content']);}}return _0x1c69d7+':\x20'+_0x111c62;})['join']('\x0a');_0x3d222c=_0x140d17(0x711)+_0x411111['sourceChatName']+_0x140d17(0xcbd)+_0x4ad728+_0x140d17(0x6ca);}let _0x1c7a49='';const _0x426c68=_0x897d3a[_0x140d17(0x886)][_0x140d17(0x1d8)]||0xa;if(_0x897d3a['settings']['linkedMemoryChatIds']&&_0x897d3a[_0x140d17(0x886)][_0x140d17(0x20c)]['length']>0x0){const _0x1695d4=_0x897d3a[_0x140d17(0x886)]['linkedMemoryChatIds'][_0x140d17(0x98a)](_0x256f76=>_0x256f76!==_0x350226);if(_0x1695d4[_0x140d17(0xfde)]>0x0){const _0x1d4de2=_0x1695d4['map'](_0x3db6db=>{const _0x3b25a8=_0x140d17,_0x4d0a64=_0x41df36['chats'][_0x3db6db];if(!_0x4d0a64)return null;const _0x5b4d47=_0x4d0a64[_0x3b25a8(0xd08)][_0x3b25a8(0x1368)](-0x1);return{'chat':_0x4d0a64,'latestTimestamp':_0x5b4d47?_0x5b4d47[_0x3b25a8(0x3b7)]:0x0};})[_0x140d17(0x98a)](Boolean);_0x1d4de2[_0x140d17(0x1296)]((_0x285a00,_0x2f9c6e)=>_0x2f9c6e[_0x140d17(0x1d0)]-_0x285a00[_0x140d17(0x1d0)]),_0x1c7a49+=_0x140d17(0x19a);for(const _0x21123b of _0x1d4de2){const _0x2893f0=_0x21123b[_0x140d17(0x135e)],_0x250dd4=_0x2893f0[_0x140d17(0x1a2)]?'[群聊]':_0x140d17(0x95c),_0x1c22ee=_0x21123b['latestTimestamp']>0x0?'\x20(最后互动于\x20'+_0xa3fdac(_0x21123b[_0x140d17(0x1d0)])+')':'';_0x1c7a49+='\x0a##\x20---\x20来自'+_0x250dd4+'“'+_0x2893f0[_0x140d17(0x461)]+_0x140d17(0x5aa)+_0x1c22ee+_0x140d17(0x1090);const _0x4964db=_0x2893f0[_0x140d17(0xd08)]['slice'](-_0x426c68),_0x438193=_0x4964db[_0x140d17(0x98a)](_0x394c8d=>!String(_0x394c8d[_0x140d17(0x11b6)])[_0x140d17(0xee2)](_0x140d17(0x1266)));_0x438193[_0x140d17(0xfde)]>0x0?_0x438193[_0x140d17(0x19c)](_0x5051b3=>{const _0x920fe3=_0x140d17,_0x44f3ae=_0x5051b3['role']==='user'?_0x2893f0['settings'][_0x920fe3(0x52e)]||'我':_0x5051b3[_0x920fe3(0x4c5)]||_0x2893f0[_0x920fe3(0x461)];let _0x1d936a=String(_0x5051b3[_0x920fe3(0x11b6)]);if(_0x5051b3[_0x920fe3(0xa6b)]===_0x920fe3(0x1050)||_0x5051b3[_0x920fe3(0xa6b)]==='user_photo')_0x1d936a=_0x920fe3(0x134a)+_0x5051b3[_0x920fe3(0x11b6)]+']';else _0x5051b3['type']===_0x920fe3(0xa4f)&&(_0x1d936a=_0x920fe3(0x290)+_0x5051b3[_0x920fe3(0x11b6)]+']');const _0x3e2e70=_0xa3fdac(_0x5051b3[_0x920fe3(0x3b7)]);_0x1c7a49+='('+_0x3e2e70+')\x20'+_0x44f3ae+':\x20'+_0x1d936a+'\x0a';}):_0x1c7a49+=_0x140d17(0x1249);}}}console[_0x140d17(0xe72)](_0x140d17(0x110d),_0x1c7a49);if(_0x897d3a['isGroup']){let _0x3c4c38='';const _0x2cf1ff=_0x897d3a[_0x140d17(0x886)]['linkedMemoryCount']||0xa;if(_0x897d3a[_0x140d17(0x886)]['linkedMemoryChatIds']&&_0x897d3a[_0x140d17(0x886)][_0x140d17(0x20c)][_0x140d17(0xfde)]>0x0){const _0x185a4e=_0x897d3a[_0x140d17(0x886)][_0x140d17(0x20c)][_0x140d17(0x98a)](_0x1627e0=>_0x1627e0!==_0x350226);if(_0x185a4e[_0x140d17(0xfde)]>0x0){const _0x40ed3a=_0x185a4e['map'](_0x57d8d6=>{const _0x127b4c=_0x140d17,_0x569c89=_0x41df36[_0x127b4c(0x864)][_0x57d8d6];if(!_0x569c89)return null;const _0x1fb5e6=_0x569c89['history']['slice'](-0x1);return{'chat':_0x569c89,'latestTimestamp':_0x1fb5e6?_0x1fb5e6[_0x127b4c(0x3b7)]:0x0};})['filter'](Boolean);_0x40ed3a['sort']((_0x4adeb3,_0x132459)=>_0x132459[_0x140d17(0x1d0)]-_0x4adeb3[_0x140d17(0x1d0)]),_0x3c4c38+='\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a';for(const _0x529385 of _0x40ed3a){const _0x58a55d=_0x529385['chat'],_0x440e16=_0x58a55d[_0x140d17(0x1a2)]?'[群聊]':'[私聊]',_0x2329e0=_0x529385[_0x140d17(0x1d0)]>0x0?'\x20(最后互动于\x20'+_0xa3fdac(_0x529385[_0x140d17(0x1d0)])+')':'';_0x3c4c38+=_0x140d17(0x11fe)+_0x440e16+'“'+_0x58a55d[_0x140d17(0x461)]+_0x140d17(0x5aa)+_0x2329e0+_0x140d17(0x1090);const _0x395645=_0x58a55d[_0x140d17(0xd08)][_0x140d17(0x1368)](-_0x2cf1ff),_0x3c020e=_0x395645[_0x140d17(0x98a)](_0x19b135=>!String(_0x19b135[_0x140d17(0x11b6)])[_0x140d17(0xee2)](_0x140d17(0x1266)));_0x3c020e['length']>0x0?_0x3c020e['forEach'](_0x4b0b7a=>{const _0x23541e=_0x140d17,_0x10a099=_0x4b0b7a[_0x23541e(0x10ff)]===_0x23541e(0x66e)?_0x58a55d[_0x23541e(0x886)]['myNickname']||'我':_0x4b0b7a['senderName']||_0x58a55d[_0x23541e(0x461)];let _0x56c0aa=String(_0x4b0b7a[_0x23541e(0x11b6)]);if(_0x4b0b7a[_0x23541e(0xa6b)]===_0x23541e(0x1050)||_0x4b0b7a[_0x23541e(0xa6b)]===_0x23541e(0xed0))_0x56c0aa=_0x23541e(0x134a)+_0x4b0b7a['content']+']';else _0x4b0b7a['type']===_0x23541e(0xa4f)&&(_0x56c0aa=_0x23541e(0x290)+_0x4b0b7a['content']+']');_0x3c4c38+=_0x10a099+':\x20'+_0x56c0aa+'\x0a';}):_0x3c4c38+=_0x140d17(0x1249);}}}let _0x2b4ded=_0x140d17(0x73d),_0xc9611e=![];_0x897d3a[_0x140d17(0x12a6)][_0x140d17(0x19c)](_0x459112=>{const _0xde554f=_0x140d17,_0xfad41a=_0x41df36[_0xde554f(0x864)][_0x459112['id']];_0xfad41a&&_0xfad41a[_0xde554f(0x1349)]&&_0xfad41a[_0xde554f(0x1349)][_0xde554f(0xfde)]>0x0&&(_0x2b4ded+=_0xde554f(0x6a4)+_0x459112['groupNickname']+'”的记忆\x20---\x0a',_0x2b4ded+=_0xfad41a['longTermMemory'][_0xde554f(0xa79)](_0x477057=>'-\x20(记录于\x20'+_0xa3fdac(_0x477057['timestamp'])+')\x20'+_0x477057[_0xde554f(0x11b6)])['join']('\x0a'),_0xc9611e=!![]);});!_0xc9611e&&(_0x2b4ded+=_0x140d17(0x7ae));let _0x2393a7='',_0xab2971=![];if(_0x897d3a[_0x140d17(0x886)]['enableTimePerception']){const _0x36714c=_0x46e6a0[_0x140d17(0x1368)](-0x1)[0x0];if(_0x36714c){const _0x24369d=_0x2235d5(_0x36714c[_0x140d17(0x3b7)]);_0x2393a7=_0x140d17(0xd80)+_0x24369d+'。';const _0x221603=(Date[_0x140d17(0x108d)]()-_0x36714c['timestamp'])/(0x3e8*0x3c*0x3c);if(_0x221603>0x3){_0xab2971=!![];const _0x154f77=Math[_0x140d17(0xdee)](_0x221603/0x18);_0x2393a7+='\x20群里已经安静了'+(_0x154f77>0x0?_0x154f77+'天':Math[_0x140d17(0xdee)](_0x221603)+'小时')+'。';}}else _0x2393a7='这是群里的第一条消息。';}const _0x575f1b=await _0x342df8[_0x140d17(0xd18)][_0x140d17(0x21f)]();let _0x5ab3e4='';_0x575f1b['length']>0x0&&(_0x5ab3e4='\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a',_0x575f1b[_0x140d17(0x19c)](_0x31a911=>{const _0x277b54=_0x140d17;_0x5ab3e4+='-\x20(ID:\x20'+_0x31a911['id']+')\x20商品:\x20'+_0x31a911[_0x277b54(0x461)]+',\x20价格:\x20¥'+_0x31a911['price']['toFixed'](0x2)+'\x0a';}));let _0x3f319a=_0x897d3a['members']['map'](_0x4cc1ee=>{const _0x4a009a=_0x140d17,_0x2d985f=_0x41df36[_0x4a009a(0x864)][_0x4cc1ee['id']];let _0x1cef31=_0x4a009a(0xf47);if(_0x2d985f&&_0x2d985f['groupId']){const _0x34c2be=Object['values'](_0x41df36[_0x4a009a(0x864)])[_0x4a009a(0x98a)](_0x474815=>!_0x474815[_0x4a009a(0x1a2)]&&_0x474815['id']!==_0x4cc1ee['id']&&_0x474815[_0x4a009a(0x11a6)]===_0x2d985f['groupId']);_0x34c2be[_0x4a009a(0xfde)]>0x0&&(_0x1cef31=_0x4a009a(0xb97)+_0x34c2be[_0x4a009a(0xa79)](_0xf174be=>_0xf174be['name'])[_0x4a009a(0xa35)]('、\x20'));}return'-\x20**'+_0x4cc1ee[_0x4a009a(0x9da)]+'**\x20(本名:\x20'+_0x4cc1ee[_0x4a009a(0x283)]+_0x4a009a(0x12a8)+_0x4cc1ee['persona']+_0x4a009a(0xb26)+_0x1cef31+']';})[_0x140d17(0xa35)]('\x0a');const _0x19b86b=_0x897d3a[_0x140d17(0x886)][_0x140d17(0x52e)]||'我',_0x59a5ce=_0x41df36[_0x140d17(0x571)]['nickname']||_0x140d17(0x7da);let _0x281389='';const _0x3914b7=(_0x897d3a[_0x140d17(0xd3f)]||[])[_0x140d17(0x98a)](_0x3f888c=>_0x3f888c[_0x140d17(0x521)]);_0x3914b7[_0x140d17(0xfde)]>0x0&&(_0x281389+=_0x140d17(0x765),_0x3914b7[_0x140d17(0x19c)](_0x2259ea=>{const _0x2fcae1=_0x140d17,_0x587235=_0x897d3a[_0x2fcae1(0xd08)]['find'](_0xe1a15c=>_0xe1a15c[_0x2fcae1(0x3b7)]===_0x2259ea[_0x2fcae1(0x215)]);if(_0x587235){let _0x15255b=String(_0x587235['content']||'');_0x587235[_0x2fcae1(0xa6b)]===_0x2fcae1(0x1050)&&(_0x15255b='[图片内容:\x20'+_0x15255b+']'),_0x281389+='-\x20公告内容:\x20\x22'+_0x15255b+_0x2fcae1(0x1085)+_0x2259ea['publisher']+_0x2fcae1(0x1276);}}),_0x281389+=_0x140d17(0x4a5));const _0x4cd66a=_0x897d3a['members'][_0x140d17(0xa79)](_0x27a9c6=>_0x27a9c6[_0x140d17(0x283)]),_0x425415='#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：['+_0x4cd66a[_0x140d17(0xa35)]('、\x20')+']';let _0x2d62ee=_0x140d17(0x101d);_0x897d3a[_0x140d17(0x886)][_0x140d17(0x34a)]&&_0x897d3a[_0x140d17(0x886)][_0x140d17(0x34a)]['length']>0x0?_0x2d62ee+=_0x897d3a['settings'][_0x140d17(0x34a)][_0x140d17(0xa79)](_0x2c111f=>'-\x20'+_0x2c111f[_0x140d17(0x461)])[_0x140d17(0xa35)]('\x0a'):_0x2d62ee+='-\x20(头像库是空的，无法更换头像)';const _0x37c348=_0x600639(_0x350226),_0x3aa906=_0x1ad6bb(_0x897d3a,0x3,_0x140d17(0x2f2)),_0x419cb2=_0x1ad6bb(_0x897d3a,0x6,_0x140d17(0x2f2)),_0xc4c773=_0x1ad6bb(_0x897d3a,0x9,_0x140d17(0x2f2)),_0x1ccc55=_0x1ad6bb(_0x897d3a,0x1,_0x140d17(0x103b)),_0x338249=_0x1ad6bb(_0x897d3a,0x3,_0x140d17(0x103b)),_0x4b68ef=_0x1ad6bb(_0x897d3a,0x7,_0x140d17(0x103b));let _0x367dff='';if(_0x3aa906||_0x419cb2||_0xc4c773||_0x1ccc55||_0x338249||_0x4b68ef){_0x367dff+=_0x140d17(0xf2a);if(_0x3aa906)_0x367dff+=_0x3aa906;if(_0x419cb2)_0x367dff+=_0x419cb2;if(_0xc4c773)_0x367dff+=_0xc4c773;if(_0x3aa906||_0x419cb2||_0xc4c773)_0x367dff+='\x0a';if(_0x1ccc55)_0x367dff+=_0x1ccc55;if(_0x338249)_0x367dff+=_0x338249;if(_0x4b68ef)_0x367dff+=_0x4b68ef;}const _0x4999c5=_0x37dbe7(_0x897d3a);_0x307319='\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a2.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【'+_0x19b86b+'】，本名是【'+_0x59a5ce+'】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22'+_0x19b86b+_0x140d17(0x3c9)+_0x897d3a['name']+_0x140d17(0x20b)+(_0x897d3a[_0x140d17(0x886)][_0x140d17(0xfc8)]?_0x140d17(0x302)+_0x2b8b90+_0x140d17(0x8b7)+(_0xab2971?_0x140d17(0x86a)+_0x2393a7+_0x140d17(0x1aa):''):'')+_0x140d17(0x3e8)+(_0x37c348?_0x140d17(0x125)+_0x37c348:_0x140d17(0x6ea))+_0x140d17(0xc55)+_0x897d3a[_0x140d17(0x461)]+'\x0a'+(_0x897d3a[_0x140d17(0x886)]['enableTimePerception']?_0x140d17(0x255)+_0x2393a7:'')+'\x0a\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a'+_0x3f319a+_0x140d17(0x3a8)+_0x19b86b+_0x140d17(0xf76)+_0x897d3a[_0x140d17(0x886)]['myPersona']+_0x140d17(0xbf1)+_0x51028d+'\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a'+_0x2b4ded+'\x0a'+(_0x897d3a[_0x140d17(0x1349)]&&_0x897d3a['longTermMemory']['length']>0x0?_0x897d3a[_0x140d17(0x1349)][_0x140d17(0xa79)](_0x2eb531=>'-\x20'+_0x2eb531[_0x140d17(0x11b6)])[_0x140d17(0xa35)]('\x0a'):_0x140d17(0x7ae))+'\x0a'+_0x367dff+'\x0a'+_0x3c4c38+'\x0a'+_0x28a264+'\x0a'+_0x3d222c+'\x0a'+_0x2d62ee+_0x140d17(0x109a)+_0x4999c5+'\x0a'+_0x425415+'\x0a'+_0x1e9d70+_0x140d17(0x3d3)+(localStorage[_0x140d17(0xb2)](_0x140d17(0x846))==='true'?_0x140d17(0x362):'')+_0x140d17(0xa57),_0x3009ad=_0x46e6a0[_0x140d17(0xa79)](_0x2d63a9=>{const _0x2e05fa=_0x140d17,_0x3dea3b=_0x2d63a9[_0x2e05fa(0x10ff)]==='user'?_0x19b86b:_0x2d63a9[_0x2e05fa(0x4c5)];let _0x42e0e3=''+_0x3dea3b;if(_0x2d63a9['quote']){const _0x28cd27=String(_0x2d63a9[_0x2e05fa(0x8ff)][_0x2e05fa(0x11b6)]||'')['substring'](0x0,0x32);_0x42e0e3+=_0x2e05fa(0x2f9)+_0x2d63a9[_0x2e05fa(0x8ff)][_0x2e05fa(0x4c5)]+_0x2e05fa(0x39b)+_0x28cd27+_0x2e05fa(0x12e9);}_0x42e0e3+=':\x20';let _0x4fc85c;if(_0x2d63a9[_0x2e05fa(0xa6b)]==='user_photo')_0x4fc85c='['+_0x3dea3b+_0x2e05fa(0xf09)+_0x2d63a9[_0x2e05fa(0x11b6)]+'\x27]';else{if(_0x2d63a9[_0x2e05fa(0xa6b)]===_0x2e05fa(0x1050))_0x4fc85c='['+_0x3dea3b+_0x2e05fa(0x1265)+_0x2d63a9['content']+'\x27]';else{if(_0x2d63a9['type']===_0x2e05fa(0x7f4))_0x4fc85c='['+_0x3dea3b+_0x2e05fa(0xa05)+_0x2d63a9[_0x2e05fa(0x357)]+']';else{if(_0x2d63a9[_0x2e05fa(0xa6b)]==='voice_message')_0x4fc85c='['+_0x3dea3b+_0x2e05fa(0x1230)+_0x2d63a9[_0x2e05fa(0x11b6)]+'\x27]';else{if(_0x2d63a9[_0x2e05fa(0xa6b)]==='transfer')_0x4fc85c='['+_0x2d63a9[_0x2e05fa(0x4c5)]+_0x2e05fa(0x1272)+_0x2d63a9[_0x2e05fa(0x30f)]+_0x2e05fa(0x614)+_0x2d63a9[_0x2e05fa(0xe27)]+'元,\x20备注:\x20'+_0x2d63a9[_0x2e05fa(0x775)]+']';else{if(_0x2d63a9['type']===_0x2e05fa(0x15a))_0x4fc85c='['+_0x3dea3b+'\x20分享了Ta的位置：\x27'+_0x2d63a9[_0x2e05fa(0x11b6)]+'\x27]';else{if(_0x2d63a9[_0x2e05fa(0xa6b)]===_0x2e05fa(0xcf0)){const _0x5aa6d6=_0x2d63a9[_0x2e05fa(0x1051)]?_0x2e05fa(0x359)+_0x2d63a9['repostComment']+'”':'';let _0x379bf7=_0x2e05fa(0x12ba);const _0x4625a1=_0x2d63a9[_0x2e05fa(0xba8)][_0x2e05fa(0x1301)];if(_0x4625a1===_0x2e05fa(0x66e))_0x379bf7=_0x41df36[_0x2e05fa(0x571)][_0x2e05fa(0xabb)];else _0x41df36['chats'][_0x4625a1]&&(_0x379bf7=_0x41df36[_0x2e05fa(0x864)][_0x4625a1]['name']);let _0x460288;const _0x17571d=_0x2d63a9[_0x2e05fa(0xba8)];if(_0x17571d[_0x2e05fa(0xa6b)]===_0x2e05fa(0x68e))_0x460288=_0x2e05fa(0xee0)+(_0x17571d['publicText']||'')+_0x2e05fa(0xc6)+(_0x17571d[_0x2e05fa(0x4e6)]||'')['substring'](0x0,0x28)+_0x2e05fa(0x113c);else _0x17571d['type']===_0x2e05fa(0xe9d)?_0x460288='[图片]\x20'+(_0x17571d[_0x2e05fa(0xbdc)]||'')+_0x2e05fa(0xc6)+(_0x17571d['imageDescription']||'')['substring'](0x0,0x28)+_0x2e05fa(0x113c):_0x460288='“'+(_0x17571d['content']||'')[_0x2e05fa(0xba5)](0x0,0x28)+_0x2e05fa(0xd61);_0x4fc85c='['+_0x3dea3b+_0x2e05fa(0x954)+_0x379bf7+_0x2e05fa(0x11e1)+_0x5aa6d6+_0x2e05fa(0xb80)+_0x460288+'】]';}else{if(_0x2d63a9[_0x2e05fa(0xa6b)]===_0x2e05fa(0x990))_0x2d63a9[_0x2e05fa(0x1fe)]===_0x2e05fa(0x96d)?_0x4fc85c=_0x2e05fa(0x7d2)+_0x2d63a9['paidBy']+_0x2e05fa(0x907)+_0x3dea3b+_0x2e05fa(0xf3b)+_0x2d63a9[_0x2e05fa(0xe27)]+'\x20元。此订单已完成。]':_0x4fc85c='['+_0x3dea3b+'\x20发起了外卖代付请求，商品是“'+_0x2d63a9[_0x2e05fa(0x12b1)]+_0x2e05fa(0x937)+_0x2d63a9[_0x2e05fa(0xe27)]+'\x20元，订单时间戳为\x20'+_0x2d63a9[_0x2e05fa(0x3b7)]+']';else{if(_0x2d63a9[_0x2e05fa(0xa6b)]===_0x2e05fa(0xf55)){const _0x9db94c=_0x2d63a9[_0x2e05fa(0x4c5)]===_0x19b86b?'用户\x20('+_0x19b86b+')':_0x2d63a9[_0x2e05fa(0x4c5)];let _0x5a87cb;_0x2d63a9[_0x2e05fa(0x1350)]==='direct'?_0x5a87cb='[系统提示：'+_0x9db94c+'\x20发送了一个【专属红包】(时间戳:\x20'+_0x2d63a9[_0x2e05fa(0x3b7)]+')，接收人是“'+_0x2d63a9['receiverName']+_0x2e05fa(0x25f)+_0x2d63a9[_0x2e05fa(0x30f)]+_0x2e05fa(0x75e):_0x5a87cb=_0x2e05fa(0x7d2)+_0x9db94c+_0x2e05fa(0xf75)+_0x2d63a9[_0x2e05fa(0x3b7)]+_0x2e05fa(0x1242)+_0x2d63a9[_0x2e05fa(0xe12)]+_0x2e05fa(0xd13),_0x4fc85c=_0x5a87cb;}else{if(_0x2d63a9[_0x2e05fa(0xa6b)]===_0x2e05fa(0x980)){const _0x157e3e=_0x2d63a9[_0x2e05fa(0x10ff)]===_0x2e05fa(0x66e)?_0x19b86b:_0x54d0ab(_0x897d3a,_0x2d63a9[_0x2e05fa(0x4c5)]),_0x2e73e6=_0x2d63a9['items'][_0x2e05fa(0xa79)](_0x507a98=>_0x507a98['name']+'\x20x'+_0x507a98[_0x2e05fa(0x257)])[_0x2e05fa(0xa35)]('、\x20');let _0xa8ba3c='';if(_0x2d63a9[_0x2e05fa(0xbdb)]&&_0x2d63a9[_0x2e05fa(0xbdb)][_0x2e05fa(0xfde)]>0x0){const _0x1ed3a7=_0x2d63a9[_0x2e05fa(0xbdb)][_0x2e05fa(0xa79)](_0x158451=>_0x54d0ab(_0x897d3a,_0x158451))[_0x2e05fa(0xa35)]('、\x20');_0xa8ba3c='送给了\x20'+_0x1ed3a7;}else _0xa8ba3c=_0x2e05fa(0x79c);return _0x4fc85c=_0x2e05fa(0x7d2)+_0x157e3e+'\x20'+_0xa8ba3c+_0x2e05fa(0x120e)+_0x2e73e6+']',{'role':_0x2e05fa(0x66e),'content':_0x4fc85c};}else{if(_0x2d63a9[_0x2e05fa(0xa6b)]===_0x2e05fa(0x11b9)){const _0x3dc6b5=Object[_0x2e05fa(0x76d)](_0x2d63a9['votes']||{})[_0x2e05fa(0x117a)]()['join'](',\x20')||'还没有人';_0x4fc85c=_0x2e05fa(0x7d2)+_0x2d63a9[_0x2e05fa(0x4c5)]+'\x20发起了一个投票\x20(时间戳:\x20'+_0x2d63a9[_0x2e05fa(0x3b7)]+_0x2e05fa(0xdde)+_0x2d63a9[_0x2e05fa(0xca8)]+_0x2e05fa(0x6e8)+_0x2d63a9[_0x2e05fa(0x904)][_0x2e05fa(0xa35)](',\x20')+_0x2e05fa(0x7dd)+_0x3dc6b5+'。你可以使用\x20\x27vote\x27\x20指令参与投票。]';}else{if(_0x2d63a9[_0x2e05fa(0x7de)])_0x4fc85c=_0x3dea3b+_0x2e05fa(0xf1f)+_0x2d63a9[_0x2e05fa(0x7de)]+'\x27]';else{if(Array[_0x2e05fa(0x565)](_0x2d63a9[_0x2e05fa(0x11b6)]))return{'role':'user','content':[..._0x2d63a9[_0x2e05fa(0x11b6)],{'type':_0x2e05fa(0x6af),'text':_0x42e0e3}]};else _0x4fc85c=''+_0x42e0e3+_0x2d63a9[_0x2e05fa(0x11b6)];}}}}}}}}}}}}return{'role':_0x2e05fa(0x66e),'content':_0x4fc85c};})[_0x140d17(0x98a)](Boolean);}else{const _0x433142=_0x897d3a[_0x140d17(0x886)][_0x140d17(0xf49)],_0x1aa96c=_0xd83680(_0x897d3a);let _0x42059e='';_0x897d3a['settings'][_0x140d17(0x1380)]&&_0x897d3a[_0x140d17(0xa52)]&&!_0x433142&&(_0x42059e='\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20'+_0x897d3a[_0x140d17(0xa52)]+_0x140d17(0x84c)+_0x897d3a['randomJottings']+'\x0a');let _0x3f03bd='';const _0x1d6818=_0x897d3a[_0x140d17(0x886)][_0x140d17(0x1d8)]||0xa;if(_0x897d3a[_0x140d17(0x886)]['linkedMemoryChatIds']&&_0x897d3a['settings'][_0x140d17(0x20c)][_0x140d17(0xfde)]>0x0){const _0x4a1efd=_0x897d3a[_0x140d17(0x886)]['linkedMemoryChatIds']['filter'](_0x24546c=>_0x24546c!==_0x350226);if(_0x4a1efd[_0x140d17(0xfde)]>0x0){const _0x1b5904=_0x4a1efd['map'](_0x44e477=>{const _0x47df3d=_0x140d17,_0x17ca7b=_0x41df36[_0x47df3d(0x864)][_0x44e477];if(!_0x17ca7b)return null;const _0x2173f2=_0x17ca7b['history'][_0x47df3d(0x1368)](-0x1)[0x0];return{'chat':_0x17ca7b,'latestTimestamp':_0x2173f2?_0x2173f2[_0x47df3d(0x3b7)]:0x0};})[_0x140d17(0x98a)](Boolean);_0x1b5904['sort']((_0x294e16,_0x2579a4)=>_0x2579a4['latestTimestamp']-_0x294e16[_0x140d17(0x1d0)]),_0x3f03bd+=_0x140d17(0x19a);for(const _0x6ebe9f of _0x1b5904){const _0x31a88e=_0x6ebe9f[_0x140d17(0x135e)],_0x59d70a=_0x31a88e['isGroup']?'[群聊]':_0x140d17(0x95c),_0x143dc9=_0x6ebe9f[_0x140d17(0x1d0)]>0x0?_0x140d17(0x713)+_0xa3fdac(_0x6ebe9f[_0x140d17(0x1d0)])+')':'';_0x3f03bd+=_0x140d17(0x11fe)+_0x59d70a+'“'+_0x31a88e[_0x140d17(0x461)]+_0x140d17(0x5aa)+_0x143dc9+_0x140d17(0x1090);const _0x8f6010=_0x31a88e['history'][_0x140d17(0x1368)](-_0x1d6818),_0x507b47=_0x8f6010[_0x140d17(0x98a)](_0x2ed790=>!String(_0x2ed790[_0x140d17(0x11b6)])[_0x140d17(0xee2)](_0x140d17(0x1266)));_0x507b47[_0x140d17(0xfde)]>0x0?_0x507b47['forEach'](_0x240bf1=>{const _0x534614=_0x140d17,_0x2b37c1=_0x240bf1[_0x534614(0x10ff)]===_0x534614(0x66e)?_0x31a88e[_0x534614(0x886)][_0x534614(0x52e)]||'我':_0x240bf1[_0x534614(0x4c5)]||_0x31a88e[_0x534614(0x461)];let _0x388ffd=String(_0x240bf1[_0x534614(0x11b6)]);if(_0x240bf1[_0x534614(0xa6b)]===_0x534614(0x1050)||_0x240bf1['type']===_0x534614(0xed0))_0x388ffd=_0x534614(0x134a)+_0x240bf1[_0x534614(0x11b6)]+']';else _0x240bf1[_0x534614(0xa6b)]===_0x534614(0xa4f)&&(_0x388ffd=_0x534614(0x290)+_0x240bf1[_0x534614(0x11b6)]+']');const _0x5d47bd=_0xa3fdac(_0x240bf1[_0x534614(0x3b7)]);_0x3f03bd+='('+_0x5d47bd+')\x20'+_0x2b37c1+':\x20'+_0x388ffd+'\x0a';}):_0x3f03bd+=_0x140d17(0x1249);}}}const _0x4882ee=await _0x342df8[_0x140d17(0xd18)][_0x140d17(0x21f)]();let _0x3405ee='';_0x4882ee[_0x140d17(0xfde)]>0x0&&(_0x3405ee=_0x140d17(0x535),_0x4882ee[_0x140d17(0x19c)](_0x54cc2a=>{const _0x3743aa=_0x140d17;_0x3405ee+=_0x3743aa(0x85e)+_0x54cc2a['id']+_0x3743aa(0xda3)+_0x54cc2a[_0x3743aa(0x461)]+',\x20价格:\x20¥'+_0x54cc2a[_0x3743aa(0xa19)]['toFixed'](0x2)+'\x0a';}));if(_0x433142){const _0x5d205c=_0x897d3a[_0x140d17(0x886)][_0x140d17(0x58f)]||0x64,_0x6c4350=_0x897d3a[_0x140d17(0x886)]['offlineMaxLength']||0x12c,_0x583cc9=_0x897d3a[_0x140d17(0x886)]['myNickname']||'我';let _0x5726fc='';if(_0x897d3a[_0x140d17(0x886)][_0x140d17(0xca5)]){const _0x1f98f8=_0x41df36['presets']['find'](_0x4ac376=>_0x4ac376['id']===_0x897d3a[_0x140d17(0x886)]['offlinePresetId']);if(_0x1f98f8&&Array[_0x140d17(0x565)](_0x1f98f8[_0x140d17(0x11b6)])){const _0x237c13=_0x1f98f8[_0x140d17(0x11b6)][_0x140d17(0x98a)](_0x11a203=>_0x11a203['enabled']!==![])[_0x140d17(0xa79)](_0x1697df=>'-\x20'+_0x1697df[_0x140d17(0x11b6)])[_0x140d17(0xa35)]('\x0a');_0x237c13&&(_0x5726fc='\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a'+_0x237c13+'\x0a---\x0a');}}_0x307319=_0x140d17(0x38e)+_0x897d3a[_0x140d17(0x283)]+_0x140d17(0x139d)+_0x5726fc+'\x0a#\x20你的角色设定：\x0a你必须严格遵守'+_0x897d3a[_0x140d17(0x886)][_0x140d17(0xd83)]+_0x140d17(0x7b4)+_0x897d3a[_0x140d17(0x886)][_0x140d17(0xe63)]+'\x0a\x0a#\x20供你参考的信息\x0a'+(_0x897d3a[_0x140d17(0x886)][_0x140d17(0xfc8)]?_0x140d17(0x2e6)+_0x2b8b90+'\x20('+_0x3df235+')':'')+_0x140d17(0x8d)+_0x51028d+'\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a'+(_0x897d3a[_0x140d17(0x1349)]&&_0x897d3a[_0x140d17(0x1349)][_0x140d17(0xfde)]>0x0?_0x897d3a[_0x140d17(0x1349)]['map'](_0x58a6ac=>'-\x20'+_0x58a6ac[_0x140d17(0x11b6)])[_0x140d17(0xa35)]('\x0a'):'-\x20(暂无)')+'\x0a\x0a'+_0x3f03bd+_0x140d17(0x101c)+_0x46e6a0[_0x140d17(0xa79)](_0x5f26de=>{const _0x4a761c=_0x140d17;let _0x3e0add=(_0x5f26de['role']===_0x4a761c(0x66e)?_0x583cc9:_0x897d3a[_0x4a761c(0x461)])+':\x20';return _0x5f26de['type']==='offline_text'?_0x3e0add+='「'+(_0x5f26de[_0x4a761c(0x5ed)]||'')+'」\x20'+(_0x5f26de[_0x4a761c(0xee1)]||''):_0x3e0add+=String(_0x5f26de[_0x4a761c(0x11b6)]),_0x3e0add;})[_0x140d17(0xa35)]('\x0a')+_0x140d17(0xd81)+_0x5d205c+'到'+_0x6c4350+'字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a',_0x3009ad=_0x46e6a0[_0x140d17(0xa79)](_0x5cf345=>{const _0x1e4a73=_0x140d17;if(_0x5cf345[_0x1e4a73(0xbc5)])return null;if(_0x5cf345[_0x1e4a73(0xa6b)]===_0x1e4a73(0x44e)){const _0x528af0=_0x5cf345[_0x1e4a73(0x10ff)]==='user'?_0x897d3a['settings'][_0x1e4a73(0x52e)]||'我':_0x897d3a[_0x1e4a73(0x461)];let _0x3d0a8d='';if(_0x5cf345[_0x1e4a73(0x11b6)])_0x3d0a8d=_0x5cf345[_0x1e4a73(0x11b6)];else{const _0x496102=_0x5cf345['dialogue']?'「'+_0x5cf345[_0x1e4a73(0x5ed)]+'」':'',_0x1120d6=_0x5cf345[_0x1e4a73(0xee1)]?'('+_0x5cf345[_0x1e4a73(0xee1)]+')':'';_0x3d0a8d=(_0x496102+'\x20'+_0x1120d6)[_0x1e4a73(0x1cb)]();}return{'role':_0x5cf345['role'],'content':_0x528af0+':\x20'+_0x3d0a8d};}if(_0x5cf345[_0x1e4a73(0x10ff)]===_0x1e4a73(0x66e)){const _0x331260=_0x583cc9+':\x20';let _0x256d07='';if(Array[_0x1e4a73(0x565)](_0x5cf345[_0x1e4a73(0x11b6)])&&_0x5cf345[_0x1e4a73(0x11b6)][0x0]?.[_0x1e4a73(0xa6b)]===_0x1e4a73(0x122d))return{'role':_0x1e4a73(0x66e),'content':[{'type':'text','text':_0x331260},..._0x5cf345[_0x1e4a73(0x11b6)]]};if(_0x5cf345[_0x1e4a73(0x8ff)]){const _0x3d7a77=String(_0x5cf345[_0x1e4a73(0x8ff)]['content']||'')[_0x1e4a73(0xba5)](0x0,0x32);_0x256d07+=_0x1e4a73(0xc9a)+_0x5cf345[_0x1e4a73(0x8ff)][_0x1e4a73(0x4c5)]+_0x1e4a73(0x39b)+_0x3d7a77+_0x1e4a73(0x5d2)+_0x5cf345[_0x1e4a73(0x11b6)];}else _0x256d07+=_0x5cf345[_0x1e4a73(0x11b6)];if(_0x5cf345['type']===_0x1e4a73(0xed0))return{'role':_0x1e4a73(0x66e),'content':_0x331260+'[你发送了一张需要AI识别的图片，图片内容是：\x27'+_0x5cf345['content']+'\x27]'};if(_0x5cf345['type']===_0x1e4a73(0xa4f))return{'role':_0x1e4a73(0x66e),'content':_0x331260+'[你发送了一条语音消息，内容是：\x27'+_0x5cf345[_0x1e4a73(0x11b6)]+'\x27]'};if(_0x5cf345[_0x1e4a73(0xa6b)]==='transfer')return{'role':'user','content':_0x331260+_0x1e4a73(0x721)+_0x5cf345['timestamp']+_0x1e4a73(0x720)+_0x5cf345[_0x1e4a73(0xe27)]+_0x1e4a73(0x1ab)+_0x5cf345[_0x1e4a73(0x775)]+_0x1e4a73(0xb4a)};if(_0x5cf345[_0x1e4a73(0xa6b)]===_0x1e4a73(0x990))return{'role':_0x1e4a73(0x66e),'content':_0x331260+_0x1e4a73(0x721)+_0x5cf345[_0x1e4a73(0x3b7)]+'\x20发起了外卖代付请求，商品是“'+_0x5cf345[_0x1e4a73(0x12b1)]+'”，金额是\x20'+_0x5cf345[_0x1e4a73(0xe27)]+_0x1e4a73(0x11c)};else{if(_0x5cf345[_0x1e4a73(0xa6b)]===_0x1e4a73(0x980)){const _0x684735=_0x5cf345[_0x1e4a73(0x959)][_0x1e4a73(0xa79)](_0x1ac06d=>_0x1ac06d[_0x1e4a73(0x461)]+'\x20x'+_0x1ac06d[_0x1e4a73(0x257)])[_0x1e4a73(0xa35)]('、\x20');let _0xb797a2=_0x897d3a[_0x1e4a73(0x1a2)]?'送给了\x20'+_0x5cf345[_0x1e4a73(0xbdb)][_0x1e4a73(0xa79)](_0x41cfa1=>_0x54d0ab(_0x897d3a,_0x41cfa1))['join']('、\x20'):_0x1e4a73(0xf97)+_0x897d3a[_0x1e4a73(0x461)];return{'role':_0x1e4a73(0x66e),'content':_0x331260+_0x1e4a73(0x2cc)+_0xb797a2+_0x1e4a73(0x120e)+_0x684735+']'};}}if(_0x5cf345[_0x1e4a73(0x7de)])return{'role':'user','content':_0x331260+'[你发送了一个表情，意思是：\x27'+_0x5cf345[_0x1e4a73(0x7de)]+'\x27]'};return{'role':_0x5cf345[_0x1e4a73(0x10ff)],'content':_0x331260+_0x256d07};}else{if(_0x5cf345['role']==='assistant'){let _0xc6753d={'type':_0x5cf345['type']||_0x1e4a73(0x6af)};if(_0x5cf345[_0x1e4a73(0xa6b)]==='sticker')_0xc6753d[_0x1e4a73(0x2fa)]=_0x5cf345[_0x1e4a73(0x11b6)],_0xc6753d[_0x1e4a73(0x7de)]=_0x5cf345['meaning'];else{if(_0x5cf345[_0x1e4a73(0xa6b)]===_0x1e4a73(0x909))_0xc6753d['amount']=_0x5cf345['amount'],_0xc6753d[_0x1e4a73(0x775)]=_0x5cf345[_0x1e4a73(0x775)];else _0x5cf345[_0x1e4a73(0xa6b)]===_0x1e4a73(0x990)?(_0xc6753d[_0x1e4a73(0x12b1)]=_0x5cf345[_0x1e4a73(0x12b1)],_0xc6753d[_0x1e4a73(0xe27)]=_0x5cf345[_0x1e4a73(0xe27)]):_0x5cf345[_0x1e4a73(0x8ff)]?_0xc6753d['quote_reply']={'target_sender':_0x5cf345[_0x1e4a73(0x8ff)]['senderName'],'target_content':_0x5cf345[_0x1e4a73(0x8ff)][_0x1e4a73(0x11b6)],'reply_content':_0x5cf345[_0x1e4a73(0x11b6)]}:_0xc6753d[_0x1e4a73(0x11b6)]=_0x5cf345[_0x1e4a73(0x11b6)];}const _0x1a49b8=JSON[_0x1e4a73(0x3fb)]([_0xc6753d]);return{'role':_0x1e4a73(0xf3c),'content':_0x1e4a73(0x9ed)+_0x5cf345[_0x1e4a73(0x3b7)]+')\x20'+_0x1a49b8};}}return null;})['filter'](Boolean);}else{let _0x51170f='';_0x897d3a[_0x140d17(0xcf9)]&&_0x897d3a[_0x140d17(0xcf9)]['length']>0x0&&(_0x51170f=_0x140d17(0xe10)+_0x897d3a[_0x140d17(0xcf9)][_0x140d17(0xa35)](',\x20')+']。当在对话历史中看到这些名字时，它们都指的是【你】自己。');let _0x368813='';const _0x3a332d=_0x41df36[_0x140d17(0x571)]['nickname']||'用户';_0x368813+=_0x140d17(0x1220)+_0x3a332d+'\x22。\x0a';const _0x306e0f=Object[_0x140d17(0x76d)](_0x41df36['chats']),_0x50a21a=_0x306e0f[_0x140d17(0x98a)](_0x5934c0=>_0x5934c0[_0x140d17(0x1a2)]&&_0x5934c0['members'][_0x140d17(0x12fb)](_0x37b560=>_0x37b560['id']===_0x897d3a['id']));_0x50a21a[_0x140d17(0xfde)]>0x0&&(_0x368813+=_0x140d17(0x3f4),_0x50a21a[_0x140d17(0x19c)](_0x368af8=>{const _0x5de19e=_0x140d17,_0x4628e8=_0x368af8[_0x5de19e(0x886)][_0x5de19e(0x52e)]||_0x3a332d;_0x368813+='\x20\x20-\x20在群聊“'+_0x368af8[_0x5de19e(0x461)]+_0x5de19e(0xc34)+_0x4628e8+_0x5de19e(0xf1a);}));_0x368813+=_0x140d17(0x7cd);let _0x18ed15='';const _0x470b9c=_0x306e0f[_0x140d17(0x98a)](_0x2ff208=>!_0x2ff208['isGroup']&&_0x2ff208['id']!==_0x897d3a['id']&&_0x2ff208[_0x140d17(0x11a6)]===_0x897d3a[_0x140d17(0x11a6)]&&_0x897d3a[_0x140d17(0x11a6)]!==null);_0x470b9c[_0x140d17(0xfde)]>0x0&&(_0x18ed15+='\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a',_0x470b9c[_0x140d17(0x19c)](_0x1ce56d=>{const _0x55debd=_0x140d17;_0x18ed15+=_0x55debd(0x67d)+_0x1ce56d['name']+_0x55debd(0x40b)+_0x1ce56d[_0x55debd(0x283)]+')\x0a';}));const _0x637e1c=await _0x342df8[_0x140d17(0x35a)][_0x140d17(0x4b1)]('timestamp')['reverse']()[_0x140d17(0xc33)](0xa)['toArray'](),_0x54848e=_0x29938a(_0x637e1c,_0x897d3a);let _0x50c013='';if(_0x54848e['length']>0x0){_0x50c013=_0x140d17(0xc7c);const _0x18197b=_0x897d3a[_0x140d17(0x283)];for(const _0xb2d5db of _0x54848e){let _0x5b1d7b;if(_0xb2d5db[_0x140d17(0x1301)]===_0x140d17(0x66e))_0x5b1d7b=_0x41df36[_0x140d17(0x571)][_0x140d17(0xabb)];else{if(String(_0xb2d5db['authorId'])[_0x140d17(0x1122)]('npc_'))_0x5b1d7b=_0xb2d5db['authorOriginalName']||_0x140d17(0x762);else{const _0x38a205=_0x41df36['chats'][_0xb2d5db['authorId']];_0x5b1d7b=_0x38a205?_0x38a205[_0x140d17(0x461)]:'一位朋友';}}if(_0xb2d5db[_0x140d17(0x1301)]===_0x350226)_0x5b1d7b+=_0x140d17(0x11bf);let _0x16d432;if(_0xb2d5db['type']==='repost'){const _0x8ba75c=_0xb2d5db[_0x140d17(0x1051)]?_0x140d17(0x2f3)+_0xb2d5db[_0x140d17(0x1051)]+'\x22':'';let _0x23a7e1='原作者';const _0x13e8a0=_0xb2d5db[_0x140d17(0xba8)][_0x140d17(0x1301)];if(_0x13e8a0===_0x140d17(0x66e))_0x23a7e1=_0x41df36[_0x140d17(0x571)][_0x140d17(0xabb)];else _0x41df36['chats'][_0x13e8a0]&&(_0x23a7e1=_0x41df36[_0x140d17(0x864)][_0x13e8a0][_0x140d17(0x461)]);let _0x2560af;const _0xb65ad7=_0xb2d5db[_0x140d17(0xba8)];if(_0xb65ad7[_0x140d17(0xa6b)]==='text_image')_0x2560af=_0x140d17(0xee0)+(_0xb65ad7[_0x140d17(0xbdc)]||'')+'\x20(图片描述:\x20\x22'+(_0xb65ad7[_0x140d17(0x4e6)]||'')[_0x140d17(0xba5)](0x0,0x28)+'...\x22)';else _0xb65ad7[_0x140d17(0xa6b)]==='image_post'?_0x2560af=_0x140d17(0x6b4)+(_0xb65ad7[_0x140d17(0xbdc)]||'')+_0x140d17(0x1b8)+(_0xb65ad7[_0x140d17(0x8cf)]||'')[_0x140d17(0xba5)](0x0,0x28)+'...\x22)':_0x2560af='\x22'+(_0xb65ad7['content']||'')['substring'](0x0,0x28)+_0x140d17(0x1169);_0x16d432=_0x140d17(0xf51)+_0x23a7e1+'\x20的动态\x20'+_0x8ba75c+_0x140d17(0xb80)+_0x2560af+'】';}else{if(_0xb2d5db[_0x140d17(0xa6b)]===_0x140d17(0x68e))_0x16d432=(_0x140d17(0xa14)+_0xb2d5db[_0x140d17(0x4e6)]+_0x140d17(0x4e2)+(_0xb2d5db[_0x140d17(0xbdc)]||''))[_0x140d17(0xba5)](0x0,0x32)+_0x140d17(0x1026);else{if(_0xb2d5db[_0x140d17(0xa6b)]==='image_post')_0x16d432=(_0x140d17(0x36c)+_0xb2d5db[_0x140d17(0x8cf)]+'\x22]\x20'+(_0xb2d5db[_0x140d17(0xbdc)]||''))[_0x140d17(0xba5)](0x0,0x32)+_0x140d17(0x1026);else{if(_0xb2d5db[_0x140d17(0xa6b)]==='naiimag'&&_0xb2d5db[_0x140d17(0x357)]){const _0x1e7a19=Array['isArray'](_0xb2d5db[_0x140d17(0x357)])?_0xb2d5db[_0x140d17(0x357)]:[_0xb2d5db[_0x140d17(0x357)]];_0x16d432=(_0xb2d5db[_0x140d17(0xbdc)]||'')+('\x20[包含'+_0x1e7a19[_0x140d17(0xfde)]+_0x140d17(0xe9c)+_0x1e7a19[_0x140d17(0xa35)](',\x20')+']');}else _0x16d432=String(_0xb2d5db[_0x140d17(0xbdc)]||_0xb2d5db[_0x140d17(0x11b6)]||_0x140d17(0x199))[_0x140d17(0xba5)](0x0,0x32)+_0x140d17(0x1026);}}}_0x50c013+=_0x140d17(0x85e)+_0xb2d5db['id']+_0x140d17(0xe61)+_0x5b1d7b+_0x140d17(0x265)+_0x16d432+'\x22\x0a';if(_0xb2d5db[_0x140d17(0xcad)]&&_0xb2d5db[_0x140d17(0xcad)]['length']>0x0)for(const _0x5b73d7 of _0xb2d5db[_0x140d17(0xcad)]){if(typeof _0x5b73d7==='object'&&_0x5b73d7[_0x140d17(0xbb)]){const _0x239100=_0x5641f2(_0x5b73d7['commenterName']);let _0x47f0e2=_0x5b73d7[_0x140d17(0x7de)]?'[表情:\x20\x27'+_0x5b73d7['meaning']+'\x27]':_0x5b73d7[_0x140d17(0x6af)];_0x5b73d7[_0x140d17(0xbb)]===_0x18197b?_0x50c013+='\x20\x20-\x20你评论说:\x20'+_0x47f0e2+'\x0a':_0x50c013+=_0x140d17(0xf83)+_0x239100+_0x140d17(0xcac)+_0x5b73d7[_0x140d17(0xbb)]+_0x140d17(0x12a8)+_0x47f0e2+'\x0a';}}}}const _0x56016f=_0x897d3a[_0x140d17(0x886)][_0x140d17(0x52e)]||'我';let _0x1f1e91='',_0x1b5bf0=![];if(_0x897d3a[_0x140d17(0x886)][_0x140d17(0xfc8)]){const _0x44009f=_0x46e6a0[_0x140d17(0x776)](_0x3f6644=>_0x3f6644['role']===_0x140d17(0x66e)&&!_0x3f6644[_0x140d17(0xbc5)]),_0x504753=_0x46e6a0[_0x140d17(0x776)](_0x1b5b85=>_0x1b5b85['role']===_0x140d17(0xf3c)&&!_0x1b5b85[_0x140d17(0xbc5)]);if(_0x44009f){const _0x3b2d59=_0x2235d5(_0x44009f[_0x140d17(0x3b7)]);if(_0x504753){const _0x3cc046=_0x2235d5(_0x504753[_0x140d17(0x3b7)]);_0x1f1e91=_0x140d17(0x98c)+_0x3cc046+_0x140d17(0x1238)+_0x3b2d59+_0x140d17(0x9dd);const _0x5211a5=(_0x44009f[_0x140d17(0x3b7)]-_0x504753['timestamp'])/(0x3e8*0x3c*0x3c);if(_0x5211a5>0x3){_0x1b5bf0=!![];const _0x26e3a9=Math['floor'](_0x5211a5/0x18);_0x1f1e91+='\x20你们之间已经有**'+(_0x26e3a9>0x0?_0x26e3a9+'天':Math['floor'](_0x5211a5)+'小时')+_0x140d17(0xf39)+_0x3df235+'）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。';}}else _0x1f1e91=_0x140d17(0xc41)+_0x3b2d59+'。';}else _0x1f1e91='-\x20**对话状态**:\x20(暂无有效对话历史)';}const _0x2b5a74=_0x600639(_0x350226),_0x3e8f65=_0x1ad6bb(_0x897d3a,0x3,_0x140d17(0x2f2)),_0x123d7d=_0x1ad6bb(_0x897d3a,0x6,_0x140d17(0x2f2)),_0x1c82ff=_0x1ad6bb(_0x897d3a,0x9,_0x140d17(0x2f2)),_0xcf9024=_0x1ad6bb(_0x897d3a,0x1,_0x140d17(0x103b)),_0x2699b4=_0x1ad6bb(_0x897d3a,0x3,_0x140d17(0x103b)),_0x2443c4=_0x1ad6bb(_0x897d3a,0x7,_0x140d17(0x103b));let _0x3a757f='';if(_0x3e8f65||_0x123d7d||_0x1c82ff||_0xcf9024||_0x2699b4||_0x2443c4){_0x3a757f+=_0x140d17(0xda0);if(_0x3e8f65)_0x3a757f+=_0x3e8f65;if(_0x123d7d)_0x3a757f+=_0x123d7d;if(_0x1c82ff)_0x3a757f+=_0x1c82ff;if(_0x3e8f65||_0x123d7d||_0x1c82ff)_0x3a757f+='\x0a';if(_0xcf9024)_0x3a757f+=_0xcf9024;if(_0x2699b4)_0x3a757f+=_0x2699b4;if(_0x2443c4)_0x3a757f+=_0x2443c4;}_0x307319=_0x140d17(0xfaa)+_0x897d3a[_0x140d17(0x283)]+'”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-10条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a2.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a3.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性，尽量让你的表情丰富多样，避免重复。。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20你的角色设定\x0a你必须严格遵守'+_0x897d3a[_0x140d17(0x886)]['aiPersona']+'\x0a'+_0x42059e+'\x0a#\x20对话者的角色设定\x0a'+_0x897d3a['settings'][_0x140d17(0xe63)]+_0x140d17(0x11b1)+(_0x897d3a[_0x140d17(0x886)][_0x140d17(0xfc8)]?_0x140d17(0x2e6)+_0x2b8b90+'\x20('+_0x3df235+')':'')+'\x0a'+_0x1f1e91+_0x140d17(0x518)+_0x51028d+'\x0a'+_0x3f03bd+_0x140d17(0xe02)+(_0x897d3a[_0x140d17(0x1349)]&&_0x897d3a['longTermMemory'][_0x140d17(0xfde)]>0x0?_0x897d3a[_0x140d17(0x1349)][_0x140d17(0xa79)](_0x1d9b0d=>'-\x20'+_0x1d9b0d[_0x140d17(0x11b6)])['join']('\x0a'):'-\x20(暂无)')+'\x0a'+_0x3a757f+_0x140d17(0x126f)+_0x897d3a[_0x140d17(0x283)]+_0x140d17(0x950)+_0x897d3a[_0x140d17(0x461)]+_0x140d17(0x1334)+_0x56016f+'”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20'+_0x368813+_0x140d17(0xbf5)+_0x51170f+_0x140d17(0x109a)+_0x1aa96c+'\x0a'+_0x3d222c+'\x0a'+_0x1e9d70+_0x140d17(0xc67)+_0x18ed15+'\x0a'+_0x50c013+_0x140d17(0x10f9)+(_0x897d3a[_0x140d17(0x886)][_0x140d17(0xfc8)]?_0x140d17(0x97a)+_0x2b8b90+'\x20('+_0x3df235+_0x140d17(0xb81):'')+_0x140d17(0xe44)+(_0x28a264?_0x140d17(0x628)+_0x28a264:'你们没有在听歌。')+_0x140d17(0x3e8)+(_0x2b5a74?_0x140d17(0x125)+_0x2b5a74:_0x140d17(0x6ea))+_0x140d17(0x1188)+(_0x897d3a[_0x140d17(0x886)]['aiAvatarLibrary']&&_0x897d3a['settings'][_0x140d17(0x7fa)][_0x140d17(0xfde)]>0x0?_0x897d3a[_0x140d17(0x886)][_0x140d17(0x7fa)]['map'](_0x3ed98d=>'-\x20'+_0x3ed98d['name'])[_0x140d17(0xa35)]('\x0a'):_0x140d17(0x523))+'\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20'+(_0x897d3a[_0x140d17(0x886)]['myAvatarLibrary']&&_0x897d3a[_0x140d17(0x886)][_0x140d17(0xa7)][_0x140d17(0xfde)]>0x0?_0x897d3a['settings']['myAvatarLibrary'][_0x140d17(0xa79)](_0x52ce0d=>'-\x20'+_0x52ce0d['name'])[_0x140d17(0xa35)]('\x0a'):'-\x20(空)')+'\x0a-\x20\x20\x20**五子棋局势**:\x20'+_0x16a8b2+_0x140d17(0x3db)+(localStorage['getItem'](_0x140d17(0x846))===_0x140d17(0xc06)?_0x140d17(0xc91):'')+'\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a'+(localStorage['getItem'](_0x140d17(0x846))===_0x140d17(0xc06)?_0x140d17(0x5b2):'')+_0x140d17(0x7d4)+_0x897d3a[_0x140d17(0x283)]+_0x140d17(0x360)+_0x897d3a[_0x140d17(0x283)]+'\x22,\x20\x22postId\x22:\x20456,\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22'+_0x897d3a[_0x140d17(0x283)]+_0x140d17(0x10ee)+_0x897d3a[_0x140d17(0x283)]+_0x140d17(0x837),_0x3009ad=_0x46e6a0[_0x140d17(0xa79)](_0x52699c=>{const _0x41424f=_0x140d17;if(_0x52699c[_0x41424f(0xbc5)]&&_0x52699c[_0x41424f(0x10ff)]==='system')return{'role':'user','content':_0x52699c[_0x41424f(0x11b6)]};else{if(_0x52699c['isHidden'])return null;}if(_0x52699c[_0x41424f(0xa6b)]==='offline_text'){const _0x24bb59=_0x52699c[_0x41424f(0x10ff)]===_0x41424f(0x66e)?_0x897d3a[_0x41424f(0x886)][_0x41424f(0x52e)]||'我':_0x897d3a[_0x41424f(0x461)];let _0xb41649='';if(_0x52699c[_0x41424f(0x11b6)])_0xb41649=_0x52699c[_0x41424f(0x11b6)];else{const _0x3426e2=_0x52699c[_0x41424f(0x5ed)]?'「'+_0x52699c[_0x41424f(0x5ed)]+'」':'',_0x3031aa=_0x52699c[_0x41424f(0xee1)]?'('+_0x52699c[_0x41424f(0xee1)]+')':'';_0xb41649=(_0x3426e2+'\x20'+_0x3031aa)[_0x41424f(0x1cb)]();}return{'role':_0x52699c[_0x41424f(0x10ff)],'content':'(Timestamp:\x20'+_0x52699c[_0x41424f(0x3b7)]+')\x20'+_0x24bb59+':\x20'+_0xb41649};}if(_0x52699c['role']==='user'){const _0x23c061=_0x41424f(0x9ed)+_0x52699c[_0x41424f(0x3b7)]+')\x20';let _0x3f5493='';if(Array[_0x41424f(0x565)](_0x52699c[_0x41424f(0x11b6)])&&_0x52699c['content'][0x0]?.[_0x41424f(0xa6b)]==='image_url')return{'role':'user','content':[{'type':_0x41424f(0x6af),'text':_0x23c061},..._0x52699c[_0x41424f(0x11b6)]]};if(_0x52699c[_0x41424f(0x8ff)]){const _0x550a91=String(_0x52699c[_0x41424f(0x8ff)][_0x41424f(0x11b6)]||'')[_0x41424f(0xba5)](0x0,0x32);_0x3f5493+=_0x41424f(0xc9a)+_0x52699c['quote'][_0x41424f(0x4c5)]+_0x41424f(0x39b)+_0x550a91+_0x41424f(0x5d2)+_0x52699c['content'];}else _0x3f5493+=_0x52699c['content'];if(_0x52699c[_0x41424f(0xa6b)]==='user_photo')return{'role':'user','content':_0x23c061+_0x41424f(0x986)+_0x52699c[_0x41424f(0x11b6)]+'\x27]'};if(_0x52699c[_0x41424f(0xa6b)]===_0x41424f(0xa4f))return{'role':_0x41424f(0x66e),'content':_0x23c061+_0x41424f(0xbc7)+_0x52699c[_0x41424f(0x11b6)]+'\x27]'};if(_0x52699c[_0x41424f(0xa6b)]===_0x41424f(0x909))return{'role':_0x41424f(0x66e),'content':_0x23c061+'[系统提示：你于时间戳\x20'+_0x52699c[_0x41424f(0x3b7)]+_0x41424f(0x720)+_0x52699c[_0x41424f(0xe27)]+_0x41424f(0x1ab)+_0x52699c[_0x41424f(0x775)]+_0x41424f(0xb4a)};if(_0x52699c[_0x41424f(0xa6b)]==='waimai_request')return{'role':_0x41424f(0x66e),'content':_0x23c061+_0x41424f(0x721)+_0x52699c['timestamp']+_0x41424f(0xabe)+_0x52699c['productInfo']+_0x41424f(0x937)+_0x52699c[_0x41424f(0xe27)]+'\x20元。]'};else{if(_0x52699c[_0x41424f(0xa6b)]===_0x41424f(0x980)){const _0x1a66b1=_0x52699c['items'][_0x41424f(0xa79)](_0x316146=>_0x316146['name']+'\x20x'+_0x316146[_0x41424f(0x257)])['join']('、\x20');let _0x2e6af3=_0x897d3a['isGroup']?'送给了\x20'+_0x52699c[_0x41424f(0xbdb)][_0x41424f(0xa79)](_0x445474=>_0x54d0ab(_0x897d3a,_0x445474))[_0x41424f(0xa35)]('、\x20'):_0x41424f(0xf97)+_0x897d3a[_0x41424f(0x461)];return{'role':_0x41424f(0x66e),'content':_0x23c061+_0x41424f(0x2cc)+_0x2e6af3+_0x41424f(0x120e)+_0x1a66b1+']'};}}if(_0x52699c[_0x41424f(0x7de)])return{'role':'user','content':_0x23c061+'[你发送了一个表情，意思是：\x27'+_0x52699c[_0x41424f(0x7de)]+'\x27]'};return{'role':_0x52699c[_0x41424f(0x10ff)],'content':_0x23c061+_0x3f5493};}else{if(_0x52699c[_0x41424f(0x10ff)]==='assistant'){let _0x19a46a={'type':_0x52699c[_0x41424f(0xa6b)]||_0x41424f(0x6af)};if(_0x52699c[_0x41424f(0xa6b)]===_0x41424f(0x37d))_0x19a46a['url']=_0x52699c[_0x41424f(0x11b6)],_0x19a46a[_0x41424f(0x7de)]=_0x52699c[_0x41424f(0x7de)];else{if(_0x52699c[_0x41424f(0xa6b)]===_0x41424f(0x909))_0x19a46a[_0x41424f(0xe27)]=_0x52699c[_0x41424f(0xe27)],_0x19a46a[_0x41424f(0x775)]=_0x52699c['note'];else _0x52699c[_0x41424f(0xa6b)]===_0x41424f(0x990)?(_0x19a46a[_0x41424f(0x12b1)]=_0x52699c['productInfo'],_0x19a46a['amount']=_0x52699c[_0x41424f(0xe27)]):_0x52699c[_0x41424f(0x8ff)]?_0x19a46a[_0x41424f(0x1038)]={'target_sender':_0x52699c['quote'][_0x41424f(0x4c5)],'target_content':_0x52699c[_0x41424f(0x8ff)][_0x41424f(0x11b6)],'reply_content':_0x52699c['content']}:_0x19a46a[_0x41424f(0x11b6)]=_0x52699c[_0x41424f(0x11b6)];}const _0x5ed9d1=JSON[_0x41424f(0x3fb)]([_0x19a46a]);return{'role':'assistant','content':_0x41424f(0x9ed)+_0x52699c[_0x41424f(0x3b7)]+')\x20'+_0x5ed9d1};}}return null;})[_0x140d17(0x98a)](Boolean);if(!_0x897d3a['isGroup']&&_0x897d3a[_0x140d17(0x112b)]?.[_0x140d17(0x1fe)]==='pending_ai_approval'){const _0x4b394e=_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x98a)](_0x3e65cd=>!_0x3e65cd[_0x140d17(0xbc5)])[_0x140d17(0x1368)](-0xa)[_0x140d17(0xa79)](_0x8471e0=>{const _0x2497df=_0x140d17,_0x38c0aa=_0x8471e0[_0x2497df(0x10ff)]===_0x2497df(0x66e)?'用户':_0x897d3a[_0x2497df(0x461)];return _0x38c0aa+':\x20'+String(_0x8471e0['content'])[_0x2497df(0xba5)](0x0,0x32)+_0x2497df(0x1026);})[_0x140d17(0xa35)]('\x0a'),_0x5c56b0={'role':_0x140d17(0x66e),'content':_0x140d17(0xf6f)+_0x897d3a['relationship'][_0x140d17(0x6d8)]+_0x140d17(0x2c5)+_0x4b394e+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20'};_0x3009ad['push'](_0x5c56b0);}}}let _0x528616=_0x4e67e2===GEMINI_API_URL,_0x94a971=_0x112768(_0x4d7092,_0x28daf2,_0x307319,_0x3009ad),_0x175afa;try{_0x175afa=_0x528616?await fetch(_0x94a971[_0x140d17(0x2fa)],_0x94a971['data']):await fetch(_0x4e67e2+_0x140d17(0x126b),{'method':_0x140d17(0x94f),'headers':{'Content-Type':'application/json','Authorization':_0x140d17(0xd55)+_0x28daf2},'body':JSON[_0x140d17(0x3fb)]({'model':_0x4d7092,'messages':[{'role':_0x140d17(0xb1),'content':_0x307319},..._0x3009ad],'temperature':_0x41df36[_0x140d17(0xc0)][_0x140d17(0xa4a)]||0.8,'stream':![]})});}catch(_0x2e5a3b){throw new Error(_0x140d17(0xab2)+_0x2e5a3b[_0x140d17(0x5f8)]);}if(!_0x175afa['ok']){let _0x309053='API\x20返回错误:\x20'+_0x175afa[_0x140d17(0x1fe)]+'\x20'+_0x175afa['statusText'];try{const _0x48694e=await _0x175afa[_0x140d17(0x9b3)]();_0x48694e[_0x140d17(0x98)]&&_0x48694e[_0x140d17(0x98)]['message']?_0x309053+=_0x140d17(0xb13)+_0x48694e[_0x140d17(0x98)][_0x140d17(0x5f8)]:_0x309053+=_0x140d17(0xb13)+JSON['stringify'](_0x48694e);}catch(_0x4626de){_0x309053+=_0x140d17(0x102f)+await _0x175afa[_0x140d17(0x6af)]();}throw new Error(_0x309053);}const _0x21c993=await _0x175afa[_0x140d17(0x9b3)](),_0x43b13e=getGeminiResponseText(_0x21c993);lastRawAiResponse=_0x43b13e,lastResponseTimestamps=[],_0x897d3a['history']=_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x98a)](_0x40d967=>!_0x40d967[_0x140d17(0x31b)]);const _0x20d2c4=_0x28b8fa(_0x43b13e);let _0x24d8f8=[];if(_0x897d3a[_0x140d17(0x886)][_0x140d17(0xf49)]){let _0x3f64b4={'content':[],'dialogue':[],'description':[]};for(const _0x3749a1 of _0x20d2c4){if(_0x3749a1[_0x140d17(0xa6b)]==='offline_text'){if(_0x3749a1[_0x140d17(0x11b6)])_0x3f64b4['content'][_0x140d17(0x258)](_0x3749a1[_0x140d17(0x11b6)]);else{if(_0x3749a1['dialogue'])_0x3f64b4['dialogue']['push'](_0x3749a1[_0x140d17(0x5ed)]);if(_0x3749a1[_0x140d17(0xee1)])_0x3f64b4[_0x140d17(0xee1)][_0x140d17(0x258)](_0x3749a1['description']);}}else(_0x3f64b4[_0x140d17(0x11b6)]['length']>0x0||_0x3f64b4['dialogue'][_0x140d17(0xfde)]>0x0||_0x3f64b4[_0x140d17(0xee1)][_0x140d17(0xfde)]>0x0)&&(_0x3f64b4['content']['length']>0x0&&_0x24d8f8[_0x140d17(0x258)]({'type':_0x140d17(0x44e),'content':_0x3f64b4[_0x140d17(0x11b6)][_0x140d17(0xa35)]('\x0a')}),(_0x3f64b4[_0x140d17(0x5ed)][_0x140d17(0xfde)]>0x0||_0x3f64b4[_0x140d17(0xee1)][_0x140d17(0xfde)]>0x0)&&_0x24d8f8[_0x140d17(0x258)]({'type':_0x140d17(0x44e),'dialogue':_0x3f64b4[_0x140d17(0x5ed)][_0x140d17(0xa35)]('\x0a'),'description':_0x3f64b4[_0x140d17(0xee1)]['join']('\x0a')}),_0x3f64b4={'content':[],'dialogue':[],'description':[]}),_0x24d8f8['push'](_0x3749a1);}_0x3f64b4[_0x140d17(0x11b6)][_0x140d17(0xfde)]>0x0&&_0x24d8f8['push']({'type':'offline_text','content':_0x3f64b4[_0x140d17(0x11b6)][_0x140d17(0xa35)]('\x0a')}),(_0x3f64b4[_0x140d17(0x5ed)][_0x140d17(0xfde)]>0x0||_0x3f64b4[_0x140d17(0xee1)][_0x140d17(0xfde)]>0x0)&&_0x24d8f8[_0x140d17(0x258)]({'type':_0x140d17(0x44e),'dialogue':_0x3f64b4[_0x140d17(0x5ed)]['join']('\x0a'),'description':_0x3f64b4[_0x140d17(0xee1)][_0x140d17(0xa35)]('\x0a')});}else _0x24d8f8=_0x20d2c4;const _0x2e36a1=_0x897d3a['history'][_0x140d17(0x98a)](_0x19cf51=>_0x19cf51[_0x140d17(0x10ff)]===_0x140d17(0x66e)&&!_0x19cf51[_0x140d17(0xbc5)])[_0x140d17(0xc4f)]();if(_0x2e36a1&&Array[_0x140d17(0x565)](_0x2e36a1['content'])&&_0x2e36a1[_0x140d17(0x11b6)][0x0]?.[_0x140d17(0xa6b)]===_0x140d17(0x122d)&&!_0x2e36a1['imageProcessed']){const _0x176d3c=_0x20d2c4['find'](_0x30d44c=>_0x30d44c['type']===_0x140d17(0x6af));let _0x1571fa;_0x176d3c&&(_0x176d3c[_0x140d17(0x11b6)]||_0x176d3c[_0x140d17(0x5f8)])?_0x1571fa=String(_0x176d3c['content']||_0x176d3c['message'])[_0x140d17(0x1cb)]():_0x1571fa='AI已接收并理解了该图片的内容。';const _0x340b64=_0x897d3a['history'][_0x140d17(0xe37)](_0x1e7ebd=>_0x1e7ebd[_0x140d17(0x3b7)]===_0x2e36a1[_0x140d17(0x3b7)]);if(_0x340b64>-0x1){console[_0x140d17(0xe72)](_0x140d17(0x1219)+_0x2e36a1[_0x140d17(0x3b7)]+_0x140d17(0x11f2));const _0x41c5f1='[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“'+_0x1571fa+'”]';_0x897d3a[_0x140d17(0xd08)][_0x340b64]['content']=_0x41c5f1,_0x897d3a[_0x140d17(0xd08)][_0x340b64][_0x140d17(0xd42)]=!![],_0x897d3a[_0x140d17(0xd08)][_0x340b64][_0x140d17(0xa6b)]=_0x140d17(0x6af);}}const _0x7f52d3=document[_0x140d17(0x383)](_0x140d17(0x862))[_0x140d17(0x119a)][_0x140d17(0x987)](_0x140d17(0xde5))&&_0x41df36[_0x140d17(0xfc5)]===_0x350226;let _0x102c73=![],_0x54b77c=Date[_0x140d17(0x108d)](),_0x1aeabe=[],_0x33235a=![];for(const _0x39c53d of _0x24d8f8){_0x897d3a['settings'][_0x140d17(0xa7f)]!==![]&&_0x39c53d[_0x140d17(0xa6b)]===_0x140d17(0x6af)&&typeof _0x39c53d[_0x140d17(0x11b6)]===_0x140d17(0xafa)&&_0x39c53d['content'][_0x140d17(0x1cb)]()['startsWith']('[V]')&&(_0x39c53d['type']=_0x140d17(0xa4f),_0x39c53d[_0x140d17(0x11b6)]=_0x39c53d[_0x140d17(0x11b6)][_0x140d17(0x709)](_0x140d17(0x1316),'')[_0x140d17(0x1cb)]());if(_0x897d3a[_0x140d17(0x1a2)]&&_0x39c53d[_0x140d17(0x461)]&&_0x39c53d[_0x140d17(0x461)]===_0x897d3a['name']){console[_0x140d17(0x98)](_0x140d17(0x747)+_0x897d3a[_0x140d17(0x461)]+_0x140d17(0x12c1),_0x39c53d);continue;}if(!_0x39c53d||typeof _0x39c53d!==_0x140d17(0x890)){console[_0x140d17(0x17b)](_0x140d17(0xb55),_0x39c53d);continue;}if(!_0x39c53d[_0x140d17(0xa6b)]){if(_0x897d3a['isGroup']&&_0x39c53d[_0x140d17(0x461)]&&_0x39c53d[_0x140d17(0x5f8)])_0x39c53d[_0x140d17(0xa6b)]='text';else{if(_0x39c53d[_0x140d17(0x11b6)])_0x39c53d[_0x140d17(0xa6b)]=_0x140d17(0x6af);else{console[_0x140d17(0x17b)](_0x140d17(0x3df),_0x39c53d);continue;}}}if(_0x39c53d[_0x140d17(0xa6b)]===_0x140d17(0x14f)){_0x4f60f2['isAwaitingResponse']=![];if(_0x39c53d[_0x140d17(0xe8e)]===_0x140d17(0x3d0))_0x267991();else{const _0x270883={'role':'assistant','content':_0x140d17(0x113),'timestamp':Date[_0x140d17(0x108d)]()};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0x270883),await _0x342df8[_0x140d17(0x864)]['put'](_0x897d3a),_0x105acd(_0x140d17(0x862)),_0x409076(_0x350226);}_0x102c73=!![];break;}if(_0x39c53d[_0x140d17(0xa6b)]==='group_call_response'){if(_0x39c53d[_0x140d17(0xe8e)]==='join'){const _0x4b84ab=_0x897d3a['members']['find'](_0x19d9ad=>_0x19d9ad[_0x140d17(0x283)]===_0x39c53d[_0x140d17(0x461)]);_0x4b84ab&&!_0x4f60f2[_0x140d17(0x9a6)][_0x140d17(0x12fb)](_0x3d1f4d=>_0x3d1f4d['id']===_0x4b84ab['id'])&&_0x4f60f2[_0x140d17(0x9a6)]['push'](_0x4b84ab);}_0x102c73=!![];continue;}if(_0x897d3a['isGroup']&&_0x39c53d[_0x140d17(0x461)]&&_0x39c53d[_0x140d17(0x461)]===_0x897d3a['name']){console[_0x140d17(0x98)](_0x140d17(0x747)+_0x897d3a[_0x140d17(0x461)]+_0x140d17(0x12c1),_0x39c53d);continue;}if(_0x897d3a[_0x140d17(0x1a2)]&&!_0x39c53d[_0x140d17(0x461)]){console[_0x140d17(0x98)](_0x140d17(0x11a4),_0x39c53d);continue;}let _0x488e70=null;const _0x5594ad=_0x54b77c++,_0x2625a2={'role':_0x140d17(0xf3c),'senderName':_0x39c53d['name']||_0x897d3a['name'],'timestamp':_0x5594ad};lastResponseTimestamps[_0x140d17(0x258)](_0x5594ad);switch(_0x39c53d[_0x140d17(0xa6b)]){case'update_thoughts':if(!_0x897d3a[_0x140d17(0x1a2)]){_0x39c53d['heartfelt_voice']&&(_0x897d3a[_0x140d17(0xa52)]=String(_0x39c53d[_0x140d17(0x2a6)]));_0x39c53d[_0x140d17(0xf25)]&&(_0x897d3a[_0x140d17(0xc2b)]=String(_0x39c53d['random_jottings']));!Array['isArray'](_0x897d3a[_0x140d17(0x4f8)])&&(_0x897d3a[_0x140d17(0x4f8)]=[]);_0x897d3a[_0x140d17(0x4f8)][_0x140d17(0x258)]({'heartfeltVoice':_0x897d3a['heartfeltVoice'],'randomJottings':_0x897d3a[_0x140d17(0xc2b)],'timestamp':Date[_0x140d17(0x108d)]()});_0x897d3a[_0x140d17(0x4f8)][_0x140d17(0xfde)]>0x32&&_0x897d3a[_0x140d17(0x4f8)][_0x140d17(0x870)]();const _0x59f006=_0x140d17(0x9a7)+_0x897d3a[_0x140d17(0xa52)]+_0x140d17(0x84c)+_0x897d3a['randomJottings'],_0x4cc479={'role':_0x140d17(0xb1),'content':_0x59f006,'timestamp':Date[_0x140d17(0x108d)](),'isHidden':!![]};}continue;case'change_user_nickname':if(!_0x897d3a[_0x140d17(0x1a2)]&&_0x39c53d[_0x140d17(0x25b)]){const _0x54909e=_0x39c53d[_0x140d17(0x25b)]['trim']();if(_0x54909e){_0x897d3a['settings'][_0x140d17(0x52e)]=_0x54909e;const _0xf47c73={'role':_0x140d17(0xb1),'type':'pat_message','content':'“'+_0x897d3a[_0x140d17(0x461)]+_0x140d17(0x1064)+_0x54909e+'”','timestamp':_0x54b77c++};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0xf47c73);const _0x121a83={'role':_0x140d17(0xb1),'content':_0x140d17(0xc84)+_0x54909e+_0x140d17(0x2c1),'timestamp':_0x54b77c++,'isHidden':!![]};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0x121a83),_0x7f52d3&&_0x323467(_0xf47c73,_0x897d3a);}}continue;case _0x140d17(0xe28):if(!_0x897d3a['isGroup']&&_0x39c53d[_0x140d17(0x25b)]){const _0x331e72=_0x897d3a[_0x140d17(0x461)],_0x192115=_0x39c53d[_0x140d17(0x25b)][_0x140d17(0x1cb)]();if(_0x192115&&_0x192115!==_0x331e72){!_0x897d3a['nameHistory']&&(_0x897d3a['nameHistory']=[]);!_0x897d3a[_0x140d17(0xcf9)][_0x140d17(0xee2)](_0x331e72)&&_0x897d3a[_0x140d17(0xcf9)]['push'](_0x331e72);_0x897d3a['name']=_0x192115;const _0x56a820={'role':_0x140d17(0xb1),'type':_0x140d17(0xed8),'content':'“'+_0x897d3a['originalName']+'”\x20将备注修改为\x20“'+_0x192115+'”','timestamp':_0x54b77c++};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0x56a820);const _0x1e2f44={'role':_0x140d17(0xb1),'content':_0x140d17(0x988)+_0x192115+'”。请自然地接受这个新名字，不要对此感到惊讶。]','timestamp':_0x54b77c++,'isHidden':!![]};_0x897d3a[_0x140d17(0xd08)]['push'](_0x1e2f44),_0x7f52d3&&(_0x323467(_0x56a820,_0x897d3a),document[_0x140d17(0x383)](_0x140d17(0x969))['textContent']=_0x192115),await _0x2d549c(_0x897d3a);}}continue;case _0x140d17(0x437):{const _0x2a1d8a=_0x39c53d[_0x140d17(0x461)],_0x33a620=_0x897d3a[_0x140d17(0x886)]['aiAvatarLibrary'][_0x140d17(0xd12)](_0x30b992=>_0x30b992[_0x140d17(0x461)]===_0x2a1d8a);if(_0x33a620){_0x897d3a[_0x140d17(0x886)][_0x140d17(0x121e)]=_0x33a620[_0x140d17(0x2fa)];const _0x1010af={'role':_0x140d17(0xb1),'type':_0x140d17(0xed8),'content':'['+_0x897d3a[_0x140d17(0x461)]+'\x20更换了头像]','timestamp':Date[_0x140d17(0x108d)]()};_0x897d3a[_0x140d17(0xd08)]['push'](_0x1010af),await _0x4fddd3(_0x897d3a),_0x7f52d3&&(_0x323467(_0x1010af,_0x897d3a),_0x409076(_0x350226));}continue;}case _0x140d17(0xbda):{const _0x29afc4=_0x39c53d['name'],_0x56564b=_0x897d3a['settings'][_0x140d17(0xa7)][_0x140d17(0xd12)](_0x3d2669=>_0x3d2669[_0x140d17(0x461)]===_0x29afc4);if(_0x56564b){_0x897d3a[_0x140d17(0x886)][_0x140d17(0x43a)]=_0x56564b[_0x140d17(0x2fa)];const _0x511416={'role':'system','type':'pat_message','content':'['+_0x897d3a['name']+_0x140d17(0xf41),'timestamp':Date[_0x140d17(0x108d)]()};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0x511416),_0x7f52d3&&(_0x323467(_0x511416,_0x897d3a),_0x409076(_0x350226));}continue;}case _0x140d17(0xfbb):{const _0x11f68a=parseInt(_0x39c53d['x']),_0x4ee43a=parseInt(_0x39c53d['y']);!isNaN(_0x11f68a)&&!isNaN(_0x4ee43a)?_0x1d7b9({'x':_0x11f68a,'y':_0x4ee43a}):console[_0x140d17(0x17b)](_0x140d17(0x11bc),_0x39c53d);continue;}case _0x140d17(0x63c):const _0x26c548=_0x897d3a[_0x140d17(0xd08)][_0x140d17(0xe37)](_0xbd2fac=>_0xbd2fac[_0x140d17(0x3b7)]===_0x39c53d[_0x140d17(0x1397)]);if(_0x26c548>-0x1){const _0x2370d8=_0x897d3a[_0x140d17(0xd08)][_0x26c548];_0x2370d8[_0x140d17(0x1fe)]=_0x39c53d[_0x140d17(0x1fe)],_0x2370d8[_0x140d17(0x78b)]=_0x39c53d[_0x140d17(0x1fe)]===_0x140d17(0x96d)?_0x39c53d['name']:null;}continue;case _0x140d17(0xd91):const _0x49a45b={'type':_0x39c53d['postType'],'content':_0x39c53d['content']||'','publicText':_0x39c53d[_0x140d17(0xbdc)]||'','hiddenContent':_0x39c53d[_0x140d17(0x4e6)]||'','image_prompt':_0x39c53d['image_prompt']||'','timestamp':Date[_0x140d17(0x108d)](),'authorId':_0x350226,'authorGroupId':_0x897d3a[_0x140d17(0x11a6)],'visibleGroupIds':null};if(_0x39c53d[_0x140d17(0x122f)]===_0x140d17(0x7f4)&&_0x39c53d[_0x140d17(0x357)])try{const _0x13c923=Array[_0x140d17(0x565)](_0x39c53d[_0x140d17(0x357)])?_0x39c53d[_0x140d17(0x357)][_0x140d17(0x1368)](0x0,0x2):[_0x39c53d['prompt']];console[_0x140d17(0xe72)](_0x140d17(0xa0a)+_0x13c923['length']+_0x140d17(0x7a2));const _0xa9719c=[];for(let _0x37ca2c=0x0;_0x37ca2c<_0x13c923[_0x140d17(0xfde)];_0x37ca2c++){const _0x5170b6=_0x13c923[_0x37ca2c];console['log'](_0x140d17(0xdd0)+(_0x37ca2c+0x1)+_0x140d17(0x5d6),_0x5170b6);const _0x37df49=_0x51675f(_0x897d3a['id']),_0x3b8c0b=_0x5170b6+',\x20'+_0x37df49[_0x140d17(0x848)],_0x28feb7=_0x37df49[_0x140d17(0x57e)];console[_0x140d17(0xe72)](_0x140d17(0x638)+(_0x37df49['source']===_0x140d17(0xa0)?_0x140d17(0x74e):'系统')+'提示词配置'),console[_0x140d17(0xe72)](_0x140d17(0x961),_0x3b8c0b),console[_0x140d17(0xe72)]('最终负面提示词:',_0x28feb7);const _0x4a6474=localStorage[_0x140d17(0xb2)](_0x140d17(0x20a)),_0x39b90c=localStorage[_0x140d17(0xb2)](_0x140d17(0x1d4))||_0x140d17(0x11cb),_0x1cf054=_0x4eb791();if(!_0x4a6474)throw new Error(_0x140d17(0x526));const [_0x60edb8,_0x14f88a]=_0x1cf054[_0x140d17(0x657)][_0x140d17(0x105d)]('x')[_0x140d17(0xa79)](Number);let _0x198d74;_0x39b90c['includes'](_0x140d17(0xffe))?_0x198d74={'input':_0x3b8c0b,'model':_0x39b90c,'action':_0x140d17(0x408),'parameters':{'params_version':0x3,'width':_0x60edb8,'height':_0x14f88a,'scale':_0x1cf054[_0x140d17(0x78d)],'sampler':_0x1cf054['sampler'],'steps':_0x1cf054[_0x140d17(0x300)],'seed':_0x1cf054[_0x140d17(0x105f)]===-0x1?Math[_0x140d17(0xdee)](Math[_0x140d17(0x5ce)]()*0x2540be3ff):_0x1cf054[_0x140d17(0x105f)],'n_samples':0x1,'ucPreset':_0x1cf054[_0x140d17(0xc63)],'qualityToggle':_0x1cf054[_0x140d17(0x102a)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x140d17(0xab1),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x3b8c0b,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x28feb7,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x28feb7,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x198d74={'input':_0x3b8c0b,'model':_0x39b90c,'action':'generate','parameters':{'width':_0x60edb8,'height':_0x14f88a,'scale':_0x1cf054[_0x140d17(0x78d)],'sampler':_0x1cf054[_0x140d17(0xb4b)],'steps':_0x1cf054[_0x140d17(0x300)],'seed':_0x1cf054[_0x140d17(0x105f)]===-0x1?Math[_0x140d17(0xdee)](Math[_0x140d17(0x5ce)]()*0x2540be3ff):_0x1cf054[_0x140d17(0x105f)],'n_samples':0x1,'ucPreset':_0x1cf054[_0x140d17(0xc63)],'qualityToggle':_0x1cf054[_0x140d17(0x102a)],'sm':_0x1cf054[_0x140d17(0xc76)],'sm_dyn':_0x1cf054[_0x140d17(0x6ee)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x140d17(0xa72),'negative_prompt':_0x28feb7}};console[_0x140d17(0xe72)]('🚀\x20发送NAI请求:',_0x198d74);let _0xa63cd7;_0x39b90c['includes']('nai-diffusion-4')?_0xa63cd7=_0x140d17(0x10c4):_0xa63cd7=_0x140d17(0x349);let _0x15d3cf=_0x1cf054[_0x140d17(0x10c9)];_0x15d3cf===_0x140d17(0x4fe)&&(_0x15d3cf=_0x1cf054['custom_proxy_url']||'');_0x15d3cf&&_0x15d3cf!==''&&(_0xa63cd7=_0x15d3cf+encodeURIComponent(_0xa63cd7));const _0x280fed=await fetch(_0xa63cd7,{'method':_0x140d17(0x94f),'headers':{'Content-Type':_0x140d17(0x11f0),'Authorization':_0x140d17(0xd55)+_0x4a6474},'body':JSON[_0x140d17(0x3fb)](_0x198d74)});console['log'](_0x140d17(0x577),_0x280fed[_0x140d17(0x1fe)]),console[_0x140d17(0xe72)](_0x140d17(0x73f),[..._0x280fed['headers']['entries']()]);if(!_0x280fed['ok']){const _0x2ba5c5=await _0x280fed['text']();console[_0x140d17(0x98)](_0x140d17(0xb3f),_0x2ba5c5);throw new Error(_0x140d17(0x1205)+_0x280fed['status']+_0x140d17(0x12a8)+_0x2ba5c5);}const _0x2ddcd4=_0x280fed[_0x140d17(0xb60)][_0x140d17(0x1a3)](_0x140d17(0x598));console['log']('Content-Type:',_0x2ddcd4);let _0x50d204,_0xb7b860;if(_0x2ddcd4&&_0x2ddcd4['includes']('text/event-stream')){console[_0x140d17(0xe72)](_0x140d17(0xfa));const _0x3dc1af=await _0x280fed[_0x140d17(0x6af)]();console[_0x140d17(0xe72)]('收到\x20SSE\x20数据，大小:',_0x3dc1af[_0x140d17(0xfde)]);const _0x630222=_0x3dc1af[_0x140d17(0x1cb)]()['split']('\x0a');let _0x1101db=null;for(let _0x36fc7c=_0x630222[_0x140d17(0xfde)]-0x1;_0x36fc7c>=0x0;_0x36fc7c--){const _0x12f446=_0x630222[_0x36fc7c][_0x140d17(0x1cb)]();if(_0x12f446[_0x140d17(0x1122)](_0x140d17(0xe18))&&_0x12f446!==_0x140d17(0x28f)){const _0x2443b2=_0x12f446[_0x140d17(0xba5)](0x6);try{const _0x18a220=JSON[_0x140d17(0x134)](_0x2443b2);if(_0x18a220['event_type']===_0x140d17(0xdae)&&_0x18a220['image']){_0x1101db=_0x18a220[_0x140d17(0x482)],console[_0x140d17(0xe72)]('✅\x20找到\x20final\x20事件的图片数据');break;}if(_0x18a220['data']){_0x1101db=_0x18a220[_0x140d17(0x8c6)],console['log'](_0x140d17(0x43e));break;}if(_0x18a220[_0x140d17(0x482)]){_0x1101db=_0x18a220[_0x140d17(0x482)],console[_0x140d17(0xe72)]('从\x20JSON.image\x20中提取图片数据');break;}}catch(_0x1ed04e){_0x1101db=_0x2443b2,console[_0x140d17(0xe72)](_0x140d17(0xa92));break;}}}if(!_0x1101db)throw new Error('无法从\x20SSE\x20响应中提取图片数据');const _0xdae849=_0x1101db[_0x140d17(0x1122)](_0x140d17(0x9c4)),_0x2180e1=_0x1101db[_0x140d17(0x1122)](_0x140d17(0x1141));if(_0xdae849||_0x2180e1){console[_0x140d17(0xe72)](_0x140d17(0xa42));const _0x703e62=atob(_0x1101db),_0x35e915=new Uint8Array(_0x703e62[_0x140d17(0xfde)]);for(let _0x2897e2=0x0;_0x2897e2<_0x703e62['length'];_0x2897e2++){_0x35e915[_0x2897e2]=_0x703e62['charCodeAt'](_0x2897e2);}const _0x3f6ed0=new Blob([_0x35e915],{'type':_0xdae849?_0x140d17(0x7bd):_0x140d17(0x3f3)});console[_0x140d17(0xe72)](_0x140d17(0xbbc),_0x3f6ed0[_0x140d17(0x1240)]);const _0x59221a=new FileReader();_0xb7b860=await new Promise((_0x317380,_0x5ac0ee)=>{const _0xb79a30=_0x140d17;_0x59221a[_0xb79a30(0x132)]=()=>_0x317380(_0x59221a['result']),_0x59221a['onerror']=_0x5ac0ee,_0x59221a['readAsDataURL'](_0x3f6ed0);}),console['log'](_0x140d17(0x10ce));}else{console[_0x140d17(0xe72)](_0x140d17(0xecf));const _0x459e94=atob(_0x1101db),_0x5d1df5=new Uint8Array(_0x459e94[_0x140d17(0xfde)]);for(let _0x3c8cf5=0x0;_0x3c8cf5<_0x459e94[_0x140d17(0xfde)];_0x3c8cf5++){_0x5d1df5[_0x3c8cf5]=_0x459e94[_0x140d17(0x274)](_0x3c8cf5);}_0x50d204=new Blob([_0x5d1df5]),console[_0x140d17(0xe72)](_0x140d17(0x700),_0x50d204[_0x140d17(0x1240)]);}}else _0x50d204=await _0x280fed[_0x140d17(0x800)](),console[_0x140d17(0xe72)]('收到数据，类型:',_0x50d204[_0x140d17(0xa6b)],_0x140d17(0xdc9),_0x50d204['size']);if(!_0xb7b860&&_0x50d204)try{if(typeof JSZip==='undefined')throw new Error(_0x140d17(0x8df));const _0x383850=await JSZip[_0x140d17(0x12a0)](_0x50d204);console[_0x140d17(0xe72)](_0x140d17(0x12f),Object[_0x140d17(0x66b)](_0x383850['files']));let _0x52e6eb=null;for(let _0x36d85d in _0x383850['files']){if(_0x36d85d['match'](/\.(png|jpg|jpeg|webp)$/i)){_0x52e6eb=_0x383850['files'][_0x36d85d],console[_0x140d17(0xe72)](_0x140d17(0x123d),_0x36d85d);break;}}if(!_0x52e6eb)throw new Error(_0x140d17(0x11a8));const _0x4ee8aa=await _0x52e6eb[_0x140d17(0x42c)](_0x140d17(0x800));console[_0x140d17(0xe72)](_0x140d17(0x10d2),_0x4ee8aa[_0x140d17(0x1240)]);const _0x1585eb=new FileReader();_0xb7b860=await new Promise((_0x408b74,_0x5ab612)=>{const _0x1d51d1=_0x140d17;_0x1585eb[_0x1d51d1(0x132)]=()=>_0x408b74(_0x1585eb['result']),_0x1585eb['onerror']=_0x5ab612,_0x1585eb[_0x1d51d1(0x132a)](_0x4ee8aa);}),console[_0x140d17(0xe72)](_0x140d17(0xf88));}catch(_0x4cbdc0){console[_0x140d17(0x98)]('ZIP解压失败:',_0x4cbdc0);throw new Error(_0x140d17(0x1332)+_0x4cbdc0[_0x140d17(0x5f8)]);}console[_0x140d17(0xe72)]('✅\x20NAI图片'+(_0x37ca2c+0x1)+'生成成功！'),_0xa9719c[_0x140d17(0x258)](_0xb7b860);}_0x49a45b[_0x140d17(0x18a)]=_0xa9719c,_0xa9719c['length']===0x1&&(_0x49a45b[_0x140d17(0xa94)]=_0xa9719c[0x0]),_0x49a45b[_0x140d17(0x357)]=_0x39c53d['prompt'],_0x49a45b[_0x140d17(0x123a)]=_0xa9719c[_0x140d17(0xfde)],console[_0x140d17(0xe72)](_0x140d17(0x11dd)+_0xa9719c['length']+'张');}catch(_0x1c9e45){console[_0x140d17(0x98)]('❌\x20动态NAI图片生成失败:',_0x1c9e45),_0x49a45b[_0x140d17(0x11b6)]=(_0x49a45b[_0x140d17(0x11b6)]||_0x49a45b['publicText']||'')+(_0x140d17(0xf00)+_0x1c9e45[_0x140d17(0x5f8)]+']');}await _0x342df8[_0x140d17(0x35a)][_0x140d17(0xbff)](_0x49a45b),_0x4c6ee1(_0x3a006f+0x1);_0x7f52d3&&document[_0x140d17(0x383)](_0x140d17(0xc0c))[_0x140d17(0x119a)][_0x140d17(0x987)](_0x140d17(0xde5))&&await _0x476b70();continue;case _0x140d17(0xc1b):{const _0x4a4cda=await _0x342df8[_0x140d17(0x35a)][_0x140d17(0x1a3)](parseInt(_0x39c53d['postId']));if(_0x4a4cda){if(!_0x4a4cda[_0x140d17(0xcad)])_0x4a4cda[_0x140d17(0xcad)]=[];const _0x5101ca=_0x39c53d['name']||_0x897d3a[_0x140d17(0x283)],_0xc41ca5=(_0x326e01,_0x41e466=null,_0x221bac=null)=>({'commenterName':_0x5101ca,'text':_0x1d0461(_0x326e01,_0x897d3a),'meaning':_0x41e466,'replyTo':_0x221bac,'timestamp':Date[_0x140d17(0x108d)]()});if(_0x39c53d[_0x140d17(0x114f)]){const _0x1cec8d=_0x41df36[_0x140d17(0x823)][_0x140d17(0xd12)](_0x506cee=>_0x506cee[_0x140d17(0x461)]===_0x39c53d[_0x140d17(0x114f)]);_0x1cec8d?_0x4a4cda[_0x140d17(0xcad)][_0x140d17(0x258)](_0xc41ca5(_0x1cec8d[_0x140d17(0x2fa)],_0x1cec8d[_0x140d17(0x461)],_0x39c53d[_0x140d17(0x855)]||null)):(console[_0x140d17(0x17b)](_0x140d17(0x92f)+_0x39c53d[_0x140d17(0x114f)]+'\x22'),_0x4a4cda[_0x140d17(0xcad)][_0x140d17(0x258)](_0xc41ca5(_0x140d17(0x261)+_0x39c53d[_0x140d17(0x114f)]+']',null,_0x39c53d[_0x140d17(0x855)]||null)));}else{if(Array[_0x140d17(0x565)](_0x39c53d['comments']))_0x39c53d[_0x140d17(0xcad)][_0x140d17(0x19c)](_0x200ba4=>{const _0x343c98=_0x140d17;typeof _0x200ba4==='string'&&_0x200ba4['trim']()&&_0x4a4cda[_0x343c98(0xcad)][_0x343c98(0x258)](_0xc41ca5(_0x200ba4,null,_0x39c53d['replyTo']||null));});else typeof _0x39c53d[_0x140d17(0xb3a)]===_0x140d17(0xafa)&&_0x39c53d[_0x140d17(0xb3a)]['trim']()&&_0x4a4cda[_0x140d17(0xcad)][_0x140d17(0x258)](_0xc41ca5(_0x39c53d[_0x140d17(0xb3a)],null,_0x39c53d['replyTo']||null));}await _0x342df8['qzonePosts']['update'](_0x4a4cda['id'],{'comments':_0x4a4cda[_0x140d17(0xcad)]}),_0x4c6ee1(_0x3a006f+0x1),console[_0x140d17(0xe72)](_0x140d17(0x87d)+_0x897d3a['name']+'\x22\x20评论了动态\x20#'+_0x39c53d['postId']);if(!_0x897d3a[_0x140d17(0xd07)])_0x897d3a[_0x140d17(0xd07)]={};_0x897d3a['commentCooldowns'][_0x39c53d[_0x140d17(0x6b1)]]=Date['now']();}continue;}case _0x140d17(0x121):const _0x4bef27=await _0x342df8['qzonePosts'][_0x140d17(0x1a3)](parseInt(_0x39c53d[_0x140d17(0x6b1)]));if(_0x4bef27){if(!_0x4bef27[_0x140d17(0x133c)])_0x4bef27[_0x140d17(0x133c)]=[];!_0x4bef27[_0x140d17(0x133c)]['includes'](_0x897d3a['name'])&&(_0x4bef27['likes'][_0x140d17(0x258)](_0x897d3a[_0x140d17(0x461)]),await _0x342df8[_0x140d17(0x35a)][_0x140d17(0xaf9)](_0x4bef27['id'],{'likes':_0x4bef27['likes']}),_0x4c6ee1(_0x3a006f+0x1),_0x7f52d3&&document[_0x140d17(0x383)](_0x140d17(0xc0c))[_0x140d17(0x119a)][_0x140d17(0x987)]('active')&&await _0x476b70());}continue;case'repost':{const _0xe0872a=await _0x342df8['qzonePosts'][_0x140d17(0x1a3)](parseInt(_0x39c53d[_0x140d17(0x6b1)]));if(_0xe0872a){const _0xaca674={'type':_0x140d17(0xcf0),'timestamp':Date[_0x140d17(0x108d)](),'authorId':_0x350226,'authorGroupId':_0x897d3a[_0x140d17(0x11a6)],'repostComment':_0x39c53d['comment']||'','originalPost':_0xe0872a,'visibleGroupIds':null};await _0x342df8['qzonePosts'][_0x140d17(0xbff)](_0xaca674),_0x4c6ee1(_0x3a006f+0x1),console[_0x140d17(0xe72)](_0x140d17(0x87d)+_0x897d3a[_0x140d17(0x461)]+_0x140d17(0x127a)+_0x39c53d[_0x140d17(0x6b1)]);}continue;}case _0x140d17(0x1274):!_0x4f60f2[_0x140d17(0x40d)]&&!_0x4f60f2['isAwaitingResponse']&&(_0x41df36[_0x140d17(0xfc5)]=_0x350226,_0x4f60f2[_0x140d17(0xfc5)]=_0x350226,_0x4f60f2[_0x140d17(0xe53)]=!![],_0x4f60f2[_0x140d17(0xc02)]=_0x897d3a['isGroup'],_0x4f60f2['callRequester']=_0x39c53d[_0x140d17(0x461)]||_0x897d3a[_0x140d17(0x461)],_0x3ef794());continue;case _0x140d17(0x4c1):!_0x4f60f2['isActive']&&!_0x4f60f2['isAwaitingResponse']&&(_0x41df36[_0x140d17(0xfc5)]=_0x350226,_0x4f60f2[_0x140d17(0xe53)]=!![],_0x4f60f2[_0x140d17(0xc02)]=!![],_0x4f60f2['initiator']='ai',_0x4f60f2[_0x140d17(0x496)]=_0x39c53d[_0x140d17(0x461)],_0x3ef794());continue;case'pat_user':let _0x33b172;if(_0x897d3a[_0x140d17(0x1a2)]){const _0x426a67=_0x897d3a[_0x140d17(0x12a6)][_0x140d17(0xd12)](_0x230c3c=>_0x230c3c['originalName']===_0x39c53d['name']);_0x33b172=_0x426a67?_0x426a67['groupNickname']:_0x39c53d[_0x140d17(0x461)];}else _0x33b172=_0x897d3a[_0x140d17(0x461)];const _0x4773b4=_0x39c53d[_0x140d17(0x593)]?'\x20'+_0x39c53d[_0x140d17(0x593)][_0x140d17(0x1cb)]():'',_0xa4cf51=_0x33b172+'\x20拍了拍我'+_0x4773b4,_0x229e68={'role':_0x140d17(0xb1),'type':_0x140d17(0xed8),'content':_0xa4cf51,'timestamp':Date[_0x140d17(0x108d)]()};_0x897d3a['history']['push'](_0x229e68);if(_0x7f52d3){const _0xbfa266=document[_0x140d17(0x383)]('phone-screen');_0xbfa266[_0x140d17(0x119a)][_0x140d17(0x131d)](_0x140d17(0x406)),void _0xbfa266['offsetWidth'],_0xbfa266[_0x140d17(0x119a)][_0x140d17(0xbff)](_0x140d17(0x406)),setTimeout(()=>_0xbfa266[_0x140d17(0x119a)][_0x140d17(0x131d)](_0x140d17(0x406)),0x1f4),_0x323467(_0x229e68,_0x897d3a);}else _0x193863(_0x350226,_0xa4cf51);continue;case _0x140d17(0xc47):_0x897d3a[_0x140d17(0x1fe)][_0x140d17(0x6af)]=_0x39c53d[_0x140d17(0x1bb)],_0x897d3a[_0x140d17(0x1fe)][_0x140d17(0xa6d)]=_0x39c53d[_0x140d17(0x1a7)]||![],_0x897d3a[_0x140d17(0x1fe)][_0x140d17(0x6a8)]=Date['now']();const _0xbb7da3={'role':_0x140d17(0xb1),'type':'pat_message','content':'['+_0x897d3a['name']+_0x140d17(0x71f)+_0x39c53d[_0x140d17(0x1bb)]+']','timestamp':Date[_0x140d17(0x108d)]()};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0xbb7da3);_0x7f52d3&&_0x323467(_0xbb7da3,_0x897d3a);_0x25558e();continue;case _0x140d17(0x15a):_0x488e70={..._0x2625a2,'type':_0x140d17(0x15a),'content':_0x39c53d['content']};break;case _0x140d17(0xb09):if(_0x40e606['isActive']&&_0x40e606[_0x140d17(0xfc5)]===_0x350226){const _0x133da8=_0x39c53d[_0x140d17(0x1165)]||_0x39c53d[_0x140d17(0xf1e)]||_0x39c53d[_0x140d17(0x461)];if(typeof _0x133da8===_0x140d17(0xafa)&&_0x133da8[_0x140d17(0x1cb)]()){const _0x180195=_0x133da8[_0x140d17(0x709)](/^\[?\d+\]?[\s.-]*/,'')[_0x140d17(0x1cb)](),_0x7926e=_0x40e606['playlist'][_0x140d17(0xe37)](_0x5ac2f5=>_0x5ac2f5[_0x140d17(0x461)][_0x140d17(0x189)]()===_0x180195[_0x140d17(0x189)]());if(_0x7926e>-0x1){_0x13cdf1(_0x7926e);const _0x5ff4a4=_0x40e606[_0x140d17(0x91b)][_0x7926e];let _0x43af0c;if(_0x897d3a[_0x140d17(0x1a2)]){const _0x5e3b4c=_0x897d3a[_0x140d17(0x12a6)]['find'](_0x19cca7=>_0x19cca7[_0x140d17(0x283)]===_0x39c53d[_0x140d17(0x461)]);_0x43af0c=_0x5e3b4c?_0x5e3b4c[_0x140d17(0x9da)]:_0x39c53d[_0x140d17(0x461)];}else _0x43af0c=_0x897d3a[_0x140d17(0x461)];const _0x2b7a13={'role':_0x140d17(0xb1),'type':_0x140d17(0xed8),'content':_0x140d17(0x6fd)+_0x43af0c+_0x140d17(0xadf)+_0x5ff4a4[_0x140d17(0x461)]+_0x140d17(0xf65)+_0x5ff4a4['artist']+']','timestamp':Date[_0x140d17(0x108d)]()};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0x2b7a13),_0x7f52d3&&_0x323467(_0x2b7a13,_0x897d3a);}else console[_0x140d17(0x17b)](_0x140d17(0x866)+_0x133da8+_0x140d17(0x6e9)+_0x180195+_0x140d17(0xbbd));}else console[_0x140d17(0x98)]('AI返回的change_music指令中，歌曲名无效或缺失:',_0x39c53d);}continue;case _0x140d17(0x3f7):const _0x1c710b={'chatId':_0x350226,'authorId':_0x350226,'description':_0x39c53d[_0x140d17(0xee1)],'timestamp':Date['now'](),'type':'ai_generated'};await _0x342df8['memories'][_0x140d17(0xbff)](_0x1c710b),console[_0x140d17(0xe72)](_0x140d17(0x58e)+_0x897d3a[_0x140d17(0x461)]+_0x140d17(0x996),_0x39c53d[_0x140d17(0xee1)]);continue;case _0x140d17(0x9ac):const _0x49ae8b=new Date(_0x39c53d[_0x140d17(0x18f)]);if(!isNaN(_0x49ae8b)&&_0x49ae8b>new Date()){const _0x4ee550={'chatId':_0x350226,'authorId':_0x350226,'description':_0x39c53d['title'],'timestamp':Date[_0x140d17(0x108d)](),'type':_0x140d17(0x145),'targetDate':_0x49ae8b['getTime']()};await _0x342df8['memories'][_0x140d17(0xbff)](_0x4ee550),console[_0x140d17(0xe72)](_0x140d17(0x58e)+_0x897d3a[_0x140d17(0x461)]+_0x140d17(0xa9e),_0x39c53d[_0x140d17(0xf3a)]);}continue;case _0x140d17(0xe73):if(!_0x897d3a['isGroup']){_0x897d3a[_0x140d17(0x112b)][_0x140d17(0x1fe)]=_0x140d17(0x203);const _0x431f5a={'role':_0x140d17(0xb1),'content':_0x140d17(0xd56),'timestamp':Date[_0x140d17(0x108d)](),'isHidden':!![]};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0x431f5a),await _0x342df8['chats'][_0x140d17(0x9c0)](_0x897d3a);_0x7f52d3&&_0x409076(_0x350226);_0x25558e();break;}continue;case _0x140d17(0xcc1):!_0x897d3a['isGroup']&&_0x897d3a[_0x140d17(0x112b)]?.['status']===_0x140d17(0xccf)&&(_0x39c53d['decision']===_0x140d17(0x3d0)?(_0x897d3a[_0x140d17(0x112b)][_0x140d17(0x1fe)]=_0x140d17(0x757),_0x488e70={..._0x2625a2,'content':_0x140d17(0x2d1)}):(_0x897d3a[_0x140d17(0x112b)][_0x140d17(0x1fe)]=_0x140d17(0x203),_0x488e70={..._0x2625a2,'content':_0x140d17(0x104d)}),_0x897d3a[_0x140d17(0x112b)][_0x140d17(0x6d8)]='');break;case _0x140d17(0x11b9):const _0x5dd953=typeof _0x39c53d[_0x140d17(0x904)]===_0x140d17(0xafa)?_0x39c53d[_0x140d17(0x904)][_0x140d17(0x105d)]('\x0a')[_0x140d17(0x98a)](_0x76d2d5=>_0x76d2d5['trim']()):Array[_0x140d17(0x565)](_0x39c53d['options'])?_0x39c53d['options']:[];if(_0x5dd953[_0x140d17(0xfde)]<0x2)continue;_0x488e70={..._0x2625a2,'type':'poll','question':_0x39c53d['question'],'options':_0x5dd953,'votes':{},'isClosed':![]};break;case _0x140d17(0x980):{const {itemName:_0x5a7a4c,itemPrice:_0x4104b4,image_prompt:_0x3f8a50}=_0x39c53d;if(_0x5a7a4c&&!isNaN(parseFloat(_0x4104b4))&&_0x3f8a50){const _0x3ed6e0=_0x140d17(0x5c1)+encodeURIComponent(_0x3f8a50);_0x488e70={..._0x2625a2,'type':'gift','items':[{'name':_0x5a7a4c,'price':parseFloat(_0x4104b4),'imageUrl':_0x3ed6e0,'quantity':0x1}],'total':parseFloat(_0x4104b4),'recipients':_0x39c53d[_0x140d17(0xbdb)]||null};}else console[_0x140d17(0x17b)](_0x140d17(0xfbe),_0x39c53d);break;}case _0x140d17(0x103d):const _0x2e69bc=_0x897d3a[_0x140d17(0xd08)][_0x140d17(0xd12)](_0x8e90ff=>_0x8e90ff[_0x140d17(0x3b7)]===_0x39c53d[_0x140d17(0xda5)]);_0x2e69bc&&!_0x2e69bc[_0x140d17(0xa17)]&&(Object['keys'](_0x2e69bc[_0x140d17(0x1385)])[_0x140d17(0x19c)](_0x8e864f=>{const _0x2951a8=_0x140d17,_0x33b2b0=_0x2e69bc['votes'][_0x8e864f][_0x2951a8(0x1105)](_0x39c53d[_0x2951a8(0x461)]);_0x33b2b0>-0x1&&_0x2e69bc[_0x2951a8(0x1385)][_0x8e864f][_0x2951a8(0x2f1)](_0x33b2b0,0x1);}),!_0x2e69bc[_0x140d17(0x1385)][_0x39c53d['choice']]&&(_0x2e69bc[_0x140d17(0x1385)][_0x39c53d[_0x140d17(0xeb)]]=[]),!_0x2e69bc['votes'][_0x39c53d[_0x140d17(0xeb)]][_0x140d17(0xee2)](_0x39c53d['name'])&&_0x2e69bc[_0x140d17(0x1385)][_0x39c53d[_0x140d17(0xeb)]][_0x140d17(0x258)](_0x39c53d['name']),_0x7f52d3&&_0x409076(_0x350226));continue;case _0x140d17(0xf55):_0x488e70={..._0x2625a2,..._0x39c53d,'totalAmount':_0x39c53d[_0x140d17(0xe27)],'claimedBy':{},'isFullyClaimed':![]};_0x39c53d[_0x140d17(0x79b)]&&(_0x488e70[_0x140d17(0x30f)]=_0x39c53d[_0x140d17(0x79b)],delete _0x488e70['receiver']);break;case _0x140d17(0x136f):const _0x262136=_0x897d3a[_0x140d17(0xd08)][_0x140d17(0xd12)](_0x627d4a=>_0x627d4a[_0x140d17(0x3b7)]===_0x39c53d['packet_timestamp']),_0x2b5bc3=_0x39c53d['name'],_0x55e8fe=_0x897d3a[_0x140d17(0x12a6)][_0x140d17(0x12fb)](_0x248604=>_0x248604[_0x140d17(0x283)]===_0x2b5bc3);if(!_0x55e8fe){console[_0x140d17(0x17b)](_0x140d17(0x10bb)+_0x2b5bc3+_0x140d17(0x82f));continue;}if(_0x262136&&_0x262136['packetType']===_0x140d17(0xe0e)){if(_0x262136[_0x140d17(0x30f)]!==_0x39c53d[_0x140d17(0x461)]){console[_0x140d17(0x17b)](_0x140d17(0x10bb)+_0x39c53d[_0x140d17(0x461)]+_0x140d17(0x788)+_0x262136['receiverName']+_0x140d17(0xd0d));continue;}}if(_0x262136&&!_0x262136[_0x140d17(0x1010)]&&!(_0x262136['claimedBy']&&_0x262136[_0x140d17(0xb39)][_0x39c53d[_0x140d17(0x461)]])){let _0x5caca6=0x0;const _0x2b8a68=_0x262136[_0x140d17(0x3be)]-Object[_0x140d17(0x76d)](_0x262136[_0x140d17(0xb39)]||{})[_0x140d17(0xf60)]((_0x15d91b,_0x262450)=>_0x15d91b+_0x262450,0x0),_0x41122e=_0x262136[_0x140d17(0x779)]-Object[_0x140d17(0x66b)](_0x262136[_0x140d17(0xb39)]||{})['length'];if(_0x41122e>0x0){if(_0x262136[_0x140d17(0x1350)]==='direct')_0x5caca6=_0x262136[_0x140d17(0x3be)];else{if(_0x41122e===0x1)_0x5caca6=_0x2b8a68;else{const _0x43e8b4=0.01,_0x686117=_0x2b8a68-(_0x41122e-0x1)*_0x43e8b4;_0x5caca6=Math[_0x140d17(0x5ce)]()*(_0x686117-_0x43e8b4)+_0x43e8b4;}}_0x5caca6=parseFloat(_0x5caca6[_0x140d17(0x70d)](0x2));if(!_0x262136['claimedBy'])_0x262136[_0x140d17(0xb39)]={};_0x262136[_0x140d17(0xb39)][_0x39c53d[_0x140d17(0x461)]]=_0x5caca6;const _0x567504=_0x897d3a[_0x140d17(0x12a6)][_0x140d17(0xd12)](_0x3f1495=>_0x3f1495[_0x140d17(0x283)]===_0x39c53d['name']),_0x46336e=_0x567504?_0x567504[_0x140d17(0x9da)]:_0x39c53d[_0x140d17(0x461)],_0x349d77=_0x54d0ab(_0x897d3a,_0x262136['senderName']),_0xd5e5d8={'role':'system','type':_0x140d17(0xed8),'content':_0x46336e+_0x140d17(0xcd7)+_0x349d77+_0x140d17(0x134c),'timestamp':Date['now']()};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0xd5e5d8);let _0x2758f0=_0x140d17(0x989)+_0x46336e+')\x20成功抢到了\x20'+_0x5caca6[_0x140d17(0x70d)](0x2)+_0x140d17(0x111b);if(Object['keys'](_0x262136[_0x140d17(0xb39)])[_0x140d17(0xfde)]>=_0x262136[_0x140d17(0x779)]){_0x262136[_0x140d17(0x1010)]=!![];const _0x35d716={'role':_0x140d17(0xb1),'type':_0x140d17(0xed8),'content':_0x349d77+_0x140d17(0xd75),'timestamp':Date[_0x140d17(0x108d)]()+0x1};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0x35d716);let _0x1a3311={'name':'','amount':-0x1};_0x262136['packetType']==='lucky'&&_0x262136[_0x140d17(0x779)]>0x1&&Object[_0x140d17(0x329)](_0x262136[_0x140d17(0xb39)])['forEach'](([_0x3cf75a,_0x19f8f6])=>{const _0x382530=_0x140d17;_0x19f8f6>_0x1a3311[_0x382530(0xe27)]&&(_0x1a3311={'name':_0x3cf75a,'amount':_0x19f8f6});});if(_0x1a3311[_0x140d17(0x461)]){const _0x19cf62=_0x897d3a[_0x140d17(0x12a6)][_0x140d17(0xd12)](_0x605764=>_0x605764[_0x140d17(0x283)]===_0x1a3311[_0x140d17(0x461)]),_0x5c1482=_0x19cf62?_0x19cf62['groupNickname']:_0x1a3311[_0x140d17(0x461)];_0x2758f0+=_0x140d17(0x9d1)+_0x5c1482+'！';}else _0x2758f0+=_0x140d17(0xb5e);}_0x2758f0+=_0x140d17(0x2de);const _0x1e887e={'role':_0x140d17(0xb1),'content':_0x2758f0,'timestamp':Date[_0x140d17(0x108d)]()+0x2,'isHidden':!![]};_0x897d3a[_0x140d17(0xd08)]['push'](_0x1e887e);}_0x7f52d3&&(_0x409076(_0x350226),_0x25558e());}continue;case _0x140d17(0x991):{const _0x4de0db=_0x897d3a[_0x140d17(0xd08)][_0x140d17(0xe37)](_0x4d5106=>_0x4d5106['timestamp']===_0x39c53d[_0x140d17(0x1397)]);if(_0x4de0db>-0x1){const _0x3a0e33=_0x897d3a[_0x140d17(0xd08)][_0x4de0db];_0x3a0e33[_0x140d17(0x1fe)]=_0x140d17(0x4f3);}continue;}case _0x140d17(0x117c):{const _0x49f89a=_0x897d3a['history'][_0x140d17(0xe37)](_0x22712e=>_0x22712e[_0x140d17(0x3b7)]===_0x39c53d['for_timestamp']);if(_0x49f89a>-0x1){const _0x10642e=_0x897d3a[_0x140d17(0xd08)][_0x49f89a];_0x10642e[_0x140d17(0x1fe)]=_0x140d17(0xfd2);const _0x1ee233={'role':_0x140d17(0xf3c),'senderName':_0x897d3a['name'],'type':_0x140d17(0x909),'isRefund':!![],'amount':_0x10642e[_0x140d17(0xe27)],'note':'转账已被拒收','timestamp':_0x54b77c++};_0x897d3a['history'][_0x140d17(0x258)](_0x1ee233),_0x7f52d3&&(_0x323467(_0x1ee233,_0x897d3a),_0x409076(_0x350226));}continue;}case'change_group_name':if(_0x897d3a[_0x140d17(0x1a2)]&&_0x39c53d[_0x140d17(0x25b)]){const _0x1de450=_0x39c53d[_0x140d17(0x25b)]['trim'](),_0x306e8c=_0x897d3a[_0x140d17(0x12a6)][_0x140d17(0xa79)](_0x46396d=>_0x46396d[_0x140d17(0x283)]);if(_0x306e8c['includes'](_0x1de450)){console['warn'](_0x140d17(0x498)+_0x39c53d['name']+_0x140d17(0xa41)+_0x1de450+_0x140d17(0xf85));continue;}_0x897d3a[_0x140d17(0x461)]=_0x1de450;const _0x11d616=_0x897d3a['members'][_0x140d17(0xd12)](_0x5d7279=>_0x5d7279[_0x140d17(0x283)]===_0x39c53d[_0x140d17(0x461)]),_0x1d46c2=_0x11d616?_0x11d616[_0x140d17(0x9da)]:_0x39c53d[_0x140d17(0x461)],_0x415efa={'role':'system','type':_0x140d17(0xed8),'content':_0x1d46c2+'\x20将群名修改为\x20“'+_0x897d3a[_0x140d17(0x461)]+'”','timestamp':_0x54b77c++};_0x897d3a['history']['push'](_0x415efa),_0x7f52d3&&(_0x323467(_0x415efa,_0x897d3a),document[_0x140d17(0x383)](_0x140d17(0x969))['textContent']=_0x897d3a[_0x140d17(0x461)]);}continue;case'change_remark_name':if(!_0x897d3a['isGroup']&&_0x39c53d[_0x140d17(0x25b)]){const _0x2528c8=_0x897d3a[_0x140d17(0x461)],_0xf13af6=_0x39c53d[_0x140d17(0x25b)][_0x140d17(0x1cb)]();if(_0xf13af6&&_0xf13af6!==_0x2528c8){!_0x897d3a[_0x140d17(0xcf9)]&&(_0x897d3a['nameHistory']=[]);!_0x897d3a[_0x140d17(0xcf9)][_0x140d17(0xee2)](_0x2528c8)&&_0x897d3a['nameHistory'][_0x140d17(0x258)](_0x2528c8);_0x897d3a[_0x140d17(0x461)]=_0xf13af6;const _0x5c8bfa={'role':_0x140d17(0xb1),'type':'pat_message','content':'“'+_0x897d3a['originalName']+_0x140d17(0x11a)+_0xf13af6+'”','timestamp':_0x54b77c++};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0x5c8bfa);const _0x55d2cc={'role':_0x140d17(0xb1),'content':_0x140d17(0x988)+_0xf13af6+_0x140d17(0x154),'timestamp':_0x54b77c++,'isHidden':!![]};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0x55d2cc),_0x7f52d3&&(_0x323467(_0x5c8bfa,_0x897d3a),document[_0x140d17(0x383)]('chat-header-title')[_0x140d17(0x138e)]=_0xf13af6),await _0x2d549c(_0x897d3a);}}continue;case _0x140d17(0xe3f):if(_0x897d3a[_0x140d17(0x1a2)]&&_0x39c53d[_0x140d17(0x1073)]){const _0x124b9c=_0x39c53d[_0x140d17(0x1073)],_0xf0c6ee=_0x897d3a[_0x140d17(0x886)][_0x140d17(0x34a)]||[],_0xa85aa8=_0xf0c6ee[_0x140d17(0xd12)](_0x1b5d83=>_0x1b5d83[_0x140d17(0x461)]===_0x124b9c);if(_0xa85aa8){_0x897d3a[_0x140d17(0x886)][_0x140d17(0x332)]=_0xa85aa8[_0x140d17(0x2fa)];const _0x5a3323=_0x897d3a[_0x140d17(0x12a6)]['find'](_0x59e596=>_0x59e596['originalName']===_0x39c53d[_0x140d17(0x461)]),_0x3fbee2=_0x5a3323?_0x5a3323['groupNickname']:_0x39c53d['name'],_0x168940={'role':_0x140d17(0xb1),'type':'pat_message','content':_0x3fbee2+_0x140d17(0x1261),'timestamp':_0x54b77c++};_0x897d3a[_0x140d17(0xd08)][_0x140d17(0x258)](_0x168940),_0x7f52d3&&_0x323467(_0x168940,_0x897d3a);}else console[_0x140d17(0x17b)](_0x140d17(0x106a)+_0x124b9c+'\x22');}continue;case _0x140d17(0x1d1):_0x488e70={'role':_0x140d17(0xb1),'type':_0x140d17(0xed8),'content':_0x39c53d['content'],'timestamp':Date[_0x140d17(0x108d)]()};break;case _0x140d17(0x94a):_0x488e70={..._0x2625a2,'type':_0x140d17(0x94a),'title':_0x39c53d[_0x140d17(0xf3a)],'description':_0x39c53d['description'],'source_name':_0x39c53d[_0x140d17(0x8d4)],'content':_0x39c53d[_0x140d17(0x11b6)]};break;case'quote_reply':const _0x39bc17=_0x897d3a[_0x140d17(0xd08)]['find'](_0x48d89b=>_0x48d89b[_0x140d17(0x3b7)]===_0x39c53d[_0x140d17(0x17d)]);if(_0x39bc17){const _0x55bca6={'timestamp':_0x39bc17['timestamp'],'senderName':_0x39bc17[_0x140d17(0x4c5)]||(_0x39bc17[_0x140d17(0x10ff)]===_0x140d17(0x66e)?_0x897d3a[_0x140d17(0x886)][_0x140d17(0x52e)]||'我':_0x897d3a[_0x140d17(0x461)]),'content':String(_0x39bc17[_0x140d17(0x11b6)]||'')[_0x140d17(0xba5)](0x0,0x32)};_0x488e70={..._0x2625a2,'content':_0x39c53d['reply_content'],'quote':_0x55bca6};}else _0x488e70={..._0x2625a2,'content':_0x39c53d[_0x140d17(0x5a6)]};break;case _0x140d17(0x479):{if(!_0x7f52d3)continue;const _0x121225={..._0x2625a2,'content':_0x39c53d['content']},_0x39564e=_0x152d98(_0x121225,_0x897d3a);_0x323467(_0x121225,_0x897d3a,!![]),await new Promise(_0x4b5b1a=>setTimeout(_0x4b5b1a,Math[_0x140d17(0x5ce)]()*0x3e8+0x5dc));const _0x2def29=document[_0x140d17(0x89c)](_0x140d17(0x1110)+_0x121225[_0x140d17(0x3b7)]+'\x22]')?.[_0x140d17(0x58c)](_0x140d17(0x1096));if(_0x2def29){_0x2def29[_0x140d17(0x119a)][_0x140d17(0xbff)](_0x140d17(0x701)),await new Promise(_0x43e9ab=>setTimeout(_0x43e9ab,0x12c));const _0x575b0c={'role':_0x140d17(0xf3c),'senderName':_0x39c53d['name']||_0x897d3a[_0x140d17(0x461)],'type':_0x140d17(0x1e8),'content':_0x140d17(0xfff),'timestamp':_0x121225[_0x140d17(0x3b7)],'recalledData':{'originalType':_0x140d17(0x6af),'originalContent':_0x39c53d[_0x140d17(0x11b6)]}},_0x372d44=_0x897d3a['history']['findIndex'](_0x438492=>_0x438492[_0x140d17(0x3b7)]===_0x121225[_0x140d17(0x3b7)]);_0x372d44>-0x1?_0x897d3a[_0x140d17(0xd08)][_0x372d44]=_0x575b0c:_0x897d3a['history'][_0x140d17(0x258)](_0x575b0c);const _0x5bfff6=await _0x152d98(_0x575b0c,_0x897d3a);document['body'][_0x140d17(0x987)](_0x2def29)&&_0x2def29['parentNode'][_0x140d17(0xe58)](_0x5bfff6,_0x2def29);}continue;}case _0x140d17(0x6af):_0x488e70={..._0x2625a2,'content':String(_0x39c53d[_0x140d17(0x11b6)]||_0x39c53d[_0x140d17(0x5f8)])};break;case _0x140d17(0x37d):if(_0x39c53d[_0x140d17(0x7de)]){const _0x3c404b=_0x41df36[_0x140d17(0x823)]['find'](_0x2c6367=>_0x2c6367[_0x140d17(0x461)]===_0x39c53d['meaning']);_0x3c404b?_0x488e70={..._0x2625a2,'type':'sticker','content':_0x3c404b[_0x140d17(0x2fa)],'meaning':_0x3c404b[_0x140d17(0x461)]}:(console[_0x140d17(0x17b)](_0x140d17(0xa3e)+_0x39c53d[_0x140d17(0x7de)]+'\x22'),_0x488e70={..._0x2625a2,'type':_0x140d17(0x6af),'content':_0x140d17(0x261)+_0x39c53d[_0x140d17(0x7de)]+']'});}else console[_0x140d17(0x17b)](_0x140d17(0x8e7),_0x39c53d),_0x488e70={..._0x2625a2,'type':_0x140d17(0x37d),'content':_0x39c53d[_0x140d17(0x2fa)],'meaning':_0x140d17(0x2a8)};break;case _0x140d17(0x1050):_0x488e70={..._0x2625a2,'type':_0x140d17(0x1050),'content':_0x39c53d[_0x140d17(0xee1)],'image_prompt':_0x39c53d['image_prompt']};break;case _0x140d17(0xa4f):_0x488e70={..._0x2625a2,'type':_0x140d17(0xa4f),'content':_0x39c53d[_0x140d17(0x11b6)]};break;case _0x140d17(0x909):_0x488e70={..._0x2625a2,'type':_0x140d17(0x909),'amount':_0x39c53d[_0x140d17(0xe27)],'note':_0x39c53d[_0x140d17(0x775)],'receiverName':_0x39c53d[_0x140d17(0x79b)]||'我'};break;case _0x140d17(0x990):_0x488e70={..._0x2625a2,'type':_0x140d17(0x990),'productInfo':_0x39c53d[_0x140d17(0x12b1)],'amount':_0x39c53d[_0x140d17(0xe27)],'status':_0x140d17(0x1ad),'countdownEndTime':Date[_0x140d17(0x108d)]()+0xf*0x3c*0x3e8};break;case _0x140d17(0xd65):_0x488e70={..._0x2625a2,'type':_0x140d17(0xd65),'productInfo':_0x39c53d[_0x140d17(0x12b1)],'amount':_0x39c53d[_0x140d17(0xe27)],'greeting':_0x39c53d[_0x140d17(0xe12)],'recipientName':_0x39c53d[_0x140d17(0x2a5)]||null};break;case'offline_text':_0x488e70={..._0x2625a2,..._0x39c53d};break;case'naiimag':try{console['log']('📸\x20NovelAI图片生成开始，AI提供的prompt:',_0x39c53d['prompt']);const _0x3b6046=_0x51675f(_0x897d3a['id']),_0x2cac65=_0x39c53d[_0x140d17(0x357)]||_0x140d17(0xc86),_0x44d86c=_0x2cac65+',\x20'+_0x3b6046[_0x140d17(0x848)],_0x543140=_0x3b6046[_0x140d17(0x57e)];console['log'](_0x140d17(0x638)+(_0x3b6046[_0x140d17(0xd24)]===_0x140d17(0xa0)?_0x140d17(0x74e):'系统')+_0x140d17(0x92e)),console[_0x140d17(0xe72)](_0x140d17(0x961),_0x44d86c),console[_0x140d17(0xe72)]('最终负面提示词:',_0x543140);const _0x2af479=localStorage[_0x140d17(0xb2)](_0x140d17(0x20a)),_0x2d98d3=localStorage['getItem'](_0x140d17(0x1d4))||_0x140d17(0x11cb),_0x52410d=_0x4eb791();if(!_0x2af479)throw new Error('NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。');const [_0x20d13d,_0x28e665]=_0x52410d['resolution'][_0x140d17(0x105d)]('x')[_0x140d17(0xa79)](Number);let _0x4d6084;_0x2d98d3[_0x140d17(0xee2)]('nai-diffusion-4')?_0x4d6084={'input':_0x44d86c,'model':_0x2d98d3,'action':_0x140d17(0x408),'parameters':{'params_version':0x3,'width':_0x20d13d,'height':_0x28e665,'scale':_0x52410d[_0x140d17(0x78d)],'sampler':_0x52410d[_0x140d17(0xb4b)],'steps':_0x52410d[_0x140d17(0x300)],'seed':_0x52410d['seed']===-0x1?Math['floor'](Math[_0x140d17(0x5ce)]()*0x2540be3ff):_0x52410d[_0x140d17(0x105f)],'n_samples':0x1,'ucPreset':_0x52410d[_0x140d17(0xc63)],'qualityToggle':_0x52410d[_0x140d17(0x102a)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':'karras','legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x44d86c,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x543140,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x543140,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x4d6084={'input':_0x44d86c,'model':_0x2d98d3,'action':_0x140d17(0x408),'parameters':{'width':_0x20d13d,'height':_0x28e665,'scale':_0x52410d['cfg_scale'],'sampler':_0x52410d[_0x140d17(0xb4b)],'steps':_0x52410d['steps'],'seed':_0x52410d[_0x140d17(0x105f)]===-0x1?Math[_0x140d17(0xdee)](Math[_0x140d17(0x5ce)]()*0x2540be3ff):_0x52410d[_0x140d17(0x105f)],'n_samples':0x1,'ucPreset':_0x52410d[_0x140d17(0xc63)],'qualityToggle':_0x52410d[_0x140d17(0x102a)],'sm':_0x52410d[_0x140d17(0xc76)],'sm_dyn':_0x52410d[_0x140d17(0x6ee)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x140d17(0xa72),'negative_prompt':_0x543140}};console[_0x140d17(0xe72)](_0x140d17(0xaa1),_0x4d6084);let _0x1ede5a;_0x2d98d3[_0x140d17(0xee2)]('nai-diffusion-4')?_0x1ede5a=_0x140d17(0x10c4):_0x1ede5a='https://image.novelai.net/ai/generate-image';let _0xd99d55=_0x52410d['cors_proxy'];_0xd99d55==='custom'&&(_0xd99d55=_0x52410d[_0x140d17(0x590)]||'');_0xd99d55&&_0xd99d55!==''&&(_0x1ede5a=_0xd99d55+encodeURIComponent(_0x1ede5a));const _0x5cf708=await fetch(_0x1ede5a,{'method':_0x140d17(0x94f),'headers':{'Content-Type':_0x140d17(0x11f0),'Authorization':_0x140d17(0xd55)+_0x2af479},'body':JSON[_0x140d17(0x3fb)](_0x4d6084)});console[_0x140d17(0xe72)](_0x140d17(0x577),_0x5cf708['status']),console[_0x140d17(0xe72)](_0x140d17(0x73f),[..._0x5cf708[_0x140d17(0xb60)][_0x140d17(0x329)]()]);if(!_0x5cf708['ok']){const _0x2b915c=await _0x5cf708[_0x140d17(0x6af)]();console[_0x140d17(0x98)](_0x140d17(0xb3f),_0x2b915c);throw new Error(_0x140d17(0x1205)+_0x5cf708['status']+_0x140d17(0x12a8)+_0x2b915c);}const _0x431a69=_0x5cf708[_0x140d17(0xb60)][_0x140d17(0x1a3)](_0x140d17(0x598));console['log']('Content-Type:',_0x431a69);let _0x12bbd2,_0x1efcf7;if(_0x431a69&&_0x431a69[_0x140d17(0xee2)]('text/event-stream')){console[_0x140d17(0xe72)](_0x140d17(0xfa));const _0x4da100=await _0x5cf708[_0x140d17(0x6af)]();console[_0x140d17(0xe72)](_0x140d17(0x364),_0x4da100[_0x140d17(0xfde)]);const _0x5e3bf2=_0x4da100[_0x140d17(0x1cb)]()['split']('\x0a');let _0x1a83d4=null;for(let _0x2d68cc=_0x5e3bf2[_0x140d17(0xfde)]-0x1;_0x2d68cc>=0x0;_0x2d68cc--){const _0x223809=_0x5e3bf2[_0x2d68cc]['trim']();if(_0x223809[_0x140d17(0x1122)](_0x140d17(0xe18))&&_0x223809!=='data:\x20[DONE]'){const _0x55c4cb=_0x223809['substring'](0x6);try{const _0x10351b=JSON[_0x140d17(0x134)](_0x55c4cb);if(_0x10351b['event_type']===_0x140d17(0xdae)&&_0x10351b['image']){_0x1a83d4=_0x10351b[_0x140d17(0x482)],console[_0x140d17(0xe72)](_0x140d17(0x5ee));break;}if(_0x10351b[_0x140d17(0x8c6)]){_0x1a83d4=_0x10351b[_0x140d17(0x8c6)],console['log']('从\x20JSON.data\x20中提取图片数据');break;}if(_0x10351b[_0x140d17(0x482)]){_0x1a83d4=_0x10351b[_0x140d17(0x482)],console[_0x140d17(0xe72)]('从\x20JSON.image\x20中提取图片数据');break;}}catch(_0x3f1047){_0x1a83d4=_0x55c4cb,console[_0x140d17(0xe72)](_0x140d17(0xa92));break;}}}if(!_0x1a83d4)throw new Error('无法从\x20SSE\x20响应中提取图片数据');const _0x5e4f75=_0x1a83d4['startsWith'](_0x140d17(0x9c4)),_0x51f404=_0x1a83d4[_0x140d17(0x1122)](_0x140d17(0x1141));if(_0x5e4f75||_0x51f404){console[_0x140d17(0xe72)](_0x140d17(0xa42));const _0x4c4b18=atob(_0x1a83d4),_0x1a062c=new Uint8Array(_0x4c4b18[_0x140d17(0xfde)]);for(let _0x3abab2=0x0;_0x3abab2<_0x4c4b18[_0x140d17(0xfde)];_0x3abab2++){_0x1a062c[_0x3abab2]=_0x4c4b18[_0x140d17(0x274)](_0x3abab2);}const _0x50b7e4=new Blob([_0x1a062c],{'type':_0x5e4f75?_0x140d17(0x7bd):_0x140d17(0x3f3)});console[_0x140d17(0xe72)](_0x140d17(0xbbc),_0x50b7e4[_0x140d17(0x1240)]);const _0x15db44=new FileReader();_0x1efcf7=await new Promise((_0x2ce99d,_0x10b94b)=>{const _0x1e4c3f=_0x140d17;_0x15db44['onloadend']=()=>_0x2ce99d(_0x15db44['result']),_0x15db44[_0x1e4c3f(0x40f)]=_0x10b94b,_0x15db44[_0x1e4c3f(0x132a)](_0x50b7e4);}),console['log'](_0x140d17(0x10ce));}else{console[_0x140d17(0xe72)](_0x140d17(0xecf));const _0x818609=atob(_0x1a83d4),_0x13b269=new Uint8Array(_0x818609[_0x140d17(0xfde)]);for(let _0xb1b1ce=0x0;_0xb1b1ce<_0x818609[_0x140d17(0xfde)];_0xb1b1ce++){_0x13b269[_0xb1b1ce]=_0x818609[_0x140d17(0x274)](_0xb1b1ce);}_0x12bbd2=new Blob([_0x13b269]),console[_0x140d17(0xe72)](_0x140d17(0x700),_0x12bbd2['size']);}}else _0x12bbd2=await _0x5cf708['blob'](),console[_0x140d17(0xe72)]('收到数据，类型:',_0x12bbd2[_0x140d17(0xa6b)],_0x140d17(0xdc9),_0x12bbd2['size']);if(!_0x1efcf7&&_0x12bbd2)try{if(typeof JSZip===_0x140d17(0x89d))throw new Error(_0x140d17(0x8df));const _0x2df7c4=await JSZip['loadAsync'](_0x12bbd2);console[_0x140d17(0xe72)]('ZIP文件内容:',Object['keys'](_0x2df7c4[_0x140d17(0x1185)]));let _0x513d58=null;for(let _0x164296 in _0x2df7c4['files']){if(_0x164296['match'](/\.(png|jpg|jpeg|webp)$/i)){_0x513d58=_0x2df7c4['files'][_0x164296],console[_0x140d17(0xe72)](_0x140d17(0x123d),_0x164296);break;}}if(!_0x513d58)throw new Error(_0x140d17(0x11a8));const _0x4127f5=await _0x513d58[_0x140d17(0x42c)](_0x140d17(0x800));console[_0x140d17(0xe72)]('提取的图片大小:',_0x4127f5[_0x140d17(0x1240)]);const _0xbb02b4=new FileReader();_0x1efcf7=await new Promise((_0x2cc641,_0x3b30c5)=>{const _0xe4ab09=_0x140d17;_0xbb02b4['onloadend']=()=>_0x2cc641(_0xbb02b4[_0xe4ab09(0xa86)]),_0xbb02b4[_0xe4ab09(0x40f)]=_0x3b30c5,_0xbb02b4[_0xe4ab09(0x132a)](_0x4127f5);}),console[_0x140d17(0xe72)](_0x140d17(0xf88));}catch(_0xc7075){console[_0x140d17(0x98)]('ZIP解压失败:',_0xc7075);throw new Error(_0x140d17(0x1332)+_0xc7075['message']);}console[_0x140d17(0xe72)](_0x140d17(0xc43)),_0x488e70={..._0x2625a2,'type':_0x140d17(0x7f4),'imageUrl':_0x1efcf7,'prompt':_0x2cac65,'fullPrompt':_0x44d86c};}catch(_0x72d9a8){console[_0x140d17(0x98)]('❌\x20NAI图片生成失败:',_0x72d9a8),_0x488e70={..._0x2625a2,'content':_0x140d17(0x8ac)+_0x72d9a8[_0x140d17(0x5f8)]+']'};}break;default:console[_0x140d17(0x17b)](_0x140d17(0x663),_0x39c53d['type']);break;}if(_0x488e70){_0x897d3a['history'][_0x140d17(0x258)](_0x488e70);!_0x7f52d3&&(_0x897d3a[_0x140d17(0x40c)]=(_0x897d3a['unreadCount']||0x0)+0x1);if(!_0x7f52d3&&!_0x33235a){let _0x3c07c1;switch(_0x488e70['type']){case _0x140d17(0x909):_0x3c07c1=_0x140d17(0x710);break;case _0x140d17(0x990):_0x3c07c1=_0x140d17(0x1228);break;case _0x140d17(0x1050):_0x3c07c1=_0x140d17(0x1167);break;case _0x140d17(0xa4f):_0x3c07c1=_0x140d17(0x310);break;case'sticker':_0x3c07c1=_0x488e70[_0x140d17(0x7de)]?_0x140d17(0x261)+_0x488e70[_0x140d17(0x7de)]+']':_0x140d17(0x66f);break;case _0x140d17(0x44e):_0x3c07c1=_0x488e70[_0x140d17(0x5ed)]?'「'+_0x488e70['dialogue']+'」':'['+_0x488e70[_0x140d17(0xee1)][_0x140d17(0xba5)](0x0,0x14)+'...]';break;default:_0x3c07c1=String(_0x488e70['content']||'');}const _0x8c108d=_0x897d3a[_0x140d17(0x1a2)]?_0x488e70[_0x140d17(0x4c5)]+':\x20'+_0x3c07c1:_0x3c07c1;_0x193863(_0x350226,_0x8c108d['substring'](0x0,0x28)+(_0x8c108d['length']>0x28?_0x140d17(0x1026):'')),_0x33235a=!![];}_0x7f52d3&&(_0x323467(_0x488e70,_0x897d3a),await new Promise(_0x39ab0f=>setTimeout(_0x39ab0f,Math[_0x140d17(0x5ce)]()*0x708+0x3e8)));}}_0x102c73&&_0x4f60f2[_0x140d17(0xc02)]&&(_0x4f60f2[_0x140d17(0xe53)]=![],_0x4f60f2[_0x140d17(0x9a6)][_0x140d17(0xfde)]>0x0?_0x267991():(_0x4f60f2={..._0x4f60f2,'isAwaitingResponse':![],'participants':[]},_0x105acd('chat-interface-screen'),alert(_0x140d17(0xca3))));if(_0x183d39){await _0x11e743();return;}await _0x342df8['chats'][_0x140d17(0x9c0)](_0x897d3a);const _0x4262b8=_0x20d2c4[_0x140d17(0x12fb)](_0x37d369=>_0x37d369['type']===_0x140d17(0xd91)||_0x37d369[_0x140d17(0xa6b)]===_0x140d17(0x121)||_0x37d369[_0x140d17(0xa6b)]===_0x140d17(0xc1b)||_0x37d369[_0x140d17(0xa6b)]===_0x140d17(0xcf0));_0x4262b8&&(console[_0x140d17(0xe72)](_0x140d17(0xae1)),await _0x476b70());}catch(_0x28447f){_0x897d3a[_0x140d17(0xd08)]=_0x897d3a['history'][_0x140d17(0x98a)](_0x1bdce4=>!_0x1bdce4[_0x140d17(0x31b)]),!_0x897d3a['isGroup']&&_0x897d3a[_0x140d17(0x112b)]?.['status']===_0x140d17(0xccf)?(_0x897d3a['relationship'][_0x140d17(0x1fe)]=_0x140d17(0x203),await _0x296ef9(_0x140d17(0x94e),_0x140d17(0x1306)+_0x28447f[_0x140d17(0x5f8)])):await _0x296ef9(_0x140d17(0xc11),_0x140d17(0x10b9)+_0x28447f['message']),!_0x897d3a[_0x140d17(0x1a2)]&&_0x897d3a['relationship']?.[_0x140d17(0x1fe)]===_0x140d17(0x203)&&await _0x342df8[_0x140d17(0x864)][_0x140d17(0x9c0)](_0x897d3a),_0x4f60f2[_0x140d17(0xe53)]=![];}finally{_0x2f64f8(_0x350226,![]),_0x897d3a[_0x140d17(0x1a2)]?_0x1a872e&&(_0x1a872e['style'][_0x140d17(0x2b6)]=_0x140d17(0xa70)):_0x32f204&&_0x41df36[_0x140d17(0x864)][_0x350226]&&(_0x32f204[_0x140d17(0x655)][_0x140d17(0x10ec)]=0x0,setTimeout(()=>{const _0x58a883=_0x140d17;_0x32f204[_0x58a883(0x138e)]=_0x41df36[_0x58a883(0x864)][_0x350226][_0x58a883(0x461)],_0x32f204[_0x58a883(0x119a)][_0x58a883(0x131d)](_0x58a883(0x9a5)),_0x32f204[_0x58a883(0x655)][_0x58a883(0x10ec)]=0x1;},0xc8)),_0x25558e(),_0x1b6065&&_0x2235e7(_0x350226),_0x4f6d5a();}}async function _0x1788df(_0x2b8f5f){const _0x25f832=_0x549949;if(!_0x41df36['activeChatId'])return;const _0x1741cf=_0x41df36['chats'][_0x41df36[_0x25f832(0xfc5)]],_0x3d8375={'role':_0x25f832(0x66e),'content':_0x2b8f5f[_0x25f832(0x2fa)],'meaning':_0x2b8f5f[_0x25f832(0x461)],'timestamp':Date[_0x25f832(0x108d)]()};_0x1741cf[_0x25f832(0xd08)][_0x25f832(0x258)](_0x3d8375),await _0x342df8['chats'][_0x25f832(0x9c0)](_0x1741cf),_0x323467(_0x3d8375,_0x1741cf),_0x25558e(),document[_0x25f832(0x383)]('sticker-panel')[_0x25f832(0x119a)]['remove'](_0x25f832(0x106d));}async function _0x49d889(){const _0x43d79c=_0x549949;if(!_0x41df36[_0x43d79c(0xfc5)])return;const _0x3a0ff5=document[_0x43d79c(0x383)]('transfer-amount'),_0x55941b=document[_0x43d79c(0x383)](_0x43d79c(0x121c)),_0x3425bb=parseFloat(_0x3a0ff5[_0x43d79c(0x1be)]),_0x357879=_0x55941b['value'][_0x43d79c(0x1cb)]();if(isNaN(_0x3425bb)||_0x3425bb<0x0){alert(_0x43d79c(0x607));return;}const _0x5b2b21=_0x41df36[_0x43d79c(0x864)][_0x41df36['activeChatId']],_0xde124a=_0x5b2b21[_0x43d79c(0x1a2)]?_0x5b2b21[_0x43d79c(0x886)][_0x43d79c(0x52e)]||'我':'我',_0xbdc050=_0x5b2b21['isGroup']?'群聊':_0x5b2b21[_0x43d79c(0x461)],_0x60f4f5={'role':'user','type':'transfer','amount':_0x3425bb,'note':_0x357879,'senderName':_0xde124a,'receiverName':_0xbdc050,'timestamp':Date[_0x43d79c(0x108d)]()};_0x5b2b21[_0x43d79c(0xd08)][_0x43d79c(0x258)](_0x60f4f5),await _0x342df8[_0x43d79c(0x864)][_0x43d79c(0x9c0)](_0x5b2b21),_0x323467(_0x60f4f5,_0x5b2b21),_0x25558e(),document[_0x43d79c(0x383)]('transfer-modal')['classList'][_0x43d79c(0x131d)](_0x43d79c(0x106d)),_0x3a0ff5[_0x43d79c(0x1be)]='',_0x55941b[_0x43d79c(0x1be)]='';}async function _0x4f91d8(){const _0x32e20d=_0x549949;if(!_0x41df36[_0x32e20d(0xfc5)])return;const _0xc848a9=document[_0x32e20d(0x383)](_0x32e20d(0x11ef)),_0x13faad=document['getElementById'](_0x32e20d(0x96e)),_0x5cc49e=_0xc848a9[_0x32e20d(0x1be)][_0x32e20d(0x1cb)](),_0x929b38=parseFloat(_0x13faad[_0x32e20d(0x1be)]);if(!_0x5cc49e||isNaN(_0x929b38)||_0x929b38<=0x0){alert(_0x32e20d(0xa1));return;}const _0x3612a0=_0x41df36[_0x32e20d(0x864)][_0x41df36[_0x32e20d(0xfc5)]],_0xb1f52b=Date['now'](),_0x7cac37=_0x3612a0['isGroup']?_0x3612a0['settings']['myNickname']||'我':'我',_0x148be1={'role':_0x32e20d(0x66e),'senderName':_0x7cac37,'type':'waimai_order','productInfo':_0x5cc49e,'amount':_0x929b38,'timestamp':_0xb1f52b};_0x3612a0[_0x32e20d(0xd08)][_0x32e20d(0x258)](_0x148be1);const _0x8bc41={'role':_0x32e20d(0xb1),'content':'[系统提示：用户('+_0x7cac37+_0x32e20d(0xb99)+_0x5cc49e+_0x32e20d(0xd4)+_0x929b38+'元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','timestamp':_0xb1f52b+0x1,'isHidden':!![]};_0x3612a0[_0x32e20d(0xd08)][_0x32e20d(0x258)](_0x8bc41),await _0x342df8[_0x32e20d(0x864)][_0x32e20d(0x9c0)](_0x3612a0),_0x323467(_0x148be1,_0x3612a0),_0x25558e(),_0xc848a9[_0x32e20d(0x1be)]='',_0x13faad[_0x32e20d(0x1be)]='',document[_0x32e20d(0x383)](_0x32e20d(0x1091))[_0x32e20d(0x119a)]['remove'](_0x32e20d(0x106d));}async function _0x5e13ef(){const _0x31d19f=_0x549949;if(!_0x41df36[_0x31d19f(0xfc5)])return;const _0x20bf7c=await _0x12e332(_0x31d19f(0x439),_0x31d19f(0x12b6),'');if(!_0x20bf7c||!_0x20bf7c[_0x31d19f(0x1cb)]())return;const _0x367c79=_0x31d19f(0x3cc),_0x2dc002=_0x41df36['chats'][_0x41df36[_0x31d19f(0xfc5)]],_0x650efd={'role':_0x31d19f(0x66e),'type':'location_share','content':_0x20bf7c['trim'](),'imageUrl':_0x367c79,'timestamp':Date[_0x31d19f(0x108d)]()};_0x2dc002[_0x31d19f(0xd08)][_0x31d19f(0x258)](_0x650efd),await _0x342df8[_0x31d19f(0x864)][_0x31d19f(0x9c0)](_0x2dc002),_0x323467(_0x650efd,_0x2dc002),_0x25558e();}function _0x26880d(_0x26fe3c){const _0x27919d=_0x549949;if(_0x80fd3b)return;_0x80fd3b=!![],document[_0x27919d(0x383)](_0x27919d(0x862))[_0x27919d(0x119a)]['add'](_0x27919d(0x41c)),_0x4c3eff(_0x26fe3c);}function _0x11c2ba(){const _0x4f216b=_0x549949;_0x55d47a();if(!_0x80fd3b)return;_0x80fd3b=![],document[_0x4f216b(0x383)]('chat-interface-screen')[_0x4f216b(0x119a)][_0x4f216b(0x131d)](_0x4f216b(0x41c)),_0x4f051e['forEach'](_0x515d4d=>{const _0x3b485d=_0x4f216b,_0xd266a=document[_0x3b485d(0x89c)](_0x3b485d(0x1110)+_0x515d4d+'\x22]');if(_0xd266a)_0xd266a[_0x3b485d(0x119a)][_0x3b485d(0x131d)](_0x3b485d(0x35e));}),_0x4f051e['clear']();}function _0x4c3eff(_0x1fab4e){const _0x1d1f0d=_0x549949,_0x2f9572=document[_0x1d1f0d(0x89c)](_0x1d1f0d(0x1110)+_0x1fab4e+'\x22]');if(!_0x2f9572)return;_0x4f051e[_0x1d1f0d(0xcde)](_0x1fab4e)?(_0x4f051e[_0x1d1f0d(0x971)](_0x1fab4e),_0x2f9572[_0x1d1f0d(0x119a)]['remove'](_0x1d1f0d(0x35e))):(_0x4f051e[_0x1d1f0d(0xbff)](_0x1fab4e),_0x2f9572['classList'][_0x1d1f0d(0xbff)](_0x1d1f0d(0x35e))),document[_0x1d1f0d(0x383)](_0x1d1f0d(0x897))['textContent']=_0x1d1f0d(0x204)+_0x4f051e[_0x1d1f0d(0x1240)]+'\x20条',_0x4f051e[_0x1d1f0d(0x1240)]===0x0&&_0x11c2ba();}function _0x3e15d1(_0x13b1b0,_0x5ae2cc){const _0x47c697=_0x549949;let _0x274779;const _0x46cab=_0x12a5f3=>{const _0x256418=_0x42ed;if(_0x80fd3b)return;_0x12a5f3[_0x256418(0xe94)](),_0x274779=window[_0x256418(0xdb)](()=>_0x5ae2cc(_0x12a5f3),0x1f4);},_0xaf165f=()=>clearTimeout(_0x274779);_0x13b1b0[_0x47c697(0x271)](_0x47c697(0x413),_0x46cab),_0x13b1b0[_0x47c697(0x271)](_0x47c697(0x1338),_0xaf165f),_0x13b1b0[_0x47c697(0x271)](_0x47c697(0xb15),_0xaf165f),_0x13b1b0[_0x47c697(0x271)](_0x47c697(0xcb7),_0x46cab,{'passive':!![]}),_0x13b1b0['addEventListener'](_0x47c697(0x2e9),_0xaf165f),_0x13b1b0[_0x47c697(0x271)](_0x47c697(0x3a2),_0xaf165f);}async function _0x433617(){const _0x412e29=_0x549949,_0x1b253c=_0x41df36[_0x412e29(0xfc5)];if(!_0x1b253c)return;if(!_0x40e606['isActive']){_0x53c61f(_0x1b253c);return;}if(_0x40e606[_0x412e29(0xfc5)]===_0x1b253c)document['getElementById'](_0x412e29(0xdab))[_0x412e29(0x119a)][_0x412e29(0xbff)](_0x412e29(0x106d));else{const _0x1cc921=_0x41df36['chats'][_0x40e606['activeChatId']]?.[_0x412e29(0x461)]||'未知',_0x28ee08=_0x41df36[_0x412e29(0x864)][_0x1b253c]?.[_0x412e29(0x461)]||'当前',_0x378eb6=await _0x23a88b(_0x412e29(0xa9a),_0x412e29(0xec0)+_0x1cc921+_0x412e29(0xcd1)+_0x28ee08+_0x412e29(0xf2d),{'confirmButtonClass':_0x412e29(0x51b)});_0x378eb6&&(await _0x1e6479(!![]),await new Promise(_0x7e9b38=>setTimeout(_0x7e9b38,0x32)),_0x53c61f(_0x1b253c));}}async function _0x53c61f(_0x44832f){const _0x40f620=_0x549949,_0x29bde5=_0x41df36[_0x40f620(0x864)][_0x44832f];if(!_0x29bde5)return;_0x40e606['totalElapsedTime']=_0x29bde5[_0x40f620(0x47a)][_0x40f620(0x7aa)]||0x0,_0x40e606[_0x40f620(0x40d)]=!![],_0x40e606['activeChatId']=_0x44832f;_0x40e606[_0x40f620(0x91b)][_0x40f620(0xfde)]>0x0?_0x40e606[_0x40f620(0xb2c)]=0x0:_0x40e606[_0x40f620(0xb2c)]=-0x1;if(_0x40e606['timerId'])clearInterval(_0x40e606[_0x40f620(0xd6c)]);_0x40e606['timerId']=setInterval(()=>{const _0x9b4c97=_0x40f620;_0x40e606['isPlaying']&&(_0x40e606[_0x9b4c97(0x41e)]++,_0xb0926d());},0x3e8),_0x16763b(),_0x77e4e(),document[_0x40f620(0x383)](_0x40f620(0xdab))[_0x40f620(0x119a)][_0x40f620(0xbff)](_0x40f620(0x106d));}async function _0x1e6479(_0x3dd8e6=!![]){const _0x1b1de0=_0x549949;if(!_0x40e606[_0x1b1de0(0x40d)])return;const _0x3e4bbc=_0x40e606['activeChatId'];document[_0x1b1de0(0x383)](_0x1b1de0(0x61c))[_0x1b1de0(0x119a)][_0x1b1de0(0x131d)](_0x1b1de0(0x106d));const _0x1c1d97=async()=>{const _0x5ed5e1=_0x1b1de0;if(_0x40e606[_0x5ed5e1(0xd6c)])clearInterval(_0x40e606['timerId']);if(_0x40e606['isPlaying'])_0x17f24d[_0x5ed5e1(0xcb4)]();if(_0x3dd8e6&&_0x3e4bbc&&_0x41df36[_0x5ed5e1(0x864)][_0x3e4bbc]){const _0x4e9ce7=_0x41df36[_0x5ed5e1(0x864)][_0x3e4bbc];_0x4e9ce7[_0x5ed5e1(0x47a)]['totalTime']=_0x40e606[_0x5ed5e1(0x41e)],await _0x342df8[_0x5ed5e1(0x864)][_0x5ed5e1(0x9c0)](_0x4e9ce7);}_0x40e606[_0x5ed5e1(0x40d)]=![],_0x40e606[_0x5ed5e1(0xfc5)]=null,_0x40e606[_0x5ed5e1(0x41e)]=0x0,_0x40e606[_0x5ed5e1(0xd6c)]=null,_0x504891(_0x3e4bbc,!![]);};_0x345261(_0x1c1d97);}function _0x48f9c5(){_0x345261();}function _0x504891(_0x4242e3,_0x113b70=![]){const _0x373e8f=_0x549949,_0x3d930c=document[_0x373e8f(0x89c)](_0x373e8f(0x627));if(!_0x3d930c)return;if(_0x113b70||!_0x40e606['isActive']||_0x40e606['activeChatId']!==_0x4242e3){_0x3d930c[_0x373e8f(0xf6c)]=_0x373e8f(0x3e1),_0x3d930c['className']='';return;}_0x3d930c['src']=_0x373e8f(0x316),_0x3d930c[_0x373e8f(0x119a)]['add'](_0x373e8f(0x908));if(_0x40e606[_0x373e8f(0xea0)])_0x3d930c[_0x373e8f(0x119a)][_0x373e8f(0x131d)]('paused');else _0x3d930c[_0x373e8f(0x119a)][_0x373e8f(0xbff)](_0x373e8f(0x3b4));}window[_0x549949(0x10f6)]=_0x504891;function _0x16763b(){const _0x39e7c2=_0x549949;_0x504891(_0x40e606['activeChatId']),_0xb0926d();const _0x5d0b2e=document['getElementById'](_0x39e7c2(0xf31)),_0xaabe1=document[_0x39e7c2(0x383)](_0x39e7c2(0x1130)),_0x3e6fba=document[_0x39e7c2(0x383)](_0x39e7c2(0xe89));if(_0x40e606[_0x39e7c2(0xb2c)]>-0x1&&_0x40e606[_0x39e7c2(0x91b)][_0x39e7c2(0xfde)]>0x0){const _0x471cb8=_0x40e606[_0x39e7c2(0x91b)][_0x40e606['currentIndex']];_0x5d0b2e['textContent']=_0x471cb8[_0x39e7c2(0x461)],_0xaabe1[_0x39e7c2(0x138e)]=_0x471cb8[_0x39e7c2(0x5d8)];}else _0x5d0b2e[_0x39e7c2(0x138e)]=_0x39e7c2(0x363),_0xaabe1[_0x39e7c2(0x138e)]=_0x39e7c2(0x1026);_0x3e6fba[_0x39e7c2(0x138e)]=_0x40e606['isPlaying']?'❚❚':'▶';}function _0xb0926d(){const _0x574baa=_0x549949,_0x42bc4b=(_0x40e606['totalElapsedTime']/0xe10)[_0x574baa(0x70d)](0x1);document[_0x574baa(0x383)](_0x574baa(0x88b))[_0x574baa(0x138e)]=_0x574baa(0x767)+_0x42bc4b+'小时';}function _0x77e4e(){const _0x508009=_0x549949,_0x4ca3ce=document['getElementById'](_0x508009(0x59b));_0x4ca3ce[_0x508009(0x45c)]='';if(_0x40e606['playlist'][_0x508009(0xfde)]===0x0){_0x4ca3ce[_0x508009(0x45c)]=_0x508009(0xed2);return;}_0x40e606['playlist'][_0x508009(0x19c)]((_0x11b19e,_0x543c78)=>{const _0x4cc1ae=_0x508009,_0x26ea14=document[_0x4cc1ae(0xe1b)](_0x4cc1ae(0x7fd));_0x26ea14[_0x4cc1ae(0x556)]=_0x4cc1ae(0x9f8);if(_0x543c78===_0x40e606['currentIndex'])_0x26ea14['classList'][_0x4cc1ae(0xbff)]('playing');_0x26ea14['innerHTML']='\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x11b19e[_0x4cc1ae(0x461)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>'+_0x11b19e[_0x4cc1ae(0x5d8)]+_0x4cc1ae(0x7ad)+_0x543c78+'\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22'+_0x543c78+_0x4cc1ae(0x6c2)+_0x543c78+_0x4cc1ae(0x340)+_0x543c78+_0x4cc1ae(0x146),_0x26ea14[_0x4cc1ae(0x89c)](_0x4cc1ae(0xe56))[_0x4cc1ae(0x271)]('click',()=>_0x13cdf1(_0x543c78)),_0x4ca3ce['appendChild'](_0x26ea14);});}async function _0x3c21d5(){const _0x19fd42=_0x549949;if(_0x17f24d[_0x19fd42(0x3b4)]){if(_0x40e606['currentIndex']===-0x1&&_0x40e606[_0x19fd42(0x91b)][_0x19fd42(0xfde)]>0x0)_0x13cdf1(0x0);else _0x40e606[_0x19fd42(0xb2c)]>-0x1&&_0x13cdf1(_0x40e606[_0x19fd42(0xb2c)]);}else _0x17f24d[_0x19fd42(0xcb4)](),await _0x32091a(_0x19fd42(0x13a6));}function _0x418bb0(){const _0x56a85c=_0x549949;if(_0x40e606[_0x56a85c(0x91b)][_0x56a85c(0xfde)]===0x0)return;let _0x2d0c49;switch(_0x40e606[_0x56a85c(0x681)]){case _0x56a85c(0x5ce):_0x2d0c49=Math['floor'](Math[_0x56a85c(0x5ce)]()*_0x40e606[_0x56a85c(0x91b)][_0x56a85c(0xfde)]);break;case _0x56a85c(0x8a3):_0x13cdf1(_0x40e606[_0x56a85c(0xb2c)]);return;case _0x56a85c(0xe40):default:_0x2d0c49=(_0x40e606[_0x56a85c(0xb2c)]+0x1)%_0x40e606[_0x56a85c(0x91b)][_0x56a85c(0xfde)];break;}_0x13cdf1(_0x2d0c49);}function _0x2ea854(){const _0x56c236=_0x549949;if(_0x40e606[_0x56c236(0x91b)]['length']===0x0)return;const _0x1c028d=(_0x40e606['currentIndex']-0x1+_0x40e606[_0x56c236(0x91b)][_0x56c236(0xfde)])%_0x40e606[_0x56c236(0x91b)][_0x56c236(0xfde)];_0x13cdf1(_0x1c028d);}function _0x3c3671(){const _0xa17405=_0x549949,_0x591f0d=[_0xa17405(0xe40),_0xa17405(0x5ce),_0xa17405(0x8a3)],_0x1e1acd=_0x591f0d[_0xa17405(0x1105)](_0x40e606[_0xa17405(0x681)]);_0x40e606['playMode']=_0x591f0d[(_0x1e1acd+0x1)%_0x591f0d['length']],document[_0xa17405(0x383)]('music-mode-btn')['textContent']={'order':'顺序','random':'随机','single':'单曲'}[_0x40e606[_0xa17405(0x681)]];}async function _0x1fd69a(){const _0x4af905=_0x549949,_0x3c73f9=await _0x12e332(_0x4af905(0x396),'请输入歌曲的URL','',_0x4af905(0x2fa));if(!_0x3c73f9)return;const _0x24714d=await _0x12e332(_0x4af905(0xebd),'请输入歌名');if(!_0x24714d)return;const _0x3b7511=await _0x12e332(_0x4af905(0xebd),_0x4af905(0x4e5));if(!_0x3b7511)return;_0x40e606[_0x4af905(0x91b)][_0x4af905(0x258)]({'name':_0x24714d,'artist':_0x3b7511,'src':_0x3c73f9,'isLocal':![]}),await _0x534851(),_0x77e4e(),_0x40e606['currentIndex']===-0x1&&(_0x40e606['currentIndex']=_0x40e606[_0x4af905(0x91b)]['length']-0x1,_0x16763b());}async function _0x4120c5(_0x59bb02){const _0x658f0=_0x549949,_0x26d1d3=_0x59bb02[_0x658f0(0xfab)][_0x658f0(0x1185)];if(!_0x26d1d3[_0x658f0(0xfde)])return;for(const _0x21ccfb of _0x26d1d3){let _0x55bb83=_0x21ccfb[_0x658f0(0x461)]['replace'](/\.[^/.]+$/,'');_0x55bb83=await _0x12e332('歌曲信息',_0x658f0(0x2fc),_0x55bb83);if(_0x55bb83===null)continue;const _0x18c064=await _0x12e332(_0x658f0(0xebd),_0x658f0(0x4e5),_0x658f0(0xfac));if(_0x18c064===null)continue;const _0x32ffb0=await _0x21ccfb['arrayBuffer']();let _0x42915e='';const _0xea78d7=await _0x23a88b(_0x658f0(0xae6),_0x658f0(0xb0c)+_0x55bb83+_0x658f0(0xd64));_0xea78d7&&(_0x42915e=await _0x27633a()||''),_0x40e606[_0x658f0(0x91b)]['push']({'name':_0x55bb83,'artist':_0x18c064,'src':_0x32ffb0,'fileType':_0x21ccfb['type'],'isLocal':!![],'lrcContent':_0x42915e,'cover':_0x658f0(0x8ce)});}await _0x534851(),_0x77e4e(),_0x40e606[_0x658f0(0xb2c)]===-0x1&&_0x40e606[_0x658f0(0x91b)][_0x658f0(0xfde)]>0x0&&(_0x40e606['currentIndex']=0x0,_0x16763b()),_0x59bb02[_0x658f0(0xfab)][_0x658f0(0x1be)]=null;}async function _0x13cdf1(_0x4694df){const _0x272e42=_0x549949;if(_0x4694df<0x0||_0x4694df>=_0x40e606['playlist'][_0x272e42(0xfde)])return;_0x17f24d[_0x272e42(0xcb4)](),_0x40e606[_0x272e42(0xb2c)]=_0x4694df;const _0x180748=_0x40e606[_0x272e42(0x91b)][_0x4694df],_0x25964d=_0x41df36['chats'][_0x40e606[_0x272e42(0xfc5)]],_0x2a4003=document['getElementById'](_0x272e42(0x568));if(_0x25964d&&_0x2a4003){_0x2a4003[_0x272e42(0x45c)]='';const _0x3ead9f=_0x25964d['isGroup']?_0x25964d[_0x272e42(0x12a6)][_0x272e42(0xd12)](_0x38a5ed=>_0x38a5ed['originalName']===_0x180748[_0x272e42(0x5d8)])?.[_0x272e42(0xb47)]||_0x5dc108:_0x25964d[_0x272e42(0x886)][_0x272e42(0x121e)]||_0x5dc108,_0x526460=_0x25964d[_0x272e42(0x886)]['myAvatar']||_0x5dc108,_0x94eefe=document[_0x272e42(0xe1b)]('img');_0x94eefe['src']=_0x3ead9f,_0x94eefe['className']=_0x272e42(0x3d4),_0x94eefe['alt']=_0x272e42(0x7e4),_0x2a4003[_0x272e42(0xe91)](_0x94eefe);const _0x383c58=document[_0x272e42(0xe1b)](_0x272e42(0x497));_0x383c58[_0x272e42(0xf6c)]=_0x526460,_0x383c58[_0x272e42(0x556)]='participant-display-avatar',_0x383c58['alt']=_0x272e42(0xbe6),_0x2a4003[_0x272e42(0xe91)](_0x383c58);}const _0x6be796=document[_0x272e42(0x89c)]('.music-player-window'),_0x2e42f0=document['getElementById'](_0x272e42(0xd5c));_0x6be796&&(_0x6be796['style'][_0x272e42(0x1206)]('--music-bg-image',_0x180748['background']?'url('+_0x180748[_0x272e42(0x415)]+')':_0x272e42(0xa70)),_0x6be796[_0x272e42(0x119a)][_0x272e42(0x8f0)]('bg-clear',!!_0x180748[_0x272e42(0x11ca)]));_0x2e42f0&&_0x2e42f0[_0x272e42(0x119a)]['toggle']('active',!!_0x180748[_0x272e42(0x11ca)]);document[_0x272e42(0x383)](_0x272e42(0x282))[_0x272e42(0x119a)][_0x272e42(0x131d)](_0x272e42(0x5dc));const _0x2c65ee=document[_0x272e42(0x383)]('music-player-cover');_0x2c65ee&&(_0x2c65ee['src']=_0x180748[_0x272e42(0x1b2)]||_0x272e42(0x8ce));await _0x32091a(_0x272e42(0xdc5)+_0x180748['name']+'》'),_0x40e606[_0x272e42(0x6ed)]=_0x2a7b2e(_0x180748[_0x272e42(0x1065)]||''),_0x234ea1();const _0x1fb830=document[_0x272e42(0x383)](_0x272e42(0x1005));_0x1fb830&&(!_0x40e606['parsedLyrics']||_0x40e606[_0x272e42(0x6ed)][_0x272e42(0xfde)]===0x0?_0x1fb830[_0x272e42(0x138e)]=_0x272e42(0x9d4):_0x1fb830[_0x272e42(0x138e)]=_0x272e42(0xafd));if(_0x180748[_0x272e42(0x63e)]&&_0x180748[_0x272e42(0xf6c)]instanceof ArrayBuffer){const _0x25f289=new Blob([_0x180748[_0x272e42(0xf6c)]],{'type':_0x180748['fileType']||_0x272e42(0xdca)});_0x17f24d[_0x272e42(0xf6c)]=URL[_0x272e42(0x679)](_0x25f289);}else{if(_0x180748['isLocal']&&_0x180748['src']instanceof Blob)_0x17f24d[_0x272e42(0xf6c)]=URL['createObjectURL'](_0x180748[_0x272e42(0xf6c)]);else{if(!_0x180748[_0x272e42(0x63e)])_0x17f24d['src']=_0x180748[_0x272e42(0xf6c)];else{console[_0x272e42(0x98)](_0x272e42(0x9e4),_0x180748);return;}}}const _0x4a9a4b=_0x17f24d[_0x272e42(0x554)]();_0x4a9a4b!==undefined&&_0x4a9a4b[_0x272e42(0xa27)](_0x55abc1=>{const _0x2c7c0f=_0x272e42;if(_0x55abc1[_0x2c7c0f(0x461)]===_0x2c7c0f(0x589))console['warn']('Autoplay\x20was\x20prevented\x20by\x20the\x20browser.'),_0x17f24d[_0x2c7c0f(0xcb4)](),_0x296ef9(_0x2c7c0f(0x527),_0x2c7c0f(0x11a5));else _0x55abc1[_0x2c7c0f(0x461)]!==_0x2c7c0f(0x8ba)&&console[_0x2c7c0f(0x98)](_0x2c7c0f(0xfe0),_0x55abc1);});_0x77e4e(),_0x16763b(),_0x5ce764();const _0x5d6a5d=document[_0x272e42(0x383)](_0x272e42(0x61c));_0x40e606[_0x272e42(0x6ed)]&&_0x40e606[_0x272e42(0x6ed)][_0x272e42(0xfde)]>0x0?(_0x5d6a5d[_0x272e42(0x138e)]='♪',_0x5d6a5d['classList'][_0x272e42(0xbff)]('visible')):_0x5d6a5d[_0x272e42(0x119a)][_0x272e42(0x131d)]('visible');}async function _0x2849ce(_0x59d17c){const _0x4c08ec=_0x549949;if(_0x59d17c<0x0||_0x59d17c>=_0x40e606[_0x4c08ec(0x91b)][_0x4c08ec(0xfde)])return;const _0x4ba66b=await _0x2d60a4(_0x4c08ec(0x12df),[{'text':_0x4c08ec(0x107c),'value':_0x4c08ec(0x30b)},{'text':_0x4c08ec(0xc61),'value':'url'}]);let _0x166877=null;if(_0x4ba66b===_0x4c08ec(0x30b))_0x166877=await _0x20227a();else _0x4ba66b===_0x4c08ec(0x2fa)&&(_0x166877=await _0x12e332(_0x4c08ec(0x1196),_0x4c08ec(0x1262),'',_0x4c08ec(0x2fa)));if(_0x166877&&_0x166877[_0x4c08ec(0x1cb)]()){_0x40e606[_0x4c08ec(0x91b)][_0x59d17c][_0x4c08ec(0x415)]=_0x166877[_0x4c08ec(0x1cb)](),await _0x534851();if(_0x40e606[_0x4c08ec(0xb2c)]===_0x59d17c){const _0x39de82=document[_0x4c08ec(0x89c)](_0x4c08ec(0xc37));_0x39de82[_0x4c08ec(0x655)][_0x4c08ec(0x1206)](_0x4c08ec(0x798),'url('+_0x166877['trim']()+')');}await _0x296ef9('成功',_0x4c08ec(0x771));}}async function _0x5416aa(_0x5e70cd){const _0x4b1b5a=_0x549949;if(_0x5e70cd<0x0||_0x5e70cd>=_0x40e606[_0x4b1b5a(0x91b)][_0x4b1b5a(0xfde)])return;const _0x21e36b=await _0x2d60a4('更换专辑封面',[{'text':_0x4b1b5a(0x107c),'value':_0x4b1b5a(0x30b)},{'text':_0x4b1b5a(0xc61),'value':_0x4b1b5a(0x2fa)}]);let _0x948792=null;if(_0x21e36b===_0x4b1b5a(0x30b))_0x948792=await _0x20227a();else _0x21e36b===_0x4b1b5a(0x2fa)&&(_0x948792=await _0x12e332('输入图片URL',_0x4b1b5a(0x125e),'',_0x4b1b5a(0x2fa)));if(_0x948792&&_0x948792[_0x4b1b5a(0x1cb)]()){_0x40e606['playlist'][_0x5e70cd][_0x4b1b5a(0x1b2)]=_0x948792[_0x4b1b5a(0x1cb)](),await _0x534851();if(_0x40e606[_0x4b1b5a(0xb2c)]===_0x5e70cd){document[_0x4b1b5a(0x383)](_0x4b1b5a(0xdf5))[_0x4b1b5a(0xf6c)]=_0x948792[_0x4b1b5a(0x1cb)]();const _0x1c632f=document['querySelector'](_0x4b1b5a(0xd10));if(_0x1c632f)_0x1c632f[_0x4b1b5a(0xf6c)]=_0x948792['trim']();}await _0x296ef9('成功',_0x4b1b5a(0x28b));}}async function _0xf87ae5(_0x2ff662){const _0x5bb1dd=_0x549949;if(_0x2ff662<0x0||_0x2ff662>=_0x40e606['playlist'][_0x5bb1dd(0xfde)])return;const _0x4b44d1=_0x40e606[_0x5bb1dd(0x91b)][_0x2ff662],_0x1104a8=_0x40e606[_0x5bb1dd(0xea0)]&&_0x40e606['currentIndex']===_0x2ff662;if(_0x4b44d1[_0x5bb1dd(0x63e)]&&_0x17f24d[_0x5bb1dd(0xf6c)][_0x5bb1dd(0x1122)]('blob:')&&_0x40e606[_0x5bb1dd(0xb2c)]===_0x2ff662)URL['revokeObjectURL'](_0x17f24d[_0x5bb1dd(0xf6c)]);_0x40e606[_0x5bb1dd(0x91b)][_0x5bb1dd(0x2f1)](_0x2ff662,0x1),await _0x534851();if(_0x40e606[_0x5bb1dd(0x91b)]['length']===0x0){if(_0x40e606['isPlaying'])_0x17f24d[_0x5bb1dd(0xcb4)]();_0x17f24d[_0x5bb1dd(0xf6c)]='',_0x40e606['currentIndex']=-0x1,_0x40e606[_0x5bb1dd(0xea0)]=![];}else{if(_0x1104a8)_0x418bb0();else{if(_0x40e606[_0x5bb1dd(0xb2c)]>=_0x2ff662)_0x40e606[_0x5bb1dd(0xb2c)]=Math[_0x5bb1dd(0xaf3)](0x0,_0x40e606['currentIndex']-0x1);}}_0x16763b(),_0x77e4e();}async function _0x4120c5(_0x4f0960){const _0x3fcc0c=_0x549949,_0x15cf90=_0x4f0960[_0x3fcc0c(0xfab)]['files'];if(!_0x15cf90[_0x3fcc0c(0xfde)])return;for(const _0x1a87a0 of _0x15cf90){let _0xaa51be=_0x1a87a0[_0x3fcc0c(0x461)][_0x3fcc0c(0x709)](/\.[^/.]+$/,'');_0xaa51be=await _0x12e332('歌曲信息','请输入歌名',_0xaa51be);if(_0xaa51be===null)continue;const _0x5ca083=await _0x12e332(_0x3fcc0c(0xebd),_0x3fcc0c(0x4e5),_0x3fcc0c(0xfac));if(_0x5ca083===null)continue;let _0x34459e='';const _0x32d2c4=await _0x23a88b(_0x3fcc0c(0xae6),_0x3fcc0c(0xb0c)+_0xaa51be+'》添加歌词吗？');_0x32d2c4&&(_0x34459e=await _0x27633a()||''),_0x40e606[_0x3fcc0c(0x91b)][_0x3fcc0c(0x258)]({'name':_0xaa51be,'artist':_0x5ca083,'src':_0x1a87a0,'isLocal':!![],'lrcContent':_0x34459e});}await _0x534851(),_0x77e4e(),_0x40e606[_0x3fcc0c(0xb2c)]===-0x1&&_0x40e606['playlist']['length']>0x0&&(_0x40e606['currentIndex']=0x0,_0x16763b()),_0x4f0960[_0x3fcc0c(0xfab)][_0x3fcc0c(0x1be)]=null;}async function _0xf87ae5(_0x4f3521){const _0x228ffb=_0x549949;if(_0x4f3521<0x0||_0x4f3521>=_0x40e606[_0x228ffb(0x91b)][_0x228ffb(0xfde)])return;const _0x2e16fe=_0x40e606[_0x228ffb(0x91b)][_0x4f3521],_0x29c41e=_0x40e606[_0x228ffb(0xea0)]&&_0x40e606[_0x228ffb(0xb2c)]===_0x4f3521;if(_0x2e16fe[_0x228ffb(0x63e)]&&_0x17f24d['src']['startsWith']('blob:')&&_0x40e606['currentIndex']===_0x4f3521)URL['revokeObjectURL'](_0x17f24d[_0x228ffb(0xf6c)]);_0x40e606['playlist']['splice'](_0x4f3521,0x1),await _0x534851();if(_0x40e606[_0x228ffb(0x91b)][_0x228ffb(0xfde)]===0x0){if(_0x40e606[_0x228ffb(0xea0)])_0x17f24d[_0x228ffb(0xcb4)]();_0x17f24d[_0x228ffb(0xf6c)]='',_0x40e606[_0x228ffb(0xb2c)]=-0x1,_0x40e606['isPlaying']=![];}else{if(_0x29c41e)_0x418bb0();else{if(_0x40e606[_0x228ffb(0xb2c)]>=_0x4f3521)_0x40e606[_0x228ffb(0xb2c)]=Math['max'](0x0,_0x40e606['currentIndex']-0x1);}}_0x16763b(),_0x77e4e();}const _0x501c6a=document['getElementById'](_0x549949(0x600)),_0x491475=document[_0x549949(0x383)]('persona-editor-modal'),_0x1e5612=document['getElementById'](_0x549949(0x2b8));function _0x26abbe(){const _0x5e8673=_0x549949;_0x4e55c5(),_0x501c6a[_0x5e8673(0x119a)][_0x5e8673(0xbff)]('visible');}function _0x5124ef(){const _0xfd69d7=_0x549949;_0x501c6a[_0xfd69d7(0x119a)][_0xfd69d7(0x131d)](_0xfd69d7(0x106d));}function _0x4e55c5(){const _0x1b3948=_0x549949,_0x246d39=document[_0x1b3948(0x383)]('persona-library-grid');_0x246d39[_0x1b3948(0x45c)]='';if(_0x41df36[_0x1b3948(0x10e5)]['length']===0x0){_0x246d39[_0x1b3948(0x45c)]=_0x1b3948(0x3e0);return;}_0x41df36[_0x1b3948(0x10e5)][_0x1b3948(0x19c)](_0x404a7e=>{const _0x1ec098=_0x1b3948,_0x485f0a=document[_0x1ec098(0xe1b)](_0x1ec098(0x7fd));_0x485f0a[_0x1ec098(0x556)]='persona-preset-item',_0x485f0a[_0x1ec098(0x655)][_0x1ec098(0x880)]=_0x1ec098(0xb9a)+_0x404a7e[_0x1ec098(0xb47)]+')',_0x485f0a[_0x1ec098(0x118)][_0x1ec098(0x127c)]=_0x404a7e['id'],_0x485f0a[_0x1ec098(0x271)]('click',()=>_0x4d7939(_0x404a7e['id'])),_0x3e15d1(_0x485f0a,()=>_0x52bcc4(_0x404a7e['id'])),_0x246d39[_0x1ec098(0xe91)](_0x485f0a);});}function _0x52bcc4(_0x2e5ac9){const _0x212a47=_0x549949;_0x401ae0=_0x2e5ac9,_0x1e5612[_0x212a47(0x119a)][_0x212a47(0xbff)](_0x212a47(0x106d));}function _0x73ca96(){const _0xcae09c=_0x549949;_0x1e5612[_0xcae09c(0x119a)][_0xcae09c(0x131d)](_0xcae09c(0x106d)),_0x401ae0=null;}function _0x4d7939(_0x596e6f){const _0x3354e4=_0x549949,_0x1b9ae6=_0x41df36[_0x3354e4(0x10e5)]['find'](_0x2ac3f7=>_0x2ac3f7['id']===_0x596e6f);_0x1b9ae6&&(document['getElementById']('my-avatar-preview')[_0x3354e4(0xf6c)]=_0x1b9ae6[_0x3354e4(0xb47)],document[_0x3354e4(0x383)](_0x3354e4(0x41b))['value']=_0x1b9ae6[_0x3354e4(0x48c)]),_0x5124ef();}function _0x1c8e8a(){const _0x5c3bab=_0x549949;_0x401ae0=null,document['getElementById']('persona-editor-title')['textContent']='添加人设预设',document[_0x5c3bab(0x383)](_0x5c3bab(0xd7c))['src']=_0x5dc108,document[_0x5c3bab(0x383)](_0x5c3bab(0x30a))[_0x5c3bab(0x1be)]='',_0x491475[_0x5c3bab(0x119a)][_0x5c3bab(0xbff)](_0x5c3bab(0x106d));}function _0x242787(){const _0x5ac447=_0x549949,_0x48ae3a=_0x41df36[_0x5ac447(0x10e5)][_0x5ac447(0xd12)](_0x38677a=>_0x38677a['id']===_0x401ae0);if(!_0x48ae3a)return;document['getElementById'](_0x5ac447(0x50c))[_0x5ac447(0x138e)]=_0x5ac447(0x1257),document[_0x5ac447(0x383)](_0x5ac447(0xd7c))[_0x5ac447(0xf6c)]=_0x48ae3a[_0x5ac447(0xb47)],document[_0x5ac447(0x383)]('preset-persona-input')[_0x5ac447(0x1be)]=_0x48ae3a[_0x5ac447(0x48c)],_0x1e5612[_0x5ac447(0x119a)][_0x5ac447(0x131d)](_0x5ac447(0x106d)),_0x491475['classList'][_0x5ac447(0xbff)]('visible');}async function _0x1a8286(){const _0x409318=_0x549949,_0x221a10=await _0x23a88b(_0x409318(0xaa2),'确定要删除这个人设预设吗？此操作不可恢复。',{'confirmButtonClass':'btn-danger'});_0x221a10&&_0x401ae0&&(await _0x342df8['personaPresets'][_0x409318(0x971)](_0x401ae0),_0x41df36[_0x409318(0x10e5)]=_0x41df36['personaPresets']['filter'](_0x88bfb1=>_0x88bfb1['id']!==_0x401ae0),_0x73ca96(),_0x4e55c5());}function _0x4ddb88(){const _0x5dcc54=_0x549949;_0x491475[_0x5dcc54(0x119a)][_0x5dcc54(0x131d)](_0x5dcc54(0x106d)),_0x401ae0=null;}async function _0x3e1bff(){const _0x5ea2cb=_0x549949,_0x131311=document['getElementById'](_0x5ea2cb(0xd7c))[_0x5ea2cb(0xf6c)],_0xaabdfe=document[_0x5ea2cb(0x383)](_0x5ea2cb(0x30a))['value'][_0x5ea2cb(0x1cb)]();if(_0x131311===_0x5dc108&&!_0xaabdfe){alert(_0x5ea2cb(0x88a));return;}if(_0x401ae0){const _0x2ff6b5=_0x41df36[_0x5ea2cb(0x10e5)][_0x5ea2cb(0xd12)](_0x2b53a9=>_0x2b53a9['id']===_0x401ae0);_0x2ff6b5&&(_0x2ff6b5[_0x5ea2cb(0xb47)]=_0x131311,_0x2ff6b5['persona']=_0xaabdfe,await _0x342df8[_0x5ea2cb(0x10e5)]['put'](_0x2ff6b5));}else{const _0x135885={'id':_0x5ea2cb(0x8f4)+Date[_0x5ea2cb(0x108d)](),'avatar':_0x131311,'persona':_0xaabdfe};await _0x342df8[_0x5ea2cb(0x10e5)][_0x5ea2cb(0xbff)](_0x135885),_0x41df36[_0x5ea2cb(0x10e5)]['push'](_0x135885);}_0x4e55c5(),_0x4ddb88();}const _0x4ef449=document[_0x549949(0x383)](_0x549949(0x11b));function _0x2ff779(_0x527306,_0xac3743){const _0x3caca1=_0x549949;clearTimeout(_0x3c6bf2),document[_0x3caca1(0x383)](_0x3caca1(0x12eb))[_0x3caca1(0xf6c)]=_0x527306,document[_0x3caca1(0x383)](_0x3caca1(0x506))['textContent']=_0xac3743,_0x4ef449[_0x3caca1(0x119a)][_0x3caca1(0xbff)](_0x3caca1(0x106d));const _0x2b5008=()=>{const _0x1ba10e=_0x3caca1;_0x4ef449[_0x1ba10e(0x119a)][_0x1ba10e(0x131d)](_0x1ba10e(0x106d)),_0x4ef449[_0x1ba10e(0xb04)](_0x1ba10e(0x5c7),_0x2b5008);};_0x4ef449[_0x3caca1(0x271)](_0x3caca1(0x5c7),_0x2b5008),_0x3c6bf2=setTimeout(_0x2b5008,0x7d0);}function _0x24c8ea(_0x32a1ef){const _0x5be88c=_0x549949,_0x2d702e=document[_0x5be88c(0x383)]('status-bar-battery'),_0x2d7e85=_0x2d702e[_0x5be88c(0x89c)](_0x5be88c(0x11e9)),_0x5836bb=_0x2d702e['querySelector']('.battery-text'),_0x40eca2=Math[_0x5be88c(0xdee)](_0x32a1ef[_0x5be88c(0x4ab)]*0x64);_0x2d7e85['style'][_0x5be88c(0xabd)]=_0x40eca2+'%',_0x5836bb[_0x5be88c(0x138e)]=_0x40eca2+'%',_0x32a1ef[_0x5be88c(0x8af)]?_0x2d702e['classList'][_0x5be88c(0xbff)](_0x5be88c(0x8af)):_0x2d702e[_0x5be88c(0x119a)]['remove']('charging');}function _0x2e16af(_0x3445e3){const _0x1fd85d=_0x549949;_0x24c8ea(_0x3445e3);const _0x25fe8a=_0x3445e3[_0x1fd85d(0x4ab)];!_0x3445e3[_0x1fd85d(0x8af)]&&(_0x25fe8a<=0.4&&_0x1f189a>0.4&&!_0x4c2e9e[_0x1fd85d(0x22c)]&&(_0x2ff779('https://i.postimg.cc/T2yKJ0DV/40.jpg','有点饿了，可以去找充电器惹'),_0x4c2e9e[_0x1fd85d(0x22c)]=!![]),_0x25fe8a<=0.2&&_0x1f189a>0.2&&!_0x4c2e9e[_0x1fd85d(0x920)]&&(_0x2ff779('https://i.postimg.cc/qB9zbKs9/20.jpg',_0x1fd85d(0x7ab)),_0x4c2e9e[_0x1fd85d(0x920)]=!![]),_0x25fe8a<=0.1&&_0x1f189a>0.1&&!_0x4c2e9e[_0x1fd85d(0xb20)]&&(_0x2ff779(_0x1fd85d(0x1079),_0x1fd85d(0xcee)),_0x4c2e9e[_0x1fd85d(0xb20)]=!![]));if(_0x25fe8a>0.4)_0x4c2e9e[_0x1fd85d(0x22c)]=![];if(_0x25fe8a>0.2)_0x4c2e9e[_0x1fd85d(0x920)]=![];if(_0x25fe8a>0.1)_0x4c2e9e[_0x1fd85d(0xb20)]=![];_0x1f189a=_0x25fe8a;}async function _0x479a40(){const _0x4999d4=_0x549949;if(_0x4999d4(0x7f6)in navigator)try{const _0x13911c=await navigator[_0x4999d4(0x7f6)]();_0x1f189a=_0x13911c[_0x4999d4(0x4ab)],_0x2e16af(_0x13911c),_0x13911c[_0x4999d4(0x271)](_0x4999d4(0x356),()=>_0x2e16af(_0x13911c)),_0x13911c['addEventListener'](_0x4999d4(0x10dc),()=>{const _0x4fe12d=_0x4999d4;_0x2e16af(_0x13911c),_0x13911c[_0x4fe12d(0x8af)]&&_0x2ff779('https://i.postimg.cc/3NDQ0dWG/image.jpg',_0x4fe12d(0x7f5));});}catch(_0x49a7f3){console[_0x4999d4(0x98)](_0x4999d4(0x136d),_0x49a7f3),document[_0x4999d4(0x89c)](_0x4999d4(0x6a1))['textContent']=_0x4999d4(0xd06);}else console[_0x4999d4(0xe72)](_0x4999d4(0xa56)),document[_0x4999d4(0x89c)](_0x4999d4(0x6a1))['textContent']=_0x4999d4(0xd06);}async function _0x516f71(){const _0x2dc2ba=_0x549949,_0x4098fa=document['getElementById'](_0x2dc2ba(0xac6));if(!_0x4098fa)return;const _0xaa2af5=await _0x342df8[_0x2dc2ba(0xb86)][_0x2dc2ba(0x4b1)](_0x2dc2ba(0x374))['reverse']()[_0x2dc2ba(0x21f)]();_0x4098fa[_0x2dc2ba(0x45c)]='';if(_0xaa2af5['length']===0x0){_0x4098fa[_0x2dc2ba(0x45c)]=_0x2dc2ba(0x381);return;}_0xaa2af5[_0x2dc2ba(0x19c)](_0x11ffa5=>{const _0x109da4=_0x2dc2ba,_0xa7a23e=document[_0x109da4(0xe1b)](_0x109da4(0x7fd));_0xa7a23e[_0x109da4(0x556)]=_0x109da4(0x1104),_0xa7a23e[_0x109da4(0x45c)]=_0x109da4(0xe7f)+_0x11ffa5[_0x109da4(0xd93)]+_0x109da4(0x128d)+_0x11ffa5[_0x109da4(0x461)]+_0x109da4(0x770)+(_0x11ffa5[_0x109da4(0xa97)]||0x0)+_0x109da4(0xb65),_0xa7a23e[_0x109da4(0x271)]('click',()=>{_0x292f3b(_0x11ffa5['id']);}),_0x3e15d1(_0xa7a23e,async()=>{const _0x4ec39b=_0x109da4,_0x35b9a8=await _0x23a88b(_0x4ec39b(0x11e5),'确定要删除相册《'+_0x11ffa5[_0x4ec39b(0x461)]+_0x4ec39b(0xe8d),{'confirmButtonClass':_0x4ec39b(0x51b)});_0x35b9a8&&(await _0x342df8['qzonePhotos'][_0x4ec39b(0x6bd)](_0x4ec39b(0x11c8))[_0x4ec39b(0x5b3)](_0x11ffa5['id'])[_0x4ec39b(0x971)](),await _0x342df8['qzoneAlbums'][_0x4ec39b(0x971)](_0x11ffa5['id']),await _0x516f71(),alert(_0x4ec39b(0x978)));}),_0x4098fa[_0x109da4(0xe91)](_0xa7a23e);});}async function _0x292f3b(_0x283730){const _0x2fe866=_0x549949;_0x41df36[_0x2fe866(0xf24)]=_0x283730,await _0x34db5b(),_0x105acd('album-photos-screen');}async function _0x34db5b(){const _0x590b40=_0x549949;if(!_0x41df36[_0x590b40(0xf24)])return;const _0x2c2689=document[_0x590b40(0x383)](_0x590b40(0x868)),_0x372ed9=document[_0x590b40(0x383)](_0x590b40(0xc3b)),_0x24ac82=await _0x342df8[_0x590b40(0xb86)]['get'](_0x41df36['activeAlbumId']);if(!_0x24ac82){console['error'](_0x590b40(0x34e),_0x41df36[_0x590b40(0xf24)]),_0x105acd(_0x590b40(0x112d));return;}_0x372ed9[_0x590b40(0x138e)]=_0x24ac82[_0x590b40(0x461)];const _0x3bcf44=await _0x342df8[_0x590b40(0x1218)][_0x590b40(0x6bd)](_0x590b40(0x11c8))[_0x590b40(0x5b3)](_0x41df36[_0x590b40(0xf24)])[_0x590b40(0x21f)]();_0x2c2689[_0x590b40(0x45c)]='',_0x3bcf44[_0x590b40(0xfde)]===0x0?_0x2c2689[_0x590b40(0x45c)]=_0x590b40(0x921):_0x3bcf44[_0x590b40(0x19c)](_0x2eaee2=>{const _0x3e0499=_0x590b40,_0x40be56=document[_0x3e0499(0xe1b)](_0x3e0499(0x7fd));_0x40be56[_0x3e0499(0x556)]=_0x3e0499(0x75a),_0x40be56[_0x3e0499(0x45c)]=_0x3e0499(0x341)+_0x2eaee2['url']+'\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22'+_0x2eaee2['id']+_0x3e0499(0xd59),_0x2c2689['appendChild'](_0x40be56);});}async function _0x149c8c(_0x1dc276){const _0x35b2ea=_0x549949;if(!_0x41df36[_0x35b2ea(0xf24)])return;const _0x5586de=await _0x342df8['qzonePhotos'][_0x35b2ea(0x6bd)](_0x35b2ea(0x11c8))['equals'](_0x41df36[_0x35b2ea(0xf24)])[_0x35b2ea(0x21f)]();_0x4b0146[_0x35b2ea(0x861)]=_0x5586de[_0x35b2ea(0xa79)](_0x562da4=>_0x562da4[_0x35b2ea(0x2fa)]),_0x4b0146['currentIndex']=_0x4b0146[_0x35b2ea(0x861)]['findIndex'](_0x24e68e=>_0x24e68e===_0x1dc276);if(_0x4b0146[_0x35b2ea(0xb2c)]===-0x1)return;document[_0x35b2ea(0x383)](_0x35b2ea(0x71a))[_0x35b2ea(0x119a)][_0x35b2ea(0xbff)](_0x35b2ea(0x106d)),_0x2a4f1e(),_0x4b0146['isOpen']=!![];}function _0x2a4f1e(){const _0x2f55d7=_0x549949;if(_0x4b0146['currentIndex']===-0x1)return;const _0x272c6f=document[_0x2f55d7(0x383)](_0x2f55d7(0x2c0)),_0x3ad94=document[_0x2f55d7(0x383)](_0x2f55d7(0x827)),_0x19766c=document[_0x2f55d7(0x383)](_0x2f55d7(0x1ef));_0x272c6f[_0x2f55d7(0x655)]['opacity']=0x0,setTimeout(()=>{const _0x414650=_0x2f55d7;_0x272c6f['src']=_0x4b0146[_0x414650(0x861)][_0x4b0146['currentIndex']],_0x272c6f[_0x414650(0x655)][_0x414650(0x10ec)]=0x1;},0x64),_0x3ad94[_0x2f55d7(0x29b)]=_0x4b0146[_0x2f55d7(0xb2c)]===0x0,_0x19766c[_0x2f55d7(0x29b)]=_0x4b0146['currentIndex']===_0x4b0146[_0x2f55d7(0x861)]['length']-0x1;}function _0x5ad994(){const _0x2fe83d=_0x549949;_0x4b0146[_0x2fe83d(0xb2c)]<_0x4b0146['photos']['length']-0x1&&(_0x4b0146[_0x2fe83d(0xb2c)]++,_0x2a4f1e());}function _0x13d244(){const _0x39c32f=_0x549949;_0x4b0146['currentIndex']>0x0&&(_0x4b0146[_0x39c32f(0xb2c)]--,_0x2a4f1e());}function _0x1a0c88(){const _0x1cd5f1=_0x549949;document[_0x1cd5f1(0x383)](_0x1cd5f1(0x71a))['classList']['remove']('visible'),_0x4b0146['isOpen']=![],_0x4b0146[_0x1cd5f1(0x861)]=[],_0x4b0146[_0x1cd5f1(0xb2c)]=-0x1,document[_0x1cd5f1(0x383)](_0x1cd5f1(0x2c0))['src']='';}function _0x4c6ee1(_0x2d5fc4){const _0xe34f8=_0x549949;_0x3a006f=_0x2d5fc4,localStorage['setItem']('unreadPostsCount',_0x2d5fc4);const _0x3407fd=document['querySelector'](_0xe34f8(0x524)),_0x572422=_0x3407fd[_0xe34f8(0x89c)](_0xe34f8(0xc0e));let _0x1de494=_0x3407fd[_0xe34f8(0x89c)](_0xe34f8(0x807));_0x2d5fc4>0x0?(!_0x1de494&&(_0x1de494=document[_0xe34f8(0xe1b)](_0xe34f8(0xc0e)),_0x1de494['className']='unread-indicator',_0x572422[_0xe34f8(0x655)][_0xe34f8(0xf92)]='relative',_0x572422[_0xe34f8(0xe91)](_0x1de494)),_0x1de494['textContent']=_0x2d5fc4>0x63?'99+':_0x2d5fc4,_0x1de494[_0xe34f8(0x655)]['display']=_0xe34f8(0x27a)):_0x1de494&&(_0x1de494[_0xe34f8(0x655)]['display']='none'),_0x44666e();}function _0x4ac87e(){const _0x325961=_0x549949;if(_0x595b58)return;const _0x8f660a=_0x41df36[_0x325961(0xc0)][_0x325961(0x686)]||0x3c;_0x595b58=setInterval(_0x2459be,_0x8f660a*0x3e8),_0x2b6a68();}function _0x210308(){_0x595b58&&(clearInterval(_0x595b58),_0x595b58=null),_0x4f6d5a();}async function _0x2459be(){const _0x5e766a=_0x549949;console['log']('模拟器心跳\x20Tick...');if(!_0x41df36['globalSettings'][_0x5e766a(0x8d5)]){_0x210308();return;}const _0x1e8e68=Object[_0x5e766a(0x76d)](_0x41df36[_0x5e766a(0x864)])['filter'](_0x27a0b4=>!_0x27a0b4[_0x5e766a(0x1a2)]);_0x1e8e68[_0x5e766a(0x19c)](_0x1d5f2c=>{const _0x6f7764=_0x5e766a;if(_0x1d5f2c['relationship']?.[_0x6f7764(0x1fe)]===_0x6f7764(0xf22)){const _0x2a3320=_0x1d5f2c[_0x6f7764(0x112b)]['blockedTimestamp'];if(!_0x2a3320)return;const _0x216f25=Date[_0x6f7764(0x108d)]()-_0x2a3320,_0x4509b1=(_0x41df36[_0x6f7764(0xc0)][_0x6f7764(0x286)]||0x1)*0x3c*0x3c*0x3e8;_0x216f25>_0x4509b1&&(_0x1d5f2c[_0x6f7764(0x112b)][_0x6f7764(0x1fe)]=_0x6f7764(0x82d),_0x49f25f(_0x1d5f2c['id']));}else{if(_0x1d5f2c[_0x6f7764(0x112b)]?.['status']===_0x6f7764(0x757)&&_0x1d5f2c['id']!==_0x41df36['activeChatId']){if(_0x1d5f2c[_0x6f7764(0x886)][_0x6f7764(0x8d5)]===![]){console['log']('角色\x20\x22'+_0x1d5f2c[_0x6f7764(0x461)]+_0x6f7764(0xb8a));return;}Math[_0x6f7764(0x5ce)]()<0.2&&(console['log'](_0x6f7764(0xbc3)+_0x1d5f2c[_0x6f7764(0x461)]+_0x6f7764(0xb1e)),_0x1ece9c(_0x1d5f2c['id']));}}});const _0x33b49d=Object[_0x5e766a(0x76d)](_0x41df36['chats'])[_0x5e766a(0x98a)](_0x490d59=>_0x490d59[_0x5e766a(0x1a2)]);_0x33b49d[_0x5e766a(0x19c)](_0x36effa=>{const _0x4c7b27=_0x5e766a;if(_0x36effa[_0x4c7b27(0x886)][_0x4c7b27(0x8d5)]===![]){console[_0x4c7b27(0xe72)](_0x4c7b27(0xa34)+_0x36effa['name']+'\x22\x20的后台活动开关已关闭，本次跳过。');return;}_0x36effa['id']!==_0x41df36[_0x4c7b27(0xfc5)]&&Math[_0x4c7b27(0x5ce)]()<0.1&&(console[_0x4c7b27(0xe72)](_0x4c7b27(0xa34)+_0x36effa['name']+_0x4c7b27(0xb1e)),_0x1055ff(_0x36effa['id']));});try{const _0x3d564d=await _0x342df8['npcs'][_0x5e766a(0x21f)]();if(_0x3d564d['length']===0x0)return;const _0x266621=await _0x342df8['qzonePosts'][_0x5e766a(0x4b1)](_0x5e766a(0x3b7))['reverse']()[_0x5e766a(0xc33)](0xa)[_0x5e766a(0x21f)]();for(const _0x48129b of _0x3d564d){if(_0x48129b['enableBackgroundActivity']===![])continue;const _0x5a238e=_0x48129b['actionCooldownMinutes']||0xf;if(_0x48129b[_0x5e766a(0x80d)]){const _0x105a7d=(Date[_0x5e766a(0x108d)]()-_0x48129b[_0x5e766a(0x80d)])/(0x3e8*0x3c);if(_0x105a7d<_0x5a238e)continue;}if(Math[_0x5e766a(0x5ce)]()>0.3)continue;const _0x41c87d=[];for(const _0x1c8e4d of _0x266621){if(_0x1c8e4d[_0x5e766a(0x1301)]===_0x5e766a(0x1244)+_0x48129b['id'])continue;const _0x3dcc8d=_0x1c8e4d[_0x5e766a(0xcad)]?.[_0x5e766a(0x12fb)](_0x368f6a=>_0x368f6a[_0x5e766a(0x855)]===_0x48129b[_0x5e766a(0x461)]),_0x1690ec=_0x1c8e4d[_0x5e766a(0xcad)]?.[_0x5e766a(0x1368)](-0x1)[0x0]?.[_0x5e766a(0xbb)];if(_0x1690ec===_0x48129b[_0x5e766a(0x461)])continue;let _0x573a93=![];if(_0x1c8e4d[_0x5e766a(0x1301)]==='user'||_0x1c8e4d['authorId']['startsWith'](_0x5e766a(0x1197)))_0x48129b['associatedWith'][_0x5e766a(0xee2)](_0x1c8e4d[_0x5e766a(0x1301)])&&(_0x573a93=!![]);else{if(_0x1c8e4d[_0x5e766a(0x1301)]['startsWith'](_0x5e766a(0x1244))){const _0x4fe2c4=parseInt(_0x1c8e4d[_0x5e766a(0x1301)][_0x5e766a(0x709)](_0x5e766a(0x1244),'')),_0x321bef=await _0x342df8['npcs']['get'](_0x4fe2c4);if(_0x321bef&&_0x321bef[_0x5e766a(0x117)]){const _0x1c90aa=_0x48129b[_0x5e766a(0x117)]['filter'](_0x3a4f57=>_0x321bef[_0x5e766a(0x117)][_0x5e766a(0xee2)](_0x3a4f57));_0x1c90aa[_0x5e766a(0xfde)]>0x0&&(_0x573a93=!![]);}}}(_0x573a93||_0x3dcc8d)&&_0x41c87d[_0x5e766a(0x258)](_0x1c8e4d);}if(_0x41c87d[_0x5e766a(0xfde)]>0x0||Math[_0x5e766a(0x5ce)]()<0.2){console[_0x5e766a(0xe72)](_0x5e766a(0x6ff)+_0x48129b[_0x5e766a(0x461)]+_0x5e766a(0x12fa));const _0x588c26=await _0x105c8b(_0x48129b,_0x41c87d);if(_0x588c26&&_0x588c26[_0x5e766a(0xfde)]>0x0){for(const _0x1a66be of _0x588c26){if(_0x1a66be[_0x5e766a(0xa6b)]==='qzone_comment'){const _0x789431=await _0x342df8[_0x5e766a(0x35a)]['get'](_0x1a66be[_0x5e766a(0x6b1)]);if(_0x789431){if(!_0x789431[_0x5e766a(0xcad)])_0x789431['comments']=[];_0x789431[_0x5e766a(0xcad)][_0x5e766a(0x258)]({'commenterName':_0x48129b[_0x5e766a(0x461)],'text':_0x1a66be[_0x5e766a(0xb3a)],'replyTo':_0x1a66be['replyTo']||null,'timestamp':Date[_0x5e766a(0x108d)]()+Math[_0x5e766a(0x5ce)]()}),await _0x342df8[_0x5e766a(0x35a)]['update'](_0x1a66be[_0x5e766a(0x6b1)],{'comments':_0x789431[_0x5e766a(0xcad)]}),_0x4c6ee1(_0x3a006f+0x1);}}else{if(_0x1a66be[_0x5e766a(0xa6b)]===_0x5e766a(0xd91)){const _0x1071c1={'type':_0x1a66be[_0x5e766a(0x122f)]||_0x5e766a(0x23e),'content':_0x1a66be[_0x5e766a(0x11b6)],'timestamp':Date[_0x5e766a(0x108d)](),'authorId':'npc_'+_0x48129b['id'],'authorOriginalName':_0x48129b[_0x5e766a(0x461)],'visibleTo':_0x48129b[_0x5e766a(0x117)],'likes':[],'comments':[],'isDeleted':![]};await _0x342df8[_0x5e766a(0x35a)][_0x5e766a(0xbff)](_0x1071c1),console[_0x5e766a(0xe72)](_0x5e766a(0x6ff)+_0x48129b['name']+_0x5e766a(0x326)),_0x4c6ee1(_0x3a006f+0x1);}}}await _0x342df8[_0x5e766a(0x656)][_0x5e766a(0xaf9)](_0x48129b['id'],{'lastActionTimestamp':Date[_0x5e766a(0x108d)]()}),document[_0x5e766a(0x383)]('qzone-screen')[_0x5e766a(0x119a)][_0x5e766a(0x987)](_0x5e766a(0xde5))&&await _0x476b70();}}}}catch(_0x3b30f2){console['error'](_0x5e766a(0x9d9),_0x3b30f2);}}async function _0x105c8b(_0x467cb1,_0x4200e8){const _0x344568=_0x549949,{proxyUrl:_0x32b6f0,apiKey:_0x16da40,model:_0x58cd84}=_0x41df36[_0x344568(0x673)];if(!_0x32b6f0||!_0x16da40||!_0x58cd84)return console[_0x344568(0x98)](_0x344568(0x5d9)),null;let _0x197c5d=_0x344568(0x11f4);const _0x5b08e4=_0x41df36['qzoneSettings']['nickname']||'我',_0x1a0c4b=_0x41df36['chats'][Object[_0x344568(0x66b)](_0x41df36[_0x344568(0x864)])[0x0]]?.[_0x344568(0x886)]['myPersona']||_0x344568(0x11f);_0x197c5d+=_0x344568(0x71b)+_0x5b08e4+_0x344568(0x32e)+_0x1a0c4b+'\x0a';_0x467cb1[_0x344568(0x117)]&&_0x467cb1['associatedWith']['length']>0x0&&_0x467cb1[_0x344568(0x117)][_0x344568(0x19c)](_0x513833=>{const _0x20e79d=_0x344568,_0x4bdb1c=_0x41df36[_0x20e79d(0x864)][_0x513833];_0x4bdb1c&&!_0x4bdb1c[_0x20e79d(0x1a2)]&&(_0x197c5d+=_0x20e79d(0x71b)+_0x4bdb1c['name']+_0x20e79d(0xcac)+_0x4bdb1c[_0x20e79d(0x283)]+_0x20e79d(0xd7a)+_0x4bdb1c[_0x20e79d(0x886)][_0x20e79d(0xd83)]+'\x0a');});const _0x1d2566=(await Promise[_0x344568(0x1282)](_0x4200e8[_0x344568(0xa79)](async _0x52c770=>{const _0xd3ec66=_0x344568;let _0x35e1ab=_0xd3ec66(0xc05);if(_0x52c770['authorId']===_0xd3ec66(0x66e))_0x35e1ab=_0x41df36['qzoneSettings'][_0xd3ec66(0xabb)]||'用户';else{if(_0x52c770['authorId'][_0xd3ec66(0x1122)]('chat_'))_0x35e1ab=_0x5641f2(_0x52c770['authorOriginalName']||_0x52c770[_0xd3ec66(0x1301)]);else{if(_0x52c770[_0xd3ec66(0x1301)][_0xd3ec66(0x1122)](_0xd3ec66(0x1244))){const _0x425aa8=parseInt(_0x52c770['authorId'][_0xd3ec66(0x709)]('npc_','')),_0x2844ca=await _0x342df8[_0xd3ec66(0x656)]['get'](_0x425aa8);_0x2844ca&&(_0x35e1ab=_0x2844ca[_0xd3ec66(0x461)]);}}}const _0x227c80=(_0x52c770[_0xd3ec66(0xcad)]||[])[_0xd3ec66(0xa79)](_0x443540=>{const _0x448824=_0xd3ec66;if(typeof _0x443540===_0x448824(0x890)&&_0x443540[_0x448824(0xbb)]){const _0x5f454b=_0x5641f2(_0x443540['commenterName']);return _0x448824(0x71b)+_0x5f454b+_0x448824(0xf76)+_0x443540[_0x448824(0x6af)];}return'-\x20'+_0x443540;})[_0xd3ec66(0xa35)]('\x0a');return _0xd3ec66(0xdc)+_0x52c770['id']+_0xd3ec66(0x9cc)+_0x35e1ab+_0xd3ec66(0x174)+(_0x52c770['content']||_0x52c770[_0xd3ec66(0xbdc)]||'')[_0xd3ec66(0xba5)](0x0,0x96)+_0xd3ec66(0x1232)+(_0x227c80||_0xd3ec66(0xe9b))+_0xd3ec66(0xec6);})))[_0x344568(0xa35)]('\x0a'),_0x24af17=_0x344568(0x1244)+_0x467cb1['id'],_0x1446c4=Date[_0x344568(0x108d)]()-0xc*0x3c*0x3c*0x3e8,_0x37f5a9=await _0x342df8[_0x344568(0x35a)]['where'](_0x344568(0x1301))['equals'](_0x24af17)[_0x344568(0xfb7)](_0x1239f6=>_0x1239f6[_0x344568(0x3b7)]>_0x1446c4)['toArray']();let _0x5d1557='';_0x37f5a9['length']>0x0&&(_0x5d1557=_0x344568(0x10a));const _0x998433=_0x344568(0x46f)+_0x467cb1['name']+_0x344568(0x2f8)+_0x5d1557+_0x344568(0x72b)+_0x467cb1[_0x344568(0x461)]+'\x0a-\x20**人设**:\x20'+_0x467cb1[_0x344568(0x48c)]+'\x0a\x0a'+_0x197c5d+'\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a'+_0x1d2566+_0x344568(0x9cd);try{const _0x2f2a56=[{'role':_0x344568(0x66e),'content':_0x344568(0x8f2)}];let _0x5afd73=_0x32b6f0[_0x344568(0xee2)](_0x344568(0xdc3)),_0x7141c0=_0x112768(_0x58cd84,_0x16da40,_0x998433,_0x2f2a56);const _0x547c8f=_0x5afd73?await fetch(_0x7141c0[_0x344568(0x2fa)],_0x7141c0[_0x344568(0x8c6)]):await fetch(_0x32b6f0+_0x344568(0x126b),{'method':_0x344568(0x94f),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x16da40},'body':JSON[_0x344568(0x3fb)]({'model':_0x58cd84,'messages':[{'role':_0x344568(0xb1),'content':_0x998433},..._0x2f2a56],'temperature':_0x41df36[_0x344568(0xc0)][_0x344568(0xa4a)]||0.9})});if(!_0x547c8f['ok'])throw new Error(_0x344568(0x85a)+_0x547c8f[_0x344568(0x3ea)]);const _0x29e257=await _0x547c8f[_0x344568(0x9b3)](),_0x37f5d7=getGeminiResponseText(_0x29e257),_0x3190bd=_0x37f5d7['match'](/(\[[\s\S]*\])/);if(!_0x3190bd)throw new Error(_0x344568(0x139c));return JSON[_0x344568(0x134)](_0x3190bd[0x0]);}catch(_0x1e8c2a){return console[_0x344568(0x98)](_0x344568(0x8ee)+_0x467cb1['name']+_0x344568(0x6df),_0x1e8c2a),null;}}async function _0x1ece9c(_0x16c1fa){const _0x16916c=_0x549949,_0x3521ff=_0x41df36[_0x16916c(0x864)][_0x16c1fa];if(!_0x3521ff)return;const _0x493da4=_0x3521ff[_0x16916c(0x886)]['actionCooldownMinutes']||0xa;if(_0x3521ff[_0x16916c(0x80d)]){const _0x59a88c=(Date['now']()-_0x3521ff[_0x16916c(0x80d)])/(0x3e8*0x3c);if(_0x59a88c<_0x493da4){console[_0x16916c(0xe72)]('角色\x20\x22'+_0x3521ff[_0x16916c(0x461)]+_0x16916c(0x292)+Math[_0x16916c(0xe3c)](_0x493da4-_0x59a88c)+_0x16916c(0x12e));return;}}_0x2f64f8(_0x16c1fa,!![]);const {proxyUrl:_0x3dbefd,apiKey:_0x355028,model:_0x5a9b70}=_0x41df36[_0x16916c(0x673)];if(!_0x3dbefd||!_0x355028||!_0x5a9b70)return;const _0x419621=_0x41df36[_0x16916c(0x571)][_0x16916c(0xabb)],_0x2cfd67=new Date(),_0x262352=_0x3521ff[_0x16916c(0x886)][_0x16916c(0xa74)]||_0x16916c(0xc36),_0x164c5f=_0x2cfd67[_0x16916c(0xa2b)]('zh-CN',{'timeZone':_0x262352,'dateStyle':_0x16916c(0xd96),'timeStyle':_0x16916c(0xfc1)}),_0x318d36=new Date(_0x2cfd67[_0x16916c(0xa2b)](_0x16916c(0x12f1),{'timeZone':_0x262352}));let _0x4d9282='',_0x3e522e='',_0xaf3e13,_0x28bbdd=![];const _0xf2d5bd=_0x3521ff[_0x16916c(0x886)][_0x16916c(0x1138)]||0xa,_0x344fff=_0x3521ff[_0x16916c(0xd08)][_0x16916c(0x98a)](_0x528a74=>!_0x528a74[_0x16916c(0xbc5)])[_0x16916c(0x1368)](-_0xf2d5bd),_0xcf3f6b=_0x3521ff[_0x16916c(0xd08)][_0x16916c(0x98a)](_0x26431b=>!_0x26431b[_0x16916c(0xbc5)])[_0x16916c(0x1368)](-0x1)[0x0];if(_0x3521ff['settings']['enableTimePerception']){_0x4d9282=_0x1ccf3f(_0x318d36);const _0x3a35bf=_0x3521ff[_0x16916c(0xd08)][_0x16916c(0x98a)](_0xe0dc18=>!_0xe0dc18[_0x16916c(0xbc5)])['slice'](-0x1)[0x0],_0x2069a4=new Date();let _0x3f62dc='',_0x4ba4fe=![];if(_0x3a35bf){const _0x47df5a=new Date(_0x3a35bf['timestamp']),_0x3b2615=(_0x2069a4-_0x47df5a)/(0x3e8*0x3c*0x3c);if(_0x3b2615>0xc){_0x4ba4fe=!![];const _0x516230=Math[_0x16916c(0xdee)](_0x3b2615/0x18);_0x3f62dc=_0x16916c(0x90c)+(_0x516230>0x0?_0x516230+'天':Math[_0x16916c(0xdee)](_0x3b2615)+'小时')+_0x16916c(0x478);}else{const _0x1a3e0e=Math[_0x16916c(0xdee)](_0x3b2615*0x3c);if(_0x1a3e0e<0x5)_0x3f62dc='你们的对话刚刚还在继续。';else _0x1a3e0e<0x3c?_0x3f62dc=_0x16916c(0xf27)+_0x1a3e0e+_0x16916c(0xc12):_0x3f62dc=_0x16916c(0xf27)+Math[_0x16916c(0xdee)](_0x3b2615)+'小时前聊过。';}}else _0x4ba4fe=!![],_0x3f62dc=_0x16916c(0xa51);let _0x3da837=_0x16916c(0x525);_0x344fff['length']>0x0&&(_0x3da837='这是你们最近的对话：\x0a'+_0x344fff[_0x16916c(0xa79)](_0x225e1f=>{const _0x31ee18=_0x16916c,_0x189060=_0x225e1f['role']===_0x31ee18(0x66e)?_0x419621:_0x3521ff[_0x31ee18(0x461)];return _0x189060+':\x20'+String(_0x225e1f[_0x31ee18(0x11b6)])[_0x31ee18(0xba5)](0x0,0x32)+_0x31ee18(0x1026);})[_0x16916c(0xa35)]('\x0a')),_0x4ba4fe?_0xaf3e13='[情景提示]\x20'+_0x3f62dc+_0x16916c(0x6ba)+_0x164c5f+_0x16916c(0x474)+_0x3da837:_0xaf3e13=''+_0x3da837;}else _0x344fff[_0x16916c(0xfde)]>0x0?_0xaf3e13=_0x16916c(0x1210)+_0x344fff[_0x16916c(0xa79)](_0x5b961a=>{const _0x1d0b8c=_0x16916c,_0x1025f8=_0x5b961a[_0x1d0b8c(0x10ff)]===_0x1d0b8c(0x66e)?_0x419621:_0x3521ff[_0x1d0b8c(0x461)];return _0x1025f8+':\x20'+String(_0x5b961a[_0x1d0b8c(0x11b6)])[_0x1d0b8c(0xba5)](0x0,0x32)+_0x1d0b8c(0x1026);})[_0x16916c(0xa35)]('\x0a'):_0xaf3e13=_0x16916c(0x525);const _0x41b76a=await _0x342df8['qzonePosts']['orderBy']('timestamp')[_0x16916c(0x1087)]()[_0x16916c(0xc33)](0x5)['toArray'](),_0x254d5f=_0x29938a(_0x41b76a,_0x3521ff),_0x4ff283=_0x254d5f[_0x16916c(0x98a)](_0x13a6e1=>_0x13a6e1[_0x16916c(0x1301)]===_0x16c1fa);let _0x88b608='';_0x4ff283[_0x16916c(0xfde)]>0x0&&(_0x88b608='\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a',_0x4ff283[_0x16916c(0x19c)](_0x23285a=>{const _0x428897=_0x16916c;let _0x197a13=(_0x23285a[_0x428897(0xbdc)]||_0x23285a['content']||_0x428897(0x199))['substring'](0x0,0x28)+'...';_0x88b608+=_0x428897(0x85e)+_0x23285a['id']+_0x428897(0x1358)+_0x197a13+'\x22\x0a';}));let _0x3df25e=[];_0x254d5f[_0x16916c(0xfde)]>0x0&&(_0x3df25e=_0x254d5f[_0x16916c(0xa79)](_0x5479c1=>{const _0x41c52b=_0x16916c;let _0x420c8b;if(_0x5479c1[_0x41c52b(0xa6b)]==='text_image')_0x420c8b=('[一张图片，其隐藏文字为：“'+_0x5479c1[_0x41c52b(0x4e6)]+_0x41c52b(0x6ae)+(_0x5479c1[_0x41c52b(0xbdc)]||''))['substring'](0x0,0x32)+'...';else _0x5479c1['type']===_0x41c52b(0xe9d)?_0x420c8b=('[一张图片，描述为：“'+_0x5479c1[_0x41c52b(0x8cf)]+_0x41c52b(0x6ae)+(_0x5479c1[_0x41c52b(0xbdc)]||''))[_0x41c52b(0xba5)](0x0,0x32)+'...':_0x420c8b=String(_0x5479c1[_0x41c52b(0xbdc)]||_0x5479c1[_0x41c52b(0x11b6)]||_0x41c52b(0x199))[_0x41c52b(0xba5)](0x0,0x32)+_0x41c52b(0x1026);return'-\x20\x22'+_0x420c8b+'\x22';}));let _0x3c8c27='';_0x3df25e[_0x16916c(0xfde)]>0x0&&(_0x3c8c27=_0x16916c(0x7bc)+_0x3df25e['join']('\x0a')+_0x16916c(0x602));let _0x181575='';if(_0x3521ff['settings']['linkedWorldBookIds']&&_0x3521ff['settings'][_0x16916c(0xe8c)][_0x16916c(0xfde)]>0x0){const _0x76f391=_0x3521ff[_0x16916c(0x886)][_0x16916c(0xe8c)][_0x16916c(0xa79)](_0x1bf04a=>{const _0x243358=_0x16916c,_0x119978=_0x41df36[_0x243358(0xf17)][_0x243358(0xd12)](_0x37ab7c=>_0x37ab7c['id']===_0x1bf04a);if(!_0x119978||!Array[_0x243358(0x565)](_0x119978[_0x243358(0x11b6)]))return'';const _0x39e0b9=_0x119978['content'][_0x243358(0x98a)](_0x276453=>_0x276453[_0x243358(0x8e4)]!==![])[_0x243358(0xa79)](_0x93ac7f=>{const _0x56ca87=_0x243358;let _0x50ee46='\x0a###\x20条目:\x20'+(_0x93ac7f[_0x56ca87(0x125b)]||'无备注')+'\x0a';return _0x93ac7f[_0x56ca87(0x66b)][_0x56ca87(0xfde)]>0x0&&(_0x50ee46+=_0x56ca87(0x3dc)+_0x93ac7f[_0x56ca87(0x66b)]['join'](',\x20')+'\x0a'),_0x50ee46+=_0x56ca87(0x37e)+_0x93ac7f[_0x56ca87(0x11b6)],_0x50ee46;})[_0x243358(0xa35)]('');return _0x39e0b9?_0x243358(0x6f9)+_0x119978[_0x243358(0x461)]+'\x0a'+_0x39e0b9:'';})[_0x16916c(0x98a)](Boolean)[_0x16916c(0xa35)]('');_0x76f391&&(_0x181575=_0x16916c(0xec1)+_0x76f391+_0x16916c(0x84f));}let _0x224d55='';const _0xe40d33=_0x3521ff['settings'][_0x16916c(0x1d8)]||0xa;if(_0x3521ff[_0x16916c(0x886)][_0x16916c(0x20c)]&&_0x3521ff[_0x16916c(0x886)][_0x16916c(0x20c)][_0x16916c(0xfde)]>0x0){const _0x50f81e=_0x3521ff['settings'][_0x16916c(0x20c)][_0x16916c(0xa79)](_0x29701f=>{const _0x49063e=_0x16916c,_0x1aca85=_0x41df36[_0x49063e(0x864)][_0x29701f];if(!_0x1aca85)return null;const _0x3c219b=_0x1aca85[_0x49063e(0xd08)][_0x49063e(0x1368)](-0x1)[0x0];return{'chat':_0x1aca85,'latestTimestamp':_0x3c219b?_0x3c219b['timestamp']:0x0};})[_0x16916c(0x98a)](Boolean);_0x50f81e[_0x16916c(0x1296)]((_0x3a05ea,_0x2a1208)=>_0x2a1208[_0x16916c(0x1d0)]-_0x3a05ea[_0x16916c(0x1d0)]),_0x224d55+=_0x16916c(0x19a);for(const _0x93c794 of _0x50f81e){const _0x488476=_0x93c794[_0x16916c(0x135e)],_0x55564e=_0x488476[_0x16916c(0x1a2)]?_0x16916c(0x58a):'[私聊]',_0x569936=_0x93c794[_0x16916c(0x1d0)]>0x0?_0x16916c(0x713)+_0xa3fdac(_0x93c794[_0x16916c(0x1d0)])+')':'';_0x224d55+='\x0a##\x20---\x20来自'+_0x55564e+'“'+_0x488476['name']+_0x16916c(0x5aa)+_0x569936+_0x16916c(0x1090);const _0x1dcc5c=_0x488476[_0x16916c(0xd08)]['slice'](-_0xe40d33),_0x20a5b6=_0x1dcc5c[_0x16916c(0x98a)](_0x3906b7=>!String(_0x3906b7[_0x16916c(0x11b6)])[_0x16916c(0xee2)](_0x16916c(0x1266)));_0x20a5b6[_0x16916c(0xfde)]>0x0?_0x20a5b6[_0x16916c(0x19c)](_0x4707ae=>{const _0x262cac=_0x16916c,_0x5878c0=_0x4707ae[_0x262cac(0x10ff)]===_0x262cac(0x66e)?_0x488476[_0x262cac(0x886)][_0x262cac(0x52e)]||'我':_0x4707ae['senderName']||_0x488476['name'];let _0x44f144=String(_0x4707ae[_0x262cac(0x11b6)]);if(_0x4707ae[_0x262cac(0xa6b)]===_0x262cac(0x1050)||_0x4707ae[_0x262cac(0xa6b)]===_0x262cac(0xed0))_0x44f144=_0x262cac(0x134a)+_0x4707ae[_0x262cac(0x11b6)]+']';else _0x4707ae[_0x262cac(0xa6b)]===_0x262cac(0xa4f)&&(_0x44f144=_0x262cac(0x290)+_0x4707ae[_0x262cac(0x11b6)]+']');_0x224d55+=_0x5878c0+':\x20'+_0x44f144+'\x0a';}):_0x224d55+='(暂无有效聊天记录)\x0a';}}let _0xa14620='';if(_0x254d5f[_0x16916c(0xfde)]>0x0){let _0x42a2ff=_0x16916c(0xc7c);for(const _0xa15168 of _0x254d5f){let _0x3ecafc;if(_0xa15168[_0x16916c(0x1301)]==='user')_0x3ecafc=_0x41df36[_0x16916c(0x571)][_0x16916c(0xabb)];else{if(String(_0xa15168['authorId'])[_0x16916c(0x1122)](_0x16916c(0x1244)))_0x3ecafc=_0xa15168[_0x16916c(0x52b)]||_0x16916c(0x762);else{const _0x12b731=_0x41df36['chats'][_0xa15168['authorId']];_0x3ecafc=_0x12b731?_0x12b731[_0x16916c(0x461)]:_0x16916c(0x12f2);}}if(_0xa15168[_0x16916c(0x1301)]===_0x16c1fa)_0x3ecafc+=_0x16916c(0x11bf);let _0xe7c7e4;if(_0xa15168[_0x16916c(0xa6b)]===_0x16916c(0xcf0)){const _0x2ca8a1=_0xa15168[_0x16916c(0x1051)]?_0x16916c(0x2f3)+_0xa15168[_0x16916c(0x1051)]+'\x22':'';let _0x45a6a3=_0x16916c(0x12ba);const _0x23cc8d=_0xa15168[_0x16916c(0xba8)]['authorId'];if(_0x23cc8d===_0x16916c(0x66e))_0x45a6a3=_0x41df36[_0x16916c(0x571)]['nickname'];else _0x41df36[_0x16916c(0x864)][_0x23cc8d]&&(_0x45a6a3=_0x41df36[_0x16916c(0x864)][_0x23cc8d][_0x16916c(0x461)]);let _0x3e7645;const _0x5dd7c6=_0xa15168[_0x16916c(0xba8)];if(_0x5dd7c6['type']==='text_image')_0x3e7645=_0x16916c(0xee0)+(_0x5dd7c6[_0x16916c(0xbdc)]||'')+_0x16916c(0x1b8)+(_0x5dd7c6[_0x16916c(0x4e6)]||'')[_0x16916c(0xba5)](0x0,0x28)+_0x16916c(0x12e9);else _0x5dd7c6[_0x16916c(0xa6b)]===_0x16916c(0xe9d)?_0x3e7645=_0x16916c(0x6b4)+(_0x5dd7c6['publicText']||'')+_0x16916c(0x1b8)+(_0x5dd7c6['imageDescription']||'')['substring'](0x0,0x28)+'...\x22)':_0x3e7645='\x22'+(_0x5dd7c6[_0x16916c(0x11b6)]||'')[_0x16916c(0xba5)](0x0,0x28)+'...\x22';_0xe7c7e4=_0x16916c(0xf51)+_0x45a6a3+_0x16916c(0x11e1)+_0x2ca8a1+_0x16916c(0xb80)+_0x3e7645+'】';}else{if(_0xa15168[_0x16916c(0xa6b)]==='text_image')_0xe7c7e4=(_0x16916c(0xa14)+_0xa15168['hiddenContent']+_0x16916c(0x4e2)+(_0xa15168[_0x16916c(0xbdc)]||''))[_0x16916c(0xba5)](0x0,0x32)+_0x16916c(0x1026);else{if(_0xa15168[_0x16916c(0xa6b)]==='image_post')_0xe7c7e4=(_0x16916c(0x36c)+_0xa15168[_0x16916c(0x8cf)]+_0x16916c(0x4e2)+(_0xa15168[_0x16916c(0xbdc)]||''))[_0x16916c(0xba5)](0x0,0x32)+_0x16916c(0x1026);else{if(_0xa15168[_0x16916c(0xa6b)]==='naiimag'&&_0xa15168[_0x16916c(0x357)]){const _0x2dddd8=Array[_0x16916c(0x565)](_0xa15168[_0x16916c(0x357)])?_0xa15168[_0x16916c(0x357)]:[_0xa15168[_0x16916c(0x357)]];_0xe7c7e4=(_0xa15168[_0x16916c(0xbdc)]||'')+(_0x16916c(0x8ec)+_0x2dddd8[_0x16916c(0xfde)]+'张NovelAI图片:\x20'+_0x2dddd8[_0x16916c(0xa35)](',\x20')+']');}else _0xe7c7e4=String(_0xa15168[_0x16916c(0xbdc)]||_0xa15168['content']||_0x16916c(0x199))['substring'](0x0,0x32)+_0x16916c(0x1026);}}}_0x42a2ff+=_0x16916c(0x85e)+_0xa15168['id']+')\x20作者:\x20'+_0x3ecafc+',\x20内容:\x20\x22'+_0xe7c7e4+'\x22\x0a';if(_0xa15168[_0x16916c(0xcad)]&&_0xa15168[_0x16916c(0xcad)][_0x16916c(0xfde)]>0x0)for(const _0x175575 of _0xa15168['comments']){if(typeof _0x175575===_0x16916c(0x890)&&_0x175575[_0x16916c(0xbb)]){const _0x848874=_0x5641f2(_0x175575['commenterName']);let _0x729641=_0x175575[_0x16916c(0x7de)]?'[表情:\x20\x27'+_0x175575[_0x16916c(0x7de)]+'\x27]':_0x175575[_0x16916c(0x6af)];_0x175575['commenterName']===_0x3521ff[_0x16916c(0x283)]?_0x42a2ff+=_0x16916c(0x132b)+_0x729641+'\x0a':_0x42a2ff+=_0x16916c(0xf83)+_0x848874+'\x20(本名:\x20'+_0x175575[_0x16916c(0xbb)]+_0x16916c(0x12a8)+_0x729641+'\x0a';}}}_0xa14620=_0x42a2ff;}const _0x4627ed=_0x16916c(0x25a)+(_0x3521ff['longTermMemory']&&_0x3521ff[_0x16916c(0x1349)]['length']>0x0?_0x3521ff[_0x16916c(0x1349)][_0x16916c(0xa79)](_0x188a24=>_0x16916c(0xde8)+_0xa3fdac(_0x188a24[_0x16916c(0x3b7)])+')\x20'+_0x188a24[_0x16916c(0x11b6)])[_0x16916c(0xa35)]('\x0a'):_0x16916c(0x7ae)),_0xce3028=_0x1ad6bb(_0x3521ff,0x3,'hours'),_0x32d947=_0x1ad6bb(_0x3521ff,0x6,_0x16916c(0x2f2)),_0x3ef388=_0x1ad6bb(_0x3521ff,0x9,'hours'),_0x2f018e=_0x1ad6bb(_0x3521ff,0x1,_0x16916c(0x103b)),_0x1996f2=_0x1ad6bb(_0x3521ff,0x3,_0x16916c(0x103b)),_0x521e25=_0x1ad6bb(_0x3521ff,0x7,_0x16916c(0x103b));let _0x4798e3='';if(_0xce3028||_0x32d947||_0x3ef388||_0x2f018e||_0x1996f2||_0x521e25){_0x4798e3+=_0x16916c(0xda0);if(_0xce3028)_0x4798e3+=_0xce3028;if(_0x32d947)_0x4798e3+=_0x32d947;if(_0x3ef388)_0x4798e3+=_0x3ef388;if(_0xce3028||_0x32d947||_0x3ef388)_0x4798e3+='\x0a';if(_0x2f018e)_0x4798e3+=_0x2f018e;if(_0x1996f2)_0x4798e3+=_0x1996f2;if(_0x521e25)_0x4798e3+=_0x521e25;}const _0x583e9a=_0xd83680(_0x3521ff),_0x1ab700='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22'+_0x3521ff['name']+_0x16916c(0xdb3)+_0x3521ff[_0x16916c(0x283)]+_0x16916c(0x1173)+_0x419621+_0x16916c(0x10df)+(_0x3521ff[_0x16916c(0x886)][_0x16916c(0xfc8)]?_0x16916c(0x50e)+_0x164c5f+'\x20('+_0x4d9282+_0x16916c(0x1285)+_0x3e522e+'\x0a'+(_0x28bbdd?_0x16916c(0x6d4):''):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**'+(_0x3521ff[_0x16916c(0x752)]||'无')+_0x16916c(0x9f5)+_0x3c8c27+_0x16916c(0x602)+_0x88b608+_0x16916c(0x906)+_0x3521ff[_0x16916c(0x886)][_0x16916c(0xd83)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x181575+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3521ff['longTermMemory']&&_0x3521ff[_0x16916c(0x1349)][_0x16916c(0xfde)]>0x0?_0x3521ff[_0x16916c(0x1349)]['map'](_0xa29d7f=>_0x16916c(0xde8)+_0xa3fdac(_0xa29d7f[_0x16916c(0x3b7)])+')\x20'+_0xa29d7f[_0x16916c(0x11b6)])[_0x16916c(0xa35)]('\x0a'):'无')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4798e3+_0x16916c(0x1367)+_0x224d55+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3521ff['settings'][_0x16916c(0xfc8)]?_0x16916c(0x354)+_0x164c5f+'\x20('+_0x4d9282+')':'')+_0x16916c(0x602)+(_0x3521ff[_0x16916c(0x886)]['enableTimePerception']?_0x16916c(0x8ca)+_0x3e522e:'')+_0x16916c(0x418)+_0x583e9a+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20'+_0xaf3e13+_0x16916c(0x602)+_0xa14620+'\x0a',_0x383cff=[{'role':_0x16916c(0xb1),'content':_0x1ab700},..._0x344fff[_0x16916c(0xa79)](_0x2020fa=>{const _0x192248=_0x16916c,_0x568f62=_0x2020fa[_0x192248(0x10ff)]===_0x192248(0x66e)?_0x419621:_0x3521ff[_0x192248(0x461)];let _0x19a2ef=_0x2020fa['content'];return typeof _0x19a2ef!==_0x192248(0xafa)&&(_0x19a2ef=JSON[_0x192248(0x3fb)](_0x19a2ef)),{'role':_0x2020fa['role'],'content':_0x568f62+':\x20'+_0x19a2ef};})];try{const _0x4e4513=[{'role':'user','content':_0x1ab700+_0x16916c(0x336)+_0xa14620}];console[_0x16916c(0xe72)](_0x16916c(0x507)+_0x3521ff[_0x16916c(0x461)]+'\x22)');let _0x41ae8f=_0x3dbefd===GEMINI_API_URL,_0x129061=_0x112768(_0x5a9b70,_0x355028,_0x1ab700,_0x4e4513);const _0x28e870=_0x41ae8f?await fetch(_0x129061[_0x16916c(0x2fa)],_0x129061[_0x16916c(0x8c6)]):await fetch(_0x3dbefd+_0x16916c(0x126b),{'method':_0x16916c(0x94f),'headers':{'Content-Type':'application/json','Authorization':_0x16916c(0xd55)+_0x355028},'body':JSON[_0x16916c(0x3fb)]({'model':_0x5a9b70,'messages':_0x4e4513,'temperature':_0x41df36[_0x16916c(0xc0)][_0x16916c(0xa4a)]||0.9})});if(!_0x28e870['ok']){const _0x4bf8a8=await _0x28e870[_0x16916c(0x9b3)]();throw new Error('API请求失败:\x20'+_0x28e870['status']+_0x16916c(0xb13)+JSON[_0x16916c(0x3fb)](_0x4bf8a8));}const _0x16cdc6=await _0x28e870[_0x16916c(0x9b3)](),_0x346789=_0x41ae8f?getGeminiResponseText(_0x16cdc6):_0x16cdc6[_0x16916c(0xe77)][0x0][_0x16916c(0x5f8)][_0x16916c(0x11b6)];if(!_0x346789||_0x346789[_0x16916c(0x1cb)]()===''){console[_0x16916c(0x17b)](_0x16916c(0x1b9)+_0x3521ff[_0x16916c(0x461)]+_0x16916c(0x640));return;}const _0x4c36ab=_0x28b8fa(_0x346789);if(!_0x4c36ab||_0x4c36ab[_0x16916c(0xfde)]===0x0){console[_0x16916c(0x17b)](_0x16916c(0xee8)+_0x3521ff[_0x16916c(0x461)]+_0x16916c(0x398),_0x346789);return;}let _0xfd7e00=Date[_0x16916c(0x108d)](),_0x85db41=![];const _0x159d5b=[];for(const _0x1a6671 of _0x4c36ab){const _0xdd2909=String(_0x1a6671[_0x16916c(0x11b6)]||''),_0x5dea8f=_0xdd2909[_0x16916c(0x1cb)]()[_0x16916c(0x1122)]('<')&&_0xdd2909[_0x16916c(0x1cb)]()[_0x16916c(0xd47)]('>');if(_0x1a6671[_0x16916c(0xa6b)]==='text'&&!_0x5dea8f&&_0xdd2909[_0x16916c(0xee2)]('\x0a')){const _0x5f40db=_0xdd2909['split'](/\n+/)[_0x16916c(0x98a)](_0x208a00=>_0x208a00[_0x16916c(0x1cb)]());_0x5f40db[_0x16916c(0x19c)](_0x25cf23=>{const _0x3153c3=_0x16916c;_0x159d5b[_0x3153c3(0x258)]({..._0x1a6671,'content':_0x25cf23});});}else _0x159d5b[_0x16916c(0x258)](_0x1a6671);}for(const _0x113f14 of _0x159d5b){_0x3521ff[_0x16916c(0x752)]=_0x113f14[_0x16916c(0xa6b)],_0x3521ff[_0x16916c(0x80d)]=_0xfd7e00;let _0x504cba=null;const _0xee5829={'role':_0x16916c(0xf3c),'senderName':_0x3521ff[_0x16916c(0x283)],'timestamp':_0xfd7e00++};let _0xbc353d=null;switch(_0x113f14[_0x16916c(0xa6b)]){case'qzone_delete_post':{const _0x3b09f8=parseInt(_0x113f14[_0x16916c(0x6b1)]),_0x1086f9=await _0x342df8['qzonePosts'][_0x16916c(0x1a3)](_0x3b09f8);if(_0x1086f9&&_0x1086f9[_0x16916c(0x1301)]===_0x16c1fa){await _0x342df8[_0x16916c(0x35a)]['update'](_0x3b09f8,{'isDeleted':!![]});document['getElementById']('qzone-screen')['classList'][_0x16916c(0x987)](_0x16916c(0xde5))&&_0x476b70();const _0x18ee3f={'role':_0x16916c(0xb1),'type':_0x16916c(0x5ca),'content':'['+_0x3521ff[_0x16916c(0x461)]+_0x16916c(0x130d),'postId':_0x3b09f8,'timestamp':_0xfd7e00++};_0x3521ff[_0x16916c(0xd08)][_0x16916c(0x258)](_0x18ee3f),isViewingThisChat?_0x323467(_0x18ee3f,_0x3521ff):(_0x3521ff['unreadCount']=(_0x3521ff[_0x16916c(0x40c)]||0x0)+0x1,_0x193863(_0x16c1fa,'['+_0x3521ff[_0x16916c(0x461)]+_0x16916c(0x130d)),_0x85db41=!![]);}else console[_0x16916c(0x17b)](_0x16916c(0x58e)+_0x3521ff['name']+_0x16916c(0x351)+_0x113f14[_0x16916c(0x6b1)]+')');continue;}case _0x16916c(0x6af):_0x504cba={..._0xee5829,'content':_0x113f14['content']};break;case _0x16916c(0x1050):_0x504cba={..._0xee5829,'type':_0x16916c(0x1050),'content':_0x113f14['description']};break;case _0x16916c(0x37d):if(_0x113f14[_0x16916c(0x7de)]){const _0x3dcb08=_0x41df36[_0x16916c(0x823)][_0x16916c(0xd12)](_0x146230=>_0x146230[_0x16916c(0x461)]===_0x113f14['meaning']);_0x3dcb08?_0x504cba={..._0xee5829,'type':'sticker','content':_0x3dcb08[_0x16916c(0x2fa)],'meaning':_0x3dcb08[_0x16916c(0x461)]}:(console['warn']('AI\x20(独立行动)\x20尝试使用一个不存在的表情:\x20\x22'+_0x113f14[_0x16916c(0x7de)]+'\x22'),_0x504cba={..._0xee5829,'type':_0x16916c(0x6af),'content':_0x16916c(0x261)+_0x113f14[_0x16916c(0x7de)]+']'});}else console[_0x16916c(0x17b)](_0x16916c(0x10de),_0x113f14),_0x504cba={..._0xee5829,'type':_0x16916c(0x37d),'content':_0x113f14['url'],'meaning':_0x16916c(0x2a8)};break;case'update_status':_0x3521ff[_0x16916c(0x1fe)]['text']=_0x113f14[_0x16916c(0x1bb)],_0x3521ff[_0x16916c(0x1fe)][_0x16916c(0xa6d)]=_0x113f14[_0x16916c(0x1a7)]||![],_0x3521ff[_0x16916c(0x1fe)][_0x16916c(0x6a8)]=Date[_0x16916c(0x108d)]();break;case _0x16916c(0xd91):const _0x534b6e={'type':_0x113f14[_0x16916c(0x122f)],'content':_0x113f14[_0x16916c(0x11b6)]||'','publicText':_0x113f14[_0x16916c(0xbdc)]||'','hiddenContent':_0x113f14[_0x16916c(0x4e6)]||'','image_prompt':_0x113f14[_0x16916c(0x8d8)]||'','timestamp':Date['now'](),'authorId':_0x16c1fa,'authorOriginalName':_0x3521ff['originalName'],'authorGroupId':_0x3521ff[_0x16916c(0x11a6)],'visibleGroupIds':null};await _0x342df8['qzonePosts'][_0x16916c(0xbff)](_0x534b6e),_0x4c6ee1(_0x3a006f+0x1),console[_0x16916c(0xe72)](_0x16916c(0x87d)+_0x3521ff[_0x16916c(0x461)]+_0x16916c(0x101e));break;case _0x16916c(0xcf0):const _0x31b6e7=await _0x342df8[_0x16916c(0x35a)][_0x16916c(0x1a3)](parseInt(_0x113f14['postId']));if(_0x31b6e7){const _0x1ab6b5={'type':_0x16916c(0xcf0),'timestamp':Date[_0x16916c(0x108d)](),'authorId':_0x16c1fa,'authorGroupId':_0x3521ff[_0x16916c(0x11a6)],'authorOriginalName':_0x3521ff[_0x16916c(0x283)],'repostComment':_0x113f14[_0x16916c(0x125b)]||'','originalPost':_0x31b6e7,'visibleGroupIds':null};await _0x342df8[_0x16916c(0x35a)][_0x16916c(0xbff)](_0x1ab6b5),_0x4c6ee1(_0x3a006f+0x1),console[_0x16916c(0xe72)](_0x16916c(0x87d)+_0x3521ff[_0x16916c(0x461)]+'\x22\x20转发了动态\x20#'+_0x113f14[_0x16916c(0x6b1)]);}break;case _0x16916c(0x121):const _0x380e6e=await _0x342df8[_0x16916c(0x35a)][_0x16916c(0x1a3)](parseInt(_0x113f14[_0x16916c(0x6b1)]));if(_0x380e6e){if(!_0x380e6e[_0x16916c(0x133c)])_0x380e6e[_0x16916c(0x133c)]=[];!_0x380e6e[_0x16916c(0x133c)][_0x16916c(0xee2)](_0x3521ff[_0x16916c(0x283)])&&(_0x380e6e['likes'][_0x16916c(0x258)](_0x3521ff[_0x16916c(0x283)]),await _0x342df8[_0x16916c(0x35a)][_0x16916c(0xaf9)](_0x380e6e['id'],{'likes':_0x380e6e[_0x16916c(0x133c)]}),_0x4c6ee1(_0x3a006f+0x1),console['log'](_0x16916c(0x87d)+_0x3521ff['name']+_0x16916c(0xd76)+_0x113f14[_0x16916c(0x6b1)]));}break;case _0x16916c(0xc1b):{const _0x5807ba=await _0x342df8[_0x16916c(0x35a)][_0x16916c(0x1a3)](parseInt(_0x113f14[_0x16916c(0x6b1)]));if(_0x5807ba){if(!_0x5807ba[_0x16916c(0xcad)])_0x5807ba[_0x16916c(0xcad)]=[];const _0x3b96c5=_0x113f14[_0x16916c(0x461)]||_0x3521ff[_0x16916c(0x283)],_0x5a4cb7=(_0x42ac9e,_0x4e827f=null,_0x200198=null)=>({'commenterName':_0x3b96c5,'text':_0x1d0461(_0x42ac9e,_0x3521ff),'meaning':_0x4e827f,'replyTo':_0x200198,'timestamp':Date[_0x16916c(0x108d)]()});if(_0x113f14['stickerMeaning']){const _0x22f25d=_0x41df36['userStickers']['find'](_0x5d31a7=>_0x5d31a7[_0x16916c(0x461)]===_0x113f14[_0x16916c(0x114f)]);_0x22f25d?_0x5807ba[_0x16916c(0xcad)][_0x16916c(0x258)](_0x5a4cb7(_0x22f25d[_0x16916c(0x2fa)],_0x22f25d['name'],_0x113f14[_0x16916c(0x855)]||null)):(console['warn'](_0x16916c(0x92f)+_0x113f14[_0x16916c(0x114f)]+'\x22'),_0x5807ba[_0x16916c(0xcad)][_0x16916c(0x258)](_0x5a4cb7(_0x16916c(0x261)+_0x113f14[_0x16916c(0x114f)]+']',null,_0x113f14[_0x16916c(0x855)]||null)));}else{if(Array[_0x16916c(0x565)](_0x113f14[_0x16916c(0xcad)]))_0x113f14[_0x16916c(0xcad)][_0x16916c(0x19c)](_0x40c4b0=>{const _0x36e7b5=_0x16916c;typeof _0x40c4b0===_0x36e7b5(0xafa)&&_0x40c4b0[_0x36e7b5(0x1cb)]()&&_0x5807ba[_0x36e7b5(0xcad)][_0x36e7b5(0x258)](_0x5a4cb7(_0x40c4b0,null,_0x113f14[_0x36e7b5(0x855)]||null));});else typeof _0x113f14['commentText']===_0x16916c(0xafa)&&_0x113f14[_0x16916c(0xb3a)][_0x16916c(0x1cb)]()&&_0x5807ba['comments']['push'](_0x5a4cb7(_0x113f14['commentText'],null,_0x113f14['replyTo']||null));}await _0x342df8[_0x16916c(0x35a)][_0x16916c(0xaf9)](_0x5807ba['id'],{'comments':_0x5807ba[_0x16916c(0xcad)]}),_0x4c6ee1(_0x3a006f+0x1),console[_0x16916c(0xe72)](_0x16916c(0x87d)+_0x3521ff[_0x16916c(0x461)]+_0x16916c(0x4c6)+_0x113f14[_0x16916c(0x6b1)]);if(!_0x3521ff[_0x16916c(0xd07)])_0x3521ff['commentCooldowns']={};_0x3521ff[_0x16916c(0xd07)][_0x113f14[_0x16916c(0x6b1)]]=Date['now']();}continue;}case _0x16916c(0x1274):!_0x4f60f2[_0x16916c(0x40d)]&&!_0x4f60f2[_0x16916c(0xe53)]&&(_0x4f60f2['isAwaitingResponse']=!![],_0x4f60f2[_0x16916c(0xfc5)]=_0x16c1fa,_0x4f60f2[_0x16916c(0xc02)]=![],_0x4f60f2[_0x16916c(0x496)]=_0x3521ff[_0x16916c(0x461)],_0x3ef794());break;default:console[_0x16916c(0x17b)]('角色\x20\x22'+_0x3521ff['name']+'\x22\x20尝试执行未知的后台动作:',_0x113f14[_0x16916c(0xa6b)]);break;case'change_avatar':{const _0x2a4e1e=_0x113f14[_0x16916c(0x461)],_0x1cf30b=_0x3521ff[_0x16916c(0x886)]['aiAvatarLibrary'][_0x16916c(0xd12)](_0xf2dfa8=>_0xf2dfa8[_0x16916c(0x461)]===_0x2a4e1e);_0x1cf30b&&(_0x3521ff[_0x16916c(0x886)][_0x16916c(0x121e)]=_0x1cf30b[_0x16916c(0x2fa)],await _0x4fddd3(_0x3521ff),visibleSystemMessage={'content':'['+_0x3521ff['name']+'\x20更换了头像]'},console[_0x16916c(0xe72)]('后台活动:\x20角色\x20\x22'+_0x3521ff['name']+_0x16916c(0xdbc)));break;}}if(_0x504cba){_0x3521ff[_0x16916c(0xd08)]['push'](_0x504cba),_0x3521ff['unreadCount']=(_0x3521ff['unreadCount']||0x0)+0x1;if(!_0x85db41){let _0x22a00b=_0x504cba[_0x16916c(0xa6b)]===_0x16916c(0x1050)?_0x16916c(0x1167):_0x504cba['content']||'';_0x193863(_0x16c1fa,_0x22a00b),_0x85db41=!![];}}}await _0x342df8['chats'][_0x16916c(0x9c0)](_0x3521ff);}catch(_0x5991be){console['error']('角色\x20\x22'+_0x3521ff[_0x16916c(0x461)]+_0x16916c(0x8b4),_0x5991be);}finally{_0x2f64f8(_0x16c1fa,![]),_0x25558e(),document[_0x16916c(0x383)](_0x16916c(0xc0c))[_0x16916c(0x119a)][_0x16916c(0x987)](_0x16916c(0xde5))&&_0x476b70();}}async function _0x1055ff(_0x6711d4){const _0x5e27c7=_0x549949,_0x3237dc=_0x41df36[_0x5e27c7(0x864)][_0x6711d4];if(!_0x3237dc||!_0x3237dc[_0x5e27c7(0x1a2)])return;const _0x109044=_0x3237dc[_0x5e27c7(0x886)][_0x5e27c7(0xf9c)]||0xa;if(_0x3237dc['lastActionTimestamp']){const _0x219398=(Date['now']()-_0x3237dc[_0x5e27c7(0x80d)])/(0x3e8*0x3c);if(_0x219398<_0x109044){console[_0x5e27c7(0xe72)](_0x5e27c7(0xa34)+_0x3237dc['name']+_0x5e27c7(0xcd));return;}}const {proxyUrl:_0x36ed0a,apiKey:_0x24d8ed,model:_0x1955f8}=_0x41df36[_0x5e27c7(0x673)];if(!_0x36ed0a||!_0x24d8ed||!_0x1955f8)return;const _0x98b3c=_0x3237dc[_0x5e27c7(0x886)]['myNickname']||'我',_0x33895e=new Date();let _0x75d5c8;const _0x34fd9c=_0x3237dc[_0x5e27c7(0xd08)][_0x5e27c7(0x98a)](_0x32bb2a=>!_0x32bb2a[_0x5e27c7(0xbc5)])[_0x5e27c7(0x1368)](-0x5),_0xdc11e1=_0x34fd9c[_0x5e27c7(0xd12)](_0x1432c7=>_0x1432c7[_0x5e27c7(0xa6b)]===_0x5e27c7(0xf55)&&!_0x1432c7[_0x5e27c7(0x1010)]);if(_0xdc11e1){const _0x4447ce=_0x54d0ab(_0x3237dc,_0xdc11e1[_0x5e27c7(0x4c5)]);console[_0x5e27c7(0xe72)](_0x5e27c7(0xf3e)+_0x3237dc[_0x5e27c7(0x461)]+_0x5e27c7(0x8b9)),_0x75d5c8='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“'+_0x4447ce+_0x5e27c7(0xbd7)+_0xdc11e1[_0x5e27c7(0x3b7)]+'）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20'+_0xdc11e1[_0x5e27c7(0x3b7)]+'}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}else{let _0x39c09e='';const _0x29954f=_0x3237dc[_0x5e27c7(0x886)][_0x5e27c7(0xa74)]||_0x5e27c7(0xc36),_0x455e95=_0x33895e[_0x5e27c7(0xa2b)]('zh-CN',{'timeZone':_0x29954f,'dateStyle':_0x5e27c7(0xd96),'timeStyle':_0x5e27c7(0xfc1)}),_0x41ecce=new Date(_0x33895e[_0x5e27c7(0xa2b)]('en-US',{'timeZone':_0x29954f}));if(_0x3237dc['settings'][_0x5e27c7(0xfc8)]){const _0x309d69=_0x3237dc[_0x5e27c7(0xd08)][_0x5e27c7(0x98a)](_0x982531=>!_0x982531[_0x5e27c7(0xbc5)])[_0x5e27c7(0x1368)](-0x1)[0x0];if(_0x309d69){const _0x345e25=new Date(_0x309d69[_0x5e27c7(0x3b7)]),_0x272cb5=(_0x33895e-_0x345e25)/(0x3e8*0x3c);_0x272cb5>0x3c?_0x39c09e='群里已经安静了\x20'+Math[_0x5e27c7(0xe3c)](_0x272cb5/0x3c)+_0x5e27c7(0x666):_0x39c09e=_0x5e27c7(0x11d6)+Math[_0x5e27c7(0xdee)](_0x272cb5)+_0x5e27c7(0xf13);}else _0x39c09e=_0x5e27c7(0x103a);}let _0xe5450='你们最近没有有效聊天记录。';const _0x1fb904=_0x3237dc[_0x5e27c7(0x886)][_0x5e27c7(0x1138)]||0xa,_0x3f4496=_0x3237dc[_0x5e27c7(0xd08)][_0x5e27c7(0x98a)](_0x4814b4=>!_0x4814b4[_0x5e27c7(0xbc5)])[_0x5e27c7(0x1368)](-_0x1fb904);_0x3f4496['length']>0x0&&(_0xe5450=_0x5e27c7(0x1210)+_0x3f4496[_0x5e27c7(0xa79)](_0x3d5d6b=>{const _0x28912f=_0x5e27c7,_0x243b79=_0x3d5d6b[_0x28912f(0x10ff)]===_0x28912f(0x66e)?_0x98b3c:_0x54d0ab(_0x3237dc,_0x3d5d6b['senderName']),_0x37f38c=String(_0x3d5d6b[_0x28912f(0x11b6)]||_0x3d5d6b['message']||'')[_0x28912f(0xba5)](0x0,0x32);return _0x243b79+':\x20'+_0x37f38c+_0x28912f(0x1026);})[_0x5e27c7(0xa35)]('\x0a'));const _0x3e8cb7=_0x3237dc['members']['map'](_0x49511d=>_0x5e27c7(0x71b)+_0x49511d['groupNickname']+_0x5e27c7(0x40b)+_0x49511d['originalName']+_0x5e27c7(0x12a8)+_0x49511d[_0x5e27c7(0x48c)])[_0x5e27c7(0xa35)]('\x0a');let _0x391688=_0x5e27c7(0x73d),_0x3b1ae5=![];_0x3237dc['members'][_0x5e27c7(0x19c)](_0x1f4a94=>{const _0x1852bb=_0x5e27c7,_0x1eba0b=_0x41df36['chats'][_0x1f4a94['id']];_0x1eba0b&&_0x1eba0b[_0x1852bb(0x1349)]&&_0x1eba0b['longTermMemory'][_0x1852bb(0xfde)]>0x0&&(_0x391688+=_0x1852bb(0x6a4)+_0x1f4a94['groupNickname']+_0x1852bb(0xb11),_0x391688+=_0x1eba0b[_0x1852bb(0x1349)][_0x1852bb(0xa79)](_0x3e06a6=>'-\x20'+_0x3e06a6[_0x1852bb(0x11b6)])[_0x1852bb(0xa35)]('\x0a'),_0x3b1ae5=!![]);});!_0x3b1ae5&&(_0x391688+='-\x20(暂无)');let _0x67e4da='';if(_0x3237dc[_0x5e27c7(0x886)]['linkedWorldBookIds']&&_0x3237dc['settings']['linkedWorldBookIds'][_0x5e27c7(0xfde)]>0x0){const _0x402448=_0x3237dc['settings']['linkedWorldBookIds'][_0x5e27c7(0xa79)](_0x30a045=>{const _0x34316e=_0x5e27c7,_0x40879c=_0x41df36[_0x34316e(0xf17)][_0x34316e(0xd12)](_0x23aec7=>_0x23aec7['id']===_0x30a045);if(!_0x40879c||!Array[_0x34316e(0x565)](_0x40879c['content']))return'';const _0x2612a1=_0x40879c[_0x34316e(0x11b6)][_0x34316e(0x98a)](_0x19fa44=>_0x19fa44[_0x34316e(0x8e4)]!==![])['map'](_0x2a16b2=>{const _0x50c4ef=_0x34316e;let _0xb4c584='\x0a###\x20条目:\x20'+(_0x2a16b2[_0x50c4ef(0x125b)]||_0x50c4ef(0x138b))+'\x0a';return _0x2a16b2['keys'][_0x50c4ef(0xfde)]>0x0&&(_0xb4c584+='**关键词:**\x20'+_0x2a16b2['keys'][_0x50c4ef(0xa35)](',\x20')+'\x0a'),_0xb4c584+=_0x50c4ef(0x37e)+_0x2a16b2['content'],_0xb4c584;})[_0x34316e(0xa35)]('');return _0x2612a1?'\x0a\x0a##\x20世界书:\x20'+_0x40879c['name']+'\x0a'+_0x2612a1:'';})['filter'](Boolean)[_0x5e27c7(0xa35)]('');_0x402448&&(_0x67e4da=_0x5e27c7(0xec1)+_0x402448+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x5ad844='';const _0x7013c4=_0x3237dc[_0x5e27c7(0x886)]['linkedMemoryCount']||0xa;if(_0x3237dc[_0x5e27c7(0x886)][_0x5e27c7(0x20c)]&&_0x3237dc['settings'][_0x5e27c7(0x20c)][_0x5e27c7(0xfde)]>0x0){const _0x336013=_0x3237dc[_0x5e27c7(0x886)]['linkedMemoryChatIds'][_0x5e27c7(0xa79)](_0x23fd95=>{const _0x129971=_0x5e27c7,_0x2c8e84=_0x41df36[_0x129971(0x864)][_0x23fd95];if(!_0x2c8e84)return null;const _0x2fe2d8=_0x2c8e84[_0x129971(0xd08)][_0x129971(0x1368)](-0x1)[0x0];return{'chat':_0x2c8e84,'latestTimestamp':_0x2fe2d8?_0x2fe2d8[_0x129971(0x3b7)]:0x0};})['filter'](Boolean);_0x336013[_0x5e27c7(0x1296)]((_0x182ae7,_0xcd9bf3)=>_0xcd9bf3[_0x5e27c7(0x1d0)]-_0x182ae7['latestTimestamp']),_0x5ad844+=_0x5e27c7(0xce7);for(const _0x547544 of _0x336013){const _0x57c006=_0x547544[_0x5e27c7(0x135e)],_0x14cb88=_0x57c006[_0x5e27c7(0x1a2)]?'[群聊]':'[私聊]',_0xb07859=_0x547544[_0x5e27c7(0x1d0)]>0x0?_0x5e27c7(0x713)+_0xa3fdac(_0x547544[_0x5e27c7(0x1d0)])+')':'';_0x5ad844+=_0x5e27c7(0x11fe)+_0x14cb88+'“'+_0x57c006[_0x5e27c7(0x461)]+_0x5e27c7(0x5aa)+_0xb07859+_0x5e27c7(0x1090);const _0x3aa851=_0x57c006[_0x5e27c7(0xd08)]['slice'](-_0x7013c4),_0x270363=_0x3aa851[_0x5e27c7(0x98a)](_0x2805b8=>!String(_0x2805b8[_0x5e27c7(0x11b6)])[_0x5e27c7(0xee2)](_0x5e27c7(0x1266)));_0x270363['length']>0x0?_0x270363[_0x5e27c7(0x19c)](_0x5be049=>{const _0x370944=_0x5e27c7,_0x4a87da=_0x5be049[_0x370944(0x10ff)]===_0x370944(0x66e)?_0x57c006[_0x370944(0x886)]['myNickname']||'我':_0x5be049[_0x370944(0x4c5)]||_0x57c006[_0x370944(0x461)];let _0x9b69c3=String(_0x5be049[_0x370944(0x11b6)]);if(_0x5be049[_0x370944(0xa6b)]===_0x370944(0x1050)||_0x5be049[_0x370944(0xa6b)]===_0x370944(0xed0))_0x9b69c3=_0x370944(0x134a)+_0x5be049[_0x370944(0x11b6)]+']';else _0x5be049[_0x370944(0xa6b)]==='voice_message'&&(_0x9b69c3='[发送了一条语音，内容是：'+_0x5be049['content']+']');_0x5ad844+=_0x4a87da+':\x20'+_0x9b69c3+'\x0a';}):_0x5ad844+=_0x5e27c7(0x1249);}}const _0x57ff9c=await _0x342df8['qzonePosts'][_0x5e27c7(0x4b1)](_0x5e27c7(0x3b7))['reverse']()[_0x5e27c7(0xc33)](0x5)[_0x5e27c7(0x21f)]();let _0xefaba8='';const _0x242423=new Set();for(const _0x13a1a9 of _0x3237dc['members']){const _0x13ea51=_0x41df36[_0x5e27c7(0x864)][_0x13a1a9['id']];if(_0x13ea51){const _0x21a6bc=_0x29938a(_0x57ff9c,_0x13ea51);_0x21a6bc[_0x5e27c7(0x19c)](_0x52f12d=>_0x242423[_0x5e27c7(0xbff)](_0x52f12d));}}const _0x57000d=new Set(_0x3237dc[_0x5e27c7(0x12a6)]['map'](_0x5a315f=>_0x5a315f[_0x5e27c7(0x283)])),_0x420c4d=[..._0x242423]['filter'](_0x5182e5=>{const _0x14134e=_0x5e27c7,_0x100755=_0x5182e5[_0x14134e(0x133c)]&&_0x5182e5[_0x14134e(0x133c)]['some'](_0x221861=>_0x57000d['has'](_0x221861)),_0x292768=_0x5182e5[_0x14134e(0xcad)]&&_0x5182e5['comments'][_0x14134e(0x12fb)](_0x31e24a=>typeof _0x31e24a==='object'&&_0x57000d['has'](_0x31e24a[_0x14134e(0xbb)]));return!_0x100755&&!_0x292768;});if(_0x420c4d[_0x5e27c7(0xfde)]>0x0){let _0x5b0048='\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a';for(const _0x3af05d of _0x420c4d){let _0x28b5de=_0x3af05d[_0x5e27c7(0x1301)]===_0x5e27c7(0x66e)?_0x98b3c:_0x41df36[_0x5e27c7(0x864)][_0x3af05d[_0x5e27c7(0x1301)]]?.[_0x5e27c7(0x461)]||'一位朋友',_0x5eef6f;if(_0x3af05d[_0x5e27c7(0xa6b)]===_0x5e27c7(0xcf0)){const _0xa792ac=_0x3af05d[_0x5e27c7(0x1051)]?_0x5e27c7(0x359)+_0x3af05d[_0x5e27c7(0x1051)]+'”':'';let _0xf7ddbd=_0x5e27c7(0x12ba);const _0x2eb1b4=_0x3af05d['originalPost'][_0x5e27c7(0x1301)];if(_0x2eb1b4==='user')_0xf7ddbd=_0x41df36['qzoneSettings']['nickname'];else _0x41df36[_0x5e27c7(0x864)][_0x2eb1b4]&&(_0xf7ddbd=_0x41df36[_0x5e27c7(0x864)][_0x2eb1b4][_0x5e27c7(0x461)]);let _0x191916;const _0x5f2709=_0x3af05d[_0x5e27c7(0xba8)];if(_0x5f2709['type']===_0x5e27c7(0x68e))_0x191916=_0x5e27c7(0xee0)+(_0x5f2709[_0x5e27c7(0xbdc)]||'')+_0x5e27c7(0xc6)+(_0x5f2709[_0x5e27c7(0x4e6)]||'')[_0x5e27c7(0xba5)](0x0,0x28)+_0x5e27c7(0x113c);else _0x5f2709[_0x5e27c7(0xa6b)]===_0x5e27c7(0xe9d)?_0x191916=_0x5e27c7(0x6b4)+(_0x5f2709[_0x5e27c7(0xbdc)]||'')+_0x5e27c7(0xc6)+(_0x5f2709[_0x5e27c7(0x8cf)]||'')[_0x5e27c7(0xba5)](0x0,0x28)+_0x5e27c7(0x113c):_0x191916='“'+(_0x5f2709[_0x5e27c7(0x11b6)]||'')[_0x5e27c7(0xba5)](0x0,0x28)+_0x5e27c7(0xd61);_0x5eef6f=_0x5e27c7(0xf51)+_0xf7ddbd+_0x5e27c7(0x11e1)+_0xa792ac+_0x5e27c7(0xb80)+_0x191916+'】';}else{if(_0x3af05d[_0x5e27c7(0xa6b)]===_0x5e27c7(0x68e))_0x5eef6f=(_0x5e27c7(0xcc2)+_0x3af05d[_0x5e27c7(0x4e6)]+_0x5e27c7(0x6ae)+(_0x3af05d[_0x5e27c7(0xbdc)]||''))[_0x5e27c7(0xba5)](0x0,0x32)+_0x5e27c7(0x1026);else _0x3af05d[_0x5e27c7(0xa6b)]===_0x5e27c7(0xe9d)?_0x5eef6f=('[一张图片，描述为：“'+_0x3af05d['imageDescription']+'”]\x20'+(_0x3af05d[_0x5e27c7(0xbdc)]||''))[_0x5e27c7(0xba5)](0x0,0x32)+_0x5e27c7(0x1026):_0x5eef6f=String(_0x3af05d[_0x5e27c7(0xbdc)]||_0x3af05d[_0x5e27c7(0x11b6)]||_0x5e27c7(0x199))[_0x5e27c7(0xba5)](0x0,0x32)+_0x5e27c7(0x1026);}_0x5b0048+=_0x5e27c7(0x85e)+_0x3af05d['id']+_0x5e27c7(0xe61)+_0x28b5de+',\x20内容:\x20\x22'+_0x5eef6f+'\x22\x0a';if(_0x3af05d[_0x5e27c7(0xcad)]&&_0x3af05d[_0x5e27c7(0xcad)]['length']>0x0)for(const _0x45c8d0 of _0x3af05d[_0x5e27c7(0xcad)]){if(typeof _0x45c8d0===_0x5e27c7(0x890)&&_0x45c8d0[_0x5e27c7(0xbb)]){const _0x373a0c=_0x5641f2(_0x45c8d0[_0x5e27c7(0xbb)]);let _0x4be057=_0x45c8d0['meaning']?'[表情:\x20\x27'+_0x45c8d0[_0x5e27c7(0x7de)]+'\x27]':_0x45c8d0[_0x5e27c7(0x6af)];_0x5b0048+='\x20\x20-\x20评论:\x20'+_0x373a0c+_0x5e27c7(0xcac)+_0x45c8d0[_0x5e27c7(0xbb)]+'):\x20'+_0x4be057+'\x0a';}}}_0xefaba8=_0x5b0048;}const _0x576a2=_0x1ad6bb(_0x3237dc,0x3,'hours'),_0x2b500c=_0x1ad6bb(_0x3237dc,0x6,_0x5e27c7(0x2f2)),_0x221f98=_0x1ad6bb(_0x3237dc,0x9,_0x5e27c7(0x2f2)),_0x5e953f=_0x1ad6bb(_0x3237dc,0x1,_0x5e27c7(0x103b)),_0x472c26=_0x1ad6bb(_0x3237dc,0x3,_0x5e27c7(0x103b)),_0x3a8aac=_0x1ad6bb(_0x3237dc,0x7,'days');let _0x19f771='';if(_0x576a2||_0x2b500c||_0x221f98||_0x5e953f||_0x472c26||_0x3a8aac){_0x19f771+=_0x5e27c7(0xf2a);if(_0x576a2)_0x19f771+=_0x576a2;if(_0x2b500c)_0x19f771+=_0x2b500c;if(_0x221f98)_0x19f771+=_0x221f98;if(_0x576a2||_0x2b500c||_0x221f98)_0x19f771+='\x0a';if(_0x5e953f)_0x19f771+=_0x5e953f;if(_0x472c26)_0x19f771+=_0x472c26;if(_0x3a8aac)_0x19f771+=_0x3a8aac;}const _0x24210d=_0x37dbe7(_0x3237dc);_0x75d5c8='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“'+_0x3237dc[_0x5e27c7(0x461)]+_0x5e27c7(0x5f6)+(_0x3237dc['settings'][_0x5e27c7(0xfc8)]?_0x5e27c7(0x1003)+_0x455e95+'。':'')+_0x5e27c7(0x602)+(_0x39c09e?_0x39c09e+'\x20':'')+_0x5e27c7(0x167)+_0x391688+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22'+_0x98b3c+_0x5e27c7(0xca7)+_0x3237dc[_0x5e27c7(0x461)]+_0x5e27c7(0x602)+_0x67e4da+_0x5e27c7(0xe04)+(_0x3237dc[_0x5e27c7(0x1349)]&&_0x3237dc['longTermMemory'][_0x5e27c7(0xfde)]>0x0?_0x3237dc[_0x5e27c7(0x1349)]['map'](_0x5e9c1f=>'-\x20'+_0x5e9c1f[_0x5e27c7(0x11b6)])['join']('\x0a'):_0x5e27c7(0x7ae))+_0x5e27c7(0x371)+_0x19f771+_0x5e27c7(0x602)+_0x5ad844+_0x5e27c7(0x902)+_0x3e8cb7+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x24210d+_0x5e27c7(0x245)+_0x98b3c+'**:\x20'+_0x3237dc['settings'][_0x5e27c7(0xe63)]+_0x5e27c7(0x180)+_0xe5450+_0x5e27c7(0x1de)+_0xefaba8+_0x5e27c7(0x1326);}const _0x361870=_0x3237dc[_0x5e27c7(0xd08)][_0x5e27c7(0x98a)](_0x19477c=>!_0x19477c[_0x5e27c7(0xbc5)])[_0x5e27c7(0x1368)](-0xa),_0x2f3f63=[{'role':_0x5e27c7(0xb1),'content':_0x75d5c8},..._0x361870['map'](_0x54fe43=>{const _0x17d08f=_0x5e27c7,_0x8b1425=_0x54fe43[_0x17d08f(0x10ff)]===_0x17d08f(0x66e)?_0x98b3c:_0x54d0ab(_0x3237dc,_0x54fe43[_0x17d08f(0x4c5)]);let _0x2f98a2=_0x54fe43[_0x17d08f(0x11b6)];if(_0x54fe43[_0x17d08f(0xa6b)]===_0x17d08f(0x1050)||_0x54fe43['type']===_0x17d08f(0xed0))_0x2f98a2='[发送了一张图片，描述为：\x27'+_0x54fe43[_0x17d08f(0x11b6)]+'\x27]';else{if(_0x54fe43[_0x17d08f(0xa6b)]===_0x17d08f(0xa4f))_0x2f98a2=_0x17d08f(0x1b5)+_0x54fe43[_0x17d08f(0x11b6)]+'\x27]';else typeof _0x2f98a2!=='string'&&(_0x2f98a2='[发送了一条复杂消息，如卡片或转账]');}return{'role':_0x17d08f(0x66e),'content':_0x8b1425+':\x20'+_0x2f98a2};})];try{const _0x29eca0=[{'role':_0x5e27c7(0x66e),'content':_0x75d5c8}];let _0x58e320=_0x36ed0a===GEMINI_API_URL,_0xa44b26=_0x112768(_0x1955f8,_0x24d8ed,_0x75d5c8,_0x29eca0);const _0x19bd29=_0x58e320?await fetch(_0xa44b26[_0x5e27c7(0x2fa)],_0xa44b26[_0x5e27c7(0x8c6)]):await fetch(_0x36ed0a+_0x5e27c7(0x126b),{'method':_0x5e27c7(0x94f),'headers':{'Content-Type':_0x5e27c7(0x11f0),'Authorization':'Bearer\x20'+_0x24d8ed},'body':JSON[_0x5e27c7(0x3fb)]({'model':_0x1955f8,'messages':_0x29eca0,'temperature':_0x41df36[_0x5e27c7(0xc0)][_0x5e27c7(0xa4a)]||0.9})});if(!_0x19bd29['ok'])throw new Error((await _0x19bd29[_0x5e27c7(0x9b3)]())[_0x5e27c7(0x98)][_0x5e27c7(0x5f8)]);const _0xaa2839=await _0x19bd29['json'](),_0x27881a=_0x58e320?_0xaa2839[_0x5e27c7(0x5fa)][0x0][_0x5e27c7(0x11b6)]['parts'][0x0]['text']:_0xaa2839[_0x5e27c7(0xe77)][0x0][_0x5e27c7(0x5f8)][_0x5e27c7(0x11b6)],_0x1409b3=_0x28b8fa(_0x27881a);if(!_0x1409b3||_0x1409b3[_0x5e27c7(0xfde)]===0x0){console[_0x5e27c7(0x17b)](_0x5e27c7(0xa34)+_0x3237dc[_0x5e27c7(0x461)]+'\x22\x20的独立行动API返回为空或格式不正确，本次跳过。');return;}let _0x1515b9=Date[_0x5e27c7(0x108d)](),_0x345bbb=![],_0x5d0184='',_0x58df9d='';const _0x325102=[];for(const _0x14def2 of _0x1409b3){const _0x17e0e4=String(_0x14def2[_0x5e27c7(0x11b6)]||''),_0x35921f=_0x17e0e4[_0x5e27c7(0x1cb)]()[_0x5e27c7(0x1122)]('<')&&_0x17e0e4[_0x5e27c7(0x1cb)]()[_0x5e27c7(0xd47)]('>');if(_0x14def2['type']===_0x5e27c7(0x6af)&&!_0x35921f&&_0x17e0e4[_0x5e27c7(0xee2)]('\x0a')){const _0x3cd6ee=_0x17e0e4[_0x5e27c7(0x105d)](/\n+/)['filter'](_0x28baf7=>_0x28baf7['trim']());_0x3cd6ee[_0x5e27c7(0x19c)](_0x47198e=>{const _0x6174b8=_0x5e27c7;_0x325102[_0x6174b8(0x258)]({..._0x14def2,'content':_0x47198e});});}else _0x325102[_0x5e27c7(0x258)](_0x14def2);}for(const _0x3c39d0 of _0x325102){if(!_0x3c39d0||!_0x3c39d0['type']||!_0x3c39d0[_0x5e27c7(0x461)])continue;const _0x3e7a0b=_0x54d0ab(_0x3237dc,_0x3c39d0[_0x5e27c7(0x461)]);let _0x27a190=null,_0x51b6e2=null;const _0x36f9c7={'role':_0x5e27c7(0xf3c),'senderName':_0x3c39d0[_0x5e27c7(0x461)],'timestamp':_0x1515b9++};if(_0x3c39d0[_0x5e27c7(0xa6b)]===_0x5e27c7(0x136f)){const _0x59b374=_0x3237dc['history'][_0x5e27c7(0xd12)](_0x2ec321=>_0x2ec321[_0x5e27c7(0x3b7)]===_0x3c39d0[_0x5e27c7(0x2d5)]);if(_0x59b374&&!_0x59b374['isFullyClaimed']&&!(_0x59b374[_0x5e27c7(0xb39)]&&_0x59b374[_0x5e27c7(0xb39)][_0x3c39d0[_0x5e27c7(0x461)]])){let _0x864756=0x0;const _0x3706b0=_0x59b374['totalAmount']-Object[_0x5e27c7(0x76d)](_0x59b374['claimedBy']||{})[_0x5e27c7(0xf60)]((_0x2514cd,_0x1aec6c)=>_0x2514cd+_0x1aec6c,0x0),_0x56c9e0=_0x59b374[_0x5e27c7(0x779)]-Object[_0x5e27c7(0x66b)](_0x59b374['claimedBy']||{})[_0x5e27c7(0xfde)];if(_0x56c9e0>0x0){if(_0x56c9e0===0x1)_0x864756=_0x3706b0;else{const _0xbca2a2=0.01,_0xea876d=_0x3706b0-(_0x56c9e0-0x1)*_0xbca2a2;_0x864756=Math['random']()*(_0xea876d-_0xbca2a2)+_0xbca2a2;}_0x864756=parseFloat(_0x864756[_0x5e27c7(0x70d)](0x2));if(!_0x59b374[_0x5e27c7(0xb39)])_0x59b374[_0x5e27c7(0xb39)]={};_0x59b374['claimedBy'][_0x3c39d0[_0x5e27c7(0x461)]]=_0x864756,_0x3237dc['history'][_0x5e27c7(0x258)]({'role':_0x5e27c7(0xb1),'type':_0x5e27c7(0xed8),'content':_0x3e7a0b+'\x20领取了\x20'+_0x54d0ab(_0x3237dc,_0x59b374['senderName'])+'\x20的红包','timestamp':Date[_0x5e27c7(0x108d)]()});let _0x351e36=_0x5e27c7(0x989)+_0x3e7a0b+_0x5e27c7(0x753)+_0x864756[_0x5e27c7(0x70d)](0x2)+_0x5e27c7(0x111b);if(Object[_0x5e27c7(0x66b)](_0x59b374[_0x5e27c7(0xb39)])[_0x5e27c7(0xfde)]>=_0x59b374[_0x5e27c7(0x779)]){_0x59b374[_0x5e27c7(0x1010)]=!![],_0x3237dc[_0x5e27c7(0xd08)][_0x5e27c7(0x258)]({'role':'system','type':_0x5e27c7(0xed8),'content':_0x54d0ab(_0x3237dc,_0x59b374[_0x5e27c7(0x4c5)])+'\x20的红包已被领完','timestamp':Date[_0x5e27c7(0x108d)]()+0x1});let _0x2c62d9={'name':'','amount':-0x1};Object['entries'](_0x59b374[_0x5e27c7(0xb39)])[_0x5e27c7(0x19c)](([_0x249253,_0x24d0bf])=>{const _0x184eb0=_0x5e27c7;_0x24d0bf>_0x2c62d9[_0x184eb0(0xe27)]&&(_0x2c62d9={'name':_0x249253,'amount':_0x24d0bf});});if(_0x2c62d9[_0x5e27c7(0x461)]){const _0xda9f22=_0x54d0ab(_0x3237dc,_0x2c62d9[_0x5e27c7(0x461)]);_0x351e36+=_0x5e27c7(0x9d1)+_0xda9f22+'！';}}_0x351e36+=_0x5e27c7(0x2de),_0x3237dc[_0x5e27c7(0xd08)][_0x5e27c7(0x258)]({'role':_0x5e27c7(0xb1),'content':_0x351e36,'timestamp':Date['now']()+0x2,'isHidden':!![]});}}_0x345bbb=!![];continue;}switch(_0x3c39d0['type']){case _0x5e27c7(0x37d):if(_0x3c39d0['meaning']){const _0x235a8f=_0x41df36[_0x5e27c7(0x823)][_0x5e27c7(0xd12)](_0x37bde1=>_0x37bde1[_0x5e27c7(0x461)]===_0x3c39d0[_0x5e27c7(0x7de)]);_0x235a8f?_0x51b6e2={..._0x36f9c7,'type':_0x5e27c7(0x37d),'content':_0x235a8f['url'],'meaning':_0x235a8f[_0x5e27c7(0x461)]}:(console[_0x5e27c7(0x17b)](_0x5e27c7(0x5a0)+_0x3c39d0[_0x5e27c7(0x7de)]+'\x22'),_0x51b6e2={..._0x36f9c7,'type':_0x5e27c7(0x6af),'content':_0x5e27c7(0x261)+_0x3c39d0[_0x5e27c7(0x7de)]+']'});}else console[_0x5e27c7(0x17b)](_0x5e27c7(0x817),_0x3c39d0),_0x51b6e2={..._0x36f9c7,'type':'sticker','content':_0x3c39d0[_0x5e27c7(0x2fa)],'meaning':_0x5e27c7(0x2a8)};break;case _0x5e27c7(0xd91):const _0x1130e1={'type':_0x3c39d0[_0x5e27c7(0x122f)]||_0x5e27c7(0x23e),'content':_0x3c39d0[_0x5e27c7(0x11b6)],'timestamp':Date[_0x5e27c7(0x108d)](),'authorId':_0x41df36[_0x5e27c7(0x864)][Object['keys'](_0x41df36[_0x5e27c7(0x864)])[_0x5e27c7(0xd12)](_0x13033e=>_0x41df36[_0x5e27c7(0x864)][_0x13033e]['originalName']===_0x3c39d0[_0x5e27c7(0x461)])]?.['id']||_0x3c39d0[_0x5e27c7(0x461)],'authorOriginalName':_0x3c39d0[_0x5e27c7(0x461)],'visibleGroupIds':null};await _0x342df8['qzonePosts']['add'](_0x1130e1),_0x4c6ee1(_0x3a006f+0x1),_0x27a190={'content':'['+_0x3e7a0b+_0x5e27c7(0xae8)};break;case _0x5e27c7(0xc1b):const _0x5bd59e=await _0x342df8[_0x5e27c7(0x35a)][_0x5e27c7(0x1a3)](parseInt(_0x3c39d0[_0x5e27c7(0x6b1)]));if(_0x5bd59e){if(!_0x5bd59e['comments'])_0x5bd59e[_0x5e27c7(0xcad)]=[];_0x5bd59e[_0x5e27c7(0xcad)][_0x5e27c7(0x258)]({'commenterName':_0x3c39d0[_0x5e27c7(0x461)],'text':_0x3c39d0[_0x5e27c7(0xb3a)],'timestamp':Date[_0x5e27c7(0x108d)]()}),await _0x342df8[_0x5e27c7(0x35a)][_0x5e27c7(0xaf9)](_0x5bd59e['id'],{'comments':_0x5bd59e[_0x5e27c7(0xcad)]}),_0x4c6ee1(_0x3a006f+0x1),_0x27a190={'content':'['+_0x3e7a0b+_0x5e27c7(0xa87)};}break;case _0x5e27c7(0x121):const _0x51c3d9=await _0x342df8[_0x5e27c7(0x35a)][_0x5e27c7(0x1a3)](parseInt(_0x3c39d0[_0x5e27c7(0x6b1)]));if(_0x51c3d9){if(!_0x51c3d9[_0x5e27c7(0x133c)])_0x51c3d9['likes']=[];!_0x51c3d9[_0x5e27c7(0x133c)][_0x5e27c7(0xee2)](_0x3c39d0[_0x5e27c7(0x461)])&&(_0x51c3d9[_0x5e27c7(0x133c)][_0x5e27c7(0x258)](_0x3c39d0[_0x5e27c7(0x461)]),await _0x342df8[_0x5e27c7(0x35a)]['update'](_0x51c3d9['id'],{'likes':_0x51c3d9[_0x5e27c7(0x133c)]}),_0x4c6ee1(_0x3a006f+0x1),_0x27a190={'content':'['+_0x3e7a0b+_0x5e27c7(0xb3b)});}break;case _0x5e27c7(0x1050):_0x51b6e2={..._0x36f9c7,'type':_0x5e27c7(0x1050),'content':_0x3c39d0[_0x5e27c7(0xee1)],'image_prompt':msgData[_0x5e27c7(0x8d8)]};break;default:if(_0x3c39d0[_0x5e27c7(0xa6b)]==='poll'){const _0x5d74ee=typeof _0x3c39d0[_0x5e27c7(0x904)]===_0x5e27c7(0xafa)?_0x3c39d0[_0x5e27c7(0x904)][_0x5e27c7(0x105d)]('\x0a')[_0x5e27c7(0x98a)](_0x103110=>_0x103110[_0x5e27c7(0x1cb)]()):Array[_0x5e27c7(0x565)](_0x3c39d0[_0x5e27c7(0x904)])?_0x3c39d0[_0x5e27c7(0x904)]:[];if(_0x5d74ee['length']<0x2)continue;_0x51b6e2={..._0x36f9c7,..._0x3c39d0,'options':_0x5d74ee,'votes':{},'isClosed':![]};}else{const _0x427f44=_0x3c39d0[_0x5e27c7(0x11b6)]||_0x3c39d0[_0x5e27c7(0x5f8)];_0x51b6e2={..._0x36f9c7,..._0x3c39d0};if(_0x427f44)_0x51b6e2[_0x5e27c7(0x11b6)]=_0x427f44;}break;}if(_0x27a190)_0x3237dc['history'][_0x5e27c7(0x258)]({'role':_0x5e27c7(0xb1),'type':'pat_message','content':_0x27a190[_0x5e27c7(0x11b6)],'timestamp':_0x1515b9++});else _0x51b6e2&&(_0x3237dc[_0x5e27c7(0xd08)][_0x5e27c7(0x258)](_0x51b6e2),!_0x58df9d&&(_0x58df9d=_0x3e7a0b,_0x5d0184=_0x51b6e2[_0x5e27c7(0xa6b)]===_0x5e27c7(0x1050)?_0x5e27c7(0x1167):_0x51b6e2[_0x5e27c7(0x11b6)]||'['+_0x51b6e2[_0x5e27c7(0xa6b)]+']'));_0x345bbb=!![];}_0x345bbb&&(_0x3237dc[_0x5e27c7(0x80d)]=Date[_0x5e27c7(0x108d)](),_0x3237dc[_0x5e27c7(0x40c)]=(_0x3237dc[_0x5e27c7(0x40c)]||0x0)+_0x1409b3[_0x5e27c7(0x98a)](_0x47fbd6=>_0x47fbd6[_0x5e27c7(0xa6b)]!=='qzone_post'&&_0x47fbd6[_0x5e27c7(0xa6b)]!==_0x5e27c7(0xc1b)&&_0x47fbd6[_0x5e27c7(0xa6b)]!==_0x5e27c7(0x121))[_0x5e27c7(0xfde)],_0x58df9d&&_0x5d0184&&_0x193863(_0x6711d4,_0x58df9d+':\x20'+_0x5d0184),await _0x342df8[_0x5e27c7(0x864)][_0x5e27c7(0x9c0)](_0x3237dc));}catch(_0x16d265){console[_0x5e27c7(0x98)](_0x5e27c7(0xa34)+_0x3237dc[_0x5e27c7(0x461)]+_0x5e27c7(0x8b4),_0x16d265);}finally{_0x25558e();}}function _0x5810fc(_0x2e6762,_0x32f71b,_0x308209){const _0x32c2eb=_0x549949,_0x1e81e5=document[_0x32c2eb(0x383)](_0x308209);if(!_0x1e81e5)return;if(!_0x2e6762||_0x2e6762['trim']()===''){_0x1e81e5[_0x32c2eb(0x45c)]='';return;}const _0x333d38=_0x2e6762[_0x32c2eb(0x709)](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x32f71b+_0x32c2eb(0x98d))[_0x32c2eb(0x709)](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x32f71b+_0x32c2eb(0x11ed))['replace'](/\s*\.message-bubble\s+([^{]+\{)/g,_0x32f71b+_0x32c2eb(0xf6e));_0x1e81e5['innerHTML']=_0x333d38;}async function _0x24c0e3(){const _0x575e75=_0x549949;if(!_0x41df36[_0x575e75(0xfc5)])return;const _0x123222=_0x41df36[_0x575e75(0x864)][_0x41df36[_0x575e75(0xfc5)]],_0x436389=document[_0x575e75(0x383)](_0x575e75(0xd7));if(!_0x436389)return;const _0xdc5503=document[_0x575e75(0x89c)](_0x575e75(0xf1))?.['value']||'default',_0x40d37a=document[_0x575e75(0x383)](_0x575e75(0xeb2))[_0x575e75(0x1be)],_0x1beb28=document[_0x575e75(0x383)](_0x575e75(0x9fe))[_0x575e75(0x1be)],_0x2624f3=_0x123222[_0x575e75(0x886)][_0x575e75(0x415)];_0x436389['dataset'][_0x575e75(0x53f)]=_0xdc5503,_0x436389['style']['setProperty'](_0x575e75(0x1df),_0x40d37a+'px');_0x2624f3&&_0x2624f3[_0x575e75(0x1122)](_0x575e75(0x446))?(_0x436389[_0x575e75(0x655)][_0x575e75(0x880)]=_0x575e75(0xb9a)+_0x2624f3+')',_0x436389[_0x575e75(0x655)][_0x575e75(0x8fc)]='transparent'):(_0x436389[_0x575e75(0x655)][_0x575e75(0x880)]=_0x575e75(0xa70),_0x436389[_0x575e75(0x655)][_0x575e75(0x415)]=_0x2624f3||'#f0f2f5');_0x436389[_0x575e75(0x45c)]='';const _0xa895ec={'role':'ai','content':_0x575e75(0x139b),'timestamp':0x1,'senderName':_0x123222['name']},_0x31bb39=await _0x152d98(_0xa895ec,_0x123222);if(_0x31bb39)_0x436389[_0x575e75(0xe91)](_0x31bb39);const _0x2bee56={'role':_0x575e75(0x66e),'content':_0x575e75(0xf91),'timestamp':0x2},_0x2cc36d=await _0x152d98(_0x2bee56,_0x123222);if(_0x2cc36d)_0x436389[_0x575e75(0xe91)](_0x2cc36d);const _0x1272bd=document[_0x575e75(0xe1b)](_0x575e75(0x7fd));_0x1272bd[_0x575e75(0x655)][_0x575e75(0x1ae)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1272bd['textContent']='♪\x20歌词位置预览\x20♪',_0x436389[_0x575e75(0xe91)](_0x1272bd);const _0x416f3d=document[_0x575e75(0x383)](_0x575e75(0x734))[_0x575e75(0x1be)],_0x5e22c1=document[_0x575e75(0x383)](_0x575e75(0x7f3))[_0x575e75(0x1be)],_0x56f6dd=parseInt(document[_0x575e75(0x383)](_0x575e75(0x9a3))[_0x575e75(0x1be)])||0xa;_0x416f3d===_0x575e75(0x994)?_0x1272bd[_0x575e75(0x655)][_0x575e75(0x994)]=_0x56f6dd+'px':_0x1272bd[_0x575e75(0x655)][_0x575e75(0xbe3)]=_0x56f6dd+'px';switch(_0x5e22c1){case _0x575e75(0x402):_0x1272bd[_0x575e75(0x655)]['left']=_0x575e75(0x4bb);break;case _0x575e75(0xa12):_0x1272bd[_0x575e75(0x655)][_0x575e75(0xa12)]=_0x575e75(0x4bb);break;default:_0x1272bd[_0x575e75(0x655)][_0x575e75(0x402)]='50%',_0x1272bd[_0x575e75(0x655)][_0x575e75(0x923)]=_0x575e75(0xcab);break;}_0x5810fc(_0x1beb28,_0x575e75(0x12dc),_0x575e75(0x1330));}async function _0x504b13(){const _0x4f7317=_0x549949;await _0x3a4f3d(),document[_0x4f7317(0x383)](_0x4f7317(0x9ff))[_0x4f7317(0x119a)][_0x4f7317(0xbff)](_0x4f7317(0x106d));}async function _0x3a4f3d(){const _0x3db5e2=_0x549949,_0x124aba=document[_0x3db5e2(0x383)](_0x3db5e2(0x2f0)),_0x28483f=await _0x342df8['qzoneGroups'][_0x3db5e2(0x21f)]();_0x124aba[_0x3db5e2(0x45c)]='',_0x28483f[_0x3db5e2(0xfde)]===0x0&&(_0x124aba['innerHTML']=_0x3db5e2(0xabc)),_0x28483f[_0x3db5e2(0x19c)](_0x727675=>{const _0x1152f0=_0x3db5e2,_0x3fd41c=document['createElement'](_0x1152f0(0x7fd));_0x3fd41c[_0x1152f0(0x556)]=_0x1152f0(0x7c0),_0x3fd41c[_0x1152f0(0x45c)]=_0x1152f0(0xeee)+_0x727675[_0x1152f0(0x461)]+_0x1152f0(0x689)+_0x727675['id']+_0x1152f0(0xd98),_0x124aba[_0x1152f0(0xe91)](_0x3fd41c);});}async function _0x2e437d(){const _0x23bd3e=_0x549949,_0x5dea00=document['getElementById'](_0x23bd3e(0x10f)),_0x4ee8d9=_0x5dea00['value'][_0x23bd3e(0x1cb)]();if(!_0x4ee8d9){alert(_0x23bd3e(0x17e));return;}const _0x200b0e=await _0x342df8[_0x23bd3e(0x108f)][_0x23bd3e(0x6bd)]('name')['equals'](_0x4ee8d9)[_0x23bd3e(0x26e)]();if(_0x200b0e){alert(_0x23bd3e(0x618)+_0x4ee8d9+_0x23bd3e(0x124a));return;}await _0x342df8[_0x23bd3e(0x108f)][_0x23bd3e(0xbff)]({'name':_0x4ee8d9}),_0x5dea00[_0x23bd3e(0x1be)]='',await _0x3a4f3d();}async function _0x35cf60(_0x5aaf22){const _0x57c959=_0x549949,_0x12489f=await _0x23a88b(_0x57c959(0x615),_0x57c959(0xb3),{'confirmButtonClass':_0x57c959(0x51b)});if(_0x12489f){await _0x342df8['qzoneGroups'][_0x57c959(0x971)](_0x5aaf22);const _0x4472ba=await _0x342df8[_0x57c959(0x864)][_0x57c959(0x6bd)](_0x57c959(0x11a6))[_0x57c959(0x5b3)](_0x5aaf22)[_0x57c959(0x21f)]();for(const _0x50b399 of _0x4472ba){_0x50b399[_0x57c959(0x11a6)]=null,await _0x342df8[_0x57c959(0x864)][_0x57c959(0x9c0)](_0x50b399);if(_0x41df36[_0x57c959(0x864)][_0x50b399['id']])_0x41df36[_0x57c959(0x864)][_0x50b399['id']][_0x57c959(0x11a6)]=null;}await _0x3a4f3d();}}function _0xe2646(_0x35072c){const _0x1c4c4a=_0x549949,_0x1b2707=_0x41df36[_0x1c4c4a(0x864)][_0x41df36[_0x1c4c4a(0xfc5)]];document['getElementById']('publish-to-announcement-btn')[_0x1c4c4a(0x655)]['display']=_0x1b2707['isGroup']?_0x1c4c4a(0x27a):_0x1c4c4a(0xa70);if(_0x80fd3b)return;_0x7c8ee8=_0x35072c,document[_0x1c4c4a(0x383)]('message-actions-modal')[_0x1c4c4a(0x119a)][_0x1c4c4a(0xbff)](_0x1c4c4a(0x106d));}function _0x29d937(){const _0xfa4c38=_0x549949;document[_0xfa4c38(0x383)](_0xfa4c38(0x429))['classList'][_0xfa4c38(0x131d)](_0xfa4c38(0x106d)),_0x7c8ee8=null;}async function _0x3daf8a(){const _0x57e82f=_0x549949;if(!_0x7c8ee8)return;const _0x34e8c0=_0x7c8ee8,_0x2f425b=_0x41df36[_0x57e82f(0x864)][_0x41df36[_0x57e82f(0xfc5)]],_0x5496d9=_0x2f425b['history']['find'](_0x9ca7cc=>_0x9ca7cc[_0x57e82f(0x3b7)]===_0x34e8c0);if(!_0x5496d9)return;_0x29d937();let _0x3c80e4;const _0x313a84=_0x5496d9[_0x57e82f(0xa6b)]&&[_0x57e82f(0xa4f),'ai_image',_0x57e82f(0x909),_0x57e82f(0x94a)][_0x57e82f(0xee2)](_0x5496d9[_0x57e82f(0xa6b)]);if(_0x313a84){let _0x4a71eb={'type':_0x5496d9[_0x57e82f(0xa6b)]};if(_0x5496d9[_0x57e82f(0xa6b)]==='voice_message')_0x4a71eb[_0x57e82f(0x11b6)]=_0x5496d9['content'];else{if(_0x5496d9[_0x57e82f(0xa6b)]===_0x57e82f(0x1050))_0x4a71eb[_0x57e82f(0xee1)]=_0x5496d9[_0x57e82f(0x11b6)];else{if(_0x5496d9[_0x57e82f(0xa6b)]==='transfer')_0x4a71eb['amount']=_0x5496d9['amount'],_0x4a71eb[_0x57e82f(0x775)]=_0x5496d9['note'];else _0x5496d9[_0x57e82f(0xa6b)]===_0x57e82f(0x94a)&&(_0x4a71eb[_0x57e82f(0xf3a)]=_0x5496d9[_0x57e82f(0xf3a)],_0x4a71eb[_0x57e82f(0xee1)]=_0x5496d9[_0x57e82f(0xee1)],_0x4a71eb[_0x57e82f(0x8d4)]=_0x5496d9[_0x57e82f(0x8d4)],_0x4a71eb['content']=_0x5496d9[_0x57e82f(0x11b6)]);}}_0x3c80e4=JSON[_0x57e82f(0x3fb)](_0x4a71eb,null,0x2);}else typeof _0x5496d9[_0x57e82f(0x11b6)]===_0x57e82f(0x890)?_0x3c80e4=JSON['stringify'](_0x5496d9[_0x57e82f(0x11b6)],null,0x2):_0x3c80e4=_0x5496d9[_0x57e82f(0x11b6)];const _0x54e3d9={'voice':{'type':'voice_message','content':_0x57e82f(0x7a7)},'image':{'type':_0x57e82f(0x1050),'description':_0x57e82f(0xde6)},'transfer':{'type':'transfer','amount':5.2,'note':_0x57e82f(0x11f5)},'link':{'type':_0x57e82f(0x94a),'title':'文章标题','description':_0x57e82f(0x1dd),'source_name':'来源网站','content':_0x57e82f(0x81b)}},_0x568dd2='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x57e82f(0x3fb)](_0x54e3d9[_0x57e82f(0xcfd)])+_0x57e82f(0x160)+JSON[_0x57e82f(0x3fb)](_0x54e3d9[_0x57e82f(0x482)])+_0x57e82f(0xd97)+JSON[_0x57e82f(0x3fb)](_0x54e3d9[_0x57e82f(0x909)])+'\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x57e82f(0x3fb)](_0x54e3d9['link'])+_0x57e82f(0x1399),_0x5b6763=await _0x12e332(_0x57e82f(0x82c),_0x57e82f(0x33a),_0x3c80e4,_0x57e82f(0xfe5),_0x568dd2);_0x5b6763!==null&&await _0x682a75(_0x34e8c0,_0x5b6763,!![]);}async function _0x4e1dd4(){const _0x36ed50=_0x549949;if(!_0x7c8ee8)return;const _0x2ac041=_0x41df36['chats'][_0x41df36[_0x36ed50(0xfc5)]],_0x32a043=_0x2ac041[_0x36ed50(0xd08)][_0x36ed50(0xd12)](_0x125b85=>_0x125b85[_0x36ed50(0x3b7)]===_0x7c8ee8);if(!_0x32a043)return;let _0x5c2894;typeof _0x32a043['content']===_0x36ed50(0x890)?_0x5c2894=JSON[_0x36ed50(0x3fb)](_0x32a043[_0x36ed50(0x11b6)]):_0x5c2894=String(_0x32a043[_0x36ed50(0x11b6)]);try{await navigator[_0x36ed50(0xc5f)][_0x36ed50(0x5f1)](_0x5c2894),await _0x296ef9(_0x36ed50(0x768),'消息内容已复制到剪贴板。');}catch(_0x2bf618){await _0x296ef9('复制失败',_0x36ed50(0xce0));}_0x29d937();}async function _0x5acaf4(){const _0x12de44=_0x549949;if(!_0x7c8ee8)return;try{await navigator['clipboard'][_0x12de44(0x5f1)](_0x7c8ee8),await _0x296ef9(_0x12de44(0x768),_0x12de44(0x91d)+_0x7c8ee8+_0x12de44(0x538));}catch(_0x4d7a86){await _0x296ef9(_0x12de44(0x41f),_0x12de44(0xce0));}_0x29d937();}function _0x269fef(_0x50b86e=''){const _0xe4d251=_0x549949,_0x2d5bd6=document[_0xe4d251(0xe1b)]('div');_0x2d5bd6[_0xe4d251(0x556)]=_0xe4d251(0xd7e);const _0x52adb8={'voice':{'type':'voice_message','content':_0xe4d251(0x7a7)},'image':{'type':_0xe4d251(0x1050),'description':'在这里输入图片描述'},'transfer':{'type':_0xe4d251(0x909),'amount':5.2,'note':_0xe4d251(0x11f5)},'link':{'type':_0xe4d251(0x94a),'title':'文章标题','description':_0xe4d251(0x1dd),'source_name':_0xe4d251(0x12c5),'content':_0xe4d251(0x81b)},'offline':{'type':'offline_text','content':_0xe4d251(0x4b4)},'quote':{'type':_0xe4d251(0x1038),'target_timestamp':0x499602d2,'reply_content':_0xe4d251(0x1d7)}};return _0x2d5bd6[_0xe4d251(0x45c)]=_0xe4d251(0x425)+_0x50b86e+_0xe4d251(0x468)+JSON[_0xe4d251(0x3fb)](_0x52adb8[_0xe4d251(0xcfd)])+_0xe4d251(0x13a0)+JSON[_0xe4d251(0x3fb)](_0x52adb8[_0xe4d251(0x482)])+_0xe4d251(0x9ec)+JSON[_0xe4d251(0x3fb)](_0x52adb8['transfer'])+_0xe4d251(0x11f9)+JSON['stringify'](_0x52adb8[_0xe4d251(0x918)])+_0xe4d251(0x319)+JSON[_0xe4d251(0x3fb)](_0x52adb8['offline'])+'\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0xe4d251(0x3fb)](_0x52adb8[_0xe4d251(0x8ff)])+_0xe4d251(0xb4f),_0x2d5bd6[_0xe4d251(0x89c)](_0xe4d251(0x11c4))[_0xe4d251(0x271)](_0xe4d251(0x5c7),()=>{const _0x412161=_0xe4d251;document['querySelectorAll']('.message-editor-block')[_0x412161(0xfde)]>0x1?_0x2d5bd6[_0x412161(0x131d)]():alert('至少需要保留一条消息。');}),_0x2d5bd6[_0xe4d251(0x400)](_0xe4d251(0x487))[_0xe4d251(0x19c)](_0x1364cd=>{const _0x59d8b0=_0xe4d251;_0x1364cd[_0x59d8b0(0x271)](_0x59d8b0(0x5c7),()=>{const _0x7857f=_0x59d8b0,_0x5435b0=_0x1364cd[_0x7857f(0x118)][_0x7857f(0xd7b)],_0x1f6095=_0x2d5bd6[_0x7857f(0x89c)](_0x7857f(0xfe5));if(_0x5435b0&&_0x1f6095)try{const _0x6a115e=JSON[_0x7857f(0x134)](_0x5435b0);_0x1f6095[_0x7857f(0x1be)]=JSON[_0x7857f(0x3fb)](_0x6a115e,null,0x2),_0x1f6095['focus']();}catch(_0x3ed0d7){console[_0x7857f(0x98)]('解析格式模板失败:',_0x3ed0d7);}});}),_0x2d5bd6;}function _0x57c9c3(){const _0x336087=_0x549949;if(!_0x7c8ee8)return;const _0x41b62d=_0x7c8ee8,_0x22516c=_0x41df36[_0x336087(0x864)][_0x41df36[_0x336087(0xfc5)]],_0x2773c5=_0x22516c[_0x336087(0xd08)]['find'](_0x53b26f=>_0x53b26f[_0x336087(0x3b7)]===_0x41b62d);if(!_0x2773c5)return;_0x29d937();const _0x398f6f=document['getElementById'](_0x336087(0x1215)),_0x93e2bc=document[_0x336087(0x383)](_0x336087(0x249));_0x93e2bc[_0x336087(0x45c)]='';let _0x417fe4;if(_0x2773c5['quote']){const _0xbb17f7={'type':_0x336087(0x1038),'target_timestamp':_0x2773c5[_0x336087(0x8ff)][_0x336087(0x3b7)],'reply_content':_0x2773c5['content']};_0x417fe4=JSON['stringify'](_0xbb17f7,null,0x2);}else{if(_0x2773c5['type']&&[_0x336087(0xa4f),_0x336087(0x1050),'transfer',_0x336087(0x44e),_0x336087(0x94a)]['includes'](_0x2773c5[_0x336087(0xa6b)])){let _0xc9e279={'type':_0x2773c5[_0x336087(0xa6b)]};if(_0x2773c5[_0x336087(0xa6b)]===_0x336087(0xa4f))_0xc9e279[_0x336087(0x11b6)]=_0x2773c5[_0x336087(0x11b6)];else{if(_0x2773c5['type']===_0x336087(0x1050))_0xc9e279[_0x336087(0xee1)]=_0x2773c5[_0x336087(0x11b6)];else{if(_0x2773c5[_0x336087(0xa6b)]==='transfer')_0xc9e279[_0x336087(0xe27)]=_0x2773c5[_0x336087(0xe27)],_0xc9e279['note']=_0x2773c5['note'];else{if(_0x2773c5['type']===_0x336087(0x44e))_0x2773c5['content']?_0xc9e279[_0x336087(0x11b6)]=_0x2773c5[_0x336087(0x11b6)]:(_0xc9e279[_0x336087(0x5ed)]=_0x2773c5['dialogue'],_0xc9e279[_0x336087(0xee1)]=_0x2773c5[_0x336087(0xee1)]);else _0x2773c5['type']==='share_link'&&(_0xc9e279['title']=_0x2773c5[_0x336087(0xf3a)],_0xc9e279[_0x336087(0xee1)]=_0x2773c5[_0x336087(0xee1)],_0xc9e279[_0x336087(0x8d4)]=_0x2773c5[_0x336087(0x8d4)],_0xc9e279['content']=_0x2773c5[_0x336087(0x11b6)]);}}}_0x417fe4=JSON[_0x336087(0x3fb)](_0xc9e279,null,0x2);}else typeof _0x2773c5['content']==='object'?_0x417fe4=JSON[_0x336087(0x3fb)](_0x2773c5[_0x336087(0x11b6)],null,0x2):_0x417fe4=_0x2773c5[_0x336087(0x11b6)];}const _0x733e2b=_0x269fef(_0x417fe4);_0x93e2bc[_0x336087(0xe91)](_0x733e2b);const _0x56c4f1=document[_0x336087(0x383)]('add-message-editor-block-btn'),_0x52827b=_0x56c4f1[_0x336087(0x117b)](!![]);_0x56c4f1[_0x336087(0x1245)][_0x336087(0xe58)](_0x52827b,_0x56c4f1),_0x52827b[_0x336087(0x271)]('click',()=>{const _0x49b2a0=_0x336087,_0xf1296f=_0x269fef();_0x93e2bc[_0x49b2a0(0xe91)](_0xf1296f),_0xf1296f['querySelector'](_0x49b2a0(0xfe5))['focus']();});const _0x50cef8=document['getElementById'](_0x336087(0xfb5)),_0x3e6ff2=_0x50cef8['cloneNode'](!![]);_0x50cef8[_0x336087(0x1245)]['replaceChild'](_0x3e6ff2,_0x50cef8),_0x3e6ff2[_0x336087(0x271)]('click',()=>{const _0x44ce5b=_0x336087;_0x398f6f['classList']['remove'](_0x44ce5b(0x106d));});const _0x33635b=document[_0x336087(0x383)](_0x336087(0x149)),_0x24065d=_0x33635b[_0x336087(0x117b)](!![]);_0x33635b[_0x336087(0x1245)][_0x336087(0xe58)](_0x24065d,_0x33635b),_0x24065d['addEventListener'](_0x336087(0x5c7),()=>{_0x682a75(_0x41b62d);}),_0x398f6f[_0x336087(0x119a)]['add'](_0x336087(0x106d));}async function _0x4e1dd4(){const _0x11e732=_0x549949;if(!_0x7c8ee8)return;const _0x196db3=_0x41df36['chats'][_0x41df36[_0x11e732(0xfc5)]],_0x38c10a=_0x196db3[_0x11e732(0xd08)]['find'](_0x728db3=>_0x728db3[_0x11e732(0x3b7)]===_0x7c8ee8);if(!_0x38c10a)return;let _0x4750e5;if(_0x38c10a[_0x11e732(0xa6b)]==='offline_text')_0x38c10a[_0x11e732(0x11b6)]?_0x4750e5=_0x38c10a[_0x11e732(0x11b6)]:_0x4750e5='「'+(_0x38c10a['dialogue']||'')+'」\x0a'+(_0x38c10a['description']||'');else typeof _0x38c10a[_0x11e732(0x11b6)]==='object'?_0x4750e5=JSON[_0x11e732(0x3fb)](_0x38c10a[_0x11e732(0x11b6)]):_0x4750e5=String(_0x38c10a[_0x11e732(0x11b6)]);try{await navigator[_0x11e732(0xc5f)][_0x11e732(0x5f1)](_0x4750e5),await _0x296ef9(_0x11e732(0x768),'消息内容已复制到剪贴板。');}catch(_0x18d13b){await _0x296ef9(_0x11e732(0x41f),_0x11e732(0xce0));}_0x29d937();}function _0x28b7d4(_0x24782e){const _0x58318b=_0x549949,_0x27d6f8=_0x24782e[_0x58318b(0x1cb)]();if(_0x27d6f8[_0x58318b(0x1122)]('{')&&_0x27d6f8['endsWith']('}'))try{const _0x16d6e3=JSON['parse'](_0x27d6f8);if(_0x16d6e3['type'])return _0x16d6e3;}catch(_0x29690a){}if(_0x49f222[_0x58318b(0xd73)](_0x27d6f8))return{'type':_0x58318b(0x37d),'content':_0x27d6f8};return{'type':'text','content':_0x27d6f8};}async function _0x682a75(_0x97ade9,_0x5c7402=null){const _0x3b47a9=_0x549949;if(!_0x97ade9)return;const _0x567df9=_0x41df36['chats'][_0x41df36['activeChatId']],_0x266ccd=_0x567df9[_0x3b47a9(0xd08)][_0x3b47a9(0xe37)](_0x5f2b43=>_0x5f2b43['timestamp']===_0x97ade9);if(_0x266ccd===-0x1)return;const _0x1c2ce4=_0x567df9[_0x3b47a9(0xd08)][_0x266ccd];let _0x618922=[];const _0x3bb9a3=_0x5c7402!==null?[_0x5c7402]:Array['from'](document[_0x3b47a9(0x400)]('#message-editor-container\x20textarea'))[_0x3b47a9(0xa79)](_0x3edd59=>_0x3edd59[_0x3b47a9(0x1be)]);for(const _0x24ccb2 of _0x3bb9a3){if(!_0x24ccb2[_0x3b47a9(0x1cb)]())continue;const _0x5d5555=_0x28b7d4(_0x24ccb2[_0x3b47a9(0x1cb)]()),_0xce5e35={'role':_0x1c2ce4[_0x3b47a9(0x10ff)],'senderName':_0x1c2ce4[_0x3b47a9(0x4c5)],'timestamp':_0x1c2ce4[_0x3b47a9(0x3b7)]};switch(_0x5d5555[_0x3b47a9(0xa6b)]){case _0x3b47a9(0x6af):_0xce5e35['type']='text',_0xce5e35[_0x3b47a9(0x11b6)]=_0x5d5555[_0x3b47a9(0x11b6)];break;case _0x3b47a9(0x44e):_0xce5e35[_0x3b47a9(0xa6b)]='offline_text';_0x5d5555[_0x3b47a9(0x11b6)]?_0xce5e35[_0x3b47a9(0x11b6)]=_0x5d5555[_0x3b47a9(0x11b6)]:(_0xce5e35['dialogue']=_0x5d5555[_0x3b47a9(0x5ed)],_0xce5e35['description']=_0x5d5555[_0x3b47a9(0xee1)]);break;case _0x3b47a9(0x1038):_0xce5e35['type']=_0x3b47a9(0x1038),_0xce5e35[_0x3b47a9(0x11b6)]=_0x5d5555[_0x3b47a9(0x5a6)];const _0x2e06b3=_0x567df9[_0x3b47a9(0xd08)][_0x3b47a9(0xd12)](_0x47b7ea=>_0x47b7ea[_0x3b47a9(0x3b7)]===_0x5d5555[_0x3b47a9(0x17d)]);if(_0x2e06b3){let _0x47d161=_0x2e06b3['senderName'];_0x2e06b3[_0x3b47a9(0x10ff)]===_0x3b47a9(0x66e)&&(_0x47d161=_0x41df36[_0x3b47a9(0x571)][_0x3b47a9(0xabb)]||_0x3b47a9(0x7da)),_0xce5e35[_0x3b47a9(0x8ff)]={'timestamp':_0x5d5555[_0x3b47a9(0x17d)],'senderName':_0x47d161,'content':String(_0x2e06b3[_0x3b47a9(0x11b6)]||'')};}else _0xce5e35[_0x3b47a9(0x8ff)]={'timestamp':_0x5d5555[_0x3b47a9(0x17d)],'senderName':_0x3b47a9(0x260),'content':'原始消息已删除或不存在'};break;case'voice_message':case _0x3b47a9(0x1050):case _0x3b47a9(0xed0):_0xce5e35['type']=_0x5d5555[_0x3b47a9(0xa6b)],_0xce5e35[_0x3b47a9(0x11b6)]=_0x5d5555['content']||_0x5d5555[_0x3b47a9(0xee1)];if(_0x5d5555['meaning'])_0xce5e35[_0x3b47a9(0x7de)]=_0x5d5555['meaning'];break;case'sticker':{_0xce5e35[_0x3b47a9(0xa6b)]=_0x3b47a9(0x37d);let _0x36e439=![];if(_0x5d5555[_0x3b47a9(0x7de)]){const _0x5414d0=_0x41df36[_0x3b47a9(0x823)][_0x3b47a9(0xd12)](_0x2b8a2c=>_0x2b8a2c[_0x3b47a9(0x461)]===_0x5d5555[_0x3b47a9(0x7de)]);_0x5414d0?(_0xce5e35[_0x3b47a9(0x11b6)]=_0x5414d0[_0x3b47a9(0x2fa)],_0xce5e35['meaning']=_0x5414d0[_0x3b47a9(0x461)],console['log'](_0x3b47a9(0x676)),_0x36e439=!![]):(_0xce5e35[_0x3b47a9(0xa6b)]='text',_0xce5e35[_0x3b47a9(0x11b6)]=_0x3b47a9(0x261)+_0x5d5555[_0x3b47a9(0x7de)]+']',console[_0x3b47a9(0x17b)](_0x3b47a9(0x22a),_0x5d5555[_0x3b47a9(0x7de)]),_0x36e439=!![]);}if(!_0x36e439&&_0x5d5555['url']){_0xce5e35[_0x3b47a9(0x11b6)]=_0x5d5555['url'];const _0x3d49a4=_0x41df36[_0x3b47a9(0x823)]['find'](_0x25856f=>_0x25856f[_0x3b47a9(0x2fa)]===_0x5d5555['url']);if(_0x5d5555[_0x3b47a9(0x7de)]&&(!_0x3d49a4||_0x3d49a4[_0x3b47a9(0x461)]===_0x5d5555[_0x3b47a9(0x7de)]))_0xce5e35[_0x3b47a9(0x7de)]=_0x5d5555[_0x3b47a9(0x7de)];else _0x3d49a4?_0xce5e35['meaning']=_0x3d49a4['name']:_0xce5e35[_0x3b47a9(0x7de)]=_0x3b47a9(0x2a8);console[_0x3b47a9(0xe72)]('导演/编辑模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:',_0xce5e35[_0x3b47a9(0x7de)]),_0x36e439=!![];}if(!_0x36e439&&_0x5d5555[_0x3b47a9(0x11b6)]&&typeof _0x5d5555[_0x3b47a9(0x11b6)]===_0x3b47a9(0xafa)&&_0x49f222[_0x3b47a9(0xd73)](_0x5d5555[_0x3b47a9(0x11b6)])){_0xce5e35[_0x3b47a9(0x11b6)]=_0x5d5555[_0x3b47a9(0x11b6)];const _0x4b9de3=_0x41df36[_0x3b47a9(0x823)][_0x3b47a9(0xd12)](_0x595c36=>_0x595c36[_0x3b47a9(0x2fa)]===_0x5d5555[_0x3b47a9(0x11b6)]);_0xce5e35[_0x3b47a9(0x7de)]=_0x4b9de3?_0x4b9de3['name']:'未知表情',console['log']('导演/编辑模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:',_0xce5e35[_0x3b47a9(0x7de)]),_0x36e439=!![];}if(!_0x36e439){console[_0x3b47a9(0x98)](_0x3b47a9(0x138d),_0x5d5555);continue;}break;}case _0x3b47a9(0x909):_0xce5e35['type']=_0x3b47a9(0x909),_0xce5e35[_0x3b47a9(0xe27)]=_0x5d5555['amount'],_0xce5e35[_0x3b47a9(0x775)]=_0x5d5555[_0x3b47a9(0x775)];break;case'share_link':_0xce5e35[_0x3b47a9(0xa6b)]='share_link',_0xce5e35[_0x3b47a9(0xf3a)]=_0x5d5555[_0x3b47a9(0xf3a)],_0xce5e35[_0x3b47a9(0xee1)]=_0x5d5555[_0x3b47a9(0xee1)],_0xce5e35[_0x3b47a9(0x8d4)]=_0x5d5555['source_name'],_0xce5e35[_0x3b47a9(0x11b6)]=_0x5d5555['content'];break;default:Object[_0x3b47a9(0xa8d)](_0xce5e35,_0x5d5555);break;}_0x618922[_0x3b47a9(0x258)](_0xce5e35);}if(_0x618922[_0x3b47a9(0xfde)]===0x0){document[_0x3b47a9(0x383)](_0x3b47a9(0x1215))['classList']['remove']('visible');return;}_0x567df9['history']['splice'](_0x266ccd,0x1,..._0x618922);let _0x4fa87a=_0x97ade9;for(let _0x4688bc=_0x266ccd;_0x4688bc<_0x567df9[_0x3b47a9(0xd08)]['length'];_0x4688bc++){_0x567df9['history'][_0x4688bc][_0x3b47a9(0x3b7)]=_0x4fa87a,_0x4fa87a++;}await _0x342df8[_0x3b47a9(0x864)][_0x3b47a9(0x9c0)](_0x567df9),document[_0x3b47a9(0x383)](_0x3b47a9(0x1215))[_0x3b47a9(0x119a)][_0x3b47a9(0x131d)](_0x3b47a9(0x106d)),_0x409076(_0x41df36[_0x3b47a9(0xfc5)]),await _0x296ef9('成功',_0x3b47a9(0x1269));}function _0x1bbe4a(_0x17a860){const _0x3b13d7=_0x549949;_0x5efd5e=_0x17a860,document['getElementById'](_0x3b13d7(0x4e8))[_0x3b13d7(0x119a)][_0x3b13d7(0xbff)](_0x3b13d7(0x106d));}function _0x24a26d(){const _0x3b0fcc=_0x549949;document[_0x3b0fcc(0x383)](_0x3b0fcc(0x4e8))[_0x3b0fcc(0x119a)]['remove'](_0x3b0fcc(0x106d)),_0x5efd5e=null;}async function _0x23051a(){const _0x229af1=_0x549949;if(!_0x5efd5e)return;const _0xf8e24a=_0x5efd5e,_0x54f7db=await _0x342df8[_0x229af1(0x35a)]['get'](_0xf8e24a);if(!_0x54f7db)return;_0x24a26d();let _0x14b5b5;if(_0x54f7db['type']===_0x229af1(0x23e))_0x14b5b5=_0x54f7db[_0x229af1(0x11b6)];else{const _0x92b1f6={'type':_0x54f7db[_0x229af1(0xa6b)],'publicText':_0x54f7db[_0x229af1(0xbdc)]||''};if(_0x54f7db[_0x229af1(0xa6b)]===_0x229af1(0xe9d))_0x92b1f6[_0x229af1(0xa94)]=_0x54f7db[_0x229af1(0xa94)],_0x92b1f6[_0x229af1(0x8cf)]=_0x54f7db[_0x229af1(0x8cf)];else _0x54f7db[_0x229af1(0xa6b)]===_0x229af1(0x68e)&&(_0x92b1f6[_0x229af1(0x4e6)]=_0x54f7db[_0x229af1(0x4e6)]);_0x14b5b5=JSON[_0x229af1(0x3fb)](_0x92b1f6,null,0x2);}const _0x5ce799={'shuoshuo':_0x229af1(0x8b1),'image':{'type':'image_post','publicText':'','imageUrl':'https://...','imageDescription':''},'text_image':{'type':_0x229af1(0x68e),'publicText':'','hiddenContent':''}},_0x48c4ce='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x5ce799[_0x229af1(0x482)])+_0x229af1(0x55e)+JSON[_0x229af1(0x3fb)](_0x5ce799[_0x229af1(0x68e)])+'\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3c7732=await _0x12e332('编辑动态','在此修改内容...',_0x14b5b5,_0x229af1(0xfe5),_0x48c4ce);setTimeout(()=>{const _0x31f21f=_0x229af1,_0x45e66f=document['querySelector'](_0x31f21f(0x4e7));_0x45e66f&&_0x45e66f[_0x31f21f(0x271)]('click',()=>{const _0x5e9d57=_0x31f21f,_0x13608f=document[_0x5e9d57(0x383)](_0x5e9d57(0x70a));_0x13608f[_0x5e9d57(0x1be)]=_0x5ce799[_0x5e9d57(0x23e)],_0x13608f[_0x5e9d57(0xede)]();});},0x64),_0x3c7732!==null&&await _0x4ae126(_0xf8e24a,_0x3c7732);}async function _0x4ae126(_0x376495,_0x25260f){const _0x445795=_0x549949,_0x314e24=await _0x342df8['qzonePosts'][_0x445795(0x1a3)](_0x376495);if(!_0x314e24)return;const _0x13bb93=_0x25260f[_0x445795(0x1cb)]();try{const _0x5a6a45=JSON[_0x445795(0x134)](_0x13bb93);_0x314e24[_0x445795(0xa6b)]=_0x5a6a45[_0x445795(0xa6b)]||_0x445795(0xe9d),_0x314e24[_0x445795(0xbdc)]=_0x5a6a45[_0x445795(0xbdc)]||'',_0x314e24[_0x445795(0xa94)]=_0x5a6a45[_0x445795(0xa94)]||'',_0x314e24['imageDescription']=_0x5a6a45[_0x445795(0x8cf)]||'',_0x314e24[_0x445795(0x4e6)]=_0x5a6a45[_0x445795(0x4e6)]||'',_0x314e24[_0x445795(0x11b6)]='';}catch(_0x59ffab){_0x314e24[_0x445795(0xa6b)]='shuoshuo',_0x314e24[_0x445795(0x11b6)]=_0x13bb93,_0x314e24['publicText']='',_0x314e24[_0x445795(0xa94)]='',_0x314e24['imageDescription']='',_0x314e24[_0x445795(0x4e6)]='';}await _0x342df8[_0x445795(0x35a)][_0x445795(0x9c0)](_0x314e24),await _0x476b70(),await _0x296ef9('成功',_0x445795(0xd86));}async function _0x3a873b(){const _0x47e6d1=_0x549949;if(!_0x5efd5e)return;const _0x292783=await _0x342df8[_0x47e6d1(0x35a)][_0x47e6d1(0x1a3)](_0x5efd5e);if(!_0x292783)return;let _0x1add41=_0x292783[_0x47e6d1(0x11b6)]||_0x292783[_0x47e6d1(0xbdc)]||_0x292783[_0x47e6d1(0x4e6)]||_0x292783[_0x47e6d1(0x8cf)]||_0x47e6d1(0xdf2);try{await navigator[_0x47e6d1(0xc5f)][_0x47e6d1(0x5f1)](_0x1add41),await _0x296ef9(_0x47e6d1(0x768),_0x47e6d1(0xa0d));}catch(_0x1095e2){await _0x296ef9('复制失败',_0x47e6d1(0xce0));}_0x24a26d();}let _0x583e8f=new Set();async function _0x582cf4(){const _0x2f5889=_0x549949,_0x2e94b9=await _0x2d60a4(_0x2f5889(0xcf),[{'text':'创建普通群聊\x20(我参与)','value':_0x2f5889(0x394)},{'text':'创建旁观群聊\x20(我围观)','value':_0x2f5889(0x9e5)}]);if(_0x2e94b9===_0x2f5889(0x394)){_0x583e8f[_0x2f5889(0x4b8)]();const _0x3c5779=document[_0x2f5889(0x383)](_0x2f5889(0xbee)),_0xa13078=_0x3c5779[_0x2f5889(0x117b)](!![]);_0x3c5779['parentNode'][_0x2f5889(0xe58)](_0xa13078,_0x3c5779),_0xa13078[_0x2f5889(0x271)](_0x2f5889(0x5c7),_0x1993cb),await _0x171275(),_0x105acd('contact-picker-screen');}else _0x2e94b9===_0x2f5889(0x9e5)&&_0x2c3088();}async function _0x2c3088(){const _0x52c7af=_0x549949;_0x583e8f[_0x52c7af(0x4b8)]();const _0x2b5dfd=document['getElementById'](_0x52c7af(0xbee)),_0x33dbba=_0x2b5dfd['cloneNode'](!![]);_0x2b5dfd[_0x52c7af(0x1245)][_0x52c7af(0xe58)](_0x33dbba,_0x2b5dfd),_0x33dbba['addEventListener']('click',_0x2ed42d),await _0x11618a(),_0x105acd(_0x52c7af(0x4c8));}async function _0x11618a(){const _0x31a7d3=_0x549949,_0x134280=document['getElementById'](_0x31a7d3(0x1179));_0x134280[_0x31a7d3(0x45c)]='';const _0x250666=Object[_0x31a7d3(0x76d)](_0x41df36['chats'])[_0x31a7d3(0x98a)](_0x3af191=>!_0x3af191[_0x31a7d3(0x1a2)]),_0xa0ea03=await _0x342df8[_0x31a7d3(0x656)][_0x31a7d3(0x21f)]();if(_0x250666[_0x31a7d3(0xfde)]===0x0&&_0xa0ea03[_0x31a7d3(0xfde)]===0x0){_0x134280[_0x31a7d3(0x45c)]='<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>';return;}_0x250666[_0x31a7d3(0x19c)](_0xcce861=>{const _0x5762ce=_0x31a7d3,_0x2ab482=document[_0x5762ce(0xe1b)](_0x5762ce(0x7fd));_0x2ab482[_0x5762ce(0x556)]='contact-picker-item',_0x2ab482['dataset']['contactId']=_0xcce861['id'],_0x2ab482[_0x5762ce(0x45c)]=_0x5762ce(0x516)+(_0xcce861[_0x5762ce(0x886)][_0x5762ce(0x121e)]||_0x5dc108)+_0x5762ce(0x12b2)+_0xcce861[_0x5762ce(0x461)]+_0x5762ce(0x1015),_0x134280['appendChild'](_0x2ab482);}),_0xa0ea03['forEach'](_0x4ef858=>{const _0xc295aa=_0x31a7d3,_0x3cf8a1=document['createElement']('div');_0x3cf8a1[_0xc295aa(0x556)]=_0xc295aa(0x136c),_0x3cf8a1[_0xc295aa(0x118)][_0xc295aa(0x6f7)]=_0x4ef858['id'],_0x3cf8a1['dataset'][_0xc295aa(0x6cb)]=_0xc295aa(0xc06),_0x3cf8a1[_0xc295aa(0x45c)]=_0xc295aa(0x516)+(_0x4ef858['avatar']||_0x59100f)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x4ef858[_0xc295aa(0x461)]+_0xc295aa(0xacd),_0x134280['appendChild'](_0x3cf8a1);}),_0x247064();}async function _0x2ed42d(){const _0x3ef6ab=_0x549949;if(_0x583e8f[_0x3ef6ab(0x1240)]<0x2){alert(_0x3ef6ab(0x220));return;}const _0x678e23=await _0x12e332(_0x3ef6ab(0xc42),_0x3ef6ab(0x12b0),_0x3ef6ab(0x107a));if(!_0x678e23||!_0x678e23[_0x3ef6ab(0x1cb)]())return;const _0x426b47=_0x3ef6ab(0x2c2)+Date[_0x3ef6ab(0x108d)](),_0x4ea97a=[],_0x2a595e=await _0x342df8[_0x3ef6ab(0x656)][_0x3ef6ab(0x21f)]();for(const _0x3b8c20 of _0x583e8f){const _0x1d706e=document[_0x3ef6ab(0x89c)](_0x3ef6ab(0xd69)+_0x3b8c20+'\x22]')['dataset'][_0x3ef6ab(0x6cb)]===_0x3ef6ab(0xc06);if(_0x1d706e){const _0x4c6974=_0x2a595e[_0x3ef6ab(0xd12)](_0x3bb859=>_0x3bb859['id']===parseInt(_0x3b8c20));_0x4c6974&&_0x4ea97a[_0x3ef6ab(0x258)]({'id':_0x3ef6ab(0x1244)+_0x4c6974['id'],'originalName':_0x4c6974[_0x3ef6ab(0x461)],'groupNickname':_0x4c6974[_0x3ef6ab(0x461)],'persona':_0x4c6974[_0x3ef6ab(0x48c)],'avatar':_0x4c6974[_0x3ef6ab(0xb47)]||_0x59100f,'isNpc':!![]});}else{const _0x22444e=_0x41df36['chats'][_0x3b8c20];_0x22444e&&_0x4ea97a[_0x3ef6ab(0x258)]({'id':_0x3b8c20,'originalName':_0x22444e[_0x3ef6ab(0x283)],'groupNickname':_0x22444e[_0x3ef6ab(0x461)],'persona':_0x22444e['settings'][_0x3ef6ab(0xd83)],'avatar':_0x22444e[_0x3ef6ab(0x886)][_0x3ef6ab(0x121e)]||_0x5dc108,'isNpc':![]});}}const _0x4a6bd9={'id':_0x426b47,'name':_0x678e23['trim'](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x4ea97a,'settings':{'maxMemory':0xa,'groupAvatar':_0x3e0950,'background':'','theme':_0x3ef6ab(0xba4),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':_0x3ef6ab(0xb1),'content':'[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','timestamp':Date[_0x3ef6ab(0x108d)](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x41df36['chats'][_0x426b47]=_0x4a6bd9,await _0x342df8['chats'][_0x3ef6ab(0x9c0)](_0x4a6bd9),await _0x25558e(),_0x105acd(_0x3ef6ab(0x11f7)),_0x4a08c7(_0x426b47);}async function _0x171275(){const _0xa67eb9=_0x549949,_0x579c92=document['getElementById'](_0xa67eb9(0x1179));_0x579c92[_0xa67eb9(0x45c)]='';const _0x5eaf39=Object[_0xa67eb9(0x76d)](_0x41df36[_0xa67eb9(0x864)])['filter'](_0x14c805=>!_0x14c805[_0xa67eb9(0x1a2)]),_0x215813=await _0x342df8[_0xa67eb9(0x656)][_0xa67eb9(0x21f)]();if(_0x5eaf39[_0xa67eb9(0xfde)]===0x0&&_0x215813[_0xa67eb9(0xfde)]===0x0){_0x579c92['innerHTML']=_0xa67eb9(0x85b);return;}_0x5eaf39[_0xa67eb9(0x19c)](_0x45c62d=>{const _0x1dab2d=_0xa67eb9,_0x10a815=document['createElement'](_0x1dab2d(0x7fd));_0x10a815[_0x1dab2d(0x556)]=_0x1dab2d(0x136c),_0x10a815[_0x1dab2d(0x118)][_0x1dab2d(0x6f7)]=_0x45c62d['id'],_0x10a815['innerHTML']=_0x1dab2d(0x516)+(_0x45c62d['settings']['aiAvatar']||_0x5dc108)+_0x1dab2d(0x12b2)+_0x45c62d[_0x1dab2d(0x461)]+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x579c92['appendChild'](_0x10a815);}),_0x215813[_0xa67eb9(0x19c)](_0x13ace7=>{const _0x49ff70=_0xa67eb9,_0xeeeb2=document['createElement'](_0x49ff70(0x7fd));_0xeeeb2[_0x49ff70(0x556)]=_0x49ff70(0x136c),_0xeeeb2[_0x49ff70(0x118)][_0x49ff70(0x6f7)]=_0x49ff70(0x1244)+_0x13ace7['id'],_0xeeeb2[_0x49ff70(0x45c)]=_0x49ff70(0x516)+(_0x13ace7['avatar']||_0x59100f)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x13ace7[_0x49ff70(0x461)]+_0x49ff70(0xacd),_0x579c92[_0x49ff70(0xe91)](_0xeeeb2);}),_0x247064();}function _0x247064(){const _0x1c0af5=_0x549949,_0x787a0a=document[_0x1c0af5(0x383)]('confirm-contact-picker-btn');_0x787a0a['textContent']=_0x1c0af5(0x510)+_0x583e8f[_0x1c0af5(0x1240)]+')',_0x787a0a[_0x1c0af5(0x29b)]=_0x583e8f[_0x1c0af5(0x1240)]<0x2;}async function _0x1993cb(){const _0x317890=_0x549949;if(_0x583e8f[_0x317890(0x1240)]<0x2){alert(_0x317890(0x3d2));return;}const _0x46ba87=await _0x12e332(_0x317890(0xc42),_0x317890(0x12b0),'我们的群聊');if(!_0x46ba87||!_0x46ba87[_0x317890(0x1cb)]())return;const _0x35678b=_0x317890(0x2c2)+Date[_0x317890(0x108d)](),_0x1bdc1f=[],_0x244e8a=await _0x342df8[_0x317890(0x656)][_0x317890(0x21f)]();for(const _0x149558 of _0x583e8f){if(_0x149558[_0x317890(0x1122)](_0x317890(0x1244))){const _0xf554dd=parseInt(_0x149558[_0x317890(0x709)](_0x317890(0x1244),'')),_0x4a199e=_0x244e8a[_0x317890(0xd12)](_0x100940=>_0x100940['id']===_0xf554dd);_0x4a199e&&_0x1bdc1f[_0x317890(0x258)]({'id':_0x149558,'originalName':_0x4a199e[_0x317890(0x461)],'groupNickname':_0x4a199e[_0x317890(0x461)],'persona':_0x4a199e[_0x317890(0x48c)],'avatar':_0x4a199e['avatar']||_0x59100f,'isNpc':!![]});}else{const _0x1f5d4e=_0x41df36[_0x317890(0x864)][_0x149558];_0x1f5d4e&&_0x1bdc1f['push']({'id':_0x149558,'originalName':_0x1f5d4e[_0x317890(0x283)],'groupNickname':_0x1f5d4e[_0x317890(0x461)],'persona':_0x1f5d4e[_0x317890(0x886)][_0x317890(0xd83)],'avatar':_0x1f5d4e[_0x317890(0x886)]['aiAvatar']||_0x5dc108,'isNpc':![]});}}const _0x3a91bb={'id':_0x35678b,'name':_0x46ba87[_0x317890(0x1cb)](),'isGroup':!![],'members':_0x1bdc1f,'settings':{'myPersona':'我是谁呀。','myNickname':'我','maxMemory':0xa,'groupAvatar':_0x3e0950,'myAvatar':_0x188ace,'background':'','theme':_0x317890(0xba4),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x41df36[_0x317890(0x864)][_0x35678b]=_0x3a91bb,await _0x342df8[_0x317890(0x864)][_0x317890(0x9c0)](_0x3a91bb),await _0x25558e(),_0x105acd(_0x317890(0x11f7)),_0x4a08c7(_0x35678b);}function _0x1a842f(){const _0x2d1a72=_0x549949;if(!_0x41df36[_0x2d1a72(0xfc5)]||!_0x41df36[_0x2d1a72(0x864)][_0x41df36[_0x2d1a72(0xfc5)]]['isGroup'])return;_0x469f17(),_0x105acd(_0x2d1a72(0x436));}function _0x469f17(){const _0x29a5fb=_0x549949,_0x4a9b3d=document[_0x29a5fb(0x383)](_0x29a5fb(0x128f)),_0x5777d5=_0x41df36[_0x29a5fb(0x864)][_0x41df36[_0x29a5fb(0xfc5)]];_0x4a9b3d[_0x29a5fb(0x45c)]='',_0x5777d5['members'][_0x29a5fb(0x19c)](_0x1bedb8=>{const _0x481861=_0x29a5fb,_0x51184a=document['createElement']('div');_0x51184a['className']=_0x481861(0x133b),_0x51184a[_0x481861(0x45c)]=_0x481861(0x9ef)+_0x1bedb8[_0x481861(0xb47)]+_0x481861(0x1040)+_0x1bedb8[_0x481861(0x9da)]+_0x481861(0x103e)+_0x1bedb8['id']+'\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4a9b3d[_0x481861(0xe91)](_0x51184a);});}async function _0x2572f8(_0x4d4593){const _0x3a7fb7=_0x549949,_0x4f99fe=_0x41df36[_0x3a7fb7(0x864)][_0x41df36[_0x3a7fb7(0xfc5)]],_0x245289=_0x4f99fe[_0x3a7fb7(0x12a6)]['findIndex'](_0x5f549f=>_0x5f549f['id']===_0x4d4593);if(_0x245289===-0x1)return;if(_0x4f99fe[_0x3a7fb7(0x12a6)][_0x3a7fb7(0xfde)]<=0x2){alert('群聊人数不能少于2人。');return;}const _0x4fec89=_0x4f99fe[_0x3a7fb7(0x12a6)][_0x245289]['groupNickname'],_0x15e926=await _0x23a88b(_0x3a7fb7(0x1074),_0x3a7fb7(0xc69)+_0x4fec89+_0x3a7fb7(0x9db),{'confirmButtonClass':_0x3a7fb7(0x51b)});_0x15e926&&(_0x4f99fe[_0x3a7fb7(0x12a6)][_0x3a7fb7(0x2f1)](_0x245289,0x1),await _0x342df8[_0x3a7fb7(0x864)]['put'](_0x4f99fe),_0x469f17(),document[_0x3a7fb7(0x383)](_0x3a7fb7(0x1ee))['click']());}async function _0x3eb151(){const _0x3153f3=_0x549949,_0x457661=document[_0x3153f3(0x383)]('confirm-contact-picker-btn'),_0x566620=_0x457661[_0x3153f3(0x117b)](!![]);_0x457661[_0x3153f3(0x1245)][_0x3153f3(0xe58)](_0x566620,_0x457661),_0x566620[_0x3153f3(0x271)](_0x3153f3(0x5c7),_0x1c389d),await _0x253e52(),_0x105acd(_0x3153f3(0x4c8));}async function _0x253e52(){const _0xbe5add=_0x549949,_0x23ed3d=document[_0xbe5add(0x383)](_0xbe5add(0x1179));_0x23ed3d['innerHTML']='',_0x583e8f[_0xbe5add(0x4b8)]();const _0x3eece0=_0x41df36['chats'][_0x41df36[_0xbe5add(0xfc5)]],_0x13a521=new Set(_0x3eece0[_0xbe5add(0x12a6)]['map'](_0x4d58c5=>_0x4d58c5['id'])),_0x26a04c=Object[_0xbe5add(0x76d)](_0x41df36[_0xbe5add(0x864)])[_0xbe5add(0x98a)](_0x2a2d6f=>!_0x2a2d6f[_0xbe5add(0x1a2)]&&!_0x13a521[_0xbe5add(0xcde)](_0x2a2d6f['id'])),_0x422d04=(await _0x342df8[_0xbe5add(0x656)][_0xbe5add(0x21f)]())[_0xbe5add(0x98a)](_0x32d600=>!_0x13a521[_0xbe5add(0xcde)](_0xbe5add(0x1244)+_0x32d600['id']));_0x26a04c[_0xbe5add(0xfde)]===0x0&&_0x422d04[_0xbe5add(0xfde)]===0x0?(_0x23ed3d[_0xbe5add(0x45c)]=_0xbe5add(0x268),document[_0xbe5add(0x383)](_0xbe5add(0xbee))['style'][_0xbe5add(0x2b6)]='none'):(document[_0xbe5add(0x383)](_0xbe5add(0xbee))[_0xbe5add(0x655)][_0xbe5add(0x2b6)]=_0xbe5add(0x27a),_0x26a04c[_0xbe5add(0x19c)](_0x5b2771=>{const _0x3f566d=_0xbe5add,_0x20d89d=document['createElement']('div');_0x20d89d[_0x3f566d(0x556)]=_0x3f566d(0x136c),_0x20d89d[_0x3f566d(0x118)]['contactId']=_0x5b2771['id'],_0x20d89d['dataset'][_0x3f566d(0xee)]=_0x3f566d(0xa0),_0x20d89d[_0x3f566d(0x45c)]=_0x3f566d(0x327)+(_0x5b2771[_0x3f566d(0x886)][_0x3f566d(0x121e)]||_0x5dc108)+_0x3f566d(0x1126)+_0x5b2771[_0x3f566d(0x461)]+_0x3f566d(0x10e9),_0x23ed3d['appendChild'](_0x20d89d);}),_0x422d04[_0xbe5add(0x19c)](_0x55028d=>{const _0x18f8b3=_0xbe5add,_0x1db7c1=document['createElement'](_0x18f8b3(0x7fd));_0x1db7c1[_0x18f8b3(0x556)]=_0x18f8b3(0x136c),_0x1db7c1[_0x18f8b3(0x118)]['contactId']=_0x18f8b3(0x1244)+_0x55028d['id'],_0x1db7c1[_0x18f8b3(0x118)][_0x18f8b3(0xee)]=_0x18f8b3(0xa03),_0x1db7c1[_0x18f8b3(0x118)][_0x18f8b3(0x98f)]=_0x55028d['id'],_0x1db7c1[_0x18f8b3(0x45c)]=_0x18f8b3(0x327)+(_0x55028d[_0x18f8b3(0xb47)]||_0x59100f)+_0x18f8b3(0x1126)+_0x55028d[_0x18f8b3(0x461)]+'\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x23ed3d['appendChild'](_0x1db7c1);})),_0x247064();}async function _0x1c389d(){const _0x180795=_0x549949;if(_0x583e8f[_0x180795(0x1240)]===0x0){alert(_0x180795(0xb07));return;}const _0xf860fb=_0x41df36[_0x180795(0x864)][_0x41df36[_0x180795(0xfc5)]],_0x57dff9=await _0x342df8[_0x180795(0x656)][_0x180795(0x21f)]();for(const _0xdb17d9 of _0x583e8f){const _0x8394ee=document[_0x180795(0x89c)](_0x180795(0xd69)+_0xdb17d9+'\x22]');if(!_0x8394ee)continue;const _0x3c9381=_0x8394ee[_0x180795(0x118)]['contactType'];if(_0x3c9381===_0x180795(0xa0)){const _0x2c1347=_0x41df36[_0x180795(0x864)][_0xdb17d9];_0x2c1347&&_0xf860fb[_0x180795(0x12a6)]['push']({'id':_0xdb17d9,'originalName':_0x2c1347['originalName'],'groupNickname':_0x2c1347[_0x180795(0x461)],'persona':_0x2c1347[_0x180795(0x886)][_0x180795(0xd83)],'avatar':_0x2c1347[_0x180795(0x886)][_0x180795(0x121e)]||_0x5dc108,'isNpc':![]});}else{if(_0x3c9381==='npc'){const _0x53a689=parseInt(_0x8394ee['dataset']['npcId']),_0x480ea8=_0x57dff9['find'](_0x5a104f=>_0x5a104f['id']===_0x53a689);_0x480ea8&&_0xf860fb[_0x180795(0x12a6)][_0x180795(0x258)]({'id':_0x180795(0x1244)+_0x53a689,'originalName':_0x480ea8[_0x180795(0x461)],'groupNickname':_0x480ea8[_0x180795(0x461)],'persona':_0x480ea8[_0x180795(0x48c)],'avatar':_0x480ea8['avatar']||_0x59100f,'isNpc':!![]});}}}await _0x342df8[_0x180795(0x864)][_0x180795(0x9c0)](_0xf860fb),_0x1a842f();}function _0x239d46(){_0x4ac0e8=!![],_0x1ffa1b(null);}function _0x5cd583(_0x584353,_0x2024f6){const _0x430273=setInterval(()=>{const _0x2c9c6e=_0x42ed,_0x2b5296=Date[_0x2c9c6e(0x108d)](),_0x151824=_0x2024f6-_0x2b5296;if(_0x151824<0x0){clearInterval(_0x430273),_0x584353['innerHTML']=_0x2c9c6e(0x52c);return;}const _0x52ab12=Math[_0x2c9c6e(0xdee)](_0x151824%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x3a8674=Math[_0x2c9c6e(0xdee)](_0x151824%(0x3e8*0x3c)/0x3e8),_0x543693=String(_0x52ab12)[_0x2c9c6e(0xf20)](0x2,'0'),_0x2354d6=String(_0x3a8674)[_0x2c9c6e(0xf20)](0x2,'0');_0x584353[_0x2c9c6e(0x45c)]='<span>'+_0x543693[_0x2c9c6e(0xfcf)](0x0)+'</span><span>'+_0x543693['charAt'](0x1)+'</span>\x20:\x20<span>'+_0x2354d6[_0x2c9c6e(0xfcf)](0x0)+_0x2c9c6e(0xffb)+_0x2354d6[_0x2c9c6e(0xfcf)](0x1)+'</span>';},0x3e8);return _0x430273;}function _0x55d47a(){for(const _0x597404 in _0x33206f){clearInterval(_0x33206f[_0x597404]);}_0x33206f={};}async function _0x3ac728(_0x230d29){const _0x4c5f01=_0x549949,_0x2885fd=_0x41df36[_0x4c5f01(0x864)][_0x41df36['activeChatId']];if(!_0x2885fd)return;const _0x278693=_0x2885fd[_0x4c5f01(0xd08)][_0x4c5f01(0xd12)](_0x464c84=>_0x464c84[_0x4c5f01(0x3b7)]===_0x230d29);if(!_0x278693||![_0x4c5f01(0x990),_0x4c5f01(0xd65)]['includes'](_0x278693[_0x4c5f01(0xa6b)])){console['error'](_0x4c5f01(0x4ed),_0x230d29);return;}let _0x50c2f0='';if(_0x278693[_0x4c5f01(0xa6b)]===_0x4c5f01(0x990)){let _0x5ca337;switch(_0x278693[_0x4c5f01(0x1fe)]){case'paid':const _0x1e9f61=_0x278693[_0x4c5f01(0x78b)]||'对方',_0x3bc699=_0x54d0ab(_0x2885fd,_0x1e9f61);_0x5ca337='由\x20'+_0x3bc699+_0x4c5f01(0x512);break;case'rejected':_0x5ca337=_0x4c5f01(0x171);break;default:_0x5ca337=_0x4c5f01(0xb89);break;}_0x50c2f0=_0x4c5f01(0x6a2)+_0x278693[_0x4c5f01(0x12b1)]+_0x4c5f01(0xaf8)+Number(_0x278693[_0x4c5f01(0xe27)])[_0x4c5f01(0x70d)](0x2)+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20'+_0x5ca337+_0x4c5f01(0xbdd);}else{if(_0x278693['type']===_0x4c5f01(0xd65)){let _0x4be512,_0x151967;_0x2885fd[_0x4c5f01(0x1a2)]?(_0x4be512=_0x54d0ab(_0x2885fd,_0x278693['senderName']),_0x151967=_0x54d0ab(_0x2885fd,_0x278693['recipientName'])):_0x278693[_0x4c5f01(0x10ff)]==='user'?(_0x4be512=_0x2885fd[_0x4c5f01(0x886)][_0x4c5f01(0x52e)]||'我',_0x151967=_0x2885fd['name']):(_0x4be512=_0x2885fd['name'],_0x151967=_0x2885fd[_0x4c5f01(0x886)][_0x4c5f01(0x52e)]||'我'),_0x50c2f0='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20'+_0x4be512+_0x4c5f01(0xd70)+_0x151967+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20'+_0x278693['productInfo']+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥'+Number(_0x278693['amount'])['toFixed'](0x2)+_0x4c5f01(0xbdd);}}await _0x296ef9(_0x4c5f01(0xab9),_0x50c2f0);}async function _0x3bf7d7(_0x227530,_0x49f112){const _0x150901=_0x549949,_0x7b68f7=_0x41df36[_0x150901(0x864)][_0x41df36[_0x150901(0xfc5)]];if(!_0x7b68f7)return;const _0x28af9b=_0x7b68f7[_0x150901(0xd08)][_0x150901(0xe37)](_0x29553a=>_0x29553a[_0x150901(0x3b7)]===_0x227530);if(_0x28af9b===-0x1)return;const _0x56da18=_0x7b68f7[_0x150901(0xd08)][_0x28af9b];_0x56da18['status']=_0x49f112;let _0x120b53;const _0x4866cd=_0x7b68f7[_0x150901(0x1a2)]?_0x7b68f7['settings'][_0x150901(0x52e)]||'我':'我';_0x49f112==='paid'?(_0x56da18[_0x150901(0x78b)]=_0x4866cd,_0x120b53='[系统提示：你\x20('+_0x4866cd+_0x150901(0x69f)+_0x56da18[_0x150901(0x4c5)]+'\x20的外卖订单（时间戳:\x20'+_0x227530+_0x150901(0x751)):_0x120b53=_0x150901(0x989)+_0x4866cd+_0x150901(0xb05)+_0x56da18[_0x150901(0x4c5)]+'\x20的外卖代付请求（时间戳:\x20'+_0x227530+_0x150901(0x27c);const _0x17ba4d={'role':'system','content':_0x120b53,'timestamp':Date[_0x150901(0x108d)](),'isHidden':!![]};_0x7b68f7[_0x150901(0xd08)]['push'](_0x17ba4d),await _0x342df8['chats'][_0x150901(0x9c0)](_0x7b68f7),_0x409076(_0x41df36[_0x150901(0xfc5)]);}let _0x4f60f2={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x31c315=null;async function _0x1d2ff5(){const _0x584448=_0x549949;if(!_0x41df36[_0x584448(0xfc5)]||_0x4f60f2['isActive']||_0x4f60f2[_0x584448(0xe53)])return;const _0x26fa71=_0x41df36['chats'][_0x41df36[_0x584448(0xfc5)]];_0x4f60f2[_0x584448(0xc02)]=_0x26fa71[_0x584448(0x1a2)],_0x4f60f2[_0x584448(0xe53)]=!![],_0x4f60f2[_0x584448(0xe35)]='user',_0x4f60f2[_0x584448(0xfc5)]=_0x26fa71['id'],_0x4f60f2['isUserParticipating']=!![];_0x26fa71[_0x584448(0x1a2)]?(document['getElementById']('outgoing-call-avatar')[_0x584448(0xf6c)]=_0x26fa71[_0x584448(0x886)]['myAvatar']||_0x188ace,document[_0x584448(0x383)](_0x584448(0xfee))['textContent']=_0x26fa71[_0x584448(0x886)][_0x584448(0x52e)]||'我'):(document[_0x584448(0x383)]('outgoing-call-avatar')['src']=_0x26fa71[_0x584448(0x886)][_0x584448(0x121e)]||_0x5dc108,document[_0x584448(0x383)]('outgoing-call-name')[_0x584448(0x138e)]=_0x26fa71['name']);document[_0x584448(0x89c)]('#outgoing-call-screen\x20.caller-text')['textContent']=_0x26fa71[_0x584448(0x1a2)]?_0x584448(0x51f):_0x584448(0xf06),_0x105acd(_0x584448(0x136b));const _0x238ba3={'role':_0x584448(0xb1),'content':_0x26fa71[_0x584448(0x1a2)]?_0x584448(0x11d9)+(_0x26fa71[_0x584448(0x886)]['myNickname']||'我')+_0x584448(0xafc):_0x584448(0xa95),'timestamp':Date[_0x584448(0x108d)](),'isHidden':!![]};_0x26fa71['history'][_0x584448(0x258)](_0x238ba3),await _0x342df8['chats'][_0x584448(0x9c0)](_0x26fa71),await _0x11e743();}function _0x267991(){const _0x50e451=_0x549949,_0x5dd96e=_0x41df36[_0x50e451(0x864)][_0x4f60f2[_0x50e451(0xfc5)]];if(!_0x5dd96e)return;_0x4f60f2['isActive']=!![],_0x4f60f2[_0x50e451(0xe53)]=![],_0x4f60f2[_0x50e451(0xf71)]=Date[_0x50e451(0x108d)](),_0x4f60f2[_0x50e451(0x1184)]=[];const _0x177b01=_0x5dd96e[_0x50e451(0xd08)][_0x50e451(0x1368)](-0xa);_0x4f60f2[_0x50e451(0x6d3)]=_0x177b01[_0x50e451(0xa79)](_0x220fb8=>{const _0x2c7c57=_0x50e451,_0x17348f=_0x220fb8['role']===_0x2c7c57(0x66e)?_0x5dd96e['settings'][_0x2c7c57(0x52e)]||'我':_0x220fb8[_0x2c7c57(0x4c5)]||_0x5dd96e[_0x2c7c57(0x461)];return _0x17348f+':\x20'+String(_0x220fb8[_0x2c7c57(0x11b6)])[_0x2c7c57(0xba5)](0x0,0x32)+_0x2c7c57(0x1026);})[_0x50e451(0xa35)]('\x0a'),_0x49edbc(),document[_0x50e451(0x383)]('video-call-main')[_0x50e451(0x45c)]='<em>'+(_0x4f60f2['isGroupCall']?_0x50e451(0x4a8):_0x50e451(0x129d))+'</em>',_0x105acd('video-call-screen'),document['getElementById'](_0x50e451(0x1009))[_0x50e451(0x655)][_0x50e451(0x2b6)]=_0x4f60f2[_0x50e451(0xb6)]?_0x50e451(0x27a):_0x50e451(0xa70),document[_0x50e451(0x383)](_0x50e451(0xa9f))[_0x50e451(0x655)][_0x50e451(0x2b6)]=_0x4f60f2['isUserParticipating']?_0x50e451(0xa70):_0x50e451(0x27a);if(_0x31c315)clearInterval(_0x31c315);_0x31c315=setInterval(_0x13b22f,0x3e8),_0x13b22f(),_0x2928c4();}async function _0x2d9610(){const _0x326b77=_0x549949;if(!_0x4f60f2['isActive'])return;const _0x179b30=Math['floor']((Date[_0x326b77(0x108d)]()-_0x4f60f2['startTime'])/0x3e8),_0x35f815=Math['floor'](_0x179b30/0x3c)+'分'+_0x179b30%0x3c+'秒',_0x3b765c='通话结束，时长\x20'+_0x35f815,_0x57dea3=_0x41df36[_0x326b77(0x864)][_0x4f60f2[_0x326b77(0xfc5)]];if(_0x57dea3){const _0x2325c0=[];_0x4f60f2[_0x326b77(0xc02)]?(_0x4f60f2[_0x326b77(0x9a6)]['forEach'](_0x50fd2d=>_0x2325c0[_0x326b77(0x258)]({'name':_0x50fd2d[_0x326b77(0x283)],'avatar':_0x50fd2d[_0x326b77(0xb47)]})),_0x4f60f2[_0x326b77(0xb6)]&&_0x2325c0[_0x326b77(0xe6e)]({'name':_0x57dea3[_0x326b77(0x886)][_0x326b77(0x52e)]||'我','avatar':_0x57dea3[_0x326b77(0x886)][_0x326b77(0x43a)]||_0x188ace})):(_0x2325c0[_0x326b77(0x258)]({'name':_0x57dea3['name'],'avatar':_0x57dea3[_0x326b77(0x886)][_0x326b77(0x121e)]||_0x5dc108}),_0x2325c0[_0x326b77(0xe6e)]({'name':'我','avatar':_0x57dea3['settings'][_0x326b77(0x43a)]||_0x5dc108}));const _0x1ba23b={'chatId':_0x4f60f2['activeChatId'],'timestamp':Date[_0x326b77(0x108d)](),'duration':_0x179b30,'participants':_0x2325c0,'transcript':[..._0x4f60f2[_0x326b77(0x1184)]]};await _0x342df8[_0x326b77(0xdb9)]['add'](_0x1ba23b),console['log'](_0x326b77(0xd35),_0x1ba23b);let _0x15f09c={'role':_0x4f60f2[_0x326b77(0xe35)]===_0x326b77(0x66e)?_0x326b77(0x66e):_0x326b77(0xf3c),'content':_0x3b765c,'timestamp':Date[_0x326b77(0x108d)]()};_0x57dea3['isGroup']&&_0x15f09c['role']===_0x326b77(0xf3c)&&(_0x15f09c[_0x326b77(0x4c5)]=_0x4f60f2['callRequester']||_0x57dea3['members'][0x0]?.[_0x326b77(0x283)]||_0x57dea3[_0x326b77(0x461)]);_0x57dea3[_0x326b77(0xd08)][_0x326b77(0x258)](_0x15f09c);const _0x190238=_0x4f60f2[_0x326b77(0x1184)][_0x326b77(0xa79)](_0x4e8538=>{const _0x141e79=_0x326b77,_0x5a6d25=_0x4e8538['role']===_0x141e79(0x66e)?_0x57dea3[_0x141e79(0x886)]['myNickname']||'我':_0x4e8538[_0x141e79(0x4c5)];return _0x5a6d25+':\x20'+_0x4e8538['content'];})[_0x326b77(0xa35)]('\x0a');_0x5ef3b0(_0x57dea3['id'],_0x190238);const _0x10a281={'role':_0x326b77(0xb1),'content':_0x326b77(0xe50),'timestamp':Date[_0x326b77(0x108d)]()+0x1,'isHidden':!![]};_0x57dea3[_0x326b77(0xd08)][_0x326b77(0x258)](_0x10a281),await _0x342df8[_0x326b77(0x864)][_0x326b77(0x9c0)](_0x57dea3);}clearInterval(_0x31c315),_0x31c315=null,_0x4f60f2={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x57dea3&&(_0x4a08c7(_0x57dea3['id']),_0x11e743());}function _0x49edbc(){const _0x40d01f=_0x549949,_0x41f9b7=document['getElementById'](_0x40d01f(0xed7));_0x41f9b7[_0x40d01f(0x45c)]='';const _0x17fbc1=_0x41df36[_0x40d01f(0x864)][_0x4f60f2[_0x40d01f(0xfc5)]];if(!_0x17fbc1)return;let _0xc33e82=[];_0x4f60f2[_0x40d01f(0xc02)]?(_0xc33e82=[..._0x4f60f2[_0x40d01f(0x9a6)]],_0x4f60f2[_0x40d01f(0xb6)]&&_0xc33e82[_0x40d01f(0xe6e)]({'id':'user','name':_0x17fbc1['settings'][_0x40d01f(0x52e)]||'我','avatar':_0x17fbc1[_0x40d01f(0x886)][_0x40d01f(0x43a)]||_0x188ace})):_0xc33e82[_0x40d01f(0x258)]({'id':'ai','name':_0x17fbc1[_0x40d01f(0x461)],'avatar':_0x17fbc1[_0x40d01f(0x886)]['aiAvatar']||_0x5dc108}),_0xc33e82[_0x40d01f(0x19c)](_0x30334a=>{const _0x345fc5=_0x40d01f,_0x39e9ee=document['createElement'](_0x345fc5(0x7fd));_0x39e9ee[_0x345fc5(0x556)]=_0x345fc5(0x2c8),_0x39e9ee[_0x345fc5(0x118)][_0x345fc5(0x6ce)]=_0x30334a['id'];const _0x36c01e=_0x30334a[_0x345fc5(0x9da)]||_0x30334a[_0x345fc5(0x461)];_0x39e9ee[_0x345fc5(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x30334a[_0x345fc5(0xb47)]+_0x345fc5(0x289)+_0x36c01e+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>'+_0x36c01e+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x41f9b7[_0x345fc5(0xe91)](_0x39e9ee);});}function _0x13b6ef(){const _0x5ccba5=_0x549949;if(!_0x4f60f2['isActive']||_0x4f60f2[_0x5ccba5(0xb6)])return;_0x4f60f2[_0x5ccba5(0xb6)]=!![],_0x49edbc(),document[_0x5ccba5(0x383)]('user-speak-btn')['style'][_0x5ccba5(0x2b6)]=_0x5ccba5(0x27a),document['getElementById'](_0x5ccba5(0xa9f))[_0x5ccba5(0x655)][_0x5ccba5(0x2b6)]=_0x5ccba5(0xa70),_0x2928c4(_0x5ccba5(0x378));}function _0x13b22f(){const _0x121c11=_0x549949;if(!_0x4f60f2[_0x121c11(0x40d)])return;const _0x35476f=Math[_0x121c11(0xdee)]((Date[_0x121c11(0x108d)]()-_0x4f60f2[_0x121c11(0xf71)])/0x3e8),_0x3b4b98=Math['floor'](_0x35476f/0x3c),_0x479fbb=_0x35476f%0x3c;document[_0x121c11(0x383)](_0x121c11(0x2ed))[_0x121c11(0x138e)]=String(_0x3b4b98)[_0x121c11(0xf20)](0x2,'0')+':'+String(_0x479fbb)[_0x121c11(0xf20)](0x2,'0');}function _0x3ef794(){const _0x4ccccb=_0x549949,_0x6502b7=_0x41df36['chats'][_0x41df36[_0x4ccccb(0xfc5)]];if(!_0x6502b7)return;if(_0x6502b7[_0x4ccccb(0x1a2)]){const _0x1f10e6=_0x4f60f2[_0x4ccccb(0x496)]||_0x6502b7['members'][0x0]?.[_0x4ccccb(0x461)]||_0x4ccccb(0x7c8);document[_0x4ccccb(0x383)](_0x4ccccb(0xda2))[_0x4ccccb(0xf6c)]=_0x6502b7[_0x4ccccb(0x886)][_0x4ccccb(0x332)]||_0x3e0950,document[_0x4ccccb(0x383)](_0x4ccccb(0xf19))[_0x4ccccb(0x138e)]=_0x6502b7[_0x4ccccb(0x461)],document[_0x4ccccb(0x89c)](_0x4ccccb(0x16b))[_0x4ccccb(0x138e)]=_0x1f10e6+'\x20邀请你加入群视频';}else document[_0x4ccccb(0x383)](_0x4ccccb(0xda2))['src']=_0x6502b7[_0x4ccccb(0x886)]['aiAvatar']||_0x5dc108,document['getElementById'](_0x4ccccb(0xf19))[_0x4ccccb(0x138e)]=_0x6502b7[_0x4ccccb(0x461)],document['querySelector']('.incoming-call-content\x20.caller-text')[_0x4ccccb(0x138e)]=_0x4ccccb(0x1067);document['getElementById'](_0x4ccccb(0x9a8))['classList'][_0x4ccccb(0xbff)](_0x4ccccb(0x106d));}function _0x3ad02b(){const _0xaf1ccb=_0x549949;document[_0xaf1ccb(0x383)](_0xaf1ccb(0x9a8))['classList']['remove']('visible');}async function _0x2928c4(_0xe0dfc5=null){const _0x2f56e=_0x549949;if(!_0x4f60f2[_0x2f56e(0x40d)])return;const _0xe0b507=_0x41df36[_0x2f56e(0x864)][_0x4f60f2[_0x2f56e(0xfc5)]],{proxyUrl:_0x38b948,apiKey:_0x592fa6,model:_0x5c2d3b}=_0x41df36[_0x2f56e(0x673)],_0x40a19a=document['getElementById'](_0x2f56e(0xeca)),_0x3eef36=_0xe0b507[_0x2f56e(0x886)][_0x2f56e(0x52e)]||'我';let _0x12608f='';if(_0xe0b507['settings'][_0x2f56e(0xe8c)]&&_0xe0b507[_0x2f56e(0x886)]['linkedWorldBookIds'][_0x2f56e(0xfde)]>0x0){const _0x33c907=_0xe0b507[_0x2f56e(0x886)][_0x2f56e(0xe8c)][_0x2f56e(0xa79)](_0x3ef3f0=>{const _0x2ebdcc=_0x2f56e,_0x4dbca1=_0x41df36[_0x2ebdcc(0xf17)][_0x2ebdcc(0xd12)](_0x24f2d8=>_0x24f2d8['id']===_0x3ef3f0);return _0x4dbca1&&_0x4dbca1[_0x2ebdcc(0x11b6)]?_0x2ebdcc(0x6f9)+_0x4dbca1[_0x2ebdcc(0x461)]+'\x0a'+_0x4dbca1['content']:'';})['filter'](Boolean)[_0x2f56e(0xa35)]('');_0x33c907&&(_0x12608f='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x33c907+_0x2f56e(0x84f));}if(_0xe0dfc5&&_0x4f60f2['isUserParticipating']){const _0x2d3400=Date['now'](),_0x56460c=document[_0x2f56e(0xe1b)](_0x2f56e(0x7fd));_0x56460c[_0x2f56e(0x556)]=_0x2f56e(0x1152),_0x56460c[_0x2f56e(0x138e)]=_0xe0dfc5,_0x56460c[_0x2f56e(0x118)][_0x2f56e(0x3b7)]=_0x2d3400,_0x3e15d1(_0x56460c,()=>_0x55a6de(_0x2d3400)),_0x40a19a['appendChild'](_0x56460c),_0x40a19a[_0x2f56e(0x4f9)]=_0x40a19a[_0x2f56e(0x36d)],_0x4f60f2[_0x2f56e(0x1184)][_0x2f56e(0x258)]({'role':'user','content':_0xe0dfc5,'timestamp':_0x2d3400});}let _0x381014;if(_0x4f60f2[_0x2f56e(0xc02)]){const _0x1d02ac=_0x4f60f2[_0x2f56e(0x9a6)]['map'](_0x4e13c6=>_0x4e13c6['name']);_0x4f60f2['isUserParticipating']&&_0x1d02ac[_0x2f56e(0xe6e)](_0x3eef36),_0x381014=_0x2f56e(0x1016)+_0x3eef36+_0x2f56e(0xe8)+_0x3eef36+_0x2f56e(0x1134)+_0x4f60f2[_0x2f56e(0x6d3)]+_0x2f56e(0x475)+_0x1d02ac[_0x2f56e(0xa35)]('、\x20')+_0x2f56e(0x347)+_0x12608f+'\x20//\x20<--\x20【核心】注入世界书\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}else{let _0x5187a9=_0x4f60f2['initiator']===_0x2f56e(0x66e)?_0x2f56e(0x164):_0x2f56e(0xbfa);_0x381014=_0x2f56e(0x11b8)+_0xe0b507[_0x2f56e(0x461)]+'\x20('+_0xe0b507[_0x2f56e(0x886)][_0x2f56e(0xd83)]+_0x2f56e(0xa7e)+_0xe0b507[_0x2f56e(0x461)]+_0x2f56e(0x998)+_0x3eef36+_0x2f56e(0x6aa)+_0xe0b507[_0x2f56e(0x886)][_0x2f56e(0xe63)]+_0x2f56e(0x405)+_0x5187a9+_0x2f56e(0xb67)+_0x4f60f2[_0x2f56e(0x6d3)]+_0x2f56e(0x955);}const _0x4fd1c2=[{'role':_0x2f56e(0xb1),'content':_0x381014},..._0x4f60f2[_0x2f56e(0x1184)][_0x2f56e(0xa79)](_0x4b6383=>({'role':_0x4b6383[_0x2f56e(0x10ff)],'content':_0x4b6383[_0x2f56e(0x11b6)]}))];if(_0x4f60f2['callHistory'][_0x2f56e(0xfde)]===0x0){const _0x201fae=_0x4f60f2[_0x2f56e(0xe35)]===_0x2f56e(0x66e)?_0x2f56e(0xbe2):_0x2f56e(0xdfb);_0x4fd1c2[_0x2f56e(0x258)]({'role':'user','content':_0x201fae});}try{let _0x594602=_0x38b948===GEMINI_API_URL,_0x3c5084=_0x112768(_0x5c2d3b,_0x592fa6,_0x381014,_0x4fd1c2);const _0x4cdf29=_0x594602?await fetch(_0x3c5084[_0x2f56e(0x2fa)],_0x3c5084[_0x2f56e(0x8c6)]):await fetch(_0x38b948+_0x2f56e(0x126b),{'method':_0x2f56e(0x94f),'headers':{'Content-Type':_0x2f56e(0x11f0),'Authorization':_0x2f56e(0xd55)+_0x592fa6},'body':JSON['stringify']({'model':_0x5c2d3b,'messages':_0x4fd1c2,'temperature':_0x41df36[_0x2f56e(0xc0)][_0x2f56e(0xa4a)]||0.8})});if(!_0x4cdf29['ok'])throw new Error((await _0x4cdf29['json']())['error'][_0x2f56e(0x5f8)]);const _0x5aa082=await _0x4cdf29['json'](),_0x117fae=_0x594602?_0x5aa082[_0x2f56e(0x5fa)][0x0][_0x2f56e(0x11b6)][_0x2f56e(0xf6d)][0x0]['text']:_0x5aa082[_0x2f56e(0xe77)][0x0][_0x2f56e(0x5f8)]['content'],_0x315ee8=_0x40a19a[_0x2f56e(0x89c)]('em');if(_0x315ee8)_0x315ee8[_0x2f56e(0x131d)]();if(_0x4f60f2[_0x2f56e(0xc02)]){const _0x2aee57=_0x28b8fa(_0x117fae);_0x2aee57[_0x2f56e(0x19c)](_0x10e718=>{const _0x5cad9a=_0x2f56e;if(!_0x10e718[_0x5cad9a(0x461)]||_0x10e718['name']===_0x3eef36||!_0x10e718[_0x5cad9a(0x5db)])return;const _0x2657ab=Date[_0x5cad9a(0x108d)]()+Math[_0x5cad9a(0x5ce)](),_0x2a4e26=document['createElement'](_0x5cad9a(0x7fd));_0x2a4e26[_0x5cad9a(0x556)]=_0x5cad9a(0x1093),_0x2a4e26[_0x5cad9a(0x45c)]='<strong>'+_0x10e718[_0x5cad9a(0x461)]+_0x5cad9a(0x11a9)+_0x10e718[_0x5cad9a(0x5db)],_0x2a4e26['dataset']['timestamp']=_0x2657ab,_0x3e15d1(_0x2a4e26,()=>_0x55a6de(_0x2657ab)),_0x40a19a[_0x5cad9a(0xe91)](_0x2a4e26),_0x4f60f2[_0x5cad9a(0x1184)]['push']({'role':_0x5cad9a(0xf3c),'content':_0x10e718[_0x5cad9a(0x461)]+':\x20'+_0x10e718[_0x5cad9a(0x5db)],'timestamp':_0x2657ab});const _0x488580=_0x4f60f2['participants']['find'](_0x3ca07b=>_0x3ca07b[_0x5cad9a(0x461)]===_0x10e718['name']);if(_0x488580){const _0x3361e4=document['querySelector'](_0x5cad9a(0xa76)+_0x488580['id']+_0x5cad9a(0x113f));_0x3361e4&&(_0x3361e4[_0x5cad9a(0x119a)]['add'](_0x5cad9a(0x632)),setTimeout(()=>_0x3361e4['classList'][_0x5cad9a(0x131d)](_0x5cad9a(0x632)),0x7d0));}});}else{const _0x4fae1f=Date['now'](),_0x2284fe=document[_0x2f56e(0xe1b)](_0x2f56e(0x7fd));_0x2284fe[_0x2f56e(0x556)]='call-message-bubble\x20ai-speech',_0x2284fe['textContent']=_0x117fae,_0x2284fe['dataset']['timestamp']=_0x4fae1f,_0x3e15d1(_0x2284fe,()=>_0x55a6de(_0x4fae1f)),_0x40a19a[_0x2f56e(0xe91)](_0x2284fe),_0x4f60f2[_0x2f56e(0x1184)][_0x2f56e(0x258)]({'role':_0x2f56e(0xf3c),'content':_0x117fae,'timestamp':_0x4fae1f});const _0x3aaa07=document[_0x2f56e(0x89c)]('.participant-avatar-wrapper\x20.participant-avatar');_0x3aaa07&&(_0x3aaa07[_0x2f56e(0x119a)][_0x2f56e(0xbff)](_0x2f56e(0x632)),setTimeout(()=>_0x3aaa07[_0x2f56e(0x119a)][_0x2f56e(0x131d)](_0x2f56e(0x632)),0x7d0));}_0x40a19a[_0x2f56e(0x4f9)]=_0x40a19a[_0x2f56e(0x36d)];}catch(_0xd38087){const _0x42b101=document['createElement'](_0x2f56e(0x7fd));_0x42b101['className']='call-message-bubble\x20ai-speech',_0x42b101[_0x2f56e(0x655)][_0x2f56e(0x1081)]=_0x2f56e(0x113d),_0x42b101[_0x2f56e(0x138e)]=_0x2f56e(0x112e)+_0xd38087[_0x2f56e(0x5f8)]+']',_0x40a19a[_0x2f56e(0xe91)](_0x42b101),_0x40a19a[_0x2f56e(0x4f9)]=_0x40a19a['scrollHeight'],_0x4f60f2[_0x2f56e(0x1184)][_0x2f56e(0x258)]({'role':_0x2f56e(0xf3c),'content':_0x2f56e(0x112e)+_0xd38087[_0x2f56e(0x5f8)]+']'});}}function _0x3b2799(_0x425ea4){const _0x198074=_0x549949;document[_0x198074(0x383)]('video-call-btn')[_0x198074(0x655)][_0x198074(0x2b6)]=_0x425ea4?_0x198074(0xa70):_0x198074(0x2aa),document[_0x198074(0x383)](_0x198074(0xfa4))[_0x198074(0x655)][_0x198074(0x2b6)]=_0x425ea4?_0x198074(0x2aa):_0x198074(0xa70);}async function _0x3bf7d7(_0x5b32e3,_0x1c0386){const _0x599022=_0x549949,_0x121346=_0x41df36[_0x599022(0x864)][_0x41df36['activeChatId']];if(!_0x121346)return;const _0x2d5db0=_0x121346['history']['findIndex'](_0x43c3d0=>_0x43c3d0[_0x599022(0x3b7)]===_0x5b32e3);if(_0x2d5db0===-0x1)return;const _0x1772a9=_0x121346[_0x599022(0xd08)][_0x2d5db0];_0x1772a9['status']=_0x1c0386;let _0x1e8e7c;const _0x1b932d=_0x121346['isGroup']?_0x121346[_0x599022(0x886)]['myNickname']||'我':'我';_0x1c0386===_0x599022(0x96d)?(_0x1772a9[_0x599022(0x78b)]=_0x1b932d,_0x1e8e7c=_0x599022(0x989)+_0x1b932d+_0x599022(0x69f)+_0x1772a9['senderName']+_0x599022(0x7d1)+_0x5b32e3+'）完成了支付。此订单已关闭，其他成员不能再支付。]'):_0x1e8e7c='[系统提示：你\x20('+_0x1b932d+_0x599022(0xb05)+_0x1772a9[_0x599022(0x4c5)]+_0x599022(0x9a0)+_0x5b32e3+_0x599022(0x27c);const _0x1eafc1={'role':_0x599022(0xb1),'content':_0x1e8e7c,'timestamp':Date[_0x599022(0x108d)](),'isHidden':!![]};_0x121346[_0x599022(0xd08)][_0x599022(0x258)](_0x1eafc1),await _0x342df8[_0x599022(0x864)]['put'](_0x121346),_0x409076(_0x41df36[_0x599022(0xfc5)]),_0x1c0386==='paid'&&_0x11e743();}async function _0x70854a(_0x3d3e42,_0x24075f){const _0x3d6d4a=_0x549949,_0x4b3547=_0x41df36['chats'][_0x3d3e42];if(!_0x4b3547)return;let _0x3adadf;_0x4b3547['isGroup']?_0x3adadf=_0x54d0ab(_0x4b3547,_0x24075f):_0x3adadf=_0x4b3547[_0x3d6d4a(0x461)];const _0x1b7142=document[_0x3d6d4a(0x383)](_0x3d6d4a(0x1200));_0x1b7142[_0x3d6d4a(0x119a)]['remove'](_0x3d6d4a(0x406)),void _0x1b7142[_0x3d6d4a(0x5f9)],_0x1b7142[_0x3d6d4a(0x119a)][_0x3d6d4a(0xbff)](_0x3d6d4a(0x406));const _0x49f038=await _0x12e332(_0x3d6d4a(0x832)+_0x3adadf+'”',_0x3d6d4a(0x1014),'',_0x3d6d4a(0x6af));if(_0x49f038===null)return;const _0x5de50f=_0x54d0ab(_0x4b3547,_0x41df36[_0x3d6d4a(0x571)]['nickname']),_0x104c28=_0x5de50f+'\x20拍了拍\x20“'+_0x3adadf+'”\x20'+_0x49f038[_0x3d6d4a(0x1cb)](),_0x3ff536={'role':_0x3d6d4a(0xb1),'type':_0x3d6d4a(0xed8),'content':_0x104c28,'timestamp':Date['now']()};_0x4b3547[_0x3d6d4a(0xd08)][_0x3d6d4a(0x258)](_0x3ff536);const _0x544510=_0x3d6d4a(0x7c6)+_0x5de50f+'）刚刚拍了拍你（'+_0x24075f+'）'+_0x49f038[_0x3d6d4a(0x1cb)]()+'。请你对此作出回应。]',_0xbbe030={'role':'system','content':_0x544510,'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x4b3547[_0x3d6d4a(0xd08)][_0x3d6d4a(0x258)](_0xbbe030),await _0x342df8[_0x3d6d4a(0x864)]['put'](_0x4b3547),_0x41df36[_0x3d6d4a(0xfc5)]===_0x3d3e42&&_0x323467(_0x3ff536,_0x4b3547),await _0x25558e();}let _0x38d9a=null,_0x1aa341=![],_0x1ccd4c=new Set();function _0x55a6de(_0x4ae4fc){const _0x1af36e=_0x549949;_0x38d9a=_0x4ae4fc,document['getElementById'](_0x1af36e(0xa81))[_0x1af36e(0x119a)][_0x1af36e(0xbff)](_0x1af36e(0x106d));}function _0x42d98e(){const _0x2666e3=_0x549949;document['getElementById']('call-message-actions-modal')['classList'][_0x2666e3(0x131d)]('visible'),_0x38d9a=null;}async function _0x1f87c2(){const _0x184147=_0x549949;if(!_0x38d9a)return;const _0x44bc10=_0x38d9a,_0x4ffdda=_0x4f60f2[_0x184147(0x1184)][_0x184147(0xd12)](_0x3cce3e=>_0x3cce3e[_0x184147(0x3b7)]===_0x44bc10);if(!_0x4ffdda)return;_0x42d98e();let _0x3525ac=_0x4ffdda[_0x184147(0x11b6)];if(_0x4f60f2[_0x184147(0xc02)]&&_0x4ffdda['role']===_0x184147(0xf3c)){const _0x205a4a=_0x4ffdda['content']['split'](':\x20');_0x205a4a['length']>0x1&&(_0x3525ac=_0x205a4a[_0x184147(0x1368)](0x1)['join'](':\x20'));}const _0x37814a=await _0x12e332(_0x184147(0x12b5),_0x184147(0xb08),_0x3525ac,_0x184147(0xfe5));_0x37814a!==null&&await _0x5fe50e(_0x44bc10,_0x37814a);}async function _0x5fe50e(_0x24577c,_0x59a4de){const _0x115949=_0x549949,_0x1a0b1e=_0x4f60f2[_0x115949(0x1184)][_0x115949(0xd12)](_0x5ad526=>_0x5ad526[_0x115949(0x3b7)]===_0x24577c);if(_0x1a0b1e){let _0x253d70=_0x59a4de;if(_0x4f60f2[_0x115949(0xc02)]&&_0x1a0b1e[_0x115949(0x10ff)]===_0x115949(0xf3c)){const _0x4d2a3b=_0x1a0b1e[_0x115949(0x11b6)][_0x115949(0x105d)](':\x20'),_0x1fface=_0x4d2a3b[0x0];_0x253d70=_0x1fface+':\x20'+_0x59a4de;}_0x1a0b1e[_0x115949(0x11b6)]=_0x253d70;const _0x3ff483=document['querySelector']('.call-message-bubble[data-timestamp=\x22'+_0x24577c+'\x22]');if(_0x3ff483){if(_0x4f60f2['isGroupCall']&&_0x1a0b1e[_0x115949(0x10ff)]==='assistant'){const _0x2ef0a5=_0x1a0b1e[_0x115949(0x11b6)]['split'](':\x20'),_0x1a8a5d=_0x2ef0a5[0x0];_0x3ff483[_0x115949(0x45c)]=_0x115949(0xfc6)+_0x1a8a5d+_0x115949(0x11a9)+_0x59a4de;}else _0x3ff483[_0x115949(0x138e)]=_0x59a4de;}}await _0x296ef9('成功',_0x115949(0x49c));}async function _0x4faede(){const _0x4c8743=_0x549949;if(!_0x38d9a)return;const _0x44b21e=await _0x23a88b(_0x4c8743(0xa5b),'确定要删除这条通话消息吗？',{'confirmButtonClass':_0x4c8743(0x51b)});if(_0x44b21e){const _0x4a6d28=_0x38d9a;_0x42d98e();const _0x57fd38=_0x4f60f2['callHistory'][_0x4c8743(0xe37)](_0x46c704=>_0x46c704['timestamp']===_0x4a6d28);_0x57fd38>-0x1&&_0x4f60f2['callHistory'][_0x4c8743(0x2f1)](_0x57fd38,0x1);const _0x53511d=document[_0x4c8743(0x89c)]('.call-message-bubble[data-timestamp=\x22'+_0x4a6d28+'\x22]');_0x53511d&&_0x53511d[_0x4c8743(0x131d)]();}else _0x42d98e();}function _0x65c610(_0x432b25){const _0x40f1bf=_0x549949;_0x51fd05=_0x432b25;const _0x359707=_0x41df36[_0x40f1bf(0x864)][_0x41df36['activeChatId']],_0x54373e=_0x359707[_0x40f1bf(0xd08)][_0x40f1bf(0xd12)](_0x16c29a=>_0x16c29a[_0x40f1bf(0x3b7)]===_0x432b25);_0x54373e&&(document[_0x40f1bf(0x383)](_0x40f1bf(0x10ba))[_0x40f1bf(0x138e)]=_0x54373e[_0x40f1bf(0x4c5)]),document[_0x40f1bf(0x383)](_0x40f1bf(0x9ce))['classList'][_0x40f1bf(0xbff)](_0x40f1bf(0x106d));}function _0x2a7cee(){const _0x2002b7=_0x549949;document[_0x2002b7(0x383)](_0x2002b7(0x9ce))['classList'][_0x2002b7(0x131d)](_0x2002b7(0x106d)),_0x51fd05=null;}async function _0x5a9c8a(_0x47a4b0){const _0x473a20=_0x549949;if(!_0x51fd05)return;const _0x190d5f=_0x51fd05,_0x3662e9=_0x41df36[_0x473a20(0x864)][_0x41df36[_0x473a20(0xfc5)]],_0x56e526=_0x3662e9['history'][_0x473a20(0xe37)](_0x5b0f35=>_0x5b0f35[_0x473a20(0x3b7)]===_0x190d5f);if(_0x56e526===-0x1)return;const _0x1f6bf9=_0x3662e9[_0x473a20(0xd08)][_0x56e526];_0x1f6bf9[_0x473a20(0x1fe)]=_0x47a4b0;let _0x20aa2c;if(_0x47a4b0==='declined'){const _0xc7703d={'role':_0x473a20(0x66e),'type':_0x473a20(0x909),'isRefund':!![],'amount':_0x1f6bf9[_0x473a20(0xe27)],'note':_0x473a20(0x951),'timestamp':Date[_0x473a20(0x108d)]()};_0x3662e9[_0x473a20(0xd08)]['push'](_0xc7703d),_0x20aa2c=_0x473a20(0xbfc)+_0x1f6bf9[_0x473a20(0x4c5)]+_0x473a20(0xd0f);}else _0x20aa2c=_0x473a20(0xec8)+_0x1f6bf9[_0x473a20(0x4c5)]+_0x473a20(0xd0f);const _0x11e28b={'role':_0x473a20(0xb1),'content':_0x20aa2c,'timestamp':Date[_0x473a20(0x108d)]()+0x1,'isHidden':!![]};_0x3662e9['history']['push'](_0x11e28b),await _0x342df8['chats']['put'](_0x3662e9),_0x2a7cee(),_0x409076(_0x41df36[_0x473a20(0xfc5)]),_0x25558e();}function _0x567149(_0x2c812b){const _0x2c1bed=_0x549949;_0x57bd10=null;if(_0x2c812b){const _0x42fc18=_0x2c812b[_0x2c1bed(0x89c)]('.comment-input');_0x42fc18&&(_0x42fc18[_0x2c1bed(0xda9)]=_0x2c1bed(0x1263));}}async function _0x5bddd7(){const _0x29c314=_0x549949,_0xc6af1f=document[_0x29c314(0x383)](_0x29c314(0xecb));_0xc6af1f[_0x29c314(0x45c)]='';const _0x4a7767=await _0x342df8['memories'][_0x29c314(0x4b1)](_0x29c314(0x3b7))[_0x29c314(0x1087)]()[_0x29c314(0x21f)]();if(_0x4a7767['length']===0x0){_0xc6af1f[_0x29c314(0x45c)]=_0x29c314(0x55d);return;}_0x4a7767[_0x29c314(0x1296)]((_0x28c9a4,_0x5e4d81)=>{const _0x18cf3a=_0x29c314,_0x47a118=_0x28c9a4[_0x18cf3a(0xa6b)]==='countdown'&&_0x28c9a4[_0x18cf3a(0x1175)]>Date[_0x18cf3a(0x108d)](),_0x930282=_0x5e4d81['type']===_0x18cf3a(0x145)&&_0x5e4d81[_0x18cf3a(0x1175)]>Date[_0x18cf3a(0x108d)]();if(_0x47a118&&!_0x930282)return-0x1;if(!_0x47a118&&_0x930282)return 0x1;if(_0x47a118&&_0x930282)return _0x28c9a4['targetDate']-_0x5e4d81['targetDate'];return 0x0;}),_0x4a7767[_0x29c314(0x19c)](_0x510868=>{const _0xfa909a=_0x29c314;let _0x5485c9;_0x510868[_0xfa909a(0xa6b)]===_0xfa909a(0x145)&&_0x510868[_0xfa909a(0x1175)]>Date[_0xfa909a(0x108d)]()?_0x5485c9=_0x1082a8(_0x510868):_0x5485c9=_0x3aa97e(_0x510868),_0xc6af1f[_0xfa909a(0xe91)](_0x5485c9);}),_0x1b1ec8();}function _0x3aa97e(_0x3d6ef7){const _0x17d404=_0x549949,_0xb5242b=document[_0x17d404(0xe1b)](_0x17d404(0x7fd));_0xb5242b[_0x17d404(0x556)]='memory-card';const _0x5a84cc=new Date(_0x3d6ef7[_0x17d404(0x3b7)]),_0x3aa635=_0x5a84cc[_0x17d404(0xdf9)]()+'-'+String(_0x5a84cc[_0x17d404(0xf4f)]()+0x1)[_0x17d404(0xf20)](0x2,'0')+'-'+String(_0x5a84cc['getDate']())['padStart'](0x2,'0')+'\x20'+String(_0x5a84cc[_0x17d404(0x793)]())[_0x17d404(0xf20)](0x2,'0')+':'+String(_0x5a84cc['getMinutes']())[_0x17d404(0xf20)](0x2,'0');let _0x554954,_0x1a8604;if(_0x3d6ef7['type']==='countdown'&&_0x3d6ef7[_0x17d404(0x1175)])_0x554954='[约定达成]\x20'+_0x3d6ef7[_0x17d404(0xee1)],_0x1a8604=_0x350d3e('在\x20'+new Date(_0x3d6ef7['targetDate'])[_0x17d404(0xa2b)]()+_0x17d404(0x1201))[_0x17d404(0x709)](/\n/g,_0x17d404(0x3ee));else{let _0x2a98c9='我们的回忆';if(_0x3d6ef7[_0x17d404(0x1301)]){const _0x1d78e6=_0x41df36[_0x17d404(0x864)][_0x3d6ef7[_0x17d404(0x1301)]];_0x1d78e6?_0x2a98c9=_0x1d78e6[_0x17d404(0x461)]:_0x2a98c9=_0x3d6ef7['authorName']||'一位朋友';}else _0x3d6ef7[_0x17d404(0x1253)]&&(_0x2a98c9=_0x3d6ef7['authorName']);_0x554954=_0x2a98c9+_0x17d404(0x55c),_0x1a8604=_0x350d3e(_0x3d6ef7[_0x17d404(0xee1)]);}return _0xb5242b[_0x17d404(0x45c)]=_0x17d404(0x5a4)+_0x3aa635+_0x17d404(0x5ea)+_0x554954+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>'+_0x1a8604+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3e15d1(_0xb5242b,async()=>{const _0x334c30=_0x17d404,_0x4813f7=await _0x23a88b(_0x334c30(0x9e9),'确定要删除这条记录吗？',{'confirmButtonClass':'btn-danger'});_0x4813f7&&(await _0x342df8[_0x334c30(0x966)][_0x334c30(0x971)](_0x3d6ef7['id']),_0x5bddd7());}),_0xb5242b;}function _0x1082a8(_0x5a10d9){const _0x24cdd4=_0x549949,_0x5dba1d=document[_0x24cdd4(0xe1b)](_0x24cdd4(0x7fd));_0x5dba1d['className']=_0x24cdd4(0xa78);const _0x4c513f=new Date(_0x5a10d9[_0x24cdd4(0x1175)]),_0xaa86dd=_0x4c513f[_0x24cdd4(0xa2b)](_0x24cdd4(0xafb),{'dateStyle':_0x24cdd4(0xd96),'timeStyle':_0x24cdd4(0xfc1)});return _0x5dba1d[_0x24cdd4(0x45c)]=_0x24cdd4(0x5bd)+_0x5a10d9[_0x24cdd4(0xee1)]+_0x24cdd4(0x69c)+_0x5a10d9['targetDate']+_0x24cdd4(0x1256)+_0xaa86dd+_0x24cdd4(0xdf),_0x3e15d1(_0x5dba1d,async()=>{const _0x5cf626=_0x24cdd4,_0x5ad91a=await _0x23a88b('删除约定','确定要删除这个约定吗？',{'confirmButtonClass':_0x5cf626(0x51b)});_0x5ad91a&&(await _0x342df8[_0x5cf626(0x966)][_0x5cf626(0x971)](_0x5a10d9['id']),_0x5bddd7());}),_0x5dba1d;}let _0x2f690a=[];function _0x1b1ec8(){const _0x2bf1bd=_0x549949;_0x2f690a['forEach'](_0x4c4942=>clearInterval(_0x4c4942)),_0x2f690a=[],document[_0x2bf1bd(0x400)](_0x2bf1bd(0x44d))[_0x2bf1bd(0x19c)](_0x27e96e=>{const _0x3cd7bb=_0x2bf1bd,_0x3b2434=parseInt(_0x27e96e[_0x3cd7bb(0x118)][_0x3cd7bb(0x1175)]);let _0x350611;const _0x1a924b=()=>{const _0x57f10f=_0x3cd7bb,_0x260eac=Date['now'](),_0x5549e6=_0x3b2434-_0x260eac;if(_0x5549e6<0x0){_0x27e96e[_0x57f10f(0x138e)]='约定达成！',clearInterval(_0x350611),setTimeout(()=>_0x5bddd7(),0x7d0);return;}const _0x1b354a=Math[_0x57f10f(0xdee)](_0x5549e6/(0x3e8*0x3c*0x3c*0x18)),_0x13d444=Math[_0x57f10f(0xdee)](_0x5549e6%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x1289be=Math[_0x57f10f(0xdee)](_0x5549e6%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x3793e6=Math['floor'](_0x5549e6%(0x3e8*0x3c)/0x3e8);_0x27e96e[_0x57f10f(0x138e)]=_0x1b354a+'天\x20'+_0x13d444+'时\x20'+_0x1289be+'分\x20'+_0x3793e6+'秒';};_0x1a924b(),_0x350611=setInterval(_0x1a924b,0x3e8),_0x2f690a['push'](_0x350611);});}async function _0x49f25f(_0x290ec0){const _0x4ebb1e=_0x549949,_0x21e97b=_0x41df36['chats'][_0x290ec0];if(!_0x21e97b)return;await _0x296ef9('流程启动',_0x4ebb1e(0x5f0)+_0x21e97b[_0x4ebb1e(0x461)]+'”准备好友申请...');const {proxyUrl:_0x40a4a0,apiKey:_0x8fca60,model:_0x1b58dd}=_0x41df36['apiConfig'];if(!_0x40a4a0||!_0x8fca60||!_0x1b58dd){await _0x296ef9(_0x4ebb1e(0x14b),'API设置不完整，无法继续。');return;}const _0xa9e7eb=_0x21e97b['history'][_0x4ebb1e(0x1368)](-0x5)['map'](_0x2eb6d7=>{const _0x2e32fe=_0x4ebb1e,_0xb09c3=_0x2eb6d7['role']===_0x2e32fe(0x66e)?_0x21e97b[_0x2e32fe(0x886)]['myNickname']||'我':_0x2eb6d7['senderName']||_0x21e97b[_0x2e32fe(0x461)];return _0xb09c3+':\x20'+String(_0x2eb6d7['content'])[_0x2e32fe(0xba5)](0x0,0x32)+_0x2e32fe(0x1026);})['join']('\x0a');let _0x267215='';if(_0x21e97b[_0x4ebb1e(0x886)][_0x4ebb1e(0xe8c)]&&_0x21e97b['settings'][_0x4ebb1e(0xe8c)][_0x4ebb1e(0xfde)]>0x0){const _0x3c0b61=_0x21e97b[_0x4ebb1e(0x886)]['linkedWorldBookIds'][_0x4ebb1e(0xa79)](_0x32bf26=>{const _0x5ed210=_0x4ebb1e,_0x8a2988=_0x41df36['worldBooks'][_0x5ed210(0xd12)](_0x4dc5bf=>_0x4dc5bf['id']===_0x32bf26);if(!_0x8a2988||!Array['isArray'](_0x8a2988[_0x5ed210(0x11b6)]))return'';const _0x5305fd=_0x8a2988[_0x5ed210(0x11b6)]['map'](_0x35b2e1=>{const _0x5be588=_0x5ed210;let _0x3994e2='\x0a###\x20条目:\x20'+(_0x35b2e1['comment']||'无备注')+'\x0a';return _0x35b2e1[_0x5be588(0x66b)][_0x5be588(0xfde)]>0x0&&(_0x3994e2+=_0x5be588(0x3dc)+_0x35b2e1[_0x5be588(0x66b)]['join'](',\x20')+'\x0a'),_0x3994e2+=_0x5be588(0x37e)+_0x35b2e1['content'],_0x3994e2;})[_0x5ed210(0xa35)]('\x0a');return _0x5305fd?_0x5ed210(0x6f9)+_0x8a2988[_0x5ed210(0x461)]+'\x0a'+_0x5305fd:'';})[_0x4ebb1e(0x98a)](Boolean)['join']('');_0x3c0b61&&(_0x267215=_0x4ebb1e(0x749)+_0x3c0b61+'\x0a');}const _0x5ddb48=_0x4ebb1e(0x1209)+_0x21e97b[_0x4ebb1e(0x461)]+_0x4ebb1e(0xaf7)+_0x21e97b[_0x4ebb1e(0x886)][_0x4ebb1e(0xd83)]+_0x4ebb1e(0x602)+_0x267215+_0x4ebb1e(0xf4b)+_0xa9e7eb+_0x4ebb1e(0x3c3);try{const _0x302240=[{'role':_0x4ebb1e(0xb1),'content':_0x5ddb48},{'role':_0x4ebb1e(0x66e),'content':_0x4ebb1e(0x719)}];let _0x30c3e3=_0x40a4a0===GEMINI_API_URL,_0x16148a=_0x112768(_0x1b58dd,_0x8fca60,_0x5ddb48,_0x302240);const _0x5dff8f=_0x30c3e3?await fetch(_0x16148a[_0x4ebb1e(0x2fa)],_0x16148a[_0x4ebb1e(0x8c6)]):await fetch(_0x40a4a0+_0x4ebb1e(0x126b),{'method':_0x4ebb1e(0x94f),'headers':{'Content-Type':_0x4ebb1e(0x11f0),'Authorization':_0x4ebb1e(0xd55)+_0x8fca60},'body':JSON[_0x4ebb1e(0x3fb)]({'model':_0x1b58dd,'messages':_0x302240,'temperature':_0x41df36[_0x4ebb1e(0xc0)][_0x4ebb1e(0xa4a)]||0.9})});if(!_0x5dff8f['ok']){const _0x3e1e91=await _0x5dff8f[_0x4ebb1e(0x9b3)]();throw new Error(_0x4ebb1e(0xb83)+_0x5dff8f['status']+'\x20-\x20'+_0x3e1e91[_0x4ebb1e(0x98)][_0x4ebb1e(0x5f8)]);}const _0x176f7d=await _0x5dff8f[_0x4ebb1e(0x9b3)]();let _0x3ebcb1=_0x30c3e3?_0x176f7d[_0x4ebb1e(0x5fa)][0x0][_0x4ebb1e(0x11b6)]['parts'][0x0][_0x4ebb1e(0x6af)]:_0x176f7d[_0x4ebb1e(0xe77)][0x0][_0x4ebb1e(0x5f8)][_0x4ebb1e(0x11b6)];_0x3ebcb1=_0x3ebcb1[_0x4ebb1e(0x709)](/^```json\s*/,'')['replace'](/```$/,'');const _0x1b41f3=_0x3ebcb1[_0x4ebb1e(0x1cb)](),_0x16fbbb=JSON[_0x4ebb1e(0x134)](_0x1b41f3);_0x16fbbb[_0x4ebb1e(0xe8e)]===_0x4ebb1e(0xec9)&&_0x16fbbb[_0x4ebb1e(0x99)]?(_0x21e97b[_0x4ebb1e(0x112b)][_0x4ebb1e(0x1fe)]=_0x4ebb1e(0xf52),_0x21e97b[_0x4ebb1e(0x112b)]['applicationReason']=_0x16fbbb[_0x4ebb1e(0x99)],_0x41df36['chats'][_0x290ec0]=_0x21e97b,_0x25558e(),await _0x296ef9(_0x4ebb1e(0xcf2),'“'+_0x21e97b[_0x4ebb1e(0x461)]+'”已向你发送好友申请。请返回聊天列表查看。')):(await _0x296ef9(_0x4ebb1e(0xbfe),'“'+_0x21e97b[_0x4ebb1e(0x461)]+_0x4ebb1e(0x3c1)),_0x21e97b[_0x4ebb1e(0x112b)]['status']=_0x4ebb1e(0xf22),_0x21e97b['relationship'][_0x4ebb1e(0x97)]=Date['now']());}catch(_0x1eb81c){await _0x296ef9(_0x4ebb1e(0xb19),'为“'+_0x21e97b[_0x4ebb1e(0x461)]+_0x4ebb1e(0x12c3)+_0x1eb81c[_0x4ebb1e(0x5f8)]+_0x4ebb1e(0x3e9)),_0x21e97b[_0x4ebb1e(0x112b)][_0x4ebb1e(0x1fe)]='blocked_by_user',_0x21e97b[_0x4ebb1e(0x112b)][_0x4ebb1e(0x97)]=Date[_0x4ebb1e(0x108d)]();}finally{await _0x342df8[_0x4ebb1e(0x864)][_0x4ebb1e(0x9c0)](_0x21e97b),_0x409076(_0x290ec0);}}function _0x364447(){const _0xc5865=_0x549949;if(!_0x41df36['activeChatId'])return;const _0x4f441e=_0x41df36[_0xc5865(0x864)][_0x41df36[_0xc5865(0xfc5)]];_0x4f441e[_0xc5865(0x1a2)]?_0x35dd01():document[_0xc5865(0x383)]('transfer-modal')[_0xc5865(0x119a)][_0xc5865(0xbff)]('visible');}function _0x35dd01(){const _0x4325c0=_0x549949,_0x156a56=document['getElementById'](_0x4325c0(0xa61)),_0x1c73eb=_0x41df36['chats'][_0x41df36['activeChatId']];document['getElementById'](_0x4325c0(0x6ad))[_0x4325c0(0x1be)]='',document[_0x4325c0(0x383)](_0x4325c0(0x915))[_0x4325c0(0x1be)]='',document[_0x4325c0(0x383)](_0x4325c0(0x925))[_0x4325c0(0x1be)]='',document['getElementById'](_0x4325c0(0x11a7))['value']='',document[_0x4325c0(0x383)]('rp-direct-greeting')['value']='',document[_0x4325c0(0x383)]('rp-group-total')[_0x4325c0(0x138e)]=_0x4325c0(0x12b8),document['getElementById'](_0x4325c0(0xd36))[_0x4325c0(0x138e)]=_0x4325c0(0x12b8);const _0x46d7d7=document[_0x4325c0(0x383)]('rp-direct-receiver');_0x46d7d7[_0x4325c0(0x45c)]='',_0x1c73eb[_0x4325c0(0x12a6)][_0x4325c0(0x19c)](_0x196b97=>{const _0x532cb3=_0x4325c0,_0xb0cf6f=document['createElement'](_0x532cb3(0x10a0));_0xb0cf6f[_0x532cb3(0x1be)]=_0x196b97[_0x532cb3(0x283)],_0xb0cf6f['textContent']=_0x196b97[_0x532cb3(0x9da)],_0x46d7d7[_0x532cb3(0xe91)](_0xb0cf6f);}),document[_0x4325c0(0x383)](_0x4325c0(0x115f))[_0x4325c0(0x5c7)](),_0x156a56['classList']['add'](_0x4325c0(0x106d));}async function _0x1391bd(){const _0x19fb80=_0x549949,_0x163749=_0x41df36[_0x19fb80(0x864)][_0x41df36[_0x19fb80(0xfc5)]],_0x3668eb=parseFloat(document[_0x19fb80(0x383)](_0x19fb80(0x6ad))[_0x19fb80(0x1be)]),_0x2c5e6e=parseInt(document['getElementById'](_0x19fb80(0x915))['value']),_0x4ba481=document[_0x19fb80(0x383)](_0x19fb80(0x925))[_0x19fb80(0x1be)][_0x19fb80(0x1cb)]();if(isNaN(_0x3668eb)||_0x3668eb<=0x0){alert(_0x19fb80(0x1058));return;}if(isNaN(_0x2c5e6e)||_0x2c5e6e<=0x0){alert(_0x19fb80(0xf89));return;}if(_0x3668eb/_0x2c5e6e<0.01){alert(_0x19fb80(0x12d6));return;}const _0x326abc=_0x163749[_0x19fb80(0x886)][_0x19fb80(0x52e)]||'我',_0x122fcb={'role':_0x19fb80(0x66e),'senderName':_0x326abc,'type':_0x19fb80(0xf55),'packetType':_0x19fb80(0x612),'timestamp':Date[_0x19fb80(0x108d)](),'totalAmount':_0x3668eb,'count':_0x2c5e6e,'greeting':_0x4ba481||_0x19fb80(0xe78),'claimedBy':{},'isFullyClaimed':![]};_0x163749[_0x19fb80(0xd08)][_0x19fb80(0x258)](_0x122fcb),await _0x342df8[_0x19fb80(0x864)][_0x19fb80(0x9c0)](_0x163749),_0x323467(_0x122fcb,_0x163749),_0x25558e(),document[_0x19fb80(0x383)]('red-packet-modal')['classList'][_0x19fb80(0x131d)]('visible');}async function _0x315afe(){const _0x160057=_0x549949,_0x2c1e29=_0x41df36[_0x160057(0x864)][_0x41df36['activeChatId']],_0x5beebe=parseFloat(document[_0x160057(0x383)]('rp-direct-amount')[_0x160057(0x1be)]),_0x28701b=document[_0x160057(0x383)](_0x160057(0xd85))['value'],_0xa6a359=document[_0x160057(0x383)](_0x160057(0x129e))['value']['trim']();if(isNaN(_0x5beebe)||_0x5beebe<=0x0){alert(_0x160057(0x5d3));return;}if(!_0x28701b){alert('请选择一个接收人！');return;}const _0x241997=_0x2c1e29['settings'][_0x160057(0x52e)]||'我',_0xe42002={'role':'user','senderName':_0x241997,'type':_0x160057(0xf55),'packetType':'direct','timestamp':Date['now'](),'totalAmount':_0x5beebe,'count':0x1,'greeting':_0xa6a359||'给你准备了一个红包','receiverName':_0x28701b,'claimedBy':{},'isFullyClaimed':![]};_0x2c1e29[_0x160057(0xd08)][_0x160057(0x258)](_0xe42002),await _0x342df8['chats'][_0x160057(0x9c0)](_0x2c1e29),_0x323467(_0xe42002,_0x2c1e29),_0x25558e(),document[_0x160057(0x383)]('red-packet-modal')[_0x160057(0x119a)]['remove'](_0x160057(0x106d));}async function _0x417620(_0x3db7fe){const _0x219f96=_0x549949,_0x169349=_0x41df36[_0x219f96(0xfc5)],_0x204811=await _0x342df8[_0x219f96(0x864)]['get'](_0x169349);if(!_0x204811)return;_0x41df36[_0x219f96(0x864)][_0x169349]=_0x204811;const _0xdc991e=_0x204811['history'][_0x219f96(0xd12)](_0x262662=>_0x262662[_0x219f96(0x3b7)]===_0x3db7fe);if(!_0xdc991e)return;const _0x394702=_0x41df36['qzoneSettings'][_0x219f96(0xabb)]||_0x219f96(0x7da),_0x580885=_0xdc991e[_0x219f96(0xb39)]&&_0xdc991e[_0x219f96(0xb39)][_0x394702];if(_0xdc991e['packetType']===_0x219f96(0xe0e)&&_0xdc991e[_0x219f96(0x30f)]!==_0x394702&&Object['keys'](_0xdc991e['claimedBy'])[_0x219f96(0xfde)]>0x0||_0xdc991e[_0x219f96(0x1010)]||_0x580885){_0x2579fb(_0xdc991e);return;}const _0x70cde2=await _0x579c70(_0xdc991e);_0x70cde2!==null&&(await _0x409076(_0x169349),await _0x296ef9(_0x219f96(0x98e),'你领取了\x20'+_0x54d0ab(_0x204811,_0xdc991e[_0x219f96(0x4c5)])+_0x219f96(0x3d1)+_0x70cde2[_0x219f96(0x70d)](0x2)+_0x219f96(0x111b)));const _0x55b6f1=_0x41df36[_0x219f96(0x864)][_0x169349][_0x219f96(0xd08)]['find'](_0x56549c=>_0x56549c[_0x219f96(0x3b7)]===_0x3db7fe);_0x55b6f1&&_0x2579fb(_0x55b6f1);}async function _0x579c70(_0x451fe6){const _0x5724ba=_0x549949,_0x45a3b4=_0x41df36[_0x5724ba(0x864)][_0x41df36[_0x5724ba(0xfc5)]];let _0x7a01d=Date[_0x5724ba(0x108d)]();const _0x196b56=_0x41df36[_0x5724ba(0x571)]['nickname']||_0x5724ba(0x7da),_0x374bd4=_0x451fe6[_0x5724ba(0x779)]-Object['keys'](_0x451fe6[_0x5724ba(0xb39)]||{})['length'];if(_0x374bd4<=0x0)return _0x451fe6[_0x5724ba(0x1010)]=!![],await _0x342df8[_0x5724ba(0x864)]['put'](_0x45a3b4),await _0x296ef9(_0x5724ba(0xf93),_0x5724ba(0xee3)),null;let _0x23df5a=0x0;const _0x33deaa=_0x451fe6[_0x5724ba(0x3be)]-Object[_0x5724ba(0x76d)](_0x451fe6['claimedBy']||{})[_0x5724ba(0xf60)]((_0xf0f2db,_0xb6f278)=>_0xf0f2db+_0xb6f278,0x0);if(_0x451fe6[_0x5724ba(0x1350)]===_0x5724ba(0x612)){if(_0x374bd4===0x1)_0x23df5a=_0x33deaa;else{const _0x526e0b=0.01,_0x21edae=_0x33deaa-(_0x374bd4-0x1)*_0x526e0b;_0x23df5a=Math['random']()*(_0x21edae-_0x526e0b)+_0x526e0b;}}else _0x23df5a=_0x451fe6[_0x5724ba(0x3be)];_0x23df5a=parseFloat(_0x23df5a[_0x5724ba(0x70d)](0x2));if(!_0x451fe6[_0x5724ba(0xb39)])_0x451fe6[_0x5724ba(0xb39)]={};_0x451fe6[_0x5724ba(0xb39)][_0x196b56]=_0x23df5a;const _0x557552=Object[_0x5724ba(0x66b)](_0x451fe6[_0x5724ba(0xb39)])[_0x5724ba(0xfde)]>=_0x451fe6[_0x5724ba(0x779)];_0x557552&&(_0x451fe6[_0x5724ba(0x1010)]=!![]);const _0x3708a1=_0x54d0ab(_0x45a3b4,_0x196b56),_0x1eca82=_0x54d0ab(_0x45a3b4,_0x451fe6[_0x5724ba(0x4c5)]),_0x464a9c={'role':'system','type':_0x5724ba(0xed8),'content':'你领取了\x20'+_0x1eca82+_0x5724ba(0x134c),'timestamp':_0x7a01d++};_0x45a3b4[_0x5724ba(0xd08)][_0x5724ba(0x258)](_0x464a9c);let _0x1330e4;if(_0x557552){const _0x2117f1={'role':_0x5724ba(0xb1),'type':_0x5724ba(0xed8),'content':_0x1eca82+_0x5724ba(0xd75),'timestamp':_0x7a01d++};_0x45a3b4['history']['push'](_0x2117f1);let _0x4cf9a9={'name':'','amount':-0x1};_0x451fe6[_0x5724ba(0x1350)]===_0x5724ba(0x612)&&_0x451fe6[_0x5724ba(0x779)]>0x1&&Object[_0x5724ba(0x329)](_0x451fe6['claimedBy'])[_0x5724ba(0x19c)](([_0x3028c1,_0x40ba21])=>{const _0x36bdaa=_0x5724ba;_0x40ba21>_0x4cf9a9[_0x36bdaa(0xe27)]&&(_0x4cf9a9={'name':_0x3028c1,'amount':_0x40ba21});});const _0x365216=_0x4cf9a9[_0x5724ba(0x461)]?_0x54d0ab(_0x45a3b4,_0x4cf9a9[_0x5724ba(0x461)]):'无';_0x1330e4='[系统提示：用户\x20('+_0x3708a1+')\x20领取了最后一个红包。红包已被领完，手气王是\x20'+_0x365216+_0x5724ba(0xbd1);}else _0x1330e4=_0x5724ba(0x11d9)+_0x3708a1+_0x5724ba(0x799)+_0x451fe6['timestamp']+_0x5724ba(0x241);const _0x302d19={'role':'system','content':_0x1330e4,'timestamp':_0x7a01d++,'isHidden':!![]};return _0x45a3b4[_0x5724ba(0xd08)][_0x5724ba(0x258)](_0x302d19),await _0x342df8[_0x5724ba(0x864)][_0x5724ba(0x9c0)](_0x45a3b4),_0x23df5a;}async function _0x2579fb(_0x3c82f8){const _0x5ae779=_0x549949;if(!_0x3c82f8){console[_0x5ae779(0x98)]('showRedPacketDetails收到了无效的packet对象');return;}const _0x35269d=_0x41df36['chats'][_0x41df36['activeChatId']];if(!_0x35269d)return;const _0x12c64b=document[_0x5ae779(0x383)](_0x5ae779(0xde7)),_0x572907=_0x41df36['qzoneSettings'][_0x5ae779(0xabb)]||_0x5ae779(0x7da),_0x534570=_0x54d0ab(_0x35269d,_0x3c82f8['senderName']);document[_0x5ae779(0x383)](_0x5ae779(0xff1))['textContent']=_0x534570,document[_0x5ae779(0x383)](_0x5ae779(0x427))[_0x5ae779(0x138e)]=_0x3c82f8[_0x5ae779(0xe12)]||_0x5ae779(0xe78);const _0x118acb=document[_0x5ae779(0x383)](_0x5ae779(0xef8));_0x3c82f8['claimedBy']&&_0x3c82f8[_0x5ae779(0xb39)][_0x572907]?(_0x118acb[_0x5ae779(0x89c)](_0x5ae779(0x5e8))[_0x5ae779(0x138e)]=_0x3c82f8[_0x5ae779(0xb39)][_0x572907]['toFixed'](0x2),_0x118acb[_0x5ae779(0x655)][_0x5ae779(0x2b6)]=_0x5ae779(0x27a)):_0x118acb[_0x5ae779(0x655)]['display']=_0x5ae779(0xa70);const _0x1d5323=Object[_0x5ae779(0x66b)](_0x3c82f8['claimedBy']||{})['length'],_0x16f5b1=Object[_0x5ae779(0x76d)](_0x3c82f8[_0x5ae779(0xb39)]||{})[_0x5ae779(0xf60)]((_0x19c13c,_0x1f68c3)=>_0x19c13c+_0x1f68c3,0x0);let _0x3b55ae=_0x1d5323+'/'+_0x3c82f8['count']+'个红包，共'+_0x16f5b1[_0x5ae779(0x70d)](0x2)+'/'+_0x3c82f8[_0x5ae779(0x3be)][_0x5ae779(0x70d)](0x2)+'元。';if(!_0x3c82f8['isFullyClaimed']&&_0x1d5323<_0x3c82f8['count']){const _0x8aa33f=Math['floor']((_0x3c82f8[_0x5ae779(0x3b7)]+0x18*0x3c*0x3c*0x3e8-Date['now']())/(0x3e8*0x3c*0x3c));if(_0x8aa33f>0x0)_0x3b55ae+='\x20剩余红包将在'+_0x8aa33f+_0x5ae779(0x12e7);}document['getElementById'](_0x5ae779(0x1307))[_0x5ae779(0x138e)]=_0x3b55ae;const _0x289226=document[_0x5ae779(0x383)](_0x5ae779(0x6d9));_0x289226[_0x5ae779(0x45c)]='';const _0x139dd7=Object[_0x5ae779(0x329)](_0x3c82f8[_0x5ae779(0xb39)]||{});let _0xe7a04a={'name':'','amount':-0x1};_0x3c82f8['packetType']===_0x5ae779(0x612)&&_0x3c82f8[_0x5ae779(0x1010)]&&_0x139dd7[_0x5ae779(0xfde)]>0x1&&_0x139dd7[_0x5ae779(0x19c)](([_0x206205,_0x569c04])=>{const _0x98380c=_0x5ae779;_0x569c04>_0xe7a04a[_0x98380c(0xe27)]&&(_0xe7a04a={'name':_0x206205,'amount':_0x569c04});}),_0x139dd7[_0x5ae779(0x1296)]((_0x3fc938,_0x15ed5c)=>_0x15ed5c[0x1]-_0x3fc938[0x1]),_0x139dd7['forEach'](([_0x309f85,_0x56cb6b])=>{const _0x4a56cd=_0x5ae779,_0x55afd6=document['createElement'](_0x4a56cd(0x7fd));_0x55afd6[_0x4a56cd(0x556)]=_0x4a56cd(0x190);let _0x517790='';_0xe7a04a[_0x4a56cd(0x461)]&&_0x309f85===_0xe7a04a['name']&&(_0x517790='<span\x20class=\x22lucky-king-tag\x22>手气王</span>');const _0x1888e9=_0x54d0ab(_0x35269d,_0x309f85);_0x55afd6[_0x4a56cd(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x1888e9+_0x4a56cd(0xd7d)+_0x56cb6b['toFixed'](0x2)+_0x4a56cd(0x575)+_0x517790+_0x4a56cd(0x13b),_0x289226[_0x4a56cd(0xe91)](_0x55afd6);}),_0x12c64b[_0x5ae779(0x119a)][_0x5ae779(0xbff)]('visible');}document[_0x549949(0x383)](_0x549949(0x41d))[_0x549949(0x271)](_0x549949(0x5c7),()=>{const _0x2eefbe=_0x549949;document['getElementById']('red-packet-details-modal')['classList']['remove'](_0x2eefbe(0x106d));}),window[_0x549949(0x28d)]=_0x417620;function _0x3d08da(){const _0x49af4a=_0x549949,_0x2d9f96=document['getElementById']('create-poll-modal');document[_0x49af4a(0x383)](_0x49af4a(0xa13))[_0x49af4a(0x1be)]='';const _0x501243=document['getElementById'](_0x49af4a(0xaaf));_0x501243['innerHTML']='',_0x400138(),_0x400138(),_0x2d9f96['classList'][_0x49af4a(0xbff)](_0x49af4a(0x106d));}function _0x400138(){const _0x1e38ff=_0x549949,_0x19063b=document['getElementById'](_0x1e38ff(0xaaf)),_0x1b9ccd=document[_0x1e38ff(0xe1b)](_0x1e38ff(0x7fd));_0x1b9ccd[_0x1e38ff(0x556)]='poll-option-input-wrapper',_0x1b9ccd[_0x1e38ff(0x45c)]=_0x1e38ff(0x10a3),_0x1b9ccd['querySelector'](_0x1e38ff(0x36b))[_0x1e38ff(0x271)]('click',()=>{const _0x5bfabb=_0x1e38ff;_0x19063b[_0x5bfabb(0xbd4)]['length']>0x2?_0x1b9ccd[_0x5bfabb(0x131d)]():alert(_0x5bfabb(0x7fe));}),_0x19063b[_0x1e38ff(0xe91)](_0x1b9ccd);}async function _0x22bc78(){const _0x2e0c6d=_0x549949;if(!_0x41df36['activeChatId'])return;const _0x18adb7=document[_0x2e0c6d(0x383)]('poll-question-input')[_0x2e0c6d(0x1be)]['trim']();if(!_0x18adb7){alert(_0x2e0c6d(0xd71));return;}const _0x4c9008=Array[_0x2e0c6d(0x365)](document['querySelectorAll'](_0x2e0c6d(0xe84)))['map'](_0x2cb596=>_0x2cb596[_0x2e0c6d(0x1be)][_0x2e0c6d(0x1cb)]())[_0x2e0c6d(0x98a)](_0x4e2aed=>_0x4e2aed);if(_0x4c9008[_0x2e0c6d(0xfde)]<0x2){alert(_0x2e0c6d(0xaae));return;}const _0x4a8e8b=_0x41df36[_0x2e0c6d(0x864)][_0x41df36[_0x2e0c6d(0xfc5)]],_0x1cf968=_0x4a8e8b[_0x2e0c6d(0x1a2)]?_0x4a8e8b[_0x2e0c6d(0x886)][_0x2e0c6d(0x52e)]||'我':'我',_0x221f5f={'role':_0x2e0c6d(0x66e),'senderName':_0x1cf968,'type':_0x2e0c6d(0x11b9),'timestamp':Date[_0x2e0c6d(0x108d)](),'question':_0x18adb7,'options':_0x4c9008,'votes':{},'isClosed':![]};_0x4a8e8b[_0x2e0c6d(0xd08)][_0x2e0c6d(0x258)](_0x221f5f),await _0x342df8[_0x2e0c6d(0x864)]['put'](_0x4a8e8b),_0x323467(_0x221f5f,_0x4a8e8b),_0x25558e(),document[_0x2e0c6d(0x383)](_0x2e0c6d(0x4ae))[_0x2e0c6d(0x119a)][_0x2e0c6d(0x131d)](_0x2e0c6d(0x106d));}async function _0x4dad9d(_0x54f399,_0x1f8e8f){const _0x4d087f=_0x549949,_0x1c187a=_0x41df36[_0x4d087f(0x864)][_0x41df36[_0x4d087f(0xfc5)]],_0x320aa4=_0x1c187a[_0x4d087f(0xd08)][_0x4d087f(0xd12)](_0xdccb7d=>_0xdccb7d[_0x4d087f(0x3b7)]===_0x54f399),_0x5e0765=_0x1c187a['isGroup']?_0x1c187a['settings'][_0x4d087f(0x52e)]||'我':'我';if(!_0x320aa4||_0x320aa4['isClosed']){_0x320aa4&&_0x320aa4[_0x4d087f(0xa17)]&&_0x1b679d(_0x54f399);return;}const _0xfe3265=_0x320aa4[_0x4d087f(0x1385)][_0x1f8e8f]&&_0x320aa4[_0x4d087f(0x1385)][_0x1f8e8f][_0x4d087f(0xee2)](_0x5e0765);if(!_0xfe3265){for(const _0x23413a in _0x320aa4[_0x4d087f(0x1385)]){const _0x45cd94=_0x320aa4['votes'][_0x23413a][_0x4d087f(0x1105)](_0x5e0765);_0x45cd94>-0x1&&_0x320aa4[_0x4d087f(0x1385)][_0x23413a][_0x4d087f(0x2f1)](_0x45cd94,0x1);}!_0x320aa4[_0x4d087f(0x1385)][_0x1f8e8f]&&(_0x320aa4[_0x4d087f(0x1385)][_0x1f8e8f]=[]),_0x320aa4['votes'][_0x1f8e8f][_0x4d087f(0x258)](_0x5e0765);}let _0x2c183b=null;!_0xfe3265&&(_0x2c183b=_0x4d087f(0x11d9)+_0x5e0765+_0x4d087f(0xe3a)+_0x1f8e8f+'”。]');if(_0x2c183b){const _0x2f95e9={'role':_0x4d087f(0xb1),'content':_0x2c183b,'timestamp':Date[_0x4d087f(0x108d)](),'isHidden':!![]};_0x1c187a['history'][_0x4d087f(0x258)](_0x2f95e9);}await _0x342df8[_0x4d087f(0x864)][_0x4d087f(0x9c0)](_0x1c187a),_0x409076(_0x41df36[_0x4d087f(0xfc5)]);}async function _0x2e655e(_0x573784){const _0x1e0601=_0x549949,_0x361722=_0x41df36[_0x1e0601(0x864)][_0x41df36[_0x1e0601(0xfc5)]],_0x5ac167=_0x361722[_0x1e0601(0xd08)][_0x1e0601(0xd12)](_0xeb8d27=>_0xeb8d27[_0x1e0601(0x3b7)]===_0x573784);if(!_0x5ac167||_0x5ac167[_0x1e0601(0xa17)])return;const _0x444cfb=await _0x23a88b(_0x1e0601(0xa7c),'确定要结束这个投票吗？结束后将无法再进行投票。');if(_0x444cfb){_0x5ac167[_0x1e0601(0xa17)]=!![];const _0x5de572=_0x5ac167[_0x1e0601(0x904)]['map'](_0x43cb5a=>'“'+_0x43cb5a+'”('+(_0x5ac167['votes'][_0x43cb5a]?.[_0x1e0601(0xfde)]||0x0)+'票)')[_0x1e0601(0xa35)]('，'),_0x43c577=_0x1e0601(0x774)+_0x5de572+'。]',_0x1c382a={'role':_0x1e0601(0xb1),'content':_0x43c577,'timestamp':Date[_0x1e0601(0x108d)](),'isHidden':!![]};_0x361722['history']['push'](_0x1c382a),await _0x342df8[_0x1e0601(0x864)][_0x1e0601(0x9c0)](_0x361722),_0x409076(_0x41df36[_0x1e0601(0xfc5)]);}}function _0x1b679d(_0x144405){const _0x4634e1=_0x549949,_0x219a34=_0x41df36[_0x4634e1(0x864)][_0x41df36['activeChatId']],_0x11a1a9=_0x219a34[_0x4634e1(0xd08)]['find'](_0x2f0a54=>_0x2f0a54['timestamp']===_0x144405);if(!_0x11a1a9||!_0x11a1a9[_0x4634e1(0xa17)])return;let _0x5e3f64=_0x4634e1(0x31f)+_0x11a1a9[_0x4634e1(0xca8)]+_0x4634e1(0xa0e);Object[_0x4634e1(0x66b)](_0x11a1a9[_0x4634e1(0x1385)])['length']===0x0?_0x5e3f64+='<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>':_0x11a1a9[_0x4634e1(0x904)][_0x4634e1(0x19c)](_0x226101=>{const _0x3375dd=_0x4634e1,_0x2aeda6=_0x11a1a9[_0x3375dd(0x1385)][_0x226101]||[],_0xc9f358=_0x2aeda6[_0x3375dd(0xa79)](_0x596d2a=>_0x54d0ab(_0x219a34,_0x596d2a))[_0x3375dd(0xa35)]('、\x20');_0x5e3f64+=_0x3375dd(0x3e3)+_0x226101+'\x20('+_0x2aeda6[_0x3375dd(0xfde)]+_0x3375dd(0x67b)+(_0x2aeda6[_0x3375dd(0xfde)]>0x0?_0xc9f358:'无人投票')+_0x3375dd(0xece);}),_0x296ef9('投票结果',_0x5e3f64);}function _0x2c3cee(){const _0x160538=_0x549949;if(!_0x41df36[_0x160538(0xfc5)])return;const _0x371b3a=_0x41df36[_0x160538(0x864)][_0x41df36[_0x160538(0xfc5)]];document[_0x160538(0x383)](_0x160538(0x853))[_0x160538(0x138e)]='“'+_0x371b3a[_0x160538(0x461)]+'”的头像库',_0x10dc94(),document['getElementById']('ai-avatar-library-modal')[_0x160538(0x119a)]['add'](_0x160538(0x106d));}function _0x10dc94(){const _0x39c1f3=_0x549949,_0x486210=document[_0x39c1f3(0x383)](_0x39c1f3(0x1387));_0x486210['innerHTML']='';const _0x3890ba=_0x41df36[_0x39c1f3(0x864)][_0x41df36[_0x39c1f3(0xfc5)]],_0x3d7c4e=_0x3890ba['settings'][_0x39c1f3(0x7fa)]||[];if(_0x3d7c4e[_0x39c1f3(0xfde)]===0x0){_0x486210[_0x39c1f3(0x45c)]=_0x39c1f3(0xa8f);return;}_0x3d7c4e[_0x39c1f3(0x19c)]((_0x2d7893,_0x204d6e)=>{const _0x4438b4=_0x39c1f3,_0x32df1a=document[_0x4438b4(0xe1b)](_0x4438b4(0x7fd));_0x32df1a[_0x4438b4(0x556)]=_0x4438b4(0x194),_0x32df1a[_0x4438b4(0xf3a)]=_0x2d7893[_0x4438b4(0x461)],_0x32df1a[_0x4438b4(0x45c)]=_0x4438b4(0x3ff)+_0x2d7893[_0x4438b4(0x2fa)]+');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>'+_0x2d7893[_0x4438b4(0x461)]+_0x4438b4(0xf79);const _0x391879=document[_0x4438b4(0xe1b)](_0x4438b4(0x7fd));_0x391879[_0x4438b4(0x556)]='delete-btn',_0x391879[_0x4438b4(0x45c)]='×',_0x391879[_0x4438b4(0x655)]['display']=_0x4438b4(0x27a),_0x391879[_0x4438b4(0xc50)]=async _0x3d1722=>{const _0x399268=_0x4438b4;_0x3d1722[_0x399268(0x1311)]();const _0xa9366f=await _0x23a88b(_0x399268(0xb3e),_0x399268(0xb7f)+_0x2d7893[_0x399268(0x461)]+_0x399268(0xea5),{'confirmButtonClass':_0x399268(0x51b)});_0xa9366f&&(_0x3890ba[_0x399268(0x886)][_0x399268(0x7fa)][_0x399268(0x2f1)](_0x204d6e,0x1),await _0x342df8[_0x399268(0x864)][_0x399268(0x9c0)](_0x3890ba),_0x10dc94());},_0x32df1a[_0x4438b4(0xe91)](_0x391879),_0x486210['appendChild'](_0x32df1a);});}async function _0x36fc71(){const _0x1a53bf=_0x549949,_0x75c854=await _0x12e332(_0x1a53bf(0x7f7),_0x1a53bf(0x30d));if(!_0x75c854||!_0x75c854[_0x1a53bf(0x1cb)]())return;const _0x4c92a9=await _0x12e332(_0x1a53bf(0x7f7),_0x1a53bf(0x473),'',_0x1a53bf(0x2fa));if(!_0x4c92a9||!_0x4c92a9[_0x1a53bf(0x1cb)]()[_0x1a53bf(0x1122)]('http')){alert(_0x1a53bf(0x6a6));return;}const _0x2e5810=_0x41df36['chats'][_0x41df36['activeChatId']];!_0x2e5810[_0x1a53bf(0x886)][_0x1a53bf(0x7fa)]&&(_0x2e5810[_0x1a53bf(0x886)][_0x1a53bf(0x7fa)]=[]),_0x2e5810[_0x1a53bf(0x886)][_0x1a53bf(0x7fa)]['push']({'name':_0x75c854[_0x1a53bf(0x1cb)](),'url':_0x4c92a9[_0x1a53bf(0x1cb)]()}),await _0x342df8[_0x1a53bf(0x864)][_0x1a53bf(0x9c0)](_0x2e5810),_0x10dc94();}function _0x804390(){const _0x4ff94d=_0x549949;document['getElementById']('ai-avatar-library-modal')[_0x4ff94d(0x119a)][_0x4ff94d(0x131d)](_0x4ff94d(0x106d));}function _0x43cbab(){const _0x1b43be=_0x549949;if(!_0x41df36['activeChatId'])return;const _0x54438f=_0x41df36[_0x1b43be(0x864)][_0x41df36[_0x1b43be(0xfc5)]];document[_0x1b43be(0x383)](_0x1b43be(0xca6))['textContent']='“'+(_0x54438f[_0x1b43be(0x886)][_0x1b43be(0x52e)]||'我')+'”的头像库',_0x54bc4a(),document[_0x1b43be(0x383)]('my-avatar-library-modal')[_0x1b43be(0x119a)][_0x1b43be(0xbff)](_0x1b43be(0x106d));}function _0x54bc4a(){const _0xd005c2=_0x549949,_0x3851ed=document[_0xd005c2(0x383)](_0xd005c2(0x2d6));_0x3851ed[_0xd005c2(0x45c)]='';const _0x146e81=_0x41df36['chats'][_0x41df36[_0xd005c2(0xfc5)]],_0x4d6159=_0x146e81['settings'][_0xd005c2(0xa7)]||[];if(_0x4d6159[_0xd005c2(0xfde)]===0x0){_0x3851ed[_0xd005c2(0x45c)]=_0xd005c2(0xa8f);return;}_0x4d6159[_0xd005c2(0x19c)]((_0x5b20b1,_0x152558)=>{const _0x322405=_0xd005c2,_0x223180=document[_0x322405(0xe1b)](_0x322405(0x7fd));_0x223180[_0x322405(0x556)]=_0x322405(0x194),_0x223180['title']=_0x5b20b1[_0x322405(0x461)],_0x223180[_0x322405(0x45c)]=_0x322405(0x3ff)+_0x5b20b1[_0x322405(0x2fa)]+_0x322405(0x1131)+_0x5b20b1[_0x322405(0x461)]+_0x322405(0xf79);const _0xbf6e4e=document['createElement'](_0x322405(0x7fd));_0xbf6e4e[_0x322405(0x556)]=_0x322405(0x1354),_0xbf6e4e[_0x322405(0x45c)]='×',_0xbf6e4e[_0x322405(0x655)][_0x322405(0x2b6)]=_0x322405(0x27a),_0xbf6e4e[_0x322405(0xc50)]=async _0x1ac741=>{const _0x1f5170=_0x322405;_0x1ac741['stopPropagation']();const _0x56b749=await _0x23a88b(_0x1f5170(0xb3e),_0x1f5170(0x858)+_0x5b20b1[_0x1f5170(0x461)]+_0x1f5170(0xea5),{'confirmButtonClass':_0x1f5170(0x51b)});_0x56b749&&(_0x146e81['settings'][_0x1f5170(0xa7)]['splice'](_0x152558,0x1),await _0x342df8['chats'][_0x1f5170(0x9c0)](_0x146e81),_0x54bc4a());},_0x223180[_0x322405(0xe91)](_0xbf6e4e),_0x3851ed[_0x322405(0xe91)](_0x223180);});}async function _0xc8e6bd(){const _0x32ef1d=_0x549949,_0x4f2828=await _0x12e332(_0x32ef1d(0x7f7),_0x32ef1d(0x30d));if(!_0x4f2828||!_0x4f2828[_0x32ef1d(0x1cb)]())return;const _0x2a9a00=await _0x12e332(_0x32ef1d(0x7f7),_0x32ef1d(0x473),'',_0x32ef1d(0x2fa));if(!_0x2a9a00||!_0x2a9a00[_0x32ef1d(0x1cb)]()[_0x32ef1d(0x1122)](_0x32ef1d(0xaec))){alert(_0x32ef1d(0x6a6));return;}const _0xef8e10=_0x41df36['chats'][_0x41df36[_0x32ef1d(0xfc5)]];!_0xef8e10[_0x32ef1d(0x886)]['myAvatarLibrary']&&(_0xef8e10[_0x32ef1d(0x886)][_0x32ef1d(0xa7)]=[]),_0xef8e10['settings']['myAvatarLibrary'][_0x32ef1d(0x258)]({'name':_0x4f2828[_0x32ef1d(0x1cb)](),'url':_0x2a9a00[_0x32ef1d(0x1cb)]()}),await _0x342df8[_0x32ef1d(0x864)][_0x32ef1d(0x9c0)](_0xef8e10),_0x54bc4a();}async function _0x11f883(_0x5ea622){const _0x10723a=_0x549949,_0x3f4738=_0x5ea622[_0x10723a(0xfab)][_0x10723a(0x1185)][0x0];if(!_0x3f4738)return;const _0x16bc79=await new Promise(_0x11b5e8=>{const _0xdd51fe=_0x10723a,_0x18076e=new FileReader();_0x18076e['onload']=()=>_0x11b5e8(_0x18076e[_0xdd51fe(0xa86)]),_0x18076e[_0xdd51fe(0x132a)](_0x3f4738);}),_0x5b4bdb=await _0x12e332(_0x10723a(0xaff),_0x10723a(0xd19));if(!_0x5b4bdb||!_0x5b4bdb['trim']())return;const _0x19a0fa=_0x41df36[_0x10723a(0x864)][_0x41df36[_0x10723a(0xfc5)]];!_0x19a0fa['settings']['myAvatarLibrary']&&(_0x19a0fa[_0x10723a(0x886)][_0x10723a(0xa7)]=[]),_0x19a0fa['settings'][_0x10723a(0xa7)][_0x10723a(0x258)]({'name':_0x5b4bdb['trim'](),'url':_0x16bc79}),await _0x342df8[_0x10723a(0x864)][_0x10723a(0x9c0)](_0x19a0fa),_0x54bc4a(),_0x5ea622[_0x10723a(0xfab)]['value']=null;}async function _0x3a77ca(_0x1b12ed){const _0x3b8766=_0x549949,_0x4babf1=_0x41df36[_0x3b8766(0x864)][_0x41df36['activeChatId']];if(!_0x4babf1)return;const _0x4b3af5=_0x1b12ed[_0x3b8766(0x1cb)]()[_0x3b8766(0x105d)]('\x0a'),_0xb3e600=[],_0xac0672=_0x3b8766(0x10d);let _0x14138c=0x0;for(const _0x3a5ae3 of _0x4b3af5){const _0x4bfc76=_0x3a5ae3[_0x3b8766(0x1cb)]();if(!_0x4bfc76||_0x4bfc76['includes'](_0x3b8766(0xaec))||_0x4bfc76['includes']('填入'))continue;let _0x3827e6=null,_0x2f8364=null;const _0x57bd03=_0x4bfc76[_0x3b8766(0x22e)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x57bd03)_0x3827e6=_0x57bd03[0x1],_0x2f8364=_0x57bd03[0x2];else{const _0x2cd99e=_0x4bfc76[_0x3b8766(0x105d)](/\s+/);_0x2cd99e[_0x3b8766(0xfde)]>=0x2&&(_0x2f8364=_0x2cd99e[_0x3b8766(0xc4f)](),_0x3827e6=_0x2cd99e[_0x3b8766(0xa35)]('\x20'));}_0x3827e6&&_0x2f8364&&_0x2f8364[_0x3b8766(0xee2)]('.')?_0xb3e600[_0x3b8766(0x258)]({'name':_0x3827e6,'url':_0xac0672+_0x2f8364}):_0x14138c++;}if(_0x14138c>0x0)await _0x296ef9(_0x3b8766(0x2d8),'有\x20'+_0x14138c+_0x3b8766(0xbb5));if(_0xb3e600[_0x3b8766(0xfde)]>0x0){if(!_0x4babf1['settings'][_0x3b8766(0xa7)])_0x4babf1['settings'][_0x3b8766(0xa7)]=[];_0x4babf1['settings'][_0x3b8766(0xa7)][_0x3b8766(0x258)](..._0xb3e600),await _0x342df8[_0x3b8766(0x864)]['put'](_0x4babf1),_0x54bc4a(),await _0x296ef9(_0x3b8766(0xab0),_0x3b8766(0x4ea)+_0xb3e600[_0x3b8766(0xfde)]+_0x3b8766(0x17a));}else _0x14138c===0x0&&alert(_0x3b8766(0x105b));}function _0x5e05c2(){const _0x242d36=_0x549949;document['getElementById'](_0x242d36(0x214))['classList'][_0x242d36(0x131d)](_0x242d36(0x106d));}function _0x4a6f07(){const _0x4d2198=_0x549949;if(!_0x41df36[_0x4d2198(0xfc5)])return;const _0x38d86f=_0x41df36['chats'][_0x41df36['activeChatId']];document[_0x4d2198(0x383)](_0x4d2198(0x178))['textContent']='“'+_0x38d86f[_0x4d2198(0x461)]+'”的头像库',_0xa3062b(),document[_0x4d2198(0x383)](_0x4d2198(0xbb3))[_0x4d2198(0x119a)][_0x4d2198(0xbff)](_0x4d2198(0x106d));}function _0xa3062b(){const _0x134128=_0x549949,_0x20189b=document[_0x134128(0x383)](_0x134128(0x816));_0x20189b[_0x134128(0x45c)]='';const _0x5005f2=_0x41df36[_0x134128(0x864)][_0x41df36['activeChatId']],_0x2ba036=_0x5005f2[_0x134128(0x886)][_0x134128(0x34a)]||[];if(_0x2ba036[_0x134128(0xfde)]===0x0){_0x20189b[_0x134128(0x45c)]=_0x134128(0xa8f);return;}_0x2ba036['forEach']((_0x31a9bf,_0x5babca)=>{const _0x284b24=_0x134128,_0x19b31b=document['createElement'](_0x284b24(0x7fd));_0x19b31b['className']=_0x284b24(0x194),_0x19b31b[_0x284b24(0xf3a)]=_0x31a9bf['name'],_0x19b31b[_0x284b24(0x45c)]=_0x284b24(0x3ff)+_0x31a9bf[_0x284b24(0x2fa)]+_0x284b24(0x1131)+_0x31a9bf[_0x284b24(0x461)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x103e1a=document[_0x284b24(0xe1b)](_0x284b24(0x7fd));_0x103e1a[_0x284b24(0x556)]=_0x284b24(0x1354),_0x103e1a[_0x284b24(0x45c)]='×',_0x103e1a['style'][_0x284b24(0x2b6)]=_0x284b24(0x27a),_0x103e1a[_0x284b24(0xc50)]=async _0x1f4061=>{const _0x24ccd6=_0x284b24;_0x1f4061[_0x24ccd6(0x1311)]();const _0x1f43a1=await _0x23a88b(_0x24ccd6(0xb3e),_0x24ccd6(0xb7f)+_0x31a9bf[_0x24ccd6(0x461)]+_0x24ccd6(0xea5),{'confirmButtonClass':_0x24ccd6(0x51b)});_0x1f43a1&&(_0x5005f2['settings'][_0x24ccd6(0x34a)][_0x24ccd6(0x2f1)](_0x5babca,0x1),await _0x342df8[_0x24ccd6(0x864)][_0x24ccd6(0x9c0)](_0x5005f2),_0xa3062b());},_0x19b31b[_0x284b24(0xe91)](_0x103e1a),_0x20189b[_0x284b24(0xe91)](_0x19b31b);});}async function _0x18dee1(){const _0x2e43fb=_0x549949,_0x12a0b7=await _0x12e332(_0x2e43fb(0x7f7),_0x2e43fb(0x370));if(!_0x12a0b7||!_0x12a0b7[_0x2e43fb(0x1cb)]())return;const _0x460a99=await _0x12e332('添加头像',_0x2e43fb(0x473),'',_0x2e43fb(0x2fa));if(!_0x460a99||!_0x460a99[_0x2e43fb(0x1cb)]()['startsWith'](_0x2e43fb(0xaec))){alert(_0x2e43fb(0x6a6));return;}const _0x207d14=_0x41df36['chats'][_0x41df36['activeChatId']];!_0x207d14['settings'][_0x2e43fb(0x34a)]&&(_0x207d14['settings'][_0x2e43fb(0x34a)]=[]),_0x207d14['settings'][_0x2e43fb(0x34a)][_0x2e43fb(0x258)]({'name':_0x12a0b7['trim'](),'url':_0x460a99[_0x2e43fb(0x1cb)]()}),await _0x342df8[_0x2e43fb(0x864)][_0x2e43fb(0x9c0)](_0x207d14),_0xa3062b();}function _0xd102b6(){const _0x56a959=_0x549949;document[_0x56a959(0x383)](_0x56a959(0xbb3))[_0x56a959(0x119a)]['remove'](_0x56a959(0x106d));}async function _0x5853fc(_0x515fd5){const _0x2adaa9=_0x549949,_0x12fcf8=_0x2adaa9(0x119f),_0x1e7579=await _0x12e332('批量导入头像',_0x12fcf8,'',_0x2adaa9(0xfe5));_0x1e7579&&_0x1e7579['trim']()&&await _0x55d4cc(_0x515fd5,_0x1e7579);}async function _0x55d4cc(_0x4f9078,_0x5178fc){const _0x2a8d37=_0x549949,_0x1befff=_0x41df36[_0x2a8d37(0x864)][_0x41df36['activeChatId']];if(!_0x1befff)return;const _0x263c00=_0x5178fc[_0x2a8d37(0x1cb)]()[_0x2a8d37(0x105d)]('\x0a'),_0x494601=[],_0x45fd78=_0x2a8d37(0x10d);let _0x346be1=0x0;for(const _0x10aec1 of _0x263c00){const _0x395705=_0x10aec1['trim']();if(!_0x395705||_0x395705[_0x2a8d37(0xee2)]('http')||_0x395705[_0x2a8d37(0xee2)]('填入'))continue;let _0x5b97ad=null,_0x2895c0=null;const _0x1be646=_0x395705[_0x2a8d37(0x22e)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x1be646)_0x5b97ad=_0x1be646[0x1],_0x2895c0=_0x1be646[0x2];else{const _0x19a2f1=_0x395705['split'](/\s+/);_0x19a2f1[_0x2a8d37(0xfde)]>=0x2&&(_0x2895c0=_0x19a2f1[_0x2a8d37(0xc4f)](),_0x5b97ad=_0x19a2f1[_0x2a8d37(0xa35)]('\x20'));}_0x5b97ad&&_0x2895c0&&_0x2895c0[_0x2a8d37(0xee2)]('.')?_0x494601['push']({'name':_0x5b97ad,'url':_0x45fd78+_0x2895c0}):(_0x346be1++,console[_0x2a8d37(0x17b)]('批量导入格式错误，已跳过此行:',_0x395705));}_0x346be1>0x0&&await _0x296ef9(_0x2a8d37(0x2d8),'有\x20'+_0x346be1+'\x20行的格式不正确，已被系统跳过。');if(_0x494601[_0x2a8d37(0xfde)]>0x0){if(_0x4f9078==='ai'){if(!_0x1befff[_0x2a8d37(0x886)][_0x2a8d37(0x7fa)])_0x1befff[_0x2a8d37(0x886)][_0x2a8d37(0x7fa)]=[];_0x1befff[_0x2a8d37(0x886)][_0x2a8d37(0x7fa)][_0x2a8d37(0x258)](..._0x494601),await _0x342df8[_0x2a8d37(0x864)][_0x2a8d37(0x9c0)](_0x1befff),_0x10dc94();}else{if(_0x4f9078===_0x2a8d37(0x109d)){if(!_0x1befff[_0x2a8d37(0x886)][_0x2a8d37(0x34a)])_0x1befff[_0x2a8d37(0x886)][_0x2a8d37(0x34a)]=[];_0x1befff[_0x2a8d37(0x886)]['groupAvatarLibrary'][_0x2a8d37(0x258)](..._0x494601),await _0x342df8[_0x2a8d37(0x864)]['put'](_0x1befff),_0xa3062b();}}await _0x296ef9(_0x2a8d37(0xab0),'已成功批量导入\x20'+_0x494601[_0x2a8d37(0xfde)]+_0x2a8d37(0x17a));}else _0x346be1===0x0&&alert('没有找到可导入的内容。请检查您粘贴的格式是否正确。');}async function _0x5b4c16(){const _0xbc0944=_0x549949,_0x4dbf8a=await _0x12e332('添加头像',_0xbc0944(0x370));if(!_0x4dbf8a||!_0x4dbf8a[_0xbc0944(0x1cb)]())return;const _0x46cff6=await _0x12e332('添加头像',_0xbc0944(0x473),'','url');if(!_0x46cff6||!_0x46cff6[_0xbc0944(0x1cb)]()[_0xbc0944(0x1122)](_0xbc0944(0xaec))){alert('请输入有效的图片URL！');return;}const _0xefb2c6=_0x41df36[_0xbc0944(0x864)][_0x41df36['activeChatId']];!_0xefb2c6[_0xbc0944(0x886)][_0xbc0944(0x34a)]&&(_0xefb2c6['settings']['groupAvatarLibrary']=[]),_0xefb2c6[_0xbc0944(0x886)][_0xbc0944(0x34a)][_0xbc0944(0x258)]({'name':_0x4dbf8a[_0xbc0944(0x1cb)](),'url':_0x46cff6['trim']()}),await _0x342df8[_0xbc0944(0x864)][_0xbc0944(0x9c0)](_0xefb2c6),_0xa3062b();}function _0x4b38f1(_0x20c663){return new Promise(_0xf25cb9=>{const _0xf323e7=_0x42ed,_0x521e44=document['getElementById']('chat-list-actions-modal'),_0x5239c5=document[_0xf323e7(0x383)](_0xf323e7(0x11c6)),_0x2eed95=document[_0xf323e7(0x383)](_0xf323e7(0x152)),_0x3663fb=document[_0xf323e7(0x383)](_0xf323e7(0x170));_0x5239c5[_0xf323e7(0x138e)]=_0x20c663[_0xf323e7(0x521)]?_0xf323e7(0x10e2):_0xf323e7(0x4db);const _0x1fcadb=_0x5239c5[_0xf323e7(0x117b)](!![]);_0x5239c5['parentNode'][_0xf323e7(0xe58)](_0x1fcadb,_0x5239c5),_0x1fcadb[_0xf323e7(0xc50)]=()=>{const _0x2d0638=_0xf323e7;_0x521e44[_0x2d0638(0x119a)]['remove'](_0x2d0638(0x106d)),_0xf25cb9(_0x2d0638(0x104f));};const _0x2bb2a4=_0x2eed95[_0xf323e7(0x117b)](!![]);_0x2eed95[_0xf323e7(0x1245)][_0xf323e7(0xe58)](_0x2bb2a4,_0x2eed95),_0x2bb2a4['onclick']=()=>{const _0x209bc3=_0xf323e7;_0x521e44['classList'][_0x209bc3(0x131d)](_0x209bc3(0x106d)),_0xf25cb9('delete');};const _0x549e81=_0x3663fb[_0xf323e7(0x117b)](!![]);_0x3663fb[_0xf323e7(0x1245)][_0xf323e7(0xe58)](_0x549e81,_0x3663fb),_0x549e81[_0xf323e7(0xc50)]=()=>{const _0x3e2d91=_0xf323e7;_0x521e44[_0x3e2d91(0x119a)][_0x3e2d91(0x131d)](_0x3e2d91(0x106d)),_0xf25cb9(null);},_0x521e44[_0xf323e7(0x119a)][_0xf323e7(0xbff)]('visible');});}function _0x4f56f2(){const _0x55d666=_0x549949,_0x170d93=document[_0x55d666(0x383)](_0x55d666(0x87a)),_0x492ae5=_0x41df36[_0x55d666(0xc0)]['cphoneWallpaper'];_0x492ae5?_0x170d93[_0x55d666(0x655)][_0x55d666(0x880)]='url('+_0x492ae5+')':_0x170d93[_0x55d666(0x655)][_0x55d666(0x880)]=_0x55d666(0x917);}function _0x3df773(){const _0x5ca527=_0x549949;if(!_0x41df36[_0x5ca527(0xc0)]['cphoneAppIcons'])return;for(const _0x2e2df4 in _0x41df36[_0x5ca527(0xc0)][_0x5ca527(0x943)]){const _0x47311e=document[_0x5ca527(0x383)](_0x5ca527(0x12be)+_0x2e2df4);_0x47311e&&(_0x47311e[_0x5ca527(0xf6c)]=_0x41df36[_0x5ca527(0xc0)]['cphoneAppIcons'][_0x2e2df4]);}}function _0x2727d9(){const _0x465775=_0x549949,_0x199534=document[_0x465775(0x383)](_0x465775(0x490));if(!_0x199534)return;_0x199534[_0x465775(0x45c)]='';const _0x3d88e9={'qq':'QQ','album':'相册','browser':_0x465775(0xf77),'taobao':'淘宝','memo':'备忘录','diary':'日记','amap':_0x465775(0x5e6),'usage':_0x465775(0x2dc),'music':_0x465775(0xbe4),'ephone':_0x465775(0x1034)};for(const _0x2a6482 in _0x41df36[_0x465775(0xc0)][_0x465775(0x943)]){const _0x326a77=_0x41df36[_0x465775(0xc0)][_0x465775(0x943)][_0x2a6482],_0x3bd10d=_0x3d88e9[_0x2a6482]||'未知App',_0x1a3d5f=document[_0x465775(0xe1b)](_0x465775(0x7fd));_0x1a3d5f[_0x465775(0x556)]=_0x465775(0xe4f),_0x1a3d5f['dataset'][_0x465775(0xdf7)]=_0x2a6482,_0x1a3d5f['innerHTML']=_0x465775(0x2a7)+_0x326a77+'\x22\x20alt=\x22'+_0x3bd10d+_0x465775(0xf5a),_0x199534[_0x465775(0xe91)](_0x1a3d5f);}}function _0x323732(){const _0x4cbdfc=_0x549949;if(!_0x41df36['globalSettings'][_0x4cbdfc(0x33f)])return;for(const _0x49633d in _0x41df36['globalSettings']['appIcons']){const _0x34919f=document['getElementById'](_0x4cbdfc(0x5a2)+_0x49633d);_0x34919f&&(_0x34919f[_0x4cbdfc(0xf6c)]=_0x41df36['globalSettings'][_0x4cbdfc(0x33f)][_0x49633d]);}}function _0xd31dcf(){const _0x48aaa3=_0x549949,_0x1d3aa6=document[_0x48aaa3(0x383)](_0x48aaa3(0xb16));if(!_0x1d3aa6)return;_0x1d3aa6['innerHTML']='';const _0x57898e={'qq':'QQ','world-book':_0x48aaa3(0x70e),'wallpaper':_0x48aaa3(0x10fc),'renderer':_0x48aaa3(0x1031),'api-settings':_0x48aaa3(0x896),'font':'字体','char-phone':'Cphone','douban':_0x48aaa3(0x8bb),'preset':'预设','tutorial':'教程','werewolf':_0x48aaa3(0x1ed),'x':'X'};for(const _0x539800 in _0x41df36[_0x48aaa3(0xc0)][_0x48aaa3(0x33f)]){const _0x1b7217=_0x41df36['globalSettings'][_0x48aaa3(0x33f)][_0x539800],_0x2bc756=_0x57898e[_0x539800]||_0x48aaa3(0xd5b),_0x4d023f=document[_0x48aaa3(0xe1b)](_0x48aaa3(0x7fd));_0x4d023f[_0x48aaa3(0x556)]='icon-setting-item',_0x4d023f[_0x48aaa3(0x118)][_0x48aaa3(0xdf7)]=_0x539800,_0x4d023f[_0x48aaa3(0x45c)]=_0x48aaa3(0x2a7)+_0x1b7217+'\x22\x20alt=\x22'+_0x2bc756+_0x48aaa3(0xf5a),_0x1d3aa6['appendChild'](_0x4d023f);}}function _0x38a572(_0x3086f9){const _0x3fe326=_0x549949;if(!_0x41df36[_0x3fe326(0xfc5)])return;const _0x5850c9=_0x41df36[_0x3fe326(0x864)][_0x41df36[_0x3fe326(0xfc5)]];if(!_0x5850c9||!_0x5850c9[_0x3fe326(0xd08)])return;const _0x188a00=_0x5850c9[_0x3fe326(0xd08)][_0x3fe326(0xd12)](_0x19a156=>_0x19a156['timestamp']===_0x3086f9);if(!_0x188a00||_0x188a00[_0x3fe326(0xa6b)]!==_0x3fe326(0x94a)){console[_0x3fe326(0x98)]('无法找到或消息类型不匹配的分享链接:',_0x3086f9);return;}document['getElementById']('browser-title')[_0x3fe326(0x138e)]=_0x188a00[_0x3fe326(0x8d4)]||'文章详情';const _0x4469ce=document[_0x3fe326(0x383)]('browser-content');_0x4469ce[_0x3fe326(0x45c)]=_0x3fe326(0x55a)+(_0x188a00[_0x3fe326(0xf3a)]||_0x3fe326(0xdff))+_0x3fe326(0xc2c)+(_0x188a00[_0x3fe326(0x8d4)]||'未知')+_0x3fe326(0x16c)+(_0x188a00[_0x3fe326(0x11b6)]||'内容为空。')[_0x3fe326(0x709)](/\n/g,'</p><p>')+_0x3fe326(0x1c7),_0x105acd(_0x3fe326(0x61f));}function _0x15f3e7(){const _0x4af1b6=_0x549949;_0x105acd(_0x4af1b6(0x862));}function _0x15f3e7(){const _0x4b7d15=_0x549949;_0x105acd(_0x4b7d15(0x862));}function _0x310a74(){const _0x2bb449=_0x549949;if(!_0x41df36[_0x2bb449(0xfc5)])return;document[_0x2bb449(0x383)]('link-title-input')[_0x2bb449(0x1be)]='',document[_0x2bb449(0x383)]('link-description-input')[_0x2bb449(0x1be)]='',document[_0x2bb449(0x383)](_0x2bb449(0x10ad))['value']='',document[_0x2bb449(0x383)](_0x2bb449(0x1295))['value']='',document[_0x2bb449(0x383)](_0x2bb449(0x294))[_0x2bb449(0x119a)][_0x2bb449(0xbff)]('visible');}async function _0x3f34b3(){const _0xfee587=_0x549949;if(!_0x41df36['activeChatId'])return;const _0x3f8a8b=document[_0xfee587(0x383)]('link-title-input')[_0xfee587(0x1be)][_0xfee587(0x1cb)]();if(!_0x3f8a8b){alert('标题是必填项哦！');return;}const _0x4ce20f=document[_0xfee587(0x383)](_0xfee587(0xb96))['value'][_0xfee587(0x1cb)](),_0x6817ed=document[_0xfee587(0x383)](_0xfee587(0x10ad))['value'][_0xfee587(0x1cb)](),_0x53ec2a=document['getElementById'](_0xfee587(0x1295))['value'][_0xfee587(0x1cb)](),_0xa87591=_0x41df36[_0xfee587(0x864)][_0x41df36[_0xfee587(0xfc5)]],_0x40fefb={'role':_0xfee587(0x66e),'type':_0xfee587(0x94a),'timestamp':Date[_0xfee587(0x108d)](),'title':_0x3f8a8b,'description':_0x4ce20f,'source_name':_0x6817ed,'content':_0x53ec2a,'thumbnail_url':null};_0xa87591['history'][_0xfee587(0x258)](_0x40fefb),await _0x342df8[_0xfee587(0x864)][_0xfee587(0x9c0)](_0xa87591),_0x323467(_0x40fefb,_0xa87591),_0x25558e(),document[_0xfee587(0x383)](_0xfee587(0x294))[_0xfee587(0x119a)]['remove'](_0xfee587(0x106d));}function _0x29938a(_0x4a00f7,_0x32d963){const _0x3ed7bc=_0x549949;if(!_0x32d963||!_0x32d963['id'])return[];const _0x30c35a=_0x32d963[_0x3ed7bc(0x11a6)],_0x1216a8=_0x32d963['id'];return _0x4a00f7[_0x3ed7bc(0x98a)](_0x2923de=>{const _0x477b05=_0x3ed7bc;if(_0x2923de[_0x477b05(0x1301)]===_0x477b05(0x66e)){if(_0x2923de[_0x477b05(0x74d)]&&_0x2923de[_0x477b05(0x74d)][_0x477b05(0xfde)]>0x0)return _0x30c35a&&_0x2923de[_0x477b05(0x74d)][_0x477b05(0xee2)](_0x30c35a);return!![];}if(String(_0x2923de[_0x477b05(0x1301)])[_0x477b05(0x1122)]('npc_')){if(Array[_0x477b05(0x565)](_0x2923de['visibleTo']))return _0x2923de[_0x477b05(0x269)][_0x477b05(0xee2)](_0x1216a8);return![];}const _0x57e011=_0x41df36[_0x477b05(0x864)][_0x2923de[_0x477b05(0x1301)]];if(!_0x57e011)return![];const _0x117347=_0x57e011[_0x477b05(0x11a6)],_0x414f38=_0x117347&&_0x30c35a&&_0x117347===_0x30c35a,_0x5e23ab=!_0x117347&&!_0x30c35a;return _0x414f38||_0x5e23ab;});}function _0x149bc9(_0xc86684){const _0x5e7313=_0x549949,_0x24a7ee=document['getElementById'](_0x5e7313(0x1200)),_0x376deb=document[_0x5e7313(0x383)]('theme-toggle-switch'),_0x49c5fd=_0xc86684===_0x5e7313(0xf69);_0x24a7ee['classList'][_0x5e7313(0x8f0)]('dark-mode',_0x49c5fd),_0x376deb&&(_0x376deb[_0x5e7313(0x2a3)]=_0x49c5fd),localStorage[_0x5e7313(0x16a)](_0x5e7313(0xd95),_0xc86684);}function _0x1bdc62(){const _0x85a949=_0x549949,_0x348aaf=document[_0x85a949(0x383)](_0x85a949(0x820)),_0x2e7851=_0x348aaf[_0x85a949(0x2a3)]?_0x85a949(0xf69):'light';_0x149bc9(_0x2e7851);}function _0x1cf19c(){const _0x36277a=_0x549949;if(!_0x41df36[_0x36277a(0xfc5)])return;_0x164923(),_0x105acd(_0x36277a(0xbf9));}function _0x164923(){const _0x25ed0b=_0x549949,_0xc41deb=document[_0x25ed0b(0x383)](_0x25ed0b(0x1315)),_0x2f8ae5=_0x41df36[_0x25ed0b(0x864)][_0x41df36[_0x25ed0b(0xfc5)]];_0xc41deb['innerHTML']='';let _0x4fef32=[];_0x2f8ae5[_0x25ed0b(0x1a2)]?_0x2f8ae5[_0x25ed0b(0x12a6)]['forEach'](_0x35db98=>{const _0x5bd0b2=_0x25ed0b,_0x26b8ca=_0x41df36[_0x5bd0b2(0x864)][_0x35db98['id']];if(_0x26b8ca&&_0x26b8ca['longTermMemory']){const _0x3ab44a=_0x26b8ca[_0x5bd0b2(0x1349)][_0x5bd0b2(0xa79)](_0x36086f=>({..._0x36086f,'authorName':_0x35db98[_0x5bd0b2(0x9da)],'authorChatId':_0x35db98['id']}));_0x4fef32[_0x5bd0b2(0x258)](..._0x3ab44a);}}):_0x2f8ae5[_0x25ed0b(0x1349)]&&(_0x4fef32=_0x2f8ae5['longTermMemory']['map'](_0x24fa06=>({..._0x24fa06,'authorName':_0x2f8ae5['name'],'authorChatId':_0x2f8ae5['id']})));if(_0x4fef32[_0x25ed0b(0xfde)]===0x0){_0xc41deb[_0x25ed0b(0x45c)]=_0x25ed0b(0xb76);return;}_0x4fef32[_0x25ed0b(0x1296)]((_0x29c8fa,_0x1700ba)=>_0x1700ba[_0x25ed0b(0x3b7)]-_0x29c8fa[_0x25ed0b(0x3b7)]),_0x4fef32[_0x25ed0b(0x19c)]((_0x2fa1ba,_0x5391d0)=>{const _0x421af2=_0x25ed0b,_0x148f9a=document['createElement'](_0x421af2(0x7fd));_0x148f9a[_0x421af2(0x556)]='memory-card',_0x148f9a[_0x421af2(0x655)]['cursor']=_0x421af2(0xba4),_0x148f9a[_0x421af2(0x45c)]=_0x421af2(0x89f)+_0x2fa1ba[_0x421af2(0x1253)]+_0x421af2(0x1203)+_0x2fa1ba[_0x421af2(0x11b6)][_0x421af2(0x709)](/\n/g,_0x421af2(0x3ee))+_0x421af2(0xe23)+_0x2fa1ba[_0x421af2(0x5be)]+_0x421af2(0x884)+_0x2fa1ba[_0x421af2(0x3b7)]+_0x421af2(0x11a2)+_0x2fa1ba[_0x421af2(0x5be)]+_0x421af2(0x884)+_0x2fa1ba[_0x421af2(0x3b7)]+_0x421af2(0xd62),_0xc41deb[_0x421af2(0xe91)](_0x148f9a);});}async function _0x3ea343(){const _0x2efb15=_0x549949,_0x2cf464=_0x41df36[_0x2efb15(0x864)][_0x41df36[_0x2efb15(0xfc5)]];if(!_0x2cf464)return;let _0x42deb7=_0x2cf464;if(_0x2cf464['isGroup']){const _0x2c5d36=_0x2cf464['members'][_0x2efb15(0xa79)](_0x3c3b80=>({'text':'为“'+_0x3c3b80[_0x2efb15(0x9da)]+_0x2efb15(0x2ce),'value':_0x3c3b80['id']})),_0x1c5f6d=await _0x2d60a4(_0x2efb15(0xa59),_0x2c5d36);if(!_0x1c5f6d)return;_0x42deb7=_0x41df36[_0x2efb15(0x864)][_0x1c5f6d];if(!_0x42deb7){alert(_0x2efb15(0x5f2));return;}}const _0x46f2a2=await _0x12e332('为“'+_0x42deb7['name']+_0x2efb15(0x2ce),_0x2efb15(0x2d0),'',_0x2efb15(0xfe5));if(_0x46f2a2&&_0x46f2a2[_0x2efb15(0x1cb)]()){if(!_0x42deb7['longTermMemory'])_0x42deb7[_0x2efb15(0x1349)]=[];_0x42deb7['longTermMemory'][_0x2efb15(0x258)]({'content':_0x46f2a2[_0x2efb15(0x1cb)](),'timestamp':Date[_0x2efb15(0x108d)](),'source':'manual'}),await _0x342df8['chats']['put'](_0x42deb7),_0x164923();}}async function _0x127d87(_0x548362,_0x3aad83){const _0x675e6a=_0x549949,_0x329f9a=_0x41df36[_0x675e6a(0x864)][_0x548362];if(!_0x329f9a||!_0x329f9a[_0x675e6a(0x1349)])return;const _0x2bbffb=_0x329f9a[_0x675e6a(0x1349)]['findIndex'](_0x4a3468=>_0x4a3468['timestamp']===_0x3aad83);if(_0x2bbffb===-0x1)return;const _0x251dee=_0x329f9a[_0x675e6a(0x1349)][_0x2bbffb],_0x5590c1=await _0x12e332(_0x675e6a(0x5fc),_0x675e6a(0xc79),_0x251dee[_0x675e6a(0x11b6)],_0x675e6a(0xfe5));_0x5590c1&&_0x5590c1[_0x675e6a(0x1cb)]()&&(_0x251dee[_0x675e6a(0x11b6)]=_0x5590c1[_0x675e6a(0x1cb)](),await _0x342df8[_0x675e6a(0x864)]['put'](_0x329f9a),_0x164923());}async function _0x47a9a6(_0x43269e,_0x5c04e2){const _0x109ce8=_0x549949,_0x1827c4=await _0x23a88b(_0x109ce8(0x615),_0x109ce8(0x810),{'confirmButtonClass':'btn-danger'});if(_0x1827c4){const _0x1f99c8=_0x41df36[_0x109ce8(0x864)][_0x43269e];if(!_0x1f99c8||!_0x1f99c8[_0x109ce8(0x1349)])return;_0x1f99c8['longTermMemory']=_0x1f99c8[_0x109ce8(0x1349)]['filter'](_0xc2195f=>_0xc2195f[_0x109ce8(0x3b7)]!==_0x5c04e2),await _0x342df8[_0x109ce8(0x864)][_0x109ce8(0x9c0)](_0x1f99c8),_0x164923();}}async function _0x21c325(){const _0x5907b5=_0x549949,_0x5756d8=await _0x23a88b(_0x5907b5(0xca),_0x5907b5(0xb14));_0x5756d8&&await _0x403747(_0x41df36[_0x5907b5(0xfc5)],!![]);}async function _0x2235e7(_0x52d30a){const _0x234806=_0x549949,_0xbb53c9=_0x41df36['chats'][_0x52d30a];if(!_0xbb53c9||!_0xbb53c9[_0x234806(0x886)][_0x234806(0xd3)])return;const _0x159822=_0xbb53c9['lastMemorySummaryTimestamp']||0x0,_0x25a1d9=_0xbb53c9[_0x234806(0xd08)][_0x234806(0x98a)](_0x16208e=>_0x16208e[_0x234806(0x3b7)]>_0x159822&&!_0x16208e[_0x234806(0xbc5)]);_0x25a1d9[_0x234806(0xfde)]>=_0xbb53c9[_0x234806(0x886)][_0x234806(0x9d5)]&&(console[_0x234806(0xe72)]('达到自动总结阈值\x20('+_0x25a1d9[_0x234806(0xfde)]+'/'+_0xbb53c9['settings']['autoMemoryInterval']+')，开始总结...'),await _0x403747(_0x52d30a));}async function _0x5ef3b0(_0x454b58,_0x4f0faf){const _0x56f789=_0x549949,_0x21ea3e=_0x41df36[_0x56f789(0x864)][_0x454b58];if(!_0x21ea3e||!_0x4f0faf)throw new Error(_0x56f789(0x41a));const _0x24cfc1=_0x41df36[_0x56f789(0x571)][_0x56f789(0xabb)]||'用户';let _0x29eeaf,_0x32bdfd=_0x21ea3e;const _0x2ceae2=new Date()[_0x56f789(0xb8b)](_0x56f789(0xafb),{'year':_0x56f789(0x12ec),'month':'long','day':'numeric'});if(_0x21ea3e['isGroup']){let _0x42da06=null;_0x4f60f2['callRequester']&&(_0x42da06=_0x21ea3e[_0x56f789(0x12a6)][_0x56f789(0xd12)](_0x366dde=>_0x366dde[_0x56f789(0x283)]===_0x4f60f2[_0x56f789(0x496)]));!_0x42da06&&(_0x42da06=_0x21ea3e[_0x56f789(0x12a6)][_0x56f789(0xd12)](_0x3298fd=>_0x3298fd['id']!==_0x56f789(0x66e)&&_0x4f60f2[_0x56f789(0x9a6)][_0x56f789(0x12fb)](_0xd6b441=>_0xd6b441['id']===_0x3298fd['id'])));!_0x42da06&&(_0x42da06=_0x21ea3e[_0x56f789(0x12a6)][_0x56f789(0xd12)](_0x393c84=>_0x393c84['id']!=='user'));if(!_0x42da06)throw new Error(_0x56f789(0xd41));const _0x4eed04=_0x41df36[_0x56f789(0x864)][_0x42da06['id']];if(!_0x4eed04)throw new Error(_0x56f789(0x814)+_0x42da06[_0x56f789(0x9da)]+_0x56f789(0x2e4));const _0x3824b1=_0x21ea3e[_0x56f789(0x886)]['myPersona']||_0x56f789(0x11f);_0x29eeaf=_0x56f789(0xee7)+_0x42da06[_0x56f789(0x283)]+_0x56f789(0xd5e)+_0x24cfc1+'”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x2ceae2+_0x56f789(0x120c)+_0x2ceae2+'”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a'+_0x4eed04[_0x56f789(0x886)][_0x56f789(0xd83)]+_0x56f789(0x10b1)+_0x3824b1+_0x56f789(0x277)+_0x4f0faf+'\x0a\x0a现在，请以“'+_0x42da06[_0x56f789(0x283)]+'”的身份，开始你的客观总结。',_0x32bdfd=_0x4eed04;}else _0x29eeaf=_0x56f789(0xee7)+_0x21ea3e['originalName']+'”。请你回顾一下刚才和“'+_0x24cfc1+_0x56f789(0xa11)+_0x2ceae2+_0x56f789(0x12d8)+_0x2ceae2+_0x56f789(0xa54)+_0x21ea3e[_0x56f789(0x886)][_0x56f789(0xd83)]+_0x56f789(0x10b1)+_0x21ea3e[_0x56f789(0x886)][_0x56f789(0xe63)]+'\x0a\x0a#\x20待总结的视频通话记录\x0a'+_0x4f0faf+_0x56f789(0xe4a)+_0x21ea3e[_0x56f789(0x283)]+'”的身份，开始你的客观总结。';try{const _0x30bd70=_0x41df36[_0x56f789(0x673)][_0x56f789(0xabf)]&&_0x41df36[_0x56f789(0x673)]['secondaryApiKey']&&_0x41df36[_0x56f789(0x673)][_0x56f789(0x782)],{proxyUrl:_0x1b9f89,apiKey:_0x581156,model:_0x260120}=_0x30bd70?{'proxyUrl':_0x41df36['apiConfig'][_0x56f789(0xabf)],'apiKey':_0x41df36[_0x56f789(0x673)]['secondaryApiKey'],'model':_0x41df36[_0x56f789(0x673)][_0x56f789(0x782)]}:_0x41df36[_0x56f789(0x673)];if(!_0x1b9f89||!_0x581156||!_0x260120)throw new Error('API未配置，无法进行总结。');let _0x5465e1=_0x1b9f89[_0x56f789(0xee2)](_0x56f789(0xdc3)),_0x5cc5df=_0x112768(_0x260120,_0x581156,_0x29eeaf,[{'role':'user','content':_0x56f789(0x177)}]);const _0x279e86=_0x5465e1?await fetch(_0x5cc5df[_0x56f789(0x2fa)],_0x5cc5df[_0x56f789(0x8c6)]):await fetch(_0x1b9f89+'/v1/chat/completions',{'method':_0x56f789(0x94f),'headers':{'Content-Type':_0x56f789(0x11f0),'Authorization':_0x56f789(0xd55)+_0x581156},'body':JSON[_0x56f789(0x3fb)]({'model':_0x260120,'messages':[{'role':_0x56f789(0xb1),'content':_0x29eeaf},{'role':_0x56f789(0x66e),'content':_0x56f789(0x177)}],'temperature':0.1})});if(!_0x279e86['ok']){const _0x515a07=await _0x279e86[_0x56f789(0x9b3)]()[_0x56f789(0xa27)](()=>({'error':{'message':_0x279e86[_0x56f789(0x3ea)]}}));throw new Error(_0x56f789(0xb83)+_0x279e86[_0x56f789(0x1fe)]+'\x20-\x20'+_0x515a07[_0x56f789(0x98)][_0x56f789(0x5f8)]);}const _0x3c51e2=await _0x279e86['json']();let _0x3d955f=_0x5465e1?getGeminiResponseText(_0x3c51e2):_0x3c51e2[_0x56f789(0xe77)][0x0]['message']['content'];_0x3d955f=_0x3d955f['replace'](/^```json\s*/,'')['replace'](/```$/,'')[_0x56f789(0x1cb)]();const _0xdda0df=JSON['parse'](_0x3d955f);if(_0xdda0df['summary']&&_0xdda0df[_0x56f789(0xd9b)][_0x56f789(0x1cb)]()){const _0x4def7c={'content':'(在那次'+(_0x21ea3e['isGroup']?'群聊':'')+_0x56f789(0x104)+_0xdda0df['summary'][_0x56f789(0x1cb)]()+')','timestamp':Date[_0x56f789(0x108d)](),'source':_0x21ea3e[_0x56f789(0x1a2)]?_0x56f789(0x533):_0x56f789(0x11df)};if(!_0x32bdfd[_0x56f789(0x1349)])_0x32bdfd['longTermMemory']=[];return _0x32bdfd['longTermMemory'][_0x56f789(0x258)](_0x4def7c),await _0x342df8[_0x56f789(0x864)][_0x56f789(0x9c0)](_0x32bdfd),console['log'](_0x56f789(0x616)+_0x32bdfd[_0x56f789(0x461)]+_0x56f789(0x464)),!![];}else throw new Error(_0x56f789(0xf5e));}catch(_0x245205){console[_0x56f789(0x98)](_0x56f789(0x993),_0x245205);throw _0x245205;}}function _0x410a15(_0x5de78c){const _0x89e4b9=_0x549949,_0x9c0817=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么',_0x89e4b9(0xff5),'哪个','一些','这个','那个','还有']),_0x3bad82=_0x5de78c[_0x89e4b9(0x22e)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x3adabe=new Map();let _0x4cdf06=0x0;_0x3bad82[_0x89e4b9(0x19c)](_0x2a7193=>{const _0x5e8245=_0x89e4b9;if(_0x2a7193[_0x5e8245(0xfde)]>0x1&&!_0x9c0817[_0x5e8245(0xcde)](_0x2a7193)){const _0x2ae69c=(_0x3adabe['get'](_0x2a7193)||0x0)+0x1;_0x3adabe[_0x5e8245(0x5ba)](_0x2a7193,_0x2ae69c);if(_0x2ae69c>_0x4cdf06)_0x4cdf06=_0x2ae69c;}});const _0x4dfcb3=[],_0x516060=[],_0x359681=_0x4cdf06*0.9,_0x28060c=_0x4cdf06*0.6;_0x3adabe[_0x89e4b9(0x19c)]((_0x46afb9,_0x1447f2)=>{const _0x163269=_0x89e4b9;if(_0x46afb9>=_0x359681)_0x4dfcb3[_0x163269(0x258)](_0x1447f2);else _0x46afb9>=_0x28060c&&_0x516060['push'](_0x1447f2);});const _0x6fe78d=new Set(_0x4dfcb3),_0x346b07=_0x516060[_0x89e4b9(0x98a)](_0x5535f1=>!_0x6fe78d[_0x89e4b9(0xcde)](_0x5535f1))[_0x89e4b9(0x1368)](0x0,0x5);return{'coreKeywords':_0x4dfcb3[_0x89e4b9(0x1368)](0x0,0x3),'situationalKeywords':_0x346b07};}function _0x1ad6bb(_0x2ef008,_0x2512cd,_0xd261a4){const _0x3aa783=_0x549949;let _0x27470c;_0xd261a4===_0x3aa783(0x2f2)?_0x27470c=Date[_0x3aa783(0x108d)]()-_0x2512cd*0x3c*0x3c*0x3e8:_0x27470c=Date[_0x3aa783(0x108d)]()-_0x2512cd*0x18*0x3c*0x3c*0x3e8;const _0x1581b2=_0x2ef008[_0x3aa783(0xd08)][_0x3aa783(0x98a)](_0x456fcd=>_0x456fcd['timestamp']>_0x27470c&&!_0x456fcd['isHidden']);if(_0x1581b2[_0x3aa783(0xfde)]<0x3)return'';const _0x109cf5=_0x1581b2[_0x3aa783(0xa79)](_0x4b70a3=>{const _0x26c42c=_0x3aa783;if(typeof _0x4b70a3['content']===_0x26c42c(0xafa))return _0x4b70a3[_0x26c42c(0x11b6)];if(_0x4b70a3[_0x26c42c(0xa6b)]==='voice_message')return _0x4b70a3[_0x26c42c(0x11b6)];if(_0x4b70a3[_0x26c42c(0xa6b)]==='offline_text')return(_0x4b70a3['dialogue']||'')+'\x20'+(_0x4b70a3[_0x26c42c(0xee1)]||'');return'';})['join']('\x20'),_0x1e45b9=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0x2a653f=_0x109cf5['match'](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0xecafca=new Map();_0x2a653f[_0x3aa783(0x19c)](_0x4223f0=>{const _0x5375c6=_0x3aa783;_0x4223f0['length']>0x1&&!_0x1e45b9[_0x5375c6(0xcde)](_0x4223f0)&&_0xecafca[_0x5375c6(0x5ba)](_0x4223f0,(_0xecafca[_0x5375c6(0x1a3)](_0x4223f0)||0x0)+0x1);});const _0x5de189=[..._0xecafca[_0x3aa783(0x329)]()][_0x3aa783(0x1296)]((_0x45ea65,_0x1f2a91)=>_0x1f2a91[0x1]-_0x45ea65[0x1])[_0x3aa783(0xa79)](_0x44f9e9=>_0x44f9e9[0x0]);if(_0x5de189['length']===0x0)return'';let _0x38cb5c;return _0xd261a4===_0x3aa783(0x2f2)?_0x38cb5c='最近'+_0x2512cd+'小时核心议题':_0x2512cd===0x1?_0x38cb5c=_0x3aa783(0x75f):_0x38cb5c='最近'+_0x2512cd+_0x3aa783(0x9c8),_0x3aa783(0x4c2)+_0x38cb5c+_0x3aa783(0xf74)+_0x5de189[_0x3aa783(0x1368)](0x0,0x3)[_0x3aa783(0xa35)]('、\x20')+_0x3aa783(0x7ec);}function _0x271f60(_0x172839){const _0x518cc4=_0x549949;if(!_0x172839||typeof _0x172839!=='string')return null;const _0x386fee=_0x172839[_0x518cc4(0x709)](/^```json\s*/,'')[_0x518cc4(0x709)](/```$/,'')[_0x518cc4(0x1cb)](),_0x305350=_0x386fee['match'](/{[\s\S]*}/);if(_0x305350)try{const _0x5108f9=JSON['parse'](_0x305350[0x0]);return console[_0x518cc4(0xe72)](_0x518cc4(0x11e8)),_0x5108f9;}catch(_0x12c5d2){console[_0x518cc4(0x17b)](_0x518cc4(0x3ce));}const _0x3230d5=_0x386fee[_0x518cc4(0x22e)](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0x3230d5&&_0x3230d5[0x1])return console[_0x518cc4(0xe72)](_0x518cc4(0x1c0)),{'summary':_0x3230d5[0x1][_0x518cc4(0x709)](/\\"/g,'\x22')};if(_0x386fee)return console[_0x518cc4(0xe72)](_0x518cc4(0x133d)),{'summary':_0x386fee};return null;}async function _0x186153(_0x3b2dcb){const _0x96f6=_0x549949;let _0x236fe4=_0x41df36['chats'][_0x3b2dcb];if(!_0x236fe4)return;let _0x562ba8=_0x236fe4;if(_0x236fe4[_0x96f6(0x1a2)]){const _0x85cecc=_0x236fe4[_0x96f6(0x12a6)][_0x96f6(0xa79)](_0x18edf5=>{const _0x2c4ff8=_0x96f6,_0x3a6362=_0x41df36[_0x2c4ff8(0x864)][_0x18edf5['id']];if(_0x3a6362&&_0x3a6362['longTermMemory']&&_0x3a6362[_0x2c4ff8(0x1349)]['length']>=0x2)return{'text':_0x2c4ff8(0x5d5)+_0x18edf5[_0x2c4ff8(0x9da)]+_0x2c4ff8(0xf8e)+_0x3a6362[_0x2c4ff8(0x1349)][_0x2c4ff8(0xfde)]+'条)','value':_0x18edf5['id']};return null;})[_0x96f6(0x98a)](Boolean);if(_0x85cecc[_0x96f6(0xfde)]===0x0){alert(_0x96f6(0x3c5));return;}const _0x1b5277=await _0x2d60a4(_0x96f6(0xaed),_0x85cecc);if(!_0x1b5277)return;_0x562ba8=_0x41df36[_0x96f6(0x864)][_0x1b5277];}if(!_0x562ba8[_0x96f6(0x1349)]||_0x562ba8['longTermMemory'][_0x96f6(0xfde)]<0x2){alert('“'+_0x562ba8[_0x96f6(0x461)]+_0x96f6(0x76f));return;}const _0x45c37b=_0x562ba8[_0x96f6(0x1349)]['length'],_0xb137d3=await _0x2d60a4('选择精炼范围',[{'text':_0x96f6(0x3ef)+_0x45c37b+'条)','value':_0x96f6(0x1282)},{'text':_0x96f6(0x57d),'value':'20'},{'text':_0x96f6(0xc7e),'value':'50'},{'text':'最近\x20100\x20条','value':'100'},{'text':'自定义数量...','value':_0x96f6(0x4fe)}][_0x96f6(0x98a)](_0x2ae3a6=>_0x2ae3a6['value']===_0x96f6(0x1282)||_0x2ae3a6['value']===_0x96f6(0x4fe)||parseInt(_0x2ae3a6[_0x96f6(0x1be)])<_0x45c37b));if(_0xb137d3===null)return;let _0x379250,_0x283f76=_0x45c37b;if(_0xb137d3==='all')_0x379250=[..._0x562ba8[_0x96f6(0x1349)]];else{if(_0xb137d3===_0x96f6(0x4fe)){const _0x11b945=await _0x12e332(_0x96f6(0x6d2),_0x96f6(0xc28)+_0x45c37b+'\x20条)');if(_0x11b945===null)return;const _0x7e4095=parseInt(_0x11b945);if(isNaN(_0x7e4095)||_0x7e4095<0x2||_0x7e4095>_0x45c37b){alert(_0x96f6(0x1111)+_0x45c37b+'\x20之间的有效数字。');return;}_0x283f76=_0x7e4095,_0x379250=_0x562ba8[_0x96f6(0x1349)]['slice'](-_0x283f76);}else _0x283f76=parseInt(_0xb137d3),_0x283f76>=_0x45c37b?(_0x379250=[..._0x562ba8[_0x96f6(0x1349)]],_0x283f76=_0x45c37b):_0x379250=_0x562ba8['longTermMemory']['slice'](-_0x283f76);}const _0x203bc6=await _0x12e332('设置精炼字数','请输入精炼后核心记忆的大致字数：',_0x96f6(0x12e1));if(_0x203bc6===null)return;const _0x3b876f=parseInt(_0x203bc6);if(isNaN(_0x3b876f)||_0x3b876f<0x14){alert(_0x96f6(0xe86));return;}const _0x54a883=await _0x23a88b('确认精炼记忆？',_0x96f6(0x84d)+_0x283f76+_0x96f6(0x3ac)+_0x3b876f+_0x96f6(0x74f),{'confirmButtonClass':_0x96f6(0x51b),'confirmText':'确认精炼'});if(!_0x54a883)return;const _0x107a0f=_0x379250[_0x96f6(0xa79)](_0x440daa=>'-\x20'+_0x440daa[_0x96f6(0x11b6)])['join']('\x0a'),_0x49df95=_0x41df36[_0x96f6(0x571)][_0x96f6(0xabb)]||'用户',_0x5a6dc1=new Date()[_0x96f6(0xb8b)](_0x96f6(0xafb),{'year':_0x96f6(0x12ec),'month':_0x96f6(0xd8e),'day':_0x96f6(0x12ec)}),_0x504c51=_0x96f6(0xee7)+_0x562ba8[_0x96f6(0x283)]+'”。请你回顾一下你和“'+_0x49df95+_0x96f6(0x1214)+_0x5a6dc1+'**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是'+_0x5a6dc1+_0x96f6(0x1202)+_0x3b876f+_0x96f6(0xbe5)+_0x562ba8[_0x96f6(0x886)][_0x96f6(0xd83)]+_0x96f6(0x10b1)+_0x562ba8[_0x96f6(0x886)][_0x96f6(0xe63)]+_0x96f6(0x619)+_0x107a0f+'\x0a\x0a现在，请以“'+_0x562ba8[_0x96f6(0x283)]+_0x96f6(0x440);await _0x296ef9(_0x96f6(0x4a6),'正在请求AI进行记忆精炼...');try{const _0x47594d=_0x41df36[_0x96f6(0x673)][_0x96f6(0xabf)]&&_0x41df36[_0x96f6(0x673)][_0x96f6(0x1135)]&&_0x41df36[_0x96f6(0x673)][_0x96f6(0x782)],{proxyUrl:_0x2455cc,apiKey:_0x139534,model:_0x27f16a}=_0x47594d?{'proxyUrl':_0x41df36[_0x96f6(0x673)][_0x96f6(0xabf)],'apiKey':_0x41df36[_0x96f6(0x673)][_0x96f6(0x1135)],'model':_0x41df36[_0x96f6(0x673)][_0x96f6(0x782)]}:_0x41df36[_0x96f6(0x673)];if(!_0x2455cc||!_0x139534||!_0x27f16a)throw new Error(_0x96f6(0xf61));let _0x59808a=_0x2455cc[_0x96f6(0xee2)](_0x96f6(0xdc3)),_0x297748=_0x112768(_0x27f16a,_0x139534,_0x504c51,[{'role':_0x96f6(0x66e),'content':'请开始整合。'}]);const _0x3c3bf1=_0x59808a?await fetch(_0x297748[_0x96f6(0x2fa)],_0x297748[_0x96f6(0x8c6)]):await fetch(_0x2455cc+_0x96f6(0x126b),{'method':'POST','headers':{'Content-Type':_0x96f6(0x11f0),'Authorization':_0x96f6(0xd55)+_0x139534},'body':JSON[_0x96f6(0x3fb)]({'model':_0x27f16a,'messages':[{'role':_0x96f6(0xb1),'content':_0x504c51},{'role':_0x96f6(0x66e),'content':_0x96f6(0x102d)}],'temperature':0.2})});if(!_0x3c3bf1['ok'])throw new Error(_0x96f6(0x85a)+_0x3c3bf1['statusText']);const _0x138f2c=await _0x3c3bf1[_0x96f6(0x9b3)]();let _0x2319f6=_0x59808a?getGeminiResponseText(_0x138f2c):_0x138f2c[_0x96f6(0xe77)][0x0][_0x96f6(0x5f8)]['content'];const _0x166979=_0x271f60(_0x2319f6);if(_0x166979&&_0x166979[_0x96f6(0xd9b)]&&typeof _0x166979[_0x96f6(0xd9b)]===_0x96f6(0xafa)&&_0x166979[_0x96f6(0xd9b)]['trim']()){const _0x3b9853=await _0x23a88b(_0x96f6(0x12ac),'AI已将您的\x20'+_0x283f76+_0x96f6(0x333)+_0x166979['summary'][_0x96f6(0x1cb)]()+_0x96f6(0x8bd),{'confirmText':'确认替换','cancelText':_0x96f6(0x344),'confirmButtonClass':'btn-danger'});if(_0x3b9853){const _0x47042e={'content':_0x166979[_0x96f6(0xd9b)][_0x96f6(0x1cb)](),'timestamp':Date[_0x96f6(0x108d)](),'source':_0x96f6(0x179)},_0x1f344c=_0x45c37b-_0x283f76,_0x49b02a=_0x1f344c>0x0?_0x562ba8[_0x96f6(0x1349)][_0x96f6(0x1368)](0x0,_0x1f344c):[];_0x562ba8[_0x96f6(0x1349)]=[..._0x49b02a,_0x47042e],_0x562ba8['lastMemorySummaryTimestamp']=Date[_0x96f6(0x108d)](),await _0x342df8['chats'][_0x96f6(0x9c0)](_0x562ba8),document[_0x96f6(0x383)](_0x96f6(0xbf9))[_0x96f6(0x119a)][_0x96f6(0x987)](_0x96f6(0xde5))&&_0x164923(),await _0x296ef9('精炼成功',_0x96f6(0xf2b)+_0x283f76+'\x20条记忆精炼为\x201\x20条核心记忆！');}else await _0x296ef9(_0x96f6(0x1033),_0x96f6(0xd2f));}else throw new Error('AI返回了空的或格式不正确的总结内容。');}catch(_0x32f3f4){console[_0x96f6(0x98)](_0x96f6(0xc08),_0x32f3f4),await _0x296ef9(_0x96f6(0x5e2),'操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20'+_0x32f3f4[_0x96f6(0x5f8)]);}}async function _0x403747(_0xed554d,_0x262410=![]){const _0x465dff=_0x549949,_0x919828=_0x41df36[_0x465dff(0x864)][_0xed554d];if(!_0x919828)return;const _0x23558b=_0x919828['lastMemorySummaryTimestamp']||0x0,_0x4dfb6e=_0x262410?_0x919828[_0x465dff(0xd08)][_0x465dff(0x98a)](_0x1cf23d=>!_0x1cf23d['isHidden']||_0x1cf23d[_0x465dff(0x10ff)]===_0x465dff(0xb1)&&_0x1cf23d['content']['includes']('内心独白'))[_0x465dff(0x1368)](-(_0x919828['settings'][_0x465dff(0x9d5)]||0x14)):_0x919828[_0x465dff(0xd08)]['filter'](_0x50d236=>_0x50d236[_0x465dff(0x3b7)]>_0x23558b&&(!_0x50d236[_0x465dff(0xbc5)]||_0x50d236['role']===_0x465dff(0xb1)&&_0x50d236[_0x465dff(0x11b6)]['includes'](_0x465dff(0x233))));if(_0x4dfb6e[_0x465dff(0xfde)]<0x5){if(_0x262410)alert('最近的消息太少，无法进行有意义的总结。');return;}const _0x5a6579=_0x41df36[_0x465dff(0x571)]['nickname']||'用户',_0x3d25cb=_0x4dfb6e[_0x465dff(0xa79)](_0x7f42a3=>{const _0x18ee76=_0x465dff;if(_0x7f42a3[_0x18ee76(0xbc5)]&&_0x7f42a3['role']===_0x18ee76(0xb1)&&_0x7f42a3[_0x18ee76(0x11b6)]['includes'](_0x18ee76(0x233)))return _0x7f42a3[_0x18ee76(0x11b6)];let _0x1e2cbf;_0x7f42a3[_0x18ee76(0x10ff)]===_0x18ee76(0x66e)?_0x1e2cbf=_0x5a6579:_0x1e2cbf=_0x7f42a3[_0x18ee76(0x4c5)]||_0x919828[_0x18ee76(0x283)];let _0x39a688='';if(_0x7f42a3[_0x18ee76(0xa6b)]===_0x18ee76(0x44e)){if(_0x7f42a3[_0x18ee76(0x11b6)])_0x39a688=_0x7f42a3[_0x18ee76(0x11b6)];else{const _0x84fb44=_0x7f42a3[_0x18ee76(0x5ed)]?'「'+_0x7f42a3['dialogue']+'」':'',_0x5e9079=_0x7f42a3['description']?'('+_0x7f42a3['description']+')':'';_0x39a688=(_0x84fb44+'\x20'+_0x5e9079)[_0x18ee76(0x1cb)]();}}else _0x39a688=String(_0x7f42a3['content']);return _0x1e2cbf+':\x20'+_0x39a688;})[_0x465dff(0xa35)]('\x0a');let _0x3c3fc5;if(_0x919828[_0x465dff(0x1a2)])_0x3c3fc5=_0x465dff(0x1107)+_0x5a6579+_0x465dff(0x2ee)+_0x3d25cb+_0x465dff(0x1044)+_0x919828[_0x465dff(0x12a6)][_0x465dff(0xa79)](_0xd6d4fd=>'-\x20'+_0xd6d4fd['groupNickname']+_0x465dff(0xcac)+_0xd6d4fd[_0x465dff(0x283)]+')')[_0x465dff(0xa35)]('\x0a')+_0x465dff(0x7e9);else{const _0x4e43aa=new Date()[_0x465dff(0xb8b)](_0x465dff(0xafb),{'year':_0x465dff(0x12ec),'month':_0x465dff(0xd8e),'day':'numeric'});_0x3c3fc5='\x0a#\x20你的任务\x0a你就是角色“'+_0x919828[_0x465dff(0x283)]+_0x465dff(0xad1)+_0x5a6579+_0x465dff(0x11b2)+_0x4e43aa+_0x465dff(0x9f7)+_0x4e43aa+_0x465dff(0x78f)+new Date(Date['now']()+0x5265c00)[_0x465dff(0xb8b)](_0x465dff(0xafb),{'month':_0x465dff(0xd8e),'day':'numeric'})+_0x465dff(0x126c)+_0x919828['settings']['aiPersona']+_0x465dff(0xc78)+_0x919828[_0x465dff(0x886)][_0x465dff(0xe63)]+_0x465dff(0x685)+_0x3d25cb+'\x0a\x0a现在，请以“'+_0x919828[_0x465dff(0x283)]+_0x465dff(0xc10);}try{const _0x1b849b=_0x41df36[_0x465dff(0x673)][_0x465dff(0xabf)]&&_0x41df36['apiConfig']['secondaryApiKey']&&_0x41df36[_0x465dff(0x673)][_0x465dff(0x782)],{proxyUrl:_0x49f636,apiKey:_0x2304ae,model:_0x3624b8}=_0x1b849b?{'proxyUrl':_0x41df36[_0x465dff(0x673)]['secondaryProxyUrl'],'apiKey':_0x41df36[_0x465dff(0x673)][_0x465dff(0x1135)],'model':_0x41df36['apiConfig'][_0x465dff(0x782)]}:_0x41df36[_0x465dff(0x673)];if(!_0x49f636||!_0x2304ae||!_0x3624b8)throw new Error(_0x465dff(0x3f1));let _0x3dce27=_0x49f636[_0x465dff(0xee2)]('generativelanguage'),_0x21b5d2=_0x112768(_0x3624b8,_0x2304ae,_0x3c3fc5,[{'role':_0x465dff(0x66e),'content':_0x465dff(0x177)}]);const _0x44c970=_0x3dce27?await fetch(_0x21b5d2['url'],_0x21b5d2[_0x465dff(0x8c6)]):await fetch(_0x49f636+_0x465dff(0x126b),{'method':_0x465dff(0x94f),'headers':{'Content-Type':'application/json','Authorization':_0x465dff(0xd55)+_0x2304ae},'body':JSON['stringify']({'model':_0x3624b8,'messages':[{'role':'system','content':_0x3c3fc5},{'role':'user','content':_0x465dff(0x177)}],'temperature':0.2})});if(!_0x44c970['ok'])throw new Error(_0x465dff(0x85a)+_0x44c970[_0x465dff(0x3ea)]);const _0x48679a=await _0x44c970['json']();let _0x426890=_0x3dce27?getGeminiResponseText(_0x48679a):_0x48679a['choices'][0x0][_0x465dff(0x5f8)][_0x465dff(0x11b6)];_0x426890=_0x426890[_0x465dff(0x709)](/^```json\s*/,'')[_0x465dff(0x709)](/```$/,'')[_0x465dff(0x1cb)]();const _0x44d31e=JSON[_0x465dff(0x134)](_0x426890);if(_0x919828[_0x465dff(0x1a2)]){if(_0x44d31e['summaries']&&typeof _0x44d31e['summaries']==='object'){let _0xf36884=0x0;for(const _0x91f6d0 in _0x44d31e[_0x465dff(0x1046)]){const _0x3dfd18=_0x44d31e[_0x465dff(0x1046)][_0x91f6d0];if(_0x3dfd18&&_0x3dfd18[_0x465dff(0x1cb)]()){const _0x5cf644=Object[_0x465dff(0x76d)](_0x41df36[_0x465dff(0x864)])[_0x465dff(0xd12)](_0x40d4eb=>_0x40d4eb[_0x465dff(0x283)]===_0x91f6d0);if(_0x5cf644){const _0x77a1d4={'content':_0x3dfd18[_0x465dff(0x1cb)](),'timestamp':Date['now'](),'source':_0x465dff(0xe5d)+_0x919828[_0x465dff(0x461)]};if(!_0x5cf644['longTermMemory'])_0x5cf644[_0x465dff(0x1349)]=[];_0x5cf644['longTermMemory']['push'](_0x77a1d4),await _0x342df8[_0x465dff(0x864)][_0x465dff(0x9c0)](_0x5cf644),_0xf36884++;}}}if(_0xf36884>0x0)console[_0x465dff(0xe72)](_0x465dff(0x1372)+_0xf36884+_0x465dff(0x77d));else throw new Error(_0x465dff(0xf5e));}else throw new Error(_0x465dff(0xed9));}else{if(_0x44d31e['summary']&&_0x44d31e[_0x465dff(0xd9b)][_0x465dff(0x1cb)]()){const _0x4d2101={'content':_0x44d31e['summary'][_0x465dff(0x1cb)](),'timestamp':Date[_0x465dff(0x108d)](),'source':_0x465dff(0xa60)};_0x919828[_0x465dff(0x1349)][_0x465dff(0x258)](_0x4d2101),await _0x342df8['chats'][_0x465dff(0x9c0)](_0x919828),console['log'](_0x465dff(0x1069));}else throw new Error('AI返回了空的或格式不正确的总结内容。');}_0x919828['lastMemorySummaryTimestamp']=_0x4dfb6e[_0x465dff(0x1368)](-0x1)[0x0][_0x465dff(0x3b7)],await _0x342df8[_0x465dff(0x864)][_0x465dff(0x9c0)](_0x919828),document[_0x465dff(0x383)]('long-term-memory-screen')[_0x465dff(0x119a)][_0x465dff(0x987)](_0x465dff(0xde5))&&_0x164923();}catch(_0x13437f){console[_0x465dff(0x98)]('总结长期记忆时出错:',_0x13437f),await _0x296ef9(_0x465dff(0x23b),_0x465dff(0xb0d)+_0x13437f['message']);}}function _0xcb69ba(){const _0xfd3408=_0x549949;if(!_0x7c8ee8)return;const _0x397779=_0x41df36[_0xfd3408(0x864)][_0x41df36['activeChatId']],_0x259f7b=_0x397779[_0xfd3408(0xd08)][_0xfd3408(0xd12)](_0xc77220=>_0xc77220['timestamp']===_0x7c8ee8);if(!_0x259f7b)return;let _0x13c0ea;_0x259f7b[_0xfd3408(0x10ff)]===_0xfd3408(0x66e)?_0x13c0ea=_0x397779[_0xfd3408(0x1a2)]?_0x397779[_0xfd3408(0x886)][_0xfd3408(0x52e)]||'我':'我':_0x397779[_0xfd3408(0x1a2)]?_0x13c0ea=_0x54d0ab(_0x397779,_0x259f7b[_0xfd3408(0x4c5)]):_0x13c0ea=_0x397779[_0xfd3408(0x461)];const _0x34872b=String(_0x259f7b[_0xfd3408(0x11b6)]||'');let _0x196b7c='';if(typeof _0x259f7b[_0xfd3408(0x11b6)]===_0xfd3408(0xafa)&&_0x49f222[_0xfd3408(0xd73)](_0x259f7b[_0xfd3408(0x11b6)]))_0x196b7c=_0xfd3408(0x66f);else{if(_0x259f7b['type']===_0xfd3408(0x1050)||_0x259f7b[_0xfd3408(0xa6b)]===_0xfd3408(0xed0))_0x196b7c=_0xfd3408(0x1167);else _0x259f7b[_0xfd3408(0xa6b)]===_0xfd3408(0xa4f)?_0x196b7c=_0xfd3408(0x310):_0x196b7c=_0x34872b[_0xfd3408(0xba5)](0x0,0x32)+(_0x34872b['length']>0x32?_0xfd3408(0x1026):'');}_0x4ddca6={'timestamp':_0x259f7b['timestamp'],'senderName':_0x13c0ea,'content':_0x34872b};const _0x5a984c=document['getElementById'](_0xfd3408(0x1250));_0x5a984c[_0xfd3408(0x89c)](_0xfd3408(0x708))[_0xfd3408(0x138e)]=_0xfd3408(0x72c)+_0x4ddca6[_0xfd3408(0x4c5)]+':',_0x5a984c[_0xfd3408(0x89c)](_0xfd3408(0x13a))['textContent']=_0x196b7c,_0x5a984c[_0xfd3408(0x655)][_0xfd3408(0x2b6)]='block',_0x29d937(),document[_0xfd3408(0x383)](_0xfd3408(0x8ef))[_0xfd3408(0xede)]();}function _0x58fe25(){const _0x480765=_0x549949;_0x4ddca6=null,document[_0x480765(0x383)]('reply-preview-bar')[_0x480765(0x655)][_0x480765(0x2b6)]=_0x480765(0xa70);}let _0x51fd05=null;function _0x65c610(_0x25e2b7){const _0x8ee41a=_0x549949;_0x51fd05=_0x25e2b7;const _0x56ddca=_0x41df36[_0x8ee41a(0x864)][_0x41df36[_0x8ee41a(0xfc5)]],_0x30c633=_0x56ddca['history'][_0x8ee41a(0xd12)](_0x233480=>_0x233480[_0x8ee41a(0x3b7)]===_0x25e2b7);_0x30c633&&(document[_0x8ee41a(0x383)](_0x8ee41a(0x10ba))[_0x8ee41a(0x138e)]=_0x30c633[_0x8ee41a(0x4c5)]),document['getElementById'](_0x8ee41a(0x9ce))[_0x8ee41a(0x119a)][_0x8ee41a(0xbff)]('visible');}function _0x2a7cee(){const _0x27afad=_0x549949;document[_0x27afad(0x383)]('transfer-actions-modal')[_0x27afad(0x119a)]['remove']('visible'),_0x51fd05=null;}async function _0x5a9c8a(_0x55e896){const _0x3c1298=_0x549949;if(!_0x51fd05)return;const _0xc2bc80=_0x51fd05,_0x1d3bec=_0x41df36[_0x3c1298(0x864)][_0x41df36[_0x3c1298(0xfc5)]],_0x365b5f=_0x1d3bec[_0x3c1298(0xd08)][_0x3c1298(0xe37)](_0x28cde9=>_0x28cde9['timestamp']===_0xc2bc80);if(_0x365b5f===-0x1)return;const _0x389e13=_0x1d3bec[_0x3c1298(0xd08)][_0x365b5f];_0x389e13['status']=_0x55e896;let _0xc4cd80;if(_0x55e896===_0x3c1298(0xfd2)){const _0x416277={'role':'user','type':'transfer','isRefund':!![],'amount':_0x389e13['amount'],'note':'已拒收对方转账','timestamp':Date[_0x3c1298(0x108d)]()};_0x1d3bec['history'][_0x3c1298(0x258)](_0x416277),_0xc4cd80=_0x3c1298(0xbfc)+_0x389e13[_0x3c1298(0x4c5)]+'”的转账。]';}else _0xc4cd80='[系统提示：你接受了“'+_0x389e13['senderName']+_0x3c1298(0xd0f);const _0x35da7c={'role':'system','content':_0xc4cd80,'timestamp':Date[_0x3c1298(0x108d)]()+0x1,'isHidden':!![]};_0x1d3bec[_0x3c1298(0xd08)][_0x3c1298(0x258)](_0x35da7c),await _0x342df8[_0x3c1298(0x864)][_0x3c1298(0x9c0)](_0x1d3bec),_0x2a7cee(),_0x409076(_0x41df36[_0x3c1298(0xfc5)]),_0x25558e();}async function _0x1a41ab(){const _0x5e0ab5=_0x549949;_0x105acd('call-history-screen');const _0x56552e=document[_0x5e0ab5(0x383)]('call-history-list'),_0x532823=document[_0x5e0ab5(0x383)](_0x5e0ab5(0x7a8));_0x56552e[_0x5e0ab5(0x45c)]='',_0x532823[_0x5e0ab5(0x138e)]=_0x5e0ab5(0x62c);const _0x261f9e=await _0x342df8['callRecords'][_0x5e0ab5(0x4b1)](_0x5e0ab5(0x3b7))[_0x5e0ab5(0x1087)]()['toArray']();if(_0x261f9e[_0x5e0ab5(0xfde)]===0x0){_0x56552e[_0x5e0ab5(0x45c)]=_0x5e0ab5(0x391);return;}_0x261f9e[_0x5e0ab5(0x19c)](_0x5a5658=>{const _0x4cab19=_0x5e0ab5,_0x590d2e=_0x1011a6(_0x5a5658);_0x3e15d1(_0x590d2e,async()=>{const _0x3f3dc0=_0x42ed,_0x2beeae=await _0x12e332(_0x3f3dc0(0x266),'请输入新的名称（留空则恢复默认）',_0x5a5658[_0x3f3dc0(0x7a1)]||'');if(_0x2beeae===null)return;await _0x342df8[_0x3f3dc0(0xdb9)][_0x3f3dc0(0xaf9)](_0x5a5658['id'],{'customName':_0x2beeae['trim']()}),await _0x1a41ab(),await _0x296ef9('成功',_0x3f3dc0(0xb6b));}),_0x56552e[_0x4cab19(0xe91)](_0x590d2e);});}function _0x1011a6(_0x591f3c){const _0x5dae98=_0x549949,_0x4670aa=document[_0x5dae98(0xe1b)](_0x5dae98(0x7fd));_0x4670aa[_0x5dae98(0x556)]=_0x5dae98(0xb28),_0x4670aa[_0x5dae98(0x118)][_0x5dae98(0x1e0)]=_0x591f3c['id'];const _0x430392=_0x41df36[_0x5dae98(0x864)][_0x591f3c[_0x5dae98(0xa65)]],_0x1abe98=_0x430392?_0x430392[_0x5dae98(0x461)]:_0x5dae98(0x2e8),_0x31fad8=new Date(_0x591f3c[_0x5dae98(0x3b7)]),_0x747d46=_0x31fad8[_0x5dae98(0xdf9)]()+'-'+String(_0x31fad8[_0x5dae98(0xf4f)]()+0x1)[_0x5dae98(0xf20)](0x2,'0')+'-'+String(_0x31fad8[_0x5dae98(0xb29)]())[_0x5dae98(0xf20)](0x2,'0')+'\x20'+String(_0x31fad8['getHours']())[_0x5dae98(0xf20)](0x2,'0')+':'+String(_0x31fad8['getMinutes']())['padStart'](0x2,'0'),_0x271402=Math['floor'](_0x591f3c['duration']/0x3c)+'分'+_0x591f3c[_0x5dae98(0xdf4)]%0x3c+'秒',_0x30f516=_0x591f3c[_0x5dae98(0x9a6)][_0x5dae98(0xa79)](_0x1097a6=>'<img\x20src=\x22'+_0x1097a6[_0x5dae98(0xb47)]+'\x22\x20alt=\x22'+_0x1097a6[_0x5dae98(0x461)]+'\x22\x20class=\x22participant-avatar\x22\x20title=\x22'+_0x1097a6[_0x5dae98(0x461)]+'\x22>')[_0x5dae98(0xa35)]('');return _0x4670aa[_0x5dae98(0x45c)]=_0x5dae98(0xc4)+_0x747d46+_0x5dae98(0x6dc)+_0x271402+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x591f3c[_0x5dae98(0x7a1)]?_0x5dae98(0x9e1)+_0x591f3c['customName']+'</div>':'')+_0x5dae98(0x796)+_0x30f516+_0x5dae98(0x7a9)+_0x1abe98+_0x5dae98(0x83e),_0x4670aa;}async function _0x323913(_0x1b7045){const _0x1102e3=_0x549949,_0x775bce=await _0x342df8[_0x1102e3(0xdb9)][_0x1102e3(0x1a3)](_0x1b7045);if(!_0x775bce)return;const _0x547eb3=document['getElementById'](_0x1102e3(0x64d)),_0x1cb0bc=document[_0x1102e3(0x383)](_0x1102e3(0xdb8)),_0xfd4c4f=document[_0x1102e3(0x383)](_0x1102e3(0x1028));_0x1cb0bc[_0x1102e3(0x138e)]=_0x1102e3(0xab8)+new Date(_0x775bce[_0x1102e3(0x3b7)])['toLocaleString']()+_0x1102e3(0xbf7)+Math[_0x1102e3(0xdee)](_0x775bce['duration']/0x3c)+'分'+_0x775bce['duration']%0x3c+'秒)',_0xfd4c4f[_0x1102e3(0x45c)]='';const _0x25ff51=document[_0x1102e3(0x383)](_0x1102e3(0x93c)),_0x5c2998=document[_0x1102e3(0x383)](_0x1102e3(0xbf));!_0x775bce[_0x1102e3(0x8cd)]||_0x775bce[_0x1102e3(0x8cd)][_0x1102e3(0xfde)]===0x0?(_0xfd4c4f[_0x1102e3(0x45c)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>',_0x5c2998['style']['display']=_0x1102e3(0xa70)):(_0x5c2998[_0x1102e3(0x655)][_0x1102e3(0x2b6)]=_0x1102e3(0x27a),_0x775bce['transcript'][_0x1102e3(0x19c)](_0xb7dae6=>{const _0x2468d0=_0x1102e3,_0xdd72e3=document[_0x2468d0(0xe1b)](_0x2468d0(0x7fd));_0xdd72e3[_0x2468d0(0x556)]='transcript-entry\x20'+_0xb7dae6['role'],_0xdd72e3[_0x2468d0(0x138e)]=_0xb7dae6[_0x2468d0(0x11b6)],_0xfd4c4f[_0x2468d0(0xe91)](_0xdd72e3);}));const _0xdb019a=_0x25ff51['cloneNode'](!![]);_0x25ff51[_0x1102e3(0x1245)]['replaceChild'](_0xdb019a,_0x25ff51);const _0x568fef=_0x5c2998[_0x1102e3(0x117b)](!![]);_0x5c2998[_0x1102e3(0x1245)]['replaceChild'](_0x568fef,_0x5c2998),_0xdb019a[_0x1102e3(0x271)]('click',async()=>{const _0x22a9ab=_0x1102e3,_0x350bbd=await _0x23a88b(_0x22a9ab(0x615),_0x22a9ab(0x434),{'confirmButtonClass':'btn-danger'});_0x350bbd&&(_0x547eb3['classList'][_0x22a9ab(0x131d)]('visible'),await _0x342df8[_0x22a9ab(0xdb9)][_0x22a9ab(0x971)](_0x1b7045),await _0x1a41ab(),alert(_0x22a9ab(0x338)));}),_0x568fef[_0x1102e3(0x271)]('click',async()=>{const _0x15bc09=_0x1102e3,_0x534f01=await _0x23a88b(_0x15bc09(0xca),'这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？',{'confirmText':_0x15bc09(0xf43)});if(!_0x534f01)return;_0x547eb3[_0x15bc09(0x119a)][_0x15bc09(0x131d)]('visible');const _0x42fe96=_0x41df36['chats'][_0x775bce['chatId']];if(!_0x42fe96){alert(_0x15bc09(0xc5a));return;}await _0x296ef9(_0x15bc09(0x4a6),_0x15bc09(0xf66));try{const _0x59b025=_0x775bce['transcript'][_0x15bc09(0xa79)](_0x2ee62a=>{const _0x4edbed=_0x15bc09,_0x358c43=_0x2ee62a['role']===_0x4edbed(0x66e)?_0x42fe96['settings'][_0x4edbed(0x52e)]||'我':_0x2ee62a[_0x4edbed(0x4c5)]||_0x42fe96[_0x4edbed(0x461)];return _0x358c43+':\x20'+_0x2ee62a[_0x4edbed(0x11b6)];})[_0x15bc09(0xa35)]('\x0a');await _0x5ef3b0(_0x775bce[_0x15bc09(0xa65)],_0x59b025),await _0x296ef9('总结成功',_0x15bc09(0x1056)+_0x42fe96[_0x15bc09(0x461)]+_0x15bc09(0x464));}catch(_0x279825){await _0x296ef9(_0x15bc09(0x23b),_0x15bc09(0x23d)+_0x279825[_0x15bc09(0x5f8)]);}});const _0x963fb6=document[_0x1102e3(0x383)]('close-transcript-modal-btn'),_0x53187a=_0x963fb6[_0x1102e3(0x117b)](!![]);_0x963fb6[_0x1102e3(0x1245)][_0x1102e3(0xe58)](_0x53187a,_0x963fb6),_0x53187a[_0x1102e3(0x271)](_0x1102e3(0x5c7),()=>{const _0x57ef4a=_0x1102e3;_0x547eb3[_0x57ef4a(0x119a)]['remove'](_0x57ef4a(0x106d));}),_0x547eb3[_0x1102e3(0x119a)][_0x1102e3(0xbff)](_0x1102e3(0x106d));}async function _0x10d88d(){const _0x57a94e=_0x549949;if(!_0x41df36[_0x57a94e(0xfc5)]||_0x41df36[_0x57a94e(0x864)][_0x41df36['activeChatId']][_0x57a94e(0x1a2)])return;const _0x595ec0=_0x41df36[_0x57a94e(0x864)][_0x41df36[_0x57a94e(0xfc5)]],_0x39f901=await _0x12e332(_0x57a94e(0xa89),_0x57a94e(0xc74),_0x595ec0[_0x57a94e(0x1fe)][_0x57a94e(0x6af)]);_0x39f901!==null&&(_0x595ec0[_0x57a94e(0x1fe)]['text']=_0x39f901[_0x57a94e(0x1cb)]()||'在线',_0x595ec0[_0x57a94e(0x1fe)]['isBusy']=![],_0x595ec0[_0x57a94e(0x1fe)][_0x57a94e(0x6a8)]=Date[_0x57a94e(0x108d)](),await _0x342df8[_0x57a94e(0x864)][_0x57a94e(0x9c0)](_0x595ec0),_0x409076(_0x41df36[_0x57a94e(0xfc5)]),_0x25558e(),await _0x296ef9(_0x57a94e(0xf5),'“'+_0x595ec0[_0x57a94e(0x461)]+_0x57a94e(0x2c7)+_0x595ec0[_0x57a94e(0x1fe)]['text']));}async function _0x47240b(){const _0x50e7b2=_0x549949,_0x621c97=document[_0x50e7b2(0x383)](_0x50e7b2(0x6d5)),_0x32ffe2=document[_0x50e7b2(0x383)](_0x50e7b2(0x715));_0x32ffe2['innerHTML']='';const _0xd95b95=Object[_0x50e7b2(0x76d)](_0x41df36['chats']);_0xd95b95['forEach'](_0x30522b=>{const _0x39e6a8=_0x50e7b2,_0x994ba7=document[_0x39e6a8(0xe1b)](_0x39e6a8(0x7fd));_0x994ba7[_0x39e6a8(0x556)]=_0x39e6a8(0x136c),_0x994ba7[_0x39e6a8(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22'+_0x30522b['id']+_0x39e6a8(0x2e3)+(_0x30522b[_0x39e6a8(0x1a2)]?_0x30522b[_0x39e6a8(0x886)][_0x39e6a8(0x332)]:_0x30522b[_0x39e6a8(0x886)][_0x39e6a8(0x121e)]||_0x5dc108)+_0x39e6a8(0x1040)+_0x30522b[_0x39e6a8(0x461)]+_0x39e6a8(0xea8),_0x32ffe2[_0x39e6a8(0xe91)](_0x994ba7);}),_0x621c97[_0x50e7b2(0x119a)][_0x50e7b2(0xbff)](_0x50e7b2(0x106d));}function _0x345261(_0x4548a7){const _0x127f17=_0x549949,_0x28c4c7=document[_0x127f17(0x383)](_0x127f17(0xdab));if(!_0x28c4c7[_0x127f17(0x119a)]['contains'](_0x127f17(0x106d))){if(_0x4548a7)_0x4548a7();return;}_0x28c4c7[_0x127f17(0x119a)][_0x127f17(0x131d)]('visible'),setTimeout(()=>{const _0x2ae90e=_0x127f17;document['getElementById'](_0x2ae90e(0x5b1))['classList'][_0x2ae90e(0x131d)](_0x2ae90e(0x106d));if(_0x4548a7)_0x4548a7();},0x190);}function _0x2a7b2e(_0x5ae12e){const _0x674aaa=_0x549949;if(!_0x5ae12e)return[];const _0x43d2ed=String(_0x5ae12e)[_0x674aaa(0x105d)](/\r\n?|\n/),_0x33edf5=[],_0x12eca4=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0x3ed93a of _0x43d2ed){const _0x4bb32d=_0x3ed93a[_0x674aaa(0x709)](_0x12eca4,'')[_0x674aaa(0x1cb)]();if(!_0x4bb32d)continue;_0x12eca4[_0x674aaa(0x3aa)]=0x0;let _0x37ba00;while((_0x37ba00=_0x12eca4[_0x674aaa(0x39a)](_0x3ed93a))!==null){const _0x474b34=parseInt(_0x37ba00[0x1],0xa),_0xfdf66=parseInt(_0x37ba00[0x2],0xa),_0x35f946=parseInt(_0x37ba00[0x3][_0x674aaa(0x47d)](0x3,'0'),0xa),_0x3b07ed=_0x474b34*0x3c+_0xfdf66+_0x35f946/0x3e8;_0x33edf5['push']({'time':_0x3b07ed,'text':_0x4bb32d});}}return _0x33edf5[_0x674aaa(0x1296)]((_0x1eccd0,_0x4c3f1c)=>_0x1eccd0['time']-_0x4c3f1c[_0x674aaa(0x1c8)]);}function _0x234ea1(){const _0x40861c=_0x549949,_0x53340d=document['getElementById'](_0x40861c(0xb53));_0x53340d[_0x40861c(0x45c)]='';if(!_0x40e606['parsedLyrics']||_0x40e606[_0x40861c(0x6ed)][_0x40861c(0xfde)]===0x0){_0x53340d[_0x40861c(0x45c)]=_0x40861c(0x552);return;}_0x40e606[_0x40861c(0x6ed)][_0x40861c(0x19c)]((_0x35626b,_0x25e237)=>{const _0x11b236=_0x40861c,_0xc7c323=document[_0x11b236(0xe1b)]('div');_0xc7c323[_0x11b236(0x556)]=_0x11b236(0x12d0),_0xc7c323['textContent']=_0x35626b[_0x11b236(0x6af)],_0xc7c323['dataset'][_0x11b236(0x1297)]=_0x25e237,_0x53340d['appendChild'](_0xc7c323);}),_0x53340d[_0x40861c(0x655)][_0x40861c(0x923)]=_0x40861c(0x549);}function _0xd3fe60(_0x22d9eb){const _0x3f59e4=_0x549949;if(_0x40e606[_0x3f59e4(0x6ed)]['length']===0x0)return;let _0x1c681d=-0x1;for(let _0x1227a9=0x0;_0x1227a9<_0x40e606['parsedLyrics'][_0x3f59e4(0xfde)];_0x1227a9++){if(_0x22d9eb>=_0x40e606['parsedLyrics'][_0x1227a9]['time'])_0x1c681d=_0x1227a9;else break;}if(_0x1c681d===_0x40e606[_0x3f59e4(0x1025)])return;_0x40e606['currentLyricIndex']=_0x1c681d,_0x4b003f();const _0xa70b3e=document['getElementById'](_0x3f59e4(0x1005));_0xa70b3e&&(_0x1c681d>-0x1&&_0x40e606[_0x3f59e4(0x6ed)][_0x1c681d]?_0xa70b3e['textContent']=_0x40e606[_0x3f59e4(0x6ed)][_0x1c681d][_0x3f59e4(0x6af)]:_0xa70b3e[_0x3f59e4(0x138e)]=_0x3f59e4(0xafd));const _0x1bb0e0=document[_0x3f59e4(0x383)](_0x3f59e4(0x61c));_0x1bb0e0[_0x3f59e4(0x119a)]['contains'](_0x3f59e4(0x106d))&&(_0x1c681d>-0x1&&_0x40e606[_0x3f59e4(0x6ed)][_0x1c681d]?_0x1bb0e0[_0x3f59e4(0x138e)]=_0x40e606[_0x3f59e4(0x6ed)][_0x1c681d][_0x3f59e4(0x6af)]:_0x1bb0e0[_0x3f59e4(0x138e)]='♪');}function _0x4b003f(_0x3d9b13=![]){const _0x2772b5=_0x549949,_0x85695e=_0x3d9b13?_0x2772b5(0x75b):_0x2772b5(0x6fe),_0x4412e9=_0x3d9b13?_0x2772b5(0x494):'#music-lyrics-container',_0x3494ea=document[_0x2772b5(0x89c)](_0x85695e),_0x37fc3d=document[_0x2772b5(0x89c)](_0x4412e9);if(!_0x3494ea||!_0x37fc3d)return;const _0x2bd893=_0x3494ea[_0x2772b5(0x400)](_0x2772b5(0x4cc));_0x2bd893['forEach'](_0x31e6f6=>_0x31e6f6[_0x2772b5(0x119a)][_0x2772b5(0x131d)]('active'));if(_0x40e606['currentLyricIndex']===-0x1){_0x3494ea['style']['transform']=_0x2772b5(0x549);return;}const _0x300078=_0x3494ea[_0x2772b5(0x89c)](_0x2772b5(0x116f)+_0x40e606[_0x2772b5(0x1025)]+'\x22]');if(_0x300078){_0x300078['classList'][_0x2772b5(0xbff)](_0x2772b5(0xde5));const _0x470102=_0x37fc3d['offsetHeight'],_0x4f005e=_0x470102/2.2-_0x300078[_0x2772b5(0x511)]-_0x300078['offsetHeight']/0x2;_0x3494ea['style'][_0x2772b5(0x923)]=_0x2772b5(0x1187)+_0x4f005e+_0x2772b5(0xc00);}}function _0x353939(_0x3ade98){const _0x161e94=_0x549949;if(isNaN(_0x3ade98)||_0x3ade98<0x0)return _0x161e94(0xc26);const _0x33a855=Math[_0x161e94(0xdee)](_0x3ade98/0x3c),_0x299c2a=Math[_0x161e94(0xdee)](_0x3ade98%0x3c);return _0x33a855+':'+String(_0x299c2a)['padStart'](0x2,'0');}let _0x38c445=0x0,_0x1466db;function _0x5ce764(){_0x1466db&&cancelAnimationFrame(_0x1466db);function _0x3a74cd(){const _0x21f8de=_0x42ed;if(!_0x40e606['isPlaying']||!_0x17f24d[_0x21f8de(0xdf4)])return;const _0x1bc183=performance[_0x21f8de(0x108d)](),_0x33231d=_0x17f24d[_0x21f8de(0x60f)],_0x4f85ae=_0x17f24d[_0x21f8de(0xdf4)],_0x30c6a3=_0x33231d/_0x4f85ae*0x64;document[_0x21f8de(0x383)]('music-progress-fill')[_0x21f8de(0x655)]['width']=_0x30c6a3+'%',_0x1bc183-_0x38c445>0x3e8&&(document[_0x21f8de(0x383)]('music-current-time')[_0x21f8de(0x138e)]=_0x353939(_0x33231d),document[_0x21f8de(0x383)]('music-total-time')['textContent']=_0x353939(_0x4f85ae),_0x38c445=_0x1bc183),_0xd3fe60(_0x33231d),_0x1466db=requestAnimationFrame(_0x3a74cd);}_0x1466db=requestAnimationFrame(_0x3a74cd);}function _0x58b49b(){const _0xd2529c=_0x549949;if(!lastRawAiResponse){alert(_0xd2529c(0xd39));return;}const _0x2f0080=document[_0xd2529c(0x383)](_0xd2529c(0xa73)),_0x71d97f=document[_0xd2529c(0x383)](_0xd2529c(0x254));_0x71d97f[_0xd2529c(0x45c)]='';const _0x43ef56=lastRawAiResponse[_0xd2529c(0x22e)](/{[^{}]*}/g);if(_0x43ef56)_0x43ef56[_0xd2529c(0x19c)](_0x3467e2=>{const _0x5afb03=_0xd2529c;try{const _0xd00b78=JSON[_0x5afb03(0x134)](_0x3467e2),_0x2ce777=JSON['stringify'](_0xd00b78,null,0x2),_0x580a6d=_0x29685e(_0x2ce777);_0x71d97f['appendChild'](_0x580a6d);}catch(_0x413cf2){const _0x1b1a1a=_0x29685e(_0x3467e2);_0x71d97f['appendChild'](_0x1b1a1a),console[_0x5afb03(0x17b)](_0x5afb03(0xc58),_0x3467e2);}});else{const _0x399477=_0x29685e(lastRawAiResponse);_0x71d97f[_0xd2529c(0xe91)](_0x399477);}_0x2f0080[_0xd2529c(0x119a)][_0xd2529c(0xbff)](_0xd2529c(0x106d));}function _0x29685e(_0x4aed35=''){const _0x13c8e4=_0x549949,_0x395dd7=document[_0x13c8e4(0xe1b)](_0x13c8e4(0x7fd));_0x395dd7[_0x13c8e4(0x556)]=_0x13c8e4(0x139e);const _0x4644d3={'text':{'type':_0x13c8e4(0x6af),'content':'在这里输入文本...'},'sticker':{'type':'sticker','url':_0x13c8e4(0xfad),'meaning':_0x13c8e4(0x3a5)},'image':{'type':_0x13c8e4(0x1050),'description':'在这里输入图片描述...'},'voice':{'type':_0x13c8e4(0xa4f),'content':_0x13c8e4(0x729)},'transfer':{'type':_0x13c8e4(0x909),'amount':5.2,'note':_0x13c8e4(0x11f5)},'offline':{'type':_0x13c8e4(0x44e),'content':_0x13c8e4(0x9e8)},'quote':{'type':_0x13c8e4(0x1038),'target_timestamp':0x499602d2,'reply_content':'在这里输入回复内容'}};return _0x395dd7[_0x13c8e4(0x45c)]=_0x13c8e4(0xc0a)+_0x4aed35+_0x13c8e4(0x468)+JSON['stringify'](_0x4644d3[_0x13c8e4(0x6af)])+'\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x13c8e4(0x3fb)](_0x4644d3['sticker'])+_0x13c8e4(0xe4c)+JSON[_0x13c8e4(0x3fb)](_0x4644d3['image'])+_0x13c8e4(0x9ec)+JSON[_0x13c8e4(0x3fb)](_0x4644d3[_0x13c8e4(0xcfd)])+'\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x4644d3[_0x13c8e4(0x909)])+_0x13c8e4(0x11f9)+JSON[_0x13c8e4(0x3fb)](_0x4644d3[_0x13c8e4(0x46c)])+_0x13c8e4(0x983)+JSON[_0x13c8e4(0x3fb)](_0x4644d3[_0x13c8e4(0x8ff)])+_0x13c8e4(0xb4f),_0x395dd7[_0x13c8e4(0x89c)](_0x13c8e4(0x11c4))[_0x13c8e4(0x271)]('click',()=>{_0x395dd7['remove']();}),_0x395dd7['querySelectorAll']('.format-btn')['forEach'](_0xfa7547=>{const _0x3ea31e=_0x13c8e4;_0xfa7547[_0x3ea31e(0x271)](_0x3ea31e(0x5c7),()=>{const _0x476af4=_0x3ea31e,_0x16da67=_0xfa7547[_0x476af4(0x118)][_0x476af4(0xd7b)],_0xa86970=_0x395dd7[_0x476af4(0x89c)](_0x476af4(0xfe5));if(_0x16da67&&_0xa86970)try{const _0x2d0e24=JSON[_0x476af4(0x134)](_0x16da67);_0xa86970[_0x476af4(0x1be)]=JSON[_0x476af4(0x3fb)](_0x2d0e24,null,0x2),_0xa86970[_0x476af4(0xede)]();}catch(_0x30f4d7){console[_0x476af4(0x98)](_0x476af4(0xd6),_0x30f4d7);}});}),_0x395dd7;}async function _0x4eefc7(){const _0x469485=_0x549949,_0x20820a=_0x41df36[_0x469485(0x864)][_0x41df36[_0x469485(0xfc5)]];if(!_0x20820a)return;const _0x4f394a=document[_0x469485(0x383)]('ai-response-editor-container'),_0x52200b=_0x4f394a[_0x469485(0x400)]('textarea'),_0x2d761f=Array['from'](_0x52200b)[_0x469485(0xa79)](_0x52eb61=>_0x52eb61[_0x469485(0x1be)][_0x469485(0x1cb)]())['filter'](Boolean);if(_0x2d761f[_0x469485(0xfde)]===0x0){_0x20820a['history']=_0x20820a['history'][_0x469485(0x98a)](_0x2358c2=>!lastResponseTimestamps[_0x469485(0xee2)](_0x2358c2[_0x469485(0x3b7)])),await _0x342df8[_0x469485(0x864)]['put'](_0x20820a),_0x409076(_0x41df36[_0x469485(0xfc5)]),_0x25558e(),document[_0x469485(0x383)](_0x469485(0xa73))['classList'][_0x469485(0x131d)]('visible'),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0x372ad4=[];for(const _0x1115b5 of _0x2d761f){try{const _0x53f98c=JSON['parse'](_0x1115b5);_0x372ad4[_0x469485(0x258)](_0x53f98c);}catch(_0x1162a4){console['warn'](_0x469485(0x9f2),_0x1115b5);}}_0x20820a[_0x469485(0xd08)]=_0x20820a[_0x469485(0xd08)]['filter'](_0x1c7b2e=>!lastResponseTimestamps['includes'](_0x1c7b2e[_0x469485(0x3b7)]));let _0x1ca690=[],_0x5be709=Date[_0x469485(0x108d)]();for(const _0x400e91 of _0x372ad4){if(!_0x400e91||typeof _0x400e91!==_0x469485(0x890)||!_0x400e91['type']){console[_0x469485(0x17b)](_0x469485(0x256),_0x400e91);continue;}let _0x52ea65=null;const _0x1cff3c={'role':_0x469485(0xf3c),'senderName':_0x400e91[_0x469485(0x461)]||_0x20820a[_0x469485(0x283)],'timestamp':_0x5be709++};switch(_0x400e91[_0x469485(0xa6b)]){case'text':_0x52ea65={..._0x1cff3c,'content':String(_0x400e91[_0x469485(0x11b6)]||_0x400e91[_0x469485(0x5f8)])};break;case _0x469485(0x37d):{let _0x5bb3b2=![];if(_0x400e91['url']&&_0x400e91['meaning'])_0x52ea65={..._0x1cff3c,'type':_0x469485(0x37d),'content':_0x400e91[_0x469485(0x2fa)],'meaning':_0x400e91[_0x469485(0x7de)]},console[_0x469485(0xe72)](_0x469485(0xa37)),_0x5bb3b2=!![];else{if(_0x400e91[_0x469485(0x7de)]){const _0x4aaeec=_0x41df36['userStickers']['find'](_0x5be2d2=>_0x5be2d2[_0x469485(0x461)]===_0x400e91[_0x469485(0x7de)]);_0x4aaeec?(_0x52ea65={..._0x1cff3c,'type':_0x469485(0x37d),'content':_0x4aaeec[_0x469485(0x2fa)],'meaning':_0x4aaeec[_0x469485(0x461)]},console[_0x469485(0xe72)](_0x469485(0x6ef)),_0x5bb3b2=!![]):(_0x52ea65={..._0x1cff3c,'type':_0x469485(0x6af),'content':_0x469485(0x261)+_0x400e91[_0x469485(0x7de)]+']'},console['warn'](_0x469485(0xa6e),_0x400e91[_0x469485(0x7de)]),_0x5bb3b2=!![]);}else{if(_0x400e91['url']){_0x52ea65={..._0x1cff3c,'type':_0x469485(0x37d),'content':_0x400e91[_0x469485(0x2fa)]};const _0x3b4284=_0x41df36['userStickers'][_0x469485(0xd12)](_0x4c4d73=>_0x4c4d73[_0x469485(0x2fa)]===_0x400e91[_0x469485(0x2fa)]);_0x52ea65[_0x469485(0x7de)]=_0x3b4284?_0x3b4284[_0x469485(0x461)]:_0x469485(0x2a8),console[_0x469485(0xe72)](_0x469485(0x653),_0x52ea65[_0x469485(0x7de)]),_0x5bb3b2=!![];}else{if(_0x400e91[_0x469485(0x11b6)]&&typeof _0x400e91[_0x469485(0x11b6)]===_0x469485(0xafa)&&_0x49f222[_0x469485(0xd73)](_0x400e91['content'])){_0x52ea65={..._0x1cff3c,'type':_0x469485(0x37d),'content':_0x400e91[_0x469485(0x11b6)]};const _0x581aff=_0x41df36['userStickers'][_0x469485(0xd12)](_0x3fc5e2=>_0x3fc5e2['url']===_0x400e91[_0x469485(0x11b6)]);_0x52ea65[_0x469485(0x7de)]=_0x581aff?_0x581aff[_0x469485(0x461)]:_0x469485(0x2a8),console[_0x469485(0xe72)]('导演模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:',_0x52ea65[_0x469485(0x7de)]),_0x5bb3b2=!![];}}}}if(!_0x5bb3b2){console[_0x469485(0x98)](_0x469485(0xd3c),_0x400e91);continue;}break;}case _0x469485(0x1050):_0x52ea65={..._0x1cff3c,'type':_0x469485(0x1050),'content':_0x400e91[_0x469485(0xee1)]};break;case _0x469485(0xa4f):_0x52ea65={..._0x1cff3c,'type':_0x469485(0xa4f),'content':_0x400e91[_0x469485(0x11b6)]};break;case'transfer':_0x52ea65={..._0x1cff3c,'type':'transfer','amount':_0x400e91[_0x469485(0xe27)],'note':_0x400e91['note'],'receiverName':_0x400e91[_0x469485(0x79b)]||'我'};break;case _0x469485(0x990):_0x52ea65={..._0x1cff3c,'type':'waimai_request','productInfo':_0x400e91[_0x469485(0x12b1)],'amount':_0x400e91[_0x469485(0xe27)],'status':_0x469485(0x1ad),'countdownEndTime':Date['now']()+0xf*0x3c*0x3e8};break;case _0x469485(0x44e):_0x52ea65={..._0x1cff3c,..._0x400e91};break;case _0x469485(0xfbb):{const _0x4bdeaa=_0x35c099[_0x20820a['id']];if(_0x4bdeaa){const _0x1a28bc=_0x4bdeaa[_0x469485(0xd08)][_0x469485(0xdef)](_0x3b0a90=>_0x3b0a90[_0x469485(0x6fc)]===0x2);if(_0x1a28bc>-0x1){const _0x529a4e=_0x4bdeaa[_0x469485(0xd08)][_0x1a28bc];_0x4bdeaa[_0x469485(0x95a)][_0x529a4e['y']][_0x529a4e['x']]=0x0,_0x4bdeaa[_0x469485(0xd08)][_0x469485(0x2f1)](_0x1a28bc,0x1),console[_0x469485(0xe72)]('导演模式悔棋：已撤销AI在\x20('+_0x529a4e['x']+',\x20'+_0x529a4e['y']+_0x469485(0xdd1));}}const _0x380f21=parseInt(_0x400e91['x']),_0x4c3a58=parseInt(_0x400e91['y']);!isNaN(_0x380f21)&&!isNaN(_0x4c3a58)?_0x1d7b9({'x':_0x380f21,'y':_0x4c3a58},!![]):console['warn'](_0x469485(0x1241),_0x400e91);continue;}case _0x469485(0xf0b):{if(!_0x20820a['isGroup']){_0x400e91[_0x469485(0x2a6)]&&(_0x20820a[_0x469485(0xa52)]=String(_0x400e91[_0x469485(0x2a6)]));_0x400e91['random_jottings']&&(_0x20820a[_0x469485(0xc2b)]=String(_0x400e91[_0x469485(0xf25)]));!Array[_0x469485(0x565)](_0x20820a[_0x469485(0x4f8)])&&(_0x20820a[_0x469485(0x4f8)]=[]);_0x20820a[_0x469485(0x4f8)][_0x469485(0x258)]({'heartfeltVoice':_0x20820a[_0x469485(0xa52)],'randomJottings':_0x20820a[_0x469485(0xc2b)],'timestamp':Date[_0x469485(0x108d)]()});_0x20820a[_0x469485(0x4f8)][_0x469485(0xfde)]>0x32&&_0x20820a['thoughtsHistory'][_0x469485(0x870)]();const _0x1f6669='[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20'+_0x20820a[_0x469485(0xa52)]+_0x469485(0x84c)+_0x20820a['randomJottings'],_0x235ad2={'role':_0x469485(0xb1),'content':_0x1f6669,'timestamp':Date[_0x469485(0x108d)](),'isHidden':!![]};}continue;}case _0x469485(0x1038):{const _0x41ce07=_0x20820a[_0x469485(0xd08)][_0x469485(0xd12)](_0x35f0b6=>_0x35f0b6['timestamp']===_0x400e91[_0x469485(0x17d)]);let _0x309d5c=null;if(_0x41ce07){let _0xf8a9d6=_0x41ce07[_0x469485(0x4c5)];_0x41ce07[_0x469485(0x10ff)]==='user'&&(_0xf8a9d6=_0x20820a[_0x469485(0x1a2)]?_0x20820a['settings'][_0x469485(0x52e)]||'我':_0x41df36[_0x469485(0x571)][_0x469485(0xabb)]||_0x469485(0x7da)),_0x309d5c={'timestamp':_0x400e91[_0x469485(0x17d)],'senderName':_0xf8a9d6,'content':String(_0x41ce07[_0x469485(0x11b6)]||'')};}else _0x309d5c={'timestamp':_0x400e91[_0x469485(0x17d)],'senderName':_0x469485(0x260),'content':_0x469485(0x5a3)};_0x52ea65={..._0x1cff3c,'content':_0x400e91[_0x469485(0x5a6)],'quote':_0x309d5c};break;}default:console[_0x469485(0x17b)](_0x469485(0x291),_0x400e91[_0x469485(0xa6b)]);break;}_0x52ea65&&(_0x20820a['history'][_0x469485(0x258)](_0x52ea65),_0x1ca690[_0x469485(0x258)](_0x52ea65[_0x469485(0x3b7)]));}await _0x342df8['chats'][_0x469485(0x9c0)](_0x20820a),_0x409076(_0x41df36[_0x469485(0xfc5)]),_0x25558e(),document[_0x469485(0x383)](_0x469485(0xa73))['classList'][_0x469485(0x131d)](_0x469485(0x106d)),lastRawAiResponse=_0x2d761f[_0x469485(0xa35)]('\x0a\x0a'),lastResponseTimestamps=_0x1ca690,await _0x296ef9(_0x469485(0x7df),_0x469485(0x77b));}async function _0x410987(){const _0x2cf329=_0x549949;if(!_0x7c8ee8)return;const _0x365958=0x2*0x3c*0x3e8,_0x41623b=_0x7c8ee8,_0xa5cd09=Date[_0x2cf329(0x108d)]();if(_0xa5cd09-_0x41623b>_0x365958){_0x29d937(),await _0x296ef9('操作失败',_0x2cf329(0x1340));return;}await _0x137dc9(_0x41623b,!![]),_0x29d937();}async function _0x137dc9(_0x53a172,_0x585762){const _0x59239c=_0x549949,_0x1bb592=_0x41df36['chats'][_0x41df36['activeChatId']];if(!_0x1bb592)return;const _0x2a031e=_0x1bb592[_0x59239c(0xd08)]['findIndex'](_0x10ffb5=>_0x10ffb5[_0x59239c(0x3b7)]===_0x53a172);if(_0x2a031e===-0x1)return;const _0x3e1075=_0x1bb592[_0x59239c(0xd08)][_0x2a031e],_0x3a4156={'originalType':_0x3e1075['type']||'text','originalContent':_0x3e1075[_0x59239c(0x11b6)],'originalMeaning':_0x3e1075[_0x59239c(0x7de)],'originalQuote':_0x3e1075['quote']};_0x3e1075[_0x59239c(0xa6b)]=_0x59239c(0x1e8),_0x3e1075['content']=_0x585762?_0x59239c(0xfb9):_0x59239c(0xfff),_0x3e1075[_0x59239c(0x5dd)]=_0x3a4156,delete _0x3e1075[_0x59239c(0x7de)],delete _0x3e1075['quote'];if(_0x585762){const _0x229faf=_0x1bb592[_0x59239c(0x1a2)]?_0x1bb592['settings'][_0x59239c(0x52e)]||'我':'我';let _0x45262d='';if(_0x3a4156['originalType']===_0x59239c(0x37d))_0x45262d=_0x59239c(0x3c8)+(_0x3a4156[_0x59239c(0x67c)]||'未知')+']';else _0x3a4156[_0x59239c(0x18b)]==='ai_image'||_0x3a4156[_0x59239c(0x18b)]==='user_photo'?_0x45262d=_0x59239c(0x1ff)+_0x3a4156[_0x59239c(0xf2e)]+']':_0x45262d='“'+String(_0x3a4156[_0x59239c(0xf2e)])+'”';const _0x3f3acc={'role':'system','content':_0x59239c(0x7c6)+_0x229faf+_0x59239c(0x12a7)+_0x45262d+_0x59239c(0xd72),'timestamp':Date[_0x59239c(0x108d)](),'isHidden':!![]};_0x1bb592[_0x59239c(0xd08)][_0x59239c(0x258)](_0x3f3acc);}await _0x342df8[_0x59239c(0x864)][_0x59239c(0x9c0)](_0x1bb592),_0x409076(_0x41df36[_0x59239c(0xfc5)]),_0x585762&&(_0x25558e(),_0x11e743());}async function _0x5daa0c(){const _0x55ad7a=_0x549949;await _0x5074fa(),document[_0x55ad7a(0x383)](_0x55ad7a(0x874))[_0x55ad7a(0x119a)][_0x55ad7a(0xbff)]('visible');}async function _0x5074fa(){const _0x200494=_0x549949,_0x4b709e=document['getElementById'](_0x200494(0x120b)),_0x20a0b2=await _0x342df8[_0x200494(0xa1c)][_0x200494(0x21f)]();_0x4b709e[_0x200494(0x45c)]='',_0x20a0b2[_0x200494(0xfde)]===0x0&&(_0x4b709e['innerHTML']=_0x200494(0xed6)),_0x20a0b2['forEach'](_0x2c964e=>{const _0xeb6138=_0x200494,_0x26c47b=document[_0xeb6138(0xe1b)](_0xeb6138(0x7fd));_0x26c47b[_0xeb6138(0x556)]=_0xeb6138(0x7c0),_0x26c47b[_0xeb6138(0x45c)]=_0xeb6138(0xeee)+_0x2c964e[_0xeb6138(0x461)]+_0xeb6138(0x689)+_0x2c964e['id']+_0xeb6138(0xd98),_0x4b709e[_0xeb6138(0xe91)](_0x26c47b);});}async function _0x411bf9(){const _0x403177=_0x549949,_0x440153=document[_0x403177(0x383)](_0x403177(0xec2)),_0x559653=_0x440153['value']['trim']();if(!_0x559653){alert(_0x403177(0x536));return;}const _0x3a66f5=await _0x342df8['worldBookCategories']['where']('name')['equals'](_0x559653)['first']();if(_0x3a66f5){alert(_0x403177(0xf1b)+_0x559653+'\x22\x20已经存在了！');return;}await _0x342df8[_0x403177(0xa1c)][_0x403177(0xbff)]({'name':_0x559653}),_0x440153[_0x403177(0x1be)]='',await _0x5074fa();}async function _0x202adb(_0x4cf199){const _0x5c4f30=_0x549949,_0x3dc50a=await _0x23a88b(_0x5c4f30(0x615),_0x5c4f30(0xf6),{'confirmButtonClass':_0x5c4f30(0x51b)});if(_0x3dc50a){await _0x342df8[_0x5c4f30(0xa1c)][_0x5c4f30(0x971)](_0x4cf199);const _0x2a13c7=await _0x342df8[_0x5c4f30(0xf17)][_0x5c4f30(0x6bd)](_0x5c4f30(0xba3))[_0x5c4f30(0x5b3)](_0x4cf199)[_0x5c4f30(0x21f)]();for(const _0x45b7de of _0x2a13c7){_0x45b7de[_0x5c4f30(0xba3)]=null,await _0x342df8['worldBooks'][_0x5c4f30(0x9c0)](_0x45b7de);const _0x3d9354=_0x41df36['worldBooks'][_0x5c4f30(0xd12)](_0x51e57e=>_0x51e57e['id']===_0x45b7de['id']);if(_0x3d9354)_0x3d9354[_0x5c4f30(0xba3)]=null;}await _0x5074fa();}}async function _0x28df0d(){const _0x285029=_0x549949;if(!_0x7c8ee8)return;const _0x3510d7=_0x7c8ee8;_0x29d937();const _0x32c487=_0x41df36[_0x285029(0x864)][_0x41df36[_0x285029(0xfc5)]],_0x219069=_0x32c487[_0x285029(0xd08)]['find'](_0x221349=>_0x221349['timestamp']===_0x3510d7);if(!_0x219069)return;let _0x2847d8=String(_0x219069[_0x285029(0x11b6)]||'')[_0x285029(0xba5)](0x0,0x32)+_0x285029(0x1026);if(_0x219069[_0x285029(0xa6b)]===_0x285029(0x1050))_0x2847d8='[图片]\x20'+_0x2847d8;const _0xa10457=await _0x23a88b('发布公告',_0x285029(0x56c)+_0x2847d8+'”',{'confirmText':_0x285029(0x11cd)});if(_0xa10457){const _0x2eb778=_0x32c487[_0x285029(0x886)]['myNickname']||'我';!Array[_0x285029(0x565)](_0x32c487[_0x285029(0xd3f)])&&(_0x32c487[_0x285029(0xd3f)]=[]);const _0x2e70f2={'id':'anno_'+Date[_0x285029(0x108d)](),'messageTimestamp':_0x3510d7,'publisher':_0x2eb778,'publishedAt':Date[_0x285029(0x108d)](),'isPinned':![]};_0x32c487['announcements'][_0x285029(0x258)](_0x2e70f2);const _0x549f5b={'role':_0x285029(0xb1),'type':_0x285029(0xed8),'content':_0x2eb778+_0x285029(0x830),'timestamp':Date[_0x285029(0x108d)]()};_0x32c487[_0x285029(0xd08)][_0x285029(0x258)](_0x549f5b),await _0x342df8[_0x285029(0x864)][_0x285029(0x9c0)](_0x32c487),_0x323467(_0x549f5b,_0x32c487),_0x25558e(),await _0x296ef9('成功',_0x285029(0x66a));}}async function _0x49940a(){const _0x16b9a0=_0x549949,_0x377c9f=_0x41df36[_0x16b9a0(0x864)][_0x41df36[_0x16b9a0(0xfc5)]],_0x3cd1a4=_0x377c9f['announcements']||[];if(!_0x377c9f||_0x3cd1a4[_0x16b9a0(0xfde)]===0x0){_0x296ef9('提示',_0x16b9a0(0x5d7));return;}const _0x3c888c=document[_0x16b9a0(0x383)]('announcement-board-content');_0x3c888c[_0x16b9a0(0x45c)]='',_0x3cd1a4['sort']((_0x435a0a,_0x4bcf19)=>(_0x4bcf19[_0x16b9a0(0x521)]?0x1:0x0)-(_0x435a0a['isPinned']?0x1:0x0));for(const _0x1fbe2b of _0x3cd1a4){const _0x20720f=_0x377c9f[_0x16b9a0(0xd08)][_0x16b9a0(0xd12)](_0x2c4e6b=>_0x2c4e6b[_0x16b9a0(0x3b7)]===_0x1fbe2b[_0x16b9a0(0x215)]),_0x4f12c0=document[_0x16b9a0(0xe1b)]('div');_0x4f12c0[_0x16b9a0(0x556)]=_0x16b9a0(0xf8d);if(_0x20720f){const _0x5d7255=await _0x152d98(_0x20720f,_0x377c9f);_0x5d7255&&_0x4f12c0[_0x16b9a0(0xe91)](_0x5d7255);}else _0x4f12c0[_0x16b9a0(0x45c)]=_0x16b9a0(0x34c);_0x1fbe2b[_0x16b9a0(0x521)]&&(_0x4f12c0['innerHTML']+='<div\x20class=\x22pinned-indicator\x22>📌</div>'),_0x4f12c0[_0x16b9a0(0x45c)]+=_0x16b9a0(0xc23)+_0x1fbe2b['id']+'\x22>...</div>',_0x3c888c[_0x16b9a0(0xe91)](_0x4f12c0);}document[_0x16b9a0(0x383)](_0x16b9a0(0xd49))[_0x16b9a0(0x119a)][_0x16b9a0(0xbff)](_0x16b9a0(0x106d));}let _0xb1a86f=null;function _0x1fd2aa(_0x5dcc5f){const _0x55a308=_0x549949;_0xb1a86f=_0x5dcc5f;const _0x265534=_0x41df36[_0x55a308(0x864)][_0x41df36['activeChatId']],_0x4bebfa=_0x265534['announcements'][_0x55a308(0xd12)](_0x2832cc=>_0x2832cc['id']===_0x5dcc5f);if(!_0x4bebfa)return;const _0x3fb5b1=document[_0x55a308(0x383)]('announcement-action-pin');_0x3fb5b1['textContent']=_0x4bebfa[_0x55a308(0x521)]?_0x55a308(0x10e2):_0x55a308(0x4cf),document['getElementById']('announcement-actions-modal')['classList'][_0x55a308(0xbff)](_0x55a308(0x106d));}async function _0x1f913c(){const _0x4ab0b1=_0x549949;if(!_0xb1a86f)return;const _0x2a46dd=_0x41df36[_0x4ab0b1(0x864)][_0x41df36[_0x4ab0b1(0xfc5)]],_0xfc2373=_0x2a46dd['announcements']['find'](_0x3b254b=>_0x3b254b['id']===_0xb1a86f);_0xfc2373&&(_0xfc2373[_0x4ab0b1(0x521)]=!_0xfc2373['isPinned'],await _0x342df8[_0x4ab0b1(0x864)][_0x4ab0b1(0x9c0)](_0x2a46dd),_0x49940a()),document[_0x4ab0b1(0x383)](_0x4ab0b1(0x12db))['classList'][_0x4ab0b1(0x131d)](_0x4ab0b1(0x106d));}async function _0x26996c(){const _0x1e81c5=_0x549949;if(!_0xb1a86f)return;const _0x4e7975=await _0x23a88b(_0x1e81c5(0x615),_0x1e81c5(0xb61),{'confirmButtonClass':_0x1e81c5(0x51b)});if(_0x4e7975){const _0x5c60d5=_0x41df36['chats'][_0x41df36[_0x1e81c5(0xfc5)]];_0x5c60d5[_0x1e81c5(0xd3f)]=_0x5c60d5[_0x1e81c5(0xd3f)]['filter'](_0x848a56=>_0x848a56['id']!==_0xb1a86f),await _0x342df8['chats'][_0x1e81c5(0x9c0)](_0x5c60d5),_0x49940a();}document['getElementById']('announcement-actions-modal')[_0x1e81c5(0x119a)]['remove'](_0x1e81c5(0x106d));}let _0x232685=![],_0x36ab47={'ai':null,'my':null};function _0x5cbf41(_0x5631c6=_0x549949(0x135e)){const _0x46822c=_0x549949,_0x5cdf0e=document[_0x46822c(0x383)](_0x46822c(0x10d4));if(!_0x41df36[_0x46822c(0xfc5)])return;const _0x4e7653=_0x41df36['chats'][_0x41df36[_0x46822c(0xfc5)]];_0x232685=_0x5631c6===_0x46822c(0xbb6);if(_0x232685){const _0x41c4f8=_0x4e7653['members'][_0x46822c(0xd12)](_0x5e7a8f=>_0x5e7a8f['id']===_0x5f3c03);if(!_0x41c4f8)return;_0x36ab47['my']=_0x41c4f8[_0x46822c(0xefe)]||'',_0x31ee60(!![],_0x41c4f8[_0x46822c(0xb47)],_0x41c4f8['avatarFrame']);}else _0x36ab47['ai']=_0x4e7653[_0x46822c(0x886)][_0x46822c(0x957)]||'',_0x36ab47['my']=_0x4e7653[_0x46822c(0x886)][_0x46822c(0x519)]||'',_0x31ee60(![]);_0x5cdf0e[_0x46822c(0x119a)]['add'](_0x46822c(0x106d));}function _0x31ee60(_0x5a24f4=![],_0x119165=null,_0x49317c=null){const _0xeb0647=_0x549949,_0x3cbce1=document[_0xeb0647(0x383)]('ai-frame-grid'),_0x434d29=document[_0xeb0647(0x383)]('my-frame-grid'),_0x1cdae0=_0x41df36['chats'][_0x41df36['activeChatId']];_0x3cbce1[_0xeb0647(0x45c)]='',_0x434d29[_0xeb0647(0x45c)]='',document[_0xeb0647(0x89c)](_0xeb0647(0x4b3))[_0xeb0647(0x655)][_0xeb0647(0x2b6)]=_0x5a24f4?'none':_0xeb0647(0x2aa),document[_0xeb0647(0x383)](_0xeb0647(0x5cc))[_0xeb0647(0x655)]['display']=_0xeb0647(0x27a),document[_0xeb0647(0x383)](_0xeb0647(0x10b8))[_0xeb0647(0x655)]['display']=_0xeb0647(0xa70),document['getElementById'](_0xeb0647(0xeed))[_0xeb0647(0x119a)][_0xeb0647(0xbff)](_0xeb0647(0xde5)),document[_0xeb0647(0x383)](_0xeb0647(0xa36))[_0xeb0647(0x119a)]['remove'](_0xeb0647(0xde5));if(_0x5a24f4)_0x3ee27f[_0xeb0647(0x19c)](_0x14e7ab=>{const _0xa0e490=_0xeb0647,_0x39e08e=_0x279988(_0x14e7ab,'my',_0x119165);_0x14e7ab[_0xa0e490(0x2fa)]===_0x49317c&&_0x39e08e['classList'][_0xa0e490(0xbff)](_0xa0e490(0x35e)),_0x3cbce1[_0xa0e490(0xe91)](_0x39e08e);});else{const _0x3250fb=_0x1cdae0['settings']['aiAvatar']||_0x5dc108,_0x19c285=_0x1cdae0[_0xeb0647(0x886)]['myAvatar']||(_0x1cdae0[_0xeb0647(0x1a2)]?_0x188ace:_0x5dc108);_0x3ee27f[_0xeb0647(0x19c)](_0x57891e=>{const _0x140a55=_0xeb0647,_0x5caef2=_0x279988(_0x57891e,'ai',_0x3250fb);if(_0x57891e[_0x140a55(0x2fa)]===_0x36ab47['ai'])_0x5caef2[_0x140a55(0x119a)][_0x140a55(0xbff)](_0x140a55(0x35e));_0x3cbce1[_0x140a55(0xe91)](_0x5caef2);const _0x67d1de=_0x279988(_0x57891e,'my',_0x19c285);if(_0x57891e['url']===_0x36ab47['my'])_0x67d1de[_0x140a55(0x119a)]['add']('selected');_0x434d29[_0x140a55(0xe91)](_0x67d1de);});}}function _0x279988(_0x2453ae,_0x48364c,_0x16423d){const _0xfd483d=_0x549949,_0x34917d=document[_0xfd483d(0xe1b)]('div');return _0x34917d[_0xfd483d(0x556)]='frame-item',_0x34917d[_0xfd483d(0x118)][_0xfd483d(0xc59)]=_0x2453ae[_0xfd483d(0x2fa)],_0x34917d[_0xfd483d(0xf3a)]=_0x2453ae[_0xfd483d(0x461)],_0x34917d[_0xfd483d(0x45c)]=_0xfd483d(0x76c)+_0x16423d+_0xfd483d(0x10b6)+(_0x2453ae[_0xfd483d(0x2fa)]?_0xfd483d(0xf8a)+_0x2453ae[_0xfd483d(0x2fa)]+_0xfd483d(0xdd3):'')+_0xfd483d(0x122b),_0x34917d[_0xfd483d(0x271)](_0xfd483d(0x5c7),()=>{const _0x48ee26=_0xfd483d;_0x36ab47[_0x48364c]=_0x2453ae[_0x48ee26(0x2fa)];const _0x5a7c65=_0x48364c==='ai'?document[_0x48ee26(0x383)](_0x48ee26(0x48e)):document[_0x48ee26(0x383)](_0x48ee26(0xe9f));_0x5a7c65['querySelectorAll'](_0x48ee26(0xf44))['forEach'](_0x2756ef=>_0x2756ef[_0x48ee26(0x119a)][_0x48ee26(0x131d)]('selected')),_0x34917d[_0x48ee26(0x119a)]['add']('selected');}),_0x34917d;}async function _0x4e2fd7(){const _0x4534b4=_0x549949;if(!_0x41df36[_0x4534b4(0xfc5)])return;const _0x288ec4=_0x41df36[_0x4534b4(0x864)][_0x41df36[_0x4534b4(0xfc5)]];if(_0x232685){const _0x2a0d41=_0x288ec4[_0x4534b4(0x12a6)]['find'](_0x17a548=>_0x17a548['id']===_0x5f3c03);_0x2a0d41&&(_0x2a0d41[_0x4534b4(0xefe)]=_0x36ab47['my']);}else _0x288ec4[_0x4534b4(0x886)]['aiAvatarFrame']=_0x36ab47['ai'],_0x288ec4['settings'][_0x4534b4(0x519)]=_0x36ab47['my'];await _0x342df8['chats'][_0x4534b4(0x9c0)](_0x288ec4);if(!_0x232685&&!_0x288ec4[_0x4534b4(0x1a2)]){const _0x32a855=_0x288ec4['id'];for(const _0x2f7376 of Object[_0x4534b4(0x76d)](_0x41df36[_0x4534b4(0x864)])){if(_0x2f7376[_0x4534b4(0x1a2)]&&_0x2f7376[_0x4534b4(0x12a6)]){const _0x1ff4d5=_0x2f7376[_0x4534b4(0x12a6)][_0x4534b4(0xd12)](_0x5db404=>_0x5db404['id']===_0x32a855);_0x1ff4d5&&(_0x1ff4d5[_0x4534b4(0xefe)]=_0x288ec4[_0x4534b4(0x886)]['aiAvatarFrame'],await _0x342df8[_0x4534b4(0x864)][_0x4534b4(0x9c0)](_0x2f7376),console['log'](_0x4534b4(0x1eb)+_0x32a855+_0x4534b4(0x9ea)+_0x2f7376['name']+'\x22'));}}}document[_0x4534b4(0x383)]('avatar-frame-modal')[_0x4534b4(0x119a)][_0x4534b4(0x131d)](_0x4534b4(0x106d)),_0x409076(_0x41df36[_0x4534b4(0xfc5)]),alert('头像框已保存并同步！'),_0x232685=![];}function _0x231a1d(){const _0x27d68f=_0x549949;_0x1aa341=!_0x1aa341;const _0x360fd5=document[_0x27d68f(0x383)](_0x27d68f(0x150)),_0x1d2cce=document[_0x27d68f(0x383)](_0x27d68f(0x11de)),_0x392572=document[_0x27d68f(0x383)](_0x27d68f(0x7e2));document[_0x27d68f(0x400)](_0x27d68f(0xf8b))[_0x27d68f(0x19c)](_0xcb1a3a=>{const _0x4fc3dc=_0x27d68f;_0xcb1a3a[_0x4fc3dc(0x119a)]['toggle'](_0x4fc3dc(0x59f),_0x1aa341);}),_0x1aa341?(_0x360fd5[_0x27d68f(0x138e)]='完成',_0x1d2cce[_0x27d68f(0x655)][_0x27d68f(0x2b6)]=_0x27d68f(0x2aa),_0x1ccd4c[_0x27d68f(0x4b8)](),_0x392572[_0x27d68f(0x2a3)]=![],_0x1e6513()):(_0x360fd5['textContent']='管理',_0x1d2cce[_0x27d68f(0x655)][_0x27d68f(0x2b6)]='none',document[_0x27d68f(0x400)](_0x27d68f(0xec))[_0x27d68f(0x19c)](_0x76aeee=>{const _0x4c28ff=_0x27d68f;_0x76aeee[_0x4c28ff(0x119a)]['remove'](_0x4c28ff(0x35e));}));}function _0x1e6513(){const _0x3be25d=_0x549949,_0x16251b=document['getElementById'](_0x3be25d(0x1351));_0x16251b[_0x3be25d(0x138e)]='删除\x20('+_0x1ccd4c['size']+')';}function _0x3710b9(){const _0x4feec6=_0x549949,_0x4bba95=document[_0x4feec6(0x383)](_0x4feec6(0x7e2))[_0x4feec6(0x2a3)],_0x510176=document[_0x4feec6(0x89c)]('.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid');if(!_0x510176)return;_0x510176['querySelectorAll'](_0x4feec6(0xfa3))['forEach'](_0x4e66b3=>{const _0x27452d=_0x4feec6,_0x597507=parseInt(_0x4e66b3[_0x27452d(0x89c)](_0x27452d(0x392))[_0x27452d(0x118)]['id']);if(isNaN(_0x597507))return;_0x4e66b3['classList'][_0x27452d(0x8f0)](_0x27452d(0x35e),_0x4bba95),_0x4bba95?_0x1ccd4c['add'](_0x597507):_0x1ccd4c[_0x27452d(0x971)](_0x597507);}),_0x1e6513();}async function _0x246141(){const _0x4dc615=_0x549949;if(_0x1ccd4c[_0x4dc615(0x1240)]===0x0)return;const _0x49c5b0=await _0x23a88b(_0x4dc615(0x615),_0x4dc615(0x59a)+_0x1ccd4c[_0x4dc615(0x1240)]+_0x4dc615(0x881),{'confirmButtonClass':'btn-danger'});if(_0x49c5b0){const _0x3dc05f=[..._0x1ccd4c];await _0x342df8[_0x4dc615(0xcf3)][_0x4dc615(0x212)](_0x3dc05f),_0x231a1d(),_0x31ee60(_0x232685),await _0x296ef9(_0x4dc615(0xa04),_0x4dc615(0x430));}}function _0x15f193(_0x13e37c){const _0x157d05=_0x549949,_0x4fd945=document[_0x157d05(0x383)]('global-custom-style');_0x4fd945&&(_0x4fd945['innerHTML']=_0x13e37c||'');}async function _0x32091a(_0x577549){const _0x106ac7=_0x549949;if(!_0x40e606['isActive']||!_0x40e606[_0x106ac7(0xfc5)])return;const _0x4c1651=_0x41df36['chats'][_0x40e606['activeChatId']];if(!_0x4c1651)return;const _0x58d773=_0x4c1651[_0x106ac7(0x1a2)]?_0x4c1651[_0x106ac7(0x886)][_0x106ac7(0x52e)]||'我':'我',_0x1ea10e=_0x106ac7(0x11d9)+_0x58d773+')\x20'+_0x577549+']',_0xf68401={'role':_0x106ac7(0xb1),'content':_0x1ea10e,'timestamp':Date['now'](),'isHidden':!![]};_0x4c1651[_0x106ac7(0xd08)]['push'](_0xf68401),await _0x342df8['chats'][_0x106ac7(0x9c0)](_0x4c1651);}async function _0x45ab6a(){const _0x37f0c7=_0x549949;if(_0x4f051e[_0x37f0c7(0x1240)]===0x0)return;const _0x1aa604=_0x41df36[_0x37f0c7(0x864)][_0x41df36[_0x37f0c7(0xfc5)]];if(!_0x1aa604)return;const _0x193498=document[_0x37f0c7(0x383)](_0x37f0c7(0x1a1)),_0x5bd7b2=_0x193498['textContent'];_0x193498[_0x37f0c7(0x138e)]=_0x37f0c7(0xb34),_0x193498[_0x37f0c7(0x29b)]=!![];const _0xc2c2d1=document[_0x37f0c7(0xe1b)](_0x37f0c7(0x7fd)),_0x14b04f=document['getElementById'](_0x37f0c7(0x1200));_0xc2c2d1['style'][_0x37f0c7(0xabd)]=_0x14b04f[_0x37f0c7(0x5f9)]+'px',_0xc2c2d1[_0x37f0c7(0x655)][_0x37f0c7(0xf92)]=_0x37f0c7(0xfb6),_0xc2c2d1['style']['top']='-9999px',_0xc2c2d1[_0x37f0c7(0x655)][_0x37f0c7(0x402)]=_0x37f0c7(0x14c),_0xc2c2d1[_0x37f0c7(0x655)]['display']=_0x37f0c7(0x2aa),_0xc2c2d1[_0x37f0c7(0x655)][_0x37f0c7(0x55f)]=_0x37f0c7(0xa2d),_0xc2c2d1[_0x37f0c7(0x655)]['height']=_0x37f0c7(0xa60);const _0x1d8b37=document[_0x37f0c7(0x383)](_0x37f0c7(0x862));_0xc2c2d1[_0x37f0c7(0x655)][_0x37f0c7(0x880)]=_0x1d8b37['style'][_0x37f0c7(0x880)],_0xc2c2d1['style'][_0x37f0c7(0x8fc)]=_0x1d8b37[_0x37f0c7(0x655)][_0x37f0c7(0x8fc)]||(document[_0x37f0c7(0x383)](_0x37f0c7(0x1200))[_0x37f0c7(0x119a)][_0x37f0c7(0x987)](_0x37f0c7(0x3de))?_0x37f0c7(0x763):_0x37f0c7(0xb71));const _0x119563=document[_0x37f0c7(0xe1b)]('style');_0x119563['innerHTML']=_0x37f0c7(0x450),document[_0x37f0c7(0x514)][_0x37f0c7(0xe91)](_0x119563);try{const _0x34de52=_0x1d8b37[_0x37f0c7(0x89c)](_0x37f0c7(0x570))['cloneNode'](!![]);_0x34de52['classList'][_0x37f0c7(0xbff)](_0x37f0c7(0x187));const _0x132a0e=document[_0x37f0c7(0xe1b)](_0x37f0c7(0x7fd)),_0x2bede6=document[_0x37f0c7(0x383)](_0x37f0c7(0x11cf));_0x132a0e[_0x37f0c7(0x655)][_0x37f0c7(0x2b6)]=_0x37f0c7(0x2aa),_0x132a0e[_0x37f0c7(0x655)]['flexDirection']=_0x37f0c7(0xa2d),_0x132a0e[_0x37f0c7(0x655)][_0x37f0c7(0x4aa)]=_0x37f0c7(0x634),_0x132a0e[_0x37f0c7(0x655)][_0x37f0c7(0x81a)]=_0x37f0c7(0x222),_0x132a0e[_0x37f0c7(0x655)]['width']='100%',_0x132a0e[_0x37f0c7(0x655)][_0x37f0c7(0x1071)]=_0x37f0c7(0xecd),_0x132a0e[_0x37f0c7(0x118)]['theme']=_0x2bede6[_0x37f0c7(0x118)][_0x37f0c7(0x53f)],_0x132a0e[_0x37f0c7(0x655)]['setProperty'](_0x37f0c7(0x1df),_0x2bede6[_0x37f0c7(0x655)][_0x37f0c7(0x97d)](_0x37f0c7(0x1df)));const _0x52f07f=_0x1d8b37[_0x37f0c7(0x89c)]('#chat-input-area')[_0x37f0c7(0x117b)](!![]),_0x3116eb=[..._0x4f051e][_0x37f0c7(0x1296)]((_0x2280ee,_0x23ebb2)=>_0x2280ee-_0x23ebb2);_0x3116eb[_0x37f0c7(0x19c)](_0x21fde8=>{const _0x529fa7=_0x37f0c7,_0x55858c=document['querySelector']('.message-bubble[data-timestamp=\x22'+_0x21fde8+'\x22]');if(_0x55858c){const _0x1e3313=_0x55858c[_0x529fa7(0x58c)]('.message-wrapper');_0x1e3313&&_0x132a0e[_0x529fa7(0xe91)](_0x1e3313[_0x529fa7(0x117b)](!![]));}}),_0xc2c2d1['appendChild'](_0x34de52),_0xc2c2d1['appendChild'](_0x132a0e),_0xc2c2d1[_0x37f0c7(0xe91)](_0x52f07f),document[_0x37f0c7(0x420)][_0x37f0c7(0xe91)](_0xc2c2d1);const _0x1b3409=Array[_0x37f0c7(0x365)](_0xc2c2d1[_0x37f0c7(0xbbf)]('img')),_0x13cfd5=_0x1b3409[_0x37f0c7(0xa79)](_0x296fd9=>new Promise((_0x24aa1f,_0x36f4f0)=>{const _0x1d2472=_0x37f0c7;if(_0x296fd9[_0x1d2472(0xf6c)][_0x1d2472(0x1122)](_0x1d2472(0xaf1))){_0x24aa1f();return;}const _0x9f5a06=new Image();_0x9f5a06[_0x1d2472(0x240)]=_0x1d2472(0x703),_0x9f5a06[_0x1d2472(0xb5b)]=_0x24aa1f,_0x9f5a06['onerror']=_0x24aa1f,_0x9f5a06[_0x1d2472(0xf6c)]=_0x296fd9[_0x1d2472(0xf6c)];}));await Promise[_0x37f0c7(0x1282)](_0x13cfd5);const _0x549077=await html2canvas(_0xc2c2d1,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window[_0x37f0c7(0x63a)]||0x2});_0x549077[_0x37f0c7(0x4bc)](function(_0xcb80d){const _0x46899a=_0x37f0c7,_0xf81cb=URL[_0x46899a(0x679)](_0xcb80d),_0x45d70b=document[_0x46899a(0xe1b)]('a');_0x45d70b['download']=_0x46899a(0xadc)+_0x1aa604[_0x46899a(0x461)]+'-'+Date[_0x46899a(0x108d)]()+'.png',_0x45d70b['href']=_0xf81cb,document[_0x46899a(0x420)]['appendChild'](_0x45d70b),_0x45d70b[_0x46899a(0x5c7)](),document[_0x46899a(0x420)][_0x46899a(0xd51)](_0x45d70b),URL[_0x46899a(0x119d)](_0xf81cb);},'image/png');}catch(_0x2489f7){console[_0x37f0c7(0x98)](_0x37f0c7(0x86d),_0x2489f7),await _0x296ef9(_0x37f0c7(0x91e),_0x37f0c7(0xa96));}finally{document[_0x37f0c7(0x420)]['removeChild'](_0xc2c2d1),document[_0x37f0c7(0x514)]['removeChild'](_0x119563),_0x193498[_0x37f0c7(0x138e)]=_0x5bd7b2,_0x193498[_0x37f0c7(0x29b)]=![],_0x11c2ba();}}function _0x350d3e(_0x571dc0){const _0x20850d=_0x549949;if(!_0x571dc0||typeof _0x571dc0!==_0x20850d(0xafa))return'';return _0x571dc0=_0x571dc0[_0x20850d(0x709)](/!h\{(.*?)\}/g,'<span\x20class=\x22diary-highlight\x22>$1</span>'),_0x571dc0=_0x571dc0[_0x20850d(0x709)](/!u\{(.*?)\}/g,_0x20850d(0x1161)),_0x571dc0=_0x571dc0[_0x20850d(0x709)](/!e\{(.*?)\}/g,_0x20850d(0x1017)),_0x571dc0=_0x571dc0[_0x20850d(0x709)](/!w\{(.*?)\}/g,_0x20850d(0x118f)),_0x571dc0=_0x571dc0[_0x20850d(0x709)](/!m\{(.*?)\}/g,_0x20850d(0xac7)),_0x571dc0=_0x571dc0[_0x20850d(0x709)](/\|\|(.*?)\|\|/g,_0x20850d(0x926)),_0x571dc0=_0x571dc0[_0x20850d(0x709)](/\*\*(.*?)\*\*/g,_0x20850d(0x508)),_0x571dc0=_0x571dc0[_0x20850d(0x709)](/\~\~(.*?)\~\~/g,_0x20850d(0x431)),_0x571dc0=_0x571dc0['replace'](/\*(.*?)\*/g,_0x20850d(0xa82)),_0x571dc0;}async function _0x3e749c(){const _0x3c872d=_0x549949;console[_0x3c872d(0xe72)]('开始检查并迁移旧的红包数据...');let _0x31722e=0x0;const _0x353d06=Object[_0x3c872d(0x76d)](_0x41df36[_0x3c872d(0x864)]);for(const _0x57ccf9 of _0x353d06){let _0x171804=![];for(const _0x2d0068 of _0x57ccf9['history']){_0x2d0068[_0x3c872d(0xa6b)]==='red_packet'&&_0x2d0068[_0x3c872d(0x1350)]===_0x3c872d(0xe0e)&&_0x2d0068[_0x3c872d(0x10ff)]==='assistant'&&_0x2d0068[_0x3c872d(0xd54)]('receiver')&&!_0x2d0068[_0x3c872d(0xd54)](_0x3c872d(0x30f))&&(_0x2d0068[_0x3c872d(0x30f)]=_0x2d0068[_0x3c872d(0x79b)],delete _0x2d0068[_0x3c872d(0x79b)],_0x171804=!![],_0x31722e++);}_0x171804&&(console[_0x3c872d(0xe72)](_0x3c872d(0x382)+_0x57ccf9[_0x3c872d(0x461)]+_0x3c872d(0xfae)),await _0x342df8[_0x3c872d(0x864)]['put'](_0x57ccf9));}_0x31722e>0x0?(console[_0x3c872d(0xe72)](_0x3c872d(0x12e0)+_0x31722e+_0x3c872d(0x24d)),alert(_0x3c872d(0x4f0)+_0x31722e+_0x3c872d(0x1163)),location[_0x3c872d(0x114a)]()):console[_0x3c872d(0xe72)](_0x3c872d(0x56b));}function _0x5acfa5(_0x2de315){const _0x4df63=_0x549949,_0x1f1b6d=_0x41df36[_0x4df63(0x864)][_0x2de315];if(!_0x1f1b6d||_0x1f1b6d[_0x4df63(0x1a2)])return;document[_0x4df63(0x383)]('profile-heartfelt-voice')['textContent']=_0x1f1b6d['heartfeltVoice']||_0x4df63(0x1026),document['getElementById'](_0x4df63(0x201))[_0x4df63(0x138e)]=_0x1f1b6d[_0x4df63(0xc2b)]||'...';const _0x21854a=document[_0x4df63(0x383)](_0x4df63(0x794));_0x21854a[_0x4df63(0x119a)][_0x4df63(0xbff)](_0x4df63(0x106d));}function _0x34211b(){const _0x181abc=_0x549949;document[_0x181abc(0x383)](_0x181abc(0x116a))['style'][_0x181abc(0x2b6)]=_0x181abc(0xa70),document[_0x181abc(0x383)](_0x181abc(0xf0d))[_0x181abc(0x655)][_0x181abc(0x2b6)]=_0x181abc(0x2aa),_0x354a21();}function _0x44fe08(){const _0xb67ad3=_0x549949;document['getElementById'](_0xb67ad3(0xf0d))[_0xb67ad3(0x655)]['display']=_0xb67ad3(0xa70),document[_0xb67ad3(0x383)](_0xb67ad3(0x116a))[_0xb67ad3(0x655)]['display']=_0xb67ad3(0x2aa);}function _0x354a21(){const _0x4338e2=_0x549949,_0x1f73eb=document['getElementById']('thoughts-history-list'),_0x381173=_0x41df36[_0x4338e2(0x864)][_0x41df36[_0x4338e2(0xfc5)]];_0x1f73eb['innerHTML']='';if(!_0x381173||!_0x381173[_0x4338e2(0x4f8)]||_0x381173['thoughtsHistory']['length']===0x0){_0x1f73eb['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>';return;}const _0x1a5423=[..._0x381173[_0x4338e2(0x4f8)]]['reverse'](),_0x561687=_0x1a5423[_0x4338e2(0x1368)](0x0,_0x4cfe50);_0x561687[_0x4338e2(0x19c)](_0xffba11=>{const _0x1d2bd6=_0x4338e2,_0x2d18d0=_0x3c19a4(_0xffba11);_0x1f73eb[_0x1d2bd6(0xe91)](_0x2d18d0);}),_0x237e84=_0x561687['length'],_0x1a5423[_0x4338e2(0xfde)]>_0x237e84&&appendLoadMoreThoughtsButton(_0x1f73eb);}async function _0x35ffb9(){const _0x3cf0d9=_0x549949;if(_0x13b461)return;_0x13b461=!![];const _0xf144e6=document[_0x3cf0d9(0x383)](_0x3cf0d9(0x1098)),_0x2b5bba=_0x41df36[_0x3cf0d9(0x864)][_0x41df36[_0x3cf0d9(0xfc5)]];if(!_0x2b5bba){_0x13b461=![];return;}_0x38d82d(_0xf144e6,_0x3cf0d9(0xbe3)),await new Promise(_0x102a92=>setTimeout(_0x102a92,0x1f4));const _0x68d125=[..._0x2b5bba['thoughtsHistory']][_0x3cf0d9(0x1087)](),_0x2379f1=_0x68d125[_0x3cf0d9(0xfde)],_0x29521b=_0x237e84,_0x359607=_0x237e84+_0x4cfe50,_0x32c407=_0x68d125[_0x3cf0d9(0x1368)](_0x29521b,_0x359607);_0x3a7b5e(_0xf144e6),_0x32c407['forEach'](_0x4f3fd2=>{const _0x5a2dac=_0x3cf0d9,_0x2f1491=_0x3c19a4(_0x4f3fd2);_0xf144e6[_0x5a2dac(0xe91)](_0x2f1491);}),_0x237e84+=_0x32c407[_0x3cf0d9(0xfde)],_0x13b461=![];}function _0x3c19a4(_0x172adf){const _0x39fa63=_0x549949,_0x19e34a=document['createElement'](_0x39fa63(0x7fd));_0x19e34a[_0x39fa63(0x556)]='thought-card';const _0x26e40b=new Date(_0x172adf['timestamp']),_0x28d2c0=_0x26e40b[_0x39fa63(0xdf9)]()+'-'+String(_0x26e40b['getMonth']()+0x1)[_0x39fa63(0xf20)](0x2,'0')+'-'+String(_0x26e40b[_0x39fa63(0xb29)]())[_0x39fa63(0xf20)](0x2,'0')+'\x20'+String(_0x26e40b['getHours']())[_0x39fa63(0xf20)](0x2,'0')+':'+String(_0x26e40b[_0x39fa63(0xa28)]())[_0x39fa63(0xf20)](0x2,'0');return _0x19e34a[_0x39fa63(0x45c)]=_0x39fa63(0x11f3)+_0x172adf[_0x39fa63(0x3b7)]+'\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>'+_0x28d2c0+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>'+_0x172adf[_0x39fa63(0xa52)]+_0x39fa63(0x869)+_0x172adf[_0x39fa63(0xc2b)]+_0x39fa63(0x11d4),_0x19e34a;}async function _0x230986(_0x38acb6){const _0x5645ab=_0x549949,_0xe132ca=_0x38acb6[_0x5645ab(0xfab)][_0x5645ab(0x1185)][0x0];if(!_0xe132ca)return;try{let _0x3d1806,_0x40802a=null;if(_0xe132ca[_0x5645ab(0x461)][_0x5645ab(0xd47)](_0x5645ab(0xd33))){const _0x33da16=await _0xe132ca[_0x5645ab(0x6af)]();_0x3d1806=JSON[_0x5645ab(0x134)](_0x33da16);}else{if(_0xe132ca[_0x5645ab(0x461)][_0x5645ab(0xd47)](_0x5645ab(0x693))){const _0x4e2f67=await _0xe132ca[_0x5645ab(0xb12)]();_0x3d1806=await _0x433a77(_0x4e2f67),_0x40802a=await new Promise(_0x7f56d7=>{const _0xc118c0=_0x5645ab,_0x23aa22=new FileReader();_0x23aa22[_0xc118c0(0xb5b)]=()=>_0x7f56d7(_0x23aa22[_0xc118c0(0xa86)]),_0x23aa22[_0xc118c0(0x132a)](_0xe132ca);});}else throw new Error(_0x5645ab(0x1153));}await _0x19ebef(_0x3d1806,_0x40802a);}catch(_0x362005){console[_0x5645ab(0x98)]('角色卡导入失败:',_0x362005),await _0x296ef9(_0x5645ab(0x108e),_0x5645ab(0x1376)+_0x362005[_0x5645ab(0x5f8)]);}finally{_0x38acb6[_0x5645ab(0xfab)][_0x5645ab(0x1be)]=null;}}function _0x433a77(_0xa1ef76){return new Promise((_0x4978c8,_0x5e3dca)=>{const _0x1add88=_0x42ed,_0x45744b=new DataView(_0xa1ef76);if(_0x45744b[_0x1add88(0x293)](0x0)!==0x89504e47||_0x45744b[_0x1add88(0x293)](0x4)!==0xd0a1a0a)return _0x5e3dca(new Error(_0x1add88(0x7b8)));let _0x52cf51=0x8;const _0x387944=new TextDecoder();while(_0x52cf51<_0x45744b['byteLength']){const _0x4aebb6=_0x45744b[_0x1add88(0x293)](_0x52cf51),_0x3a8e37=_0x387944[_0x1add88(0xc18)](_0xa1ef76[_0x1add88(0x1368)](_0x52cf51+0x4,_0x52cf51+0x8));if(_0x3a8e37===_0x1add88(0x449)){const _0x2e7a02=new Uint8Array(_0xa1ef76,_0x52cf51+0x8,_0x4aebb6),_0x357594=_0x2e7a02[_0x1add88(0x1105)](0x0);if(_0x357594!==-0x1){const _0x31e44c=_0x387944['decode'](_0x2e7a02[_0x1add88(0x1368)](0x0,_0x357594));if(_0x31e44c===_0x1add88(0xbcc)){const _0x33c42=_0x387944[_0x1add88(0xc18)](_0x2e7a02[_0x1add88(0x1368)](_0x357594+0x1));try{const _0x354a40=atob(_0x33c42),_0x516b7b=new Uint8Array(_0x354a40['length']);for(let _0x42520f=0x0;_0x42520f<_0x354a40[_0x1add88(0xfde)];_0x42520f++){_0x516b7b[_0x42520f]=_0x354a40[_0x1add88(0x274)](_0x42520f);}const _0x215453=new TextDecoder(_0x1add88(0x1246))[_0x1add88(0xc18)](_0x516b7b);_0x4978c8(JSON['parse'](_0x215453));return;}catch(_0x522e7b){return _0x5e3dca(new Error('在PNG中找到角色数据，但解码或解析失败。错误:\x20'+_0x522e7b[_0x1add88(0x5f8)]));}}}}_0x52cf51+=0x4+0x4+_0x4aebb6+0x4;}_0x5e3dca(new Error('在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。'));});}function _0x22cd01(_0x4bc8c1){const _0xb50bab=_0x549949;if(_0x4bc8c1['data']?.[_0xb50bab(0x1168)]?.['entries']?.[_0xb50bab(0xfde)]>0x0)return console[_0xb50bab(0xe72)](_0xb50bab(0x139f)),_0x4bc8c1[_0xb50bab(0x8c6)][_0xb50bab(0x1168)]['entries'];if(_0x4bc8c1['extensions']?.['character_book']?.[_0xb50bab(0x329)]?.[_0xb50bab(0xfde)]>0x0)return console[_0xb50bab(0xe72)]('诊断：在\x20extensions.character_book\x20中找到世界书。'),_0x4bc8c1[_0xb50bab(0xa6a)][_0xb50bab(0x1168)]['entries'];if(_0x4bc8c1[_0xb50bab(0x8c6)]?.['extensions']?.[_0xb50bab(0x1168)]?.['entries']?.['length']>0x0)return console['log'](_0xb50bab(0x5de)),_0x4bc8c1[_0xb50bab(0x8c6)][_0xb50bab(0xa6a)]['character_book'][_0xb50bab(0x329)];const _0x5586e5=['character_book',_0xb50bab(0xbdf),_0xb50bab(0x10a6),_0xb50bab(0x35d)];for(const _0x2f441c of _0x5586e5){if(_0x4bc8c1[_0x2f441c]?.[_0xb50bab(0x329)]?.['length']>0x0)return console['log'](_0xb50bab(0x455)+_0x2f441c+'\x20中找到世界书。'),_0x4bc8c1[_0x2f441c][_0xb50bab(0x329)];}return console['log']('诊断：未在此角色卡中找到任何有效的世界书数据。'),null;}async function _0x19ebef(_0x18f5ad,_0x21f67e=null){const _0x3a2017=_0x549949,_0x4f0d81=_0x18f5ad['data']||_0x18f5ad;if(!_0x4f0d81[_0x3a2017(0x461)])throw new Error(_0x3a2017(0xf2f));let _0x5856c3=null;const _0x4a5790=_0x22cd01(_0x18f5ad);if(_0x4a5790){const _0x1bae26=_0x4a5790[_0x3a2017(0x98a)](_0x2f52a1=>_0x2f52a1['enabled']&&_0x2f52a1['content'])[_0x3a2017(0xa79)](_0x139d40=>({'keys':_0x139d40[_0x3a2017(0x66b)]||[],'comment':_0x139d40[_0x3a2017(0x125b)]||'','content':_0x139d40[_0x3a2017(0x11b6)][_0x3a2017(0x709)](/<memory>|<\/memory>/g,'')[_0x3a2017(0x1cb)]()}));if(_0x1bae26['length']>0x0){const _0xcd274={'id':_0x3a2017(0x120)+Date[_0x3a2017(0x108d)](),'name':_0x4f0d81['name']+_0x3a2017(0x610),'content':_0x1bae26,'categoryId':null};await _0x342df8[_0x3a2017(0xf17)][_0x3a2017(0xbff)](_0xcd274),_0x41df36['worldBooks'][_0x3a2017(0x258)](_0xcd274),_0x5856c3=_0xcd274['id'];}}let _0x1c4796=_0x4f0d81[_0x3a2017(0xee1)]||_0x18f5ad[_0x3a2017(0xee1)]||'无';_0x1c4796=_0x1c4796['replace'](/```yaml/g,'')[_0x3a2017(0x709)](/```/g,'')[_0x3a2017(0x709)](/<\/?info>/g,'')[_0x3a2017(0x709)](/<\/?character>/g,'')[_0x3a2017(0x709)](/<\/?writing_rule>/g,'')[_0x3a2017(0x709)](/\[OOC：.*?\]/g,'')[_0x3a2017(0x1cb)]();let _0x1c541e=_0x3a2017(0x9b2)+_0x1c4796+'\x0a\x0a';if(_0x4f0d81[_0x3a2017(0xb5a)])_0x1c541e+='#\x20性格补充\x0a'+_0x4f0d81[_0x3a2017(0xb5a)]+'\x0a\x0a';if(_0x4f0d81[_0x3a2017(0x7cc)])_0x1c541e+=_0x3a2017(0xb3d)+_0x4f0d81[_0x3a2017(0x7cc)]+'\x0a\x0a';if(_0x4f0d81['mes_example'])_0x1c541e+='#\x20对话示例\x0a'+_0x4f0d81[_0x3a2017(0x8a7)]+'\x0a\x0a';const _0x108697=_0x4f0d81['name'],_0x2be7c9=_0x4f0d81[_0x3a2017(0x461)],_0x3feec1=_0x3a2017(0x1197)+Date[_0x3a2017(0x108d)](),_0x1cdc08={'id':_0x3feec1,'name':_0x108697[_0x3a2017(0x1cb)](),'originalName':_0x2be7c9[_0x3a2017(0x1cb)](),'isGroup':![],'relationship':{'status':_0x3a2017(0x757)},'status':{'text':'在线','lastUpdate':Date['now'](),'isBusy':![]},'settings':{'aiPersona':_0x1c541e,'myPersona':_0x3a2017(0xea2),'maxMemory':0xa,'aiAvatar':_0x5dc108,'myAvatar':_0x5dc108,'background':'','theme':_0x3a2017(0xba4),'fontSize':0xd,'customCss':'','linkedWorldBookIds':_0x5856c3?[_0x5856c3]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0x21f67e&&(_0x1cdc08[_0x3a2017(0x886)]['aiAvatar']=_0x21f67e,_0x1cdc08[_0x3a2017(0x886)][_0x3a2017(0x7fa)][_0x3a2017(0x258)]({'name':_0x3a2017(0xa62),'url':_0x21f67e}));const _0x50677a=_0x4f0d81[_0x3a2017(0x761)]||_0x18f5ad['first_mes'];if(_0x50677a&&typeof _0x50677a===_0x3a2017(0xafa)){const _0x46ef7c=document[_0x3a2017(0xe1b)](_0x3a2017(0x7fd));_0x46ef7c[_0x3a2017(0x45c)]=_0x50677a;const _0x28f061=(_0x46ef7c[_0x3a2017(0x138e)]||_0x46ef7c[_0x3a2017(0xcd3)]||'')['replace'](/原作者UR.*?开局/s,'')[_0x3a2017(0x1cb)]();_0x28f061&&_0x1cdc08[_0x3a2017(0xd08)][_0x3a2017(0x258)]({'role':_0x3a2017(0xf3c),'senderName':_0x1cdc08[_0x3a2017(0x283)],'content':_0x28f061,'timestamp':Date[_0x3a2017(0x108d)]()});}_0x41df36[_0x3a2017(0x864)][_0x3feec1]=_0x1cdc08,await _0x342df8[_0x3a2017(0x864)][_0x3a2017(0x9c0)](_0x1cdc08),_0x25558e();let _0x56dbc3='角色\x20“'+_0x1cdc08[_0x3a2017(0x461)]+_0x3a2017(0xd6b);_0x5856c3&&(_0x56dbc3+=_0x3a2017(0xe4)),await _0x296ef9(_0x3a2017(0xc89),_0x56dbc3);}async function _0x4eb9f2(){const _0x2c569e=_0x549949;if(!_0x41df36[_0x2c569e(0xfc5)])return;const _0x19b32e=_0x41df36['chats'][_0x41df36[_0x2c569e(0xfc5)]],_0x43db3e=_0x19b32e[_0x2c569e(0x886)][_0x2c569e(0xef5)];if(!_0x43db3e||_0x43db3e[_0x2c569e(0xfde)]===0x0){alert(_0x2c569e(0xae0));return;}const _0x4285b6=_0x43db3e['map']((_0x2f3f20,_0x5ac2a3)=>{const _0x1083fa=_0x2c569e,_0x436a9a=_0x2f3f20[_0x1083fa(0x709)](/<[^>]*>/g,'')[_0x1083fa(0x1cb)]()[_0x1083fa(0xba5)](0x0,0x14);return{'text':'开场\x20'+(_0x5ac2a3+0x1)+':\x20'+_0x436a9a+_0x1083fa(0x1026),'value':_0x5ac2a3};}),_0x21786c=await _0x2d60a4(_0x2c569e(0xbb4),_0x4285b6);if(_0x21786c!==null){const _0x213f99=await _0x23a88b(_0x2c569e(0xca),_0x2c569e(0x574),{'confirmButtonClass':_0x2c569e(0x51b),'confirmText':_0x2c569e(0x6c5)});if(_0x213f99){const _0x4ffc68=_0x43db3e[_0x21786c],_0x554bbd={'role':_0x2c569e(0xf3c),'senderName':_0x19b32e[_0x2c569e(0x283)],'content':_0x4ffc68,'timestamp':Date[_0x2c569e(0x108d)]()};_0x19b32e['history']=[_0x554bbd],await _0x342df8[_0x2c569e(0x864)]['put'](_0x19b32e),_0x409076(_0x19b32e['id']),document['getElementById'](_0x2c569e(0xd48))['classList'][_0x2c569e(0x131d)](_0x2c569e(0x106d)),await _0x296ef9('成功',_0x2c569e(0xffc));}}}function _0x31c05(_0x404b67={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x556e86=_0x549949,_0x1a00a0=document['createElement'](_0x556e86(0x7fd));_0x1a00a0[_0x556e86(0x556)]=_0x556e86(0xd7e);const _0xdd5355=_0x404b67[_0x556e86(0x8e4)]!==![]?_0x556e86(0x2a3):'';return _0x1a00a0['innerHTML']=_0x556e86(0x625)+_0xdd5355+_0x556e86(0x1089)+(_0x404b67[_0x556e86(0x125b)]||'')+_0x556e86(0x115b)+(_0x404b67[_0x556e86(0x66b)]||[])[_0x556e86(0xa35)](',\x20')+_0x556e86(0xb57)+(_0x404b67[_0x556e86(0x11b6)]||'')+_0x556e86(0xd45),_0x1a00a0['querySelector']('.delete-block-btn')[_0x556e86(0x271)]('click',()=>{const _0x819499=_0x556e86;_0x1a00a0[_0x819499(0x131d)]();}),_0x1a00a0;}async function _0x5906aa(){const _0x2cf2a8=_0x549949;if(!_0x41df36['activeChatId'])return;const _0x10a43f=_0x41df36['activeChatId'],_0x3ec6a5=document['getElementById'](_0x2cf2a8(0x77f));if(!_0x3ec6a5[_0x2cf2a8(0x119a)][_0x2cf2a8(0x987)]('visible')){const _0x159d46=document[_0x2cf2a8(0x89c)](_0x2cf2a8(0xfaf));_0x3ec6a5[_0x2cf2a8(0x655)][_0x2cf2a8(0x994)]=_0x159d46[_0x2cf2a8(0x1294)]+'px',_0x3ec6a5[_0x2cf2a8(0x655)]['display']=_0x2cf2a8(0x27a),(!_0x35c099[_0x10a43f]||!_0x35c099[_0x10a43f][_0x2cf2a8(0x40d)])&&_0x5f5dee(_0x10a43f),_0x37d3cc(_0x10a43f),setTimeout(async()=>{const _0x1f42c7=_0x2cf2a8;_0x3ec6a5[_0x1f42c7(0x119a)][_0x1f42c7(0xbff)](_0x1f42c7(0x106d));const _0x5574a8={'role':_0x1f42c7(0xb1),'content':_0x1f42c7(0x52f),'timestamp':Date['now'](),'isHidden':!![]};_0x41df36['chats'][_0x10a43f]['history']['push'](_0x5574a8),await _0x342df8['chats'][_0x1f42c7(0x9c0)](_0x41df36['chats'][_0x10a43f]);},0xa);}else await _0x153525();}async function _0x153525(){const _0x56dcaa=_0x549949;if(!_0x41df36[_0x56dcaa(0xfc5)])return;const _0xb4b787=_0x41df36[_0x56dcaa(0xfc5)],_0x2ae7af=document[_0x56dcaa(0x383)](_0x56dcaa(0x77f));_0x2ae7af[_0x56dcaa(0x119a)]['remove']('visible'),setTimeout(()=>{const _0x1f02e3=_0x56dcaa;_0x2ae7af[_0x1f02e3(0x655)][_0x1f02e3(0x2b6)]=_0x1f02e3(0xa70);},0x12c);if(_0x35c099[_0xb4b787]){_0x35c099[_0xb4b787][_0x56dcaa(0x40d)]=![];const _0x58e02e={'role':_0x56dcaa(0xb1),'content':_0x56dcaa(0x6a7),'timestamp':Date[_0x56dcaa(0x108d)](),'isHidden':!![]};_0x41df36[_0x56dcaa(0x864)][_0xb4b787][_0x56dcaa(0xd08)][_0x56dcaa(0x258)](_0x58e02e),await _0x342df8['chats'][_0x56dcaa(0x9c0)](_0x41df36['chats'][_0xb4b787]);}}function _0x5f5dee(_0x63aaa8){const _0x254b53=_0x549949,_0x5ee249=document[_0x254b53(0x383)](_0x254b53(0x13aa)),_0x42e54d=document[_0x254b53(0x383)]('gomoku-overlay'),_0x495b46=document[_0x254b53(0x383)](_0x254b53(0xc2)),_0x46aa76=_0x42e54d[_0x254b53(0x5f9)]-0x28,_0x2b49b1=_0x42e54d[_0x254b53(0x1294)]-_0x495b46[_0x254b53(0x1294)]-0x28,_0x800bc1=Math[_0x254b53(0xdee)](Math['min'](_0x46aa76,_0x2b49b1)),_0x6e150f=0xf,_0x194a17=Math[_0x254b53(0xdee)](_0x800bc1/_0x6e150f),_0x136bd2=_0x194a17*_0x6e150f;_0x5ee249['width']=_0x136bd2,_0x5ee249['height']=_0x136bd2,_0x35c099[_0x63aaa8]={'isActive':!![],'board':Array(_0x6e150f)[_0x254b53(0x852)](0x0)[_0x254b53(0xa79)](()=>Array(_0x6e150f)['fill'](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0x6e150f,'CELL_SIZE':_0x194a17};}function _0x37d3cc(_0x8d3577){const _0x36e379=_0x549949,_0x526b6f=_0x35c099[_0x8d3577];if(!_0x526b6f)return;const _0x958170=document['getElementById']('gomoku-board'),_0x47feb3=_0x958170[_0x36e379(0xcff)]('2d'),{GRID_SIZE:_0x4a2e57,CELL_SIZE:_0x3bef77}=_0x526b6f,_0x58ded7=_0x3bef77/0x2;_0x47feb3[_0x36e379(0x86b)](0x0,0x0,_0x958170[_0x36e379(0xabd)],_0x958170[_0x36e379(0xbb2)]),_0x47feb3[_0x36e379(0xc52)]=_0x36e379(0x61e),_0x47feb3[_0x36e379(0xe66)](0x0,0x0,_0x958170[_0x36e379(0xabd)],_0x958170[_0x36e379(0xbb2)]),_0x47feb3['strokeStyle']=_0x36e379(0xf72),_0x47feb3[_0x36e379(0xaad)]=0x1;for(let _0x1dd9a9=0x0;_0x1dd9a9<_0x4a2e57;_0x1dd9a9++){_0x47feb3[_0x36e379(0x1e6)](),_0x47feb3['moveTo'](_0x58ded7,_0x58ded7+_0x1dd9a9*_0x3bef77),_0x47feb3[_0x36e379(0x692)](_0x958170['width']-_0x58ded7,_0x58ded7+_0x1dd9a9*_0x3bef77),_0x47feb3['stroke'](),_0x47feb3[_0x36e379(0x1e6)](),_0x47feb3[_0x36e379(0x120d)](_0x58ded7+_0x1dd9a9*_0x3bef77,_0x58ded7),_0x47feb3['lineTo'](_0x58ded7+_0x1dd9a9*_0x3bef77,_0x958170[_0x36e379(0xbb2)]-_0x58ded7),_0x47feb3['stroke']();}for(let _0x3e3417=0x0;_0x3e3417<_0x4a2e57;_0x3e3417++){for(let _0x48e15f=0x0;_0x48e15f<_0x4a2e57;_0x48e15f++){_0x526b6f['board'][_0x3e3417][_0x48e15f]!==0x0&&_0x1b283f(_0x47feb3,_0x48e15f,_0x3e3417,_0x526b6f['board'][_0x3e3417][_0x48e15f],_0x526b6f);}}}function _0x1b283f(_0x355d36,_0x4dc47a,_0x2ede18,_0x3ef991,_0x4ff559){const _0xc07d95=_0x549949,{CELL_SIZE:_0x2b1d57}=_0x4ff559,_0x339998=_0x2b1d57/0x2,_0x38a777=_0x2b1d57/0x2-0x2;_0x355d36[_0xc07d95(0x1e6)](),_0x355d36['arc'](_0x339998+_0x4dc47a*_0x2b1d57,_0x339998+_0x2ede18*_0x2b1d57,_0x38a777,0x0,0x2*Math['PI']),_0x3ef991===0x1?_0x355d36['fillStyle']='black':_0x355d36['fillStyle']=_0xc07d95(0x1178),_0x355d36['fill']();}function _0x4dbf40(_0x873f83){const _0x5e096f=_0x549949,_0x257985=_0x41df36['activeChatId'],_0x3eae5e=_0x35c099[_0x257985];if(!_0x3eae5e||_0x3eae5e['isGameOver']||_0x3eae5e['currentPlayer']!==0x1)return;const _0x3b55f8=document[_0x5e096f(0x383)](_0x5e096f(0x13aa)),_0x2c6add=_0x3b55f8[_0x5e096f(0xcff)]('2d'),_0x3166e3=_0x3b55f8[_0x5e096f(0x9c5)](),_0x4c11e0=_0x873f83[_0x5e096f(0xce6)]-_0x3166e3[_0x5e096f(0x402)],_0x3d5b88=_0x873f83[_0x5e096f(0xfc9)]-_0x3166e3[_0x5e096f(0x994)],_0x2fe575=Math['round']((_0x4c11e0-_0x3eae5e[_0x5e096f(0x1198)]/0x2)/_0x3eae5e[_0x5e096f(0x1198)]),_0xf71e89=Math[_0x5e096f(0xe3c)]((_0x3d5b88-_0x3eae5e[_0x5e096f(0x1198)]/0x2)/_0x3eae5e[_0x5e096f(0x1198)]);_0x37d3cc(_0x257985);if(_0x2fe575>=0x0&&_0x2fe575<_0x3eae5e[_0x5e096f(0x110c)]&&_0xf71e89>=0x0&&_0xf71e89<_0x3eae5e[_0x5e096f(0x110c)]&&_0x3eae5e[_0x5e096f(0x95a)][_0xf71e89][_0x2fe575]===0x0){const _0x4c5671=_0x3eae5e[_0x5e096f(0x1198)]/0x2-0x2;_0x2c6add[_0x5e096f(0x1e6)](),_0x2c6add[_0x5e096f(0x5ad)](_0x3eae5e['CELL_SIZE']/0x2+_0x2fe575*_0x3eae5e[_0x5e096f(0x1198)],_0x3eae5e['CELL_SIZE']/0x2+_0xf71e89*_0x3eae5e[_0x5e096f(0x1198)],_0x4c5671,0x0,0x2*Math['PI']),_0x2c6add[_0x5e096f(0xc52)]=_0x5e096f(0xb9d),_0x2c6add[_0x5e096f(0x852)]();}}function _0xf0131c(_0x4f8f09){const _0x1f6710=_0x549949,_0x1b908c=_0x41df36['activeChatId'],_0x2343de=_0x35c099[_0x1b908c];if(!_0x2343de||_0x2343de[_0x1f6710(0x1359)]||_0x2343de[_0x1f6710(0x91a)]!==0x1)return;const _0x460f80=document['getElementById']('gomoku-board'),_0x2ffa38=_0x460f80[_0x1f6710(0x9c5)](),_0x43f445=_0x4f8f09[_0x1f6710(0xce6)]-_0x2ffa38['left'],_0x43ba19=_0x4f8f09['clientY']-_0x2ffa38[_0x1f6710(0x994)],_0x34d9db=Math['round']((_0x43f445-_0x2343de[_0x1f6710(0x1198)]/0x2)/_0x2343de['CELL_SIZE']),_0x141951=Math[_0x1f6710(0xe3c)]((_0x43ba19-_0x2343de[_0x1f6710(0x1198)]/0x2)/_0x2343de['CELL_SIZE']);_0x34d9db>=0x0&&_0x34d9db<_0x2343de[_0x1f6710(0x110c)]&&_0x141951>=0x0&&_0x141951<_0x2343de[_0x1f6710(0x110c)]&&_0x2343de[_0x1f6710(0x95a)][_0x141951][_0x34d9db]===0x0&&(_0x2343de[_0x1f6710(0x95a)][_0x141951][_0x34d9db]=0x1,_0x2343de[_0x1f6710(0xd08)][_0x1f6710(0x258)]({'x':_0x34d9db,'y':_0x141951,'player':0x1}),_0x37d3cc(_0x1b908c),_0x39baba(_0x34d9db,_0x141951,0x1,_0x2343de)?(_0x2343de[_0x1f6710(0x1359)]=!![],setTimeout(()=>alert(_0x1f6710(0xc19)),0x64),_0x5b288f('user')):_0x2343de[_0x1f6710(0x91a)]=0x2);}function _0x1d7b9(_0x4420c0,_0x393067=![]){const _0x5866d0=_0x549949,_0x40448e=_0x41df36[_0x5866d0(0xfc5)],_0x2e817e=_0x35c099[_0x40448e];if(!_0x2e817e||_0x2e817e[_0x5866d0(0x1359)])return;if(!_0x393067&&_0x2e817e['currentPlayer']!==0x2)return;const {x:_0x38c96f,y:_0x20acee}=_0x4420c0;_0x38c96f>=0x0&&_0x38c96f<_0x2e817e[_0x5866d0(0x110c)]&&_0x20acee>=0x0&&_0x20acee<_0x2e817e[_0x5866d0(0x110c)]&&_0x2e817e[_0x5866d0(0x95a)][_0x20acee][_0x38c96f]===0x0?(_0x2e817e[_0x5866d0(0x95a)][_0x20acee][_0x38c96f]=0x2,_0x2e817e[_0x5866d0(0xd08)][_0x5866d0(0x258)]({'x':_0x38c96f,'y':_0x20acee,'player':0x2}),_0x37d3cc(_0x40448e),_0x39baba(_0x38c96f,_0x20acee,0x2,_0x2e817e)?(_0x2e817e[_0x5866d0(0x1359)]=!![],setTimeout(()=>alert(_0x5866d0(0x9fd)),0x64),_0x5b288f('ai')):_0x2e817e['currentPlayer']=0x1):(console[_0x5866d0(0x17b)]('AI\x20的下棋指令无效或位置已被占据:',_0x4420c0),_0x2e817e[_0x5866d0(0x91a)]=0x1);}function _0x39baba(_0x41141,_0x3e882a,_0xd840d4,_0x457f47){const {board:_0x101b6e,GRID_SIZE:_0x352c32}=_0x457f47,_0x53468a=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x59226d,_0x3cc351]of _0x53468a){let _0x17a2b7=0x1;for(let _0x461c45=0x1;_0x461c45<0x5;_0x461c45++){const _0xc70622=_0x41141+_0x461c45*_0x59226d,_0x2a8c6c=_0x3e882a+_0x461c45*_0x3cc351;if(_0xc70622>=0x0&&_0xc70622<_0x352c32&&_0x2a8c6c>=0x0&&_0x2a8c6c<_0x352c32&&_0x101b6e[_0x2a8c6c][_0xc70622]===_0xd840d4)_0x17a2b7++;else break;}for(let _0x1902d1=0x1;_0x1902d1<0x5;_0x1902d1++){const _0x50413c=_0x41141-_0x1902d1*_0x59226d,_0x15a123=_0x3e882a-_0x1902d1*_0x3cc351;if(_0x50413c>=0x0&&_0x50413c<_0x352c32&&_0x15a123>=0x0&&_0x15a123<_0x352c32&&_0x101b6e[_0x15a123][_0x50413c]===_0xd840d4)_0x17a2b7++;else break;}if(_0x17a2b7>=0x5)return!![];}return![];}function _0x4e577c(_0xb4b879){const _0x2b16a4=_0x549949;if(!_0xb4b879||!_0xb4b879[_0x2b16a4(0x40d)])return'';let _0x6f1a08='棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a';_0x6f1a08+=_0xb4b879['board'][_0x2b16a4(0xa79)](_0x1da54d=>_0x1da54d[_0x2b16a4(0xa35)]('\x20'))[_0x2b16a4(0xa35)]('\x0a');let _0x7eb4be=_0x2b16a4(0x100a);return _0x7eb4be+=_0xb4b879['history'][_0x2b16a4(0xa79)](_0x39b5d1=>'玩家'+_0x39b5d1['player']+_0x2b16a4(0x8e8)+_0x39b5d1['x']+','+_0x39b5d1['y']+')')[_0x2b16a4(0xa35)]('\x20->\x20'),_0x2b16a4(0x135c)+_0x6f1a08+'\x0a\x0a#\x20'+_0x7eb4be+_0x2b16a4(0xddf);}async function _0x5b288f(_0x38a630){const _0x25291d=_0x549949,_0x37c65b=_0x41df36[_0x25291d(0xfc5)],_0x41bc00=_0x41df36[_0x25291d(0x864)][_0x37c65b];if(!_0x41bc00)return;const _0x7fb43a=_0x41bc00[_0x25291d(0x1a2)]?_0x41bc00[_0x25291d(0x886)]['myNickname']||'我':'我',_0x14570c=_0x41bc00['isGroup']?_0x25291d(0x905):_0x41bc00['name'],_0xe4671f=_0x38a630===_0x25291d(0x66e)?_0x7fb43a:_0x14570c,_0xd8848b=_0x38a630===_0x25291d(0x66e)?'你输了':_0x25291d(0xf9),_0x4c3358=_0x25291d(0x109e)+_0xe4671f+_0x25291d(0x78e)+_0xd8848b+'。]',_0x1c206d={'role':_0x25291d(0xb1),'content':_0x4c3358,'timestamp':Date[_0x25291d(0x108d)](),'isHidden':!![]};_0x41bc00[_0x25291d(0xd08)]['push'](_0x1c206d),await _0x342df8[_0x25291d(0x864)][_0x25291d(0x9c0)](_0x41bc00),console[_0x25291d(0xe72)](_0x25291d(0x13c)+_0x38a630);}let _0x5938ff=![];async function _0x568766(){const _0x4176e4=_0x549949,_0x107f5d=document[_0x4176e4(0x383)]('product-grid'),_0x26b008=document[_0x4176e4(0x383)](_0x4176e4(0x8e6)),_0x18e751=document['getElementById'](_0x4176e4(0x6da));_0x107f5d['innerHTML']='',_0x26b008[_0x4176e4(0x45c)]='';const [_0x46fa7b,_0x4357e7]=await Promise[_0x4176e4(0x1282)]([_0x342df8['shoppingProducts'][_0x4176e4(0x21f)](),_0x342df8[_0x4176e4(0x8c2)][_0x4176e4(0x4b1)](_0x4176e4(0x461))[_0x4176e4(0x21f)]()]);_0x18e751[_0x4176e4(0x119a)][_0x4176e4(0x8f0)](_0x4176e4(0x59f),_0x5938ff);const _0x262834=document[_0x4176e4(0xe1b)](_0x4176e4(0x182));_0x262834[_0x4176e4(0x556)]=_0x4176e4(0x6a5),_0x262834[_0x4176e4(0x138e)]='全部',_0x262834[_0x4176e4(0x118)][_0x4176e4(0xba3)]=_0x4176e4(0x1282);if(activeShoppingCategoryId===_0x4176e4(0x1282))_0x262834[_0x4176e4(0x119a)]['add'](_0x4176e4(0xde5));_0x26b008[_0x4176e4(0xe91)](_0x262834),_0x4357e7['forEach'](_0xd897f0=>{const _0x4ddb05=_0x4176e4,_0x785040=document[_0x4ddb05(0xe1b)]('button');_0x785040[_0x4ddb05(0x556)]=_0x4ddb05(0x6a5),_0x785040[_0x4ddb05(0x138e)]=_0xd897f0[_0x4ddb05(0x461)],_0x785040[_0x4ddb05(0x118)][_0x4ddb05(0xba3)]=_0xd897f0['id'];if(activeShoppingCategoryId===_0xd897f0['id'])_0x785040[_0x4ddb05(0x119a)][_0x4ddb05(0xbff)](_0x4ddb05(0xde5));_0x26b008[_0x4ddb05(0xe91)](_0x785040);});let _0x486618;activeShoppingCategoryId===_0x4176e4(0x1282)?_0x486618=_0x46fa7b:_0x486618=_0x46fa7b['filter'](_0x3d24fe=>_0x3d24fe[_0x4176e4(0xba3)]===activeShoppingCategoryId);if(_0x486618[_0x4176e4(0xfde)]===0x0){const _0x3d4ffe=activeShoppingCategoryId===_0x4176e4(0x1282)?_0x4176e4(0x56a):_0x4176e4(0x12cb);_0x107f5d[_0x4176e4(0x45c)]='<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>'+_0x3d4ffe+_0x4176e4(0x29a);return;}_0x486618[_0x4176e4(0x19c)](_0x3edc4b=>{const _0x39a141=_0x4176e4,_0x3bbe16=document[_0x39a141(0xe1b)](_0x39a141(0x7fd));_0x3bbe16['className']='product-item',_0x3bbe16[_0x39a141(0x118)]['id']=_0x3edc4b['id'];const _0x5c8545=_0x39a141(0xcdb);_0x3bbe16[_0x39a141(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5c8545+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3edc4b[_0x39a141(0xa94)]+_0x39a141(0x1239)+_0x3edc4b[_0x39a141(0x461)]+_0x39a141(0x263)+_0x3edc4b['price'][_0x39a141(0x70d)](0x2)+_0x39a141(0x53d),_0x107f5d[_0x39a141(0xe91)](_0x3bbe16);});}function _0x624fc2(_0x10b402){activeShoppingCategoryId=_0x10b402,_0x568766(),_0x56c6ca();}function _0x56c6ca(){const _0x1cd642=_0x549949,_0x236b56=document[_0x1cd642(0x383)]('delete-current-category-btn');if(!_0x236b56)return;const _0x168810=_0x5938ff&&activeShoppingCategoryId!==_0x1cd642(0x1282);_0x236b56['style'][_0x1cd642(0x2b6)]=_0x168810?_0x1cd642(0x2aa):_0x1cd642(0xa70);}async function _0x533d77(){const _0x5dfbc9=_0x549949;if(activeShoppingCategoryId===_0x5dfbc9(0x1282))return;const _0x1729f5=activeShoppingCategoryId,_0x1e396d=await _0x342df8[_0x5dfbc9(0x8c2)][_0x5dfbc9(0x1a3)](_0x1729f5);if(!_0x1e396d){alert(_0x5dfbc9(0x128b));return;}const _0x1a7345=_0x5dfbc9(0x620)+_0x1e396d['name']+_0x5dfbc9(0x8d6),_0x5101f6=await _0x23a88b(_0x5dfbc9(0x1136),_0x1a7345,{'confirmButtonClass':_0x5dfbc9(0x51b),'confirmText':'确认删除'});_0x5101f6&&(await _0x11b27a(_0x1729f5),activeShoppingCategoryId=_0x5dfbc9(0x1282),await _0x568766(),_0x56c6ca(),await _0x296ef9('成功',_0x5dfbc9(0x599)+_0x1e396d[_0x5dfbc9(0x461)]+_0x5dfbc9(0xcef)));}async function _0x291d51(){const _0x1d3e14=_0x549949;activeShoppingCategoryId='all',await _0x568766(),_0x105acd(_0x1d3e14(0x6da)),_0x56c6ca();}async function _0x568766(){const _0x11c337=_0x549949,_0x191c2d=document[_0x11c337(0x383)]('product-grid'),_0x2a3c35=document[_0x11c337(0x383)](_0x11c337(0x8e6)),_0x485f5e=document[_0x11c337(0x383)](_0x11c337(0x6da));_0x191c2d[_0x11c337(0x45c)]='',_0x2a3c35[_0x11c337(0x45c)]='';const [_0x404c87,_0x499d8d]=await Promise[_0x11c337(0x1282)]([_0x342df8[_0x11c337(0xd18)][_0x11c337(0x21f)](),_0x342df8[_0x11c337(0x8c2)]['orderBy']('name')[_0x11c337(0x21f)]()]);_0x485f5e[_0x11c337(0x119a)][_0x11c337(0x8f0)](_0x11c337(0x59f),_0x5938ff);const _0xf9a0ac=document['createElement'](_0x11c337(0x182));_0xf9a0ac[_0x11c337(0x556)]='product-category-tab',_0xf9a0ac[_0x11c337(0x138e)]='全部',_0xf9a0ac[_0x11c337(0x118)]['categoryId']=_0x11c337(0x1282);if(activeShoppingCategoryId===_0x11c337(0x1282))_0xf9a0ac[_0x11c337(0x119a)][_0x11c337(0xbff)]('active');_0x2a3c35['appendChild'](_0xf9a0ac),_0x499d8d[_0x11c337(0x19c)](_0x4dd8bd=>{const _0x56090b=_0x11c337,_0x3d8a53=document[_0x56090b(0xe1b)](_0x56090b(0x182));_0x3d8a53[_0x56090b(0x556)]=_0x56090b(0x6a5),_0x3d8a53[_0x56090b(0x138e)]=_0x4dd8bd[_0x56090b(0x461)],_0x3d8a53[_0x56090b(0x118)][_0x56090b(0xba3)]=_0x4dd8bd['id'];if(activeShoppingCategoryId===_0x4dd8bd['id'])_0x3d8a53[_0x56090b(0x119a)][_0x56090b(0xbff)](_0x56090b(0xde5));_0x2a3c35[_0x56090b(0xe91)](_0x3d8a53);});let _0x3036d8;activeShoppingCategoryId===_0x11c337(0x1282)?_0x3036d8=_0x404c87:_0x3036d8=_0x404c87['filter'](_0x49de60=>_0x49de60['categoryId']===activeShoppingCategoryId);if(_0x3036d8[_0x11c337(0xfde)]===0x0){const _0x3fa88c=activeShoppingCategoryId==='all'?_0x11c337(0x56a):_0x11c337(0x12cb);_0x191c2d[_0x11c337(0x45c)]=_0x11c337(0x8d2)+_0x3fa88c+'</p>';return;}_0x3036d8['forEach'](_0x2cde1a=>{const _0x505bdb=_0x11c337,_0x2a87c7=document['createElement'](_0x505bdb(0x7fd));_0x2a87c7[_0x505bdb(0x556)]=_0x505bdb(0x970),_0x2a87c7[_0x505bdb(0x118)]['id']=_0x2cde1a['id'];const _0x5b5fce=_0x5938ff?_0x505bdb(0x185):'';_0x2a87c7[_0x505bdb(0x45c)]=_0x505bdb(0x122b)+_0x5b5fce+_0x505bdb(0xe1f)+_0x2cde1a['imageUrl']+'\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>'+_0x2cde1a[_0x505bdb(0x461)]+_0x505bdb(0x79d)+_0x2cde1a['price']['toFixed'](0x2)+_0x505bdb(0xdfe),_0x191c2d[_0x505bdb(0xe91)](_0x2a87c7);});}async function _0x5d8470(_0x46a8cb,_0x117bbf=0x1,_0x436982=null){const _0x58359b=_0x549949,_0x36b5dc=_0x436982?_0x51a1bd[_0x58359b(0xd12)](_0x24e8bb=>_0x24e8bb[_0x58359b(0x6eb)]===_0x46a8cb&&_0x24e8bb[_0x58359b(0x3f9)]?.[_0x58359b(0x461)]===_0x436982['name']):_0x51a1bd['find'](_0x107cc3=>_0x107cc3['productId']===_0x46a8cb&&!_0x107cc3[_0x58359b(0x3f9)]);if(_0x36b5dc)_0x36b5dc['quantity']+=_0x117bbf;else{const _0x21f367=await _0x342df8[_0x58359b(0xd18)][_0x58359b(0x1a3)](_0x46a8cb);_0x21f367&&_0x51a1bd[_0x58359b(0x258)]({'productId':_0x21f367['id'],'quantity':_0x117bbf,'variation':_0x436982});}_0x4a2f15();}function _0x23209a(_0x579bfb,_0x2de2d3){const _0x1a863b=_0x549949,_0x2cf760=_0x51a1bd['findIndex'](_0x2157d6=>_0x2157d6['productId']===_0x579bfb);_0x2cf760>-0x1&&(_0x51a1bd[_0x2cf760][_0x1a863b(0x257)]+=_0x2de2d3,_0x51a1bd[_0x2cf760][_0x1a863b(0x257)]<=0x0&&_0x51a1bd[_0x1a863b(0x2f1)](_0x2cf760,0x1),_0x4a2f15(),_0x34c15d());}function _0x4a2f15(){const _0x2de1b6=_0x549949,_0x450251=_0x51a1bd[_0x2de1b6(0xf60)]((_0x352c8c,_0xa4925b)=>_0x352c8c+_0xa4925b[_0x2de1b6(0x257)],0x0);document[_0x2de1b6(0x383)](_0x2de1b6(0x643))[_0x2de1b6(0x138e)]=_0x450251,document[_0x2de1b6(0x383)](_0x2de1b6(0xa22))[_0x2de1b6(0x138e)]='购物车('+_0x450251+')',document[_0x2de1b6(0x383)](_0x2de1b6(0xe51))['textContent']='结算('+_0x450251+')';}function _0x46e9da(){const _0x3802d9=_0x549949;_0x34c15d(),_0x105acd(_0x3802d9(0xe33));}async function _0x34c15d(){const _0x16e3eb=_0x549949,_0x246bbe=document[_0x16e3eb(0x383)](_0x16e3eb(0xe8b));_0x246bbe[_0x16e3eb(0x45c)]='';let _0x4dd6b9=0x0;if(_0x51a1bd[_0x16e3eb(0xfde)]===0x0)_0x246bbe[_0x16e3eb(0x45c)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>';else{const _0x1f3ed4=_0x51a1bd['map'](_0x1b7ec3=>_0x1b7ec3[_0x16e3eb(0x6eb)]),_0x5db12b=await _0x342df8[_0x16e3eb(0xd18)][_0x16e3eb(0x6bd)]('id')[_0x16e3eb(0x1314)](_0x1f3ed4)[_0x16e3eb(0x21f)](),_0x50ab24=new Map(_0x5db12b[_0x16e3eb(0xa79)](_0x364c7b=>[_0x364c7b['id'],_0x364c7b]));_0x51a1bd[_0x16e3eb(0x19c)](_0x21ee9d=>{const _0x4c801f=_0x16e3eb,_0x2cca59=_0x50ab24[_0x4c801f(0x1a3)](_0x21ee9d[_0x4c801f(0x6eb)]);if(_0x2cca59){const _0x1948e3=document[_0x4c801f(0xe1b)](_0x4c801f(0x7fd));_0x1948e3[_0x4c801f(0x556)]=_0x4c801f(0x5a8);const _0x5c28b3=_0x21ee9d[_0x4c801f(0x3f9)]?'<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20'+_0x21ee9d['variation']['name']+_0x4c801f(0x69b):'';_0x1948e3[_0x4c801f(0x45c)]=_0x4c801f(0xc25)+_0x2cca59['id']+_0x4c801f(0x5c8)+(_0x21ee9d[_0x4c801f(0x3f9)]?.[_0x4c801f(0xa94)]||_0x2cca59[_0x4c801f(0xa94)])+_0x4c801f(0x115a)+_0x2cca59[_0x4c801f(0x461)]+_0x4c801f(0x1c3)+_0x5c28b3+_0x4c801f(0xd37)+(_0x21ee9d[_0x4c801f(0x3f9)]?.[_0x4c801f(0xa19)]||_0x2cca59[_0x4c801f(0xa19)])[_0x4c801f(0x70d)](0x2)+_0x4c801f(0x1346)+_0x2cca59['id']+_0x4c801f(0x1154)+_0x21ee9d[_0x4c801f(0x257)]+_0x4c801f(0x688)+_0x2cca59['id']+'\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x246bbe[_0x4c801f(0xe91)](_0x1948e3);}});}_0x5db0e4();}async function _0x5db0e4(){const _0x42986e=_0x549949;let _0x2331df=0x0;const _0x12f1f5=document[_0x42986e(0x400)](_0x42986e(0x11b3)),_0x5dccf0=Array[_0x42986e(0x365)](_0x12f1f5)[_0x42986e(0xa79)](_0x92fe53=>parseInt(_0x92fe53['dataset']['id']));if(_0x5dccf0[_0x42986e(0xfde)]>0x0){const _0x4f171e=await _0x342df8[_0x42986e(0xd18)][_0x42986e(0x6bd)]('id')[_0x42986e(0x1314)](_0x5dccf0)[_0x42986e(0x21f)](),_0x10dd18=new Map(_0x4f171e['map'](_0x4ef498=>[_0x4ef498['id'],_0x4ef498]));_0x51a1bd['forEach'](_0x43ecdd=>{const _0x4b2136=_0x42986e;if(_0x5dccf0['includes'](_0x43ecdd[_0x4b2136(0x6eb)])){const _0x3229fd=_0x10dd18[_0x4b2136(0x1a3)](_0x43ecdd['productId']);if(_0x3229fd){const _0x4bc192=_0x43ecdd[_0x4b2136(0x3f9)]?_0x43ecdd[_0x4b2136(0x3f9)][_0x4b2136(0xa19)]:_0x3229fd[_0x4b2136(0xa19)];_0x2331df+=_0x4bc192*_0x43ecdd[_0x4b2136(0x257)];}}});}document[_0x42986e(0x383)]('cart-total')[_0x42986e(0x138e)]=_0x42986e(0x96a)+_0x2331df['toFixed'](0x2);}async function _0x427205(){const _0x599db1=_0x549949,_0x4f0d49=_0x41df36['chats'][_0x41df36['activeChatId']];if(!_0x4f0d49||!_0x4f0d49[_0x599db1(0x1a2)])return;const _0x23c6a6=document[_0x599db1(0x383)](_0x599db1(0xbb7)),_0xae992e=document['getElementById']('gift-recipient-list');_0xae992e[_0x599db1(0x45c)]='';const _0x2ea956=_0x4f0d49[_0x599db1(0x886)][_0x599db1(0x52e)]||'我',_0x3bc5b4=_0x4f0d49[_0x599db1(0x12a6)][_0x599db1(0x98a)](_0x5164c0=>_0x5164c0[_0x599db1(0x9da)]!==_0x2ea956);_0x3bc5b4['forEach'](_0x4a9fa7=>{const _0x28fa62=_0x599db1,_0x4d6df2=document['createElement'](_0x28fa62(0x7fd));_0x4d6df2['className']=_0x28fa62(0x136c),_0x4d6df2[_0x28fa62(0x118)][_0x28fa62(0x2a5)]=_0x4a9fa7['originalName'],_0x4d6df2[_0x28fa62(0x45c)]=_0x28fa62(0xec7)+(_0x4a9fa7[_0x28fa62(0xb47)]||_0x59100f)+_0x28fa62(0x1040)+_0x4a9fa7[_0x28fa62(0x9da)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xae992e[_0x28fa62(0xe91)](_0x4d6df2);}),document[_0x599db1(0x383)]('select-all-recipients')['checked']=![],_0x23c6a6[_0x599db1(0x119a)][_0x599db1(0xbff)](_0x599db1(0x106d));}async function _0x409765(){const _0x3e5205=_0x549949,_0x505112=_0x41df36[_0x3e5205(0x864)][_0x41df36['activeChatId']],_0x5dbba3=_0x51a1bd[_0x3e5205(0x98a)](_0x83cc50=>document[_0x3e5205(0x89c)]('.cart-item-checkbox[data-id=\x22'+_0x83cc50[_0x3e5205(0x6eb)]+'\x22]:checked'));if(_0x5dbba3['length']===0x0){alert('请先在购物车中选择要结算的商品。');return;}if(_0x505112[_0x3e5205(0x1a2)])_0x427205();else{const _0x5d9f70=await _0x23a88b(_0x3e5205(0x529),'确定要将选中的商品作为礼物送出吗？',{'confirmText':_0x3e5205(0x1b1)});_0x5d9f70&&await _0x55416b(_0x5dbba3);}}async function _0x55416b(_0xbabe17,_0x6182a0=null){const _0x231918=_0x549949;if(!_0x41df36[_0x231918(0xfc5)])return;const _0x305f2f=_0x41df36[_0x231918(0x864)][_0x41df36[_0x231918(0xfc5)]],_0x3b7b54=_0xbabe17[_0x231918(0xa79)](_0xe5a4a5=>_0xe5a4a5[_0x231918(0x6eb)]),_0x2086ed=await _0x342df8[_0x231918(0xd18)]['where']('id')[_0x231918(0x1314)](_0x3b7b54)[_0x231918(0x21f)](),_0x29bcef=new Map(_0x2086ed[_0x231918(0xa79)](_0x3908f2=>[_0x3908f2['id'],_0x3908f2])),_0x171d43=_0xbabe17[_0x231918(0xa79)](_0x12054c=>{const _0x61b2aa=_0x231918,_0x51cc2c=_0x29bcef[_0x61b2aa(0x1a3)](_0x12054c[_0x61b2aa(0x6eb)]);return _0x12054c[_0x61b2aa(0x3f9)]?{'name':_0x51cc2c[_0x61b2aa(0x461)]+_0x61b2aa(0xb13)+_0x12054c['variation'][_0x61b2aa(0x461)],'price':_0x12054c[_0x61b2aa(0x3f9)]['price'],'imageUrl':_0x12054c[_0x61b2aa(0x3f9)][_0x61b2aa(0xa94)]||_0x51cc2c[_0x61b2aa(0xa94)],'quantity':_0x12054c[_0x61b2aa(0x257)]}:{'name':_0x51cc2c[_0x61b2aa(0x461)],'price':_0x51cc2c[_0x61b2aa(0xa19)],'imageUrl':_0x51cc2c[_0x61b2aa(0xa94)],'quantity':_0x12054c[_0x61b2aa(0x257)]};}),_0x48d07b={'role':'user','type':_0x231918(0x980),'timestamp':Date[_0x231918(0x108d)](),'items':_0x171d43,'total':_0x171d43[_0x231918(0xf60)]((_0x1cb471,_0xf6d974)=>_0x1cb471+_0xf6d974[_0x231918(0xa19)]*_0xf6d974[_0x231918(0x257)],0x0),'recipients':_0x6182a0};_0x305f2f[_0x231918(0xd08)][_0x231918(0x258)](_0x48d07b);if(_0x6182a0&&_0x6182a0[_0x231918(0xfde)]>0x0){const _0x3543c8=_0x6182a0['map'](_0xceecc3=>_0x54d0ab(_0x305f2f,_0xceecc3))['join']('、'),_0x5979f3={'role':_0x231918(0xb1),'content':'[系统提示：用户\x20('+(_0x305f2f['settings'][_0x231918(0x52e)]||'我')+_0x231918(0x645)+_0x3543c8+_0x231918(0xd2a),'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x305f2f[_0x231918(0xd08)][_0x231918(0x258)](_0x5979f3);}await _0x342df8[_0x231918(0x864)][_0x231918(0x9c0)](_0x305f2f),_0x323467(_0x48d07b,_0x305f2f),_0x25558e(),_0x51a1bd=_0x51a1bd['filter'](_0x5dacc5=>!_0xbabe17['some'](_0x2395c8=>_0x2395c8[_0x231918(0x6eb)]===_0x5dacc5['productId'])),_0x4a2f15(),_0x105acd(_0x231918(0x862)),await _0x296ef9('成功','礼物已成功送出！');}function _0x511cbe(_0x426055){const _0x392b60=_0x549949,_0x31ecb1=_0x41df36[_0x392b60(0x864)][_0x41df36['activeChatId']],_0x2f5a1c=_0x31ecb1[_0x392b60(0xd08)]['find'](_0x13d8f9=>_0x13d8f9[_0x392b60(0x3b7)]===_0x426055);if(!_0x2f5a1c||_0x2f5a1c[_0x392b60(0xa6b)]!==_0x392b60(0x980))return;const _0x55c8f2=document[_0x392b60(0x383)](_0x392b60(0x9c7));let _0x3d4cb9='';_0x2f5a1c['items'][_0x392b60(0x19c)](_0x5570a0=>{const _0x33a288=_0x392b60;_0x3d4cb9+='<tr><td\x20class=\x22item-name\x22>'+_0x5570a0[_0x33a288(0x461)]+_0x33a288(0x9bd)+_0x5570a0[_0x33a288(0x257)]+'</td><td\x20class=\x22item-price\x22>¥'+_0x5570a0['price'][_0x33a288(0x70d)](0x2)+_0x33a288(0x999)+(_0x5570a0[_0x33a288(0xa19)]*_0x5570a0['quantity'])[_0x33a288(0x70d)](0x2)+_0x33a288(0xc2f);}),_0x55c8f2['innerHTML']='<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20'+new Date(_0x2f5a1c[_0x392b60(0x3b7)])[_0x392b60(0xa2b)]()+_0x392b60(0xc71)+_0x3d4cb9+_0x392b60(0x563)+_0x2f5a1c[_0x392b60(0xac2)][_0x392b60(0x70d)](0x2)+'</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>',document[_0x392b60(0x383)](_0x392b60(0x995))[_0x392b60(0x119a)][_0x392b60(0xbff)]('visible');}async function _0x50567a(_0x80f763=null){const _0x4b1de3=_0x549949;_0x34229b=_0x80f763;const _0x1f8353=document[_0x4b1de3(0x383)](_0x4b1de3(0x49e)),_0x4e62e8=document['getElementById'](_0x4b1de3(0x849)),_0x3dce80=document['getElementById'](_0x4b1de3(0xf9e)),_0x455158=document[_0x4b1de3(0x383)](_0x4b1de3(0x114d)),_0x16a1f7=document[_0x4b1de3(0x383)](_0x4b1de3(0xf07)),_0x26d6dc=document[_0x4b1de3(0x383)]('product-image-preview'),_0x3f37a5=document['getElementById'](_0x4b1de3(0x743)),_0xb40b87=document[_0x4b1de3(0x383)](_0x4b1de3(0x1006));_0xb40b87['innerHTML']='',_0x3f37a5[_0x4b1de3(0x45c)]=_0x4b1de3(0x95);const _0xf279ed=await _0x342df8[_0x4b1de3(0x8c2)][_0x4b1de3(0x21f)]();_0xf279ed[_0x4b1de3(0x19c)](_0x277efd=>{const _0x55ddb0=_0x4b1de3,_0x2d4516=document[_0x55ddb0(0xe1b)](_0x55ddb0(0x10a0));_0x2d4516['value']=_0x277efd['id'],_0x2d4516[_0x55ddb0(0x138e)]=_0x277efd[_0x55ddb0(0x461)],_0x3f37a5[_0x55ddb0(0xe91)](_0x2d4516);});if(_0x80f763){_0x4e62e8['textContent']=_0x4b1de3(0x2b3);const _0x5a6b92=await _0x342df8[_0x4b1de3(0xd18)]['get'](_0x80f763);_0x3dce80[_0x4b1de3(0x1be)]=_0x5a6b92[_0x4b1de3(0x461)],_0x455158[_0x4b1de3(0x1be)]=_0x5a6b92[_0x4b1de3(0xa19)],_0x16a1f7[_0x4b1de3(0x1be)]=_0x5a6b92['description']||'',_0x26d6dc[_0x4b1de3(0xf6c)]=_0x5a6b92[_0x4b1de3(0xa94)],_0x3f37a5[_0x4b1de3(0x1be)]=_0x5a6b92[_0x4b1de3(0xba3)]||'',_0x5a6b92[_0x4b1de3(0xade)]&&_0x5a6b92[_0x4b1de3(0xade)][_0x4b1de3(0xfde)]>0x0&&_0x5a6b92[_0x4b1de3(0xade)][_0x4b1de3(0x19c)](_0x5507aa=>_0x41f537(_0x5507aa));}else _0x4e62e8[_0x4b1de3(0x138e)]=_0x4b1de3(0xac0),_0x3dce80['value']='',_0x455158[_0x4b1de3(0x1be)]='',_0x16a1f7[_0x4b1de3(0x1be)]='',_0x26d6dc['src']=_0x4b1de3(0x4a4),_0x3f37a5[_0x4b1de3(0x1be)]='';_0x1f8353[_0x4b1de3(0x119a)][_0x4b1de3(0xbff)](_0x4b1de3(0x106d));}async function _0x3b1045(){const _0x38ce20=_0x549949,_0x2bbb85=document[_0x38ce20(0x383)](_0x38ce20(0xf9e))[_0x38ce20(0x1be)][_0x38ce20(0x1cb)](),_0x1afb70=parseFloat(document[_0x38ce20(0x383)]('product-price-input')[_0x38ce20(0x1be)]),_0x3f3424=document[_0x38ce20(0x383)](_0x38ce20(0xf07))[_0x38ce20(0x1be)][_0x38ce20(0x1cb)](),_0x412c36=document[_0x38ce20(0x383)]('product-image-preview')[_0x38ce20(0xf6c)],_0x2c498d=parseInt(document[_0x38ce20(0x383)](_0x38ce20(0x743))[_0x38ce20(0x1be)])||null;if(!_0x2bbb85){alert(_0x38ce20(0xe8f));return;}if(isNaN(_0x1afb70)||_0x1afb70<0x0){alert(_0x38ce20(0x6b7));return;}const _0x1d79fc=[];document[_0x38ce20(0x400)](_0x38ce20(0x2f6))[_0x38ce20(0x19c)](_0x9e0dc6=>{const _0x523ce6=_0x38ce20,_0x13f6d0=_0x9e0dc6[_0x523ce6(0x89c)]('.variation-name-input')[_0x523ce6(0x1be)][_0x523ce6(0x1cb)](),_0x7c6fca=parseFloat(_0x9e0dc6['querySelector'](_0x523ce6(0x712))[_0x523ce6(0x1be)]),_0x781fe4=_0x9e0dc6['querySelector'](_0x523ce6(0x1024))['src'];_0x13f6d0&&!isNaN(_0x7c6fca)&&_0x7c6fca>=0x0&&_0x1d79fc[_0x523ce6(0x258)]({'name':_0x13f6d0,'price':_0x7c6fca,'imageUrl':_0x781fe4[_0x523ce6(0xee2)](_0x523ce6(0x28e))?null:_0x781fe4});});const _0x22afd6={'name':_0x2bbb85,'price':_0x1afb70,'description':_0x3f3424,'imageUrl':_0x412c36,'categoryId':_0x2c498d,'variations':_0x1d79fc};_0x34229b?await _0x342df8[_0x38ce20(0xd18)][_0x38ce20(0xaf9)](_0x34229b,_0x22afd6):await _0x342df8[_0x38ce20(0xd18)][_0x38ce20(0xbff)](_0x22afd6),document[_0x38ce20(0x383)]('product-editor-modal')[_0x38ce20(0x119a)][_0x38ce20(0x131d)](_0x38ce20(0x106d)),await _0x568766();}async function _0x3d2653(){await _0xa3d79d(),_0x105acd('rendering-rules-screen');}async function _0xa3d79d(){const _0x40f4a6=_0x549949,_0x46f332=document[_0x40f4a6(0x383)](_0x40f4a6(0x4ff)),_0x526f1c=document[_0x40f4a6(0x383)](_0x40f4a6(0xa00));_0x46f332[_0x40f4a6(0x45c)]='',_0x526f1c[_0x40f4a6(0x45c)]='';const _0x21611f=await _0x342df8[_0x40f4a6(0x929)]['toArray']();if(_0x21611f[_0x40f4a6(0xfde)]===0x0){_0x526f1c[_0x40f4a6(0x45c)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>';return;}const _0x52d6c2=document['createElement']('button');_0x52d6c2[_0x40f4a6(0x556)]=_0x40f4a6(0x121b),_0x52d6c2[_0x40f4a6(0x138e)]=_0x40f4a6(0x8c0),_0x52d6c2[_0x40f4a6(0x118)][_0x40f4a6(0xba3)]=_0x40f4a6(0x934),_0x46f332[_0x40f4a6(0xe91)](_0x52d6c2);const _0xa1f9a6=document['createElement'](_0x40f4a6(0x7fd));_0xa1f9a6['className']=_0x40f4a6(0x742),_0xa1f9a6['dataset'][_0x40f4a6(0xba3)]='global',_0x526f1c[_0x40f4a6(0xe91)](_0xa1f9a6);const _0x583689=Object[_0x40f4a6(0x76d)](_0x41df36[_0x40f4a6(0x864)])[_0x40f4a6(0x98a)](_0x182c21=>!_0x182c21[_0x40f4a6(0x1a2)]&&_0x21611f[_0x40f4a6(0x12fb)](_0x5c1bb4=>_0x5c1bb4[_0x40f4a6(0xa65)]===_0x182c21['id']));_0x583689['forEach'](_0x55bf7d=>{const _0x32910d=_0x40f4a6,_0x3cb0f4=document[_0x32910d(0xe1b)](_0x32910d(0x182));_0x3cb0f4[_0x32910d(0x556)]=_0x32910d(0x1db),_0x3cb0f4[_0x32910d(0x138e)]=_0x55bf7d[_0x32910d(0x461)],_0x3cb0f4[_0x32910d(0x118)][_0x32910d(0xba3)]=_0x55bf7d['id'],_0x46f332[_0x32910d(0xe91)](_0x3cb0f4);const _0x1845df=document[_0x32910d(0xe1b)](_0x32910d(0x7fd));_0x1845df[_0x32910d(0x556)]=_0x32910d(0x62f),_0x1845df[_0x32910d(0x118)]['categoryId']=_0x55bf7d['id'],_0x526f1c[_0x32910d(0xe91)](_0x1845df);}),_0x21611f[_0x40f4a6(0x19c)](_0x2e6a82=>{const _0x502037=_0x40f4a6,_0x1cc3a3=_0x3d548d(_0x2e6a82),_0x4b017c=_0x526f1c['querySelector'](_0x502037(0xac9)+_0x2e6a82[_0x502037(0xa65)]+'\x22]');_0x4b017c&&_0x4b017c[_0x502037(0xe91)](_0x1cc3a3);}),document['querySelectorAll'](_0x40f4a6(0x438))[_0x40f4a6(0x19c)](_0x43511a=>{const _0x10be66=_0x40f4a6;_0x43511a['addEventListener']('click',()=>_0x179abd(_0x43511a[_0x10be66(0x118)][_0x10be66(0xba3)]));});}function _0x3d548d(_0x45ad1e){const _0x1a076d=_0x549949,_0x93e49a=document[_0x1a076d(0xe1b)](_0x1a076d(0x7fd));return _0x93e49a[_0x1a076d(0x556)]='rule-card\x20'+(_0x45ad1e[_0x1a076d(0x122)]?_0x1a076d(0x8e4):''),_0x93e49a[_0x1a076d(0x118)][_0x1a076d(0x47c)]=_0x45ad1e['id'],_0x93e49a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x45ad1e[_0x1a076d(0x461)]+_0x1a076d(0xc0f)+_0x45ad1e[_0x1a076d(0xfbc)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x93e49a[_0x1a076d(0x271)](_0x1a076d(0x5c7),()=>_0x1e94d8(_0x45ad1e['id'])),_0x3e15d1(_0x93e49a,()=>_0x2ec898(_0x45ad1e['id'])),_0x93e49a;}async function _0x1e94d8(_0x4ccf5e=null){const _0x4b3208=_0x549949;_0x223e60=_0x4ccf5e;const _0x3f0f54=document[_0x4b3208(0x383)](_0x4b3208(0x68c)),_0x27d92e=document[_0x4b3208(0x383)](_0x4b3208(0x115)),_0x29dbc2=document['getElementById'](_0x4b3208(0x1100)),_0x3c5551=document[_0x4b3208(0x383)]('rule-chat-id-select'),_0x3bfac3=document[_0x4b3208(0x383)](_0x4b3208(0xf35)),_0x5971e5=document[_0x4b3208(0x383)](_0x4b3208(0xfd3)),_0x380005=document[_0x4b3208(0x383)](_0x4b3208(0x2b5));_0x3c5551[_0x4b3208(0x45c)]=_0x4b3208(0x88c),Object[_0x4b3208(0x76d)](_0x41df36[_0x4b3208(0x864)])[_0x4b3208(0x98a)](_0x11b951=>!_0x11b951['isGroup'])[_0x4b3208(0x19c)](_0x40aebd=>{const _0x280d49=_0x4b3208;_0x3c5551['innerHTML']+='<option\x20value=\x22'+_0x40aebd['id']+'\x22>'+_0x40aebd['name']+_0x280d49(0xd23);});if(_0x4ccf5e){_0x27d92e[_0x4b3208(0x138e)]=_0x4b3208(0x1361);const _0x3afd74=await _0x342df8[_0x4b3208(0x929)]['get'](_0x4ccf5e);_0x29dbc2[_0x4b3208(0x1be)]=_0x3afd74['name'],_0x3c5551[_0x4b3208(0x1be)]=_0x3afd74[_0x4b3208(0xa65)],_0x3bfac3['value']=_0x3afd74[_0x4b3208(0xfbc)],_0x5971e5[_0x4b3208(0x1be)]=_0x3afd74['template'],_0x380005[_0x4b3208(0x2a3)]=_0x3afd74['isEnabled'];}else _0x27d92e['textContent']='创建新规则',_0x29dbc2[_0x4b3208(0x1be)]='',_0x3c5551[_0x4b3208(0x1be)]=_0x4b3208(0x934),_0x3bfac3[_0x4b3208(0x1be)]='',_0x5971e5[_0x4b3208(0x1be)]='',_0x380005[_0x4b3208(0x2a3)]=!![];_0x3f0f54[_0x4b3208(0x119a)][_0x4b3208(0xbff)](_0x4b3208(0x106d));}async function _0x230241(){const _0x2554ae=_0x549949,_0x92c290=document[_0x2554ae(0x383)](_0x2554ae(0x1100))[_0x2554ae(0x1be)][_0x2554ae(0x1cb)](),_0x311129=document[_0x2554ae(0x383)](_0x2554ae(0xf35))['value'][_0x2554ae(0x1cb)]();if(!_0x92c290||!_0x311129){alert(_0x2554ae(0x4e9));return;}try{new RegExp(_0x311129);}catch(_0x355e8f){alert('正则表达式格式错误:\x20'+_0x355e8f[_0x2554ae(0x5f8)]);return;}const _0x1aa1ec={'name':_0x92c290,'chatId':document['getElementById'](_0x2554ae(0xf5d))[_0x2554ae(0x1be)],'regex':_0x311129,'template':document['getElementById'](_0x2554ae(0xfd3))['value'],'isEnabled':document[_0x2554ae(0x383)](_0x2554ae(0x2b5))['checked']};_0x223e60?await _0x342df8['renderingRules'][_0x2554ae(0xaf9)](_0x223e60,_0x1aa1ec):await _0x342df8[_0x2554ae(0x929)][_0x2554ae(0xbff)](_0x1aa1ec),document[_0x2554ae(0x383)](_0x2554ae(0x68c))['classList']['remove'](_0x2554ae(0x106d)),await _0xa3d79d();}async function _0x2ec898(_0x8592b2){const _0x3a5cc6=_0x549949,_0x2fcf82=await _0x23a88b(_0x3a5cc6(0x1225),'确定要删除这条渲染规则吗？',{'confirmButtonClass':'btn-danger'});_0x2fcf82&&(await _0x342df8['renderingRules'][_0x3a5cc6(0x971)](_0x8592b2),await _0xa3d79d());}async function _0x63723d(_0x4d4e13,_0x25c75a){const _0x156218=_0x549949;if(_0x4d4e13['trim']()[_0x156218(0x1122)]('<')||!_0x4d4e13[_0x156218(0xee2)]('[')&&!_0x4d4e13['includes']('{'))return _0x4d4e13;const _0x273726=await _0x342df8[_0x156218(0x929)][_0x156218(0x6bd)](_0x156218(0xa65))['equals'](_0x156218(0x934))['or'](_0x156218(0xa65))[_0x156218(0x5b3)](_0x25c75a)[_0x156218(0x21f)]();let _0x1213a5=_0x4d4e13;for(const _0x1e1d5f of _0x273726['filter'](_0x377f3b=>_0x377f3b[_0x156218(0x122)])){try{const _0x38b989=new RegExp(_0x1e1d5f[_0x156218(0xfbc)],'g');_0x38b989[_0x156218(0xd73)](_0x1213a5)&&(_0x1213a5=_0x1213a5['replace'](_0x38b989,_0x1e1d5f[_0x156218(0xd7b)]));}catch(_0x229829){console['error'](_0x156218(0x12b)+_0x1e1d5f[_0x156218(0x461)]+_0x156218(0xd3b),_0x229829);}}return _0x1213a5;}async function _0x3d2653(){await _0xa3d79d(),_0x105acd('rendering-rules-screen');}async function _0xa3d79d(){const _0x51178a=_0x549949,_0xf34492=document['getElementById'](_0x51178a(0x4ff)),_0x4ad9f0=document[_0x51178a(0x383)](_0x51178a(0xa00));_0xf34492['innerHTML']='',_0x4ad9f0[_0x51178a(0x45c)]='';const _0x3817a1=await _0x342df8[_0x51178a(0x929)][_0x51178a(0x21f)]();if(_0x3817a1[_0x51178a(0xfde)]===0x0){_0x4ad9f0[_0x51178a(0x45c)]=_0x51178a(0x105a);return;}const _0x1da3e9=document[_0x51178a(0xe1b)]('button');_0x1da3e9['className']=_0x51178a(0x121b),_0x1da3e9[_0x51178a(0x138e)]=_0x51178a(0x8c0),_0x1da3e9['dataset'][_0x51178a(0xba3)]=_0x51178a(0x934),_0xf34492[_0x51178a(0xe91)](_0x1da3e9);const _0x5ab486=document['createElement'](_0x51178a(0x7fd));_0x5ab486['className']='rules-category-pane\x20active',_0x5ab486[_0x51178a(0x118)][_0x51178a(0xba3)]=_0x51178a(0x934),_0x4ad9f0[_0x51178a(0xe91)](_0x5ab486);const _0x43ac7a=Object[_0x51178a(0x76d)](_0x41df36['chats'])['filter'](_0x57d7e9=>!_0x57d7e9[_0x51178a(0x1a2)]&&_0x3817a1[_0x51178a(0x12fb)](_0x164385=>_0x164385[_0x51178a(0xa65)]===_0x57d7e9['id']));_0x43ac7a[_0x51178a(0x19c)](_0x5dbd54=>{const _0x219313=_0x51178a,_0x363ee9=document[_0x219313(0xe1b)](_0x219313(0x182));_0x363ee9[_0x219313(0x556)]=_0x219313(0x1db),_0x363ee9[_0x219313(0x138e)]=_0x5dbd54[_0x219313(0x461)],_0x363ee9['dataset'][_0x219313(0xba3)]=_0x5dbd54['id'],_0xf34492[_0x219313(0xe91)](_0x363ee9);const _0x38a8f6=document['createElement'](_0x219313(0x7fd));_0x38a8f6['className']=_0x219313(0x62f),_0x38a8f6[_0x219313(0x118)]['categoryId']=_0x5dbd54['id'],_0x4ad9f0[_0x219313(0xe91)](_0x38a8f6);}),_0x3817a1[_0x51178a(0x19c)](_0x58c258=>{const _0x2b4d46=_0x51178a,_0x468af5=_0x3d548d(_0x58c258),_0x11a17a=_0x4ad9f0[_0x2b4d46(0x89c)](_0x2b4d46(0xac9)+_0x58c258[_0x2b4d46(0xa65)]+'\x22]');_0x11a17a&&_0x11a17a[_0x2b4d46(0xe91)](_0x468af5);}),document['querySelectorAll'](_0x51178a(0x438))[_0x51178a(0x19c)](_0x425b32=>{const _0x57de2b=_0x51178a;_0x425b32[_0x57de2b(0x271)]('click',()=>_0x179abd(_0x425b32[_0x57de2b(0x118)]['categoryId']));});}function _0x3d548d(_0x5a247b){const _0x21afd8=_0x549949,_0x25515d=document[_0x21afd8(0xe1b)](_0x21afd8(0x7fd));return _0x25515d[_0x21afd8(0x556)]=_0x21afd8(0x168)+(_0x5a247b['isEnabled']?_0x21afd8(0x8e4):''),_0x25515d[_0x21afd8(0x118)][_0x21afd8(0x47c)]=_0x5a247b['id'],_0x25515d['innerHTML']=_0x21afd8(0x665)+_0x5a247b[_0x21afd8(0x461)]+_0x21afd8(0xc0f)+_0x5a247b[_0x21afd8(0xfbc)]+_0x21afd8(0xdf),_0x25515d['addEventListener'](_0x21afd8(0x5c7),()=>_0x1e94d8(_0x5a247b['id'])),_0x3e15d1(_0x25515d,()=>_0x2ec898(_0x5a247b['id'])),_0x25515d;}async function _0x1e94d8(_0x281eba=null){const _0x1bc484=_0x549949;_0x223e60=_0x281eba;const _0x573bc7=document[_0x1bc484(0x383)]('rule-editor-modal'),_0x4eeb67=document[_0x1bc484(0x383)]('rule-editor-title'),_0x5669e5=document['getElementById'](_0x1bc484(0x1100)),_0x56d6e9=document[_0x1bc484(0x383)](_0x1bc484(0xf5d)),_0x382610=document['getElementById'](_0x1bc484(0xf35)),_0x58c05f=document['getElementById'](_0x1bc484(0xfd3)),_0x17a626=document[_0x1bc484(0x383)](_0x1bc484(0x2b5));_0x56d6e9['innerHTML']=_0x1bc484(0x88c),Object[_0x1bc484(0x76d)](_0x41df36[_0x1bc484(0x864)])[_0x1bc484(0x98a)](_0x13b64b=>!_0x13b64b[_0x1bc484(0x1a2)])['forEach'](_0x1bec92=>{const _0x20c015=_0x1bc484;_0x56d6e9['innerHTML']+=_0x20c015(0x4a0)+_0x1bec92['id']+'\x22>'+_0x1bec92[_0x20c015(0x461)]+'</option>';});if(_0x281eba){_0x4eeb67[_0x1bc484(0x138e)]=_0x1bc484(0x1361);const _0x581fe0=await _0x342df8[_0x1bc484(0x929)][_0x1bc484(0x1a3)](_0x281eba);_0x5669e5['value']=_0x581fe0['name'],_0x56d6e9[_0x1bc484(0x1be)]=_0x581fe0[_0x1bc484(0xa65)],_0x382610['value']=_0x581fe0[_0x1bc484(0xfbc)],_0x58c05f['value']=_0x581fe0['template'],_0x17a626[_0x1bc484(0x2a3)]=_0x581fe0[_0x1bc484(0x122)];}else _0x4eeb67[_0x1bc484(0x138e)]=_0x1bc484(0x843),_0x5669e5[_0x1bc484(0x1be)]='',_0x56d6e9['value']=_0x1bc484(0x934),_0x382610[_0x1bc484(0x1be)]='',_0x58c05f[_0x1bc484(0x1be)]='',_0x17a626[_0x1bc484(0x2a3)]=!![];_0x573bc7['classList'][_0x1bc484(0xbff)](_0x1bc484(0x106d));}async function _0x230241(){const _0x91f4a=_0x549949,_0x5b7bc5=document[_0x91f4a(0x383)](_0x91f4a(0x1100))['value'][_0x91f4a(0x1cb)](),_0x2fadbb=document['getElementById']('rule-regex-input')[_0x91f4a(0x1be)]['trim']();if(!_0x5b7bc5||!_0x2fadbb){alert(_0x91f4a(0x4e9));return;}try{new RegExp(_0x2fadbb);}catch(_0x22813d){alert(_0x91f4a(0x314)+_0x22813d[_0x91f4a(0x5f8)]);return;}const _0x1d0fb2={'name':_0x5b7bc5,'chatId':document[_0x91f4a(0x383)]('rule-chat-id-select')['value'],'regex':_0x2fadbb,'template':document[_0x91f4a(0x383)]('rule-template-input')[_0x91f4a(0x1be)],'isEnabled':document['getElementById']('rule-enabled-switch')[_0x91f4a(0x2a3)]};_0x223e60?await _0x342df8[_0x91f4a(0x929)][_0x91f4a(0xaf9)](_0x223e60,_0x1d0fb2):await _0x342df8[_0x91f4a(0x929)][_0x91f4a(0xbff)](_0x1d0fb2),document['getElementById'](_0x91f4a(0x68c))[_0x91f4a(0x119a)]['remove']('visible'),await _0xa3d79d();}async function _0x2ec898(_0x45d21b){const _0x4e0ab1=_0x549949,_0x39eaa5=await _0x23a88b(_0x4e0ab1(0x1225),_0x4e0ab1(0x591),{'confirmButtonClass':'btn-danger'});_0x39eaa5&&(await _0x342df8['renderingRules'][_0x4e0ab1(0x971)](_0x45d21b),await _0xa3d79d());}async function _0x63723d(_0x2414f5,_0x5f2b8e){const _0x4bd762=_0x549949;if(_0x2414f5[_0x4bd762(0x1cb)]()[_0x4bd762(0x1122)]('<')||!_0x2414f5['includes']('[')&&!_0x2414f5[_0x4bd762(0xee2)]('{'))return _0x2414f5;if(!_0x30d5f3[_0x5f2b8e]){console['log'](_0x4bd762(0x12bf)+_0x5f2b8e);const _0x2d2613=await _0x342df8[_0x4bd762(0x929)][_0x4bd762(0x6bd)](_0x4bd762(0xa65))['equals'](_0x4bd762(0x934))['or'](_0x4bd762(0xa65))[_0x4bd762(0x5b3)](_0x5f2b8e)[_0x4bd762(0x21f)]();_0x30d5f3[_0x5f2b8e]=_0x2d2613[_0x4bd762(0x98a)](_0x106ebc=>_0x106ebc[_0x4bd762(0x122)]);}const _0x4a9dc9=_0x30d5f3[_0x5f2b8e];let _0x56d08c=_0x2414f5;for(const _0x3bcefb of _0x4a9dc9){try{const _0x2c656a=new RegExp(_0x3bcefb[_0x4bd762(0xfbc)],'g');let _0x45d01a=_0x56d08c;_0x2c656a[_0x4bd762(0xd73)](_0x45d01a)&&(_0x56d08c=_0x56d08c[_0x4bd762(0x709)](_0x2c656a,_0x3bcefb['template']));}catch(_0x5401a1){console[_0x4bd762(0x98)](_0x4bd762(0x12b)+_0x3bcefb[_0x4bd762(0x461)]+_0x4bd762(0xd3b),_0x5401a1);}}return _0x56d08c;}function _0x570142(_0x1f264f){const _0x521de6=_0x549949;if(!_0x1f264f)return'';const _0x193e43=new Date(),_0x10fc27=new Date(_0x1f264f),_0x4cec38=String(_0x10fc27[_0x521de6(0x793)]())[_0x521de6(0xf20)](0x2,'0'),_0x5b79e6=String(_0x10fc27[_0x521de6(0xa28)]())[_0x521de6(0xf20)](0x2,'0'),_0x15b305=_0x4cec38+':'+_0x5b79e6;if(_0x193e43[_0x521de6(0x37f)]()===_0x10fc27['toDateString']())return _0x15b305;const _0x15e4ac=new Date();_0x15e4ac[_0x521de6(0x276)](_0x193e43[_0x521de6(0xb29)]()-0x1);if(_0x15e4ac[_0x521de6(0x37f)]()===_0x10fc27[_0x521de6(0x37f)]())return _0x521de6(0x39f)+_0x15b305;const _0x1c7292=_0x10fc27[_0x521de6(0xdf9)](),_0x15c15b=String(_0x10fc27['getMonth']()+0x1)['padStart'](0x2,'0'),_0x56d1ab=String(_0x10fc27[_0x521de6(0xb29)]())[_0x521de6(0xf20)](0x2,'0');return _0x193e43[_0x521de6(0xdf9)]()===_0x1c7292?_0x15c15b+'月'+_0x56d1ab+'日\x20'+_0x15b305:_0x1c7292+'年'+_0x15c15b+'月'+_0x56d1ab+'日\x20'+_0x15b305;}function _0x49e7d1(_0x47565c){const _0x2b95b5=_0x549949,_0x253476=document['createElement'](_0x2b95b5(0x7fd));_0x253476[_0x2b95b5(0x556)]=_0x2b95b5(0x6bf);const _0x4ff44a=document[_0x2b95b5(0xe1b)](_0x2b95b5(0x7fd));return _0x4ff44a['className']='message-bubble\x20system-bubble',_0x4ff44a[_0x2b95b5(0x138e)]=_0x570142(_0x47565c),_0x253476[_0x2b95b5(0xe91)](_0x4ff44a),_0x253476;}async function _0x480b3a(){const _0x62e2fa=_0x549949,_0x726033=_0x41df36['chats'][_0x41df36[_0x62e2fa(0xfc5)]];if(!_0x726033||!lastResponseTimestamps||lastResponseTimestamps[_0x62e2fa(0xfde)]===0x0){alert('没有可供重新生成的AI响应。');return;}_0x726033[_0x62e2fa(0xd08)]=_0x726033[_0x62e2fa(0xd08)][_0x62e2fa(0x98a)](_0x44ea40=>!lastResponseTimestamps[_0x62e2fa(0xee2)](_0x44ea40[_0x62e2fa(0x3b7)])),await _0x342df8['chats'][_0x62e2fa(0x9c0)](_0x726033),await _0x409076(_0x41df36[_0x62e2fa(0xfc5)]),_0x41e5ce();}async function _0x34e023(){const _0x42c58a=_0x549949,_0x5f3a55=_0x41df36[_0x42c58a(0x864)][_0x41df36[_0x42c58a(0xfc5)]];if(!_0x5f3a55)return;const _0x32828e=_0x5f3a55[_0x42c58a(0xd08)][_0x42c58a(0xdef)](_0x3f7d6b=>_0x3f7d6b['role']===_0x42c58a(0x66e)&&!_0x3f7d6b[_0x42c58a(0xbc5)]);if(_0x32828e===-0x1){alert(_0x42c58a(0x5c3));return;}const _0x271768=_0x5f3a55[_0x42c58a(0xd08)][_0x42c58a(0xdef)](_0x3b716f=>_0x3b716f[_0x42c58a(0x10ff)]===_0x42c58a(0xf3c));if(_0x271768<_0x32828e){alert(_0x42c58a(0x8c5));return;}_0x5f3a55[_0x42c58a(0xd08)][_0x42c58a(0x2f1)](_0x32828e+0x1),await _0x342df8[_0x42c58a(0x864)][_0x42c58a(0x9c0)](_0x5f3a55),await _0x409076(_0x41df36['activeChatId']),await _0x11e743();}async function _0x18efd8(){const _0x3ff8e8=_0x549949;if(!_0x4f60f2[_0x3ff8e8(0x40d)])return;const _0x2a9f53=_0x4f60f2[_0x3ff8e8(0x1184)][_0x3ff8e8(0xdef)](_0x19961c=>_0x19961c[_0x3ff8e8(0x10ff)]==='user');if(_0x2a9f53===-0x1){alert(_0x3ff8e8(0x10fa));return;}_0x4f60f2[_0x3ff8e8(0x1184)][_0x3ff8e8(0x2f1)](_0x2a9f53+0x1);const _0x4e73ec=document[_0x3ff8e8(0x383)](_0x3ff8e8(0xeca));_0x4e73ec[_0x3ff8e8(0x45c)]='',_0x4f60f2[_0x3ff8e8(0x1184)][_0x3ff8e8(0x19c)](_0x545d28=>{const _0x5387fb=_0x3ff8e8,_0x1b99ef=document[_0x5387fb(0xe1b)](_0x5387fb(0x7fd));_0x1b99ef[_0x5387fb(0x556)]='call-message-bubble\x20'+_0x545d28[_0x5387fb(0x10ff)]+_0x5387fb(0xe26),_0x1b99ef[_0x5387fb(0x118)][_0x5387fb(0x3b7)]=_0x545d28['timestamp'],_0x545d28[_0x5387fb(0x10ff)]===_0x5387fb(0x66e)?_0x1b99ef['textContent']=_0x545d28['content']:_0x1b99ef['innerHTML']=_0x545d28[_0x5387fb(0x11b6)],_0x3e15d1(_0x1b99ef,()=>_0x55a6de(_0x545d28['timestamp'])),_0x4e73ec[_0x5387fb(0xe91)](_0x1b99ef);}),_0x4e73ec[_0x3ff8e8(0x4f9)]=_0x4e73ec['scrollHeight'],_0x2928c4(null);}async function _0x3b849a(){const _0x5b91a7=_0x549949,_0x205e22=_0x41df36[_0x5b91a7(0x864)][_0x41df36[_0x5b91a7(0xfc5)]];if(!_0x205e22)return;_0x2f64f8(_0x205e22['id'],!![]);const _0x3b1a3e=document['getElementById'](_0x5b91a7(0x969));!_0x205e22['isGroup']&&(_0x3b1a3e[_0x5b91a7(0x655)][_0x5b91a7(0x10ec)]=0x0,setTimeout(()=>{const _0x2755ed=_0x5b91a7;_0x3b1a3e[_0x2755ed(0x138e)]=_0x2755ed(0xefa),_0x3b1a3e[_0x2755ed(0x119a)][_0x2755ed(0xbff)](_0x2755ed(0x9a5)),_0x3b1a3e[_0x2755ed(0x655)][_0x2755ed(0x10ec)]=0x1;},0xc8));try{const {proxyUrl:_0x136b89,apiKey:_0x54c450,model:_0x4328d5}=_0x41df36['apiConfig'];if(!_0x136b89||!_0x54c450||!_0x4328d5)throw new Error(_0x5b91a7(0x3f1));const _0x29ccc6=parseInt(_0x205e22[_0x5b91a7(0x886)][_0x5b91a7(0x1138)])||0xa,_0x3ff544=_0x205e22[_0x5b91a7(0xd08)][_0x5b91a7(0x1368)](-_0x29ccc6),_0x38fe0e=new Date(),_0x29ddf4=new Date(_0x38fe0e[_0x5b91a7(0x24b)]()+_0x38fe0e['getTimezoneOffset']()*0xea60+0x36ee80*0x8),_0x376763=_0x29ddf4['toLocaleString'](_0x5b91a7(0xafb),{'timeZone':_0x5b91a7(0xc36),'dateStyle':_0x5b91a7(0xd96),'timeStyle':_0x5b91a7(0xfc1)}),_0x10e85e=_0x1ccf3f(_0x29ddf4),_0x1f37bf=_0x205e22['settings'][_0x5b91a7(0x52e)]||'我';let _0x289ec5='';if(_0x205e22['settings'][_0x5b91a7(0xe8c)]&&_0x205e22['settings'][_0x5b91a7(0xe8c)]['length']>0x0){const _0x1a0721=_0x205e22[_0x5b91a7(0x886)][_0x5b91a7(0xe8c)][_0x5b91a7(0xa79)](_0x365076=>{const _0x4747ce=_0x5b91a7,_0x484a2f=_0x41df36[_0x4747ce(0xf17)][_0x4747ce(0xd12)](_0xe51eb5=>_0xe51eb5['id']===_0x365076);if(!_0x484a2f||!Array[_0x4747ce(0x565)](_0x484a2f[_0x4747ce(0x11b6)]))return'';const _0x591358=_0x484a2f[_0x4747ce(0x11b6)]['filter'](_0x1f3d2d=>_0x1f3d2d[_0x4747ce(0x8e4)]!==![])[_0x4747ce(0xa79)](_0x5dce70=>{const _0x538aa0=_0x4747ce;let _0x3e995e=_0x538aa0(0xc6a)+(_0x5dce70['comment']||_0x538aa0(0x138b))+'\x0a';if(_0x5dce70[_0x538aa0(0x66b)][_0x538aa0(0xfde)]>0x0)_0x3e995e+=_0x538aa0(0x3dc)+_0x5dce70['keys'][_0x538aa0(0xa35)](',\x20')+'\x0a';return _0x3e995e+=_0x538aa0(0x37e)+_0x5dce70['content'],_0x3e995e;})[_0x4747ce(0xa35)]('');return _0x591358?'\x0a\x0a##\x20世界书:\x20'+_0x484a2f[_0x4747ce(0x461)]+'\x0a'+_0x591358:'';})['filter'](Boolean)['join']('');_0x1a0721&&(_0x289ec5=_0x5b91a7(0xec1)+_0x1a0721+_0x5b91a7(0x84f));}let _0x5e7f9e='';if(_0x40e606[_0x5b91a7(0x40d)]&&_0x40e606[_0x5b91a7(0xfc5)]===_0x205e22['id']){const _0x25d0cc=_0x40e606['currentIndex']>-0x1?_0x40e606[_0x5b91a7(0x91b)][_0x40e606[_0x5b91a7(0xb2c)]]:null;_0x5e7f9e=_0x5b91a7(0xbef);}const _0x26dca7=_0x4e577c(_0x35c099[_0x205e22['id']]);let _0x2b50c8='';_0x205e22[_0x5b91a7(0xcf9)]&&_0x205e22['nameHistory'][_0x5b91a7(0xfde)]>0x0&&(_0x2b50c8=_0x5b91a7(0xe10)+_0x205e22['nameHistory'][_0x5b91a7(0xa35)](',\x20')+']。当在对话历史中看到这些名字时，它们都指的是【你】自己。');let _0x307e3e='';const _0x18054b=_0x41df36['qzoneSettings'][_0x5b91a7(0xabb)]||'用户';_0x307e3e+=_0x5b91a7(0x1220)+_0x18054b+_0x5b91a7(0x746);const _0x13c8dc=Object[_0x5b91a7(0x76d)](_0x41df36[_0x5b91a7(0x864)])[_0x5b91a7(0x98a)](_0x922ce=>_0x922ce[_0x5b91a7(0x1a2)]&&_0x922ce[_0x5b91a7(0x12a6)][_0x5b91a7(0x12fb)](_0xe2704d=>_0xe2704d['id']===_0x205e22['id']));_0x13c8dc[_0x5b91a7(0xfde)]>0x0&&(_0x307e3e+='-\x20用户在你们共同所在的群聊中的昵称如下：\x0a',_0x13c8dc[_0x5b91a7(0x19c)](_0x4f7fb2=>{const _0x53382b=_0x5b91a7,_0x5d526=_0x4f7fb2['settings'][_0x53382b(0x52e)]||_0x18054b;_0x307e3e+=_0x53382b(0xa06)+_0x4f7fb2[_0x53382b(0x461)]+_0x53382b(0xc34)+_0x5d526+_0x53382b(0xf1a);}));_0x307e3e+=_0x5b91a7(0x7cd);const _0x3ccbb6=_0xd83680(_0x205e22),_0x49ceb4=_0x5b91a7(0xfaa)+_0x205e22[_0x5b91a7(0x283)]+_0x5b91a7(0x7f2)+_0x376763+'\x20('+_0x10e85e+_0x5b91a7(0xd15)+(_0x5e7f9e?_0x5b91a7(0x628)+_0x5e7f9e:_0x5b91a7(0xbce))+_0x5b91a7(0x3f6)+(_0x205e22['longTermMemory']&&_0x205e22[_0x5b91a7(0x1349)][_0x5b91a7(0xfde)]>0x0?_0x205e22[_0x5b91a7(0x1349)]['map'](_0x450188=>'-\x20'+_0x450188['content'])[_0x5b91a7(0xa35)]('\x0a'):'-\x20(暂无)')+_0x5b91a7(0xc24)+_0x205e22['settings'][_0x5b91a7(0xd83)]+_0x5b91a7(0x9e7)+_0x205e22[_0x5b91a7(0x283)]+'\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22'+_0x205e22[_0x5b91a7(0x461)]+_0x5b91a7(0x112a)+_0x1f37bf+_0x5b91a7(0x8c9)+_0x307e3e+_0x5b91a7(0xbf5)+_0x2b50c8+'\x0a\x20\x20\x20\x20'+_0x289ec5+'\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20'+_0x3ccbb6+_0x5b91a7(0x8c3)+(_0x205e22[_0x5b91a7(0x886)][_0x5b91a7(0x7fa)]&&_0x205e22[_0x5b91a7(0x886)][_0x5b91a7(0x7fa)][_0x5b91a7(0xfde)]>0x0?_0x205e22[_0x5b91a7(0x886)][_0x5b91a7(0x7fa)]['map'](_0x52f0e3=>'-\x20'+_0x52f0e3[_0x5b91a7(0x461)])[_0x5b91a7(0xa35)]('\x0a'):_0x5b91a7(0x523))+_0x5b91a7(0x6c3)+(_0x205e22['settings'][_0x5b91a7(0xa7)]&&_0x205e22['settings'][_0x5b91a7(0xa7)][_0x5b91a7(0xfde)]>0x0?_0x205e22[_0x5b91a7(0x886)][_0x5b91a7(0xa7)]['map'](_0x5c45d7=>'-\x20'+_0x5c45d7[_0x5b91a7(0x461)])['join']('\x0a'):_0x5b91a7(0x523))+_0x5b91a7(0x898)+_0x205e22[_0x5b91a7(0x886)][_0x5b91a7(0xe63)]+_0x5b91a7(0xd92),_0x366a37=_0x3ff544[_0x5b91a7(0xa79)](_0xa7ff73=>({'role':_0xa7ff73[_0x5b91a7(0x10ff)],'content':String(_0xa7ff73[_0x5b91a7(0x11b6)])}));_0x366a37[_0x5b91a7(0x258)]({'role':_0x5b91a7(0x66e),'content':_0x5b91a7(0x684)});let _0x236932=_0x136b89===GEMINI_API_URL,_0x1dee14=_0x112768(_0x4328d5,_0x54c450,_0x49ceb4,_0x366a37);const _0x10350d=_0x236932?await fetch(_0x1dee14[_0x5b91a7(0x2fa)],_0x1dee14[_0x5b91a7(0x8c6)]):await fetch(_0x136b89+_0x5b91a7(0x126b),{'method':'POST','headers':{'Content-Type':_0x5b91a7(0x11f0),'Authorization':_0x5b91a7(0xd55)+_0x54c450},'body':JSON[_0x5b91a7(0x3fb)]({'model':_0x4328d5,'messages':[{'role':_0x5b91a7(0xb1),'content':_0x49ceb4},..._0x366a37],'temperature':_0x41df36[_0x5b91a7(0xc0)][_0x5b91a7(0xa4a)]||0.8})});if(!_0x10350d['ok']){const _0x157997=await _0x10350d[_0x5b91a7(0x9b3)]();throw new Error(_0x5b91a7(0xb83)+_0x157997[_0x5b91a7(0x98)]['message']);}const _0x331747=await _0x10350d[_0x5b91a7(0x9b3)](),_0x3dfe22=getGeminiResponseText(_0x331747),_0xae29ff=_0x28b8fa(_0x3dfe22),_0xdcb4f9=[];for(const _0x2c22fe of _0xae29ff){if(_0x2c22fe[_0x5b91a7(0xa6b)]===_0x5b91a7(0x6af)&&typeof _0x2c22fe[_0x5b91a7(0x11b6)]===_0x5b91a7(0xafa)&&_0x2c22fe[_0x5b91a7(0x11b6)]['includes']('\x0a')){const _0x28ba6c=_0x2c22fe[_0x5b91a7(0x11b6)]['split'](/\n+/)[_0x5b91a7(0x98a)](_0x2fad06=>_0x2fad06[_0x5b91a7(0x1cb)]());_0x28ba6c['forEach'](_0x453e2c=>{const _0x621e17=_0x5b91a7;_0xdcb4f9[_0x621e17(0x258)]({..._0x2c22fe,'content':_0x453e2c});});}else _0xdcb4f9[_0x5b91a7(0x258)](_0x2c22fe);}let _0x504117=Date[_0x5b91a7(0x108d)]();for(const _0x52c4eb of _0xdcb4f9){const _0x27af87={'role':'assistant','senderName':_0x205e22[_0x5b91a7(0x283)],'timestamp':_0x504117++,'content':_0x52c4eb[_0x5b91a7(0x11b6)]||_0x52c4eb[_0x5b91a7(0x5f8)],'type':_0x52c4eb[_0x5b91a7(0xa6b)]||_0x5b91a7(0x6af)};if(_0x52c4eb[_0x5b91a7(0xa6b)]===_0x5b91a7(0xf0b)){if(!_0x205e22['isGroup']){if(_0x52c4eb[_0x5b91a7(0x2a6)])_0x205e22[_0x5b91a7(0xa52)]=String(_0x52c4eb[_0x5b91a7(0x2a6)]);if(_0x52c4eb['random_jottings'])_0x205e22[_0x5b91a7(0xc2b)]=String(_0x52c4eb[_0x5b91a7(0xf25)]);}continue;}_0x205e22['history'][_0x5b91a7(0x258)](_0x27af87),_0x323467(_0x27af87,_0x205e22),await new Promise(_0x2900ff=>setTimeout(_0x2900ff,Math[_0x5b91a7(0x5ce)]()*0x3e8+0x320));}await _0x342df8[_0x5b91a7(0x864)][_0x5b91a7(0x9c0)](_0x205e22),_0x25558e();}catch(_0x5a9d58){console[_0x5b91a7(0x98)](_0x5b91a7(0x1fa),_0x5a9d58),await _0x296ef9(_0x5b91a7(0xa55),_0x5b91a7(0x1345)+_0x5a9d58[_0x5b91a7(0x5f8)]);}finally{_0x2f64f8(_0x205e22['id'],![]);if(!_0x205e22[_0x5b91a7(0x1a2)]&&document[_0x5b91a7(0x383)]('chat-header-title')){const _0x38a166=document['getElementById'](_0x5b91a7(0x969));_0x38a166['style'][_0x5b91a7(0x10ec)]=0x0,setTimeout(()=>{const _0x515982=_0x5b91a7;_0x38a166['textContent']=_0x205e22['name'],_0x38a166['classList'][_0x515982(0x131d)](_0x515982(0x9a5)),_0x38a166[_0x515982(0x655)]['opacity']=0x1;},0xc8);}}}function _0x1d7250(){const _0x4f9a62=_0x549949,_0x42c47b=document['getElementById'](_0x4f9a62(0x5e0)),_0x3a6e97=_0x41df36[_0x4f9a62(0xc0)][_0x4f9a62(0x11ce)]||_0x39eb4d;_0x3a6e97&&_0x3a6e97[_0x4f9a62(0x1cb)]()&&(_0x42c47b[_0x4f9a62(0xf6c)]=_0x3a6e97,_0x42c47b[_0x4f9a62(0x554)]()[_0x4f9a62(0xa27)](_0xada5b9=>console[_0x4f9a62(0xe72)]('播放被中断，这是正常行为:',_0xada5b9)));}function _0x5140bf(){const _0x12d9e3=_0x549949;if(!_0x41df36[_0x12d9e3(0xc0)][_0x12d9e3(0x5ec)])return;for(const _0x15c41c in _0x41df36[_0x12d9e3(0xc0)]['widgetData']){const _0x5ae8a3=document[_0x12d9e3(0x383)](_0x15c41c),_0x400d78=_0x41df36[_0x12d9e3(0xc0)][_0x12d9e3(0x5ec)][_0x15c41c];_0x5ae8a3&&(_0x5ae8a3[_0x12d9e3(0x597)]===_0x12d9e3(0x56d)?_0x5ae8a3['src']=_0x400d78:_0x5ae8a3[_0x12d9e3(0x138e)]=_0x400d78);}}function _0x20227a(){return new Promise(_0x438b83=>{const _0x324978=_0x42ed,_0x4da37f=document[_0x324978(0xe1b)]('input');_0x4da37f[_0x324978(0xa6b)]='file',_0x4da37f['accept']=_0x324978(0x1195),_0x4da37f['onchange']=_0x373098=>{const _0x24561a=_0x324978,_0x1642d7=_0x373098[_0x24561a(0xfab)]['files'][0x0];if(_0x1642d7){const _0xe2f80e=new FileReader();_0xe2f80e['onload']=_0x3599ac=>{const _0x253c41=_0x24561a;_0x438b83(_0x3599ac[_0x253c41(0xfab)][_0x253c41(0xa86)]);},_0xe2f80e[_0x24561a(0x132a)](_0x1642d7);}else _0x438b83(null);},_0x4da37f[_0x324978(0x5c7)]();});}async function _0x6a249b(_0x546b2d){const _0x5f5e8e=_0x549949,_0x2a5af7=_0x546b2d['id'],_0x1ffafd=_0x546b2d['textContent'],_0x1b0444=await _0x12e332(_0x5f5e8e(0x4ef),_0x5f5e8e(0x10ac),_0x1ffafd);if(_0x1b0444!==null&&_0x1b0444['trim']()!==''){const _0x4dd6b6=_0x1b0444[_0x5f5e8e(0x1cb)]();_0x546b2d[_0x5f5e8e(0x138e)]=_0x4dd6b6,_0x41df36[_0x5f5e8e(0xc0)][_0x5f5e8e(0x5ec)][_0x2a5af7]=_0x4dd6b6,await _0x342df8['globalSettings'][_0x5f5e8e(0x9c0)](_0x41df36[_0x5f5e8e(0xc0)]),alert('文字已更新！');}}async function _0x5f4bc1(_0x390760){const _0x28a7fb=_0x549949,_0x3e69e1=_0x390760['id'],_0x50f271=await _0x2d60a4(_0x28a7fb(0x1bf),[{'text':_0x28a7fb(0x107c),'value':_0x28a7fb(0x30b)},{'text':_0x28a7fb(0xc61),'value':_0x28a7fb(0x2fa)}]);let _0x4c9fec=null;if(_0x50f271===_0x28a7fb(0x30b))_0x4c9fec=await _0x20227a();else _0x50f271===_0x28a7fb(0x2fa)&&(_0x4c9fec=await _0x12e332(_0x28a7fb(0x1bf),'请输入新的图片URL：',_0x390760['src'],_0x28a7fb(0x2fa)));if(_0x4c9fec&&_0x4c9fec[_0x28a7fb(0x1cb)]()){const _0x311574=_0x4c9fec['trim']();_0x390760[_0x28a7fb(0xf6c)]=_0x311574,_0x41df36[_0x28a7fb(0xc0)][_0x28a7fb(0x5ec)][_0x3e69e1]=_0x311574,await _0x342df8[_0x28a7fb(0xc0)]['put'](_0x41df36[_0x28a7fb(0xc0)]),alert(_0x28a7fb(0xa3d));}else _0x50f271===_0x28a7fb(0x2fa)&&_0x4c9fec!==null&&alert(_0x28a7fb(0x8cb));}const _0x59c871={'getSongCache'(_0x4fafd2,_0x543a7b){const _0x38b473=_0x549949,_0x1747db=(_0x543a7b||_0x38b473(0x1282))+':'+_0x4fafd2;if(_0x41df36[_0x38b473(0x981)]&&_0x41df36[_0x38b473(0x981)][_0x38b473(0x388)]){const _0x1b203b=_0x41df36[_0x38b473(0x981)][_0x38b473(0x388)][_0x38b473(0x1a3)](_0x1747db);if(_0x1b203b&&Date['now']()-_0x1b203b['timestamp']<0x36ee80)return _0x1b203b[_0x38b473(0x8c6)];}return null;},'setSongCache'(_0x2922d6,_0x223dff,_0x2c92c0){const _0x5b7163=_0x549949,_0x9575a1=(_0x2c92c0||'all')+':'+_0x2922d6;if(!_0x41df36[_0x5b7163(0x981)])_0x41df36['cache']={};if(!_0x41df36[_0x5b7163(0x981)][_0x5b7163(0x388)])_0x41df36[_0x5b7163(0x981)][_0x5b7163(0x388)]=new Map();_0x41df36[_0x5b7163(0x981)][_0x5b7163(0x388)][_0x5b7163(0x5ba)](_0x9575a1,{'data':_0x223dff,'timestamp':Date[_0x5b7163(0x108d)]()});}};typeof Http_Get_External===_0x549949(0x89d)&&(window[_0x549949(0x116b)]=function(_0x4ee9a4){return new Promise(_0x3c5b20=>{const _0x341f94=_0x42ed;fetch(_0x4ee9a4)[_0x341f94(0x1c1)](_0x1b03d5=>_0x1b03d5[_0x341f94(0x9b3)]()['catch'](()=>_0x1b03d5[_0x341f94(0x6af)]()))[_0x341f94(0x1c1)](_0x3c5b20)[_0x341f94(0xa27)](()=>_0x3c5b20(null));});});async function _0x2f0d03(_0x240a57){return await Http_Get_External(_0x240a57);}function _0x306a54(_0x5cf4f3){return new Promise(_0x4a4938=>{const _0x2c442b=_0x42ed,_0x420ff9=new Audio();_0x420ff9[_0x2c442b(0x271)](_0x2c442b(0x98b),()=>_0x4a4938(!![]),{'once':!![]}),_0x420ff9['addEventListener'](_0x2c442b(0x98),()=>_0x4a4938(![]),{'once':!![]}),_0x420ff9[_0x2c442b(0xf6c)]=_0x5cf4f3;});}async function _0xb1347f(_0x56e3d8,_0x56849d){const _0x365f08=_0x549949;try{let _0xa6694f=_0x56e3d8[_0x365f08(0x709)](/\s/g,'');_0x56849d&&(_0xa6694f+='\x20'+_0x56849d['replace'](/\s/g,''));const _0x5451f3=_0x365f08(0xf3f)+encodeURIComponent(_0xa6694f);console[_0x365f08(0xe72)](_0x365f08(0x239),_0x5451f3);const _0x4bf574=await fetch(_0x5451f3);if(!_0x4bf574['ok'])throw new Error('API\x20请求失败，状态码:\x20'+_0x4bf574[_0x365f08(0x1fe)]);const _0x4cfd78=await _0x4bf574[_0x365f08(0x9b3)]();if(_0x4cfd78[_0x365f08(0x11ba)]!==0xc8||!_0x4cfd78[_0x365f08(0x8c6)]||_0x4cfd78[_0x365f08(0x8c6)][_0x365f08(0xfde)]===0x0)return console[_0x365f08(0xe72)](_0x365f08(0x111c),_0x4cfd78),[];return _0x4cfd78['data'][_0x365f08(0xa79)](_0x29d929=>({'name':_0x29d929['song'],'artist':_0x29d929[_0x365f08(0x805)],'id':_0x29d929['id'],'cover':_0x29d929[_0x365f08(0x1b2)]||_0x365f08(0x2a4),'source':_0x365f08(0x7af)}))[_0x365f08(0x1368)](0x0,0x1e);}catch(_0x5dcb98){return console[_0x365f08(0x98)](_0x365f08(0xaf0),_0x5dcb98),[];}}async function _0x36bd03(_0x59da6c){const _0x2900d6=_0x549949;try{_0x59da6c=_0x59da6c['replace'](/\s/g,'');const _0x206ca1=await _0x2f0d03(_0x2900d6(0x74a)+encodeURIComponent(_0x59da6c));if(!_0x206ca1?.[_0x2900d6(0x8c6)]?.[_0x2900d6(0xfde)])return[];return _0x206ca1[_0x2900d6(0x8c6)]['map'](_0x390319=>({'name':_0x390319['song'],'artist':_0x390319[_0x2900d6(0x805)],'id':_0x390319['id'],'cover':_0x390319[_0x2900d6(0x1b2)]||_0x2900d6(0x8ce),'source':_0x2900d6(0x10f1)}))[_0x2900d6(0x1368)](0x0,0x1e);}catch(_0x4e73d6){return console['error'](_0x2900d6(0x11d1),_0x4e73d6),[];}}async function _0x106987(){const _0x32f1e4=_0x549949,_0x4df3b0=await _0x12e332('搜索歌曲',_0x32f1e4(0x73e));if(!_0x4df3b0||!_0x4df3b0[_0x32f1e4(0x1cb)]())return;await _0x296ef9(_0x32f1e4(0x4a6),_0x32f1e4(0x232));let _0x4989d8=_0x4df3b0[_0x32f1e4(0x1cb)](),_0x433477='';if(_0x4df3b0[_0x32f1e4(0xee2)]('-')||_0x4df3b0[_0x32f1e4(0xee2)]('–')){const _0x3ed725=_0x4df3b0[_0x32f1e4(0x105d)](/[-–]/);_0x4989d8=_0x3ed725[0x0]['trim'](),_0x433477=_0x3ed725[_0x32f1e4(0x1368)](0x1)[_0x32f1e4(0xa35)]('\x20')[_0x32f1e4(0x1cb)]();}const [_0x11cdec,_0x43fbfd]=await Promise['all']([_0xb1347f(_0x4989d8,_0x433477),_0x36bd03(_0x4989d8)]),_0x15c3a8=[..._0x11cdec,..._0x43fbfd];if(_0x15c3a8['length']===0x0){await _0x296ef9(_0x32f1e4(0xca0),_0x32f1e4(0xc9b));return;}const _0x49227b=document[_0x32f1e4(0x383)]('music-search-results-modal'),_0x1055e5=document[_0x32f1e4(0x383)](_0x32f1e4(0x772));_0x1055e5['innerHTML']='',document[_0x32f1e4(0x383)](_0x32f1e4(0xa8))[_0x32f1e4(0x2a3)]=![],_0x15c3a8[_0x32f1e4(0x19c)](_0x35fcb0=>{const _0x4e0ead=_0x32f1e4,_0x261fe7=document[_0x4e0ead(0xe1b)](_0x4e0ead(0x7fd));_0x261fe7[_0x4e0ead(0x556)]=_0x4e0ead(0x840),_0x261fe7[_0x4e0ead(0x118)][_0x4e0ead(0x213)]=JSON[_0x4e0ead(0x3fb)](_0x35fcb0),_0x261fe7[_0x4e0ead(0x45c)]=_0x4e0ead(0xa45)+_0x35fcb0[_0x4e0ead(0x461)]+_0x4e0ead(0x8ad)+_0x35fcb0[_0x4e0ead(0x5d8)]+_0x4e0ead(0xcd5)+(_0x35fcb0[_0x4e0ead(0xd24)]==='netease'?_0x4e0ead(0xbe4):_0x4e0ead(0x86e))+_0x4e0ead(0xaa3),_0x1055e5['appendChild'](_0x261fe7);}),_0x49227b['classList'][_0x32f1e4(0xbff)]('visible');}async function _0x132912(_0x46d5c3){const _0x5a01b9=_0x549949;let _0x345075=null,_0x50568b=_0x46d5c3['source'];const _0x195ce2=_0x46d5c3[_0x5a01b9(0xd24)]===_0x5a01b9(0x7af)?_0x5a01b9(0x2bf)+_0x46d5c3['id']:_0x5a01b9(0xfd7)+_0x46d5c3['id'];let _0x463a12=await _0x2f0d03(_0x195ce2);_0x463a12?.[_0x5a01b9(0x8c6)]?.[_0x5a01b9(0x2fa)]&&(_0x345075={'url':_0x463a12['data']['url'],'id':_0x46d5c3['id'],'source':_0x46d5c3[_0x5a01b9(0xd24)]});if(!_0x345075){const _0x596cfa=_0x46d5c3[_0x5a01b9(0xd24)]===_0x5a01b9(0x7af)?_0x5a01b9(0x10f1):_0x5a01b9(0x7af),_0x569770=_0x596cfa===_0x5a01b9(0x10f1)?await _0x36bd03(_0x46d5c3[_0x5a01b9(0x461)]):await _0xb1347f(_0x46d5c3[_0x5a01b9(0x461)],_0x46d5c3[_0x5a01b9(0x5d8)]);if(_0x569770[_0x5a01b9(0xfde)]>0x0){const _0x37bcb3=_0x596cfa===_0x5a01b9(0x7af)?'https://api.vkeys.cn/v2/music/netease?id='+_0x569770[0x0]['id']:_0x5a01b9(0xfd7)+_0x569770[0x0]['id'],_0x1f3972=await _0x2f0d03(_0x37bcb3);_0x1f3972?.['data']?.[_0x5a01b9(0x2fa)]&&(_0x345075={'url':_0x1f3972[_0x5a01b9(0x8c6)][_0x5a01b9(0x2fa)],'id':_0x569770[0x0]['id'],'source':_0x596cfa},_0x50568b=_0x596cfa);}}if(_0x345075){_0x345075[_0x5a01b9(0x2fa)]&&typeof _0x345075[_0x5a01b9(0x2fa)]===_0x5a01b9(0xafa)&&(_0x345075['url']=_0x345075[_0x5a01b9(0x2fa)]['replace'](/^http:\/\//i,_0x5a01b9(0xf21)));_0x46d5c3['cover']&&typeof _0x46d5c3[_0x5a01b9(0x1b2)]==='string'&&(_0x46d5c3[_0x5a01b9(0x1b2)]=_0x46d5c3[_0x5a01b9(0x1b2)][_0x5a01b9(0x709)](/^http:\/\//i,_0x5a01b9(0xf21)));const _0x202e8a=await _0xe74821(_0x345075['id'],_0x50568b)||'';return{'name':_0x46d5c3[_0x5a01b9(0x461)],'artist':_0x46d5c3[_0x5a01b9(0x5d8)],'src':_0x345075[_0x5a01b9(0x2fa)],'cover':_0x46d5c3[_0x5a01b9(0x1b2)],'isLocal':![],'lrcContent':_0x202e8a};}return null;}async function _0xe74821(_0x59e537,_0x1af4f0){const _0x228795=_0x549949,_0x28ed85=_0x1af4f0===_0x228795(0x7af)?_0x228795(0x11b0)+_0x59e537:'https://api.vkeys.cn/v2/music/tencent/lyric?id='+_0x59e537,_0x58a63e=await _0x2f0d03(_0x28ed85);if(_0x58a63e?.[_0x228795(0x8c6)]){const _0x4fe290=_0x58a63e[_0x228795(0x8c6)][_0x228795(0xbca)]||_0x58a63e[_0x228795(0x8c6)][_0x228795(0xd2d)]||'',_0x3c8718=_0x58a63e['data'][_0x228795(0xab)]||_0x58a63e[_0x228795(0x8c6)][_0x228795(0xf48)]||'';return _0x4fe290+'\x0a'+_0x3c8718;}return'';}async function _0x5f0f67(_0x26e0bd){const _0x4d112c=_0x549949;if(_0x26e0bd<0x0||_0x26e0bd>=_0x40e606[_0x4d112c(0x91b)][_0x4d112c(0xfde)])return;const _0x44ae42=await _0x2d60a4(_0x4d112c(0x566),[{'text':_0x4d112c(0xb7c),'value':_0x4d112c(0xbe7)},{'text':'📋\x20直接粘贴歌词文本','value':_0x4d112c(0x380)}]);let _0xe91f1b=null;if(_0x44ae42===_0x4d112c(0xbe7))_0xe91f1b=await new Promise(_0x407562=>{const _0xfbb103=_0x4d112c,_0x5f39bc=document['getElementById']('lrc-upload-input'),_0x344915=_0x4083dd=>{const _0x1211d2=_0x42ed,_0x2b08dd=_0x4083dd[_0x1211d2(0xfab)][_0x1211d2(0x1185)][0x0];if(_0x2b08dd){const _0xb7ebe1=new FileReader();_0xb7ebe1['onload']=_0x5ce727=>_0x407562(_0x5ce727[_0x1211d2(0xfab)][_0x1211d2(0xa86)]),_0xb7ebe1['onerror']=()=>_0x407562(null),_0xb7ebe1[_0x1211d2(0x10cb)](_0x2b08dd);}else _0x407562(null);_0x5f39bc[_0x1211d2(0xb04)](_0x1211d2(0x173),_0x344915),_0x5f39bc[_0x1211d2(0x1be)]='';};_0x5f39bc['addEventListener'](_0xfbb103(0x173),_0x344915,{'once':!![]}),_0x5f39bc[_0xfbb103(0x5c7)]();});else{if(_0x44ae42==='paste'){const _0x1dc659=await _0x12e332(_0x4d112c(0xd53),_0x4d112c(0x2e5),'',_0x4d112c(0xfe5));if(_0x1dc659)_0xe91f1b=_0x1dc659[_0x4d112c(0x709)](/\[/g,'\x0a[')[_0x4d112c(0x1cb)]();}}_0xe91f1b!==null&&(_0x40e606[_0x4d112c(0x91b)][_0x26e0bd][_0x4d112c(0x1065)]=_0xe91f1b,await _0x534851(),_0x40e606['currentIndex']===_0x26e0bd&&(_0x40e606[_0x4d112c(0x6ed)]=_0x2a7b2e(_0xe91f1b),_0x234ea1(),_0x4b003f()),await _0x296ef9('成功','《'+_0x40e606[_0x4d112c(0x91b)][_0x26e0bd][_0x4d112c(0x461)]+_0x4d112c(0xed4)));}async function _0x1d2975(){const _0x2c60cf=_0x549949;if(_0x40e606[_0x2c60cf(0xb2c)]===-0x1)return;const _0x413076=_0x40e606[_0x2c60cf(0x91b)][_0x40e606[_0x2c60cf(0xb2c)]];if(!_0x413076)return;_0x413076[_0x2c60cf(0x11ca)]=!_0x413076['isBgClear'],await _0x534851();const _0x11e712=document['querySelector'](_0x2c60cf(0xc37)),_0x5862b8=document[_0x2c60cf(0x383)](_0x2c60cf(0xd5c));_0x11e712[_0x2c60cf(0x119a)][_0x2c60cf(0x8f0)](_0x2c60cf(0x1392),_0x413076[_0x2c60cf(0x11ca)]),_0x5862b8[_0x2c60cf(0x119a)][_0x2c60cf(0x8f0)](_0x2c60cf(0xde5),_0x413076[_0x2c60cf(0x11ca)]);}function _0x3b0576(){const _0x3be047=_0x549949,_0x3867fb=document[_0x3be047(0x383)](_0x3be047(0x568)),_0x5630da=document['getElementById'](_0x3be047(0x6cc));_0x3867fb&&_0x5630da&&(_0x3867fb[_0x3be047(0x119a)]['toggle']('visible'),_0x5630da['classList'][_0x3be047(0x8f0)](_0x3be047(0xde5)));}function _0x4d5ea8(){const _0x3d178e=_0x549949,_0x37f7df=document[_0x3d178e(0x89c)](_0x3d178e(0xc37)),_0x108054=document[_0x3d178e(0x383)](_0x3d178e(0xdab));_0x37f7df&&_0x108054&&(_0x37f7df['classList'][_0x3d178e(0x8f0)](_0x3d178e(0xf8)),_0x108054[_0x3d178e(0x119a)][_0x3d178e(0x8f0)](_0x3d178e(0x7c3)));}window[_0x549949(0xdeb)]=_0x4d5ea8;async function _0x5ae690(){const _0xde308a=_0x549949;if(_0x40e606[_0xde308a(0x91b)][_0xde308a(0xfde)]===0x0){alert(_0xde308a(0xf0f));return;}const _0x2e62b8=await _0x23a88b(_0xde308a(0x812),_0xde308a(0xad4),{'confirmText':_0xde308a(0x2db)});if(!_0x2e62b8)return;await _0x296ef9(_0xde308a(0x4a6),_0xde308a(0x12e6)+_0x40e606[_0xde308a(0x91b)]['length']+'\x20首歌曲，这可能需要一些时间...');const _0x3a3135=_0x40e606[_0xde308a(0x91b)]['length'],_0x4ced21=[],_0x38e0b1=[],_0x42a3c5=_0x40e606[_0xde308a(0x91b)][_0xde308a(0xa79)](async _0x185dac=>{const _0x37e357=_0xde308a;if(_0x185dac[_0x37e357(0x63e)]){_0x4ced21[_0x37e357(0x258)](_0x185dac);return;}const _0x26032f=await _0x306a54(_0x185dac[_0x37e357(0xf6c)]);_0x26032f?_0x4ced21[_0x37e357(0x258)](_0x185dac):(_0x38e0b1[_0x37e357(0x258)](_0x185dac[_0x37e357(0x461)]),console['warn'](_0x37e357(0x1389)+_0x185dac[_0x37e357(0x461)]+'\x20-\x20'+_0x185dac[_0x37e357(0xf6c)]));});await Promise[_0xde308a(0x1282)](_0x42a3c5);const _0x3a980d=_0x3a3135-_0x4ced21[_0xde308a(0xfde)];if(_0x3a980d>0x0){const _0x1d0fb6=_0x40e606['playlist'][_0x40e606[_0xde308a(0xb2c)]],_0x51b601=_0x38e0b1['includes'](_0x1d0fb6?.[_0xde308a(0x461)]);_0x40e606[_0xde308a(0x91b)]=_0x4ced21,await _0x534851();if(_0x51b601)_0x17f24d['pause'](),_0x17f24d[_0xde308a(0xf6c)]='',_0x40e606[_0xde308a(0xb2c)]=_0x40e606[_0xde308a(0x91b)]['length']>0x0?0x0:-0x1,_0x40e606['isPlaying']=![];else _0x1d0fb6&&(_0x40e606[_0xde308a(0xb2c)]=_0x40e606[_0xde308a(0x91b)]['findIndex'](_0xa88e2e=>_0xa88e2e[_0xde308a(0xf6c)]===_0x1d0fb6[_0xde308a(0xf6c)]));_0x77e4e(),_0x16763b(),await _0x296ef9(_0xde308a(0x1078),_0xde308a(0xad8)+_0x3a980d+_0xde308a(0x57c)+_0x38e0b1[_0xde308a(0xa35)](_0xde308a(0x1c5)));}else await _0x296ef9(_0xde308a(0x97e),'所有歌曲链接均有效，无需清理！');}function _0x2c3e8c(){const _0x2cdba9=_0x549949,_0x3ef00e=document[_0x2cdba9(0x383)]('phone-screen');_0x3ef00e[_0x2cdba9(0x119a)]['toggle']('status-bar-visible',!!_0x41df36[_0x2cdba9(0xc0)][_0x2cdba9(0x221)]);}async function _0x5ae75d(){const _0x5d06de=_0x549949,_0x2f2806=document[_0x5d06de(0x383)]('clear-posts-modal'),_0x11e129=document[_0x5d06de(0x383)](_0x5d06de(0x8d9));_0x11e129['innerHTML']='';const _0x38a108=[];_0x38a108[_0x5d06de(0x258)]({'text':_0x5d06de(0x4fb),'value':'all','isDanger':!![]});const _0x537bba=_0x41df36[_0x5d06de(0x571)][_0x5d06de(0xabb)]||'我';_0x38a108[_0x5d06de(0x258)]({'text':_0x5d06de(0x824)+_0x537bba+'\x20的动态\x20(用户)','value':'user'}),Object[_0x5d06de(0x76d)](_0x41df36['chats'])['forEach'](_0x1e0bef=>{const _0x3d9560=_0x5d06de;!_0x1e0bef[_0x3d9560(0x1a2)]&&_0x38a108[_0x3d9560(0x258)]({'text':'仅清空\x20'+_0x1e0bef['name']+'\x20的动态\x20(角色)','value':_0x1e0bef['id']});});try{const _0xb00b41=await _0x342df8[_0x5d06de(0x656)]['toArray']();_0xb00b41[_0x5d06de(0xfde)]>0x0&&(_0x38a108['push']({'isSeparator':!![],'text':_0x5d06de(0x10d5)}),_0xb00b41[_0x5d06de(0x19c)](_0x2e2762=>{const _0x1f5473=_0x5d06de;_0x38a108[_0x1f5473(0x258)]({'text':_0x1f5473(0x824)+_0x2e2762[_0x1f5473(0x461)]+_0x1f5473(0xa8c),'value':_0x1f5473(0x1244)+_0x2e2762['id']});}));}catch(_0xa01457){console['error']('加载NPC列表失败:',_0xa01457);}_0x38a108[_0x5d06de(0x19c)](_0x41828f=>{const _0x19d0e5=_0x5d06de;if(_0x41828f[_0x19d0e5(0x33d)]){const _0x23b199=document['createElement'](_0x19d0e5(0x7fd));_0x23b199['textContent']=_0x41828f[_0x19d0e5(0x6af)],_0x23b199[_0x19d0e5(0x655)][_0x19d0e5(0x1ae)]=_0x19d0e5(0x379),_0x11e129[_0x19d0e5(0xe91)](_0x23b199);return;}const _0x29265d=document[_0x19d0e5(0xe1b)](_0x19d0e5(0x7fd));_0x29265d[_0x19d0e5(0x556)]='clear-posts-item',_0x41828f[_0x19d0e5(0x974)]&&_0x29265d[_0x19d0e5(0x119a)]['add']('danger-option'),_0x29265d['dataset']['targetId']=_0x41828f['value'],_0x29265d[_0x19d0e5(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x41828f[_0x19d0e5(0x6af)]+_0x19d0e5(0xf79),_0x11e129[_0x19d0e5(0xe91)](_0x29265d);}),_0x2f2806[_0x5d06de(0x119a)][_0x5d06de(0xbff)]('visible');}async function _0x1876c4(){const _0x2a5430=_0x549949,_0x99b2fa=document[_0x2a5430(0x400)](_0x2a5430(0xfeb));if(_0x99b2fa[_0x2a5430(0xfde)]===0x0){alert(_0x2a5430(0x942));return;}const _0x5afdaa=Array['from'](_0x99b2fa)['map'](_0x14dc5a=>_0x14dc5a[_0x2a5430(0x118)][_0x2a5430(0x99d)]);let _0x470943=[];_0x5afdaa[_0x2a5430(0xee2)](_0x2a5430(0x1282))?_0x470943['push'](_0x2a5430(0x1a0)):(_0x5afdaa[_0x2a5430(0xee2)](_0x2a5430(0x66e))&&_0x470943[_0x2a5430(0x258)]('“'+_0x41df36[_0x2a5430(0x571)][_0x2a5430(0xabb)]+'”'),_0x5afdaa[_0x2a5430(0x19c)](_0x5775ed=>{const _0x37fce8=_0x2a5430,_0x4c523f=_0x41df36['chats'][_0x5775ed];_0x4c523f&&_0x470943[_0x37fce8(0x258)]('“'+_0x4c523f[_0x37fce8(0x461)]+'”');}));const _0x5a227c='此操作将永久删除\x20'+_0x470943['join']('、\x20')+_0x2a5430(0x99a),_0x1a54f7=await _0x23a88b('确认清空动态？',_0x5a227c,{'confirmButtonClass':_0x2a5430(0x51b),'confirmText':_0x2a5430(0xa5e)});if(!_0x1a54f7)return;try{_0x5afdaa[_0x2a5430(0xee2)](_0x2a5430(0x1282))?await _0x342df8['qzonePosts'][_0x2a5430(0x4b8)]():await _0x342df8[_0x2a5430(0x35a)]['where'](_0x2a5430(0x1301))[_0x2a5430(0x1314)](_0x5afdaa)[_0x2a5430(0x971)](),_0x3c5f19=await _0x342df8[_0x2a5430(0x35a)][_0x2a5430(0x4b1)](_0x2a5430(0x3b7))[_0x2a5430(0x1087)]()['toArray'](),_0x482fde=0x0,await _0x476b70(),document[_0x2a5430(0x383)](_0x2a5430(0xf02))[_0x2a5430(0x119a)]['remove'](_0x2a5430(0x106d)),await _0x296ef9(_0x2a5430(0x12bb),_0x2a5430(0x12d3));}catch(_0x2ce4bd){console['error']('清空动态时出错:',_0x2ce4bd),await _0x296ef9('操作失败',_0x2a5430(0x130e)+_0x2ce4bd[_0x2a5430(0x5f8)]);}}async function _0x5865e5(_0xd4b18f){const _0x16ccb5=_0x549949,_0x523c69=await _0x23a88b(_0x16ccb5(0x615),'确定要永久删除这条心声记录吗？此操作不可恢复。',{'confirmButtonClass':_0x16ccb5(0x51b),'confirmText':'确认删除'});if(_0x523c69){const _0x2e3fef=_0x41df36[_0x16ccb5(0x864)][_0x41df36[_0x16ccb5(0xfc5)]];if(!_0x2e3fef||!_0x2e3fef[_0x16ccb5(0x4f8)])return;const _0x1b8ace=_0x2e3fef[_0x16ccb5(0x4f8)][_0x16ccb5(0xe37)](_0x2c4580=>_0x2c4580['timestamp']===_0xd4b18f);if(_0x1b8ace===-0x1)return;const _0x5bd376=_0x1b8ace===_0x2e3fef[_0x16ccb5(0x4f8)]['length']-0x1;_0x2e3fef[_0x16ccb5(0x4f8)]=_0x2e3fef[_0x16ccb5(0x4f8)][_0x16ccb5(0x98a)](_0x2f7249=>_0x2f7249['timestamp']!==_0xd4b18f);if(_0x5bd376){if(_0x2e3fef['thoughtsHistory'][_0x16ccb5(0xfde)]>0x0){const _0x590ce4=_0x2e3fef['thoughtsHistory'][_0x2e3fef[_0x16ccb5(0x4f8)][_0x16ccb5(0xfde)]-0x1];_0x2e3fef[_0x16ccb5(0xa52)]=_0x590ce4['heartfeltVoice'],_0x2e3fef['randomJottings']=_0x590ce4['randomJottings'];const _0xbbc776=document[_0x16ccb5(0x383)](_0x16ccb5(0x93f)),_0x1d36d6=document[_0x16ccb5(0x383)](_0x16ccb5(0x201));if(_0xbbc776)_0xbbc776[_0x16ccb5(0x138e)]=_0x2e3fef['heartfeltVoice'];if(_0x1d36d6)_0x1d36d6[_0x16ccb5(0x138e)]=_0x2e3fef[_0x16ccb5(0xc2b)];console[_0x16ccb5(0xe72)](_0x16ccb5(0x3ba));}else{_0x2e3fef[_0x16ccb5(0xa52)]=_0x16ccb5(0x1026),_0x2e3fef[_0x16ccb5(0xc2b)]=_0x16ccb5(0x1026);const _0x5b5cd1=document[_0x16ccb5(0x383)](_0x16ccb5(0x93f)),_0x4646b5=document[_0x16ccb5(0x383)](_0x16ccb5(0x201));if(_0x5b5cd1)_0x5b5cd1[_0x16ccb5(0x138e)]=_0x2e3fef[_0x16ccb5(0xa52)];if(_0x4646b5)_0x4646b5[_0x16ccb5(0x138e)]=_0x2e3fef['randomJottings'];console[_0x16ccb5(0xe72)](_0x16ccb5(0xa40));}}await _0x342df8[_0x16ccb5(0x864)][_0x16ccb5(0x9c0)](_0x2e3fef),_0x354a21(),await _0x296ef9('成功',_0x16ccb5(0x7a5));}}document['getElementById'](_0x549949(0x1098))[_0x549949(0x271)](_0x549949(0x5c7),_0x3f4ee3=>{const _0x4463e9=_0x549949,_0x44fac7=_0x3f4ee3[_0x4463e9(0xfab)]['closest'](_0x4463e9(0xcc9));if(_0x44fac7){const _0x2c7c30=parseInt(_0x44fac7['dataset']['timestamp']);!isNaN(_0x2c7c30)&&_0x5865e5(_0x2c7c30);}});async function _0x4ff67e(){const _0x422472=_0x549949,_0x21cd99=document[_0x422472(0x383)](_0x422472(0x162));_0x21cd99[_0x422472(0x45c)]=_0x422472(0xa5a);const _0x382dc7=await _0x342df8[_0x422472(0x1156)][_0x422472(0x6bd)]('type')[_0x422472(0x5b3)](_0x422472(0x33c))[_0x422472(0x21f)]();_0x382dc7['forEach'](_0x2447f8=>{const _0x25165d=_0x422472,_0x32a32e=document['createElement'](_0x25165d(0x10a0));_0x32a32e[_0x25165d(0x1be)]=_0x2447f8['id'],_0x32a32e[_0x25165d(0x138e)]=_0x2447f8[_0x25165d(0x461)],_0x21cd99['appendChild'](_0x32a32e);});}async function _0x5471af(){const _0x470149=_0x549949,_0x382ad0=document[_0x470149(0x383)](_0x470149(0x162)),_0x2df8a7=parseInt(_0x382ad0[_0x470149(0x1be)]);if(isNaN(_0x2df8a7))return;const _0x3ea13c=await _0x342df8[_0x470149(0x1156)][_0x470149(0x1a3)](_0x2df8a7);if(_0x3ea13c){const _0x3a35ae=document[_0x470149(0x383)](_0x470149(0xd4d));_0x3a35ae[_0x470149(0x1be)]=_0x3ea13c['value'],_0x15f193(_0x3ea13c[_0x470149(0x1be)]);}}async function _0x692a8e(){const _0x2f235f=_0x549949,_0x230671=await _0x12e332(_0x2f235f(0xc1e),'请输入预设名称');if(!_0x230671||!_0x230671['trim']())return;const _0x213385=document[_0x2f235f(0x383)]('global-css-input')['value'],_0x1b10e4=await _0x342df8[_0x2f235f(0x1156)][_0x2f235f(0x6bd)]({'name':_0x230671[_0x2f235f(0x1cb)](),'type':_0x2f235f(0x33c)})[_0x2f235f(0x26e)]();if(_0x1b10e4){const _0x26572a=await _0x23a88b(_0x2f235f(0x284),_0x2f235f(0xa5)+_0x230671[_0x2f235f(0x1cb)]()+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':_0x2f235f(0x51b)});if(!_0x26572a)return;await _0x342df8[_0x2f235f(0x1156)][_0x2f235f(0xaf9)](_0x1b10e4['id'],{'value':_0x213385});}else await _0x342df8[_0x2f235f(0x1156)][_0x2f235f(0xbff)]({'name':_0x230671[_0x2f235f(0x1cb)](),'type':_0x2f235f(0x33c),'value':_0x213385});await _0x4ff67e(),alert('CSS\x20预设已保存！');}async function _0x38ae1(){const _0x3e7533=_0x549949,_0x5cf394=document[_0x3e7533(0x383)](_0x3e7533(0x162)),_0x9562df=parseInt(_0x5cf394['value']);if(isNaN(_0x9562df)){alert(_0x3e7533(0x1112));return;}const _0x1f7e16=await _0x342df8['appearancePresets'][_0x3e7533(0x1a3)](_0x9562df);if(!_0x1f7e16)return;const _0x150668=await _0x23a88b(_0x3e7533(0xaa2),'确定要删除预设\x20“'+_0x1f7e16['name']+_0x3e7533(0xce2),{'confirmButtonClass':_0x3e7533(0x51b)});_0x150668&&(await _0x342df8[_0x3e7533(0x1156)]['delete'](_0x9562df),await _0x4ff67e(),alert(_0x3e7533(0x587)));}async function _0x55c558(){const _0x539294=_0x549949,_0x124ffb=document[_0x539294(0x383)]('font-preset-select');_0x124ffb[_0x539294(0x45c)]=_0x539294(0xa5a);const _0x2c2b3b=await _0x342df8['appearancePresets'][_0x539294(0x6bd)]('type')[_0x539294(0x5b3)](_0x539294(0xc9f))[_0x539294(0x21f)]();_0x2c2b3b[_0x539294(0x19c)](_0x5490e3=>{const _0x57ed9e=_0x539294,_0x4949d5=document[_0x57ed9e(0xe1b)](_0x57ed9e(0x10a0));_0x4949d5['value']=_0x5490e3['id'],_0x4949d5[_0x57ed9e(0x138e)]=_0x5490e3[_0x57ed9e(0x461)],_0x124ffb[_0x57ed9e(0xe91)](_0x4949d5);});}async function _0x279361(){const _0x3aafd8=_0x549949,_0x31ba02=document['getElementById'](_0x3aafd8(0x281)),_0x3f1f09=parseInt(_0x31ba02[_0x3aafd8(0x1be)]);if(isNaN(_0x3f1f09))return;const _0x15ea6e=await _0x342df8[_0x3aafd8(0x1156)][_0x3aafd8(0x1a3)](_0x3f1f09);if(_0x15ea6e){const _0xa1a0d2=document[_0x3aafd8(0x383)]('font-url-input');_0xa1a0d2[_0x3aafd8(0x1be)]=_0x15ea6e[_0x3aafd8(0x1be)],_0x59518a(_0x15ea6e[_0x3aafd8(0x1be)],!![]);}}async function _0x1d86a1(){const _0x28216c=_0x549949,_0x2fd634=await _0x12e332(_0x28216c(0xfea),_0x28216c(0x857));if(!_0x2fd634||!_0x2fd634[_0x28216c(0x1cb)]())return;const _0x19707f=document['getElementById'](_0x28216c(0x132e))[_0x28216c(0x1be)][_0x28216c(0x1cb)]();if(!_0x19707f){alert(_0x28216c(0xe1d));return;}const _0x59e8aa=await _0x342df8[_0x28216c(0x1156)][_0x28216c(0x6bd)]({'name':_0x2fd634[_0x28216c(0x1cb)](),'type':'font'})['first']();if(_0x59e8aa){const _0x388732=await _0x23a88b(_0x28216c(0x284),'名为\x20“'+_0x2fd634['trim']()+_0x28216c(0xad6),{'confirmButtonClass':'btn-danger'});if(!_0x388732)return;await _0x342df8[_0x28216c(0x1156)][_0x28216c(0xaf9)](_0x59e8aa['id'],{'value':_0x19707f});}else await _0x342df8[_0x28216c(0x1156)][_0x28216c(0xbff)]({'name':_0x2fd634['trim'](),'type':'font','value':_0x19707f});await _0x55c558(),alert(_0x28216c(0xbe8));}async function _0x665997(){const _0x2aae34=_0x549949,_0x13ab6a=document[_0x2aae34(0x383)](_0x2aae34(0x281)),_0x56c252=parseInt(_0x13ab6a[_0x2aae34(0x1be)]);if(isNaN(_0x56c252)){alert(_0x2aae34(0x1112));return;}const _0xb4ae98=await _0x342df8[_0x2aae34(0x1156)][_0x2aae34(0x1a3)](_0x56c252);if(!_0xb4ae98)return;const _0x45b592=await _0x23a88b(_0x2aae34(0xaa2),_0x2aae34(0x7e0)+_0xb4ae98[_0x2aae34(0x461)]+'”\x20吗？',{'confirmButtonClass':'btn-danger'});_0x45b592&&(await _0x342df8[_0x2aae34(0x1156)]['delete'](_0x56c252),await _0x55c558(),alert('预设已删除。'));}async function _0x4a451b(){const _0x1d4479=_0x549949,_0x3ebd78=document[_0x1d4479(0x383)](_0x1d4479(0x626));_0x3ebd78[_0x1d4479(0x45c)]=_0x1d4479(0xa5a);const _0x597b36=await _0x342df8[_0x1d4479(0x1156)][_0x1d4479(0x6bd)](_0x1d4479(0xa6b))[_0x1d4479(0x5b3)](_0x1d4479(0xde2))[_0x1d4479(0x21f)]();_0x597b36['forEach'](_0x4861e9=>{const _0x42e562=_0x1d4479,_0x1d38c5=document['createElement'](_0x42e562(0x10a0));_0x1d38c5[_0x42e562(0x1be)]=_0x4861e9['id'],_0x1d38c5[_0x42e562(0x138e)]=_0x4861e9[_0x42e562(0x461)],_0x3ebd78[_0x42e562(0xe91)](_0x1d38c5);});const _0x2896bf={'wallpaper':_0x41df36['globalSettings'][_0x1d4479(0x5d0)],'cphoneWallpaper':_0x41df36[_0x1d4479(0xc0)][_0x1d4479(0x1120)],'globalChatBackground':_0x41df36[_0x1d4479(0xc0)][_0x1d4479(0x7bb)],'appIcons':_0x41df36[_0x1d4479(0xc0)][_0x1d4479(0x33f)],'cphoneAppIcons':_0x41df36[_0x1d4479(0xc0)][_0x1d4479(0x943)],'chatActionButtonsOrder':_0x41df36[_0x1d4479(0xc0)]['chatActionButtonsOrder'],'theme':localStorage[_0x1d4479(0xb2)](_0x1d4479(0xd95))||_0x1d4479(0xbf0),'showStatusBar':_0x41df36['globalSettings'][_0x1d4479(0x221)],'notificationSoundUrl':_0x41df36['globalSettings'][_0x1d4479(0x11ce)],'widgetData':_0x41df36[_0x1d4479(0xc0)]['widgetData']};let _0x4da16a=null;for(const _0x473f79 of _0x597b36){if(JSON[_0x1d4479(0x3fb)](_0x473f79[_0x1d4479(0x1be)])===JSON['stringify'](_0x2896bf)){_0x4da16a=_0x473f79['id'];break;}}_0x4da16a?_0x3ebd78['value']=_0x4da16a:_0x3ebd78[_0x1d4479(0x1be)]='';}async function _0x35bbb7(){const _0x344e8c=_0x549949,_0xc198a=document['getElementById'](_0x344e8c(0x626)),_0x5d2db6=parseInt(_0xc198a[_0x344e8c(0x1be)]);if(isNaN(_0x5d2db6))return;const _0x3018b2=await _0x342df8['appearancePresets'][_0x344e8c(0x1a3)](_0x5d2db6);if(_0x3018b2&&_0x3018b2[_0x344e8c(0x1be)]){const _0x3628c4=_0x3018b2['value'];Object[_0x344e8c(0xa8d)](_0x41df36['globalSettings'],_0x3628c4),_0x149bc9(_0x3628c4[_0x344e8c(0x53f)]||_0x344e8c(0xbf0)),await _0x342df8['globalSettings'][_0x344e8c(0x9c0)](_0x41df36[_0x344e8c(0xc0)]),_0x31bb8c(),_0x4f56f2(),_0x323732(),_0x3df773(),_0x2c3e8c(),_0x5140bf(),_0x446010(),alert(_0x344e8c(0xefb)+_0x3018b2[_0x344e8c(0x461)]+'”');}}async function _0xc65876(){const _0x5080fe=_0x549949,_0x4a3738=await _0x12e332('保存外观预设',_0x5080fe(0x857));if(!_0x4a3738||!_0x4a3738[_0x5080fe(0x1cb)]())return;const _0x475091={'wallpaper':_0x41df36['globalSettings'][_0x5080fe(0x5d0)],'cphoneWallpaper':_0x41df36['globalSettings'][_0x5080fe(0x1120)],'globalChatBackground':_0x41df36['globalSettings'][_0x5080fe(0x7bb)],'appIcons':_0x41df36['globalSettings'][_0x5080fe(0x33f)],'cphoneAppIcons':_0x41df36[_0x5080fe(0xc0)][_0x5080fe(0x943)],'chatActionButtonsOrder':_0x41df36[_0x5080fe(0xc0)][_0x5080fe(0xb43)],'theme':localStorage[_0x5080fe(0xb2)](_0x5080fe(0xd95))||_0x5080fe(0xbf0),'showStatusBar':_0x41df36[_0x5080fe(0xc0)][_0x5080fe(0x221)],'notificationSoundUrl':_0x41df36[_0x5080fe(0xc0)]['notificationSoundUrl'],'widgetData':_0x41df36[_0x5080fe(0xc0)][_0x5080fe(0x5ec)]},_0x4d6e73=await _0x342df8[_0x5080fe(0x1156)][_0x5080fe(0x6bd)]({'name':_0x4a3738[_0x5080fe(0x1cb)](),'type':_0x5080fe(0xde2)})[_0x5080fe(0x26e)]();if(_0x4d6e73){const _0x42d616=await _0x23a88b('覆盖预设',_0x5080fe(0xa5)+_0x4a3738[_0x5080fe(0x1cb)]()+_0x5080fe(0xad6),{'confirmButtonClass':_0x5080fe(0x51b)});if(!_0x42d616)return;await _0x342df8[_0x5080fe(0x1156)][_0x5080fe(0xaf9)](_0x4d6e73['id'],{'value':_0x475091});}else await _0x342df8[_0x5080fe(0x1156)][_0x5080fe(0xbff)]({'name':_0x4a3738[_0x5080fe(0x1cb)](),'type':_0x5080fe(0xde2),'value':_0x475091});await _0x4a451b(),alert(_0x5080fe(0xe5f));}async function _0x4e6b51(){const _0x4dc2f=_0x549949,_0xe87c50=document[_0x4dc2f(0x383)]('appearance-preset-select'),_0x6d08b5=parseInt(_0xe87c50[_0x4dc2f(0x1be)]);if(isNaN(_0x6d08b5)){alert(_0x4dc2f(0x1112));return;}const _0x21cedf=await _0x342df8[_0x4dc2f(0x1156)][_0x4dc2f(0x1a3)](_0x6d08b5);if(!_0x21cedf)return;const _0x4f46f8=await _0x23a88b(_0x4dc2f(0xaa2),_0x4dc2f(0x7e0)+_0x21cedf[_0x4dc2f(0x461)]+'”\x20吗？',{'confirmButtonClass':_0x4dc2f(0x51b)});_0x4f46f8&&(await _0x342df8['appearancePresets'][_0x4dc2f(0x971)](_0x6d08b5),await _0x4a451b(),alert(_0x4dc2f(0x587)));}async function _0x3c5192(){const _0x40b152=_0x549949,_0x4f5dcf=document[_0x40b152(0x383)](_0x40b152(0x924));_0x4f5dcf['innerHTML']=_0x40b152(0xa5a);const _0x577666=await _0x342df8[_0x40b152(0x1156)]['where'](_0x40b152(0xa6b))['equals'](_0x40b152(0x80b))[_0x40b152(0x21f)]();_0x577666[_0x40b152(0x19c)](_0x2e237d=>{const _0x4514da=_0x40b152,_0x54476c=document[_0x4514da(0xe1b)](_0x4514da(0x10a0));_0x54476c[_0x4514da(0x1be)]=_0x2e237d['id'],_0x54476c[_0x4514da(0x138e)]=_0x2e237d[_0x4514da(0x461)],_0x4f5dcf[_0x4514da(0xe91)](_0x54476c);});}async function _0x344683(){const _0x5ca14d=_0x549949,_0x17c5a9=document[_0x5ca14d(0x383)]('theme-preset-select'),_0x213d9b=parseInt(_0x17c5a9[_0x5ca14d(0x1be)]);if(isNaN(_0x213d9b))return;const _0x3063b5=await _0x342df8[_0x5ca14d(0x1156)]['get'](_0x213d9b);if(_0x3063b5){const _0x2cac13=_0x3063b5[_0x5ca14d(0x1be)]['base']||'default',_0x1ca37e=_0x3063b5[_0x5ca14d(0x1be)][_0x5ca14d(0x4fe)]||'',_0x1392f9=document[_0x5ca14d(0x89c)]('input[name=\x22theme-select\x22][value=\x22'+_0x2cac13+'\x22]');_0x1392f9&&(_0x1392f9[_0x5ca14d(0x2a3)]=!![]);const _0x5bc7b4=document[_0x5ca14d(0x383)](_0x5ca14d(0x9fe));_0x5bc7b4[_0x5ca14d(0x1be)]=_0x1ca37e,_0x24c0e3();}}async function _0x3ab5d7(){const _0x4233b3=_0x549949,_0x190524=await _0x12e332('保存主题预设','请输入预设名称');if(!_0x190524||!_0x190524[_0x4233b3(0x1cb)]())return;const _0x54fad3=document['querySelector'](_0x4233b3(0xf1)),_0x68f74=_0x54fad3?_0x54fad3[_0x4233b3(0x1be)]:_0x4233b3(0xba4),_0x4f91e3=document['getElementById']('custom-css-input')[_0x4233b3(0x1be)]['trim'](),_0x225a76={'base':_0x68f74,'custom':_0x4f91e3},_0x1bff87=await _0x342df8['appearancePresets'][_0x4233b3(0x6bd)]({'name':_0x190524[_0x4233b3(0x1cb)](),'type':_0x4233b3(0x80b)})[_0x4233b3(0x26e)]();if(_0x1bff87){const _0x54b219=await _0x23a88b(_0x4233b3(0x284),_0x4233b3(0xa5)+_0x190524[_0x4233b3(0x1cb)]()+_0x4233b3(0xad6),{'confirmButtonClass':'btn-danger'});if(!_0x54b219)return;await _0x342df8['appearancePresets'][_0x4233b3(0xaf9)](_0x1bff87['id'],{'value':_0x225a76});}else await _0x342df8[_0x4233b3(0x1156)][_0x4233b3(0xbff)]({'name':_0x190524['trim'](),'type':'bubble_theme','value':_0x225a76});await _0x3c5192(),alert('主题预设已保存！');}async function _0x11a6de(){const _0x150c64=_0x549949,_0xd50f13=document['getElementById']('theme-preset-select'),_0x45c9e1=parseInt(_0xd50f13['value']);if(isNaN(_0x45c9e1)){alert(_0x150c64(0x1112));return;}const _0x306fc8=await _0x342df8['appearancePresets'][_0x150c64(0x1a3)](_0x45c9e1);if(!_0x306fc8)return;const _0x101d56=await _0x23a88b(_0x150c64(0xaa2),_0x150c64(0x7e0)+_0x306fc8['name']+_0x150c64(0xce2),{'confirmButtonClass':'btn-danger'});_0x101d56&&(await _0x342df8[_0x150c64(0x1156)]['delete'](_0x45c9e1),await _0x3c5192(),alert('预设已删除。'));}async function _0x48dfd7(){const _0xf3c44e=_0x549949;await _0x181acc(),document['getElementById']('sticker-category-manager-modal')[_0xf3c44e(0x119a)][_0xf3c44e(0xbff)]('visible');}async function _0x181acc(){const _0x2e832e=_0x549949,_0x3c04bc=document[_0x2e832e(0x383)](_0x2e832e(0x5e5)),_0xbfd5ef=await _0x342df8[_0x2e832e(0x72d)][_0x2e832e(0x21f)]();_0x3c04bc['innerHTML']='';if(_0xbfd5ef[_0x2e832e(0xfde)]===0x0){_0x3c04bc['innerHTML']=_0x2e832e(0xed6);return;}_0xbfd5ef[_0x2e832e(0x19c)](_0x135827=>{const _0x4901c2=_0x2e832e,_0x485f7e=document[_0x4901c2(0xe1b)]('div');_0x485f7e[_0x4901c2(0x556)]=_0x4901c2(0x7c0),_0x485f7e[_0x4901c2(0x45c)]=_0x4901c2(0xeee)+_0x135827[_0x4901c2(0x461)]+_0x4901c2(0x689)+_0x135827['id']+_0x4901c2(0xd98),_0x3c04bc[_0x4901c2(0xe91)](_0x485f7e);});}async function _0x398b7c(){const _0x1489b7=_0x549949,_0x480177=document[_0x1489b7(0x383)]('new-sticker-category-name-input'),_0x3b7cc8=_0x480177['value'][_0x1489b7(0x1cb)]();if(!_0x3b7cc8){alert(_0x1489b7(0x536));return;}const _0xcb8457=await _0x342df8[_0x1489b7(0x72d)]['where']('name')[_0x1489b7(0x5b3)](_0x3b7cc8)['first']();if(_0xcb8457){alert('分类\x20\x22'+_0x3b7cc8+_0x1489b7(0xe60));return;}await _0x342df8[_0x1489b7(0x72d)]['add']({'name':_0x3b7cc8}),_0x480177['value']='',await _0x181acc();}async function _0x1f7905(_0x58b938){const _0x1acbfe=_0x549949,_0x1a9765=await _0x342df8['stickerCategories'][_0x1acbfe(0x1a3)](_0x58b938);if(!_0x1a9765)return;const _0x445f8b=await _0x342df8[_0x1acbfe(0x823)][_0x1acbfe(0x6bd)](_0x1acbfe(0xba3))[_0x1acbfe(0x5b3)](_0x58b938)[_0x1acbfe(0x779)](),_0x55f661=_0x445f8b>0x0?_0x1acbfe(0xd03)+_0x1a9765[_0x1acbfe(0x461)]+'》吗？\x0a\x0a【【【警告】】】\x0a此操作将同时永久删除该分类下的\x20'+_0x445f8b+_0x1acbfe(0x1172):_0x1acbfe(0xd03)+_0x1a9765[_0x1acbfe(0x461)]+'》吗？',_0x2d08c5=await _0x23a88b(_0x1acbfe(0x1136),_0x55f661,{'confirmButtonClass':_0x1acbfe(0x51b)});if(_0x2d08c5)try{await _0x342df8[_0x1acbfe(0xe17)]('rw',_0x342df8[_0x1acbfe(0x72d)],_0x342df8[_0x1acbfe(0x823)],async()=>{const _0x3cf70b=_0x1acbfe,_0x4ec766=await _0x342df8[_0x3cf70b(0x823)]['where'](_0x3cf70b(0xba3))[_0x3cf70b(0x5b3)](_0x58b938)[_0x3cf70b(0x60b)]();_0x4ec766[_0x3cf70b(0xfde)]>0x0&&await _0x342df8[_0x3cf70b(0x823)][_0x3cf70b(0x212)](_0x4ec766),await _0x342df8[_0x3cf70b(0x72d)][_0x3cf70b(0x971)](_0x58b938);}),_0x41df36[_0x1acbfe(0x823)]=await _0x342df8[_0x1acbfe(0x823)][_0x1acbfe(0x21f)](),_0x45a6e6===_0x58b938&&(_0x45a6e6=_0x1acbfe(0x1282)),await _0x181acc(),await _0x59fe05(),alert('分类《'+_0x1a9765[_0x1acbfe(0x461)]+_0x1acbfe(0x23f));}catch(_0x2a40ea){console[_0x1acbfe(0x98)](_0x1acbfe(0xf4),_0x2a40ea),alert(_0x1acbfe(0x879));}}function _0x52f4e5(_0x3ac9f5){const _0x2469dc=_0x549949;_0x45a6e6=_0x3ac9f5,document['querySelectorAll'](_0x2469dc(0xf6a))[_0x2469dc(0x19c)](_0x1255bf=>{const _0x2d3998=_0x2469dc;_0x1255bf['classList'][_0x2d3998(0x8f0)](_0x2d3998(0xde5),String(_0x1255bf[_0x2d3998(0x118)][_0x2d3998(0xba3)])===String(_0x3ac9f5));}),_0x59fe05(![]);const _0x45ffc9=document[_0x2469dc(0x383)]('select-all-stickers-checkbox');if(_0x45ffc9)_0x45ffc9[_0x2469dc(0x2a3)]=![];}async function _0x1e91cd(){const _0x3ffcf4=_0x549949;if(!_0x41df36[_0x3ffcf4(0xfc5)])return;const _0x5edd96=_0x41df36[_0x3ffcf4(0x864)][_0x41df36[_0x3ffcf4(0xfc5)]];if(!_0x5edd96)return;try{const _0x5ad92a={'type':_0x3ffcf4(0xa88),'version':0x1,'chatData':_0x5edd96},_0x4f701f=new Blob([JSON['stringify'](_0x5ad92a,null,0x2)],{'type':_0x3ffcf4(0x11f0)}),_0x109745=URL[_0x3ffcf4(0x679)](_0x4f701f),_0x16e76e=document[_0x3ffcf4(0xe1b)]('a');_0x16e76e[_0x3ffcf4(0x10bc)]=_0x109745,_0x16e76e[_0x3ffcf4(0x110e)]=_0x3ffcf4(0xaef)+_0x5edd96['name']+'-'+new Date()[_0x3ffcf4(0x226)]()[_0x3ffcf4(0x105d)]('T')[0x0]+'.json',_0x16e76e['click'](),URL[_0x3ffcf4(0x119d)](_0x109745),await _0x296ef9(_0x3ffcf4(0x1ec),'与“'+_0x5edd96[_0x3ffcf4(0x461)]+_0x3ffcf4(0xcba));}catch(_0x1b6c01){console['error'](_0x3ffcf4(0x80a),_0x1b6c01),await _0x296ef9(_0x3ffcf4(0xf11),_0x3ffcf4(0x842)+_0x1b6c01['message']);}}async function _0x5d6eeb(_0x5f1aa1){const _0x570814=_0x549949;if(!_0x5f1aa1||!_0x41df36[_0x570814(0xfc5)])return;const _0x3fbf70=_0x41df36[_0x570814(0xfc5)],_0x356879=_0x41df36[_0x570814(0x864)][_0x3fbf70];try{const _0x2934d6=await _0x5f1aa1['text'](),_0x19276e=JSON[_0x570814(0x134)](_0x2934d6);if(_0x19276e['type']!=='EPhoneSingleChat'||!_0x19276e[_0x570814(0x694)])throw new Error(_0x570814(0x883));const _0x4397e5=await _0x23a88b(_0x570814(0x9fc),_0x570814(0x683)+_0x356879['name']+_0x570814(0x1386),{'confirmButtonClass':'btn-danger','confirmText':_0x570814(0xb41)});if(!_0x4397e5)return;const _0x4a372f=_0x19276e[_0x570814(0x694)];_0x4a372f['id']=_0x3fbf70,await _0x342df8[_0x570814(0x864)][_0x570814(0x9c0)](_0x4a372f),_0x41df36[_0x570814(0x864)][_0x3fbf70]=_0x4a372f,await _0x296ef9('导入成功',_0x570814(0xd1a)),_0x409076(_0x3fbf70),_0x25558e(),document[_0x570814(0x383)]('chat-settings-btn')[_0x570814(0x5c7)]();}catch(_0x3a1fc7){console[_0x570814(0x98)](_0x570814(0x1373),_0x3a1fc7),await _0x296ef9('导入失败',_0x570814(0x12f4)+_0x3a1fc7[_0x570814(0x5f8)]);}}function _0x2ff7af(){_0x59112(),_0x105acd('character-selection-screen');}function _0x59112(){const _0x44b7cf=_0x549949,_0x114675=document[_0x44b7cf(0x383)](_0x44b7cf(0x52a));_0x114675['innerHTML']='';const _0x5d887b=Object[_0x44b7cf(0x76d)](_0x41df36['chats'])[_0x44b7cf(0x98a)](_0x45bad7=>!_0x45bad7[_0x44b7cf(0x1a2)]);if(_0x5d887b[_0x44b7cf(0xfde)]===0x0){_0x114675[_0x44b7cf(0x45c)]=_0x44b7cf(0x45f);return;}_0x5d887b[_0x44b7cf(0x19c)](_0x400545=>{const _0x590b33=_0x44b7cf,_0x2ae377=document[_0x590b33(0xe1b)]('div');_0x2ae377[_0x590b33(0x556)]=_0x590b33(0x91),_0x2ae377[_0x590b33(0x45c)]=_0x590b33(0xe1f)+(_0x400545[_0x590b33(0x886)][_0x590b33(0x121e)]||_0x5dc108)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x400545[_0x590b33(0x461)]+_0x590b33(0xf79),_0x2ae377[_0x590b33(0x271)](_0x590b33(0x5c7),()=>_0x434bb9(_0x400545['id'])),_0x114675[_0x590b33(0xe91)](_0x2ae377);});}async function _0x434bb9(_0x149a50){const _0x702387=_0x549949;_0x18c6a2=_0x149a50,console[_0x702387(0xe72)]('已切换到角色\x20'+_0x149a50+'\x20的手机'),_0x4f56f2(),_0x3df773(),_0x42c82a(),_0x105acd(_0x702387(0x87a));}function _0x1e8884(){const _0x11c755=_0x549949;_0x18c6a2=null,console['log']('已返回我的手机'),_0x105acd(_0x11c755(0x4a1));}function _0x42c82a(){const _0x17ce10=_0x549949,_0x2da460=new Date(),_0x139ad9=_0x2da460[_0x17ce10(0x1366)](_0x17ce10(0xafb),{'hour':_0x17ce10(0x9bf),'minute':_0x17ce10(0x9bf)}),_0x59de33=_0x2da460[_0x17ce10(0xb8b)](_0x17ce10(0xafb),{'weekday':_0x17ce10(0xd8e),'month':'long','day':_0x17ce10(0x12ec)});document['getElementById'](_0x17ce10(0x387))[_0x17ce10(0x138e)]=_0x139ad9,document[_0x17ce10(0x383)]('char-main-date')['textContent']=_0x59de33,_0x40583e(_0x17ce10(0x4dd));}function _0x40583e(_0x3e96e3){const _0x13bd3e=_0x549949;document['querySelectorAll'](_0x13bd3e(0x109b))[_0x13bd3e(0x19c)](_0x27195c=>_0x27195c[_0x13bd3e(0x119a)][_0x13bd3e(0x131d)](_0x13bd3e(0xde5))),document[_0x13bd3e(0x383)](_0x3e96e3)[_0x13bd3e(0x119a)][_0x13bd3e(0xbff)](_0x13bd3e(0xde5));}window[_0x549949(0xfe3)]=_0x40583e;async function _0x12a6dc(_0x12d184){const _0x2e80c0=_0x549949;if(!_0x18c6a2)return;const _0x2a54f6=_0x41df36[_0x2e80c0(0x864)][_0x18c6a2];await _0xe60144(_0x18c6a2,_0x12d184);switch(_0x12d184){case'qq':_0x3d133e(),_0x40583e('char-qq-screen');break;case _0x2e80c0(0x11e2):_0x519cc9(),_0x40583e('char-album-screen');break;case _0x2e80c0(0x118d):_0x540acb(),_0x40583e(_0x2e80c0(0x131));break;case _0x2e80c0(0xf5f):_0x232b41(),_0x40583e(_0x2e80c0(0x871));break;case _0x2e80c0(0xd16):_0x3c6b47(),_0x40583e(_0x2e80c0(0x303));break;case _0x2e80c0(0x6b3):_0x59bb9d(),_0x40583e(_0x2e80c0(0x46a));break;case _0x2e80c0(0x952):_0x40de90(),_0x40583e('char-amap-screen');break;case _0x2e80c0(0x448):_0x24cea8(),_0x40583e(_0x2e80c0(0xe80));break;case'usage':_0x368866(),_0x40583e('char-usage-screen');break;}}async function _0x519cc9(){const _0xdd522b=_0x549949,_0x4209aa=document[_0xdd522b(0x383)](_0xdd522b(0x1186));_0x4209aa['innerHTML']='';if(!_0x18c6a2)return;const _0x1b4741=_0x41df36['chats'][_0x18c6a2],_0xffd8c6=_0x1b4741['simulatedAlbum']||[];if(_0xffd8c6[_0xdd522b(0xfde)]===0x0){_0x4209aa[_0xdd522b(0x45c)]=_0xdd522b(0x376);return;}const _0x303ad4=_0xdd522b(0xbed);_0xffd8c6['forEach'](_0xed6375=>{const _0x4a7eeb=_0xdd522b,_0x206b18=document[_0x4a7eeb(0xe1b)]('div');_0x206b18[_0x4a7eeb(0x556)]=_0x4a7eeb(0xe71),_0x206b18[_0x4a7eeb(0x118)]['description']=_0xed6375[_0x4a7eeb(0xee1)],_0x4209aa[_0x4a7eeb(0xe91)](_0x206b18);if(_0x41df36[_0x4a7eeb(0xc0)][_0x4a7eeb(0xb6a)]){_0x206b18['style'][_0x4a7eeb(0x8fc)]=_0x4a7eeb(0xb38);const _0x383be0=/[^\x00-\x7F]/['test'](_0xed6375['image_prompt']),_0x5418e8=_0xed6375[_0x4a7eeb(0x8d8)]&&_0xed6375[_0x4a7eeb(0x8d8)][_0x4a7eeb(0x1cb)]()&&!_0x383be0,_0x15a384=_0x5418e8?_0xed6375[_0x4a7eeb(0x8d8)]:_0x4a7eeb(0x517),_0x5e2bfa=_0x4a7eeb(0x5c1)+encodeURIComponent(_0x15a384),_0x366b29=new Image();_0x366b29[_0x4a7eeb(0xb5b)]=function(){const _0x57dfe7=_0x4a7eeb;_0x206b18[_0x57dfe7(0x655)][_0x57dfe7(0x880)]='url('+this[_0x57dfe7(0xf6c)]+')';},_0x366b29[_0x4a7eeb(0x40f)]=function(){const _0x287772=_0x4a7eeb;_0x206b18['style'][_0x287772(0x880)]=_0x287772(0xb9a)+_0x303ad4+')';},_0x366b29['src']=_0x5e2bfa;}else{_0x206b18[_0x4a7eeb(0x655)]['backgroundColor']=_0x4a7eeb(0xb71),_0x206b18['style']['border']=_0x4a7eeb(0xdb0);const _0x5857e9=document['createElement']('p');_0x5857e9[_0x4a7eeb(0x556)]='char-photo-description',_0x5857e9[_0x4a7eeb(0x138e)]=_0xed6375[_0x4a7eeb(0xee1)]||_0x4a7eeb(0xb0e),_0x206b18[_0x4a7eeb(0xe91)](_0x5857e9);}});}function _0x540acb(){const _0x3c18e4=_0x549949,_0x2f7b93=document[_0x3c18e4(0x383)](_0x3c18e4(0x105c));_0x2f7b93[_0x3c18e4(0x45c)]='';if(!_0x18c6a2)return;const _0x4bd509=_0x41df36['chats'][_0x18c6a2],_0x5a2b1f=[_0x4bd509[_0x3c18e4(0x461)],'爱好','旅游','美食','新闻',..._0x4bd509[_0x3c18e4(0x886)][_0x3c18e4(0xd83)][_0x3c18e4(0x105d)](/，|。|\s/)[_0x3c18e4(0x1368)](0x0,0x5)],_0x1d051c=['知乎',_0x3c18e4(0xb1f),_0x3c18e4(0x1117),'微博',_0x3c18e4(0x5e4)];for(let _0x3143d4=0x0;_0x3143d4<0xf;_0x3143d4++){const _0x3a1584=_0x5a2b1f[Math[_0x3c18e4(0xdee)](Math[_0x3c18e4(0x5ce)]()*_0x5a2b1f[_0x3c18e4(0xfde)])],_0x1cfc76=_0x1d051c[Math[_0x3c18e4(0xdee)](Math[_0x3c18e4(0x5ce)]()*_0x1d051c['length'])],_0x17e86=document['createElement'](_0x3c18e4(0x7fd));_0x17e86['className']=_0x3c18e4(0x1360),_0x17e86['innerHTML']=_0x3c18e4(0xb0b)+_0x3a1584+_0x3c18e4(0xb13)+_0x1cfc76+_0x3c18e4(0xda)+_0x1cfc76['toLowerCase']()+_0x3c18e4(0x401)+_0x3a1584+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x2f7b93[_0x3c18e4(0xe91)](_0x17e86);}}function _0x232b41(){const _0x15b6e3=_0x549949,_0xe8f770=document[_0x15b6e3(0x383)](_0x15b6e3(0x11fc));_0xe8f770[_0x15b6e3(0x45c)]='';if(!_0x18c6a2)return;const _0x13d3d5=_0x41df36[_0x15b6e3(0x864)][_0x18c6a2],_0x32885e=_0x13d3d5[_0x15b6e3(0x2ab)]?.[_0x15b6e3(0xa38)]||[];if(_0x32885e['length']===0x0){_0xe8f770[_0x15b6e3(0x45c)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>';return;}_0x32885e[_0x15b6e3(0x19c)](_0x312f35=>{const _0x593baa=_0x15b6e3,_0x8000b4=document[_0x593baa(0xe1b)](_0x593baa(0x7fd));_0x8000b4[_0x593baa(0x556)]=_0x593baa(0x52d),_0x8000b4[_0x593baa(0x118)]['reason']=_0x312f35[_0x593baa(0x99)];let _0x3bb0b0;if(_0x41df36[_0x593baa(0xc0)][_0x593baa(0xb6a)]){const _0x2e4abc=_0x593baa(0x5c1)+encodeURIComponent(_0x312f35[_0x593baa(0x8d8)]||_0x593baa(0x123c));_0x3bb0b0=_0x593baa(0xf8a)+_0x2e4abc+'\x22\x20class=\x22product-image\x22>';}else _0x3bb0b0=_0x593baa(0xea9)+(_0x312f35[_0x593baa(0x99)]||_0x593baa(0x27d))+_0x593baa(0xdbb);_0x8000b4[_0x593baa(0x45c)]=_0x593baa(0xc45)+_0x3bb0b0+_0x593baa(0xa0c)+_0x312f35[_0x593baa(0xc70)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>'+(_0x312f35['price']||0x0)[_0x593baa(0x70d)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>'+_0x312f35[_0x593baa(0x1fe)]+_0x593baa(0x885),_0xe8f770[_0x593baa(0xe91)](_0x8000b4);});}function _0x5e2548(){_0x40583e('char-home-screen');}function _0x4207b1(){const _0x20843d=_0x549949,_0x52fd40=document[_0x20843d(0x383)](_0x20843d(0x6e2));_0x52fd40['innerHTML']='';if(!_0x18c6a2)return;const _0x4aa112=Object['values'](_0x41df36[_0x20843d(0x864)])['filter'](_0x4d9f2b=>{const _0x24aaf0=_0x20843d;if(_0x4d9f2b['id']===_0x18c6a2)return!![];if(_0x4d9f2b[_0x24aaf0(0x1a2)]&&_0x4d9f2b[_0x24aaf0(0x12a6)][_0x24aaf0(0x12fb)](_0xb8767c=>_0xb8767c['id']===_0x18c6a2))return!![];return![];});_0x4aa112[_0x20843d(0x19c)](_0x4e5552=>{const _0x3a52d7=_0x20843d,_0x4e11c6=_0x3c2a51(_0x4e5552);_0x52fd40[_0x3a52d7(0xe91)](_0x4e11c6);});}async function _0xe60144(_0x1aef1b,_0x9a1419){const _0x29e531=_0x549949,_0x1a8eaf=_0x41df36[_0x29e531(0x864)][_0x1aef1b];if(!_0x1a8eaf)return;!_0x1a8eaf[_0x29e531(0x483)]&&(_0x1a8eaf['appUsageLog']=[]),_0x1a8eaf[_0x29e531(0x483)]['push']({'appName':_0x9a1419,'timestamp':Date[_0x29e531(0x108d)]()}),_0x1a8eaf[_0x29e531(0x483)]['length']>0x32&&_0x1a8eaf[_0x29e531(0x483)][_0x29e531(0x870)](),await _0x342df8[_0x29e531(0x864)]['put'](_0x1a8eaf);}function _0x368866(){const _0x34c279=_0x549949,_0x2bac49=document[_0x34c279(0x383)](_0x34c279(0x3f0));_0x2bac49[_0x34c279(0x45c)]='';const _0x495dea=_0x41df36[_0x34c279(0x864)][_0x18c6a2],_0x1bc4ce=(_0x495dea[_0x34c279(0x483)]||[])[_0x34c279(0x1368)]()['reverse']();if(_0x1bc4ce[_0x34c279(0xfde)]===0x0){_0x2bac49[_0x34c279(0x45c)]=_0x34c279(0x5f4);return;}const _0x216e69={'qq':'QQ','album':'相册','browser':'浏览器','taobao':'淘宝','memo':'备忘录','diary':'日记','amap':'高德地图','usage':'App记录'};_0x1bc4ce[_0x34c279(0x19c)](_0x1357b9=>{const _0x2792e6=_0x34c279,_0x5ed671=document[_0x2792e6(0xe1b)](_0x2792e6(0x7fd));_0x5ed671[_0x2792e6(0x556)]=_0x2792e6(0xa67),_0x5ed671[_0x2792e6(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>'+new Date(_0x1357b9['timestamp'])[_0x2792e6(0xa2b)]()+_0x2792e6(0x1140)+(_0x216e69[_0x1357b9[_0x2792e6(0x1379)]]||_0x1357b9[_0x2792e6(0x1379)])+_0x2792e6(0xbf3),_0x2bac49[_0x2792e6(0xe91)](_0x5ed671);});}async function _0x181af8(_0x1fb718){const _0x2713c9=_0x549949,_0x114e48=_0x41df36['chats'][_0x18c6a2];if(!_0x114e48)return;const _0x2e78ae={'role':'assistant','senderName':_0x114e48[_0x2713c9(0x283)],'type':_0x2713c9(0x15a),'content':_0x1fb718,'imageUrl':_0x2713c9(0x3cc),'timestamp':Date[_0x2713c9(0x108d)]()};_0x114e48['history'][_0x2713c9(0x258)](_0x2e78ae),await _0x342df8[_0x2713c9(0x864)][_0x2713c9(0x9c0)](_0x114e48),_0x41df36[_0x2713c9(0xfc5)]===_0x18c6a2&&_0x323467(_0x2e78ae,_0x114e48),await _0x296ef9(_0x2713c9(0x7b1),'“'+_0x114e48[_0x2713c9(0x461)]+_0x2713c9(0x1ba));}async function _0x32f168(_0x46c6f5){const _0x368802=_0x549949,_0x4cb716=_0x41df36[_0x368802(0x864)][_0x18c6a2];if(!_0x4cb716||!_0x4cb716['memos'])return;const _0xe7fdeb=_0x4cb716[_0x368802(0x5cb)][_0x368802(0xd12)](_0xfbe064=>_0xfbe064['id']===_0x46c6f5);if(_0xe7fdeb){_0x140106=_0xe7fdeb;const _0x4c46a7=document[_0x368802(0x383)](_0x368802(0x10ae)),_0x109e89=document[_0x368802(0x383)](_0x368802(0x133e)),_0x334519=document[_0x368802(0x383)]('favorite-memo-btn');if(_0x4c46a7)_0x4c46a7[_0x368802(0x138e)]=_0xe7fdeb[_0x368802(0xf3a)];if(_0x109e89)_0x109e89[_0x368802(0x1be)]=_0xe7fdeb['content'];const _0x17dad3=await _0x342df8['favorites'][_0x368802(0x6bd)]({'type':_0x368802(0x1147),'content.id':_0x46c6f5})['first']();_0x334519[_0x368802(0x119a)][_0x368802(0x8f0)](_0x368802(0xde5),!!_0x17dad3),_0x40583e(_0x368802(0xe9e));}}function _0x3c6b47(){const _0x17391d=_0x549949,_0x17a389=document[_0x17391d(0x383)](_0x17391d(0xda4));_0x17a389[_0x17391d(0x45c)]='';const _0xcedd0f=_0x41df36[_0x17391d(0x864)][_0x18c6a2],_0x4ea686=(_0xcedd0f['memos']||[])[_0x17391d(0x1368)]()[_0x17391d(0x1087)]();if(_0x4ea686['length']===0x0){_0x17a389['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>';return;}_0x4ea686[_0x17391d(0x19c)](_0x48b240=>{const _0x287145=_0x17391d,_0x130d49=document['createElement']('div');_0x130d49['className']=_0x287145(0x127d),_0x130d49['innerHTML']=_0x287145(0xda6)+_0x48b240['title']+_0x287145(0x547)+(_0x48b240[_0x287145(0x11b6)]||'')[_0x287145(0x105d)]('\x0a')[0x0]+_0x287145(0x9be),_0x130d49[_0x287145(0x271)](_0x287145(0x5c7),()=>_0x32f168(_0x48b240['id'])),_0x3e15d1(_0x130d49,()=>deleteMemo(_0x48b240['id'])),_0x17a389[_0x287145(0xe91)](_0x130d49);});}async function _0x48b81f(_0x399490=null){const _0x244773=_0x549949;_0x5bdf0e=null;const _0x36561b=await _0x12e332(_0x244773(0x12fd),'请输入标题');if(_0x36561b===null||!_0x36561b[_0x244773(0x1cb)]())return;const _0x5a7013=await _0x12e332(_0x244773(0x1a4)+_0x36561b,_0x244773(0x111),'',_0x244773(0xfe5));_0x5a7013!==null&&(await _0x261517({'title':_0x36561b[_0x244773(0x1cb)](),'content':_0x5a7013}),_0x40583e(_0x244773(0x303)));}async function _0x261517(_0x3a32cd){const _0x58acbc=_0x549949,_0x412da7=_0x41df36['chats'][_0x18c6a2];if(!_0x412da7[_0x58acbc(0x5cb)])_0x412da7[_0x58acbc(0x5cb)]=[];_0x412da7[_0x58acbc(0x5cb)][_0x58acbc(0x258)]({'id':Date[_0x58acbc(0x108d)](),'title':_0x3a32cd[_0x58acbc(0xf3a)],'content':_0x3a32cd[_0x58acbc(0x11b6)]}),await _0x342df8[_0x58acbc(0x864)][_0x58acbc(0x9c0)](_0x412da7),_0x3c6b47();}async function _0x261517(_0x39a48f){const _0x10f6bd=_0x549949,_0x11907f=_0x41df36['chats'][_0x18c6a2];if(!_0x11907f[_0x10f6bd(0x5cb)])_0x11907f[_0x10f6bd(0x5cb)]=[];if(_0x5bdf0e){const _0x4a5c48=_0x11907f[_0x10f6bd(0x5cb)]['find'](_0x59f495=>_0x59f495['id']===_0x5bdf0e);if(_0x4a5c48)_0x4a5c48[_0x10f6bd(0x11b6)]=_0x39a48f;}else _0x11907f[_0x10f6bd(0x5cb)][_0x10f6bd(0x258)]({'id':Date['now'](),'content':_0x39a48f});await _0x342df8[_0x10f6bd(0x864)][_0x10f6bd(0x9c0)](_0x11907f),_0x3c6b47(),_0x5bdf0e=null;}async function _0x11c977(){const _0x333138=_0x549949;if(!_0x18c6a2)return;const _0x56d4fd=_0x41df36['chats'][_0x18c6a2];if(!_0x56d4fd)return;await _0x296ef9(_0x333138(0x4a6),_0x333138(0xff)+_0x56d4fd[_0x333138(0x461)]+_0x333138(0x1384));const {proxyUrl:_0x1dbd0b,apiKey:_0x4e4465,model:_0x177e2e}=_0x41df36[_0x333138(0x673)];if(!_0x1dbd0b||!_0x4e4465||!_0x177e2e){alert(_0x333138(0x2b7));return;}const _0x267290=_0x41df36[_0x333138(0x571)][_0x333138(0xabb)]===_0x333138(0x7da)||!_0x41df36['qzoneSettings'][_0x333138(0xabb)]?'用户':_0x41df36[_0x333138(0x571)][_0x333138(0xabb)],_0x45f061=_0x56d4fd[_0x333138(0x1349)]&&_0x56d4fd[_0x333138(0x1349)]['length']>0x0?_0x56d4fd[_0x333138(0x1349)][_0x333138(0xa79)](_0x554fe9=>_0x333138(0xde8)+_0xa3fdac(_0x554fe9['timestamp'])+')\x20'+_0x554fe9[_0x333138(0x11b6)])[_0x333138(0xa35)]('\x0a'):'无',_0x11d894=_0x56d4fd[_0x333138(0x886)][_0x333138(0x1138)]||0xa,_0x35bbdd=_0x56d4fd[_0x333138(0xd08)][_0x333138(0x1368)](-_0x11d894)[_0x333138(0xa79)](_0x11e62c=>(_0x11e62c['role']===_0x333138(0x66e)?_0x267290:_0x56d4fd[_0x333138(0x461)])+':\x20'+String(_0x11e62c[_0x333138(0x11b6)])[_0x333138(0xba5)](0x0,0x1e)+_0x333138(0x1026))[_0x333138(0xa35)]('\x0a'),_0x191b15=(_0x56d4fd['settings'][_0x333138(0xe8c)]||[])[_0x333138(0xa79)](_0x28854a=>_0x41df36[_0x333138(0xf17)][_0x333138(0xd12)](_0x402df1=>_0x402df1['id']===_0x28854a))[_0x333138(0x98a)](Boolean)[_0x333138(0xa79)](_0x1c30ec=>_0x333138(0xfb)+_0x1c30ec[_0x333138(0x461)]+_0x333138(0x2da)+_0x1c30ec['content'][_0x333138(0x98a)](_0x308dd0=>_0x308dd0[_0x333138(0x8e4)])[_0x333138(0xa79)](_0x42510e=>'-\x20'+_0x42510e[_0x333138(0x11b6)])[_0x333138(0xa35)]('\x0a'))[_0x333138(0xa35)](''),_0x23eb61=_0x1ad6bb(_0x56d4fd,0x3,_0x333138(0x2f2)),_0x1b5248=_0x1ad6bb(_0x56d4fd,0x6,_0x333138(0x2f2)),_0x53d4de=_0x1ad6bb(_0x56d4fd,0x9,_0x333138(0x2f2)),_0x151949=_0x1ad6bb(_0x56d4fd,0x1,'days'),_0x438bc5=_0x1ad6bb(_0x56d4fd,0x3,_0x333138(0x103b)),_0x1410ba=_0x1ad6bb(_0x56d4fd,0x7,_0x333138(0x103b));let _0x34f55b='';if(_0x23eb61||_0x1b5248||_0x53d4de||_0x151949||_0x438bc5||_0x1410ba){_0x34f55b+=_0x333138(0xda0);if(_0x23eb61)_0x34f55b+=_0x23eb61;if(_0x1b5248)_0x34f55b+=_0x1b5248;if(_0x53d4de)_0x34f55b+=_0x53d4de;if(_0x23eb61||_0x1b5248||_0x53d4de)_0x34f55b+='\x0a';if(_0x151949)_0x34f55b+=_0x151949;if(_0x438bc5)_0x34f55b+=_0x438bc5;if(_0x1410ba)_0x34f55b+=_0x1410ba;}const _0x1b083e=_0x56d4fd[_0x333138(0x886)][_0x333138(0xe63)]||'(未设置)',_0x99dede='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“'+_0x56d4fd[_0x333138(0x461)]+_0x333138(0x8f8)+new Date()[_0x333138(0xb8b)](_0x333138(0xafb))+_0x333138(0xc54)+_0x267290+_0x333138(0x87f)+_0x56d4fd[_0x333138(0x886)][_0x333138(0xd83)]+'\x0a-\x20**你的聊天对象设定**:'+_0x1b083e+_0x333138(0x3b8)+_0x45f061+'\x0a'+_0x191b15+'\x0a'+_0x34f55b+'\x20\x0a-\x20**你最近和“'+_0x267290+'”的对话摘要**:\x0a'+_0x35bbdd+'\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。';try{const _0x432511=[{'role':_0x333138(0x66e),'content':_0x333138(0x1053)}];let _0x53cd87=_0x1dbd0b[_0x333138(0xee2)](_0x333138(0xdc3)),_0x3afa7a=_0x112768(_0x177e2e,_0x4e4465,_0x99dede,_0x432511);const _0x7c6055=_0x53cd87?await fetch(_0x3afa7a[_0x333138(0x2fa)],_0x3afa7a[_0x333138(0x8c6)]):await fetch(_0x1dbd0b+_0x333138(0x126b),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x333138(0xd55)+_0x4e4465},'body':JSON[_0x333138(0x3fb)]({'model':_0x177e2e,'messages':[{'role':'system','content':_0x99dede},..._0x432511],'temperature':_0x41df36[_0x333138(0xc0)][_0x333138(0xa4a)]||0.95})});if(!_0x7c6055['ok'])throw new Error(_0x333138(0x85a)+_0x7c6055['statusText']);const _0xf5fd89=await _0x7c6055[_0x333138(0x9b3)](),_0x34ef11=getGeminiResponseText(_0xf5fd89),_0x50d219=_0x34ef11[_0x333138(0x22e)](/(\[[\s\S]*\])/);if(!_0x50d219||!_0x50d219[0x0])throw new Error(_0x333138(0x91c)+_0x34ef11);const _0xc3b031=_0x50d219[0x0];let _0x40fc20;try{_0x40fc20=JSON[_0x333138(0x134)](_0xc3b031);}catch(_0x371c2c){throw new Error(_0x333138(0x4b5)+_0x371c2c[_0x333138(0x5f8)]+_0x333138(0xbd)+_0x34ef11);}_0x56d4fd['diary']=_0x40fc20[_0x333138(0xa79)](_0x79c7a8=>({'id':Date[_0x333138(0x108d)]()+Math[_0x333138(0x5ce)](),'title':_0x79c7a8[_0x333138(0xf3a)],'content':_0x79c7a8['content'],'timestamp':Date[_0x333138(0x108d)]()})),await _0x342df8[_0x333138(0x864)][_0x333138(0x9c0)](_0x56d4fd),await _0x59bb9d();}catch(_0x25be60){console[_0x333138(0x98)](_0x333138(0x1166),_0x25be60),await _0x296ef9(_0x333138(0x91e),'无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20'+_0x25be60['message']);}}async function _0x55b7d1(){const _0x2b5043=_0x549949;if(!_0x18c6a2)return;const _0x11731a=_0x41df36[_0x2b5043(0x864)][_0x18c6a2];if(!_0x11731a)return;await _0x296ef9('请稍候...',_0x2b5043(0xff)+_0x11731a['name']+'”写一篇新日记...');const {proxyUrl:_0x25a998,apiKey:_0x5b0479,model:_0x5eb9a6}=_0x41df36['apiConfig'];if(!_0x25a998||!_0x5b0479||!_0x5eb9a6)return;const _0x3f4984=_0x41df36[_0x2b5043(0x571)][_0x2b5043(0xabb)]==='{{user}}'||!_0x41df36[_0x2b5043(0x571)]['nickname']?'用户':_0x41df36[_0x2b5043(0x571)]['nickname'],_0xa45bc8=_0x11731a[_0x2b5043(0x1349)]&&_0x11731a[_0x2b5043(0x1349)]['length']>0x0?_0x11731a['longTermMemory']['map'](_0x42ce83=>_0x2b5043(0xde8)+_0xa3fdac(_0x42ce83[_0x2b5043(0x3b7)])+')\x20'+_0x42ce83[_0x2b5043(0x11b6)])[_0x2b5043(0xa35)]('\x0a'):'无',_0x260585=_0x11731a[_0x2b5043(0x886)]['maxMemory']||0xa,_0x54473d=_0x11731a['history'][_0x2b5043(0x1368)](-_0x260585)[_0x2b5043(0xa79)](_0x3bd4fe=>(_0x3bd4fe[_0x2b5043(0x10ff)]==='user'?_0x3f4984:_0x11731a[_0x2b5043(0x461)])+':\x20'+String(_0x3bd4fe['content'])[_0x2b5043(0xba5)](0x0,0x1e)+_0x2b5043(0x1026))[_0x2b5043(0xa35)]('\x0a'),_0x4b796e=(_0x11731a[_0x2b5043(0x886)][_0x2b5043(0xe8c)]||[])[_0x2b5043(0xa79)](_0x37891c=>_0x41df36[_0x2b5043(0xf17)]['find'](_0x3f1e01=>_0x3f1e01['id']===_0x37891c))[_0x2b5043(0x98a)](Boolean)[_0x2b5043(0xa79)](_0x1ac57b=>_0x2b5043(0xfb)+_0x1ac57b[_0x2b5043(0x461)]+_0x2b5043(0x2da)+_0x1ac57b[_0x2b5043(0x11b6)][_0x2b5043(0x98a)](_0x58b946=>_0x58b946['enabled'])[_0x2b5043(0xa79)](_0x29f37a=>'-\x20'+_0x29f37a['content'])['join']('\x0a'))[_0x2b5043(0xa35)](''),_0x1dcb15=_0x2b5043(0x104c)+_0x11731a['name']+_0x2b5043(0x197)+new Date()[_0x2b5043(0xb8b)]('zh-CN')+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x11731a['settings'][_0x2b5043(0xd83)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0xa45bc8+'\x0a'+_0x4b796e+_0x2b5043(0x668)+_0x3f4984+'”的对话摘要**:\x0a'+_0x54473d+_0x2b5043(0x99e);try{const _0xad7e8f=[{'role':'user','content':_0x2b5043(0xbb8)}];let _0x53dd7a=_0x25a998[_0x2b5043(0xee2)](_0x2b5043(0xdc3)),_0x5788b6=_0x112768(_0x5eb9a6,_0x5b0479,_0x1dcb15,_0xad7e8f);const _0x214ccf=_0x53dd7a?await fetch(_0x5788b6[_0x2b5043(0x2fa)],_0x5788b6['data']):await fetch(_0x25a998+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x2b5043(0x11f0),'Authorization':_0x2b5043(0xd55)+_0x5b0479},'body':JSON[_0x2b5043(0x3fb)]({'model':_0x5eb9a6,'messages':[{'role':_0x2b5043(0xb1),'content':_0x1dcb15},..._0xad7e8f],'temperature':_0x41df36['globalSettings'][_0x2b5043(0xa4a)]||0.95})});if(!_0x214ccf['ok'])throw new Error('API\x20错误:\x20'+_0x214ccf['statusText']);const _0x5bbf9d=await _0x214ccf['json'](),_0x5107f9=getGeminiResponseText(_0x5bbf9d),_0x4f97bf=_0x5107f9[_0x2b5043(0x22e)](/(\[[\s\S]*\])/);if(!_0x4f97bf||!_0x4f97bf[0x0])throw new Error(_0x2b5043(0x91c)+_0x5107f9);const _0x3403a2=_0x4f97bf[0x0];let _0xc85a30;try{_0xc85a30=JSON['parse'](_0x3403a2)[0x0];}catch(_0xb73db2){throw new Error(_0x2b5043(0x4b5)+_0xb73db2[_0x2b5043(0x5f8)]+_0x2b5043(0xbd)+_0x5107f9);}if(!_0x11731a[_0x2b5043(0x6b3)])_0x11731a[_0x2b5043(0x6b3)]=[];_0x11731a[_0x2b5043(0x6b3)]['push']({'id':Date[_0x2b5043(0x108d)](),'title':_0xc85a30['title'],'content':_0xc85a30['content'],'timestamp':Date[_0x2b5043(0x108d)]()}),await _0x342df8['chats']['put'](_0x11731a),await _0x59bb9d();}catch(_0xf46bf0){console[_0x2b5043(0x98)](_0x2b5043(0x301),_0xf46bf0),await _0x296ef9(_0x2b5043(0x91e),_0x2b5043(0x1bd)+_0xf46bf0[_0x2b5043(0x5f8)]);}}function _0x59bb9d(){const _0x3bdfe9=_0x549949,_0x3622ff=document[_0x3bdfe9(0x383)](_0x3bdfe9(0x13a8));_0x3622ff['innerHTML']='';const _0x1c6b37=_0x41df36[_0x3bdfe9(0x864)][_0x18c6a2],_0x5a5d26=(_0x1c6b37['diary']||[])[_0x3bdfe9(0x1368)]()[_0x3bdfe9(0x1087)]();if(_0x5a5d26[_0x3bdfe9(0xfde)]===0x0){_0x3622ff['innerHTML']=_0x3bdfe9(0x11c9);return;}_0x5a5d26[_0x3bdfe9(0x19c)](_0x1b8506=>{const _0xe4a213=_0x3bdfe9,_0x474c9c=document[_0xe4a213(0xe1b)](_0xe4a213(0x7fd));_0x474c9c['className']=_0xe4a213(0x127d),_0x474c9c[_0xe4a213(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>'+_0x1b8506[_0xe4a213(0xf3a)]+_0xe4a213(0x12a4)+new Date(_0x1b8506[_0xe4a213(0x3b7)])['toLocaleDateString']()+_0xe4a213(0x802),_0x474c9c[_0xe4a213(0x271)]('click',()=>_0x2faea3(_0x1b8506['id'])),_0x3e15d1(_0x474c9c,()=>_0x4f5d23(_0x1b8506['id'])),_0x3622ff[_0xe4a213(0xe91)](_0x474c9c);});}async function _0x2faea3(_0x359dd5){const _0x210ae1=_0x549949,_0x3db04d=_0x41df36['chats'][_0x18c6a2];if(!_0x3db04d||!_0x3db04d[_0x210ae1(0x6b3)])return;const _0x2c2709=_0x3db04d['diary'][_0x210ae1(0xd12)](_0x4bea5e=>_0x4bea5e['id']===_0x359dd5);if(_0x2c2709){_0x5c2bda=_0x2c2709;const _0x782867=document['getElementById'](_0x210ae1(0x1a8)),_0xc554c6=document['getElementById'](_0x210ae1(0xd22)),_0x4032a9=document[_0x210ae1(0x383)]('favorite-diary-btn');_0x782867[_0x210ae1(0x138e)]=_0x2c2709[_0x210ae1(0xf3a)];const _0x4922b5=_0x350d3e(_0x2c2709['content'])[_0x210ae1(0x105d)]('\x0a')['map'](_0x32a1dd=>_0x210ae1(0x110)+(_0x32a1dd||_0x210ae1(0x114))+_0x210ae1(0x29a))[_0x210ae1(0xa35)]('');_0xc554c6['innerHTML']=_0x4922b5;const _0x5b2ea5=await _0x342df8[_0x210ae1(0x5c5)][_0x210ae1(0x6bd)]({'type':_0x210ae1(0x997),'content.id':_0x359dd5})['first']();_0x4032a9[_0x210ae1(0x119a)]['toggle'](_0x210ae1(0xde5),!!_0x5b2ea5),_0x40583e(_0x210ae1(0xa9c));}}async function _0x31eee9(){const _0xd61a1b=_0x549949;if(!_0x5c2bda||!_0x18c6a2)return;const _0x75d2a4=_0x5c2bda,_0x4a49c0=_0x41df36[_0xd61a1b(0x864)][_0x18c6a2],_0x3a5cf5=document[_0xd61a1b(0x383)](_0xd61a1b(0x192)),_0x4bc2c3=await _0x342df8[_0xd61a1b(0x5c5)][_0xd61a1b(0x6bd)]({'type':_0xd61a1b(0x997),'content.id':_0x75d2a4['id']})[_0xd61a1b(0x26e)]();if(_0x4bc2c3)await _0x342df8['favorites'][_0xd61a1b(0x971)](_0x4bc2c3['id']),_0x3a5cf5[_0xd61a1b(0x119a)]['remove'](_0xd61a1b(0xde5)),await _0x296ef9(_0xd61a1b(0x12bb),_0xd61a1b(0x8db));else{const _0x42114a={'type':'char_diary','content':{'id':_0x75d2a4['id'],'title':_0x75d2a4[_0xd61a1b(0xf3a)],'content':_0x75d2a4[_0xd61a1b(0x11b6)],'timestamp':_0x75d2a4[_0xd61a1b(0x3b7)],'characterId':_0x18c6a2,'characterName':_0x4a49c0[_0xd61a1b(0x461)]},'timestamp':Date[_0xd61a1b(0x108d)]()};await _0x342df8['favorites'][_0xd61a1b(0xbff)](_0x42114a),_0x3a5cf5[_0xd61a1b(0x119a)][_0xd61a1b(0xbff)](_0xd61a1b(0xde5)),await _0x296ef9(_0xd61a1b(0x12bb),'已成功收藏到“我的收藏”页面！');}}async function _0x296935(){const _0x46814b=_0x549949;if(!_0x140106||!_0x18c6a2)return;const _0xcea887=_0x140106,_0x2082c7=_0x41df36[_0x46814b(0x864)][_0x18c6a2],_0x23fa38=document[_0x46814b(0x383)](_0x46814b(0xf95)),_0x3056bb=await _0x342df8['favorites'][_0x46814b(0x6bd)]({'type':'char_memo','content.id':_0xcea887['id']})[_0x46814b(0x26e)]();if(_0x3056bb)await _0x342df8[_0x46814b(0x5c5)][_0x46814b(0x971)](_0x3056bb['id']),_0x23fa38[_0x46814b(0x119a)]['remove'](_0x46814b(0xde5)),await _0x296ef9(_0x46814b(0x12bb),_0x46814b(0x8db));else{const _0x39db35={'type':'char_memo','content':{'id':_0xcea887['id'],'title':_0xcea887[_0x46814b(0xf3a)],'content':_0xcea887[_0x46814b(0x11b6)],'timestamp':_0xcea887[_0x46814b(0x3b7)],'characterId':_0x18c6a2,'characterName':_0x2082c7[_0x46814b(0x461)]},'timestamp':Date[_0x46814b(0x108d)]()};await _0x342df8[_0x46814b(0x5c5)][_0x46814b(0xbff)](_0x39db35),_0x23fa38[_0x46814b(0x119a)]['add'](_0x46814b(0xde5)),await _0x296ef9(_0x46814b(0x12bb),_0x46814b(0xc95));}}async function _0x4f5d23(_0x1770a7){const _0x42bebd=_0x549949,_0x3e14e6=await _0x23a88b(_0x42bebd(0x1fb),_0x42bebd(0x65e),{'confirmButtonClass':'btn-danger'});if(_0x3e14e6){const _0x45cf01=_0x41df36[_0x42bebd(0x864)][_0x18c6a2];_0x45cf01[_0x42bebd(0x6b3)]=_0x45cf01[_0x42bebd(0x6b3)][_0x42bebd(0x98a)](_0x5ef2de=>_0x5ef2de['id']!==_0x1770a7),await _0x342df8['chats'][_0x42bebd(0x9c0)](_0x45cf01),_0x59bb9d();}}async function _0x3d133e(){const _0x14def4=_0x549949,_0x7f9463=document[_0x14def4(0x383)]('char-chat-list');_0x7f9463['innerHTML']='';const _0x298018=_0x41df36['chats'][_0x18c6a2];if(!_0x298018)return;const _0x264927=_0x298018['settings']['myNickname']||(_0x41df36[_0x14def4(0x571)][_0x14def4(0xabb)]||'我'),_0x16ebab=_0x298018[_0x14def4(0xd08)][_0x14def4(0x98a)](_0x7da959=>!_0x7da959[_0x14def4(0xbc5)])[_0x14def4(0x1368)](-0x1)[0x0]||{'content':_0x14def4(0x1026)};let _0x4499a9=_0x14def4(0x1026);if(_0x16ebab){if(typeof _0x16ebab[_0x14def4(0x11b6)]==='string')_0x4499a9=_0x16ebab[_0x14def4(0x11b6)];else{if(Array[_0x14def4(0x565)](_0x16ebab['content'])&&_0x16ebab[_0x14def4(0x11b6)][0x0]?.[_0x14def4(0xa6b)]===_0x14def4(0x122d))_0x4499a9=_0x14def4(0x1167);else{if(_0x16ebab[_0x14def4(0xa6b)]){const _0x25b43a={'voice_message':_0x14def4(0x310),'transfer':_0x14def4(0xd14),'ai_image':_0x14def4(0x1167)};_0x4499a9=_0x25b43a[_0x16ebab['type']]||'['+_0x16ebab[_0x14def4(0xa6b)]+']';}}}}const _0x3e8746=_0x298018[_0x14def4(0x886)][_0x14def4(0x43a)]||_0x5dc108,_0xe01958=_0x298018[_0x14def4(0x886)]['myAvatarFrame']||'';let _0x574b23;_0xe01958?_0x574b23=_0x14def4(0x8e2)+_0x3e8746+_0x14def4(0xef7)+_0xe01958+'\x22\x20class=\x22avatar-frame\x22></div></div>':_0x574b23=_0x14def4(0x57a)+_0x3e8746+_0x14def4(0x819);const _0x223f85=document['createElement']('div');_0x223f85[_0x14def4(0x556)]=_0x14def4(0x30c),_0x223f85[_0x14def4(0x118)][_0x14def4(0x10a8)]='-1',_0x223f85[_0x14def4(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x574b23+_0x14def4(0xd3a)+_0x264927+_0x14def4(0xe82)+String(_0x4499a9)[_0x14def4(0xba5)](0x0,0x14)+_0x14def4(0xffa),_0x7f9463[_0x14def4(0xe91)](_0x223f85);const _0x24dcb5=await _0x342df8[_0x14def4(0x656)][_0x14def4(0x21f)](),_0x204402=new Map(_0x24dcb5[_0x14def4(0xa79)](_0xa14061=>[_0xa14061['name'],_0xa14061])),_0x46b948=_0x298018[_0x14def4(0xa64)]||[];if(_0x46b948['length']===0x0&&!_0x223f85){_0x7f9463[_0x14def4(0x45c)]=_0x14def4(0x100d);return;}_0x46b948['forEach']((_0x198fb0,_0x3f4997)=>{const _0x56f99c=_0x14def4;if(_0x198fb0['type']===_0x56f99c(0x1364))return;const _0x4bf0da=document[_0x56f99c(0xe1b)](_0x56f99c(0x7fd));_0x4bf0da[_0x56f99c(0x556)]=_0x56f99c(0x30c),_0x4bf0da['dataset']['conversationIndex']=_0x3f4997;let _0x27d007,_0x4a9dc6,_0x2dff66;if(_0x198fb0[_0x56f99c(0xa6b)]===_0x56f99c(0x109d)){_0x2dff66=_0x198fb0[_0x56f99c(0x5d4)]+_0x56f99c(0xbcf),_0x27d007=_0x198fb0[_0x56f99c(0x3ae)][_0x56f99c(0x1368)](-0x1)[0x0]||{'content':'...'};const _0x4454bb=_0x56f99c(0x963)+_0x198fb0[_0x56f99c(0x5d4)]+'\x27',_0x258207=_0x41df36[_0x56f99c(0xc0)][_0x56f99c(0xb6a)]?_0x56f99c(0x5c1)+encodeURIComponent(_0x4454bb):_0x3e0950;_0x4a9dc6=_0x56f99c(0x64c)+_0x258207+_0x56f99c(0x1177);}else{_0x2dff66=_0x198fb0[_0x56f99c(0x123f)]['name'],_0x27d007=_0x198fb0[_0x56f99c(0x3ae)]['slice'](-0x1)[0x0]||{'content':_0x56f99c(0x1026)};const _0x69c7be=_0x204402[_0x56f99c(0x1a3)](_0x2dff66);let _0x3db0bc=_0x69c7be&&_0x69c7be[_0x56f99c(0xb47)]?_0x69c7be[_0x56f99c(0xb47)]:_0x41df36[_0x56f99c(0xc0)][_0x56f99c(0xb6a)]?_0x56f99c(0x5c1)+encodeURIComponent(_0x198fb0[_0x56f99c(0x123f)][_0x56f99c(0xcae)]||'anime\x20person'):_0x59100f;_0x4a9dc6='<div\x20class=\x22avatar-group\x22><img\x20src=\x22'+_0x3db0bc+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>';}let _0xacadce='...';_0x27d007&&_0x27d007['content']&&(_0xacadce=_0x27d007[_0x56f99c(0x11b6)]),_0x4bf0da['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4a9dc6+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x2dff66+_0x56f99c(0x828)+String(_0xacadce)[_0x56f99c(0xba5)](0x0,0x14)+_0x56f99c(0x1128),_0x7f9463['appendChild'](_0x4bf0da);});}async function _0x4fd0d9(){const _0x124fbe=_0x549949;if(!_0x18c6a2)return;const _0x17610e=_0x41df36[_0x124fbe(0x864)][_0x18c6a2];if(!_0x17610e)return;await _0x296ef9(_0x124fbe(0x4a6),_0x124fbe(0x629)+_0x17610e['name']+_0x124fbe(0x1072));const {proxyUrl:_0x19dedf,apiKey:_0x4607a6,model:_0x116376}=_0x41df36['apiConfig'];if(!_0x19dedf||!_0x4607a6||!_0x116376){alert('请先在API设置中配置好API信息。');return;}const _0x59ef90=await _0x342df8[_0x124fbe(0x656)][_0x124fbe(0x21f)](),_0xe821a2=_0x59ef90[_0x124fbe(0x98a)](_0x2b3206=>_0x2b3206['associatedWith']&&_0x2b3206[_0x124fbe(0x117)][_0x124fbe(0xee2)](_0x18c6a2));let _0x3019d7='#\x20你的社交圈\x20(绑定的NPC)\x0a';_0xe821a2['length']>0x0?(_0x3019d7+=_0x124fbe(0x83d),_0xe821a2['forEach'](_0x3bd3a6=>{const _0x1c76db=_0x124fbe;_0x3019d7+=_0x1c76db(0xa53)+_0x3bd3a6['name']+'\x0a\x20\x20-\x20**人设**:\x20'+_0x3bd3a6[_0x1c76db(0x48c)]+'\x0a';})):_0x3019d7+=_0x124fbe(0xe9a);const _0x1a6439=_0x41df36[_0x124fbe(0x571)]['nickname']==='{{user}}'||!_0x41df36[_0x124fbe(0x571)][_0x124fbe(0xabb)]?'用户':_0x41df36[_0x124fbe(0x571)][_0x124fbe(0xabb)],_0x854a3a=_0x17610e['settings'][_0x124fbe(0x52e)]||_0x1a6439,_0x4d7920=_0x17610e['longTermMemory']&&_0x17610e[_0x124fbe(0x1349)]['length']>0x0?_0x17610e['longTermMemory'][_0x124fbe(0xa79)](_0x479499=>_0x124fbe(0xde8)+_0xa3fdac(_0x479499[_0x124fbe(0x3b7)])+')\x20'+_0x479499['content'])[_0x124fbe(0xa35)]('\x0a'):'无',_0x5ea9be=_0x17610e[_0x124fbe(0x886)][_0x124fbe(0x1138)]||0xa,_0x4bc067=_0x17610e[_0x124fbe(0xd08)][_0x124fbe(0x1368)](-_0x5ea9be)[_0x124fbe(0xa79)](_0x258820=>(_0x258820[_0x124fbe(0x10ff)]===_0x124fbe(0x66e)?_0x854a3a:_0x17610e['name'])+':\x20'+String(_0x258820['content'])['substring'](0x0,0x1e)+_0x124fbe(0x1026))[_0x124fbe(0xa35)]('\x0a'),_0x45488f=(_0x17610e[_0x124fbe(0x886)][_0x124fbe(0xe8c)]||[])[_0x124fbe(0xa79)](_0x88146e=>_0x41df36[_0x124fbe(0xf17)][_0x124fbe(0xd12)](_0x225e5d=>_0x225e5d['id']===_0x88146e))[_0x124fbe(0x98a)](Boolean)[_0x124fbe(0xa79)](_0x56b75c=>'\x0a##\x20世界书《'+_0x56b75c['name']+_0x124fbe(0x21e)+_0x56b75c[_0x124fbe(0x11b6)][_0x124fbe(0x98a)](_0x25c30f=>_0x25c30f[_0x124fbe(0x8e4)])['map'](_0x599a2a=>'-\x20'+_0x599a2a[_0x124fbe(0x11b6)])[_0x124fbe(0xa35)]('\x0a'))[_0x124fbe(0xa35)](''),_0x1aa3a4=_0x17610e[_0x124fbe(0x283)]||_0x17610e[_0x124fbe(0x461)],_0x29c906=_0x37dbe7(_0x17610e),_0x383d6e=_0x124fbe(0x1267)+_0x17610e[_0x124fbe(0x461)]+_0x124fbe(0xb93)+_0x1aa3a4+_0x124fbe(0x6a9)+_0x1aa3a4+'\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22'+_0x1aa3a4+_0x124fbe(0xeea)+_0x17610e[_0x124fbe(0x886)][_0x124fbe(0xd83)]+_0x124fbe(0xa09)+_0x4d7920+_0x124fbe(0xb92)+_0x45488f+_0x124fbe(0x10db)+_0x4bc067+'\x0a'+_0x3019d7+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x29c906+'\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。';try{const _0x2e83d1=[{'role':_0x124fbe(0x66e),'content':_0x124fbe(0xfd1)}];let _0x31b107=_0x19dedf[_0x124fbe(0xee2)](_0x124fbe(0xdc3)),_0x47183e=_0x112768(_0x116376,_0x4607a6,_0x383d6e,_0x2e83d1);const _0x1203d5=_0x31b107?await fetch(_0x47183e[_0x124fbe(0x2fa)],_0x47183e['data']):await fetch(_0x19dedf+'/v1/chat/completions',{'method':_0x124fbe(0x94f),'headers':{'Content-Type':'application/json','Authorization':_0x124fbe(0xd55)+_0x4607a6},'body':JSON['stringify']({'model':_0x116376,'messages':[{'role':_0x124fbe(0xb1),'content':_0x383d6e},..._0x2e83d1],'temperature':_0x41df36[_0x124fbe(0xc0)][_0x124fbe(0xa4a)]||0.9})});if(!_0x1203d5['ok'])throw new Error('API\x20错误:\x20'+_0x1203d5[_0x124fbe(0x3ea)]);const _0x1732b9=await _0x1203d5[_0x124fbe(0x9b3)](),_0x114cbe=getGeminiResponseText(_0x1732b9),_0x1fa0a5=_0x114cbe['match'](/(\[[\s\S]*\])/);if(!_0x1fa0a5||!_0x1fa0a5[0x0])throw new Error(_0x124fbe(0x91c)+_0x114cbe);const _0x4d06ac=_0x1fa0a5[0x0];let _0x29d50c;try{_0x29d50c=JSON[_0x124fbe(0x134)](_0x4d06ac);}catch(_0x57bba0){throw new Error(_0x124fbe(0x4b5)+_0x57bba0['message']+_0x124fbe(0xbd)+_0x114cbe);}_0x17610e[_0x124fbe(0xa64)]=_0x29d50c,await _0x342df8[_0x124fbe(0x864)][_0x124fbe(0x9c0)](_0x17610e),await _0x3d133e();const _0x5e2cae={'role':_0x124fbe(0xb1),'content':_0x124fbe(0xd58),'timestamp':Date[_0x124fbe(0x108d)](),'isHidden':!![]};_0x17610e[_0x124fbe(0xd08)][_0x124fbe(0x258)](_0x5e2cae),await _0x342df8[_0x124fbe(0x864)][_0x124fbe(0x9c0)](_0x17610e),_0x11e743();}catch(_0x16d603){console[_0x124fbe(0x98)](_0x124fbe(0x11b7),_0x16d603),await _0x296ef9('生成失败',_0x124fbe(0xd29)+_0x16d603[_0x124fbe(0x5f8)]);}}async function _0x3df0e0(){const _0x1b8531=_0x549949;if(!_0x18c6a2)return;const _0x26f929=_0x41df36['chats'][_0x18c6a2];if(!_0x26f929)return;try{const {proxyUrl:_0x3e16f5,apiKey:_0x357401,model:_0x18c920}=_0x41df36[_0x1b8531(0x673)];if(!_0x3e16f5||!_0x357401||!_0x18c920)throw new Error('API未配置，无法生成对话。');const _0x17a437=parseInt(_0x26f929[_0x1b8531(0x886)][_0x1b8531(0x1138)])||0xa,_0x552818=_0x26f929[_0x1b8531(0xd08)][_0x1b8531(0x1368)](-_0x17a437),_0x168190=_0x26f929[_0x1b8531(0x886)][_0x1b8531(0x52e)]||'我',_0x2ec502=_0x26f929[_0x1b8531(0x886)][_0x1b8531(0xe63)]||'用户',_0x56e21a='#\x20长期记忆\x20(必须严格遵守)\x0a'+(_0x26f929[_0x1b8531(0x1349)]&&_0x26f929[_0x1b8531(0x1349)][_0x1b8531(0xfde)]>0x0?_0x26f929[_0x1b8531(0x1349)]['map'](_0x589156=>'-\x20'+_0x589156[_0x1b8531(0x11b6)])[_0x1b8531(0xa35)]('\x0a'):'-\x20(暂无)');let _0x161355='';if(_0x26f929['settings'][_0x1b8531(0xe8c)]&&_0x26f929[_0x1b8531(0x886)][_0x1b8531(0xe8c)][_0x1b8531(0xfde)]>0x0){const _0x2c93cd=_0x26f929[_0x1b8531(0x886)][_0x1b8531(0xe8c)]['map'](_0x353bb9=>{const _0x1c2cfe=_0x1b8531,_0x98c614=_0x41df36[_0x1c2cfe(0xf17)][_0x1c2cfe(0xd12)](_0x314408=>_0x314408['id']===_0x353bb9);if(!_0x98c614||!Array[_0x1c2cfe(0x565)](_0x98c614[_0x1c2cfe(0x11b6)]))return'';const _0x3aa976=_0x98c614[_0x1c2cfe(0x11b6)][_0x1c2cfe(0x98a)](_0x5b9b5b=>_0x5b9b5b['enabled']!==![])[_0x1c2cfe(0xa79)](_0x341499=>'\x0a###\x20条目:\x20'+(_0x341499[_0x1c2cfe(0x125b)]||_0x1c2cfe(0x138b))+_0x1c2cfe(0x801)+_0x341499[_0x1c2cfe(0x11b6)])[_0x1c2cfe(0xa35)]('');return _0x3aa976?_0x1c2cfe(0x6f9)+_0x98c614[_0x1c2cfe(0x461)]+'\x0a'+_0x3aa976:'';})['filter'](Boolean)[_0x1b8531(0xa35)]('');_0x2c93cd&&(_0x161355=_0x1b8531(0x749)+_0x2c93cd+'\x0a');}const _0x5199ac=_0x1ad6bb(_0x26f929,0x3,'hours'),_0x3b3776=_0x1ad6bb(_0x26f929,0x6,'hours'),_0x418fdd=_0x1ad6bb(_0x26f929,0x9,_0x1b8531(0x2f2)),_0x542b01=_0x1ad6bb(_0x26f929,0x1,_0x1b8531(0x103b)),_0x4531a1=_0x1ad6bb(_0x26f929,0x3,'days'),_0x39b0d2=_0x1ad6bb(_0x26f929,0x7,_0x1b8531(0x103b));let _0x36668b='';if(_0x5199ac||_0x3b3776||_0x418fdd||_0x542b01||_0x4531a1||_0x39b0d2){_0x36668b+=_0x1b8531(0xda0);if(_0x5199ac)_0x36668b+=_0x5199ac;if(_0x3b3776)_0x36668b+=_0x3b3776;if(_0x418fdd)_0x36668b+=_0x418fdd;if(_0x5199ac||_0x3b3776||_0x418fdd)_0x36668b+='\x0a';if(_0x542b01)_0x36668b+=_0x542b01;if(_0x4531a1)_0x36668b+=_0x4531a1;if(_0x39b0d2)_0x36668b+=_0x39b0d2;}const _0x105bf5=_0xd83680(_0x26f929),_0x388faa=_0x1b8531(0xef1)+_0x26f929['originalName']+_0x1b8531(0xe70)+_0x26f929[_0x1b8531(0x886)][_0x1b8531(0xd83)]+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x105bf5+_0x1b8531(0x10b1)+_0x2ec502+_0x1b8531(0x588)+_0x26f929[_0x1b8531(0x283)]+_0x1b8531(0xd27)+_0x168190+'\x22\x0a'+_0x161355+'\x0a'+_0x56e21a+'\x0a'+_0x36668b+_0x1b8531(0x2d7)+_0x552818[_0x1b8531(0xa79)](_0x489efb=>(_0x489efb[_0x1b8531(0x10ff)]===_0x1b8531(0x66e)?_0x168190:_0x26f929['name'])+':\x20'+String(_0x489efb['content']))['join']('\x0a')+_0x1b8531(0x4d0),_0x2f45cc=_0x552818[_0x1b8531(0xa79)](_0x568289=>({'role':_0x568289[_0x1b8531(0x10ff)],'content':(_0x568289['role']===_0x1b8531(0x66e)?_0x168190:_0x26f929[_0x1b8531(0x461)])+':\x20'+String(_0x568289[_0x1b8531(0x11b6)])}));let _0x6f6a1=_0x3e16f5[_0x1b8531(0xee2)]('generativelanguage'),_0x2cb861=_0x112768(_0x18c920,_0x357401,_0x388faa,_0x2f45cc);const _0x530777=_0x6f6a1?await fetch(_0x2cb861['url'],_0x2cb861[_0x1b8531(0x8c6)]):await fetch(_0x3e16f5+_0x1b8531(0x126b),{'method':_0x1b8531(0x94f),'headers':{'Content-Type':_0x1b8531(0x11f0),'Authorization':_0x1b8531(0xd55)+_0x357401},'body':JSON[_0x1b8531(0x3fb)]({'model':_0x18c920,'messages':[{'role':'system','content':_0x388faa},..._0x2f45cc],'temperature':_0x41df36['globalSettings'][_0x1b8531(0xa4a)]||0.8})});if(!_0x530777['ok'])throw new Error(_0x1b8531(0xb83)+(await _0x530777[_0x1b8531(0x9b3)]())[_0x1b8531(0x98)][_0x1b8531(0x5f8)]);const _0x3bd24e=await _0x530777[_0x1b8531(0x9b3)](),_0x420657=getGeminiResponseText(_0x3bd24e),_0x427301=_0x28b8fa(_0x420657);if(!_0x427301||_0x427301[_0x1b8531(0xfde)]===0x0)throw new Error(_0x1b8531(0x4d4));let _0x5c6ecb=0x0,_0x4dee56=Date[_0x1b8531(0x108d)]();for(const _0x3c96c0 of _0x427301){const _0x2b2cb0={'role':_0x1b8531(0xf3c),'senderName':_0x26f929[_0x1b8531(0x283)],'timestamp':_0x4dee56++};let _0x4ffc32=null;switch(_0x3c96c0[_0x1b8531(0xa6b)]){case'text':_0x4ffc32={..._0x2b2cb0,'content':String(_0x3c96c0[_0x1b8531(0x11b6)]||_0x3c96c0[_0x1b8531(0x5f8)])};break;case _0x1b8531(0x37d):if(_0x3c96c0[_0x1b8531(0x7de)]){const _0x173d39=_0x41df36['userStickers']['find'](_0x131d01=>_0x131d01['name']===_0x3c96c0[_0x1b8531(0x7de)]);_0x173d39?_0x4ffc32={..._0x2b2cb0,'type':_0x1b8531(0x37d),'content':_0x173d39['url'],'meaning':_0x173d39['name']}:(console['warn'](_0x1b8531(0x108c)+_0x3c96c0['meaning']+'\x22'),_0x4ffc32={..._0x2b2cb0,'type':_0x1b8531(0x6af),'content':_0x1b8531(0x261)+_0x3c96c0['meaning']+']'});}else console[_0x1b8531(0x17b)]('AI\x20(CPhone)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。',_0x3c96c0),_0x4ffc32={..._0x2b2cb0,'type':'sticker','content':_0x3c96c0['url'],'meaning':_0x1b8531(0x2a8)};break;}_0x4ffc32&&(_0x26f929[_0x1b8531(0xd08)][_0x1b8531(0x258)](_0x4ffc32),_0x5c6ecb++);}_0x5c6ecb>0x0&&(_0x26f929['unreadCount']=(_0x26f929[_0x1b8531(0x40c)]||0x0)+_0x5c6ecb),await _0x342df8['chats'][_0x1b8531(0x9c0)](_0x26f929),await _0x25558e(),_0x5c6ecb>0x0&&_0x193863(_0x26f929['id'],_0x1b8531(0x582)+_0x5c6ecb+_0x1b8531(0x6de));}catch(_0x3b3da5){console[_0x1b8531(0x98)]('从CPhone推进真实对话失败:',_0x3b3da5),await _0x296ef9(_0x1b8531(0xa55),_0x1b8531(0x5b4)+_0x3b3da5[_0x1b8531(0x5f8)]);}}async function _0x45c2c8(){const _0x229983=_0x549949;if(_0x219308||!_0x18c6a2)return;_0x219308=!![];const _0x5f25d2=document[_0x229983(0x383)](_0x229983(0x662)),_0x40ac8f=_0x41df36['chats'][_0x18c6a2];if(!_0x40ac8f){_0x219308=![];return;}_0x38d82d(_0x5f25d2,_0x229983(0x994));const _0x2ddce9=_0x5f25d2[_0x229983(0x36d)];await new Promise(_0x4d9d11=>setTimeout(_0x4d9d11,0x1f4));const _0x347676=_0x40ac8f[_0x229983(0xd08)]['length'],_0x26bee6=_0x41df36['globalSettings']['chatRenderWindow']||0x32,_0x45c887=_0x347676-_0x12646a,_0x2197fc=Math[_0x229983(0xaf3)](0x0,_0x45c887-_0x26bee6),_0xe5e478=_0x40ac8f['history'][_0x229983(0x1368)](_0x2197fc,_0x45c887);_0x3a7b5e(_0x5f25d2);if(_0xe5e478[_0x229983(0xfde)]===0x0){_0x219308=![];return;}for(const _0x21318f of _0xe5e478[_0x229983(0x1087)]()){const _0x47ae76={..._0x21318f,'role':_0x21318f[_0x229983(0x10ff)]===_0x229983(0x66e)?_0x229983(0xf3c):_0x229983(0x66e)},_0x403d0f={'id':'temp_user_chat_mirror','isGroup':![],'name':_0x40ac8f[_0x229983(0x461)],'settings':{..._0x40ac8f[_0x229983(0x886)],'myAvatar':_0x40ac8f[_0x229983(0x886)][_0x229983(0x121e)],'myAvatarFrame':_0x40ac8f['settings']['aiAvatarFrame'],'aiAvatar':_0x40ac8f['settings']['myAvatar'],'aiAvatarFrame':_0x40ac8f[_0x229983(0x886)][_0x229983(0x519)]}},_0x698ae6=await _0x152d98(_0x47ae76,_0x403d0f);_0x698ae6&&_0x5f25d2[_0x229983(0x7c9)](_0x698ae6);}_0x12646a+=_0xe5e478[_0x229983(0xfde)];const _0x563117=_0x5f25d2[_0x229983(0x36d)];_0x5f25d2[_0x229983(0x4f9)]=_0x563117-_0x2ddce9,_0x219308=![];}async function _0x1a0649(_0x458c14){const _0x55cc61=_0x549949,_0x145d55=_0x41df36[_0x55cc61(0x864)][_0x18c6a2];if(!_0x145d55)return;_0x1b52d4=_0x458c14===-0x1?_0x55cc61(0x1364):_0x145d55[_0x55cc61(0xa64)][_0x458c14]?.[_0x55cc61(0xa6b)];const _0x67975d=document['getElementById'](_0x55cc61(0x662));_0x67975d[_0x55cc61(0x45c)]='',_0x67975d['dataset'][_0x55cc61(0x53f)]=_0x145d55[_0x55cc61(0x886)]['theme']||_0x55cc61(0xba4);const _0x455849=document[_0x55cc61(0x383)](_0x55cc61(0x1200))[_0x55cc61(0x119a)][_0x55cc61(0x987)](_0x55cc61(0x3de));_0x67975d[_0x55cc61(0x655)]['backgroundColor']=_0x455849?_0x55cc61(0x763):_0x55cc61(0xb71);let _0x52388f,_0x476415=[];const _0x5d3142=await _0x342df8[_0x55cc61(0x656)]['toArray'](),_0x2fead2=new Map(_0x5d3142[_0x55cc61(0xa79)](_0x5388bc=>[_0x5388bc[_0x55cc61(0x461)],_0x5388bc]));if(_0x458c14===-0x1){_0x1b52d4='private_user';const _0x109363=document[_0x55cc61(0x383)](_0x55cc61(0x8de)),_0x403d26=document['getElementById'](_0x55cc61(0xb18));_0x67975d[_0x55cc61(0x45c)]='',_0x109363[_0x55cc61(0x138e)]=_0x145d55[_0x55cc61(0x886)][_0x55cc61(0x52e)]||(_0x41df36[_0x55cc61(0x571)]['nickname']||'我'),_0x403d26[_0x55cc61(0xda9)]='与\x20'+(_0x145d55['settings'][_0x55cc61(0x52e)]||'我')+_0x55cc61(0x1158),_0x12646a=0x0,_0x219308=![];const _0x13c088=_0x145d55[_0x55cc61(0xd08)],_0x4722a5=_0x41df36[_0x55cc61(0xc0)][_0x55cc61(0xcce)]||0x32,_0x3ef676=_0x13c088['slice'](-_0x4722a5);_0x52388f={'id':'temp_user_chat_mirror','isGroup':![],'name':_0x145d55[_0x55cc61(0x461)],'settings':{..._0x145d55['settings'],'myAvatar':_0x145d55[_0x55cc61(0x886)][_0x55cc61(0x121e)],'myAvatarFrame':_0x145d55['settings'][_0x55cc61(0x957)],'aiAvatar':_0x145d55[_0x55cc61(0x886)][_0x55cc61(0x43a)],'aiAvatarFrame':_0x145d55[_0x55cc61(0x886)][_0x55cc61(0x519)]}},_0x476415=_0x3ef676[_0x55cc61(0xa79)](_0x40327f=>({..._0x40327f,'role':_0x40327f[_0x55cc61(0x10ff)]===_0x55cc61(0x66e)?_0x55cc61(0xf3c):_0x55cc61(0x66e)})),_0x12646a=_0x3ef676[_0x55cc61(0xfde)];}else{const _0x17e94e=_0x145d55[_0x55cc61(0xa64)][_0x458c14];if(!_0x17e94e)return;_0x1b52d4=_0x17e94e['type'];const _0x5e5bc5=document[_0x55cc61(0x383)](_0x55cc61(0x8de)),_0x457d9d=document[_0x55cc61(0x383)]('char-simulated-input');if(_0x17e94e['type']==='group')_0x5e5bc5['textContent']=_0x17e94e[_0x55cc61(0x5d4)]+'\x20('+(_0x17e94e['participants'][_0x55cc61(0xfde)]+0x1)+')',_0x457d9d[_0x55cc61(0xda9)]='在\x20'+_0x17e94e[_0x55cc61(0x5d4)]+_0x55cc61(0xe46),_0x52388f={'id':_0x55cc61(0x441),'isGroup':!![],'name':_0x17e94e[_0x55cc61(0x5d4)],'originalName':_0x145d55['originalName'],'members':_0x17e94e[_0x55cc61(0x9a6)][_0x55cc61(0xa79)](_0x5e28f3=>{const _0xa0d396=_0x55cc61,_0x4c3c99=_0x2fead2[_0xa0d396(0x1a3)](_0x5e28f3['name']);let _0xf6837c=_0x4c3c99&&_0x4c3c99[_0xa0d396(0xb47)]?_0x4c3c99[_0xa0d396(0xb47)]:_0x41df36[_0xa0d396(0xc0)][_0xa0d396(0xb6a)]?_0xa0d396(0x5c1)+encodeURIComponent(_0x5e28f3[_0xa0d396(0xcae)]||_0xa0d396(0x4ca)):_0x59100f;return{'originalName':_0x5e28f3['name'],'groupNickname':_0x5e28f3[_0xa0d396(0x461)],'avatar':_0xf6837c};}),'settings':{..._0x145d55[_0x55cc61(0x886)],'myNickname':_0x145d55[_0x55cc61(0x461)],'myAvatar':_0x145d55[_0x55cc61(0x886)][_0x55cc61(0x121e)],'myAvatarFrame':_0x145d55['settings'][_0x55cc61(0x957)]}};else{_0x5e5bc5[_0x55cc61(0x138e)]=_0x17e94e[_0x55cc61(0x123f)][_0x55cc61(0x461)],_0x457d9d['placeholder']='与\x20'+_0x17e94e[_0x55cc61(0x123f)][_0x55cc61(0x461)]+_0x55cc61(0x393);const _0x4802a6=_0x2fead2[_0x55cc61(0x1a3)](_0x17e94e[_0x55cc61(0x123f)][_0x55cc61(0x461)]),_0x2caf32=_0x4802a6&&_0x4802a6[_0x55cc61(0xb47)]?_0x4802a6['avatar']:_0x41df36[_0x55cc61(0xc0)][_0x55cc61(0xb6a)]?_0x55cc61(0x5c1)+encodeURIComponent(_0x17e94e[_0x55cc61(0x123f)][_0x55cc61(0xcae)]||_0x55cc61(0x4ca)):_0x59100f;_0x52388f={'id':_0x55cc61(0xe74),'isGroup':![],'name':_0x17e94e[_0x55cc61(0x123f)][_0x55cc61(0x461)],'originalName':_0x145d55[_0x55cc61(0x283)],'settings':{..._0x145d55['settings'],'myAvatar':_0x145d55[_0x55cc61(0x886)]['aiAvatar'],'myAvatarFrame':_0x145d55['settings'][_0x55cc61(0x957)],'aiAvatar':_0x2caf32,'aiAvatarFrame':''}};}_0x476415=_0x17e94e[_0x55cc61(0x3ae)];}for(const _0x231502 of _0x476415){let _0x4d9551=_0x231502[_0x55cc61(0x10ff)];if(_0x458c14!==-0x1){const _0x27c53b=_0x231502['sender']===(_0x145d55['originalName']||_0x145d55[_0x55cc61(0x461)]);_0x4d9551=_0x27c53b?_0x55cc61(0x66e):_0x55cc61(0xf3c);}const _0x8a37e={'role':_0x4d9551,'senderName':_0x231502[_0x55cc61(0x91f)]||(_0x4d9551==='user'?_0x52388f[_0x55cc61(0x886)][_0x55cc61(0x52e)]:_0x52388f[_0x55cc61(0x461)]),'timestamp':_0x231502['timestamp']||Date[_0x55cc61(0x108d)]()+Math[_0x55cc61(0x5ce)]()};if(_0x231502[_0x55cc61(0xa6b)]==='sticker'&&_0x231502['meaning']){const _0x48b5ab=_0x41df36['userStickers'][_0x55cc61(0xd12)](_0x2ca708=>_0x2ca708['name']===_0x231502[_0x55cc61(0x7de)]);_0x48b5ab?(_0x8a37e['content']=_0x48b5ab['url'],_0x8a37e['meaning']=_0x231502[_0x55cc61(0x7de)],_0x8a37e[_0x55cc61(0xa6b)]=_0x55cc61(0x37d)):(console[_0x55cc61(0x17b)](_0x55cc61(0x1042)+_0x231502[_0x55cc61(0x7de)]+_0x55cc61(0x143)),_0x8a37e[_0x55cc61(0x11b6)]=_0x55cc61(0x261)+_0x231502[_0x55cc61(0x7de)]+']',_0x8a37e[_0x55cc61(0xa6b)]=_0x55cc61(0x6af));}else _0x8a37e[_0x55cc61(0x11b6)]=_0x231502[_0x55cc61(0x11b6)],_0x8a37e['type']=_0x231502[_0x55cc61(0xa6b)]||_0x55cc61(0x6af);const _0x323ba5=await _0x152d98(_0x8a37e,_0x52388f);_0x323ba5&&_0x67975d[_0x55cc61(0xe91)](_0x323ba5);}_0x40583e('char-qq-conversation-screen'),setTimeout(()=>_0x67975d['scrollTop']=_0x67975d[_0x55cc61(0x36d)],0x0);}function _0xf65324(){const _0x1a537f=_0x549949;document[_0x1a537f(0x383)]('char-qq-transcript-modal')[_0x1a537f(0x119a)][_0x1a537f(0x131d)](_0x1a537f(0x106d));}async function _0x23b708(){const _0x740f9c=_0x549949;if(!_0x18c6a2)return;const _0x164576=_0x41df36[_0x740f9c(0x864)][_0x18c6a2];if(!_0x164576){await _0x296ef9(_0x740f9c(0xa55),'无法找到当前角色的数据。');return;}await _0x296ef9(_0x740f9c(0x4a6),_0x740f9c(0xff)+_0x164576[_0x740f9c(0x461)]+_0x740f9c(0xde3));const {proxyUrl:_0x57684b,apiKey:_0x38e688,model:_0x323092}=_0x41df36[_0x740f9c(0x673)];if(!_0x57684b||!_0x38e688||!_0x323092){alert(_0x740f9c(0x2b7));return;}const _0x8c9ff8=_0x41df36[_0x740f9c(0x571)][_0x740f9c(0xabb)]==='{{user}}'||!_0x41df36[_0x740f9c(0x571)][_0x740f9c(0xabb)]?'用户':_0x41df36['qzoneSettings']['nickname'],_0x423738=_0x164576['longTermMemory']&&_0x164576[_0x740f9c(0x1349)][_0x740f9c(0xfde)]>0x0?_0x164576[_0x740f9c(0x1349)][_0x740f9c(0xa79)](_0x41db8b=>_0x740f9c(0xde8)+_0xa3fdac(_0x41db8b['timestamp'])+')\x20'+_0x41db8b['content'])[_0x740f9c(0xa35)]('\x0a'):'无',_0x316667=_0x164576[_0x740f9c(0x886)]['maxMemory']||0xa,_0x218ee0=_0x164576[_0x740f9c(0xd08)][_0x740f9c(0x1368)](-_0x316667)[_0x740f9c(0xa79)](_0x5e5ad1=>(_0x5e5ad1['role']===_0x740f9c(0x66e)?_0x8c9ff8:_0x164576[_0x740f9c(0x461)])+':\x20'+String(_0x5e5ad1['content'])['substring'](0x0,0x1e)+'...')[_0x740f9c(0xa35)]('\x0a'),_0x3e24fd=(_0x164576[_0x740f9c(0x886)][_0x740f9c(0xe8c)]||[])[_0x740f9c(0xa79)](_0xae2c89=>_0x41df36[_0x740f9c(0xf17)][_0x740f9c(0xd12)](_0x5b29e1=>_0x5b29e1['id']===_0xae2c89))[_0x740f9c(0x98a)](Boolean)[_0x740f9c(0xa79)](_0x4aac1c=>_0x740f9c(0xfb)+_0x4aac1c[_0x740f9c(0x461)]+_0x740f9c(0x2da)+_0x4aac1c[_0x740f9c(0x11b6)][_0x740f9c(0x98a)](_0x2b0592=>_0x2b0592[_0x740f9c(0x8e4)])[_0x740f9c(0xa79)](_0x24099f=>'-\x20'+_0x24099f[_0x740f9c(0x11b6)])[_0x740f9c(0xa35)]('\x0a'))[_0x740f9c(0xa35)](''),_0x8608a0=_0x1ad6bb(_0x164576,0x3,_0x740f9c(0x2f2)),_0x3157b5=_0x1ad6bb(_0x164576,0x6,_0x740f9c(0x2f2)),_0x1fd70e=_0x1ad6bb(_0x164576,0x9,_0x740f9c(0x2f2)),_0x521efe=_0x1ad6bb(_0x164576,0x1,'days'),_0x1b68c6=_0x1ad6bb(_0x164576,0x3,_0x740f9c(0x103b)),_0x21ed01=_0x1ad6bb(_0x164576,0x7,_0x740f9c(0x103b));let _0x2b57d1='';if(_0x8608a0||_0x3157b5||_0x1fd70e||_0x521efe||_0x1b68c6||_0x21ed01){_0x2b57d1+=_0x740f9c(0xda0);if(_0x8608a0)_0x2b57d1+=_0x8608a0;if(_0x3157b5)_0x2b57d1+=_0x3157b5;if(_0x1fd70e)_0x2b57d1+=_0x1fd70e;if(_0x8608a0||_0x3157b5||_0x1fd70e)_0x2b57d1+='\x0a';if(_0x521efe)_0x2b57d1+=_0x521efe;if(_0x1b68c6)_0x2b57d1+=_0x1b68c6;if(_0x21ed01)_0x2b57d1+=_0x21ed01;}const _0x45f961=_0x740f9c(0x4f2)+_0x164576['name']+'”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x164576['settings']['aiPersona']+'\x0a'+_0x423738+'\x0a'+_0x3e24fd+'\x0a'+_0x2b57d1+_0x740f9c(0x358)+_0x8c9ff8+_0x740f9c(0x120f)+_0x218ee0+_0x740f9c(0x19f);try{const _0x4b264a=[{'role':_0x740f9c(0x66e),'content':_0x740f9c(0x36f)}];let _0x312281=_0x57684b[_0x740f9c(0xee2)](_0x740f9c(0xdc3)),_0x952b93=_0x112768(_0x323092,_0x38e688,_0x45f961,_0x4b264a);const _0x40e6ca=_0x312281?await fetch(_0x952b93[_0x740f9c(0x2fa)],_0x952b93[_0x740f9c(0x8c6)]):await fetch(_0x57684b+_0x740f9c(0x126b),{'method':_0x740f9c(0x94f),'headers':{'Content-Type':_0x740f9c(0x11f0),'Authorization':'Bearer\x20'+_0x38e688},'body':JSON['stringify']({'model':_0x323092,'messages':[{'role':_0x740f9c(0xb1),'content':_0x45f961},..._0x4b264a],'temperature':_0x41df36[_0x740f9c(0xc0)][_0x740f9c(0xa4a)]||0.9})});if(!_0x40e6ca['ok'])throw new Error('API\x20错误:\x20'+_0x40e6ca['statusText']);const _0x4ce800=await _0x40e6ca['json'](),_0x20c986=getGeminiResponseText(_0x4ce800),_0x391aa8=_0x20c986[_0x740f9c(0x22e)](/(\[[\s\S]*\])/);if(!_0x391aa8||!_0x391aa8[0x0])throw new Error(_0x740f9c(0x91c)+_0x20c986);const _0x36edc3=_0x391aa8[0x0];let _0x3bbe42;try{_0x3bbe42=JSON[_0x740f9c(0x134)](_0x36edc3);}catch(_0xf7ec57){throw new Error(_0x740f9c(0x4b5)+_0xf7ec57[_0x740f9c(0x5f8)]+_0x740f9c(0xbd)+_0x20c986);}_0x164576[_0x740f9c(0x3f2)]=_0x3bbe42,await _0x342df8[_0x740f9c(0x864)][_0x740f9c(0x9c0)](_0x164576),await _0x519cc9();}catch(_0x3f5b0d){console[_0x740f9c(0x98)](_0x740f9c(0x51c),_0x3f5b0d),await _0x296ef9(_0x740f9c(0x91e),_0x740f9c(0xc3)+_0x3f5b0d[_0x740f9c(0x5f8)]);}}async function _0x519cc9(){const _0x459a6c=_0x549949,_0x507250=document[_0x459a6c(0x383)]('char-album-grid');_0x507250[_0x459a6c(0x45c)]='';if(!_0x18c6a2)return;const _0x5c4861=_0x41df36[_0x459a6c(0x864)][_0x18c6a2],_0x4ce900=_0x5c4861[_0x459a6c(0x3f2)]||[];if(_0x4ce900['length']===0x0){_0x507250['innerHTML']=_0x459a6c(0x376);return;}const _0x213b2a='https://i.postimg.cc/KYr2qRCK/1.jpg';_0x4ce900[_0x459a6c(0x19c)](_0x3cf2fa=>{const _0x6d2f4a=_0x459a6c,_0x110e31=document[_0x6d2f4a(0xe1b)](_0x6d2f4a(0x7fd));_0x110e31[_0x6d2f4a(0x556)]=_0x6d2f4a(0xe71),_0x110e31['dataset'][_0x6d2f4a(0xee1)]=_0x3cf2fa[_0x6d2f4a(0xee1)],_0x507250[_0x6d2f4a(0xe91)](_0x110e31);if(_0x41df36[_0x6d2f4a(0xc0)][_0x6d2f4a(0xb6a)]){_0x110e31[_0x6d2f4a(0x655)]['backgroundColor']='#e9ecef';const _0x3ec9d1=/[^\x00-\x7F]/[_0x6d2f4a(0xd73)](_0x3cf2fa[_0x6d2f4a(0x8d8)]),_0x37f3d7=_0x3cf2fa[_0x6d2f4a(0x8d8)]&&_0x3cf2fa[_0x6d2f4a(0x8d8)]['trim']()&&!_0x3ec9d1,_0x36b89a=_0x37f3d7?_0x3cf2fa[_0x6d2f4a(0x8d8)]:_0x6d2f4a(0x517),_0x54d09e=_0x6d2f4a(0x5c1)+encodeURIComponent(_0x36b89a),_0x585d0f=new Image();_0x585d0f['onload']=function(){const _0x3084f1=_0x6d2f4a;_0x110e31['style'][_0x3084f1(0x880)]=_0x3084f1(0xb9a)+this['src']+')';},_0x585d0f[_0x6d2f4a(0x40f)]=function(){const _0x4fd7fa=_0x6d2f4a;_0x110e31[_0x4fd7fa(0x655)][_0x4fd7fa(0x880)]='url('+_0x213b2a+')';},_0x585d0f[_0x6d2f4a(0xf6c)]=_0x54d09e;}else{_0x110e31['style']['backgroundColor']=_0x6d2f4a(0xb71),_0x110e31['style'][_0x6d2f4a(0xbc1)]=_0x6d2f4a(0xdb0);const _0x5f3edb=document['createElement']('p');_0x5f3edb['className']=_0x6d2f4a(0x87b),_0x5f3edb[_0x6d2f4a(0x138e)]=_0x3cf2fa[_0x6d2f4a(0xee1)]||_0x6d2f4a(0xb0e),_0x110e31[_0x6d2f4a(0xe91)](_0x5f3edb);}});}async function _0x5348fc(){const _0x188bce=_0x549949;if(!_0x18c6a2)return;const _0x5c53da=_0x41df36['chats'][_0x18c6a2];if(!_0x5c53da)return;await _0x296ef9(_0x188bce(0x4a6),_0x188bce(0x781)+_0x5c53da[_0x188bce(0x461)]+_0x188bce(0xb84));const {proxyUrl:_0x503f68,apiKey:_0x12828d,model:_0x1a5e13}=_0x41df36['apiConfig'];if(!_0x503f68||!_0x12828d||!_0x1a5e13){alert(_0x188bce(0xbab));return;}const _0x5dfc9c=_0x41df36['qzoneSettings']['nickname']===_0x188bce(0x7da)||!_0x41df36[_0x188bce(0x571)][_0x188bce(0xabb)]?'用户':_0x41df36[_0x188bce(0x571)]['nickname'],_0xfb72fe=_0x5c53da[_0x188bce(0x1349)]&&_0x5c53da['longTermMemory'][_0x188bce(0xfde)]>0x0?_0x5c53da['longTermMemory'][_0x188bce(0xa79)](_0x354bdd=>_0x188bce(0xde8)+_0xa3fdac(_0x354bdd['timestamp'])+')\x20'+_0x354bdd[_0x188bce(0x11b6)])[_0x188bce(0xa35)]('\x0a'):'无',_0x1283ab=_0x5c53da[_0x188bce(0x886)][_0x188bce(0x1138)]||0xa,_0x189cbc=_0x5c53da[_0x188bce(0xd08)][_0x188bce(0x1368)](-_0x1283ab)[_0x188bce(0xa79)](_0x2bc4b3=>(_0x2bc4b3['role']===_0x188bce(0x66e)?_0x5dfc9c:_0x5c53da[_0x188bce(0x461)])+':\x20'+String(_0x2bc4b3[_0x188bce(0x11b6)])[_0x188bce(0xba5)](0x0,0x1e)+_0x188bce(0x1026))[_0x188bce(0xa35)]('\x0a'),_0x48b09c=(_0x5c53da[_0x188bce(0x886)][_0x188bce(0xe8c)]||[])[_0x188bce(0xa79)](_0x2599bb=>_0x41df36['worldBooks'][_0x188bce(0xd12)](_0x4471d6=>_0x4471d6['id']===_0x2599bb))['filter'](Boolean)[_0x188bce(0xa79)](_0x4b2749=>'\x0a##\x20世界书《'+_0x4b2749['name']+'》设定:\x0a'+_0x4b2749['content']['filter'](_0x3f9627=>_0x3f9627[_0x188bce(0x8e4)])[_0x188bce(0xa79)](_0x2b2e60=>'-\x20'+_0x2b2e60[_0x188bce(0x11b6)])[_0x188bce(0xa35)]('\x0a'))[_0x188bce(0xa35)](''),_0x4caef2=_0x1ad6bb(_0x5c53da,0x3,_0x188bce(0x2f2)),_0x4036f0=_0x1ad6bb(_0x5c53da,0x6,'hours'),_0x262260=_0x1ad6bb(_0x5c53da,0x9,_0x188bce(0x2f2)),_0x530064=_0x1ad6bb(_0x5c53da,0x1,_0x188bce(0x103b)),_0x374b5e=_0x1ad6bb(_0x5c53da,0x3,_0x188bce(0x103b)),_0x4527dc=_0x1ad6bb(_0x5c53da,0x7,_0x188bce(0x103b));let _0x17cd5b='';if(_0x4caef2||_0x4036f0||_0x262260||_0x530064||_0x374b5e||_0x4527dc){_0x17cd5b+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x4caef2)_0x17cd5b+=_0x4caef2;if(_0x4036f0)_0x17cd5b+=_0x4036f0;if(_0x262260)_0x17cd5b+=_0x262260;if(_0x4caef2||_0x4036f0||_0x262260)_0x17cd5b+='\x0a';if(_0x530064)_0x17cd5b+=_0x530064;if(_0x374b5e)_0x17cd5b+=_0x374b5e;if(_0x4527dc)_0x17cd5b+=_0x4527dc;}const _0x5874a6=_0x5c53da[_0x188bce(0x886)][_0x188bce(0xe63)]||_0x188bce(0x11f),_0x4ec4ea=_0x188bce(0x4f2)+_0x5c53da[_0x188bce(0x461)]+_0x188bce(0x307)+_0x5c53da['settings']['aiPersona']+_0x188bce(0x64e)+_0x5874a6+'\x0a-\x20**你的长期记忆**:\x0a'+_0xfb72fe+'\x0a'+_0x48b09c+'\x0a'+_0x17cd5b+'\x20\x0a-\x20**你最近和“'+_0x5dfc9c+_0x188bce(0x120f)+_0x189cbc+_0x188bce(0x669);try{const _0x18e6ed=[{'role':_0x188bce(0x66e),'content':_0x188bce(0x127f)}];let _0x2cc50c=_0x503f68[_0x188bce(0xee2)]('generativelanguage'),_0x5a4806=_0x112768(_0x1a5e13,_0x12828d,_0x4ec4ea,_0x18e6ed);const _0x1138d6=_0x2cc50c?await fetch(_0x5a4806['url'],_0x5a4806['data']):await fetch(_0x503f68+_0x188bce(0x126b),{'method':_0x188bce(0x94f),'headers':{'Content-Type':_0x188bce(0x11f0),'Authorization':_0x188bce(0xd55)+_0x12828d},'body':JSON[_0x188bce(0x3fb)]({'model':_0x1a5e13,'messages':[{'role':'system','content':_0x4ec4ea},..._0x18e6ed],'temperature':_0x41df36[_0x188bce(0xc0)][_0x188bce(0xa4a)]||0.9})});if(!_0x1138d6['ok'])throw new Error(_0x188bce(0x85a)+_0x1138d6[_0x188bce(0x3ea)]);const _0x3ab729=await _0x1138d6[_0x188bce(0x9b3)](),_0x2fa978=getGeminiResponseText(_0x3ab729),_0x437bc5=_0x2fa978[_0x188bce(0x22e)](/(\[[\s\S]*\])/);if(!_0x437bc5||!_0x437bc5[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x2fa978);const _0x44616e=_0x437bc5[0x0];let _0x18c8ce;try{_0x18c8ce=JSON['parse'](_0x44616e);}catch(_0x56a316){throw new Error('解析AI返回的JSON时出错:\x20'+_0x56a316['message']+_0x188bce(0xbd)+_0x2fa978);}_0x5c53da[_0x188bce(0x50b)]=_0x18c8ce,await _0x342df8['chats'][_0x188bce(0x9c0)](_0x5c53da),await _0x540acb();}catch(_0x4a15ec){console[_0x188bce(0x98)]('生成模拟浏览器历史失败:',_0x4a15ec),await _0x296ef9(_0x188bce(0x91e),_0x188bce(0xaaa)+_0x4a15ec['message']);}}function _0x540acb(){const _0x359ceb=_0x549949,_0x161ab1=document['getElementById'](_0x359ceb(0x105c));_0x161ab1['innerHTML']='';if(!_0x18c6a2)return;const _0x3d92fe=_0x41df36[_0x359ceb(0x864)][_0x18c6a2],_0x2b54c7=_0x3d92fe['simulatedBrowserHistory']||[];if(_0x2b54c7[_0x359ceb(0xfde)]===0x0){_0x161ab1[_0x359ceb(0x45c)]=_0x359ceb(0x119e);return;}_0x2b54c7['forEach']((_0x176390,_0x77e411)=>{const _0x4a3532=_0x359ceb,_0x1bf78b=document[_0x4a3532(0xe1b)](_0x4a3532(0x7fd));_0x1bf78b[_0x4a3532(0x556)]='char-browser-item',_0x1bf78b[_0x4a3532(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x176390[_0x4a3532(0xf3a)]+_0x4a3532(0x1273)+_0x176390[_0x4a3532(0x2fa)]+_0x4a3532(0x9be),_0x1bf78b[_0x4a3532(0x271)](_0x4a3532(0x5c7),()=>_0x539d89(_0x77e411)),_0x161ab1['appendChild'](_0x1bf78b);});}async function _0x539d89(_0x4020fb){const _0x13c46f=_0x549949,_0x48ce8f=_0x41df36[_0x13c46f(0x864)][_0x18c6a2],_0x17b61c=_0x48ce8f[_0x13c46f(0x50b)][_0x4020fb];if(!_0x17b61c)return;_0x4df75e=_0x17b61c,_0x460a6f(_0x17b61c),_0x40583e(_0x13c46f(0xc1d));const _0x30d2f6=document[_0x13c46f(0x383)](_0x13c46f(0x5df)),_0x49cddb=await _0x342df8[_0x13c46f(0x5c5)]['where']({'type':'char_browser_article','content.url':_0x17b61c['url']})[_0x13c46f(0x26e)]();_0x30d2f6[_0x13c46f(0x119a)][_0x13c46f(0x8f0)](_0x13c46f(0xde5),!!_0x49cddb);}async function _0x29fe56(){const _0x155346=_0x549949;if(!_0x4df75e||!_0x18c6a2)return;const _0x1e57a8=_0x4df75e,_0x28426a=_0x41df36[_0x155346(0x864)][_0x18c6a2],_0x5c7e66=document[_0x155346(0x383)](_0x155346(0x5df)),_0x105713=await _0x342df8[_0x155346(0x5c5)]['where']({'type':'char_browser_article','content.url':_0x1e57a8[_0x155346(0x2fa)]})[_0x155346(0x26e)]();if(_0x105713)await _0x342df8[_0x155346(0x5c5)]['delete'](_0x105713['id']),_0x5c7e66[_0x155346(0x119a)][_0x155346(0x131d)](_0x155346(0xde5)),await _0x296ef9(_0x155346(0x12bb),'已取消收藏。');else{const _0x4677df={'type':_0x155346(0xa1b),'content':{..._0x1e57a8,'characterId':_0x18c6a2,'characterName':_0x28426a['name']},'timestamp':Date['now']()};await _0x342df8[_0x155346(0x5c5)]['add'](_0x4677df),_0x5c7e66[_0x155346(0x119a)][_0x155346(0xbff)](_0x155346(0xde5)),await _0x296ef9(_0x155346(0x12bb),'已成功收藏到“我的收藏”页面！');}}function _0x460a6f(_0x3cb3a0){const _0x293877=_0x549949,_0x4cb173=document[_0x293877(0x383)](_0x293877(0xcb3)),_0x59dda7=document[_0x293877(0x383)](_0x293877(0xdb1));_0x4cb173['textContent']=_0x3cb3a0[_0x293877(0xf3a)],_0x59dda7[_0x293877(0x45c)]='',_0x3cb3a0[_0x293877(0xa6b)]==='image'?_0x59dda7['innerHTML']='<p\x20class=\x22char-browser-image-description\x22>'+(_0x3cb3a0['title']||_0x293877(0xa8a))+'</p>':_0x59dda7[_0x293877(0x45c)]=_0x293877(0x110)+(_0x3cb3a0[_0x293877(0x11b6)]||'内容加载失败...')[_0x293877(0x709)](/\n/g,_0x293877(0x94))+'</p>';}async function _0x3445e9(){const _0x5a7a44=_0x549949;if(!_0x18c6a2)return;const _0x378c71=_0x41df36[_0x5a7a44(0x864)][_0x18c6a2];if(!_0x378c71)return;await _0x296ef9('请稍候...',_0x5a7a44(0x781)+_0x378c71['name']+_0x5a7a44(0xd21));const {proxyUrl:_0x28b39d,apiKey:_0x272708,model:_0x554d04}=_0x41df36[_0x5a7a44(0x673)];if(!_0x28b39d||!_0x272708||!_0x554d04){alert(_0x5a7a44(0xbab));return;}const _0x453913=_0x41df36[_0x5a7a44(0x571)][_0x5a7a44(0xabb)]===_0x5a7a44(0x7da)||!_0x41df36[_0x5a7a44(0x571)][_0x5a7a44(0xabb)]?'用户':_0x41df36[_0x5a7a44(0x571)][_0x5a7a44(0xabb)],_0x37cbd1=_0x378c71[_0x5a7a44(0x1349)]&&_0x378c71[_0x5a7a44(0x1349)][_0x5a7a44(0xfde)]>0x0?_0x378c71['longTermMemory'][_0x5a7a44(0xa79)](_0x54a2cd=>_0x5a7a44(0xde8)+_0xa3fdac(_0x54a2cd[_0x5a7a44(0x3b7)])+')\x20'+_0x54a2cd[_0x5a7a44(0x11b6)])[_0x5a7a44(0xa35)]('\x0a'):'无',_0x3b406e=_0x378c71[_0x5a7a44(0x886)][_0x5a7a44(0x1138)]||0xa,_0x427c4d=_0x378c71[_0x5a7a44(0xd08)][_0x5a7a44(0x1368)](-_0x3b406e)[_0x5a7a44(0xa79)](_0x9e71ca=>(_0x9e71ca[_0x5a7a44(0x10ff)]===_0x5a7a44(0x66e)?_0x453913:_0x378c71[_0x5a7a44(0x461)])+':\x20'+String(_0x9e71ca[_0x5a7a44(0x11b6)])['substring'](0x0,0x1e)+_0x5a7a44(0x1026))[_0x5a7a44(0xa35)]('\x0a'),_0x1df960=(_0x378c71[_0x5a7a44(0x886)]['linkedWorldBookIds']||[])[_0x5a7a44(0xa79)](_0x1a27bb=>_0x41df36[_0x5a7a44(0xf17)][_0x5a7a44(0xd12)](_0x1c5f41=>_0x1c5f41['id']===_0x1a27bb))[_0x5a7a44(0x98a)](Boolean)['map'](_0x5d8d9c=>_0x5a7a44(0xfb)+_0x5d8d9c[_0x5a7a44(0x461)]+_0x5a7a44(0x2da)+_0x5d8d9c[_0x5a7a44(0x11b6)][_0x5a7a44(0x98a)](_0x53297d=>_0x53297d[_0x5a7a44(0x8e4)])[_0x5a7a44(0xa79)](_0x47c09b=>'-\x20'+_0x47c09b[_0x5a7a44(0x11b6)])[_0x5a7a44(0xa35)]('\x0a'))['join'](''),_0x3565f8=_0x1ad6bb(_0x378c71,0x3,'hours'),_0x493523=_0x1ad6bb(_0x378c71,0x6,_0x5a7a44(0x2f2)),_0x5d0bfe=_0x1ad6bb(_0x378c71,0x9,'hours'),_0x100394=_0x1ad6bb(_0x378c71,0x1,_0x5a7a44(0x103b)),_0x131b58=_0x1ad6bb(_0x378c71,0x3,'days'),_0x24bc8f=_0x1ad6bb(_0x378c71,0x7,_0x5a7a44(0x103b));let _0x4452f3='';if(_0x3565f8||_0x493523||_0x5d0bfe||_0x100394||_0x131b58||_0x24bc8f){_0x4452f3+=_0x5a7a44(0xda0);if(_0x3565f8)_0x4452f3+=_0x3565f8;if(_0x493523)_0x4452f3+=_0x493523;if(_0x5d0bfe)_0x4452f3+=_0x5d0bfe;if(_0x3565f8||_0x493523||_0x5d0bfe)_0x4452f3+='\x0a';if(_0x100394)_0x4452f3+=_0x100394;if(_0x131b58)_0x4452f3+=_0x131b58;if(_0x24bc8f)_0x4452f3+=_0x24bc8f;}const _0xa6efa9='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x378c71[_0x5a7a44(0x461)]+_0x5a7a44(0xb42)+_0x378c71[_0x5a7a44(0x886)][_0x5a7a44(0xd83)]+_0x5a7a44(0x3b8)+_0x37cbd1+'\x0a'+_0x1df960+'\x0a'+_0x4452f3+_0x5a7a44(0x358)+_0x453913+_0x5a7a44(0x120f)+_0x427c4d+_0x5a7a44(0xc5c);try{const _0x1c7ec2=[{'role':'user','content':_0x5a7a44(0x135d)}];let _0x3be1d5=_0x28b39d[_0x5a7a44(0xee2)](_0x5a7a44(0xdc3)),_0x2bfcb2=_0x112768(_0x554d04,_0x272708,_0xa6efa9,_0x1c7ec2);const _0x1eeb0b=_0x3be1d5?await fetch(_0x2bfcb2[_0x5a7a44(0x2fa)],_0x2bfcb2[_0x5a7a44(0x8c6)]):await fetch(_0x28b39d+_0x5a7a44(0x126b),{'method':_0x5a7a44(0x94f),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x272708},'body':JSON[_0x5a7a44(0x3fb)]({'model':_0x554d04,'messages':[{'role':'system','content':_0xa6efa9},..._0x1c7ec2],'temperature':_0x41df36['globalSettings'][_0x5a7a44(0xa4a)]||0.9})});if(!_0x1eeb0b['ok'])throw new Error(_0x5a7a44(0x85a)+_0x1eeb0b[_0x5a7a44(0x3ea)]);const _0x5679dd=await _0x1eeb0b['json'](),_0xa7e7f8=getGeminiResponseText(_0x5679dd),_0x2e1edd=_0xa7e7f8['match'](/({[\s\S]*})/);if(!_0x2e1edd)throw new Error('AI返回的内容中未找到有效的JSON对象。');const _0x71ca0e=JSON['parse'](_0x2e1edd[0x0]);!_0x71ca0e['purchases']&&(_0x71ca0e[_0x5a7a44(0xa38)]=[]),_0x378c71[_0x5a7a44(0x2ab)]=_0x71ca0e,await _0x342df8[_0x5a7a44(0x864)][_0x5a7a44(0x9c0)](_0x378c71),await _0x232b41();}catch(_0x497698){console[_0x5a7a44(0x98)](_0x5a7a44(0x83b),_0x497698),await _0x296ef9(_0x5a7a44(0x91e),_0x5a7a44(0xfa6)+_0x497698[_0x5a7a44(0x5f8)]);}}function _0x5d8965(){_0x353536(),_0x40583e('char-wallet-screen');}function _0x353536(){const _0x489a82=_0x549949,_0x37d118=document[_0x489a82(0x383)]('char-wallet-content');_0x37d118['innerHTML']='';const _0x38a747=_0x41df36[_0x489a82(0x864)][_0x18c6a2],_0x4418bf=_0x38a747[_0x489a82(0x2ab)]||{},_0x2b8bd1=_0x4418bf[_0x489a82(0xa38)]||[],_0x37c7f5=_0x4418bf[_0x489a82(0x131b)]||0x0,_0x6711a=document['createElement'](_0x489a82(0x7fd));_0x6711a[_0x489a82(0x655)][_0x489a82(0x1ae)]=_0x489a82(0x11fd),_0x6711a[_0x489a82(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥'+_0x37c7f5[_0x489a82(0x70d)](0x2)+_0x489a82(0x10fb),_0x37d118['appendChild'](_0x6711a);const _0x2ae434=document[_0x489a82(0xe1b)]('h3');_0x2ae434[_0x489a82(0x138e)]=_0x489a82(0x72f),_0x2ae434[_0x489a82(0x655)][_0x489a82(0x1ae)]=_0x489a82(0x777),_0x37d118['appendChild'](_0x2ae434);if(_0x2b8bd1[_0x489a82(0xfde)]===0x0){_0x37d118[_0x489a82(0x45c)]+=_0x489a82(0xfa1);return;}_0x2b8bd1[_0x489a82(0x19c)](_0x3c1e38=>{const _0x29f814=_0x489a82,_0x39c989=document['createElement'](_0x29f814(0x7fd));_0x39c989[_0x29f814(0x655)][_0x29f814(0x1ae)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x39c989[_0x29f814(0x45c)]=_0x29f814(0xcd8)+_0x3c1e38[_0x29f814(0xc70)]+_0x29f814(0xdd4)+_0x3c1e38['status']+_0x29f814(0x6dd)+(_0x3c1e38[_0x29f814(0xa19)]||0x0)[_0x29f814(0x70d)](0x2)+_0x29f814(0x9be),_0x37d118[_0x29f814(0xe91)](_0x39c989);});}async function _0x153940(){const _0xc48480=_0x549949;if(!_0x18c6a2)return;const _0x7a5600=_0x41df36[_0xc48480(0x864)][_0x18c6a2];if(!_0x7a5600)return;await _0x296ef9(_0xc48480(0x4a6),_0xc48480(0xff)+_0x7a5600[_0xc48480(0x461)]+_0xc48480(0x1234));const {proxyUrl:_0x1bd20b,apiKey:_0x4b27a2,model:_0x1facbe}=_0x41df36[_0xc48480(0x673)];if(!_0x1bd20b||!_0x4b27a2||!_0x1facbe){alert(_0xc48480(0x2b7));return;}const _0x141981=_0x41df36[_0xc48480(0x571)]['nickname']===_0xc48480(0x7da)||!_0x41df36['qzoneSettings'][_0xc48480(0xabb)]?'用户':_0x41df36[_0xc48480(0x571)][_0xc48480(0xabb)],_0x35538a=_0x7a5600[_0xc48480(0x1349)]&&_0x7a5600[_0xc48480(0x1349)][_0xc48480(0xfde)]>0x0?_0x7a5600['longTermMemory'][_0xc48480(0xa79)](_0x3496d1=>_0xc48480(0xde8)+_0xa3fdac(_0x3496d1[_0xc48480(0x3b7)])+')\x20'+_0x3496d1['content'])[_0xc48480(0xa35)]('\x0a'):'无',_0x14e003=_0x7a5600['settings'][_0xc48480(0x1138)]||0xa,_0x1b112d=_0x7a5600[_0xc48480(0xd08)][_0xc48480(0x1368)](-_0x14e003)[_0xc48480(0xa79)](_0x2da04e=>(_0x2da04e['role']===_0xc48480(0x66e)?_0x141981:_0x7a5600[_0xc48480(0x461)])+':\x20'+String(_0x2da04e[_0xc48480(0x11b6)])['substring'](0x0,0x1e)+_0xc48480(0x1026))[_0xc48480(0xa35)]('\x0a'),_0x1f846a=(_0x7a5600['settings'][_0xc48480(0xe8c)]||[])[_0xc48480(0xa79)](_0x4dbd45=>_0x41df36['worldBooks'][_0xc48480(0xd12)](_0x1f2a53=>_0x1f2a53['id']===_0x4dbd45))[_0xc48480(0x98a)](Boolean)[_0xc48480(0xa79)](_0x446b76=>_0xc48480(0xfb)+_0x446b76[_0xc48480(0x461)]+'》设定:\x0a'+_0x446b76['content'][_0xc48480(0x98a)](_0x35bc87=>_0x35bc87[_0xc48480(0x8e4)])[_0xc48480(0xa79)](_0x3c2080=>'-\x20'+_0x3c2080[_0xc48480(0x11b6)])[_0xc48480(0xa35)]('\x0a'))['join'](''),_0x3fff2b=_0x1ad6bb(_0x7a5600,0x3,'hours'),_0x29b1ce=_0x1ad6bb(_0x7a5600,0x6,_0xc48480(0x2f2)),_0x3692c8=_0x1ad6bb(_0x7a5600,0x9,_0xc48480(0x2f2)),_0x8eecc7=_0x1ad6bb(_0x7a5600,0x1,'days'),_0x62f5d=_0x1ad6bb(_0x7a5600,0x3,_0xc48480(0x103b)),_0x5c73cd=_0x1ad6bb(_0x7a5600,0x7,_0xc48480(0x103b));let _0x46dff5='';if(_0x3fff2b||_0x29b1ce||_0x3692c8||_0x8eecc7||_0x62f5d||_0x5c73cd){_0x46dff5+=_0xc48480(0xda0);if(_0x3fff2b)_0x46dff5+=_0x3fff2b;if(_0x29b1ce)_0x46dff5+=_0x29b1ce;if(_0x3692c8)_0x46dff5+=_0x3692c8;if(_0x3fff2b||_0x29b1ce||_0x3692c8)_0x46dff5+='\x0a';if(_0x8eecc7)_0x46dff5+=_0x8eecc7;if(_0x62f5d)_0x46dff5+=_0x62f5d;if(_0x5c73cd)_0x46dff5+=_0x5c73cd;}const _0x47c58a=_0x7a5600[_0xc48480(0x886)][_0xc48480(0xe63)]||_0xc48480(0x11f),_0x1f95f8='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x7a5600[_0xc48480(0x461)]+'”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x7a5600['settings'][_0xc48480(0xd83)]+_0xc48480(0x64e)+_0x47c58a+'\x0a-\x20**你的长期记忆**:\x0a'+_0x35538a+'\x0a'+_0x1f846a+'\x0a'+_0x46dff5+'\x0a-\x20**你最近和“'+_0x141981+_0xc48480(0x120f)+_0x1b112d+_0xc48480(0x11ae);try{const _0x2e9e70=[{'role':_0xc48480(0x66e),'content':_0xc48480(0x409)}];let _0x4b2bf2=_0x1bd20b[_0xc48480(0xee2)](_0xc48480(0xdc3)),_0xf93c3a=_0x112768(_0x1facbe,_0x4b27a2,_0x1f95f8,_0x2e9e70);const _0x2207c5=_0x4b2bf2?await fetch(_0xf93c3a[_0xc48480(0x2fa)],_0xf93c3a[_0xc48480(0x8c6)]):await fetch(_0x1bd20b+_0xc48480(0x126b),{'method':_0xc48480(0x94f),'headers':{'Content-Type':'application/json','Authorization':_0xc48480(0xd55)+_0x4b27a2},'body':JSON[_0xc48480(0x3fb)]({'model':_0x1facbe,'messages':[{'role':_0xc48480(0xb1),'content':_0x1f95f8},..._0x2e9e70],'temperature':_0x41df36[_0xc48480(0xc0)][_0xc48480(0xa4a)]||0.9})});if(!_0x2207c5['ok']){const _0x4d9703=await _0x2207c5[_0xc48480(0x9b3)]()['catch'](()=>null),_0x240ba5=_0x4d9703?.[_0xc48480(0x98)]?.[_0xc48480(0x5f8)]||_0x2207c5[_0xc48480(0x3ea)];throw new Error(_0xc48480(0x85a)+_0x2207c5['status']+_0xc48480(0xb13)+_0x240ba5);}const _0x237da0=await _0x2207c5[_0xc48480(0x9b3)](),_0x18c17b=getGeminiResponseText(_0x237da0),_0x118a25=_0x18c17b['match'](/(\[[\s\S]*\])/);if(!_0x118a25||!_0x118a25[0x0])throw new Error(_0xc48480(0x91c)+_0x18c17b);const _0x74761a=_0x118a25[0x0];let _0x3628a4;try{_0x3628a4=JSON['parse'](_0x74761a);}catch(_0x5dcf29){throw new Error(_0xc48480(0x4b5)+_0x5dcf29[_0xc48480(0x5f8)]+_0xc48480(0xbd)+_0x18c17b);}if(!Array[_0xc48480(0x565)](_0x3628a4))throw new Error('AI返回的数据不是一个数组。原始返回:\x20'+JSON[_0xc48480(0x3fb)](_0x3628a4));_0x7a5600[_0xc48480(0x5cb)]=_0x3628a4[_0xc48480(0xa79)](_0x18c935=>({'id':Date[_0xc48480(0x108d)]()+Math['random'](),'title':_0x18c935['title'],'content':_0x18c935[_0xc48480(0x11b6)]})),await _0x342df8[_0xc48480(0x864)][_0xc48480(0x9c0)](_0x7a5600),await _0x3c6b47();}catch(_0xf1244d){console[_0xc48480(0x98)](_0xc48480(0x7f9),_0xf1244d),await _0x296ef9(_0xc48480(0x91e),_0xc48480(0x851)+_0xf1244d[_0xc48480(0x5f8)]);}}async function _0x52104b(){const _0x36afc2=_0x549949;if(!_0x18c6a2)return;const _0x1ff77f=_0x41df36[_0x36afc2(0x864)][_0x18c6a2];if(!_0x1ff77f)return;await _0x296ef9(_0x36afc2(0x4a6),'正在生成“'+_0x1ff77f[_0x36afc2(0x461)]+'”的出行足迹...');const {proxyUrl:_0x100110,apiKey:_0xa83ea9,model:_0x451aba}=_0x41df36[_0x36afc2(0x673)];if(!_0x100110||!_0xa83ea9||!_0x451aba){alert(_0x36afc2(0xbab));return;}const _0x4b9ab1=_0x41df36[_0x36afc2(0x571)][_0x36afc2(0xabb)]===_0x36afc2(0x7da)||!_0x41df36[_0x36afc2(0x571)][_0x36afc2(0xabb)]?'用户':_0x41df36[_0x36afc2(0x571)][_0x36afc2(0xabb)],_0x14c596=_0x1ff77f['longTermMemory']&&_0x1ff77f[_0x36afc2(0x1349)]['length']>0x0?_0x1ff77f[_0x36afc2(0x1349)][_0x36afc2(0xa79)](_0x58037d=>_0x36afc2(0xde8)+_0xa3fdac(_0x58037d[_0x36afc2(0x3b7)])+')\x20'+_0x58037d[_0x36afc2(0x11b6)])['join']('\x0a'):'无',_0x239f95=_0x1ff77f[_0x36afc2(0x886)]['maxMemory']||0xa,_0x18bafb=_0x1ff77f[_0x36afc2(0xd08)][_0x36afc2(0x1368)](-_0x239f95)[_0x36afc2(0xa79)](_0x45b6fd=>(_0x45b6fd[_0x36afc2(0x10ff)]===_0x36afc2(0x66e)?_0x4b9ab1:_0x1ff77f[_0x36afc2(0x461)])+':\x20'+String(_0x45b6fd[_0x36afc2(0x11b6)])[_0x36afc2(0xba5)](0x0,0x1e)+_0x36afc2(0x1026))['join']('\x0a'),_0x12e687=(_0x1ff77f['settings'][_0x36afc2(0xe8c)]||[])['map'](_0x3a3e4f=>_0x41df36[_0x36afc2(0xf17)][_0x36afc2(0xd12)](_0x39c57a=>_0x39c57a['id']===_0x3a3e4f))[_0x36afc2(0x98a)](Boolean)[_0x36afc2(0xa79)](_0x39f226=>_0x36afc2(0xfb)+_0x39f226['name']+_0x36afc2(0x2da)+_0x39f226[_0x36afc2(0x11b6)][_0x36afc2(0x98a)](_0x47921f=>_0x47921f['enabled'])[_0x36afc2(0xa79)](_0x171626=>'-\x20'+_0x171626['content'])['join']('\x0a'))['join'](''),_0x2718cc=_0x1ad6bb(_0x1ff77f,0x3,'hours'),_0x5eb1ba=_0x1ad6bb(_0x1ff77f,0x6,_0x36afc2(0x2f2)),_0x48d895=_0x1ad6bb(_0x1ff77f,0x9,'hours'),_0x5c137e=_0x1ad6bb(_0x1ff77f,0x1,'days'),_0x4437a9=_0x1ad6bb(_0x1ff77f,0x3,'days'),_0x5544eb=_0x1ad6bb(_0x1ff77f,0x7,_0x36afc2(0x103b));let _0x20812b='';if(_0x2718cc||_0x5eb1ba||_0x48d895||_0x5c137e||_0x4437a9||_0x5544eb){_0x20812b+=_0x36afc2(0xda0);if(_0x2718cc)_0x20812b+=_0x2718cc;if(_0x5eb1ba)_0x20812b+=_0x5eb1ba;if(_0x48d895)_0x20812b+=_0x48d895;if(_0x2718cc||_0x5eb1ba||_0x48d895)_0x20812b+='\x0a';if(_0x5c137e)_0x20812b+=_0x5c137e;if(_0x4437a9)_0x20812b+=_0x4437a9;if(_0x5544eb)_0x20812b+=_0x5544eb;}const _0x5478a5='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x1ff77f[_0x36afc2(0x461)]+_0x36afc2(0x248)+new Date()[_0x36afc2(0x226)]()+_0x36afc2(0x462)+_0x1ff77f[_0x36afc2(0x886)][_0x36afc2(0xd83)]+_0x36afc2(0x3b8)+_0x14c596+'\x0a'+_0x12e687+'\x0a'+_0x20812b+_0x36afc2(0x668)+_0x4b9ab1+_0x36afc2(0x120f)+_0x18bafb+'\x0a\x0a现在，请开始生成这组足迹记录。';try{const _0x4ceae6=[{'role':_0x36afc2(0x66e),'content':_0x36afc2(0xf16)}];let _0x4c8aaf=_0x100110['includes'](_0x36afc2(0xdc3)),_0x58766c=_0x112768(_0x451aba,_0xa83ea9,_0x5478a5,_0x4ceae6);const _0x3b1e25=_0x4c8aaf?await fetch(_0x58766c[_0x36afc2(0x2fa)],_0x58766c[_0x36afc2(0x8c6)]):await fetch(_0x100110+_0x36afc2(0x126b),{'method':'POST','headers':{'Content-Type':_0x36afc2(0x11f0),'Authorization':'Bearer\x20'+_0xa83ea9},'body':JSON[_0x36afc2(0x3fb)]({'model':_0x451aba,'messages':[{'role':_0x36afc2(0xb1),'content':_0x5478a5},..._0x4ceae6],'temperature':_0x41df36[_0x36afc2(0xc0)]['apiTemperature']||0.9})});if(!_0x3b1e25['ok'])throw new Error(_0x36afc2(0x85a)+_0x3b1e25[_0x36afc2(0x3ea)]);const _0x5b4439=await _0x3b1e25[_0x36afc2(0x9b3)](),_0x5caf0d=getGeminiResponseText(_0x5b4439),_0x1639e5=_0x5caf0d['match'](/(\[[\s\S]*\])/);if(!_0x1639e5||!_0x1639e5[0x0])throw new Error(_0x36afc2(0x91c)+_0x5caf0d);const _0x4f0ce3=_0x1639e5[0x0];let _0x11f7fd;try{_0x11f7fd=JSON[_0x36afc2(0x134)](_0x4f0ce3);}catch(_0x1d99b5){throw new Error(_0x36afc2(0x4b5)+_0x1d99b5['message']+_0x36afc2(0xbd)+_0x5caf0d);}_0x1ff77f[_0x36afc2(0x117d)]=_0x11f7fd,await _0x342df8['chats'][_0x36afc2(0x9c0)](_0x1ff77f),await _0x40de90();}catch(_0x38c378){console['error'](_0x36afc2(0xc66),_0x38c378),await _0x296ef9(_0x36afc2(0x91e),_0x36afc2(0x2fd)+_0x38c378[_0x36afc2(0x5f8)]);}}function _0x40de90(){const _0x54744b=_0x549949,_0x33ae52=document[_0x54744b(0x383)](_0x54744b(0x3dd));_0x33ae52[_0x54744b(0x45c)]='';if(!_0x18c6a2)return;const _0x5c6644=_0x41df36[_0x54744b(0x864)][_0x18c6a2],_0x22e66f=_0x5c6644[_0x54744b(0x117d)]||[];if(_0x22e66f[_0x54744b(0xfde)]===0x0){_0x33ae52[_0x54744b(0x45c)]=_0x54744b(0x137);return;}_0x22e66f[_0x54744b(0x19c)](_0x34b322=>{const _0x4ca4f7=_0x54744b,_0x459590=document[_0x4ca4f7(0xe1b)](_0x4ca4f7(0x7fd));_0x459590[_0x4ca4f7(0x556)]='char-amap-item';let _0x5cc709='';if(_0x34b322['image_prompt']){const _0x35d193=_0x4ca4f7(0x5c1)+encodeURIComponent(_0x34b322['image_prompt']);_0x5cc709=_0x4ca4f7(0x4df)+_0x35d193+_0x4ca4f7(0xe55)+_0x34b322[_0x4ca4f7(0x125b)]+_0x4ca4f7(0xd8b);}const _0x4b63d8=_0x34b322['timestamp']?_0xa3fdac(new Date(_0x34b322['timestamp'])[_0x4ca4f7(0x24b)]()):_0x4ca4f7(0x1036);_0x459590[_0x4ca4f7(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>'+_0x34b322[_0x4ca4f7(0xe3e)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>'+_0x34b322['address']+_0x4ca4f7(0x601)+_0x34b322['comment'][_0x4ca4f7(0x709)](/\n/g,_0x4ca4f7(0x3ee))+_0x4ca4f7(0xbcb)+_0x5cc709+_0x4ca4f7(0xfc7)+_0x4b63d8+_0x4ca4f7(0x802),_0x33ae52['appendChild'](_0x459590);});}async function _0x33f227(){const _0x1de794=_0x549949;if(!_0x18c6a2)return;const _0x1b8b89=_0x41df36[_0x1de794(0x864)][_0x18c6a2];if(!_0x1b8b89)return;await _0x296ef9(_0x1de794(0x4a6),_0x1de794(0x4b9)+_0x1b8b89[_0x1de794(0x461)]+_0x1de794(0x1170));const {proxyUrl:_0x155e7f,apiKey:_0x1bf9f3,model:_0x3d5f63}=_0x41df36[_0x1de794(0x673)];if(!_0x155e7f||!_0x1bf9f3||!_0x3d5f63){alert(_0x1de794(0xbab));return;}const _0x80c310=_0x41df36['qzoneSettings'][_0x1de794(0xabb)]===_0x1de794(0x7da)||!_0x41df36['qzoneSettings'][_0x1de794(0xabb)]?'用户':_0x41df36['qzoneSettings'][_0x1de794(0xabb)],_0x3d464c=_0x1b8b89[_0x1de794(0x1349)]&&_0x1b8b89['longTermMemory'][_0x1de794(0xfde)]>0x0?_0x1b8b89[_0x1de794(0x1349)][_0x1de794(0xa79)](_0x70b3fb=>_0x1de794(0xde8)+_0xa3fdac(_0x70b3fb[_0x1de794(0x3b7)])+')\x20'+_0x70b3fb[_0x1de794(0x11b6)])[_0x1de794(0xa35)]('\x0a'):'无',_0x1a5e63=_0x1b8b89['settings'][_0x1de794(0x1138)]||0xa,_0x2201db=_0x1b8b89[_0x1de794(0xd08)]['slice'](-_0x1a5e63)[_0x1de794(0xa79)](_0x36f61d=>(_0x36f61d[_0x1de794(0x10ff)]==='user'?_0x80c310:_0x1b8b89[_0x1de794(0x461)])+':\x20'+String(_0x36f61d[_0x1de794(0x11b6)])[_0x1de794(0xba5)](0x0,0x1e)+_0x1de794(0x1026))[_0x1de794(0xa35)]('\x0a'),_0x7a3fc3=(_0x1b8b89[_0x1de794(0x886)][_0x1de794(0xe8c)]||[])['map'](_0x3f353d=>_0x41df36[_0x1de794(0xf17)][_0x1de794(0xd12)](_0x4e6cd5=>_0x4e6cd5['id']===_0x3f353d))[_0x1de794(0x98a)](Boolean)[_0x1de794(0xa79)](_0x1a11a2=>_0x1de794(0xfb)+_0x1a11a2['name']+_0x1de794(0x2da)+_0x1a11a2[_0x1de794(0x11b6)]['filter'](_0x3df1db=>_0x3df1db[_0x1de794(0x8e4)])[_0x1de794(0xa79)](_0x109f62=>'-\x20'+_0x109f62[_0x1de794(0x11b6)])[_0x1de794(0xa35)]('\x0a'))['join'](''),_0x2adfb1=_0x1ad6bb(_0x1b8b89,0x3,_0x1de794(0x2f2)),_0x8aad3e=_0x1ad6bb(_0x1b8b89,0x6,_0x1de794(0x2f2)),_0x9aa7bb=_0x1ad6bb(_0x1b8b89,0x9,_0x1de794(0x2f2)),_0x4a4fa4=_0x1ad6bb(_0x1b8b89,0x1,_0x1de794(0x103b)),_0xf68490=_0x1ad6bb(_0x1b8b89,0x3,_0x1de794(0x103b)),_0x173aa7=_0x1ad6bb(_0x1b8b89,0x7,_0x1de794(0x103b));let _0x9c81ed='';if(_0x2adfb1||_0x8aad3e||_0x9aa7bb||_0x4a4fa4||_0xf68490||_0x173aa7){_0x9c81ed+=_0x1de794(0xda0);if(_0x2adfb1)_0x9c81ed+=_0x2adfb1;if(_0x8aad3e)_0x9c81ed+=_0x8aad3e;if(_0x9aa7bb)_0x9c81ed+=_0x9aa7bb;if(_0x2adfb1||_0x8aad3e||_0x9aa7bb)_0x9c81ed+='\x0a';if(_0x4a4fa4)_0x9c81ed+=_0x4a4fa4;if(_0xf68490)_0x9c81ed+=_0xf68490;if(_0x173aa7)_0x9c81ed+=_0x173aa7;}const _0x2579eb=_0x1de794(0x4f2)+_0x1b8b89[_0x1de794(0x461)]+'”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x1b8b89[_0x1de794(0x886)]['aiPersona']+_0x1de794(0x3b8)+_0x3d464c+'\x0a'+_0x7a3fc3+'\x0a'+_0x9c81ed+_0x1de794(0x668)+_0x80c310+_0x1de794(0x120f)+_0x2201db+'\x0a\x0a现在，请开始生成这组App使用记录。';try{const _0x577b71=[{'role':_0x1de794(0x66e),'content':_0x1de794(0xd2e)}];let _0x3f7c3c=_0x155e7f[_0x1de794(0xee2)](_0x1de794(0xdc3)),_0x29133d=_0x112768(_0x3d5f63,_0x1bf9f3,_0x2579eb,_0x577b71);const _0x3036b6=_0x3f7c3c?await fetch(_0x29133d[_0x1de794(0x2fa)],_0x29133d[_0x1de794(0x8c6)]):await fetch(_0x155e7f+_0x1de794(0x126b),{'method':_0x1de794(0x94f),'headers':{'Content-Type':_0x1de794(0x11f0),'Authorization':_0x1de794(0xd55)+_0x1bf9f3},'body':JSON[_0x1de794(0x3fb)]({'model':_0x3d5f63,'messages':[{'role':_0x1de794(0xb1),'content':_0x2579eb},..._0x577b71],'temperature':_0x41df36[_0x1de794(0xc0)][_0x1de794(0xa4a)]||0.9})});if(!_0x3036b6['ok'])throw new Error('API\x20错误:\x20'+_0x3036b6[_0x1de794(0x3ea)]);const _0x319a22=await _0x3036b6[_0x1de794(0x9b3)](),_0x382aee=getGeminiResponseText(_0x319a22),_0x3135df=_0x382aee['replace'](/^```json\s*/,'')['replace'](/```$/,''),_0x540de5=JSON[_0x1de794(0x134)](_0x3135df);_0x1b8b89['simulatedAppUsage']=_0x540de5,await _0x342df8[_0x1de794(0x864)]['put'](_0x1b8b89),await _0x368866();}catch(_0x15c8d6){console[_0x1de794(0x98)]('生成模拟App使用记录失败:',_0x15c8d6),await _0x296ef9(_0x1de794(0x91e),_0x1de794(0xb7e)+_0x15c8d6[_0x1de794(0x5f8)]);}}function _0x368866(){const _0x293611=_0x549949,_0x9e02f6=document[_0x293611(0x383)](_0x293611(0x3f0));_0x9e02f6[_0x293611(0x45c)]='';if(!_0x18c6a2)return;const _0x427239=_0x41df36[_0x293611(0x864)][_0x18c6a2],_0x443de2=(_0x427239['simulatedAppUsage']||[])[_0x293611(0x1296)]((_0x3304fd,_0x876af)=>_0x876af[_0x293611(0x3af)]-_0x3304fd[_0x293611(0x3af)]);if(_0x443de2[_0x293611(0xfde)]===0x0){_0x9e02f6['innerHTML']=_0x293611(0xe0a);return;}_0x443de2[_0x293611(0x19c)](_0x687cfd=>{const _0x43320d=_0x293611,_0xf921c2=document['createElement'](_0x43320d(0x7fd));_0xf921c2[_0x43320d(0x556)]=_0x43320d(0x3ab);const _0xa83695=Math['floor'](_0x687cfd[_0x43320d(0x3af)]/0x3c),_0x90e0cb=_0x687cfd[_0x43320d(0x3af)]%0x3c;let _0x20e90e='';if(_0xa83695>0x0)_0x20e90e+=_0xa83695+'小时';if(_0x90e0cb>0x0)_0x20e90e+=_0x90e0cb+'分钟';if(!_0x20e90e)_0x20e90e=_0x43320d(0x13a9);const _0x310aee=_0x687cfd[_0x43320d(0x8d8)]||_0x43320d(0x69a)+_0x687cfd['appName']+',\x20flat\x20design,\x20simple',_0xe3d4a6=_0x43320d(0x5c1)+encodeURIComponent(_0x310aee);_0xf921c2['innerHTML']=_0x43320d(0x9ef)+_0xe3d4a6+_0x43320d(0x1041)+_0x687cfd['appName']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>'+_0x687cfd[_0x43320d(0x62e)]+_0x43320d(0xce8)+_0x20e90e+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x9e02f6[_0x43320d(0xe91)](_0xf921c2);});}async function _0x4dddb(){const _0x4d6a6d=_0x549949;if(!_0x18c6a2)return;const _0x2319b8=_0x41df36[_0x4d6a6d(0x864)][_0x18c6a2];if(!_0x2319b8)return;await _0x296ef9(_0x4d6a6d(0x4a6),_0x4d6a6d(0xff)+_0x2319b8[_0x4d6a6d(0x461)]+'”分享TA的私人歌单...');const {proxyUrl:_0x5b17c2,apiKey:_0x189293,model:_0x115932}=_0x41df36[_0x4d6a6d(0x673)];if(!_0x5b17c2||!_0x189293||!_0x115932){alert(_0x4d6a6d(0x2b7));return;}const _0x2484ce=_0x41df36[_0x4d6a6d(0x571)][_0x4d6a6d(0xabb)]===_0x4d6a6d(0x7da)||!_0x41df36[_0x4d6a6d(0x571)][_0x4d6a6d(0xabb)]?'用户':_0x41df36[_0x4d6a6d(0x571)][_0x4d6a6d(0xabb)],_0x3d9bd4=_0x2319b8[_0x4d6a6d(0x1349)]&&_0x2319b8[_0x4d6a6d(0x1349)][_0x4d6a6d(0xfde)]>0x0?_0x2319b8['longTermMemory'][_0x4d6a6d(0xa79)](_0x4af8a1=>_0x4d6a6d(0xde8)+_0xa3fdac(_0x4af8a1[_0x4d6a6d(0x3b7)])+')\x20'+_0x4af8a1[_0x4d6a6d(0x11b6)])[_0x4d6a6d(0xa35)]('\x0a'):'无',_0x37c3d1=_0x2319b8[_0x4d6a6d(0x886)][_0x4d6a6d(0x1138)]||0xa,_0x185dd5=_0x2319b8[_0x4d6a6d(0xd08)][_0x4d6a6d(0x1368)](-_0x37c3d1)['map'](_0x550b23=>(_0x550b23[_0x4d6a6d(0x10ff)]===_0x4d6a6d(0x66e)?_0x2484ce:_0x2319b8[_0x4d6a6d(0x461)])+':\x20'+String(_0x550b23[_0x4d6a6d(0x11b6)])['substring'](0x0,0x1e)+_0x4d6a6d(0x1026))['join']('\x0a'),_0x5c732e=(_0x2319b8[_0x4d6a6d(0x886)][_0x4d6a6d(0xe8c)]||[])['map'](_0x58f5c6=>_0x41df36[_0x4d6a6d(0xf17)]['find'](_0x418e7f=>_0x418e7f['id']===_0x58f5c6))[_0x4d6a6d(0x98a)](Boolean)[_0x4d6a6d(0xa79)](_0x270a1e=>_0x4d6a6d(0xfb)+_0x270a1e['name']+_0x4d6a6d(0x2da)+_0x270a1e[_0x4d6a6d(0x11b6)][_0x4d6a6d(0x98a)](_0x3d0dde=>_0x3d0dde[_0x4d6a6d(0x8e4)])[_0x4d6a6d(0xa79)](_0x429aef=>'-\x20'+_0x429aef[_0x4d6a6d(0x11b6)])[_0x4d6a6d(0xa35)]('\x0a'))[_0x4d6a6d(0xa35)](''),_0x5408c6='\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“'+_0x2319b8[_0x4d6a6d(0x461)]+'”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x2319b8[_0x4d6a6d(0x886)][_0x4d6a6d(0xd83)]+_0x4d6a6d(0x3b8)+_0x3d9bd4+'\x0a'+_0x5c732e+_0x4d6a6d(0x668)+_0x2484ce+_0x4d6a6d(0x120f)+_0x185dd5+_0x4d6a6d(0x3a1);try{const _0x2872b0=[{'role':_0x4d6a6d(0x66e),'content':'请根据你的设定，生成你的歌单。'}];let _0x51582e=_0x5b17c2['includes'](_0x4d6a6d(0xdc3)),_0x20f568=_0x112768(_0x115932,_0x189293,_0x5408c6,_0x2872b0);const _0x2586c1=_0x51582e?await fetch(_0x20f568[_0x4d6a6d(0x2fa)],_0x20f568[_0x4d6a6d(0x8c6)]):await fetch(_0x5b17c2+_0x4d6a6d(0x126b),{'method':_0x4d6a6d(0x94f),'headers':{'Content-Type':_0x4d6a6d(0x11f0),'Authorization':'Bearer\x20'+_0x189293},'body':JSON[_0x4d6a6d(0x3fb)]({'model':_0x115932,'messages':[{'role':_0x4d6a6d(0xb1),'content':_0x5408c6},..._0x2872b0],'temperature':_0x41df36['globalSettings'][_0x4d6a6d(0xa4a)]||0x1})});if(!_0x2586c1['ok'])throw new Error(_0x4d6a6d(0x85a)+_0x2586c1['statusText']);const _0x28425e=await _0x2586c1[_0x4d6a6d(0x9b3)](),_0x1ee9c9=getGeminiResponseText(_0x28425e),_0x23dc8d=_0x1ee9c9[_0x4d6a6d(0x709)](/^```json\s*/,'')[_0x4d6a6d(0x709)](/```$/,''),_0x4e6b43=JSON[_0x4d6a6d(0x134)](_0x23dc8d);await _0x296ef9(_0x4d6a6d(0x4a6),_0x4d6a6d(0x3bb)+_0x4e6b43[_0x4d6a6d(0xfde)]+'\x20首歌曲的详细信息...');const _0x91eee3=_0x4e6b43[_0x4d6a6d(0xa79)](async _0x1d5abd=>{const _0x1212ba=_0x4d6a6d;let _0x9733f=await _0xb1347f(_0x1d5abd[_0x1212ba(0x8eb)],_0x1d5abd[_0x1212ba(0x3b5)]);(!_0x9733f||_0x9733f[_0x1212ba(0xfde)]===0x0)&&(_0x9733f=await _0x36bd03(_0x1d5abd[_0x1212ba(0x8eb)]));if(_0x9733f[_0x1212ba(0xfde)]>0x0)return _0x132912(_0x9733f[0x0]);return console[_0x1212ba(0x17b)](_0x1212ba(0xef2)+_0x1d5abd[_0x1212ba(0x8eb)]+_0x1212ba(0xb13)+_0x1d5abd[_0x1212ba(0x3b5)]+'”'),null;}),_0x495c5=(await Promise[_0x4d6a6d(0x1282)](_0x91eee3))[_0x4d6a6d(0x98a)](Boolean);_0x2319b8[_0x4d6a6d(0x130a)]=_0x495c5,await _0x342df8['chats'][_0x4d6a6d(0x9c0)](_0x2319b8),await _0x24cea8();}catch(_0x43579b){console[_0x4d6a6d(0x98)](_0x4d6a6d(0xa7b),_0x43579b),await _0x296ef9(_0x4d6a6d(0x91e),_0x4d6a6d(0x10bd)+_0x43579b[_0x4d6a6d(0x5f8)]);}}function _0x24cea8(){const _0x425e6a=_0x549949,_0x32c789=document[_0x425e6a(0x383)](_0x425e6a(0xe49));_0x32c789[_0x425e6a(0x45c)]='';if(!_0x18c6a2)return;const _0x1125c5=_0x41df36['chats'][_0x18c6a2],_0x10257b=_0x1125c5['simulatedMusicPlaylist']||[];if(_0x10257b[_0x425e6a(0xfde)]===0x0){_0x32c789[_0x425e6a(0x45c)]=_0x425e6a(0xbad);return;}_0x10257b[_0x425e6a(0x19c)]((_0x5dfc84,_0x15acff)=>{const _0x1f172c=_0x425e6a,_0x15c1bf=document['createElement'](_0x1f172c(0x7fd));_0x15c1bf[_0x1f172c(0x556)]='char-music-item',_0x15c1bf[_0x1f172c(0x45c)]=_0x1f172c(0xe1f)+_0x5dfc84[_0x1f172c(0x1b2)]+'\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>'+_0x5dfc84['name']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>'+_0x5dfc84[_0x1f172c(0x5d8)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x15c1bf['addEventListener'](_0x1f172c(0x5c7),()=>_0x36a11c(_0x5dfc84)),_0x32c789['appendChild'](_0x15c1bf);});}let _0x83b635={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':_0x549949(0xe40),'lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0x36a11c(_0x250129){const _0x58e35c=_0x549949,_0x44fda7=document['getElementById'](_0x58e35c(0x8c8)),_0x12dc95=document[_0x58e35c(0x383)](_0x58e35c(0x504));if(_0x83b635['lrcUpdateInterval'])clearInterval(_0x83b635[_0x58e35c(0x1f5)]);_0x44fda7[_0x58e35c(0xcb4)]();const _0x4cb0d1=_0x83b635[_0x58e35c(0x976)][_0x58e35c(0xe37)](_0x56a1ee=>_0x56a1ee[_0x58e35c(0xf6c)]===_0x250129['src']);_0x4cb0d1>-0x1?_0x83b635['currentIndex']=_0x4cb0d1:(_0x83b635[_0x58e35c(0x976)]=[_0x250129],_0x83b635[_0x58e35c(0xb2c)]=0x0);document[_0x58e35c(0x383)](_0x58e35c(0x134b))['textContent']=_0x250129[_0x58e35c(0x461)],document['getElementById'](_0x58e35c(0x159))[_0x58e35c(0x138e)]=_0x250129[_0x58e35c(0x5d8)],document['getElementById'](_0x58e35c(0x44a))[_0x58e35c(0xf6c)]=_0x250129[_0x58e35c(0x1b2)],_0x83b635['parsedLyrics']=_0x2a7b2e(_0x250129['lrcContent']||''),_0x4b2f76();if(_0x250129[_0x58e35c(0x63e)]){const _0x19fc92=new Blob([_0x250129['src']],{'type':_0x250129[_0x58e35c(0xeec)]||_0x58e35c(0xdca)});_0x44fda7[_0x58e35c(0xf6c)]=URL['createObjectURL'](_0x19fc92);}else _0x44fda7[_0x58e35c(0xf6c)]=_0x250129['src'];_0x44fda7[_0x58e35c(0x554)]()[_0x58e35c(0xa27)](_0x469533=>console[_0x58e35c(0x98)](_0x58e35c(0xb8e),_0x469533)),_0x44fda7[_0x58e35c(0xfbd)]=()=>{const _0x355a99=_0x58e35c;document[_0x355a99(0x383)]('char-music-total-time')[_0x355a99(0x138e)]=_0x353939(_0x44fda7[_0x355a99(0xdf4)]),_0x83b635[_0x355a99(0x1f5)]=setInterval(_0x2d921d,0x1f4);},_0x12dc95[_0x58e35c(0x119a)][_0x58e35c(0xbff)](_0x58e35c(0x106d));}function _0xafe281(){const _0x5d1c71=_0x549949,_0x576fc8=document[_0x5d1c71(0x383)](_0x5d1c71(0x504)),_0x2b1ba5=document[_0x5d1c71(0x383)](_0x5d1c71(0x8c8));if(_0x83b635['lrcUpdateInterval'])clearInterval(_0x83b635[_0x5d1c71(0x1f5)]);_0x2b1ba5[_0x5d1c71(0xcb4)](),_0x2b1ba5[_0x5d1c71(0xf6c)]='',_0x576fc8[_0x5d1c71(0x119a)][_0x5d1c71(0x131d)](_0x5d1c71(0x106d)),_0x83b635[_0x5d1c71(0xea0)]=![],document[_0x5d1c71(0x383)](_0x5d1c71(0x650))[_0x5d1c71(0x119a)]['remove'](_0x5d1c71(0x1171));}function _0x2d921d(){const _0x432a35=_0x549949,_0x4f7061=document[_0x432a35(0x383)]('char-audio-player');if(!_0x4f7061['duration'])return;const _0x4893b9=_0x4f7061[_0x432a35(0x60f)],_0x2c3ba5=_0x4f7061[_0x432a35(0xdf4)];document[_0x432a35(0x383)](_0x432a35(0xbf2))[_0x432a35(0x655)][_0x432a35(0xabd)]=_0x4893b9/_0x2c3ba5*0x64+'%',document[_0x432a35(0x383)](_0x432a35(0x4cb))['textContent']=_0x353939(_0x4893b9),_0x5cfc36(_0x4893b9);}function _0x4b2f76(){const _0x2db973=_0x549949,_0x303fda=document['getElementById'](_0x2db973(0x15b));_0x303fda[_0x2db973(0x45c)]='',_0x83b635['currentLyricIndex']=-0x1;if(!_0x83b635[_0x2db973(0x6ed)]||_0x83b635[_0x2db973(0x6ed)]['length']===0x0){_0x303fda[_0x2db973(0x45c)]=_0x2db973(0x894);return;}_0x83b635[_0x2db973(0x6ed)][_0x2db973(0x19c)]((_0x535427,_0x3e0d17)=>{const _0x37b2a1=_0x2db973,_0x49289c=document[_0x37b2a1(0xe1b)]('p');_0x49289c[_0x37b2a1(0x138e)]=_0x535427['text'],_0x49289c[_0x37b2a1(0x118)][_0x37b2a1(0x1297)]=_0x3e0d17,_0x303fda[_0x37b2a1(0xe91)](_0x49289c);});}function _0x5cfc36(_0x395ce8){const _0x41cbdd=_0x549949,_0x28d529=_0x83b635[_0x41cbdd(0x6ed)];if(_0x28d529[_0x41cbdd(0xfde)]===0x0)return;let _0x35f603=-0x1;for(let _0x4a06ed=0x0;_0x4a06ed<_0x28d529[_0x41cbdd(0xfde)];_0x4a06ed++){if(_0x395ce8>=_0x28d529[_0x4a06ed][_0x41cbdd(0x1c8)])_0x35f603=_0x4a06ed;else break;}if(_0x35f603===_0x83b635[_0x41cbdd(0x1025)])return;_0x83b635[_0x41cbdd(0x1025)]=_0x35f603;const _0x38ff16=document[_0x41cbdd(0x383)]('char-music-lyrics'),_0x5d7c48=_0x38ff16[_0x41cbdd(0x400)]('p');_0x5d7c48[_0x41cbdd(0x19c)](_0x447842=>_0x447842['classList'][_0x41cbdd(0x131d)](_0x41cbdd(0xde5)));if(_0x35f603>-0x1){const _0x1a78d7=_0x38ff16['querySelector'](_0x41cbdd(0xfa9)+_0x35f603+'\x22]');if(_0x1a78d7){_0x1a78d7[_0x41cbdd(0x119a)][_0x41cbdd(0xbff)](_0x41cbdd(0xde5));const _0x3296e9=_0x38ff16[_0x41cbdd(0x630)]/0x2-_0x1a78d7['offsetTop']-_0x1a78d7[_0x41cbdd(0x1294)]/0x2;_0x5d7c48[_0x41cbdd(0x19c)](_0xfc57a1=>{const _0x349141=_0x41cbdd;_0xfc57a1[_0x349141(0x655)][_0x349141(0x923)]=_0x349141(0x1187)+_0x3296e9+_0x349141(0xc00);});}}}function _0x30d756(){const _0x3b4bc0=_0x549949;if(_0x83b635[_0x3b4bc0(0x976)][_0x3b4bc0(0xfde)]===0x0)return;let _0x70df77;switch(_0x83b635[_0x3b4bc0(0x681)]){case _0x3b4bc0(0x5ce):_0x70df77=Math[_0x3b4bc0(0xdee)](Math[_0x3b4bc0(0x5ce)]()*_0x83b635[_0x3b4bc0(0x976)][_0x3b4bc0(0xfde)]);break;case'single':_0x36a11c(_0x83b635[_0x3b4bc0(0x976)][_0x83b635[_0x3b4bc0(0xb2c)]]);return;case'order':default:_0x70df77=(_0x83b635[_0x3b4bc0(0xb2c)]+0x1)%_0x83b635['currentPlaylist'][_0x3b4bc0(0xfde)];break;}_0x36a11c(_0x83b635[_0x3b4bc0(0x976)][_0x70df77]);}function _0x2d96ec(){const _0x5b897b=_0x549949;if(_0x83b635[_0x5b897b(0x976)]['length']===0x0)return;const _0x2de12e=(_0x83b635['currentIndex']-0x1+_0x83b635[_0x5b897b(0x976)]['length'])%_0x83b635[_0x5b897b(0x976)][_0x5b897b(0xfde)];_0x36a11c(_0x83b635[_0x5b897b(0x976)][_0x2de12e]);}function _0x235646(){const _0x245fc4=_0x549949,_0x233e98=[_0x245fc4(0xe40),_0x245fc4(0x5ce),_0x245fc4(0x8a3)],_0x2f3afb=_0x233e98[_0x245fc4(0x1105)](_0x83b635[_0x245fc4(0x681)]);_0x83b635[_0x245fc4(0x681)]=_0x233e98[(_0x2f3afb+0x1)%_0x233e98[_0x245fc4(0xfde)]],document['getElementById'](_0x245fc4(0xfd4))['textContent']={'order':'顺序','random':'随机','single':'单曲'}[_0x83b635[_0x245fc4(0x681)]];}function _0x16ede2(){const _0x2d90aa=_0x549949,_0x34bf22=document[_0x2d90aa(0x383)](_0x2d90aa(0x8c8)),_0x4fe68e=document[_0x2d90aa(0x383)](_0x2d90aa(0xdda)),_0x1091b5=document['getElementById'](_0x2d90aa(0x650));_0x4fe68e[_0x2d90aa(0x271)](_0x2d90aa(0x5c7),()=>{const _0x3d475c=_0x2d90aa;if(_0x34bf22[_0x3d475c(0x3b4)]){if(_0x83b635['currentIndex']>-0x1)_0x34bf22[_0x3d475c(0x554)]();}else _0x34bf22['pause']();}),_0x34bf22['onplay']=()=>{const _0x4363e7=_0x2d90aa;_0x4fe68e['innerHTML']='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>',_0x1091b5[_0x4363e7(0x119a)]['add']('spinning'),_0x83b635['isPlaying']=!![];},_0x34bf22[_0x2d90aa(0x280)]=()=>{const _0x288a01=_0x2d90aa;_0x4fe68e['innerHTML']=_0x288a01(0xfc),_0x1091b5[_0x288a01(0x119a)][_0x288a01(0x131d)]('spinning'),_0x83b635[_0x288a01(0xea0)]=![];},_0x34bf22[_0x2d90aa(0x623)]=()=>{const _0x4408e9=_0x2d90aa;_0x1091b5[_0x4408e9(0x119a)][_0x4408e9(0x131d)](_0x4408e9(0x1171)),_0x83b635[_0x4408e9(0xea0)]=![],_0x30d756();},document['getElementById'](_0x2d90aa(0x3da))[_0x2d90aa(0x271)](_0x2d90aa(0x5c7),_0x2d96ec),document['getElementById'](_0x2d90aa(0x2fe))[_0x2d90aa(0x271)]('click',_0x30d756),document['getElementById']('char-music-mode-btn')[_0x2d90aa(0x271)](_0x2d90aa(0x5c7),_0x235646),document['getElementById'](_0x2d90aa(0x755))[_0x2d90aa(0x271)]('click',_0x4f2d06=>{const _0x37c543=_0x2d90aa;if(!_0x34bf22[_0x37c543(0xdf4)])return;const _0x1e75a0=_0x4f2d06['currentTarget'],_0x52f202=_0x4f2d06[_0x37c543(0xf15)];_0x34bf22[_0x37c543(0x60f)]=_0x52f202/_0x1e75a0[_0x37c543(0xe79)]*_0x34bf22[_0x37c543(0xdf4)];});}async function _0x1c4178(){const _0x366ded=_0x549949,_0x3ed918=document[_0x366ded(0x383)]('douban-posts-list');_0x3ed918[_0x366ded(0x45c)]='';const _0x2dfc0a=await _0x342df8[_0x366ded(0x1329)][_0x366ded(0x4b1)](_0x366ded(0x3b7))[_0x366ded(0x1087)]()[_0x366ded(0x21f)]();if(_0x2dfc0a['length']===0x0){_0x3ed918['innerHTML']=_0x366ded(0x1194);return;}_0x2dfc0a[_0x366ded(0x19c)](_0x50c949=>{const _0x2ef5db=_0x366ded;let _0x256703;const _0xf71a47=_0x50c949['authorOriginalName']?Object[_0x2ef5db(0x76d)](_0x41df36[_0x2ef5db(0x864)])[_0x2ef5db(0xd12)](_0x37e52a=>!_0x37e52a[_0x2ef5db(0x1a2)]&&_0x37e52a['name']===_0x50c949[_0x2ef5db(0x52b)]):null;if(_0xf71a47)_0x256703=_0xf71a47[_0x2ef5db(0x886)]['aiAvatar'];else{const _0x59ed5f=Object[_0x2ef5db(0x76d)](_0x41df36[_0x2ef5db(0x864)])[_0x2ef5db(0xd12)](_0x3b5cb3=>!_0x3b5cb3['isGroup']&&_0x3b5cb3['name']===_0x50c949[_0x2ef5db(0x1253)]);if(_0x59ed5f)_0x256703=_0x59ed5f['settings'][_0x2ef5db(0x121e)];else _0x50c949['authorAvatarPrompt']?_0x256703=_0x2ef5db(0x5c1)+encodeURIComponent(_0x50c949['authorAvatarPrompt']):_0x256703=_0x5dc108;}const _0x392132=document['createElement'](_0x2ef5db(0x7fd));_0x392132[_0x2ef5db(0x556)]=_0x2ef5db(0xdd9),_0x392132[_0x2ef5db(0xc50)]=()=>_0x3f13f2(_0x50c949['id']),_0x392132[_0x2ef5db(0x45c)]=_0x2ef5db(0x1231)+_0x256703+_0x2ef5db(0x1162)+_0x50c949[_0x2ef5db(0x1253)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20'+_0x50c949[_0x2ef5db(0x5d4)]+_0x2ef5db(0xab4)+_0x50c949[_0x2ef5db(0xd1b)]+_0x2ef5db(0x717)+_0x50c949[_0x2ef5db(0x11b6)][_0x2ef5db(0x709)](/\n/g,_0x2ef5db(0x3ee))+_0x2ef5db(0xcf4)+_0x50c949[_0x2ef5db(0x1129)]+_0x2ef5db(0x372)+_0x50c949['commentsCount']+_0x2ef5db(0x343)+_0xa3fdac(_0x50c949[_0x2ef5db(0x3b7)])+_0x2ef5db(0x11e4),_0x3ed918['appendChild'](_0x392132);});}async function _0x49d587(){const _0x140a7f=_0x549949,_0x485732=_0x41df36[_0x140a7f(0xc0)][_0x140a7f(0x10f8)]||[];if(_0x485732[_0x140a7f(0xfde)]===0x0){await _0x296ef9(_0x140a7f(0x244),_0x140a7f(0x9eb));return;}await _0x296ef9(_0x140a7f(0x4a6),_0x140a7f(0x5c6)+_0x485732[_0x140a7f(0xfde)]+_0x140a7f(0x9fb));const {proxyUrl:_0x520efd,apiKey:_0x22f0da,model:_0x15f6f5}=_0x41df36[_0x140a7f(0x673)];if(!_0x520efd||!_0x22f0da||!_0x15f6f5){alert(_0x140a7f(0x2b7));return;}const _0x214204=new Set();_0x485732[_0x140a7f(0x19c)](_0x49e328=>{const _0x42838d=_0x140a7f,_0x5afcef=_0x41df36[_0x42838d(0x864)][_0x49e328];_0x5afcef&&_0x5afcef['settings'][_0x42838d(0xe8c)]&&_0x5afcef['settings']['linkedWorldBookIds'][_0x42838d(0x19c)](_0x39be8d=>_0x214204['add'](_0x39be8d));});let _0x4652e8='';_0x214204[_0x140a7f(0x1240)]>0x0&&(_0x4652e8+=_0x140a7f(0xb40),_0x214204[_0x140a7f(0x19c)](_0x472b0a=>{const _0x33c63c=_0x140a7f,_0x167793=_0x41df36['worldBooks'][_0x33c63c(0xd12)](_0x4fe2ac=>_0x4fe2ac['id']===_0x472b0a);if(_0x167793){const _0x58331a=_0x167793[_0x33c63c(0x11b6)][_0x33c63c(0x98a)](_0x83ef45=>_0x83ef45[_0x33c63c(0x8e4)]!==![])['map'](_0x357ed4=>'-\x20'+_0x357ed4[_0x33c63c(0x11b6)])[_0x33c63c(0xa35)]('\x0a');_0x58331a&&(_0x4652e8+='\x0a##\x20来自《'+_0x167793[_0x33c63c(0x461)]+_0x33c63c(0x18c)+_0x58331a);}}));const _0x35ade0=_0x41df36[_0x140a7f(0xf17)][_0x140a7f(0xd12)](_0x3fb5e3=>_0x3fb5e3['name']==='豆瓣设定');let _0x3b524d='',_0x121746=[];_0x35ade0&&_0x35ade0[_0x140a7f(0x11b6)]['forEach'](_0x32609e=>{const _0x38d919=_0x140a7f;_0x32609e[_0x38d919(0x125b)]['includes'](_0x38d919(0x6c8))&&(_0x3b524d+=_0x38d919(0x155)+_0x32609e[_0x38d919(0x11b6)]);if(_0x32609e[_0x38d919(0x125b)][_0x38d919(0xee2)](_0x38d919(0x223))){const _0x2d7bc7=_0x32609e[_0x38d919(0x11b6)][_0x38d919(0x105d)]('\x0a');_0x2d7bc7['forEach'](_0x3e972a=>{const _0x1e9e96=_0x38d919,_0x10e742=_0x3e972a[_0x1e9e96(0x22e)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x10e742&&_0x121746[_0x1e9e96(0x258)]({'name':_0x10e742[0x1][_0x1e9e96(0x1cb)](),'persona':_0x10e742[0x2][_0x1e9e96(0x1cb)]()});});}});const _0x1a1207=_0x41df36[_0x140a7f(0x571)][_0x140a7f(0xabb)]||'我',_0x55c859=_0x485732['length']>0x0&&_0x41df36['chats'][_0x485732[0x0]]?_0x41df36['chats'][_0x485732[0x0]][_0x140a7f(0x886)][_0x140a7f(0xe63)]:_0x140a7f(0x11f);let _0x4287ac='';_0x485732[_0x140a7f(0x19c)](_0x2ff134=>{const _0x4cf320=_0x140a7f,_0x12199f=_0x41df36[_0x4cf320(0x864)][_0x2ff134];if(_0x12199f){const _0x2c71c3=_0x12199f[_0x4cf320(0x1349)]&&_0x12199f[_0x4cf320(0x1349)][_0x4cf320(0xfde)]>0x0?_0x12199f[_0x4cf320(0x1349)][_0x4cf320(0xa79)](_0x1d4647=>_0x1d4647[_0x4cf320(0x11b6)])[_0x4cf320(0xa35)](';\x20'):'无',_0x420ff8=_0x12199f[_0x4cf320(0xd08)][_0x4cf320(0x1368)](-0xa)[_0x4cf320(0xa79)](_0x167634=>(_0x167634[_0x4cf320(0x10ff)]===_0x4cf320(0x66e)?_0x1a1207:_0x12199f[_0x4cf320(0x461)])+':\x20'+String(_0x167634[_0x4cf320(0x11b6)])['substring'](0x0,0x1e)+_0x4cf320(0x1026))[_0x4cf320(0xa35)]('\x0a');_0x4287ac+=_0x4cf320(0xe7c)+_0x12199f['name']+_0x4cf320(0x1323)+_0x12199f[_0x4cf320(0x886)]['aiPersona']+'</persona>\x0a\x20\x20<memory>'+_0x2c71c3+'</memory>\x0a\x20\x20<recent_dialogue_with_user>'+_0x420ff8+'</recent_dialogue_with_user>\x0a</character>\x0a';}}),_0x121746[_0x140a7f(0x19c)](_0x25abee=>{const _0x553a7c=_0x140a7f;_0x4287ac+=_0x553a7c(0xe7c)+_0x25abee[_0x553a7c(0x461)]+_0x553a7c(0x1323)+_0x25abee[_0x553a7c(0x48c)]+_0x553a7c(0xbba);});const _0xcfcb3c=new Date(),_0x19c084=_0xcfcb3c[_0x140a7f(0xa2b)](_0x140a7f(0xafb),{'dateStyle':_0x140a7f(0xd96),'timeStyle':'short'}),_0x319d07=_0x41df36[_0x140a7f(0xc0)][_0x140a7f(0x1362)]||0xc,_0x599bae=_0x41df36['globalSettings']['doubanMaxPosts']||0x14,_0x588e7a='\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【'+_0x319d07+'到'+_0x599bae+_0x140a7f(0x12d5)+_0x19c084+_0x140a7f(0x932)+_0x1a1207+_0x140a7f(0x433)+_0x1a1207+_0x140a7f(0x3fd)+_0x3b524d+'\x0a'+_0x4652e8+_0x140a7f(0xf23)+_0x19c084+_0x140a7f(0x1259)+_0x1a1207+_0x140a7f(0x10c7)+_0x55c859+_0x140a7f(0xc38)+_0x4287ac+'\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。';try{const _0x5a86ec=[{'role':_0x140a7f(0x66e),'content':_0x140a7f(0x81d)}];let _0x2eb456=_0x520efd['includes'](_0x140a7f(0xdc3)),_0x103219=_0x112768(_0x15f6f5,_0x22f0da,_0x588e7a,_0x5a86ec);const _0x27503c=_0x2eb456?await fetch(_0x103219[_0x140a7f(0x2fa)],_0x103219[_0x140a7f(0x8c6)]):await fetch(_0x520efd+_0x140a7f(0x126b),{'method':_0x140a7f(0x94f),'headers':{'Content-Type':'application/json','Authorization':_0x140a7f(0xd55)+_0x22f0da},'body':JSON['stringify']({'model':_0x15f6f5,'messages':[{'role':_0x140a7f(0xb1),'content':_0x588e7a},..._0x5a86ec],'temperature':_0x41df36[_0x140a7f(0xc0)][_0x140a7f(0xa4a)]||0x1})});if(!_0x27503c['ok'])throw new Error('API\x20错误:\x20'+_0x27503c[_0x140a7f(0x3ea)]);const _0xb0768c=await _0x27503c[_0x140a7f(0x9b3)](),_0xb2e201=getGeminiResponseText(_0xb0768c),_0x292b5a=_0xb2e201['match'](/\[[\s\S]*\]/);if(!_0x292b5a)throw new Error(_0x140a7f(0x91c)+_0xb2e201);const _0x2cd87d=JSON[_0x140a7f(0x134)](_0x292b5a[0x0]);await _0x342df8['doubanPosts'][_0x140a7f(0x4b8)](),await _0x342df8[_0x140a7f(0x1329)][_0x140a7f(0x1391)](_0x2cd87d['map'](_0x547795=>({..._0x547795,'timestamp':Date[_0x140a7f(0x108d)]()-Math['random']()*0x186a0}))),await _0x1c4178();}catch(_0x2c3c23){console[_0x140a7f(0x98)]('生成豆瓣帖子失败:',_0x2c3c23),await _0x296ef9(_0x140a7f(0x91e),_0x140a7f(0x1217)+_0x2c3c23[_0x140a7f(0x5f8)]);}}async function _0x3f13f2(_0x45981b){const _0x4b409e=_0x549949;_0x105acd(_0x4b409e(0x1160)),_0x5af1a3=_0x45981b;const _0x5c7139=await _0x342df8['doubanPosts'][_0x4b409e(0x1a3)](_0x45981b);if(!_0x5c7139){_0x105acd('douban-screen');return;}document['getElementById']('douban-post-detail-title')['textContent']=_0x4b409e(0x6f5);let _0x53973e=_0x5dc108,_0x24724b=_0x5c7139[_0x4b409e(0x1253)];const _0x38e5c3=_0x5c7139[_0x4b409e(0x52b)]?Object['values'](_0x41df36[_0x4b409e(0x864)])[_0x4b409e(0xd12)](_0x30c8a1=>!_0x30c8a1[_0x4b409e(0x1a2)]&&_0x30c8a1[_0x4b409e(0x283)]===_0x5c7139[_0x4b409e(0x52b)]):null;if(_0x38e5c3)_0x53973e=_0x38e5c3['settings'][_0x4b409e(0x121e)];else{const _0x31ba7d=Object[_0x4b409e(0x76d)](_0x41df36[_0x4b409e(0x864)])[_0x4b409e(0xd12)](_0x220b9b=>!_0x220b9b['isGroup']&&_0x220b9b['name']===_0x5c7139['authorName']);if(_0x31ba7d)_0x53973e=_0x31ba7d[_0x4b409e(0x886)][_0x4b409e(0x121e)];else _0x5c7139['authorAvatarPrompt']&&(_0x53973e=_0x4b409e(0x5c1)+encodeURIComponent(_0x5c7139['authorAvatarPrompt']));}document[_0x4b409e(0x383)](_0x4b409e(0x659))['src']=_0x53973e,document[_0x4b409e(0x383)]('douban-detail-author')[_0x4b409e(0x138e)]=_0x24724b,document['getElementById']('douban-detail-group')[_0x4b409e(0x138e)]='来自\x20'+_0x5c7139[_0x4b409e(0x5d4)],document['getElementById'](_0x4b409e(0x6ab))[_0x4b409e(0x138e)]=_0x5c7139['postTitle'],document[_0x4b409e(0x383)]('douban-detail-content')[_0x4b409e(0x45c)]=_0x5c7139[_0x4b409e(0x11b6)][_0x4b409e(0x709)](/\n/g,_0x4b409e(0x3ee)),document[_0x4b409e(0x383)](_0x4b409e(0xd8f))['src']=_0x41df36[_0x4b409e(0x571)][_0x4b409e(0xb47)],document['getElementById'](_0x4b409e(0xfb8))[_0x4b409e(0x1be)]='';const _0x2f3bf6=document[_0x4b409e(0x383)]('douban-detail-comments-list');_0x2f3bf6[_0x4b409e(0x45c)]='';if(_0x5c7139[_0x4b409e(0xcad)]&&_0x5c7139[_0x4b409e(0xcad)]['length']>0x0){const _0x964e3c=new Map();_0x5c7139['comments'][_0x4b409e(0x19c)](_0x3aa895=>{const _0x17db7d=_0x4b409e;let _0x4697d6=_0x5dc108;const _0x2462f6=_0x41df36['qzoneSettings'][_0x17db7d(0xabb)]||'我',_0x418030=_0x3aa895[_0x17db7d(0xe68)];if(_0x964e3c[_0x17db7d(0xcde)](_0x418030))_0x4697d6=_0x964e3c[_0x17db7d(0x1a3)](_0x418030);else{if(_0x418030===_0x2462f6)_0x4697d6=_0x41df36[_0x17db7d(0x571)][_0x17db7d(0xb47)];else{if(_0x418030===_0x5c7139[_0x17db7d(0x1253)])_0x4697d6=_0x53973e;else{const _0x4eb84a=_0x3aa895[_0x17db7d(0x5fb)]?Object[_0x17db7d(0x76d)](_0x41df36[_0x17db7d(0x864)])[_0x17db7d(0xd12)](_0xc88002=>!_0xc88002[_0x17db7d(0x1a2)]&&_0xc88002[_0x17db7d(0x283)]===_0x3aa895['commenterOriginalName']):null;if(_0x4eb84a)_0x4697d6=_0x4eb84a[_0x17db7d(0x886)]['aiAvatar'];else{const _0x4a7795=Object[_0x17db7d(0x76d)](_0x41df36[_0x17db7d(0x864)])[_0x17db7d(0xd12)](_0x4f18d0=>!_0x4f18d0[_0x17db7d(0x1a2)]&&_0x4f18d0[_0x17db7d(0x461)]===_0x418030);if(_0x4a7795)_0x4697d6=_0x4a7795[_0x17db7d(0x886)]['aiAvatar'];else _0x3aa895[_0x17db7d(0xcae)]&&(_0x4697d6='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x3aa895[_0x17db7d(0xcae)]));}}}_0x964e3c[_0x17db7d(0x5ba)](_0x418030,_0x4697d6);}const _0x3ef2e1=document[_0x17db7d(0xe1b)](_0x17db7d(0x7fd));_0x3ef2e1[_0x17db7d(0x556)]=_0x17db7d(0xf81),_0x3ef2e1['innerHTML']=_0x17db7d(0x76c)+_0x4697d6+'\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>'+_0x418030+_0x17db7d(0x73a)+_0x3aa895[_0x17db7d(0x6af)]['replace'](/\n/g,_0x17db7d(0x3ee))+_0x17db7d(0x585),_0x2f3bf6[_0x17db7d(0xe91)](_0x3ef2e1);});}else _0x2f3bf6[_0x4b409e(0x45c)]=_0x4b409e(0x1299);const _0x218edf=document[_0x4b409e(0x383)](_0x4b409e(0xc3f));if(_0x218edf)_0x218edf[_0x4b409e(0x4f9)]=0x0;}async function _0x139438(){const _0x321069=_0x549949;if(!_0x5af1a3)return;const _0x41d878=document[_0x321069(0x383)](_0x321069(0xfb8)),_0x5ac42e=_0x41d878[_0x321069(0x1be)][_0x321069(0x1cb)]();if(!_0x5ac42e)return;const _0x5b1377=await _0x342df8['doubanPosts']['get'](_0x5af1a3);if(!_0x5b1377)return;!_0x5b1377['comments']&&(_0x5b1377[_0x321069(0xcad)]=[]);const _0x2a3855=_0x41df36[_0x321069(0x571)][_0x321069(0xabb)]||'我';_0x5b1377['comments']['push']({'commenter':_0x2a3855,'text':_0x5ac42e}),_0x5b1377[_0x321069(0x95f)]++,await _0x342df8[_0x321069(0x1329)][_0x321069(0x9c0)](_0x5b1377),_0x41d878[_0x321069(0x1be)]='',await _0x3f13f2(_0x5af1a3);}async function _0x259437(){const _0x3c63fc=_0x549949;if(!_0x5af1a3)return;const _0x4c778b=_0x5af1a3,_0x30336c=await _0x342df8[_0x3c63fc(0x1329)][_0x3c63fc(0x1a3)](_0x4c778b);if(!_0x30336c)return;const _0x3c2d2c=_0x30336c[_0x3c63fc(0xcad)]&&_0x30336c[_0x3c63fc(0xcad)][_0x3c63fc(0x1368)](-0x1)[0x0];if(!_0x3c2d2c){alert(_0x3c63fc(0x4ee));return;}await _0x296ef9(_0x3c63fc(0x4a6),_0x3c63fc(0x4ad));try{const {proxyUrl:_0x192fc2,apiKey:_0x142bc3,model:_0x5f3c1c}=_0x41df36[_0x3c63fc(0x673)];if(!_0x192fc2||!_0x142bc3||!_0x5f3c1c)throw new Error(_0x3c63fc(0xbab));const _0x5aef1c=_0x41df36[_0x3c63fc(0x571)][_0x3c63fc(0xabb)]||'我',_0x4de12c=_0x41df36[_0x3c63fc(0x864)][Object[_0x3c63fc(0x66b)](_0x41df36[_0x3c63fc(0x864)])[0x0]]?.['settings'][_0x3c63fc(0xe63)]||_0x3c63fc(0x11f),_0x2682bf=new Map();_0x30336c[_0x3c63fc(0xcad)]&&_0x30336c[_0x3c63fc(0xcad)][_0x3c63fc(0x19c)](_0x23ad15=>{const _0xea01cc=_0x3c63fc,_0x3ecd22=(_0x41df36[_0xea01cc(0xc0)][_0xea01cc(0x10f8)]||[])['some'](_0x55c911=>_0x41df36[_0xea01cc(0x864)][_0x55c911]?.['name']===_0x23ad15[_0xea01cc(0xe68)]);!_0x3ecd22&&_0x23ad15['avatar_prompt']&&_0x2682bf[_0xea01cc(0x5ba)](_0x23ad15[_0xea01cc(0xe68)],_0x23ad15[_0xea01cc(0xcae)]);});let _0x3d0bf0=_0x3c63fc(0x105);_0x2682bf['size']>0x0?(_0x3d0bf0+=_0x3c63fc(0xee5),_0x2682bf['forEach']((_0xf92a78,_0x93b354)=>{const _0x343089=_0x3c63fc;_0x3d0bf0+=_0x343089(0x71b)+_0x93b354+_0x343089(0x395)+_0xf92a78+'\x22\x0a';})):_0x3d0bf0+='（当前帖子还没有路人NPC发表评论。）\x0a';const _0x3933cb=_0x41df36[_0x3c63fc(0xf17)][_0x3c63fc(0xd12)](_0x1179c0=>_0x1179c0['name']===_0x3c63fc(0xc1a));let _0x34a36d=[];_0x3933cb&&_0x3933cb['content'][_0x3c63fc(0x19c)](_0x1d4b20=>{const _0x5d4d2a=_0x3c63fc;if(_0x1d4b20[_0x5d4d2a(0x125b)][_0x5d4d2a(0xee2)](_0x5d4d2a(0x223))){const _0x3b6f5b=_0x1d4b20['content']['split']('\x0a');_0x3b6f5b[_0x5d4d2a(0x19c)](_0x2c17bb=>{const _0xb3bfe3=_0x5d4d2a,_0x484d2e=_0x2c17bb['match'](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x484d2e&&_0x34a36d['push']({'name':_0x484d2e[0x1][_0xb3bfe3(0x1cb)](),'persona':_0x484d2e[0x2][_0xb3bfe3(0x1cb)]()});});}});let _0xb287f5='';const _0x1f5a03=_0x41df36[_0x3c63fc(0xc0)][_0x3c63fc(0x10f8)]||[];_0x1f5a03[_0x3c63fc(0x19c)](_0x2a8bee=>{const _0x2d2ce2=_0x3c63fc,_0x109890=_0x41df36[_0x2d2ce2(0x864)][_0x2a8bee];if(_0x109890){const _0x5472e7=_0x109890['longTermMemory']&&_0x109890[_0x2d2ce2(0x1349)][_0x2d2ce2(0xfde)]>0x0?_0x109890[_0x2d2ce2(0x1349)][_0x2d2ce2(0xa79)](_0x425de5=>_0x425de5['content'])[_0x2d2ce2(0xa35)](';\x20'):'无',_0x10bb4c=_0x109890[_0x2d2ce2(0xd08)]['slice'](-0xa)[_0x2d2ce2(0xa79)](_0x1b3438=>(_0x1b3438[_0x2d2ce2(0x10ff)]==='user'?_0x5aef1c:_0x109890[_0x2d2ce2(0x461)])+':\x20'+String(_0x1b3438[_0x2d2ce2(0x11b6)])[_0x2d2ce2(0xba5)](0x0,0x1e)+_0x2d2ce2(0x1026))[_0x2d2ce2(0xa35)]('\x0a');_0xb287f5+=_0x2d2ce2(0x1c5)+_0x109890['name']+':\x20'+_0x109890[_0x2d2ce2(0x886)]['aiPersona'][_0x2d2ce2(0xba5)](0x0,0x32)+_0x2d2ce2(0x1e3)+_0x5472e7+_0x2d2ce2(0x4d5)+_0x10bb4c+']';}}),_0x34a36d[_0x3c63fc(0x19c)](_0x78c198=>{const _0x4d91e8=_0x3c63fc;_0xb287f5+='\x0a-\x20'+_0x78c198[_0x4d91e8(0x461)]+':\x20'+_0x78c198[_0x4d91e8(0x48c)];});const _0x771e4b=new Date(),_0x1ed38c=_0x771e4b[_0x3c63fc(0xa2b)]('zh-CN',{'dateStyle':'full','timeStyle':_0x3c63fc(0xfc1)}),_0x446d16='\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“'+_0x5aef1c+'”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**'+_0x1ed38c+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“'+_0x5aef1c+_0x3c63fc(0x70c)+_0x5aef1c+_0x3c63fc(0x62d)+_0x30336c[_0x3c63fc(0xd1b)]+_0x3c63fc(0x1002)+_0x30336c[_0x3c63fc(0x1253)]+_0x3c63fc(0x8a6)+_0x30336c[_0x3c63fc(0x11b6)][_0x3c63fc(0xba5)](0x0,0x64)+_0x3c63fc(0x1232)+_0x30336c[_0x3c63fc(0xcad)]['map'](_0x5bc42a=>'-\x20'+_0x5bc42a[_0x3c63fc(0xe68)]+':\x20'+_0x5bc42a[_0x3c63fc(0x6af)])[_0x3c63fc(0xa35)]('\x0a')+'\x0a\x0a'+_0x3d0bf0+_0x3c63fc(0xf23)+_0x1ed38c+_0x3c63fc(0x12ad)+_0x5aef1c+_0x3c63fc(0x10c7)+_0x4de12c+_0x3c63fc(0x37b)+_0xb287f5+_0x3c63fc(0xfa7),_0x2c1416=[{'role':'user','content':_0x3c63fc(0xbc9)}];let _0x23b0a8=_0x192fc2[_0x3c63fc(0xee2)](_0x3c63fc(0xdc3)),_0x215826=_0x112768(_0x5f3c1c,_0x142bc3,_0x446d16,_0x2c1416);const _0x4a1375=_0x23b0a8?await fetch(_0x215826['url'],_0x215826['data']):await fetch(_0x192fc2+_0x3c63fc(0x126b),{'method':_0x3c63fc(0x94f),'headers':{'Content-Type':_0x3c63fc(0x11f0),'Authorization':_0x3c63fc(0xd55)+_0x142bc3},'body':JSON[_0x3c63fc(0x3fb)]({'model':_0x5f3c1c,'messages':[{'role':'system','content':_0x446d16},..._0x2c1416],'temperature':_0x41df36['globalSettings']['apiTemperature']||0x1})});if(!_0x4a1375['ok'])throw new Error('API\x20错误:\x20'+_0x4a1375[_0x3c63fc(0x3ea)]);const _0x1e7647=await _0x4a1375[_0x3c63fc(0x9b3)](),_0x2fcb12=getGeminiResponseText(_0x1e7647),_0xe355ac=_0x2fcb12[_0x3c63fc(0x709)](/^```json\s*/,'')[_0x3c63fc(0x709)](/```$/,''),_0x3bb3e6=JSON[_0x3c63fc(0x134)](_0xe355ac);Array[_0x3c63fc(0x565)](_0x3bb3e6)&&_0x3bb3e6[_0x3c63fc(0xfde)]>0x0&&(_0x30336c[_0x3c63fc(0xcad)][_0x3c63fc(0x258)](..._0x3bb3e6),_0x30336c[_0x3c63fc(0x95f)]+=_0x3bb3e6[_0x3c63fc(0xfde)],await _0x342df8[_0x3c63fc(0x1329)][_0x3c63fc(0x9c0)](_0x30336c)),await _0x3f13f2(_0x4c778b),_0x4a895a();}catch(_0x3819c2){console[_0x3c63fc(0x98)](_0x3c63fc(0x10d8),_0x3819c2),await _0x296ef9(_0x3c63fc(0xa55),'无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20'+_0x3819c2[_0x3c63fc(0x5f8)]);}}async function _0x3e4242(){const _0x592c3b=_0x549949,_0xdef710=document['getElementById'](_0x592c3b(0xc2d)),_0x40dc61=document['getElementById']('douban-cast-list');_0x40dc61[_0x592c3b(0x45c)]='';const _0x495ea0=Object['values'](_0x41df36[_0x592c3b(0x864)])[_0x592c3b(0x98a)](_0x1d161f=>!_0x1d161f[_0x592c3b(0x1a2)]),_0x36f45c=new Set(_0x41df36['globalSettings'][_0x592c3b(0x10f8)]||[]);_0x495ea0[_0x592c3b(0xfde)]===0x0?_0x40dc61['innerHTML']='<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>':_0x495ea0[_0x592c3b(0x19c)](_0x2b406e=>{const _0x5b308a=_0x592c3b,_0x50666a=document['createElement'](_0x5b308a(0x7fd));_0x50666a[_0x5b308a(0x556)]=_0x5b308a(0x136c),_0x50666a[_0x5b308a(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22'+_0x2b406e['id']+'\x22\x20'+(_0x36f45c['has'](_0x2b406e['id'])?_0x5b308a(0x2a3):'')+_0x5b308a(0x139a)+(_0x2b406e[_0x5b308a(0x886)]['aiAvatar']||_0x5dc108)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x2b406e[_0x5b308a(0x461)]+_0x5b308a(0x604),_0x40dc61[_0x5b308a(0xe91)](_0x50666a);}),_0xdef710['classList']['add'](_0x592c3b(0x106d));}async function _0x49b45e(){const _0x5982cb=_0x549949,_0xf10602=document['querySelectorAll']('#douban-cast-list\x20.douban-cast-checkbox:checked'),_0x2a9f54=Array[_0x5982cb(0x365)](_0xf10602)[_0x5982cb(0xa79)](_0x284ea9=>_0x284ea9[_0x5982cb(0x118)][_0x5982cb(0xa65)]);_0x41df36[_0x5982cb(0xc0)][_0x5982cb(0x10f8)]=_0x2a9f54,await _0x342df8[_0x5982cb(0xc0)][_0x5982cb(0x9c0)](_0x41df36[_0x5982cb(0xc0)]),document[_0x5982cb(0x383)](_0x5982cb(0xc2d))[_0x5982cb(0x119a)][_0x5982cb(0x131d)](_0x5982cb(0x106d)),await _0x49d587();}document[_0x549949(0x383)](_0x549949(0x1027))[_0x549949(0x271)](_0x549949(0x5c7),_0x3e4242),document[_0x549949(0x383)](_0x549949(0x6d7))[_0x549949(0x271)](_0x549949(0x5c7),()=>{const _0x190608=_0x549949;document[_0x190608(0x383)](_0x190608(0xc2d))[_0x190608(0x119a)]['remove'](_0x190608(0x106d));}),document[_0x549949(0x383)](_0x549949(0xe64))[_0x549949(0x271)]('click',_0x49b45e),document[_0x549949(0x383)](_0x549949(0xa49))[_0x549949(0x271)](_0x549949(0x5c7),_0x202e8f=>{const _0x28d453=_0x549949,_0x1e0c48=_0x202e8f[_0x28d453(0xfab)][_0x28d453(0x58c)]('.contact-picker-item');if(_0x1e0c48){const _0x449b46=_0x1e0c48[_0x28d453(0x89c)]('.douban-cast-checkbox');_0x449b46&&_0x202e8f[_0x28d453(0xfab)]!==_0x449b46&&(_0x449b46[_0x28d453(0x2a3)]=!_0x449b46[_0x28d453(0x2a3)]);}});async function _0x4ce840(_0x34c2cb){const _0x18bbca=_0x549949;if(!_0x34c2cb)return;const _0x488c98=await _0x23a88b('导入外观设置','这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？',{'confirmText':_0x18bbca(0xd28)});if(!_0x488c98)return;try{const _0x4d9320=await _0x34c2cb[_0x18bbca(0x6af)](),_0x27a2ae=JSON[_0x18bbca(0x134)](_0x4d9320);if(!_0x27a2ae[_0x18bbca(0x5d0)]&&!_0x27a2ae[_0x18bbca(0xf2c)]&&!_0x27a2ae['appIcons'])throw new Error(_0x18bbca(0x1388));Object[_0x18bbca(0xa8d)](_0x41df36['globalSettings'],_0x27a2ae),await _0x342df8[_0x18bbca(0xc0)][_0x18bbca(0x9c0)](_0x41df36['globalSettings']),_0x31bb8c(),_0x4f56f2(),_0x323732(),_0x3df773(),_0x15f193(_0x41df36['globalSettings'][_0x18bbca(0xf2c)]),_0x59518a(_0x41df36[_0x18bbca(0xc0)][_0x18bbca(0x1082)]),_0x2c3e8c(),_0x5140bf(),_0x446010(),await _0x296ef9(_0x18bbca(0xab0),_0x18bbca(0x732));}catch(_0xe6ab89){console['error'](_0x18bbca(0xe0c),_0xe6ab89),await _0x296ef9(_0x18bbca(0x108e),_0x18bbca(0x12f4)+_0xe6ab89[_0x18bbca(0x5f8)]);}}async function _0xe7959e(_0x20c4f8){const _0x5c4f09=_0x549949;console[_0x5c4f09(0xe72)](_0x5c4f09(0x572)+_0x20c4f8[_0x5c4f09(0x70d)](0x1)+_0x5c4f09(0x109));const _0x44798c=Object[_0x5c4f09(0x76d)](_0x41df36['chats'])['filter'](_0x1861c9=>!_0x1861c9[_0x5c4f09(0x1a2)]&&_0x1861c9[_0x5c4f09(0x886)][_0x5c4f09(0x8d5)]&&_0x1861c9['relationship']?.[_0x5c4f09(0x1fe)]===_0x5c4f09(0x757));if(_0x44798c[_0x5c4f09(0xfde)]===0x0){console[_0x5c4f09(0xe72)](_0x5c4f09(0x113e));return;}for(const _0x1b6470 of _0x44798c){const _0x4a1d7b=_0x1b6470[_0x5c4f09(0x886)][_0x5c4f09(0xf9c)]||0xf,_0x143d37=_0x1b6470[_0x5c4f09(0x80d)]?(Date['now']()-_0x1b6470[_0x5c4f09(0x80d)])/(0x3e8*0x3c):Infinity;_0x20c4f8>_0x4a1d7b&&_0x143d37>_0x4a1d7b&&(Math[_0x5c4f09(0x5ce)]()<0.3&&(console[_0x5c4f09(0xe72)]('角色\x20\x22'+_0x1b6470[_0x5c4f09(0x461)]+_0x5c4f09(0x10a4)),Math[_0x5c4f09(0x5ce)]()<0.7?await _0x1ece9c(_0x1b6470['id']):console[_0x5c4f09(0xe72)](_0x5c4f09(0xbc3)+_0x1b6470[_0x5c4f09(0x461)]+_0x5c4f09(0x5eb))));}}function _0x44bb7b(){const _0x13c137=_0x549949;if(!_0x41df36[_0x13c137(0xfc5)])return;const _0x1bb598=_0x41df36[_0x13c137(0x864)][_0x41df36[_0x13c137(0xfc5)]];document[_0x13c137(0x383)]('keyword-search-input')['value']='',document['getElementById']('date-search-input')[_0x13c137(0x1be)]='',document[_0x13c137(0x383)](_0x13c137(0x4f5))[_0x13c137(0x45c)]=_0x13c137(0x3c7),_0x105acd(_0x13c137(0xb5c));}async function _0x32a18d(){const _0x397339=_0x549949,_0x3eed13=_0x41df36[_0x397339(0x864)][_0x41df36[_0x397339(0xfc5)]];if(!_0x3eed13)return;const _0x418ffa=document[_0x397339(0x383)](_0x397339(0x83f))[_0x397339(0x1be)]['trim']()[_0x397339(0x189)](),_0x5588b3=document[_0x397339(0x383)]('date-search-input')['value'];if(!_0x418ffa&&!_0x5588b3){alert(_0x397339(0x2e0));return;}let _0x4fa3d7=_0x3eed13[_0x397339(0xd08)][_0x397339(0x98a)](_0x5971d0=>!_0x5971d0['isHidden']);_0x418ffa&&(_0x4fa3d7=_0x4fa3d7[_0x397339(0x98a)](_0x15e6b4=>{const _0x581582=_0x397339;let _0x2b5cbc='';if(typeof _0x15e6b4[_0x581582(0x11b6)]===_0x581582(0xafa))_0x2b5cbc=_0x15e6b4[_0x581582(0x11b6)];else{if(_0x15e6b4[_0x581582(0xa6b)]===_0x581582(0xa4f))_0x2b5cbc=_0x15e6b4['content'];else{if(_0x15e6b4['type']===_0x581582(0x1050)||_0x15e6b4['type']==='user_photo')_0x2b5cbc=_0x15e6b4['content'];else{if(_0x15e6b4[_0x581582(0xa6b)]===_0x581582(0x44e))_0x2b5cbc=(_0x15e6b4[_0x581582(0x5ed)]||'')+'\x20'+(_0x15e6b4[_0x581582(0xee1)]||'');else _0x15e6b4[_0x581582(0x8ff)]&&(_0x2b5cbc=_0x15e6b4[_0x581582(0x11b6)]);}}}return _0x2b5cbc[_0x581582(0x189)]()[_0x581582(0xee2)](_0x418ffa);}));if(_0x5588b3){const _0x3ad29=new Date(_0x5588b3),_0x1a4b39=new Date(_0x3ad29[_0x397339(0x825)](0x0,0x0,0x0,0x0))[_0x397339(0x24b)](),_0x1eb641=new Date(_0x3ad29['setHours'](0x17,0x3b,0x3b,0x3e7))[_0x397339(0x24b)]();_0x4fa3d7=_0x4fa3d7[_0x397339(0x98a)](_0x22c441=>_0x22c441[_0x397339(0x3b7)]>=_0x1a4b39&&_0x22c441[_0x397339(0x3b7)]<=_0x1eb641);}await _0xa4540f(_0x4fa3d7);}async function _0xa4540f(_0x557a11){const _0x37a689=_0x549949,_0x22c276=document[_0x37a689(0x383)]('chat-search-results-list'),_0x4e2b5e=_0x41df36[_0x37a689(0x864)][_0x41df36[_0x37a689(0xfc5)]];_0x22c276['innerHTML']='';if(_0x557a11['length']===0x0){_0x22c276[_0x37a689(0x45c)]=_0x37a689(0xcca);return;}let _0x2fbf55='';for(const _0x151cc3 of _0x557a11){const _0x2e0a01=new Date(_0x151cc3['timestamp']),_0x5a3638=_0x2e0a01[_0x37a689(0xb8b)]();if(_0x5a3638!==_0x2fbf55){const _0x2c8f2c=document[_0x37a689(0xe1b)](_0x37a689(0x7fd));_0x2c8f2c[_0x37a689(0x556)]=_0x37a689(0x3b1),_0x2c8f2c[_0x37a689(0x138e)]='---\x20'+_0x2e0a01[_0x37a689(0xdf9)]()+'年'+(_0x2e0a01[_0x37a689(0xf4f)]()+0x1)+'月'+_0x2e0a01[_0x37a689(0xb29)]()+_0x37a689(0x1001),_0x22c276[_0x37a689(0xe91)](_0x2c8f2c),_0x2fbf55=_0x5a3638;}const _0x4f5001=await _0x152d98(_0x151cc3,_0x4e2b5e);_0x4f5001&&(_0x4f5001[_0x37a689(0x655)][_0x37a689(0x81e)]='pointer',_0x4f5001[_0x37a689(0x271)](_0x37a689(0x5c7),()=>_0x2e0aab(_0x151cc3[_0x37a689(0x3b7)])),_0x22c276['appendChild'](_0x4f5001));}}async function _0x2e0aab(_0x55729e){const _0x4d86e0=_0x549949,_0x103e83=_0x41df36['activeChatId'];if(!_0x103e83)return;_0x105acd(_0x4d86e0(0x862)),setTimeout(async()=>{const _0x388afb=_0x4d86e0,_0x175b79=document[_0x388afb(0x383)]('chat-messages'),_0x5c2c7a=_0x388afb(0x1110)+_0x55729e+'\x22]';let _0x12ca26=_0x175b79[_0x388afb(0x89c)](_0x5c2c7a),_0x22e577=0x0;const _0x7c8ab9=0x14;while(!_0x12ca26&&_0x22e577<_0x7c8ab9){const _0x3e6e26=document['getElementById']('load-more-btn');if(_0x3e6e26)console[_0x388afb(0xe72)](_0x388afb(0xaa)+(_0x22e577+0x1)+')'),await _0x28355d(),_0x12ca26=_0x175b79[_0x388afb(0x89c)](_0x5c2c7a),_0x22e577++;else break;}_0x110168(_0x55729e);},0xc8);}async function _0x22413f(){const _0x2e2b8b=_0x549949;document[_0x2e2b8b(0x383)](_0x2e2b8b(0x83f))['value']='',document['getElementById'](_0x2e2b8b(0x4d7))[_0x2e2b8b(0x1be)]='',await _0xa4540f(_0x41df36['chats'][_0x41df36[_0x2e2b8b(0xfc5)]]['history'][_0x2e2b8b(0x98a)](_0xa2fc2c=>!_0xa2fc2c[_0x2e2b8b(0xbc5)]));}async function _0x31ee60(_0x15dd58=![],_0xe7a392=null,_0x544866=null){const _0x224c7c=_0x549949,_0x726b9f=document[_0x224c7c(0x383)](_0x224c7c(0x48e)),_0x3b1383=document[_0x224c7c(0x383)](_0x224c7c(0xe9f)),_0x35b51b=_0x41df36[_0x224c7c(0x864)][_0x41df36[_0x224c7c(0xfc5)]];_0x726b9f[_0x224c7c(0x45c)]='',_0x3b1383['innerHTML']='';const _0x569fbe=await _0x342df8[_0x224c7c(0xcf3)][_0x224c7c(0x21f)](),_0xfe6f02=[..._0x3ee27f,..._0x569fbe];document[_0x224c7c(0x89c)](_0x224c7c(0x4b3))[_0x224c7c(0x655)][_0x224c7c(0x2b6)]=_0x15dd58?'none':_0x224c7c(0x2aa),document['getElementById'](_0x224c7c(0x5cc))[_0x224c7c(0x655)][_0x224c7c(0x2b6)]='block',document['getElementById'](_0x224c7c(0x10b8))[_0x224c7c(0x655)][_0x224c7c(0x2b6)]=_0x224c7c(0xa70),document[_0x224c7c(0x383)](_0x224c7c(0xeed))[_0x224c7c(0x119a)]['add'](_0x224c7c(0xde5)),document[_0x224c7c(0x383)](_0x224c7c(0xa36))['classList']['remove'](_0x224c7c(0xde5));if(_0x15dd58)_0xfe6f02[_0x224c7c(0x19c)](_0x3811a4=>{const _0xd042f8=_0x224c7c,_0x59715d=_0x279988(_0x3811a4,'my',_0xe7a392);_0x3811a4[_0xd042f8(0x2fa)]===_0x544866&&_0x59715d[_0xd042f8(0x119a)][_0xd042f8(0xbff)](_0xd042f8(0x35e)),_0x726b9f[_0xd042f8(0xe91)](_0x59715d);});else{const _0x352c63=_0x35b51b[_0x224c7c(0x886)]['aiAvatar']||_0x5dc108,_0x1b0079=_0x35b51b[_0x224c7c(0x886)]['myAvatar']||(_0x35b51b[_0x224c7c(0x1a2)]?_0x188ace:_0x5dc108);_0xfe6f02[_0x224c7c(0x19c)](_0x1d9f7f=>{const _0x365cf3=_0x224c7c,_0x9f009c=_0x279988(_0x1d9f7f,'ai',_0x352c63);if(_0x1d9f7f[_0x365cf3(0x2fa)]===_0x36ab47['ai'])_0x9f009c['classList']['add'](_0x365cf3(0x35e));_0x726b9f[_0x365cf3(0xe91)](_0x9f009c);const _0x5247a5=_0x279988(_0x1d9f7f,'my',_0x1b0079);if(_0x1d9f7f['url']===_0x36ab47['my'])_0x5247a5[_0x365cf3(0x119a)][_0x365cf3(0xbff)](_0x365cf3(0x35e));_0x3b1383[_0x365cf3(0xe91)](_0x5247a5);});}}function _0x279988(_0x1ee405,_0x1ecbac,_0x38e106){const _0x692512=_0x549949,_0x56de14=document[_0x692512(0xe1b)](_0x692512(0x7fd));_0x56de14[_0x692512(0x556)]=_0x692512(0x3a3),_0x56de14['dataset']['frameUrl']=_0x1ee405['url'],_0x56de14['title']=_0x1ee405[_0x692512(0x461)];const _0x3f13ec=typeof _0x1ee405['id']==='number',_0xdc1d73=_0x3f13ec?'<button\x20class=\x22delete-btn\x22\x20data-id=\x22'+_0x1ee405['id']+'\x22\x20style=\x22display:block;\x22>×</button>':'';return _0x56de14['innerHTML']=_0x692512(0x602)+_0xdc1d73+_0x692512(0x79e)+_0x38e106+_0x692512(0xc80)+(_0x1ee405['url']?_0x692512(0xf8a)+_0x1ee405[_0x692512(0x2fa)]+_0x692512(0xdd3):'')+_0x692512(0xbf5),_0x56de14['addEventListener']('click',_0x49fbaa=>{const _0x75b10d=_0x692512;if(_0x49fbaa['target'][_0x75b10d(0x119a)]['contains'](_0x75b10d(0x1354)))return;if(_0x1aa341){if(_0x3f13ec){const _0x7ac6a4=parseInt(_0x1ee405['id']);_0x56de14[_0x75b10d(0x119a)][_0x75b10d(0x8f0)](_0x75b10d(0x35e)),_0x1ccd4c[_0x75b10d(0xcde)](_0x7ac6a4)?_0x1ccd4c[_0x75b10d(0x971)](_0x7ac6a4):_0x1ccd4c['add'](_0x7ac6a4),_0x1e6513();}}else{_0x36ab47[_0x1ecbac]=_0x1ee405['url'];const _0x2903e4=_0x1ecbac==='ai'?document[_0x75b10d(0x383)](_0x75b10d(0x48e)):document['getElementById']('my-frame-grid');_0x2903e4[_0x75b10d(0x400)](_0x75b10d(0xf44))[_0x75b10d(0x19c)](_0x18bad9=>_0x18bad9[_0x75b10d(0x119a)][_0x75b10d(0x131d)]('selected')),_0x56de14[_0x75b10d(0x119a)][_0x75b10d(0xbff)]('selected');}}),_0x56de14;}async function _0x66cc38(){const _0xda09a8=_0x549949,_0x2c8627=document['getElementById'](_0xda09a8(0xe2a)),_0x799e61=await new Promise(_0x309ace=>{const _0x2abd80=_0xda09a8,_0x47b3c3=_0x327016=>{const _0x3613f5=_0x42ed;_0x309ace(_0x327016['target'][_0x3613f5(0x1185)][0x0]||null),_0x2c8627['removeEventListener'](_0x3613f5(0x173),_0x47b3c3);};_0x2c8627[_0x2abd80(0x271)](_0x2abd80(0x173),_0x47b3c3,{'once':!![]}),_0x2c8627[_0x2abd80(0x5c7)]();});if(!_0x799e61)return;const _0x1acece=await _0x12e332(_0xda09a8(0x6db),'请为这个新头像框起个名字');if(!_0x1acece||!_0x1acece['trim']())return;const _0x16dd1f=await new Promise(_0x297c8b=>{const _0x1b8b37=_0xda09a8,_0x11fbcc=new FileReader();_0x11fbcc[_0x1b8b37(0xb5b)]=()=>_0x297c8b(_0x11fbcc['result']),_0x11fbcc[_0x1b8b37(0x132a)](_0x799e61);});await _0x342df8[_0xda09a8(0xcf3)][_0xda09a8(0xbff)]({'name':_0x1acece[_0xda09a8(0x1cb)](),'url':_0x16dd1f}),_0x31ee60(_0x232685);}async function _0x5c96d6(){const _0x593ee5=_0x549949,_0x3f2958=_0x593ee5(0x10b7),_0x406d84=await _0x12e332('批量导入头像框','从完整链接批量导入','',_0x593ee5(0xfe5),'<p\x20style=\x22font-size:12px;color:#888;\x22>'+_0x3f2958+_0x593ee5(0x29a));if(!_0x406d84||!_0x406d84[_0x593ee5(0x1cb)]())return;const _0x2a6599=_0x406d84[_0x593ee5(0x1cb)]()[_0x593ee5(0x105d)]('\x0a'),_0x13c47f=[];let _0x59f26a=0x0;for(const _0x59fc63 of _0x2a6599){const _0x5b8369=_0x59fc63[_0x593ee5(0x22e)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x5b8369)_0x13c47f['push']({'name':_0x5b8369[0x1]['trim'](),'url':_0x5b8369[0x2][_0x593ee5(0x1cb)]()});else _0x59fc63[_0x593ee5(0x1cb)]()&&_0x59f26a++;}_0x13c47f[_0x593ee5(0xfde)]>0x0&&(await _0x342df8['customAvatarFrames'][_0x593ee5(0x1391)](_0x13c47f),_0x31ee60(_0x232685),await _0x296ef9(_0x593ee5(0xab0),_0x593ee5(0x945)+_0x13c47f['length']+'\x20个新头像框！')),_0x59f26a>0x0&&await _0x296ef9(_0x593ee5(0xe38),'有\x20'+_0x59f26a+'\x20行格式不正确，已被忽略。');}async function _0x26f51b(_0x10c83a){const _0x2daf4f=_0x549949,_0x4c2856=await _0x342df8['customAvatarFrames'][_0x2daf4f(0x1a3)](_0x10c83a);if(!_0x4c2856)return;const _0x4bbda5=await _0x23a88b(_0x2daf4f(0x615),_0x2daf4f(0x9b5)+_0x4c2856[_0x2daf4f(0x461)]+_0x2daf4f(0xce2),{'confirmButtonClass':'btn-danger'});_0x4bbda5&&(await _0x342df8['customAvatarFrames'][_0x2daf4f(0x971)](_0x10c83a),_0x31ee60(_0x232685));}let _0x5b2fe9=0x0;const _0x1b1b9c=0x2;function _0x26d941(){const _0x447976=_0x549949,_0x4641a3=document[_0x447976(0x383)](_0x447976(0x163)),_0x5b5f25=document['getElementById'](_0x447976(0xfa2)),_0x550289=document['querySelectorAll'](_0x447976(0xec3));let _0x4b7943=0x0,_0x44316c=0x0,_0x5345df=0x0,_0x3a0dca=![],_0x4f80ce=!![];const _0x443fd6=()=>{const _0xa4f313=_0x447976;_0x5b5f25[_0xa4f313(0x655)]['transform']=_0xa4f313(0x30e)+_0x5b2fe9*(0x64/_0x1b1b9c)+'%)',_0x550289[_0xa4f313(0x19c)]((_0x6d7968,_0x4ca1bc)=>{const _0x3f8115=_0xa4f313;_0x6d7968['classList'][_0x3f8115(0x8f0)]('active',_0x4ca1bc===_0x5b2fe9);});},_0x24a094=_0xb8a2dd=>{const _0x3ec07c=_0x447976;_0x3a0dca=!![],_0x4f80ce=!![],_0x4b7943=_0xb8a2dd['type'][_0x3ec07c(0xee2)](_0x3ec07c(0x1bc))?_0xb8a2dd['pageX']:_0xb8a2dd['touches'][0x0][_0x3ec07c(0x421)],_0x44316c=_0xb8a2dd[_0x3ec07c(0xa6b)][_0x3ec07c(0xee2)](_0x3ec07c(0x1bc))?_0xb8a2dd[_0x3ec07c(0xb2b)]:_0xb8a2dd[_0x3ec07c(0x544)][0x0][_0x3ec07c(0xb2b)],_0x5b5f25[_0x3ec07c(0x655)]['transition']=_0x3ec07c(0xa70);},_0x33ba38=_0x19f171=>{const _0x10a102=_0x447976;if(!_0x3a0dca)return;const _0x2d2753=_0x19f171[_0x10a102(0xa6b)]['includes'](_0x10a102(0x1bc))?_0x19f171[_0x10a102(0xb2b)]:_0x19f171['touches'][0x0]['pageY'];_0x5345df=_0x19f171[_0x10a102(0xa6b)]['includes'](_0x10a102(0x1bc))?_0x19f171[_0x10a102(0x421)]:_0x19f171[_0x10a102(0x544)][0x0][_0x10a102(0x421)];const _0x1786c2=_0x5345df-_0x4b7943,_0x4e9589=_0x2d2753-_0x44316c;_0x4f80ce&&(Math[_0x10a102(0x744)](_0x1786c2)>0xa||Math[_0x10a102(0x744)](_0x4e9589)>0xa)&&(_0x4f80ce=![]);if(Math[_0x10a102(0x744)](_0x1786c2)>Math[_0x10a102(0x744)](_0x4e9589)){if(_0x19f171[_0x10a102(0x47b)])_0x19f171[_0x10a102(0xe94)]();_0x5b5f25[_0x10a102(0x655)][_0x10a102(0x923)]='translateX(calc(-'+_0x5b2fe9*(0x64/_0x1b1b9c)+_0x10a102(0x948)+_0x1786c2+_0x10a102(0x1369);}},_0x317531=_0xb3a494=>{const _0x47b04c=_0x447976;if(!_0x3a0dca)return;_0x3a0dca=![],_0x5b5f25[_0x47b04c(0x655)][_0x47b04c(0xdfd)]=_0x47b04c(0x6b8);if(_0x4f80ce){_0x443fd6();return;}const _0x344aa1=_0x5345df-_0x4b7943;if(Math[_0x47b04c(0x744)](_0x344aa1)>_0x4641a3['offsetWidth']/0x4){if(_0x344aa1>0x0&&_0x5b2fe9>0x0)_0x5b2fe9--;else _0x344aa1<0x0&&_0x5b2fe9<_0x1b1b9c-0x1&&_0x5b2fe9++;}_0x443fd6();};_0x4641a3['addEventListener'](_0x447976(0x413),_0x24a094),_0x4641a3[_0x447976(0x271)]('mousemove',_0x33ba38),_0x4641a3[_0x447976(0x271)](_0x447976(0x1338),_0x317531),_0x4641a3[_0x447976(0x271)](_0x447976(0xb15),_0x317531),_0x4641a3[_0x447976(0x271)]('touchstart',_0x24a094,{'passive':![]}),_0x4641a3[_0x447976(0x271)](_0x447976(0x3a2),_0x33ba38,{'passive':![]}),_0x4641a3[_0x447976(0x271)](_0x447976(0x2e9),_0x317531);}let _0x4b9b36=null;async function _0x2b10bc(){const _0x38a5d4=_0x549949;await _0x6b8f41(),_0x105acd(_0x38a5d4(0x11e6));}async function _0x6b8f41(){const _0x36ddff=_0x549949,_0x39b2c7=document['getElementById'](_0x36ddff(0x85f)),_0x490770=document[_0x36ddff(0x383)](_0x36ddff(0x90));_0x39b2c7[_0x36ddff(0x45c)]='',_0x490770[_0x36ddff(0x45c)]='';const [_0xe9f77a,_0x89cc4a]=await Promise[_0x36ddff(0x1282)]([_0x342df8[_0x36ddff(0x32f)][_0x36ddff(0x21f)](),_0x342df8[_0x36ddff(0xbea)]['orderBy'](_0x36ddff(0x461))[_0x36ddff(0x21f)]()]);_0x41df36['presets']=_0xe9f77a;if(_0xe9f77a[_0x36ddff(0xfde)]===0x0){_0x490770[_0x36ddff(0x45c)]=_0x36ddff(0xea7);return;}const _0x4574b1=document[_0x36ddff(0xe1b)]('button');_0x4574b1[_0x36ddff(0x556)]=_0x36ddff(0x34b),_0x4574b1[_0x36ddff(0x138e)]='全部',_0x4574b1[_0x36ddff(0x118)][_0x36ddff(0xba3)]=_0x36ddff(0x1282),_0x39b2c7['appendChild'](_0x4574b1);const _0x2f00f2=document[_0x36ddff(0xe1b)](_0x36ddff(0x7fd));_0x2f00f2['className']=_0x36ddff(0x207),_0x2f00f2[_0x36ddff(0x118)][_0x36ddff(0xba3)]='all',_0x490770[_0x36ddff(0xe91)](_0x2f00f2),_0x89cc4a[_0x36ddff(0x19c)](_0x5d104e=>{const _0x363775=_0x36ddff,_0x23d8ce=document[_0x363775(0xe1b)](_0x363775(0x182));_0x23d8ce[_0x363775(0x556)]=_0x363775(0x112),_0x23d8ce['textContent']=_0x5d104e[_0x363775(0x461)],_0x23d8ce['dataset'][_0x363775(0xba3)]=String(_0x5d104e['id']),_0x39b2c7[_0x363775(0xe91)](_0x23d8ce);const _0x3e36bb=document[_0x363775(0xe1b)]('div');_0x3e36bb[_0x363775(0x556)]=_0x363775(0xb45),_0x3e36bb[_0x363775(0x118)]['categoryId']=String(_0x5d104e['id']),_0x490770[_0x363775(0xe91)](_0x3e36bb);});const _0x3f3798=_0xe9f77a['some'](_0xa890bd=>!_0xa890bd['categoryId']);if(_0x3f3798){const _0x599b57=document[_0x36ddff(0xe1b)](_0x36ddff(0x182));_0x599b57[_0x36ddff(0x556)]=_0x36ddff(0x112),_0x599b57[_0x36ddff(0x138e)]=_0x36ddff(0xaac),_0x599b57[_0x36ddff(0x118)]['categoryId']=_0x36ddff(0x1289),_0x39b2c7['appendChild'](_0x599b57);const _0x5c3e35=document['createElement']('div');_0x5c3e35[_0x36ddff(0x556)]=_0x36ddff(0xb45),_0x5c3e35[_0x36ddff(0x118)]['categoryId']=_0x36ddff(0x1289),_0x490770['appendChild'](_0x5c3e35);}_0xe9f77a[_0x36ddff(0x19c)](_0x519164=>{const _0x421d1d=_0x36ddff,_0x583357=_0x421d1d(0x31a)+_0x519164[_0x421d1d(0x11b6)][_0x421d1d(0xfde)]+_0x421d1d(0x1280),_0x3cfb50=document[_0x421d1d(0xe1b)](_0x421d1d(0x7fd));_0x3cfb50[_0x421d1d(0x556)]='world-book-card',_0x3cfb50[_0x421d1d(0x45c)]=_0x421d1d(0xf05)+_0x519164['name']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0x583357+_0x421d1d(0x9be);const _0x103272=()=>_0x1aac09(_0x519164['id']),_0x28b4a7=async()=>{const _0x2c96f9=_0x421d1d,_0x5c2fb1=await _0x23a88b(_0x2c96f9(0xaa2),_0x2c96f9(0xbf6)+_0x519164[_0x2c96f9(0x461)]+_0x2c96f9(0x75c),{'confirmButtonClass':_0x2c96f9(0x51b)});_0x5c2fb1&&(await _0x342df8[_0x2c96f9(0x32f)][_0x2c96f9(0x971)](_0x519164['id']),_0x41df36[_0x2c96f9(0x32f)]=await _0x342df8[_0x2c96f9(0x32f)][_0x2c96f9(0x21f)](),_0x6b8f41());};_0x3cfb50[_0x421d1d(0x271)](_0x421d1d(0x5c7),_0x103272),_0x3e15d1(_0x3cfb50,_0x28b4a7);const _0x5996b4=_0x3cfb50[_0x421d1d(0x117b)](!![]);_0x5996b4[_0x421d1d(0x271)](_0x421d1d(0x5c7),_0x103272),_0x3e15d1(_0x5996b4,_0x28b4a7),_0x2f00f2[_0x421d1d(0xe91)](_0x5996b4);const _0x250012=_0x519164[_0x421d1d(0xba3)]?String(_0x519164[_0x421d1d(0xba3)]):'uncategorized',_0x3a3c9e=_0x490770[_0x421d1d(0x89c)](_0x421d1d(0x107f)+_0x250012+'\x22]');_0x3a3c9e&&_0x3a3c9e['appendChild'](_0x3cfb50);}),document[_0x36ddff(0x400)](_0x36ddff(0x1181))['forEach'](_0x34aa73=>{const _0x4881d3=_0x36ddff;_0x34aa73['addEventListener'](_0x4881d3(0x5c7),()=>_0x16c79c(_0x34aa73[_0x4881d3(0x118)][_0x4881d3(0xba3)]));});}function _0x16c79c(_0x3736b4){const _0x55743f=_0x549949;document['querySelectorAll'](_0x55743f(0x1181))[_0x55743f(0x19c)](_0x2203ac=>{const _0x2510b8=_0x55743f;_0x2203ac[_0x2510b8(0x119a)][_0x2510b8(0x8f0)](_0x2510b8(0xde5),_0x2203ac[_0x2510b8(0x118)][_0x2510b8(0xba3)]===_0x3736b4);}),document['querySelectorAll']('#preset-content-container\x20.world-book-category-pane')[_0x55743f(0x19c)](_0x584223=>{const _0x142557=_0x55743f;_0x584223[_0x142557(0x119a)][_0x142557(0x8f0)](_0x142557(0xde5),_0x584223[_0x142557(0x118)][_0x142557(0xba3)]===_0x3736b4);});}async function _0x1aac09(_0x3ef9ea){const _0x2e9b44=_0x549949;_0x105acd('preset-editor-screen'),_0x4b9b36=_0x3ef9ea;try{const [_0xe97b9d,_0x55c79a]=await Promise[_0x2e9b44(0x1282)]([_0x342df8[_0x2e9b44(0x32f)][_0x2e9b44(0x1a3)](_0x3ef9ea),_0x342df8['presetCategories'][_0x2e9b44(0x21f)]()]);if(!_0xe97b9d){console[_0x2e9b44(0x98)](_0x2e9b44(0x1062),_0x3ef9ea),await _0x296ef9(_0x2e9b44(0x251),_0x2e9b44(0xeb3)),_0x105acd('preset-screen');return;}setTimeout(()=>{const _0x3a83ae=_0x2e9b44;document[_0x3a83ae(0x383)](_0x3a83ae(0x225))[_0x3a83ae(0x138e)]=_0xe97b9d[_0x3a83ae(0x461)],document['getElementById'](_0x3a83ae(0xc4b))[_0x3a83ae(0x1be)]=_0xe97b9d[_0x3a83ae(0x461)];const _0x1f13ba=document['getElementById'](_0x3a83ae(0x3b9));_0x1f13ba['innerHTML']=_0x3a83ae(0x95),_0x55c79a[_0x3a83ae(0x19c)](_0x565d69=>{const _0xa101d6=_0x3a83ae,_0x22c020=document[_0xa101d6(0xe1b)](_0xa101d6(0x10a0));_0x22c020[_0xa101d6(0x1be)]=_0x565d69['id'],_0x22c020['textContent']=_0x565d69[_0xa101d6(0x461)];if(_0xe97b9d[_0xa101d6(0xba3)]===_0x565d69['id'])_0x22c020[_0xa101d6(0x35e)]=!![];_0x1f13ba[_0xa101d6(0xe91)](_0x22c020);});const _0x27124c=document[_0x3a83ae(0x383)](_0x3a83ae(0x545));_0x27124c['innerHTML']='',Array[_0x3a83ae(0x565)](_0xe97b9d['content'])&&_0xe97b9d[_0x3a83ae(0x11b6)][_0x3a83ae(0xfde)]>0x0?_0xe97b9d[_0x3a83ae(0x11b6)][_0x3a83ae(0x19c)](_0x2c327d=>{const _0x5eb117=_0x4877fd(_0x2c327d);_0x27124c['appendChild'](_0x5eb117);}):_0x27124c['innerHTML']=_0x3a83ae(0x63b);},0x32);}catch(_0xad56a5){console[_0x2e9b44(0x98)](_0x2e9b44(0x10d7),_0xad56a5),await _0x296ef9('加载失败','加载预设详情时发生错误:\x20'+_0xad56a5['message']),_0x105acd(_0x2e9b44(0x11e6));}}function _0x4877fd(_0x5336eb={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x4285de=_0x549949,_0x61855f=document[_0x4285de(0xe1b)](_0x4285de(0x7fd));_0x61855f[_0x4285de(0x556)]=_0x4285de(0xd7e);const _0x354ddf=_0x5336eb['enabled']!==![]?_0x4285de(0x2a3):'';_0x61855f['innerHTML']=_0x4285de(0xf68)+_0x354ddf+_0x4285de(0xbe0)+(_0x5336eb['comment']||'')+_0x4285de(0x531)+(_0x5336eb[_0x4285de(0x66b)]||[])[_0x4285de(0xa35)](',\x20')+_0x4285de(0x49b)+(_0x5336eb[_0x4285de(0x11b6)]||'')+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x61855f[_0x4285de(0x89c)](_0x4285de(0x11c4))[_0x4285de(0x271)](_0x4285de(0x5c7),()=>_0x61855f[_0x4285de(0x131d)]());const _0x1ed41b=_0x61855f['querySelector'](_0x4285de(0xbc6)),_0x40c8a9=_0x61855f[_0x4285de(0x89c)](_0x4285de(0x675));return _0x1ed41b[_0x4285de(0x271)](_0x4285de(0x5c7),()=>{const _0x2de230=_0x4285de,_0x4f29b2=_0x40c8a9[_0x2de230(0x655)]['display']==='none';_0x40c8a9[_0x2de230(0x655)][_0x2de230(0x2b6)]=_0x4f29b2?_0x2de230(0x27a):_0x2de230(0xa70),_0x1ed41b['textContent']=_0x4f29b2?'收起':'展开';}),_0x61855f;}async function _0x1e7290(){const _0x12db11=_0x549949;await _0x45e862(),document[_0x12db11(0x89c)](_0x12db11(0xd00))['textContent']=_0x12db11(0xe2b),document[_0x12db11(0x383)](_0x12db11(0xdf8))[_0x12db11(0xc50)]=_0x577bd6,document[_0x12db11(0x383)]('existing-groups-list')[_0x12db11(0xc50)]=_0x490d2e=>{const _0x42ff21=_0x12db11;_0x490d2e['target'][_0x42ff21(0x119a)]['contains']('delete-group-btn')&&_0x270be2(parseInt(_0x490d2e[_0x42ff21(0xfab)]['dataset']['id']));},document[_0x12db11(0x383)]('close-group-manager-btn')[_0x12db11(0xc50)]=()=>{const _0x321dda=_0x12db11;document[_0x321dda(0x383)]('group-management-modal')[_0x321dda(0x119a)][_0x321dda(0x131d)](_0x321dda(0x106d)),_0x6b8f41();},document[_0x12db11(0x383)](_0x12db11(0x9ff))[_0x12db11(0x119a)][_0x12db11(0xbff)](_0x12db11(0x106d));}async function _0x45e862(){const _0x4251db=_0x549949,_0xad7869=document[_0x4251db(0x383)](_0x4251db(0x2f0)),_0x1fe382=await _0x342df8[_0x4251db(0xbea)][_0x4251db(0x21f)]();_0xad7869[_0x4251db(0x45c)]='',_0x1fe382[_0x4251db(0xfde)]===0x0&&(_0xad7869[_0x4251db(0x45c)]=_0x4251db(0xed6)),_0x1fe382[_0x4251db(0x19c)](_0x4a108d=>{const _0x598b90=_0x4251db,_0x421712=document[_0x598b90(0xe1b)](_0x598b90(0x7fd));_0x421712[_0x598b90(0x556)]=_0x598b90(0x7c0),_0x421712[_0x598b90(0x45c)]=_0x598b90(0x3cd)+_0x4a108d[_0x598b90(0x461)]+_0x598b90(0xb4d)+_0x4a108d['id']+'\x22>×</span>',_0xad7869[_0x598b90(0xe91)](_0x421712);});}async function _0x577bd6(){const _0x37c0a9=_0x549949,_0x4f8d0c=document[_0x37c0a9(0x383)](_0x37c0a9(0x10f)),_0x285363=_0x4f8d0c[_0x37c0a9(0x1be)]['trim']();if(!_0x285363)return alert(_0x37c0a9(0x536));const _0x36184d=await _0x342df8['presetCategories']['where'](_0x37c0a9(0x461))[_0x37c0a9(0x5b3)](_0x285363)['first']();if(_0x36184d)return alert(_0x37c0a9(0xf1b)+_0x285363+_0x37c0a9(0xe60));await _0x342df8['presetCategories']['add']({'name':_0x285363}),_0x4f8d0c[_0x37c0a9(0x1be)]='',await _0x45e862();}async function _0x270be2(_0x2ac1f5){const _0x7fd006=_0x549949,_0x14b317=await _0x23a88b(_0x7fd006(0x615),_0x7fd006(0x621),{'confirmButtonClass':_0x7fd006(0x51b)});_0x14b317&&(await _0x342df8[_0x7fd006(0xbea)]['delete'](_0x2ac1f5),await _0x342df8['presets']['where'](_0x7fd006(0xba3))[_0x7fd006(0x5b3)](_0x2ac1f5)[_0x7fd006(0x1190)]({'categoryId':null}),_0x41df36[_0x7fd006(0x32f)]=await _0x342df8[_0x7fd006(0x32f)][_0x7fd006(0x21f)](),await _0x45e862());}async function _0x1f0dfa(_0x23e282){const _0x331136=_0x549949,_0x2ed863=_0x23e282[_0x331136(0xfab)][_0x331136(0x1185)][0x0];if(!_0x2ed863)return;try{if(!_0x2ed863[_0x331136(0x461)][_0x331136(0xd47)](_0x331136(0xd33)))throw new Error(_0x331136(0x8b2));const _0x31e543=await _0x2ed863[_0x331136(0x6af)](),_0xdfc0fb=JSON[_0x331136(0x134)](_0x31e543);await _0x400ec5(_0xdfc0fb,_0x2ed863[_0x331136(0x461)]);}catch(_0x460819){console[_0x331136(0x98)]('预设导入失败:',_0x460819),await _0x296ef9('导入失败',_0x331136(0xc51)+_0x460819[_0x331136(0x5f8)]);}finally{_0x23e282[_0x331136(0xfab)][_0x331136(0x1be)]=null;}}async function _0x400ec5(_0x5308fd,_0x374caa){const _0x3c7132=_0x549949;let _0x5a5b7f=[];if(Array[_0x3c7132(0x565)](_0x5308fd['prompts'])&&Array[_0x3c7132(0x565)](_0x5308fd[_0x3c7132(0x3ad)])&&_0x5308fd[_0x3c7132(0x3ad)][_0x3c7132(0xfde)]>0x0){console[_0x3c7132(0xe72)](_0x3c7132(0x10eb));const _0x2fa73d=new Map(_0x5308fd[_0x3c7132(0x815)][_0x3c7132(0xa79)](_0x28e946=>[_0x28e946[_0x3c7132(0xa5d)],_0x28e946])),_0x16ba1e=_0x5308fd[_0x3c7132(0x3ad)]['reduce']((_0x470dfa,_0xff606b)=>_0xff606b['order']&&_0xff606b[_0x3c7132(0xe40)][_0x3c7132(0xfde)]>(_0x470dfa[_0x3c7132(0xfde)]||0x0)?_0xff606b[_0x3c7132(0xe40)]:_0x470dfa,[]);_0x16ba1e&&_0x16ba1e[_0x3c7132(0xfde)]>0x0&&(_0x5a5b7f=_0x16ba1e[_0x3c7132(0xa79)](_0x2d2dbf=>{const _0x2e8870=_0x3c7132,_0x4db281=_0x2fa73d[_0x2e8870(0x1a3)](_0x2d2dbf[_0x2e8870(0xa5d)]);if(_0x4db281)return{'keys':[],'comment':_0x4db281[_0x2e8870(0x461)]||_0x2e8870(0xdff),'content':_0x4db281[_0x2e8870(0x11b6)]||'','enabled':_0x2d2dbf[_0x2e8870(0x8e4)]};return null;})['filter'](Boolean));}else{if(_0x5308fd[_0x3c7132(0x329)]&&typeof _0x5308fd[_0x3c7132(0x329)]===_0x3c7132(0x890))console[_0x3c7132(0xe72)](_0x3c7132(0xb77)),Array[_0x3c7132(0x565)](_0x5308fd['order'])?(console[_0x3c7132(0xe72)]('检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。'),_0x5a5b7f=_0x5308fd['order'][_0x3c7132(0xa79)](_0xbfe541=>_0x5308fd['entries'][_0xbfe541])[_0x3c7132(0x98a)](Boolean)[_0x3c7132(0xa79)](_0x4feff1=>({'keys':_0x4feff1[_0x3c7132(0x965)]||[],'comment':_0x4feff1[_0x3c7132(0x125b)]||_0x3c7132(0x138b),'content':_0x4feff1['content']||'','enabled':!_0x4feff1[_0x3c7132(0xc93)]}))):(console[_0x3c7132(0x17b)]('未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。'),_0x5a5b7f=Object[_0x3c7132(0x76d)](_0x5308fd[_0x3c7132(0x329)])['map'](_0x5ebddd=>({'keys':_0x5ebddd['key']||[],'comment':_0x5ebddd[_0x3c7132(0x125b)]||_0x3c7132(0x138b),'content':_0x5ebddd[_0x3c7132(0x11b6)]||'','enabled':!_0x5ebddd['disable']})));else{if(Array[_0x3c7132(0x565)](_0x5308fd[_0x3c7132(0x815)]))console['log'](_0x3c7132(0xdc4)),_0x5a5b7f=_0x5308fd[_0x3c7132(0x815)][_0x3c7132(0xa79)](_0x232370=>({'keys':[],'comment':_0x232370['name']||'无标题','content':_0x232370[_0x3c7132(0x11b6)]||'','enabled':!![]}));else throw new Error(_0x3c7132(0x324));}}_0x5a5b7f=_0x5a5b7f[_0x3c7132(0x98a)](_0x38954b=>_0x38954b[_0x3c7132(0x11b6)]);if(_0x5a5b7f[_0x3c7132(0xfde)]===0x0){alert(_0x3c7132(0xcb1));return;}const _0x43fdd5=_0x374caa['replace'](/\.json$/i,''),_0x4e57fb=await _0x12e332(_0x3c7132(0x9f0),'请为这组提示词预设命名：',_0x43fdd5);if(!_0x4e57fb||!_0x4e57fb['trim']()){alert('导入已取消，因为未提供名称。');return;}const _0x4b35d1={'id':_0x3c7132(0x8f4)+Date[_0x3c7132(0x108d)](),'name':_0x4e57fb[_0x3c7132(0x1cb)](),'content':_0x5a5b7f,'categoryId':null};await _0x342df8[_0x3c7132(0x32f)][_0x3c7132(0xbff)](_0x4b35d1),_0x41df36[_0x3c7132(0x32f)][_0x3c7132(0x258)](_0x4b35d1),await _0x6b8f41(),await _0x296ef9(_0x3c7132(0xc89),_0x3c7132(0xc49)+_0x4e57fb+'》。');}async function _0x52829c(_0x1c9e5a){const _0x5bea6d=_0x549949,_0x1225ca=document[_0x5bea6d(0x383)](_0x5bea6d(0x8a4));if(!_0x1225ca)return;const _0x2a02c7=_0x41df36[_0x5bea6d(0x32f)]||[];_0x1225ca[_0x5bea6d(0x45c)]=_0x5bea6d(0xf53),_0x2a02c7[_0x5bea6d(0x19c)](_0x425dae=>{const _0x5900e4=_0x5bea6d,_0x283053=document['createElement'](_0x5900e4(0x10a0));_0x283053[_0x5900e4(0x1be)]=_0x425dae['id'],_0x283053[_0x5900e4(0x138e)]=_0x425dae['name'],_0x1225ca[_0x5900e4(0xe91)](_0x283053);}),_0x1c9e5a[_0x5bea6d(0x886)][_0x5bea6d(0xca5)]&&(_0x1225ca[_0x5bea6d(0x1be)]=_0x1c9e5a[_0x5bea6d(0x886)]['offlinePresetId']);}function _0x4bc6a4(){const _0xf8dd20=_0x549949,_0x505899=document[_0xf8dd20(0x383)](_0xf8dd20(0x8f1));if(!_0x505899)return;_0x505899[_0xf8dd20(0x45c)]='';let _0x25f84c=_0x41df36['globalSettings'][_0xf8dd20(0xb43)]||_0x37c0ce;_0x25f84c[_0xf8dd20(0x19c)](_0x1fad72=>{const _0x15a9eb=_0xf8dd20,_0xaf536f=document[_0x15a9eb(0x383)](_0x1fad72);if(_0xaf536f){const _0x2922cf=document[_0x15a9eb(0xe1b)]('div');_0x2922cf[_0x15a9eb(0x556)]=_0x15a9eb(0x10b0),_0x2922cf[_0x15a9eb(0x12f6)]=!![],_0x2922cf[_0x15a9eb(0x118)][_0x15a9eb(0x227)]=_0x1fad72,_0x2922cf[_0x15a9eb(0x45c)]=_0xaf536f[_0x15a9eb(0x45c)],_0x505899[_0x15a9eb(0xe91)](_0x2922cf);}});}function _0x35e329(){const _0x358b91=_0x549949,_0x206523=document['getElementById'](_0x358b91(0x8f1));if(!_0x206523)return;let _0x37d2dd=null;const _0x26c303=_0x3df699=>{const _0x2051eb=_0x358b91,_0x344480=_0x3df699[_0x2051eb(0xfab)]['closest'](_0x2051eb(0x10e4));if(!_0x344480)return;_0x37d2dd=_0x344480,_0x37d2dd[_0x2051eb(0x119a)][_0x2051eb(0xbff)](_0x2051eb(0xc96));if(_0x3df699['cancelable'])_0x3df699[_0x2051eb(0xe94)]();},_0x4dfed0=_0x176510=>{const _0x2032a4=_0x358b91;if(!_0x37d2dd)return;const _0x2e593b=_0x176510[_0x2032a4(0xa6b)]['includes'](_0x2032a4(0x1bc))?_0x176510[_0x2032a4(0xce6)]:_0x176510['touches'][0x0]['clientX'],_0x1b255f=_0x1da29a(_0x206523,_0x2e593b);_0x1b255f==null?_0x206523[_0x2032a4(0xe91)](_0x37d2dd):_0x206523[_0x2032a4(0x11c5)](_0x37d2dd,_0x1b255f);},_0x441107=()=>{const _0x44cc20=_0x358b91;if(!_0x37d2dd)return;_0x37d2dd[_0x44cc20(0x119a)][_0x44cc20(0x131d)]('dragging'),_0x37d2dd=null,_0x2e0fe0();};_0x206523[_0x358b91(0x271)](_0x358b91(0x413),_0x26c303),_0x206523[_0x358b91(0x271)](_0x358b91(0xcb7),_0x26c303,{'passive':![]}),_0x206523[_0x358b91(0x271)](_0x358b91(0x1287),_0x4dfed0),_0x206523[_0x358b91(0x271)]('touchmove',_0x4dfed0,{'passive':![]}),_0x206523[_0x358b91(0x271)](_0x358b91(0x1338),_0x441107),_0x206523[_0x358b91(0x271)](_0x358b91(0xb15),_0x441107),_0x206523[_0x358b91(0x271)](_0x358b91(0x2e9),_0x441107);}function _0x1da29a(_0x393e52,_0x13dc25){const _0x25ebae=_0x549949,_0x48758d=[..._0x393e52[_0x25ebae(0x400)](_0x25ebae(0x1155))];return _0x48758d[_0x25ebae(0xf60)]((_0x314a9a,_0x398b14)=>{const _0x56b8e8=_0x25ebae,_0x5b9a15=_0x398b14[_0x56b8e8(0x9c5)](),_0x1b87d8=_0x13dc25-_0x5b9a15[_0x56b8e8(0x402)]-_0x5b9a15[_0x56b8e8(0xabd)]/0x2;return _0x1b87d8<0x0&&_0x1b87d8>_0x314a9a[_0x56b8e8(0x375)]?{'offset':_0x1b87d8,'element':_0x398b14}:_0x314a9a;},{'offset':Number[_0x25ebae(0xda1)]})['element'];}async function _0x2e0fe0(){const _0x2b8849=_0x549949,_0x23cc6a=document[_0x2b8849(0x383)](_0x2b8849(0x8f1)),_0x50fbca=Array['from'](_0x23cc6a[_0x2b8849(0x400)](_0x2b8849(0x10e4)))['map'](_0x4588c1=>_0x4588c1[_0x2b8849(0x118)][_0x2b8849(0x227)]);_0x41df36['globalSettings'][_0x2b8849(0xb43)]=_0x50fbca,await _0x342df8['globalSettings']['put'](_0x41df36['globalSettings']);}function _0x9b7052(){const _0x3a7d72=_0x549949,_0x578bca=_0x41df36[_0x3a7d72(0xc0)][_0x3a7d72(0xb43)];if(!_0x578bca||!Array['isArray'](_0x578bca)||_0x578bca[_0x3a7d72(0xfde)]===0x0)return;const _0x5d80d2=document[_0x3a7d72(0x383)](_0x3a7d72(0x11f6));if(!_0x5d80d2)return;_0x578bca['forEach'](_0x4c65d5=>{const _0x5bbc8c=_0x3a7d72,_0x53e876=document[_0x5bbc8c(0x383)](_0x4c65d5);_0x53e876&&_0x5d80d2[_0x5bbc8c(0xe91)](_0x53e876);});}const _0x37c0ce=[_0x549949(0x424),_0x549949(0x345),'upload-image-btn',_0x549949(0xe4d),_0x549949(0xbd9),_0x549949(0xc7b),'video-call-btn',_0x549949(0xfa4),_0x549949(0x6f1),_0x549949(0x21d),_0x549949(0x130b),_0x549949(0x5e3),_0x549949(0x73c),_0x549949(0x1321),'edit-last-response-btn','regenerate-btn',_0x549949(0xf33),_0x549949(0x37a),_0x549949(0x467),_0x549949(0xc2e)];async function _0x230007(){const _0x3a9a19=_0x549949;_0x41df36[_0x3a9a19(0xc0)]['chatActionButtonsOrder']=null,await _0x342df8[_0x3a9a19(0xc0)][_0x3a9a19(0x9c0)](_0x41df36[_0x3a9a19(0xc0)]),_0x4bc6a4(),_0x9b7052(),await _0x296ef9('成功',_0x3a9a19(0x12b7));}let _0x2fd892=[],_0x4b8ca3=[];function _0x4458cf(){const _0x214675=_0x549949,_0x594086=document[_0x214675(0x383)](_0x214675(0x103c));_0x2fd892=[],_0x4b8ca3=[],_0x16961d(),document[_0x214675(0x383)]('data-clear-step-1')[_0x214675(0x655)][_0x214675(0x2b6)]=_0x214675(0x2aa),document['getElementById'](_0x214675(0xa23))[_0x214675(0x655)][_0x214675(0x2b6)]=_0x214675(0xa70),_0x594086['classList'][_0x214675(0xbff)](_0x214675(0x106d));}function _0x16961d(){const _0xe22777=_0x549949,_0x6a584a=document['getElementById'](_0xe22777(0x451));_0x6a584a[_0xe22777(0x45c)]='';const _0xaf1c00=document[_0xe22777(0xe1b)](_0xe22777(0x7fd));_0xaf1c00[_0xe22777(0x556)]=_0xe22777(0x61b),_0xaf1c00[_0xe22777(0x118)][_0xe22777(0xb49)]=_0xe22777(0x66e),_0xaf1c00[_0xe22777(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+(_0x41df36[_0xe22777(0x571)][_0xe22777(0xabb)]||'我')+'\x20(用户)</span>\x0a\x20\x20\x20\x20',_0x6a584a['appendChild'](_0xaf1c00),Object[_0xe22777(0x76d)](_0x41df36['chats'])[_0xe22777(0x19c)](_0x4313c5=>{const _0x11c68e=_0xe22777;if(!_0x4313c5[_0x11c68e(0x1a2)]){const _0x139221=document[_0x11c68e(0xe1b)](_0x11c68e(0x7fd));_0x139221[_0x11c68e(0x556)]=_0x11c68e(0x61b),_0x139221[_0x11c68e(0x118)]['charId']=_0x4313c5['id'],_0x139221[_0x11c68e(0x45c)]=_0x11c68e(0xc40)+_0x4313c5[_0x11c68e(0x461)]+_0x11c68e(0x7fb),_0x6a584a[_0x11c68e(0xe91)](_0x139221);}});}function _0x2cd940(){const _0x3c2b38=_0x549949,_0x2b2242=document[_0x3c2b38(0x383)](_0x3c2b38(0x797));_0x2b2242['innerHTML']='';const _0x2d4662=[{'id':_0x3c2b38(0x135e),'name':_0x3c2b38(0x6a3),'description':_0x3c2b38(0x6b9)},{'id':_0x3c2b38(0x12a9),'name':'动态与互动','description':'将清空选定角色的所有动态、评论和点赞。'},{'id':_0x3c2b38(0x1132),'name':_0x3c2b38(0xb10),'description':'将清空选定角色的所有通话记录。'},{'id':'thoughts','name':'心声','description':_0x3c2b38(0x1224)},{'id':_0x3c2b38(0x966),'name':_0x3c2b38(0xbec),'description':'将清空选定角色的所有长期记忆。'},{'id':_0x3c2b38(0x5c5),'name':'收藏','description':_0x3c2b38(0x106)},{'id':'cphone','name':_0x3c2b38(0x330),'description':_0x3c2b38(0x903)}];_0x2d4662['forEach'](_0x5cf005=>{const _0x451728=_0x3c2b38,_0x446ede=document[_0x451728(0xe1b)](_0x451728(0x7fd));_0x446ede['className']=_0x451728(0x61b),_0x446ede[_0x451728(0x118)][_0x451728(0x100f)]=_0x5cf005['id'],_0x446ede[_0x451728(0x45c)]=_0x451728(0x6f0)+_0x5cf005[_0x451728(0x461)]+_0x451728(0x1275)+_0x5cf005['description']+_0x451728(0x740),_0x2b2242[_0x451728(0xe91)](_0x446ede);});}function _0x301e01(){const _0xdc4f4f=_0x549949,_0x3afa1a=document[_0xdc4f4f(0x400)](_0xdc4f4f(0x117e));if(_0x3afa1a[_0xdc4f4f(0xfde)]===0x0){alert('请至少选择一个要清理的角色。');return;}_0x2fd892=Array['from'](_0x3afa1a)[_0xdc4f4f(0xa79)](_0x53d439=>_0x53d439[_0xdc4f4f(0x118)][_0xdc4f4f(0xb49)]),_0x2cd940(),document[_0xdc4f4f(0x383)](_0xdc4f4f(0x2be))['style'][_0xdc4f4f(0x2b6)]=_0xdc4f4f(0xa70),document[_0xdc4f4f(0x383)]('data-clear-step-2')[_0xdc4f4f(0x655)][_0xdc4f4f(0x2b6)]=_0xdc4f4f(0x2aa);}function _0x399eed(){const _0x4102e2=_0x549949;document[_0x4102e2(0x383)](_0x4102e2(0xa23))[_0x4102e2(0x655)][_0x4102e2(0x2b6)]=_0x4102e2(0xa70),document[_0x4102e2(0x383)](_0x4102e2(0x2be))['style'][_0x4102e2(0x2b6)]=_0x4102e2(0x2aa),document[_0x4102e2(0x400)](_0x4102e2(0x1286))[_0x4102e2(0x19c)](_0xfe80f4=>{const _0x46bfc2=_0x4102e2;_0x2fd892[_0x46bfc2(0xee2)](_0xfe80f4[_0x46bfc2(0x118)][_0x46bfc2(0xb49)])&&_0xfe80f4[_0x46bfc2(0x119a)]['add'](_0x46bfc2(0x35e));});}async function _0x511597(){const _0x4b4b2c=_0x549949,_0x110414=document['querySelectorAll']('#data-clear-type-list\x20.clear-posts-item.selected');if(_0x110414[_0x4b4b2c(0xfde)]===0x0){alert(_0x4b4b2c(0x228));return;}_0x4b8ca3=Array[_0x4b4b2c(0x365)](_0x110414)[_0x4b4b2c(0xa79)](_0x511090=>_0x511090['dataset'][_0x4b4b2c(0x100f)]);const _0x9ab61a=await _0x23a88b(_0x4b4b2c(0x94d),_0x4b4b2c(0x3a4),{'confirmButtonClass':_0x4b4b2c(0x51b),'confirmText':_0x4b4b2c(0x615)});if(!_0x9ab61a)return;await _0x296ef9(_0x4b4b2c(0x4a6),'正在执行清理操作，请不要关闭页面...');try{await _0x342df8['transaction']('rw',_0x342df8[_0x4b4b2c(0x10ef)],async()=>{const _0x47ba8f=_0x4b4b2c;for(const _0x56a036 of _0x2fd892){for(const _0x2c81a5 of _0x4b8ca3){if(_0x2c81a5===_0x47ba8f(0x135e)){if(_0x56a036===_0x47ba8f(0x66e)){const _0x28a7bd=await _0x342df8[_0x47ba8f(0x864)][_0x47ba8f(0x21f)]();for(const _0x254e0a of _0x28a7bd){_0x254e0a['history']=_0x254e0a[_0x47ba8f(0xd08)][_0x47ba8f(0x98a)](_0x247e95=>_0x247e95['role']!==_0x47ba8f(0x66e)),await _0x342df8['chats'][_0x47ba8f(0x9c0)](_0x254e0a);}}else{const _0x4b9de0=await _0x342df8[_0x47ba8f(0x864)][_0x47ba8f(0x1a3)](_0x56a036);_0x4b9de0&&(_0x4b9de0[_0x47ba8f(0xd08)]=[],_0x4b9de0[_0x47ba8f(0xa52)]=_0x47ba8f(0x1026),_0x4b9de0[_0x47ba8f(0xc2b)]=_0x47ba8f(0x1026),Array['isArray'](_0x4b9de0[_0x47ba8f(0xcf9)])&&(_0x4b9de0[_0x47ba8f(0xcf9)]=[]),_0x4b9de0['settings']&&(_0x4b9de0[_0x47ba8f(0x886)]['myNickname']='我'),await _0x342df8[_0x47ba8f(0x864)][_0x47ba8f(0x9c0)](_0x4b9de0));}}if(_0x2c81a5===_0x47ba8f(0x12a9)){const _0x1f5178=_0x56a036===_0x47ba8f(0x66e)?_0x47ba8f(0x66e):_0x56a036;await _0x342df8[_0x47ba8f(0x35a)][_0x47ba8f(0x6bd)]('authorId')[_0x47ba8f(0x5b3)](_0x1f5178)['delete']();}_0x2c81a5===_0x47ba8f(0x1132)&&_0x56a036!==_0x47ba8f(0x66e)&&await _0x342df8[_0x47ba8f(0xdb9)][_0x47ba8f(0x6bd)](_0x47ba8f(0xa65))[_0x47ba8f(0x5b3)](_0x56a036)[_0x47ba8f(0x971)]();if(_0x2c81a5==='thoughts'&&_0x56a036!==_0x47ba8f(0x66e)){const _0x241984=await _0x342df8['chats'][_0x47ba8f(0x1a3)](_0x56a036);_0x241984&&(_0x241984[_0x47ba8f(0x4f8)]=[],_0x241984['heartfeltVoice']=_0x47ba8f(0x1026),_0x241984[_0x47ba8f(0xc2b)]=_0x47ba8f(0x1026),await _0x342df8[_0x47ba8f(0x864)][_0x47ba8f(0x9c0)](_0x241984));}if(_0x2c81a5===_0x47ba8f(0x966)&&_0x56a036!=='user'){const _0x311462=await _0x342df8['chats'][_0x47ba8f(0x1a3)](_0x56a036);_0x311462&&(_0x311462[_0x47ba8f(0x1349)]=[],await _0x342df8[_0x47ba8f(0x864)]['put'](_0x311462));}_0x2c81a5===_0x47ba8f(0x5c5)&&(_0x56a036===_0x47ba8f(0x66e)?(await _0x342df8[_0x47ba8f(0x5c5)][_0x47ba8f(0x6bd)](_0x47ba8f(0xa6b))[_0x47ba8f(0x5b3)](_0x47ba8f(0xd91))[_0x47ba8f(0x98a)](_0x1f11a8=>_0x1f11a8[_0x47ba8f(0x11b6)][_0x47ba8f(0x1301)]==='user')[_0x47ba8f(0x971)](),await _0x342df8['favorites'][_0x47ba8f(0x6bd)]('type')[_0x47ba8f(0x5b3)](_0x47ba8f(0xbbe))[_0x47ba8f(0x98a)](_0x250802=>_0x250802['content'][_0x47ba8f(0x10ff)]===_0x47ba8f(0x66e))[_0x47ba8f(0x971)]()):(await _0x342df8['favorites']['where']('type')[_0x47ba8f(0x5b3)](_0x47ba8f(0xbbe))[_0x47ba8f(0xfb7)](_0x35eff0=>_0x35eff0[_0x47ba8f(0xa65)]===_0x56a036)[_0x47ba8f(0x971)](),await _0x342df8[_0x47ba8f(0x5c5)][_0x47ba8f(0x6bd)](_0x47ba8f(0xa6b))[_0x47ba8f(0x5b3)](_0x47ba8f(0xd91))[_0x47ba8f(0x98a)](_0x3c0e0e=>_0x3c0e0e[_0x47ba8f(0x11b6)][_0x47ba8f(0x1301)]===_0x56a036)[_0x47ba8f(0x971)](),await _0x342df8[_0x47ba8f(0x5c5)][_0x47ba8f(0x6bd)](_0x47ba8f(0xa6b))[_0x47ba8f(0x5b3)](_0x47ba8f(0x997))[_0x47ba8f(0x98a)](_0x4ae0ff=>_0x4ae0ff[_0x47ba8f(0x11b6)][_0x47ba8f(0x792)]===_0x56a036)['delete'](),await _0x342df8[_0x47ba8f(0x5c5)][_0x47ba8f(0x6bd)](_0x47ba8f(0xa6b))[_0x47ba8f(0x5b3)](_0x47ba8f(0xa1b))['filter'](_0x56df48=>_0x56df48[_0x47ba8f(0x11b6)][_0x47ba8f(0x792)]===_0x56a036)[_0x47ba8f(0x971)](),await _0x342df8['favorites']['where'](_0x47ba8f(0xa6b))[_0x47ba8f(0x5b3)](_0x47ba8f(0x1147))[_0x47ba8f(0x98a)](_0x1b4747=>_0x1b4747['content'][_0x47ba8f(0x792)]===_0x56a036)[_0x47ba8f(0x971)]()));if(_0x2c81a5===_0x47ba8f(0xa8b)&&_0x56a036!==_0x47ba8f(0x66e)){const _0x5c8294=await _0x342df8['chats'][_0x47ba8f(0x1a3)](_0x56a036);_0x5c8294&&(_0x5c8294[_0x47ba8f(0x3f2)]=[],_0x5c8294['simulatedConversations']=[],_0x5c8294[_0x47ba8f(0x50b)]=[],_0x5c8294[_0x47ba8f(0x2ab)]=null,_0x5c8294[_0x47ba8f(0x117d)]=[],_0x5c8294['simulatedAppUsage']=[],_0x5c8294[_0x47ba8f(0x130a)]=[],_0x5c8294['diary']=[],_0x5c8294[_0x47ba8f(0x5cb)]=[],await _0x342df8[_0x47ba8f(0x864)]['put'](_0x5c8294));}}}}),await _0x28f04a(),await _0x25558e(),document[_0x4b4b2c(0x383)](_0x4b4b2c(0x103c))[_0x4b4b2c(0x119a)]['remove']('visible'),await _0x296ef9('清理完成',_0x4b4b2c(0x1284));}catch(_0x4dbfd5){console[_0x4b4b2c(0x98)](_0x4b4b2c(0xefc),_0x4dbfd5),await _0x296ef9('清理失败',_0x4b4b2c(0xb0d)+_0x4dbfd5[_0x4b4b2c(0x5f8)]);}}async function _0x965993(_0x48f050,_0x1b2367,_0x33738d){const _0x2d9ac2=_0x549949,_0xbdb0f9=_0x33738d[_0x2d9ac2(0x89c)](_0x2d9ac2(0xa66))[_0x2d9ac2(0xd7f)],_0x124102=await _0x2d60a4(_0x2d9ac2(0x1fc)+_0xbdb0f9+_0x2d9ac2(0xe90),[{'text':_0x2d9ac2(0x107c),'value':'local'},{'text':_0x2d9ac2(0xc61),'value':'url'}]);let _0x5bc3ba=null;if(_0x124102===_0x2d9ac2(0x30b))_0x5bc3ba=await _0x20227a();else{if(_0x124102===_0x2d9ac2(0x2fa)){const _0x5cc51a=_0x1b2367==='cphone'?_0x41df36[_0x2d9ac2(0xc0)]['cphoneAppIcons'][_0x48f050]:_0x41df36[_0x2d9ac2(0xc0)][_0x2d9ac2(0x33f)][_0x48f050],_0x3ce4f5=_0x5cc51a[_0x2d9ac2(0x1122)](_0x2d9ac2(0x446)),_0x480333=_0x3ce4f5?'':_0x5cc51a;_0x5bc3ba=await _0x12e332(_0x2d9ac2(0x368),_0x2d9ac2(0x3e5),_0x480333,_0x2d9ac2(0x2fa));}}if(_0x5bc3ba&&_0x5bc3ba[_0x2d9ac2(0x1cb)]()){const _0x37f4e2=_0x5bc3ba['trim']();_0x1b2367==='cphone'?_0x41df36[_0x2d9ac2(0xc0)]['cphoneAppIcons'][_0x48f050]=_0x37f4e2:_0x41df36[_0x2d9ac2(0xc0)]['appIcons'][_0x48f050]=_0x37f4e2,_0x33738d[_0x2d9ac2(0x89c)](_0x2d9ac2(0xa66))[_0x2d9ac2(0xf6c)]=_0x37f4e2;}else _0x5bc3ba!==null&&alert(_0x2d9ac2(0x4ba));}async function _0x1d279a(){const _0x49153=_0x549949,_0x3d5480=await _0x23a88b('确认压缩图片？',_0x49153(0x137d),{'confirmButtonClass':'btn-danger','confirmText':_0x49153(0x21b)});if(!_0x3d5480)return;await _0x296ef9(_0x49153(0x4a6),_0x49153(0x1049));let _0x3743eb={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console['log']('压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...');const _0x39d31b=[_0x49153(0x864),'globalSettings',_0x49153(0x571),_0x49153(0x823),'customAvatarFrames'],_0x1ca1d8=[];for(const _0x4f52a1 of _0x39d31b){const _0x4c90ff=_0x342df8['table'](_0x4f52a1),_0x3733ec=await _0x4c90ff[_0x49153(0x21f)]();_0x1ca1d8[_0x49153(0x258)]({'tableName':_0x4f52a1,'records':_0x3733ec});}console[_0x49153(0xe72)](_0x49153(0x2a9));for(const _0x1b0c07 of _0x1ca1d8){for(const _0x16ce6b of _0x1b0c07[_0x49153(0x48b)]){await _0x23d3fc(_0x16ce6b,_0x3743eb);}}console[_0x49153(0xe72)](_0x49153(0x7e6)),await _0x342df8['transaction']('rw',_0x39d31b,async()=>{const _0x139621=_0x49153;for(const _0x14adf6 of _0x1ca1d8){await _0x342df8['table'](_0x14adf6[_0x139621(0x11d5)])['bulkPut'](_0x14adf6['records']);}});const _0x179b10=_0x3743eb['originalSize']-_0x3743eb[_0x49153(0x3c4)],_0x41e4f7=_0x3743eb['originalSize']>0x0?(_0x179b10/_0x3743eb['originalSize']*0x64)['toFixed'](0x2):0x0;await _0x296ef9(_0x49153(0xdf6),_0x49153(0xc31)+_0x3743eb['found']+_0x49153(0xc8b)+_0x3743eb[_0x49153(0x355)]+_0x49153(0x211)+_0x3743eb[_0x49153(0xe09)]+_0x49153(0x236)+(_0x179b10/0x400/0x400)[_0x49153(0x70d)](0x2)+'\x20MB</strong>\x20(压缩率\x20'+_0x41e4f7+'%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。');}catch(_0x44aba5){console[_0x49153(0x98)]('图片压缩过程中发生错误:',_0x44aba5),await _0x296ef9(_0x49153(0xcc4),_0x49153(0xb0d)+_0x44aba5[_0x49153(0x5f8)]);}}function _0x2f5568(_0x5b72ef,_0x1807f4=''){const _0x50e48c=_0x549949;let _0x2ba679=0x0;for(const _0x31f08f in _0x5b72ef){if(_0x5b72ef[_0x50e48c(0xd54)](_0x31f08f)){const _0xa9d760=_0x5b72ef[_0x31f08f];if(typeof _0xa9d760===_0x50e48c(0xafa)&&_0xa9d760[_0x50e48c(0x1122)](_0x50e48c(0x446))){const _0x2ebce8=_0x1807f4===_0x50e48c(0xc0)&&(_0x31f08f===_0x50e48c(0x5d0)||_0x31f08f==='cphoneWallpaper'||_0x31f08f===_0x50e48c(0x7bb))||_0x1807f4===_0x50e48c(0x5ec)||_0x1807f4===_0x50e48c(0x886)&&_0x31f08f===_0x50e48c(0x415)||(_0x1807f4===_0x50e48c(0x33f)||_0x1807f4===_0x50e48c(0x943));!_0x2ebce8&&(_0x2ba679+=_0xa9d760[_0x50e48c(0xfde)]);}else typeof _0xa9d760===_0x50e48c(0x890)&&_0xa9d760!==null&&(_0x2ba679+=_0x2f5568(_0xa9d760,_0x31f08f));}}return _0x2ba679;}async function _0x576e53(){const _0x4f90f1=_0x549949,_0x5d1fa6=document[_0x4f90f1(0x383)](_0x4f90f1(0x311));if(!_0x5d1fa6)return;_0x5d1fa6[_0x4f90f1(0x45c)]=_0x4f90f1(0x8a5);try{let _0x4487dd=0x0;const _0xd3eef7=['chats',_0x4f90f1(0xc0),_0x4f90f1(0x571),_0x4f90f1(0x823),_0x4f90f1(0xcf3)];for(const _0x5fd942 of _0xd3eef7){const _0x54e11a=_0x342df8[_0x4f90f1(0xac)](_0x5fd942);await _0x54e11a[_0x4f90f1(0x193)](_0x3d144b=>{_0x4487dd+=_0x2f5568(_0x3d144b);});}const _0xdfd7a0=(_0x4487dd/0x400/0x400)[_0x4f90f1(0x70d)](0x2);_0x5d1fa6[_0x4f90f1(0x45c)]=_0x4f90f1(0x3b2)+_0xdfd7a0+'\x20MB</strong></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}catch(_0x46a72e){console[_0x4f90f1(0x98)](_0x4f90f1(0x6f3),_0x46a72e),_0x5d1fa6[_0x4f90f1(0x45c)]=_0x4f90f1(0x12ce);}}async function _0x23d3fc(_0x12d7fd,_0x1a7647,_0x33d1dc=''){const _0x32a21f=_0x549949;for(const _0x35be7f in _0x12d7fd){if(_0x12d7fd[_0x32a21f(0xd54)](_0x35be7f)){const _0x51be31=_0x12d7fd[_0x35be7f];if(typeof _0x51be31===_0x32a21f(0xafa)&&_0x51be31['startsWith'](_0x32a21f(0x446))){const _0x1842a9=_0x33d1dc==='globalSettings'&&(_0x35be7f===_0x32a21f(0x5d0)||_0x35be7f==='cphoneWallpaper'||_0x35be7f===_0x32a21f(0x7bb))||_0x33d1dc===_0x32a21f(0x5ec)||_0x33d1dc===_0x32a21f(0x886)&&_0x35be7f===_0x32a21f(0x415)||(_0x33d1dc===_0x32a21f(0x33f)||_0x33d1dc==='cphoneAppIcons');if(_0x1842a9)continue;_0x1a7647['found']++,_0x1a7647[_0x32a21f(0x331)]+=_0x51be31[_0x32a21f(0xfde)];const _0x355ce7=await _0x2a4754(_0x51be31);_0x355ce7&&_0x355ce7!==_0x51be31?(_0x12d7fd[_0x35be7f]=_0x355ce7,_0x1a7647['compressed']++,_0x1a7647[_0x32a21f(0x3c4)]+=_0x355ce7[_0x32a21f(0xfde)]):(_0x1a7647['skipped']++,_0x1a7647['newSize']+=_0x51be31[_0x32a21f(0xfde)]);}else typeof _0x51be31===_0x32a21f(0x890)&&_0x51be31!==null&&await _0x23d3fc(_0x51be31,_0x1a7647,_0x35be7f);}}}function _0x2a4754(_0x40b7c4,_0xbd40f1={}){return new Promise(_0x20329f=>{const _0x4b50af=_0x42ed;if(!_0x40b7c4['startsWith']('data:image')){console['warn'](_0x4b50af(0xacc),_0x40b7c4[_0x4b50af(0xba5)](0x0,0x32)+_0x4b50af(0x1026)),_0x20329f(_0x40b7c4);return;}const _0x1a43d1=_0xbd40f1['quality']||0.5,_0x29be81=_0xbd40f1[_0x4b50af(0xf9a)]||0x320,_0x3164be=new Image();_0x3164be[_0x4b50af(0xb5b)]=()=>{const _0xbe83e8=_0x4b50af;let _0x4195fc=_0x3164be[_0xbe83e8(0xabd)],_0x40c030=_0x3164be[_0xbe83e8(0xbb2)];_0x4195fc>_0x29be81&&(_0x40c030=Math['round'](_0x29be81/_0x4195fc*_0x40c030),_0x4195fc=_0x29be81);const _0x5f50aa=document[_0xbe83e8(0xe1b)](_0xbe83e8(0x25c));_0x5f50aa[_0xbe83e8(0xabd)]=_0x4195fc,_0x5f50aa['height']=_0x40c030;const _0x35bc33=_0x5f50aa[_0xbe83e8(0xcff)]('2d');_0x35bc33[_0xbe83e8(0x60e)](_0x3164be,0x0,0x0,_0x4195fc,_0x40c030);const _0x1de6f3=_0x5f50aa[_0xbe83e8(0x7c5)](_0xbe83e8(0x3f3),_0x1a43d1);_0x20329f(_0x1de6f3);},_0x3164be['onerror']=()=>{const _0x1c2f0c=_0x4b50af;console[_0x1c2f0c(0x17b)]('加载图片失败，跳过压缩:',_0x40b7c4[_0x1c2f0c(0xba5)](0x0,0x32)+'...'),_0x20329f(_0x40b7c4);},_0x3164be['src']=_0x40b7c4;});}function _0x4f29e3(_0xdbdfbb,_0x5ab6ff){const _0xcdb0e2=_0x549949;if(!_0xdbdfbb||!_0x5ab6ff||typeof _0xdbdfbb!==_0xcdb0e2(0xafa)||typeof _0x5ab6ff!=='string')return 0x0;const _0x40c27d=_0xdbdfbb[_0xcdb0e2(0x105d)]('.')[_0xcdb0e2(0xa79)](Number),_0xe62453=_0x5ab6ff['split']('.')[_0xcdb0e2(0xa79)](Number),_0x141956=Math[_0xcdb0e2(0xaf3)](_0x40c27d[_0xcdb0e2(0xfde)],_0xe62453[_0xcdb0e2(0xfde)]);for(let _0x145533=0x0;_0x145533<_0x141956;_0x145533++){const _0x53d129=_0x40c27d[_0x145533]||0x0,_0xfdc31a=_0xe62453[_0x145533]||0x0;if(_0x53d129>_0xfdc31a)return 0x1;if(_0x53d129<_0xfdc31a)return-0x1;}return 0x0;}async function _0xd5e3db(){const _0x17e57f=_0x549949,_0xc1316a=_0x17e57f(0xe3);try{const _0x4d871f=await fetch(_0x17e57f(0x956)+Date[_0x17e57f(0x108d)]());if(!_0x4d871f['ok']){console[_0x17e57f(0x17b)](_0x17e57f(0x9b1));return;}const _0x4853a1=await _0x4d871f[_0x17e57f(0x6af)](),_0x1fb9c6=document[_0x17e57f(0xe1b)](_0x17e57f(0x7fd));_0x1fb9c6[_0x17e57f(0x45c)]=_0x4853a1;const _0x1dca79=_0x1fb9c6['querySelector'](_0x17e57f(0xc3d));if(!_0x1dca79){console['error'](_0x17e57f(0x9ae));return;}const _0x1dcc25=_0x1dca79[_0x17e57f(0x118)][_0x17e57f(0xb06)],_0x3e9917=localStorage['getItem'](_0x17e57f(0x2c4));!_0x3e9917||_0x4f29e3(_0x1dcc25,_0x3e9917)>0x0?(console[_0x17e57f(0xe72)](_0x17e57f(0x2cb)+_0x1dcc25+'\x20(已忽略版本:\x20'+(_0x3e9917||'无')+')'),_0x4f9ddc(_0x1dcc25,_0x1dca79[_0x17e57f(0x45c)])):console[_0x17e57f(0xe72)](_0x17e57f(0x1061)+_0x1dcc25+')\x20已被用户忽略或为旧版本，无需显示。');}catch(_0x5ad111){console[_0x17e57f(0x98)](_0x17e57f(0xe3b),_0x5ad111);}}function _0x4f9ddc(_0x2e99df,_0x3d5d41){const _0x2dcc78=_0x549949,_0x2d418c=document[_0x2dcc78(0x383)](_0x2dcc78(0x43b)),_0x4b5dee=document['getElementById'](_0x2dcc78(0x13e)),_0x297258=document[_0x2dcc78(0x383)]('update-notice-confirm-btn'),_0x1e137d=document[_0x2dcc78(0x383)]('update-notice-dismiss-btn');_0x4b5dee[_0x2dcc78(0x45c)]=_0x3d5d41,_0x297258[_0x2dcc78(0xc50)]=()=>{const _0x236441=_0x2dcc78;_0x2d418c['classList'][_0x236441(0x131d)](_0x236441(0x106d));},_0x1e137d[_0x2dcc78(0xc50)]=()=>{const _0xac2ad2=_0x2dcc78;localStorage[_0xac2ad2(0x16a)]('dismissedUpdateVersion',_0x2e99df),_0x2d418c['classList'][_0xac2ad2(0x131d)](_0xac2ad2(0x106d)),console[_0xac2ad2(0xe72)](_0xac2ad2(0x131c)+_0x2e99df);},_0x2d418c[_0x2dcc78(0x119a)][_0x2dcc78(0xbff)](_0x2dcc78(0x106d));}function _0xb07250(){const _0xbce216=_0x549949,_0x2db552=document['getElementById'](_0xbce216(0x32b));document[_0xbce216(0x383)](_0xbce216(0x3f5))[_0xbce216(0x1be)]=_0x41df36[_0xbce216(0xc0)]['doubanMinPosts']||0xc,document[_0xbce216(0x383)](_0xbce216(0x1d5))[_0xbce216(0x1be)]=_0x41df36[_0xbce216(0xc0)]['doubanMaxPosts']||0x14,_0x2db552[_0xbce216(0x119a)][_0xbce216(0xbff)](_0xbce216(0x106d));}async function _0x70c77(){const _0x91c363=_0x549949,_0x1778f4=document['getElementById']('douban-min-posts-input'),_0x58ac7a=document['getElementById'](_0x91c363(0x1d5)),_0x42f703=parseInt(_0x1778f4[_0x91c363(0x1be)]),_0x12dac5=parseInt(_0x58ac7a[_0x91c363(0x1be)]);if(isNaN(_0x42f703)||isNaN(_0x12dac5)||_0x42f703<0x1||_0x12dac5<0x1){alert('请输入有效的正整数！');return;}if(_0x42f703>_0x12dac5){alert(_0x91c363(0x22b));return;}_0x41df36[_0x91c363(0xc0)][_0x91c363(0x1362)]=_0x42f703,_0x41df36[_0x91c363(0xc0)]['doubanMaxPosts']=_0x12dac5,await _0x342df8['globalSettings'][_0x91c363(0x9c0)](_0x41df36['globalSettings']),document[_0x91c363(0x383)](_0x91c363(0x32b))[_0x91c363(0x119a)][_0x91c363(0x131d)]('visible'),await _0x296ef9(_0x91c363(0x1319),_0x91c363(0xe52));}async function _0x135780(_0x1e2495){const _0xf22d2b=_0x549949,_0x2acc93=document[_0xf22d2b(0x383)](_0xf22d2b(0xd31)),_0x59f356=document[_0xf22d2b(0x383)](_0xf22d2b(0x106b));_0x59f356[_0xf22d2b(0x45c)]='';let _0x137993=[];if(_0x1e2495==='global'){const _0x5f3d8a=Object[_0xf22d2b(0x76d)](_0x41df36[_0xf22d2b(0x864)])[_0xf22d2b(0x98a)](_0x4a45bd=>!_0x4a45bd[_0xf22d2b(0x1a2)]),_0xe0e5f6=await _0x342df8[_0xf22d2b(0x656)]['toArray']();_0x137993=[{'id':_0xf22d2b(0x66e),'name':_0x41df36[_0xf22d2b(0x571)][_0xf22d2b(0xabb)]||'我','originalName':_0x41df36[_0xf22d2b(0x571)]['nickname']||'我','avatar':_0x41df36['qzoneSettings'][_0xf22d2b(0xb47)],'type':_0xf22d2b(0x66e)},..._0x5f3d8a[_0xf22d2b(0xa79)](_0x57aea1=>({'id':_0x57aea1['id'],'name':_0x57aea1[_0xf22d2b(0x461)],'originalName':_0x57aea1[_0xf22d2b(0x283)],'avatar':_0x57aea1['settings']['aiAvatar'],'type':_0xf22d2b(0xa0)})),..._0xe0e5f6[_0xf22d2b(0xa79)](_0x4c080f=>({'id':'npc_'+_0x4c080f['id'],'name':_0x4c080f[_0xf22d2b(0x461)],'originalName':_0x4c080f[_0xf22d2b(0x461)],'avatar':_0x4c080f[_0xf22d2b(0xb47)],'type':_0xf22d2b(0xa03)}))],_0x22cd06[_0xf22d2b(0xa65)]=null;}else{const _0x37aaa5=_0x41df36['chats'][_0x41df36['activeChatId']];if(!_0x37aaa5||!_0x37aaa5[_0xf22d2b(0x1a2)])return;_0x137993=[{'id':'user','name':_0x37aaa5['settings']['myNickname']||'我','originalName':_0x41df36[_0xf22d2b(0x571)][_0xf22d2b(0xabb)]||'我','avatar':_0x37aaa5['settings']['myAvatar'],'type':_0xf22d2b(0x66e)},..._0x37aaa5['members']['map'](_0x4c6985=>{const _0x43b74f=_0xf22d2b,_0x3e91f8=_0x41df36[_0x43b74f(0x864)][_0x4c6985['id']],_0x2d6233=_0x4c6985[_0x43b74f(0xb47)]||(_0x3e91f8?_0x3e91f8[_0x43b74f(0x886)]['aiAvatar']:_0x59100f);return{'id':_0x4c6985['id'],'name':_0x4c6985[_0x43b74f(0x9da)],'originalName':_0x4c6985[_0x43b74f(0x283)],'avatar':_0x2d6233,'type':_0x4c6985['isNpc']?_0x43b74f(0xa03):_0x43b74f(0xa0)};})],_0x22cd06[_0xf22d2b(0xa65)]=_0x41df36[_0xf22d2b(0xfc5)];}_0x137993[_0xf22d2b(0x19c)](_0x27052b=>{const _0x4b765e=_0xf22d2b,_0x48a17b=document[_0x4b765e(0xe1b)](_0x4b765e(0x7fd));_0x48a17b[_0x4b765e(0x556)]=_0x4b765e(0x136c),_0x48a17b[_0x4b765e(0x45c)]=_0x4b765e(0x109c)+JSON[_0x4b765e(0x3fb)](_0x27052b)+'\x27\x20'+(_0x27052b[_0x4b765e(0xa6b)]===_0x4b765e(0x66e)?_0x4b765e(0x321):_0x4b765e(0x2a3))+_0x4b765e(0xbc4)+_0x27052b['avatar']+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x27052b[_0x4b765e(0x461)]+_0x4b765e(0xf79),_0x59f356['appendChild'](_0x48a17b);}),_0x2acc93[_0xf22d2b(0x119a)][_0xf22d2b(0xbff)](_0xf22d2b(0x106d));}async function _0x208779(){const _0x3d0c9f=_0x549949,_0x22c005=document[_0x3d0c9f(0x400)]('.werewolf-player-checkbox:checked'),_0x324af4=_0x22c005['length'];let _0x502dbe=[];if(_0x324af4===0x6)_0x22cd06['gameMode']='6p',_0x502dbe=['狼人','狼人','平民','平民',_0x3d0c9f(0xb54),'猎人'];else{if(_0x324af4===0x9)_0x22cd06['gameMode']='9p',_0x502dbe=['狼人','狼人','狼人','平民','平民','平民',_0x3d0c9f(0xb54),'女巫','猎人'];else{if(_0x324af4===0xc)_0x22cd06[_0x3d0c9f(0x5b0)]=_0x3d0c9f(0x10cd),_0x502dbe=['狼人','狼人','狼人','狼人','平民','平民','平民','平民',_0x3d0c9f(0xb54),'女巫','猎人','守卫'];else{alert(_0x3d0c9f(0xf18)+_0x324af4+_0x3d0c9f(0xe65));return;}}}document[_0x3d0c9f(0x383)](_0x3d0c9f(0xd31))[_0x3d0c9f(0x119a)][_0x3d0c9f(0x131d)]('visible'),await _0x296ef9('正在发牌...',_0x3d0c9f(0xc72));for(let _0x5595f7=_0x502dbe['length']-0x1;_0x5595f7>0x0;_0x5595f7--){const _0x5ed959=Math[_0x3d0c9f(0xdee)](Math[_0x3d0c9f(0x5ce)]()*(_0x5595f7+0x1));[_0x502dbe[_0x5595f7],_0x502dbe[_0x5ed959]]=[_0x502dbe[_0x5ed959],_0x502dbe[_0x5595f7]];}const _0x3b0147=Array[_0x3d0c9f(0x365)](_0x22c005)[_0x3d0c9f(0xa79)](_0x539679=>JSON[_0x3d0c9f(0x134)](_0x539679['dataset'][_0x3d0c9f(0x82b)]));_0x22cd06[_0x3d0c9f(0x4f1)]=[];for(let _0x562b4f=0x0;_0x562b4f<_0x3b0147['length'];_0x562b4f++){const _0x3e2309=_0x3b0147[_0x562b4f],_0x5aa589=_0x502dbe[_0x562b4f];let _0x27ba76=_0x3d0c9f(0xd02);if(_0x3e2309['type']==='character'){const _0x233966=_0x41df36['chats'][_0x3e2309['id']];_0x27ba76=_0x233966?_0x233966[_0x3d0c9f(0x886)][_0x3d0c9f(0xd83)]:_0x3d0c9f(0x8ab);}else{if(_0x3e2309[_0x3d0c9f(0xa6b)]===_0x3d0c9f(0xa03)){const _0x2a8551=await _0x342df8[_0x3d0c9f(0x656)]['toArray'](),_0x404e17=_0x2a8551[_0x3d0c9f(0xd12)](_0x260085=>_0x3d0c9f(0x1244)+_0x260085['id']===_0x3e2309['id']);_0x27ba76=_0x404e17?_0x404e17['persona']:_0x3d0c9f(0x11eb);}else{if(_0x3e2309[_0x3d0c9f(0xa6b)]===_0x3d0c9f(0x66e)){const _0x1712d5=_0x22cd06[_0x3d0c9f(0xa65)]?_0x41df36['chats'][_0x22cd06[_0x3d0c9f(0xa65)]]:null;_0x27ba76=_0x1712d5?_0x1712d5[_0x3d0c9f(0x886)][_0x3d0c9f(0xe63)]:_0x3d0c9f(0xea2);}}}const _0x5b8137={..._0x3e2309,'role':_0x5aa589,'isAlive':!![],'character_persona':_0x27ba76};_0x5aa589==='女巫'&&(_0x5b8137['antidoteUsed']=![],_0x5b8137[_0x3d0c9f(0xeb6)]=![]),_0x5aa589==='守卫'&&(_0x5b8137[_0x3d0c9f(0x411)]=null),_0x22cd06[_0x3d0c9f(0x4f1)]['push'](_0x5b8137);}_0x22cd06[_0x3d0c9f(0x40d)]=!![],_0x22cd06[_0x3d0c9f(0xc77)]=0x1,_0x22cd06[_0x3d0c9f(0xb17)]=_0x3d0c9f(0x1b3),_0x22cd06[_0x3d0c9f(0x126a)]=[],_0x22cd06[_0x3d0c9f(0xe96)]=[];const _0x455f31=_0x502dbe['reduce']((_0x34942b,_0x4f01ac)=>{return _0x34942b[_0x4f01ac]=(_0x34942b[_0x4f01ac]||0x0)+0x1,_0x34942b;},{}),_0x3c39c2=Object[_0x3d0c9f(0x329)](_0x455f31)['map'](([_0x65d8c6,_0x3e86f9])=>_0x65d8c6+'\x20x'+_0x3e86f9)['join']('、');_0x341c48(_0x3d0c9f(0x1251)+_0x324af4+_0x3d0c9f(0x135f)+_0x3c39c2+'。');const _0xc1dfd9=_0x22cd06[_0x3d0c9f(0x4f1)]['find'](_0x13a46d=>_0x13a46d['id']===_0x3d0c9f(0x66e));_0x594dc5(),_0x105acd(_0x3d0c9f(0x2f7)),_0x185e8e(_0xc1dfd9[_0x3d0c9f(0x10ff)]);}function _0x594dc5(){const _0x50d807=_0x549949,_0x1596d6=document[_0x50d807(0x383)](_0x50d807(0xa93));_0x1596d6[_0x50d807(0x45c)]='';const _0x4d718d=[..._0x22cd06[_0x50d807(0x4f1)]][_0x50d807(0x1296)]((_0x1bf928,_0x3f47b4)=>_0x1bf928['isAlive']-_0x3f47b4['isAlive']);_0x4d718d[_0x50d807(0x19c)]((_0x232ff4,_0x1628db)=>{const _0x22785a=_0x50d807,_0x37fcf7=_0x22cd06[_0x22785a(0x4f1)][_0x22785a(0xe37)](_0x225550=>_0x225550['id']===_0x232ff4['id'])+0x1,_0x14fc68=document[_0x22785a(0xe1b)](_0x22785a(0x7fd));_0x14fc68[_0x22785a(0x556)]=_0x22785a(0x595);if(!_0x232ff4[_0x22785a(0x888)])_0x14fc68[_0x22785a(0x119a)][_0x22785a(0xbff)]('dead');_0x14fc68[_0x22785a(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x232ff4[_0x22785a(0xb47)]+_0x22785a(0x9b7)+_0x37fcf7+'.\x20'+_0x232ff4['name']+_0x22785a(0xf79),_0x1596d6[_0x22785a(0xe91)](_0x14fc68);});const _0x42a0a2=document[_0x50d807(0x383)](_0x50d807(0x84e));_0x42a0a2[_0x50d807(0x45c)]='';for(let _0x6aaeb4=0x1;_0x6aaeb4<=_0x22cd06[_0x50d807(0xc77)];_0x6aaeb4++){const _0x22cb2e=[..._0x22cd06[_0x50d807(0x126a)]['filter'](_0x5f6e8c=>_0x5f6e8c[_0x50d807(0x1143)]===_0x6aaeb4),..._0x22cd06[_0x50d807(0xe96)][_0x50d807(0x98a)](_0x134cf8=>_0x134cf8[_0x50d807(0x1143)]===_0x6aaeb4)][_0x50d807(0x1296)]((_0x5035a3,_0xf9adfa)=>(_0x5035a3[_0x50d807(0x3b7)]||0x0)-(_0xf9adfa[_0x50d807(0x3b7)]||0x0));if(_0x22cb2e[_0x50d807(0xfde)]>0x0){const _0x83645=document[_0x50d807(0xe1b)](_0x50d807(0x7fd));_0x83645[_0x50d807(0x556)]='werewolf-log-entry\x20system',_0x83645[_0x50d807(0x138e)]=_0x50d807(0x10b2)+_0x6aaeb4+_0x50d807(0x6e4),_0x83645[_0x50d807(0x655)]['cssText']='font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);',_0x42a0a2[_0x50d807(0xe91)](_0x83645),_0x22cb2e[_0x50d807(0x19c)](_0x21805f=>{const _0x4c96ea=_0x50d807,_0x26b67f=document[_0x4c96ea(0xe1b)](_0x4c96ea(0x7fd));_0x26b67f[_0x4c96ea(0x556)]=_0x4c96ea(0xdba)+_0x21805f[_0x4c96ea(0xa6b)],_0x21805f[_0x4c96ea(0xa6b)]===_0x4c96ea(0x5ed)?_0x26b67f[_0x4c96ea(0x45c)]='<span\x20class=\x22speaker\x22>'+_0x21805f['speaker']+_0x4c96ea(0x114c)+_0x21805f[_0x4c96ea(0x11b6)]:_0x26b67f[_0x4c96ea(0x138e)]=_0x21805f[_0x4c96ea(0x11b6)],_0x42a0a2[_0x4c96ea(0xe91)](_0x26b67f);});}}_0x42a0a2[_0x50d807(0x4f9)]=_0x42a0a2[_0x50d807(0x36d)];const _0x4bfa5c={'start':_0x50d807(0x101f),'night':'第'+_0x22cd06[_0x50d807(0xc77)]+_0x50d807(0x83c),'day':'第'+_0x22cd06[_0x50d807(0xc77)]+'天\x20-\x20白天','discussion':'第'+_0x22cd06['currentDay']+_0x50d807(0xb64),'voting':'第'+_0x22cd06[_0x50d807(0xc77)]+_0x50d807(0x1146),'gameover':_0x50d807(0x7e1)};document[_0x50d807(0x383)](_0x50d807(0x723))[_0x50d807(0x138e)]='狼人杀\x20-\x20'+(_0x4bfa5c[_0x22cd06[_0x50d807(0xb17)]]||_0x22cd06[_0x50d807(0xb17)]);}function _0x185e8e(_0xbe7045){const _0x2f38ac=_0x549949,_0x1f2873={'狼人':_0x2f38ac(0x1305),'平民':'你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','预言家':_0x2f38ac(0xdb5),'猎人':_0x2f38ac(0x11ab),'女巫':_0x2f38ac(0x1347),'守卫':_0x2f38ac(0x295)};document[_0x2f38ac(0x383)]('werewolf-role-name')['textContent']=_0xbe7045,document[_0x2f38ac(0x383)]('werewolf-role-description')[_0x2f38ac(0x138e)]=_0x1f2873[_0xbe7045]||'一个神秘的角色。',document[_0x2f38ac(0x383)](_0x2f38ac(0x5b6))[_0x2f38ac(0x119a)][_0x2f38ac(0xbff)]('visible');}async function _0x35fb5b(){const _0x4f0733=_0x549949;_0x22cd06[_0x4f0733(0xb17)]='第'+_0x22cd06['currentDay']+_0x4f0733(0x83c),_0x22cd06['nightActions']={},_0x341c48(_0x4f0733(0x808)),_0x594dc5(),document[_0x4f0733(0x383)](_0x4f0733(0xb70))[_0x4f0733(0x655)][_0x4f0733(0x2b6)]='none',document[_0x4f0733(0x383)](_0x4f0733(0x1298))[_0x4f0733(0x655)]['display']=_0x4f0733(0xa70),await new Promise(_0x1ce6bc=>setTimeout(_0x1ce6bc,0x5dc));const _0x12da7b=_0x22cd06[_0x4f0733(0x4f1)][_0x4f0733(0xd12)](_0x4d3902=>_0x4d3902[_0x4f0733(0x10ff)]==='守卫'&&_0x4d3902[_0x4f0733(0x888)]);if(_0x12da7b){_0x341c48('守卫请睁眼，请选择要守护的玩家。'),_0x594dc5();let _0xc66976=null;if(_0x12da7b['id']===_0x4f0733(0x66e))_0xc66976=await _0x3d1de4(_0x4f0733(0x7ff),_0x12da7b[_0x4f0733(0x411)]);else{const _0x398848=_0x22cd06[_0x4f0733(0x4f1)][_0x4f0733(0x98a)](_0x4abe6d=>_0x4abe6d[_0x4f0733(0x888)]&&_0x4abe6d['id']!==_0x12da7b[_0x4f0733(0x411)]);_0x398848['length']>0x0&&(_0xc66976=_0x398848[Math[_0x4f0733(0xdee)](Math[_0x4f0733(0x5ce)]()*_0x398848[_0x4f0733(0xfde)])]['id']);}_0xc66976&&(_0x22cd06['nightActions'][_0x4f0733(0xf10)]=_0xc66976,_0x12da7b['lastGuardedId']=_0xc66976),_0x341c48(_0x4f0733(0xb36)),_0x594dc5(),await new Promise(_0x5a7846=>setTimeout(_0x5a7846,0x5dc));}_0x341c48(_0x4f0733(0x123)),_0x594dc5();const _0x59dd27=_0x22cd06[_0x4f0733(0x4f1)]['filter'](_0x10dbae=>_0x10dbae[_0x4f0733(0x10ff)]==='狼人'&&_0x10dbae[_0x4f0733(0x888)]),_0x51804f=_0x59dd27[_0x4f0733(0x12fb)](_0x517cab=>_0x517cab['id']===_0x4f0733(0x66e));let _0x332d56=null;_0x22cd06[_0x4f0733(0xa75)]=_0x4f0733(0xfdc);try{if(_0x51804f)_0x341c48('你是狼人，请选择刀人目标。'),_0x594dc5(),_0x332d56=await _0x450f91();else{if(_0x22cd06[_0x4f0733(0xc77)]===0x1){console['log'](_0x4f0733(0xfd));const _0x222882=_0x22cd06['players'][_0x4f0733(0x98a)](_0x4c4107=>_0x4c4107['isAlive']&&_0x4c4107[_0x4f0733(0x10ff)]!=='狼人');_0x222882['length']>0x0&&(_0x332d56=_0x222882[Math['floor'](Math[_0x4f0733(0x5ce)]()*_0x222882['length'])]['id']);}else _0x332d56=await _0x505d13();}_0x22cd06[_0x4f0733(0xa75)]=null;}catch(_0x41ded5){console['error'](_0x4f0733(0x1378),_0x41ded5),await _0x296ef9(_0x4f0733(0xa55),'AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。'),document[_0x4f0733(0x383)](_0x4f0733(0x1298))[_0x4f0733(0x655)][_0x4f0733(0x2b6)]=_0x4f0733(0x27a);return;}_0x22cd06['nightActions'][_0x4f0733(0x513)]=_0x332d56,_0x341c48(_0x4f0733(0x50d)),_0x594dc5(),await new Promise(_0x109115=>setTimeout(_0x109115,0x5dc));const _0x4eda18=_0x22cd06[_0x4f0733(0x4f1)][_0x4f0733(0xd12)](_0x4258c7=>_0x4258c7[_0x4f0733(0x10ff)]==='女巫'&&_0x4258c7[_0x4f0733(0x888)]);if(_0x4eda18){_0x341c48(_0x4f0733(0x4af)),_0x594dc5();const _0x2a7563=_0x22cd06[_0x4f0733(0x4f1)][_0x4f0733(0xd12)](_0x585349=>_0x585349['id']===_0x22cd06[_0x4f0733(0x114b)][_0x4f0733(0x513)]),_0x461798=_0x22cd06['nightActions']['guardedId']===_0x22cd06[_0x4f0733(0x114b)][_0x4f0733(0x513)],_0x11fc45=_0x461798||!_0x2a7563?null:_0x2a7563;if(_0x4eda18['id']===_0x4f0733(0x66e)){let _0x5c1eb6=await _0x3901ec(_0x11fc45,_0x4eda18);_0x5c1eb6[_0x4f0733(0x8e5)]&&(_0x22cd06[_0x4f0733(0x114b)][_0x4f0733(0xbe1)]=_0x22cd06[_0x4f0733(0x114b)][_0x4f0733(0x513)],_0x4eda18[_0x4f0733(0xc8f)]=!![]),_0x5c1eb6[_0x4f0733(0x4a3)]&&(_0x22cd06['nightActions'][_0x4f0733(0xa6c)]=_0x5c1eb6[_0x4f0733(0x4a3)],_0x4eda18['poisonUsed']=!![]);}else{if(!_0x4eda18[_0x4f0733(0xc8f)]&&_0x11fc45){let _0x357593=0x0;_0x22cd06[_0x4f0733(0xc77)]===0x1?_0x357593=0.3:_0x357593=0.8,console[_0x4f0733(0xe72)](_0x4f0733(0x889)+_0x22cd06[_0x4f0733(0xc77)]+_0x4f0733(0xff7)+_0x357593*0x64+'%'),Math[_0x4f0733(0x5ce)]()<_0x357593?(console['log'](_0x4f0733(0x562)),_0x22cd06[_0x4f0733(0x114b)][_0x4f0733(0xbe1)]=_0x22cd06[_0x4f0733(0x114b)][_0x4f0733(0x513)],_0x4eda18[_0x4f0733(0xc8f)]=!![]):console[_0x4f0733(0xe72)](_0x4f0733(0x7e5));}if(!_0x22cd06[_0x4f0733(0x114b)][_0x4f0733(0xbe1)]&&!_0x4eda18[_0x4f0733(0xeb6)]&&Math[_0x4f0733(0x5ce)]()<0.5){const _0x54f58d=_0x22cd06[_0x4f0733(0x4f1)][_0x4f0733(0x98a)](_0x535ee2=>_0x535ee2[_0x4f0733(0x888)]&&_0x535ee2['id']!==_0x22cd06[_0x4f0733(0x114b)][_0x4f0733(0x513)]);if(_0x54f58d[_0x4f0733(0xfde)]>0x0){const _0x127f48=_0x54f58d[Math[_0x4f0733(0xdee)](Math['random']()*_0x54f58d[_0x4f0733(0xfde)])];_0x22cd06[_0x4f0733(0x114b)][_0x4f0733(0xa6c)]=_0x127f48['id'],_0x4eda18['poisonUsed']=!![],console[_0x4f0733(0xe72)](_0x4f0733(0x4be)+_0x127f48[_0x4f0733(0x461)]);}}}_0x341c48(_0x4f0733(0x42a)),_0x594dc5(),await new Promise(_0x314d67=>setTimeout(_0x314d67,0x5dc));}const _0x418468=_0x22cd06[_0x4f0733(0x4f1)][_0x4f0733(0xd12)](_0x10a6fe=>_0x10a6fe['role']===_0x4f0733(0xb54)&&_0x10a6fe[_0x4f0733(0x888)]);if(_0x418468){_0x341c48('预言家请睁眼，请选择要查验的玩家。'),_0x594dc5();if(_0x418468['id']===_0x4f0733(0x66e)){const _0x34c67f=await _0x3d1de4('prophet'),_0xb3da50=_0x22cd06[_0x4f0733(0x4f1)][_0x4f0733(0xd12)](_0x20efaf=>_0x20efaf['id']===_0x34c67f);if(_0xb3da50){const _0x5b5e11=_0xb3da50[_0x4f0733(0x10ff)]==='狼人';await _0x296ef9(_0x4f0733(0x11d8),_0x4f0733(0x867)+_0xb3da50[_0x4f0733(0x461)]+'\x20的身份是：'+(_0x5b5e11?'狼人':'好人')),_0x22cd06['nightActions']['prophetCheck']={'target':_0x34c67f,'result':_0x5b5e11?'狼人':'好人'};}}else{const _0x50e92b=_0x22cd06[_0x4f0733(0x4f1)][_0x4f0733(0x98a)](_0x28b229=>_0x28b229[_0x4f0733(0x888)]&&_0x28b229['id']!==_0x418468['id']);if(_0x50e92b[_0x4f0733(0xfde)]>0x0){const _0x359b03=_0x50e92b[Math[_0x4f0733(0xdee)](Math[_0x4f0733(0x5ce)]()*_0x50e92b[_0x4f0733(0xfde)])];_0x22cd06[_0x4f0733(0x114b)]['prophetCheck']={'target':_0x359b03['id'],'result':_0x359b03[_0x4f0733(0x10ff)]==='狼人'?'狼人':'好人'};}}_0x341c48('预言家已行动，预言家请闭眼。'),_0x594dc5(),await new Promise(_0x3118ab=>setTimeout(_0x3118ab,0x5dc));}_0x4f2d2c();}async function _0x4f2d2c(){const _0x416d97=_0x549949;_0x22cd06[_0x416d97(0xb17)]='第'+_0x22cd06[_0x416d97(0xc77)]+_0x416d97(0x2c9),_0x22cd06['voteResults']={},_0x341c48(_0x416d97(0x2df));const {killedId:_0x618f5c,guardedId:_0x540526,savedId:_0x254faa,poisonedId:_0x3b33ac}=_0x22cd06['nightActions'],_0x19dc48=new Set();_0x618f5c&&_0x618f5c!==_0x540526&&_0x618f5c!==_0x254faa&&_0x19dc48[_0x416d97(0xbff)](_0x618f5c);_0x3b33ac&&_0x19dc48[_0x416d97(0xbff)](_0x3b33ac);if(_0x19dc48[_0x416d97(0x1240)]===0x0)_0x341c48('昨晚是平安夜。');else for(const _0x51bd5e of _0x19dc48){const _0x1a8c20=_0x22cd06[_0x416d97(0x4f1)]['find'](_0x39d94f=>_0x39d94f['id']===_0x51bd5e);if(_0x1a8c20&&_0x1a8c20[_0x416d97(0x888)]){_0x1a8c20[_0x416d97(0x888)]=![],_0x341c48('昨晚\x20'+_0x1a8c20[_0x416d97(0x461)]+_0x416d97(0xee9));if(_0x1a8c20[_0x416d97(0x10ff)]==='猎人'){_0x341c48(_0x416d97(0xdbe)),_0x594dc5();let _0x469a18=null;if(_0x1a8c20['id']===_0x416d97(0x66e))_0x469a18=await _0x3d1de4(_0x416d97(0xc65));else{const _0x51b7d6=_0x22cd06['players'][_0x416d97(0x98a)](_0x945308=>_0x945308[_0x416d97(0x888)]&&_0x945308['id']!==_0x1a8c20['id']);_0x51b7d6['length']>0x0&&(_0x469a18=_0x51b7d6[Math[_0x416d97(0xdee)](Math[_0x416d97(0x5ce)]()*_0x51b7d6[_0x416d97(0xfde)])]['id']);}const _0x145dee=_0x22cd06[_0x416d97(0x4f1)]['find'](_0x4c037b=>_0x4c037b['id']===_0x469a18);_0x145dee&&(_0x145dee['isAlive']=![],_0x341c48(_0x416d97(0x181)+_0x145dee[_0x416d97(0x461)]+'。'));}}}_0x594dc5();if(_0x4db8c9())return;await _0x3058fe();}async function _0x3058fe(){const _0x5ac323=_0x549949;_0x341c48(_0x5ac323(0x1e7)),_0x594dc5();const {proxyUrl:_0x1eaa37,apiKey:_0x135b6d,model:_0xddc14d}=_0x41df36['apiConfig'];if(!_0x1eaa37||!_0x135b6d||!_0xddc14d){alert(_0x5ac323(0xc6d));return;}const _0x19e92e=_0x2acc09();_0x22cd06[_0x5ac323(0xa75)]=_0x5ac323(0xde);try{await _0x296ef9('请稍候','正在等待AI角色们进行激烈的讨论...');let _0x337b74=_0x1eaa37[_0x5ac323(0xee2)](_0x5ac323(0xdc3)),_0xf070c=[{'role':_0x5ac323(0x66e),'content':_0x5ac323(0x758)}],_0x2f099c=_0x112768(_0xddc14d,_0x135b6d,_0x19e92e,_0xf070c);const _0x226096=_0x337b74?await fetch(_0x2f099c[_0x5ac323(0x2fa)],_0x2f099c[_0x5ac323(0x8c6)]):await fetch(_0x1eaa37+_0x5ac323(0x126b),{'method':'POST','headers':{'Content-Type':_0x5ac323(0x11f0),'Authorization':_0x5ac323(0xd55)+_0x135b6d},'body':JSON[_0x5ac323(0x3fb)]({'model':_0xddc14d,'messages':[{'role':_0x5ac323(0xb1),'content':_0x19e92e},..._0xf070c],'temperature':_0x41df36['globalSettings'][_0x5ac323(0xa4a)]||0.95})});if(!_0x226096['ok']){const _0x204684=await _0x226096[_0x5ac323(0x9b3)]();throw new Error(_0x5ac323(0x85a)+_0x204684[_0x5ac323(0x98)]['message']);}const _0x2e1a77=await _0x226096['json'](),_0x588798=getGeminiResponseText(_0x2e1a77),_0x7c2577=_0x588798['match'](/(\[[\s\S]*\])/);if(!_0x7c2577)throw new Error(_0x5ac323(0xdd)+_0x588798);const _0x2046f8=JSON['parse'](_0x7c2577[0x0]);for(const _0x445894 of _0x2046f8){_0x445894[_0x5ac323(0xe0b)]&&_0x445894[_0x5ac323(0x5ed)]&&(_0x3c5804(_0x445894[_0x5ac323(0xe0b)],_0x445894[_0x5ac323(0x5ed)]),_0x594dc5(),await new Promise(_0xb02767=>setTimeout(_0xb02767,0x5dc+Math[_0x5ac323(0x5ce)]()*0x7d0)));}_0x22cd06[_0x5ac323(0xa75)]=null;}catch(_0x4a017c){console['error'](_0x5ac323(0x967),_0x4a017c),await _0x296ef9(_0x5ac323(0xe39),_0x5ac323(0x1018)+_0x4a017c[_0x5ac323(0x5f8)]),document[_0x5ac323(0x383)](_0x5ac323(0x1298))[_0x5ac323(0x655)]['display']='block';return;}const _0x2197cb=_0x22cd06[_0x5ac323(0x4f1)][_0x5ac323(0xd12)](_0x59eb1b=>_0x59eb1b['id']===_0x5ac323(0x66e)),_0x2efcf6=document[_0x5ac323(0x383)](_0x5ac323(0xb70)),_0x5915e8=document[_0x5ac323(0x383)](_0x5ac323(0xa21)),_0x51b98f=document[_0x5ac323(0x383)]('werewolf-finish-speech-btn'),_0x782403=document[_0x5ac323(0x383)](_0x5ac323(0xd68));_0x2efcf6[_0x5ac323(0x655)][_0x5ac323(0x2b6)]=_0x5ac323(0x2aa);if(_0x2197cb&&_0x2197cb[_0x5ac323(0x888)]){_0x5915e8[_0x5ac323(0x138e)]=_0x5ac323(0x1e4),_0x51b98f['textContent']='结束发言',_0x5915e8[_0x5ac323(0x655)][_0x5ac323(0x2b6)]='block',_0x51b98f[_0x5ac323(0x655)][_0x5ac323(0x2b6)]=_0x5ac323(0x27a),_0x782403[_0x5ac323(0x29b)]=![],_0x782403[_0x5ac323(0xda9)]=_0x5ac323(0xaa4),_0x782403[_0x5ac323(0xede)]();const _0x229764=_0x5915e8[_0x5ac323(0x117b)](!![]);_0x5915e8[_0x5ac323(0x1245)][_0x5ac323(0xe58)](_0x229764,_0x5915e8),_0x229764[_0x5ac323(0x271)](_0x5ac323(0x5c7),_0x4d801d);const _0x3a04b0=_0x51b98f[_0x5ac323(0x117b)](!![]);_0x51b98f[_0x5ac323(0x1245)]['replaceChild'](_0x3a04b0,_0x51b98f),_0x3a04b0[_0x5ac323(0x271)](_0x5ac323(0x5c7),_0x54af07);}else{_0x341c48(_0x5ac323(0x1193)),_0x594dc5(),_0x5915e8[_0x5ac323(0x138e)]='继续讨论',_0x51b98f[_0x5ac323(0x138e)]=_0x5ac323(0x1057),_0x5915e8['style'][_0x5ac323(0x2b6)]='block',_0x51b98f['style']['display']=_0x5ac323(0x27a),_0x782403[_0x5ac323(0x29b)]=!![],_0x782403[_0x5ac323(0xda9)]=_0x5ac323(0x89b);const _0x313ba4=_0x5915e8[_0x5ac323(0x117b)](!![]);_0x5915e8[_0x5ac323(0x1245)][_0x5ac323(0xe58)](_0x313ba4,_0x5915e8),_0x313ba4[_0x5ac323(0x271)](_0x5ac323(0x5c7),_0x3c3057);const _0x27caea=_0x51b98f[_0x5ac323(0x117b)](!![]);_0x51b98f[_0x5ac323(0x1245)][_0x5ac323(0xe58)](_0x27caea,_0x51b98f),_0x27caea['addEventListener'](_0x5ac323(0x5c7),_0xef30b9);}}function _0x2acc09(){const _0x196cc0=_0x549949,_0x37b453=_0x22cd06[_0x196cc0(0x4f1)]['filter'](_0x27a320=>_0x27a320[_0x196cc0(0x888)]),_0x491c2c=_0x22cd06[_0x196cc0(0x4f1)]['find'](_0x2ecd67=>_0x2ecd67['id']===_0x196cc0(0x66e)),_0x25cb9b=_0x491c2c?_0x491c2c[_0x196cc0(0x461)]:'用户',_0x121ae7=_0x37b453[_0x196cc0(0x12fb)](_0x1809cd=>_0x1809cd['id']===_0x196cc0(0x66e));let _0x192b64=_0x196cc0(0x13a3);_0x37b453['forEach']((_0x4f763c,_0x4de6ca)=>{const _0x390934=_0x196cc0,_0x3ba24b=_0x22cd06['players'][_0x390934(0xe37)](_0x191d8c=>_0x191d8c['id']===_0x4f763c['id'])+0x1;let _0x39ae90='';const _0x70f1c3=_0x41df36[_0x390934(0x864)][_0x4f763c['id']];if(_0x70f1c3){const _0x4bf2dd=_0x37b453[_0x390934(0x98a)](_0x4836c0=>_0x4836c0['id']!==_0x4f763c['id']&&_0x41df36[_0x390934(0x864)][_0x4836c0['id']]&&_0x41df36[_0x390934(0x864)][_0x4836c0['id']][_0x390934(0x11a6)]===_0x70f1c3['groupId']&&_0x70f1c3[_0x390934(0x11a6)]!==null)[_0x390934(0xa79)](_0x395da4=>_0x395da4['name'])['join']('、');_0x4bf2dd&&(_0x39ae90+=_0x390934(0x1118)+_0x4bf2dd+_0x390934(0xdd6));}_0x4f763c['id']!==_0x390934(0x66e)&&(_0x39ae90+=_0x390934(0xe93)+_0x25cb9b+')的关系请参考你的人设、长期记忆和最近的对话。\x0a');_0x192b64+=_0x390934(0x606)+_0x3ba24b+_0x390934(0xaa8)+_0x4f763c['name']+_0x390934(0x8e)+_0x4f763c[_0x390934(0x283)]+_0x390934(0xdd8)+(_0x4f763c['id']==='user'?_0x390934(0x1207):_0x390934(0x586))+'\x0a-\x20**人设\x20(必须严格遵守)**:\x20'+_0x4f763c['character_persona']+'\x0a';if(_0x4f763c['type']===_0x390934(0xa0)){const _0x45dd38=_0x41df36['chats'][_0x4f763c['id']];if(_0x45dd38&&_0x45dd38[_0x390934(0x1349)]&&_0x45dd38[_0x390934(0x1349)][_0x390934(0xfde)]>0x0){const _0x1d54ce=_0x45dd38[_0x390934(0x1349)][_0x390934(0xa79)](_0x17a270=>_0x17a270[_0x390934(0x11b6)])['join'](';\x20');_0x192b64+=_0x390934(0xa90)+_0x1d54ce+'\x0a';}}});let _0x431eba=_0x196cc0(0x641);const _0x2386da=_0x22cd06[_0x196cc0(0x126a)][_0x196cc0(0x98a)](_0x3be622=>_0x3be622[_0x196cc0(0x11b6)]['includes'](_0x196cc0(0xbc))&&_0x3be622['day']===_0x22cd06[_0x196cc0(0xc77)]);_0x2386da[_0x196cc0(0xfde)]===0x0?_0x431eba+=_0x196cc0(0xc2a):_0x2386da[_0x196cc0(0x19c)](_0x4e8362=>{const _0x2714fa=_0x196cc0;_0x431eba+='-\x20'+_0x4e8362[_0x2714fa(0x11b6)]+'\x0a';});let _0x2b35b8=_0x196cc0(0x682);if(_0x22cd06[_0x196cc0(0xc77)]>0x1)for(let _0x4d8b3a=0x1;_0x4d8b3a<_0x22cd06['currentDay'];_0x4d8b3a++){_0x2b35b8+=_0x196cc0(0x5f3)+_0x4d8b3a+'\x20天\x20---**\x0a';const _0x25b7dc=_0x22cd06[_0x196cc0(0x126a)][_0x196cc0(0x98a)](_0x28873f=>_0x28873f[_0x196cc0(0x1143)]===_0x4d8b3a&&(_0x28873f[_0x196cc0(0x11b6)]['includes']('死亡')||_0x28873f[_0x196cc0(0x11b6)][_0x196cc0(0xee2)]('放逐')));_0x25b7dc[_0x196cc0(0xfde)]>0x0?_0x2b35b8+=_0x196cc0(0xa7a)+_0x25b7dc[_0x196cc0(0xa79)](_0x4c173d=>_0x4c173d[_0x196cc0(0x11b6)])[_0x196cc0(0xa35)]('\x20')+'\x0a':_0x2b35b8+=_0x196cc0(0xfec);const _0x289fc0=_0x22cd06[_0x196cc0(0xe96)][_0x196cc0(0x98a)](_0x50500a=>_0x50500a[_0x196cc0(0x1143)]===_0x4d8b3a);_0x289fc0['length']>0x0&&(_0x2b35b8+=_0x196cc0(0x1e1)+_0x289fc0[_0x196cc0(0xa79)](_0x283453=>'-\x20'+_0x283453[_0x196cc0(0xe1c)]+':\x20'+_0x283453[_0x196cc0(0x11b6)])['join']('\x0a')+'\x0a');}else _0x2b35b8+=_0x196cc0(0xb75);let _0x229bbc='###\x20你的秘密信息\x20(此部分只有你作为AI导演能看到)\x0a';_0x37b453[_0x196cc0(0x19c)](_0x4bee80=>{const _0x5ef785=_0x196cc0;if(_0x4bee80['id']!=='user'){_0x229bbc+=_0x5ef785(0xd88)+_0x4bee80['name']+_0x5ef785(0x122a)+_0x4bee80[_0x5ef785(0x10ff)]+'】\x0a';if(_0x4bee80[_0x5ef785(0x10ff)]==='狼人'){const _0x2dca46=_0x22cd06[_0x5ef785(0x4f1)][_0x5ef785(0x98a)](_0x50e4f6=>_0x50e4f6[_0x5ef785(0x10ff)]==='狼人'&&_0x50e4f6['id']!==_0x4bee80['id'])[_0x5ef785(0xa79)](_0x2a2d72=>_0x2a2d72[_0x5ef785(0x461)])[_0x5ef785(0xa35)]('、');_0x229bbc+=_0x5ef785(0x11ee)+(_0x2dca46||'无')+'\x0a';const _0x32264e=_0x22cd06[_0x5ef785(0x4f1)]['find'](_0x19f636=>_0x19f636['id']===_0x22cd06[_0x5ef785(0x114b)][_0x5ef785(0x513)]);_0x229bbc+='-\x20你们昨晚尝试攻击的玩家是：'+(_0x32264e?_0x32264e[_0x5ef785(0x461)]:'空刀')+'\x0a';}if(_0x4bee80[_0x5ef785(0x10ff)]===_0x5ef785(0xb54)&&_0x22cd06[_0x5ef785(0x114b)][_0x5ef785(0x134e)]){const _0x82ce59=_0x22cd06['players'][_0x5ef785(0xd12)](_0x10f21f=>_0x10f21f['id']===_0x22cd06[_0x5ef785(0x114b)][_0x5ef785(0x134e)]['target']);_0x229bbc+='-\x20你昨晚查验了\x20'+_0x82ce59['name']+'，TA的身份是：【'+_0x22cd06[_0x5ef785(0x114b)][_0x5ef785(0x134e)][_0x5ef785(0xa86)]+'】\x0a';}if(_0x4bee80[_0x5ef785(0x10ff)]==='女巫'){if(_0x22cd06['nightActions'][_0x5ef785(0xbe1)]){const _0x41ed00=_0x22cd06[_0x5ef785(0x4f1)]['find'](_0x155a0b=>_0x155a0b['id']===_0x22cd06[_0x5ef785(0x114b)][_0x5ef785(0xbe1)]);_0x229bbc+=_0x5ef785(0x237)+_0x41ed00['name']+'。\x0a';}if(_0x22cd06[_0x5ef785(0x114b)][_0x5ef785(0xa6c)]){const _0x1a5492=_0x22cd06['players']['find'](_0x4c518b=>_0x4c518b['id']===_0x22cd06[_0x5ef785(0x114b)][_0x5ef785(0xa6c)]);_0x229bbc+=_0x5ef785(0x9cb)+_0x1a5492[_0x5ef785(0x461)]+'。\x0a';}_0x229bbc+='-\x20你的解药状态：'+(_0x4bee80['antidoteUsed']?'已使用':_0x5ef785(0xa98))+'\x0a',_0x229bbc+=_0x5ef785(0x11bd)+(_0x4bee80[_0x5ef785(0xeb6)]?_0x5ef785(0x77c):_0x5ef785(0xa98))+'\x0a';}if(_0x4bee80['role']==='守卫'){if(_0x22cd06[_0x5ef785(0x114b)][_0x5ef785(0xf10)]){const _0x489914=_0x22cd06['players']['find'](_0x53aa31=>_0x53aa31['id']===_0x22cd06['nightActions'][_0x5ef785(0xf10)]);_0x229bbc+='-\x20你昨晚守护了\x20'+_0x489914[_0x5ef785(0x461)]+'。\x0a';}else _0x229bbc+=_0x5ef785(0xee6);}_0x229bbc+='\x0a';}});let _0x11c912='#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a';const _0x58673b=_0x22cd06['discussionLog'][_0x196cc0(0x98a)](_0x7852ea=>_0x7852ea[_0x196cc0(0x1143)]===_0x22cd06[_0x196cc0(0xc77)]);_0x58673b[_0x196cc0(0xfde)]>0x0?_0x11c912+=_0x58673b[_0x196cc0(0xa79)](_0x495815=>'-\x20**'+_0x495815[_0x196cc0(0xe1c)]+_0x196cc0(0xf76)+_0x495815[_0x196cc0(0x11b6)])[_0x196cc0(0xa35)]('\x0a'):_0x11c912+=_0x196cc0(0x748);const _0x3ab7e2=_0x196cc0(0x5f7)+(_0x121ae7?'用户('+_0x25cb9b+')':_0x196cc0(0x561)+_0x25cb9b+')')+'以外】的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a'+_0x192b64+_0x196cc0(0xde0)+(_0x22cd06[_0x196cc0(0x5b0)]===_0x196cc0(0x10cd)?'屠边局：狼人杀死所有神职或所有平民即获胜。':_0x196cc0(0x804))+_0x196cc0(0xe06)+_0x22cd06['currentDay']+_0x196cc0(0x2fb)+_0x431eba+'\x20\x0a-\x20存活玩家:\x20'+_0x37b453[_0x196cc0(0xa79)](_0x37ac16=>_0x37ac16[_0x196cc0(0x461)]+'\x20('+(_0x37ac16['id']===_0x196cc0(0x66e)?'用户':'AI')+')')[_0x196cc0(0xa35)](',\x20')+_0x196cc0(0xf1d)+_0x25cb9b+_0x196cc0(0xb32)+_0x2b35b8+'\x0a\x0a#\x20'+_0x11c912+'\x0a\x0a'+_0x229bbc+_0x196cc0(0xacf);return _0x3ab7e2;}function _0x45988a(_0x4d6c1f){const _0x26b833=_0x549949;let _0x45a42c=_0x26b833(0x664);const _0x24f02f=_0x4d6c1f[_0x26b833(0x126a)]['find'](_0xa3f612=>_0xa3f612[_0x26b833(0x11b6)][_0x26b833(0xee2)]('胜利'))?.[_0x26b833(0x11b6)]||'胜负未分';_0x45a42c+='###\x20最终结果:\x20'+_0x24f02f+'\x0a\x0a',_0x45a42c+='###\x20玩家身份配置:\x0a',_0x4d6c1f[_0x26b833(0x4f1)]['forEach'](_0x4782c2=>{const _0x316b59=_0x26b833,_0xb08513=_0x4782c2['isAlive']?'存活':_0x316b59(0xa4);_0x45a42c+='-\x20'+_0x4782c2[_0x316b59(0x461)]+':\x20'+_0x4782c2[_0x316b59(0x10ff)]+'\x20('+_0xb08513+')\x0a';}),_0x45a42c+='\x0a###\x20详细对局流程:\x0a';for(let _0x2f9d5e=0x1;_0x2f9d5e<=_0x4d6c1f[_0x26b833(0xc77)];_0x2f9d5e++){_0x45a42c+=_0x26b833(0x5f3)+_0x2f9d5e+_0x26b833(0x872);const _0x28a0d2=_0x4d6c1f[_0x26b833(0x126a)][_0x26b833(0x98a)](_0x5af04f=>_0x5af04f[_0x26b833(0x1143)]===_0x2f9d5e&&_0x5af04f['content']['includes']('死亡'));if(_0x28a0d2[_0x26b833(0xfde)]>0x0)_0x45a42c+='**[夜晚]**\x20'+_0x28a0d2[_0x26b833(0xa79)](_0x5825e5=>_0x5825e5[_0x26b833(0x11b6)])[_0x26b833(0xa35)]('\x20')+'\x0a';else(_0x2f9d5e>0x1||_0x2f9d5e===0x1&&_0x4d6c1f[_0x26b833(0xc77)]>0x1)&&(_0x45a42c+=_0x26b833(0x107b));const _0x3d3bc0=_0x4d6c1f[_0x26b833(0xe96)]['filter'](_0x54585d=>_0x54585d[_0x26b833(0x1143)]===_0x2f9d5e);_0x3d3bc0[_0x26b833(0xfde)]>0x0&&(_0x45a42c+=_0x26b833(0x4dc)+_0x3d3bc0[_0x26b833(0xa79)](_0x288c93=>'-\x20'+_0x288c93[_0x26b833(0xe1c)]+':\x20'+_0x288c93['content'])[_0x26b833(0xa35)]('\x0a')+'\x0a');const _0x57abf4=_0x4d6c1f[_0x26b833(0x126a)][_0x26b833(0xd12)](_0x73123c=>_0x73123c[_0x26b833(0x1143)]===_0x2f9d5e&&_0x73123c['content'][_0x26b833(0xee2)](_0x26b833(0x678)));_0x57abf4&&(_0x45a42c+='**[投票结果]**\x20'+_0x57abf4[_0x26b833(0x11b6)]+'\x0a');}return _0x45a42c+='\x0a---\x20复盘结束\x20---',_0x45a42c;}async function _0x265b9c(_0x1001de){const _0x59e9f7=_0x549949;let _0x3f8152=0x0;for(const _0x322ac4 of _0x22cd06[_0x59e9f7(0x4f1)]){if(_0x322ac4[_0x59e9f7(0xa6b)]===_0x59e9f7(0xa0)){const _0x41335c=_0x41df36[_0x59e9f7(0x864)][_0x322ac4['id']];if(_0x41335c){const _0x5caba4={'content':_0x1001de,'timestamp':Date[_0x59e9f7(0x108d)](),'source':_0x59e9f7(0x992)};!_0x41335c[_0x59e9f7(0x1349)]&&(_0x41335c[_0x59e9f7(0x1349)]=[]),_0x41335c['longTermMemory'][_0x59e9f7(0x258)](_0x5caba4),await _0x342df8['chats']['put'](_0x41335c),_0x3f8152++;}}}return _0x3f8152;}async function _0x27cee3(){const _0x243018=_0x549949;if(!_0x22cd06[_0x243018(0x40d)]&&_0x22cd06[_0x243018(0xb17)]==='gameover'){await _0x296ef9(_0x243018(0x4a6),_0x243018(0xa18));try{const _0x33adac=_0x45988a(_0x22cd06),_0x2ccd46=await _0x265b9c(_0x33adac);await _0x296ef9('成功','游戏记忆已成功注入到\x20'+_0x2ccd46+_0x243018(0x348));}catch(_0x3639c8){console['error'](_0x243018(0x17c),_0x3639c8),await _0x296ef9('失败','手动注入记忆时出错:\x20'+_0x3639c8[_0x243018(0x5f8)]);}}else alert(_0x243018(0xa26));}async function _0x28edc1(_0x5cad9e){const _0x337b22=_0x549949;_0x22cd06[_0x337b22(0x40d)]=![],_0x22cd06[_0x337b22(0xb17)]='gameover',_0x341c48(_0x5cad9e+_0x337b22(0x11c2)),document[_0x337b22(0x383)]('werewolf-game-over-title')['textContent']=_0x5cad9e+_0x337b22(0x658);let _0x15820d='';_0x5cad9e==='好人'?_0x15820d='所有狼人已被放逐，好人阵营获得了胜利！':_0x15820d=_0x337b22(0x865);const _0x3daf28=document[_0x337b22(0x383)](_0x337b22(0x674));_0x3daf28['textContent']=_0x15820d;const _0x1e4de2=document[_0x337b22(0x383)](_0x337b22(0x9bb));_0x1e4de2[_0x337b22(0x45c)]='';const _0x8054e6=[..._0x22cd06[_0x337b22(0x4f1)]][_0x337b22(0x1296)]((_0x174e1c,_0x156022)=>{const _0x92630=_0x337b22,_0x274776=_0x22cd06[_0x92630(0x4f1)][_0x92630(0xe37)](_0x3e656b=>_0x3e656b['id']===_0x174e1c['id']),_0x20936d=_0x22cd06['players'][_0x92630(0xe37)](_0xea8b7a=>_0xea8b7a['id']===_0x156022['id']);return _0x274776-_0x20936d;});_0x8054e6[_0x337b22(0x19c)]((_0x5dd38f,_0x1ab3a8)=>{const _0x282829=_0x337b22,_0x5318e3=document[_0x282829(0xe1b)](_0x282829(0x7fd));_0x5318e3[_0x282829(0x655)][_0x282829(0x1ae)]='display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;';if(_0x1ab3a8===_0x8054e6['length']-0x1)_0x5318e3[_0x282829(0x655)][_0x282829(0xccb)]=_0x282829(0xa70);const _0x17fd12=_0x5dd38f[_0x282829(0x10ff)]==='狼人'?_0x282829(0xe2e):_0x282829(0x9e);_0x5318e3[_0x282829(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x5dd38f[_0x282829(0xb47)]+_0x282829(0x639)+(_0x5dd38f[_0x282829(0x888)]?'none':_0x282829(0xf4d))+';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20'+(_0x5dd38f['isAlive']?_0x282829(0xa70):_0x282829(0x649))+_0x282829(0x10b4)+(_0x1ab3a8+0x1)+'.\x20'+_0x5dd38f[_0x282829(0x461)]+_0x282829(0xfdb)+_0x17fd12+_0x282829(0x10b4)+_0x5dd38f[_0x282829(0x10ff)]+_0x282829(0xa0f),_0x1e4de2[_0x282829(0xe91)](_0x5318e3);}),document[_0x337b22(0x383)](_0x337b22(0x51a))[_0x337b22(0x119a)][_0x337b22(0xbff)](_0x337b22(0x106d));try{console[_0x337b22(0xe72)](_0x337b22(0x9e0));const _0x4bcc0d=_0x45988a(_0x22cd06),_0x2354b0=await generateAndInjectWerewolfMemories(_0x4bcc0d);console['log'](_0x337b22(0x594)+_0x2354b0+_0x337b22(0x445));}catch(_0x1e99e1){console[_0x337b22(0x98)](_0x337b22(0xdb7),_0x1e99e1),_0x3daf28&&(_0x3daf28[_0x337b22(0x45c)]+=_0x337b22(0xb94));}}function _0x341c48(_0x58bbd4){const _0x4d95f2=_0x549949;_0x22cd06[_0x4d95f2(0x126a)][_0x4d95f2(0x258)]({'type':'system','content':_0x58bbd4,'timestamp':Date[_0x4d95f2(0x108d)](),'day':_0x22cd06[_0x4d95f2(0xc77)]});}function _0x3c5804(_0x34f356,_0x1b4118){const _0x5a9542=_0x549949;_0x22cd06[_0x5a9542(0xe96)]['push']({'type':_0x5a9542(0x5ed),'speaker':_0x34f356,'content':_0x1b4118,'timestamp':Date[_0x5a9542(0x108d)](),'day':_0x22cd06[_0x5a9542(0xc77)]});}function _0x3d1de4(_0x5c7cd3){return new Promise(_0x4ab381=>{const _0x53ad17=_0x42ed,_0x347e9e=_0x53ad17(0x613)+_0x5c7cd3+_0x53ad17(0xea),_0x59e0c3='werewolf-'+_0x5c7cd3+_0x53ad17(0x246);let _0xd2cfe0='';if(_0x5c7cd3===_0x53ad17(0xe6d))_0xd2cfe0=_0x53ad17(0xc27);if(_0x5c7cd3===_0x53ad17(0xc65))_0xd2cfe0='confirm-hunter-shot-btn';if(_0x5c7cd3===_0x53ad17(0x103d))_0xd2cfe0=_0x53ad17(0x49f);const _0x5ea015=document[_0x53ad17(0x383)](_0x347e9e),_0xee7082=document[_0x53ad17(0x383)](_0x59e0c3),_0x268755=document['getElementById'](_0xd2cfe0);_0xee7082[_0x53ad17(0x45c)]='';let _0x435bb5=null;const _0x1ce113=_0x22cd06[_0x53ad17(0x4f1)][_0x53ad17(0x98a)](_0x180eb7=>_0x180eb7['isAlive']&&(_0x5c7cd3===_0x53ad17(0xc65)||_0x5c7cd3===_0x53ad17(0x103d)||_0x180eb7['id']!==_0x53ad17(0x66e)));_0x1ce113[_0x53ad17(0x19c)](_0x14e32e=>{const _0x310214=_0x53ad17,_0x40fd0e=document[_0x310214(0xe1b)](_0x310214(0x7fd));_0x40fd0e[_0x310214(0x556)]=_0x310214(0x6c1),_0x40fd0e[_0x310214(0x118)]['id']=_0x14e32e['id'],_0x40fd0e['innerHTML']=_0x310214(0xf8a)+_0x14e32e[_0x310214(0xb47)]+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0x14e32e[_0x310214(0x461)]+_0x310214(0xd74),_0x40fd0e[_0x310214(0xc50)]=()=>{const _0x493339=_0x310214;_0xee7082[_0x493339(0x400)](_0x493339(0x718))[_0x493339(0x19c)](_0x261c36=>_0x261c36[_0x493339(0x119a)][_0x493339(0x131d)](_0x493339(0x35e))),_0x40fd0e[_0x493339(0x119a)][_0x493339(0xbff)](_0x493339(0x35e)),_0x435bb5=_0x14e32e['id'];},_0xee7082[_0x310214(0xe91)](_0x40fd0e);});const _0x4c8cb8=_0x268755[_0x53ad17(0x117b)](!![]);_0x268755[_0x53ad17(0x1245)][_0x53ad17(0xe58)](_0x4c8cb8,_0x268755),_0x4c8cb8[_0x53ad17(0xc50)]=()=>{const _0x543c10=_0x53ad17;_0x435bb5?(_0x5ea015[_0x543c10(0x119a)]['remove'](_0x543c10(0x106d)),_0x4ab381(_0x435bb5)):alert(_0x543c10(0x18d));},_0x5ea015[_0x53ad17(0x119a)][_0x53ad17(0xbff)]('visible');});}function _0x450f91(){return new Promise(_0x5c840b=>{const _0x1a3364=_0x42ed,_0x20fff4=document['getElementById'](_0x1a3364(0xdad)),_0x11974f=document['getElementById'](_0x1a3364(0xa2a)),_0xb58dfa=document[_0x1a3364(0x383)](_0x1a3364(0x88d)),_0x5313d6=_0x20fff4[_0x1a3364(0x89c)](_0x1a3364(0x8ae)),_0x17902d=_0x22cd06[_0x1a3364(0x4f1)][_0x1a3364(0x98a)](_0x3f7bcd=>_0x3f7bcd[_0x1a3364(0x10ff)]==='狼人'&&_0x3f7bcd[_0x1a3364(0x888)]),_0x5afe37=_0x17902d[_0x1a3364(0x98a)](_0x5b1ef2=>_0x5b1ef2['id']!==_0x1a3364(0x66e))['map'](_0x3acc27=>_0x3acc27[_0x1a3364(0x461)])[_0x1a3364(0xa35)]('、');_0x5afe37?_0x5313d6[_0x1a3364(0x45c)]=_0x1a3364(0xd05)+_0x5afe37+_0x1a3364(0xbe):_0x5313d6['textContent']=_0x1a3364(0x831);_0x11974f[_0x1a3364(0x45c)]='';let _0x5bacad=null;const _0x495ab9=_0x22cd06[_0x1a3364(0x4f1)][_0x1a3364(0x98a)](_0x3c215a=>_0x3c215a[_0x1a3364(0x888)]&&_0x3c215a[_0x1a3364(0x10ff)]!=='狼人');_0x495ab9[_0x1a3364(0x19c)](_0x164102=>{const _0x37fb3e=_0x1a3364,_0x513415=document[_0x37fb3e(0xe1b)](_0x37fb3e(0x7fd));_0x513415['className']='werewolf-selection-item',_0x513415['dataset']['id']=_0x164102['id'],_0x513415['innerHTML']=_0x37fb3e(0xf8a)+_0x164102[_0x37fb3e(0xb47)]+_0x37fb3e(0xd2b)+_0x164102[_0x37fb3e(0x461)]+'</span>',_0x513415[_0x37fb3e(0xc50)]=()=>{const _0x4199ba=_0x37fb3e;_0x11974f[_0x4199ba(0x400)](_0x4199ba(0x718))[_0x4199ba(0x19c)](_0x390a73=>_0x390a73[_0x4199ba(0x119a)]['remove'](_0x4199ba(0x35e))),_0x513415['classList'][_0x4199ba(0xbff)](_0x4199ba(0x35e)),_0x5bacad=_0x164102['id'];},_0x11974f[_0x37fb3e(0xe91)](_0x513415);});const _0x1da495=_0xb58dfa['cloneNode'](!![]);_0xb58dfa[_0x1a3364(0x1245)][_0x1a3364(0xe58)](_0x1da495,_0xb58dfa),_0x1da495['onclick']=()=>{const _0x52757f=_0x1a3364;_0x5bacad?(_0x20fff4[_0x52757f(0x119a)][_0x52757f(0x131d)](_0x52757f(0x106d)),_0x5c840b(_0x5bacad)):alert(_0x52757f(0x18d));},_0x20fff4['classList']['add']('visible');});}function _0x54af07(){const _0x3fcf58=_0x549949,_0x3c7164=_0x22cd06[_0x3fcf58(0x4f1)][_0x3fcf58(0xd12)](_0x3b4a07=>_0x3b4a07['id']===_0x3fcf58(0x66e));if(!_0x3c7164||!_0x3c7164['isAlive'])return;const _0xe542ba=document[_0x3fcf58(0x383)]('werewolf-user-input'),_0x1bf773=_0xe542ba[_0x3fcf58(0x1be)][_0x3fcf58(0x1cb)]();_0x1bf773&&(_0x3c5804(_0x3c7164['name'],_0x1bf773),_0x594dc5()),document[_0x3fcf58(0x383)](_0x3fcf58(0xb70))[_0x3fcf58(0x655)][_0x3fcf58(0x2b6)]='none',_0xe542ba[_0x3fcf58(0x1be)]='',_0xef30b9();}async function _0x3c3057(){const _0x27eb86=_0x549949;_0x341c48(_0x27eb86(0xaea)),_0x594dc5();const _0x1a88c1=document[_0x27eb86(0x383)](_0x27eb86(0xa21));if(_0x1a88c1)_0x1a88c1[_0x27eb86(0x29b)]=!![];await _0x296ef9(_0x27eb86(0x4bd),_0x27eb86(0xa1f));const {proxyUrl:_0x49d11c,apiKey:_0x18f948,model:_0x3639cc}=_0x41df36[_0x27eb86(0x673)];if(!_0x49d11c||!_0x18f948||!_0x3639cc){alert(_0x27eb86(0xc6d));return;}const _0x3f8781=_0x2acc09();try{let _0x3ca51d=_0x49d11c['includes'](_0x27eb86(0xdc3)),_0x1f0a6f=[{'role':'user','content':'请AI角色们继续进行讨论。'}],_0x1cb736=_0x112768(_0x3639cc,_0x18f948,_0x3f8781,_0x1f0a6f);const _0x490ff2=_0x3ca51d?await fetch(_0x1cb736[_0x27eb86(0x2fa)],_0x1cb736[_0x27eb86(0x8c6)]):await fetch(_0x49d11c+'/v1/chat/completions',{'method':_0x27eb86(0x94f),'headers':{'Content-Type':'application/json','Authorization':_0x27eb86(0xd55)+_0x18f948},'body':JSON[_0x27eb86(0x3fb)]({'model':_0x3639cc,'messages':[{'role':_0x27eb86(0xb1),'content':_0x3f8781},..._0x1f0a6f],'temperature':_0x41df36[_0x27eb86(0xc0)]['apiTemperature']||0.9})});if(!_0x490ff2['ok']){const _0x583392=await _0x490ff2['json']();throw new Error(_0x27eb86(0x85a)+_0x583392[_0x27eb86(0x98)][_0x27eb86(0x5f8)]);}const _0x4f9035=await _0x490ff2['json'](),_0x2a526c=getGeminiResponseText(_0x4f9035),_0x292998=_0x2a526c[_0x27eb86(0x22e)](/(\[[\s\S]*\])/);if(!_0x292998)throw new Error(_0x27eb86(0x91c)+_0x2a526c);const _0x1289cd=JSON['parse'](_0x292998[0x0]);for(const _0x74ea39 of _0x1289cd){_0x74ea39[_0x27eb86(0xe0b)]&&_0x74ea39[_0x27eb86(0x5ed)]&&(_0x3c5804(_0x74ea39[_0x27eb86(0xe0b)],_0x74ea39[_0x27eb86(0x5ed)]),_0x594dc5(),await new Promise(_0x5ed937=>setTimeout(_0x5ed937,0x5dc+Math[_0x27eb86(0x5ce)]()*0x7d0)));}}catch(_0x59d1e5){console[_0x27eb86(0x98)]('狼人杀AI回应生成失败:',_0x59d1e5),await _0x296ef9(_0x27eb86(0xe39),_0x27eb86(0x1bd)+_0x59d1e5[_0x27eb86(0x5f8)]);}finally{if(_0x1a88c1)_0x1a88c1['disabled']=![];}}async function _0x4d801d(){const _0x5739c3=_0x549949,_0x26bfd5=_0x22cd06[_0x5739c3(0x4f1)]['find'](_0x40eed4=>_0x40eed4['id']===_0x5739c3(0x66e));if(!_0x26bfd5||!_0x26bfd5[_0x5739c3(0x888)]){console['warn'](_0x5739c3(0x8d1));return;}const _0x4c0dba=document[_0x5739c3(0x383)]('werewolf-user-input'),_0x2a7ecb=_0x4c0dba[_0x5739c3(0x1be)][_0x5739c3(0x1cb)]();if(!_0x2a7ecb){alert('请先输入你的发言内容。');return;}_0x3c5804(_0x26bfd5['name'],_0x2a7ecb),_0x594dc5(),_0x4c0dba[_0x5739c3(0x1be)]='',await _0x296ef9(_0x5739c3(0x4bd),_0x5739c3(0xb44));const {proxyUrl:_0x29f8d3,apiKey:_0x14649b,model:_0x16fa78}=_0x41df36['apiConfig'];if(!_0x29f8d3||!_0x14649b||!_0x16fa78){alert(_0x5739c3(0xc6d));return;}const _0x1cf8db=_0x2acc09();try{let _0x2b81d7=_0x29f8d3[_0x5739c3(0xee2)](_0x5739c3(0xdc3)),_0x302557=[{'role':_0x5739c3(0x66e),'content':_0x5739c3(0xae7)+_0x26bfd5['name']+_0x5739c3(0x29c)}],_0x78065c=_0x112768(_0x16fa78,_0x14649b,_0x1cf8db,_0x302557);const _0x4c1489=_0x2b81d7?await fetch(_0x78065c[_0x5739c3(0x2fa)],_0x78065c[_0x5739c3(0x8c6)]):await fetch(_0x29f8d3+'/v1/chat/completions',{'method':_0x5739c3(0x94f),'headers':{'Content-Type':_0x5739c3(0x11f0),'Authorization':_0x5739c3(0xd55)+_0x14649b},'body':JSON[_0x5739c3(0x3fb)]({'model':_0x16fa78,'messages':[{'role':'system','content':_0x1cf8db},..._0x302557],'temperature':_0x41df36[_0x5739c3(0xc0)]['apiTemperature']||0.9})});if(!_0x4c1489['ok']){const _0x6398b9=await _0x4c1489[_0x5739c3(0x9b3)]();throw new Error('API\x20错误:\x20'+_0x6398b9[_0x5739c3(0x98)]['message']);}const _0x22a141=await _0x4c1489['json'](),_0x269dbb=getGeminiResponseText(_0x22a141),_0x1be4f1=_0x269dbb[_0x5739c3(0x22e)](/(\[[\s\S]*\])/);if(!_0x1be4f1)throw new Error(_0x5739c3(0x91c)+_0x269dbb);const _0x1a79e0=JSON['parse'](_0x1be4f1[0x0]);for(const _0x1d072b of _0x1a79e0){_0x1d072b[_0x5739c3(0xe0b)]&&_0x1d072b['dialogue']&&(_0x3c5804(_0x1d072b[_0x5739c3(0xe0b)],_0x1d072b['dialogue']),_0x594dc5(),await new Promise(_0x593376=>setTimeout(_0x593376,0x5dc+Math['random']()*0x7d0)));}}catch(_0xef2a5){console[_0x5739c3(0x98)](_0x5739c3(0x2ac),_0xef2a5),await _0x296ef9('AI\x20发言失败',_0x5739c3(0x1bd)+_0xef2a5['message']);}}async function _0xef30b9(){const _0x25cd92=_0x549949;_0x341c48(_0x25cd92(0xcb5)),_0x594dc5(),_0x22cd06[_0x25cd92(0x1385)]={};let _0x576ae8=null;_0x22cd06[_0x25cd92(0xa75)]=_0x25cd92(0xeb9);try{_0x576ae8=await _0x5ac0b0(),_0x576ae8&&_0x576ae8[_0x25cd92(0x19c)](_0x309e3f=>{const _0x30a5b7=_0x25cd92,_0x32d017=_0x22cd06[_0x30a5b7(0x4f1)]['find'](_0x436504=>_0x436504[_0x30a5b7(0x461)]===_0x309e3f['voter_name']),_0x31dada=_0x22cd06[_0x30a5b7(0x4f1)][_0x30a5b7(0xd12)](_0x21e8e1=>_0x21e8e1[_0x30a5b7(0x461)]===_0x309e3f['vote_for_name']);_0x32d017&&_0x32d017[_0x30a5b7(0x888)]&&_0x31dada&&(_0x22cd06['votes'][_0x32d017[_0x30a5b7(0x461)]]=_0x31dada[_0x30a5b7(0x461)]);}),_0x22cd06['lastFailedAction']=null;}catch(_0x448ea6){console[_0x25cd92(0x98)](_0x25cd92(0x1270),_0x448ea6),await _0x296ef9(_0x25cd92(0xa55),_0x25cd92(0x10af)+_0x448ea6[_0x25cd92(0x5f8)]),document['getElementById'](_0x25cd92(0x1298))[_0x25cd92(0x655)][_0x25cd92(0x2b6)]=_0x25cd92(0x27a);return;}const _0x2ef07f=_0x22cd06[_0x25cd92(0x4f1)]['find'](_0x19c81f=>_0x19c81f['id']===_0x25cd92(0x66e));if(_0x2ef07f&&_0x2ef07f['isAlive']){_0x341c48('请你投票。'),_0x594dc5();const _0x1437aa=await _0x3d1de4(_0x25cd92(0x103d)),_0x3f0cfd=_0x22cd06[_0x25cd92(0x4f1)][_0x25cd92(0xd12)](_0x2ebafd=>_0x2ebafd['id']===_0x1437aa);_0x3f0cfd&&(_0x22cd06[_0x25cd92(0x1385)][_0x2ef07f[_0x25cd92(0x461)]]=_0x3f0cfd[_0x25cd92(0x461)]);}_0x2a6d97();}async function _0x5ac0b0(){const _0x5c7d5b=_0x549949,{proxyUrl:_0x18382b,apiKey:_0x41eaf2,model:_0x3d2914}=_0x41df36[_0x5c7d5b(0x673)];if(!_0x18382b||!_0x41eaf2||!_0x3d2914)return null;const _0x8e0c61=_0x22cd06['players'][_0x5c7d5b(0x98a)](_0x3400b0=>_0x3400b0[_0x5c7d5b(0x888)]&&_0x3400b0['id']!==_0x5c7d5b(0x66e)),_0x5c9120=_0x22cd06[_0x5c7d5b(0x4f1)]['filter'](_0x5c6247=>_0x5c6247['isAlive'])[_0x5c7d5b(0xa79)](_0x555f04=>_0x555f04[_0x5c7d5b(0x461)]);let _0x484433=_0x2acc09();_0x484433+=_0x5c7d5b(0xe19)+_0x5c9120[_0x5c7d5b(0xa35)](',\x20')+_0x5c7d5b(0xaa0);try{let _0xc37ad0=_0x18382b['includes']('generativelanguage'),_0x1c377a=[{'role':_0x5c7d5b(0x66e),'content':_0x5c7d5b(0xd9e)}],_0xbe0e65=_0x112768(_0x3d2914,_0x41eaf2,_0x484433,_0x1c377a);const _0x12162e=_0xc37ad0?await fetch(_0xbe0e65[_0x5c7d5b(0x2fa)],_0xbe0e65[_0x5c7d5b(0x8c6)]):await fetch(_0x18382b+_0x5c7d5b(0x126b),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x5c7d5b(0xd55)+_0x41eaf2},'body':JSON[_0x5c7d5b(0x3fb)]({'model':_0x3d2914,'messages':[{'role':_0x5c7d5b(0xb1),'content':_0x484433},..._0x1c377a],'temperature':_0x41df36[_0x5c7d5b(0xc0)][_0x5c7d5b(0xa4a)]||0.8})});if(!_0x12162e['ok'])throw new Error((await _0x12162e[_0x5c7d5b(0x9b3)]())[_0x5c7d5b(0x98)][_0x5c7d5b(0x5f8)]);const _0x2a931e=await _0x12162e[_0x5c7d5b(0x9b3)](),_0x3e2a01=getGeminiResponseText(_0x2a931e);let _0x49bf9d=_0x3e2a01[_0x5c7d5b(0x709)](/^```json\s*/,'')[_0x5c7d5b(0x709)](/```$/,'')['trim']();const _0x4dfcf4=_0x49bf9d[_0x5c7d5b(0x1105)]('['),_0x308bde=_0x49bf9d[_0x5c7d5b(0x38a)](']');if(_0x4dfcf4===-0x1||_0x308bde===-0x1||_0x308bde<_0x4dfcf4)throw new Error(_0x5c7d5b(0x1021));const _0x3ae1b7=_0x49bf9d[_0x5c7d5b(0xba5)](_0x4dfcf4,_0x308bde+0x1);try{const _0x1cfa7c=_0x3ae1b7[_0x5c7d5b(0x22e)](/(\[[\s\S]*?\])/g);if(_0x1cfa7c&&_0x1cfa7c[_0x5c7d5b(0xfde)]>0x0)return JSON[_0x5c7d5b(0x134)](_0x1cfa7c[_0x1cfa7c['length']-0x1]);return JSON[_0x5c7d5b(0x134)](_0x3ae1b7);}catch(_0x47a2ef){throw new Error(_0x5c7d5b(0x7e7)+_0x47a2ef['message']+_0x5c7d5b(0xbd)+_0x3e2a01);}}catch(_0x1f79c5){console[_0x5c7d5b(0x98)](_0x5c7d5b(0x79a),_0x1f79c5);throw new Error(_0x5c7d5b(0x136e)+_0x1f79c5[_0x5c7d5b(0x5f8)]);}}function _0x2a6d97(){const _0x2d4211=_0x549949,_0x44bf07={},_0x48f5ab={};for(const _0x3894a4 in _0x22cd06[_0x2d4211(0x1385)]){const _0x4038a0=_0x22cd06[_0x2d4211(0x1385)][_0x3894a4];_0x44bf07[_0x4038a0]=(_0x44bf07[_0x4038a0]||0x0)+0x1,!_0x48f5ab[_0x4038a0]&&(_0x48f5ab[_0x4038a0]=[]),_0x48f5ab[_0x4038a0]['push'](_0x3894a4);}let _0x445ccd=0x0,_0x2906e5=[];for(const _0x1884fb in _0x44bf07){const _0x74aa21=_0x44bf07[_0x1884fb];if(_0x74aa21>_0x445ccd)_0x445ccd=_0x74aa21,_0x2906e5=[_0x1884fb];else _0x74aa21===_0x445ccd&&_0x2906e5[_0x2d4211(0x258)](_0x1884fb);}_0x341c48('投票结果：');for(const _0x4cbdf9 in _0x48f5ab){_0x341c48(_0x4cbdf9+'\x20('+_0x48f5ab[_0x4cbdf9][_0x2d4211(0xfde)]+_0x2d4211(0xb98)+_0x48f5ab[_0x4cbdf9][_0x2d4211(0xa35)]('、\x20'));}if(_0x2906e5[_0x2d4211(0xfde)]===0x1&&_0x445ccd>0x0){const _0x2632eb=_0x22cd06[_0x2d4211(0x4f1)][_0x2d4211(0xd12)](_0x1d70bc=>_0x1d70bc[_0x2d4211(0x461)]===_0x2906e5[0x0]);if(_0x2632eb){_0x2632eb['isAlive']=![],_0x341c48(_0x2632eb['name']+'\x20被投票放逐。');if(_0x2632eb['role']==='猎人'){}}}else _0x341c48('平票或无人投票，此轮无人出局。');_0x594dc5();if(_0x4db8c9())return;_0x22cd06[_0x2d4211(0xc77)]++,_0x35fb5b();}async function _0x505d13(){const _0x22a27f=_0x549949,{proxyUrl:_0x2b5d9d,apiKey:_0x57ca80,model:_0x5809ae}=_0x41df36['apiConfig'];if(!_0x2b5d9d||!_0x57ca80||!_0x5809ae)return null;const _0x20faee=_0x22cd06[_0x22a27f(0x4f1)]['filter'](_0x4374c4=>_0x4374c4[_0x22a27f(0x10ff)]==='狼人'&&_0x4374c4[_0x22a27f(0x888)]),_0xb2e269=_0x22cd06[_0x22a27f(0x4f1)][_0x22a27f(0x98a)](_0x21f045=>_0x21f045[_0x22a27f(0x888)]&&_0x21f045['role']!=='狼人'),_0x2acca5=_0x22a27f(0xd0c)+_0x20faee['map'](_0x37c72e=>_0x37c72e[_0x22a27f(0x461)])[_0x22a27f(0xa35)]('、\x20')+'\x0a-\x20**可以刀的玩家列表**:\x20'+_0xb2e269[_0x22a27f(0xa79)](_0x30ece0=>_0x30ece0['name'])[_0x22a27f(0xa35)]('、\x20')+'\x0a-\x20**讨论摘要**:\x20\x0a'+_0x22cd06['discussionLog'][_0x22a27f(0xa79)](_0x1db552=>_0x1db552[_0x22a27f(0xe1c)]+':\x20'+_0x1db552[_0x22a27f(0x11b6)])['join']('\x0a')+'\x0a\x0a现在，请做出你的决定。';try{let _0x53e6a8=_0x2b5d9d['includes']('generativelanguage'),_0x52d03c=[{'role':'user','content':_0x22a27f(0xaa7)}],_0x5c54a4=_0x112768(_0x5809ae,_0x57ca80,_0x2acca5,_0x52d03c);const _0x46cf00=_0x53e6a8?await fetch(_0x5c54a4[_0x22a27f(0x2fa)],_0x5c54a4['data']):await fetch(_0x2b5d9d+_0x22a27f(0x126b),{'method':_0x22a27f(0x94f),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x57ca80},'body':JSON[_0x22a27f(0x3fb)]({'model':_0x5809ae,'messages':[{'role':_0x22a27f(0xb1),'content':_0x2acca5},..._0x52d03c],'temperature':_0x41df36[_0x22a27f(0xc0)][_0x22a27f(0xa4a)]||0.8})});if(!_0x46cf00['ok'])throw new Error((await _0x46cf00['json']())[_0x22a27f(0x98)]['message']);const _0x25401f=await _0x46cf00['json'](),_0x1e0629=getGeminiResponseText(_0x25401f),_0x4c504b=_0x1e0629['match'](/({[\s\S]*})/);if(!_0x4c504b)throw new Error(_0x22a27f(0x15c));const _0x1616fb=JSON['parse'](_0x4c504b[0x0]),_0x1adab7=_0x22cd06[_0x22a27f(0x4f1)]['find'](_0x24a70a=>_0x24a70a[_0x22a27f(0x461)]===_0x1616fb['target_name']);return _0x1adab7?_0x1adab7['id']:null;}catch(_0x5b526e){return console[_0x22a27f(0x98)](_0x22a27f(0x784),_0x5b526e),_0xb2e269[Math['floor'](Math['random']()*_0xb2e269['length'])]['id'];}}function _0x3901ec(_0x5b1f1b,_0x48d1f0){return new Promise(_0x39dc1c=>{const _0x18b261=_0x42ed,_0x3d15d0=document[_0x18b261(0x383)](_0x18b261(0x78a)),_0x1618a2=document[_0x18b261(0x383)](_0x18b261(0x92d)),_0x1a5ad8=document[_0x18b261(0x383)]('witch-modal-title'),_0x2a7fc3=document[_0x18b261(0x383)]('confirm-witch-poison-btn'),_0x47c798=document['getElementById'](_0x18b261(0x5c0));_0x1618a2['innerHTML']='';const _0x2b2b28=_0x2a7fc3[_0x18b261(0x117b)](!![]);_0x2a7fc3[_0x18b261(0x1245)][_0x18b261(0xe58)](_0x2b2b28,_0x2a7fc3);const _0x2c8d86=_0x47c798['cloneNode'](!![]);_0x47c798[_0x18b261(0x1245)][_0x18b261(0xe58)](_0x2c8d86,_0x47c798),_0x2b2b28[_0x18b261(0x655)]['display']=_0x18b261(0x27a),_0x2b2b28[_0x18b261(0x29b)]=!![];let _0x3514c4={'save':![],'poison':null},_0x7f57e6=null;if(_0x5b1f1b&&!_0x48d1f0[_0x18b261(0xc8f)]){_0x1a5ad8[_0x18b261(0x138e)]=_0x18b261(0xc81)+_0x5b1f1b[_0x18b261(0x461)]+'\x20被刀了';const _0x246b71=document[_0x18b261(0xe1b)](_0x18b261(0x182));_0x246b71['className']=_0x18b261(0x135a),_0x246b71[_0x18b261(0x138e)]=_0x18b261(0x81f),_0x246b71[_0x18b261(0x655)][_0x18b261(0xe98)]=_0x18b261(0x634),_0x246b71[_0x18b261(0xc50)]=()=>{const _0xe22181=_0x18b261;_0x3514c4['save']=!![],_0x3d15d0[_0xe22181(0x119a)]['remove'](_0xe22181(0x106d)),_0x39dc1c(_0x3514c4);},_0x1618a2[_0x18b261(0xe91)](_0x246b71);}else _0x5b1f1b?_0x1a5ad8[_0x18b261(0x138e)]=_0x18b261(0xc81)+_0x5b1f1b[_0x18b261(0x461)]+_0x18b261(0xf26):_0x1a5ad8[_0x18b261(0x138e)]=_0x18b261(0x13a1);if(!_0x48d1f0[_0x18b261(0xeb6)]){const _0x5826d7=document[_0x18b261(0xe1b)]('p');_0x5826d7['textContent']=_0x18b261(0xb68),_0x5826d7['style']['textAlign']=_0x18b261(0x699),_0x5826d7['style'][_0x18b261(0x1348)]=_0x18b261(0x634),_0x1618a2[_0x18b261(0xe91)](_0x5826d7);const _0x2e736c=_0x22cd06[_0x18b261(0x4f1)][_0x18b261(0x98a)](_0x42d1a7=>_0x42d1a7[_0x18b261(0x888)]&&_0x42d1a7['id']!==_0x5b1f1b?.['id']);_0x2e736c['forEach'](_0x567b1b=>{const _0x5e93af=_0x18b261,_0xda33c3=document[_0x5e93af(0xe1b)]('div');_0xda33c3[_0x5e93af(0x556)]=_0x5e93af(0x6c1),_0xda33c3[_0x5e93af(0x118)]['id']=_0x567b1b['id'],_0xda33c3['innerHTML']=_0x5e93af(0xf8a)+_0x567b1b[_0x5e93af(0xb47)]+_0x5e93af(0xd2b)+_0x567b1b[_0x5e93af(0x461)]+'</span>',_0xda33c3[_0x5e93af(0xc50)]=()=>{const _0x3daf8d=_0x5e93af;_0x1618a2[_0x3daf8d(0x400)](_0x3daf8d(0x718))['forEach'](_0x49049a=>_0x49049a[_0x3daf8d(0x119a)]['remove'](_0x3daf8d(0x35e))),_0xda33c3[_0x3daf8d(0x119a)][_0x3daf8d(0xbff)](_0x3daf8d(0x35e)),_0x7f57e6=_0x567b1b['id'],_0x2b2b28[_0x3daf8d(0x29b)]=![];},_0x1618a2[_0x5e93af(0xe91)](_0xda33c3);});}_0x2b2b28[_0x18b261(0xc50)]=()=>{const _0x3d85ce=_0x18b261;_0x7f57e6&&(_0x3514c4['poison']=_0x7f57e6,_0x3d15d0[_0x3d85ce(0x119a)][_0x3d85ce(0x131d)](_0x3d85ce(0x106d)),_0x39dc1c(_0x3514c4));},_0x2c8d86[_0x18b261(0xc50)]=()=>{const _0x3a1ac0=_0x18b261;_0x3d15d0['classList'][_0x3a1ac0(0x131d)](_0x3a1ac0(0x106d)),_0x39dc1c(_0x3514c4);},_0x3d15d0[_0x18b261(0x119a)][_0x18b261(0xbff)]('visible');});}async function _0xbac3a3(){const _0x255e0e=_0x549949,_0x50060e=_0x22cd06[_0x255e0e(0xa75)];if(!_0x50060e)return;document['getElementById'](_0x255e0e(0x1298))[_0x255e0e(0x655)][_0x255e0e(0x2b6)]=_0x255e0e(0xa70),await _0x296ef9(_0x255e0e(0x4a6),_0x255e0e(0xfd6)+_0x50060e+_0x255e0e(0x28c));switch(_0x50060e){case _0x255e0e(0xfdc):await _0x35fb5b();break;case _0x255e0e(0xde):await _0x3058fe();break;case _0x255e0e(0xeb9):await _0xef30b9();break;}}function _0x4db8c9(){const _0xba8c98=_0x549949,_0x174285=_0x22cd06['players'][_0xba8c98(0x98a)](_0x52b002=>_0x52b002[_0xba8c98(0x888)]),_0x1976fb=_0x174285[_0xba8c98(0x98a)](_0x335e6e=>_0x335e6e[_0xba8c98(0x10ff)]==='狼人'),_0x255755=_0x174285[_0xba8c98(0x98a)](_0x36dd4a=>['预言家','女巫','猎人','守卫']['includes'](_0x36dd4a[_0xba8c98(0x10ff)])),_0x487af0=_0x174285[_0xba8c98(0x98a)](_0x24d276=>_0x24d276[_0xba8c98(0x10ff)]==='平民');let _0x572abc=null;if(_0x1976fb[_0xba8c98(0xfde)]===0x0)_0x572abc='好人';else{if(_0x1976fb['length']>=_0x255755[_0xba8c98(0xfde)]+_0x487af0['length'])_0x572abc='狼人';else _0x22cd06[_0xba8c98(0x5b0)]===_0xba8c98(0x10cd)?(_0x255755[_0xba8c98(0xfde)]===0x0||_0x487af0[_0xba8c98(0xfde)]===0x0)&&(_0x572abc='狼人'):_0x255755[_0xba8c98(0xfde)]===0x0&&_0x487af0[_0xba8c98(0xfde)]===0x0&&(_0x572abc='狼人');}if(_0x572abc)return _0x28edc1(_0x572abc),!![];return![];}async function _0x576644(){const _0x275a3c=_0x549949,_0x238197=await _0x23a88b(_0x275a3c(0xca),_0x275a3c(0xaa9),{'confirmText':_0x275a3c(0x8d7)});if(!_0x238197)return;await _0x296ef9('请稍候...',_0x275a3c(0x27e));try{const _0x50096e=await _0x342df8[_0x275a3c(0x864)][_0x275a3c(0x21f)]();let _0x57681b=0x0;for(const _0x5532ec of _0x50096e){let _0x30b770=![];!Array[_0x275a3c(0x565)](_0x5532ec[_0x275a3c(0xd08)])&&(_0x5532ec[_0x275a3c(0xd08)]=[],_0x30b770=!![]),(typeof _0x5532ec[_0x275a3c(0x886)]!==_0x275a3c(0x890)||_0x5532ec[_0x275a3c(0x886)]===null)&&(_0x5532ec[_0x275a3c(0x886)]={},_0x30b770=!![]),!_0x5532ec[_0x275a3c(0x1a2)]&&!_0x5532ec[_0x275a3c(0x283)]&&(_0x5532ec[_0x275a3c(0x283)]=_0x5532ec[_0x275a3c(0x461)],_0x30b770=!![]),typeof _0x5532ec[_0x275a3c(0x40c)]===_0x275a3c(0x89d)&&(_0x5532ec[_0x275a3c(0x40c)]=0x0,_0x30b770=!![]),!Array['isArray'](_0x5532ec[_0x275a3c(0x1349)])&&(_0x5532ec[_0x275a3c(0x1349)]=[],_0x30b770=!![]),_0x30b770&&(_0x57681b++,console[_0x275a3c(0xe72)]('修复了角色\x20\x22'+_0x5532ec[_0x275a3c(0x461)]+_0x275a3c(0xe00)+_0x5532ec['id']+_0x275a3c(0xd9f)),await _0x342df8[_0x275a3c(0x864)][_0x275a3c(0x9c0)](_0x5532ec)),_0x41df36[_0x275a3c(0x864)][_0x5532ec['id']]=_0x5532ec;}_0x57681b>0x0?(await _0x296ef9(_0x275a3c(0x136),_0x275a3c(0xf28)+_0x57681b+_0x275a3c(0x1b7)),await _0x25558e()):await _0x296ef9('检查完成',_0x275a3c(0x609));}catch(_0x2ce9d1){console[_0x275a3c(0x98)](_0x275a3c(0xb2e),_0x2ce9d1),await _0x296ef9(_0x275a3c(0xa55),'执行检查时发生错误:\x20'+_0x2ce9d1[_0x275a3c(0x5f8)]);}}function _0x38d82d(_0x3d6fd8,_0xdd63a5=_0x549949(0x994)){const _0x1a353c=_0x549949;if(_0x3d6fd8['querySelector']('.loader-container'))return;const _0x1cb757=document[_0x1a353c(0xe1b)](_0x1a353c(0x7fd));_0x1cb757[_0x1a353c(0x556)]=_0x1a353c(0x34f),_0x1cb757[_0x1a353c(0x45c)]=_0x1a353c(0xc7),_0xdd63a5===_0x1a353c(0xbe3)?_0x3d6fd8[_0x1a353c(0xe91)](_0x1cb757):_0x3d6fd8[_0x1a353c(0x7c9)](_0x1cb757);}function _0x3a7b5e(_0x73a74c){const _0xc32a44=_0x549949,_0x42d13a=_0x73a74c[_0xc32a44(0x89c)](_0xc32a44(0x667));_0x42d13a&&_0x42d13a['remove']();}async function _0x1bb9b8(){const _0x5b4ba9=_0x549949,_0x471332=document['getElementById'](_0x5b4ba9(0x309)),_0x4da869=document[_0x5b4ba9(0x383)](_0x5b4ba9(0x250)),_0xd2ad92=document[_0x5b4ba9(0x383)](_0x5b4ba9(0x101));_0x4da869[_0x5b4ba9(0x45c)]='',_0xd2ad92[_0x5b4ba9(0x2a3)]=![];const _0xbc33e=await _0x342df8[_0x5b4ba9(0xf17)]['toArray']();_0xbc33e['length']===0x0?_0x4da869['innerHTML']=_0x5b4ba9(0x1f0):_0xbc33e[_0x5b4ba9(0x19c)](_0x1dac12=>{const _0x2fc550=_0x5b4ba9,_0x1dcf1a=document[_0x2fc550(0xe1b)](_0x2fc550(0x7fd));_0x1dcf1a[_0x2fc550(0x556)]=_0x2fc550(0x61b),_0x1dcf1a[_0x2fc550(0x118)]['bookId']=_0x1dac12['id'],_0x1dcf1a['innerHTML']=_0x2fc550(0xc40)+_0x1dac12[_0x2fc550(0x461)]+_0x2fc550(0x604),_0x4da869[_0x2fc550(0xe91)](_0x1dcf1a);}),_0x471332['classList'][_0x5b4ba9(0xbff)]('visible');}async function _0x5e4486(){const _0x141090=_0x549949,_0x3331bc=document[_0x141090(0x400)](_0x141090(0x6b0));if(_0x3331bc['length']===0x0){alert('请至少选择一个要删除的世界书。');return;}const _0x599373=Array[_0x141090(0x365)](_0x3331bc)[_0x141090(0xa79)](_0x8e20d6=>_0x8e20d6[_0x141090(0x118)][_0x141090(0xcaa)]),_0x33e44b=await _0x23a88b('最后确认！',_0x141090(0x707)+_0x3331bc[_0x141090(0xfde)]+_0x141090(0x1075),{'confirmButtonClass':_0x141090(0x51b),'confirmText':_0x141090(0x615)});if(!_0x33e44b)return;await _0x296ef9(_0x141090(0x4a6),_0x141090(0xc7f));try{await _0x342df8[_0x141090(0xe17)]('rw',_0x342df8[_0x141090(0xf17)],_0x342df8['chats'],async()=>{const _0x3b3296=_0x141090;await _0x342df8[_0x3b3296(0xf17)][_0x3b3296(0x212)](_0x599373);const _0x3d5c45=await _0x342df8[_0x3b3296(0x864)][_0x3b3296(0x21f)]();for(const _0x18aa67 of _0x3d5c45){if(_0x18aa67[_0x3b3296(0x886)]&&Array[_0x3b3296(0x565)](_0x18aa67[_0x3b3296(0x886)]['linkedWorldBookIds'])){const _0x5717b0=_0x18aa67[_0x3b3296(0x886)]['linkedWorldBookIds'][_0x3b3296(0xfde)];_0x18aa67[_0x3b3296(0x886)]['linkedWorldBookIds']=_0x18aa67[_0x3b3296(0x886)]['linkedWorldBookIds'][_0x3b3296(0x98a)](_0x579707=>!_0x599373[_0x3b3296(0xee2)](_0x579707)),_0x18aa67['settings'][_0x3b3296(0xe8c)][_0x3b3296(0xfde)]<_0x5717b0&&await _0x342df8[_0x3b3296(0x864)][_0x3b3296(0x9c0)](_0x18aa67);}}}),_0x41df36[_0x141090(0xf17)]=_0x41df36[_0x141090(0xf17)]['filter'](_0x2170d6=>!_0x599373[_0x141090(0xee2)](_0x2170d6['id'])),document[_0x141090(0x383)](_0x141090(0x309))[_0x141090(0x119a)][_0x141090(0x131d)](_0x141090(0x106d)),await _0x296ef9(_0x141090(0xa04),_0x3331bc[_0x141090(0xfde)]+_0x141090(0x12fe));}catch(_0x261ed2){console[_0x141090(0x98)]('删除世界书失败:',_0x261ed2),await _0x296ef9(_0x141090(0xd3d),'操作失败:\x20'+_0x261ed2['message']);}}function _0x1c881a(){const _0x2a5338=_0x549949;if(!_0x41df36[_0x2a5338(0xfc5)])return;const _0x2ef7dd=_0x41df36[_0x2a5338(0xfc5)],_0x597523=document['getElementById'](_0x2a5338(0x7c1)),_0x29583c=document[_0x2a5338(0x383)](_0x2a5338(0xcfa)),_0x60e172=document[_0x2a5338(0x383)]('reading-restore-btn');let _0x325ebb=_0x566c51[_0x2ef7dd];if(_0x325ebb&&_0x325ebb['isActive']){_0x325ebb[_0x2a5338(0x67a)]&&_0x66217c();_0x597523[_0x2a5338(0x655)][_0x2a5338(0x2b6)]=_0x2a5338(0x2aa);return;}_0x31e5dc(_0x2ef7dd),_0x265fe2(_0x2ef7dd),_0x597523[_0x2a5338(0x655)]['display']=_0x2a5338(0x2aa),_0x29583c['classList'][_0x2a5338(0x131d)](_0x2a5338(0x175)),_0x60e172['style'][_0x2a5338(0x2b6)]=_0x2a5338(0xa70);const _0x7f148a=document[_0x2a5338(0x383)](_0x2a5338(0x1200)),_0x568e8c=_0x29583c['getBoundingClientRect'](),_0x2937f4=(_0x7f148a[_0x2a5338(0x630)]-_0x568e8c[_0x2a5338(0xbb2)])/0x2,_0x5bb3db=(_0x7f148a[_0x2a5338(0xe79)]-_0x568e8c[_0x2a5338(0xabd)])/0x2;_0x29583c[_0x2a5338(0x655)][_0x2a5338(0x994)]=_0x2937f4+'px',_0x29583c[_0x2a5338(0x655)]['left']=_0x5bb3db+'px',_0x29583c['style'][_0x2a5338(0x923)]='';}function _0x31e5dc(_0x41f81f){const _0x18a5e0=_0x549949;_0x566c51[_0x41f81f]={'isActive':!![],'isMinimized':![],'title':_0x18a5e0(0x1af),'contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0x4912d1(){const _0x1f8427=_0x549949,_0x248a6a=_0x41df36['activeChatId'];if(!_0x248a6a||!_0x566c51[_0x248a6a]||!_0x566c51[_0x248a6a][_0x1f8427(0x40d)])return;document[_0x1f8427(0x383)]('reading-overlay')[_0x1f8427(0x655)][_0x1f8427(0x2b6)]=_0x1f8427(0xa70),document[_0x1f8427(0x383)]('reading-restore-btn')[_0x1f8427(0x655)][_0x1f8427(0x2b6)]='none',document['getElementById'](_0x1f8427(0xcfa))[_0x1f8427(0x119a)]['remove']('minimized'),_0x566c51[_0x248a6a]['isActive']=![],console[_0x1f8427(0xe72)](_0x1f8427(0x7ee));}function _0x13387(){const _0x3ce434=_0x549949,_0x49d2d5=_0x566c51[_0x41df36[_0x3ce434(0xfc5)]];if(!_0x49d2d5||!_0x49d2d5[_0x3ce434(0x40d)]||_0x49d2d5[_0x3ce434(0x67a)])return;_0x49d2d5[_0x3ce434(0x67a)]=!![],document[_0x3ce434(0x383)](_0x3ce434(0xcfa))[_0x3ce434(0x119a)]['add']('minimized'),document[_0x3ce434(0x383)](_0x3ce434(0x229))[_0x3ce434(0x655)]['display']=_0x3ce434(0x2aa);}function _0x66217c(){const _0x1d55e3=_0x549949,_0x1e2985=_0x566c51[_0x41df36['activeChatId']];if(!_0x1e2985||!_0x1e2985[_0x1d55e3(0x40d)]||!_0x1e2985[_0x1d55e3(0x67a)])return;_0x1e2985[_0x1d55e3(0x67a)]=![],document[_0x1d55e3(0x383)](_0x1d55e3(0x229))[_0x1d55e3(0x655)][_0x1d55e3(0x2b6)]=_0x1d55e3(0xa70),document[_0x1d55e3(0x383)](_0x1d55e3(0xcfa))[_0x1d55e3(0x119a)][_0x1d55e3(0x131d)](_0x1d55e3(0x175));}function _0x3a5eba(_0x511110,_0x331a42){const _0x4deedd=_0x549949;let _0x1a8dbf=0x0,_0x5e7d64=0x0,_0x5de3e9=0x0,_0x80ccce=0x0;const _0x3cdfcb=document[_0x4deedd(0x383)](_0x4deedd(0x1200)),_0x3ae80c=_0x54bc84=>{const _0x452613=_0x4deedd;if(_0x54bc84['target'][_0x452613(0x58c)]('button'))return;if(_0x511110[_0x452613(0x655)][_0x452613(0x923)]){const _0x457c8d=_0x511110[_0x452613(0x9c5)](),_0x2a9872=_0x511110[_0x452613(0xb56)]['getBoundingClientRect']();_0x511110[_0x452613(0x655)][_0x452613(0x994)]=_0x457c8d[_0x452613(0x994)]-_0x2a9872['top']+'px',_0x511110[_0x452613(0x655)][_0x452613(0x402)]=_0x457c8d[_0x452613(0x402)]-_0x2a9872[_0x452613(0x402)]+'px',_0x511110[_0x452613(0x655)][_0x452613(0x923)]='';}_0x54bc84['preventDefault']();const _0x7314c2=_0x54bc84[_0x452613(0xa6b)]==='touchstart'?_0x54bc84[_0x452613(0x544)][0x0]:_0x54bc84;_0x5de3e9=_0x7314c2[_0x452613(0xce6)],_0x80ccce=_0x7314c2[_0x452613(0xfc9)],document['addEventListener'](_0x452613(0x1338),_0x1ae18a),document[_0x452613(0x271)](_0x452613(0x1287),_0xbcbca4),document[_0x452613(0x271)](_0x452613(0x2e9),_0x1ae18a),document[_0x452613(0x271)](_0x452613(0x3a2),_0xbcbca4);},_0xbcbca4=_0x58e065=>{const _0x30e688=_0x4deedd,_0x58b680=_0x58e065['type']===_0x30e688(0x3a2)?_0x58e065[_0x30e688(0x544)][0x0]:_0x58e065;_0x1a8dbf=_0x5de3e9-_0x58b680[_0x30e688(0xce6)],_0x5e7d64=_0x80ccce-_0x58b680['clientY'],_0x5de3e9=_0x58b680[_0x30e688(0xce6)],_0x80ccce=_0x58b680[_0x30e688(0xfc9)];let _0x2c2f87=_0x511110[_0x30e688(0x511)]-_0x5e7d64,_0x39ad2a=_0x511110['offsetLeft']-_0x1a8dbf;const _0x2dacbf=_0x3cdfcb['clientHeight']-_0x511110[_0x30e688(0x1294)]-0xa,_0x787926=_0x3cdfcb[_0x30e688(0xe79)]-_0x511110[_0x30e688(0x5f9)]-0xa;_0x2c2f87=Math[_0x30e688(0xaf3)](0xa,Math['min'](_0x2c2f87,_0x2dacbf)),_0x39ad2a=Math[_0x30e688(0xaf3)](0xa,Math['min'](_0x39ad2a,_0x787926)),_0x511110[_0x30e688(0x655)][_0x30e688(0x994)]=_0x2c2f87+'px',_0x511110[_0x30e688(0x655)][_0x30e688(0x402)]=_0x39ad2a+'px';},_0x1ae18a=()=>{const _0xe206e9=_0x4deedd;document[_0xe206e9(0xb04)](_0xe206e9(0x1338),_0x1ae18a),document['removeEventListener'](_0xe206e9(0x1287),_0xbcbca4),document['removeEventListener'](_0xe206e9(0x2e9),_0x1ae18a),document[_0xe206e9(0xb04)](_0xe206e9(0x3a2),_0xbcbca4);};_0x331a42[_0x4deedd(0x271)]('mousedown',_0x3ae80c),_0x331a42[_0x4deedd(0x271)]('touchstart',_0x3ae80c);}function _0x265fe2(_0x25123f){const _0x3300f3=_0x549949,_0xf399c0=_0x566c51[_0x25123f];if(!_0xf399c0)return;const _0x5c9788=document[_0x3300f3(0x383)]('reading-title'),_0xa9edd2=document[_0x3300f3(0x383)](_0x3300f3(0x1370)),_0x5212d1=document[_0x3300f3(0x383)]('page-indicator'),_0x503385=document['getElementById'](_0x3300f3(0xedd)),_0x56f125=document[_0x3300f3(0x383)](_0x3300f3(0x81c));_0x5c9788[_0x3300f3(0x138e)]=_0xf399c0[_0x3300f3(0xf3a)];if(_0xf399c0[_0x3300f3(0x539)][_0x3300f3(0xfde)]===0x0)_0xa9edd2[_0x3300f3(0x45c)]=_0x3300f3(0x9aa),_0xf399c0[_0x3300f3(0xa3a)]=0x0,_0xf399c0[_0x3300f3(0x1cc)]=0x0;else{const _0x3d81e7=_0xf399c0[_0x3300f3(0x1cc)]*_0xf399c0[_0x3300f3(0xd99)],_0x484484=_0x3d81e7+_0xf399c0['linesPerPage'];_0xa9edd2[_0x3300f3(0x138e)]=_0xf399c0[_0x3300f3(0x539)][_0x3300f3(0x1368)](_0x3d81e7,_0x484484)[_0x3300f3(0xa35)]('\x0a');}_0x5212d1[_0x3300f3(0x138e)]=_0xf399c0[_0x3300f3(0x1cc)]+0x1+_0x3300f3(0xfa8)+_0xf399c0[_0x3300f3(0xa3a)],_0x503385[_0x3300f3(0x29b)]=_0xf399c0['currentPage']===0x0,_0x56f125[_0x3300f3(0x29b)]=_0xf399c0[_0x3300f3(0x1cc)]>=_0xf399c0['totalPages']-0x1;}function _0x372ee1(){const _0xc32c2d=_0x549949,_0x592d85=_0x566c51[_0x41df36[_0xc32c2d(0xfc5)]];_0x592d85&&_0x592d85['currentPage']<_0x592d85[_0xc32c2d(0xa3a)]-0x1&&(_0x592d85['currentPage']++,_0x265fe2(_0x41df36[_0xc32c2d(0xfc5)]),document[_0xc32c2d(0x383)]('reading-content')['scrollTop']=0x0,_0x6d502d(_0x592d85['activeBookId'],_0x592d85[_0xc32c2d(0x1cc)]));}async function _0x16d9f8(){const _0x284ed1=_0x549949,_0x5812e3=_0x566c51[_0x41df36['activeChatId']];_0x5812e3&&_0x5812e3[_0x284ed1(0x1cc)]>0x0&&(_0x5812e3[_0x284ed1(0x1cc)]--,_0x265fe2(_0x41df36[_0x284ed1(0xfc5)]),document[_0x284ed1(0x383)](_0x284ed1(0x1370))[_0x284ed1(0x4f9)]=0x0,await _0x6d502d(_0x5812e3[_0x284ed1(0xd1c)],_0x5812e3[_0x284ed1(0x1cc)]),await notifyAiOfPageTurn(_0x41df36[_0x284ed1(0xfc5)],_0x5812e3));}function _0x474594(){const _0x4cd1fd=_0x549949;document['getElementById']('book-upload-input')[_0x4cd1fd(0x5c7)]();}async function _0xf6f54f(_0x318999){const _0x43669b=_0x549949,_0x293e53=new Uint8Array(_0x318999);if(_0x293e53['length']>=0x3&&_0x293e53[0x0]===0xef&&_0x293e53[0x1]===0xbb&&_0x293e53[0x2]===0xbf)return console[_0x43669b(0xe72)](_0x43669b(0xb31)),new TextDecoder('utf-8')[_0x43669b(0xc18)](_0x293e53);if(_0x293e53[_0x43669b(0xfde)]>=0x2&&_0x293e53[0x0]===0xff&&_0x293e53[0x1]===0xfe)return console[_0x43669b(0xe72)](_0x43669b(0x196)),new TextDecoder(_0x43669b(0x1054))[_0x43669b(0xc18)](_0x293e53);if(_0x293e53[_0x43669b(0xfde)]>=0x2&&_0x293e53[0x0]===0xfe&&_0x293e53[0x1]===0xff)return console[_0x43669b(0xe72)](_0x43669b(0xb62)),new TextDecoder(_0x43669b(0xcb0))[_0x43669b(0xc18)](_0x293e53);try{console[_0x43669b(0xe72)](_0x43669b(0xe85));const _0xa7c7fa=new TextDecoder(_0x43669b(0x1246),{'fatal':!![]})[_0x43669b(0xc18)](_0x293e53);return console[_0x43669b(0xe72)](_0x43669b(0x65c)),_0xa7c7fa;}catch(_0x41c8cf){console[_0x43669b(0xe72)](_0x43669b(0xdbd));try{const _0xa50f22=new TextDecoder(_0x43669b(0x8bf))[_0x43669b(0xc18)](_0x293e53);return console[_0x43669b(0xe72)](_0x43669b(0xf86)),_0xa50f22;}catch(_0x23b31e){console[_0x43669b(0x98)]('所有解码尝试均失败:',_0x23b31e);throw new Error('无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。');}}}async function _0xbd7fe7(_0x18cf18){const _0x4092f9=_0x549949,_0x2d20da=_0x18cf18[_0x4092f9(0xfab)][_0x4092f9(0x1185)][0x0];if(!_0x2d20da)return;try{const _0x8254c4=await _0x2d20da[_0x4092f9(0xb12)](),_0xab1d3f=await _0xf6f54f(_0x8254c4),_0x12a8f3=_0x2d20da[_0x4092f9(0x461)][_0x4092f9(0x709)](/\.txt$/i,''),_0x675de=await _0x342df8[_0x4092f9(0x136a)]['add']({'title':_0x12a8f3,'content':_0xab1d3f,'lastOpened':Date[_0x4092f9(0x108d)]()});await _0x37a10a(_0x675de),document[_0x4092f9(0x383)]('reading-library-modal')['classList'][_0x4092f9(0x987)](_0x4092f9(0x106d))&&_0x1740f5();}catch(_0x44f900){console[_0x4092f9(0x98)](_0x4092f9(0x1055),_0x44f900),await _0x296ef9(_0x4092f9(0x108e),_0x44f900['message']);}finally{_0x18cf18[_0x4092f9(0xfab)][_0x4092f9(0x1be)]=null;}}async function _0x2f14c3(){const _0x1800bc=_0x549949,_0x1b68eb=_0x41df36['activeChatId'];if(!_0x1b68eb)return;const _0x765aaa=_0x566c51[_0x1b68eb];if(!_0x765aaa||_0x765aaa[_0x1800bc(0xa3a)]<=0x1)return;const _0x5efe0c=await _0x12e332(_0x1800bc(0xb51),'请输入想跳转的页码\x20(1\x20-\x20'+_0x765aaa[_0x1800bc(0xa3a)]+')',_0x765aaa[_0x1800bc(0x1cc)]+0x1);if(_0x5efe0c===null)return;const _0x55febd=parseInt(_0x5efe0c);if(isNaN(_0x55febd)||_0x55febd<0x1||_0x55febd>_0x765aaa['totalPages']){alert(_0x1800bc(0xed1));return;}_0x765aaa[_0x1800bc(0x1cc)]=_0x55febd-0x1,_0x265fe2(_0x1b68eb),_0x6d502d(_0x765aaa[_0x1800bc(0xd1c)],_0x765aaa['currentPage']);}async function _0x6d502d(_0x35c4cb,_0x245a9f){const _0x407731=_0x549949;if(!_0x35c4cb)return;try{await _0x342df8[_0x407731(0x136a)][_0x407731(0xaf9)](_0x35c4cb,{'currentPage':_0x245a9f});}catch(_0x251290){console[_0x407731(0x98)](_0x407731(0x51d)+_0x35c4cb+_0x407731(0x55b),_0x251290);}}async function _0x372ee1(){const _0x8a1670=_0x549949,_0x974a9e=_0x566c51[_0x41df36[_0x8a1670(0xfc5)]];_0x974a9e&&_0x974a9e['currentPage']<_0x974a9e[_0x8a1670(0xa3a)]-0x1&&(_0x974a9e['currentPage']++,_0x265fe2(_0x41df36['activeChatId']),document[_0x8a1670(0x383)](_0x8a1670(0x1370))['scrollTop']=0x0,await _0x6d502d(_0x974a9e['activeBookId'],_0x974a9e[_0x8a1670(0x1cc)]),await notifyAiOfPageTurn(_0x41df36[_0x8a1670(0xfc5)],_0x974a9e));}function _0x6cfafe(_0x4f9b77,_0x41d9c5){const _0x46b0f8=_0x549949,_0xd54022=_0x41df36[_0x46b0f8(0xfc5)];if(!_0xd54022)return;const _0x44090e=_0x566c51[_0xd54022];_0x44090e['title']=_0x4f9b77[_0x46b0f8(0x709)](/\.txt$/i,''),_0x44090e['contentLines']=_0x41d9c5[_0x46b0f8(0x105d)](/\r\n?|\n/)[_0x46b0f8(0xa79)](_0x13ce2a=>_0x13ce2a[_0x46b0f8(0x709)](/ +/g,'\x20')),_0x44090e['totalPages']=Math['ceil'](_0x44090e[_0x46b0f8(0x539)]['length']/_0x44090e[_0x46b0f8(0xd99)]),_0x44090e['currentPage']=0x0,_0x265fe2(_0xd54022);}async function _0x5f006f(){const _0x5f16d4=_0x549949;document[_0x5f16d4(0x383)](_0x5f16d4(0x1088))[_0x5f16d4(0x1be)]='',await _0x1740f5(),document[_0x5f16d4(0x383)]('reading-library-modal')[_0x5f16d4(0x119a)][_0x5f16d4(0xbff)](_0x5f16d4(0x106d));}async function _0x1740f5(_0x1da1d0=''){const _0x5c8f03=_0x549949,_0x2e6ac7=document[_0x5c8f03(0x383)](_0x5c8f03(0xc56));let _0x4f086b=await _0x342df8[_0x5c8f03(0x136a)][_0x5c8f03(0x4b1)](_0x5c8f03(0xe9))[_0x5c8f03(0x1087)]()[_0x5c8f03(0x21f)]();_0x2e6ac7[_0x5c8f03(0x45c)]='';_0x1da1d0&&(_0x4f086b=_0x4f086b[_0x5c8f03(0x98a)](_0x1dc06c=>_0x1dc06c[_0x5c8f03(0xf3a)][_0x5c8f03(0x189)]()[_0x5c8f03(0xee2)](_0x1da1d0[_0x5c8f03(0x189)]())));if(_0x4f086b[_0x5c8f03(0xfde)]===0x0){const _0x331d05=_0x1da1d0?_0x5c8f03(0x1035):'书库是空的，点击“导入新书”添加第一本吧！';_0x2e6ac7[_0x5c8f03(0x45c)]=_0x5c8f03(0x1012)+_0x331d05+'</p>';return;}_0x4f086b[_0x5c8f03(0x19c)](_0x29a509=>{const _0x25aa63=_0x5c8f03,_0x5b94f2=document[_0x25aa63(0xe1b)]('div');_0x5b94f2[_0x25aa63(0x556)]=_0x25aa63(0x7c0),_0x5b94f2['innerHTML']=_0x25aa63(0x90e)+_0x29a509['id']+'\x22>'+_0x29a509[_0x25aa63(0xf3a)]+_0x25aa63(0x873)+_0x29a509['id']+_0x25aa63(0x127),_0x2e6ac7[_0x25aa63(0xe91)](_0x5b94f2);});}async function _0x37a10a(_0x35d25a){const _0x5c4440=_0x549949,_0x2b1781=_0x41df36[_0x5c4440(0xfc5)];if(!_0x2b1781)return;const _0x1c734c=await _0x342df8[_0x5c4440(0x136a)]['get'](_0x35d25a);if(!_0x1c734c){alert('找不到这本书！');return;}await _0x342df8[_0x5c4440(0x136a)][_0x5c4440(0xaf9)](_0x35d25a,{'lastOpened':Date[_0x5c4440(0x108d)]()});const _0x829855=_0x566c51[_0x2b1781];_0x829855[_0x5c4440(0xd1c)]=_0x35d25a,_0x829855[_0x5c4440(0xf3a)]=_0x1c734c[_0x5c4440(0xf3a)],_0x829855['contentLines']=_0x1c734c['content'][_0x5c4440(0x105d)](/\r\n?|\n/)[_0x5c4440(0xa79)](_0x3a2b46=>_0x3a2b46[_0x5c4440(0x709)](/ +/g,'\x20')),_0x829855['totalPages']=Math[_0x5c4440(0x46d)](_0x829855['contentLines'][_0x5c4440(0xfde)]/_0x829855['linesPerPage']),_0x829855[_0x5c4440(0x1cc)]=_0x1c734c[_0x5c4440(0x1cc)]||0x0,_0x265fe2(_0x2b1781),document['getElementById']('reading-content')[_0x5c4440(0x4f9)]=0x0,document['getElementById'](_0x5c4440(0x93b))[_0x5c4440(0x119a)][_0x5c4440(0x131d)](_0x5c4440(0x106d));}async function _0x7c751(_0x5502e1){const _0x25eff6=_0x549949,_0x1b3be9=await _0x342df8[_0x25eff6(0x136a)][_0x25eff6(0x1a3)](_0x5502e1);if(!_0x1b3be9)return;const _0x570cde=await _0x23a88b(_0x25eff6(0xe4e),_0x25eff6(0xbf6)+_0x1b3be9['title']+_0x25eff6(0x75c),{'confirmButtonClass':_0x25eff6(0x51b)});_0x570cde&&(await _0x342df8['readingLibrary']['delete'](_0x5502e1),await _0x1740f5());}function _0x6cfafe(_0x7f9605,_0x17b2a8){const _0x1414c1=_0x549949,_0x35abf8=_0x41df36[_0x1414c1(0xfc5)];if(!_0x35abf8)return;const _0x2efeb3=_0x566c51[_0x35abf8];_0x2efeb3[_0x1414c1(0xf3a)]=_0x7f9605[_0x1414c1(0x709)](/\.txt$/i,''),_0x2efeb3['contentLines']=_0x17b2a8[_0x1414c1(0x105d)](/\r\n?|\n/),_0x2efeb3['totalPages']=Math[_0x1414c1(0x46d)](_0x2efeb3[_0x1414c1(0x539)][_0x1414c1(0xfde)]/_0x2efeb3[_0x1414c1(0xd99)]),_0x2efeb3['currentPage']=0x0,_0x265fe2(_0x35abf8);}function _0x3a5eba(_0x260f46,_0x484324){const _0x2e5ef6=_0x549949;let _0x3f9067=0x0,_0xf2dbc5=0x0,_0x30a2f9=0x0,_0x4b34ff=0x0,_0x5b972f=![],_0x49c778=![];const _0x566141=document['getElementById'](_0x2e5ef6(0x1200)),_0x8a34e9=_0x29082e=>{const _0x23bf10=_0x2e5ef6;if(_0x260f46!==_0x484324&&_0x29082e['target']['closest'](_0x23bf10(0x182)))return;_0x5b972f=!![],_0x49c778=![];const _0x3c3312=_0x29082e[_0x23bf10(0xa6b)]===_0x23bf10(0xcb7)?_0x29082e['touches'][0x0]:_0x29082e;_0x30a2f9=_0x3c3312['clientX'],_0x4b34ff=_0x3c3312[_0x23bf10(0xfc9)],_0x260f46[_0x23bf10(0x655)]['top']=_0x260f46[_0x23bf10(0x511)]+'px',_0x260f46[_0x23bf10(0x655)]['left']=_0x260f46[_0x23bf10(0x99b)]+'px',_0x260f46['style'][_0x23bf10(0x923)]='',document[_0x23bf10(0x271)]('mouseup',_0xad2e96),document[_0x23bf10(0x271)](_0x23bf10(0x1287),_0x4296ee),document[_0x23bf10(0x271)](_0x23bf10(0x2e9),_0xad2e96),document['addEventListener'](_0x23bf10(0x3a2),_0x4296ee,{'passive':![]});},_0x4296ee=_0x283726=>{const _0x53ba78=_0x2e5ef6;if(!_0x5b972f)return;const _0xbce780=_0x283726[_0x53ba78(0xa6b)]===_0x53ba78(0x3a2)?_0x283726[_0x53ba78(0x544)][0x0]:_0x283726,_0x21f920=_0xbce780[_0x53ba78(0xce6)]-_0x30a2f9,_0x44b014=_0xbce780[_0x53ba78(0xfc9)]-_0x4b34ff;!_0x49c778&&(Math[_0x53ba78(0x744)](_0x21f920)>0x5||Math[_0x53ba78(0x744)](_0x44b014)>0x5)&&(_0x49c778=!![]);_0x49c778&&_0x283726[_0x53ba78(0x47b)]&&_0x283726[_0x53ba78(0xe94)]();_0x3f9067=_0x30a2f9-_0xbce780[_0x53ba78(0xce6)],_0xf2dbc5=_0x4b34ff-_0xbce780[_0x53ba78(0xfc9)],_0x30a2f9=_0xbce780['clientX'],_0x4b34ff=_0xbce780[_0x53ba78(0xfc9)];let _0x4f9521=_0x260f46[_0x53ba78(0x511)]-_0xf2dbc5,_0x8e6de=_0x260f46['offsetLeft']-_0x3f9067;const _0xab574b=_0x566141[_0x53ba78(0x630)]-_0x260f46[_0x53ba78(0x1294)]-0xa,_0x297725=_0x566141[_0x53ba78(0xe79)]-_0x260f46[_0x53ba78(0x5f9)]-0xa;_0x4f9521=Math[_0x53ba78(0xaf3)](0xa,Math[_0x53ba78(0xc5e)](_0x4f9521,_0xab574b)),_0x8e6de=Math[_0x53ba78(0xaf3)](0xa,Math[_0x53ba78(0xc5e)](_0x8e6de,_0x297725)),_0x260f46['style']['top']=_0x4f9521+'px',_0x260f46[_0x53ba78(0x655)][_0x53ba78(0x402)]=_0x8e6de+'px';},_0xad2e96=()=>{const _0x26bd9c=_0x2e5ef6;document[_0x26bd9c(0xb04)]('mouseup',_0xad2e96),document[_0x26bd9c(0xb04)]('mousemove',_0x4296ee),document['removeEventListener'](_0x26bd9c(0x2e9),_0xad2e96),document[_0x26bd9c(0xb04)](_0x26bd9c(0x3a2),_0x4296ee);if(!_0x5b972f)return;_0x5b972f=![],!_0x49c778&&_0x260f46['click']();};_0x484324[_0x2e5ef6(0x271)](_0x2e5ef6(0x413),_0x8a34e9),_0x484324['addEventListener'](_0x2e5ef6(0xcb7),_0x8a34e9,{'passive':![]});}function _0x13387(){const _0x35f7bc=_0x549949,_0x42286e=_0x566c51[_0x41df36[_0x35f7bc(0xfc5)]];if(!_0x42286e||!_0x42286e[_0x35f7bc(0x40d)])return;document[_0x35f7bc(0x383)](_0x35f7bc(0xcfa))[_0x35f7bc(0x119a)]['add'](_0x35f7bc(0x175)),document['getElementById'](_0x35f7bc(0x229))[_0x35f7bc(0x655)]['display']=_0x35f7bc(0x2aa),_0x42286e[_0x35f7bc(0x67a)]=!![];}function _0x66217c(){const _0x417c27=_0x549949,_0x4de2b1=_0x566c51[_0x41df36[_0x417c27(0xfc5)]];if(!_0x4de2b1||!_0x4de2b1[_0x417c27(0x40d)])return;document['getElementById'](_0x417c27(0x229))[_0x417c27(0x655)][_0x417c27(0x2b6)]='none',document[_0x417c27(0x383)](_0x417c27(0xcfa))[_0x417c27(0x119a)]['remove'](_0x417c27(0x175)),_0x4de2b1[_0x417c27(0x67a)]=![];}function _0x126ee3(_0xb48f6f,_0x27c6ca){let _0x5a2bcc;return function(..._0x5be443){const _0x352c1a=this;clearTimeout(_0x5a2bcc),_0x5a2bcc=setTimeout(()=>_0xb48f6f['apply'](_0x352c1a,_0x5be443),_0x27c6ca);};}function _0x600639(_0x36cf50){const _0x37f5a7=_0x549949,_0x536a68=_0x566c51[_0x36cf50];if(!_0x536a68||!_0x536a68[_0x37f5a7(0x40d)])return'';const _0x1dc86f=_0x536a68['title']||_0x37f5a7(0x12e5);let _0x408c1e='',_0x423748='';if(_0x536a68[_0x37f5a7(0xb46)]&&_0x536a68['currentSnippet'][_0x37f5a7(0x1cb)]())_0x408c1e=_0x536a68[_0x37f5a7(0xb46)],_0x423748='你正在阅读的段落';else{if(_0x536a68[_0x37f5a7(0x539)]['length']>0x0){const _0x5debba=_0x536a68['currentPage']*_0x536a68[_0x37f5a7(0xd99)],_0x12470c=_0x5debba+_0x536a68[_0x37f5a7(0xd99)];_0x408c1e=_0x536a68['contentLines'][_0x37f5a7(0x1368)](_0x5debba,_0x12470c)[_0x37f5a7(0xa35)]('\x0a')['substring'](0x0,0xc8),_0x423748=_0x37f5a7(0x1260);}else _0x408c1e=_0x37f5a7(0x42e),_0x423748='内容';}return _0x37f5a7(0x23c)+_0x1dc86f+_0x37f5a7(0xb0)+_0x423748+_0x37f5a7(0x395)+_0x408c1e+_0x37f5a7(0x11ac)+(_0x41df36[_0x37f5a7(0x864)][_0x36cf50]?.[_0x37f5a7(0x283)]||_0x37f5a7(0x8ed))+_0x37f5a7(0x53c);}function _0x38f299(){const _0x457e36=_0x549949,_0x5de039=_0x41df36[_0x457e36(0xfc5)];if(!_0x5de039||!_0x566c51[_0x5de039])return;const _0x145818=_0x566c51[_0x5de039],_0x6628d9=document[_0x457e36(0x383)](_0x457e36(0x1370)),_0x4488ca=_0x6628d9['scrollTop'],_0x531a2f=_0x6628d9[_0x457e36(0x630)],_0x1bd93a=_0x4488ca+_0x531a2f,_0x250817=0xf*1.8,_0x5ec70c=Math['floor'](_0x4488ca/_0x250817),_0x219c8e=Math['ceil'](_0x1bd93a/_0x250817),_0xd61ff1=_0x145818[_0x457e36(0x1cc)]*_0x145818[_0x457e36(0xd99)]+_0x5ec70c,_0x2fa2d9=_0x145818[_0x457e36(0x1cc)]*_0x145818[_0x457e36(0xd99)]+_0x219c8e;if(_0xd61ff1<0x0||_0xd61ff1>=_0x145818['contentLines'][_0x457e36(0xfde)])return;const _0x576d09=_0x145818['contentLines'][_0x457e36(0x1368)](Math[_0x457e36(0xaf3)](0x0,_0xd61ff1),Math['min'](_0x145818[_0x457e36(0x539)][_0x457e36(0xfde)],_0x2fa2d9))['join']('\x0a');_0x145818[_0x457e36(0xb46)]=_0x576d09;}function _0x2b6a68(){const _0x20c870=_0x549949,_0x30aa93=document[_0x20c870(0x383)]('silent-audio-player');if(_0x30aa93){const _0x5ed73f=_0x30aa93['play']();_0x5ed73f!==undefined&&_0x5ed73f[_0x20c870(0x1c1)](_0x29aae8=>{const _0x3f9f98=_0x20c870;console[_0x3f9f98(0xe72)](_0x3f9f98(0xc0b));})[_0x20c870(0xa27)](_0x376df5=>{const _0xe7f32=_0x20c870;console['warn'](_0xe7f32(0xb85),_0x376df5);});}}function _0x4f6d5a(){const _0x45d057=_0x549949,_0x223117=document[_0x45d057(0x383)](_0x45d057(0x113a));_0x223117&&!_0x223117[_0x45d057(0x3b4)]&&(_0x223117['pause'](),_0x223117[_0x45d057(0x60f)]=0x0,console[_0x45d057(0xe72)](_0x45d057(0xc1)));}async function _0x198bfd(_0x4658a9){const _0x218375=_0x549949,_0x37d33f=decodeURIComponent(_0x4658a9['dataset']['text']),_0x41ea1d=_0x4658a9[_0x218375(0x118)][_0x218375(0xe13)],_0x5343a8=_0x4658a9['querySelector'](_0x218375(0x138)),_0x8556f8=_0x4658a9[_0x218375(0x89c)]('.loading-spinner'),_0x6c17fc=document['getElementById']('tts-audio-player');if(!_0x6c17fc['paused']&&_0x6c17fc['dataset'][_0x218375(0x730)]===_0x37d33f&&_0x6c17fc['dataset'][_0x218375(0x339)]===_0x41ea1d){_0x6c17fc[_0x218375(0xcb4)]();return;}_0x6c17fc[_0x218375(0xcb4)](),document[_0x218375(0x400)](_0x218375(0x138))['forEach'](_0xe07169=>_0xe07169[_0x218375(0x138e)]='▶');const _0x1b6a37=_0x218375(0xf38)+_0x41ea1d+'_'+_0x37d33f;let _0x15ac65=_0x41df36['ttsCache'][_0x218375(0x1a3)](_0x1b6a37);if(_0x15ac65){console[_0x218375(0xe72)](_0x218375(0xd6d)),await _0x5900de(_0x15ac65[_0x218375(0x2fa)],_0x15ac65[_0x218375(0xa6b)],_0x37d33f,_0x41ea1d,_0x4658a9);return;}console[_0x218375(0xe72)](_0x218375(0x1318));if(_0x5343a8)_0x5343a8[_0x218375(0x655)][_0x218375(0x2b6)]=_0x218375(0xa70);_0x8556f8[_0x218375(0x655)][_0x218375(0x2b6)]=_0x218375(0x27a);const {minimaxGroupId:_0x648d74,minimaxApiKey:_0x59e13f}=_0x41df36[_0x218375(0x673)];if(!_0x648d74||!_0x59e13f){await _0x296ef9(_0x218375(0x14b),_0x218375(0x1312)),_0x8556f8[_0x218375(0x655)][_0x218375(0x2b6)]=_0x218375(0xa70);if(_0x5343a8)_0x5343a8['style'][_0x218375(0x2b6)]=_0x218375(0x2aa);return;}try{const _0x8f654=await fetch('https://api.minimax.chat/v1/text_to_speech?GroupId='+_0x648d74,{'method':_0x218375(0x94f),'headers':{'Authorization':_0x218375(0xd55)+_0x59e13f,'Content-Type':'application/json'},'body':JSON['stringify']({'text':_0x37d33f,'voice_id':_0x41ea1d,'model':_0x41df36[_0x218375(0x673)][_0x218375(0x104a)]||'speech-01','speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0x8f654['ok']){let _0x538058='API\x20返回错误:\x20'+_0x8f654[_0x218375(0x1fe)];try{const _0x2e766d=await _0x8f654['json']();_0x538058=_0x2e766d[_0x218375(0x1066)]?.[_0x218375(0x1045)]||JSON['stringify'](_0x2e766d);}catch(_0x35a715){_0x538058=await _0x8f654[_0x218375(0x6af)]();}throw new Error(_0x538058);}const _0x3a7325=await _0x8f654[_0x218375(0x800)](),_0x5aa9e2=URL['createObjectURL'](_0x3a7325);await _0x5900de(_0x5aa9e2,_0x3a7325[_0x218375(0xa6b)],_0x37d33f,_0x41ea1d,_0x4658a9);const _0x320734=new FileReader();_0x320734[_0x218375(0x132)]=function(){const _0x9d9da9=_0x218375;_0x41df36[_0x9d9da9(0x140)][_0x9d9da9(0x5ba)](_0x1b6a37,{'url':_0x320734[_0x9d9da9(0xa86)],'type':_0x3a7325[_0x9d9da9(0xa6b)]}),console[_0x9d9da9(0xe72)](_0x9d9da9(0x157));},_0x320734[_0x218375(0x132a)](_0x3a7325);}catch(_0xc00623){console[_0x218375(0x98)]('Minimax\x20TTS\x20API\x20调用失败:',_0xc00623),await _0x296ef9(_0x218375(0xfc2),_0x218375(0x1bd)+_0xc00623[_0x218375(0x5f8)]);}finally{_0x8556f8[_0x218375(0x655)][_0x218375(0x2b6)]=_0x218375(0xa70);if(_0x5343a8)_0x5343a8[_0x218375(0x655)][_0x218375(0x2b6)]=_0x218375(0x2aa);}}function _0x5900de(_0x185be2,_0x38603d,_0x1037e7,_0x41129d,_0x143040){return new Promise((_0x30a30a,_0x4575a3)=>{const _0x48a245=_0x42ed,_0x424fc3=document[_0x48a245(0x383)]('tts-audio-player');_0x424fc3[_0x48a245(0xf6c)]=_0x185be2,_0x424fc3[_0x48a245(0xa6b)]=_0x38603d,_0x424fc3[_0x48a245(0x118)][_0x48a245(0x730)]=_0x1037e7,_0x424fc3['dataset']['currentVoiceId']=_0x41129d;const _0x404572=_0x424fc3['play']();_0x404572!==undefined&&_0x404572[_0x48a245(0x1c1)](()=>{const _0xa6b952=_0x48a245,_0x52302c=_0x143040[_0xa6b952(0x89c)](_0xa6b952(0x138));if(_0x52302c)_0x52302c[_0xa6b952(0x138e)]='❚❚';_0x30a30a();})[_0x48a245(0xa27)](_0x3e6041=>{const _0x3cbcc2=_0x48a245;console['error'](_0x3cbcc2(0xb8e),_0x3e6041),_0x4575a3(_0x3e6041);}),_0x424fc3['onended']=()=>{const _0x2b1c78=_0x48a245,_0x1f6a03=_0x143040['querySelector']('.voice-play-btn');if(_0x1f6a03)_0x1f6a03[_0x2b1c78(0x138e)]='▶';},_0x424fc3[_0x48a245(0x280)]=()=>{const _0x1b2298=_0x48a245,_0x2ba4ef=_0x143040['querySelector'](_0x1b2298(0x138));if(_0x2ba4ef)_0x2ba4ef['textContent']='▶';};});}function _0x3ec05c(_0x3affbb){const _0xa61ebb=_0x549949,_0x5aa39b=_0x3affbb[_0xa61ebb(0x58c)](_0xa61ebb(0xbb0));if(!_0x5aa39b)return;const _0x35075d=_0x5aa39b[_0xa61ebb(0x89c)](_0xa61ebb(0xeaa)),_0x4bba2b=decodeURIComponent(_0x3affbb[_0xa61ebb(0x118)][_0xa61ebb(0x6af)]);_0x35075d['style'][_0xa61ebb(0x2b6)]===_0xa61ebb(0x27a)?_0x35075d['style'][_0xa61ebb(0x2b6)]='none':(_0x35075d[_0xa61ebb(0x138e)]=_0x4bba2b,_0x35075d['style']['display']=_0xa61ebb(0x27a));}async function _0x27b013(){const _0x1382d2=_0x549949;await _0x681359(),document[_0x1382d2(0x383)]('product-category-manager-modal')[_0x1382d2(0x119a)][_0x1382d2(0xbff)](_0x1382d2(0x106d));}async function _0x681359(){const _0x2534ac=_0x549949,_0x4bf337=document[_0x2534ac(0x383)](_0x2534ac(0x9fa)),_0x2f95f1=await _0x342df8[_0x2534ac(0x8c2)][_0x2534ac(0x21f)]();_0x4bf337[_0x2534ac(0x45c)]='';if(_0x2f95f1[_0x2534ac(0xfde)]===0x0){_0x4bf337[_0x2534ac(0x45c)]=_0x2534ac(0xed6);return;}_0x2f95f1[_0x2534ac(0x19c)](_0x1a9f99=>{const _0x28abfd=_0x2534ac,_0x4324cf=document[_0x28abfd(0xe1b)](_0x28abfd(0x7fd));_0x4324cf[_0x28abfd(0x556)]=_0x28abfd(0x7c0),_0x4324cf[_0x28abfd(0x45c)]=_0x28abfd(0xe41)+_0x1a9f99['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x1a9f99['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4bf337[_0x28abfd(0xe91)](_0x4324cf);});}async function _0x2f55e4(){const _0x49ae95=_0x549949,_0x385853=document[_0x49ae95(0x383)](_0x49ae95(0x1356)),_0x49d5af=_0x385853[_0x49ae95(0x1be)]['trim']();if(!_0x49d5af)return alert(_0x49ae95(0x536));const _0x2e8297=await _0x342df8[_0x49ae95(0x8c2)][_0x49ae95(0x6bd)](_0x49ae95(0x461))[_0x49ae95(0x5b3)](_0x49d5af)[_0x49ae95(0x26e)]();if(_0x2e8297)return alert(_0x49ae95(0xf1b)+_0x49d5af+'\x22\x20已经存在了！');await _0x342df8['shoppingCategories'][_0x49ae95(0xbff)]({'name':_0x49d5af}),_0x385853[_0x49ae95(0x1be)]='',await _0x681359();}async function _0x11b27a(_0x27f738){const _0x24f279=_0x549949,_0x4cbf11=await _0x23a88b(_0x24f279(0x615),_0x24f279(0xda7),{'confirmButtonClass':'btn-danger'});_0x4cbf11&&(await _0x342df8[_0x24f279(0x8c2)]['delete'](_0x27f738),await _0x342df8[_0x24f279(0xd18)][_0x24f279(0x6bd)](_0x24f279(0xba3))[_0x24f279(0x5b3)](_0x27f738)[_0x24f279(0x1190)]({'categoryId':null}),await _0x681359());}function _0x41f537(_0x907133={}){const _0x2a720e=_0x549949,_0x129b53=document[_0x2a720e(0x383)](_0x2a720e(0x1006)),_0x2ec0a6=document['createElement'](_0x2a720e(0x7fd));return _0x2ec0a6[_0x2a720e(0x556)]=_0x2a720e(0x53e),_0x2ec0a6[_0x2a720e(0x45c)]=_0x2a720e(0x3e6)+(_0x907133['name']||'')+_0x2a720e(0x24e)+(_0x907133['price']||'')+_0x2a720e(0x8a8)+(_0x907133[_0x2a720e(0xa94)]||_0x2a720e(0xfd0))+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x2ec0a6[_0x2a720e(0x89c)](_0x2a720e(0x11c4))[_0x2a720e(0x271)]('click',()=>_0x2ec0a6[_0x2a720e(0x131d)]()),_0x2ec0a6['querySelector'](_0x2a720e(0x833))['addEventListener']('click',()=>{const _0x37c216=_0x2a720e;_0x2ec0a6[_0x37c216(0x89c)](_0x37c216(0x484))['click']();}),_0x2ec0a6[_0x2a720e(0x89c)]('.variation-image-input')['addEventListener']('change',_0x5292e3=>{const _0x2bfe11=_0x2a720e,_0x343a27=_0x5292e3[_0x2bfe11(0xfab)][_0x2bfe11(0x1185)][0x0];if(_0x343a27){const _0x3b9690=new FileReader();_0x3b9690[_0x2bfe11(0xb5b)]=_0x107d48=>{const _0x369145=_0x2bfe11;_0x2ec0a6[_0x369145(0x89c)](_0x369145(0x1024))['src']=_0x107d48[_0x369145(0xfab)]['result'];},_0x3b9690[_0x2bfe11(0x132a)](_0x343a27);}}),_0x129b53[_0x2a720e(0xe91)](_0x2ec0a6),_0x2ec0a6;}async function _0x5f374c(_0xf783c){const _0x278bda=_0x549949,_0x98555d=await _0x342df8['shoppingProducts'][_0x278bda(0x1a3)](_0xf783c);if(!_0x98555d||!_0x98555d[_0x278bda(0xade)]||_0x98555d['variations'][_0x278bda(0xfde)]===0x0)return;const _0x485cab=document[_0x278bda(0x383)](_0x278bda(0xc04));document['getElementById'](_0x278bda(0xa47))[_0x278bda(0xf6c)]=_0x98555d[_0x278bda(0xa94)],document[_0x278bda(0x383)](_0x278bda(0x5e7))[_0x278bda(0x138e)]=_0x98555d[_0x278bda(0x461)];const _0x4d1a31=document[_0x278bda(0x383)](_0x278bda(0x1229));_0x4d1a31[_0x278bda(0x45c)]='',_0x98555d['variations'][_0x278bda(0x19c)]((_0x526362,_0x24762f)=>{const _0x935a57=_0x278bda,_0x58b396=document['createElement']('input');_0x58b396[_0x935a57(0xa6b)]=_0x935a57(0xba0),_0x58b396[_0x935a57(0x461)]=_0x935a57(0x543),_0x58b396['id']=_0x935a57(0xdc6)+_0xf783c+'-'+_0x24762f,_0x58b396['value']=_0x24762f,_0x58b396[_0x935a57(0x655)][_0x935a57(0x2b6)]=_0x935a57(0xa70);if(_0x24762f===0x0)_0x58b396[_0x935a57(0x2a3)]=!![];const _0x1894c0=document[_0x935a57(0xe1b)](_0x935a57(0x558));_0x1894c0[_0x935a57(0x37c)]=_0x935a57(0xdc6)+_0xf783c+'-'+_0x24762f,_0x1894c0[_0x935a57(0x138e)]=_0x526362['name'],_0x1894c0[_0x935a57(0x655)][_0x935a57(0x1ae)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4d1a31[_0x935a57(0xe91)](_0x58b396),_0x4d1a31[_0x935a57(0xe91)](_0x1894c0);});const _0x41c628=()=>{const _0x1a7165=_0x278bda,_0x121a20=_0x4d1a31[_0x1a7165(0x89c)](_0x1a7165(0x528));_0x4d1a31[_0x1a7165(0x400)](_0x1a7165(0x558))[_0x1a7165(0x19c)](_0x3b6870=>{const _0x3bc4e7=_0x1a7165;_0x3b6870[_0x3bc4e7(0x655)][_0x3bc4e7(0x6f2)]=_0x3bc4e7(0x29e),_0x3b6870[_0x3bc4e7(0x655)][_0x3bc4e7(0x1081)]='#333',_0x3b6870[_0x3bc4e7(0x655)][_0x3bc4e7(0x8fc)]='white';});if(_0x121a20){const _0xe25d8a=_0x4d1a31[_0x1a7165(0x89c)](_0x1a7165(0x785)+_0x121a20['id']+'\x22]');_0xe25d8a[_0x1a7165(0x655)][_0x1a7165(0x6f2)]=_0x1a7165(0x913),_0xe25d8a[_0x1a7165(0x655)]['color']='var(--accent-color)',_0xe25d8a[_0x1a7165(0x655)][_0x1a7165(0x8fc)]='#e7f3ff';const _0x5e5dc1=_0x98555d[_0x1a7165(0xade)][parseInt(_0x121a20['value'])];document['getElementById'](_0x1a7165(0xd0e))[_0x1a7165(0x138e)]='¥'+_0x5e5dc1[_0x1a7165(0xa19)]['toFixed'](0x2),_0x5e5dc1[_0x1a7165(0xa94)]?document[_0x1a7165(0x383)](_0x1a7165(0xa47))[_0x1a7165(0xf6c)]=_0x5e5dc1[_0x1a7165(0xa94)]:document[_0x1a7165(0x383)](_0x1a7165(0xa47))[_0x1a7165(0xf6c)]=_0x98555d[_0x1a7165(0xa94)];}};_0x4d1a31[_0x278bda(0x271)]('change',_0x41c628),_0x41c628(),document['getElementById'](_0x278bda(0x69d))[_0x278bda(0x138e)]='1';const _0x505aea=document['getElementById']('confirm-variation-selection-btn'),_0x3f8288=_0x505aea[_0x278bda(0x117b)](!![]);_0x505aea[_0x278bda(0x1245)][_0x278bda(0xe58)](_0x3f8288,_0x505aea),_0x3f8288['addEventListener'](_0x278bda(0x5c7),async()=>{const _0x16f6c4=_0x278bda,_0x384791=_0x4d1a31['querySelector'](_0x16f6c4(0x528)),_0xd5ce1f=parseInt(document[_0x16f6c4(0x383)]('variation-quantity-display')[_0x16f6c4(0x138e)]);if(_0x384791){const _0x958856=_0x98555d['variations'][parseInt(_0x384791[_0x16f6c4(0x1be)])];await _0x5d8470(_0xf783c,_0xd5ce1f,_0x958856),_0x485cab[_0x16f6c4(0x119a)]['remove']('visible'),await _0x296ef9('成功','已成功加入购物车！');}}),_0x485cab[_0x278bda(0x119a)][_0x278bda(0xbff)](_0x278bda(0x106d));}function _0x5d7677(){const _0x37bccf=_0x549949,_0x593b44=document['getElementById']('shopping-settings-modal');document[_0x37bccf(0x383)](_0x37bccf(0x654))[_0x37bccf(0x1be)]=_0x41df36[_0x37bccf(0xc0)][_0x37bccf(0x1fd)]||0x3,document['getElementById']('shopping-product-count-input')[_0x37bccf(0x1be)]=_0x41df36[_0x37bccf(0xc0)][_0x37bccf(0x325)]||0x8,_0x593b44[_0x37bccf(0x119a)][_0x37bccf(0xbff)](_0x37bccf(0x106d));}async function _0x3330a7(){const _0xfd93ae=_0x549949,_0x1678b9=document[_0xfd93ae(0x383)](_0xfd93ae(0x654)),_0x273e8d=document[_0xfd93ae(0x383)](_0xfd93ae(0x617)),_0x4b1d03=parseInt(_0x1678b9['value']),_0x2973b2=parseInt(_0x273e8d[_0xfd93ae(0x1be)]);if(isNaN(_0x4b1d03)||isNaN(_0x2973b2)||_0x4b1d03<0x1||_0x2973b2<0x1){alert(_0xfd93ae(0xe6f));return;}_0x41df36['globalSettings'][_0xfd93ae(0x1fd)]=_0x4b1d03,_0x41df36['globalSettings'][_0xfd93ae(0x325)]=_0x2973b2,await _0x342df8[_0xfd93ae(0xc0)][_0xfd93ae(0x9c0)](_0x41df36[_0xfd93ae(0xc0)]),document[_0xfd93ae(0x383)](_0xfd93ae(0x71e))['classList'][_0xfd93ae(0x131d)](_0xfd93ae(0x106d)),await _0x296ef9(_0xfd93ae(0x1319),_0xfd93ae(0xfed));}async function _0x55c915(){const _0x10ebb2=_0x549949;if(!_0x41df36[_0x10ebb2(0xfc5)]){await _0x296ef9(_0x10ebb2(0xa55),'请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。');return;}const _0x3a4b62=_0x41df36[_0x10ebb2(0x864)][_0x41df36[_0x10ebb2(0xfc5)]],_0xd86a42=await _0x23a88b('为“'+_0x3a4b62['name']+_0x10ebb2(0xc6f),'此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？',{'confirmText':_0x10ebb2(0x100b)});if(!_0xd86a42)return;await _0x296ef9(_0x10ebb2(0x4a6),_0x10ebb2(0x629)+_0x3a4b62[_0x10ebb2(0x461)]+_0x10ebb2(0x1309));const _0x472819=_0x41df36[_0x10ebb2(0x673)]['secondaryProxyUrl']&&_0x41df36[_0x10ebb2(0x673)][_0x10ebb2(0x1135)]&&_0x41df36[_0x10ebb2(0x673)][_0x10ebb2(0x782)],{proxyUrl:_0x4fa5f9,apiKey:_0x17cc9,model:_0xf5db17}=_0x472819?{'proxyUrl':_0x41df36[_0x10ebb2(0x673)][_0x10ebb2(0xabf)],'apiKey':_0x41df36[_0x10ebb2(0x673)][_0x10ebb2(0x1135)],'model':_0x41df36['apiConfig'][_0x10ebb2(0x782)]}:_0x41df36[_0x10ebb2(0x673)];if(!_0x4fa5f9||!_0x17cc9||!_0xf5db17){await _0x296ef9(_0x10ebb2(0x3f1),_0x10ebb2(0xb6f));return;}const _0x30f6c4=_0x41df36['globalSettings'][_0x10ebb2(0x1fd)]||0x3,_0x2c197c=_0x41df36['globalSettings']['shoppingProductCount']||0x8,_0x4f9a4=await _0x342df8[_0x10ebb2(0x8c2)][_0x10ebb2(0x21f)]();let _0x4846d7='';_0x4f9a4[_0x10ebb2(0xfde)]>0x0&&(_0x4846d7=_0x10ebb2(0x481)+_0x4f9a4[_0x10ebb2(0xa79)](_0x418132=>'\x22'+_0x418132['name']+'\x22')[_0x10ebb2(0xa35)](',\x20')+']\x0a');const _0xf75e86=_0x41df36['qzoneSettings'][_0x10ebb2(0xabb)]||'我',_0x53a1d0=_0x3a4b62[_0x10ebb2(0x1349)]&&_0x3a4b62['longTermMemory'][_0x10ebb2(0xfde)]>0x0?_0x3a4b62['longTermMemory'][_0x10ebb2(0xa79)](_0x1539ce=>'-\x20(记录于\x20'+_0xa3fdac(_0x1539ce[_0x10ebb2(0x3b7)])+')\x20'+_0x1539ce[_0x10ebb2(0x11b6)])['join']('\x0a'):'无',_0x567e5a=_0x3a4b62[_0x10ebb2(0xd08)][_0x10ebb2(0x1368)](-0xa)[_0x10ebb2(0xa79)](_0x4a7487=>(_0x4a7487[_0x10ebb2(0x10ff)]===_0x10ebb2(0x66e)?_0xf75e86:_0x3a4b62['name'])+':\x20'+String(_0x4a7487[_0x10ebb2(0x11b6)])[_0x10ebb2(0xba5)](0x0,0x1e)+'...')[_0x10ebb2(0xa35)]('\x0a');let _0x324391='';if(_0x3a4b62[_0x10ebb2(0x886)]['linkedWorldBookIds']&&_0x3a4b62[_0x10ebb2(0x886)][_0x10ebb2(0xe8c)][_0x10ebb2(0xfde)]>0x0){const _0x1ecb13=_0x3a4b62[_0x10ebb2(0x886)][_0x10ebb2(0xe8c)][_0x10ebb2(0xa79)](_0x39c872=>{const _0x4370c3=_0x10ebb2,_0x1c8070=_0x41df36[_0x4370c3(0xf17)][_0x4370c3(0xd12)](_0xf29260=>_0xf29260['id']===_0x39c872);if(!_0x1c8070||!Array['isArray'](_0x1c8070['content']))return'';const _0x140588=_0x1c8070[_0x4370c3(0x11b6)][_0x4370c3(0x98a)](_0x176602=>_0x176602['enabled']!==![])[_0x4370c3(0xa79)](_0x24857a=>'-\x20'+_0x24857a['content'])['join']('\x0a');return _0x140588?'\x0a##\x20来自《'+_0x1c8070[_0x4370c3(0x461)]+_0x4370c3(0x18c)+_0x140588:'';})['filter'](Boolean)['join']('');_0x1ecb13&&(_0x324391=_0x10ebb2(0x62b)+_0x1ecb13+'\x0a');}const _0x4c28db=_0x10ebb2(0xcc8)+_0x3a4b62['name']+_0x10ebb2(0x10be)+_0x30f6c4+'\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20'+_0x2c197c+'\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20'+_0x3a4b62[_0x10ebb2(0x461)]+_0x10ebb2(0x12d2)+_0x3a4b62[_0x10ebb2(0x886)][_0x10ebb2(0xd83)]+_0x10ebb2(0x5f5)+_0x53a1d0+'\x0a-\x20**世界书设定**:\x20'+_0x324391+'\x0a'+_0x4846d7+_0x10ebb2(0x5c9)+_0x567e5a+_0x10ebb2(0x769)+_0x3a4b62[_0x10ebb2(0x461)]+_0x10ebb2(0xcc5);try{const _0x55b424=[{'role':'user','content':_0x10ebb2(0x101b)}];let _0x5aee75=_0x4fa5f9[_0x10ebb2(0xee2)](_0x10ebb2(0xdc3)),_0x275728=_0x112768(_0xf5db17,_0x17cc9,_0x4c28db,_0x55b424);const _0x3715ef=_0x5aee75?await fetch(_0x275728[_0x10ebb2(0x2fa)],_0x275728['data']):await fetch(_0x4fa5f9+_0x10ebb2(0x126b),{'method':_0x10ebb2(0x94f),'headers':{'Content-Type':_0x10ebb2(0x11f0),'Authorization':'Bearer\x20'+_0x17cc9},'body':JSON['stringify']({'model':_0xf5db17,'messages':[{'role':_0x10ebb2(0xb1),'content':_0x4c28db},..._0x55b424],'temperature':_0x41df36['globalSettings'][_0x10ebb2(0xa4a)]||0.9})});if(!_0x3715ef['ok'])throw new Error('API\x20错误:\x20'+_0x3715ef[_0x10ebb2(0x3ea)]);const _0x484b4c=await _0x3715ef['json'](),_0x367e59=getGeminiResponseText(_0x484b4c),_0x45c0e9=_0x367e59[_0x10ebb2(0x22e)](/({[\s\S]*})/);if(!_0x45c0e9)throw new Error(_0x10ebb2(0x5ab));const _0x1197c6=JSON[_0x10ebb2(0x134)](_0x45c0e9[0x0]);if(!_0x1197c6[_0x10ebb2(0xe30)]||!Array[_0x10ebb2(0x565)](_0x1197c6[_0x10ebb2(0xe30)]))throw new Error(_0x10ebb2(0x148));await _0x342df8[_0x10ebb2(0xe17)]('rw',_0x342df8[_0x10ebb2(0xd18)],_0x342df8['shoppingCategories'],async()=>{const _0x3c0de3=_0x10ebb2;for(const _0x5ea9aa of _0x1197c6[_0x3c0de3(0xe30)]){let _0x29ce5e;const _0x427f18=await _0x342df8[_0x3c0de3(0x8c2)][_0x3c0de3(0x6bd)](_0x3c0de3(0x461))[_0x3c0de3(0x10c2)](_0x5ea9aa['name'])[_0x3c0de3(0x26e)]();_0x427f18?_0x29ce5e=_0x427f18['id']:_0x29ce5e=await _0x342df8[_0x3c0de3(0x8c2)][_0x3c0de3(0xbff)]({'name':_0x5ea9aa[_0x3c0de3(0x461)]});const _0x11ef74=_0x5ea9aa['products']['map'](_0x506f08=>{const _0x4c4f53=_0x3c0de3;return{'name':_0x506f08[_0x4c4f53(0x461)],'price':_0x506f08[_0x4c4f53(0xa19)]||0x0,'description':_0x506f08['description']||'','imageUrl':_0x4c4f53(0x5c1)+encodeURIComponent(_0x506f08[_0x4c4f53(0x8d8)]),'variations':(_0x506f08[_0x4c4f53(0xade)]||[])['map'](_0x4ff480=>({..._0x4ff480,'imageUrl':_0x4c4f53(0x5c1)+encodeURIComponent(_0x4ff480['image_prompt'])})),'categoryId':_0x29ce5e};});_0x11ef74[_0x3c0de3(0xfde)]>0x0&&await _0x342df8['shoppingProducts'][_0x3c0de3(0x1391)](_0x11ef74);}}),activeShoppingCategoryId=_0x10ebb2(0x1282),await _0x568766(),await _0x296ef9(_0x10ebb2(0x92),'为“'+_0x3a4b62['name']+_0x10ebb2(0x3e7));}catch(_0x452098){console[_0x10ebb2(0x98)](_0x10ebb2(0xc1c),_0x452098),await _0x296ef9(_0x10ebb2(0x91e),_0x10ebb2(0xe01)+_0x452098['message']);}}async function _0x17475f(_0x299a27){const _0x2022db=_0x549949,_0x8ecd22=document[_0x2022db(0x383)](_0x299a27);if(!_0x8ecd22)return;const _0x32ef30=await _0x2d60a4(_0x2022db(0x11ad),[{'text':_0x2022db(0x107c),'value':_0x2022db(0x30b)},{'text':_0x2022db(0xc61),'value':_0x2022db(0x2fa)}]);let _0x16d917=null;if(_0x32ef30===_0x2022db(0x30b))_0x16d917=await _0x20227a();else _0x32ef30===_0x2022db(0x2fa)&&(_0x16d917=await _0x12e332('更换图片',_0x2022db(0x54e),_0x8ecd22[_0x2022db(0xf6c)],_0x2022db(0x2fa)));if(_0x16d917&&_0x16d917[_0x2022db(0x1cb)]()){const _0x3b8b5b=_0x16d917[_0x2022db(0x1cb)]();_0x8ecd22[_0x2022db(0xf6c)]=_0x3b8b5b,!_0x41df36[_0x2022db(0xc0)][_0x2022db(0x5ec)]&&(_0x41df36[_0x2022db(0xc0)][_0x2022db(0x5ec)]={}),_0x41df36['globalSettings'][_0x2022db(0x5ec)][_0x299a27]=_0x3b8b5b,await _0x342df8[_0x2022db(0xc0)]['put'](_0x41df36[_0x2022db(0xc0)]),await _0x296ef9('成功','组件图片已更新！');}}window[_0x549949(0x80e)]=_0x17475f;async function _0x34afcf(){const _0x51fd5b=_0x549949;if(!window[_0x51fd5b(0x4c7)]){alert(_0x51fd5b(0x1352));return;}await _0x296ef9(_0x51fd5b(0xddc),_0x51fd5b(0xb95));const _0xce33ec=streamSaver[_0x51fd5b(0xe59)](_0x51fd5b(0x11d7)+new Date()[_0x51fd5b(0x226)]()[_0x51fd5b(0x105d)]('T')[0x0]+_0x51fd5b(0xd33)),_0x1242cf=_0xce33ec[_0x51fd5b(0xd5)](),_0x32814d=new TextEncoder();try{await _0x1242cf['write'](_0x32814d['encode'](_0x51fd5b(0x58d)+Date['now']()+_0x51fd5b(0xc88)));const _0x45d782=await _0x342df8[_0x51fd5b(0x10ef)][_0x51fd5b(0xa79)](_0x1cc549=>_0x1cc549[_0x51fd5b(0x461)]);for(let _0x2da124=0x0;_0x2da124<_0x45d782[_0x51fd5b(0xfde)];_0x2da124++){const _0x5b8107=_0x45d782[_0x2da124],_0x3d5212=_0x342df8[_0x51fd5b(0xac)](_0x5b8107);await _0x1242cf['write'](_0x32814d['encode']('\x22'+_0x5b8107+'\x22:\x20[\x0a'));let _0x27280a=!![];await _0x3d5212[_0x51fd5b(0x193)](_0x101801=>{const _0xd72e2=_0x51fd5b;!_0x27280a&&_0x1242cf[_0xd72e2(0x111d)](_0x32814d[_0xd72e2(0x569)](',\x0a')),_0x1242cf[_0xd72e2(0x111d)](_0x32814d[_0xd72e2(0x569)](JSON[_0xd72e2(0x3fb)](_0x101801))),_0x27280a=![];}),await _0x1242cf['write'](_0x32814d[_0x51fd5b(0x569)]('\x0a]')),_0x2da124<_0x45d782['length']-0x1&&await _0x1242cf['write'](_0x32814d[_0x51fd5b(0x569)](',\x0a'));}await _0x1242cf['write'](_0x32814d[_0x51fd5b(0x569)]('\x0a}\x0a}'));}catch(_0x51327d){console[_0x51fd5b(0x98)]('流式导出过程中出错:',_0x51327d),await _0x296ef9(_0x51fd5b(0xf11),_0x51fd5b(0x592)+_0x51327d[_0x51fd5b(0x5f8)]);}finally{await _0x1242cf[_0x51fd5b(0x695)]();}}async function _0x3cbc72(){const _0x26f2b6=_0x549949;await _0x296ef9(_0x26f2b6(0xddc),_0x26f2b6(0xced));try{const _0x33d1b0={'version':0x3,'timestamp':Date[_0x26f2b6(0x108d)](),'data':{}},_0x2a3478=_0x342df8[_0x26f2b6(0x10ef)][_0x26f2b6(0xa79)](_0x58001f=>_0x58001f['name']);for(const _0x4ef99f of _0x2a3478){const _0x4295ba=await _0x342df8[_0x26f2b6(0xac)](_0x4ef99f)[_0x26f2b6(0x21f)]();_0x33d1b0[_0x26f2b6(0x8c6)][_0x4ef99f]=_0x4295ba,console[_0x26f2b6(0xe72)](_0x26f2b6(0x1204)+_0x4ef99f+',\x20记录数:\x20'+_0x4295ba[_0x26f2b6(0xfde)]);}const _0x29b802=new Blob([JSON[_0x26f2b6(0x3fb)](_0x33d1b0,null,0x2)],{'type':_0x26f2b6(0x11f0)}),_0x251409=URL[_0x26f2b6(0x679)](_0x29b802),_0x495f68=document[_0x26f2b6(0xe1b)]('a');_0x495f68['href']=_0x251409,_0x495f68[_0x26f2b6(0x110e)]=_0x26f2b6(0x4a7)+new Date()[_0x26f2b6(0x226)]()[_0x26f2b6(0x105d)]('T')[0x0]+'.json',_0x495f68[_0x26f2b6(0x5c7)](),URL[_0x26f2b6(0x119d)](_0x251409),await _0x296ef9(_0x26f2b6(0x1ec),'已成功导出所有数据！');}catch(_0xebbaf4){console[_0x26f2b6(0x98)]('传统导出数据时出错:',_0xebbaf4),await _0x296ef9(_0x26f2b6(0xf11),_0x26f2b6(0x842)+_0xebbaf4[_0x26f2b6(0x5f8)]);}}function _0x44666e(){const _0x560691=_0x549949,_0xb84523=Object[_0x560691(0x76d)](_0x41df36['chats'])['reduce']((_0x26a792,_0x1065c7)=>{const _0x2e4bd5=_0x560691;if(_0x1065c7['id']===_0x41df36[_0x2e4bd5(0xfc5)])return _0x26a792;return _0x26a792+(_0x1065c7[_0x2e4bd5(0x40c)]||0x0);},0x0),_0xd10704=_0x3a006f||0x0,_0xf7aace=_0xb84523+_0xd10704,_0x21b5b9=document[_0x560691(0x383)](_0x560691(0x928));if(!_0x21b5b9)return;let _0x1537a6=_0x21b5b9[_0x560691(0x89c)](_0x560691(0x807));!_0x1537a6&&(_0x1537a6=document[_0x560691(0xe1b)](_0x560691(0xc0e)),_0x1537a6[_0x560691(0x556)]=_0x560691(0x35c),_0x21b5b9[_0x560691(0xe91)](_0x1537a6));let _0x247501=_0x21b5b9[_0x560691(0x89c)](_0x560691(0xa4b));_0x247501&&_0x247501[_0x560691(0x131d)](),_0xf7aace>0x0?(_0x1537a6['textContent']=_0xf7aace>0x63?_0x560691(0xe95):_0xf7aace,_0x1537a6[_0x560691(0x655)][_0x560691(0x2b6)]=_0x560691(0x27a),_0x1537a6[_0x560691(0x655)]['zIndex']='20',_0x1537a6[_0x560691(0x655)][_0x560691(0x923)]=_0x560691(0x10ab)):_0x1537a6[_0x560691(0x655)]['display']=_0x560691(0xa70);}async function _0x1d0617(_0x24725c){const _0x1279af=_0x549949,_0x4e71e7=_0x24725c===_0x1279af(0x1289)?{'id':_0x1279af(0x1289),'name':_0x1279af(0xaac)}:await _0x342df8[_0x1279af(0x72d)][_0x1279af(0x1a3)](_0x24725c);if(!_0x4e71e7){console[_0x1279af(0x98)](_0x1279af(0x485),_0x24725c);return;}const _0x1ba26d=document[_0x1279af(0x383)](_0x1279af(0xc9e)),_0x842d5a=document[_0x1279af(0x383)](_0x1279af(0x5bb)),_0xf5a1da=_0x1ba26d[_0x1279af(0x89c)]('.modal-header\x20span');_0x842d5a['innerHTML']='',_0xf5a1da['textContent']=_0x1279af(0x92b)+_0x4e71e7['name']+_0x1279af(0x790);const _0x3290d6=Object[_0x1279af(0x76d)](_0x41df36['chats'])[_0x1279af(0x1296)]((_0x2221a7,_0x9fa090)=>_0x2221a7['name'][_0x1279af(0x697)](_0x9fa090[_0x1279af(0x461)],_0x1279af(0xafb)));_0x3290d6['forEach'](_0x29a072=>{const _0x5208d9=_0x1279af,_0x36bc66=Array['isArray'](_0x29a072['settings']?.['stickerCategoryIds'])&&_0x29a072[_0x5208d9(0x886)][_0x5208d9(0x121a)]['includes'](_0x24725c),_0x4239ee=document[_0x5208d9(0xe1b)](_0x5208d9(0x7fd));_0x4239ee[_0x5208d9(0x556)]=_0x5208d9(0x136c),_0x4239ee[_0x5208d9(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22sticker-binding-checkbox\x22\x20data-chat-id=\x22'+_0x29a072['id']+'\x22\x20'+(_0x36bc66?_0x5208d9(0x2a3):'')+_0x5208d9(0xcc6)+(_0x29a072[_0x5208d9(0x1a2)]?_0x29a072[_0x5208d9(0x886)][_0x5208d9(0x332)]:_0x29a072['settings']['aiAvatar']||_0x5dc108)+_0x5208d9(0x12b2)+_0x29a072['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x842d5a[_0x5208d9(0xe91)](_0x4239ee);}),document[_0x1279af(0x383)](_0x1279af(0x137f))[_0x1279af(0xc50)]=()=>_0x42d3f4(_0x24725c),document[_0x1279af(0x383)](_0x1279af(0xfb1))['onclick']=()=>_0x1ba26d[_0x1279af(0x119a)][_0x1279af(0x131d)]('visible'),_0x1ba26d[_0x1279af(0x119a)][_0x1279af(0xbff)]('visible');}async function _0x42d3f4(_0x39d658){const _0x481b62=_0x549949,_0x1cd5e8=new Set(Array[_0x481b62(0x365)](document[_0x481b62(0x400)](_0x481b62(0x8e9)))[_0x481b62(0xa79)](_0x411d3d=>_0x411d3d[_0x481b62(0x118)][_0x481b62(0xa65)])),_0x4a4fe2=[];for(const _0x3b8a12 in _0x41df36[_0x481b62(0x864)]){const _0x2ebc83=_0x41df36[_0x481b62(0x864)][_0x3b8a12];!Array[_0x481b62(0x565)](_0x2ebc83[_0x481b62(0x886)][_0x481b62(0x121a)])&&(_0x2ebc83[_0x481b62(0x886)]['stickerCategoryIds']=[]);const _0x2f4c7e=_0x2ebc83[_0x481b62(0x886)]['stickerCategoryIds'][_0x481b62(0xee2)](_0x39d658),_0x375cb5=_0x1cd5e8[_0x481b62(0xcde)](_0x3b8a12);if(_0x2f4c7e&&!_0x375cb5)_0x2ebc83[_0x481b62(0x886)]['stickerCategoryIds']=_0x2ebc83[_0x481b62(0x886)][_0x481b62(0x121a)][_0x481b62(0x98a)](_0x1b52f7=>_0x1b52f7!==_0x39d658),_0x4a4fe2[_0x481b62(0x258)](_0x2ebc83);else!_0x2f4c7e&&_0x375cb5&&(_0x2ebc83[_0x481b62(0x886)][_0x481b62(0x121a)][_0x481b62(0x258)](_0x39d658),_0x4a4fe2[_0x481b62(0x258)](_0x2ebc83));}_0x4a4fe2[_0x481b62(0xfde)]>0x0&&(await _0x342df8[_0x481b62(0x864)][_0x481b62(0xb8d)](_0x4a4fe2),await _0x296ef9('保存成功',_0x481b62(0x6b5))),document[_0x481b62(0x383)](_0x481b62(0xc9e))[_0x481b62(0x119a)][_0x481b62(0x131d)](_0x481b62(0x106d));}function _0xd83680(_0x23cab6){const _0x2835b9=_0x549949;if(!_0x23cab6||!_0x23cab6['settings'][_0x2835b9(0x121a)]||_0x23cab6[_0x2835b9(0x886)][_0x2835b9(0x121a)][_0x2835b9(0xfde)]===0x0)return'';const _0x473849=_0x23cab6[_0x2835b9(0x886)]['stickerCategoryIds'];let _0x4457aa=[];const _0x425fae=new Set();_0x473849[_0x2835b9(0x19c)](_0x913df9=>{const _0x13cc2e=_0x2835b9;let _0x3695bb;_0x913df9===_0x13cc2e(0x1289)?_0x3695bb=_0x41df36[_0x13cc2e(0x823)][_0x13cc2e(0x98a)](_0x207d91=>!_0x207d91[_0x13cc2e(0xba3)]):_0x3695bb=_0x41df36[_0x13cc2e(0x823)]['filter'](_0x35ab55=>_0x35ab55[_0x13cc2e(0xba3)]===_0x913df9),_0x3695bb[_0x13cc2e(0x19c)](_0x342350=>{const _0x22f276=_0x13cc2e;!_0x425fae[_0x22f276(0xcde)](_0x342350[_0x22f276(0x461)])&&(_0x4457aa[_0x22f276(0x258)](_0x342350),_0x425fae[_0x22f276(0xbff)](_0x342350[_0x22f276(0x461)]));});});if(_0x4457aa[_0x2835b9(0xfde)]===0x0)return'';const _0x491dfd=_0x4457aa['map'](_0x580fc0=>'-\x20'+_0x580fc0[_0x2835b9(0x461)])[_0x2835b9(0xa35)]('\x0a');return _0x2835b9(0xed3)+_0x491dfd+'\x0a';}function _0x37dbe7(_0x3ff7d1){const _0x47faab=_0x549949;if(!_0x3ff7d1||!_0x3ff7d1[_0x47faab(0x1a2)])return'';let _0x242d5c=_0x47faab(0x1331),_0x3a6e59=![];return _0x3ff7d1[_0x47faab(0x12a6)][_0x47faab(0x19c)](_0x2b7799=>{const _0x27ef55=_0x47faab;if(_0x2b7799['id']===_0x27ef55(0x66e))return;const _0x1918bc=_0x41df36['chats'][_0x2b7799['id']];if(_0x1918bc&&_0x1918bc['settings'][_0x27ef55(0x121a)]&&_0x1918bc[_0x27ef55(0x886)][_0x27ef55(0x121a)]['length']>0x0){const _0x17f18d=_0x1918bc[_0x27ef55(0x886)][_0x27ef55(0x121a)];let _0xdc5ddb=[];const _0x59d34f=new Set();_0x17f18d[_0x27ef55(0x19c)](_0x2a46d7=>{const _0x52889c=_0x27ef55;let _0x32201e;_0x2a46d7===_0x52889c(0x1289)?_0x32201e=_0x41df36['userStickers'][_0x52889c(0x98a)](_0x3d0e24=>!_0x3d0e24[_0x52889c(0xba3)]):_0x32201e=_0x41df36[_0x52889c(0x823)][_0x52889c(0x98a)](_0x1458a8=>_0x1458a8[_0x52889c(0xba3)]===_0x2a46d7),_0x32201e[_0x52889c(0x19c)](_0x2130f2=>{const _0x578e73=_0x52889c;!_0x59d34f['has'](_0x2130f2[_0x578e73(0x461)])&&(_0xdc5ddb[_0x578e73(0x258)](_0x2130f2),_0x59d34f[_0x578e73(0xbff)](_0x2130f2[_0x578e73(0x461)]));});}),_0xdc5ddb[_0x27ef55(0xfde)]>0x0&&(_0x3a6e59=!![],_0x242d5c+=_0x27ef55(0x606)+_0x2b7799[_0x27ef55(0x9da)]+_0x27ef55(0xcac)+_0x2b7799[_0x27ef55(0x283)]+_0x27ef55(0x6ac),_0x242d5c+=_0xdc5ddb['map'](_0x44a094=>'-\x20'+_0x44a094[_0x27ef55(0x461)])[_0x27ef55(0xa35)]('\x0a'));}}),_0x3a6e59?_0x242d5c:'';}function _0x27d449(_0x2e367f){if(!_0x2e367f)return 0x0;return Math['ceil'](_0x2e367f['length']/1.5);}async function _0x161090(){const _0x3d5fbd=_0x549949;if(!_0x41df36['activeChatId'])return 0x0;const _0x25c0f8=_0x41df36[_0x3d5fbd(0x864)][_0x41df36[_0x3d5fbd(0xfc5)]];if(!_0x25c0f8)return 0x0;const _0x2f6811=parseInt(document['getElementById'](_0x3d5fbd(0xef0))[_0x3d5fbd(0x1be)])||0xa,_0x22b6f2=parseInt(document[_0x3d5fbd(0x383)](_0x3d5fbd(0x76e))[_0x3d5fbd(0x1be)])||0xa,_0x204ffd=document[_0x3d5fbd(0x383)](_0x3d5fbd(0x7c2))[_0x3d5fbd(0x2a3)],_0x329bb3=document[_0x3d5fbd(0x383)](_0x3d5fbd(0x36e))[_0x3d5fbd(0x1be)],_0x5d46d6=document[_0x3d5fbd(0x383)](_0x3d5fbd(0x41b))[_0x3d5fbd(0x1be)];let _0x5a6234='';const _0x2db3bf=Array[_0x3d5fbd(0x365)](document[_0x3d5fbd(0x400)]('#world-book-checkboxes-container\x20input:checked'))[_0x3d5fbd(0xa79)](_0x1f97db=>_0x1f97db[_0x3d5fbd(0x1be)][_0x3d5fbd(0x709)]('book_',''));if(_0x2db3bf[_0x3d5fbd(0xfde)]>0x0){const _0x18b57e=_0x2db3bf[_0x3d5fbd(0xa79)](_0x12e883=>{const _0x5a5702=_0x3d5fbd,_0x1a7e18=_0x41df36[_0x5a5702(0xf17)]['find'](_0x461054=>_0x461054['id']===_0x12e883);if(!_0x1a7e18||!Array[_0x5a5702(0x565)](_0x1a7e18[_0x5a5702(0x11b6)]))return'';return _0x1a7e18['content'][_0x5a5702(0x98a)](_0x2781ee=>_0x2781ee[_0x5a5702(0x8e4)]!==![])[_0x5a5702(0xa79)](_0x2449eb=>_0x2449eb['content'])[_0x5a5702(0xa35)]('\x0a');})['filter'](Boolean)[_0x3d5fbd(0xa35)]('\x0a');_0x5a6234+=_0x18b57e;}_0x25c0f8[_0x3d5fbd(0x1349)]&&_0x25c0f8[_0x3d5fbd(0x1349)]['length']>0x0&&(_0x5a6234+=_0x25c0f8[_0x3d5fbd(0x1349)][_0x3d5fbd(0xa79)](_0x2ebc44=>_0x2ebc44[_0x3d5fbd(0x11b6)])[_0x3d5fbd(0xa35)]('\x0a'));const _0x2698b0=document['getElementById'](_0x3d5fbd(0x1080))[_0x3d5fbd(0x2a3)];if(_0x2698b0){const _0x458372=Array['from'](document[_0x3d5fbd(0x400)](_0x3d5fbd(0xd20)))[_0x3d5fbd(0xa79)](_0x5d4de1=>_0x5d4de1[_0x3d5fbd(0x1be)]);for(const _0x5e4c5c of _0x458372){const _0x488957=_0x41df36[_0x3d5fbd(0x864)][_0x5e4c5c];_0x488957&&_0x488957['history'][_0x3d5fbd(0xfde)]>0x0&&(_0x5a6234+=_0x488957[_0x3d5fbd(0xd08)][_0x3d5fbd(0x1368)](-_0x22b6f2)[_0x3d5fbd(0xa79)](_0xa63685=>String(_0xa63685[_0x3d5fbd(0x11b6)]))[_0x3d5fbd(0xa35)]('\x0a'));}}_0x25c0f8['isGroup']?_0x25c0f8[_0x3d5fbd(0x12a6)]['forEach'](_0x282f66=>{const _0x5f4af8=_0x3d5fbd;_0x5a6234+=_0x282f66[_0x5f4af8(0x48c)];}):_0x5a6234+=_0x329bb3;_0x5a6234+=_0x5d46d6,_0x5a6234+=_0xd83680(_0x25c0f8);_0x25c0f8[_0x3d5fbd(0x1a2)]&&(_0x5a6234+=_0x37dbe7(_0x25c0f8));if(!_0x25c0f8['isGroup']&&_0x204ffd){const _0x2b8596=document['getElementById']('offline-preset-select')[_0x3d5fbd(0x1be)];if(_0x2b8596){const _0x5e8eb1=_0x41df36['presets'][_0x3d5fbd(0xd12)](_0x587099=>_0x587099['id']===_0x2b8596);_0x5e8eb1&&(_0x5a6234+=_0x5e8eb1[_0x3d5fbd(0x11b6)]['filter'](_0x405a66=>_0x405a66[_0x3d5fbd(0x8e4)]!==![])['map'](_0x5c82a9=>_0x5c82a9[_0x3d5fbd(0x11b6)])['join']('\x0a'));}}const _0x4064a2=_0x25c0f8['history']['slice'](-_0x2f6811);return _0x5a6234+=_0x4064a2[_0x3d5fbd(0xa79)](_0x4da204=>{const _0x1c9883=_0x3d5fbd;if(typeof _0x4da204[_0x1c9883(0x11b6)]===_0x1c9883(0xafa))return _0x4da204[_0x1c9883(0x11b6)];if(Array[_0x1c9883(0x565)](_0x4da204[_0x1c9883(0x11b6)]))return _0x4da204['content'][_0x1c9883(0xa79)](_0x35d1d3=>_0x35d1d3[_0x1c9883(0x6af)])[_0x1c9883(0xa35)]('\x20');return'';})[_0x3d5fbd(0xa35)]('\x0a'),_0x27d449(_0x5a6234);}const _0x6473ce=_0x126ee3(async()=>{const _0xd930db=_0x549949,_0x2fc12a=document[_0xd930db(0x383)](_0xd930db(0x10aa));if(!_0x2fc12a)return;_0x2fc12a[_0xd930db(0x45c)]=_0xd930db(0x11da);try{const _0x28efe1=await _0x161090();_0x2fc12a[_0xd930db(0x45c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22><strong>\x20'+_0x28efe1+_0xd930db(0x3d7);}catch(_0x57937e){console['error'](_0xd930db(0x12ab),_0x57937e),_0x2fc12a['innerHTML']=_0xd930db(0x97b);}},0x12c);async function _0x14af41(){const _0x12aa56=_0x549949;initLanguage();async function _0x50dcfd(_0x42b17b){const _0x50954a=_0x42ed;if(!_0x42b17b)return;try{const _0x388664=await _0x42b17b['text'](),_0x1bd38d=JSON[_0x50954a(0x134)](_0x388664);if(_0x1bd38d[_0x50954a(0xa6b)]===_0x50954a(0x1c2))console[_0x50954a(0xe72)]('检测到\x20EPhone\x20备份文件，执行标准导入...'),await _0x175dc5(_0x1bd38d);else{if(_0x1bd38d['entries']&&typeof _0x1bd38d[_0x50954a(0x329)]===_0x50954a(0x890))console[_0x50954a(0xe72)](_0x50954a(0xc39)),await _0x4147dc(_0x1bd38d,_0x42b17b['name']);else throw new Error(_0x50954a(0x377));}}catch(_0x5d758c){console['error']('导入世界书时出错:',_0x5d758c),await _0x296ef9(_0x50954a(0x108e),'文件解析或应用失败:\x20'+_0x5d758c['message']);}}async function _0x4147dc(_0xab8e11,_0x16be32){const _0x1f1794=_0x42ed,_0x275f2e=_0x16be32[_0x1f1794(0x709)](/\.json$/i,''),_0x156300=await _0x12e332(_0x1f1794(0x2ad),_0x1f1794(0xbfb),_0x275f2e);if(!_0x156300||!_0x156300[_0x1f1794(0x1cb)]()){alert(_0x1f1794(0x8b6));return;}const _0x1d6fb9=Object[_0x1f1794(0x76d)](_0xab8e11[_0x1f1794(0x329)])[_0x1f1794(0xa79)](_0x1e5a4c=>{const _0xe884f5=_0x1f1794;return{'keys':_0x1e5a4c[_0xe884f5(0x965)]||[],'comment':_0x1e5a4c['comment']||_0xe884f5(0x138b),'content':_0x1e5a4c[_0xe884f5(0x11b6)]||'','enabled':!_0x1e5a4c[_0xe884f5(0xc93)]};})['filter'](_0x462f2b=>_0x462f2b['content']);if(_0x1d6fb9[_0x1f1794(0xfde)]===0x0){alert('这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。');return;}const _0x20d237={'id':'wb_'+Date[_0x1f1794(0x108d)](),'name':_0x156300['trim'](),'content':_0x1d6fb9,'categoryId':null};await _0x342df8[_0x1f1794(0xf17)][_0x1f1794(0xbff)](_0x20d237),_0x41df36[_0x1f1794(0xf17)][_0x1f1794(0x258)](_0x20d237),await _0x11e574(),await _0x296ef9(_0x1f1794(0xc89),'已成功从\x20Tavern\x20AI\x20文件导入设定集《'+_0x156300+'》。');}async function _0x386bd1(){const _0x2996de=_0x42ed;try{const _0x36734e=await _0x342df8[_0x2996de(0xf17)]['toArray'](),_0x350ba5=await _0x342df8[_0x2996de(0xa1c)]['toArray']();if(_0x36734e[_0x2996de(0xfde)]===0x0&&_0x350ba5[_0x2996de(0xfde)]===0x0){alert(_0x2996de(0xd89));return;}const _0x947ef3={'type':_0x2996de(0x1c2),'version':0x1,'timestamp':Date[_0x2996de(0x108d)](),'books':_0x36734e,'categories':_0x350ba5},_0x2933bb=new Blob([JSON[_0x2996de(0x3fb)](_0x947ef3,null,0x2)],{'type':'application/json'}),_0x56cc08=URL[_0x2996de(0x679)](_0x2933bb),_0xd6afc9=document[_0x2996de(0xe1b)]('a');_0xd6afc9[_0x2996de(0x10bc)]=_0x56cc08,_0xd6afc9[_0x2996de(0x110e)]='EPhone-WorldBooks-'+new Date()[_0x2996de(0x226)]()[_0x2996de(0x105d)]('T')[0x0]+_0x2996de(0xd33),_0xd6afc9['click'](),URL[_0x2996de(0x119d)](_0x56cc08),await _0x296ef9(_0x2996de(0x1ec),'所有世界书数据已成功导出！');}catch(_0x19ec3c){console[_0x2996de(0x98)](_0x2996de(0xc82),_0x19ec3c),await _0x296ef9(_0x2996de(0xf11),_0x2996de(0x842)+_0x19ec3c[_0x2996de(0x5f8)]);}}async function _0x175dc5(_0x10da6d){const _0x4d2014=_0x42ed;try{if(_0x10da6d[_0x4d2014(0xa6b)]!==_0x4d2014(0x1c2)||!_0x10da6d[_0x4d2014(0x6ec)])throw new Error('文件格式不正确，这不是一个有效的世界书备份文件。');const _0x54dcf2=await _0x23a88b(_0x4d2014(0xb30),'这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！',{'confirmButtonClass':_0x4d2014(0x51b),'confirmText':_0x4d2014(0xb41)});if(!_0x54dcf2)return;await _0x342df8[_0x4d2014(0xe17)]('rw',_0x342df8[_0x4d2014(0xf17)],_0x342df8[_0x4d2014(0xa1c)],async()=>{const _0x5ddd68=_0x4d2014;await _0x342df8[_0x5ddd68(0xf17)][_0x5ddd68(0x4b8)](),await _0x342df8[_0x5ddd68(0xa1c)]['clear'](),Array['isArray'](_0x10da6d[_0x5ddd68(0x6ec)])&&await _0x342df8[_0x5ddd68(0xf17)]['bulkPut'](_0x10da6d[_0x5ddd68(0x6ec)]),Array[_0x5ddd68(0x565)](_0x10da6d[_0x5ddd68(0xe30)])&&await _0x342df8['worldBookCategories']['bulkPut'](_0x10da6d[_0x5ddd68(0xe30)]);}),_0x41df36[_0x4d2014(0xf17)]=await _0x342df8['worldBooks'][_0x4d2014(0x21f)](),await _0x11e574(),await _0x296ef9(_0x4d2014(0xab0),_0x4d2014(0x1139));}catch(_0x3bbbe6){console[_0x4d2014(0x98)]('导入世界书时出错:',_0x3bbbe6),await _0x296ef9(_0x4d2014(0x108e),_0x4d2014(0x12f4)+_0x3bbbe6[_0x4d2014(0x5f8)]);}}const _0xc13372=localStorage['getItem'](_0x12aa56(0x10d1));if(_0xc13372){const _0x1dcb68=(Date[_0x12aa56(0x108d)]()-parseInt(_0xc13372))/(0x3e8*0x3c);_0x1dcb68>0x5&&_0xe7959e(_0x1dcb68);}_0x16ede2(),window['showScreen']=_0x105acd,window[_0x12aa56(0xcdd)]=_0x3d2653,window[_0x12aa56(0xc3e)]=_0x433617,window[_0x12aa56(0xb48)]=_0x2ff7af,window[_0x12aa56(0x82a)]=_0x12a6dc,window[_0x12aa56(0x10f4)]=_0x1e8884,window[_0x12aa56(0x581)]=_0x5d8965,window[_0x12aa56(0x65f)]=_0x5e2548,window[_0x12aa56(0x471)]=_0x1ffa1b;const _0x3f72c6=document[_0x12aa56(0xe1b)](_0x12aa56(0x7fd));_0x3f72c6['id']=_0x12aa56(0xcdc),_0x3f72c6['innerHTML']='<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>',document[_0x12aa56(0x383)]('sticker-panel')[_0x12aa56(0xe91)](_0x3f72c6);const _0x4a5679=document['createElement']('style');_0x4a5679['id']=_0x12aa56(0x2ba),document['head'][_0x12aa56(0xe91)](_0x4a5679),_0x438dad[_0x12aa56(0x6e6)]=document[_0x12aa56(0x383)]('qzone-sticker-panel'),_0x438dad[_0x12aa56(0xd5d)]=document[_0x12aa56(0x383)](_0x12aa56(0xebb));const _0x4bad30=localStorage[_0x12aa56(0xb2)](_0x12aa56(0xd95))||_0x12aa56(0xbf0);_0x149bc9(_0x4bad30);const _0x12e709=document[_0x12aa56(0xe1b)](_0x12aa56(0x655));_0x12e709['id']='custom-bubble-style',document['head'][_0x12aa56(0xe91)](_0x12e709);const _0x2ef689=document[_0x12aa56(0xe1b)](_0x12aa56(0x655));_0x2ef689['id']=_0x12aa56(0x1330),document[_0x12aa56(0x514)]['appendChild'](_0x2ef689),_0x5810fc('','#chat-messages',_0x12aa56(0x4ac)),_0x5810fc('',_0x12aa56(0x12dc),'preview-bubble-style'),window[_0x12aa56(0xcdd)]=_0x3d2653,window['showScreen']=_0x105acd,window[_0x12aa56(0x7b7)]=_0x25558e,window[_0x12aa56(0x3c0)]=_0x5d2ce6,window['renderWallpaperScreenProxy']=_0x446010,window['renderWorldBookScreenProxy']=_0x11e574,await _0x28f04a(),_0x2c3e8c(),await _0x3e749c(),_0x15f193(_0x41df36[_0x12aa56(0xc0)][_0x12aa56(0xf2c)]);const _0x2dd248=parseInt(localStorage['getItem']('unreadPostsCount'))||0x0;_0x4c6ee1(_0x2dd248);_0x41df36[_0x12aa56(0xc0)]&&_0x41df36[_0x12aa56(0xc0)][_0x12aa56(0x1082)]&&_0x59518a(_0x41df36[_0x12aa56(0xc0)]['fontUrl']);_0x66af34(),setInterval(_0x66af34,0x3e8*0x1e),_0x31bb8c(),_0x479a40(),_0x323732(),_0x5140bf(),document['getElementById']('rules-tabs')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0xd9a8d=>{const _0x4f52a5=_0x12aa56;_0xd9a8d[_0x4f52a5(0xfab)][_0x4f52a5(0x119a)][_0x4f52a5(0x987)](_0x4f52a5(0x1db))&&_0x179abd(_0xd9a8d[_0x4f52a5(0xfab)]['dataset'][_0x4f52a5(0xba3)]);}),document[_0x12aa56(0x383)](_0x12aa56(0x3d9))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x1e94d8(null)),document[_0x12aa56(0x383)]('cancel-rule-editor-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x274e51=_0x12aa56;document[_0x274e51(0x383)](_0x274e51(0x68c))['classList'][_0x274e51(0x131d)](_0x274e51(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0xd04))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x230241),document[_0x12aa56(0x383)]('pat-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x347ccd=_0x12aa56;if(_0x41df36[_0x347ccd(0xfc5)]&&!_0x41df36['chats'][_0x41df36['activeChatId']]['isGroup']){const _0xab997a=_0x41df36[_0x347ccd(0x864)][_0x41df36[_0x347ccd(0xfc5)]];_0x70854a(_0xab997a['id'],_0xab997a[_0x347ccd(0x283)]);}});let _0x1be83e=null;function _0x1523f2(_0x277c6d){const _0x2a0231=_0x12aa56;_0x1be83e=_0x277c6d;const _0x4a353c=_0x41df36[_0x2a0231(0x864)][_0x41df36[_0x2a0231(0xfc5)]],_0x57dec6=_0x4a353c['announcements']['find'](_0x5a6437=>_0x5a6437['id']===_0x277c6d);if(!_0x57dec6)return;const _0x15adc1=document[_0x2a0231(0x383)](_0x2a0231(0xe7a));_0x15adc1[_0x2a0231(0x138e)]=_0x57dec6['isPinned']?_0x2a0231(0x10e2):_0x2a0231(0x4cf),document[_0x2a0231(0x383)]('announcement-actions-modal')[_0x2a0231(0x119a)][_0x2a0231(0xbff)](_0x2a0231(0x106d));}async function _0x577415(){const _0xeb0f39=_0x12aa56;if(!_0x1be83e)return;const _0x53620b=_0x41df36[_0xeb0f39(0x864)][_0x41df36[_0xeb0f39(0xfc5)]],_0x4b72cd=_0x53620b[_0xeb0f39(0xd3f)][_0xeb0f39(0xd12)](_0x39f039=>_0x39f039['id']===_0x1be83e);_0x4b72cd&&(_0x4b72cd[_0xeb0f39(0x521)]=!_0x4b72cd[_0xeb0f39(0x521)],await _0x342df8[_0xeb0f39(0x864)][_0xeb0f39(0x9c0)](_0x53620b),_0x49940a()),document['getElementById'](_0xeb0f39(0x12db))[_0xeb0f39(0x119a)][_0xeb0f39(0x131d)](_0xeb0f39(0x106d));}async function _0x3ff579(){const _0xbb77a1=_0x12aa56;if(!_0x1be83e)return;const _0x903462=await _0x23a88b('确认删除',_0xbb77a1(0xb61),{'confirmButtonClass':_0xbb77a1(0x51b)});if(_0x903462){const _0x342241=_0x41df36['chats'][_0x41df36['activeChatId']];_0x342241[_0xbb77a1(0xd3f)]=_0x342241['announcements'][_0xbb77a1(0x98a)](_0x52ea03=>_0x52ea03['id']!==_0x1be83e),await _0x342df8[_0xbb77a1(0x864)]['put'](_0x342241),_0x49940a();}document[_0xbb77a1(0x383)]('announcement-actions-modal')['classList']['remove'](_0xbb77a1(0x106d));}document[_0x12aa56(0x383)](_0x12aa56(0x318))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4a895a),document[_0x12aa56(0x383)]('custom-modal-overlay')[_0x12aa56(0x271)]('click',_0x453a9c=>{if(_0x453a9c['target']===_0x107627)_0x4a895a();}),document[_0x12aa56(0x383)](_0x12aa56(0x8be))[_0x12aa56(0x271)]('click',async()=>{const _0x56efa5=_0x12aa56,_0x2a5d35=await _0x2d60a4(_0x56efa5(0xff8),[{'text':'智能导出\x20(推荐，速度快，内存占用小)','value':_0x56efa5(0x8da)},{'text':_0x56efa5(0xc6e),'value':'blob'}]);if(_0x2a5d35===_0x56efa5(0x8da))_0x34afcf();else _0x2a5d35===_0x56efa5(0x800)&&_0x3cbc72();}),document[_0x12aa56(0x383)](_0x12aa56(0x76b))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x287130),document[_0x12aa56(0x383)](_0x12aa56(0x7c2))['addEventListener'](_0x12aa56(0x173),_0x53a85a=>{const _0x2473e7=_0x12aa56;document[_0x2473e7(0x383)]('offline-mode-options')['style'][_0x2473e7(0x2b6)]=_0x53a85a['target'][_0x2473e7(0x2a3)]?'block':_0x2473e7(0xa70);}),document[_0x12aa56(0x383)](_0x12aa56(0x1192))['addEventListener'](_0x12aa56(0x5c7),()=>document[_0x12aa56(0x383)](_0x12aa56(0x93e))[_0x12aa56(0x5c7)]()),document[_0x12aa56(0x383)](_0x12aa56(0x126e))[_0x12aa56(0x271)](_0x12aa56(0x173),_0x43ad01=>{const _0x37b27c=_0x12aa56;document['getElementById'](_0x37b27c(0x2cd))[_0x37b27c(0x655)][_0x37b27c(0x2b6)]=_0x43ad01[_0x37b27c(0xfab)][_0x37b27c(0x2a3)]?_0x37b27c(0x27a):_0x37b27c(0xa70);}),document['getElementById'](_0x12aa56(0x93e))[_0x12aa56(0x271)](_0x12aa56(0x173),_0x15bf76=>_0x5b22a4(_0x15bf76[_0x12aa56(0xfab)][_0x12aa56(0x1185)][0x0])),document[_0x12aa56(0x383)]('import-card-input')['addEventListener'](_0x12aa56(0x173),_0x230986),document[_0x12aa56(0x383)]('back-to-list-btn')[_0x12aa56(0x271)]('click',()=>{const _0x535104=_0x12aa56;_0x30d5f3={},_0x5810fc('',_0x535104(0xf7d),_0x535104(0x4ac)),_0x5810fc('','#settings-preview-area','preview-bubble-style'),_0x11c2ba(),_0x41df36[_0x535104(0xfc5)]=null,_0x105acd(_0x535104(0x11f7));}),document[_0x12aa56(0x383)](_0x12aa56(0xa48))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x204ea2=_0x12aa56,_0x5237db=await _0x2d60a4(_0x204ea2(0xf5c),[{'text':_0x204ea2(0xc8),'value':_0x204ea2(0xff9)},{'text':_0x204ea2(0xb2f),'value':_0x204ea2(0xf9b)}]);if(_0x5237db===_0x204ea2(0xff9)){const _0x19fd91=await _0x12e332(_0x204ea2(0xbb1),'请输入你想为Ta设置的【备注名】(例如:\x20哥哥)');if(!_0x19fd91||!_0x19fd91[_0x204ea2(0x1cb)]())return;const _0x3923b2=await _0x12e332('创建新聊天\x20(第2/2步)',_0x204ea2(0xaf6));if(!_0x3923b2||!_0x3923b2[_0x204ea2(0x1cb)]())return;const _0x24a20c=_0x204ea2(0x1197)+Date[_0x204ea2(0x108d)](),_0x2f530b={'id':_0x24a20c,'name':_0x19fd91[_0x204ea2(0x1cb)](),'originalName':_0x3923b2['trim'](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':_0x204ea2(0x757),'blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date['now'](),'isBusy':![]},'settings':{'aiPersona':_0x204ea2(0xc32),'myPersona':_0x204ea2(0xea2),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x5dc108,'myAvatar':_0x5dc108,'background':'','theme':_0x204ea2(0xba4),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':_0x204ea2(0xc36)},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x41df36[_0x204ea2(0x864)][_0x24a20c]=_0x2f530b,await _0x342df8['chats'][_0x204ea2(0x9c0)](_0x2f530b),_0x25558e();}else _0x5237db===_0x204ea2(0xf9b)&&document['getElementById'](_0x204ea2(0x1308))['click']();}),document[_0x12aa56(0x383)](_0x12aa56(0xe7d))['addEventListener'](_0x12aa56(0x5c7),_0x582cf4),document[_0x12aa56(0x383)](_0x12aa56(0x12f7))['addEventListener']('click',()=>document[_0x12aa56(0x383)]('transfer-modal')[_0x12aa56(0x119a)]['remove'](_0x12aa56(0x106d))),document['getElementById'](_0x12aa56(0xff3))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x49d889),document[_0x12aa56(0x383)](_0x12aa56(0x7e3))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x433617),document['getElementById'](_0x12aa56(0xf34))['addEventListener'](_0x12aa56(0x5c7),()=>_0x1e6479(!![])),document[_0x12aa56(0x383)]('music-return-btn')[_0x12aa56(0x271)]('click',_0x48f9c5),document['getElementById'](_0x12aa56(0xe89))[_0x12aa56(0x271)]('click',_0x3c21d5),document['getElementById'](_0x12aa56(0xfe8))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x418bb0),document[_0x12aa56(0x383)](_0x12aa56(0x3e4))[_0x12aa56(0x271)]('click',_0x2ea854),document[_0x12aa56(0x383)](_0x12aa56(0x8a1))[_0x12aa56(0x271)]('click',_0x3c3671),document['getElementById'](_0x12aa56(0x1116))['addEventListener'](_0x12aa56(0x5c7),()=>{const _0x3569bc=_0x12aa56;_0x77e4e(),document[_0x3569bc(0x383)](_0x3569bc(0x5b1))[_0x3569bc(0x119a)][_0x3569bc(0xbff)](_0x3569bc(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0x24a))[_0x12aa56(0x271)]('click',()=>document[_0x12aa56(0x383)](_0x12aa56(0x5b1))[_0x12aa56(0x119a)][_0x12aa56(0x131d)](_0x12aa56(0x106d))),document[_0x12aa56(0x383)](_0x12aa56(0x10c5))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1fd69a),document[_0x12aa56(0x383)]('add-song-local-btn')['addEventListener'](_0x12aa56(0x5c7),()=>document[_0x12aa56(0x383)]('local-song-upload-input')[_0x12aa56(0x5c7)]()),document['getElementById']('local-song-upload-input')[_0x12aa56(0x271)](_0x12aa56(0x173),_0x4120c5),document['getElementById'](_0x12aa56(0x59b))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4236c2=>{const _0x1bc09b=_0x12aa56,_0x4f911f=_0x4236c2['target'],_0x2e0a65=parseInt(_0x4f911f['dataset'][_0x1bc09b(0x1297)]);if(isNaN(_0x2e0a65))return;if(_0x4f911f[_0x1bc09b(0x119a)]['contains']('album-art-btn'))_0x5416aa(_0x2e0a65);else{if(_0x4f911f[_0x1bc09b(0x119a)][_0x1bc09b(0x987)](_0x1bc09b(0x139)))_0x5f0f67(_0x2e0a65);else{if(_0x4f911f[_0x1bc09b(0x119a)][_0x1bc09b(0x987)](_0x1bc09b(0x64a)))_0x2849ce(_0x2e0a65);else _0x4f911f[_0x1bc09b(0x119a)][_0x1bc09b(0x987)](_0x1bc09b(0xd52))&&_0xf87ae5(_0x2e0a65);}}}),_0x17f24d[_0x12aa56(0x271)](_0x12aa56(0xb1b),()=>{const _0x510934=_0x12aa56;document[_0x510934(0x383)](_0x510934(0x878))[_0x510934(0x119a)][_0x510934(0x131d)](_0x510934(0x1171)),_0x418bb0();});const _0xbae621=document['getElementById'](_0x12aa56(0x8ef));document[_0x12aa56(0x383)]('send-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x33b5ab=_0x12aa56;_0x2b6a68();const _0x25621e=_0xbae621['value']['trim']();if(!_0x25621e||!_0x41df36[_0x33b5ab(0xfc5)])return;const _0x37d8a8=_0x41df36[_0x33b5ab(0x864)][_0x41df36[_0x33b5ab(0xfc5)]],_0xd4f13c={'role':'user','content':_0x25621e,'timestamp':Date[_0x33b5ab(0x108d)]()};_0x4ddca6&&(_0xd4f13c[_0x33b5ab(0x8ff)]=_0x4ddca6),_0x323467(_0xd4f13c,_0x37d8a8),((async()=>{const _0x3cb127=_0x33b5ab;_0x37d8a8[_0x3cb127(0xd08)][_0x3cb127(0x258)](_0xd4f13c),await _0x342df8[_0x3cb127(0x864)]['put'](_0x37d8a8),_0x25558e();})()),_0xbae621[_0x33b5ab(0x1be)]='',_0xbae621[_0x33b5ab(0x655)][_0x33b5ab(0xbb2)]=_0x33b5ab(0xa60),_0xbae621['focus'](),_0x58fe25();}),document['getElementById'](_0x12aa56(0x7dc))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x11e743),_0xbae621[_0x12aa56(0x271)]('keypress',_0x32967d=>{const _0x8b5f53=_0x12aa56;_0x32967d['key']==='Enter'&&!_0x32967d[_0x8b5f53(0x209)]&&(_0x32967d[_0x8b5f53(0xe94)](),document[_0x8b5f53(0x383)](_0x8b5f53(0x104e))[_0x8b5f53(0x5c7)]());}),document['getElementById'](_0x12aa56(0xded))[_0x12aa56(0x271)](_0x12aa56(0x173),async _0x330630=>{const _0x220754=_0x330630['target']['files'][0x0];if(_0x220754){const _0x256af5=await new Promise((_0x21265b,_0x586d9c)=>{const _0x4ac2b7=_0x42ed,_0x1ab624=new FileReader();_0x1ab624[_0x4ac2b7(0xb5b)]=()=>_0x21265b(_0x1ab624[_0x4ac2b7(0xa86)]),_0x1ab624[_0x4ac2b7(0x40f)]=()=>_0x586d9c(_0x1ab624[_0x4ac2b7(0x98)]),_0x1ab624[_0x4ac2b7(0x132a)](_0x220754);});_0x422ebc=_0x256af5,_0x446010();}}),document[_0x12aa56(0x383)](_0x12aa56(0x1268))['addEventListener']('click',async()=>{const _0x4f8bf1=_0x12aa56;_0x422ebc&&(_0x41df36[_0x4f8bf1(0xc0)][_0x4f8bf1(0x5d0)]=_0x422ebc),_0x41df36['globalSettings'][_0x4f8bf1(0xf2c)]=document[_0x4f8bf1(0x383)](_0x4f8bf1(0xd4d))[_0x4f8bf1(0x1be)][_0x4f8bf1(0x1cb)](),_0x41df36['globalSettings'][_0x4f8bf1(0x11ce)]=document[_0x4f8bf1(0x383)]('notification-sound-url-input')[_0x4f8bf1(0x1be)]['trim'](),_0x41df36[_0x4f8bf1(0xc0)][_0x4f8bf1(0x221)]=document['getElementById']('status-bar-toggle-switch')['checked'],await _0x342df8[_0x4f8bf1(0xc0)]['put'](_0x41df36['globalSettings']),_0x31bb8c(),_0x4f56f2(),_0x422ebc=null,_0x323732(),_0x3df773(),_0x15f193(_0x41df36[_0x4f8bf1(0xc0)][_0x4f8bf1(0xf2c)]),_0x2c3e8c(),alert(_0x4f8bf1(0xf9f)),_0x105acd('home-screen');});const _0x1a322d=document[_0x12aa56(0x383)](_0x12aa56(0x502));_0x1a322d['addEventListener'](_0x12aa56(0x334),()=>{const {scrollTop:_0x2464fc,scrollHeight:_0x2a54df,clientHeight:_0x5df881}=_0x1a322d;_0x2a54df-_0x2464fc-_0x5df881<_0x5df881&&(!_0x4c00a8&&_0x3c093a());}),document[_0x12aa56(0x383)](_0x12aa56(0x184))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x33c97a=_0x12aa56;_0x41df36['apiConfig'][_0x33c97a(0xc3c)]=document[_0x33c97a(0x383)](_0x33c97a(0x135))['value'][_0x33c97a(0x1cb)](),_0x41df36[_0x33c97a(0x673)]['apiKey']=document[_0x33c97a(0x383)](_0x33c97a(0x4d2))[_0x33c97a(0x1be)][_0x33c97a(0x1cb)](),_0x41df36['apiConfig'][_0x33c97a(0x102c)]=document[_0x33c97a(0x383)]('model-select')['value'],_0x41df36[_0x33c97a(0x673)][_0x33c97a(0xace)]=document[_0x33c97a(0x383)]('minimax-group-id')[_0x33c97a(0x1be)][_0x33c97a(0x1cb)](),_0x41df36[_0x33c97a(0x673)][_0x33c97a(0x803)]=document[_0x33c97a(0x383)]('minimax-api-key')[_0x33c97a(0x1be)][_0x33c97a(0x1cb)](),_0x41df36[_0x33c97a(0x673)]['minimaxModel']=document[_0x33c97a(0x383)](_0x33c97a(0x7cf))['value'],_0x41df36[_0x33c97a(0x673)][_0x33c97a(0xabf)]=document[_0x33c97a(0x383)](_0x33c97a(0x12f8))[_0x33c97a(0x1be)][_0x33c97a(0x1cb)](),_0x41df36['apiConfig'][_0x33c97a(0x1135)]=document[_0x33c97a(0x383)](_0x33c97a(0xaa5))[_0x33c97a(0x1be)][_0x33c97a(0x1cb)](),_0x41df36[_0x33c97a(0x673)][_0x33c97a(0x782)]=document[_0x33c97a(0x383)](_0x33c97a(0x2b4))[_0x33c97a(0x1be)],await _0x342df8['apiConfig'][_0x33c97a(0x9c0)](_0x41df36['apiConfig']);const _0x50f4ba=document[_0x33c97a(0x383)]('background-activity-switch'),_0x1adf67=document[_0x33c97a(0x383)](_0x33c97a(0x1208)),_0x3abd1f=document[_0x33c97a(0x383)](_0x33c97a(0x7c4));_0x41df36[_0x33c97a(0xc0)][_0x33c97a(0x8d5)]=_0x50f4ba[_0x33c97a(0x2a3)],_0x41df36[_0x33c97a(0xc0)]['backgroundActivityInterval']=parseInt(_0x1adf67[_0x33c97a(0x1be)])||0x3c,_0x41df36[_0x33c97a(0xc0)][_0x33c97a(0x286)]=parseFloat(_0x3abd1f['value'])||0x1,_0x41df36[_0x33c97a(0xc0)][_0x33c97a(0xb6a)]=document[_0x33c97a(0x383)](_0x33c97a(0xde4))[_0x33c97a(0x2a3)],_0x41df36[_0x33c97a(0xc0)][_0x33c97a(0xcce)]=parseInt(document[_0x33c97a(0x383)](_0x33c97a(0x67e))[_0x33c97a(0x1be)])||0x32,_0x41df36[_0x33c97a(0xc0)]['chatListRenderWindow']=parseInt(document[_0x33c97a(0x383)]('chat-list-render-window-input')[_0x33c97a(0x1be)])||0x1e,_0x41df36[_0x33c97a(0xc0)]['apiTemperature']=parseFloat(document[_0x33c97a(0x383)](_0x33c97a(0x118c))[_0x33c97a(0x1be)]),await _0x342df8[_0x33c97a(0xc0)]['put'](_0x41df36[_0x33c97a(0xc0)]),_0x210308();_0x41df36[_0x33c97a(0xc0)]['enableBackgroundActivity']?(_0x4ac87e(),console['log']('后台活动模拟已启动，间隔:\x20'+_0x41df36[_0x33c97a(0xc0)]['backgroundActivityInterval']+'秒')):console['log'](_0x33c97a(0x11fa));const _0x419085=document['getElementById']('novelai-switch')['checked'],_0x50f2c3=document['getElementById'](_0x33c97a(0x1d4))[_0x33c97a(0x1be)],_0x333983=document[_0x33c97a(0x383)](_0x33c97a(0x20a))['value'][_0x33c97a(0x1cb)]();localStorage['setItem'](_0x33c97a(0x846),_0x419085),localStorage[_0x33c97a(0x16a)](_0x33c97a(0x1d4),_0x50f2c3),localStorage[_0x33c97a(0x16a)](_0x33c97a(0x20a),_0x333983),alert(_0x33c97a(0x48a));});const _0x20c794=document[_0x12aa56(0x383)](_0x12aa56(0x4d2));_0x20c794[_0x12aa56(0x271)](_0x12aa56(0xede),_0x4831e5=>{const _0x5a968e=_0x12aa56;_0x4831e5[_0x5a968e(0xfab)][_0x5a968e(0x13f)](_0x5a968e(0xa6b),'text');}),_0x20c794[_0x12aa56(0x271)](_0x12aa56(0x186),_0x273a1b=>{const _0x5a3fdc=_0x12aa56;_0x273a1b[_0x5a3fdc(0xfab)][_0x5a3fdc(0x13f)](_0x5a3fdc(0xa6b),'password');});async function _0x4ef796(_0x4c8557,_0x5c084f,_0x148018){const _0x42caab=_0x12aa56,_0xcfdf34=document['getElementById'](_0x4c8557)[_0x42caab(0x1be)][_0x42caab(0x1cb)](),_0x105e29=document[_0x42caab(0x383)](_0x5c084f)['value'][_0x42caab(0x1cb)]();if(!_0xcfdf34||!_0x105e29)return alert(_0x42caab(0xffd));try{let _0x2a7805=_0xcfdf34===GEMINI_API_URL;const _0x27afb7=await fetch(_0x2a7805?GEMINI_API_URL+_0x42caab(0xb9e)+getRandomValue(_0x105e29):_0xcfdf34+_0x42caab(0x12cf),_0x2a7805?undefined:{'headers':{'Authorization':_0x42caab(0xd55)+_0x105e29}});if(!_0x27afb7['ok'])throw new Error(_0x42caab(0x11c3));const _0x3c98d7=await _0x27afb7[_0x42caab(0x9b3)]();let _0x1ffa38=_0x2a7805?_0x3c98d7[_0x42caab(0x27f)][_0x42caab(0xa79)](_0x40da38=>({'id':_0x40da38['name']['split']('/')[0x1]||_0x40da38[_0x42caab(0x461)]})):_0x3c98d7[_0x42caab(0x8c6)];const _0x5c462b=document[_0x42caab(0x383)](_0x148018);_0x5c462b['innerHTML']='';const _0x4a3971=_0x148018===_0x42caab(0x275)?_0x41df36[_0x42caab(0x673)][_0x42caab(0x102c)]:_0x41df36['apiConfig'][_0x42caab(0x782)];_0x1ffa38[_0x42caab(0x19c)](_0x5d4a2f=>{const _0x595395=_0x42caab,_0x32d457=document[_0x595395(0xe1b)](_0x595395(0x10a0));_0x32d457[_0x595395(0x1be)]=_0x5d4a2f['id'],_0x32d457[_0x595395(0x138e)]=_0x5d4a2f['id'];if(_0x5d4a2f['id']===_0x4a3971)_0x32d457[_0x595395(0x35e)]=!![];_0x5c462b[_0x595395(0xe91)](_0x32d457);}),alert(_0x42caab(0x795));}catch(_0x3a66c3){alert(_0x42caab(0xaa6)+_0x3a66c3[_0x42caab(0x5f8)]);}}document[_0x12aa56(0x383)](_0x12aa56(0x7f1))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0xc7c266=_0x12aa56;_0x4ef796('proxy-url',_0xc7c266(0x4d2),_0xc7c266(0x275));}),document[_0x12aa56(0x383)](_0x12aa56(0xe31))['addEventListener'](_0x12aa56(0x5c7),()=>{const _0xd67e2e=_0x12aa56;_0x4ef796(_0xd67e2e(0x12f8),_0xd67e2e(0xaa5),_0xd67e2e(0x2b4));}),document[_0x12aa56(0x383)](_0x12aa56(0x8d0))[_0x12aa56(0x271)]('click',async()=>{const _0x227feb=_0x12aa56,_0x23477b=await _0x12e332(_0x227feb(0x12b3),_0x227feb(0x125f));if(_0x23477b&&_0x23477b[_0x227feb(0x1cb)]()){const _0x586521={'id':_0x227feb(0x120)+Date[_0x227feb(0x108d)](),'name':_0x23477b[_0x227feb(0x1cb)](),'content':''};await _0x342df8[_0x227feb(0xf17)]['add'](_0x586521),_0x41df36[_0x227feb(0xf17)]['push'](_0x586521),_0x11e574(),_0x4dda11(_0x586521['id']);}}),document[_0x12aa56(0x383)](_0x12aa56(0x787))[_0x12aa56(0x271)]('click',async()=>{const _0x53cbc3=_0x12aa56;if(!_0x5a1c70)return;const _0x2ab6ab=_0x41df36[_0x53cbc3(0xf17)][_0x53cbc3(0xd12)](_0xfcfde=>_0xfcfde['id']===_0x5a1c70);if(!_0x2ab6ab)return;const _0x4f3cec=document[_0x53cbc3(0x383)]('world-book-name-input')['value'][_0x53cbc3(0x1cb)]();if(!_0x4f3cec){alert(_0x53cbc3(0x7e8));return;}_0x2ab6ab['name']=_0x4f3cec;const _0x1b82f6=document['getElementById'](_0x53cbc3(0x85c))[_0x53cbc3(0x1be)];_0x2ab6ab['categoryId']=_0x1b82f6?parseInt(_0x1b82f6):null;const _0x549606=document[_0x53cbc3(0x383)](_0x53cbc3(0xc8a)),_0x448bc1=_0x549606['querySelectorAll'](_0x53cbc3(0x130f)),_0x390198=[];_0x448bc1['forEach'](_0x5dbf6f=>{const _0x416b1f=_0x53cbc3,_0x4e1902=_0x5dbf6f[_0x416b1f(0x89c)]('.entry-keys-input')[_0x416b1f(0x1be)][_0x416b1f(0x1cb)](),_0xdf055a=_0x5dbf6f[_0x416b1f(0x89c)](_0x416b1f(0x39d))[_0x416b1f(0x1be)]['trim'](),_0x32afa0=_0x5dbf6f[_0x416b1f(0x89c)](_0x416b1f(0x414))[_0x416b1f(0x2a3)];_0xdf055a&&_0x390198[_0x416b1f(0x258)]({'comment':_0x5dbf6f['querySelector'](_0x416b1f(0x1148))[_0x416b1f(0x1be)]['trim'](),'keys':_0x4e1902?_0x4e1902['split'](',')[_0x416b1f(0xa79)](_0x5d7920=>_0x5d7920[_0x416b1f(0x1cb)]())['filter'](_0x36a89c=>_0x36a89c):[],'content':_0xdf055a,'enabled':_0x32afa0});}),_0x2ab6ab[_0x53cbc3(0x11b6)]=_0x390198,await _0x342df8[_0x53cbc3(0xf17)][_0x53cbc3(0x9c0)](_0x2ab6ab),document[_0x53cbc3(0x383)]('world-book-editor-title')['textContent']=_0x4f3cec,_0x5a1c70=null,_0x105acd(_0x53cbc3(0x88e)),await _0x11e574();}),document[_0x12aa56(0x383)]('chat-messages')['addEventListener'](_0x12aa56(0x5c7),async _0xf1ec39=>{const _0x4a3eaf=_0x12aa56,_0x545b34=_0xf1ec39[_0x4a3eaf(0xfab)]['closest']('.voice-message-body[data-text]');if(_0x545b34){const _0x1bcefb=_0x41df36[_0x4a3eaf(0x864)][_0x41df36[_0x4a3eaf(0xfc5)]];if(!_0x1bcefb)return;_0x3ec05c(_0x545b34);const _0xcf485c=_0x545b34['closest'](_0x4a3eaf(0xbb0)),_0x4d8acd=_0xcf485c?_0xcf485c[_0x4a3eaf(0x89c)]('.voice-transcript'):null;if(_0x545b34[_0x4a3eaf(0x118)]['voiceId']&&_0x4d8acd&&_0x4d8acd[_0x4a3eaf(0x655)]['display']===_0x4a3eaf(0x27a)){if(_0x1bcefb[_0x4a3eaf(0x1a2)]){console[_0x4a3eaf(0xe72)](_0x4a3eaf(0x2ca));return;}if(_0x1bcefb[_0x4a3eaf(0x886)]['enableTts']===![]){console['log']('“'+_0x1bcefb[_0x4a3eaf(0x461)]+_0x4a3eaf(0x1092));return;}_0x198bfd(_0x545b34);}return;}const _0x12f61e=_0xf1ec39[_0x4a3eaf(0xfab)][_0x4a3eaf(0x58c)](_0x4a3eaf(0xbd5));if(_0x12f61e){const _0x4036bf=_0x12f61e['closest'](_0x4a3eaf(0xbb0));if(_0x4036bf){const _0x4cda60=parseInt(_0x4036bf[_0x4a3eaf(0x118)][_0x4a3eaf(0x3b7)]);if(!isNaN(_0x4cda60)){_0x3ac728(_0x4cda60);return;}}}const _0x585d77=_0xf1ec39[_0x4a3eaf(0xfab)][_0x4a3eaf(0x58c)]('.waimai-user-actions\x20button');if(_0x585d77){const _0x3264ff=_0x585d77[_0x4a3eaf(0x58c)](_0x4a3eaf(0xbb0));if(_0x3264ff){const _0x482d77=parseInt(_0x3264ff[_0x4a3eaf(0x118)][_0x4a3eaf(0x3b7)]),_0x1bcb8d=_0x585d77['dataset'][_0x4a3eaf(0xeb)];if(!isNaN(_0x482d77)&&_0x1bcb8d){await _0x3bf7d7(_0x482d77,_0x1bcb8d);return;}}}const _0x5e99e3=_0xf1ec39[_0x4a3eaf(0xfab)][_0x4a3eaf(0x58c)](_0x4a3eaf(0x42d));if(_0x5e99e3){const _0x39c906=parseInt(_0x5e99e3[_0x4a3eaf(0x118)]['postId']);if(!isNaN(_0x39c906)){const _0x15c5f5=await _0x342df8[_0x4a3eaf(0x35a)][_0x4a3eaf(0x1a3)](_0x39c906);if(_0x15c5f5){let _0x6a924d='';const _0x41ca13=_0x15c5f5['authorId']===_0x4a3eaf(0x66e)?_0x41df36['qzoneSettings'][_0x4a3eaf(0xabb)]:_0x41df36[_0x4a3eaf(0x864)][_0x15c5f5['authorId']]?.[_0x4a3eaf(0x461)]||_0x4a3eaf(0xc05);if(_0x15c5f5[_0x4a3eaf(0xa6b)]===_0x4a3eaf(0x23e))_0x6a924d=_0x15c5f5[_0x4a3eaf(0x11b6)];else{_0x6a924d=_0x15c5f5[_0x4a3eaf(0xbdc)]||'';if(_0x15c5f5['imageUrl'])_0x6a924d+=_0x4a3eaf(0xc48);if(_0x15c5f5[_0x4a3eaf(0x4e6)])_0x6a924d+=_0x4a3eaf(0x9e3)+_0x15c5f5['hiddenContent']+']';}_0x296ef9(_0x4a3eaf(0x1097)+_0x41ca13+_0x4a3eaf(0xce),_0x6a924d[_0x4a3eaf(0x709)](/\n/g,_0x4a3eaf(0x3ee)));}else _0x296ef9('提示',_0x4a3eaf(0x9ba));}return;}const _0x108f21=_0xf1ec39['target'][_0x4a3eaf(0x58c)](_0x4a3eaf(0x10d9));if(_0x108f21){const _0x5c63aa=_0x108f21[_0x4a3eaf(0x118)][_0x4a3eaf(0xee1)];if(_0x5c63aa)_0x296ef9(_0x4a3eaf(0xcaf),_0x5c63aa);return;}const _0x498275=_0xf1ec39[_0x4a3eaf(0xfab)]['closest']('.quoted-message');if(_0x498275&&_0x498275[_0x4a3eaf(0x118)][_0x4a3eaf(0x936)]){const _0x460025=parseInt(_0x498275[_0x4a3eaf(0x118)][_0x4a3eaf(0x936)]);!isNaN(_0x460025)&&_0x110168(_0x460025);}const _0x4bd5a1=_0xf1ec39['target'][_0x4a3eaf(0x58c)]('.gift-card');if(_0x4bd5a1){const _0x481708=_0x4bd5a1['closest'](_0x4a3eaf(0xbb0));_0x481708&&_0x511cbe(parseInt(_0x481708['dataset'][_0x4a3eaf(0x3b7)]));}const _0x5d676a=_0xf1ec39[_0x4a3eaf(0xfab)]['closest'](_0x4a3eaf(0x84a));if(_0x5d676a){const _0x4e4d9a=_0x5d676a[_0x4a3eaf(0x58c)](_0x4a3eaf(0xbb0));if(_0x4e4d9a&&_0x4e4d9a[_0x4a3eaf(0x118)][_0x4a3eaf(0x3b7)]){const _0x37fd07=parseInt(_0x4e4d9a[_0x4a3eaf(0x118)]['timestamp']);_0x417620(_0x37fd07);}}const _0x337dda=_0xf1ec39[_0x4a3eaf(0xfab)][_0x4a3eaf(0x58c)]('.poll-card');if(_0x337dda){const _0x3246b5=parseInt(_0x337dda[_0x4a3eaf(0x118)][_0x4a3eaf(0x10f5)]);if(isNaN(_0x3246b5))return;const _0x1d96e5=_0xf1ec39[_0x4a3eaf(0xfab)][_0x4a3eaf(0x58c)]('.poll-option-item');if(_0x1d96e5&&!_0x337dda['classList'][_0x4a3eaf(0x987)](_0x4a3eaf(0x3a6))){_0x4dad9d(_0x3246b5,_0x1d96e5[_0x4a3eaf(0x118)]['option']);return;}const _0x4504c3=_0xf1ec39['target'][_0x4a3eaf(0x58c)](_0x4a3eaf(0xdcd));if(_0x4504c3){_0x337dda[_0x4a3eaf(0x119a)][_0x4a3eaf(0x987)](_0x4a3eaf(0x3a6))?_0x1b679d(_0x3246b5):_0x2e655e(_0x3246b5);return;}_0x337dda[_0x4a3eaf(0x119a)][_0x4a3eaf(0x987)](_0x4a3eaf(0x3a6))&&_0x1b679d(_0x3246b5);}const _0x306bb6=_0xf1ec39[_0x4a3eaf(0xfab)]['closest'](_0x4a3eaf(0xf96));if(_0x306bb6){const _0x586de8=_0x41df36[_0x4a3eaf(0x864)][_0x41df36[_0x4a3eaf(0xfc5)]],_0x2cde13=_0x306bb6[_0x4a3eaf(0x58c)]('.message-wrapper');if(_0x586de8&&_0x2cde13){const _0x536625=parseInt(_0x2cde13[_0x4a3eaf(0x118)][_0x4a3eaf(0x3b7)]),_0x42f815=_0x586de8[_0x4a3eaf(0xd08)][_0x4a3eaf(0xd12)](_0x4f49f7=>_0x4f49f7[_0x4a3eaf(0x3b7)]===_0x536625);if(_0x42f815&&_0x42f815[_0x4a3eaf(0x5dd)]){let _0x110263='';const _0x29c6e3=_0x42f815[_0x4a3eaf(0x5dd)];_0x29c6e3['originalType']===_0x4a3eaf(0x6af)?_0x110263='原文:\x20\x22'+_0x29c6e3[_0x4a3eaf(0xf2e)]+'\x22':_0x110263=_0x4a3eaf(0x4c4)+_0x29c6e3[_0x4a3eaf(0x18b)]+_0x4a3eaf(0xb1a),_0x296ef9(_0x4a3eaf(0x1335),_0x110263);}}}const _0x105c26=_0xf1ec39['target']['closest']('.link-share-card');if(_0x105c26&&_0x105c26[_0x4a3eaf(0x58c)](_0x4a3eaf(0xc16))){const _0x54365f=parseInt(_0x105c26[_0x4a3eaf(0x118)][_0x4a3eaf(0x3b7)]);_0x5e25dc(_0x54365f);}const _0x1bbbd8=_0xf1ec39[_0x4a3eaf(0xfab)][_0x4a3eaf(0x58c)]('.message-bubble');if(_0x1bbbd8&&_0x1bbbd8[_0x4a3eaf(0x119a)][_0x4a3eaf(0x987)]('ai')&&_0x1bbbd8[_0x4a3eaf(0x119a)][_0x4a3eaf(0x987)]('is-transfer')&&_0x1bbbd8[_0x4a3eaf(0x118)]['status']===_0x4a3eaf(0x1ad)){const _0x39c1c6=parseInt(_0x1bbbd8['dataset'][_0x4a3eaf(0x3b7)]);!isNaN(_0x39c1c6)&&_0x65c610(_0x39c1c6);}});const _0x49b7f8=document[_0x12aa56(0x383)](_0x12aa56(0xd48)),_0x1e6e2f=document[_0x12aa56(0x89c)](_0x12aa56(0x8bc)),_0x2042a2=document[_0x12aa56(0x383)](_0x12aa56(0xa39));function _0xb06aa2(){const _0x2316b7=_0x12aa56,_0x27eb5c=_0x2042a2[_0x2316b7(0x400)](_0x2316b7(0x137b)),_0x2bf870=document[_0x2316b7(0x89c)](_0x2316b7(0x119));if(_0x27eb5c[_0x2316b7(0xfde)]===0x0)_0x2bf870[_0x2316b7(0x138e)]=_0x2316b7(0xec4);else{if(_0x27eb5c[_0x2316b7(0xfde)]>0x2)_0x2bf870[_0x2316b7(0x138e)]='已选择\x20'+_0x27eb5c['length']+'\x20本世界书';else{const _0x117ffb=Array[_0x2316b7(0x365)](_0x27eb5c)[_0x2316b7(0xa79)](_0x1b1922=>{const _0x3b0a45=_0x2316b7;return _0x1b1922[_0x3b0a45(0x12f3)][_0x3b0a45(0x138e)]['trim']();});_0x2bf870[_0x2316b7(0x138e)]=_0x117ffb[_0x2316b7(0xa35)](',\x20');}}}_0x1e6e2f[_0x12aa56(0x271)]('click',_0x274829=>{const _0x9774e3=_0x12aa56;_0x274829[_0x9774e3(0x1311)](),_0x2042a2[_0x9774e3(0x119a)][_0x9774e3(0x8f0)](_0x9774e3(0x106d)),_0x1e6e2f[_0x9774e3(0x119a)][_0x9774e3(0x8f0)](_0x9774e3(0x1ce));}),document['getElementById'](_0x12aa56(0xa39))[_0x12aa56(0x271)](_0x12aa56(0x173),_0xb06aa2),window['addEventListener'](_0x12aa56(0x5c7),_0x4fa260=>{const _0x2ba017=_0x12aa56;!document[_0x2ba017(0x89c)](_0x2ba017(0x9ab))[_0x2ba017(0x987)](_0x4fa260[_0x2ba017(0xfab)])&&(_0x2042a2[_0x2ba017(0x119a)]['remove']('visible'),_0x1e6e2f[_0x2ba017(0x119a)][_0x2ba017(0x131d)]('expanded'));}),document[_0x12aa56(0x383)](_0x12aa56(0x1ee))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x39cc77=_0x12aa56;_0x3c5192();if(!_0x41df36['activeChatId'])return;const _0x499aea=_0x41df36[_0x39cc77(0x864)][_0x41df36[_0x39cc77(0xfc5)]],_0x3a3d88=_0x499aea[_0x39cc77(0x1a2)],_0x232271=document['getElementById'](_0x39cc77(0xae3));!_0x3a3d88&&_0x499aea[_0x39cc77(0x886)][_0x39cc77(0xef5)]&&_0x499aea[_0x39cc77(0x886)][_0x39cc77(0xef5)][_0x39cc77(0xfde)]>0x0?_0x232271[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x39cc77(0x27a):_0x232271['style'][_0x39cc77(0x2b6)]='none';document[_0x39cc77(0x383)](_0x39cc77(0x252))[_0x39cc77(0x655)][_0x39cc77(0x2b6)]='block',document[_0x39cc77(0x383)]('my-persona-group')[_0x39cc77(0x655)]['display']=_0x39cc77(0x27a),document[_0x39cc77(0x383)]('my-avatar-group')[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x39cc77(0x27a),document[_0x39cc77(0x383)](_0x39cc77(0xead))[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x3a3d88?_0x39cc77(0x27a):_0x39cc77(0xa70),document[_0x39cc77(0x383)](_0x39cc77(0xe6a))[_0x39cc77(0x655)]['display']=_0x3a3d88?_0x39cc77(0xa70):_0x39cc77(0x27a),document[_0x39cc77(0x383)](_0x39cc77(0x305))[_0x39cc77(0x655)]['display']=_0x3a3d88?_0x39cc77(0x27a):'none',document['getElementById'](_0x39cc77(0xf50))[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x3a3d88?'block':'none',document[_0x39cc77(0x383)](_0x39cc77(0x32a))[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x3a3d88?_0x39cc77(0xa70):_0x39cc77(0x27a),document[_0x39cc77(0x383)](_0x39cc77(0xb5))['style']['display']=_0x3a3d88?_0x39cc77(0xa70):_0x39cc77(0x27a),document['getElementById'](_0x39cc77(0x119c))[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x3a3d88?'none':'block',document['getElementById'](_0x39cc77(0xd1d))[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x3a3d88?_0x39cc77(0xa70):_0x39cc77(0x27a),document['getElementById']('ai-voice-id-group')['style'][_0x39cc77(0x2b6)]=_0x3a3d88?_0x39cc77(0xa70):_0x39cc77(0x27a),document[_0x39cc77(0x383)]('inject-thought-group')[_0x39cc77(0x655)]['display']=_0x3a3d88?'none':_0x39cc77(0x27a),document[_0x39cc77(0x383)](_0x39cc77(0x6d0))[_0x39cc77(0x655)]['display']=_0x3a3d88?_0x39cc77(0xa70):'block',document[_0x39cc77(0x383)](_0x39cc77(0x322))[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x3a3d88?'none':_0x39cc77(0x27a),document['getElementById']('group-cooldown-group')['style'][_0x39cc77(0x2b6)]=_0x3a3d88?_0x39cc77(0x27a):'none',document['getElementById'](_0x39cc77(0xd67))[_0x39cc77(0x1be)]=_0x499aea[_0x39cc77(0x461)],document[_0x39cc77(0x383)](_0x39cc77(0x41b))[_0x39cc77(0x1be)]=_0x499aea['settings'][_0x39cc77(0xe63)],document[_0x39cc77(0x383)](_0x39cc77(0x1324))[_0x39cc77(0xf6c)]=_0x499aea['settings']['myAvatar']||(_0x3a3d88?_0x188ace:_0x5dc108),document[_0x39cc77(0x383)](_0x39cc77(0xef0))['value']=_0x499aea['settings']['maxMemory'],document[_0x39cc77(0x383)](_0x39cc77(0x76e))[_0x39cc77(0x1be)]=_0x499aea['settings'][_0x39cc77(0x1d8)]||0xa;const _0x25fac6=document[_0x39cc77(0x383)](_0x39cc77(0x119b)),_0x5653d5=document[_0x39cc77(0x383)](_0x39cc77(0xad5));_0x499aea[_0x39cc77(0x886)][_0x39cc77(0x415)]?(_0x25fac6[_0x39cc77(0xf6c)]=_0x499aea[_0x39cc77(0x886)][_0x39cc77(0x415)],_0x25fac6['style'][_0x39cc77(0x2b6)]=_0x39cc77(0x27a),_0x5653d5[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x39cc77(0xdcf)):(_0x25fac6['style'][_0x39cc77(0x2b6)]=_0x39cc77(0xa70),_0x5653d5[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x39cc77(0xa70));document[_0x39cc77(0x383)]('lyrics-position-group')[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x3a3d88?_0x39cc77(0xa70):_0x39cc77(0x27a),document[_0x39cc77(0x383)]('single-char-background-activity-group')['style'][_0x39cc77(0x2b6)]=_0x3a3d88?'none':'block',document[_0x39cc77(0x383)](_0x39cc77(0xd43))[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x3a3d88?'block':_0x39cc77(0xa70);const _0x4bfbce=document['getElementById'](_0x39cc77(0x126e)),_0x4ebc29=document[_0x39cc77(0x383)](_0x39cc77(0x2cd));_0x4bfbce['checked']=_0x499aea['settings']['enableTimePerception'],_0x4ebc29['style'][_0x39cc77(0x2b6)]=_0x4bfbce[_0x39cc77(0x2a3)]?_0x39cc77(0x27a):_0x39cc77(0xa70);const _0x3a6f9c=document['getElementById'](_0x39cc77(0xe76)),_0x3bd165=Intl[_0x39cc77(0xeb4)](_0x39cc77(0xa74));_0x3a6f9c[_0x39cc77(0x45c)]='',_0x3bd165[_0x39cc77(0x19c)](_0x53f828=>{const _0x2a20c6=_0x39cc77,_0x3125bb=document[_0x2a20c6(0xe1b)](_0x2a20c6(0x10a0));_0x3125bb['value']=_0x53f828,_0x3125bb['textContent']=_0x53f828,_0x3a6f9c[_0x2a20c6(0xe91)](_0x3125bb);}),_0x3a6f9c[_0x39cc77(0x1be)]=_0x499aea[_0x39cc77(0x886)]['timeZone']||_0x39cc77(0xc36);if(_0x3a3d88)document[_0x39cc77(0x383)](_0x39cc77(0x522))[_0x39cc77(0x2a3)]=_0x499aea[_0x39cc77(0x886)][_0x39cc77(0x8d5)],document[_0x39cc77(0x383)](_0x39cc77(0xc21))[_0x39cc77(0x1be)]=_0x499aea[_0x39cc77(0x886)][_0x39cc77(0x52e)]||'',document[_0x39cc77(0x383)](_0x39cc77(0x10ca))[_0x39cc77(0xf6c)]=_0x499aea[_0x39cc77(0x886)][_0x39cc77(0x332)]||_0x3e0950,document[_0x39cc77(0x383)](_0x39cc77(0x8d3))[_0x39cc77(0x1be)]=_0x499aea[_0x39cc77(0x886)]['actionCooldownMinutes']||0xa,document['getElementById']('single-char-background-activity-group')['style']['display']=_0x39cc77(0xa70),_0x1b802e(_0x499aea[_0x39cc77(0x12a6)]);else{document[_0x39cc77(0x383)](_0x39cc77(0x12f9))[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x39cc77(0x27a),document[_0x39cc77(0x383)](_0x39cc77(0x7cb))[_0x39cc77(0x2a3)]=_0x499aea['settings'][_0x39cc77(0x8d5)],document[_0x39cc77(0x383)](_0x39cc77(0x93a))[_0x39cc77(0x2a3)]=_0x499aea[_0x39cc77(0x886)][_0x39cc77(0x1380)];const _0x1912a9=document['getElementById'](_0x39cc77(0x7c2)),_0x388d40=document[_0x39cc77(0x383)](_0x39cc77(0x3ec)),_0x4ab6d1=document[_0x39cc77(0x383)](_0x39cc77(0x12ca)),_0x4ea224=document['getElementById']('offline-max-length-input');_0x1912a9[_0x39cc77(0x2a3)]=_0x499aea['settings']['isOfflineMode']||![],_0x388d40[_0x39cc77(0x655)][_0x39cc77(0x2b6)]=_0x1912a9['checked']?_0x39cc77(0x27a):_0x39cc77(0xa70),_0x4ab6d1['value']=_0x499aea['settings']['offlineMinLength']||0x64,_0x4ea224[_0x39cc77(0x1be)]=_0x499aea[_0x39cc77(0x886)][_0x39cc77(0xe67)]||0x12c,await _0x52829c(_0x499aea),document[_0x39cc77(0x383)](_0x39cc77(0xd8))[_0x39cc77(0x1be)]=_0x499aea[_0x39cc77(0x283)],document['getElementById'](_0x39cc77(0x1048))['value']=_0x499aea[_0x39cc77(0x886)][_0x39cc77(0xad0)]||'',document[_0x39cc77(0x383)](_0x39cc77(0x14a))[_0x39cc77(0x2a3)]=_0x499aea[_0x39cc77(0x886)][_0x39cc77(0xa7f)]!==![],document[_0x39cc77(0x383)]('ai-persona')[_0x39cc77(0x1be)]=_0x499aea[_0x39cc77(0x886)]['aiPersona'],document[_0x39cc77(0x383)]('ai-avatar-preview')[_0x39cc77(0xf6c)]=_0x499aea[_0x39cc77(0x886)][_0x39cc77(0x121e)]||_0x5dc108,document[_0x39cc77(0x383)]('my-nickname-input')[_0x39cc77(0x1be)]=_0x499aea[_0x39cc77(0x886)]['myNickname']||'我',document[_0x39cc77(0x383)](_0x39cc77(0xb9))[_0x39cc77(0x1be)]=_0x499aea['settings'][_0x39cc77(0xf9c)]||0xa;const _0x270207=document[_0x39cc77(0x383)](_0x39cc77(0xcc0));_0x270207[_0x39cc77(0x45c)]=_0x39cc77(0x652);const _0x19b9a0=await _0x342df8['qzoneGroups'][_0x39cc77(0x21f)]();_0x19b9a0[_0x39cc77(0x19c)](_0xefb8e2=>{const _0x1d72ab=_0x39cc77,_0x47dc11=document[_0x1d72ab(0xe1b)](_0x1d72ab(0x10a0));_0x47dc11[_0x1d72ab(0x1be)]=_0xefb8e2['id'],_0x47dc11[_0x1d72ab(0x138e)]=_0xefb8e2[_0x1d72ab(0x461)];if(_0x499aea[_0x1d72ab(0x11a6)]===_0xefb8e2['id'])_0x47dc11[_0x1d72ab(0x35e)]=!![];_0x270207['appendChild'](_0x47dc11);});const _0x532a46=_0x499aea[_0x39cc77(0x886)][_0x39cc77(0xe11)]||{'vertical':'top','horizontal':_0x39cc77(0x699),'offset':0xa};document[_0x39cc77(0x383)]('lyrics-vertical-pos')[_0x39cc77(0x1be)]=_0x532a46[_0x39cc77(0xf01)],document[_0x39cc77(0x383)](_0x39cc77(0x7f3))[_0x39cc77(0x1be)]=_0x532a46[_0x39cc77(0x219)],document[_0x39cc77(0x383)](_0x39cc77(0x9a3))[_0x39cc77(0x1be)]=_0x532a46['offset'];}const _0x39de74=document[_0x39cc77(0x383)](_0x39cc77(0xa39));_0x39de74[_0x39cc77(0x45c)]='';const [_0x2a8935,_0x2bfdf4]=await Promise['all']([_0x342df8[_0x39cc77(0xa1c)][_0x39cc77(0x21f)](),_0x342df8[_0x39cc77(0xf17)]['toArray']()]),_0x112d96=new Set(_0x499aea['settings'][_0x39cc77(0xe8c)]||[]);if(_0x2bfdf4[_0x39cc77(0xfde)]===0x0)_0x39de74[_0x39cc77(0x45c)]=_0x39cc77(0xd2);else{_0x2a8935[_0x39cc77(0x19c)](_0x170e3c=>{const _0x50adab=_0x39cc77,_0x252d08=_0x2bfdf4['filter'](_0x161e64=>_0x161e64[_0x50adab(0xba3)]===_0x170e3c['id']);if(_0x252d08[_0x50adab(0xfde)]>0x0){const _0x445a75=document[_0x50adab(0xe1b)]('h4');_0x445a75[_0x50adab(0x138e)]=_0x170e3c[_0x50adab(0x461)],_0x445a75['style']['cssText']=_0x50adab(0xc1f),_0x39de74['appendChild'](_0x445a75),_0x252d08[_0x50adab(0x19c)](_0x776ee9=>{const _0x18d744=_0x50adab,_0x2a3a0f=_0x112d96[_0x18d744(0xcde)](_0x776ee9['id']),_0x2c9f03=document[_0x18d744(0xe1b)]('label');_0x2c9f03[_0x18d744(0x45c)]=_0x18d744(0x264)+_0x776ee9['id']+'\x22\x20'+(_0x2a3a0f?_0x18d744(0x2a3):'')+'>\x20'+_0x776ee9[_0x18d744(0x461)],_0x39de74[_0x18d744(0xe91)](_0x2c9f03);});}});const _0x3c7a70=_0x2bfdf4[_0x39cc77(0x98a)](_0x148931=>!_0x148931[_0x39cc77(0xba3)]);if(_0x3c7a70['length']>0x0){const _0x23b974=document[_0x39cc77(0xe1b)]('h4');_0x23b974[_0x39cc77(0x138e)]=_0x39cc77(0xaac),_0x23b974[_0x39cc77(0x655)][_0x39cc77(0x1ae)]=_0x39cc77(0xc29),_0x39de74[_0x39cc77(0xe91)](_0x23b974),_0x3c7a70[_0x39cc77(0x19c)](_0x6975e6=>{const _0x460b0d=_0x39cc77,_0x446409=_0x112d96['has'](_0x6975e6['id']),_0x55e239=document[_0x460b0d(0xe1b)](_0x460b0d(0x558));_0x55e239[_0x460b0d(0x45c)]='<input\x20type=\x22checkbox\x22\x20value=\x22book_'+_0x6975e6['id']+'\x22\x20'+(_0x446409?_0x460b0d(0x2a3):'')+'>\x20'+_0x6975e6[_0x460b0d(0x461)],_0x39de74[_0x460b0d(0xe91)](_0x55e239);});}}_0xb06aa2();const _0x8ce901=document[_0x39cc77(0x383)](_0x39cc77(0x1080)),_0x5bad11=document['getElementById'](_0x39cc77(0x1099)),_0x123bea=document[_0x39cc77(0x383)]('linked-chats-checkboxes-container'),_0x10e270=_0x499aea[_0x39cc77(0x886)]['linkedMemoryChatIds']||[];_0x8ce901[_0x39cc77(0x2a3)]=_0x10e270['length']>0x0,_0x5bad11[_0x39cc77(0x655)]['display']=_0x8ce901[_0x39cc77(0x2a3)]?_0x39cc77(0x27a):_0x39cc77(0xa70),_0x123bea['innerHTML']='',Object['values'](_0x41df36['chats'])[_0x39cc77(0x19c)](_0x531e51=>{const _0x5014c6=_0x39cc77;if(_0x531e51['id']===_0x499aea['id'])return;const _0x1df848=_0x10e270[_0x5014c6(0xee2)](_0x531e51['id']),_0x4ad30c=_0x531e51[_0x5014c6(0x1a2)]?'[群聊]':'[私聊]',_0xd2206e=document[_0x5014c6(0xe1b)](_0x5014c6(0x558));_0xd2206e[_0x5014c6(0x45c)]=_0x5014c6(0x9f9)+_0x531e51['id']+'\x22\x20'+(_0x1df848?_0x5014c6(0x2a3):'')+'>\x20'+_0x4ad30c+'\x20'+_0x531e51[_0x5014c6(0x461)],_0x123bea[_0x5014c6(0xe91)](_0xd2206e);});function _0xd0d7d9(){const _0x326f94=_0x39cc77,_0x409113=_0x123bea['querySelectorAll'](_0x326f94(0x137b)),_0x44ec34=_0x5bad11[_0x326f94(0x89c)](_0x326f94(0x119));if(_0x409113['length']===0x0)_0x44ec34['textContent']='--\x20点击选择\x20--';else _0x409113[_0x326f94(0xfde)]>0x2?_0x44ec34[_0x326f94(0x138e)]=_0x326f94(0x13a4)+_0x409113[_0x326f94(0xfde)]+'\x20项':_0x44ec34['textContent']=Array[_0x326f94(0x365)](_0x409113)['map'](_0x50b165=>_0x50b165[_0x326f94(0x12f3)][_0x326f94(0x138e)][_0x326f94(0x1cb)]())[_0x326f94(0xa35)](',\x20');}_0xd0d7d9(),_0x8ce901[_0x39cc77(0x271)](_0x39cc77(0x173),()=>{const _0x2202d4=_0x39cc77;_0x5bad11['style'][_0x2202d4(0x2b6)]=_0x8ce901[_0x2202d4(0x2a3)]?_0x2202d4(0x27a):_0x2202d4(0xa70);});const _0x4973f5=_0x5bad11[_0x39cc77(0x89c)](_0x39cc77(0xe21)),_0x3dc787=_0x4973f5[_0x39cc77(0x117b)](!![]);_0x4973f5['parentNode'][_0x39cc77(0xe58)](_0x3dc787,_0x4973f5),_0x3dc787[_0x39cc77(0x271)](_0x39cc77(0x5c7),_0x128b58=>{const _0x1ebce0=_0x39cc77;_0x128b58[_0x1ebce0(0x1311)](),_0x123bea[_0x1ebce0(0x119a)][_0x1ebce0(0x8f0)](_0x1ebce0(0x106d)),_0x3dc787[_0x1ebce0(0x119a)][_0x1ebce0(0x8f0)]('expanded');}),_0x123bea['addEventListener'](_0x39cc77(0x173),_0xd0d7d9);const _0x14d49b=document['querySelector'](_0x39cc77(0xf7e)+(_0x499aea[_0x39cc77(0x886)][_0x39cc77(0x53f)]||'default')+'\x22]');if(_0x14d49b)_0x14d49b[_0x39cc77(0x2a3)]=!![];const _0x34493e=document[_0x39cc77(0x383)](_0x39cc77(0xeb2));_0x34493e['value']=_0x499aea[_0x39cc77(0x886)][_0x39cc77(0x3eb)]||0xd,document[_0x39cc77(0x383)](_0x39cc77(0x2c6))[_0x39cc77(0x138e)]=_0x34493e['value']+'px';const _0x2e7852=document[_0x39cc77(0x383)](_0x39cc77(0x9fe));_0x2e7852['value']=_0x499aea[_0x39cc77(0x886)][_0x39cc77(0x6cd)]||'',_0x24c0e3(),document[_0x39cc77(0x383)](_0x39cc77(0xd3e))[_0x39cc77(0x2a3)]=_0x499aea[_0x39cc77(0x886)][_0x39cc77(0xd3)]||![],document[_0x39cc77(0x383)](_0x39cc77(0x17f))['value']=_0x499aea[_0x39cc77(0x886)]['autoMemoryInterval']||0x14,setTimeout(()=>{const _0x2c2dd1=_0x39cc77;_0x6473ce();const _0x5713e0=['ai-persona',_0x2c2dd1(0x41b),'max-memory','linked-memory-count',_0x2c2dd1(0xd3e),_0x2c2dd1(0x17f),'offline-mode-toggle',_0x2c2dd1(0x12ca),'offline-max-length-input',_0x2c2dd1(0x8a4)];_0x5713e0[_0x2c2dd1(0x19c)](_0x3a3853=>{const _0x131e9e=_0x2c2dd1,_0x3d06d1=document['getElementById'](_0x3a3853);_0x3d06d1&&_0x3d06d1[_0x131e9e(0x271)](_0x131e9e(0xba),_0x6473ce);}),document[_0x2c2dd1(0x383)](_0x2c2dd1(0xa39))[_0x2c2dd1(0x271)](_0x2c2dd1(0x173),_0x6473ce),document[_0x2c2dd1(0x383)]('linked-chats-checkboxes-container')[_0x2c2dd1(0x271)]('change',_0x6473ce),document['getElementById'](_0x2c2dd1(0x1080))[_0x2c2dd1(0x271)](_0x2c2dd1(0x173),_0x6473ce);},0x64),_0x105acd(_0x39cc77(0xe5c));});function _0x1b802e(_0x49ad79){const _0x1f8871=_0x12aa56,_0x22a808=document[_0x1f8871(0x383)](_0x1f8871(0x26a));_0x22a808[_0x1f8871(0x45c)]='',_0x49ad79[_0x1f8871(0x19c)](_0x4c3a60=>{const _0x109231=_0x1f8871,_0x3780fe=document[_0x109231(0xe1b)](_0x109231(0x7fd));_0x3780fe[_0x109231(0x556)]='member-editor',_0x3780fe['dataset'][_0x109231(0xcfe)]=_0x4c3a60['id'];const _0x3c8b74=_0x4c3a60[_0x109231(0xb47)]||(_0x41df36['chats'][_0x4c3a60['id']]?_0x41df36[_0x109231(0x864)][_0x4c3a60['id']][_0x109231(0x886)][_0x109231(0x121e)]:_0x59100f);_0x3780fe[_0x109231(0x45c)]=_0x109231(0xf8a)+_0x3c8b74+_0x109231(0xc85)+_0x4c3a60[_0x109231(0x9da)]+_0x109231(0x2ef)+_0x4c3a60[_0x109231(0x9da)]+_0x109231(0x69b),_0x3780fe[_0x109231(0x271)]('click',()=>_0xad374f(_0x4c3a60['id'])),_0x22a808[_0x109231(0xe91)](_0x3780fe);});}document[_0x12aa56(0x383)]('save-member-settings-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0xf48327=_0x12aa56;if(!_0x5f3c03)return;const _0x4470b7=_0x41df36[_0xf48327(0x864)][_0x41df36[_0xf48327(0xfc5)]],_0x2ae61a=_0x4470b7[_0xf48327(0x12a6)][_0xf48327(0xd12)](_0x3feea2=>_0x3feea2['id']===_0x5f3c03);if(!_0x2ae61a)return;const _0x55a5f9=document[_0xf48327(0x383)]('member-name-input')['value'][_0xf48327(0x1cb)]();if(!_0x55a5f9){alert(_0xf48327(0x7b0));return;}_0x2ae61a[_0xf48327(0x9da)]=_0x55a5f9,_0x2ae61a[_0xf48327(0x48c)]=document[_0xf48327(0x383)](_0xf48327(0xde1))[_0xf48327(0x1be)];const _0x46ef4f=document['getElementById']('member-avatar-preview')[_0xf48327(0xf6c)];_0x2ae61a[_0xf48327(0xb47)]=_0x46ef4f;const _0x3b4dfa=_0x41df36[_0xf48327(0x864)][_0x2ae61a['id']];_0x3b4dfa&&(_0x3b4dfa[_0xf48327(0x886)][_0xf48327(0x121e)]=_0x46ef4f,await _0x342df8['chats'][_0xf48327(0x9c0)](_0x3b4dfa)),await _0x342df8[_0xf48327(0x864)][_0xf48327(0x9c0)](_0x4470b7),_0x1b802e(_0x4470b7[_0xf48327(0x12a6)]),document[_0xf48327(0x383)](_0xf48327(0xd4e))[_0xf48327(0x119a)]['remove'](_0xf48327(0x106d)),_0x5f3c03=null;});function _0xad374f(_0x39bd6a){const _0x1b8109=_0x12aa56;_0x5f3c03=_0x39bd6a;const _0x5a95a9=_0x41df36[_0x1b8109(0x864)][_0x41df36['activeChatId']],_0x4b2b9b=_0x5a95a9[_0x1b8109(0x12a6)][_0x1b8109(0xd12)](_0x54f999=>_0x54f999['id']===_0x39bd6a);if(!_0x4b2b9b)return;document[_0x1b8109(0x383)](_0x1b8109(0xcd9))[_0x1b8109(0x1be)]=_0x4b2b9b[_0x1b8109(0x9da)],document[_0x1b8109(0x383)](_0x1b8109(0xde1))[_0x1b8109(0x1be)]=_0x4b2b9b['persona'];const _0x222980=_0x4b2b9b['avatar']||(_0x41df36['chats'][_0x4b2b9b['id']]?_0x41df36['chats'][_0x4b2b9b['id']]['settings'][_0x1b8109(0x121e)]:_0x59100f);document[_0x1b8109(0x383)](_0x1b8109(0xe5a))[_0x1b8109(0xf6c)]=_0x222980,document[_0x1b8109(0x383)](_0x1b8109(0xd4e))[_0x1b8109(0x119a)][_0x1b8109(0xbff)](_0x1b8109(0x106d));}document['getElementById']('cancel-member-settings-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x7861d2=_0x12aa56;document['getElementById']('member-settings-modal')[_0x7861d2(0x119a)]['remove'](_0x7861d2(0x106d)),_0x5f3c03=null;}),document[_0x12aa56(0x383)](_0x12aa56(0x121f))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x435fd2=_0x12aa56;if(!_0x5f3c03)return;const _0x8839ab=_0x41df36['chats'][_0x41df36['activeChatId']],_0x5590f5=_0x8839ab['members']['find'](_0x19f1cf=>_0x19f1cf['id']===_0x5f3c03);if(!_0x5590f5)return;const _0x2bfa6f=document[_0x435fd2(0x383)]('member-name-input')['value']['trim']();if(!_0x2bfa6f){alert(_0x435fd2(0x7b0));return;}_0x5590f5[_0x435fd2(0x9da)]=_0x2bfa6f,_0x5590f5[_0x435fd2(0x48c)]=document[_0x435fd2(0x383)](_0x435fd2(0xde1))[_0x435fd2(0x1be)];const _0x233b5e=document[_0x435fd2(0x383)](_0x435fd2(0xe5a))[_0x435fd2(0xf6c)];_0x5590f5['avatar']=_0x233b5e;const _0x4b5584=_0x41df36[_0x435fd2(0x864)][_0x5590f5['id']];_0x4b5584&&(_0x4b5584[_0x435fd2(0x886)]['aiAvatar']=_0x233b5e,await _0x342df8[_0x435fd2(0x864)][_0x435fd2(0x9c0)](_0x4b5584)),await _0x342df8[_0x435fd2(0x864)][_0x435fd2(0x9c0)](_0x8839ab),_0x1b802e(_0x8839ab['members']),document[_0x435fd2(0x383)]('member-settings-modal')[_0x435fd2(0x119a)][_0x435fd2(0x131d)](_0x435fd2(0x106d)),_0x5f3c03=null;}),document['getElementById']('reset-theme-btn')[_0x12aa56(0x271)]('click',()=>{const _0x2b09be=_0x12aa56;document[_0x2b09be(0x383)](_0x2b09be(0xd8c))[_0x2b09be(0x2a3)]=!![];}),document[_0x12aa56(0x383)](_0x12aa56(0x10d0))['addEventListener']('click',async()=>{const _0x50698f=_0x12aa56;if(!_0x41df36[_0x50698f(0xfc5)])return;const _0x11774c=_0x41df36[_0x50698f(0x864)][_0x41df36[_0x50698f(0xfc5)]],_0x215f80=_0x11774c[_0x50698f(0x886)][_0x50698f(0xf49)]||![],_0x8bb791=document['getElementById'](_0x50698f(0xd67))[_0x50698f(0x1be)]['trim']();if(!_0x8bb791)return alert(_0x50698f(0x6c9));if(!_0x11774c[_0x50698f(0x1a2)]&&_0x8bb791!==_0x11774c[_0x50698f(0x461)]){if(!_0x11774c[_0x50698f(0xcf9)])_0x11774c['nameHistory']=[];if(!_0x11774c[_0x50698f(0xcf9)][_0x50698f(0xee2)](_0x11774c[_0x50698f(0x461)]))_0x11774c[_0x50698f(0xcf9)][_0x50698f(0x258)](_0x11774c['name']);}_0x11774c[_0x50698f(0x461)]=_0x8bb791;const _0x4a6b85=document[_0x50698f(0x89c)](_0x50698f(0xf1));_0x11774c['settings'][_0x50698f(0x53f)]=_0x4a6b85?_0x4a6b85[_0x50698f(0x1be)]:_0x50698f(0xba4),_0x11774c[_0x50698f(0x886)][_0x50698f(0x3eb)]=parseInt(document[_0x50698f(0x383)](_0x50698f(0xeb2))[_0x50698f(0x1be)]),_0x11774c[_0x50698f(0x886)]['customCss']=document['getElementById'](_0x50698f(0x9fe))[_0x50698f(0x1be)][_0x50698f(0x1cb)](),_0x11774c[_0x50698f(0x886)][_0x50698f(0xe63)]=document[_0x50698f(0x383)](_0x50698f(0x41b))[_0x50698f(0x1be)],_0x11774c[_0x50698f(0x886)][_0x50698f(0x43a)]=document[_0x50698f(0x383)]('my-avatar-preview')[_0x50698f(0xf6c)],_0x11774c['settings'][_0x50698f(0x1138)]=parseInt(document[_0x50698f(0x383)](_0x50698f(0xef0))[_0x50698f(0x1be)])||0xa,_0x11774c[_0x50698f(0x886)][_0x50698f(0x1d8)]=parseInt(document[_0x50698f(0x383)](_0x50698f(0x76e))['value'])||0xa;const _0x5408e0=document[_0x50698f(0x400)](_0x50698f(0xa3)),_0x408150=[];_0x5408e0[_0x50698f(0x19c)](_0x4c4eea=>{const _0x5d322f=_0x50698f;_0x4c4eea[_0x5d322f(0x1be)][_0x5d322f(0x1122)](_0x5d322f(0x48f))&&_0x408150[_0x5d322f(0x258)](_0x4c4eea[_0x5d322f(0x1be)]['replace'](_0x5d322f(0x48f),''));}),_0x11774c[_0x50698f(0x886)][_0x50698f(0xe8c)]=_0x408150;const _0x3a6ca8=document[_0x50698f(0x383)](_0x50698f(0x1080))[_0x50698f(0x2a3)];if(_0x3a6ca8){const _0x56959a=document['querySelectorAll'](_0x50698f(0xd20));_0x11774c[_0x50698f(0x886)][_0x50698f(0x20c)]=Array[_0x50698f(0x365)](_0x56959a)[_0x50698f(0xa79)](_0x235ff4=>_0x235ff4['value']);}else _0x11774c[_0x50698f(0x886)]['linkedMemoryChatIds']=[];_0x11774c[_0x50698f(0x886)][_0x50698f(0xd3)]=document['getElementById'](_0x50698f(0xd3e))[_0x50698f(0x2a3)],_0x11774c[_0x50698f(0x886)][_0x50698f(0x9d5)]=parseInt(document['getElementById']('auto-memory-interval')[_0x50698f(0x1be)])||0x14,_0x11774c['settings'][_0x50698f(0xfc8)]=document['getElementById'](_0x50698f(0x126e))[_0x50698f(0x2a3)],_0x11774c[_0x50698f(0x886)]['timeZone']=document[_0x50698f(0x383)]('time-zone-select')['value'];if(_0x11774c[_0x50698f(0x1a2)])_0x11774c[_0x50698f(0x886)][_0x50698f(0x8d5)]=document[_0x50698f(0x383)](_0x50698f(0x522))[_0x50698f(0x2a3)],_0x11774c['settings'][_0x50698f(0x52e)]=document[_0x50698f(0x383)]('my-group-nickname-input')['value'][_0x50698f(0x1cb)](),_0x11774c[_0x50698f(0x886)][_0x50698f(0x332)]=document['getElementById'](_0x50698f(0x10ca))['src'],_0x11774c[_0x50698f(0x886)][_0x50698f(0xf9c)]=parseInt(document[_0x50698f(0x383)]('group-action-cooldown-input')['value'])||0xa;else{_0x11774c[_0x50698f(0x886)][_0x50698f(0x8d5)]=document[_0x50698f(0x383)](_0x50698f(0x7cb))[_0x50698f(0x2a3)];const _0x27d2da=document[_0x50698f(0x383)](_0x50698f(0x7c2))[_0x50698f(0x2a3)];_0x11774c[_0x50698f(0x886)][_0x50698f(0xf49)]=_0x27d2da;if(_0x215f80===!![]&&_0x27d2da===![]){const _0x4fdfd2={'role':'system','content':'[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','timestamp':Date[_0x50698f(0x108d)](),'isHidden':!![]};_0x11774c[_0x50698f(0xd08)][_0x50698f(0x258)](_0x4fdfd2),console[_0x50698f(0xe72)](_0x50698f(0x10a2));}_0x11774c['settings'][_0x50698f(0x1380)]=document[_0x50698f(0x383)]('inject-thought-toggle')[_0x50698f(0x2a3)],_0x11774c[_0x50698f(0x886)][_0x50698f(0x58f)]=parseInt(document[_0x50698f(0x383)](_0x50698f(0x12ca))[_0x50698f(0x1be)])||0x64,_0x11774c[_0x50698f(0x886)]['offlineMaxLength']=parseInt(document[_0x50698f(0x383)](_0x50698f(0x2bd))[_0x50698f(0x1be)])||0x12c,_0x11774c['settings'][_0x50698f(0xca5)]=document[_0x50698f(0x383)]('offline-preset-select')[_0x50698f(0x1be)]||null;const _0x2733d1=document[_0x50698f(0x383)](_0x50698f(0xd8))[_0x50698f(0x1be)][_0x50698f(0x1cb)]();if(!_0x2733d1)return alert('对方本名不能为空！');_0x11774c[_0x50698f(0x283)]=_0x2733d1,_0x11774c[_0x50698f(0x886)]['aiPersona']=document[_0x50698f(0x383)]('ai-persona')[_0x50698f(0x1be)],_0x11774c[_0x50698f(0x886)][_0x50698f(0xad0)]=document['getElementById'](_0x50698f(0x1048))[_0x50698f(0x1be)][_0x50698f(0x1cb)](),_0x11774c[_0x50698f(0x886)][_0x50698f(0xa7f)]=document['getElementById'](_0x50698f(0x14a))['checked'],_0x11774c[_0x50698f(0x886)][_0x50698f(0x121e)]=document[_0x50698f(0x383)](_0x50698f(0x1393))[_0x50698f(0xf6c)],_0x11774c[_0x50698f(0x886)][_0x50698f(0x52e)]=document[_0x50698f(0x383)](_0x50698f(0xe25))[_0x50698f(0x1be)][_0x50698f(0x1cb)]()||'我',_0x11774c[_0x50698f(0x886)]['actionCooldownMinutes']=parseInt(document[_0x50698f(0x383)](_0x50698f(0xb9))['value'])||0xa,_0x11774c['settings'][_0x50698f(0xe11)]={'vertical':document['getElementById'](_0x50698f(0x734))[_0x50698f(0x1be)],'horizontal':document[_0x50698f(0x383)](_0x50698f(0x7f3))[_0x50698f(0x1be)],'offset':parseInt(document[_0x50698f(0x383)](_0x50698f(0x9a3))['value'])||0xa};const _0x1869ce=document[_0x50698f(0x383)]('assign-group-select')[_0x50698f(0x1be)];_0x11774c[_0x50698f(0x11a6)]=_0x1869ce?parseInt(_0x1869ce):null;}await _0x342df8[_0x50698f(0x864)][_0x50698f(0x9c0)](_0x11774c),!_0x11774c[_0x50698f(0x1a2)]&&(await _0x2d549c(_0x11774c),await _0x4fddd3(_0x11774c)),_0x368cae(_0x11774c),_0x5810fc(_0x11774c['settings'][_0x50698f(0x6cd)],_0x50698f(0xf7d),_0x50698f(0x4ac)),_0x105acd('chat-interface-screen'),_0x409076(_0x41df36['activeChatId']),_0x25558e();}),document[_0x12aa56(0x383)]('chat-settings-screen')['addEventListener'](_0x12aa56(0x5c7),_0x2184bf=>{const _0x3bb889=_0x12aa56;_0x2184bf['target'][_0x3bb889(0x119a)][_0x3bb889(0x987)](_0x3bb889(0xf03))&&_0x5cbf41(_0x3bb889(0x135e));}),document[_0x12aa56(0x383)](_0x12aa56(0xd4e))[_0x12aa56(0x271)]('click',_0x31fdca=>{const _0x1ddf46=_0x12aa56;_0x31fdca[_0x1ddf46(0xfab)][_0x1ddf46(0x119a)]['contains']('change-frame-btn')&&_0x5cbf41('member');});const _0x2101ef=document[_0x12aa56(0x383)](_0x12aa56(0x10d4)),_0x155ced=document['getElementById'](_0x12aa56(0xeed)),_0x93231=document[_0x12aa56(0x383)]('my-frame-tab'),_0x591204=document[_0x12aa56(0x383)](_0x12aa56(0x5cc)),_0x1e038f=document[_0x12aa56(0x383)](_0x12aa56(0x10b8));document[_0x12aa56(0x383)](_0x12aa56(0x1142))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4e2fd7),document[_0x12aa56(0x383)](_0x12aa56(0x1032))['addEventListener']('click',()=>{const _0x2ff350=_0x12aa56;_0x2101ef['classList']['remove'](_0x2ff350(0x106d)),_0x232685=![];}),_0x155ced[_0x12aa56(0x271)]('click',()=>{const _0x11c69a=_0x12aa56;_0x155ced['classList'][_0x11c69a(0xbff)](_0x11c69a(0xde5)),_0x93231[_0x11c69a(0x119a)]['remove'](_0x11c69a(0xde5)),_0x591204[_0x11c69a(0x655)][_0x11c69a(0x2b6)]='block',_0x1e038f['style'][_0x11c69a(0x2b6)]=_0x11c69a(0xa70);}),_0x93231['addEventListener'](_0x12aa56(0x5c7),()=>{const _0x1ce89f=_0x12aa56;_0x93231[_0x1ce89f(0x119a)][_0x1ce89f(0xbff)]('active'),_0x155ced[_0x1ce89f(0x119a)][_0x1ce89f(0x131d)](_0x1ce89f(0xde5)),_0x1e038f[_0x1ce89f(0x655)][_0x1ce89f(0x2b6)]=_0x1ce89f(0x27a),_0x591204[_0x1ce89f(0x655)][_0x1ce89f(0x2b6)]=_0x1ce89f(0xa70);}),document[_0x12aa56(0x383)](_0x12aa56(0x9d6))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x1af277=_0x12aa56;if(!_0x41df36[_0x1af277(0xfc5)])return;const _0x324d06=_0x41df36[_0x1af277(0x864)][_0x41df36[_0x1af277(0xfc5)]],_0x42ae5d=await _0x23a88b(_0x1af277(0x210),'此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？',{'confirmButtonClass':_0x1af277(0x51b)});_0x42ae5d&&(_0x324d06[_0x1af277(0xd08)]=[],_0x324d06[_0x1af277(0xa52)]=_0x1af277(0x1026),_0x324d06['randomJottings']=_0x1af277(0x1026),await _0x342df8[_0x1af277(0x864)][_0x1af277(0x9c0)](_0x324d06),_0x409076(_0x41df36[_0x1af277(0xfc5)]),_0x25558e(),_0x49b7f8['classList'][_0x1af277(0x131d)]('visible'));});const _0x534a64=(_0x4a9a66,_0xca10bc)=>{const _0x52d8e8=_0x12aa56;document[_0x52d8e8(0x383)](_0x4a9a66)[_0x52d8e8(0x271)](_0x52d8e8(0x173),async _0x53cd82=>{const _0x550ba3=_0x52d8e8,_0x1320e4=_0x53cd82[_0x550ba3(0xfab)][_0x550ba3(0x1185)][0x0];if(_0x1320e4){const _0x1f59fa=await new Promise((_0x1029e8,_0x546b90)=>{const _0x943038=_0x550ba3,_0x519455=new FileReader();_0x519455[_0x943038(0xb5b)]=()=>_0x1029e8(_0x519455['result']),_0x519455['onerror']=()=>_0x546b90(_0x519455[_0x943038(0x98)]),_0x519455[_0x943038(0x132a)](_0x1320e4);});_0xca10bc(_0x1f59fa),_0x53cd82[_0x550ba3(0xfab)]['value']=null;}});};_0x534a64(_0x12aa56(0x102e),_0x7d0958=>document[_0x12aa56(0x383)](_0x12aa56(0x1393))[_0x12aa56(0xf6c)]=_0x7d0958),_0x534a64(_0x12aa56(0x456),_0x4347dd=>document[_0x12aa56(0x383)](_0x12aa56(0x1324))['src']=_0x4347dd),_0x534a64(_0x12aa56(0xe22),_0x2e9f19=>document[_0x12aa56(0x383)](_0x12aa56(0x10ca))[_0x12aa56(0xf6c)]=_0x2e9f19),_0x534a64(_0x12aa56(0x8e3),_0x2c1f3b=>document[_0x12aa56(0x383)](_0x12aa56(0xe5a))[_0x12aa56(0xf6c)]=_0x2c1f3b),_0x534a64(_0x12aa56(0x87e),_0x5ad96d=>{const _0x561247=_0x12aa56;if(_0x41df36[_0x561247(0xfc5)]){_0x41df36['chats'][_0x41df36['activeChatId']][_0x561247(0x886)][_0x561247(0x415)]=_0x5ad96d;const _0x1ec464=document[_0x561247(0x383)](_0x561247(0x119b));_0x1ec464[_0x561247(0xf6c)]=_0x5ad96d,_0x1ec464[_0x561247(0x655)][_0x561247(0x2b6)]=_0x561247(0x27a),document[_0x561247(0x383)](_0x561247(0xad5))['style'][_0x561247(0x2b6)]=_0x561247(0xdcf);}}),_0x534a64(_0x12aa56(0x65a),_0x2cba43=>document['getElementById'](_0x12aa56(0xd7c))[_0x12aa56(0xf6c)]=_0x2cba43),document[_0x12aa56(0x383)]('remove-bg-btn')[_0x12aa56(0x271)]('click',()=>{const _0xebda33=_0x12aa56;if(_0x41df36[_0xebda33(0xfc5)]){_0x41df36['chats'][_0x41df36['activeChatId']][_0xebda33(0x886)][_0xebda33(0x415)]='';const _0x3ea77e=document[_0xebda33(0x383)]('bg-preview');_0x3ea77e[_0xebda33(0xf6c)]='',_0x3ea77e[_0xebda33(0x655)]['display']=_0xebda33(0xa70),document['getElementById'](_0xebda33(0xad5))[_0xebda33(0x655)][_0xebda33(0x2b6)]='none';}});const _0x1dcaa5=document['getElementById'](_0x12aa56(0xe0));document['getElementById'](_0x12aa56(0x424))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x54ce8c=_0x12aa56,_0x4ff9eb=_0x41df36[_0x54ce8c(0x864)][_0x41df36[_0x54ce8c(0xfc5)]];_0x4ff9eb&&_0x4ff9eb[_0x54ce8c(0x886)]['stickerCategoryId']?_0x45a6e6=_0x4ff9eb['settings'][_0x54ce8c(0xab3)]:_0x45a6e6=_0x54ce8c(0x1282),_0x59fe05(),_0x1dcaa5['classList'][_0x54ce8c(0xbff)](_0x54ce8c(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0x486))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x1dcaa5['classList']['remove'](_0x12aa56(0x106d))),document[_0x12aa56(0x383)](_0x12aa56(0x8c1))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x521c50),document['getElementById'](_0x12aa56(0xe83))['addEventListener']('click',()=>document[_0x12aa56(0x383)](_0x12aa56(0x2d9))['click']()),document[_0x12aa56(0x383)]('sticker-upload-input')[_0x12aa56(0x271)](_0x12aa56(0x173),async _0x478270=>{const _0x1bec37=_0x12aa56,_0x394c0d=_0x478270['target'][_0x1bec37(0x1185)][0x0];if(!_0x394c0d)return;const _0x3518a9=new FileReader();_0x3518a9['readAsDataURL'](_0x394c0d),_0x3518a9[_0x1bec37(0xb5b)]=async()=>{const _0x58d663=_0x1bec37,_0x256a19=_0x3518a9[_0x58d663(0xa86)],_0x17a02f=await _0x12e332('命名表情',_0x58d663(0x40a));if(_0x17a02f&&_0x17a02f[_0x58d663(0x1cb)]()){const _0x2a5562={'id':_0x58d663(0x49d)+Date[_0x58d663(0x108d)](),'url':_0x256a19,'name':_0x17a02f['trim'](),'categoryId':_0x45a6e6!==_0x58d663(0x1282)&&_0x45a6e6!==_0x58d663(0x1289)?_0x45a6e6:null};await _0x342df8[_0x58d663(0x823)][_0x58d663(0xbff)](_0x2a5562),_0x41df36['userStickers'][_0x58d663(0x258)](_0x2a5562),_0x59fe05();}else{if(_0x17a02f!==null)alert(_0x58d663(0x7fc));}},_0x478270[_0x1bec37(0xfab)]['value']=null;}),document[_0x12aa56(0x383)](_0x12aa56(0x97c))['addEventListener'](_0x12aa56(0x5c7),()=>document[_0x12aa56(0x383)](_0x12aa56(0xd4b))[_0x12aa56(0x5c7)]()),document[_0x12aa56(0x383)](_0x12aa56(0xd4b))['addEventListener'](_0x12aa56(0x173),async _0x136d30=>{const _0x2923d8=_0x12aa56,_0xa95f51=_0x136d30[_0x2923d8(0xfab)][_0x2923d8(0x1185)][0x0];if(!_0xa95f51||!_0x41df36['activeChatId'])return;const _0x5e2c8f=new FileReader();_0x5e2c8f[_0x2923d8(0xb5b)]=async _0x200b05=>{const _0x3fc92d=_0x2923d8,_0x2d1fc2=_0x200b05[_0x3fc92d(0xfab)][_0x3fc92d(0xa86)],_0xa19ebd=_0x41df36[_0x3fc92d(0x864)][_0x41df36[_0x3fc92d(0xfc5)]],_0x37e23={'role':'user','content':[{'type':_0x3fc92d(0x122d),'image_url':{'url':_0x2d1fc2}}],'timestamp':Date[_0x3fc92d(0x108d)]()};_0xa19ebd['history'][_0x3fc92d(0x258)](_0x37e23),await _0x342df8[_0x3fc92d(0x864)][_0x3fc92d(0x9c0)](_0xa19ebd),_0x323467(_0x37e23,_0xa19ebd),_0x25558e();},_0x5e2c8f[_0x2923d8(0x132a)](_0xa95f51),_0x136d30[_0x2923d8(0xfab)]['value']=null;}),document[_0x12aa56(0x383)](_0x12aa56(0xbd9))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x535534=_0x12aa56;if(!_0x41df36[_0x535534(0xfc5)])return;const _0x3f0c70=await _0x12e332(_0x535534(0x9d3),'请输入你想说的内容：');if(_0x3f0c70&&_0x3f0c70[_0x535534(0x1cb)]()){const _0x55cf92=_0x41df36[_0x535534(0x864)][_0x41df36['activeChatId']],_0x1c4d2b={'role':'user','type':_0x535534(0xa4f),'content':_0x3f0c70['trim'](),'timestamp':Date[_0x535534(0x108d)]()};_0x55cf92[_0x535534(0xd08)][_0x535534(0x258)](_0x1c4d2b),await _0x342df8[_0x535534(0x864)][_0x535534(0x9c0)](_0x55cf92),_0x323467(_0x1c4d2b,_0x55cf92),_0x25558e();}}),document[_0x12aa56(0x383)](_0x12aa56(0x345))['addEventListener'](_0x12aa56(0x5c7),async()=>{const _0x25df95=_0x12aa56;if(!_0x41df36[_0x25df95(0xfc5)])return;const _0x3ecf98=await _0x12e332(_0x25df95(0x25e),_0x25df95(0x11ff));if(_0x3ecf98&&_0x3ecf98[_0x25df95(0x1cb)]()){const _0x464f13=_0x41df36[_0x25df95(0x864)][_0x41df36[_0x25df95(0xfc5)]],_0x2ab700={'role':_0x25df95(0x66e),'type':'user_photo','content':_0x3ecf98[_0x25df95(0x1cb)](),'timestamp':Date[_0x25df95(0x108d)]()};_0x464f13['history'][_0x25df95(0x258)](_0x2ab700),await _0x342df8['chats']['put'](_0x464f13),_0x323467(_0x2ab700,_0x464f13),_0x25558e();}});const _0x38abd0=document[_0x12aa56(0x383)]('waimai-request-modal');document[_0x12aa56(0x383)](_0x12aa56(0xc7b))['addEventListener'](_0x12aa56(0x5c7),()=>{const _0x2c984d=_0x12aa56;_0x38abd0[_0x2c984d(0x119a)][_0x2c984d(0xbff)](_0x2c984d(0x106d));}),_0x38abd0[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x3e6743=>{const _0x3b1a50=_0x12aa56;_0x3e6743[_0x3b1a50(0xfab)]===_0x38abd0&&_0x38abd0[_0x3b1a50(0x119a)][_0x3b1a50(0x131d)](_0x3b1a50(0x106d));}),document[_0x12aa56(0x383)]('waimai-order-for-ai-btn')['addEventListener']('click',_0x4f91d8),document['getElementById']('waimai-confirm-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x391cf9=_0x12aa56;if(!_0x41df36[_0x391cf9(0xfc5)])return;const _0x5b1793=document[_0x391cf9(0x383)]('waimai-product-info'),_0x4ad2e1=document['getElementById'](_0x391cf9(0x96e)),_0x287735=_0x5b1793[_0x391cf9(0x1be)]['trim'](),_0x2414c5=parseFloat(_0x4ad2e1[_0x391cf9(0x1be)]);if(!_0x287735||isNaN(_0x2414c5)||_0x2414c5<=0x0){alert(_0x391cf9(0xa1));return;}const _0x3c9b85=_0x41df36[_0x391cf9(0x864)][_0x41df36[_0x391cf9(0xfc5)]],_0x3438ea=Date[_0x391cf9(0x108d)](),_0x285d22=_0x3c9b85[_0x391cf9(0x1a2)]?_0x3c9b85[_0x391cf9(0x886)]['myNickname']||'我':'我',_0x3827ad={'role':'user','senderName':_0x285d22,'type':_0x391cf9(0x990),'productInfo':_0x287735,'amount':_0x2414c5,'status':'pending','countdownEndTime':_0x3438ea+0xf*0x3c*0x3e8,'timestamp':_0x3438ea};_0x3c9b85[_0x391cf9(0xd08)][_0x391cf9(0x258)](_0x3827ad),await _0x342df8[_0x391cf9(0x864)][_0x391cf9(0x9c0)](_0x3c9b85),_0x323467(_0x3827ad,_0x3c9b85),_0x25558e(),_0x5b1793[_0x391cf9(0x1be)]='',_0x4ad2e1[_0x391cf9(0x1be)]='',_0x38abd0[_0x391cf9(0x119a)][_0x391cf9(0x131d)](_0x391cf9(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0x1344))['addEventListener'](_0x12aa56(0x5c7),_0x26abbe),document['getElementById'](_0x12aa56(0x7ba))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x5124ef),document[_0x12aa56(0x383)](_0x12aa56(0x230))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1c8e8a),document[_0x12aa56(0x383)]('cancel-persona-editor-btn')[_0x12aa56(0x271)]('click',_0x4ddb88),document['getElementById']('save-persona-preset-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x3e1bff),document[_0x12aa56(0x383)](_0x12aa56(0xe16))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x242787),document['getElementById'](_0x12aa56(0xe87))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1a8286),document[_0x12aa56(0x383)](_0x12aa56(0xba6))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x73ca96),document[_0x12aa56(0x383)](_0x12aa56(0x9b))['addEventListener'](_0x12aa56(0x5c7),_0x11c2ba),document['getElementById'](_0x12aa56(0xd0))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x1f1902=_0x12aa56;if(_0x4f051e['size']===0x0)return;const _0x320414=await _0x23a88b(_0x1f1902(0xa5b),_0x1f1902(0xb8c)+_0x4f051e[_0x1f1902(0x1240)]+_0x1f1902(0x53b),{'confirmButtonClass':_0x1f1902(0x51b)});if(_0x320414){const _0x29cedf=_0x41df36[_0x1f1902(0x864)][_0x41df36[_0x1f1902(0xfc5)]];let _0x2d8be9=[];for(const _0xb97432 of _0x4f051e){const _0x2c19c4=_0x29cedf['history'][_0x1f1902(0xd12)](_0x1a166f=>_0x1a166f[_0x1f1902(0x3b7)]===_0xb97432);_0x2c19c4&&_0x2c19c4[_0x1f1902(0xa6b)]===_0x1f1902(0x11b9)&&_0x2d8be9[_0x1f1902(0x258)](_0x1f1902(0xe62)+_0x2c19c4[_0x1f1902(0xca8)]+_0x1f1902(0x5a9)+_0x2c19c4[_0x1f1902(0x3b7)]+')');}_0x29cedf[_0x1f1902(0xd08)]=_0x29cedf[_0x1f1902(0xd08)][_0x1f1902(0x98a)](_0x29e4e8=>!_0x4f051e[_0x1f1902(0xcde)](_0x29e4e8[_0x1f1902(0x3b7)]));let _0x2b4726=_0x1f1902(0x1b6);_0x2d8be9['length']>0x0&&(_0x2b4726+=_0x1f1902(0x243)+_0x2d8be9['join']('；')+'。');_0x2b4726+=_0x1f1902(0xf67);const _0x57667b={'role':'system','content':_0x1f1902(0x7d2)+_0x2b4726+']','timestamp':Date[_0x1f1902(0x108d)](),'isHidden':!![]};_0x29cedf['history'][_0x1f1902(0x258)](_0x57667b),await _0x342df8[_0x1f1902(0x864)][_0x1f1902(0x9c0)](_0x29cedf),_0x409076(_0x41df36[_0x1f1902(0xfc5)]),_0x25558e();}}),document[_0x12aa56(0x383)](_0x12aa56(0x1ca))['addEventListener']('click',async()=>{const _0x31fc69=_0x12aa56;if(_0x4f051e[_0x31fc69(0x1240)]===0x0)return;const _0x450a1d=await _0x23a88b(_0x31fc69(0x95e),'这将从历史记录中【永久抹除】这\x20'+_0x4f051e['size']+_0x31fc69(0x738),{'confirmButtonClass':_0x31fc69(0x51b),'confirmText':_0x31fc69(0x14d)});if(_0x450a1d){const _0xabcb08=_0x41df36['chats'][_0x41df36['activeChatId']];_0xabcb08['history']=_0xabcb08[_0x31fc69(0xd08)][_0x31fc69(0x98a)](_0x2b84b2=>!_0x4f051e[_0x31fc69(0xcde)](_0x2b84b2[_0x31fc69(0x3b7)])),await _0x342df8[_0x31fc69(0x864)][_0x31fc69(0x9c0)](_0xabcb08),_0x409076(_0x41df36['activeChatId']),_0x25558e();}});const _0x1712e4=document[_0x12aa56(0x383)](_0x12aa56(0x132e));_0x1712e4[_0x12aa56(0x271)]('input',()=>_0x59518a(_0x1712e4['value']['trim'](),!![])),document[_0x12aa56(0x383)](_0x12aa56(0x6b6))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x45cfde=_0x12aa56,_0x39ad92=_0x1712e4[_0x45cfde(0x1be)][_0x45cfde(0x1cb)]();if(!_0x39ad92){alert(_0x45cfde(0xcbb));return;}_0x59518a(_0x39ad92,![]),_0x41df36['globalSettings'][_0x45cfde(0x1082)]=_0x39ad92,await _0x342df8[_0x45cfde(0xc0)][_0x45cfde(0x9c0)](_0x41df36[_0x45cfde(0xc0)]),alert('字体已保存并应用！');}),document['getElementById'](_0x12aa56(0x9c6))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x6f8659),document[_0x12aa56(0x400)]('#chat-list-bottom-nav\x20.nav-item')['forEach'](_0x4d817a=>{const _0xcfe443=_0x12aa56;_0x4d817a[_0xcfe443(0x271)](_0xcfe443(0x5c7),()=>_0x18bbbb(_0x4d817a[_0xcfe443(0x118)][_0xcfe443(0x352)]));}),document['getElementById'](_0x12aa56(0x72a))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x18bbbb(_0x12aa56(0x502))),document[_0x12aa56(0x383)](_0x12aa56(0xff6))[_0x12aa56(0x271)]('click',async()=>{const _0x26a9bc=_0x12aa56,_0x4c2ada=await _0x12e332(_0x26a9bc(0x10cc),_0x26a9bc(0xef9),_0x41df36['qzoneSettings']['nickname']);_0x4c2ada&&_0x4c2ada[_0x26a9bc(0x1cb)]()&&(_0x41df36[_0x26a9bc(0x571)]['nickname']=_0x4c2ada['trim'](),await _0x1cf554(),_0x4a8610());}),document[_0x12aa56(0x383)](_0x12aa56(0x12b4))['addEventListener'](_0x12aa56(0x5c7),()=>document[_0x12aa56(0x383)](_0x12aa56(0x13a2))[_0x12aa56(0x5c7)]()),document[_0x12aa56(0x383)](_0x12aa56(0x50a))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>document[_0x12aa56(0x383)](_0x12aa56(0xbc0))[_0x12aa56(0x5c7)]()),document[_0x12aa56(0x383)](_0x12aa56(0x13a2))[_0x12aa56(0x271)](_0x12aa56(0x173),async _0x4083b8=>{const _0x2afd1a=_0x12aa56,_0x40621f=_0x4083b8[_0x2afd1a(0xfab)]['files'][0x0];if(_0x40621f){const _0x3234a3=await new Promise(_0x102c17=>{const _0x125638=_0x2afd1a,_0x55581d=new FileReader();_0x55581d['onload']=()=>_0x102c17(_0x55581d['result']),_0x55581d[_0x125638(0x132a)](_0x40621f);});_0x41df36[_0x2afd1a(0x571)][_0x2afd1a(0xb47)]=_0x3234a3,await _0x1cf554(),_0x4a8610();}_0x4083b8[_0x2afd1a(0xfab)][_0x2afd1a(0x1be)]=null;}),document[_0x12aa56(0x383)](_0x12aa56(0xbc0))['addEventListener'](_0x12aa56(0x173),async _0x259091=>{const _0x214aff=_0x12aa56,_0x35b2fa=_0x259091['target'][_0x214aff(0x1185)][0x0];if(_0x35b2fa){const _0x555e6c=await new Promise(_0x511696=>{const _0xfeb37d=_0x214aff,_0x3c28da=new FileReader();_0x3c28da[_0xfeb37d(0xb5b)]=()=>_0x511696(_0x3c28da[_0xfeb37d(0xa86)]),_0x3c28da[_0xfeb37d(0x132a)](_0x35b2fa);});_0x41df36[_0x214aff(0x571)][_0x214aff(0x647)]=_0x555e6c,await _0x1cf554(),_0x4a8610();}_0x259091[_0x214aff(0xfab)]['value']=null;}),document[_0x12aa56(0x383)](_0x12aa56(0xd4f))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0xd22d68=_0x12aa56;_0x316248();const _0x15f2aa=document['getElementById']('create-post-modal');_0x15f2aa[_0xd22d68(0x118)][_0xd22d68(0x10f2)]=_0xd22d68(0x23e),_0x15f2aa[_0xd22d68(0x89c)](_0xd22d68(0x129c))['style']['display']=_0xd22d68(0xa70),_0x15f2aa[_0xd22d68(0x89c)](_0xd22d68(0x982))[_0xd22d68(0x655)][_0xd22d68(0x2b6)]='none',_0x15f2aa['querySelector'](_0xd22d68(0x2f5))[_0xd22d68(0x655)][_0xd22d68(0x2b6)]=_0xd22d68(0xa70),_0x15f2aa[_0xd22d68(0x89c)](_0xd22d68(0x735))[_0xd22d68(0xda9)]=_0xd22d68(0x972);const _0x4ea2db=document[_0xd22d68(0x383)](_0xd22d68(0x501));_0x4ea2db[_0xd22d68(0x45c)]='';const _0x248028=await _0x342df8[_0xd22d68(0x108f)]['toArray']();_0x248028[_0xd22d68(0xfde)]>0x0?_0x248028['forEach'](_0x11d236=>{const _0x4f7dd0=_0xd22d68,_0x1985ff=document[_0x4f7dd0(0xe1b)](_0x4f7dd0(0x558));_0x1985ff[_0x4f7dd0(0x655)]['display']=_0x4f7dd0(0x27a),_0x1985ff['innerHTML']=_0x4f7dd0(0xe43)+_0x11d236['id']+_0x4f7dd0(0x61a)+_0x11d236[_0x4f7dd0(0x461)],_0x4ea2db[_0x4f7dd0(0xe91)](_0x1985ff);}):_0x4ea2db['innerHTML']='<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>',_0x15f2aa[_0xd22d68(0x119a)][_0xd22d68(0xbff)](_0xd22d68(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0xeae))['addEventListener'](_0x12aa56(0x5c7),async()=>{const _0x20fad0=_0x12aa56;_0x316248();const _0x1a23c0=document['getElementById'](_0x20fad0(0xd5a));_0x1a23c0['dataset'][_0x20fad0(0x10f2)]=_0x20fad0(0xc92),_0x1a23c0[_0x20fad0(0x89c)](_0x20fad0(0x129c))[_0x20fad0(0x655)][_0x20fad0(0x2b6)]=_0x20fad0(0x2aa),_0x1a23c0[_0x20fad0(0x89c)]('#image-mode-content')[_0x20fad0(0x119a)][_0x20fad0(0xbff)](_0x20fad0(0xde5)),_0x1a23c0[_0x20fad0(0x89c)]('#text-image-mode-content')[_0x20fad0(0x119a)][_0x20fad0(0x131d)](_0x20fad0(0xde5)),_0x1a23c0['querySelector'](_0x20fad0(0x735))[_0x20fad0(0xda9)]=_0x20fad0(0x9ad);const _0x4e01f1=document[_0x20fad0(0x383)](_0x20fad0(0x501));_0x4e01f1[_0x20fad0(0x45c)]='';const _0x13bc50=await _0x342df8['qzoneGroups']['toArray']();_0x13bc50[_0x20fad0(0xfde)]>0x0?_0x13bc50[_0x20fad0(0x19c)](_0x5aecf2=>{const _0x57e9f5=_0x20fad0,_0xd20c24=document[_0x57e9f5(0xe1b)](_0x57e9f5(0x558));_0xd20c24[_0x57e9f5(0x655)][_0x57e9f5(0x2b6)]='block',_0xd20c24[_0x57e9f5(0x45c)]=_0x57e9f5(0xe43)+_0x5aecf2['id']+'\x22>\x20'+_0x5aecf2[_0x57e9f5(0x461)],_0x4e01f1[_0x57e9f5(0xe91)](_0xd20c24);}):_0x4e01f1[_0x20fad0(0x45c)]='<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>',_0x1a23c0['classList']['add'](_0x20fad0(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0x115e))[_0x12aa56(0x271)]('click',async()=>{const _0x5b545b=_0x12aa56;await _0x516f71(),_0x105acd(_0x5b545b(0x112d));}),document['getElementById'](_0x12aa56(0x1365))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x2e13cf=_0x12aa56;_0x105acd(_0x2e13cf(0x11f7)),_0x18bbbb(_0x2e13cf(0xc0c));}),document['getElementById']('album-photos-back-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x4c6151=_0x12aa56;_0x41df36[_0x4c6151(0xf24)]=null,_0x105acd(_0x4c6151(0x112d));}),document[_0x12aa56(0x383)]('album-upload-photo-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>document[_0x12aa56(0x383)](_0x12aa56(0x16e))['click']()),document[_0x12aa56(0x383)]('album-photo-input')[_0x12aa56(0x271)](_0x12aa56(0x173),async _0x39d303=>{const _0x18982f=_0x12aa56;if(!_0x41df36[_0x18982f(0xf24)])return;const _0x3a4bca=_0x39d303['target'][_0x18982f(0x1185)];if(!_0x3a4bca[_0x18982f(0xfde)])return;const _0x3776cd=await _0x342df8[_0x18982f(0xb86)][_0x18982f(0x1a3)](_0x41df36[_0x18982f(0xf24)]);for(const _0x353c99 of _0x3a4bca){const _0x2de547=await new Promise(_0x796f0f=>{const _0x574aa3=_0x18982f,_0x53654e=new FileReader();_0x53654e['onload']=()=>_0x796f0f(_0x53654e[_0x574aa3(0xa86)]),_0x53654e[_0x574aa3(0x132a)](_0x353c99);});await _0x342df8[_0x18982f(0x1218)]['add']({'albumId':_0x41df36['activeAlbumId'],'url':_0x2de547,'createdAt':Date[_0x18982f(0x108d)]()});}const _0x239d43=await _0x342df8['qzonePhotos'][_0x18982f(0x6bd)]('albumId')[_0x18982f(0x5b3)](_0x41df36[_0x18982f(0xf24)])['count'](),_0x1ed775={'photoCount':_0x239d43};if(!_0x3776cd[_0x18982f(0xa97)]||_0x3776cd[_0x18982f(0xd93)][_0x18982f(0xee2)](_0x18982f(0xda9))){const _0x5ba6f7=await _0x342df8[_0x18982f(0x1218)]['where'](_0x18982f(0x11c8))[_0x18982f(0x5b3)](_0x41df36[_0x18982f(0xf24)])[_0x18982f(0x26e)]();if(_0x5ba6f7)_0x1ed775[_0x18982f(0xd93)]=_0x5ba6f7['url'];}await _0x342df8[_0x18982f(0xb86)][_0x18982f(0xaf9)](_0x41df36[_0x18982f(0xf24)],_0x1ed775),await _0x34db5b(),await _0x516f71(),_0x39d303[_0x18982f(0xfab)][_0x18982f(0x1be)]=null,alert(_0x18982f(0x6f4));}),document[_0x12aa56(0x383)]('photos-grid-page')[_0x12aa56(0x271)](_0x12aa56(0x5c7),async _0xceb786=>{const _0x5dc0e3=_0x12aa56,_0xfd4d52=_0xceb786[_0x5dc0e3(0xfab)][_0x5dc0e3(0x58c)](_0x5dc0e3(0x112f)),_0x484ba2=_0xceb786[_0x5dc0e3(0xfab)][_0x5dc0e3(0x58c)](_0x5dc0e3(0xc99));if(_0xfd4d52){_0xceb786[_0x5dc0e3(0x1311)]();const _0x1ade49=parseInt(_0xfd4d52[_0x5dc0e3(0x118)][_0x5dc0e3(0xeba)]),_0x2fccb1=await _0x23a88b(_0x5dc0e3(0x26c),_0x5dc0e3(0x133f),{'confirmButtonClass':'btn-danger'});if(_0x2fccb1){const _0x6ec2a6=await _0x342df8[_0x5dc0e3(0x1218)][_0x5dc0e3(0x1a3)](_0x1ade49);if(!_0x6ec2a6)return;await _0x342df8['qzonePhotos'][_0x5dc0e3(0x971)](_0x1ade49);const _0x370087=await _0x342df8[_0x5dc0e3(0xb86)][_0x5dc0e3(0x1a3)](_0x41df36[_0x5dc0e3(0xf24)]),_0x211b45=(_0x370087[_0x5dc0e3(0xa97)]||0x1)-0x1,_0x47271c={'photoCount':_0x211b45};if(_0x370087[_0x5dc0e3(0xd93)]===_0x6ec2a6['url']){const _0x3e19da=await _0x342df8[_0x5dc0e3(0x1218)][_0x5dc0e3(0x6bd)]('albumId')['equals'](_0x41df36[_0x5dc0e3(0xf24)])[_0x5dc0e3(0x26e)]();_0x47271c[_0x5dc0e3(0xd93)]=_0x3e19da?_0x3e19da[_0x5dc0e3(0x2fa)]:'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png';}await _0x342df8[_0x5dc0e3(0xb86)][_0x5dc0e3(0xaf9)](_0x41df36[_0x5dc0e3(0xf24)],_0x47271c),await _0x34db5b(),await _0x516f71(),alert(_0x5dc0e3(0x8b0));}}else _0x484ba2&&_0x149c8c(_0x484ba2[_0x5dc0e3(0xf6c)]);}),document['getElementById']('photo-viewer-close-btn')[_0x12aa56(0x271)]('click',_0x1a0c88),document['getElementById'](_0x12aa56(0x1ef))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x5ad994),document[_0x12aa56(0x383)]('photo-viewer-prev-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x13d244),document[_0x12aa56(0x271)](_0x12aa56(0xcd4),_0xff9387=>{const _0x220fb6=_0x12aa56;if(!_0x4b0146[_0x220fb6(0xe81)])return;if(_0xff9387[_0x220fb6(0x965)]===_0x220fb6(0x134f))_0x5ad994();else{if(_0xff9387[_0x220fb6(0x965)]===_0x220fb6(0x11be))_0x13d244();else _0xff9387['key']===_0x220fb6(0xa0b)&&_0x1a0c88();}}),document[_0x12aa56(0x383)]('create-album-btn-page')[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x18233e=_0x12aa56,_0xb207c5=await _0x12e332('创建新相册',_0x18233e(0x11d3));if(_0xb207c5&&_0xb207c5[_0x18233e(0x1cb)]()){const _0x418977={'name':_0xb207c5[_0x18233e(0x1cb)](),'coverUrl':'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','photoCount':0x0,'createdAt':Date[_0x18233e(0x108d)]()};await _0x342df8[_0x18233e(0xb86)][_0x18233e(0xbff)](_0x418977),await _0x516f71(),alert(_0x18233e(0xa01)+_0xb207c5+_0x18233e(0x826));}else _0xb207c5!==null&&alert(_0x18233e(0xfa5));}),document['getElementById'](_0x12aa56(0x1070))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>document[_0x12aa56(0x383)](_0x12aa56(0xd5a))['classList'][_0x12aa56(0x131d)](_0x12aa56(0x106d))),document[_0x12aa56(0x383)]('post-upload-local-btn')[_0x12aa56(0x271)]('click',()=>document[_0x12aa56(0x383)](_0x12aa56(0xea1))[_0x12aa56(0x5c7)]()),document['getElementById']('post-local-image-input')['addEventListener']('change',_0x3cd440=>{const _0x10c86f=_0x12aa56,_0x47a0fd=_0x3cd440[_0x10c86f(0xfab)][_0x10c86f(0x1185)][0x0];if(_0x47a0fd){const _0x43eb47=new FileReader();_0x43eb47[_0x10c86f(0xb5b)]=_0x1b7433=>{const _0x5490e4=_0x10c86f;document['getElementById'](_0x5490e4(0x20f))[_0x5490e4(0xf6c)]=_0x1b7433['target'][_0x5490e4(0xa86)],document[_0x5490e4(0x383)](_0x5490e4(0xcfb))[_0x5490e4(0x119a)][_0x5490e4(0xbff)](_0x5490e4(0x106d)),document[_0x5490e4(0x383)](_0x5490e4(0x7a3))[_0x5490e4(0x655)]['display']=_0x5490e4(0x27a);},_0x43eb47[_0x10c86f(0x132a)](_0x47a0fd);}}),document[_0x12aa56(0x383)](_0x12aa56(0x555))['addEventListener']('click',async()=>{const _0x2d9f0a=_0x12aa56,_0xc4bac5=await _0x12e332('输入图片URL','请输入网络图片的链接','',_0x2d9f0a(0x2fa));_0xc4bac5&&(document[_0x2d9f0a(0x383)](_0x2d9f0a(0x20f))[_0x2d9f0a(0xf6c)]=_0xc4bac5,document['getElementById']('post-image-preview-container')[_0x2d9f0a(0x119a)][_0x2d9f0a(0xbff)](_0x2d9f0a(0x106d)),document[_0x2d9f0a(0x383)](_0x2d9f0a(0x7a3))[_0x2d9f0a(0x655)][_0x2d9f0a(0x2b6)]=_0x2d9f0a(0x27a));}),document['getElementById']('post-remove-image-btn')[_0x12aa56(0x271)]('click',()=>_0x316248());const _0x564797=document[_0x12aa56(0x383)](_0x12aa56(0xaeb)),_0x38cd3e=document[_0x12aa56(0x383)](_0x12aa56(0x373)),_0xbe1484=document[_0x12aa56(0x383)]('image-mode-content'),_0xe4ba3d=document[_0x12aa56(0x383)](_0x12aa56(0x1300));_0x564797[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x2121ab=_0x12aa56;_0x564797['classList']['add'](_0x2121ab(0xde5)),_0x38cd3e['classList'][_0x2121ab(0x131d)](_0x2121ab(0xde5)),_0xbe1484[_0x2121ab(0x119a)]['add'](_0x2121ab(0xde5)),_0xe4ba3d['classList'][_0x2121ab(0x131d)](_0x2121ab(0xde5));}),_0x38cd3e[_0x12aa56(0x271)]('click',()=>{const _0x166c0a=_0x12aa56;_0x38cd3e[_0x166c0a(0x119a)]['add'](_0x166c0a(0xde5)),_0x564797['classList'][_0x166c0a(0x131d)](_0x166c0a(0xde5)),_0xe4ba3d[_0x166c0a(0x119a)]['add'](_0x166c0a(0xde5)),_0xbe1484['classList'][_0x166c0a(0x131d)]('active');}),document[_0x12aa56(0x383)](_0x12aa56(0x500))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x31fa8b=_0x12aa56,_0x9fc733=document['getElementById']('create-post-modal'),_0x2173ad=_0x9fc733[_0x31fa8b(0x118)][_0x31fa8b(0x10f2)],_0x2539c5=document[_0x31fa8b(0x89c)](_0x31fa8b(0xda8))[_0x31fa8b(0x1be)];let _0x143ec3=null;_0x2539c5===_0x31fa8b(0x3fa)&&(_0x143ec3=Array[_0x31fa8b(0x365)](document[_0x31fa8b(0x400)]('input[name=\x22visibility_group\x22]:checked'))[_0x31fa8b(0xa79)](_0x18ff3e=>parseInt(_0x18ff3e[_0x31fa8b(0x1be)])));let _0x39fbcf={};const _0x478755={'timestamp':Date[_0x31fa8b(0x108d)](),'authorId':_0x31fa8b(0x66e),'visibleGroupIds':_0x143ec3};if(_0x2173ad===_0x31fa8b(0x23e)){const _0x10ee62=document['getElementById'](_0x31fa8b(0x12aa))['value'][_0x31fa8b(0x1cb)]();if(!_0x10ee62){alert(_0x31fa8b(0x304));return;}_0x39fbcf={..._0x478755,'type':_0x31fa8b(0x23e),'content':_0x10ee62};}else{const _0x1628bc=document[_0x31fa8b(0x383)]('post-public-text')[_0x31fa8b(0x1be)][_0x31fa8b(0x1cb)](),_0x3de435=document[_0x31fa8b(0x383)](_0x31fa8b(0xc3a))[_0x31fa8b(0x119a)][_0x31fa8b(0x987)](_0x31fa8b(0xde5));if(_0x3de435){const _0x47720e=document[_0x31fa8b(0x383)](_0x31fa8b(0x20f))[_0x31fa8b(0xf6c)],_0x4aa1b2=document[_0x31fa8b(0x383)](_0x31fa8b(0xcbe))[_0x31fa8b(0x1be)][_0x31fa8b(0x1cb)]();if(!_0x47720e||!(_0x47720e['startsWith'](_0x31fa8b(0xaec))||_0x47720e[_0x31fa8b(0x1122)]('data:'))){alert('请先添加一张图片再发布动态哦！');return;}if(!_0x4aa1b2){alert(_0x31fa8b(0x129a));return;}_0x39fbcf={..._0x478755,'type':'image_post','publicText':_0x1628bc,'imageUrl':_0x47720e,'imageDescription':_0x4aa1b2};}else{const _0x4e7102=document[_0x31fa8b(0x383)](_0x31fa8b(0xe2f))['value'][_0x31fa8b(0x1cb)]();if(!_0x4e7102){alert(_0x31fa8b(0x899));return;}_0x39fbcf={..._0x478755,'type':_0x31fa8b(0x68e),'publicText':_0x1628bc,'hiddenContent':_0x4e7102};}}const _0x4b5611=await _0x342df8[_0x31fa8b(0x35a)]['add'](_0x39fbcf);let _0xaa20cb=_0x39fbcf[_0x31fa8b(0x11b6)]||_0x39fbcf[_0x31fa8b(0xbdc)]||_0x39fbcf[_0x31fa8b(0x8cf)]||_0x39fbcf[_0x31fa8b(0x4e6)]||_0x31fa8b(0xdf2);_0xaa20cb=_0xaa20cb['substring'](0x0,0x32)+(_0xaa20cb[_0x31fa8b(0xfde)]>0x32?'...':'');for(const _0x201221 in _0x41df36['chats']){const _0x552c4c=_0x41df36[_0x31fa8b(0x864)][_0x201221];if(_0x552c4c[_0x31fa8b(0x1a2)])continue;let _0x41755f=![];const _0x3e7a65=_0x39fbcf[_0x31fa8b(0x74d)];if(!_0x3e7a65||_0x3e7a65['length']===0x0)_0x41755f=!![];else _0x552c4c[_0x31fa8b(0x11a6)]&&_0x3e7a65[_0x31fa8b(0xee2)](_0x552c4c['groupId'])&&(_0x41755f=!![]);if(_0x41755f){const _0x11030f={'role':_0x31fa8b(0xb1),'content':_0x31fa8b(0xc35)+_0x4b5611+_0x31fa8b(0xdc0)+_0xaa20cb+_0x31fa8b(0xc97),'timestamp':Date[_0x31fa8b(0x108d)](),'isHidden':!![]};_0x552c4c[_0x31fa8b(0xd08)]['push'](_0x11030f),await _0x342df8[_0x31fa8b(0x864)][_0x31fa8b(0x9c0)](_0x552c4c);}}await _0x476b70(),_0x9fc733[_0x31fa8b(0x119a)][_0x31fa8b(0x131d)](_0x31fa8b(0x106d)),alert('动态发布成功！');});const _0x441208=document['getElementById'](_0x12aa56(0x7ea));let _0x4a3ad5={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0x2cf441(_0x18ff26=null){const _0x2b7273=_0x12aa56;document[_0x2b7273(0x400)](_0x2b7273(0x7c7))[_0x2b7273(0x19c)](_0xab8204=>{const _0x445fae=_0x2b7273;_0xab8204!==_0x18ff26&&_0xab8204[_0x445fae(0x89c)](_0x445fae(0xe1a))[_0x445fae(0x119a)]['remove'](_0x445fae(0xce4));});}async function _0x12aad4(_0x4d8169){const _0x29b3b5=_0x12aa56;_0x4d8169[_0x29b3b5(0x1311)]();const _0x2b63f4=_0x4d8169['target'],_0xb5726f=_0x2b63f4[_0x29b3b5(0x58c)]('.comment-delete-btn');if(_0xb5726f){const _0x1f42a7=_0xb5726f[_0x29b3b5(0x58c)]('.qzone-post-container'),_0x143c8e=parseInt(_0x1f42a7[_0x29b3b5(0x118)]['postId']),_0x119716=parseInt(_0xb5726f[_0x29b3b5(0x118)][_0x29b3b5(0x741)]);if(isNaN(_0x143c8e)||isNaN(_0x119716))return;const _0x50ddcf=_0x3c5f19['find'](_0x103e24=>_0x103e24['id']===_0x143c8e);if(!_0x50ddcf||!_0x50ddcf[_0x29b3b5(0xcad)]||!_0x50ddcf[_0x29b3b5(0xcad)][_0x119716])return;const _0x1aa8c0=_0x50ddcf['comments'][_0x119716],_0xa1be76=await _0x23a88b(_0x29b3b5(0xd40),'确定要删除这条评论吗？',{'confirmButtonClass':_0x29b3b5(0x51b)});if(_0xa1be76){_0x50ddcf[_0x29b3b5(0xcad)]['splice'](_0x119716,0x1),await _0x342df8['qzonePosts'][_0x29b3b5(0xaf9)](_0x143c8e,{'comments':_0x50ddcf[_0x29b3b5(0xcad)]});if(_0x1aa8c0&&_0x1aa8c0['commenterName']===_0x41df36[_0x29b3b5(0x571)][_0x29b3b5(0xabb)]){console[_0x29b3b5(0xe72)](_0x29b3b5(0xebe));const _0x305f68=new Set();_0x50ddcf[_0x29b3b5(0x1301)]!==_0x29b3b5(0x66e)&&_0x305f68[_0x29b3b5(0xbff)](_0x50ddcf[_0x29b3b5(0x1301)]);if(_0x1aa8c0[_0x29b3b5(0x855)]){const _0x2a7f39=Object[_0x29b3b5(0x76d)](_0x41df36['chats'])[_0x29b3b5(0xd12)](_0x5eb40f=>_0x5eb40f[_0x29b3b5(0x283)]===_0x1aa8c0[_0x29b3b5(0x855)]);_0x2a7f39&&_0x305f68[_0x29b3b5(0xbff)](_0x2a7f39['id']);}const _0x387e86=(_0x50ddcf[_0x29b3b5(0xbdc)]||_0x50ddcf[_0x29b3b5(0x11b6)]||'')[_0x29b3b5(0xba5)](0x0,0x1e),_0x193a15=_0x41df36[_0x29b3b5(0x571)]['nickname'];let _0x4fe12b;const _0x40798e=_0x41df36[_0x29b3b5(0x823)][_0x29b3b5(0xd12)](_0x25d0e1=>_0x25d0e1[_0x29b3b5(0x2fa)]===_0x1aa8c0[_0x29b3b5(0x6af)]);if(_0x40798e)_0x4fe12b='用户\x27'+_0x193a15+_0x29b3b5(0x644)+_0x387e86+_0x29b3b5(0x8c4)+_0x40798e[_0x29b3b5(0x461)]+'”。';else{if(_0x1aa8c0[_0x29b3b5(0x855)]){const _0x4cabd7=_0x5641f2(_0x1aa8c0[_0x29b3b5(0x855)]);_0x4fe12b=_0x29b3b5(0xeda)+_0x193a15+_0x29b3b5(0x644)+_0x387e86+_0x29b3b5(0x2af)+_0x4cabd7+_0x29b3b5(0x69e)+_0x1aa8c0['text']+'”。';}else _0x4fe12b=_0x29b3b5(0xeda)+_0x193a15+_0x29b3b5(0x6bb)+_0x387e86+'”，内容是：“'+_0x1aa8c0[_0x29b3b5(0x6af)]+'”。';}const _0xb0b8ae='[系统提示：'+_0x4fe12b+_0x29b3b5(0x5e9);for(const _0x32f82f of _0x305f68){const _0x5818aa=_0x41df36[_0x29b3b5(0x864)][_0x32f82f];if(_0x5818aa){const _0x249b59=_0x5818aa[_0x29b3b5(0xd08)]['length'];_0x5818aa[_0x29b3b5(0xd08)]=_0x5818aa[_0x29b3b5(0xd08)][_0x29b3b5(0x98a)](_0x563cc0=>!(_0x563cc0[_0x29b3b5(0xbc5)]&&_0x563cc0['role']===_0x29b3b5(0xb1)&&_0x563cc0['content']===_0xb0b8ae)),_0x5818aa[_0x29b3b5(0xd08)]['length']<_0x249b59&&(console[_0x29b3b5(0xe72)](_0x29b3b5(0x267)+_0x5818aa[_0x29b3b5(0x461)]+'\x22\x20的记忆中清除了1条关于已删除评论的通知。'),await _0x342df8['chats']['put'](_0x5818aa));}}}await _0x1ef318(_0x143c8e);}return;}const _0x16674f=_0x2b63f4[_0x29b3b5(0x58c)](_0x29b3b5(0x7d5));if(_0x16674f){const _0x2cc636=_0x16674f[_0x29b3b5(0x58c)]('.qzone-post-container');if(!_0x2cc636)return;const _0x2a071c=parseInt(_0x2cc636[_0x29b3b5(0x118)]['postId']);_0x438dad['isOpen']&&_0x438dad[_0x29b3b5(0xf46)]===_0x2a071c?_0x2ff22a():_0x3d58e7(_0x2a071c,_0x16674f);return;}const _0x3242b3=_0x2b63f4[_0x29b3b5(0x58c)](_0x29b3b5(0x6c0));if(_0x3242b3){const _0x36beb0=parseInt(_0x3242b3[_0x29b3b5(0x118)][_0x29b3b5(0x6b1)]),_0x24f648=_0x3242b3['dataset']['commenterOriginalName'],_0x309a27=_0x3242b3['dataset'][_0x29b3b5(0xcf8)];if(!_0x24f648||!_0x309a27||_0x24f648===_0x41df36[_0x29b3b5(0x571)][_0x29b3b5(0xabb)]){_0x567149(_0x3242b3[_0x29b3b5(0x58c)](_0x29b3b5(0x7c7)));return;}_0x57bd10={'postId':_0x36beb0,'replyToName':_0x24f648,'replyToDisplayName':_0x309a27};const _0x54d08c=_0x3242b3['closest']('.qzone-post-container'),_0x66f0ae=_0x54d08c[_0x29b3b5(0x89c)](_0x29b3b5(0x550));_0x66f0ae['placeholder']=_0x29b3b5(0x72c)+_0x309a27+':',_0x66f0ae[_0x29b3b5(0xede)]();return;}if(_0x2b63f4[_0x29b3b5(0x119a)][_0x29b3b5(0x987)](_0x29b3b5(0x60c))){const _0x470cb1=_0x2b63f4[_0x29b3b5(0x58c)]('.qzone-post-container');if(_0x470cb1&&_0x470cb1[_0x29b3b5(0x118)]['postId'])_0x1bbe4a(parseInt(_0x470cb1[_0x29b3b5(0x118)][_0x29b3b5(0x6b1)]));return;}if(_0x2b63f4[_0x29b3b5(0x597)]==='IMG'&&_0x2b63f4[_0x29b3b5(0x118)][_0x29b3b5(0x54d)]){_0x296ef9(_0x29b3b5(0xcf7),_0x2b63f4[_0x29b3b5(0x118)]['hiddenText'][_0x29b3b5(0x709)](/<br>/g,'\x0a'));return;}const _0x28a8ac=_0x2b63f4['closest'](_0x29b3b5(0x7c7));if(!_0x28a8ac)return;const _0x3f39b5=parseInt(_0x28a8ac[_0x29b3b5(0x118)][_0x29b3b5(0x6b1)]);if(isNaN(_0x3f39b5))return;if(_0x2b63f4[_0x29b3b5(0x58c)](_0x29b3b5(0x3d5))){const _0x577e22=await _0x23a88b('删除动态',_0x29b3b5(0xf12),{'confirmButtonClass':_0x29b3b5(0x51b)});_0x577e22&&(_0x28a8ac[_0x29b3b5(0x655)][_0x29b3b5(0xdfd)]=_0x29b3b5(0x410),_0x28a8ac[_0x29b3b5(0x655)]['transform']=_0x29b3b5(0x10ab),_0x28a8ac[_0x29b3b5(0x655)][_0x29b3b5(0x10ec)]='0',setTimeout(async()=>{const _0xa309f9=_0x29b3b5;await _0x342df8[_0xa309f9(0x35a)][_0xa309f9(0x971)](_0x3f39b5);const _0x27fde0=_0xa309f9(0x724)+_0x3f39b5+')';for(const _0x402ff7 in _0x41df36[_0xa309f9(0x864)]){const _0x558f15=_0x41df36[_0xa309f9(0x864)][_0x402ff7],_0x4f66d1=_0x558f15[_0xa309f9(0xd08)][_0xa309f9(0xfde)];_0x558f15[_0xa309f9(0xd08)]=_0x558f15[_0xa309f9(0xd08)][_0xa309f9(0x98a)](_0x4eab33=>!(_0x4eab33[_0xa309f9(0x10ff)]===_0xa309f9(0xb1)&&_0x4eab33['content'][_0xa309f9(0xee2)](_0x27fde0)));if(_0x558f15[_0xa309f9(0xd08)][_0xa309f9(0xfde)]<_0x4f66d1)await _0x342df8['chats']['put'](_0x558f15);}await _0x476b70(),alert(_0xa309f9(0x1382));},0x12c));return;}const _0x53a8d8=_0x2b63f4[_0x29b3b5(0x58c)](_0x29b3b5(0x13a5));if(_0x53a8d8){if(_0x53a8d8[_0x29b3b5(0x119a)][_0x29b3b5(0x987)](_0x29b3b5(0xcf0))){_0x3a75d2(_0x3f39b5);return;}if(_0x53a8d8[_0x29b3b5(0x119a)][_0x29b3b5(0x987)](_0x29b3b5(0x298))){const _0x54c966=_0x3c5f19[_0x29b3b5(0xd12)](_0x345ce5=>_0x345ce5['id']===_0x3f39b5);if(!_0x54c966)return;if(!_0x54c966['likes'])_0x54c966['likes']=[];const _0x28878a=_0x41df36['qzoneSettings']['nickname'],_0x6822aa=_0x54c966[_0x29b3b5(0x133c)][_0x29b3b5(0x1105)](_0x28878a);_0x6822aa>-0x1?_0x54c966[_0x29b3b5(0x133c)][_0x29b3b5(0x2f1)](_0x6822aa,0x1):(_0x54c966[_0x29b3b5(0x133c)][_0x29b3b5(0x258)](_0x28878a),_0x53a8d8[_0x29b3b5(0x119a)]['add'](_0x29b3b5(0x111e)),_0x53a8d8[_0x29b3b5(0x271)](_0x29b3b5(0xb3c),()=>_0x53a8d8[_0x29b3b5(0x119a)][_0x29b3b5(0x131d)]('animate-like'),{'once':!![]})),await _0x342df8[_0x29b3b5(0x35a)][_0x29b3b5(0xaf9)](_0x3f39b5,{'likes':_0x54c966['likes']}),await _0x1ef318(_0x3f39b5);}if(_0x53a8d8[_0x29b3b5(0x119a)][_0x29b3b5(0x987)](_0x29b3b5(0x4d8))){const _0x223f01=await _0x342df8[_0x29b3b5(0x5c5)]['where']({'type':_0x29b3b5(0xd91),'content.id':_0x3f39b5})['first']();if(_0x223f01)await _0x342df8[_0x29b3b5(0x5c5)][_0x29b3b5(0x971)](_0x223f01['id']),await _0x296ef9('提示','已取消收藏');else{const _0x346140=await _0x342df8['qzonePosts'][_0x29b3b5(0x1a3)](_0x3f39b5);_0x346140&&(await _0x342df8[_0x29b3b5(0x5c5)][_0x29b3b5(0xbff)]({'type':_0x29b3b5(0xd91),'content':_0x346140,'timestamp':Date['now']()}),await _0x296ef9('提示',_0x29b3b5(0xb90)));}await _0x1ef318(_0x3f39b5);}return;}const _0xa50c1b=_0x2b63f4[_0x29b3b5(0x58c)](_0x29b3b5(0x5bf));if(_0xa50c1b){const _0x1ddd9a=_0x28a8ac[_0x29b3b5(0x89c)]('.comment-input'),_0x16d55a=_0x1ddd9a[_0x29b3b5(0x1be)][_0x29b3b5(0x1cb)]();if(!_0x16d55a)return alert(_0x29b3b5(0x111a));const _0x59cf1e=_0x3c5f19['find'](_0x2ced89=>_0x2ced89['id']===_0x3f39b5);if(!_0x59cf1e)return;if(!_0x59cf1e[_0x29b3b5(0xcad)])_0x59cf1e['comments']=[];const _0x29c634={'commenterName':_0x41df36[_0x29b3b5(0x571)][_0x29b3b5(0xabb)],'text':_0x16d55a,'timestamp':Date[_0x29b3b5(0x108d)](),'replyTo':_0x57bd10&&_0x57bd10[_0x29b3b5(0x6b1)]===_0x3f39b5?_0x57bd10[_0x29b3b5(0xa2f)]:null};_0x59cf1e[_0x29b3b5(0xcad)][_0x29b3b5(0x258)](_0x29c634),await _0x342df8['qzonePosts'][_0x29b3b5(0xaf9)](_0x3f39b5,{'comments':_0x59cf1e['comments']});let _0xa2df3e=(_0x59cf1e[_0x29b3b5(0xbdc)]||_0x59cf1e[_0x29b3b5(0x11b6)]||'')[_0x29b3b5(0xba5)](0x0,0x1e);const _0x44f69d=_0x41df36['qzoneSettings'][_0x29b3b5(0xabb)],_0x1d62a7=new Set();if(_0x59cf1e[_0x29b3b5(0x1301)]!==_0x29b3b5(0x66e))_0x1d62a7[_0x29b3b5(0xbff)](_0x59cf1e[_0x29b3b5(0x1301)]);if(_0x29c634[_0x29b3b5(0x855)]&&_0x29c634[_0x29b3b5(0x855)]!==_0x44f69d){const _0x81b942=Object[_0x29b3b5(0x76d)](_0x41df36['chats'])[_0x29b3b5(0xd12)](_0x63d823=>_0x63d823['originalName']===_0x29c634['replyTo']);if(_0x81b942)_0x1d62a7[_0x29b3b5(0xbff)](_0x81b942['id']);}for(const _0x5f0f6c of _0x1d62a7){const _0x1b020a=_0x41df36[_0x29b3b5(0x864)][_0x5f0f6c];if(_0x1b020a&&!_0x1b020a[_0x29b3b5(0x1a2)]){const _0x30ab5d=_0x41df36[_0x29b3b5(0x823)][_0x29b3b5(0xd12)](_0x591958=>_0x591958[_0x29b3b5(0x2fa)]===_0x16d55a);let _0x526e97=_0x30ab5d?_0x29b3b5(0xeda)+_0x44f69d+_0x29b3b5(0x644)+_0xa2df3e+_0x29b3b5(0x8c4)+_0x30ab5d[_0x29b3b5(0x461)]+'”。':_0x29c634[_0x29b3b5(0x855)]?'用户\x27'+_0x44f69d+_0x29b3b5(0x644)+_0xa2df3e+_0x29b3b5(0x2af)+_0x57bd10['replyToDisplayName']+'\x27的评论，内容是：“'+_0x16d55a+'”。':_0x29b3b5(0xeda)+_0x44f69d+'\x27刚刚评论了你的动态“'+_0xa2df3e+'”，内容是：“'+_0x16d55a+'”。';const _0x432552={'role':_0x29b3b5(0xb1),'content':'[系统提示：'+_0x526e97+'请你对此作出回应。]','timestamp':Date[_0x29b3b5(0x108d)](),'isHidden':!![]};_0x1b020a[_0x29b3b5(0xd08)][_0x29b3b5(0x258)](_0x432552),await _0x342df8[_0x29b3b5(0x864)]['put'](_0x1b020a);}}_0x1ddd9a[_0x29b3b5(0x1be)]='',_0x567149(_0x28a8ac),await _0x1ef318(_0x3f39b5);return;}}const _0x10c0e4=_0x596a8e=>{const _0x2aebd7=_0x12aa56,_0x3bad9c=_0x596a8e[_0x2aebd7(0xfab)];if(_0x3bad9c[_0x2aebd7(0x58c)](_0x2aebd7(0x778)))return;const _0x5cfe42=_0x596a8e[_0x2aebd7(0xfab)][_0x2aebd7(0x58c)](_0x2aebd7(0x7c7));if(!_0x5cfe42)return;_0x2cf441(_0x5cfe42),_0x4a3ad5[_0x2aebd7(0xfd5)]=_0x5cfe42,_0x4a3ad5['isDragging']=!![],_0x4a3ad5[_0x2aebd7(0xd0a)]=!![],_0x4a3ad5[_0x2aebd7(0x876)]=null,_0x4a3ad5[_0x2aebd7(0xc64)]=_0x596a8e[_0x2aebd7(0xa6b)][_0x2aebd7(0xee2)](_0x2aebd7(0x1bc))?_0x596a8e[_0x2aebd7(0x421)]:_0x596a8e[_0x2aebd7(0x544)][0x0]['pageX'],_0x4a3ad5[_0x2aebd7(0x12e4)]=_0x596a8e[_0x2aebd7(0xa6b)][_0x2aebd7(0xee2)](_0x2aebd7(0x1bc))?_0x596a8e[_0x2aebd7(0xb2b)]:_0x596a8e['touches'][0x0][_0x2aebd7(0xb2b)],_0x4a3ad5[_0x2aebd7(0xfd5)][_0x2aebd7(0x89c)](_0x2aebd7(0xe1a))[_0x2aebd7(0x655)][_0x2aebd7(0xdfd)]=_0x2aebd7(0xa70),document[_0x2aebd7(0x271)](_0x2aebd7(0x1287),_0x5e7991),document['addEventListener'](_0x2aebd7(0x1338),_0x4b16fe),document[_0x2aebd7(0x271)](_0x2aebd7(0x3a2),_0x5e7991,{'passive':![]}),document[_0x2aebd7(0x271)](_0x2aebd7(0x2e9),_0x4b16fe);},_0x5e7991=_0x4b61bf=>{const _0xa986f0=_0x12aa56;if(!_0x4a3ad5[_0xa986f0(0x10b3)]||!_0x4a3ad5[_0xa986f0(0xfd5)])return;const _0x38d393=_0x4b61bf[_0xa986f0(0xa6b)][_0xa986f0(0xee2)](_0xa986f0(0x1bc))?_0x4b61bf[_0xa986f0(0x421)]:_0x4b61bf[_0xa986f0(0x544)][0x0]['pageX'],_0x4a8026=_0x4b61bf[_0xa986f0(0xa6b)]['includes'](_0xa986f0(0x1bc))?_0x4b61bf['pageY']:_0x4b61bf[_0xa986f0(0x544)][0x0][_0xa986f0(0xb2b)],_0x2c3f88=_0x38d393-_0x4a3ad5[_0xa986f0(0xc64)],_0x38214d=_0x4a8026-_0x4a3ad5[_0xa986f0(0x12e4)];_0x4a3ad5[_0xa986f0(0xd0a)]&&(Math['abs'](_0x2c3f88)>0x5||Math[_0xa986f0(0x744)](_0x38214d)>0x5)&&(_0x4a3ad5[_0xa986f0(0xd0a)]=![]);!_0x4a3ad5['swipeDirection']&&(Math[_0xa986f0(0x744)](_0x2c3f88)>Math[_0xa986f0(0x744)](_0x38214d)?_0x4a3ad5[_0xa986f0(0x876)]=_0xa986f0(0x219):_0x4a3ad5[_0xa986f0(0x876)]=_0xa986f0(0xf01));if(_0x4a3ad5['swipeDirection']==='horizontal'){_0x4b61bf[_0xa986f0(0xe94)](),_0x4a3ad5[_0xa986f0(0xc46)]=_0x38d393;let _0x495a79=Math['min'](0x0,Math['max'](-0x5a,_0x2c3f88));_0x4a3ad5[_0xa986f0(0xfd5)][_0xa986f0(0x89c)](_0xa986f0(0xe1a))[_0xa986f0(0x655)][_0xa986f0(0x923)]='translateX('+_0x495a79+_0xa986f0(0xc00);}},_0x4b16fe=_0x3b09dc=>{const _0x456089=_0x12aa56;document[_0x456089(0xb04)](_0x456089(0x1287),_0x5e7991),document['removeEventListener'](_0x456089(0x1338),_0x4b16fe),document[_0x456089(0xb04)](_0x456089(0x3a2),_0x5e7991),document[_0x456089(0xb04)](_0x456089(0x2e9),_0x4b16fe);if(!_0x4a3ad5[_0x456089(0x10b3)]||!_0x4a3ad5[_0x456089(0xfd5)])return;const _0x516504=_0x4a3ad5[_0x456089(0xfd5)][_0x456089(0x89c)](_0x456089(0xe1a));_0x516504[_0x456089(0x655)][_0x456089(0xdfd)]='transform\x200.3s\x20ease';if(_0x4a3ad5['swipeDirection']===_0x456089(0x219)&&!_0x4a3ad5[_0x456089(0xd0a)]){const _0xcd44c4=_0x3b09dc['type']['includes'](_0x456089(0x2e9))?_0x3b09dc[_0x456089(0x1076)][0x0][_0x456089(0x421)]:_0x3b09dc['pageX'],_0x52de7d=_0xcd44c4-_0x4a3ad5['startX'];_0x52de7d<-0x28?_0x516504[_0x456089(0x119a)]['add']('swiped'):_0x516504[_0x456089(0x119a)][_0x456089(0x131d)](_0x456089(0xce4));}_0x516504[_0x456089(0x655)][_0x456089(0x923)]='',_0x4a3ad5[_0x456089(0x10b3)]=![],_0x4a3ad5[_0x456089(0xfd5)]=null,_0x4a3ad5['swipeDirection']=null,_0x4a3ad5[_0x456089(0xd0a)]=!![];};_0x441208[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x12aad4),_0x441208[_0x12aa56(0x271)](_0x12aa56(0x413),_0x10c0e4),_0x441208[_0x12aa56(0x271)](_0x12aa56(0xcb7),_0x10c0e4,{'passive':!![]}),_0x441208[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4ef89c=>{const _0x4297d2=_0x12aa56;_0x4ef89c[_0x4297d2(0xfab)]&&_0x4ef89c['target']['id']===_0x4297d2(0x46b)&&_0x5addec();}),document[_0x12aa56(0x383)](_0x12aa56(0xfcd))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x242f85=_0x12aa56;_0x41df36[_0x242f85(0xfc5)]&&_0x186153(_0x41df36[_0x242f85(0xfc5)]);}),document[_0x12aa56(0x383)](_0x12aa56(0x892))[_0x12aa56(0x271)]('change',_0x494bc3),document[_0x12aa56(0x383)](_0x12aa56(0x1109))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4ddcc3),document[_0x12aa56(0x383)](_0x12aa56(0xa80))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x3fda06),document[_0x12aa56(0x383)](_0x12aa56(0x844))[_0x12aa56(0x271)]('click',()=>{const _0x3f0175=_0x12aa56,_0x15b972=document[_0x3f0175(0x383)](_0x3f0175(0xc8a));_0x15b972['querySelector']('p')&&(_0x15b972[_0x3f0175(0x45c)]='');const _0x3b1fce=_0x31c05();_0x15b972[_0x3f0175(0xe91)](_0x3b1fce),_0x3b1fce[_0x3f0175(0x89c)](_0x3f0175(0x39d))['focus']();}),document['getElementById'](_0x12aa56(0xcdf))[_0x12aa56(0x271)]('click',_0x4eb9f2),document['getElementById'](_0x12aa56(0x1098))['addEventListener'](_0x12aa56(0x5c7),_0x3e1a43=>{const _0x2e0e3c=_0x12aa56;_0x3e1a43[_0x2e0e3c(0xfab)]&&_0x3e1a43['target']['id']===_0x2e0e3c(0x914)&&_0x35ffb9();}),document[_0x12aa56(0x383)]('profile-history-icon-btn')['addEventListener'](_0x12aa56(0x5c7),_0x34211b),document[_0x12aa56(0x383)](_0x12aa56(0x20d))[_0x12aa56(0x271)]('click',_0x44fe08),document[_0x12aa56(0x383)](_0x12aa56(0x794))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x28d582=>{const _0x58ad0b=_0x12aa56;_0x28d582['target']['id']==='character-profile-modal'&&_0x28d582[_0x58ad0b(0xfab)]['classList'][_0x58ad0b(0x131d)]('visible');}),document[_0x12aa56(0x383)]('manage-stickers-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x40ba5a),document[_0x12aa56(0x383)](_0x12aa56(0xd8a))['addEventListener']('click',_0x56c34b),document[_0x12aa56(0x383)](_0x12aa56(0x72a))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x18bbbb(_0x12aa56(0x502))),document[_0x12aa56(0x383)](_0x12aa56(0x727))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x18bbbb(_0x12aa56(0x502)));const _0x51f5d2=document[_0x12aa56(0x383)](_0x12aa56(0x10e1)),_0x2dd3e2=document[_0x12aa56(0x383)](_0x12aa56(0xe97));_0x51f5d2[_0x12aa56(0x271)](_0x12aa56(0xba),()=>{const _0xfa6b5b=_0x12aa56,_0x3ede16=_0x51f5d2['value'][_0xfa6b5b(0x1cb)]()[_0xfa6b5b(0x189)]();_0x2dd3e2[_0xfa6b5b(0x655)][_0xfa6b5b(0x2b6)]=_0x3ede16?_0xfa6b5b(0x27a):_0xfa6b5b(0xa70);if(!_0x3ede16){_0x462ca7(allFavoriteItems);return;}const _0x228b3d=allFavoriteItems['filter'](_0x6ed495=>{const _0x21f714=_0xfa6b5b;let _0x4b0fc0='',_0x4a747e='';if(_0x6ed495[_0x21f714(0xa6b)]===_0x21f714(0xd91)){const _0x5c8eed=_0x6ed495[_0x21f714(0x11b6)];_0x4b0fc0+=(_0x5c8eed[_0x21f714(0xbdc)]||'')+'\x20'+(_0x5c8eed[_0x21f714(0x11b6)]||'');if(_0x5c8eed[_0x21f714(0x1301)]===_0x21f714(0x66e))_0x4a747e=_0x41df36[_0x21f714(0x571)][_0x21f714(0xabb)];else _0x41df36[_0x21f714(0x864)][_0x5c8eed[_0x21f714(0x1301)]]&&(_0x4a747e=_0x41df36[_0x21f714(0x864)][_0x5c8eed['authorId']][_0x21f714(0x461)]);}else{if(_0x6ed495[_0x21f714(0xa6b)]===_0x21f714(0xbbe)){const _0x1d1afb=_0x6ed495[_0x21f714(0x11b6)];typeof _0x1d1afb[_0x21f714(0x11b6)]===_0x21f714(0xafa)&&(_0x4b0fc0=_0x1d1afb['content']);const _0x5e3a5f=_0x41df36[_0x21f714(0x864)][_0x6ed495['chatId']];_0x5e3a5f&&(_0x1d1afb[_0x21f714(0x10ff)]===_0x21f714(0x66e)?_0x4a747e=_0x5e3a5f[_0x21f714(0x1a2)]?_0x5e3a5f[_0x21f714(0x886)][_0x21f714(0x52e)]||'我':'我':_0x4a747e=_0x5e3a5f[_0x21f714(0x1a2)]?_0x1d1afb[_0x21f714(0x4c5)]:_0x5e3a5f[_0x21f714(0x461)]);}}return _0x4b0fc0['toLowerCase']()[_0x21f714(0xee2)](_0x3ede16)||_0x4a747e['toLowerCase']()['includes'](_0x3ede16);});_0x462ca7(_0x228b3d);}),_0x2dd3e2[_0x12aa56(0x271)]('click',()=>{const _0x3f76e7=_0x12aa56;_0x51f5d2[_0x3f76e7(0x1be)]='',_0x2dd3e2[_0x3f76e7(0x655)][_0x3f76e7(0x2b6)]=_0x3f76e7(0xa70),_0x462ca7(allFavoriteItems),_0x51f5d2[_0x3f76e7(0xede)]();}),document[_0x12aa56(0x383)](_0x12aa56(0x1083))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0xb83302=_0x12aa56;if(_0x4f051e['size']===0x0)return;const _0x19753b=_0x41df36[_0xb83302(0x864)][_0x41df36[_0xb83302(0xfc5)]];if(!_0x19753b)return;const _0x1c114d=[],_0x410cf0=[..._0x4f051e];for(const _0x3df1d3 of _0x410cf0){const _0xb7dd3e=await _0x342df8['favorites'][_0xb83302(0x6bd)](_0xb83302(0x936))['equals'](_0x3df1d3)[_0xb83302(0x26e)]();if(!_0xb7dd3e){const _0x3516ca=_0x19753b[_0xb83302(0xd08)][_0xb83302(0xd12)](_0x2e2ffa=>_0x2e2ffa[_0xb83302(0x3b7)]===_0x3df1d3);_0x3516ca&&_0x1c114d[_0xb83302(0x258)]({'type':'chat_message','content':_0x3516ca,'chatId':_0x41df36['activeChatId'],'timestamp':Date[_0xb83302(0x108d)](),'originalTimestamp':_0x3516ca['timestamp']});}}_0x1c114d[_0xb83302(0xfde)]>0x0?(await _0x342df8[_0xb83302(0x5c5)][_0xb83302(0x1391)](_0x1c114d),allFavoriteItems=await _0x342df8[_0xb83302(0x5c5)][_0xb83302(0x4b1)](_0xb83302(0x3b7))[_0xb83302(0x1087)]()[_0xb83302(0x21f)](),await _0x296ef9(_0xb83302(0x583),'已成功收藏\x20'+_0x1c114d[_0xb83302(0xfde)]+_0xb83302(0xc9c))):await _0x296ef9('提示',_0xb83302(0xb2d)),_0x11c2ba();});const _0x446cc6=document[_0x12aa56(0x383)](_0x12aa56(0x472)),_0x470b7a=document[_0x12aa56(0x383)]('favorites-view'),_0x233474=document[_0x12aa56(0x383)](_0x12aa56(0x3bc)),_0x119301=document[_0x12aa56(0x383)](_0x12aa56(0x224)),_0x26e621=document[_0x12aa56(0x383)]('favorites-list');_0x446cc6[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x575b8c=_0x12aa56;_0x281701=!_0x281701,_0x470b7a[_0x575b8c(0x119a)][_0x575b8c(0x8f0)](_0x575b8c(0x41c),_0x281701),_0x281701?(_0x446cc6[_0x575b8c(0x138e)]='完成',_0x233474[_0x575b8c(0x655)][_0x575b8c(0x2b6)]=_0x575b8c(0x27a),_0x119301[_0x575b8c(0x655)]['display']=_0x575b8c(0xa70),_0x26e621[_0x575b8c(0x655)][_0x575b8c(0x953)]='80px'):(_0x446cc6[_0x575b8c(0x138e)]='编辑',_0x233474[_0x575b8c(0x655)][_0x575b8c(0x2b6)]='none',_0x119301[_0x575b8c(0x655)][_0x575b8c(0x2b6)]=_0x575b8c(0x2aa),_0x26e621[_0x575b8c(0x655)][_0x575b8c(0x953)]='',_0x48f82c[_0x575b8c(0x4b8)](),document[_0x575b8c(0x400)](_0x575b8c(0x1029))[_0x575b8c(0x19c)](_0x3c79f7=>_0x3c79f7[_0x575b8c(0x119a)]['remove'](_0x575b8c(0x35e))),document['getElementById']('favorites-delete-selected-btn')[_0x575b8c(0x138e)]=_0x575b8c(0x4b0));}),document[_0x12aa56(0x383)](_0x12aa56(0x12ef))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4e3e05=>{const _0x2ec87d=_0x12aa56,_0x3710bd=_0x4e3e05[_0x2ec87d(0xfab)],_0x46da57=_0x3710bd[_0x2ec87d(0x58c)](_0x2ec87d(0x3b6));if(_0x3710bd[_0x2ec87d(0x597)]===_0x2ec87d(0x56d)&&_0x3710bd[_0x2ec87d(0x118)][_0x2ec87d(0x54d)]){const _0xe92265=_0x3710bd[_0x2ec87d(0x118)][_0x2ec87d(0x54d)];_0x296ef9(_0x2ec87d(0xcf7),_0xe92265[_0x2ec87d(0x709)](/<br>/g,'\x0a'));return;}if(!_0x281701)return;if(!_0x46da57)return;const _0x5576cd=parseInt(_0x46da57['dataset'][_0x2ec87d(0x1221)]);if(isNaN(_0x5576cd))return;_0x48f82c[_0x2ec87d(0xcde)](_0x5576cd)?(_0x48f82c[_0x2ec87d(0x971)](_0x5576cd),_0x46da57[_0x2ec87d(0x119a)][_0x2ec87d(0x131d)](_0x2ec87d(0x35e))):(_0x48f82c[_0x2ec87d(0xbff)](_0x5576cd),_0x46da57[_0x2ec87d(0x119a)][_0x2ec87d(0xbff)](_0x2ec87d(0x35e))),document[_0x2ec87d(0x383)](_0x2ec87d(0x2b2))[_0x2ec87d(0x138e)]=_0x2ec87d(0x7a4)+_0x48f82c[_0x2ec87d(0x1240)]+')';}),document['getElementById']('favorites-delete-selected-btn')['addEventListener']('click',async()=>{const _0x5d6eaf=_0x12aa56;if(_0x48f82c[_0x5d6eaf(0x1240)]===0x0)return;const _0x58fc6e=await _0x23a88b(_0x5d6eaf(0x615),'确定要从收藏夹中移除这\x20'+_0x48f82c[_0x5d6eaf(0x1240)]+_0x5d6eaf(0x4d3),{'confirmButtonClass':'btn-danger'});if(_0x58fc6e){const _0x978922=[..._0x48f82c];await _0x342df8[_0x5d6eaf(0x5c5)][_0x5d6eaf(0x212)](_0x978922),await _0x296ef9('删除成功',_0x5d6eaf(0xac5)),allFavoriteItems=allFavoriteItems['filter'](_0x3e9eb9=>!_0x978922[_0x5d6eaf(0xee2)](_0x3e9eb9['id'])),_0x462ca7(allFavoriteItems),_0x446cc6[_0x5d6eaf(0x5c7)]();}});_0x41df36[_0x12aa56(0xc0)][_0x12aa56(0x8d5)]&&(_0x4ac87e(),console[_0x12aa56(0xe72)](_0x12aa56(0x2ae)));document['querySelectorAll'](_0x12aa56(0x11a0))[_0x12aa56(0x19c)](_0xa518c2=>{const _0x2cbee7=_0x12aa56;_0xa518c2[_0x2cbee7(0x271)](_0x2cbee7(0x173),_0x24c0e3);});const _0x56d0b2=document[_0x12aa56(0x383)](_0x12aa56(0xeb2));_0x56d0b2['addEventListener']('input',()=>{const _0x105bbe=_0x12aa56;document[_0x105bbe(0x383)](_0x105bbe(0x2c6))[_0x105bbe(0x138e)]=_0x56d0b2['value']+'px',_0x24c0e3();});const _0x1c61da=document[_0x12aa56(0x383)](_0x12aa56(0x9fe));_0x1c61da[_0x12aa56(0x271)](_0x12aa56(0xba),_0x24c0e3),document[_0x12aa56(0x383)]('reset-theme-btn')[_0x12aa56(0x271)]('click',()=>{const _0x2215fe=_0x12aa56;document[_0x2215fe(0x383)](_0x2215fe(0xd8c))[_0x2215fe(0x2a3)]=!![],_0x24c0e3();}),document['getElementById'](_0x12aa56(0xaf4))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x105684=_0x12aa56;document['getElementById'](_0x105684(0x9fe))[_0x105684(0x1be)]='',_0x24c0e3();}),document[_0x12aa56(0x383)]('lyrics-vertical-pos')['addEventListener'](_0x12aa56(0x173),_0x24c0e3),document[_0x12aa56(0x383)](_0x12aa56(0x7f3))[_0x12aa56(0x271)](_0x12aa56(0x173),_0x24c0e3),document[_0x12aa56(0x383)]('lyrics-offset-input')['addEventListener'](_0x12aa56(0xba),_0x24c0e3),document['querySelectorAll'](_0x12aa56(0x33e))[_0x12aa56(0x19c)](_0x4c59b2=>{const _0x1aff72=_0x12aa56;_0x4c59b2[_0x1aff72(0x271)](_0x1aff72(0x173),function(){const _0x1978ec=_0x1aff72,_0x371d4c=document['getElementById'](_0x1978ec(0x501));this[_0x1978ec(0x1be)]===_0x1978ec(0x3fa)||this['value']===_0x1978ec(0x8f7)?_0x371d4c[_0x1978ec(0x655)][_0x1978ec(0x2b6)]=_0x1978ec(0x27a):_0x371d4c[_0x1978ec(0x655)][_0x1978ec(0x2b6)]=_0x1978ec(0xa70);});}),document[_0x12aa56(0x383)]('manage-groups-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x504b13),document[_0x12aa56(0x383)](_0x12aa56(0x129b))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x166b13=_0x12aa56;document[_0x166b13(0x383)]('group-management-modal')[_0x166b13(0x119a)][_0x166b13(0x131d)](_0x166b13(0x106d));const _0x225418=document[_0x166b13(0x383)](_0x166b13(0x1ee));document[_0x166b13(0x383)]('chat-settings-modal')[_0x166b13(0x119a)][_0x166b13(0x987)](_0x166b13(0x106d))&&_0x225418['click']();}),document['getElementById'](_0x12aa56(0xdf8))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x2e437d),document[_0x12aa56(0x383)]('existing-groups-list')['addEventListener'](_0x12aa56(0x5c7),_0x2d58f3=>{const _0x163155=_0x12aa56;if(_0x2d58f3['target'][_0x163155(0x119a)][_0x163155(0x987)]('delete-group-btn')){const _0x77349f=parseInt(_0x2d58f3[_0x163155(0xfab)]['dataset']['id']);_0x35cf60(_0x77349f);}}),document[_0x12aa56(0x383)](_0x12aa56(0x12cd))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x29d937),document['getElementById'](_0x12aa56(0xcc3))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x57c9c3),document[_0x12aa56(0x383)](_0x12aa56(0xa6))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4e1dd4),document[_0x12aa56(0x383)](_0x12aa56(0x42f))['addEventListener'](_0x12aa56(0x5c7),_0x410987),document[_0x12aa56(0x383)](_0x12aa56(0x12ea))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x16c3d1=_0x7c8ee8;_0x29d937(),_0x16c3d1&&_0x26880d(_0x16c3d1);}),document[_0x12aa56(0x383)]('chat-messages')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x30fae5=>{const _0x2ab8b1=_0x12aa56,_0x69eaba=_0x30fae5[_0x2ab8b1(0xfab)][_0x2ab8b1(0x58c)](_0x2ab8b1(0xbb0));if(!_0x69eaba)return;if(_0x69eaba[_0x2ab8b1(0x119a)]['contains']('ai')&&_0x69eaba[_0x2ab8b1(0x119a)][_0x2ab8b1(0x987)](_0x2ab8b1(0x3c2))&&_0x69eaba[_0x2ab8b1(0x118)][_0x2ab8b1(0x1fe)]===_0x2ab8b1(0x1ad)){const _0x547b43=parseInt(_0x69eaba[_0x2ab8b1(0x118)][_0x2ab8b1(0x3b7)]);!isNaN(_0x547b43)&&_0x65c610(_0x547b43);}}),document[_0x12aa56(0x383)]('transfer-action-accept')['addEventListener']('click',()=>_0x5a9c8a(_0x12aa56(0x4f3))),document['getElementById'](_0x12aa56(0xd38))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x5a9c8a(_0x12aa56(0xfd2))),document[_0x12aa56(0x383)](_0x12aa56(0xf56))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x2a7cee),document[_0x12aa56(0x383)](_0x12aa56(0x125c))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x23051a),document[_0x12aa56(0x383)](_0x12aa56(0x26b))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x3a873b),document[_0x12aa56(0x383)](_0x12aa56(0x11a3))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x24a26d),document[_0x12aa56(0x383)](_0x12aa56(0x7bf))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{_0x105acd('chat-list-screen');}),document['getElementById'](_0x12aa56(0x1179))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x7ac05f=>{const _0x2a85d9=_0x12aa56,_0x29028e=_0x7ac05f[_0x2a85d9(0xfab)][_0x2a85d9(0x58c)]('.contact-picker-item');if(!_0x29028e)return;const _0x426017=_0x29028e['dataset'][_0x2a85d9(0x6f7)];_0x29028e[_0x2a85d9(0x119a)][_0x2a85d9(0x8f0)](_0x2a85d9(0x35e)),_0x583e8f[_0x2a85d9(0xcde)](_0x426017)?_0x583e8f[_0x2a85d9(0x971)](_0x426017):_0x583e8f[_0x2a85d9(0xbff)](_0x426017),_0x247064();}),document[_0x12aa56(0x383)](_0x12aa56(0x9c3))[_0x12aa56(0x271)]('click',()=>{_0x1a842f();}),document[_0x12aa56(0x383)](_0x12aa56(0xd6e))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x4359fc=_0x12aa56;_0x105acd(_0x4359fc(0x862)),document['getElementById'](_0x4359fc(0x1ee))[_0x4359fc(0x5c7)]();}),document[_0x12aa56(0x383)](_0x12aa56(0x128f))['addEventListener']('click',_0xd4f1c8=>{const _0x45470e=_0x12aa56;_0xd4f1c8[_0x45470e(0xfab)][_0x45470e(0x119a)]['contains'](_0x45470e(0x631))&&_0x2572f8(_0xd4f1c8[_0x45470e(0xfab)][_0x45470e(0x118)][_0x45470e(0xcfe)]);}),document[_0x12aa56(0x383)](_0x12aa56(0x2b0))['addEventListener'](_0x12aa56(0x5c7),async()=>{const _0x344c76=_0x12aa56,_0x59cf6f=document[_0x344c76(0x383)](_0x344c76(0xbee)),_0x2cd31d=_0x59cf6f[_0x344c76(0x117b)](!![]);_0x59cf6f['parentNode'][_0x344c76(0xe58)](_0x2cd31d,_0x59cf6f),_0x2cd31d[_0x344c76(0x271)](_0x344c76(0x5c7),_0x1c389d),await _0x3eb151();}),document[_0x12aa56(0x383)](_0x12aa56(0xd9a))['addEventListener'](_0x12aa56(0x5c7),_0x239d46),document[_0x12aa56(0x383)](_0x12aa56(0x110b))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1d2ff5),document[_0x12aa56(0x383)](_0x12aa56(0xfa4))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1d2ff5),document[_0x12aa56(0x383)](_0x12aa56(0x733))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x2d9610),document[_0x12aa56(0x383)](_0x12aa56(0x6cf))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x56fa47=_0x12aa56;_0x4f60f2[_0x56fa47(0xe53)]=![],_0x105acd(_0x56fa47(0x862));}),document[_0x12aa56(0x383)]('join-call-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x13b6ef),document['getElementById'](_0x12aa56(0xb35))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x278011=_0x12aa56;_0x3ad02b();const _0x5859ee=_0x41df36[_0x278011(0x864)][_0x4f60f2['activeChatId']];if(!_0x5859ee)return;if(_0x4f60f2[_0x278011(0xc02)]){_0x4f60f2[_0x278011(0xb6)]=![];const _0x463924={'role':_0x278011(0xb1),'content':_0x278011(0xe3d),'timestamp':Date[_0x278011(0x108d)](),'isHidden':!![]};_0x5859ee[_0x278011(0xd08)][_0x278011(0x258)](_0x463924),await _0x342df8[_0x278011(0x864)]['put'](_0x5859ee),await _0x11e743();}else{const _0x45604a={'role':_0x278011(0x66e),'content':_0x278011(0x31c),'timestamp':Date['now']()};_0x5859ee[_0x278011(0xd08)][_0x278011(0x258)](_0x45604a),await _0x342df8[_0x278011(0x864)][_0x278011(0x9c0)](_0x5859ee),_0x105acd('chat-interface-screen'),_0x323467(_0x45604a,_0x5859ee),_0x11e743();}_0x4f60f2[_0x278011(0xe53)]=![];}),document[_0x12aa56(0x383)](_0x12aa56(0x4d9))[_0x12aa56(0x271)]('click',async()=>{const _0x3eba19=_0x12aa56;_0x3ad02b(),_0x4f60f2[_0x3eba19(0xe35)]='ai',_0x4f60f2[_0x3eba19(0xb6)]=!![],_0x4f60f2[_0x3eba19(0xfc5)]=_0x41df36[_0x3eba19(0xfc5)];if(_0x4f60f2[_0x3eba19(0xc02)]){const _0x518d2f=_0x41df36[_0x3eba19(0x864)][_0x4f60f2[_0x3eba19(0xfc5)]],_0x492843=_0x518d2f[_0x3eba19(0x12a6)]['find'](_0x4c79b5=>_0x4c79b5['name']===_0x4f60f2[_0x3eba19(0x496)]);_0x492843?_0x4f60f2[_0x3eba19(0x9a6)]=[_0x492843]:_0x4f60f2[_0x3eba19(0x9a6)]=[];}_0x267991();}),document[_0x12aa56(0x383)](_0x12aa56(0x1009))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x22d763=_0x12aa56;if(!_0x4f60f2[_0x22d763(0x40d)])return;const _0x266fd6=document[_0x22d763(0x89c)](_0x22d763(0x728));_0x266fd6&&_0x266fd6['classList']['add'](_0x22d763(0x632));const _0x4a6f80=await _0x12e332('你说','请输入你想说的话...');_0x266fd6&&_0x266fd6['classList'][_0x22d763(0x131d)](_0x22d763(0x632)),_0x4a6f80&&_0x4a6f80[_0x22d763(0x1cb)]()&&_0x2928c4(_0x4a6f80[_0x22d763(0x1cb)]());}),document[_0x12aa56(0x89c)](_0x12aa56(0x6fa))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x36412d=_0x12aa56;_0x281701&&document[_0x36412d(0x383)]('favorites-edit-btn')['click'](),_0x18bbbb('memories-view'),_0x5bddd7();}),document[_0x12aa56(0x383)](_0x12aa56(0xa43))[_0x12aa56(0x271)]('click',()=>_0x18bbbb(_0x12aa56(0x502))),document[_0x12aa56(0x383)]('confirm-create-countdown-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x1278f1=_0x12aa56,_0x116622=document['getElementById']('countdown-title-input')[_0x1278f1(0x1be)]['trim'](),_0x27c085=document[_0x1278f1(0x383)](_0x1278f1(0x10c6))[_0x1278f1(0x1be)];if(!_0x116622||!_0x27c085){alert(_0x1278f1(0x821));return;}const _0x485747=new Date(_0x27c085);if(isNaN(_0x485747)||_0x485747<=new Date()){alert('请输入一个有效的、未来的日期！');return;}const _0x20a63c={'authorId':_0x1278f1(0x66e),'description':_0x116622,'timestamp':Date[_0x1278f1(0x108d)](),'type':_0x1278f1(0x145),'targetDate':_0x485747['getTime']()};await _0x342df8[_0x1278f1(0x966)][_0x1278f1(0xbff)](_0x20a63c),document[_0x1278f1(0x383)](_0x1278f1(0x118e))[_0x1278f1(0x119a)][_0x1278f1(0x131d)]('visible'),_0x5bddd7();}),document[_0x12aa56(0x383)](_0x12aa56(0x12bd))['addEventListener']('click',async()=>{const _0x442640=_0x12aa56;if(!_0x41df36['activeChatId']||_0x41df36[_0x442640(0x864)][_0x41df36[_0x442640(0xfc5)]]['isGroup'])return;const _0xc8484d=_0x41df36[_0x442640(0x864)][_0x41df36[_0x442640(0xfc5)]],_0xcdcbc2=await _0x23a88b(_0x442640(0xf7f),_0x442640(0xfe2)+_0xc8484d[_0x442640(0x461)]+'”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。',{'confirmButtonClass':_0x442640(0x51b)});if(_0xcdcbc2){_0xc8484d[_0x442640(0x112b)][_0x442640(0x1fe)]=_0x442640(0xf22),_0xc8484d[_0x442640(0x112b)]['blockedTimestamp']=Date['now']();const _0x4c8afa={'role':_0x442640(0xb1),'content':'[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','timestamp':Date[_0x442640(0x108d)]()+0x1,'isHidden':!![]};_0xc8484d[_0x442640(0xd08)][_0x442640(0x258)](_0x4c8afa),await _0x342df8[_0x442640(0x864)][_0x442640(0x9c0)](_0xc8484d),document[_0x442640(0x383)](_0x442640(0xd48))[_0x442640(0x119a)][_0x442640(0x131d)](_0x442640(0x106d)),_0x409076(_0x41df36[_0x442640(0xfc5)]),_0x25558e();}}),document[_0x12aa56(0x383)](_0x12aa56(0x452))[_0x12aa56(0x271)]('click',async _0x2645b1=>{const _0x45097c=_0x12aa56,_0x5b6b7b=_0x41df36['chats'][_0x41df36[_0x45097c(0xfc5)]];if(!_0x5b6b7b)return;if(_0x2645b1[_0x45097c(0xfab)]['id']==='force-apply-check-btn'){alert(_0x45097c(0x11e)),await _0x49f25f(_0x5b6b7b['id']),_0x409076(_0x5b6b7b['id']);return;}if(_0x2645b1[_0x45097c(0xfab)]['id']===_0x45097c(0xca4)){_0x5b6b7b[_0x45097c(0x112b)][_0x45097c(0x1fe)]=_0x45097c(0x757),_0x5b6b7b[_0x45097c(0x112b)][_0x45097c(0x97)]=null;const _0x332d47={'role':_0x45097c(0xb1),'content':_0x45097c(0x141),'timestamp':Date['now'](),'isHidden':!![]};_0x5b6b7b[_0x45097c(0xd08)]['push'](_0x332d47),await _0x342df8[_0x45097c(0x864)][_0x45097c(0x9c0)](_0x5b6b7b),_0x409076(_0x5b6b7b['id']),_0x25558e(),_0x11e743();}else{if(_0x2645b1['target']['id']===_0x45097c(0x8c7)){_0x5b6b7b[_0x45097c(0x112b)][_0x45097c(0x1fe)]=_0x45097c(0x757),_0x5b6b7b[_0x45097c(0x112b)][_0x45097c(0x6d8)]='';const _0x5f4d98={'role':_0x45097c(0xb1),'type':_0x45097c(0xed8),'content':_0x45097c(0xaab)+_0x5b6b7b[_0x45097c(0x461)]+_0x45097c(0xcec),'timestamp':Date['now']()};_0x5b6b7b['history']['push'](_0x5f4d98);const _0x13bd17={'role':'assistant','senderName':_0x5b6b7b[_0x45097c(0x461)],'content':'太好了！我们又可以聊天啦！','timestamp':Date[_0x45097c(0x108d)]()+0x1};_0x5b6b7b[_0x45097c(0xd08)]['push'](_0x13bd17),await _0x342df8[_0x45097c(0x864)][_0x45097c(0x9c0)](_0x5b6b7b),_0x409076(_0x5b6b7b['id']),_0x25558e();}else{if(_0x2645b1[_0x45097c(0xfab)]['id']===_0x45097c(0xf73))_0x5b6b7b['relationship'][_0x45097c(0x1fe)]=_0x45097c(0xf22),_0x5b6b7b[_0x45097c(0x112b)][_0x45097c(0x97)]=Date[_0x45097c(0x108d)](),_0x5b6b7b['relationship'][_0x45097c(0x6d8)]='',await _0x342df8['chats'][_0x45097c(0x9c0)](_0x5b6b7b),_0x409076(_0x5b6b7b['id']);else{if(_0x2645b1[_0x45097c(0xfab)]['id']===_0x45097c(0x1248)){const _0x6c2c75=await _0x12e332(_0x45097c(0xa4e),'请输入你想对“'+_0x5b6b7b[_0x45097c(0x461)]+_0x45097c(0x12af),_0x45097c(0x10b));_0x6c2c75!==null&&(_0x5b6b7b['relationship'][_0x45097c(0x1fe)]=_0x45097c(0xccf),_0x5b6b7b['relationship']['applicationReason']=_0x6c2c75,await _0x342df8['chats'][_0x45097c(0x9c0)](_0x5b6b7b),_0x409076(_0x5b6b7b['id']),_0x25558e(),_0x11e743());}}}}}),document[_0x12aa56(0x383)](_0x12aa56(0xe4d))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x364447),document[_0x12aa56(0x383)](_0x12aa56(0x859))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x3b2cd2=_0x12aa56;document['getElementById'](_0x3b2cd2(0xa61))[_0x3b2cd2(0x119a)]['remove'](_0x3b2cd2(0x106d));}),document[_0x12aa56(0x383)]('send-group-packet-btn')['addEventListener']('click',_0x1391bd),document[_0x12aa56(0x383)](_0x12aa56(0x1341))['addEventListener'](_0x12aa56(0x5c7),_0x315afe);const _0x1d077b=document[_0x12aa56(0x383)]('rp-tab-group'),_0x43f894=document['getElementById']('rp-tab-direct'),_0x406762=document[_0x12aa56(0x383)](_0x12aa56(0xfcc)),_0x28c137=document[_0x12aa56(0x383)](_0x12aa56(0x127e));_0x1d077b[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x37094f=_0x12aa56;_0x1d077b[_0x37094f(0x119a)][_0x37094f(0xbff)](_0x37094f(0xde5)),_0x43f894[_0x37094f(0x119a)][_0x37094f(0x131d)](_0x37094f(0xde5)),_0x406762['style'][_0x37094f(0x2b6)]='block',_0x28c137[_0x37094f(0x655)][_0x37094f(0x2b6)]='none';}),_0x43f894['addEventListener']('click',()=>{const _0x4c0ffc=_0x12aa56;_0x43f894[_0x4c0ffc(0x119a)][_0x4c0ffc(0xbff)]('active'),_0x1d077b[_0x4c0ffc(0x119a)][_0x4c0ffc(0x131d)](_0x4c0ffc(0xde5)),_0x28c137[_0x4c0ffc(0x655)]['display']='block',_0x406762[_0x4c0ffc(0x655)][_0x4c0ffc(0x2b6)]=_0x4c0ffc(0xa70);}),document[_0x12aa56(0x383)](_0x12aa56(0x6ad))[_0x12aa56(0x271)](_0x12aa56(0xba),_0x51fa1c=>{const _0xf77fe5=_0x12aa56,_0x350c2f=parseFloat(_0x51fa1c[_0xf77fe5(0xfab)]['value'])||0x0;document[_0xf77fe5(0x383)]('rp-group-total')[_0xf77fe5(0x138e)]='¥\x20'+_0x350c2f[_0xf77fe5(0x70d)](0x2);}),document[_0x12aa56(0x383)](_0x12aa56(0x11a7))[_0x12aa56(0x271)](_0x12aa56(0xba),_0x1a2ab4=>{const _0x2c8ee5=_0x12aa56,_0xa69d66=parseFloat(_0x1a2ab4['target']['value'])||0x0;document['getElementById'](_0x2c8ee5(0xd36))['textContent']='¥\x20'+_0xa69d66[_0x2c8ee5(0x70d)](0x2);}),document[_0x12aa56(0x383)]('chat-messages')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x189bfb=>{const _0x4b9767=_0x12aa56,_0x570dd8=_0x189bfb[_0x4b9767(0xfab)][_0x4b9767(0x58c)](_0x4b9767(0x84a));if(!_0x570dd8)return;const _0xb0531a=_0x570dd8['closest'](_0x4b9767(0xbb0));if(!_0xb0531a||!_0xb0531a['dataset'][_0x4b9767(0x3b7)])return;const _0x1292aa=parseInt(_0xb0531a['dataset']['timestamp']);_0x417620(_0x1292aa);}),document[_0x12aa56(0x383)](_0x12aa56(0x6f1))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x3d08da),document['getElementById'](_0x12aa56(0xcda))[_0x12aa56(0x271)]('click',_0x400138),document[_0x12aa56(0x383)](_0x12aa56(0xb72))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x136a38=_0x12aa56;document[_0x136a38(0x383)]('create-poll-modal')['classList'][_0x136a38(0x131d)](_0x136a38(0x106d));}),document['getElementById']('confirm-create-poll-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x22bc78),document['getElementById'](_0x12aa56(0x11cf))[_0x12aa56(0x271)]('click',_0x3bc7b3=>{const _0x3c2acd=_0x12aa56,_0x25aa4c=_0x3bc7b3[_0x3c2acd(0xfab)][_0x3c2acd(0x58c)](_0x3c2acd(0xf42));if(!_0x25aa4c)return;const _0x894025=parseInt(_0x25aa4c[_0x3c2acd(0x118)][_0x3c2acd(0x10f5)]);if(isNaN(_0x894025))return;const _0x32543f=_0x3bc7b3[_0x3c2acd(0xfab)][_0x3c2acd(0x58c)](_0x3c2acd(0x1007));if(_0x32543f&&!_0x25aa4c['classList']['contains'](_0x3c2acd(0x3a6))){_0x4dad9d(_0x894025,_0x32543f[_0x3c2acd(0x118)]['option']);return;}const _0x2558c2=_0x3bc7b3[_0x3c2acd(0xfab)]['closest'](_0x3c2acd(0xdcd));if(_0x2558c2){_0x25aa4c[_0x3c2acd(0x119a)]['contains'](_0x3c2acd(0x3a6))?_0x1b679d(_0x894025):_0x2e655e(_0x894025);return;}_0x25aa4c[_0x3c2acd(0x119a)][_0x3c2acd(0x987)](_0x3c2acd(0x3a6))&&_0x1b679d(_0x894025);}),document['getElementById'](_0x12aa56(0x960))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x2c3cee),document[_0x12aa56(0x383)](_0x12aa56(0xe47))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x5853fc('ai')),document['getElementById'](_0x12aa56(0x1212))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x5853fc(_0x12aa56(0x109d))),document['getElementById']('add-ai-avatar-url-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x36fc71),document['getElementById']('add-ai-avatar-upload-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x1b2fa0=_0x12aa56;document[_0x1b2fa0(0x383)](_0x1b2fa0(0x725))[_0x1b2fa0(0x5c7)]();}),document[_0x12aa56(0x383)](_0x12aa56(0x725))[_0x12aa56(0x271)](_0x12aa56(0x173),_0x51f2f8),document[_0x12aa56(0x383)](_0x12aa56(0x4da))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x804390),document['getElementById'](_0x12aa56(0x9a4))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4a6f07),document[_0x12aa56(0x383)](_0x12aa56(0xac3))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x5b4c16),document[_0x12aa56(0x383)]('add-group-avatar-upload-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x4ab870=_0x12aa56;document[_0x4ab870(0x383)](_0x4ab870(0x1375))[_0x4ab870(0x5c7)]();}),document[_0x12aa56(0x383)](_0x12aa56(0x1375))['addEventListener'](_0x12aa56(0x173),_0x57649c),document[_0x12aa56(0x383)]('close-group-avatar-library-btn')['addEventListener'](_0x12aa56(0x5c7),_0xd102b6),document[_0x12aa56(0x383)]('icon-settings-grid')['addEventListener'](_0x12aa56(0x5c7),_0x5685d1=>{const _0x1cbbb4=_0x12aa56;if(_0x5685d1[_0x1cbbb4(0xfab)]['classList'][_0x1cbbb4(0x987)](_0x1cbbb4(0xe5))){const _0x20066f=_0x5685d1[_0x1cbbb4(0xfab)][_0x1cbbb4(0x58c)](_0x1cbbb4(0xce3)),_0x7d4fa7=_0x20066f[_0x1cbbb4(0x118)][_0x1cbbb4(0xdf7)];_0x7d4fa7&&_0x965993(_0x7d4fa7,'ephone',_0x20066f);}}),document['getElementById'](_0x12aa56(0x11cf))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x3d9a9e=>{const _0x4f6c5c=_0x12aa56,_0x2bd56d=_0x3d9a9e[_0x4f6c5c(0xfab)]['closest'](_0x4f6c5c(0x335));if(_0x2bd56d){const _0x45c908=parseInt(_0x2bd56d[_0x4f6c5c(0x118)][_0x4f6c5c(0x3b7)]);!isNaN(_0x45c908)&&_0x38a572(_0x45c908);}}),document['getElementById'](_0x12aa56(0xfa0))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x2aef0b=_0x12aa56;_0x105acd(_0x2aef0b(0x862));}),_0x438dad[_0x12aa56(0x6e6)]['addEventListener'](_0x12aa56(0x5c7),async _0xcebbe=>{const _0x1a4111=_0x12aa56,_0x2e4faa=_0xcebbe[_0x1a4111(0xfab)]['closest'](_0x1a4111(0xd01));if(_0x2e4faa&&_0x438dad[_0x1a4111(0xf46)]!==null){const _0x221870=_0x2e4faa['style'][_0x1a4111(0x880)]['slice'](0x5,-0x2),_0x3d95a6=_0x41df36[_0x1a4111(0x823)]['find'](_0x3fe223=>_0x3fe223[_0x1a4111(0x2fa)]===_0x221870);_0x3d95a6?await _0x40afd3(_0x438dad[_0x1a4111(0xf46)],_0x3d95a6):console[_0x1a4111(0x17b)](_0x1a4111(0x958),_0x221870);}}),document[_0x12aa56(0x271)]('click',_0x58c66c=>{const _0x4148bc=_0x12aa56;_0x438dad[_0x4148bc(0xe81)]&&!_0x438dad['panelEl']['contains'](_0x58c66c[_0x4148bc(0xfab)])&&!_0x58c66c['target'][_0x4148bc(0x58c)](_0x4148bc(0x7d5))&&_0x2ff22a();}),document[_0x12aa56(0x383)](_0x12aa56(0x21d))[_0x12aa56(0x271)]('click',_0x310a74),document['getElementById'](_0x12aa56(0xfdf))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x2f2679=_0x12aa56;document[_0x2f2679(0x383)](_0x2f2679(0x294))[_0x2f2679(0x119a)]['remove'](_0x2f2679(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0x8f))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x3f34b3),document['getElementById'](_0x12aa56(0x820))[_0x12aa56(0x271)]('change',_0x1bdc62),document['getElementById'](_0x12aa56(0x130b))['addEventListener'](_0x12aa56(0x5c7),_0x5e13ef),document[_0x12aa56(0x383)]('chat-list-title')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1a41ab),document[_0x12aa56(0x383)](_0x12aa56(0xa5c))[_0x12aa56(0x271)]('click',()=>{_0x105acd('chat-list-screen');}),document[_0x12aa56(0x383)](_0x12aa56(0x5e1))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x3ca4b8=>{const _0x166cc8=_0x12aa56,_0x168a48=_0x3ca4b8[_0x166cc8(0xfab)][_0x166cc8(0x58c)](_0x166cc8(0xb7a));_0x168a48&&_0x168a48[_0x166cc8(0x118)][_0x166cc8(0x1e0)]&&_0x323913(parseInt(_0x168a48[_0x166cc8(0x118)][_0x166cc8(0x1e0)]));}),document['getElementById'](_0x12aa56(0xc4e))[_0x12aa56(0x271)]('click',()=>{const _0x2e5587=_0x12aa56;document[_0x2e5587(0x383)](_0x2e5587(0x64d))[_0x2e5587(0x119a)]['remove'](_0x2e5587(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0x105e))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x10d88d),document[_0x12aa56(0x383)](_0x12aa56(0x435))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0xa2124e=_0x12aa56;_0x4f051e[_0xa2124e(0x1240)]>0x0&&_0x47240b();}),document[_0x12aa56(0x383)](_0x12aa56(0x1a1))[_0x12aa56(0x271)]('click',_0x45ab6a),document[_0x12aa56(0x383)](_0x12aa56(0xa3b))['addEventListener']('click',async()=>{const _0x3afa40=_0x12aa56,_0x197a17=_0x41df36[_0x3afa40(0x864)][_0x41df36[_0x3afa40(0xfc5)]],_0x5ca3bc=Array[_0x3afa40(0x365)](document[_0x3afa40(0x400)](_0x3afa40(0xbe9)))['map'](_0x215756=>_0x215756[_0x3afa40(0x118)][_0x3afa40(0xa65)]);if(_0x5ca3bc[_0x3afa40(0xfde)]===0x0){alert(_0x3afa40(0xd9));return;}const _0x451737=[],_0x54bd52=[..._0x4f051e]['sort']((_0x2e4ac7,_0x111281)=>_0x2e4ac7-_0x111281);for(const _0x2302cf of _0x54bd52){const _0x1e5507=_0x197a17[_0x3afa40(0xd08)][_0x3afa40(0xd12)](_0x2135c4=>_0x2135c4[_0x3afa40(0x3b7)]===_0x2302cf);_0x1e5507&&_0x451737[_0x3afa40(0x258)](_0x1e5507);}const _0x331d48={'role':_0x3afa40(0x66e),'senderName':_0x197a17[_0x3afa40(0x1a2)]?_0x197a17[_0x3afa40(0x886)][_0x3afa40(0x52e)]||'我':'我','type':_0x3afa40(0xf99),'timestamp':Date[_0x3afa40(0x108d)](),'payload':{'sourceChatName':_0x197a17[_0x3afa40(0x461)],'title':'来自“'+_0x197a17['name']+_0x3afa40(0x107),'sharedHistory':_0x451737}};for(const _0x2b6554 of _0x5ca3bc){const _0x9a7994=_0x41df36[_0x3afa40(0x864)][_0x2b6554];_0x9a7994&&(_0x9a7994[_0x3afa40(0xd08)][_0x3afa40(0x258)](_0x331d48),await _0x342df8[_0x3afa40(0x864)]['put'](_0x9a7994));}document[_0x3afa40(0x383)]('share-target-modal')[_0x3afa40(0x119a)][_0x3afa40(0x131d)](_0x3afa40(0x106d)),_0x11c2ba(),await _0x296ef9(_0x3afa40(0x7b1),_0x3afa40(0x1059)+_0x5ca3bc[_0x3afa40(0xfde)]+_0x3afa40(0x43d)),_0x25558e();}),document[_0x12aa56(0x383)](_0x12aa56(0x973))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x53cee5=_0x12aa56;document['getElementById']('share-target-modal')[_0x53cee5(0x119a)][_0x53cee5(0x131d)]('visible');}),document[_0x12aa56(0x383)](_0x12aa56(0x11cf))['addEventListener'](_0x12aa56(0x5c7),_0x7e07bf=>{const _0x6bddeb=_0x12aa56,_0x34bf9a=_0x7e07bf['target']['closest'](_0x6bddeb(0x127b));if(_0x34bf9a&&_0x34bf9a[_0x6bddeb(0x58c)](_0x6bddeb(0xc16))){const _0x11574b=parseInt(_0x34bf9a[_0x6bddeb(0x118)][_0x6bddeb(0x3b7)]);_0x5e25dc(_0x11574b);}}),document[_0x12aa56(0x383)](_0x12aa56(0x38c))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x42c745=_0x12aa56;document[_0x42c745(0x383)](_0x42c745(0x11aa))[_0x42c745(0x119a)][_0x42c745(0x131d)](_0x42c745(0x106d));});async function _0x5e25dc(_0x5ecbc2){const _0x503143=_0x12aa56,_0x47b2e9=_0x41df36['chats'][_0x41df36[_0x503143(0xfc5)]];if(!_0x47b2e9)return;const _0x249ff0=_0x47b2e9[_0x503143(0xd08)][_0x503143(0xd12)](_0x2e1c2a=>_0x2e1c2a[_0x503143(0x3b7)]===_0x5ecbc2);if(!_0x249ff0){console[_0x503143(0x98)](_0x503143(0xa9d),_0x5ecbc2),await _0x296ef9(_0x503143(0x73b),_0x503143(0x4d6));return;}if(_0x249ff0[_0x503143(0xa6b)]==='share_link'){_0x38a572(_0x5ecbc2);return;}if(_0x249ff0['type']==='share_card'){if(!_0x249ff0[_0x503143(0xd32)]||!_0x249ff0['payload'][_0x503143(0x10c8)]){console['error'](_0x503143(0xa8e),_0x249ff0),await _0x296ef9(_0x503143(0x73b),_0x503143(0xfd9));return;}}else{console[_0x503143(0x98)](_0x503143(0x2e7),_0x249ff0[_0x503143(0xa6b)]),await _0x296ef9(_0x503143(0x73b),_0x503143(0xe15));return;}const _0x17fc8d=document[_0x503143(0x383)](_0x503143(0x11aa)),_0x1fd5c7=document['getElementById']('shared-history-viewer-title'),_0x5309a2=document[_0x503143(0x383)](_0x503143(0x26d));_0x1fd5c7[_0x503143(0x138e)]=_0x249ff0[_0x503143(0xd32)][_0x503143(0xf3a)],_0x5309a2[_0x503143(0x45c)]='';const _0x548ca5=document[_0x503143(0x389)](),_0x491dab=Object[_0x503143(0x76d)](_0x41df36[_0x503143(0x864)])[_0x503143(0xd12)](_0x20a83d=>_0x20a83d['name']===_0x249ff0[_0x503143(0xd32)][_0x503143(0x1304)])||_0x47b2e9;for(const _0x2acb2a of _0x249ff0[_0x503143(0xd32)][_0x503143(0x10c8)]){const _0x5b6434=await _0x152d98(_0x2acb2a,_0x491dab);_0x5b6434&&_0x548ca5[_0x503143(0xe91)](_0x5b6434);}_0x5309a2[_0x503143(0xe91)](_0x548ca5),_0x17fc8d['classList'][_0x503143(0xbff)]('visible');}_0x17f24d[_0x12aa56(0x271)]('timeupdate',_0x5ce764),_0x17f24d[_0x12aa56(0x271)]('pause',()=>{const _0x201f33=_0x12aa56;_0x40e606[_0x201f33(0x40d)]&&(_0x40e606[_0x201f33(0xea0)]=![],_0x16763b());}),_0x17f24d[_0x12aa56(0x271)](_0x12aa56(0x554),()=>{const _0x51a4b4=_0x12aa56;_0x40e606[_0x51a4b4(0x40d)]&&(_0x40e606['isPlaying']=!![],_0x16763b());}),document[_0x12aa56(0x383)]('playlist-body')['addEventListener'](_0x12aa56(0x5c7),async _0x6a3ad=>{const _0x540e7b=_0x12aa56,_0x2f2bba=_0x6a3ad[_0x540e7b(0xfab)],_0x234801=_0x2f2bba['closest']('.album-art-btn');if(_0x234801){const _0x3d2ef8=parseInt(_0x234801[_0x540e7b(0x118)][_0x540e7b(0x1297)]);!isNaN(_0x3d2ef8)&&await _0x5416aa(_0x3d2ef8);return;}const _0x103008=_0x2f2bba[_0x540e7b(0x58c)](_0x540e7b(0xeef));if(_0x103008){const _0xcc1f4b=parseInt(_0x103008['dataset']['index']);if(isNaN(_0xcc1f4b))return;await _0x5f0f67(_0xcc1f4b);return;}const _0x449ea6=_0x2f2bba['closest'](_0x540e7b(0xa63));if(_0x449ea6){const _0x140def=parseInt(_0x449ea6[_0x540e7b(0x118)][_0x540e7b(0x1297)]);if(isNaN(_0x140def))return;const _0x107b59=_0x40e606[_0x540e7b(0x91b)][_0x140def],_0x1964a9=await _0x23a88b('删除歌曲',_0x540e7b(0xb1c)+_0x107b59[_0x540e7b(0x461)]+_0x540e7b(0x75c));_0x1964a9&&_0xf87ae5(_0x140def);return;}const _0x2df113=_0x2f2bba['closest'](_0x540e7b(0xe56));if(_0x2df113){const _0x4f3631=_0x2df113[_0x540e7b(0x58c)](_0x540e7b(0xa20)),_0x5c950a=Array['from'](_0x4f3631[_0x540e7b(0x12f3)][_0x540e7b(0xbd4)])['indexOf'](_0x4f3631);_0x5c950a>-0x1&&_0x13cdf1(_0x5c950a);}}),document[_0x12aa56(0x89c)](_0x12aa56(0x560))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x322a35=>{const _0x531f9f=_0x12aa56;if(!_0x17f24d[_0x531f9f(0xdf4)])return;const _0x38f6b5=_0x322a35[_0x531f9f(0xe6b)],_0x5b3ecb=_0x38f6b5[_0x531f9f(0xe79)],_0x1be19a=_0x322a35[_0x531f9f(0xf15)];_0x17f24d[_0x531f9f(0x60f)]=_0x1be19a/_0x5b3ecb*_0x17f24d['duration'];}),document['getElementById'](_0x12aa56(0x11cf))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x33a0c2=>{const _0x15345f=_0x12aa56,_0x281b2d=_0x33a0c2[_0x15345f(0xfab)][_0x15345f(0x58c)](_0x15345f(0xf96));if(_0x281b2d){const _0x2b8540=_0x41df36[_0x15345f(0x864)][_0x41df36[_0x15345f(0xfc5)]],_0x2b5f3c=_0x281b2d[_0x15345f(0x58c)](_0x15345f(0x1096));if(_0x2b8540&&_0x2b5f3c){const _0x156cd0=parseInt(_0x2b5f3c[_0x15345f(0x118)][_0x15345f(0x3b7)]),_0x5c345a=_0x2b8540['history'][_0x15345f(0xd12)](_0x24a79c=>_0x24a79c[_0x15345f(0x3b7)]===_0x156cd0);if(_0x5c345a&&_0x5c345a['recalledData']){let _0x21451b='';const _0x417516=_0x5c345a['recalledData'];switch(_0x417516[_0x15345f(0x18b)]){case _0x15345f(0x6af):_0x21451b=_0x15345f(0xfb2)+_0x417516[_0x15345f(0xf2e)]+'\x22';break;case _0x15345f(0xed0):case _0x15345f(0x1050):case'text_image':_0x21451b=_0x15345f(0xf4a)+_0x417516['originalContent']+'\x22';break;case _0x15345f(0xa4f):_0x21451b=_0x15345f(0x760)+_0x417516[_0x15345f(0xf2e)]+'\x22';break;case _0x15345f(0x37d):_0x21451b=_0x15345f(0x13d)+(_0x417516['originalMeaning']||_0x15345f(0xa2c))+_0x15345f(0x95d)+_0x417516['originalContent'];break;case _0x15345f(0x909):_0x21451b='一条[转账]消息已被撤回。';break;default:_0x21451b=_0x15345f(0x4c4)+_0x417516[_0x15345f(0x18b)]+_0x15345f(0x1060)+JSON[_0x15345f(0x3fb)](_0x417516[_0x15345f(0xf2e)]);break;}_0x296ef9(_0x15345f(0x1335),_0x21451b);}}}}),document[_0x12aa56(0x383)](_0x12aa56(0xf40))[_0x12aa56(0x271)]('click',_0x5daa0c),document[_0x12aa56(0x383)](_0x12aa56(0xc14))['addEventListener'](_0x12aa56(0x5c7),()=>{const _0x4af50a=_0x12aa56;document[_0x4af50a(0x383)](_0x4af50a(0x874))[_0x4af50a(0x119a)][_0x4af50a(0x131d)](_0x4af50a(0x106d)),_0x11e574();}),document[_0x12aa56(0x383)]('add-new-category-btn')[_0x12aa56(0x271)]('click',_0x411bf9),document[_0x12aa56(0x383)](_0x12aa56(0x120b))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4aca4e=>{const _0x339a9e=_0x12aa56;if(_0x4aca4e['target'][_0x339a9e(0x119a)]['contains']('delete-group-btn')){const _0x58db00=parseInt(_0x4aca4e[_0x339a9e(0xfab)][_0x339a9e(0x118)]['id']);_0x202adb(_0x58db00);}}),document[_0x12aa56(0x383)](_0x12aa56(0x107d))['addEventListener']('click',_0x2386f0),document[_0x12aa56(0x383)](_0x12aa56(0x1d6))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x372cc6),document[_0x12aa56(0x383)](_0x12aa56(0x108))['addEventListener']('click',_0xcb69ba),document[_0x12aa56(0x383)](_0x12aa56(0xeff))['addEventListener'](_0x12aa56(0x5c7),_0x58fe25),document['getElementById'](_0x12aa56(0x7ea))[_0x12aa56(0x271)](_0x12aa56(0xba),_0x4c18e5=>{const _0x1d5b63=_0x12aa56;if(!_0x4c18e5['target']['matches'](_0x1d5b63(0x550)))return;const _0x4b6ec2=_0x4c18e5[_0x1d5b63(0xfab)],_0x5f2592=_0x4b6ec2[_0x1d5b63(0x58c)](_0x1d5b63(0x7c7));if(!_0x5f2592)return;const _0x26585b=_0x5f2592[_0x1d5b63(0x89c)](_0x1d5b63(0xf57)),_0x53e96f=_0x4b6ec2[_0x1d5b63(0x1be)],_0x26af6f=_0x53e96f[_0x1d5b63(0x22e)](/@([\p{L}\w]*)$/u);if(_0x26af6f){const _0x1b833e=new Set(),_0x42c37a=_0x5f2592[_0x1d5b63(0x89c)]('.post-nickname')?.[_0x1d5b63(0x138e)];if(_0x42c37a)_0x1b833e[_0x1d5b63(0xbff)](_0x42c37a);_0x5f2592[_0x1d5b63(0x400)](_0x1d5b63(0x206))[_0x1d5b63(0x19c)](_0x3d0028=>{const _0x4adda6=_0x1d5b63;_0x1b833e[_0x4adda6(0xbff)](_0x3d0028[_0x4adda6(0x138e)][_0x4adda6(0x709)](':',''));}),_0x1b833e[_0x1d5b63(0x971)](_0x41df36['qzoneSettings'][_0x1d5b63(0xabb)]),_0x26585b[_0x1d5b63(0x45c)]='';if(_0x1b833e[_0x1d5b63(0x1240)]>0x0){const _0x3db80b=_0x26af6f[0x1];_0x1b833e[_0x1d5b63(0x19c)](_0x8b87c=>{const _0x9acb9b=_0x1d5b63;if(_0x8b87c[_0x9acb9b(0x189)]()['includes'](_0x3db80b['toLowerCase']())){const _0x57d8a1=document[_0x9acb9b(0xe1b)]('div');_0x57d8a1[_0x9acb9b(0x556)]=_0x9acb9b(0xc68),_0x57d8a1['textContent']=_0x8b87c,_0x57d8a1[_0x9acb9b(0x271)](_0x9acb9b(0x413),_0x5cf5ae=>{const _0x327623=_0x9acb9b;_0x5cf5ae[_0x327623(0xe94)]();const _0xfd23c3=_0x53e96f[_0x327623(0xba5)](0x0,_0x26af6f[_0x327623(0x1297)])+('@'+_0x8b87c+'\x20');_0x4b6ec2[_0x327623(0x1be)]=_0xfd23c3,_0x26585b[_0x327623(0x655)][_0x327623(0x2b6)]=_0x327623(0xa70),_0x4b6ec2['focus']();}),_0x26585b[_0x9acb9b(0xe91)](_0x57d8a1);}}),_0x26585b[_0x1d5b63(0x655)][_0x1d5b63(0x2b6)]=_0x26585b[_0x1d5b63(0xbd4)][_0x1d5b63(0xfde)]>0x0?_0x1d5b63(0x27a):_0x1d5b63(0xa70);}else _0x26585b[_0x1d5b63(0x655)]['display']=_0x1d5b63(0xa70);}else _0x26585b[_0x1d5b63(0x655)][_0x1d5b63(0x2b6)]=_0x1d5b63(0xa70);}),document[_0x12aa56(0x383)](_0x12aa56(0x7ea))['addEventListener'](_0x12aa56(0x2c3),_0x491997=>{const _0x4e813e=_0x12aa56;if(_0x491997[_0x4e813e(0xfab)][_0x4e813e(0x8ea)](_0x4e813e(0x550))){const _0x104592=_0x491997['target'][_0x4e813e(0x58c)]('.qzone-post-container');if(_0x104592){const _0x50a787=_0x104592[_0x4e813e(0x89c)](_0x4e813e(0xf57));_0x50a787&&setTimeout(()=>{const _0x5a39e1=_0x4e813e;_0x50a787[_0x5a39e1(0x655)][_0x5a39e1(0x2b6)]=_0x5a39e1(0xa70);},0xc8);}}});const _0x28cd14=document[_0x12aa56(0x383)](_0x12aa56(0x8ef)),_0x3d878e=document[_0x12aa56(0x383)]('chat-at-mention-popup');_0x28cd14[_0x12aa56(0x271)](_0x12aa56(0xba),()=>{const _0x4de286=_0x12aa56;if(!_0x41df36['activeChatId']||!_0x41df36[_0x4de286(0x864)][_0x41df36[_0x4de286(0xfc5)]]['isGroup']){_0x3d878e[_0x4de286(0x655)]['display']=_0x4de286(0xa70);return;}const _0x1667aa=_0x41df36[_0x4de286(0x864)][_0x41df36[_0x4de286(0xfc5)]],_0x13ac1e=_0x28cd14['value'],_0x2c0334=_0x13ac1e[_0x4de286(0x22e)](/@([\p{L}\w]*)$/u);if(_0x2c0334){const _0x211988=_0x1667aa[_0x4de286(0x886)][_0x4de286(0x52e)]||'我',_0x18f8d3=_0x1667aa[_0x4de286(0x12a6)][_0x4de286(0xa79)](_0x1184e4=>_0x1184e4['groupNickname'])[_0x4de286(0x98a)](_0x28e626=>_0x28e626!==_0x211988);_0x3d878e[_0x4de286(0x45c)]='';if(_0x18f8d3[_0x4de286(0xfde)]>0x0){const _0x1410fe=_0x2c0334[0x1];_0x18f8d3[_0x4de286(0x19c)](_0xcd99c9=>{const _0x1e551d=_0x4de286;if(_0xcd99c9[_0x1e551d(0x189)]()[_0x1e551d(0xee2)](_0x1410fe[_0x1e551d(0x189)]())){const _0x189e28=document['createElement']('div');_0x189e28[_0x1e551d(0x556)]='at-mention-item',_0x189e28[_0x1e551d(0x138e)]=_0xcd99c9,_0x189e28['addEventListener'](_0x1e551d(0x413),_0x5066ed=>{const _0x134c1c=_0x1e551d;_0x5066ed[_0x134c1c(0xe94)]();const _0x111981=_0x13ac1e[_0x134c1c(0xba5)](0x0,_0x2c0334[_0x134c1c(0x1297)])+('@'+_0xcd99c9+'\x20');_0x28cd14['value']=_0x111981,_0x3d878e['style'][_0x134c1c(0x2b6)]=_0x134c1c(0xa70),_0x28cd14[_0x134c1c(0xede)]();}),_0x3d878e[_0x1e551d(0xe91)](_0x189e28);}}),_0x3d878e[_0x4de286(0x655)][_0x4de286(0x2b6)]=_0x3d878e['children'][_0x4de286(0xfde)]>0x0?_0x4de286(0x27a):'none';}else _0x3d878e[_0x4de286(0x655)][_0x4de286(0x2b6)]=_0x4de286(0xa70);}else _0x3d878e['style']['display']=_0x4de286(0xa70);}),_0x28cd14[_0x12aa56(0x271)](_0x12aa56(0x186),()=>{setTimeout(()=>{const _0xcadc18=_0x42ed;_0x3d878e[_0xcadc18(0x655)][_0xcadc18(0x2b6)]=_0xcadc18(0xa70);},0xc8);}),document['getElementById'](_0x12aa56(0x1039))[_0x12aa56(0x271)]('click',_0x28df0d),document['getElementById'](_0x12aa56(0x37a))['addEventListener'](_0x12aa56(0x5c7),_0x49940a),document['getElementById'](_0x12aa56(0xf4c))['addEventListener']('click',()=>{const _0x421c6a=_0x12aa56;document[_0x421c6a(0x383)](_0x421c6a(0xd49))[_0x421c6a(0x119a)][_0x421c6a(0x131d)](_0x421c6a(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0xd60))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x5d8753=>{const _0x26eab8=_0x12aa56;if(_0x5d8753[_0x26eab8(0xfab)][_0x26eab8(0x119a)][_0x26eab8(0x987)](_0x26eab8(0x1281))){const _0x54eee4=_0x5d8753[_0x26eab8(0xfab)][_0x26eab8(0x118)][_0x26eab8(0x1101)];_0x54eee4&&_0x1523f2(_0x54eee4);}}),document[_0x12aa56(0x383)](_0x12aa56(0xe7a))['addEventListener'](_0x12aa56(0x5c7),_0x577415),document[_0x12aa56(0x383)](_0x12aa56(0xc09))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x3ff579),document[_0x12aa56(0x383)](_0x12aa56(0xf36))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x164b74=_0x12aa56;document[_0x164b74(0x383)](_0x164b74(0x12db))[_0x164b74(0x119a)][_0x164b74(0x131d)](_0x164b74(0x106d));}),document[_0x12aa56(0x383)]('reset-global-css-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x386979=_0x12aa56;document[_0x386979(0x383)](_0x386979(0xd4d))[_0x386979(0x1be)]='';}),document[_0x12aa56(0x383)](_0x12aa56(0xdd2))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1cf19c),document[_0x12aa56(0x383)](_0x12aa56(0xfe9))['addEventListener'](_0x12aa56(0x5c7),()=>{_0x105acd('chat-interface-screen');}),document[_0x12aa56(0x383)](_0x12aa56(0xc15))['addEventListener'](_0x12aa56(0x5c7),_0x3ea343),document['getElementById'](_0x12aa56(0xaf5))[_0x12aa56(0x271)]('click',_0x21c325),document[_0x12aa56(0x383)](_0x12aa56(0x1315))['addEventListener'](_0x12aa56(0x5c7),_0x5749d9=>{const _0x431a47=_0x12aa56,_0x2a87b5=_0x5749d9[_0x431a47(0xfab)][_0x431a47(0x58c)]('.edit-memory-btn');if(_0x2a87b5){_0x127d87(_0x2a87b5['dataset'][_0x431a47(0x1301)],parseInt(_0x2a87b5['dataset'][_0x431a47(0xd79)]));return;}const _0x52df01=_0x5749d9[_0x431a47(0xfab)][_0x431a47(0x58c)](_0x431a47(0xeaf));if(_0x52df01){_0x47a9a6(_0x52df01[_0x431a47(0x118)][_0x431a47(0x1301)],parseInt(_0x52df01[_0x431a47(0x118)]['memoryTimestamp']));return;}}),document[_0x12aa56(0x383)]('gomoku-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x5906aa),document[_0x12aa56(0x383)](_0x12aa56(0x476))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x153525);const _0x3cbbc6=document[_0x12aa56(0x383)]('gomoku-board');_0x3cbbc6['addEventListener'](_0x12aa56(0x1287),_0x4dbf40),_0x3cbbc6['addEventListener'](_0x12aa56(0x12a2),()=>_0x37d3cc(_0x41df36[_0x12aa56(0xfc5)])),_0x3cbbc6[_0x12aa56(0x271)]('click',_0xf0131c),document[_0x12aa56(0x383)](_0x12aa56(0x1264))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x244e56=_0x12aa56;document[_0x244e56(0x383)]('countdown-title-input')[_0x244e56(0x1be)]='',document[_0x244e56(0x383)](_0x244e56(0x10c6))[_0x244e56(0x1be)]='',document[_0x244e56(0x383)](_0x244e56(0x118e))['classList']['add'](_0x244e56(0x106d));}),document['getElementById']('cancel-create-countdown-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x18a44a=_0x12aa56;document[_0x18a44a(0x383)](_0x18a44a(0x118e))[_0x18a44a(0x119a)]['remove']('visible');}),document[_0x12aa56(0x383)]('edit-call-message-btn')['addEventListener'](_0x12aa56(0x5c7),_0x1f87c2),document[_0x12aa56(0x383)](_0x12aa56(0x1381))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4faede),document[_0x12aa56(0x383)](_0x12aa56(0x443))['addEventListener'](_0x12aa56(0x5c7),_0x42d98e),document['getElementById'](_0x12aa56(0x107e))['addEventListener'](_0x12aa56(0x5c7),_0x58b49b),document[_0x12aa56(0x383)]('cancel-ai-response-editor-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x2a3664=_0x12aa56;document[_0x2a3664(0x383)](_0x2a3664(0xa73))['classList'][_0x2a3664(0x131d)]('visible');}),document['getElementById'](_0x12aa56(0xb00))['addEventListener'](_0x12aa56(0x5c7),_0x4eefc7),document[_0x12aa56(0x383)](_0x12aa56(0xa29))[_0x12aa56(0x271)]('click',()=>{const _0x2961df=_0x12aa56,_0x55b87a=document[_0x2961df(0x383)]('ai-response-editor-container'),_0x464936=_0x29685e(_0x2961df(0x36a));_0x55b87a[_0x2961df(0xe91)](_0x464936),_0x464936[_0x2961df(0x89c)]('textarea')[_0x2961df(0xede)]();}),document[_0x12aa56(0x383)](_0x12aa56(0x208))['addEventListener']('click',_0x43cbab),document['getElementById'](_0x12aa56(0x93d))[_0x12aa56(0x271)]('click',_0x5e05c2),document[_0x12aa56(0x383)](_0x12aa56(0x106c))[_0x12aa56(0x271)]('click',_0xc8e6bd),document['getElementById'](_0x12aa56(0x49a))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x3844e8=_0x12aa56;document[_0x3844e8(0x383)](_0x3844e8(0x580))['click']();}),document[_0x12aa56(0x383)](_0x12aa56(0x580))[_0x12aa56(0x271)](_0x12aa56(0x173),_0x11f883),document['getElementById'](_0x12aa56(0x262))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x9ec0ae=_0x12aa56,_0x46190a=_0x9ec0ae(0x119f),_0x302913=await _0x12e332(_0x9ec0ae(0x1222),_0x46190a,'',_0x9ec0ae(0xfe5));_0x302913&&_0x302913['trim']()&&await _0x3a77ca(_0x302913);}),document[_0x12aa56(0x383)](_0x12aa56(0x73c))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x291d51),document['getElementById'](_0x12aa56(0x125d))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x105acd(_0x12aa56(0x862))),document[_0x12aa56(0x383)](_0x12aa56(0x677))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x46e9da),document[_0x12aa56(0x383)](_0x12aa56(0x47e))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x291d51),document[_0x12aa56(0x383)](_0x12aa56(0xe51))[_0x12aa56(0x271)]('click',_0x409765),document[_0x12aa56(0x383)](_0x12aa56(0x4fa))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x10fbd1=_0x12aa56;document[_0x10fbd1(0x383)](_0x10fbd1(0x995))[_0x10fbd1(0x119a)][_0x10fbd1(0x131d)](_0x10fbd1(0x106d));}),document['getElementById']('manage-products-btn')[_0x12aa56(0x271)]('click',()=>{const _0x16b930=_0x12aa56;_0x5938ff=!_0x5938ff;const _0x22b4be=document[_0x16b930(0x383)](_0x16b930(0x138c)),_0x1cc86d=document[_0x16b930(0x383)](_0x16b930(0xbc8)),_0x4305a6=document[_0x16b930(0x383)](_0x16b930(0x8fe));_0x22b4be['style'][_0x16b930(0x1081)]=_0x5938ff?_0x16b930(0x913):_0x16b930(0x6e7),_0x5938ff?(_0x1cc86d['style'][_0x16b930(0x2b6)]=_0x16b930(0x2aa),_0x4305a6[_0x16b930(0x655)][_0x16b930(0x953)]=_0x16b930(0xd90)):(_0x1cc86d['style'][_0x16b930(0x2b6)]='none',_0x4305a6[_0x16b930(0x655)][_0x16b930(0x953)]='',_0x403266[_0x16b930(0x4b8)](),document[_0x16b930(0x400)]('.product-item.selected')[_0x16b930(0x19c)](_0x4ec86c=>_0x4ec86c[_0x16b930(0x119a)][_0x16b930(0x131d)](_0x16b930(0x35e))),document[_0x16b930(0x383)](_0x16b930(0x9bc))[_0x16b930(0x138e)]=_0x16b930(0x4b0),document[_0x16b930(0x383)](_0x16b930(0xc6c))[_0x16b930(0x2a3)]=![]),_0x568766(),_0x56c6ca();}),document[_0x12aa56(0x383)](_0x12aa56(0x4f6))[_0x12aa56(0x271)]('click',()=>{const _0x1f8e1c=_0x12aa56;_0x5938ff?_0x50567a(null):alert(_0x1f8e1c(0x129));}),document[_0x12aa56(0x383)](_0x12aa56(0x8fe))[_0x12aa56(0x271)]('click',async _0x40fc85=>{const _0xc9756d=_0x12aa56,_0x5e76d6=_0x40fc85[_0xc9756d(0xfab)]['closest'](_0xc9756d(0x47f));if(!_0x5e76d6)return;const _0x1dfd9=parseInt(_0x5e76d6[_0xc9756d(0x118)]['id']);if(isNaN(_0x1dfd9))return;if(_0x5938ff){if(_0x40fc85[_0xc9756d(0xfab)][_0xc9756d(0x119a)][_0xc9756d(0x987)]('edit-product-btn')){_0x50567a(_0x1dfd9);return;}if(_0x40fc85['target'][_0xc9756d(0x119a)][_0xc9756d(0x987)](_0xc9756d(0x12a3))){const _0xbc5e87=await _0x342df8['shoppingProducts'][_0xc9756d(0x1a3)](_0x1dfd9);if(!_0xbc5e87)return;const _0x1e8322=await _0x23a88b('删除商品',_0xc9756d(0x2d2)+_0xbc5e87[_0xc9756d(0x461)]+'”\x20吗？',{'confirmButtonClass':_0xc9756d(0x51b)});_0x1e8322&&(await _0x342df8['shoppingProducts'][_0xc9756d(0x971)](_0x1dfd9),await _0x568766(),alert(_0xc9756d(0xf9d)));return;}_0x5e76d6['classList']['toggle'](_0xc9756d(0x35e));_0x403266[_0xc9756d(0xcde)](_0x1dfd9)?_0x403266['delete'](_0x1dfd9):_0x403266[_0xc9756d(0xbff)](_0x1dfd9);document[_0xc9756d(0x383)]('delete-selected-products-btn')[_0xc9756d(0x138e)]=_0xc9756d(0x7a4)+_0x403266[_0xc9756d(0x1240)]+')';return;}if(_0x40fc85[_0xc9756d(0xfab)][_0xc9756d(0x119a)][_0xc9756d(0x987)](_0xc9756d(0x12d4))){const _0x390b64=await _0x342df8[_0xc9756d(0xd18)][_0xc9756d(0x1a3)](_0x1dfd9);_0x390b64[_0xc9756d(0xade)]&&_0x390b64[_0xc9756d(0xade)]['length']>0x0?_0x5f374c(_0x1dfd9):(await _0x5d8470(_0x1dfd9),await _0x296ef9('成功',_0xc9756d(0x1f1)));return;}_0x5e76d6[_0xc9756d(0x987)](_0x40fc85[_0xc9756d(0xfab)])&&console[_0xc9756d(0xe72)]('点击了商品卡片:\x20'+_0x1dfd9);}),document[_0x12aa56(0x383)](_0x12aa56(0xe8b))['addEventListener']('click',_0x14f2cc=>{const _0x17b2a4=_0x12aa56,_0x5ca6c3=_0x14f2cc[_0x17b2a4(0xfab)];_0x5ca6c3[_0x17b2a4(0x119a)]['contains']('decrease-qty-btn')&&_0x23209a(parseInt(_0x5ca6c3[_0x17b2a4(0x118)]['id']),-0x1),_0x5ca6c3[_0x17b2a4(0x119a)][_0x17b2a4(0x987)](_0x17b2a4(0x1371))&&_0x23209a(parseInt(_0x5ca6c3[_0x17b2a4(0x118)]['id']),0x1),_0x5ca6c3['classList'][_0x17b2a4(0x987)](_0x17b2a4(0x83a))&&_0x5db0e4();}),document['getElementById'](_0x12aa56(0x56f))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x4f56fb=_0x12aa56;if(_0x51a1bd[_0x4f56fb(0xfde)]===0x0)return;const _0x498ce0=await _0x23a88b(_0x4f56fb(0x10e),'确定要清空购物车中的所有商品吗？');_0x498ce0&&(_0x51a1bd=[],_0x4a2f15(),_0x34c15d());}),document[_0x12aa56(0x383)](_0x12aa56(0xaf2))[_0x12aa56(0x271)](_0x12aa56(0x173),function(_0x581c92){const _0x38c671=_0x12aa56;document[_0x38c671(0x400)](_0x38c671(0xf5b))[_0x38c671(0x19c)](_0x403ee2=>{const _0x30bdb5=_0x38c671;_0x403ee2[_0x30bdb5(0x2a3)]=_0x581c92[_0x30bdb5(0xfab)]['checked'];}),_0x5db0e4();}),document[_0x12aa56(0x383)](_0x12aa56(0x9d2))[_0x12aa56(0x271)]('click',()=>{const _0x40b86b=_0x12aa56;document[_0x40b86b(0x383)]('product-editor-modal')[_0x40b86b(0x119a)][_0x40b86b(0x131d)](_0x40b86b(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0x764))['addEventListener']('click',_0x3b1045),document['getElementById'](_0x12aa56(0x90d))[_0x12aa56(0x271)]('change',_0x87a163=>{const _0x48ef48=_0x12aa56,_0x9c4b17=_0x87a163[_0x48ef48(0xfab)][_0x48ef48(0x1185)][0x0];if(_0x9c4b17){const _0x2683fb=new FileReader();_0x2683fb[_0x48ef48(0xb5b)]=_0x3259d5=>{const _0x15b4a7=_0x48ef48;document[_0x15b4a7(0x383)](_0x15b4a7(0x1022))[_0x15b4a7(0xf6c)]=_0x3259d5['target'][_0x15b4a7(0xa86)];},_0x2683fb[_0x48ef48(0x132a)](_0x9c4b17);}}),document[_0x12aa56(0x383)]('chat-messages')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x552169=>{const _0x5a9488=_0x12aa56,_0x2edce2=_0x552169[_0x5a9488(0xfab)][_0x5a9488(0x58c)](_0x5a9488(0xb59));if(_0x2edce2){const _0xe8d671=_0x2edce2[_0x5a9488(0x58c)]('.message-bubble');_0xe8d671&&_0x511cbe(parseInt(_0xe8d671[_0x5a9488(0x118)][_0x5a9488(0x3b7)]));}}),document[_0x12aa56(0x383)](_0x12aa56(0x137e))[_0x12aa56(0x271)]('click',()=>{const _0x13d4d3=_0x12aa56;document['getElementById']('gift-recipient-modal')['classList'][_0x13d4d3(0x131d)](_0x13d4d3(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0x7b5))['addEventListener']('click',async()=>{const _0x505edc=_0x12aa56,_0x15c103=Array[_0x505edc(0x365)](document[_0x505edc(0x400)]('#gift-recipient-list\x20.contact-picker-item.selected'))[_0x505edc(0xa79)](_0x4fab3f=>_0x4fab3f[_0x505edc(0x118)][_0x505edc(0x2a5)]);if(_0x15c103[_0x505edc(0xfde)]===0x0){alert('请至少选择一位收礼人。');return;}const _0x2893da=_0x51a1bd[_0x505edc(0x98a)](_0x5bebcc=>document[_0x505edc(0x89c)](_0x505edc(0xebf)+_0x5bebcc['productId']+_0x505edc(0x1303)));await _0x55416b(_0x2893da,_0x15c103),document[_0x505edc(0x383)](_0x505edc(0xbb7))[_0x505edc(0x119a)][_0x505edc(0x131d)](_0x505edc(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0x92c))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0xaecc44=>{const _0x4191e5=_0x12aa56,_0x3f4bd7=_0xaecc44[_0x4191e5(0xfab)][_0x4191e5(0x58c)](_0x4191e5(0xa07));_0x3f4bd7&&_0x3f4bd7[_0x4191e5(0x119a)]['toggle']('selected');}),document[_0x12aa56(0x383)](_0x12aa56(0x7f8))[_0x12aa56(0x271)](_0x12aa56(0x173),function(_0x4d1aa8){const _0xe4164=_0x12aa56,_0xb8abae=_0x4d1aa8[_0xe4164(0xfab)]['checked'];document[_0xe4164(0x400)](_0xe4164(0x4b6))['forEach'](_0x1dc549=>{const _0x3f9f56=_0xe4164;_0x1dc549[_0x3f9f56(0x119a)][_0x3f9f56(0x8f0)](_0x3f9f56(0x35e),_0xb8abae);});}),document[_0x12aa56(0x383)]('regenerate-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x34e023),document[_0x12aa56(0x383)]('regenerate-call-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x18efd8),document[_0x12aa56(0x383)](_0x12aa56(0xf33))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x3b849a),document[_0x12aa56(0x383)](_0x12aa56(0x773))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x1b245f=_0x12aa56,_0x34a8e6=document[_0x1b245f(0x383)]('notification-sound-player'),_0x456f66=document[_0x1b245f(0x383)](_0x1b245f(0x63d))[_0x1b245f(0x1be)][_0x1b245f(0x1cb)]()||_0x39eb4d;_0x34a8e6[_0x1b245f(0xf6c)]=_0x456f66,_0x34a8e6['play']()[_0x1b245f(0xa27)](_0x3e1a8b=>alert(_0x1b245f(0xd78)));}),document[_0x12aa56(0x383)](_0x12aa56(0xfe1))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x3f0196=_0x12aa56;document[_0x3f0196(0x383)]('notification-sound-url-input')[_0x3f0196(0x1be)]='',alert(_0x3f0196(0x1180));}),document[_0x12aa56(0x383)](_0x12aa56(0x4a1))[_0x12aa56(0x271)]('click',_0xb19de2=>{const _0x11ef23=_0x12aa56,_0x366e5c=_0xb19de2[_0x11ef23(0xfab)];_0x366e5c['classList'][_0x11ef23(0x987)](_0x11ef23(0x1189))&&_0x6a249b(_0x366e5c),_0x366e5c[_0x11ef23(0x119a)]['contains']('editable-image')&&_0x5f4bc1(_0x366e5c);}),document[_0x12aa56(0x383)](_0x12aa56(0x165))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x106987),document[_0x12aa56(0x383)](_0x12aa56(0x466))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x390182=_0x12aa56;document['getElementById']('music-search-results-modal')['classList']['remove'](_0x390182(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0x165))[_0x12aa56(0x271)]('click',_0x106987),document[_0x12aa56(0x383)](_0x12aa56(0x466))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x39379a=_0x12aa56;document[_0x39379a(0x383)](_0x39379a(0x7ef))[_0x39379a(0x119a)][_0x39379a(0x131d)](_0x39379a(0x106d));}),document['getElementById'](_0x12aa56(0xa8))['addEventListener'](_0x12aa56(0x173),function(_0x4694f7){const _0xa85d0b=_0x12aa56;document['querySelectorAll'](_0xa85d0b(0x3ed))['forEach'](_0x255ff9=>{const _0x238a9a=_0xa85d0b;_0x255ff9[_0x238a9a(0x2a3)]=_0x4694f7[_0x238a9a(0xfab)][_0x238a9a(0x2a3)];});}),document['getElementById']('search-results-list')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1fc231=>{const _0x2f0582=_0x12aa56,_0x449710=_0x1fc231[_0x2f0582(0xfab)][_0x2f0582(0x58c)](_0x2f0582(0x1f6));if(_0x449710){const _0xec56d0=_0x449710['querySelector'](_0x2f0582(0x910));_0xec56d0&&(_0x1fc231[_0x2f0582(0xfab)]!==_0xec56d0&&(_0xec56d0[_0x2f0582(0x2a3)]=!_0xec56d0[_0x2f0582(0x2a3)]));}}),document[_0x12aa56(0x383)]('add-selected-music-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x4c25c9=_0x12aa56,_0x1d86f7=document['querySelectorAll']('.music-search-checkbox:checked');if(_0x1d86f7[_0x4c25c9(0xfde)]===0x0){alert(_0x4c25c9(0x8fd));return;}document[_0x4c25c9(0x383)](_0x4c25c9(0x7ef))[_0x4c25c9(0x119a)][_0x4c25c9(0x131d)](_0x4c25c9(0x106d)),await _0x296ef9(_0x4c25c9(0x4a6),_0x4c25c9(0xa99)+_0x1d86f7[_0x4c25c9(0xfde)]+'\x20首歌曲...');const _0x2c2dee=Array[_0x4c25c9(0x365)](_0x1d86f7)[_0x4c25c9(0xa79)](_0xef0a31=>JSON[_0x4c25c9(0x134)](_0xef0a31[_0x4c25c9(0x58c)](_0x4c25c9(0x1f6))[_0x4c25c9(0x118)][_0x4c25c9(0x213)]));let _0xe969f4=0x0,_0x2a0f25=[];const _0x412995=_0x2c2dee[_0x4c25c9(0xa79)](_0x59983b=>_0x132912(_0x59983b)),_0x1a0e8e=await Promise[_0x4c25c9(0x1282)](_0x412995);_0x1a0e8e[_0x4c25c9(0x19c)]((_0x2e759b,_0xf798fc)=>{const _0x2b005c=_0x4c25c9;_0x2e759b?(_0x40e606[_0x2b005c(0x91b)][_0x2b005c(0x258)](_0x2e759b),_0xe969f4++):_0x2a0f25['push'](_0x2c2dee[_0xf798fc]['name']);});_0xe969f4>0x0&&(await _0x534851(),_0x77e4e(),_0x40e606['currentIndex']===-0x1&&(_0x40e606[_0x4c25c9(0xb2c)]=_0x40e606[_0x4c25c9(0x91b)]['length']-_0xe969f4,_0x16763b()));let _0x35e873=_0x4c25c9(0x10a1)+_0xe969f4+_0x4c25c9(0x1095);_0x2a0f25[_0x4c25c9(0xfde)]>0x0&&(_0x35e873+='\x0a\x0a'+_0x2a0f25[_0x4c25c9(0xfde)]+_0x4c25c9(0x12d)+_0x2a0f25[_0x4c25c9(0xa35)](_0x4c25c9(0x1c5))),await _0x296ef9('操作结果',_0x35e873);}),document['getElementById'](_0x12aa56(0x282))['addEventListener']('click',()=>{const _0x27b8e0=_0x12aa56;document[_0x27b8e0(0x383)](_0x27b8e0(0x282))['classList'][_0x27b8e0(0x8f0)](_0x27b8e0(0x5dc));}),document[_0x12aa56(0x383)](_0x12aa56(0x165))['addEventListener'](_0x12aa56(0x5c7),_0x106987),document[_0x12aa56(0x383)](_0x12aa56(0x466))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x4515f7=_0x12aa56;document[_0x4515f7(0x383)](_0x4515f7(0x7ef))[_0x4515f7(0x119a)][_0x4515f7(0x131d)](_0x4515f7(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0x772))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x2f174f=>{const _0x4e7075=_0x12aa56,_0x5a3dc0=_0x2f174f['target'][_0x4e7075(0x58c)](_0x4e7075(0x1f6));if(_0x5a3dc0&&_0x5a3dc0[_0x4e7075(0x118)][_0x4e7075(0x213)]){const _0x5f0952=JSON[_0x4e7075(0x134)](_0x5a3dc0[_0x4e7075(0x118)][_0x4e7075(0x213)]);handleSearchResultClick(_0x5f0952);}}),document[_0x12aa56(0x383)](_0x12aa56(0x670))['addEventListener'](_0x12aa56(0x5c7),_0x5ae690),document[_0x12aa56(0x383)](_0x12aa56(0xd5c))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1d2975),document[_0x12aa56(0x383)](_0x12aa56(0xb9b))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4d5ea8),document[_0x12aa56(0x383)](_0x12aa56(0x6cc))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x3b0576),document['getElementById']('status-bar-toggle-switch')['addEventListener'](_0x12aa56(0x173),()=>{const _0x1129c4=_0x12aa56;_0x41df36['globalSettings'][_0x1129c4(0x221)]=document[_0x1129c4(0x383)](_0x1129c4(0xde9))[_0x1129c4(0x2a3)],_0x2c3e8c();}),document[_0x12aa56(0x383)](_0x12aa56(0x5da))['addEventListener'](_0x12aa56(0x5c7),_0x5ae75d),document[_0x12aa56(0x383)](_0x12aa56(0x9f3))['addEventListener'](_0x12aa56(0x5c7),()=>{const _0x8a011f=_0x12aa56;document['getElementById']('clear-posts-modal')[_0x8a011f(0x119a)]['remove']('visible');}),document[_0x12aa56(0x383)](_0x12aa56(0x384))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1876c4),document[_0x12aa56(0x383)](_0x12aa56(0x8d9))['addEventListener'](_0x12aa56(0x5c7),_0x183e4b=>{const _0x1c0693=_0x12aa56,_0x3ec8b3=_0x183e4b['target'][_0x1c0693(0x58c)](_0x1c0693(0xbd0));_0x3ec8b3&&_0x3ec8b3['classList']['toggle']('selected');}),document['getElementById']('global-bg-input')[_0x12aa56(0x271)]('change',async _0x3b8f27=>{const _0x3ba85c=_0x12aa56,_0x52ea6c=_0x3b8f27['target'][_0x3ba85c(0x1185)][0x0];if(_0x52ea6c){const _0x244b00=await new Promise(_0x4d9ea0=>{const _0x285fdf=_0x3ba85c,_0x17de26=new FileReader();_0x17de26[_0x285fdf(0xb5b)]=()=>_0x4d9ea0(_0x17de26[_0x285fdf(0xa86)]),_0x17de26[_0x285fdf(0x132a)](_0x52ea6c);});_0x41df36[_0x3ba85c(0xc0)][_0x3ba85c(0x7bb)]=_0x244b00,_0x446010();}_0x3b8f27['target'][_0x3ba85c(0x1be)]=null;}),document[_0x12aa56(0x383)](_0x12aa56(0xe99))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x560153=_0x12aa56;_0x41df36[_0x560153(0xc0)][_0x560153(0x7bb)]='',_0x446010();}),document[_0x12aa56(0x383)](_0x12aa56(0x1268))[_0x12aa56(0x271)]('click',async()=>{const _0x49881f=_0x12aa56;_0x422ebc&&(_0x41df36[_0x49881f(0xc0)][_0x49881f(0x5d0)]=_0x422ebc),_0x41df36['globalSettings'][_0x49881f(0xf2c)]=document['getElementById'](_0x49881f(0xd4d))[_0x49881f(0x1be)][_0x49881f(0x1cb)](),_0x41df36[_0x49881f(0xc0)][_0x49881f(0x11ce)]=document[_0x49881f(0x383)]('notification-sound-url-input')[_0x49881f(0x1be)][_0x49881f(0x1cb)](),_0x41df36[_0x49881f(0xc0)][_0x49881f(0x221)]=document[_0x49881f(0x383)](_0x49881f(0xde9))[_0x49881f(0x2a3)],await _0x342df8[_0x49881f(0xc0)][_0x49881f(0x9c0)](_0x41df36[_0x49881f(0xc0)]),_0x31bb8c(),_0x422ebc=null,_0x323732(),_0x15f193(_0x41df36[_0x49881f(0xc0)]['globalCss']),_0x2c3e8c(),alert(_0x49881f(0xf9f)),_0x105acd(_0x49881f(0x4a1));}),document[_0x12aa56(0x383)](_0x12aa56(0xdbf))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0xf6f88c=_0x12aa56,_0x2ec201=await _0x12e332(_0xf6f88c(0x71d),_0xf6f88c(0x731),'',_0xf6f88c(0x2fa));if(_0x2ec201&&_0x2ec201[_0xf6f88c(0x1cb)]())_0x41df36[_0xf6f88c(0xc0)][_0xf6f88c(0x7bb)]=_0x2ec201[_0xf6f88c(0x1cb)](),_0x446010();else _0x2ec201!==null&&alert(_0xf6f88c(0x1f7));}),document['getElementById']('upload-ephone-bg-url-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x4678ed=_0x12aa56,_0x2613b4=await _0x12e332(_0x4678ed(0x288),_0x4678ed(0xa9),'',_0x4678ed(0x2fa));if(_0x2613b4&&_0x2613b4[_0x4678ed(0x1cb)]())_0x422ebc=_0x2613b4[_0x4678ed(0x1cb)](),_0x446010();else _0x2613b4!==null&&alert(_0x4678ed(0x1f7));}),document[_0x12aa56(0x383)]('upload-cphone-bg-url-btn')[_0x12aa56(0x271)]('click',async()=>{const _0x10dfc6=_0x12aa56,_0x1812ab=await _0x12e332('网络图片\x20(CPhone)','请输入CPhone的背景图片URL','','url');if(_0x1812ab&&_0x1812ab[_0x10dfc6(0x1cb)]())_0x41df36['globalSettings'][_0x10dfc6(0x1120)]=_0x1812ab[_0x10dfc6(0x1cb)](),_0x446010();else _0x1812ab!==null&&alert('请输入有效的URL。');}),document[_0x12aa56(0x383)](_0x12aa56(0x1144))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x32dcb0=_0x12aa56;_0x422ebc=null,_0x41df36[_0x32dcb0(0xc0)][_0x32dcb0(0x5d0)]='',_0x446010();}),document[_0x12aa56(0x383)]('remove-cphone-bg-btn')['addEventListener']('click',()=>{const _0x29d911=_0x12aa56;_0x41df36[_0x29d911(0xc0)][_0x29d911(0x1120)]='',_0x446010();}),document[_0x12aa56(0x383)]('css-preset-select')[_0x12aa56(0x271)](_0x12aa56(0x173),_0x5471af),document[_0x12aa56(0x383)](_0x12aa56(0xb88))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x692a8e),document['getElementById'](_0x12aa56(0xe92))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x38ae1),document[_0x12aa56(0x383)]('font-preset-select')[_0x12aa56(0x271)]('change',_0x279361),document[_0x12aa56(0x383)]('save-font-preset-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1d86a1),document[_0x12aa56(0x383)](_0x12aa56(0x66d))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x665997),document[_0x12aa56(0x383)]('theme-preset-select')[_0x12aa56(0x271)](_0x12aa56(0x173),_0x344683),document[_0x12aa56(0x383)](_0x12aa56(0x104b))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x3ab5d7),document[_0x12aa56(0x383)](_0x12aa56(0x759))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x11a6de),document['getElementById'](_0x12aa56(0x1233))[_0x12aa56(0x271)]('click',_0x48dfd7),document['getElementById'](_0x12aa56(0xb52))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x64ecfc=_0x12aa56;document[_0x64ecfc(0x383)](_0x64ecfc(0x532))[_0x64ecfc(0x119a)]['remove'](_0x64ecfc(0x106d)),_0x59fe05();}),document['getElementById'](_0x12aa56(0x1174))[_0x12aa56(0x271)]('click',_0x398b7c),document[_0x12aa56(0x383)](_0x12aa56(0x5e5))[_0x12aa56(0x271)]('click',_0x1bfac5=>{const _0x3d0b8d=_0x12aa56;if(_0x1bfac5[_0x3d0b8d(0xfab)]['classList'][_0x3d0b8d(0x987)](_0x3d0b8d(0x9c1))){const _0x2129e8=parseInt(_0x1bfac5[_0x3d0b8d(0xfab)][_0x3d0b8d(0x118)]['id']);_0x1f7905(_0x2129e8);}}),document['getElementById'](_0x12aa56(0xeb5))['addEventListener']('click',_0x39d072=>{const _0x16a8a6=_0x12aa56;if(_0x39d072['target'][_0x16a8a6(0x119a)]['contains'](_0x16a8a6(0x31e))){const _0x184d18=_0x39d072[_0x16a8a6(0xfab)]['dataset'][_0x16a8a6(0xba3)],_0x54ea10=_0x184d18!==_0x16a8a6(0x1282)&&_0x184d18!==_0x16a8a6(0x1289)?parseInt(_0x184d18):_0x184d18;_0x52f4e5(_0x54ea10);}}),document[_0x12aa56(0x383)](_0x12aa56(0xdb2))['addEventListener']('change',_0x2b8bed),document[_0x12aa56(0x383)]('export-single-chat-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1e91cd),document[_0x12aa56(0x383)](_0x12aa56(0x1103))[_0x12aa56(0x271)]('click',()=>{const _0x1c27c0=_0x12aa56;document[_0x1c27c0(0x383)](_0x1c27c0(0x428))[_0x1c27c0(0x5c7)]();}),document[_0x12aa56(0x383)](_0x12aa56(0x428))[_0x12aa56(0x271)](_0x12aa56(0x173),_0x1b092a=>{const _0x2d75bd=_0x12aa56,_0x54a984=_0x1b092a[_0x2d75bd(0xfab)][_0x2d75bd(0x1185)][0x0];_0x54a984&&_0x5d6eeb(_0x54a984),_0x1b092a[_0x2d75bd(0xfab)][_0x2d75bd(0x1be)]=null;}),document[_0x12aa56(0x383)]('add-char-memo-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x48b81f()),document[_0x12aa56(0x383)](_0x12aa56(0x77a))[_0x12aa56(0x271)]('click',()=>openDiaryEditor()),document['getElementById'](_0x12aa56(0x192))['addEventListener'](_0x12aa56(0x5c7),_0x31eee9),document[_0x12aa56(0x383)]('favorite-article-btn')[_0x12aa56(0x271)]('click',_0x29fe56),document[_0x12aa56(0x383)](_0x12aa56(0xf95))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x296935),document[_0x12aa56(0x383)]('regenerate-char-qq-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x34ff56=_0x12aa56;_0x296ef9(_0x34ff56(0xfe6),'正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...');try{await Promise['all']([_0x4fd0d9(),_0x3df0e0()]),console['log'](_0x34ff56(0x477));}catch(_0x406cd9){console[_0x34ff56(0x98)](_0x34ff56(0x125a),_0x406cd9),await _0x296ef9(_0x34ff56(0xa55),_0x34ff56(0xe03)+_0x406cd9[_0x34ff56(0x5f8)]);}}),document[_0x12aa56(0x383)]('char-chat-list')[_0x12aa56(0x271)]('click',_0x506319=>{const _0x3ec335=_0x12aa56,_0x2a2b2e=_0x506319[_0x3ec335(0xfab)][_0x3ec335(0x58c)](_0x3ec335(0xfc4));if(_0x2a2b2e&&_0x2a2b2e[_0x3ec335(0x118)]['conversationIndex']){const _0x2bbda5=parseInt(_0x2a2b2e[_0x3ec335(0x118)]['conversationIndex']);!isNaN(_0x2bbda5)&&_0x1a0649(_0x2bbda5);}}),document[_0x12aa56(0x383)](_0x12aa56(0x12de))[_0x12aa56(0x271)]('click',()=>{const _0xd05b7=_0x12aa56;_0x40583e(_0xd05b7(0x811));});const _0x5170b3=document[_0x12aa56(0x383)](_0x12aa56(0x662)),_0x45cc7a=()=>{const _0x5ce43a=_0x12aa56;if(_0x1b52d4!=='private_user')return;if(_0x5170b3[_0x5ce43a(0x4f9)]<0x1&&!_0x219308){const _0x13227c=_0x41df36[_0x5ce43a(0x864)][_0x18c6a2]?.[_0x5ce43a(0xd08)][_0x5ce43a(0xfde)]||0x0;_0x13227c>_0x12646a&&_0x45c2c8();}};_0x5170b3[_0x12aa56(0x271)](_0x12aa56(0x334),_0x45cc7a),document['getElementById']('char-simulated-send-btn')[_0x12aa56(0x271)]('click',()=>{const _0x151b53=_0x12aa56;alert(_0x151b53(0x18e));}),document[_0x12aa56(0x383)]('regenerate-char-album-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x23b708),document['getElementById']('char-album-grid')['addEventListener'](_0x12aa56(0x5c7),_0x32dc9e=>{const _0x308a9a=_0x12aa56,_0xb8ae28=_0x32dc9e['target'][_0x308a9a(0x58c)]('.char-photo-item');if(_0xb8ae28&&_0xb8ae28['dataset'][_0x308a9a(0xee1)]){const _0x1667dc=_0xb8ae28[_0x308a9a(0x118)][_0x308a9a(0xee1)];_0x296ef9(_0x308a9a(0xc4a),_0x1667dc[_0x308a9a(0x709)](/\n/g,_0x308a9a(0x3ee)));}}),document['getElementById']('regenerate-char-browser-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x5348fc),document[_0x12aa56(0x383)](_0x12aa56(0x12c4))['addEventListener'](_0x12aa56(0x5c7),_0x3445e9),document[_0x12aa56(0x383)](_0x12aa56(0x11fc))['addEventListener'](_0x12aa56(0x5c7),_0x2f8872=>{const _0x19fd65=_0x12aa56,_0x51d7da=_0x2f8872['target'][_0x19fd65(0x58c)](_0x19fd65(0x1d2));if(_0x51d7da&&_0x51d7da[_0x19fd65(0x118)][_0x19fd65(0x99)]){const _0x302bd8=_0x51d7da['dataset'][_0x19fd65(0x99)];_0x296ef9('TA的想法...',_0x302bd8[_0x19fd65(0x709)](/\n/g,_0x19fd65(0x3ee)));}}),window['openCharWallet']=_0x5d8965,document[_0x12aa56(0x383)](_0x12aa56(0x34d))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x153940),document[_0x12aa56(0x383)](_0x12aa56(0x608))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x40583e(_0x12aa56(0x303))),document['getElementById']('regenerate-char-diary-btn')['addEventListener']('click',_0x11c977),document[_0x12aa56(0x383)]('add-char-diary-btn')[_0x12aa56(0x271)]('click',_0x55b7d1),document[_0x12aa56(0x383)](_0x12aa56(0x43c))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x40583e(_0x12aa56(0x46a))),document['getElementById'](_0x12aa56(0x12c2))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x52104b),document[_0x12aa56(0x383)](_0x12aa56(0xf45))['addEventListener']('click',_0x33f227),document[_0x12aa56(0x383)](_0x12aa56(0x8fa))[_0x12aa56(0x271)]('click',_0x4dddb),document['getElementById'](_0x12aa56(0x2a0))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0xafe281),document['getElementById'](_0x12aa56(0x1279))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x49d587),document[_0x12aa56(0x383)](_0x12aa56(0x1279))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x49d587),document[_0x12aa56(0x383)](_0x12aa56(0x530))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x105acd(_0x12aa56(0xab5))),document[_0x12aa56(0x383)](_0x12aa56(0x939))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x139438),document[_0x12aa56(0x383)]('douban-wait-reply-btn')[_0x12aa56(0x271)]('click',_0x259437),document['getElementById'](_0x12aa56(0x38b))[_0x12aa56(0x271)](_0x12aa56(0x173),async _0x2c897a=>{const _0x23922b=_0x12aa56,_0x5743cf=_0x2c897a[_0x23922b(0xfab)]['files'][0x0];if(_0x5743cf){const _0x572c1b=await new Promise(_0x4371cb=>{const _0x4ad689=_0x23922b,_0x16d619=new FileReader();_0x16d619[_0x4ad689(0xb5b)]=()=>_0x4371cb(_0x16d619[_0x4ad689(0xa86)]),_0x16d619['readAsDataURL'](_0x5743cf);});_0x41df36[_0x23922b(0xc0)][_0x23922b(0x1120)]=_0x572c1b,_0x446010();}}),document[_0x12aa56(0x383)](_0x12aa56(0x490))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x29c1a8=>{const _0x3a3aba=_0x12aa56;if(_0x29c1a8['target'][_0x3a3aba(0x119a)]['contains'](_0x3a3aba(0xe5))){const _0xcbfaad=_0x29c1a8['target'][_0x3a3aba(0x58c)](_0x3a3aba(0xce3)),_0x75612c=_0xcbfaad[_0x3a3aba(0x118)][_0x3a3aba(0xdf7)];_0x75612c&&_0x965993(_0x75612c,_0x3a3aba(0xa8b),_0xcbfaad);}}),document['getElementById'](_0x12aa56(0x51e))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x1c24e0=_0x12aa56;document[_0x1c24e0(0x383)]('import-appearance-input')[_0x1c24e0(0x5c7)]();}),document[_0x12aa56(0x383)](_0x12aa56(0x672))[_0x12aa56(0x271)](_0x12aa56(0x173),_0xf5243e=>{const _0x8a9408=_0x12aa56,_0x4e34ff=_0xf5243e['target'][_0x8a9408(0x1185)][0x0];_0x4e34ff&&_0x4ce840(_0x4e34ff),_0xf5243e[_0x8a9408(0xfab)]['value']=null;}),document[_0x12aa56(0x271)](_0x12aa56(0x323),()=>{const _0xe67fa4=_0x12aa56;document[_0xe67fa4(0xdc1)]===_0xe67fa4(0xccc)&&(localStorage[_0xe67fa4(0x16a)]('ephoneLastActiveTimestamp',Date[_0xe67fa4(0x108d)]()),console[_0xe67fa4(0xe72)](_0xe67fa4(0x603)));}),document[_0x12aa56(0x383)](_0x12aa56(0x115c))[_0x12aa56(0x271)]('click',_0x386bd1),document[_0x12aa56(0x383)]('import-world-book-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x1fe872=_0x12aa56;document[_0x1fe872(0x383)](_0x1fe872(0x72e))[_0x1fe872(0x5c7)]();}),document[_0x12aa56(0x383)](_0x12aa56(0x72e))[_0x12aa56(0x271)](_0x12aa56(0x173),_0x229471=>{const _0x4d3c22=_0x12aa56,_0x45f90e=_0x229471[_0x4d3c22(0xfab)][_0x4d3c22(0x1185)][0x0];_0x45f90e&&_0x50dcfd(_0x45f90e),_0x229471[_0x4d3c22(0xfab)][_0x4d3c22(0x1be)]=null;}),document['getElementById'](_0x12aa56(0xde4))[_0x12aa56(0x271)](_0x12aa56(0x173),async _0x2c0cd3=>{const _0x231d19=_0x12aa56,_0x3077ae=_0x2c0cd3[_0x231d19(0xfab)]['checked'];_0x41df36[_0x231d19(0xc0)][_0x231d19(0xb6a)]=_0x3077ae,await _0x342df8['globalSettings'][_0x231d19(0x9c0)](_0x41df36['globalSettings']);const _0x18d31b=document[_0x231d19(0x89c)](_0x231d19(0x4cd));if(_0x18d31b)switch(_0x18d31b['id']){case _0x231d19(0x862):_0x409076(_0x41df36[_0x231d19(0xfc5)]);break;case _0x231d19(0x11f7):if(document[_0x231d19(0x383)]('qzone-screen')[_0x231d19(0x119a)][_0x231d19(0x987)](_0x231d19(0xde5)))_0x476b70();if(document[_0x231d19(0x383)](_0x231d19(0xaba))[_0x231d19(0x119a)][_0x231d19(0x987)](_0x231d19(0xde5)))_0x32454e();break;case _0x231d19(0xab5):_0x1c4178();break;case'douban-post-detail-screen':_0x3f13f2(_0x5af1a3);break;case _0x231d19(0x87a):const _0x2f90fd=document[_0x231d19(0x89c)]('.char-screen.active');if(_0x2f90fd)switch(_0x2f90fd['id']){case'char-album-screen':_0x519cc9();break;case'char-taobao-screen':_0x232b41();break;case _0x231d19(0xc1d):const _0x33f59d=_0x41df36[_0x231d19(0x864)][_0x18c6a2],_0x2c59e9=_0x33f59d[_0x231d19(0x50b)]||[],_0x2b022a=_0x2c59e9[_0x231d19(0xfde)]>0x0?_0x2c59e9[_0x231d19(0xfde)]-0x1:0x0;_0x460a6f(_0x2c59e9[_0x2b022a]);break;case'char-usage-screen':_0x368866();break;case _0x231d19(0x811):_0x3d133e();break;case _0x231d19(0xcb8):const _0x291a35=document['querySelector'](_0x231d19(0xae2))?.['dataset'][_0x231d19(0x10a8)]||0x0;_0x1a0649(parseInt(_0x291a35));break;}break;}_0x296ef9(_0x231d19(0xc75),_0x231d19(0x750)+(_0x3077ae?'开启':'关闭')+'。');}),document['getElementById'](_0x12aa56(0x74b))['addEventListener']('click',_0x44bb7b),document[_0x12aa56(0x383)](_0x12aa56(0x6c6))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x5d3c45=_0x12aa56;_0x105acd(_0x5d3c45(0xe5c));}),document['getElementById'](_0x12aa56(0x4b7))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x32a18d),document[_0x12aa56(0x383)](_0x12aa56(0x1223))['addEventListener']('click',_0x22413f),document[_0x12aa56(0x383)](_0x12aa56(0xe5b))[_0x12aa56(0x271)]('click',_0x66cc38),document['getElementById']('batch-import-frames-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x5c96d6),document['querySelector'](_0x12aa56(0x9b9))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x55caaa=>{const _0x2bba98=_0x12aa56;if(_0x55caaa['target']['classList'][_0x2bba98(0x987)](_0x2bba98(0x1354))){const _0x173b20=parseInt(_0x55caaa[_0x2bba98(0xfab)][_0x2bba98(0x118)]['id']);!isNaN(_0x173b20)&&_0x26f51b(_0x173b20);}}),_0x26d941(),window[_0x12aa56(0xdd7)]=_0x2b10bc,document['getElementById']('add-preset-btn')['addEventListener'](_0x12aa56(0x5c7),async()=>{const _0x462e69=_0x12aa56,_0x3caf04=await _0x12e332(_0x462e69(0xa58),'请输入预设名称');if(_0x3caf04&&_0x3caf04['trim']()){const _0x583f7b={'id':_0x462e69(0x8f4)+Date[_0x462e69(0x108d)](),'name':_0x3caf04['trim'](),'content':[]};await _0x342df8[_0x462e69(0x32f)][_0x462e69(0xbff)](_0x583f7b),await _0x6b8f41(),_0x1aac09(_0x583f7b['id']);}}),document['getElementById'](_0x12aa56(0x1283))['addEventListener'](_0x12aa56(0x5c7),_0x1e7290),document[_0x12aa56(0x383)](_0x12aa56(0x3b0))['addEventListener'](_0x12aa56(0x5c7),()=>{const _0x35fd6d=_0x12aa56,_0x30bdd7=document['getElementById']('preset-entries-container');_0x30bdd7[_0x35fd6d(0x89c)]('p')&&(_0x30bdd7['innerHTML']='');const _0xf30d22=_0x4877fd();_0x30bdd7[_0x35fd6d(0xe91)](_0xf30d22),_0xf30d22[_0x35fd6d(0x89c)](_0x35fd6d(0x39d))[_0x35fd6d(0xede)]();}),document[_0x12aa56(0x383)](_0x12aa56(0x10fe))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x12d97b=_0x12aa56;if(!_0x4b9b36)return;const _0x390c67=await _0x342df8[_0x12d97b(0x32f)][_0x12d97b(0x1a3)](_0x4b9b36);if(!_0x390c67)return;const _0x35257e=document[_0x12d97b(0x383)](_0x12d97b(0xc4b))['value'][_0x12d97b(0x1cb)]();if(!_0x35257e){alert('预设名称不能为空！');return;}_0x390c67[_0x12d97b(0x461)]=_0x35257e,_0x390c67[_0x12d97b(0xba3)]=parseInt(document['getElementById']('preset-category-select')[_0x12d97b(0x1be)])||null;const _0x439941=document[_0x12d97b(0x383)](_0x12d97b(0x545)),_0x30e076=_0x439941['querySelectorAll']('.message-editor-block'),_0x580a2e=[];_0x30e076['forEach'](_0x27e4ef=>{const _0x3b6b82=_0x12d97b,_0x2791f4=_0x27e4ef[_0x3b6b82(0x89c)](_0x3b6b82(0x39d))['value']['trim']();_0x2791f4&&_0x580a2e[_0x3b6b82(0x258)]({'comment':_0x27e4ef[_0x3b6b82(0x89c)](_0x3b6b82(0x1148))[_0x3b6b82(0x1be)][_0x3b6b82(0x1cb)](),'keys':(_0x27e4ef[_0x3b6b82(0x89c)](_0x3b6b82(0x235))[_0x3b6b82(0x1be)]['trim']()||'')[_0x3b6b82(0x105d)](',')[_0x3b6b82(0xa79)](_0x53b46f=>_0x53b46f[_0x3b6b82(0x1cb)]())[_0x3b6b82(0x98a)](Boolean),'content':_0x2791f4,'enabled':_0x27e4ef[_0x3b6b82(0x89c)](_0x3b6b82(0x414))[_0x3b6b82(0x2a3)]});}),_0x390c67['content']=_0x580a2e,await _0x342df8[_0x12d97b(0x32f)][_0x12d97b(0x9c0)](_0x390c67),_0x4b9b36=null,_0x105acd(_0x12d97b(0x11e6)),await _0x6b8f41();}),document['getElementById'](_0x12aa56(0x11dc))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x5e8a44=_0x12aa56;document[_0x5e8a44(0x383)]('import-preset-input')[_0x5e8a44(0x5c7)]();}),document[_0x12aa56(0x383)](_0x12aa56(0x534))[_0x12aa56(0x271)](_0x12aa56(0x173),_0x1f0dfa),document[_0x12aa56(0x383)](_0x12aa56(0xce9))[_0x12aa56(0x271)]('click',_0x230007),document[_0x12aa56(0x383)](_0x12aa56(0x648))[_0x12aa56(0x271)]('click',_0x4458cf),document[_0x12aa56(0x383)](_0x12aa56(0x8dc))[_0x12aa56(0x271)]('click',()=>{const _0x290826=_0x12aa56;document['getElementById'](_0x290826(0x103c))[_0x290826(0x119a)]['remove'](_0x290826(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0xa50))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x301e01),document[_0x12aa56(0x383)](_0x12aa56(0x1151))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x399eed),document[_0x12aa56(0x383)](_0x12aa56(0x1243))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x10af3c=_0x12aa56;document[_0x10af3c(0x383)](_0x10af3c(0x103c))[_0x10af3c(0x119a)]['remove'](_0x10af3c(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0x131a))[_0x12aa56(0x271)]('click',_0x511597),document[_0x12aa56(0x383)](_0x12aa56(0x103c))['addEventListener'](_0x12aa56(0x5c7),_0x2abcc3=>{const _0x4d5ff0=_0x12aa56,_0x39bdd9=_0x2abcc3['target']['closest'](_0x4d5ff0(0xbd0));_0x39bdd9&&(_0x2abcc3['stopPropagation'](),_0x39bdd9['classList']['toggle'](_0x4d5ff0(0x35e)));}),document['getElementById'](_0x12aa56(0x103c))[_0x12aa56(0x271)]('change',_0x2c0cfd=>{const _0x153e84=_0x12aa56;if(_0x2c0cfd[_0x153e84(0xfab)]['id']===_0x153e84(0x887)){const _0x4df255=_0x2c0cfd['target']['checked'];document[_0x153e84(0x400)](_0x153e84(0x1286))[_0x153e84(0x19c)](_0x5c1ea5=>{const _0x19da1a=_0x153e84;_0x5c1ea5[_0x19da1a(0x119a)][_0x19da1a(0x8f0)](_0x19da1a(0x35e),_0x4df255);});}else{if(_0x2c0cfd[_0x153e84(0xfab)]['id']===_0x153e84(0x12da)){const _0x4991b8=_0x2c0cfd[_0x153e84(0xfab)][_0x153e84(0x2a3)];document[_0x153e84(0x400)](_0x153e84(0x856))[_0x153e84(0x19c)](_0x5b410f=>{const _0x4ce947=_0x153e84;_0x5b410f[_0x4ce947(0x119a)][_0x4ce947(0x8f0)](_0x4ce947(0x35e),_0x4991b8);});}}}),document[_0x12aa56(0x383)](_0x12aa56(0x19e))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1d279a),document[_0x12aa56(0x383)](_0x12aa56(0xa6))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4e1dd4),document[_0x12aa56(0x383)](_0x12aa56(0x106f))[_0x12aa56(0x271)]('click',_0x5acaf4),document[_0x12aa56(0x383)](_0x12aa56(0xe1))[_0x12aa56(0x271)]('click',()=>{const _0x461bc7=_0x12aa56;_0x18bbbb(_0x461bc7(0x502));}),document[_0x12aa56(0x383)]('add-npc-btn')[_0x12aa56(0x271)]('click',()=>_0x1ffa1b(null)),document[_0x12aa56(0x383)](_0x12aa56(0x35f))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x353131),document[_0x12aa56(0x383)]('cancel-npc-editor-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x3ba9ce=_0x12aa56;document[_0x3ba9ce(0x383)](_0x3ba9ce(0xf84))[_0x3ba9ce(0x119a)][_0x3ba9ce(0x131d)](_0x3ba9ce(0x106d));}),document['getElementById'](_0x12aa56(0x1374))[_0x12aa56(0x271)](_0x12aa56(0x173),_0x3c4e7d=>{const _0x77bd74=_0x12aa56,_0x21f2e5=_0x3c4e7d[_0x77bd74(0xfab)][_0x77bd74(0x1185)][0x0];if(_0x21f2e5){const _0x134238=new FileReader();_0x134238[_0x77bd74(0xb5b)]=_0x37947c=>{const _0x86eaa2=_0x77bd74;document['getElementById'](_0x86eaa2(0x690))['src']=_0x37947c[_0x86eaa2(0xfab)][_0x86eaa2(0xa86)];},_0x134238[_0x77bd74(0x132a)](_0x21f2e5);}}),document[_0x12aa56(0x383)](_0x12aa56(0x452))[_0x12aa56(0x271)]('click',_0x3c1898=>{const _0x370826=_0x12aa56;if(_0x3c1898[_0x370826(0xfab)]['id']===_0x370826(0xa83))_0x480b3a();else _0x3c1898['target']['id']===_0x370826(0xb63)&&_0x58b49b();}),_0x3e15d1(document[_0x12aa56(0x383)](_0x12aa56(0x282)),()=>{const _0x5761f3=_0x12aa56;_0x40e606[_0x5761f3(0xb2c)]>-0x1&&_0x5416aa(_0x40e606[_0x5761f3(0xb2c)]);}),document[_0x12aa56(0x383)]('douban-settings-btn')['addEventListener'](_0x12aa56(0x5c7),_0xb07250),document[_0x12aa56(0x383)](_0x12aa56(0x940))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x70c77),document['getElementById'](_0x12aa56(0x10e8))[_0x12aa56(0x271)]('click',()=>{const _0x597aa2=_0x12aa56;document['getElementById'](_0x597aa2(0x32b))[_0x597aa2(0x119a)][_0x597aa2(0x131d)](_0x597aa2(0x106d));}),document['getElementById'](_0x12aa56(0xa10))[_0x12aa56(0x271)](_0x12aa56(0xba),_0x2bd05b=>{const _0x31e391=_0x12aa56,_0x4fb48b=_0x2bd05b[_0x31e391(0xfab)][_0x31e391(0x1be)]['toLowerCase'](),_0x1d019b=document[_0x31e391(0x383)](_0x31e391(0xe76));for(const _0x3806ec of _0x1d019b[_0x31e391(0x904)]){const _0x3e8085=_0x3806ec[_0x31e391(0x138e)][_0x31e391(0x189)]();_0x3e8085[_0x31e391(0xee2)](_0x4fb48b)?_0x3806ec[_0x31e391(0x655)][_0x31e391(0x2b6)]='':_0x3806ec['style']['display']=_0x31e391(0xa70);}}),window[_0x12aa56(0x1396)]=_0x135780,document[_0x12aa56(0x383)]('werewolf-game-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x135780(_0x12aa56(0x109d))),document[_0x12aa56(0x383)](_0x12aa56(0x1ea))[_0x12aa56(0x271)]('click',()=>{const _0x274181=_0x12aa56;document[_0x274181(0x383)](_0x274181(0xd31))['classList'][_0x274181(0x131d)](_0x274181(0x106d));}),document[_0x12aa56(0x383)]('start-werewolf-game-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x208779),document[_0x12aa56(0x383)]('werewolf-role-confirm-btn')['addEventListener'](_0x12aa56(0x5c7),()=>{const _0x207bce=_0x12aa56;document['getElementById'](_0x207bce(0x5b6))[_0x207bce(0x119a)]['remove'](_0x207bce(0x106d)),_0x35fb5b();}),document[_0x12aa56(0x383)]('exit-werewolf-game-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x34d47e=_0x12aa56,_0x64c737=await _0x23a88b('退出游戏',_0x34d47e(0x45a),{'confirmButtonClass':_0x34d47e(0x51b)});_0x64c737&&(_0x22cd06[_0x34d47e(0x40d)]=![],_0x105acd(_0x22cd06[_0x34d47e(0xa65)]?_0x34d47e(0x862):_0x34d47e(0x4a1)));}),document[_0x12aa56(0x383)]('werewolf-game-over-close-btn')[_0x12aa56(0x271)]('click',()=>{const _0x36f8b1=_0x12aa56;document['getElementById']('werewolf-game-over-modal')[_0x36f8b1(0x119a)]['remove']('visible'),_0x105acd(_0x22cd06[_0x36f8b1(0xa65)]?'chat-list-screen':_0x36f8b1(0x4a1));}),document['getElementById'](_0x12aa56(0x1011))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x3bc14a=_0x12aa56;document[_0x3bc14a(0x383)]('werewolf-kill-modal')[_0x3bc14a(0x119a)][_0x3bc14a(0x131d)]('visible');}),document[_0x12aa56(0x383)]('cancel-werewolf-lobby-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x4a4f6a=_0x12aa56;document[_0x4a4f6a(0x383)](_0x4a4f6a(0xd31))[_0x4a4f6a(0x119a)]['remove'](_0x4a4f6a(0x106d));}),document[_0x12aa56(0x383)]('werewolf-retry-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0xbac3a3),document['getElementById']('manual-werewolf-summary-btn')[_0x12aa56(0x271)]('click',_0x27cee3),document[_0x12aa56(0x383)](_0x12aa56(0x161))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x576644),document[_0x12aa56(0x383)](_0x12aa56(0x417))[_0x12aa56(0x271)]('click',_0x1bb9b8),document[_0x12aa56(0x383)]('cancel-delete-world-books-btn')['addEventListener'](_0x12aa56(0x5c7),()=>{const _0x435f87=_0x12aa56;document[_0x435f87(0x383)](_0x435f87(0x309))[_0x435f87(0x119a)]['remove']('visible');}),document['getElementById'](_0x12aa56(0x1a9))[_0x12aa56(0x271)]('click',_0x5e4486),document[_0x12aa56(0x383)]('delete-world-books-modal')['addEventListener'](_0x12aa56(0x5c7),_0x16cad3=>{const _0x5e55c4=_0x12aa56,_0x42a86b=_0x16cad3['target'][_0x5e55c4(0x58c)]('.clear-posts-item');_0x42a86b&&_0x42a86b[_0x5e55c4(0x119a)][_0x5e55c4(0x8f0)](_0x5e55c4(0x35e));if(_0x16cad3[_0x5e55c4(0xfab)]['id']===_0x5e55c4(0x101)){const _0x51078d=_0x16cad3[_0x5e55c4(0xfab)][_0x5e55c4(0x2a3)];document[_0x5e55c4(0x400)](_0x5e55c4(0x9d7))[_0x5e55c4(0x19c)](_0x1fd79c=>{const _0x4f3ed9=_0x5e55c4;_0x1fd79c[_0x4f3ed9(0x119a)][_0x4f3ed9(0x8f0)](_0x4f3ed9(0x35e),_0x51078d);});}}),document[_0x12aa56(0x383)](_0x12aa56(0x22d))[_0x12aa56(0x271)](_0x12aa56(0xba),()=>{_0x59fe05(![]);}),document[_0x12aa56(0x383)](_0x12aa56(0xeb5))['addEventListener'](_0x12aa56(0x5c7),_0xf91ae8=>{const _0x3d354c=_0x12aa56;if(_0xf91ae8[_0x3d354c(0xfab)][_0x3d354c(0x119a)][_0x3d354c(0x987)](_0x3d354c(0x31e))){const _0x4781f9=_0xf91ae8['target']['dataset']['categoryId'],_0x4d8a8c=_0x4781f9!=='all'&&_0x4781f9!==_0x3d354c(0x1289)?parseInt(_0x4781f9):_0x4781f9;document[_0x3d354c(0x383)](_0x3d354c(0x22d))[_0x3d354c(0x1be)]='',_0x52f4e5(_0x4d8a8c);}});const _0x4b2dd4=document[_0x12aa56(0x383)](_0x12aa56(0x11cf));_0x4b2dd4[_0x12aa56(0x271)](_0x12aa56(0x334),()=>{const _0x407c61=_0x12aa56;if(_0x4b2dd4[_0x407c61(0x4f9)]<0x1&&!_0x6a317c){const _0x5e6dc7=_0x41df36[_0x407c61(0x864)][_0x41df36['activeChatId']]?.['history'][_0x407c61(0xfde)]||0x0;_0x5e6dc7>_0x2cf31b&&_0x28355d();}});const _0x739269=document['getElementById'](_0x12aa56(0x1098));_0x739269[_0x12aa56(0x271)](_0x12aa56(0x334),()=>{const _0x2f6a7e=_0x12aa56,{scrollTop:_0x260292,scrollHeight:_0xa920d6,clientHeight:_0x35aec3}=_0x739269;if(_0xa920d6-_0x260292<=_0x35aec3+0x32&&!_0x13b461){const _0x1c2484=_0x41df36[_0x2f6a7e(0x864)][_0x41df36[_0x2f6a7e(0xfc5)]]?.[_0x2f6a7e(0x4f8)][_0x2f6a7e(0xfde)]||0x0;_0x1c2484>_0x237e84&&_0x35ffb9();}});const _0x2af92b=document[_0x12aa56(0x89c)](_0x12aa56(0xeb0));_0x2af92b[_0x12aa56(0x271)]('scroll',()=>{const {scrollTop:_0x133ec5,scrollHeight:_0x22a4b7,clientHeight:_0xed595c}=_0x2af92b;_0x22a4b7-_0x133ec5<=_0xed595c+0x64&&!_0x6da8df&&(_0x3c5f19['length']>_0x482fde&&_0x5addec());}),document[_0x12aa56(0x383)]('read-together-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x1c881a);const _0x4097a0=document[_0x12aa56(0x383)](_0x12aa56(0x229));_0x3a5eba(_0x4097a0,_0x4097a0),document[_0x12aa56(0x383)](_0x12aa56(0x1121))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4912d1),document[_0x12aa56(0x383)](_0x12aa56(0xf58))['addEventListener'](_0x12aa56(0x5c7),_0x5f006f),document[_0x12aa56(0x383)](_0x12aa56(0x81c))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x372ee1),document[_0x12aa56(0x383)]('prev-page-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x16d9f8),document[_0x12aa56(0x383)]('book-upload-input')[_0x12aa56(0x271)](_0x12aa56(0x173),_0xbd7fe7),document[_0x12aa56(0x383)]('minimize-reading-btn')['addEventListener']('click',_0x13387),document[_0x12aa56(0x383)](_0x12aa56(0x229))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x66217c),_0x3a5eba(document[_0x12aa56(0x383)](_0x12aa56(0xcfa)),document['querySelector'](_0x12aa56(0x7ac))),document[_0x12aa56(0x383)](_0x12aa56(0xf58))[_0x12aa56(0x271)]('click',_0x5f006f),document[_0x12aa56(0x383)](_0x12aa56(0x6f6))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x3a048b=_0x12aa56;document['getElementById'](_0x3a048b(0x93b))[_0x3a048b(0x119a)][_0x3a048b(0x131d)](_0x3a048b(0x106d));}),document[_0x12aa56(0x383)](_0x12aa56(0x15e))[_0x12aa56(0x271)]('click',_0x474594),document[_0x12aa56(0x383)]('reading-library-list')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4a23de=>{const _0x337236=_0x12aa56,_0x52aa96=_0x4a23de[_0x337236(0xfab)];if(_0x52aa96['classList']['contains'](_0x337236(0x66c))){const _0x209422=parseInt(_0x52aa96[_0x337236(0x118)][_0x337236(0xcaa)]);_0x37a10a(_0x209422);}else{if(_0x52aa96[_0x337236(0x119a)][_0x337236(0x987)](_0x337236(0x9c1))){const _0x5dc587=parseInt(_0x52aa96[_0x337236(0x118)][_0x337236(0xcaa)]);_0x7c751(_0x5dc587);}}}),document[_0x12aa56(0x383)](_0x12aa56(0x272))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x2f14c3),document['getElementById'](_0x12aa56(0x1088))[_0x12aa56(0x271)](_0x12aa56(0xba),_0x13b185=>{const _0x410b2f=_0x12aa56;_0x1740f5(_0x13b185[_0x410b2f(0xfab)][_0x410b2f(0x1be)]);});const _0xb018a5=_0x126ee3(_0x38f299,0x12c);document[_0x12aa56(0x383)](_0x12aa56(0x1370))[_0x12aa56(0x271)]('scroll',_0xb018a5),document[_0x12aa56(0x383)]('api-temperature-slider')['addEventListener'](_0x12aa56(0xba),_0x426b66=>{const _0x1d1b07=_0x12aa56;document[_0x1d1b07(0x383)](_0x1d1b07(0x900))[_0x1d1b07(0x138e)]=_0x426b66[_0x1d1b07(0xfab)]['value'];});const _0x513897=document[_0x12aa56(0x383)](_0x12aa56(0x502));_0x513897[_0x12aa56(0x271)]('scroll',()=>{const {scrollTop:_0x703434,scrollHeight:_0x3220c5,clientHeight:_0x5c1def}=_0x513897;_0x3220c5-_0x703434<=_0x5c1def+0x96&&!_0x4c00a8&&_0x3c093a();}),document[_0x12aa56(0x383)](_0x12aa56(0x123b))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x27b013),document[_0x12aa56(0x383)](_0x12aa56(0xc73))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x1aa390=_0x12aa56;document[_0x1aa390(0x383)](_0x1aa390(0xf94))[_0x1aa390(0x119a)][_0x1aa390(0x131d)](_0x1aa390(0x106d)),_0x50567a(_0x34229b);}),document['getElementById'](_0x12aa56(0x10e0))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x2f55e4),document[_0x12aa56(0x383)](_0x12aa56(0x9fa))['addEventListener'](_0x12aa56(0x5c7),_0x1acf49=>{const _0x24c431=_0x12aa56;_0x1acf49[_0x24c431(0xfab)]['classList'][_0x24c431(0x987)](_0x24c431(0x9c1))&&_0x11b27a(parseInt(_0x1acf49[_0x24c431(0xfab)][_0x24c431(0x118)]['id']));}),document['getElementById']('add-product-variation-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>_0x41f537()),document['getElementById'](_0x12aa56(0x10d6))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x2f5c36=_0x12aa56;document[_0x2f5c36(0x383)]('variation-selection-modal')[_0x2f5c36(0x119a)]['remove'](_0x2f5c36(0x106d));}),document['getElementById'](_0x12aa56(0xcf6))[_0x12aa56(0x271)]('click',()=>{const _0x17d492=_0x12aa56,_0x2b2307=document[_0x17d492(0x383)](_0x17d492(0x69d));let _0x583731=parseInt(_0x2b2307['textContent']);if(_0x583731>0x1)_0x2b2307[_0x17d492(0x138e)]=_0x583731-0x1;}),document[_0x12aa56(0x383)](_0x12aa56(0x12e8))['addEventListener']('click',()=>{const _0x3f1feb=_0x12aa56,_0x3f7c95=document[_0x3f1feb(0x383)]('variation-quantity-display');_0x3f7c95[_0x3f1feb(0x138e)]=parseInt(_0x3f7c95['textContent'])+0x1;}),document[_0x12aa56(0x383)]('product-category-tabs')['addEventListener'](_0x12aa56(0x5c7),_0x2b0e1e=>{const _0x41c88d=_0x12aa56;if(_0x2b0e1e[_0x41c88d(0xfab)]['classList'][_0x41c88d(0x987)]('product-category-tab')){const _0x19233f=_0x2b0e1e['target'][_0x41c88d(0x118)]['categoryId']===_0x41c88d(0x1282)?_0x41c88d(0x1282):parseInt(_0x2b0e1e[_0x41c88d(0xfab)]['dataset'][_0x41c88d(0xba3)]);_0x624fc2(_0x19233f);}}),document[_0x12aa56(0x383)](_0x12aa56(0xe07))['addEventListener'](_0x12aa56(0x5c7),_0x55c915),document[_0x12aa56(0x383)](_0x12aa56(0x96))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x5d7677),document[_0x12aa56(0x383)]('save-shopping-settings-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x3330a7),document[_0x12aa56(0x383)](_0x12aa56(0x115d))['addEventListener'](_0x12aa56(0x5c7),()=>{const _0x36fcd2=_0x12aa56;document['getElementById'](_0x36fcd2(0x71e))['classList'][_0x36fcd2(0x131d)](_0x36fcd2(0x106d));}),document['getElementById'](_0x12aa56(0xc6c))['addEventListener']('change',_0x3bebe0=>{const _0x38b681=_0x12aa56,_0x4b60a0=_0x3bebe0[_0x38b681(0xfab)][_0x38b681(0x2a3)],_0x30e6d2=document[_0x38b681(0x400)]('#product-grid\x20.product-item');_0x30e6d2['forEach'](_0x59c6d0=>{const _0x49a4f0=_0x38b681,_0xedd577=parseInt(_0x59c6d0[_0x49a4f0(0x118)]['id']);_0x59c6d0['classList'][_0x49a4f0(0x8f0)](_0x49a4f0(0x35e),_0x4b60a0),_0x4b60a0?_0x403266[_0x49a4f0(0xbff)](_0xedd577):_0x403266[_0x49a4f0(0x971)](_0xedd577);}),document[_0x38b681(0x383)](_0x38b681(0x9bc))[_0x38b681(0x138e)]=_0x38b681(0x7a4)+_0x403266[_0x38b681(0x1240)]+')';}),document['getElementById'](_0x12aa56(0x9bc))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{const _0x199c03=_0x12aa56;if(_0x403266[_0x199c03(0x1240)]===0x0){alert(_0x199c03(0x6f8));return;}const _0x170d31=await _0x23a88b(_0x199c03(0x615),_0x199c03(0x59a)+_0x403266[_0x199c03(0x1240)]+'\x20个商品吗？此操作不可恢复。',{'confirmButtonClass':_0x199c03(0x51b)});_0x170d31&&(await _0x342df8[_0x199c03(0xd18)][_0x199c03(0x212)]([..._0x403266]),document[_0x199c03(0x383)](_0x199c03(0x138c))[_0x199c03(0x5c7)](),await _0x568766(),await _0x296ef9('成功','选中的商品已成功删除。'));}),document[_0x12aa56(0x383)]('appearance-preset-select')[_0x12aa56(0x271)](_0x12aa56(0x173),_0x35bbb7),document[_0x12aa56(0x383)](_0x12aa56(0x841))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0xc65876),document[_0x12aa56(0x383)](_0x12aa56(0x1115))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x4e6b51),document[_0x12aa56(0x383)](_0x12aa56(0x6bc))[_0x12aa56(0x271)](_0x12aa56(0x173),_0xb05867=>{const _0x163510=_0x12aa56,_0x46c2bf=document['getElementById'](_0x163510(0x9f6));_0x46c2bf[_0x163510(0x655)][_0x163510(0x2b6)]=_0xb05867[_0x163510(0xfab)][_0x163510(0x2a3)]?'block':_0x163510(0xa70);}),document[_0x12aa56(0x383)](_0x12aa56(0xe7b))[_0x12aa56(0x271)](_0x12aa56(0x5c7),function(){const _0x27f006=_0x12aa56,_0x44f00a=document[_0x27f006(0x383)](_0x27f006(0x20a));_0x44f00a[_0x27f006(0xa6b)]===_0x27f006(0x10ea)?(_0x44f00a[_0x27f006(0xa6b)]=_0x27f006(0x6af),this['textContent']='😌'):(_0x44f00a[_0x27f006(0xa6b)]=_0x27f006(0x10ea),this[_0x27f006(0x138e)]='🧐');}),document[_0x12aa56(0x383)](_0x12aa56(0x5cf))['addEventListener']('click',()=>{const _0x3d21e7=_0x12aa56;_0x257943(),document['getElementById'](_0x3d21e7(0xf7c))['style'][_0x3d21e7(0x2b6)]=_0x3d21e7(0x2aa);}),document['getElementById'](_0x12aa56(0x4b2))[_0x12aa56(0x271)](_0x12aa56(0x173),_0x1f0dbe=>{const _0x5ac6d9=_0x12aa56,_0x2ee903=document['getElementById'](_0x5ac6d9(0xae5));_0x1f0dbe[_0x5ac6d9(0xfab)][_0x5ac6d9(0x1be)]===_0x5ac6d9(0x4fe)?_0x2ee903[_0x5ac6d9(0x655)][_0x5ac6d9(0x2b6)]=_0x5ac6d9(0x27a):_0x2ee903[_0x5ac6d9(0x655)][_0x5ac6d9(0x2b6)]=_0x5ac6d9(0xa70);}),document[_0x12aa56(0x383)](_0x12aa56(0x191))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x2f27e6=_0x12aa56;document['getElementById'](_0x2f27e6(0xf7c))[_0x2f27e6(0x655)][_0x2f27e6(0x2b6)]=_0x2f27e6(0xa70);}),document[_0x12aa56(0x383)](_0x12aa56(0x138f))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x47495a=_0x12aa56;_0x403e88(),document[_0x47495a(0x383)]('novelai-settings-modal')['style']['display']=_0x47495a(0xa70),alert('NovelAI设置已保存！');}),document['getElementById'](_0x12aa56(0x106e))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x406979=_0x12aa56;confirm(_0x406979(0x120a))&&_0x3b8d28();}),document[_0x12aa56(0x383)](_0x12aa56(0x1019))['addEventListener'](_0x12aa56(0x5c7),()=>{const _0x2439da=_0x12aa56,_0x5d9acc=document['getElementById'](_0x2439da(0x20a))[_0x2439da(0x1be)][_0x2439da(0x1cb)]();if(!_0x5d9acc){alert(_0x2439da(0xedc));return;}document[_0x2439da(0x383)](_0x2439da(0xba2))['style']['display']='flex',document[_0x2439da(0x383)]('nai-test-result')['style'][_0x2439da(0x2b6)]='none',document['getElementById']('nai-test-error')[_0x2439da(0x655)]['display']=_0x2439da(0xa70);}),document['getElementById']('close-novelai-test')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x37a3ff=_0x12aa56;document[_0x37a3ff(0x383)]('novelai-test-modal')[_0x37a3ff(0x655)][_0x37a3ff(0x2b6)]='none';}),document['getElementById'](_0x12aa56(0xd4c))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x255028=_0x12aa56;document['getElementById'](_0x255028(0xba2))['style'][_0x255028(0x2b6)]=_0x255028(0xa70);}),document['getElementById'](_0x12aa56(0xef3))[_0x12aa56(0x271)](_0x12aa56(0x5c7),async()=>{await _0x17d555();}),document['getElementById']('nai-download-btn')['addEventListener'](_0x12aa56(0x5c7),()=>{const _0x4fb573=_0x12aa56,_0x2abd63=document[_0x4fb573(0x383)](_0x4fb573(0x12f5)),_0x461737=document[_0x4fb573(0xe1b)]('a');_0x461737[_0x4fb573(0x10bc)]=_0x2abd63['src'],_0x461737[_0x4fb573(0x110e)]=_0x4fb573(0x4ec)+Date[_0x4fb573(0x108d)]()+_0x4fb573(0x693),_0x461737['click']();}),document[_0x12aa56(0x383)](_0x12aa56(0xad2))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x288b34=_0x12aa56;if(!_0x41df36[_0x288b34(0xfc5)])return;const _0x3e26f1=_0x41df36[_0x288b34(0x864)][_0x41df36[_0x288b34(0xfc5)]],_0x5ae6cb=_0x3e26f1[_0x288b34(0x886)][_0x288b34(0x1236)]||{'promptSource':'system','characterPositivePrompt':'','characterNegativePrompt':''};document[_0x288b34(0x383)](_0x288b34(0xa3c))[_0x288b34(0x1be)]=_0x5ae6cb[_0x288b34(0x7ce)]||'',document[_0x288b34(0x383)]('character-nai-negative')[_0x288b34(0x1be)]=_0x5ae6cb[_0x288b34(0x557)]||'',document[_0x288b34(0x383)](_0x288b34(0x1302))[_0x288b34(0x655)][_0x288b34(0x2b6)]='flex';}),document[_0x12aa56(0x383)](_0x12aa56(0x3e2))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x3d443c=_0x12aa56;document['getElementById'](_0x3d443c(0x1302))[_0x3d443c(0x655)][_0x3d443c(0x2b6)]=_0x3d443c(0xa70);}),document['getElementById'](_0x12aa56(0xebc))['addEventListener']('click',async()=>{const _0x36ef83=_0x12aa56;if(!_0x41df36[_0x36ef83(0xfc5)])return;const _0x305dbc=_0x41df36[_0x36ef83(0x864)][_0x41df36[_0x36ef83(0xfc5)]];!_0x305dbc[_0x36ef83(0x886)][_0x36ef83(0x1236)]&&(_0x305dbc['settings'][_0x36ef83(0x1236)]={'promptSource':_0x36ef83(0xb1)}),_0x305dbc[_0x36ef83(0x886)][_0x36ef83(0x1236)][_0x36ef83(0x7ce)]=document[_0x36ef83(0x383)](_0x36ef83(0xa3c))[_0x36ef83(0x1be)][_0x36ef83(0x1cb)](),_0x305dbc['settings'][_0x36ef83(0x1236)]['characterNegativePrompt']=document[_0x36ef83(0x383)](_0x36ef83(0x46e))[_0x36ef83(0x1be)][_0x36ef83(0x1cb)](),console[_0x36ef83(0xe72)](_0x36ef83(0xa02)),console[_0x36ef83(0xe72)](_0x36ef83(0x7ca),_0x305dbc[_0x36ef83(0x886)][_0x36ef83(0x1236)][_0x36ef83(0x7ce)]),console[_0x36ef83(0xe72)](_0x36ef83(0xc7a),_0x305dbc[_0x36ef83(0x886)][_0x36ef83(0x1236)][_0x36ef83(0x557)]),console[_0x36ef83(0xe72)](_0x36ef83(0xed),_0x305dbc[_0x36ef83(0x886)][_0x36ef83(0x1236)][_0x36ef83(0x6c7)]),await _0x342df8['chats'][_0x36ef83(0x9c0)](_0x305dbc),document[_0x36ef83(0x383)](_0x36ef83(0x1302))[_0x36ef83(0x655)][_0x36ef83(0x2b6)]=_0x36ef83(0xa70),alert(_0x36ef83(0x404));}),document[_0x12aa56(0x383)](_0x12aa56(0x964))[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x154163=_0x12aa56;confirm(_0x154163(0x1137))&&(document[_0x154163(0x383)](_0x154163(0xa3c))[_0x154163(0x1be)]='',document[_0x154163(0x383)]('character-nai-negative')[_0x154163(0x1be)]='');}),document[_0x12aa56(0x383)](_0x12aa56(0x453))['addEventListener'](_0x12aa56(0x5c7),()=>{const _0x27c4ee=_0x12aa56;if(!_0x41df36[_0x27c4ee(0xfc5)])return;const _0x373bfc=_0x41df36[_0x27c4ee(0x864)][_0x41df36[_0x27c4ee(0xfc5)]],_0x39cff8=_0x373bfc['settings'][_0x27c4ee(0x1236)]||{'promptSource':'system','characterPositivePrompt':'','characterNegativePrompt':''};document[_0x27c4ee(0x383)](_0x27c4ee(0xa3c))[_0x27c4ee(0x1be)]=_0x39cff8[_0x27c4ee(0x7ce)]||'',document[_0x27c4ee(0x383)](_0x27c4ee(0x46e))[_0x27c4ee(0x1be)]=_0x39cff8[_0x27c4ee(0x557)]||'',document[_0x27c4ee(0x383)](_0x27c4ee(0x1302))[_0x27c4ee(0x655)][_0x27c4ee(0x2b6)]=_0x27c4ee(0x2aa);}),document[_0x12aa56(0x383)]('manage-frames-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x231a1d),document[_0x12aa56(0x383)](_0x12aa56(0x7e2))[_0x12aa56(0x271)](_0x12aa56(0x173),_0x3710b9),document[_0x12aa56(0x383)](_0x12aa56(0x1351))[_0x12aa56(0x271)]('click',_0x246141),document['getElementById']('delete-current-category-btn')[_0x12aa56(0x271)]('click',_0x533d77),document['getElementById']('char-wallet-back-btn')[_0x12aa56(0x271)](_0x12aa56(0x5c7),()=>{const _0x45274c=_0x12aa56;_0x40583e(_0x45274c(0x871));}),document[_0x12aa56(0x383)](_0x12aa56(0x5bb))[_0x12aa56(0x271)](_0x12aa56(0x5c7),_0x257b54=>{const _0x1d36dd=_0x12aa56,_0x25c8c4=_0x257b54['target'][_0x1d36dd(0x58c)](_0x1d36dd(0xa07));if(_0x25c8c4){const _0x828f26=_0x25c8c4[_0x1d36dd(0x89c)](_0x1d36dd(0x407));_0x828f26&&_0x257b54[_0x1d36dd(0xfab)]!==_0x828f26&&(_0x828f26[_0x1d36dd(0x2a3)]=!_0x828f26['checked']);}});const _0x2d4bca=document[_0x12aa56(0x383)](_0x12aa56(0xeb5));_0x3e15d1(_0x2d4bca,_0x3cfde2=>{const _0x514a6a=_0x12aa56,_0x46b3fe=_0x3cfde2[_0x514a6a(0xfab)][_0x514a6a(0x58c)](_0x514a6a(0xf6a));if(_0x46b3fe){_0x3cfde2[_0x514a6a(0xe94)]();const _0x816325=_0x46b3fe[_0x514a6a(0x118)][_0x514a6a(0xba3)];if(_0x816325===_0x514a6a(0x1282)){_0x296ef9('提示',_0x514a6a(0xfc0));return;}const _0x3f5838=_0x816325==='uncategorized'?'uncategorized':parseInt(_0x816325);_0x1d0617(_0x3f5838);}}),_0xd5e3db(),_0x105acd(_0x12aa56(0x4a1));}_0x14af41();});
