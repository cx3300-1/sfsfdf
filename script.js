const _0x5770af=_0x1937;(function(_0x121208,_0x3f9c4e){const _0x13f300=_0x1937,_0x8a377f=_0x121208();while(!![]){try{const _0x26b621=parseInt(_0x13f300(0x105c))/0x1*(parseInt(_0x13f300(0x49e))/0x2)+parseInt(_0x13f300(0xb07))/0x3+-parseInt(_0x13f300(0x148f))/0x4*(parseInt(_0x13f300(0xe52))/0x5)+-parseInt(_0x13f300(0xed0))/0x6+-parseInt(_0x13f300(0x840))/0x7+parseInt(_0x13f300(0xef2))/0x8*(-parseInt(_0x13f300(0x104f))/0x9)+-parseInt(_0x13f300(0x12ce))/0xa*(-parseInt(_0x13f300(0xebb))/0xb);if(_0x26b621===_0x3f9c4e)break;else _0x8a377f['push'](_0x8a377f['shift']());}catch(_0x11797b){_0x8a377f['push'](_0x8a377f['shift']());}}}(_0x4cec,0x54ee7));const translations={'zh-CN':{'save':'保存','cancel':'取消','confirm':'确定','edit':'编辑','done':'完成','add':'添加','back':'返回','next':_0x5770af(0x530),'close':'关闭','reset':'重置','upload':'上传','send':'发送','manage':'管理','share':'分享','delete':'删除','publish':'发布','refresh':'刷新','search':'搜索','remove':'移除','finish':'结束','details':'详情','settings':'设置','title':'标题','content':'内容','category':'分类','name':'名称','description':'描述','status':'状态','ok':'好的','error':'错误','success':'成功','warning':'警告','loading':_0x5770af(0x629),'processing':'处理中...','pleaseWait':_0x5770af(0x13e4),'languageChangedAlert':_0x5770af(0x521),'homeAppQQ':'QQ','homeAppWorldBook':_0x5770af(0x13b0),'homeAppAppearance':_0x5770af(0x14d6),'homeAppRenderer':_0x5770af(0x32d),'homeAppApiSettings':'设置','homeAppFont':'字体','homeAppCPhone':_0x5770af(0x3a5),'homeAppDouban':'豆瓣','homeAppPreset':'预设','homeAppTutorial':'教程','homeAppWerewolf':_0x5770af(0x461),'homeAppX':'X','chatListTitle':'消息','navMessages':'消息','navQzone':'动态','navMemories':'回忆','navFavorites':'收藏','navNpcList':_0x5770af(0xc0b),'qzoneTitle':'好友动态','qzoneActionShuoshuo':'说说','qzoneActionPost':'动态','qzoneActionAlbum':'相册','cphoneTitleSelect':'选择一部手机','cphoneAppQQ':'QQ','cphoneAppAlbum':'相册','cphoneAppBrowser':_0x5770af(0xb77),'cphoneAppTaobao':'淘宝','cphoneAppMemo':_0x5770af(0x133a),'cphoneAppDiary':'日记','cphoneAppAmap':_0x5770af(0x149e),'cphoneAppUsage':_0x5770af(0x1567),'cphoneAppMusic':_0x5770af(0x710),'cphoneAppEphone':_0x5770af(0x1f6),'cphoneAppFootprints':'足迹','cphoneAlbumTitle':'TA的相册','cphoneBrowserTitle':_0x5770af(0x1493),'cphoneTaobaoTitle':_0x5770af(0x4d1),'cphoneWalletTitle':'钱包','cphoneMemoTitle':_0x5770af(0x133a),'cphoneDiaryTitle':'日记','cphoneUsageTitle':_0x5770af(0x17e),'cphoneMusicTitle':_0x5770af(0x72a),'cphoneArticleTitle':'文章','cphoneSimulatedChatPlaceholder':_0x5770af(0x94d),'worldBookTitle':_0x5770af(0x13b0),'worldBookEditorTitle':_0x5770af(0x759),'worldBookEntryEditorTitle':_0x5770af(0xe84),'worldBookNameLabel':'书名','worldBookCategoryLabel':'分类','worldBookEntriesLabel':_0x5770af(0x10b9),'worldBookAddEntryBtn':_0x5770af(0xa6c),'worldBookNamePlaceholder':_0x5770af(0x771),'worldBookImportTitle':_0x5770af(0x11a8),'presetTitle':'预设','presetEditorTitle':_0x5770af(0x6f2),'presetNameLabel':_0x5770af(0x1088),'presetCategoryLabel':'分类','presetEntriesLabel':_0x5770af(0x10b9),'presetAddEntryBtn':_0x5770af(0xa6c),'tutorialTitle':'教程','apiSettingsTitle':_0x5770af(0x1419),'languageLabel':'语言','apiPresetManagement':'API\x20预设管理','apiPresetSelectLabel':_0x5770af(0xb37),'apiPrimarySettings':_0x5770af(0x1021),'apiProxyUrlLabel':_0x5770af(0x366),'apiKeyLabel':_0x5770af(0x183),'apiModelLabel':'模型','apiFetchModelsBtn':'拉取主模型','apiSecondarySettings':'副API设置\x20(用于总结长期记忆)','apiSecondaryProxyUrlLabel':_0x5770af(0xbfd),'apiSecondaryKeyLabel':'副密钥','apiSecondaryModelLabel':'副模型','apiFetchSecondaryModelsBtn':_0x5770af(0x9e2),'apiBgActivitySettings':_0x5770af(0x14c9),'apiEnableBgActivityLabel':_0x5770af(0x68c),'apiBgIntervalLabel':_0x5770af(0x86e),'apiBlockCooldownLabel':_0x5770af(0x34e),'apiTtsSettings':'语音消息设置\x20(Minimax\x20TTS)','apiTtsModelLabel':'语音模型\x20(Model)','apiPerformanceSettings':'性能与显示设置','apiChatListRenderWindowLabel':'聊天列表每次加载条数','apiChatRenderWindowLabel':_0x5770af(0x931),'apiImageGenSettings':'生图功能设置','apiEnableImageGenLabel':'启用AI生图功能','apiEnableNovelAILabel':_0x5770af(0x12ec),'apiNovelAIModelLabel':_0x5770af(0xf0d),'apiNovelAIKeyLabel':_0x5770af(0x55d),'apiNovelAIGenSettingsBtn':_0x5770af(0x3b7),'apiNovelAITestBtn':_0x5770af(0xc3b),'apiStorageOptimization':_0x5770af(0x1003),'apiCompressImagesBtn':_0x5770af(0x107e),'apiSaveAllBtn':'保存所有设置','apiExportDataBtn':'导出数据','apiImportDataBtn':_0x5770af(0x957),'apiCleanupDataBtn':_0x5770af(0xc21),'apiDeleteWorldBooksBtn':'删除世界书','apiAdvancedCleanupBtn':_0x5770af(0x12b1),'apiCheckAndFixDataBtn':'数据检查与修复','chatHeaderOnline':'在线','chatHeaderLongTermMemory':_0x5770af(0x1535),'chatHeaderListenTogether':_0x5770af(0x1497),'chatHeaderChatSettings':_0x5770af(0x1510),'chatSelectionCancel':'取消','chatSelectionScreenshot':_0x5770af(0xb12),'chatSelectionFavorite':'收藏','chatSelectionShare':'分享','chatSelectionSoftDelete':'删除(通知AI)','chatSelectionHardDelete':_0x5770af(0xa39),'chatReplyTo':'回复','chatInputPlaceholder':_0x5770af(0x12f2),'chatWaitForReply':_0x5770af(0xfac),'appearanceTitle':'外观设置','appearanceSaveAll':'保存所有外观设置','fontSettingsTitle':_0x5770af(0x11c4),'fontPresetManagement':_0x5770af(0xda5),'fontFileUrlLabel':'字体文件URL\x20(.ttf,\x20.otf,\x20.woff等)','fontPreviewLabel':_0x5770af(0xd01),'fontPreviewText1':_0x5770af(0x1377),'fontPreviewText2':_0x5770af(0xaed),'fontSaveAndApply':_0x5770af(0xbc4),'fontResetDefault':_0x5770af(0x25d),'rendererTitle':_0x5770af(0x1c9),'rendererEditorTitle':_0x5770af(0xfad),'rendererCreateTitle':_0x5770af(0x166),'rendererRuleName':_0x5770af(0x1043),'rendererBindScope':_0x5770af(0xf36),'rendererScopeGlobal':_0x5770af(0x9cf),'rendererRegex':'正则表达式\x20(使用g作为标志)','rendererHtmlTemplate':_0x5770af(0x5ea),'rendererEnableRule':_0x5770af(0xbac),'myAlbumTitle':'我的相册','albumPhotosTitle':_0x5770af(0xbe9),'npcEditorTitleAdd':_0x5770af(0x753),'npcEditorTitleEdit':_0x5770af(0x1570),'npcAvatarLabel':'NPC\x20头像','npcUploadAvatar':'上传头像','npcNicknameLabel':'NPC\x20昵称','npcPersonaLabel':_0x5770af(0x5f9),'npcEnableBgActivity':'启用独立后台活动','npcActionCooldown':_0x5770af(0x8eb),'npcAssociatedChars':_0x5770af(0x602)},'en':{'save':_0x5770af(0xc1a),'cancel':_0x5770af(0xb13),'confirm':'Confirm','edit':'Edit','done':_0x5770af(0x1303),'add':_0x5770af(0xba6),'back':_0x5770af(0x2ba),'next':'Next','close':'Close','reset':'Reset','upload':_0x5770af(0xd9b),'send':_0x5770af(0x1326),'manage':_0x5770af(0x12d0),'share':_0x5770af(0x11e8),'delete':_0x5770af(0xd58),'publish':_0x5770af(0xdd6),'refresh':_0x5770af(0x39f),'search':_0x5770af(0xc38),'remove':'Remove','finish':_0x5770af(0x81a),'details':_0x5770af(0x1a4),'settings':_0x5770af(0x193),'title':_0x5770af(0xa9d),'content':'Content','category':_0x5770af(0x11d8),'name':'Name','description':_0x5770af(0xaee),'status':_0x5770af(0x12f8),'ok':'OK','error':_0x5770af(0xaa0),'success':_0x5770af(0x5ef),'warning':_0x5770af(0xc58),'loading':_0x5770af(0x147a),'processing':_0x5770af(0x328),'pleaseWait':_0x5770af(0x78a),'languageChangedAlert':_0x5770af(0x47e),'homeAppQQ':'QQ','homeAppWorldBook':_0x5770af(0x8d4),'homeAppAppearance':'Appearance','homeAppRenderer':_0x5770af(0x5cc),'homeAppApiSettings':_0x5770af(0x193),'homeAppFont':_0x5770af(0xd3e),'homeAppCPhone':_0x5770af(0x3a5),'homeAppDouban':_0x5770af(0xf5c),'homeAppPreset':'Presets','homeAppTutorial':_0x5770af(0xd08),'homeAppWerewolf':_0x5770af(0x2e8),'homeAppX':'X','chatListTitle':'Messages','navMessages':_0x5770af(0x114f),'navQzone':_0x5770af(0x1089),'navMemories':_0x5770af(0xc0d),'navFavorites':_0x5770af(0xab5),'navNpcList':_0x5770af(0x958),'qzoneTitle':_0x5770af(0x1089),'qzoneActionShuoshuo':_0x5770af(0x12f8),'qzoneActionPost':'Post','qzoneActionAlbum':_0x5770af(0x87f),'cphoneTitleSelect':'Select\x20a\x20Phone','cphoneAppQQ':'QQ','cphoneAppAlbum':_0x5770af(0x87f),'cphoneAppBrowser':'Browser','cphoneAppTaobao':_0x5770af(0xdff),'cphoneAppMemo':_0x5770af(0x291),'cphoneAppDiary':'Diary','cphoneAppAmap':_0x5770af(0xfb2),'cphoneAppUsage':_0x5770af(0x5db),'cphoneAppMusic':'Music','cphoneAppEphone':_0x5770af(0x1f6),'cphoneAppFootprints':_0x5770af(0x12a3),'cphoneAlbumTitle':'Their\x20Album','cphoneBrowserTitle':'Their\x20Browser\x20History','cphoneTaobaoTitle':_0x5770af(0xde6),'cphoneWalletTitle':_0x5770af(0x896),'cphoneMemoTitle':_0x5770af(0x291),'cphoneDiaryTitle':'Diary','cphoneUsageTitle':_0x5770af(0xadb),'cphoneMusicTitle':_0x5770af(0x772),'cphoneArticleTitle':_0x5770af(0x135b),'cphoneSimulatedChatPlaceholder':_0x5770af(0xb6d),'worldBookTitle':_0x5770af(0x8d4),'worldBookEditorTitle':_0x5770af(0x11df),'worldBookEntryEditorTitle':_0x5770af(0xd28),'worldBookNameLabel':_0x5770af(0x5b9),'worldBookCategoryLabel':_0x5770af(0x11d8),'worldBookEntriesLabel':_0x5770af(0x82a),'worldBookAddEntryBtn':'[+]\x20Add\x20New\x20Entry','worldBookNamePlaceholder':_0x5770af(0xd85),'worldBookImportTitle':_0x5770af(0xbd4),'presetTitle':_0x5770af(0xa30),'presetEditorTitle':'Edit\x20Preset','presetNameLabel':_0x5770af(0x1191),'presetCategoryLabel':_0x5770af(0x11d8),'presetEntriesLabel':_0x5770af(0x82a),'presetAddEntryBtn':_0x5770af(0x7b7),'tutorialTitle':_0x5770af(0xd08),'apiSettingsTitle':_0x5770af(0x10b7),'languageLabel':_0x5770af(0xdc5),'apiPresetManagement':_0x5770af(0xe59),'apiPresetSelectLabel':'Select\x20or\x20Switch\x20Preset','apiPrimarySettings':_0x5770af(0x4f8),'apiProxyUrlLabel':_0x5770af(0xafd),'apiKeyLabel':_0x5770af(0x7e7),'apiModelLabel':_0x5770af(0x1136),'apiFetchModelsBtn':_0x5770af(0x1501),'apiSecondarySettings':'Secondary\x20API\x20Settings\x20(for\x20Summarization)','apiSecondaryProxyUrlLabel':_0x5770af(0x12c2),'apiSecondaryKeyLabel':_0x5770af(0x1200),'apiSecondaryModelLabel':_0x5770af(0xa8d),'apiFetchSecondaryModelsBtn':_0x5770af(0x1575),'apiTemperatureLabel':_0x5770af(0xfba),'apiBgActivitySettings':'Background\x20Activity\x20Settings','apiEnableBgActivityLabel':_0x5770af(0xbcf),'apiBgIntervalLabel':_0x5770af(0x93b),'apiBlockCooldownLabel':_0x5770af(0x100e),'apiTtsSettings':_0x5770af(0xdd3),'apiTtsModelLabel':'Voice\x20Model','apiPerformanceSettings':_0x5770af(0x14be),'apiChatListRenderWindowLabel':_0x5770af(0x138b),'apiChatRenderWindowLabel':'Chat\x20View\x20Initial\x20Load\x20Count','apiImageGenSettings':_0x5770af(0x11f6),'apiEnableImageGenLabel':_0x5770af(0xa44),'apiEnableNovelAILabel':_0x5770af(0xda9),'apiNovelAIModelLabel':_0x5770af(0x706),'apiNovelAIKeyLabel':'NovelAI\x20API\x20Key','apiNovelAIGenSettingsBtn':_0x5770af(0x75e),'apiNovelAITestBtn':_0x5770af(0x10e0),'apiStorageOptimization':_0x5770af(0x327),'apiCompressImagesBtn':_0x5770af(0x11af),'apiSaveAllBtn':_0x5770af(0x566),'apiExportDataBtn':_0x5770af(0xf86),'apiImportDataBtn':'Import\x20Backup\x20File','apiCleanupDataBtn':_0x5770af(0x773),'apiDeleteWorldBooksBtn':_0x5770af(0x887),'apiAdvancedCleanupBtn':_0x5770af(0x1471),'apiCheckAndFixDataBtn':_0x5770af(0x2ce),'chatHeaderOnline':_0x5770af(0x846),'chatHeaderLongTermMemory':_0x5770af(0x1404),'chatHeaderListenTogether':_0x5770af(0x1527),'chatHeaderChatSettings':_0x5770af(0xc94),'chatSelectionCancel':_0x5770af(0xb13),'chatSelectionScreenshot':_0x5770af(0x398),'chatSelectionFavorite':'Favorite','chatSelectionShare':_0x5770af(0x11e8),'chatSelectionSoftDelete':_0x5770af(0x12fe),'chatSelectionHardDelete':_0x5770af(0x108c),'chatReplyTo':_0x5770af(0x112a),'chatInputPlaceholder':_0x5770af(0x25f),'chatWaitForReply':'Wait\x20for\x20Reply','appearanceTitle':_0x5770af(0xb93),'appearanceSaveAll':_0x5770af(0x14b3),'fontSettingsTitle':_0x5770af(0x2a5),'fontPresetManagement':_0x5770af(0x49d),'fontFileUrlLabel':'Font\x20File\x20URL\x20(.ttf,\x20.otf,\x20.woff,\x20etc.)','fontPreviewLabel':_0x5770af(0xb2b),'fontPreviewText1':_0x5770af(0x10ee),'fontPreviewText2':_0x5770af(0x922),'fontSaveAndApply':_0x5770af(0x14a2),'fontResetDefault':_0x5770af(0x13cd),'rendererTitle':_0x5770af(0xefa),'rendererEditorTitle':_0x5770af(0x2c7),'rendererCreateTitle':_0x5770af(0xd49),'rendererRuleName':'Rule\x20Name','rendererBindScope':_0x5770af(0x13b2),'rendererScopeGlobal':'Global\x20(All\x20Characters)','rendererRegex':'Regular\x20Expression\x20(use\x20g\x20flag)','rendererHtmlTemplate':_0x5770af(0x1218),'rendererEnableRule':'Enable\x20Rule','myAlbumTitle':_0x5770af(0x755),'albumPhotosTitle':_0x5770af(0x419),'npcEditorTitleAdd':_0x5770af(0x855),'npcEditorTitleEdit':'Edit\x20NPC','npcAvatarLabel':_0x5770af(0x1d5),'npcUploadAvatar':_0x5770af(0xd2c),'npcNicknameLabel':_0x5770af(0x7b8),'npcPersonaLabel':_0x5770af(0xf81),'npcEnableBgActivity':_0x5770af(0xb35),'npcActionCooldown':'Independent\x20Action\x20Cooldown\x20(min)','npcAssociatedChars':'Associated\x20Characters\x20(NPC\x20will\x20comment\x20on\x20their\x20moments)'}};let currentLanguage='zh-CN';function setLanguage(_0x4ec4ca){const _0x760343=_0x5770af;!translations[_0x4ec4ca]&&(console[_0x760343(0x664)](_0x760343(0x297)+_0x4ec4ca+_0x760343(0x1266)),_0x4ec4ca=_0x760343(0x1054)),currentLanguage=_0x4ec4ca,localStorage[_0x760343(0x1048)](_0x760343(0xd80),_0x4ec4ca),document[_0x760343(0x1440)]['lang']=_0x4ec4ca,document[_0x760343(0x5d6)](_0x760343(0x1172))[_0x760343(0xf99)](_0x37e038=>{const _0x3da89b=_0x760343,_0x201c29=_0x37e038[_0x3da89b(0xfd6)](_0x3da89b(0xb5d));translations[_0x4ec4ca][_0x201c29]&&(_0x37e038[_0x3da89b(0x15f)]=translations[_0x4ec4ca][_0x201c29]);}),document[_0x760343(0x5d6)](_0x760343(0x5be))[_0x760343(0xf99)](_0x4f3fc2=>{const _0x57ea99=_0x760343,_0x30227c=_0x4f3fc2[_0x57ea99(0xfd6)](_0x57ea99(0xbbc));translations[_0x4ec4ca][_0x30227c]&&(_0x4f3fc2[_0x57ea99(0xa0a)]=translations[_0x4ec4ca][_0x30227c]);}),document['querySelectorAll']('[data-lang-key-title]')[_0x760343(0xf99)](_0x1a67b9=>{const _0x4dc8c5=_0x760343,_0x326b0a=_0x1a67b9[_0x4dc8c5(0xfd6)](_0x4dc8c5(0x665));translations[_0x4ec4ca][_0x326b0a]&&(_0x1a67b9['title']=translations[_0x4ec4ca][_0x326b0a]);});}function initLanguage(){const _0x51d5df=_0x5770af,_0x4ccd1f=localStorage[_0x51d5df(0x11c3)](_0x51d5df(0xd80))||_0x51d5df(0x1054),_0x2a0ed5=document[_0x51d5df(0x2ec)](_0x51d5df(0xac3));_0x2a0ed5&&(_0x2a0ed5['value']=_0x4ccd1f,_0x2a0ed5[_0x51d5df(0xf79)]('change',_0x5ba1e8=>{const _0x10c94f=_0x51d5df,_0xb2b16b=_0x5ba1e8['target'][_0x10c94f(0x11a4)];alert(translations[_0xb2b16b][_0x10c94f(0x69d)]),localStorage[_0x10c94f(0x1048)](_0x10c94f(0xd80),_0xb2b16b),setTimeout(()=>window[_0x10c94f(0x6f0)][_0x10c94f(0x7e3)](),0x64);})),setLanguage(_0x4ccd1f);}(function(){'use strict';const _0x5ae8f0=_0x5770af;function _0x4f0616(_0x326ac5,_0x2cd46f){const _0x4fdbd2=_0x1937;try{const _0x3933ba=document[_0x4fdbd2(0x14ae)]('a');_0x3933ba[_0x4fdbd2(0xe15)]=_0x326ac5,_0x3933ba[_0x4fdbd2(0x3eb)]=_0x2cd46f,_0x3933ba[_0x4fdbd2(0x589)][_0x4fdbd2(0x701)]=_0x4fdbd2(0x5b1),document[_0x4fdbd2(0x140d)][_0x4fdbd2(0x998)](_0x3933ba),_0x3933ba[_0x4fdbd2(0x1177)](),setTimeout(()=>{const _0x1dc882=_0x4fdbd2;document[_0x1dc882(0x140d)][_0x1dc882(0xd17)](_0x3933ba);},0x64),console[_0x4fdbd2(0x415)]('✅\x20[NAI下载]\x20开始下载图片:',_0x2cd46f),_0x48d169();}catch(_0x172135){console[_0x4fdbd2(0x1518)](_0x4fdbd2(0x335),_0x172135),_0x48d169(_0x4fdbd2(0x1369),_0x4fdbd2(0x1518));}}function _0x48d169(_0x76c38b=_0x5ae8f0(0x5b5),_0xa60e2f=_0x5ae8f0(0x249)){const _0x4d01d3=_0x5ae8f0,_0x275c44=document['createElement']('div');_0x275c44[_0x4d01d3(0x15f)]=_0x76c38b,_0x275c44['style'][_0x4d01d3(0x57a)]=_0x4d01d3(0xbb9)+(_0xa60e2f===_0x4d01d3(0x249)?_0x4d01d3(0x120c):_0x4d01d3(0x12cc))+_0x4d01d3(0x322),document[_0x4d01d3(0x140d)][_0x4d01d3(0x998)](_0x275c44),setTimeout(()=>{const _0x2ac738=_0x4d01d3;_0x275c44[_0x2ac738(0x589)]['opacity']='1',_0x275c44[_0x2ac738(0x589)][_0x2ac738(0x1244)]=_0x2ac738(0x12f9);},0xa),setTimeout(()=>{const _0x566f05=_0x4d01d3;_0x275c44[_0x566f05(0x589)][_0x566f05(0xb92)]='0',_0x275c44[_0x566f05(0x589)][_0x566f05(0x1244)]=_0x566f05(0x21d),setTimeout(()=>{_0x275c44['remove']();},0x12c);},0x7d0);}function _0x5323bf(_0x46551c){const _0x4ad9c5=_0x5ae8f0,_0x3c5ebe=_0x46551c[_0x4ad9c5(0xfd6)](_0x4ad9c5(0x141e))||_0x46551c['getAttribute']('alt')||'';let _0x4f172e=_0x3c5ebe[_0x4ad9c5(0x13ed)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')[_0x4ad9c5(0x13ed)](/\s+/g,'_')['substring'](0x0,0x1e);!_0x4f172e&&(_0x4f172e=_0x4ad9c5(0x6d2));const _0x3e38fc=new Date()[_0x4ad9c5(0xaf8)]()[_0x4ad9c5(0x13ed)](/[-:]/g,'')['replace']('T','_')['split']('.')[0x0];return _0x4f172e+'_'+_0x3e38fc+_0x4ad9c5(0xbb2);}function _0x7e3e(_0x1a18df){const _0xace8a7=_0x5ae8f0,_0x174d0a=_0x1a18df[_0xace8a7(0x589)][_0xace8a7(0x1244)]||'',_0x35f45f=_0x1a18df[_0xace8a7(0x589)][_0xace8a7(0x89c)]||'';_0x1a18df[_0xace8a7(0x589)][_0xace8a7(0x89c)]=_0xace8a7(0x12ad),_0x1a18df[_0xace8a7(0x589)][_0xace8a7(0x1244)]=_0xace8a7(0x23c),setTimeout(()=>{const _0xe8c58c=_0xace8a7;_0x1a18df[_0xe8c58c(0x589)]['transform']=_0x174d0a,setTimeout(()=>{_0x1a18df['style']['transition']=_0x35f45f;},0x96);},0x96);}let _0x2002aa=0x0,_0x53cc08=null,_0x5ca242=null;document[_0x5ae8f0(0xf79)](_0x5ae8f0(0x1177),function(_0x3a01e5){const _0x40e088=_0x5ae8f0,_0x3d55df=_0x3a01e5[_0x40e088(0x1104)];if(_0x3d55df[_0x40e088(0xdf4)]===_0x40e088(0x23e)&&(_0x3d55df[_0x40e088(0xff6)][_0x40e088(0xe9a)](_0x40e088(0x17b))||_0x3d55df[_0x40e088(0xff6)][_0x40e088(0xe9a)](_0x40e088(0x143b)))){_0x3d55df===_0x5ca242?_0x2002aa++:(_0x2002aa=0x1,_0x5ca242=_0x3d55df);_0x53cc08&&clearTimeout(_0x53cc08);if(_0x2002aa===0x3){_0x2002aa=0x0,_0x5ca242=null,_0x3a01e5[_0x40e088(0x10bd)](),_0x3a01e5['stopPropagation'](),console[_0x40e088(0x415)](_0x40e088(0x10c6)),_0x7e3e(_0x3d55df);const _0x1975ed=_0x3d55df[_0x40e088(0xce4)];if(!_0x1975ed||_0x1975ed===_0x40e088(0x775)){console[_0x40e088(0x664)](_0x40e088(0x8a0)),_0x48d169(_0x40e088(0xff7),_0x40e088(0x1518));return;}const _0x209332=_0x5323bf(_0x3d55df);_0x4f0616(_0x1975ed,_0x209332);}else _0x53cc08=setTimeout(()=>{_0x2002aa=0x0,_0x5ca242=null;},0x1f4);}},!![]),console['log'](_0x5ae8f0(0x133b)),console[_0x5ae8f0(0x415)](_0x5ae8f0(0x154c));}());'serviceWorker'in navigator&&window['addEventListener']('load',()=>{const _0x3625a4=_0x5770af;navigator[_0x3625a4(0x547)][_0x3625a4(0x13d4)](_0x3625a4(0x14bf))[_0x3625a4(0x333)](_0x29941a=>{const _0x53b1af=_0x3625a4;console[_0x53b1af(0x415)](_0x53b1af(0xc16),_0x29941a['scope']);})[_0x3625a4(0xd6b)](_0x4c27b9=>{const _0x54ac48=_0x3625a4;console[_0x54ac48(0x415)]('ServiceWorker\x20注册失败:\x20',_0x4c27b9);});});!Array[_0x5770af(0x2df)]['findLastIndex']&&Object[_0x5770af(0x95f)](Array[_0x5770af(0x2df)],'findLastIndex',{'value':function(_0x3919ee){const _0x464848=_0x5770af;if(this==null)throw new TypeError(_0x464848(0x129f));if(typeof _0x3919ee!==_0x464848(0x499))throw new TypeError(_0x464848(0xce6));let _0x4e6dde=Object(this),_0x36162f=_0x4e6dde[_0x464848(0x9a1)]>>>0x0,_0x33428b=arguments[0x1],_0x5908ad=_0x36162f-0x1;while(_0x5908ad>=0x0){let _0x10845a=_0x4e6dde[_0x5908ad];if(_0x3919ee[_0x464848(0x3bc)](_0x33428b,_0x10845a,_0x5908ad,_0x4e6dde))return _0x5908ad;_0x5908ad--;}return-0x1;},'configurable':!![],'writable':!![]});let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],lastPrivateMessagesSent=[],currentQzoneReplyContext=null,editingNpcId=null,pendingBackupData=null;function _0x1937(_0x2fdad,_0x215624){const _0x4cece4=_0x4cec();return _0x1937=function(_0x193742,_0x497baf){_0x193742=_0x193742-0x15f;let _0x1f5d4c=_0x4cece4[_0x193742];return _0x1f5d4c;},_0x1937(_0x2fdad,_0x215624);}function _0x4cec(){const _0x2b0bcc=['input[name=\x22theme-select\x22]:checked','group-avatar-preview','close-group-manager-btn','世界书','ZIP解压失败:','Binding\x20Scope','点击处理','\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a','请先选择要添加的歌曲。','为NPC\x20\x22','claimedBy','checked','worldBooks','还没有任何评论，无法等待回复。','preset-tabs','message','.participant-avatar-wrapper\x20.participant-avatar','，我的看法是...\x20我【必须】回应...\x0a3.\x20\x20**S\x20(Social\x20-\x20社交表演)**:\x20我要如何用我的【人设】和【社交关系】来包装我的发言？\x0a\x20\x20\x20\x20-\x20(例如：我的好友\x20','cancel-message-action-btn','parts','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','\x0a\x0a现在，请开始生成这组足迹记录。','来自“','.chat-group-header','没有可供重新生成的AI响应。','close-shared-history-viewer-btn','rp-direct-total','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>','送给了大家一份礼物','generate','linkedMemoryCount','music-next-btn','Reset\x20to\x20Default\x20Font','each','preview-font-style','这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？','from','readingLibrary','#avatar-frame-modal\x20.modal-body','register','[data-version]','导出已开始','\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','gridEl','avatarFrame','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','生成豆瓣帖子失败:','\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>','https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','var(--text-primary)','修改文字','frameUrl',',\x20内容摘要:\x20“','https://api.vkeys.cn/v2/music/netease/lyric?id=','请稍候...','.red-packet-card','游戏尚未结束，无法进行总结。','\x20元，订单时间戳为\x20','recordId','\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22','这是你们最近的对话：\x0a','customName','secondary-api-key','replace','frame_5','\x27\x20在你的动态(ID:\x20','\x22\x20触发了后台行动！','\x20的聊天','AI决策','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','以外的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a','”\x20的详细角色信息。','novelai-model','block','无法找到当前角色的数据。','ai-original-name-input','qzone','创建新聊天\x20(第1/2步)','确认精炼记忆？',')，并在对话中自然地体现出来。','my-frame-content','NEGATIVE_INFINITY','simulatedConversations','检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。','close-npc-group-manager-btn','文章标题','Long-term\x20Memory','，礼物是：','\x20觉得很赞</span></div>','.nai-gallery-item[data-key=\x22','[系统提示：五子棋游戏已结束。最终结果是：','[图片]\x20','album-screen','生成模拟浏览器历史失败:','**内容:**\x0a','body','world-book-content-container','single-char-background-activity-group','isFullyClaimed','https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','member-persona-input','正在为后台活动发送API请求\x20(\x22','外观预设已保存！','\x22\x20中发现并修复了旧红包数据。','\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20','从缓存播放\x20TTS\x20音频...','data','API\x20设置','AI\x20(群聊后台)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20的头像框到群聊\x20\x22','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','title','检查更新时出错:','apiKey','album-back-btn','对方已拒收','isGroup','remove','，人设:\x20','</option>','/v1/chat/completions',')\x20为\x20','”中，用户的昵称是“','》的歌词已成功保存！','公告已发布！','\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','**[讨论环节]**\x0a','”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20','accept_transfer','toLowerCase','icon-setting-item','删除分组后，该组内的所有NPC将变为“未分组”。确定要删除吗？','hasOwnProperty','tEXt','clear-chat-btn','导入\x20Tavern\x20AI\x20世界书','\x22\x20value=\x22','save-css-preset-btn','正在等待AI角色们对你的发言做出回应...','<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20','naiimag-image','https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','lastFailedAction','documentElement','请你投票。',')。操作已被拦截。','》吗？','paste','讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','application/json','regenerate-btn','isOfflineMode','\x22\x20触发专属决策流程...','chat-settings-modal','translateY(0px)','offsetWidth','swiped','cancel-douban-cast-btn','><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>','analysis','lyrics-vertical-pos','歌曲信息','.custom-multiselect\x20.select-box','repost-comment-input','#preset-content-container\x20.world-book-category-pane','\x20的日记','caller-name','请输入书名','import-preview-list',')\x20已被用户忽略或为旧版本，无需显示。','用户(','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','ai-avatar-library-modal','。等待对方处理。]','来自与\x20','已成功批量导入\x20','call-message-actions-modal','unblock-btn','正在扫描和修复数据...','https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','musicLibrary','chat-list-item','characterPositivePrompt','\x20(时长:\x20','(暂无评论)','backgroundActivityInterval','导演/编辑模式保存(Sticker):\x20使用了\x20meaning\x20查找','isRefund','chat-input','请根据你的设定，生成你的淘宝购买记录和余额。','批量删除NAI图片时出错:','确定要删除这条长期记忆吗？','Advanced\x20Data\x20Cleanup','.frame-item.selected','”\x20的位置已发送到你们的聊天中。','toCollection','douban-settings-modal','appUsageLog','sticker-upload-input',')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]','qzoneGroups','Loading...','继续讨论','nai-cfg-scale','variation-select','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','add-to-cart-btn','\x20位群成员生成并注入了个性化记忆！','openRenderingRulesScreen','toBlob','-\x20**姓名**:\x20',')。详情:\x20','&nbsp;','所有狼人已被放逐，好人阵营获得了胜利！','该条记录已成功删除。','meaning','send-poll-btn','\x0a##\x20来自《','\x0a\x0a现在，请生成新的评论。','dismissedUpdateVersion',']\x20[最近对话:\x20','你正在阅读的段落','16476PhSURz','\x20被刀了\x20(你没有解药了)','sender','children','TA的浏览器历史','https://files.catbox.moe/q6z5fc.jpeg','\x20发起了外卖代付请求，商品是“','📊\x20使用模型:','一起听','15px','AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。','anime\x20person','https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22','visible','高德地图','请输入备忘录内容','announcement-board-modal','AI已将新头像命名为：“','Save\x20and\x20Apply','从角色卡导入\x20(.json/.png)','正在请求“','<span>删除</span>','\x20更换了你的头像]','lyrics-position-group','group_call_summary','import-appearance-btn','for_timestamp','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【【【长度铁律】】】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**','createWriteStream','createElement','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>','[系统提示：你拒绝并退还了“','\x20\x20\x20[-]\x20最终负面提示词:','call_summary','Save\x20All\x20Appearance\x20Settings','image-mode-content','toArray','<div\x20class=\x22poll-options-list\x22>','chat-group-container','fontSize','正在呼叫所有成员...','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20','regenerate-douban-btn','\x22,\x20\x22postId\x22:\x20456,\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','Performance\x20&\x20Display\x20Settings','./sw.js','约定达成！','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>','MB)\x20单独超过了切片限制。','头像和人设不能都为空哦！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','reset-custom-css-btn','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20','创建新相册','toggle','后台活动设置','\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a','清空动态时出错:','\x22\x20class=\x22avatar\x22>','群聊通话中没有找到可作为总结主体的AI角色。','cancel-clear-wizard-btn-step2','.realimag-image','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','frame_7','sticker-category-manager-modal','无法自动播放静音音频（这在iOS首次加载时是正常现象）:','add-preset-entry-btn','rendering-rules-screen','外观设置','\x22\x20中的成员信息更新',')\x20刚刚领取了红包\x20(时间戳:\x20','所有图片已准备就绪，正在流式压缩...\x20下载将自动开始。',')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】(','long-term-memory-screen','char-home-screen','请先选择要下载的图片。','后台活动模拟已启动，间隔:\x20','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','使用解药救TA','\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“','share-link-modal','正在等待AI角色们继续讨论...','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','猎人带走了\x20','lucky','simulatedTaobaoHistory','lastActionTimestamp','<div></div><div></div><div></div><div></div><div></div>','share-target-list','\x22:\x20\x22你此时的详细内心活动...\x22}}`**\x0a\x20\x20\x20\x20-\x20\x20\x20**analysis**:\x20简要分析用户的意图或聊天的氛围。\x0a\x20\x20\x20\x20-\x20\x20\x20**strategy**:\x20你的计划（例如：安抚用户、转移话题、发起一个功能）。\x0a\x20\x20\x20\x20-\x20\x20\x20**character_thoughts**:\x20必须包含一个以你本名\x20(\x22','border','offline-mode-group','网易云音乐搜索失败:','\x22:\x20[\x0a','cancel-product-editor-btn','npc-editor-title','sticker','在这里输入说说的内容...','locationName','旁观模式AI发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','widgetData','群聊内转账','isBusy','message-editor-block\x20variation-block','mes_example','delete-css-preset-btn','dragging','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','commentText','#f9f9f9','Fetch\x20Primary\x20Models','申请失败','\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。','presets','poisonedId','qzoneSettings','跳过一个无效的JSON片段:','一个普通玩家','</p><p>','beginPath','ai-frame-grid','member-avatar-preview','head','*对方按下了接听键...*','rule-chat-id-select','聊天设置','var-','clientHeight','post-image-description','import-options-modal','API\x20请求失败:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','\x22\x20(由\x20','error','utf-16be','-\x20(记录于\x20','错误:\x20','严重警告！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','！请对此事件发表评论。]','表情含义','bulkDelete','\x27\x20style=\x22color:\x20#6a329f;\x20border-color:\x20#6a329f;\x22>NAI生图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','请填写有效的商品信息和金额！','open-memory-screen-btn','rules-tabs','back-to-clear-step1-btn','Listen\x20Together','myPersona','regenerate-char-album-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x0a#\x20你的角色设定：\x0a你必须严格遵守','dark-mode','cphoneWallpaper','charId','\x20为\x20','char-browser-article-screen','确定要删除这条公告吗？此操作不可恢复。','bg-clear','novelai-settings','product-description-input','长期记忆','rule-enabled-switch','apiConfig','请输入新的内容：','”说的申请理由：','\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务铁律\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【至关重要】**:\x20当你发现“最近的动态列表”中，有你【感兴趣且还未互动过】的动态时，你**应该优先考虑**使用\x20\x27qzone_comment\x27\x20或\x20\x27qzone_like\x27\x20指令去进行互动，这比你自己发一条新动态更符合社交礼仪。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27[{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]\x27\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','char-usage-list','📸\x20NovelAI图片生成开始，AI提供的prompt:','longTermMemory','并评论说：“','(未设置)','groupId','.variation-block','realimag','收藏成功！','\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22','商店空空如也，点击“管理”添加商品吧！','hasListener','”的参考记忆','https://i.postimg.cc/d0WCKxff/IMG-6932.gif','表情包','💡\x20[NAI下载]\x20提示：三击任意NAI图片即可下载','送给大家的礼物','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','qzone_delete_post','save-rule-btn','add-char-memo-btn','轮到你发言了...','countdown-card','https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','select-all-types-for-clear','persona-library-modal','删除成功','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x20个自定义头像框吗？','npc-list-view','复制成功','https://i.postimg.cc/qB9zbKs9/20.jpg','flat','API配置','confirm-create-post-btn','未找到\x20postID:\x20','resume','\x20获胜。也就是说，','\x22\x20被唤醒，准备独立行动...','diary','repost-confirm-btn','memory-card','App记录','\x20\x0a#\x20社交圈与动态\x0a','\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20','这将把您选择的数据【添加并覆盖】到现有数据中。同ID的数据将被更新，新数据将被添加。<br><br><strong>此操作不可撤销！</strong>','chat-messages','请输入新的图片URL：','npc-avatar-input','错误：找不到该成员的个人档案。','.cart-item-checkbox[data-id=\x22','编辑\x20NPC','.message-wrapper','.search-result-item','置顶聊天','stickerCategoryId','Fetch\x20Secondary\x20Models','播放被中断，这是正常行为:',')，此功能暂不支持。','isClick','\x20\x20\x20\x20\x20\x20-\x20','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','https://api.vkeys.cn/v2/music/tencent?word=','startX','duration','确定要删除头像框\x20“','douban-post-detail-title','proxy-url','textContent','正在全网搜索歌曲资源...','处理NPC后台活动时出错:','你们没有在读书。','后台活动模拟已自动启动。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥','confirm-selective-import-btn','创建新规则','.frame-item','处理通话请求时API出错:','repostComment','[你发送了一张需要AI识别的图片，图片内容是：\x27','https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg','data:\x20','time-perception-toggle','未知错误','https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','doubanMaxPosts','确认导入','fill','manage-group-avatar-library-btn','conversationIndex','openPresetScreen','确定要删除相册《','https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','#fullscreen-lyrics-container\x20.music-lyrics-list','quantity','realimag-image','uncategorized','poisonUsed','App使用记录','<span\x20style=\x22color:\x20red;\x22>未运行</span>','【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！','select-all-music-search','无法解析预设文件。\x0a错误:\x20','密钥\x20(API\x20Key)','Enter','input[name=\x22visibility_group\x22]:checked','final','openCharWallet','诊断：在顶层\x20','删除歌曲','.favorite-item-card.selected','元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','revokeObjectURL','gift-recipient-modal','\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22','https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','达到自动总结阈值\x20(','chat-at-mention-popup','Settings','message-bubble\x20','\x22的角色（你的本名是\x22','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22','AI已接收并理解了该图片的内容。','.photo-delete-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','nickname','元,\x20备注:\x20',')\x20内容:\x20\x22','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>','狼人杀\x20-\x20','member','请选择今晚的目标。','NPC\x20列表','nai-custom-proxy-group','https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','Details','✅\x20找到\x20final\x20事件的图片数据','levelchange','totalElapsedTime','复制失败:','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','#chat-list-bottom-nav\x20.nav-item','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20你的核心任务\x0a你正在扮演角色“','reset-button-order-btn','检测到新版流式备份文件...','novelai-settings-modal','...，所以我决定这样说...)\x0a\x0a####\x20阶段\x20C：最终发言稿\x20(草稿)\x0a(结合T,\x20G,\x20S的思考，我准备这样说：...)\x0a---\x0a','select-all-stickers-checkbox','保存书籍(ID:\x20','成功将群聊\x20\x22','生成图像','\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','rule-editor-title','selection-favorite-btn','\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**','https://i.postimg.cc/FzqHTBng/IMG-7093.gif','https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','frame_9','transfer-actions-modal','antidoteUsed','sticker-binding-chat-list','\x20拍了拍\x20“','现在开始讨论，请各位玩家依次发言。','诊断：在\x20data.extensions.character_book\x20中找到世界书。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','AI返回的数据不是一个数组。原始返回:\x20','”\x20已被删除。','guardedId','渲染规则','选择精炼范围','\x22,\x20\x22content\x22:\x20[\x22第一条私信\x22,\x20\x22第二条...\x22,\x20\x22最后一条。\x22]}`\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20表情使用指南\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','\x20位角色生成豆瓣动态...','scrollHeight','#clear-posts-list\x20.clear-posts-item.selected','\x20.message-bubble.ai\x20$1','local-song-upload-input','delete-group-btn','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a','NPC\x20Avatar','douban-send-comment-btn','https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','\x0a---\x0a','EPhoneSingleChat','shoppingCategoryCount','当作\x20ZIP\x20文件处理...','用户向你发送了一张图片','保存成功','loading','切换听歌对象','test','\x0a-\x20','messages-view',']\x20(ID:\x20','hasShown10','preset-action-edit','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg','#\x20场景设定\x0a','status_msg','customAvatarFrames','生成失败',')\x20拒绝了\x20','handleWidgetImageChange','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>','enableTts','\x0a#\x20你的任务\x0a你是一个狼人杀游戏模拟器\x20(Game\x20Simulator)。你的任务是【并行模拟】','removeEventListener','\x0a###\x20正在模拟\x20','从CPhone推进真实对话失败:','showStatusBar','我们和好吧！','shopping-category-count-input','Ephone','cancel-npc-editor-btn','killedId','sticker-item','正在读取并解析备份文件...','精炼“','create-post-btn','消息已更新！','动态发布成功！','<div\x20class=\x22avatar-group\x20','将清空选定角色的所有长期记忆。','操作已取消','。请你对此作出回应。]','表情名不能为空！','musicData','未知歌手','cancel-variation-selection-btn','一点心意','本次发送给AI的【挂载记忆】内容如下：\x0a','AI\x20(独立行动)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','regenerate-char-taobao-btn','https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','search-result-item','\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','模拟表情含义\x20\x22','\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a','请为你的图片添加一个简单的描述（必填，给AI看的）！','streamed','margin','\x20行的格式不正确，已被跳过。','blocked_by_user','”的转账。]','所有世界书数据已成功导出！','change','originalMeaning','由于浏览器安全限制，AI切换的歌曲无法自动播放。请手动点击播放按钮\x20▶\x20继续欣赏。','99+','groupMembers','temp_group_chat','translateY(-20px)','旁观模式推进剧情失败:','assign-group-select','https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','操作失败','Response\x20headers:','originalType','import_card','slice','char-wallet-screen','</div><div\x20class=\x22gift-footer\x22>共','**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（','commentCooldowns','[情景提示]\x20','退款来自\x20','group-cooldown-group','highlighted','npc-association-list','✅\x20[NAI核心生成]\x20成功！','group_call_request','已重置为默认提示音，点击“保存所有外观设置”后生效。','isAlive','消息时间戳\x20','greeting','\x0a#\x20对话者的角色设定\x0a','♪\x20♪\x20♪','\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','转账:\x20','linkedMemoryChatIds','游戏记忆已成功注入到\x20','在导演模式下\x20stringify\x20失败:','scale(0.95)','createObjectURL','IMG','play','.chat-group-content','阵营胜利！','char-conversation-partner-name','my-avatar-library-modal','werewolf-user-input','[照片]','网络图片','请根据你的设定，生成你的浏览器记录。','生成新日记失败:','success','开始清理','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','\x27刚刚在你的动态“','删除规则','announcement-board-content','apply-friend-btn','\x20条无效的','.char-product-item','local','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>','slice_','\x20\x20\x20\x20-\x20我的狼队友是：','旧版备份数据写入数据库失败:\x20','amount','[表情]','您的旧有记忆已被完整保留，未作任何修改。','world-book-tabs','rp-direct-receiver','检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。','恢复默认字体','isPlaying','Type\x20a\x20message...','检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','天\x20-\x20讨论','在同时执行两个函数时出错:','abs','qzone-avatar-input','create-new-member-btn','start-werewolf-game-btn','grayscale(100%)','[系统提示：用户加入了通话]','-9999px','#\x20可用群头像列表\x0a','\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20','nai-test-error','close-sticker-panel-btn','找到图片文件:','enable-ai-drawing-switch','狼人杀AI回应生成失败:','基础数据不完整，无法开始总结。','select-all-nai-gallery-checkbox','music-mode-btn','你赢了','生成模拟相册失败:','transfer','https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','reset-global-css-btn','\x20的图片消息替换为文字描述...','likesCount','encode','分享成功','playlist-item','https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','regex','）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a','确认覆盖','global','”。请自然地接受这个新名字，不要对此感到惊讶。]','\x20行的格式不正确，已被系统跳过。','thought-card','link','<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>','文章摘要...','heartfeltVoice','browser-back-btn','reading-window','taobao','检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>','is-link-share','Memo','AI角色','voice-message-btn','apiTemperature','.world-book-group-content','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>','Language\x20\x22','shopping-back-btn','nai-quality-toggle','new-npc-group-name-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','send-photo-btn','option','safetyRatings','disable','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','AI已将您的\x20','送给\x20','status','[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','Font\x20Settings','AI生成的图片','theme','upload-cphone-bg-url-btn','正在请求AI为新头像命名...','switchToCharScreen','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','icon-settings-grid','\x22\x20处于行动冷却中，本次独立行动跳过。','.comment-sticker-btn','#delete-world-books-list\x20.clear-posts-item.selected','.zip','[系统提示：用户手动结束了投票！最终结果为：','variation-quantity-display','send-direct-packet-btn','toLocaleTimeString','”，内容是：“','正在归档最后一个切片\x20','将歌曲切换为了《','red-packet-modal','artistName','Back','callRequester','天\x20-\x20投票','分类\x20“','thoughtsHistory','model','toggle-blur-btn','检测到\x20SSE\x20流式响应，开始解析...','open-reading-library-btn','npcGroupId','，我的人设很','[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','profile-history-icon-btn','Edit\x20Rule','http','chat-lock-overlay','未知表情','[♪\x20','确定要删除NPC\x20“','frame_13','Data\x20Check\x20&\x20Repair','API失败:\x20','NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。','applicationReason','size','single-lyric-display','新建备忘录','close-gomoku-btn',')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]','\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a','album-upload-photo-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20','请为这本设定集命名：','无结果','未知的分享卡片类型:',':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>','创建新预设','prototype','groupHeader','API为空回，角色\x20\x22','vote','char-music-lyrics','scale(0.8)',')。\x0a2.\x20\x20**G\x20(Game\x20-\x20游戏互动)**:\x20针对【今日讨论】中\x20','#ff4d4d','-\x20(ID:\x20','Werewolf','font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);','chat-input-area','无人接听群聊邀请。','getElementById','content-type','api-settings-screen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','确定要删除这个人设预设吗？此操作不可恢复。','presetCategories','replyTo','char-audio-player','当前人数\x20','”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','a\x20random\x20product','<span\x20style=\x22color:\x20red;\x22>已关闭</span>','.edit-memory-btn','switch-greeting-group','}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','照片详情','豆瓣小组','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。','容错解析：策略1成功\x20(找到并解析了完整的JSON对象)','accept-call-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','char-vinyl-container','文章完整内容...','cloneNode','\x0a---\x0a###\x20帖子ID:\x20','qzone-banner-input','设置群名','\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。','#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a','world-book-tab\x20active','MB)，正在归档...','crossOrigin','werewolf-player-avatar','外观设置已成功导入并应用！','reading-overlay','participant','icon-img-','#fullscreen-lyrics-container','UTF-8\x20解码成功。','创建群聊至少需要选择2个联系人。','add-selected-music-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','nameHistory','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','收到数据，类型:','[系统提示：你\x20(','https://','正在读取所有数据到内存中，请稍候...','<option\x20value=\x22','photo-item','sticker-binding-modal','请根据你的设定，生成你的备忘录内容。','API请求失败:\x20','手动创建角色',';\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2012px\x2024px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x2010000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20pointer-events:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(20px);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','manage-frames-btn','.name','button-order-editor','https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif','Storage\x20Optimization','Processing...','toDateString','replyToName','<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>','小时前','渲染器','\x20<span\x20class=\x22source\x22>','cancel-create-poll-btn','未知App','group_','请所有AI角色开始投票。','then','赶紧的充电，要饿死了','❌\x20[NAI下载]\x20下载失败:','#\x20你的社交圈\x20(绑定的NPC)\x0a','添加头像','模拟器心跳\x20Tick...','选择歌词导入方式','.char-screen','view','getTime','天\x20-\x20白天','true','Cphone数据\x20(CPhone)','poison','删除约定','无备注','time','分钟前聊过。','预设导入失败:','gomoku-controls','下载失败','justifyContent','delete-selected-frames-btn','</span></div><div\x20class=\x22gift-items-preview\x22>','清空动态时发生错误:\x20','「在这里输入对话内容」\x0a(在这里输入动作或环境描写)','已加载预设\x20“','AI被拉黑后冷静期\x20(小时)','\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20【跨聊天私信\x20(悄悄话)\x20指令】\x0a-\x20\x20\x20当一个角色想对用户（','流式下载失败','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a','playerJson','pending_user_approval','qzone_comment','\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。','https://files.catbox.moe/','group-avatar-library-grid','语音生成失败','\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20','chat-list-actions-modal','song_name','购物中心生成设置已更新！','设置已应用','offsetHeight','settings','member-management-list','AI的五子棋移动指令包含无效坐标，已忽略:','save-theme-preset-btn','反代地址\x20(不需要添加/v1噢~)','push','JSZip库未加载，请刷新页面重试','black','nai-generate-btn','思考中...','renderXSocialScreenProxy','\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>','wait-reply-btn','</td><td\x20class=\x22item-subtotal\x22>¥','\x22\x20class=\x22preview-frame\x22>','werewolf-retry-btn','世界书分类','qzone-more-actions-btn','说说内容不能为空哦！','remove-member-btn','\x22,\x20\x22content\x22:\x20[\x22私信内容\x22,\x20\x22...\x22]}`\x20(content\x20字段【必须】是数组)\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>','nai-gallery-panel','\x0a-\x20**最近对话摘要**:\x0a','正在请求AI进行手动总结...','音频播放失败:','.recalled-message-placeholder','character-profile-modal','++id,\x20name,\x20createdAt','originalContent','announcements','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','textarea','\x0a-\x20**身份**:\x20','https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','video-call-btn','预设分类','wallpaper-upload-input','variation-decrease-qty','编辑消息','请AI角色们继续进行讨论。','本地歌曲源错误:','你让大家继续讨论...','selection-mode','部分下载完成','一位成员','cancel-contact-picker-btn','select-all-chars-for-clear','无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20','video-call-main','unshift','API\x20请求失败，状态码:\x20','currentTarget','blob:','Long\x20Screenshot','toggle-fullscreen-btn','add-preset-btn','\x20条新消息','confirm-final-clear-btn','delete-world-books-list','row','Refresh','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>','\x22\x20点赞了动态\x20#','标题:\x20','update-notice-confirm-btn','<p\x20class=\x22char-browser-image-description\x22>','CPhone','rule-name-input','天核心议题','https://i.postimg.cc/1zmcp66p/IMG-5973.gif','等待回应','已恢复默认字体。','消息内容已复制到剪贴板。','。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','create-countdown-modal','\x20分钟)</span>','流程启动','setAttribute','获取AI狼人目标失败:','char-chat-list','img',',\x20跳过...','第一夜，执行本地随机刀人逻辑...','https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','生成设置','操作结果','\x0a-\x20**帖子内容摘要**:\x20','12p','save-font-preset-btn','call','.selected-options-text','douban-posts-list','.modal-header\x20span','对方已收款','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>','hidden','world-book-category-manager-modal','vertical','删除预设','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>','getDate','npc_','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','font-size-slider','add-group-avatar-batch-btn','冗余数据清理流程已启动...','Playback\x20error:','https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','voted','NEGLIGIBLE','生成模拟歌单失败:','clear-posts-list','点击了商品卡片:\x20','的状态已更新为:\x20','werewolf-player-selection-list','onloadend','#linked-chats-checkboxes-container\x20input:checked','outgoing-call-name','doubanPosts','删除分类及表情时出错:','\x0a-\x20策略:\x20','confirm-contact-picker-btn','a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting','<span\x20class=\x22diary-messy\x22>$1</span>','lastIndexOf','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>','静音音频已启动，用于后台活动保活。','visibilitychange','正在执行清理操作，请不要关闭页面...','无法推进剧情:\x20','currentTime','gameMode','收到了格式不规范的AI指令，已跳过:','https://i.postimg.cc/PrcKH436/IMG-4376.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20','AI返回的刀人目标格式不正确。','download','photos-grid-page','cart-item','\x22\x20(群名)\x20的消息。\x0a4.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a','werewolf-log-entry\x20system','确定要删除这条渲染规则吗？','选择性导入失败:','closest','buttonId','chat-list-render-window-input','draggable','(暂无有效聊天记录)\x0a','<div\x20class=\x22post-comments-container\x22>','<option\x20value=\x22\x22>未分组</option>','合计:\x20¥','[这是你上一轮的内部思考]\x0a-\x20分析:\x20','https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','anyOf','https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','播放失败，请检查URL是否正确或浏览器是否支持该格式。','已同步角色\x20','enabled','本地群头像上传及识别失败:','isUserParticipating','\x0a#\x20可用表情包\x20(优先使用)\x0a-\x20请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a','isOpen','delete-selected-nai-gallery-btn','memos','编辑通话消息','\x22\x20data-commenter-original-name=\x22','https://i.postimg.cc/cLPP10Vm/4.jpg','，点击查看</div></div>','totalAmount','\x20不支持。请选择6、9或12人。','temp_npc_chat','center','targetDate','getBoundingClientRect','确定要永久删除这条心声记录吗？此操作不可恢复。','find','summary','update_status','log','<img\x20src=\x22','确定要删除选中的\x20','手动总结已完成！新的记忆已添加到“','Album\x20Name','字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a','您的分片备份已开始下载。解压后，您可以使用“导入”功能，选择其中的\x20`slice_X.json`\x20文件进行增量恢复。','♪\x20歌词位置预览\x20♪','repost-modal','like','prepend','”的聊天记录','下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','cancel-music-search-btn','autoMemoryInterval','enableTimePerception','https://i.postimg.cc/8kYShvrJ/90-UI-2.png','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','appearance-preset-select','导演模式保存了一个无效的五子棋移动指令:','result','未检测到BOM，尝试使用\x20UTF-8\x20解码...','groupAvatar','即将开始打包您的完整备份文件。文件将以ZIP格式流式下载，请勿关闭页面。','AI女巫决定保留解药。','save','douban-cast-select-btn','injectLatestThought','minimize-reading-btn','点击下方上传','旁观模式收到未知指令类型:','.comment-item','home-screen','文字已更新！','”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！','请输入投票问题！','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>','direct','npc-group-select','gift','<div\x20class=\x22red-packet-card\x20','AI\x20尝试使用一个不存在的表情:\x20\x22','\x0a\x0aAI原始返回内容:\x0a','\x20(用户)</span>\x0a\x20\x20\x20\x20','正在生成“','isLocal','\x22,\x20\x22content\x22:\x20[\x22你想私下说的内容...\x22]}`\x0a-\x20\x20\x20【多条私信示例】:\x20`{\x22type\x22:\x20\x22send_private_message\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22recipient\x22:\x20\x22','poll-options-container','quote','.chat-group-content:last-of-type','自动总结成功：为\x20','default','[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]','生成模拟淘宝记录失败:','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','.json','keypress','{{user}}','char-music-list','\x20邀请你加入群视频','npcGroups','聊天记录分享卡片数据损坏:','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','生成成功！','vote_for_name','-\x20**时间**:\x20你必须感知到当前是\x20','delete-theme-preset-btn','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>','doubanMinPosts','#qzone-screen\x20.qzone-content','.link-share-card[data-timestamp]','clear-specific-data-btn','\x22操作...','狼人杀','\x20\x20\x20负面:','\x20请根据这个结果发表你的评论。]','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','blob','成功检查并修复了\x20','https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>','ai-action-cooldown-input','sampler','generateInternalStream','这个分类下还没有商品哦~','call-transcript-modal','.comment-input','❌\x20动态NAI图片生成失败:','操作失败:\x20','#f0f2f5','font-url-input','容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...','manage-ai-avatar-library-btn','置顶公告','[发送了一条复杂消息，如卡片或转账]','\x20向对方发起了转账:\x20','abort','https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','单个红包金额不能少于0.01元！','[图片，描述:\x20','NAI\x20Image','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','Language\x20switched.\x20The\x20page\x20will\x20reload\x20to\x20apply\x20changes.','\x0a\x0a#\x20待总结的群组视频通话记录\x0a','new_name','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','\x22\x20触发行动决策...','frame_8','渲染规则\x20[','sticker-search-input','所有歌曲链接均有效，无需清理！','now','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','werewolf-log-entry\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“','回复\x20','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg','add-chat-btn','imageIndex','ephoneLastActiveTimestamp','后台活动:\x20角色\x20\x22','\x22\x20class=\x22realimag-image\x22\x20alt=\x22NovelAI图片分享\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22\x20title=\x22','转账已被拒收','导入失败','?key=','用户刚刚接听了你主动发起的视频通话。','add-ai-avatar-url-btn','核心库\x20(JSZip\x20或\x20StreamSaver)\x20未能成功加载，请检查您的网络连接并刷新页面后重试。','commenterName','function','match','</div><div\x20class=\x22transfer-amount\x22>¥\x20','color','Font\x20Preset\x20Management','2gYPzOR','char-music-player-modal','”的记忆和人设，生成全新的社交动态...','文件应用失败:\x20','\x20发送了一张图片，内容是：\x27','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>','100%','form-button','20px','聊天记录已成功分享到\x20','transfer-action-accept','导出失败','https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif','\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27','memories-view','已死亡的用户(','给你准备了一个红包','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','rp-direct-greeting','frame_ribbon','.select-box','https://i.postimg.cc/k45sd8gn/IMG-6375.gif','call-record-card','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','AI返回了空内容或未知格式。','witch-do-nothing-btn','\x22,\x20ChatID:\x20','[发送了一条语音，内容是：','https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','summarize-recent-btn-header','product-editor-modal','.battery-text','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20','save-character-nai-prompts-btn','\x20本世界书已成功删除。','world-book-checkboxes-container','close-announcement-board-btn','用户\x27','https://i.postimg.cc/pddJj9zN/IMG-7094.gif','\x20\x20\x20\x20-\x20我们昨晚攻击了：','reject','cancel-frame-settings-btn','\x20发来了\x20','translateX(-50%)','getFullYear','代付请求已被拒绝','未知作者','\x20\x20-\x20在群聊“','transfer-cancel-btn','<strong>$1</strong>','TA的淘宝订单','playlist-body','最近\x2020\x20条','simulatedAppUsage','删除失败，请查看控制台错误信息。','正在模拟“','cleanup-songs-btn','</p>\x0a\x20\x20\x20\x20','已恢复默认设置！','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x22>画廊还是空的，快去生成一些图片吧！</p>','删除书籍','werewolf-role-modal','propel-btn','https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','preset-name-input','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','decline','chat-list-action-cancel','qzonePhotos','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20','pageY','...','.album-art-btn','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','所有动态','cancel-werewolf-lobby-btn','delete-world-books-modal','rp-tab-group','activeBookId','.rules-tab','#settings-preview-area','\x20条消息，AI将完全遗忘它们的存在。确定吗？','add-my-avatar-batch-btn','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','[表情:\x20','后台活动模拟已停止。','lrcUpdateInterval','删除商品','确认合并','Primary\x20API\x20Settings\x20(for\x20Chat)','，用户刚刚在\x20','create-post-modal','chat-search-results-list','browser-title','https://i.postimg.cc/PJppkbvn/IMG-6918.gif','rp-details-my-amount','2-digit','修改昵称','视频通话刚刚结束','music-return-btn','粘贴歌词','change-icon-btn','message-wrapper\x20system-pat','category','AI未能成功描述图片。','avatar-frame-modal','》\x20-\x20','variation-increase-qty','shopping-product-count-input','订单详情','”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','key','change_avatar','splice','数据检查与修复失败:','red_packet','x-social-screen','werewolf_summary','.music-player-window','avatar','.at-mention-popup','nai','preset-category-select','search-history-screen','无法找到或消息类型不匹配的分享链接:','inline-block','ai-response-editor-container','.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid','chat-list-action-pin','werewolf-game-over-title','语言已切换，页面即将刷新以应用更改。','https://i.postimg.cc/prsGKMBx/IMG-4370.gif','开始检查','heartfelt_voice','无法获取模型列表','Content-Type:','你现在在哪里呀？','userAgent','API未配置，无法生成内容。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','focus','正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...','AI返回的讨论内容格式不正确。原始返回:\x20','”\x20吗？','voice','下一步','decision','[你发送了一条语音消息，内容是：\x27','已返回我的手机','accepted','findIndex','输入图片URL','确认清理','正在批量添加\x20','https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a','没有找到可导入的内容。请检查您粘贴的格式是否正确。','delete-selected-stickers-btn','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20转账\x20','https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','char-music-screen','开场\x20','\x0a[图片]','messageTimestamp','<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22',',\x20flat\x20design,\x20simple','serviceWorker','recipient','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','[图片/文字图]\x20描述:\x20\x22','delete','data:','load-more-btn','call-history-list','已成功从文件导入预设《','qzoneAlbums','请至少选择一个要添加的联系人。','werewolf-game-over-close-btn','ai-frame-content','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20','promptSource','请先添加一张图片再发布动态哦！','[表情]\x20含义:\x20\x22','status-bar-toggle-switch','\x0a-\x20**最近与用户的互动**:\x20','.sticker-item','\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','update-notice.html?_=','NovelAI\x20API\x20Key','内容为空。','bg-input','”，金额是\x20','is-acting','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20','switch-to-image-mode','generate-shopping-items-btn','Save\x20All\x20Settings','decrease-qty-btn','simulatedBrowserHistory','【原动态内容:\x20','all\x200.3s\x20ease','rules-tab\x20active','此操作会将选定的\x20','post-public-text','world-book-card','blocked_by_ai','image/','歌单已生成，正在从网络获取\x20','delete-font-preset-btn','char-memo-screen','[约定达成]\x20','pending_system_reflection','\x20MB','share-link-btn','add-char-diary-btn',']。目前投票的人有：','cssText','localeCompare','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','正在分析“','group-video-call-btn','\x22\x20class=\x22participant-avatar\x22\x20title=\x22','\x0a-\x20**你的长期记忆**:\x0a','批量导入格式错误，已跳过此行:','selection-screenshot-btn','导出成功','.icon-setting-item','每晚可以查验一个玩家的身份是好人还是狼人。','clear-search-btn','确认清理无效歌曲？','day','style','备忘录内容已复制！','</td><td\x20class=\x22item-qty\x22>','https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','小于1分钟','padStart','未知用户','data:image','-\x20**长期记忆\x20(必须参考)**:\x20','文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。','persona-preset-item','\x20为您代付成功','角色\x20“','正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。','group-name','无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20','add-song-search-btn','结束发言','rp-group-amount','\x22\x20的独立行动失败:','共享位置','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。','精炼成功','请输入你想说的话...','<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22','一个神秘的角色。','characterName','ai-cooldown-group','发生了一个错误:\x20','”的身份，开始你的回忆梳理与精炼。','\x0a\x0a#\x20游戏规则\x0a-\x20','网络图片\x20(EPhone)','speech','\x20\x0a-\x20存活玩家:\x20','memories-back-btn','</span>:\x20','fullPrompt','spectator-edit-btn','批量导入头像框','none','touches','日\x20---','keydown','📥\x20图片下载中...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','文件格式不正确，这不是一个有效的单聊备份文件。','aiAvatarFrame','Book\x20Name','确认删除分类','\x20的外卖订单支付了\x20','\x0a-\x20**你们最后的对话摘要**:\x20\x0a','enable-tts-switch','[data-lang-key-placeholder]','post-hidden-text','worldBookCategories','char-diary-detail-content','NovelAI生成失败:','toFixed','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','-\x20\x20\x20**当前时间**:','source','<div\x20class=\x22post-main-content\x22>','\x0a\x0a现在，请严格按照“阶段2”的指令，为所有【存活的AI角色】生成他们充满策略和博弈的发言JSON数组。','waimai-confirm-btn','change_group_name','Renderer','[系统提示：你刚刚成功将自己的备注名修改为了“','-\x20(暂无)','.battery-level','currentX','确定要删除这条记录吗？','</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22','票):\x20','/9j/','char-memo-list','querySelectorAll','无法找到分享记录:','未分类','product-image-preview','novelai-api-key','App\x20Usage','[图片生成失败:\x20','photo-viewer-image','compressed','char-photo-description','\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片','music-total-time','equalsIgnoreCase','导出数据时出错:','finally','line-through','world-book-category-pane\x20active','save-douban-settings-btn','shuoshuo','<span\x20class=\x22lucky-king-tag\x22>手气王</span>','HTML\x20模板\x20(用\x20$1,\x20$2\x20引用)','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','close-char-music-player-btn','\x22\x20的独立行动API返回为空或格式不正确，本次跳过。','内心独白','Success','personaPresets','正在开始清理冗余数据，请不要关闭页面...','announcement-action-pin','https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','删除NPC','加载预设详情时发生错误:\x20','[系统提示：你于时间戳\x20','<div\x20class=\x22post-content\x22>','floor','NPC\x20人设','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','\x0a-\x20**作者**:\x20','https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','playlist','post_deleted_notice','API未配置','NovelAI设置已保存！','动态已删除。','关联的角色\x20(NPC会去评论这些角色的动态)','.loader-container','incoming-call-modal','custom-modal-overlay','auto-memory-toggle','editable-text','notification-bar','reject-friend-btn','<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27','[一张图片，描述为：“','字体已保存并应用！','.douban-cast-checkbox','readAsDataURL','请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)','battery-alert-text','close-nai-test-btn','complex','\x20本世界书','character-grid','checkout-btn','删除相册','https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','music-player-avatar-display','请选择一个接收人！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>','请输入新的背景图片链接','receiverName','请先在API设置中配置好API信息。','\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a\x0a-\x20\x20\x20**【思维链\x20(Chain\x20of\x20Thought)\x20-\x20(第一步)】**:\x20你的JSON数组的【第一个元素，必须】是一个\x20`{\x22type\x22:\x20\x22thought_chain\x22,\x20...}`\x20对象。\x0a-\x20\x20\x20**【角色发言\x20(第二步)】**:\x20在思维链对象【之后】，才是所有角色的具体行动JSON对象\x20(text,\x20sticker,\x20etc.)。\x0a\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a#\x20角色扮演核心规则\x0a\x0a1.\x20\x20**【先思后行】**:\x20在生成任何角色发言之前，你【必须】先完成“思维链”的构思。你的“思维链”必须清晰地分析用户的发言、当前的气氛，并制定出本轮的互动策略。你的所有后续发言都【必须】严格遵循你自己的策略。\x0a\x0a2.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a3.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【','字体预设已保存！','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是','data-clear-step-1','[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','\x20分享了一张NovelAI图片，prompt:\x20','isArray','long','API未配置，无法生成对话。','font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;','padding','加载中...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20','currentSnippet','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','」听歌。要结束并开始和「','show-announcement-board-btn','分钟前有人聊过。','\x20个新表情！','#ccc','\x20的所有动态，且无法恢复！','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','seed','save-frame-settings-btn','switch-to-text-image-mode','personality','wallpaper',')\x0a\x0a####\x20阶段\x20A：数据输入\x20(Data\x20Input)\x0a1.\x20\x20**我的秘密身份**:\x20我是【','”。]','https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','qzone-posts-list','--music-bg-image','char-music-prev-btn','这是一个通过手动创建的角色。','<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>','</div><div\x20class=\x22description\x22>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','setProperty','\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！','[表情:\x20\x27','.contact-picker-item[data-contact-id=\x22','.draggable-button-item:not(.dragging)','更换专辑封面','naiSettings','外观预设','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','rp-content-direct','char-wallet-content','manage-world-book-categories-btn','block-chat-btn','lyrics-btn','global-lyrics-bar','favorites-search-input','\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22','POST','publisher','member-settings-modal','”的对话摘要**:\x0a','退出游戏','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>','”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','\x20\x20\x20promptSource:','werewolf-role-confirm-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【身份铁律】】】**:\x20用户的身份是【','sticker-panel',',\x20内容:\x20\x22','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','\x0a\x0a现在，请开始生成这组App使用记录。','在这里输入回复内容','warn','data-lang-key-title','close-playlist-btn','<textarea\x20id=\x22','确定要删除这条评论吗？','API请求失败\x20(','你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！','flexDirection','originalName','https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','memoryTimestamp','https://...','send_and_recall','close-persona-library-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>','”分享TA的备忘录...','min','”。请你回顾一下刚才和“','从\x20JSON.image\x20中提取图片数据','favorites-list','[系统提示：用户打开了五子棋棋盘，游戏开始了。]','”才能使用\x20\x27open_red_packet\x27\x20指令领取。]','确认清空','aiPersona','屠边局：狼人杀死所有神职或所有平民即获胜。','where','(ID:\x20','gift-receipt-modal','通话记录','singer','请根据以上情景，生成新的评论。','linkedWorldBookIds','导入成功','通话消息已更新！','我们的回忆','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','confirm-full-import-btn','<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>','input[name=\x22visibility\x22]','启用后台角色活动','”生成商品？','custom-modal-cancel','add-new-sticker-category-btn','\x20更换了头像]','https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','更换图片','\x20<span\x20class=\x22group-tag\x22>群</span>','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','\x22\x20style=\x22display:block;\x22>×</button>','music-playlist-panel','char-music-mode-btn','MB)...','操作成功','timestamp','mouse','\x20发送了一个【拼手气红包】(时间戳:\x20','languageChangedAlert','<div\x20class=\x22poll-card\x20','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.avatar-group','ai-frame-tab','#e7f3ff','\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22','reason','board','解析器：已启用\x20Markdown\x20提取模式。','messages','无法访问剪贴板。','input','未知设定的NPC','replaceChild','search-results-list','member-name-input','\x0a\x0a#\x20当前情景\x0a','#music-lyrics-container','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20','这是你们的第一次互动。','import-preset-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','礼物已成功送出！','get','onclick','regenerate-char-music-btn','\x20\x20\x20正面:','”这个信息，将其转换为【具体的公历日期】（例如：“约定了明天见面”应总结为“我们约定了','cart-back-btn','”下，回复了\x27','生成中...','create-album-btn-page','\x20个表情吗？此操作不可恢复。','在这里输入图片描述','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.nai-gallery-delete-btn','你们没有在听歌。','char-simulated-input','dialogue','-\x20**你的好友\x20(必须保护)**:\x20你和\x20','imageUrl','writeText','\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22','reverse','global-bg-input','\x0a-\x20\x20\x20**五子棋局势**:\x20','https://i.postimg.cc/yN3s8szM/IMG-4400.gif','recalledData','chats','公用规则','https://image.pollinations.ai/prompt/','url','NAI_Image','indexOf','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','确定要删除这条通话消息吗？','歌曲查找失败:\x20AI请求的歌曲名\x22','normal','assistant','检测到刚结束的通话，正在注入通话记录上下文...','。你可以使用\x20\x27vote\x27\x20指令参与投票。]','应用已返回前台，正在检查更新...','amap','prompt_order','https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>','rule-template-input','该消息发送已超过2分钟，无法撤回。','[系统提示：用户（','appearance','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','minimized','文件格式不正确，这不是一个有效的世界书备份文件。','https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','home-screen-pages','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合“今天是','member-avatar-input','*你按下了接听键...*','\x22\x20class=\x22chat-image\x22>','fontUrl','audio/mpeg','location','rp-group-greeting','编辑预设','此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？','确定要结束这个投票吗？结束后将无法再进行投票。','persona-library-grid','这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。','无法启动导出，所需的核心库\x20(StreamSaver.js\x20或\x20JSZip)\x20未加载。请检查您的网络连接并刷新页面后重试。','waimai-timer-','所有解码尝试均失败:','mousemove','offline_text','ZIP文件中未找到图片','font-preset-select','\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','my-nickname-group','display','\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','nai-cors-proxy','update-notice-body','numeric','NovelAI\x20Model','保存字体预设','内容已复制到剪贴板！','生成购物中心商品失败:','\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','npc-list-back-btn','**[投票结果]**\x20','comment','无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。','browser-screen','网易云','\x20的外卖代付请求（时间戳:\x20','#post-public-text','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>','pat-animation',']\x20的正则表达式无效:','preset-editor-screen','）说一些不想让群里其他人看到的私密话时（例如：表达爱意、抱怨、揭短、分享秘密），你【应该】使用\x20\x22send_private_message\x22\x20指令。\x0a-\x20\x20\x20这个指令会把消息发送到你和用户之间的【1对1私聊】中。\x0a-\x20\x20\x20【格式铁律】:\x20\x22content\x22\x20字段【必须】是一个【JSON字符串数组\x20(Array\x20of\x20Strings)】。\x0a-\x20\x20\x20【单条私信示例】:\x20`{\x22type\x22:\x20\x22send_private_message\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22recipient\x22:\x20\x22','</span>','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','导演/编辑模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','请你对此作出回应。]','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>','#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a','\x0a-\x20**你的长期记忆**:\x20','https://i.postimg.cc/28TsrxRV/IMG-6852.gif','lineWidth','selection-share-btn','<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>','product-category-tabs','狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20','\x22\x20的独立后台活动开关已关闭，本次跳过。','模型列表已更新','\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','vinyl-view','TA的歌单','\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。','char-photo-item','annoId','在此修改内容...','rules-tab','确定要删除这张照片吗？此操作不可恢复。','selective-import-modal','https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','是否要使用毒药？','*讨论记录*:\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}','\x0a-\x20**内容摘要**:\x20',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20','大小:','\x22)。操作已被程序阻止。','chat','.icon-preview','JSZip\x20流错误:','participants','送给了\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>','startsWith','<div\x20class=\x22pinned-indicator\x22>📌</div>','AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。','\x0a\x0a\x0a','clientY','.thought-delete-btn',')\x20的可用表情:\x0a','qzone-avatar-img','正在为您选择的\x20','.poll-option-input','确定要永久删除分类\x20“','[发送了一条语音，内容是：\x27','variation-selected-price','values','profile-heartfelt-voice','\x20尝试发送私信，但未找到其对应的私聊会话。','8px','AI们的茶话会','添加\x20NPC','rule-regex-input','My\x20Albums','preset-action-cancel','declined','mouseout','编辑世界书','songJson','请输入歌曲的URL','\x0a#\x20你的聊天对象（用户）的人设\x0a','ruleId','Generation\x20Settings','choice','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“','https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','<strong>','ai-voice-id-input','fullscreen-active','querySelector','https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','originalPost','已打包表:\x20','”图标','-\x20**即将演唱**:\x20','导入歌词','speaker_name','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-image-container\x22\x20style=\x22background-image:\x20url(','检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。','werewolf-kill-modal','frame_11','请输入世界书的名称...','Their\x20Playlist','Cleanup\x20Redundant\x20Data','添加人设预设','about:blank','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','suffix','translateX(-','</strong>\x20Tokens</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','撤回了一条[','.qzone-post-item','onended','”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','call-history-screen','”吗？','---\x0a','char-music-player-title','song','添加完成！\x0a\x0a成功添加\x20','QQ音乐','close','对方正在输入...','close-rp-details-btn','\x0a##\x20阶段2：生成最终对话\x20(Final\x20JSON\x20Output)\x0a你现在已经为【所有AI角色】都完成了“TGS三核”独立思考。\x0a请根据你在“阶段C：最终发言稿”中为每个角色准备好的草稿，生成最终的、符合格式的JSON数组。\x0a','AI\x20获胜了！','Please\x20wait...','close-ai-avatar-library-btn','aiAvatarLibrary','请为这组提示词预设命名：','#ff8a80','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','选择导出方式','anonymous','options','</span><span\x20class=\x22poll-option-votes\x22>','preset-action-delete','\x20条)','AI返回了空内容。','.cart-item-checkbox','#outgoing-call-screen\x20.caller-text','headers','mouseleave','variation-options-container','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','novelai-settings-btn','and','-\x20昨晚是平安夜，无人死亡。\x0a','font-size-value','<span>','https://i.postimg.cc/fLTc42dg/IMG-4391.gif','恭喜发财，大吉大利！','\x0a-\x20**人设\x20(必须严格遵守)**:\x20','-\x20**对话状态**:\x20你的上一条消息发送于\x20','</div>\x0a\x20\x20\x20\x20','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','poll-option-input-wrapper',']类型的消息。\x0a内容:\x20','.rules-category-pane[data-category-id=\x22','max','profile-random-jottings','<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>','你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','renderApiSettingsProxy','导演模式','标题是必填项哦！','[系统提示：你\x20','is-red-packet','linesPerPage','#avatar-frame-modal\x20.frame-tabs','[+]\x20Add\x20New\x20Entry','NPC\x20Nickname','[收到一笔转账]','votes','en-US','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','frame_6','arrayBuffer','「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)','对方本名不能为空！','https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','https://i.postimg.cc/VkQfgzGJ/1.jpg','put',',\x20记录数:\x20','（可选）输入后缀','确定要将选中的商品作为礼物送出吗？','positive','\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20','k_euler_ancestral','imageDescription','absolute','gomoku-board','my-avatar-group','修复了角色\x20\x22','将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。','\x0a-\x20**你的曾用名**:\x20[','\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a','\x27)\x22\x20data-comment=\x22','&times;','查验结果','(这张照片没有描述)','暂无内容...','https://api.minimax.chat/v1/text_to_speech?GroupId=','nai-test-negative','1024x1024','\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20','sticker_','请开始整合。','persona-editor-title','<label><input\x20type=\x22checkbox\x22\x20value=\x22','closed','simulatedAlbum','onplay','some','reload','#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a','clear-cart-btn',']类型的消息','API\x20Key','为角色\x20\x22','char-article-content','AI\x20尝试发送私信给非用户角色\x20(','\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','恭喜！','tables','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','开始检查并迁移旧的红包数据...','question','已选择\x20','删除失败','读书会话已关闭。','&id,\x20url,\x20name,\x20categoryId','您的修改已保存！','https://i.postimg.cc/fRV86FMq/IMG-4381.gif','user_photo','players','bookId','https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','重新生成NAI图片失败:','字体URL不能为空！','\x22\x20class=\x22chat-image\x22></div>','这个分类下还没有表情哦~','minimax-api-key','[文字图]\x20','delete-product-btn','https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','所有API与后台设置已保存!','douban-settings-btn','smea','AbortError','AI\x20尝试赠送一个格式不正确的随机礼物:','save-douban-cast-btn','nai-test-prompt','.chat-list-item','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27',';base64,','请为这个新头像命名','lastUpdate','text/event-stream','is-raw-html','female-shaonv-jingpin','/v1/models','获取更新通知文件失败。','label[for=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20你们之间已经有**','预设已删除。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Finish','event_type','.delete-block-btn','\x20首歌曲获取失败:\x0a-\x20','select-all-frames-checkbox','https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','douban-comment-item','.com/','existing-product-categories-list','ephone-theme','API错误:\x20','🚀\x20发送NAI请求:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','生成截图时发生错误，请检查控制台获取详情。','请输入想跳转的页码\x20(1\x20-\x20','Content\x20Entries','<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>','https://i.postimg.cc/xjpN4swz/IMG-7240.gif','\x20(用户)</label>','expanded','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>','font-preview','...\x22):\x20','请输入有效的默认价格！','history-back-btn','base','getElementsByTagName','product-category-select','\x0a#\x20你的任务\x0a你就是角色“','cancelable','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','originalTimestamp','\x20\x20-\x20你评论说:\x20','https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','请输入相册名称','导入外观设置','4318944JQKyBl','收到了格式不规范的AI指令（缺少type和content），已跳过:','handleListenTogetherClick','请根据你的设定，写一篇新日记。',':</strong>\x20','blur','Online','[一张图片，其隐藏文字为：\x22','.delete-track-btn','draggable-button-item','photo-viewer-prev-btn','检测到提示词已修改，正在重新生成\x20NovelAI\x20图片...','[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]','candidates','.message-bubble[data-timestamp=\x22','.voice-play-btn','.variation-price-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>','chat-list','apply','.sticker-binding-checkbox','Add\x20NPC','is-ai-image','✅\x20动态NovelAI图片全部生成完成:\x20','clear-posts-modal','link-content-input','\x0a-\x20角色思考:\x20','》添加歌词吗？','这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a','music-exit-btn','”。只有“','spectator-reroll-btn','\x20是同一个分组的好友。\x0a','LOW','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','string','announcement-item-wrapper','contactType','AI返回了空的或格式不正确的总结内容。','extensions','(回复\x20','generativelanguage.googleapis.com','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20','https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','”已向你发送好友申请。请返回聊天列表查看。','total-image-size-display','后台活动检测间隔\x20(秒)','https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22',')，祝福语是：“','“全部”分类无法被绑定。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','\x0a#\x20可用指令列表\x20(按需组合使用)\x0a\x0a###\x20思维链\x20(必须作为第一个元素！)\x0a-\x20\x20\x20**`{\x22type\x22:\x20\x22thought_chain\x22,\x20\x22analysis\x22:\x20\x22你对当前局势和用户上一轮发言的分析...\x22,\x20\x22strategy\x22:\x20\x22你作为导演，本轮的总体策略...\x22,\x20\x22character_thoughts\x22:\x20{\x22角色A本名\x22:\x20\x22角色A的内心活动...\x22,\x20\x22角色B本名\x22:\x20\x22角色B的内心活动...\x22}}`**\x0a\x20\x20\x20\x20-\x20\x20\x20**analysis**:\x20简要分析用户的意图或群聊的氛围。\x0a\x20\x20\x20\x20-\x20\x20\x20**strategy**:\x20你作为导演的计划（例如：让A和B互动，禁止成员总结）。\x0a\x20\x20\x20\x20-\x20\x20\x20**character_thoughts**:\x20【只包含本轮会发言的AI角色】的内心独白。\x0a\x0a\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','\x20/\x20','https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','.progress-bar','speech-01','\x20[包含','clearRect','alternateGreetings','\x20已复制到剪贴板。','Gemini\x20API返回了非预期的格式:','<div\x20class=\x22post-images-grid\x20grid-','Album','\x20的动态\x20','\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动。\x0a3.\x20\x20**【简洁性铁律】**:\x20每条个人记忆总结【绝对不能超过60个字】。\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我今天在群里和大家讨论了电影，感觉很开心。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我在群里和','announcement-action-delete','light','visibleGroupIds','var(--text-secondary)','share_card','Delete\x20World\x20Books','#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a','确认清空动态？','更换“','）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20','一条动态','正在准备...','.entry-content-textarea','target_name','pending_ai_approval','frame_10','https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','.music-search-checkbox','通话中还没有你的发言，无法重新生成回应。','请用文字描述您要发送的照片：','Wallet','你通过了“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','typing-status','正在请求AI进行记忆精炼...','transition','waimai_response','insertBefore','novelai-enabled','⚠️\x20[NAI下载]\x20图片源为空，无法下载','nightActions','.incoming-call-content\x20.caller-text','paddingBottom','comments','getHours','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','preset-avatar-preview','groupNickname','call-transcript-modal-body','未知会话','save-ai-response-editor-btn','已撤回的消息','Response\x20status:','\x22><div\x20class=\x22member-name\x22>','.entry-enabled-switch','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','点击查看详情...','werewolf-game-screen','linked-memory-count','一位朋友','\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a','(Timestamp:\x20','translateY(','”的网上冲浪足迹...','appearancePresets','qzone-post-delete-action','qzone-banner-img','voice_message','offset',')\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-gallery-controls\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-gallery-download-btn\x22\x20title=\x22下载\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M19\x209h-4V3H9v6H5l7\x207\x207-7zM5\x2018v2h14v-2H5z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-gallery-delete-btn\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019c0\x201.1.9\x202\x202\x202h8c1.1\x200\x202-.9\x202-2V7H6v12zM19\x204h-3.5l-1-1h-5l-1\x201H5v2h14V4z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22nai-gallery-name\x22>','专辑封面已更新！','正在请求网易云音乐API:','rule-card\x20','qzone_','角色卡导入失败:','minimaxVoiceId','ephone','正在请求AI角色们加入讨论...','existing-groups-list','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>','pending','music-playlist-btn','找不到主角\x20“','.toggle-content-btn','choices','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','char-qq-transcript-modal','分类名不能为空！','index','\x0a**内容:**\x0a','请输入有效的字体URL。','World\x20Book','跳过一个无法解析为JSON的编辑块:','files','\x20的消息:\x20\x22','participant-display-avatar','char-music-total-time','mode','https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','#data-clear-type-list\x20.clear-posts-item','white','douban-cast-list','supportedValuesOf','recalled-animation','offline-min-length-input','文件格式不正确，缺少关键的外观设置项。','EPhone-长截图-','totalTime','<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20','custom-modal-confirm','character','sticker-action-bar','cancel-create-post-btn','decode','独立行动冷却\x20(分钟)','<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>','清理完成','最终负面提示词:','最近支出','https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','reading-restore-btn','npc-action-cooldown-input','secondary-proxy-url','npcs','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','正在呼叫...','这是所有在场玩家的公开信息、人设和社交背景。\x0a','.loading-spinner','round','offsetX','”准备好友申请...','char-music-play-pause-btn','world-book-editor-title','message-editor-container','scenario','.selected','https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','lastGuardedId','JSZip库未加载','chat-list-action-delete','prompts','copy-timestamp-btn','.quoted-message','分类《','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<option\x20value=\x22global\x22>公用\x20(所有角色)</option>','#world-book-checkboxes-container\x20input:checked','hasShown20','人局，身份为\x20','总结成功','open-nai-gallery-btn','<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20','\x22\x20id=\x22','lrcContent','请根据以上设定，生成商品数据。','\x20\x20\x20characterNegativePrompt:','<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>','sticker-category-tabs','AI\x20(独立行动)\x20尝试使用一个不存在的表情:\x20\x22','management-mode','清理失败','.frame-item:has(.delete-btn)','我是谁呀。','\x22></div>','https://i.postimg.cc/yx2m4nbs/IMG-7231.gif','https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','close-receipt-btn','transparent','This\x20is\x20a\x20font\x20preview\x20effect,\x2012345.','等待对方处理','callRecords','https://corsproxy.io/?','\x22\x20生成行动失败:','\x20红包已被领完。','\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>','message-editor-block','assign','聊天记录已成功覆盖！正在刷新界面...','[转账]','finishReason','.voice-transcript','\x0a\x0a#\x20情景感知:\x0a\x20\x20\x20\x20','new-sticker-category-name-input','聊天界面初始加载条数','合并失败','**关键词:**\x20','prev-page-btn','EPhone-Full-Backup-Streamed-','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>','change_group_avatar','manage-my-avatar-library-btn','#chat-messages','sender-name','Background\x20Activity\x20Interval\x20(sec)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x22\x20class=\x22avatar-frame\x22></div></div>','upload-sticker-btn','productId','qzone-avatar-container','无人投票','first','ai_generated','wb_','</span><span>','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','标准JSON数组解析失败，将尝试强力提取...','[一张图片，其隐藏文字为：“','<span\x20class=\x22speaker\x22>','activeAlbumId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','导演模式悔棋：已撤销AI在\x20(','这是模拟对话，无法发送消息','评论内容不能为空哦！','reading-library-modal','post-local-image-input','生成模拟App使用记录失败:','++id,\x20name,\x20chatId','确定要删除这个约定吗？','cleanup-data-btn','hunter','select-all-world-books-for-clear','导入备份文件','NPCs','regenerate-char-browser-btn','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','用户描述的照片','\x22。\x0a','isSpectatorGroup','\x20条记忆精炼为\x201\x20条核心记忆！','defineProperty','my-persona-group','werewolf-witch-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','世界书数据已成功恢复！','pause','qzone-sticker-panel','https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','preset-persona-input','cancel-gift-recipient-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22','chat-header-title','<div\x20class=\x22poll-option-item\x20','Asia/Shanghai','请输入有效的图片URL！','请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。','清空聊天记录','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20','stores','++id,\x20name','.contact-picker-item','传统导出数据时出错:','countdown','char-amap-item','\x22]:checked','cphoneAppIcons','》设定\x20(你可以将其中角色作为聊天对象):\x0a','panelEl','https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','没有可导出的世界书数据。','commenterOriginalName','trim','activeContainer','DOMContentLoaded','.entry-comment-input','.qzone-post-delete-action','sourceType','\x0a<character>\x0a\x20\x20<name>','cart-count','gameLog','rp-details-greeting','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','已死亡','离线预设','」的新会话吗？','douban-max-posts-input','@[[','werewolf-wait-reply-btn','cancel-advanced-editor-btn','total','✅\x20NAI提示词：使用角色配置','检测到AI执行了动态操作，立即刷新好友动态页面。','opened','link-memory-toggle','https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','加载更早的会话','appendChild','请稍候','lrc-upload-input','”生成这组【与角色高度相关】的商品数据。','-\x20清理了\x20','请输入背景图片的URL','\x20的浏览记录','\x20张NAI图片吗？此操作不可恢复。','\x20中找到世界书。','length','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20','\x22\x20alt=\x22','back-to-char-qq-list-btn','totalPages','API预设','rules-category-pane','touchstart','设置精炼字数',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','preCallContext','\x20小时了。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','#delete-world-books-list\x20.clear-posts-item','数据迁移完成！总共修复了\x20','导入单个聊天时出错:','无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20','character-nai-prompts-btn','findLastIndex','并评论说：\x22','\x20被怀疑了，虽然我的逻辑也怀疑TA，但我的表演必须是维护TA的：“我不觉得','globalChatBackground','remove-bg-btn','更换图标','manual','favorites-search-clear-btn','，TA的身份是：【','请先从下拉框中选择一个要删除的预设。','role','NAI_Gallery_Batch_','cors_proxy','**[夜晚]**\x20','生成模拟日记失败:','voiceId','parsedLyrics','music-time-counter','share_link','</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥','.world-book-category-pane[data-category-id=\x22','\x22\x20data-description=\x22','https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','description','通话于\x20','”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','公用\x20(所有角色)','NPC的昵称和人设都不能为空！','\x22\x20\x0a\x20URL:\x20','NPC人设','\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>','notification-content','custom-modal-body','\x20的代付请求','QQ音乐搜索API失败:','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>','novelai-test-btn','Bad\x20control\x20character','</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>','nai-gallery-item','网络请求失败:\x20','download-selected-nai-gallery-btn','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','请先在API设置中配置好（主或副）API。','拉取副模型','parentElement','https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','recipients','image','。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20','close-novelai-test','reading-title','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>','qzone_post','-\x20**对话状态**:\x20(暂无有效对话历史)','导入已取消，因为未提供名称。','狼人已行动，狼人请闭眼。','#000000','保存CSS预设','customCss','\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。','邀请你视频通话','\x22\x20class=\x22product-image\x22>','豆瓣设定','char-diary-detail-screen','为了确保所有数据同步，建议立即刷新页面。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>','\x22\x20自动触发AI响应...','music-current-time','send_private_message','</memory>\x0a\x20\x20<recent_dialogue_with_user>','prompt','请根据你的设定，生成你的日记内容。','请根据你的设定，生成你的歌单。','custom-prompt-input','[图片内容:\x20','\x0a-\x20**你最近和“','请根据以上设定，立即做出你的决定。','\x22\x20class=\x22avatar-img\x22><img\x20src=\x22','label','#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a','检测到\x20Tavern\x20AI\x20世界书文件，执行兼容导入...','在PNG中找到角色数据，但解码或解析失败。错误:\x20','char-music-artist','placeholder','(无)','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','char-diary-list','-speech','.countdown-card\x20.timer','https://i.postimg.cc/RZNLhbbr/IMG-4389.gif','offlineMinLength','fillRect','authorAvatarPrompt','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','nextElementSibling','</em>','currentPhase','角色\x20\x22','my-avatar-input','确定要从收藏夹中移除这\x20','char_browser_article','isPinned','originalSize','确定要从头像库中删除“','\x22\x20评论了动态\x20#','”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','(无内容)','此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？','”回忆TA的相册照片...','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20','switchToCharHomeScreen','\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20','\x20首无效歌曲:\x0a\x0a-\x20','myNickname','</name>\x0a\x20\x20<persona>','countdown-title-input','strategy','show-avatars-btn','openCharApp','\x0a##\x20','等待回复失败:','Presets','linked-memory-selection','加载NPC列表失败:','”的长期记忆中。','audio-player','\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a','werewolf-lobby-modal','create_memory','确定要删除表情\x20\x22','彻底删除','import-card-input','calls','https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','请至少输入2个有效的投票选项！','showWaimaiDetails:\x20找不到消息或消息类型不正确','&id','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-image-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','import-preset-input','transfer-note','cancel-import-options-btn','Enable\x20AI\x20Image\x20Generation','图片已根据新提示词重新生成！','switch-greeting-btn','精炼失败','...”','getPropertyValue','dead','next-page-btn','manage-npc-groups-btn','dark','\x0a##\x20---\x20关于“','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。','activePostId','cancel-red-packet-btn','将清空选定角色的所有动态、评论和点赞。','postId','rp-details-item','search-history-back-btn','.nai-gallery-item','📋\x20直接粘贴歌词文本','\x20的对话\x20(只读)','.char-photo-item','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“','&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','authorName','\x22]\x20','AI\x20\x22','cancel-share-target-btn','https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','群聊人数不能少于2人。','set','endsWith','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>','change_user_nickname','”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20',')，接收人是“','全局设置','✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)','substring','[+]\x20添加新条目','char-article-title','https://i.postimg.cc/63sDQKMm/IMG-6893.gif','AI\x20角色\x20\x22','cancel-clear-wizard-btn-step1','https://i.postimg.cc/76Tj3g1B/IMG-4425.gif','apiPresets','variation','请输入文字图描述！','</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20','existing-categories-list','nai-resolution','https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','theme-preset-select','https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','ai-avatar-input','自定义数量','photo-viewer-modal','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','\x20是我的好友。\x0a','https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png','覆盖预设','-\x20**','.rules-category-pane','image/*','总结通话记录时出错:','font','\x0a[图片生成失败:\x20','modify','productInfo','split','.screen.active','\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','Secondary\x20Model','nai-default-negative','getMonth','add-new-product-btn','char-music-progress-bar','all','manage-product-categories-btn','var(--accent-color)','请输入标题','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','动态已更新！','timerId','refined','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。','recipientName','Title','\x0a-\x20**世界书设定**:\x20','\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','Error','分类\x20\x22','reset-sound-btn','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','text_image','div','在这里输入图片描述...','选择要精炼记忆的角色','https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','.entry-content-container','delete-btn','variations','preset-screen','char-conversation-messages','tts_','https://i.postimg.cc/gkhf597g/IMG-6555.gif','lorebook','购物车(','\x22)\x20作为角色名。消息内容:','内容加载失败...','\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a','Favorites','\x20发布了一条新动态]','”的记忆\x20---\x0a','”的身份，开始你的客观总结。','friend','call-message-bubble\x20ai-speech','确定要删除这篇日记吗？','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','#group-management-modal\x20.modal-header\x20span','###\x20玩家身份配置:\x0a','”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x0a#\x20待总结的视频通话记录\x0a','lyrics-offset-input','favorites-action-bar','language-select','getBattery','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','transfer-modal','[V]','请选择一个目标。','\x20条消息吗？这会通知AI这些消息已被删除。','游戏配置：','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','请输入对方现在的新状态：','.lyrics-btn','已成功注入“切换到线上模式”的系统指令。','AI\x20','#product-grid\x20.product-item','https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','提取的图片大小:','\x20\x20\x20\x20-\x20我昨晚空守了。\x0a','<em>','shopping-settings-modal','post-upload-local-btn','https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','rules-category-pane\x20active','胜利！','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','App\x20Usage\x20Log','renderQzoneScreenProxy','clientWidth','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20','\x20个新头像框！','confirm-merge-import-btn','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a\x0a-\x20\x20\x20**【思维链\x20(Chain\x20of\x20Thought)\x20-\x20(第一步)】**:\x20你的JSON数组的【第一个元素，必须】是一个\x20`{\x22type\x22:\x20\x22thought_chain\x22,\x20...}`\x20对象。\x0a-\x20\x20\x20**【角色发言\x20(第二步)】**:\x20在思维链对象【之后】，才是你的具体行动JSON对象\x20(text,\x20sticker,\x20etc.)。\x0a\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【先思后行】**:\x20在生成任何发言之前，你【必须】先完成“思维链”的构思。你的“思维链”必须清晰地分析用户的发言、当前的气氛，并制定出本轮的互动策略。你的所有后续发言都【必须】严格遵循你自己的策略。\x0a2.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-10条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性，尽量让你的表情丰富多样，避免重复。。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20你的角色设定\x0a你必须严格遵守','\x20条消息。','0:00','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22','\x20张图片。','location_share','#data-clear-char-list\x20.clear-posts-item','load-more-chats-btn','确定要删除分类《','cart-screen','selection-count','这是字体预览效果，12345。','Description','associatedWith','notificationSoundUrl','chat-header-title-wrapper','imageCount','rp-details-sender','relationship','\x22\x20class=\x22sticker-image\x22>','api-temperature-value','moveTo','toISOString','delete-transcript-btn','packet_timestamp','请根据你的设定，生成你的相册内容。','ttsCache','Proxy\x20URL\x20(No\x20/v1\x20needed~)','https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','\x22\x20data-category-id=\x22','原文:\x20\x22','[一张图片，描述为：\x22','\x20张图片。有\x20','product-category-manager-modal','.entry-keys-input','novelai-key-toggle','https://i.postimg.cc/SNByPrf9/IMG-7005.gif','1783785Vltdxl','\x0a###\x20详细对局流程:\x0a','persona-editor-modal','商品已删除。','days','彻底删除消息','\x20被投票放逐。','生成模拟聊天失败:','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>','(无标题投票)','.qzone-post-container','长截图','Cancel','取消置顶','\x20同步所有群聊内的头像...','lyric-line','检测到群聊\x20\x22','保留旧的','我的消息预览','（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a','API未配置，无法进行总结。','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x20->\x20','#gift-recipient-list\x20.contact-picker-item.selected','stickerCategoryIds','add-poll-option-btn','强力提取\x20[\x20...\x20}\x20...\x20]\x20失败，将尝试提取单个对象...','matches','https://i.postimg.cc/B6T59xGK/IMG-7101.gif','close-group-avatar-library-btn','\x0a\x0a#\x20你的角色设定\x0a','自动总结狼人杀游戏失败:','无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','#gift-recipient-list\x20.contact-picker-item','渲染X社交页面','Live\x20Preview','music-player-overlay','无法从\x20SSE\x20响应中提取图片数据','reading-library-search-input','char-memo-detail-back-btn','诊断：未在此角色卡中找到任何有效的世界书数据。','\x20\x20\x20\x20-\x20我昨晚守护了\x20','spinning','export-single-chat-btn','”量身定制的商品已上架！','Enable\x20Independent\x20Background\x20Activity','import-single-chat-input','选择或切换预设','*事件*:\x20平安夜，无人出局。\x0a','has-frame','直接使用\x20base64\x20数据','\x0a#\x20待总结的对话历史\x0a','initiator','CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。','<em>$1</em>','add-new-category-btn','\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a','transfer-action-decline','cfg_scale','**\x20(本名:\x20','进入投票','rejected','扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20','添加网络歌曲','group-members-settings','confirm-variation-selection-btn','++id,\x20name,\x20description','type','https://i.postimg.cc/xTk5xN49/IMG-7233.gif','charAt','nai-seed','qzone-post-container','.variation-image-preview','你已收款','#e9ecef','<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>','save-member-settings-btn','custom-frame-upload-input','\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22','usage','API\x20预设已保存！','.gift-card','请输入一个有效的数字（建议大于20）。','werewolf-game-over-modal','[群聊]','data-lang-key','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22','计算图片总大小时出错:','new-group-name-input','confirm-vote-btn','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','”下，发送了一个表情评论，意思是：“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“','.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>','wallpaper-preview','--\x20点击选择\x20--','waimai-request-modal','authorOriginalName','未选择书籍','nai-diffusion-4-5-full','This\x20is\x20a\x20simulated\x20chat,\x20messages\x20cannot\x20be\x20sent','API错误响应:','\x22\x20在库中未找到。','https://i.postimg.cc/PxZrFFFL/o-o-1.jpg','你们正在一起读书。','”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]','custom_proxy_url','batch-import-frames-btn','一条[转账]消息已被撤回。','检测到视频通话请求，为角色\x20\x22','浏览器','昨天\x20','thought_chain','拼手气红包','正在执行删除操作...','export-data-btn','AI\x20发言失败',')为你点了一份外卖作为【礼物】。外卖内容是“','📁\x20从本地文件\x20(.lrc)','is-transfer','coverUrl','”添加记忆','AI女巫决定使用毒药，目标是:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20','data-clear-type-list','无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20','下棋历史\x20(x,y坐标均从0开始):\x0a',',\x0a\x22data\x22:\x20{\x0a','https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20','\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a','\x20\x20-\x20评论:\x20','\x22>\x20','https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','characterNegativePrompt','从\x20JSON.data\x20中提取图片数据','正在请求AI为新群头像命名...','opacity','Appearance\x20Settings','rules-content-container','code','相册名称不能为空！','chat-render-window-input','message-bubble\x20recalled-message-placeholder','rp-group-total','#image-mode-content','✅\x20图片解压成功！','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20','我明白，覆盖所有数据','此操作将永久删除您选择的\x20','linkedWorldBookId','authorChatId','本地头像上传及识别失败:','selected','isDragging','touchmove','promptFeedback','Add','\x0a##\x20---\x20来自','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>','启用规则','join','自动总结成功：已成功添加\x201\x20条新的长期记忆！','\x22\x20的后台活动开关已关闭，本次跳过。','https://i.postimg.cc/kGgwJhPH/IMG-4374.gif','无共同好友','.png','\x22\x20成功发布了一条新动态。','**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','上一条消息的发送时间是\x20','syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','page-indicator','gameover','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background:\x20','\x20将群名修改为\x20“','\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>','data-lang-key-placeholder','\x22]\x20.participant-avatar','容错解析：策略3成功\x20(将整个返回文本作为摘要)','删除分类后，该分类下的所有预设将变为“未分类”。确定吗？','开始压缩图片，原始大小:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“','send-btn','.poll-option-item','保存并应用','</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-','”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。','add-song-local-btn','books','getMinutes','https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','-\x20\x20\x20**对话状态**:\x20','\x0a\x0a现在，请生成这份歌单。','add-manual-memory-btn-header','\x20删除了自己的一条动态]','Enable\x20Background\x20Character\x20Activity','\x0a\x0a##\x20世界书:\x20','#\x20对话示例\x0a','myAvatarLibrary','poll-question-input','Import\x20World\x20Book','已删除最后一条心声，当前心声已重置。','”发送的、尚未领完的红包（时间戳:\x20','pollTimestamp','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','call-history-back-btn','请输入歌名','preset-actions-modal','close-character-nai-prompts','在此修改，或点击上方按钮使用格式模板...','\x20的红包，金额为\x20','请输入一个有效的URL或选择一个文件！','</div></div>','waimai-order-for-ai-btn','选择一个开场白','[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20','请先输入你的发言内容。','\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22','你已死亡，正在围观...','https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','相册名称','cart-items-list','选中的消息均已收藏过。','”写一篇新日记...','解析格式模板失败:','\x0a#\x20【【【逻辑隔离与TGS三核思考\x20(最高优先级指令)】】】\x0a为了兼顾游戏逻辑和角色扮演，你【必须】在内部为【每一个AI角色】按顺序执行以下“三阶段思考”：\x0a\x0a##\x20阶段1：内部独立思考\x20(Internal\x20Monologue\x20Scratchpad)\x0a(这部分内容【绝对不能】出现在你最终的JSON输出中，这仅供你内部模拟使用)\x0a','upgrade','...\x20[记忆:\x20','has','save-nai-settings-btn','is-voice-message','组件图片已更新！','狼人行动API失败:','未找到相关收藏','video-call-screen','头像框','qzone-nickname','\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://files.catbox.moe/r5heyt.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','副反代地址','相册已成功删除。','select-all-products-checkbox','fillStyle','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20','innerText','douban-detail-comments-list','date','uc_preset','cart-title','帖子详情','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','\x20张图片...','at-mention-item','NPC','.unread-indicator.back-btn-indicator','Memories','<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20','\x20(角色)</label>','werewolf-action-bar','无法找到对应的分享记录或记录已损坏。',')，内容摘要是：“','ended','toLocaleDateString','分享新鲜事...','ServiceWorker\x20注册成功，作用域为:\x20','\x20(本名:\x20','anno_','.sticker-category-tab','Save','right','确认操作','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','chat_','cart-total','已成功加载外观预设：“','清理冗余数据','”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','”]\x20','share-target-modal','.screen','.post-avatar[data-author-id=\x22','记忆链接','startTime','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>','#333','确定要将“','poll','my-group-nickname-group','小时核心议题','\x0a4.\x20\x20**我的人设与社交关系**:\x0a\x20\x20\x20\x20-\x20**人设**:\x20','此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？','创建新聊天','spectator','&id,\x20minimaxGroupId,\x20minimaxApiKey','backgroundColor','》:\x0a','memory-list-container','add-world-book-btn','Search','outgoing-call-screen','npc-name-input','测试生成','favorite-diary-btn','[系统提示：你接受了“','你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','这条动态的原始数据已被彻底清除。','thoughts','my-avatar-upload-input','\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','innerHTML','caller-avatar','\x0a\x0a现在，请开始生成这组备忘录。','\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','.text','AI\x20的下棋指令无效或位置已被占据:','open-sticker-panel-btn','timeupdate','toLocaleString','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>','lyrics-horizontal-pos','cancel-clear-posts-btn','add-song-url-btn','presetId','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20','loader-container','.delete-memory-btn','silent-audio-player','char-album-screen','Warning','压缩完成，新的大小:\x20','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>','仅清空\x20','分片导出\x20(推荐，打包为ZIP，解压每个切片选择增量导入)','confirm-wolf-kill-btn','px)','battery-alert-image','stroke','npc-background-activity-switch','clipboard','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','getVotes','edit-message-btn','voter_name','flex','\x20分钟)，本次独立行动跳过。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','确认合并？','native','cache','请输入CPhone的背景图片URL','删除\x20(','settings-preview-area','stickerCategories','\x20\x0a-\x20**你最近和“','close-call-transcript-btn',')\x20和情景的感知。','qzone-post-item','resolve','https://i.postimg.cc/PqYp5T5M/image.png','】，本名是【','status-bar-battery','data-clear-char-list','qzonePosts','\x20拍了拍我','---\x20','打开预设编辑器时发生严重错误:','dblclick','照片上传成功！','50%','password','chat-name-input','character-select-item','确定要清空当前角色的NAI提示词配置吗？','\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20','link-source-input','keyword-search-input','music','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22\x20style=\x22color:\x20red;\x22>计算出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.waimai-user-actions\x20button','\x20//\x20<--\x20【核心】注入世界书\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','edit-product-btn','⚠️\x20NAI提示词：没有角色，使用系统配置','该预设包含\x20','version','来源网站','(空)','world-book-category-pane','检查完成','Chat\x20Settings','cancel-shopping-settings-btn','wolfKill','douban-comment-input','将清空选定角色的心声和散记历史。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','AI\x20(群聊后台)\x20尝试使用一个不存在的表情:\x20\x22','天亮了。','我已了解风险，确认压缩','file','minimax-group-id','private_user','小红书','https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','你们最近没有有效聊天记录。','ZIP文件内容:','https://i.postimg.cc/90RBDh9K/IMG-6377.gif','\x0a-\x20**你的社交关系\x20(必须参考)**:\x0a','\x0a\x0a其专属的“世界书”也已自动创建并关联。','avatar_name','错误：找不到要转发的原始动态。','image/png','++id,\x20title,\x20lastOpened','border-box','AI已将新群头像命名为：“','确定要删除与\x20\x22','cancel-rule-editor-btn','regenerate-char-memo-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20[','将分类\x20“','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥','++id,\x20chatId,\x20timestamp,\x20customName','找不到匹配的表情','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','已成功将\x20','当前群聊还没有公告哦。','-\x20用户在你们共同所在的群聊中的昵称如下：\x0a','char-qq-screen','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','\x20的备忘录','call-history-title','转发了\x20@','识图优化：正在将时间戳为\x20','80px','sharedHistory','直连失败,\x20尝试使用CORS代理...','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>',',\x20价格:\x20¥','karras','<span\x20style=\x22color:\x20green;\x22>已开启</span>','你拍了拍\x20“','user-speak-btn','.waimai-details-btn','user','[发送了一张图片，描述为：','renderingRules','当前通知版本\x20(','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','角色卡数据无效或缺少\x27name\x27字段。','1girl,\x20best\x20quality,\x20masterpiece,\x20...','npc','animate-like','\x20的身份是：','选中的收藏已被移除。','novelai-switch','borderColor','”。请你回顾一下刚才和\x20“','\x0a\x0a现在，请以“','<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>','AI\x20尚未对您的最后一条消息做出回应，无法重新生成。','[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','setHours','reduce','nai-default-positive','https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>','unreadCount','正在准备\x20','receiver','src','）完成了支付。此订单已关闭，其他成员不能再支付。]','predicate\x20must\x20be\x20a\x20function','\x20的对话','offsetLeft','cancel-douban-settings-btn','📋\x20请求体:','https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','npc-persona-input','minimaxModel','https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','这将从历史记录中【永久抹除】这\x20','secondaryProxyUrl','https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','\x0a#\x20---\x20世界书设定结束\x20---\x0a','cphone-icon-img-','favorite-article-btn','页面跳转','danger-option','remove-global-bg-btn','startDiscussion','https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','mousedown','shiftKey','</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>','currentPage','[系统消息]\x20','主题预设已保存！','https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','实时预览','left','tts-audio-player','blockCooldownHours','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','add-npc-btn','Tutorial','#sticker-binding-chat-list\x20.sticker-binding-checkbox:checked','pat_user','文章内容已复制！','change-frame-btn','(你是第一个发言的人)','profile-thoughts-history-view','昨晚\x20','\x20元。','胜负未分','contact-picker-screen','\x0a\x0a#\x20','\x0a-\x20**\x20你的聊天对象（用户）的人设**:','novelai-details','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','removeChild','[系统提示：\x27','检测到\x20EPhone\x20备份文件，执行标准导入...','转发成功！','isClosed','sendQzoneStickerComment:\x20找不到帖子:','ZIP\x20流生成完毕。','prophetCheck','发布公告','https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','</div>','steps','角色专属','char-taobao-screen','.poll-action-btn','ai-persona','\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>','Edit\x20Entry','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>','\x20条上一轮发送的私信...','chatListRenderWindow','Upload\x20Avatar','group-action-cooldown-input','ᗜωᗜ','variation-selection-modal','):\x20','categories','table','\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20','is-poll','getWriter','.header','home-screen-pages-container','douban-detail-post-title','解析成功：通过强力提取\x20{...}\x20模式。','element','shift','今天\x20','\x20(图片描述:\x20“','Fonts','unreadPostsCount','请为这个头像起个名字（例如：开心、哭泣）','werewolf-finish-speech-btn','表情分类','active','limit','isTemporary','add-new-product-category-btn','https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Create\x20New\x20Rule','\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>','\x27刚刚评论了你的动态“','https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','preset_','删除\x20(0)','chat-settings-screen','分片导出过程中出错:','已阵亡，还有30秒爆炸','书库是空的，点击“导入新书”添加第一本吧！',']。当在对话历史中看到这些名字时，它们都指的是【你】自己。','https://i.postimg.cc/k401K5g7/IMG-7304.jpg','change_remark_name','至少需要保留一条消息。','Delete','\x0a####\x20阶段\x20B：TGS\x20融合思考\x20(Task-Game-Social)\x0a1.\x20\x20**T\x20(Task\x20-\x20游戏任务)**:\x20基于我的身份和秘密，我的【逻辑目标】是\x20(例如：找出狼人\x20/\x20悍跳预言家\x20/\x20隐藏身份\x20/\x20保护队友\x20/\x20攻击','button','-\x20(空)','#\x20角色核心设定\x0a','photo-viewer-close-btn','</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>','(无购买理由)','smea_dyn','alt',')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','\x20点赞了动态]','\x22\x20已经存在了！','fetch-models-btn','群聊\x20\x22','offlineMaxLength','thoughts-history-list','hasShown40','getUint32','catch','<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>','¥\x200.00','\x20位角色的记忆中。','#\x20性格补充\x0a','save-sticker-binding-btn','proxyUrl','delete-selected-products-btn','天\x20-\x20夜晚','translateX(','一位神秘的NPC','请输入新的名称（留空则恢复默认）','\x20的红包','诊断：在\x20data.character_book\x20中找到世界书。','editable-image','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','prophet','✅\x20图片转换成功！🎨','#chat-input-area','\x20(大小:\x20','ephone-language','group-avatar-upload-input','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','group-avatar-library-title','Enter\x20the\x20name\x20of\x20the\x20world\x20book...','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>文件中未找到可合并的数据。</p>','所有音乐源都未能找到歌曲：“','lyricsPosition','qzone-back-btn','scroll','new-product-category-name-input','确定要从播放列表中删除《','”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20你的角色设定\x0a','已成功从\x20Tavern\x20AI\x20文件导入设定集《','btn-danger','short','parse','naiimag','外观设置已保存并应用！','-\x20**与用户的关系**:\x20你和用户(','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','[语音消息:\x20','\x0a\x0a现在，请继续这场对话。\x0a','清空购物车','[表情，含义:\x20','current','Upload','fontFamily','char-qq-conversation-screen','\x27,\x20\x27bulangni\x27,\x20sans-serif','reading-library-list','ceil','update_thoughts','max-memory','frame_tech','\x20(图片描述:\x20\x22','字体预设管理','add-new-npc-group-btn','pointer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Enable\x20NovelAI\x20Image\x20Generation','shopping-action-bar','simulatedMusicPlaylist','contactId','clientX','选择记忆所属角色','确定要将以下消息发布到公告板吗？\x0a\x0a“','\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>','请根据你的设定，生成你的App使用记录。','bulkPut','unread-indicator','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','我通过了你的好友申请，我们现在是好友啦！','notification-avatar','[语音]','commenterDisplayName','https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','pop','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg','cancel-create-countdown-btn','最终正面提示词:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','edit-last-response-btn','图片\x20Blob\x20创建成功，大小:','msgTimestamp','”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《','📁\x20从本地上传','#e4b591','Language','\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20','\x20条红包记录。','rp-details-list','\x22\x20的记忆中清除了1条关于已删除评论的通知。','onloadedmetadata','transcript','\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','translateX(calc(-','main-chat-list-header','收藏成功','chatId','className','件商品','Voice\x20Message\x20Settings\x20(Minimax\x20TTS)','count','top','Publish','\x22(处理后为\x22','variation-product-image','》设定:\x0a','已切换到新的开场故事！','请至少选择一种要清理的数据类型。','world-book-category-select','天黑请闭眼...','ai-avatar-preview','frame_flower','图片内容','\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22','select-all-cart-items','close-category-manager-btn','\x20的外卖订单（时间戳:\x20','...”)','Their\x20Taobao\x20Orders','transcript-entry\x20','.commenter-name','删除消息','chat-list-title','】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','未知的备份类型。','#preset-tabs\x20.world-book-tab','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>','群昵称不能为空！','select-message-btn','handlePacketClick','\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','tagName','currentLyricIndex','chatItem','”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a','错误：尝试打开一个不存在的预设，ID:','请为这个头像起个名字（例如：春日野餐、学习时间）','https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','\x20首歌曲的详细信息...','专属红包:\x20给\x20','📝\x20使用','clear-posts-item\x20selected','Taobao','backgroundImage','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>','delete-current-category-btn','hours','已被用户删除','temp_user_chat_mirror','currentDay','https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','newSize','lineTo','ai-persona-group','https://i.postimg.cc/fycfcvHf/IMG-6569.gif','%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>','member-management-item','https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','Autoplay\x20was\x20prevented\x20by\x20the\x20browser.','AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。','manage-stickers-btn','API设置','href','在打包或写入文件流时发生错误:\x20','novelai-test-modal','”的出行足迹...','product-image-input','不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。','[图片动态]','你已经死亡，无法发言。请等待其他玩家发言结束。','[私聊]','posts','cphone','传统导出\x20(兼容旧版或内存小的浏览器)','getContext','成功将角色\x20','time-zone-group','请先在API设置中配置好（主或副）API以进行总结。','即将开始下载您的完整备份文件。下载过程中请勿关闭页面。','charCodeAt','pageX','通话记录已保存:','选中的商品已成功删除。','touchend','is-realimag','<div\x20class=\x22custom-title\x22>','库加载失败','正在合并单条记录到\x20','管理预设分类','请求添加你为好友','对方拒绝了你的视频通话请求。','persona','callHistory','offsetParent','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','name','nai-steps','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>','bottom','检测到JSON中的非法控制字符，尝试清理并重试...','summaries','existing-group-item','open-shopping-btn','enqueue','聊天记录','undefined','\x0a#\x20用户的角色\x0a-\x20**','transfer-sender-name','existing-npc-groups-list','跳过格式错误的NAI图片Key:','position','npc-editor-modal','#\x20长期记忆\x20(必须严格遵守)\x0a','https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>',')的阅读进度失败:','isDanger','music-player-song-title','stringify','visibility','.nav-item[data-view=\x22qzone-screen\x22]','char-browser-item','shared-history-viewer-content','635clWIcM','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.world-book-tab','》吗？此操作不可撤销。','\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“','上传成功！','正在合并数据，请勿关闭页面...','API\x20Preset\x20Management','\x0a[文字图内容:\x20','transaction','\x0a###\x20条目:\x20','1px\x20solid\x20#e0e0e0','未发现需要迁移的旧红包数据。','Sticker','\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','[你发送了一个表情，意思是：\x27','命名表情','原作者','netease','投票结果','删除表情','bg-btn','openNpcEditor','https://i.postimg.cc/DZshzKv6/IMG-5576.gif','操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20','my-frame-grid','confirm-clear-posts-btn','API\x20错误:\x20','https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','my-persona','werewolf-game-btn','AI方','这是群里的第一条消息。','npc-group-manager-modal','无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20','正在为角色\x20','”的TTS功能已关闭，已禁止发起TTS请求。','chatData',')，问题是：“','listen-together-btn','移出成员','--chat-font-size','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','togglePlayerFullscreen','order','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。','block_user','在这里输入文本...','add','Bearer\x20','编辑条目','手动注入记忆时出错:\x20','发言结束，现在开始投票。','authorId','友善的评论是交流的起点','syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','post-image-preview-container','scrollIntoView','\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。','NPC\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','image_prompt','分组名不能为空！','aiAvatar','编辑对方状态','dataset','isNpc','\x0a你必须严格遵守','未找到该图片的原始提示词(prompt)。','randomJottings','clear','character_persona','contains','\x22\x20记录了一条新回忆:','generativelanguage','ZIP\x20Blob\x20大小:','图片已更新！','来自\x20','”的聊天记录已成功导出！','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','用户删除了自己的评论，开始清理AI记忆...','onpause','https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','AI返回的内容中未找到有效的JSON对象。','\x20回复了你。','正在为角色“','<span\x20class=\x22group-name\x22>','waimai_order','strokeStyle','loadAsync','remove-ephone-bg-btn','my-avatar-preview','secondaryApiKey','regenerate-char-diary-btn','import-single-chat-btn','通话中，','无法为不存在的分类打开绑定模态框:','删除分类后，该分类下的所有商品将变为“未分类”。确定吗？','width','\x20\x20\x20[+]\x20最终正面提示词:','请根据你的设定，开始你的行动。','showRedPacketDetails收到了无效的packet对象','生成模拟足迹失败:','url(','正在重试\x22','88tppOKa','filter','https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','搜索歌曲','\x0a#\x20世界观设定\x20(必须参考)\x0a','✅\x20清理完成！\x0a\x0a','SAFETY','https://i.postimg.cc/KYr2qRCK/1.jpg','blockReason','已成功收藏到“我的收藏”页面！','请先填写NovelAI\x20API\x20Key！','werewolf-selection-item','狼人请睁眼，请选择要刀的玩家。','quote_reply','my-avatar-library-title','未知发送者','Caching\x20rendering\x20rules\x20for\x20chat:\x20','photos','5.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20(','imageUrls','lastActionType','566928TdpNIG','---\x20第\x20','https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','post-visibility-groups','<li>未在此文件中找到可识别的数据。</li>','\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20','linked-chats-checkboxes-container','iVBORw0KGgo','search-history-btn','source_name','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','所有切片已打包，开始流式下载ZIP...','sourceChatName','这是一条群聊语音消息，已禁止发起TTS请求。','preset-editor-title','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“','[ERROR:\x20','blockedTimestamp','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>','create-shuoshuo-btn','compress-images-btn','应用已切换到后台，记录当前时间。','【AI角色】',')\x20成功抢到了\x20','（无有效对话记录）','空间设置','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x0a建议刷新页面以确保所有更改生效。','（当前帖子还没有路人NPC发表评论。）\x0a','**:\x20关于\x20**','请先填写对应的反代地址和密钥','请先配置NovelAI\x20API\x20Key！','251592KTnryP','群里在','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**','my-nickname-input','reset-character-nai-prompts-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22','<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','Rendering\x20Rules','渲染聊天项\x20[','product-name-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','text-image-mode-content','确定发布','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://image.novelai.net/ai/generate-image','找不到原始消息。可能已被删除或位于更早的历史记录中。','\x20个表情包，且无法恢复！','hiddenContent','npc-list','change_music','\x20被刀了','确认抹除','group_summary_from_','message-actions-modal','favorite-memo-btn','NovelAI\x20模型','为什么','<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>','https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked','world-book-editor-screen','\x20之间的有效数字。','”的头像库','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','请输入新的图片URL','douban-cast-modal','.info','https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif','favorite-item-card','#char-chat-list\x20.chat-list-item','load-more-qzone-btn','.photo-thumb','https://generativelanguage.googleapis.com/v1beta/models','请输入一个有效的图片URL！','recall-message-btn','noneOf',')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a','已取消收藏。','目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20','api-key','\x0a-\x20**人设**:\x20','link-description-input','userStickers','douban-wait-reply-btn','force-apply-check-btn','\x22\x20class=\x22avatar-frame\x22></div>','confirm-delete-world-books-btn','onload','.pagination-dot','recalled_message','browser-content','confirmButtonClass','用户\x20(','char-diary-screen','你们的对话刚刚还在继续。','currentIndex','绑定范围','保存主题预设','write','请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。','stickerId','hiddenText','”\x20将备注修改为\x20“','\x22\x20data-poll-timestamp=\x22','未知书籍','secondaryModel','https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','totalBalance','-\x20**当前歌词**:\x20\x22','请输入有效的金额(必须大于0)！','.chat-list-item[data-chat-id=\x22','rp-tab-direct','rgba(0,\x200,\x200,\x200.4)','https://i.postimg.cc/63NmX03s/IMG-4366.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','memories','typeId','image/jpeg','music-play-pause-btn','chat-list-screen','清理后仍未找到JSON数组。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','删除分组后，该组内的好友将变为“未分组”。确定要删除吗？','</textarea>','transfer-btn','一些之前的消息已被用户删除。','复制失败','group-background-activity-switch','\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。','\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a-请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20',';\x22>','replyToDisplayName','gap','女巫请睁眼。','Douban','<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>','rule-editor-modal','read-together-btn','https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','isBgClear','收到\x20SSE\x20数据，大小:','你刚刚接听了用户的视频通话请求。','转账给\x20','borderRadius','\x20.message-bubble\x20$1','albumId','world-book-entries-container','查看失败','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','keys','chargingchange','status-bar-visible','onchange','\x0a#\x20【格式铁律\x20(最高优先级：常规模式)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，即\x20`offline_text`\x20对象。\x0a2.\x20\x20**【【【绝对禁止】】】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回\x20\x22naiimag\x22\x20对象。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回纯文本（即没有JSON包装的文字）。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】在JSON数组前后添加任何\x20markdown\x20标记\x20(如\x20```json)。\x0a3.\x20\x20**【输出示例\x20(必须遵守)】**:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22offline_text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22「这是对话内容」...\x20(这里是动作和环境描写)...\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a4.\x20\x20**【内容风格\x20(offline_text)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','nai-smea-dyn','product-variations-container','对方消息预览','borderBottom','扫描动态失败:','API格式不正确，角色\x20\x22','确认压缩图片？','\x0a-\x20散记:\x20','确认拉黑','addEventListener','shopping-settings-btn','https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','accept','已成功导出所有数据！','display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;','https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','NPC\x20Persona','span','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','renderWorldBookScreenProxy','确定切换','Export\x20Data','showScreen','copy-diary-content-btn','\x20天\x20---**\x0a','\x20-\x20','预言家请睁眼，请选择要查验的玩家。','[图片]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”，选项有：[','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','总结长期记忆时出错:','”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20的已删除动态','请输入群聊的名字','聊了关于生日派对的事，我们约好了10月1日见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a','auto-memory-interval','reply_content','图片格式处理失败:\x20','music-prev-btn','forEach','编辑时重新生成NAI图片失败:','找不到表:\x20','voteResults','lastIndex','quality_toggle','.clear-posts-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22','请输入头像的图片URL','api-preset-select','https://i.postimg.cc/50k390X8/IMG-6376.gif','https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','✅\x20NAI图片生成成功！','create-poll-modal','regenerate-call-btn','网络图片\x20(CPhone)','生成第','products','\x0a#\x20当前五子棋局势\x0a','等待回复','编辑规则','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>正在计算可压缩图片大小...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>--\x20MB</span>\x0a\x20\x20\x20\x20',')\x20试图将群名更改为成员名\x20(\x22','status_text','Amap','成员们正在输入...','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。','save-product-btn','https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','维基百科','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“','API\x20Temperature','请至少选择一个要清理的角色。','请输入有效的URL。','预言家已行动，预言家请闭眼。','timeZone','这个预设文件中没有找到任何有效的提示词条目。','margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','我们的群聊','确定要从你的头像库中删除“','memory-screen-back-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','is-gift','\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a','repost-cancel-btn','名为\x20“','char-wallet-back-btn','maxMemory','music-visual-container','https://i.postimg.cc/T2yKJ0DV/40.jpg','.cart-item-checkbox:checked','save-api-settings-btn','nai-result-image','exclude','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','”移出群聊吗？','getAttribute','<br>','创建旁观群聊\x20(我围观)','https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','”的长期记忆少于2条，无需进行精炼。','cors','data:\x20[DONE]','\x20元。]','link-title-input','豆瓣设置已更新！下次重新生成时将生效。','character_thoughts','此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。','\x20位AI角色的长期记忆中！','请输入提示词！','character-phone-screen','nai-uc-preset','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','请输入EPhone主屏幕的背景图片URL','高级数据清理失败:','\x20\x20\x20characterPositivePrompt:','API\x20调用失败','*事件*:\x20','chat_message','https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','favorite','.post-mode-switcher','”。请你回顾一下你和“','\x22\x20data-memory-timestamp=\x22','有点饿了，可以去找充电器惹','actionCooldownMinutes','appName','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','classList','图片加载中，请稍后重试','https://i.postimg.cc/wx72fhr2/IMG-5968.gif','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','🎬\x20推进剧情','\x0a\x0a#\x20供你参考的信息\x0a','isActive','成功导入\x20','myAvatarFrame','小时前聊过。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','chatRenderWindow','存储空间优化','save-wallpaper-btn','bubble_theme','\x20\x20\x20\x20-\x20我没有掌握任何特殊的夜晚信息。\x0a','phone-screen','CELL_SIZE','offline-max-length-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','bg-preview','currentPlayer','selection-cancel-btn','AI\x20Block\x20Cooldown\x20(hours)','primaryKeys','正在合并非标对象到\x20','stickerMeaning','paidBy','shared-history-viewer-modal','image_url','simulatedAmapHistory','char-diary-detail-title','请根据角色列表，生成豆瓣小组帖子。','arc','iconId','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','\x0a\x0a现在，请做出你的决定。','level','<div\x20class=\x22source\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','favorites','[语音]\x20内容:\x20\x22','主API设置\x20(用于聊天)','\x20(这是你的帖子)','padEnd','#chat-interface-screen\x20>\x20.header','textAlign','playMode','commentsCount','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','5px','已拒收对方转账','doubanActiveCharacterIds','gomoku_move','https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','ArrowRight','https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','single','无法重新生成图片:\x20','.format-btn','placeholder.png','Minimax\x20TTS\x20API\x20调用失败:','selective-import-list','https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','\x20(用户)**:\x20','custom-bubble-style','EPhone-Full-Backup-','existing-sticker-categories-list','https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','#text-image-mode-content','postTitle','inject-thought-toggle','规则名称','解析AI返回的JSON时出错:\x20','column','将清空选定角色的所有对话消息、曾用备注和你的昵称。','content','setItem','-\x20**昵称:\x20','input:checked','isGameOver','post-image-preview','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22sticker-binding-checkbox\x22\x20data-chat-id=\x22','minimaxGroupId','90poHxEJ','✅\x20图片显示成功！🎨','char-amap-screen','检测到并成功修复了\x20','https://api.vkeys.cn/v2/music/netease?word=','zh-CN','music-search-results-modal','purchases','**:\x20','请输入网络图片的链接','group-avatar-library-modal','\x0a-\x20**可以刀的玩家列表**:\x20','AI投票决策API失败:','456959mClzYk','confirm-create-poll-btn','cancel-post-action-btn','\x20死亡了。','shared-history-viewer-title','characterId','globalSettings','预言家','usageTimeMinutes','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','statusText','#music-lyrics-container\x20#music-lyrics-list','npc-avatar-preview','douban-post-item','<input\x20type=\x22checkbox\x22\x20value=\x22book_','mouseup','stopPropagation','orderBy','items','状态已更新','图片解压失败:\x20','open_red_packet','分组\x20\x22','legacy','character-nai-negative','favorites-delete-selected-btn','send-group-packet-btn','input[name=\x22variation-select\x22]:checked','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','...\x22)','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','正在发牌...','https://i.postimg.cc/43PhvxRq/IMG-6922.gif','last','一键压缩本地图片','input[name=\x22visibility\x22]:checked','currentPlaylist','导出世界书时出错:','\x20其中包括以下投票：','minimax-model-select','dynamic-font-style','\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员2\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20','的设定集','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22','预设名称','Moments','导入世界书时出错:','.product-item','Erase','manage-preset-categories-btn','流式导出过程中出错:','{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20','更新通知文件中缺少\x20data-version\x20属性。','commenter','parentNode','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20你的首要任务是检查“待处理的帖子列表”。如果列表中有你可以回应的帖子（特别是那些有新评论或提到你的），你【必须】优先进行评论或回复，而不是发布新动态。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20','【完全导入】将删除您当前的所有数据并替换为备份文件中的内容。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','identifier','world-book-name-input','\x0a##\x20世界书《','album-photos-back-btn','globalCss','save-world-book-btn','.lyric-line','长截图生成失败:','你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','message-wrapper\x20','lastMemorySummaryTimestamp','<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20','char_memo','请输入一个有效的页码！','myAvatar','default_positive','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>本地图片(头像/表情/头像框/等)大小:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22><strong>','stream','system','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>','clear-posts-item','pat_message','.qzone-post-container[data-post-id=\x22','data-clear-step-2','base_resp','gift-receipt-body','notification-sound-player','当前页内容摘要','werewolf-log','发送语音','check-and-fix-data-btn','加载失败','将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。','无标题','API\x20Settings','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>','内容条目','relative','group_call_response','✅\x20检查完成，未发现任何冗余数据。','preventDefault','”思考后决定暂时不发送好友申请，将重置冷静期。','当你死亡时，你可以选择带走场上任意一名玩家。','object','要为《','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','”\x20的预设已存在。要覆盖它吗？','游戏结束','https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','🖼️\x20[NAI下载]\x20检测到三击NAI图片','album-photo-input','https://i.postimg.cc/jCVK0fGL/IMG-6890.gif','\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','text','lyrics-active','%\x20+\x20','random_jottings','categoryId','\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20[','decline-call-btn','edit-post-btn','#data-clear-char-list\x20.clear-posts-item.selected','preview-bubble-style','\x20个新头像！','提示词配置','renderWallpaperScreenProxy','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','文件不是一个有效的PNG。','确认删除','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“','char-main-date','https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20','custom-user-font','未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。','Test\x20Generation','inline-flex','[系统提示：','\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a','请输入一个有效的、未来的日期！','https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','import-btn','”\x20已成功导入！','聊天会话','char-simulated-send-btn','<span\x20class=\x22commenter-name\x22>','switchToMyPhone','指定的数据已成功清除。','AI\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','Hello\x20World\x20你好世界','preset-avatar-input','guard','modern\x20app\x20icon\x20for\x20','members','https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','合并成功','请输入有效的正整数！','未找到\x20chatID:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','notification-sound-url-input','announcement-actions-modal','enableAiDrawing','startY','rp-group-count','NPC行动失败：API未配置。','💾\x20[专属弹窗]\x20保存角色NAI提示词','qzone-sticker-grid','++id,\x20name,\x20type','-\x20**对话状态**:\x20上次互动于\x20','cancel-wolf-kill-btn','photoCount','target','visibilityState','自定义数量...','\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>','setup','announcement-item-actions','删除评论','packetType','无法解析角色卡文件。\x0a错误:\x20','\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“','\x22><div\x20class=\x22title\x22>','douban-min-posts-input','导入成功！','\x27);\x22','编辑人设预设','\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a','variation-product-name','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','video_call_response','shoppingCategories','按钮顺序已恢复为默认设置！','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>','target_timestamp','警告：表\x20\x22','.link-share-card','\x20首歌曲...','”)下发送了一个表情评论，意思是：“','\x22\x20data-category-id=\x22all\x22>全部</button>','char-music-progress-fill','#douban-cast-list\x20.douban-cast-checkbox:checked','douban-screen','正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...','full','add-ai-avatar-upload-btn','.status-text','contentLines','创建新聊天\x20(第2/2步)','数据库写入失败:\x20','Reply\x20to','nai-smea','speaking','已成功加入购物车！','保存外观预设','请输入预设名称','main','post-actions-modal','https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','AI生图功能已','.post-deleted-placeholder','https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','Model','readAsText','cart-item-checkbox','character_book','<span\x20class=\x22diary-emphasis\x22>$1</span>','未发现任何需要修复的数据问题。','<span\x20class=\x22offline-dialogue\x22>','\x22\x20的本次后台活动跳过。原始回复:','npcId','outgoing-call-avatar','\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>','manage-products-btn','\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','<span\x20class=\x22group-tag\x22>群聊</span>','已成功收藏\x20','album-photos-title','rp-details-summary','css-preset-select','send-waimai-request-btn','.variation-image-input','https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','post-actions-btn','favoritedPostIds','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>','targetId','Messages','正在准备分片导出...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20','https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','findLast','chat-list-bottom-nav','https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','尝试直接作为图片显示...','group-management-modal','\x0a#\x20群成员列表\x20(你的总结目标)\x0a','char-usage-screen','当前为渐变色','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','close-novelai-settings','speaker','update-notice-dismiss-btn','product-editor-title','isHidden','a\x20beautiful\x20scene','https://api.vkeys.cn/v2/music/netease?id=','打包中...','https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','time-zone-select','\x22\x20(用户)\x20或\x20\x22','https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','正在打包表:\x20','time-zone-search-input','找不到这个预设的详细信息。','正在检查\x20','select-all-recipients','.delete-btn','未知NPC','#data-clear-type-list\x20.clear-posts-item.selected','[data-lang-key]','🌐\x20使用网络URL','call-message-bubble\x20user-speech','favorites-view','TA的想法...','click','”申请好友时发生错误：\x0a\x0a','”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a4.请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','确认精炼','\x20\x20\x20\x20-\x20我的解药：','lrc','ai-response-editor-modal','offsetTop','flex-start','”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20','gift-recipient-list','background-activity-switch','latestTimestamp','现在，请所有AI角色针对刚刚的发言（特别是\x27','群聊已建立...','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>','\x22\x20placeholder=\x22','死亡了','\x20的动态\x20(NPC)','纯音乐，请欣赏','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20红包已被领完，手气王是\x20','loadedmetadata','utf-8','shoppingProductCount','Preset\x20Name','offline-preset-select','imageProcessed','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','，跳过...','清理冗余数据时出错:','character-selection-screen','\x0a#\x20世界观\x20(必须严格遵守)\x0a','cancel-reply-btn','精炼完成，请确认','cursor','address','确定要删除预设\x20“','product-price-input','setDate','\x0a\x20\x20\x20\x20-\x20**书名**:\x20《','其他人的发言','publish-to-announcement-btn','》吗？此操作将同时删除相册内的所有照片，且无法恢复。','value','备注名/群名不能为空！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...','导入世界书','https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','\x0a\x20\x20\x20\x20-\x20**今日讨论**:\x20','frame-item','”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','Compress\x20Local\x20Images','douban-detail-group','.lyric-line[data-index=\x22','qzone-screen','https://i.postimg.cc/3NDQ0dWG/image.jpg','-modal','群聊中没有成员有足够（2条以上）的记忆可供精炼。','currentVoiceId','删除世界书失败:','https://generativelanguage.googleapis.com/v1beta/models/','activeChatId','douban-detail-author','share-location-btn','charging','fileType','正则表达式格式错误:\x20','char-memo-detail-screen','EPhoneWorldBookBackup','此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>','contact-picker-item','getItem','字体设置','关于“','map','ai_image','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥','save-appearance-preset-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','span:first-child','在这里输入语音内容...','正在执行...','video_call_request','还没有人','最后确认！','ai-avatar-upload-input','https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','height','角色专属NAI提示词已保存！','repost','已选\x20','在导演模式中发现一个无效的片段\x20(来自parseAiResponse的文本回退):','Category','\x20中聊天','import-new-book-btn-header','add-ai-avatar-batch-btn','”。\x0a','#npc-association-list\x20input:checked','群里还没有任何消息。','Edit\x20World\x20Book','已使用','character-nai-prompts-modal','waimai-product-info','正在等待AI角色们进行激烈的讨论...','werewolf-game-over-reason','\x20\x20\x20\x20\x20\x20-\x20我在此次游戏中没有特别的社交关系。\x0a','shopping-screen','使用\x20browser-image-compression\x20压缩失败:','Share','压缩完成！','游戏开始','群里已经安静了\x20','已删除最新心声，当前心声已回滚至上一条。','📸\x20动态NovelAI图片生成开始，共','https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','contact-picker-list','werewolf-game-title','[收到一个外卖代付请求]','检测到好友申请待处理状态，为角色\x20\x22','bulkAdd','</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','my-frame-tab','Image\x20Generation\x20Settings','friend_request_response','\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','请填写完整的约定标题和日期！','hang-up-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22','offline-mode-options','confirm-hunter-shot-btn','-\x20\x20\x20**NovelAI真实图片分享\x20(在聊天中直接发送)**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20-\x20**【绝不能暴露是novelai生成的图片！】\x0a\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20-\x20使用场景：当你想要在【私聊对话中】直接给用户发送一张图片时使用。\x0a\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。\x0a\x20\x20\x20\x20-\x20注意：这会直接在聊天记录中显示图片，而不是发布到动态。','rp-direct-amount','Secondary\x20API\x20Key','list-item','publicText','product-category-tab','create_countdown','主API和副API均未配置或配置不完整。','\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20','https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','\x20\x0a-\x20**你们最后的对话**:\x0a','\x20(回复\x20','chat-interface-screen','https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','#4CAF50','ai-original-name-group','shoppingProducts','请先选择角色','[发送了一张图片，描述为：\x27','<div\x20class=\x22rp-claimed-info\x22>已被\x20','切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？','，我们一起见证了这个约定。','auto','boxSizing','部分导入失败','\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>','HTML\x20Template\x20(use\x20$1,\x20$2)','生成的图片URL:','character-nai-positive','resolution','horizontal','AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','favorites-edit-btn','10px\x2015px\x2020px\x2015px','https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','昨晚是平安夜','\x20为你切歌:\x20《','正在导入表:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20','头像框已保存并同步！','\x20条记录到\x20','\x20票</span></div></div>','手慢了','批量导入头像','isAwaitingResponse','world-book-screen','最近\x20100\x20条','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>','\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','reply-preview-bar','删除头像','profile-main-content','https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif',';\x20font-style:\x20italic;\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','groupAvatarLibrary','save-persona-preset-btn','lyric','创建普通群聊\x20(我参与)','world-book-tab','is-sticker','在这里输入语音内容','<button\x20class=\x22sticker-category-tab\x20','送出礼物','请输入新的封面图片链接','无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20','import-appearance-input','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','custom-modal-title','transform','\x22\x20style=\x22max-width:\x20100%;\x20border-radius:\x208px;\x20box-shadow:\x200\x204px\x2010px\x20rgba(0,0,0,0.1);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','exec','global-css-input','offlinePresetId','等待对方处理...','date-search-input','char-music-next-btn','.message-bubble','add-new-group-btn','.werewolf-player-checkbox:checked','未知成员','-\x20**当前时间**:\x20','</p>','https://i.postimg.cc/fRTF24jS/IMG-4430.gif','commentIndex','[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]',')\x20作者:\x20','secondary-model-select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','chat-lock-content','昨晚是平安夜。','onerror','save-npc-btn','.frame-grid','\x22)\x20在播放列表中未找到。','\x20.message-bubble.user\x20$1','</td><td\x20class=\x22item-price\x22>¥','https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','导演/编辑模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','）刚刚撤回了一条消息。撤回前的内容是：','书名不能为空！','文件解析或应用失败:\x20','https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','\x22\x20not\x20found.\x20Defaulting\x20to\x20\x27zh-CN\x27.','\x22）。你已经有一段时间没有和用户（','assign-group-section','导演/编辑模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a','sort','image_post','is-location-share','itemName','编辑动态','background-interval-input','\x22\x20data-commenter-display-name=\x22','\x0a**---\x20第\x20','spectator-propel-btn','douban-post-detail-screen','https://api.vkeys.cn/v2/music/tencent?id=','.nai-gallery-item.selected','</persona>\x0a</character>\x0a','char_diary','message-bubble\x20system-bubble','werewolf-','entries','</persona>\x0a\x20\x20<memory>',':generateContent?key=','无效链接:\x20','typing-indicator','\x22\x20的本次后台活动跳过。','请至少选择一个要分享的聊天。','offline-mode-toggle','isMinimized','配置错误','动态内容已复制到剪贴板。','https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','next','https://i.postimg.cc/g2XykNGB/IMG-4727.gif','chat-settings-btn','\x20---\x0a','<span\x20class=\x22spoiler\x22>$1</span>','post-image-desc-group','chatActionButtonsOrder','upload-image-btn','解析AI返回的投票JSON时出错:\x20','最近\x2050\x20条','\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a','\x22\x20决定去发一条动态...\x20(此处为模拟)','API设置不完整，无法继续。','cphone-icon-settings-grid','global_css','》\x0a-\x20**发帖人**:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','\x20个条目。','equals','https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','enableAutoMemory','template','product-grid','Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined','frame_12','[系统提示：用户\x20(','json','Footprints','.sender','\x20的红包已被领完','model-select','张NovelAI图片:\x20','<span>已</span><span>超</span><span>时</span>','block-cooldown-input','douban-detail-content-wrapper','》\x0a\x20\x20\x20\x20-\x20**','你们在','transform\x200.15s\x20ease','\x20条内容吗？','清空所有动态\x20(危险)','custom-css-input','高级数据清理','\x20\x20\x20\x20-\x20我的毒药：','likes','nai-diffusion-4','my-group-nickname-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','status-bar-time','请所有AI角色根据你们的身份和人设开始发言。','close-product-category-manager-btn','确认总结','https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','(AI返回了空内容)','isDeleted','scrollTop','nai-sampler','createDocumentFragment','请输入歌手名','Secondary\x20Proxy\x20URL','history','\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','qzone-banner-container','\x20(最后互动于\x20','#listen-together-btn\x20img','狼人请选择刀人对象','.playlist-item-info','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发私信\x20(给用户)**:\x20`{\x22type\x22:\x20\x22send_private_message\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22recipient\x22:\x20\x22','nai-custom-proxy-url','#f44336','selection-soft-delete-btn','1056760IaOqeM','gomoku-overlay','Manage','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20身份与核心任务\x0a你正在扮演角色“','\x20MB</strong></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','播放已暂停','waimai_request','paid','对方撤回了一条消息','focusout','htmlFor','remove-cphone-bg-btn','<p>♪\x20暂无歌词\x20♪</p>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22font-size:\x2012px;\x20color:\x20#ff8c00;\x20margin:\x204px\x200\x200;\x22>(注意:\x20这将【覆盖】您当前的设置)</p>','favid','cover','已成功删除\x20','close-reading-library-btn-header','）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。','投票结果：','save-api-preset-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','checked\x20disabled','data-clear-wizard-modal','appIcons','直连失败','red-packet-details-modal','photo-viewer-next-btn','启用\x20NovelAI\x20图像生成','enableBackgroundActivity','cancel-call-message-action-btn','导入\x20Tavern\x20预设','postType','”的特点生成专属商品...','输入消息...','songName','150','请开始总结。','swipeDirection','\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a','Status','translateY(0)','add-my-avatar-upload-btn','\x27的发言）继续进行讨论。','[系统提示：用户(','请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a','Delete\x20(Notify\x20AI)','\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','在角色\x20\x22','**:\x20\x22','所有图片都下载失败了。这通常是由于网络问题或CORS跨域限制（请检查API设置中的CORS代理是否有效）。','Done','\x22\x20(大小:\x20','分享的聊天记录已损坏。','avatar_prompt','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','tencent','price','update','https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','qzone_like','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','...\x22','cancel-delete-world-books-btn','分钟前','视频通话请求','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','nai-gallery-grid','++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','save-advanced-editor-btn','end','在执行组合操作时遇到错误:\x20','https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','sticker-category-tab','rp-content-group','.message-editor-block','【重要提示】','savedId','isGroupCall','reading-content','probability','updateListenTogetherIconProxy','（无文字内容）','post-remove-image-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','正在接收流式数据...','Send','.sticker-item[data-sticker-id=\x22','是狼...”)\x0a\x20\x20\x20\x20-\x20(例如：我的敌人发言了，我的表演就是无视TA的逻辑，直接攻击TA。)\x0a\x20\x20\x20\x20-\x20(例如：我是一个','masterpiece,\x20best\x20quality,\x201girl,\x20beautiful,\x20detailed\x20face,\x20detailed\x20eyes,\x20long\x20hair,\x20anime\x20style','AI\x20(CPhone)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','default_negative','discussionLog','https://image.novelai.net/ai/generate-image-stream','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','music-progress-fill','removeItem','》吗？\x0a\x0a【【【警告】】】\x0a此操作将同时永久删除该分类下的\x20','API\x20返回错误:\x20','note','custom','\x22\x20转发了动态\x20#','book-upload-input','random','<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','备忘录','✅\x20[NAI下载]\x20三击下载功能已初始化','<p>','当前时间是\x20','add-product-variation-btn','api-temperature-slider','-\x20用户的QZone昵称是\x20\x22','cphone-wallpaper-upload-input','---\x20狼人杀对局完整复盘\x20---\x0a\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a','正在为所有AI角色生成并注入游戏记忆...','#nai-gallery-grid\x20.nai-gallery-item','message-editor-modal','char-music-current-time','streamSaver',';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20','close-sticker-category-manager-btn','https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','猎人死亡，请选择一名玩家带走！','图片压缩过程中发生错误:','文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。','\x20分享了Ta的位置：\x27','GRID_SIZE','\x22\x20创建了一个新约定:','gbk','诊断：在\x20extensions.character_book\x20中找到世界书。','Http_Get_External','group','\x20的礼物','</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>','reset-nai-settings-btn','Article','压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...','\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a','join-call-btn','<span\x20style=\x22color:\x20green;\x22>运行中</span>','</div><div\x20class=\x22transfer-note\x22>','senderName','preset-entries-container','完全导入失败:','\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你【不是】一个单纯的游戏玩家，你是一个【有感情、有记忆、有社交关系】的角色。你在游戏中的所有发言和行为，都【必须】首先符合你的人设以及你与其他玩家的既有关系。\x0a-\x20**朋友**:\x20如果你和某个玩家是朋友，你应该在发言时倾向于保护TA，为TA的发言寻找合理解释，除非有确凿的证据。\x0a-\x20**敌人/情敌**:\x20如果你和某个玩家有矛盾，你可以借机在游戏中攻击TA，质疑TA的发言，甚至在你是狼人时优先刀掉TA。\x0a-\x20**恋人/暗恋对象**:\x20你会无条件地信任TA，保护TA，甚至愿意为TA牺牲。\x0a你的社交关系比游戏本身的胜负更重要！\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20','nai-gallery-action-bar','\x20个会话中。','upload-custom-frame-btn','paused','下载失败，请重试','100','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>正在计算...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22>--</span>\x0a\x20\x20\x20\x20','\x20发布)\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','.nai-regenerate-btn','张图片，prompt:','\x0a-\x20**这是你们最近的对话历史**:\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22','disabled','\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>','chatLinks','原始消息已删除或不存在','你好世界\x20Hello\x20World','negative','save-shopping-settings-btn','退款给\x20','https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','background','banner','groupName','global-custom-style','请在此处粘贴完整的LRC格式歌词...','theme-toggle-switch','minimaxApiKey','\x20(概率:\x20','\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。','werewolf-role-reveal-list','守卫请睁眼，请选择要守护的玩家。','include','songs','includes','Chat\x20List\x20Batch\x20Load\x20Count','theme-default','async','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>','GBK\x20解码成功。','\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“','frame_14','frame_cat_ear','选中的表情已成功删除。','back-to-list-btn',')，开始总结...','pat-btn','.call-record-card','<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>','copy-message-btn','chat-header-status','collapsed','确定要删除《','📤\x20发送请求到\x20NovelAI\x20API','is-card-like','artist','char-album-grid','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>','currentText','isEnabled','CSS\x20预设已保存！','payload','获取AI投票决策失败:\x20','\x0a\x0a将重置冷静期。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>','participantId','狼人数量已达到胜利条件，狼人阵营获得了胜利！','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>'];_0x4cec=function(){return _0x2b0bcc;};return _0x4cec();}const GEMINI_API_URL=_0x5770af(0xf1e);function getRandomValue(_0x143666){const _0x2f15e2=_0x5770af;if(_0x143666[_0x2f15e2(0x138a)](',')){const _0x4e38e6=_0x143666['split'](',')[_0x2f15e2(0x11c6)](_0x58f1e3=>_0x58f1e3[_0x2f15e2(0x97e)]()),_0x478f1d=Math[_0x2f15e2(0x5f8)](Math[_0x2f15e2(0x1337)]()*_0x4e38e6['length']);return _0x4e38e6[_0x478f1d];}return _0x143666;}function isImage(_0x1712c1){const _0x2df4b8=_0x5770af;if(_0x1712c1[_0x2df4b8(0x1014)]&&_0x1712c1[_0x2df4b8(0x1014)][_0x2df4b8(0x6d1)]){let _0x3c3653=_0x1712c1['image_url']['url'];const _0x272e5a=_0x3c3653[_0x2df4b8(0xa8a)](',')[0x1],_0x86d497=_0x3c3653[_0x2df4b8(0x49a)](/^data:(.*);base64/)[0x1];return[{'text':_0x2df4b8(0x1dc)},{'inline_data':{'mime_type':_0x86d497,'data':_0x272e5a}}];}return[];}function getGeminiResponseText(_0x4de954){const _0x137007=_0x5770af;if(_0x4de954[_0x137007(0x8cd)]&&Array[_0x137007(0x624)](_0x4de954['choices'])&&_0x4de954[_0x137007(0x8cd)][_0x137007(0x9a1)]>0x0&&_0x4de954['choices'][0x0][_0x137007(0x13bc)]&&_0x4de954['choices'][0x0][_0x137007(0x13bc)][_0x137007(0x1047)])return _0x4de954[_0x137007(0x8cd)][0x0]['message'][_0x137007(0x1047)];if(_0x4de954[_0x137007(0x84d)]&&Array[_0x137007(0x624)](_0x4de954[_0x137007(0x84d)])&&_0x4de954[_0x137007(0x84d)][_0x137007(0x9a1)]>0x0&&_0x4de954['candidates'][0x0]['content']&&_0x4de954[_0x137007(0x84d)][0x0][_0x137007(0x1047)]['parts'])return _0x4de954[_0x137007(0x84d)][0x0][_0x137007(0x1047)]['parts'][0x0][_0x137007(0x10ca)];console[_0x137007(0x1518)](_0x137007(0x87d),_0x4de954);let _0x1b618c=_0x137007(0x4b7);if(_0x4de954[_0x137007(0x84d)]&&Array[_0x137007(0x624)](_0x4de954[_0x137007(0x84d)])&&_0x4de954[_0x137007(0x84d)][_0x137007(0x9a1)]>0x0&&_0x4de954[_0x137007(0x84d)][0x0][_0x137007(0x92d)]===_0x137007(0xec1)){const _0x3ae446=_0x4de954[_0x137007(0x84d)][0x0][_0x137007(0x29e)],_0x1f75d3=_0x3ae446['filter'](_0x36ef87=>_0x36ef87['probability']!==_0x137007(0x3d0)&&_0x36ef87[_0x137007(0x1320)]!==_0x137007(0x861))['map'](_0x4e625f=>_0x4e625f['category']+_0x137007(0x1383)+_0x4e625f['probability']+')')[_0x137007(0xbad)](',\x20');_0x1b618c='内容因安全策略被屏蔽。触发类别:\x20'+(_0x1f75d3||'未知');}else{if(_0x4de954[_0x137007(0xba5)]?.['blockReason']){const _0x350b8f=_0x4de954['promptFeedback'][_0x137007(0xec3)],_0x58953c=_0x4de954['promptFeedback'][_0x137007(0x29e)]?.[_0x137007(0x11c6)](_0x2bfdf8=>_0x2bfdf8[_0x137007(0x506)]+':\x20'+_0x2bfdf8[_0x137007(0x1320)])['join'](',\x20');_0x1b618c='内容因安全策略被屏蔽\x20(原因:\x20'+_0x350b8f+_0x137007(0x1484)+(_0x58953c||'无');}else _0x4de954[_0x137007(0x1518)]&&(_0x1b618c=_0x137007(0x824)+_0x4de954[_0x137007(0x1518)]['message']);}throw new Error(_0x1b618c);}document['addEventListener'](_0x5770af(0x980),()=>{const _0x475790=_0x5770af;document[_0x475790(0xf79)](_0x475790(0x3e2),()=>{const _0x41e817=_0x475790;document[_0x41e817(0x1105)]===_0x41e817(0x149d)&&(console[_0x41e817(0x415)](_0x41e817(0x6dc)),navigator[_0x41e817(0x547)]['ready'][_0x41e817(0x333)](_0x2c2511=>{const _0x3c4e65=_0x41e817;_0x2c2511[_0x3c4e65(0x130a)]();}));});function _0x4fff3d(_0x4d090d,_0x3d2b76,_0x456ac5,_0x440fb8){const _0x246b38=_0x475790,_0x5f0189=_0x28f30a[_0x246b38(0x1062)][_0x246b38(0x294)]||0.8,_0x1b94d2={'user':'user','assistant':_0x246b38(0x2bf),'system':'user'},_0x1aec7e=[{'role':_0x246b38(0xcc9),'parts':[{'text':_0x456ac5}]},{'role':_0x246b38(0x2bf),'parts':[{'text':'好的，我明白了。我会严格遵守以上所有规则和设定。'}]},..._0x440fb8[_0x246b38(0x11c6)](_0x3c8d0b=>{const _0x346392=_0x246b38,_0x16bb31=[];return Array[_0x346392(0x624)](_0x3c8d0b[_0x346392(0x1047)])?_0x3c8d0b[_0x346392(0x1047)][_0x346392(0xf99)](_0x204b38=>{const _0x11d705=_0x346392;if(_0x204b38[_0x11d705(0xb4b)]===_0x11d705(0x10ca))_0x16bb31[_0x11d705(0x367)]({'text':_0x204b38[_0x11d705(0x10ca)]});else{if(_0x204b38[_0x11d705(0xb4b)]==='image_url'&&_0x204b38[_0x11d705(0x1014)]&&_0x204b38[_0x11d705(0x1014)][_0x11d705(0x6d1)]){const _0x597c51=_0x204b38['image_url'][_0x11d705(0x6d1)],_0xaafe01=_0x597c51[_0x11d705(0xa8a)](',')[0x1],_0x28ab59=_0x597c51['match'](/^data:(.*);base64/);_0x28ab59&&_0xaafe01&&_0x16bb31[_0x11d705(0x367)]({'inline_data':{'mime_type':_0x28ab59[0x1],'data':_0xaafe01}});}}}):_0x16bb31['push']({'text':String(_0x3c8d0b['content'])}),{'role':_0x1b94d2[_0x3c8d0b[_0x346392(0x9be)]],'parts':_0x16bb31};})];return{'url':_0x246b38(0x11b8)+_0x4d090d+_0x246b38(0x127d)+getRandomValue(_0x3d2b76),'data':{'method':_0x246b38(0x655),'headers':{'Content-Type':'application/json'},'body':JSON[_0x246b38(0xe4d)]({'contents':_0x1aec7e,'generationConfig':{'temperature':_0x5f0189}})}};}const _0x5b9d83=new Dexie('GeminiChatDB'),_0x216ec7=[{'id':'none','url':'','name':'无'},{'id':_0x475790(0x1392),'url':_0x475790(0x102b),'name':'1'},{'id':_0x475790(0x4b2),'url':_0x475790(0xbe8),'name':'2'},{'id':_0x475790(0xddf),'url':_0x475790(0x10c8),'name':'3'},{'id':_0x475790(0xda3),'url':'https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','name':'4'},{'id':_0x475790(0x13ee),'url':_0x475790(0xfb7),'name':'5'},{'id':_0x475790(0x7bd),'url':_0x475790(0xa6e),'name':'6'},{'id':_0x475790(0x14d1),'url':'https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','name':'7'},{'id':'frame_8','url':'https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','name':'8'},{'id':_0x475790(0x1bc),'url':'https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','name':'9'},{'id':_0x475790(0x891),'url':_0x475790(0xf47),'name':'10'},{'id':_0x475790(0x770),'url':_0x475790(0x1a3),'name':'11'},{'id':_0x475790(0x12a0),'url':_0x475790(0x522),'name':'12'},{'id':'frame_13','url':_0x475790(0x996),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0xcf1),'name':'14'},{'id':_0x475790(0x1392),'url':_0x475790(0xbb0),'name':'1'},{'id':_0x475790(0x4b2),'url':_0x475790(0x3e8),'name':'2'},{'id':_0x475790(0xddf),'url':_0x475790(0x7f6),'name':'3'},{'id':_0x475790(0xda3),'url':_0x475790(0xcee),'name':'4'},{'id':'frame_5','url':'https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','name':'5'},{'id':'frame_6','url':'https://i.postimg.cc/05wnd389/IMG-4388.gif','name':'6'},{'id':_0x475790(0x14d1),'url':_0x475790(0xa10),'name':'7'},{'id':_0x475790(0x483),'url':_0x475790(0x7a3),'name':'8'},{'id':_0x475790(0x1bc),'url':'https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','name':'9'},{'id':_0x475790(0x891),'url':'https://i.postimg.cc/XY63sTS3/IMG-4393.gif','name':'10'},{'id':'frame_11','url':'https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif','name':'11'},{'id':'frame_12','url':_0x475790(0x4ab),'name':'12'},{'id':_0x475790(0x2cd),'url':'https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','name':'13'},{'id':'frame_14','url':_0x475790(0xa14),'name':'14'},{'id':_0x475790(0x1392),'url':_0x475790(0x6cc),'name':'1'},{'id':_0x475790(0x4b2),'url':_0x475790(0x9e4),'name':'2'},{'id':_0x475790(0xddf),'url':'https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','name':'3'},{'id':_0x475790(0xda3),'url':'https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','name':'4'},{'id':_0x475790(0x13ee),'url':_0x475790(0x137b),'name':'5'},{'id':_0x475790(0x7bd),'url':'https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','name':'6'},{'id':_0x475790(0x14d1),'url':_0x475790(0xceb),'name':'7'},{'id':_0x475790(0x483),'url':'https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','name':'8'},{'id':'frame_9','url':'https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','name':'9'},{'id':'frame_10','url':_0x475790(0x103e),'name':'10'},{'id':_0x475790(0x770),'url':'https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','name':'11'},{'id':_0x475790(0x12a0),'url':_0x475790(0x1032),'name':'12'},{'id':'frame_13','url':_0x475790(0xcf9),'name':'13'},{'id':'frame_14','url':_0x475790(0xe6e),'name':'14'},{'id':'frame_cat_ear','url':_0x475790(0x278),'name':'1'},{'id':_0x475790(0x4b2),'url':_0x475790(0x691),'name':'2'},{'id':_0x475790(0xddf),'url':'https://i.postimg.cc/13hhJ77p/IMG-4419.gif','name':'3'},{'id':_0x475790(0xda3),'url':_0x475790(0x479),'name':'4'},{'id':'frame_5','url':'https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','name':'5'},{'id':_0x475790(0x7bd),'url':_0x475790(0x1411),'name':'6'},{'id':_0x475790(0x14d1),'url':_0x475790(0xa71),'name':'7'},{'id':_0x475790(0x483),'url':'https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','name':'8'},{'id':_0x475790(0x1bc),'url':'https://i.postimg.cc/05DLr0yj/IMG-4427.gif','name':'9'},{'id':_0x475790(0x891),'url':_0x475790(0xa3c),'name':'10'},{'id':_0x475790(0x770),'url':_0x475790(0x1252),'name':'11'},{'id':_0x475790(0x12a0),'url':_0x475790(0xd83),'name':'12'},{'id':_0x475790(0x2cd),'url':_0x475790(0x766),'name':'13'},{'id':'frame_14','url':_0x475790(0x8f0),'name':'14'},{'id':_0x475790(0x1392),'url':'https://i.postimg.cc/XNkQTHvf/IMG-5561.gif','name':'1'},{'id':_0x475790(0x4b2),'url':_0x475790(0x10c5),'name':'2'},{'id':_0x475790(0xddf),'url':'https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','name':'3'},{'id':_0x475790(0xda3),'url':'https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','name':'4'},{'id':'frame_5','url':_0x475790(0x1289),'name':'5'},{'id':_0x475790(0x7bd),'url':_0x475790(0x1039),'name':'6'},{'id':_0x475790(0x14d1),'url':_0x475790(0x6df),'name':'7'},{'id':'frame_8','url':_0x475790(0x946),'name':'8'},{'id':_0x475790(0x1bc),'url':'https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','name':'9'},{'id':'frame_10','url':_0x475790(0xe69),'name':'10'},{'id':'frame_11','url':_0x475790(0x1286),'name':'11'},{'id':_0x475790(0x12a0),'url':_0x475790(0x91f),'name':'12'},{'id':_0x475790(0x2cd),'url':'https://i.postimg.cc/wjH180kn/IMG-5566.gif','name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0x1169),'name':'14'},{'id':_0x475790(0x1392),'url':'https://i.postimg.cc/CKgDNYVb/IMG-5577.gif','name':'1'},{'id':_0x475790(0x4b2),'url':_0x475790(0xd4c),'name':'2'},{'id':_0x475790(0xddf),'url':_0x475790(0xd4c),'name':'3'},{'id':_0x475790(0xda3),'url':'https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','name':'4'},{'id':_0x475790(0x13ee),'url':_0x475790(0x1bb),'name':'5'},{'id':_0x475790(0x7bd),'url':_0x475790(0x10e5),'name':'6'},{'id':_0x475790(0x14d1),'url':_0x475790(0xe07),'name':'7'},{'id':_0x475790(0x483),'url':'https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','name':'8'},{'id':_0x475790(0x1bc),'url':_0x475790(0x7c1),'name':'9'},{'id':_0x475790(0x891),'url':_0x475790(0xff8),'name':'10'},{'id':_0x475790(0x770),'url':_0x475790(0x177),'name':'11'},{'id':'frame_12','url':_0x475790(0x58c),'name':'12'},{'id':'frame_13','url':_0x475790(0x3a8),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0xfed),'name':'14'},{'id':_0x475790(0x1392),'url':'https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','name':'1'},{'id':_0x475790(0x4b2),'url':'https://i.postimg.cc/9fQZ425b/IMG-5975.gif','name':'2'},{'id':_0x475790(0xddf),'url':'https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','name':'3'},{'id':_0x475790(0xda3),'url':'https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','name':'4'},{'id':'frame_5','url':_0x475790(0xfd9),'name':'5'},{'id':'frame_6','url':'https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','name':'6'},{'id':'frame_7','url':'https://i.postimg.cc/qRCtnMms/IMG-6145.gif','name':'7'},{'id':_0x475790(0x483),'url':_0x475790(0xe48),'name':'8'},{'id':_0x475790(0x1bc),'url':_0x475790(0xf6a),'name':'9'},{'id':_0x475790(0x891),'url':'https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','name':'10'},{'id':_0x475790(0x770),'url':'https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','name':'11'},{'id':_0x475790(0x12a0),'url':_0x475790(0xb89),'name':'12'},{'id':_0x475790(0x2cd),'url':'https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','name':'14'},{'id':_0x475790(0x1392),'url':_0x475790(0x353),'name':'1'},{'id':'frame_ribbon','url':_0x475790(0x4b4),'name':'2'},{'id':'frame_flower','url':_0x475790(0xfa3),'name':'3'},{'id':'frame_tech','url':_0x475790(0xca4),'name':'4'},{'id':_0x475790(0x13ee),'url':_0x475790(0x876),'name':'5'},{'id':'frame_6','url':_0x475790(0x7fa),'name':'6'},{'id':_0x475790(0x14d1),'url':_0x475790(0xaaf),'name':'7'},{'id':_0x475790(0x483),'url':_0x475790(0x3fd),'name':'8'},{'id':_0x475790(0x1bc),'url':'https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','name':'9'},{'id':_0x475790(0x891),'url':_0x475790(0x143c),'name':'10'},{'id':'frame_11','url':'https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','name':'11'},{'id':_0x475790(0x12a0),'url':_0x475790(0x1554),'name':'12'},{'id':_0x475790(0x2cd),'url':_0x475790(0x149b),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','name':'14'},{'id':_0x475790(0x1392),'url':_0x475790(0xf10),'name':'1'},{'id':_0x475790(0x4b2),'url':'https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','name':'2'},{'id':'frame_flower','url':_0x475790(0xd20),'name':'3'},{'id':_0x475790(0xda3),'url':_0x475790(0xe0d),'name':'4'},{'id':_0x475790(0x13ee),'url':'https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','name':'5'},{'id':_0x475790(0x7bd),'url':_0x475790(0x802),'name':'6'},{'id':'frame_7','url':_0x475790(0x1135),'name':'7'},{'id':_0x475790(0x483),'url':_0x475790(0x66e),'name':'8'},{'id':_0x475790(0x1bc),'url':_0x475790(0x81f),'name':'9'},{'id':_0x475790(0x891),'url':_0x475790(0x97b),'name':'10'},{'id':_0x475790(0x770),'url':_0x475790(0xca1),'name':'11'},{'id':_0x475790(0x12a0),'url':_0x475790(0x71f),'name':'12'},{'id':'frame_13','url':'https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','name':'13'},{'id':'frame_14','url':_0x475790(0x4bb),'name':'14'},{'id':_0x475790(0x1392),'url':_0x475790(0xd4d),'name':'1'},{'id':_0x475790(0x4b2),'url':_0x475790(0xa61),'name':'2'},{'id':_0x475790(0xddf),'url':_0x475790(0x1260),'name':'3'},{'id':'frame_tech','url':'https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','name':'4'},{'id':'frame_5','url':_0x475790(0xcdf),'name':'5'},{'id':'frame_6','url':'https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','name':'6'},{'id':_0x475790(0x14d1),'url':_0x475790(0xafe),'name':'7'},{'id':'frame_8','url':_0x475790(0xf60),'name':'8'},{'id':_0x475790(0x1bc),'url':_0x475790(0xa78),'name':'9'},{'id':_0x475790(0x891),'url':'https://i.postimg.cc/nryNzTXK/IMG-6915.gif','name':'10'},{'id':_0x475790(0x770),'url':'https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','name':'11'},{'id':'frame_12','url':_0x475790(0x1ba),'name':'12'},{'id':_0x475790(0x2cd),'url':'https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0x154a),'name':'14'},{'id':_0x475790(0x770),'url':_0x475790(0xea4),'name':'11'},{'id':_0x475790(0x12a0),'url':_0x475790(0x83a),'name':'12'},{'id':_0x475790(0x2cd),'url':_0x475790(0x5fc),'name':'13'},{'id':_0x475790(0x1391),'url':'https://i.postimg.cc/sDFhySn3/IMG-6936.gif','name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x107c),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0xe09),'name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x4fd),'name':'13'},{'id':'frame_14','url':_0x475790(0xa7a),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x467),'name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x220),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0xf19),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0xbca),'name':'14'},{'id':_0x475790(0x12a0),'url':_0x475790(0x10dc),'name':'12'},{'id':'frame_13','url':_0x475790(0x13dd),'name':'13'},{'id':_0x475790(0x1391),'url':'https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x1265),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0xba9),'name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x190),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0x3b6),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x384),'name':'14'},{'id':_0x475790(0x2cd),'url':'https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0x83d),'name':'14'},{'id':'frame_14','url':_0x475790(0xe10),'name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x1318),'name':'13'},{'id':'frame_14','url':_0x475790(0x63b),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x989),'name':'14'},{'id':'frame_14','url':_0x475790(0xb06),'name':'14'},{'id':'frame_13','url':_0x475790(0x11d2),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0xad1),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x12bb),'name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x3fb),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0xed2),'name':'14'},{'id':_0x475790(0x1391),'url':'https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','name':'14'},{'id':_0x475790(0x2cd),'url':'https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif','name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x1464),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x129b),'name':'14'},{'id':_0x475790(0x2cd),'url':'https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','name':'13'},{'id':_0x475790(0x1391),'url':'https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif','name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x11a9),'name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x1d7),'name':'13'},{'id':'frame_14','url':_0x475790(0x11ee),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0xd00),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x1207),'name':'14'},{'id':_0x475790(0x2cd),'url':'https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','name':'14'},{'id':_0x475790(0x1391),'url':'https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x1220),'name':'13'},{'id':'frame_14','url':_0x475790(0xf7f),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x16f),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x3ce),'name':'14'},{'id':'frame_13','url':_0x475790(0x6e8),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0x1166),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x10f3),'name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0xad7),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0xebd),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0xa7e),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x1153),'name':'14'},{'id':'frame_13','url':_0x475790(0x27f),'name':'13'},{'id':'frame_14','url':_0x475790(0x134c),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x9ca),'name':'14'},{'id':_0x475790(0x2cd),'url':'https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif','name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0x6d5),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0xb8e),'name':'14'},{'id':'frame_14','url':_0x475790(0x82c),'name':'14'},{'id':'frame_13','url':_0x475790(0x86f),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/W40f9qtd/IMG-7098.gif','name':'14'},{'id':_0x475790(0x2cd),'url':'https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x86b),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0xb4c),'name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x145c),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0x91e),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x326),'name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x4c5),'name':'13'},{'id':'frame_14','url':_0x475790(0x120b),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0xfa4),'name':'14'},{'id':_0x475790(0x1391),'url':'https://i.postimg.cc/B6KD52vz/IMG-7096.gif','name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0x4de),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x1232),'name':'14'},{'id':_0x475790(0x2cd),'url':'https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0xdb9),'name':'14'},{'id':_0x475790(0x1391),'url':'https://i.postimg.cc/fyyGgW61/IMG-7115.gif','name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x901),'name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0xd47),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0xf40),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0xaa8),'name':'14'},{'id':_0x475790(0x2cd),'url':'https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/zvWGPjms/IMG-7090.gif','name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','name':'14'},{'id':'frame_14','url':_0x475790(0x1b9),'name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x66d),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0x539),'name':'14'},{'id':_0x475790(0x1391),'url':'https://i.postimg.cc/wMxmCZVC/IMG-7099.gif','name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x1d3),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0xb23),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0xbe7),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/htZppbS4/IMG-7107.gif','name':'14'},{'id':_0x475790(0x2cd),'url':_0x475790(0x1156),'name':'13'},{'id':_0x475790(0x1391),'url':_0x475790(0x5f3),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','name':'14'},{'id':_0x475790(0x2cd),'url':'https://i.postimg.cc/bJDMQVkj/IMG-7112.gif','name':'13'},{'id':'frame_14','url':_0x475790(0x617),'name':'14'},{'id':_0x475790(0x1391),'url':_0x475790(0x114a),'name':'14'}];let _0x28f30a={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map()},_0x5aea71={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':_0x475790(0x1108),'nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0xf09860=0x0;const _0x3b9454=0xf;let _0x5adb76=0x0;const _0x29b799=0xa;let _0x4e343b=[],_0x79cac3={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':_0x475790(0xe7e),'totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0x3006bc={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x4da7ed=document['getElementById'](_0x475790(0xa34));let _0x1f5717=null,_0x36063f=![],_0x2d3c48=0x0,_0x4a6199=null,_0x24e903=![],_0x592042='all',_0x2c905a=new Set(),_0x6c1e72=null,_0x335ffe=![],_0x143e12=null,_0x57a7d0=null,_0x27d082=![],_0x51e675=![],_0xca1dd0=![],_0x168c65=![],_0x314ee2=[],_0x354ae4=null,_0x2e3d99=null,_0x216d5c={},_0x38f399=null,_0x579fa9=null,_0x30d6c4=null,_0x3c1291=null,_0x18b1db=null,_0x68d37c=null,_0x360a61=null,_0x54e872=[],_0x45682c=null,_0x3dfd52=null,_0x5936d4=new Set(),_0xbdfe41=null,_0x281561=null,_0x250bff=null,_0x30c3d1={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x461b99=0x0,_0x8c830a=![],_0xefcc57=new Set(),_0x50d0fa=null;const _0x825cf1=_0x475790(0xb70),_0x3ba305=_0x475790(0x409),_0xd71c66=_0x475790(0x7c2),_0x563b2b=_0x475790(0x16b);let _0x3446f1,_0x2b6c0f={};const _0xa4eded='https://www.myinstants.com/media/sounds/notification-sound-2.mp3';let _0x484920={},_0x4dbc69={},_0x162147=null;const _0x40c71f={'qq':_0x475790(0xf7b),'world-book':_0x475790(0x966),'wallpaper':_0x475790(0x8db),'renderer':_0x475790(0x157a),'api-settings':_0x475790(0x1132),'font':_0x475790(0x892),'char-phone':_0x475790(0xd06),'douban':_0x475790(0x20b),'preset':_0x475790(0x48c),'tutorial':_0x475790(0x761),'werewolf':_0x475790(0xd55),'x':'https://i.postimg.cc/Y9d3BztC/1.png'},_0x41ca77={'qq':_0x475790(0xf7b),'album':_0x475790(0x966),'browser':_0x475790(0x540),'taobao':'https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','memo':_0x475790(0x130b),'diary':_0x475790(0x732),'amap':_0x475790(0xdfa),'usage':_0x475790(0x1030),'music':'https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','ephone':_0x475790(0xd06)};let _0x2bbd76=null;const _0x41abd3=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0x5df89d=0x0,_0x152239=0x1,_0x2af782={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0x381bcc;const _0x10b1b3=document[_0x475790(0x14ae)](_0x475790(0x589));_0x10b1b3['id']=_0x475790(0x1084),document[_0x475790(0x150d)][_0x475790(0x998)](_0x10b1b3);const _0x57e7c2=document[_0x475790(0x2ec)]('custom-modal-overlay'),_0x4c60db=document[_0x475790(0x2ec)](_0x475790(0x1243)),_0x1eb717=document['getElementById'](_0x475790(0x9d6)),_0x5d5b0a=document[_0x475790(0x2ec)](_0x475790(0x8e6)),_0x295170=document[_0x475790(0x2ec)](_0x475790(0x68e));let _0x4daf69;function _0x1a4b73(){const _0x409da1=_0x475790;_0x57e7c2[_0x409da1(0xff6)][_0x409da1(0xe82)](_0x409da1(0x149d));}function _0x50c3bc(){const _0x4e2319=_0x475790;_0x57e7c2[_0x4e2319(0xff6)][_0x4e2319(0x1424)](_0x4e2319(0x149d)),_0x5d5b0a[_0x4e2319(0xff6)][_0x4e2319(0x1424)](_0x4e2319(0xd8f));if(_0x4daf69)_0x4daf69(null);}function _0x3b419e(_0x187767){const _0x5f20d0=_0x475790,_0x561107=document['getElementById'](_0x5f20d0(0x652)),_0x52167e=_0x187767[_0x5f20d0(0x362)][_0x5f20d0(0xd88)]||{'vertical':_0x5f20d0(0xdd5),'horizontal':'center','offset':0xa};_0x561107[_0x5f20d0(0x589)]['top']='auto',_0x561107['style'][_0x5f20d0(0xe39)]=_0x5f20d0(0x1214),_0x561107[_0x5f20d0(0x589)]['left']=_0x5f20d0(0x1214),_0x561107['style'][_0x5f20d0(0xc1b)]=_0x5f20d0(0x1214),_0x561107[_0x5f20d0(0x589)][_0x5f20d0(0x1244)]=_0x5f20d0(0x5b1);_0x52167e[_0x5f20d0(0x3c4)]===_0x5f20d0(0xdd5)?_0x561107['style'][_0x5f20d0(0xdd5)]=_0x52167e[_0x5f20d0(0x8bd)]+'px':_0x561107['style'][_0x5f20d0(0xe39)]=_0x52167e[_0x5f20d0(0x8bd)]+'px';switch(_0x52167e[_0x5f20d0(0x121c)]){case _0x5f20d0(0xd02):_0x561107[_0x5f20d0(0x589)][_0x5f20d0(0xd02)]=_0x5f20d0(0x1498);break;case _0x5f20d0(0xc1b):_0x561107[_0x5f20d0(0x589)]['right']=_0x5f20d0(0x1498);break;case _0x5f20d0(0x40e):default:_0x561107[_0x5f20d0(0x589)]['left']='50%',_0x561107[_0x5f20d0(0x589)]['transform']=_0x5f20d0(0x4ca);break;}}async function _0x4676f5(_0x521b93){const _0xdc3fe9=_0x475790,_0x459949=_0x521b93[_0xdc3fe9(0x1104)][_0xdc3fe9(0x8d6)][0x0];if(!_0x459949)return;const _0x42f446=await new Promise(_0x4b9648=>{const _0x20b8bb=_0xdc3fe9,_0x5a4f54=new FileReader();_0x5a4f54[_0x20b8bb(0xf2d)]=()=>_0x4b9648(_0x5a4f54[_0x20b8bb(0x42a)]),_0x5a4f54[_0x20b8bb(0x60e)](_0x459949);});await _0x34d596('请稍候...',_0xdc3fe9(0xb91));try{const _0x3320e6=await _0x2be5a9(_0x42f446);if(!_0x3320e6)throw new Error('AI未能成功描述图片。');const _0x1af523=_0x28f30a[_0xdc3fe9(0x6ce)][_0x28f30a[_0xdc3fe9(0x11b9)]];!_0x1af523[_0xdc3fe9(0x362)][_0xdc3fe9(0x1235)]&&(_0x1af523[_0xdc3fe9(0x362)][_0xdc3fe9(0x1235)]=[]),_0x1af523[_0xdc3fe9(0x362)]['groupAvatarLibrary'][_0xdc3fe9(0x367)]({'name':_0x3320e6,'url':_0x42f446}),await _0x5b9d83[_0xdc3fe9(0x6ce)][_0xdc3fe9(0x7c3)](_0x1af523),_0x45df45(),await _0x34d596(_0xdc3fe9(0xe57),_0xdc3fe9(0xcac)+_0x3320e6+'”');}catch(_0x4c4007){console[_0xdc3fe9(0x1518)](_0xdc3fe9(0x401),_0x4c4007),await _0x34d596(_0xdc3fe9(0x221),_0xdc3fe9(0x5eb)+_0x4c4007[_0xdc3fe9(0x13bc)]);}finally{_0x521b93[_0xdc3fe9(0x1104)]['value']=null;}}async function _0x275feb(_0xd5e5c9){const _0x2396d7=_0x475790,_0x598029=_0xd5e5c9[_0x2396d7(0x1104)][_0x2396d7(0x8d6)][0x0];if(!_0x598029)return;const _0x3ffc80=await new Promise(_0x44300e=>{const _0x294d4a=_0x2396d7,_0x22490d=new FileReader();_0x22490d['onload']=()=>_0x44300e(_0x22490d[_0x294d4a(0x42a)]),_0x22490d['readAsDataURL'](_0x598029);});await _0x34d596(_0x2396d7(0x13e4),_0x2396d7(0x2a9));try{const _0x37706a=await _0x2be5a9(_0x3ffc80);if(!_0x37706a)throw new Error(_0x2396d7(0x507));const _0x3174b2=_0x28f30a[_0x2396d7(0x6ce)][_0x28f30a[_0x2396d7(0x11b9)]];!_0x3174b2[_0x2396d7(0x362)]['aiAvatarLibrary']&&(_0x3174b2[_0x2396d7(0x362)][_0x2396d7(0x78c)]=[]),_0x3174b2['settings']['aiAvatarLibrary'][_0x2396d7(0x367)]({'name':_0x37706a,'url':_0x3ffc80}),await _0x5b9d83['chats'][_0x2396d7(0x7c3)](_0x3174b2),_0x3fd980(),await _0x34d596(_0x2396d7(0xe57),_0x2396d7(0x14a1)+_0x37706a+'”');}catch(_0x1d2026){console[_0x2396d7(0x1518)](_0x2396d7(0xba1),_0x1d2026),await _0x34d596('操作失败',_0x2396d7(0x5eb)+_0x1d2026[_0x2396d7(0x13bc)]);}finally{_0xd5e5c9[_0x2396d7(0x1104)]['value']=null;}}async function _0x2be5a9(_0x1eda35){const _0x84f722=_0x475790,_0x390b97=_0x28f30a[_0x84f722(0x1537)][_0x84f722(0xcf0)]&&_0x28f30a[_0x84f722(0x1537)][_0x84f722(0xeae)]&&_0x28f30a['apiConfig'][_0x84f722(0xf3f)],{proxyUrl:_0x3693da,apiKey:_0x383dae,model:_0xb9e548}=_0x390b97?{'proxyUrl':_0x28f30a[_0x84f722(0x1537)][_0x84f722(0xcf0)],'apiKey':_0x28f30a[_0x84f722(0x1537)][_0x84f722(0xeae)],'model':_0x28f30a[_0x84f722(0x1537)]['secondaryModel']}:_0x28f30a['apiConfig'];if(!_0x3693da||!_0x383dae||!_0xb9e548)throw new Error(_0x84f722(0x1205));const _0x51c60f=_0x84f722(0xf39);let _0x5051a2=_0x3693da[_0x84f722(0x138a)](_0x84f722(0xe9c)),_0x1b780e;if(_0x5051a2){const _0x2b1636=_0x1eda35[_0x84f722(0x49a)](/^data:(.*);base64/)[0x1],_0x46807c=_0x1eda35['split'](',')[0x1],_0xdf52f={'contents':[{'parts':[{'text':_0x51c60f},{'inline_data':{'mime_type':_0x2b1636,'data':_0x46807c}}]}]};_0x1b780e=await fetch(_0x3693da+'/'+_0xb9e548+_0x84f722(0x127d)+_0x383dae,{'method':_0x84f722(0x655),'headers':{'Content-Type':'application/json'},'body':JSON[_0x84f722(0xe4d)](_0xdf52f)});}else{const _0x5bc260={'model':_0xb9e548,'messages':[{'role':_0x84f722(0xcc9),'content':[{'type':_0x84f722(0x10ca),'text':_0x51c60f},{'type':_0x84f722(0x1014),'image_url':{'url':_0x1eda35}}]}],'max_tokens':0x32};_0x1b780e=await fetch(_0x3693da+_0x84f722(0x1427),{'method':_0x84f722(0x655),'headers':{'Content-Type':_0x84f722(0x1446),'Authorization':_0x84f722(0xe83)+_0x383dae},'body':JSON['stringify'](_0x5bc260)});}if(!_0x1b780e['ok']){const _0x2b2b91=await _0x1b780e[_0x84f722(0x12a2)]();throw new Error('API\x20错误:\x20'+_0x2b2b91[_0x84f722(0x1518)][_0x84f722(0x13bc)]);}const _0x4e9a0f=await _0x1b780e[_0x84f722(0x12a2)]();let _0x267ece=_0x5051a2?getGeminiResponseText(_0x4e9a0f):_0x4e9a0f['choices'][0x0][_0x84f722(0x13bc)][_0x84f722(0x1047)];return _0x267ece[_0x84f722(0x97e)]()['replace'](/["'“”‘’]/g,'');}async function _0x24e380(_0x3d1a1c){const _0x48e044=_0x475790;if(!_0x3d1a1c||_0x3d1a1c[_0x48e044(0x1423)]){console['warn'](_0x48e044(0xbb6));return;}const _0x2c795d=_0x3d1a1c['id'],_0x457046=_0x3d1a1c[_0x48e044(0xe36)],_0xcebc2a=_0x3d1a1c[_0x48e044(0x66c)];console['log'](_0x48e044(0xe75)+_0x2c795d+'\x20同步所有群聊内的名称信息...');for(const _0x1a4e28 in _0x28f30a[_0x48e044(0x6ce)]){const _0x5444ac=_0x28f30a[_0x48e044(0x6ce)][_0x1a4e28];if(_0x5444ac['isGroup']&&_0x5444ac['members']){const _0x51d6e3=_0x5444ac['members']['find'](_0x7b9f87=>_0x7b9f87['id']===_0x2c795d);if(_0x51d6e3){let _0x155e0a=![];_0x51d6e3['groupNickname']!==_0x457046&&(_0x51d6e3[_0x48e044(0x8a8)]=_0x457046,_0x155e0a=!![]),_0x51d6e3['originalName']!==_0xcebc2a&&(_0x51d6e3[_0x48e044(0x66c)]=_0xcebc2a,_0x155e0a=!![]),_0x155e0a&&(await _0x5b9d83['chats'][_0x48e044(0x7c3)](_0x5444ac),console['log'](_0x48e044(0x1b3)+_0x5444ac[_0x48e044(0xe36)]+_0x48e044(0x14d7)));}}}}async function _0x50cbc4(_0x27c19e){const _0x350217=_0x475790;if(!_0x27c19e||_0x27c19e[_0x350217(0x1423)]){console['warn'](_0x350217(0xe89));return;}const _0x22c910=_0x27c19e['id'],_0x518490=_0x27c19e[_0x350217(0x362)][_0x350217(0xe91)];console[_0x350217(0x415)](_0x350217(0xe75)+_0x22c910+_0x350217(0xb15));for(const _0x591b32 of Object[_0x350217(0x74e)](_0x28f30a[_0x350217(0x6ce)])){if(_0x591b32[_0x350217(0x1423)]&&_0x591b32['members']){const _0x384c41=_0x591b32[_0x350217(0x10f2)][_0x350217(0x412)](_0x38d5b8=>_0x38d5b8['id']===_0x22c910);_0x384c41&&_0x384c41[_0x350217(0x516)]!==_0x518490&&(_0x384c41[_0x350217(0x516)]=_0x518490,await _0x5b9d83[_0x350217(0x6ce)]['put'](_0x591b32),console['log'](_0x350217(0xe22)+_0x22c910+'\x20的新头像同步到群聊\x20\x22'+_0x591b32[_0x350217(0xe36)]+'\x22'));}}}function _0x4f967c(_0x366855,_0x484fd2){const _0x3ba2c6=_0x475790;if(!_0x366855||!_0x366855[_0x3ba2c6(0x1423)]||!_0x484fd2)return _0x484fd2;const _0x1df7ad=_0x28f30a['qzoneSettings'][_0x3ba2c6(0x19a)]||_0x3ba2c6(0x450);if(_0x484fd2===_0x1df7ad)return _0x366855[_0x3ba2c6(0x362)][_0x3ba2c6(0xa28)]||'我';const _0x3d476=_0x366855[_0x3ba2c6(0x10f2)]['find'](_0x43d6dc=>_0x43d6dc[_0x3ba2c6(0x66c)]===_0x484fd2);return _0x3d476?_0x3d476[_0x3ba2c6(0x8a8)]:_0x484fd2;}function _0x1960e7(_0x4c926d){const _0x2f61b2=_0x475790;document[_0x2f61b2(0x5d6)](_0x2f61b2(0x4ee))[_0x2f61b2(0xf99)](_0x3b9f27=>{const _0x45ef82=_0x2f61b2;_0x3b9f27[_0x45ef82(0xff6)][_0x45ef82(0x14c8)](_0x45ef82(0xd43),_0x3b9f27['dataset'][_0x45ef82(0x10ce)]===_0x4c926d);}),document[_0x2f61b2(0x5d6)](_0x2f61b2(0xa83))['forEach'](_0x3ad947=>{const _0x381a0e=_0x2f61b2;_0x3ad947['classList'][_0x381a0e(0x14c8)](_0x381a0e(0xd43),_0x3ad947[_0x381a0e(0xe93)]['categoryId']===_0x4c926d);});}function _0x2fa4e1(_0x3fece6){const _0x57c82e=_0x475790;if(!_0x3fece6)return'';if(_0x28f30a[_0x57c82e(0x1506)]&&_0x3fece6===_0x28f30a[_0x57c82e(0x1506)][_0x57c82e(0x19a)])return _0x28f30a['qzoneSettings'][_0x57c82e(0x19a)];let _0x4400e4=Object[_0x57c82e(0x74e)](_0x28f30a[_0x57c82e(0x6ce)])[_0x57c82e(0x412)](_0x384db4=>!_0x384db4[_0x57c82e(0x1423)]&&_0x384db4['originalName']===_0x3fece6);if(_0x4400e4)return _0x4400e4[_0x57c82e(0xe36)];_0x4400e4=Object[_0x57c82e(0x74e)](_0x28f30a[_0x57c82e(0x6ce)])[_0x57c82e(0x412)](_0x3ab30c=>!_0x3ab30c[_0x57c82e(0x1423)]&&(_0x3ab30c['nameHistory']&&_0x3ab30c['nameHistory'][_0x57c82e(0x138a)](_0x3fece6)));if(_0x4400e4)return _0x4400e4[_0x57c82e(0xe36)];return _0x3fece6;}function _0x50f96e(_0xeab65c,_0x100cd6=null){const _0x47a79f=_0x475790;if(!_0xeab65c||typeof _0xeab65c!=='string'||!_0xeab65c[_0x47a79f(0x138a)](_0x47a79f(0x98e)))return _0xeab65c;return _0xeab65c['replace'](/@\[\[([^\]]+)\]\]/g,(_0x50d52a,_0x3d383c)=>{const _0xc563a1=_0x47a79f,_0x5d5cba=_0x3d383c[_0xc563a1(0x97e)]();let _0xd2cd7;return _0x100cd6&&_0x100cd6[_0xc563a1(0x1423)]?_0xd2cd7=_0x4f967c(_0x100cd6,_0x5d5cba):_0xd2cd7=_0x2fa4e1(_0x5d5cba),'@'+_0xd2cd7;});}function _0x4436ba(_0x42f202,_0x22033f,_0x1351de={}){return new Promise(_0x3c145f=>{const _0x4aab08=_0x1937;_0x4daf69=_0x3c145f,_0x4c60db[_0x4aab08(0x15f)]=_0x42f202,_0x1eb717[_0x4aab08(0xc43)]=_0x4aab08(0x133c)+_0x22033f+_0x4aab08(0x1251);const _0x51592e=document['getElementById'](_0x4aab08(0x8e6)),_0x5849bd=document[_0x4aab08(0x2ec)]('custom-modal-cancel');_0x5849bd[_0x4aab08(0x589)][_0x4aab08(0x701)]=_0x4aab08(0x13f7),_0x51592e[_0x4aab08(0x15f)]=_0x1351de['confirmText']||'确定',_0x5849bd[_0x4aab08(0x15f)]=_0x1351de['cancelText']||'取消',_0x1351de[_0x4aab08(0xf31)]?_0x51592e['classList']['add'](_0x1351de[_0x4aab08(0xf31)]):_0x51592e['classList'][_0x4aab08(0x1424)]('btn-danger'),_0x51592e[_0x4aab08(0x6b6)]=()=>{_0x3c145f(!![]),_0x50c3bc();},_0x5849bd[_0x4aab08(0x6b6)]=()=>{_0x3c145f(![]),_0x50c3bc();},_0x1a4b73();});}function _0x339b2d(_0x20f374=_0x475790(0x5b5),_0x3e9a4a=_0x475790(0x249)){const _0x20a3d1=_0x475790,_0x3bbb98=document[_0x20a3d1(0x14ae)](_0x20a3d1(0xaa5));_0x3bbb98['textContent']=_0x20f374,_0x3bbb98[_0x20a3d1(0x589)][_0x20a3d1(0x57a)]=_0x20a3d1(0x62a)+(_0x3e9a4a===_0x20a3d1(0x249)?'#4CAF50':_0x20a3d1(0x12cc))+';\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2012px\x2024px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x2010000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20pointer-events:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(20px);\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20',document[_0x20a3d1(0x140d)]['appendChild'](_0x3bbb98),setTimeout(()=>{const _0x2988bb=_0x20a3d1;_0x3bbb98['style'][_0x2988bb(0xb92)]='1',_0x3bbb98[_0x2988bb(0x589)][_0x2988bb(0x1244)]='translateY(0)';},0xa),setTimeout(()=>{const _0x35336d=_0x20a3d1;_0x3bbb98[_0x35336d(0x589)][_0x35336d(0xb92)]='0',_0x3bbb98['style'][_0x35336d(0x1244)]='translateY(-20px)',setTimeout(()=>{_0x3bbb98['remove']();},0x12c);},0x7d0);}function _0x13cc95(_0x4dbeda){const _0x4d5cbb=_0x475790;let _0x1112ea=(_0x4dbeda||'NAI_Image')[_0x4d5cbb(0x13ed)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')[_0x4d5cbb(0x13ed)](/\s+/g,'_')[_0x4d5cbb(0xa6b)](0x0,0x1e);const _0x4d1fd1=new Date()[_0x4d5cbb(0xaf8)]()[_0x4d5cbb(0x13ed)](/[-:]/g,'')[_0x4d5cbb(0x13ed)]('T','_')['split']('.')[0x0];return _0x1112ea+'_'+_0x4d1fd1+_0x4d5cbb(0xbb2);}function _0x2d2f51(_0x25ea97,_0x2576fc){const _0x37a76a=_0x475790;try{const _0x562e50=_0x13cc95(_0x2576fc),_0x56de9a=document['createElement']('a');_0x56de9a[_0x37a76a(0xe15)]=_0x25ea97,_0x56de9a[_0x37a76a(0x3eb)]=_0x562e50,_0x56de9a[_0x37a76a(0x589)][_0x37a76a(0x701)]=_0x37a76a(0x5b1),document[_0x37a76a(0x140d)]['appendChild'](_0x56de9a),_0x56de9a[_0x37a76a(0x1177)](),setTimeout(()=>{const _0x546b15=_0x37a76a;document[_0x546b15(0x140d)][_0x546b15(0xd17)](_0x56de9a);},0x64),_0x339b2d(_0x37a76a(0x5b5));}catch(_0xd667fd){console[_0x37a76a(0x1518)](_0x37a76a(0x335),_0xd667fd),_0x339b2d(_0x37a76a(0x1369),_0x37a76a(0x1518));}}function _0x34d596(_0x1d83e4,_0x19cf81){return new Promise(_0x3002d3=>{const _0x95976f=_0x1937;_0x4daf69=_0x3002d3,_0x4c60db[_0x95976f(0x15f)]=_0x1d83e4,_0x1eb717[_0x95976f(0xc43)]=_0x95976f(0xf0f)+_0x19cf81+'</p>';const _0x11255c=document[_0x95976f(0x2ec)](_0x95976f(0x8e6)),_0x58a579=document[_0x95976f(0x2ec)](_0x95976f(0x68e));_0x58a579[_0x95976f(0x589)]['display']=_0x95976f(0x5b1),_0x11255c['textContent']='好的',_0x11255c[_0x95976f(0x6b6)]=()=>{const _0x48cbac=_0x95976f;_0x58a579[_0x48cbac(0x589)][_0x48cbac(0x701)]=_0x48cbac(0x13f7),_0x11255c[_0x48cbac(0x15f)]='确定',_0x3002d3(!![]),_0x50c3bc();},_0x1a4b73();});}async function _0x1f9eee(_0x438375,_0x38728a=_0x475790(0x708)){const _0x2e7c3c=_0x475790;if(!_0x438375){await _0x34d596(_0x2e7c3c(0xf54),'没有可复制的内容。');return;}try{await navigator[_0x2e7c3c(0xc62)][_0x2e7c3c(0x6c7)](_0x438375),await _0x34d596(_0x2e7c3c(0x155b),_0x38728a);}catch(_0x1f7763){console['error'](_0x2e7c3c(0x1a8),_0x1f7763),await _0x34d596(_0x2e7c3c(0xf54),_0x2e7c3c(0x6a8));}}function _0x33419a(_0x16d936,_0x4125a9,_0x3b8980='',_0x100726=_0x475790(0x10ca),_0x21670a=''){return new Promise(_0x49e509=>{const _0x2e7795=_0x1937;_0x4daf69=_0x49e509,_0x4c60db[_0x2e7795(0x15f)]=_0x16d936;const _0x38ccaf=_0x2e7795(0xa00),_0x13b48b=_0x100726===_0x2e7795(0x382)?_0x2e7795(0x667)+_0x38ccaf+'\x22\x20placeholder=\x22'+_0x4125a9+_0x2e7795(0x13dc)+_0x3b8980+_0x2e7795(0xf51):'<input\x20type=\x22'+_0x100726+_0x2e7795(0x912)+_0x38ccaf+_0x2e7795(0x1188)+_0x4125a9+_0x2e7795(0x1437)+_0x3b8980+'\x22>';_0x1eb717[_0x2e7795(0xc43)]=_0x21670a+_0x13b48b;const _0x5bd847=document[_0x2e7795(0x2ec)](_0x38ccaf);_0x1eb717[_0x2e7795(0x5d6)](_0x2e7795(0x1035))['forEach'](_0x25ea25=>{const _0x424446=_0x2e7795;_0x25ea25[_0x424446(0xf79)]('click',()=>{const _0x26ba14=_0x424446,_0x39c976=_0x25ea25[_0x26ba14(0xe93)][_0x26ba14(0x129d)];if(_0x39c976)try{const _0x1dc92a=JSON[_0x26ba14(0xd91)](_0x39c976);_0x5bd847[_0x26ba14(0x11a4)]=JSON[_0x26ba14(0xe4d)](_0x1dc92a,null,0x2),_0x5bd847[_0x26ba14(0x52b)]();}catch(_0x17d3af){console[_0x26ba14(0x1518)](_0x26ba14(0xbed),_0x17d3af);}});});const _0x31c40f=document['getElementById'](_0x2e7795(0x8e6)),_0x59cffb=document[_0x2e7795(0x2ec)](_0x2e7795(0x68e));_0x31c40f['onclick']=()=>{const _0x27a1d3=_0x2e7795;_0x49e509(_0x5bd847[_0x27a1d3(0x11a4)]),_0x50c3bc();},_0x59cffb['onclick']=()=>{_0x49e509(null),_0x50c3bc();},_0x1a4b73(),setTimeout(()=>_0x5bd847['focus'](),0x64);});}function _0x3d2f35(_0x122a2a,_0x31bd4d){const _0x19b7fa=_0x475790;return new Promise(_0x95545f=>{const _0x548c74=_0x1937,_0x5ed01d=document[_0x548c74(0x2ec)]('custom-modal-overlay'),_0x5d21d7=document[_0x548c74(0x2ec)](_0x548c74(0x1243)),_0x1a30df=document[_0x548c74(0x2ec)](_0x548c74(0x9d6)),_0x3abb46=document['querySelector']('#custom-modal\x20.custom-modal-footer');_0x5d21d7[_0x548c74(0x15f)]=_0x122a2a,_0x1a30df['innerHTML']='',_0x3abb46[_0x548c74(0xc43)]='',_0x3abb46[_0x548c74(0x589)][_0x548c74(0x66b)]=_0x548c74(0x1045),_0x31bd4d[_0x548c74(0xf99)](_0x4565bd=>{const _0x557b6e=_0x548c74,_0x218394=document[_0x557b6e(0x14ae)](_0x557b6e(0xd5a));_0x218394['textContent']=_0x4565bd[_0x557b6e(0x10ca)],_0x218394[_0x557b6e(0x6b6)]=()=>{const _0x3c5099=_0x557b6e;_0x5ed01d['classList'][_0x3c5099(0x1424)](_0x3c5099(0x149d)),_0x95545f(_0x4565bd[_0x3c5099(0x11a4)]);},_0x3abb46[_0x557b6e(0x998)](_0x218394);});const _0x471a28=document[_0x548c74(0x14ae)](_0x548c74(0xd5a));_0x471a28['textContent']='取消',_0x471a28[_0x548c74(0x589)]['marginTop']=_0x548c74(0x751),_0x471a28[_0x548c74(0x589)][_0x548c74(0xf65)]=_0x548c74(0x751),_0x471a28[_0x548c74(0x589)][_0x548c74(0xc34)]='#f0f0f0',_0x471a28['onclick']=()=>{const _0x38ac16=_0x548c74;_0x5ed01d[_0x38ac16(0xff6)][_0x38ac16(0x1424)](_0x38ac16(0x149d)),_0x95545f(null);},_0x3abb46[_0x548c74(0x998)](_0x471a28),_0x5ed01d[_0x548c74(0xff6)]['add']('visible');})[_0x19b7fa(0x5e4)](()=>{const _0x536cb6=_0x19b7fa,_0x3f38f9=document[_0x536cb6(0x765)]('#custom-modal\x20.custom-modal-footer');_0x3f38f9[_0x536cb6(0x589)][_0x536cb6(0x66b)]=_0x536cb6(0x39e),_0x3f38f9[_0x536cb6(0xc43)]=_0x536cb6(0xd16),document[_0x536cb6(0x2ec)](_0x536cb6(0x68e))[_0x536cb6(0xf79)](_0x536cb6(0x1177),_0x50c3bc);});}async function _0x41e65f(){const _0x9af30b=_0x475790,_0x413711=await _0x3d2f35(_0x9af30b(0x339),[{'text':_0x9af30b(0xb7f),'value':'file'},{'text':'📋\x20直接粘贴歌词文本','value':_0x9af30b(0x1444)}]);if(_0x413711==='file')return new Promise(_0x44a1a4=>{const _0x3d4b13=_0x9af30b,_0x50ff06=document[_0x3d4b13(0x2ec)](_0x3d4b13(0x99a)),_0x1c6a79=_0x20d464=>{const _0x31481d=_0x3d4b13,_0x376e46=_0x20d464[_0x31481d(0x1104)]['files'][0x0];if(_0x376e46){const _0x5ef90f=new FileReader();_0x5ef90f[_0x31481d(0xf2d)]=_0x187a8c=>_0x44a1a4(_0x187a8c[_0x31481d(0x1104)][_0x31481d(0x42a)]),_0x5ef90f[_0x31481d(0x125a)]=()=>_0x44a1a4(''),_0x5ef90f[_0x31481d(0x1137)](_0x376e46);}else _0x44a1a4(null);_0x50ff06[_0x31481d(0x1f0)]('change',_0x1c6a79),_0x50ff06['value']='';};_0x50ff06[_0x3d4b13(0xf79)](_0x3d4b13(0x217),_0x1c6a79,{'once':!![]}),_0x50ff06[_0x3d4b13(0x1177)]();});else{if(_0x413711===_0x9af30b(0x1444)){const _0x1cf7e6=await _0x33419a(_0x9af30b(0x503),_0x9af30b(0x1380),'',_0x9af30b(0x382));if(_0x1cf7e6){const _0x24045f=_0x1cf7e6['replace'](/\[/g,'\x0a[')['trim']();return _0x24045f;}return _0x1cf7e6;}else return null;}}_0x5b9d83[_0x475790(0xc8f)](0x28)[_0x475790(0x971)]({'doubanPosts':'++id,\x20timestamp','chats':_0x475790(0xa5c),'apiConfig':_0x475790(0xc33),'globalSettings':_0x475790(0xa3f),'userStickers':_0x475790(0x7f4),'worldBooks':'&id,\x20name,\x20categoryId','worldBookCategories':_0x475790(0x972),'musicLibrary':_0x475790(0xa3f),'personaPresets':'&id','qzoneSettings':_0x475790(0xa3f),'qzonePosts':'++id,\x20timestamp,\x20authorId','qzoneAlbums':_0x475790(0x37e),'qzonePhotos':'++id,\x20albumId','favorites':'++id,\x20type,\x20timestamp,\x20originalTimestamp','qzoneGroups':_0x475790(0x972),'memories':_0x475790(0x1314),'callRecords':_0x475790(0xcb3),'shoppingProducts':_0x475790(0xb4a),'shoppingCategories':_0x475790(0x972),'apiPresets':_0x475790(0x972),'renderingRules':_0x475790(0x952),'appearancePresets':_0x475790(0x1100),'stickerCategories':_0x475790(0x972),'customAvatarFrames':'++id,\x20name','presets':'&id,\x20name,\x20categoryId','presetCategories':_0x475790(0x972),'readingLibrary':_0x475790(0xcaa),'npcs':'++id,\x20name,\x20npcGroupId,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp','npcGroups':_0x475790(0x972)})[_0x475790(0xbef)](_0x1f9fc9=>{const _0x3bd2ed=_0x475790;return _0x1f9fc9[_0x3bd2ed(0xd32)](_0x3bd2ed(0x13b9))[_0x3bd2ed(0x1474)]()[_0x3bd2ed(0xa88)](_0x42042a=>{const _0x2d1ef2=_0x3bd2ed;if(typeof _0x42042a[_0x2d1ef2(0x1047)]===_0x2d1ef2(0x863)&&_0x42042a['content'][_0x2d1ef2(0x97e)]()!=='')_0x42042a['content']=[{'keys':[],'comment':'从旧版本迁移的条目','content':_0x42042a[_0x2d1ef2(0x1047)]}];else!Array[_0x2d1ef2(0x624)](_0x42042a[_0x2d1ef2(0x1047)])&&(_0x42042a[_0x2d1ef2(0x1047)]=[]);_0x42042a[_0x2d1ef2(0x1047)][_0x2d1ef2(0xf99)](_0x57a6f1=>{const _0x234183=_0x2d1ef2;typeof _0x57a6f1[_0x234183(0x400)]===_0x234183(0xe40)&&(_0x57a6f1[_0x234183(0x400)]=!![]);});});}),window['db']=_0x5b9d83;function _0x17ec27(_0x3a813f){const _0x1a7bd4=_0x475790;_0x3a813f===_0x1a7bd4(0xf4d)&&(window['renderChatListProxy'](),_0x52c3ce('messages-view'));if(_0x3a813f===_0x1a7bd4(0x2ee))window[_0x1a7bd4(0x7b0)]();if(_0x3a813f==='wallpaper-screen')window[_0x1a7bd4(0x10d6)]();if(_0x3a813f===_0x1a7bd4(0x122b))window[_0x1a7bd4(0xf84)]();if(_0x3a813f===_0x1a7bd4(0x513))window[_0x1a7bd4(0x36c)]();if(_0x3a813f==='douban-screen')_0x37ff8e();document[_0x1a7bd4(0x5d6)](_0x1a7bd4(0xc25))[_0x1a7bd4(0xf99)](_0xd145e1=>_0xd145e1['classList'][_0x1a7bd4(0x1424)](_0x1a7bd4(0xd43)));const _0x3b30ee=document['getElementById'](_0x3a813f);if(_0x3b30ee)_0x3b30ee[_0x1a7bd4(0xff6)][_0x1a7bd4(0xe82)](_0x1a7bd4(0xd43));if(_0x3a813f===_0x1a7bd4(0x120a))window[_0x1a7bd4(0x1321)](_0x28f30a[_0x1a7bd4(0x11b9)]);_0x3a813f==='font-settings-screen'&&(_0x4f766d(),document[_0x1a7bd4(0x2ec)](_0x1a7bd4(0x472))['value']=_0x28f30a['globalSettings'][_0x1a7bd4(0x6ee)]||'',_0x155408(_0x28f30a['globalSettings'][_0x1a7bd4(0x6ee)]||'',!![]));}window['updateListenTogetherIconProxy']=()=>{};function _0x52c3ce(_0x400c1b){const _0x43e5fd=_0x475790,_0x55a0cb=document[_0x43e5fd(0x2ec)]('chat-list-screen'),_0x1f7a48={'messages-view':document[_0x43e5fd(0x2ec)]('messages-view'),'qzone-screen':document[_0x43e5fd(0x2ec)](_0x43e5fd(0x11b2)),'favorites-view':document[_0x43e5fd(0x2ec)](_0x43e5fd(0x1175)),'memories-view':document['getElementById']('memories-view'),'npc-list-view':document['getElementById'](_0x43e5fd(0x155a))},_0x38d3ad=document[_0x43e5fd(0x2ec)](_0x43e5fd(0xdce)),_0x1a4cce=document[_0x43e5fd(0x2ec)](_0x43e5fd(0x1155));_0x8c830a&&document[_0x43e5fd(0x2ec)](_0x43e5fd(0x121e))[_0x43e5fd(0x1177)]();Object[_0x43e5fd(0x74e)](_0x1f7a48)[_0x43e5fd(0xf99)](_0x4cf465=>_0x4cf465[_0x43e5fd(0xff6)][_0x43e5fd(0x1424)](_0x43e5fd(0xd43)));_0x1f7a48[_0x400c1b]&&_0x1f7a48[_0x400c1b][_0x43e5fd(0xff6)][_0x43e5fd(0xe82)](_0x43e5fd(0xd43));document['querySelectorAll'](_0x43e5fd(0x1aa))['forEach'](_0xb691cf=>{const _0xee2c79=_0x43e5fd;_0xb691cf[_0xee2c79(0xff6)][_0xee2c79(0x14c8)](_0xee2c79(0xd43),_0xb691cf[_0xee2c79(0xe93)][_0xee2c79(0x33b)]===_0x400c1b);});_0x400c1b===_0x43e5fd(0x1e2)?(_0x38d3ad[_0x43e5fd(0x589)][_0x43e5fd(0x701)]=_0x43e5fd(0xc67),_0x1a4cce[_0x43e5fd(0x589)]['display']=_0x43e5fd(0xc67)):(_0x38d3ad[_0x43e5fd(0x589)][_0x43e5fd(0x701)]=_0x43e5fd(0x5b1),_0x1a4cce[_0x43e5fd(0x589)][_0x43e5fd(0x701)]='none');_0x400c1b!==_0x43e5fd(0x4ad)&&(_0x4c50bc[_0x43e5fd(0xf99)](_0xd4cff1=>clearInterval(_0xd4cff1)),_0x4c50bc=[]);switch(_0x400c1b){case _0x43e5fd(0x11b2):_0x1f7a48['qzone-screen'][_0x43e5fd(0x589)][_0x43e5fd(0xc34)]='#f0f2f5',_0x3f09c8(0x0),_0xc009fa(),_0x472608();break;case'favorites-view':_0x1f7a48[_0x43e5fd(0x1175)]['style']['backgroundColor']=_0x43e5fd(0x1500),_0x5303e6();break;case _0x43e5fd(0x1e2):break;case _0x43e5fd(0x155a):_0x52fcc7();break;}}function _0x4c42f4(){const _0x55a79d=_0x475790;console['log'](_0x55a79d(0xb2a));}window[_0x475790(0x36c)]=_0x4c42f4;function _0xc009fa(){const _0x4b4f21=_0x475790;if(_0x28f30a&&_0x28f30a[_0x4b4f21(0x1506)]){const _0x3a2e59=_0x28f30a[_0x4b4f21(0x1506)];document[_0x4b4f21(0x2ec)]('qzone-nickname')[_0x4b4f21(0x15f)]=_0x3a2e59[_0x4b4f21(0x19a)],document['getElementById'](_0x4b4f21(0x748))[_0x4b4f21(0xce4)]=_0x3a2e59[_0x4b4f21(0x516)],document[_0x4b4f21(0x2ec)](_0x4b4f21(0x8bb))['src']=_0x3a2e59[_0x4b4f21(0x137d)];}}window[_0x475790(0xadc)]=_0xc009fa;async function _0x37a3ff(){const _0x2d3f1c=_0x475790;_0x5b9d83&&_0x28f30a[_0x2d3f1c(0x1506)]&&await _0x5b9d83[_0x2d3f1c(0x1506)][_0x2d3f1c(0x7c3)](_0x28f30a[_0x2d3f1c(0x1506)]);}function _0x333075(_0x4beadc){const _0x238240=_0x475790;if(!_0x4beadc)return'';const _0x4a3d75=new Date(),_0xbc9508=new Date(_0x4beadc),_0x22f01b=Math[_0x238240(0x5f8)]((_0x4a3d75-_0xbc9508)/0x3e8),_0x164510=Math[_0x238240(0x5f8)](_0x22f01b/0x3c),_0x22af80=Math[_0x238240(0x5f8)](_0x164510/0x3c);if(_0x164510<0x1)return'刚刚';if(_0x164510<0x3c)return _0x164510+'分钟前';if(_0x22af80<0x18)return _0x22af80+_0x238240(0x32c);const _0x13433f=_0xbc9508['getFullYear'](),_0x3fc955=String(_0xbc9508[_0x238240(0xa8f)]()+0x1)[_0x238240(0x58e)](0x2,'0'),_0x545bdd=String(_0xbc9508['getDate']())[_0x238240(0x58e)](0x2,'0'),_0x1f142f=String(_0xbc9508[_0x238240(0x8a5)]())[_0x238240(0x58e)](0x2,'0'),_0x205b53=String(_0xbc9508[_0x238240(0xbc9)]())['padStart'](0x2,'0');return _0x4a3d75[_0x238240(0x4cb)]()===_0x13433f?_0x3fc955+'-'+_0x545bdd+'\x20'+_0x1f142f+':'+_0x205b53:_0x13433f+'-'+_0x3fc955+'-'+_0x545bdd+'\x20'+_0x1f142f+':'+_0x205b53;}function _0x3c9def(_0x4ca6c1){const _0x2a5934=_0x475790,_0x5017a0=document['querySelector']('.qzone-post-container[data-post-id=\x22'+_0x4ca6c1['id']+'\x22]'),_0x18a2a8=!!_0x5017a0,_0x424e0d=_0x18a2a8?_0x5017a0:document[_0x2a5934(0x14ae)](_0x2a5934(0xaa5));!_0x18a2a8&&(_0x424e0d[_0x2a5934(0xdd1)]=_0x2a5934(0xb4f),_0x424e0d[_0x2a5934(0xe93)]['postId']=_0x4ca6c1['id']);const _0x377b70=_0x18a2a8?_0x424e0d['querySelector'](_0x2a5934(0x77b)):document[_0x2a5934(0x14ae)](_0x2a5934(0xaa5));!_0x18a2a8&&(_0x377b70[_0x2a5934(0xdd1)]=_0x2a5934(0xc74));let _0x30dc36='',_0x5bd87e='',_0xf841ac=_0x28f30a['qzoneSettings'][_0x2a5934(0x516)];if(_0x4ca6c1['authorId']===_0x2a5934(0xcc9))_0x30dc36=_0x28f30a['qzoneSettings'][_0x2a5934(0x516)],_0x5bd87e=_0x28f30a['qzoneSettings']['nickname'];else{if(_0x28f30a[_0x2a5934(0x6ce)][_0x4ca6c1['authorId']]){const _0x3da397=_0x28f30a['chats'][_0x4ca6c1[_0x2a5934(0xe87)]];_0x30dc36=_0x3da397[_0x2a5934(0x362)]['aiAvatar']||_0x825cf1,_0x5bd87e=_0x3da397[_0x2a5934(0xe36)];}else _0x5bd87e=_0x2fa4e1(_0x4ca6c1[_0x2a5934(0xb6a)]),_0x30dc36=_0x825cf1;}function _0x3a76e5(_0x5e3779){const _0x116879=_0x2a5934;let _0x493563='';const _0xc15712=_0x5e3779[_0x116879(0x1202)]?_0x116879(0x5f7)+_0x35bd8e(_0x5e3779[_0x116879(0x1202)])['replace'](/\n/g,_0x116879(0xfd7))+_0x116879(0xd21):'';if(_0x5e3779[_0x116879(0xb4b)]===_0x116879(0x5e8))_0x493563='<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>'+_0x35bd8e(_0x5e3779[_0x116879(0x1047)])[_0x116879(0x13ed)](/\n/g,_0x116879(0xfd7))+_0x116879(0xd21);else{if(_0x5e3779[_0x116879(0xb4b)]===_0x116879(0x126c)&&_0x5e3779['imageUrl'])_0x493563=_0xc15712?_0xc15712+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x5e3779['imageUrl']+_0x116879(0x7fd):'<img\x20src=\x22'+_0x5e3779[_0x116879(0x6c6)]+_0x116879(0x6ed);else{if(_0x5e3779[_0x116879(0xb4b)]===_0x116879(0xaa4)){const _0x476f86=_0x28f30a[_0x116879(0x1062)]['enableAiDrawing']&&_0x5e3779[_0x116879(0xe8f)]?_0x116879(0x6d0)+_0x5e3779[_0x116879(0xe8f)]:_0x116879(0xec2);_0x493563=_0xc15712?_0xc15712+_0x116879(0xa9a)+_0x476f86+_0x116879(0x3c9)+_0x5e3779[_0x116879(0xf05)]+_0x116879(0x91d):_0x116879(0x416)+_0x476f86+_0x116879(0x3c9)+_0x5e3779['hiddenContent']+'\x22>';}else{if(_0x5e3779['type']===_0x116879(0xd92)){const _0x58714e=_0x5e3779[_0x116879(0xece)]||(_0x5e3779[_0x116879(0x6c6)]?[_0x5e3779[_0x116879(0x6c6)]]:[]);if(_0x58714e['length']>0x0){const _0xc643b3=_0x58714e[_0x116879(0x9a1)];let _0x5ce357='';_0x5ce357=_0x116879(0x87e)+_0xc643b3+'\x22>',_0x58714e['forEach']((_0x418678,_0x4e8b2c)=>{const _0x2d39ff=_0x116879;_0x5ce357+=_0x2d39ff(0x416)+_0x418678+'\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片'+(_0x4e8b2c+0x1)+_0x2d39ff(0x1140);}),_0x5ce357+='</div>',_0x493563=_0xc15712?''+_0xc15712+_0x5ce357:_0x5ce357;}}}}}return _0x493563;}let _0x1c8609;if(_0x4ca6c1[_0x2a5934(0xb4b)]===_0x2a5934(0x11d5)){const _0x22ffa8=_0x4ca6c1['repostComment']?'<div\x20class=\x22post-content\x22>'+_0x35bd8e(_0x4ca6c1[_0x2a5934(0x169)])[_0x2a5934(0x13ed)](/\n/g,_0x2a5934(0xfd7))+_0x2a5934(0xd21):'';let _0x34df5f=_0x825cf1,_0x1eec29=_0x2a5934(0xe63);if(_0x4ca6c1[_0x2a5934(0x767)][_0x2a5934(0xe87)]===_0x2a5934(0xcc9))_0x34df5f=_0x28f30a[_0x2a5934(0x1506)]['avatar'],_0x1eec29=_0x28f30a[_0x2a5934(0x1506)][_0x2a5934(0x19a)];else{const _0x1d3325=_0x28f30a[_0x2a5934(0x6ce)][_0x4ca6c1['originalPost']['authorId']];_0x1d3325&&(_0x34df5f=_0x1d3325[_0x2a5934(0x362)][_0x2a5934(0xe91)]||_0x825cf1),_0x1eec29=_0x2fa4e1(_0x4ca6c1[_0x2a5934(0x767)][_0x2a5934(0xb6a)]);}_0x1c8609='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x22ffa8+_0x2a5934(0xe08)+_0x34df5f+_0x2a5934(0x14ba)+_0x1eec29+_0x2a5934(0x10f7)+_0x333075(_0x4ca6c1[_0x2a5934(0x767)][_0x2a5934(0x69a)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>'+_0x3a76e5(_0x4ca6c1[_0x2a5934(0x767)])+_0x2a5934(0x12dc);}else _0x1c8609=_0x2a5934(0x5c8)+_0x3a76e5(_0x4ca6c1)+_0x2a5934(0xd21);let _0x4fa89c='';if(_0x4ca6c1[_0x2a5934(0x12b3)]&&_0x4ca6c1[_0x2a5934(0x12b3)]['length']>0x0){const _0x15760a=_0x4ca6c1[_0x2a5934(0x12b3)]['map'](_0x9e518b=>_0x2fa4e1(_0x9e518b))['join']('、');_0x4fa89c=_0x2a5934(0x1398)+_0x15760a+_0x2a5934(0x1406);}let _0x2c2606='';_0x4ca6c1['comments']&&_0x4ca6c1['comments'][_0x2a5934(0x9a1)]>0x0&&(_0x2c2606=_0x2a5934(0x3f7),_0x4ca6c1[_0x2a5934(0x8a4)][_0x2a5934(0xf99)]((_0x3d94c8,_0x365a19)=>{const _0x26d704=_0x2a5934;if(typeof _0x3d94c8===_0x26d704(0x10c0)&&_0x3d94c8!==null&&_0x3d94c8[_0x26d704(0x498)]){const _0x51c767=_0x3d94c8['commenterName'],_0x345fd1=_0x2fa4e1(_0x51c767);let _0x34b20b;_0x41abd3[_0x26d704(0x1e0)](_0x3d94c8[_0x26d704(0x10ca)])?_0x34b20b=_0x26d704(0x416)+_0x3d94c8[_0x26d704(0x10ca)]+_0x26d704(0x5fa):_0x34b20b=_0x35bd8e(_0x3d94c8[_0x26d704(0x10ca)]);let _0x1506c0='';if(_0x3d94c8[_0x26d704(0x2f2)]){const _0x12e4a5=_0x2fa4e1(_0x3d94c8[_0x26d704(0x2f2)]);_0x1506c0=_0x26d704(0x10ea)+_0x345fd1+_0x26d704(0x1115)+_0x12e4a5+_0x26d704(0x5ad)+_0x34b20b;}else _0x1506c0=_0x26d704(0x10ea)+_0x345fd1+_0x26d704(0x5ad)+_0x34b20b;_0x2c2606+=_0x26d704(0x6e5)+_0x4ca6c1['id']+_0x26d704(0x408)+_0x51c767+_0x26d704(0x1271)+_0x345fd1+_0x26d704(0xfc1)+_0x1506c0+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22'+_0x365a19+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}else _0x2c2606+=_0x26d704(0x7a8)+_0x35bd8e(String(_0x3d94c8))+_0x26d704(0x1307);}),_0x2c2606+=_0x2a5934(0xd21));const _0x3b4bc2=_0x28f30a[_0x2a5934(0x1506)]['nickname'],_0x5334c6=_0x4ca6c1[_0x2a5934(0x12b3)]&&_0x4ca6c1[_0x2a5934(0x12b3)][_0x2a5934(0x138a)](_0x3b4bc2),_0x2e9410=_0x28f30a[_0x2a5934(0x114c)]&&_0x28f30a[_0x2a5934(0x114c)][_0x2a5934(0xbf1)](_0x4ca6c1['id']);let _0x18861b='';_0x4ca6c1['type']!==_0x2a5934(0x11d5)&&(_0x18861b=_0x2a5934(0xce0));_0x377b70[_0x2a5934(0xc43)]=_0x2a5934(0x13f3)+_0x30dc36+'\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22'+_0x4ca6c1[_0x2a5934(0xe87)]+_0x2a5934(0x4a3)+_0x5bd87e+_0x2a5934(0x352)+_0x333075(_0x4ca6c1[_0x2a5934(0x69a)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1c8609+_0x2a5934(0x8a6)+_0x18861b+_0x2a5934(0x898)+(_0x5334c6?_0x2a5934(0xd43):'')+_0x2a5934(0x4e4)+(_0x2e9410?'active':'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4fa89c+_0x2a5934(0x816)+_0x2c2606+_0x2a5934(0x14d0)+_0xf841ac+_0x2a5934(0x899);if(!_0x18a2a8){const _0xba9f35=document[_0x2a5934(0x14ae)](_0x2a5934(0xaa5));_0xba9f35[_0x2a5934(0xdd1)]=_0x2a5934(0x8ba),_0xba9f35[_0x2a5934(0xc43)]=_0x2a5934(0x14a5),_0x424e0d[_0x2a5934(0x998)](_0x377b70),_0x424e0d['appendChild'](_0xba9f35);}return _0x424e0d;}async function _0x23b949(_0x170e7f){const _0x228302=_0x475790,_0x19bef3=await _0x5b9d83[_0x228302(0xc7a)][_0x228302(0x6b5)](_0x170e7f);if(!_0x19bef3){const _0x345fc5=document[_0x228302(0x765)](_0x228302(0x10ab)+_0x170e7f+'\x22]');if(_0x345fc5)_0x345fc5[_0x228302(0x1424)]();return;}const _0x3ba0cf=_0x4e343b[_0x228302(0x535)](_0x591bec=>_0x591bec['id']===_0x170e7f);if(_0x3ba0cf>-0x1)_0x4e343b[_0x3ba0cf]=_0x19bef3;const _0x5156c0=await _0x5b9d83[_0x228302(0x101f)][_0x228302(0x67e)]('type')[_0x228302(0x129a)](_0x228302(0x9eb))[_0x228302(0x14b5)]();_0x28f30a[_0x228302(0x114c)]=new Set(_0x5156c0['map'](_0x42200a=>_0x42200a[_0x228302(0x1047)]['id'])),_0x3c9def(_0x19bef3);}function _0xf1c86d(_0x4e1179){const _0x49aaa1=_0x475790,_0x51ebe9=Date[_0x49aaa1(0x487)](),_0xe88451=Math[_0x49aaa1(0x5f8)]((_0x51ebe9-_0x4e1179)/0x3e8),_0x333054=Math[_0x49aaa1(0x5f8)](_0xe88451/0x3c);if(_0x333054<0x2)return'刚刚';if(_0x333054<0x3c)return _0x333054+_0x49aaa1(0x1310);const _0x9c1086=Math[_0x49aaa1(0x5f8)](_0x333054/0x3c);if(_0x9c1086<0x18)return _0x9c1086+_0x49aaa1(0x32c);const _0x56855a=Math[_0x49aaa1(0x5f8)](_0x9c1086/0x18);return _0x56855a+'天前';}async function _0x3c9def(_0x528fb1){const _0x319709=_0x475790,_0x56e733=document[_0x319709(0x765)](_0x319709(0x10ab)+_0x528fb1['id']+'\x22]'),_0x32a199=!!_0x56e733,_0x118030=_0x32a199?_0x56e733:document[_0x319709(0x14ae)](_0x319709(0xaa5));!_0x32a199&&(_0x118030[_0x319709(0xdd1)]=_0x319709(0xb4f),_0x118030[_0x319709(0xe93)][_0x319709(0xa53)]=_0x528fb1['id']);const _0x441ad3=_0x32a199?_0x118030['querySelector'](_0x319709(0x77b)):document[_0x319709(0x14ae)](_0x319709(0xaa5));!_0x32a199&&(_0x441ad3[_0x319709(0xdd1)]=_0x319709(0xc74));let _0x29fe2f='',_0x16a7ed='',_0x4eaaca=_0x28f30a[_0x319709(0x1506)]['avatar'];if(_0x528fb1[_0x319709(0xe87)]===_0x319709(0xcc9))_0x29fe2f=_0x28f30a[_0x319709(0x1506)]['avatar'],_0x16a7ed=_0x28f30a[_0x319709(0x1506)]['nickname'];else{if(_0x28f30a['chats'][_0x528fb1['authorId']]){const _0x2295cd=_0x28f30a[_0x319709(0x6ce)][_0x528fb1[_0x319709(0xe87)]];_0x29fe2f=_0x2295cd[_0x319709(0x362)][_0x319709(0xe91)]||_0x825cf1,_0x16a7ed=_0x2295cd[_0x319709(0xe36)];}else{if(String(_0x528fb1[_0x319709(0xe87)])[_0x319709(0x741)]('npc_')){const _0x587f7d=parseInt(String(_0x528fb1['authorId'])['replace'](_0x319709(0x3c8),''));if(!isNaN(_0x587f7d)){const _0x87241f=await _0x5b9d83['npcs'][_0x319709(0x6b5)](_0x587f7d);_0x87241f?(_0x29fe2f=_0x87241f[_0x319709(0x516)]||_0xd71c66,_0x16a7ed=_0x87241f[_0x319709(0xe36)]):(_0x16a7ed=_0x528fb1[_0x319709(0xb6a)]||_0x319709(0x1170),_0x29fe2f=_0xd71c66);}}else _0x16a7ed=_0x2fa4e1(_0x528fb1[_0x319709(0xb6a)]),_0x29fe2f=_0x825cf1;}}function _0x14d9e8(_0x4ac875){const _0x3d4b4b=_0x319709;let _0x1d4985='';const _0x10c031=_0x4ac875['publicText']?_0x3d4b4b(0x5f7)+_0x35bd8e(_0x4ac875[_0x3d4b4b(0x1202)])[_0x3d4b4b(0x13ed)](/\n/g,'<br>')+_0x3d4b4b(0xd21):'';if(_0x4ac875[_0x3d4b4b(0xb4b)]===_0x3d4b4b(0x5e8))_0x1d4985=_0x3d4b4b(0xff9)+_0x35bd8e(_0x4ac875[_0x3d4b4b(0x1047)])[_0x3d4b4b(0x13ed)](/\n/g,_0x3d4b4b(0xfd7))+_0x3d4b4b(0xd21);else{if(_0x4ac875['type']===_0x3d4b4b(0x126c)&&_0x4ac875[_0x3d4b4b(0x6c6)])_0x1d4985=_0x10c031?_0x10c031+_0x3d4b4b(0xa9a)+_0x4ac875[_0x3d4b4b(0x6c6)]+'\x22\x20class=\x22chat-image\x22></div>':_0x3d4b4b(0x416)+_0x4ac875[_0x3d4b4b(0x6c6)]+'\x22\x20class=\x22chat-image\x22>';else{if(_0x4ac875[_0x3d4b4b(0xb4b)]===_0x3d4b4b(0xaa4)){const _0x5ba51f=_0x28f30a[_0x3d4b4b(0x1062)][_0x3d4b4b(0x10fa)]&&_0x4ac875[_0x3d4b4b(0xe8f)]?_0x3d4b4b(0x6d0)+_0x4ac875['image_prompt']:_0x3d4b4b(0xec2);_0x1d4985=_0x10c031?_0x10c031+_0x3d4b4b(0xa9a)+_0x5ba51f+_0x3d4b4b(0x3c9)+_0x4ac875['hiddenContent']+'\x22></div>':'<img\x20src=\x22'+_0x5ba51f+_0x3d4b4b(0x3c9)+_0x4ac875[_0x3d4b4b(0xf05)]+'\x22>';}else{if(_0x4ac875['type']===_0x3d4b4b(0xd92)){const _0xb1022b=_0x4ac875[_0x3d4b4b(0xece)]||(_0x4ac875[_0x3d4b4b(0x6c6)]?[_0x4ac875[_0x3d4b4b(0x6c6)]]:[]);if(_0xb1022b['length']>0x0){const _0x355a5e=_0xb1022b[_0x3d4b4b(0x9a1)];let _0x265e37='';_0x265e37='<div\x20class=\x22post-images-grid\x20grid-'+_0x355a5e+'\x22>',_0xb1022b['forEach']((_0x256400,_0x3b1066)=>{const _0x48831d=_0x3d4b4b;_0x265e37+=_0x48831d(0x416)+_0x256400+_0x48831d(0x5e0)+(_0x3b1066+0x1)+_0x48831d(0x1140);}),_0x265e37+=_0x3d4b4b(0xd21),_0x1d4985=_0x10c031?''+_0x10c031+_0x265e37:_0x265e37;}}}}}return _0x1d4985;}let _0x2ad7ff;if(_0x528fb1[_0x319709(0xb4b)]===_0x319709(0x11d5)){const _0x388fe0=_0x528fb1[_0x319709(0x169)]?_0x319709(0x5f7)+_0x528fb1[_0x319709(0x169)][_0x319709(0x13ed)](/\n/g,_0x319709(0xfd7))+_0x319709(0xd21):'';let _0x316e83=_0x825cf1,_0x3d50c0='原作者';if(_0x528fb1[_0x319709(0x767)]['authorId']===_0x319709(0xcc9))_0x316e83=_0x28f30a['qzoneSettings'][_0x319709(0x516)],_0x3d50c0=_0x28f30a[_0x319709(0x1506)]['nickname'];else{const _0x253095=_0x28f30a['chats'][_0x528fb1['originalPost'][_0x319709(0xe87)]];_0x253095&&(_0x316e83=_0x253095[_0x319709(0x362)][_0x319709(0xe91)]||_0x825cf1),_0x3d50c0=_0x2fa4e1(_0x528fb1[_0x319709(0x767)][_0x319709(0xb6a)]);}_0x2ad7ff=_0x319709(0x78f)+_0x388fe0+_0x319709(0xe08)+_0x316e83+'\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@'+_0x3d50c0+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x333075(_0x528fb1['originalPost'][_0x319709(0x69a)])+_0x319709(0x673)+_0x14d9e8(_0x528fb1[_0x319709(0x767)])+_0x319709(0x12dc);}else _0x2ad7ff='<div\x20class=\x22post-main-content\x22>'+_0x14d9e8(_0x528fb1)+_0x319709(0xd21);let _0x2a4b38='';if(_0x528fb1['likes']&&_0x528fb1[_0x319709(0x12b3)][_0x319709(0x9a1)]>0x0){const _0x1b6833=_0x528fb1[_0x319709(0x12b3)][_0x319709(0x11c6)](_0xa9770a=>_0x2fa4e1(_0xa9770a))[_0x319709(0xbad)]('、');_0x2a4b38=_0x319709(0x1398)+_0x1b6833+_0x319709(0x1406);}let _0x565edf='';_0x528fb1[_0x319709(0x8a4)]&&_0x528fb1[_0x319709(0x8a4)][_0x319709(0x9a1)]>0x0&&(_0x565edf=_0x319709(0x3f7),_0x528fb1['comments']['forEach']((_0xf966ed,_0x456b75)=>{const _0x5070f3=_0x319709;if(typeof _0xf966ed===_0x5070f3(0x10c0)&&_0xf966ed!==null&&_0xf966ed[_0x5070f3(0x498)]){const _0x19dbe1=_0xf966ed[_0x5070f3(0x498)],_0x7bf406=_0x2fa4e1(_0x19dbe1);let _0x282b37;_0x41abd3[_0x5070f3(0x1e0)](_0xf966ed[_0x5070f3(0x10ca)])?_0x282b37=_0x5070f3(0x416)+_0xf966ed[_0x5070f3(0x10ca)]+'\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>':_0x282b37=_0x35bd8e(_0xf966ed[_0x5070f3(0x10ca)]);let _0x32517b='';if(_0xf966ed[_0x5070f3(0x2f2)]){const _0x166c72=_0x2fa4e1(_0xf966ed['replyTo']);_0x32517b=_0x5070f3(0x10ea)+_0x7bf406+_0x5070f3(0x1115)+_0x166c72+_0x5070f3(0x5ad)+_0x282b37;}else _0x32517b=_0x5070f3(0x10ea)+_0x7bf406+_0x5070f3(0x5ad)+_0x282b37;_0x565edf+=_0x5070f3(0x6e5)+_0x528fb1['id']+_0x5070f3(0x408)+_0x19dbe1+_0x5070f3(0x1271)+_0x7bf406+_0x5070f3(0xfc1)+_0x32517b+_0x5070f3(0x14e5)+_0x456b75+_0x5070f3(0x2a0);}else _0x565edf+='<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>'+String(_0xf966ed)+_0x5070f3(0x1307);}),_0x565edf+=_0x319709(0xd21));const _0x12ebdb=_0x28f30a[_0x319709(0x1506)][_0x319709(0x19a)],_0x195e3f=_0x528fb1[_0x319709(0x12b3)]&&_0x528fb1[_0x319709(0x12b3)][_0x319709(0x138a)](_0x12ebdb),_0x5be7a0=_0x28f30a[_0x319709(0x114c)]&&_0x28f30a[_0x319709(0x114c)][_0x319709(0xbf1)](_0x528fb1['id']);let _0x25c8f4='';_0x528fb1[_0x319709(0xb4b)]!=='repost'&&(_0x25c8f4=_0x319709(0xce0));_0x441ad3['innerHTML']=_0x319709(0x13f3)+_0x29fe2f+_0x319709(0x1546)+_0x528fb1[_0x319709(0xe87)]+_0x319709(0x4a3)+_0x16a7ed+_0x319709(0x352)+_0x333075(_0x528fb1[_0x319709(0x69a)])+_0x319709(0xc52)+_0x2ad7ff+_0x319709(0x8a6)+_0x25c8f4+_0x319709(0x898)+(_0x195e3f?_0x319709(0xd43):'')+_0x319709(0x4e4)+(_0x5be7a0?_0x319709(0xd43):'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2a4b38+_0x319709(0x816)+_0x565edf+_0x319709(0x14d0)+_0x4eaaca+_0x319709(0x899);if(!_0x32a199){const _0xb9a8d9=document[_0x319709(0x14ae)]('div');_0xb9a8d9['className']=_0x319709(0x8ba),_0xb9a8d9['innerHTML']=_0x319709(0x14a5),_0x118030[_0x319709(0x998)](_0x441ad3),_0x118030['appendChild'](_0xb9a8d9);}return _0x118030;}async function _0x23b949(_0x125d22){const _0x107c2b=_0x475790,_0xb0d860=await _0x5b9d83['qzonePosts'][_0x107c2b(0x6b5)](_0x125d22);if(!_0xb0d860){const _0x396c68=document[_0x107c2b(0x765)](_0x107c2b(0x10ab)+_0x125d22+'\x22]');_0x396c68&&_0x396c68[_0x107c2b(0x1424)]();return;}const _0x48d836=_0x4e343b[_0x107c2b(0x535)](_0x561b03=>_0x561b03['id']===_0x125d22);_0x48d836>-0x1&&(_0x4e343b[_0x48d836]=_0xb0d860);const _0x173d2f=await _0x5b9d83[_0x107c2b(0x101f)][_0x107c2b(0x67e)](_0x107c2b(0xb4b))[_0x107c2b(0x129a)](_0x107c2b(0x9eb))[_0x107c2b(0x14b5)]();_0x28f30a[_0x107c2b(0x114c)]=new Set(_0x173d2f['map'](_0x43c2f9=>_0x43c2f9['content']['id'])),await _0x3c9def(_0xb0d860);}async function _0x472608(){const _0x328005=_0x475790,_0xf85c71=document[_0x328005(0x2ec)](_0x328005(0x63d));if(!_0xf85c71)return;const [_0x5c3264,_0x46b6e5]=await Promise[_0x328005(0xa92)]([_0x5b9d83[_0x328005(0xc7a)]['orderBy'](_0x328005(0x69a))[_0x328005(0x6c9)]()[_0x328005(0xebc)](_0x1775cb=>!_0x1775cb[_0x328005(0x12bd)])[_0x328005(0x14b5)](),_0x5b9d83['favorites'][_0x328005(0x67e)](_0x328005(0xb4b))[_0x328005(0x129a)](_0x328005(0x9eb))['toArray']()]);_0x4e343b=_0x5c3264,_0x28f30a['favoritedPostIds']=new Set(_0x46b6e5[_0x328005(0x11c6)](_0x1f3432=>_0x1f3432['content']['id'])),_0xf85c71['innerHTML']='',_0x5adb76=0x0;if(_0x4e343b[_0x328005(0x9a1)]===0x0){_0xf85c71[_0x328005(0xc43)]=_0x328005(0x3c1);return;}_0x3abe5b();}async function _0x3abe5b(){const _0x2456d5=_0x475790;if(_0x168c65)return;_0x168c65=!![];const _0x158653=document['getElementById'](_0x2456d5(0x63d));if(!_0x158653){_0x168c65=![];return;}_0x5d72d6(_0x158653,_0x2456d5(0xe39)),setTimeout(async()=>{const _0x49c1f2=_0x2456d5;_0x66d5be(_0x158653);const _0x218973=_0x5adb76,_0x55c952=_0x5adb76+_0x29b799,_0x3cabd9=_0x4e343b[_0x49c1f2(0x225)](_0x218973,_0x55c952),_0x2d391b=document[_0x49c1f2(0x12c0)]();for(const _0x27971d of _0x3cabd9){const _0x4faf38=await _0x3c9def(_0x27971d);_0x2d391b[_0x49c1f2(0x998)](_0x4faf38);}_0x158653[_0x49c1f2(0x998)](_0x2d391b),_0x5adb76+=_0x3cabd9[_0x49c1f2(0x9a1)],_0x168c65=![];},0x1f4);}function _0x81499(_0x14d1af,_0x4abcca){const _0x31421d=_0x475790,_0xe8ecb5=_0x3006bc['panelEl'],_0x2f986b=_0x3006bc[_0x31421d(0x13d8)];_0x2f986b['innerHTML']='';_0x28f30a[_0x31421d(0xf28)][_0x31421d(0x9a1)]===0x0?_0x2f986b[_0x31421d(0xc43)]=_0x31421d(0x14af):_0x28f30a[_0x31421d(0xf28)][_0x31421d(0xf99)](_0x1a2b73=>{const _0xbdf327=_0x31421d,_0xf321d8=document['createElement'](_0xbdf327(0xaa5));_0xf321d8[_0xbdf327(0xdd1)]='sticker-item',_0xf321d8[_0xbdf327(0x589)][_0xbdf327(0xe00)]=_0xbdf327(0xeb9)+_0x1a2b73[_0xbdf327(0x6d1)]+')',_0xf321d8[_0xbdf327(0x141e)]=_0x1a2b73[_0xbdf327(0xe36)],_0x2f986b[_0xbdf327(0x998)](_0xf321d8);});const _0x5dd630=_0x4abcca[_0x31421d(0x410)](),_0x344195=document[_0x31421d(0x2ec)](_0x31421d(0x1007))['getBoundingClientRect']();_0xe8ecb5[_0x31421d(0x589)]['display']=_0x31421d(0xc67);const _0x3512fb=_0xe8ecb5[_0x31421d(0x410)](),_0x30f77b=_0x3512fb['height'],_0x1c5bbb=_0x3512fb[_0x31421d(0xeb4)];_0xe8ecb5['style']['top']=_0x5dd630[_0x31421d(0xdd5)]-_0x30f77b-0x5-_0x344195[_0x31421d(0xdd5)]+'px';const _0x50763f=_0x5dd630['left']-_0x344195['left'];_0x50763f+_0x1c5bbb>_0x344195[_0x31421d(0xeb4)]?(_0xe8ecb5['style'][_0x31421d(0xd02)]='auto',_0xe8ecb5[_0x31421d(0x589)][_0x31421d(0xc1b)]=_0x31421d(0x102c)):(_0xe8ecb5[_0x31421d(0x589)][_0x31421d(0xd02)]=_0x50763f+'px',_0xe8ecb5['style']['right']='auto'),_0x3006bc[_0x31421d(0x404)]=!![],_0x3006bc[_0x31421d(0xa50)]=_0x14d1af;}function _0x4feed8(){const _0x388490=_0x475790;_0x3006bc['isOpen']&&(_0x3006bc['panelEl'][_0x388490(0x589)]['display']='none',_0x3006bc[_0x388490(0x404)]=![],_0x3006bc[_0x388490(0xa50)]=null);}async function _0x4cc08e(_0x4753ad,_0x248453){const _0x513f4b=_0x475790;if(!_0x248453||!_0x248453[_0x513f4b(0x6d1)])return;const _0x4b8c4d=await _0x5b9d83[_0x513f4b(0xc7a)][_0x513f4b(0x6b5)](_0x4753ad);if(!_0x4b8c4d){console[_0x513f4b(0x1518)](_0x513f4b(0xd1c),_0x4753ad);return;}!_0x4b8c4d[_0x513f4b(0x8a4)]&&(_0x4b8c4d[_0x513f4b(0x8a4)]=[]);const _0x22a094={'commenterName':_0x28f30a[_0x513f4b(0x1506)][_0x513f4b(0x19a)],'text':_0x248453['url'],'meaning':_0x248453['name'],'timestamp':Date[_0x513f4b(0x487)]()};_0x4b8c4d['comments'][_0x513f4b(0x367)](_0x22a094),await _0x5b9d83[_0x513f4b(0xc7a)][_0x513f4b(0x130a)](_0x4753ad,{'comments':_0x4b8c4d[_0x513f4b(0x8a4)]}),_0x4feed8(),await _0x472608();const _0x1f6660=(_0x4b8c4d['publicText']||_0x4b8c4d[_0x513f4b(0x1047)]||_0x513f4b(0xe1b))['substring'](0x0,0x1e);for(const _0x351cff in _0x28f30a[_0x513f4b(0x6ce)]){const _0xe0f95d=_0x28f30a[_0x513f4b(0x6ce)][_0x351cff];if(!_0xe0f95d[_0x513f4b(0x1423)]){const _0x38a164=_0x513f4b(0xd18)+_0x28f30a[_0x513f4b(0x1506)]['nickname']+_0x513f4b(0x13ef)+_0x4753ad+_0x513f4b(0x13e2)+_0x1f6660+_0x513f4b(0x111e)+_0x248453[_0x513f4b(0xe36)]+'”。请你对此作出回应。]',_0x274fb1={'role':'system','content':_0x38a164,'timestamp':Date[_0x513f4b(0x487)](),'isHidden':!![]};_0xe0f95d[_0x513f4b(0x12c3)][_0x513f4b(0x367)](_0x274fb1),await _0x5b9d83[_0x513f4b(0x6ce)][_0x513f4b(0x7c3)](_0xe0f95d);}}}function _0x5355eb(_0x19afd0){const _0x4748da=_0x475790;_0x2bbd76=_0x19afd0,document['getElementById'](_0x4748da(0x1454))['value']='',document[_0x4748da(0x2ec)](_0x4748da(0x41d))[_0x4748da(0xff6)]['add'](_0x4748da(0x149d));}function _0xaa70b4(){const _0x171fbc=_0x475790;document[_0x171fbc(0x2ec)](_0x171fbc(0x41d))[_0x171fbc(0xff6)]['remove'](_0x171fbc(0x149d)),_0x2bbd76=null;}async function _0x304e57(){const _0x2ec6bc=_0x475790;if(!_0x2bbd76)return;const _0x29b38f=document['getElementById'](_0x2ec6bc(0x1454))['value'][_0x2ec6bc(0x97e)](),_0x487f78=await _0x5b9d83[_0x2ec6bc(0xc7a)]['get'](_0x2bbd76);if(!_0x487f78){alert(_0x2ec6bc(0xca8)),_0xaa70b4();return;}const _0x523509={'type':'repost','timestamp':Date['now'](),'authorId':'user','repostComment':_0x29b38f,'originalPost':_0x487f78,'visibleGroupIds':null};await _0x5b9d83[_0x2ec6bc(0xc7a)][_0x2ec6bc(0xe82)](_0x523509),_0xaa70b4(),await _0x472608(),alert(_0x2ec6bc(0xd1a));}function _0x2f6186(_0x57bc6d){const _0x158292=_0x475790,_0x525c29=document[_0x158292(0x2ec)](_0x158292(0x678));_0x525c29['innerHTML']='';if(_0x57bc6d[_0x158292(0x9a1)]===0x0){const _0x461264=document[_0x158292(0x2ec)](_0x158292(0x653))['value'],_0x165e58=_0x461264?_0x158292(0xbf6):_0x158292(0x66a);_0x525c29['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>'+_0x165e58+'</p>';return;}for(const _0x7f76f6 of _0x57bc6d){const _0x5d4d18=document[_0x158292(0x14ae)](_0x158292(0xaa5));_0x5d4d18[_0x158292(0xdd1)]=_0x158292(0xf1a),_0x5d4d18['dataset'][_0x158292(0x12de)]=_0x7f76f6['id'];let _0x1de57b='',_0x62101e='',_0x116ee3='',_0x29ac63='';if(_0x7f76f6['type']===_0x158292(0x9eb)){const _0x3cba8a=_0x7f76f6[_0x158292(0x1047)];_0x116ee3='来自动态';let _0x109d82=_0x825cf1,_0x4f221d=_0x158292(0x58f);if(_0x3cba8a[_0x158292(0xe87)]===_0x158292(0xcc9))_0x109d82=_0x28f30a[_0x158292(0x1506)][_0x158292(0x516)],_0x4f221d=_0x28f30a[_0x158292(0x1506)]['nickname'];else _0x28f30a[_0x158292(0x6ce)][_0x3cba8a[_0x158292(0xe87)]]&&(_0x109d82=_0x28f30a['chats'][_0x3cba8a[_0x158292(0xe87)]][_0x158292(0x362)]['aiAvatar'],_0x4f221d=_0x28f30a[_0x158292(0x6ce)][_0x3cba8a[_0x158292(0xe87)]][_0x158292(0xe36)]);_0x1de57b=_0x158292(0x416)+_0x109d82+_0x158292(0xc08)+_0x4f221d+_0x158292(0xbe0);const _0x506a11=_0x3cba8a[_0x158292(0x1202)]?_0x158292(0x5f7)+_0x3cba8a[_0x158292(0x1202)]['replace'](/\n/g,_0x158292(0xfd7))+_0x158292(0xd21):'';if(_0x3cba8a[_0x158292(0xb4b)]==='shuoshuo')_0x62101e=_0x158292(0x5f7)+_0x3cba8a[_0x158292(0x1047)][_0x158292(0x13ed)](/\n/g,'<br>')+_0x158292(0xd21);else{if(_0x3cba8a['type']===_0x158292(0x126c)&&_0x3cba8a['imageUrl']){const _0x19dffb=_0x28f30a['globalSettings'][_0x158292(0x10fa)]&&_0x3cba8a['image_prompt']?_0x158292(0x6d0)+_0x3cba8a['image_prompt']:_0x158292(0xec2);_0x62101e=_0x506a11?_0x506a11+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x19dffb+_0x158292(0x7fd):_0x158292(0x416)+_0x19dffb+_0x158292(0x6ed);}else{if(_0x3cba8a[_0x158292(0xb4b)]===_0x158292(0xaa4)){const _0x263c15=_0x28f30a[_0x158292(0x1062)][_0x158292(0x10fa)]&&_0x3cba8a[_0x158292(0xe8f)]?_0x158292(0x6d0)+_0x3cba8a[_0x158292(0xe8f)]:_0x158292(0xec2);_0x62101e=_0x506a11?_0x506a11+_0x158292(0xa9a)+_0x263c15+_0x158292(0x3c9)+_0x3cba8a[_0x158292(0xf05)]+'\x22></div>':_0x158292(0x416)+_0x263c15+_0x158292(0x3c9)+_0x3cba8a['hiddenContent']+'\x22>';}}}let _0x22f2ce='';_0x3cba8a[_0x158292(0x12b3)]&&_0x3cba8a[_0x158292(0x12b3)]['length']>0x0&&(_0x22f2ce='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+_0x3cba8a[_0x158292(0x12b3)][_0x158292(0xbad)]('、')+_0x158292(0xc42));let _0x34416b='';_0x3cba8a[_0x158292(0x8a4)]&&_0x3cba8a[_0x158292(0x8a4)]['length']>0x0&&(_0x34416b='<div\x20class=\x22post-comments-container\x22>',_0x3cba8a[_0x158292(0x8a4)]['forEach']((_0x15e14d,_0x598652)=>{const _0x38d9c3=_0x158292;if(typeof _0x15e14d===_0x38d9c3(0x10c0)&&_0x15e14d!==null&&_0x15e14d[_0x38d9c3(0x498)]){const _0x2d2aee=_0x15e14d[_0x38d9c3(0x498)],_0x544a05=_0x2fa4e1(_0x2d2aee);let _0x15fa79;_0x41abd3[_0x38d9c3(0x1e0)](_0x15e14d[_0x38d9c3(0x10ca)])?_0x15fa79=_0x38d9c3(0x416)+_0x15e14d['text']+_0x38d9c3(0x5fa):_0x15fa79=_0x15e14d[_0x38d9c3(0x10ca)];let _0x1a2e46='';if(_0x15e14d[_0x38d9c3(0x2f2)]){const _0x290668=_0x2fa4e1(_0x15e14d[_0x38d9c3(0x2f2)]);_0x1a2e46=_0x38d9c3(0x10ea)+_0x544a05+_0x38d9c3(0x1115)+_0x290668+_0x38d9c3(0x5ad)+_0x15fa79;}else _0x1a2e46=_0x38d9c3(0x10ea)+_0x544a05+_0x38d9c3(0x5ad)+_0x15fa79;_0x34416b+=_0x38d9c3(0x6e5)+_0x3cba8a['id']+_0x38d9c3(0x408)+_0x2d2aee+_0x38d9c3(0x1271)+_0x544a05+_0x38d9c3(0x8f5)+_0x1a2e46+_0x38d9c3(0x1028)+_0x598652+_0x38d9c3(0x9ae);}else _0x34416b+=_0x38d9c3(0x79d)+String(_0x15e14d)+_0x38d9c3(0xd05);}),_0x34416b+=_0x158292(0xd21)),_0x29ac63=''+_0x22f2ce+_0x34416b;}else{if(_0x7f76f6[_0x158292(0xb4b)]==='chat_message'){const _0x2af250=_0x7f76f6[_0x158292(0x1047)],_0xfcf3ba=_0x28f30a[_0x158292(0x6ce)][_0x7f76f6[_0x158292(0xdd0)]];if(!_0xfcf3ba)continue;_0x116ee3=_0x158292(0x145f)+_0xfcf3ba[_0x158292(0xe36)]+_0x158292(0x13f1);const _0x436499=_0x2af250['role']===_0x158292(0xcc9);let _0x44c2c9,_0x516934;if(_0x436499)_0x44c2c9=_0xfcf3ba[_0x158292(0x1423)]?_0xfcf3ba[_0x158292(0x362)][_0x158292(0xa28)]||'我':'我',_0x516934=_0xfcf3ba[_0x158292(0x362)][_0x158292(0x10a3)]||(_0xfcf3ba[_0x158292(0x1423)]?_0x3ba305:_0x825cf1);else{if(_0xfcf3ba['isGroup']){const _0x4dc7d6=_0xfcf3ba[_0x158292(0x10f2)][_0x158292(0x412)](_0x5b353f=>_0x5b353f['originalName']===_0x2af250[_0x158292(0x1361)]);_0x44c2c9=_0x2af250['senderName'],_0x516934=_0x4dc7d6?_0x4dc7d6[_0x158292(0x516)]:_0xd71c66;}else _0x44c2c9=_0xfcf3ba['name'],_0x516934=_0xfcf3ba[_0x158292(0x362)]['aiAvatar']||_0x825cf1;}_0x1de57b='<img\x20src=\x22'+_0x516934+_0x158292(0xc08)+_0x44c2c9+_0x158292(0xbe0);if(typeof _0x2af250['content']===_0x158292(0x863)&&_0x41abd3[_0x158292(0x1e0)](_0x2af250[_0x158292(0x1047)]))_0x62101e=_0x158292(0x416)+_0x2af250['content']+_0x158292(0xd4a);else Array[_0x158292(0x624)](_0x2af250['content'])&&_0x2af250[_0x158292(0x1047)][0x0]?.['type']==='image_url'?_0x62101e='<img\x20src=\x22'+_0x2af250[_0x158292(0x1047)][0x0][_0x158292(0x1014)][_0x158292(0x6d1)]+'\x22\x20class=\x22chat-image\x22>':_0x62101e=String(_0x2af250[_0x158292(0x1047)]||'')['replace'](/\n/g,_0x158292(0xfd7));}else{if(_0x7f76f6[_0x158292(0xb4b)]==='char_diary'){const _0xfc8c01=_0x7f76f6[_0x158292(0x1047)];_0x116ee3=_0x158292(0xe9f)+_0xfc8c01[_0x158292(0x5a4)]+_0x158292(0x1456);const _0x2983b4=_0x28f30a[_0x158292(0x6ce)][_0xfc8c01[_0x158292(0x1061)]],_0x37a548=_0x2983b4?_0x2983b4[_0x158292(0x362)][_0x158292(0xe91)]:_0x825cf1;_0x1de57b=_0x158292(0x416)+_0x37a548+_0x158292(0xc08)+_0xfc8c01['characterName']+_0x158292(0xbe0);const _0x48a20d=_0xfc8c01[_0x158292(0x1047)]||'',_0x1ce1c0=_0x35bd8e(_0x48a20d)[_0x158292(0x13ed)](/\n/g,_0x158292(0xfd7));_0x62101e=_0x158292(0x735)+_0xfc8c01[_0x158292(0x141e)]+_0x158292(0x13a2)+_0x1ce1c0+_0x158292(0xf83);}else{if(_0x7f76f6[_0x158292(0xb4b)]===_0x158292(0xa1b)){const _0x370d74=_0x7f76f6[_0x158292(0x1047)];_0x116ee3=_0x158292(0xe9f)+_0x370d74[_0x158292(0x5a4)]+_0x158292(0x99e);const _0x171e23=_0x28f30a[_0x158292(0x6ce)][_0x370d74[_0x158292(0x1061)]],_0x3ff89b=_0x171e23?_0x171e23['settings'][_0x158292(0xe91)]:_0x825cf1;_0x1de57b='<img\x20src=\x22'+_0x3ff89b+_0x158292(0xc08)+_0x370d74['characterName']+'</div></div>',_0x62101e=_0x158292(0xfc6)+_0x370d74[_0x158292(0x141e)]+_0x158292(0xf4f)+(_0x370d74[_0x158292(0x1047)]||'')[_0x158292(0x13ed)](/\n/g,_0x158292(0xfd7))+_0x158292(0x1065);}else{if(_0x7f76f6[_0x158292(0xb4b)]===_0x158292(0x10a1)){const _0x107f14=_0x7f76f6[_0x158292(0x1047)];_0x116ee3=_0x158292(0xe9f)+_0x107f14['characterName']+_0x158292(0xcbb);const _0x5cf934=_0x28f30a[_0x158292(0x6ce)][_0x107f14[_0x158292(0x1061)]],_0x315ba0=_0x5cf934?_0x5cf934[_0x158292(0x362)]['aiAvatar']:_0x825cf1;_0x1de57b='<img\x20src=\x22'+_0x315ba0+_0x158292(0xc08)+_0x107f14['characterName']+_0x158292(0xbe0),_0x62101e='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>'+_0x107f14['title']+_0x158292(0xcc2)+_0x107f14[_0x158292(0x1047)][_0x158292(0x13ed)](/\n/g,'<br>')+_0x158292(0x7a7);}}}}}_0x5d4d18[_0x158292(0xc43)]=_0x158292(0x14ab)+_0x1de57b+_0x158292(0x101d)+_0x116ee3+_0x158292(0xcfc)+_0x62101e+_0x158292(0x80b)+_0x29ac63,_0x525c29[_0x158292(0x998)](_0x5d4d18);}}async function _0x5303e6(){const _0x1ff7d8=_0x475790;allFavoriteItems=await _0x5b9d83[_0x1ff7d8(0x101f)][_0x1ff7d8(0x106d)](_0x1ff7d8(0x69a))[_0x1ff7d8(0x6c9)]()['toArray']();const _0x4b0af3=document['getElementById'](_0x1ff7d8(0x653)),_0x171d8d=document[_0x1ff7d8(0x2ec)](_0x1ff7d8(0x9bb));_0x4b0af3[_0x1ff7d8(0x11a4)]='',_0x171d8d[_0x1ff7d8(0x589)][_0x1ff7d8(0x701)]='none',_0x2f6186(allFavoriteItems);}function _0x4f7890(){const _0x1931ce=_0x475790;document[_0x1931ce(0x2ec)]('post-public-text')[_0x1931ce(0x11a4)]='',document[_0x1931ce(0x2ec)](_0x1931ce(0x104c))[_0x1931ce(0xce4)]='',document['getElementById'](_0x1931ce(0x1513))[_0x1931ce(0x11a4)]='',document[_0x1931ce(0x2ec)](_0x1931ce(0xe8a))['classList'][_0x1931ce(0x1424)](_0x1931ce(0x149d)),document[_0x1931ce(0x2ec)](_0x1931ce(0x128d))[_0x1931ce(0x589)][_0x1931ce(0x701)]=_0x1931ce(0x5b1),document[_0x1931ce(0x2ec)]('post-local-image-input')[_0x1931ce(0x11a4)]='',document[_0x1931ce(0x2ec)](_0x1931ce(0x5bf))[_0x1931ce(0x11a4)]='',document[_0x1931ce(0x2ec)](_0x1931ce(0x564))[_0x1931ce(0x1177)]();}async function _0x1498c4(){const _0x373620=_0x475790,_0x2d3191=await _0x4436ba('确认清理冗余数据？',_0x373620(0xfb5),{'confirmButtonClass':_0x373620(0xd8f),'confirmText':_0x373620(0x537)});if(!_0x2d3191)return;await _0x34d596(_0x373620(0x13e4),_0x373620(0x5f1)),console['log'](_0x373620(0x3cc));let _0x3e89ce={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0x5b9d83['transaction']('rw',_0x5b9d83[_0x373620(0x7ed)],async()=>{const _0x40f226=_0x373620,_0x19754c=await _0x5b9d83[_0x40f226(0x6ce)][_0x40f226(0x14b5)](),_0x188844=await _0x5b9d83[_0x40f226(0x8f4)][_0x40f226(0x14b5)](),_0x118e58=new Set(_0x19754c[_0x40f226(0x11c6)](_0x40a491=>_0x40a491['id'])),_0x3eb950=new Set(_0x188844[_0x40f226(0x11c6)](_0x3ba3aa=>'npc_'+_0x3ba3aa['id'])),_0x37ca20=new Set(_0x19754c[_0x40f226(0xebc)](_0x1c4194=>!_0x1c4194[_0x40f226(0x1423)])[_0x40f226(0x11c6)](_0x46dac4=>_0x46dac4['originalName']));_0x37ca20['add'](_0x28f30a[_0x40f226(0x1506)]['nickname']||_0x40f226(0x450)),_0x188844[_0x40f226(0xf99)](_0xb7e4e0=>_0x37ca20[_0x40f226(0xe82)](_0xb7e4e0['name']));for(const _0x2bde3d of _0x19754c){let _0x1e56a0=![];if(_0x2bde3d[_0x40f226(0x1423)]&&_0x2bde3d[_0x40f226(0x10f2)]){const _0x23caf3=_0x2bde3d[_0x40f226(0x10f2)][_0x40f226(0x9a1)];_0x2bde3d['members']=_0x2bde3d[_0x40f226(0x10f2)][_0x40f226(0xebc)](_0x4428e5=>_0x118e58[_0x40f226(0xbf1)](_0x4428e5['id'])||_0x3eb950[_0x40f226(0xbf1)](_0x4428e5['id'])),_0x2bde3d['members']['length']<_0x23caf3&&(_0x3e89ce[_0x40f226(0x21b)]+=_0x23caf3-_0x2bde3d[_0x40f226(0x10f2)][_0x40f226(0x9a1)],_0x1e56a0=!![]);}if(_0x2bde3d[_0x40f226(0x362)]?.[_0x40f226(0x239)]?.['length']>0x0){const _0x57696a=_0x2bde3d['settings'][_0x40f226(0x239)][_0x40f226(0x9a1)];_0x2bde3d[_0x40f226(0x362)][_0x40f226(0x239)]=_0x2bde3d[_0x40f226(0x362)][_0x40f226(0x239)][_0x40f226(0xebc)](_0x59cecd=>_0x118e58['has'](_0x59cecd)),_0x2bde3d['settings']['linkedMemoryChatIds']['length']<_0x57696a&&(_0x3e89ce[_0x40f226(0x1375)]+=_0x57696a-_0x2bde3d['settings'][_0x40f226(0x239)][_0x40f226(0x9a1)],_0x1e56a0=!![]);}_0x1e56a0&&await _0x5b9d83[_0x40f226(0x6ce)][_0x40f226(0x7c3)](_0x2bde3d);}const _0xf88458=await _0x5b9d83['qzonePosts']['toArray']();for(const _0x39dbb9 of _0xf88458){let _0x249bd9=![];const _0x35350a=_0x39dbb9[_0x40f226(0xe87)]===_0x40f226(0xcc9)||_0x118e58[_0x40f226(0xbf1)](_0x39dbb9[_0x40f226(0xe87)])||_0x3eb950['has'](_0x39dbb9[_0x40f226(0xe87)]);if(!_0x35350a){await _0x5b9d83[_0x40f226(0xc7a)][_0x40f226(0x54b)](_0x39dbb9['id']),_0x3e89ce[_0x40f226(0xe1e)]++;continue;}if(_0x39dbb9[_0x40f226(0x12b3)]&&_0x39dbb9[_0x40f226(0x12b3)][_0x40f226(0x9a1)]>0x0){const _0x46121c=_0x39dbb9[_0x40f226(0x12b3)][_0x40f226(0x9a1)];_0x39dbb9[_0x40f226(0x12b3)]=_0x39dbb9[_0x40f226(0x12b3)]['filter'](_0x5ae2c0=>_0x37ca20['has'](_0x5ae2c0)),_0x39dbb9[_0x40f226(0x12b3)][_0x40f226(0x9a1)]<_0x46121c&&(_0x3e89ce[_0x40f226(0x12b3)]+=_0x46121c-_0x39dbb9['likes'][_0x40f226(0x9a1)],_0x249bd9=!![]);}if(_0x39dbb9[_0x40f226(0x8a4)]&&_0x39dbb9[_0x40f226(0x8a4)][_0x40f226(0x9a1)]>0x0){const _0x268061=_0x39dbb9[_0x40f226(0x8a4)][_0x40f226(0x9a1)];_0x39dbb9[_0x40f226(0x8a4)]=_0x39dbb9[_0x40f226(0x8a4)][_0x40f226(0xebc)](_0x1fc9f4=>{const _0x5027b4=_0x40f226;if(typeof _0x1fc9f4===_0x5027b4(0x10c0)&&_0x1fc9f4[_0x5027b4(0x498)])return _0x37ca20[_0x5027b4(0xbf1)](_0x1fc9f4[_0x5027b4(0x498)]);return!![];}),_0x39dbb9[_0x40f226(0x8a4)]['length']<_0x268061&&(_0x3e89ce[_0x40f226(0x8a4)]+=_0x268061-_0x39dbb9['comments']['length'],_0x249bd9=!![]);}_0x249bd9&&await _0x5b9d83['qzonePosts'][_0x40f226(0x7c3)](_0x39dbb9);}await _0x5b9d83['memories'][_0x40f226(0x67e)](_0x40f226(0xdd0))['noneOf']([..._0x118e58])[_0x40f226(0x54b)]()[_0x40f226(0x333)](_0x5683bf=>_0x3e89ce['memories']+=_0x5683bf),await _0x5b9d83[_0x40f226(0x924)][_0x40f226(0x67e)](_0x40f226(0xdd0))[_0x40f226(0xf21)]([..._0x118e58])['delete']()[_0x40f226(0x333)](_0x284036=>_0x3e89ce[_0x40f226(0x924)]+=_0x284036);const _0x460c20=await _0x5b9d83['renderingRules'][_0x40f226(0x14b5)]();for(const _0x2df41c of _0x460c20){_0x2df41c['chatId']!==_0x40f226(0x283)&&!_0x118e58[_0x40f226(0xbf1)](_0x2df41c[_0x40f226(0xdd0)])&&(await _0x5b9d83['renderingRules']['delete'](_0x2df41c['id']),_0x3e89ce['renderingRules']++);}});let _0x536c15=_0x373620(0xec0),_0x42a9c4=![];Object[_0x373620(0x127b)](_0x3e89ce)[_0x373620(0xf99)](([_0x539fef,_0x881e7b])=>{const _0x69a1d1=_0x373620;if(_0x881e7b>0x0){const _0x10905a={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':_0x69a1d1(0x681),'renderingRules':'渲染规则','groupMembers':'群成员','chatLinks':_0x69a1d1(0xc27)};_0x536c15+=_0x69a1d1(0x99c)+_0x881e7b+_0x69a1d1(0x250)+(_0x10905a[_0x539fef]||_0x539fef)+'。\x0a',_0x42a9c4=!![];}});!_0x42a9c4&&(_0x536c15=_0x373620(0x10bc));_0x536c15+=_0x373620(0xeed),await _0x34d596(_0x373620(0x699),_0x536c15);const _0x31876a=await _0x4436ba('刷新页面？',_0x373620(0x9f7));_0x31876a&&location[_0x373620(0x7e3)]();}catch(_0x4b4f4f){console[_0x373620(0x1518)](_0x373620(0x1196),_0x4b4f4f),await _0x34d596('清理失败',_0x373620(0x5a6)+_0x4b4f4f['message']);}}async function _0x44f9bf(){const _0x22bb4e=_0x475790;try{const _0x3b9c57={'version':0x1,'timestamp':Date['now']()},[_0x2ce8e8,_0x4e70c3,_0x2f92c6,_0x3ac012,_0x275080,_0x183083,_0x1fcd7e,_0x1aef81,_0x8703bc,_0x301dfd,_0x5abadb,_0x735f73,_0x437caa,_0x2abf95,_0x5ef2aa,_0x2d1a61,_0x4317e2,_0x465e30,_0x380895,_0x130adc,_0x16adbc,_0x5c5586,_0x329ea2,_0x48d4a3,_0x2debfc]=await Promise['all']([_0x5b9d83['chats'][_0x22bb4e(0x14b5)](),_0x5b9d83['worldBooks'][_0x22bb4e(0x14b5)](),_0x5b9d83['userStickers'][_0x22bb4e(0x14b5)](),_0x5b9d83[_0x22bb4e(0x1537)][_0x22bb4e(0x6b5)]('main'),_0x5b9d83[_0x22bb4e(0x1062)][_0x22bb4e(0x6b5)](_0x22bb4e(0x1130)),_0x5b9d83[_0x22bb4e(0x5f0)][_0x22bb4e(0x14b5)](),_0x5b9d83[_0x22bb4e(0x1465)][_0x22bb4e(0x6b5)](_0x22bb4e(0x1130)),_0x5b9d83[_0x22bb4e(0x1506)][_0x22bb4e(0x6b5)](_0x22bb4e(0x1130)),_0x5b9d83['qzonePosts'][_0x22bb4e(0x14b5)](),_0x5b9d83[_0x22bb4e(0x550)][_0x22bb4e(0x14b5)](),_0x5b9d83['qzonePhotos'][_0x22bb4e(0x14b5)](),_0x5b9d83[_0x22bb4e(0x101f)][_0x22bb4e(0x14b5)](),_0x5b9d83[_0x22bb4e(0x1479)][_0x22bb4e(0x14b5)](),_0x5b9d83[_0x22bb4e(0xf49)][_0x22bb4e(0x14b5)](),_0x5b9d83[_0x22bb4e(0x5c0)]['toArray'](),_0x5b9d83[_0x22bb4e(0xa72)][_0x22bb4e(0x14b5)](),_0x5b9d83[_0x22bb4e(0x120e)][_0x22bb4e(0x14b5)](),_0x5b9d83[_0x22bb4e(0x924)]['toArray'](),_0x5b9d83[_0x22bb4e(0xccb)]['toArray'](),_0x5b9d83[_0x22bb4e(0x3d9)][_0x22bb4e(0x14b5)](),_0x5b9d83[_0x22bb4e(0xc70)][_0x22bb4e(0x14b5)](),_0x5b9d83['appearancePresets'][_0x22bb4e(0x14b5)](),_0x5b9d83['presets'][_0x22bb4e(0x14b5)](),_0x5b9d83[_0x22bb4e(0x2f1)][_0x22bb4e(0x14b5)](),_0x5b9d83[_0x22bb4e(0x8f4)][_0x22bb4e(0x14b5)]()]);Object[_0x22bb4e(0x92a)](_0x3b9c57,{'chats':_0x2ce8e8,'worldBooks':_0x4e70c3,'userStickers':_0x2f92c6,'apiConfig':_0x3ac012,'globalSettings':_0x275080,'personaPresets':_0x183083,'musicLibrary':_0x1fcd7e,'qzoneSettings':_0x1aef81,'qzonePosts':_0x8703bc,'qzoneAlbums':_0x301dfd,'qzonePhotos':_0x5abadb,'favorites':_0x735f73,'qzoneGroups':_0x437caa,'memories':_0x2abf95,'worldBookCategories':_0x5ef2aa,'apiPresets':_0x2d1a61,'shoppingProducts':_0x4317e2,'callRecords':_0x465e30,'renderingRules':_0x380895,'doubanPosts':_0x130adc,'stickerCategories':_0x16adbc,'appearancePresets':_0x5c5586,'presets':_0x329ea2,'presetCategories':_0x48d4a3,'npcs':_0x2debfc});const _0x3796dc=new Blob([JSON[_0x22bb4e(0xe4d)](_0x3b9c57,null,0x2)],{'type':_0x22bb4e(0x1446)}),_0x4b9e83=URL[_0x22bb4e(0x23d)](_0x3796dc),_0x46f9a5=Object[_0x22bb4e(0x92a)](document[_0x22bb4e(0x14ae)]('a'),{'href':_0x4b9e83,'download':_0x22bb4e(0x103c)+new Date()['toISOString']()['split']('T')[0x0]+'.json'});_0x46f9a5[_0x22bb4e(0x1177)](),URL[_0x22bb4e(0x18d)](_0x4b9e83),await _0x34d596('导出成功',_0x22bb4e(0xf7d));}catch(_0x3f0595){console[_0x22bb4e(0x1518)](_0x22bb4e(0x5e3),_0x3f0595),await _0x34d596(_0x22bb4e(0x4aa),_0x22bb4e(0x5a6)+_0x3f0595['message']);}}async function _0x45b3df(_0x508308){const _0x145fab=_0x475790;try{await _0x5b9d83[_0x145fab(0xe5b)]('rw',_0x5b9d83['tables'],async()=>{const _0x220b9e=_0x145fab;for(const _0x377b52 of _0x5b9d83[_0x220b9e(0x7ed)]){await _0x377b52['clear']();}for(const _0x4b8f50 in _0x508308){Array[_0x220b9e(0x624)](_0x508308[_0x4b8f50])&&(console[_0x220b9e(0x415)](_0x220b9e(0x1223)+_0x4b8f50+_0x220b9e(0x7c4)+_0x508308[_0x4b8f50]['length']),await _0x5b9d83[_0x220b9e(0xd32)](_0x4b8f50)[_0x220b9e(0xdb2)](_0x508308[_0x4b8f50]));}});}catch(_0x13c427){throw new Error(_0x145fab(0x1129)+_0x13c427[_0x145fab(0x13bc)]);}}async function _0x366913(_0x36426e){const _0x42195e=_0x475790;if(!_0x36426e)return;await _0x34d596(_0x42195e(0x13e4),_0x42195e(0x1fa));try{const _0x2c64f8=await _0x36426e[_0x42195e(0x10ca)](),_0x3887f9=JSON[_0x42195e(0xd91)](_0x2c64f8);let _0xc7fa16,_0x3a025b;if(_0x3887f9['data']&&typeof _0x3887f9['data']==='object'&&(_0x3887f9[_0x42195e(0x1418)][_0x42195e(0x6ce)]||_0x3887f9[_0x42195e(0x1418)][_0x42195e(0x13b9)]))console[_0x42195e(0x415)](_0x42195e(0x1ae)),_0xc7fa16=_0x3887f9['data'],_0x3a025b=_0x42195e(0x211);else{if(_0x3887f9[_0x42195e(0x6ce)]||_0x3887f9[_0x42195e(0x13b9)])console[_0x42195e(0x415)]('检测到旧版完整备份文件...'),_0xc7fa16=_0x3887f9,_0x3a025b=_0x42195e(0x1073);else throw new Error('文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。');}pendingBackupData={'type':_0x3a025b,'content':_0xc7fa16},_0x4d8ef7(_0xc7fa16);}catch(_0x489be3){console[_0x42195e(0x1518)]('导入数据时出错:',_0x489be3),pendingBackupData=null,await _0x34d596(_0x42195e(0x493),'文件解析或应用失败:\x20'+_0x489be3['message']);}}function _0x4d8ef7(_0x445053){const _0xe0f096=_0x475790,_0xa6629b=document[_0xe0f096(0x2ec)](_0xe0f096(0x1514)),_0x102f4b=document[_0xe0f096(0x2ec)](_0xe0f096(0x1459));_0x102f4b[_0xe0f096(0xc43)]='';const _0x53408a={'chats':_0xe0f096(0x10e8),'worldBooks':'世界书','worldBookCategories':_0xe0f096(0x372),'presets':_0xe0f096(0x98b),'presetCategories':'预设分类','userStickers':_0xe0f096(0x154b),'stickerCategories':_0xe0f096(0xd42),'customAvatarFrames':_0xe0f096(0xbf8),'apiConfig':_0xe0f096(0x155e),'globalSettings':_0xe0f096(0xa69),'personaPresets':'人设预设','qzoneSettings':_0xe0f096(0xeeb),'qzonePosts':'动态','qzoneAlbums':'相册','favorites':'收藏','memories':'回忆','callRecords':_0xe0f096(0x681),'shoppingProducts':'商品','apiPresets':_0xe0f096(0x9a6),'renderingRules':_0xe0f096(0x1c9),'appearancePresets':_0xe0f096(0x64b),'npcs':_0xe0f096(0x958)};let _0x56cb96=![];for(const _0x185211 in _0x53408a){if(_0x445053[_0x185211]&&(Array[_0xe0f096(0x624)](_0x445053[_0x185211])?_0x445053[_0x185211][_0xe0f096(0x9a1)]>0x0:_0x445053[_0x185211])){const _0x3370c9=Array[_0xe0f096(0x624)](_0x445053[_0x185211])?_0x445053[_0x185211][_0xe0f096(0x9a1)]:0x1,_0x42a794=document[_0xe0f096(0x14ae)]('li');_0x42a794[_0xe0f096(0x15f)]=_0x53408a[_0x185211]+':\x20'+_0x3370c9+'\x20条/个',_0x102f4b[_0xe0f096(0x998)](_0x42a794),_0x56cb96=!![];}}!_0x56cb96&&(_0x102f4b[_0xe0f096(0xc43)]=_0xe0f096(0xed6)),document[_0xe0f096(0x2ec)](_0xe0f096(0x689))[_0xe0f096(0x6b6)]=()=>{const _0x5b4f90=_0xe0f096;_0xa6629b[_0x5b4f90(0xff6)][_0x5b4f90(0x1424)](_0x5b4f90(0x149d)),_0x2143f0(pendingBackupData);},document['getElementById'](_0xe0f096(0x165))[_0xe0f096(0x6b6)]=()=>{const _0x4bb914=_0xe0f096;_0xa6629b[_0x4bb914(0xff6)][_0x4bb914(0x1424)](_0x4bb914(0x149d)),_0x5098a8(pendingBackupData['content']);},document[_0xe0f096(0x2ec)](_0xe0f096(0xa43))[_0xe0f096(0x6b6)]=()=>{const _0x589266=_0xe0f096;_0xa6629b[_0x589266(0xff6)]['remove'](_0x589266(0x149d)),pendingBackupData=null;},_0xa6629b[_0xe0f096(0xff6)][_0xe0f096(0xe82)]('visible');}async function _0x2143f0(_0x158b91){const _0x55d881=_0x475790;if(!_0x158b91)return;const _0x3d8661=await _0x4436ba(_0x55d881(0x151c),_0x55d881(0x1094),{'confirmButtonClass':_0x55d881(0xd8f),'confirmText':_0x55d881(0xb9d)});if(!_0x3d8661){pendingBackupData=null;return;}await _0x34d596('请稍候...','正在执行完全导入，请勿关闭页面...');try{if(_0x158b91[_0x55d881(0xb4b)]===_0x55d881(0x211))await _0x45b3df(_0x158b91[_0x55d881(0x1047)]);else{if(_0x158b91[_0x55d881(0xb4b)]===_0x55d881(0x1073))await _0x2c5604(_0x158b91[_0x55d881(0x1047)]);else throw new Error(_0x55d881(0xded));}await _0x34d596('导入成功','所有数据已成功恢复！应用即将刷新以应用所有更改。'),setTimeout(()=>window[_0x55d881(0x6f0)]['reload'](),0x5dc);}catch(_0x22ad34){console[_0x55d881(0x1518)](_0x55d881(0x1363),_0x22ad34),await _0x34d596(_0x55d881(0x493),_0x55d881(0x4a1)+_0x22ad34['message']);}finally{pendingBackupData=null;}}function _0x5098a8(_0x5766dc){const _0x183ec3=_0x475790,_0x131033=document['getElementById'](_0x183ec3(0x731)),_0x4ba633=document['getElementById'](_0x183ec3(0x1038)),_0x4017b6=document[_0x183ec3(0x2ec)]('select-all-import-types');_0x4ba633['innerHTML']='',_0x4017b6['checked']=!![];const _0x4b84bb={'chats':_0x183ec3(0x10e8),'worldBooks':'世界书','worldBookCategories':_0x183ec3(0x372),'presets':_0x183ec3(0x98b),'presetCategories':_0x183ec3(0x386),'userStickers':_0x183ec3(0x154b),'stickerCategories':_0x183ec3(0xd42),'customAvatarFrames':'头像框','apiConfig':_0x183ec3(0x155e),'globalSettings':_0x183ec3(0xa69),'personaPresets':'人设预设','qzoneSettings':_0x183ec3(0xeeb),'qzonePosts':'动态','qzoneAlbums':'相册','favorites':'收藏','memories':'回忆','callRecords':_0x183ec3(0x681),'shoppingProducts':'商品','apiPresets':'API预设','renderingRules':_0x183ec3(0x1c9),'appearancePresets':'外观预设','npcs':_0x183ec3(0x958)};let _0x4053f4=![];for(const _0xdb3938 in _0x4b84bb){if(_0x5766dc[_0xdb3938]&&(Array[_0x183ec3(0x624)](_0x5766dc[_0xdb3938])?_0x5766dc[_0xdb3938][_0x183ec3(0x9a1)]>0x0:_0x5766dc[_0xdb3938])){const _0x5366c9=Array[_0x183ec3(0x624)](_0x5766dc[_0xdb3938])?_0x5766dc[_0xdb3938][_0x183ec3(0x9a1)]:0x1,_0x151857=!Array['isArray'](_0x5766dc[_0xdb3938]),_0x54265f=document[_0x183ec3(0x14ae)](_0x183ec3(0xaa5));_0x54265f[_0x183ec3(0xdd1)]=_0x183ec3(0xdfe),_0x54265f[_0x183ec3(0xe93)][_0x183ec3(0xf4a)]=_0xdb3938,_0x54265f[_0x183ec3(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x20selected\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x4b84bb[_0xdb3938]+'\x20('+_0x5366c9+'\x20条/个)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x151857?_0x183ec3(0x12dd):'')+_0x183ec3(0x6c0),_0x4ba633[_0x183ec3(0x998)](_0x54265f),_0x4053f4=!![];}}!_0x4053f4&&(_0x4ba633[_0x183ec3(0xc43)]=_0x183ec3(0xd86)),document[_0x183ec3(0x2ec)](_0x183ec3(0xae1))[_0x183ec3(0x6b6)]=()=>_0x35ffa4(pendingBackupData),document[_0x183ec3(0x2ec)]('cancel-selective-import-btn')['onclick']=()=>{const _0x151f56=_0x183ec3;_0x131033[_0x151f56(0xff6)][_0x151f56(0x1424)]('visible'),pendingBackupData=null;},_0x4017b6['onchange']=_0x4ae217=>{const _0x12838c=_0x183ec3,_0x3933f2=_0x4ae217[_0x12838c(0x1104)][_0x12838c(0x13b8)];_0x4ba633[_0x12838c(0x5d6)](_0x12838c(0xf9f))[_0x12838c(0xf99)](_0x4fa76b=>{const _0x8f160b=_0x12838c;_0x4fa76b[_0x8f160b(0xff6)][_0x8f160b(0x14c8)](_0x8f160b(0xba2),_0x3933f2),_0x4fa76b[_0x8f160b(0x765)]('.checkbox')['classList'][_0x8f160b(0x14c8)](_0x8f160b(0xba2),_0x3933f2);});},_0x4ba633['onclick']=_0x116002=>{const _0x123b2d=_0x183ec3,_0x2af4e4=_0x116002['target'][_0x123b2d(0x3f2)](_0x123b2d(0xf9f));_0x2af4e4&&(_0x2af4e4[_0x123b2d(0xff6)][_0x123b2d(0x14c8)]('selected'),_0x2af4e4[_0x123b2d(0x765)]('.checkbox')[_0x123b2d(0xff6)]['toggle'](_0x123b2d(0xba2)));},_0x131033[_0x183ec3(0xff6)][_0x183ec3(0xe82)](_0x183ec3(0x149d));}async function _0x35ffa4(_0x37af09){const _0x5391bd=_0x475790;if(!_0x37af09)return;const _0x26aeb1=document[_0x5391bd(0x5d6)]('#selective-import-list\x20.clear-posts-item.selected');if(_0x26aeb1[_0x5391bd(0x9a1)]===0x0){alert('请至少选择一种要合并的数据类型。');return;}const _0x1fa5cb=Array['from'](_0x26aeb1)[_0x5391bd(0x11c6)](_0x2bb59a=>_0x2bb59a[_0x5391bd(0xe93)][_0x5391bd(0xf4a)]),_0xa22f3a=_0x37af09[_0x5391bd(0x1047)],_0x357927=await _0x4436ba(_0x5391bd(0xc6a),_0x5391bd(0x156a),{'confirmText':_0x5391bd(0x4f7)});if(!_0x357927)return;await _0x34d596(_0x5391bd(0x13e4),_0x5391bd(0xe58));try{await _0x5b9d83[_0x5391bd(0xe5b)]('rw',_0x5b9d83[_0x5391bd(0x7ed)],async()=>{const _0x75c038=_0x5391bd;for(const _0x5768b4 of _0x1fa5cb){const _0x2ace73=_0xa22f3a[_0x5768b4];if(!_0x2ace73)continue;const _0x41bc98=_0x5b9d83[_0x75c038(0xd32)](_0x5768b4);if(!_0x41bc98){console['warn'](_0x75c038(0xf9b)+_0x5768b4+_0x75c038(0x3b4));continue;}if(Array[_0x75c038(0x624)](_0x2ace73))console[_0x75c038(0x415)]('正在合并\x20'+_0x2ace73['length']+_0x75c038(0x1226)+_0x5768b4+_0x75c038(0x4e6)),await _0x41bc98['bulkPut'](_0x2ace73);else{if(typeof _0x2ace73===_0x75c038(0x10c0)&&_0x2ace73['id'])console[_0x75c038(0x415)](_0x75c038(0xe2e)+_0x5768b4+_0x75c038(0x4e6)),await _0x41bc98['put'](_0x2ace73);else{if(typeof _0x2ace73===_0x75c038(0x10c0)){console[_0x75c038(0x415)](_0x75c038(0x1010)+_0x5768b4+'...');const _0x2e374d=await _0x41bc98[_0x75c038(0x1474)]()[_0x75c038(0x942)]()||{},_0x2abfdb={..._0x2e374d,..._0x2ace73};if(_0x2e374d['id'])_0x2abfdb['id']=_0x2e374d['id'];else(_0x5768b4==='apiConfig'||_0x5768b4===_0x75c038(0x1506)||_0x5768b4===_0x75c038(0x1062)||_0x5768b4==='musicLibrary')&&(_0x2abfdb['id']=_0x75c038(0x1130));await _0x41bc98[_0x75c038(0x7c3)](_0x2abfdb);}}}}}),await _0x34d596(_0x5391bd(0x10f4),'数据已成功合并！应用即将刷新以应用所有更改。'),setTimeout(()=>window['location']['reload'](),0x5dc);}catch(_0x7f563e){console[_0x5391bd(0x1518)](_0x5391bd(0x3f1),_0x7f563e),await _0x34d596(_0x5391bd(0x932),_0x5391bd(0x4a1)+_0x7f563e[_0x5391bd(0x13bc)]);}finally{pendingBackupData=null;}}async function _0x2c5604(_0x2ca1be){const _0x5f4472=_0x475790;try{await _0x5b9d83[_0x5f4472(0xe5b)]('rw',_0x5b9d83[_0x5f4472(0x7ed)],async()=>{const _0x5e3fec=_0x5f4472;await _0x5b9d83[_0x5e3fec(0x6ce)][_0x5e3fec(0xe98)](),await _0x5b9d83[_0x5e3fec(0x13b9)]['clear']();for(const _0x54e59f of _0x5b9d83[_0x5e3fec(0x7ed)]){await _0x54e59f[_0x5e3fec(0xe98)]();}if(Array[_0x5e3fec(0x624)](_0x2ca1be['chats']))await _0x5b9d83[_0x5e3fec(0x6ce)][_0x5e3fec(0xdb2)](_0x2ca1be[_0x5e3fec(0x6ce)]);if(Array[_0x5e3fec(0x624)](_0x2ca1be[_0x5e3fec(0x13b9)]))await _0x5b9d83[_0x5e3fec(0x13b9)][_0x5e3fec(0xdb2)](_0x2ca1be[_0x5e3fec(0x13b9)]);if(Array[_0x5e3fec(0x624)](_0x2ca1be[_0x5e3fec(0xf28)]))await _0x5b9d83[_0x5e3fec(0xf28)][_0x5e3fec(0xdb2)](_0x2ca1be[_0x5e3fec(0xf28)]);if(_0x2ca1be['apiConfig'])await _0x5b9d83['apiConfig']['put'](_0x2ca1be[_0x5e3fec(0x1537)]);if(_0x2ca1be['globalSettings'])await _0x5b9d83[_0x5e3fec(0x1062)][_0x5e3fec(0x7c3)](_0x2ca1be[_0x5e3fec(0x1062)]);if(Array[_0x5e3fec(0x624)](_0x2ca1be[_0x5e3fec(0x5f0)]))await _0x5b9d83[_0x5e3fec(0x5f0)][_0x5e3fec(0xdb2)](_0x2ca1be['personaPresets']);if(_0x2ca1be[_0x5e3fec(0x1465)])await _0x5b9d83['musicLibrary']['put'](_0x2ca1be[_0x5e3fec(0x1465)]);if(_0x2ca1be[_0x5e3fec(0x1506)])await _0x5b9d83[_0x5e3fec(0x1506)][_0x5e3fec(0x7c3)](_0x2ca1be[_0x5e3fec(0x1506)]);if(Array[_0x5e3fec(0x624)](_0x2ca1be[_0x5e3fec(0xc7a)]))await _0x5b9d83[_0x5e3fec(0xc7a)]['bulkPut'](_0x2ca1be['qzonePosts']);if(Array[_0x5e3fec(0x624)](_0x2ca1be[_0x5e3fec(0x550)]))await _0x5b9d83[_0x5e3fec(0x550)][_0x5e3fec(0xdb2)](_0x2ca1be[_0x5e3fec(0x550)]);if(Array[_0x5e3fec(0x624)](_0x2ca1be[_0x5e3fec(0x4e3)]))await _0x5b9d83[_0x5e3fec(0x4e3)][_0x5e3fec(0xdb2)](_0x2ca1be[_0x5e3fec(0x4e3)]);if(Array['isArray'](_0x2ca1be['favorites']))await _0x5b9d83[_0x5e3fec(0x101f)][_0x5e3fec(0xdb2)](_0x2ca1be[_0x5e3fec(0x101f)]);if(Array[_0x5e3fec(0x624)](_0x2ca1be[_0x5e3fec(0x1479)]))await _0x5b9d83[_0x5e3fec(0x1479)]['bulkPut'](_0x2ca1be[_0x5e3fec(0x1479)]);if(Array['isArray'](_0x2ca1be['memories']))await _0x5b9d83[_0x5e3fec(0xf49)]['bulkPut'](_0x2ca1be['memories']);if(Array['isArray'](_0x2ca1be[_0x5e3fec(0x5c0)]))await _0x5b9d83['worldBookCategories'][_0x5e3fec(0xdb2)](_0x2ca1be['worldBookCategories']);if(Array[_0x5e3fec(0x624)](_0x2ca1be[_0x5e3fec(0xa72)]))await _0x5b9d83['apiPresets'][_0x5e3fec(0xdb2)](_0x2ca1be['apiPresets']);if(Array[_0x5e3fec(0x624)](_0x2ca1be['shoppingProducts']))await _0x5b9d83[_0x5e3fec(0x120e)]['bulkPut'](_0x2ca1be[_0x5e3fec(0x120e)]);if(Array['isArray'](_0x2ca1be[_0x5e3fec(0x924)]))await _0x5b9d83['callRecords'][_0x5e3fec(0xdb2)](_0x2ca1be['callRecords']);if(Array[_0x5e3fec(0x624)](_0x2ca1be['renderingRules']))await _0x5b9d83['renderingRules'][_0x5e3fec(0xdb2)](_0x2ca1be[_0x5e3fec(0xccb)]);if(Array[_0x5e3fec(0x624)](_0x2ca1be['doubanPosts']))await _0x5b9d83[_0x5e3fec(0x3d9)][_0x5e3fec(0xdb2)](_0x2ca1be[_0x5e3fec(0x3d9)]);if(Array[_0x5e3fec(0x624)](_0x2ca1be['stickerCategories']))await _0x5b9d83['stickerCategories'][_0x5e3fec(0xdb2)](_0x2ca1be[_0x5e3fec(0xc70)]);if(Array[_0x5e3fec(0x624)](_0x2ca1be[_0x5e3fec(0x8b9)]))await _0x5b9d83[_0x5e3fec(0x8b9)][_0x5e3fec(0xdb2)](_0x2ca1be[_0x5e3fec(0x8b9)]);if(Array[_0x5e3fec(0x624)](_0x2ca1be[_0x5e3fec(0x1504)]))await _0x5b9d83[_0x5e3fec(0x1504)]['bulkPut'](_0x2ca1be[_0x5e3fec(0x1504)]);if(Array[_0x5e3fec(0x624)](_0x2ca1be[_0x5e3fec(0x2f1)]))await _0x5b9d83[_0x5e3fec(0x2f1)][_0x5e3fec(0xdb2)](_0x2ca1be['presetCategories']);if(Array[_0x5e3fec(0x624)](_0x2ca1be[_0x5e3fec(0x8f4)]))await _0x5b9d83[_0x5e3fec(0x8f4)][_0x5e3fec(0xdb2)](_0x2ca1be[_0x5e3fec(0x8f4)]);});}catch(_0x3b4587){throw new Error(_0x5f4472(0x256)+_0x3b4587[_0x5f4472(0x13bc)]);}}function _0x155408(_0x238593,_0x59bd2c=![]){const _0x341a08=_0x475790;if(!_0x238593){_0x10b1b3[_0x341a08(0xc43)]='',document['getElementById'](_0x341a08(0x831))[_0x341a08(0x589)][_0x341a08(0xd9c)]='';return;}const _0x172a04=_0x341a08(0x10de),_0x46b67a=_0x341a08(0x102a)+_0x172a04+_0x341a08(0x4ac)+_0x238593+_0x341a08(0x95a);if(_0x59bd2c){const _0x352abe=document[_0x341a08(0x2ec)](_0x341a08(0x13cf))||document[_0x341a08(0x14ae)](_0x341a08(0x589));_0x352abe['id']=_0x341a08(0x13cf),_0x352abe[_0x341a08(0xc43)]=_0x46b67a;if(!document[_0x341a08(0x2ec)](_0x341a08(0x13cf)))document[_0x341a08(0x150d)][_0x341a08(0x998)](_0x352abe);document[_0x341a08(0x2ec)](_0x341a08(0x831))[_0x341a08(0x589)][_0x341a08(0xd9c)]='\x27'+_0x172a04+_0x341a08(0xd9e);}else _0x10b1b3[_0x341a08(0xc43)]=_0x341a08(0x101e)+_0x46b67a+_0x341a08(0xe8e)+_0x172a04+_0x341a08(0x237);}async function _0x5c886f(){const _0x2ec44d=_0x475790;_0x10b1b3[_0x2ec44d(0xc43)]='',_0x28f30a[_0x2ec44d(0x1062)][_0x2ec44d(0x6ee)]='',await _0x5b9d83[_0x2ec44d(0x1062)][_0x2ec44d(0x7c3)](_0x28f30a[_0x2ec44d(0x1062)]),document[_0x2ec44d(0x2ec)](_0x2ec44d(0x472))[_0x2ec44d(0x11a4)]='',document['getElementById'](_0x2ec44d(0x831))[_0x2ec44d(0x589)][_0x2ec44d(0xd9c)]='',alert(_0x2ec44d(0x3aa));}async function _0x15e928(){const _0xd75d05=_0x475790,[_0x590688,_0x290cd1,_0x5d2063,_0x3a45dd,_0x113a60,_0x3ad926,_0x525e6e,_0x494c56,_0x30a40e,_0xf5c427,_0x7fcaab]=await Promise['all']([_0x5b9d83['chats'][_0xd75d05(0x14b5)](),_0x5b9d83['apiConfig'][_0xd75d05(0x6b5)]('main'),_0x5b9d83[_0xd75d05(0x1062)]['get'](_0xd75d05(0x1130)),_0x5b9d83[_0xd75d05(0xf28)][_0xd75d05(0x14b5)](),_0x5b9d83[_0xd75d05(0x13b9)]['toArray'](),_0x5b9d83[_0xd75d05(0x1465)][_0xd75d05(0x6b5)](_0xd75d05(0x1130)),_0x5b9d83[_0xd75d05(0x5f0)][_0xd75d05(0x14b5)](),_0x5b9d83[_0xd75d05(0x1506)][_0xd75d05(0x6b5)](_0xd75d05(0x1130)),_0x5b9d83[_0xd75d05(0x101f)][_0xd75d05(0x106d)]('timestamp')['reverse']()[_0xd75d05(0x14b5)](),_0x5b9d83[_0xd75d05(0xf49)][_0xd75d05(0x14b5)](),_0x5b9d83[_0xd75d05(0x1504)][_0xd75d05(0x14b5)]()]);_0x28f30a[_0xd75d05(0x1504)]=_0x7fcaab||[];const _0x51d2d1={'id':_0xd75d05(0x1130),'showStatusBar':![],'wallpaper':'linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0x40c71f},'cphoneWallpaper':_0xd75d05(0x862),'cphoneAppIcons':{..._0x41ca77},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x28f30a[_0xd75d05(0x1062)]={..._0x51d2d1,..._0x5d2063||{}},_0x28f30a[_0xd75d05(0x1062)][_0xd75d05(0x12e8)]={..._0x51d2d1['appIcons'],..._0x28f30a[_0xd75d05(0x1062)][_0xd75d05(0x12e8)]||{}},_0x28f30a['globalSettings'][_0xd75d05(0x978)]={..._0x51d2d1[_0xd75d05(0x978)],..._0x28f30a['globalSettings'][_0xd75d05(0x978)]||{}},_0x590688[_0xd75d05(0xf99)](_0x280df2=>{const _0x10cc96=_0xd75d05;typeof _0x280df2[_0x10cc96(0x362)][_0x10cc96(0x425)]===_0x10cc96(0xe40)&&(_0x280df2['settings']['enableTimePerception']=!![]),!_0x280df2[_0x10cc96(0x362)][_0x10cc96(0xd88)]&&(_0x280df2[_0x10cc96(0x362)][_0x10cc96(0xd88)]={'vertical':_0x10cc96(0xdd5),'horizontal':_0x10cc96(0x40e),'offset':0xa}),!_0x280df2[_0x10cc96(0x1423)]&&!_0x280df2['settings'][_0x10cc96(0xbd2)]&&(_0x280df2[_0x10cc96(0x362)][_0x10cc96(0xbd2)]=[]),!_0x280df2[_0x10cc96(0x1423)]&&typeof _0x280df2[_0x10cc96(0x66c)]===_0x10cc96(0xe40)&&(_0x280df2[_0x10cc96(0x66c)]=_0x280df2[_0x10cc96(0xe36)]);}),_0x28f30a[_0xd75d05(0x6ce)]=_0x590688['reduce']((_0x19a538,_0x922cb0)=>{const _0x54d80d=_0xd75d05;if(typeof _0x922cb0[_0x54d80d(0xce1)]===_0x54d80d(0xe40))_0x922cb0['unreadCount']=0x0;_0x922cb0[_0x54d80d(0x1423)]&&(typeof _0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x12ed)]===_0x54d80d(0xe40)&&(_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x12ed)]=!![]),_0x922cb0[_0x54d80d(0x10f2)]&&_0x922cb0[_0x54d80d(0x10f2)][_0x54d80d(0x9a1)]>0x0&&_0x922cb0[_0x54d80d(0x10f2)][0x0][_0x54d80d(0xe36)]&&_0x922cb0[_0x54d80d(0x10f2)][_0x54d80d(0xf99)](_0x174896=>{const _0x4d8ca7=_0x54d80d;typeof _0x174896['originalName']===_0x4d8ca7(0xe40)&&(_0x174896[_0x4d8ca7(0x66c)]=_0x174896[_0x4d8ca7(0xe36)],_0x174896[_0x4d8ca7(0x8a8)]=_0x174896[_0x4d8ca7(0xe36)],delete _0x174896['name']);}));if(!_0x922cb0['settings'])_0x922cb0[_0x54d80d(0x362)]={};typeof _0x922cb0[_0x54d80d(0x362)][_0x54d80d(0xff3)]==='undefined'&&(_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0xff3)]=0xa);if(!_0x922cb0['isGroup']&&!_0x922cb0[_0x54d80d(0x2a3)])_0x922cb0[_0x54d80d(0x2a3)]={'text':'在线','lastUpdate':Date['now'](),'isBusy':![]};if(!_0x922cb0[_0x54d80d(0x1423)]&&!_0x922cb0[_0x54d80d(0xaf4)])_0x922cb0[_0x54d80d(0xaf4)]={'status':_0x54d80d(0xab9),'blockedTimestamp':null,'applicationReason':''};if(!_0x922cb0['isGroup']&&(!_0x922cb0[_0x54d80d(0x362)]||!_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x78c)])){if(!_0x922cb0[_0x54d80d(0x362)])_0x922cb0['settings']={};_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x78c)]=[];}_0x922cb0[_0x54d80d(0x1423)]&&(_0x922cb0['members']||[])[_0x54d80d(0xf99)](_0x2e3611=>{const _0x53df9d=_0x54d80d;if(typeof _0x2e3611[_0x53df9d(0x13d9)]===_0x53df9d(0xe40))_0x2e3611['avatarFrame']='';});if(!_0x922cb0['musicData'])_0x922cb0[_0x54d80d(0x204)]={'totalTime':0x0};_0x922cb0[_0x54d80d(0x362)]&&_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0xb9f)]&&!_0x922cb0['settings'][_0x54d80d(0x684)]&&(_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x684)]=[_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0xb9f)]],delete _0x922cb0['settings'][_0x54d80d(0xb9f)]);if(typeof _0x922cb0[_0x54d80d(0xa1c)]==='undefined')_0x922cb0[_0x54d80d(0xa1c)]=![];!_0x922cb0[_0x54d80d(0x1423)]&&typeof _0x922cb0['settings'][_0x54d80d(0xa28)]===_0x54d80d(0xe40)&&(_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0xa28)]='我');if(_0x922cb0[_0x54d80d(0x1423)]&&_0x922cb0[_0x54d80d(0x10f2)]){let _0x3eb14a=![];_0x590688[_0x54d80d(0xf99)](_0x3c221b=>{const _0x5dbd75=_0x54d80d;_0x3c221b['id']===_0x922cb0['id']&&_0x3c221b[_0x5dbd75(0x66c)]&&delete _0x3c221b[_0x5dbd75(0x66c)];}),_0x922cb0[_0x54d80d(0x10f2)]['forEach'](_0x179361=>{const _0x23ddfc=_0x54d80d,_0x1f6d1d=_0x590688[_0x23ddfc(0x412)](_0x2a21fa=>_0x2a21fa['id']===_0x179361['id']);if(_0x1f6d1d&&_0x1f6d1d[_0x23ddfc(0x362)]){const _0x157366=_0x1f6d1d[_0x23ddfc(0x362)][_0x23ddfc(0x5b8)]||'';_0x179361[_0x23ddfc(0x13d9)]!==_0x157366&&(_0x179361[_0x23ddfc(0x13d9)]=_0x157366,_0x3eb14a=!![]);}else typeof _0x179361[_0x23ddfc(0x13d9)]===_0x23ddfc(0xe40)&&(_0x179361[_0x23ddfc(0x13d9)]='',_0x3eb14a=!![]);});if(_0x3eb14a)_0x5b9d83[_0x54d80d(0x6ce)][_0x54d80d(0x7c3)](_0x922cb0);}if(!_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x129c)])_0x922cb0['settings'][_0x54d80d(0x129c)]=![];if(!_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x424)])_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x424)]=0x14;if(!_0x922cb0[_0x54d80d(0x153f)])_0x922cb0[_0x54d80d(0x153f)]=[];if(!_0x922cb0[_0x54d80d(0x109f)])_0x922cb0[_0x54d80d(0x109f)]=0x0;if(!_0x922cb0[_0x54d80d(0x1423)]){typeof _0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x12ed)]==='undefined'&&(_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x12ed)]=!![]);typeof _0x922cb0[_0x54d80d(0x362)]['enableTts']===_0x54d80d(0xe40)&&(_0x922cb0['settings']['enableTts']=![]);if(!_0x922cb0[_0x54d80d(0x2a3)])_0x922cb0[_0x54d80d(0x2a3)]={'text':'在线','lastUpdate':Date[_0x54d80d(0x487)](),'isBusy':![]};if(!_0x922cb0['relationship'])_0x922cb0[_0x54d80d(0xaf4)]={'status':_0x54d80d(0xab9),'blockedTimestamp':null,'applicationReason':''};if(!_0x922cb0[_0x54d80d(0x362)]||!_0x922cb0['settings']['aiAvatarLibrary']){if(!_0x922cb0[_0x54d80d(0x362)])_0x922cb0[_0x54d80d(0x362)]={};_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x78c)]=[];}if(typeof _0x922cb0[_0x54d80d(0x362)]['isOfflineMode']==='undefined')_0x922cb0['settings'][_0x54d80d(0x1448)]=![];if(typeof _0x922cb0[_0x54d80d(0x362)][_0x54d80d(0xa11)]===_0x54d80d(0xe40))_0x922cb0['settings'][_0x54d80d(0xa11)]=0x64;if(typeof _0x922cb0[_0x54d80d(0x362)][_0x54d80d(0xd67)]===_0x54d80d(0xe40))_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0xd67)]=0x12c;typeof _0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x431)]==='undefined'&&(_0x922cb0['settings'][_0x54d80d(0x431)]=![]);if(typeof _0x922cb0[_0x54d80d(0x28a)]===_0x54d80d(0xe40))_0x922cb0[_0x54d80d(0x28a)]='...';if(typeof _0x922cb0[_0x54d80d(0xe97)]===_0x54d80d(0xe40))_0x922cb0[_0x54d80d(0xe97)]=_0x54d80d(0x4e6);!Array[_0x54d80d(0x624)](_0x922cb0[_0x54d80d(0x2be)])&&(_0x922cb0[_0x54d80d(0x2be)]=[]);}return typeof _0x922cb0[_0x54d80d(0x362)][_0x54d80d(0xb1f)]===_0x54d80d(0xe40)&&(_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x1574)]?_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0xb1f)]=[_0x922cb0[_0x54d80d(0x362)][_0x54d80d(0x1574)]]:_0x922cb0['settings']['stickerCategoryIds']=[],delete _0x922cb0[_0x54d80d(0x362)]['stickerCategoryId']),_0x19a538[_0x922cb0['id']]=_0x922cb0,_0x19a538;},{});const _0x10fda5=[];_0xf5c427[_0xd75d05(0xf99)](_0x2216ae=>{const _0x12ae99=_0xd75d05;if(_0x2216ae[_0x12ae99(0xb4b)]===_0x12ae99(0x943)&&_0x2216ae[_0x12ae99(0xa5d)]&&!_0x2216ae[_0x12ae99(0xe87)]){const _0x106683=_0x590688['find'](_0x8342ec=>!_0x8342ec[_0x12ae99(0x1423)]&&_0x8342ec[_0x12ae99(0x66c)]===_0x2216ae[_0x12ae99(0xa5d)]);if(_0x106683)_0x2216ae['authorId']=_0x106683['id'],_0x10fda5[_0x12ae99(0x367)](_0x2216ae);else{const _0x2c6cbf=_0x590688[_0x12ae99(0x412)](_0x40591b=>!_0x40591b['isGroup']&&_0x40591b['name']===_0x2216ae[_0x12ae99(0xa5d)]);_0x2c6cbf&&(_0x2216ae['authorId']=_0x2c6cbf['id'],_0x10fda5[_0x12ae99(0x367)](_0x2216ae));}}}),_0x10fda5['length']>0x0&&await _0x5b9d83[_0xd75d05(0xf49)]['bulkPut'](_0x10fda5),_0x28f30a[_0xd75d05(0x1537)]=_0x290cd1||{'id':_0xd75d05(0x1130),'proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':'speech-01'},_0x28f30a[_0xd75d05(0xf28)]=_0x3a45dd||[],_0x28f30a[_0xd75d05(0x13b9)]=_0x113a60||[],_0x79cac3[_0xd75d05(0x5fd)]=_0x3ad926?.['playlist']||[],_0x28f30a[_0xd75d05(0x5f0)]=_0x525e6e||[],_0x28f30a[_0xd75d05(0x1506)]=_0x494c56||{'id':_0xd75d05(0x1130),'nickname':_0xd75d05(0x450),'avatar':_0xd75d05(0x1494),'banner':_0xd75d05(0xbfb)},allFavoriteItems=_0x30a40e||[];}async function _0x10fa70(){const _0x512d07=_0x475790;await _0x5b9d83[_0x512d07(0x1465)][_0x512d07(0x7c3)]({'id':_0x512d07(0x1130),'playlist':_0x79cac3['playlist']});}function _0x17b30f(_0x14b45c){const _0x565738=_0x475790;if(!_0x14b45c)return'';const _0x38931d=new Date(_0x14b45c),_0x1249de=String(_0x38931d[_0x565738(0x8a5)]())[_0x565738(0x58e)](0x2,'0'),_0x4de824=String(_0x38931d[_0x565738(0xbc9)]())[_0x565738(0x58e)](0x2,'0');return _0x1249de+':'+_0x4de824;}function _0xf1c86d(_0x5db651){const _0x2bd6b0=_0x475790,_0x8576dd=Date[_0x2bd6b0(0x487)](),_0x30c307=Math['floor']((_0x8576dd-_0x5db651)/0x3e8);if(_0x30c307<0x3c)return'刚刚';const _0xb96fc6=Math['floor'](_0x30c307/0x3c);if(_0xb96fc6<0x3c)return _0xb96fc6+_0x2bd6b0(0x1310);const _0x5dc2df=Math[_0x2bd6b0(0x5f8)](_0xb96fc6/0x3c);if(_0x5dc2df<0x18)return _0x5dc2df+'小时前';const _0x367375=Math[_0x2bd6b0(0x5f8)](_0x5dc2df/0x18);if(_0x367375<0x1e)return _0x367375+'天前';const _0x487481=Math[_0x2bd6b0(0x5f8)](_0x367375/0x1e);if(_0x487481<0xc)return'大约'+_0x487481+'个月前';const _0x57f115=Math[_0x2bd6b0(0x5f8)](_0x367375/0x16d);return'大约'+_0x57f115+'年前';}function _0x68368b(_0x8a8725){const _0x43bab4=_0x475790;if(!_0x8a8725)return'';const _0x4b70d1=new Date(),_0x4c600e=new Date(_0x8a8725),_0x1a8903=String(_0x4c600e[_0x43bab4(0x8a5)]())[_0x43bab4(0x58e)](0x2,'0'),_0x2f6ce5=String(_0x4c600e[_0x43bab4(0xbc9)]())[_0x43bab4(0x58e)](0x2,'0'),_0x4071b7=_0x1a8903+':'+_0x2f6ce5;if(_0x4b70d1['toDateString']()===_0x4c600e[_0x43bab4(0x329)]())return _0x43bab4(0xd3c)+_0x4071b7;const _0x245d28=new Date();_0x245d28[_0x43bab4(0x119f)](_0x4b70d1[_0x43bab4(0x3c7)]()-0x1);if(_0x245d28[_0x43bab4(0x329)]()===_0x4c600e[_0x43bab4(0x329)]())return'昨天\x20'+_0x4071b7;if(_0x4b70d1[_0x43bab4(0x4cb)]()===_0x4c600e[_0x43bab4(0x4cb)]()){const _0x5e01c8=String(_0x4c600e[_0x43bab4(0xa8f)]()+0x1),_0x29b930=String(_0x4c600e[_0x43bab4(0x3c7)]());return _0x5e01c8+'月'+_0x29b930+'日\x20'+_0x4071b7;}const _0xa099c6=_0x4c600e[_0x43bab4(0x4cb)](),_0x3b2798=String(_0x4c600e['getMonth']()+0x1),_0x9f56da=String(_0x4c600e[_0x43bab4(0x3c7)]());return _0xa099c6+'年'+_0x3b2798+'月'+_0x9f56da+'日\x20'+_0x4071b7;}function _0x5143d7(){const _0x269b78=_0x475790,_0x18a2a5=_0x4cb256();document[_0x269b78(0x2ec)](_0x269b78(0xa77))['value']=_0x18a2a5['resolution'],document[_0x269b78(0x2ec)]('nai-steps')[_0x269b78(0x11a4)]=_0x18a2a5['steps'],document[_0x269b78(0x2ec)](_0x269b78(0x147c))[_0x269b78(0x11a4)]=_0x18a2a5[_0x269b78(0xb42)],document[_0x269b78(0x2ec)](_0x269b78(0x12bf))['value']=_0x18a2a5[_0x269b78(0x46a)],document['getElementById'](_0x269b78(0xb4e))[_0x269b78(0x11a4)]=_0x18a2a5['seed'],document[_0x269b78(0x2ec)](_0x269b78(0xfe5))[_0x269b78(0x11a4)]=_0x18a2a5[_0x269b78(0xc05)],document['getElementById'](_0x269b78(0x299))[_0x269b78(0x13b8)]=_0x18a2a5[_0x269b78(0xf9e)],document[_0x269b78(0x2ec)](_0x269b78(0x112b))[_0x269b78(0x13b8)]=_0x18a2a5['smea'],document['getElementById'](_0x269b78(0xf70))[_0x269b78(0x13b8)]=_0x18a2a5[_0x269b78(0xd60)],document[_0x269b78(0x2ec)](_0x269b78(0xcde))[_0x269b78(0x11a4)]=_0x18a2a5['default_positive'],document[_0x269b78(0x2ec)](_0x269b78(0xa8e))['value']=_0x18a2a5['default_negative'],document[_0x269b78(0x2ec)]('nai-cors-proxy')[_0x269b78(0x11a4)]=_0x18a2a5[_0x269b78(0x9c0)],document['getElementById'](_0x269b78(0x12cb))[_0x269b78(0x11a4)]=_0x18a2a5[_0x269b78(0xb73)]||'';const _0x48670f=document['getElementById'](_0x269b78(0x1a2));_0x48670f['style'][_0x269b78(0x701)]=_0x18a2a5['cors_proxy']===_0x269b78(0x1334)?_0x269b78(0x13f7):'none';}function _0x616ebd(){const _0x2260c9=_0x475790,_0x42900d=document[_0x2260c9(0x2ec)](_0x2260c9(0xcd4))['checked'],_0x28f214=document[_0x2260c9(0x2ec)](_0x2260c9(0x13f6))[_0x2260c9(0x11a4)],_0x1726ca=document[_0x2260c9(0x2ec)](_0x2260c9(0x5da))[_0x2260c9(0x11a4)][_0x2260c9(0x97e)]();localStorage[_0x2260c9(0x1048)](_0x2260c9(0x89f),_0x42900d),localStorage[_0x2260c9(0x1048)]('novelai-model',_0x28f214),localStorage['setItem'](_0x2260c9(0x5da),_0x1726ca);const _0x4db355={'resolution':document[_0x2260c9(0x2ec)]('nai-resolution')[_0x2260c9(0x11a4)],'steps':parseInt(document[_0x2260c9(0x2ec)](_0x2260c9(0xe37))['value']),'cfg_scale':parseFloat(document[_0x2260c9(0x2ec)](_0x2260c9(0x147c))[_0x2260c9(0x11a4)]),'sampler':document['getElementById']('nai-sampler')[_0x2260c9(0x11a4)],'seed':parseInt(document[_0x2260c9(0x2ec)]('nai-seed')[_0x2260c9(0x11a4)]),'uc_preset':parseInt(document[_0x2260c9(0x2ec)](_0x2260c9(0xfe5))[_0x2260c9(0x11a4)]),'quality_toggle':document[_0x2260c9(0x2ec)](_0x2260c9(0x299))[_0x2260c9(0x13b8)],'smea':document[_0x2260c9(0x2ec)]('nai-smea')[_0x2260c9(0x13b8)],'smea_dyn':document[_0x2260c9(0x2ec)]('nai-smea-dyn')[_0x2260c9(0x13b8)],'default_positive':document[_0x2260c9(0x2ec)]('nai-default-positive')[_0x2260c9(0x11a4)],'default_negative':document[_0x2260c9(0x2ec)](_0x2260c9(0xa8e))[_0x2260c9(0x11a4)],'cors_proxy':document[_0x2260c9(0x2ec)]('nai-cors-proxy')['value'],'custom_proxy_url':document[_0x2260c9(0x2ec)]('nai-custom-proxy-url')[_0x2260c9(0x11a4)]};localStorage[_0x2260c9(0x1048)](_0x2260c9(0x1533),JSON[_0x2260c9(0xe4d)](_0x4db355));}function _0x54a2ef(){const _0x125ff9=_0x475790;localStorage[_0x125ff9(0x1330)](_0x125ff9(0x1533)),_0x5143d7(),alert(_0x125ff9(0x4d9));}function _0x4cb256(){const _0x2e7b00=_0x475790,_0x5e73c5={'resolution':_0x2e7b00(0x7d9),'steps':0x1c,'cfg_scale':0x5,'sampler':_0x2e7b00(0x7c9),'seed':-0x1,'uc_preset':0x1,'quality_toggle':!![],'smea':!![],'smea_dyn':![],'default_positive':_0x2e7b00(0x1329),'default_negative':_0x2e7b00(0x132e),'cors_proxy':'https://corsproxy.io/?','custom_proxy_url':''},_0x11e6b8=localStorage[_0x2e7b00(0x11c3)]('novelai-settings');if(_0x11e6b8)try{return{..._0x5e73c5,...JSON['parse'](_0x11e6b8)};}catch(_0x59dc79){return _0x5e73c5;}return _0x5e73c5;}async function _0x2c6597(_0x1a9ef2,_0x2aa7a0){const _0x5348c3=_0x475790;console[_0x5348c3(0x415)]('🎨\x20[NAI核心生成]\x20开始...\x20Prompt:\x20\x22'+_0x1a9ef2+_0x5348c3(0x4b9)+_0x2aa7a0);const _0x5d8e80=_0x7da453(_0x2aa7a0),_0xf741c1=_0x1a9ef2+',\x20'+_0x5d8e80['positive'],_0x124ba2=_0x5d8e80[_0x5348c3(0x1378)];console[_0x5348c3(0x415)]('📝\x20使用'+(_0x5d8e80[_0x5348c3(0x5c7)]===_0x5348c3(0x8e7)?_0x5348c3(0xd23):'系统')+'提示词配置'),console[_0x5348c3(0x415)](_0x5348c3(0xeb5),_0xf741c1),console[_0x5348c3(0x415)](_0x5348c3(0x14b1),_0x124ba2);const _0x5ec544=localStorage[_0x5348c3(0x11c3)](_0x5348c3(0x5da)),_0x22d156=localStorage['getItem'](_0x5348c3(0x13f6))||_0x5348c3(0xb6c),_0x303ea4=_0x4cb256();if(!_0x5ec544)throw new Error(_0x5348c3(0x2d0));const [_0x1402e1,_0x122b07]=_0x303ea4[_0x5348c3(0x121b)][_0x5348c3(0xa8a)]('x')['map'](Number);let _0x1fc4ec;_0x22d156[_0x5348c3(0x138a)]('nai-diffusion-4')?_0x1fc4ec={'input':_0xf741c1,'model':_0x22d156,'action':_0x5348c3(0x13ca),'parameters':{'params_version':0x3,'width':_0x1402e1,'height':_0x122b07,'scale':_0x303ea4['cfg_scale'],'sampler':_0x303ea4[_0x5348c3(0x46a)],'steps':_0x303ea4[_0x5348c3(0xd22)],'seed':_0x303ea4[_0x5348c3(0x634)]===-0x1?Math[_0x5348c3(0x5f8)](Math['random']()*0x2540be3ff):_0x303ea4['seed'],'n_samples':0x1,'ucPreset':_0x303ea4['uc_preset'],'qualityToggle':_0x303ea4[_0x5348c3(0xf9e)],'add_original_image':!![],'noise_schedule':_0x5348c3(0xcc4),'v4_prompt':{'caption':{'base_caption':_0xf741c1,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x124ba2,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x124ba2,'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'cfg_rescale':0x0,'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x1fc4ec={'input':_0xf741c1,'model':_0x22d156,'action':_0x5348c3(0x13ca),'parameters':{'width':_0x1402e1,'height':_0x122b07,'scale':_0x303ea4[_0x5348c3(0xb42)],'sampler':_0x303ea4[_0x5348c3(0x46a)],'steps':_0x303ea4[_0x5348c3(0xd22)],'seed':_0x303ea4[_0x5348c3(0x634)]===-0x1?Math['floor'](Math[_0x5348c3(0x1337)]()*0x2540be3ff):_0x303ea4['seed'],'n_samples':0x1,'ucPreset':_0x303ea4[_0x5348c3(0xc05)],'qualityToggle':_0x303ea4[_0x5348c3(0xf9e)],'sm':_0x303ea4[_0x5348c3(0x805)],'sm_dyn':_0x303ea4['smea_dyn'],'negative_prompt':_0x124ba2,'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':'native'}};console[_0x5348c3(0x415)](_0x5348c3(0x825),_0x1fc4ec);let _0x2cef7d;_0x22d156[_0x5348c3(0x138a)](_0x5348c3(0x12b4))?_0x2cef7d='https://image.novelai.net/ai/generate-image-stream':_0x2cef7d=_0x5348c3(0xf02);let _0x3f501d=_0x303ea4[_0x5348c3(0x9c0)];_0x3f501d===_0x5348c3(0x1334)&&(_0x3f501d=_0x303ea4[_0x5348c3(0xb73)]||'');_0x3f501d&&_0x3f501d!==''&&(_0x2cef7d=_0x3f501d+encodeURIComponent(_0x2cef7d));const _0x900aea=await fetch(_0x2cef7d,{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x5348c3(0xe83)+_0x5ec544},'body':JSON[_0x5348c3(0xe4d)](_0x1fc4ec)});if(!_0x900aea['ok']){const _0x26b8bd=await _0x900aea['text']();throw new Error(_0x5348c3(0x669)+_0x900aea[_0x5348c3(0x2a3)]+_0x5348c3(0xd30)+_0x26b8bd);}const _0x44e76b=_0x900aea[_0x5348c3(0x79a)][_0x5348c3(0x6b5)](_0x5348c3(0x2ed));let _0x17c813,_0x478367;if(_0x44e76b&&_0x44e76b[_0x5348c3(0x138a)]('text/event-stream')){const _0x289c60=await _0x900aea['text'](),_0x1c6ffd=_0x289c60[_0x5348c3(0x97e)]()['split']('\x0a');let _0x258210=null;for(let _0x34b01a=_0x1c6ffd[_0x5348c3(0x9a1)]-0x1;_0x34b01a>=0x0;_0x34b01a--){const _0x5d7648=_0x1c6ffd[_0x34b01a][_0x5348c3(0x97e)]();if(_0x5d7648[_0x5348c3(0x741)](_0x5348c3(0x16c))&&_0x5d7648!==_0x5348c3(0xfdc)){const _0x2cb86f=_0x5d7648[_0x5348c3(0xa6b)](0x6);try{const _0x4244fc=JSON['parse'](_0x2cb86f);if(_0x4244fc['event_type']===_0x5348c3(0x186)&&_0x4244fc[_0x5348c3(0x9e6)]){_0x258210=_0x4244fc[_0x5348c3(0x9e6)];break;}if(_0x4244fc['data']){_0x258210=_0x4244fc['data'];break;}if(_0x4244fc[_0x5348c3(0x9e6)]){_0x258210=_0x4244fc[_0x5348c3(0x9e6)];break;}}catch(_0x128634){_0x258210=_0x2cb86f;break;}}}if(!_0x258210)throw new Error(_0x5348c3(0xb2d));const _0x3d8258=_0x258210[_0x5348c3(0x741)]('iVBORw0KGgo'),_0x295eca=_0x258210[_0x5348c3(0x741)](_0x5348c3(0x5d4));if(_0x3d8258||_0x295eca)_0x478367=_0x5348c3(0x54c)+(_0x3d8258?'image/png':_0x5348c3(0xf4b))+_0x5348c3(0x80d)+_0x258210;else{const _0xef2490=atob(_0x258210),_0x52d498=new Uint8Array(_0xef2490[_0x5348c3(0x9a1)]);for(let _0xe1ea78=0x0;_0xe1ea78<_0xef2490[_0x5348c3(0x9a1)];_0xe1ea78++)_0x52d498[_0xe1ea78]=_0xef2490[_0x5348c3(0xe26)](_0xe1ea78);_0x17c813=new Blob([_0x52d498]);}}else _0x17c813=await _0x900aea[_0x5348c3(0x465)]();if(!_0x478367&&_0x17c813){if(typeof JSZip===_0x5348c3(0xe40))throw new Error(_0x5348c3(0x903));const _0x1b538d=await JSZip[_0x5348c3(0xeab)](_0x17c813);let _0xa0f00d=null;for(let _0xdb7f3d in _0x1b538d[_0x5348c3(0x8d6)]){if(_0xdb7f3d[_0x5348c3(0x49a)](/\.(png|jpg|jpeg|webp)$/i)){_0xa0f00d=_0x1b538d[_0x5348c3(0x8d6)][_0xdb7f3d];break;}}if(!_0xa0f00d)throw new Error('ZIP文件中未找到图片');const _0x4aac16=await _0xa0f00d[_0x5348c3(0x138d)](_0x5348c3(0x465));_0x478367=await new Promise((_0x5182c9,_0x3a3174)=>{const _0xed7e8=_0x5348c3,_0x220ae8=new FileReader();_0x220ae8['onloadend']=()=>_0x5182c9(_0x220ae8[_0xed7e8(0x42a)]),_0x220ae8[_0xed7e8(0x125a)]=_0x3a3174,_0x220ae8[_0xed7e8(0x60e)](_0x4aac16);});}return console[_0x5348c3(0x415)](_0x5348c3(0x22f)),{'imageUrl':_0x478367,'fullPrompt':_0xf741c1};}function _0x7da453(_0x2b70ad){const _0x4678a2=_0x475790,_0x17ec31=_0x4cb256();if(!_0x2b70ad||!_0x28f30a['chats'][_0x2b70ad])return console[_0x4678a2(0x415)](_0x4678a2(0xc8d)),{'positive':_0x17ec31[_0x4678a2(0x10a4)],'negative':_0x17ec31['default_negative'],'source':_0x4678a2(0x10a7)};const _0x5cd574=_0x28f30a['chats'][_0x2b70ad],_0x4a27a5=_0x5cd574[_0x4678a2(0x362)][_0x4678a2(0x64a)]||{};return _0x4a27a5[_0x4678a2(0x555)]===_0x4678a2(0x8e7)?(console[_0x4678a2(0x415)](_0x4678a2(0x992)),console[_0x4678a2(0x415)]('\x20\x20\x20正面:',_0x4a27a5['characterPositivePrompt']||_0x4678a2(0xc91)),console[_0x4678a2(0x415)]('\x20\x20\x20负面:',_0x4a27a5[_0x4678a2(0xb8f)]||_0x4678a2(0xc91)),{'positive':_0x4a27a5['characterPositivePrompt']||'','negative':_0x4a27a5[_0x4678a2(0xb8f)]||'','source':_0x4678a2(0x8e7)}):(console[_0x4678a2(0x415)]('✅\x20NAI提示词：使用系统配置'),console[_0x4678a2(0x415)](_0x4678a2(0x6b8),_0x17ec31[_0x4678a2(0x10a4)]||'(空)'),console[_0x4678a2(0x415)](_0x4678a2(0x462),_0x17ec31[_0x4678a2(0x132b)]||_0x4678a2(0xc91)),{'positive':_0x17ec31[_0x4678a2(0x10a4)],'negative':_0x17ec31[_0x4678a2(0x132b)],'source':_0x4678a2(0x10a7)});}async function _0x3ff984(){const _0x49d2d0=_0x475790,_0x2e1230=document[_0x49d2d0(0x2ec)](_0x49d2d0(0x5da))[_0x49d2d0(0x11a4)][_0x49d2d0(0x97e)](),_0x45547b=document[_0x49d2d0(0x2ec)]('novelai-model')[_0x49d2d0(0x11a4)],_0x504b22=document['getElementById'](_0x49d2d0(0x809))[_0x49d2d0(0x11a4)][_0x49d2d0(0x97e)]();if(!_0x2e1230){alert(_0x49d2d0(0xef1));return;}if(!_0x504b22){alert(_0x49d2d0(0xfe3));return;}const _0x190aa9=_0x4cb256(),_0x299d19=document[_0x49d2d0(0x2ec)](_0x49d2d0(0x7d8))[_0x49d2d0(0x11a4)][_0x49d2d0(0x97e)](),_0x263669=document[_0x49d2d0(0x2ec)]('nai-test-status'),_0x527b5d=document[_0x49d2d0(0x2ec)]('nai-test-result'),_0x56054c=document['getElementById'](_0x49d2d0(0x26d)),_0x3fa73d=document[_0x49d2d0(0x2ec)](_0x49d2d0(0x36a));_0x263669[_0x49d2d0(0x589)][_0x49d2d0(0x701)]=_0x49d2d0(0x13f7),_0x527b5d[_0x49d2d0(0x589)][_0x49d2d0(0x701)]=_0x49d2d0(0x5b1),_0x56054c[_0x49d2d0(0x589)][_0x49d2d0(0x701)]='none',_0x3fa73d[_0x49d2d0(0x1373)]=!![],_0x3fa73d['textContent']=_0x49d2d0(0x6bc);try{const [_0x1d727f,_0x40ddb6]=_0x190aa9[_0x49d2d0(0x121b)][_0x49d2d0(0xa8a)]('x')[_0x49d2d0(0x11c6)](Number);let _0xaeb134;_0x45547b[_0x49d2d0(0x138a)](_0x49d2d0(0x12b4))?_0xaeb134={'input':_0x504b22,'model':_0x45547b,'action':_0x49d2d0(0x13ca),'parameters':{'params_version':0x3,'width':_0x1d727f,'height':_0x40ddb6,'scale':_0x190aa9['cfg_scale'],'sampler':_0x190aa9[_0x49d2d0(0x46a)],'steps':_0x190aa9[_0x49d2d0(0xd22)],'seed':_0x190aa9[_0x49d2d0(0x634)]===-0x1?Math[_0x49d2d0(0x5f8)](Math['random']()*0x2540be3ff):_0x190aa9[_0x49d2d0(0x634)],'n_samples':0x1,'ucPreset':_0x190aa9[_0x49d2d0(0xc05)],'qualityToggle':_0x190aa9['quality_toggle'],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x49d2d0(0xcc4),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x504b22,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x299d19,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x299d19,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0xaeb134={'input':_0x504b22,'model':_0x45547b,'action':_0x49d2d0(0x13ca),'parameters':{'width':_0x1d727f,'height':_0x40ddb6,'scale':_0x190aa9[_0x49d2d0(0xb42)],'sampler':_0x190aa9[_0x49d2d0(0x46a)],'steps':_0x190aa9[_0x49d2d0(0xd22)],'seed':_0x190aa9[_0x49d2d0(0x634)]===-0x1?Math[_0x49d2d0(0x5f8)](Math[_0x49d2d0(0x1337)]()*0x2540be3ff):_0x190aa9[_0x49d2d0(0x634)],'n_samples':0x1,'ucPreset':_0x190aa9[_0x49d2d0(0xc05)],'qualityToggle':_0x190aa9[_0x49d2d0(0xf9e)],'sm':_0x190aa9[_0x49d2d0(0x805)],'sm_dyn':_0x190aa9[_0x49d2d0(0xd60)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x49d2d0(0xc6b),'negative_prompt':_0x299d19}};console[_0x49d2d0(0x415)](_0x49d2d0(0x139d)),console[_0x49d2d0(0x415)](_0x49d2d0(0x1496),_0x45547b),console['log'](_0x49d2d0(0xcea),JSON[_0x49d2d0(0xe4d)](_0xaeb134,null,0x2));let _0x1d6f6d;_0x45547b[_0x49d2d0(0x138a)]('nai-diffusion-4')?_0x1d6f6d=_0x49d2d0(0x132d):_0x1d6f6d=_0x49d2d0(0xf02);let _0x10fc10=_0x190aa9['cors_proxy'];_0x10fc10===_0x49d2d0(0x1334)&&(_0x10fc10=_0x190aa9['custom_proxy_url']||'');_0x10fc10&&_0x10fc10!==''&&(_0x1d6f6d=_0x10fc10+encodeURIComponent(_0x1d6f6d));const _0x1a7be8=/Chrome/[_0x49d2d0(0x1e0)](navigator[_0x49d2d0(0x528)])&&!/Edg/[_0x49d2d0(0x1e0)](navigator[_0x49d2d0(0x528)]);let _0xfe1cd1={'method':_0x49d2d0(0x655),'headers':{'Content-Type':'application/json','Authorization':_0x49d2d0(0xe83)+_0x2e1230},'body':JSON[_0x49d2d0(0xe4d)](_0xaeb134)};if(_0x1a7be8){console[_0x49d2d0(0x415)]('🔧\x20检测到Chrome浏览器，启用headers兼容性处理');const _0x529a3b={};for(const [_0x48287c,_0x1dbc6d]of Object[_0x49d2d0(0x127b)](_0xfe1cd1[_0x49d2d0(0x79a)])){_0x529a3b[_0x48287c]=_0x1dbc6d[_0x49d2d0(0x13ed)](/[^\x00-\xFF]/g,'');}_0xfe1cd1[_0x49d2d0(0x79a)]=_0x529a3b;}const _0x135500=await fetch(_0x1d6f6d,_0xfe1cd1);console[_0x49d2d0(0x415)](_0x49d2d0(0x8ad),_0x135500[_0x49d2d0(0x2a3)]),console[_0x49d2d0(0x415)]('Response\x20headers:',[..._0x135500[_0x49d2d0(0x79a)][_0x49d2d0(0x127b)]()]);if(!_0x135500['ok']){const _0x586e8c=await _0x135500[_0x49d2d0(0x10ca)]();console['error']('API错误响应:',_0x586e8c);throw new Error(_0x49d2d0(0x669)+_0x135500['status']+_0x49d2d0(0xd30)+_0x586e8c);}const _0x26c91c=_0x135500[_0x49d2d0(0x79a)][_0x49d2d0(0x6b5)](_0x49d2d0(0x2ed));console[_0x49d2d0(0x415)]('Content-Type:',_0x26c91c);let _0x36a50d;if(_0x26c91c&&_0x26c91c[_0x49d2d0(0x138a)](_0x49d2d0(0x810))){console[_0x49d2d0(0x415)](_0x49d2d0(0x2c1)),_0x263669[_0x49d2d0(0x15f)]=_0x49d2d0(0x1325);const _0x71be43=await _0x135500[_0x49d2d0(0x10ca)]();console['log'](_0x49d2d0(0xf62),_0x71be43[_0x49d2d0(0x9a1)]);const _0x27eaee=_0x71be43[_0x49d2d0(0x97e)]()[_0x49d2d0(0xa8a)]('\x0a');let _0x5d2600=null;for(let _0x115a92=_0x27eaee[_0x49d2d0(0x9a1)]-0x1;_0x115a92>=0x0;_0x115a92--){const _0x537bd3=_0x27eaee[_0x115a92]['trim']();if(_0x537bd3['startsWith'](_0x49d2d0(0x16c))&&_0x537bd3!==_0x49d2d0(0xfdc)){const _0x5dce99=_0x537bd3[_0x49d2d0(0xa6b)](0x6);try{const _0x459344=JSON[_0x49d2d0(0xd91)](_0x5dce99);if(_0x459344[_0x49d2d0(0x81b)]===_0x49d2d0(0x186)&&_0x459344[_0x49d2d0(0x9e6)]){_0x5d2600=_0x459344['image'],console[_0x49d2d0(0x415)](_0x49d2d0(0x1a5));break;}if(_0x459344['data']){_0x5d2600=_0x459344[_0x49d2d0(0x1418)],console['log'](_0x49d2d0(0xb90));break;}if(_0x459344[_0x49d2d0(0x9e6)]){_0x5d2600=_0x459344[_0x49d2d0(0x9e6)],console[_0x49d2d0(0x415)](_0x49d2d0(0x677));break;}}catch(_0x48c16b){_0x5d2600=_0x5dce99,console['log'](_0x49d2d0(0xb3a));break;}}}if(!_0x5d2600)throw new Error(_0x49d2d0(0xb2d));const _0x56855e=_0x5d2600[_0x49d2d0(0x741)](_0x49d2d0(0xed9)),_0x180cc0=_0x5d2600[_0x49d2d0(0x741)](_0x49d2d0(0x5d4));if(_0x56855e||_0x180cc0){console[_0x49d2d0(0x415)](_0x49d2d0(0xa6a));const _0xc602da=atob(_0x5d2600),_0x1e7f20=new Uint8Array(_0xc602da[_0x49d2d0(0x9a1)]);for(let _0x3ae692=0x0;_0x3ae692<_0xc602da[_0x49d2d0(0x9a1)];_0x3ae692++){_0x1e7f20[_0x3ae692]=_0xc602da[_0x49d2d0(0xe26)](_0x3ae692);}const _0x1f3aa1=new Blob([_0x1e7f20],{'type':_0x56855e?_0x49d2d0(0xca9):'image/jpeg'});console[_0x49d2d0(0x415)](_0x49d2d0(0xdc0),_0x1f3aa1[_0x49d2d0(0x2d2)]);const _0x167db6=URL['createObjectURL'](_0x1f3aa1);document[_0x49d2d0(0x2ec)]('nai-result-image')[_0x49d2d0(0xce4)]=_0x167db6,_0x263669[_0x49d2d0(0x589)]['display']=_0x49d2d0(0x5b1),_0x527b5d['style'][_0x49d2d0(0x701)]=_0x49d2d0(0x13f7),console[_0x49d2d0(0x415)](_0x49d2d0(0x1050));return;}console[_0x49d2d0(0x415)]('当作\x20ZIP\x20文件处理...');const _0x21724b=atob(_0x5d2600),_0x172286=new Uint8Array(_0x21724b[_0x49d2d0(0x9a1)]);for(let _0x3033cd=0x0;_0x3033cd<_0x21724b[_0x49d2d0(0x9a1)];_0x3033cd++){_0x172286[_0x3033cd]=_0x21724b['charCodeAt'](_0x3033cd);}_0x36a50d=new Blob([_0x172286]),console['log']('ZIP\x20Blob\x20大小:',_0x36a50d[_0x49d2d0(0x2d2)]);}else _0x36a50d=await _0x135500[_0x49d2d0(0x465)](),console[_0x49d2d0(0x415)](_0x49d2d0(0x318),_0x36a50d['type'],_0x49d2d0(0x739),_0x36a50d['size']);try{if(typeof JSZip===_0x49d2d0(0xe40))throw new Error(_0x49d2d0(0x368));_0x263669[_0x49d2d0(0x15f)]='正在解压图片...';const _0x5f43c4=await JSZip['loadAsync'](_0x36a50d);console[_0x49d2d0(0x415)]('ZIP文件内容:',Object[_0x49d2d0(0xf6b)](_0x5f43c4['files']));let _0x1cbaf2=null;for(let _0x1c0b10 in _0x5f43c4[_0x49d2d0(0x8d6)]){if(_0x1c0b10[_0x49d2d0(0x49a)](/\.(png|jpg|jpeg|webp)$/i)){_0x1cbaf2=_0x5f43c4[_0x49d2d0(0x8d6)][_0x1c0b10],console[_0x49d2d0(0x415)]('找到图片文件:',_0x1c0b10);break;}}if(!_0x1cbaf2)throw new Error('ZIP文件中未找到图片');const _0x46a30d=await _0x1cbaf2[_0x49d2d0(0x138d)](_0x49d2d0(0x465));console[_0x49d2d0(0x415)](_0x49d2d0(0xad2),_0x46a30d[_0x49d2d0(0x2d2)]);const _0x13dea5=URL['createObjectURL'](_0x46a30d);console[_0x49d2d0(0x415)](_0x49d2d0(0x1219),_0x13dea5),document['getElementById'](_0x49d2d0(0xfd2))[_0x49d2d0(0xce4)]=_0x13dea5,_0x263669[_0x49d2d0(0x589)][_0x49d2d0(0x701)]='none',_0x527b5d[_0x49d2d0(0x589)][_0x49d2d0(0x701)]=_0x49d2d0(0x13f7);}catch(_0xbd9ecf){console[_0x49d2d0(0x1518)]('ZIP解压失败:',_0xbd9ecf),console[_0x49d2d0(0x415)](_0x49d2d0(0x1157));if(_0x36a50d['type']['startsWith'](_0x49d2d0(0x570))){const _0x1b2547=URL[_0x49d2d0(0x23d)](_0x36a50d);document[_0x49d2d0(0x2ec)]('nai-result-image')['src']=_0x1b2547,_0x263669[_0x49d2d0(0x589)][_0x49d2d0(0x701)]=_0x49d2d0(0x5b1),_0x527b5d[_0x49d2d0(0x589)][_0x49d2d0(0x701)]=_0x49d2d0(0x13f7);}else throw new Error(_0x49d2d0(0xf97)+_0xbd9ecf[_0x49d2d0(0x13bc)]);}}catch(_0x3b98e0){console[_0x49d2d0(0x1518)](_0x49d2d0(0x5c2),_0x3b98e0),_0x263669['style'][_0x49d2d0(0x701)]='none',_0x56054c['style'][_0x49d2d0(0x701)]=_0x49d2d0(0x13f7),_0x56054c[_0x49d2d0(0x15f)]='生成失败:\x20'+_0x3b98e0[_0x49d2d0(0x13bc)];}finally{_0x3fa73d[_0x49d2d0(0x1373)]=![],_0x3fa73d[_0x49d2d0(0x15f)]=_0x49d2d0(0x1b4);}}function _0x1c12fe(_0x3b44bb,_0x816b6d){const _0x340f50=_0x475790;_0x11973a(),clearTimeout(_0x3446f1);const _0x1b42e8=_0x28f30a[_0x340f50(0x6ce)][_0x3b44bb];if(!_0x1b42e8)return;const _0x1a7b98=document[_0x340f50(0x2ec)](_0x340f50(0x608));document[_0x340f50(0x2ec)](_0x340f50(0xdb6))['src']=_0x1b42e8[_0x340f50(0x362)]['aiAvatar']||_0x1b42e8[_0x340f50(0x362)][_0x340f50(0x42c)]||_0x825cf1,document[_0x340f50(0x2ec)](_0x340f50(0x9d5))[_0x340f50(0x765)](_0x340f50(0x324))['textContent']=_0x1b42e8[_0x340f50(0xe36)],document[_0x340f50(0x2ec)](_0x340f50(0x9d5))[_0x340f50(0x765)]('.message')[_0x340f50(0x15f)]=_0x816b6d,_0x1a7b98[_0x340f50(0xff6)][_0x340f50(0x1424)](_0x340f50(0x149d)),void _0x1a7b98[_0x340f50(0x144c)],_0x1a7b98[_0x340f50(0xff6)][_0x340f50(0xe82)]('visible');const _0x124059=_0x1a7b98['cloneNode'](!![]);_0x1a7b98[_0x340f50(0x1092)][_0x340f50(0x6ab)](_0x124059,_0x1a7b98),_0x124059[_0x340f50(0xf79)]('click',()=>{const _0x118949=_0x340f50;_0x473be6(_0x3b44bb),_0x124059[_0x118949(0xff6)][_0x118949(0x1424)](_0x118949(0x149d));}),_0x3446f1=setTimeout(()=>{const _0x5e2427=_0x340f50;_0x124059['classList'][_0x5e2427(0x1424)]('visible');},0xfa0),_0x4a1a61();}function _0x375281(){const _0x2a74c2=_0x475790,_0x6ed3b0=new Date(),_0x143cc7=_0x6ed3b0[_0x2a74c2(0x2b4)](_0x2a74c2(0x1054),{'hour':'2-digit','minute':_0x2a74c2(0x4ff)}),_0x99109e=_0x6ed3b0[_0x2a74c2(0xc14)]('zh-CN',{'weekday':_0x2a74c2(0x625),'month':_0x2a74c2(0x625),'day':'numeric'});document['getElementById'](_0x2a74c2(0x12b7))[_0x2a74c2(0x15f)]=_0x143cc7;}function _0x422882(_0x490b64){const _0x130acf=_0x475790;if(!_0x490b64)return[{'type':'text','content':_0x130acf(0x12bc)}];let _0x50c83c=_0x490b64[_0x130acf(0x97e)]();const _0x377dc5=/```json\s*([\s\S]*?)\s*```/,_0x53c176=_0x50c83c[_0x130acf(0x49a)](_0x377dc5);_0x53c176&&_0x53c176[0x1]&&(_0x50c83c=_0x53c176[0x1][_0x130acf(0x97e)](),console['log'](_0x130acf(0x6a6)));if(_0x50c83c[_0x130acf(0x741)]('[')&&_0x50c83c[_0x130acf(0xa64)](']'))try{const _0x19c2bf=JSON[_0x130acf(0xd91)](_0x50c83c);if(Array[_0x130acf(0x624)](_0x19c2bf))return console[_0x130acf(0x415)]('解析成功：标准JSON数组格式。'),_0x19c2bf;}catch(_0x3aa0e5){console[_0x130acf(0x664)](_0x130acf(0x947));}const _0x405943=_0x50c83c['indexOf']('['),_0xf34527=_0x50c83c[_0x130acf(0x3df)]('}');if(_0x405943!==-0x1&&_0xf34527!==-0x1&&_0xf34527>_0x405943){const _0x4462f9=_0x50c83c['indexOf'](']',_0xf34527);if(_0x4462f9!==-0x1){const _0x97d38a=_0x50c83c[_0x130acf(0xa6b)](_0x405943,_0x4462f9+0x1);try{const _0x324676=JSON[_0x130acf(0xd91)](_0x97d38a);if(Array['isArray'](_0x324676))return console[_0x130acf(0x415)]('解析成功：通过强力提取\x20[\x20...\x20}\x20...\x20]\x20模式。'),_0x324676;}catch(_0x4dffc6){console[_0x130acf(0x664)](_0x130acf(0xb21));}}}const _0x58373b=_0x50c83c[_0x130acf(0x49a)](/{[^{}]*}/g);if(_0x58373b){const _0x59acbc=[];for(const _0x32d3d6 of _0x58373b){try{const _0x18006a=JSON['parse'](_0x32d3d6);_0x59acbc[_0x130acf(0x367)](_0x18006a);}catch(_0x3d99f1){console[_0x130acf(0x664)](_0x130acf(0x1507),_0x32d3d6);}}if(_0x59acbc[_0x130acf(0x9a1)]>0x0)return console[_0x130acf(0x415)](_0x130acf(0xd39)),_0x59acbc;}return console['error']('所有解析方案均失败！将返回原始文本。原始回复:',_0x490b64),[{'type':_0x130acf(0x10ca),'content':_0x490b64}];}function _0x55bb06(_0xbe6a8d=new Date()){const _0x3b4ac5=_0x475790,_0x472d06=_0xbe6a8d[_0x3b4ac5(0x8a5)]();if(_0x472d06>=0x0&&_0x472d06<0x5)return'凌晨';else{if(_0x472d06>=0x5&&_0x472d06<0x9)return'早上';else{if(_0x472d06>=0x9&&_0x472d06<0xd)return'上午';else{if(_0x472d06>=0xd&&_0x472d06<0x12)return'下午';else{if(_0x472d06>=0x12&&_0x472d06<0x18)return'晚上';}}}}return'现在';}async function _0x2505be(){const _0x484e5c=_0x475790,_0xced2fa=document[_0x484e5c(0x2ec)](_0x484e5c(0xfa2));_0xced2fa['innerHTML']=_0x484e5c(0x82b);const _0x2a38c3=await _0x5b9d83[_0x484e5c(0xa72)][_0x484e5c(0x14b5)]();_0x2a38c3['forEach'](_0x3b8cbe=>{const _0x2701ec=_0x484e5c,_0x3f2549=document[_0x2701ec(0x14ae)](_0x2701ec(0x29d));_0x3f2549[_0x2701ec(0x11a4)]=_0x3b8cbe['id'],_0x3f2549['textContent']=_0x3b8cbe[_0x2701ec(0xe36)],_0xced2fa[_0x2701ec(0x998)](_0x3f2549);});const _0x20ef73=_0x28f30a[_0x484e5c(0x1537)];let _0x3c315d=null;for(const _0x299b8d of _0x2a38c3){if(_0x299b8d[_0x484e5c(0xd71)]===_0x20ef73[_0x484e5c(0xd71)]&&_0x299b8d[_0x484e5c(0x1420)]===_0x20ef73[_0x484e5c(0x1420)]&&_0x299b8d['model']===_0x20ef73[_0x484e5c(0x2bf)]&&_0x299b8d[_0x484e5c(0xcf0)]===_0x20ef73[_0x484e5c(0xcf0)]&&_0x299b8d[_0x484e5c(0xeae)]===_0x20ef73[_0x484e5c(0xeae)]&&_0x299b8d[_0x484e5c(0xf3f)]===_0x20ef73[_0x484e5c(0xf3f)]&&(_0x299b8d['minimaxGroupId']||'')===(_0x20ef73[_0x484e5c(0x104e)]||'')&&(_0x299b8d[_0x484e5c(0x1382)]||'')===(_0x20ef73[_0x484e5c(0x1382)]||'')&&(_0x299b8d[_0x484e5c(0xced)]||_0x484e5c(0x878))===(_0x20ef73[_0x484e5c(0xced)]||_0x484e5c(0x878))){_0x3c315d=_0x299b8d['id'];break;}}_0x3c315d?_0xced2fa[_0x484e5c(0x11a4)]=_0x3c315d:_0xced2fa['value']=_0x484e5c(0xd9a);}async function _0x24ac92(){const _0x21a702=_0x475790,_0x5af328=document[_0x21a702(0x2ec)](_0x21a702(0xfa2)),_0x3d8af5=parseInt(_0x5af328[_0x21a702(0x11a4)]);if(isNaN(_0x3d8af5))return;const _0x973e62=await _0x5b9d83[_0x21a702(0xa72)][_0x21a702(0x6b5)](_0x3d8af5);_0x973e62&&(_0x28f30a['apiConfig']={'id':_0x21a702(0x1130),'proxyUrl':_0x973e62[_0x21a702(0xd71)],'apiKey':_0x973e62[_0x21a702(0x1420)],'model':_0x973e62[_0x21a702(0x2bf)],'secondaryProxyUrl':_0x973e62[_0x21a702(0xcf0)],'secondaryApiKey':_0x973e62[_0x21a702(0xeae)],'secondaryModel':_0x973e62['secondaryModel'],'minimaxGroupId':_0x973e62[_0x21a702(0x104e)],'minimaxApiKey':_0x973e62[_0x21a702(0x1382)],'minimaxModel':_0x973e62[_0x21a702(0xced)]},await _0x5b9d83[_0x21a702(0x1537)][_0x21a702(0x7c3)](_0x28f30a['apiConfig']),_0x210b86(),document[_0x21a702(0x2ec)](_0x21a702(0xd65))[_0x21a702(0x1177)](),_0x973e62['secondaryProxyUrl']&&_0x973e62[_0x21a702(0xeae)]&&document[_0x21a702(0x2ec)]('fetch-secondary-models-btn')[_0x21a702(0x1177)](),alert(_0x21a702(0x34d)+_0x973e62[_0x21a702(0xe36)]+'”'));}async function _0x4d9285(){const _0x5c1625=_0x475790,_0x21ab5c=await _0x33419a('保存\x20API\x20预设','请输入预设名称');if(!_0x21ab5c||!_0x21ab5c['trim']())return;const _0x50a5f9={'name':_0x21ab5c[_0x5c1625(0x97e)](),'proxyUrl':document['getElementById'](_0x5c1625(0x1580))[_0x5c1625(0x11a4)][_0x5c1625(0x97e)](),'apiKey':document['getElementById'](_0x5c1625(0xf25))[_0x5c1625(0x11a4)][_0x5c1625(0x97e)](),'model':document[_0x5c1625(0x2ec)](_0x5c1625(0x12a6))[_0x5c1625(0x11a4)],'secondaryProxyUrl':document[_0x5c1625(0x2ec)](_0x5c1625(0x8f3))[_0x5c1625(0x11a4)]['trim'](),'secondaryApiKey':document[_0x5c1625(0x2ec)](_0x5c1625(0x13ec))['value'][_0x5c1625(0x97e)](),'secondaryModel':document['getElementById'](_0x5c1625(0x1256))[_0x5c1625(0x11a4)],'minimaxGroupId':document['getElementById'](_0x5c1625(0xc9e))[_0x5c1625(0x11a4)][_0x5c1625(0x97e)](),'minimaxApiKey':document[_0x5c1625(0x2ec)](_0x5c1625(0x7ff))[_0x5c1625(0x11a4)][_0x5c1625(0x97e)](),'minimaxModel':document['getElementById'](_0x5c1625(0x1083))['value']},_0x43f599=await _0x5b9d83[_0x5c1625(0xa72)][_0x5c1625(0x67e)](_0x5c1625(0xe36))[_0x5c1625(0x129a)](_0x50a5f9[_0x5c1625(0xe36)])['first']();if(_0x43f599){const _0x4a7d47=await _0x4436ba(_0x5c1625(0xa81),_0x5c1625(0xfcb)+_0x50a5f9[_0x5c1625(0xe36)]+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':_0x5c1625(0xd8f)});if(!_0x4a7d47)return;_0x50a5f9['id']=_0x43f599['id'];}await _0x5b9d83[_0x5c1625(0xa72)][_0x5c1625(0x7c3)](_0x50a5f9),await _0x2505be(),alert(_0x5c1625(0xb58));}async function _0x8c2d0a(){const _0x23d252=_0x475790,_0x53f7af=document['getElementById'](_0x23d252(0xfa2)),_0x176a11=parseInt(_0x53f7af['value']);if(isNaN(_0x176a11)){alert(_0x23d252(0x9bd));return;}const _0x16f94c=await _0x5b9d83[_0x23d252(0xa72)][_0x23d252(0x6b5)](_0x176a11);if(!_0x16f94c)return;const _0x57be78=await _0x4436ba(_0x23d252(0x3c5),_0x23d252(0x119d)+_0x16f94c['name']+_0x23d252(0x52e),{'confirmButtonClass':_0x23d252(0xd8f)});_0x57be78&&(await _0x5b9d83['apiPresets']['delete'](_0x176a11),await _0x2505be(),alert(_0x23d252(0x818)));}function _0x210b86(){const _0x2ca606=_0x475790;document['getElementById'](_0x2ca606(0x1580))[_0x2ca606(0x11a4)]=_0x28f30a[_0x2ca606(0x1537)][_0x2ca606(0xd71)]||'',document[_0x2ca606(0x2ec)](_0x2ca606(0xf25))[_0x2ca606(0x11a4)]=_0x28f30a[_0x2ca606(0x1537)][_0x2ca606(0x1420)]||'',document[_0x2ca606(0x2ec)](_0x2ca606(0x8f3))[_0x2ca606(0x11a4)]=_0x28f30a[_0x2ca606(0x1537)][_0x2ca606(0xcf0)]||'',document[_0x2ca606(0x2ec)](_0x2ca606(0x13ec))[_0x2ca606(0x11a4)]=_0x28f30a['apiConfig'][_0x2ca606(0xeae)]||'',document[_0x2ca606(0x2ec)](_0x2ca606(0x1182))['checked']=_0x28f30a[_0x2ca606(0x1062)]['enableBackgroundActivity']||![],document[_0x2ca606(0x2ec)](_0x2ca606(0x1270))['value']=_0x28f30a[_0x2ca606(0x1062)]['backgroundActivityInterval']||0x3c,document[_0x2ca606(0x2ec)](_0x2ca606(0x12a9))[_0x2ca606(0x11a4)]=_0x28f30a['globalSettings']['blockCooldownHours']||0x1,document[_0x2ca606(0x2ec)](_0x2ca606(0x270))['checked']=_0x28f30a['globalSettings'][_0x2ca606(0x10fa)],document[_0x2ca606(0x2ec)](_0x2ca606(0xb97))[_0x2ca606(0x11a4)]=_0x28f30a['globalSettings']['chatRenderWindow']||0x32,document[_0x2ca606(0x2ec)](_0x2ca606(0x3f4))[_0x2ca606(0x11a4)]=_0x28f30a['globalSettings'][_0x2ca606(0xd2b)]||0x1e;const _0x429d36=document[_0x2ca606(0x2ec)](_0x2ca606(0x133f)),_0x2cbdb0=document[_0x2ca606(0x2ec)](_0x2ca606(0xaf6)),_0x568ac2=_0x28f30a['globalSettings'][_0x2ca606(0x294)]||0.8;_0x429d36[_0x2ca606(0x11a4)]=_0x568ac2,_0x2cbdb0[_0x2ca606(0x15f)]=_0x568ac2,document['getElementById'](_0x2ca606(0xc9e))['value']=_0x28f30a['apiConfig'][_0x2ca606(0x104e)]||'',document[_0x2ca606(0x2ec)](_0x2ca606(0x7ff))[_0x2ca606(0x11a4)]=_0x28f30a['apiConfig'][_0x2ca606(0x1382)]||'',document[_0x2ca606(0x2ec)](_0x2ca606(0x1083))[_0x2ca606(0x11a4)]=_0x28f30a[_0x2ca606(0x1537)]['minimaxModel']||'speech-01';const _0x1859a7=localStorage[_0x2ca606(0x11c3)]('novelai-enabled')===_0x2ca606(0x33e),_0x42c90c=localStorage['getItem'](_0x2ca606(0x13f6))||_0x2ca606(0xb6c),_0x27bc24=localStorage[_0x2ca606(0x11c3)](_0x2ca606(0x5da))||'';document[_0x2ca606(0x2ec)](_0x2ca606(0xcd4))[_0x2ca606(0x13b8)]=_0x1859a7,document[_0x2ca606(0x2ec)](_0x2ca606(0x13f6))[_0x2ca606(0x11a4)]=_0x42c90c,document[_0x2ca606(0x2ec)](_0x2ca606(0x5da))['value']=_0x27bc24,document[_0x2ca606(0x2ec)]('novelai-details')[_0x2ca606(0x589)][_0x2ca606(0x701)]=_0x1859a7?_0x2ca606(0x13f7):_0x2ca606(0x5b1),_0x2505be(),_0x99c946();}window[_0x475790(0x7b0)]=_0x210b86;async function _0x52fcc7(){const _0xfd09f2=_0x475790,_0x5613d9=document['getElementById'](_0xfd09f2(0xf06));_0x5613d9[_0xfd09f2(0xc43)]='';const _0x1fcbad=await _0x5b9d83[_0xfd09f2(0x8f4)][_0xfd09f2(0x14b5)]();if(_0x1fcbad[_0xfd09f2(0x9a1)]===0x0){_0x5613d9[_0xfd09f2(0xc43)]=_0xfd09f2(0x43b);return;}_0x1fcbad['forEach'](_0x24de98=>{const _0x26047d=_0xfd09f2,_0x33f36a=document[_0x26047d(0x14ae)]('div');_0x33f36a['className']='chat-list-item',_0x33f36a[_0x26047d(0xe93)][_0x26047d(0x113e)]=_0x24de98['id'],_0x33f36a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x24de98[_0x26047d(0x516)]||_0xd71c66)+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x24de98['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>'+_0x24de98[_0x26047d(0xe32)][_0x26047d(0xa6b)](0x0,0x1e)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x33f36a[_0x26047d(0xf79)](_0x26047d(0x1177),()=>_0x7ad5c6(_0x24de98['id'])),_0x131542(_0x33f36a,async()=>{await _0x523e2c(_0x24de98['id']);}),_0x5613d9[_0x26047d(0x998)](_0x33f36a);});}async function _0x7ad5c6(_0x36c2c4=null){const _0x54147d=_0x475790;editingNpcId=_0x36c2c4;const _0x2bc0e7=document[_0x54147d(0x2ec)](_0x54147d(0xe46)),_0x227fda=document[_0x54147d(0x2ec)](_0x54147d(0x14f2)),_0x38c1fd=document['getElementById'](_0x54147d(0xc3a)),_0x3c0f7a=document[_0x54147d(0x2ec)](_0x54147d(0xcec)),_0x275add=document[_0x54147d(0x2ec)](_0x54147d(0x1068)),_0x3338fd=document['getElementById'](_0x54147d(0x22e)),_0x4eee8e=document[_0x54147d(0x2ec)](_0x54147d(0x43d)),_0x282f42=document['getElementById'](_0x54147d(0xc61)),_0x2b5ade=document[_0x54147d(0x2ec)](_0x54147d(0x8f2));_0x3338fd[_0x54147d(0xc43)]='',_0x4eee8e[_0x54147d(0xc43)]='<option\x20value=\x22\x22>--\x20未分组\x20--</option>';const _0x16f73c=await _0x5b9d83['npcGroups'][_0x54147d(0x14b5)]();_0x16f73c[_0x54147d(0xf99)](_0x4572ff=>{const _0x3fee6c=_0x54147d,_0x4fccd=document[_0x3fee6c(0x14ae)](_0x3fee6c(0x29d));_0x4fccd[_0x3fee6c(0x11a4)]=_0x4572ff['id'],_0x4fccd[_0x3fee6c(0x15f)]=_0x4572ff[_0x3fee6c(0xe36)],_0x4eee8e[_0x3fee6c(0x998)](_0x4fccd);}),_0x3338fd[_0x54147d(0xc43)]+=_0x54147d(0x1338)+(_0x28f30a[_0x54147d(0x1506)][_0x54147d(0x19a)]||'我')+_0x54147d(0x82d),Object[_0x54147d(0x74e)](_0x28f30a['chats'])[_0x54147d(0xebc)](_0x4ded23=>!_0x4ded23[_0x54147d(0x1423)])[_0x54147d(0xf99)](_0xf88f2b=>{const _0x553ba0=_0x54147d;_0x3338fd[_0x553ba0(0xc43)]+=_0x553ba0(0x7de)+_0xf88f2b['id']+_0x553ba0(0xb8d)+_0xf88f2b['name']+_0x553ba0(0xc0f);});if(_0x36c2c4){_0x227fda[_0x54147d(0x15f)]=_0x54147d(0x1570);const _0x226aa8=await _0x5b9d83[_0x54147d(0x8f4)][_0x54147d(0x6b5)](_0x36c2c4);_0x226aa8&&(_0x38c1fd['value']=_0x226aa8['name'],_0x3c0f7a['value']=_0x226aa8[_0x54147d(0xe32)],_0x275add['src']=_0x226aa8[_0x54147d(0x516)]||_0xd71c66,_0x282f42[_0x54147d(0x13b8)]=_0x226aa8['enableBackgroundActivity']!==![],_0x2b5ade['value']=_0x226aa8[_0x54147d(0xff3)]||0xf,_0x4eee8e[_0x54147d(0x11a4)]=_0x226aa8[_0x54147d(0x2c3)]||'',_0x226aa8['associatedWith']&&Array['isArray'](_0x226aa8[_0x54147d(0xaef)])&&_0x226aa8[_0x54147d(0xaef)][_0x54147d(0xf99)](_0x254cf4=>{const _0x35a990=_0x3338fd['querySelector']('input[value=\x22'+_0x254cf4+'\x22]');if(_0x35a990)_0x35a990['checked']=!![];}));}else{_0x227fda[_0x54147d(0x15f)]=_0x54147d(0x753),_0x38c1fd[_0x54147d(0x11a4)]='',_0x3c0f7a[_0x54147d(0x11a4)]='',_0x275add['src']=_0xd71c66,_0x282f42['checked']=!![],_0x2b5ade[_0x54147d(0x11a4)]=0xf,_0x4eee8e[_0x54147d(0x11a4)]='';const _0x214c29=_0x3338fd[_0x54147d(0x765)]('input[value=\x22user\x22]');if(_0x214c29)_0x214c29[_0x54147d(0x13b8)]=!![];}_0x2bc0e7[_0x54147d(0xff6)][_0x54147d(0xe82)](_0x54147d(0x149d));}async function _0x338462(){const _0x1dab49=_0x475790,_0x52d572=document[_0x1dab49(0x2ec)](_0x1dab49(0xc3a))['value'][_0x1dab49(0x97e)](),_0x1be0f0=document[_0x1dab49(0x2ec)](_0x1dab49(0xcec))[_0x1dab49(0x11a4)][_0x1dab49(0x97e)]();if(!_0x52d572||!_0x1be0f0){alert(_0x1dab49(0x9d0));return;}const _0x518b60=Array[_0x1dab49(0x13d1)](document['querySelectorAll'](_0x1dab49(0x11dd)))['map'](_0x32113e=>_0x32113e['value']),_0x2d01e3=document['getElementById']('npc-background-activity-switch')[_0x1dab49(0x13b8)],_0x3c9694=parseInt(document[_0x1dab49(0x2ec)](_0x1dab49(0x8f2))['value'])||0xf,_0x46b1bf=parseInt(document[_0x1dab49(0x2ec)](_0x1dab49(0x43d))[_0x1dab49(0x11a4)])||null,_0x3b92b1={'name':_0x52d572,'persona':_0x1be0f0,'avatar':document['getElementById']('npc-avatar-preview')[_0x1dab49(0xce4)],'associatedWith':_0x518b60,'enableBackgroundActivity':_0x2d01e3,'actionCooldownMinutes':_0x3c9694,'npcGroupId':_0x46b1bf};if(editingNpcId)await _0x5b9d83[_0x1dab49(0x8f4)][_0x1dab49(0x130a)](editingNpcId,_0x3b92b1);else{const _0x46278a=await _0x5b9d83['npcs'][_0x1dab49(0xe82)](_0x3b92b1);if(_0x335ffe&&_0x28f30a[_0x1dab49(0x11b9)]){const _0x37a324=_0x28f30a[_0x1dab49(0x6ce)][_0x28f30a[_0x1dab49(0x11b9)]];_0x37a324['isGroup']&&(_0x37a324['members'][_0x1dab49(0x367)]({'id':_0x1dab49(0x3c8)+_0x46278a,'originalName':_0x52d572,'groupNickname':_0x52d572,'persona':_0x1be0f0,'avatar':_0x3b92b1[_0x1dab49(0x516)],'isNpc':!![]}),await _0x5b9d83[_0x1dab49(0x6ce)][_0x1dab49(0x7c3)](_0x37a324));}}document[_0x1dab49(0x2ec)](_0x1dab49(0xe46))[_0x1dab49(0xff6)][_0x1dab49(0x1424)](_0x1dab49(0x149d)),_0x335ffe?(_0x335ffe=![],_0x2f535f()):await _0x52fcc7();}async function _0x6deb33(){const _0x5ef8d2=_0x475790;await _0x531282(),document[_0x5ef8d2(0x2ec)](_0x5ef8d2(0xe73))[_0x5ef8d2(0xff6)][_0x5ef8d2(0xe82)](_0x5ef8d2(0x149d));}async function _0x531282(){const _0x4f451c=_0x475790,_0x4574be=document['getElementById'](_0x4f451c(0xe43)),_0x5a2b13=await _0x5b9d83['npcGroups'][_0x4f451c(0x14b5)]();_0x4574be[_0x4f451c(0xc43)]='',_0x5a2b13[_0x4f451c(0x9a1)]===0x0&&(_0x4574be[_0x4f451c(0xc43)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>'),_0x5a2b13['forEach'](_0x5aa8fe=>{const _0x3c43df=_0x4f451c,_0x3e2020=document[_0x3c43df(0x14ae)](_0x3c43df(0xaa5));_0x3e2020['className']=_0x3c43df(0xe3c),_0x3e2020[_0x3c43df(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x5aa8fe[_0x3c43df(0xe36)]+_0x3c43df(0x6ff)+_0x5aa8fe['id']+_0x3c43df(0x13de),_0x4574be[_0x3c43df(0x998)](_0x3e2020);});}async function _0xa5c389(){const _0x15dbde=_0x475790,_0x524377=document[_0x15dbde(0x2ec)](_0x15dbde(0x29a)),_0x4a2055=_0x524377['value']['trim']();if(!_0x4a2055){alert('分组名不能为空！');return;}const _0x23360f=await _0x5b9d83[_0x15dbde(0x453)][_0x15dbde(0x67e)](_0x15dbde(0xe36))[_0x15dbde(0x129a)](_0x4a2055)[_0x15dbde(0x942)]();if(_0x23360f){alert('分组\x20\x22'+_0x4a2055+_0x15dbde(0xd64));return;}await _0x5b9d83[_0x15dbde(0x453)]['add']({'name':_0x4a2055}),_0x524377[_0x15dbde(0x11a4)]='',await _0x531282();}async function _0x59c145(_0x3664de){const _0x3e1ddd=_0x475790,_0x28e488=await _0x4436ba('确认删除',_0x3e1ddd(0x1432),{'confirmButtonClass':'btn-danger'});_0x28e488&&(await _0x5b9d83[_0x3e1ddd(0x453)][_0x3e1ddd(0x54b)](_0x3664de),await _0x5b9d83[_0x3e1ddd(0x8f4)][_0x3e1ddd(0x67e)]('npcGroupId')['equals'](_0x3664de)[_0x3e1ddd(0xa88)]({'npcGroupId':null}),await _0x531282());}async function _0x523e2c(_0x29f497){const _0x5d5e5a=_0x475790,_0x1e0347=await _0x5b9d83[_0x5d5e5a(0x8f4)][_0x5d5e5a(0x6b5)](_0x29f497);if(!_0x1e0347)return;const _0x25fcb7=await _0x4436ba(_0x5d5e5a(0x5f4),_0x5d5e5a(0x2cc)+_0x1e0347[_0x5d5e5a(0xe36)]+_0x5d5e5a(0x52e),{'confirmButtonClass':_0x5d5e5a(0xd8f)});_0x25fcb7&&(await _0x5b9d83['npcs'][_0x5d5e5a(0x54b)](_0x29f497),await _0x52fcc7());}let _0x36ca32=0x0;function _0x589f00(_0x6a6075){const _0x54dd35=_0x475790,_0x29f40d=document[_0x54dd35(0x14ae)](_0x54dd35(0xaa5));return _0x29f40d[_0x54dd35(0xdd1)]=_0x54dd35(0x14b7),_0x29f40d[_0x54dd35(0xc43)]=_0x54dd35(0xefd)+_0x6a6075[_0x54dd35(0xe36)]+_0x54dd35(0x2d9),_0x29f40d;}function _0xf4e5e0(_0x53d977){const _0x16ac90=_0x475790,_0xad4c46=document[_0x16ac90(0x2ec)](_0x16ac90(0x852)),_0x1d3204=document[_0x16ac90(0x2ec)](_0x16ac90(0xae9));if(_0x1d3204)_0x1d3204[_0x16ac90(0x1424)]();const _0x571afe=_0x36ca32,_0x4db8dd=_0x36ca32+CHAT_LIST_RENDER_WINDOW,_0x5592f8=_0x53d977['slice'](_0x571afe,_0x4db8dd),_0x491d4e=document[_0x16ac90(0x12c0)]();let _0x43fb7f=_0xad4c46[_0x16ac90(0x765)](_0x16ac90(0x448));_0x5592f8[_0x16ac90(0xf99)](_0x6b5b1d=>{const _0x2d655b=_0x16ac90;if(_0x6b5b1d['type']==='groupHeader'){const _0x500cc0=_0x589f00(_0x6b5b1d[_0x2d655b(0x1356)]);_0x491d4e[_0x2d655b(0x998)](_0x500cc0),_0x43fb7f=_0x500cc0[_0x2d655b(0x765)](_0x2d655b(0x240));}else{if(_0x6b5b1d[_0x2d655b(0xb4b)]===_0x2d655b(0xdf6)){const _0x405564=_0x52669f(_0x6b5b1d[_0x2d655b(0x73b)]);_0x43fb7f&&_0x6b5b1d['chat']['groupId']?_0x43fb7f[_0x2d655b(0x998)](_0x405564):(_0x491d4e[_0x2d655b(0x998)](_0x405564),_0x43fb7f=null);}}}),_0xad4c46[_0x16ac90(0x998)](_0x491d4e),_0x36ca32+=_0x5592f8[_0x16ac90(0x9a1)],_0x53d977[_0x16ac90(0x9a1)]>_0x36ca32&&_0x4fbf7f(_0xad4c46,_0x53d977),document[_0x16ac90(0x5d6)](_0x16ac90(0x13c4))[_0x16ac90(0xf99)](_0x16a4cb=>{const _0x34bbd2=_0x16ac90,_0x3137dc=_0x16a4cb['cloneNode'](!![]);_0x16a4cb[_0x34bbd2(0x1092)][_0x34bbd2(0x6ab)](_0x3137dc,_0x16a4cb),_0x3137dc[_0x34bbd2(0xf79)](_0x34bbd2(0x1177),()=>{const _0x34973d=_0x34bbd2;_0x3137dc[_0x34973d(0xff6)]['toggle']('collapsed'),_0x3137dc[_0x34973d(0xa15)]['classList'][_0x34973d(0x14c8)]('collapsed');});});}async function _0x5db8a3(){const _0x107d0a=_0x475790,_0x1778ab=document[_0x107d0a(0x2ec)](_0x107d0a(0x852));_0x1778ab[_0x107d0a(0xc43)]='';const _0x6d1299=Object[_0x107d0a(0x74e)](_0x28f30a[_0x107d0a(0x6ce)])[_0x107d0a(0x126b)]((_0x540f04,_0xc9ceee)=>{const _0x252dac=_0x107d0a,_0x2b0512=(_0xc9ceee[_0x252dac(0xa1c)]||![])-(_0x540f04[_0x252dac(0xa1c)]||![]);if(_0x2b0512!==0x0)return _0x2b0512;return(_0xc9ceee[_0x252dac(0x12c3)][_0x252dac(0x225)](-0x1)[0x0]?.[_0x252dac(0x69a)]||0x0)-(_0x540f04['history'][_0x252dac(0x225)](-0x1)[0x0]?.[_0x252dac(0x69a)]||0x0);}),_0x54591d=await _0x5b9d83['qzoneGroups']['toArray']();if(_0x6d1299[_0x107d0a(0x9a1)]===0x0){_0x1778ab[_0x107d0a(0xc43)]=_0x107d0a(0x713);return;}_0x54591d[_0x107d0a(0xf99)](_0x1911d6=>{const _0x353908=_0x107d0a,_0x234097=_0x6d1299['find'](_0x204b70=>_0x204b70[_0x353908(0x1542)]===_0x1911d6['id']);_0x1911d6[_0x353908(0x1183)]=_0x234097?_0x234097[_0x353908(0x12c3)][_0x353908(0x225)](-0x1)[0x0]?.[_0x353908(0x69a)]||0x0:0x0;}),_0x54591d[_0x107d0a(0x126b)]((_0x29282d,_0x4c4ec3)=>_0x4c4ec3['latestTimestamp']-_0x29282d[_0x107d0a(0x1183)]),_0x314ee2=[];const _0x16581d=new Set();_0x6d1299[_0x107d0a(0xf99)](_0x3adacb=>{const _0x3c8180=_0x107d0a;_0x3adacb[_0x3c8180(0xa1c)]&&(_0x314ee2[_0x3c8180(0x367)]({'type':_0x3c8180(0xdf6),'chat':_0x3adacb}),_0x16581d['add'](_0x3adacb['id']));}),_0x54591d[_0x107d0a(0xf99)](_0x1fed65=>{const _0x462410=_0x107d0a,_0x5b7a6b=_0x6d1299['filter'](_0x4ca4a8=>!_0x4ca4a8[_0x462410(0xa1c)]&&!_0x4ca4a8[_0x462410(0x1423)]&&_0x4ca4a8[_0x462410(0x1542)]===_0x1fed65['id']);_0x5b7a6b['length']>0x0&&(_0x314ee2[_0x462410(0x367)]({'type':_0x462410(0x2e0),'group':_0x1fed65}),_0x5b7a6b[_0x462410(0xf99)](_0x11d05f=>{const _0x5152df=_0x462410;_0x314ee2['push']({'type':'chatItem','chat':_0x11d05f}),_0x16581d[_0x5152df(0xe82)](_0x11d05f['id']);}));}),_0x6d1299['forEach'](_0x46fb3f=>{const _0x572e83=_0x107d0a;!_0x16581d[_0x572e83(0xbf1)](_0x46fb3f['id'])&&(_0x314ee2[_0x572e83(0x367)]({'type':_0x572e83(0xdf6),'chat':_0x46fb3f}),_0x16581d[_0x572e83(0xe82)](_0x46fb3f['id']));}),_0x36ca32=0x0,_0xf4e5e0();}function _0x589f00(_0x34bf71){const _0x34cc43=_0x475790,_0x5f2382=document[_0x34cc43(0x14ae)](_0x34cc43(0xaa5));return _0x5f2382[_0x34cc43(0xdd1)]=_0x34cc43(0x14b7),_0x5f2382[_0x34cc43(0xc43)]=_0x34cc43(0x7bc)+_0x34bf71[_0x34cc43(0xe36)]+_0x34cc43(0x1287),_0x5f2382;}function _0x4fbf7f(_0x57a766,_0x5aafa8){const _0x4838eb=_0x475790,_0x5dc57a=document[_0x4838eb(0x14ae)](_0x4838eb(0xd5a));_0x5dc57a['id']=_0x4838eb(0xae9),_0x5dc57a[_0x4838eb(0x15f)]=_0x4838eb(0x997),_0x5dc57a[_0x4838eb(0xdd1)]='load-more-btn',_0x5dc57a['addEventListener'](_0x4838eb(0x1177),()=>_0xf4e5e0(_0x5aafa8),{'once':!![]}),_0x57a766[_0x4838eb(0x41f)](_0x5dc57a);}function _0xf4e5e0(){const _0x221fd9=_0x475790;if(_0x27d082)return;const _0x5b15e9=document[_0x221fd9(0x2ec)]('chat-list'),_0x25f040=document[_0x221fd9(0x2ec)](_0x221fd9(0x1e2));if(!_0x5b15e9||!_0x25f040)return;if(_0x36ca32>=_0x314ee2[_0x221fd9(0x9a1)])return;_0x27d082=!![];const _0x263ca9=_0x36ca32===0x0,_0xfaaaf4=()=>{const _0x316860=_0x221fd9;_0x66d5be(_0x5b15e9);const _0x44fc6b=_0x28f30a['globalSettings']['chatListRenderWindow']||0x1e,_0x4120f8=_0x36ca32,_0x19a89c=_0x36ca32+_0x44fc6b,_0x26700e=_0x314ee2[_0x316860(0x225)](_0x4120f8,_0x19a89c),_0x5bde93=document['createDocumentFragment']();let _0x407052=_0x5b15e9[_0x316860(0x765)](_0x316860(0x448));_0x26700e[_0x316860(0xf99)](_0x31ff4c=>{const _0x375ab0=_0x316860;if(_0x31ff4c[_0x375ab0(0xb4b)]===_0x375ab0(0x2e0)){const _0xcbf0c0=_0x589f00(_0x31ff4c[_0x375ab0(0x1356)]);_0x5bde93['appendChild'](_0xcbf0c0),_0x407052=_0xcbf0c0['querySelector'](_0x375ab0(0x240));}else{if(_0x31ff4c['type']==='chatItem'){const _0x143999=_0x52669f(_0x31ff4c[_0x375ab0(0x73b)]);if(_0x31ff4c[_0x375ab0(0x73b)][_0x375ab0(0x1542)]&&_0x407052)_0x407052[_0x375ab0(0x998)](_0x143999);else{_0x5bde93[_0x375ab0(0x998)](_0x143999);if(!_0x31ff4c[_0x375ab0(0x73b)]['groupId'])_0x407052=null;}}}}),_0x5b15e9[_0x316860(0x998)](_0x5bde93),_0x36ca32+=_0x26700e[_0x316860(0x9a1)],_0x5b15e9['querySelectorAll']('.chat-group-header:not([data-has-listener=\x22true\x22])')[_0x316860(0xf99)](_0x15a9bb=>{const _0x1fc0b7=_0x316860;_0x15a9bb[_0x1fc0b7(0xe93)][_0x1fc0b7(0x1548)]=_0x1fc0b7(0x33e),_0x15a9bb[_0x1fc0b7(0xf79)](_0x1fc0b7(0x1177),()=>{const _0x31fe9a=_0x1fc0b7;_0x15a9bb[_0x31fe9a(0xff6)][_0x31fe9a(0x14c8)](_0x31fe9a(0x139b)),_0x15a9bb['nextElementSibling'][_0x31fe9a(0xff6)][_0x31fe9a(0x14c8)](_0x31fe9a(0x139b));});}),_0x27d082=![],_0x25f040[_0x316860(0x1ce)]<=_0x25f040['clientHeight']&&_0x36ca32<_0x314ee2[_0x316860(0x9a1)]&&_0xf4e5e0();};_0x263ca9?_0xfaaaf4():(_0x5d72d6(_0x5b15e9,_0x221fd9(0xe39)),setTimeout(_0xfaaaf4,0x1f4));}function _0x52669f(_0x5bad6e){const _0x1fa517=_0x475790;try{const _0x4398b5=_0x5bad6e['history'][_0x1fa517(0xebc)](_0x1dac8f=>!_0x1dac8f['isHidden'])[_0x1fa517(0x225)](-0x1)[0x0]||{};let _0x130885;if(!_0x5bad6e[_0x1fa517(0x1423)]&&_0x5bad6e[_0x1fa517(0xaf4)]?.[_0x1fa517(0x2a3)]===_0x1fa517(0x356))_0x130885=_0x1fa517(0x10a0)+(_0x5bad6e[_0x1fa517(0xaf4)]['applicationReason']||_0x1fa517(0xe30))+_0x1fa517(0x718);else{if(!_0x5bad6e[_0x1fa517(0x1423)]&&_0x5bad6e[_0x1fa517(0xaf4)]?.[_0x1fa517(0x2a3)]===_0x1fa517(0x56f))_0x130885=_0x1fa517(0x288);else{if(_0x5bad6e[_0x1fa517(0x1423)]){if(_0x4398b5['type']===_0x1fa517(0x10aa))_0x130885=_0x1fa517(0xcfe)+_0x4398b5[_0x1fa517(0x1047)];else{if(_0x4398b5[_0x1fa517(0xb4b)]===_0x1fa517(0x277))_0x130885=_0x1fa517(0x92c);else{if(_0x4398b5[_0x1fa517(0xb4b)]===_0x1fa517(0x11c7)||_0x4398b5[_0x1fa517(0xb4b)]==='user_photo')_0x130885=_0x1fa517(0x245);else{if(_0x4398b5[_0x1fa517(0xb4b)]===_0x1fa517(0x8bc))_0x130885=_0x1fa517(0xdb7);else{if(typeof _0x4398b5['content']===_0x1fa517(0x863)&&_0x41abd3[_0x1fa517(0x1e0)](_0x4398b5[_0x1fa517(0x1047)]))_0x130885=_0x4398b5[_0x1fa517(0x1488)]?_0x1fa517(0x4f3)+_0x4398b5[_0x1fa517(0x1488)]+']':_0x1fa517(0x258);else Array[_0x1fa517(0x624)](_0x4398b5[_0x1fa517(0x1047)])?_0x130885=_0x1fa517(0xf8c):_0x130885=String(_0x4398b5[_0x1fa517(0x1047)]||_0x1fa517(0x4e6))['substring'](0x0,0x14);}}}}if(_0x4398b5['senderName']&&_0x4398b5[_0x1fa517(0xb4b)]!==_0x1fa517(0x10aa)){const _0x3382f9=_0x4f967c(_0x5bad6e,_0x4398b5['senderName']);_0x130885=_0x3382f9+':\x20'+_0x130885;}}else{const _0x2f0286=_0x5bad6e[_0x1fa517(0x2a3)]?.[_0x1fa517(0x10ca)]||'在线';_0x130885='['+_0x2f0286+']';}}}const _0x2757e1=document['createElement']('div');_0x2757e1[_0x1fa517(0xdd1)]=_0x1fa517(0x1466),_0x2757e1[_0x1fa517(0xe93)][_0x1fa517(0xdd0)]=_0x5bad6e['id'];_0x5bad6e['isPinned']&&_0x2757e1[_0x1fa517(0xff6)][_0x1fa517(0xe82)]('pinned');const _0x89c841=_0x5bad6e[_0x1fa517(0x1423)]?_0x5bad6e[_0x1fa517(0x362)][_0x1fa517(0x42c)]:_0x5bad6e[_0x1fa517(0x362)][_0x1fa517(0xe91)],_0x2388e7=_0x5bad6e['isGroup']?'':_0x5bad6e[_0x1fa517(0x362)][_0x1fa517(0x5b8)]||'';let _0x309cf6;_0x2388e7?_0x309cf6=_0x1fa517(0x5a2)+(_0x89c841||_0x825cf1)+_0x1fa517(0xa04)+_0x2388e7+_0x1fa517(0xf2b):_0x309cf6=_0x1fa517(0x416)+(_0x89c841||_0x825cf1)+_0x1fa517(0x14cc);const _0x5a8ac5=_0x2388e7?_0x1fa517(0xb39):'',_0x7451d2=_0x1fa517(0x1ff)+_0x5a8ac5+'\x22>'+_0x309cf6+_0x1fa517(0xd21);_0x2757e1[_0x1fa517(0xc43)]=_0x1fa517(0xac5)+_0x7451d2+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x5bad6e[_0x1fa517(0xe36)]+_0x1fa517(0x1194)+(_0x5bad6e[_0x1fa517(0x1423)]?_0x1fa517(0x1143):'')+_0x1fa517(0x9a2)+(_0x5bad6e[_0x1fa517(0x1423)]?_0x1fa517(0x885):'#b5b5b5')+_0x1fa517(0x1233)+_0x130885+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x319962=_0x5bad6e[_0x1fa517(0xce1)]||0x0,_0x2a3418=_0x2757e1[_0x1fa517(0x765)]('.unread-count');_0x319962>0x0?(_0x2a3418[_0x1fa517(0x15f)]=_0x319962>0x63?_0x1fa517(0x21a):_0x319962,_0x2a3418[_0x1fa517(0x589)]['display']=_0x1fa517(0x10e1)):_0x2a3418['style']['display']=_0x1fa517(0x5b1);const _0x5be773=_0x2757e1['querySelector'](_0x1fa517(0x6a0));_0x5be773&&(_0x5be773[_0x1fa517(0x589)][_0x1fa517(0x119b)]=_0x1fa517(0xda7),_0x5be773['addEventListener'](_0x1fa517(0xc7e),_0xd9dff=>{const _0x13106f=_0x1fa517;_0xd9dff[_0x13106f(0x106c)]();const _0x2ec4a0=_0x5bad6e[_0x13106f(0x1423)]?_0x5bad6e[_0x13106f(0xe36)]:_0x5bad6e['originalName'];_0x367dc2(_0x5bad6e['id'],_0x2ec4a0);}));const _0x3ed080=_0x2757e1[_0x1fa517(0x765)](_0x1fa517(0xf18));return _0x3ed080&&_0x3ed080[_0x1fa517(0xf79)](_0x1fa517(0x1177),()=>_0x473be6(_0x5bad6e['id'])),_0x131542(_0x2757e1,async _0x193ae6=>{const _0x1085ea=_0x1fa517,_0x20a04c=await _0x57a567(_0x5bad6e);switch(_0x20a04c){case'pin':_0x5bad6e['isPinned']=!_0x5bad6e[_0x1085ea(0xa1c)],await _0x5b9d83[_0x1085ea(0x6ce)]['put'](_0x5bad6e),_0x5db8a3();break;case _0x1085ea(0x54b):const _0x21cc8b=await _0x4436ba('删除对话',_0x1085ea(0xcad)+_0x5bad6e[_0x1085ea(0xe36)]+'\x22\x20的整个对话吗？此操作不可撤销。',{'confirmButtonClass':_0x1085ea(0xd8f)});if(_0x21cc8b){_0x79cac3[_0x1085ea(0xffc)]&&_0x79cac3['activeChatId']===_0x5bad6e['id']&&await _0x159f2b(![]);delete _0x28f30a[_0x1085ea(0x6ce)][_0x5bad6e['id']];if(_0x28f30a['activeChatId']===_0x5bad6e['id'])_0x28f30a['activeChatId']=null;await _0x5b9d83['chats'][_0x1085ea(0x54b)](_0x5bad6e['id']),_0x5db8a3();}break;default:break;}}),_0x2757e1;}catch(_0x37a6de){return console[_0x1fa517(0x1518)](_0x1fa517(0xefb)+(_0x5bad6e[_0x1fa517(0xe36)]||'未知')+_0x1fa517(0x1e3)+_0x5bad6e['id']+')\x20时出错:',_0x37a6de),null;}}async function _0xc55746(_0x4f552a){const _0x20ba80=_0x475790;_0x470d5b(),_0x1e3c59();const _0x925bfb=_0x28f30a[_0x20ba80(0x6ce)][_0x4f552a];if(!_0x925bfb)return;_0x13d807();const _0x569dc6=document[_0x20ba80(0x2ec)](_0x20ba80(0x156b)),_0x55d843=document[_0x20ba80(0x2ec)](_0x20ba80(0x2ea)),_0x2754b3=document['getElementById'](_0x20ba80(0x2c9)),_0x4fb5ad=document[_0x20ba80(0x2ec)](_0x20ba80(0x1258));_0x569dc6[_0x20ba80(0xe93)][_0x20ba80(0x2a7)]=_0x925bfb[_0x20ba80(0x362)][_0x20ba80(0x2a7)]||_0x20ba80(0x44a);const _0xc1297c=_0x925bfb[_0x20ba80(0x362)][_0x20ba80(0x14b8)]||0xd;_0x569dc6['style'][_0x20ba80(0x644)]('--chat-font-size',_0xc1297c+'px'),_0x4171f3(_0x925bfb['settings'][_0x20ba80(0x9f1)]||'',_0x20ba80(0x939),'custom-bubble-style'),document[_0x20ba80(0x2ec)](_0x20ba80(0x96a))[_0x20ba80(0x15f)]=_0x925bfb['name'];const _0x43a3d4=document['getElementById'](_0x20ba80(0x139a)),_0x49191f=_0x43a3d4[_0x20ba80(0x765)](_0x20ba80(0x1126));_0x925bfb[_0x20ba80(0x1423)]?(_0x43a3d4[_0x20ba80(0x589)][_0x20ba80(0x701)]='none',document[_0x20ba80(0x2ec)](_0x20ba80(0xaf1))[_0x20ba80(0x589)]['justifyContent']=_0x20ba80(0x40e)):(_0x43a3d4[_0x20ba80(0x589)][_0x20ba80(0x701)]=_0x20ba80(0xc67),document[_0x20ba80(0x2ec)](_0x20ba80(0xaf1))['style'][_0x20ba80(0x348)]=_0x20ba80(0x117f),_0x49191f[_0x20ba80(0x15f)]=_0x925bfb[_0x20ba80(0x2a3)]?.[_0x20ba80(0x10ca)]||'在线',_0x43a3d4[_0x20ba80(0xff6)]['toggle']('busy',_0x925bfb[_0x20ba80(0x2a3)]?.[_0x20ba80(0x14f9)]||![]));const _0x500cf3=document[_0x20ba80(0x2ec)]('chat-interface-screen'),_0x4abd39=_0x925bfb[_0x20ba80(0x362)][_0x20ba80(0x137c)],_0x3d3bae=_0x28f30a[_0x20ba80(0x1062)][_0x20ba80(0x9b7)],_0xa875df=document['getElementById'](_0x20ba80(0x1007))['classList'][_0x20ba80(0xe9a)](_0x20ba80(0x152c)),_0x541411=_0xa875df?_0x20ba80(0x9ef):_0x20ba80(0x471);if(_0x4abd39)_0x500cf3[_0x20ba80(0x589)][_0x20ba80(0xe00)]='url('+_0x4abd39+')',_0x500cf3[_0x20ba80(0x589)][_0x20ba80(0xc34)]=_0x20ba80(0x921);else _0x3d3bae?(_0x500cf3[_0x20ba80(0x589)][_0x20ba80(0xe00)]='url('+_0x3d3bae+')',_0x500cf3[_0x20ba80(0x589)]['backgroundColor']=_0x20ba80(0x921)):(_0x500cf3[_0x20ba80(0x589)][_0x20ba80(0xe00)]=_0x20ba80(0x5b1),_0x500cf3['style'][_0x20ba80(0xc34)]=_0x541411);if(_0x925bfb[_0x20ba80(0x95d)])_0x55d843['style'][_0x20ba80(0x701)]='none',_0x2754b3['style'][_0x20ba80(0x701)]=_0x20ba80(0xc67),_0x4fb5ad['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document['getElementById']('spectator-propel-btn')[_0x20ba80(0x6b6)]=_0x3510c8;else{_0x55d843[_0x20ba80(0x589)]['display']='flex',_0x2754b3[_0x20ba80(0x589)][_0x20ba80(0x701)]=_0x20ba80(0x5b1),_0x4fb5ad[_0x20ba80(0xc43)]='';if(!_0x925bfb[_0x20ba80(0x1423)]&&_0x925bfb[_0x20ba80(0xaf4)][_0x20ba80(0x2a3)]!==_0x20ba80(0xab9)){_0x2754b3['style']['display']='flex',_0x55d843[_0x20ba80(0x589)][_0x20ba80(0xe4e)]='hidden';let _0x8fc0a7='';switch(_0x925bfb[_0x20ba80(0xaf4)]['status']){case _0x20ba80(0x214):const _0x3e5115=_0x50d0fa!==null,_0x2273e9=_0x925bfb['relationship'][_0x20ba80(0xee3)],_0x5b2464=_0x28f30a[_0x20ba80(0x1062)]['blockCooldownHours']||0x1,_0x2b71db=_0x5b2464*0x3c*0x3c*0x3e8,_0x263f01=Date[_0x20ba80(0x487)]()-_0x2273e9,_0x530b7e=_0x263f01>_0x2b71db,_0x150599=Math[_0x20ba80(0x7ac)](0x0,Math['ceil']((_0x2b71db-_0x263f01)/(0x3e8*0x3c)));_0x8fc0a7=_0x20ba80(0x48a)+_0x925bfb[_0x20ba80(0xe36)]+'”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20'+(_0x28f30a[_0x20ba80(0x1062)]['enableBackgroundActivity']?_0x20ba80(0xcc5):_0x20ba80(0x2f7))+_0x20ba80(0x970)+(_0x3e5115?_0x20ba80(0x135f):_0x20ba80(0x17f))+_0x20ba80(0xb0f)+_0x925bfb[_0x20ba80(0xaf4)]['status']+_0x20ba80(0x1241)+_0x5b2464+_0x20ba80(0x14c6)+(_0x530b7e?'<span\x20style=\x22color:\x20green;\x22>是</span>':_0x20ba80(0x9e0)+_0x150599+_0x20ba80(0x3ae))+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20'+(_0x530b7e&&_0x28f30a[_0x20ba80(0x1062)][_0x20ba80(0x12ed)]?_0x20ba80(0x722):'<span\x20style=\x22color:\x20red;\x22>未满足</span>')+_0x20ba80(0x909);break;case _0x20ba80(0x56f):_0x8fc0a7=_0x20ba80(0xbfc);break;case _0x20ba80(0x356):_0x8fc0a7=_0x20ba80(0x1cc)+_0x925bfb['name']+'”请求添加你为好友：<br><i>“'+_0x925bfb[_0x20ba80(0xaf4)]['applicationReason']+'”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';break;case'pending_ai_approval':_0x8fc0a7=_0x20ba80(0x68a);break;}_0x4fb5ad['innerHTML']=_0x8fc0a7;}else _0x2754b3[_0x20ba80(0x589)][_0x20ba80(0x701)]='none',_0x55d843[_0x20ba80(0x589)][_0x20ba80(0xe4e)]='visible';}_0x569dc6[_0x20ba80(0xc43)]='';const _0x207714=_0x925bfb['history'];_0x5df89d=0x0;const _0x3898c0=_0x28f30a[_0x20ba80(0x1062)][_0x20ba80(0x1002)]||0x32,_0x357ce4=_0x207714[_0x20ba80(0x225)](-_0x3898c0),_0x24899e=[];let _0x33f135=0x0;for(const _0x217106 of _0x357ce4){_0x33f135>0x0&&_0x217106['timestamp']-_0x33f135>0x927c0&&_0x24899e[_0x20ba80(0x367)](Promise[_0x20ba80(0xc75)](_0x5d2756(_0x217106[_0x20ba80(0x69a)]))),_0x24899e[_0x20ba80(0x367)](_0x43f190(_0x217106,_0x925bfb,!![])),_0x33f135=_0x217106[_0x20ba80(0x69a)];}const _0x4dcfd9=await Promise['all'](_0x24899e),_0x59eeaf=document[_0x20ba80(0x12c0)]();_0x4dcfd9['filter'](Boolean)[_0x20ba80(0xf99)](_0x119440=>_0x59eeaf[_0x20ba80(0x998)](_0x119440)),_0x569dc6[_0x20ba80(0x998)](_0x59eeaf),_0x5df89d=_0x357ce4[_0x20ba80(0x9a1)];const _0x218ca9=document[_0x20ba80(0x14ae)](_0x20ba80(0xaa5));_0x218ca9['id']=_0x20ba80(0x127f),_0x218ca9[_0x20ba80(0x589)][_0x20ba80(0x701)]='none',_0x218ca9[_0x20ba80(0x15f)]=_0x20ba80(0x786),_0x569dc6['appendChild'](_0x218ca9),setTimeout(()=>_0x569dc6[_0x20ba80(0x12be)]=_0x569dc6[_0x20ba80(0x1ce)],0x0);}async function _0x33df8e(){const _0x3da7fa=_0x475790;if(_0x51e675)return;_0x51e675=!![];const _0x814423=document[_0x3da7fa(0x2ec)]('chat-messages'),_0x49e724=_0x28f30a[_0x3da7fa(0x6ce)][_0x28f30a[_0x3da7fa(0x11b9)]];if(!_0x49e724){_0x51e675=![];return;}_0x5d72d6(_0x814423,_0x3da7fa(0xdd5));const _0x5a696f=_0x814423[_0x3da7fa(0x1ce)];await new Promise(_0x28f35a=>setTimeout(_0x28f35a,0x1f4));const _0x1f6ee1=_0x49e724[_0x3da7fa(0x12c3)][_0x3da7fa(0x9a1)],_0x45f553=_0x28f30a[_0x3da7fa(0x1062)]['chatRenderWindow']||0x32,_0x1a6e22=_0x1f6ee1-_0x5df89d-_0x45f553,_0x2f3f14=_0x1f6ee1-_0x5df89d,_0x9b5ad9=_0x49e724['history'][_0x3da7fa(0x225)](Math['max'](0x0,_0x1a6e22),_0x2f3f14),_0xa5b95b=_0x814423[_0x3da7fa(0x765)]('.message-wrapper[data-timestamp]');let _0x281fb5=_0xa5b95b?parseInt(_0xa5b95b[_0x3da7fa(0xe93)][_0x3da7fa(0x69a)]):0x0;for(const _0x19bc5b of _0x9b5ad9[_0x3da7fa(0x6c9)]()){if(_0x281fb5>0x0&&_0x281fb5-_0x19bc5b[_0x3da7fa(0x69a)]>0x927c0){const _0x3e803e=_0x5d2756(_0x281fb5);_0x814423[_0x3da7fa(0x41f)](_0x3e803e);}await _0x44e071(_0x19bc5b,_0x49e724),_0x281fb5=_0x19bc5b[_0x3da7fa(0x69a)];}_0x5df89d+=_0x9b5ad9[_0x3da7fa(0x9a1)];const _0x384764=_0x814423[_0x3da7fa(0x1ce)];_0x814423[_0x3da7fa(0x12be)]=_0x384764-_0x5a696f,_0x66d5be(_0x814423),_0x51e675=![];}function _0x1bf18e(){const _0x298c8c=_0x475790;_0x30f40a(),_0x5ef78d();const _0x36db5e=document[_0x298c8c(0x2ec)](_0x298c8c(0xb67)),_0x3854ba=_0x28f30a['globalSettings']['wallpaper'];_0x3854ba?(_0x36db5e[_0x298c8c(0x589)][_0x298c8c(0xe00)]=_0x298c8c(0xeb9)+_0x3854ba+')',_0x36db5e['textContent']=''):(_0x36db5e['style'][_0x298c8c(0xe00)]=_0x298c8c(0x6d4),_0x36db5e[_0x298c8c(0x15f)]='当前为渐变色');const _0x392abd=document[_0x298c8c(0x2ec)]('cphone-wallpaper-preview'),_0x3f836e=_0x28f30a[_0x298c8c(0x1062)][_0x298c8c(0x152d)];_0x3f836e?(_0x392abd[_0x298c8c(0x589)][_0x298c8c(0xe00)]=_0x298c8c(0xeb9)+_0x3f836e+')',_0x392abd[_0x298c8c(0x15f)]=''):(_0x392abd['style'][_0x298c8c(0xe00)]=_0x298c8c(0x862),_0x392abd[_0x298c8c(0x15f)]=_0x298c8c(0x115b));const _0x3eca84=document[_0x298c8c(0x2ec)]('global-bg-preview'),_0x1c510e=_0x28f30a[_0x298c8c(0x1062)][_0x298c8c(0x9b7)];_0x1c510e?(_0x3eca84[_0x298c8c(0x589)][_0x298c8c(0xe00)]='url('+_0x1c510e+')',_0x3eca84[_0x298c8c(0x15f)]='',document['getElementById'](_0x298c8c(0xcf7))[_0x298c8c(0x589)][_0x298c8c(0x701)]=_0x298c8c(0x51c)):(_0x3eca84[_0x298c8c(0x589)]['backgroundImage']=_0x298c8c(0x5b1),_0x3eca84[_0x298c8c(0x15f)]=_0x298c8c(0x433),document['getElementById'](_0x298c8c(0xcf7))[_0x298c8c(0x589)][_0x298c8c(0x701)]=_0x298c8c(0x5b1)),_0x5172c5(),_0x56ab60(),document[_0x298c8c(0x2ec)]('global-css-input')[_0x298c8c(0x11a4)]=_0x28f30a[_0x298c8c(0x1062)][_0x298c8c(0x1099)]||'',document[_0x298c8c(0x2ec)]('notification-sound-url-input')[_0x298c8c(0x11a4)]=_0x28f30a[_0x298c8c(0x1062)][_0x298c8c(0xaf0)]||'',document[_0x298c8c(0x2ec)](_0x298c8c(0x558))['checked']=_0x28f30a['globalSettings'][_0x298c8c(0x1f3)]||![],_0x70c8dc(),_0x31de81();}window[_0x475790(0x10d6)]=_0x1bf18e;function _0x1993ff(){const _0x4de4ca=_0x475790,_0x2b13a5=document[_0x4de4ca(0x2ec)](_0x4de4ca(0x436)),_0x384a52=_0x28f30a[_0x4de4ca(0x1062)][_0x4de4ca(0x638)];_0x384a52?_0x2b13a5[_0x4de4ca(0x589)][_0x4de4ca(0xe00)]='url('+_0x384a52+')':_0x2b13a5[_0x4de4ca(0x589)][_0x4de4ca(0xe00)]=_0x4de4ca(0x6d4);}function _0x1340f6(_0x338510){const _0x5516e1=_0x475790;document[_0x5516e1(0x5d6)]('.world-book-tab')[_0x5516e1(0xf99)](_0x1de19b=>{const _0x3cf20f=_0x5516e1;_0x1de19b[_0x3cf20f(0xff6)][_0x3cf20f(0x14c8)](_0x3cf20f(0xd43),_0x1de19b[_0x3cf20f(0xe93)]['categoryId']===_0x338510);}),document[_0x5516e1(0x5d6)]('.world-book-category-pane')['forEach'](_0x2b05cc=>{const _0x3dbc58=_0x5516e1;_0x2b05cc[_0x3dbc58(0xff6)]['toggle'](_0x3dbc58(0xd43),_0x2b05cc[_0x3dbc58(0xe93)][_0x3dbc58(0x10ce)]===_0x338510);});}async function _0x6f6974(){const _0x28644c=_0x475790,_0xbd2f46=document[_0x28644c(0x2ec)](_0x28644c(0x25a)),_0x205eb6=document[_0x28644c(0x2ec)](_0x28644c(0x140e));_0xbd2f46['innerHTML']='',_0x205eb6[_0x28644c(0xc43)]='';const [_0x4dc2fd,_0x1fba1e]=await Promise[_0x28644c(0xa92)]([_0x5b9d83[_0x28644c(0x13b9)][_0x28644c(0x14b5)](),_0x5b9d83[_0x28644c(0x5c0)][_0x28644c(0x106d)](_0x28644c(0xe36))[_0x28644c(0x14b5)]()]);_0x28f30a['worldBooks']=_0x4dc2fd;if(_0x4dc2fd[_0x28644c(0x9a1)]===0x0){_0x205eb6[_0x28644c(0xc43)]=_0x28644c(0x9d4);return;}const _0x104e52=document['createElement'](_0x28644c(0xd5a));_0x104e52[_0x28644c(0xdd1)]=_0x28644c(0x309),_0x104e52[_0x28644c(0x15f)]='全部',_0x104e52[_0x28644c(0xe93)][_0x28644c(0x10ce)]=_0x28644c(0xa92),_0xbd2f46['appendChild'](_0x104e52);const _0x4a82bf=document[_0x28644c(0x14ae)](_0x28644c(0xaa5));_0x4a82bf['className']='world-book-category-pane\x20active',_0x4a82bf[_0x28644c(0xe93)][_0x28644c(0x10ce)]=_0x28644c(0xa92),_0x205eb6[_0x28644c(0x998)](_0x4a82bf),_0x1fba1e['forEach'](_0x1e73eb=>{const _0x22d516=_0x28644c,_0x40f196=document[_0x22d516(0x14ae)]('button');_0x40f196['className']=_0x22d516(0x1239),_0x40f196['textContent']=_0x1e73eb['name'],_0x40f196[_0x22d516(0xe93)][_0x22d516(0x10ce)]=String(_0x1e73eb['id']),_0xbd2f46[_0x22d516(0x998)](_0x40f196);const _0x6b504c=document[_0x22d516(0x14ae)](_0x22d516(0xaa5));_0x6b504c[_0x22d516(0xdd1)]=_0x22d516(0xc92),_0x6b504c[_0x22d516(0xe93)][_0x22d516(0x10ce)]=String(_0x1e73eb['id']),_0x205eb6[_0x22d516(0x998)](_0x6b504c);});const _0x414d92=_0x4dc2fd[_0x28644c(0x7e2)](_0x565720=>!_0x565720['categoryId']);if(_0x414d92){const _0x4da618=document[_0x28644c(0x14ae)](_0x28644c(0xd5a));_0x4da618[_0x28644c(0xdd1)]=_0x28644c(0x1239),_0x4da618[_0x28644c(0x15f)]=_0x28644c(0x5d8),_0x4da618['dataset'][_0x28644c(0x10ce)]=_0x28644c(0x17c),_0xbd2f46[_0x28644c(0x998)](_0x4da618);const _0x291d38=document['createElement']('div');_0x291d38['className']=_0x28644c(0xc92),_0x291d38['dataset'][_0x28644c(0x10ce)]=_0x28644c(0x17c),_0x205eb6[_0x28644c(0x998)](_0x291d38);}_0x4dc2fd[_0x28644c(0xf99)](_0x219f06=>{const _0x156656=_0x28644c;let _0x4cda08=_0x156656(0x7d6);if(Array['isArray'](_0x219f06[_0x156656(0x1047)])&&_0x219f06[_0x156656(0x1047)]['length']>0x0){const _0x4b79f4=_0x219f06[_0x156656(0x1047)][0x0];_0x4cda08=_0x4b79f4[_0x156656(0x70d)]||_0x4b79f4['content']||'';}else typeof _0x219f06[_0x156656(0x1047)]==='string'&&_0x219f06[_0x156656(0x1047)]['trim']()!==''&&(_0x4cda08=_0x219f06[_0x156656(0x1047)]);const _0x5e0033=document[_0x156656(0x14ae)](_0x156656(0xaa5));_0x5e0033[_0x156656(0xdd1)]=_0x156656(0x56e),_0x5e0033[_0x156656(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x219f06[_0x156656(0xe36)]+_0x156656(0x1298)+_0x4cda08+_0x156656(0xefe);const _0x166df6=()=>_0x39b32a(_0x219f06['id']),_0x57c5a8=async()=>{const _0x5e6e52=_0x156656,_0x47a08d=await _0x4436ba('删除世界书',_0x5e6e52(0x139c)+_0x219f06['name']+_0x5e6e52(0x1443),{'confirmButtonClass':_0x5e6e52(0xd8f)});_0x47a08d&&(await _0x5b9d83[_0x5e6e52(0x13b9)][_0x5e6e52(0x54b)](_0x219f06['id']),_0x28f30a[_0x5e6e52(0x13b9)]=_0x28f30a[_0x5e6e52(0x13b9)]['filter'](_0x166748=>_0x166748['id']!==_0x219f06['id']),_0x6f6974());};_0x5e0033[_0x156656(0xf79)]('click',_0x166df6),_0x131542(_0x5e0033,_0x57c5a8);const _0xd99921=_0x5e0033['cloneNode'](!![]);_0xd99921[_0x156656(0xf79)]('click',_0x166df6),_0x131542(_0xd99921,_0x57c5a8),_0x4a82bf[_0x156656(0x998)](_0xd99921);const _0x747231=_0x219f06[_0x156656(0x10ce)]?String(_0x219f06['categoryId']):_0x156656(0x17c),_0x31ce58=_0x205eb6[_0x156656(0x765)](_0x156656(0x9c8)+_0x747231+'\x22]');_0x31ce58&&_0x31ce58['appendChild'](_0x5e0033);}),document['querySelectorAll'](_0x28644c(0xe54))[_0x28644c(0xf99)](_0x302aa5=>{const _0x53fc56=_0x28644c;_0x302aa5[_0x53fc56(0xf79)](_0x53fc56(0x1177),()=>_0x1340f6(_0x302aa5[_0x53fc56(0xe93)][_0x53fc56(0x10ce)]));});}function _0x2bd909(_0x311df6,_0x39e401){const _0x23b69b=_0x475790,_0x1f14bc=document[_0x23b69b(0x14ae)](_0x23b69b(0xaa5));_0x1f14bc[_0x23b69b(0xdd1)]='world-book-group-container',_0x1f14bc[_0x23b69b(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x311df6+_0x23b69b(0x315);const _0x49023a=_0x1f14bc[_0x23b69b(0x765)](_0x23b69b(0x295));return _0x39e401[_0x23b69b(0x126b)]((_0x3110b1,_0x3ee842)=>_0x3110b1[_0x23b69b(0xe36)]['localeCompare'](_0x3ee842[_0x23b69b(0xe36)],_0x23b69b(0x1054))),_0x39e401[_0x23b69b(0xf99)](_0xa4d5e1=>{const _0x5b5e4a=_0x23b69b;let _0x4631b8=_0x5b5e4a(0x7d6);if(Array['isArray'](_0xa4d5e1[_0x5b5e4a(0x1047)])&&_0xa4d5e1[_0x5b5e4a(0x1047)]['length']>0x0){const _0x3d4ede=_0xa4d5e1[_0x5b5e4a(0x1047)][0x0];_0x4631b8=_0x3d4ede[_0x5b5e4a(0x70d)]||_0x3d4ede['content']||'';}else typeof _0xa4d5e1[_0x5b5e4a(0x1047)]===_0x5b5e4a(0x863)&&_0xa4d5e1['content'][_0x5b5e4a(0x97e)]()!==''&&(_0x4631b8=_0xa4d5e1[_0x5b5e4a(0x1047)]);const _0x4d5212=document[_0x5b5e4a(0x14ae)](_0x5b5e4a(0xaa5));_0x4d5212[_0x5b5e4a(0xdd1)]='list-item',_0x4d5212[_0x5b5e4a(0xe93)][_0x5b5e4a(0x7f9)]=_0xa4d5e1['id'],_0x4d5212[_0x5b5e4a(0xc43)]=_0x5b5e4a(0x5b6)+_0xa4d5e1[_0x5b5e4a(0xe36)]+_0x5b5e4a(0x455)+String(_0x4631b8)[_0x5b5e4a(0xa6b)](0x0,0x32)+_0x5b5e4a(0xefe),_0x4d5212['addEventListener'](_0x5b5e4a(0x1177),()=>_0x39b32a(_0xa4d5e1['id'])),_0x131542(_0x4d5212,async()=>{const _0x5c6cfd=_0x5b5e4a,_0x51eec5=await _0x4436ba('删除世界书',_0x5c6cfd(0x139c)+_0xa4d5e1[_0x5c6cfd(0xe36)]+_0x5c6cfd(0xe55),{'confirmButtonClass':_0x5c6cfd(0xd8f)});_0x51eec5&&(await _0x5b9d83['worldBooks'][_0x5c6cfd(0x54b)](_0xa4d5e1['id']),_0x28f30a[_0x5c6cfd(0x13b9)]=_0x28f30a[_0x5c6cfd(0x13b9)][_0x5c6cfd(0xebc)](_0x2c549e=>_0x2c549e['id']!==_0xa4d5e1['id']),_0x6f6974());}),_0x49023a[_0x5b5e4a(0x998)](_0x4d5212);}),_0x1f14bc;}window[_0x475790(0xf84)]=_0x6f6974;async function _0x39b32a(_0x390435){const _0x13ecc5=_0x475790;_0x17ec27(_0x13ecc5(0xf12)),_0x143e12=_0x390435;const [_0x4b139d,_0x469f44]=await Promise[_0x13ecc5(0xa92)]([_0x5b9d83['worldBooks']['get'](_0x390435),_0x5b9d83[_0x13ecc5(0x5c0)][_0x13ecc5(0x14b5)]()]);if(!_0x4b139d){console['error']('尝试打开一个不存在的世界书，ID:',_0x390435),_0x17ec27('world-book-screen');return;}document[_0x13ecc5(0x2ec)](_0x13ecc5(0x8fd))['textContent']=_0x4b139d[_0x13ecc5(0xe36)],document[_0x13ecc5(0x2ec)](_0x13ecc5(0x1096))[_0x13ecc5(0x11a4)]=_0x4b139d['name'];const _0x38e9b2=document[_0x13ecc5(0x2ec)]('world-book-category-select');_0x38e9b2[_0x13ecc5(0xc43)]=_0x13ecc5(0xada),_0x469f44[_0x13ecc5(0xf99)](_0x4235cc=>{const _0x269a25=_0x13ecc5,_0x9cf5e6=document[_0x269a25(0x14ae)](_0x269a25(0x29d));_0x9cf5e6['value']=_0x4235cc['id'],_0x9cf5e6['textContent']=_0x4235cc[_0x269a25(0xe36)];if(_0x4b139d[_0x269a25(0x10ce)]===_0x4235cc['id'])_0x9cf5e6[_0x269a25(0xba2)]=!![];_0x38e9b2['appendChild'](_0x9cf5e6);});const _0x182496=document[_0x13ecc5(0x2ec)]('world-book-entries-container');_0x182496[_0x13ecc5(0xc43)]='',Array[_0x13ecc5(0x624)](_0x4b139d[_0x13ecc5(0x1047)])&&_0x4b139d['content'][_0x13ecc5(0x9a1)]>0x0?_0x4b139d[_0x13ecc5(0x1047)][_0x13ecc5(0xf99)](_0x195b78=>{const _0x40ebdc=_0x13ecc5,_0x43ef7b=_0x3c5856(_0x195b78);_0x182496[_0x40ebdc(0x998)](_0x43ef7b);}):_0x182496['innerHTML']=_0x13ecc5(0xea1);}async function _0xfb88c2(_0x5ad032=!![]){const _0x42c86b=_0x475790,_0x49732e=document[_0x42c86b(0x2ec)]('sticker-grid'),_0xd9ae97=document[_0x42c86b(0x2ec)]('sticker-category-tabs'),_0x17121b=document['getElementById'](_0x42c86b(0x485)),_0xac15f=_0x17121b[_0x42c86b(0x11a4)][_0x42c86b(0x97e)]()[_0x42c86b(0x1430)]();if(_0x5ad032){_0xd9ae97[_0x42c86b(0xc43)]='';const _0x4c65bf=await _0x5b9d83[_0x42c86b(0xc70)][_0x42c86b(0x14b5)]();_0xd9ae97[_0x42c86b(0xc43)]+=_0x42c86b(0x123c)+(_0x592042===_0x42c86b(0xa92)?_0x42c86b(0xd43):'')+_0x42c86b(0x111f),_0x4c65bf[_0x42c86b(0xf99)](_0x555174=>{const _0x2bb490=_0x42c86b;_0xd9ae97[_0x2bb490(0xc43)]+=_0x2bb490(0x123c)+(_0x592042===_0x555174['id']?_0x2bb490(0xd43):'')+_0x2bb490(0xaff)+_0x555174['id']+'\x22>'+_0x555174[_0x2bb490(0xe36)]+'</button>';}),_0xd9ae97[_0x42c86b(0xc43)]+=_0x42c86b(0x123c)+(_0x592042===_0x42c86b(0x17c)?_0x42c86b(0xd43):'')+_0x42c86b(0xd27);}_0x49732e[_0x42c86b(0xc43)]='';let _0x2525a9;if(_0x592042===_0x42c86b(0xa92))_0x2525a9=_0x28f30a[_0x42c86b(0xf28)];else _0x592042===_0x42c86b(0x17c)?_0x2525a9=_0x28f30a[_0x42c86b(0xf28)][_0x42c86b(0xebc)](_0x359e61=>!_0x359e61['categoryId']):_0x2525a9=_0x28f30a[_0x42c86b(0xf28)]['filter'](_0xb4cb68=>_0xb4cb68['categoryId']===_0x592042);const _0x3960d1=_0xac15f?_0x2525a9[_0x42c86b(0xebc)](_0x372ade=>_0x372ade[_0x42c86b(0xe36)][_0x42c86b(0x1430)]()['includes'](_0xac15f)):_0x2525a9;if(_0x3960d1[_0x42c86b(0x9a1)]===0x0){const _0x259ebe=_0xac15f?_0x42c86b(0xcb4):_0x42c86b(0x7fe);_0x49732e[_0x42c86b(0xc43)]=_0x42c86b(0x936)+_0x259ebe+_0x42c86b(0x1251);return;}_0x3960d1[_0x42c86b(0xf99)](_0x192fe8=>{const _0x1a9c5e=_0x42c86b,_0x5bbf93=document[_0x1a9c5e(0x14ae)]('div');_0x5bbf93[_0x1a9c5e(0xdd1)]=_0x1a9c5e(0x1f9),_0x5bbf93[_0x1a9c5e(0x141e)]=_0x192fe8[_0x1a9c5e(0xe36)],_0x5bbf93[_0x1a9c5e(0xe93)][_0x1a9c5e(0xf3a)]=_0x192fe8['id'],_0x5bbf93[_0x1a9c5e(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url('+_0x192fe8[_0x1a9c5e(0x6d1)]+_0x1a9c5e(0xd62)+_0x192fe8[_0x1a9c5e(0xe36)]+_0x1a9c5e(0xc69),_0x5bbf93[_0x1a9c5e(0xf79)]('click',()=>{_0x40b67c?_0xf2531b(_0x5bbf93):_0x93f258(_0x192fe8);});const _0x3c99ec=document[_0x1a9c5e(0x14ae)](_0x1a9c5e(0xaa5));_0x3c99ec[_0x1a9c5e(0xdd1)]='delete-btn',_0x3c99ec[_0x1a9c5e(0xc43)]=_0x1a9c5e(0x7d3),_0x3c99ec['onclick']=async _0x54e026=>{const _0x1a4211=_0x1a9c5e;_0x54e026[_0x1a4211(0x106c)]();const _0x2c74c6=await _0x4436ba(_0x1a4211(0xe66),_0x1a4211(0xa38)+_0x192fe8[_0x1a4211(0xe36)]+'\x22\x20吗？',{'confirmButtonClass':_0x1a4211(0xd8f)});_0x2c74c6&&(await _0x5b9d83[_0x1a4211(0xf28)][_0x1a4211(0x54b)](_0x192fe8['id']),_0x28f30a[_0x1a4211(0xf28)]=_0x28f30a[_0x1a4211(0xf28)]['filter'](_0x3fb7a9=>_0x3fb7a9['id']!==_0x192fe8['id']),_0xfb88c2());},_0x5bbf93['appendChild'](_0x3c99ec),_0x49732e[_0x1a9c5e(0x998)](_0x5bbf93);});}let _0x40b67c=![],_0x1ba22e=new Set(),_0x2a141d=![],_0x1be0c6=new Set(),_0x160b5e=[],_0x1b554d=0x0;const _0x3d2745=0x2d;let _0x585648=![];function _0x35e02d(){const _0x1295a9=_0x475790;_0x40b67c=!_0x40b67c;const _0x518a1d=document[_0x1295a9(0x2ec)]('sticker-grid'),_0x26aa11=document['getElementById']('manage-stickers-btn'),_0x15b3b7=document[_0x1295a9(0x2ec)](_0x1295a9(0x8e8)),_0x2f60e2=document[_0x1295a9(0x2ec)](_0x1295a9(0x1b1));_0x518a1d[_0x1295a9(0xff6)]['toggle'](_0x1295a9(0x919),_0x40b67c),_0x40b67c?(_0x26aa11['textContent']='完成',_0x15b3b7[_0x1295a9(0x589)]['display']='flex',_0x1ba22e[_0x1295a9(0xe98)](),_0x2f60e2[_0x1295a9(0x13b8)]=![],_0x5efc19()):(_0x26aa11[_0x1295a9(0x15f)]='管理',_0x15b3b7['style'][_0x1295a9(0x701)]=_0x1295a9(0x5b1),_0x518a1d[_0x1295a9(0x5d6)]('.sticker-item.selected')[_0x1295a9(0xf99)](_0x18a545=>_0x18a545[_0x1295a9(0xff6)][_0x1295a9(0x1424)](_0x1295a9(0xba2))));}function _0x1dae09(){const _0x91b977=_0x475790,_0x13ba95=document['getElementById'](_0x91b977(0x1b1)),_0x27f32e=_0x13ba95['checked'];let _0x240b9d;if(_0x592042===_0x91b977(0xa92))_0x240b9d=_0x28f30a['userStickers'];else _0x592042==='uncategorized'?_0x240b9d=_0x28f30a[_0x91b977(0xf28)][_0x91b977(0xebc)](_0x577d5e=>!_0x577d5e[_0x91b977(0x10ce)]):_0x240b9d=_0x28f30a[_0x91b977(0xf28)][_0x91b977(0xebc)](_0x366a0e=>_0x366a0e['categoryId']===_0x592042);_0x240b9d['forEach'](_0x12112b=>{const _0x2e5879=_0x91b977,_0x151d9c=_0x12112b['id'],_0x124347=document[_0x2e5879(0x765)](_0x2e5879(0x1327)+_0x151d9c+'\x22]');if(_0x27f32e){_0x1ba22e[_0x2e5879(0xe82)](_0x151d9c);if(_0x124347)_0x124347[_0x2e5879(0xff6)]['add'](_0x2e5879(0xba2));}else{_0x1ba22e['delete'](_0x151d9c);if(_0x124347)_0x124347[_0x2e5879(0xff6)]['remove'](_0x2e5879(0xba2));}}),_0x5efc19();}function _0x5efc19(){const _0xfecdb9=_0x475790,_0x40c38d=document[_0xfecdb9(0x2ec)](_0xfecdb9(0x53c));_0x40c38d[_0xfecdb9(0x15f)]=_0xfecdb9(0xc6e)+_0x1ba22e[_0xfecdb9(0x2d2)]+')';}function _0xf2531b(_0x21c8a7){const _0x219f62=_0x475790;if(!_0x40b67c)return;const _0x3e276d=_0x21c8a7['dataset']['stickerId'];if(!_0x3e276d)return;_0x21c8a7[_0x219f62(0xff6)][_0x219f62(0x14c8)](_0x219f62(0xba2)),_0x1ba22e[_0x219f62(0xbf1)](_0x3e276d)?_0x1ba22e['delete'](_0x3e276d):_0x1ba22e[_0x219f62(0xe82)](_0x3e276d),_0x5efc19();}async function _0x1747e8(){const _0x2ce216=_0x475790;if(_0x1ba22e[_0x2ce216(0x2d2)]===0x0)return;const _0x4795e3=await _0x4436ba('确认删除','确定要删除选中的\x20'+_0x1ba22e[_0x2ce216(0x2d2)]+_0x2ce216(0x6be),{'confirmButtonClass':_0x2ce216(0xd8f)});if(_0x4795e3){const _0x39ed01=[..._0x1ba22e];await _0x5b9d83[_0x2ce216(0xf28)][_0x2ce216(0x1521)](_0x39ed01),_0x28f30a[_0x2ce216(0xf28)]=_0x28f30a[_0x2ce216(0xf28)][_0x2ce216(0xebc)](_0x1d050e=>!_0x39ed01['includes'](_0x1d050e['id'])),_0x35e02d(),_0xfb88c2(),await _0x34d596('删除成功',_0x2ce216(0x1393));}}async function _0x46f85a(){const _0xb571d5=_0x475790,_0x2d78b5=_0xb571d5(0x12fd),_0x2c2aea=await _0x33419a('批量导入表情',_0x2d78b5,'',_0xb571d5(0x382));_0x2c2aea&&_0x2c2aea[_0xb571d5(0x97e)]()&&await _0x54ebba(_0x2c2aea);}async function _0x54ebba(_0x5515ef){const _0x21bea1=_0x475790,_0x2be44c=_0x5515ef[_0x21bea1(0x97e)]()[_0x21bea1(0xa8a)]('\x0a'),_0x519dc3=[],_0x203ad1='https://files.catbox.moe/';let _0x15970c=0x0;const _0x4c4c66=_0x592042!==_0x21bea1(0xa92)&&_0x592042!=='uncategorized'?_0x592042:null;for(const _0x119065 of _0x2be44c){const _0x26c0a4=_0x119065[_0x21bea1(0x97e)]();if(!_0x26c0a4||_0x26c0a4[_0x21bea1(0x138a)]('填入'))continue;const _0x44b16d=_0x26c0a4[_0x21bea1(0x49a)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x44b16d){const _0x34e857=_0x44b16d[0x1][_0x21bea1(0x97e)](),_0x6b6ebc=_0x44b16d[0x2][_0x21bea1(0x97e)]();_0x519dc3[_0x21bea1(0x367)]({'id':_0x21bea1(0x7db)+Date[_0x21bea1(0x487)]()+Math[_0x21bea1(0x1337)](),'name':_0x34e857,'url':_0x6b6ebc,'categoryId':_0x4c4c66});continue;}let _0x80943a=null,_0x387582=null;const _0xedd3ea=_0x26c0a4[_0x21bea1(0x49a)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0xedd3ea)_0x80943a=_0xedd3ea[0x1],_0x387582=_0xedd3ea[0x2];else{const _0x5a0fe6=_0x26c0a4['split'](/\s+/);_0x5a0fe6[_0x21bea1(0x9a1)]>=0x2&&(_0x387582=_0x5a0fe6[_0x21bea1(0xdba)](),_0x80943a=_0x5a0fe6[_0x21bea1(0xbad)]('\x20'));}_0x80943a&&_0x387582&&_0x387582[_0x21bea1(0x138a)]('.')?_0x519dc3[_0x21bea1(0x367)]({'id':_0x21bea1(0x7db)+Date[_0x21bea1(0x487)]()+Math[_0x21bea1(0x1337)](),'name':_0x80943a,'url':_0x203ad1+_0x387582,'categoryId':_0x4c4c66}):(_0x15970c++,console[_0x21bea1(0x664)](_0x21bea1(0x581),_0x26c0a4));}_0x15970c>0x0&&await _0x34d596(_0x21bea1(0x1216),'有\x20'+_0x15970c+'\x20行的格式不正确，已被系统跳过。');if(_0x519dc3[_0x21bea1(0x9a1)]>0x0)await _0x5b9d83[_0x21bea1(0xf28)][_0x21bea1(0x11f3)](_0x519dc3),_0x28f30a[_0x21bea1(0xf28)][_0x21bea1(0x367)](..._0x519dc3),_0xfb88c2(),await _0x34d596(_0x21bea1(0x685),_0x21bea1(0x1460)+_0x519dc3[_0x21bea1(0x9a1)]+_0x21bea1(0x630));else _0x15970c===0x0&&alert(_0x21bea1(0x53b));}function _0x44e2b8(_0x17b070){const _0x22fefd=_0x475790,_0x501189=_0x22fefd(0x84e)+_0x17b070+'\x22]',_0x52117f=document[_0x22fefd(0x765)](_0x501189);_0x52117f?(_0x52117f[_0x22fefd(0xe8b)]({'behavior':'smooth','block':_0x22fefd(0x40e)}),_0x52117f[_0x22fefd(0xff6)][_0x22fefd(0xe82)](_0x22fefd(0x22d)),setTimeout(()=>{const _0x5cd059=_0x22fefd;document[_0x5cd059(0x140d)][_0x5cd059(0xe9a)](_0x52117f)&&_0x52117f[_0x5cd059(0xff6)][_0x5cd059(0x1424)](_0x5cd059(0x22d));},0x5dc)):alert(_0x22fefd(0xf03));}async function _0x43f190(_0x3857ea,_0x45e24d){const _0x2adf93=_0x475790;if(_0x3857ea[_0x2adf93(0xb4b)]==='recalled_message'){const _0x10c364=document['createElement']('div');_0x10c364['className']=_0x2adf93(0x505),_0x10c364[_0x2adf93(0xe93)][_0x2adf93(0x69a)]=_0x3857ea[_0x2adf93(0x69a)];const _0x3a57aa=document['createElement'](_0x2adf93(0xaa5));return _0x3a57aa[_0x2adf93(0xdd1)]=_0x2adf93(0xb98),_0x3a57aa[_0x2adf93(0xe93)][_0x2adf93(0x69a)]=_0x3857ea[_0x2adf93(0x69a)],_0x3a57aa[_0x2adf93(0x15f)]=_0x3857ea[_0x2adf93(0x1047)],_0x10c364[_0x2adf93(0x998)](_0x3a57aa),_0x131542(_0x10c364,()=>_0x3986ce(_0x3857ea[_0x2adf93(0x69a)])),_0x10c364[_0x2adf93(0xf79)]('click',()=>{const _0x40cd29=_0x2adf93;_0x36063f&&_0x2f0498(_0x3857ea[_0x40cd29(0x69a)]);}),_0x10c364;}else{if(_0x3857ea['type']===_0x2adf93(0x5fe)){const _0x1b988d=document[_0x2adf93(0x14ae)](_0x2adf93(0xaa5));_0x1b988d['className']='message-wrapper\x20system-pat',_0x1b988d[_0x2adf93(0xe93)]['timestamp']=_0x3857ea[_0x2adf93(0x69a)];const _0x271e46=document['createElement'](_0x2adf93(0xaa5));return _0x271e46[_0x2adf93(0xdd1)]='message-bubble\x20post-deleted-placeholder',_0x271e46[_0x2adf93(0xe93)][_0x2adf93(0xa53)]=_0x3857ea[_0x2adf93(0xa53)],_0x271e46[_0x2adf93(0x15f)]=_0x3857ea[_0x2adf93(0x1047)],_0x1b988d[_0x2adf93(0x998)](_0x271e46),_0x131542(_0x1b988d,()=>_0x3986ce(_0x3857ea[_0x2adf93(0x69a)])),_0x1b988d[_0x2adf93(0xf79)](_0x2adf93(0x1177),()=>{const _0x23a057=_0x2adf93;_0x36063f&&_0x2f0498(_0x3857ea[_0x23a057(0x69a)]);}),_0x1b988d;}}if(_0x3857ea['isHidden'])return null;if(_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0x10aa)){const _0x321a0f=document[_0x2adf93(0x14ae)](_0x2adf93(0xaa5));_0x321a0f['className']=_0x2adf93(0x505);const _0x1f5575=document['createElement'](_0x2adf93(0xaa5));return _0x1f5575[_0x2adf93(0xdd1)]=_0x2adf93(0x1279),_0x1f5575[_0x2adf93(0xe93)][_0x2adf93(0x69a)]=_0x3857ea[_0x2adf93(0x69a)],_0x1f5575[_0x2adf93(0x15f)]=_0x3857ea['content'],_0x321a0f[_0x2adf93(0x998)](_0x1f5575),_0x131542(_0x321a0f,()=>_0x3986ce(_0x3857ea[_0x2adf93(0x69a)])),_0x321a0f[_0x2adf93(0xf79)](_0x2adf93(0x1177),()=>{const _0x1d17dd=_0x2adf93;if(_0x36063f)_0x2f0498(_0x3857ea[_0x1d17dd(0x69a)]);}),_0x321a0f;}const _0x3ee12a=_0x3857ea[_0x2adf93(0x9be)]==='user',_0x9f9017=_0x45e24d[_0x2adf93(0x362)][_0x2adf93(0xa28)]||'我',_0x10de54=document['createElement']('div');_0x10de54[_0x2adf93(0xdd1)]=_0x2adf93(0x109e)+(_0x3ee12a?_0x2adf93(0xcc9):'ai');if(_0x45e24d[_0x2adf93(0x1423)]&&!_0x3ee12a){const _0x597f78=_0x45e24d['members'][_0x2adf93(0x412)](_0x593885=>_0x593885[_0x2adf93(0x66c)]===_0x3857ea[_0x2adf93(0x1361)]),_0x25394a=document[_0x2adf93(0x14ae)](_0x2adf93(0xaa5));_0x25394a[_0x2adf93(0xdd1)]=_0x2adf93(0x93a),_0x25394a[_0x2adf93(0x15f)]=_0x597f78?_0x597f78[_0x2adf93(0x8a8)]:_0x3857ea[_0x2adf93(0x1361)]||_0x2adf93(0x124f),_0x10de54[_0x2adf93(0x998)](_0x25394a);}const _0x74769d=document[_0x2adf93(0x14ae)](_0x2adf93(0xaa5));_0x74769d['className']=_0x2adf93(0x194)+(_0x3ee12a?'user':'ai'),_0x74769d[_0x2adf93(0xe93)][_0x2adf93(0x69a)]=_0x3857ea[_0x2adf93(0x69a)];const _0x909d0a=document[_0x2adf93(0x14ae)]('span');_0x909d0a['className']=_0x2adf93(0x69a),_0x909d0a['textContent']=_0x17b30f(_0x3857ea['timestamp']);let _0x2c5aef,_0x3ebd42='';if(_0x3ee12a)_0x2c5aef=_0x45e24d[_0x2adf93(0x362)][_0x2adf93(0x10a3)]||(_0x45e24d[_0x2adf93(0x1423)]?_0x3ba305:_0x825cf1),_0x3ebd42=_0x45e24d['settings'][_0x2adf93(0xffe)]||'';else{if(_0x45e24d['isGroup']){const _0x52ea23=_0x45e24d[_0x2adf93(0x10f2)][_0x2adf93(0x412)](_0x1aee09=>_0x1aee09[_0x2adf93(0x66c)]===_0x3857ea[_0x2adf93(0x1361)]);if(_0x52ea23){const _0xe85416=_0x28f30a[_0x2adf93(0x6ce)][_0x52ea23['id']];_0x2c5aef=_0x52ea23[_0x2adf93(0x516)]||(_0xe85416?_0xe85416['settings'][_0x2adf93(0xe91)]:_0xd71c66),_0x3ebd42=_0x52ea23[_0x2adf93(0x13d9)]||(_0xe85416?_0xe85416[_0x2adf93(0x362)]['aiAvatarFrame']:'');}else _0x2c5aef=_0xd71c66,_0x3ebd42='';}else _0x2c5aef=_0x45e24d[_0x2adf93(0x362)]['aiAvatar']||_0x825cf1,_0x3ebd42=_0x45e24d[_0x2adf93(0x362)][_0x2adf93(0x5b8)]||'';}let _0x27efc7;_0x3ebd42?_0x27efc7='<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22'+_0x2c5aef+_0x2adf93(0xa04)+_0x3ebd42+_0x2adf93(0xf2b):_0x27efc7=_0x2adf93(0x416)+_0x2c5aef+_0x2adf93(0x14cc);const _0x4f3aa1=_0x3ebd42?_0x2adf93(0xb39):'',_0x3c60f6=_0x2adf93(0x1ff)+_0x4f3aa1+'\x22>'+_0x27efc7+'</div>';let _0x5d7677,_0x32ec81='';if(_0x3857ea[_0x2adf93(0x447)]){const _0x57d8f6=_0x4f967c(_0x45e24d,_0x3857ea[_0x2adf93(0x447)][_0x2adf93(0x1361)]),_0x19f20c=String(_0x3857ea[_0x2adf93(0x447)][_0x2adf93(0x1047)]||'');_0x32ec81=_0x2adf93(0xae5)+_0x3857ea[_0x2adf93(0x447)]['timestamp']+'\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20'+_0x57d8f6+_0x2adf93(0x2dd)+_0x19f20c+_0x2adf93(0x12dc);}let _0x274e09=_0x3857ea['content'];if(typeof _0x274e09===_0x2adf93(0x863)&&_0x274e09[_0x2adf93(0x97e)]()[_0x2adf93(0x741)]('<')&&_0x274e09[_0x2adf93(0x97e)]()[_0x2adf93(0xa64)]('>'))_0x5d7677=_0x274e09,_0x74769d[_0x2adf93(0xff6)][_0x2adf93(0xe82)](_0x2adf93(0x811));else{if(_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0x6fb)||_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0x9c6)||_0x3857ea[_0x2adf93(0xb4b)]==='share_card'||_0x3857ea[_0x2adf93(0xb4b)]==='location_share'||_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0x11c7)||_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0x7f7)||_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0x8bc)||_0x3857ea['type']===_0x2adf93(0x277)||_0x3857ea[_0x2adf93(0xb4b)]==='waimai_request'||_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0xea9)||_0x3857ea[_0x2adf93(0xb4b)]==='red_packet'||_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0xc2c)||_0x3857ea['type']==='gift'||_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0x1544)||_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0xd92)){if(_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0x6fb)){const _0x459eaf=_0x3857ea['content']||((_0x3857ea[_0x2adf93(0x6c4)]||'')+'\x20'+(_0x3857ea[_0x2adf93(0x9cc)]||''))['trim'](),_0x569515=/(「.*?」|“.*?”)/g,_0x1671f9=_0x459eaf[_0x2adf93(0xa8a)](_0x569515)[_0x2adf93(0xebc)](_0x5af14b=>_0x5af14b);_0x5d7677=_0x1671f9['map'](_0x42bdfa=>{const _0x473c16=_0x2adf93;return _0x42bdfa[_0x473c16(0x741)]('「')||_0x42bdfa[_0x473c16(0x741)]('“')?_0x473c16(0x113c)+_0x35bd8e(_0x42bdfa)+_0x473c16(0x718):'<span\x20class=\x22offline-description\x22>'+_0x35bd8e(_0x42bdfa['trim']())[_0x473c16(0x13ed)](/\n/g,_0x473c16(0xfd7))+_0x473c16(0x718);})[_0x2adf93(0xbad)]('');}else{if(_0x3857ea['type']===_0x2adf93(0x9c6))_0x74769d[_0x2adf93(0xff6)][_0x2adf93(0xe82)](_0x2adf93(0x290),_0x2adf93(0x139e)),_0x5d7677=_0x2adf93(0x143d)+_0x3857ea[_0x2adf93(0x69a)]+_0x2adf93(0x110e)+(_0x3857ea[_0x2adf93(0x141e)]||'无标题')+_0x2adf93(0x642)+(_0x3857ea[_0x2adf93(0x9cc)]||_0x2adf93(0x8b1))+_0x2adf93(0x1358)+(_0x3857ea['source_name']||'链接分享')+'</span></div></div>';else{if(_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0x886))_0x74769d[_0x2adf93(0xff6)][_0x2adf93(0xe82)](_0x2adf93(0x290),_0x2adf93(0x139e)),_0x5d7677='<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22'+_0x3857ea[_0x2adf93(0x69a)]+_0x2adf93(0x110e)+_0x3857ea['payload']['title']+'</div><div\x20class=\x22description\x22>共\x20'+_0x3857ea[_0x2adf93(0x13a6)][_0x2adf93(0xcc0)]['length']+_0x2adf93(0xbbb);else{if(_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0xae7)){_0x74769d[_0x2adf93(0xff6)]['add'](_0x2adf93(0x126d),_0x2adf93(0x139e));let _0x2536c2;if(_0x3857ea[_0x2adf93(0x6c6)])_0x2536c2=_0x3857ea[_0x2adf93(0x6c6)];else _0x28f30a[_0x2adf93(0x1062)][_0x2adf93(0x10fa)]&&_0x3857ea[_0x2adf93(0xe8f)]?_0x2536c2=_0x2adf93(0x6d0)+encodeURIComponent(_0x3857ea['image_prompt']):_0x2536c2='https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg';const _0x2c315e='style=\x22background-image:\x20url(\x27'+_0x2536c2+_0x2adf93(0x1111);_0x5d7677=_0x2adf93(0xf5d)+_0x3857ea[_0x2adf93(0x1047)]+_0x2adf93(0xa75)+_0x2c315e+_0x2adf93(0x144f);}else{if(_0x3857ea['type']==='user_photo'||_0x3857ea[_0x2adf93(0xb4b)]==='ai_image'){_0x74769d[_0x2adf93(0xff6)]['add'](_0x2adf93(0x856),_0x2adf93(0x139e));const _0x28946d=_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0x7f7)?_0x2adf93(0x95b):_0x2adf93(0x2a6),_0x1f6b87=_0x28f30a['globalSettings'][_0x2adf93(0x10fa)]&&_0x3857ea[_0x2adf93(0xe8f)]?_0x2adf93(0x6d0)+_0x3857ea[_0x2adf93(0xe8f)]:_0x2adf93(0xec2);_0x5d7677=_0x2adf93(0x416)+_0x1f6b87+_0x2adf93(0x6a3)+_0x28946d+_0x2adf93(0x9c9)+_0x3857ea['content']+'\x22>';}else{if(_0x3857ea[_0x2adf93(0xb4b)]==='naiimag')_0x74769d['classList'][_0x2adf93(0xe82)](_0x2adf93(0xe2b),_0x2adf93(0x139e)),_0x5d7677=_0x2adf93(0xa40)+_0x3857ea[_0x2adf93(0x6c6)]+_0x2adf93(0x491)+(_0x3857ea[_0x2adf93(0x5ae)]||_0x3857ea['prompt']||'NovelAI生成')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-regenerate-btn\x22\x20title=\x22重新生成\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222.5\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222.5\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';else{if(_0x3857ea['type']===_0x2adf93(0x8bc)){_0x74769d[_0x2adf93(0xff6)][_0x2adf93(0xe82)](_0x2adf93(0xbf3),'is-card-like');const _0x15b8f3=Math['max'](0x1,Math[_0x2adf93(0x8f9)]((_0x3857ea['content']||'')['length']/0x5)),_0x3cd2eb='0:'+String(_0x15b8f3)[_0x2adf93(0x58e)](0x2,'0')+'\x27\x27',_0x3c4573=_0x2adf93(0x14ea);if(_0x3ee12a)_0x5d7677=_0x2adf93(0x13c1)+encodeURIComponent(_0x3857ea[_0x2adf93(0x1047)])+_0x2adf93(0x8ce)+_0x3c4573+_0x2adf93(0x101a)+_0x3cd2eb+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';else{const _0x1c838d=!_0x45e24d[_0x2adf93(0x1423)]&&_0x45e24d['settings'][_0x2adf93(0x1ee)]!==![],_0xf43ba5=_0x45e24d['settings']['minimaxVoiceId']||_0x2adf93(0x812),_0x4c43c4=_0x1c838d?'data-voice-id=\x22'+_0xf43ba5+'\x22':'';_0x5d7677=_0x2adf93(0x13c1)+encodeURIComponent(_0x3857ea[_0x2adf93(0x1047)])+'\x22\x20'+_0x4c43c4+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>'+_0x3c4573+_0x2adf93(0x1324)+_0x3cd2eb+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}else{if(_0x3857ea[_0x2adf93(0xb4b)]==='transfer'){_0x74769d[_0x2adf93(0xff6)][_0x2adf93(0xe82)](_0x2adf93(0xb80),_0x2adf93(0x139e));let _0x2d8146,_0x2b54b3;const _0x2414d7=_0x45e24d[_0x2adf93(0x1423)]?_0x45e24d[_0x2adf93(0x362)][_0x2adf93(0xa28)]||'我':'我',_0x355352=_0x4f967c(_0x45e24d,_0x3857ea[_0x2adf93(0x1361)]),_0x20c8ab=_0x4f967c(_0x45e24d,_0x3857ea[_0x2adf93(0x61c)]||_0x45e24d[_0x2adf93(0xe36)]);if(_0x3ee12a){if(_0x3857ea[_0x2adf93(0x146c)])_0x2d8146=_0x2adf93(0x137a)+_0x20c8ab,_0x2b54b3=_0x2adf93(0x102d);else{_0x2d8146=_0x2adf93(0xf64)+_0x20c8ab;if(_0x3857ea[_0x2adf93(0x2a3)]===_0x2adf93(0x534))_0x2b54b3=_0x2adf93(0x3c0);else{if(_0x3857ea['status']===_0x2adf93(0x757))_0x2b54b3=_0x2adf93(0x1422);else _0x2b54b3=_0x3857ea[_0x2adf93(0x1333)]||_0x2adf93(0x1249);}}}else{if(_0x3857ea[_0x2adf93(0x146c)])_0x2d8146=_0x2adf93(0x22b)+_0x355352,_0x2b54b3=_0x2adf93(0x492);else{if(_0x3857ea[_0x2adf93(0x61c)]===_0x2414d7){_0x2d8146=_0x2adf93(0xf64)+_0x2414d7;if(_0x3857ea[_0x2adf93(0x2a3)]===_0x2adf93(0x534))_0x2b54b3=_0x2adf93(0xb51);else{if(_0x3857ea[_0x2adf93(0x2a3)]===_0x2adf93(0x757))_0x2b54b3='你已拒收';else _0x74769d['style'][_0x2adf93(0x119b)]=_0x2adf93(0xda7),_0x74769d[_0x2adf93(0xe93)][_0x2adf93(0x2a3)]=_0x2adf93(0x8c9),_0x2b54b3=_0x3857ea['note']||_0x2adf93(0x13b3);}}else _0x2d8146=_0x2adf93(0x238)+_0x355352+'\x20→\x20'+_0x20c8ab,_0x2b54b3=_0x3857ea[_0x2adf93(0x1333)]||_0x2adf93(0x14f8);}}const _0x59409b='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>';_0x5d7677=_0x2adf93(0x32b)+_0x59409b+'\x20'+_0x2d8146+_0x2adf93(0x49b)+Number(_0x3857ea[_0x2adf93(0x257)])[_0x2adf93(0x5c3)](0x2)+_0x2adf93(0x1360)+_0x2b54b3+_0x2adf93(0xbe0);}else{if(_0x3857ea['type']===_0x2adf93(0x12d5)){_0x74769d[_0x2adf93(0xff6)]['add']('is-waimai-request','is-card-like');if(_0x3857ea[_0x2adf93(0x2a3)]===_0x2adf93(0x12d6)||_0x3857ea['status']===_0x2adf93(0xb45))_0x74769d[_0x2adf93(0xff6)]['add']('status-'+_0x3857ea['status']);const _0x2115d8=_0x4f967c(_0x45e24d,_0x3857ea['senderName']),_0x1472b4=_0x2adf93(0xe9f)+_0x2115d8+_0x2adf93(0x9d7);let _0x2fe41b='';_0x3857ea['status']===_0x2adf93(0x8c9)&&!_0x3ee12a&&(_0x2fe41b=_0x2adf93(0x916)),_0x5d7677='<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>'+_0x1472b4+'</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥'+Number(_0x3857ea[_0x2adf93(0x257)])[_0x2adf93(0x5c3)](0x2)+_0x2adf93(0xbc5)+_0x3857ea[_0x2adf93(0x69a)]+_0x2adf93(0x36d)+_0x2fe41b+_0x2adf93(0xd21),setTimeout(()=>{const _0x537ec3=_0x2adf93;if(_0x3857ea[_0x537ec3(0x2a3)]===_0x537ec3(0x8c9)){const _0x35b173=document[_0x537ec3(0x2ec)](_0x537ec3(0x6f8)+_0x3857ea['timestamp']);if(_0x35b173){const _0x2aafb1=_0x5ef705(_0x35b173,_0x3857ea['countdownEndTime']);_0x216d5c[_0x3857ea['timestamp']]=_0x2aafb1;}}},0x0);}else{if(_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0xea9)){_0x74769d[_0x2adf93(0xff6)][_0x2adf93(0xe82)]('is-waimai-request','is-card-like');const _0x1b44e3=_0x4f967c(_0x45e24d,_0x3857ea['senderName']);let _0x3d4ecb='你';_0x45e24d[_0x2adf93(0x1423)]&&(_0x3d4ecb=_0x4f967c(_0x45e24d,_0x3857ea[_0x2adf93(0xa9c)])),_0x5d7677=_0x2adf93(0x851)+_0x1b44e3+'\x20已为'+_0x3d4ecb+_0x2adf93(0x421)+_0x3857ea[_0x2adf93(0xa89)]+_0x2adf93(0xcb2)+Number(_0x3857ea[_0x2adf93(0x257)])[_0x2adf93(0x5c3)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';}else{if(_0x3857ea['type']===_0x2adf93(0x512)){_0x74769d[_0x2adf93(0xff6)][_0x2adf93(0xe82)](_0x2adf93(0x7b4),_0x2adf93(0x139e));const _0x4af8c0=_0x28f30a[_0x2adf93(0x1506)][_0x2adf93(0x19a)]||'{{user}}',_0x382a99=_0x3857ea['isFullyClaimed'],_0x438876=_0x3857ea[_0x2adf93(0x13b7)]&&_0x3857ea[_0x2adf93(0x13b7)][_0x4af8c0];let _0x5e4908='',_0x200365='',_0x1e0482=_0x2adf93(0xb7a);_0x382a99&&(_0x5e4908='opened');if(_0x3857ea[_0x2adf93(0x110b)]==='direct'){const _0x551f32=_0x4f967c(_0x45e24d,_0x3857ea[_0x2adf93(0x61c)]);_0x1e0482=_0x2adf93(0xdfc)+_0x551f32;if(Object[_0x2adf93(0xf6b)](_0x3857ea[_0x2adf93(0x13b7)]||{})[_0x2adf93(0x9a1)]>0x0)_0x5e4908=_0x2adf93(0x994);}if(_0x438876){const _0x1a4811=_0x3857ea['claimedBy'][_0x4af8c0]||0x0;_0x200365=_0x2adf93(0xc0e)+_0x1a4811[_0x2adf93(0x5c3)](0x2)+'\x20元</div>';}else{if(_0x382a99)_0x200365=_0x2adf93(0x8ec);else{if(_0x3857ea['packetType']===_0x2adf93(0x43c)&&Object['keys'](_0x3857ea[_0x2adf93(0x13b7)]||{})['length']>0x0){const _0x4a5578=_0x4f967c(_0x45e24d,_0x3857ea['receiverName']);_0x200365=_0x2adf93(0x1211)+_0x4a5578+'\x20领取</div>';}}}_0x5d7677=_0x2adf93(0x43f)+_0x5e4908+_0x2adf93(0x1217)+(_0x3857ea[_0x2adf93(0x234)]||'恭喜发财，大吉大利！')+'</span></div><div\x20class=\x22rp-type\x22>'+_0x1e0482+_0x2adf93(0xd21)+_0x200365+'</div>';}else{if(_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0xc2c)){_0x74769d['classList'][_0x2adf93(0xe82)](_0x2adf93(0xd34),'is-card-like');const _0xb00783=_0x3857ea['question']||_0x3857ea[_0x2adf93(0x1047)]||_0x2adf93(0xb10);let _0x22ab6e=0x0;const _0x3cfb9c={};for(const _0xdb6449 in _0x3857ea['votes']){const _0x1fd49c=_0x3857ea['votes'][_0xdb6449]['length'];_0x3cfb9c[_0xdb6449]=_0x1fd49c,_0x22ab6e+=_0x1fd49c;}const _0x48a26d=_0x28f30a['qzoneSettings'][_0x2adf93(0x19a)]||_0x2adf93(0x450);let _0x3ef305=null;for(const _0x52f489 in _0x3857ea[_0x2adf93(0x7ba)]){if(_0x3857ea[_0x2adf93(0x7ba)][_0x52f489][_0x2adf93(0x138a)](_0x48a26d)){_0x3ef305=_0x52f489;break;}}let _0x3fcb12=_0x2adf93(0x14b6);_0x3857ea[_0x2adf93(0x793)][_0x2adf93(0xf99)](_0x43de0e=>{const _0x33dfae=_0x2adf93,_0x33780b=_0x3cfb9c[_0x43de0e]||0x0,_0x1cf0a0=_0x22ab6e>0x0?_0x33780b/_0x22ab6e*0x64:0x0,_0x55e8ed=_0x3ef305===_0x43de0e;_0x3fcb12+=_0x33dfae(0x96b)+(_0x55e8ed?_0x33dfae(0x3cf):'')+'\x22\x20data-option=\x22'+_0x43de0e+_0x33dfae(0x26c)+_0x1cf0a0+_0x33dfae(0xe0e)+_0x43de0e+_0x33dfae(0x794)+_0x33780b+_0x33dfae(0x1227);}),_0x3fcb12+='</div>';let _0x2dfdd1=_0x3857ea['isClosed']?_0x2adf93(0x8e5)+_0x22ab6e+_0x2adf93(0xee4):_0x2adf93(0x8e5)+_0x22ab6e+_0x2adf93(0x9ea);_0x5d7677=_0x2adf93(0x69e)+(_0x3857ea[_0x2adf93(0xd1b)]?_0x2adf93(0x7df):'')+_0x2adf93(0xf3d)+_0x3857ea[_0x2adf93(0x69a)]+'\x22><div\x20class=\x22poll-question\x22>'+_0xb00783+_0x2adf93(0xd21)+_0x3fcb12+_0x2dfdd1+_0x2adf93(0xd21);}else{if(_0x3857ea[_0x2adf93(0xb4b)]===_0x2adf93(0x43e)){_0x74769d['classList'][_0x2adf93(0xe82)](_0x2adf93(0xfc8),_0x2adf93(0x139e));let _0x14c54a;const _0x1e601e=_0x45e24d[_0x2adf93(0x362)][_0x2adf93(0xa28)]||'我';if(_0x45e24d['isGroup']){if(_0x3857ea[_0x2adf93(0x9e5)]&&_0x3857ea[_0x2adf93(0x9e5)][_0x2adf93(0x9a1)]>0x0){const _0x1f33a0=_0x3857ea[_0x2adf93(0x9e5)][_0x2adf93(0x11c6)](_0x5cb468=>_0x4f967c(_0x45e24d,_0x5cb468));_0x1f33a0[_0x2adf93(0x9a1)]===0x1?_0x14c54a=_0x2adf93(0x2a2)+_0x1f33a0[0x0]+_0x2adf93(0x1357):_0x14c54a=_0x2adf93(0x2a2)+_0x1f33a0[_0x2adf93(0x225)](0x0,0x2)[_0x2adf93(0xbad)]('、')+'等人的礼物';}else _0x14c54a=_0x2adf93(0x154d);}else{if(_0x3ee12a)_0x14c54a=_0x2adf93(0x2a2)+_0x45e24d[_0x2adf93(0xe36)]+_0x2adf93(0x1357);else{const _0x23e364=_0x45e24d[_0x2adf93(0x362)][_0x2adf93(0xa28)]||'你';_0x14c54a=_0x2adf93(0x2a2)+_0x23e364+'\x20的礼物';}}const _0x3eb125=_0x3857ea['items'][_0x2adf93(0x225)](0x0,0x3);let _0x40df95='';_0x3eb125[_0x2adf93(0xf99)](_0x2dc91b=>{const _0x290ca8=_0x2adf93;_0x40df95+='<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22'+_0x2dc91b[_0x290ca8(0x6c6)]+_0x290ca8(0x1107)+_0x2dc91b['name']+'</span><span\x20class=\x22gift-preview-quantity\x22>x'+_0x2dc91b[_0x290ca8(0x17a)]+'</span></div>';});let _0x8a937='';_0x3857ea[_0x2adf93(0x106e)]['length']>0x3&&(_0x8a937='\x20等'+_0x3857ea[_0x2adf93(0x106e)]['length']+'件商品'),_0x5d7677=_0x2adf93(0xcd8)+_0x14c54a+_0x2adf93(0x34a)+_0x40df95+_0x2adf93(0x227)+_0x3857ea[_0x2adf93(0x106e)]['length']+_0x2adf93(0xdd2)+_0x8a937+_0x2adf93(0x40a);}}}}}}}}}}}}}}else{const _0x131f39=String(_0x274e09);let _0x2125d5=await _0x437e6c(_0x131f39,_0x45e24d['id']);if(_0x2125d5!==_0x131f39)_0x5d7677=_0x2125d5,_0x74769d['classList']['add'](_0x2adf93(0x139e));else{if(Array[_0x2adf93(0x624)](_0x3857ea[_0x2adf93(0x1047)])&&_0x3857ea[_0x2adf93(0x1047)][0x0]?.['type']===_0x2adf93(0x1014)){const _0x46fdc8=_0x3857ea[_0x2adf93(0x1047)][0x0][_0x2adf93(0x1014)][_0x2adf93(0x6d1)];_0x5d7677=_0x2adf93(0x416)+_0x46fdc8+_0x2adf93(0x6ed);}else{if(_0x41abd3[_0x2adf93(0x1e0)](_0x2125d5))_0x74769d[_0x2adf93(0xff6)][_0x2adf93(0xe82)](_0x2adf93(0x123a),'is-card-like'),_0x5d7677=_0x2adf93(0x416)+_0x2125d5+_0x2adf93(0x9a3)+(_0x3857ea[_0x2adf93(0x1488)]||_0x2adf93(0xe5f))+_0x2adf93(0xaf5);else{let _0x5359de=_0x50f96e(_0x2125d5,_0x45e24d);_0x5d7677=_0x35bd8e(_0x5359de)[_0x2adf93(0x13ed)](/\n/g,_0x2adf93(0xfd7));}}}}}_0x74769d['innerHTML']=_0x2adf93(0x816)+_0x3c60f6+_0x2adf93(0xc99)+_0x32ec81+_0x2adf93(0x78f)+_0x5d7677+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x10de54[_0x2adf93(0x998)](_0x74769d),_0x10de54['appendChild'](_0x909d0a),_0x131542(_0x10de54,()=>_0x3986ce(_0x3857ea[_0x2adf93(0x69a)])),_0x10de54[_0x2adf93(0xf79)](_0x2adf93(0x1177),()=>{const _0x372c03=_0x2adf93;if(_0x36063f)_0x2f0498(_0x3857ea[_0x372c03(0x69a)]);});if(!_0x3ee12a){const _0x49f8b8=_0x10de54[_0x2adf93(0x765)](_0x2adf93(0x6a0));_0x49f8b8&&(_0x49f8b8[_0x2adf93(0x589)][_0x2adf93(0x119b)]='pointer',!_0x45e24d[_0x2adf93(0x1423)]?_0x49f8b8[_0x2adf93(0xf79)](_0x2adf93(0x1177),_0x16b3de=>{_0x16b3de['stopPropagation'](),_0x467dec(_0x45e24d['id']);}):_0x49f8b8[_0x2adf93(0xf79)](_0x2adf93(0xc7e),_0x2016a5=>{const _0x5969d1=_0x2adf93;_0x2016a5[_0x5969d1(0x106c)](),_0x367dc2(_0x45e24d['id'],_0x3857ea[_0x5969d1(0x1361)]);}));}return _0x10de54;}async function _0x44e071(_0xa1b1c,_0x16d4e5){const _0x258a44=_0x475790,_0x21bdf2=document['getElementById']('chat-messages'),_0x179b5e=await _0x43f190(_0xa1b1c,_0x16d4e5);if(!_0x179b5e)return;const _0x5e0e34=document[_0x258a44(0x2ec)](_0x258a44(0x54d));_0x5e0e34?_0x21bdf2[_0x258a44(0x89e)](_0x179b5e,_0x5e0e34['nextSibling']):_0x21bdf2[_0x258a44(0x41f)](_0x179b5e);}async function _0x4cc03e(_0x9e35bc,_0x2e9a32,_0x787e57=![]){const _0x1b6754=_0x475790,_0xfad238=document[_0x1b6754(0x2ec)](_0x1b6754(0x156b)),_0x2fbc23=document[_0x1b6754(0x2ec)](_0x1b6754(0x127f)),_0x37d33c=_0x2e9a32[_0x1b6754(0x12c3)][_0x1b6754(0xebc)](_0x5f180e=>!_0x5f180e[_0x1b6754(0x1162)])[_0x1b6754(0xdba)]();if(_0x37d33c&&_0x9e35bc[_0x1b6754(0x69a)]-_0x37d33c[_0x1b6754(0x69a)]>0x927c0){const _0x66a5a6=_0x5d2756(_0x9e35bc['timestamp']);_0xfad238[_0x1b6754(0x89e)](_0x66a5a6,_0x2fbc23);}const _0x560229=await _0x43f190(_0x9e35bc,_0x2e9a32);if(!_0x560229)return;_0x9e35bc[_0x1b6754(0x9be)]==='assistant'&&!_0x787e57&&_0x11973a(),!_0x787e57&&_0x560229[_0x1b6754(0xff6)]['add']('animate-in'),_0xfad238[_0x1b6754(0x89e)](_0x560229,_0x2fbc23),!_0x787e57&&(_0xfad238[_0x1b6754(0x12be)]=_0xfad238[_0x1b6754(0x1ce)],_0x5df89d++);}async function _0x473be6(_0x362288){const _0x1e1091=_0x475790;_0x28f30a[_0x1e1091(0x11b9)]=_0x362288;const _0x34b1a7=_0x28f30a[_0x1e1091(0x6ce)][_0x362288];if(!_0x34b1a7)return;_0x34b1a7[_0x1e1091(0xce1)]>0x0&&(_0x34b1a7[_0x1e1091(0xce1)]=0x0,await _0x5b9d83[_0x1e1091(0x6ce)][_0x1e1091(0x7c3)](_0x34b1a7));_0x3b419e(_0x34b1a7),_0xc55746(_0x362288),_0x17ec27('chat-interface-screen'),window['updateListenTogetherIconProxy'](_0x28f30a[_0x1e1091(0x11b9)]);const _0x37545d=_0x34b1a7[_0x1e1091(0x1423)]||![];_0x4b69c6(_0x37545d),document['getElementById']('show-announcement-board-btn')[_0x1e1091(0x589)]['display']=_0x37545d?'flex':_0x1e1091(0x5b1);const _0x26822f=document[_0x1e1091(0x2ec)](_0x1e1091(0x1396));_0x26822f&&(_0x26822f[_0x1e1091(0x589)][_0x1e1091(0x701)]=_0x37545d?'none':_0x1e1091(0xc67));const _0x274cff=document[_0x1e1091(0x2ec)](_0x1e1091(0x4dd)),_0x3bf087=document[_0x1e1091(0x2ec)](_0x1e1091(0xe3d)),_0x396413=document[_0x1e1091(0x2ec)]('gomoku-btn'),_0x8fc69b=document[_0x1e1091(0x2ec)]('werewolf-game-btn');_0x3bf087&&_0x396413&&_0x8fc69b&&_0x274cff&&(_0x3bf087[_0x1e1091(0x589)][_0x1e1091(0x701)]=_0x1e1091(0xc67),_0x396413[_0x1e1091(0x589)]['display']=_0x37545d?_0x1e1091(0x5b1):_0x1e1091(0xc67),_0x8fc69b[_0x1e1091(0x589)][_0x1e1091(0x701)]=_0x37545d?_0x1e1091(0xc67):_0x1e1091(0x5b1),_0x274cff[_0x1e1091(0x589)]['display']=_0x37545d?_0x1e1091(0x5b1):_0x1e1091(0xc67)),_0x4a1a61(),!_0x34b1a7[_0x1e1091(0x1423)]&&_0x34b1a7[_0x1e1091(0xaf4)]?.[_0x1e1091(0x2a3)]===_0x1e1091(0x890)&&(console[_0x1e1091(0x415)](_0x1e1091(0x11f2)+_0x34b1a7[_0x1e1091(0xe36)]+_0x1e1091(0x9f9)),_0x36bcc9()),document[_0x1e1091(0x2ec)](_0x1e1091(0x1489))[_0x1e1091(0x589)][_0x1e1091(0x701)]=_0x37545d?_0x1e1091(0xc67):_0x1e1091(0x5b1);}function _0x48a755(_0x59a871,_0x31a46d){const _0x2ce28b=_0x475790,_0x57f624=_0x31a46d?_0x2ce28b(0xe82):_0x2ce28b(0x1424),_0x2d0884=_0x1fdf43=>{const _0x5eaf09=_0x2ce28b;_0x1fdf43&&_0x1fdf43[_0x5eaf09(0xff6)][_0x57f624](_0x5eaf09(0x561));},_0x4cc2ff=document[_0x2ce28b(0x765)](_0x2ce28b(0xf44)+_0x59a871+'\x22]\x20.avatar');_0x2d0884(_0x4cc2ff);const _0x235176=document['querySelectorAll'](_0x2ce28b(0xc26)+_0x59a871+'\x22]');_0x235176[_0x2ce28b(0xf99)](_0x2d0884);const _0x1f1b47=document['querySelector']('.participant-avatar[data-participant-id=\x22'+_0x59a871+'\x22]');_0x2d0884(_0x1f1b47);}async function _0x3510c8(){const _0x1535c8=_0x475790;if(!_0x28f30a[_0x1535c8(0x11b9)])return;const _0x294387=_0x28f30a[_0x1535c8(0x11b9)],_0x14f066=_0x28f30a[_0x1535c8(0x6ce)][_0x294387];lastRawAiResponse='',lastResponseTimestamps=[];const _0x258d31=document[_0x1535c8(0x2ec)](_0x1535c8(0x1273));_0x258d31&&(_0x258d31[_0x1535c8(0x1373)]=!![],_0x258d31[_0x1535c8(0x15f)]=_0x1535c8(0x36b));_0x48a755(_0x294387,!![]);try{const {proxyUrl:_0xdcc4cb,apiKey:_0x2635a6,model:_0x2c91bc}=_0x28f30a['apiConfig'];if(!_0xdcc4cb||!_0x2635a6||!_0x2c91bc)throw new Error(_0x1535c8(0x626));const _0x23ed33=parseInt(_0x14f066['settings'][_0x1535c8(0xfcd)])||0xa,_0x5cc7a2=_0x14f066[_0x1535c8(0x12c3)]['slice'](-_0x23ed33);let _0x55ae75='';if(_0x14f066[_0x1535c8(0x362)][_0x1535c8(0x684)]&&_0x14f066[_0x1535c8(0x362)][_0x1535c8(0x684)][_0x1535c8(0x9a1)]>0x0){const _0xbd62f6=_0x14f066[_0x1535c8(0x362)][_0x1535c8(0x684)][_0x1535c8(0x11c6)](_0x19751a=>{const _0x258f08=_0x1535c8,_0x166048=_0x28f30a[_0x258f08(0x13b9)][_0x258f08(0x412)](_0x5ee6b1=>_0x5ee6b1['id']===_0x19751a);if(!_0x166048||!Array[_0x258f08(0x624)](_0x166048['content']))return'';const _0x38f47a=_0x166048[_0x258f08(0x1047)][_0x258f08(0xebc)](_0x36da7b=>_0x36da7b[_0x258f08(0x400)]!==![])['map'](_0x5915fb=>{const _0x3b32c1=_0x258f08;let _0x142fc3=_0x3b32c1(0xe5c)+(_0x5915fb[_0x3b32c1(0x70d)]||_0x3b32c1(0x342))+'\x0a';if(_0x5915fb['keys'][_0x3b32c1(0x9a1)]>0x0)_0x142fc3+=_0x3b32c1(0x933)+_0x5915fb[_0x3b32c1(0xf6b)][_0x3b32c1(0xbad)](',\x20')+'\x0a';return _0x142fc3+='**内容:**\x0a'+_0x5915fb['content'],_0x142fc3;})[_0x258f08(0xbad)]('');return _0x38f47a?_0x258f08(0xbd0)+_0x166048[_0x258f08(0xe36)]+'\x0a'+_0x38f47a:'';})[_0x1535c8(0xebc)](Boolean)[_0x1535c8(0xbad)]('');_0xbd62f6&&(_0x55ae75=_0x1535c8(0x14e0)+_0xbd62f6+_0x1535c8(0xcf2));}let _0x332b71=_0x1535c8(0x71d),_0x2d51d=![];_0x14f066[_0x1535c8(0x10f2)][_0x1535c8(0xf99)](_0x3f567b=>{const _0x133361=_0x1535c8,_0x47424f=_0x28f30a[_0x133361(0x6ce)][_0x3f567b['id']];_0x47424f&&_0x47424f[_0x133361(0x153f)]&&_0x47424f['longTermMemory'][_0x133361(0x9a1)]>0x0&&(_0x332b71+=_0x133361(0xa4e)+_0x3f567b[_0x133361(0x8a8)]+_0x133361(0xab7),_0x332b71+=_0x47424f[_0x133361(0x153f)]['map'](_0x197adc=>_0x133361(0x151a)+_0xf1c86d(_0x197adc[_0x133361(0x69a)])+')\x20'+_0x197adc[_0x133361(0x1047)])[_0x133361(0xbad)]('\x0a'),_0x2d51d=!![]);});!_0x2d51d&&(_0x332b71+=_0x1535c8(0x5ce));let _0x2f9389='';const _0x26a12a=_0x14f066[_0x1535c8(0x362)][_0x1535c8(0x13cb)]||0xa;if(_0x14f066['settings'][_0x1535c8(0x239)]&&_0x14f066[_0x1535c8(0x362)][_0x1535c8(0x239)][_0x1535c8(0x9a1)]>0x0){}const _0x58f3f4=_0x14f066[_0x1535c8(0x10f2)][_0x1535c8(0x11c6)](_0x3ac7c0=>_0x1535c8(0xa82)+_0x3ac7c0[_0x1535c8(0x8a8)]+_0x1535c8(0xb43)+_0x3ac7c0[_0x1535c8(0x66c)]+_0x1535c8(0xd30)+_0x3ac7c0[_0x1535c8(0xe32)])[_0x1535c8(0xbad)]('\x0a'),_0x3bbae4=_0x2dece1(_0x14f066),_0x549a0a=_0x1535c8(0xe56)+_0x14f066[_0x1535c8(0xe36)]+_0x1535c8(0x1179)+_0x14f066[_0x1535c8(0xe36)]+'\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a'+_0x332b71+'\x0a'+_0x55ae75+'\x0a'+_0x2f9389+_0x1535c8(0x1371)+_0x5cc7a2[_0x1535c8(0x11c6)](_0x1773e5=>_0x4f967c(_0x14f066,_0x1773e5[_0x1535c8(0x1361)])+':\x20'+_0x1773e5[_0x1535c8(0x1047)])[_0x1535c8(0xbad)]('\x0a')+_0x1535c8(0x20f)+_0x58f3f4+_0x1535c8(0x2d7)+_0x3bbae4+_0x1535c8(0x12f7),_0x8c6ed0=_0x5cc7a2['map'](_0x38d0cf=>({'role':_0x1535c8(0xcc9),'content':_0x4f967c(_0x14f066,_0x38d0cf[_0x1535c8(0x1361)])+':\x20'+_0x38d0cf[_0x1535c8(0x1047)]}));let _0x20d120=_0xdcc4cb[_0x1535c8(0x138a)](_0x1535c8(0x869)),_0x449799;if(_0x20d120){let _0x3877bd=_0x4fff3d(_0x2c91bc,_0x2635a6,_0x549a0a,_0x8c6ed0);_0x449799=await fetch(_0x3877bd[_0x1535c8(0x6d1)],_0x3877bd[_0x1535c8(0x1418)]);}else _0x449799=await fetch(_0xdcc4cb+_0x1535c8(0x1427),{'method':'POST','headers':{'Content-Type':_0x1535c8(0x1446),'Authorization':_0x1535c8(0xe83)+_0x2635a6},'body':JSON[_0x1535c8(0xe4d)]({'model':_0x2c91bc,'messages':[{'role':'system','content':_0x549a0a},..._0x8c6ed0],'temperature':_0x28f30a['globalSettings']['apiTemperature']||0.9})});if(!_0x449799['ok']){const _0x37f5fd=await _0x449799[_0x1535c8(0x12a2)]()['catch'](()=>({'error':{'message':_0x449799[_0x1535c8(0x1066)]}}));throw new Error('API\x20请求失败:\x20'+_0x449799[_0x1535c8(0x2a3)]+_0x1535c8(0xf8a)+(_0x37f5fd[_0x1535c8(0x1518)]?.['message']||_0x1535c8(0x16e)));}const _0xb5b0e8=await _0x449799[_0x1535c8(0x12a2)](),_0xe7edb8=getGeminiResponseText(_0xb5b0e8);lastRawAiResponse=_0xe7edb8;const _0x5b133c=_0x422882(_0xe7edb8);let _0x34fc6b=Date[_0x1535c8(0x487)]();for(const _0x5a87b5 of _0x5b133c){if(!_0x5a87b5||!_0x5a87b5[_0x1535c8(0xb4b)]||!_0x5a87b5['name'])continue;let _0x53ec14=null;const _0xc08d70=_0x34fc6b++;lastResponseTimestamps[_0x1535c8(0x367)](_0xc08d70);const _0x4b86c1={'role':_0x1535c8(0x6d9),'senderName':_0x5a87b5[_0x1535c8(0xe36)],'timestamp':_0xc08d70};switch(_0x5a87b5['type']){case _0x1535c8(0x10ca):_0x53ec14={..._0x4b86c1,'content':_0x5a87b5[_0x1535c8(0x1047)]};break;case _0x1535c8(0x14f3):if(_0x5a87b5[_0x1535c8(0x1488)]){const _0x29a717=_0x28f30a[_0x1535c8(0xf28)][_0x1535c8(0x412)](_0x55db0c=>_0x55db0c[_0x1535c8(0xe36)]===_0x5a87b5[_0x1535c8(0x1488)]);_0x29a717?_0x53ec14={..._0x4b86c1,'type':_0x1535c8(0x14f3),'content':_0x29a717['url'],'meaning':_0x29a717[_0x1535c8(0xe36)]}:(console[_0x1535c8(0x664)]('旁观模式AI尝试使用不存在的表情:\x20\x22'+_0x5a87b5[_0x1535c8(0x1488)]+'\x22'),_0x53ec14={..._0x4b86c1,'type':'text','content':_0x1535c8(0x4f3)+_0x5a87b5[_0x1535c8(0x1488)]+']'});}else console[_0x1535c8(0x664)](_0x1535c8(0x14f6),_0x5a87b5);break;case _0x1535c8(0x11c7):_0x53ec14={..._0x4b86c1,'type':_0x1535c8(0x11c7),'content':_0x5a87b5[_0x1535c8(0x9cc)],'image_prompt':_0x5a87b5[_0x1535c8(0xe8f)]};break;case _0x1535c8(0x8bc):_0x53ec14={..._0x4b86c1,'type':'voice_message','content':_0x5a87b5[_0x1535c8(0x1047)]};break;case _0x1535c8(0xec8):const _0x4abd06=_0x14f066[_0x1535c8(0x12c3)][_0x1535c8(0x412)](_0x58cf44=>_0x58cf44['timestamp']===_0x5a87b5['target_timestamp']);_0x4abd06?_0x53ec14={..._0x4b86c1,'content':_0x5a87b5[_0x1535c8(0xf96)],'quote':{'timestamp':_0x4abd06['timestamp'],'senderName':_0x4abd06[_0x1535c8(0x1361)],'content':String(_0x4abd06[_0x1535c8(0x1047)]||'')[_0x1535c8(0xa6b)](0x0,0x32)}}:_0x53ec14={..._0x4b86c1,'content':_0x5a87b5['reply_content']};break;default:console[_0x1535c8(0x664)](_0x1535c8(0x434),_0x5a87b5[_0x1535c8(0xb4b)]);continue;}_0x53ec14&&(_0x14f066[_0x1535c8(0x12c3)]['push'](_0x53ec14),_0x4cc03e(_0x53ec14,_0x14f066),await new Promise(_0x197eca=>setTimeout(_0x197eca,Math[_0x1535c8(0x1337)]()*0x4b0+0x320)));}await _0x5b9d83['chats']['put'](_0x14f066),_0x5db8a3();}catch(_0x429f74){console[_0x1535c8(0x1518)](_0x1535c8(0x21e),_0x429f74),await _0x34d596(_0x1535c8(0x221),_0x1535c8(0x3e4)+_0x429f74[_0x1535c8(0x13bc)]);}finally{_0x258d31&&(_0x258d31['disabled']=![],_0x258d31[_0x1535c8(0x15f)]=_0x1535c8(0xffa)),_0x48a755(_0x294387,![]);}}async function _0x36bcc9(){const _0x224d26=_0x475790;if(!_0x28f30a[_0x224d26(0x11b9)])return;const _0x4538fd=_0x28f30a[_0x224d26(0x11b9)],_0x42a172=_0x28f30a[_0x224d26(0x6ce)][_0x28f30a[_0x224d26(0x11b9)]],_0x2bbc75=document[_0x224d26(0x2ec)](_0x224d26(0x120a))[_0x224d26(0xff6)][_0x224d26(0xe9a)](_0x224d26(0xd43))&&_0x28f30a[_0x224d26(0x11b9)]===_0x4538fd;_0x48a755(_0x4538fd,!![]);const _0x54a5ed=document[_0x224d26(0x2ec)]('chat-header-title'),_0x4dd841=document[_0x224d26(0x2ec)]('typing-indicator'),_0x324684=document['querySelector'](_0x224d26(0xf44)+_0x4538fd+'\x22]'),_0x20ee10=_0x324684?_0x324684[_0x224d26(0x765)]('.avatar'):null;_0x20ee10&&_0x20ee10[_0x224d26(0xff6)]['add'](_0x224d26(0x561));_0x42a172[_0x224d26(0x1423)]?_0x4dd841&&(_0x4dd841[_0x224d26(0x15f)]=_0x224d26(0xfb3),_0x4dd841['style']['display']='block'):_0x54a5ed&&(_0x54a5ed[_0x224d26(0x589)][_0x224d26(0xb92)]=0x0,setTimeout(()=>{const _0x5a45fb=_0x224d26;_0x54a5ed[_0x5a45fb(0x15f)]=_0x5a45fb(0x786),_0x54a5ed[_0x5a45fb(0xff6)]['add'](_0x5a45fb(0x89a)),_0x54a5ed[_0x5a45fb(0x589)][_0x5a45fb(0xb92)]=0x1;},0xc8));let _0x203987=![];try{const {proxyUrl:_0x5d809d,apiKey:_0x477ae8,model:_0xa67f11}=_0x28f30a[_0x224d26(0x1537)];if(!_0x5d809d||!_0x477ae8||!_0xa67f11){alert('请先在API设置中配置反代地址、密钥并选择模型。');if(_0x42a172[_0x224d26(0x1423)]){if(_0x4dd841)_0x4dd841[_0x224d26(0x589)][_0x224d26(0x701)]=_0x224d26(0x5b1);}else _0x54a5ed&&_0x28f30a[_0x224d26(0x6ce)][_0x4538fd]&&(_0x54a5ed['textContent']=_0x28f30a[_0x224d26(0x6ce)][_0x4538fd][_0x224d26(0xe36)],_0x54a5ed[_0x224d26(0xff6)][_0x224d26(0x1424)](_0x224d26(0x89a)));return;}const _0x167aed=_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x225)](-0x1)[0x0],_0x392cee=_0x167aed&&_0x167aed[_0x224d26(0x9be)]===_0x224d26(0x10a7)&&_0x167aed[_0x224d26(0x1047)][_0x224d26(0x138a)](_0x224d26(0x1311));if(_0x392cee){console[_0x224d26(0x415)](_0x224d26(0xb76)+_0x42a172[_0x224d26(0xe36)]+_0x224d26(0x1449));let _0x427bed;_0x42a172[_0x224d26(0x1423)]?_0x427bed=_0x224d26(0xcdb)+_0x42a172[_0x224d26(0x10f2)][_0x224d26(0x11c6)](_0x537b23=>'-\x20'+_0x537b23[_0x224d26(0x8a8)]+_0x224d26(0xc17)+_0x537b23[_0x224d26(0x66c)]+'):\x20'+_0x537b23[_0x224d26(0xe32)])[_0x224d26(0xbad)]('\x0a')+_0x224d26(0xe7f):_0x427bed=_0x224d26(0x1257)+_0x42a172[_0x224d26(0x362)][_0x224d26(0x67c)]+_0x224d26(0x2fd);const _0x35e05a=[{'role':_0x224d26(0xcc9),'content':_0x427bed}];try{let _0x43ffc0=_0x4fff3d(_0xa67f11,_0x477ae8,_0x427bed,_0x35e05a),_0x2d5756=_0x5d809d===GEMINI_API_URL;const _0x3ce85c=_0x2d5756?await fetch(_0x43ffc0['url'],_0x43ffc0[_0x224d26(0x1418)]):await fetch(_0x5d809d+_0x224d26(0x1427),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x224d26(0xe83)+_0x477ae8},'body':JSON[_0x224d26(0xe4d)]({'model':_0xa67f11,'messages':_0x35e05a,'temperature':0.7})});if(!_0x3ce85c['ok'])throw new Error(_0x224d26(0x2cf)+(await _0x3ce85c[_0x224d26(0x12a2)]())[_0x224d26(0x1518)][_0x224d26(0x13bc)]);const _0x4d32e0=await _0x3ce85c[_0x224d26(0x12a2)](),_0x10ba0a=getGeminiResponseText(_0x4d32e0),_0x24f859=_0x422882(_0x10ba0a);let _0x3d2bac=![];for(const _0x17fc44 of _0x24f859){if(_0x17fc44[_0x224d26(0xb4b)]===_0x224d26(0x1116)){_0x20bfc1[_0x224d26(0x122a)]=![];if(_0x17fc44['decision']===_0x224d26(0xf7c))_0x5821d3();else{const _0x4c9be1={'role':_0x224d26(0x6d9),'content':_0x224d26(0xe31),'timestamp':Date[_0x224d26(0x487)]()};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x4c9be1),await _0x5b9d83[_0x224d26(0x6ce)]['put'](_0x42a172),_0x17ec27(_0x224d26(0x120a)),_0xc55746(_0x4538fd);}_0x3d2bac=!![];break;}if(_0x17fc44[_0x224d26(0xb4b)]===_0x224d26(0x10bb)){if(_0x17fc44[_0x224d26(0x531)]===_0x224d26(0xbad)){const _0x53a40b=_0x42a172[_0x224d26(0x10f2)][_0x224d26(0x412)](_0x4f64d9=>_0x4f64d9['originalName']===_0x17fc44[_0x224d26(0xe36)]);_0x53a40b&&!_0x20bfc1[_0x224d26(0x73e)]['some'](_0x3b3699=>_0x3b3699['id']===_0x53a40b['id'])&&_0x20bfc1[_0x224d26(0x73e)][_0x224d26(0x367)](_0x53a40b);}_0x3d2bac=!![];}}_0x3d2bac&&_0x20bfc1[_0x224d26(0x131e)]&&(_0x20bfc1[_0x224d26(0x122a)]=![],_0x20bfc1['participants'][_0x224d26(0x9a1)]>0x0?_0x5821d3():(_0x20bfc1={..._0x20bfc1,'isAwaitingResponse':![],'participants':[]},_0x17ec27(_0x224d26(0x120a)),alert(_0x224d26(0x2eb))));}catch(_0x532aac){console[_0x224d26(0x1518)](_0x224d26(0x168),_0x532aac);const _0x12bfd2=_0x42a172['isGroup']?_0x42a172[_0x224d26(0x10f2)][_0x224d26(0x11c6)](_0x27c1ee=>({'type':'group_call_response','name':_0x27c1ee[_0x224d26(0x66c)],'decision':_0x224d26(0x4e1)})):[{'type':_0x224d26(0x1116),'decision':_0x224d26(0x4c7)}];if(_0x42a172['isGroup'])_0x20bfc1['isAwaitingResponse']=![],_0x20bfc1[_0x224d26(0x73e)]=[],alert('无人接听群聊邀请。'),_0x17ec27(_0x224d26(0x120a));else{const _0x2e36f8={'role':'assistant','content':_0x224d26(0xe31),'timestamp':Date[_0x224d26(0x487)]()};_0x42a172[_0x224d26(0x12c3)]['push'](_0x2e36f8),await _0x5b9d83['chats']['put'](_0x42a172),_0x17ec27(_0x224d26(0x120a)),_0xc55746(_0x4538fd);}}finally{_0x48a755(_0x4538fd,![]);return;}}if(!_0x42a172[_0x224d26(0x1423)]&&_0x42a172[_0x224d26(0xaf4)]?.['status']==='pending_ai_approval'){console[_0x224d26(0x415)](_0x224d26(0x7e8)+_0x42a172[_0x224d26(0xe36)]+'\x22\x20触发带理由的好友申请决策流程...');const _0x24c4e1=_0x42a172[_0x224d26(0x12c3)][_0x224d26(0xebc)](_0x2ec174=>!_0x2ec174[_0x224d26(0x1162)])[_0x224d26(0x225)](-0xa,-0x5)[_0x224d26(0x11c6)](_0x57556a=>{const _0x52c70c=_0x224d26,_0x53f048=_0x57556a['role']===_0x52c70c(0xcc9)?'用户':_0x42a172[_0x52c70c(0xe36)];return _0x53f048+':\x20'+String(_0x57556a[_0x52c70c(0x1047)])[_0x52c70c(0xa6b)](0x0,0x32)+_0x52c70c(0x4e6);})[_0x224d26(0xbad)]('\x0a'),_0x5079bf=_0x224d26(0x10da)+_0x42a172[_0x224d26(0xe36)]+_0x224d26(0xa67)+_0x42a172[_0x224d26(0x362)][_0x224d26(0x67c)]+_0x224d26(0xb64)+_0x42a172[_0x224d26(0xaf4)][_0x224d26(0x2d1)]+'”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x24c4e1||_0x224d26(0xeea))+_0x224d26(0x11a6);try{const _0x2c55e7=[{'role':_0x224d26(0x10a7),'content':_0x5079bf},{'role':_0x224d26(0xcc9),'content':'请根据以上设定，立即做出你的决定。'}];let _0x2ebc37=_0x5d809d===GEMINI_API_URL,_0x20b056=_0x4fff3d(_0xa67f11,_0x477ae8,_0x5079bf,[{'role':_0x224d26(0xcc9),'content':_0x224d26(0xa03)}]);const _0x10b900=_0x2ebc37?await fetch(_0x20b056[_0x224d26(0x6d1)],_0x20b056[_0x224d26(0x1418)]):await fetch(_0x5d809d+_0x224d26(0x1427),{'method':_0x224d26(0x655),'headers':{'Content-Type':_0x224d26(0x1446),'Authorization':_0x224d26(0xe83)+_0x477ae8},'body':JSON['stringify']({'model':_0xa67f11,'messages':_0x2c55e7,'temperature':_0x28f30a[_0x224d26(0x1062)]['apiTemperature']||0.8})});if(!_0x10b900['ok'])throw new Error('API失败:\x20'+(await _0x10b900[_0x224d26(0x12a2)]())['error']['message']);const _0x76fea7=await _0x10b900[_0x224d26(0x12a2)](),_0x103be0=getGeminiResponseText(_0x76fea7)['replace'](/^```json\s*/,'')['replace'](/```$/,'')[_0x224d26(0x97e)](),_0x4e4bef=JSON[_0x224d26(0xd91)](_0x103be0);if(_0x4e4bef[_0x224d26(0x531)]==='accept'){_0x42a172[_0x224d26(0xaf4)][_0x224d26(0x2a3)]='friend';const _0x48e1d8={'role':'assistant','senderName':_0x42a172[_0x224d26(0xe36)],'content':_0x4e4bef['reason'],'timestamp':Date[_0x224d26(0x487)]()};_0x42a172['history'][_0x224d26(0x367)](_0x48e1d8);}else{_0x42a172[_0x224d26(0xaf4)][_0x224d26(0x2a3)]='blocked_by_ai';const _0x1ed3b8={'role':'assistant','senderName':_0x42a172['name'],'content':_0x4e4bef[_0x224d26(0x6a4)],'timestamp':Date[_0x224d26(0x487)]()};_0x42a172['history']['push'](_0x1ed3b8);}_0x42a172[_0x224d26(0xaf4)][_0x224d26(0x2d1)]='',await _0x5b9d83[_0x224d26(0x6ce)][_0x224d26(0x7c3)](_0x42a172),_0xc55746(_0x4538fd),_0x5db8a3();}catch(_0x19a7d){_0x42a172[_0x224d26(0xaf4)]['status']=_0x224d26(0x56f),await _0x5b9d83['chats'][_0x224d26(0x7c3)](_0x42a172),await _0x34d596(_0x224d26(0x1502),'AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20'+_0x19a7d['message']),_0xc55746(_0x4538fd);}return;}let _0x3759a8='';const _0x5c70d0=new Date(),_0x3a7af5=_0x42a172['settings'][_0x224d26(0xfbe)]||'Asia/Shanghai',_0x223e4a=_0x5c70d0[_0x224d26(0xc4c)](_0x224d26(0x1054),{'timeZone':_0x3a7af5,'dateStyle':_0x224d26(0x1124),'timeStyle':_0x224d26(0xd90)}),_0x1776d7=new Date(_0x5c70d0['toLocaleString'](_0x224d26(0x7bb),{'timeZone':_0x3a7af5})),_0x4266d6=_0x55bb06(_0x1776d7);let _0x5bf563,_0x654822;const _0x3cc257=_0x42a172[_0x224d26(0x12c3)][_0x224d26(0xebc)](_0x5ae4f3=>_0x5ae4f3[_0x224d26(0x1162)])[_0x224d26(0xdba)]();if(_0x3cc257&&_0x3cc257[_0x224d26(0x1047)]['includes'](_0x224d26(0x501))){const _0x2917da=await _0x5b9d83[_0x224d26(0x924)]['where'](_0x224d26(0xdd0))[_0x224d26(0x129a)](_0x4538fd)[_0x224d26(0x107d)]();if(_0x2917da&&_0x2917da['transcript']){console[_0x224d26(0x415)](_0x224d26(0x6da));const _0x3b450e=_0x2917da[_0x224d26(0xdcb)][_0x224d26(0x11c6)](_0xa9e012=>{const _0x4aa725=_0x224d26,_0x15fe04=_0xa9e012[_0x4aa725(0x9be)]===_0x4aa725(0xcc9)?_0x42a172[_0x4aa725(0x362)]['myNickname']||'我':_0xa9e012[_0x4aa725(0x1361)];return _0x15fe04+':\x20'+_0xa9e012[_0x4aa725(0x1047)];})[_0x224d26(0xbad)]('\x0a');_0x3759a8=_0x224d26(0xab4)+_0x3b450e+_0x224d26(0x1d8);}}const _0x367cd7=_0x204b6c(_0x484920[_0x4538fd]);let _0x466e43='';if(_0x42a172['settings']['linkedWorldBookIds']&&_0x42a172[_0x224d26(0x362)][_0x224d26(0x684)][_0x224d26(0x9a1)]>0x0){const _0x50eae7=_0x42a172[_0x224d26(0x362)][_0x224d26(0x684)][_0x224d26(0x11c6)](_0x237d98=>{const _0x3ab1d7=_0x224d26,_0x928f5b=_0x28f30a[_0x3ab1d7(0x13b9)][_0x3ab1d7(0x412)](_0x553225=>_0x553225['id']===_0x237d98);if(!_0x928f5b||!Array[_0x3ab1d7(0x624)](_0x928f5b[_0x3ab1d7(0x1047)]))return'';const _0x59f68e=_0x928f5b[_0x3ab1d7(0x1047)][_0x3ab1d7(0xebc)](_0x43e921=>_0x43e921[_0x3ab1d7(0x400)]!==![])['map'](_0x45e7e9=>{const _0x4220c2=_0x3ab1d7;let _0x123fc7=_0x4220c2(0xe5c)+(_0x45e7e9[_0x4220c2(0x70d)]||'无备注')+'\x0a';return _0x45e7e9[_0x4220c2(0xf6b)][_0x4220c2(0x9a1)]>0x0&&(_0x123fc7+='**关键词:**\x20'+_0x45e7e9[_0x4220c2(0xf6b)]['join'](',\x20')+'\x0a'),_0x123fc7+='**内容:**\x0a'+_0x45e7e9[_0x4220c2(0x1047)],_0x123fc7;})[_0x3ab1d7(0xbad)]('');return _0x59f68e?_0x3ab1d7(0xbd0)+_0x928f5b[_0x3ab1d7(0xe36)]+'\x0a'+_0x59f68e:'';})[_0x224d26(0xebc)](Boolean)[_0x224d26(0xbad)]('');_0x50eae7&&(_0x466e43='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x50eae7+_0x224d26(0xcf2));}let _0x12b404='';if(_0x79cac3[_0x224d26(0xffc)]&&_0x79cac3[_0x224d26(0x11b9)]===_0x4538fd){const _0x5bc50f=_0x79cac3['currentIndex']>-0x1?_0x79cac3[_0x224d26(0x5fd)][_0x79cac3[_0x224d26(0xf35)]]:null,_0x118d92=_0x79cac3[_0x224d26(0x5fd)]['map'](_0x44764b=>'\x22'+_0x44764b[_0x224d26(0xe36)]+'\x22')[_0x224d26(0xbad)](',\x20');let _0x398b1f='';if(_0x5bc50f&&_0x79cac3[_0x224d26(0x9c4)]&&_0x79cac3[_0x224d26(0x9c4)][_0x224d26(0x9a1)]>0x0&&_0x79cac3[_0x224d26(0xdf5)]>-0x1){const _0x34b149=_0x79cac3[_0x224d26(0x9c4)][_0x79cac3[_0x224d26(0xdf5)]],_0xd55e35=_0x79cac3[_0x224d26(0x9c4)][_0x224d26(0x225)](_0x79cac3[_0x224d26(0xdf5)]+0x1,_0x79cac3['currentLyricIndex']+0x3);_0x398b1f+=_0x224d26(0xf42)+_0x34b149[_0x224d26(0x10ca)]+'\x22\x0a',_0xd55e35['length']>0x0&&(_0x398b1f+=_0x224d26(0x76a)+_0xd55e35[_0x224d26(0x11c6)](_0x22146f=>'\x22'+_0x22146f[_0x224d26(0x10ca)]+'\x22')[_0x224d26(0xbad)](_0x224d26(0x875))+'\x0a');}_0x12b404=_0x224d26(0x35c)+(_0x5bc50f?'《'+_0x5bc50f['name']+_0x224d26(0x509)+_0x5bc50f[_0x224d26(0x139f)]:'无')+_0x224d26(0xcb0)+_0x118d92+_0x224d26(0x738)+_0x398b1f+_0x224d26(0x53e);}const _0x3bf998=parseInt(_0x42a172[_0x224d26(0x362)]['maxMemory'])||0xa,_0x463c51=_0x42a172['history']['slice'](-_0x3bf998);let _0x5987df='';const _0x34e0f3=_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x9b4)](_0x1d388d=>_0x1d388d['role']==='assistant'),_0x268ba0=_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x225)](_0x34e0f3+0x1),_0x14e932=_0x268ba0[_0x224d26(0x412)](_0x5683ee=>_0x5683ee['type']===_0x224d26(0x886));if(_0x14e932){const _0x7bc341=_0x14e932[_0x224d26(0x13a6)],_0x374732=_0x7bc341[_0x224d26(0xcc0)][_0x224d26(0x11c6)](_0x5a7acb=>{const _0x1aab88=_0x224d26,_0x54b05b=_0x5a7acb[_0x1aab88(0x1361)]||(_0x5a7acb['role']===_0x1aab88(0xcc9)?_0x42a172[_0x1aab88(0x362)][_0x1aab88(0xa28)]||'我':_0x1aab88(0xeca));let _0x20b70e='';if(_0x5a7acb[_0x1aab88(0xb4b)]==='voice_message')_0x20b70e=_0x1aab88(0xd96)+_0x5a7acb['content']+']';else{if(_0x5a7acb[_0x1aab88(0xb4b)]===_0x1aab88(0x11c7))_0x20b70e='[图片:\x20'+_0x5a7acb[_0x1aab88(0x9cc)]+']';else{if(_0x5a7acb[_0x1aab88(0xb4b)]==='naiimag')_0x20b70e='[NovelAI图片:\x20'+_0x5a7acb[_0x1aab88(0x9fd)]+']';else _0x20b70e=String(_0x5a7acb[_0x1aab88(0x1047)]);}}return _0x54b05b+':\x20'+_0x20b70e;})[_0x224d26(0xbad)]('\x0a');_0x5987df=_0x224d26(0xee1)+_0x7bc341[_0x224d26(0xede)]+_0x224d26(0xabf)+_0x374732+_0x224d26(0xfc5);}let _0x301a8e='';const _0x34c033=_0x42a172[_0x224d26(0x362)][_0x224d26(0x13cb)]||0xa;if(_0x42a172['settings']['linkedMemoryChatIds']&&_0x42a172[_0x224d26(0x362)]['linkedMemoryChatIds'][_0x224d26(0x9a1)]>0x0){const _0x441bf9=_0x42a172[_0x224d26(0x362)][_0x224d26(0x239)][_0x224d26(0xebc)](_0x8e8220=>_0x8e8220!==_0x4538fd);if(_0x441bf9[_0x224d26(0x9a1)]>0x0){const _0x169fbf=_0x441bf9[_0x224d26(0x11c6)](_0x454ed6=>{const _0x311d97=_0x224d26,_0x2bc11c=_0x28f30a[_0x311d97(0x6ce)][_0x454ed6];if(!_0x2bc11c)return null;const _0x23f843=_0x2bc11c[_0x311d97(0x12c3)][_0x311d97(0x225)](-0x1);return{'chat':_0x2bc11c,'latestTimestamp':_0x23f843?_0x23f843[_0x311d97(0x69a)]:0x0};})[_0x224d26(0xebc)](Boolean);_0x169fbf[_0x224d26(0x126b)]((_0x32407e,_0x2c6e84)=>_0x2c6e84[_0x224d26(0x1183)]-_0x32407e[_0x224d26(0x1183)]),_0x301a8e+=_0x224d26(0x661);for(const _0x5e07aa of _0x169fbf){const _0x34ddbc=_0x5e07aa['chat'],_0x20d973=_0x34ddbc[_0x224d26(0x1423)]?_0x224d26(0xb5c):_0x224d26(0xe1d),_0x26b652=_0x5e07aa[_0x224d26(0x1183)]>0x0?'\x20(最后互动于\x20'+_0xf1c86d(_0x5e07aa[_0x224d26(0x1183)])+')':'';_0x301a8e+=_0x224d26(0xba7)+_0x20d973+'“'+_0x34ddbc[_0x224d26(0xe36)]+_0x224d26(0x1549)+_0x26b652+_0x224d26(0x128b);const _0x4f9c5b=_0x34ddbc[_0x224d26(0x12c3)]['slice'](-_0x34c033),_0x43bae5=_0x4f9c5b[_0x224d26(0xebc)](_0x19967e=>!String(_0x19967e[_0x224d26(0x1047)])[_0x224d26(0x138a)](_0x224d26(0xe04)));_0x43bae5[_0x224d26(0x9a1)]>0x0?_0x43bae5['forEach'](_0x38443d=>{const _0x4182ff=_0x224d26,_0x42aa99=_0x38443d['role']==='user'?_0x34ddbc[_0x4182ff(0x362)][_0x4182ff(0xa28)]||'我':_0x38443d['senderName']||_0x34ddbc[_0x4182ff(0xe36)];let _0x43a95d=String(_0x38443d[_0x4182ff(0x1047)]);if(_0x38443d[_0x4182ff(0xb4b)]===_0x4182ff(0x11c7)||_0x38443d[_0x4182ff(0xb4b)]===_0x4182ff(0x7f7))_0x43a95d=_0x4182ff(0xcca)+_0x38443d[_0x4182ff(0x1047)]+']';else _0x38443d[_0x4182ff(0xb4b)]===_0x4182ff(0x8bc)&&(_0x43a95d=_0x4182ff(0x4ba)+_0x38443d['content']+']');const _0x5f1ba8=_0xf1c86d(_0x38443d[_0x4182ff(0x69a)]);_0x301a8e+='('+_0x5f1ba8+')\x20'+_0x42aa99+':\x20'+_0x43a95d+'\x0a';}):_0x301a8e+=_0x224d26(0x3f6);}}}console['log'](_0x224d26(0x208),_0x301a8e);if(_0x42a172['isGroup']){let _0x18e576='';const _0x1ebb28=_0x42a172[_0x224d26(0x362)]['linkedMemoryCount']||0xa;if(_0x42a172[_0x224d26(0x362)][_0x224d26(0x239)]&&_0x42a172['settings'][_0x224d26(0x239)][_0x224d26(0x9a1)]>0x0){const _0x51991d=_0x42a172['settings'][_0x224d26(0x239)][_0x224d26(0xebc)](_0x3b215a=>_0x3b215a!==_0x4538fd);if(_0x51991d['length']>0x0){const _0x3acb0a=_0x51991d[_0x224d26(0x11c6)](_0x587a36=>{const _0x3ceed2=_0x224d26,_0x5f544a=_0x28f30a[_0x3ceed2(0x6ce)][_0x587a36];if(!_0x5f544a)return null;const _0x3343f5=_0x5f544a[_0x3ceed2(0x12c3)][_0x3ceed2(0x225)](-0x1);return{'chat':_0x5f544a,'latestTimestamp':_0x3343f5?_0x3343f5[_0x3ceed2(0x69a)]:0x0};})['filter'](Boolean);_0x3acb0a[_0x224d26(0x126b)]((_0x512d27,_0x5ea177)=>_0x5ea177[_0x224d26(0x1183)]-_0x512d27[_0x224d26(0x1183)]),_0x18e576+='\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a';for(const _0x486c52 of _0x3acb0a){const _0x4125e1=_0x486c52['chat'],_0x418b29=_0x4125e1[_0x224d26(0x1423)]?'[群聊]':_0x224d26(0xe1d),_0x40f929=_0x486c52[_0x224d26(0x1183)]>0x0?'\x20(最后互动于\x20'+_0xf1c86d(_0x486c52['latestTimestamp'])+')':'';_0x18e576+=_0x224d26(0xba7)+_0x418b29+'“'+_0x4125e1['name']+'”的参考记忆'+_0x40f929+_0x224d26(0x128b);const _0x510f45=_0x4125e1[_0x224d26(0x12c3)]['slice'](-_0x1ebb28),_0x395181=_0x510f45[_0x224d26(0xebc)](_0x5835cf=>!String(_0x5835cf[_0x224d26(0x1047)])[_0x224d26(0x138a)]('已被用户删除'));_0x395181[_0x224d26(0x9a1)]>0x0?_0x395181['forEach'](_0x319952=>{const _0x1bae3d=_0x224d26,_0x4d50e9=_0x319952[_0x1bae3d(0x9be)]===_0x1bae3d(0xcc9)?_0x4125e1['settings']['myNickname']||'我':_0x319952['senderName']||_0x4125e1[_0x1bae3d(0xe36)];let _0x16d75=String(_0x319952[_0x1bae3d(0x1047)]);if(_0x319952[_0x1bae3d(0xb4b)]===_0x1bae3d(0x11c7)||_0x319952[_0x1bae3d(0xb4b)]===_0x1bae3d(0x7f7))_0x16d75=_0x1bae3d(0xcca)+_0x319952[_0x1bae3d(0x1047)]+']';else _0x319952[_0x1bae3d(0xb4b)]===_0x1bae3d(0x8bc)&&(_0x16d75=_0x1bae3d(0x4ba)+_0x319952['content']+']');_0x18e576+=_0x4d50e9+':\x20'+_0x16d75+'\x0a';}):_0x18e576+=_0x224d26(0x3f6);}}}let _0x471309='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0x9c74f8=![];_0x42a172[_0x224d26(0x10f2)][_0x224d26(0xf99)](_0xd97e51=>{const _0x8c86c=_0x224d26,_0x366583=_0x28f30a[_0x8c86c(0x6ce)][_0xd97e51['id']];_0x366583&&_0x366583[_0x8c86c(0x153f)]&&_0x366583[_0x8c86c(0x153f)]['length']>0x0&&(_0x471309+='\x0a##\x20---\x20关于“'+_0xd97e51[_0x8c86c(0x8a8)]+_0x8c86c(0xab7),_0x471309+=_0x366583[_0x8c86c(0x153f)][_0x8c86c(0x11c6)](_0x15ea8d=>'-\x20(记录于\x20'+_0xf1c86d(_0x15ea8d[_0x8c86c(0x69a)])+')\x20'+_0x15ea8d[_0x8c86c(0x1047)])['join']('\x0a'),_0x9c74f8=!![]);});!_0x9c74f8&&(_0x471309+='-\x20(暂无)');let _0x1334e8='',_0x530c2f=![];if(_0x42a172['settings']['enableTimePerception']){const _0x39869c=_0x463c51['slice'](-0x1)[0x0];if(_0x39869c){const _0x4c8272=_0x68368b(_0x39869c[_0x224d26(0x69a)]);_0x1334e8=_0x224d26(0xbb5)+_0x4c8272+'。';const _0x352116=(Date[_0x224d26(0x487)]()-_0x39869c[_0x224d26(0x69a)])/(0x3e8*0x3c*0x3c);if(_0x352116>0x3){_0x530c2f=!![];const _0x69ec42=Math[_0x224d26(0x5f8)](_0x352116/0x18);_0x1334e8+='\x20群里已经安静了'+(_0x69ec42>0x0?_0x69ec42+'天':Math[_0x224d26(0x5f8)](_0x352116)+'小时')+'。';}}else _0x1334e8=_0x224d26(0xe72);}const _0x2e68c8=await _0x5b9d83[_0x224d26(0x120e)]['toArray']();let _0x2d6af4='';_0x2e68c8[_0x224d26(0x9a1)]>0x0&&(_0x2d6af4=_0x224d26(0x1344),_0x2e68c8['forEach'](_0x2da9e5=>{const _0x40f17a=_0x224d26;_0x2d6af4+=_0x40f17a(0x2e7)+_0x2da9e5['id']+')\x20商品:\x20'+_0x2da9e5[_0x40f17a(0xe36)]+',\x20价格:\x20¥'+_0x2da9e5[_0x40f17a(0x1309)][_0x40f17a(0x5c3)](0x2)+'\x0a';}));let _0x5de21b=_0x42a172[_0x224d26(0x10f2)][_0x224d26(0x11c6)](_0x1a9338=>{const _0x1a74c9=_0x224d26,_0x9db588=_0x28f30a[_0x1a74c9(0x6ce)][_0x1a9338['id']];let _0x457a41=_0x1a74c9(0xbb1);if(_0x9db588&&_0x9db588[_0x1a74c9(0x1542)]){const _0x58599b=Object[_0x1a74c9(0x74e)](_0x28f30a[_0x1a74c9(0x6ce)])[_0x1a74c9(0xebc)](_0x3e9465=>!_0x3e9465[_0x1a74c9(0x1423)]&&_0x3e9465['id']!==_0x1a9338['id']&&_0x3e9465['groupId']===_0x9db588[_0x1a74c9(0x1542)]);_0x58599b[_0x1a74c9(0x9a1)]>0x0&&(_0x457a41='TA的好友包括:\x20'+_0x58599b[_0x1a74c9(0x11c6)](_0x89754e=>_0x89754e[_0x1a74c9(0xe36)])[_0x1a74c9(0xbad)]('、\x20'));}return _0x1a74c9(0xa82)+_0x1a9338[_0x1a74c9(0x8a8)]+_0x1a74c9(0xb43)+_0x1a9338[_0x1a74c9(0x66c)]+_0x1a74c9(0xd30)+_0x1a9338[_0x1a74c9(0xe32)]+'\x20[社交背景:\x20'+_0x457a41+']';})['join']('\x0a');const _0x3509ad=_0x42a172[_0x224d26(0x362)][_0x224d26(0xa28)]||'我',_0x416e0e=_0x28f30a[_0x224d26(0x1506)][_0x224d26(0x19a)]||_0x224d26(0x450);let _0x49d2dd='';const _0x7d287a=(_0x42a172[_0x224d26(0x380)]||[])[_0x224d26(0xebc)](_0x5ce604=>_0x5ce604['isPinned']);_0x7d287a['length']>0x0&&(_0x49d2dd+=_0x224d26(0xb8b),_0x7d287a['forEach'](_0x3c36c5=>{const _0x446d7b=_0x224d26,_0x8e1812=_0x42a172[_0x446d7b(0x12c3)][_0x446d7b(0x412)](_0x579a0e=>_0x579a0e[_0x446d7b(0x69a)]===_0x3c36c5['messageTimestamp']);if(_0x8e1812){let _0x3692d8=String(_0x8e1812['content']||'');_0x8e1812[_0x446d7b(0xb4b)]===_0x446d7b(0x11c7)&&(_0x3692d8=_0x446d7b(0xa01)+_0x3692d8+']'),_0x49d2dd+='-\x20公告内容:\x20\x22'+_0x3692d8+_0x446d7b(0x1517)+_0x3c36c5[_0x446d7b(0x656)]+_0x446d7b(0x136c);}}),_0x49d2dd+=_0x224d26(0x780));const _0x2bb3b7=_0x42a172[_0x224d26(0x10f2)][_0x224d26(0x11c6)](_0x8c5b3=>_0x8c5b3[_0x224d26(0x66c)]),_0x2e79a4='#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：['+_0x2bb3b7['join']('、\x20')+']';let _0x24ab3e=_0x224d26(0x26b);_0x42a172[_0x224d26(0x362)][_0x224d26(0x1235)]&&_0x42a172[_0x224d26(0x362)][_0x224d26(0x1235)][_0x224d26(0x9a1)]>0x0?_0x24ab3e+=_0x42a172[_0x224d26(0x362)][_0x224d26(0x1235)]['map'](_0x2a7512=>'-\x20'+_0x2a7512['name'])['join']('\x0a'):_0x24ab3e+='-\x20(头像库是空的，无法更换头像)';const _0x368490=_0xf9a226(_0x4538fd),_0x49c944=_0x5bdf0b(_0x42a172,0x3,_0x224d26(0xe03)),_0x39dbf8=_0x5bdf0b(_0x42a172,0x6,_0x224d26(0xe03)),_0x2a00fc=_0x5bdf0b(_0x42a172,0x9,_0x224d26(0xe03)),_0x1c0fb2=_0x5bdf0b(_0x42a172,0x1,_0x224d26(0xb0b)),_0x5653b0=_0x5bdf0b(_0x42a172,0x3,_0x224d26(0xb0b)),_0x194d4b=_0x5bdf0b(_0x42a172,0x7,_0x224d26(0xb0b));let _0xc13669='';if(_0x49c944||_0x39dbf8||_0x2a00fc||_0x1c0fb2||_0x5653b0||_0x194d4b){_0xc13669+=_0x224d26(0xb40);if(_0x49c944)_0xc13669+=_0x49c944;if(_0x39dbf8)_0xc13669+=_0x39dbf8;if(_0x2a00fc)_0xc13669+=_0x2a00fc;if(_0x49c944||_0x39dbf8||_0x2a00fc)_0xc13669+='\x0a';if(_0x1c0fb2)_0xc13669+=_0x1c0fb2;if(_0x5653b0)_0xc13669+=_0x5653b0;if(_0x194d4b)_0xc13669+=_0x194d4b;}const _0x600e6e=_0x2dece1(_0x42a172);_0x5bf563=_0x224d26(0x61e)+_0x3509ad+_0x224d26(0xc77)+_0x416e0e+_0x224d26(0x149c)+_0x3509ad+_0x224d26(0x1168)+_0x42a172[_0x224d26(0xe36)]+_0x224d26(0x3ee)+(_0x42a172[_0x224d26(0x362)][_0x224d26(0x425)]?_0x224d26(0xecd)+_0x223e4a+_0x224d26(0xc73)+(_0x530c2f?_0x224d26(0x131c)+_0x1334e8+'\x20你应该让角色们主动开启新话题来打破沉默。':''):'')+_0x224d26(0x422)+(_0x368490?'你们正在一起读书。'+_0x368490:'你们没有在读书。')+_0x224d26(0x350)+_0x3509ad+_0x224d26(0x717)+_0x416e0e+_0x224d26(0x445)+_0x416e0e+_0x224d26(0x1cb)+_0x42a172[_0x224d26(0xe36)]+'\x0a'+(_0x42a172[_0x224d26(0x362)][_0x224d26(0x425)]?_0x224d26(0x1101)+_0x1334e8:'')+'\x0a\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a'+_0x5de21b+_0x224d26(0xe41)+_0x3509ad+'**:\x20'+_0x42a172[_0x224d26(0x362)]['myPersona']+_0x224d26(0x135d)+_0x466e43+_0x224d26(0x7d1)+_0x471309+'\x0a'+(_0x42a172[_0x224d26(0x153f)]&&_0x42a172['longTermMemory'][_0x224d26(0x9a1)]>0x0?_0x42a172[_0x224d26(0x153f)][_0x224d26(0x11c6)](_0x1b3efd=>'-\x20'+_0x1b3efd[_0x224d26(0x1047)])['join']('\x0a'):_0x224d26(0x5ce))+'\x0a'+_0xc13669+'\x0a'+_0x18e576+'\x0a'+_0x12b404+'\x0a'+_0x5987df+'\x0a'+_0x24ab3e+_0x224d26(0x2d7)+_0x600e6e+'\x0a'+_0x2e79a4+'\x0a'+_0x3759a8+_0x224d26(0x874)+(localStorage[_0x224d26(0x11c3)](_0x224d26(0x89f))===_0x224d26(0x33e)?'-\x20\x20\x20**NovelAI图片分享**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22name\x22:\x20\x22你的角色名\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20【禁止暴露这是novelai生成的图片!】\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20使用场景：当你想要基于当前对话情景、你的性格或上下文分享一张图片时使用。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。':'')+_0x224d26(0x12ca)+_0x416e0e+_0x224d26(0x376),_0x654822=_0x463c51[_0x224d26(0x11c6)](_0x440b79=>{const _0x3d037e=_0x224d26,_0x3ff835=_0x440b79[_0x3d037e(0x9be)]===_0x3d037e(0xcc9)?_0x3509ad:_0x440b79['senderName'];let _0x57e1a3=''+_0x3ff835;if(_0x440b79['quote']){const _0x1662d1=String(_0x440b79[_0x3d037e(0x447)][_0x3d037e(0x1047)]||'')['substring'](0x0,0x32);_0x57e1a3+=_0x3d037e(0x1209)+_0x440b79['quote'][_0x3d037e(0x1361)]+_0x3d037e(0x8d7)+_0x1662d1+'...\x22)';}_0x57e1a3+=':\x20';let _0x3e55a5;if(_0x440b79['type']===_0x3d037e(0x7f7))_0x3e55a5='['+_0x3ff835+_0x3d037e(0x4a2)+_0x440b79[_0x3d037e(0x1047)]+'\x27]';else{if(_0x440b79['type']===_0x3d037e(0x11c7))_0x3e55a5='['+_0x3ff835+'\x20发送了一张图片，图片内容描述为：\x27'+_0x440b79[_0x3d037e(0x1047)]+'\x27]';else{if(_0x440b79[_0x3d037e(0xb4b)]===_0x3d037e(0xd92))_0x3e55a5='['+_0x3ff835+_0x3d037e(0x623)+_0x440b79['prompt']+']';else{if(_0x440b79[_0x3d037e(0xb4b)]==='voice_message')_0x3e55a5='['+_0x3ff835+'\x20发送了一条语音，内容是：\x27'+_0x440b79[_0x3d037e(0x1047)]+'\x27]';else{if(_0x440b79[_0x3d037e(0xb4b)]==='transfer')_0x3e55a5='['+_0x440b79[_0x3d037e(0x1361)]+'\x20向\x20'+_0x440b79[_0x3d037e(0x61c)]+_0x3d037e(0x53f)+_0x440b79['amount']+_0x3d037e(0x19b)+_0x440b79[_0x3d037e(0x1333)]+']';else{if(_0x440b79[_0x3d037e(0xb4b)]===_0x3d037e(0xae7))_0x3e55a5='['+_0x3ff835+_0x3d037e(0x1350)+_0x440b79[_0x3d037e(0x1047)]+'\x27]';else{if(_0x440b79[_0x3d037e(0xb4b)]===_0x3d037e(0x11d5)){const _0x27b69e=_0x440b79['repostComment']?_0x3d037e(0x1540)+_0x440b79[_0x3d037e(0x169)]+'”':'';let _0x3337ad=_0x3d037e(0xe63);const _0x4129ca=_0x440b79['originalPost'][_0x3d037e(0xe87)];if(_0x4129ca===_0x3d037e(0xcc9))_0x3337ad=_0x28f30a[_0x3d037e(0x1506)][_0x3d037e(0x19a)];else _0x28f30a['chats'][_0x4129ca]&&(_0x3337ad=_0x28f30a[_0x3d037e(0x6ce)][_0x4129ca][_0x3d037e(0xe36)]);let _0x5105a3;const _0x334e9c=_0x440b79[_0x3d037e(0x767)];if(_0x334e9c[_0x3d037e(0xb4b)]===_0x3d037e(0xaa4))_0x5105a3='[文字图]\x20'+(_0x334e9c[_0x3d037e(0x1202)]||'')+_0x3d037e(0xd3d)+(_0x334e9c[_0x3d037e(0xf05)]||'')[_0x3d037e(0xa6b)](0x0,0x28)+'...”)';else _0x334e9c[_0x3d037e(0xb4b)]===_0x3d037e(0x126c)?_0x5105a3=_0x3d037e(0x1409)+(_0x334e9c['publicText']||'')+_0x3d037e(0xd3d)+(_0x334e9c[_0x3d037e(0x7ca)]||'')['substring'](0x0,0x28)+_0x3d037e(0xde5):_0x5105a3='“'+(_0x334e9c[_0x3d037e(0x1047)]||'')[_0x3d037e(0xa6b)](0x0,0x28)+_0x3d037e(0xa48);_0x3e55a5='['+_0x3ff835+'\x20转发了\x20@'+_0x3337ad+_0x3d037e(0x880)+_0x27b69e+'【原动态内容:\x20'+_0x5105a3+'】]';}else{if(_0x440b79[_0x3d037e(0xb4b)]==='waimai_request')_0x440b79[_0x3d037e(0x2a3)]===_0x3d037e(0x12d6)?_0x3e55a5=_0x3d037e(0x10e2)+_0x440b79[_0x3d037e(0x1012)]+_0x3d037e(0x152f)+_0x3ff835+_0x3d037e(0x5bb)+_0x440b79[_0x3d037e(0x257)]+'\x20元。此订单已完成。]':_0x3e55a5='['+_0x3ff835+'\x20发起了外卖代付请求，商品是“'+_0x440b79[_0x3d037e(0xa89)]+'”，金额是\x20'+_0x440b79[_0x3d037e(0x257)]+_0x3d037e(0x13e7)+_0x440b79[_0x3d037e(0x69a)]+']';else{if(_0x440b79[_0x3d037e(0xb4b)]===_0x3d037e(0x512)){const _0x299f62=_0x440b79[_0x3d037e(0x1361)]===_0x3509ad?_0x3d037e(0xf32)+_0x3509ad+')':_0x440b79[_0x3d037e(0x1361)];let _0x218e58;_0x440b79['packetType']==='direct'?_0x218e58=_0x3d037e(0x10e2)+_0x299f62+'\x20发送了一个【专属红包】(时间戳:\x20'+_0x440b79[_0x3d037e(0x69a)]+_0x3d037e(0xa68)+_0x440b79[_0x3d037e(0x61c)]+_0x3d037e(0x85e)+_0x440b79[_0x3d037e(0x61c)]+_0x3d037e(0x67a):_0x218e58=_0x3d037e(0x10e2)+_0x299f62+_0x3d037e(0x69c)+_0x440b79['timestamp']+_0x3d037e(0x871)+_0x440b79[_0x3d037e(0x234)]+_0x3d037e(0xb72),_0x3e55a5=_0x218e58;}else{if(_0x440b79[_0x3d037e(0xb4b)]===_0x3d037e(0x43e)){const _0x34c887=_0x440b79[_0x3d037e(0x9be)]===_0x3d037e(0xcc9)?_0x3509ad:_0x4f967c(_0x42a172,_0x440b79[_0x3d037e(0x1361)]),_0x506068=_0x440b79[_0x3d037e(0x106e)]['map'](_0x5bcb8f=>_0x5bcb8f[_0x3d037e(0xe36)]+'\x20x'+_0x5bcb8f[_0x3d037e(0x17a)])['join']('、\x20');let _0x568c29='';if(_0x440b79['recipients']&&_0x440b79[_0x3d037e(0x9e5)][_0x3d037e(0x9a1)]>0x0){const _0x2a35bc=_0x440b79[_0x3d037e(0x9e5)][_0x3d037e(0x11c6)](_0x5d4aea=>_0x4f967c(_0x42a172,_0x5d4aea))[_0x3d037e(0xbad)]('、\x20');_0x568c29=_0x3d037e(0x73f)+_0x2a35bc;}else _0x568c29=_0x3d037e(0x13c9);return _0x3e55a5=_0x3d037e(0x10e2)+_0x34c887+'\x20'+_0x568c29+_0x3d037e(0x1405)+_0x506068+']',{'role':'user','content':_0x3e55a5};}else{if(_0x440b79[_0x3d037e(0xb4b)]===_0x3d037e(0xc2c)){const _0x22e4ce=Object[_0x3d037e(0x74e)](_0x440b79['votes']||{})[_0x3d037e(0x155d)]()['join'](',\x20')||_0x3d037e(0x11cf);_0x3e55a5=_0x3d037e(0x10e2)+_0x440b79[_0x3d037e(0x1361)]+'\x20发起了一个投票\x20(时间戳:\x20'+_0x440b79[_0x3d037e(0x69a)]+_0x3d037e(0xe78)+_0x440b79[_0x3d037e(0x7f0)]+_0x3d037e(0xf8e)+_0x440b79[_0x3d037e(0x793)]['join'](',\x20')+_0x3d037e(0x579)+_0x22e4ce+_0x3d037e(0x6db);}else{if(_0x440b79['meaning'])_0x3e55a5=_0x3ff835+':\x20[发送了一个表情，意思是:\x20\x27'+_0x440b79['meaning']+'\x27]';else{if(Array['isArray'](_0x440b79[_0x3d037e(0x1047)]))return{'role':'user','content':[..._0x440b79[_0x3d037e(0x1047)],{'type':_0x3d037e(0x10ca),'text':_0x57e1a3}]};else _0x3e55a5=''+_0x57e1a3+_0x440b79['content'];}}}}}}}}}}}}return{'role':'user','content':_0x3e55a5};})[_0x224d26(0xebc)](Boolean);}else{const _0xdc9c30=_0x42a172[_0x224d26(0x362)][_0x224d26(0x1448)],_0x24fdd6=_0x23eb2e(_0x42a172);let _0x4ed21f='';_0x42a172['settings']['injectLatestThought']&&_0x42a172['heartfeltVoice']&&!_0xdc9c30&&(_0x4ed21f=_0x224d26(0x1416)+_0x42a172[_0x224d26(0x28a)]+'\x0a-\x20散记:\x20'+_0x42a172[_0x224d26(0xe97)]+'\x0a');let _0x471845='';const _0xe7f47c=_0x42a172[_0x224d26(0x362)][_0x224d26(0x13cb)]||0xa;if(_0x42a172[_0x224d26(0x362)][_0x224d26(0x239)]&&_0x42a172[_0x224d26(0x362)][_0x224d26(0x239)][_0x224d26(0x9a1)]>0x0){const _0x490ff3=_0x42a172['settings'][_0x224d26(0x239)][_0x224d26(0xebc)](_0x10b02c=>_0x10b02c!==_0x4538fd);if(_0x490ff3['length']>0x0){const _0x535d77=_0x490ff3[_0x224d26(0x11c6)](_0x5850d0=>{const _0x56d43a=_0x224d26,_0x1ad5a8=_0x28f30a[_0x56d43a(0x6ce)][_0x5850d0];if(!_0x1ad5a8)return null;const _0x509093=_0x1ad5a8[_0x56d43a(0x12c3)][_0x56d43a(0x225)](-0x1)[0x0];return{'chat':_0x1ad5a8,'latestTimestamp':_0x509093?_0x509093['timestamp']:0x0};})[_0x224d26(0xebc)](Boolean);_0x535d77['sort']((_0x59a378,_0x8a530b)=>_0x8a530b[_0x224d26(0x1183)]-_0x59a378['latestTimestamp']),_0x471845+=_0x224d26(0x661);for(const _0x4b4418 of _0x535d77){const _0x44b021=_0x4b4418[_0x224d26(0x73b)],_0x1ec3ba=_0x44b021[_0x224d26(0x1423)]?_0x224d26(0xb5c):_0x224d26(0xe1d),_0x5f57d4=_0x4b4418['latestTimestamp']>0x0?'\x20(最后互动于\x20'+_0xf1c86d(_0x4b4418[_0x224d26(0x1183)])+')':'';_0x471845+='\x0a##\x20---\x20来自'+_0x1ec3ba+'“'+_0x44b021[_0x224d26(0xe36)]+_0x224d26(0x1549)+_0x5f57d4+_0x224d26(0x128b);const _0x50929d=_0x44b021['history'][_0x224d26(0x225)](-_0xe7f47c),_0x1dc11=_0x50929d[_0x224d26(0xebc)](_0x58c8af=>!String(_0x58c8af[_0x224d26(0x1047)])['includes']('已被用户删除'));_0x1dc11[_0x224d26(0x9a1)]>0x0?_0x1dc11[_0x224d26(0xf99)](_0x3925e6=>{const _0x365fc4=_0x224d26,_0x5ee21e=_0x3925e6[_0x365fc4(0x9be)]==='user'?_0x44b021['settings']['myNickname']||'我':_0x3925e6[_0x365fc4(0x1361)]||_0x44b021[_0x365fc4(0xe36)];let _0x30fd46=String(_0x3925e6['content']);if(_0x3925e6[_0x365fc4(0xb4b)]===_0x365fc4(0x11c7)||_0x3925e6[_0x365fc4(0xb4b)]==='user_photo')_0x30fd46=_0x365fc4(0xcca)+_0x3925e6[_0x365fc4(0x1047)]+']';else _0x3925e6['type']===_0x365fc4(0x8bc)&&(_0x30fd46=_0x365fc4(0x4ba)+_0x3925e6[_0x365fc4(0x1047)]+']');const _0x3f450e=_0xf1c86d(_0x3925e6[_0x365fc4(0x69a)]);_0x471845+='('+_0x3f450e+')\x20'+_0x5ee21e+':\x20'+_0x30fd46+'\x0a';}):_0x471845+='(暂无有效聊天记录)\x0a';}}}const _0x220c06=await _0x5b9d83[_0x224d26(0x120e)][_0x224d26(0x14b5)]();let _0x2f138a='';_0x220c06[_0x224d26(0x9a1)]>0x0&&(_0x2f138a=_0x224d26(0x8b5),_0x220c06['forEach'](_0x2cd00e=>{const _0x3aed6a=_0x224d26;_0x2f138a+='-\x20(ID:\x20'+_0x2cd00e['id']+')\x20商品:\x20'+_0x2cd00e['name']+_0x3aed6a(0xcc3)+_0x2cd00e[_0x3aed6a(0x1309)]['toFixed'](0x2)+'\x0a';}));if(_0xdc9c30){const _0x15fd73=localStorage['getItem'](_0x224d26(0x89f))===_0x224d26(0x33e),_0x5a3673=_0x42a172[_0x224d26(0x362)]['offlineMinLength']||0x64,_0x238d2e=_0x42a172['settings'][_0x224d26(0xd67)]||0x12c,_0x187895=_0x42a172[_0x224d26(0x362)][_0x224d26(0xa28)]||'我';let _0x263ffb='';if(_0x42a172[_0x224d26(0x362)][_0x224d26(0x1248)]){const _0x529b45=_0x28f30a['presets'][_0x224d26(0x412)](_0x420caf=>_0x420caf['id']===_0x42a172[_0x224d26(0x362)][_0x224d26(0x1248)]);if(_0x529b45&&Array[_0x224d26(0x624)](_0x529b45[_0x224d26(0x1047)])){const _0x46e5b0=_0x529b45['content'][_0x224d26(0xebc)](_0x566648=>_0x566648['enabled']!==![])['map'](_0x272a26=>'-\x20'+_0x272a26[_0x224d26(0x1047)])['join']('\x0a');_0x46e5b0&&(_0x263ffb='\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a'+_0x46e5b0+_0x224d26(0x1d8));}}let _0xd50a85;_0x15fd73?_0xd50a85='\x0a#\x20【格式铁律\x20(最高优先级：NovelAI\x20开启模式)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【必须包含且只能包含两个】元素，【严格按照】以下顺序:\x0a\x20\x20\x20\x201.\x20\x20第一个元素：一个\x20`offline_text`\x20对象，包含场景和对话。\x0a\x20\x20\x20\x202.\x20\x20第二个元素：一个\x20`naiimag`\x20对象，用于生成该场景的图片。\x0a2.\x20\x20**【【【绝对禁止】】】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】只返回一个\x20`offline_text`\x20元素。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】只返回一个\x20`naiimag`\x20元素。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回任何其他组合。你【必须】同时返回文字和图片。\x0a3.\x20\x20**【输出示例\x20(必须遵守)】**:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22offline_text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22「这是对话内容」...\x20(这里是动作和环境描写)...\x22\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22naiimag\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22prompt\x22:\x20\x221girl,\x20solo,\x20detailed\x20anime\x20art\x20style,\x20(smiling:1.2),\x20sitting\x20in\x20a\x20cafe,\x20looking\x20at\x20viewer,\x20masterpiece,\x20best\x20quality,\x20...\x20(根据上面的文字内容生成详细的英文prompt)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a4.\x20\x20**【内容风格\x20(offline_text)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':_0xd50a85=_0x224d26(0xf6f),_0x5bf563=_0x224d26(0xde1)+_0x42a172[_0x224d26(0x66c)]+_0x224d26(0xed7)+_0x263ffb+_0x224d26(0x152b)+_0x42a172[_0x224d26(0x362)]['aiPersona']+'\x0a\x0a#\x20对话者的角色设定\x0a'+_0x42a172[_0x224d26(0x362)][_0x224d26(0x1528)]+_0x224d26(0xffb)+(_0x42a172[_0x224d26(0x362)][_0x224d26(0x425)]?_0x224d26(0x1250)+_0x223e4a+'\x20('+_0x4266d6+')':'')+_0x224d26(0xe95)+_0x466e43+'\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a'+(_0x42a172[_0x224d26(0x153f)]&&_0x42a172['longTermMemory'][_0x224d26(0x9a1)]>0x0?_0x42a172['longTermMemory'][_0x224d26(0x11c6)](_0x5e0e8b=>'-\x20'+_0x5e0e8b['content'])[_0x224d26(0xbad)]('\x0a'):_0x224d26(0x5ce))+'\x0a\x0a'+_0x471845+_0x224d26(0x5bc)+_0x463c51[_0x224d26(0x11c6)](_0x40223d=>{const _0x42049d=_0x224d26;let _0x38c315=(_0x40223d['role']===_0x42049d(0xcc9)?_0x187895:_0x42a172[_0x42049d(0xe36)])+':\x20';return _0x40223d[_0x42049d(0xb4b)]==='offline_text'?_0x38c315+='「'+(_0x40223d[_0x42049d(0x6c4)]||'')+'」\x20'+(_0x40223d['description']||''):_0x38c315+=String(_0x40223d[_0x42049d(0x1047)]),_0x38c315;})[_0x224d26(0xbad)]('\x0a')+_0x224d26(0x744)+_0xd50a85+_0x224d26(0x1b8)+_0x5a3673+'到'+_0x238d2e+_0x224d26(0x41a),_0x654822=_0x463c51['map'](_0x18db80=>{const _0x285e18=_0x224d26;if(_0x18db80['isHidden'])return null;if(_0x18db80[_0x285e18(0xb4b)]==='offline_text'){const _0x369744=_0x18db80[_0x285e18(0x9be)]==='user'?_0x42a172[_0x285e18(0x362)][_0x285e18(0xa28)]||'我':_0x42a172['name'];let _0x50de27='';if(_0x18db80[_0x285e18(0x1047)])_0x50de27=_0x18db80['content'];else{const _0x22c268=_0x18db80[_0x285e18(0x6c4)]?'「'+_0x18db80[_0x285e18(0x6c4)]+'」':'',_0x139ffb=_0x18db80[_0x285e18(0x9cc)]?'('+_0x18db80[_0x285e18(0x9cc)]+')':'';_0x50de27=(_0x22c268+'\x20'+_0x139ffb)[_0x285e18(0x97e)]();}return{'role':_0x18db80[_0x285e18(0x9be)],'content':_0x369744+':\x20'+_0x50de27};}if(_0x18db80['role']===_0x285e18(0xcc9)){const _0x47fd25=_0x187895+':\x20';let _0x52c8e4='';if(Array[_0x285e18(0x624)](_0x18db80[_0x285e18(0x1047)])&&_0x18db80['content'][0x0]?.[_0x285e18(0xb4b)]===_0x285e18(0x1014))return{'role':_0x285e18(0xcc9),'content':[{'type':'text','text':_0x47fd25},..._0x18db80[_0x285e18(0x1047)]]};if(_0x18db80[_0x285e18(0x447)]){const _0x103a4a=String(_0x18db80[_0x285e18(0x447)][_0x285e18(0x1047)]||'')[_0x285e18(0xa6b)](0x0,0x32);_0x52c8e4+=_0x285e18(0x868)+_0x18db80[_0x285e18(0x447)]['senderName']+_0x285e18(0x8d7)+_0x103a4a+_0x285e18(0x832)+_0x18db80[_0x285e18(0x1047)];}else _0x52c8e4+=_0x18db80['content'];if(_0x18db80['type']===_0x285e18(0x7f7))return{'role':_0x285e18(0xcc9),'content':_0x47fd25+_0x285e18(0x16a)+_0x18db80[_0x285e18(0x1047)]+'\x27]'};if(_0x18db80[_0x285e18(0xb4b)]===_0x285e18(0x8bc))return{'role':_0x285e18(0xcc9),'content':_0x47fd25+_0x285e18(0x532)+_0x18db80[_0x285e18(0x1047)]+'\x27]'};if(_0x18db80[_0x285e18(0xb4b)]===_0x285e18(0x277))return{'role':_0x285e18(0xcc9),'content':_0x47fd25+_0x285e18(0x5f6)+_0x18db80[_0x285e18(0x69a)]+_0x285e18(0x477)+_0x18db80[_0x285e18(0x257)]+_0x285e18(0x19b)+_0x18db80[_0x285e18(0x1333)]+_0x285e18(0x145e)};if(_0x18db80[_0x285e18(0xb4b)]==='waimai_request')return{'role':_0x285e18(0xcc9),'content':_0x47fd25+_0x285e18(0x5f6)+_0x18db80['timestamp']+_0x285e18(0x1495)+_0x18db80[_0x285e18(0xa89)]+_0x285e18(0x560)+_0x18db80[_0x285e18(0x257)]+_0x285e18(0xfdd)};else{if(_0x18db80[_0x285e18(0xb4b)]==='gift'){const _0x277d85=_0x18db80[_0x285e18(0x106e)][_0x285e18(0x11c6)](_0x3a3d21=>_0x3a3d21[_0x285e18(0xe36)]+'\x20x'+_0x3a3d21[_0x285e18(0x17a)])['join']('、\x20');let _0x20a692=_0x42a172['isGroup']?_0x285e18(0x73f)+_0x18db80[_0x285e18(0x9e5)][_0x285e18(0x11c6)](_0x1e81b5=>_0x4f967c(_0x42a172,_0x1e81b5))[_0x285e18(0xbad)]('、\x20'):_0x285e18(0x73f)+_0x42a172[_0x285e18(0xe36)];return{'role':'user','content':_0x47fd25+'[系统提示：你\x20'+_0x20a692+'，礼物是：'+_0x277d85+']'};}}if(_0x18db80[_0x285e18(0x1488)])return{'role':_0x285e18(0xcc9),'content':_0x47fd25+_0x285e18(0xe61)+_0x18db80[_0x285e18(0x1488)]+'\x27]'};return{'role':_0x18db80[_0x285e18(0x9be)],'content':_0x47fd25+_0x52c8e4};}else{if(_0x18db80[_0x285e18(0x9be)]===_0x285e18(0x6d9)){let _0x10b172={'type':_0x18db80[_0x285e18(0xb4b)]||_0x285e18(0x10ca)};if(_0x18db80['type']===_0x285e18(0x14f3))_0x10b172[_0x285e18(0x6d1)]=_0x18db80[_0x285e18(0x1047)],_0x10b172['meaning']=_0x18db80[_0x285e18(0x1488)];else{if(_0x18db80['type']===_0x285e18(0x277))_0x10b172[_0x285e18(0x257)]=_0x18db80[_0x285e18(0x257)],_0x10b172[_0x285e18(0x1333)]=_0x18db80[_0x285e18(0x1333)];else _0x18db80['type']==='waimai_request'?(_0x10b172[_0x285e18(0xa89)]=_0x18db80['productInfo'],_0x10b172['amount']=_0x18db80[_0x285e18(0x257)]):_0x18db80[_0x285e18(0x447)]?_0x10b172['quote_reply']={'target_sender':_0x18db80[_0x285e18(0x447)][_0x285e18(0x1361)],'target_content':_0x18db80[_0x285e18(0x447)][_0x285e18(0x1047)],'reply_content':_0x18db80[_0x285e18(0x1047)]}:_0x10b172[_0x285e18(0x1047)]=_0x18db80[_0x285e18(0x1047)];}const _0xae9018=JSON[_0x285e18(0xe4d)]([_0x10b172]);return{'role':_0x285e18(0x6d9),'content':'(Timestamp:\x20'+_0x18db80['timestamp']+')\x20'+_0xae9018};}}return null;})[_0x224d26(0xebc)](Boolean);}else{let _0x527a4d='';_0x42a172['nameHistory']&&_0x42a172['nameHistory'][_0x224d26(0x9a1)]>0x0&&(_0x527a4d=_0x224d26(0x7d0)+_0x42a172[_0x224d26(0x316)][_0x224d26(0xbad)](',\x20')+_0x224d26(0xd54));let _0x3d72db='';const _0x11a8cd=_0x28f30a[_0x224d26(0x1506)][_0x224d26(0x19a)]||'用户';_0x3d72db+=_0x224d26(0x1340)+_0x11a8cd+_0x224d26(0x95c);const _0xa1a85f=Object['values'](_0x28f30a[_0x224d26(0x6ce)]),_0x372634=_0xa1a85f[_0x224d26(0xebc)](_0xfdc2=>_0xfdc2['isGroup']&&_0xfdc2[_0x224d26(0x10f2)]['some'](_0x346135=>_0x346135['id']===_0x42a172['id']));_0x372634[_0x224d26(0x9a1)]>0x0&&(_0x3d72db+='-\x20用户在你们共同所在的群聊中的昵称如下：\x0a',_0x372634['forEach'](_0x5e5352=>{const _0x163270=_0x224d26,_0x50f136=_0x5e5352[_0x163270(0x362)][_0x163270(0xa28)]||_0x11a8cd;_0x3d72db+=_0x163270(0x4ce)+_0x5e5352[_0x163270(0xe36)]+_0x163270(0x1429)+_0x50f136+_0x163270(0x11dc);}));_0x3d72db+=_0x224d26(0xedc);let _0x3417cf='';const _0x10e3fe=_0xa1a85f[_0x224d26(0xebc)](_0x2bd0ef=>!_0x2bd0ef[_0x224d26(0x1423)]&&_0x2bd0ef['id']!==_0x42a172['id']&&_0x2bd0ef[_0x224d26(0x1542)]===_0x42a172[_0x224d26(0x1542)]&&_0x42a172[_0x224d26(0x1542)]!==null);_0x10e3fe['length']>0x0&&(_0x3417cf+=_0x224d26(0x14ca),_0x10e3fe[_0x224d26(0xf99)](_0x1613f4=>{const _0x1b5b59=_0x224d26;_0x3417cf+=_0x1b5b59(0x1049)+_0x1613f4[_0x1b5b59(0xe36)]+'**\x20(本名:\x20'+_0x1613f4[_0x1b5b59(0x66c)]+')\x0a';}));const _0x191442=await _0x5b9d83[_0x224d26(0xc7a)]['orderBy']('timestamp')[_0x224d26(0x6c9)]()[_0x224d26(0xd44)](0xa)[_0x224d26(0x14b5)](),_0x1dbc66=_0x5b423c(_0x191442,_0x42a172);let _0x4faca0='';if(_0x1dbc66[_0x224d26(0x9a1)]>0x0){_0x4faca0=_0x224d26(0x6fe);const _0x5020b2=_0x42a172[_0x224d26(0x66c)];for(const _0x5b18c2 of _0x1dbc66){let _0x4bf376;if(_0x5b18c2[_0x224d26(0xe87)]===_0x224d26(0xcc9))_0x4bf376=_0x28f30a['qzoneSettings'][_0x224d26(0x19a)];else{if(String(_0x5b18c2[_0x224d26(0xe87)])[_0x224d26(0x741)](_0x224d26(0x3c8)))_0x4bf376=_0x5b18c2[_0x224d26(0xb6a)]||_0x224d26(0xd75);else{const _0x5147b8=_0x28f30a[_0x224d26(0x6ce)][_0x5b18c2[_0x224d26(0xe87)]];_0x4bf376=_0x5147b8?_0x5147b8['name']:_0x224d26(0x8b4);}}if(_0x5b18c2[_0x224d26(0xe87)]===_0x4538fd)_0x4bf376+=_0x224d26(0x1022);let _0x37164a;if(_0x5b18c2[_0x224d26(0xb4b)]===_0x224d26(0x11d5)){const _0x4e4ada=_0x5b18c2[_0x224d26(0x169)]?_0x224d26(0x9b5)+_0x5b18c2[_0x224d26(0x169)]+'\x22':'';let _0x376e25=_0x224d26(0xe63);const _0x24726c=_0x5b18c2[_0x224d26(0x767)][_0x224d26(0xe87)];if(_0x24726c==='user')_0x376e25=_0x28f30a['qzoneSettings'][_0x224d26(0x19a)];else _0x28f30a[_0x224d26(0x6ce)][_0x24726c]&&(_0x376e25=_0x28f30a[_0x224d26(0x6ce)][_0x24726c][_0x224d26(0xe36)]);let _0x24c9af;const _0x2a8418=_0x5b18c2[_0x224d26(0x767)];if(_0x2a8418[_0x224d26(0xb4b)]===_0x224d26(0xaa4))_0x24c9af='[文字图]\x20'+(_0x2a8418[_0x224d26(0x1202)]||'')+_0x224d26(0xda4)+(_0x2a8418['hiddenContent']||'')[_0x224d26(0xa6b)](0x0,0x28)+_0x224d26(0x1079);else _0x2a8418[_0x224d26(0xb4b)]===_0x224d26(0x126c)?_0x24c9af='[图片]\x20'+(_0x2a8418[_0x224d26(0x1202)]||'')+_0x224d26(0xda4)+(_0x2a8418[_0x224d26(0x7ca)]||'')[_0x224d26(0xa6b)](0x0,0x28)+_0x224d26(0x1079):_0x24c9af='\x22'+(_0x2a8418[_0x224d26(0x1047)]||'')[_0x224d26(0xa6b)](0x0,0x28)+_0x224d26(0x130e);_0x37164a=_0x224d26(0xcbd)+_0x376e25+_0x224d26(0x880)+_0x4e4ada+_0x224d26(0x569)+_0x24c9af+'】';}else{if(_0x5b18c2['type']==='text_image')_0x37164a=('[一张图片，其隐藏文字为：\x22'+_0x5b18c2[_0x224d26(0xf05)]+'\x22]\x20'+(_0x5b18c2[_0x224d26(0x1202)]||''))[_0x224d26(0xa6b)](0x0,0x32)+'...';else{if(_0x5b18c2[_0x224d26(0xb4b)]===_0x224d26(0x126c))_0x37164a=(_0x224d26(0xb01)+_0x5b18c2[_0x224d26(0x7ca)]+'\x22]\x20'+(_0x5b18c2['publicText']||''))[_0x224d26(0xa6b)](0x0,0x32)+_0x224d26(0x4e6);else{if(_0x5b18c2['type']==='naiimag'&&_0x5b18c2[_0x224d26(0x9fd)]){const _0x3d622d=Array[_0x224d26(0x624)](_0x5b18c2[_0x224d26(0x9fd)])?_0x5b18c2['prompt']:[_0x5b18c2[_0x224d26(0x9fd)]];_0x37164a=(_0x5b18c2[_0x224d26(0x1202)]||'')+(_0x224d26(0x879)+_0x3d622d['length']+_0x224d26(0x12a7)+_0x3d622d[_0x224d26(0xbad)](',\x20')+']');}else _0x37164a=String(_0x5b18c2['publicText']||_0x5b18c2['content']||'一条动态')[_0x224d26(0xa6b)](0x0,0x32)+_0x224d26(0x4e6);}}}_0x4faca0+=_0x224d26(0x2e7)+_0x5b18c2['id']+_0x224d26(0x1255)+_0x4bf376+_0x224d26(0x660)+_0x37164a+'\x22\x0a';if(_0x5b18c2[_0x224d26(0x8a4)]&&_0x5b18c2[_0x224d26(0x8a4)]['length']>0x0)for(const _0x424bea of _0x5b18c2[_0x224d26(0x8a4)]){if(typeof _0x424bea===_0x224d26(0x10c0)&&_0x424bea[_0x224d26(0x498)]){const _0x58c28f=_0x2fa4e1(_0x424bea[_0x224d26(0x498)]);let _0x4cffc5=_0x424bea[_0x224d26(0x1488)]?_0x224d26(0x646)+_0x424bea['meaning']+'\x27]':_0x424bea['text'];_0x424bea[_0x224d26(0x498)]===_0x5020b2?_0x4faca0+='\x20\x20-\x20你评论说:\x20'+_0x4cffc5+'\x0a':_0x4faca0+=_0x224d26(0xb8c)+_0x58c28f+_0x224d26(0xc17)+_0x424bea[_0x224d26(0x498)]+_0x224d26(0xd30)+_0x4cffc5+'\x0a';}}}}const _0x171df5=_0x42a172['settings'][_0x224d26(0xa28)]||'我';let _0x3d0c47='',_0x50ce82=![];if(_0x42a172[_0x224d26(0x362)][_0x224d26(0x425)]){const _0x4051e0=_0x463c51[_0x224d26(0x1154)](_0x37ec9b=>_0x37ec9b['role']===_0x224d26(0xcc9)&&!_0x37ec9b['isHidden']),_0x1300eb=_0x463c51['findLast'](_0x3883b3=>_0x3883b3[_0x224d26(0x9be)]==='assistant'&&!_0x3883b3[_0x224d26(0x1162)]);if(_0x4051e0){const _0x540bb0=_0x68368b(_0x4051e0['timestamp']);if(_0x1300eb){const _0x34c64c=_0x68368b(_0x1300eb['timestamp']);_0x3d0c47=_0x224d26(0x7a6)+_0x34c64c+_0x224d26(0x4f9)+_0x540bb0+_0x224d26(0xea6);const _0x345c08=(_0x4051e0['timestamp']-_0x1300eb[_0x224d26(0x69a)])/(0x3e8*0x3c*0x3c);if(_0x345c08>0x3){_0x50ce82=!![];const _0x562c38=Math[_0x224d26(0x5f8)](_0x345c08/0x18);_0x3d0c47+=_0x224d26(0x817)+(_0x562c38>0x0?_0x562c38+'天':Math[_0x224d26(0x5f8)](_0x345c08)+'小时')+_0x224d26(0x228)+_0x4266d6+_0x224d26(0x12e2);}}else _0x3d0c47='-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20'+_0x540bb0+'。';}else _0x3d0c47=_0x224d26(0x9ec);}const _0x145b67=_0xf9a226(_0x4538fd),_0x3ec70b=_0x5bdf0b(_0x42a172,0x3,'hours'),_0x3a928f=_0x5bdf0b(_0x42a172,0x6,_0x224d26(0xe03)),_0x48a6f9=_0x5bdf0b(_0x42a172,0x9,_0x224d26(0xe03)),_0x3a4d5c=_0x5bdf0b(_0x42a172,0x1,_0x224d26(0xb0b)),_0x34a7ad=_0x5bdf0b(_0x42a172,0x3,_0x224d26(0xb0b)),_0x506692=_0x5bdf0b(_0x42a172,0x7,_0x224d26(0xb0b));let _0x5f36c9='';if(_0x3ec70b||_0x3a928f||_0x48a6f9||_0x3a4d5c||_0x34a7ad||_0x506692){_0x5f36c9+=_0x224d26(0xba8);if(_0x3ec70b)_0x5f36c9+=_0x3ec70b;if(_0x3a928f)_0x5f36c9+=_0x3a928f;if(_0x48a6f9)_0x5f36c9+=_0x48a6f9;if(_0x3ec70b||_0x3a928f||_0x48a6f9)_0x5f36c9+='\x0a';if(_0x3a4d5c)_0x5f36c9+=_0x3a4d5c;if(_0x34a7ad)_0x5f36c9+=_0x34a7ad;if(_0x506692)_0x5f36c9+=_0x506692;}_0x5bf563=_0x224d26(0x12d2)+_0x42a172['originalName']+_0x224d26(0xae2)+_0x42a172[_0x224d26(0x362)][_0x224d26(0x67c)]+'\x0a'+_0x4ed21f+_0x224d26(0x235)+_0x42a172[_0x224d26(0x362)][_0x224d26(0x1528)]+_0x224d26(0x6ae)+(_0x42a172[_0x224d26(0x362)][_0x224d26(0x425)]?_0x224d26(0x1250)+_0x223e4a+'\x20('+_0x4266d6+')':'')+'\x0a'+_0x3d0c47+_0x224d26(0x1198)+_0x466e43+'\x0a'+_0x471845+'\x0a#\x20长期记忆\x20(必须严格遵守)\x0a'+(_0x42a172['longTermMemory']&&_0x42a172[_0x224d26(0x153f)][_0x224d26(0x9a1)]>0x0?_0x42a172['longTermMemory']['map'](_0x581fda=>'-\x20'+_0x581fda['content'])['join']('\x0a'):'-\x20(暂无)')+'\x0a'+_0x5f36c9+_0x224d26(0x20d)+_0x42a172[_0x224d26(0x66c)]+'\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22'+_0x42a172[_0x224d26(0xe36)]+'\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“'+_0x171df5+_0x224d26(0x142e)+_0x3d72db+'\x0a\x20\x20\x20\x20'+_0x527a4d+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x24fdd6+'\x0a'+_0x5987df+'\x0a'+_0x3759a8+_0x224d26(0x1568)+_0x3417cf+'\x0a'+_0x4faca0+_0x224d26(0x92f)+(_0x42a172['settings'][_0x224d26(0x425)]?_0x224d26(0x458)+_0x223e4a+'\x20('+_0x4266d6+_0x224d26(0x13fd):'')+_0x224d26(0xdcc)+(_0x12b404?'你们正在一起听歌，'+_0x12b404:_0x224d26(0x6c2))+'\x0a\x20\x20\x20\x20-\x20**读书**:\x20'+(_0x145b67?_0x224d26(0xb71)+_0x145b67:_0x224d26(0x162))+'\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20'+(_0x42a172[_0x224d26(0x362)][_0x224d26(0x78c)]&&_0x42a172[_0x224d26(0x362)][_0x224d26(0x78c)][_0x224d26(0x9a1)]>0x0?_0x42a172[_0x224d26(0x362)][_0x224d26(0x78c)][_0x224d26(0x11c6)](_0x310a2a=>'-\x20'+_0x310a2a['name'])[_0x224d26(0xbad)]('\x0a'):_0x224d26(0xd5b))+'\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20'+(_0x42a172[_0x224d26(0x362)][_0x224d26(0xbd2)]&&_0x42a172[_0x224d26(0x362)][_0x224d26(0xbd2)][_0x224d26(0x9a1)]>0x0?_0x42a172['settings']['myAvatarLibrary']['map'](_0x419a3b=>'-\x20'+_0x419a3b[_0x224d26(0xe36)])[_0x224d26(0xbad)]('\x0a'):_0x224d26(0xd5b))+_0x224d26(0x6cb)+_0x367cd7+'\x0a\x0a\x0a\x0a\x0a#\x20可用指令列表\x0a###\x20思维链\x20(必须作为第一个元素！)\x0a-\x20\x20\x20**`{\x22type\x22:\x20\x22thought_chain\x22,\x20\x22analysis\x22:\x20\x22你对用户上一轮发言的分析...\x22,\x20\x22strategy\x22:\x20\x22你本轮的回复策略...\x22,\x20\x22character_thoughts\x22:\x20{\x22'+_0x42a172[_0x224d26(0x66c)]+_0x224d26(0x14ec)+_0x42a172[_0x224d26(0x66c)]+'\x22)\x20为键的内心独白。\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a'+(localStorage[_0x224d26(0x11c3)]('novelai-enabled')===_0x224d26(0x33e)?_0x224d26(0x11fe):'')+_0x224d26(0x126a)+(localStorage[_0x224d26(0x11c3)](_0x224d26(0x89f))==='true'?'-\x20\x20\x20**公开发布NovelAI真实图片动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20[\x22图片1详细英文描述\x22,\x20\x22图片2详细英文描述\x22]}`\x20\x0a\x20\x20*\x20**prompt撰写**：你可以根据当前对话上下文、你的角色人设、以及你想表达的情感和氛围，来撰写详细而具体的prompt。详细程度由你根据具体情况自己决定，并不强制。\x0a\x20\x20*\x20例如：\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22':'')+_0x224d26(0xe60)+_0x42a172[_0x224d26(0x66c)]+_0x224d26(0xa9f)+_0x42a172[_0x224d26(0x66c)]+_0x224d26(0x14bd)+_0x42a172['originalName']+_0x224d26(0xb56)+_0x42a172[_0x224d26(0x66c)]+_0x224d26(0x12c4),_0x654822=_0x463c51[_0x224d26(0x11c6)](_0x808248=>{const _0x167711=_0x224d26;if(_0x808248[_0x167711(0x1162)]&&_0x808248[_0x167711(0x9be)]==='system')return{'role':_0x167711(0xcc9),'content':_0x808248[_0x167711(0x1047)]};else{if(_0x808248['isHidden'])return null;}if(_0x808248['type']===_0x167711(0x6fb)){const _0x70a611=_0x808248[_0x167711(0x9be)]===_0x167711(0xcc9)?_0x42a172[_0x167711(0x362)][_0x167711(0xa28)]||'我':_0x42a172[_0x167711(0xe36)];let _0x414464='';if(_0x808248[_0x167711(0x1047)])_0x414464=_0x808248[_0x167711(0x1047)];else{const _0x3e9bc8=_0x808248[_0x167711(0x6c4)]?'「'+_0x808248[_0x167711(0x6c4)]+'」':'',_0x52050d=_0x808248[_0x167711(0x9cc)]?'('+_0x808248[_0x167711(0x9cc)]+')':'';_0x414464=(_0x3e9bc8+'\x20'+_0x52050d)[_0x167711(0x97e)]();}return{'role':_0x808248['role'],'content':_0x167711(0x8b6)+_0x808248[_0x167711(0x69a)]+')\x20'+_0x70a611+':\x20'+_0x414464};}if(_0x808248['role']==='user'){const _0x1f3564=_0x167711(0x8b6)+_0x808248[_0x167711(0x69a)]+')\x20';let _0x296f4d='';if(Array['isArray'](_0x808248[_0x167711(0x1047)])&&_0x808248[_0x167711(0x1047)][0x0]?.[_0x167711(0xb4b)]===_0x167711(0x1014))return{'role':_0x167711(0xcc9),'content':[{'type':_0x167711(0x10ca),'text':_0x1f3564},..._0x808248[_0x167711(0x1047)]]};if(_0x808248['quote']){const _0x406485=String(_0x808248[_0x167711(0x447)][_0x167711(0x1047)]||'')['substring'](0x0,0x32);_0x296f4d+=_0x167711(0x868)+_0x808248[_0x167711(0x447)]['senderName']+'\x20的消息:\x20\x22'+_0x406485+_0x167711(0x832)+_0x808248[_0x167711(0x1047)];}else _0x296f4d+=_0x808248[_0x167711(0x1047)];if(_0x808248['type']===_0x167711(0x7f7))return{'role':_0x167711(0xcc9),'content':_0x1f3564+_0x167711(0x16a)+_0x808248['content']+'\x27]'};if(_0x808248['type']===_0x167711(0x8bc))return{'role':_0x167711(0xcc9),'content':_0x1f3564+_0x167711(0x532)+_0x808248[_0x167711(0x1047)]+'\x27]'};if(_0x808248[_0x167711(0xb4b)]===_0x167711(0x277))return{'role':'user','content':_0x1f3564+_0x167711(0x5f6)+_0x808248[_0x167711(0x69a)]+_0x167711(0x477)+_0x808248[_0x167711(0x257)]+_0x167711(0x19b)+_0x808248[_0x167711(0x1333)]+'。等待对方处理。]'};if(_0x808248[_0x167711(0xb4b)]===_0x167711(0x12d5))return{'role':_0x167711(0xcc9),'content':_0x1f3564+_0x167711(0x5f6)+_0x808248[_0x167711(0x69a)]+_0x167711(0x1495)+_0x808248['productInfo']+_0x167711(0x560)+_0x808248[_0x167711(0x257)]+'\x20元。]'};else{if(_0x808248[_0x167711(0xb4b)]===_0x167711(0x43e)){const _0x1bc76a=_0x808248['items'][_0x167711(0x11c6)](_0x3c2013=>_0x3c2013[_0x167711(0xe36)]+'\x20x'+_0x3c2013[_0x167711(0x17a)])['join']('、\x20');let _0x2bc016=_0x42a172[_0x167711(0x1423)]?'送给了\x20'+_0x808248[_0x167711(0x9e5)][_0x167711(0x11c6)](_0x572d14=>_0x4f967c(_0x42a172,_0x572d14))[_0x167711(0xbad)]('、\x20'):_0x167711(0x73f)+_0x42a172['name'];return{'role':'user','content':_0x1f3564+_0x167711(0x7b3)+_0x2bc016+'，礼物是：'+_0x1bc76a+']'};}}if(_0x808248[_0x167711(0x1488)])return{'role':_0x167711(0xcc9),'content':_0x1f3564+_0x167711(0xe61)+_0x808248[_0x167711(0x1488)]+'\x27]'};return{'role':_0x808248[_0x167711(0x9be)],'content':_0x1f3564+_0x296f4d};}else{if(_0x808248[_0x167711(0x9be)]===_0x167711(0x6d9)){let _0x1b45a6={'type':_0x808248[_0x167711(0xb4b)]||_0x167711(0x10ca)};if(_0x808248[_0x167711(0xb4b)]===_0x167711(0x14f3))_0x1b45a6[_0x167711(0x6d1)]=_0x808248['content'],_0x1b45a6['meaning']=_0x808248[_0x167711(0x1488)];else{if(_0x808248[_0x167711(0xb4b)]===_0x167711(0x277))_0x1b45a6[_0x167711(0x257)]=_0x808248[_0x167711(0x257)],_0x1b45a6['note']=_0x808248[_0x167711(0x1333)];else _0x808248[_0x167711(0xb4b)]===_0x167711(0x12d5)?(_0x1b45a6[_0x167711(0xa89)]=_0x808248[_0x167711(0xa89)],_0x1b45a6['amount']=_0x808248[_0x167711(0x257)]):_0x808248[_0x167711(0x447)]?_0x1b45a6['quote_reply']={'target_sender':_0x808248[_0x167711(0x447)][_0x167711(0x1361)],'target_content':_0x808248[_0x167711(0x447)][_0x167711(0x1047)],'reply_content':_0x808248[_0x167711(0x1047)]}:_0x1b45a6[_0x167711(0x1047)]=_0x808248['content'];}const _0x439fe5=JSON['stringify']([_0x1b45a6]);return{'role':_0x167711(0x6d9),'content':_0x167711(0x8b6)+_0x808248['timestamp']+')\x20'+_0x439fe5};}}return null;})[_0x224d26(0xebc)](Boolean);if(!_0x42a172['isGroup']&&_0x42a172[_0x224d26(0xaf4)]?.[_0x224d26(0x2a3)]===_0x224d26(0x890)){const _0x2ea055=_0x42a172[_0x224d26(0x12c3)][_0x224d26(0xebc)](_0x3ff4bb=>!_0x3ff4bb[_0x224d26(0x1162)])[_0x224d26(0x225)](-0xa)[_0x224d26(0x11c6)](_0x180f51=>{const _0x32a35f=_0x224d26,_0x5143e6=_0x180f51[_0x32a35f(0x9be)]===_0x32a35f(0xcc9)?'用户':_0x42a172[_0x32a35f(0xe36)];return _0x5143e6+':\x20'+String(_0x180f51[_0x32a35f(0x1047)])['substring'](0x0,0x32)+_0x32a35f(0x4e6);})[_0x224d26(0xbad)]('\x0a'),_0x3ad33d={'role':'user','content':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“'+_0x42a172[_0x224d26(0xaf4)][_0x224d26(0x2d1)]+_0x224d26(0x153c)+_0x2ea055+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20'};_0x654822['push'](_0x3ad33d);}}}let _0x17ec9f=_0x5d809d===GEMINI_API_URL,_0x7ef6a4=_0x4fff3d(_0xa67f11,_0x477ae8,_0x5bf563,_0x654822),_0x7dfed2;try{_0x7dfed2=_0x17ec9f?await fetch(_0x7ef6a4[_0x224d26(0x6d1)],_0x7ef6a4[_0x224d26(0x1418)]):await fetch(_0x5d809d+_0x224d26(0x1427),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x224d26(0xe83)+_0x477ae8},'body':JSON[_0x224d26(0xe4d)]({'model':_0xa67f11,'messages':[{'role':'system','content':_0x5bf563},..._0x654822],'temperature':_0x28f30a['globalSettings'][_0x224d26(0x294)]||0.8,'stream':![]})});}catch(_0x35e136){throw new Error(_0x224d26(0x9de)+_0x35e136[_0x224d26(0x13bc)]);}if(!_0x7dfed2['ok']){let _0x7155c8=_0x224d26(0x1332)+_0x7dfed2[_0x224d26(0x2a3)]+'\x20'+_0x7dfed2[_0x224d26(0x1066)];try{const _0x149bc2=await _0x7dfed2[_0x224d26(0x12a2)]();_0x149bc2['error']&&_0x149bc2[_0x224d26(0x1518)][_0x224d26(0x13bc)]?_0x7155c8+='\x20-\x20'+_0x149bc2[_0x224d26(0x1518)][_0x224d26(0x13bc)]:_0x7155c8+=_0x224d26(0xf8a)+JSON[_0x224d26(0xe4d)](_0x149bc2);}catch(_0x2e9357){_0x7155c8+='\x20-\x20响应内容:\x20'+await _0x7dfed2[_0x224d26(0x10ca)]();}throw new Error(_0x7155c8);}const _0x48610c=await _0x7dfed2[_0x224d26(0x12a2)](),_0x4cdfed=getGeminiResponseText(_0x48610c);lastRawAiResponse=_0x4cdfed,lastResponseTimestamps=[],_0x42a172[_0x224d26(0x12c3)]=_0x42a172['history'][_0x224d26(0xebc)](_0x132b4c=>!_0x132b4c['isTemporary']);const _0x34ce3d=_0x422882(_0x4cdfed);let _0x5dc82e=[];if(_0x42a172['settings'][_0x224d26(0x1448)]){let _0x352589={'content':[],'dialogue':[],'description':[]};for(const _0x333e8b of _0x34ce3d){if(_0x333e8b['type']==='offline_text'){if(_0x333e8b['content'])_0x352589[_0x224d26(0x1047)][_0x224d26(0x367)](_0x333e8b[_0x224d26(0x1047)]);else{if(_0x333e8b['dialogue'])_0x352589[_0x224d26(0x6c4)][_0x224d26(0x367)](_0x333e8b[_0x224d26(0x6c4)]);if(_0x333e8b[_0x224d26(0x9cc)])_0x352589['description'][_0x224d26(0x367)](_0x333e8b[_0x224d26(0x9cc)]);}}else(_0x352589[_0x224d26(0x1047)][_0x224d26(0x9a1)]>0x0||_0x352589[_0x224d26(0x6c4)][_0x224d26(0x9a1)]>0x0||_0x352589[_0x224d26(0x9cc)][_0x224d26(0x9a1)]>0x0)&&(_0x352589['content'][_0x224d26(0x9a1)]>0x0&&_0x5dc82e['push']({'type':'offline_text','content':_0x352589['content'][_0x224d26(0xbad)]('\x0a')}),(_0x352589['dialogue'][_0x224d26(0x9a1)]>0x0||_0x352589[_0x224d26(0x9cc)][_0x224d26(0x9a1)]>0x0)&&_0x5dc82e['push']({'type':_0x224d26(0x6fb),'dialogue':_0x352589[_0x224d26(0x6c4)][_0x224d26(0xbad)]('\x0a'),'description':_0x352589[_0x224d26(0x9cc)]['join']('\x0a')}),_0x352589={'content':[],'dialogue':[],'description':[]}),_0x5dc82e[_0x224d26(0x367)](_0x333e8b);}_0x352589[_0x224d26(0x1047)][_0x224d26(0x9a1)]>0x0&&_0x5dc82e[_0x224d26(0x367)]({'type':_0x224d26(0x6fb),'content':_0x352589['content']['join']('\x0a')}),(_0x352589[_0x224d26(0x6c4)][_0x224d26(0x9a1)]>0x0||_0x352589[_0x224d26(0x9cc)][_0x224d26(0x9a1)]>0x0)&&_0x5dc82e[_0x224d26(0x367)]({'type':_0x224d26(0x6fb),'dialogue':_0x352589[_0x224d26(0x6c4)][_0x224d26(0xbad)]('\x0a'),'description':_0x352589[_0x224d26(0x9cc)][_0x224d26(0xbad)]('\x0a')});}else _0x5dc82e=_0x34ce3d;const _0x2f6cc3=_0x42a172[_0x224d26(0x12c3)][_0x224d26(0xebc)](_0xdcc79c=>_0xdcc79c[_0x224d26(0x9be)]==='user'&&!_0xdcc79c[_0x224d26(0x1162)])[_0x224d26(0xdba)]();if(_0x2f6cc3&&Array[_0x224d26(0x624)](_0x2f6cc3[_0x224d26(0x1047)])&&_0x2f6cc3[_0x224d26(0x1047)][0x0]?.[_0x224d26(0xb4b)]===_0x224d26(0x1014)&&!_0x2f6cc3[_0x224d26(0x1193)]){const _0x5bbbc9=_0x34ce3d['find'](_0x3b68e0=>_0x3b68e0['type']===_0x224d26(0x10ca));let _0x3644a1;_0x5bbbc9&&(_0x5bbbc9[_0x224d26(0x1047)]||_0x5bbbc9[_0x224d26(0x13bc)])?_0x3644a1=String(_0x5bbbc9[_0x224d26(0x1047)]||_0x5bbbc9['message'])['trim']():_0x3644a1=_0x224d26(0x197);const _0x5ceeeb=_0x42a172['history'][_0x224d26(0x535)](_0x2c251c=>_0x2c251c[_0x224d26(0x69a)]===_0x2f6cc3[_0x224d26(0x69a)]);if(_0x5ceeeb>-0x1){console[_0x224d26(0x415)](_0x224d26(0xcbe)+_0x2f6cc3[_0x224d26(0x69a)]+_0x224d26(0x27a));const _0xc08ce2=_0x224d26(0xcda)+_0x3644a1+'”]';_0x42a172[_0x224d26(0x12c3)][_0x5ceeeb]['content']=_0xc08ce2,_0x42a172['history'][_0x5ceeeb][_0x224d26(0x1193)]=!![],_0x42a172['history'][_0x5ceeeb][_0x224d26(0xb4b)]='text';}}const _0x989e86=document['getElementById'](_0x224d26(0x120a))[_0x224d26(0xff6)][_0x224d26(0xe9a)](_0x224d26(0xd43))&&_0x28f30a['activeChatId']===_0x4538fd;let _0x2b5440=![],_0x3271f4=Date[_0x224d26(0x487)](),_0x446a60=[],_0x2a1a2f=![];for(const _0x49b125 of _0x5dc82e){if(_0x49b125[_0x224d26(0xb4b)]===_0x224d26(0xb79)){console[_0x224d26(0x415)]('🤖\x20AI\x20思维链:',_0x49b125);const _0x5bf583=_0x224d26(0x3fa)+(_0x49b125[_0x224d26(0x1450)]||'无')+_0x224d26(0x3db)+(_0x49b125[_0x224d26(0xa2b)]||'无')+_0x224d26(0x85a)+JSON[_0x224d26(0xe4d)](_0x49b125['character_thoughts']||{}),_0x11d7bc={'role':_0x224d26(0x10a7),'content':_0x5bf583,'timestamp':Date[_0x224d26(0x487)]()-0x1,'isHidden':!![]};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x11d7bc);continue;}_0x42a172['settings'][_0x224d26(0x1ee)]!==![]&&_0x49b125[_0x224d26(0xb4b)]===_0x224d26(0x10ca)&&typeof _0x49b125[_0x224d26(0x1047)]===_0x224d26(0x863)&&_0x49b125[_0x224d26(0x1047)]['trim']()['startsWith']('[V]')&&(_0x49b125['type']='voice_message',_0x49b125[_0x224d26(0x1047)]=_0x49b125[_0x224d26(0x1047)][_0x224d26(0x13ed)](_0x224d26(0xac7),'')[_0x224d26(0x97e)]());if(_0x42a172['isGroup']&&_0x49b125['name']&&_0x49b125[_0x224d26(0xe36)]===_0x42a172['name']){console[_0x224d26(0x1518)]('AI幻觉已被拦截！试图使用群名\x20(\x22'+_0x42a172[_0x224d26(0xe36)]+'\x22)\x20作为角色名。消息内容:',_0x49b125);continue;}if(!_0x49b125||typeof _0x49b125!=='object'){console['warn'](_0x224d26(0x3e7),_0x49b125);continue;}if(!_0x49b125[_0x224d26(0xb4b)]){if(_0x42a172[_0x224d26(0x1423)]&&_0x49b125['name']&&_0x49b125[_0x224d26(0x13bc)])_0x49b125['type']=_0x224d26(0x10ca);else{if(_0x49b125[_0x224d26(0x1047)])_0x49b125[_0x224d26(0xb4b)]=_0x224d26(0x10ca);else{console[_0x224d26(0x664)](_0x224d26(0x841),_0x49b125);continue;}}}if(_0x49b125[_0x224d26(0xb4b)]===_0x224d26(0x1116)){_0x20bfc1['isAwaitingResponse']=![];if(_0x49b125[_0x224d26(0x531)]===_0x224d26(0xf7c))_0x5821d3();else{const _0x44698b={'role':'assistant','content':_0x224d26(0xe31),'timestamp':Date[_0x224d26(0x487)]()};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x44698b),await _0x5b9d83[_0x224d26(0x6ce)][_0x224d26(0x7c3)](_0x42a172),_0x17ec27(_0x224d26(0x120a)),_0xc55746(_0x4538fd);}_0x2b5440=!![];break;}if(_0x49b125[_0x224d26(0xb4b)]==='group_call_response'){if(_0x49b125['decision']==='join'){const _0x551cac=_0x42a172[_0x224d26(0x10f2)][_0x224d26(0x412)](_0x3520a0=>_0x3520a0['originalName']===_0x49b125['name']);_0x551cac&&!_0x20bfc1[_0x224d26(0x73e)][_0x224d26(0x7e2)](_0x398810=>_0x398810['id']===_0x551cac['id'])&&_0x20bfc1[_0x224d26(0x73e)][_0x224d26(0x367)](_0x551cac);}_0x2b5440=!![];continue;}if(_0x42a172[_0x224d26(0x1423)]&&_0x49b125['name']&&_0x49b125[_0x224d26(0xe36)]===_0x42a172[_0x224d26(0xe36)]){console[_0x224d26(0x1518)]('AI幻觉已被拦截！试图使用群名\x20(\x22'+_0x42a172['name']+_0x224d26(0xab2),_0x49b125);continue;}if(_0x42a172[_0x224d26(0x1423)]&&!_0x49b125[_0x224d26(0xe36)]){console[_0x224d26(0x1518)]('AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:',_0x49b125);continue;}let _0x1b55a4=null;const _0x4875cb=_0x3271f4++,_0x57b2dc={'role':_0x224d26(0x6d9),'senderName':_0x49b125[_0x224d26(0xe36)]||_0x42a172[_0x224d26(0xe36)],'timestamp':_0x4875cb};lastResponseTimestamps[_0x224d26(0x367)](_0x4875cb);switch(_0x49b125['type']){case _0x224d26(0x9fb):{const _0x56cd0c=_0x49b125[_0x224d26(0xe36)],_0x4d56cc=_0x49b125['recipient'],_0x3a5817=_0x28f30a['qzoneSettings'][_0x224d26(0x19a)]||_0x224d26(0x450);if(_0x4d56cc===_0x3a5817){const _0x2d14d0=Object[_0x224d26(0x74e)](_0x28f30a['chats'])[_0x224d26(0x412)](_0x241c99=>!_0x241c99['isGroup']&&_0x241c99[_0x224d26(0x66c)]===_0x56cd0c);if(_0x2d14d0){lastPrivateMessagesSent=[];const _0x1385ed=Array[_0x224d26(0x624)](_0x49b125[_0x224d26(0x1047)])?_0x49b125[_0x224d26(0x1047)]:[_0x49b125['content']];let _0x46c846=0x0;for(const _0x2ea372 of _0x1385ed){if(!_0x2ea372||!_0x2ea372[_0x224d26(0x97e)]())continue;const _0x2fb9ca={'role':_0x224d26(0x6d9),'senderName':_0x56cd0c,'content':_0x2ea372,'timestamp':_0x3271f4++};lastPrivateMessagesSent[_0x224d26(0x367)]({'chatId':_0x2d14d0['id'],'timestamp':_0x2fb9ca['timestamp']}),_0x2d14d0[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x2fb9ca),_0x46c846++;}_0x46c846>0x0&&(_0x28f30a[_0x224d26(0x11b9)]!==_0x2d14d0['id']&&(_0x2d14d0[_0x224d26(0xce1)]=(_0x2d14d0[_0x224d26(0xce1)]||0x0)+_0x46c846,_0x1c12fe(_0x2d14d0['id'],_0x2d14d0[_0x224d26(0xe36)]+_0x224d26(0x4c9)+_0x46c846+_0x224d26(0x39b))),await _0x5b9d83[_0x224d26(0x6ce)]['put'](_0x2d14d0)),_0x1b55a4=null;}else console[_0x224d26(0x664)](_0x224d26(0xacf)+_0x56cd0c+_0x224d26(0x750)),_0x1b55a4=null;}else console[_0x224d26(0x664)](_0x224d26(0x7ea)+_0x4d56cc+_0x224d26(0x1577)),_0x1b55a4=null;continue;}case _0x224d26(0xda1):if(!_0x42a172[_0x224d26(0x1423)]){_0x49b125[_0x224d26(0x524)]&&(_0x42a172[_0x224d26(0x28a)]=String(_0x49b125[_0x224d26(0x524)]));_0x49b125[_0x224d26(0x10cd)]&&(_0x42a172['randomJottings']=String(_0x49b125[_0x224d26(0x10cd)]));!Array[_0x224d26(0x624)](_0x42a172[_0x224d26(0x2be)])&&(_0x42a172['thoughtsHistory']=[]);_0x42a172[_0x224d26(0x2be)][_0x224d26(0x367)]({'heartfeltVoice':_0x42a172['heartfeltVoice'],'randomJottings':_0x42a172['randomJottings'],'timestamp':Date[_0x224d26(0x487)]()});_0x42a172['thoughtsHistory'][_0x224d26(0x9a1)]>0x32&&_0x42a172[_0x224d26(0x2be)]['shift']();const _0x3335f0=_0x224d26(0xbe3)+_0x42a172['heartfeltVoice']+_0x224d26(0xf77)+_0x42a172['randomJottings'],_0x1a5bbb={'role':_0x224d26(0x10a7),'content':_0x3335f0,'timestamp':Date[_0x224d26(0x487)](),'isHidden':!![]};}continue;case _0x224d26(0xa66):if(!_0x42a172[_0x224d26(0x1423)]&&_0x49b125['new_name']){const _0x3107c0=_0x49b125[_0x224d26(0x480)][_0x224d26(0x97e)]();if(_0x3107c0){_0x42a172[_0x224d26(0x362)][_0x224d26(0xa28)]=_0x3107c0;const _0x33b22d={'role':_0x224d26(0x10a7),'type':'pat_message','content':'“'+_0x42a172['name']+'”\x20将对你的称呼修改为\x20“'+_0x3107c0+'”','timestamp':_0x3271f4++};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x33b22d);const _0x105ff0={'role':'system','content':'[系统提示：你刚刚成功将对用户的称呼修改为了“'+_0x3107c0+'”。]','timestamp':_0x3271f4++,'isHidden':!![]};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x105ff0),_0x989e86&&_0x4cc03e(_0x33b22d,_0x42a172);}}continue;case _0x224d26(0xd56):if(!_0x42a172[_0x224d26(0x1423)]&&_0x49b125[_0x224d26(0x480)]){const _0x3996e8=_0x42a172[_0x224d26(0xe36)],_0x666ec4=_0x49b125[_0x224d26(0x480)]['trim']();if(_0x666ec4&&_0x666ec4!==_0x3996e8){!_0x42a172[_0x224d26(0x316)]&&(_0x42a172[_0x224d26(0x316)]=[]);!_0x42a172[_0x224d26(0x316)][_0x224d26(0x138a)](_0x3996e8)&&_0x42a172[_0x224d26(0x316)][_0x224d26(0x367)](_0x3996e8);_0x42a172[_0x224d26(0xe36)]=_0x666ec4;const _0x508efa={'role':'system','type':_0x224d26(0x10aa),'content':'“'+_0x42a172[_0x224d26(0x66c)]+_0x224d26(0xf3c)+_0x666ec4+'”','timestamp':_0x3271f4++};_0x42a172[_0x224d26(0x12c3)]['push'](_0x508efa);const _0x548c58={'role':'system','content':'[系统提示：你刚刚成功将自己的备注名修改为了“'+_0x666ec4+_0x224d26(0x284),'timestamp':_0x3271f4++,'isHidden':!![]};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x548c58),_0x989e86&&(_0x4cc03e(_0x508efa,_0x42a172),document['getElementById'](_0x224d26(0x96a))[_0x224d26(0x15f)]=_0x666ec4),await _0x24e380(_0x42a172);}}continue;case _0x224d26(0x50f):{const _0x59e5e6=_0x49b125[_0x224d26(0xe36)],_0x205d57=_0x42a172[_0x224d26(0x362)]['aiAvatarLibrary'][_0x224d26(0x412)](_0x4958f4=>_0x4958f4[_0x224d26(0xe36)]===_0x59e5e6);if(_0x205d57){_0x42a172[_0x224d26(0x362)][_0x224d26(0xe91)]=_0x205d57[_0x224d26(0x6d1)];const _0x174784={'role':_0x224d26(0x10a7),'type':_0x224d26(0x10aa),'content':'['+_0x42a172[_0x224d26(0xe36)]+_0x224d26(0x690),'timestamp':Date[_0x224d26(0x487)]()};_0x42a172['history']['push'](_0x174784),await _0x50cbc4(_0x42a172),_0x989e86&&(_0x4cc03e(_0x174784,_0x42a172),_0xc55746(_0x4538fd));}continue;}case'change_user_avatar':{const _0x5f50d7=_0x49b125[_0x224d26(0xe36)],_0x475788=_0x42a172['settings'][_0x224d26(0xbd2)][_0x224d26(0x412)](_0x2e57e3=>_0x2e57e3[_0x224d26(0xe36)]===_0x5f50d7);if(_0x475788){_0x42a172[_0x224d26(0x362)][_0x224d26(0x10a3)]=_0x475788[_0x224d26(0x6d1)];const _0x37ad9b={'role':_0x224d26(0x10a7),'type':_0x224d26(0x10aa),'content':'['+_0x42a172['name']+_0x224d26(0x14a6),'timestamp':Date['now']()};_0x42a172['history']['push'](_0x37ad9b),_0x989e86&&(_0x4cc03e(_0x37ad9b,_0x42a172),_0xc55746(_0x4538fd));}continue;}case _0x224d26(0x102f):{const _0x2af046=parseInt(_0x49b125['x']),_0x4b3149=parseInt(_0x49b125['y']);!isNaN(_0x2af046)&&!isNaN(_0x4b3149)?_0x40299d({'x':_0x2af046,'y':_0x4b3149}):console['warn'](_0x224d26(0x364),_0x49b125);continue;}case _0x224d26(0x89d):const _0x49a9a2=_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x535)](_0x21c648=>_0x21c648[_0x224d26(0x69a)]===_0x49b125['for_timestamp']);if(_0x49a9a2>-0x1){const _0x2aa5e3=_0x42a172['history'][_0x49a9a2];_0x2aa5e3[_0x224d26(0x2a3)]=_0x49b125[_0x224d26(0x2a3)],_0x2aa5e3[_0x224d26(0x1012)]=_0x49b125[_0x224d26(0x2a3)]===_0x224d26(0x12d6)?_0x49b125[_0x224d26(0xe36)]:null;}continue;case _0x224d26(0x9eb):const _0x5a51a6={'type':_0x49b125[_0x224d26(0x12f0)],'content':_0x49b125[_0x224d26(0x1047)]||'','publicText':_0x49b125['publicText']||'','hiddenContent':_0x49b125['hiddenContent']||'','image_prompt':_0x49b125['image_prompt']||'','timestamp':Date[_0x224d26(0x487)](),'authorId':_0x4538fd,'authorGroupId':_0x42a172[_0x224d26(0x1542)],'visibleGroupIds':null};if(_0x49b125[_0x224d26(0x12f0)]==='naiimag'&&_0x49b125[_0x224d26(0x9fd)])try{const _0x51e61b=Array[_0x224d26(0x624)](_0x49b125[_0x224d26(0x9fd)])?_0x49b125[_0x224d26(0x9fd)]['slice'](0x0,0x2):[_0x49b125[_0x224d26(0x9fd)]];console[_0x224d26(0x415)](_0x224d26(0x11ed)+_0x51e61b['length']+'张图片');const _0x5a5c34=[];for(let _0x1592ee=0x0;_0x1592ee<_0x51e61b[_0x224d26(0x9a1)];_0x1592ee++){const _0x4ceb34=_0x51e61b[_0x1592ee];console[_0x224d26(0x415)](_0x224d26(0xfa9)+(_0x1592ee+0x1)+_0x224d26(0x1370),_0x4ceb34);const _0x1955fa=_0x7da453(_0x42a172['id']),_0x314bb9=_0x4ceb34+',\x20'+_0x1955fa[_0x224d26(0x7c7)],_0x1e00fb=_0x1955fa[_0x224d26(0x1378)];console[_0x224d26(0x415)](_0x224d26(0xdfd)+(_0x1955fa[_0x224d26(0x5c7)]===_0x224d26(0x8e7)?'角色专属':'系统')+_0x224d26(0x10d5)),console[_0x224d26(0x415)](_0x224d26(0xdbd),_0x314bb9),console[_0x224d26(0x415)](_0x224d26(0x8ee),_0x1e00fb);const _0xdaa12b=localStorage[_0x224d26(0x11c3)](_0x224d26(0x5da)),_0x3e8c77=localStorage[_0x224d26(0x11c3)](_0x224d26(0x13f6))||'nai-diffusion-4-5-full',_0x4965ac=_0x4cb256();if(!_0xdaa12b)throw new Error(_0x224d26(0x2d0));const [_0x23f4f8,_0x3237dd]=_0x4965ac[_0x224d26(0x121b)][_0x224d26(0xa8a)]('x')[_0x224d26(0x11c6)](Number);let _0x3b3fda;_0x3e8c77[_0x224d26(0x138a)](_0x224d26(0x12b4))?_0x3b3fda={'input':_0x314bb9,'model':_0x3e8c77,'action':_0x224d26(0x13ca),'parameters':{'params_version':0x3,'width':_0x23f4f8,'height':_0x3237dd,'scale':_0x4965ac[_0x224d26(0xb42)],'sampler':_0x4965ac[_0x224d26(0x46a)],'steps':_0x4965ac[_0x224d26(0xd22)],'seed':_0x4965ac[_0x224d26(0x634)]===-0x1?Math[_0x224d26(0x5f8)](Math['random']()*0x2540be3ff):_0x4965ac[_0x224d26(0x634)],'n_samples':0x1,'ucPreset':_0x4965ac['uc_preset'],'qualityToggle':_0x4965ac[_0x224d26(0xf9e)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x224d26(0xcc4),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x314bb9,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x1e00fb,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x1e00fb,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x3b3fda={'input':_0x314bb9,'model':_0x3e8c77,'action':_0x224d26(0x13ca),'parameters':{'width':_0x23f4f8,'height':_0x3237dd,'scale':_0x4965ac[_0x224d26(0xb42)],'sampler':_0x4965ac[_0x224d26(0x46a)],'steps':_0x4965ac[_0x224d26(0xd22)],'seed':_0x4965ac['seed']===-0x1?Math[_0x224d26(0x5f8)](Math[_0x224d26(0x1337)]()*0x2540be3ff):_0x4965ac[_0x224d26(0x634)],'n_samples':0x1,'ucPreset':_0x4965ac[_0x224d26(0xc05)],'qualityToggle':_0x4965ac[_0x224d26(0xf9e)],'sm':_0x4965ac[_0x224d26(0x805)],'sm_dyn':_0x4965ac['smea_dyn'],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x224d26(0xc6b),'negative_prompt':_0x1e00fb}};console[_0x224d26(0x415)](_0x224d26(0x825),_0x3b3fda);let _0x4214ee;_0x3e8c77[_0x224d26(0x138a)](_0x224d26(0x12b4))?_0x4214ee=_0x224d26(0x132d):_0x4214ee='https://image.novelai.net/ai/generate-image';let _0x45205f=_0x4965ac[_0x224d26(0x9c0)];_0x45205f==='custom'&&(_0x45205f=_0x4965ac[_0x224d26(0xb73)]||'');_0x45205f&&_0x45205f!==''&&(_0x4214ee=_0x45205f+encodeURIComponent(_0x4214ee));const _0x1c3715=await fetch(_0x4214ee,{'method':_0x224d26(0x655),'headers':{'Content-Type':'application/json','Authorization':_0x224d26(0xe83)+_0xdaa12b},'body':JSON['stringify'](_0x3b3fda)});console[_0x224d26(0x415)]('Response\x20status:',_0x1c3715[_0x224d26(0x2a3)]),console['log'](_0x224d26(0x222),[..._0x1c3715[_0x224d26(0x79a)][_0x224d26(0x127b)]()]);if(!_0x1c3715['ok']){const _0x3b17b9=await _0x1c3715[_0x224d26(0x10ca)]();console[_0x224d26(0x1518)](_0x224d26(0xb6e),_0x3b17b9);throw new Error('API请求失败\x20('+_0x1c3715[_0x224d26(0x2a3)]+_0x224d26(0xd30)+_0x3b17b9);}const _0x17ef56=_0x1c3715[_0x224d26(0x79a)][_0x224d26(0x6b5)](_0x224d26(0x2ed));console[_0x224d26(0x415)](_0x224d26(0x526),_0x17ef56);let _0x8fa1cc,_0x564cd8;if(_0x17ef56&&_0x17ef56[_0x224d26(0x138a)](_0x224d26(0x810))){console[_0x224d26(0x415)](_0x224d26(0x2c1));const _0xbb6a4a=await _0x1c3715[_0x224d26(0x10ca)]();console[_0x224d26(0x415)](_0x224d26(0xf62),_0xbb6a4a[_0x224d26(0x9a1)]);const _0x2e69dd=_0xbb6a4a[_0x224d26(0x97e)]()[_0x224d26(0xa8a)]('\x0a');let _0x4b27bf=null;for(let _0x2b2e54=_0x2e69dd[_0x224d26(0x9a1)]-0x1;_0x2b2e54>=0x0;_0x2b2e54--){const _0x164853=_0x2e69dd[_0x2b2e54][_0x224d26(0x97e)]();if(_0x164853[_0x224d26(0x741)](_0x224d26(0x16c))&&_0x164853!==_0x224d26(0xfdc)){const _0x225249=_0x164853[_0x224d26(0xa6b)](0x6);try{const _0x1504db=JSON[_0x224d26(0xd91)](_0x225249);if(_0x1504db[_0x224d26(0x81b)]===_0x224d26(0x186)&&_0x1504db['image']){_0x4b27bf=_0x1504db[_0x224d26(0x9e6)],console[_0x224d26(0x415)](_0x224d26(0x1a5));break;}if(_0x1504db[_0x224d26(0x1418)]){_0x4b27bf=_0x1504db[_0x224d26(0x1418)],console['log'](_0x224d26(0xb90));break;}if(_0x1504db[_0x224d26(0x9e6)]){_0x4b27bf=_0x1504db['image'],console[_0x224d26(0x415)]('从\x20JSON.image\x20中提取图片数据');break;}}catch(_0x4cebec){_0x4b27bf=_0x225249,console[_0x224d26(0x415)](_0x224d26(0xb3a));break;}}}if(!_0x4b27bf)throw new Error('无法从\x20SSE\x20响应中提取图片数据');const _0x14034e=_0x4b27bf[_0x224d26(0x741)](_0x224d26(0xed9)),_0x185bf9=_0x4b27bf[_0x224d26(0x741)](_0x224d26(0x5d4));if(_0x14034e||_0x185bf9){console[_0x224d26(0x415)]('✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)');const _0x50affd=atob(_0x4b27bf),_0x2b10e5=new Uint8Array(_0x50affd[_0x224d26(0x9a1)]);for(let _0x3964ee=0x0;_0x3964ee<_0x50affd['length'];_0x3964ee++){_0x2b10e5[_0x3964ee]=_0x50affd[_0x224d26(0xe26)](_0x3964ee);}const _0x4a480e=new Blob([_0x2b10e5],{'type':_0x14034e?_0x224d26(0xca9):'image/jpeg'});console[_0x224d26(0x415)](_0x224d26(0xdc0),_0x4a480e[_0x224d26(0x2d2)]);const _0x595e0f=new FileReader();_0x564cd8=await new Promise((_0x46f5b0,_0x434025)=>{const _0x53613b=_0x224d26;_0x595e0f[_0x53613b(0x3d6)]=()=>_0x46f5b0(_0x595e0f[_0x53613b(0x42a)]),_0x595e0f[_0x53613b(0x125a)]=_0x434025,_0x595e0f['readAsDataURL'](_0x4a480e);}),console[_0x224d26(0x415)]('✅\x20图片转换成功！🎨');}else{console[_0x224d26(0x415)](_0x224d26(0x1db));const _0x1b2ddf=atob(_0x4b27bf),_0x3831dc=new Uint8Array(_0x1b2ddf[_0x224d26(0x9a1)]);for(let _0x31656d=0x0;_0x31656d<_0x1b2ddf[_0x224d26(0x9a1)];_0x31656d++){_0x3831dc[_0x31656d]=_0x1b2ddf[_0x224d26(0xe26)](_0x31656d);}_0x8fa1cc=new Blob([_0x3831dc]),console[_0x224d26(0x415)](_0x224d26(0xe9d),_0x8fa1cc[_0x224d26(0x2d2)]);}}else _0x8fa1cc=await _0x1c3715[_0x224d26(0x465)](),console[_0x224d26(0x415)](_0x224d26(0x318),_0x8fa1cc[_0x224d26(0xb4b)],'大小:',_0x8fa1cc[_0x224d26(0x2d2)]);if(!_0x564cd8&&_0x8fa1cc)try{if(typeof JSZip===_0x224d26(0xe40))throw new Error(_0x224d26(0x368));const _0x4f3b07=await JSZip['loadAsync'](_0x8fa1cc);console[_0x224d26(0x415)](_0x224d26(0xca3),Object[_0x224d26(0xf6b)](_0x4f3b07[_0x224d26(0x8d6)]));let _0x5d7eba=null;for(let _0x140c3e in _0x4f3b07[_0x224d26(0x8d6)]){if(_0x140c3e[_0x224d26(0x49a)](/\.(png|jpg|jpeg|webp)$/i)){_0x5d7eba=_0x4f3b07[_0x224d26(0x8d6)][_0x140c3e],console['log'](_0x224d26(0x26f),_0x140c3e);break;}}if(!_0x5d7eba)throw new Error(_0x224d26(0x6fc));const _0x4092e9=await _0x5d7eba[_0x224d26(0x138d)](_0x224d26(0x465));console[_0x224d26(0x415)](_0x224d26(0xad2),_0x4092e9[_0x224d26(0x2d2)]);const _0x4109a1=new FileReader();_0x564cd8=await new Promise((_0x49ae7f,_0x527891)=>{const _0x3de22b=_0x224d26;_0x4109a1[_0x3de22b(0x3d6)]=()=>_0x49ae7f(_0x4109a1[_0x3de22b(0x42a)]),_0x4109a1[_0x3de22b(0x125a)]=_0x527891,_0x4109a1[_0x3de22b(0x60e)](_0x4092e9);}),console[_0x224d26(0x415)](_0x224d26(0xb9b));}catch(_0x1f2f5a){console[_0x224d26(0x1518)]('ZIP解压失败:',_0x1f2f5a);throw new Error(_0x224d26(0x1070)+_0x1f2f5a[_0x224d26(0x13bc)]);}console['log']('✅\x20NAI图片'+(_0x1592ee+0x1)+_0x224d26(0x456)),_0x5a5c34['push'](_0x564cd8);}_0x5a51a6['imageUrls']=_0x5a5c34,_0x5a5c34[_0x224d26(0x9a1)]===0x1&&(_0x5a51a6[_0x224d26(0x6c6)]=_0x5a5c34[0x0]),_0x5a51a6[_0x224d26(0x9fd)]=_0x49b125[_0x224d26(0x9fd)],_0x5a51a6[_0x224d26(0xaf2)]=_0x5a5c34[_0x224d26(0x9a1)],console['log'](_0x224d26(0x857)+_0x5a5c34['length']+'张');}catch(_0x3fad7d){console['error'](_0x224d26(0x46f),_0x3fad7d),_0x5a51a6['content']=(_0x5a51a6[_0x224d26(0x1047)]||_0x5a51a6[_0x224d26(0x1202)]||'')+(_0x224d26(0xa87)+_0x3fad7d[_0x224d26(0x13bc)]+']');}await _0x5b9d83[_0x224d26(0xc7a)]['add'](_0x5a51a6),_0x3f09c8(_0x461b99+0x1);_0x989e86&&document[_0x224d26(0x2ec)](_0x224d26(0x11b2))[_0x224d26(0xff6)][_0x224d26(0xe9a)](_0x224d26(0xd43))&&await _0x472608();continue;case _0x224d26(0x357):{const _0x4d7320=await _0x5b9d83[_0x224d26(0xc7a)][_0x224d26(0x6b5)](parseInt(_0x49b125[_0x224d26(0xa53)]));if(_0x4d7320){if(!_0x4d7320[_0x224d26(0x8a4)])_0x4d7320[_0x224d26(0x8a4)]=[];const _0x2ba35f=_0x49b125['name']||_0x42a172['originalName'],_0x283741=(_0x13e663,_0x59009e=null,_0x228195=null)=>({'commenterName':_0x2ba35f,'text':_0x50f96e(_0x13e663,_0x42a172),'meaning':_0x59009e,'replyTo':_0x228195,'timestamp':Date[_0x224d26(0x487)]()});if(_0x49b125[_0x224d26(0x1011)]){const _0x5d60f6=_0x28f30a['userStickers'][_0x224d26(0x412)](_0x3879ed=>_0x3879ed['name']===_0x49b125[_0x224d26(0x1011)]);_0x5d60f6?_0x4d7320[_0x224d26(0x8a4)][_0x224d26(0x367)](_0x283741(_0x5d60f6[_0x224d26(0x6d1)],_0x5d60f6['name'],_0x49b125[_0x224d26(0x2f2)]||null)):(console['warn']('AI\x20尝试评论一个不存在的表情:\x20\x22'+_0x49b125[_0x224d26(0x1011)]+'\x22'),_0x4d7320['comments'][_0x224d26(0x367)](_0x283741('[表情:\x20'+_0x49b125['stickerMeaning']+']',null,_0x49b125[_0x224d26(0x2f2)]||null)));}else{if(Array['isArray'](_0x49b125['comments']))_0x49b125[_0x224d26(0x8a4)]['forEach'](_0x100d14=>{const _0x52cc9e=_0x224d26;typeof _0x100d14===_0x52cc9e(0x863)&&_0x100d14['trim']()&&_0x4d7320[_0x52cc9e(0x8a4)][_0x52cc9e(0x367)](_0x283741(_0x100d14,null,_0x49b125[_0x52cc9e(0x2f2)]||null));});else typeof _0x49b125[_0x224d26(0x14ff)]===_0x224d26(0x863)&&_0x49b125['commentText']['trim']()&&_0x4d7320[_0x224d26(0x8a4)][_0x224d26(0x367)](_0x283741(_0x49b125['commentText'],null,_0x49b125[_0x224d26(0x2f2)]||null));}await _0x5b9d83[_0x224d26(0xc7a)][_0x224d26(0x130a)](_0x4d7320['id'],{'comments':_0x4d7320[_0x224d26(0x8a4)]}),_0x3f09c8(_0x461b99+0x1),console['log'](_0x224d26(0x490)+_0x42a172[_0x224d26(0xe36)]+_0x224d26(0xa1f)+_0x49b125[_0x224d26(0xa53)]);if(!_0x42a172['commentCooldowns'])_0x42a172[_0x224d26(0x229)]={};_0x42a172[_0x224d26(0x229)][_0x49b125['postId']]=Date[_0x224d26(0x487)]();}continue;}case'qzone_like':const _0x513524=await _0x5b9d83['qzonePosts'][_0x224d26(0x6b5)](parseInt(_0x49b125[_0x224d26(0xa53)]));if(_0x513524){if(!_0x513524[_0x224d26(0x12b3)])_0x513524[_0x224d26(0x12b3)]=[];!_0x513524[_0x224d26(0x12b3)]['includes'](_0x42a172[_0x224d26(0xe36)])&&(_0x513524[_0x224d26(0x12b3)]['push'](_0x42a172['name']),await _0x5b9d83[_0x224d26(0xc7a)]['update'](_0x513524['id'],{'likes':_0x513524[_0x224d26(0x12b3)]}),_0x3f09c8(_0x461b99+0x1),_0x989e86&&document[_0x224d26(0x2ec)](_0x224d26(0x11b2))[_0x224d26(0xff6)][_0x224d26(0xe9a)]('active')&&await _0x472608());}continue;case _0x224d26(0x11d5):{const _0x1b3040=await _0x5b9d83[_0x224d26(0xc7a)][_0x224d26(0x6b5)](parseInt(_0x49b125[_0x224d26(0xa53)]));if(_0x1b3040){const _0xb011db={'type':_0x224d26(0x11d5),'timestamp':Date[_0x224d26(0x487)](),'authorId':_0x4538fd,'authorGroupId':_0x42a172[_0x224d26(0x1542)],'repostComment':_0x49b125[_0x224d26(0x70d)]||'','originalPost':_0x1b3040,'visibleGroupIds':null};await _0x5b9d83[_0x224d26(0xc7a)][_0x224d26(0xe82)](_0xb011db),_0x3f09c8(_0x461b99+0x1),console[_0x224d26(0x415)](_0x224d26(0x490)+_0x42a172[_0x224d26(0xe36)]+_0x224d26(0x1335)+_0x49b125[_0x224d26(0xa53)]);}continue;}case _0x224d26(0x11ce):!_0x20bfc1[_0x224d26(0xffc)]&&!_0x20bfc1[_0x224d26(0x122a)]&&(_0x28f30a[_0x224d26(0x11b9)]=_0x4538fd,_0x20bfc1[_0x224d26(0x11b9)]=_0x4538fd,_0x20bfc1[_0x224d26(0x122a)]=!![],_0x20bfc1[_0x224d26(0x131e)]=_0x42a172[_0x224d26(0x1423)],_0x20bfc1[_0x224d26(0x2bb)]=_0x49b125[_0x224d26(0xe36)]||_0x42a172[_0x224d26(0xe36)],_0x19c8ce());continue;case _0x224d26(0x230):!_0x20bfc1[_0x224d26(0xffc)]&&!_0x20bfc1[_0x224d26(0x122a)]&&(_0x28f30a['activeChatId']=_0x4538fd,_0x20bfc1['isAwaitingResponse']=!![],_0x20bfc1[_0x224d26(0x131e)]=!![],_0x20bfc1[_0x224d26(0xb3c)]='ai',_0x20bfc1[_0x224d26(0x2bb)]=_0x49b125[_0x224d26(0xe36)],_0x19c8ce());continue;case _0x224d26(0xd0a):let _0x37a22d;if(_0x42a172[_0x224d26(0x1423)]){const _0x11bd4b=_0x42a172[_0x224d26(0x10f2)][_0x224d26(0x412)](_0x346c94=>_0x346c94[_0x224d26(0x66c)]===_0x49b125[_0x224d26(0xe36)]);_0x37a22d=_0x11bd4b?_0x11bd4b[_0x224d26(0x8a8)]:_0x49b125['name'];}else _0x37a22d=_0x42a172[_0x224d26(0xe36)];const _0x32f99e=_0x49b125['suffix']?'\x20'+_0x49b125[_0x224d26(0x777)][_0x224d26(0x97e)]():'',_0x3db6fa=_0x37a22d+_0x224d26(0xc7b)+_0x32f99e,_0x31c733={'role':'system','type':_0x224d26(0x10aa),'content':_0x3db6fa,'timestamp':Date['now']()};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x31c733);if(_0x989e86){const _0x3499f5=document[_0x224d26(0x2ec)](_0x224d26(0x1007));_0x3499f5[_0x224d26(0xff6)][_0x224d26(0x1424)](_0x224d26(0x714)),void _0x3499f5[_0x224d26(0x144c)],_0x3499f5[_0x224d26(0xff6)]['add'](_0x224d26(0x714)),setTimeout(()=>_0x3499f5[_0x224d26(0xff6)]['remove'](_0x224d26(0x714)),0x1f4),_0x4cc03e(_0x31c733,_0x42a172);}else _0x1c12fe(_0x4538fd,_0x3db6fa);continue;case _0x224d26(0x414):_0x42a172[_0x224d26(0x2a3)][_0x224d26(0x10ca)]=_0x49b125[_0x224d26(0xfb1)],_0x42a172['status'][_0x224d26(0x14f9)]=_0x49b125['is_busy']||![],_0x42a172['status'][_0x224d26(0x80f)]=Date['now']();const _0x49b948={'role':_0x224d26(0x10a7),'type':_0x224d26(0x10aa),'content':'['+_0x42a172[_0x224d26(0xe36)]+_0x224d26(0x3d4)+_0x49b125[_0x224d26(0xfb1)]+']','timestamp':Date[_0x224d26(0x487)]()};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x49b948);_0x989e86&&_0x4cc03e(_0x49b948,_0x42a172);_0x5db8a3();continue;case _0x224d26(0xae7):_0x1b55a4={..._0x57b2dc,'type':'location_share','content':_0x49b125[_0x224d26(0x1047)]};break;case _0x224d26(0xf07):if(_0x79cac3['isActive']&&_0x79cac3['activeChatId']===_0x4538fd){const _0x5eada8=_0x49b125[_0x224d26(0x35e)]||_0x49b125[_0x224d26(0x782)]||_0x49b125[_0x224d26(0xe36)];if(typeof _0x5eada8===_0x224d26(0x863)&&_0x5eada8[_0x224d26(0x97e)]()){const _0x3a8b60=_0x5eada8['replace'](/^\[?\d+\]?[\s.-]*/,'')[_0x224d26(0x97e)](),_0x35354a=_0x79cac3[_0x224d26(0x5fd)][_0x224d26(0x535)](_0x4e4d57=>_0x4e4d57[_0x224d26(0xe36)][_0x224d26(0x1430)]()===_0x3a8b60[_0x224d26(0x1430)]());if(_0x35354a>-0x1){_0x144635(_0x35354a);const _0x234827=_0x79cac3['playlist'][_0x35354a];let _0x1f06e2;if(_0x42a172[_0x224d26(0x1423)]){const _0x2d490d=_0x42a172[_0x224d26(0x10f2)][_0x224d26(0x412)](_0x2d3bde=>_0x2d3bde[_0x224d26(0x66c)]===_0x49b125['name']);_0x1f06e2=_0x2d490d?_0x2d490d[_0x224d26(0x8a8)]:_0x49b125[_0x224d26(0xe36)];}else _0x1f06e2=_0x42a172['name'];const _0x5e4c50={'role':_0x224d26(0x10a7),'type':_0x224d26(0x10aa),'content':_0x224d26(0x2cb)+_0x1f06e2+_0x224d26(0x1222)+_0x234827[_0x224d26(0xe36)]+'》\x20-\x20'+_0x234827[_0x224d26(0x139f)]+']','timestamp':Date[_0x224d26(0x487)]()};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x5e4c50),_0x989e86&&_0x4cc03e(_0x5e4c50,_0x42a172);}else console[_0x224d26(0x664)](_0x224d26(0x6d7)+_0x5eada8+_0x224d26(0xdd7)+_0x3a8b60+_0x224d26(0x125d));}else console[_0x224d26(0x1518)]('AI返回的change_music指令中，歌曲名无效或缺失:',_0x49b125);}continue;case _0x224d26(0xa37):const _0x3faae7={'chatId':_0x4538fd,'authorId':_0x4538fd,'description':_0x49b125['description'],'timestamp':Date[_0x224d26(0x487)](),'type':'ai_generated'};await _0x5b9d83[_0x224d26(0xf49)][_0x224d26(0xe82)](_0x3faae7),console[_0x224d26(0x415)](_0x224d26(0xa5f)+_0x42a172[_0x224d26(0xe36)]+_0x224d26(0xe9b),_0x49b125['description']);continue;case _0x224d26(0x1204):const _0x381cb3=new Date(_0x49b125[_0x224d26(0xc04)]);if(!isNaN(_0x381cb3)&&_0x381cb3>new Date()){const _0x429f06={'chatId':_0x4538fd,'authorId':_0x4538fd,'description':_0x49b125[_0x224d26(0x141e)],'timestamp':Date[_0x224d26(0x487)](),'type':_0x224d26(0x975),'targetDate':_0x381cb3['getTime']()};await _0x5b9d83[_0x224d26(0xf49)][_0x224d26(0xe82)](_0x429f06),console[_0x224d26(0x415)](_0x224d26(0xa5f)+_0x42a172['name']+_0x224d26(0x1352),_0x49b125[_0x224d26(0x141e)]);}continue;case _0x224d26(0xe80):if(!_0x42a172[_0x224d26(0x1423)]){_0x42a172['relationship'][_0x224d26(0x2a3)]=_0x224d26(0x56f);const _0x43874f={'role':_0x224d26(0x10a7),'content':'[系统提示：你刚刚主动拉黑了用户。]','timestamp':Date[_0x224d26(0x487)](),'isHidden':!![]};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x43874f),await _0x5b9d83['chats'][_0x224d26(0x7c3)](_0x42a172);_0x989e86&&_0xc55746(_0x4538fd);_0x5db8a3();break;}continue;case _0x224d26(0x11f7):!_0x42a172[_0x224d26(0x1423)]&&_0x42a172[_0x224d26(0xaf4)]?.[_0x224d26(0x2a3)]===_0x224d26(0x890)&&(_0x49b125[_0x224d26(0x531)]===_0x224d26(0xf7c)?(_0x42a172[_0x224d26(0xaf4)][_0x224d26(0x2a3)]='friend',_0x1b55a4={..._0x57b2dc,'content':_0x224d26(0xdb5)}):(_0x42a172[_0x224d26(0xaf4)][_0x224d26(0x2a3)]='blocked_by_ai',_0x1b55a4={..._0x57b2dc,'content':'抱歉，我拒绝了你的好友申请。'}),_0x42a172[_0x224d26(0xaf4)][_0x224d26(0x2d1)]='');break;case _0x224d26(0xc2c):const _0x4f2d28=typeof _0x49b125['options']===_0x224d26(0x863)?_0x49b125[_0x224d26(0x793)]['split']('\x0a')['filter'](_0x2cbb52=>_0x2cbb52[_0x224d26(0x97e)]()):Array[_0x224d26(0x624)](_0x49b125[_0x224d26(0x793)])?_0x49b125['options']:[];if(_0x4f2d28['length']<0x2)continue;_0x1b55a4={..._0x57b2dc,'type':_0x224d26(0xc2c),'question':_0x49b125[_0x224d26(0x7f0)],'options':_0x4f2d28,'votes':{},'isClosed':![]};break;case _0x224d26(0x43e):{const {itemName:_0x5e8198,itemPrice:_0xbf2385,image_prompt:_0x2dc863}=_0x49b125;if(_0x5e8198&&!isNaN(parseFloat(_0xbf2385))&&_0x2dc863){const _0x5d8c0a=_0x224d26(0x6d0)+encodeURIComponent(_0x2dc863);_0x1b55a4={..._0x57b2dc,'type':_0x224d26(0x43e),'items':[{'name':_0x5e8198,'price':parseFloat(_0xbf2385),'imageUrl':_0x5d8c0a,'quantity':0x1}],'total':parseFloat(_0xbf2385),'recipients':_0x49b125[_0x224d26(0x9e5)]||null};}else console[_0x224d26(0x664)](_0x224d26(0x807),_0x49b125);break;}case _0x224d26(0x2e2):const _0x2e7f16=_0x42a172['history']['find'](_0x54b7d9=>_0x54b7d9[_0x224d26(0x69a)]===_0x49b125['poll_timestamp']);_0x2e7f16&&!_0x2e7f16[_0x224d26(0xd1b)]&&(Object['keys'](_0x2e7f16[_0x224d26(0x7ba)])['forEach'](_0x5f1f5f=>{const _0xc074f1=_0x224d26,_0x5b6133=_0x2e7f16['votes'][_0x5f1f5f]['indexOf'](_0x49b125[_0xc074f1(0xe36)]);_0x5b6133>-0x1&&_0x2e7f16[_0xc074f1(0x7ba)][_0x5f1f5f][_0xc074f1(0x510)](_0x5b6133,0x1);}),!_0x2e7f16['votes'][_0x49b125[_0x224d26(0x75f)]]&&(_0x2e7f16['votes'][_0x49b125[_0x224d26(0x75f)]]=[]),!_0x2e7f16['votes'][_0x49b125[_0x224d26(0x75f)]][_0x224d26(0x138a)](_0x49b125[_0x224d26(0xe36)])&&_0x2e7f16[_0x224d26(0x7ba)][_0x49b125[_0x224d26(0x75f)]][_0x224d26(0x367)](_0x49b125[_0x224d26(0xe36)]),_0x989e86&&_0xc55746(_0x4538fd));continue;case _0x224d26(0x512):_0x1b55a4={..._0x57b2dc,..._0x49b125,'totalAmount':_0x49b125[_0x224d26(0x257)],'claimedBy':{},'isFullyClaimed':![]};_0x49b125[_0x224d26(0xce3)]&&(_0x1b55a4['receiverName']=_0x49b125['receiver'],delete _0x1b55a4[_0x224d26(0xce3)]);break;case'open_red_packet':const _0x31affc=_0x42a172[_0x224d26(0x12c3)]['find'](_0x31d4a5=>_0x31d4a5[_0x224d26(0x69a)]===_0x49b125[_0x224d26(0xafa)]),_0x551b40=_0x49b125[_0x224d26(0xe36)],_0x1dc7ce=_0x42a172[_0x224d26(0x10f2)][_0x224d26(0x7e2)](_0x36d7e3=>_0x36d7e3['originalName']===_0x551b40);if(!_0x1dc7ce){console[_0x224d26(0x664)](_0x224d26(0xa6f)+_0x551b40+_0x224d26(0x358));continue;}if(_0x31affc&&_0x31affc[_0x224d26(0x110b)]===_0x224d26(0x43c)){if(_0x31affc[_0x224d26(0x61c)]!==_0x49b125[_0x224d26(0xe36)]){console[_0x224d26(0x664)](_0x224d26(0xa6f)+_0x49b125['name']+_0x224d26(0x7da)+_0x31affc['receiverName']+_0x224d26(0x1442));continue;}}if(_0x31affc&&!_0x31affc[_0x224d26(0x1410)]&&!(_0x31affc['claimedBy']&&_0x31affc['claimedBy'][_0x49b125[_0x224d26(0xe36)]])){let _0x530e89=0x0;const _0x34cf64=_0x31affc[_0x224d26(0x40b)]-Object['values'](_0x31affc[_0x224d26(0x13b7)]||{})['reduce']((_0x52a7dc,_0x43793b)=>_0x52a7dc+_0x43793b,0x0),_0x3fc415=_0x31affc['count']-Object[_0x224d26(0xf6b)](_0x31affc[_0x224d26(0x13b7)]||{})['length'];if(_0x3fc415>0x0){if(_0x31affc[_0x224d26(0x110b)]===_0x224d26(0x43c))_0x530e89=_0x31affc['totalAmount'];else{if(_0x3fc415===0x1)_0x530e89=_0x34cf64;else{const _0x58127d=0.01,_0x2cd9e3=_0x34cf64-(_0x3fc415-0x1)*_0x58127d;_0x530e89=Math[_0x224d26(0x1337)]()*(_0x2cd9e3-_0x58127d)+_0x58127d;}}_0x530e89=parseFloat(_0x530e89[_0x224d26(0x5c3)](0x2));if(!_0x31affc[_0x224d26(0x13b7)])_0x31affc['claimedBy']={};_0x31affc[_0x224d26(0x13b7)][_0x49b125[_0x224d26(0xe36)]]=_0x530e89;const _0x5e68c5=_0x42a172[_0x224d26(0x10f2)][_0x224d26(0x412)](_0x1c653c=>_0x1c653c[_0x224d26(0x66c)]===_0x49b125[_0x224d26(0xe36)]),_0x580e3d=_0x5e68c5?_0x5e68c5['groupNickname']:_0x49b125['name'],_0x1e7e10=_0x4f967c(_0x42a172,_0x31affc[_0x224d26(0x1361)]),_0x17230d={'role':'system','type':_0x224d26(0x10aa),'content':_0x580e3d+'\x20领取了\x20'+_0x1e7e10+_0x224d26(0xd77),'timestamp':Date[_0x224d26(0x487)]()};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x17230d);let _0x4b2be4=_0x224d26(0x319)+_0x580e3d+_0x224d26(0xee9)+_0x530e89[_0x224d26(0x5c3)](0x2)+_0x224d26(0xd10);if(Object['keys'](_0x31affc['claimedBy'])[_0x224d26(0x9a1)]>=_0x31affc['count']){_0x31affc[_0x224d26(0x1410)]=!![];const _0xc6454b={'role':'system','type':'pat_message','content':_0x1e7e10+_0x224d26(0x12a5),'timestamp':Date[_0x224d26(0x487)]()+0x1};_0x42a172['history'][_0x224d26(0x367)](_0xc6454b);let _0x7b8ccc={'name':'','amount':-0x1};_0x31affc['packetType']==='lucky'&&_0x31affc[_0x224d26(0xdd4)]>0x1&&Object[_0x224d26(0x127b)](_0x31affc['claimedBy'])[_0x224d26(0xf99)](([_0x253948,_0x2042ee])=>{const _0x21c820=_0x224d26;_0x2042ee>_0x7b8ccc[_0x21c820(0x257)]&&(_0x7b8ccc={'name':_0x253948,'amount':_0x2042ee});});if(_0x7b8ccc[_0x224d26(0xe36)]){const _0x1a1c23=_0x42a172[_0x224d26(0x10f2)][_0x224d26(0x412)](_0x16a96d=>_0x16a96d[_0x224d26(0x66c)]===_0x7b8ccc[_0x224d26(0xe36)]),_0x679bd5=_0x1a1c23?_0x1a1c23['groupNickname']:_0x7b8ccc['name'];_0x4b2be4+=_0x224d26(0x118d)+_0x679bd5+'！';}else _0x4b2be4+=_0x224d26(0x927);}_0x4b2be4+=_0x224d26(0x463);const _0x13fe65={'role':'system','content':_0x4b2be4,'timestamp':Date[_0x224d26(0x487)]()+0x2,'isHidden':!![]};_0x42a172[_0x224d26(0x12c3)]['push'](_0x13fe65);}_0x989e86&&(_0xc55746(_0x4538fd),_0x5db8a3());}continue;case _0x224d26(0x142f):{const _0x48871c=_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x535)](_0x44efe1=>_0x44efe1[_0x224d26(0x69a)]===_0x49b125[_0x224d26(0x14aa)]);if(_0x48871c>-0x1){const _0x2513c5=_0x42a172[_0x224d26(0x12c3)][_0x48871c];_0x2513c5[_0x224d26(0x2a3)]='accepted';}continue;}case'decline_transfer':{const _0x50ab7d=_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x535)](_0x5991e6=>_0x5991e6[_0x224d26(0x69a)]===_0x49b125['for_timestamp']);if(_0x50ab7d>-0x1){const _0x1e1ca1=_0x42a172[_0x224d26(0x12c3)][_0x50ab7d];_0x1e1ca1[_0x224d26(0x2a3)]=_0x224d26(0x757);const _0x156538={'role':_0x224d26(0x6d9),'senderName':_0x42a172[_0x224d26(0xe36)],'type':_0x224d26(0x277),'isRefund':!![],'amount':_0x1e1ca1[_0x224d26(0x257)],'note':_0x224d26(0x492),'timestamp':_0x3271f4++};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x156538),_0x989e86&&(_0x4cc03e(_0x156538,_0x42a172),_0xc55746(_0x4538fd));}continue;}case _0x224d26(0x5cb):if(_0x42a172['isGroup']&&_0x49b125['new_name']){const _0x3f1c36=_0x49b125[_0x224d26(0x480)]['trim'](),_0x3bf768=_0x42a172[_0x224d26(0x10f2)][_0x224d26(0x11c6)](_0x15db0b=>_0x15db0b['originalName']);if(_0x3bf768[_0x224d26(0x138a)](_0x3f1c36)){console[_0x224d26(0x664)]('AI\x20('+_0x49b125['name']+_0x224d26(0xfb0)+_0x3f1c36+_0x224d26(0x73a));continue;}_0x42a172[_0x224d26(0xe36)]=_0x3f1c36;const _0x48669d=_0x42a172[_0x224d26(0x10f2)][_0x224d26(0x412)](_0xb96fa=>_0xb96fa[_0x224d26(0x66c)]===_0x49b125[_0x224d26(0xe36)]),_0x3c626d=_0x48669d?_0x48669d[_0x224d26(0x8a8)]:_0x49b125[_0x224d26(0xe36)],_0x34f82f={'role':'system','type':_0x224d26(0x10aa),'content':_0x3c626d+_0x224d26(0xbba)+_0x42a172[_0x224d26(0xe36)]+'”','timestamp':_0x3271f4++};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x34f82f),_0x989e86&&(_0x4cc03e(_0x34f82f,_0x42a172),document[_0x224d26(0x2ec)](_0x224d26(0x96a))[_0x224d26(0x15f)]=_0x42a172['name']);}continue;case'change_remark_name':if(!_0x42a172[_0x224d26(0x1423)]&&_0x49b125[_0x224d26(0x480)]){const _0x477f9b=_0x42a172[_0x224d26(0xe36)],_0x684c7e=_0x49b125[_0x224d26(0x480)][_0x224d26(0x97e)]();if(_0x684c7e&&_0x684c7e!==_0x477f9b){!_0x42a172['nameHistory']&&(_0x42a172[_0x224d26(0x316)]=[]);!_0x42a172[_0x224d26(0x316)][_0x224d26(0x138a)](_0x477f9b)&&_0x42a172[_0x224d26(0x316)][_0x224d26(0x367)](_0x477f9b);_0x42a172[_0x224d26(0xe36)]=_0x684c7e;const _0x52c43d={'role':_0x224d26(0x10a7),'type':_0x224d26(0x10aa),'content':'“'+_0x42a172[_0x224d26(0x66c)]+'”\x20将备注修改为\x20“'+_0x684c7e+'”','timestamp':_0x3271f4++};_0x42a172[_0x224d26(0x12c3)]['push'](_0x52c43d);const _0x3ab74a={'role':_0x224d26(0x10a7),'content':_0x224d26(0x5cd)+_0x684c7e+'”。请自然地接受这个新名字，不要对此感到惊讶。]','timestamp':_0x3271f4++,'isHidden':!![]};_0x42a172[_0x224d26(0x12c3)]['push'](_0x3ab74a),_0x989e86&&(_0x4cc03e(_0x52c43d,_0x42a172),document['getElementById'](_0x224d26(0x96a))[_0x224d26(0x15f)]=_0x684c7e),await _0x24e380(_0x42a172);}}continue;case _0x224d26(0x937):if(_0x42a172[_0x224d26(0x1423)]&&_0x49b125[_0x224d26(0xca7)]){const _0x31eace=_0x49b125['avatar_name'],_0x466f15=_0x42a172[_0x224d26(0x362)]['groupAvatarLibrary']||[],_0x1cdbcc=_0x466f15[_0x224d26(0x412)](_0x34bf9a=>_0x34bf9a[_0x224d26(0xe36)]===_0x31eace);if(_0x1cdbcc){_0x42a172[_0x224d26(0x362)][_0x224d26(0x42c)]=_0x1cdbcc['url'];const _0x3facd0=_0x42a172['members']['find'](_0x14890a=>_0x14890a[_0x224d26(0x66c)]===_0x49b125[_0x224d26(0xe36)]),_0x3c9ab6=_0x3facd0?_0x3facd0[_0x224d26(0x8a8)]:_0x49b125['name'],_0x37e91b={'role':'system','type':_0x224d26(0x10aa),'content':_0x3c9ab6+'\x20更换了群头像','timestamp':_0x3271f4++};_0x42a172[_0x224d26(0x12c3)][_0x224d26(0x367)](_0x37e91b),_0x989e86&&_0x4cc03e(_0x37e91b,_0x42a172);}else console[_0x224d26(0x664)]('AI\x20尝试使用一个不存在的群头像:\x20\x22'+_0x31eace+'\x22');}continue;case'system_message':_0x1b55a4={'role':'system','type':_0x224d26(0x10aa),'content':_0x49b125[_0x224d26(0x1047)],'timestamp':Date['now']()};break;case _0x224d26(0x9c6):_0x1b55a4={..._0x57b2dc,'type':'share_link','title':_0x49b125[_0x224d26(0x141e)],'description':_0x49b125[_0x224d26(0x9cc)],'source_name':_0x49b125[_0x224d26(0xedb)],'content':_0x49b125[_0x224d26(0x1047)]};break;case _0x224d26(0xec8):const _0x17bb6c=_0x42a172['history'][_0x224d26(0x412)](_0x365c03=>_0x365c03[_0x224d26(0x69a)]===_0x49b125[_0x224d26(0x111a)]);if(_0x17bb6c){const _0x1a4a29={'timestamp':_0x17bb6c['timestamp'],'senderName':_0x17bb6c['senderName']||(_0x17bb6c['role']===_0x224d26(0xcc9)?_0x42a172[_0x224d26(0x362)][_0x224d26(0xa28)]||'我':_0x42a172[_0x224d26(0xe36)]),'content':String(_0x17bb6c[_0x224d26(0x1047)]||'')[_0x224d26(0xa6b)](0x0,0x32)};_0x1b55a4={..._0x57b2dc,'content':_0x49b125['reply_content'],'quote':_0x1a4a29};}else _0x1b55a4={..._0x57b2dc,'content':_0x49b125[_0x224d26(0xf96)]};break;case _0x224d26(0x671):{if(!_0x989e86)continue;const _0x1d8123={..._0x57b2dc,'content':_0x49b125['content']},_0x12718b=_0x43f190(_0x1d8123,_0x42a172);_0x4cc03e(_0x1d8123,_0x42a172,!![]),await new Promise(_0x3fdba7=>setTimeout(_0x3fdba7,Math[_0x224d26(0x1337)]()*0x3e8+0x5dc));const _0xd3f2a=document['querySelector'](_0x224d26(0x84e)+_0x1d8123[_0x224d26(0x69a)]+'\x22]')?.['closest'](_0x224d26(0x1571));if(_0xd3f2a){_0xd3f2a['classList'][_0x224d26(0xe82)](_0x224d26(0x8e0)),await new Promise(_0x4e23d7=>setTimeout(_0x4e23d7,0x12c));const _0x3105c5={'role':_0x224d26(0x6d9),'senderName':_0x49b125[_0x224d26(0xe36)]||_0x42a172[_0x224d26(0xe36)],'type':_0x224d26(0xf2f),'content':_0x224d26(0x12d7),'timestamp':_0x1d8123['timestamp'],'recalledData':{'originalType':_0x224d26(0x10ca),'originalContent':_0x49b125[_0x224d26(0x1047)]}},_0x5a07eb=_0x42a172['history'][_0x224d26(0x535)](_0x1445a3=>_0x1445a3['timestamp']===_0x1d8123['timestamp']);_0x5a07eb>-0x1?_0x42a172[_0x224d26(0x12c3)][_0x5a07eb]=_0x3105c5:_0x42a172[_0x224d26(0x12c3)]['push'](_0x3105c5);const _0x1e81a8=await _0x43f190(_0x3105c5,_0x42a172);document['body'][_0x224d26(0xe9a)](_0xd3f2a)&&_0xd3f2a[_0x224d26(0x1092)]['replaceChild'](_0x1e81a8,_0xd3f2a);}continue;}case _0x224d26(0x10ca):_0x1b55a4={..._0x57b2dc,'content':String(_0x49b125[_0x224d26(0x1047)]||_0x49b125[_0x224d26(0x13bc)])};break;case _0x224d26(0x14f3):if(_0x49b125['meaning']){const _0x3ce3c9=_0x28f30a['userStickers']['find'](_0x25806f=>_0x25806f[_0x224d26(0xe36)]===_0x49b125[_0x224d26(0x1488)]);_0x3ce3c9?_0x1b55a4={..._0x57b2dc,'type':_0x224d26(0x14f3),'content':_0x3ce3c9['url'],'meaning':_0x3ce3c9[_0x224d26(0xe36)]}:(console['warn'](_0x224d26(0x440)+_0x49b125['meaning']+'\x22'),_0x1b55a4={..._0x57b2dc,'type':'text','content':_0x224d26(0x4f3)+_0x49b125['meaning']+']'});}else console['warn'](_0x224d26(0x10ed),_0x49b125),_0x1b55a4={..._0x57b2dc,'type':_0x224d26(0x14f3),'content':_0x49b125[_0x224d26(0x6d1)],'meaning':'未知表情'};break;case _0x224d26(0x11c7):_0x1b55a4={..._0x57b2dc,'type':_0x224d26(0x11c7),'content':_0x49b125[_0x224d26(0x9cc)],'image_prompt':_0x49b125[_0x224d26(0xe8f)]};break;case _0x224d26(0x8bc):_0x1b55a4={..._0x57b2dc,'type':_0x224d26(0x8bc),'content':_0x49b125[_0x224d26(0x1047)]};break;case _0x224d26(0x277):_0x1b55a4={..._0x57b2dc,'type':_0x224d26(0x277),'amount':_0x49b125['amount'],'note':_0x49b125[_0x224d26(0x1333)],'receiverName':_0x49b125[_0x224d26(0xce3)]||'我'};break;case _0x224d26(0x12d5):_0x1b55a4={..._0x57b2dc,'type':_0x224d26(0x12d5),'productInfo':_0x49b125[_0x224d26(0xa89)],'amount':_0x49b125[_0x224d26(0x257)],'status':_0x224d26(0x8c9),'countdownEndTime':Date[_0x224d26(0x487)]()+0xf*0x3c*0x3e8};break;case _0x224d26(0xea9):_0x1b55a4={..._0x57b2dc,'type':'waimai_order','productInfo':_0x49b125[_0x224d26(0xa89)],'amount':_0x49b125[_0x224d26(0x257)],'greeting':_0x49b125[_0x224d26(0x234)],'recipientName':_0x49b125[_0x224d26(0xa9c)]||null};break;case _0x224d26(0x6fb):_0x1b55a4={..._0x57b2dc,..._0x49b125};break;case _0x224d26(0xd92):try{console['log'](_0x224d26(0x153e),_0x49b125[_0x224d26(0x9fd)]);const _0x3abc27=_0x7da453(_0x42a172['id']),_0x44b954=_0x49b125[_0x224d26(0x9fd)]||_0x224d26(0x1163),_0x348328=_0x44b954+',\x20'+_0x3abc27[_0x224d26(0x7c7)],_0x5d6dd4=_0x3abc27[_0x224d26(0x1378)];console[_0x224d26(0x415)](_0x224d26(0xdfd)+(_0x3abc27[_0x224d26(0x5c7)]===_0x224d26(0x8e7)?_0x224d26(0xd23):'系统')+_0x224d26(0x10d5)),console[_0x224d26(0x415)]('最终正面提示词:',_0x348328),console[_0x224d26(0x415)](_0x224d26(0x8ee),_0x5d6dd4);const _0x224923=localStorage['getItem'](_0x224d26(0x5da)),_0x2cf4f1=localStorage[_0x224d26(0x11c3)](_0x224d26(0x13f6))||_0x224d26(0xb6c),_0x58ee4b=_0x4cb256();if(!_0x224923)throw new Error(_0x224d26(0x2d0));const [_0x47bc41,_0x150308]=_0x58ee4b[_0x224d26(0x121b)][_0x224d26(0xa8a)]('x')['map'](Number);let _0x247cef;_0x2cf4f1[_0x224d26(0x138a)](_0x224d26(0x12b4))?_0x247cef={'input':_0x348328,'model':_0x2cf4f1,'action':_0x224d26(0x13ca),'parameters':{'params_version':0x3,'width':_0x47bc41,'height':_0x150308,'scale':_0x58ee4b['cfg_scale'],'sampler':_0x58ee4b[_0x224d26(0x46a)],'steps':_0x58ee4b[_0x224d26(0xd22)],'seed':_0x58ee4b[_0x224d26(0x634)]===-0x1?Math[_0x224d26(0x5f8)](Math['random']()*0x2540be3ff):_0x58ee4b['seed'],'n_samples':0x1,'ucPreset':_0x58ee4b[_0x224d26(0xc05)],'qualityToggle':_0x58ee4b['quality_toggle'],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x224d26(0xcc4),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x348328,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x5d6dd4,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x5d6dd4,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x247cef={'input':_0x348328,'model':_0x2cf4f1,'action':_0x224d26(0x13ca),'parameters':{'width':_0x47bc41,'height':_0x150308,'scale':_0x58ee4b[_0x224d26(0xb42)],'sampler':_0x58ee4b['sampler'],'steps':_0x58ee4b['steps'],'seed':_0x58ee4b[_0x224d26(0x634)]===-0x1?Math[_0x224d26(0x5f8)](Math[_0x224d26(0x1337)]()*0x2540be3ff):_0x58ee4b[_0x224d26(0x634)],'n_samples':0x1,'ucPreset':_0x58ee4b[_0x224d26(0xc05)],'qualityToggle':_0x58ee4b[_0x224d26(0xf9e)],'sm':_0x58ee4b[_0x224d26(0x805)],'sm_dyn':_0x58ee4b[_0x224d26(0xd60)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x224d26(0xc6b),'negative_prompt':_0x5d6dd4}};console['log']('🚀\x20发送NAI请求:',_0x247cef);let _0x1123bd;_0x2cf4f1[_0x224d26(0x138a)]('nai-diffusion-4')?_0x1123bd=_0x224d26(0x132d):_0x1123bd=_0x224d26(0xf02);let _0x42e98b=_0x58ee4b[_0x224d26(0x9c0)];_0x42e98b===_0x224d26(0x1334)&&(_0x42e98b=_0x58ee4b[_0x224d26(0xb73)]||'');_0x42e98b&&_0x42e98b!==''&&(_0x1123bd=_0x42e98b+encodeURIComponent(_0x1123bd));const _0x8dbc44=await fetch(_0x1123bd,{'method':_0x224d26(0x655),'headers':{'Content-Type':_0x224d26(0x1446),'Authorization':_0x224d26(0xe83)+_0x224923},'body':JSON[_0x224d26(0xe4d)](_0x247cef)});console[_0x224d26(0x415)](_0x224d26(0x8ad),_0x8dbc44[_0x224d26(0x2a3)]),console[_0x224d26(0x415)](_0x224d26(0x222),[..._0x8dbc44[_0x224d26(0x79a)][_0x224d26(0x127b)]()]);if(!_0x8dbc44['ok']){const _0x1136bd=await _0x8dbc44[_0x224d26(0x10ca)]();console[_0x224d26(0x1518)]('API错误响应:',_0x1136bd);throw new Error('API请求失败\x20('+_0x8dbc44['status']+'):\x20'+_0x1136bd);}const _0x4e2aab=_0x8dbc44[_0x224d26(0x79a)][_0x224d26(0x6b5)](_0x224d26(0x2ed));console[_0x224d26(0x415)](_0x224d26(0x526),_0x4e2aab);let _0x13cf19,_0xe56f91;if(_0x4e2aab&&_0x4e2aab[_0x224d26(0x138a)]('text/event-stream')){console[_0x224d26(0x415)]('检测到\x20SSE\x20流式响应，开始解析...');const _0x1b8ff6=await _0x8dbc44[_0x224d26(0x10ca)]();console[_0x224d26(0x415)](_0x224d26(0xf62),_0x1b8ff6[_0x224d26(0x9a1)]);const _0x27ff91=_0x1b8ff6[_0x224d26(0x97e)]()[_0x224d26(0xa8a)]('\x0a');let _0x1806a0=null;for(let _0x4d9d18=_0x27ff91[_0x224d26(0x9a1)]-0x1;_0x4d9d18>=0x0;_0x4d9d18--){const _0x4a0caa=_0x27ff91[_0x4d9d18][_0x224d26(0x97e)]();if(_0x4a0caa[_0x224d26(0x741)]('data:\x20')&&_0x4a0caa!==_0x224d26(0xfdc)){const _0x183a4e=_0x4a0caa[_0x224d26(0xa6b)](0x6);try{const _0x4a158e=JSON['parse'](_0x183a4e);if(_0x4a158e[_0x224d26(0x81b)]===_0x224d26(0x186)&&_0x4a158e['image']){_0x1806a0=_0x4a158e[_0x224d26(0x9e6)],console[_0x224d26(0x415)](_0x224d26(0x1a5));break;}if(_0x4a158e['data']){_0x1806a0=_0x4a158e[_0x224d26(0x1418)],console['log']('从\x20JSON.data\x20中提取图片数据');break;}if(_0x4a158e[_0x224d26(0x9e6)]){_0x1806a0=_0x4a158e[_0x224d26(0x9e6)],console[_0x224d26(0x415)]('从\x20JSON.image\x20中提取图片数据');break;}}catch(_0x27278a){_0x1806a0=_0x183a4e,console[_0x224d26(0x415)](_0x224d26(0xb3a));break;}}}if(!_0x1806a0)throw new Error(_0x224d26(0xb2d));const _0x5486f5=_0x1806a0['startsWith'](_0x224d26(0xed9)),_0x3a19f0=_0x1806a0[_0x224d26(0x741)](_0x224d26(0x5d4));if(_0x5486f5||_0x3a19f0){console[_0x224d26(0x415)](_0x224d26(0xa6a));const _0x24173f=atob(_0x1806a0),_0x587741=new Uint8Array(_0x24173f[_0x224d26(0x9a1)]);for(let _0x31d4f6=0x0;_0x31d4f6<_0x24173f['length'];_0x31d4f6++){_0x587741[_0x31d4f6]=_0x24173f['charCodeAt'](_0x31d4f6);}const _0x416254=new Blob([_0x587741],{'type':_0x5486f5?_0x224d26(0xca9):_0x224d26(0xf4b)});console[_0x224d26(0x415)]('图片\x20Blob\x20创建成功，大小:',_0x416254['size']);const _0x17cc4f=new FileReader();_0xe56f91=await new Promise((_0x156937,_0x597f1d)=>{const _0x2b9698=_0x224d26;_0x17cc4f['onloadend']=()=>_0x156937(_0x17cc4f[_0x2b9698(0x42a)]),_0x17cc4f[_0x2b9698(0x125a)]=_0x597f1d,_0x17cc4f[_0x2b9698(0x60e)](_0x416254);}),console['log'](_0x224d26(0xd7d));}else{console[_0x224d26(0x415)](_0x224d26(0x1db));const _0x1633d5=atob(_0x1806a0),_0x42fa06=new Uint8Array(_0x1633d5[_0x224d26(0x9a1)]);for(let _0x616b4e=0x0;_0x616b4e<_0x1633d5[_0x224d26(0x9a1)];_0x616b4e++){_0x42fa06[_0x616b4e]=_0x1633d5['charCodeAt'](_0x616b4e);}_0x13cf19=new Blob([_0x42fa06]),console[_0x224d26(0x415)](_0x224d26(0xe9d),_0x13cf19[_0x224d26(0x2d2)]);}}else _0x13cf19=await _0x8dbc44['blob'](),console['log'](_0x224d26(0x318),_0x13cf19[_0x224d26(0xb4b)],'大小:',_0x13cf19[_0x224d26(0x2d2)]);if(!_0xe56f91&&_0x13cf19)try{if(typeof JSZip===_0x224d26(0xe40))throw new Error(_0x224d26(0x368));const _0x379f09=await JSZip[_0x224d26(0xeab)](_0x13cf19);console['log']('ZIP文件内容:',Object['keys'](_0x379f09[_0x224d26(0x8d6)]));let _0x3d387d=null;for(let _0x4d1d66 in _0x379f09[_0x224d26(0x8d6)]){if(_0x4d1d66[_0x224d26(0x49a)](/\.(png|jpg|jpeg|webp)$/i)){_0x3d387d=_0x379f09[_0x224d26(0x8d6)][_0x4d1d66],console[_0x224d26(0x415)](_0x224d26(0x26f),_0x4d1d66);break;}}if(!_0x3d387d)throw new Error(_0x224d26(0x6fc));const _0x58708a=await _0x3d387d[_0x224d26(0x138d)](_0x224d26(0x465));console['log']('提取的图片大小:',_0x58708a[_0x224d26(0x2d2)]);const _0xcd9cbf=new FileReader();_0xe56f91=await new Promise((_0x3b6fe6,_0xbf34c1)=>{const _0x336bfe=_0x224d26;_0xcd9cbf['onloadend']=()=>_0x3b6fe6(_0xcd9cbf['result']),_0xcd9cbf[_0x336bfe(0x125a)]=_0xbf34c1,_0xcd9cbf[_0x336bfe(0x60e)](_0x58708a);}),console[_0x224d26(0x415)](_0x224d26(0xb9b));}catch(_0x18fea5){console[_0x224d26(0x1518)](_0x224d26(0x13b1),_0x18fea5);throw new Error(_0x224d26(0x1070)+_0x18fea5[_0x224d26(0x13bc)]);}console[_0x224d26(0x415)](_0x224d26(0xfa5)),_0x1b55a4={..._0x57b2dc,'type':_0x224d26(0xd92),'imageUrl':_0xe56f91,'prompt':_0x44b954,'fullPrompt':_0x348328};}catch(_0x51652e){console[_0x224d26(0x1518)]('❌\x20NAI图片生成失败:',_0x51652e),_0x1b55a4={..._0x57b2dc,'content':_0x224d26(0x5dc)+_0x51652e[_0x224d26(0x13bc)]+']'};}break;default:console[_0x224d26(0x664)]('收到了未知的AI指令类型:',_0x49b125[_0x224d26(0xb4b)]);break;}if(_0x1b55a4){_0x42a172[_0x224d26(0x12c3)]['push'](_0x1b55a4);!_0x989e86&&(_0x42a172[_0x224d26(0xce1)]=(_0x42a172[_0x224d26(0xce1)]||0x0)+0x1);if(!_0x989e86&&!_0x2a1a2f){let _0x2315d9;switch(_0x1b55a4[_0x224d26(0xb4b)]){case _0x224d26(0x277):_0x2315d9=_0x224d26(0x7b9);break;case _0x224d26(0x12d5):_0x2315d9=_0x224d26(0x11f1);break;case _0x224d26(0x11c7):_0x2315d9=_0x224d26(0xf8c);break;case'voice_message':_0x2315d9='[语音]';break;case'sticker':_0x2315d9=_0x1b55a4[_0x224d26(0x1488)]?_0x224d26(0x4f3)+_0x1b55a4[_0x224d26(0x1488)]+']':_0x224d26(0x258);break;case _0x224d26(0x6fb):_0x2315d9=_0x1b55a4[_0x224d26(0x6c4)]?'「'+_0x1b55a4[_0x224d26(0x6c4)]+'」':'['+_0x1b55a4[_0x224d26(0x9cc)][_0x224d26(0xa6b)](0x0,0x14)+'...]';break;default:_0x2315d9=String(_0x1b55a4[_0x224d26(0x1047)]||'');}const _0x4e1ec1=_0x42a172[_0x224d26(0x1423)]?_0x1b55a4[_0x224d26(0x1361)]+':\x20'+_0x2315d9:_0x2315d9;_0x1c12fe(_0x4538fd,_0x4e1ec1['substring'](0x0,0x28)+(_0x4e1ec1[_0x224d26(0x9a1)]>0x28?_0x224d26(0x4e6):'')),_0x2a1a2f=!![];}_0x989e86&&(_0x4cc03e(_0x1b55a4,_0x42a172),await new Promise(_0x1fea67=>setTimeout(_0x1fea67,Math[_0x224d26(0x1337)]()*0x708+0x3e8)));}}_0x2b5440&&_0x20bfc1['isGroupCall']&&(_0x20bfc1[_0x224d26(0x122a)]=![],_0x20bfc1[_0x224d26(0x73e)]['length']>0x0?_0x5821d3():(_0x20bfc1={..._0x20bfc1,'isAwaitingResponse':![],'participants':[]},_0x17ec27(_0x224d26(0x120a)),alert(_0x224d26(0x2eb))));if(_0x203987){await _0x36bcc9();return;}await _0x5b9d83[_0x224d26(0x6ce)][_0x224d26(0x7c3)](_0x42a172);const _0x58bf4c=_0x34ce3d['some'](_0x28e76a=>_0x28e76a['type']===_0x224d26(0x9eb)||_0x28e76a[_0x224d26(0xb4b)]==='qzone_like'||_0x28e76a[_0x224d26(0xb4b)]===_0x224d26(0x357)||_0x28e76a[_0x224d26(0xb4b)]===_0x224d26(0x11d5));_0x58bf4c&&(console[_0x224d26(0x415)](_0x224d26(0x993)),await _0x472608());}catch(_0x3441b4){_0x42a172[_0x224d26(0x12c3)]=_0x42a172[_0x224d26(0x12c3)][_0x224d26(0xebc)](_0x4611f7=>!_0x4611f7[_0x224d26(0xd45)]),!_0x42a172[_0x224d26(0x1423)]&&_0x42a172[_0x224d26(0xaf4)]?.[_0x224d26(0x2a3)]==='pending_ai_approval'?(_0x42a172[_0x224d26(0xaf4)][_0x224d26(0x2a3)]=_0x224d26(0x56f),await _0x34d596(_0x224d26(0x1502),_0x224d26(0xb9c)+_0x3441b4[_0x224d26(0x13bc)])):await _0x34d596(_0x224d26(0xfea),'发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a'+_0x3441b4[_0x224d26(0x13bc)]),!_0x42a172[_0x224d26(0x1423)]&&_0x42a172['relationship']?.['status']==='blocked_by_ai'&&await _0x5b9d83[_0x224d26(0x6ce)]['put'](_0x42a172),_0x20bfc1[_0x224d26(0x122a)]=![];}finally{_0x48a755(_0x4538fd,![]),_0x42a172[_0x224d26(0x1423)]?_0x4dd841&&(_0x4dd841[_0x224d26(0x589)]['display']='none'):_0x54a5ed&&_0x28f30a[_0x224d26(0x6ce)][_0x4538fd]&&(_0x54a5ed[_0x224d26(0x589)][_0x224d26(0xb92)]=0x0,setTimeout(()=>{const _0x551859=_0x224d26;_0x54a5ed['textContent']=_0x28f30a[_0x551859(0x6ce)][_0x4538fd]['name'],_0x54a5ed['classList'][_0x551859(0x1424)]('typing-status'),_0x54a5ed[_0x551859(0x589)][_0x551859(0xb92)]=0x1;},0xc8)),_0x5db8a3(),_0x2bbc75&&_0xdddaeb(_0x4538fd),_0x15f646();}}async function _0x93f258(_0x38ad3f){const _0x84c66e=_0x475790;if(!_0x28f30a[_0x84c66e(0x11b9)])return;const _0xc10a19=_0x28f30a[_0x84c66e(0x6ce)][_0x28f30a['activeChatId']],_0x14abfe={'role':_0x84c66e(0xcc9),'content':_0x38ad3f[_0x84c66e(0x6d1)],'meaning':_0x38ad3f[_0x84c66e(0xe36)],'timestamp':Date[_0x84c66e(0x487)]()};_0xc10a19[_0x84c66e(0x12c3)]['push'](_0x14abfe),await _0x5b9d83['chats'][_0x84c66e(0x7c3)](_0xc10a19),_0x4cc03e(_0x14abfe,_0xc10a19),_0x5db8a3(),document[_0x84c66e(0x2ec)]('sticker-panel')[_0x84c66e(0xff6)]['remove'](_0x84c66e(0x149d));}async function _0x561080(){const _0x438915=_0x475790;if(!_0x28f30a[_0x438915(0x11b9)])return;const _0xf2f57=document[_0x438915(0x2ec)]('transfer-amount'),_0x4a30fe=document[_0x438915(0x2ec)](_0x438915(0xa42)),_0x2e0ba7=parseFloat(_0xf2f57['value']),_0x2d35b4=_0x4a30fe['value'][_0x438915(0x97e)]();if(isNaN(_0x2e0ba7)||_0x2e0ba7<0x0){alert(_0x438915(0xf43));return;}const _0x3f7c87=_0x28f30a['chats'][_0x28f30a[_0x438915(0x11b9)]],_0x39ca7=_0x3f7c87[_0x438915(0x1423)]?_0x3f7c87[_0x438915(0x362)][_0x438915(0xa28)]||'我':'我',_0x2a84ec=_0x3f7c87['isGroup']?'群聊':_0x3f7c87[_0x438915(0xe36)],_0x1e6c59={'role':_0x438915(0xcc9),'type':_0x438915(0x277),'amount':_0x2e0ba7,'note':_0x2d35b4,'senderName':_0x39ca7,'receiverName':_0x2a84ec,'timestamp':Date['now']()};_0x3f7c87['history'][_0x438915(0x367)](_0x1e6c59),await _0x5b9d83['chats'][_0x438915(0x7c3)](_0x3f7c87),_0x4cc03e(_0x1e6c59,_0x3f7c87),_0x5db8a3(),document[_0x438915(0x2ec)](_0x438915(0xac6))[_0x438915(0xff6)][_0x438915(0x1424)](_0x438915(0x149d)),_0xf2f57[_0x438915(0x11a4)]='',_0x4a30fe[_0x438915(0x11a4)]='';}async function _0x32aa6b(){const _0x50af96=_0x475790;if(!_0x28f30a[_0x50af96(0x11b9)])return;const _0x5833bf=document[_0x50af96(0x2ec)](_0x50af96(0x11e2)),_0x1d3986=document[_0x50af96(0x2ec)]('waimai-amount'),_0x47a891=_0x5833bf[_0x50af96(0x11a4)][_0x50af96(0x97e)](),_0x48e11b=parseFloat(_0x1d3986[_0x50af96(0x11a4)]);if(!_0x47a891||isNaN(_0x48e11b)||_0x48e11b<=0x0){alert(_0x50af96(0x1523));return;}const _0x559b31=_0x28f30a['chats'][_0x28f30a[_0x50af96(0x11b9)]],_0x13d28e=Date[_0x50af96(0x487)](),_0x1afa78=_0x559b31['isGroup']?_0x559b31[_0x50af96(0x362)]['myNickname']||'我':'我',_0x5a8ae5={'role':_0x50af96(0xcc9),'senderName':_0x1afa78,'type':'waimai_order','productInfo':_0x47a891,'amount':_0x48e11b,'timestamp':_0x13d28e};_0x559b31['history'][_0x50af96(0x367)](_0x5a8ae5);const _0x4eadf6={'role':_0x50af96(0x10a7),'content':_0x50af96(0x12fc)+_0x1afa78+_0x50af96(0xb7e)+_0x47a891+'”，价值'+_0x48e11b+_0x50af96(0x18b),'timestamp':_0x13d28e+0x1,'isHidden':!![]};_0x559b31[_0x50af96(0x12c3)][_0x50af96(0x367)](_0x4eadf6),await _0x5b9d83[_0x50af96(0x6ce)]['put'](_0x559b31),_0x4cc03e(_0x5a8ae5,_0x559b31),_0x5db8a3(),_0x5833bf['value']='',_0x1d3986[_0x50af96(0x11a4)]='',document[_0x50af96(0x2ec)](_0x50af96(0xb69))['classList'][_0x50af96(0x1424)]('visible');}async function _0x32e1b4(){const _0x36394d=_0x475790;if(!_0x28f30a['activeChatId'])return;const _0x10ce36=await _0x33419a(_0x36394d(0x59d),_0x36394d(0x527),'');if(!_0x10ce36||!_0x10ce36[_0x36394d(0x97e)]())return;const _0x3e7251=_0x36394d(0xb62),_0x1db728=_0x28f30a[_0x36394d(0x6ce)][_0x28f30a[_0x36394d(0x11b9)]],_0x108539={'role':_0x36394d(0xcc9),'type':'location_share','content':_0x10ce36[_0x36394d(0x97e)](),'imageUrl':_0x3e7251,'timestamp':Date[_0x36394d(0x487)]()};_0x1db728[_0x36394d(0x12c3)][_0x36394d(0x367)](_0x108539),await _0x5b9d83[_0x36394d(0x6ce)][_0x36394d(0x7c3)](_0x1db728),_0x4cc03e(_0x108539,_0x1db728),_0x5db8a3();}function _0x40f100(_0x5e5a36){const _0x128876=_0x475790;if(_0x36063f)return;_0x36063f=!![],document['getElementById']('chat-interface-screen')[_0x128876(0xff6)][_0x128876(0xe82)](_0x128876(0x38d)),_0x2f0498(_0x5e5a36);}function _0x13d807(){const _0x22f779=_0x475790;_0x1e3c59();if(!_0x36063f)return;_0x36063f=![],document[_0x22f779(0x2ec)]('chat-interface-screen')[_0x22f779(0xff6)][_0x22f779(0x1424)]('selection-mode'),_0x2c905a[_0x22f779(0xf99)](_0x688846=>{const _0x302613=_0x22f779,_0x112df0=document[_0x302613(0x765)]('.message-bubble[data-timestamp=\x22'+_0x688846+'\x22]');if(_0x112df0)_0x112df0[_0x302613(0xff6)][_0x302613(0x1424)]('selected');}),_0x2c905a[_0x22f779(0xe98)]();}function _0x2f0498(_0x549a9b){const _0xc182e=_0x475790,_0x34b66c=document[_0xc182e(0x765)](_0xc182e(0x84e)+_0x549a9b+'\x22]');if(!_0x34b66c)return;_0x2c905a[_0xc182e(0xbf1)](_0x549a9b)?(_0x2c905a[_0xc182e(0x54b)](_0x549a9b),_0x34b66c[_0xc182e(0xff6)][_0xc182e(0x1424)](_0xc182e(0xba2))):(_0x2c905a[_0xc182e(0xe82)](_0x549a9b),_0x34b66c['classList'][_0xc182e(0xe82)](_0xc182e(0xba2))),document['getElementById'](_0xc182e(0xaec))[_0xc182e(0x15f)]=_0xc182e(0x11d6)+_0x2c905a['size']+'\x20条',_0x2c905a[_0xc182e(0x2d2)]===0x0&&_0x13d807();}function _0x131542(_0x34a92f,_0x17176b){const _0x4d6ce0=_0x475790;let _0x184680;const _0x33fa83=_0x7516bf=>{const _0x46896f=_0x1937;if(_0x36063f)return;_0x7516bf[_0x46896f(0x10bd)](),_0x184680=window['setTimeout'](()=>_0x17176b(_0x7516bf),0x1f4);},_0x457f59=()=>clearTimeout(_0x184680);_0x34a92f[_0x4d6ce0(0xf79)](_0x4d6ce0(0xcfa),_0x33fa83),_0x34a92f[_0x4d6ce0(0xf79)](_0x4d6ce0(0x106b),_0x457f59),_0x34a92f[_0x4d6ce0(0xf79)]('mouseleave',_0x457f59),_0x34a92f[_0x4d6ce0(0xf79)](_0x4d6ce0(0x9a8),_0x33fa83,{'passive':!![]}),_0x34a92f[_0x4d6ce0(0xf79)]('touchend',_0x457f59),_0x34a92f['addEventListener'](_0x4d6ce0(0xba4),_0x457f59);}async function _0x213f2c(){const _0x16ee86=_0x475790,_0x104438=_0x28f30a['activeChatId'];if(!_0x104438)return;if(!_0x79cac3[_0x16ee86(0xffc)]){_0x3246d9(_0x104438);return;}if(_0x79cac3[_0x16ee86(0x11b9)]===_0x104438)document[_0x16ee86(0x2ec)](_0x16ee86(0xb2c))[_0x16ee86(0xff6)][_0x16ee86(0xe82)]('visible');else{const _0x1c06d8=_0x28f30a[_0x16ee86(0x6ce)][_0x79cac3[_0x16ee86(0x11b9)]]?.[_0x16ee86(0xe36)]||'未知',_0x5ca3a8=_0x28f30a['chats'][_0x104438]?.[_0x16ee86(0xe36)]||'当前',_0x25c896=await _0x4436ba(_0x16ee86(0x1df),'您正和「'+_0x1c06d8+_0x16ee86(0x62d)+_0x5ca3a8+_0x16ee86(0x98c),{'confirmButtonClass':_0x16ee86(0xd8f)});_0x25c896&&(await _0x159f2b(!![]),await new Promise(_0x2c139b=>setTimeout(_0x2c139b,0x32)),_0x3246d9(_0x104438));}}async function _0x3246d9(_0x1dbe69){const _0x50d62e=_0x475790,_0x562dab=_0x28f30a[_0x50d62e(0x6ce)][_0x1dbe69];if(!_0x562dab)return;_0x79cac3[_0x50d62e(0x1a7)]=_0x562dab[_0x50d62e(0x204)][_0x50d62e(0x8e4)]||0x0,_0x79cac3[_0x50d62e(0xffc)]=!![],_0x79cac3['activeChatId']=_0x1dbe69;_0x79cac3[_0x50d62e(0x5fd)][_0x50d62e(0x9a1)]>0x0?_0x79cac3[_0x50d62e(0xf35)]=0x0:_0x79cac3[_0x50d62e(0xf35)]=-0x1;if(_0x79cac3[_0x50d62e(0xa98)])clearInterval(_0x79cac3[_0x50d62e(0xa98)]);_0x79cac3[_0x50d62e(0xa98)]=setInterval(()=>{const _0x455ce3=_0x50d62e;_0x79cac3[_0x455ce3(0x25e)]&&(_0x79cac3[_0x455ce3(0x1a7)]++,_0x4dde92());},0x3e8),_0xdde111(),_0x1f11de(),document['getElementById'](_0x50d62e(0xb2c))[_0x50d62e(0xff6)][_0x50d62e(0xe82)](_0x50d62e(0x149d));}async function _0x159f2b(_0x417c0d=!![]){const _0x3e70d6=_0x475790;if(!_0x79cac3[_0x3e70d6(0xffc)])return;const _0x523166=_0x79cac3[_0x3e70d6(0x11b9)];document['getElementById']('global-lyrics-bar')[_0x3e70d6(0xff6)][_0x3e70d6(0x1424)](_0x3e70d6(0x149d));const _0x4b4d27=async()=>{const _0x1f6725=_0x3e70d6;if(_0x79cac3['timerId'])clearInterval(_0x79cac3[_0x1f6725(0xa98)]);if(_0x79cac3['isPlaying'])_0x4da7ed[_0x1f6725(0x964)]();if(_0x417c0d&&_0x523166&&_0x28f30a[_0x1f6725(0x6ce)][_0x523166]){const _0x654ea3=_0x28f30a[_0x1f6725(0x6ce)][_0x523166];_0x654ea3[_0x1f6725(0x204)]['totalTime']=_0x79cac3['totalElapsedTime'],await _0x5b9d83[_0x1f6725(0x6ce)][_0x1f6725(0x7c3)](_0x654ea3);}_0x79cac3[_0x1f6725(0xffc)]=![],_0x79cac3['activeChatId']=null,_0x79cac3[_0x1f6725(0x1a7)]=0x0,_0x79cac3['timerId']=null,_0x4e6e7e(_0x523166,!![]);};_0x521d39(_0x4b4d27);}function _0x533c83(){_0x521d39();}function _0x4e6e7e(_0x482bc2,_0x2ef4ad=![]){const _0x279e90=_0x475790,_0x4ac9f4=document['querySelector'](_0x279e90(0x12c7));if(!_0x4ac9f4)return;if(_0x2ef4ad||!_0x79cac3[_0x279e90(0xffc)]||_0x79cac3[_0x279e90(0x11b9)]!==_0x482bc2){_0x4ac9f4[_0x279e90(0xce4)]=_0x279e90(0x426),_0x4ac9f4[_0x279e90(0xdd1)]='';return;}_0x4ac9f4['src']=_0x279e90(0xa80),_0x4ac9f4[_0x279e90(0xff6)][_0x279e90(0xe82)]('rotating');if(_0x79cac3['isPlaying'])_0x4ac9f4[_0x279e90(0xff6)][_0x279e90(0x1424)](_0x279e90(0x1368));else _0x4ac9f4[_0x279e90(0xff6)][_0x279e90(0xe82)](_0x279e90(0x1368));}window[_0x475790(0x1321)]=_0x4e6e7e;function _0xdde111(){const _0xf35dac=_0x475790;_0x4e6e7e(_0x79cac3['activeChatId']),_0x4dde92();const _0x147b4d=document['getElementById'](_0xf35dac(0xe4c)),_0xfdf2f3=document[_0xf35dac(0x2ec)]('music-player-artist'),_0x4c5c48=document[_0xf35dac(0x2ec)](_0xf35dac(0xf4c));if(_0x79cac3[_0xf35dac(0xf35)]>-0x1&&_0x79cac3[_0xf35dac(0x5fd)][_0xf35dac(0x9a1)]>0x0){const _0x234091=_0x79cac3['playlist'][_0x79cac3[_0xf35dac(0xf35)]];_0x147b4d[_0xf35dac(0x15f)]=_0x234091[_0xf35dac(0xe36)],_0xfdf2f3['textContent']=_0x234091['artist'];}else _0x147b4d[_0xf35dac(0x15f)]='请添加歌曲',_0xfdf2f3[_0xf35dac(0x15f)]=_0xf35dac(0x4e6);_0x4c5c48[_0xf35dac(0x15f)]=_0x79cac3[_0xf35dac(0x25e)]?'❚❚':'▶';}function _0x4dde92(){const _0xecacc8=_0x475790,_0x25cebf=(_0x79cac3[_0xecacc8(0x1a7)]/0xe10)[_0xecacc8(0x5c3)](0x1);document[_0xecacc8(0x2ec)](_0xecacc8(0x9c5))['textContent']='已经一起听了'+_0x25cebf+'小时';}function _0x1f11de(){const _0x39063b=_0x475790,_0x5c5751=document[_0x39063b(0x2ec)](_0x39063b(0x4d2));_0x5c5751[_0x39063b(0xc43)]='';if(_0x79cac3[_0x39063b(0x5fd)]['length']===0x0){_0x5c5751[_0x39063b(0xc43)]='<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>';return;}_0x79cac3[_0x39063b(0x5fd)][_0x39063b(0xf99)]((_0x111c76,_0x1191df)=>{const _0x1dea58=_0x39063b,_0x30eecf=document[_0x1dea58(0x14ae)]('div');_0x30eecf[_0x1dea58(0xdd1)]=_0x1dea58(0x27e);if(_0x1191df===_0x79cac3[_0x1dea58(0xf35)])_0x30eecf[_0x1dea58(0xff6)][_0x1dea58(0xe82)]('playing');_0x30eecf[_0x1dea58(0xc43)]=_0x1dea58(0x34f)+_0x111c76[_0x1dea58(0xe36)]+_0x1dea58(0x199)+_0x111c76[_0x1dea58(0x139f)]+_0x1dea58(0x5d2)+_0x1191df+'\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22'+_0x1191df+'\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心新增】在这里添加“背景”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22'+_0x1191df+'\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22'+_0x1191df+'\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a',_0x30eecf[_0x1dea58(0x765)](_0x1dea58(0x12c9))['addEventListener']('click',()=>_0x144635(_0x1191df)),_0x5c5751[_0x1dea58(0x998)](_0x30eecf);});}async function _0x42ba6c(){const _0x3008a8=_0x475790;if(_0x4da7ed[_0x3008a8(0x1368)]){if(_0x79cac3[_0x3008a8(0xf35)]===-0x1&&_0x79cac3[_0x3008a8(0x5fd)]['length']>0x0)_0x144635(0x0);else _0x79cac3[_0x3008a8(0xf35)]>-0x1&&_0x144635(_0x79cac3[_0x3008a8(0xf35)]);}else _0x4da7ed['pause'](),await _0x150e2e('暂停了音乐');}function _0x3bea80(){const _0x44d9df=_0x475790;if(_0x79cac3['playlist'][_0x44d9df(0x9a1)]===0x0)return;let _0x5efdfe;switch(_0x79cac3[_0x44d9df(0x1026)]){case _0x44d9df(0x1337):_0x5efdfe=Math[_0x44d9df(0x5f8)](Math[_0x44d9df(0x1337)]()*_0x79cac3[_0x44d9df(0x5fd)][_0x44d9df(0x9a1)]);break;case _0x44d9df(0x1033):_0x144635(_0x79cac3[_0x44d9df(0xf35)]);return;case _0x44d9df(0xe7e):default:_0x5efdfe=(_0x79cac3[_0x44d9df(0xf35)]+0x1)%_0x79cac3[_0x44d9df(0x5fd)]['length'];break;}_0x144635(_0x5efdfe);}function _0x46f4b5(){const _0x5f31cf=_0x475790;if(_0x79cac3[_0x5f31cf(0x5fd)][_0x5f31cf(0x9a1)]===0x0)return;const _0x15c2a0=(_0x79cac3[_0x5f31cf(0xf35)]-0x1+_0x79cac3[_0x5f31cf(0x5fd)][_0x5f31cf(0x9a1)])%_0x79cac3[_0x5f31cf(0x5fd)][_0x5f31cf(0x9a1)];_0x144635(_0x15c2a0);}function _0x5b708b(){const _0x1a46ec=_0x475790,_0x4dea05=['order','random',_0x1a46ec(0x1033)],_0x3dc1bd=_0x4dea05[_0x1a46ec(0x6d3)](_0x79cac3[_0x1a46ec(0x1026)]);_0x79cac3[_0x1a46ec(0x1026)]=_0x4dea05[(_0x3dc1bd+0x1)%_0x4dea05['length']],document[_0x1a46ec(0x2ec)](_0x1a46ec(0x274))[_0x1a46ec(0x15f)]={'order':'顺序','random':'随机','single':'单曲'}[_0x79cac3[_0x1a46ec(0x1026)]];}async function _0x2621bf(){const _0x33b903=_0x475790,_0x5db1b4=await _0x33419a(_0x33b903(0xb47),_0x33b903(0x75b),'',_0x33b903(0x6d1));if(!_0x5db1b4)return;const _0x144cf8=await _0x33419a(_0x33b903(0x1452),_0x33b903(0xbda));if(!_0x144cf8)return;const _0x380d83=await _0x33419a(_0x33b903(0x1452),_0x33b903(0x12c1));if(!_0x380d83)return;_0x79cac3[_0x33b903(0x5fd)][_0x33b903(0x367)]({'name':_0x144cf8,'artist':_0x380d83,'src':_0x5db1b4,'isLocal':![]}),await _0x10fa70(),_0x1f11de(),_0x79cac3[_0x33b903(0xf35)]===-0x1&&(_0x79cac3[_0x33b903(0xf35)]=_0x79cac3[_0x33b903(0x5fd)][_0x33b903(0x9a1)]-0x1,_0xdde111());}async function _0x29043d(_0x4895b7){const _0x14fec8=_0x475790,_0x5f7f5c=_0x4895b7['target'][_0x14fec8(0x8d6)];if(!_0x5f7f5c[_0x14fec8(0x9a1)])return;for(const _0x29961e of _0x5f7f5c){let _0x5b45e7=_0x29961e[_0x14fec8(0xe36)]['replace'](/\.[^/.]+$/,'');_0x5b45e7=await _0x33419a(_0x14fec8(0x1452),'请输入歌名',_0x5b45e7);if(_0x5b45e7===null)continue;const _0x439ebd=await _0x33419a(_0x14fec8(0x1452),_0x14fec8(0x12c1),'未知歌手');if(_0x439ebd===null)continue;const _0x54ac12=await _0x29961e[_0x14fec8(0x7be)]();let _0x522db2='';const _0x1f3ae2=await _0x4436ba(_0x14fec8(0x76b),_0x14fec8(0x10c1)+_0x5b45e7+_0x14fec8(0x85b));_0x1f3ae2&&(_0x522db2=await _0x41e65f()||''),_0x79cac3[_0x14fec8(0x5fd)]['push']({'name':_0x5b45e7,'artist':_0x439ebd,'src':_0x54ac12,'fileType':_0x29961e[_0x14fec8(0xb4b)],'isLocal':!![],'lrcContent':_0x522db2,'cover':_0x14fec8(0x1e6)});}await _0x10fa70(),_0x1f11de(),_0x79cac3[_0x14fec8(0xf35)]===-0x1&&_0x79cac3['playlist'][_0x14fec8(0x9a1)]>0x0&&(_0x79cac3[_0x14fec8(0xf35)]=0x0,_0xdde111()),_0x4895b7[_0x14fec8(0x1104)][_0x14fec8(0x11a4)]=null;}async function _0x144635(_0x1d8ff3){const _0x52f328=_0x475790;if(_0x1d8ff3<0x0||_0x1d8ff3>=_0x79cac3[_0x52f328(0x5fd)][_0x52f328(0x9a1)])return;_0x4da7ed['pause'](),_0x79cac3[_0x52f328(0xf35)]=_0x1d8ff3;const _0xdca4a6=_0x79cac3[_0x52f328(0x5fd)][_0x1d8ff3],_0x11be9b=_0x28f30a[_0x52f328(0x6ce)][_0x79cac3[_0x52f328(0x11b9)]],_0x3b2d0a=document[_0x52f328(0x2ec)](_0x52f328(0x618));if(_0x11be9b&&_0x3b2d0a){_0x3b2d0a[_0x52f328(0xc43)]='';const _0x75177f=_0x11be9b[_0x52f328(0x1423)]?_0x11be9b[_0x52f328(0x10f2)][_0x52f328(0x412)](_0x386006=>_0x386006[_0x52f328(0x66c)]===_0xdca4a6['artist'])?.['avatar']||_0x825cf1:_0x11be9b[_0x52f328(0x362)]['aiAvatar']||_0x825cf1,_0x976cb0=_0x11be9b['settings']['myAvatar']||_0x825cf1,_0x982753=document[_0x52f328(0x14ae)](_0x52f328(0x3b3));_0x982753[_0x52f328(0xce4)]=_0x75177f,_0x982753[_0x52f328(0xdd1)]='participant-display-avatar',_0x982753[_0x52f328(0xd61)]='Character\x20Avatar',_0x3b2d0a[_0x52f328(0x998)](_0x982753);const _0x406ad3=document[_0x52f328(0x14ae)](_0x52f328(0x3b3));_0x406ad3[_0x52f328(0xce4)]=_0x976cb0,_0x406ad3[_0x52f328(0xdd1)]=_0x52f328(0x8d8),_0x406ad3[_0x52f328(0xd61)]='User\x20Avatar',_0x3b2d0a['appendChild'](_0x406ad3);}const _0x157a83=document['querySelector'](_0x52f328(0x515)),_0xd5a2a0=document[_0x52f328(0x2ec)]('toggle-blur-btn');_0x157a83&&(_0x157a83[_0x52f328(0x589)][_0x52f328(0x644)](_0x52f328(0x63e),_0xdca4a6['background']?'url('+_0xdca4a6[_0x52f328(0x137c)]+')':'none'),_0x157a83[_0x52f328(0xff6)][_0x52f328(0x14c8)](_0x52f328(0x1532),!!_0xdca4a6[_0x52f328(0xf61)]));_0xd5a2a0&&_0xd5a2a0[_0x52f328(0xff6)][_0x52f328(0x14c8)](_0x52f328(0xd43),!!_0xdca4a6['isBgClear']);document[_0x52f328(0x2ec)](_0x52f328(0xfce))[_0x52f328(0xff6)][_0x52f328(0x1424)](_0x52f328(0x10cb));const _0x574e35=document['getElementById']('music-player-cover');_0x574e35&&(_0x574e35[_0x52f328(0xce4)]=_0xdca4a6[_0x52f328(0x12df)]||_0x52f328(0x1e6));await _0x150e2e(_0x52f328(0x2b7)+_0xdca4a6[_0x52f328(0xe36)]+'》'),_0x79cac3['parsedLyrics']=_0x59e6cd(_0xdca4a6[_0x52f328(0x913)]||''),_0x4a096c();const _0x408cd5=document['getElementById'](_0x52f328(0x2d3));_0x408cd5&&(!_0x79cac3[_0x52f328(0x9c4)]||_0x79cac3['parsedLyrics'][_0x52f328(0x9a1)]===0x0?_0x408cd5[_0x52f328(0x15f)]=_0x52f328(0x118b):_0x408cd5['textContent']='♪\x20♪\x20♪');if(_0xdca4a6['isLocal']&&_0xdca4a6['src']instanceof ArrayBuffer){const _0x4e9d77=new Blob([_0xdca4a6[_0x52f328(0xce4)]],{'type':_0xdca4a6[_0x52f328(0x11bd)]||'audio/mpeg'});_0x4da7ed[_0x52f328(0xce4)]=URL['createObjectURL'](_0x4e9d77);}else{if(_0xdca4a6[_0x52f328(0x444)]&&_0xdca4a6[_0x52f328(0xce4)]instanceof Blob)_0x4da7ed[_0x52f328(0xce4)]=URL[_0x52f328(0x23d)](_0xdca4a6['src']);else{if(!_0xdca4a6[_0x52f328(0x444)])_0x4da7ed[_0x52f328(0xce4)]=_0xdca4a6[_0x52f328(0xce4)];else{console[_0x52f328(0x1518)](_0x52f328(0x38b),_0xdca4a6);return;}}}const _0x4c253a=_0x4da7ed[_0x52f328(0x23f)]();_0x4c253a!==undefined&&_0x4c253a[_0x52f328(0xd6b)](_0x360cd2=>{const _0x43f20b=_0x52f328;if(_0x360cd2[_0x43f20b(0xe36)]==='NotAllowedError')console[_0x43f20b(0x664)](_0x43f20b(0xe11)),_0x4da7ed[_0x43f20b(0x964)](),_0x34d596(_0x43f20b(0x12d4),_0x43f20b(0x219));else _0x360cd2[_0x43f20b(0xe36)]!==_0x43f20b(0x806)&&console[_0x43f20b(0x1518)](_0x43f20b(0x3cd),_0x360cd2);});_0x1f11de(),_0xdde111(),_0x9574d4();const _0x5786d0=document[_0x52f328(0x2ec)]('global-lyrics-bar');_0x79cac3[_0x52f328(0x9c4)]&&_0x79cac3['parsedLyrics']['length']>0x0?(_0x5786d0[_0x52f328(0x15f)]='♪',_0x5786d0[_0x52f328(0xff6)][_0x52f328(0xe82)]('visible')):_0x5786d0[_0x52f328(0xff6)]['remove']('visible');}async function _0x133c3a(_0x27b420){const _0x5cf722=_0x475790;if(_0x27b420<0x0||_0x27b420>=_0x79cac3['playlist'][_0x5cf722(0x9a1)])return;const _0xbe9329=await _0x3d2f35('更换歌曲背景',[{'text':_0x5cf722(0xdc3),'value':_0x5cf722(0x252)},{'text':_0x5cf722(0x1173),'value':_0x5cf722(0x6d1)}]);let _0x50b91d=null;if(_0xbe9329==='local')_0x50b91d=await _0x1fcca6();else _0xbe9329===_0x5cf722(0x6d1)&&(_0x50b91d=await _0x33419a(_0x5cf722(0x536),_0x5cf722(0x61b),'',_0x5cf722(0x6d1)));if(_0x50b91d&&_0x50b91d[_0x5cf722(0x97e)]()){_0x79cac3[_0x5cf722(0x5fd)][_0x27b420][_0x5cf722(0x137c)]=_0x50b91d[_0x5cf722(0x97e)](),await _0x10fa70();if(_0x79cac3['currentIndex']===_0x27b420){const _0x47522b=document['querySelector'](_0x5cf722(0x515));_0x47522b[_0x5cf722(0x589)][_0x5cf722(0x644)](_0x5cf722(0x63e),'url('+_0x50b91d['trim']()+')');}await _0x34d596('成功','歌曲背景已更新！');}}async function _0x32eda6(_0x52b326){const _0x361443=_0x475790;if(_0x52b326<0x0||_0x52b326>=_0x79cac3[_0x361443(0x5fd)][_0x361443(0x9a1)])return;const _0x7054f0=await _0x3d2f35(_0x361443(0x649),[{'text':_0x361443(0xdc3),'value':_0x361443(0x252)},{'text':_0x361443(0x1173),'value':'url'}]);let _0x3307db=null;if(_0x7054f0==='local')_0x3307db=await _0x1fcca6();else _0x7054f0===_0x361443(0x6d1)&&(_0x3307db=await _0x33419a('输入图片URL',_0x361443(0x123e),'',_0x361443(0x6d1)));if(_0x3307db&&_0x3307db[_0x361443(0x97e)]()){_0x79cac3['playlist'][_0x52b326]['cover']=_0x3307db['trim'](),await _0x10fa70();if(_0x79cac3['currentIndex']===_0x52b326){document[_0x361443(0x2ec)]('music-player-cover')[_0x361443(0xce4)]=_0x3307db[_0x361443(0x97e)]();const _0x11ba05=document[_0x361443(0x765)]('#vinyl-view\x20#music-player-cover');if(_0x11ba05)_0x11ba05[_0x361443(0xce4)]=_0x3307db[_0x361443(0x97e)]();}await _0x34d596('成功',_0x361443(0x8bf));}}async function _0x5d04e4(_0x4adcb0){const _0x1316f9=_0x475790;if(_0x4adcb0<0x0||_0x4adcb0>=_0x79cac3['playlist'][_0x1316f9(0x9a1)])return;const _0x389abb=_0x79cac3['playlist'][_0x4adcb0],_0x52c07e=_0x79cac3['isPlaying']&&_0x79cac3['currentIndex']===_0x4adcb0;if(_0x389abb[_0x1316f9(0x444)]&&_0x4da7ed[_0x1316f9(0xce4)][_0x1316f9(0x741)](_0x1316f9(0x397))&&_0x79cac3[_0x1316f9(0xf35)]===_0x4adcb0)URL[_0x1316f9(0x18d)](_0x4da7ed['src']);_0x79cac3[_0x1316f9(0x5fd)][_0x1316f9(0x510)](_0x4adcb0,0x1),await _0x10fa70();if(_0x79cac3['playlist'][_0x1316f9(0x9a1)]===0x0){if(_0x79cac3[_0x1316f9(0x25e)])_0x4da7ed[_0x1316f9(0x964)]();_0x4da7ed['src']='',_0x79cac3[_0x1316f9(0xf35)]=-0x1,_0x79cac3['isPlaying']=![];}else{if(_0x52c07e)_0x3bea80();else{if(_0x79cac3[_0x1316f9(0xf35)]>=_0x4adcb0)_0x79cac3['currentIndex']=Math[_0x1316f9(0x7ac)](0x0,_0x79cac3[_0x1316f9(0xf35)]-0x1);}}_0xdde111(),_0x1f11de();}async function _0x29043d(_0xe34773){const _0x44d71e=_0x475790,_0x5b6f26=_0xe34773[_0x44d71e(0x1104)]['files'];if(!_0x5b6f26['length'])return;for(const _0x41f3b8 of _0x5b6f26){let _0x2b7c4c=_0x41f3b8['name']['replace'](/\.[^/.]+$/,'');_0x2b7c4c=await _0x33419a('歌曲信息',_0x44d71e(0xbda),_0x2b7c4c);if(_0x2b7c4c===null)continue;const _0x3be8ea=await _0x33419a(_0x44d71e(0x1452),_0x44d71e(0x12c1),_0x44d71e(0x205));if(_0x3be8ea===null)continue;let _0x6cc01a='';const _0x256790=await _0x4436ba('导入歌词','要为《'+_0x2b7c4c+'》添加歌词吗？');_0x256790&&(_0x6cc01a=await _0x41e65f()||''),_0x79cac3[_0x44d71e(0x5fd)][_0x44d71e(0x367)]({'name':_0x2b7c4c,'artist':_0x3be8ea,'src':_0x41f3b8,'isLocal':!![],'lrcContent':_0x6cc01a});}await _0x10fa70(),_0x1f11de(),_0x79cac3[_0x44d71e(0xf35)]===-0x1&&_0x79cac3[_0x44d71e(0x5fd)][_0x44d71e(0x9a1)]>0x0&&(_0x79cac3['currentIndex']=0x0,_0xdde111()),_0xe34773[_0x44d71e(0x1104)][_0x44d71e(0x11a4)]=null;}async function _0x5d04e4(_0x2a2481){const _0x3e8ad7=_0x475790;if(_0x2a2481<0x0||_0x2a2481>=_0x79cac3[_0x3e8ad7(0x5fd)][_0x3e8ad7(0x9a1)])return;const _0x3434a8=_0x79cac3['playlist'][_0x2a2481],_0x20668a=_0x79cac3[_0x3e8ad7(0x25e)]&&_0x79cac3[_0x3e8ad7(0xf35)]===_0x2a2481;if(_0x3434a8[_0x3e8ad7(0x444)]&&_0x4da7ed[_0x3e8ad7(0xce4)]['startsWith'](_0x3e8ad7(0x397))&&_0x79cac3['currentIndex']===_0x2a2481)URL[_0x3e8ad7(0x18d)](_0x4da7ed[_0x3e8ad7(0xce4)]);_0x79cac3['playlist'][_0x3e8ad7(0x510)](_0x2a2481,0x1),await _0x10fa70();if(_0x79cac3['playlist'][_0x3e8ad7(0x9a1)]===0x0){if(_0x79cac3['isPlaying'])_0x4da7ed[_0x3e8ad7(0x964)]();_0x4da7ed['src']='',_0x79cac3[_0x3e8ad7(0xf35)]=-0x1,_0x79cac3[_0x3e8ad7(0x25e)]=![];}else{if(_0x20668a)_0x3bea80();else{if(_0x79cac3['currentIndex']>=_0x2a2481)_0x79cac3[_0x3e8ad7(0xf35)]=Math['max'](0x0,_0x79cac3[_0x3e8ad7(0xf35)]-0x1);}}_0xdde111(),_0x1f11de();}const _0x64c86d=document[_0x475790(0x2ec)](_0x475790(0x1556)),_0x581f75=document[_0x475790(0x2ec)](_0x475790(0xb09)),_0x273f82=document['getElementById'](_0x475790(0xbdb));function _0x3d4df1(){const _0x3120b0=_0x475790;_0x515f21(),_0x64c86d[_0x3120b0(0xff6)][_0x3120b0(0xe82)](_0x3120b0(0x149d));}function _0x53e6e8(){const _0x5ac2fb=_0x475790;_0x64c86d[_0x5ac2fb(0xff6)][_0x5ac2fb(0x1424)](_0x5ac2fb(0x149d));}function _0x515f21(){const _0x2107e4=_0x475790,_0xd28cf0=document[_0x2107e4(0x2ec)](_0x2107e4(0x6f5));_0xd28cf0['innerHTML']='';if(_0x28f30a[_0x2107e4(0x5f0)][_0x2107e4(0x9a1)]===0x0){_0xd28cf0[_0x2107e4(0xc43)]=_0x2107e4(0x5c5);return;}_0x28f30a[_0x2107e4(0x5f0)][_0x2107e4(0xf99)](_0x5a6c40=>{const _0x31a8e1=_0x2107e4,_0x4c0f06=document[_0x31a8e1(0x14ae)](_0x31a8e1(0xaa5));_0x4c0f06[_0x31a8e1(0xdd1)]=_0x31a8e1(0x593),_0x4c0f06['style'][_0x31a8e1(0xe00)]=_0x31a8e1(0xeb9)+_0x5a6c40[_0x31a8e1(0x516)]+')',_0x4c0f06[_0x31a8e1(0xe93)][_0x31a8e1(0xc51)]=_0x5a6c40['id'],_0x4c0f06[_0x31a8e1(0xf79)](_0x31a8e1(0x1177),()=>_0x452b89(_0x5a6c40['id'])),_0x131542(_0x4c0f06,()=>_0x1c78a6(_0x5a6c40['id'])),_0xd28cf0[_0x31a8e1(0x998)](_0x4c0f06);});}function _0x1c78a6(_0x2d0dfe){const _0x24bf66=_0x475790;_0x354ae4=_0x2d0dfe,_0x273f82[_0x24bf66(0xff6)][_0x24bf66(0xe82)](_0x24bf66(0x149d));}function _0x4c110a(){const _0x46c5ed=_0x475790;_0x273f82[_0x46c5ed(0xff6)][_0x46c5ed(0x1424)](_0x46c5ed(0x149d)),_0x354ae4=null;}function _0x452b89(_0x35d2c8){const _0x28a85b=_0x475790,_0x6e89e7=_0x28f30a[_0x28a85b(0x5f0)][_0x28a85b(0x412)](_0x13bc05=>_0x13bc05['id']===_0x35d2c8);_0x6e89e7&&(document[_0x28a85b(0x2ec)](_0x28a85b(0xead))[_0x28a85b(0xce4)]=_0x6e89e7[_0x28a85b(0x516)],document[_0x28a85b(0x2ec)](_0x28a85b(0xe6f))['value']=_0x6e89e7[_0x28a85b(0xe32)]),_0x53e6e8();}function _0x31d842(){const _0x244aad=_0x475790;_0x354ae4=null,document['getElementById']('persona-editor-title')[_0x244aad(0x15f)]=_0x244aad(0x774),document['getElementById'](_0x244aad(0x8a7))[_0x244aad(0xce4)]=_0x825cf1,document['getElementById'](_0x244aad(0x967))[_0x244aad(0x11a4)]='',_0x581f75[_0x244aad(0xff6)]['add'](_0x244aad(0x149d));}function _0xca66b5(){const _0x2ff784=_0x475790,_0x203d23=_0x28f30a[_0x2ff784(0x5f0)]['find'](_0x7b3fc7=>_0x7b3fc7['id']===_0x354ae4);if(!_0x203d23)return;document['getElementById'](_0x2ff784(0x7dd))[_0x2ff784(0x15f)]=_0x2ff784(0x1112),document[_0x2ff784(0x2ec)](_0x2ff784(0x8a7))[_0x2ff784(0xce4)]=_0x203d23[_0x2ff784(0x516)],document['getElementById'](_0x2ff784(0x967))['value']=_0x203d23[_0x2ff784(0xe32)],_0x273f82['classList']['remove'](_0x2ff784(0x149d)),_0x581f75[_0x2ff784(0xff6)][_0x2ff784(0xe82)](_0x2ff784(0x149d));}async function _0x57857f(){const _0x234598=_0x475790,_0x1406e1=await _0x4436ba(_0x234598(0x3c5),_0x234598(0x2f0),{'confirmButtonClass':_0x234598(0xd8f)});_0x1406e1&&_0x354ae4&&(await _0x5b9d83[_0x234598(0x5f0)][_0x234598(0x54b)](_0x354ae4),_0x28f30a[_0x234598(0x5f0)]=_0x28f30a[_0x234598(0x5f0)][_0x234598(0xebc)](_0x2a36da=>_0x2a36da['id']!==_0x354ae4),_0x4c110a(),_0x515f21());}function _0x34370c(){const _0x3f1717=_0x475790;_0x581f75['classList'][_0x3f1717(0x1424)](_0x3f1717(0x149d)),_0x354ae4=null;}async function _0x214887(){const _0x1c84d9=_0x475790,_0x5556fd=document[_0x1c84d9(0x2ec)](_0x1c84d9(0x8a7))[_0x1c84d9(0xce4)],_0x51ceb3=document[_0x1c84d9(0x2ec)](_0x1c84d9(0x967))['value']['trim']();if(_0x5556fd===_0x825cf1&&!_0x51ceb3){alert(_0x1c84d9(0x14c3));return;}if(_0x354ae4){const _0x200db0=_0x28f30a['personaPresets']['find'](_0xd26654=>_0xd26654['id']===_0x354ae4);_0x200db0&&(_0x200db0[_0x1c84d9(0x516)]=_0x5556fd,_0x200db0['persona']=_0x51ceb3,await _0x5b9d83[_0x1c84d9(0x5f0)][_0x1c84d9(0x7c3)](_0x200db0));}else{const _0x5b4dbd={'id':_0x1c84d9(0xd4e)+Date[_0x1c84d9(0x487)](),'avatar':_0x5556fd,'persona':_0x51ceb3};await _0x5b9d83[_0x1c84d9(0x5f0)][_0x1c84d9(0xe82)](_0x5b4dbd),_0x28f30a[_0x1c84d9(0x5f0)]['push'](_0x5b4dbd);}_0x515f21(),_0x34370c();}const _0x14f046=document[_0x475790(0x2ec)]('battery-alert-modal');function _0x2ca2b5(_0x534548,_0x248701){const _0x48270f=_0x475790;clearTimeout(_0x381bcc),document[_0x48270f(0x2ec)](_0x48270f(0xc5f))[_0x48270f(0xce4)]=_0x534548,document[_0x48270f(0x2ec)](_0x48270f(0x610))[_0x48270f(0x15f)]=_0x248701,_0x14f046['classList'][_0x48270f(0xe82)](_0x48270f(0x149d));const _0x4c0552=()=>{const _0x426664=_0x48270f;_0x14f046[_0x426664(0xff6)][_0x426664(0x1424)]('visible'),_0x14f046[_0x426664(0x1f0)](_0x426664(0x1177),_0x4c0552);};_0x14f046[_0x48270f(0xf79)](_0x48270f(0x1177),_0x4c0552),_0x381bcc=setTimeout(_0x4c0552,0x7d0);}function _0x20ec9c(_0xfcd865){const _0x5a17cd=_0x475790,_0x20c1c1=document[_0x5a17cd(0x2ec)](_0x5a17cd(0xc78)),_0x54e423=_0x20c1c1[_0x5a17cd(0x765)](_0x5a17cd(0x5cf)),_0x399870=_0x20c1c1[_0x5a17cd(0x765)](_0x5a17cd(0x4be)),_0x59a911=Math['floor'](_0xfcd865['level']*0x64);_0x54e423[_0x5a17cd(0x589)][_0x5a17cd(0xeb4)]=_0x59a911+'%',_0x399870[_0x5a17cd(0x15f)]=_0x59a911+'%',_0xfcd865[_0x5a17cd(0x11bc)]?_0x20c1c1[_0x5a17cd(0xff6)]['add']('charging'):_0x20c1c1[_0x5a17cd(0xff6)][_0x5a17cd(0x1424)](_0x5a17cd(0x11bc));}function _0xaee9e(_0x2845b7){const _0x4c8d70=_0x475790;_0x20ec9c(_0x2845b7);const _0x55c0f4=_0x2845b7[_0x4c8d70(0x101c)];!_0x2845b7[_0x4c8d70(0x11bc)]&&(_0x55c0f4<=0.4&&_0x152239>0.4&&!_0x2af782[_0x4c8d70(0xd69)]&&(_0x2ca2b5(_0x4c8d70(0xfcf),_0x4c8d70(0xff2)),_0x2af782[_0x4c8d70(0xd69)]=!![]),_0x55c0f4<=0.2&&_0x152239>0.2&&!_0x2af782[_0x4c8d70(0x90c)]&&(_0x2ca2b5(_0x4c8d70(0x155c),_0x4c8d70(0x334)),_0x2af782['hasShown20']=!![]),_0x55c0f4<=0.1&&_0x152239>0.1&&!_0x2af782[_0x4c8d70(0x1e4)]&&(_0x2ca2b5('https://i.postimg.cc/ThMMVfW4/10.jpg',_0x4c8d70(0xd52)),_0x2af782[_0x4c8d70(0x1e4)]=!![]));if(_0x55c0f4>0.4)_0x2af782[_0x4c8d70(0xd69)]=![];if(_0x55c0f4>0.2)_0x2af782[_0x4c8d70(0x90c)]=![];if(_0x55c0f4>0.1)_0x2af782['hasShown10']=![];_0x152239=_0x55c0f4;}async function _0x53fe12(){const _0x3e6198=_0x475790;if(_0x3e6198(0xac4)in navigator)try{const _0x4ebf8a=await navigator[_0x3e6198(0xac4)]();_0x152239=_0x4ebf8a[_0x3e6198(0x101c)],_0xaee9e(_0x4ebf8a),_0x4ebf8a[_0x3e6198(0xf79)](_0x3e6198(0x1a6),()=>_0xaee9e(_0x4ebf8a)),_0x4ebf8a[_0x3e6198(0xf79)](_0x3e6198(0xf6c),()=>{const _0x5a16ab=_0x3e6198;_0xaee9e(_0x4ebf8a),_0x4ebf8a[_0x5a16ab(0x11bc)]&&_0x2ca2b5(_0x5a16ab(0x11b3),'窝爱泥，电量吃饱饱');});}catch(_0x159136){console[_0x3e6198(0x1518)]('无法获取电池信息:',_0x159136),document[_0x3e6198(0x765)](_0x3e6198(0x4be))[_0x3e6198(0x15f)]=_0x3e6198(0xd2e);}else console[_0x3e6198(0x415)]('浏览器不支持电池状态API。'),document['querySelector'](_0x3e6198(0x4be))[_0x3e6198(0x15f)]=_0x3e6198(0xd2e);}async function _0x1995db(){const _0x8cc506=_0x475790,_0x1152cc=document[_0x8cc506(0x2ec)]('album-grid-page');if(!_0x1152cc)return;const _0x287fc3=await _0x5b9d83[_0x8cc506(0x550)][_0x8cc506(0x106d)]('createdAt')['reverse']()[_0x8cc506(0x14b5)]();_0x1152cc['innerHTML']='';if(_0x287fc3['length']===0x0){_0x1152cc[_0x8cc506(0xc43)]=_0x8cc506(0xc5a);return;}_0x287fc3[_0x8cc506(0xf99)](_0x1235fb=>{const _0x35a772=_0x8cc506,_0x317adb=document['createElement'](_0x35a772(0xaa5));_0x317adb[_0x35a772(0xdd1)]='album-item',_0x317adb[_0x35a772(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url('+_0x1235fb[_0x35a772(0xb81)]+_0x35a772(0x28f)+_0x1235fb['name']+_0x35a772(0x1187)+(_0x1235fb[_0x35a772(0x1103)]||0x0)+_0x35a772(0x1b5),_0x317adb[_0x35a772(0xf79)](_0x35a772(0x1177),()=>{_0x22cc32(_0x1235fb['id']);}),_0x131542(_0x317adb,async()=>{const _0x2503c4=_0x35a772,_0xa3dd6a=await _0x4436ba(_0x2503c4(0x616),_0x2503c4(0x176)+_0x1235fb[_0x2503c4(0xe36)]+_0x2503c4(0x11a3),{'confirmButtonClass':'btn-danger'});_0xa3dd6a&&(await _0x5b9d83[_0x2503c4(0x4e3)][_0x2503c4(0x67e)](_0x2503c4(0xf67))['equals'](_0x1235fb['id'])[_0x2503c4(0x54b)](),await _0x5b9d83[_0x2503c4(0x550)][_0x2503c4(0x54b)](_0x1235fb['id']),await _0x1995db(),alert(_0x2503c4(0xbfe)));}),_0x1152cc[_0x35a772(0x998)](_0x317adb);});}async function _0x22cc32(_0x6e3a5f){const _0x1c3132=_0x475790;_0x28f30a[_0x1c3132(0x94a)]=_0x6e3a5f,await _0x3aa0a4(),_0x17ec27('album-photos-screen');}async function _0x3aa0a4(){const _0x4c428a=_0x475790;if(!_0x28f30a[_0x4c428a(0x94a)])return;const _0x14d51a=document[_0x4c428a(0x2ec)](_0x4c428a(0x3ec)),_0x547cfd=document[_0x4c428a(0x2ec)](_0x4c428a(0x1145)),_0x381b0e=await _0x5b9d83[_0x4c428a(0x550)][_0x4c428a(0x6b5)](_0x28f30a[_0x4c428a(0x94a)]);if(!_0x381b0e){console['error']('找不到相册:',_0x28f30a[_0x4c428a(0x94a)]),_0x17ec27(_0x4c428a(0x140a));return;}_0x547cfd[_0x4c428a(0x15f)]=_0x381b0e[_0x4c428a(0xe36)];const _0x4988fc=await _0x5b9d83[_0x4c428a(0x4e3)][_0x4c428a(0x67e)](_0x4c428a(0xf67))[_0x4c428a(0x129a)](_0x28f30a[_0x4c428a(0x94a)])['toArray']();_0x14d51a[_0x4c428a(0xc43)]='',_0x4988fc['length']===0x0?_0x14d51a[_0x4c428a(0xc43)]='<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>':_0x4988fc[_0x4c428a(0xf99)](_0x2e4867=>{const _0x4ffcea=_0x4c428a,_0x163ae8=document[_0x4ffcea(0x14ae)](_0x4ffcea(0xaa5));_0x163ae8['className']=_0x4ffcea(0x31d),_0x163ae8[_0x4ffcea(0xc43)]=_0x4ffcea(0x1151)+_0x2e4867[_0x4ffcea(0x6d1)]+_0x4ffcea(0x18f)+_0x2e4867['id']+_0x4ffcea(0x63c),_0x14d51a['appendChild'](_0x163ae8);});}async function _0x336c06(_0x1616b5){const _0x446cde=_0x475790;if(!_0x28f30a[_0x446cde(0x94a)])return;const _0x5840ef=await _0x5b9d83[_0x446cde(0x4e3)][_0x446cde(0x67e)](_0x446cde(0xf67))['equals'](_0x28f30a[_0x446cde(0x94a)])[_0x446cde(0x14b5)]();_0x30c3d1[_0x446cde(0xecc)]=_0x5840ef[_0x446cde(0x11c6)](_0x20103a=>_0x20103a[_0x446cde(0x6d1)]),_0x30c3d1[_0x446cde(0xf35)]=_0x30c3d1[_0x446cde(0xecc)][_0x446cde(0x535)](_0x371091=>_0x371091===_0x1616b5);if(_0x30c3d1[_0x446cde(0xf35)]===-0x1)return;document[_0x446cde(0x2ec)](_0x446cde(0xa7d))['classList'][_0x446cde(0xe82)](_0x446cde(0x149d)),_0x455cf5(),_0x30c3d1[_0x446cde(0x404)]=!![];}function _0x455cf5(){const _0x351b73=_0x475790;if(_0x30c3d1[_0x351b73(0xf35)]===-0x1)return;const _0x54df1d=document[_0x351b73(0x2ec)](_0x351b73(0x5dd)),_0x1292b4=document['getElementById'](_0x351b73(0x84a)),_0x51d3e9=document[_0x351b73(0x2ec)](_0x351b73(0x12eb));_0x54df1d[_0x351b73(0x589)]['opacity']=0x0,setTimeout(()=>{const _0x1d9792=_0x351b73;_0x54df1d[_0x1d9792(0xce4)]=_0x30c3d1['photos'][_0x30c3d1[_0x1d9792(0xf35)]],_0x54df1d['style'][_0x1d9792(0xb92)]=0x1;},0x64),_0x1292b4['disabled']=_0x30c3d1[_0x351b73(0xf35)]===0x0,_0x51d3e9['disabled']=_0x30c3d1[_0x351b73(0xf35)]===_0x30c3d1[_0x351b73(0xecc)][_0x351b73(0x9a1)]-0x1;}function _0x58787a(){const _0x7d3cba=_0x475790;_0x30c3d1['currentIndex']<_0x30c3d1['photos'][_0x7d3cba(0x9a1)]-0x1&&(_0x30c3d1[_0x7d3cba(0xf35)]++,_0x455cf5());}function _0x2c7836(){const _0x15c2ac=_0x475790;_0x30c3d1[_0x15c2ac(0xf35)]>0x0&&(_0x30c3d1[_0x15c2ac(0xf35)]--,_0x455cf5());}function _0x1dbb4e(){const _0x144851=_0x475790;document['getElementById'](_0x144851(0xa7d))[_0x144851(0xff6)][_0x144851(0x1424)](_0x144851(0x149d)),_0x30c3d1[_0x144851(0x404)]=![],_0x30c3d1[_0x144851(0xecc)]=[],_0x30c3d1['currentIndex']=-0x1,document[_0x144851(0x2ec)](_0x144851(0x5dd))[_0x144851(0xce4)]='';}function _0x3f09c8(_0x277536){const _0x514ef0=_0x475790;_0x461b99=_0x277536,localStorage[_0x514ef0(0x1048)](_0x514ef0(0xd3f),_0x277536);const _0x5edd9b=document[_0x514ef0(0x765)](_0x514ef0(0xe4f)),_0x1e0fdf=_0x5edd9b[_0x514ef0(0x765)](_0x514ef0(0xf82));let _0x3ce3a3=_0x5edd9b[_0x514ef0(0x765)]('.unread-indicator');_0x277536>0x0?(!_0x3ce3a3&&(_0x3ce3a3=document['createElement'](_0x514ef0(0xf82)),_0x3ce3a3[_0x514ef0(0xdd1)]=_0x514ef0(0xdb3),_0x1e0fdf[_0x514ef0(0x589)][_0x514ef0(0xe45)]=_0x514ef0(0x10ba),_0x1e0fdf['appendChild'](_0x3ce3a3)),_0x3ce3a3['textContent']=_0x277536>0x63?_0x514ef0(0x21a):_0x277536,_0x3ce3a3['style']['display']=_0x514ef0(0x13f7)):_0x3ce3a3&&(_0x3ce3a3[_0x514ef0(0x589)]['display']=_0x514ef0(0x5b1)),_0x4a1a61();}function _0xe2b398(){const _0x5c1ddc=_0x475790;if(_0x50d0fa)return;const _0x306123=_0x28f30a[_0x5c1ddc(0x1062)][_0x5c1ddc(0x146a)]||0x3c;_0x50d0fa=setInterval(_0x12b673,_0x306123*0x3e8),_0x5445ef();}function _0x329a7b(){_0x50d0fa&&(clearInterval(_0x50d0fa),_0x50d0fa=null),_0x15f646();}async function _0x12b673(){const _0x2beb80=_0x475790;console[_0x2beb80(0x415)](_0x2beb80(0x338));if(!_0x28f30a['globalSettings'][_0x2beb80(0x12ed)]){_0x329a7b();return;}const _0x371287=Object[_0x2beb80(0x74e)](_0x28f30a['chats'])[_0x2beb80(0xebc)](_0x36005d=>!_0x36005d[_0x2beb80(0x1423)]);_0x371287['forEach'](_0x425f56=>{const _0x55fd44=_0x2beb80;if(_0x425f56[_0x55fd44(0xaf4)]?.['status']===_0x55fd44(0x214)){const _0x5ac20c=_0x425f56['relationship'][_0x55fd44(0xee3)];if(!_0x5ac20c)return;const _0x45777e=Date[_0x55fd44(0x487)]()-_0x5ac20c,_0x5b7fc5=(_0x28f30a[_0x55fd44(0x1062)][_0x55fd44(0xd04)]||0x1)*0x3c*0x3c*0x3e8;_0x45777e>_0x5b7fc5&&(_0x425f56[_0x55fd44(0xaf4)][_0x55fd44(0x2a3)]=_0x55fd44(0x575),_0x581fd5(_0x425f56['id']));}else{if(_0x425f56[_0x55fd44(0xaf4)]?.['status']===_0x55fd44(0xab9)&&_0x425f56['id']!==_0x28f30a['activeChatId']){if(_0x425f56[_0x55fd44(0x362)][_0x55fd44(0x12ed)]===![]){console[_0x55fd44(0x415)](_0x55fd44(0xa18)+_0x425f56[_0x55fd44(0xe36)]+_0x55fd44(0x725));return;}Math[_0x55fd44(0x1337)]()<0.2&&(console['log'](_0x55fd44(0xa18)+_0x425f56[_0x55fd44(0xe36)]+'\x22\x20被唤醒，准备独立行动...'),_0xfd66ee(_0x425f56['id']));}}});const _0x340cd6=Object['values'](_0x28f30a['chats'])[_0x2beb80(0xebc)](_0x455743=>_0x455743[_0x2beb80(0x1423)]);_0x340cd6[_0x2beb80(0xf99)](_0x7e7d83=>{const _0x42abcd=_0x2beb80;if(_0x7e7d83[_0x42abcd(0x362)][_0x42abcd(0x12ed)]===![]){console[_0x42abcd(0x415)](_0x42abcd(0xd66)+_0x7e7d83[_0x42abcd(0xe36)]+_0x42abcd(0xbaf));return;}_0x7e7d83['id']!==_0x28f30a['activeChatId']&&Math[_0x42abcd(0x1337)]()<0.1&&(console['log'](_0x42abcd(0xd66)+_0x7e7d83[_0x42abcd(0xe36)]+_0x42abcd(0x1563)),_0x5a35ad(_0x7e7d83['id']));});try{const _0x4b4e4f=await _0x5b9d83['npcs'][_0x2beb80(0x14b5)]();if(_0x4b4e4f[_0x2beb80(0x9a1)]===0x0)return;const _0x103bc6=await _0x5b9d83[_0x2beb80(0xc7a)][_0x2beb80(0x106d)]('timestamp')[_0x2beb80(0x6c9)]()[_0x2beb80(0xd44)](0xa)[_0x2beb80(0x14b5)]();for(const _0x2a400e of _0x4b4e4f){if(_0x2a400e[_0x2beb80(0x12ed)]===![])continue;const _0x44d5c1=_0x2a400e['actionCooldownMinutes']||0xf;if(_0x2a400e[_0x2beb80(0x14e9)]){const _0x12bdc9=(Date[_0x2beb80(0x487)]()-_0x2a400e[_0x2beb80(0x14e9)])/(0x3e8*0x3c);if(_0x12bdc9<_0x44d5c1)continue;}if(Math[_0x2beb80(0x1337)]()>0.3)continue;const _0x1cb963=[];for(const _0x4b5b22 of _0x103bc6){if(_0x4b5b22[_0x2beb80(0xe87)]==='npc_'+_0x2a400e['id'])continue;const _0x3a9d68=_0x4b5b22[_0x2beb80(0x8a4)]?.[_0x2beb80(0x7e2)](_0x4a9cae=>_0x4a9cae[_0x2beb80(0x2f2)]===_0x2a400e[_0x2beb80(0xe36)]),_0x2e6c2d=_0x4b5b22[_0x2beb80(0x8a4)]?.[_0x2beb80(0x225)](-0x1)[0x0]?.[_0x2beb80(0x498)];if(_0x2e6c2d===_0x2a400e[_0x2beb80(0xe36)])continue;let _0x50d072=![];if(_0x4b5b22[_0x2beb80(0xe87)]===_0x2beb80(0xcc9)||_0x4b5b22[_0x2beb80(0xe87)][_0x2beb80(0x741)](_0x2beb80(0xc1e)))_0x2a400e[_0x2beb80(0xaef)][_0x2beb80(0x138a)](_0x4b5b22[_0x2beb80(0xe87)])&&(_0x50d072=!![]);else{if(_0x4b5b22['authorId']['startsWith'](_0x2beb80(0x3c8))){const _0x334ef0=parseInt(_0x4b5b22[_0x2beb80(0xe87)][_0x2beb80(0x13ed)](_0x2beb80(0x3c8),'')),_0x2427db=await _0x5b9d83[_0x2beb80(0x8f4)]['get'](_0x334ef0);if(_0x2427db){const _0x16c691=_0x2a400e['npcGroupId'],_0x7b687c=_0x2427db[_0x2beb80(0x2c3)];_0x16c691&&_0x7b687c&&_0x16c691===_0x7b687c&&(_0x50d072=!![]);}}}(_0x50d072||_0x3a9d68)&&_0x1cb963[_0x2beb80(0x367)](_0x4b5b22);}if(_0x1cb963[_0x2beb80(0x9a1)]>0x0||Math[_0x2beb80(0x1337)]()<0.2){console[_0x2beb80(0x415)](_0x2beb80(0xe8d)+_0x2a400e[_0x2beb80(0xe36)]+_0x2beb80(0x482));const _0x51ef51=await _0x35a06a(_0x2a400e,_0x1cb963);if(_0x51ef51&&_0x51ef51[_0x2beb80(0x9a1)]>0x0){for(const _0x4cab64 of _0x51ef51){if(_0x4cab64['type']===_0x2beb80(0x357)){const _0x35bff4=await _0x5b9d83[_0x2beb80(0xc7a)]['get'](_0x4cab64[_0x2beb80(0xa53)]);if(_0x35bff4){if(!_0x35bff4[_0x2beb80(0x8a4)])_0x35bff4[_0x2beb80(0x8a4)]=[];_0x35bff4[_0x2beb80(0x8a4)]['push']({'commenterName':_0x2a400e[_0x2beb80(0xe36)],'text':_0x4cab64[_0x2beb80(0x14ff)],'replyTo':_0x4cab64[_0x2beb80(0x2f2)]||null,'timestamp':Date[_0x2beb80(0x487)]()+Math['random']()}),await _0x5b9d83['qzonePosts']['update'](_0x4cab64[_0x2beb80(0xa53)],{'comments':_0x35bff4[_0x2beb80(0x8a4)]}),_0x3f09c8(_0x461b99+0x1);}}else{if(_0x4cab64[_0x2beb80(0xb4b)]===_0x2beb80(0x9eb)){const _0x8e00ea={'type':_0x4cab64[_0x2beb80(0x12f0)]||_0x2beb80(0x5e8),'content':_0x4cab64[_0x2beb80(0x1047)],'timestamp':Date[_0x2beb80(0x487)](),'authorId':_0x2beb80(0x3c8)+_0x2a400e['id'],'authorOriginalName':_0x2a400e[_0x2beb80(0xe36)],'visibleTo':_0x2a400e[_0x2beb80(0xaef)],'likes':[],'comments':[],'isDeleted':![]};await _0x5b9d83[_0x2beb80(0xc7a)]['add'](_0x8e00ea),console[_0x2beb80(0x415)](_0x2beb80(0xe8d)+_0x2a400e[_0x2beb80(0xe36)]+_0x2beb80(0xbb3)),_0x3f09c8(_0x461b99+0x1);}}}await _0x5b9d83['npcs'][_0x2beb80(0x130a)](_0x2a400e['id'],{'lastActionTimestamp':Date['now']()}),document[_0x2beb80(0x2ec)](_0x2beb80(0x11b2))['classList'][_0x2beb80(0xe9a)](_0x2beb80(0xd43))&&await _0x472608();}}}}catch(_0x22d7c4){console[_0x2beb80(0x1518)](_0x2beb80(0x161),_0x22d7c4);}}async function _0x35a06a(_0x2ecf4e,_0x46f826){const _0x378e3e=_0x475790,{proxyUrl:_0x302f53,apiKey:_0x420fd7,model:_0x40d298}=_0x28f30a[_0x378e3e(0x1537)];if(!_0x302f53||!_0x420fd7||!_0x40d298)return console['error'](_0x378e3e(0x10fd)),null;let _0xea95d='#\x20你的互动对象\x20(用户和其他角色)\x0a';const _0x246d71=_0x28f30a['qzoneSettings'][_0x378e3e(0x19a)]||'我',_0x2b1365=_0x28f30a['chats'][Object['keys'](_0x28f30a[_0x378e3e(0x6ce)])[0x0]]?.[_0x378e3e(0x362)][_0x378e3e(0x1528)]||'(未设置)';_0xea95d+=_0x378e3e(0xa82)+_0x246d71+_0x378e3e(0x103a)+_0x2b1365+'\x0a';_0x2ecf4e[_0x378e3e(0xaef)]&&_0x2ecf4e[_0x378e3e(0xaef)][_0x378e3e(0x9a1)]>0x0&&_0x2ecf4e['associatedWith'][_0x378e3e(0xf99)](_0x510cb4=>{const _0x48df2b=_0x378e3e,_0x539af5=_0x28f30a[_0x48df2b(0x6ce)][_0x510cb4];_0x539af5&&!_0x539af5[_0x48df2b(0x1423)]&&(_0xea95d+=_0x48df2b(0xa82)+_0x539af5['name']+_0x48df2b(0xc17)+_0x539af5[_0x48df2b(0x66c)]+')**:\x20'+_0x539af5[_0x48df2b(0x362)]['aiPersona']+'\x0a');});const _0x32d579=(await Promise[_0x378e3e(0xa92)](_0x46f826[_0x378e3e(0x11c6)](async _0x1f4f33=>{const _0xf8faff=_0x378e3e;let _0x271fb2=_0xf8faff(0x4cd);if(_0x1f4f33[_0xf8faff(0xe87)]==='user')_0x271fb2=_0x28f30a[_0xf8faff(0x1506)][_0xf8faff(0x19a)]||'用户';else{if(_0x1f4f33[_0xf8faff(0xe87)]['startsWith'](_0xf8faff(0xc1e)))_0x271fb2=_0x2fa4e1(_0x1f4f33[_0xf8faff(0xb6a)]||_0x1f4f33[_0xf8faff(0xe87)]);else{if(_0x1f4f33[_0xf8faff(0xe87)][_0xf8faff(0x741)](_0xf8faff(0x3c8))){const _0xfe4405=parseInt(_0x1f4f33[_0xf8faff(0xe87)][_0xf8faff(0x13ed)]('npc_','')),_0x1a663d=await _0x5b9d83['npcs'][_0xf8faff(0x6b5)](_0xfe4405);_0x1a663d&&(_0x271fb2=_0x1a663d[_0xf8faff(0xe36)]);}}}const _0x46df94=(_0x1f4f33[_0xf8faff(0x8a4)]||[])['map'](_0x1f65a4=>{const _0x4e2e1e=_0xf8faff;if(typeof _0x1f65a4===_0x4e2e1e(0x10c0)&&_0x1f65a4[_0x4e2e1e(0x498)]){const _0x52ff6e=_0x2fa4e1(_0x1f65a4[_0x4e2e1e(0x498)]);return _0x4e2e1e(0xa82)+_0x52ff6e+_0x4e2e1e(0x1057)+_0x1f65a4[_0x4e2e1e(0x10ca)];}return'-\x20'+_0x1f65a4;})[_0xf8faff(0xbad)]('\x0a');return _0xf8faff(0x304)+_0x1f4f33['id']+_0xf8faff(0x5fb)+_0x271fb2+_0xf8faff(0x737)+(_0x1f4f33['content']||_0x1f4f33[_0xf8faff(0x1202)]||'')['substring'](0x0,0x96)+'...\x0a-\x20**已有评论**:\x0a'+(_0x46df94||_0xf8faff(0x1469))+_0xf8faff(0x1d8);})))['join']('\x0a'),_0x1f60e9=_0x378e3e(0x3c8)+_0x2ecf4e['id'],_0x1e6425=Date[_0x378e3e(0x487)]()-0xc*0x3c*0x3c*0x3e8,_0x32282a=await _0x5b9d83[_0x378e3e(0xc7a)]['where'](_0x378e3e(0xe87))['equals'](_0x1f60e9)[_0x378e3e(0x79f)](_0xb419d5=>_0xb419d5[_0x378e3e(0x69a)]>_0x1e6425)[_0x378e3e(0x14b5)]();let _0x19bbef='';_0x32282a[_0x378e3e(0x9a1)]>0x0&&(_0x19bbef='\x0a#\x20【行为倾向指令\x20(高优先级)】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【唯一任务】就是**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【绝对禁止】再次发布新动态，除非你收到了直接的指令或有一个对剧情发展至关重要的、紧急的新想法。\x0a');const _0x2e188d=_0x378e3e(0xfb9)+_0x2ecf4e[_0x378e3e(0xe36)]+'”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a'+_0x19bbef+_0x378e3e(0x1093)+_0x2ecf4e['name']+'\x0a-\x20**人设**:\x20'+_0x2ecf4e[_0x378e3e(0xe32)]+'\x0a\x0a'+_0xea95d+_0x378e3e(0x1113)+_0x32d579+_0x378e3e(0x1503);try{const _0x3caae8=[{'role':_0x378e3e(0xcc9),'content':_0x378e3e(0xeb6)}];let _0xa051a8=_0x302f53[_0x378e3e(0x138a)](_0x378e3e(0xe9c)),_0x5a38d5=_0x4fff3d(_0x40d298,_0x420fd7,_0x2e188d,_0x3caae8);const _0x1d3ec1=_0xa051a8?await fetch(_0x5a38d5[_0x378e3e(0x6d1)],_0x5a38d5[_0x378e3e(0x1418)]):await fetch(_0x302f53+_0x378e3e(0x1427),{'method':_0x378e3e(0x655),'headers':{'Content-Type':_0x378e3e(0x1446),'Authorization':_0x378e3e(0xe83)+_0x420fd7},'body':JSON[_0x378e3e(0xe4d)]({'model':_0x40d298,'messages':[{'role':_0x378e3e(0x10a7),'content':_0x2e188d},..._0x3caae8],'temperature':_0x28f30a[_0x378e3e(0x1062)][_0x378e3e(0x294)]||0.9})});if(!_0x1d3ec1['ok'])throw new Error('API\x20错误:\x20'+_0x1d3ec1['statusText']);const _0x159749=await _0x1d3ec1['json'](),_0x1730b8=getGeminiResponseText(_0x159749),_0x550fee=_0x1730b8['match'](/(\[[\s\S]*\])/);if(!_0x550fee)throw new Error('AI返回的行动中未找到有效的JSON数组。');return JSON[_0x378e3e(0xd91)](_0x550fee[0x0]);}catch(_0x47d1ee){return console[_0x378e3e(0x1518)](_0x378e3e(0x13b6)+_0x2ecf4e[_0x378e3e(0xe36)]+_0x378e3e(0x926),_0x47d1ee),null;}}async function _0xfd66ee(_0x31c54e){const _0x4af6e2=_0x475790,_0x589e75=_0x28f30a['chats'][_0x31c54e];if(!_0x589e75)return;const _0x5d0d34=_0x589e75[_0x4af6e2(0x362)]['actionCooldownMinutes']||0xa;if(_0x589e75[_0x4af6e2(0x14e9)]){const _0x23b3b6=(Date[_0x4af6e2(0x487)]()-_0x589e75['lastActionTimestamp'])/(0x3e8*0x3c);if(_0x23b3b6<_0x5d0d34){console[_0x4af6e2(0x415)](_0x4af6e2(0xa18)+_0x589e75[_0x4af6e2(0xe36)]+'\x22\x20处于行动冷却中\x20(还剩\x20'+Math[_0x4af6e2(0x8f9)](_0x5d0d34-_0x23b3b6)+_0x4af6e2(0xc68));return;}}_0x48a755(_0x31c54e,!![]);const {proxyUrl:_0x19cb2a,apiKey:_0x4e90c4,model:_0x11a96f}=_0x28f30a[_0x4af6e2(0x1537)];if(!_0x19cb2a||!_0x4e90c4||!_0x11a96f)return;const _0xca0f8a=_0x28f30a[_0x4af6e2(0x1506)][_0x4af6e2(0x19a)],_0x27f0a6=new Date(),_0x697582=_0x589e75[_0x4af6e2(0x362)]['timeZone']||_0x4af6e2(0x96c),_0x22dafa=_0x27f0a6[_0x4af6e2(0xc4c)]('zh-CN',{'timeZone':_0x697582,'dateStyle':_0x4af6e2(0x1124),'timeStyle':'short'}),_0x10a489=new Date(_0x27f0a6[_0x4af6e2(0xc4c)](_0x4af6e2(0x7bb),{'timeZone':_0x697582}));let _0x10863a='',_0x37dcf0='',_0x5f26c9,_0x2286ce=![];const _0x56646b=_0x589e75[_0x4af6e2(0x362)][_0x4af6e2(0xfcd)]||0xa,_0x380d84=_0x589e75['history'][_0x4af6e2(0xebc)](_0x3992d1=>!_0x3992d1['isHidden'])[_0x4af6e2(0x225)](-_0x56646b),_0x27959f=_0x589e75['history']['filter'](_0x3ef30a=>!_0x3ef30a[_0x4af6e2(0x1162)])[_0x4af6e2(0x225)](-0x1)[0x0];if(_0x589e75[_0x4af6e2(0x362)]['enableTimePerception']){_0x10863a=_0x55bb06(_0x10a489);const _0x535cd6=_0x589e75[_0x4af6e2(0x12c3)][_0x4af6e2(0xebc)](_0x443f4b=>!_0x443f4b['isHidden'])[_0x4af6e2(0x225)](-0x1)[0x0],_0x38d5af=new Date();let _0x438405='',_0x152894=![];if(_0x535cd6){const _0x115016=new Date(_0x535cd6[_0x4af6e2(0x69a)]),_0x4ab60f=(_0x38d5af-_0x115016)/(0x3e8*0x3c*0x3c);if(_0x4ab60f>0x2){_0x152894=!![];const _0x7c942b=Math[_0x4af6e2(0x5f8)](_0x4ab60f/0x18);_0x438405='你们已经有'+(_0x7c942b>0x0?_0x7c942b+'天':Math[_0x4af6e2(0x5f8)](_0x4ab60f)+'小时')+'没有聊天了。';}else{const _0x25f6f7=Math[_0x4af6e2(0x5f8)](_0x4ab60f*0x3c);if(_0x25f6f7<0x5)_0x438405=_0x4af6e2(0xf34);else _0x25f6f7<0x3c?_0x438405=_0x4af6e2(0x12ac)+_0x25f6f7+_0x4af6e2(0x344):_0x438405=_0x4af6e2(0x12ac)+Math[_0x4af6e2(0x5f8)](_0x4ab60f)+_0x4af6e2(0xfff);}}else _0x152894=!![],_0x438405=_0x4af6e2(0x6b1);let _0x58d8e4=_0x4af6e2(0xca2);_0x380d84[_0x4af6e2(0x9a1)]>0x0&&(_0x58d8e4=_0x4af6e2(0x13ea)+_0x380d84[_0x4af6e2(0x11c6)](_0x869748=>{const _0x3395dc=_0x4af6e2,_0x59b5e5=_0x869748[_0x3395dc(0x9be)]==='user'?_0xca0f8a:_0x589e75['name'];return _0x59b5e5+':\x20'+String(_0x869748[_0x3395dc(0x1047)])[_0x3395dc(0xa6b)](0x0,0x32)+_0x3395dc(0x4e6);})[_0x4af6e2(0xbad)]('\x0a')),_0x152894?_0x5f26c9=_0x4af6e2(0x22a)+_0x438405+'\x20当前时间是\x20'+_0x22dafa+'.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a'+_0x58d8e4:_0x5f26c9=''+_0x58d8e4;}else _0x380d84[_0x4af6e2(0x9a1)]>0x0?_0x5f26c9='这是你们最近的对话：\x0a'+_0x380d84['map'](_0x53a795=>{const _0x5b494d=_0x4af6e2,_0x524add=_0x53a795[_0x5b494d(0x9be)]===_0x5b494d(0xcc9)?_0xca0f8a:_0x589e75[_0x5b494d(0xe36)];return _0x524add+':\x20'+String(_0x53a795[_0x5b494d(0x1047)])['substring'](0x0,0x32)+_0x5b494d(0x4e6);})[_0x4af6e2(0xbad)]('\x0a'):_0x5f26c9='你们最近没有有效聊天记录。';const _0x22387c=await _0x5b9d83[_0x4af6e2(0xc7a)][_0x4af6e2(0x106d)](_0x4af6e2(0x69a))['reverse']()[_0x4af6e2(0xd44)](0x5)[_0x4af6e2(0x14b5)](),_0x2f8962=_0x5b423c(_0x22387c,_0x589e75),_0x26e565=_0x2f8962[_0x4af6e2(0xebc)](_0xb462b7=>_0xb462b7[_0x4af6e2(0xe87)]===_0x31c54e);let _0x3a64d7='';_0x26e565[_0x4af6e2(0x9a1)]>0x0&&(_0x3a64d7='\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a',_0x26e565['forEach'](_0x522e9d=>{const _0x31540c=_0x4af6e2;let _0x8d0c09=(_0x522e9d[_0x31540c(0x1202)]||_0x522e9d[_0x31540c(0x1047)]||_0x31540c(0x88c))['substring'](0x0,0x28)+_0x31540c(0x4e6);_0x3a64d7+=_0x31540c(0x2e7)+_0x522e9d['id']+_0x31540c(0x19c)+_0x8d0c09+'\x22\x0a';}));let _0x485038=[];_0x2f8962[_0x4af6e2(0x9a1)]>0x0&&(_0x485038=_0x2f8962[_0x4af6e2(0x11c6)](_0x111f8a=>{const _0x186899=_0x4af6e2;let _0x4fa3ce;if(_0x111f8a[_0x186899(0xb4b)]==='text_image')_0x4fa3ce=('[一张图片，其隐藏文字为：“'+_0x111f8a[_0x186899(0xf05)]+_0x186899(0xc23)+(_0x111f8a['publicText']||''))['substring'](0x0,0x32)+_0x186899(0x4e6);else _0x111f8a[_0x186899(0xb4b)]==='image_post'?_0x4fa3ce=(_0x186899(0x60b)+_0x111f8a[_0x186899(0x7ca)]+_0x186899(0xc23)+(_0x111f8a['publicText']||''))[_0x186899(0xa6b)](0x0,0x32)+_0x186899(0x4e6):_0x4fa3ce=String(_0x111f8a[_0x186899(0x1202)]||_0x111f8a[_0x186899(0x1047)]||_0x186899(0x88c))[_0x186899(0xa6b)](0x0,0x32)+_0x186899(0x4e6);return'-\x20\x22'+_0x4fa3ce+'\x22';}));let _0x14bdab='';_0x485038['length']>0x0&&(_0x14bdab=_0x4af6e2(0x819)+_0x485038[_0x4af6e2(0xbad)]('\x0a')+_0x4af6e2(0xe7c));let _0xa93a50='';if(_0x589e75['settings']['linkedWorldBookIds']&&_0x589e75[_0x4af6e2(0x362)][_0x4af6e2(0x684)]['length']>0x0){const _0x373795=_0x589e75['settings'][_0x4af6e2(0x684)][_0x4af6e2(0x11c6)](_0x11bb84=>{const _0x385931=_0x4af6e2,_0x48bc38=_0x28f30a[_0x385931(0x13b9)]['find'](_0x50fe27=>_0x50fe27['id']===_0x11bb84);if(!_0x48bc38||!Array[_0x385931(0x624)](_0x48bc38[_0x385931(0x1047)]))return'';const _0x5b1609=_0x48bc38['content'][_0x385931(0xebc)](_0x464538=>_0x464538[_0x385931(0x400)]!==![])[_0x385931(0x11c6)](_0x4a3e22=>{const _0x750d7f=_0x385931;let _0x3ff23c=_0x750d7f(0xe5c)+(_0x4a3e22[_0x750d7f(0x70d)]||'无备注')+'\x0a';return _0x4a3e22[_0x750d7f(0xf6b)][_0x750d7f(0x9a1)]>0x0&&(_0x3ff23c+='**关键词:**\x20'+_0x4a3e22[_0x750d7f(0xf6b)][_0x750d7f(0xbad)](',\x20')+'\x0a'),_0x3ff23c+='**内容:**\x0a'+_0x4a3e22['content'],_0x3ff23c;})[_0x385931(0xbad)]('');return _0x5b1609?'\x0a\x0a##\x20世界书:\x20'+_0x48bc38[_0x385931(0xe36)]+'\x0a'+_0x5b1609:'';})[_0x4af6e2(0xebc)](Boolean)[_0x4af6e2(0xbad)]('');_0x373795&&(_0xa93a50=_0x4af6e2(0x14e0)+_0x373795+_0x4af6e2(0xcf2));}let _0x11840a='';const _0x3b4d9c=_0x589e75['settings'][_0x4af6e2(0x13cb)]||0xa;if(_0x589e75[_0x4af6e2(0x362)][_0x4af6e2(0x239)]&&_0x589e75[_0x4af6e2(0x362)]['linkedMemoryChatIds'][_0x4af6e2(0x9a1)]>0x0){const _0x12ca78=_0x589e75[_0x4af6e2(0x362)][_0x4af6e2(0x239)][_0x4af6e2(0x11c6)](_0x162463=>{const _0x47e615=_0x4af6e2,_0x244378=_0x28f30a['chats'][_0x162463];if(!_0x244378)return null;const _0x58e4ef=_0x244378[_0x47e615(0x12c3)][_0x47e615(0x225)](-0x1)[0x0];return{'chat':_0x244378,'latestTimestamp':_0x58e4ef?_0x58e4ef['timestamp']:0x0};})[_0x4af6e2(0xebc)](Boolean);_0x12ca78[_0x4af6e2(0x126b)]((_0x3319b4,_0x1bd7b6)=>_0x1bd7b6['latestTimestamp']-_0x3319b4[_0x4af6e2(0x1183)]),_0x11840a+=_0x4af6e2(0x661);for(const _0x213acb of _0x12ca78){const _0x420095=_0x213acb[_0x4af6e2(0x73b)],_0x5b4d51=_0x420095[_0x4af6e2(0x1423)]?_0x4af6e2(0xb5c):'[私聊]',_0x1dea31=_0x213acb['latestTimestamp']>0x0?_0x4af6e2(0x12c6)+_0xf1c86d(_0x213acb['latestTimestamp'])+')':'';_0x11840a+=_0x4af6e2(0xba7)+_0x5b4d51+'“'+_0x420095[_0x4af6e2(0xe36)]+'”的参考记忆'+_0x1dea31+_0x4af6e2(0x128b);const _0x40cd36=_0x420095[_0x4af6e2(0x12c3)]['slice'](-_0x3b4d9c),_0x48d13d=_0x40cd36['filter'](_0xe0d4f1=>!String(_0xe0d4f1['content'])['includes'](_0x4af6e2(0xe04)));_0x48d13d['length']>0x0?_0x48d13d[_0x4af6e2(0xf99)](_0x414fac=>{const _0xb4ca7a=_0x4af6e2,_0x648e32=_0x414fac['role']===_0xb4ca7a(0xcc9)?_0x420095[_0xb4ca7a(0x362)][_0xb4ca7a(0xa28)]||'我':_0x414fac[_0xb4ca7a(0x1361)]||_0x420095[_0xb4ca7a(0xe36)];let _0x981b9=String(_0x414fac[_0xb4ca7a(0x1047)]);if(_0x414fac[_0xb4ca7a(0xb4b)]===_0xb4ca7a(0x11c7)||_0x414fac[_0xb4ca7a(0xb4b)]===_0xb4ca7a(0x7f7))_0x981b9=_0xb4ca7a(0xcca)+_0x414fac[_0xb4ca7a(0x1047)]+']';else _0x414fac['type']===_0xb4ca7a(0x8bc)&&(_0x981b9=_0xb4ca7a(0x4ba)+_0x414fac['content']+']');_0x11840a+=_0x648e32+':\x20'+_0x981b9+'\x0a';}):_0x11840a+=_0x4af6e2(0x3f6);}}let _0x24d8ff='';if(_0x2f8962[_0x4af6e2(0x9a1)]>0x0){let _0x4f9fc9=_0x4af6e2(0x6fe);for(const _0x2eda96 of _0x2f8962){let _0x13b031;if(_0x2eda96[_0x4af6e2(0xe87)]===_0x4af6e2(0xcc9))_0x13b031=_0x28f30a[_0x4af6e2(0x1506)][_0x4af6e2(0x19a)];else{if(String(_0x2eda96[_0x4af6e2(0xe87)])[_0x4af6e2(0x741)]('npc_'))_0x13b031=_0x2eda96[_0x4af6e2(0xb6a)]||_0x4af6e2(0xd75);else{const _0x2a7aa7=_0x28f30a[_0x4af6e2(0x6ce)][_0x2eda96[_0x4af6e2(0xe87)]];_0x13b031=_0x2a7aa7?_0x2a7aa7['name']:_0x4af6e2(0x8b4);}}if(_0x2eda96[_0x4af6e2(0xe87)]===_0x31c54e)_0x13b031+='\x20(这是你的帖子)';let _0x438e74;if(_0x2eda96[_0x4af6e2(0xb4b)]===_0x4af6e2(0x11d5)){const _0x3dd245=_0x2eda96[_0x4af6e2(0x169)]?_0x4af6e2(0x9b5)+_0x2eda96[_0x4af6e2(0x169)]+'\x22':'';let _0x2a95ad=_0x4af6e2(0xe63);const _0x170e0b=_0x2eda96[_0x4af6e2(0x767)][_0x4af6e2(0xe87)];if(_0x170e0b===_0x4af6e2(0xcc9))_0x2a95ad=_0x28f30a['qzoneSettings'][_0x4af6e2(0x19a)];else _0x28f30a[_0x4af6e2(0x6ce)][_0x170e0b]&&(_0x2a95ad=_0x28f30a['chats'][_0x170e0b][_0x4af6e2(0xe36)]);let _0x32d72a;const _0x190e22=_0x2eda96[_0x4af6e2(0x767)];if(_0x190e22[_0x4af6e2(0xb4b)]===_0x4af6e2(0xaa4))_0x32d72a=_0x4af6e2(0x800)+(_0x190e22[_0x4af6e2(0x1202)]||'')+_0x4af6e2(0xda4)+(_0x190e22[_0x4af6e2(0xf05)]||'')[_0x4af6e2(0xa6b)](0x0,0x28)+_0x4af6e2(0x1079);else _0x190e22[_0x4af6e2(0xb4b)]===_0x4af6e2(0x126c)?_0x32d72a=_0x4af6e2(0x1409)+(_0x190e22[_0x4af6e2(0x1202)]||'')+'\x20(图片描述:\x20\x22'+(_0x190e22[_0x4af6e2(0x7ca)]||'')[_0x4af6e2(0xa6b)](0x0,0x28)+_0x4af6e2(0x1079):_0x32d72a='\x22'+(_0x190e22[_0x4af6e2(0x1047)]||'')['substring'](0x0,0x28)+_0x4af6e2(0x130e);_0x438e74=_0x4af6e2(0xcbd)+_0x2a95ad+_0x4af6e2(0x880)+_0x3dd245+_0x4af6e2(0x569)+_0x32d72a+'】';}else{if(_0x2eda96['type']===_0x4af6e2(0xaa4))_0x438e74=(_0x4af6e2(0x847)+_0x2eda96['hiddenContent']+_0x4af6e2(0xa5e)+(_0x2eda96[_0x4af6e2(0x1202)]||''))[_0x4af6e2(0xa6b)](0x0,0x32)+_0x4af6e2(0x4e6);else{if(_0x2eda96['type']===_0x4af6e2(0x126c))_0x438e74=(_0x4af6e2(0xb01)+_0x2eda96[_0x4af6e2(0x7ca)]+'\x22]\x20'+(_0x2eda96[_0x4af6e2(0x1202)]||''))[_0x4af6e2(0xa6b)](0x0,0x32)+'...';else{if(_0x2eda96[_0x4af6e2(0xb4b)]===_0x4af6e2(0xd92)&&_0x2eda96['prompt']){const _0x48656f=Array['isArray'](_0x2eda96['prompt'])?_0x2eda96[_0x4af6e2(0x9fd)]:[_0x2eda96[_0x4af6e2(0x9fd)]];_0x438e74=(_0x2eda96[_0x4af6e2(0x1202)]||'')+(_0x4af6e2(0x879)+_0x48656f[_0x4af6e2(0x9a1)]+_0x4af6e2(0x12a7)+_0x48656f['join'](',\x20')+']');}else _0x438e74=String(_0x2eda96[_0x4af6e2(0x1202)]||_0x2eda96[_0x4af6e2(0x1047)]||'一条动态')[_0x4af6e2(0xa6b)](0x0,0x32)+'...';}}}_0x4f9fc9+=_0x4af6e2(0x2e7)+_0x2eda96['id']+_0x4af6e2(0x1255)+_0x13b031+_0x4af6e2(0x660)+_0x438e74+'\x22\x0a';if(_0x2eda96[_0x4af6e2(0x8a4)]&&_0x2eda96[_0x4af6e2(0x8a4)][_0x4af6e2(0x9a1)]>0x0)for(const _0x24b5dc of _0x2eda96[_0x4af6e2(0x8a4)]){if(typeof _0x24b5dc===_0x4af6e2(0x10c0)&&_0x24b5dc[_0x4af6e2(0x498)]){const _0x225f82=_0x2fa4e1(_0x24b5dc[_0x4af6e2(0x498)]);let _0x1ce317=_0x24b5dc[_0x4af6e2(0x1488)]?_0x4af6e2(0x646)+_0x24b5dc[_0x4af6e2(0x1488)]+'\x27]':_0x24b5dc[_0x4af6e2(0x10ca)];_0x24b5dc['commenterName']===_0x589e75['originalName']?_0x4f9fc9+=_0x4af6e2(0x83c)+_0x1ce317+'\x0a':_0x4f9fc9+=_0x4af6e2(0xb8c)+_0x225f82+'\x20(本名:\x20'+_0x24b5dc[_0x4af6e2(0x498)]+_0x4af6e2(0xd30)+_0x1ce317+'\x0a';}}}_0x24d8ff=_0x4f9fc9;}const _0x5c6da6='#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a'+(_0x589e75[_0x4af6e2(0x153f)]&&_0x589e75[_0x4af6e2(0x153f)][_0x4af6e2(0x9a1)]>0x0?_0x589e75[_0x4af6e2(0x153f)][_0x4af6e2(0x11c6)](_0x509843=>_0x4af6e2(0x151a)+_0xf1c86d(_0x509843[_0x4af6e2(0x69a)])+')\x20'+_0x509843[_0x4af6e2(0x1047)])[_0x4af6e2(0xbad)]('\x0a'):_0x4af6e2(0x5ce)),_0x531199=_0x5bdf0b(_0x589e75,0x3,_0x4af6e2(0xe03)),_0x45d986=_0x5bdf0b(_0x589e75,0x6,'hours'),_0x1ac1bd=_0x5bdf0b(_0x589e75,0x9,_0x4af6e2(0xe03)),_0x123e30=_0x5bdf0b(_0x589e75,0x1,_0x4af6e2(0xb0b)),_0x465a5c=_0x5bdf0b(_0x589e75,0x3,_0x4af6e2(0xb0b)),_0x6b7a68=_0x5bdf0b(_0x589e75,0x7,_0x4af6e2(0xb0b));let _0x5d088b='';if(_0x531199||_0x45d986||_0x1ac1bd||_0x123e30||_0x465a5c||_0x6b7a68){_0x5d088b+=_0x4af6e2(0xba8);if(_0x531199)_0x5d088b+=_0x531199;if(_0x45d986)_0x5d088b+=_0x45d986;if(_0x1ac1bd)_0x5d088b+=_0x1ac1bd;if(_0x531199||_0x45d986||_0x1ac1bd)_0x5d088b+='\x0a';if(_0x123e30)_0x5d088b+=_0x123e30;if(_0x465a5c)_0x5d088b+=_0x465a5c;if(_0x6b7a68)_0x5d088b+=_0x6b7a68;}const _0x40bc9f=_0x23eb2e(_0x589e75),_0x468209='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22'+_0x589e75[_0x4af6e2(0xe36)]+_0x4af6e2(0x195)+_0x589e75[_0x4af6e2(0x66c)]+_0x4af6e2(0x1267)+_0xca0f8a+_0x4af6e2(0x281)+(_0x589e75['settings'][_0x4af6e2(0x425)]?'\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是'+_0x22dafa+'\x20('+_0x10863a+')}。\x0a-\x20**对话状态**:\x20'+_0x37dcf0+'\x0a'+(_0x2286ce?_0x4af6e2(0x180):''):'')+_0x4af6e2(0xef4)+(_0x589e75[_0x4af6e2(0xecf)]||'无')+_0x4af6e2(0x153b)+_0x14bdab+_0x4af6e2(0xe7c)+_0x3a64d7+_0x4af6e2(0x6b0)+_0x589e75['settings'][_0x4af6e2(0x67c)]+_0x4af6e2(0xe7c)+_0xa93a50+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x589e75[_0x4af6e2(0x153f)]&&_0x589e75['longTermMemory'][_0x4af6e2(0x9a1)]>0x0?_0x589e75[_0x4af6e2(0x153f)][_0x4af6e2(0x11c6)](_0x35b392=>_0x4af6e2(0x151a)+_0xf1c86d(_0x35b392[_0x4af6e2(0x69a)])+')\x20'+_0x35b392[_0x4af6e2(0x1047)])[_0x4af6e2(0xbad)]('\x0a'):'无')+_0x4af6e2(0xe7c)+_0x5d088b+_0x4af6e2(0xdf3)+_0x11840a+_0x4af6e2(0xe7c)+(_0x589e75['settings']['enableTimePerception']?_0x4af6e2(0x5c6)+_0x22dafa+'\x20('+_0x10863a+')':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x589e75[_0x4af6e2(0x362)]['enableTimePerception']?_0x4af6e2(0xbcb)+_0x37dcf0:'')+_0x4af6e2(0xa8c)+_0x40bc9f+_0x4af6e2(0xc01)+_0x5f26c9+_0x4af6e2(0xe7c)+_0x24d8ff+'\x0a',_0x31bc47=[{'role':_0x4af6e2(0x10a7),'content':_0x468209},..._0x380d84[_0x4af6e2(0x11c6)](_0x1f22ba=>{const _0x2097a2=_0x4af6e2,_0x4aaa01=_0x1f22ba[_0x2097a2(0x9be)]===_0x2097a2(0xcc9)?_0xca0f8a:_0x589e75[_0x2097a2(0xe36)];let _0x43e282=_0x1f22ba[_0x2097a2(0x1047)];return typeof _0x43e282!==_0x2097a2(0x863)&&(_0x43e282=JSON[_0x2097a2(0xe4d)](_0x43e282)),{'role':_0x1f22ba[_0x2097a2(0x9be)],'content':_0x4aaa01+':\x20'+_0x43e282};})];try{const _0x2cb8cb=[{'role':_0x4af6e2(0xcc9),'content':_0x468209+_0x4af6e2(0x354)+_0x24d8ff}];console['log'](_0x4af6e2(0x1413)+_0x589e75[_0x4af6e2(0xe36)]+'\x22)');let _0x1d782c=_0x19cb2a===GEMINI_API_URL,_0x3a6835=_0x4fff3d(_0x11a96f,_0x4e90c4,_0x468209,_0x2cb8cb);const _0x306c60=_0x1d782c?await fetch(_0x3a6835[_0x4af6e2(0x6d1)],_0x3a6835[_0x4af6e2(0x1418)]):await fetch(_0x19cb2a+_0x4af6e2(0x1427),{'method':_0x4af6e2(0x655),'headers':{'Content-Type':_0x4af6e2(0x1446),'Authorization':'Bearer\x20'+_0x4e90c4},'body':JSON[_0x4af6e2(0xe4d)]({'model':_0x11a96f,'messages':_0x2cb8cb,'temperature':_0x28f30a[_0x4af6e2(0x1062)]['apiTemperature']||0.9})});if(!_0x306c60['ok']){const _0xd48ace=await _0x306c60[_0x4af6e2(0x12a2)]();throw new Error(_0x4af6e2(0x320)+_0x306c60[_0x4af6e2(0x2a3)]+_0x4af6e2(0xf8a)+JSON[_0x4af6e2(0xe4d)](_0xd48ace));}const _0x1875dc=await _0x306c60[_0x4af6e2(0x12a2)](),_0x356ac4=_0x1d782c?getGeminiResponseText(_0x1875dc):_0x1875dc[_0x4af6e2(0x8cd)][0x0][_0x4af6e2(0x13bc)][_0x4af6e2(0x1047)];if(!_0x356ac4||_0x356ac4['trim']()===''){console['warn'](_0x4af6e2(0x2e1)+_0x589e75[_0x4af6e2(0xe36)]+_0x4af6e2(0x1280));return;}const _0x4aba0e=_0x422882(_0x356ac4);if(!_0x4aba0e||_0x4aba0e[_0x4af6e2(0x9a1)]===0x0){console[_0x4af6e2(0x664)](_0x4af6e2(0xf75)+_0x589e75['name']+_0x4af6e2(0x113d),_0x356ac4);return;}let _0x2fd4d6=Date[_0x4af6e2(0x487)](),_0x21cf69=![];const _0x4c3c47=[];for(const _0x5d8993 of _0x4aba0e){const _0x445094=String(_0x5d8993[_0x4af6e2(0x1047)]||''),_0x1fcbc3=_0x445094[_0x4af6e2(0x97e)]()['startsWith']('<')&&_0x445094[_0x4af6e2(0x97e)]()[_0x4af6e2(0xa64)]('>');if(_0x5d8993[_0x4af6e2(0xb4b)]===_0x4af6e2(0x10ca)&&!_0x1fcbc3&&_0x445094[_0x4af6e2(0x138a)]('\x0a')){const _0x399913=_0x445094[_0x4af6e2(0xa8a)](/\n+/)[_0x4af6e2(0xebc)](_0x4891b1=>_0x4891b1['trim']());_0x399913[_0x4af6e2(0xf99)](_0x605cd4=>{const _0x1e2c86=_0x4af6e2;_0x4c3c47[_0x1e2c86(0x367)]({..._0x5d8993,'content':_0x605cd4});});}else _0x4c3c47[_0x4af6e2(0x367)](_0x5d8993);}for(const _0x2f93bf of _0x4c3c47){_0x589e75[_0x4af6e2(0xecf)]=_0x2f93bf['type'],_0x589e75[_0x4af6e2(0x14e9)]=_0x2fd4d6;let _0x415aec=null;const _0x45bc93={'role':_0x4af6e2(0x6d9),'senderName':_0x589e75['originalName'],'timestamp':_0x2fd4d6++};let _0x5ea5d8=null;switch(_0x2f93bf[_0x4af6e2(0xb4b)]){case _0x4af6e2(0x154f):{const _0x59e388=parseInt(_0x2f93bf['postId']),_0x6e1a17=await _0x5b9d83[_0x4af6e2(0xc7a)][_0x4af6e2(0x6b5)](_0x59e388);if(_0x6e1a17&&_0x6e1a17[_0x4af6e2(0xe87)]===_0x31c54e){await _0x5b9d83[_0x4af6e2(0xc7a)][_0x4af6e2(0x130a)](_0x59e388,{'isDeleted':!![]});document[_0x4af6e2(0x2ec)](_0x4af6e2(0x11b2))['classList'][_0x4af6e2(0xe9a)](_0x4af6e2(0xd43))&&_0x472608();const _0x23e48d={'role':_0x4af6e2(0x10a7),'type':_0x4af6e2(0x5fe),'content':'['+_0x589e75[_0x4af6e2(0xe36)]+_0x4af6e2(0xbce),'postId':_0x59e388,'timestamp':_0x2fd4d6++};_0x589e75['history'][_0x4af6e2(0x367)](_0x23e48d),isViewingThisChat?_0x4cc03e(_0x23e48d,_0x589e75):(_0x589e75['unreadCount']=(_0x589e75[_0x4af6e2(0xce1)]||0x0)+0x1,_0x1c12fe(_0x31c54e,'['+_0x589e75['name']+_0x4af6e2(0xbce)),_0x21cf69=!![]);}else console[_0x4af6e2(0x664)](_0x4af6e2(0xa5f)+_0x589e75[_0x4af6e2(0xe36)]+_0x4af6e2(0x1569)+_0x2f93bf[_0x4af6e2(0xa53)]+')');continue;}case'text':_0x415aec={..._0x45bc93,'content':_0x2f93bf[_0x4af6e2(0x1047)]};break;case'ai_image':_0x415aec={..._0x45bc93,'type':_0x4af6e2(0x11c7),'content':_0x2f93bf[_0x4af6e2(0x9cc)]};break;case _0x4af6e2(0x14f3):if(_0x2f93bf[_0x4af6e2(0x1488)]){const _0xef1de9=_0x28f30a['userStickers']['find'](_0x16133d=>_0x16133d['name']===_0x2f93bf['meaning']);_0xef1de9?_0x415aec={..._0x45bc93,'type':_0x4af6e2(0x14f3),'content':_0xef1de9[_0x4af6e2(0x6d1)],'meaning':_0xef1de9[_0x4af6e2(0xe36)]}:(console[_0x4af6e2(0x664)](_0x4af6e2(0x918)+_0x2f93bf[_0x4af6e2(0x1488)]+'\x22'),_0x415aec={..._0x45bc93,'type':_0x4af6e2(0x10ca),'content':_0x4af6e2(0x4f3)+_0x2f93bf[_0x4af6e2(0x1488)]+']'});}else console[_0x4af6e2(0x664)](_0x4af6e2(0x209),_0x2f93bf),_0x415aec={..._0x45bc93,'type':_0x4af6e2(0x14f3),'content':_0x2f93bf[_0x4af6e2(0x6d1)],'meaning':_0x4af6e2(0x2ca)};break;case _0x4af6e2(0x414):_0x589e75[_0x4af6e2(0x2a3)][_0x4af6e2(0x10ca)]=_0x2f93bf[_0x4af6e2(0xfb1)],_0x589e75[_0x4af6e2(0x2a3)][_0x4af6e2(0x14f9)]=_0x2f93bf['is_busy']||![],_0x589e75[_0x4af6e2(0x2a3)]['lastUpdate']=Date[_0x4af6e2(0x487)]();break;case _0x4af6e2(0x9eb):const _0x652ce7={'type':_0x2f93bf[_0x4af6e2(0x12f0)],'content':_0x2f93bf[_0x4af6e2(0x1047)]||'','publicText':_0x2f93bf[_0x4af6e2(0x1202)]||'','hiddenContent':_0x2f93bf[_0x4af6e2(0xf05)]||'','image_prompt':_0x2f93bf[_0x4af6e2(0xe8f)]||'','timestamp':Date[_0x4af6e2(0x487)](),'authorId':_0x31c54e,'authorOriginalName':_0x589e75[_0x4af6e2(0x66c)],'authorGroupId':_0x589e75[_0x4af6e2(0x1542)],'visibleGroupIds':null};await _0x5b9d83[_0x4af6e2(0xc7a)]['add'](_0x652ce7),_0x3f09c8(_0x461b99+0x1),console['log'](_0x4af6e2(0x490)+_0x589e75[_0x4af6e2(0xe36)]+'\x22\x20发布了动态');break;case'repost':const _0x3af14e=await _0x5b9d83[_0x4af6e2(0xc7a)][_0x4af6e2(0x6b5)](parseInt(_0x2f93bf[_0x4af6e2(0xa53)]));if(_0x3af14e){const _0x5cf749={'type':_0x4af6e2(0x11d5),'timestamp':Date['now'](),'authorId':_0x31c54e,'authorGroupId':_0x589e75[_0x4af6e2(0x1542)],'authorOriginalName':_0x589e75[_0x4af6e2(0x66c)],'repostComment':_0x2f93bf[_0x4af6e2(0x70d)]||'','originalPost':_0x3af14e,'visibleGroupIds':null};await _0x5b9d83[_0x4af6e2(0xc7a)][_0x4af6e2(0xe82)](_0x5cf749),_0x3f09c8(_0x461b99+0x1),console[_0x4af6e2(0x415)](_0x4af6e2(0x490)+_0x589e75[_0x4af6e2(0xe36)]+'\x22\x20转发了动态\x20#'+_0x2f93bf[_0x4af6e2(0xa53)]);}break;case _0x4af6e2(0x130c):const _0x4096b2=await _0x5b9d83[_0x4af6e2(0xc7a)]['get'](parseInt(_0x2f93bf[_0x4af6e2(0xa53)]));if(_0x4096b2){if(!_0x4096b2[_0x4af6e2(0x12b3)])_0x4096b2[_0x4af6e2(0x12b3)]=[];!_0x4096b2['likes']['includes'](_0x589e75[_0x4af6e2(0x66c)])&&(_0x4096b2[_0x4af6e2(0x12b3)][_0x4af6e2(0x367)](_0x589e75[_0x4af6e2(0x66c)]),await _0x5b9d83['qzonePosts']['update'](_0x4096b2['id'],{'likes':_0x4096b2[_0x4af6e2(0x12b3)]}),_0x3f09c8(_0x461b99+0x1),console[_0x4af6e2(0x415)](_0x4af6e2(0x490)+_0x589e75[_0x4af6e2(0xe36)]+_0x4af6e2(0x3a1)+_0x2f93bf[_0x4af6e2(0xa53)]));}break;case _0x4af6e2(0x357):{const _0x34a288=await _0x5b9d83[_0x4af6e2(0xc7a)][_0x4af6e2(0x6b5)](parseInt(_0x2f93bf[_0x4af6e2(0xa53)]));if(_0x34a288){if(!_0x34a288[_0x4af6e2(0x8a4)])_0x34a288[_0x4af6e2(0x8a4)]=[];const _0x515fcf=_0x2f93bf[_0x4af6e2(0xe36)]||_0x589e75['originalName'],_0x424a47=(_0x13bd7d,_0x4e1ee9=null,_0x2e9acf=null)=>({'commenterName':_0x515fcf,'text':_0x50f96e(_0x13bd7d,_0x589e75),'meaning':_0x4e1ee9,'replyTo':_0x2e9acf,'timestamp':Date[_0x4af6e2(0x487)]()});if(_0x2f93bf['stickerMeaning']){const _0x49499e=_0x28f30a[_0x4af6e2(0xf28)]['find'](_0x53f66e=>_0x53f66e['name']===_0x2f93bf['stickerMeaning']);_0x49499e?_0x34a288[_0x4af6e2(0x8a4)]['push'](_0x424a47(_0x49499e[_0x4af6e2(0x6d1)],_0x49499e[_0x4af6e2(0xe36)],_0x2f93bf[_0x4af6e2(0x2f2)]||null)):(console[_0x4af6e2(0x664)]('AI\x20尝试评论一个不存在的表情:\x20\x22'+_0x2f93bf[_0x4af6e2(0x1011)]+'\x22'),_0x34a288[_0x4af6e2(0x8a4)][_0x4af6e2(0x367)](_0x424a47(_0x4af6e2(0x4f3)+_0x2f93bf[_0x4af6e2(0x1011)]+']',null,_0x2f93bf[_0x4af6e2(0x2f2)]||null)));}else{if(Array[_0x4af6e2(0x624)](_0x2f93bf['comments']))_0x2f93bf[_0x4af6e2(0x8a4)][_0x4af6e2(0xf99)](_0x401661=>{const _0x443f2d=_0x4af6e2;typeof _0x401661===_0x443f2d(0x863)&&_0x401661['trim']()&&_0x34a288[_0x443f2d(0x8a4)]['push'](_0x424a47(_0x401661,null,_0x2f93bf[_0x443f2d(0x2f2)]||null));});else typeof _0x2f93bf[_0x4af6e2(0x14ff)]===_0x4af6e2(0x863)&&_0x2f93bf[_0x4af6e2(0x14ff)][_0x4af6e2(0x97e)]()&&_0x34a288[_0x4af6e2(0x8a4)][_0x4af6e2(0x367)](_0x424a47(_0x2f93bf['commentText'],null,_0x2f93bf[_0x4af6e2(0x2f2)]||null));}await _0x5b9d83[_0x4af6e2(0xc7a)]['update'](_0x34a288['id'],{'comments':_0x34a288['comments']}),_0x3f09c8(_0x461b99+0x1),console[_0x4af6e2(0x415)](_0x4af6e2(0x490)+_0x589e75[_0x4af6e2(0xe36)]+'\x22\x20评论了动态\x20#'+_0x2f93bf['postId']);if(!_0x589e75[_0x4af6e2(0x229)])_0x589e75['commentCooldowns']={};_0x589e75[_0x4af6e2(0x229)][_0x2f93bf[_0x4af6e2(0xa53)]]=Date['now']();}continue;}case _0x4af6e2(0x11ce):!_0x20bfc1[_0x4af6e2(0xffc)]&&!_0x20bfc1['isAwaitingResponse']&&(_0x20bfc1[_0x4af6e2(0x122a)]=!![],_0x20bfc1['activeChatId']=_0x31c54e,_0x20bfc1[_0x4af6e2(0x131e)]=![],_0x20bfc1[_0x4af6e2(0x2bb)]=_0x589e75[_0x4af6e2(0xe36)],_0x19c8ce());break;default:console[_0x4af6e2(0x664)](_0x4af6e2(0xa18)+_0x589e75[_0x4af6e2(0xe36)]+'\x22\x20尝试执行未知的后台动作:',_0x2f93bf['type']);break;case _0x4af6e2(0x50f):{const _0x5b9cb4=_0x2f93bf[_0x4af6e2(0xe36)],_0x5cbb6f=_0x589e75[_0x4af6e2(0x362)]['aiAvatarLibrary'][_0x4af6e2(0x412)](_0x2568e4=>_0x2568e4['name']===_0x5b9cb4);_0x5cbb6f&&(_0x589e75[_0x4af6e2(0x362)]['aiAvatar']=_0x5cbb6f['url'],await _0x50cbc4(_0x589e75),visibleSystemMessage={'content':'['+_0x589e75[_0x4af6e2(0xe36)]+_0x4af6e2(0x690)},console[_0x4af6e2(0x415)]('后台活动:\x20角色\x20\x22'+_0x589e75[_0x4af6e2(0xe36)]+'\x22\x20更换了头像'));break;}}if(_0x415aec){_0x589e75[_0x4af6e2(0x12c3)][_0x4af6e2(0x367)](_0x415aec),_0x589e75[_0x4af6e2(0xce1)]=(_0x589e75[_0x4af6e2(0xce1)]||0x0)+0x1;if(!_0x21cf69){let _0x3355fa=_0x415aec[_0x4af6e2(0xb4b)]===_0x4af6e2(0x11c7)?'[图片]':_0x415aec[_0x4af6e2(0x1047)]||'';_0x1c12fe(_0x31c54e,_0x3355fa),_0x21cf69=!![];}}}await _0x5b9d83[_0x4af6e2(0x6ce)][_0x4af6e2(0x7c3)](_0x589e75);}catch(_0x5c6bf9){console[_0x4af6e2(0x1518)](_0x4af6e2(0xa18)+_0x589e75['name']+_0x4af6e2(0x59c),_0x5c6bf9);}finally{_0x48a755(_0x31c54e,![]),_0x5db8a3(),document['getElementById'](_0x4af6e2(0x11b2))[_0x4af6e2(0xff6)][_0x4af6e2(0xe9a)]('active')&&_0x472608();}}async function _0x5a35ad(_0x5e19a8){const _0x39ee1b=_0x475790,_0x1f5bbc=_0x28f30a[_0x39ee1b(0x6ce)][_0x5e19a8];if(!_0x1f5bbc||!_0x1f5bbc[_0x39ee1b(0x1423)])return;const _0x5b28a2=_0x1f5bbc[_0x39ee1b(0x362)][_0x39ee1b(0xff3)]||0xa;if(_0x1f5bbc[_0x39ee1b(0x14e9)]){const _0x3a6752=(Date[_0x39ee1b(0x487)]()-_0x1f5bbc[_0x39ee1b(0x14e9)])/(0x3e8*0x3c);if(_0x3a6752<_0x5b28a2){console[_0x39ee1b(0x415)](_0x39ee1b(0xd66)+_0x1f5bbc[_0x39ee1b(0xe36)]+_0x39ee1b(0x2ad));return;}}const {proxyUrl:_0x50809f,apiKey:_0x4419d6,model:_0x5a8d17}=_0x28f30a[_0x39ee1b(0x1537)];if(!_0x50809f||!_0x4419d6||!_0x5a8d17)return;const _0x26abc2=_0x1f5bbc[_0x39ee1b(0x362)]['myNickname']||'我',_0xd931f1=new Date();let _0x4a5198;const _0x15ecdd=_0x1f5bbc[_0x39ee1b(0x12c3)][_0x39ee1b(0xebc)](_0x1f23c3=>!_0x1f23c3[_0x39ee1b(0x1162)])[_0x39ee1b(0x225)](-0x5),_0x53d4e4=_0x15ecdd['find'](_0x2f7a1d=>_0x2f7a1d['type']===_0x39ee1b(0x512)&&!_0x2f7a1d[_0x39ee1b(0x1410)]);if(_0x53d4e4){const _0x213af3=_0x4f967c(_0x1f5bbc,_0x53d4e4['senderName']);console['log'](_0x39ee1b(0xb17)+_0x1f5bbc[_0x39ee1b(0xe36)]+'\x22\x20中有未领完的红包，正在生成抢红包指令...'),_0x4a5198=_0x39ee1b(0xbc1)+_0x213af3+_0x39ee1b(0xbd6)+_0x53d4e4[_0x39ee1b(0x69a)]+_0x39ee1b(0x88b)+_0x53d4e4[_0x39ee1b(0x69a)]+_0x39ee1b(0x2fa);}else{let _0x47d30f='';const _0x14d793=_0x1f5bbc[_0x39ee1b(0x362)][_0x39ee1b(0xfbe)]||_0x39ee1b(0x96c),_0x3bed81=_0xd931f1[_0x39ee1b(0xc4c)]('zh-CN',{'timeZone':_0x14d793,'dateStyle':'full','timeStyle':_0x39ee1b(0xd90)}),_0x45b84b=new Date(_0xd931f1[_0x39ee1b(0xc4c)](_0x39ee1b(0x7bb),{'timeZone':_0x14d793}));if(_0x1f5bbc['settings'][_0x39ee1b(0x425)]){const _0x96ca3c=_0x1f5bbc['history']['filter'](_0xced1b1=>!_0xced1b1[_0x39ee1b(0x1162)])[_0x39ee1b(0x225)](-0x1)[0x0];if(_0x96ca3c){const _0x258d7b=new Date(_0x96ca3c[_0x39ee1b(0x69a)]),_0x26215d=(_0xd931f1-_0x258d7b)/(0x3e8*0x3c);_0x26215d>0x3c?_0x47d30f=_0x39ee1b(0x11eb)+Math[_0x39ee1b(0x8f9)](_0x26215d/0x3c)+_0x39ee1b(0x9ac):_0x47d30f=_0x39ee1b(0xef3)+Math[_0x39ee1b(0x5f8)](_0x26215d)+_0x39ee1b(0x62f);}else _0x47d30f=_0x39ee1b(0x11de);}let _0x2cee55=_0x39ee1b(0xca2);const _0x6d507a=_0x1f5bbc['settings']['maxMemory']||0xa,_0x980ddf=_0x1f5bbc[_0x39ee1b(0x12c3)][_0x39ee1b(0xebc)](_0x183bcd=>!_0x183bcd[_0x39ee1b(0x1162)])[_0x39ee1b(0x225)](-_0x6d507a);_0x980ddf['length']>0x0&&(_0x2cee55='这是你们最近的对话：\x0a'+_0x980ddf[_0x39ee1b(0x11c6)](_0x5162f8=>{const _0x4b22aa=_0x39ee1b,_0x3298bf=_0x5162f8[_0x4b22aa(0x9be)]==='user'?_0x26abc2:_0x4f967c(_0x1f5bbc,_0x5162f8[_0x4b22aa(0x1361)]),_0xfdf25c=String(_0x5162f8['content']||_0x5162f8[_0x4b22aa(0x13bc)]||'')['substring'](0x0,0x32);return _0x3298bf+':\x20'+_0xfdf25c+_0x4b22aa(0x4e6);})['join']('\x0a'));const _0x2520ef=_0x1f5bbc[_0x39ee1b(0x10f2)][_0x39ee1b(0x11c6)](_0x231061=>_0x39ee1b(0xa82)+_0x231061[_0x39ee1b(0x8a8)]+_0x39ee1b(0xb43)+_0x231061['originalName']+'):\x20'+_0x231061[_0x39ee1b(0xe32)])['join']('\x0a');let _0x5d1edf=_0x39ee1b(0x71d),_0x378774=![];_0x1f5bbc[_0x39ee1b(0x10f2)][_0x39ee1b(0xf99)](_0x3446c4=>{const _0x59a62f=_0x39ee1b,_0x281f0b=_0x28f30a['chats'][_0x3446c4['id']];_0x281f0b&&_0x281f0b['longTermMemory']&&_0x281f0b['longTermMemory']['length']>0x0&&(_0x5d1edf+=_0x59a62f(0xa4e)+_0x3446c4[_0x59a62f(0x8a8)]+'”的记忆\x20---\x0a',_0x5d1edf+=_0x281f0b[_0x59a62f(0x153f)][_0x59a62f(0x11c6)](_0x1527d2=>'-\x20'+_0x1527d2[_0x59a62f(0x1047)])[_0x59a62f(0xbad)]('\x0a'),_0x378774=!![]);});!_0x378774&&(_0x5d1edf+=_0x39ee1b(0x5ce));let _0x4a064a='';if(_0x1f5bbc[_0x39ee1b(0x362)]['linkedWorldBookIds']&&_0x1f5bbc[_0x39ee1b(0x362)][_0x39ee1b(0x684)][_0x39ee1b(0x9a1)]>0x0){const _0x5966cc=_0x1f5bbc[_0x39ee1b(0x362)][_0x39ee1b(0x684)][_0x39ee1b(0x11c6)](_0x19a25f=>{const _0x281c70=_0x39ee1b,_0x3a2447=_0x28f30a[_0x281c70(0x13b9)][_0x281c70(0x412)](_0x379fb0=>_0x379fb0['id']===_0x19a25f);if(!_0x3a2447||!Array['isArray'](_0x3a2447[_0x281c70(0x1047)]))return'';const _0x1ea122=_0x3a2447[_0x281c70(0x1047)][_0x281c70(0xebc)](_0x1e62b2=>_0x1e62b2[_0x281c70(0x400)]!==![])[_0x281c70(0x11c6)](_0x178629=>{const _0x422895=_0x281c70;let _0x5c4a9a=_0x422895(0xe5c)+(_0x178629['comment']||_0x422895(0x342))+'\x0a';return _0x178629[_0x422895(0xf6b)][_0x422895(0x9a1)]>0x0&&(_0x5c4a9a+='**关键词:**\x20'+_0x178629[_0x422895(0xf6b)]['join'](',\x20')+'\x0a'),_0x5c4a9a+=_0x422895(0x140c)+_0x178629['content'],_0x5c4a9a;})[_0x281c70(0xbad)]('');return _0x1ea122?_0x281c70(0xbd0)+_0x3a2447['name']+'\x0a'+_0x1ea122:'';})[_0x39ee1b(0xebc)](Boolean)['join']('');_0x5966cc&&(_0x4a064a=_0x39ee1b(0x14e0)+_0x5966cc+_0x39ee1b(0xcf2));}let _0x4becb4='';const _0x1b8621=_0x1f5bbc[_0x39ee1b(0x362)]['linkedMemoryCount']||0xa;if(_0x1f5bbc[_0x39ee1b(0x362)]['linkedMemoryChatIds']&&_0x1f5bbc[_0x39ee1b(0x362)][_0x39ee1b(0x239)]['length']>0x0){const _0x5538c1=_0x1f5bbc[_0x39ee1b(0x362)][_0x39ee1b(0x239)][_0x39ee1b(0x11c6)](_0x4c9ceb=>{const _0x339c77=_0x39ee1b,_0x296651=_0x28f30a[_0x339c77(0x6ce)][_0x4c9ceb];if(!_0x296651)return null;const _0x3d32f5=_0x296651[_0x339c77(0x12c3)][_0x339c77(0x225)](-0x1)[0x0];return{'chat':_0x296651,'latestTimestamp':_0x3d32f5?_0x3d32f5[_0x339c77(0x69a)]:0x0};})[_0x39ee1b(0xebc)](Boolean);_0x5538c1[_0x39ee1b(0x126b)]((_0x4a3751,_0x104013)=>_0x104013[_0x39ee1b(0x1183)]-_0x4a3751[_0x39ee1b(0x1183)]),_0x4becb4+='\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a';for(const _0x31fa36 of _0x5538c1){const _0x52db4e=_0x31fa36[_0x39ee1b(0x73b)],_0x43a873=_0x52db4e[_0x39ee1b(0x1423)]?_0x39ee1b(0xb5c):_0x39ee1b(0xe1d),_0x2ad462=_0x31fa36[_0x39ee1b(0x1183)]>0x0?_0x39ee1b(0x12c6)+_0xf1c86d(_0x31fa36[_0x39ee1b(0x1183)])+')':'';_0x4becb4+=_0x39ee1b(0xba7)+_0x43a873+'“'+_0x52db4e[_0x39ee1b(0xe36)]+_0x39ee1b(0x1549)+_0x2ad462+'\x20---\x0a';const _0x1518b8=_0x52db4e[_0x39ee1b(0x12c3)][_0x39ee1b(0x225)](-_0x1b8621),_0x2f99ba=_0x1518b8['filter'](_0x112566=>!String(_0x112566[_0x39ee1b(0x1047)])[_0x39ee1b(0x138a)]('已被用户删除'));_0x2f99ba[_0x39ee1b(0x9a1)]>0x0?_0x2f99ba[_0x39ee1b(0xf99)](_0x3a1120=>{const _0x1c8a55=_0x39ee1b,_0x61550f=_0x3a1120[_0x1c8a55(0x9be)]===_0x1c8a55(0xcc9)?_0x52db4e[_0x1c8a55(0x362)][_0x1c8a55(0xa28)]||'我':_0x3a1120[_0x1c8a55(0x1361)]||_0x52db4e[_0x1c8a55(0xe36)];let _0xcfb9d8=String(_0x3a1120['content']);if(_0x3a1120['type']===_0x1c8a55(0x11c7)||_0x3a1120[_0x1c8a55(0xb4b)]===_0x1c8a55(0x7f7))_0xcfb9d8=_0x1c8a55(0xcca)+_0x3a1120['content']+']';else _0x3a1120[_0x1c8a55(0xb4b)]===_0x1c8a55(0x8bc)&&(_0xcfb9d8=_0x1c8a55(0x4ba)+_0x3a1120[_0x1c8a55(0x1047)]+']');_0x4becb4+=_0x61550f+':\x20'+_0xcfb9d8+'\x0a';}):_0x4becb4+=_0x39ee1b(0x3f6);}}const _0x56b08c=await _0x5b9d83['qzonePosts'][_0x39ee1b(0x106d)]('timestamp')['reverse']()[_0x39ee1b(0xd44)](0x5)[_0x39ee1b(0x14b5)]();let _0x22743b='';const _0x550b60=new Set();for(const _0x53f021 of _0x1f5bbc[_0x39ee1b(0x10f2)]){const _0x22287a=_0x28f30a['chats'][_0x53f021['id']];if(_0x22287a){const _0x1cb3ad=_0x5b423c(_0x56b08c,_0x22287a);_0x1cb3ad[_0x39ee1b(0xf99)](_0x524255=>_0x550b60['add'](_0x524255));}}const _0x4ab8a0=new Set(_0x1f5bbc[_0x39ee1b(0x10f2)]['map'](_0x577c33=>_0x577c33[_0x39ee1b(0x66c)])),_0x1fcb67=[..._0x550b60][_0x39ee1b(0xebc)](_0x11842e=>{const _0x2f8d9e=_0x39ee1b,_0x4a8e97=_0x11842e[_0x2f8d9e(0x12b3)]&&_0x11842e[_0x2f8d9e(0x12b3)]['some'](_0x4722e1=>_0x4ab8a0[_0x2f8d9e(0xbf1)](_0x4722e1)),_0x4fa660=_0x11842e[_0x2f8d9e(0x8a4)]&&_0x11842e[_0x2f8d9e(0x8a4)]['some'](_0x146384=>typeof _0x146384===_0x2f8d9e(0x10c0)&&_0x4ab8a0[_0x2f8d9e(0xbf1)](_0x146384['commenterName']));return!_0x4a8e97&&!_0x4fa660;});if(_0x1fcb67[_0x39ee1b(0x9a1)]>0x0){let _0x45f41e=_0x39ee1b(0x727);for(const _0x33e401 of _0x1fcb67){let _0x2a3332=_0x33e401[_0x39ee1b(0xe87)]===_0x39ee1b(0xcc9)?_0x26abc2:_0x28f30a['chats'][_0x33e401[_0x39ee1b(0xe87)]]?.[_0x39ee1b(0xe36)]||'一位朋友',_0x2343ba;if(_0x33e401['type']===_0x39ee1b(0x11d5)){const _0x1463c1=_0x33e401[_0x39ee1b(0x169)]?_0x39ee1b(0x1540)+_0x33e401[_0x39ee1b(0x169)]+'”':'';let _0x3a5e6e=_0x39ee1b(0xe63);const _0xc26248=_0x33e401[_0x39ee1b(0x767)][_0x39ee1b(0xe87)];if(_0xc26248===_0x39ee1b(0xcc9))_0x3a5e6e=_0x28f30a['qzoneSettings'][_0x39ee1b(0x19a)];else _0x28f30a['chats'][_0xc26248]&&(_0x3a5e6e=_0x28f30a['chats'][_0xc26248][_0x39ee1b(0xe36)]);let _0x3cdbf4;const _0x65df6a=_0x33e401[_0x39ee1b(0x767)];if(_0x65df6a[_0x39ee1b(0xb4b)]===_0x39ee1b(0xaa4))_0x3cdbf4=_0x39ee1b(0x800)+(_0x65df6a[_0x39ee1b(0x1202)]||'')+_0x39ee1b(0xd3d)+(_0x65df6a['hiddenContent']||'')['substring'](0x0,0x28)+_0x39ee1b(0xde5);else _0x65df6a[_0x39ee1b(0xb4b)]===_0x39ee1b(0x126c)?_0x3cdbf4='[图片]\x20'+(_0x65df6a[_0x39ee1b(0x1202)]||'')+_0x39ee1b(0xd3d)+(_0x65df6a[_0x39ee1b(0x7ca)]||'')[_0x39ee1b(0xa6b)](0x0,0x28)+'...”)':_0x3cdbf4='“'+(_0x65df6a['content']||'')['substring'](0x0,0x28)+_0x39ee1b(0xa48);_0x2343ba=_0x39ee1b(0xcbd)+_0x3a5e6e+_0x39ee1b(0x880)+_0x1463c1+_0x39ee1b(0x569)+_0x3cdbf4+'】';}else{if(_0x33e401[_0x39ee1b(0xb4b)]===_0x39ee1b(0xaa4))_0x2343ba=(_0x39ee1b(0x948)+_0x33e401[_0x39ee1b(0xf05)]+_0x39ee1b(0xc23)+(_0x33e401[_0x39ee1b(0x1202)]||''))[_0x39ee1b(0xa6b)](0x0,0x32)+'...';else _0x33e401[_0x39ee1b(0xb4b)]===_0x39ee1b(0x126c)?_0x2343ba=('[一张图片，描述为：“'+_0x33e401['imageDescription']+'”]\x20'+(_0x33e401[_0x39ee1b(0x1202)]||''))['substring'](0x0,0x32)+_0x39ee1b(0x4e6):_0x2343ba=String(_0x33e401['publicText']||_0x33e401[_0x39ee1b(0x1047)]||_0x39ee1b(0x88c))[_0x39ee1b(0xa6b)](0x0,0x32)+'...';}_0x45f41e+=_0x39ee1b(0x2e7)+_0x33e401['id']+_0x39ee1b(0x1255)+_0x2a3332+_0x39ee1b(0x660)+_0x2343ba+'\x22\x0a';if(_0x33e401['comments']&&_0x33e401[_0x39ee1b(0x8a4)][_0x39ee1b(0x9a1)]>0x0)for(const _0x353215 of _0x33e401['comments']){if(typeof _0x353215===_0x39ee1b(0x10c0)&&_0x353215[_0x39ee1b(0x498)]){const _0x5514cb=_0x2fa4e1(_0x353215[_0x39ee1b(0x498)]);let _0x59775e=_0x353215['meaning']?_0x39ee1b(0x646)+_0x353215[_0x39ee1b(0x1488)]+'\x27]':_0x353215[_0x39ee1b(0x10ca)];_0x45f41e+=_0x39ee1b(0xb8c)+_0x5514cb+_0x39ee1b(0xc17)+_0x353215[_0x39ee1b(0x498)]+'):\x20'+_0x59775e+'\x0a';}}}_0x22743b=_0x45f41e;}const _0xff1901=_0x5bdf0b(_0x1f5bbc,0x3,_0x39ee1b(0xe03)),_0x53fd1a=_0x5bdf0b(_0x1f5bbc,0x6,'hours'),_0xa4d51b=_0x5bdf0b(_0x1f5bbc,0x9,_0x39ee1b(0xe03)),_0x3d0d2=_0x5bdf0b(_0x1f5bbc,0x1,_0x39ee1b(0xb0b)),_0x54e070=_0x5bdf0b(_0x1f5bbc,0x3,_0x39ee1b(0xb0b)),_0x270e41=_0x5bdf0b(_0x1f5bbc,0x7,_0x39ee1b(0xb0b));let _0x41d6a1='';if(_0xff1901||_0x53fd1a||_0xa4d51b||_0x3d0d2||_0x54e070||_0x270e41){_0x41d6a1+='\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a';if(_0xff1901)_0x41d6a1+=_0xff1901;if(_0x53fd1a)_0x41d6a1+=_0x53fd1a;if(_0xa4d51b)_0x41d6a1+=_0xa4d51b;if(_0xff1901||_0x53fd1a||_0xa4d51b)_0x41d6a1+='\x0a';if(_0x3d0d2)_0x41d6a1+=_0x3d0d2;if(_0x54e070)_0x41d6a1+=_0x54e070;if(_0x270e41)_0x41d6a1+=_0x270e41;}const _0x333104=_0x2dece1(_0x1f5bbc);_0x4a5198='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“'+_0x1f5bbc[_0x39ee1b(0xe36)]+'”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x1f5bbc['settings'][_0x39ee1b(0x425)]?_0x39ee1b(0x133d)+_0x3bed81+'。':'')+_0x39ee1b(0xe7c)+(_0x47d30f?_0x47d30f+'\x20':'')+_0x39ee1b(0xdb4)+_0x5d1edf+_0x39ee1b(0x870)+_0x26abc2+_0x39ee1b(0xf57)+_0x1f5bbc[_0x39ee1b(0xe36)]+_0x39ee1b(0xe7c)+_0x4a064a+_0x39ee1b(0xf8d)+(_0x1f5bbc[_0x39ee1b(0x153f)]&&_0x1f5bbc[_0x39ee1b(0x153f)][_0x39ee1b(0x9a1)]>0x0?_0x1f5bbc[_0x39ee1b(0x153f)][_0x39ee1b(0x11c6)](_0x4595ba=>'-\x20'+_0x4595ba[_0x39ee1b(0x1047)])[_0x39ee1b(0xbad)]('\x0a'):_0x39ee1b(0x5ce))+_0x39ee1b(0x13d7)+_0x41d6a1+_0x39ee1b(0xe7c)+_0x4becb4+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2520ef+_0x39ee1b(0x317)+_0x333104+'\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**'+_0x26abc2+_0x39ee1b(0x1057)+_0x1f5bbc['settings'][_0x39ee1b(0x1528)]+_0x39ee1b(0x29b)+_0x2cee55+_0x39ee1b(0xf48)+_0x22743b+_0x39ee1b(0x100a);}const _0x1879c1=_0x1f5bbc['history'][_0x39ee1b(0xebc)](_0x1e6f7e=>!_0x1e6f7e[_0x39ee1b(0x1162)])[_0x39ee1b(0x225)](-0xa),_0x1f082f=[{'role':_0x39ee1b(0x10a7),'content':_0x4a5198},..._0x1879c1[_0x39ee1b(0x11c6)](_0xc5b07=>{const _0x3e4977=_0x39ee1b,_0x2cd7b6=_0xc5b07['role']==='user'?_0x26abc2:_0x4f967c(_0x1f5bbc,_0xc5b07[_0x3e4977(0x1361)]);let _0x5e3b9d=_0xc5b07['content'];if(_0xc5b07[_0x3e4977(0xb4b)]==='ai_image'||_0xc5b07[_0x3e4977(0xb4b)]===_0x3e4977(0x7f7))_0x5e3b9d=_0x3e4977(0x1210)+_0xc5b07[_0x3e4977(0x1047)]+'\x27]';else{if(_0xc5b07[_0x3e4977(0xb4b)]===_0x3e4977(0x8bc))_0x5e3b9d=_0x3e4977(0x74c)+_0xc5b07[_0x3e4977(0x1047)]+'\x27]';else typeof _0x5e3b9d!==_0x3e4977(0x863)&&(_0x5e3b9d=_0x3e4977(0x476));}return{'role':_0x3e4977(0xcc9),'content':_0x2cd7b6+':\x20'+_0x5e3b9d};})];try{const _0xd3c431=[{'role':_0x39ee1b(0xcc9),'content':_0x4a5198}];let _0x1369c8=_0x50809f===GEMINI_API_URL,_0x3d124e=_0x4fff3d(_0x5a8d17,_0x4419d6,_0x4a5198,_0xd3c431);const _0x5d6580=_0x1369c8?await fetch(_0x3d124e[_0x39ee1b(0x6d1)],_0x3d124e[_0x39ee1b(0x1418)]):await fetch(_0x50809f+'/v1/chat/completions',{'method':_0x39ee1b(0x655),'headers':{'Content-Type':_0x39ee1b(0x1446),'Authorization':_0x39ee1b(0xe83)+_0x4419d6},'body':JSON[_0x39ee1b(0xe4d)]({'model':_0x5a8d17,'messages':_0xd3c431,'temperature':_0x28f30a[_0x39ee1b(0x1062)][_0x39ee1b(0x294)]||0.9})});if(!_0x5d6580['ok'])throw new Error((await _0x5d6580['json']())[_0x39ee1b(0x1518)][_0x39ee1b(0x13bc)]);const _0x5385c7=await _0x5d6580['json'](),_0x22e11b=_0x1369c8?_0x5385c7[_0x39ee1b(0x84d)][0x0][_0x39ee1b(0x1047)][_0x39ee1b(0x13c0)][0x0][_0x39ee1b(0x10ca)]:_0x5385c7[_0x39ee1b(0x8cd)][0x0][_0x39ee1b(0x13bc)][_0x39ee1b(0x1047)],_0x340f87=_0x422882(_0x22e11b);if(!_0x340f87||_0x340f87[_0x39ee1b(0x9a1)]===0x0){console[_0x39ee1b(0x664)]('群聊\x20\x22'+_0x1f5bbc[_0x39ee1b(0xe36)]+_0x39ee1b(0x5ed));return;}let _0x14a8e5=Date[_0x39ee1b(0x487)](),_0xf0cdcf=![],_0x581267='',_0x10f492='';const _0x4f958f=[];for(const _0x4dd7c4 of _0x340f87){const _0x36c37d=String(_0x4dd7c4[_0x39ee1b(0x1047)]||''),_0x2b5276=_0x36c37d[_0x39ee1b(0x97e)]()[_0x39ee1b(0x741)]('<')&&_0x36c37d[_0x39ee1b(0x97e)]()[_0x39ee1b(0xa64)]('>');if(_0x4dd7c4[_0x39ee1b(0xb4b)]===_0x39ee1b(0x10ca)&&!_0x2b5276&&_0x36c37d[_0x39ee1b(0x138a)]('\x0a')){const _0x36fecd=_0x36c37d[_0x39ee1b(0xa8a)](/\n+/)[_0x39ee1b(0xebc)](_0x4504e4=>_0x4504e4[_0x39ee1b(0x97e)]());_0x36fecd[_0x39ee1b(0xf99)](_0x35ecc8=>{_0x4f958f['push']({..._0x4dd7c4,'content':_0x35ecc8});});}else _0x4f958f['push'](_0x4dd7c4);}for(const _0x36e9d2 of _0x4f958f){if(!_0x36e9d2||!_0x36e9d2[_0x39ee1b(0xb4b)]||!_0x36e9d2['name'])continue;const _0x3d7cad=_0x4f967c(_0x1f5bbc,_0x36e9d2['name']);let _0x2e8607=null,_0x4e3451=null;const _0x512b59={'role':_0x39ee1b(0x6d9),'senderName':_0x36e9d2[_0x39ee1b(0xe36)],'timestamp':_0x14a8e5++};if(_0x36e9d2[_0x39ee1b(0xb4b)]===_0x39ee1b(0x1071)){const _0x154932=_0x1f5bbc[_0x39ee1b(0x12c3)]['find'](_0x308afb=>_0x308afb[_0x39ee1b(0x69a)]===_0x36e9d2[_0x39ee1b(0xafa)]);if(_0x154932&&!_0x154932['isFullyClaimed']&&!(_0x154932[_0x39ee1b(0x13b7)]&&_0x154932[_0x39ee1b(0x13b7)][_0x36e9d2[_0x39ee1b(0xe36)]])){let _0xd786b6=0x0;const _0xab2385=_0x154932['totalAmount']-Object[_0x39ee1b(0x74e)](_0x154932[_0x39ee1b(0x13b7)]||{})[_0x39ee1b(0xcdd)]((_0x37675b,_0x52ea8c)=>_0x37675b+_0x52ea8c,0x0),_0x5a4953=_0x154932[_0x39ee1b(0xdd4)]-Object[_0x39ee1b(0xf6b)](_0x154932['claimedBy']||{})[_0x39ee1b(0x9a1)];if(_0x5a4953>0x0){if(_0x5a4953===0x1)_0xd786b6=_0xab2385;else{const _0x1bcdcf=0.01,_0x4407f5=_0xab2385-(_0x5a4953-0x1)*_0x1bcdcf;_0xd786b6=Math[_0x39ee1b(0x1337)]()*(_0x4407f5-_0x1bcdcf)+_0x1bcdcf;}_0xd786b6=parseFloat(_0xd786b6[_0x39ee1b(0x5c3)](0x2));if(!_0x154932[_0x39ee1b(0x13b7)])_0x154932[_0x39ee1b(0x13b7)]={};_0x154932[_0x39ee1b(0x13b7)][_0x36e9d2[_0x39ee1b(0xe36)]]=_0xd786b6,_0x1f5bbc[_0x39ee1b(0x12c3)][_0x39ee1b(0x367)]({'role':_0x39ee1b(0x10a7),'type':_0x39ee1b(0x10aa),'content':_0x3d7cad+'\x20领取了\x20'+_0x4f967c(_0x1f5bbc,_0x154932[_0x39ee1b(0x1361)])+_0x39ee1b(0xd77),'timestamp':Date[_0x39ee1b(0x487)]()});let _0x4b9e2f=_0x39ee1b(0x319)+_0x3d7cad+_0x39ee1b(0xee9)+_0xd786b6[_0x39ee1b(0x5c3)](0x2)+_0x39ee1b(0xd10);if(Object['keys'](_0x154932[_0x39ee1b(0x13b7)])[_0x39ee1b(0x9a1)]>=_0x154932[_0x39ee1b(0xdd4)]){_0x154932[_0x39ee1b(0x1410)]=!![],_0x1f5bbc['history']['push']({'role':_0x39ee1b(0x10a7),'type':'pat_message','content':_0x4f967c(_0x1f5bbc,_0x154932[_0x39ee1b(0x1361)])+_0x39ee1b(0x12a5),'timestamp':Date[_0x39ee1b(0x487)]()+0x1});let _0x25b302={'name':'','amount':-0x1};Object[_0x39ee1b(0x127b)](_0x154932['claimedBy'])[_0x39ee1b(0xf99)](([_0x105c35,_0xbf1e73])=>{const _0x41edd3=_0x39ee1b;_0xbf1e73>_0x25b302[_0x41edd3(0x257)]&&(_0x25b302={'name':_0x105c35,'amount':_0xbf1e73});});if(_0x25b302['name']){const _0x1e61a8=_0x4f967c(_0x1f5bbc,_0x25b302[_0x39ee1b(0xe36)]);_0x4b9e2f+=_0x39ee1b(0x118d)+_0x1e61a8+'！';}}_0x4b9e2f+=_0x39ee1b(0x463),_0x1f5bbc[_0x39ee1b(0x12c3)][_0x39ee1b(0x367)]({'role':'system','content':_0x4b9e2f,'timestamp':Date['now']()+0x2,'isHidden':!![]});}}_0xf0cdcf=!![];continue;}switch(_0x36e9d2[_0x39ee1b(0xb4b)]){case _0x39ee1b(0x14f3):if(_0x36e9d2['meaning']){const _0xbb24ad=_0x28f30a[_0x39ee1b(0xf28)]['find'](_0x4491e6=>_0x4491e6[_0x39ee1b(0xe36)]===_0x36e9d2[_0x39ee1b(0x1488)]);_0xbb24ad?_0x4e3451={..._0x512b59,'type':'sticker','content':_0xbb24ad['url'],'meaning':_0xbb24ad[_0x39ee1b(0xe36)]}:(console[_0x39ee1b(0x664)](_0x39ee1b(0xc9a)+_0x36e9d2[_0x39ee1b(0x1488)]+'\x22'),_0x4e3451={..._0x512b59,'type':'text','content':_0x39ee1b(0x4f3)+_0x36e9d2[_0x39ee1b(0x1488)]+']'});}else console[_0x39ee1b(0x664)](_0x39ee1b(0x141a),_0x36e9d2),_0x4e3451={..._0x512b59,'type':'sticker','content':_0x36e9d2['url'],'meaning':_0x39ee1b(0x2ca)};break;case _0x39ee1b(0x9eb):const _0x10b81a={'type':_0x36e9d2[_0x39ee1b(0x12f0)]||_0x39ee1b(0x5e8),'content':_0x36e9d2[_0x39ee1b(0x1047)],'timestamp':Date[_0x39ee1b(0x487)](),'authorId':_0x28f30a[_0x39ee1b(0x6ce)][Object[_0x39ee1b(0xf6b)](_0x28f30a['chats'])[_0x39ee1b(0x412)](_0x69548f=>_0x28f30a[_0x39ee1b(0x6ce)][_0x69548f][_0x39ee1b(0x66c)]===_0x36e9d2[_0x39ee1b(0xe36)])]?.['id']||_0x36e9d2[_0x39ee1b(0xe36)],'authorOriginalName':_0x36e9d2['name'],'visibleGroupIds':null};await _0x5b9d83[_0x39ee1b(0xc7a)][_0x39ee1b(0xe82)](_0x10b81a),_0x3f09c8(_0x461b99+0x1),_0x2e8607={'content':'['+_0x3d7cad+_0x39ee1b(0xab6)};break;case _0x39ee1b(0x357):const _0x400774=await _0x5b9d83[_0x39ee1b(0xc7a)][_0x39ee1b(0x6b5)](parseInt(_0x36e9d2[_0x39ee1b(0xa53)]));if(_0x400774){if(!_0x400774['comments'])_0x400774[_0x39ee1b(0x8a4)]=[];_0x400774[_0x39ee1b(0x8a4)]['push']({'commenterName':_0x36e9d2[_0x39ee1b(0xe36)],'text':_0x36e9d2[_0x39ee1b(0x14ff)],'timestamp':Date[_0x39ee1b(0x487)]()}),await _0x5b9d83[_0x39ee1b(0xc7a)][_0x39ee1b(0x130a)](_0x400774['id'],{'comments':_0x400774[_0x39ee1b(0x8a4)]}),_0x3f09c8(_0x461b99+0x1),_0x2e8607={'content':'['+_0x3d7cad+'\x20评论了动态]'};}break;case _0x39ee1b(0x130c):const _0x193bc5=await _0x5b9d83['qzonePosts'][_0x39ee1b(0x6b5)](parseInt(_0x36e9d2[_0x39ee1b(0xa53)]));if(_0x193bc5){if(!_0x193bc5[_0x39ee1b(0x12b3)])_0x193bc5[_0x39ee1b(0x12b3)]=[];!_0x193bc5[_0x39ee1b(0x12b3)][_0x39ee1b(0x138a)](_0x36e9d2[_0x39ee1b(0xe36)])&&(_0x193bc5[_0x39ee1b(0x12b3)][_0x39ee1b(0x367)](_0x36e9d2['name']),await _0x5b9d83[_0x39ee1b(0xc7a)][_0x39ee1b(0x130a)](_0x193bc5['id'],{'likes':_0x193bc5[_0x39ee1b(0x12b3)]}),_0x3f09c8(_0x461b99+0x1),_0x2e8607={'content':'['+_0x3d7cad+_0x39ee1b(0xd63)});}break;case _0x39ee1b(0x11c7):_0x4e3451={..._0x512b59,'type':_0x39ee1b(0x11c7),'content':_0x36e9d2[_0x39ee1b(0x9cc)],'image_prompt':msgData[_0x39ee1b(0xe8f)]};break;default:if(_0x36e9d2['type']===_0x39ee1b(0xc2c)){const _0x469026=typeof _0x36e9d2[_0x39ee1b(0x793)]==='string'?_0x36e9d2[_0x39ee1b(0x793)]['split']('\x0a')[_0x39ee1b(0xebc)](_0x22c69d=>_0x22c69d['trim']()):Array[_0x39ee1b(0x624)](_0x36e9d2[_0x39ee1b(0x793)])?_0x36e9d2[_0x39ee1b(0x793)]:[];if(_0x469026['length']<0x2)continue;_0x4e3451={..._0x512b59,..._0x36e9d2,'options':_0x469026,'votes':{},'isClosed':![]};}else{const _0x509ef6=_0x36e9d2[_0x39ee1b(0x1047)]||_0x36e9d2['message'];_0x4e3451={..._0x512b59,..._0x36e9d2};if(_0x509ef6)_0x4e3451['content']=_0x509ef6;}break;}if(_0x2e8607)_0x1f5bbc[_0x39ee1b(0x12c3)][_0x39ee1b(0x367)]({'role':'system','type':_0x39ee1b(0x10aa),'content':_0x2e8607[_0x39ee1b(0x1047)],'timestamp':_0x14a8e5++});else _0x4e3451&&(_0x1f5bbc['history'][_0x39ee1b(0x367)](_0x4e3451),!_0x10f492&&(_0x10f492=_0x3d7cad,_0x581267=_0x4e3451[_0x39ee1b(0xb4b)]===_0x39ee1b(0x11c7)?'[图片]':_0x4e3451[_0x39ee1b(0x1047)]||'['+_0x4e3451['type']+']'));_0xf0cdcf=!![];}_0xf0cdcf&&(_0x1f5bbc[_0x39ee1b(0x14e9)]=Date[_0x39ee1b(0x487)](),_0x1f5bbc[_0x39ee1b(0xce1)]=(_0x1f5bbc['unreadCount']||0x0)+_0x340f87[_0x39ee1b(0xebc)](_0x4417c8=>_0x4417c8['type']!==_0x39ee1b(0x9eb)&&_0x4417c8[_0x39ee1b(0xb4b)]!==_0x39ee1b(0x357)&&_0x4417c8['type']!=='qzone_like')[_0x39ee1b(0x9a1)],_0x10f492&&_0x581267&&_0x1c12fe(_0x5e19a8,_0x10f492+':\x20'+_0x581267),await _0x5b9d83[_0x39ee1b(0x6ce)][_0x39ee1b(0x7c3)](_0x1f5bbc));}catch(_0x23e013){console['error'](_0x39ee1b(0xd66)+_0x1f5bbc[_0x39ee1b(0xe36)]+_0x39ee1b(0x59c),_0x23e013);}finally{_0x5db8a3();}}function _0x4171f3(_0x450bea,_0x539d0d,_0x127209){const _0xbd6b16=_0x475790,_0x10309a=document[_0xbd6b16(0x2ec)](_0x127209);if(!_0x10309a)return;if(!_0x450bea||_0x450bea['trim']()===''){_0x10309a['innerHTML']='';return;}const _0x281ace=_0x450bea[_0xbd6b16(0x13ed)](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x539d0d+_0xbd6b16(0x125e))[_0xbd6b16(0x13ed)](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x539d0d+_0xbd6b16(0x1d0))['replace'](/\s*\.message-bubble\s+([^{]+\{)/g,_0x539d0d+_0xbd6b16(0xf66));_0x10309a['innerHTML']=_0x281ace;}async function _0xa23065(){const _0x38de38=_0x475790;if(!_0x28f30a[_0x38de38(0x11b9)])return;const _0x5776f3=_0x28f30a[_0x38de38(0x6ce)][_0x28f30a[_0x38de38(0x11b9)]],_0x339a8c=document['getElementById'](_0x38de38(0xc6f));if(!_0x339a8c)return;const _0x117ec9=document[_0x38de38(0x765)](_0x38de38(0x13ad))?.[_0x38de38(0x11a4)]||'default',_0x1f9ddb=document[_0x38de38(0x2ec)]('font-size-slider')[_0x38de38(0x11a4)],_0x5ed860=document['getElementById'](_0x38de38(0x12b0))[_0x38de38(0x11a4)],_0x425d8f=_0x5776f3['settings']['background'];_0x339a8c[_0x38de38(0xe93)][_0x38de38(0x2a7)]=_0x117ec9,_0x339a8c[_0x38de38(0x589)][_0x38de38(0x644)](_0x38de38(0xe7b),_0x1f9ddb+'px');_0x425d8f&&_0x425d8f[_0x38de38(0x741)]('data:image')?(_0x339a8c['style'][_0x38de38(0xe00)]=_0x38de38(0xeb9)+_0x425d8f+')',_0x339a8c[_0x38de38(0x589)][_0x38de38(0xc34)]=_0x38de38(0x921)):(_0x339a8c[_0x38de38(0x589)]['backgroundImage']=_0x38de38(0x5b1),_0x339a8c[_0x38de38(0x589)][_0x38de38(0x137c)]=_0x425d8f||'#f0f2f5');_0x339a8c[_0x38de38(0xc43)]='';const _0x29a07d={'role':'ai','content':_0x38de38(0xf72),'timestamp':0x1,'senderName':_0x5776f3['name']},_0x32148e=await _0x43f190(_0x29a07d,_0x5776f3);if(_0x32148e)_0x339a8c[_0x38de38(0x998)](_0x32148e);const _0x562abb={'role':_0x38de38(0xcc9),'content':_0x38de38(0xb19),'timestamp':0x2},_0x226719=await _0x43f190(_0x562abb,_0x5776f3);if(_0x226719)_0x339a8c[_0x38de38(0x998)](_0x226719);const _0x30cb1f=document['createElement'](_0x38de38(0xaa5));_0x30cb1f[_0x38de38(0x589)][_0x38de38(0x57a)]=_0x38de38(0x826),_0x30cb1f[_0x38de38(0x15f)]=_0x38de38(0x41c),_0x339a8c[_0x38de38(0x998)](_0x30cb1f);const _0x2d1e4c=document[_0x38de38(0x2ec)](_0x38de38(0x1451))[_0x38de38(0x11a4)],_0x3c4564=document[_0x38de38(0x2ec)](_0x38de38(0xc4e))[_0x38de38(0x11a4)],_0x543e44=parseInt(document['getElementById']('lyrics-offset-input')[_0x38de38(0x11a4)])||0xa;_0x2d1e4c==='top'?_0x30cb1f[_0x38de38(0x589)][_0x38de38(0xdd5)]=_0x543e44+'px':_0x30cb1f[_0x38de38(0x589)][_0x38de38(0xe39)]=_0x543e44+'px';switch(_0x3c4564){case _0x38de38(0xd02):_0x30cb1f[_0x38de38(0x589)]['left']=_0x38de38(0x1498);break;case _0x38de38(0xc1b):_0x30cb1f['style']['right']=_0x38de38(0x1498);break;default:_0x30cb1f[_0x38de38(0x589)]['left']=_0x38de38(0xc80),_0x30cb1f[_0x38de38(0x589)][_0x38de38(0x1244)]=_0x38de38(0x4ca);break;}_0x4171f3(_0x5ed860,_0x38de38(0x4ef),_0x38de38(0x10d3));}async function _0x42b40d(){const _0x59af68=_0x475790;await _0x11c713(),document[_0x59af68(0x2ec)](_0x59af68(0x1158))[_0x59af68(0xff6)]['add'](_0x59af68(0x149d));}async function _0x11c713(){const _0x23ab5d=_0x475790,_0x1a0dfd=document['getElementById'](_0x23ab5d(0x8c7)),_0x5302da=await _0x5b9d83[_0x23ab5d(0x1479)][_0x23ab5d(0x14b5)]();_0x1a0dfd['innerHTML']='',_0x5302da[_0x23ab5d(0x9a1)]===0x0&&(_0x1a0dfd[_0x23ab5d(0xc43)]=_0x23ab5d(0xc29)),_0x5302da['forEach'](_0x512fdf=>{const _0x2cf058=_0x23ab5d,_0x548820=document[_0x2cf058(0x14ae)](_0x2cf058(0xaa5));_0x548820[_0x2cf058(0xdd1)]=_0x2cf058(0xe3c),_0x548820[_0x2cf058(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x512fdf[_0x2cf058(0xe36)]+_0x2cf058(0x643)+_0x512fdf['id']+_0x2cf058(0x13da),_0x1a0dfd[_0x2cf058(0x998)](_0x548820);});}async function _0x46140a(){const _0x481df1=_0x475790,_0x7172cc=document[_0x481df1(0x2ec)](_0x481df1(0xb60)),_0xee91d5=_0x7172cc['value'][_0x481df1(0x97e)]();if(!_0xee91d5){alert(_0x481df1(0xe90));return;}const _0x5661a4=await _0x5b9d83['qzoneGroups'][_0x481df1(0x67e)](_0x481df1(0xe36))[_0x481df1(0x129a)](_0xee91d5)[_0x481df1(0x942)]();if(_0x5661a4){alert(_0x481df1(0x1072)+_0xee91d5+'\x22\x20已经存在了，换个名字吧！');return;}await _0x5b9d83['qzoneGroups'][_0x481df1(0xe82)]({'name':_0xee91d5}),_0x7172cc[_0x481df1(0x11a4)]='',await _0x11c713();}async function _0x3a5368(_0x34cdee){const _0x26a77a=_0x475790,_0x4eee95=await _0x4436ba('确认删除',_0x26a77a(0xf50),{'confirmButtonClass':_0x26a77a(0xd8f)});if(_0x4eee95){await _0x5b9d83[_0x26a77a(0x1479)][_0x26a77a(0x54b)](_0x34cdee);const _0x47e772=await _0x5b9d83['chats']['where'](_0x26a77a(0x1542))['equals'](_0x34cdee)[_0x26a77a(0x14b5)]();for(const _0x914a38 of _0x47e772){_0x914a38[_0x26a77a(0x1542)]=null,await _0x5b9d83[_0x26a77a(0x6ce)][_0x26a77a(0x7c3)](_0x914a38);if(_0x28f30a[_0x26a77a(0x6ce)][_0x914a38['id']])_0x28f30a['chats'][_0x914a38['id']][_0x26a77a(0x1542)]=null;}await _0x11c713();}}function _0x3986ce(_0x3e3973){const _0x43805d=_0x475790,_0x5429a5=_0x28f30a[_0x43805d(0x6ce)][_0x28f30a[_0x43805d(0x11b9)]];document[_0x43805d(0x2ec)](_0x43805d(0x11a2))[_0x43805d(0x589)][_0x43805d(0x701)]=_0x5429a5[_0x43805d(0x1423)]?'block':'none';if(_0x36063f)return;_0x38f399=_0x3e3973,document['getElementById'](_0x43805d(0xf0b))['classList'][_0x43805d(0xe82)]('visible');}function _0x3d2470(){const _0x4db4cc=_0x475790;document[_0x4db4cc(0x2ec)]('message-actions-modal')[_0x4db4cc(0xff6)][_0x4db4cc(0x1424)](_0x4db4cc(0x149d)),_0x38f399=null;}async function _0x38e20f(){const _0x43bee0=_0x475790;if(!_0x38f399)return;const _0x3a54f3=_0x38f399,_0x3a7c1f=_0x28f30a['chats'][_0x28f30a[_0x43bee0(0x11b9)]],_0x1d9fa7=_0x3a7c1f[_0x43bee0(0x12c3)][_0x43bee0(0x412)](_0xdcc061=>_0xdcc061['timestamp']===_0x3a54f3);if(!_0x1d9fa7)return;_0x3d2470();let _0x137b56;const _0x1b0634=_0x1d9fa7[_0x43bee0(0xb4b)]&&['voice_message',_0x43bee0(0x11c7),_0x43bee0(0x277),_0x43bee0(0x9c6)][_0x43bee0(0x138a)](_0x1d9fa7[_0x43bee0(0xb4b)]);if(_0x1b0634){let _0xe8306d={'type':_0x1d9fa7[_0x43bee0(0xb4b)]};if(_0x1d9fa7['type']===_0x43bee0(0x8bc))_0xe8306d['content']=_0x1d9fa7['content'];else{if(_0x1d9fa7[_0x43bee0(0xb4b)]===_0x43bee0(0x11c7))_0xe8306d['description']=_0x1d9fa7[_0x43bee0(0x1047)];else{if(_0x1d9fa7[_0x43bee0(0xb4b)]===_0x43bee0(0x277))_0xe8306d[_0x43bee0(0x257)]=_0x1d9fa7['amount'],_0xe8306d[_0x43bee0(0x1333)]=_0x1d9fa7[_0x43bee0(0x1333)];else _0x1d9fa7[_0x43bee0(0xb4b)]==='share_link'&&(_0xe8306d[_0x43bee0(0x141e)]=_0x1d9fa7['title'],_0xe8306d['description']=_0x1d9fa7[_0x43bee0(0x9cc)],_0xe8306d[_0x43bee0(0xedb)]=_0x1d9fa7[_0x43bee0(0xedb)],_0xe8306d[_0x43bee0(0x1047)]=_0x1d9fa7[_0x43bee0(0x1047)]);}}_0x137b56=JSON[_0x43bee0(0xe4d)](_0xe8306d,null,0x2);}else typeof _0x1d9fa7[_0x43bee0(0x1047)]===_0x43bee0(0x10c0)?_0x137b56=JSON[_0x43bee0(0xe4d)](_0x1d9fa7[_0x43bee0(0x1047)],null,0x2):_0x137b56=_0x1d9fa7[_0x43bee0(0x1047)];const _0xdeda38={'voice':{'type':'voice_message','content':_0x43bee0(0x123b)},'image':{'type':_0x43bee0(0x11c7),'description':_0x43bee0(0x6bf)},'transfer':{'type':_0x43bee0(0x277),'amount':5.2,'note':_0x43bee0(0x207)},'link':{'type':'share_link','title':_0x43bee0(0x1403),'description':_0x43bee0(0x289),'source_name':'来源网站','content':_0x43bee0(0x302)}},_0x4e3f4f=_0x43bee0(0x12b6)+JSON[_0x43bee0(0xe4d)](_0xdeda38[_0x43bee0(0x52f)])+_0x43bee0(0x59e)+JSON[_0x43bee0(0xe4d)](_0xdeda38[_0x43bee0(0x9e6)])+_0x43bee0(0xcb5)+JSON[_0x43bee0(0xe4d)](_0xdeda38['transfer'])+'\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x43bee0(0xe4d)](_0xdeda38['link'])+_0x43bee0(0x45a),_0x56400d=await _0x33419a(_0x43bee0(0x389),_0x43bee0(0xbdd),_0x137b56,_0x43bee0(0x382),_0x4e3f4f);_0x56400d!==null&&await _0x2e39aa(_0x3a54f3,_0x56400d,!![]);}async function _0x797b61(){const _0x5ccee6=_0x475790;if(!_0x38f399)return;const _0xcc238c=_0x28f30a['chats'][_0x28f30a[_0x5ccee6(0x11b9)]],_0x222372=_0xcc238c[_0x5ccee6(0x12c3)]['find'](_0x282223=>_0x282223['timestamp']===_0x38f399);if(!_0x222372)return;let _0x37e36a;typeof _0x222372[_0x5ccee6(0x1047)]===_0x5ccee6(0x10c0)?_0x37e36a=JSON[_0x5ccee6(0xe4d)](_0x222372['content']):_0x37e36a=String(_0x222372['content']);try{await navigator['clipboard'][_0x5ccee6(0x6c7)](_0x37e36a),await _0x34d596(_0x5ccee6(0x155b),_0x5ccee6(0x3ab));}catch(_0x25df83){await _0x34d596(_0x5ccee6(0xf54),_0x5ccee6(0x6a8));}_0x3d2470();}async function _0x6d7da8(){const _0x1253c9=_0x475790;if(!_0x38f399)return;try{await navigator[_0x1253c9(0xc62)][_0x1253c9(0x6c7)](_0x38f399),await _0x34d596(_0x1253c9(0x155b),_0x1253c9(0x233)+_0x38f399+_0x1253c9(0x87c));}catch(_0x2f595a){await _0x34d596(_0x1253c9(0xf54),_0x1253c9(0x6a8));}_0x3d2470();}function _0x4e96ae(_0x516e03=''){const _0x173750=_0x475790,_0x28e79c=document[_0x173750(0x14ae)](_0x173750(0xaa5));_0x28e79c['className']=_0x173750(0x929);const _0x511ee7={'voice':{'type':'voice_message','content':_0x173750(0x123b)},'image':{'type':_0x173750(0x11c7),'description':_0x173750(0x6bf)},'transfer':{'type':_0x173750(0x277),'amount':5.2,'note':_0x173750(0x207)},'link':{'type':'share_link','title':_0x173750(0x1403),'description':_0x173750(0x289),'source_name':_0x173750(0xc90),'content':_0x173750(0x302)},'offline':{'type':_0x173750(0x6fb),'content':_0x173750(0x34c)},'quote':{'type':_0x173750(0xec8),'target_timestamp':0x499602d2,'reply_content':_0x173750(0x663)},'nai':{'type':'naiimag','prompt':'1girl,\x20best\x20quality,\x20masterpiece,\x20...'}};return _0x28e79c[_0x173750(0xc43)]=_0x173750(0x381)+_0x516e03+_0x173750(0x11ae)+JSON['stringify'](_0x511ee7[_0x173750(0x52f)])+_0x173750(0x178)+JSON[_0x173750(0xe4d)](_0x511ee7['image'])+_0x173750(0x53d)+JSON[_0x173750(0xe4d)](_0x511ee7[_0x173750(0x277)])+'\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x511ee7[_0x173750(0x287)])+_0x173750(0x8b0)+JSON[_0x173750(0xe4d)](_0x511ee7['offline'])+_0x173750(0x11f8)+JSON[_0x173750(0xe4d)](_0x511ee7[_0x173750(0x447)])+_0x173750(0xb1c)+JSON[_0x173750(0xe4d)](_0x511ee7[_0x173750(0x518)])+_0x173750(0x1522),_0x28e79c[_0x173750(0x765)](_0x173750(0x81c))['addEventListener'](_0x173750(0x1177),()=>{const _0x2b25f8=_0x173750;document['querySelectorAll']('.message-editor-block')['length']>0x1?_0x28e79c['remove']():alert(_0x2b25f8(0xd57));}),_0x28e79c[_0x173750(0x5d6)](_0x173750(0x1035))[_0x173750(0xf99)](_0x398a5e=>{const _0x38ec00=_0x173750;_0x398a5e[_0x38ec00(0xf79)](_0x38ec00(0x1177),()=>{const _0x433473=_0x38ec00,_0x2c6222=_0x398a5e[_0x433473(0xe93)][_0x433473(0x129d)],_0x3a9f9f=_0x28e79c['querySelector']('textarea');if(_0x2c6222&&_0x3a9f9f)try{const _0x471a8f=JSON['parse'](_0x2c6222);_0x3a9f9f[_0x433473(0x11a4)]=JSON[_0x433473(0xe4d)](_0x471a8f,null,0x2),_0x3a9f9f[_0x433473(0x52b)]();}catch(_0x108872){console[_0x433473(0x1518)](_0x433473(0xbed),_0x108872);}});}),_0x28e79c;}async function _0x1217b4(){const _0x4ae956=_0x475790;if(!_0x38f399)return;const _0x309b9c=_0x38f399,_0x2c44f9=_0x28f30a[_0x4ae956(0x6ce)][_0x28f30a['activeChatId']],_0x351b52=_0x2c44f9['history'][_0x4ae956(0x412)](_0x3d25ad=>_0x3d25ad[_0x4ae956(0x69a)]===_0x309b9c);if(!_0x351b52)return;_0x3d2470();const _0x26fd20=document[_0x4ae956(0x2ec)](_0x4ae956(0x1347)),_0x35b32b=document[_0x4ae956(0x2ec)](_0x4ae956(0x8fe));_0x35b32b[_0x4ae956(0xc43)]='';let _0x42bf8d;if(_0x351b52[_0x4ae956(0x447)]){const _0x1406ef={'type':_0x4ae956(0xec8),'target_timestamp':_0x351b52[_0x4ae956(0x447)][_0x4ae956(0x69a)],'reply_content':_0x351b52[_0x4ae956(0x1047)]};_0x42bf8d=JSON['stringify'](_0x1406ef,null,0x2);}else{if(_0x351b52[_0x4ae956(0xb4b)]&&['voice_message',_0x4ae956(0x11c7),_0x4ae956(0x277),_0x4ae956(0x6fb),_0x4ae956(0x9c6),_0x4ae956(0xd92)][_0x4ae956(0x138a)](_0x351b52[_0x4ae956(0xb4b)])){let _0x2619d2={'type':_0x351b52[_0x4ae956(0xb4b)]};if(_0x351b52[_0x4ae956(0xb4b)]===_0x4ae956(0x8bc))_0x2619d2[_0x4ae956(0x1047)]=_0x351b52[_0x4ae956(0x1047)];else{if(_0x351b52[_0x4ae956(0xb4b)]===_0x4ae956(0x11c7))_0x2619d2['description']=_0x351b52[_0x4ae956(0x1047)];else{if(_0x351b52[_0x4ae956(0xb4b)]===_0x4ae956(0x277))_0x2619d2[_0x4ae956(0x257)]=_0x351b52[_0x4ae956(0x257)],_0x2619d2[_0x4ae956(0x1333)]=_0x351b52['note'];else{if(_0x351b52[_0x4ae956(0xb4b)]===_0x4ae956(0x6fb))_0x351b52['content']?_0x2619d2[_0x4ae956(0x1047)]=_0x351b52[_0x4ae956(0x1047)]:(_0x2619d2[_0x4ae956(0x6c4)]=_0x351b52[_0x4ae956(0x6c4)],_0x2619d2[_0x4ae956(0x9cc)]=_0x351b52[_0x4ae956(0x9cc)]);else{if(_0x351b52[_0x4ae956(0xb4b)]===_0x4ae956(0x9c6))_0x2619d2[_0x4ae956(0x141e)]=_0x351b52[_0x4ae956(0x141e)],_0x2619d2['description']=_0x351b52['description'],_0x2619d2[_0x4ae956(0xedb)]=_0x351b52['source_name'],_0x2619d2[_0x4ae956(0x1047)]=_0x351b52[_0x4ae956(0x1047)];else _0x351b52['type']===_0x4ae956(0xd92)&&(_0x2619d2[_0x4ae956(0x9fd)]=_0x351b52[_0x4ae956(0x9fd)],_0x2619d2[_0x4ae956(0x6c6)]=_0x351b52[_0x4ae956(0x6c6)],_0x2619d2[_0x4ae956(0x5ae)]=_0x351b52[_0x4ae956(0x5ae)]);}}}}_0x42bf8d=JSON[_0x4ae956(0xe4d)](_0x2619d2,null,0x2);}else typeof _0x351b52['content']===_0x4ae956(0x10c0)?_0x42bf8d=JSON[_0x4ae956(0xe4d)](_0x351b52['content'],null,0x2):_0x42bf8d=_0x351b52[_0x4ae956(0x1047)];}const _0x226c4a=_0x4e96ae(_0x42bf8d);_0x35b32b[_0x4ae956(0x998)](_0x226c4a);const _0x185344=document[_0x4ae956(0x2ec)]('add-message-editor-block-btn'),_0x24c883=_0x185344['cloneNode'](!![]);_0x185344[_0x4ae956(0x1092)][_0x4ae956(0x6ab)](_0x24c883,_0x185344),_0x24c883[_0x4ae956(0xf79)]('click',()=>{const _0xf35f6c=_0x4ae956,_0x3021e0=_0x4e96ae();_0x35b32b['appendChild'](_0x3021e0),_0x3021e0[_0xf35f6c(0x765)](_0xf35f6c(0x382))[_0xf35f6c(0x52b)]();});const _0x1bc087=document['getElementById'](_0x4ae956(0x990)),_0x499555=_0x1bc087['cloneNode'](!![]);_0x1bc087[_0x4ae956(0x1092)]['replaceChild'](_0x499555,_0x1bc087),_0x499555['addEventListener'](_0x4ae956(0x1177),()=>{const _0x3b6504=_0x4ae956;_0x26fd20[_0x3b6504(0xff6)][_0x3b6504(0x1424)]('visible');});const _0x1f61ad=document['getElementById'](_0x4ae956(0x1315)),_0x4c4713=_0x1f61ad[_0x4ae956(0x303)](!![]);_0x1f61ad[_0x4ae956(0x1092)][_0x4ae956(0x6ab)](_0x4c4713,_0x1f61ad),_0x4c4713[_0x4ae956(0xf79)]('click',()=>{_0x2e39aa(_0x309b9c);}),_0x26fd20['classList']['add'](_0x4ae956(0x149d));}async function _0x797b61(){const _0x1488e8=_0x475790;if(!_0x38f399)return;const _0x5cac1b=_0x28f30a['chats'][_0x28f30a[_0x1488e8(0x11b9)]],_0x21ebf3=_0x5cac1b[_0x1488e8(0x12c3)][_0x1488e8(0x412)](_0x5949e0=>_0x5949e0[_0x1488e8(0x69a)]===_0x38f399);if(!_0x21ebf3)return;let _0x34e133;if(_0x21ebf3[_0x1488e8(0xb4b)]===_0x1488e8(0x6fb))_0x21ebf3['content']?_0x34e133=_0x21ebf3[_0x1488e8(0x1047)]:_0x34e133='「'+(_0x21ebf3[_0x1488e8(0x6c4)]||'')+'」\x0a'+(_0x21ebf3['description']||'');else typeof _0x21ebf3[_0x1488e8(0x1047)]===_0x1488e8(0x10c0)?_0x34e133=JSON[_0x1488e8(0xe4d)](_0x21ebf3[_0x1488e8(0x1047)]):_0x34e133=String(_0x21ebf3[_0x1488e8(0x1047)]);try{await navigator['clipboard'][_0x1488e8(0x6c7)](_0x34e133),await _0x34d596(_0x1488e8(0x155b),'消息内容已复制到剪贴板。');}catch(_0x3a181c){await _0x34d596(_0x1488e8(0xf54),_0x1488e8(0x6a8));}_0x3d2470();}function _0x1b5876(_0x211631){const _0x324b70=_0x475790,_0x249fa5=_0x211631[_0x324b70(0x97e)]();if(_0x249fa5[_0x324b70(0x741)]('{')&&_0x249fa5[_0x324b70(0xa64)]('}'))try{const _0xc1ddc3=JSON[_0x324b70(0xd91)](_0x249fa5);if(_0xc1ddc3[_0x324b70(0xb4b)])return _0xc1ddc3;}catch(_0x324b91){}if(_0x41abd3[_0x324b70(0x1e0)](_0x249fa5))return{'type':_0x324b70(0x14f3),'content':_0x249fa5};return{'type':_0x324b70(0x10ca),'content':_0x249fa5};}async function _0x2e39aa(_0x7428fa,_0x340175=null){const _0x64c2c7=_0x475790;if(!_0x7428fa)return;const _0x56dc3b=_0x28f30a['chats'][_0x28f30a[_0x64c2c7(0x11b9)]],_0x143f28=_0x56dc3b[_0x64c2c7(0x12c3)][_0x64c2c7(0x535)](_0x7869d8=>_0x7869d8[_0x64c2c7(0x69a)]===_0x7428fa);if(_0x143f28===-0x1)return;const _0x3a7ab1=_0x56dc3b[_0x64c2c7(0x12c3)][_0x143f28];let _0x5ef554=[];const _0x499c77=_0x340175!==null?[_0x340175]:Array['from'](document[_0x64c2c7(0x5d6)]('#message-editor-container\x20textarea'))[_0x64c2c7(0x11c6)](_0xf70bf5=>_0xf70bf5[_0x64c2c7(0x11a4)]);for(const _0x3d55ae of _0x499c77){if(!_0x3d55ae[_0x64c2c7(0x97e)]())continue;const _0x3730a4=_0x1b5876(_0x3d55ae[_0x64c2c7(0x97e)]()),_0x2ea931={'role':_0x3a7ab1[_0x64c2c7(0x9be)],'senderName':_0x3a7ab1['senderName'],'timestamp':_0x3a7ab1[_0x64c2c7(0x69a)]};switch(_0x3730a4[_0x64c2c7(0xb4b)]){case _0x64c2c7(0x10ca):_0x2ea931[_0x64c2c7(0xb4b)]=_0x64c2c7(0x10ca),_0x2ea931['content']=_0x3730a4[_0x64c2c7(0x1047)];break;case'offline_text':_0x2ea931[_0x64c2c7(0xb4b)]='offline_text';_0x3730a4[_0x64c2c7(0x1047)]?_0x2ea931[_0x64c2c7(0x1047)]=_0x3730a4['content']:(_0x2ea931[_0x64c2c7(0x6c4)]=_0x3730a4[_0x64c2c7(0x6c4)],_0x2ea931[_0x64c2c7(0x9cc)]=_0x3730a4[_0x64c2c7(0x9cc)]);break;case _0x64c2c7(0xec8):_0x2ea931[_0x64c2c7(0xb4b)]=_0x64c2c7(0xec8),_0x2ea931[_0x64c2c7(0x1047)]=_0x3730a4[_0x64c2c7(0xf96)];const _0x47fa84=_0x56dc3b[_0x64c2c7(0x12c3)][_0x64c2c7(0x412)](_0xbc6b90=>_0xbc6b90[_0x64c2c7(0x69a)]===_0x3730a4[_0x64c2c7(0x111a)]);if(_0x47fa84){let _0x3920e8=_0x47fa84[_0x64c2c7(0x1361)];_0x47fa84[_0x64c2c7(0x9be)]==='user'&&(_0x3920e8=_0x28f30a['qzoneSettings'][_0x64c2c7(0x19a)]||_0x64c2c7(0x450)),_0x2ea931[_0x64c2c7(0x447)]={'timestamp':_0x3730a4[_0x64c2c7(0x111a)],'senderName':_0x3920e8,'content':String(_0x47fa84[_0x64c2c7(0x1047)]||'')};}else _0x2ea931['quote']={'timestamp':_0x3730a4[_0x64c2c7(0x111a)],'senderName':_0x64c2c7(0x58f),'content':_0x64c2c7(0x1376)};break;case'voice_message':case _0x64c2c7(0x11c7):case _0x64c2c7(0x7f7):_0x2ea931[_0x64c2c7(0xb4b)]=_0x3730a4[_0x64c2c7(0xb4b)],_0x2ea931[_0x64c2c7(0x1047)]=_0x3730a4['content']||_0x3730a4[_0x64c2c7(0x9cc)];if(_0x3730a4[_0x64c2c7(0x1488)])_0x2ea931[_0x64c2c7(0x1488)]=_0x3730a4['meaning'];break;case _0x64c2c7(0xd92):{const _0x2449bc=_0x56dc3b['history'][_0x143f28];let _0x51440b=_0x3730a4[_0x64c2c7(0x9fd)],_0x4569eb=_0x3730a4[_0x64c2c7(0x6c6)],_0x1fe3ad=_0x3730a4['fullPrompt'],_0x14c815=![];_0x51440b&&typeof _0x51440b===_0x64c2c7(0x863)&&_0x2449bc['prompt']!==_0x51440b?_0x14c815=!![]:(_0x51440b=_0x2449bc[_0x64c2c7(0x9fd)],_0x1fe3ad=_0x2449bc[_0x64c2c7(0x5ae)],_0x4569eb=_0x2449bc[_0x64c2c7(0x6c6)]);if(_0x14c815){await _0x34d596(_0x64c2c7(0x13e4),_0x64c2c7(0x84b));try{const _0x46132c=await _0x2c6597(_0x51440b,_0x56dc3b['id']);_0x4569eb=_0x46132c[_0x64c2c7(0x6c6)],_0x1fe3ad=_0x46132c[_0x64c2c7(0x5ae)],await _0x34d596('成功',_0x64c2c7(0xa45));}catch(_0x6c79f8){console[_0x64c2c7(0x1518)](_0x64c2c7(0xf9a),_0x6c79f8),await _0x34d596(_0x64c2c7(0x1ea),'无法重新生成图片:\x20'+_0x6c79f8[_0x64c2c7(0x13bc)]+'.\x20\x0a\x0a将保留旧图片，但提示词会更新。'),_0x4569eb=_0x2449bc[_0x64c2c7(0x6c6)];}}_0x2ea931[_0x64c2c7(0xb4b)]=_0x64c2c7(0xd92),_0x2ea931['imageUrl']=_0x4569eb,_0x2ea931[_0x64c2c7(0x9fd)]=_0x51440b,_0x2ea931[_0x64c2c7(0x5ae)]=_0x1fe3ad;break;}case _0x64c2c7(0x14f3):{_0x2ea931[_0x64c2c7(0xb4b)]=_0x64c2c7(0x14f3);let _0x894ea4=![];if(_0x3730a4[_0x64c2c7(0x1488)]){const _0x16a651=_0x28f30a[_0x64c2c7(0xf28)][_0x64c2c7(0x412)](_0x5d434a=>_0x5d434a[_0x64c2c7(0xe36)]===_0x3730a4[_0x64c2c7(0x1488)]);_0x16a651?(_0x2ea931['content']=_0x16a651[_0x64c2c7(0x6d1)],_0x2ea931[_0x64c2c7(0x1488)]=_0x16a651['name'],console['log'](_0x64c2c7(0x146b)),_0x894ea4=!![]):(_0x2ea931[_0x64c2c7(0xb4b)]=_0x64c2c7(0x10ca),_0x2ea931[_0x64c2c7(0x1047)]='[表情:\x20'+_0x3730a4[_0x64c2c7(0x1488)]+']',console[_0x64c2c7(0x664)](_0x64c2c7(0x71a),_0x3730a4[_0x64c2c7(0x1488)]),_0x894ea4=!![]);}if(!_0x894ea4&&_0x3730a4[_0x64c2c7(0x6d1)]){_0x2ea931[_0x64c2c7(0x1047)]=_0x3730a4[_0x64c2c7(0x6d1)];const _0x42e574=_0x28f30a['userStickers'][_0x64c2c7(0x412)](_0x1b0338=>_0x1b0338[_0x64c2c7(0x6d1)]===_0x3730a4[_0x64c2c7(0x6d1)]);if(_0x3730a4[_0x64c2c7(0x1488)]&&(!_0x42e574||_0x42e574['name']===_0x3730a4[_0x64c2c7(0x1488)]))_0x2ea931[_0x64c2c7(0x1488)]=_0x3730a4[_0x64c2c7(0x1488)];else _0x42e574?_0x2ea931[_0x64c2c7(0x1488)]=_0x42e574[_0x64c2c7(0xe36)]:_0x2ea931[_0x64c2c7(0x1488)]='未知表情';console[_0x64c2c7(0x415)](_0x64c2c7(0x1269),_0x2ea931['meaning']),_0x894ea4=!![];}if(!_0x894ea4&&_0x3730a4[_0x64c2c7(0x1047)]&&typeof _0x3730a4[_0x64c2c7(0x1047)]==='string'&&_0x41abd3[_0x64c2c7(0x1e0)](_0x3730a4[_0x64c2c7(0x1047)])){_0x2ea931[_0x64c2c7(0x1047)]=_0x3730a4[_0x64c2c7(0x1047)];const _0x49a70b=_0x28f30a['userStickers'][_0x64c2c7(0x412)](_0x50f5c5=>_0x50f5c5[_0x64c2c7(0x6d1)]===_0x3730a4['content']);_0x2ea931[_0x64c2c7(0x1488)]=_0x49a70b?_0x49a70b[_0x64c2c7(0xe36)]:_0x64c2c7(0x2ca),console['log']('导演/编辑模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:',_0x2ea931[_0x64c2c7(0x1488)]),_0x894ea4=!![];}if(!_0x894ea4){console[_0x64c2c7(0x1518)](_0x64c2c7(0x1261),_0x3730a4);continue;}break;}case _0x64c2c7(0x277):_0x2ea931['type']=_0x64c2c7(0x277),_0x2ea931[_0x64c2c7(0x257)]=_0x3730a4['amount'],_0x2ea931[_0x64c2c7(0x1333)]=_0x3730a4[_0x64c2c7(0x1333)];break;case _0x64c2c7(0x9c6):_0x2ea931['type']=_0x64c2c7(0x9c6),_0x2ea931[_0x64c2c7(0x141e)]=_0x3730a4[_0x64c2c7(0x141e)],_0x2ea931['description']=_0x3730a4[_0x64c2c7(0x9cc)],_0x2ea931[_0x64c2c7(0xedb)]=_0x3730a4[_0x64c2c7(0xedb)],_0x2ea931[_0x64c2c7(0x1047)]=_0x3730a4[_0x64c2c7(0x1047)];break;default:Object[_0x64c2c7(0x92a)](_0x2ea931,_0x3730a4);break;}_0x5ef554[_0x64c2c7(0x367)](_0x2ea931);}if(_0x5ef554['length']===0x0){document[_0x64c2c7(0x2ec)]('message-editor-modal')[_0x64c2c7(0xff6)][_0x64c2c7(0x1424)]('visible');return;}_0x56dc3b['history'][_0x64c2c7(0x510)](_0x143f28,0x1,..._0x5ef554);let _0x23282b=_0x7428fa;for(let _0x201193=_0x143f28;_0x201193<_0x56dc3b[_0x64c2c7(0x12c3)][_0x64c2c7(0x9a1)];_0x201193++){_0x56dc3b['history'][_0x201193][_0x64c2c7(0x69a)]=_0x23282b,_0x23282b++;}await _0x5b9d83[_0x64c2c7(0x6ce)][_0x64c2c7(0x7c3)](_0x56dc3b),document[_0x64c2c7(0x2ec)]('message-editor-modal')['classList']['remove'](_0x64c2c7(0x149d)),_0xc55746(_0x28f30a[_0x64c2c7(0x11b9)]),await _0x34d596('成功',_0x64c2c7(0x1fd));}function _0x3652c0(_0x35f629){const _0x130dcb=_0x475790;_0x281561=_0x35f629,document[_0x130dcb(0x2ec)]('post-actions-modal')[_0x130dcb(0xff6)][_0x130dcb(0xe82)](_0x130dcb(0x149d));}function _0x4d2639(){const _0x43e876=_0x475790;document['getElementById'](_0x43e876(0x1131))['classList'][_0x43e876(0x1424)](_0x43e876(0x149d)),_0x281561=null;}async function _0x531bf2(){const _0x21d70f=_0x475790;if(!_0x281561)return;const _0x302576=_0x281561,_0x839c98=await _0x5b9d83['qzonePosts'][_0x21d70f(0x6b5)](_0x302576);if(!_0x839c98)return;_0x4d2639();let _0x276e7c;if(_0x839c98[_0x21d70f(0xb4b)]==='shuoshuo')_0x276e7c=_0x839c98['content'];else{const _0x3f0841={'type':_0x839c98[_0x21d70f(0xb4b)],'publicText':_0x839c98[_0x21d70f(0x1202)]||''};if(_0x839c98['type']===_0x21d70f(0x126c))_0x3f0841[_0x21d70f(0x6c6)]=_0x839c98[_0x21d70f(0x6c6)],_0x3f0841[_0x21d70f(0x7ca)]=_0x839c98[_0x21d70f(0x7ca)];else _0x839c98['type']===_0x21d70f(0xaa4)&&(_0x3f0841[_0x21d70f(0xf05)]=_0x839c98[_0x21d70f(0xf05)]);_0x276e7c=JSON[_0x21d70f(0xe4d)](_0x3f0841,null,0x2);}const _0x3f4998={'shuoshuo':_0x21d70f(0x14f4),'image':{'type':_0x21d70f(0x126c),'publicText':'','imageUrl':_0x21d70f(0x670),'imageDescription':''},'text_image':{'type':'text_image','publicText':'','hiddenContent':''}},_0x53f0ac=_0x21d70f(0x80c)+JSON[_0x21d70f(0xe4d)](_0x3f4998[_0x21d70f(0x9e6)])+'\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x21d70f(0xe4d)](_0x3f4998[_0x21d70f(0xaa4)])+_0x21d70f(0xbfa),_0x8a2264=await _0x33419a(_0x21d70f(0x126f),'在此修改内容...',_0x276e7c,_0x21d70f(0x382),_0x53f0ac);setTimeout(()=>{const _0x35d2b8=_0x21d70f,_0x3a8f2c=document[_0x35d2b8(0x765)]('#custom-modal-body\x20.format-btn[data-type=\x22text\x22]');_0x3a8f2c&&_0x3a8f2c[_0x35d2b8(0xf79)](_0x35d2b8(0x1177),()=>{const _0x5177f2=_0x35d2b8,_0x15045f=document[_0x5177f2(0x2ec)](_0x5177f2(0xa00));_0x15045f['value']=_0x3f4998[_0x5177f2(0x5e8)],_0x15045f[_0x5177f2(0x52b)]();});},0x64),_0x8a2264!==null&&await _0x4e169b(_0x302576,_0x8a2264);}async function _0x4e169b(_0x14855f,_0xc7f123){const _0x295c88=_0x475790,_0x409c28=await _0x5b9d83[_0x295c88(0xc7a)][_0x295c88(0x6b5)](_0x14855f);if(!_0x409c28)return;const _0x23cb79=_0xc7f123['trim']();try{const _0x518284=JSON[_0x295c88(0xd91)](_0x23cb79);_0x409c28['type']=_0x518284['type']||_0x295c88(0x126c),_0x409c28['publicText']=_0x518284['publicText']||'',_0x409c28[_0x295c88(0x6c6)]=_0x518284[_0x295c88(0x6c6)]||'',_0x409c28[_0x295c88(0x7ca)]=_0x518284[_0x295c88(0x7ca)]||'',_0x409c28['hiddenContent']=_0x518284[_0x295c88(0xf05)]||'',_0x409c28['content']='';}catch(_0x2af8a2){_0x409c28['type']=_0x295c88(0x5e8),_0x409c28['content']=_0x23cb79,_0x409c28[_0x295c88(0x1202)]='',_0x409c28['imageUrl']='',_0x409c28[_0x295c88(0x7ca)]='',_0x409c28[_0x295c88(0xf05)]='';}await _0x5b9d83['qzonePosts'][_0x295c88(0x7c3)](_0x409c28),await _0x472608(),await _0x34d596('成功',_0x295c88(0xa97));}async function _0x2684ce(){const _0x5b6808=_0x475790;if(!_0x281561)return;const _0x466620=await _0x5b9d83[_0x5b6808(0xc7a)]['get'](_0x281561);if(!_0x466620)return;let _0x4c3331=_0x466620[_0x5b6808(0x1047)]||_0x466620['publicText']||_0x466620[_0x5b6808(0xf05)]||_0x466620[_0x5b6808(0x7ca)]||_0x5b6808(0x1322);try{await navigator[_0x5b6808(0xc62)][_0x5b6808(0x6c7)](_0x4c3331),await _0x34d596('复制成功',_0x5b6808(0x1285));}catch(_0x1fd4b0){await _0x34d596(_0x5b6808(0xf54),_0x5b6808(0x6a8));}_0x4d2639();}let _0x488644=new Set();async function _0x27bfb0(){const _0x4af8f1=_0x475790,_0x252ce3=await _0x3d2f35('创建群聊',[{'text':_0x4af8f1(0x1238),'value':_0x4af8f1(0x6d8)},{'text':_0x4af8f1(0xfd8),'value':_0x4af8f1(0xc32)}]);if(_0x252ce3==='normal'){_0x488644[_0x4af8f1(0xe98)]();const _0x92b7b9=document[_0x4af8f1(0x2ec)](_0x4af8f1(0x3dc)),_0x344898=_0x92b7b9[_0x4af8f1(0x303)](!![]);_0x92b7b9['parentNode'][_0x4af8f1(0x6ab)](_0x344898,_0x92b7b9),_0x344898[_0x4af8f1(0xf79)](_0x4af8f1(0x1177),_0x5710f1),await _0x50b747(),_0x17ec27(_0x4af8f1(0xd12));}else _0x252ce3==='spectator'&&_0x5a69d4();}async function _0x5a69d4(){const _0x40d91f=_0x475790;_0x488644[_0x40d91f(0xe98)]();const _0x22ce66=document[_0x40d91f(0x2ec)](_0x40d91f(0x3dc)),_0x5c028d=_0x22ce66[_0x40d91f(0x303)](!![]);_0x22ce66[_0x40d91f(0x1092)][_0x40d91f(0x6ab)](_0x5c028d,_0x22ce66),_0x5c028d[_0x40d91f(0xf79)](_0x40d91f(0x1177),_0x52d4ff),await _0x26674c(),_0x17ec27(_0x40d91f(0xd12));}async function _0x26674c(){const _0x4eec0e=_0x475790,_0x44a5d3=document[_0x4eec0e(0x2ec)](_0x4eec0e(0x11ef));_0x44a5d3[_0x4eec0e(0xc43)]='';const _0x30e57b=Object[_0x4eec0e(0x74e)](_0x28f30a[_0x4eec0e(0x6ce)])[_0x4eec0e(0xebc)](_0x2ccc61=>!_0x2ccc61['isGroup']),_0x4a2e5e=await _0x5b9d83[_0x4eec0e(0x8f4)][_0x4eec0e(0x14b5)]();if(_0x30e57b['length']===0x0&&_0x4a2e5e[_0x4eec0e(0x9a1)]===0x0){_0x44a5d3[_0x4eec0e(0xc43)]='<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>';return;}_0x30e57b[_0x4eec0e(0xf99)](_0xd2fb55=>{const _0x47567c=_0x4eec0e,_0xf5a37=document['createElement']('div');_0xf5a37[_0x47567c(0xdd1)]='contact-picker-item',_0xf5a37[_0x47567c(0xe93)][_0x47567c(0xdac)]=_0xd2fb55['id'],_0xf5a37[_0x47567c(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0xd2fb55[_0x47567c(0x362)][_0x47567c(0xe91)]||_0x825cf1)+_0x47567c(0xfc7)+_0xd2fb55['name']+_0x47567c(0x69f),_0x44a5d3[_0x47567c(0x998)](_0xf5a37);}),_0x4a2e5e['forEach'](_0x3f7a3e=>{const _0x252bfc=_0x4eec0e,_0x36995e=document[_0x252bfc(0x14ae)]('div');_0x36995e[_0x252bfc(0xdd1)]='contact-picker-item',_0x36995e[_0x252bfc(0xe93)][_0x252bfc(0xdac)]=_0x3f7a3e['id'],_0x36995e['dataset'][_0x252bfc(0xe94)]=_0x252bfc(0x33e),_0x36995e['innerHTML']=_0x252bfc(0x6b3)+(_0x3f7a3e[_0x252bfc(0x516)]||_0xd71c66)+_0x252bfc(0xfc7)+_0x3f7a3e[_0x252bfc(0xe36)]+'\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x44a5d3[_0x252bfc(0x998)](_0x36995e);}),_0x152a37();}async function _0x52d4ff(){const _0x1a8716=_0x475790;if(_0x488644[_0x1a8716(0x2d2)]<0x2){alert('旁观群聊至少需要选择2个成员。');return;}const _0x3a2480=await _0x33419a(_0x1a8716(0x306),_0x1a8716(0xf93),_0x1a8716(0x752));if(!_0x3a2480||!_0x3a2480['trim']())return;const _0x4c33c8=_0x1a8716(0x331)+Date['now'](),_0x5a17e9=[],_0x25427c=await _0x5b9d83[_0x1a8716(0x8f4)][_0x1a8716(0x14b5)]();for(const _0x119527 of _0x488644){const _0x5de097=document[_0x1a8716(0x765)]('.contact-picker-item[data-contact-id=\x22'+_0x119527+'\x22]')['dataset'][_0x1a8716(0xe94)]==='true';if(_0x5de097){const _0x3a5eb=_0x25427c[_0x1a8716(0x412)](_0x19756e=>_0x19756e['id']===parseInt(_0x119527));_0x3a5eb&&_0x5a17e9['push']({'id':_0x1a8716(0x3c8)+_0x3a5eb['id'],'originalName':_0x3a5eb[_0x1a8716(0xe36)],'groupNickname':_0x3a5eb[_0x1a8716(0xe36)],'persona':_0x3a5eb['persona'],'avatar':_0x3a5eb[_0x1a8716(0x516)]||_0xd71c66,'isNpc':!![]});}else{const _0x13afcf=_0x28f30a[_0x1a8716(0x6ce)][_0x119527];_0x13afcf&&_0x5a17e9['push']({'id':_0x119527,'originalName':_0x13afcf['originalName'],'groupNickname':_0x13afcf[_0x1a8716(0xe36)],'persona':_0x13afcf[_0x1a8716(0x362)][_0x1a8716(0x67c)],'avatar':_0x13afcf[_0x1a8716(0x362)][_0x1a8716(0xe91)]||_0x825cf1,'isNpc':![]});}}const _0xb80db5={'id':_0x4c33c8,'name':_0x3a2480[_0x1a8716(0x97e)](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x5a17e9,'settings':{'maxMemory':0xa,'groupAvatar':_0x563b2b,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':'system','content':'[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','timestamp':Date['now'](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x28f30a[_0x1a8716(0x6ce)][_0x4c33c8]=_0xb80db5,await _0x5b9d83['chats']['put'](_0xb80db5),await _0x5db8a3(),_0x17ec27('chat-list-screen'),_0x473be6(_0x4c33c8);}async function _0x50b747(){const _0xb89c2c=_0x475790,_0x2c0b2d=document[_0xb89c2c(0x2ec)]('contact-picker-list');_0x2c0b2d['innerHTML']='';const _0x298029=Object['values'](_0x28f30a[_0xb89c2c(0x6ce)])[_0xb89c2c(0xebc)](_0x439e2d=>!_0x439e2d[_0xb89c2c(0x1423)]),_0x55e010=await _0x5b9d83[_0xb89c2c(0x8f4)][_0xb89c2c(0x14b5)]();if(_0x298029['length']===0x0&&_0x55e010['length']===0x0){_0x2c0b2d['innerHTML']=_0xb89c2c(0x71c);return;}_0x298029['forEach'](_0x3604cc=>{const _0x1e9bab=_0xb89c2c,_0x4a561c=document['createElement']('div');_0x4a561c['className']='contact-picker-item',_0x4a561c[_0x1e9bab(0xe93)][_0x1e9bab(0xdac)]=_0x3604cc['id'],_0x4a561c[_0x1e9bab(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x3604cc['settings'][_0x1e9bab(0xe91)]||_0x825cf1)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x3604cc['name']+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x2c0b2d[_0x1e9bab(0x998)](_0x4a561c);}),_0x55e010[_0xb89c2c(0xf99)](_0x4aa217=>{const _0x6fd840=_0xb89c2c,_0x152e98=document['createElement']('div');_0x152e98['className']=_0x6fd840(0x11c2),_0x152e98[_0x6fd840(0xe93)][_0x6fd840(0xdac)]=_0x6fd840(0x3c8)+_0x4aa217['id'],_0x152e98[_0x6fd840(0xc43)]=_0x6fd840(0x6b3)+(_0x4aa217[_0x6fd840(0x516)]||_0xd71c66)+_0x6fd840(0xfc7)+_0x4aa217['name']+_0x6fd840(0x12d1),_0x2c0b2d[_0x6fd840(0x998)](_0x152e98);}),_0x152a37();}function _0x152a37(){const _0x588ec1=_0x475790,_0x37a533=document[_0x588ec1(0x2ec)](_0x588ec1(0x3dc));_0x37a533['textContent']='完成('+_0x488644[_0x588ec1(0x2d2)]+')',_0x37a533['disabled']=_0x488644['size']<0x2;}async function _0x5710f1(){const _0x4a5e3a=_0x475790;if(_0x488644[_0x4a5e3a(0x2d2)]<0x2){alert(_0x4a5e3a(0x313));return;}const _0x22aac9=await _0x33419a('设置群名',_0x4a5e3a(0xf93),_0x4a5e3a(0xfc2));if(!_0x22aac9||!_0x22aac9['trim']())return;const _0x463073='group_'+Date[_0x4a5e3a(0x487)](),_0x245d59=[],_0x5724d6=await _0x5b9d83[_0x4a5e3a(0x8f4)][_0x4a5e3a(0x14b5)]();for(const _0x373580 of _0x488644){if(_0x373580[_0x4a5e3a(0x741)](_0x4a5e3a(0x3c8))){const _0x23776f=parseInt(_0x373580[_0x4a5e3a(0x13ed)](_0x4a5e3a(0x3c8),'')),_0x1b7c45=_0x5724d6[_0x4a5e3a(0x412)](_0x3544f1=>_0x3544f1['id']===_0x23776f);_0x1b7c45&&_0x245d59['push']({'id':_0x373580,'originalName':_0x1b7c45[_0x4a5e3a(0xe36)],'groupNickname':_0x1b7c45['name'],'persona':_0x1b7c45[_0x4a5e3a(0xe32)],'avatar':_0x1b7c45[_0x4a5e3a(0x516)]||_0xd71c66,'isNpc':!![]});}else{const _0x11edef=_0x28f30a[_0x4a5e3a(0x6ce)][_0x373580];_0x11edef&&_0x245d59[_0x4a5e3a(0x367)]({'id':_0x373580,'originalName':_0x11edef[_0x4a5e3a(0x66c)],'groupNickname':_0x11edef['name'],'persona':_0x11edef[_0x4a5e3a(0x362)][_0x4a5e3a(0x67c)],'avatar':_0x11edef[_0x4a5e3a(0x362)][_0x4a5e3a(0xe91)]||_0x825cf1,'isNpc':![]});}}const _0x550040={'id':_0x463073,'name':_0x22aac9[_0x4a5e3a(0x97e)](),'isGroup':!![],'members':_0x245d59,'settings':{'myPersona':_0x4a5e3a(0x91c),'myNickname':'我','maxMemory':0xa,'groupAvatar':_0x563b2b,'myAvatar':_0x3ba305,'background':'','theme':_0x4a5e3a(0x44a),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x28f30a[_0x4a5e3a(0x6ce)][_0x463073]=_0x550040,await _0x5b9d83[_0x4a5e3a(0x6ce)][_0x4a5e3a(0x7c3)](_0x550040),await _0x5db8a3(),_0x17ec27(_0x4a5e3a(0xf4d)),_0x473be6(_0x463073);}function _0x2f535f(){const _0x5edfef=_0x475790;if(!_0x28f30a[_0x5edfef(0x11b9)]||!_0x28f30a[_0x5edfef(0x6ce)][_0x28f30a[_0x5edfef(0x11b9)]]['isGroup'])return;_0x2feda4(),_0x17ec27('member-management-screen');}function _0x2feda4(){const _0x1e44a4=_0x475790,_0x3cd0ad=document[_0x1e44a4(0x2ec)]('member-management-list'),_0xd7b102=_0x28f30a[_0x1e44a4(0x6ce)][_0x28f30a[_0x1e44a4(0x11b9)]];_0x3cd0ad[_0x1e44a4(0xc43)]='',_0xd7b102['members'][_0x1e44a4(0xf99)](_0x558965=>{const _0x241c3b=_0x1e44a4,_0x3004a7=document['createElement'](_0x241c3b(0xaa5));_0x3004a7[_0x241c3b(0xdd1)]=_0x241c3b(0xe0f),_0x3004a7['innerHTML']=_0x241c3b(0xdbe)+_0x558965['avatar']+_0x241c3b(0xe49)+_0x558965['groupNickname']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22'+_0x558965['id']+'\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3cd0ad[_0x241c3b(0x998)](_0x3004a7);});}async function _0x115daf(_0x4383d3){const _0x3a2240=_0x475790,_0x471bdf=_0x28f30a['chats'][_0x28f30a['activeChatId']],_0x443628=_0x471bdf[_0x3a2240(0x10f2)]['findIndex'](_0x5997f3=>_0x5997f3['id']===_0x4383d3);if(_0x443628===-0x1)return;if(_0x471bdf[_0x3a2240(0x10f2)][_0x3a2240(0x9a1)]<=0x2){alert(_0x3a2240(0xa62));return;}const _0x153497=_0x471bdf['members'][_0x443628]['groupNickname'],_0x5d2f3e=await _0x4436ba(_0x3a2240(0xe7a),_0x3a2240(0xc2b)+_0x153497+_0x3a2240(0xfd5),{'confirmButtonClass':_0x3a2240(0xd8f)});_0x5d2f3e&&(_0x471bdf['members'][_0x3a2240(0x510)](_0x443628,0x1),await _0x5b9d83['chats'][_0x3a2240(0x7c3)](_0x471bdf),_0x2feda4(),document[_0x3a2240(0x2ec)](_0x3a2240(0x128a))['click']());}async function _0x5eb5c5(){const _0x425cfa=_0x475790,_0x9a98ba=document[_0x425cfa(0x2ec)](_0x425cfa(0x3dc)),_0x5cc7cd=_0x9a98ba[_0x425cfa(0x303)](!![]);_0x9a98ba[_0x425cfa(0x1092)][_0x425cfa(0x6ab)](_0x5cc7cd,_0x9a98ba),_0x5cc7cd['addEventListener'](_0x425cfa(0x1177),_0x1f0df9),await _0x4ccde6(),_0x17ec27(_0x425cfa(0xd12));}async function _0x4ccde6(){const _0x351b4f=_0x475790,_0x4b0aad=document[_0x351b4f(0x2ec)](_0x351b4f(0x11ef));_0x4b0aad[_0x351b4f(0xc43)]='',_0x488644[_0x351b4f(0xe98)]();const _0x1eb0b7=_0x28f30a[_0x351b4f(0x6ce)][_0x28f30a[_0x351b4f(0x11b9)]],_0x51c277=new Set(_0x1eb0b7[_0x351b4f(0x10f2)][_0x351b4f(0x11c6)](_0x2c750a=>_0x2c750a['id'])),_0x50d0fc=Object['values'](_0x28f30a[_0x351b4f(0x6ce)])[_0x351b4f(0xebc)](_0x4a4c74=>!_0x4a4c74['isGroup']&&!_0x51c277['has'](_0x4a4c74['id'])),_0x512f35=(await _0x5b9d83[_0x351b4f(0x8f4)][_0x351b4f(0x14b5)]())[_0x351b4f(0xebc)](_0x4ab722=>!_0x51c277[_0x351b4f(0xbf1)](_0x351b4f(0x3c8)+_0x4ab722['id']));_0x50d0fc['length']===0x0&&_0x512f35[_0x351b4f(0x9a1)]===0x0?(_0x4b0aad[_0x351b4f(0xc43)]='<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>',document[_0x351b4f(0x2ec)](_0x351b4f(0x3dc))[_0x351b4f(0x589)][_0x351b4f(0x701)]=_0x351b4f(0x5b1)):(document[_0x351b4f(0x2ec)](_0x351b4f(0x3dc))['style'][_0x351b4f(0x701)]=_0x351b4f(0x13f7),_0x50d0fc[_0x351b4f(0xf99)](_0x53e7ea=>{const _0x9c307a=_0x351b4f,_0x4d07bc=document[_0x9c307a(0x14ae)](_0x9c307a(0xaa5));_0x4d07bc[_0x9c307a(0xdd1)]=_0x9c307a(0x11c2),_0x4d07bc[_0x9c307a(0xe93)][_0x9c307a(0xdac)]=_0x53e7ea['id'],_0x4d07bc[_0x9c307a(0xe93)]['contactType']=_0x9c307a(0x8e7),_0x4d07bc[_0x9c307a(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x53e7ea[_0x9c307a(0x362)][_0x9c307a(0xe91)]||_0x825cf1)+_0x9c307a(0x4e8)+_0x53e7ea[_0x9c307a(0xe36)]+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4b0aad['appendChild'](_0x4d07bc);}),_0x512f35[_0x351b4f(0xf99)](_0x4a822a=>{const _0x23ca41=_0x351b4f,_0x162507=document[_0x23ca41(0x14ae)](_0x23ca41(0xaa5));_0x162507[_0x23ca41(0xdd1)]=_0x23ca41(0x11c2),_0x162507['dataset'][_0x23ca41(0xdac)]=_0x23ca41(0x3c8)+_0x4a822a['id'],_0x162507[_0x23ca41(0xe93)][_0x23ca41(0x865)]=_0x23ca41(0xcd0),_0x162507[_0x23ca41(0xe93)][_0x23ca41(0x113e)]=_0x4a822a['id'],_0x162507['innerHTML']=_0x23ca41(0x130d)+(_0x4a822a[_0x23ca41(0x516)]||_0xd71c66)+_0x23ca41(0x4e8)+_0x4a822a['name']+_0x23ca41(0xd48),_0x4b0aad[_0x23ca41(0x998)](_0x162507);})),_0x152a37();}async function _0x1f0df9(){const _0x2aeb8b=_0x475790;if(_0x488644[_0x2aeb8b(0x2d2)]===0x0){alert(_0x2aeb8b(0x551));return;}const _0x38356b=_0x28f30a[_0x2aeb8b(0x6ce)][_0x28f30a[_0x2aeb8b(0x11b9)]],_0x5db858=await _0x5b9d83['npcs'][_0x2aeb8b(0x14b5)]();for(const _0x45832a of _0x488644){const _0x5f340f=document[_0x2aeb8b(0x765)](_0x2aeb8b(0x647)+_0x45832a+'\x22]');if(!_0x5f340f)continue;const _0x5795c4=_0x5f340f[_0x2aeb8b(0xe93)][_0x2aeb8b(0x865)];if(_0x5795c4===_0x2aeb8b(0x8e7)){const _0x1c2a20=_0x28f30a[_0x2aeb8b(0x6ce)][_0x45832a];_0x1c2a20&&_0x38356b[_0x2aeb8b(0x10f2)][_0x2aeb8b(0x367)]({'id':_0x45832a,'originalName':_0x1c2a20[_0x2aeb8b(0x66c)],'groupNickname':_0x1c2a20[_0x2aeb8b(0xe36)],'persona':_0x1c2a20[_0x2aeb8b(0x362)]['aiPersona'],'avatar':_0x1c2a20[_0x2aeb8b(0x362)][_0x2aeb8b(0xe91)]||_0x825cf1,'isNpc':![]});}else{if(_0x5795c4===_0x2aeb8b(0xcd0)){const _0x4d8bdb=parseInt(_0x5f340f[_0x2aeb8b(0xe93)][_0x2aeb8b(0x113e)]),_0x238cca=_0x5db858['find'](_0xb57755=>_0xb57755['id']===_0x4d8bdb);_0x238cca&&_0x38356b[_0x2aeb8b(0x10f2)][_0x2aeb8b(0x367)]({'id':_0x2aeb8b(0x3c8)+_0x4d8bdb,'originalName':_0x238cca[_0x2aeb8b(0xe36)],'groupNickname':_0x238cca[_0x2aeb8b(0xe36)],'persona':_0x238cca['persona'],'avatar':_0x238cca[_0x2aeb8b(0x516)]||_0xd71c66,'isNpc':!![]});}}}await _0x5b9d83[_0x2aeb8b(0x6ce)][_0x2aeb8b(0x7c3)](_0x38356b),_0x2f535f();}function _0x5951fa(){_0x335ffe=!![],_0x7ad5c6(null);}function _0x5ef705(_0x3c7e51,_0x11eb90){const _0x1bda8f=setInterval(()=>{const _0x360171=_0x1937,_0x7bb27f=Date[_0x360171(0x487)](),_0x32f687=_0x11eb90-_0x7bb27f;if(_0x32f687<0x0){clearInterval(_0x1bda8f),_0x3c7e51[_0x360171(0xc43)]=_0x360171(0x12a8);return;}const _0x535b95=Math[_0x360171(0x5f8)](_0x32f687%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x52f54e=Math[_0x360171(0x5f8)](_0x32f687%(0x3e8*0x3c)/0x3e8),_0x4bac3d=String(_0x535b95)[_0x360171(0x58e)](0x2,'0'),_0x21e96a=String(_0x52f54e)[_0x360171(0x58e)](0x2,'0');_0x3c7e51[_0x360171(0xc43)]=_0x360171(0x7a2)+_0x4bac3d[_0x360171(0xb4d)](0x0)+_0x360171(0x945)+_0x4bac3d[_0x360171(0xb4d)](0x1)+'</span>\x20:\x20<span>'+_0x21e96a[_0x360171(0xb4d)](0x0)+_0x360171(0x945)+_0x21e96a[_0x360171(0xb4d)](0x1)+_0x360171(0x718);},0x3e8);return _0x1bda8f;}function _0x1e3c59(){for(const _0xb49b6a in _0x216d5c){clearInterval(_0x216d5c[_0xb49b6a]);}_0x216d5c={};}async function _0x12fdd1(_0x3f069a){const _0x118d9f=_0x475790,_0x441998=_0x28f30a[_0x118d9f(0x6ce)][_0x28f30a[_0x118d9f(0x11b9)]];if(!_0x441998)return;const _0x63225c=_0x441998[_0x118d9f(0x12c3)][_0x118d9f(0x412)](_0x1a3f22=>_0x1a3f22['timestamp']===_0x3f069a);if(!_0x63225c||!['waimai_request','waimai_order'][_0x118d9f(0x138a)](_0x63225c[_0x118d9f(0xb4b)])){console[_0x118d9f(0x1518)](_0x118d9f(0xa3e),_0x3f069a);return;}let _0x3aded7='';if(_0x63225c[_0x118d9f(0xb4b)]===_0x118d9f(0x12d5)){let _0x395dda;switch(_0x63225c[_0x118d9f(0x2a3)]){case'paid':const _0x40371a=_0x63225c[_0x118d9f(0x1012)]||'对方',_0x1aa5d7=_0x4f967c(_0x441998,_0x40371a);_0x395dda='由\x20'+_0x1aa5d7+_0x118d9f(0x594);break;case _0x118d9f(0xb45):_0x395dda=_0x118d9f(0x4cc);break;default:_0x395dda=_0x118d9f(0x923);break;}_0x3aded7='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20'+_0x63225c['productInfo']+_0x118d9f(0x11c8)+Number(_0x63225c[_0x118d9f(0x257)])[_0x118d9f(0x5c3)](0x2)+_0x118d9f(0x1152)+_0x395dda+_0x118d9f(0x12e5);}else{if(_0x63225c[_0x118d9f(0xb4b)]===_0x118d9f(0xea9)){let _0x2393ab,_0x478531;_0x441998[_0x118d9f(0x1423)]?(_0x2393ab=_0x4f967c(_0x441998,_0x63225c[_0x118d9f(0x1361)]),_0x478531=_0x4f967c(_0x441998,_0x63225c[_0x118d9f(0xa9c)])):_0x63225c['role']==='user'?(_0x2393ab=_0x441998[_0x118d9f(0x362)][_0x118d9f(0xa28)]||'我',_0x478531=_0x441998['name']):(_0x2393ab=_0x441998[_0x118d9f(0xe36)],_0x478531=_0x441998[_0x118d9f(0x362)][_0x118d9f(0xa28)]||'我'),_0x3aded7=_0x118d9f(0x563)+_0x2393ab+_0x118d9f(0xa24)+_0x478531+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20'+_0x63225c[_0x118d9f(0xa89)]+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥'+Number(_0x63225c['amount'])[_0x118d9f(0x5c3)](0x2)+_0x118d9f(0x12e5);}}await _0x34d596(_0x118d9f(0x50c),_0x3aded7);}async function _0x54b6d0(_0x4f36fb,_0x2def3f){const _0x2f0e68=_0x475790,_0x10cbb5=_0x28f30a[_0x2f0e68(0x6ce)][_0x28f30a[_0x2f0e68(0x11b9)]];if(!_0x10cbb5)return;const _0x8cc1cb=_0x10cbb5['history'][_0x2f0e68(0x535)](_0x33b25d=>_0x33b25d[_0x2f0e68(0x69a)]===_0x4f36fb);if(_0x8cc1cb===-0x1)return;const _0x3f4742=_0x10cbb5[_0x2f0e68(0x12c3)][_0x8cc1cb];_0x3f4742[_0x2f0e68(0x2a3)]=_0x2def3f;let _0x44ad8c;const _0x4fe03d=_0x10cbb5[_0x2f0e68(0x1423)]?_0x10cbb5[_0x2f0e68(0x362)][_0x2f0e68(0xa28)]||'我':'我';_0x2def3f===_0x2f0e68(0x12d6)?(_0x3f4742[_0x2f0e68(0x1012)]=_0x4fe03d,_0x44ad8c=_0x2f0e68(0x319)+_0x4fe03d+_0x2f0e68(0x1428)+_0x3f4742[_0x2f0e68(0x1361)]+_0x2f0e68(0xde4)+_0x4f36fb+_0x2f0e68(0xce5)):_0x44ad8c=_0x2f0e68(0x319)+_0x4fe03d+')\x20拒绝了\x20'+_0x3f4742[_0x2f0e68(0x1361)]+_0x2f0e68(0x711)+_0x4f36fb+'）。]';const _0x3bbdd8={'role':'system','content':_0x44ad8c,'timestamp':Date[_0x2f0e68(0x487)](),'isHidden':!![]};_0x10cbb5['history']['push'](_0x3bbdd8),await _0x5b9d83[_0x2f0e68(0x6ce)]['put'](_0x10cbb5),_0xc55746(_0x28f30a[_0x2f0e68(0x11b9)]);}let _0x20bfc1={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x152d4e=null;async function _0x4ae15c(){const _0x3b6d65=_0x475790;if(!_0x28f30a[_0x3b6d65(0x11b9)]||_0x20bfc1['isActive']||_0x20bfc1[_0x3b6d65(0x122a)])return;const _0x6c6e3a=_0x28f30a['chats'][_0x28f30a['activeChatId']];_0x20bfc1['isGroupCall']=_0x6c6e3a[_0x3b6d65(0x1423)],_0x20bfc1[_0x3b6d65(0x122a)]=!![],_0x20bfc1[_0x3b6d65(0xb3c)]=_0x3b6d65(0xcc9),_0x20bfc1[_0x3b6d65(0x11b9)]=_0x6c6e3a['id'],_0x20bfc1['isUserParticipating']=!![];_0x6c6e3a[_0x3b6d65(0x1423)]?(document[_0x3b6d65(0x2ec)]('outgoing-call-avatar')[_0x3b6d65(0xce4)]=_0x6c6e3a[_0x3b6d65(0x362)][_0x3b6d65(0x10a3)]||_0x3ba305,document[_0x3b6d65(0x2ec)](_0x3b6d65(0x3d8))[_0x3b6d65(0x15f)]=_0x6c6e3a['settings'][_0x3b6d65(0xa28)]||'我'):(document['getElementById'](_0x3b6d65(0x113f))['src']=_0x6c6e3a['settings']['aiAvatar']||_0x825cf1,document[_0x3b6d65(0x2ec)]('outgoing-call-name')[_0x3b6d65(0x15f)]=_0x6c6e3a[_0x3b6d65(0xe36)]);document[_0x3b6d65(0x765)](_0x3b6d65(0x799))['textContent']=_0x6c6e3a['isGroup']?_0x3b6d65(0x14b9):_0x3b6d65(0x8f6),_0x17ec27(_0x3b6d65(0xc39));const _0xffdeb5={'role':'system','content':_0x6c6e3a[_0x3b6d65(0x1423)]?_0x3b6d65(0x12a1)+(_0x6c6e3a[_0x3b6d65(0x362)]['myNickname']||'我')+_0x3b6d65(0x1478):_0x3b6d65(0x1254),'timestamp':Date[_0x3b6d65(0x487)](),'isHidden':!![]};_0x6c6e3a['history']['push'](_0xffdeb5),await _0x5b9d83[_0x3b6d65(0x6ce)][_0x3b6d65(0x7c3)](_0x6c6e3a),await _0x36bcc9();}function _0x5821d3(){const _0x1ff835=_0x475790,_0x267ac4=_0x28f30a[_0x1ff835(0x6ce)][_0x20bfc1[_0x1ff835(0x11b9)]];if(!_0x267ac4)return;_0x20bfc1[_0x1ff835(0xffc)]=!![],_0x20bfc1[_0x1ff835(0x122a)]=![],_0x20bfc1[_0x1ff835(0xc28)]=Date['now'](),_0x20bfc1[_0x1ff835(0xe33)]=[];const _0x217215=_0x267ac4[_0x1ff835(0x12c3)][_0x1ff835(0x225)](-0xa);_0x20bfc1[_0x1ff835(0x9ab)]=_0x217215['map'](_0xc85de9=>{const _0x1a53e6=_0x1ff835,_0x472d81=_0xc85de9['role']==='user'?_0x267ac4[_0x1a53e6(0x362)][_0x1a53e6(0xa28)]||'我':_0xc85de9[_0x1a53e6(0x1361)]||_0x267ac4['name'];return _0x472d81+':\x20'+String(_0xc85de9[_0x1a53e6(0x1047)])[_0x1a53e6(0xa6b)](0x0,0x32)+'...';})['join']('\x0a'),_0x49ad8c(),document[_0x1ff835(0x2ec)]('video-call-main')[_0x1ff835(0xc43)]=_0x1ff835(0xad4)+(_0x20bfc1[_0x1ff835(0x131e)]?_0x1ff835(0x1185):'正在接通...')+_0x1ff835(0xa16),_0x17ec27(_0x1ff835(0xbf7)),document['getElementById']('user-speak-btn')[_0x1ff835(0x589)][_0x1ff835(0x701)]=_0x20bfc1[_0x1ff835(0x402)]?_0x1ff835(0x13f7):_0x1ff835(0x5b1),document[_0x1ff835(0x2ec)](_0x1ff835(0x135e))[_0x1ff835(0x589)][_0x1ff835(0x701)]=_0x20bfc1[_0x1ff835(0x402)]?_0x1ff835(0x5b1):_0x1ff835(0x13f7);if(_0x152d4e)clearInterval(_0x152d4e);_0x152d4e=setInterval(_0x325616,0x3e8),_0x325616(),_0x1df4a2();}async function _0x4e33b8(){const _0x316b11=_0x475790;if(!_0x20bfc1['isActive'])return;const _0x5934e9=Math[_0x316b11(0x5f8)]((Date['now']()-_0x20bfc1[_0x316b11(0xc28)])/0x3e8),_0x304661=Math[_0x316b11(0x5f8)](_0x5934e9/0x3c)+'分'+_0x5934e9%0x3c+'秒',_0x22ee18='通话结束，时长\x20'+_0x304661,_0x32b65f=_0x28f30a[_0x316b11(0x6ce)][_0x20bfc1[_0x316b11(0x11b9)]];if(_0x32b65f){const _0x3a5498=[];_0x20bfc1[_0x316b11(0x131e)]?(_0x20bfc1[_0x316b11(0x73e)][_0x316b11(0xf99)](_0x1e42c8=>_0x3a5498[_0x316b11(0x367)]({'name':_0x1e42c8[_0x316b11(0x66c)],'avatar':_0x1e42c8['avatar']})),_0x20bfc1[_0x316b11(0x402)]&&_0x3a5498['unshift']({'name':_0x32b65f[_0x316b11(0x362)][_0x316b11(0xa28)]||'我','avatar':_0x32b65f['settings'][_0x316b11(0x10a3)]||_0x3ba305})):(_0x3a5498['push']({'name':_0x32b65f[_0x316b11(0xe36)],'avatar':_0x32b65f[_0x316b11(0x362)][_0x316b11(0xe91)]||_0x825cf1}),_0x3a5498[_0x316b11(0x394)]({'name':'我','avatar':_0x32b65f[_0x316b11(0x362)][_0x316b11(0x10a3)]||_0x825cf1}));const _0x2d9cf4={'chatId':_0x20bfc1[_0x316b11(0x11b9)],'timestamp':Date[_0x316b11(0x487)](),'duration':_0x5934e9,'participants':_0x3a5498,'transcript':[..._0x20bfc1[_0x316b11(0xe33)]]};await _0x5b9d83[_0x316b11(0x924)]['add'](_0x2d9cf4),console[_0x316b11(0x415)](_0x316b11(0xe28),_0x2d9cf4);let _0x287986={'role':_0x20bfc1['initiator']===_0x316b11(0xcc9)?'user':_0x316b11(0x6d9),'content':_0x22ee18,'timestamp':Date[_0x316b11(0x487)]()};_0x32b65f[_0x316b11(0x1423)]&&_0x287986['role']==='assistant'&&(_0x287986[_0x316b11(0x1361)]=_0x20bfc1[_0x316b11(0x2bb)]||_0x32b65f['members'][0x0]?.[_0x316b11(0x66c)]||_0x32b65f[_0x316b11(0xe36)]);_0x32b65f[_0x316b11(0x12c3)][_0x316b11(0x367)](_0x287986);const _0x578d1d=_0x20bfc1[_0x316b11(0xe33)][_0x316b11(0x11c6)](_0x328ee9=>{const _0x1535b0=_0x316b11,_0x3d28dc=_0x328ee9[_0x1535b0(0x9be)]===_0x1535b0(0xcc9)?_0x32b65f[_0x1535b0(0x362)][_0x1535b0(0xa28)]||'我':_0x328ee9[_0x1535b0(0x1361)];return _0x3d28dc+':\x20'+_0x328ee9[_0x1535b0(0x1047)];})[_0x316b11(0xbad)]('\x0a');_0x59f21b(_0x32b65f['id'],_0x578d1d);const _0x2ee39c={'role':_0x316b11(0x10a7),'content':'[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','timestamp':Date[_0x316b11(0x487)]()+0x1,'isHidden':!![]};_0x32b65f[_0x316b11(0x12c3)][_0x316b11(0x367)](_0x2ee39c),await _0x5b9d83[_0x316b11(0x6ce)]['put'](_0x32b65f);}clearInterval(_0x152d4e),_0x152d4e=null,_0x20bfc1={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x32b65f&&(_0x473be6(_0x32b65f['id']),_0x36bcc9());}function _0x49ad8c(){const _0x299096=_0x475790,_0x283b94=document[_0x299096(0x2ec)]('participant-avatars-grid');_0x283b94[_0x299096(0xc43)]='';const _0x5f10bb=_0x28f30a[_0x299096(0x6ce)][_0x20bfc1[_0x299096(0x11b9)]];if(!_0x5f10bb)return;let _0x5b0396=[];_0x20bfc1[_0x299096(0x131e)]?(_0x5b0396=[..._0x20bfc1[_0x299096(0x73e)]],_0x20bfc1[_0x299096(0x402)]&&_0x5b0396[_0x299096(0x394)]({'id':_0x299096(0xcc9),'name':_0x5f10bb[_0x299096(0x362)][_0x299096(0xa28)]||'我','avatar':_0x5f10bb[_0x299096(0x362)]['myAvatar']||_0x3ba305})):_0x5b0396[_0x299096(0x367)]({'id':'ai','name':_0x5f10bb[_0x299096(0xe36)],'avatar':_0x5f10bb['settings'][_0x299096(0xe91)]||_0x825cf1}),_0x5b0396[_0x299096(0xf99)](_0x41108e=>{const _0xb11842=_0x299096,_0x547e63=document['createElement'](_0xb11842(0xaa5));_0x547e63[_0xb11842(0xdd1)]='participant-avatar-wrapper',_0x547e63['dataset'][_0xb11842(0x13aa)]=_0x41108e['id'];const _0x4a266f=_0x41108e[_0xb11842(0x8a8)]||_0x41108e['name'];_0x547e63[_0xb11842(0xc43)]=_0xb11842(0x152a)+_0x41108e[_0xb11842(0x516)]+'\x22\x20class=\x22participant-avatar\x22\x20alt=\x22'+_0x4a266f+_0xb11842(0x253)+_0x4a266f+_0xb11842(0x1065),_0x283b94['appendChild'](_0x547e63);});}function _0x19fb1a(){const _0x832ff4=_0x475790;if(!_0x20bfc1['isActive']||_0x20bfc1['isUserParticipating'])return;_0x20bfc1[_0x832ff4(0x402)]=!![],_0x49ad8c(),document[_0x832ff4(0x2ec)](_0x832ff4(0xcc7))[_0x832ff4(0x589)]['display']=_0x832ff4(0x13f7),document[_0x832ff4(0x2ec)](_0x832ff4(0x135e))[_0x832ff4(0x589)][_0x832ff4(0x701)]=_0x832ff4(0x5b1),_0x1df4a2(_0x832ff4(0x269));}function _0x325616(){const _0x7c5d51=_0x475790;if(!_0x20bfc1[_0x7c5d51(0xffc)])return;const _0x39ad47=Math[_0x7c5d51(0x5f8)]((Date[_0x7c5d51(0x487)]()-_0x20bfc1[_0x7c5d51(0xc28)])/0x3e8),_0x368b0b=Math[_0x7c5d51(0x5f8)](_0x39ad47/0x3c),_0x2723d8=_0x39ad47%0x3c;document[_0x7c5d51(0x2ec)]('call-timer')[_0x7c5d51(0x15f)]=String(_0x368b0b)[_0x7c5d51(0x58e)](0x2,'0')+':'+String(_0x2723d8)[_0x7c5d51(0x58e)](0x2,'0');}function _0x19c8ce(){const _0x2cc9d2=_0x475790,_0x29af5e=_0x28f30a[_0x2cc9d2(0x6ce)][_0x28f30a[_0x2cc9d2(0x11b9)]];if(!_0x29af5e)return;if(_0x29af5e['isGroup']){const _0x4fa4e7=_0x20bfc1[_0x2cc9d2(0x2bb)]||_0x29af5e[_0x2cc9d2(0x10f2)][0x0]?.[_0x2cc9d2(0xe36)]||_0x2cc9d2(0x38f);document[_0x2cc9d2(0x2ec)](_0x2cc9d2(0xc44))[_0x2cc9d2(0xce4)]=_0x29af5e['settings'][_0x2cc9d2(0x42c)]||_0x563b2b,document[_0x2cc9d2(0x2ec)](_0x2cc9d2(0x1457))['textContent']=_0x29af5e[_0x2cc9d2(0xe36)],document['querySelector'](_0x2cc9d2(0x8a2))[_0x2cc9d2(0x15f)]=_0x4fa4e7+_0x2cc9d2(0x452);}else document['getElementById']('caller-avatar')[_0x2cc9d2(0xce4)]=_0x29af5e['settings'][_0x2cc9d2(0xe91)]||_0x825cf1,document[_0x2cc9d2(0x2ec)](_0x2cc9d2(0x1457))[_0x2cc9d2(0x15f)]=_0x29af5e[_0x2cc9d2(0xe36)],document[_0x2cc9d2(0x765)](_0x2cc9d2(0x8a2))[_0x2cc9d2(0x15f)]=_0x2cc9d2(0x9f3);document[_0x2cc9d2(0x2ec)](_0x2cc9d2(0x604))[_0x2cc9d2(0xff6)][_0x2cc9d2(0xe82)](_0x2cc9d2(0x149d));}function _0x2dce72(){const _0xe7b34f=_0x475790;document['getElementById']('incoming-call-modal')[_0xe7b34f(0xff6)][_0xe7b34f(0x1424)](_0xe7b34f(0x149d));}async function _0x1df4a2(_0x477616=null){const _0x151fab=_0x475790;if(!_0x20bfc1[_0x151fab(0xffc)])return;const _0x3a92bb=_0x28f30a[_0x151fab(0x6ce)][_0x20bfc1[_0x151fab(0x11b9)]],{proxyUrl:_0xe5885e,apiKey:_0xeb4a6c,model:_0x4dcb5d}=_0x28f30a['apiConfig'],_0x361ab=document[_0x151fab(0x2ec)]('video-call-main'),_0x914393=_0x3a92bb[_0x151fab(0x362)][_0x151fab(0xa28)]||'我';let _0x23815a='';if(_0x3a92bb[_0x151fab(0x362)][_0x151fab(0x684)]&&_0x3a92bb[_0x151fab(0x362)][_0x151fab(0x684)]['length']>0x0){const _0x2ab5e3=_0x3a92bb[_0x151fab(0x362)][_0x151fab(0x684)][_0x151fab(0x11c6)](_0x42d067=>{const _0x362d8e=_0x151fab,_0x1465d3=_0x28f30a['worldBooks'][_0x362d8e(0x412)](_0x1542d9=>_0x1542d9['id']===_0x42d067);return _0x1465d3&&_0x1465d3[_0x362d8e(0x1047)]?_0x362d8e(0xbd0)+_0x1465d3[_0x362d8e(0xe36)]+'\x0a'+_0x1465d3['content']:'';})[_0x151fab(0xebc)](Boolean)[_0x151fab(0xbad)]('');_0x2ab5e3&&(_0x23815a=_0x151fab(0x14e0)+_0x2ab5e3+_0x151fab(0xcf2));}if(_0x477616&&_0x20bfc1['isUserParticipating']){const _0xd2e62f=Date[_0x151fab(0x487)](),_0x593d4f=document[_0x151fab(0x14ae)](_0x151fab(0xaa5));_0x593d4f['className']=_0x151fab(0x1174),_0x593d4f[_0x151fab(0x15f)]=_0x477616,_0x593d4f[_0x151fab(0xe93)][_0x151fab(0x69a)]=_0xd2e62f,_0x131542(_0x593d4f,()=>_0x5655cf(_0xd2e62f)),_0x361ab[_0x151fab(0x998)](_0x593d4f),_0x361ab['scrollTop']=_0x361ab[_0x151fab(0x1ce)],_0x20bfc1[_0x151fab(0xe33)][_0x151fab(0x367)]({'role':_0x151fab(0xcc9),'content':_0x477616,'timestamp':_0xd2e62f});}let _0x1d965f;if(_0x20bfc1[_0x151fab(0x131e)]){const _0xaf553d=_0x20bfc1[_0x151fab(0x73e)][_0x151fab(0x11c6)](_0x5a9caf=>_0x5a9caf[_0x151fab(0xe36)]);_0x20bfc1['isUserParticipating']&&_0xaf553d[_0x151fab(0x394)](_0x914393),_0x1d965f=_0x151fab(0x65e)+_0x914393+_0x151fab(0xdeb)+_0x914393+_0x151fab(0x9cb)+_0x20bfc1[_0x151fab(0x9ab)]+_0x151fab(0x3e9)+_0xaf553d['join']('、\x20')+_0x151fab(0x9e7)+_0x23815a+_0x151fab(0xc8b);}else{let _0x4f7857=_0x20bfc1[_0x151fab(0xb3c)]===_0x151fab(0xcc9)?_0x151fab(0xf63):_0x151fab(0x495);_0x1d965f=_0x151fab(0xb84)+_0x3a92bb[_0x151fab(0xe36)]+'\x20('+_0x3a92bb[_0x151fab(0x362)]['aiPersona']+')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“'+_0x3a92bb[_0x151fab(0xe36)]+'”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（'+_0x914393+_0x151fab(0x1425)+_0x3a92bb['settings'][_0x151fab(0x1528)]+'）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**'+_0x4f7857+_0x151fab(0xbb4)+_0x20bfc1[_0x151fab(0x9ab)]+_0x151fab(0x1234);}const _0x2c394b=[{'role':'system','content':_0x1d965f},..._0x20bfc1[_0x151fab(0xe33)][_0x151fab(0x11c6)](_0x31698a=>({'role':_0x31698a[_0x151fab(0x9be)],'content':_0x31698a[_0x151fab(0x1047)]}))];if(_0x20bfc1[_0x151fab(0xe33)][_0x151fab(0x9a1)]===0x0){const _0x151bc3=_0x20bfc1[_0x151fab(0xb3c)]===_0x151fab(0xcc9)?_0x151fab(0x6ec):_0x151fab(0x150e);_0x2c394b['push']({'role':_0x151fab(0xcc9),'content':_0x151bc3});}try{let _0x525550=_0xe5885e===GEMINI_API_URL,_0x34fd64=_0x4fff3d(_0x4dcb5d,_0xeb4a6c,_0x1d965f,_0x2c394b);const _0x2ac8e7=_0x525550?await fetch(_0x34fd64[_0x151fab(0x6d1)],_0x34fd64[_0x151fab(0x1418)]):await fetch(_0xe5885e+_0x151fab(0x1427),{'method':_0x151fab(0x655),'headers':{'Content-Type':'application/json','Authorization':_0x151fab(0xe83)+_0xeb4a6c},'body':JSON[_0x151fab(0xe4d)]({'model':_0x4dcb5d,'messages':_0x2c394b,'temperature':_0x28f30a[_0x151fab(0x1062)]['apiTemperature']||0.8})});if(!_0x2ac8e7['ok'])throw new Error((await _0x2ac8e7[_0x151fab(0x12a2)]())[_0x151fab(0x1518)]['message']);const _0x569121=await _0x2ac8e7[_0x151fab(0x12a2)](),_0x17ecdf=_0x525550?_0x569121[_0x151fab(0x84d)][0x0]['content']['parts'][0x0]['text']:_0x569121[_0x151fab(0x8cd)][0x0][_0x151fab(0x13bc)]['content'],_0x5bc0b1=_0x361ab[_0x151fab(0x765)]('em');if(_0x5bc0b1)_0x5bc0b1[_0x151fab(0x1424)]();if(_0x20bfc1[_0x151fab(0x131e)]){const _0x137f6e=_0x422882(_0x17ecdf);_0x137f6e['forEach'](_0x3e2386=>{const _0x443fdb=_0x151fab;if(!_0x3e2386[_0x443fdb(0xe36)]||_0x3e2386[_0x443fdb(0xe36)]===_0x914393||!_0x3e2386[_0x443fdb(0x5aa)])return;const _0x5213ae=Date[_0x443fdb(0x487)]()+Math['random'](),_0x2906fe=document['createElement'](_0x443fdb(0xaa5));_0x2906fe[_0x443fdb(0xdd1)]=_0x443fdb(0xaba),_0x2906fe[_0x443fdb(0xc43)]=_0x443fdb(0x762)+_0x3e2386[_0x443fdb(0xe36)]+_0x443fdb(0x844)+_0x3e2386[_0x443fdb(0x5aa)],_0x2906fe['dataset'][_0x443fdb(0x69a)]=_0x5213ae,_0x131542(_0x2906fe,()=>_0x5655cf(_0x5213ae)),_0x361ab[_0x443fdb(0x998)](_0x2906fe),_0x20bfc1['callHistory'][_0x443fdb(0x367)]({'role':_0x443fdb(0x6d9),'content':_0x3e2386[_0x443fdb(0xe36)]+':\x20'+_0x3e2386['speech'],'timestamp':_0x5213ae});const _0x505fa1=_0x20bfc1[_0x443fdb(0x73e)][_0x443fdb(0x412)](_0x3a2ec5=>_0x3a2ec5[_0x443fdb(0xe36)]===_0x3e2386['name']);if(_0x505fa1){const _0x2bd420=document[_0x443fdb(0x765)]('.participant-avatar-wrapper[data-participant-id=\x22'+_0x505fa1['id']+_0x443fdb(0xbbd));_0x2bd420&&(_0x2bd420[_0x443fdb(0xff6)][_0x443fdb(0xe82)]('speaking'),setTimeout(()=>_0x2bd420[_0x443fdb(0xff6)][_0x443fdb(0x1424)]('speaking'),0x7d0));}});}else{const _0x504e80=Date['now'](),_0x598394=document[_0x151fab(0x14ae)](_0x151fab(0xaa5));_0x598394[_0x151fab(0xdd1)]=_0x151fab(0xaba),_0x598394[_0x151fab(0x15f)]=_0x17ecdf,_0x598394[_0x151fab(0xe93)][_0x151fab(0x69a)]=_0x504e80,_0x131542(_0x598394,()=>_0x5655cf(_0x504e80)),_0x361ab['appendChild'](_0x598394),_0x20bfc1[_0x151fab(0xe33)]['push']({'role':'assistant','content':_0x17ecdf,'timestamp':_0x504e80});const _0x5cb09d=document['querySelector'](_0x151fab(0x13bd));_0x5cb09d&&(_0x5cb09d[_0x151fab(0xff6)][_0x151fab(0xe82)]('speaking'),setTimeout(()=>_0x5cb09d[_0x151fab(0xff6)]['remove']('speaking'),0x7d0));}_0x361ab[_0x151fab(0x12be)]=_0x361ab[_0x151fab(0x1ce)];}catch(_0x422ae5){const _0x5c90b6=document[_0x151fab(0x14ae)](_0x151fab(0xaa5));_0x5c90b6[_0x151fab(0xdd1)]='call-message-bubble\x20ai-speech',_0x5c90b6['style'][_0x151fab(0x49c)]=_0x151fab(0x78e),_0x5c90b6['textContent']=_0x151fab(0xee2)+_0x422ae5[_0x151fab(0x13bc)]+']',_0x361ab[_0x151fab(0x998)](_0x5c90b6),_0x361ab['scrollTop']=_0x361ab[_0x151fab(0x1ce)],_0x20bfc1[_0x151fab(0xe33)]['push']({'role':_0x151fab(0x6d9),'content':_0x151fab(0xee2)+_0x422ae5[_0x151fab(0x13bc)]+']'});}}function _0x4b69c6(_0x3b1e34){const _0x1f5b46=_0x475790;document[_0x1f5b46(0x2ec)](_0x1f5b46(0x385))[_0x1f5b46(0x589)][_0x1f5b46(0x701)]=_0x3b1e34?_0x1f5b46(0x5b1):_0x1f5b46(0xc67),document[_0x1f5b46(0x2ec)](_0x1f5b46(0x57e))[_0x1f5b46(0x589)][_0x1f5b46(0x701)]=_0x3b1e34?_0x1f5b46(0xc67):'none';}async function _0x54b6d0(_0x26133d,_0x2b8452){const _0x3f5cb7=_0x475790,_0x364b66=_0x28f30a[_0x3f5cb7(0x6ce)][_0x28f30a['activeChatId']];if(!_0x364b66)return;const _0x4e822a=_0x364b66[_0x3f5cb7(0x12c3)][_0x3f5cb7(0x535)](_0x594e5f=>_0x594e5f[_0x3f5cb7(0x69a)]===_0x26133d);if(_0x4e822a===-0x1)return;const _0x3cfd48=_0x364b66[_0x3f5cb7(0x12c3)][_0x4e822a];_0x3cfd48[_0x3f5cb7(0x2a3)]=_0x2b8452;let _0x38e0a6;const _0x427d84=_0x364b66[_0x3f5cb7(0x1423)]?_0x364b66['settings'][_0x3f5cb7(0xa28)]||'我':'我';_0x2b8452==='paid'?(_0x3cfd48[_0x3f5cb7(0x1012)]=_0x427d84,_0x38e0a6=_0x3f5cb7(0x319)+_0x427d84+_0x3f5cb7(0x1428)+_0x3cfd48['senderName']+_0x3f5cb7(0xde4)+_0x26133d+_0x3f5cb7(0xce5)):_0x38e0a6=_0x3f5cb7(0x319)+_0x427d84+_0x3f5cb7(0x1eb)+_0x3cfd48[_0x3f5cb7(0x1361)]+_0x3f5cb7(0x711)+_0x26133d+'）。]';const _0x2da454={'role':_0x3f5cb7(0x10a7),'content':_0x38e0a6,'timestamp':Date[_0x3f5cb7(0x487)](),'isHidden':!![]};_0x364b66[_0x3f5cb7(0x12c3)]['push'](_0x2da454),await _0x5b9d83[_0x3f5cb7(0x6ce)]['put'](_0x364b66),_0xc55746(_0x28f30a[_0x3f5cb7(0x11b9)]),_0x2b8452===_0x3f5cb7(0x12d6)&&_0x36bcc9();}async function _0x367dc2(_0x3a6f0c,_0x38ec46){const _0x408874=_0x475790,_0x4d9645=_0x28f30a['chats'][_0x3a6f0c];if(!_0x4d9645)return;let _0x49889d;_0x4d9645[_0x408874(0x1423)]?_0x49889d=_0x4f967c(_0x4d9645,_0x38ec46):_0x49889d=_0x4d9645[_0x408874(0xe36)];const _0x67c292=document[_0x408874(0x2ec)]('phone-screen');_0x67c292[_0x408874(0xff6)][_0x408874(0x1424)](_0x408874(0x714)),void _0x67c292[_0x408874(0x144c)],_0x67c292[_0x408874(0xff6)][_0x408874(0xe82)](_0x408874(0x714));const _0x33890d=await _0x33419a(_0x408874(0xcc6)+_0x49889d+'”',_0x408874(0x7c5),'',_0x408874(0x10ca));if(_0x33890d===null)return;const _0x23be77=_0x4f967c(_0x4d9645,_0x28f30a[_0x408874(0x1506)][_0x408874(0x19a)]),_0x29de76=_0x23be77+_0x408874(0x1c0)+_0x49889d+'”\x20'+_0x33890d[_0x408874(0x97e)](),_0x4807fa={'role':_0x408874(0x10a7),'type':'pat_message','content':_0x29de76,'timestamp':Date[_0x408874(0x487)]()};_0x4d9645[_0x408874(0x12c3)]['push'](_0x4807fa);const _0x2948ac=_0x408874(0x6e3)+_0x23be77+'）刚刚拍了拍你（'+_0x38ec46+'）'+_0x33890d[_0x408874(0x97e)]()+_0x408874(0x202),_0x444dda={'role':_0x408874(0x10a7),'content':_0x2948ac,'timestamp':Date[_0x408874(0x487)]()+0x1,'isHidden':!![]};_0x4d9645[_0x408874(0x12c3)][_0x408874(0x367)](_0x444dda),await _0x5b9d83[_0x408874(0x6ce)]['put'](_0x4d9645),_0x28f30a['activeChatId']===_0x3a6f0c&&_0x4cc03e(_0x4807fa,_0x4d9645),await _0x5db8a3();}let _0x4e2d49=null,_0x5c53cf=![],_0x2b7696=new Set();function _0x5655cf(_0x2d9ac5){const _0xe0d0b=_0x475790;_0x4e2d49=_0x2d9ac5,document[_0xe0d0b(0x2ec)]('call-message-actions-modal')[_0xe0d0b(0xff6)][_0xe0d0b(0xe82)](_0xe0d0b(0x149d));}function _0x1d49ce(){const _0x5a49cc=_0x475790;document[_0x5a49cc(0x2ec)](_0x5a49cc(0x1461))[_0x5a49cc(0xff6)][_0x5a49cc(0x1424)](_0x5a49cc(0x149d)),_0x4e2d49=null;}async function _0x49851c(){const _0x2263b7=_0x475790;if(!_0x4e2d49)return;const _0x5d564b=_0x4e2d49,_0x596f1e=_0x20bfc1[_0x2263b7(0xe33)]['find'](_0x11d528=>_0x11d528[_0x2263b7(0x69a)]===_0x5d564b);if(!_0x596f1e)return;_0x1d49ce();let _0x321045=_0x596f1e['content'];if(_0x20bfc1[_0x2263b7(0x131e)]&&_0x596f1e[_0x2263b7(0x9be)]==='assistant'){const _0x5540e1=_0x596f1e[_0x2263b7(0x1047)]['split'](':\x20');_0x5540e1['length']>0x1&&(_0x321045=_0x5540e1[_0x2263b7(0x225)](0x1)[_0x2263b7(0xbad)](':\x20'));}const _0x1112d4=await _0x33419a(_0x2263b7(0x407),_0x2263b7(0x72e),_0x321045,'textarea');_0x1112d4!==null&&await _0x184b8b(_0x5d564b,_0x1112d4);}async function _0x184b8b(_0x39d888,_0x6889ff){const _0x5a44f7=_0x475790,_0xefb10c=_0x20bfc1[_0x5a44f7(0xe33)]['find'](_0x227788=>_0x227788[_0x5a44f7(0x69a)]===_0x39d888);if(_0xefb10c){let _0x4e7a3d=_0x6889ff;if(_0x20bfc1[_0x5a44f7(0x131e)]&&_0xefb10c[_0x5a44f7(0x9be)]===_0x5a44f7(0x6d9)){const _0x3d706d=_0xefb10c['content'][_0x5a44f7(0xa8a)](':\x20'),_0x1939d3=_0x3d706d[0x0];_0x4e7a3d=_0x1939d3+':\x20'+_0x6889ff;}_0xefb10c[_0x5a44f7(0x1047)]=_0x4e7a3d;const _0x19ebd8=document['querySelector']('.call-message-bubble[data-timestamp=\x22'+_0x39d888+'\x22]');if(_0x19ebd8){if(_0x20bfc1['isGroupCall']&&_0xefb10c['role']===_0x5a44f7(0x6d9)){const _0x21f3db=_0xefb10c[_0x5a44f7(0x1047)][_0x5a44f7(0xa8a)](':\x20'),_0x2af4ee=_0x21f3db[0x0];_0x19ebd8[_0x5a44f7(0xc43)]=_0x5a44f7(0x762)+_0x2af4ee+_0x5a44f7(0x844)+_0x6889ff;}else _0x19ebd8[_0x5a44f7(0x15f)]=_0x6889ff;}}await _0x34d596('成功',_0x5a44f7(0x686));}async function _0x30fb6b(){const _0x180639=_0x475790;if(!_0x4e2d49)return;const _0x5f22fd=await _0x4436ba(_0x180639(0xde9),_0x180639(0x6d6),{'confirmButtonClass':'btn-danger'});if(_0x5f22fd){const _0x4962ba=_0x4e2d49;_0x1d49ce();const _0x278b0a=_0x20bfc1['callHistory'][_0x180639(0x535)](_0xf2044f=>_0xf2044f[_0x180639(0x69a)]===_0x4962ba);_0x278b0a>-0x1&&_0x20bfc1[_0x180639(0xe33)][_0x180639(0x510)](_0x278b0a,0x1);const _0x58494e=document[_0x180639(0x765)]('.call-message-bubble[data-timestamp=\x22'+_0x4962ba+'\x22]');_0x58494e&&_0x58494e[_0x180639(0x1424)]();}else _0x1d49ce();}function _0x1c5e62(_0x5a137b){const _0x5932a3=_0x475790;_0x5db9cb=_0x5a137b;const _0x157740=_0x28f30a[_0x5932a3(0x6ce)][_0x28f30a[_0x5932a3(0x11b9)]],_0x39fc0d=_0x157740[_0x5932a3(0x12c3)][_0x5932a3(0x412)](_0x2b3ba4=>_0x2b3ba4[_0x5932a3(0x69a)]===_0x5a137b);_0x39fc0d&&(document[_0x5932a3(0x2ec)](_0x5932a3(0xe42))[_0x5932a3(0x15f)]=_0x39fc0d[_0x5932a3(0x1361)]),document[_0x5932a3(0x2ec)]('transfer-actions-modal')['classList']['add'](_0x5932a3(0x149d));}function _0x4eb421(){const _0x52cfca=_0x475790;document[_0x52cfca(0x2ec)](_0x52cfca(0x1bd))[_0x52cfca(0xff6)][_0x52cfca(0x1424)]('visible'),_0x5db9cb=null;}async function _0x2c10a4(_0xd3d100){const _0x66c24e=_0x475790;if(!_0x5db9cb)return;const _0x3310ad=_0x5db9cb,_0x1e5448=_0x28f30a[_0x66c24e(0x6ce)][_0x28f30a[_0x66c24e(0x11b9)]],_0x2c874d=_0x1e5448[_0x66c24e(0x12c3)][_0x66c24e(0x535)](_0x153611=>_0x153611[_0x66c24e(0x69a)]===_0x3310ad);if(_0x2c874d===-0x1)return;const _0x1b282e=_0x1e5448[_0x66c24e(0x12c3)][_0x2c874d];_0x1b282e[_0x66c24e(0x2a3)]=_0xd3d100;let _0x4322a2;if(_0xd3d100===_0x66c24e(0x757)){const _0x1324d1={'role':_0x66c24e(0xcc9),'type':_0x66c24e(0x277),'isRefund':!![],'amount':_0x1b282e[_0x66c24e(0x257)],'note':_0x66c24e(0x102d),'timestamp':Date[_0x66c24e(0x487)]()};_0x1e5448['history']['push'](_0x1324d1),_0x4322a2=_0x66c24e(0x14b0)+_0x1b282e[_0x66c24e(0x1361)]+_0x66c24e(0x215);}else _0x4322a2=_0x66c24e(0xc3d)+_0x1b282e[_0x66c24e(0x1361)]+'”的转账。]';const _0x324453={'role':_0x66c24e(0x10a7),'content':_0x4322a2,'timestamp':Date[_0x66c24e(0x487)]()+0x1,'isHidden':!![]};_0x1e5448[_0x66c24e(0x12c3)][_0x66c24e(0x367)](_0x324453),await _0x5b9d83[_0x66c24e(0x6ce)][_0x66c24e(0x7c3)](_0x1e5448),_0x4eb421(),_0xc55746(_0x28f30a[_0x66c24e(0x11b9)]),_0x5db8a3();}function _0x32374a(_0x54d5dd){const _0x4a6e02=_0x475790;_0xbdfe41=null;if(_0x54d5dd){const _0x3a237c=_0x54d5dd[_0x4a6e02(0x765)](_0x4a6e02(0x46e));_0x3a237c&&(_0x3a237c[_0x4a6e02(0xa0a)]=_0x4a6e02(0xe88));}}async function _0x50688b(){const _0x1bb2ea=_0x475790,_0x3807f1=document[_0x1bb2ea(0x2ec)]('memories-list');_0x3807f1['innerHTML']='';const _0x3c8783=await _0x5b9d83[_0x1bb2ea(0xf49)][_0x1bb2ea(0x106d)]('timestamp')['reverse']()[_0x1bb2ea(0x14b5)]();if(_0x3c8783[_0x1bb2ea(0x9a1)]===0x0){_0x3807f1[_0x1bb2ea(0xc43)]=_0x1bb2ea(0x10b8);return;}_0x3c8783['sort']((_0x3095b5,_0x3e8731)=>{const _0x2d5ba4=_0x1bb2ea,_0x320ca3=_0x3095b5[_0x2d5ba4(0xb4b)]===_0x2d5ba4(0x975)&&_0x3095b5[_0x2d5ba4(0x40f)]>Date[_0x2d5ba4(0x487)](),_0x2b764d=_0x3e8731[_0x2d5ba4(0xb4b)]===_0x2d5ba4(0x975)&&_0x3e8731[_0x2d5ba4(0x40f)]>Date[_0x2d5ba4(0x487)]();if(_0x320ca3&&!_0x2b764d)return-0x1;if(!_0x320ca3&&_0x2b764d)return 0x1;if(_0x320ca3&&_0x2b764d)return _0x3095b5['targetDate']-_0x3e8731[_0x2d5ba4(0x40f)];return 0x0;}),_0x3c8783['forEach'](_0x56a878=>{const _0x33050b=_0x1bb2ea;let _0x29272a;_0x56a878[_0x33050b(0xb4b)]===_0x33050b(0x975)&&_0x56a878[_0x33050b(0x40f)]>Date[_0x33050b(0x487)]()?_0x29272a=_0x47c1b9(_0x56a878):_0x29272a=_0xe71036(_0x56a878),_0x3807f1[_0x33050b(0x998)](_0x29272a);}),_0x5a361c();}function _0xe71036(_0x47215b){const _0x329c52=_0x475790,_0xb3685=document[_0x329c52(0x14ae)](_0x329c52(0xaa5));_0xb3685[_0x329c52(0xdd1)]=_0x329c52(0x1566);const _0x3f07a6=new Date(_0x47215b[_0x329c52(0x69a)]),_0x3dca06=_0x3f07a6['getFullYear']()+'-'+String(_0x3f07a6['getMonth']()+0x1)[_0x329c52(0x58e)](0x2,'0')+'-'+String(_0x3f07a6[_0x329c52(0x3c7)]())['padStart'](0x2,'0')+'\x20'+String(_0x3f07a6[_0x329c52(0x8a5)]())[_0x329c52(0x58e)](0x2,'0')+':'+String(_0x3f07a6['getMinutes']())[_0x329c52(0x58e)](0x2,'0');let _0x12a0ef,_0x58641e;if(_0x47215b[_0x329c52(0xb4b)]===_0x329c52(0x975)&&_0x47215b[_0x329c52(0x40f)])_0x12a0ef=_0x329c52(0x574)+_0x47215b[_0x329c52(0x9cc)],_0x58641e=_0x35bd8e('在\x20'+new Date(_0x47215b[_0x329c52(0x40f)])[_0x329c52(0xc4c)]()+_0x329c52(0x1213))[_0x329c52(0x13ed)](/\n/g,_0x329c52(0xfd7));else{let _0x4c28db=_0x329c52(0x687);if(_0x47215b[_0x329c52(0xe87)]){const _0x2a413a=_0x28f30a[_0x329c52(0x6ce)][_0x47215b['authorId']];_0x2a413a?_0x4c28db=_0x2a413a[_0x329c52(0xe36)]:_0x4c28db=_0x47215b[_0x329c52(0xa5d)]||_0x329c52(0x8b4);}else _0x47215b[_0x329c52(0xa5d)]&&(_0x4c28db=_0x47215b[_0x329c52(0xa5d)]);_0x12a0ef=_0x4c28db+'\x20的日记',_0x58641e=_0x35bd8e(_0x47215b['description']);}return _0xb3685[_0x329c52(0xc43)]=_0x329c52(0x8c8)+_0x3dca06+_0x329c52(0xc4d)+_0x12a0ef+_0x329c52(0x740)+_0x58641e+_0x329c52(0xf83),_0x131542(_0xb3685,async()=>{const _0x266f31=_0x329c52,_0x47f209=await _0x4436ba('删除记录',_0x266f31(0x5d1),{'confirmButtonClass':_0x266f31(0xd8f)});_0x47f209&&(await _0x5b9d83['memories'][_0x266f31(0x54b)](_0x47215b['id']),_0x50688b());}),_0xb3685;}function _0x47c1b9(_0x3a7558){const _0x13f682=_0x475790,_0x245c5e=document[_0x13f682(0x14ae)](_0x13f682(0xaa5));_0x245c5e[_0x13f682(0xdd1)]=_0x13f682(0x1553);const _0x131344=new Date(_0x3a7558[_0x13f682(0x40f)]),_0x251dcc=_0x131344[_0x13f682(0xc4c)](_0x13f682(0x1054),{'dateStyle':_0x13f682(0x1124),'timeStyle':'short'});return _0x245c5e['innerHTML']=_0x13f682(0x94b)+_0x3a7558[_0x13f682(0x9cc)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22'+_0x3a7558[_0x13f682(0x40f)]+_0x13f682(0xb8a)+_0x251dcc+_0x13f682(0xf83),_0x131542(_0x245c5e,async()=>{const _0x11db53=_0x13f682,_0x727476=await _0x4436ba(_0x11db53(0x341),_0x11db53(0x953),{'confirmButtonClass':_0x11db53(0xd8f)});_0x727476&&(await _0x5b9d83[_0x11db53(0xf49)][_0x11db53(0x54b)](_0x3a7558['id']),_0x50688b());}),_0x245c5e;}let _0x4c50bc=[];function _0x5a361c(){const _0x5f5554=_0x475790;_0x4c50bc[_0x5f5554(0xf99)](_0x56ff37=>clearInterval(_0x56ff37)),_0x4c50bc=[],document['querySelectorAll'](_0x5f5554(0xa0f))[_0x5f5554(0xf99)](_0x5df5b9=>{const _0x396a15=_0x5f5554,_0x867641=parseInt(_0x5df5b9[_0x396a15(0xe93)][_0x396a15(0x40f)]);let _0x3507a3;const _0x819026=()=>{const _0x366548=_0x396a15,_0x14fc8e=Date[_0x366548(0x487)](),_0x3d8d88=_0x867641-_0x14fc8e;if(_0x3d8d88<0x0){_0x5df5b9['textContent']=_0x366548(0x14c0),clearInterval(_0x3507a3),setTimeout(()=>_0x50688b(),0x7d0);return;}const _0x1e99ea=Math[_0x366548(0x5f8)](_0x3d8d88/(0x3e8*0x3c*0x3c*0x18)),_0x1e5ae5=Math[_0x366548(0x5f8)](_0x3d8d88%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0xa6b1cd=Math['floor'](_0x3d8d88%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x65afad=Math[_0x366548(0x5f8)](_0x3d8d88%(0x3e8*0x3c)/0x3e8);_0x5df5b9['textContent']=_0x1e99ea+'天\x20'+_0x1e5ae5+'时\x20'+_0xa6b1cd+'分\x20'+_0x65afad+'秒';};_0x819026(),_0x3507a3=setInterval(_0x819026,0x3e8),_0x4c50bc[_0x396a15(0x367)](_0x3507a3);});}async function _0x581fd5(_0x523d93){const _0x1b85e2=_0x475790,_0x53c759=_0x28f30a[_0x1b85e2(0x6ce)][_0x523d93];if(!_0x53c759)return;await _0x34d596(_0x1b85e2(0x3af),_0x1b85e2(0xea7)+_0x53c759[_0x1b85e2(0xe36)]+_0x1b85e2(0x8fb));const {proxyUrl:_0xcaee2c,apiKey:_0x29041c,model:_0x36d119}=_0x28f30a[_0x1b85e2(0x1537)];if(!_0xcaee2c||!_0x29041c||!_0x36d119){await _0x34d596(_0x1b85e2(0x1284),_0x1b85e2(0x1294));return;}const _0x3a9d38=_0x53c759['history']['slice'](-0x5)[_0x1b85e2(0x11c6)](_0x38b967=>{const _0x27fc7d=_0x1b85e2,_0x3e2831=_0x38b967[_0x27fc7d(0x9be)]===_0x27fc7d(0xcc9)?_0x53c759[_0x27fc7d(0x362)][_0x27fc7d(0xa28)]||'我':_0x38b967['senderName']||_0x53c759[_0x27fc7d(0xe36)];return _0x3e2831+':\x20'+String(_0x38b967['content'])[_0x27fc7d(0xa6b)](0x0,0x32)+_0x27fc7d(0x4e6);})[_0x1b85e2(0xbad)]('\x0a');let _0x372a9a='';if(_0x53c759[_0x1b85e2(0x362)][_0x1b85e2(0x684)]&&_0x53c759['settings'][_0x1b85e2(0x684)][_0x1b85e2(0x9a1)]>0x0){const _0x57de27=_0x53c759[_0x1b85e2(0x362)][_0x1b85e2(0x684)]['map'](_0x1ba943=>{const _0x348dc2=_0x1b85e2,_0x4b15a6=_0x28f30a[_0x348dc2(0x13b9)][_0x348dc2(0x412)](_0x434548=>_0x434548['id']===_0x1ba943);if(!_0x4b15a6||!Array[_0x348dc2(0x624)](_0x4b15a6[_0x348dc2(0x1047)]))return'';const _0x48200c=_0x4b15a6[_0x348dc2(0x1047)]['map'](_0x477390=>{const _0x122ad0=_0x348dc2;let _0x14028b=_0x122ad0(0xe5c)+(_0x477390['comment']||_0x122ad0(0x342))+'\x0a';return _0x477390['keys']['length']>0x0&&(_0x14028b+=_0x122ad0(0x933)+_0x477390['keys'][_0x122ad0(0xbad)](',\x20')+'\x0a'),_0x14028b+='**内容:**\x0a'+_0x477390['content'],_0x14028b;})[_0x348dc2(0xbad)]('\x0a');return _0x48200c?_0x348dc2(0xbd0)+_0x4b15a6[_0x348dc2(0xe36)]+'\x0a'+_0x48200c:'';})['filter'](Boolean)[_0x1b85e2(0xbad)]('');_0x57de27&&(_0x372a9a=_0x1b85e2(0xfc9)+_0x57de27+'\x0a');}const _0x3ddbc2=_0x1b85e2(0x10da)+_0x53c759[_0x1b85e2(0xe36)]+_0x1b85e2(0xf91)+_0x53c759[_0x1b85e2(0x362)][_0x1b85e2(0x67c)]+_0x1b85e2(0xe7c)+_0x372a9a+_0x1b85e2(0x1343)+_0x3a9d38+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20';try{const _0x40407d=[{'role':_0x1b85e2(0x10a7),'content':_0x3ddbc2},{'role':_0x1b85e2(0xcc9),'content':'请根据以上设定开始你的决策。'}];let _0x4b852d=_0xcaee2c===GEMINI_API_URL,_0x581329=_0x4fff3d(_0x36d119,_0x29041c,_0x3ddbc2,_0x40407d);const _0x230814=_0x4b852d?await fetch(_0x581329[_0x1b85e2(0x6d1)],_0x581329[_0x1b85e2(0x1418)]):await fetch(_0xcaee2c+_0x1b85e2(0x1427),{'method':_0x1b85e2(0x655),'headers':{'Content-Type':_0x1b85e2(0x1446),'Authorization':_0x1b85e2(0xe83)+_0x29041c},'body':JSON['stringify']({'model':_0x36d119,'messages':_0x40407d,'temperature':_0x28f30a[_0x1b85e2(0x1062)]['apiTemperature']||0.9})});if(!_0x230814['ok']){const _0x35e950=await _0x230814['json']();throw new Error(_0x1b85e2(0x1515)+_0x230814[_0x1b85e2(0x2a3)]+'\x20-\x20'+_0x35e950[_0x1b85e2(0x1518)][_0x1b85e2(0x13bc)]);}const _0x18f8ed=await _0x230814['json']();let _0x4c276b=_0x4b852d?_0x18f8ed[_0x1b85e2(0x84d)][0x0][_0x1b85e2(0x1047)][_0x1b85e2(0x13c0)][0x0][_0x1b85e2(0x10ca)]:_0x18f8ed[_0x1b85e2(0x8cd)][0x0][_0x1b85e2(0x13bc)][_0x1b85e2(0x1047)];_0x4c276b=_0x4c276b[_0x1b85e2(0x13ed)](/^```json\s*/,'')[_0x1b85e2(0x13ed)](/```$/,'');const _0x42a625=_0x4c276b['trim'](),_0x521f0a=JSON[_0x1b85e2(0xd91)](_0x42a625);_0x521f0a[_0x1b85e2(0x531)]===_0x1b85e2(0x853)&&_0x521f0a['reason']?(_0x53c759[_0x1b85e2(0xaf4)][_0x1b85e2(0x2a3)]='pending_user_approval',_0x53c759[_0x1b85e2(0xaf4)]['applicationReason']=_0x521f0a['reason'],_0x28f30a[_0x1b85e2(0x6ce)][_0x523d93]=_0x53c759,_0x5db8a3(),await _0x34d596('申请成功！','“'+_0x53c759[_0x1b85e2(0xe36)]+_0x1b85e2(0x86c))):(await _0x34d596(_0x1b85e2(0x13f2),'“'+_0x53c759[_0x1b85e2(0xe36)]+_0x1b85e2(0x10be)),_0x53c759['relationship'][_0x1b85e2(0x2a3)]=_0x1b85e2(0x214),_0x53c759[_0x1b85e2(0xaf4)]['blockedTimestamp']=Date[_0x1b85e2(0x487)]());}catch(_0x87f40a){await _0x34d596('执行出错','为“'+_0x53c759[_0x1b85e2(0xe36)]+_0x1b85e2(0x1178)+_0x87f40a['message']+_0x1b85e2(0x13a8)),_0x53c759[_0x1b85e2(0xaf4)][_0x1b85e2(0x2a3)]=_0x1b85e2(0x214),_0x53c759[_0x1b85e2(0xaf4)][_0x1b85e2(0xee3)]=Date[_0x1b85e2(0x487)]();}finally{await _0x5b9d83[_0x1b85e2(0x6ce)]['put'](_0x53c759),_0xc55746(_0x523d93);}}function _0xebf407(){const _0xcabde=_0x475790;if(!_0x28f30a[_0xcabde(0x11b9)])return;const _0x28c80c=_0x28f30a[_0xcabde(0x6ce)][_0x28f30a[_0xcabde(0x11b9)]];_0x28c80c['isGroup']?_0x2a198e():document[_0xcabde(0x2ec)]('transfer-modal')['classList'][_0xcabde(0xe82)](_0xcabde(0x149d));}function _0x2a198e(){const _0x470222=_0x475790,_0x597e73=document['getElementById'](_0x470222(0x2b8)),_0x30a480=_0x28f30a[_0x470222(0x6ce)][_0x28f30a[_0x470222(0x11b9)]];document[_0x470222(0x2ec)](_0x470222(0x59b))[_0x470222(0x11a4)]='',document[_0x470222(0x2ec)](_0x470222(0x10fc))[_0x470222(0x11a4)]='',document['getElementById']('rp-group-greeting')['value']='',document[_0x470222(0x2ec)](_0x470222(0x11ff))[_0x470222(0x11a4)]='',document[_0x470222(0x2ec)](_0x470222(0x4b1))[_0x470222(0x11a4)]='',document[_0x470222(0x2ec)](_0x470222(0xb99))[_0x470222(0x15f)]=_0x470222(0xd6d),document['getElementById'](_0x470222(0x13c7))[_0x470222(0x15f)]=_0x470222(0xd6d);const _0x3a22af=document[_0x470222(0x2ec)]('rp-direct-receiver');_0x3a22af[_0x470222(0xc43)]='',_0x30a480[_0x470222(0x10f2)][_0x470222(0xf99)](_0x3adc14=>{const _0x146906=_0x470222,_0x2b8182=document[_0x146906(0x14ae)](_0x146906(0x29d));_0x2b8182[_0x146906(0x11a4)]=_0x3adc14['originalName'],_0x2b8182[_0x146906(0x15f)]=_0x3adc14[_0x146906(0x8a8)],_0x3a22af['appendChild'](_0x2b8182);}),document[_0x470222(0x2ec)]('rp-tab-group')['click'](),_0x597e73[_0x470222(0xff6)][_0x470222(0xe82)](_0x470222(0x149d));}async function _0x4a0410(){const _0x10dab5=_0x475790,_0x57c255=_0x28f30a[_0x10dab5(0x6ce)][_0x28f30a[_0x10dab5(0x11b9)]],_0x59e559=parseFloat(document[_0x10dab5(0x2ec)](_0x10dab5(0x59b))[_0x10dab5(0x11a4)]),_0x53b34f=parseInt(document[_0x10dab5(0x2ec)](_0x10dab5(0x10fc))[_0x10dab5(0x11a4)]),_0x29b319=document['getElementById'](_0x10dab5(0x6f1))['value'][_0x10dab5(0x97e)]();if(isNaN(_0x59e559)||_0x59e559<=0x0){alert('请输入有效的总金额！');return;}if(isNaN(_0x53b34f)||_0x53b34f<=0x0){alert('请输入有效的红包个数！');return;}if(_0x59e559/_0x53b34f<0.01){alert(_0x10dab5(0x47a));return;}const _0x1e3647=_0x57c255[_0x10dab5(0x362)][_0x10dab5(0xa28)]||'我',_0x238d7f={'role':_0x10dab5(0xcc9),'senderName':_0x1e3647,'type':_0x10dab5(0x512),'packetType':'lucky','timestamp':Date[_0x10dab5(0x487)](),'totalAmount':_0x59e559,'count':_0x53b34f,'greeting':_0x29b319||_0x10dab5(0x7a4),'claimedBy':{},'isFullyClaimed':![]};_0x57c255[_0x10dab5(0x12c3)]['push'](_0x238d7f),await _0x5b9d83['chats'][_0x10dab5(0x7c3)](_0x57c255),_0x4cc03e(_0x238d7f,_0x57c255),_0x5db8a3(),document[_0x10dab5(0x2ec)](_0x10dab5(0x2b8))[_0x10dab5(0xff6)][_0x10dab5(0x1424)](_0x10dab5(0x149d));}async function _0x4f9780(){const _0x1f9899=_0x475790,_0x1ce7bc=_0x28f30a[_0x1f9899(0x6ce)][_0x28f30a[_0x1f9899(0x11b9)]],_0x3ab7b3=parseFloat(document['getElementById'](_0x1f9899(0x11ff))[_0x1f9899(0x11a4)]),_0x2e99ec=document['getElementById'](_0x1f9899(0x25b))['value'],_0x1df1aa=document[_0x1f9899(0x2ec)](_0x1f9899(0x4b1))[_0x1f9899(0x11a4)][_0x1f9899(0x97e)]();if(isNaN(_0x3ab7b3)||_0x3ab7b3<=0x0){alert('请输入有效的金额！');return;}if(!_0x2e99ec){alert(_0x1f9899(0x619));return;}const _0x3a02dd=_0x1ce7bc[_0x1f9899(0x362)][_0x1f9899(0xa28)]||'我',_0x504a7d={'role':_0x1f9899(0xcc9),'senderName':_0x3a02dd,'type':'red_packet','packetType':_0x1f9899(0x43c),'timestamp':Date[_0x1f9899(0x487)](),'totalAmount':_0x3ab7b3,'count':0x1,'greeting':_0x1df1aa||_0x1f9899(0x4af),'receiverName':_0x2e99ec,'claimedBy':{},'isFullyClaimed':![]};_0x1ce7bc[_0x1f9899(0x12c3)][_0x1f9899(0x367)](_0x504a7d),await _0x5b9d83['chats'][_0x1f9899(0x7c3)](_0x1ce7bc),_0x4cc03e(_0x504a7d,_0x1ce7bc),_0x5db8a3(),document[_0x1f9899(0x2ec)](_0x1f9899(0x2b8))[_0x1f9899(0xff6)]['remove']('visible');}async function _0x1b1fff(_0x286dd2){const _0x23cb2d=_0x475790,_0x1ccc1b=_0x28f30a[_0x23cb2d(0x11b9)],_0xff1272=await _0x5b9d83['chats']['get'](_0x1ccc1b);if(!_0xff1272)return;_0x28f30a[_0x23cb2d(0x6ce)][_0x1ccc1b]=_0xff1272;const _0xd64152=_0xff1272['history']['find'](_0x32c512=>_0x32c512['timestamp']===_0x286dd2);if(!_0xd64152)return;const _0x323f60=_0x28f30a[_0x23cb2d(0x1506)]['nickname']||_0x23cb2d(0x450),_0x644049=_0xd64152['claimedBy']&&_0xd64152[_0x23cb2d(0x13b7)][_0x323f60];if(_0xd64152[_0x23cb2d(0x110b)]===_0x23cb2d(0x43c)&&_0xd64152['receiverName']!==_0x323f60&&Object['keys'](_0xd64152[_0x23cb2d(0x13b7)])[_0x23cb2d(0x9a1)]>0x0||_0xd64152['isFullyClaimed']||_0x644049){_0x39e211(_0xd64152);return;}const _0x1c5751=await _0x3ee836(_0xd64152);_0x1c5751!==null&&(await _0xc55746(_0x1ccc1b),await _0x34d596(_0x23cb2d(0x7ec),'你领取了\x20'+_0x4f967c(_0xff1272,_0xd64152[_0x23cb2d(0x1361)])+_0x23cb2d(0xbde)+_0x1c5751[_0x23cb2d(0x5c3)](0x2)+'\x20元。'));const _0x3812ca=_0x28f30a[_0x23cb2d(0x6ce)][_0x1ccc1b]['history']['find'](_0x206f5e=>_0x206f5e[_0x23cb2d(0x69a)]===_0x286dd2);_0x3812ca&&_0x39e211(_0x3812ca);}async function _0x3ee836(_0xc9601e){const _0x5f2f45=_0x475790,_0x536a14=_0x28f30a[_0x5f2f45(0x6ce)][_0x28f30a['activeChatId']];let _0x2ced40=Date[_0x5f2f45(0x487)]();const _0x198686=_0x28f30a[_0x5f2f45(0x1506)][_0x5f2f45(0x19a)]||_0x5f2f45(0x450),_0x189a14=_0xc9601e[_0x5f2f45(0xdd4)]-Object['keys'](_0xc9601e[_0x5f2f45(0x13b7)]||{})['length'];if(_0x189a14<=0x0)return _0xc9601e['isFullyClaimed']=!![],await _0x5b9d83[_0x5f2f45(0x6ce)][_0x5f2f45(0x7c3)](_0x536a14),await _0x34d596(_0x5f2f45(0x1228),'红包已被领完！'),null;let _0x6ce896=0x0;const _0x4d0cc7=_0xc9601e['totalAmount']-Object[_0x5f2f45(0x74e)](_0xc9601e[_0x5f2f45(0x13b7)]||{})[_0x5f2f45(0xcdd)]((_0x5ae632,_0x4704b5)=>_0x5ae632+_0x4704b5,0x0);if(_0xc9601e[_0x5f2f45(0x110b)]==='lucky'){if(_0x189a14===0x1)_0x6ce896=_0x4d0cc7;else{const _0x53735c=0.01,_0x48a032=_0x4d0cc7-(_0x189a14-0x1)*_0x53735c;_0x6ce896=Math[_0x5f2f45(0x1337)]()*(_0x48a032-_0x53735c)+_0x53735c;}}else _0x6ce896=_0xc9601e[_0x5f2f45(0x40b)];_0x6ce896=parseFloat(_0x6ce896['toFixed'](0x2));if(!_0xc9601e[_0x5f2f45(0x13b7)])_0xc9601e[_0x5f2f45(0x13b7)]={};_0xc9601e[_0x5f2f45(0x13b7)][_0x198686]=_0x6ce896;const _0x543851=Object[_0x5f2f45(0xf6b)](_0xc9601e['claimedBy'])['length']>=_0xc9601e['count'];_0x543851&&(_0xc9601e['isFullyClaimed']=!![]);const _0xa4a783=_0x4f967c(_0x536a14,_0x198686),_0x2343bf=_0x4f967c(_0x536a14,_0xc9601e[_0x5f2f45(0x1361)]),_0x1c81b1={'role':'system','type':_0x5f2f45(0x10aa),'content':'你领取了\x20'+_0x2343bf+_0x5f2f45(0xd77),'timestamp':_0x2ced40++};_0x536a14[_0x5f2f45(0x12c3)][_0x5f2f45(0x367)](_0x1c81b1);let _0x303a73;if(_0x543851){const _0x568558={'role':_0x5f2f45(0x10a7),'type':_0x5f2f45(0x10aa),'content':_0x2343bf+'\x20的红包已被领完','timestamp':_0x2ced40++};_0x536a14[_0x5f2f45(0x12c3)][_0x5f2f45(0x367)](_0x568558);let _0x5b9049={'name':'','amount':-0x1};_0xc9601e[_0x5f2f45(0x110b)]==='lucky'&&_0xc9601e[_0x5f2f45(0xdd4)]>0x1&&Object[_0x5f2f45(0x127b)](_0xc9601e[_0x5f2f45(0x13b7)])[_0x5f2f45(0xf99)](([_0x395dbd,_0x19b29f])=>{const _0x1ac58e=_0x5f2f45;_0x19b29f>_0x5b9049[_0x1ac58e(0x257)]&&(_0x5b9049={'name':_0x395dbd,'amount':_0x19b29f});});const _0x294f71=_0x5b9049[_0x5f2f45(0xe36)]?_0x4f967c(_0x536a14,_0x5b9049[_0x5f2f45(0xe36)]):'无';_0x303a73=_0x5f2f45(0x12a1)+_0xa4a783+')\x20领取了最后一个红包。红包已被领完，手气王是\x20'+_0x294f71+_0x5f2f45(0x151f);}else _0x303a73=_0x5f2f45(0x12a1)+_0xa4a783+_0x5f2f45(0x14d8)+_0xc9601e['timestamp']+_0x5f2f45(0x2d6);const _0x6ad676={'role':_0x5f2f45(0x10a7),'content':_0x303a73,'timestamp':_0x2ced40++,'isHidden':!![]};return _0x536a14[_0x5f2f45(0x12c3)][_0x5f2f45(0x367)](_0x6ad676),await _0x5b9d83[_0x5f2f45(0x6ce)][_0x5f2f45(0x7c3)](_0x536a14),_0x6ce896;}async function _0x39e211(_0x34bc40){const _0x2dbc9d=_0x475790;if(!_0x34bc40){console[_0x2dbc9d(0x1518)](_0x2dbc9d(0xeb7));return;}const _0x4ad852=_0x28f30a['chats'][_0x28f30a[_0x2dbc9d(0x11b9)]];if(!_0x4ad852)return;const _0xc0e45b=document[_0x2dbc9d(0x2ec)](_0x2dbc9d(0x12ea)),_0x1fd57d=_0x28f30a[_0x2dbc9d(0x1506)][_0x2dbc9d(0x19a)]||_0x2dbc9d(0x450),_0x20b75d=_0x4f967c(_0x4ad852,_0x34bc40[_0x2dbc9d(0x1361)]);document[_0x2dbc9d(0x2ec)](_0x2dbc9d(0xaf3))[_0x2dbc9d(0x15f)]=_0x20b75d,document[_0x2dbc9d(0x2ec)](_0x2dbc9d(0x987))[_0x2dbc9d(0x15f)]=_0x34bc40[_0x2dbc9d(0x234)]||_0x2dbc9d(0x7a4);const _0x176d48=document[_0x2dbc9d(0x2ec)](_0x2dbc9d(0x4fe));_0x34bc40[_0x2dbc9d(0x13b7)]&&_0x34bc40[_0x2dbc9d(0x13b7)][_0x1fd57d]?(_0x176d48[_0x2dbc9d(0x765)](_0x2dbc9d(0x11cb))['textContent']=_0x34bc40['claimedBy'][_0x1fd57d]['toFixed'](0x2),_0x176d48[_0x2dbc9d(0x589)]['display']=_0x2dbc9d(0x13f7)):_0x176d48['style'][_0x2dbc9d(0x701)]=_0x2dbc9d(0x5b1);const _0x4d9f46=Object[_0x2dbc9d(0xf6b)](_0x34bc40[_0x2dbc9d(0x13b7)]||{})['length'],_0x109a2f=Object[_0x2dbc9d(0x74e)](_0x34bc40[_0x2dbc9d(0x13b7)]||{})[_0x2dbc9d(0xcdd)]((_0x19b91a,_0x4392f7)=>_0x19b91a+_0x4392f7,0x0);let _0x291a04=_0x4d9f46+'/'+_0x34bc40[_0x2dbc9d(0xdd4)]+'个红包，共'+_0x109a2f[_0x2dbc9d(0x5c3)](0x2)+'/'+_0x34bc40['totalAmount'][_0x2dbc9d(0x5c3)](0x2)+'元。';if(!_0x34bc40[_0x2dbc9d(0x1410)]&&_0x4d9f46<_0x34bc40['count']){const _0x298d62=Math[_0x2dbc9d(0x5f8)]((_0x34bc40[_0x2dbc9d(0x69a)]+0x18*0x3c*0x3c*0x3e8-Date['now']())/(0x3e8*0x3c*0x3c));if(_0x298d62>0x0)_0x291a04+='\x20剩余红包将在'+_0x298d62+'小时内退还。';}document[_0x2dbc9d(0x2ec)](_0x2dbc9d(0x1146))['textContent']=_0x291a04;const _0x48e5b1=document[_0x2dbc9d(0x2ec)](_0x2dbc9d(0xdc8));_0x48e5b1[_0x2dbc9d(0xc43)]='';const _0x49b92c=Object[_0x2dbc9d(0x127b)](_0x34bc40[_0x2dbc9d(0x13b7)]||{});let _0x2f1a87={'name':'','amount':-0x1};_0x34bc40[_0x2dbc9d(0x110b)]===_0x2dbc9d(0x14e7)&&_0x34bc40[_0x2dbc9d(0x1410)]&&_0x49b92c[_0x2dbc9d(0x9a1)]>0x1&&_0x49b92c[_0x2dbc9d(0xf99)](([_0x588159,_0x4887ff])=>{const _0x6f3665=_0x2dbc9d;_0x4887ff>_0x2f1a87[_0x6f3665(0x257)]&&(_0x2f1a87={'name':_0x588159,'amount':_0x4887ff});}),_0x49b92c[_0x2dbc9d(0x126b)]((_0x2aecdf,_0x27b199)=>_0x27b199[0x1]-_0x2aecdf[0x1]),_0x49b92c[_0x2dbc9d(0xf99)](([_0x35419c,_0x3d26b3])=>{const _0x104121=_0x2dbc9d,_0x272073=document[_0x104121(0x14ae)](_0x104121(0xaa5));_0x272073['className']=_0x104121(0xa54);let _0x1e9fbb='';_0x2f1a87[_0x104121(0xe36)]&&_0x35419c===_0x2f1a87[_0x104121(0xe36)]&&(_0x1e9fbb=_0x104121(0x5e9));const _0x588425=_0x4f967c(_0x4ad852,_0x35419c);_0x272073['innerHTML']=_0x104121(0x14c4)+_0x588425+_0x104121(0xfae)+_0x3d26b3[_0x104121(0x5c3)](0x2)+'\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1e9fbb+_0x104121(0x816),_0x48e5b1[_0x104121(0x998)](_0x272073);}),_0xc0e45b['classList'][_0x2dbc9d(0xe82)]('visible');}document[_0x475790(0x2ec)](_0x475790(0x787))[_0x475790(0xf79)](_0x475790(0x1177),()=>{const _0x36e8a5=_0x475790;document['getElementById'](_0x36e8a5(0x12ea))[_0x36e8a5(0xff6)][_0x36e8a5(0x1424)](_0x36e8a5(0x149d));}),window[_0x475790(0xdf2)]=_0x1b1fff;function _0x3ff437(){const _0x14de6f=_0x475790,_0x371f32=document[_0x14de6f(0x2ec)](_0x14de6f(0xfa6));document[_0x14de6f(0x2ec)](_0x14de6f(0xbd3))[_0x14de6f(0x11a4)]='';const _0x299002=document[_0x14de6f(0x2ec)](_0x14de6f(0x446));_0x299002[_0x14de6f(0xc43)]='',_0x2acf1e(),_0x2acf1e(),_0x371f32[_0x14de6f(0xff6)][_0x14de6f(0xe82)](_0x14de6f(0x149d));}function _0x2acf1e(){const _0x29e998=_0x475790,_0x417c81=document[_0x29e998(0x2ec)]('poll-options-container'),_0xb79bad=document[_0x29e998(0x14ae)](_0x29e998(0xaa5));_0xb79bad[_0x29e998(0xdd1)]=_0x29e998(0x7a9),_0xb79bad[_0x29e998(0xc43)]=_0x29e998(0x151d),_0xb79bad[_0x29e998(0x765)]('.remove-option-btn')[_0x29e998(0xf79)](_0x29e998(0x1177),()=>{const _0x40389e=_0x29e998;_0x417c81[_0x40389e(0x1492)][_0x40389e(0x9a1)]>0x2?_0xb79bad[_0x40389e(0x1424)]():alert('投票至少需要2个选项。');}),_0x417c81['appendChild'](_0xb79bad);}async function _0x2ffdcb(){const _0x4c01ed=_0x475790;if(!_0x28f30a['activeChatId'])return;const _0x203762=document[_0x4c01ed(0x2ec)]('poll-question-input')[_0x4c01ed(0x11a4)]['trim']();if(!_0x203762){alert(_0x4c01ed(0x43a));return;}const _0x1a9b26=Array[_0x4c01ed(0x13d1)](document['querySelectorAll'](_0x4c01ed(0x74a)))[_0x4c01ed(0x11c6)](_0x56c824=>_0x56c824[_0x4c01ed(0x11a4)][_0x4c01ed(0x97e)]())[_0x4c01ed(0xebc)](_0x203e96=>_0x203e96);if(_0x1a9b26['length']<0x2){alert(_0x4c01ed(0xa3d));return;}const _0x4cd515=_0x28f30a[_0x4c01ed(0x6ce)][_0x28f30a['activeChatId']],_0x48387c=_0x4cd515[_0x4c01ed(0x1423)]?_0x4cd515[_0x4c01ed(0x362)][_0x4c01ed(0xa28)]||'我':'我',_0xf1af77={'role':'user','senderName':_0x48387c,'type':_0x4c01ed(0xc2c),'timestamp':Date[_0x4c01ed(0x487)](),'question':_0x203762,'options':_0x1a9b26,'votes':{},'isClosed':![]};_0x4cd515[_0x4c01ed(0x12c3)]['push'](_0xf1af77),await _0x5b9d83[_0x4c01ed(0x6ce)][_0x4c01ed(0x7c3)](_0x4cd515),_0x4cc03e(_0xf1af77,_0x4cd515),_0x5db8a3(),document[_0x4c01ed(0x2ec)](_0x4c01ed(0xfa6))[_0x4c01ed(0xff6)][_0x4c01ed(0x1424)](_0x4c01ed(0x149d));}async function _0xa54a77(_0x3bd334,_0x39453f){const _0x34709c=_0x475790,_0x5831ff=_0x28f30a['chats'][_0x28f30a[_0x34709c(0x11b9)]],_0x166d01=_0x5831ff[_0x34709c(0x12c3)][_0x34709c(0x412)](_0x3d9c84=>_0x3d9c84[_0x34709c(0x69a)]===_0x3bd334),_0x1638ac=_0x5831ff[_0x34709c(0x1423)]?_0x5831ff[_0x34709c(0x362)][_0x34709c(0xa28)]||'我':'我';if(!_0x166d01||_0x166d01['isClosed']){_0x166d01&&_0x166d01[_0x34709c(0xd1b)]&&_0x53f237(_0x3bd334);return;}const _0x52e9d3=_0x166d01[_0x34709c(0x7ba)][_0x39453f]&&_0x166d01[_0x34709c(0x7ba)][_0x39453f][_0x34709c(0x138a)](_0x1638ac);if(!_0x52e9d3){for(const _0x17dbbf in _0x166d01[_0x34709c(0x7ba)]){const _0xc5059e=_0x166d01['votes'][_0x17dbbf]['indexOf'](_0x1638ac);_0xc5059e>-0x1&&_0x166d01['votes'][_0x17dbbf]['splice'](_0xc5059e,0x1);}!_0x166d01[_0x34709c(0x7ba)][_0x39453f]&&(_0x166d01[_0x34709c(0x7ba)][_0x39453f]=[]),_0x166d01['votes'][_0x39453f][_0x34709c(0x367)](_0x1638ac);}let _0x401691=null;!_0x52e9d3&&(_0x401691=_0x34709c(0x12a1)+_0x1638ac+')\x20刚刚投票给了\x20“'+_0x39453f+_0x34709c(0x63a));if(_0x401691){const _0x329af5={'role':'system','content':_0x401691,'timestamp':Date['now'](),'isHidden':!![]};_0x5831ff[_0x34709c(0x12c3)][_0x34709c(0x367)](_0x329af5);}await _0x5b9d83['chats'][_0x34709c(0x7c3)](_0x5831ff),_0xc55746(_0x28f30a[_0x34709c(0x11b9)]);}async function _0xa95d12(_0x4bfbc7){const _0x2f4209=_0x475790,_0x2cbda8=_0x28f30a[_0x2f4209(0x6ce)][_0x28f30a[_0x2f4209(0x11b9)]],_0x1d300a=_0x2cbda8[_0x2f4209(0x12c3)]['find'](_0x26ffe3=>_0x26ffe3[_0x2f4209(0x69a)]===_0x4bfbc7);if(!_0x1d300a||_0x1d300a[_0x2f4209(0xd1b)])return;const _0x57b12b=await _0x4436ba('结束投票',_0x2f4209(0x6f4));if(_0x57b12b){_0x1d300a[_0x2f4209(0xd1b)]=!![];const _0x1684df=_0x1d300a['options']['map'](_0x3a10fb=>'“'+_0x3a10fb+'”('+(_0x1d300a['votes'][_0x3a10fb]?.[_0x2f4209(0x9a1)]||0x0)+'票)')[_0x2f4209(0xbad)]('，'),_0x2c9e49=_0x2f4209(0x2b1)+_0x1684df+'。]',_0x35edb6={'role':_0x2f4209(0x10a7),'content':_0x2c9e49,'timestamp':Date[_0x2f4209(0x487)](),'isHidden':!![]};_0x2cbda8['history'][_0x2f4209(0x367)](_0x35edb6),await _0x5b9d83[_0x2f4209(0x6ce)]['put'](_0x2cbda8),_0xc55746(_0x28f30a[_0x2f4209(0x11b9)]);}}function _0x53f237(_0x11f8e8){const _0x1d0d5f=_0x475790,_0x1dd562=_0x28f30a[_0x1d0d5f(0x6ce)][_0x28f30a[_0x1d0d5f(0x11b9)]],_0x57caba=_0x1dd562['history'][_0x1d0d5f(0x412)](_0x4c98fd=>_0x4c98fd[_0x1d0d5f(0x69a)]===_0x11f8e8);if(!_0x57caba||!_0x57caba['isClosed'])return;let _0x40fa1f='<p><strong>'+_0x57caba[_0x1d0d5f(0x7f0)]+_0x1d0d5f(0x9dc);Object[_0x1d0d5f(0xf6b)](_0x57caba['votes'])[_0x1d0d5f(0x9a1)]===0x0?_0x40fa1f+='<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>':_0x57caba[_0x1d0d5f(0x793)]['forEach'](_0x34640c=>{const _0x115fa5=_0x1d0d5f,_0x3ca6ce=_0x57caba[_0x115fa5(0x7ba)][_0x34640c]||[],_0x350d81=_0x3ca6ce[_0x115fa5(0x11c6)](_0x40be12=>_0x4f967c(_0x1dd562,_0x40be12))[_0x115fa5(0xbad)]('、\x20');_0x40fa1f+=_0x115fa5(0x61a)+_0x34640c+'\x20('+_0x3ca6ce[_0x115fa5(0x9a1)]+'票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3ca6ce[_0x115fa5(0x9a1)]>0x0?_0x350d81:_0x115fa5(0x941))+_0x115fa5(0xf01);}),_0x34d596(_0x1d0d5f(0xe65),_0x40fa1f);}function _0x27ef70(){const _0x52d97a=_0x475790;if(!_0x28f30a[_0x52d97a(0x11b9)])return;const _0x11182d=_0x28f30a[_0x52d97a(0x6ce)][_0x28f30a['activeChatId']];document['getElementById']('ai-avatar-library-title')[_0x52d97a(0x15f)]='“'+_0x11182d[_0x52d97a(0xe36)]+'”的头像库',_0x3fd980(),document[_0x52d97a(0x2ec)](_0x52d97a(0x145d))[_0x52d97a(0xff6)][_0x52d97a(0xe82)](_0x52d97a(0x149d));}function _0x3fd980(){const _0x58c4f7=_0x475790,_0x586683=document[_0x58c4f7(0x2ec)]('ai-avatar-library-grid');_0x586683['innerHTML']='';const _0x3cf90f=_0x28f30a[_0x58c4f7(0x6ce)][_0x28f30a[_0x58c4f7(0x11b9)]],_0x3d9b46=_0x3cf90f[_0x58c4f7(0x362)][_0x58c4f7(0x78c)]||[];if(_0x3d9b46['length']===0x0){_0x586683[_0x58c4f7(0xc43)]=_0x58c4f7(0xdef);return;}_0x3d9b46[_0x58c4f7(0xf99)]((_0x35133a,_0x3ed6d7)=>{const _0x2d3ade=_0x58c4f7,_0x3bc195=document['createElement'](_0x2d3ade(0xaa5));_0x3bc195[_0x2d3ade(0xdd1)]='sticker-item',_0x3bc195[_0x2d3ade(0x141e)]=_0x35133a[_0x2d3ade(0xe36)],_0x3bc195[_0x2d3ade(0xc43)]=_0x2d3ade(0xe35)+_0x35133a['url']+_0x2d3ade(0x9aa)+_0x35133a['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x49a3d7=document[_0x2d3ade(0x14ae)](_0x2d3ade(0xaa5));_0x49a3d7['className']=_0x2d3ade(0xaaa),_0x49a3d7['innerHTML']='×',_0x49a3d7[_0x2d3ade(0x589)][_0x2d3ade(0x701)]=_0x2d3ade(0x13f7),_0x49a3d7[_0x2d3ade(0x6b6)]=async _0x4c09c8=>{const _0x2b5140=_0x2d3ade;_0x4c09c8[_0x2b5140(0x106c)]();const _0x1db333=await _0x4436ba(_0x2b5140(0x1230),_0x2b5140(0xa1e)+_0x35133a[_0x2b5140(0xe36)]+_0x2b5140(0x77f),{'confirmButtonClass':_0x2b5140(0xd8f)});_0x1db333&&(_0x3cf90f[_0x2b5140(0x362)][_0x2b5140(0x78c)][_0x2b5140(0x510)](_0x3ed6d7,0x1),await _0x5b9d83[_0x2b5140(0x6ce)][_0x2b5140(0x7c3)](_0x3cf90f),_0x3fd980());},_0x3bc195[_0x2d3ade(0x998)](_0x49a3d7),_0x586683[_0x2d3ade(0x998)](_0x3bc195);});}async function _0x58156c(){const _0x59b299=_0x475790,_0x28a68b=await _0x33419a(_0x59b299(0x337),_0x59b299(0xd40));if(!_0x28a68b||!_0x28a68b[_0x59b299(0x97e)]())return;const _0x49e3fa=await _0x33419a('添加头像',_0x59b299(0xfa1),'','url');if(!_0x49e3fa||!_0x49e3fa[_0x59b299(0x97e)]()['startsWith'](_0x59b299(0x2c8))){alert(_0x59b299(0x96d));return;}const _0xd4c310=_0x28f30a[_0x59b299(0x6ce)][_0x28f30a[_0x59b299(0x11b9)]];!_0xd4c310[_0x59b299(0x362)][_0x59b299(0x78c)]&&(_0xd4c310[_0x59b299(0x362)]['aiAvatarLibrary']=[]),_0xd4c310[_0x59b299(0x362)][_0x59b299(0x78c)]['push']({'name':_0x28a68b[_0x59b299(0x97e)](),'url':_0x49e3fa[_0x59b299(0x97e)]()}),await _0x5b9d83[_0x59b299(0x6ce)][_0x59b299(0x7c3)](_0xd4c310),_0x3fd980();}function _0xc9bd7(){const _0x2c8fa5=_0x475790;document[_0x2c8fa5(0x2ec)](_0x2c8fa5(0x145d))[_0x2c8fa5(0xff6)][_0x2c8fa5(0x1424)](_0x2c8fa5(0x149d));}function _0x1659a6(){const _0x39bcef=_0x475790;if(!_0x28f30a[_0x39bcef(0x11b9)])return;const _0x4250df=_0x28f30a[_0x39bcef(0x6ce)][_0x28f30a[_0x39bcef(0x11b9)]];document[_0x39bcef(0x2ec)](_0x39bcef(0xec9))[_0x39bcef(0x15f)]='“'+(_0x4250df[_0x39bcef(0x362)][_0x39bcef(0xa28)]||'我')+_0x39bcef(0xf14),_0x6c0377(),document['getElementById'](_0x39bcef(0x243))[_0x39bcef(0xff6)][_0x39bcef(0xe82)](_0x39bcef(0x149d));}function _0x6c0377(){const _0x592f7f=_0x475790,_0x45e696=document[_0x592f7f(0x2ec)]('my-avatar-library-grid');_0x45e696[_0x592f7f(0xc43)]='';const _0x2b81ed=_0x28f30a[_0x592f7f(0x6ce)][_0x28f30a[_0x592f7f(0x11b9)]],_0x5e6499=_0x2b81ed[_0x592f7f(0x362)][_0x592f7f(0xbd2)]||[];if(_0x5e6499[_0x592f7f(0x9a1)]===0x0){_0x45e696[_0x592f7f(0xc43)]=_0x592f7f(0xdef);return;}_0x5e6499[_0x592f7f(0xf99)]((_0x33b07c,_0x14f220)=>{const _0x2ee85b=_0x592f7f,_0x20ffe4=document[_0x2ee85b(0x14ae)](_0x2ee85b(0xaa5));_0x20ffe4['className']=_0x2ee85b(0x1f9),_0x20ffe4[_0x2ee85b(0x141e)]=_0x33b07c[_0x2ee85b(0xe36)],_0x20ffe4[_0x2ee85b(0xc43)]=_0x2ee85b(0xe35)+_0x33b07c[_0x2ee85b(0x6d1)]+_0x2ee85b(0x9aa)+_0x33b07c[_0x2ee85b(0xe36)]+_0x2ee85b(0xc69);const _0x583a80=document['createElement'](_0x2ee85b(0xaa5));_0x583a80[_0x2ee85b(0xdd1)]=_0x2ee85b(0xaaa),_0x583a80[_0x2ee85b(0xc43)]='×',_0x583a80['style'][_0x2ee85b(0x701)]=_0x2ee85b(0x13f7),_0x583a80[_0x2ee85b(0x6b6)]=async _0x3407fe=>{const _0x3634e7=_0x2ee85b;_0x3407fe['stopPropagation']();const _0x1b46d1=await _0x4436ba(_0x3634e7(0x1230),_0x3634e7(0xfc3)+_0x33b07c[_0x3634e7(0xe36)]+_0x3634e7(0x77f),{'confirmButtonClass':_0x3634e7(0xd8f)});_0x1b46d1&&(_0x2b81ed['settings'][_0x3634e7(0xbd2)][_0x3634e7(0x510)](_0x14f220,0x1),await _0x5b9d83[_0x3634e7(0x6ce)][_0x3634e7(0x7c3)](_0x2b81ed),_0x6c0377());},_0x20ffe4['appendChild'](_0x583a80),_0x45e696[_0x2ee85b(0x998)](_0x20ffe4);});}async function _0x54f0ca(){const _0x2408d7=_0x475790,_0x59e5a7=await _0x33419a('添加头像',_0x2408d7(0xd40));if(!_0x59e5a7||!_0x59e5a7['trim']())return;const _0x587fea=await _0x33419a('添加头像','请输入头像的图片URL','',_0x2408d7(0x6d1));if(!_0x587fea||!_0x587fea[_0x2408d7(0x97e)]()[_0x2408d7(0x741)](_0x2408d7(0x2c8))){alert('请输入有效的图片URL！');return;}const _0x55f01f=_0x28f30a[_0x2408d7(0x6ce)][_0x28f30a[_0x2408d7(0x11b9)]];!_0x55f01f[_0x2408d7(0x362)][_0x2408d7(0xbd2)]&&(_0x55f01f[_0x2408d7(0x362)][_0x2408d7(0xbd2)]=[]),_0x55f01f[_0x2408d7(0x362)][_0x2408d7(0xbd2)][_0x2408d7(0x367)]({'name':_0x59e5a7[_0x2408d7(0x97e)](),'url':_0x587fea[_0x2408d7(0x97e)]()}),await _0x5b9d83[_0x2408d7(0x6ce)][_0x2408d7(0x7c3)](_0x55f01f),_0x6c0377();}async function _0x535a2e(_0x3af6b2){const _0xebff2c=_0x475790,_0x130616=_0x3af6b2[_0xebff2c(0x1104)][_0xebff2c(0x8d6)][0x0];if(!_0x130616)return;const _0x23bcaa=await new Promise(_0x4ac3cf=>{const _0x505463=_0xebff2c,_0x3faff=new FileReader();_0x3faff[_0x505463(0xf2d)]=()=>_0x4ac3cf(_0x3faff[_0x505463(0x42a)]),_0x3faff[_0x505463(0x60e)](_0x130616);}),_0x1492f5=await _0x33419a('命名头像',_0xebff2c(0x80e));if(!_0x1492f5||!_0x1492f5['trim']())return;const _0x5cfa71=_0x28f30a[_0xebff2c(0x6ce)][_0x28f30a[_0xebff2c(0x11b9)]];!_0x5cfa71[_0xebff2c(0x362)][_0xebff2c(0xbd2)]&&(_0x5cfa71[_0xebff2c(0x362)][_0xebff2c(0xbd2)]=[]),_0x5cfa71['settings']['myAvatarLibrary'][_0xebff2c(0x367)]({'name':_0x1492f5[_0xebff2c(0x97e)](),'url':_0x23bcaa}),await _0x5b9d83[_0xebff2c(0x6ce)][_0xebff2c(0x7c3)](_0x5cfa71),_0x6c0377(),_0x3af6b2[_0xebff2c(0x1104)][_0xebff2c(0x11a4)]=null;}async function _0x21fe64(_0x2079a0){const _0x3ba232=_0x475790,_0x3df3fb=_0x28f30a['chats'][_0x28f30a[_0x3ba232(0x11b9)]];if(!_0x3df3fb)return;const _0xaf8a39=_0x2079a0[_0x3ba232(0x97e)]()[_0x3ba232(0xa8a)]('\x0a'),_0xd020e5=[],_0x203322=_0x3ba232(0x359);let _0x5ec658=0x0;for(const _0x3e00bf of _0xaf8a39){const _0x54aabd=_0x3e00bf['trim']();if(!_0x54aabd||_0x54aabd['includes'](_0x3ba232(0x2c8))||_0x54aabd[_0x3ba232(0x138a)]('填入'))continue;let _0x2213f5=null,_0x5335d6=null;const _0x555ee0=_0x54aabd[_0x3ba232(0x49a)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x555ee0)_0x2213f5=_0x555ee0[0x1],_0x5335d6=_0x555ee0[0x2];else{const _0x5bbc19=_0x54aabd[_0x3ba232(0xa8a)](/\s+/);_0x5bbc19['length']>=0x2&&(_0x5335d6=_0x5bbc19[_0x3ba232(0xdba)](),_0x2213f5=_0x5bbc19[_0x3ba232(0xbad)]('\x20'));}_0x2213f5&&_0x5335d6&&_0x5335d6[_0x3ba232(0x138a)]('.')?_0xd020e5[_0x3ba232(0x367)]({'name':_0x2213f5,'url':_0x203322+_0x5335d6}):_0x5ec658++;}if(_0x5ec658>0x0)await _0x34d596('部分导入失败','有\x20'+_0x5ec658+_0x3ba232(0x213));if(_0xd020e5[_0x3ba232(0x9a1)]>0x0){if(!_0x3df3fb[_0x3ba232(0x362)]['myAvatarLibrary'])_0x3df3fb[_0x3ba232(0x362)][_0x3ba232(0xbd2)]=[];_0x3df3fb[_0x3ba232(0x362)]['myAvatarLibrary'][_0x3ba232(0x367)](..._0xd020e5),await _0x5b9d83[_0x3ba232(0x6ce)][_0x3ba232(0x7c3)](_0x3df3fb),_0x6c0377(),await _0x34d596('导入成功',_0x3ba232(0x1460)+_0xd020e5[_0x3ba232(0x9a1)]+_0x3ba232(0x10d4));}else _0x5ec658===0x0&&alert('没有找到可导入的内容。');}function _0x24609b(){const _0x261a31=_0x475790;document[_0x261a31(0x2ec)](_0x261a31(0x243))[_0x261a31(0xff6)][_0x261a31(0x1424)](_0x261a31(0x149d));}function _0x1196a8(){const _0x585c7c=_0x475790;if(!_0x28f30a['activeChatId'])return;const _0x48b6d5=_0x28f30a[_0x585c7c(0x6ce)][_0x28f30a[_0x585c7c(0x11b9)]];document[_0x585c7c(0x2ec)](_0x585c7c(0xd84))['textContent']='“'+_0x48b6d5[_0x585c7c(0xe36)]+_0x585c7c(0xf14),_0x45df45(),document['getElementById'](_0x585c7c(0x1059))[_0x585c7c(0xff6)]['add']('visible');}function _0x45df45(){const _0x1872d8=_0x475790,_0x1e7c92=document['getElementById'](_0x1872d8(0x35a));_0x1e7c92[_0x1872d8(0xc43)]='';const _0x38f6c4=_0x28f30a['chats'][_0x28f30a[_0x1872d8(0x11b9)]],_0x10c76f=_0x38f6c4[_0x1872d8(0x362)][_0x1872d8(0x1235)]||[];if(_0x10c76f[_0x1872d8(0x9a1)]===0x0){_0x1e7c92[_0x1872d8(0xc43)]=_0x1872d8(0xdef);return;}_0x10c76f[_0x1872d8(0xf99)]((_0x19cf0c,_0x510de7)=>{const _0x39268a=_0x1872d8,_0x424f4e=document[_0x39268a(0x14ae)](_0x39268a(0xaa5));_0x424f4e['className']=_0x39268a(0x1f9),_0x424f4e[_0x39268a(0x141e)]=_0x19cf0c[_0x39268a(0xe36)],_0x424f4e[_0x39268a(0xc43)]=_0x39268a(0xe35)+_0x19cf0c['url']+_0x39268a(0x9aa)+_0x19cf0c[_0x39268a(0xe36)]+_0x39268a(0xc69);const _0x5980fb=document[_0x39268a(0x14ae)](_0x39268a(0xaa5));_0x5980fb[_0x39268a(0xdd1)]=_0x39268a(0xaaa),_0x5980fb['innerHTML']='×',_0x5980fb[_0x39268a(0x589)][_0x39268a(0x701)]='block',_0x5980fb['onclick']=async _0xc1f2=>{const _0x518be7=_0x39268a;_0xc1f2[_0x518be7(0x106c)]();const _0x223d2b=await _0x4436ba('删除头像',_0x518be7(0xa1e)+_0x19cf0c[_0x518be7(0xe36)]+_0x518be7(0x77f),{'confirmButtonClass':_0x518be7(0xd8f)});_0x223d2b&&(_0x38f6c4['settings'][_0x518be7(0x1235)]['splice'](_0x510de7,0x1),await _0x5b9d83['chats'][_0x518be7(0x7c3)](_0x38f6c4),_0x45df45());},_0x424f4e[_0x39268a(0x998)](_0x5980fb),_0x1e7c92[_0x39268a(0x998)](_0x424f4e);});}async function _0x5ca9fd(){const _0x3a63e5=_0x475790,_0x12efe6=await _0x33419a('添加头像',_0x3a63e5(0xdf9));if(!_0x12efe6||!_0x12efe6[_0x3a63e5(0x97e)]())return;const _0x494c26=await _0x33419a('添加头像',_0x3a63e5(0xfa1),'','url');if(!_0x494c26||!_0x494c26[_0x3a63e5(0x97e)]()['startsWith'](_0x3a63e5(0x2c8))){alert(_0x3a63e5(0x96d));return;}const _0x136f85=_0x28f30a['chats'][_0x28f30a[_0x3a63e5(0x11b9)]];!_0x136f85[_0x3a63e5(0x362)][_0x3a63e5(0x1235)]&&(_0x136f85[_0x3a63e5(0x362)][_0x3a63e5(0x1235)]=[]),_0x136f85[_0x3a63e5(0x362)][_0x3a63e5(0x1235)][_0x3a63e5(0x367)]({'name':_0x12efe6[_0x3a63e5(0x97e)](),'url':_0x494c26[_0x3a63e5(0x97e)]()}),await _0x5b9d83[_0x3a63e5(0x6ce)][_0x3a63e5(0x7c3)](_0x136f85),_0x45df45();}function _0x3bb8d7(){const _0x46e783=_0x475790;document[_0x46e783(0x2ec)]('group-avatar-library-modal')[_0x46e783(0xff6)][_0x46e783(0x1424)](_0x46e783(0x149d));}async function _0x40b739(_0x458aba){const _0xcf9683=_0x475790,_0x5cd14f=_0xcf9683(0x464),_0x5c1b4e=await _0x33419a(_0xcf9683(0x1229),_0x5cd14f,'',_0xcf9683(0x382));_0x5c1b4e&&_0x5c1b4e[_0xcf9683(0x97e)]()&&await _0x57328f(_0x458aba,_0x5c1b4e);}async function _0x57328f(_0x1c417b,_0x151d3e){const _0x2bc208=_0x475790,_0x265e1a=_0x28f30a[_0x2bc208(0x6ce)][_0x28f30a[_0x2bc208(0x11b9)]];if(!_0x265e1a)return;const _0x5d4328=_0x151d3e[_0x2bc208(0x97e)]()[_0x2bc208(0xa8a)]('\x0a'),_0x451a26=[],_0x2805fd=_0x2bc208(0x359);let _0x2d63c7=0x0;for(const _0x5cd5ed of _0x5d4328){const _0x476642=_0x5cd5ed[_0x2bc208(0x97e)]();if(!_0x476642||_0x476642[_0x2bc208(0x138a)]('http')||_0x476642[_0x2bc208(0x138a)]('填入'))continue;let _0x11d94e=null,_0x186648=null;const _0x19816d=_0x476642[_0x2bc208(0x49a)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x19816d)_0x11d94e=_0x19816d[0x1],_0x186648=_0x19816d[0x2];else{const _0x46ce3d=_0x476642[_0x2bc208(0xa8a)](/\s+/);_0x46ce3d[_0x2bc208(0x9a1)]>=0x2&&(_0x186648=_0x46ce3d[_0x2bc208(0xdba)](),_0x11d94e=_0x46ce3d[_0x2bc208(0xbad)]('\x20'));}_0x11d94e&&_0x186648&&_0x186648['includes']('.')?_0x451a26[_0x2bc208(0x367)]({'name':_0x11d94e,'url':_0x2805fd+_0x186648}):(_0x2d63c7++,console[_0x2bc208(0x664)]('批量导入格式错误，已跳过此行:',_0x476642));}_0x2d63c7>0x0&&await _0x34d596(_0x2bc208(0x1216),'有\x20'+_0x2d63c7+_0x2bc208(0x285));if(_0x451a26[_0x2bc208(0x9a1)]>0x0){if(_0x1c417b==='ai'){if(!_0x265e1a[_0x2bc208(0x362)][_0x2bc208(0x78c)])_0x265e1a[_0x2bc208(0x362)][_0x2bc208(0x78c)]=[];_0x265e1a[_0x2bc208(0x362)]['aiAvatarLibrary'][_0x2bc208(0x367)](..._0x451a26),await _0x5b9d83['chats'][_0x2bc208(0x7c3)](_0x265e1a),_0x3fd980();}else{if(_0x1c417b===_0x2bc208(0x1356)){if(!_0x265e1a[_0x2bc208(0x362)][_0x2bc208(0x1235)])_0x265e1a[_0x2bc208(0x362)][_0x2bc208(0x1235)]=[];_0x265e1a['settings'][_0x2bc208(0x1235)]['push'](..._0x451a26),await _0x5b9d83[_0x2bc208(0x6ce)]['put'](_0x265e1a),_0x45df45();}}await _0x34d596('导入成功',_0x2bc208(0x1460)+_0x451a26[_0x2bc208(0x9a1)]+_0x2bc208(0x10d4));}else _0x2d63c7===0x0&&alert('没有找到可导入的内容。请检查您粘贴的格式是否正确。');}async function _0x34a111(){const _0x5b17ee=_0x475790,_0x624eb=await _0x33419a(_0x5b17ee(0x337),_0x5b17ee(0xdf9));if(!_0x624eb||!_0x624eb[_0x5b17ee(0x97e)]())return;const _0x5ada5d=await _0x33419a(_0x5b17ee(0x337),'请输入头像的图片URL','','url');if(!_0x5ada5d||!_0x5ada5d[_0x5b17ee(0x97e)]()['startsWith'](_0x5b17ee(0x2c8))){alert(_0x5b17ee(0x96d));return;}const _0x1f1cb6=_0x28f30a['chats'][_0x28f30a[_0x5b17ee(0x11b9)]];!_0x1f1cb6['settings'][_0x5b17ee(0x1235)]&&(_0x1f1cb6[_0x5b17ee(0x362)][_0x5b17ee(0x1235)]=[]),_0x1f1cb6['settings'][_0x5b17ee(0x1235)][_0x5b17ee(0x367)]({'name':_0x624eb[_0x5b17ee(0x97e)](),'url':_0x5ada5d[_0x5b17ee(0x97e)]()}),await _0x5b9d83[_0x5b17ee(0x6ce)][_0x5b17ee(0x7c3)](_0x1f1cb6),_0x45df45();}function _0x57a567(_0x46a3a8){return new Promise(_0x5d86a7=>{const _0x120205=_0x1937,_0x75785b=document[_0x120205(0x2ec)](_0x120205(0x35d)),_0x4839b0=document[_0x120205(0x2ec)](_0x120205(0x51f)),_0x588916=document[_0x120205(0x2ec)](_0x120205(0x904)),_0x55446f=document[_0x120205(0x2ec)](_0x120205(0x4e2));_0x4839b0[_0x120205(0x15f)]=_0x46a3a8['isPinned']?_0x120205(0xb14):_0x120205(0x1573);const _0x4059e4=_0x4839b0[_0x120205(0x303)](!![]);_0x4839b0[_0x120205(0x1092)][_0x120205(0x6ab)](_0x4059e4,_0x4839b0),_0x4059e4['onclick']=()=>{const _0x4fa8a9=_0x120205;_0x75785b['classList'][_0x4fa8a9(0x1424)](_0x4fa8a9(0x149d)),_0x5d86a7('pin');};const _0x240554=_0x588916[_0x120205(0x303)](!![]);_0x588916['parentNode'][_0x120205(0x6ab)](_0x240554,_0x588916),_0x240554[_0x120205(0x6b6)]=()=>{const _0xa84fcf=_0x120205;_0x75785b['classList'][_0xa84fcf(0x1424)](_0xa84fcf(0x149d)),_0x5d86a7(_0xa84fcf(0x54b));};const _0x2ed27a=_0x55446f[_0x120205(0x303)](!![]);_0x55446f[_0x120205(0x1092)][_0x120205(0x6ab)](_0x2ed27a,_0x55446f),_0x2ed27a[_0x120205(0x6b6)]=()=>{const _0x375980=_0x120205;_0x75785b[_0x375980(0xff6)][_0x375980(0x1424)](_0x375980(0x149d)),_0x5d86a7(null);},_0x75785b[_0x120205(0xff6)][_0x120205(0xe82)](_0x120205(0x149d));});}function _0x543c4d(){const _0x23225d=_0x475790,_0x4237ee=document[_0x23225d(0x2ec)]('character-phone-screen'),_0x482d06=_0x28f30a[_0x23225d(0x1062)][_0x23225d(0x152d)];_0x482d06?_0x4237ee['style'][_0x23225d(0xe00)]=_0x23225d(0xeb9)+_0x482d06+')':_0x4237ee[_0x23225d(0x589)][_0x23225d(0xe00)]=_0x23225d(0x862);}function _0x5d626d(){const _0x4cc95b=_0x475790;if(!_0x28f30a[_0x4cc95b(0x1062)][_0x4cc95b(0x978)])return;for(const _0xa15e93 in _0x28f30a[_0x4cc95b(0x1062)][_0x4cc95b(0x978)]){const _0x29fed1=document[_0x4cc95b(0x2ec)](_0x4cc95b(0xcf3)+_0xa15e93);_0x29fed1&&(_0x29fed1[_0x4cc95b(0xce4)]=_0x28f30a[_0x4cc95b(0x1062)][_0x4cc95b(0x978)][_0xa15e93]);}}function _0x56ab60(){const _0x1d4dbf=_0x475790,_0x4fdb12=document[_0x1d4dbf(0x2ec)](_0x1d4dbf(0x1295));if(!_0x4fdb12)return;_0x4fdb12[_0x1d4dbf(0xc43)]='';const _0x359dc0={'qq':'QQ','album':'相册','browser':_0x1d4dbf(0xb77),'taobao':'淘宝','memo':'备忘录','diary':'日记','amap':_0x1d4dbf(0x149e),'usage':_0x1d4dbf(0x1567),'music':_0x1d4dbf(0x710),'ephone':_0x1d4dbf(0x1f6)};for(const _0xee0ac in _0x28f30a[_0x1d4dbf(0x1062)][_0x1d4dbf(0x978)]){const _0x2af732=_0x28f30a[_0x1d4dbf(0x1062)][_0x1d4dbf(0x978)][_0xee0ac],_0x28c62e=_0x359dc0[_0xee0ac]||_0x1d4dbf(0x330),_0xce569d=document[_0x1d4dbf(0x14ae)](_0x1d4dbf(0xaa5));_0xce569d[_0x1d4dbf(0xdd1)]='icon-setting-item',_0xce569d[_0x1d4dbf(0xe93)][_0x1d4dbf(0x1019)]=_0xee0ac,_0xce569d['innerHTML']=_0x1d4dbf(0x1c3)+_0x2af732+'\x22\x20alt=\x22'+_0x28c62e+_0x1d4dbf(0x147e),_0x4fdb12['appendChild'](_0xce569d);}}function _0x3b4945(){const _0x2dceb8=_0x475790;if(!_0x28f30a[_0x2dceb8(0x1062)][_0x2dceb8(0x12e8)])return;for(const _0x54fa59 in _0x28f30a[_0x2dceb8(0x1062)][_0x2dceb8(0x12e8)]){const _0x35884b=document[_0x2dceb8(0x2ec)](_0x2dceb8(0x310)+_0x54fa59);_0x35884b&&(_0x35884b[_0x2dceb8(0xce4)]=_0x28f30a[_0x2dceb8(0x1062)][_0x2dceb8(0x12e8)][_0x54fa59]);}}function _0x5172c5(){const _0xf6eebe=_0x475790,_0x5ac101=document[_0xf6eebe(0x2ec)](_0xf6eebe(0x2ac));if(!_0x5ac101)return;_0x5ac101[_0xf6eebe(0xc43)]='';const _0x40714a={'qq':'QQ','world-book':_0xf6eebe(0x13b0),'wallpaper':_0xf6eebe(0x14d6),'renderer':_0xf6eebe(0x32d),'api-settings':_0xf6eebe(0xe14),'font':'字体','char-phone':'Cphone','douban':_0xf6eebe(0x2fc),'preset':'预设','tutorial':'教程','werewolf':_0xf6eebe(0x461),'x':'X'};for(const _0x427933 in _0x28f30a[_0xf6eebe(0x1062)]['appIcons']){const _0x4bf9c5=_0x28f30a[_0xf6eebe(0x1062)]['appIcons'][_0x427933],_0x229b83=_0x40714a[_0x427933]||'Cphone',_0x4333eb=document[_0xf6eebe(0x14ae)]('div');_0x4333eb[_0xf6eebe(0xdd1)]=_0xf6eebe(0x1431),_0x4333eb[_0xf6eebe(0xe93)][_0xf6eebe(0x1019)]=_0x427933,_0x4333eb[_0xf6eebe(0xc43)]=_0xf6eebe(0x1c3)+_0x4bf9c5+_0xf6eebe(0x9a3)+_0x229b83+_0xf6eebe(0x147e),_0x5ac101[_0xf6eebe(0x998)](_0x4333eb);}}function _0x32e580(_0x5b7bd2){const _0xbf4716=_0x475790;if(!_0x28f30a[_0xbf4716(0x11b9)])return;const _0x28bd12=_0x28f30a[_0xbf4716(0x6ce)][_0x28f30a['activeChatId']];if(!_0x28bd12||!_0x28bd12[_0xbf4716(0x12c3)])return;const _0xc72661=_0x28bd12[_0xbf4716(0x12c3)][_0xbf4716(0x412)](_0x3eef24=>_0x3eef24['timestamp']===_0x5b7bd2);if(!_0xc72661||_0xc72661[_0xbf4716(0xb4b)]!==_0xbf4716(0x9c6)){console['error'](_0xbf4716(0x51b),_0x5b7bd2);return;}document['getElementById'](_0xbf4716(0x4fc))[_0xbf4716(0x15f)]=_0xc72661['source_name']||'文章详情';const _0x57b8c2=document[_0xbf4716(0x2ec)](_0xbf4716(0xf30));_0x57b8c2['innerHTML']=_0xbf4716(0x1359)+(_0xc72661['title']||_0xbf4716(0x10b6))+'</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20'+(_0xc72661['source_name']||'未知')+_0xbf4716(0xacb)+(_0xc72661[_0xbf4716(0x1047)]||_0xbf4716(0x55e))['replace'](/\n/g,_0xbf4716(0x1509))+_0xbf4716(0xade),_0x17ec27(_0xbf4716(0x70f));}function _0x4a77e2(){const _0x3f2de2=_0x475790;_0x17ec27(_0x3f2de2(0x120a));}function _0x4a77e2(){const _0x4fb96e=_0x475790;_0x17ec27(_0x4fb96e(0x120a));}function _0x3a262d(){const _0xb2a61b=_0x475790;if(!_0x28f30a['activeChatId'])return;document['getElementById'](_0xb2a61b(0xfde))['value']='',document[_0xb2a61b(0x2ec)]('link-description-input')['value']='',document[_0xb2a61b(0x2ec)](_0xb2a61b(0xc86))[_0xb2a61b(0x11a4)]='',document[_0xb2a61b(0x2ec)]('link-content-input')[_0xb2a61b(0x11a4)]='',document['getElementById']('share-link-modal')[_0xb2a61b(0xff6)][_0xb2a61b(0xe82)]('visible');}async function _0x40257c(){const _0x10a258=_0x475790;if(!_0x28f30a[_0x10a258(0x11b9)])return;const _0x4f6c9f=document[_0x10a258(0x2ec)]('link-title-input')[_0x10a258(0x11a4)]['trim']();if(!_0x4f6c9f){alert(_0x10a258(0x7b2));return;}const _0x2fe6da=document['getElementById'](_0x10a258(0xf27))[_0x10a258(0x11a4)][_0x10a258(0x97e)](),_0x207f78=document[_0x10a258(0x2ec)](_0x10a258(0xc86))[_0x10a258(0x11a4)]['trim'](),_0x32683a=document['getElementById'](_0x10a258(0x859))[_0x10a258(0x11a4)][_0x10a258(0x97e)](),_0x5176e9=_0x28f30a[_0x10a258(0x6ce)][_0x28f30a[_0x10a258(0x11b9)]],_0x3d80a1={'role':_0x10a258(0xcc9),'type':_0x10a258(0x9c6),'timestamp':Date[_0x10a258(0x487)](),'title':_0x4f6c9f,'description':_0x2fe6da,'source_name':_0x207f78,'content':_0x32683a,'thumbnail_url':null};_0x5176e9['history'][_0x10a258(0x367)](_0x3d80a1),await _0x5b9d83[_0x10a258(0x6ce)][_0x10a258(0x7c3)](_0x5176e9),_0x4cc03e(_0x3d80a1,_0x5176e9),_0x5db8a3(),document[_0x10a258(0x2ec)](_0x10a258(0x14e3))[_0x10a258(0xff6)][_0x10a258(0x1424)](_0x10a258(0x149d));}function _0x5b423c(_0x35cb2e,_0x324fa6){const _0x3b1a31=_0x475790;if(!_0x324fa6||!_0x324fa6['id'])return[];const _0x1992f3=_0x324fa6['groupId'],_0x1dafb5=_0x324fa6['id'];return _0x35cb2e[_0x3b1a31(0xebc)](_0x5af7c5=>{const _0x21f062=_0x3b1a31;if(_0x5af7c5['authorId']===_0x21f062(0xcc9)){if(_0x5af7c5[_0x21f062(0x884)]&&_0x5af7c5[_0x21f062(0x884)][_0x21f062(0x9a1)]>0x0)return _0x1992f3&&_0x5af7c5['visibleGroupIds']['includes'](_0x1992f3);return!![];}if(String(_0x5af7c5[_0x21f062(0xe87)])['startsWith']('npc_')){if(Array[_0x21f062(0x624)](_0x5af7c5['visibleTo']))return _0x5af7c5['visibleTo'][_0x21f062(0x138a)](_0x1dafb5);return![];}const _0x5d4c5d=_0x28f30a['chats'][_0x5af7c5['authorId']];if(!_0x5d4c5d)return![];const _0x2c6527=_0x5d4c5d[_0x21f062(0x1542)],_0x33effb=_0x2c6527&&_0x1992f3&&_0x2c6527===_0x1992f3,_0x29e482=!_0x2c6527&&!_0x1992f3;return _0x33effb||_0x29e482;});}function _0x472780(_0x579221){const _0x248fdb=_0x475790,_0x1dec1f=document[_0x248fdb(0x2ec)]('phone-screen'),_0x432b5b=document[_0x248fdb(0x2ec)]('theme-toggle-switch'),_0x3c878a=_0x579221===_0x248fdb(0xa4d);_0x1dec1f[_0x248fdb(0xff6)][_0x248fdb(0x14c8)](_0x248fdb(0x152c),_0x3c878a),_0x432b5b&&(_0x432b5b['checked']=_0x3c878a),localStorage[_0x248fdb(0x1048)](_0x248fdb(0x823),_0x579221);}function _0x3470f6(){const _0x4b7b6a=_0x475790,_0x146622=document[_0x4b7b6a(0x2ec)]('theme-toggle-switch'),_0x172282=_0x146622[_0x4b7b6a(0x13b8)]?'dark':_0x4b7b6a(0x883);_0x472780(_0x172282);}function _0x32dd45(){const _0x27274c=_0x475790;if(!_0x28f30a[_0x27274c(0x11b9)])return;_0x3ace17(),_0x17ec27(_0x27274c(0x14dc));}function _0x3ace17(){const _0x42294e=_0x475790,_0x55f961=document[_0x42294e(0x2ec)](_0x42294e(0xc36)),_0x5e4b41=_0x28f30a['chats'][_0x28f30a['activeChatId']];_0x55f961[_0x42294e(0xc43)]='';let _0x2f2581=[];_0x5e4b41['isGroup']?_0x5e4b41[_0x42294e(0x10f2)]['forEach'](_0x4bbe63=>{const _0x4f5133=_0x42294e,_0x5ac0b7=_0x28f30a[_0x4f5133(0x6ce)][_0x4bbe63['id']];if(_0x5ac0b7&&_0x5ac0b7['longTermMemory']){const _0x274a2e=_0x5ac0b7['longTermMemory'][_0x4f5133(0x11c6)](_0x9809b7=>({..._0x9809b7,'authorName':_0x4bbe63[_0x4f5133(0x8a8)],'authorChatId':_0x4bbe63['id']}));_0x2f2581[_0x4f5133(0x367)](..._0x274a2e);}}):_0x5e4b41['longTermMemory']&&(_0x2f2581=_0x5e4b41[_0x42294e(0x153f)]['map'](_0x1fc864=>({..._0x1fc864,'authorName':_0x5e4b41[_0x42294e(0xe36)],'authorChatId':_0x5e4b41['id']})));if(_0x2f2581['length']===0x0){_0x55f961['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>';return;}_0x2f2581[_0x42294e(0x126b)]((_0x266324,_0x4e93d3)=>_0x4e93d3['timestamp']-_0x266324['timestamp']),_0x2f2581[_0x42294e(0xf99)]((_0x2723e4,_0xe3f2f0)=>{const _0x54f7b8=_0x42294e,_0x85fc89=document['createElement'](_0x54f7b8(0xaa5));_0x85fc89[_0x54f7b8(0xdd1)]=_0x54f7b8(0x1566),_0x85fc89[_0x54f7b8(0x589)][_0x54f7b8(0x119b)]=_0x54f7b8(0x44a),_0x85fc89[_0x54f7b8(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20'+_0x2723e4[_0x54f7b8(0xa5d)]+_0x54f7b8(0xbaa)+_0x2723e4[_0x54f7b8(0x1047)][_0x54f7b8(0x13ed)](/\n/g,_0x54f7b8(0xfd7))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22'+_0x2723e4[_0x54f7b8(0xba0)]+_0x54f7b8(0xff1)+_0x2723e4[_0x54f7b8(0x69a)]+_0x54f7b8(0xbe5)+_0x2723e4['authorChatId']+_0x54f7b8(0xff1)+_0x2723e4[_0x54f7b8(0x69a)]+'\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x55f961[_0x54f7b8(0x998)](_0x85fc89);});}async function _0x26eba6(){const _0x4370d7=_0x475790,_0x4836e2=_0x28f30a[_0x4370d7(0x6ce)][_0x28f30a[_0x4370d7(0x11b9)]];if(!_0x4836e2)return;let _0x19c651=_0x4836e2;if(_0x4836e2[_0x4370d7(0x1423)]){const _0x485d38=_0x4836e2[_0x4370d7(0x10f2)]['map'](_0x1d19d9=>({'text':'为“'+_0x1d19d9[_0x4370d7(0x8a8)]+'”添加记忆','value':_0x1d19d9['id']})),_0x171fd1=await _0x3d2f35(_0x4370d7(0xdae),_0x485d38);if(!_0x171fd1)return;_0x19c651=_0x28f30a[_0x4370d7(0x6ce)][_0x171fd1];if(!_0x19c651){alert(_0x4370d7(0x156e));return;}}const _0x5958b0=await _0x33419a('为“'+_0x19c651[_0x4370d7(0xe36)]+_0x4370d7(0xb82),'请输入要添加的记忆要点：','',_0x4370d7(0x382));if(_0x5958b0&&_0x5958b0[_0x4370d7(0x97e)]()){if(!_0x19c651['longTermMemory'])_0x19c651[_0x4370d7(0x153f)]=[];_0x19c651[_0x4370d7(0x153f)]['push']({'content':_0x5958b0['trim'](),'timestamp':Date['now'](),'source':_0x4370d7(0x9ba)}),await _0x5b9d83['chats'][_0x4370d7(0x7c3)](_0x19c651),_0x3ace17();}}async function _0x5d3a06(_0x4aacc5,_0x4129f7){const _0x570843=_0x475790,_0x59063d=_0x28f30a[_0x570843(0x6ce)][_0x4aacc5];if(!_0x59063d||!_0x59063d[_0x570843(0x153f)])return;const _0x2795b9=_0x59063d['longTermMemory'][_0x570843(0x535)](_0x47ee73=>_0x47ee73[_0x570843(0x69a)]===_0x4129f7);if(_0x2795b9===-0x1)return;const _0x5cdc3b=_0x59063d['longTermMemory'][_0x2795b9],_0x24f358=await _0x33419a('编辑记忆','请修改记忆要点：',_0x5cdc3b[_0x570843(0x1047)],_0x570843(0x382));_0x24f358&&_0x24f358[_0x570843(0x97e)]()&&(_0x5cdc3b[_0x570843(0x1047)]=_0x24f358[_0x570843(0x97e)](),await _0x5b9d83[_0x570843(0x6ce)][_0x570843(0x7c3)](_0x59063d),_0x3ace17());}async function _0x251305(_0x453e1e,_0x1556fc){const _0x4edf88=_0x475790,_0x45a830=await _0x4436ba('确认删除',_0x4edf88(0x1470),{'confirmButtonClass':_0x4edf88(0xd8f)});if(_0x45a830){const _0x3e690e=_0x28f30a['chats'][_0x453e1e];if(!_0x3e690e||!_0x3e690e['longTermMemory'])return;_0x3e690e[_0x4edf88(0x153f)]=_0x3e690e[_0x4edf88(0x153f)][_0x4edf88(0xebc)](_0x13cb4a=>_0x13cb4a[_0x4edf88(0x69a)]!==_0x1556fc),await _0x5b9d83[_0x4edf88(0x6ce)][_0x4edf88(0x7c3)](_0x3e690e),_0x3ace17();}}async function _0x3e17ce(){const _0x588e50=_0x475790,_0x5d7344=await _0x4436ba(_0x588e50(0xc1c),'这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？');_0x5d7344&&await _0x590a3d(_0x28f30a[_0x588e50(0x11b9)],!![]);}async function _0xdddaeb(_0x36fac5){const _0x3845fe=_0x475790,_0x2f62d0=_0x28f30a['chats'][_0x36fac5];if(!_0x2f62d0||!_0x2f62d0[_0x3845fe(0x362)][_0x3845fe(0x129c)])return;const _0x3084c2=_0x2f62d0[_0x3845fe(0x109f)]||0x0,_0xf16e66=_0x2f62d0[_0x3845fe(0x12c3)][_0x3845fe(0xebc)](_0x4d80e9=>_0x4d80e9[_0x3845fe(0x69a)]>_0x3084c2&&!_0x4d80e9['isHidden']);_0xf16e66[_0x3845fe(0x9a1)]>=_0x2f62d0[_0x3845fe(0x362)][_0x3845fe(0x424)]&&(console['log'](_0x3845fe(0x191)+_0xf16e66[_0x3845fe(0x9a1)]+'/'+_0x2f62d0[_0x3845fe(0x362)]['autoMemoryInterval']+_0x3845fe(0x1395)),await _0x590a3d(_0x36fac5));}async function _0x59f21b(_0x31528b,_0xe6a905){const _0x516034=_0x475790,_0x3d8a8a=_0x28f30a[_0x516034(0x6ce)][_0x31528b];if(!_0x3d8a8a||!_0xe6a905)throw new Error(_0x516034(0x272));const _0x1423bc=_0x28f30a[_0x516034(0x1506)][_0x516034(0x19a)]||'用户';let _0x146686,_0x13ee90=_0x3d8a8a;const _0x53907b=new Date()['toLocaleDateString'](_0x516034(0x1054),{'year':'numeric','month':_0x516034(0x625),'day':'numeric'});if(_0x3d8a8a['isGroup']){let _0x3b6fd9=null;_0x20bfc1[_0x516034(0x2bb)]&&(_0x3b6fd9=_0x3d8a8a[_0x516034(0x10f2)][_0x516034(0x412)](_0x3d7a98=>_0x3d7a98[_0x516034(0x66c)]===_0x20bfc1[_0x516034(0x2bb)]));!_0x3b6fd9&&(_0x3b6fd9=_0x3d8a8a[_0x516034(0x10f2)]['find'](_0x321273=>_0x321273['id']!==_0x516034(0xcc9)&&_0x20bfc1['participants']['some'](_0x1c0307=>_0x1c0307['id']===_0x321273['id'])));!_0x3b6fd9&&(_0x3b6fd9=_0x3d8a8a['members'][_0x516034(0x412)](_0x17f2cb=>_0x17f2cb['id']!==_0x516034(0xcc9)));if(!_0x3b6fd9)throw new Error(_0x516034(0x14cd));const _0x391f4c=_0x28f30a[_0x516034(0x6ce)][_0x3b6fd9['id']];if(!_0x391f4c)throw new Error(_0x516034(0x8cb)+_0x3b6fd9[_0x516034(0x8a8)]+_0x516034(0x13f5));const _0x58537b=_0x3d8a8a[_0x516034(0x362)][_0x516034(0x1528)]||_0x516034(0x1541);_0x146686='\x0a#\x20你的任务\x0a你就是角色“'+_0x3b6fd9['originalName']+_0x516034(0xcd6)+_0x1423bc+_0x516034(0x9ce)+_0x53907b+_0x516034(0x633)+_0x53907b+_0x516034(0x47d)+_0x391f4c[_0x516034(0x362)]['aiPersona']+_0x516034(0xabc)+_0x58537b+_0x516034(0x47f)+_0xe6a905+'\x0a\x0a现在，请以“'+_0x3b6fd9['originalName']+_0x516034(0xab8),_0x13ee90=_0x391f4c;}else _0x146686=_0x516034(0x838)+_0x3d8a8a[_0x516034(0x66c)]+_0x516034(0x676)+_0x1423bc+'”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x53907b+_0x516034(0x776)+_0x53907b+_0x516034(0xd7b)+_0x3d8a8a[_0x516034(0x362)][_0x516034(0x67c)]+_0x516034(0xabc)+_0x3d8a8a[_0x516034(0x362)][_0x516034(0x1528)]+_0x516034(0xac0)+_0xe6a905+'\x0a\x0a现在，请以“'+_0x3d8a8a[_0x516034(0x66c)]+_0x516034(0xab8);try{const _0x36a104=_0x28f30a[_0x516034(0x1537)][_0x516034(0xcf0)]&&_0x28f30a[_0x516034(0x1537)][_0x516034(0xeae)]&&_0x28f30a[_0x516034(0x1537)]['secondaryModel'],{proxyUrl:_0x1312a3,apiKey:_0x3d6bb7,model:_0x3f4f98}=_0x36a104?{'proxyUrl':_0x28f30a['apiConfig']['secondaryProxyUrl'],'apiKey':_0x28f30a[_0x516034(0x1537)][_0x516034(0xeae)],'model':_0x28f30a[_0x516034(0x1537)][_0x516034(0xf3f)]}:_0x28f30a[_0x516034(0x1537)];if(!_0x1312a3||!_0x3d6bb7||!_0x3f4f98)throw new Error(_0x516034(0xb1b));let _0x3937c4=_0x1312a3['includes'](_0x516034(0xe9c)),_0x496bdb=_0x4fff3d(_0x3f4f98,_0x3d6bb7,_0x146686,[{'role':_0x516034(0xcc9),'content':_0x516034(0x12f5)}]);const _0x4352b3=_0x3937c4?await fetch(_0x496bdb[_0x516034(0x6d1)],_0x496bdb[_0x516034(0x1418)]):await fetch(_0x1312a3+_0x516034(0x1427),{'method':'POST','headers':{'Content-Type':_0x516034(0x1446),'Authorization':_0x516034(0xe83)+_0x3d6bb7},'body':JSON[_0x516034(0xe4d)]({'model':_0x3f4f98,'messages':[{'role':_0x516034(0x10a7),'content':_0x146686},{'role':'user','content':'请开始总结。'}],'temperature':0.1})});if(!_0x4352b3['ok']){const _0x477af0=await _0x4352b3[_0x516034(0x12a2)]()[_0x516034(0xd6b)](()=>({'error':{'message':_0x4352b3[_0x516034(0x1066)]}}));throw new Error(_0x516034(0x1515)+_0x4352b3[_0x516034(0x2a3)]+'\x20-\x20'+_0x477af0[_0x516034(0x1518)][_0x516034(0x13bc)]);}const _0x49bd2e=await _0x4352b3[_0x516034(0x12a2)]();let _0x34c8d3=_0x3937c4?getGeminiResponseText(_0x49bd2e):_0x49bd2e['choices'][0x0]['message']['content'];_0x34c8d3=_0x34c8d3[_0x516034(0x13ed)](/^```json\s*/,'')[_0x516034(0x13ed)](/```$/,'')[_0x516034(0x97e)]();const _0xbbc104=JSON['parse'](_0x34c8d3);if(_0xbbc104[_0x516034(0x413)]&&_0xbbc104['summary'][_0x516034(0x97e)]()){const _0x367770={'content':'(在那次'+(_0x3d8a8a[_0x516034(0x1423)]?'群聊':'')+_0x516034(0xeb1)+_0xbbc104[_0x516034(0x413)][_0x516034(0x97e)]()+')','timestamp':Date[_0x516034(0x487)](),'source':_0x3d8a8a[_0x516034(0x1423)]?_0x516034(0x14a8):_0x516034(0x14b2)};if(!_0x13ee90[_0x516034(0x153f)])_0x13ee90[_0x516034(0x153f)]=[];return _0x13ee90[_0x516034(0x153f)][_0x516034(0x367)](_0x367770),await _0x5b9d83['chats'][_0x516034(0x7c3)](_0x13ee90),console[_0x516034(0x415)]('通话记录已成功总结并存入角色“'+_0x13ee90['name']+_0x516034(0xa33)),!![];}else throw new Error(_0x516034(0x866));}catch(_0x16a5af){console[_0x516034(0x1518)](_0x516034(0xa85),_0x16a5af);throw _0x16a5af;}}function _0x5cd13a(_0x4afdb4){const _0x11de70=_0x475790,_0x493524=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么',_0x11de70(0xf0e),'哪个','一些','这个','那个','还有']),_0x3e2aca=_0x4afdb4[_0x11de70(0x49a)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x192d72=new Map();let _0x2cb692=0x0;_0x3e2aca[_0x11de70(0xf99)](_0x3ad52d=>{const _0xb7ae0a=_0x11de70;if(_0x3ad52d[_0xb7ae0a(0x9a1)]>0x1&&!_0x493524[_0xb7ae0a(0xbf1)](_0x3ad52d)){const _0xe49f5=(_0x192d72[_0xb7ae0a(0x6b5)](_0x3ad52d)||0x0)+0x1;_0x192d72[_0xb7ae0a(0xa63)](_0x3ad52d,_0xe49f5);if(_0xe49f5>_0x2cb692)_0x2cb692=_0xe49f5;}});const _0x39b988=[],_0x45e479=[],_0x2366e1=_0x2cb692*0.9,_0x3fe496=_0x2cb692*0.6;_0x192d72[_0x11de70(0xf99)]((_0x330d84,_0x341b85)=>{const _0x4435cd=_0x11de70;if(_0x330d84>=_0x2366e1)_0x39b988[_0x4435cd(0x367)](_0x341b85);else _0x330d84>=_0x3fe496&&_0x45e479[_0x4435cd(0x367)](_0x341b85);});const _0xb2f397=new Set(_0x39b988),_0x4e1c39=_0x45e479[_0x11de70(0xebc)](_0x6de2c9=>!_0xb2f397[_0x11de70(0xbf1)](_0x6de2c9))['slice'](0x0,0x5);return{'coreKeywords':_0x39b988[_0x11de70(0x225)](0x0,0x3),'situationalKeywords':_0x4e1c39};}function _0x5bdf0b(_0x177610,_0x5ce536,_0x2c621e){const _0x25640a=_0x475790;let _0x2d6fed;_0x2c621e===_0x25640a(0xe03)?_0x2d6fed=Date['now']()-_0x5ce536*0x3c*0x3c*0x3e8:_0x2d6fed=Date[_0x25640a(0x487)]()-_0x5ce536*0x18*0x3c*0x3c*0x3e8;const _0x1c225=_0x177610[_0x25640a(0x12c3)][_0x25640a(0xebc)](_0x4148b=>_0x4148b[_0x25640a(0x69a)]>_0x2d6fed&&!_0x4148b[_0x25640a(0x1162)]);if(_0x1c225[_0x25640a(0x9a1)]<0x3)return'';const _0x4f6bc7=_0x1c225[_0x25640a(0x11c6)](_0x3b529a=>{const _0x3c9152=_0x25640a;if(typeof _0x3b529a[_0x3c9152(0x1047)]===_0x3c9152(0x863))return _0x3b529a[_0x3c9152(0x1047)];if(_0x3b529a[_0x3c9152(0xb4b)]===_0x3c9152(0x8bc))return _0x3b529a[_0x3c9152(0x1047)];if(_0x3b529a[_0x3c9152(0xb4b)]===_0x3c9152(0x6fb))return(_0x3b529a['dialogue']||'')+'\x20'+(_0x3b529a[_0x3c9152(0x9cc)]||'');return'';})[_0x25640a(0xbad)]('\x20'),_0x1b3aab=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0x3bac86=_0x4f6bc7[_0x25640a(0x49a)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x53ae69=new Map();_0x3bac86['forEach'](_0x17d536=>{const _0x395159=_0x25640a;_0x17d536['length']>0x1&&!_0x1b3aab[_0x395159(0xbf1)](_0x17d536)&&_0x53ae69['set'](_0x17d536,(_0x53ae69[_0x395159(0x6b5)](_0x17d536)||0x0)+0x1);});const _0x3f74a5=[..._0x53ae69[_0x25640a(0x127b)]()][_0x25640a(0x126b)]((_0x4c99b6,_0x4dba66)=>_0x4dba66[0x1]-_0x4c99b6[0x1])['map'](_0xca2b1c=>_0xca2b1c[0x0]);if(_0x3f74a5[_0x25640a(0x9a1)]===0x0)return'';let _0x10071e;return _0x2c621e===_0x25640a(0xe03)?_0x10071e='最近'+_0x5ce536+_0x25640a(0xc2e):_0x5ce536===0x1?_0x10071e='本日核心议题':_0x10071e='最近'+_0x5ce536+_0x25640a(0x3a7),'\x0a-\x20**'+_0x10071e+_0x25640a(0xeef)+_0x3f74a5[_0x25640a(0x225)](0x0,0x3)['join']('、\x20')+'**。';}function _0x28644a(_0x169c28){const _0x537c99=_0x475790;if(!_0x169c28||typeof _0x169c28!=='string')return null;const _0x5a0970=_0x169c28['replace'](/^```json\s*/,'')[_0x537c99(0x13ed)](/```$/,'')[_0x537c99(0x97e)](),_0x1e8458=_0x5a0970[_0x537c99(0x49a)](/{[\s\S]*}/);if(_0x1e8458)try{const _0x4e086b=JSON[_0x537c99(0xd91)](_0x1e8458[0x0]);return console[_0x537c99(0x415)](_0x537c99(0x2fe)),_0x4e086b;}catch(_0x2eb498){console[_0x537c99(0x664)](_0x537c99(0x473));}const _0x31ae9a=_0x5a0970[_0x537c99(0x49a)](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0x31ae9a&&_0x31ae9a[0x1])return console['log']('容错解析：策略2成功\x20(提取了summary字段内容)'),{'summary':_0x31ae9a[0x1][_0x537c99(0x13ed)](/\\"/g,'\x22')};if(_0x5a0970)return console[_0x537c99(0x415)](_0x537c99(0xbbe)),{'summary':_0x5a0970};return null;}async function _0x1bd93e(_0x17dce8){const _0x2269a4=_0x475790;let _0x111c68=_0x28f30a[_0x2269a4(0x6ce)][_0x17dce8];if(!_0x111c68)return;let _0x3c9bca=_0x111c68;if(_0x111c68[_0x2269a4(0x1423)]){const _0x1a001f=_0x111c68[_0x2269a4(0x10f2)][_0x2269a4(0x11c6)](_0xe79ed3=>{const _0x4f2ce4=_0x2269a4,_0x105061=_0x28f30a[_0x4f2ce4(0x6ce)][_0xe79ed3['id']];if(_0x105061&&_0x105061['longTermMemory']&&_0x105061[_0x4f2ce4(0x153f)]['length']>=0x2)return{'text':_0x4f2ce4(0x1fb)+_0xe79ed3[_0x4f2ce4(0x8a8)]+'”的记忆\x20('+_0x105061[_0x4f2ce4(0x153f)][_0x4f2ce4(0x9a1)]+'条)','value':_0xe79ed3['id']};return null;})[_0x2269a4(0xebc)](Boolean);if(_0x1a001f[_0x2269a4(0x9a1)]===0x0){alert(_0x2269a4(0x11b5));return;}const _0x23d2d8=await _0x3d2f35(_0x2269a4(0xaa7),_0x1a001f);if(!_0x23d2d8)return;_0x3c9bca=_0x28f30a[_0x2269a4(0x6ce)][_0x23d2d8];}if(!_0x3c9bca['longTermMemory']||_0x3c9bca[_0x2269a4(0x153f)]['length']<0x2){alert('“'+_0x3c9bca[_0x2269a4(0xe36)]+_0x2269a4(0xfda));return;}const _0x39965f=_0x3c9bca[_0x2269a4(0x153f)]['length'],_0x7151a0=await _0x3d2f35(_0x2269a4(0x1ca),[{'text':'全部记忆\x20('+_0x39965f+'条)','value':_0x2269a4(0xa92)},{'text':_0x2269a4(0x4d3),'value':'20'},{'text':_0x2269a4(0x1291),'value':'50'},{'text':_0x2269a4(0x122c),'value':_0x2269a4(0x136a)},{'text':_0x2269a4(0x1106),'value':'custom'}][_0x2269a4(0xebc)](_0x51145d=>_0x51145d[_0x2269a4(0x11a4)]===_0x2269a4(0xa92)||_0x51145d[_0x2269a4(0x11a4)]===_0x2269a4(0x1334)||parseInt(_0x51145d[_0x2269a4(0x11a4)])<_0x39965f));if(_0x7151a0===null)return;let _0x519496,_0xb91397=_0x39965f;if(_0x7151a0===_0x2269a4(0xa92))_0x519496=[..._0x3c9bca[_0x2269a4(0x153f)]];else{if(_0x7151a0===_0x2269a4(0x1334)){const _0x5339f1=await _0x33419a(_0x2269a4(0xa7c),'请输入要精炼的最近记忆条数\x20(最多\x20'+_0x39965f+_0x2269a4(0x796));if(_0x5339f1===null)return;const _0x37f3b5=parseInt(_0x5339f1);if(isNaN(_0x37f3b5)||_0x37f3b5<0x2||_0x37f3b5>_0x39965f){alert('请输入一个\x202\x20到\x20'+_0x39965f+_0x2269a4(0xf13));return;}_0xb91397=_0x37f3b5,_0x519496=_0x3c9bca['longTermMemory']['slice'](-_0xb91397);}else _0xb91397=parseInt(_0x7151a0),_0xb91397>=_0x39965f?(_0x519496=[..._0x3c9bca[_0x2269a4(0x153f)]],_0xb91397=_0x39965f):_0x519496=_0x3c9bca['longTermMemory'][_0x2269a4(0x225)](-_0xb91397);}const _0x39dd3a=await _0x33419a(_0x2269a4(0x9a9),'请输入精炼后核心记忆的大致字数：',_0x2269a4(0x12f4));if(_0x39dd3a===null)return;const _0x36fd04=parseInt(_0x39dd3a);if(isNaN(_0x36fd04)||_0x36fd04<0x14){alert(_0x2269a4(0xb5a));return;}const _0x112300=await _0x4436ba(_0x2269a4(0x13fc),_0x2269a4(0x56c)+_0xb91397+'\x20条长期记忆发送给AI，总结成大约\x20'+_0x36fd04+'\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？',{'confirmButtonClass':'btn-danger','confirmText':_0x2269a4(0x117a)});if(!_0x112300)return;const _0x5c1364=_0x519496[_0x2269a4(0x11c6)](_0x394bc2=>'-\x20'+_0x394bc2[_0x2269a4(0x1047)])[_0x2269a4(0xbad)]('\x0a'),_0x5145ea=_0x28f30a['qzoneSettings'][_0x2269a4(0x19a)]||'用户',_0x58850c=new Date()[_0x2269a4(0xc14)](_0x2269a4(0x1054),{'year':'numeric','month':'long','day':_0x2269a4(0x705)}),_0x3fa9fa=_0x2269a4(0x838)+_0x3c9bca[_0x2269a4(0x66c)]+_0x2269a4(0xff0)+_0x5145ea+_0x2269a4(0xc22)+_0x58850c+_0x2269a4(0x620)+_0x58850c+_0x2269a4(0x14ac)+_0x36fd04+_0x2269a4(0x7eb)+_0x3c9bca[_0x2269a4(0x362)][_0x2269a4(0x67c)]+_0x2269a4(0xabc)+_0x3c9bca[_0x2269a4(0x362)]['myPersona']+'\x0a\x0a#\x20待整合的记忆要点列表\x0a'+_0x5c1364+_0x2269a4(0xcd7)+_0x3c9bca[_0x2269a4(0x66c)]+_0x2269a4(0x5a7);await _0x34d596(_0x2269a4(0x13e4),_0x2269a4(0x89b));try{const _0x5d90e2=_0x28f30a[_0x2269a4(0x1537)]['secondaryProxyUrl']&&_0x28f30a['apiConfig']['secondaryApiKey']&&_0x28f30a[_0x2269a4(0x1537)][_0x2269a4(0xf3f)],{proxyUrl:_0x48efa0,apiKey:_0x1c51b7,model:_0x4ee9a8}=_0x5d90e2?{'proxyUrl':_0x28f30a[_0x2269a4(0x1537)][_0x2269a4(0xcf0)],'apiKey':_0x28f30a['apiConfig'][_0x2269a4(0xeae)],'model':_0x28f30a['apiConfig']['secondaryModel']}:_0x28f30a[_0x2269a4(0x1537)];if(!_0x48efa0||!_0x1c51b7||!_0x4ee9a8)throw new Error(_0x2269a4(0xe24));let _0x3ac76b=_0x48efa0[_0x2269a4(0x138a)](_0x2269a4(0xe9c)),_0x5aebda=_0x4fff3d(_0x4ee9a8,_0x1c51b7,_0x3fa9fa,[{'role':_0x2269a4(0xcc9),'content':_0x2269a4(0x7dc)}]);const _0x1359fc=_0x3ac76b?await fetch(_0x5aebda[_0x2269a4(0x6d1)],_0x5aebda[_0x2269a4(0x1418)]):await fetch(_0x48efa0+'/v1/chat/completions',{'method':_0x2269a4(0x655),'headers':{'Content-Type':_0x2269a4(0x1446),'Authorization':_0x2269a4(0xe83)+_0x1c51b7},'body':JSON[_0x2269a4(0xe4d)]({'model':_0x4ee9a8,'messages':[{'role':_0x2269a4(0x10a7),'content':_0x3fa9fa},{'role':_0x2269a4(0xcc9),'content':_0x2269a4(0x7dc)}],'temperature':0.2})});if(!_0x1359fc['ok'])throw new Error(_0x2269a4(0xe6d)+_0x1359fc['statusText']);const _0x3952ca=await _0x1359fc[_0x2269a4(0x12a2)]();let _0x41ccfc=_0x3ac76b?getGeminiResponseText(_0x3952ca):_0x3952ca[_0x2269a4(0x8cd)][0x0]['message'][_0x2269a4(0x1047)];const _0x463a94=_0x28644a(_0x41ccfc);if(_0x463a94&&_0x463a94['summary']&&typeof _0x463a94[_0x2269a4(0x413)]===_0x2269a4(0x863)&&_0x463a94[_0x2269a4(0x413)][_0x2269a4(0x97e)]()){const _0x54d8aa=await _0x4436ba(_0x2269a4(0x119a),_0x2269a4(0x2a1)+_0xb91397+_0x2269a4(0x830)+_0x463a94[_0x2269a4(0x413)][_0x2269a4(0x97e)]()+'</div><br>是否用这条新记忆替换掉这些旧记忆？',{'confirmText':'确认替换','cancelText':_0x2269a4(0xb18),'confirmButtonClass':_0x2269a4(0xd8f)});if(_0x54d8aa){const _0x40e1dc={'content':_0x463a94[_0x2269a4(0x413)][_0x2269a4(0x97e)](),'timestamp':Date[_0x2269a4(0x487)](),'source':_0x2269a4(0xa99)},_0x39c465=_0x39965f-_0xb91397,_0x3b7345=_0x39c465>0x0?_0x3c9bca['longTermMemory'][_0x2269a4(0x225)](0x0,_0x39c465):[];_0x3c9bca[_0x2269a4(0x153f)]=[..._0x3b7345,_0x40e1dc],_0x3c9bca[_0x2269a4(0x109f)]=Date[_0x2269a4(0x487)](),await _0x5b9d83[_0x2269a4(0x6ce)][_0x2269a4(0x7c3)](_0x3c9bca),document[_0x2269a4(0x2ec)](_0x2269a4(0x14dc))[_0x2269a4(0xff6)]['contains'](_0x2269a4(0xd43))&&_0x3ace17(),await _0x34d596(_0x2269a4(0x5a0),_0x2269a4(0xcb6)+_0xb91397+_0x2269a4(0x95e));}else await _0x34d596(_0x2269a4(0x201),_0x2269a4(0x259));}else throw new Error(_0x2269a4(0x866));}catch(_0x5779ba){console['error']('精炼长期记忆时出错:',_0x5779ba),await _0x34d596(_0x2269a4(0xa47),'操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20'+_0x5779ba[_0x2269a4(0x13bc)]);}}async function _0x590a3d(_0x1b08d8,_0x4b30a0=![]){const _0x2578c5=_0x475790,_0x5d152a=_0x28f30a[_0x2578c5(0x6ce)][_0x1b08d8];if(!_0x5d152a)return;const _0x4e1703=_0x5d152a['lastMemorySummaryTimestamp']||0x0,_0x12605c=_0x4b30a0?_0x5d152a[_0x2578c5(0x12c3)][_0x2578c5(0xebc)](_0x3b5949=>!_0x3b5949['isHidden']||_0x3b5949[_0x2578c5(0x9be)]===_0x2578c5(0x10a7)&&_0x3b5949[_0x2578c5(0x1047)][_0x2578c5(0x138a)](_0x2578c5(0x5ee)))[_0x2578c5(0x225)](-(_0x5d152a[_0x2578c5(0x362)]['autoMemoryInterval']||0x14)):_0x5d152a[_0x2578c5(0x12c3)]['filter'](_0x399133=>_0x399133[_0x2578c5(0x69a)]>_0x4e1703&&(!_0x399133[_0x2578c5(0x1162)]||_0x399133[_0x2578c5(0x9be)]===_0x2578c5(0x10a7)&&_0x399133['content'][_0x2578c5(0x138a)]('内心独白')));if(_0x12605c[_0x2578c5(0x9a1)]<0x5){if(_0x4b30a0)alert('最近的消息太少，无法进行有意义的总结。');return;}const _0x55c84b=_0x28f30a[_0x2578c5(0x1506)]['nickname']||'用户',_0x5f0b8f=_0x12605c['map'](_0x2f6744=>{const _0x2eaaca=_0x2578c5;if(_0x2f6744[_0x2eaaca(0x1162)]&&_0x2f6744[_0x2eaaca(0x9be)]===_0x2eaaca(0x10a7)&&_0x2f6744[_0x2eaaca(0x1047)]['includes']('内心独白'))return _0x2f6744['content'];let _0x3e2b9c;_0x2f6744[_0x2eaaca(0x9be)]===_0x2eaaca(0xcc9)?_0x3e2b9c=_0x55c84b:_0x3e2b9c=_0x2f6744[_0x2eaaca(0x1361)]||_0x5d152a[_0x2eaaca(0x66c)];let _0x3ce047='';if(_0x2f6744[_0x2eaaca(0xb4b)]===_0x2eaaca(0x6fb)){if(_0x2f6744[_0x2eaaca(0x1047)])_0x3ce047=_0x2f6744[_0x2eaaca(0x1047)];else{const _0x83efa6=_0x2f6744[_0x2eaaca(0x6c4)]?'「'+_0x2f6744['dialogue']+'」':'',_0x505b0c=_0x2f6744[_0x2eaaca(0x9cc)]?'('+_0x2f6744[_0x2eaaca(0x9cc)]+')':'';_0x3ce047=(_0x83efa6+'\x20'+_0x505b0c)['trim']();}}else _0x3ce047=String(_0x2f6744[_0x2eaaca(0x1047)]);return _0x3e2b9c+':\x20'+_0x3ce047;})['join']('\x0a');let _0x588eb8;if(_0x5d152a[_0x2578c5(0x1423)])_0x588eb8=_0x2578c5(0x881)+_0x55c84b+_0x2578c5(0xf94)+_0x5f0b8f+_0x2578c5(0x1159)+_0x5d152a[_0x2578c5(0x10f2)][_0x2578c5(0x11c6)](_0x231f4b=>'-\x20'+_0x231f4b[_0x2578c5(0x8a8)]+_0x2578c5(0xc17)+_0x231f4b[_0x2578c5(0x66c)]+')')[_0x2578c5(0xbad)]('\x0a')+'\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。';else{const _0x4368d2=new Date()[_0x2578c5(0xc14)](_0x2578c5(0x1054),{'year':_0x2578c5(0x705),'month':_0x2578c5(0x625),'day':'numeric'});_0x588eb8='\x0a#\x20你的任务\x0a你就是角色“'+_0x5d152a[_0x2578c5(0x66c)]+_0x2578c5(0x676)+_0x55c84b+_0x2578c5(0x77d)+_0x4368d2+_0x2578c5(0x6ea)+_0x4368d2+_0x2578c5(0x6b9)+new Date(Date['now']()+0x5265c00)[_0x2578c5(0xc14)](_0x2578c5(0x1054),{'month':_0x2578c5(0x625),'day':'numeric'})+'见面”）。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过100个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a'+_0x5d152a['settings'][_0x2578c5(0x67c)]+_0x2578c5(0x75c)+_0x5d152a[_0x2578c5(0x362)][_0x2578c5(0x1528)]+_0x2578c5(0xb3b)+_0x5f0b8f+'\x0a\x0a现在，请以“'+_0x5d152a[_0x2578c5(0x66c)]+_0x2578c5(0xab8);}try{const _0x5e210a=_0x28f30a[_0x2578c5(0x1537)]['secondaryProxyUrl']&&_0x28f30a[_0x2578c5(0x1537)][_0x2578c5(0xeae)]&&_0x28f30a[_0x2578c5(0x1537)][_0x2578c5(0xf3f)],{proxyUrl:_0x288143,apiKey:_0xf7dfbc,model:_0x1a8ac5}=_0x5e210a?{'proxyUrl':_0x28f30a[_0x2578c5(0x1537)][_0x2578c5(0xcf0)],'apiKey':_0x28f30a[_0x2578c5(0x1537)]['secondaryApiKey'],'model':_0x28f30a[_0x2578c5(0x1537)][_0x2578c5(0xf3f)]}:_0x28f30a[_0x2578c5(0x1537)];if(!_0x288143||!_0xf7dfbc||!_0x1a8ac5)throw new Error(_0x2578c5(0x5ff));let _0x18cd9d=_0x288143[_0x2578c5(0x138a)](_0x2578c5(0xe9c)),_0x44de66=_0x4fff3d(_0x1a8ac5,_0xf7dfbc,_0x588eb8,[{'role':_0x2578c5(0xcc9),'content':_0x2578c5(0x12f5)}]);const _0x57540c=_0x18cd9d?await fetch(_0x44de66[_0x2578c5(0x6d1)],_0x44de66[_0x2578c5(0x1418)]):await fetch(_0x288143+_0x2578c5(0x1427),{'method':_0x2578c5(0x655),'headers':{'Content-Type':_0x2578c5(0x1446),'Authorization':_0x2578c5(0xe83)+_0xf7dfbc},'body':JSON['stringify']({'model':_0x1a8ac5,'messages':[{'role':'system','content':_0x588eb8},{'role':_0x2578c5(0xcc9),'content':_0x2578c5(0x12f5)}],'temperature':0.2})});if(!_0x57540c['ok'])throw new Error(_0x2578c5(0xe6d)+_0x57540c[_0x2578c5(0x1066)]);const _0x235c2a=await _0x57540c[_0x2578c5(0x12a2)]();let _0x386d60=_0x18cd9d?getGeminiResponseText(_0x235c2a):_0x235c2a[_0x2578c5(0x8cd)][0x0][_0x2578c5(0x13bc)][_0x2578c5(0x1047)];_0x386d60=_0x386d60[_0x2578c5(0x13ed)](/^```json\s*/,'')['replace'](/```$/,'')[_0x2578c5(0x97e)]();const _0x431ae9=JSON[_0x2578c5(0xd91)](_0x386d60);if(_0x5d152a[_0x2578c5(0x1423)]){if(_0x431ae9[_0x2578c5(0xe3b)]&&typeof _0x431ae9[_0x2578c5(0xe3b)]===_0x2578c5(0x10c0)){let _0x471006=0x0;for(const _0x396875 in _0x431ae9[_0x2578c5(0xe3b)]){const _0x44f1b9=_0x431ae9[_0x2578c5(0xe3b)][_0x396875];if(_0x44f1b9&&_0x44f1b9['trim']()){const _0xa4d903=Object['values'](_0x28f30a[_0x2578c5(0x6ce)])[_0x2578c5(0x412)](_0x4cfb00=>_0x4cfb00[_0x2578c5(0x66c)]===_0x396875);if(_0xa4d903){const _0xf76c8={'content':_0x44f1b9[_0x2578c5(0x97e)](),'timestamp':Date[_0x2578c5(0x487)](),'source':_0x2578c5(0xf0a)+_0x5d152a[_0x2578c5(0xe36)]};if(!_0xa4d903[_0x2578c5(0x153f)])_0xa4d903[_0x2578c5(0x153f)]=[];_0xa4d903['longTermMemory'][_0x2578c5(0x367)](_0xf76c8),await _0x5b9d83[_0x2578c5(0x6ce)][_0x2578c5(0x7c3)](_0xa4d903),_0x471006++;}}}if(_0x471006>0x0)console[_0x2578c5(0x415)](_0x2578c5(0x449)+_0x471006+_0x2578c5(0x1480));else throw new Error('AI返回了空的或格式不正确的总结内容。');}else throw new Error(_0x2578c5(0x1499));}else{if(_0x431ae9['summary']&&_0x431ae9[_0x2578c5(0x413)][_0x2578c5(0x97e)]()){const _0x224f09={'content':_0x431ae9[_0x2578c5(0x413)][_0x2578c5(0x97e)](),'timestamp':Date[_0x2578c5(0x487)](),'source':_0x2578c5(0x1214)};_0x5d152a[_0x2578c5(0x153f)]['push'](_0x224f09),await _0x5b9d83['chats'][_0x2578c5(0x7c3)](_0x5d152a),console[_0x2578c5(0x415)](_0x2578c5(0xbae));}else throw new Error(_0x2578c5(0x866));}_0x5d152a['lastMemorySummaryTimestamp']=_0x12605c[_0x2578c5(0x225)](-0x1)[0x0][_0x2578c5(0x69a)],await _0x5b9d83[_0x2578c5(0x6ce)][_0x2578c5(0x7c3)](_0x5d152a),document[_0x2578c5(0x2ec)](_0x2578c5(0x14dc))[_0x2578c5(0xff6)][_0x2578c5(0xe9a)]('active')&&_0x3ace17();}catch(_0x518091){console[_0x2578c5(0x1518)](_0x2578c5(0xf90),_0x518091),await _0x34d596('总结失败',_0x2578c5(0x470)+_0x518091[_0x2578c5(0x13bc)]);}}function _0x4a6fb9(){const _0x4de29d=_0x475790;if(!_0x38f399)return;const _0x1119b8=_0x28f30a['chats'][_0x28f30a[_0x4de29d(0x11b9)]],_0x31d792=_0x1119b8[_0x4de29d(0x12c3)][_0x4de29d(0x412)](_0x41cd3c=>_0x41cd3c[_0x4de29d(0x69a)]===_0x38f399&&!_0x41cd3c[_0x4de29d(0x1162)]);if(!_0x31d792)return;let _0x33f50b;_0x31d792[_0x4de29d(0x9be)]===_0x4de29d(0xcc9)?_0x33f50b=_0x1119b8['isGroup']?_0x1119b8[_0x4de29d(0x362)][_0x4de29d(0xa28)]||'我':'我':_0x1119b8[_0x4de29d(0x1423)]?_0x33f50b=_0x4f967c(_0x1119b8,_0x31d792[_0x4de29d(0x1361)]):_0x33f50b=_0x1119b8['name'];const _0x20ca19=String(_0x31d792[_0x4de29d(0x1047)]||'');let _0x20cb6c='';if(typeof _0x31d792['content']==='string'&&_0x41abd3[_0x4de29d(0x1e0)](_0x31d792['content']))_0x20cb6c=_0x4de29d(0x258);else{if(_0x31d792['type']===_0x4de29d(0x11c7)||_0x31d792[_0x4de29d(0xb4b)]===_0x4de29d(0x7f7))_0x20cb6c=_0x4de29d(0xf8c);else _0x31d792[_0x4de29d(0xb4b)]===_0x4de29d(0x8bc)?_0x20cb6c=_0x4de29d(0xdb7):_0x20cb6c=_0x20ca19[_0x4de29d(0xa6b)](0x0,0x32)+(_0x20ca19['length']>0x32?'...':'');}_0x2e3d99={'timestamp':_0x31d792[_0x4de29d(0x69a)],'senderName':_0x33f50b,'content':_0x20ca19};const _0x122f46=document[_0x4de29d(0x2ec)](_0x4de29d(0x122f));_0x122f46['querySelector'](_0x4de29d(0x12a4))[_0x4de29d(0x15f)]='回复\x20'+_0x2e3d99[_0x4de29d(0x1361)]+':',_0x122f46['querySelector'](_0x4de29d(0xc48))['textContent']=_0x20cb6c,_0x122f46[_0x4de29d(0x589)]['display']='block',_0x3d2470(),document[_0x4de29d(0x2ec)]('chat-input')[_0x4de29d(0x52b)]();}function _0x1c45dd(){const _0x24aace=_0x475790;_0x2e3d99=null,document[_0x24aace(0x2ec)](_0x24aace(0x122f))[_0x24aace(0x589)]['display']=_0x24aace(0x5b1);}let _0x5db9cb=null;function _0x1c5e62(_0x138c8d){const _0x4fa0bf=_0x475790;_0x5db9cb=_0x138c8d;const _0x35af10=_0x28f30a['chats'][_0x28f30a[_0x4fa0bf(0x11b9)]],_0x3a779b=_0x35af10[_0x4fa0bf(0x12c3)][_0x4fa0bf(0x412)](_0xc20f1c=>_0xc20f1c[_0x4fa0bf(0x69a)]===_0x138c8d);_0x3a779b&&(document['getElementById'](_0x4fa0bf(0xe42))[_0x4fa0bf(0x15f)]=_0x3a779b['senderName']),document['getElementById'](_0x4fa0bf(0x1bd))[_0x4fa0bf(0xff6)][_0x4fa0bf(0xe82)](_0x4fa0bf(0x149d));}function _0x4eb421(){const _0x1055aa=_0x475790;document[_0x1055aa(0x2ec)](_0x1055aa(0x1bd))[_0x1055aa(0xff6)][_0x1055aa(0x1424)](_0x1055aa(0x149d)),_0x5db9cb=null;}async function _0x2c10a4(_0x2ec80d){const _0x1a32fd=_0x475790;if(!_0x5db9cb)return;const _0x28caaa=_0x5db9cb,_0x4cfbfa=_0x28f30a[_0x1a32fd(0x6ce)][_0x28f30a[_0x1a32fd(0x11b9)]],_0x2e5a01=_0x4cfbfa['history'][_0x1a32fd(0x535)](_0xb90d8e=>_0xb90d8e[_0x1a32fd(0x69a)]===_0x28caaa);if(_0x2e5a01===-0x1)return;const _0x8c00d4=_0x4cfbfa[_0x1a32fd(0x12c3)][_0x2e5a01];_0x8c00d4[_0x1a32fd(0x2a3)]=_0x2ec80d;let _0x181c41;if(_0x2ec80d===_0x1a32fd(0x757)){const _0x4ccc4b={'role':_0x1a32fd(0xcc9),'type':_0x1a32fd(0x277),'isRefund':!![],'amount':_0x8c00d4[_0x1a32fd(0x257)],'note':'已拒收对方转账','timestamp':Date[_0x1a32fd(0x487)]()};_0x4cfbfa[_0x1a32fd(0x12c3)][_0x1a32fd(0x367)](_0x4ccc4b),_0x181c41=_0x1a32fd(0x14b0)+_0x8c00d4[_0x1a32fd(0x1361)]+'”的转账。]';}else _0x181c41=_0x1a32fd(0xc3d)+_0x8c00d4['senderName']+_0x1a32fd(0x215);const _0x390b78={'role':_0x1a32fd(0x10a7),'content':_0x181c41,'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x4cfbfa[_0x1a32fd(0x12c3)]['push'](_0x390b78),await _0x5b9d83['chats'][_0x1a32fd(0x7c3)](_0x4cfbfa),_0x4eb421(),_0xc55746(_0x28f30a['activeChatId']),_0x5db8a3();}async function _0xe4e999(){const _0x1d8d5a=_0x475790;_0x17ec27(_0x1d8d5a(0x77e));const _0x3a291d=document[_0x1d8d5a(0x2ec)](_0x1d8d5a(0x54e)),_0x466bc1=document[_0x1d8d5a(0x2ec)](_0x1d8d5a(0xcbc));_0x3a291d[_0x1d8d5a(0xc43)]='',_0x466bc1[_0x1d8d5a(0x15f)]='所有通话记录';const _0x4de73c=await _0x5b9d83[_0x1d8d5a(0x924)][_0x1d8d5a(0x106d)](_0x1d8d5a(0x69a))['reverse']()[_0x1d8d5a(0x14b5)]();if(_0x4de73c['length']===0x0){_0x3a291d[_0x1d8d5a(0xc43)]=_0x1d8d5a(0xbab);return;}_0x4de73c[_0x1d8d5a(0xf99)](_0x5a5340=>{const _0x3d9078=_0x1d8d5a,_0x123b05=_0x5b97f9(_0x5a5340);_0x131542(_0x123b05,async()=>{const _0x3d0c99=_0x1937,_0x189757=await _0x33419a('自定义通话名称',_0x3d0c99(0xd76),_0x5a5340[_0x3d0c99(0x13eb)]||'');if(_0x189757===null)return;await _0x5b9d83[_0x3d0c99(0x924)][_0x3d0c99(0x130a)](_0x5a5340['id'],{'customName':_0x189757[_0x3d0c99(0x97e)]()}),await _0xe4e999(),await _0x34d596('成功','通话名称已更新！');}),_0x3a291d[_0x3d9078(0x998)](_0x123b05);});}function _0x5b97f9(_0x5386a4){const _0x473e4f=_0x475790,_0x3ed291=document[_0x473e4f(0x14ae)](_0x473e4f(0xaa5));_0x3ed291['className']=_0x473e4f(0x4b5),_0x3ed291[_0x473e4f(0xe93)][_0x473e4f(0x13e8)]=_0x5386a4['id'];const _0x4d9e7e=_0x28f30a['chats'][_0x5386a4[_0x473e4f(0xdd0)]],_0x7d0881=_0x4d9e7e?_0x4d9e7e[_0x473e4f(0xe36)]:_0x473e4f(0x8aa),_0x28a2af=new Date(_0x5386a4[_0x473e4f(0x69a)]),_0x20d945=_0x28a2af[_0x473e4f(0x4cb)]()+'-'+String(_0x28a2af[_0x473e4f(0xa8f)]()+0x1)[_0x473e4f(0x58e)](0x2,'0')+'-'+String(_0x28a2af[_0x473e4f(0x3c7)]())['padStart'](0x2,'0')+'\x20'+String(_0x28a2af[_0x473e4f(0x8a5)]())[_0x473e4f(0x58e)](0x2,'0')+':'+String(_0x28a2af[_0x473e4f(0xbc9)]())[_0x473e4f(0x58e)](0x2,'0'),_0xcf58ad=Math[_0x473e4f(0x5f8)](_0x5386a4['duration']/0x3c)+'分'+_0x5386a4[_0x473e4f(0x157d)]%0x3c+'秒',_0x4acd1c=_0x5386a4[_0x473e4f(0x73e)][_0x473e4f(0x11c6)](_0x25e331=>_0x473e4f(0x416)+_0x25e331[_0x473e4f(0x516)]+_0x473e4f(0x9a3)+_0x25e331['name']+_0x473e4f(0x57f)+_0x25e331[_0x473e4f(0xe36)]+'\x22>')[_0x473e4f(0xbad)]('');return _0x3ed291[_0x473e4f(0xc43)]=_0x473e4f(0x4a4)+_0x20d945+_0x473e4f(0xe01)+_0xcf58ad+_0x473e4f(0x141b)+(_0x5386a4[_0x473e4f(0x13eb)]?_0x473e4f(0xe2c)+_0x5386a4[_0x473e4f(0x13eb)]+_0x473e4f(0xd21):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>'+_0x4acd1c+_0x473e4f(0x4bf)+_0x7d0881+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3ed291;}async function _0x45f423(_0x586eea){const _0x1f0b02=_0x475790,_0x27b396=await _0x5b9d83[_0x1f0b02(0x924)][_0x1f0b02(0x6b5)](_0x586eea);if(!_0x27b396)return;const _0x5e9da7=document['getElementById']('call-transcript-modal'),_0x3909e9=document['getElementById']('transcript-modal-title'),_0x382d74=document[_0x1f0b02(0x2ec)](_0x1f0b02(0x8a9));_0x3909e9['textContent']=_0x1f0b02(0x9cd)+new Date(_0x27b396[_0x1f0b02(0x69a)])[_0x1f0b02(0xc4c)]()+_0x1f0b02(0x1468)+Math['floor'](_0x27b396[_0x1f0b02(0x157d)]/0x3c)+'分'+_0x27b396[_0x1f0b02(0x157d)]%0x3c+'秒)',_0x382d74[_0x1f0b02(0xc43)]='';const _0x1917cf=document['getElementById'](_0x1f0b02(0xaf9)),_0x571436=document[_0x1f0b02(0x2ec)]('manual-summarize-btn');!_0x27b396[_0x1f0b02(0xdcb)]||_0x27b396[_0x1f0b02(0xdcb)]['length']===0x0?(_0x382d74['innerHTML']=_0x1f0b02(0x65a),_0x571436['style'][_0x1f0b02(0x701)]=_0x1f0b02(0x5b1)):(_0x571436[_0x1f0b02(0x589)]['display']=_0x1f0b02(0x13f7),_0x27b396[_0x1f0b02(0xdcb)][_0x1f0b02(0xf99)](_0x32e144=>{const _0x41e6aa=_0x1f0b02,_0x6aa63e=document['createElement'](_0x41e6aa(0xaa5));_0x6aa63e['className']=_0x41e6aa(0xde7)+_0x32e144[_0x41e6aa(0x9be)],_0x6aa63e[_0x41e6aa(0x15f)]=_0x32e144[_0x41e6aa(0x1047)],_0x382d74[_0x41e6aa(0x998)](_0x6aa63e);}));const _0x56fae5=_0x1917cf[_0x1f0b02(0x303)](!![]);_0x1917cf['parentNode']['replaceChild'](_0x56fae5,_0x1917cf);const _0x3989c6=_0x571436[_0x1f0b02(0x303)](!![]);_0x571436[_0x1f0b02(0x1092)][_0x1f0b02(0x6ab)](_0x3989c6,_0x571436),_0x56fae5[_0x1f0b02(0xf79)]('click',async()=>{const _0x2dfbf8=_0x1f0b02,_0x554095=await _0x4436ba(_0x2dfbf8(0x10d9),'确定要永久删除这条通话记录吗？此操作不可恢复。',{'confirmButtonClass':_0x2dfbf8(0xd8f)});_0x554095&&(_0x5e9da7['classList']['remove'](_0x2dfbf8(0x149d)),await _0x5b9d83['callRecords'][_0x2dfbf8(0x54b)](_0x586eea),await _0xe4e999(),alert('通话记录已删除。'));}),_0x3989c6[_0x1f0b02(0xf79)]('click',async()=>{const _0x52be26=_0x1f0b02,_0x2293f8=await _0x4436ba(_0x52be26(0xc1c),'这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？',{'confirmText':_0x52be26(0x12ba)});if(!_0x2293f8)return;_0x5e9da7[_0x52be26(0xff6)]['remove'](_0x52be26(0x149d));const _0x31c48e=_0x28f30a[_0x52be26(0x6ce)][_0x27b396[_0x52be26(0xdd0)]];if(!_0x31c48e){alert('错误：找不到该通话记录所属的聊天对象。');return;}await _0x34d596('请稍候...',_0x52be26(0x37a));try{const _0x1fe914=_0x27b396[_0x52be26(0xdcb)][_0x52be26(0x11c6)](_0x585aa8=>{const _0x53fd7e=_0x52be26,_0xa10bbd=_0x585aa8[_0x53fd7e(0x9be)]===_0x53fd7e(0xcc9)?_0x31c48e[_0x53fd7e(0x362)][_0x53fd7e(0xa28)]||'我':_0x585aa8['senderName']||_0x31c48e[_0x53fd7e(0xe36)];return _0xa10bbd+':\x20'+_0x585aa8['content'];})[_0x52be26(0xbad)]('\x0a');await _0x59f21b(_0x27b396[_0x52be26(0xdd0)],_0x1fe914),await _0x34d596(_0x52be26(0x90e),_0x52be26(0x418)+_0x31c48e[_0x52be26(0xe36)]+_0x52be26(0xa33));}catch(_0x552f9a){await _0x34d596('总结失败',_0x52be26(0xe6a)+_0x552f9a[_0x52be26(0x13bc)]);}});const _0x2a14bb=document[_0x1f0b02(0x2ec)]('close-transcript-modal-btn'),_0x511e44=_0x2a14bb[_0x1f0b02(0x303)](!![]);_0x2a14bb[_0x1f0b02(0x1092)][_0x1f0b02(0x6ab)](_0x511e44,_0x2a14bb),_0x511e44['addEventListener'](_0x1f0b02(0x1177),()=>{const _0x89e83f=_0x1f0b02;_0x5e9da7[_0x89e83f(0xff6)]['remove'](_0x89e83f(0x149d));}),_0x5e9da7['classList'][_0x1f0b02(0xe82)](_0x1f0b02(0x149d));}async function _0x51d0d8(){const _0x4de350=_0x475790;if(!_0x28f30a[_0x4de350(0x11b9)]||_0x28f30a[_0x4de350(0x6ce)][_0x28f30a[_0x4de350(0x11b9)]]['isGroup'])return;const _0x56ea79=_0x28f30a[_0x4de350(0x6ce)][_0x28f30a[_0x4de350(0x11b9)]],_0x423f06=await _0x33419a(_0x4de350(0xe92),_0x4de350(0xacc),_0x56ea79[_0x4de350(0x2a3)][_0x4de350(0x10ca)]);_0x423f06!==null&&(_0x56ea79[_0x4de350(0x2a3)][_0x4de350(0x10ca)]=_0x423f06[_0x4de350(0x97e)]()||'在线',_0x56ea79['status'][_0x4de350(0x14f9)]=![],_0x56ea79[_0x4de350(0x2a3)][_0x4de350(0x80f)]=Date[_0x4de350(0x487)](),await _0x5b9d83[_0x4de350(0x6ce)][_0x4de350(0x7c3)](_0x56ea79),_0xc55746(_0x28f30a[_0x4de350(0x11b9)]),_0x5db8a3(),await _0x34d596(_0x4de350(0x106f),'“'+_0x56ea79[_0x4de350(0xe36)]+'”的当前状态已更新为：'+_0x56ea79[_0x4de350(0x2a3)][_0x4de350(0x10ca)]));}async function _0x289de8(){const _0x175e15=_0x475790,_0x1c2404=document[_0x175e15(0x2ec)](_0x175e15(0xc24)),_0x82998f=document['getElementById'](_0x175e15(0x14eb));_0x82998f[_0x175e15(0xc43)]='';const _0x2bcc51=Object[_0x175e15(0x74e)](_0x28f30a[_0x175e15(0x6ce)]);_0x2bcc51['forEach'](_0x40a732=>{const _0x264e1d=_0x175e15,_0x14120a=document[_0x264e1d(0x14ae)](_0x264e1d(0xaa5));_0x14120a[_0x264e1d(0xdd1)]=_0x264e1d(0x11c2),_0x14120a[_0x264e1d(0xc43)]=_0x264e1d(0xfa0)+_0x40a732['id']+'\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x40a732[_0x264e1d(0x1423)]?_0x40a732[_0x264e1d(0x362)][_0x264e1d(0x42c)]:_0x40a732[_0x264e1d(0x362)][_0x264e1d(0xe91)]||_0x825cf1)+_0x264e1d(0xe49)+_0x40a732[_0x264e1d(0xe36)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x82998f[_0x264e1d(0x998)](_0x14120a);}),_0x1c2404[_0x175e15(0xff6)][_0x175e15(0xe82)]('visible');}function _0x521d39(_0x2f38da){const _0x1d0268=_0x475790,_0x1465b2=document[_0x1d0268(0x2ec)]('music-player-overlay');if(!_0x1465b2[_0x1d0268(0xff6)]['contains']('visible')){if(_0x2f38da)_0x2f38da();return;}_0x1465b2[_0x1d0268(0xff6)][_0x1d0268(0x1424)](_0x1d0268(0x149d)),setTimeout(()=>{const _0x56bbe8=_0x1d0268;document['getElementById'](_0x56bbe8(0x696))[_0x56bbe8(0xff6)][_0x56bbe8(0x1424)](_0x56bbe8(0x149d));if(_0x2f38da)_0x2f38da();},0x190);}function _0x59e6cd(_0x505de6){const _0xe5d1ef=_0x475790;if(!_0x505de6)return[];const _0x283b30=String(_0x505de6)[_0xe5d1ef(0xa8a)](/\r\n?|\n/),_0x38cb58=[],_0x178412=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0xd38806 of _0x283b30){const _0x352101=_0xd38806[_0xe5d1ef(0x13ed)](_0x178412,'')[_0xe5d1ef(0x97e)]();if(!_0x352101)continue;_0x178412[_0xe5d1ef(0xf9d)]=0x0;let _0x25dbb9;while((_0x25dbb9=_0x178412[_0xe5d1ef(0x1246)](_0xd38806))!==null){const _0x1b8bf6=parseInt(_0x25dbb9[0x1],0xa),_0x4b347f=parseInt(_0x25dbb9[0x2],0xa),_0x38f6d7=parseInt(_0x25dbb9[0x3][_0xe5d1ef(0x1023)](0x3,'0'),0xa),_0x3f8bcb=_0x1b8bf6*0x3c+_0x4b347f+_0x38f6d7/0x3e8;_0x38cb58[_0xe5d1ef(0x367)]({'time':_0x3f8bcb,'text':_0x352101});}}return _0x38cb58['sort']((_0x3af808,_0x5c5c8d)=>_0x3af808[_0xe5d1ef(0x343)]-_0x5c5c8d[_0xe5d1ef(0x343)]);}function _0x4a096c(){const _0x548e65=_0x475790,_0x128d9a=document['getElementById']('music-lyrics-list');_0x128d9a[_0x548e65(0xc43)]='';if(!_0x79cac3[_0x548e65(0x9c4)]||_0x79cac3[_0x548e65(0x9c4)][_0x548e65(0x9a1)]===0x0){_0x128d9a[_0x548e65(0xc43)]=_0x548e65(0xb53);return;}_0x79cac3[_0x548e65(0x9c4)][_0x548e65(0xf99)]((_0x202aa3,_0x5534ff)=>{const _0x32d78a=_0x548e65,_0x4b7286=document[_0x32d78a(0x14ae)](_0x32d78a(0xaa5));_0x4b7286[_0x32d78a(0xdd1)]=_0x32d78a(0xb16),_0x4b7286[_0x32d78a(0x15f)]=_0x202aa3[_0x32d78a(0x10ca)],_0x4b7286[_0x32d78a(0xe93)]['index']=_0x5534ff,_0x128d9a['appendChild'](_0x4b7286);}),_0x128d9a[_0x548e65(0x589)][_0x548e65(0x1244)]=_0x548e65(0x144b);}function _0x441f7b(_0x1dab44){const _0x5138aa=_0x475790;if(_0x79cac3['parsedLyrics'][_0x5138aa(0x9a1)]===0x0)return;let _0x365637=-0x1;for(let _0x2c80d0=0x0;_0x2c80d0<_0x79cac3[_0x5138aa(0x9c4)][_0x5138aa(0x9a1)];_0x2c80d0++){if(_0x1dab44>=_0x79cac3[_0x5138aa(0x9c4)][_0x2c80d0][_0x5138aa(0x343)])_0x365637=_0x2c80d0;else break;}if(_0x365637===_0x79cac3[_0x5138aa(0xdf5)])return;_0x79cac3['currentLyricIndex']=_0x365637,_0x37977f();const _0x19a993=document['getElementById'](_0x5138aa(0x2d3));_0x19a993&&(_0x365637>-0x1&&_0x79cac3[_0x5138aa(0x9c4)][_0x365637]?_0x19a993['textContent']=_0x79cac3[_0x5138aa(0x9c4)][_0x365637][_0x5138aa(0x10ca)]:_0x19a993[_0x5138aa(0x15f)]=_0x5138aa(0x236));const _0x326fc8=document[_0x5138aa(0x2ec)]('global-lyrics-bar');_0x326fc8[_0x5138aa(0xff6)][_0x5138aa(0xe9a)]('visible')&&(_0x365637>-0x1&&_0x79cac3[_0x5138aa(0x9c4)][_0x365637]?_0x326fc8['textContent']=_0x79cac3[_0x5138aa(0x9c4)][_0x365637][_0x5138aa(0x10ca)]:_0x326fc8[_0x5138aa(0x15f)]='♪');}function _0x37977f(_0x7c193=![]){const _0xc0a0ef=_0x475790,_0x508608=_0x7c193?_0xc0a0ef(0x179):_0xc0a0ef(0x1067),_0x902c16=_0x7c193?_0xc0a0ef(0x311):_0xc0a0ef(0x6af),_0x351d7f=document[_0xc0a0ef(0x765)](_0x508608),_0xa2c5e9=document[_0xc0a0ef(0x765)](_0x902c16);if(!_0x351d7f||!_0xa2c5e9)return;const _0x15de4a=_0x351d7f[_0xc0a0ef(0x5d6)](_0xc0a0ef(0x109b));_0x15de4a[_0xc0a0ef(0xf99)](_0x6444cc=>_0x6444cc[_0xc0a0ef(0xff6)][_0xc0a0ef(0x1424)](_0xc0a0ef(0xd43)));if(_0x79cac3[_0xc0a0ef(0xdf5)]===-0x1){_0x351d7f[_0xc0a0ef(0x589)][_0xc0a0ef(0x1244)]=_0xc0a0ef(0x144b);return;}const _0x4d844c=_0x351d7f['querySelector'](_0xc0a0ef(0x11b1)+_0x79cac3[_0xc0a0ef(0xdf5)]+'\x22]');if(_0x4d844c){_0x4d844c[_0xc0a0ef(0xff6)][_0xc0a0ef(0xe82)](_0xc0a0ef(0xd43));const _0xf6a70b=_0xa2c5e9[_0xc0a0ef(0x361)],_0x4da9fa=_0xf6a70b/2.2-_0x4d844c['offsetTop']-_0x4d844c['offsetHeight']/0x2;_0x351d7f[_0xc0a0ef(0x589)][_0xc0a0ef(0x1244)]=_0xc0a0ef(0x8b7)+_0x4da9fa+_0xc0a0ef(0xc5e);}}function _0x437f71(_0x3d3ccf){const _0x1366a7=_0x475790;if(isNaN(_0x3d3ccf)||_0x3d3ccf<0x0)return _0x1366a7(0xae4);const _0xa2981d=Math['floor'](_0x3d3ccf/0x3c),_0x5fa933=Math[_0x1366a7(0x5f8)](_0x3d3ccf%0x3c);return _0xa2981d+':'+String(_0x5fa933)[_0x1366a7(0x58e)](0x2,'0');}let _0x5392e9=0x0,_0x53f19a;function _0x9574d4(){_0x53f19a&&cancelAnimationFrame(_0x53f19a);function _0x577066(){const _0x5acccf=_0x1937;if(!_0x79cac3['isPlaying']||!_0x4da7ed[_0x5acccf(0x157d)])return;const _0x15e5c3=performance[_0x5acccf(0x487)](),_0x2bb95f=_0x4da7ed['currentTime'],_0x11c2ef=_0x4da7ed[_0x5acccf(0x157d)],_0x274cbf=_0x2bb95f/_0x11c2ef*0x64;document[_0x5acccf(0x2ec)](_0x5acccf(0x132f))[_0x5acccf(0x589)][_0x5acccf(0xeb4)]=_0x274cbf+'%',_0x15e5c3-_0x5392e9>0x3e8&&(document[_0x5acccf(0x2ec)](_0x5acccf(0x9fa))[_0x5acccf(0x15f)]=_0x437f71(_0x2bb95f),document['getElementById'](_0x5acccf(0x5e1))[_0x5acccf(0x15f)]=_0x437f71(_0x11c2ef),_0x5392e9=_0x15e5c3),_0x441f7b(_0x2bb95f),_0x53f19a=requestAnimationFrame(_0x577066);}_0x53f19a=requestAnimationFrame(_0x577066);}function _0x503dba(){const _0x5f0b19=_0x475790;if(!lastRawAiResponse){alert('还没有可供编辑的AI响应。请先让AI回复一次。');return;}const _0x151d68=document[_0x5f0b19(0x2ec)](_0x5f0b19(0x117d)),_0x25c0ca=document[_0x5f0b19(0x2ec)](_0x5f0b19(0x51d));_0x25c0ca[_0x5f0b19(0xc43)]='';const _0x372b95=_0x422882(lastRawAiResponse);if(_0x372b95&&_0x372b95[_0x5f0b19(0x9a1)]>0x0)_0x372b95[_0x5f0b19(0xf99)](_0x5d46bf=>{const _0x2e893a=_0x5f0b19;if(typeof _0x5d46bf==='object'&&_0x5d46bf!==null)try{const _0x35f52c=JSON['stringify'](_0x5d46bf,null,0x2),_0xd40150=_0x1c4fcf(_0x35f52c);_0x25c0ca[_0x2e893a(0x998)](_0xd40150);}catch(_0x18a7cb){console[_0x2e893a(0x1518)](_0x2e893a(0x23b),_0x5d46bf,_0x18a7cb);}else{if(typeof _0x5d46bf===_0x2e893a(0x863)){const _0x239759=_0x1c4fcf(_0x5d46bf);_0x25c0ca[_0x2e893a(0x998)](_0x239759),console['warn'](_0x2e893a(0x11d7),_0x5d46bf);}}});else{const _0xeedc86=_0x1c4fcf(lastRawAiResponse);_0x25c0ca[_0x5f0b19(0x998)](_0xeedc86);}_0x151d68[_0x5f0b19(0xff6)][_0x5f0b19(0xe82)](_0x5f0b19(0x149d));}function _0x1c4fcf(_0x293696=''){const _0x355a63=_0x475790,_0x243717=document['createElement'](_0x355a63(0xaa5));_0x243717['className']='ai-response-editor-block';const _0x3ef3fe={'text':{'type':_0x355a63(0x10ca),'content':_0x355a63(0xe81)},'sticker':{'type':'sticker','url':_0x355a63(0x670),'meaning':_0x355a63(0x1520)},'image':{'type':_0x355a63(0x11c7),'description':_0x355a63(0xaa6)},'voice':{'type':'voice_message','content':_0x355a63(0x11cc)},'transfer':{'type':_0x355a63(0x277),'amount':5.2,'note':_0x355a63(0x207)},'offline':{'type':_0x355a63(0x6fb),'content':_0x355a63(0x7bf)},'quote':{'type':_0x355a63(0xec8),'target_timestamp':0x499602d2,'reply_content':_0x355a63(0x663)},'nai':{'type':'naiimag','prompt':_0x355a63(0xccf)}};return _0x243717[_0x355a63(0xc43)]=_0x355a63(0x873)+_0x293696+_0x355a63(0x11ae)+JSON['stringify'](_0x3ef3fe[_0x355a63(0x10ca)])+'\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x355a63(0xe4d)](_0x3ef3fe[_0x355a63(0x14f3)])+_0x355a63(0x55b)+JSON['stringify'](_0x3ef3fe[_0x355a63(0x9e6)])+_0x355a63(0x53d)+JSON[_0x355a63(0xe4d)](_0x3ef3fe[_0x355a63(0x52f)])+_0x355a63(0x178)+JSON[_0x355a63(0xe4d)](_0x3ef3fe[_0x355a63(0x277)])+_0x355a63(0xc1d)+JSON['stringify'](_0x3ef3fe['offline'])+'\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x355a63(0xe4d)](_0x3ef3fe[_0x355a63(0x447)])+'\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x3ef3fe['nai'])+_0x355a63(0x1522),_0x243717[_0x355a63(0x765)](_0x355a63(0x81c))['addEventListener']('click',()=>{_0x243717['remove']();}),_0x243717['querySelectorAll'](_0x355a63(0x1035))['forEach'](_0x18cbb4=>{const _0x3fa4ed=_0x355a63;_0x18cbb4[_0x3fa4ed(0xf79)]('click',()=>{const _0x2095fd=_0x3fa4ed,_0x39841f=_0x18cbb4['dataset']['template'],_0x546741=_0x243717['querySelector'](_0x2095fd(0x382));if(_0x39841f&&_0x546741)try{const _0x3a5968=JSON[_0x2095fd(0xd91)](_0x39841f);_0x546741[_0x2095fd(0x11a4)]=JSON[_0x2095fd(0xe4d)](_0x3a5968,null,0x2),_0x546741[_0x2095fd(0x52b)]();}catch(_0xbc8707){console[_0x2095fd(0x1518)]('解析格式模板失败:',_0xbc8707);}});}),_0x243717;}async function _0x599b65(){const _0x105c2d=_0x475790,_0x15b2dc=new Map();let _0x492739=null;if(lastPrivateMessagesSent['length']>0x0){console[_0x105c2d(0x415)]('导演剪辑室：正在撤销\x20'+lastPrivateMessagesSent[_0x105c2d(0x9a1)]+_0x105c2d(0xd2a));const _0x55c560=[...lastPrivateMessagesSent];_0x492739=_0x55c560['values']();const _0x4574df=[...new Set(_0x55c560[_0x105c2d(0x11c6)](_0x15cdce=>_0x15cdce['chatId']))];for(const _0x2111f9 of _0x4574df){const _0x3dab19=await _0x5b9d83[_0x105c2d(0x6ce)][_0x105c2d(0x6b5)](_0x2111f9);_0x3dab19&&_0x15b2dc[_0x105c2d(0xa63)](_0x2111f9,_0x3dab19);}for(const _0x3f80fb of _0x55c560){const _0x1b5dc0=_0x15b2dc[_0x105c2d(0x6b5)](_0x3f80fb[_0x105c2d(0xdd0)]);_0x1b5dc0&&(_0x1b5dc0[_0x105c2d(0x12c3)]=_0x1b5dc0[_0x105c2d(0x12c3)][_0x105c2d(0xebc)](_0x18d295=>_0x18d295[_0x105c2d(0x69a)]!==_0x3f80fb['timestamp']));}_0x15b2dc['size']>0x0&&await _0x5b9d83[_0x105c2d(0x6ce)][_0x105c2d(0xdb2)](Array[_0x105c2d(0x13d1)](_0x15b2dc['values']())),lastPrivateMessagesSent=[];}const _0x4dddc4=_0x28f30a['chats'][_0x28f30a['activeChatId']];if(!_0x4dddc4)return;const _0x500a70=document[_0x105c2d(0x2ec)](_0x105c2d(0x51d)),_0x57c402=_0x500a70[_0x105c2d(0x5d6)](_0x105c2d(0x382)),_0xd0f355=Array['from'](_0x57c402)[_0x105c2d(0x11c6)](_0x4977de=>_0x4977de['value'][_0x105c2d(0x97e)]())[_0x105c2d(0xebc)](Boolean);_0x4dddc4[_0x105c2d(0x12c3)]=_0x4dddc4[_0x105c2d(0x12c3)][_0x105c2d(0xebc)](_0x16a99f=>!lastResponseTimestamps[_0x105c2d(0x138a)](_0x16a99f[_0x105c2d(0x69a)]));if(_0xd0f355['length']===0x0){await _0x5b9d83['chats'][_0x105c2d(0x7c3)](_0x4dddc4),_0xc55746(_0x28f30a['activeChatId']),_0x5db8a3(),document[_0x105c2d(0x2ec)](_0x105c2d(0x117d))[_0x105c2d(0xff6)][_0x105c2d(0x1424)]('visible'),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0xefec03=[];for(const _0x41a71d of _0xd0f355){try{const _0x1500b9=JSON[_0x105c2d(0xd91)](_0x41a71d);_0xefec03['push'](_0x1500b9);}catch(_0x45bc24){console['warn'](_0x105c2d(0x8d5),_0x41a71d);}}let _0x518d4a=[],_0x22728a=Date[_0x105c2d(0x487)]();const _0x34345b=new Map();for(const _0x6b25d0 of _0xefec03){if(!_0x6b25d0||typeof _0x6b25d0!==_0x105c2d(0x10c0)||!_0x6b25d0[_0x105c2d(0xb4b)]){console[_0x105c2d(0x664)]('在导演模式保存时，发现无效的指令对象，已跳过:',_0x6b25d0);continue;}let _0x38b87e=null;const _0x2928cd={'role':'assistant','senderName':_0x6b25d0[_0x105c2d(0xe36)]||_0x4dddc4['originalName'],'timestamp':_0x22728a++};switch(_0x6b25d0[_0x105c2d(0xb4b)]){case _0x105c2d(0x9fb):{const _0x576595=_0x6b25d0['name'],_0x25de84=_0x6b25d0[_0x105c2d(0x548)],_0x23f52b=_0x28f30a[_0x105c2d(0x1506)][_0x105c2d(0x19a)]||_0x105c2d(0x450);if(_0x25de84===_0x23f52b){const _0x3a4ca8=Object[_0x105c2d(0x74e)](_0x28f30a[_0x105c2d(0x6ce)])[_0x105c2d(0x412)](_0x4d90a7=>!_0x4d90a7[_0x105c2d(0x1423)]&&_0x4d90a7[_0x105c2d(0x66c)]===_0x576595);if(_0x3a4ca8){if(!_0x34345b[_0x105c2d(0xbf1)](_0x3a4ca8['id'])){const _0x587968=_0x15b2dc['get'](_0x3a4ca8['id'])||await _0x5b9d83['chats'][_0x105c2d(0x6b5)](_0x3a4ca8['id']);_0x34345b[_0x105c2d(0xa63)](_0x3a4ca8['id'],_0x587968);}const _0x4d2e9f=_0x34345b['get'](_0x3a4ca8['id']),_0x308c71=Array[_0x105c2d(0x624)](_0x6b25d0[_0x105c2d(0x1047)])?_0x6b25d0[_0x105c2d(0x1047)]:[_0x6b25d0[_0x105c2d(0x1047)]];let _0x523793=0x0;for(const _0x335e35 of _0x308c71){if(!_0x335e35||!_0x335e35[_0x105c2d(0x97e)]())continue;const _0x2d8f26=_0x492739?_0x492739[_0x105c2d(0x1288)]()['value']:null,_0x422e4b=_0x2d8f26&&_0x2d8f26['chatId']===_0x3a4ca8['id']?_0x2d8f26[_0x105c2d(0x69a)]:_0x22728a++,_0x5af27a={'role':'assistant','senderName':_0x576595,'content':_0x335e35,'timestamp':_0x422e4b};lastPrivateMessagesSent[_0x105c2d(0x367)]({'chatId':_0x3a4ca8['id'],'timestamp':_0x5af27a[_0x105c2d(0x69a)]}),_0x4d2e9f[_0x105c2d(0x12c3)][_0x105c2d(0x367)](_0x5af27a),_0x523793++;}_0x523793>0x0&&(_0x28f30a[_0x105c2d(0x11b9)]!==_0x3a4ca8['id']&&(_0x4d2e9f[_0x105c2d(0xce1)]=(_0x4d2e9f[_0x105c2d(0xce1)]||0x0)+_0x523793,_0x1c12fe(_0x3a4ca8['id'],_0x3a4ca8['name']+'\x20发来了\x20'+_0x523793+_0x105c2d(0x39b)))),_0x38b87e=null;}else console['warn'](_0x105c2d(0xacf)+_0x576595+'\x20尝试发送私信，但未找到其对应的私聊会话。'),_0x38b87e=null;}else console['warn'](_0x105c2d(0x7ea)+_0x25de84+_0x105c2d(0x1577)),_0x38b87e=null;continue;}case'thought_chain':{const _0x1f8e41=_0x105c2d(0x3fa)+(_0x6b25d0[_0x105c2d(0x1450)]||'无')+'\x0a-\x20策略:\x20'+(_0x6b25d0[_0x105c2d(0xa2b)]||'无')+_0x105c2d(0x85a)+JSON[_0x105c2d(0xe4d)](_0x6b25d0[_0x105c2d(0xfe0)]||{}),_0xb117dc={'role':_0x105c2d(0x10a7),'content':_0x1f8e41,'timestamp':_0x22728a++,'isHidden':!![]};_0x4dddc4[_0x105c2d(0x12c3)]['push'](_0xb117dc),_0x518d4a[_0x105c2d(0x367)](_0xb117dc[_0x105c2d(0x69a)]);continue;}case _0x105c2d(0x10ca):_0x38b87e={..._0x2928cd,'content':String(_0x6b25d0[_0x105c2d(0x1047)]||_0x6b25d0[_0x105c2d(0x13bc)])};break;case _0x105c2d(0x14f3):{let _0x3cb940=![];if(_0x6b25d0[_0x105c2d(0x6d1)]&&_0x6b25d0[_0x105c2d(0x1488)])_0x38b87e={..._0x2928cd,'type':'sticker','content':_0x6b25d0[_0x105c2d(0x6d1)],'meaning':_0x6b25d0[_0x105c2d(0x1488)]},_0x3cb940=!![];else{if(_0x6b25d0['meaning']){const _0x28e4c1=_0x28f30a[_0x105c2d(0xf28)][_0x105c2d(0x412)](_0x304067=>_0x304067[_0x105c2d(0xe36)]===_0x6b25d0[_0x105c2d(0x1488)]);_0x28e4c1?(_0x38b87e={..._0x2928cd,'type':_0x105c2d(0x14f3),'content':_0x28e4c1[_0x105c2d(0x6d1)],'meaning':_0x28e4c1[_0x105c2d(0xe36)]},_0x3cb940=!![]):(_0x38b87e={..._0x2928cd,'type':_0x105c2d(0x10ca),'content':_0x105c2d(0x4f3)+_0x6b25d0['meaning']+']'},_0x3cb940=!![]);}else{if(_0x6b25d0['url']){_0x38b87e={..._0x2928cd,'type':_0x105c2d(0x14f3),'content':_0x6b25d0[_0x105c2d(0x6d1)]};const _0x499f8f=_0x28f30a[_0x105c2d(0xf28)][_0x105c2d(0x412)](_0x3db7f3=>_0x3db7f3[_0x105c2d(0x6d1)]===_0x6b25d0['url']);_0x38b87e['meaning']=_0x499f8f?_0x499f8f[_0x105c2d(0xe36)]:_0x105c2d(0x2ca),_0x3cb940=!![];}else{if(_0x6b25d0['content']&&typeof _0x6b25d0[_0x105c2d(0x1047)]===_0x105c2d(0x863)&&_0x41abd3['test'](_0x6b25d0[_0x105c2d(0x1047)])){_0x38b87e={..._0x2928cd,'type':'sticker','content':_0x6b25d0[_0x105c2d(0x1047)]};const _0x499f0f=_0x28f30a[_0x105c2d(0xf28)][_0x105c2d(0x412)](_0x2f04b3=>_0x2f04b3['url']===_0x6b25d0[_0x105c2d(0x1047)]);_0x38b87e['meaning']=_0x499f0f?_0x499f0f[_0x105c2d(0xe36)]:'未知表情',_0x3cb940=!![];}}}}if(!_0x3cb940){console[_0x105c2d(0x1518)]('导演模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):',_0x6b25d0);continue;}break;}case _0x105c2d(0x11c7):_0x38b87e={..._0x2928cd,'type':_0x105c2d(0x11c7),'content':_0x6b25d0[_0x105c2d(0x9cc)],'image_prompt':_0x6b25d0[_0x105c2d(0xe8f)]};break;case _0x105c2d(0xd92):_0x38b87e={..._0x2928cd,'type':_0x105c2d(0xd92),'imageUrl':_0x6b25d0[_0x105c2d(0x6c6)],'prompt':_0x6b25d0[_0x105c2d(0x9fd)],'fullPrompt':_0x6b25d0[_0x105c2d(0x5ae)]};break;case _0x105c2d(0x8bc):_0x38b87e={..._0x2928cd,'type':_0x105c2d(0x8bc),'content':_0x6b25d0[_0x105c2d(0x1047)]};break;case'transfer':_0x38b87e={..._0x2928cd,'type':_0x105c2d(0x277),'amount':_0x6b25d0['amount'],'note':_0x6b25d0['note'],'receiverName':_0x6b25d0['receiver']||'我'};break;case'waimai_request':_0x38b87e={..._0x2928cd,'type':_0x105c2d(0x12d5),'productInfo':_0x6b25d0[_0x105c2d(0xa89)],'amount':_0x6b25d0['amount'],'status':_0x105c2d(0x8c9),'countdownEndTime':Date[_0x105c2d(0x487)]()+0xf*0x3c*0x3e8};break;case _0x105c2d(0x6fb):_0x38b87e={..._0x2928cd,..._0x6b25d0};break;case _0x105c2d(0x102f):{const _0x1f3e22=_0x484920[_0x4dddc4['id']];if(_0x1f3e22){const _0x42fb66=_0x1f3e22[_0x105c2d(0x12c3)][_0x105c2d(0x9b4)](_0x4c1801=>_0x4c1801['player']===0x2);if(_0x42fb66>-0x1){const _0x5812e7=_0x1f3e22[_0x105c2d(0x12c3)][_0x42fb66];_0x1f3e22[_0x105c2d(0x6a5)][_0x5812e7['y']][_0x5812e7['x']]=0x0,_0x1f3e22[_0x105c2d(0x12c3)]['splice'](_0x42fb66,0x1),console[_0x105c2d(0x415)](_0x105c2d(0x94c)+_0x5812e7['x']+',\x20'+_0x5812e7['y']+')\x20的棋步。');}}const _0x4844cf=parseInt(_0x6b25d0['x']),_0x4a9311=parseInt(_0x6b25d0['y']);!isNaN(_0x4844cf)&&!isNaN(_0x4a9311)?_0x40299d({'x':_0x4844cf,'y':_0x4a9311},!![]):console['warn'](_0x105c2d(0x429),_0x6b25d0);continue;}case _0x105c2d(0xda1):{if(!_0x4dddc4[_0x105c2d(0x1423)]){if(_0x6b25d0[_0x105c2d(0x524)])_0x4dddc4[_0x105c2d(0x28a)]=String(_0x6b25d0[_0x105c2d(0x524)]);if(_0x6b25d0['random_jottings'])_0x4dddc4[_0x105c2d(0xe97)]=String(_0x6b25d0[_0x105c2d(0x10cd)]);if(!Array[_0x105c2d(0x624)](_0x4dddc4[_0x105c2d(0x2be)]))_0x4dddc4[_0x105c2d(0x2be)]=[];_0x4dddc4[_0x105c2d(0x2be)]['push']({'heartfeltVoice':_0x4dddc4[_0x105c2d(0x28a)],'randomJJottings':_0x4dddc4['randomJottings'],'timestamp':Date[_0x105c2d(0x487)]()});if(_0x4dddc4['thoughtsHistory'][_0x105c2d(0x9a1)]>0x32)_0x4dddc4[_0x105c2d(0x2be)][_0x105c2d(0xd3b)]();}continue;}case _0x105c2d(0xec8):{const _0x13ae04=_0x4dddc4[_0x105c2d(0x12c3)]['find'](_0x490c91=>_0x490c91[_0x105c2d(0x69a)]===_0x6b25d0[_0x105c2d(0x111a)]);let _0x4be4ef=null;if(_0x13ae04){let _0x2c09b5=_0x13ae04[_0x105c2d(0x1361)];_0x13ae04['role']==='user'&&(_0x2c09b5=_0x4dddc4[_0x105c2d(0x1423)]?_0x4dddc4[_0x105c2d(0x362)]['myNickname']||'我':_0x28f30a['qzoneSettings'][_0x105c2d(0x19a)]||_0x105c2d(0x450)),_0x4be4ef={'timestamp':_0x6b25d0[_0x105c2d(0x111a)],'senderName':_0x2c09b5,'content':String(_0x13ae04[_0x105c2d(0x1047)]||'')};}else _0x4be4ef={'timestamp':_0x6b25d0[_0x105c2d(0x111a)],'senderName':_0x105c2d(0x58f),'content':'原始消息已删除或不存在'};_0x38b87e={..._0x2928cd,'content':_0x6b25d0[_0x105c2d(0xf96)],'quote':_0x4be4ef};break;}default:console[_0x105c2d(0x664)]('在导演模式保存时，遇到了未知的AI指令类型:',_0x6b25d0['type'],_0x6b25d0);if(_0x6b25d0[_0x105c2d(0x1047)])_0x38b87e={..._0x2928cd,'content':String(_0x6b25d0[_0x105c2d(0x1047)])};else continue;break;}_0x38b87e&&(_0x4dddc4[_0x105c2d(0x12c3)][_0x105c2d(0x367)](_0x38b87e),_0x518d4a[_0x105c2d(0x367)](_0x38b87e['timestamp']));}await _0x5b9d83[_0x105c2d(0x6ce)][_0x105c2d(0x7c3)](_0x4dddc4),_0x34345b[_0x105c2d(0x2d2)]>0x0&&await _0x5b9d83['chats'][_0x105c2d(0xdb2)](Array[_0x105c2d(0x13d1)](_0x34345b[_0x105c2d(0x74e)]())),_0xc55746(_0x28f30a[_0x105c2d(0x11b9)]),_0x5db8a3(),document[_0x105c2d(0x2ec)](_0x105c2d(0x117d))[_0x105c2d(0xff6)][_0x105c2d(0x1424)](_0x105c2d(0x149d)),lastRawAiResponse=_0xd0f355[_0x105c2d(0xbad)]('\x0a\x0a'),lastResponseTimestamps=_0x518d4a,await _0x34d596(_0x105c2d(0x7b1),_0x105c2d(0x7f5));}async function _0x1f5b74(){const _0x430e6e=_0x475790;if(!_0x38f399)return;const _0x335f0a=0x2*0x3c*0x3e8,_0x424b64=_0x38f399,_0x272994=Date[_0x430e6e(0x487)]();if(_0x272994-_0x424b64>_0x335f0a){_0x3d2470(),await _0x34d596(_0x430e6e(0x221),_0x430e6e(0x6e2));return;}await _0x1ffe89(_0x424b64,!![]),_0x3d2470();}async function _0x1ffe89(_0x4ba424,_0x50e0bd){const _0x49143d=_0x475790,_0x43ce3e=_0x28f30a['chats'][_0x28f30a['activeChatId']];if(!_0x43ce3e)return;const _0x201f4a=_0x43ce3e[_0x49143d(0x12c3)][_0x49143d(0x535)](_0x5c3388=>_0x5c3388[_0x49143d(0x69a)]===_0x4ba424);if(_0x201f4a===-0x1)return;const _0x175d08=_0x43ce3e[_0x49143d(0x12c3)][_0x201f4a],_0x48d41b={'originalType':_0x175d08[_0x49143d(0xb4b)]||_0x49143d(0x10ca),'originalContent':_0x175d08[_0x49143d(0x1047)],'originalMeaning':_0x175d08['meaning'],'originalQuote':_0x175d08[_0x49143d(0x447)]};_0x175d08[_0x49143d(0xb4b)]=_0x49143d(0xf2f),_0x175d08[_0x49143d(0x1047)]=_0x50e0bd?'你撤回了一条消息':_0x49143d(0x12d7),_0x175d08[_0x49143d(0x6cd)]=_0x48d41b,delete _0x175d08['meaning'],delete _0x175d08[_0x49143d(0x447)];if(_0x50e0bd){const _0xecc328=_0x43ce3e[_0x49143d(0x1423)]?_0x43ce3e['settings'][_0x49143d(0xa28)]||'我':'我';let _0x5e80e8='';if(_0x48d41b[_0x49143d(0x223)]===_0x49143d(0x14f3))_0x5e80e8=_0x49143d(0xd99)+(_0x48d41b['originalMeaning']||'未知')+']';else _0x48d41b[_0x49143d(0x223)]===_0x49143d(0x11c7)||_0x48d41b[_0x49143d(0x223)]===_0x49143d(0x7f7)?_0x5e80e8=_0x49143d(0x47b)+_0x48d41b['originalContent']+']':_0x5e80e8='“'+String(_0x48d41b['originalContent'])+'”';const _0x433193={'role':_0x49143d(0x10a7),'content':_0x49143d(0x6e3)+_0xecc328+_0x49143d(0x1262)+_0x5e80e8+_0x49143d(0x3ac),'timestamp':Date['now'](),'isHidden':!![]};_0x43ce3e[_0x49143d(0x12c3)][_0x49143d(0x367)](_0x433193);}await _0x5b9d83['chats'][_0x49143d(0x7c3)](_0x43ce3e),_0xc55746(_0x28f30a['activeChatId']),_0x50e0bd&&(_0x5db8a3(),_0x36bcc9());}async function _0x4d26d7(){const _0x22fc84=_0x475790;await _0x3b72ae(),document['getElementById']('world-book-category-manager-modal')[_0x22fc84(0xff6)][_0x22fc84(0xe82)](_0x22fc84(0x149d));}async function _0x3b72ae(){const _0x18a0ce=_0x475790,_0x249568=document['getElementById'](_0x18a0ce(0xa76)),_0x14c811=await _0x5b9d83[_0x18a0ce(0x5c0)][_0x18a0ce(0x14b5)]();_0x249568[_0x18a0ce(0xc43)]='',_0x14c811[_0x18a0ce(0x9a1)]===0x0&&(_0x249568[_0x18a0ce(0xc43)]=_0x18a0ce(0x1001)),_0x14c811[_0x18a0ce(0xf99)](_0x54803d=>{const _0x32022d=_0x18a0ce,_0x1599db=document['createElement']('div');_0x1599db[_0x32022d(0xdd1)]=_0x32022d(0xe3c),_0x1599db[_0x32022d(0xc43)]=_0x32022d(0x2ef)+_0x54803d[_0x32022d(0xe36)]+_0x32022d(0x643)+_0x54803d['id']+_0x32022d(0x13da),_0x249568['appendChild'](_0x1599db);});}async function _0x5285aa(){const _0x5f12fa=_0x475790,_0x35dc26=document[_0x5f12fa(0x2ec)]('new-category-name-input'),_0x4ce36e=_0x35dc26['value'][_0x5f12fa(0x97e)]();if(!_0x4ce36e){alert(_0x5f12fa(0x8d0));return;}const _0xb16d19=await _0x5b9d83['worldBookCategories'][_0x5f12fa(0x67e)]('name')[_0x5f12fa(0x129a)](_0x4ce36e)[_0x5f12fa(0x942)]();if(_0xb16d19){alert('分类\x20\x22'+_0x4ce36e+_0x5f12fa(0xd64));return;}await _0x5b9d83['worldBookCategories'][_0x5f12fa(0xe82)]({'name':_0x4ce36e}),_0x35dc26['value']='',await _0x3b72ae();}async function _0x15e6ad(_0x183732){const _0x165cc4=_0x475790,_0x391268=await _0x4436ba(_0x165cc4(0x10d9),'删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？',{'confirmButtonClass':_0x165cc4(0xd8f)});if(_0x391268){await _0x5b9d83['worldBookCategories'][_0x165cc4(0x54b)](_0x183732);const _0x5e4aa8=await _0x5b9d83['worldBooks'][_0x165cc4(0x67e)](_0x165cc4(0x10ce))[_0x165cc4(0x129a)](_0x183732)[_0x165cc4(0x14b5)]();for(const _0x49cee5 of _0x5e4aa8){_0x49cee5[_0x165cc4(0x10ce)]=null,await _0x5b9d83[_0x165cc4(0x13b9)][_0x165cc4(0x7c3)](_0x49cee5);const _0x348888=_0x28f30a[_0x165cc4(0x13b9)][_0x165cc4(0x412)](_0x50d0c0=>_0x50d0c0['id']===_0x49cee5['id']);if(_0x348888)_0x348888[_0x165cc4(0x10ce)]=null;}await _0x3b72ae();}}async function _0x4f0108(){const _0x5c6dfe=_0x475790;if(!_0x38f399)return;const _0x2dfa43=_0x38f399;_0x3d2470();const _0x422871=_0x28f30a['chats'][_0x28f30a[_0x5c6dfe(0x11b9)]],_0x42aed=_0x422871[_0x5c6dfe(0x12c3)][_0x5c6dfe(0x412)](_0x50193a=>_0x50193a['timestamp']===_0x2dfa43);if(!_0x42aed)return;let _0x9ab403=String(_0x42aed['content']||'')[_0x5c6dfe(0xa6b)](0x0,0x32)+_0x5c6dfe(0x4e6);if(_0x42aed['type']===_0x5c6dfe(0x11c7))_0x9ab403=_0x5c6dfe(0x1409)+_0x9ab403;const _0x142b8c=await _0x4436ba(_0x5c6dfe(0xd1f),_0x5c6dfe(0xdaf)+_0x9ab403+'”',{'confirmText':_0x5c6dfe(0xf00)});if(_0x142b8c){const _0x5d1a22=_0x422871[_0x5c6dfe(0x362)]['myNickname']||'我';!Array['isArray'](_0x422871[_0x5c6dfe(0x380)])&&(_0x422871[_0x5c6dfe(0x380)]=[]);const _0x1f3201={'id':_0x5c6dfe(0xc18)+Date['now'](),'messageTimestamp':_0x2dfa43,'publisher':_0x5d1a22,'publishedAt':Date['now'](),'isPinned':![]};_0x422871[_0x5c6dfe(0x380)][_0x5c6dfe(0x367)](_0x1f3201);const _0x2448a0={'role':'system','type':_0x5c6dfe(0x10aa),'content':_0x5d1a22+'\x20发布了一条新公告','timestamp':Date['now']()};_0x422871[_0x5c6dfe(0x12c3)][_0x5c6dfe(0x367)](_0x2448a0),await _0x5b9d83[_0x5c6dfe(0x6ce)]['put'](_0x422871),_0x4cc03e(_0x2448a0,_0x422871),_0x5db8a3(),await _0x34d596('成功',_0x5c6dfe(0x142b));}}async function _0x15093e(){const _0x56acf1=_0x475790,_0x2f4aff=_0x28f30a[_0x56acf1(0x6ce)][_0x28f30a[_0x56acf1(0x11b9)]],_0x26697e=_0x2f4aff[_0x56acf1(0x380)]||[];if(!_0x2f4aff||_0x26697e['length']===0x0){_0x34d596('提示',_0x56acf1(0xcb7));return;}const _0x201636=document[_0x56acf1(0x2ec)](_0x56acf1(0x24e));_0x201636['innerHTML']='',_0x26697e[_0x56acf1(0x126b)]((_0x5e07e4,_0x407329)=>(_0x407329[_0x56acf1(0xa1c)]?0x1:0x0)-(_0x5e07e4[_0x56acf1(0xa1c)]?0x1:0x0));for(const _0x9ec916 of _0x26697e){const _0x5ccf0f=_0x2f4aff[_0x56acf1(0x12c3)][_0x56acf1(0x412)](_0x46e233=>_0x46e233[_0x56acf1(0x69a)]===_0x9ec916[_0x56acf1(0x544)]),_0x3d3c43=document['createElement'](_0x56acf1(0xaa5));_0x3d3c43[_0x56acf1(0xdd1)]=_0x56acf1(0x864);if(_0x5ccf0f){const _0x2a1c8c=await _0x43f190(_0x5ccf0f,_0x2f4aff);_0x2a1c8c&&_0x3d3c43['appendChild'](_0x2a1c8c);}else _0x3d3c43[_0x56acf1(0xc43)]=_0x56acf1(0x13a1);_0x9ec916[_0x56acf1(0xa1c)]&&(_0x3d3c43[_0x56acf1(0xc43)]+=_0x56acf1(0x742)),_0x3d3c43[_0x56acf1(0xc43)]+='<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22'+_0x9ec916['id']+'\x22>...</div>',_0x201636[_0x56acf1(0x998)](_0x3d3c43);}document[_0x56acf1(0x2ec)](_0x56acf1(0x14a0))[_0x56acf1(0xff6)][_0x56acf1(0xe82)]('visible');}let _0x50f6ba=null;function _0x103e91(_0x7ebfa9){const _0x386589=_0x475790;_0x50f6ba=_0x7ebfa9;const _0x5e6ea3=_0x28f30a['chats'][_0x28f30a['activeChatId']],_0x2980b9=_0x5e6ea3[_0x386589(0x380)][_0x386589(0x412)](_0x2d8634=>_0x2d8634['id']===_0x7ebfa9);if(!_0x2980b9)return;const _0x21579e=document[_0x386589(0x2ec)]('announcement-action-pin');_0x21579e[_0x386589(0x15f)]=_0x2980b9[_0x386589(0xa1c)]?'取消置顶':_0x386589(0x475),document[_0x386589(0x2ec)](_0x386589(0x10f9))['classList'][_0x386589(0xe82)](_0x386589(0x149d));}async function _0x56111e(){const _0x3f180e=_0x475790;if(!_0x50f6ba)return;const _0x4834d3=_0x28f30a['chats'][_0x28f30a['activeChatId']],_0x439243=_0x4834d3[_0x3f180e(0x380)][_0x3f180e(0x412)](_0x32c37e=>_0x32c37e['id']===_0x50f6ba);_0x439243&&(_0x439243['isPinned']=!_0x439243[_0x3f180e(0xa1c)],await _0x5b9d83[_0x3f180e(0x6ce)][_0x3f180e(0x7c3)](_0x4834d3),_0x15093e()),document[_0x3f180e(0x2ec)]('announcement-actions-modal')[_0x3f180e(0xff6)][_0x3f180e(0x1424)]('visible');}async function _0x3160f0(){const _0x172e67=_0x475790;if(!_0x50f6ba)return;const _0x572aea=await _0x4436ba(_0x172e67(0x10d9),_0x172e67(0x1531),{'confirmButtonClass':'btn-danger'});if(_0x572aea){const _0x2d0bdc=_0x28f30a[_0x172e67(0x6ce)][_0x28f30a['activeChatId']];_0x2d0bdc['announcements']=_0x2d0bdc['announcements'][_0x172e67(0xebc)](_0x264d99=>_0x264d99['id']!==_0x50f6ba),await _0x5b9d83[_0x172e67(0x6ce)][_0x172e67(0x7c3)](_0x2d0bdc),_0x15093e();}document[_0x172e67(0x2ec)](_0x172e67(0x10f9))['classList']['remove'](_0x172e67(0x149d));}let _0x54ff18=![],_0x48ceb9={'ai':null,'my':null};function _0x48c1ce(_0x6d27fc='chat'){const _0x38f865=_0x475790,_0x36368f=document['getElementById'](_0x38f865(0x508));if(!_0x28f30a[_0x38f865(0x11b9)])return;const _0x540bb9=_0x28f30a[_0x38f865(0x6ce)][_0x28f30a['activeChatId']];_0x54ff18=_0x6d27fc===_0x38f865(0x19f);if(_0x54ff18){const _0x17307c=_0x540bb9[_0x38f865(0x10f2)][_0x38f865(0x412)](_0x24d33f=>_0x24d33f['id']===_0x6c1e72);if(!_0x17307c)return;_0x48ceb9['my']=_0x17307c[_0x38f865(0x13d9)]||'',_0x2ba13a(!![],_0x17307c[_0x38f865(0x516)],_0x17307c[_0x38f865(0x13d9)]);}else _0x48ceb9['ai']=_0x540bb9[_0x38f865(0x362)]['aiAvatarFrame']||'',_0x48ceb9['my']=_0x540bb9['settings'][_0x38f865(0xffe)]||'',_0x2ba13a(![]);_0x36368f[_0x38f865(0xff6)][_0x38f865(0xe82)](_0x38f865(0x149d));}function _0x2ba13a(_0x31e12d=![],_0x51c5db=null,_0x2aa5d4=null){const _0x3c542c=_0x475790,_0x51028d=document['getElementById']('ai-frame-grid'),_0x1ff3fa=document[_0x3c542c(0x2ec)](_0x3c542c(0xe6b)),_0x46936a=_0x28f30a[_0x3c542c(0x6ce)][_0x28f30a[_0x3c542c(0x11b9)]];_0x51028d[_0x3c542c(0xc43)]='',_0x1ff3fa[_0x3c542c(0xc43)]='',document[_0x3c542c(0x765)](_0x3c542c(0x7b6))[_0x3c542c(0x589)]['display']=_0x31e12d?_0x3c542c(0x5b1):_0x3c542c(0xc67),document[_0x3c542c(0x2ec)](_0x3c542c(0x553))[_0x3c542c(0x589)]['display']=_0x3c542c(0x13f7),document[_0x3c542c(0x2ec)](_0x3c542c(0x13fe))['style'][_0x3c542c(0x701)]=_0x3c542c(0x5b1),document['getElementById'](_0x3c542c(0x6a1))[_0x3c542c(0xff6)]['add'](_0x3c542c(0xd43)),document[_0x3c542c(0x2ec)](_0x3c542c(0x11f5))[_0x3c542c(0xff6)][_0x3c542c(0x1424)](_0x3c542c(0xd43));if(_0x31e12d)_0x216ec7[_0x3c542c(0xf99)](_0x4c60b7=>{const _0x288edf=_0x3c542c,_0x722788=_0x54d770(_0x4c60b7,'my',_0x51c5db);_0x4c60b7['url']===_0x2aa5d4&&_0x722788[_0x288edf(0xff6)][_0x288edf(0xe82)]('selected'),_0x51028d[_0x288edf(0x998)](_0x722788);});else{const _0x45e672=_0x46936a[_0x3c542c(0x362)][_0x3c542c(0xe91)]||_0x825cf1,_0x3448de=_0x46936a[_0x3c542c(0x362)][_0x3c542c(0x10a3)]||(_0x46936a[_0x3c542c(0x1423)]?_0x3ba305:_0x825cf1);_0x216ec7['forEach'](_0x3b0653=>{const _0x230961=_0x3c542c,_0x1c29bf=_0x54d770(_0x3b0653,'ai',_0x45e672);if(_0x3b0653[_0x230961(0x6d1)]===_0x48ceb9['ai'])_0x1c29bf[_0x230961(0xff6)][_0x230961(0xe82)]('selected');_0x51028d[_0x230961(0x998)](_0x1c29bf);const _0x3b2b6f=_0x54d770(_0x3b0653,'my',_0x3448de);if(_0x3b0653[_0x230961(0x6d1)]===_0x48ceb9['my'])_0x3b2b6f[_0x230961(0xff6)]['add'](_0x230961(0xba2));_0x1ff3fa[_0x230961(0x998)](_0x3b2b6f);});}}function _0x54d770(_0x5cc10c,_0x1dc09f,_0x2a984b){const _0x41a881=_0x475790,_0x46c2af=document[_0x41a881(0x14ae)](_0x41a881(0xaa5));return _0x46c2af[_0x41a881(0xdd1)]='frame-item',_0x46c2af[_0x41a881(0xe93)][_0x41a881(0x13e1)]=_0x5cc10c[_0x41a881(0x6d1)],_0x46c2af[_0x41a881(0x141e)]=_0x5cc10c[_0x41a881(0xe36)],_0x46c2af['innerHTML']=_0x41a881(0xed3)+_0x2a984b+_0x41a881(0x1ab)+(_0x5cc10c[_0x41a881(0x6d1)]?_0x41a881(0x416)+_0x5cc10c[_0x41a881(0x6d1)]+_0x41a881(0x370):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x46c2af['addEventListener'](_0x41a881(0x1177),()=>{const _0x96efa9=_0x41a881;_0x48ceb9[_0x1dc09f]=_0x5cc10c[_0x96efa9(0x6d1)];const _0x14cbac=_0x1dc09f==='ai'?document[_0x96efa9(0x2ec)]('ai-frame-grid'):document[_0x96efa9(0x2ec)]('my-frame-grid');_0x14cbac[_0x96efa9(0x5d6)](_0x96efa9(0x167))['forEach'](_0x296245=>_0x296245[_0x96efa9(0xff6)][_0x96efa9(0x1424)](_0x96efa9(0xba2))),_0x46c2af['classList'][_0x96efa9(0xe82)](_0x96efa9(0xba2));}),_0x46c2af;}async function _0x3c1ab7(){const _0xff9a07=_0x475790;if(!_0x28f30a[_0xff9a07(0x11b9)])return;const _0x26a5a3=_0x28f30a[_0xff9a07(0x6ce)][_0x28f30a[_0xff9a07(0x11b9)]];if(_0x54ff18){const _0x3db9e2=_0x26a5a3[_0xff9a07(0x10f2)]['find'](_0x27a694=>_0x27a694['id']===_0x6c1e72);_0x3db9e2&&(_0x3db9e2[_0xff9a07(0x13d9)]=_0x48ceb9['my']);}else _0x26a5a3[_0xff9a07(0x362)]['aiAvatarFrame']=_0x48ceb9['ai'],_0x26a5a3[_0xff9a07(0x362)][_0xff9a07(0xffe)]=_0x48ceb9['my'];await _0x5b9d83[_0xff9a07(0x6ce)][_0xff9a07(0x7c3)](_0x26a5a3);if(!_0x54ff18&&!_0x26a5a3[_0xff9a07(0x1423)]){const _0x24673b=_0x26a5a3['id'];for(const _0x39486a of Object[_0xff9a07(0x74e)](_0x28f30a[_0xff9a07(0x6ce)])){if(_0x39486a['isGroup']&&_0x39486a['members']){const _0x92c6b2=_0x39486a['members']['find'](_0x2f1356=>_0x2f1356['id']===_0x24673b);_0x92c6b2&&(_0x92c6b2['avatarFrame']=_0x26a5a3[_0xff9a07(0x362)][_0xff9a07(0x5b8)],await _0x5b9d83[_0xff9a07(0x6ce)]['put'](_0x39486a),console[_0xff9a07(0x415)](_0xff9a07(0x3ff)+_0x24673b+_0xff9a07(0x141c)+_0x39486a[_0xff9a07(0xe36)]+'\x22'));}}}document['getElementById'](_0xff9a07(0x508))['classList'][_0xff9a07(0x1424)](_0xff9a07(0x149d)),_0xc55746(_0x28f30a[_0xff9a07(0x11b9)]),alert(_0xff9a07(0x1225)),_0x54ff18=![];}function _0x3adfa8(){const _0x489359=_0x475790;_0x5c53cf=!_0x5c53cf;const _0x46d8ed=document['getElementById'](_0x489359(0x323)),_0x29b3f1=document[_0x489359(0x2ec)]('frame-action-bar'),_0x1ed3c1=document[_0x489359(0x2ec)](_0x489359(0x81e));document[_0x489359(0x5d6)](_0x489359(0x125c))['forEach'](_0x3c7cbe=>{const _0x3e989a=_0x489359;_0x3c7cbe[_0x3e989a(0xff6)][_0x3e989a(0x14c8)]('management-mode',_0x5c53cf);}),_0x5c53cf?(_0x46d8ed[_0x489359(0x15f)]='完成',_0x29b3f1[_0x489359(0x589)][_0x489359(0x701)]=_0x489359(0xc67),_0x2b7696[_0x489359(0xe98)](),_0x1ed3c1[_0x489359(0x13b8)]=![],_0x2f84fa()):(_0x46d8ed[_0x489359(0x15f)]='管理',_0x29b3f1[_0x489359(0x589)][_0x489359(0x701)]=_0x489359(0x5b1),document[_0x489359(0x5d6)](_0x489359(0x1472))['forEach'](_0x3e1a31=>{const _0x205352=_0x489359;_0x3e1a31[_0x205352(0xff6)][_0x205352(0x1424)]('selected');}));}function _0x2f84fa(){const _0x508f7e=_0x475790,_0x464b75=document[_0x508f7e(0x2ec)](_0x508f7e(0x349));_0x464b75['textContent']=_0x508f7e(0xc6e)+_0x2b7696[_0x508f7e(0x2d2)]+')';}function _0x1c83f3(){const _0x3fdb89=_0x475790,_0x4097fe=document[_0x3fdb89(0x2ec)]('select-all-frames-checkbox')[_0x3fdb89(0x13b8)],_0x26a9a3=document[_0x3fdb89(0x765)](_0x3fdb89(0x51e));if(!_0x26a9a3)return;_0x26a9a3['querySelectorAll'](_0x3fdb89(0x91b))[_0x3fdb89(0xf99)](_0x458112=>{const _0x14b157=_0x3fdb89,_0x1ca5c7=parseInt(_0x458112[_0x14b157(0x765)](_0x14b157(0x116f))['dataset']['id']);if(isNaN(_0x1ca5c7))return;_0x458112['classList'][_0x14b157(0x14c8)]('selected',_0x4097fe),_0x4097fe?_0x2b7696[_0x14b157(0xe82)](_0x1ca5c7):_0x2b7696[_0x14b157(0x54b)](_0x1ca5c7);}),_0x2f84fa();}async function _0x36e1c8(){const _0x3eb433=_0x475790;if(_0x2b7696[_0x3eb433(0x2d2)]===0x0)return;const _0x42bbd7=await _0x4436ba(_0x3eb433(0x10d9),'确定要永久删除选中的\x20'+_0x2b7696[_0x3eb433(0x2d2)]+_0x3eb433(0x1559),{'confirmButtonClass':'btn-danger'});if(_0x42bbd7){const _0x562310=[..._0x2b7696];await _0x5b9d83[_0x3eb433(0x1e9)]['bulkDelete'](_0x562310),_0x3adfa8(),_0x2ba13a(_0x54ff18),await _0x34d596('删除成功','选中的头像框已成功删除。');}}function _0x276bb0(_0x3eab91){const _0x26f8b4=_0x475790,_0x270ff3=document[_0x26f8b4(0x2ec)]('global-custom-style');_0x270ff3&&(_0x270ff3[_0x26f8b4(0xc43)]=_0x3eab91||'');}async function _0x150e2e(_0x3d9248){const _0x1af461=_0x475790;if(!_0x79cac3[_0x1af461(0xffc)]||!_0x79cac3['activeChatId'])return;const _0x106dac=_0x28f30a[_0x1af461(0x6ce)][_0x79cac3[_0x1af461(0x11b9)]];if(!_0x106dac)return;const _0x4d619c=_0x106dac[_0x1af461(0x1423)]?_0x106dac[_0x1af461(0x362)][_0x1af461(0xa28)]||'我':'我',_0x3d5997=_0x1af461(0x12a1)+_0x4d619c+')\x20'+_0x3d9248+']',_0x40dd73={'role':'system','content':_0x3d5997,'timestamp':Date[_0x1af461(0x487)](),'isHidden':!![]};_0x106dac[_0x1af461(0x12c3)]['push'](_0x40dd73),await _0x5b9d83[_0x1af461(0x6ce)][_0x1af461(0x7c3)](_0x106dac);}async function _0x1040dc(){const _0x5be139=_0x475790;if(_0x2c905a['size']===0x0)return;const _0x1cf704=_0x28f30a['chats'][_0x28f30a[_0x5be139(0x11b9)]];if(!_0x1cf704)return;const _0x37affa=document[_0x5be139(0x2ec)](_0x5be139(0x582)),_0x1edccd=_0x37affa[_0x5be139(0x15f)];_0x37affa['textContent']=_0x5be139(0x6bc),_0x37affa['disabled']=!![];const _0x42fce3=document[_0x5be139(0x14ae)]('div'),_0x45d1d3=document[_0x5be139(0x2ec)]('phone-screen');_0x42fce3[_0x5be139(0x589)][_0x5be139(0xeb4)]=_0x45d1d3[_0x5be139(0x144c)]+'px',_0x42fce3[_0x5be139(0x589)][_0x5be139(0xe45)]=_0x5be139(0x7cb),_0x42fce3[_0x5be139(0x589)]['top']='-9999px',_0x42fce3['style'][_0x5be139(0xd02)]=_0x5be139(0x26a),_0x42fce3[_0x5be139(0x589)][_0x5be139(0x701)]=_0x5be139(0xc67),_0x42fce3[_0x5be139(0x589)][_0x5be139(0x66b)]=_0x5be139(0x1045),_0x42fce3[_0x5be139(0x589)][_0x5be139(0x11d3)]=_0x5be139(0x1214);const _0x1f2bab=document['getElementById'](_0x5be139(0x120a));_0x42fce3[_0x5be139(0x589)]['backgroundImage']=_0x1f2bab['style'][_0x5be139(0xe00)],_0x42fce3[_0x5be139(0x589)][_0x5be139(0xc34)]=_0x1f2bab[_0x5be139(0x589)][_0x5be139(0xc34)]||(document[_0x5be139(0x2ec)]('phone-screen')['classList']['contains']('dark-mode')?_0x5be139(0x9ef):_0x5be139(0x471));const _0x1b48a0=document[_0x5be139(0x14ae)](_0x5be139(0x589));_0x1b48a0[_0x5be139(0xc43)]=_0x5be139(0xa96),document[_0x5be139(0x150d)]['appendChild'](_0x1b48a0);try{const _0x25b10d=_0x1f2bab[_0x5be139(0x765)](_0x5be139(0xd36))[_0x5be139(0x303)](!![]);_0x25b10d[_0x5be139(0xff6)]['add']('cloned-header');const _0x4468d9=document[_0x5be139(0x14ae)](_0x5be139(0xaa5)),_0x3f68b5=document[_0x5be139(0x2ec)](_0x5be139(0x156b));_0x4468d9[_0x5be139(0x589)][_0x5be139(0x701)]=_0x5be139(0xc67),_0x4468d9[_0x5be139(0x589)]['flexDirection']='column',_0x4468d9['style'][_0x5be139(0xf5a)]=_0x5be139(0x4a7),_0x4468d9['style'][_0x5be139(0x628)]=_0x5be139(0x121f),_0x4468d9[_0x5be139(0x589)][_0x5be139(0xeb4)]=_0x5be139(0x4a5),_0x4468d9[_0x5be139(0x589)][_0x5be139(0x1215)]=_0x5be139(0xcab),_0x4468d9[_0x5be139(0xe93)][_0x5be139(0x2a7)]=_0x3f68b5[_0x5be139(0xe93)]['theme'],_0x4468d9[_0x5be139(0x589)][_0x5be139(0x644)](_0x5be139(0xe7b),_0x3f68b5[_0x5be139(0x589)][_0x5be139(0xa49)](_0x5be139(0xe7b)));const _0x29327e=_0x1f2bab[_0x5be139(0x765)](_0x5be139(0xd7e))['cloneNode'](!![]),_0x51be2b=[..._0x2c905a][_0x5be139(0x126b)]((_0x4e3456,_0x3ec09d)=>_0x4e3456-_0x3ec09d);_0x51be2b['forEach'](_0x343498=>{const _0x1ae37b=_0x5be139,_0x4769d7=document[_0x1ae37b(0x765)](_0x1ae37b(0x84e)+_0x343498+'\x22]');if(_0x4769d7){const _0x18efbf=_0x4769d7['closest'](_0x1ae37b(0x1571));_0x18efbf&&_0x4468d9['appendChild'](_0x18efbf['cloneNode'](!![]));}}),_0x42fce3['appendChild'](_0x25b10d),_0x42fce3[_0x5be139(0x998)](_0x4468d9),_0x42fce3[_0x5be139(0x998)](_0x29327e),document[_0x5be139(0x140d)]['appendChild'](_0x42fce3);const _0x415713=Array[_0x5be139(0x13d1)](_0x42fce3[_0x5be139(0x836)](_0x5be139(0x3b3))),_0x1a5dbf=_0x415713[_0x5be139(0x11c6)](_0xc6ce62=>new Promise((_0x159a05,_0x2f2be8)=>{const _0x1dd338=_0x5be139;if(_0xc6ce62[_0x1dd338(0xce4)][_0x1dd338(0x741)](_0x1dd338(0x54c))){_0x159a05();return;}const _0x5ce50a=new Image();_0x5ce50a[_0x1dd338(0x30b)]=_0x1dd338(0x792),_0x5ce50a[_0x1dd338(0xf2d)]=_0x159a05,_0x5ce50a[_0x1dd338(0x125a)]=_0x159a05,_0x5ce50a[_0x1dd338(0xce4)]=_0xc6ce62[_0x1dd338(0xce4)];}));await Promise[_0x5be139(0xa92)](_0x1a5dbf);const _0x153640=await html2canvas(_0x42fce3,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window['devicePixelRatio']||0x2});_0x153640[_0x5be139(0x1482)](function(_0x3847e6){const _0x598bd2=_0x5be139,_0x379cf6=URL['createObjectURL'](_0x3847e6),_0x3407d5=document[_0x598bd2(0x14ae)]('a');_0x3407d5[_0x598bd2(0x3eb)]=_0x598bd2(0x8e3)+_0x1cf704[_0x598bd2(0xe36)]+'-'+Date[_0x598bd2(0x487)]()+_0x598bd2(0xbb2),_0x3407d5[_0x598bd2(0xe15)]=_0x379cf6,document[_0x598bd2(0x140d)][_0x598bd2(0x998)](_0x3407d5),_0x3407d5[_0x598bd2(0x1177)](),document['body'][_0x598bd2(0xd17)](_0x3407d5),URL[_0x598bd2(0x18d)](_0x379cf6);},_0x5be139(0xca9));}catch(_0x5c9f00){console[_0x5be139(0x1518)](_0x5be139(0x109c),_0x5c9f00),await _0x34d596('生成失败',_0x5be139(0x828));}finally{document[_0x5be139(0x140d)][_0x5be139(0xd17)](_0x42fce3),document['head'][_0x5be139(0xd17)](_0x1b48a0),_0x37affa['textContent']=_0x1edccd,_0x37affa[_0x5be139(0x1373)]=![],_0x13d807();}}function _0x35bd8e(_0x1a49f1){const _0x4e30a7=_0x475790;if(!_0x1a49f1||typeof _0x1a49f1!==_0x4e30a7(0x863))return'';return _0x1a49f1=_0x1a49f1[_0x4e30a7(0x13ed)](/!h\{(.*?)\}/g,'<span\x20class=\x22diary-highlight\x22>$1</span>'),_0x1a49f1=_0x1a49f1[_0x4e30a7(0x13ed)](/!u\{(.*?)\}/g,'<span\x20class=\x22diary-underline\x22>$1</span>'),_0x1a49f1=_0x1a49f1[_0x4e30a7(0x13ed)](/!e\{(.*?)\}/g,_0x4e30a7(0x113a)),_0x1a49f1=_0x1a49f1['replace'](/!w\{(.*?)\}/g,'<span\x20class=\x22diary-handwritten\x22>$1</span>'),_0x1a49f1=_0x1a49f1[_0x4e30a7(0x13ed)](/!m\{(.*?)\}/g,_0x4e30a7(0x3de)),_0x1a49f1=_0x1a49f1[_0x4e30a7(0x13ed)](/\|\|(.*?)\|\|/g,_0x4e30a7(0x128c)),_0x1a49f1=_0x1a49f1[_0x4e30a7(0x13ed)](/\*\*(.*?)\*\*/g,_0x4e30a7(0x4d0)),_0x1a49f1=_0x1a49f1[_0x4e30a7(0x13ed)](/\~\~(.*?)\~\~/g,'<s>$1</s>'),_0x1a49f1=_0x1a49f1[_0x4e30a7(0x13ed)](/\*(.*?)\*/g,_0x4e30a7(0xb3e)),_0x1a49f1;}async function _0x25e92e(){const _0x56b81d=_0x475790;console['log'](_0x56b81d(0x7ef));let _0x12cdb6=0x0;const _0x228a12=Object[_0x56b81d(0x74e)](_0x28f30a['chats']);for(const _0x35b8cf of _0x228a12){let _0x348034=![];for(const _0x46e58c of _0x35b8cf['history']){_0x46e58c[_0x56b81d(0xb4b)]==='red_packet'&&_0x46e58c[_0x56b81d(0x110b)]===_0x56b81d(0x43c)&&_0x46e58c['role']===_0x56b81d(0x6d9)&&_0x46e58c[_0x56b81d(0x1433)]('receiver')&&!_0x46e58c['hasOwnProperty'](_0x56b81d(0x61c))&&(_0x46e58c[_0x56b81d(0x61c)]=_0x46e58c['receiver'],delete _0x46e58c[_0x56b81d(0xce3)],_0x348034=!![],_0x12cdb6++);}_0x348034&&(console['log']('在聊天\x20\x22'+_0x35b8cf[_0x56b81d(0xe36)]+_0x56b81d(0x1415)),await _0x5b9d83['chats'][_0x56b81d(0x7c3)](_0x35b8cf));}_0x12cdb6>0x0?(console[_0x56b81d(0x415)](_0x56b81d(0x9b0)+_0x12cdb6+_0x56b81d(0xdc7)),alert(_0x56b81d(0x1052)+_0x12cdb6+'\x20条旧的红包消息！页面将自动刷新以应用更改。'),location[_0x56b81d(0x7e3)]()):console[_0x56b81d(0x415)](_0x56b81d(0xe5e));}function _0x467dec(_0x3420b2){const _0x37992f=_0x475790,_0x3cc243=_0x28f30a[_0x37992f(0x6ce)][_0x3420b2];if(!_0x3cc243||_0x3cc243[_0x37992f(0x1423)])return;document[_0x37992f(0x2ec)]('profile-heartfelt-voice')[_0x37992f(0x15f)]=_0x3cc243[_0x37992f(0x28a)]||_0x37992f(0x4e6),document['getElementById'](_0x37992f(0x7ad))['textContent']=_0x3cc243[_0x37992f(0xe97)]||_0x37992f(0x4e6);const _0x4a5dcf=document[_0x37992f(0x2ec)](_0x37992f(0x37d));_0x4a5dcf[_0x37992f(0xff6)][_0x37992f(0xe82)](_0x37992f(0x149d));}function _0x4f27a5(){const _0x4d782=_0x475790;document['getElementById']('profile-main-content')[_0x4d782(0x589)][_0x4d782(0x701)]=_0x4d782(0x5b1),document[_0x4d782(0x2ec)]('profile-thoughts-history-view')[_0x4d782(0x589)][_0x4d782(0x701)]=_0x4d782(0xc67),_0x38eb80();}function _0x43d89d(){const _0xe8855c=_0x475790;document[_0xe8855c(0x2ec)](_0xe8855c(0xd0e))['style']['display']='none',document[_0xe8855c(0x2ec)](_0xe8855c(0x1231))['style'][_0xe8855c(0x701)]=_0xe8855c(0xc67);}function _0x38eb80(){const _0xd6ea45=_0x475790,_0x4bd6e7=document[_0xd6ea45(0x2ec)](_0xd6ea45(0xd68)),_0x1be300=_0x28f30a[_0xd6ea45(0x6ce)][_0x28f30a[_0xd6ea45(0x11b9)]];_0x4bd6e7[_0xd6ea45(0xc43)]='';if(!_0x1be300||!_0x1be300[_0xd6ea45(0x2be)]||_0x1be300[_0xd6ea45(0x2be)][_0xd6ea45(0x9a1)]===0x0){_0x4bd6e7[_0xd6ea45(0xc43)]=_0xd6ea45(0x377);return;}const _0x22a240=[..._0x1be300[_0xd6ea45(0x2be)]][_0xd6ea45(0x6c9)](),_0x299915=_0x22a240['slice'](0x0,_0x3b9454);_0x299915[_0xd6ea45(0xf99)](_0x4d1282=>{const _0x297137=_0xd6ea45,_0x78fdb4=_0xff69f2(_0x4d1282);_0x4bd6e7[_0x297137(0x998)](_0x78fdb4);}),_0xf09860=_0x299915[_0xd6ea45(0x9a1)],_0x22a240[_0xd6ea45(0x9a1)]>_0xf09860&&appendLoadMoreThoughtsButton(_0x4bd6e7);}async function _0x4e6d47(){const _0x5771d9=_0x475790;if(_0xca1dd0)return;_0xca1dd0=!![];const _0x419ac5=document[_0x5771d9(0x2ec)]('thoughts-history-list'),_0x324aba=_0x28f30a[_0x5771d9(0x6ce)][_0x28f30a['activeChatId']];if(!_0x324aba){_0xca1dd0=![];return;}_0x5d72d6(_0x419ac5,_0x5771d9(0xe39)),await new Promise(_0x1b5ec3=>setTimeout(_0x1b5ec3,0x1f4));const _0x19d96a=[..._0x324aba['thoughtsHistory']][_0x5771d9(0x6c9)](),_0x3d6ecf=_0x19d96a['length'],_0x411b10=_0xf09860,_0x3b2caf=_0xf09860+_0x3b9454,_0x429f85=_0x19d96a['slice'](_0x411b10,_0x3b2caf);_0x66d5be(_0x419ac5),_0x429f85[_0x5771d9(0xf99)](_0x48b7fe=>{const _0xf289da=_0x5771d9,_0x186cac=_0xff69f2(_0x48b7fe);_0x419ac5[_0xf289da(0x998)](_0x186cac);}),_0xf09860+=_0x429f85[_0x5771d9(0x9a1)],_0xca1dd0=![];}function _0xff69f2(_0x4846f6){const _0x3e1aa7=_0x475790,_0x5ed2d1=document['createElement'](_0x3e1aa7(0xaa5));_0x5ed2d1[_0x3e1aa7(0xdd1)]=_0x3e1aa7(0x286);const _0x3056c4=new Date(_0x4846f6['timestamp']),_0x1acf48=_0x3056c4['getFullYear']()+'-'+String(_0x3056c4[_0x3e1aa7(0xa8f)]()+0x1)[_0x3e1aa7(0x58e)](0x2,'0')+'-'+String(_0x3056c4[_0x3e1aa7(0x3c7)]())['padStart'](0x2,'0')+'\x20'+String(_0x3056c4['getHours']())[_0x3e1aa7(0x58e)](0x2,'0')+':'+String(_0x3056c4[_0x3e1aa7(0xbc9)]())['padStart'](0x2,'0');return _0x5ed2d1[_0x3e1aa7(0xc43)]=_0x3e1aa7(0x11fb)+_0x4846f6[_0x3e1aa7(0x69a)]+'\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>'+_0x1acf48+_0x3e1aa7(0x427)+_0x4846f6[_0x3e1aa7(0x28a)]+_0x3e1aa7(0x4e0)+_0x4846f6['randomJottings']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x5ed2d1;}async function _0x18ed3d(_0x52216c){const _0x342696=_0x475790,_0x1c475e=_0x52216c[_0x342696(0x1104)][_0x342696(0x8d6)][0x0];if(!_0x1c475e)return;try{let _0x32309f,_0x50a912=null;if(_0x1c475e[_0x342696(0xe36)][_0x342696(0xa64)](_0x342696(0x44e))){const _0x3d7c5f=await _0x1c475e[_0x342696(0x10ca)]();_0x32309f=JSON['parse'](_0x3d7c5f);}else{if(_0x1c475e[_0x342696(0xe36)]['endsWith'](_0x342696(0xbb2))){const _0x3bdcf6=await _0x1c475e[_0x342696(0x7be)]();_0x32309f=await _0x3c0e5c(_0x3bdcf6),_0x50a912=await new Promise(_0x119b2a=>{const _0x52857b=_0x342696,_0x2985de=new FileReader();_0x2985de[_0x52857b(0xf2d)]=()=>_0x119b2a(_0x2985de['result']),_0x2985de[_0x52857b(0x60e)](_0x1c475e);});}else throw new Error(_0x342696(0xe1a));}await _0x41b3cd(_0x32309f,_0x50a912);}catch(_0x32b5f5){console['error'](_0x342696(0x8c3),_0x32b5f5),await _0x34d596(_0x342696(0x493),_0x342696(0x110c)+_0x32b5f5[_0x342696(0x13bc)]);}finally{_0x52216c['target']['value']=null;}}function _0x3c0e5c(_0x403629){return new Promise((_0x510ee3,_0x447736)=>{const _0x4645fd=_0x1937,_0x263080=new DataView(_0x403629);if(_0x263080[_0x4645fd(0xd6a)](0x0)!==0x89504e47||_0x263080[_0x4645fd(0xd6a)](0x4)!==0xd0a1a0a)return _0x447736(new Error(_0x4645fd(0x10d8)));let _0x590ab5=0x8;const _0x1ed983=new TextDecoder();while(_0x590ab5<_0x263080['byteLength']){const _0x5df887=_0x263080[_0x4645fd(0xd6a)](_0x590ab5),_0xbcec5e=_0x1ed983[_0x4645fd(0x8ea)](_0x403629[_0x4645fd(0x225)](_0x590ab5+0x4,_0x590ab5+0x8));if(_0xbcec5e===_0x4645fd(0x1434)){const _0x398304=new Uint8Array(_0x403629,_0x590ab5+0x8,_0x5df887),_0x31656a=_0x398304[_0x4645fd(0x6d3)](0x0);if(_0x31656a!==-0x1){const _0x2a39d3=_0x1ed983[_0x4645fd(0x8ea)](_0x398304['slice'](0x0,_0x31656a));if(_0x2a39d3==='chara'){const _0x1bfdf8=_0x1ed983[_0x4645fd(0x8ea)](_0x398304[_0x4645fd(0x225)](_0x31656a+0x1));try{const _0x4d3c65=atob(_0x1bfdf8),_0x91fe19=new Uint8Array(_0x4d3c65['length']);for(let _0x4c2776=0x0;_0x4c2776<_0x4d3c65[_0x4645fd(0x9a1)];_0x4c2776++){_0x91fe19[_0x4c2776]=_0x4d3c65[_0x4645fd(0xe26)](_0x4c2776);}const _0x5dd5ae=new TextDecoder(_0x4645fd(0x118f))['decode'](_0x91fe19);_0x510ee3(JSON[_0x4645fd(0xd91)](_0x5dd5ae));return;}catch(_0x18b318){return _0x447736(new Error(_0x4645fd(0xa08)+_0x18b318['message']));}}}}_0x590ab5+=0x4+0x4+_0x5df887+0x4;}_0x447736(new Error(_0x4645fd(0x1385)));});}function _0x427cc1(_0x43f1a1){const _0x343969=_0x475790;if(_0x43f1a1[_0x343969(0x1418)]?.[_0x343969(0x1139)]?.[_0x343969(0x127b)]?.[_0x343969(0x9a1)]>0x0)return console['log'](_0x343969(0xd78)),_0x43f1a1[_0x343969(0x1418)]['character_book'][_0x343969(0x127b)];if(_0x43f1a1[_0x343969(0x867)]?.[_0x343969(0x1139)]?.[_0x343969(0x127b)]?.[_0x343969(0x9a1)]>0x0)return console[_0x343969(0x415)](_0x343969(0x1354)),_0x43f1a1[_0x343969(0x867)][_0x343969(0x1139)][_0x343969(0x127b)];if(_0x43f1a1[_0x343969(0x1418)]?.[_0x343969(0x867)]?.[_0x343969(0x1139)]?.['entries']?.[_0x343969(0x9a1)]>0x0)return console[_0x343969(0x415)](_0x343969(0x1c2)),_0x43f1a1[_0x343969(0x1418)][_0x343969(0x867)][_0x343969(0x1139)]['entries'];const _0x78be83=[_0x343969(0x1139),_0x343969(0xab0),'world_info','char_book'];for(const _0x289af1 of _0x78be83){if(_0x43f1a1[_0x289af1]?.[_0x343969(0x127b)]?.[_0x343969(0x9a1)]>0x0)return console[_0x343969(0x415)](_0x343969(0x188)+_0x289af1+_0x343969(0x9a0)),_0x43f1a1[_0x289af1][_0x343969(0x127b)];}return console[_0x343969(0x415)](_0x343969(0xb30)),null;}async function _0x41b3cd(_0x37c4ca,_0x3d9376=null){const _0x298292=_0x475790,_0x379375=_0x37c4ca[_0x298292(0x1418)]||_0x37c4ca;if(!_0x379375[_0x298292(0xe36)])throw new Error(_0x298292(0xcce));let _0x20c073=null;const _0x1efdc5=_0x427cc1(_0x37c4ca);if(_0x1efdc5){const _0x3dc653=_0x1efdc5[_0x298292(0xebc)](_0x5dc673=>_0x5dc673[_0x298292(0x400)]&&_0x5dc673[_0x298292(0x1047)])[_0x298292(0x11c6)](_0x1d4fb9=>({'keys':_0x1d4fb9[_0x298292(0xf6b)]||[],'comment':_0x1d4fb9[_0x298292(0x70d)]||'','content':_0x1d4fb9['content'][_0x298292(0x13ed)](/<memory>|<\/memory>/g,'')[_0x298292(0x97e)]()}));if(_0x3dc653[_0x298292(0x9a1)]>0x0){const _0x41f574={'id':_0x298292(0x944)+Date[_0x298292(0x487)](),'name':_0x379375[_0x298292(0xe36)]+_0x298292(0x1086),'content':_0x3dc653,'categoryId':null};await _0x5b9d83[_0x298292(0x13b9)][_0x298292(0xe82)](_0x41f574),_0x28f30a['worldBooks']['push'](_0x41f574),_0x20c073=_0x41f574['id'];}}let _0x1581f7=_0x379375[_0x298292(0x9cc)]||_0x37c4ca[_0x298292(0x9cc)]||'无';_0x1581f7=_0x1581f7[_0x298292(0x13ed)](/```yaml/g,'')[_0x298292(0x13ed)](/```/g,'')[_0x298292(0x13ed)](/<\/?info>/g,'')[_0x298292(0x13ed)](/<\/?character>/g,'')['replace'](/<\/?writing_rule>/g,'')['replace'](/\[OOC：.*?\]/g,'')[_0x298292(0x97e)]();let _0x25bf31=_0x298292(0xd5c)+_0x1581f7+'\x0a\x0a';if(_0x379375[_0x298292(0x637)])_0x25bf31+=_0x298292(0xd6f)+_0x379375[_0x298292(0x637)]+'\x0a\x0a';if(_0x379375[_0x298292(0x8ff)])_0x25bf31+=_0x298292(0x1e7)+_0x379375[_0x298292(0x8ff)]+'\x0a\x0a';if(_0x379375[_0x298292(0x14fb)])_0x25bf31+=_0x298292(0xbd1)+_0x379375[_0x298292(0x14fb)]+'\x0a\x0a';const _0x59aba5=_0x379375[_0x298292(0xe36)],_0x4d2da8=_0x379375[_0x298292(0xe36)],_0x2fc93c=_0x298292(0xc1e)+Date[_0x298292(0x487)](),_0x190844={'id':_0x2fc93c,'name':_0x59aba5[_0x298292(0x97e)](),'originalName':_0x4d2da8[_0x298292(0x97e)](),'isGroup':![],'relationship':{'status':_0x298292(0xab9)},'status':{'text':'在线','lastUpdate':Date[_0x298292(0x487)](),'isBusy':![]},'settings':{'aiPersona':_0x25bf31,'myPersona':_0x298292(0x91c),'maxMemory':0xa,'aiAvatar':_0x825cf1,'myAvatar':_0x825cf1,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':_0x20c073?[_0x20c073]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0x3d9376&&(_0x190844[_0x298292(0x362)][_0x298292(0xe91)]=_0x3d9376,_0x190844[_0x298292(0x362)][_0x298292(0x78c)][_0x298292(0x367)]({'name':'默认头像','url':_0x3d9376}));const _0x34abbe=_0x379375['first_mes']||_0x37c4ca['first_mes'];if(_0x34abbe&&typeof _0x34abbe===_0x298292(0x863)){const _0x29aede=document[_0x298292(0x14ae)](_0x298292(0xaa5));_0x29aede['innerHTML']=_0x34abbe;const _0x598a55=(_0x29aede[_0x298292(0x15f)]||_0x29aede[_0x298292(0xc02)]||'')[_0x298292(0x13ed)](/原作者UR.*?开局/s,'')[_0x298292(0x97e)]();_0x598a55&&_0x190844['history']['push']({'role':'assistant','senderName':_0x190844[_0x298292(0x66c)],'content':_0x598a55,'timestamp':Date[_0x298292(0x487)]()});}_0x28f30a[_0x298292(0x6ce)][_0x2fc93c]=_0x190844,await _0x5b9d83[_0x298292(0x6ce)]['put'](_0x190844),_0x5db8a3();let _0x58c22e=_0x298292(0x595)+_0x190844[_0x298292(0xe36)]+_0x298292(0x10e7);_0x20c073&&(_0x58c22e+=_0x298292(0xca6)),await _0x34d596(_0x298292(0x1110),_0x58c22e);}async function _0x5d6742(){const _0x5dcf30=_0x475790;if(!_0x28f30a['activeChatId'])return;const _0x1424c6=_0x28f30a[_0x5dcf30(0x6ce)][_0x28f30a['activeChatId']],_0x5ab27f=_0x1424c6[_0x5dcf30(0x362)][_0x5dcf30(0x87b)];if(!_0x5ab27f||_0x5ab27f[_0x5dcf30(0x9a1)]===0x0){alert('这个角色没有可用的备选开场白。');return;}const _0x2f6263=_0x5ab27f[_0x5dcf30(0x11c6)]((_0x427c74,_0x16a18c)=>{const _0x40a1a6=_0x5dcf30,_0xb0a628=_0x427c74['replace'](/<[^>]*>/g,'')[_0x40a1a6(0x97e)]()[_0x40a1a6(0xa6b)](0x0,0x14);return{'text':_0x40a1a6(0x542)+(_0x16a18c+0x1)+':\x20'+_0xb0a628+_0x40a1a6(0x4e6),'value':_0x16a18c};}),_0x3f9f13=await _0x3d2f35(_0x5dcf30(0xbe2),_0x2f6263);if(_0x3f9f13!==null){const _0x8fa830=await _0x4436ba('确认操作',_0x5dcf30(0x1212),{'confirmButtonClass':_0x5dcf30(0xd8f),'confirmText':_0x5dcf30(0xf85)});if(_0x8fa830){const _0x5e192b=_0x5ab27f[_0x3f9f13],_0x32864d={'role':_0x5dcf30(0x6d9),'senderName':_0x1424c6[_0x5dcf30(0x66c)],'content':_0x5e192b,'timestamp':Date[_0x5dcf30(0x487)]()};_0x1424c6[_0x5dcf30(0x12c3)]=[_0x32864d],await _0x5b9d83[_0x5dcf30(0x6ce)]['put'](_0x1424c6),_0xc55746(_0x1424c6['id']),document[_0x5dcf30(0x2ec)](_0x5dcf30(0x144a))['classList'][_0x5dcf30(0x1424)](_0x5dcf30(0x149d)),await _0x34d596('成功',_0x5dcf30(0xdda));}}}function _0x3c5856(_0x2387dc={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x47d523=_0x475790,_0x348ab2=document[_0x47d523(0x14ae)](_0x47d523(0xaa5));_0x348ab2[_0x47d523(0xdd1)]=_0x47d523(0x929);const _0x218fed=_0x2387dc[_0x47d523(0x400)]!==![]?_0x47d523(0x13b8):'';return _0x348ab2[_0x47d523(0xc43)]=_0x47d523(0x136d)+_0x218fed+_0x47d523(0x481)+(_0x2387dc[_0x47d523(0x70d)]||'')+_0x47d523(0x153a)+(_0x2387dc[_0x47d523(0xf6b)]||[])[_0x47d523(0xbad)](',\x20')+'\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>'+(_0x2387dc[_0x47d523(0x1047)]||'')+_0x47d523(0x5c4),_0x348ab2[_0x47d523(0x765)](_0x47d523(0x81c))[_0x47d523(0xf79)](_0x47d523(0x1177),()=>{const _0x504229=_0x47d523;_0x348ab2[_0x504229(0x1424)]();}),_0x348ab2;}async function _0x27d058(){const _0x27fc62=_0x475790;if(!_0x28f30a['activeChatId'])return;const _0x3cc99e=_0x28f30a[_0x27fc62(0x11b9)],_0x299413=document[_0x27fc62(0x2ec)](_0x27fc62(0x12cf));if(!_0x299413[_0x27fc62(0xff6)][_0x27fc62(0xe9a)]('visible')){const _0x1669e0=document[_0x27fc62(0x765)](_0x27fc62(0x1024));_0x299413['style'][_0x27fc62(0xdd5)]=_0x1669e0[_0x27fc62(0x361)]+'px',_0x299413[_0x27fc62(0x589)][_0x27fc62(0x701)]=_0x27fc62(0x13f7),(!_0x484920[_0x3cc99e]||!_0x484920[_0x3cc99e][_0x27fc62(0xffc)])&&_0xb0f872(_0x3cc99e),_0x3ca98d(_0x3cc99e),setTimeout(async()=>{const _0x2c2b20=_0x27fc62;_0x299413[_0x2c2b20(0xff6)]['add']('visible');const _0x29128d={'role':_0x2c2b20(0x10a7),'content':_0x2c2b20(0x679),'timestamp':Date[_0x2c2b20(0x487)](),'isHidden':!![]};_0x28f30a[_0x2c2b20(0x6ce)][_0x3cc99e][_0x2c2b20(0x12c3)][_0x2c2b20(0x367)](_0x29128d),await _0x5b9d83[_0x2c2b20(0x6ce)][_0x2c2b20(0x7c3)](_0x28f30a[_0x2c2b20(0x6ce)][_0x3cc99e]);},0xa);}else await _0x290b85();}async function _0x290b85(){const _0x1ae7d7=_0x475790;if(!_0x28f30a['activeChatId'])return;const _0x49a2ed=_0x28f30a[_0x1ae7d7(0x11b9)],_0x5baa45=document[_0x1ae7d7(0x2ec)](_0x1ae7d7(0x12cf));_0x5baa45[_0x1ae7d7(0xff6)][_0x1ae7d7(0x1424)](_0x1ae7d7(0x149d)),setTimeout(()=>{const _0x1c1733=_0x1ae7d7;_0x5baa45[_0x1c1733(0x589)][_0x1c1733(0x701)]=_0x1c1733(0x5b1);},0x12c);if(_0x484920[_0x49a2ed]){_0x484920[_0x49a2ed][_0x1ae7d7(0xffc)]=![];const _0x364164={'role':_0x1ae7d7(0x10a7),'content':'[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','timestamp':Date[_0x1ae7d7(0x487)](),'isHidden':!![]};_0x28f30a[_0x1ae7d7(0x6ce)][_0x49a2ed][_0x1ae7d7(0x12c3)]['push'](_0x364164),await _0x5b9d83[_0x1ae7d7(0x6ce)]['put'](_0x28f30a[_0x1ae7d7(0x6ce)][_0x49a2ed]);}}function _0xb0f872(_0x4887e5){const _0x4aebc1=_0x475790,_0x173bab=document['getElementById'](_0x4aebc1(0x7cc)),_0x37a9f7=document['getElementById'](_0x4aebc1(0x12cf)),_0x2f690a=document[_0x4aebc1(0x2ec)](_0x4aebc1(0x346)),_0x29e892=_0x37a9f7[_0x4aebc1(0x144c)]-0x28,_0x368d77=_0x37a9f7[_0x4aebc1(0x361)]-_0x2f690a[_0x4aebc1(0x361)]-0x28,_0x3dac56=Math['floor'](Math['min'](_0x29e892,_0x368d77)),_0x4f8daa=0xf,_0x4c703e=Math[_0x4aebc1(0x5f8)](_0x3dac56/_0x4f8daa),_0x4d741c=_0x4c703e*_0x4f8daa;_0x173bab[_0x4aebc1(0xeb4)]=_0x4d741c,_0x173bab['height']=_0x4d741c,_0x484920[_0x4887e5]={'isActive':!![],'board':Array(_0x4f8daa)[_0x4aebc1(0x172)](0x0)[_0x4aebc1(0x11c6)](()=>Array(_0x4f8daa)['fill'](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0x4f8daa,'CELL_SIZE':_0x4c703e};}function _0x3ca98d(_0x2e025b){const _0x1bd930=_0x475790,_0x3aaf0c=_0x484920[_0x2e025b];if(!_0x3aaf0c)return;const _0x4ac3b9=document[_0x1bd930(0x2ec)](_0x1bd930(0x7cc)),_0xecca6c=_0x4ac3b9[_0x1bd930(0xe21)]('2d'),{GRID_SIZE:_0x130244,CELL_SIZE:_0x1a10f4}=_0x3aaf0c,_0x19fe19=_0x1a10f4/0x2;_0xecca6c[_0x1bd930(0x87a)](0x0,0x0,_0x4ac3b9['width'],_0x4ac3b9[_0x1bd930(0x11d3)]),_0xecca6c[_0x1bd930(0xc00)]=_0x1bd930(0xdc4),_0xecca6c[_0x1bd930(0xa12)](0x0,0x0,_0x4ac3b9[_0x1bd930(0xeb4)],_0x4ac3b9[_0x1bd930(0x11d3)]),_0xecca6c[_0x1bd930(0xeaa)]='#5b3a29',_0xecca6c[_0x1bd930(0x720)]=0x1;for(let _0x450e60=0x0;_0x450e60<_0x130244;_0x450e60++){_0xecca6c['beginPath'](),_0xecca6c['moveTo'](_0x19fe19,_0x19fe19+_0x450e60*_0x1a10f4),_0xecca6c[_0x1bd930(0xe0b)](_0x4ac3b9['width']-_0x19fe19,_0x19fe19+_0x450e60*_0x1a10f4),_0xecca6c[_0x1bd930(0xc60)](),_0xecca6c['beginPath'](),_0xecca6c[_0x1bd930(0xaf7)](_0x19fe19+_0x450e60*_0x1a10f4,_0x19fe19),_0xecca6c[_0x1bd930(0xe0b)](_0x19fe19+_0x450e60*_0x1a10f4,_0x4ac3b9[_0x1bd930(0x11d3)]-_0x19fe19),_0xecca6c[_0x1bd930(0xc60)]();}for(let _0x448b85=0x0;_0x448b85<_0x130244;_0x448b85++){for(let _0x464790=0x0;_0x464790<_0x130244;_0x464790++){_0x3aaf0c[_0x1bd930(0x6a5)][_0x448b85][_0x464790]!==0x0&&_0xb20d0b(_0xecca6c,_0x464790,_0x448b85,_0x3aaf0c[_0x1bd930(0x6a5)][_0x448b85][_0x464790],_0x3aaf0c);}}}function _0xb20d0b(_0x496011,_0x456a4f,_0x1918c3,_0x4d528f,_0x1e36f8){const _0x4bba45=_0x475790,{CELL_SIZE:_0xceb5d5}=_0x1e36f8,_0x3092e5=_0xceb5d5/0x2,_0x40c345=_0xceb5d5/0x2-0x2;_0x496011['beginPath'](),_0x496011['arc'](_0x3092e5+_0x456a4f*_0xceb5d5,_0x3092e5+_0x1918c3*_0xceb5d5,_0x40c345,0x0,0x2*Math['PI']),_0x4d528f===0x1?_0x496011[_0x4bba45(0xc00)]=_0x4bba45(0x369):_0x496011[_0x4bba45(0xc00)]=_0x4bba45(0x8dd),_0x496011[_0x4bba45(0x172)]();}function _0xce7651(_0x189c58){const _0x1ec670=_0x475790,_0x1ceeff=_0x28f30a['activeChatId'],_0x38b1fb=_0x484920[_0x1ceeff];if(!_0x38b1fb||_0x38b1fb[_0x1ec670(0x104b)]||_0x38b1fb[_0x1ec670(0x100c)]!==0x1)return;const _0x266f67=document[_0x1ec670(0x2ec)](_0x1ec670(0x7cc)),_0x573f74=_0x266f67[_0x1ec670(0xe21)]('2d'),_0xef8346=_0x266f67[_0x1ec670(0x410)](),_0x5a12db=_0x189c58[_0x1ec670(0xdad)]-_0xef8346[_0x1ec670(0xd02)],_0x33209c=_0x189c58[_0x1ec670(0x745)]-_0xef8346[_0x1ec670(0xdd5)],_0x8ebd14=Math['round']((_0x5a12db-_0x38b1fb[_0x1ec670(0x1008)]/0x2)/_0x38b1fb['CELL_SIZE']),_0x3d4466=Math[_0x1ec670(0x8f9)]((_0x33209c-_0x38b1fb[_0x1ec670(0x1008)]/0x2)/_0x38b1fb[_0x1ec670(0x1008)]);_0x3ca98d(_0x1ceeff);if(_0x8ebd14>=0x0&&_0x8ebd14<_0x38b1fb['GRID_SIZE']&&_0x3d4466>=0x0&&_0x3d4466<_0x38b1fb[_0x1ec670(0x1351)]&&_0x38b1fb[_0x1ec670(0x6a5)][_0x3d4466][_0x8ebd14]===0x0){const _0x3d9065=_0x38b1fb['CELL_SIZE']/0x2-0x2;_0x573f74[_0x1ec670(0x150a)](),_0x573f74[_0x1ec670(0x1018)](_0x38b1fb[_0x1ec670(0x1008)]/0x2+_0x8ebd14*_0x38b1fb['CELL_SIZE'],_0x38b1fb['CELL_SIZE']/0x2+_0x3d4466*_0x38b1fb[_0x1ec670(0x1008)],_0x3d9065,0x0,0x2*Math['PI']),_0x573f74[_0x1ec670(0xc00)]=_0x1ec670(0xf46),_0x573f74['fill']();}}function _0x4a89d7(_0x4727f6){const _0x2e6edb=_0x475790,_0x400dea=_0x28f30a[_0x2e6edb(0x11b9)],_0x5d4d08=_0x484920[_0x400dea];if(!_0x5d4d08||_0x5d4d08[_0x2e6edb(0x104b)]||_0x5d4d08['currentPlayer']!==0x1)return;const _0x5f569e=document['getElementById'](_0x2e6edb(0x7cc)),_0xe91574=_0x5f569e[_0x2e6edb(0x410)](),_0x5e0208=_0x4727f6['clientX']-_0xe91574[_0x2e6edb(0xd02)],_0x5f50e8=_0x4727f6['clientY']-_0xe91574[_0x2e6edb(0xdd5)],_0x15a5f1=Math[_0x2e6edb(0x8f9)]((_0x5e0208-_0x5d4d08['CELL_SIZE']/0x2)/_0x5d4d08[_0x2e6edb(0x1008)]),_0x310ab3=Math[_0x2e6edb(0x8f9)]((_0x5f50e8-_0x5d4d08[_0x2e6edb(0x1008)]/0x2)/_0x5d4d08[_0x2e6edb(0x1008)]);_0x15a5f1>=0x0&&_0x15a5f1<_0x5d4d08[_0x2e6edb(0x1351)]&&_0x310ab3>=0x0&&_0x310ab3<_0x5d4d08[_0x2e6edb(0x1351)]&&_0x5d4d08['board'][_0x310ab3][_0x15a5f1]===0x0&&(_0x5d4d08[_0x2e6edb(0x6a5)][_0x310ab3][_0x15a5f1]=0x1,_0x5d4d08[_0x2e6edb(0x12c3)][_0x2e6edb(0x367)]({'x':_0x15a5f1,'y':_0x310ab3,'player':0x1}),_0x3ca98d(_0x400dea),_0x1ebf02(_0x15a5f1,_0x310ab3,0x1,_0x5d4d08)?(_0x5d4d08[_0x2e6edb(0x104b)]=!![],setTimeout(()=>alert('恭喜你，你赢了！'),0x64),_0x235708(_0x2e6edb(0xcc9))):_0x5d4d08[_0x2e6edb(0x100c)]=0x2);}function _0x40299d(_0x4ff05f,_0x3f6631=![]){const _0x477126=_0x475790,_0xbc1f53=_0x28f30a[_0x477126(0x11b9)],_0xfceeb7=_0x484920[_0xbc1f53];if(!_0xfceeb7||_0xfceeb7[_0x477126(0x104b)])return;if(!_0x3f6631&&_0xfceeb7['currentPlayer']!==0x2)return;const {x:_0x2b6d37,y:_0x1b8a6a}=_0x4ff05f;_0x2b6d37>=0x0&&_0x2b6d37<_0xfceeb7[_0x477126(0x1351)]&&_0x1b8a6a>=0x0&&_0x1b8a6a<_0xfceeb7[_0x477126(0x1351)]&&_0xfceeb7[_0x477126(0x6a5)][_0x1b8a6a][_0x2b6d37]===0x0?(_0xfceeb7[_0x477126(0x6a5)][_0x1b8a6a][_0x2b6d37]=0x2,_0xfceeb7['history'][_0x477126(0x367)]({'x':_0x2b6d37,'y':_0x1b8a6a,'player':0x2}),_0x3ca98d(_0xbc1f53),_0x1ebf02(_0x2b6d37,_0x1b8a6a,0x2,_0xfceeb7)?(_0xfceeb7['isGameOver']=!![],setTimeout(()=>alert(_0x477126(0x789)),0x64),_0x235708('ai')):_0xfceeb7[_0x477126(0x100c)]=0x1):(console['warn'](_0x477126(0xc49),_0x4ff05f),_0xfceeb7[_0x477126(0x100c)]=0x1);}function _0x1ebf02(_0x1aa76b,_0x4402e0,_0x4aa275,_0x3c0eac){const {board:_0x5bc86e,GRID_SIZE:_0x5978f2}=_0x3c0eac,_0x2dcd69=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x85ae9d,_0x1b2d72]of _0x2dcd69){let _0x40d383=0x1;for(let _0x2afa5a=0x1;_0x2afa5a<0x5;_0x2afa5a++){const _0x18469c=_0x1aa76b+_0x2afa5a*_0x85ae9d,_0x2e065f=_0x4402e0+_0x2afa5a*_0x1b2d72;if(_0x18469c>=0x0&&_0x18469c<_0x5978f2&&_0x2e065f>=0x0&&_0x2e065f<_0x5978f2&&_0x5bc86e[_0x2e065f][_0x18469c]===_0x4aa275)_0x40d383++;else break;}for(let _0x163196=0x1;_0x163196<0x5;_0x163196++){const _0x39c0ef=_0x1aa76b-_0x163196*_0x85ae9d,_0x5cbc42=_0x4402e0-_0x163196*_0x1b2d72;if(_0x39c0ef>=0x0&&_0x39c0ef<_0x5978f2&&_0x5cbc42>=0x0&&_0x5cbc42<_0x5978f2&&_0x5bc86e[_0x5cbc42][_0x39c0ef]===_0x4aa275)_0x40d383++;else break;}if(_0x40d383>=0x5)return!![];}return![];}function _0x204b6c(_0x171c84){const _0xd8db72=_0x475790;if(!_0x171c84||!_0x171c84[_0xd8db72(0xffc)])return'';let _0x26889e=_0xd8db72(0x53a);_0x26889e+=_0x171c84[_0xd8db72(0x6a5)]['map'](_0x36aaf0=>_0x36aaf0[_0xd8db72(0xbad)]('\x20'))['join']('\x0a');let _0x406130=_0xd8db72(0xb87);return _0x406130+=_0x171c84['history'][_0xd8db72(0x11c6)](_0x5d9b9b=>'玩家'+_0x5d9b9b['player']+'下在('+_0x5d9b9b['x']+','+_0x5d9b9b['y']+')')[_0xd8db72(0xbad)](_0xd8db72(0xb1d)),_0xd8db72(0xfab)+_0x26889e+_0xd8db72(0xd13)+_0x406130+_0xd8db72(0x9d3);}async function _0x235708(_0x3daaf6){const _0x5cc606=_0x475790,_0x4453db=_0x28f30a[_0x5cc606(0x11b9)],_0x8175d9=_0x28f30a[_0x5cc606(0x6ce)][_0x4453db];if(!_0x8175d9)return;const _0x2f5eb6=_0x8175d9[_0x5cc606(0x1423)]?_0x8175d9[_0x5cc606(0x362)][_0x5cc606(0xa28)]||'我':'我',_0x1e6c16=_0x8175d9['isGroup']?_0x5cc606(0xe71):_0x8175d9['name'],_0x15e3b8=_0x3daaf6===_0x5cc606(0xcc9)?_0x2f5eb6:_0x1e6c16,_0x4cb502=_0x3daaf6===_0x5cc606(0xcc9)?'你输了':_0x5cc606(0x275),_0x96438a=_0x5cc606(0x1408)+_0x15e3b8+_0x5cc606(0x1562)+_0x4cb502+'。]',_0x3a62d9={'role':'system','content':_0x96438a,'timestamp':Date['now'](),'isHidden':!![]};_0x8175d9[_0x5cc606(0x12c3)][_0x5cc606(0x367)](_0x3a62d9),await _0x5b9d83[_0x5cc606(0x6ce)][_0x5cc606(0x7c3)](_0x8175d9),console['log']('游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20'+_0x3daaf6);}let _0x2228a2=![];async function _0x275258(){const _0x32cea6=_0x475790,_0x96cdb7=document[_0x32cea6(0x2ec)](_0x32cea6(0x129e)),_0x498109=document[_0x32cea6(0x2ec)](_0x32cea6(0x723)),_0x23bd74=document['getElementById'](_0x32cea6(0x11e6));_0x96cdb7[_0x32cea6(0xc43)]='',_0x498109['innerHTML']='';const [_0x52e922,_0x4843cf]=await Promise[_0x32cea6(0xa92)]([_0x5b9d83[_0x32cea6(0x120e)]['toArray'](),_0x5b9d83[_0x32cea6(0x1117)][_0x32cea6(0x106d)]('name')['toArray']()]);_0x23bd74[_0x32cea6(0xff6)][_0x32cea6(0x14c8)](_0x32cea6(0x919),_0x2228a2);const _0x23832c=document[_0x32cea6(0x14ae)](_0x32cea6(0xd5a));_0x23832c[_0x32cea6(0xdd1)]=_0x32cea6(0x1203),_0x23832c[_0x32cea6(0x15f)]='全部',_0x23832c[_0x32cea6(0xe93)]['categoryId']=_0x32cea6(0xa92);if(activeShoppingCategoryId===_0x32cea6(0xa92))_0x23832c[_0x32cea6(0xff6)][_0x32cea6(0xe82)](_0x32cea6(0xd43));_0x498109[_0x32cea6(0x998)](_0x23832c),_0x4843cf[_0x32cea6(0xf99)](_0x19b35c=>{const _0x52017f=_0x32cea6,_0x17707b=document[_0x52017f(0x14ae)](_0x52017f(0xd5a));_0x17707b[_0x52017f(0xdd1)]=_0x52017f(0x1203),_0x17707b['textContent']=_0x19b35c['name'],_0x17707b[_0x52017f(0xe93)][_0x52017f(0x10ce)]=_0x19b35c['id'];if(activeShoppingCategoryId===_0x19b35c['id'])_0x17707b[_0x52017f(0xff6)][_0x52017f(0xe82)](_0x52017f(0xd43));_0x498109['appendChild'](_0x17707b);});let _0x32878b;activeShoppingCategoryId===_0x32cea6(0xa92)?_0x32878b=_0x52e922:_0x32878b=_0x52e922[_0x32cea6(0xebc)](_0x4608e0=>_0x4608e0['categoryId']===activeShoppingCategoryId);if(_0x32878b[_0x32cea6(0x9a1)]===0x0){const _0x2f3ae2=activeShoppingCategoryId==='all'?'商店空空如也，点击“管理”添加商品吧！':_0x32cea6(0x46c);_0x96cdb7['innerHTML']='<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>'+_0x2f3ae2+_0x32cea6(0x1251);return;}_0x32878b[_0x32cea6(0xf99)](_0x3b3c93=>{const _0x539faf=_0x32cea6,_0x4da7b4=document[_0x539faf(0x14ae)]('div');_0x4da7b4['className']='product-item',_0x4da7b4[_0x539faf(0xe93)]['id']=_0x3b3c93['id'];const _0xd5bf3d=_0x539faf(0xda8);_0x4da7b4[_0x539faf(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xd5bf3d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3b3c93[_0x539faf(0x6c6)]+_0x539faf(0x4f2)+_0x3b3c93[_0x539faf(0xe36)]+_0x539faf(0xef9)+_0x3b3c93[_0x539faf(0x1309)]['toFixed'](0x2)+_0x539faf(0x154e),_0x96cdb7['appendChild'](_0x4da7b4);});}function _0x44125d(_0x3f5aec){activeShoppingCategoryId=_0x3f5aec,_0x275258(),_0x1b1a8c();}function _0x1b1a8c(){const _0x1f46b9=_0x475790,_0xd6b62=document[_0x1f46b9(0x2ec)](_0x1f46b9(0xe02));if(!_0xd6b62)return;const _0x35869a=_0x2228a2&&activeShoppingCategoryId!==_0x1f46b9(0xa92);_0xd6b62[_0x1f46b9(0x589)][_0x1f46b9(0x701)]=_0x35869a?_0x1f46b9(0xc67):'none';}async function _0x4db1ae(){const _0x5c0b0e=_0x475790;if(activeShoppingCategoryId===_0x5c0b0e(0xa92))return;const _0x41b72e=activeShoppingCategoryId,_0x296fa4=await _0x5b9d83[_0x5c0b0e(0x1117)]['get'](_0x41b72e);if(!_0x296fa4){alert('错误：找不到要删除的分类。');return;}const _0x12f23b=_0x5c0b0e(0x74b)+_0x296fa4[_0x5c0b0e(0xe36)]+'”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。',_0x1c1a44=await _0x4436ba(_0x5c0b0e(0x5ba),_0x12f23b,{'confirmButtonClass':_0x5c0b0e(0xd8f),'confirmText':_0x5c0b0e(0x10d9)});_0x1c1a44&&(await _0x3e3223(_0x41b72e),activeShoppingCategoryId=_0x5c0b0e(0xa92),await _0x275258(),_0x1b1a8c(),await _0x34d596('成功',_0x5c0b0e(0x2bd)+_0x296fa4['name']+_0x5c0b0e(0x1c7)));}async function _0x79b711(){const _0x344b87=_0x475790;activeShoppingCategoryId=_0x344b87(0xa92),await _0x275258(),_0x17ec27(_0x344b87(0x11e6)),_0x1b1a8c();}async function _0x275258(){const _0x212443=_0x475790,_0x2a8433=document[_0x212443(0x2ec)]('product-grid'),_0x2b5e38=document[_0x212443(0x2ec)]('product-category-tabs'),_0x420893=document[_0x212443(0x2ec)]('shopping-screen');_0x2a8433['innerHTML']='',_0x2b5e38[_0x212443(0xc43)]='';const [_0x3a451e,_0x2adc5b]=await Promise[_0x212443(0xa92)]([_0x5b9d83[_0x212443(0x120e)][_0x212443(0x14b5)](),_0x5b9d83[_0x212443(0x1117)][_0x212443(0x106d)]('name')[_0x212443(0x14b5)]()]);_0x420893['classList']['toggle'](_0x212443(0x919),_0x2228a2);const _0x3e1621=document[_0x212443(0x14ae)]('button');_0x3e1621[_0x212443(0xdd1)]=_0x212443(0x1203),_0x3e1621['textContent']='全部',_0x3e1621['dataset'][_0x212443(0x10ce)]=_0x212443(0xa92);if(activeShoppingCategoryId===_0x212443(0xa92))_0x3e1621[_0x212443(0xff6)][_0x212443(0xe82)]('active');_0x2b5e38[_0x212443(0x998)](_0x3e1621),_0x2adc5b[_0x212443(0xf99)](_0x2e901e=>{const _0x2c7e70=_0x212443,_0x254c2c=document[_0x2c7e70(0x14ae)](_0x2c7e70(0xd5a));_0x254c2c[_0x2c7e70(0xdd1)]=_0x2c7e70(0x1203),_0x254c2c['textContent']=_0x2e901e[_0x2c7e70(0xe36)],_0x254c2c[_0x2c7e70(0xe93)][_0x2c7e70(0x10ce)]=_0x2e901e['id'];if(activeShoppingCategoryId===_0x2e901e['id'])_0x254c2c[_0x2c7e70(0xff6)][_0x2c7e70(0xe82)]('active');_0x2b5e38['appendChild'](_0x254c2c);});let _0xb2512e;activeShoppingCategoryId===_0x212443(0xa92)?_0xb2512e=_0x3a451e:_0xb2512e=_0x3a451e[_0x212443(0xebc)](_0xcb66f7=>_0xcb66f7[_0x212443(0x10ce)]===activeShoppingCategoryId);if(_0xb2512e[_0x212443(0x9a1)]===0x0){const _0x3b512e=activeShoppingCategoryId==='all'?_0x212443(0x1547):'这个分类下还没有商品哦~';_0x2a8433[_0x212443(0xc43)]=_0x212443(0x694)+_0x3b512e+_0x212443(0x1251);return;}_0xb2512e[_0x212443(0xf99)](_0x6809af=>{const _0x5ceef8=_0x212443,_0xdcfdf7=document['createElement'](_0x5ceef8(0xaa5));_0xdcfdf7[_0x5ceef8(0xdd1)]='product-item',_0xdcfdf7['dataset']['id']=_0x6809af['id'];const _0x4d51d3=_0x2228a2?_0x5ceef8(0x103f):'';_0xdcfdf7[_0x5ceef8(0xc43)]=_0x5ceef8(0xac5)+_0x4d51d3+_0x5ceef8(0x152a)+_0x6809af[_0x5ceef8(0x6c6)]+_0x5ceef8(0x57c)+_0x6809af['name']+_0x5ceef8(0x115d)+_0x6809af[_0x5ceef8(0x1309)][_0x5ceef8(0x5c3)](0x2)+_0x5ceef8(0x11ca),_0x2a8433[_0x5ceef8(0x998)](_0xdcfdf7);});}async function _0x229d95(_0x15e443,_0x3f70e0=0x1,_0x48c387=null){const _0x48323f=_0x475790,_0x390e54=_0x48c387?_0x54e872[_0x48323f(0x412)](_0x34043a=>_0x34043a[_0x48323f(0x93f)]===_0x15e443&&_0x34043a[_0x48323f(0xa73)]?.[_0x48323f(0xe36)]===_0x48c387[_0x48323f(0xe36)]):_0x54e872['find'](_0x1a7d3f=>_0x1a7d3f['productId']===_0x15e443&&!_0x1a7d3f[_0x48323f(0xa73)]);if(_0x390e54)_0x390e54[_0x48323f(0x17a)]+=_0x3f70e0;else{const _0x253b5a=await _0x5b9d83[_0x48323f(0x120e)][_0x48323f(0x6b5)](_0x15e443);_0x253b5a&&_0x54e872['push']({'productId':_0x253b5a['id'],'quantity':_0x3f70e0,'variation':_0x48c387});}_0x48b874();}function _0x2aeca3(_0x4ca7aa,_0x3346ca){const _0x598b73=_0x475790,_0x2057e9=_0x54e872['findIndex'](_0xcb36a7=>_0xcb36a7[_0x598b73(0x93f)]===_0x4ca7aa);_0x2057e9>-0x1&&(_0x54e872[_0x2057e9][_0x598b73(0x17a)]+=_0x3346ca,_0x54e872[_0x2057e9][_0x598b73(0x17a)]<=0x0&&_0x54e872[_0x598b73(0x510)](_0x2057e9,0x1),_0x48b874(),_0x5d0d8b());}function _0x48b874(){const _0xeeb29f=_0x475790,_0x1a6e99=_0x54e872[_0xeeb29f(0xcdd)]((_0x152c5e,_0x3d646f)=>_0x152c5e+_0x3d646f[_0xeeb29f(0x17a)],0x0);document['getElementById'](_0xeeb29f(0x985))['textContent']=_0x1a6e99,document['getElementById'](_0xeeb29f(0xc06))[_0xeeb29f(0x15f)]=_0xeeb29f(0xab1)+_0x1a6e99+')',document[_0xeeb29f(0x2ec)](_0xeeb29f(0x615))[_0xeeb29f(0x15f)]='结算('+_0x1a6e99+')';}function _0x34b0a8(){const _0x296004=_0x475790;_0x5d0d8b(),_0x17ec27(_0x296004(0xaeb));}async function _0x5d0d8b(){const _0x128413=_0x475790,_0x51be2d=document['getElementById'](_0x128413(0xbea));_0x51be2d[_0x128413(0xc43)]='';let _0x4b8a38=0x0;if(_0x54e872[_0x128413(0x9a1)]===0x0)_0x51be2d[_0x128413(0xc43)]=_0x128413(0x114d);else{const _0x1f06a3=_0x54e872[_0x128413(0x11c6)](_0x3e122f=>_0x3e122f[_0x128413(0x93f)]),_0x18467b=await _0x5b9d83[_0x128413(0x120e)][_0x128413(0x67e)]('id')['anyOf'](_0x1f06a3)['toArray'](),_0x1273b1=new Map(_0x18467b[_0x128413(0x11c6)](_0x53373a=>[_0x53373a['id'],_0x53373a]));_0x54e872[_0x128413(0xf99)](_0xc9fe48=>{const _0x39c23f=_0x128413,_0xffde7a=_0x1273b1[_0x39c23f(0x6b5)](_0xc9fe48['productId']);if(_0xffde7a){const _0x49230f=document[_0x39c23f(0x14ae)](_0x39c23f(0xaa5));_0x49230f['className']=_0x39c23f(0x3ed);const _0xef6cd2=_0xc9fe48[_0x39c23f(0xa73)]?_0x39c23f(0x143a)+_0xc9fe48[_0x39c23f(0xa73)][_0x39c23f(0xe36)]+'</div>':'';_0x49230f[_0x39c23f(0xc43)]=_0x39c23f(0xef7)+_0xffde7a['id']+_0x39c23f(0x142c)+(_0xc9fe48[_0x39c23f(0xa73)]?.[_0x39c23f(0x6c6)]||_0xffde7a['imageUrl'])+_0x39c23f(0xc46)+_0xffde7a[_0x39c23f(0xe36)]+_0x39c23f(0x790)+_0xef6cd2+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥'+(_0xc9fe48[_0x39c23f(0xa73)]?.['price']||_0xffde7a[_0x39c23f(0x1309)])[_0x39c23f(0x5c3)](0x2)+_0x39c23f(0xb5e)+_0xffde7a['id']+_0x39c23f(0x10a8)+_0xc9fe48[_0x39c23f(0x17a)]+_0x39c23f(0x1087)+_0xffde7a['id']+_0x39c23f(0x702),_0x51be2d[_0x39c23f(0x998)](_0x49230f);}});}_0x43c50b();}async function _0x43c50b(){const _0xa64570=_0x475790;let _0x5ad781=0x0;const _0x1d5b0b=document[_0xa64570(0x5d6)](_0xa64570(0xfd0)),_0x404c60=Array['from'](_0x1d5b0b)['map'](_0x5a7897=>parseInt(_0x5a7897['dataset']['id']));if(_0x404c60[_0xa64570(0x9a1)]>0x0){const _0x45ba33=await _0x5b9d83[_0xa64570(0x120e)][_0xa64570(0x67e)]('id')['anyOf'](_0x404c60)[_0xa64570(0x14b5)](),_0x2a89b9=new Map(_0x45ba33[_0xa64570(0x11c6)](_0x8f9670=>[_0x8f9670['id'],_0x8f9670]));_0x54e872[_0xa64570(0xf99)](_0x20020a=>{const _0x4a4ab6=_0xa64570;if(_0x404c60[_0x4a4ab6(0x138a)](_0x20020a[_0x4a4ab6(0x93f)])){const _0x5449a9=_0x2a89b9[_0x4a4ab6(0x6b5)](_0x20020a['productId']);if(_0x5449a9){const _0x2b7ad6=_0x20020a[_0x4a4ab6(0xa73)]?_0x20020a[_0x4a4ab6(0xa73)][_0x4a4ab6(0x1309)]:_0x5449a9['price'];_0x5ad781+=_0x2b7ad6*_0x20020a[_0x4a4ab6(0x17a)];}}});}document['getElementById'](_0xa64570(0xc1f))[_0xa64570(0x15f)]=_0xa64570(0x3f9)+_0x5ad781['toFixed'](0x2);}async function _0x4cbc71(){const _0x4fa62a=_0x475790,_0x5f2955=_0x28f30a[_0x4fa62a(0x6ce)][_0x28f30a['activeChatId']];if(!_0x5f2955||!_0x5f2955['isGroup'])return;const _0x3c11a2=document[_0x4fa62a(0x2ec)](_0x4fa62a(0x18e)),_0x22f24f=document['getElementById']('gift-recipient-list');_0x22f24f[_0x4fa62a(0xc43)]='';const _0x102e71=_0x5f2955[_0x4fa62a(0x362)][_0x4fa62a(0xa28)]||'我',_0x5c9f70=_0x5f2955[_0x4fa62a(0x10f2)]['filter'](_0x340f74=>_0x340f74[_0x4fa62a(0x8a8)]!==_0x102e71);_0x5c9f70[_0x4fa62a(0xf99)](_0x52644c=>{const _0x455703=_0x4fa62a,_0x3c2bfe=document[_0x455703(0x14ae)](_0x455703(0xaa5));_0x3c2bfe['className']='contact-picker-item',_0x3c2bfe[_0x455703(0xe93)][_0x455703(0xa9c)]=_0x52644c[_0x455703(0x66c)],_0x3c2bfe[_0x455703(0xc43)]=_0x455703(0xed4)+(_0x52644c[_0x455703(0x516)]||_0xd71c66)+_0x455703(0xe49)+_0x52644c[_0x455703(0x8a8)]+_0x455703(0xe53),_0x22f24f[_0x455703(0x998)](_0x3c2bfe);}),document['getElementById']('select-all-recipients')[_0x4fa62a(0x13b8)]=![],_0x3c11a2[_0x4fa62a(0xff6)][_0x4fa62a(0xe82)](_0x4fa62a(0x149d));}async function _0x43b2b6(){const _0x4c47c4=_0x475790,_0x1b75f1=_0x28f30a[_0x4c47c4(0x6ce)][_0x28f30a[_0x4c47c4(0x11b9)]],_0x5c889e=_0x54e872['filter'](_0x1ecc46=>document['querySelector'](_0x4c47c4(0x156f)+_0x1ecc46[_0x4c47c4(0x93f)]+_0x4c47c4(0x977)));if(_0x5c889e[_0x4c47c4(0x9a1)]===0x0){alert('请先在购物车中选择要结算的商品。');return;}if(_0x1b75f1['isGroup'])_0x4cbc71();else{const _0x27ac9f=await _0x4436ba('确认送出礼物',_0x4c47c4(0x7c6),{'confirmText':_0x4c47c4(0x123d)});_0x27ac9f&&await _0x5b0e4e(_0x5c889e);}}async function _0x5b0e4e(_0x496133,_0x49681c=null){const _0x1bf2f3=_0x475790;if(!_0x28f30a[_0x1bf2f3(0x11b9)])return;const _0x37c28b=_0x28f30a['chats'][_0x28f30a[_0x1bf2f3(0x11b9)]],_0x3801ac=_0x496133[_0x1bf2f3(0x11c6)](_0x194769=>_0x194769[_0x1bf2f3(0x93f)]),_0x215b02=await _0x5b9d83[_0x1bf2f3(0x120e)]['where']('id')[_0x1bf2f3(0x3fc)](_0x3801ac)['toArray'](),_0x30c209=new Map(_0x215b02[_0x1bf2f3(0x11c6)](_0x442df6=>[_0x442df6['id'],_0x442df6])),_0x41bb6c=_0x496133[_0x1bf2f3(0x11c6)](_0xfa022d=>{const _0x552a4f=_0x1bf2f3,_0x1ab419=_0x30c209['get'](_0xfa022d[_0x552a4f(0x93f)]);return _0xfa022d['variation']?{'name':_0x1ab419['name']+_0x552a4f(0xf8a)+_0xfa022d[_0x552a4f(0xa73)]['name'],'price':_0xfa022d['variation'][_0x552a4f(0x1309)],'imageUrl':_0xfa022d[_0x552a4f(0xa73)][_0x552a4f(0x6c6)]||_0x1ab419['imageUrl'],'quantity':_0xfa022d[_0x552a4f(0x17a)]}:{'name':_0x1ab419[_0x552a4f(0xe36)],'price':_0x1ab419[_0x552a4f(0x1309)],'imageUrl':_0x1ab419[_0x552a4f(0x6c6)],'quantity':_0xfa022d[_0x552a4f(0x17a)]};}),_0x59978f={'role':_0x1bf2f3(0xcc9),'type':_0x1bf2f3(0x43e),'timestamp':Date[_0x1bf2f3(0x487)](),'items':_0x41bb6c,'total':_0x41bb6c['reduce']((_0x4071da,_0xf006f8)=>_0x4071da+_0xf006f8[_0x1bf2f3(0x1309)]*_0xf006f8['quantity'],0x0),'recipients':_0x49681c};_0x37c28b[_0x1bf2f3(0x12c3)][_0x1bf2f3(0x367)](_0x59978f);if(_0x49681c&&_0x49681c[_0x1bf2f3(0x9a1)]>0x0){const _0x3f3245=_0x49681c['map'](_0x1fc248=>_0x4f967c(_0x37c28b,_0x1fc248))[_0x1bf2f3(0xbad)]('、'),_0x2edd1={'role':_0x1bf2f3(0x10a7),'content':_0x1bf2f3(0x12a1)+(_0x37c28b[_0x1bf2f3(0x362)][_0x1bf2f3(0xa28)]||'我')+')\x20送出了一份礼物，收礼人是：'+_0x3f3245+'。请收礼的角色表示感谢，其他角色可以自由发挥。]','timestamp':Date[_0x1bf2f3(0x487)]()+0x1,'isHidden':!![]};_0x37c28b['history'][_0x1bf2f3(0x367)](_0x2edd1);}await _0x5b9d83['chats'][_0x1bf2f3(0x7c3)](_0x37c28b),_0x4cc03e(_0x59978f,_0x37c28b),_0x5db8a3(),_0x54e872=_0x54e872[_0x1bf2f3(0xebc)](_0x2b1765=>!_0x496133[_0x1bf2f3(0x7e2)](_0x3b8fb2=>_0x3b8fb2['productId']===_0x2b1765[_0x1bf2f3(0x93f)])),_0x48b874(),_0x17ec27(_0x1bf2f3(0x120a)),await _0x34d596('成功',_0x1bf2f3(0x6b4));}function _0x1fb062(_0x3ee2dd){const _0x49ea09=_0x475790,_0x21f6ce=_0x28f30a[_0x49ea09(0x6ce)][_0x28f30a['activeChatId']],_0x496195=_0x21f6ce['history'][_0x49ea09(0x412)](_0x2dae84=>_0x2dae84['timestamp']===_0x3ee2dd);if(!_0x496195||_0x496195[_0x49ea09(0xb4b)]!==_0x49ea09(0x43e))return;const _0x5c0a34=document[_0x49ea09(0x2ec)](_0x49ea09(0x10ae));let _0x3bc8d8='';_0x496195[_0x49ea09(0x106e)]['forEach'](_0x3689ad=>{const _0x184aff=_0x49ea09;_0x3bc8d8+='<tr><td\x20class=\x22item-name\x22>'+_0x3689ad['name']+_0x184aff(0x58b)+_0x3689ad[_0x184aff(0x17a)]+_0x184aff(0x125f)+_0x3689ad[_0x184aff(0x1309)][_0x184aff(0x5c3)](0x2)+_0x184aff(0x36f)+(_0x3689ad[_0x184aff(0x1309)]*_0x3689ad['quantity'])['toFixed'](0x2)+'</td></tr>';}),_0x5c0a34[_0x49ea09(0xc43)]='<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20'+new Date(_0x496195[_0x49ea09(0x69a)])[_0x49ea09(0xc4c)]()+_0x49ea09(0xd5e)+_0x3bc8d8+_0x49ea09(0x9c7)+_0x496195[_0x49ea09(0x991)][_0x49ea09(0x5c3)](0x2)+'</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>',document[_0x49ea09(0x2ec)](_0x49ea09(0x680))[_0x49ea09(0xff6)][_0x49ea09(0xe82)](_0x49ea09(0x149d));}async function _0x2a7440(_0x394cf6=null){const _0xe0e540=_0x475790;_0x45682c=_0x394cf6;const _0x10789a=document[_0xe0e540(0x2ec)](_0xe0e540(0x4bd)),_0x1f2818=document[_0xe0e540(0x2ec)](_0xe0e540(0x1161)),_0x15cb65=document[_0xe0e540(0x2ec)](_0xe0e540(0xefc)),_0x20aa1e=document[_0xe0e540(0x2ec)](_0xe0e540(0x119e)),_0x5257df=document['getElementById'](_0xe0e540(0x1534)),_0x3b3708=document[_0xe0e540(0x2ec)](_0xe0e540(0x5d9)),_0x1b8e51=document[_0xe0e540(0x2ec)](_0xe0e540(0x837)),_0x237253=document[_0xe0e540(0x2ec)](_0xe0e540(0xf71));_0x237253[_0xe0e540(0xc43)]='',_0x1b8e51['innerHTML']='<option\x20value=\x22\x22>--\x20未分类\x20--</option>';const _0x9533ea=await _0x5b9d83[_0xe0e540(0x1117)]['toArray']();_0x9533ea[_0xe0e540(0xf99)](_0x1c3358=>{const _0x3dfcba=_0xe0e540,_0x2b940d=document[_0x3dfcba(0x14ae)](_0x3dfcba(0x29d));_0x2b940d[_0x3dfcba(0x11a4)]=_0x1c3358['id'],_0x2b940d[_0x3dfcba(0x15f)]=_0x1c3358[_0x3dfcba(0xe36)],_0x1b8e51[_0x3dfcba(0x998)](_0x2b940d);});if(_0x394cf6){_0x1f2818['textContent']='编辑商品';const _0x27447c=await _0x5b9d83['shoppingProducts']['get'](_0x394cf6);_0x15cb65['value']=_0x27447c[_0xe0e540(0xe36)],_0x20aa1e[_0xe0e540(0x11a4)]=_0x27447c['price'],_0x5257df[_0xe0e540(0x11a4)]=_0x27447c[_0xe0e540(0x9cc)]||'',_0x3b3708[_0xe0e540(0xce4)]=_0x27447c[_0xe0e540(0x6c6)],_0x1b8e51[_0xe0e540(0x11a4)]=_0x27447c['categoryId']||'',_0x27447c[_0xe0e540(0xaab)]&&_0x27447c[_0xe0e540(0xaab)][_0xe0e540(0x9a1)]>0x0&&_0x27447c['variations'][_0xe0e540(0xf99)](_0x43045d=>_0x5c3541(_0x43045d));}else _0x1f2818[_0xe0e540(0x15f)]='添加商品',_0x15cb65[_0xe0e540(0x11a4)]='',_0x20aa1e[_0xe0e540(0x11a4)]='',_0x5257df[_0xe0e540(0x11a4)]='',_0x3b3708[_0xe0e540(0xce4)]=_0xe0e540(0xdbb),_0x1b8e51[_0xe0e540(0x11a4)]='';_0x10789a[_0xe0e540(0xff6)][_0xe0e540(0xe82)](_0xe0e540(0x149d));}async function _0x472a33(){const _0x5dad12=_0x475790,_0x48ad42=document[_0x5dad12(0x2ec)](_0x5dad12(0xefc))['value'][_0x5dad12(0x97e)](),_0x488780=parseFloat(document[_0x5dad12(0x2ec)](_0x5dad12(0x119e))[_0x5dad12(0x11a4)]),_0x1eaa25=document[_0x5dad12(0x2ec)](_0x5dad12(0x1534))[_0x5dad12(0x11a4)][_0x5dad12(0x97e)](),_0x5ad335=document['getElementById']('product-image-preview')[_0x5dad12(0xce4)],_0x22f7bf=parseInt(document[_0x5dad12(0x2ec)](_0x5dad12(0x837))['value'])||null;if(!_0x48ad42){alert('商品名称不能为空！');return;}if(isNaN(_0x488780)||_0x488780<0x0){alert(_0x5dad12(0x833));return;}const _0x47b41e=[];document[_0x5dad12(0x5d6)](_0x5dad12(0x1543))[_0x5dad12(0xf99)](_0x2c04b7=>{const _0x222263=_0x5dad12,_0x398b53=_0x2c04b7[_0x222263(0x765)]('.variation-name-input')[_0x222263(0x11a4)]['trim'](),_0x340704=parseFloat(_0x2c04b7[_0x222263(0x765)](_0x222263(0x850))[_0x222263(0x11a4)]),_0x3b9e6d=_0x2c04b7[_0x222263(0x765)](_0x222263(0xb50))['src'];_0x398b53&&!isNaN(_0x340704)&&_0x340704>=0x0&&_0x47b41e[_0x222263(0x367)]({'name':_0x398b53,'price':_0x340704,'imageUrl':_0x3b9e6d[_0x222263(0x138a)](_0x222263(0x1036))?null:_0x3b9e6d});});const _0x74e287={'name':_0x48ad42,'price':_0x488780,'description':_0x1eaa25,'imageUrl':_0x5ad335,'categoryId':_0x22f7bf,'variations':_0x47b41e};_0x45682c?await _0x5b9d83[_0x5dad12(0x120e)][_0x5dad12(0x130a)](_0x45682c,_0x74e287):await _0x5b9d83[_0x5dad12(0x120e)][_0x5dad12(0xe82)](_0x74e287),document[_0x5dad12(0x2ec)](_0x5dad12(0x4bd))['classList']['remove'](_0x5dad12(0x149d)),await _0x275258();}async function _0x2a29d0(){const _0x270519=_0x475790;await _0x486fa0(),_0x17ec27(_0x270519(0x14d5));}async function _0x486fa0(){const _0x2555fa=_0x475790,_0x68458d=document[_0x2555fa(0x2ec)](_0x2555fa(0x1525)),_0x38cab3=document[_0x2555fa(0x2ec)](_0x2555fa(0xb94));_0x68458d['innerHTML']='',_0x38cab3[_0x2555fa(0xc43)]='';const _0x55d381=await _0x5b9d83['renderingRules'][_0x2555fa(0x14b5)]();if(_0x55d381[_0x2555fa(0x9a1)]===0x0){_0x38cab3[_0x2555fa(0xc43)]=_0x2555fa(0x138e);return;}const _0x6a0fb0=document[_0x2555fa(0x14ae)](_0x2555fa(0xd5a));_0x6a0fb0[_0x2555fa(0xdd1)]=_0x2555fa(0x56b),_0x6a0fb0[_0x2555fa(0x15f)]=_0x2555fa(0x6cf),_0x6a0fb0[_0x2555fa(0xe93)]['categoryId']=_0x2555fa(0x283),_0x68458d[_0x2555fa(0x998)](_0x6a0fb0);const _0x44799d=document[_0x2555fa(0x14ae)](_0x2555fa(0xaa5));_0x44799d[_0x2555fa(0xdd1)]='rules-category-pane\x20active',_0x44799d[_0x2555fa(0xe93)][_0x2555fa(0x10ce)]=_0x2555fa(0x283),_0x38cab3['appendChild'](_0x44799d);const _0x486fe7=Object[_0x2555fa(0x74e)](_0x28f30a[_0x2555fa(0x6ce)])[_0x2555fa(0xebc)](_0xa3e1e7=>!_0xa3e1e7[_0x2555fa(0x1423)]&&_0x55d381['some'](_0x17185b=>_0x17185b[_0x2555fa(0xdd0)]===_0xa3e1e7['id']));_0x486fe7['forEach'](_0x51795b=>{const _0x12d577=_0x2555fa,_0x20c3d9=document['createElement']('button');_0x20c3d9[_0x12d577(0xdd1)]=_0x12d577(0x72f),_0x20c3d9[_0x12d577(0x15f)]=_0x51795b[_0x12d577(0xe36)],_0x20c3d9[_0x12d577(0xe93)][_0x12d577(0x10ce)]=_0x51795b['id'],_0x68458d[_0x12d577(0x998)](_0x20c3d9);const _0x4ac2c7=document['createElement'](_0x12d577(0xaa5));_0x4ac2c7[_0x12d577(0xdd1)]=_0x12d577(0x9a7),_0x4ac2c7[_0x12d577(0xe93)][_0x12d577(0x10ce)]=_0x51795b['id'],_0x38cab3[_0x12d577(0x998)](_0x4ac2c7);}),_0x55d381[_0x2555fa(0xf99)](_0x288b35=>{const _0x5a4e60=_0x2555fa,_0x4393a5=_0x37b2f0(_0x288b35),_0x21fb42=_0x38cab3[_0x5a4e60(0x765)](_0x5a4e60(0x7ab)+_0x288b35[_0x5a4e60(0xdd0)]+'\x22]');_0x21fb42&&_0x21fb42[_0x5a4e60(0x998)](_0x4393a5);}),document[_0x2555fa(0x5d6)](_0x2555fa(0x4ee))[_0x2555fa(0xf99)](_0x496a9f=>{const _0x54cf56=_0x2555fa;_0x496a9f['addEventListener']('click',()=>_0x1960e7(_0x496a9f[_0x54cf56(0xe93)][_0x54cf56(0x10ce)]));});}function _0x37b2f0(_0x2f9c35){const _0x4cf670=_0x475790,_0x1b9589=document[_0x4cf670(0x14ae)](_0x4cf670(0xaa5));return _0x1b9589[_0x4cf670(0xdd1)]=_0x4cf670(0x8c1)+(_0x2f9c35['isEnabled']?_0x4cf670(0x400):''),_0x1b9589[_0x4cf670(0xe93)][_0x4cf670(0x75d)]=_0x2f9c35['id'],_0x1b9589['innerHTML']=_0x4cf670(0x1516)+_0x2f9c35[_0x4cf670(0xe36)]+_0x4cf670(0x488)+_0x2f9c35[_0x4cf670(0x280)]+_0x4cf670(0xf83),_0x1b9589[_0x4cf670(0xf79)]('click',()=>_0x153256(_0x2f9c35['id'])),_0x131542(_0x1b9589,()=>_0x5cd887(_0x2f9c35['id'])),_0x1b9589;}async function _0x153256(_0x4ac550=null){const _0x3bacd6=_0x475790;_0x57a7d0=_0x4ac550;const _0x1e2307=document['getElementById'](_0x3bacd6(0xf5e)),_0x389542=document['getElementById'](_0x3bacd6(0x1b6)),_0x229d66=document[_0x3bacd6(0x2ec)](_0x3bacd6(0x3a6)),_0x59f587=document['getElementById'](_0x3bacd6(0x150f)),_0x2c0f55=document['getElementById'](_0x3bacd6(0x754)),_0x255973=document['getElementById'](_0x3bacd6(0x6e1)),_0xbbf864=document['getElementById'](_0x3bacd6(0x1536));_0x59f587[_0x3bacd6(0xc43)]=_0x3bacd6(0x90a),Object[_0x3bacd6(0x74e)](_0x28f30a[_0x3bacd6(0x6ce)])['filter'](_0x1d8998=>!_0x1d8998[_0x3bacd6(0x1423)])['forEach'](_0x2a89cc=>{const _0x123ebd=_0x3bacd6;_0x59f587['innerHTML']+='<option\x20value=\x22'+_0x2a89cc['id']+'\x22>'+_0x2a89cc['name']+_0x123ebd(0x1426);});if(_0x4ac550){_0x389542['textContent']='编辑规则';const _0x349f31=await _0x5b9d83[_0x3bacd6(0xccb)][_0x3bacd6(0x6b5)](_0x4ac550);_0x229d66['value']=_0x349f31[_0x3bacd6(0xe36)],_0x59f587[_0x3bacd6(0x11a4)]=_0x349f31[_0x3bacd6(0xdd0)],_0x2c0f55['value']=_0x349f31[_0x3bacd6(0x280)],_0x255973[_0x3bacd6(0x11a4)]=_0x349f31['template'],_0xbbf864[_0x3bacd6(0x13b8)]=_0x349f31[_0x3bacd6(0x13a4)];}else _0x389542[_0x3bacd6(0x15f)]=_0x3bacd6(0x166),_0x229d66['value']='',_0x59f587[_0x3bacd6(0x11a4)]=_0x3bacd6(0x283),_0x2c0f55['value']='',_0x255973[_0x3bacd6(0x11a4)]='',_0xbbf864[_0x3bacd6(0x13b8)]=!![];_0x1e2307[_0x3bacd6(0xff6)][_0x3bacd6(0xe82)]('visible');}async function _0x17eb80(){const _0x1af8d6=_0x475790,_0x13449a=document[_0x1af8d6(0x2ec)](_0x1af8d6(0x3a6))[_0x1af8d6(0x11a4)][_0x1af8d6(0x97e)](),_0x5d2ea6=document[_0x1af8d6(0x2ec)](_0x1af8d6(0x754))[_0x1af8d6(0x11a4)][_0x1af8d6(0x97e)]();if(!_0x13449a||!_0x5d2ea6){alert('规则名称和正则表达式不能为空！');return;}try{new RegExp(_0x5d2ea6);}catch(_0x3e6cce){alert(_0x1af8d6(0x11be)+_0x3e6cce['message']);return;}const _0x99ca51={'name':_0x13449a,'chatId':document[_0x1af8d6(0x2ec)](_0x1af8d6(0x150f))[_0x1af8d6(0x11a4)],'regex':_0x5d2ea6,'template':document[_0x1af8d6(0x2ec)](_0x1af8d6(0x6e1))[_0x1af8d6(0x11a4)],'isEnabled':document[_0x1af8d6(0x2ec)]('rule-enabled-switch')[_0x1af8d6(0x13b8)]};_0x57a7d0?await _0x5b9d83['renderingRules'][_0x1af8d6(0x130a)](_0x57a7d0,_0x99ca51):await _0x5b9d83[_0x1af8d6(0xccb)][_0x1af8d6(0xe82)](_0x99ca51),document[_0x1af8d6(0x2ec)]('rule-editor-modal')[_0x1af8d6(0xff6)][_0x1af8d6(0x1424)](_0x1af8d6(0x149d)),await _0x486fa0();}async function _0x5cd887(_0x5a5c9b){const _0x53910d=_0x475790,_0x4ef4bd=await _0x4436ba('删除规则',_0x53910d(0x3f0),{'confirmButtonClass':_0x53910d(0xd8f)});_0x4ef4bd&&(await _0x5b9d83[_0x53910d(0xccb)][_0x53910d(0x54b)](_0x5a5c9b),await _0x486fa0());}async function _0x437e6c(_0x1fb7c6,_0x3bcd94){const _0x2f0163=_0x475790;if(_0x1fb7c6[_0x2f0163(0x97e)]()[_0x2f0163(0x741)]('<')||!_0x1fb7c6[_0x2f0163(0x138a)]('[')&&!_0x1fb7c6[_0x2f0163(0x138a)]('{'))return _0x1fb7c6;const _0x55399f=await _0x5b9d83['renderingRules'][_0x2f0163(0x67e)]('chatId')[_0x2f0163(0x129a)]('global')['or'](_0x2f0163(0xdd0))['equals'](_0x3bcd94)[_0x2f0163(0x14b5)]();let _0x5ca715=_0x1fb7c6;for(const _0x297573 of _0x55399f[_0x2f0163(0xebc)](_0x360cef=>_0x360cef[_0x2f0163(0x13a4)])){try{const _0x26b781=new RegExp(_0x297573[_0x2f0163(0x280)],'g');_0x26b781[_0x2f0163(0x1e0)](_0x5ca715)&&(_0x5ca715=_0x5ca715[_0x2f0163(0x13ed)](_0x26b781,_0x297573[_0x2f0163(0x129d)]));}catch(_0x5d3e51){console[_0x2f0163(0x1518)](_0x2f0163(0x484)+_0x297573[_0x2f0163(0xe36)]+_0x2f0163(0x715),_0x5d3e51);}}return _0x5ca715;}async function _0x2a29d0(){await _0x486fa0(),_0x17ec27('rendering-rules-screen');}async function _0x486fa0(){const _0x134da0=_0x475790,_0x476ff1=document[_0x134da0(0x2ec)](_0x134da0(0x1525)),_0x25e250=document[_0x134da0(0x2ec)](_0x134da0(0xb94));_0x476ff1['innerHTML']='',_0x25e250[_0x134da0(0xc43)]='';const _0x31a325=await _0x5b9d83[_0x134da0(0xccb)][_0x134da0(0x14b5)]();if(_0x31a325[_0x134da0(0x9a1)]===0x0){_0x25e250['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>';return;}const _0x8e25c2=document[_0x134da0(0x14ae)](_0x134da0(0xd5a));_0x8e25c2[_0x134da0(0xdd1)]=_0x134da0(0x56b),_0x8e25c2['textContent']=_0x134da0(0x6cf),_0x8e25c2[_0x134da0(0xe93)][_0x134da0(0x10ce)]=_0x134da0(0x283),_0x476ff1[_0x134da0(0x998)](_0x8e25c2);const _0x48eb1b=document[_0x134da0(0x14ae)](_0x134da0(0xaa5));_0x48eb1b[_0x134da0(0xdd1)]=_0x134da0(0xad8),_0x48eb1b['dataset'][_0x134da0(0x10ce)]=_0x134da0(0x283),_0x25e250['appendChild'](_0x48eb1b);const _0x13e1e0=Object['values'](_0x28f30a[_0x134da0(0x6ce)])[_0x134da0(0xebc)](_0x232f42=>!_0x232f42['isGroup']&&_0x31a325[_0x134da0(0x7e2)](_0x407383=>_0x407383['chatId']===_0x232f42['id']));_0x13e1e0[_0x134da0(0xf99)](_0x1582ca=>{const _0x249203=_0x134da0,_0x185932=document['createElement'](_0x249203(0xd5a));_0x185932[_0x249203(0xdd1)]=_0x249203(0x72f),_0x185932[_0x249203(0x15f)]=_0x1582ca['name'],_0x185932[_0x249203(0xe93)][_0x249203(0x10ce)]=_0x1582ca['id'],_0x476ff1['appendChild'](_0x185932);const _0x13eb23=document[_0x249203(0x14ae)](_0x249203(0xaa5));_0x13eb23[_0x249203(0xdd1)]='rules-category-pane',_0x13eb23[_0x249203(0xe93)][_0x249203(0x10ce)]=_0x1582ca['id'],_0x25e250[_0x249203(0x998)](_0x13eb23);}),_0x31a325[_0x134da0(0xf99)](_0x568b66=>{const _0x419bb0=_0x134da0,_0x4c87f3=_0x37b2f0(_0x568b66),_0x455be9=_0x25e250['querySelector'](_0x419bb0(0x7ab)+_0x568b66[_0x419bb0(0xdd0)]+'\x22]');_0x455be9&&_0x455be9[_0x419bb0(0x998)](_0x4c87f3);}),document[_0x134da0(0x5d6)]('.rules-tab')[_0x134da0(0xf99)](_0x4176cc=>{const _0x4e4bb5=_0x134da0;_0x4176cc[_0x4e4bb5(0xf79)](_0x4e4bb5(0x1177),()=>_0x1960e7(_0x4176cc['dataset'][_0x4e4bb5(0x10ce)]));});}function _0x37b2f0(_0x40bcac){const _0x348473=_0x475790,_0xc23054=document[_0x348473(0x14ae)](_0x348473(0xaa5));return _0xc23054[_0x348473(0xdd1)]=_0x348473(0x8c1)+(_0x40bcac[_0x348473(0x13a4)]?_0x348473(0x400):''),_0xc23054[_0x348473(0xe93)]['ruleId']=_0x40bcac['id'],_0xc23054[_0x348473(0xc43)]=_0x348473(0x1516)+_0x40bcac[_0x348473(0xe36)]+_0x348473(0x488)+_0x40bcac[_0x348473(0x280)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xc23054['addEventListener']('click',()=>_0x153256(_0x40bcac['id'])),_0x131542(_0xc23054,()=>_0x5cd887(_0x40bcac['id'])),_0xc23054;}async function _0x153256(_0x1cabb2=null){const _0x34c654=_0x475790;_0x57a7d0=_0x1cabb2;const _0x18cbc7=document[_0x34c654(0x2ec)](_0x34c654(0xf5e)),_0x320542=document[_0x34c654(0x2ec)](_0x34c654(0x1b6)),_0x51d998=document['getElementById'](_0x34c654(0x3a6)),_0xe40ee0=document[_0x34c654(0x2ec)](_0x34c654(0x150f)),_0x20116d=document['getElementById'](_0x34c654(0x754)),_0x4c4781=document[_0x34c654(0x2ec)]('rule-template-input'),_0x318f3a=document[_0x34c654(0x2ec)]('rule-enabled-switch');_0xe40ee0[_0x34c654(0xc43)]=_0x34c654(0x90a),Object['values'](_0x28f30a[_0x34c654(0x6ce)])['filter'](_0x69c1e7=>!_0x69c1e7[_0x34c654(0x1423)])[_0x34c654(0xf99)](_0x315129=>{const _0x5af301=_0x34c654;_0xe40ee0['innerHTML']+=_0x5af301(0x31c)+_0x315129['id']+'\x22>'+_0x315129[_0x5af301(0xe36)]+'</option>';});if(_0x1cabb2){_0x320542[_0x34c654(0x15f)]=_0x34c654(0xfad);const _0x155bc0=await _0x5b9d83[_0x34c654(0xccb)][_0x34c654(0x6b5)](_0x1cabb2);_0x51d998['value']=_0x155bc0[_0x34c654(0xe36)],_0xe40ee0['value']=_0x155bc0[_0x34c654(0xdd0)],_0x20116d[_0x34c654(0x11a4)]=_0x155bc0['regex'],_0x4c4781['value']=_0x155bc0[_0x34c654(0x129d)],_0x318f3a[_0x34c654(0x13b8)]=_0x155bc0[_0x34c654(0x13a4)];}else _0x320542['textContent']=_0x34c654(0x166),_0x51d998[_0x34c654(0x11a4)]='',_0xe40ee0[_0x34c654(0x11a4)]=_0x34c654(0x283),_0x20116d['value']='',_0x4c4781[_0x34c654(0x11a4)]='',_0x318f3a[_0x34c654(0x13b8)]=!![];_0x18cbc7[_0x34c654(0xff6)][_0x34c654(0xe82)](_0x34c654(0x149d));}async function _0x17eb80(){const _0x11299d=_0x475790,_0x19f46a=document['getElementById'](_0x11299d(0x3a6))[_0x11299d(0x11a4)][_0x11299d(0x97e)](),_0x3ebd95=document[_0x11299d(0x2ec)]('rule-regex-input')[_0x11299d(0x11a4)][_0x11299d(0x97e)]();if(!_0x19f46a||!_0x3ebd95){alert('规则名称和正则表达式不能为空！');return;}try{new RegExp(_0x3ebd95);}catch(_0x58a76b){alert(_0x11299d(0x11be)+_0x58a76b[_0x11299d(0x13bc)]);return;}const _0x339882={'name':_0x19f46a,'chatId':document[_0x11299d(0x2ec)](_0x11299d(0x150f))[_0x11299d(0x11a4)],'regex':_0x3ebd95,'template':document[_0x11299d(0x2ec)]('rule-template-input')[_0x11299d(0x11a4)],'isEnabled':document[_0x11299d(0x2ec)](_0x11299d(0x1536))[_0x11299d(0x13b8)]};_0x57a7d0?await _0x5b9d83[_0x11299d(0xccb)][_0x11299d(0x130a)](_0x57a7d0,_0x339882):await _0x5b9d83['renderingRules'][_0x11299d(0xe82)](_0x339882),document[_0x11299d(0x2ec)]('rule-editor-modal')[_0x11299d(0xff6)][_0x11299d(0x1424)](_0x11299d(0x149d)),await _0x486fa0();}async function _0x5cd887(_0x482585){const _0x431d49=_0x475790,_0x49a6a7=await _0x4436ba(_0x431d49(0x24d),_0x431d49(0x3f0),{'confirmButtonClass':'btn-danger'});_0x49a6a7&&(await _0x5b9d83[_0x431d49(0xccb)][_0x431d49(0x54b)](_0x482585),await _0x486fa0());}async function _0x437e6c(_0x1ead0e,_0x1f04a6){const _0x3ea45b=_0x475790;if(_0x1ead0e[_0x3ea45b(0x97e)]()[_0x3ea45b(0x741)]('<')||!_0x1ead0e[_0x3ea45b(0x138a)]('[')&&!_0x1ead0e['includes']('{'))return _0x1ead0e;if(!_0x2b6c0f[_0x1f04a6]){console[_0x3ea45b(0x415)](_0x3ea45b(0xecb)+_0x1f04a6);const _0x9916bb=await _0x5b9d83['renderingRules'][_0x3ea45b(0x67e)]('chatId')[_0x3ea45b(0x129a)](_0x3ea45b(0x283))['or']('chatId')[_0x3ea45b(0x129a)](_0x1f04a6)[_0x3ea45b(0x14b5)]();_0x2b6c0f[_0x1f04a6]=_0x9916bb['filter'](_0x144e08=>_0x144e08[_0x3ea45b(0x13a4)]);}const _0xd529b7=_0x2b6c0f[_0x1f04a6];let _0x32df51=_0x1ead0e;for(const _0x170528 of _0xd529b7){try{const _0x22a70e=new RegExp(_0x170528[_0x3ea45b(0x280)],'g');let _0xd6b244=_0x32df51;_0x22a70e[_0x3ea45b(0x1e0)](_0xd6b244)&&(_0x32df51=_0x32df51[_0x3ea45b(0x13ed)](_0x22a70e,_0x170528[_0x3ea45b(0x129d)]));}catch(_0x2e6229){console['error']('渲染规则\x20['+_0x170528[_0x3ea45b(0xe36)]+']\x20的正则表达式无效:',_0x2e6229);}}return _0x32df51;}function _0x2ba5f5(_0x5cd11a){const _0x41a495=_0x475790;if(!_0x5cd11a)return'';const _0x5d7a83=new Date(),_0x153ded=new Date(_0x5cd11a),_0x120906=String(_0x153ded[_0x41a495(0x8a5)]())[_0x41a495(0x58e)](0x2,'0'),_0x2791d9=String(_0x153ded[_0x41a495(0xbc9)]())[_0x41a495(0x58e)](0x2,'0'),_0x3c6d36=_0x120906+':'+_0x2791d9;if(_0x5d7a83[_0x41a495(0x329)]()===_0x153ded[_0x41a495(0x329)]())return _0x3c6d36;const _0x56d7f8=new Date();_0x56d7f8['setDate'](_0x5d7a83[_0x41a495(0x3c7)]()-0x1);if(_0x56d7f8['toDateString']()===_0x153ded[_0x41a495(0x329)]())return _0x41a495(0xb78)+_0x3c6d36;const _0x472988=_0x153ded[_0x41a495(0x4cb)](),_0x25705e=String(_0x153ded[_0x41a495(0xa8f)]()+0x1)['padStart'](0x2,'0'),_0x416f0c=String(_0x153ded[_0x41a495(0x3c7)]())[_0x41a495(0x58e)](0x2,'0');return _0x5d7a83['getFullYear']()===_0x472988?_0x25705e+'月'+_0x416f0c+'日\x20'+_0x3c6d36:_0x472988+'年'+_0x25705e+'月'+_0x416f0c+'日\x20'+_0x3c6d36;}function _0x5d2756(_0x27eea1){const _0x134d79=_0x475790,_0x5af1ab=document['createElement'](_0x134d79(0xaa5));_0x5af1ab[_0x134d79(0xdd1)]=_0x134d79(0x505);const _0x4a4876=document['createElement'](_0x134d79(0xaa5));return _0x4a4876[_0x134d79(0xdd1)]='message-bubble\x20system-bubble',_0x4a4876[_0x134d79(0x15f)]=_0x2ba5f5(_0x27eea1),_0x5af1ab['appendChild'](_0x4a4876),_0x5af1ab;}async function _0x1687a2(){const _0x252452=_0x475790,_0x14c8db=_0x28f30a[_0x252452(0x6ce)][_0x28f30a[_0x252452(0x11b9)]];if(!_0x14c8db||!lastResponseTimestamps||lastResponseTimestamps[_0x252452(0x9a1)]===0x0){alert(_0x252452(0x13c5));return;}_0x14c8db['history']=_0x14c8db[_0x252452(0x12c3)][_0x252452(0xebc)](_0x4a6a83=>!lastResponseTimestamps[_0x252452(0x138a)](_0x4a6a83[_0x252452(0x69a)])),await _0x5b9d83[_0x252452(0x6ce)][_0x252452(0x7c3)](_0x14c8db),await _0xc55746(_0x28f30a[_0x252452(0x11b9)]),_0x3510c8();}async function _0x15c50f(_0x2365ab,_0xbaf18a){const _0x4325e4=_0x475790;if(!_0x28f30a['activeChatId'])return;const _0xcfd1bc=_0x28f30a[_0x4325e4(0x6ce)][_0x28f30a['activeChatId']],_0x4365e0=_0xcfd1bc[_0x4325e4(0x12c3)][_0x4325e4(0x535)](_0x4ba3f0=>_0x4ba3f0[_0x4325e4(0x69a)]===_0x2365ab);if(_0x4365e0===-0x1)return;const _0x49824a=_0xcfd1bc['history'][_0x4365e0],_0x2cbc35=_0x49824a['prompt'];if(!_0x2cbc35){await _0x34d596('无法重新生成',_0x4325e4(0xe96));return;}_0xbaf18a['disabled']=!![],_0xbaf18a[_0x4325e4(0xff6)]['add'](_0x4325e4(0x1de));const _0x447f7d=_0xbaf18a[_0x4325e4(0x3f2)]('.message-bubble'),_0x3e7b13=_0x447f7d?_0x447f7d['querySelector'](_0x4325e4(0x14cf)):null;_0x3e7b13&&(_0x3e7b13[_0x4325e4(0x589)][_0x4325e4(0xb92)]='0.5');try{const _0x3afea9=await _0x2c6597(_0x2cbc35,_0xcfd1bc['id']);_0x49824a[_0x4325e4(0x6c6)]=_0x3afea9[_0x4325e4(0x6c6)],_0x49824a[_0x4325e4(0x5ae)]=_0x3afea9[_0x4325e4(0x5ae)],await _0x5b9d83['chats'][_0x4325e4(0x7c3)](_0xcfd1bc),_0x3e7b13&&(_0x3e7b13[_0x4325e4(0xce4)]=_0x3afea9['imageUrl'],_0x3e7b13[_0x4325e4(0x141e)]=_0x3afea9[_0x4325e4(0x5ae)],_0x3e7b13['style'][_0x4325e4(0xb92)]='1');}catch(_0x423afe){console[_0x4325e4(0x1518)](_0x4325e4(0x7fb),_0x423afe),await _0x34d596('生成失败',_0x4325e4(0x1034)+_0x423afe[_0x4325e4(0x13bc)]),_0x3e7b13&&(_0x3e7b13[_0x4325e4(0x589)][_0x4325e4(0xb92)]='1');}finally{_0xbaf18a[_0x4325e4(0x1373)]=![],_0xbaf18a['classList'][_0x4325e4(0x1424)]('loading');}}async function _0x1dc26a(){const _0x2a828e=_0x475790,_0x569e1e=_0x28f30a[_0x2a828e(0x6ce)][_0x28f30a[_0x2a828e(0x11b9)]];if(!_0x569e1e)return;const _0x9ce21b=_0x569e1e[_0x2a828e(0x12c3)][_0x2a828e(0x9b4)](_0x5b9251=>_0x5b9251['role']===_0x2a828e(0xcc9)&&!_0x5b9251[_0x2a828e(0x1162)]);if(_0x9ce21b===-0x1){alert('没有可供重新生成回复的用户消息。');return;}const _0x5e2a9b=_0x569e1e[_0x2a828e(0x12c3)][_0x2a828e(0x9b4)](_0x34b75d=>_0x34b75d['role']===_0x2a828e(0x6d9));if(_0x5e2a9b<_0x9ce21b){alert(_0x2a828e(0xcd9));return;}_0x569e1e[_0x2a828e(0x12c3)]=_0x569e1e[_0x2a828e(0x12c3)]['slice'](0x0,_0x9ce21b+0x1),await _0x5b9d83[_0x2a828e(0x6ce)][_0x2a828e(0x7c3)](_0x569e1e),await _0xc55746(_0x28f30a[_0x2a828e(0x11b9)]),await _0x36bcc9();}async function _0x4fedd0(){const _0x5effc4=_0x475790;if(!_0x20bfc1['isActive'])return;const _0x5f37aa=_0x20bfc1[_0x5effc4(0xe33)][_0x5effc4(0x9b4)](_0x3cc197=>_0x3cc197[_0x5effc4(0x9be)]===_0x5effc4(0xcc9));if(_0x5f37aa===-0x1){alert(_0x5effc4(0x894));return;}_0x20bfc1[_0x5effc4(0xe33)][_0x5effc4(0x510)](_0x5f37aa+0x1);const _0x15d8ae=document[_0x5effc4(0x2ec)](_0x5effc4(0x393));_0x15d8ae[_0x5effc4(0xc43)]='',_0x20bfc1[_0x5effc4(0xe33)][_0x5effc4(0xf99)](_0x2291d7=>{const _0x11cdfd=_0x5effc4,_0x2c1310=document['createElement'](_0x11cdfd(0xaa5));_0x2c1310[_0x11cdfd(0xdd1)]='call-message-bubble\x20'+_0x2291d7['role']+_0x11cdfd(0xa0e),_0x2c1310[_0x11cdfd(0xe93)][_0x11cdfd(0x69a)]=_0x2291d7['timestamp'],_0x2291d7[_0x11cdfd(0x9be)]===_0x11cdfd(0xcc9)?_0x2c1310[_0x11cdfd(0x15f)]=_0x2291d7[_0x11cdfd(0x1047)]:_0x2c1310['innerHTML']=_0x2291d7[_0x11cdfd(0x1047)],_0x131542(_0x2c1310,()=>_0x5655cf(_0x2291d7[_0x11cdfd(0x69a)])),_0x15d8ae[_0x11cdfd(0x998)](_0x2c1310);}),_0x15d8ae[_0x5effc4(0x12be)]=_0x15d8ae[_0x5effc4(0x1ce)],_0x1df4a2(null);}async function _0x28f5ce(){const _0x3bcf4a=_0x475790,_0xffc46e=_0x28f30a[_0x3bcf4a(0x6ce)][_0x28f30a[_0x3bcf4a(0x11b9)]];if(!_0xffc46e)return;_0x48a755(_0xffc46e['id'],!![]);const _0x2f6c1a=document[_0x3bcf4a(0x2ec)](_0x3bcf4a(0x96a));!_0xffc46e[_0x3bcf4a(0x1423)]&&(_0x2f6c1a[_0x3bcf4a(0x589)][_0x3bcf4a(0xb92)]=0x0,setTimeout(()=>{const _0x4f1540=_0x3bcf4a;_0x2f6c1a[_0x4f1540(0x15f)]='对方正在输入...',_0x2f6c1a[_0x4f1540(0xff6)][_0x4f1540(0xe82)](_0x4f1540(0x89a)),_0x2f6c1a['style'][_0x4f1540(0xb92)]=0x1;},0xc8));try{const {proxyUrl:_0x433634,apiKey:_0x50765e,model:_0x808308}=_0x28f30a[_0x3bcf4a(0x1537)];if(!_0x433634||!_0x50765e||!_0x808308)throw new Error(_0x3bcf4a(0x5ff));const _0x463957=parseInt(_0xffc46e['settings'][_0x3bcf4a(0xfcd)])||0xa,_0x4df767=_0xffc46e['history'][_0x3bcf4a(0x225)](-_0x463957),_0x4a6151=new Date(),_0x25d4bc=new Date(_0x4a6151['getTime']()+_0x4a6151['getTimezoneOffset']()*0xea60+0x36ee80*0x8),_0xe4ed5a=_0x25d4bc[_0x3bcf4a(0xc4c)](_0x3bcf4a(0x1054),{'timeZone':'Asia/Shanghai','dateStyle':_0x3bcf4a(0x1124),'timeStyle':'short'}),_0x35ccd6=_0x55bb06(_0x25d4bc),_0x1114c4=_0xffc46e[_0x3bcf4a(0x362)][_0x3bcf4a(0xa28)]||'我';let _0x2317c5='';if(_0xffc46e[_0x3bcf4a(0x362)][_0x3bcf4a(0x684)]&&_0xffc46e[_0x3bcf4a(0x362)][_0x3bcf4a(0x684)][_0x3bcf4a(0x9a1)]>0x0){const _0x4b559f=_0xffc46e[_0x3bcf4a(0x362)][_0x3bcf4a(0x684)][_0x3bcf4a(0x11c6)](_0x1b02b6=>{const _0x51c822=_0x3bcf4a,_0x5428f5=_0x28f30a['worldBooks']['find'](_0x463f17=>_0x463f17['id']===_0x1b02b6);if(!_0x5428f5||!Array['isArray'](_0x5428f5['content']))return'';const _0xfd5de6=_0x5428f5[_0x51c822(0x1047)][_0x51c822(0xebc)](_0x566f4d=>_0x566f4d['enabled']!==![])['map'](_0x2a3ca0=>{const _0x48ed68=_0x51c822;let _0x34c01f=_0x48ed68(0xe5c)+(_0x2a3ca0[_0x48ed68(0x70d)]||_0x48ed68(0x342))+'\x0a';if(_0x2a3ca0[_0x48ed68(0xf6b)]['length']>0x0)_0x34c01f+=_0x48ed68(0x933)+_0x2a3ca0[_0x48ed68(0xf6b)][_0x48ed68(0xbad)](',\x20')+'\x0a';return _0x34c01f+=_0x48ed68(0x140c)+_0x2a3ca0[_0x48ed68(0x1047)],_0x34c01f;})[_0x51c822(0xbad)]('');return _0xfd5de6?_0x51c822(0xbd0)+_0x5428f5[_0x51c822(0xe36)]+'\x0a'+_0xfd5de6:'';})['filter'](Boolean)[_0x3bcf4a(0xbad)]('');_0x4b559f&&(_0x2317c5=_0x3bcf4a(0x14e0)+_0x4b559f+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x395315='';if(_0x79cac3[_0x3bcf4a(0xffc)]&&_0x79cac3[_0x3bcf4a(0x11b9)]===_0xffc46e['id']){const _0x4a3755=_0x79cac3[_0x3bcf4a(0xf35)]>-0x1?_0x79cac3[_0x3bcf4a(0x5fd)][_0x79cac3[_0x3bcf4a(0xf35)]]:null;_0x395315='\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)';}const _0x5767a6=_0x204b6c(_0x484920[_0xffc46e['id']]);let _0xf4d997='';_0xffc46e['nameHistory']&&_0xffc46e['nameHistory'][_0x3bcf4a(0x9a1)]>0x0&&(_0xf4d997=_0x3bcf4a(0x7d0)+_0xffc46e[_0x3bcf4a(0x316)][_0x3bcf4a(0xbad)](',\x20')+_0x3bcf4a(0xd54));let _0x3dd973='';const _0x4901c4=_0x28f30a[_0x3bcf4a(0x1506)][_0x3bcf4a(0x19a)]||'用户';_0x3dd973+=_0x3bcf4a(0x1340)+_0x4901c4+'\x22。\x0a';const _0x1fbd88=Object['values'](_0x28f30a['chats'])[_0x3bcf4a(0xebc)](_0x51e14b=>_0x51e14b[_0x3bcf4a(0x1423)]&&_0x51e14b[_0x3bcf4a(0x10f2)]['some'](_0x5722ce=>_0x5722ce['id']===_0xffc46e['id']));_0x1fbd88[_0x3bcf4a(0x9a1)]>0x0&&(_0x3dd973+=_0x3bcf4a(0xcb8),_0x1fbd88[_0x3bcf4a(0xf99)](_0x16e7aa=>{const _0x2fc448=_0x3bcf4a,_0x19e97b=_0x16e7aa[_0x2fc448(0x362)][_0x2fc448(0xa28)]||_0x4901c4;_0x3dd973+=_0x2fc448(0x4ce)+_0x16e7aa['name']+_0x2fc448(0x1429)+_0x19e97b+_0x2fc448(0x11dc);}));_0x3dd973+='当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。';const _0x1ab082=_0x23eb2e(_0xffc46e),_0x1d0cbf=_0x3bcf4a(0x12d2)+_0xffc46e[_0x3bcf4a(0x66c)]+_0x3bcf4a(0x911)+_0xe4ed5a+'\x20('+_0x35ccd6+_0x3bcf4a(0x14da)+(_0x395315?'你们正在一起听歌，'+_0x395315:'你们没有在听歌。')+_0x3bcf4a(0x70a)+(_0xffc46e[_0x3bcf4a(0x153f)]&&_0xffc46e[_0x3bcf4a(0x153f)][_0x3bcf4a(0x9a1)]>0x0?_0xffc46e[_0x3bcf4a(0x153f)][_0x3bcf4a(0x11c6)](_0x41ae69=>'-\x20'+_0x41ae69['content'])[_0x3bcf4a(0xbad)]('\x0a'):'-\x20(暂无)')+_0x3bcf4a(0xb25)+_0xffc46e[_0x3bcf4a(0x362)][_0x3bcf4a(0x67c)]+_0x3bcf4a(0x122e)+_0xffc46e['originalName']+_0x3bcf4a(0xfd4)+_0xffc46e[_0x3bcf4a(0xe36)]+_0x3bcf4a(0x14e2)+_0x1114c4+_0x3bcf4a(0x142e)+_0x3dd973+_0x3bcf4a(0xc53)+_0xf4d997+_0x3bcf4a(0xc53)+_0x2317c5+'\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20'+_0x1ab082+_0x3bcf4a(0x10c9)+(_0xffc46e[_0x3bcf4a(0x362)][_0x3bcf4a(0x78c)]&&_0xffc46e[_0x3bcf4a(0x362)]['aiAvatarLibrary'][_0x3bcf4a(0x9a1)]>0x0?_0xffc46e[_0x3bcf4a(0x362)][_0x3bcf4a(0x78c)][_0x3bcf4a(0x11c6)](_0x29a71f=>'-\x20'+_0x29a71f['name'])['join']('\x0a'):_0x3bcf4a(0xd5b))+_0x3bcf4a(0x151e)+(_0xffc46e[_0x3bcf4a(0x362)]['myAvatarLibrary']&&_0xffc46e[_0x3bcf4a(0x362)][_0x3bcf4a(0xbd2)][_0x3bcf4a(0x9a1)]>0x0?_0xffc46e['settings']['myAvatarLibrary'][_0x3bcf4a(0x11c6)](_0x194195=>'-\x20'+_0x194195[_0x3bcf4a(0xe36)])[_0x3bcf4a(0xbad)]('\x0a'):_0x3bcf4a(0xd5b))+_0x3bcf4a(0x13b4)+_0xffc46e[_0x3bcf4a(0x362)][_0x3bcf4a(0x1528)]+'\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。',_0x116c27=_0x4df767['map'](_0x38b35e=>({'role':_0x38b35e[_0x3bcf4a(0x9be)],'content':String(_0x38b35e['content'])}));_0x116c27['push']({'role':_0x3bcf4a(0xcc9),'content':_0x3bcf4a(0x44b)});let _0x2e8bad=_0x433634===GEMINI_API_URL,_0xccc1b0=_0x4fff3d(_0x808308,_0x50765e,_0x1d0cbf,_0x116c27);const _0x4a3d5a=_0x2e8bad?await fetch(_0xccc1b0[_0x3bcf4a(0x6d1)],_0xccc1b0[_0x3bcf4a(0x1418)]):await fetch(_0x433634+_0x3bcf4a(0x1427),{'method':_0x3bcf4a(0x655),'headers':{'Content-Type':_0x3bcf4a(0x1446),'Authorization':_0x3bcf4a(0xe83)+_0x50765e},'body':JSON[_0x3bcf4a(0xe4d)]({'model':_0x808308,'messages':[{'role':_0x3bcf4a(0x10a7),'content':_0x1d0cbf},..._0x116c27],'temperature':_0x28f30a[_0x3bcf4a(0x1062)]['apiTemperature']||0.8})});if(!_0x4a3d5a['ok']){const _0x3cba26=await _0x4a3d5a[_0x3bcf4a(0x12a2)]();throw new Error(_0x3bcf4a(0x1515)+_0x3cba26[_0x3bcf4a(0x1518)][_0x3bcf4a(0x13bc)]);}const _0x156be7=await _0x4a3d5a[_0x3bcf4a(0x12a2)](),_0x38ccf0=getGeminiResponseText(_0x156be7),_0x3f8f2e=_0x422882(_0x38ccf0),_0x198554=[];for(const _0x8f434e of _0x3f8f2e){if(_0x8f434e[_0x3bcf4a(0xb4b)]===_0x3bcf4a(0x10ca)&&typeof _0x8f434e[_0x3bcf4a(0x1047)]==='string'&&_0x8f434e[_0x3bcf4a(0x1047)]['includes']('\x0a')){const _0x30310a=_0x8f434e[_0x3bcf4a(0x1047)]['split'](/\n+/)[_0x3bcf4a(0xebc)](_0x25cc8a=>_0x25cc8a[_0x3bcf4a(0x97e)]());_0x30310a['forEach'](_0x319b2e=>{_0x198554['push']({..._0x8f434e,'content':_0x319b2e});});}else _0x198554['push'](_0x8f434e);}let _0x1953e8=Date[_0x3bcf4a(0x487)]();for(const _0x55652c of _0x198554){const _0x424f6a={'role':_0x3bcf4a(0x6d9),'senderName':_0xffc46e['originalName'],'timestamp':_0x1953e8++,'content':_0x55652c[_0x3bcf4a(0x1047)]||_0x55652c['message'],'type':_0x55652c[_0x3bcf4a(0xb4b)]||'text'};if(_0x55652c[_0x3bcf4a(0xb4b)]===_0x3bcf4a(0xda1)){if(!_0xffc46e['isGroup']){if(_0x55652c['heartfelt_voice'])_0xffc46e[_0x3bcf4a(0x28a)]=String(_0x55652c[_0x3bcf4a(0x524)]);if(_0x55652c['random_jottings'])_0xffc46e[_0x3bcf4a(0xe97)]=String(_0x55652c['random_jottings']);}continue;}_0xffc46e[_0x3bcf4a(0x12c3)][_0x3bcf4a(0x367)](_0x424f6a),_0x4cc03e(_0x424f6a,_0xffc46e),await new Promise(_0x11d247=>setTimeout(_0x11d247,Math[_0x3bcf4a(0x1337)]()*0x3e8+0x320));}await _0x5b9d83[_0x3bcf4a(0x6ce)]['put'](_0xffc46e),_0x5db8a3();}catch(_0x583bc3){console[_0x3bcf4a(0x1518)]('推进剧情失败:',_0x583bc3),await _0x34d596('操作失败',_0x3bcf4a(0x3e4)+_0x583bc3['message']);}finally{_0x48a755(_0xffc46e['id'],![]);if(!_0xffc46e[_0x3bcf4a(0x1423)]&&document[_0x3bcf4a(0x2ec)](_0x3bcf4a(0x96a))){const _0x11c5f6=document[_0x3bcf4a(0x2ec)]('chat-header-title');_0x11c5f6[_0x3bcf4a(0x589)]['opacity']=0x0,setTimeout(()=>{const _0x3e0718=_0x3bcf4a;_0x11c5f6[_0x3e0718(0x15f)]=_0xffc46e[_0x3e0718(0xe36)],_0x11c5f6[_0x3e0718(0xff6)][_0x3e0718(0x1424)](_0x3e0718(0x89a)),_0x11c5f6[_0x3e0718(0x589)][_0x3e0718(0xb92)]=0x1;},0xc8);}}}function _0x11973a(){const _0x35dc40=_0x475790,_0x407e18=document[_0x35dc40(0x2ec)](_0x35dc40(0x10af)),_0x59c395=_0x28f30a[_0x35dc40(0x1062)][_0x35dc40(0xaf0)]||_0xa4eded;_0x59c395&&_0x59c395[_0x35dc40(0x97e)]()&&(_0x407e18[_0x35dc40(0xce4)]=_0x59c395,_0x407e18[_0x35dc40(0x23f)]()[_0x35dc40(0xd6b)](_0x2a172f=>console['log'](_0x35dc40(0x1576),_0x2a172f)));}function _0x47251c(){const _0x152e91=_0x475790;if(!_0x28f30a['globalSettings'][_0x152e91(0x14f7)])return;for(const _0x1deb8d in _0x28f30a['globalSettings'][_0x152e91(0x14f7)]){const _0x4f00d6=document[_0x152e91(0x2ec)](_0x1deb8d),_0x3863b3=_0x28f30a[_0x152e91(0x1062)][_0x152e91(0x14f7)][_0x1deb8d];_0x4f00d6&&(_0x4f00d6[_0x152e91(0xdf4)]===_0x152e91(0x23e)?_0x4f00d6[_0x152e91(0xce4)]=_0x3863b3:_0x4f00d6[_0x152e91(0x15f)]=_0x3863b3);}}function _0x1fcca6(){return new Promise(_0x1428de=>{const _0xf01f45=_0x1937,_0x138562=document[_0xf01f45(0x14ae)](_0xf01f45(0x6a9));_0x138562[_0xf01f45(0xb4b)]='file',_0x138562[_0xf01f45(0xf7c)]=_0xf01f45(0xa84),_0x138562[_0xf01f45(0xf6e)]=_0x28c4b=>{const _0x1353d5=_0xf01f45,_0xe4fb5f=_0x28c4b[_0x1353d5(0x1104)][_0x1353d5(0x8d6)][0x0];if(_0xe4fb5f){const _0x4b20f9=new FileReader();_0x4b20f9['onload']=_0x589e24=>{const _0x50f170=_0x1353d5;_0x1428de(_0x589e24[_0x50f170(0x1104)]['result']);},_0x4b20f9[_0x1353d5(0x60e)](_0xe4fb5f);}else _0x1428de(null);},_0x138562['click']();});}async function _0x52f8aa(_0x332bec){const _0x2e3d46=_0x475790,_0x57427d=_0x332bec['id'],_0x2767f2=_0x332bec[_0x2e3d46(0x15f)],_0x7f7a76=await _0x33419a(_0x2e3d46(0x13e0),_0x2e3d46(0x1538),_0x2767f2);if(_0x7f7a76!==null&&_0x7f7a76[_0x2e3d46(0x97e)]()!==''){const _0x4d402c=_0x7f7a76[_0x2e3d46(0x97e)]();_0x332bec['textContent']=_0x4d402c,_0x28f30a[_0x2e3d46(0x1062)][_0x2e3d46(0x14f7)][_0x57427d]=_0x4d402c,await _0x5b9d83['globalSettings'][_0x2e3d46(0x7c3)](_0x28f30a[_0x2e3d46(0x1062)]),alert(_0x2e3d46(0x437));}}async function _0x971f49(_0x373fe2){const _0x3400f6=_0x475790,_0x17fd5d=_0x373fe2['id'],_0x527ae7=await _0x3d2f35('修改图片',[{'text':'📁\x20从本地上传','value':'local'},{'text':_0x3400f6(0x1173),'value':_0x3400f6(0x6d1)}]);let _0x5299b1=null;if(_0x527ae7===_0x3400f6(0x252))_0x5299b1=await _0x1fcca6();else _0x527ae7==='url'&&(_0x5299b1=await _0x33419a('修改图片','请输入新的图片URL：',_0x373fe2[_0x3400f6(0xce4)],_0x3400f6(0x6d1)));if(_0x5299b1&&_0x5299b1[_0x3400f6(0x97e)]()){const _0x1717b7=_0x5299b1[_0x3400f6(0x97e)]();_0x373fe2[_0x3400f6(0xce4)]=_0x1717b7,_0x28f30a['globalSettings'][_0x3400f6(0x14f7)][_0x17fd5d]=_0x1717b7,await _0x5b9d83[_0x3400f6(0x1062)]['put'](_0x28f30a['globalSettings']),alert(_0x3400f6(0xe9e));}else _0x527ae7===_0x3400f6(0x6d1)&&_0x5299b1!==null&&alert(_0x3400f6(0xf1f));}const _0x2f38d6={'getSongCache'(_0x5b74b3,_0x232598){const _0x48d9cf=_0x475790,_0x114691=(_0x232598||'all')+':'+_0x5b74b3;if(_0x28f30a[_0x48d9cf(0xc6c)]&&_0x28f30a['cache'][_0x48d9cf(0x1389)]){const _0x2acf0c=_0x28f30a['cache'][_0x48d9cf(0x1389)][_0x48d9cf(0x6b5)](_0x114691);if(_0x2acf0c&&Date[_0x48d9cf(0x487)]()-_0x2acf0c[_0x48d9cf(0x69a)]<0x36ee80)return _0x2acf0c[_0x48d9cf(0x1418)];}return null;},'setSongCache'(_0x400632,_0x5ee11e,_0x1708b0){const _0x3f27dc=_0x475790,_0x47c0d0=(_0x1708b0||_0x3f27dc(0xa92))+':'+_0x400632;if(!_0x28f30a[_0x3f27dc(0xc6c)])_0x28f30a[_0x3f27dc(0xc6c)]={};if(!_0x28f30a[_0x3f27dc(0xc6c)][_0x3f27dc(0x1389)])_0x28f30a[_0x3f27dc(0xc6c)][_0x3f27dc(0x1389)]=new Map();_0x28f30a[_0x3f27dc(0xc6c)][_0x3f27dc(0x1389)]['set'](_0x47c0d0,{'data':_0x5ee11e,'timestamp':Date[_0x3f27dc(0x487)]()});}};typeof Http_Get_External===_0x475790(0xe40)&&(window[_0x475790(0x1355)]=function(_0x1b9a61){return new Promise(_0x416231=>{const _0x454510=_0x1937;fetch(_0x1b9a61)[_0x454510(0x333)](_0x1b4da1=>_0x1b4da1[_0x454510(0x12a2)]()['catch'](()=>_0x1b4da1[_0x454510(0x10ca)]()))[_0x454510(0x333)](_0x416231)[_0x454510(0xd6b)](()=>_0x416231(null));});});async function _0x55ef34(_0x41e9d4){return await Http_Get_External(_0x41e9d4);}function _0x444036(_0x149e35){return new Promise(_0x19fd01=>{const _0x40c353=_0x1937,_0x5c7d24=new Audio();_0x5c7d24[_0x40c353(0xf79)](_0x40c353(0x118e),()=>_0x19fd01(!![]),{'once':!![]}),_0x5c7d24[_0x40c353(0xf79)]('error',()=>_0x19fd01(![]),{'once':!![]}),_0x5c7d24['src']=_0x149e35;});}async function _0x3d5a59(_0x425667,_0x5156ec){const _0x3dfd20=_0x475790;try{let _0x5c3470=_0x425667[_0x3dfd20(0x13ed)](/\s/g,'');_0x5156ec&&(_0x5c3470+='\x20'+_0x5156ec[_0x3dfd20(0x13ed)](/\s/g,''));const _0x3c8742=_0x3dfd20(0x1053)+encodeURIComponent(_0x5c3470);console[_0x3dfd20(0x415)](_0x3dfd20(0x8c0),_0x3c8742);const _0x66fddc=await fetch(_0x3c8742);if(!_0x66fddc['ok'])throw new Error(_0x3dfd20(0x395)+_0x66fddc['status']);const _0x478254=await _0x66fddc[_0x3dfd20(0x12a2)]();if(_0x478254[_0x3dfd20(0xb95)]!==0xc8||!_0x478254[_0x3dfd20(0x1418)]||_0x478254[_0x3dfd20(0x1418)][_0x3dfd20(0x9a1)]===0x0)return console[_0x3dfd20(0x415)]('网易云音乐API未返回有效结果:',_0x478254),[];return _0x478254['data'][_0x3dfd20(0x11c6)](_0x58ed09=>({'name':_0x58ed09[_0x3dfd20(0x782)],'artist':_0x58ed09[_0x3dfd20(0x682)],'id':_0x58ed09['id'],'cover':_0x58ed09[_0x3dfd20(0x12df)]||_0x3dfd20(0x44d),'source':_0x3dfd20(0xe64)}))['slice'](0x0,0x1e);}catch(_0x25fa2b){return console['error'](_0x3dfd20(0x14ef),_0x25fa2b),[];}}async function _0x42b76d(_0x508c21){const _0x1c3c90=_0x475790;try{_0x508c21=_0x508c21[_0x1c3c90(0x13ed)](/\s/g,'');const _0xe8e046=await _0x55ef34(_0x1c3c90(0x157b)+encodeURIComponent(_0x508c21));if(!_0xe8e046?.[_0x1c3c90(0x1418)]?.[_0x1c3c90(0x9a1)])return[];return _0xe8e046['data'][_0x1c3c90(0x11c6)](_0x53d98b=>({'name':_0x53d98b[_0x1c3c90(0x782)],'artist':_0x53d98b[_0x1c3c90(0x682)],'id':_0x53d98b['id'],'cover':_0x53d98b[_0x1c3c90(0x12df)]||_0x1c3c90(0x1e6),'source':'tencent'}))[_0x1c3c90(0x225)](0x0,0x1e);}catch(_0x349ef9){return console['error'](_0x1c3c90(0x9d8),_0x349ef9),[];}}async function _0x45b89b(){const _0x3aec22=_0x475790,_0x55e1d7=await _0x33419a(_0x3aec22(0xebe),'请输入\x20歌名\x20或\x20歌名-歌手');if(!_0x55e1d7||!_0x55e1d7['trim']())return;await _0x34d596('请稍候...',_0x3aec22(0x160));let _0x52e0d6=_0x55e1d7[_0x3aec22(0x97e)](),_0x3b549e='';if(_0x55e1d7['includes']('-')||_0x55e1d7[_0x3aec22(0x138a)]('–')){const _0x51e528=_0x55e1d7[_0x3aec22(0xa8a)](/[-–]/);_0x52e0d6=_0x51e528[0x0][_0x3aec22(0x97e)](),_0x3b549e=_0x51e528[_0x3aec22(0x225)](0x1)[_0x3aec22(0xbad)]('\x20')[_0x3aec22(0x97e)]();}const [_0xb36d81,_0x1ab95b]=await Promise['all']([_0x3d5a59(_0x52e0d6,_0x3b549e),_0x42b76d(_0x52e0d6)]),_0x525a8d=[..._0xb36d81,..._0x1ab95b];if(_0x525a8d['length']===0x0){await _0x34d596(_0x3aec22(0x2db),'抱歉，未能找到相关歌曲。');return;}const _0x2becdd=document[_0x3aec22(0x2ec)](_0x3aec22(0x1055)),_0x34352d=document[_0x3aec22(0x2ec)](_0x3aec22(0x6ac));_0x34352d['innerHTML']='',document[_0x3aec22(0x2ec)](_0x3aec22(0x181))[_0x3aec22(0x13b8)]=![],_0x525a8d[_0x3aec22(0xf99)](_0x130cb4=>{const _0x1aa505=_0x3aec22,_0x1913e9=document[_0x1aa505(0x14ae)](_0x1aa505(0xaa5));_0x1913e9[_0x1aa505(0xdd1)]=_0x1aa505(0x20c),_0x1913e9[_0x1aa505(0xe93)][_0x1aa505(0x75a)]=JSON[_0x1aa505(0xe4d)](_0x130cb4),_0x1913e9[_0x1aa505(0xc43)]=_0x1aa505(0xd7a)+_0x130cb4[_0x1aa505(0xe36)]+_0x1aa505(0xfe6)+_0x130cb4[_0x1aa505(0x139f)]+_0x1aa505(0x32e)+(_0x130cb4[_0x1aa505(0x5c7)]==='netease'?'网易云':_0x1aa505(0x784))+_0x1aa505(0x11f4),_0x34352d[_0x1aa505(0x998)](_0x1913e9);}),_0x2becdd[_0x3aec22(0xff6)][_0x3aec22(0xe82)]('visible');}async function _0x4376e7(_0x249d86){const _0x204f56=_0x475790;let _0x4a1d14=null,_0x47b808=_0x249d86[_0x204f56(0x5c7)];const _0x9a7c1f=_0x249d86[_0x204f56(0x5c7)]===_0x204f56(0xe64)?'https://api.vkeys.cn/v2/music/netease?id='+_0x249d86['id']:_0x204f56(0x1275)+_0x249d86['id'];let _0x56f5b1=await _0x55ef34(_0x9a7c1f);_0x56f5b1?.[_0x204f56(0x1418)]?.[_0x204f56(0x6d1)]&&(_0x4a1d14={'url':_0x56f5b1[_0x204f56(0x1418)]['url'],'id':_0x249d86['id'],'source':_0x249d86[_0x204f56(0x5c7)]});if(!_0x4a1d14){const _0x62a80b=_0x249d86[_0x204f56(0x5c7)]===_0x204f56(0xe64)?_0x204f56(0x1308):'netease',_0x3cd5d9=_0x62a80b==='tencent'?await _0x42b76d(_0x249d86[_0x204f56(0xe36)]):await _0x3d5a59(_0x249d86['name'],_0x249d86['artist']);if(_0x3cd5d9[_0x204f56(0x9a1)]>0x0){const _0x420002=_0x62a80b===_0x204f56(0xe64)?_0x204f56(0x1164)+_0x3cd5d9[0x0]['id']:_0x204f56(0x1275)+_0x3cd5d9[0x0]['id'],_0x31ae90=await _0x55ef34(_0x420002);_0x31ae90?.[_0x204f56(0x1418)]?.['url']&&(_0x4a1d14={'url':_0x31ae90[_0x204f56(0x1418)][_0x204f56(0x6d1)],'id':_0x3cd5d9[0x0]['id'],'source':_0x62a80b},_0x47b808=_0x62a80b);}}if(_0x4a1d14){_0x4a1d14[_0x204f56(0x6d1)]&&typeof _0x4a1d14[_0x204f56(0x6d1)]==='string'&&(_0x4a1d14[_0x204f56(0x6d1)]=_0x4a1d14[_0x204f56(0x6d1)]['replace'](/^http:\/\//i,_0x204f56(0x31a)));_0x249d86[_0x204f56(0x12df)]&&typeof _0x249d86[_0x204f56(0x12df)]===_0x204f56(0x863)&&(_0x249d86[_0x204f56(0x12df)]=_0x249d86[_0x204f56(0x12df)][_0x204f56(0x13ed)](/^http:\/\//i,_0x204f56(0x31a)));const _0x3c1d4a=await _0x84c4a7(_0x4a1d14['id'],_0x47b808)||'';return{'name':_0x249d86[_0x204f56(0xe36)],'artist':_0x249d86[_0x204f56(0x139f)],'src':_0x4a1d14[_0x204f56(0x6d1)],'cover':_0x249d86['cover'],'isLocal':![],'lrcContent':_0x3c1d4a};}return null;}async function _0x84c4a7(_0x2494b7,_0x1587de){const _0x4fb783=_0x475790,_0x54da46=_0x1587de===_0x4fb783(0xe64)?_0x4fb783(0x13e3)+_0x2494b7:'https://api.vkeys.cn/v2/music/tencent/lyric?id='+_0x2494b7,_0x43eb4e=await _0x55ef34(_0x54da46);if(_0x43eb4e?.[_0x4fb783(0x1418)]){const _0x367dd5=_0x43eb4e[_0x4fb783(0x1418)][_0x4fb783(0x117c)]||_0x43eb4e[_0x4fb783(0x1418)][_0x4fb783(0x1237)]||'',_0x5b52f6=_0x43eb4e[_0x4fb783(0x1418)]['trans']||_0x43eb4e['data']['tlyric']||'';return _0x367dd5+'\x0a'+_0x5b52f6;}return'';}async function _0x1fd5f6(_0x532abd){const _0x562a1c=_0x475790;if(_0x532abd<0x0||_0x532abd>=_0x79cac3[_0x562a1c(0x5fd)][_0x562a1c(0x9a1)])return;const _0x281568=await _0x3d2f35('选择歌词导入方式',[{'text':_0x562a1c(0xb7f),'value':'file'},{'text':_0x562a1c(0xa57),'value':_0x562a1c(0x1444)}]);let _0x2cc896=null;if(_0x281568===_0x562a1c(0xc9d))_0x2cc896=await new Promise(_0x42ba77=>{const _0x2ab76f=_0x562a1c,_0x111222=document[_0x2ab76f(0x2ec)](_0x2ab76f(0x99a)),_0x5bde35=_0x19b7c4=>{const _0x53d6e1=_0x2ab76f,_0x10b575=_0x19b7c4['target']['files'][0x0];if(_0x10b575){const _0x5196f9=new FileReader();_0x5196f9[_0x53d6e1(0xf2d)]=_0x31d397=>_0x42ba77(_0x31d397[_0x53d6e1(0x1104)][_0x53d6e1(0x42a)]),_0x5196f9[_0x53d6e1(0x125a)]=()=>_0x42ba77(null),_0x5196f9[_0x53d6e1(0x1137)](_0x10b575);}else _0x42ba77(null);_0x111222['removeEventListener'](_0x53d6e1(0x217),_0x5bde35),_0x111222['value']='';};_0x111222[_0x2ab76f(0xf79)](_0x2ab76f(0x217),_0x5bde35,{'once':!![]}),_0x111222['click']();});else{if(_0x281568===_0x562a1c(0x1444)){const _0x3cbfaf=await _0x33419a(_0x562a1c(0x503),_0x562a1c(0x1380),'',_0x562a1c(0x382));if(_0x3cbfaf)_0x2cc896=_0x3cbfaf[_0x562a1c(0x13ed)](/\[/g,'\x0a[')['trim']();}}_0x2cc896!==null&&(_0x79cac3['playlist'][_0x532abd][_0x562a1c(0x913)]=_0x2cc896,await _0x10fa70(),_0x79cac3[_0x562a1c(0xf35)]===_0x532abd&&(_0x79cac3['parsedLyrics']=_0x59e6cd(_0x2cc896),_0x4a096c(),_0x37977f()),await _0x34d596('成功','《'+_0x79cac3['playlist'][_0x532abd][_0x562a1c(0xe36)]+_0x562a1c(0x142a)));}async function _0x12a1c3(){const _0x1b0483=_0x475790;if(_0x79cac3[_0x1b0483(0xf35)]===-0x1)return;const _0xcfff68=_0x79cac3['playlist'][_0x79cac3[_0x1b0483(0xf35)]];if(!_0xcfff68)return;_0xcfff68['isBgClear']=!_0xcfff68['isBgClear'],await _0x10fa70();const _0x6ffb3d=document['querySelector']('.music-player-window'),_0x31bb40=document['getElementById'](_0x1b0483(0x2c0));_0x6ffb3d[_0x1b0483(0xff6)][_0x1b0483(0x14c8)](_0x1b0483(0x1532),_0xcfff68[_0x1b0483(0xf61)]),_0x31bb40[_0x1b0483(0xff6)]['toggle'](_0x1b0483(0xd43),_0xcfff68['isBgClear']);}function _0x72e25c(){const _0x5462cc=_0x475790,_0xa9ae24=document['getElementById'](_0x5462cc(0x618)),_0x1be60c=document[_0x5462cc(0x2ec)](_0x5462cc(0xa2c));_0xa9ae24&&_0x1be60c&&(_0xa9ae24[_0x5462cc(0xff6)][_0x5462cc(0x14c8)](_0x5462cc(0x149d)),_0x1be60c[_0x5462cc(0xff6)][_0x5462cc(0x14c8)]('active'));}function _0x4f3f67(){const _0x1c5d31=_0x475790,_0x3a1757=document['querySelector'](_0x1c5d31(0x515)),_0x5284a3=document[_0x1c5d31(0x2ec)]('music-player-overlay');_0x3a1757&&_0x5284a3&&(_0x3a1757[_0x1c5d31(0xff6)]['toggle']('fullscreen'),_0x5284a3[_0x1c5d31(0xff6)][_0x1c5d31(0x14c8)](_0x1c5d31(0x764)));}window[_0x475790(0xe7d)]=_0x4f3f67;async function _0x3ad699(){const _0x1ed54c=_0x475790;if(_0x79cac3['playlist'][_0x1ed54c(0x9a1)]===0x0){alert('播放列表是空的，无需清理。');return;}const _0x226db4=await _0x4436ba(_0x1ed54c(0x587),_0x1ed54c(0xfe1),{'confirmText':_0x1ed54c(0x24a)});if(!_0x226db4)return;await _0x34d596(_0x1ed54c(0x13e4),_0x1ed54c(0x116d)+_0x79cac3[_0x1ed54c(0x5fd)][_0x1ed54c(0x9a1)]+'\x20首歌曲，这可能需要一些时间...');const _0x5f3be9=_0x79cac3[_0x1ed54c(0x5fd)]['length'],_0x366099=[],_0x590591=[],_0x19b8af=_0x79cac3['playlist'][_0x1ed54c(0x11c6)](async _0x5e15f0=>{const _0x9362fd=_0x1ed54c;if(_0x5e15f0[_0x9362fd(0x444)]){_0x366099[_0x9362fd(0x367)](_0x5e15f0);return;}const _0x31bbbb=await _0x444036(_0x5e15f0[_0x9362fd(0xce4)]);_0x31bbbb?_0x366099[_0x9362fd(0x367)](_0x5e15f0):(_0x590591[_0x9362fd(0x367)](_0x5e15f0['name']),console[_0x9362fd(0x664)](_0x9362fd(0x127e)+_0x5e15f0[_0x9362fd(0xe36)]+'\x20-\x20'+_0x5e15f0[_0x9362fd(0xce4)]));});await Promise[_0x1ed54c(0xa92)](_0x19b8af);const _0x3e7502=_0x5f3be9-_0x366099[_0x1ed54c(0x9a1)];if(_0x3e7502>0x0){const _0x3b4422=_0x79cac3[_0x1ed54c(0x5fd)][_0x79cac3['currentIndex']],_0x46fb0b=_0x590591[_0x1ed54c(0x138a)](_0x3b4422?.[_0x1ed54c(0xe36)]);_0x79cac3['playlist']=_0x366099,await _0x10fa70();if(_0x46fb0b)_0x4da7ed[_0x1ed54c(0x964)](),_0x4da7ed[_0x1ed54c(0xce4)]='',_0x79cac3[_0x1ed54c(0xf35)]=_0x79cac3[_0x1ed54c(0x5fd)][_0x1ed54c(0x9a1)]>0x0?0x0:-0x1,_0x79cac3[_0x1ed54c(0x25e)]=![];else _0x3b4422&&(_0x79cac3[_0x1ed54c(0xf35)]=_0x79cac3[_0x1ed54c(0x5fd)][_0x1ed54c(0x535)](_0x3ac8fb=>_0x3ac8fb[_0x1ed54c(0xce4)]===_0x3b4422['src']));_0x1f11de(),_0xdde111(),await _0x34d596(_0x1ed54c(0x8ed),'成功移除了\x20'+_0x3e7502+_0x1ed54c(0xa27)+_0x590591[_0x1ed54c(0xbad)]('\x0a-\x20'));}else await _0x34d596(_0x1ed54c(0xc93),_0x1ed54c(0x486));}function _0x435075(){const _0x5b4d21=_0x475790,_0x58e36e=document[_0x5b4d21(0x2ec)](_0x5b4d21(0x1007));_0x58e36e[_0x5b4d21(0xff6)][_0x5b4d21(0x14c8)](_0x5b4d21(0xf6d),!!_0x28f30a['globalSettings'][_0x5b4d21(0x1f3)]);}async function _0x2e0bb3(){const _0x3faab9=_0x475790,_0x4e1e06=document[_0x3faab9(0x2ec)](_0x3faab9(0x858)),_0x9f9c07=document[_0x3faab9(0x2ec)](_0x3faab9(0x3d2));_0x9f9c07[_0x3faab9(0xc43)]='';const _0x3c2fe1=[];_0x3c2fe1['push']({'text':_0x3faab9(0x12af),'value':_0x3faab9(0xa92),'isDanger':!![]});const _0x43d08b=_0x28f30a[_0x3faab9(0x1506)][_0x3faab9(0x19a)]||'我';_0x3c2fe1[_0x3faab9(0x367)]({'text':_0x3faab9(0xc5b)+_0x43d08b+'\x20的动态\x20(用户)','value':_0x3faab9(0xcc9)}),Object[_0x3faab9(0x74e)](_0x28f30a['chats'])[_0x3faab9(0xf99)](_0x446fc4=>{const _0x4c60a6=_0x3faab9;!_0x446fc4['isGroup']&&_0x3c2fe1[_0x4c60a6(0x367)]({'text':_0x4c60a6(0xc5b)+_0x446fc4[_0x4c60a6(0xe36)]+'\x20的动态\x20(角色)','value':_0x446fc4['id']});});try{const _0x5c1a55=await _0x5b9d83['npcs'][_0x3faab9(0x14b5)]();_0x5c1a55['length']>0x0&&(_0x3c2fe1['push']({'isSeparator':!![],'text':_0x3faab9(0x1a1)}),_0x5c1a55[_0x3faab9(0xf99)](_0xbfc3aa=>{const _0x164dd5=_0x3faab9;_0x3c2fe1[_0x164dd5(0x367)]({'text':'仅清空\x20'+_0xbfc3aa[_0x164dd5(0xe36)]+_0x164dd5(0x118a),'value':'npc_'+_0xbfc3aa['id']});}));}catch(_0x35ae9c){console[_0x3faab9(0x1518)](_0x3faab9(0xa32),_0x35ae9c);}_0x3c2fe1['forEach'](_0x3db4ae=>{const _0x1a2a79=_0x3faab9;if(_0x3db4ae['isSeparator']){const _0x29122c=document[_0x1a2a79(0x14ae)]('div');_0x29122c[_0x1a2a79(0x15f)]=_0x3db4ae[_0x1a2a79(0x10ca)],_0x29122c[_0x1a2a79(0x589)][_0x1a2a79(0x57a)]=_0x1a2a79(0x1242),_0x9f9c07['appendChild'](_0x29122c);return;}const _0x4246ce=document[_0x1a2a79(0x14ae)](_0x1a2a79(0xaa5));_0x4246ce[_0x1a2a79(0xdd1)]=_0x1a2a79(0x10a9),_0x3db4ae[_0x1a2a79(0xe4b)]&&_0x4246ce[_0x1a2a79(0xff6)][_0x1a2a79(0xe82)](_0x1a2a79(0xcf6)),_0x4246ce[_0x1a2a79(0xe93)]['targetId']=_0x3db4ae[_0x1a2a79(0x11a4)],_0x4246ce['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x3db4ae[_0x1a2a79(0x10ca)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x9f9c07[_0x1a2a79(0x998)](_0x4246ce);}),_0x4e1e06[_0x3faab9(0xff6)][_0x3faab9(0xe82)]('visible');}async function _0x29c0d7(){const _0x1c762c=_0x475790,_0x2dd1bf=document[_0x1c762c(0x5d6)](_0x1c762c(0x1cf));if(_0x2dd1bf[_0x1c762c(0x9a1)]===0x0){alert('请至少选择一个要清空的范围。');return;}const _0x1eb715=Array[_0x1c762c(0x13d1)](_0x2dd1bf)[_0x1c762c(0x11c6)](_0x414fe0=>_0x414fe0['dataset'][_0x1c762c(0x114e)]);let _0x51c518=[];_0x1eb715[_0x1c762c(0x138a)](_0x1c762c(0xa92))?_0x51c518[_0x1c762c(0x367)](_0x1c762c(0x4e9)):(_0x1eb715[_0x1c762c(0x138a)](_0x1c762c(0xcc9))&&_0x51c518[_0x1c762c(0x367)]('“'+_0x28f30a[_0x1c762c(0x1506)][_0x1c762c(0x19a)]+'”'),_0x1eb715[_0x1c762c(0xf99)](_0x128e36=>{const _0x5b16b6=_0x1c762c,_0x450656=_0x28f30a[_0x5b16b6(0x6ce)][_0x128e36];_0x450656&&_0x51c518['push']('“'+_0x450656[_0x5b16b6(0xe36)]+'”');}));const _0x5727fc='此操作将永久删除\x20'+_0x51c518['join']('、\x20')+_0x1c762c(0x632),_0x5adc42=await _0x4436ba(_0x1c762c(0x889),_0x5727fc,{'confirmButtonClass':_0x1c762c(0xd8f),'confirmText':_0x1c762c(0x67b)});if(!_0x5adc42)return;try{_0x1eb715[_0x1c762c(0x138a)](_0x1c762c(0xa92))?await _0x5b9d83[_0x1c762c(0xc7a)][_0x1c762c(0xe98)]():await _0x5b9d83[_0x1c762c(0xc7a)][_0x1c762c(0x67e)](_0x1c762c(0xe87))[_0x1c762c(0x3fc)](_0x1eb715)['delete'](),_0x4e343b=await _0x5b9d83[_0x1c762c(0xc7a)][_0x1c762c(0x106d)]('timestamp')[_0x1c762c(0x6c9)]()[_0x1c762c(0x14b5)](),_0x5adb76=0x0,await _0x472608(),document[_0x1c762c(0x2ec)](_0x1c762c(0x858))[_0x1c762c(0xff6)][_0x1c762c(0x1424)](_0x1c762c(0x149d)),await _0x34d596(_0x1c762c(0x699),'选定范围内的动态已被清空。');}catch(_0x1b946a){console[_0x1c762c(0x1518)](_0x1c762c(0x14cb),_0x1b946a),await _0x34d596(_0x1c762c(0x221),_0x1c762c(0x34b)+_0x1b946a[_0x1c762c(0x13bc)]);}}async function _0x22c814(_0x3bacea){const _0x3828a0=_0x475790,_0x1690ed=await _0x4436ba(_0x3828a0(0x10d9),_0x3828a0(0x411),{'confirmButtonClass':'btn-danger','confirmText':_0x3828a0(0x10d9)});if(_0x1690ed){const _0x23727f=_0x28f30a['chats'][_0x28f30a['activeChatId']];if(!_0x23727f||!_0x23727f[_0x3828a0(0x2be)])return;const _0x223389=_0x23727f[_0x3828a0(0x2be)][_0x3828a0(0x535)](_0x454e99=>_0x454e99['timestamp']===_0x3bacea);if(_0x223389===-0x1)return;const _0x2ce5ec=_0x223389===_0x23727f[_0x3828a0(0x2be)][_0x3828a0(0x9a1)]-0x1;_0x23727f[_0x3828a0(0x2be)]=_0x23727f['thoughtsHistory'][_0x3828a0(0xebc)](_0x51a009=>_0x51a009[_0x3828a0(0x69a)]!==_0x3bacea);if(_0x2ce5ec){if(_0x23727f[_0x3828a0(0x2be)]['length']>0x0){const _0x5d57a8=_0x23727f[_0x3828a0(0x2be)][_0x23727f['thoughtsHistory'][_0x3828a0(0x9a1)]-0x1];_0x23727f[_0x3828a0(0x28a)]=_0x5d57a8[_0x3828a0(0x28a)],_0x23727f[_0x3828a0(0xe97)]=_0x5d57a8['randomJottings'];const _0xdd2834=document[_0x3828a0(0x2ec)](_0x3828a0(0x74f)),_0x4c6aee=document[_0x3828a0(0x2ec)](_0x3828a0(0x7ad));if(_0xdd2834)_0xdd2834[_0x3828a0(0x15f)]=_0x23727f['heartfeltVoice'];if(_0x4c6aee)_0x4c6aee[_0x3828a0(0x15f)]=_0x23727f['randomJottings'];console[_0x3828a0(0x415)](_0x3828a0(0x11ec));}else{_0x23727f[_0x3828a0(0x28a)]=_0x3828a0(0x4e6),_0x23727f[_0x3828a0(0xe97)]=_0x3828a0(0x4e6);const _0x36417f=document[_0x3828a0(0x2ec)]('profile-heartfelt-voice'),_0x21a0a2=document[_0x3828a0(0x2ec)](_0x3828a0(0x7ad));if(_0x36417f)_0x36417f[_0x3828a0(0x15f)]=_0x23727f[_0x3828a0(0x28a)];if(_0x21a0a2)_0x21a0a2[_0x3828a0(0x15f)]=_0x23727f['randomJottings'];console[_0x3828a0(0x415)](_0x3828a0(0xbd5));}}await _0x5b9d83[_0x3828a0(0x6ce)][_0x3828a0(0x7c3)](_0x23727f),_0x38eb80(),await _0x34d596('成功',_0x3828a0(0x1487));}}document[_0x475790(0x2ec)]('thoughts-history-list')['addEventListener'](_0x475790(0x1177),_0xd9881e=>{const _0x5c514e=_0x475790,_0x2384ac=_0xd9881e[_0x5c514e(0x1104)]['closest'](_0x5c514e(0x746));if(_0x2384ac){const _0x142cc4=parseInt(_0x2384ac[_0x5c514e(0xe93)][_0x5c514e(0x69a)]);!isNaN(_0x142cc4)&&_0x22c814(_0x142cc4);}});async function _0x30f40a(){const _0x2fa1e2=_0x475790,_0x53e9b8=document[_0x2fa1e2(0x2ec)](_0x2fa1e2(0x1147));_0x53e9b8[_0x2fa1e2(0xc43)]=_0x2fa1e2(0x7ee);const _0x510802=await _0x5b9d83[_0x2fa1e2(0x8b9)][_0x2fa1e2(0x67e)]('type')['equals'](_0x2fa1e2(0x1296))[_0x2fa1e2(0x14b5)]();_0x510802[_0x2fa1e2(0xf99)](_0x27af19=>{const _0x3c3085=_0x2fa1e2,_0x47fc63=document[_0x3c3085(0x14ae)](_0x3c3085(0x29d));_0x47fc63['value']=_0x27af19['id'],_0x47fc63[_0x3c3085(0x15f)]=_0x27af19[_0x3c3085(0xe36)],_0x53e9b8[_0x3c3085(0x998)](_0x47fc63);});}async function _0x4bc387(){const _0x4bd51b=_0x475790,_0x26b81e=document[_0x4bd51b(0x2ec)](_0x4bd51b(0x1147)),_0x19f12a=parseInt(_0x26b81e[_0x4bd51b(0x11a4)]);if(isNaN(_0x19f12a))return;const _0x9b134d=await _0x5b9d83[_0x4bd51b(0x8b9)][_0x4bd51b(0x6b5)](_0x19f12a);if(_0x9b134d){const _0x6bf02d=document[_0x4bd51b(0x2ec)](_0x4bd51b(0x1247));_0x6bf02d[_0x4bd51b(0x11a4)]=_0x9b134d[_0x4bd51b(0x11a4)],_0x276bb0(_0x9b134d[_0x4bd51b(0x11a4)]);}}async function _0x26b130(){const _0x224832=_0x475790,_0x2e8cf3=await _0x33419a(_0x224832(0x9f0),_0x224832(0x112f));if(!_0x2e8cf3||!_0x2e8cf3['trim']())return;const _0xa6cc2c=document[_0x224832(0x2ec)](_0x224832(0x1247))[_0x224832(0x11a4)],_0x8e3507=await _0x5b9d83['appearancePresets'][_0x224832(0x67e)]({'name':_0x2e8cf3[_0x224832(0x97e)](),'type':_0x224832(0x1296)})['first']();if(_0x8e3507){const _0x372bf9=await _0x4436ba(_0x224832(0xa81),_0x224832(0xfcb)+_0x2e8cf3[_0x224832(0x97e)]()+_0x224832(0x10c3),{'confirmButtonClass':_0x224832(0xd8f)});if(!_0x372bf9)return;await _0x5b9d83['appearancePresets'][_0x224832(0x130a)](_0x8e3507['id'],{'value':_0xa6cc2c});}else await _0x5b9d83['appearancePresets']['add']({'name':_0x2e8cf3[_0x224832(0x97e)](),'type':'global_css','value':_0xa6cc2c});await _0x30f40a(),alert(_0x224832(0x13a5));}async function _0x212377(){const _0x39e1f1=_0x475790,_0x52b06b=document[_0x39e1f1(0x2ec)](_0x39e1f1(0x1147)),_0x53b8c2=parseInt(_0x52b06b[_0x39e1f1(0x11a4)]);if(isNaN(_0x53b8c2)){alert(_0x39e1f1(0x9bd));return;}const _0x4af7b2=await _0x5b9d83[_0x39e1f1(0x8b9)][_0x39e1f1(0x6b5)](_0x53b8c2);if(!_0x4af7b2)return;const _0x47368=await _0x4436ba(_0x39e1f1(0x3c5),_0x39e1f1(0x119d)+_0x4af7b2['name']+'”\x20吗？',{'confirmButtonClass':_0x39e1f1(0xd8f)});_0x47368&&(await _0x5b9d83[_0x39e1f1(0x8b9)][_0x39e1f1(0x54b)](_0x53b8c2),await _0x30f40a(),alert(_0x39e1f1(0x818)));}async function _0x4f766d(){const _0x1c26e3=_0x475790,_0x2cfeda=document[_0x1c26e3(0x2ec)](_0x1c26e3(0x6fd));_0x2cfeda[_0x1c26e3(0xc43)]=_0x1c26e3(0x7ee);const _0x129a0b=await _0x5b9d83['appearancePresets']['where']('type')[_0x1c26e3(0x129a)](_0x1c26e3(0xa86))[_0x1c26e3(0x14b5)]();_0x129a0b['forEach'](_0xa733ca=>{const _0x26bf15=_0x1c26e3,_0x331e33=document[_0x26bf15(0x14ae)](_0x26bf15(0x29d));_0x331e33[_0x26bf15(0x11a4)]=_0xa733ca['id'],_0x331e33[_0x26bf15(0x15f)]=_0xa733ca[_0x26bf15(0xe36)],_0x2cfeda[_0x26bf15(0x998)](_0x331e33);});}async function _0x44cade(){const _0x1f5ee7=_0x475790,_0xb3c49c=document[_0x1f5ee7(0x2ec)](_0x1f5ee7(0x6fd)),_0x5b83a6=parseInt(_0xb3c49c[_0x1f5ee7(0x11a4)]);if(isNaN(_0x5b83a6))return;const _0x189303=await _0x5b9d83[_0x1f5ee7(0x8b9)]['get'](_0x5b83a6);if(_0x189303){const _0x36a92c=document['getElementById']('font-url-input');_0x36a92c[_0x1f5ee7(0x11a4)]=_0x189303['value'],_0x155408(_0x189303[_0x1f5ee7(0x11a4)],!![]);}}async function _0x35aa47(){const _0x1ccc7d=_0x475790,_0x343cb3=await _0x33419a(_0x1ccc7d(0x707),'请输入预设名称');if(!_0x343cb3||!_0x343cb3[_0x1ccc7d(0x97e)]())return;const _0x332511=document[_0x1ccc7d(0x2ec)](_0x1ccc7d(0x472))[_0x1ccc7d(0x11a4)][_0x1ccc7d(0x97e)]();if(!_0x332511){alert(_0x1ccc7d(0x7fc));return;}const _0xedfc36=await _0x5b9d83['appearancePresets'][_0x1ccc7d(0x67e)]({'name':_0x343cb3[_0x1ccc7d(0x97e)](),'type':_0x1ccc7d(0xa86)})[_0x1ccc7d(0x942)]();if(_0xedfc36){const _0x2c3650=await _0x4436ba(_0x1ccc7d(0xa81),'名为\x20“'+_0x343cb3['trim']()+_0x1ccc7d(0x10c3),{'confirmButtonClass':_0x1ccc7d(0xd8f)});if(!_0x2c3650)return;await _0x5b9d83[_0x1ccc7d(0x8b9)][_0x1ccc7d(0x130a)](_0xedfc36['id'],{'value':_0x332511});}else await _0x5b9d83['appearancePresets'][_0x1ccc7d(0xe82)]({'name':_0x343cb3[_0x1ccc7d(0x97e)](),'type':'font','value':_0x332511});await _0x4f766d(),alert(_0x1ccc7d(0x61f));}async function _0x541882(){const _0x142f7c=_0x475790,_0x125ceb=document[_0x142f7c(0x2ec)]('font-preset-select'),_0x395372=parseInt(_0x125ceb[_0x142f7c(0x11a4)]);if(isNaN(_0x395372)){alert('请先从下拉框中选择一个要删除的预设。');return;}const _0x3e6925=await _0x5b9d83['appearancePresets'][_0x142f7c(0x6b5)](_0x395372);if(!_0x3e6925)return;const _0x3da4db=await _0x4436ba(_0x142f7c(0x3c5),_0x142f7c(0x119d)+_0x3e6925[_0x142f7c(0xe36)]+_0x142f7c(0x52e),{'confirmButtonClass':_0x142f7c(0xd8f)});_0x3da4db&&(await _0x5b9d83[_0x142f7c(0x8b9)][_0x142f7c(0x54b)](_0x395372),await _0x4f766d(),alert('预设已删除。'));}async function _0x5ef78d(){const _0x173dbb=_0x475790,_0x593d38=document[_0x173dbb(0x2ec)](_0x173dbb(0x428));_0x593d38[_0x173dbb(0xc43)]=_0x173dbb(0x7ee);const _0x41d690=await _0x5b9d83[_0x173dbb(0x8b9)][_0x173dbb(0x67e)]('type')[_0x173dbb(0x129a)](_0x173dbb(0x6e4))[_0x173dbb(0x14b5)]();_0x41d690[_0x173dbb(0xf99)](_0x511ad1=>{const _0x95b2c6=_0x173dbb,_0x1c38af=document[_0x95b2c6(0x14ae)](_0x95b2c6(0x29d));_0x1c38af['value']=_0x511ad1['id'],_0x1c38af[_0x95b2c6(0x15f)]=_0x511ad1[_0x95b2c6(0xe36)],_0x593d38[_0x95b2c6(0x998)](_0x1c38af);});const _0x3dd71a={'wallpaper':_0x28f30a['globalSettings'][_0x173dbb(0x638)],'cphoneWallpaper':_0x28f30a[_0x173dbb(0x1062)][_0x173dbb(0x152d)],'globalChatBackground':_0x28f30a[_0x173dbb(0x1062)]['globalChatBackground'],'appIcons':_0x28f30a[_0x173dbb(0x1062)][_0x173dbb(0x12e8)],'cphoneAppIcons':_0x28f30a[_0x173dbb(0x1062)][_0x173dbb(0x978)],'chatActionButtonsOrder':_0x28f30a[_0x173dbb(0x1062)][_0x173dbb(0x128e)],'theme':localStorage[_0x173dbb(0x11c3)](_0x173dbb(0x823))||_0x173dbb(0x883),'showStatusBar':_0x28f30a[_0x173dbb(0x1062)][_0x173dbb(0x1f3)],'notificationSoundUrl':_0x28f30a[_0x173dbb(0x1062)][_0x173dbb(0xaf0)],'widgetData':_0x28f30a[_0x173dbb(0x1062)][_0x173dbb(0x14f7)]};let _0x24078e=null;for(const _0x528155 of _0x41d690){if(JSON[_0x173dbb(0xe4d)](_0x528155['value'])===JSON[_0x173dbb(0xe4d)](_0x3dd71a)){_0x24078e=_0x528155['id'];break;}}_0x24078e?_0x593d38['value']=_0x24078e:_0x593d38[_0x173dbb(0x11a4)]='';}async function _0x41eb62(){const _0x309810=_0x475790,_0x16302b=document[_0x309810(0x2ec)](_0x309810(0x428)),_0x40d23f=parseInt(_0x16302b[_0x309810(0x11a4)]);if(isNaN(_0x40d23f))return;const _0x52ff0b=await _0x5b9d83[_0x309810(0x8b9)][_0x309810(0x6b5)](_0x40d23f);if(_0x52ff0b&&_0x52ff0b[_0x309810(0x11a4)]){const _0x48ab57=_0x52ff0b[_0x309810(0x11a4)];Object['assign'](_0x28f30a[_0x309810(0x1062)],_0x48ab57),_0x472780(_0x48ab57[_0x309810(0x2a7)]||_0x309810(0x883)),await _0x5b9d83['globalSettings'][_0x309810(0x7c3)](_0x28f30a[_0x309810(0x1062)]),_0x1993ff(),_0x543c4d(),_0x3b4945(),_0x5d626d(),_0x435075(),_0x47251c(),_0x1bf18e(),alert(_0x309810(0xc20)+_0x52ff0b['name']+'”');}}async function _0x57e27b(){const _0x53913f=_0x475790,_0x281305=await _0x33419a(_0x53913f(0x112e),_0x53913f(0x112f));if(!_0x281305||!_0x281305[_0x53913f(0x97e)]())return;const _0xd5e0be={'wallpaper':_0x28f30a['globalSettings'][_0x53913f(0x638)],'cphoneWallpaper':_0x28f30a[_0x53913f(0x1062)][_0x53913f(0x152d)],'globalChatBackground':_0x28f30a[_0x53913f(0x1062)][_0x53913f(0x9b7)],'appIcons':_0x28f30a[_0x53913f(0x1062)][_0x53913f(0x12e8)],'cphoneAppIcons':_0x28f30a[_0x53913f(0x1062)][_0x53913f(0x978)],'chatActionButtonsOrder':_0x28f30a[_0x53913f(0x1062)][_0x53913f(0x128e)],'theme':localStorage[_0x53913f(0x11c3)]('ephone-theme')||_0x53913f(0x883),'showStatusBar':_0x28f30a[_0x53913f(0x1062)][_0x53913f(0x1f3)],'notificationSoundUrl':_0x28f30a[_0x53913f(0x1062)][_0x53913f(0xaf0)],'widgetData':_0x28f30a['globalSettings'][_0x53913f(0x14f7)]},_0x2d5090=await _0x5b9d83['appearancePresets'][_0x53913f(0x67e)]({'name':_0x281305[_0x53913f(0x97e)](),'type':_0x53913f(0x6e4)})['first']();if(_0x2d5090){const _0x57d205=await _0x4436ba(_0x53913f(0xa81),'名为\x20“'+_0x281305[_0x53913f(0x97e)]()+_0x53913f(0x10c3),{'confirmButtonClass':'btn-danger'});if(!_0x57d205)return;await _0x5b9d83[_0x53913f(0x8b9)][_0x53913f(0x130a)](_0x2d5090['id'],{'value':_0xd5e0be});}else await _0x5b9d83[_0x53913f(0x8b9)][_0x53913f(0xe82)]({'name':_0x281305[_0x53913f(0x97e)](),'type':'appearance','value':_0xd5e0be});await _0x5ef78d(),alert(_0x53913f(0x1414));}async function _0x326b6a(){const _0x5208e7=_0x475790,_0x3e8371=document[_0x5208e7(0x2ec)]('appearance-preset-select'),_0x537157=parseInt(_0x3e8371[_0x5208e7(0x11a4)]);if(isNaN(_0x537157)){alert(_0x5208e7(0x9bd));return;}const _0xb18aad=await _0x5b9d83[_0x5208e7(0x8b9)][_0x5208e7(0x6b5)](_0x537157);if(!_0xb18aad)return;const _0x2d6ddf=await _0x4436ba(_0x5208e7(0x3c5),_0x5208e7(0x119d)+_0xb18aad['name']+_0x5208e7(0x52e),{'confirmButtonClass':'btn-danger'});_0x2d6ddf&&(await _0x5b9d83[_0x5208e7(0x8b9)][_0x5208e7(0x54b)](_0x537157),await _0x5ef78d(),alert(_0x5208e7(0x818)));}async function _0x514a81(){const _0x391210=_0x475790,_0x34fcd2=document[_0x391210(0x2ec)]('theme-preset-select');_0x34fcd2[_0x391210(0xc43)]='<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>';const _0x1da4ae=await _0x5b9d83[_0x391210(0x8b9)][_0x391210(0x67e)](_0x391210(0xb4b))[_0x391210(0x129a)](_0x391210(0x1005))[_0x391210(0x14b5)]();_0x1da4ae[_0x391210(0xf99)](_0x4d1f8f=>{const _0x396e9e=_0x391210,_0x51d066=document[_0x396e9e(0x14ae)](_0x396e9e(0x29d));_0x51d066[_0x396e9e(0x11a4)]=_0x4d1f8f['id'],_0x51d066[_0x396e9e(0x15f)]=_0x4d1f8f[_0x396e9e(0xe36)],_0x34fcd2[_0x396e9e(0x998)](_0x51d066);});}async function _0xf7d0eb(){const _0x3c9dac=_0x475790,_0x4742f3=document['getElementById'](_0x3c9dac(0xa79)),_0x7aa8a=parseInt(_0x4742f3[_0x3c9dac(0x11a4)]);if(isNaN(_0x7aa8a))return;const _0x21c02a=await _0x5b9d83[_0x3c9dac(0x8b9)]['get'](_0x7aa8a);if(_0x21c02a){const _0x4c5105=_0x21c02a['value'][_0x3c9dac(0x835)]||_0x3c9dac(0x44a),_0x34e513=_0x21c02a[_0x3c9dac(0x11a4)][_0x3c9dac(0x1334)]||'',_0x3d0732=document[_0x3c9dac(0x765)]('input[name=\x22theme-select\x22][value=\x22'+_0x4c5105+'\x22]');_0x3d0732&&(_0x3d0732['checked']=!![]);const _0xb92c4f=document[_0x3c9dac(0x2ec)](_0x3c9dac(0x12b0));_0xb92c4f[_0x3c9dac(0x11a4)]=_0x34e513,_0xa23065();}}async function _0x3ec693(){const _0x4a0a71=_0x475790,_0x32b181=await _0x33419a(_0x4a0a71(0xf37),_0x4a0a71(0x112f));if(!_0x32b181||!_0x32b181[_0x4a0a71(0x97e)]())return;const _0x22a0b0=document['querySelector'](_0x4a0a71(0x13ad)),_0x513ab4=_0x22a0b0?_0x22a0b0[_0x4a0a71(0x11a4)]:_0x4a0a71(0x44a),_0x5db660=document['getElementById'](_0x4a0a71(0x12b0))[_0x4a0a71(0x11a4)][_0x4a0a71(0x97e)](),_0x3538a2={'base':_0x513ab4,'custom':_0x5db660},_0x1ce38c=await _0x5b9d83[_0x4a0a71(0x8b9)]['where']({'name':_0x32b181[_0x4a0a71(0x97e)](),'type':'bubble_theme'})['first']();if(_0x1ce38c){const _0x15dfc8=await _0x4436ba('覆盖预设','名为\x20“'+_0x32b181[_0x4a0a71(0x97e)]()+_0x4a0a71(0x10c3),{'confirmButtonClass':'btn-danger'});if(!_0x15dfc8)return;await _0x5b9d83[_0x4a0a71(0x8b9)][_0x4a0a71(0x130a)](_0x1ce38c['id'],{'value':_0x3538a2});}else await _0x5b9d83[_0x4a0a71(0x8b9)][_0x4a0a71(0xe82)]({'name':_0x32b181[_0x4a0a71(0x97e)](),'type':_0x4a0a71(0x1005),'value':_0x3538a2});await _0x514a81(),alert(_0x4a0a71(0xcff));}async function _0x390e5b(){const _0x4af0cc=_0x475790,_0x4a67f9=document[_0x4af0cc(0x2ec)]('theme-preset-select'),_0x30ec50=parseInt(_0x4a67f9[_0x4af0cc(0x11a4)]);if(isNaN(_0x30ec50)){alert('请先从下拉框中选择一个要删除的预设。');return;}const _0x19268d=await _0x5b9d83[_0x4af0cc(0x8b9)][_0x4af0cc(0x6b5)](_0x30ec50);if(!_0x19268d)return;const _0x5bc6e2=await _0x4436ba(_0x4af0cc(0x3c5),_0x4af0cc(0x119d)+_0x19268d['name']+_0x4af0cc(0x52e),{'confirmButtonClass':_0x4af0cc(0xd8f)});_0x5bc6e2&&(await _0x5b9d83['appearancePresets'][_0x4af0cc(0x54b)](_0x30ec50),await _0x514a81(),alert('预设已删除。'));}async function _0x32dcf5(){const _0x430d40=_0x475790;await _0x2b0e48(),document[_0x430d40(0x2ec)](_0x430d40(0x14d2))[_0x430d40(0xff6)]['add'](_0x430d40(0x149d));}async function _0x2b0e48(){const _0x4966cc=_0x475790,_0x4d05e6=document['getElementById'](_0x4966cc(0x103d)),_0x59ab2b=await _0x5b9d83[_0x4966cc(0xc70)][_0x4966cc(0x14b5)]();_0x4d05e6[_0x4966cc(0xc43)]='';if(_0x59ab2b[_0x4966cc(0x9a1)]===0x0){_0x4d05e6[_0x4966cc(0xc43)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>';return;}_0x59ab2b[_0x4966cc(0xf99)](_0x482e6d=>{const _0x1fb311=_0x4966cc,_0xa397f7=document[_0x1fb311(0x14ae)](_0x1fb311(0xaa5));_0xa397f7[_0x1fb311(0xdd1)]=_0x1fb311(0xe3c),_0xa397f7['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x482e6d['name']+_0x1fb311(0x643)+_0x482e6d['id']+_0x1fb311(0x13da),_0x4d05e6[_0x1fb311(0x998)](_0xa397f7);});}async function _0xf5e3dc(){const _0x30284d=_0x475790,_0x62c5a5=document[_0x30284d(0x2ec)](_0x30284d(0x930)),_0x1a93eb=_0x62c5a5[_0x30284d(0x11a4)][_0x30284d(0x97e)]();if(!_0x1a93eb){alert('分类名不能为空！');return;}const _0x1a0504=await _0x5b9d83[_0x30284d(0xc70)][_0x30284d(0x67e)](_0x30284d(0xe36))[_0x30284d(0x129a)](_0x1a93eb)['first']();if(_0x1a0504){alert('分类\x20\x22'+_0x1a93eb+_0x30284d(0xd64));return;}await _0x5b9d83['stickerCategories']['add']({'name':_0x1a93eb}),_0x62c5a5[_0x30284d(0x11a4)]='',await _0x2b0e48();}async function _0x1ddd46(_0x5399bc){const _0x49ae95=_0x475790,_0x294c08=await _0x5b9d83['stickerCategories'][_0x49ae95(0x6b5)](_0x5399bc);if(!_0x294c08)return;const _0x312e7b=await _0x5b9d83[_0x49ae95(0xf28)]['where'](_0x49ae95(0x10ce))[_0x49ae95(0x129a)](_0x5399bc)[_0x49ae95(0xdd4)](),_0x1d42bd=_0x312e7b>0x0?_0x49ae95(0xaea)+_0x294c08[_0x49ae95(0xe36)]+_0x49ae95(0x1331)+_0x312e7b+_0x49ae95(0xf04):_0x49ae95(0xaea)+_0x294c08[_0x49ae95(0xe36)]+_0x49ae95(0x1443),_0x2d2919=await _0x4436ba(_0x49ae95(0x5ba),_0x1d42bd,{'confirmButtonClass':'btn-danger'});if(_0x2d2919)try{await _0x5b9d83[_0x49ae95(0xe5b)]('rw',_0x5b9d83['stickerCategories'],_0x5b9d83[_0x49ae95(0xf28)],async()=>{const _0x1b20a7=_0x49ae95,_0x282eb7=await _0x5b9d83[_0x1b20a7(0xf28)][_0x1b20a7(0x67e)](_0x1b20a7(0x10ce))['equals'](_0x5399bc)[_0x1b20a7(0x100f)]();_0x282eb7[_0x1b20a7(0x9a1)]>0x0&&await _0x5b9d83[_0x1b20a7(0xf28)][_0x1b20a7(0x1521)](_0x282eb7),await _0x5b9d83['stickerCategories'][_0x1b20a7(0x54b)](_0x5399bc);}),_0x28f30a['userStickers']=await _0x5b9d83['userStickers'][_0x49ae95(0x14b5)](),_0x592042===_0x5399bc&&(_0x592042=_0x49ae95(0xa92)),await _0x2b0e48(),await _0xfb88c2(),alert(_0x49ae95(0x908)+_0x294c08[_0x49ae95(0xe36)]+'》及其下的表情已成功删除。');}catch(_0x208cf8){console['error'](_0x49ae95(0x3da),_0x208cf8),alert(_0x49ae95(0x4d5));}}function _0x3674b6(_0x481d3e){const _0x3e9535=_0x475790;_0x592042=_0x481d3e,document['querySelectorAll'](_0x3e9535(0xc19))[_0x3e9535(0xf99)](_0x52b663=>{const _0x2b6ba4=_0x3e9535;_0x52b663[_0x2b6ba4(0xff6)][_0x2b6ba4(0x14c8)](_0x2b6ba4(0xd43),String(_0x52b663[_0x2b6ba4(0xe93)]['categoryId'])===String(_0x481d3e));}),_0xfb88c2(![]);const _0x4941e6=document[_0x3e9535(0x2ec)]('select-all-stickers-checkbox');if(_0x4941e6)_0x4941e6[_0x3e9535(0x13b8)]=![];}async function _0x46f0cd(){const _0x4d7ef0=_0x475790;if(!_0x28f30a[_0x4d7ef0(0x11b9)])return;const _0x5d1090=_0x28f30a[_0x4d7ef0(0x6ce)][_0x28f30a['activeChatId']];if(!_0x5d1090)return;try{const _0x57a4e4={'type':_0x4d7ef0(0x1d9),'version':0x1,'chatData':_0x5d1090},_0x374ed2=new Blob([JSON['stringify'](_0x57a4e4,null,0x2)],{'type':_0x4d7ef0(0x1446)}),_0x5441c4=URL[_0x4d7ef0(0x23d)](_0x374ed2),_0x4a156d=document['createElement']('a');_0x4a156d[_0x4d7ef0(0xe15)]=_0x5441c4,_0x4a156d['download']='EPhone-Chat-'+_0x5d1090[_0x4d7ef0(0xe36)]+'-'+new Date()[_0x4d7ef0(0xaf8)]()['split']('T')[0x0]+_0x4d7ef0(0x44e),_0x4a156d[_0x4d7ef0(0x1177)](),URL['revokeObjectURL'](_0x5441c4),await _0x34d596('导出成功','与“'+_0x5d1090[_0x4d7ef0(0xe36)]+_0x4d7ef0(0xea0));}catch(_0xfe1c3d){console[_0x4d7ef0(0x1518)]('导出单个聊天时出错:',_0xfe1c3d),await _0x34d596(_0x4d7ef0(0x4aa),_0x4d7ef0(0x5a6)+_0xfe1c3d[_0x4d7ef0(0x13bc)]);}}async function _0x4c7de6(_0x4905be){const _0x45c7a9=_0x475790;if(!_0x4905be||!_0x28f30a['activeChatId'])return;const _0x239114=_0x28f30a[_0x45c7a9(0x11b9)],_0x1b25e0=_0x28f30a[_0x45c7a9(0x6ce)][_0x239114];try{const _0x48aa96=await _0x4905be['text'](),_0x37333b=JSON[_0x45c7a9(0xd91)](_0x48aa96);if(_0x37333b[_0x45c7a9(0xb4b)]!==_0x45c7a9(0x1d9)||!_0x37333b[_0x45c7a9(0xe77)])throw new Error(_0x45c7a9(0x5b7));const _0x45054b=await _0x4436ba(_0x45c7a9(0x151c),'这将用备份文件中的数据【完全覆盖】当前与“'+_0x1b25e0[_0x45c7a9(0xe36)]+'”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>',{'confirmButtonClass':'btn-danger','confirmText':_0x45c7a9(0x282)});if(!_0x45054b)return;const _0x48f074=_0x37333b[_0x45c7a9(0xe77)];_0x48f074['id']=_0x239114,await _0x5b9d83[_0x45c7a9(0x6ce)][_0x45c7a9(0x7c3)](_0x48f074),_0x28f30a['chats'][_0x239114]=_0x48f074,await _0x34d596('导入成功',_0x45c7a9(0x92b)),_0xc55746(_0x239114),_0x5db8a3(),document[_0x45c7a9(0x2ec)](_0x45c7a9(0x128a))[_0x45c7a9(0x1177)]();}catch(_0xc02c3c){console[_0x45c7a9(0x1518)](_0x45c7a9(0x9b1),_0xc02c3c),await _0x34d596('导入失败','文件解析或应用失败:\x20'+_0xc02c3c['message']);}}function _0xb6d174(){const _0x11bea5=_0x475790;_0x1d0667(),_0x17ec27(_0x11bea5(0x1197));}function _0x1d0667(){const _0x2d3d2e=_0x475790,_0x1a4c65=document['getElementById'](_0x2d3d2e(0x614));_0x1a4c65['innerHTML']='';const _0x36160e=Object['values'](_0x28f30a[_0x2d3d2e(0x6ce)])['filter'](_0x502f00=>!_0x502f00[_0x2d3d2e(0x1423)]);if(_0x36160e[_0x2d3d2e(0x9a1)]===0x0){_0x1a4c65[_0x2d3d2e(0xc43)]=_0x2d3d2e(0x14c1);return;}_0x36160e[_0x2d3d2e(0xf99)](_0x500e49=>{const _0x3ca739=_0x2d3d2e,_0x28b65a=document[_0x3ca739(0x14ae)](_0x3ca739(0xaa5));_0x28b65a['className']=_0x3ca739(0xc83),_0x28b65a[_0x3ca739(0xc43)]=_0x3ca739(0x152a)+(_0x500e49['settings'][_0x3ca739(0xe91)]||_0x825cf1)+_0x3ca739(0xfc7)+_0x500e49[_0x3ca739(0xe36)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x28b65a[_0x3ca739(0xf79)](_0x3ca739(0x1177),()=>_0x102867(_0x500e49['id'])),_0x1a4c65['appendChild'](_0x28b65a);});}async function _0x102867(_0x555776){const _0x362ffe=_0x475790;_0x579fa9=_0x555776,console[_0x362ffe(0x415)]('已切换到角色\x20'+_0x555776+'\x20的手机'),_0x543c4d(),_0x5d626d(),_0x3487b3(),_0x17ec27(_0x362ffe(0xfe4));}function _0x2e8af5(){const _0x4085f0=_0x475790;_0x579fa9=null,console[_0x4085f0(0x415)](_0x4085f0(0x533)),_0x17ec27('home-screen');}function _0x3487b3(){const _0x14d326=_0x475790,_0x354434=new Date(),_0x5ce25d=_0x354434[_0x14d326(0x2b4)]('zh-CN',{'hour':_0x14d326(0x4ff),'minute':_0x14d326(0x4ff)}),_0x4450cc=_0x354434[_0x14d326(0xc14)](_0x14d326(0x1054),{'weekday':_0x14d326(0x625),'month':_0x14d326(0x625),'day':_0x14d326(0x705)});document[_0x14d326(0x2ec)]('char-main-time')[_0x14d326(0x15f)]=_0x5ce25d,document['getElementById'](_0x14d326(0x10db))['textContent']=_0x4450cc,_0x38e7ae(_0x14d326(0x14dd));}function _0x38e7ae(_0x2ed0b5){const _0x23098d=_0x475790;document[_0x23098d(0x5d6)](_0x23098d(0x33a))['forEach'](_0x220c1e=>_0x220c1e['classList'][_0x23098d(0x1424)](_0x23098d(0xd43))),document['getElementById'](_0x2ed0b5)['classList']['add'](_0x23098d(0xd43));}window[_0x475790(0x2aa)]=_0x38e7ae;async function _0x144166(_0x23662b){const _0x49ead3=_0x475790;if(!_0x579fa9)return;const _0x671800=_0x28f30a[_0x49ead3(0x6ce)][_0x579fa9];await _0x29cbb3(_0x579fa9,_0x23662b);switch(_0x23662b){case'qq':_0x254b80(),_0x38e7ae('char-qq-screen');break;case'album':_0xcf12a8(),_0x38e7ae(_0x49ead3(0xc57));break;case'browser':_0x51eba7(),_0x38e7ae('char-browser-screen');break;case _0x49ead3(0x28d):_0x4eab6a(),_0x38e7ae(_0x49ead3(0xd24));break;case'memo':_0x11daa2(),_0x38e7ae(_0x49ead3(0x573));break;case _0x49ead3(0x1564):_0x3cdf88(),_0x38e7ae('char-diary-screen');break;case _0x49ead3(0x6dd):_0x33198e(),_0x38e7ae(_0x49ead3(0x1051));break;case _0x49ead3(0xc88):_0x323b30(),_0x38e7ae(_0x49ead3(0x541));break;case _0x49ead3(0xb57):_0x25a30a(),_0x38e7ae('char-usage-screen');break;}}async function _0xcf12a8(){const _0x2fada7=_0x475790,_0x4523c0=document[_0x2fada7(0x2ec)]('char-album-grid');_0x4523c0['innerHTML']='';if(!_0x579fa9)return;const _0x2817ed=_0x28f30a['chats'][_0x579fa9],_0x11b5b9=_0x2817ed[_0x2fada7(0x7e0)]||[];if(_0x11b5b9[_0x2fada7(0x9a1)]===0x0){_0x4523c0[_0x2fada7(0xc43)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>';return;}const _0x177521=_0x2fada7(0xec2);_0x11b5b9['forEach'](_0x472407=>{const _0x128066=_0x2fada7,_0x5cc793=document[_0x128066(0x14ae)]('div');_0x5cc793[_0x128066(0xdd1)]=_0x128066(0x72c),_0x5cc793[_0x128066(0xe93)][_0x128066(0x9cc)]=_0x472407['description'],_0x4523c0[_0x128066(0x998)](_0x5cc793);if(_0x28f30a[_0x128066(0x1062)][_0x128066(0x10fa)]){_0x5cc793['style'][_0x128066(0xc34)]='#e9ecef';const _0x2bbb71=/[^\x00-\x7F]/[_0x128066(0x1e0)](_0x472407['image_prompt']),_0x301c28=_0x472407[_0x128066(0xe8f)]&&_0x472407['image_prompt'][_0x128066(0x97e)]()&&!_0x2bbb71,_0x16546d=_0x301c28?_0x472407[_0x128066(0xe8f)]:_0x128066(0x3dd),_0x1e98c3=_0x128066(0x6d0)+encodeURIComponent(_0x16546d),_0x24df55=new Image();_0x24df55[_0x128066(0xf2d)]=function(){const _0x2aca30=_0x128066;_0x5cc793['style'][_0x2aca30(0xe00)]=_0x2aca30(0xeb9)+this[_0x2aca30(0xce4)]+')';},_0x24df55[_0x128066(0x125a)]=function(){const _0x2b8051=_0x128066;_0x5cc793[_0x2b8051(0x589)][_0x2b8051(0xe00)]=_0x2b8051(0xeb9)+_0x177521+')';},_0x24df55['src']=_0x1e98c3;}else{_0x5cc793[_0x128066(0x589)][_0x128066(0xc34)]='#f0f2f5',_0x5cc793[_0x128066(0x589)][_0x128066(0x14ed)]='1px\x20solid\x20#e0e0e0';const _0x4a4795=document[_0x128066(0x14ae)]('p');_0x4a4795[_0x128066(0xdd1)]=_0x128066(0x5df),_0x4a4795[_0x128066(0x15f)]=_0x472407[_0x128066(0x9cc)]||_0x128066(0x7d5),_0x5cc793[_0x128066(0x998)](_0x4a4795);}});}function _0x51eba7(){const _0x1c2861=_0x475790,_0x2818f1=document[_0x1c2861(0x2ec)]('char-browser-history');_0x2818f1[_0x1c2861(0xc43)]='';if(!_0x579fa9)return;const _0x15d7dc=_0x28f30a[_0x1c2861(0x6ce)][_0x579fa9],_0x20e6ff=[_0x15d7dc[_0x1c2861(0xe36)],'爱好','旅游','美食','新闻',..._0x15d7dc[_0x1c2861(0x362)][_0x1c2861(0x67c)][_0x1c2861(0xa8a)](/，|。|\s/)[_0x1c2861(0x225)](0x0,0x5)],_0x21ee0c=['知乎','Bilibili',_0x1c2861(0xca0),'微博',_0x1c2861(0xfb8)];for(let _0x4920f0=0x0;_0x4920f0<0xf;_0x4920f0++){const _0x17a4ae=_0x20e6ff[Math[_0x1c2861(0x5f8)](Math['random']()*_0x20e6ff['length'])],_0x19725b=_0x21ee0c[Math[_0x1c2861(0x5f8)](Math[_0x1c2861(0x1337)]()*_0x21ee0c[_0x1c2861(0x9a1)])],_0xc67b10=document[_0x1c2861(0x14ae)](_0x1c2861(0xaa5));_0xc67b10['className']=_0x1c2861(0xe50),_0xc67b10[_0x1c2861(0xc43)]=_0x1c2861(0x261)+_0x17a4ae+'\x20-\x20'+_0x19725b+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.'+_0x19725b[_0x1c2861(0x1430)]()+_0x1c2861(0x821)+_0x17a4ae+_0x1c2861(0x1065),_0x2818f1[_0x1c2861(0x998)](_0xc67b10);}}function _0x4eab6a(){const _0x55d6d9=_0x475790,_0xe672a5=document['getElementById']('char-product-grid');_0xe672a5[_0x55d6d9(0xc43)]='';if(!_0x579fa9)return;const _0x5c0944=_0x28f30a[_0x55d6d9(0x6ce)][_0x579fa9],_0x9d1cbf=_0x5c0944[_0x55d6d9(0x14e8)]?.[_0x55d6d9(0x1056)]||[];if(_0x9d1cbf['length']===0x0){_0xe672a5[_0x55d6d9(0xc43)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>';return;}_0x9d1cbf[_0x55d6d9(0xf99)](_0x544324=>{const _0x2f6377=_0x55d6d9,_0x2450e6=document['createElement'](_0x2f6377(0xaa5));_0x2450e6[_0x2f6377(0xdd1)]='char-product-item',_0x2450e6[_0x2f6377(0xe93)][_0x2f6377(0x6a4)]=_0x544324[_0x2f6377(0x6a4)];let _0xb7dd48;if(_0x28f30a[_0x2f6377(0x1062)][_0x2f6377(0x10fa)]){const _0x52fb20=_0x2f6377(0x6d0)+encodeURIComponent(_0x544324[_0x2f6377(0xe8f)]||_0x2f6377(0x2f6));_0xb7dd48='<img\x20src=\x22'+_0x52fb20+_0x2f6377(0x9f4);}else _0xb7dd48='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>'+(_0x544324['reason']||_0x2f6377(0xd5f))+_0x2f6377(0xff5);_0x2450e6[_0x2f6377(0xc43)]=_0x2f6377(0x78f)+_0xb7dd48+_0x2f6377(0x1339)+_0x544324[_0x2f6377(0x126e)]+_0x2f6377(0xcba)+(_0x544324[_0x2f6377(0x1309)]||0x0)[_0x2f6377(0x5c3)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>'+_0x544324[_0x2f6377(0x2a3)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xe672a5[_0x2f6377(0x998)](_0x2450e6);});}function _0x2dffa2(){const _0x1155e4=_0x475790;_0x38e7ae(_0x1155e4(0x14dd));}function _0x19a7a8(){const _0x5ad86f=_0x475790,_0x434a7d=document[_0x5ad86f(0x2ec)]('char-chat-list');_0x434a7d['innerHTML']='';if(!_0x579fa9)return;const _0x47dd34=Object[_0x5ad86f(0x74e)](_0x28f30a[_0x5ad86f(0x6ce)])[_0x5ad86f(0xebc)](_0x579f57=>{const _0x5012cf=_0x5ad86f;if(_0x579f57['id']===_0x579fa9)return!![];if(_0x579f57[_0x5012cf(0x1423)]&&_0x579f57[_0x5012cf(0x10f2)]['some'](_0x15e5de=>_0x15e5de['id']===_0x579fa9))return!![];return![];});_0x47dd34[_0x5ad86f(0xf99)](_0x2eab0f=>{const _0x1c7a97=_0x5ad86f,_0x47d4d6=_0x52669f(_0x2eab0f);_0x434a7d[_0x1c7a97(0x998)](_0x47d4d6);});}async function _0x29cbb3(_0x3a1c39,_0x3c167d){const _0x412933=_0x475790,_0x949265=_0x28f30a[_0x412933(0x6ce)][_0x3a1c39];if(!_0x949265)return;!_0x949265[_0x412933(0x1476)]&&(_0x949265[_0x412933(0x1476)]=[]),_0x949265[_0x412933(0x1476)][_0x412933(0x367)]({'appName':_0x3c167d,'timestamp':Date[_0x412933(0x487)]()}),_0x949265[_0x412933(0x1476)][_0x412933(0x9a1)]>0x32&&_0x949265[_0x412933(0x1476)]['shift'](),await _0x5b9d83['chats']['put'](_0x949265);}function _0x25a30a(){const _0x1f3824=_0x475790,_0x4f31db=document[_0x1f3824(0x2ec)](_0x1f3824(0x153d));_0x4f31db[_0x1f3824(0xc43)]='';const _0x4aa13b=_0x28f30a[_0x1f3824(0x6ce)][_0x579fa9],_0x3d7c10=(_0x4aa13b[_0x1f3824(0x1476)]||[])[_0x1f3824(0x225)]()[_0x1f3824(0x6c9)]();if(_0x3d7c10[_0x1f3824(0x9a1)]===0x0){_0x4f31db[_0x1f3824(0xc43)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>';return;}const _0x5d977f={'qq':'QQ','album':'相册','browser':_0x1f3824(0xb77),'taobao':'淘宝','memo':_0x1f3824(0x133a),'diary':'日记','amap':_0x1f3824(0x149e),'usage':_0x1f3824(0x1567)};_0x3d7c10['forEach'](_0x2b4906=>{const _0x421d8a=_0x1f3824,_0xc879a2=document[_0x421d8a(0x14ae)]('div');_0xc879a2[_0x421d8a(0xdd1)]='usage-item',_0xc879a2['innerHTML']=_0x421d8a(0x468)+new Date(_0x2b4906[_0x421d8a(0x69a)])[_0x421d8a(0xc4c)]()+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>'+(_0x5d977f[_0x2b4906[_0x421d8a(0xff4)]]||_0x2b4906[_0x421d8a(0xff4)])+'</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4f31db['appendChild'](_0xc879a2);});}async function _0x184c68(_0x2239b8){const _0x4d8640=_0x475790,_0x361e70=_0x28f30a['chats'][_0x579fa9];if(!_0x361e70)return;const _0x4e0fae={'role':'assistant','senderName':_0x361e70[_0x4d8640(0x66c)],'type':_0x4d8640(0xae7),'content':_0x2239b8,'imageUrl':'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','timestamp':Date['now']()};_0x361e70['history'][_0x4d8640(0x367)](_0x4e0fae),await _0x5b9d83[_0x4d8640(0x6ce)][_0x4d8640(0x7c3)](_0x361e70),_0x28f30a[_0x4d8640(0x11b9)]===_0x579fa9&&_0x4cc03e(_0x4e0fae,_0x361e70),await _0x34d596('分享成功','“'+_0x361e70[_0x4d8640(0xe36)]+_0x4d8640(0x1473));}async function _0x11367d(_0x33a1c8){const _0x47b780=_0x475790,_0xdedb6=_0x28f30a[_0x47b780(0x6ce)][_0x579fa9];if(!_0xdedb6||!_0xdedb6[_0x47b780(0x406)])return;const _0x3a1ea5=_0xdedb6[_0x47b780(0x406)][_0x47b780(0x412)](_0xed74bb=>_0xed74bb['id']===_0x33a1c8);if(_0x3a1ea5){_0x360a61=_0x3a1ea5;const _0x214786=document['getElementById']('char-memo-detail-title'),_0x23cf98=document[_0x47b780(0x2ec)]('char-memo-detail-content'),_0x2207ac=document['getElementById'](_0x47b780(0xf0c));if(_0x214786)_0x214786['textContent']=_0x3a1ea5[_0x47b780(0x141e)];if(_0x23cf98)_0x23cf98[_0x47b780(0x11a4)]=_0x3a1ea5[_0x47b780(0x1047)];const _0x56b87f=await _0x5b9d83['favorites']['where']({'type':_0x47b780(0x10a1),'content.id':_0x33a1c8})[_0x47b780(0x942)]();_0x2207ac[_0x47b780(0xff6)]['toggle'](_0x47b780(0xd43),!!_0x56b87f),_0x38e7ae(_0x47b780(0x11bf));}}function _0x11daa2(){const _0x4c2665=_0x475790,_0x3ba313=document[_0x4c2665(0x2ec)](_0x4c2665(0x5d5));_0x3ba313[_0x4c2665(0xc43)]='';const _0x5c0134=_0x28f30a['chats'][_0x579fa9],_0x3e34b8=(_0x5c0134[_0x4c2665(0x406)]||[])[_0x4c2665(0x225)]()[_0x4c2665(0x6c9)]();if(_0x3e34b8[_0x4c2665(0x9a1)]===0x0){_0x3ba313[_0x4c2665(0xc43)]=_0x4c2665(0x11ad);return;}_0x3e34b8[_0x4c2665(0xf99)](_0xf751c9=>{const _0x102205=_0x4c2665,_0x4e1ddb=document['createElement'](_0x102205(0xaa5));_0x4e1ddb[_0x102205(0xdd1)]='list-item',_0x4e1ddb[_0x102205(0xc43)]=_0x102205(0x688)+_0xf751c9[_0x102205(0x141e)]+_0x102205(0xc63)+(_0xf751c9[_0x102205(0x1047)]||'')[_0x102205(0xa8a)]('\x0a')[0x0]+_0x102205(0x1065),_0x4e1ddb[_0x102205(0xf79)](_0x102205(0x1177),()=>_0x11367d(_0xf751c9['id'])),_0x131542(_0x4e1ddb,()=>deleteMemo(_0xf751c9['id'])),_0x3ba313[_0x102205(0x998)](_0x4e1ddb);});}async function _0x282fff(_0x183deb=null){const _0x13f506=_0x475790;_0x30d6c4=null;const _0x51df37=await _0x33419a(_0x13f506(0x2d4),_0x13f506(0xa95));if(_0x51df37===null||!_0x51df37[_0x13f506(0x97e)]())return;const _0x3972b9=await _0x33419a(_0x13f506(0x3a2)+_0x51df37,_0x13f506(0x149f),'',_0x13f506(0x382));_0x3972b9!==null&&(await _0x5542a3({'title':_0x51df37[_0x13f506(0x97e)](),'content':_0x3972b9}),_0x38e7ae('char-memo-screen'));}async function _0x5542a3(_0x1a4f62){const _0x16a2e2=_0x475790,_0x1b5c27=_0x28f30a[_0x16a2e2(0x6ce)][_0x579fa9];if(!_0x1b5c27[_0x16a2e2(0x406)])_0x1b5c27[_0x16a2e2(0x406)]=[];_0x1b5c27[_0x16a2e2(0x406)][_0x16a2e2(0x367)]({'id':Date[_0x16a2e2(0x487)](),'title':_0x1a4f62[_0x16a2e2(0x141e)],'content':_0x1a4f62[_0x16a2e2(0x1047)]}),await _0x5b9d83[_0x16a2e2(0x6ce)][_0x16a2e2(0x7c3)](_0x1b5c27),_0x11daa2();}async function _0x5542a3(_0x2cd56e){const _0x1c8a53=_0x475790,_0x533be4=_0x28f30a['chats'][_0x579fa9];if(!_0x533be4['memos'])_0x533be4['memos']=[];if(_0x30d6c4){const _0x416e4a=_0x533be4['memos'][_0x1c8a53(0x412)](_0xae5016=>_0xae5016['id']===_0x30d6c4);if(_0x416e4a)_0x416e4a[_0x1c8a53(0x1047)]=_0x2cd56e;}else _0x533be4['memos'][_0x1c8a53(0x367)]({'id':Date[_0x1c8a53(0x487)](),'content':_0x2cd56e});await _0x5b9d83[_0x1c8a53(0x6ce)][_0x1c8a53(0x7c3)](_0x533be4),_0x11daa2(),_0x30d6c4=null;}async function _0x2e99f0(){const _0x1d4b55=_0x475790;if(!_0x579fa9)return;const _0x1085c1=_0x28f30a[_0x1d4b55(0x6ce)][_0x579fa9];if(!_0x1085c1)return;await _0x34d596(_0x1d4b55(0x13e4),_0x1d4b55(0x14a4)+_0x1085c1[_0x1d4b55(0xe36)]+'”翻开TA的日记本...');const {proxyUrl:_0x4c30fc,apiKey:_0x81a635,model:_0x5338dd}=_0x28f30a[_0x1d4b55(0x1537)];if(!_0x4c30fc||!_0x81a635||!_0x5338dd){alert(_0x1d4b55(0x61d));return;}const _0x348ebe=_0x28f30a[_0x1d4b55(0x1506)]['nickname']===_0x1d4b55(0x450)||!_0x28f30a[_0x1d4b55(0x1506)][_0x1d4b55(0x19a)]?'用户':_0x28f30a['qzoneSettings'][_0x1d4b55(0x19a)],_0x554308=_0x1085c1[_0x1d4b55(0x153f)]&&_0x1085c1[_0x1d4b55(0x153f)][_0x1d4b55(0x9a1)]>0x0?_0x1085c1[_0x1d4b55(0x153f)][_0x1d4b55(0x11c6)](_0x1dd3da=>_0x1d4b55(0x151a)+_0xf1c86d(_0x1dd3da['timestamp'])+')\x20'+_0x1dd3da[_0x1d4b55(0x1047)])['join']('\x0a'):'无',_0x17b5f0=_0x1085c1[_0x1d4b55(0x362)][_0x1d4b55(0xfcd)]||0xa,_0x3d9ac1=_0x1085c1['history'][_0x1d4b55(0x225)](-_0x17b5f0)['map'](_0x154bc9=>(_0x154bc9['role']===_0x1d4b55(0xcc9)?_0x348ebe:_0x1085c1[_0x1d4b55(0xe36)])+':\x20'+String(_0x154bc9[_0x1d4b55(0x1047)])[_0x1d4b55(0xa6b)](0x0,0x1e)+_0x1d4b55(0x4e6))['join']('\x0a'),_0x4b515=(_0x1085c1[_0x1d4b55(0x362)][_0x1d4b55(0x684)]||[])[_0x1d4b55(0x11c6)](_0x62bcd2=>_0x28f30a[_0x1d4b55(0x13b9)][_0x1d4b55(0x412)](_0x37d060=>_0x37d060['id']===_0x62bcd2))[_0x1d4b55(0xebc)](Boolean)[_0x1d4b55(0x11c6)](_0x224a44=>_0x1d4b55(0x1097)+_0x224a44['name']+_0x1d4b55(0xdd9)+_0x224a44[_0x1d4b55(0x1047)][_0x1d4b55(0xebc)](_0xe175f3=>_0xe175f3[_0x1d4b55(0x400)])['map'](_0x4a9175=>'-\x20'+_0x4a9175[_0x1d4b55(0x1047)])[_0x1d4b55(0xbad)]('\x0a'))['join'](''),_0x1623d0=_0x5bdf0b(_0x1085c1,0x3,_0x1d4b55(0xe03)),_0x415193=_0x5bdf0b(_0x1085c1,0x6,_0x1d4b55(0xe03)),_0x2bfe1b=_0x5bdf0b(_0x1085c1,0x9,_0x1d4b55(0xe03)),_0x558514=_0x5bdf0b(_0x1085c1,0x1,_0x1d4b55(0xb0b)),_0x4cb2c4=_0x5bdf0b(_0x1085c1,0x3,'days'),_0x44fc05=_0x5bdf0b(_0x1085c1,0x7,_0x1d4b55(0xb0b));let _0xd90772='';if(_0x1623d0||_0x415193||_0x2bfe1b||_0x558514||_0x4cb2c4||_0x44fc05){_0xd90772+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x1623d0)_0xd90772+=_0x1623d0;if(_0x415193)_0xd90772+=_0x415193;if(_0x2bfe1b)_0xd90772+=_0x2bfe1b;if(_0x1623d0||_0x415193||_0x2bfe1b)_0xd90772+='\x0a';if(_0x558514)_0xd90772+=_0x558514;if(_0x4cb2c4)_0xd90772+=_0x4cb2c4;if(_0x44fc05)_0xd90772+=_0x44fc05;}const _0x23bae9=_0x1085c1['settings']['myPersona']||_0x1d4b55(0x1541),_0x183720='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“'+_0x1085c1[_0x1d4b55(0xe36)]+_0x1d4b55(0xf80)+new Date()[_0x1d4b55(0xc14)](_0x1d4b55(0x1054))+_0x1d4b55(0xa5b)+_0x348ebe+_0x1d4b55(0xa20)+_0x1085c1[_0x1d4b55(0x362)][_0x1d4b55(0x67c)]+'\x0a-\x20**你的聊天对象设定**:'+_0x23bae9+_0x1d4b55(0x580)+_0x554308+'\x0a'+_0x4b515+'\x0a'+_0xd90772+'\x20\x0a-\x20**你最近和“'+_0x348ebe+_0x1d4b55(0x658)+_0x3d9ac1+'\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。';try{const _0x84c256=[{'role':_0x1d4b55(0xcc9),'content':_0x1d4b55(0x9fe)}];let _0x9461aa=_0x4c30fc['includes'](_0x1d4b55(0xe9c)),_0x34ccf8=_0x4fff3d(_0x5338dd,_0x81a635,_0x183720,_0x84c256);const _0x3a9d49=_0x9461aa?await fetch(_0x34ccf8[_0x1d4b55(0x6d1)],_0x34ccf8['data']):await fetch(_0x4c30fc+'/v1/chat/completions',{'method':_0x1d4b55(0x655),'headers':{'Content-Type':_0x1d4b55(0x1446),'Authorization':_0x1d4b55(0xe83)+_0x81a635},'body':JSON[_0x1d4b55(0xe4d)]({'model':_0x5338dd,'messages':[{'role':_0x1d4b55(0x10a7),'content':_0x183720},..._0x84c256],'temperature':_0x28f30a[_0x1d4b55(0x1062)]['apiTemperature']||0.95})});if(!_0x3a9d49['ok'])throw new Error(_0x1d4b55(0xe6d)+_0x3a9d49[_0x1d4b55(0x1066)]);const _0x43db57=await _0x3a9d49[_0x1d4b55(0x12a2)](),_0x1558e0=getGeminiResponseText(_0x43db57),_0x409934=_0x1558e0[_0x1d4b55(0x49a)](/(\[[\s\S]*\])/);if(!_0x409934||!_0x409934[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x1558e0);const _0x4be5b9=_0x409934[0x0];let _0x489800;try{_0x489800=JSON['parse'](_0x4be5b9);}catch(_0x56ec35){throw new Error(_0x1d4b55(0x1044)+_0x56ec35[_0x1d4b55(0x13bc)]+_0x1d4b55(0x441)+_0x1558e0);}_0x1085c1[_0x1d4b55(0x1564)]=_0x489800[_0x1d4b55(0x11c6)](_0x525190=>({'id':Date['now']()+Math[_0x1d4b55(0x1337)](),'title':_0x525190[_0x1d4b55(0x141e)],'content':_0x525190[_0x1d4b55(0x1047)],'timestamp':Date['now']()})),await _0x5b9d83['chats'][_0x1d4b55(0x7c3)](_0x1085c1),await _0x3cdf88();}catch(_0x43663e){console[_0x1d4b55(0x1518)](_0x1d4b55(0x9c2),_0x43663e),await _0x34d596(_0x1d4b55(0x1ea),_0x1d4b55(0x392)+_0x43663e['message']);}}async function _0x452d06(){const _0x2a0fdc=_0x475790;if(!_0x579fa9)return;const _0x39b0da=_0x28f30a[_0x2a0fdc(0x6ce)][_0x579fa9];if(!_0x39b0da)return;await _0x34d596('请稍候...',_0x2a0fdc(0x14a4)+_0x39b0da[_0x2a0fdc(0xe36)]+_0x2a0fdc(0xbec));const {proxyUrl:_0x1cf56c,apiKey:_0x5215bb,model:_0x47c137}=_0x28f30a[_0x2a0fdc(0x1537)];if(!_0x1cf56c||!_0x5215bb||!_0x47c137)return;const _0x408c96=_0x28f30a[_0x2a0fdc(0x1506)][_0x2a0fdc(0x19a)]===_0x2a0fdc(0x450)||!_0x28f30a['qzoneSettings'][_0x2a0fdc(0x19a)]?'用户':_0x28f30a[_0x2a0fdc(0x1506)][_0x2a0fdc(0x19a)],_0x5813b2=_0x39b0da[_0x2a0fdc(0x153f)]&&_0x39b0da[_0x2a0fdc(0x153f)]['length']>0x0?_0x39b0da[_0x2a0fdc(0x153f)][_0x2a0fdc(0x11c6)](_0x146993=>_0x2a0fdc(0x151a)+_0xf1c86d(_0x146993[_0x2a0fdc(0x69a)])+')\x20'+_0x146993['content'])[_0x2a0fdc(0xbad)]('\x0a'):'无',_0x22f65b=_0x39b0da[_0x2a0fdc(0x362)][_0x2a0fdc(0xfcd)]||0xa,_0x562a80=_0x39b0da['history'][_0x2a0fdc(0x225)](-_0x22f65b)[_0x2a0fdc(0x11c6)](_0x378477=>(_0x378477[_0x2a0fdc(0x9be)]===_0x2a0fdc(0xcc9)?_0x408c96:_0x39b0da['name'])+':\x20'+String(_0x378477[_0x2a0fdc(0x1047)])['substring'](0x0,0x1e)+_0x2a0fdc(0x4e6))['join']('\x0a'),_0x1e2105=(_0x39b0da['settings'][_0x2a0fdc(0x684)]||[])[_0x2a0fdc(0x11c6)](_0x2cfa69=>_0x28f30a['worldBooks'][_0x2a0fdc(0x412)](_0x217d73=>_0x217d73['id']===_0x2cfa69))[_0x2a0fdc(0xebc)](Boolean)[_0x2a0fdc(0x11c6)](_0x33798a=>_0x2a0fdc(0x1097)+_0x33798a[_0x2a0fdc(0xe36)]+_0x2a0fdc(0xdd9)+_0x33798a[_0x2a0fdc(0x1047)]['filter'](_0x5d66f4=>_0x5d66f4[_0x2a0fdc(0x400)])[_0x2a0fdc(0x11c6)](_0x420bbd=>'-\x20'+_0x420bbd[_0x2a0fdc(0x1047)])[_0x2a0fdc(0xbad)]('\x0a'))[_0x2a0fdc(0xbad)](''),_0x18872d=_0x2a0fdc(0x141d)+_0x39b0da[_0x2a0fdc(0xe36)]+'”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**'+new Date()['toLocaleDateString'](_0x2a0fdc(0x1054))+_0x2a0fdc(0xd95)+_0x39b0da[_0x2a0fdc(0x362)][_0x2a0fdc(0x67c)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0x5813b2+'\x0a'+_0x1e2105+_0x2a0fdc(0xa02)+_0x408c96+_0x2a0fdc(0x658)+_0x562a80+'\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。';try{const _0x364d14=[{'role':_0x2a0fdc(0xcc9),'content':_0x2a0fdc(0x843)}];let _0x47e46e=_0x1cf56c[_0x2a0fdc(0x138a)]('generativelanguage'),_0x52660b=_0x4fff3d(_0x47c137,_0x5215bb,_0x18872d,_0x364d14);const _0x123f14=_0x47e46e?await fetch(_0x52660b['url'],_0x52660b[_0x2a0fdc(0x1418)]):await fetch(_0x1cf56c+_0x2a0fdc(0x1427),{'method':_0x2a0fdc(0x655),'headers':{'Content-Type':_0x2a0fdc(0x1446),'Authorization':_0x2a0fdc(0xe83)+_0x5215bb},'body':JSON[_0x2a0fdc(0xe4d)]({'model':_0x47c137,'messages':[{'role':_0x2a0fdc(0x10a7),'content':_0x18872d},..._0x364d14],'temperature':_0x28f30a[_0x2a0fdc(0x1062)][_0x2a0fdc(0x294)]||0.95})});if(!_0x123f14['ok'])throw new Error(_0x2a0fdc(0xe6d)+_0x123f14[_0x2a0fdc(0x1066)]);const _0x223a23=await _0x123f14['json'](),_0x47212e=getGeminiResponseText(_0x223a23),_0x16c2a7=_0x47212e[_0x2a0fdc(0x49a)](/(\[[\s\S]*\])/);if(!_0x16c2a7||!_0x16c2a7[0x0])throw new Error(_0x2a0fdc(0xf15)+_0x47212e);const _0x46562b=_0x16c2a7[0x0];let _0x1f3f8e;try{_0x1f3f8e=JSON[_0x2a0fdc(0xd91)](_0x46562b)[0x0];}catch(_0x196bc6){throw new Error(_0x2a0fdc(0x1044)+_0x196bc6[_0x2a0fdc(0x13bc)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x47212e);}if(!_0x39b0da['diary'])_0x39b0da[_0x2a0fdc(0x1564)]=[];_0x39b0da[_0x2a0fdc(0x1564)][_0x2a0fdc(0x367)]({'id':Date[_0x2a0fdc(0x487)](),'title':_0x1f3f8e[_0x2a0fdc(0x141e)],'content':_0x1f3f8e[_0x2a0fdc(0x1047)],'timestamp':Date[_0x2a0fdc(0x487)]()}),await _0x5b9d83['chats'][_0x2a0fdc(0x7c3)](_0x39b0da),await _0x3cdf88();}catch(_0x3d809e){console[_0x2a0fdc(0x1518)](_0x2a0fdc(0x248),_0x3d809e),await _0x34d596(_0x2a0fdc(0x1ea),_0x2a0fdc(0x151b)+_0x3d809e[_0x2a0fdc(0x13bc)]);}}function _0x3cdf88(){const _0x5c462e=_0x475790,_0x4174f8=document[_0x5c462e(0x2ec)](_0x5c462e(0xa0d));_0x4174f8['innerHTML']='';const _0x56056e=_0x28f30a[_0x5c462e(0x6ce)][_0x579fa9],_0x4fd68f=(_0x56056e[_0x5c462e(0x1564)]||[])[_0x5c462e(0x225)]()[_0x5c462e(0x6c9)]();if(_0x4fd68f[_0x5c462e(0x9a1)]===0x0){_0x4174f8[_0x5c462e(0xc43)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>';return;}_0x4fd68f['forEach'](_0x5b732d=>{const _0x415aea=_0x5c462e,_0x321c2b=document[_0x415aea(0x14ae)](_0x415aea(0xaa5));_0x321c2b[_0x415aea(0xdd1)]=_0x415aea(0x1201),_0x321c2b[_0x415aea(0xc43)]=_0x415aea(0x5b6)+_0x5b732d[_0x415aea(0x141e)]+_0x415aea(0x455)+new Date(_0x5b732d['timestamp'])[_0x415aea(0xc14)]()+_0x415aea(0xefe),_0x321c2b['addEventListener'](_0x415aea(0x1177),()=>_0x3ae474(_0x5b732d['id'])),_0x131542(_0x321c2b,()=>_0x5141aa(_0x5b732d['id'])),_0x4174f8[_0x415aea(0x998)](_0x321c2b);});}async function _0x3ae474(_0x2b85f3){const _0x23624e=_0x475790,_0x5cf504=_0x28f30a[_0x23624e(0x6ce)][_0x579fa9];if(!_0x5cf504||!_0x5cf504[_0x23624e(0x1564)])return;const _0x308d7c=_0x5cf504[_0x23624e(0x1564)][_0x23624e(0x412)](_0x1300e9=>_0x1300e9['id']===_0x2b85f3);if(_0x308d7c){_0x18b1db=_0x308d7c;const _0x1ee416=document[_0x23624e(0x2ec)](_0x23624e(0x1016)),_0xe6d5e0=document[_0x23624e(0x2ec)](_0x23624e(0x5c1)),_0x21cfb6=document[_0x23624e(0x2ec)](_0x23624e(0xc3c));_0x1ee416[_0x23624e(0x15f)]=_0x308d7c[_0x23624e(0x141e)];const _0x147427=_0x35bd8e(_0x308d7c[_0x23624e(0x1047)])[_0x23624e(0xa8a)]('\x0a')[_0x23624e(0x11c6)](_0x4d6415=>_0x23624e(0x133c)+(_0x4d6415||_0x23624e(0x1485))+'</p>')[_0x23624e(0xbad)]('');_0xe6d5e0['innerHTML']=_0x147427;const _0x1c8f63=await _0x5b9d83['favorites']['where']({'type':_0x23624e(0x1278),'content.id':_0x2b85f3})[_0x23624e(0x942)]();_0x21cfb6['classList']['toggle']('active',!!_0x1c8f63),_0x38e7ae(_0x23624e(0x9f6));}}async function _0x38db0f(){const _0x11f579=_0x475790;if(!_0x18b1db||!_0x579fa9)return;const _0x8fea90=_0x18b1db,_0x1cbdcd=_0x28f30a['chats'][_0x579fa9],_0x208ed6=document[_0x11f579(0x2ec)](_0x11f579(0xc3c)),_0x33b75f=await _0x5b9d83[_0x11f579(0x101f)][_0x11f579(0x67e)]({'type':_0x11f579(0x1278),'content.id':_0x8fea90['id']})[_0x11f579(0x942)]();if(_0x33b75f)await _0x5b9d83[_0x11f579(0x101f)]['delete'](_0x33b75f['id']),_0x208ed6[_0x11f579(0xff6)][_0x11f579(0x1424)](_0x11f579(0xd43)),await _0x34d596(_0x11f579(0x699),_0x11f579(0xf23));else{const _0x207e9d={'type':'char_diary','content':{'id':_0x8fea90['id'],'title':_0x8fea90[_0x11f579(0x141e)],'content':_0x8fea90[_0x11f579(0x1047)],'timestamp':_0x8fea90['timestamp'],'characterId':_0x579fa9,'characterName':_0x1cbdcd[_0x11f579(0xe36)]},'timestamp':Date['now']()};await _0x5b9d83[_0x11f579(0x101f)]['add'](_0x207e9d),_0x208ed6[_0x11f579(0xff6)][_0x11f579(0xe82)](_0x11f579(0xd43)),await _0x34d596(_0x11f579(0x699),'已成功收藏到“我的收藏”页面！');}}async function _0x5c7b45(){const _0x4d2c9c=_0x475790;if(!_0x360a61||!_0x579fa9)return;const _0xf54ed4=_0x360a61,_0x59efcb=_0x28f30a[_0x4d2c9c(0x6ce)][_0x579fa9],_0x132adc=document['getElementById'](_0x4d2c9c(0xf0c)),_0x5354cb=await _0x5b9d83[_0x4d2c9c(0x101f)]['where']({'type':_0x4d2c9c(0x10a1),'content.id':_0xf54ed4['id']})[_0x4d2c9c(0x942)]();if(_0x5354cb)await _0x5b9d83[_0x4d2c9c(0x101f)][_0x4d2c9c(0x54b)](_0x5354cb['id']),_0x132adc[_0x4d2c9c(0xff6)][_0x4d2c9c(0x1424)]('active'),await _0x34d596(_0x4d2c9c(0x699),_0x4d2c9c(0xf23));else{const _0x1864b8={'type':_0x4d2c9c(0x10a1),'content':{'id':_0xf54ed4['id'],'title':_0xf54ed4['title'],'content':_0xf54ed4[_0x4d2c9c(0x1047)],'timestamp':_0xf54ed4[_0x4d2c9c(0x69a)],'characterId':_0x579fa9,'characterName':_0x59efcb[_0x4d2c9c(0xe36)]},'timestamp':Date[_0x4d2c9c(0x487)]()};await _0x5b9d83[_0x4d2c9c(0x101f)]['add'](_0x1864b8),_0x132adc[_0x4d2c9c(0xff6)][_0x4d2c9c(0xe82)]('active'),await _0x34d596(_0x4d2c9c(0x699),_0x4d2c9c(0xec4));}}async function _0x5141aa(_0x5b383f){const _0x5df112=_0x475790,_0x476774=await _0x4436ba('删除日记',_0x5df112(0xabb),{'confirmButtonClass':'btn-danger'});if(_0x476774){const _0x3c209e=_0x28f30a[_0x5df112(0x6ce)][_0x579fa9];_0x3c209e[_0x5df112(0x1564)]=_0x3c209e['diary'][_0x5df112(0xebc)](_0x41436b=>_0x41436b['id']!==_0x5b383f),await _0x5b9d83[_0x5df112(0x6ce)][_0x5df112(0x7c3)](_0x3c209e),_0x3cdf88();}}async function _0x254b80(){const _0x2783d7=_0x475790,_0x48808f=document[_0x2783d7(0x2ec)](_0x2783d7(0x3b2));_0x48808f[_0x2783d7(0xc43)]='';const _0xd82903=_0x28f30a['chats'][_0x579fa9];if(!_0xd82903)return;const _0x57b34a=_0xd82903[_0x2783d7(0x362)]['myNickname']||(_0x28f30a[_0x2783d7(0x1506)][_0x2783d7(0x19a)]||'我'),_0x1e6df5=_0xd82903['history'][_0x2783d7(0xebc)](_0x6efad6=>!_0x6efad6['isHidden'])[_0x2783d7(0x225)](-0x1)[0x0]||{'content':'...'};let _0xd81d28=_0x2783d7(0x4e6);if(_0x1e6df5){if(typeof _0x1e6df5[_0x2783d7(0x1047)]==='string')_0xd81d28=_0x1e6df5[_0x2783d7(0x1047)];else{if(Array[_0x2783d7(0x624)](_0x1e6df5['content'])&&_0x1e6df5[_0x2783d7(0x1047)][0x0]?.['type']==='image_url')_0xd81d28=_0x2783d7(0xf8c);else{if(_0x1e6df5[_0x2783d7(0xb4b)]){const _0x438262={'voice_message':_0x2783d7(0xdb7),'transfer':_0x2783d7(0x92c),'ai_image':'[图片]'};_0xd81d28=_0x438262[_0x1e6df5[_0x2783d7(0xb4b)]]||'['+_0x1e6df5[_0x2783d7(0xb4b)]+']';}}}}const _0x44f6f7=_0xd82903[_0x2783d7(0x362)]['myAvatar']||_0x825cf1,_0x35dc7f=_0xd82903[_0x2783d7(0x362)][_0x2783d7(0xffe)]||'';let _0x356df1;_0x35dc7f?_0x356df1=_0x2783d7(0x910)+_0x44f6f7+_0x2783d7(0x6c8)+_0x35dc7f+_0x2783d7(0x93d):_0x356df1=_0x2783d7(0x545)+_0x44f6f7+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>';const _0x376c35=document[_0x2783d7(0x14ae)](_0x2783d7(0xaa5));_0x376c35['className']=_0x2783d7(0x1466),_0x376c35[_0x2783d7(0xe93)]['conversationIndex']='-1',_0x376c35['innerHTML']=_0x2783d7(0xe7c)+_0x356df1+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x57b34a+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>'+String(_0xd81d28)['substring'](0x0,0x14)+_0x2783d7(0x10c2),_0x48808f[_0x2783d7(0x998)](_0x376c35);const _0x384ea2=await _0x5b9d83['npcs'][_0x2783d7(0x14b5)](),_0x578b61=new Map(_0x384ea2[_0x2783d7(0x11c6)](_0x2e70c3=>[_0x2e70c3[_0x2783d7(0xe36)],_0x2e70c3])),_0x511030=_0xd82903[_0x2783d7(0x1400)]||[];if(_0x511030[_0x2783d7(0x9a1)]===0x0&&!_0x376c35){_0x48808f[_0x2783d7(0xc43)]=_0x2783d7(0x1000);return;}_0x511030[_0x2783d7(0xf99)]((_0x389fb1,_0x39843e)=>{const _0x4a056a=_0x2783d7;if(_0x389fb1['type']===_0x4a056a(0xc9f))return;const _0x56706f=document['createElement'](_0x4a056a(0xaa5));_0x56706f[_0x4a056a(0xdd1)]=_0x4a056a(0x1466),_0x56706f['dataset']['conversationIndex']=_0x39843e;let _0x4d477b,_0x5442c7,_0x13d67d;if(_0x389fb1[_0x4a056a(0xb4b)]===_0x4a056a(0x1356)){_0x13d67d=_0x389fb1[_0x4a056a(0x137e)]+_0x4a056a(0x693),_0x4d477b=_0x389fb1['messages'][_0x4a056a(0x225)](-0x1)[0x0]||{'content':'...'};const _0x5aba92='logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27'+_0x389fb1[_0x4a056a(0x137e)]+'\x27',_0x14cc57=_0x28f30a[_0x4a056a(0x1062)][_0x4a056a(0x10fa)]?_0x4a056a(0x6d0)+encodeURIComponent(_0x5aba92):_0x563b2b;_0x5442c7='<div\x20class=\x22avatar-group\x22><img\x20src=\x22'+_0x14cc57+_0x4a056a(0xc47);}else{_0x13d67d=_0x389fb1[_0x4a056a(0x30f)][_0x4a056a(0xe36)],_0x4d477b=_0x389fb1['messages']['slice'](-0x1)[0x0]||{'content':_0x4a056a(0x4e6)};const _0x233d62=_0x578b61[_0x4a056a(0x6b5)](_0x13d67d);let _0x1500bf=_0x233d62&&_0x233d62[_0x4a056a(0x516)]?_0x233d62[_0x4a056a(0x516)]:_0x28f30a[_0x4a056a(0x1062)][_0x4a056a(0x10fa)]?_0x4a056a(0x6d0)+encodeURIComponent(_0x389fb1[_0x4a056a(0x30f)][_0x4a056a(0x1306)]||_0x4a056a(0x149a)):_0xd71c66;_0x5442c7=_0x4a056a(0x1c5)+_0x1500bf+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>';}let _0x3692eb=_0x4a056a(0x4e6);_0x4d477b&&_0x4d477b[_0x4a056a(0x1047)]&&(_0x3692eb=_0x4d477b['content']),_0x56706f['innerHTML']=_0x4a056a(0xac5)+_0x5442c7+_0x4a056a(0x300)+_0x13d67d+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>'+String(_0x3692eb)[_0x4a056a(0xa6b)](0x0,0x14)+_0x4a056a(0xd82),_0x48808f[_0x4a056a(0x998)](_0x56706f);});}async function _0x2b6562(){const _0x2c0e22=_0x475790;if(!_0x579fa9)return;const _0x793579=_0x28f30a[_0x2c0e22(0x6ce)][_0x579fa9];if(!_0x793579)return;await _0x34d596(_0x2c0e22(0x13e4),'正在根据“'+_0x793579[_0x2c0e22(0xe36)]+_0x2c0e22(0x4a0));const {proxyUrl:_0x4968ec,apiKey:_0x3272ec,model:_0x5a9d06}=_0x28f30a[_0x2c0e22(0x1537)];if(!_0x4968ec||!_0x3272ec||!_0x5a9d06){alert(_0x2c0e22(0x61d));return;}const _0x48d67f=await _0x5b9d83[_0x2c0e22(0x8f4)][_0x2c0e22(0x14b5)](),_0x575d03=_0x48d67f[_0x2c0e22(0xebc)](_0x1d5078=>_0x1d5078[_0x2c0e22(0xaef)]&&_0x1d5078[_0x2c0e22(0xaef)]['includes'](_0x579fa9));let _0x987cff=_0x2c0e22(0x336);_0x575d03[_0x2c0e22(0x9a1)]>0x0?(_0x987cff+=_0x2c0e22(0x85c),_0x575d03[_0x2c0e22(0xf99)](_0x52ff7e=>{const _0x4a5c5b=_0x2c0e22;_0x987cff+=_0x4a5c5b(0x1483)+_0x52ff7e[_0x4a5c5b(0xe36)]+'\x0a\x20\x20-\x20**人设**:\x20'+_0x52ff7e[_0x4a5c5b(0xe32)]+'\x0a';})):_0x987cff+=_0x2c0e22(0xb1a);const _0x222317=_0x28f30a[_0x2c0e22(0x1506)][_0x2c0e22(0x19a)]===_0x2c0e22(0x450)||!_0x28f30a['qzoneSettings']['nickname']?'用户':_0x28f30a['qzoneSettings'][_0x2c0e22(0x19a)],_0x5c5b69=_0x793579[_0x2c0e22(0x362)][_0x2c0e22(0xa28)]||_0x222317,_0x1ac270=_0x793579[_0x2c0e22(0x153f)]&&_0x793579[_0x2c0e22(0x153f)][_0x2c0e22(0x9a1)]>0x0?_0x793579[_0x2c0e22(0x153f)]['map'](_0x5e3d84=>_0x2c0e22(0x151a)+_0xf1c86d(_0x5e3d84['timestamp'])+')\x20'+_0x5e3d84[_0x2c0e22(0x1047)])[_0x2c0e22(0xbad)]('\x0a'):'无',_0xc64b67=_0x793579[_0x2c0e22(0x362)][_0x2c0e22(0xfcd)]||0xa,_0x58a558=_0x793579[_0x2c0e22(0x12c3)]['slice'](-_0xc64b67)['map'](_0x444f79=>(_0x444f79[_0x2c0e22(0x9be)]===_0x2c0e22(0xcc9)?_0x5c5b69:_0x793579['name'])+':\x20'+String(_0x444f79[_0x2c0e22(0x1047)])[_0x2c0e22(0xa6b)](0x0,0x1e)+_0x2c0e22(0x4e6))[_0x2c0e22(0xbad)]('\x0a'),_0x129c84=(_0x793579[_0x2c0e22(0x362)][_0x2c0e22(0x684)]||[])[_0x2c0e22(0x11c6)](_0x2b35f0=>_0x28f30a['worldBooks'][_0x2c0e22(0x412)](_0x2f3573=>_0x2f3573['id']===_0x2b35f0))['filter'](Boolean)[_0x2c0e22(0x11c6)](_0x231f3d=>'\x0a##\x20世界书《'+_0x231f3d['name']+_0x2c0e22(0x979)+_0x231f3d[_0x2c0e22(0x1047)][_0x2c0e22(0xebc)](_0x498f19=>_0x498f19[_0x2c0e22(0x400)])[_0x2c0e22(0x11c6)](_0x1ac406=>'-\x20'+_0x1ac406['content'])[_0x2c0e22(0xbad)]('\x0a'))[_0x2c0e22(0xbad)](''),_0x51f6ce=_0x793579[_0x2c0e22(0x66c)]||_0x793579[_0x2c0e22(0xe36)],_0x3bc907=_0x2dece1(_0x793579),_0x2ef6f9='\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“'+_0x793579[_0x2c0e22(0xe36)]+'”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22'+_0x51f6ce+_0x2c0e22(0x13e9)+_0x51f6ce+_0x2c0e22(0x1142)+_0x51f6ce+_0x2c0e22(0x1085)+_0x793579[_0x2c0e22(0x362)][_0x2c0e22(0x67c)]+_0x2c0e22(0x71e)+_0x1ac270+'\x0a-\x20**世界观**:\x20'+_0x129c84+_0x2c0e22(0x559)+_0x58a558+'\x0a'+_0x987cff+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x3bc907+_0x2c0e22(0xa9b);try{const _0x66610f=[{'role':_0x2c0e22(0xcc9),'content':'请根据你的设定，生成模拟聊天记录。'}];let _0x4e35eb=_0x4968ec['includes']('generativelanguage'),_0x5d0e6d=_0x4fff3d(_0x5a9d06,_0x3272ec,_0x2ef6f9,_0x66610f);const _0x39b8d1=_0x4e35eb?await fetch(_0x5d0e6d[_0x2c0e22(0x6d1)],_0x5d0e6d[_0x2c0e22(0x1418)]):await fetch(_0x4968ec+'/v1/chat/completions',{'method':_0x2c0e22(0x655),'headers':{'Content-Type':_0x2c0e22(0x1446),'Authorization':_0x2c0e22(0xe83)+_0x3272ec},'body':JSON[_0x2c0e22(0xe4d)]({'model':_0x5a9d06,'messages':[{'role':_0x2c0e22(0x10a7),'content':_0x2ef6f9},..._0x66610f],'temperature':_0x28f30a[_0x2c0e22(0x1062)][_0x2c0e22(0x294)]||0.9})});if(!_0x39b8d1['ok'])throw new Error(_0x2c0e22(0xe6d)+_0x39b8d1[_0x2c0e22(0x1066)]);const _0x1022ba=await _0x39b8d1[_0x2c0e22(0x12a2)](),_0x30e798=getGeminiResponseText(_0x1022ba),_0x4df4aa=_0x30e798['match'](/(\[[\s\S]*\])/);if(!_0x4df4aa||!_0x4df4aa[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x30e798);const _0x3fd389=_0x4df4aa[0x0];let _0x53d3e8;try{_0x53d3e8=JSON[_0x2c0e22(0xd91)](_0x3fd389);}catch(_0x13218c){throw new Error(_0x2c0e22(0x1044)+_0x13218c[_0x2c0e22(0x13bc)]+_0x2c0e22(0x441)+_0x30e798);}_0x793579[_0x2c0e22(0x1400)]=_0x53d3e8,await _0x5b9d83[_0x2c0e22(0x6ce)]['put'](_0x793579),await _0x254b80();const _0x44d9e5={'role':_0x2c0e22(0x10a7),'content':_0x2c0e22(0x2c5),'timestamp':Date[_0x2c0e22(0x487)](),'isHidden':!![]};_0x793579[_0x2c0e22(0x12c3)][_0x2c0e22(0x367)](_0x44d9e5),await _0x5b9d83[_0x2c0e22(0x6ce)]['put'](_0x793579),_0x36bcc9();}catch(_0x527f1b){console[_0x2c0e22(0x1518)](_0x2c0e22(0xb0e),_0x527f1b),await _0x34d596(_0x2c0e22(0x1ea),_0x2c0e22(0xb27)+_0x527f1b['message']);}}async function _0x6ebfcb(){const _0x4a845c=_0x475790;if(!_0x579fa9)return;const _0x13a866=_0x28f30a[_0x4a845c(0x6ce)][_0x579fa9];if(!_0x13a866)return;try{const {proxyUrl:_0x21f5bd,apiKey:_0x27785d,model:_0x477031}=_0x28f30a[_0x4a845c(0x1537)];if(!_0x21f5bd||!_0x27785d||!_0x477031)throw new Error(_0x4a845c(0x626));const _0x333f13=parseInt(_0x13a866[_0x4a845c(0x362)][_0x4a845c(0xfcd)])||0xa,_0x247c3f=_0x13a866['history'][_0x4a845c(0x225)](-_0x333f13),_0x5aed87=_0x13a866['settings']['myNickname']||'我',_0x47a594=_0x13a866['settings'][_0x4a845c(0x1528)]||'用户',_0x490b37=_0x4a845c(0xe47)+(_0x13a866[_0x4a845c(0x153f)]&&_0x13a866[_0x4a845c(0x153f)][_0x4a845c(0x9a1)]>0x0?_0x13a866[_0x4a845c(0x153f)][_0x4a845c(0x11c6)](_0x549374=>'-\x20'+_0x549374[_0x4a845c(0x1047)])[_0x4a845c(0xbad)]('\x0a'):'-\x20(暂无)');let _0x2697b9='';if(_0x13a866[_0x4a845c(0x362)][_0x4a845c(0x684)]&&_0x13a866[_0x4a845c(0x362)][_0x4a845c(0x684)][_0x4a845c(0x9a1)]>0x0){const _0x51cb40=_0x13a866[_0x4a845c(0x362)][_0x4a845c(0x684)][_0x4a845c(0x11c6)](_0x5b3ac8=>{const _0x2ae9f0=_0x4a845c,_0x2564e2=_0x28f30a[_0x2ae9f0(0x13b9)]['find'](_0x36b566=>_0x36b566['id']===_0x5b3ac8);if(!_0x2564e2||!Array[_0x2ae9f0(0x624)](_0x2564e2[_0x2ae9f0(0x1047)]))return'';const _0x2723c5=_0x2564e2[_0x2ae9f0(0x1047)][_0x2ae9f0(0xebc)](_0x62109f=>_0x62109f[_0x2ae9f0(0x400)]!==![])[_0x2ae9f0(0x11c6)](_0x2cc553=>'\x0a###\x20条目:\x20'+(_0x2cc553[_0x2ae9f0(0x70d)]||_0x2ae9f0(0x342))+_0x2ae9f0(0x8d2)+_0x2cc553[_0x2ae9f0(0x1047)])[_0x2ae9f0(0xbad)]('');return _0x2723c5?_0x2ae9f0(0xbd0)+_0x2564e2['name']+'\x0a'+_0x2723c5:'';})['filter'](Boolean)[_0x4a845c(0xbad)]('');_0x51cb40&&(_0x2697b9=_0x4a845c(0xfc9)+_0x51cb40+'\x0a');}const _0x1adb82=_0x5bdf0b(_0x13a866,0x3,'hours'),_0xe5e776=_0x5bdf0b(_0x13a866,0x6,_0x4a845c(0xe03)),_0x51d525=_0x5bdf0b(_0x13a866,0x9,_0x4a845c(0xe03)),_0x136896=_0x5bdf0b(_0x13a866,0x1,_0x4a845c(0xb0b)),_0x1e32b0=_0x5bdf0b(_0x13a866,0x3,_0x4a845c(0xb0b)),_0x149bff=_0x5bdf0b(_0x13a866,0x7,_0x4a845c(0xb0b));let _0x5444aa='';if(_0x1adb82||_0xe5e776||_0x51d525||_0x136896||_0x1e32b0||_0x149bff){_0x5444aa+=_0x4a845c(0xba8);if(_0x1adb82)_0x5444aa+=_0x1adb82;if(_0xe5e776)_0x5444aa+=_0xe5e776;if(_0x51d525)_0x5444aa+=_0x51d525;if(_0x1adb82||_0xe5e776||_0x51d525)_0x5444aa+='\x0a';if(_0x136896)_0x5444aa+=_0x136896;if(_0x1e32b0)_0x5444aa+=_0x1e32b0;if(_0x149bff)_0x5444aa+=_0x149bff;}const _0xbf4f7e=_0x23eb2e(_0x13a866),_0x20f993=_0x4a845c(0x1ac)+_0x13a866['originalName']+_0x4a845c(0xd8d)+_0x13a866[_0x4a845c(0x362)]['aiPersona']+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0xbf4f7e+_0x4a845c(0xabc)+_0x47a594+_0x4a845c(0x654)+_0x13a866['originalName']+'\x22\x0a-\x20**用户的备注**:\x20\x22'+_0x5aed87+'\x22\x0a'+_0x2697b9+'\x0a'+_0x490b37+'\x0a'+_0x5444aa+_0x4a845c(0x1208)+_0x247c3f['map'](_0x222240=>(_0x222240['role']===_0x4a845c(0xcc9)?_0x5aed87:_0x13a866[_0x4a845c(0xe36)])+':\x20'+String(_0x222240[_0x4a845c(0x1047)]))[_0x4a845c(0xbad)]('\x0a')+_0x4a845c(0xd97),_0x817168=_0x247c3f[_0x4a845c(0x11c6)](_0x1f1eb4=>({'role':_0x1f1eb4['role'],'content':(_0x1f1eb4[_0x4a845c(0x9be)]===_0x4a845c(0xcc9)?_0x5aed87:_0x13a866['name'])+':\x20'+String(_0x1f1eb4[_0x4a845c(0x1047)])}));let _0x1d8017=_0x21f5bd['includes']('generativelanguage'),_0x12af14=_0x4fff3d(_0x477031,_0x27785d,_0x20f993,_0x817168);const _0xe7dd80=_0x1d8017?await fetch(_0x12af14['url'],_0x12af14[_0x4a845c(0x1418)]):await fetch(_0x21f5bd+_0x4a845c(0x1427),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x4a845c(0xe83)+_0x27785d},'body':JSON[_0x4a845c(0xe4d)]({'model':_0x477031,'messages':[{'role':'system','content':_0x20f993},..._0x817168],'temperature':_0x28f30a[_0x4a845c(0x1062)][_0x4a845c(0x294)]||0.8})});if(!_0xe7dd80['ok'])throw new Error(_0x4a845c(0x1515)+(await _0xe7dd80[_0x4a845c(0x12a2)]())[_0x4a845c(0x1518)][_0x4a845c(0x13bc)]);const _0x20b6ad=await _0xe7dd80[_0x4a845c(0x12a2)](),_0x7c97cf=getGeminiResponseText(_0x20b6ad),_0x3d15e9=_0x422882(_0x7c97cf);if(!_0x3d15e9||_0x3d15e9['length']===0x0)throw new Error(_0x4a845c(0x797));let _0x176908=0x0,_0x16b84e=Date[_0x4a845c(0x487)]();for(const _0x4d614c of _0x3d15e9){const _0x41d3e1={'role':'assistant','senderName':_0x13a866[_0x4a845c(0x66c)],'timestamp':_0x16b84e++};let _0x3c1f42=null;switch(_0x4d614c[_0x4a845c(0xb4b)]){case _0x4a845c(0x10ca):_0x3c1f42={..._0x41d3e1,'content':String(_0x4d614c[_0x4a845c(0x1047)]||_0x4d614c[_0x4a845c(0x13bc)])};break;case _0x4a845c(0x14f3):if(_0x4d614c[_0x4a845c(0x1488)]){const _0x289f41=_0x28f30a['userStickers']['find'](_0x54e7fe=>_0x54e7fe[_0x4a845c(0xe36)]===_0x4d614c[_0x4a845c(0x1488)]);_0x289f41?_0x3c1f42={..._0x41d3e1,'type':_0x4a845c(0x14f3),'content':_0x289f41['url'],'meaning':_0x289f41[_0x4a845c(0xe36)]}:(console['warn']('AI\x20(CPhone)\x20尝试使用一个不存在的表情:\x20\x22'+_0x4d614c['meaning']+'\x22'),_0x3c1f42={..._0x41d3e1,'type':_0x4a845c(0x10ca),'content':_0x4a845c(0x4f3)+_0x4d614c[_0x4a845c(0x1488)]+']'});}else console[_0x4a845c(0x664)](_0x4a845c(0x132a),_0x4d614c),_0x3c1f42={..._0x41d3e1,'type':_0x4a845c(0x14f3),'content':_0x4d614c[_0x4a845c(0x6d1)],'meaning':_0x4a845c(0x2ca)};break;}_0x3c1f42&&(_0x13a866[_0x4a845c(0x12c3)][_0x4a845c(0x367)](_0x3c1f42),_0x176908++);}_0x176908>0x0&&(_0x13a866['unreadCount']=(_0x13a866[_0x4a845c(0xce1)]||0x0)+_0x176908),await _0x5b9d83[_0x4a845c(0x6ce)][_0x4a845c(0x7c3)](_0x13a866),await _0x5db8a3(),_0x176908>0x0&&_0x1c12fe(_0x13a866['id'],'发来了\x20'+_0x176908+_0x4a845c(0x39b));}catch(_0x39de5b){console[_0x4a845c(0x1518)](_0x4a845c(0x1f2),_0x39de5b),await _0x34d596(_0x4a845c(0x221),'无法生成新回复:\x20'+_0x39de5b[_0x4a845c(0x13bc)]);}}async function _0x40d28b(){const _0x154ceb=_0x475790;if(_0x24e903||!_0x579fa9)return;_0x24e903=!![];const _0x191df8=document[_0x154ceb(0x2ec)](_0x154ceb(0xaad)),_0x2d1f18=_0x28f30a[_0x154ceb(0x6ce)][_0x579fa9];if(!_0x2d1f18){_0x24e903=![];return;}_0x5d72d6(_0x191df8,'top');const _0x407dbb=_0x191df8[_0x154ceb(0x1ce)];await new Promise(_0x3b7033=>setTimeout(_0x3b7033,0x1f4));const _0xb15130=_0x2d1f18[_0x154ceb(0x12c3)][_0x154ceb(0x9a1)],_0x3182e1=_0x28f30a[_0x154ceb(0x1062)]['chatRenderWindow']||0x32,_0x3dd050=_0xb15130-_0x2d3c48,_0x28e1de=Math['max'](0x0,_0x3dd050-_0x3182e1),_0xdb3556=_0x2d1f18['history'][_0x154ceb(0x225)](_0x28e1de,_0x3dd050);_0x66d5be(_0x191df8);if(_0xdb3556[_0x154ceb(0x9a1)]===0x0){_0x24e903=![];return;}for(const _0x3639fb of _0xdb3556[_0x154ceb(0x6c9)]()){const _0x2abd93={..._0x3639fb,'role':_0x3639fb[_0x154ceb(0x9be)]===_0x154ceb(0xcc9)?_0x154ceb(0x6d9):_0x154ceb(0xcc9)},_0x2f1e9e={'id':'temp_user_chat_mirror','isGroup':![],'name':_0x2d1f18[_0x154ceb(0xe36)],'settings':{..._0x2d1f18[_0x154ceb(0x362)],'myAvatar':_0x2d1f18[_0x154ceb(0x362)]['aiAvatar'],'myAvatarFrame':_0x2d1f18[_0x154ceb(0x362)][_0x154ceb(0x5b8)],'aiAvatar':_0x2d1f18[_0x154ceb(0x362)]['myAvatar'],'aiAvatarFrame':_0x2d1f18['settings'][_0x154ceb(0xffe)]}},_0x5e0e7a=await _0x43f190(_0x2abd93,_0x2f1e9e);_0x5e0e7a&&_0x191df8[_0x154ceb(0x41f)](_0x5e0e7a);}_0x2d3c48+=_0xdb3556[_0x154ceb(0x9a1)];const _0x2e9ec2=_0x191df8['scrollHeight'];_0x191df8[_0x154ceb(0x12be)]=_0x2e9ec2-_0x407dbb,_0x24e903=![];}async function _0x237dee(_0x315026){const _0x5d9f54=_0x475790,_0x2b33e8=_0x28f30a[_0x5d9f54(0x6ce)][_0x579fa9];if(!_0x2b33e8)return;_0x4a6199=_0x315026===-0x1?_0x5d9f54(0xc9f):_0x2b33e8['simulatedConversations'][_0x315026]?.[_0x5d9f54(0xb4b)];const _0x35342a=document[_0x5d9f54(0x2ec)](_0x5d9f54(0xaad));_0x35342a[_0x5d9f54(0xc43)]='',_0x35342a[_0x5d9f54(0xe93)][_0x5d9f54(0x2a7)]=_0x2b33e8[_0x5d9f54(0x362)][_0x5d9f54(0x2a7)]||_0x5d9f54(0x44a);const _0x523dc7=document[_0x5d9f54(0x2ec)](_0x5d9f54(0x1007))['classList'][_0x5d9f54(0xe9a)]('dark-mode');_0x35342a[_0x5d9f54(0x589)]['backgroundColor']=_0x523dc7?_0x5d9f54(0x9ef):_0x5d9f54(0x471);let _0x184444,_0x32b9ef=[];const _0x202f52=await _0x5b9d83[_0x5d9f54(0x8f4)][_0x5d9f54(0x14b5)](),_0x519a58=new Map(_0x202f52[_0x5d9f54(0x11c6)](_0x9f4a31=>[_0x9f4a31[_0x5d9f54(0xe36)],_0x9f4a31]));if(_0x315026===-0x1){_0x4a6199=_0x5d9f54(0xc9f);const _0x24b13a=document[_0x5d9f54(0x2ec)](_0x5d9f54(0x242)),_0x1e4ac7=document['getElementById']('char-simulated-input');_0x35342a[_0x5d9f54(0xc43)]='',_0x24b13a[_0x5d9f54(0x15f)]=_0x2b33e8[_0x5d9f54(0x362)][_0x5d9f54(0xa28)]||(_0x28f30a['qzoneSettings'][_0x5d9f54(0x19a)]||'我'),_0x1e4ac7[_0x5d9f54(0xa0a)]='与\x20'+(_0x2b33e8[_0x5d9f54(0x362)][_0x5d9f54(0xa28)]||'我')+_0x5d9f54(0xa58),_0x2d3c48=0x0,_0x24e903=![];const _0x5017d0=_0x2b33e8[_0x5d9f54(0x12c3)],_0x468919=_0x28f30a[_0x5d9f54(0x1062)]['chatRenderWindow']||0x32,_0x557704=_0x5017d0['slice'](-_0x468919);_0x184444={'id':_0x5d9f54(0xe05),'isGroup':![],'name':_0x2b33e8[_0x5d9f54(0xe36)],'settings':{..._0x2b33e8[_0x5d9f54(0x362)],'myAvatar':_0x2b33e8['settings'][_0x5d9f54(0xe91)],'myAvatarFrame':_0x2b33e8['settings'][_0x5d9f54(0x5b8)],'aiAvatar':_0x2b33e8[_0x5d9f54(0x362)][_0x5d9f54(0x10a3)],'aiAvatarFrame':_0x2b33e8[_0x5d9f54(0x362)][_0x5d9f54(0xffe)]}},_0x32b9ef=_0x557704[_0x5d9f54(0x11c6)](_0x1c728c=>({..._0x1c728c,'role':_0x1c728c[_0x5d9f54(0x9be)]===_0x5d9f54(0xcc9)?_0x5d9f54(0x6d9):'user'})),_0x2d3c48=_0x557704['length'];}else{const _0x4de18d=_0x2b33e8[_0x5d9f54(0x1400)][_0x315026];if(!_0x4de18d)return;_0x4a6199=_0x4de18d['type'];const _0x2c3d41=document[_0x5d9f54(0x2ec)](_0x5d9f54(0x242)),_0x4e4b26=document[_0x5d9f54(0x2ec)](_0x5d9f54(0x6c3));if(_0x4de18d['type']===_0x5d9f54(0x1356))_0x2c3d41['textContent']=_0x4de18d[_0x5d9f54(0x137e)]+'\x20('+(_0x4de18d['participants'][_0x5d9f54(0x9a1)]+0x1)+')',_0x4e4b26[_0x5d9f54(0xa0a)]='在\x20'+_0x4de18d[_0x5d9f54(0x137e)]+_0x5d9f54(0x11d9),_0x184444={'id':_0x5d9f54(0x21c),'isGroup':!![],'name':_0x4de18d[_0x5d9f54(0x137e)],'originalName':_0x2b33e8['originalName'],'members':_0x4de18d[_0x5d9f54(0x73e)][_0x5d9f54(0x11c6)](_0x520939=>{const _0x2709a8=_0x5d9f54,_0x124b5a=_0x519a58[_0x2709a8(0x6b5)](_0x520939['name']);let _0x5d2bf7=_0x124b5a&&_0x124b5a[_0x2709a8(0x516)]?_0x124b5a['avatar']:_0x28f30a[_0x2709a8(0x1062)]['enableAiDrawing']?_0x2709a8(0x6d0)+encodeURIComponent(_0x520939['avatar_prompt']||'anime\x20person'):_0xd71c66;return{'originalName':_0x520939[_0x2709a8(0xe36)],'groupNickname':_0x520939[_0x2709a8(0xe36)],'avatar':_0x5d2bf7};}),'settings':{..._0x2b33e8['settings'],'myNickname':_0x2b33e8[_0x5d9f54(0xe36)],'myAvatar':_0x2b33e8[_0x5d9f54(0x362)][_0x5d9f54(0xe91)],'myAvatarFrame':_0x2b33e8['settings'][_0x5d9f54(0x5b8)]}};else{_0x2c3d41['textContent']=_0x4de18d[_0x5d9f54(0x30f)]['name'],_0x4e4b26['placeholder']='与\x20'+_0x4de18d[_0x5d9f54(0x30f)][_0x5d9f54(0xe36)]+_0x5d9f54(0xce7);const _0x2a9416=_0x519a58['get'](_0x4de18d[_0x5d9f54(0x30f)][_0x5d9f54(0xe36)]),_0x253bd4=_0x2a9416&&_0x2a9416[_0x5d9f54(0x516)]?_0x2a9416[_0x5d9f54(0x516)]:_0x28f30a[_0x5d9f54(0x1062)][_0x5d9f54(0x10fa)]?_0x5d9f54(0x6d0)+encodeURIComponent(_0x4de18d[_0x5d9f54(0x30f)][_0x5d9f54(0x1306)]||_0x5d9f54(0x149a)):_0xd71c66;_0x184444={'id':_0x5d9f54(0x40d),'isGroup':![],'name':_0x4de18d[_0x5d9f54(0x30f)][_0x5d9f54(0xe36)],'originalName':_0x2b33e8[_0x5d9f54(0x66c)],'settings':{..._0x2b33e8['settings'],'myAvatar':_0x2b33e8['settings'][_0x5d9f54(0xe91)],'myAvatarFrame':_0x2b33e8['settings'][_0x5d9f54(0x5b8)],'aiAvatar':_0x253bd4,'aiAvatarFrame':''}};}_0x32b9ef=_0x4de18d[_0x5d9f54(0x6a7)];}for(const _0x3549cb of _0x32b9ef){let _0x54fa6e=_0x3549cb['role'];if(_0x315026!==-0x1){const _0x4d8bc=_0x3549cb[_0x5d9f54(0x1491)]===(_0x2b33e8[_0x5d9f54(0x66c)]||_0x2b33e8[_0x5d9f54(0xe36)]);_0x54fa6e=_0x4d8bc?_0x5d9f54(0xcc9):_0x5d9f54(0x6d9);}const _0x163ae5={'role':_0x54fa6e,'senderName':_0x3549cb['sender']||(_0x54fa6e===_0x5d9f54(0xcc9)?_0x184444[_0x5d9f54(0x362)]['myNickname']:_0x184444[_0x5d9f54(0xe36)]),'timestamp':_0x3549cb['timestamp']||Date[_0x5d9f54(0x487)]()+Math[_0x5d9f54(0x1337)]()};if(_0x3549cb[_0x5d9f54(0xb4b)]===_0x5d9f54(0x14f3)&&_0x3549cb[_0x5d9f54(0x1488)]){const _0x382385=_0x28f30a[_0x5d9f54(0xf28)]['find'](_0x53eec8=>_0x53eec8['name']===_0x3549cb[_0x5d9f54(0x1488)]);_0x382385?(_0x163ae5[_0x5d9f54(0x1047)]=_0x382385[_0x5d9f54(0x6d1)],_0x163ae5['meaning']=_0x3549cb[_0x5d9f54(0x1488)],_0x163ae5[_0x5d9f54(0xb4b)]=_0x5d9f54(0x14f3)):(console[_0x5d9f54(0x664)](_0x5d9f54(0x20e)+_0x3549cb['meaning']+_0x5d9f54(0xb6f)),_0x163ae5['content']=_0x5d9f54(0x4f3)+_0x3549cb[_0x5d9f54(0x1488)]+']',_0x163ae5['type']=_0x5d9f54(0x10ca));}else _0x163ae5[_0x5d9f54(0x1047)]=_0x3549cb[_0x5d9f54(0x1047)],_0x163ae5['type']=_0x3549cb[_0x5d9f54(0xb4b)]||'text';const _0x4935d6=await _0x43f190(_0x163ae5,_0x184444);_0x4935d6&&_0x35342a['appendChild'](_0x4935d6);}_0x38e7ae(_0x5d9f54(0xd9d)),setTimeout(()=>_0x35342a['scrollTop']=_0x35342a['scrollHeight'],0x0);}function _0x396d69(){const _0x315307=_0x475790;document[_0x315307(0x2ec)](_0x315307(0x8cf))[_0x315307(0xff6)]['remove']('visible');}async function _0x2443cd(){const _0x569722=_0x475790;if(!_0x579fa9)return;const _0xb47f76=_0x28f30a[_0x569722(0x6ce)][_0x579fa9];if(!_0xb47f76){await _0x34d596(_0x569722(0x221),_0x569722(0x13f8));return;}await _0x34d596(_0x569722(0x13e4),_0x569722(0x14a4)+_0xb47f76[_0x569722(0xe36)]+_0x569722(0xa23));const {proxyUrl:_0x129da2,apiKey:_0x315a60,model:_0x41f483}=_0x28f30a[_0x569722(0x1537)];if(!_0x129da2||!_0x315a60||!_0x41f483){alert(_0x569722(0x61d));return;}const _0x27cb11=_0x28f30a[_0x569722(0x1506)][_0x569722(0x19a)]===_0x569722(0x450)||!_0x28f30a[_0x569722(0x1506)][_0x569722(0x19a)]?'用户':_0x28f30a['qzoneSettings'][_0x569722(0x19a)],_0x5477a7=_0xb47f76['longTermMemory']&&_0xb47f76[_0x569722(0x153f)][_0x569722(0x9a1)]>0x0?_0xb47f76['longTermMemory'][_0x569722(0x11c6)](_0x2280a0=>_0x569722(0x151a)+_0xf1c86d(_0x2280a0['timestamp'])+')\x20'+_0x2280a0[_0x569722(0x1047)])[_0x569722(0xbad)]('\x0a'):'无',_0x55c4c2=_0xb47f76['settings'][_0x569722(0xfcd)]||0xa,_0xa7e18a=_0xb47f76[_0x569722(0x12c3)][_0x569722(0x225)](-_0x55c4c2)['map'](_0x22e8e3=>(_0x22e8e3[_0x569722(0x9be)]===_0x569722(0xcc9)?_0x27cb11:_0xb47f76[_0x569722(0xe36)])+':\x20'+String(_0x22e8e3[_0x569722(0x1047)])[_0x569722(0xa6b)](0x0,0x1e)+_0x569722(0x4e6))['join']('\x0a'),_0x591643=(_0xb47f76[_0x569722(0x362)][_0x569722(0x684)]||[])[_0x569722(0x11c6)](_0xbed619=>_0x28f30a[_0x569722(0x13b9)][_0x569722(0x412)](_0x2fbb57=>_0x2fbb57['id']===_0xbed619))[_0x569722(0xebc)](Boolean)['map'](_0x1661c1=>'\x0a##\x20世界书《'+_0x1661c1[_0x569722(0xe36)]+_0x569722(0xdd9)+_0x1661c1[_0x569722(0x1047)][_0x569722(0xebc)](_0x3dda83=>_0x3dda83[_0x569722(0x400)])[_0x569722(0x11c6)](_0x7f2ec=>'-\x20'+_0x7f2ec[_0x569722(0x1047)])[_0x569722(0xbad)]('\x0a'))['join'](''),_0x34f4f8=_0x5bdf0b(_0xb47f76,0x3,_0x569722(0xe03)),_0x5756fa=_0x5bdf0b(_0xb47f76,0x6,_0x569722(0xe03)),_0x3b0982=_0x5bdf0b(_0xb47f76,0x9,_0x569722(0xe03)),_0x49359b=_0x5bdf0b(_0xb47f76,0x1,_0x569722(0xb0b)),_0xdf0ba=_0x5bdf0b(_0xb47f76,0x3,'days'),_0x1e4f7d=_0x5bdf0b(_0xb47f76,0x7,_0x569722(0xb0b));let _0x381b21='';if(_0x34f4f8||_0x5756fa||_0x3b0982||_0x49359b||_0xdf0ba||_0x1e4f7d){_0x381b21+=_0x569722(0xba8);if(_0x34f4f8)_0x381b21+=_0x34f4f8;if(_0x5756fa)_0x381b21+=_0x5756fa;if(_0x3b0982)_0x381b21+=_0x3b0982;if(_0x34f4f8||_0x5756fa||_0x3b0982)_0x381b21+='\x0a';if(_0x49359b)_0x381b21+=_0x49359b;if(_0xdf0ba)_0x381b21+=_0xdf0ba;if(_0x1e4f7d)_0x381b21+=_0x1e4f7d;}const _0x1b5a1c='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0xb47f76[_0x569722(0xe36)]+_0x569722(0x438)+_0xb47f76[_0x569722(0x362)][_0x569722(0x67c)]+'\x0a'+_0x5477a7+'\x0a'+_0x591643+'\x0a'+_0x381b21+'\x20\x0a-\x20**你最近和“'+_0x27cb11+'”的对话摘要**:\x0a'+_0xa7e18a+_0x569722(0x9f2);try{const _0x1f664b=[{'role':'user','content':_0x569722(0xafb)}];let _0x5d79e4=_0x129da2[_0x569722(0x138a)](_0x569722(0xe9c)),_0x51bca9=_0x4fff3d(_0x41f483,_0x315a60,_0x1b5a1c,_0x1f664b);const _0xbea30d=_0x5d79e4?await fetch(_0x51bca9[_0x569722(0x6d1)],_0x51bca9[_0x569722(0x1418)]):await fetch(_0x129da2+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x569722(0x1446),'Authorization':'Bearer\x20'+_0x315a60},'body':JSON[_0x569722(0xe4d)]({'model':_0x41f483,'messages':[{'role':_0x569722(0x10a7),'content':_0x1b5a1c},..._0x1f664b],'temperature':_0x28f30a[_0x569722(0x1062)][_0x569722(0x294)]||0.9})});if(!_0xbea30d['ok'])throw new Error(_0x569722(0xe6d)+_0xbea30d[_0x569722(0x1066)]);const _0x372129=await _0xbea30d[_0x569722(0x12a2)](),_0x1bc2be=getGeminiResponseText(_0x372129),_0x407be6=_0x1bc2be[_0x569722(0x49a)](/(\[[\s\S]*\])/);if(!_0x407be6||!_0x407be6[0x0])throw new Error(_0x569722(0xf15)+_0x1bc2be);const _0x427899=_0x407be6[0x0];let _0x33fdec;try{_0x33fdec=JSON[_0x569722(0xd91)](_0x427899);}catch(_0x2f2a9d){throw new Error(_0x569722(0x1044)+_0x2f2a9d[_0x569722(0x13bc)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x1bc2be);}_0xb47f76[_0x569722(0x7e0)]=_0x33fdec,await _0x5b9d83[_0x569722(0x6ce)][_0x569722(0x7c3)](_0xb47f76),await _0xcf12a8();}catch(_0x223285){console[_0x569722(0x1518)](_0x569722(0x276),_0x223285),await _0x34d596(_0x569722(0x1ea),_0x569722(0xb86)+_0x223285[_0x569722(0x13bc)]);}}async function _0xcf12a8(){const _0x9da9b3=_0x475790,_0x57cdd4=document['getElementById']('char-album-grid');_0x57cdd4['innerHTML']='';if(!_0x579fa9)return;const _0x307f8c=_0x28f30a['chats'][_0x579fa9],_0x341bfb=_0x307f8c[_0x9da9b3(0x7e0)]||[];if(_0x341bfb['length']===0x0){_0x57cdd4['innerHTML']=_0x9da9b3(0x3e0);return;}const _0xce1881=_0x9da9b3(0xec2);_0x341bfb[_0x9da9b3(0xf99)](_0x1b443a=>{const _0x37c290=_0x9da9b3,_0x1375ab=document[_0x37c290(0x14ae)](_0x37c290(0xaa5));_0x1375ab[_0x37c290(0xdd1)]=_0x37c290(0x72c),_0x1375ab[_0x37c290(0xe93)][_0x37c290(0x9cc)]=_0x1b443a[_0x37c290(0x9cc)],_0x57cdd4[_0x37c290(0x998)](_0x1375ab);if(_0x28f30a[_0x37c290(0x1062)][_0x37c290(0x10fa)]){_0x1375ab[_0x37c290(0x589)]['backgroundColor']=_0x37c290(0xb52);const _0x336c1e=/[^\x00-\x7F]/[_0x37c290(0x1e0)](_0x1b443a[_0x37c290(0xe8f)]),_0x4b5148=_0x1b443a['image_prompt']&&_0x1b443a[_0x37c290(0xe8f)][_0x37c290(0x97e)]()&&!_0x336c1e,_0x173cc6=_0x4b5148?_0x1b443a[_0x37c290(0xe8f)]:_0x37c290(0x3dd),_0x37930a=_0x37c290(0x6d0)+encodeURIComponent(_0x173cc6),_0x200ecc=new Image();_0x200ecc[_0x37c290(0xf2d)]=function(){const _0x12deee=_0x37c290;_0x1375ab[_0x12deee(0x589)][_0x12deee(0xe00)]='url('+this[_0x12deee(0xce4)]+')';},_0x200ecc[_0x37c290(0x125a)]=function(){const _0x4f142b=_0x37c290;_0x1375ab['style'][_0x4f142b(0xe00)]='url('+_0xce1881+')';},_0x200ecc['src']=_0x37930a;}else{_0x1375ab[_0x37c290(0x589)][_0x37c290(0xc34)]=_0x37c290(0x471),_0x1375ab[_0x37c290(0x589)]['border']=_0x37c290(0xe5d);const _0x6bd91f=document[_0x37c290(0x14ae)]('p');_0x6bd91f[_0x37c290(0xdd1)]=_0x37c290(0x5df),_0x6bd91f[_0x37c290(0x15f)]=_0x1b443a['description']||_0x37c290(0x7d5),_0x1375ab[_0x37c290(0x998)](_0x6bd91f);}});}async function _0x48b643(){const _0x2889e3=_0x475790;if(!_0x579fa9)return;const _0x7019de=_0x28f30a['chats'][_0x579fa9];if(!_0x7019de)return;await _0x34d596(_0x2889e3(0x13e4),_0x2889e3(0x4d6)+_0x7019de[_0x2889e3(0xe36)]+_0x2889e3(0x8b8));const {proxyUrl:_0x5b3efd,apiKey:_0x400e49,model:_0x479976}=_0x28f30a[_0x2889e3(0x1537)];if(!_0x5b3efd||!_0x400e49||!_0x479976){alert(_0x2889e3(0x529));return;}const _0x3b0c6b=_0x28f30a[_0x2889e3(0x1506)][_0x2889e3(0x19a)]===_0x2889e3(0x450)||!_0x28f30a[_0x2889e3(0x1506)][_0x2889e3(0x19a)]?'用户':_0x28f30a[_0x2889e3(0x1506)][_0x2889e3(0x19a)],_0x4c46f6=_0x7019de[_0x2889e3(0x153f)]&&_0x7019de[_0x2889e3(0x153f)]['length']>0x0?_0x7019de[_0x2889e3(0x153f)][_0x2889e3(0x11c6)](_0x26775d=>_0x2889e3(0x151a)+_0xf1c86d(_0x26775d[_0x2889e3(0x69a)])+')\x20'+_0x26775d[_0x2889e3(0x1047)])[_0x2889e3(0xbad)]('\x0a'):'无',_0x27b073=_0x7019de[_0x2889e3(0x362)][_0x2889e3(0xfcd)]||0xa,_0x3a1b72=_0x7019de['history']['slice'](-_0x27b073)[_0x2889e3(0x11c6)](_0x524e46=>(_0x524e46[_0x2889e3(0x9be)]===_0x2889e3(0xcc9)?_0x3b0c6b:_0x7019de['name'])+':\x20'+String(_0x524e46[_0x2889e3(0x1047)])[_0x2889e3(0xa6b)](0x0,0x1e)+_0x2889e3(0x4e6))[_0x2889e3(0xbad)]('\x0a'),_0x29ba0c=(_0x7019de[_0x2889e3(0x362)][_0x2889e3(0x684)]||[])['map'](_0x743c11=>_0x28f30a['worldBooks'][_0x2889e3(0x412)](_0x263b34=>_0x263b34['id']===_0x743c11))[_0x2889e3(0xebc)](Boolean)[_0x2889e3(0x11c6)](_0x3517cb=>_0x2889e3(0x1097)+_0x3517cb['name']+_0x2889e3(0xdd9)+_0x3517cb['content'][_0x2889e3(0xebc)](_0x5db247=>_0x5db247[_0x2889e3(0x400)])[_0x2889e3(0x11c6)](_0x3ec388=>'-\x20'+_0x3ec388[_0x2889e3(0x1047)])[_0x2889e3(0xbad)]('\x0a'))[_0x2889e3(0xbad)](''),_0x22b753=_0x5bdf0b(_0x7019de,0x3,_0x2889e3(0xe03)),_0x1e9bd8=_0x5bdf0b(_0x7019de,0x6,'hours'),_0x4794b7=_0x5bdf0b(_0x7019de,0x9,'hours'),_0x5b8609=_0x5bdf0b(_0x7019de,0x1,_0x2889e3(0xb0b)),_0x548249=_0x5bdf0b(_0x7019de,0x3,_0x2889e3(0xb0b)),_0x575f16=_0x5bdf0b(_0x7019de,0x7,'days');let _0x3cd7b8='';if(_0x22b753||_0x1e9bd8||_0x4794b7||_0x5b8609||_0x548249||_0x575f16){_0x3cd7b8+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x22b753)_0x3cd7b8+=_0x22b753;if(_0x1e9bd8)_0x3cd7b8+=_0x1e9bd8;if(_0x4794b7)_0x3cd7b8+=_0x4794b7;if(_0x22b753||_0x1e9bd8||_0x4794b7)_0x3cd7b8+='\x0a';if(_0x5b8609)_0x3cd7b8+=_0x5b8609;if(_0x548249)_0x3cd7b8+=_0x548249;if(_0x575f16)_0x3cd7b8+=_0x575f16;}const _0xf72bc4=_0x7019de['settings']['myPersona']||_0x2889e3(0x1541),_0xd6049=_0x2889e3(0xf8f)+_0x7019de[_0x2889e3(0xe36)]+'”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x7019de[_0x2889e3(0x362)]['aiPersona']+_0x2889e3(0xd14)+_0xf72bc4+_0x2889e3(0x580)+_0x4c46f6+'\x0a'+_0x29ba0c+'\x0a'+_0x3cd7b8+_0x2889e3(0xc71)+_0x3b0c6b+_0x2889e3(0x658)+_0x3a1b72+_0x2889e3(0xf56);try{const _0x58eb53=[{'role':_0x2889e3(0xcc9),'content':_0x2889e3(0x247)}];let _0x1133ca=_0x5b3efd[_0x2889e3(0x138a)](_0x2889e3(0xe9c)),_0x5a87bf=_0x4fff3d(_0x479976,_0x400e49,_0xd6049,_0x58eb53);const _0xffccbc=_0x1133ca?await fetch(_0x5a87bf[_0x2889e3(0x6d1)],_0x5a87bf['data']):await fetch(_0x5b3efd+'/v1/chat/completions',{'method':_0x2889e3(0x655),'headers':{'Content-Type':_0x2889e3(0x1446),'Authorization':_0x2889e3(0xe83)+_0x400e49},'body':JSON[_0x2889e3(0xe4d)]({'model':_0x479976,'messages':[{'role':_0x2889e3(0x10a7),'content':_0xd6049},..._0x58eb53],'temperature':_0x28f30a['globalSettings'][_0x2889e3(0x294)]||0.9})});if(!_0xffccbc['ok'])throw new Error(_0x2889e3(0xe6d)+_0xffccbc[_0x2889e3(0x1066)]);const _0x6e0dfe=await _0xffccbc[_0x2889e3(0x12a2)](),_0x2cfff9=getGeminiResponseText(_0x6e0dfe),_0x494a4a=_0x2cfff9[_0x2889e3(0x49a)](/(\[[\s\S]*\])/);if(!_0x494a4a||!_0x494a4a[0x0])throw new Error(_0x2889e3(0xf15)+_0x2cfff9);const _0x4f34da=_0x494a4a[0x0];let _0x51e30f;try{_0x51e30f=JSON[_0x2889e3(0xd91)](_0x4f34da);}catch(_0x5657cb){throw new Error(_0x2889e3(0x1044)+_0x5657cb[_0x2889e3(0x13bc)]+_0x2889e3(0x441)+_0x2cfff9);}_0x7019de[_0x2889e3(0x568)]=_0x51e30f,await _0x5b9d83['chats']['put'](_0x7019de),await _0x51eba7();}catch(_0x3654b3){console[_0x2889e3(0x1518)](_0x2889e3(0x140b),_0x3654b3),await _0x34d596(_0x2889e3(0x1ea),_0x2889e3(0x86a)+_0x3654b3[_0x2889e3(0x13bc)]);}}function _0x51eba7(){const _0x6f8c1d=_0x475790,_0xce4f6d=document[_0x6f8c1d(0x2ec)]('char-browser-history');_0xce4f6d[_0x6f8c1d(0xc43)]='';if(!_0x579fa9)return;const _0x2fda68=_0x28f30a[_0x6f8c1d(0x6ce)][_0x579fa9],_0x4bf3aa=_0x2fda68[_0x6f8c1d(0x568)]||[];if(_0x4bf3aa[_0x6f8c1d(0x9a1)]===0x0){_0xce4f6d[_0x6f8c1d(0xc43)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>';return;}_0x4bf3aa['forEach']((_0x475ae4,_0x294e9a)=>{const _0x168f8b=_0x6f8c1d,_0x3ab6ee=document[_0x168f8b(0x14ae)](_0x168f8b(0xaa5));_0x3ab6ee[_0x168f8b(0xdd1)]=_0x168f8b(0xe50),_0x3ab6ee[_0x168f8b(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x475ae4['title']+_0x168f8b(0x3c6)+_0x475ae4[_0x168f8b(0x6d1)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x3ab6ee[_0x168f8b(0xf79)](_0x168f8b(0x1177),()=>_0x26bfc0(_0x294e9a)),_0xce4f6d['appendChild'](_0x3ab6ee);});}async function _0x26bfc0(_0x12e317){const _0x16e204=_0x475790,_0x2b10d9=_0x28f30a[_0x16e204(0x6ce)][_0x579fa9],_0x48d51e=_0x2b10d9[_0x16e204(0x568)][_0x12e317];if(!_0x48d51e)return;_0x68d37c=_0x48d51e,_0x1385e8(_0x48d51e),_0x38e7ae(_0x16e204(0x1530));const _0x1dc72b=document[_0x16e204(0x2ec)](_0x16e204(0xcf4)),_0x191b06=await _0x5b9d83[_0x16e204(0x101f)][_0x16e204(0x67e)]({'type':_0x16e204(0xa1b),'content.url':_0x48d51e['url']})['first']();_0x1dc72b[_0x16e204(0xff6)][_0x16e204(0x14c8)](_0x16e204(0xd43),!!_0x191b06);}async function _0x59968c(){const _0x454b98=_0x475790;if(!_0x68d37c||!_0x579fa9)return;const _0x239415=_0x68d37c,_0x322a3f=_0x28f30a[_0x454b98(0x6ce)][_0x579fa9],_0x35b600=document[_0x454b98(0x2ec)](_0x454b98(0xcf4)),_0x3ffb34=await _0x5b9d83[_0x454b98(0x101f)][_0x454b98(0x67e)]({'type':_0x454b98(0xa1b),'content.url':_0x239415[_0x454b98(0x6d1)]})[_0x454b98(0x942)]();if(_0x3ffb34)await _0x5b9d83[_0x454b98(0x101f)][_0x454b98(0x54b)](_0x3ffb34['id']),_0x35b600['classList'][_0x454b98(0x1424)](_0x454b98(0xd43)),await _0x34d596(_0x454b98(0x699),_0x454b98(0xf23));else{const _0x4cf36e={'type':_0x454b98(0xa1b),'content':{..._0x239415,'characterId':_0x579fa9,'characterName':_0x322a3f[_0x454b98(0xe36)]},'timestamp':Date[_0x454b98(0x487)]()};await _0x5b9d83[_0x454b98(0x101f)][_0x454b98(0xe82)](_0x4cf36e),_0x35b600[_0x454b98(0xff6)]['add'](_0x454b98(0xd43)),await _0x34d596('操作成功',_0x454b98(0xec4));}}function _0x1385e8(_0x34969c){const _0x2ebff0=_0x475790,_0x5c67fe=document[_0x2ebff0(0x2ec)](_0x2ebff0(0xa6d)),_0x58884d=document[_0x2ebff0(0x2ec)](_0x2ebff0(0x7e9));_0x5c67fe[_0x2ebff0(0x15f)]=_0x34969c[_0x2ebff0(0x141e)],_0x58884d[_0x2ebff0(0xc43)]='',_0x34969c[_0x2ebff0(0xb4b)]==='image'?_0x58884d['innerHTML']=_0x2ebff0(0x3a4)+(_0x34969c['title']||'(无标题)')+_0x2ebff0(0x1251):_0x58884d['innerHTML']=_0x2ebff0(0x133c)+(_0x34969c[_0x2ebff0(0x1047)]||_0x2ebff0(0xab3))[_0x2ebff0(0x13ed)](/\n/g,_0x2ebff0(0x1509))+'</p>';}async function _0x97ebab(){const _0x41d5f4=_0x475790;if(!_0x579fa9)return;const _0x1caf49=_0x28f30a[_0x41d5f4(0x6ce)][_0x579fa9];if(!_0x1caf49)return;await _0x34d596(_0x41d5f4(0x13e4),_0x41d5f4(0x4d6)+_0x1caf49['name']+'”的购物习惯...');const {proxyUrl:_0x4f4f2b,apiKey:_0x1fddbf,model:_0x1656fe}=_0x28f30a[_0x41d5f4(0x1537)];if(!_0x4f4f2b||!_0x1fddbf||!_0x1656fe){alert('API未配置，无法生成内容。');return;}const _0x28f14b=_0x28f30a['qzoneSettings'][_0x41d5f4(0x19a)]==='{{user}}'||!_0x28f30a[_0x41d5f4(0x1506)]['nickname']?'用户':_0x28f30a[_0x41d5f4(0x1506)]['nickname'],_0x479527=_0x1caf49[_0x41d5f4(0x153f)]&&_0x1caf49[_0x41d5f4(0x153f)]['length']>0x0?_0x1caf49['longTermMemory'][_0x41d5f4(0x11c6)](_0x1bd563=>_0x41d5f4(0x151a)+_0xf1c86d(_0x1bd563['timestamp'])+')\x20'+_0x1bd563[_0x41d5f4(0x1047)])[_0x41d5f4(0xbad)]('\x0a'):'无',_0xed028a=_0x1caf49[_0x41d5f4(0x362)]['maxMemory']||0xa,_0x258bbd=_0x1caf49[_0x41d5f4(0x12c3)]['slice'](-_0xed028a)[_0x41d5f4(0x11c6)](_0x64b80=>(_0x64b80[_0x41d5f4(0x9be)]===_0x41d5f4(0xcc9)?_0x28f14b:_0x1caf49[_0x41d5f4(0xe36)])+':\x20'+String(_0x64b80[_0x41d5f4(0x1047)])[_0x41d5f4(0xa6b)](0x0,0x1e)+'...')[_0x41d5f4(0xbad)]('\x0a'),_0x2de19d=(_0x1caf49[_0x41d5f4(0x362)][_0x41d5f4(0x684)]||[])[_0x41d5f4(0x11c6)](_0x122b76=>_0x28f30a[_0x41d5f4(0x13b9)][_0x41d5f4(0x412)](_0x58d28f=>_0x58d28f['id']===_0x122b76))[_0x41d5f4(0xebc)](Boolean)['map'](_0x55748a=>_0x41d5f4(0x1097)+_0x55748a[_0x41d5f4(0xe36)]+_0x41d5f4(0xdd9)+_0x55748a[_0x41d5f4(0x1047)]['filter'](_0xa4606a=>_0xa4606a[_0x41d5f4(0x400)])[_0x41d5f4(0x11c6)](_0x51fda6=>'-\x20'+_0x51fda6[_0x41d5f4(0x1047)])['join']('\x0a'))['join'](''),_0xe976f=_0x5bdf0b(_0x1caf49,0x3,'hours'),_0xbf33e8=_0x5bdf0b(_0x1caf49,0x6,_0x41d5f4(0xe03)),_0x397266=_0x5bdf0b(_0x1caf49,0x9,'hours'),_0x12b7d0=_0x5bdf0b(_0x1caf49,0x1,_0x41d5f4(0xb0b)),_0x544fe4=_0x5bdf0b(_0x1caf49,0x3,_0x41d5f4(0xb0b)),_0x15ce69=_0x5bdf0b(_0x1caf49,0x7,_0x41d5f4(0xb0b));let _0x3480a4='';if(_0xe976f||_0xbf33e8||_0x397266||_0x12b7d0||_0x544fe4||_0x15ce69){_0x3480a4+=_0x41d5f4(0xba8);if(_0xe976f)_0x3480a4+=_0xe976f;if(_0xbf33e8)_0x3480a4+=_0xbf33e8;if(_0x397266)_0x3480a4+=_0x397266;if(_0xe976f||_0xbf33e8||_0x397266)_0x3480a4+='\x0a';if(_0x12b7d0)_0x3480a4+=_0x12b7d0;if(_0x544fe4)_0x3480a4+=_0x544fe4;if(_0x15ce69)_0x3480a4+=_0x15ce69;}const _0x214f8f=_0x41d5f4(0xf8f)+_0x1caf49['name']+_0x41d5f4(0x11ac)+_0x1caf49['settings'][_0x41d5f4(0x67c)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0x479527+'\x0a'+_0x2de19d+'\x0a'+_0x3480a4+_0x41d5f4(0xc71)+_0x28f14b+'”的对话摘要**:\x0a'+_0x258bbd+_0x41d5f4(0xe8c);try{const _0x1bb95a=[{'role':'user','content':_0x41d5f4(0x146e)}];let _0x48a6df=_0x4f4f2b[_0x41d5f4(0x138a)]('generativelanguage'),_0x5d1f59=_0x4fff3d(_0x1656fe,_0x1fddbf,_0x214f8f,_0x1bb95a);const _0x372c54=_0x48a6df?await fetch(_0x5d1f59['url'],_0x5d1f59[_0x41d5f4(0x1418)]):await fetch(_0x4f4f2b+_0x41d5f4(0x1427),{'method':_0x41d5f4(0x655),'headers':{'Content-Type':_0x41d5f4(0x1446),'Authorization':_0x41d5f4(0xe83)+_0x1fddbf},'body':JSON[_0x41d5f4(0xe4d)]({'model':_0x1656fe,'messages':[{'role':'system','content':_0x214f8f},..._0x1bb95a],'temperature':_0x28f30a[_0x41d5f4(0x1062)][_0x41d5f4(0x294)]||0.9})});if(!_0x372c54['ok'])throw new Error(_0x41d5f4(0xe6d)+_0x372c54[_0x41d5f4(0x1066)]);const _0x3ab7f7=await _0x372c54['json'](),_0x3dca97=getGeminiResponseText(_0x3ab7f7),_0x44374d=_0x3dca97[_0x41d5f4(0x49a)](/({[\s\S]*})/);if(!_0x44374d)throw new Error(_0x41d5f4(0xea5));const _0x226414=JSON[_0x41d5f4(0xd91)](_0x44374d[0x0]);!_0x226414['purchases']&&(_0x226414['purchases']=[]),_0x1caf49[_0x41d5f4(0x14e8)]=_0x226414,await _0x5b9d83[_0x41d5f4(0x6ce)]['put'](_0x1caf49),await _0x4eab6a();}catch(_0x3bd41b){console[_0x41d5f4(0x1518)](_0x41d5f4(0x44c),_0x3bd41b),await _0x34d596('生成失败','无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x3bd41b['message']);}}function _0x2e51cf(){const _0x4194cf=_0x475790;_0x57870b(),_0x38e7ae(_0x4194cf(0x226));}function _0x57870b(){const _0x4c06cc=_0x475790,_0x305a4f=document['getElementById'](_0x4c06cc(0x64e));_0x305a4f[_0x4c06cc(0xc43)]='';const _0x106b17=_0x28f30a[_0x4c06cc(0x6ce)][_0x579fa9],_0x20658c=_0x106b17[_0x4c06cc(0x14e8)]||{},_0x509dcf=_0x20658c[_0x4c06cc(0x1056)]||[],_0x2fa7fa=_0x20658c[_0x4c06cc(0xf41)]||0x0,_0x41c7d3=document[_0x4c06cc(0x14ae)](_0x4c06cc(0xaa5));_0x41c7d3[_0x4c06cc(0x589)][_0x4c06cc(0x57a)]=_0x4c06cc(0x1224),_0x41c7d3[_0x4c06cc(0xc43)]=_0x4c06cc(0x164)+_0x2fa7fa['toFixed'](0x2)+_0x4c06cc(0x4d8),_0x305a4f[_0x4c06cc(0x998)](_0x41c7d3);const _0x1e2d02=document[_0x4c06cc(0x14ae)]('h3');_0x1e2d02['textContent']=_0x4c06cc(0x8ef),_0x1e2d02[_0x4c06cc(0x589)][_0x4c06cc(0x57a)]=_0x4c06cc(0x627),_0x305a4f[_0x4c06cc(0x998)](_0x1e2d02);if(_0x509dcf[_0x4c06cc(0x9a1)]===0x0){_0x305a4f[_0x4c06cc(0xc43)]+=_0x4c06cc(0x45b);return;}_0x509dcf[_0x4c06cc(0xf99)](_0x2c235f=>{const _0xf831d8=_0x4c06cc,_0x4f6799=document['createElement'](_0xf831d8(0xaa5));_0x4f6799['style'][_0xf831d8(0x57a)]=_0xf831d8(0x1078),_0x4f6799[_0xf831d8(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>'+_0x2c235f[_0xf831d8(0x126e)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>'+_0x2c235f[_0xf831d8(0x2a3)]+_0xf831d8(0x1029)+(_0x2c235f[_0xf831d8(0x1309)]||0x0)[_0xf831d8(0x5c3)](0x2)+_0xf831d8(0x1065),_0x305a4f[_0xf831d8(0x998)](_0x4f6799);});}async function _0x82952(){const _0x430c04=_0x475790;if(!_0x579fa9)return;const _0x2f439c=_0x28f30a['chats'][_0x579fa9];if(!_0x2f439c)return;await _0x34d596(_0x430c04(0x13e4),_0x430c04(0x14a4)+_0x2f439c['name']+_0x430c04(0x674));const {proxyUrl:_0x18a0ed,apiKey:_0x32c0ca,model:_0x2e125e}=_0x28f30a[_0x430c04(0x1537)];if(!_0x18a0ed||!_0x32c0ca||!_0x2e125e){alert('请先在API设置中配置好API信息。');return;}const _0x3d9b9a=_0x28f30a[_0x430c04(0x1506)]['nickname']===_0x430c04(0x450)||!_0x28f30a[_0x430c04(0x1506)][_0x430c04(0x19a)]?'用户':_0x28f30a[_0x430c04(0x1506)][_0x430c04(0x19a)],_0x45e404=_0x2f439c[_0x430c04(0x153f)]&&_0x2f439c[_0x430c04(0x153f)][_0x430c04(0x9a1)]>0x0?_0x2f439c[_0x430c04(0x153f)]['map'](_0x5867bf=>_0x430c04(0x151a)+_0xf1c86d(_0x5867bf[_0x430c04(0x69a)])+')\x20'+_0x5867bf['content'])['join']('\x0a'):'无',_0x286a3c=_0x2f439c['settings'][_0x430c04(0xfcd)]||0xa,_0x392209=_0x2f439c[_0x430c04(0x12c3)][_0x430c04(0x225)](-_0x286a3c)[_0x430c04(0x11c6)](_0x381a57=>(_0x381a57[_0x430c04(0x9be)]===_0x430c04(0xcc9)?_0x3d9b9a:_0x2f439c[_0x430c04(0xe36)])+':\x20'+String(_0x381a57[_0x430c04(0x1047)])[_0x430c04(0xa6b)](0x0,0x1e)+_0x430c04(0x4e6))[_0x430c04(0xbad)]('\x0a'),_0x571684=(_0x2f439c[_0x430c04(0x362)][_0x430c04(0x684)]||[])['map'](_0x77e901=>_0x28f30a[_0x430c04(0x13b9)][_0x430c04(0x412)](_0x2d18c9=>_0x2d18c9['id']===_0x77e901))[_0x430c04(0xebc)](Boolean)[_0x430c04(0x11c6)](_0x55b8bb=>'\x0a##\x20世界书《'+_0x55b8bb[_0x430c04(0xe36)]+_0x430c04(0xdd9)+_0x55b8bb[_0x430c04(0x1047)][_0x430c04(0xebc)](_0x5ca798=>_0x5ca798[_0x430c04(0x400)])[_0x430c04(0x11c6)](_0x3dca9f=>'-\x20'+_0x3dca9f['content'])[_0x430c04(0xbad)]('\x0a'))[_0x430c04(0xbad)](''),_0xac54da=_0x5bdf0b(_0x2f439c,0x3,'hours'),_0x3b0725=_0x5bdf0b(_0x2f439c,0x6,_0x430c04(0xe03)),_0x34376f=_0x5bdf0b(_0x2f439c,0x9,_0x430c04(0xe03)),_0x1e6b3b=_0x5bdf0b(_0x2f439c,0x1,_0x430c04(0xb0b)),_0x5eea5c=_0x5bdf0b(_0x2f439c,0x3,'days'),_0x3025d0=_0x5bdf0b(_0x2f439c,0x7,_0x430c04(0xb0b));let _0x4925eb='';if(_0xac54da||_0x3b0725||_0x34376f||_0x1e6b3b||_0x5eea5c||_0x3025d0){_0x4925eb+=_0x430c04(0xba8);if(_0xac54da)_0x4925eb+=_0xac54da;if(_0x3b0725)_0x4925eb+=_0x3b0725;if(_0x34376f)_0x4925eb+=_0x34376f;if(_0xac54da||_0x3b0725||_0x34376f)_0x4925eb+='\x0a';if(_0x1e6b3b)_0x4925eb+=_0x1e6b3b;if(_0x5eea5c)_0x4925eb+=_0x5eea5c;if(_0x3025d0)_0x4925eb+=_0x3025d0;}const _0x477a18=_0x2f439c[_0x430c04(0x362)][_0x430c04(0x1528)]||_0x430c04(0x1541),_0x3efa6b=_0x430c04(0xf8f)+_0x2f439c[_0x430c04(0xe36)]+_0x430c04(0x107a)+_0x2f439c[_0x430c04(0x362)]['aiPersona']+'\x0a-\x20**\x20你的聊天对象（用户）的人设**:'+_0x477a18+_0x430c04(0x580)+_0x45e404+'\x0a'+_0x571684+'\x0a'+_0x4925eb+_0x430c04(0xa02)+_0x3d9b9a+_0x430c04(0x658)+_0x392209+_0x430c04(0xc45);try{const _0x331041=[{'role':_0x430c04(0xcc9),'content':_0x430c04(0x31f)}];let _0x4da042=_0x18a0ed[_0x430c04(0x138a)](_0x430c04(0xe9c)),_0x2713fc=_0x4fff3d(_0x2e125e,_0x32c0ca,_0x3efa6b,_0x331041);const _0x653739=_0x4da042?await fetch(_0x2713fc['url'],_0x2713fc[_0x430c04(0x1418)]):await fetch(_0x18a0ed+_0x430c04(0x1427),{'method':_0x430c04(0x655),'headers':{'Content-Type':_0x430c04(0x1446),'Authorization':_0x430c04(0xe83)+_0x32c0ca},'body':JSON['stringify']({'model':_0x2e125e,'messages':[{'role':_0x430c04(0x10a7),'content':_0x3efa6b},..._0x331041],'temperature':_0x28f30a['globalSettings'][_0x430c04(0x294)]||0.9})});if(!_0x653739['ok']){const _0x415e85=await _0x653739[_0x430c04(0x12a2)]()[_0x430c04(0xd6b)](()=>null),_0x43669a=_0x415e85?.[_0x430c04(0x1518)]?.['message']||_0x653739[_0x430c04(0x1066)];throw new Error(_0x430c04(0xe6d)+_0x653739[_0x430c04(0x2a3)]+'\x20-\x20'+_0x43669a);}const _0x484fe0=await _0x653739[_0x430c04(0x12a2)](),_0x297446=getGeminiResponseText(_0x484fe0),_0x3051e6=_0x297446['match'](/(\[[\s\S]*\])/);if(!_0x3051e6||!_0x3051e6[0x0])throw new Error(_0x430c04(0xf15)+_0x297446);const _0x5c4d1d=_0x3051e6[0x0];let _0x5a6315;try{_0x5a6315=JSON[_0x430c04(0xd91)](_0x5c4d1d);}catch(_0x143a54){throw new Error(_0x430c04(0x1044)+_0x143a54[_0x430c04(0x13bc)]+_0x430c04(0x441)+_0x297446);}if(!Array[_0x430c04(0x624)](_0x5a6315))throw new Error(_0x430c04(0x1c6)+JSON['stringify'](_0x5a6315));_0x2f439c[_0x430c04(0x406)]=_0x5a6315[_0x430c04(0x11c6)](_0x983fc=>({'id':Date[_0x430c04(0x487)]()+Math[_0x430c04(0x1337)](),'title':_0x983fc['title'],'content':_0x983fc[_0x430c04(0x1047)]})),await _0x5b9d83[_0x430c04(0x6ce)][_0x430c04(0x7c3)](_0x2f439c),await _0x11daa2();}catch(_0x57ebfa){console[_0x430c04(0x1518)]('生成模拟备忘录失败:',_0x57ebfa),await _0x34d596(_0x430c04(0x1ea),_0x430c04(0x9b2)+_0x57ebfa['message']);}}async function _0x3bdf10(){const _0x736ee2=_0x475790;if(!_0x579fa9)return;const _0xc6150a=_0x28f30a[_0x736ee2(0x6ce)][_0x579fa9];if(!_0xc6150a)return;await _0x34d596('请稍候...',_0x736ee2(0x443)+_0xc6150a[_0x736ee2(0xe36)]+_0x736ee2(0xe18));const {proxyUrl:_0x44fdf6,apiKey:_0x26576a,model:_0x94159}=_0x28f30a['apiConfig'];if(!_0x44fdf6||!_0x26576a||!_0x94159){alert(_0x736ee2(0x529));return;}const _0x1dc688=_0x28f30a[_0x736ee2(0x1506)]['nickname']===_0x736ee2(0x450)||!_0x28f30a['qzoneSettings'][_0x736ee2(0x19a)]?'用户':_0x28f30a[_0x736ee2(0x1506)][_0x736ee2(0x19a)],_0x3b8a26=_0xc6150a[_0x736ee2(0x153f)]&&_0xc6150a[_0x736ee2(0x153f)]['length']>0x0?_0xc6150a['longTermMemory']['map'](_0x192204=>_0x736ee2(0x151a)+_0xf1c86d(_0x192204[_0x736ee2(0x69a)])+')\x20'+_0x192204[_0x736ee2(0x1047)])[_0x736ee2(0xbad)]('\x0a'):'无',_0x3bb325=_0xc6150a[_0x736ee2(0x362)][_0x736ee2(0xfcd)]||0xa,_0x85350d=_0xc6150a['history'][_0x736ee2(0x225)](-_0x3bb325)[_0x736ee2(0x11c6)](_0x8f9a38=>(_0x8f9a38[_0x736ee2(0x9be)]===_0x736ee2(0xcc9)?_0x1dc688:_0xc6150a[_0x736ee2(0xe36)])+':\x20'+String(_0x8f9a38[_0x736ee2(0x1047)])[_0x736ee2(0xa6b)](0x0,0x1e)+_0x736ee2(0x4e6))[_0x736ee2(0xbad)]('\x0a'),_0x5927a5=(_0xc6150a['settings']['linkedWorldBookIds']||[])[_0x736ee2(0x11c6)](_0x1298b5=>_0x28f30a[_0x736ee2(0x13b9)][_0x736ee2(0x412)](_0x1b6022=>_0x1b6022['id']===_0x1298b5))[_0x736ee2(0xebc)](Boolean)[_0x736ee2(0x11c6)](_0x16a54f=>'\x0a##\x20世界书《'+_0x16a54f[_0x736ee2(0xe36)]+_0x736ee2(0xdd9)+_0x16a54f[_0x736ee2(0x1047)][_0x736ee2(0xebc)](_0x566422=>_0x566422[_0x736ee2(0x400)])[_0x736ee2(0x11c6)](_0x1036a4=>'-\x20'+_0x1036a4[_0x736ee2(0x1047)])[_0x736ee2(0xbad)]('\x0a'))[_0x736ee2(0xbad)](''),_0x205a28=_0x5bdf0b(_0xc6150a,0x3,_0x736ee2(0xe03)),_0xeeedf9=_0x5bdf0b(_0xc6150a,0x6,_0x736ee2(0xe03)),_0x16122d=_0x5bdf0b(_0xc6150a,0x9,'hours'),_0x1b5a46=_0x5bdf0b(_0xc6150a,0x1,_0x736ee2(0xb0b)),_0x5a2d73=_0x5bdf0b(_0xc6150a,0x3,'days'),_0x1172bb=_0x5bdf0b(_0xc6150a,0x7,_0x736ee2(0xb0b));let _0x2d2c84='';if(_0x205a28||_0xeeedf9||_0x16122d||_0x1b5a46||_0x5a2d73||_0x1172bb){_0x2d2c84+=_0x736ee2(0xba8);if(_0x205a28)_0x2d2c84+=_0x205a28;if(_0xeeedf9)_0x2d2c84+=_0xeeedf9;if(_0x16122d)_0x2d2c84+=_0x16122d;if(_0x205a28||_0xeeedf9||_0x16122d)_0x2d2c84+='\x0a';if(_0x1b5a46)_0x2d2c84+=_0x1b5a46;if(_0x5a2d73)_0x2d2c84+=_0x5a2d73;if(_0x1172bb)_0x2d2c84+=_0x1172bb;}const _0x5a9d0d=_0x736ee2(0xf8f)+_0xc6150a[_0x736ee2(0xe36)]+_0x736ee2(0x143e)+new Date()[_0x736ee2(0xaf8)]()+_0x736ee2(0xeec)+_0xc6150a[_0x736ee2(0x362)]['aiPersona']+'\x0a-\x20**你的长期记忆**:\x0a'+_0x3b8a26+'\x0a'+_0x5927a5+'\x0a'+_0x2d2c84+_0x736ee2(0xa02)+_0x1dc688+_0x736ee2(0x658)+_0x85350d+_0x736ee2(0x13c2);try{const _0x7ba903=[{'role':_0x736ee2(0xcc9),'content':'请根据你的设定，生成你的高德地图足迹。'}];let _0x5228a3=_0x44fdf6[_0x736ee2(0x138a)](_0x736ee2(0xe9c)),_0x174527=_0x4fff3d(_0x94159,_0x26576a,_0x5a9d0d,_0x7ba903);const _0x105d15=_0x5228a3?await fetch(_0x174527[_0x736ee2(0x6d1)],_0x174527['data']):await fetch(_0x44fdf6+'/v1/chat/completions',{'method':_0x736ee2(0x655),'headers':{'Content-Type':_0x736ee2(0x1446),'Authorization':_0x736ee2(0xe83)+_0x26576a},'body':JSON[_0x736ee2(0xe4d)]({'model':_0x94159,'messages':[{'role':_0x736ee2(0x10a7),'content':_0x5a9d0d},..._0x7ba903],'temperature':_0x28f30a[_0x736ee2(0x1062)][_0x736ee2(0x294)]||0.9})});if(!_0x105d15['ok'])throw new Error(_0x736ee2(0xe6d)+_0x105d15[_0x736ee2(0x1066)]);const _0x20d950=await _0x105d15['json'](),_0x202ee7=getGeminiResponseText(_0x20d950),_0x5c96c4=_0x202ee7[_0x736ee2(0x49a)](/(\[[\s\S]*\])/);if(!_0x5c96c4||!_0x5c96c4[0x0])throw new Error(_0x736ee2(0xf15)+_0x202ee7);const _0x52b50a=_0x5c96c4[0x0];let _0x35a695;try{_0x35a695=JSON[_0x736ee2(0xd91)](_0x52b50a);}catch(_0x3a6d99){throw new Error(_0x736ee2(0x1044)+_0x3a6d99[_0x736ee2(0x13bc)]+_0x736ee2(0x441)+_0x202ee7);}_0xc6150a[_0x736ee2(0x1015)]=_0x35a695,await _0x5b9d83[_0x736ee2(0x6ce)][_0x736ee2(0x7c3)](_0xc6150a),await _0x33198e();}catch(_0x37be38){console[_0x736ee2(0x1518)](_0x736ee2(0xeb8),_0x37be38),await _0x34d596(_0x736ee2(0x1ea),_0x736ee2(0xe74)+_0x37be38[_0x736ee2(0x13bc)]);}}function _0x33198e(){const _0x26afbf=_0x475790,_0x29c945=document['getElementById']('char-amap-list');_0x29c945[_0x26afbf(0xc43)]='';if(!_0x579fa9)return;const _0x5684c2=_0x28f30a[_0x26afbf(0x6ce)][_0x579fa9],_0x820066=_0x5684c2[_0x26afbf(0x1015)]||[];if(_0x820066[_0x26afbf(0x9a1)]===0x0){_0x29c945[_0x26afbf(0xc43)]=_0x26afbf(0x13a9);return;}_0x820066[_0x26afbf(0xf99)](_0x4f03f3=>{const _0x3c5fe8=_0x26afbf,_0x1b39ee=document[_0x3c5fe8(0x14ae)]('div');_0x1b39ee[_0x3c5fe8(0xdd1)]=_0x3c5fe8(0x976);let _0xe8b97b='';if(_0x4f03f3[_0x3c5fe8(0xe8f)]){const _0x50a104=_0x3c5fe8(0x6d0)+encodeURIComponent(_0x4f03f3['image_prompt']);_0xe8b97b=_0x3c5fe8(0x60a)+_0x50a104+_0x3c5fe8(0x7d2)+_0x4f03f3[_0x3c5fe8(0x70d)]+_0x3c5fe8(0x91d);}const _0x169150=_0x4f03f3[_0x3c5fe8(0x69a)]?_0xf1c86d(new Date(_0x4f03f3[_0x3c5fe8(0x69a)])[_0x3c5fe8(0x33c)]()):'某个时间';_0x1b39ee['innerHTML']=_0x3c5fe8(0xe38)+_0x4f03f3[_0x3c5fe8(0x14f5)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>'+_0x4f03f3[_0x3c5fe8(0x119c)]+_0x3c5fe8(0xb66)+_0x4f03f3[_0x3c5fe8(0x70d)][_0x3c5fe8(0x13ed)](/\n/g,'<br>')+_0x3c5fe8(0x9ad)+_0xe8b97b+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>'+_0x169150+_0x3c5fe8(0xefe),_0x29c945['appendChild'](_0x1b39ee);});}async function _0x4684f3(){const _0x4a891d=_0x475790;if(!_0x579fa9)return;const _0x1d0d21=_0x28f30a[_0x4a891d(0x6ce)][_0x579fa9];if(!_0x1d0d21)return;await _0x34d596(_0x4a891d(0x13e4),_0x4a891d(0x57d)+_0x1d0d21[_0x4a891d(0xe36)]+'”的手机使用习惯...');const {proxyUrl:_0x16b5b1,apiKey:_0x551bcf,model:_0xc09550}=_0x28f30a[_0x4a891d(0x1537)];if(!_0x16b5b1||!_0x551bcf||!_0xc09550){alert(_0x4a891d(0x529));return;}const _0x116796=_0x28f30a[_0x4a891d(0x1506)][_0x4a891d(0x19a)]==='{{user}}'||!_0x28f30a[_0x4a891d(0x1506)][_0x4a891d(0x19a)]?'用户':_0x28f30a['qzoneSettings'][_0x4a891d(0x19a)],_0x4ef9b6=_0x1d0d21[_0x4a891d(0x153f)]&&_0x1d0d21[_0x4a891d(0x153f)][_0x4a891d(0x9a1)]>0x0?_0x1d0d21[_0x4a891d(0x153f)][_0x4a891d(0x11c6)](_0x3bcb7f=>_0x4a891d(0x151a)+_0xf1c86d(_0x3bcb7f[_0x4a891d(0x69a)])+')\x20'+_0x3bcb7f[_0x4a891d(0x1047)])[_0x4a891d(0xbad)]('\x0a'):'无',_0x4b4c6d=_0x1d0d21['settings'][_0x4a891d(0xfcd)]||0xa,_0x3dbef7=_0x1d0d21[_0x4a891d(0x12c3)]['slice'](-_0x4b4c6d)['map'](_0x27d7cd=>(_0x27d7cd[_0x4a891d(0x9be)]==='user'?_0x116796:_0x1d0d21['name'])+':\x20'+String(_0x27d7cd['content'])[_0x4a891d(0xa6b)](0x0,0x1e)+'...')[_0x4a891d(0xbad)]('\x0a'),_0x2afdf3=(_0x1d0d21['settings'][_0x4a891d(0x684)]||[])['map'](_0x7b9b6a=>_0x28f30a[_0x4a891d(0x13b9)][_0x4a891d(0x412)](_0x3459b3=>_0x3459b3['id']===_0x7b9b6a))[_0x4a891d(0xebc)](Boolean)[_0x4a891d(0x11c6)](_0x463da4=>_0x4a891d(0x1097)+_0x463da4[_0x4a891d(0xe36)]+_0x4a891d(0xdd9)+_0x463da4[_0x4a891d(0x1047)][_0x4a891d(0xebc)](_0x216c8c=>_0x216c8c[_0x4a891d(0x400)])[_0x4a891d(0x11c6)](_0x27ca56=>'-\x20'+_0x27ca56[_0x4a891d(0x1047)])[_0x4a891d(0xbad)]('\x0a'))[_0x4a891d(0xbad)](''),_0x305bd5=_0x5bdf0b(_0x1d0d21,0x3,_0x4a891d(0xe03)),_0x49a2c7=_0x5bdf0b(_0x1d0d21,0x6,_0x4a891d(0xe03)),_0x3df6de=_0x5bdf0b(_0x1d0d21,0x9,_0x4a891d(0xe03)),_0x17825d=_0x5bdf0b(_0x1d0d21,0x1,_0x4a891d(0xb0b)),_0x3c8bc8=_0x5bdf0b(_0x1d0d21,0x3,_0x4a891d(0xb0b)),_0x323a60=_0x5bdf0b(_0x1d0d21,0x7,_0x4a891d(0xb0b));let _0x4a239a='';if(_0x305bd5||_0x49a2c7||_0x3df6de||_0x17825d||_0x3c8bc8||_0x323a60){_0x4a239a+=_0x4a891d(0xba8);if(_0x305bd5)_0x4a239a+=_0x305bd5;if(_0x49a2c7)_0x4a239a+=_0x49a2c7;if(_0x3df6de)_0x4a239a+=_0x3df6de;if(_0x305bd5||_0x49a2c7||_0x3df6de)_0x4a239a+='\x0a';if(_0x17825d)_0x4a239a+=_0x17825d;if(_0x3c8bc8)_0x4a239a+=_0x3c8bc8;if(_0x323a60)_0x4a239a+=_0x323a60;}const _0x46e286=_0x4a891d(0xf8f)+_0x1d0d21['name']+_0x4a891d(0x2f5)+_0x1d0d21[_0x4a891d(0x362)]['aiPersona']+'\x0a-\x20**你的长期记忆**:\x0a'+_0x4ef9b6+'\x0a'+_0x2afdf3+'\x0a'+_0x4a239a+_0x4a891d(0xa02)+_0x116796+_0x4a891d(0x658)+_0x3dbef7+_0x4a891d(0x662);try{const _0x176805=[{'role':_0x4a891d(0xcc9),'content':_0x4a891d(0xdb1)}];let _0x2c68a4=_0x16b5b1[_0x4a891d(0x138a)]('generativelanguage'),_0x15e810=_0x4fff3d(_0xc09550,_0x551bcf,_0x46e286,_0x176805);const _0x3e27ab=_0x2c68a4?await fetch(_0x15e810[_0x4a891d(0x6d1)],_0x15e810[_0x4a891d(0x1418)]):await fetch(_0x16b5b1+_0x4a891d(0x1427),{'method':_0x4a891d(0x655),'headers':{'Content-Type':_0x4a891d(0x1446),'Authorization':_0x4a891d(0xe83)+_0x551bcf},'body':JSON[_0x4a891d(0xe4d)]({'model':_0xc09550,'messages':[{'role':_0x4a891d(0x10a7),'content':_0x46e286},..._0x176805],'temperature':_0x28f30a['globalSettings'][_0x4a891d(0x294)]||0.9})});if(!_0x3e27ab['ok'])throw new Error(_0x4a891d(0xe6d)+_0x3e27ab[_0x4a891d(0x1066)]);const _0x28a3b1=await _0x3e27ab['json'](),_0x9f1367=getGeminiResponseText(_0x28a3b1),_0x1c3393=_0x9f1367['replace'](/^```json\s*/,'')[_0x4a891d(0x13ed)](/```$/,''),_0x5638d9=JSON[_0x4a891d(0xd91)](_0x1c3393);_0x1d0d21[_0x4a891d(0x4d4)]=_0x5638d9,await _0x5b9d83['chats'][_0x4a891d(0x7c3)](_0x1d0d21),await _0x25a30a();}catch(_0x1d0903){console['error'](_0x4a891d(0x951),_0x1d0903),await _0x34d596(_0x4a891d(0x1ea),'无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x1d0903[_0x4a891d(0x13bc)]);}}function _0x25a30a(){const _0x15c7c1=_0x475790,_0x1de907=document['getElementById'](_0x15c7c1(0x153d));_0x1de907[_0x15c7c1(0xc43)]='';if(!_0x579fa9)return;const _0x14fdc6=_0x28f30a[_0x15c7c1(0x6ce)][_0x579fa9],_0x433cc4=(_0x14fdc6[_0x15c7c1(0x4d4)]||[])['sort']((_0x40ee4c,_0x4f3c99)=>_0x4f3c99[_0x15c7c1(0x1064)]-_0x40ee4c['usageTimeMinutes']);if(_0x433cc4[_0x15c7c1(0x9a1)]===0x0){_0x1de907[_0x15c7c1(0xc43)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>';return;}_0x433cc4[_0x15c7c1(0xf99)](_0x58542d=>{const _0x18311d=_0x15c7c1,_0x371636=document[_0x18311d(0x14ae)]('div');_0x371636[_0x18311d(0xdd1)]='char-usage-item';const _0x28f8a2=Math[_0x18311d(0x5f8)](_0x58542d[_0x18311d(0x1064)]/0x3c),_0x1f0f8b=_0x58542d[_0x18311d(0x1064)]%0x3c;let _0x47992d='';if(_0x28f8a2>0x0)_0x47992d+=_0x28f8a2+'小时';if(_0x1f0f8b>0x0)_0x47992d+=_0x1f0f8b+'分钟';if(!_0x47992d)_0x47992d=_0x18311d(0x58d);const _0x4b90a1=_0x58542d['image_prompt']||_0x18311d(0x10f1)+_0x58542d[_0x18311d(0xff4)]+_0x18311d(0x546),_0xfcdade=_0x18311d(0x6d0)+encodeURIComponent(_0x4b90a1);_0x371636[_0x18311d(0xc43)]=_0x18311d(0xdbe)+_0xfcdade+_0x18311d(0xdb0)+_0x58542d['appName']+_0x18311d(0xa65)+_0x58542d['category']+_0x18311d(0x13ac)+_0x47992d+_0x18311d(0xefe),_0x1de907[_0x18311d(0x998)](_0x371636);});}async function _0x25074b(){const _0x2be775=_0x475790;if(!_0x579fa9)return;const _0x15b750=_0x28f30a['chats'][_0x579fa9];if(!_0x15b750)return;await _0x34d596(_0x2be775(0x13e4),_0x2be775(0x14a4)+_0x15b750['name']+'”分享TA的私人歌单...');const {proxyUrl:_0x54de17,apiKey:_0x1747d0,model:_0x450620}=_0x28f30a['apiConfig'];if(!_0x54de17||!_0x1747d0||!_0x450620){alert(_0x2be775(0x61d));return;}const _0x52a0b2=_0x28f30a[_0x2be775(0x1506)]['nickname']===_0x2be775(0x450)||!_0x28f30a['qzoneSettings'][_0x2be775(0x19a)]?'用户':_0x28f30a[_0x2be775(0x1506)][_0x2be775(0x19a)],_0x58cd3a=_0x15b750[_0x2be775(0x153f)]&&_0x15b750['longTermMemory'][_0x2be775(0x9a1)]>0x0?_0x15b750[_0x2be775(0x153f)][_0x2be775(0x11c6)](_0x3e412a=>'-\x20(记录于\x20'+_0xf1c86d(_0x3e412a['timestamp'])+')\x20'+_0x3e412a[_0x2be775(0x1047)])[_0x2be775(0xbad)]('\x0a'):'无',_0x567fd5=_0x15b750[_0x2be775(0x362)][_0x2be775(0xfcd)]||0xa,_0x77ae24=_0x15b750[_0x2be775(0x12c3)]['slice'](-_0x567fd5)['map'](_0x46ce73=>(_0x46ce73[_0x2be775(0x9be)]==='user'?_0x52a0b2:_0x15b750[_0x2be775(0xe36)])+':\x20'+String(_0x46ce73[_0x2be775(0x1047)])['substring'](0x0,0x1e)+_0x2be775(0x4e6))[_0x2be775(0xbad)]('\x0a'),_0x882986=(_0x15b750['settings']['linkedWorldBookIds']||[])[_0x2be775(0x11c6)](_0x3fff91=>_0x28f30a['worldBooks'][_0x2be775(0x412)](_0x5a542b=>_0x5a542b['id']===_0x3fff91))[_0x2be775(0xebc)](Boolean)['map'](_0xdebf34=>'\x0a##\x20世界书《'+_0xdebf34[_0x2be775(0xe36)]+'》设定:\x0a'+_0xdebf34[_0x2be775(0x1047)][_0x2be775(0xebc)](_0xc67378=>_0xc67378[_0x2be775(0x400)])[_0x2be775(0x11c6)](_0x377515=>'-\x20'+_0x377515['content'])[_0x2be775(0xbad)]('\x0a'))[_0x2be775(0xbad)](''),_0x29f6ac=_0x2be775(0x110d)+_0x15b750[_0x2be775(0xe36)]+_0x2be775(0x18c)+_0x15b750[_0x2be775(0x362)][_0x2be775(0x67c)]+_0x2be775(0x580)+_0x58cd3a+'\x0a'+_0x882986+_0x2be775(0xa02)+_0x52a0b2+'”的对话摘要**:\x0a'+_0x77ae24+_0x2be775(0xbcc);try{const _0x5ae2d6=[{'role':_0x2be775(0xcc9),'content':_0x2be775(0x9ff)}];let _0x4727e1=_0x54de17['includes'](_0x2be775(0xe9c)),_0x4ec70a=_0x4fff3d(_0x450620,_0x1747d0,_0x29f6ac,_0x5ae2d6);const _0x3f534e=_0x4727e1?await fetch(_0x4ec70a[_0x2be775(0x6d1)],_0x4ec70a[_0x2be775(0x1418)]):await fetch(_0x54de17+_0x2be775(0x1427),{'method':_0x2be775(0x655),'headers':{'Content-Type':_0x2be775(0x1446),'Authorization':_0x2be775(0xe83)+_0x1747d0},'body':JSON[_0x2be775(0xe4d)]({'model':_0x450620,'messages':[{'role':_0x2be775(0x10a7),'content':_0x29f6ac},..._0x5ae2d6],'temperature':_0x28f30a[_0x2be775(0x1062)]['apiTemperature']||0x1})});if(!_0x3f534e['ok'])throw new Error(_0x2be775(0xe6d)+_0x3f534e[_0x2be775(0x1066)]);const _0x2dbd32=await _0x3f534e['json'](),_0x23aa81=getGeminiResponseText(_0x2dbd32),_0x3469e2=_0x23aa81['replace'](/^```json\s*/,'')[_0x2be775(0x13ed)](/```$/,''),_0x39f9d5=JSON['parse'](_0x3469e2);await _0x34d596(_0x2be775(0x13e4),_0x2be775(0x571)+_0x39f9d5[_0x2be775(0x9a1)]+_0x2be775(0xdfb));const _0x275da2=_0x39f9d5[_0x2be775(0x11c6)](async _0xf5ec9=>{const _0xee10cf=_0x2be775;let _0x1d4f31=await _0x3d5a59(_0xf5ec9[_0xee10cf(0x12f3)],_0xf5ec9[_0xee10cf(0x2b9)]);(!_0x1d4f31||_0x1d4f31[_0xee10cf(0x9a1)]===0x0)&&(_0x1d4f31=await _0x42b76d(_0xf5ec9[_0xee10cf(0x12f3)]));if(_0x1d4f31[_0xee10cf(0x9a1)]>0x0)return _0x4376e7(_0x1d4f31[0x0]);return console[_0xee10cf(0x664)](_0xee10cf(0xd87)+_0xf5ec9['songName']+'\x20-\x20'+_0xf5ec9[_0xee10cf(0x2b9)]+'”'),null;}),_0x340e4b=(await Promise[_0x2be775(0xa92)](_0x275da2))[_0x2be775(0xebc)](Boolean);_0x15b750[_0x2be775(0xdab)]=_0x340e4b,await _0x5b9d83[_0x2be775(0x6ce)][_0x2be775(0x7c3)](_0x15b750),await _0x323b30();}catch(_0x22f5c5){console[_0x2be775(0x1518)](_0x2be775(0x3d1),_0x22f5c5),await _0x34d596(_0x2be775(0x1ea),_0x2be775(0x10dd)+_0x22f5c5[_0x2be775(0x13bc)]);}}function _0x323b30(){const _0xde7506=_0x475790,_0x5df3c8=document[_0xde7506(0x2ec)](_0xde7506(0x451));_0x5df3c8[_0xde7506(0xc43)]='';if(!_0x579fa9)return;const _0x4ea193=_0x28f30a[_0xde7506(0x6ce)][_0x579fa9],_0x35af1a=_0x4ea193['simulatedMusicPlaylist']||[];if(_0x35af1a[_0xde7506(0x9a1)]===0x0){_0x5df3c8[_0xde7506(0xc43)]=_0xde7506(0x13c8);return;}_0x35af1a['forEach']((_0x3dd15f,_0x5ae0ea)=>{const _0x1a575b=_0xde7506,_0x222f08=document[_0x1a575b(0x14ae)](_0x1a575b(0xaa5));_0x222f08[_0x1a575b(0xdd1)]='char-music-item',_0x222f08['innerHTML']=_0x1a575b(0x152a)+_0x3dd15f[_0x1a575b(0x12df)]+_0x1a575b(0x928)+_0x3dd15f['name']+_0x1a575b(0x6e0)+_0x3dd15f[_0x1a575b(0x139f)]+_0x1a575b(0x62c),_0x222f08[_0x1a575b(0xf79)]('click',()=>_0x8a00d5(_0x3dd15f)),_0x5df3c8['appendChild'](_0x222f08);});}let _0x5aaeb2={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':_0x475790(0xe7e),'lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0x8a00d5(_0x505254){const _0x360e2b=_0x475790,_0x320f1c=document[_0x360e2b(0x2ec)](_0x360e2b(0x2f3)),_0x54b32a=document[_0x360e2b(0x2ec)](_0x360e2b(0x49f));if(_0x5aaeb2[_0x360e2b(0x4f5)])clearInterval(_0x5aaeb2[_0x360e2b(0x4f5)]);_0x320f1c[_0x360e2b(0x964)]();const _0xff84f6=_0x5aaeb2[_0x360e2b(0x1080)][_0x360e2b(0x535)](_0x4ee302=>_0x4ee302[_0x360e2b(0xce4)]===_0x505254['src']);_0xff84f6>-0x1?_0x5aaeb2[_0x360e2b(0xf35)]=_0xff84f6:(_0x5aaeb2[_0x360e2b(0x1080)]=[_0x505254],_0x5aaeb2[_0x360e2b(0xf35)]=0x0);document[_0x360e2b(0x2ec)](_0x360e2b(0x781))[_0x360e2b(0x15f)]=_0x505254[_0x360e2b(0xe36)],document[_0x360e2b(0x2ec)](_0x360e2b(0xa09))[_0x360e2b(0x15f)]=_0x505254[_0x360e2b(0x139f)],document[_0x360e2b(0x2ec)]('char-music-cover')[_0x360e2b(0xce4)]=_0x505254[_0x360e2b(0x12df)],_0x5aaeb2['parsedLyrics']=_0x59e6cd(_0x505254['lrcContent']||''),_0x327998();if(_0x505254['isLocal']){const _0x1e2141=new Blob([_0x505254['src']],{'type':_0x505254[_0x360e2b(0x11bd)]||_0x360e2b(0x6ef)});_0x320f1c[_0x360e2b(0xce4)]=URL[_0x360e2b(0x23d)](_0x1e2141);}else _0x320f1c[_0x360e2b(0xce4)]=_0x505254['src'];_0x320f1c['play']()[_0x360e2b(0xd6b)](_0x2eded2=>console['error'](_0x360e2b(0x37b),_0x2eded2)),_0x320f1c[_0x360e2b(0xdca)]=()=>{const _0x2184d6=_0x360e2b;document[_0x2184d6(0x2ec)](_0x2184d6(0x8d9))[_0x2184d6(0x15f)]=_0x437f71(_0x320f1c[_0x2184d6(0x157d)]),_0x5aaeb2[_0x2184d6(0x4f5)]=setInterval(_0x579d8a,0x1f4);},_0x54b32a[_0x360e2b(0xff6)][_0x360e2b(0xe82)](_0x360e2b(0x149d));}function _0x1cafbb(){const _0x4fefec=_0x475790,_0x52226a=document[_0x4fefec(0x2ec)]('char-music-player-modal'),_0xfcc72f=document['getElementById'](_0x4fefec(0x2f3));if(_0x5aaeb2[_0x4fefec(0x4f5)])clearInterval(_0x5aaeb2[_0x4fefec(0x4f5)]);_0xfcc72f['pause'](),_0xfcc72f[_0x4fefec(0xce4)]='',_0x52226a[_0x4fefec(0xff6)]['remove'](_0x4fefec(0x149d)),_0x5aaeb2['isPlaying']=![],document[_0x4fefec(0x2ec)](_0x4fefec(0x301))[_0x4fefec(0xff6)][_0x4fefec(0x1424)](_0x4fefec(0xb32));}function _0x579d8a(){const _0x153f1b=_0x475790,_0x343ab2=document['getElementById'](_0x153f1b(0x2f3));if(!_0x343ab2['duration'])return;const _0x28975c=_0x343ab2[_0x153f1b(0x3e5)],_0xdbf882=_0x343ab2[_0x153f1b(0x157d)];document['getElementById'](_0x153f1b(0x1120))[_0x153f1b(0x589)][_0x153f1b(0xeb4)]=_0x28975c/_0xdbf882*0x64+'%',document[_0x153f1b(0x2ec)](_0x153f1b(0x1348))[_0x153f1b(0x15f)]=_0x437f71(_0x28975c),_0x3e23ff(_0x28975c);}function _0x327998(){const _0x345a4e=_0x475790,_0x4dbff4=document['getElementById'](_0x345a4e(0x2e3));_0x4dbff4[_0x345a4e(0xc43)]='',_0x5aaeb2[_0x345a4e(0xdf5)]=-0x1;if(!_0x5aaeb2[_0x345a4e(0x9c4)]||_0x5aaeb2[_0x345a4e(0x9c4)][_0x345a4e(0x9a1)]===0x0){_0x4dbff4[_0x345a4e(0xc43)]=_0x345a4e(0x12db);return;}_0x5aaeb2['parsedLyrics'][_0x345a4e(0xf99)]((_0x46d41c,_0x534498)=>{const _0x25f8c4=_0x345a4e,_0x11d129=document[_0x25f8c4(0x14ae)]('p');_0x11d129[_0x25f8c4(0x15f)]=_0x46d41c['text'],_0x11d129[_0x25f8c4(0xe93)][_0x25f8c4(0x8d1)]=_0x534498,_0x4dbff4['appendChild'](_0x11d129);});}function _0x3e23ff(_0x588e2d){const _0x482009=_0x475790,_0x59a906=_0x5aaeb2[_0x482009(0x9c4)];if(_0x59a906[_0x482009(0x9a1)]===0x0)return;let _0x174a7e=-0x1;for(let _0x3d2185=0x0;_0x3d2185<_0x59a906[_0x482009(0x9a1)];_0x3d2185++){if(_0x588e2d>=_0x59a906[_0x3d2185][_0x482009(0x343)])_0x174a7e=_0x3d2185;else break;}if(_0x174a7e===_0x5aaeb2[_0x482009(0xdf5)])return;_0x5aaeb2[_0x482009(0xdf5)]=_0x174a7e;const _0x207036=document[_0x482009(0x2ec)](_0x482009(0x2e3)),_0x3153a4=_0x207036[_0x482009(0x5d6)]('p');_0x3153a4[_0x482009(0xf99)](_0x2f59bd=>_0x2f59bd['classList'][_0x482009(0x1424)]('active'));if(_0x174a7e>-0x1){const _0x19d6a7=_0x207036[_0x482009(0x765)]('p[data-index=\x22'+_0x174a7e+'\x22]');if(_0x19d6a7){_0x19d6a7[_0x482009(0xff6)][_0x482009(0xe82)](_0x482009(0xd43));const _0x278585=_0x207036[_0x482009(0x1512)]/0x2-_0x19d6a7['offsetTop']-_0x19d6a7[_0x482009(0x361)]/0x2;_0x3153a4['forEach'](_0x1e04ce=>{const _0x1f350b=_0x482009;_0x1e04ce['style']['transform']=_0x1f350b(0x8b7)+_0x278585+_0x1f350b(0xc5e);});}}}function _0x58cc37(){const _0x4ebb0f=_0x475790;if(_0x5aaeb2[_0x4ebb0f(0x1080)][_0x4ebb0f(0x9a1)]===0x0)return;let _0x3f529e;switch(_0x5aaeb2[_0x4ebb0f(0x1026)]){case'random':_0x3f529e=Math[_0x4ebb0f(0x5f8)](Math[_0x4ebb0f(0x1337)]()*_0x5aaeb2['currentPlaylist'][_0x4ebb0f(0x9a1)]);break;case'single':_0x8a00d5(_0x5aaeb2[_0x4ebb0f(0x1080)][_0x5aaeb2[_0x4ebb0f(0xf35)]]);return;case _0x4ebb0f(0xe7e):default:_0x3f529e=(_0x5aaeb2['currentIndex']+0x1)%_0x5aaeb2[_0x4ebb0f(0x1080)][_0x4ebb0f(0x9a1)];break;}_0x8a00d5(_0x5aaeb2['currentPlaylist'][_0x3f529e]);}function _0x8b3a5(){const _0x228171=_0x475790;if(_0x5aaeb2[_0x228171(0x1080)]['length']===0x0)return;const _0x76d514=(_0x5aaeb2[_0x228171(0xf35)]-0x1+_0x5aaeb2['currentPlaylist'][_0x228171(0x9a1)])%_0x5aaeb2['currentPlaylist'][_0x228171(0x9a1)];_0x8a00d5(_0x5aaeb2['currentPlaylist'][_0x76d514]);}function _0x2323de(){const _0x2de17c=_0x475790,_0x2812f9=['order','random',_0x2de17c(0x1033)],_0x295d4c=_0x2812f9[_0x2de17c(0x6d3)](_0x5aaeb2['playMode']);_0x5aaeb2[_0x2de17c(0x1026)]=_0x2812f9[(_0x295d4c+0x1)%_0x2812f9[_0x2de17c(0x9a1)]],document['getElementById'](_0x2de17c(0x697))[_0x2de17c(0x15f)]={'order':'顺序','random':'随机','single':'单曲'}[_0x5aaeb2[_0x2de17c(0x1026)]];}function _0x8f3176(){const _0x1e9870=_0x475790,_0x519b47=document[_0x1e9870(0x2ec)]('char-audio-player'),_0x36e8f5=document[_0x1e9870(0x2ec)](_0x1e9870(0x8fc)),_0x1814f3=document[_0x1e9870(0x2ec)](_0x1e9870(0x301));_0x36e8f5['addEventListener'](_0x1e9870(0x1177),()=>{const _0x52f492=_0x1e9870;if(_0x519b47[_0x52f492(0x1368)]){if(_0x5aaeb2[_0x52f492(0xf35)]>-0x1)_0x519b47['play']();}else _0x519b47[_0x52f492(0x964)]();}),_0x519b47[_0x1e9870(0x7e1)]=()=>{const _0x5bc816=_0x1e9870;_0x36e8f5['innerHTML']='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>',_0x1814f3[_0x5bc816(0xff6)]['add'](_0x5bc816(0xb32)),_0x5aaeb2['isPlaying']=!![];},_0x519b47[_0x1e9870(0xea3)]=()=>{const _0x572819=_0x1e9870;_0x36e8f5[_0x572819(0xc43)]=_0x572819(0x1119),_0x1814f3[_0x572819(0xff6)][_0x572819(0x1424)](_0x572819(0xb32)),_0x5aaeb2[_0x572819(0x25e)]=![];},_0x519b47[_0x1e9870(0x77c)]=()=>{const _0x3383ec=_0x1e9870;_0x1814f3['classList'][_0x3383ec(0x1424)]('spinning'),_0x5aaeb2[_0x3383ec(0x25e)]=![],_0x58cc37();},document['getElementById'](_0x1e9870(0x63f))[_0x1e9870(0xf79)](_0x1e9870(0x1177),_0x8b3a5),document['getElementById'](_0x1e9870(0x124b))['addEventListener'](_0x1e9870(0x1177),_0x58cc37),document[_0x1e9870(0x2ec)]('char-music-mode-btn')[_0x1e9870(0xf79)](_0x1e9870(0x1177),_0x2323de),document[_0x1e9870(0x2ec)](_0x1e9870(0xa91))[_0x1e9870(0xf79)](_0x1e9870(0x1177),_0x20f916=>{const _0x4fdd14=_0x1e9870;if(!_0x519b47['duration'])return;const _0x413495=_0x20f916[_0x4fdd14(0x396)],_0x1be650=_0x20f916[_0x4fdd14(0x8fa)];_0x519b47['currentTime']=_0x1be650/_0x413495[_0x4fdd14(0xadd)]*_0x519b47[_0x4fdd14(0x157d)];});}async function _0x37ff8e(){const _0x4f6cdb=_0x475790,_0x70b9d3=document[_0x4f6cdb(0x2ec)](_0x4f6cdb(0x3be));_0x70b9d3[_0x4f6cdb(0xc43)]='';const _0x103080=await _0x5b9d83[_0x4f6cdb(0x3d9)][_0x4f6cdb(0x106d)](_0x4f6cdb(0x69a))[_0x4f6cdb(0x6c9)]()[_0x4f6cdb(0x14b5)]();if(_0x103080[_0x4f6cdb(0x9a1)]===0x0){_0x70b9d3[_0x4f6cdb(0xc43)]=_0x4f6cdb(0x562);return;}_0x103080[_0x4f6cdb(0xf99)](_0x46cb00=>{const _0x39c99b=_0x4f6cdb;let _0xf0c272;const _0x351e7f=_0x46cb00[_0x39c99b(0xb6a)]?Object[_0x39c99b(0x74e)](_0x28f30a[_0x39c99b(0x6ce)])[_0x39c99b(0x412)](_0x2d1c51=>!_0x2d1c51[_0x39c99b(0x1423)]&&_0x2d1c51[_0x39c99b(0xe36)]===_0x46cb00[_0x39c99b(0xb6a)]):null;if(_0x351e7f)_0xf0c272=_0x351e7f[_0x39c99b(0x362)][_0x39c99b(0xe91)];else{const _0x254c4e=Object[_0x39c99b(0x74e)](_0x28f30a[_0x39c99b(0x6ce)])['find'](_0x1bcab7=>!_0x1bcab7[_0x39c99b(0x1423)]&&_0x1bcab7['name']===_0x46cb00[_0x39c99b(0xa5d)]);if(_0x254c4e)_0xf0c272=_0x254c4e['settings'][_0x39c99b(0xe91)];else _0x46cb00[_0x39c99b(0xa13)]?_0xf0c272=_0x39c99b(0x6d0)+encodeURIComponent(_0x46cb00[_0x39c99b(0xa13)]):_0xf0c272=_0x825cf1;}const _0x21287b=document[_0x39c99b(0x14ae)](_0x39c99b(0xaa5));_0x21287b['className']=_0x39c99b(0x1069),_0x21287b[_0x39c99b(0x6b6)]=()=>_0x18ed0e(_0x46cb00['id']),_0x21287b[_0x39c99b(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0xf0c272+_0x39c99b(0x14fe)+_0x46cb00[_0x39c99b(0xa5d)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20'+_0x46cb00[_0x39c99b(0x137e)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>'+_0x46cb00[_0x39c99b(0x1041)]+_0x39c99b(0x19d)+_0x46cb00[_0x39c99b(0x1047)][_0x39c99b(0x13ed)](/\n/g,'<br>')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20'+_0x46cb00[_0x39c99b(0x27b)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20'+_0x46cb00[_0x39c99b(0x1027)]+_0x39c99b(0x9f8)+_0xf1c86d(_0x46cb00[_0x39c99b(0x69a)])+_0x39c99b(0x549),_0x70b9d3[_0x39c99b(0x998)](_0x21287b);});}async function _0x266ab4(){const _0x23e5de=_0x475790,_0x105b3b=_0x28f30a[_0x23e5de(0x1062)][_0x23e5de(0x102e)]||[];if(_0x105b3b['length']===0x0){await _0x34d596(_0x23e5de(0x120f),_0x23e5de(0x96e));return;}await _0x34d596(_0x23e5de(0x13e4),_0x23e5de(0x749)+_0x105b3b[_0x23e5de(0x9a1)]+_0x23e5de(0x1cd));const {proxyUrl:_0x13d068,apiKey:_0x1aced1,model:_0x2d0a0f}=_0x28f30a[_0x23e5de(0x1537)];if(!_0x13d068||!_0x1aced1||!_0x2d0a0f){alert(_0x23e5de(0x61d));return;}const _0x2f7d0c=new Set();_0x105b3b[_0x23e5de(0xf99)](_0x1e58e7=>{const _0x1bece4=_0x23e5de,_0x49f51d=_0x28f30a[_0x1bece4(0x6ce)][_0x1e58e7];_0x49f51d&&_0x49f51d['settings'][_0x1bece4(0x684)]&&_0x49f51d['settings']['linkedWorldBookIds'][_0x1bece4(0xf99)](_0xde92ff=>_0x2f7d0c[_0x1bece4(0xe82)](_0xde92ff));});let _0x3a56e2='';_0x2f7d0c[_0x23e5de(0x2d2)]>0x0&&(_0x3a56e2+=_0x23e5de(0xa35),_0x2f7d0c[_0x23e5de(0xf99)](_0xbe07de=>{const _0x31f955=_0x23e5de,_0x32695f=_0x28f30a[_0x31f955(0x13b9)][_0x31f955(0x412)](_0x3a5050=>_0x3a5050['id']===_0xbe07de);if(_0x32695f){const _0x5d039a=_0x32695f['content'][_0x31f955(0xebc)](_0x3553c3=>_0x3553c3['enabled']!==![])['map'](_0x27be37=>'-\x20'+_0x27be37['content'])[_0x31f955(0xbad)]('\x0a');_0x5d039a&&(_0x3a56e2+=_0x31f955(0x148a)+_0x32695f[_0x31f955(0xe36)]+_0x31f955(0xc35)+_0x5d039a);}}));const _0x24bc6d=_0x28f30a[_0x23e5de(0x13b9)][_0x23e5de(0x412)](_0x5dfc28=>_0x5dfc28[_0x23e5de(0xe36)]==='豆瓣设定');let _0x22001d='',_0x301017=[];_0x24bc6d&&_0x24bc6d[_0x23e5de(0x1047)][_0x23e5de(0xf99)](_0x2f3aaa=>{const _0x52620f=_0x23e5de;_0x2f3aaa[_0x52620f(0x70d)]['includes']('小组风格')&&(_0x22001d+='\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a'+_0x2f3aaa['content']);if(_0x2f3aaa[_0x52620f(0x70d)][_0x52620f(0x138a)](_0x52620f(0x9d2))){const _0x32ff9e=_0x2f3aaa['content'][_0x52620f(0xa8a)]('\x0a');_0x32ff9e[_0x52620f(0xf99)](_0x35ec62=>{const _0x51af69=_0x52620f,_0x5cd50f=_0x35ec62['match'](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x5cd50f&&_0x301017[_0x51af69(0x367)]({'name':_0x5cd50f[0x1][_0x51af69(0x97e)](),'persona':_0x5cd50f[0x2][_0x51af69(0x97e)]()});});}});const _0x46cfeb=_0x28f30a['qzoneSettings']['nickname']||'我',_0x592c12=_0x105b3b[_0x23e5de(0x9a1)]>0x0&&_0x28f30a[_0x23e5de(0x6ce)][_0x105b3b[0x0]]?_0x28f30a[_0x23e5de(0x6ce)][_0x105b3b[0x0]][_0x23e5de(0x362)][_0x23e5de(0x1528)]:_0x23e5de(0x1541);let _0xd70897='';_0x105b3b['forEach'](_0x32cf46=>{const _0x9f76b5=_0x23e5de,_0x19fb04=_0x28f30a[_0x9f76b5(0x6ce)][_0x32cf46];if(_0x19fb04){const _0x2e60b9=_0x19fb04['longTermMemory']&&_0x19fb04[_0x9f76b5(0x153f)][_0x9f76b5(0x9a1)]>0x0?_0x19fb04[_0x9f76b5(0x153f)][_0x9f76b5(0x11c6)](_0x3f0d83=>_0x3f0d83[_0x9f76b5(0x1047)])[_0x9f76b5(0xbad)](';\x20'):'无',_0x30891c=_0x19fb04[_0x9f76b5(0x12c3)][_0x9f76b5(0x225)](-0xa)[_0x9f76b5(0x11c6)](_0x11ceef=>(_0x11ceef[_0x9f76b5(0x9be)]===_0x9f76b5(0xcc9)?_0x46cfeb:_0x19fb04[_0x9f76b5(0xe36)])+':\x20'+String(_0x11ceef['content'])['substring'](0x0,0x1e)+_0x9f76b5(0x4e6))[_0x9f76b5(0xbad)]('\x0a');_0xd70897+='\x0a<character>\x0a\x20\x20<name>'+_0x19fb04['name']+_0x9f76b5(0xa29)+_0x19fb04[_0x9f76b5(0x362)][_0x9f76b5(0x67c)]+_0x9f76b5(0x127c)+_0x2e60b9+_0x9f76b5(0x9fc)+_0x30891c+'</recent_dialogue_with_user>\x0a</character>\x0a';}}),_0x301017[_0x23e5de(0xf99)](_0x152690=>{const _0x20dc60=_0x23e5de;_0xd70897+=_0x20dc60(0x984)+_0x152690[_0x20dc60(0xe36)]+_0x20dc60(0xa29)+_0x152690[_0x20dc60(0xe32)]+_0x20dc60(0x1277);});const _0x513acf=new Date(),_0x475dea=_0x513acf['toLocaleString']('zh-CN',{'dateStyle':_0x23e5de(0x1124),'timeStyle':'short'}),_0x22e79a=_0x28f30a[_0x23e5de(0x1062)]['doubanMinPosts']||0xc,_0x398fde=_0x28f30a[_0x23e5de(0x1062)][_0x23e5de(0x170)]||0x14,_0x1036d6='\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【'+_0x22e79a+'到'+_0x398fde+_0x23e5de(0x136e)+_0x475dea+_0x23e5de(0xb28)+_0x46cfeb+_0x23e5de(0xa5a)+_0x46cfeb+_0x23e5de(0xdf7)+_0x22001d+'\x0a'+_0x3a56e2+_0x23e5de(0xd33)+_0x475dea+_0x23e5de(0x1206)+_0x46cfeb+'\x0a-\x20**人设**:\x20'+_0x592c12+_0x23e5de(0x10e3)+_0xd70897+_0x23e5de(0x307);try{const _0x284712=[{'role':_0x23e5de(0xcc9),'content':_0x23e5de(0x1017)}];let _0x136538=_0x13d068[_0x23e5de(0x138a)](_0x23e5de(0xe9c)),_0x3c1a6b=_0x4fff3d(_0x2d0a0f,_0x1aced1,_0x1036d6,_0x284712);const _0x3f1c86=_0x136538?await fetch(_0x3c1a6b['url'],_0x3c1a6b['data']):await fetch(_0x13d068+_0x23e5de(0x1427),{'method':_0x23e5de(0x655),'headers':{'Content-Type':'application/json','Authorization':_0x23e5de(0xe83)+_0x1aced1},'body':JSON[_0x23e5de(0xe4d)]({'model':_0x2d0a0f,'messages':[{'role':_0x23e5de(0x10a7),'content':_0x1036d6},..._0x284712],'temperature':_0x28f30a[_0x23e5de(0x1062)][_0x23e5de(0x294)]||0x1})});if(!_0x3f1c86['ok'])throw new Error(_0x23e5de(0xe6d)+_0x3f1c86[_0x23e5de(0x1066)]);const _0x1dd401=await _0x3f1c86[_0x23e5de(0x12a2)](),_0xb9c25c=getGeminiResponseText(_0x1dd401),_0x312d53=_0xb9c25c[_0x23e5de(0x49a)](/\[[\s\S]*\]/);if(!_0x312d53)throw new Error(_0x23e5de(0xf15)+_0xb9c25c);const _0x56c519=JSON[_0x23e5de(0xd91)](_0x312d53[0x0]);await _0x5b9d83[_0x23e5de(0x3d9)]['clear'](),await _0x5b9d83['doubanPosts'][_0x23e5de(0x11f3)](_0x56c519['map'](_0x532897=>({..._0x532897,'timestamp':Date[_0x23e5de(0x487)]()-Math[_0x23e5de(0x1337)]()*0x186a0}))),await _0x37ff8e();}catch(_0x13b7c7){console[_0x23e5de(0x1518)](_0x23e5de(0x13db),_0x13b7c7),await _0x34d596(_0x23e5de(0x1ea),_0x23e5de(0x123f)+_0x13b7c7[_0x23e5de(0x13bc)]);}}async function _0x18ed0e(_0x33b887){const _0x2dddaf=_0x475790;_0x17ec27(_0x2dddaf(0x1274)),_0x250bff=_0x33b887;const _0x32534f=await _0x5b9d83[_0x2dddaf(0x3d9)][_0x2dddaf(0x6b5)](_0x33b887);if(!_0x32534f){_0x17ec27('douban-screen');return;}document['getElementById'](_0x2dddaf(0x157f))['textContent']=_0x2dddaf(0xc07);let _0xc18ad3=_0x825cf1,_0x577db4=_0x32534f['authorName'];const _0x1842c1=_0x32534f['authorOriginalName']?Object['values'](_0x28f30a[_0x2dddaf(0x6ce)])['find'](_0x2f8b42=>!_0x2f8b42[_0x2dddaf(0x1423)]&&_0x2f8b42[_0x2dddaf(0x66c)]===_0x32534f[_0x2dddaf(0xb6a)]):null;if(_0x1842c1)_0xc18ad3=_0x1842c1[_0x2dddaf(0x362)][_0x2dddaf(0xe91)];else{const _0x375efd=Object[_0x2dddaf(0x74e)](_0x28f30a['chats'])[_0x2dddaf(0x412)](_0x49d4cc=>!_0x49d4cc[_0x2dddaf(0x1423)]&&_0x49d4cc[_0x2dddaf(0xe36)]===_0x32534f[_0x2dddaf(0xa5d)]);if(_0x375efd)_0xc18ad3=_0x375efd[_0x2dddaf(0x362)]['aiAvatar'];else _0x32534f[_0x2dddaf(0xa13)]&&(_0xc18ad3=_0x2dddaf(0x6d0)+encodeURIComponent(_0x32534f[_0x2dddaf(0xa13)]));}document[_0x2dddaf(0x2ec)]('douban-detail-avatar')[_0x2dddaf(0xce4)]=_0xc18ad3,document[_0x2dddaf(0x2ec)](_0x2dddaf(0x11ba))['textContent']=_0x577db4,document['getElementById'](_0x2dddaf(0x11b0))[_0x2dddaf(0x15f)]=_0x2dddaf(0xe9f)+_0x32534f[_0x2dddaf(0x137e)],document[_0x2dddaf(0x2ec)](_0x2dddaf(0xd38))[_0x2dddaf(0x15f)]=_0x32534f['postTitle'],document['getElementById']('douban-detail-content')[_0x2dddaf(0xc43)]=_0x32534f['content'][_0x2dddaf(0x13ed)](/\n/g,_0x2dddaf(0xfd7)),document[_0x2dddaf(0x2ec)]('douban-my-comment-avatar')[_0x2dddaf(0xce4)]=_0x28f30a[_0x2dddaf(0x1506)][_0x2dddaf(0x516)],document['getElementById'](_0x2dddaf(0xc97))[_0x2dddaf(0x11a4)]='';const _0x15dc22=document[_0x2dddaf(0x2ec)](_0x2dddaf(0xc03));_0x15dc22[_0x2dddaf(0xc43)]='';if(_0x32534f[_0x2dddaf(0x8a4)]&&_0x32534f[_0x2dddaf(0x8a4)][_0x2dddaf(0x9a1)]>0x0){const _0x4b1294=new Map();_0x32534f['comments'][_0x2dddaf(0xf99)](_0x39b5d8=>{const _0x567e2c=_0x2dddaf;let _0x35a097=_0x825cf1;const _0x24abe9=_0x28f30a[_0x567e2c(0x1506)][_0x567e2c(0x19a)]||'我',_0x5510b6=_0x39b5d8[_0x567e2c(0x1091)];if(_0x4b1294['has'](_0x5510b6))_0x35a097=_0x4b1294[_0x567e2c(0x6b5)](_0x5510b6);else{if(_0x5510b6===_0x24abe9)_0x35a097=_0x28f30a[_0x567e2c(0x1506)][_0x567e2c(0x516)];else{if(_0x5510b6===_0x32534f[_0x567e2c(0xa5d)])_0x35a097=_0xc18ad3;else{const _0x53f8e7=_0x39b5d8['commenterOriginalName']?Object[_0x567e2c(0x74e)](_0x28f30a['chats'])['find'](_0xb4726=>!_0xb4726[_0x567e2c(0x1423)]&&_0xb4726[_0x567e2c(0x66c)]===_0x39b5d8[_0x567e2c(0x97d)]):null;if(_0x53f8e7)_0x35a097=_0x53f8e7[_0x567e2c(0x362)][_0x567e2c(0xe91)];else{const _0x56015e=Object[_0x567e2c(0x74e)](_0x28f30a['chats'])['find'](_0x490825=>!_0x490825[_0x567e2c(0x1423)]&&_0x490825[_0x567e2c(0xe36)]===_0x5510b6);if(_0x56015e)_0x35a097=_0x56015e[_0x567e2c(0x362)]['aiAvatar'];else _0x39b5d8[_0x567e2c(0x1306)]&&(_0x35a097='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x39b5d8[_0x567e2c(0x1306)]));}}}_0x4b1294[_0x567e2c(0xa63)](_0x5510b6,_0x35a097);}const _0x179a3d=document[_0x567e2c(0x14ae)]('div');_0x179a3d[_0x567e2c(0xdd1)]=_0x567e2c(0x820),_0x179a3d[_0x567e2c(0xc43)]=_0x567e2c(0xed3)+_0x35a097+_0x567e2c(0x1374)+_0x5510b6+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>'+_0x39b5d8[_0x567e2c(0x10ca)][_0x567e2c(0x13ed)](/\n/g,_0x567e2c(0xfd7))+_0x567e2c(0x118c),_0x15dc22[_0x567e2c(0x998)](_0x179a3d);});}else _0x15dc22[_0x2dddaf(0xc43)]=_0x2dddaf(0xd6c);const _0x2b65ae=document[_0x2dddaf(0x2ec)](_0x2dddaf(0x12aa));if(_0x2b65ae)_0x2b65ae[_0x2dddaf(0x12be)]=0x0;}async function _0x465643(){const _0x59d586=_0x475790;if(!_0x250bff)return;const _0x3e9bb6=document[_0x59d586(0x2ec)](_0x59d586(0xc97)),_0x1c5e09=_0x3e9bb6['value']['trim']();if(!_0x1c5e09)return;const _0x3b90bd=await _0x5b9d83[_0x59d586(0x3d9)]['get'](_0x250bff);if(!_0x3b90bd)return;!_0x3b90bd['comments']&&(_0x3b90bd[_0x59d586(0x8a4)]=[]);const _0x569d7d=_0x28f30a[_0x59d586(0x1506)][_0x59d586(0x19a)]||'我';_0x3b90bd[_0x59d586(0x8a4)]['push']({'commenter':_0x569d7d,'text':_0x1c5e09}),_0x3b90bd[_0x59d586(0x1027)]++,await _0x5b9d83[_0x59d586(0x3d9)][_0x59d586(0x7c3)](_0x3b90bd),_0x3e9bb6['value']='',await _0x18ed0e(_0x250bff);}async function _0x590096(){const _0x77a1b5=_0x475790;if(!_0x250bff)return;const _0x2c0d87=_0x250bff,_0x4cddd7=await _0x5b9d83[_0x77a1b5(0x3d9)][_0x77a1b5(0x6b5)](_0x2c0d87);if(!_0x4cddd7)return;const _0x19d0c0=_0x4cddd7['comments']&&_0x4cddd7[_0x77a1b5(0x8a4)][_0x77a1b5(0x225)](-0x1)[0x0];if(!_0x19d0c0){alert(_0x77a1b5(0x13ba));return;}await _0x34d596(_0x77a1b5(0x13e4),_0x77a1b5(0x8c6));try{const {proxyUrl:_0x4af913,apiKey:_0x92cc77,model:_0x3aaebb}=_0x28f30a[_0x77a1b5(0x1537)];if(!_0x4af913||!_0x92cc77||!_0x3aaebb)throw new Error('API未配置，无法生成内容。');const _0x17e56b=_0x28f30a['qzoneSettings'][_0x77a1b5(0x19a)]||'我',_0x55bf38=_0x28f30a[_0x77a1b5(0x6ce)][Object[_0x77a1b5(0xf6b)](_0x28f30a['chats'])[0x0]]?.[_0x77a1b5(0x362)][_0x77a1b5(0x1528)]||'(未设置)',_0x5d55b1=new Map();_0x4cddd7[_0x77a1b5(0x8a4)]&&_0x4cddd7[_0x77a1b5(0x8a4)][_0x77a1b5(0xf99)](_0x133075=>{const _0x1bb54f=_0x77a1b5,_0x150dd4=(_0x28f30a['globalSettings']['doubanActiveCharacterIds']||[])[_0x1bb54f(0x7e2)](_0x20e1ea=>_0x28f30a['chats'][_0x20e1ea]?.[_0x1bb54f(0xe36)]===_0x133075['commenter']);!_0x150dd4&&_0x133075[_0x1bb54f(0x1306)]&&_0x5d55b1[_0x1bb54f(0xa63)](_0x133075[_0x1bb54f(0x1091)],_0x133075['avatar_prompt']);});let _0x196814=_0x77a1b5(0xa06);_0x5d55b1[_0x77a1b5(0x2d2)]>0x0?(_0x196814+=_0x77a1b5(0x1d4),_0x5d55b1[_0x77a1b5(0xf99)]((_0x209794,_0x13aa8d)=>{const _0x36f2b1=_0x77a1b5;_0x196814+=_0x36f2b1(0xa82)+_0x13aa8d+_0x36f2b1(0x1301)+_0x209794+'\x22\x0a';})):_0x196814+=_0x77a1b5(0xeee);const _0xf78c71=_0x28f30a[_0x77a1b5(0x13b9)][_0x77a1b5(0x412)](_0x23900c=>_0x23900c[_0x77a1b5(0xe36)]===_0x77a1b5(0x9f5));let _0x3b3252=[];_0xf78c71&&_0xf78c71[_0x77a1b5(0x1047)]['forEach'](_0x5188aa=>{const _0x256588=_0x77a1b5;if(_0x5188aa['comment'][_0x256588(0x138a)](_0x256588(0x9d2))){const _0x2ce6cd=_0x5188aa[_0x256588(0x1047)][_0x256588(0xa8a)]('\x0a');_0x2ce6cd['forEach'](_0x45defd=>{const _0x4aec81=_0x256588,_0x55ef4a=_0x45defd['match'](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x55ef4a&&_0x3b3252[_0x4aec81(0x367)]({'name':_0x55ef4a[0x1][_0x4aec81(0x97e)](),'persona':_0x55ef4a[0x2][_0x4aec81(0x97e)]()});});}});let _0x13887e='';const _0x2e64c1=_0x28f30a['globalSettings'][_0x77a1b5(0x102e)]||[];_0x2e64c1['forEach'](_0x6516e1=>{const _0x2fbfb4=_0x77a1b5,_0x4a2766=_0x28f30a[_0x2fbfb4(0x6ce)][_0x6516e1];if(_0x4a2766){const _0x1d15fd=_0x4a2766[_0x2fbfb4(0x153f)]&&_0x4a2766[_0x2fbfb4(0x153f)][_0x2fbfb4(0x9a1)]>0x0?_0x4a2766[_0x2fbfb4(0x153f)][_0x2fbfb4(0x11c6)](_0x559562=>_0x559562['content'])[_0x2fbfb4(0xbad)](';\x20'):'无',_0x1fbe1f=_0x4a2766['history']['slice'](-0xa)[_0x2fbfb4(0x11c6)](_0x29f525=>(_0x29f525['role']===_0x2fbfb4(0xcc9)?_0x17e56b:_0x4a2766[_0x2fbfb4(0xe36)])+':\x20'+String(_0x29f525['content'])[_0x2fbfb4(0xa6b)](0x0,0x1e)+_0x2fbfb4(0x4e6))[_0x2fbfb4(0xbad)]('\x0a');_0x13887e+=_0x2fbfb4(0x1e1)+_0x4a2766[_0x2fbfb4(0xe36)]+':\x20'+_0x4a2766[_0x2fbfb4(0x362)]['aiPersona']['substring'](0x0,0x32)+_0x2fbfb4(0xbf0)+_0x1d15fd+_0x2fbfb4(0x148d)+_0x1fbe1f+']';}}),_0x3b3252[_0x77a1b5(0xf99)](_0x1e6ab0=>{const _0xd2ad=_0x77a1b5;_0x13887e+=_0xd2ad(0x1e1)+_0x1e6ab0[_0xd2ad(0xe36)]+':\x20'+_0x1e6ab0['persona'];});const _0x5521af=new Date(),_0x2b8ecd=_0x5521af[_0x77a1b5(0xc4c)](_0x77a1b5(0x1054),{'dateStyle':_0x77a1b5(0x1124),'timeStyle':_0x77a1b5(0xd90)}),_0x4ef1de='\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“'+_0x17e56b+_0x77a1b5(0x50d)+_0x2b8ecd+_0x77a1b5(0xdec)+_0x17e56b+_0x77a1b5(0x760)+_0x17e56b+_0x77a1b5(0xdc2)+_0x4cddd7['postTitle']+_0x77a1b5(0x1297)+_0x4cddd7['authorName']+_0x77a1b5(0x3b9)+_0x4cddd7[_0x77a1b5(0x1047)]['substring'](0x0,0x64)+'...\x0a-\x20**已有评论**:\x0a'+_0x4cddd7[_0x77a1b5(0x8a4)]['map'](_0x257425=>'-\x20'+_0x257425['commenter']+':\x20'+_0x257425[_0x77a1b5(0x10ca)])[_0x77a1b5(0xbad)]('\x0a')+'\x0a\x0a'+_0x196814+'\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20'+_0x2b8ecd+_0x77a1b5(0x7c8)+_0x17e56b+_0x77a1b5(0xf26)+_0x55bf38+_0x77a1b5(0x1292)+_0x13887e+_0x77a1b5(0x148b),_0x3ab8d3=[{'role':_0x77a1b5(0xcc9),'content':_0x77a1b5(0x683)}];let _0x2fa467=_0x4af913[_0x77a1b5(0x138a)](_0x77a1b5(0xe9c)),_0x3dde24=_0x4fff3d(_0x3aaebb,_0x92cc77,_0x4ef1de,_0x3ab8d3);const _0x2842d0=_0x2fa467?await fetch(_0x3dde24['url'],_0x3dde24['data']):await fetch(_0x4af913+_0x77a1b5(0x1427),{'method':_0x77a1b5(0x655),'headers':{'Content-Type':_0x77a1b5(0x1446),'Authorization':'Bearer\x20'+_0x92cc77},'body':JSON[_0x77a1b5(0xe4d)]({'model':_0x3aaebb,'messages':[{'role':_0x77a1b5(0x10a7),'content':_0x4ef1de},..._0x3ab8d3],'temperature':_0x28f30a[_0x77a1b5(0x1062)][_0x77a1b5(0x294)]||0x1})});if(!_0x2842d0['ok'])throw new Error(_0x77a1b5(0xe6d)+_0x2842d0[_0x77a1b5(0x1066)]);const _0x24a0e6=await _0x2842d0[_0x77a1b5(0x12a2)](),_0x5a66ff=getGeminiResponseText(_0x24a0e6),_0x209b5c=_0x5a66ff[_0x77a1b5(0x13ed)](/^```json\s*/,'')[_0x77a1b5(0x13ed)](/```$/,''),_0x41042d=JSON['parse'](_0x209b5c);Array[_0x77a1b5(0x624)](_0x41042d)&&_0x41042d[_0x77a1b5(0x9a1)]>0x0&&(_0x4cddd7[_0x77a1b5(0x8a4)][_0x77a1b5(0x367)](..._0x41042d),_0x4cddd7['commentsCount']+=_0x41042d[_0x77a1b5(0x9a1)],await _0x5b9d83['doubanPosts'][_0x77a1b5(0x7c3)](_0x4cddd7)),await _0x18ed0e(_0x2c0d87),_0x50c3bc();}catch(_0x422e62){console[_0x77a1b5(0x1518)](_0x77a1b5(0xa2f),_0x422e62),await _0x34d596(_0x77a1b5(0x221),_0x77a1b5(0x598)+_0x422e62[_0x77a1b5(0x13bc)]);}}async function _0x44306c(){const _0x469cab=_0x475790,_0x30a15c=document[_0x469cab(0x2ec)](_0x469cab(0xf17)),_0x4bfd78=document['getElementById'](_0x469cab(0x8de));_0x4bfd78[_0x469cab(0xc43)]='';const _0x3906b5=Object[_0x469cab(0x74e)](_0x28f30a['chats'])[_0x469cab(0xebc)](_0x58c692=>!_0x58c692[_0x469cab(0x1423)]),_0x3b159d=new Set(_0x28f30a[_0x469cab(0x1062)][_0x469cab(0x102e)]||[]);_0x3906b5['length']===0x0?_0x4bfd78['innerHTML']=_0x469cab(0x3a0):_0x3906b5['forEach'](_0x40f65b=>{const _0x2bebd6=_0x469cab,_0x398bb7=document['createElement'](_0x2bebd6(0xaa5));_0x398bb7[_0x2bebd6(0xdd1)]=_0x2bebd6(0x11c2),_0x398bb7['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22'+_0x40f65b['id']+'\x22\x20'+(_0x3b159d[_0x2bebd6(0xbf1)](_0x40f65b['id'])?_0x2bebd6(0x13b8):'')+_0x2bebd6(0x988)+(_0x40f65b[_0x2bebd6(0x362)][_0x2bebd6(0xe91)]||_0x825cf1)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x40f65b[_0x2bebd6(0xe36)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4bfd78[_0x2bebd6(0x998)](_0x398bb7);}),_0x30a15c[_0x469cab(0xff6)][_0x469cab(0xe82)](_0x469cab(0x149d));}async function _0x50bfed(){const _0x8f9a60=_0x475790,_0x19e55f=document['querySelectorAll'](_0x8f9a60(0x1121)),_0x29ab39=Array['from'](_0x19e55f)[_0x8f9a60(0x11c6)](_0x274184=>_0x274184[_0x8f9a60(0xe93)][_0x8f9a60(0xdd0)]);_0x28f30a['globalSettings'][_0x8f9a60(0x102e)]=_0x29ab39,await _0x5b9d83[_0x8f9a60(0x1062)][_0x8f9a60(0x7c3)](_0x28f30a['globalSettings']),document[_0x8f9a60(0x2ec)](_0x8f9a60(0xf17))[_0x8f9a60(0xff6)][_0x8f9a60(0x1424)](_0x8f9a60(0x149d)),await _0x266ab4();}document[_0x475790(0x2ec)](_0x475790(0x430))[_0x475790(0xf79)](_0x475790(0x1177),_0x44306c),document['getElementById'](_0x475790(0x144e))['addEventListener'](_0x475790(0x1177),()=>{const _0x1cdd68=_0x475790;document['getElementById'](_0x1cdd68(0xf17))[_0x1cdd68(0xff6)][_0x1cdd68(0x1424)](_0x1cdd68(0x149d));}),document[_0x475790(0x2ec)](_0x475790(0x808))[_0x475790(0xf79)](_0x475790(0x1177),_0x50bfed),document[_0x475790(0x2ec)]('douban-cast-list')['addEventListener'](_0x475790(0x1177),_0x2ccc3e=>{const _0x174dd4=_0x475790,_0x174d31=_0x2ccc3e[_0x174dd4(0x1104)][_0x174dd4(0x3f2)](_0x174dd4(0x973));if(_0x174d31){const _0x2d2e09=_0x174d31[_0x174dd4(0x765)](_0x174dd4(0x60d));_0x2d2e09&&_0x2ccc3e['target']!==_0x2d2e09&&(_0x2d2e09['checked']=!_0x2d2e09[_0x174dd4(0x13b8)]);}});async function _0x24f23a(_0xcb8e45){const _0x35a484=_0x475790;if(!_0xcb8e45)return;const _0x3629d5=await _0x4436ba(_0x35a484(0x83f),_0x35a484(0x13d0),{'confirmText':_0x35a484(0x171)});if(!_0x3629d5)return;try{const _0x3b6a5c=await _0xcb8e45[_0x35a484(0x10ca)](),_0x8e2707=JSON['parse'](_0x3b6a5c);if(!_0x8e2707[_0x35a484(0x638)]&&!_0x8e2707[_0x35a484(0x1099)]&&!_0x8e2707[_0x35a484(0x12e8)])throw new Error(_0x35a484(0x8e2));Object[_0x35a484(0x92a)](_0x28f30a[_0x35a484(0x1062)],_0x8e2707),await _0x5b9d83['globalSettings'][_0x35a484(0x7c3)](_0x28f30a[_0x35a484(0x1062)]),_0x1993ff(),_0x543c4d(),_0x3b4945(),_0x5d626d(),_0x276bb0(_0x28f30a[_0x35a484(0x1062)][_0x35a484(0x1099)]),_0x155408(_0x28f30a['globalSettings']['fontUrl']),_0x435075(),_0x47251c(),_0x1bf18e(),await _0x34d596(_0x35a484(0x685),_0x35a484(0x30d));}catch(_0x19034d){console['error']('导入外观设置时出错:',_0x19034d),await _0x34d596('导入失败','文件解析或应用失败:\x20'+_0x19034d[_0x35a484(0x13bc)]);}}async function _0x4a5a6f(_0x52c1cb){const _0x3d8037=_0x475790;console[_0x3d8037(0x415)]('检测到应用离线了\x20'+_0x52c1cb[_0x3d8037(0x5c3)](0x1)+'\x20分钟，开始模拟后台活动...');const _0x1b9061=Object[_0x3d8037(0x74e)](_0x28f30a[_0x3d8037(0x6ce)])[_0x3d8037(0xebc)](_0x90950f=>!_0x90950f[_0x3d8037(0x1423)]&&_0x90950f[_0x3d8037(0x362)][_0x3d8037(0x12ed)]&&_0x90950f[_0x3d8037(0xaf4)]?.[_0x3d8037(0x2a3)]===_0x3d8037(0xab9));if(_0x1b9061[_0x3d8037(0x9a1)]===0x0){console['log']('没有配置为后台活跃的角色，跳过模拟。');return;}for(const _0xdab480 of _0x1b9061){const _0x593fcd=_0xdab480[_0x3d8037(0x362)]['actionCooldownMinutes']||0xf,_0x10cf4a=_0xdab480[_0x3d8037(0x14e9)]?(Date['now']()-_0xdab480[_0x3d8037(0x14e9)])/(0x3e8*0x3c):Infinity;_0x52c1cb>_0x593fcd&&_0x10cf4a>_0x593fcd&&(Math[_0x3d8037(0x1337)]()<0.3&&(console[_0x3d8037(0x415)]('角色\x20\x22'+_0xdab480[_0x3d8037(0xe36)]+_0x3d8037(0x13f0)),Math[_0x3d8037(0x1337)]()<0.7?await _0xfd66ee(_0xdab480['id']):console[_0x3d8037(0x415)](_0x3d8037(0xa18)+_0xdab480[_0x3d8037(0xe36)]+_0x3d8037(0x1293))));}}function _0x418ff5(){const _0x217873=_0x475790;if(!_0x28f30a[_0x217873(0x11b9)])return;const _0x3f8cf0=_0x28f30a['chats'][_0x28f30a[_0x217873(0x11b9)]];document['getElementById'](_0x217873(0xc87))['value']='',document[_0x217873(0x2ec)](_0x217873(0x124a))['value']='',document['getElementById'](_0x217873(0x4fb))[_0x217873(0xc43)]=_0x217873(0x296),_0x17ec27(_0x217873(0x51a));}async function _0x40f8ca(){const _0x7c6c5e=_0x475790,_0x3536c7=_0x28f30a['chats'][_0x28f30a[_0x7c6c5e(0x11b9)]];if(!_0x3536c7)return;const _0x1a8b73=document[_0x7c6c5e(0x2ec)](_0x7c6c5e(0xc87))[_0x7c6c5e(0x11a4)]['trim']()['toLowerCase'](),_0x12043b=document[_0x7c6c5e(0x2ec)](_0x7c6c5e(0x124a))[_0x7c6c5e(0x11a4)];if(!_0x1a8b73&&!_0x12043b){alert('请输入关键词或选择一个日期。');return;}let _0xa35d65=_0x3536c7[_0x7c6c5e(0x12c3)][_0x7c6c5e(0xebc)](_0x31998f=>!_0x31998f[_0x7c6c5e(0x1162)]);_0x1a8b73&&(_0xa35d65=_0xa35d65[_0x7c6c5e(0xebc)](_0x5a02d7=>{const _0x15c71a=_0x7c6c5e;let _0x3d0368='';if(typeof _0x5a02d7['content']==='string')_0x3d0368=_0x5a02d7[_0x15c71a(0x1047)];else{if(_0x5a02d7[_0x15c71a(0xb4b)]==='voice_message')_0x3d0368=_0x5a02d7[_0x15c71a(0x1047)];else{if(_0x5a02d7[_0x15c71a(0xb4b)]===_0x15c71a(0x11c7)||_0x5a02d7[_0x15c71a(0xb4b)]===_0x15c71a(0x7f7))_0x3d0368=_0x5a02d7[_0x15c71a(0x1047)];else{if(_0x5a02d7['type']==='offline_text')_0x3d0368=(_0x5a02d7[_0x15c71a(0x6c4)]||'')+'\x20'+(_0x5a02d7[_0x15c71a(0x9cc)]||'');else _0x5a02d7['quote']&&(_0x3d0368=_0x5a02d7[_0x15c71a(0x1047)]);}}}return _0x3d0368['toLowerCase']()['includes'](_0x1a8b73);}));if(_0x12043b){const _0x1c7c83=new Date(_0x12043b),_0x173c4b=new Date(_0x1c7c83[_0x7c6c5e(0xcdc)](0x0,0x0,0x0,0x0))['getTime'](),_0x40593f=new Date(_0x1c7c83[_0x7c6c5e(0xcdc)](0x17,0x3b,0x3b,0x3e7))[_0x7c6c5e(0x33c)]();_0xa35d65=_0xa35d65['filter'](_0x25b8bf=>_0x25b8bf[_0x7c6c5e(0x69a)]>=_0x173c4b&&_0x25b8bf[_0x7c6c5e(0x69a)]<=_0x40593f);}await _0x3644c6(_0xa35d65);}async function _0x3644c6(_0x2b637e){const _0x316d13=_0x475790,_0x392c97=document[_0x316d13(0x2ec)]('chat-search-results-list'),_0x2b8d7e=_0x28f30a['chats'][_0x28f30a['activeChatId']];_0x392c97[_0x316d13(0xc43)]='';if(_0x2b637e[_0x316d13(0x9a1)]===0x0){_0x392c97[_0x316d13(0xc43)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>';return;}let _0x101df4='';for(const _0xe6267a of _0x2b637e){const _0x1214d3=new Date(_0xe6267a[_0x316d13(0x69a)]),_0x172c38=_0x1214d3[_0x316d13(0xc14)]();if(_0x172c38!==_0x101df4){const _0x5e9020=document[_0x316d13(0x14ae)](_0x316d13(0xaa5));_0x5e9020['className']='date-separator',_0x5e9020[_0x316d13(0x15f)]=_0x316d13(0xc7c)+_0x1214d3[_0x316d13(0x4cb)]()+'年'+(_0x1214d3['getMonth']()+0x1)+'月'+_0x1214d3[_0x316d13(0x3c7)]()+_0x316d13(0x5b3),_0x392c97['appendChild'](_0x5e9020),_0x101df4=_0x172c38;}const _0x6ab995=await _0x43f190(_0xe6267a,_0x2b8d7e);_0x6ab995&&(_0x6ab995['style']['cursor']=_0x316d13(0xda7),_0x6ab995[_0x316d13(0xf79)](_0x316d13(0x1177),()=>_0xb78f39(_0xe6267a[_0x316d13(0x69a)])),_0x392c97[_0x316d13(0x998)](_0x6ab995));}}async function _0xb78f39(_0x29f902){const _0x5622da=_0x475790,_0x2dca4a=_0x28f30a['activeChatId'];if(!_0x2dca4a)return;_0x17ec27(_0x5622da(0x120a)),setTimeout(async()=>{const _0x948924=_0x5622da,_0x261fbd=document[_0x948924(0x2ec)](_0x948924(0x156b)),_0x4f5477=_0x948924(0x84e)+_0x29f902+'\x22]';let _0x5d3dc8=_0x261fbd['querySelector'](_0x4f5477),_0x48fc5a=0x0;const _0x29708f=0x14;while(!_0x5d3dc8&&_0x48fc5a<_0x29708f){const _0x374541=document[_0x948924(0x2ec)](_0x948924(0x54d));if(_0x374541)console[_0x948924(0x415)](_0x948924(0xf24)+(_0x48fc5a+0x1)+')'),await _0x33df8e(),_0x5d3dc8=_0x261fbd[_0x948924(0x765)](_0x4f5477),_0x48fc5a++;else break;}_0x44e2b8(_0x29f902);},0xc8);}async function _0x531a13(){const _0x595ce8=_0x475790;document['getElementById'](_0x595ce8(0xc87))[_0x595ce8(0x11a4)]='',document[_0x595ce8(0x2ec)](_0x595ce8(0x124a))[_0x595ce8(0x11a4)]='',await _0x3644c6(_0x28f30a['chats'][_0x28f30a[_0x595ce8(0x11b9)]][_0x595ce8(0x12c3)][_0x595ce8(0xebc)](_0x22f197=>!_0x22f197[_0x595ce8(0x1162)]));}async function _0x2ba13a(_0x27dcfc=![],_0x4678d0=null,_0x422576=null){const _0x1955da=_0x475790,_0x2c998b=document[_0x1955da(0x2ec)](_0x1955da(0x150b)),_0x4fc63b=document['getElementById'](_0x1955da(0xe6b)),_0x1bf3b8=_0x28f30a[_0x1955da(0x6ce)][_0x28f30a[_0x1955da(0x11b9)]];_0x2c998b[_0x1955da(0xc43)]='',_0x4fc63b[_0x1955da(0xc43)]='';const _0x11ca60=await _0x5b9d83[_0x1955da(0x1e9)][_0x1955da(0x14b5)](),_0x2ecfa9=[..._0x216ec7,..._0x11ca60];document[_0x1955da(0x765)]('#avatar-frame-modal\x20.frame-tabs')[_0x1955da(0x589)][_0x1955da(0x701)]=_0x27dcfc?_0x1955da(0x5b1):'flex',document['getElementById'](_0x1955da(0x553))[_0x1955da(0x589)]['display']=_0x1955da(0x13f7),document[_0x1955da(0x2ec)]('my-frame-content')[_0x1955da(0x589)]['display']='none',document[_0x1955da(0x2ec)](_0x1955da(0x6a1))[_0x1955da(0xff6)][_0x1955da(0xe82)]('active'),document['getElementById'](_0x1955da(0x11f5))[_0x1955da(0xff6)][_0x1955da(0x1424)](_0x1955da(0xd43));if(_0x27dcfc)_0x2ecfa9['forEach'](_0x518318=>{const _0x29b9ab=_0x1955da,_0x4634b4=_0x54d770(_0x518318,'my',_0x4678d0);_0x518318['url']===_0x422576&&_0x4634b4['classList'][_0x29b9ab(0xe82)](_0x29b9ab(0xba2)),_0x2c998b[_0x29b9ab(0x998)](_0x4634b4);});else{const _0x54c0a7=_0x1bf3b8[_0x1955da(0x362)]['aiAvatar']||_0x825cf1,_0x5170f1=_0x1bf3b8[_0x1955da(0x362)][_0x1955da(0x10a3)]||(_0x1bf3b8[_0x1955da(0x1423)]?_0x3ba305:_0x825cf1);_0x2ecfa9['forEach'](_0x159c4f=>{const _0x78d2ab=_0x1955da,_0x4856bb=_0x54d770(_0x159c4f,'ai',_0x54c0a7);if(_0x159c4f['url']===_0x48ceb9['ai'])_0x4856bb[_0x78d2ab(0xff6)][_0x78d2ab(0xe82)](_0x78d2ab(0xba2));_0x2c998b[_0x78d2ab(0x998)](_0x4856bb);const _0x188507=_0x54d770(_0x159c4f,'my',_0x5170f1);if(_0x159c4f[_0x78d2ab(0x6d1)]===_0x48ceb9['my'])_0x188507[_0x78d2ab(0xff6)][_0x78d2ab(0xe82)](_0x78d2ab(0xba2));_0x4fc63b['appendChild'](_0x188507);});}}function _0x54d770(_0x483c89,_0x4a9436,_0x1ddde3){const _0x1d8b10=_0x475790,_0x309d21=document[_0x1d8b10(0x14ae)](_0x1d8b10(0xaa5));_0x309d21[_0x1d8b10(0xdd1)]=_0x1d8b10(0x11ab),_0x309d21['dataset'][_0x1d8b10(0x13e1)]=_0x483c89[_0x1d8b10(0x6d1)],_0x309d21[_0x1d8b10(0x141e)]=_0x483c89[_0x1d8b10(0xe36)];const _0x51b89e=typeof _0x483c89['id']==='number',_0x4a3e19=_0x51b89e?'<button\x20class=\x22delete-btn\x22\x20data-id=\x22'+_0x483c89['id']+_0x1d8b10(0x695):'';return _0x309d21[_0x1d8b10(0xc43)]=_0x1d8b10(0xe7c)+_0x4a3e19+_0x1d8b10(0x962)+_0x1ddde3+_0x1d8b10(0xbd8)+(_0x483c89[_0x1d8b10(0x6d1)]?_0x1d8b10(0x416)+_0x483c89['url']+'\x22\x20class=\x22preview-frame\x22>':'')+_0x1d8b10(0xc53),_0x309d21['addEventListener']('click',_0x36a96e=>{const _0x28cb3e=_0x1d8b10;if(_0x36a96e[_0x28cb3e(0x1104)][_0x28cb3e(0xff6)][_0x28cb3e(0xe9a)](_0x28cb3e(0xaaa)))return;if(_0x5c53cf){if(_0x51b89e){const _0x113d43=parseInt(_0x483c89['id']);_0x309d21['classList'][_0x28cb3e(0x14c8)](_0x28cb3e(0xba2)),_0x2b7696[_0x28cb3e(0xbf1)](_0x113d43)?_0x2b7696['delete'](_0x113d43):_0x2b7696[_0x28cb3e(0xe82)](_0x113d43),_0x2f84fa();}}else{_0x48ceb9[_0x4a9436]=_0x483c89[_0x28cb3e(0x6d1)];const _0x599421=_0x4a9436==='ai'?document['getElementById']('ai-frame-grid'):document[_0x28cb3e(0x2ec)]('my-frame-grid');_0x599421[_0x28cb3e(0x5d6)](_0x28cb3e(0x167))[_0x28cb3e(0xf99)](_0x2e5136=>_0x2e5136['classList'][_0x28cb3e(0x1424)](_0x28cb3e(0xba2))),_0x309d21[_0x28cb3e(0xff6)]['add'](_0x28cb3e(0xba2));}}),_0x309d21;}async function _0x51e35b(){const _0x5afbe8=_0x475790,_0x282875=document[_0x5afbe8(0x2ec)](_0x5afbe8(0xb55)),_0x417dc3=await new Promise(_0x159533=>{const _0x2fabb2=_0x5afbe8,_0x32ca92=_0x1ade59=>{const _0x15401d=_0x1937;_0x159533(_0x1ade59[_0x15401d(0x1104)]['files'][0x0]||null),_0x282875[_0x15401d(0x1f0)](_0x15401d(0x217),_0x32ca92);};_0x282875[_0x2fabb2(0xf79)](_0x2fabb2(0x217),_0x32ca92,{'once':!![]}),_0x282875[_0x2fabb2(0x1177)]();});if(!_0x417dc3)return;const _0x57e10f=await _0x33419a('命名头像框','请为这个新头像框起个名字');if(!_0x57e10f||!_0x57e10f['trim']())return;const _0x38c2b0=await new Promise(_0x131a3b=>{const _0x343d5a=_0x5afbe8,_0x202b70=new FileReader();_0x202b70[_0x343d5a(0xf2d)]=()=>_0x131a3b(_0x202b70[_0x343d5a(0x42a)]),_0x202b70['readAsDataURL'](_0x417dc3);});await _0x5b9d83[_0x5afbe8(0x1e9)][_0x5afbe8(0xe82)]({'name':_0x57e10f[_0x5afbe8(0x97e)](),'url':_0x38c2b0}),_0x2ba13a(_0x54ff18);}async function _0x41fbba(){const _0x88940f=_0x475790,_0x581768='请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif',_0x262889=await _0x33419a(_0x88940f(0x5b0),'从完整链接批量导入','',_0x88940f(0x382),'<p\x20style=\x22font-size:12px;color:#888;\x22>'+_0x581768+_0x88940f(0x1251));if(!_0x262889||!_0x262889[_0x88940f(0x97e)]())return;const _0x1f35cb=_0x262889[_0x88940f(0x97e)]()['split']('\x0a'),_0x369f6f=[];let _0x5e2c57=0x0;for(const _0x59fc97 of _0x1f35cb){const _0x1b1128=_0x59fc97[_0x88940f(0x49a)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x1b1128)_0x369f6f['push']({'name':_0x1b1128[0x1][_0x88940f(0x97e)](),'url':_0x1b1128[0x2][_0x88940f(0x97e)]()});else _0x59fc97[_0x88940f(0x97e)]()&&_0x5e2c57++;}_0x369f6f['length']>0x0&&(await _0x5b9d83[_0x88940f(0x1e9)][_0x88940f(0x11f3)](_0x369f6f),_0x2ba13a(_0x54ff18),await _0x34d596('导入成功',_0x88940f(0xffd)+_0x369f6f[_0x88940f(0x9a1)]+_0x88940f(0xae0))),_0x5e2c57>0x0&&await _0x34d596('部分失败','有\x20'+_0x5e2c57+'\x20行格式不正确，已被忽略。');}async function _0x91ea9b(_0x4f8c35){const _0x5d372a=_0x475790,_0x120dc8=await _0x5b9d83[_0x5d372a(0x1e9)]['get'](_0x4f8c35);if(!_0x120dc8)return;const _0x50b3d6=await _0x4436ba(_0x5d372a(0x10d9),_0x5d372a(0x157e)+_0x120dc8[_0x5d372a(0xe36)]+_0x5d372a(0x52e),{'confirmButtonClass':'btn-danger'});_0x50b3d6&&(await _0x5b9d83[_0x5d372a(0x1e9)]['delete'](_0x4f8c35),_0x2ba13a(_0x54ff18));}let _0x75ffc4=0x0;const _0x1e284c=0x2;function _0x23fa06(){const _0x15f734=_0x475790,_0x54d872=document['getElementById'](_0x15f734(0xd37)),_0x548da9=document['getElementById'](_0x15f734(0x6e9)),_0x4048fe=document['querySelectorAll'](_0x15f734(0xf2e));let _0x599125=0x0,_0x5f1936=0x0,_0x72ad5b=0x0,_0x484549=![],_0x5933e6=!![];const _0x5eb07b=()=>{const _0x3ef534=_0x15f734;_0x548da9[_0x3ef534(0x589)][_0x3ef534(0x1244)]=_0x3ef534(0x778)+_0x75ffc4*(0x64/_0x1e284c)+'%)',_0x4048fe[_0x3ef534(0xf99)]((_0xdb8751,_0x4f51e2)=>{const _0x126fc2=_0x3ef534;_0xdb8751[_0x126fc2(0xff6)]['toggle'](_0x126fc2(0xd43),_0x4f51e2===_0x75ffc4);});},_0x580a60=_0x50e0db=>{const _0x3f1088=_0x15f734;_0x484549=!![],_0x5933e6=!![],_0x599125=_0x50e0db[_0x3f1088(0xb4b)][_0x3f1088(0x138a)](_0x3f1088(0x69b))?_0x50e0db[_0x3f1088(0xe27)]:_0x50e0db['touches'][0x0][_0x3f1088(0xe27)],_0x5f1936=_0x50e0db[_0x3f1088(0xb4b)][_0x3f1088(0x138a)](_0x3f1088(0x69b))?_0x50e0db[_0x3f1088(0x4e5)]:_0x50e0db['touches'][0x0]['pageY'],_0x548da9[_0x3f1088(0x589)][_0x3f1088(0x89c)]='none';},_0x3dc624=_0x958450=>{const _0x571f22=_0x15f734;if(!_0x484549)return;const _0x1a106f=_0x958450[_0x571f22(0xb4b)]['includes'](_0x571f22(0x69b))?_0x958450['pageY']:_0x958450['touches'][0x0][_0x571f22(0x4e5)];_0x72ad5b=_0x958450[_0x571f22(0xb4b)]['includes'](_0x571f22(0x69b))?_0x958450[_0x571f22(0xe27)]:_0x958450[_0x571f22(0x5b2)][0x0][_0x571f22(0xe27)];const _0x2e3447=_0x72ad5b-_0x599125,_0x59c656=_0x1a106f-_0x5f1936;_0x5933e6&&(Math[_0x571f22(0x264)](_0x2e3447)>0xa||Math[_0x571f22(0x264)](_0x59c656)>0xa)&&(_0x5933e6=![]);if(Math[_0x571f22(0x264)](_0x2e3447)>Math[_0x571f22(0x264)](_0x59c656)){if(_0x958450['cancelable'])_0x958450[_0x571f22(0x10bd)]();_0x548da9[_0x571f22(0x589)][_0x571f22(0x1244)]=_0x571f22(0xdcd)+_0x75ffc4*(0x64/_0x1e284c)+_0x571f22(0x10cc)+_0x2e3447+'px))';}},_0x171e78=_0x544966=>{const _0x4ece96=_0x15f734;if(!_0x484549)return;_0x484549=![],_0x548da9['style'][_0x4ece96(0x89c)]='transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)';if(_0x5933e6){_0x5eb07b();return;}const _0x51daf3=_0x72ad5b-_0x599125;if(Math['abs'](_0x51daf3)>_0x54d872[_0x4ece96(0x144c)]/0x4){if(_0x51daf3>0x0&&_0x75ffc4>0x0)_0x75ffc4--;else _0x51daf3<0x0&&_0x75ffc4<_0x1e284c-0x1&&_0x75ffc4++;}_0x5eb07b();};_0x54d872[_0x15f734(0xf79)](_0x15f734(0xcfa),_0x580a60),_0x54d872[_0x15f734(0xf79)](_0x15f734(0x6fa),_0x3dc624),_0x54d872[_0x15f734(0xf79)]('mouseup',_0x171e78),_0x54d872[_0x15f734(0xf79)]('mouseleave',_0x171e78),_0x54d872['addEventListener'](_0x15f734(0x9a8),_0x580a60,{'passive':![]}),_0x54d872[_0x15f734(0xf79)](_0x15f734(0xba4),_0x3dc624,{'passive':![]}),_0x54d872[_0x15f734(0xf79)](_0x15f734(0xe2a),_0x171e78);}let _0x84d184=null;async function _0x59ad88(){const _0x61696b=_0x475790;await _0x2ed701(),_0x17ec27(_0x61696b(0xaac));}async function _0x2ed701(){const _0x223f81=_0x475790,_0x5ec982=document[_0x223f81(0x2ec)](_0x223f81(0x13bb)),_0x113b81=document[_0x223f81(0x2ec)]('preset-content-container');_0x5ec982[_0x223f81(0xc43)]='',_0x113b81['innerHTML']='';const [_0x4a85e7,_0x5cc9df]=await Promise[_0x223f81(0xa92)]([_0x5b9d83[_0x223f81(0x1504)][_0x223f81(0x14b5)](),_0x5b9d83[_0x223f81(0x2f1)]['orderBy'](_0x223f81(0xe36))[_0x223f81(0x14b5)]()]);_0x28f30a[_0x223f81(0x1504)]=_0x4a85e7;if(_0x4a85e7[_0x223f81(0x9a1)]===0x0){_0x113b81[_0x223f81(0xc43)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>';return;}const _0x269d94=document[_0x223f81(0x14ae)](_0x223f81(0xd5a));_0x269d94['className']=_0x223f81(0x309),_0x269d94[_0x223f81(0x15f)]='全部',_0x269d94['dataset'][_0x223f81(0x10ce)]=_0x223f81(0xa92),_0x5ec982[_0x223f81(0x998)](_0x269d94);const _0x55b48f=document[_0x223f81(0x14ae)](_0x223f81(0xaa5));_0x55b48f[_0x223f81(0xdd1)]=_0x223f81(0x5e6),_0x55b48f[_0x223f81(0xe93)][_0x223f81(0x10ce)]=_0x223f81(0xa92),_0x113b81[_0x223f81(0x998)](_0x55b48f),_0x5cc9df['forEach'](_0x4db6eb=>{const _0x48fdea=_0x223f81,_0x270494=document[_0x48fdea(0x14ae)](_0x48fdea(0xd5a));_0x270494['className']=_0x48fdea(0x1239),_0x270494[_0x48fdea(0x15f)]=_0x4db6eb[_0x48fdea(0xe36)],_0x270494['dataset'][_0x48fdea(0x10ce)]=String(_0x4db6eb['id']),_0x5ec982[_0x48fdea(0x998)](_0x270494);const _0x25e37a=document[_0x48fdea(0x14ae)](_0x48fdea(0xaa5));_0x25e37a[_0x48fdea(0xdd1)]=_0x48fdea(0xc92),_0x25e37a[_0x48fdea(0xe93)]['categoryId']=String(_0x4db6eb['id']),_0x113b81[_0x48fdea(0x998)](_0x25e37a);});const _0x58b382=_0x4a85e7['some'](_0x1be08d=>!_0x1be08d[_0x223f81(0x10ce)]);if(_0x58b382){const _0x2fc1b8=document['createElement'](_0x223f81(0xd5a));_0x2fc1b8['className']=_0x223f81(0x1239),_0x2fc1b8[_0x223f81(0x15f)]=_0x223f81(0x5d8),_0x2fc1b8[_0x223f81(0xe93)][_0x223f81(0x10ce)]='uncategorized',_0x5ec982[_0x223f81(0x998)](_0x2fc1b8);const _0x2f7ae9=document[_0x223f81(0x14ae)](_0x223f81(0xaa5));_0x2f7ae9[_0x223f81(0xdd1)]=_0x223f81(0xc92),_0x2f7ae9[_0x223f81(0xe93)][_0x223f81(0x10ce)]='uncategorized',_0x113b81[_0x223f81(0x998)](_0x2f7ae9);}_0x4a85e7[_0x223f81(0xf99)](_0x15dc64=>{const _0x23835e=_0x223f81,_0x9bf98=_0x23835e(0xc8e)+_0x15dc64[_0x23835e(0x1047)]['length']+_0x23835e(0x1299),_0x381547=document['createElement'](_0x23835e(0xaa5));_0x381547['className']=_0x23835e(0x56e),_0x381547[_0x23835e(0xc43)]=_0x23835e(0x52a)+_0x15dc64[_0x23835e(0xe36)]+_0x23835e(0xa0c)+_0x9bf98+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x52c18e=()=>_0x104122(_0x15dc64['id']),_0x2606f9=async()=>{const _0x51054c=_0x23835e,_0x15c608=await _0x4436ba(_0x51054c(0x3c5),_0x51054c(0x139c)+_0x15dc64['name']+_0x51054c(0x1443),{'confirmButtonClass':_0x51054c(0xd8f)});_0x15c608&&(await _0x5b9d83[_0x51054c(0x1504)]['delete'](_0x15dc64['id']),_0x28f30a[_0x51054c(0x1504)]=await _0x5b9d83[_0x51054c(0x1504)][_0x51054c(0x14b5)](),_0x2ed701());};_0x381547[_0x23835e(0xf79)](_0x23835e(0x1177),_0x52c18e),_0x131542(_0x381547,_0x2606f9);const _0x494e8f=_0x381547[_0x23835e(0x303)](!![]);_0x494e8f[_0x23835e(0xf79)](_0x23835e(0x1177),_0x52c18e),_0x131542(_0x494e8f,_0x2606f9),_0x55b48f[_0x23835e(0x998)](_0x494e8f);const _0x12728c=_0x15dc64['categoryId']?String(_0x15dc64['categoryId']):_0x23835e(0x17c),_0x1a2173=_0x113b81[_0x23835e(0x765)](_0x23835e(0x9c8)+_0x12728c+'\x22]');_0x1a2173&&_0x1a2173[_0x23835e(0x998)](_0x381547);}),document[_0x223f81(0x5d6)](_0x223f81(0xdee))[_0x223f81(0xf99)](_0x5a6003=>{const _0x391953=_0x223f81;_0x5a6003[_0x391953(0xf79)](_0x391953(0x1177),()=>_0x4e4452(_0x5a6003[_0x391953(0xe93)]['categoryId']));});}function _0x4e4452(_0x102193){const _0xbd9540=_0x475790;document[_0xbd9540(0x5d6)](_0xbd9540(0xdee))['forEach'](_0x5e9142=>{const _0x4d52c5=_0xbd9540;_0x5e9142[_0x4d52c5(0xff6)][_0x4d52c5(0x14c8)](_0x4d52c5(0xd43),_0x5e9142['dataset'][_0x4d52c5(0x10ce)]===_0x102193);}),document[_0xbd9540(0x5d6)](_0xbd9540(0x1455))[_0xbd9540(0xf99)](_0x516a29=>{const _0x9d66b5=_0xbd9540;_0x516a29['classList'][_0x9d66b5(0x14c8)]('active',_0x516a29[_0x9d66b5(0xe93)][_0x9d66b5(0x10ce)]===_0x102193);});}async function _0x104122(_0x5908b8){const _0x40b780=_0x475790;_0x17ec27(_0x40b780(0x716)),_0x84d184=_0x5908b8;try{const [_0x49ce34,_0x2c9f88]=await Promise['all']([_0x5b9d83[_0x40b780(0x1504)]['get'](_0x5908b8),_0x5b9d83[_0x40b780(0x2f1)][_0x40b780(0x14b5)]()]);if(!_0x49ce34){console[_0x40b780(0x1518)](_0x40b780(0xdf8),_0x5908b8),await _0x34d596(_0x40b780(0x10b4),_0x40b780(0x116c)),_0x17ec27(_0x40b780(0xaac));return;}setTimeout(()=>{const _0x39193d=_0x40b780;document[_0x39193d(0x2ec)](_0x39193d(0xee0))[_0x39193d(0x15f)]=_0x49ce34[_0x39193d(0xe36)],document[_0x39193d(0x2ec)]('preset-name-input')[_0x39193d(0x11a4)]=_0x49ce34[_0x39193d(0xe36)];const _0x5c9835=document[_0x39193d(0x2ec)](_0x39193d(0x519));_0x5c9835[_0x39193d(0xc43)]='<option\x20value=\x22\x22>--\x20未分类\x20--</option>',_0x2c9f88[_0x39193d(0xf99)](_0x20aa11=>{const _0x12cc18=_0x39193d,_0x3b10a9=document[_0x12cc18(0x14ae)]('option');_0x3b10a9[_0x12cc18(0x11a4)]=_0x20aa11['id'],_0x3b10a9['textContent']=_0x20aa11['name'];if(_0x49ce34[_0x12cc18(0x10ce)]===_0x20aa11['id'])_0x3b10a9[_0x12cc18(0xba2)]=!![];_0x5c9835['appendChild'](_0x3b10a9);});const _0x41a4dd=document[_0x39193d(0x2ec)]('preset-entries-container');_0x41a4dd['innerHTML']='',Array[_0x39193d(0x624)](_0x49ce34[_0x39193d(0x1047)])&&_0x49ce34['content'][_0x39193d(0x9a1)]>0x0?_0x49ce34[_0x39193d(0x1047)][_0x39193d(0xf99)](_0x399a46=>{const _0x5398fd=_0x2489be(_0x399a46);_0x41a4dd['appendChild'](_0x5398fd);}):_0x41a4dd[_0x39193d(0xc43)]=_0x39193d(0xea1);},0x32);}catch(_0xfb3a55){console[_0x40b780(0x1518)](_0x40b780(0xc7d),_0xfb3a55),await _0x34d596('加载失败',_0x40b780(0x5f5)+_0xfb3a55['message']),_0x17ec27(_0x40b780(0xaac));}}function _0x2489be(_0xf2b436={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x27a3ef=_0x475790,_0x5bb6c3=document[_0x27a3ef(0x14ae)](_0x27a3ef(0xaa5));_0x5bb6c3['className']=_0x27a3ef(0x929);const _0x3663cf=_0xf2b436[_0x27a3ef(0x400)]!==![]?_0x27a3ef(0x13b8):'';_0x5bb6c3[_0x27a3ef(0xc43)]=_0x27a3ef(0x82f)+_0x3663cf+_0x27a3ef(0x4b6)+(_0xf2b436[_0x27a3ef(0x70d)]||'')+'\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22'+(_0xf2b436[_0x27a3ef(0xf6b)]||[])[_0x27a3ef(0xbad)](',\x20')+_0x27a3ef(0x12ff)+(_0xf2b436['content']||'')+_0x27a3ef(0x4b0),_0x5bb6c3[_0x27a3ef(0x765)](_0x27a3ef(0x81c))[_0x27a3ef(0xf79)]('click',()=>_0x5bb6c3[_0x27a3ef(0x1424)]());const _0x50d29a=_0x5bb6c3[_0x27a3ef(0x765)](_0x27a3ef(0x8cc)),_0x1935eb=_0x5bb6c3[_0x27a3ef(0x765)](_0x27a3ef(0xaa9));return _0x50d29a[_0x27a3ef(0xf79)](_0x27a3ef(0x1177),()=>{const _0x23aff5=_0x27a3ef,_0x3e10aa=_0x1935eb[_0x23aff5(0x589)][_0x23aff5(0x701)]===_0x23aff5(0x5b1);_0x1935eb['style'][_0x23aff5(0x701)]=_0x3e10aa?_0x23aff5(0x13f7):'none',_0x50d29a[_0x23aff5(0x15f)]=_0x3e10aa?'收起':'展开';}),_0x5bb6c3;}async function _0x4bff1f(){const _0x10a7fe=_0x475790;await _0x12f19b(),document['querySelector'](_0x10a7fe(0xabd))[_0x10a7fe(0x15f)]=_0x10a7fe(0xe2f),document[_0x10a7fe(0x2ec)](_0x10a7fe(0x124d))['onclick']=_0x31bc00,document['getElementById']('existing-groups-list')['onclick']=_0x170a7d=>{const _0x495183=_0x10a7fe;_0x170a7d['target'][_0x495183(0xff6)][_0x495183(0xe9a)](_0x495183(0x1d2))&&_0x4ed224(parseInt(_0x170a7d[_0x495183(0x1104)][_0x495183(0xe93)]['id']));},document[_0x10a7fe(0x2ec)]('close-group-manager-btn')['onclick']=()=>{const _0x5310be=_0x10a7fe;document[_0x5310be(0x2ec)](_0x5310be(0x1158))['classList'][_0x5310be(0x1424)](_0x5310be(0x149d)),_0x2ed701();},document['getElementById'](_0x10a7fe(0x1158))['classList'][_0x10a7fe(0xe82)](_0x10a7fe(0x149d));}async function _0x12f19b(){const _0x1700e0=_0x475790,_0x47604d=document[_0x1700e0(0x2ec)]('existing-groups-list'),_0x14492d=await _0x5b9d83[_0x1700e0(0x2f1)][_0x1700e0(0x14b5)]();_0x47604d[_0x1700e0(0xc43)]='',_0x14492d[_0x1700e0(0x9a1)]===0x0&&(_0x47604d['innerHTML']='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>'),_0x14492d['forEach'](_0x1fb5ad=>{const _0x16785e=_0x1700e0,_0x254c61=document[_0x16785e(0x14ae)](_0x16785e(0xaa5));_0x254c61[_0x16785e(0xdd1)]=_0x16785e(0xe3c),_0x254c61[_0x16785e(0xc43)]=_0x16785e(0xea8)+_0x1fb5ad['name']+'</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x1fb5ad['id']+'\x22>×</span>',_0x47604d[_0x16785e(0x998)](_0x254c61);});}async function _0x31bc00(){const _0x46418d=_0x475790,_0x7e9763=document[_0x46418d(0x2ec)](_0x46418d(0xb60)),_0x461a7e=_0x7e9763[_0x46418d(0x11a4)][_0x46418d(0x97e)]();if(!_0x461a7e)return alert(_0x46418d(0x8d0));const _0x579c2f=await _0x5b9d83['presetCategories'][_0x46418d(0x67e)]('name')['equals'](_0x461a7e)[_0x46418d(0x942)]();if(_0x579c2f)return alert('分类\x20\x22'+_0x461a7e+_0x46418d(0xd64));await _0x5b9d83[_0x46418d(0x2f1)][_0x46418d(0xe82)]({'name':_0x461a7e}),_0x7e9763['value']='',await _0x12f19b();}async function _0x4ed224(_0x466080){const _0x2da00e=_0x475790,_0x4af914=await _0x4436ba(_0x2da00e(0x10d9),_0x2da00e(0xbbf),{'confirmButtonClass':_0x2da00e(0xd8f)});_0x4af914&&(await _0x5b9d83[_0x2da00e(0x2f1)][_0x2da00e(0x54b)](_0x466080),await _0x5b9d83[_0x2da00e(0x1504)][_0x2da00e(0x67e)]('categoryId')[_0x2da00e(0x129a)](_0x466080)[_0x2da00e(0xa88)]({'categoryId':null}),_0x28f30a['presets']=await _0x5b9d83[_0x2da00e(0x1504)][_0x2da00e(0x14b5)](),await _0x12f19b());}async function _0x5485a3(_0x14283d){const _0x547568=_0x475790,_0x4982ba=_0x14283d[_0x547568(0x1104)]['files'][0x0];if(!_0x4982ba)return;try{if(!_0x4982ba['name'][_0x547568(0xa64)]('.json'))throw new Error(_0x547568(0x134f));const _0x1b6b6c=await _0x4982ba[_0x547568(0x10ca)](),_0x1e5e88=JSON[_0x547568(0xd91)](_0x1b6b6c);await _0x17eb14(_0x1e5e88,_0x4982ba[_0x547568(0xe36)]);}catch(_0x3bd205){console[_0x547568(0x1518)](_0x547568(0x345),_0x3bd205),await _0x34d596(_0x547568(0x493),_0x547568(0x182)+_0x3bd205[_0x547568(0x13bc)]);}finally{_0x14283d[_0x547568(0x1104)][_0x547568(0x11a4)]=null;}}async function _0x17eb14(_0x4fe4fc,_0x22fe29){const _0xeb0d01=_0x475790;let _0x45203c=[];if(Array[_0xeb0d01(0x624)](_0x4fe4fc[_0xeb0d01(0x905)])&&Array[_0xeb0d01(0x624)](_0x4fe4fc[_0xeb0d01(0x6de)])&&_0x4fe4fc['prompt_order'][_0xeb0d01(0x9a1)]>0x0){console[_0xeb0d01(0x415)](_0xeb0d01(0x25c));const _0x59386b=new Map(_0x4fe4fc[_0xeb0d01(0x905)]['map'](_0x18d27e=>[_0x18d27e[_0xeb0d01(0x1095)],_0x18d27e])),_0x1ce27e=_0x4fe4fc['prompt_order'][_0xeb0d01(0xcdd)]((_0x37be9b,_0x5059e8)=>_0x5059e8[_0xeb0d01(0xe7e)]&&_0x5059e8[_0xeb0d01(0xe7e)][_0xeb0d01(0x9a1)]>(_0x37be9b[_0xeb0d01(0x9a1)]||0x0)?_0x5059e8[_0xeb0d01(0xe7e)]:_0x37be9b,[]);_0x1ce27e&&_0x1ce27e[_0xeb0d01(0x9a1)]>0x0&&(_0x45203c=_0x1ce27e['map'](_0x44b6a0=>{const _0x350a8a=_0xeb0d01,_0x1cd0e5=_0x59386b['get'](_0x44b6a0[_0x350a8a(0x1095)]);if(_0x1cd0e5)return{'keys':[],'comment':_0x1cd0e5[_0x350a8a(0xe36)]||_0x350a8a(0x10b6),'content':_0x1cd0e5['content']||'','enabled':_0x44b6a0[_0x350a8a(0x400)]};return null;})['filter'](Boolean));}else{if(_0x4fe4fc['entries']&&typeof _0x4fe4fc[_0xeb0d01(0x127b)]===_0xeb0d01(0x10c0))console[_0xeb0d01(0x415)]('检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。'),Array[_0xeb0d01(0x624)](_0x4fe4fc[_0xeb0d01(0xe7e)])?(console[_0xeb0d01(0x415)](_0xeb0d01(0x260)),_0x45203c=_0x4fe4fc[_0xeb0d01(0xe7e)][_0xeb0d01(0x11c6)](_0x19c5ff=>_0x4fe4fc[_0xeb0d01(0x127b)][_0x19c5ff])['filter'](Boolean)[_0xeb0d01(0x11c6)](_0x462c68=>({'keys':_0x462c68[_0xeb0d01(0x50e)]||[],'comment':_0x462c68[_0xeb0d01(0x70d)]||'无备注','content':_0x462c68['content']||'','enabled':!_0x462c68[_0xeb0d01(0x29f)]}))):(console[_0xeb0d01(0x664)](_0xeb0d01(0x10df)),_0x45203c=Object[_0xeb0d01(0x74e)](_0x4fe4fc[_0xeb0d01(0x127b)])[_0xeb0d01(0x11c6)](_0x36cc7b=>({'keys':_0x36cc7b[_0xeb0d01(0x50e)]||[],'comment':_0x36cc7b['comment']||_0xeb0d01(0x342),'content':_0x36cc7b[_0xeb0d01(0x1047)]||'','enabled':!_0x36cc7b['disable']})));else{if(Array[_0xeb0d01(0x624)](_0x4fe4fc[_0xeb0d01(0x905)]))console[_0xeb0d01(0x415)](_0xeb0d01(0x28e)),_0x45203c=_0x4fe4fc[_0xeb0d01(0x905)][_0xeb0d01(0x11c6)](_0x232e78=>({'keys':[],'comment':_0x232e78[_0xeb0d01(0xe36)]||_0xeb0d01(0x10b6),'content':_0x232e78[_0xeb0d01(0x1047)]||'','enabled':!![]}));else throw new Error(_0xeb0d01(0x592));}}_0x45203c=_0x45203c['filter'](_0x389456=>_0x389456['content']);if(_0x45203c[_0xeb0d01(0x9a1)]===0x0){alert(_0xeb0d01(0xfbf));return;}const _0x73d226=_0x22fe29[_0xeb0d01(0x13ed)](/\.json$/i,''),_0x131eaa=await _0x33419a(_0xeb0d01(0x12ef),_0xeb0d01(0x78d),_0x73d226);if(!_0x131eaa||!_0x131eaa[_0xeb0d01(0x97e)]()){alert(_0xeb0d01(0x9ed));return;}const _0x8f1acb={'id':_0xeb0d01(0xd4e)+Date[_0xeb0d01(0x487)](),'name':_0x131eaa[_0xeb0d01(0x97e)](),'content':_0x45203c,'categoryId':null};await _0x5b9d83[_0xeb0d01(0x1504)][_0xeb0d01(0xe82)](_0x8f1acb),_0x28f30a[_0xeb0d01(0x1504)][_0xeb0d01(0x367)](_0x8f1acb),await _0x2ed701(),await _0x34d596(_0xeb0d01(0x1110),_0xeb0d01(0x54f)+_0x131eaa+'》。');}async function _0x2bda92(_0x5c40dc){const _0x404ae8=_0x475790,_0x49e7a4=document[_0x404ae8(0x2ec)](_0x404ae8(0x1192));if(!_0x49e7a4)return;const _0x223e07=_0x28f30a[_0x404ae8(0x1504)]||[];_0x49e7a4[_0x404ae8(0xc43)]=_0x404ae8(0x7ae),_0x223e07[_0x404ae8(0xf99)](_0xa48bfb=>{const _0x3d4915=_0x404ae8,_0x3660db=document['createElement'](_0x3d4915(0x29d));_0x3660db['value']=_0xa48bfb['id'],_0x3660db[_0x3d4915(0x15f)]=_0xa48bfb[_0x3d4915(0xe36)],_0x49e7a4[_0x3d4915(0x998)](_0x3660db);}),_0x5c40dc[_0x404ae8(0x362)][_0x404ae8(0x1248)]&&(_0x49e7a4['value']=_0x5c40dc[_0x404ae8(0x362)][_0x404ae8(0x1248)]);}function _0x70c8dc(){const _0x5893ec=_0x475790,_0x32eb0d=document[_0x5893ec(0x2ec)](_0x5893ec(0x325));if(!_0x32eb0d)return;_0x32eb0d['innerHTML']='';let _0x48d802=_0x28f30a[_0x5893ec(0x1062)][_0x5893ec(0x128e)]||_0x3ec784;_0x48d802['forEach'](_0x32fc36=>{const _0x5d2945=_0x5893ec,_0xff19d2=document[_0x5d2945(0x2ec)](_0x32fc36);if(_0xff19d2){const _0x296f10=document[_0x5d2945(0x14ae)](_0x5d2945(0xaa5));_0x296f10[_0x5d2945(0xdd1)]=_0x5d2945(0x849),_0x296f10[_0x5d2945(0x3f5)]=!![],_0x296f10[_0x5d2945(0xe93)][_0x5d2945(0x3f3)]=_0x32fc36,_0x296f10[_0x5d2945(0xc43)]=_0xff19d2[_0x5d2945(0xc43)],_0x32eb0d[_0x5d2945(0x998)](_0x296f10);}});}function _0x31de81(){const _0x40e7fe=_0x475790,_0x4b7183=document[_0x40e7fe(0x2ec)](_0x40e7fe(0x325));if(!_0x4b7183)return;let _0x25594a=null;const _0x17ce14=_0x320e47=>{const _0x807a56=_0x40e7fe,_0x563841=_0x320e47[_0x807a56(0x1104)]['closest']('.draggable-button-item');if(!_0x563841)return;_0x25594a=_0x563841,_0x25594a['classList'][_0x807a56(0xe82)](_0x807a56(0x14fd));if(_0x320e47['cancelable'])_0x320e47[_0x807a56(0x10bd)]();},_0x572a4f=_0x72d71a=>{const _0xd4ba4d=_0x40e7fe;if(!_0x25594a)return;const _0x2b313f=_0x72d71a['type'][_0xd4ba4d(0x138a)]('mouse')?_0x72d71a[_0xd4ba4d(0xdad)]:_0x72d71a[_0xd4ba4d(0x5b2)][0x0]['clientX'],_0x18c6a8=_0x1a1804(_0x4b7183,_0x2b313f);_0x18c6a8==null?_0x4b7183[_0xd4ba4d(0x998)](_0x25594a):_0x4b7183[_0xd4ba4d(0x89e)](_0x25594a,_0x18c6a8);},_0x4bea0a=()=>{const _0x149b46=_0x40e7fe;if(!_0x25594a)return;_0x25594a[_0x149b46(0xff6)][_0x149b46(0x1424)](_0x149b46(0x14fd)),_0x25594a=null,_0x3817ef();};_0x4b7183[_0x40e7fe(0xf79)](_0x40e7fe(0xcfa),_0x17ce14),_0x4b7183['addEventListener']('touchstart',_0x17ce14,{'passive':![]}),_0x4b7183['addEventListener'](_0x40e7fe(0x6fa),_0x572a4f),_0x4b7183[_0x40e7fe(0xf79)]('touchmove',_0x572a4f,{'passive':![]}),_0x4b7183[_0x40e7fe(0xf79)]('mouseup',_0x4bea0a),_0x4b7183[_0x40e7fe(0xf79)](_0x40e7fe(0x79b),_0x4bea0a),_0x4b7183[_0x40e7fe(0xf79)]('touchend',_0x4bea0a);}function _0x1a1804(_0x7beee8,_0x37a901){const _0x174dc2=_0x475790,_0x53ce65=[..._0x7beee8[_0x174dc2(0x5d6)](_0x174dc2(0x648))];return _0x53ce65['reduce']((_0x5c23ec,_0x4dfa21)=>{const _0xa734c2=_0x174dc2,_0x2ab147=_0x4dfa21[_0xa734c2(0x410)](),_0x221971=_0x37a901-_0x2ab147['left']-_0x2ab147[_0xa734c2(0xeb4)]/0x2;return _0x221971<0x0&&_0x221971>_0x5c23ec['offset']?{'offset':_0x221971,'element':_0x4dfa21}:_0x5c23ec;},{'offset':Number[_0x174dc2(0x13ff)]})[_0x174dc2(0xd3a)];}async function _0x3817ef(){const _0x249da3=_0x475790,_0x5d7af8=document[_0x249da3(0x2ec)](_0x249da3(0x325)),_0x176066=Array[_0x249da3(0x13d1)](_0x5d7af8[_0x249da3(0x5d6)]('.draggable-button-item'))[_0x249da3(0x11c6)](_0x4e2e49=>_0x4e2e49[_0x249da3(0xe93)][_0x249da3(0x3f3)]);_0x28f30a[_0x249da3(0x1062)]['chatActionButtonsOrder']=_0x176066,await _0x5b9d83['globalSettings'][_0x249da3(0x7c3)](_0x28f30a[_0x249da3(0x1062)]);}function _0x470d5b(){const _0x3657b1=_0x475790,_0x12df80=_0x28f30a[_0x3657b1(0x1062)][_0x3657b1(0x128e)];if(!_0x12df80||!Array[_0x3657b1(0x624)](_0x12df80)||_0x12df80['length']===0x0)return;const _0x3a84e0=document[_0x3657b1(0x2ec)]('chat-input-actions-top');if(!_0x3a84e0)return;_0x12df80['forEach'](_0x43542d=>{const _0xc03544=_0x3657b1,_0xed7056=document[_0xc03544(0x2ec)](_0x43542d);_0xed7056&&_0x3a84e0[_0xc03544(0x998)](_0xed7056);});}const _0x3ec784=[_0x475790(0xc4a),_0x475790(0x29c),_0x475790(0x128f),'transfer-btn',_0x475790(0x293),_0x475790(0x1148),'video-call-btn',_0x475790(0x57e),_0x475790(0x1489),_0x475790(0x577),_0x475790(0x11bb),'gomoku-btn','open-shopping-btn','pat-btn','edit-last-response-btn',_0x475790(0x1447),_0x475790(0x4dd),'show-announcement-board-btn',_0x475790(0xe70),_0x475790(0xf5f),_0x475790(0x90f)];async function _0x15de31(){const _0x583659=_0x475790;_0x28f30a[_0x583659(0x1062)]['chatActionButtonsOrder']=null,await _0x5b9d83[_0x583659(0x1062)]['put'](_0x28f30a[_0x583659(0x1062)]),_0x70c8dc(),_0x470d5b(),await _0x34d596('成功',_0x583659(0x1118));}let _0x461efa=[],_0x3d47ba=[];function _0x39d4b2(){const _0x4158f1=_0x475790,_0xd60065=document[_0x4158f1(0x2ec)](_0x4158f1(0x12e7));_0x461efa=[],_0x3d47ba=[],_0x244d9f(),document[_0x4158f1(0x2ec)]('data-clear-step-1')[_0x4158f1(0x589)]['display']=_0x4158f1(0xc67),document[_0x4158f1(0x2ec)](_0x4158f1(0x10ac))[_0x4158f1(0x589)][_0x4158f1(0x701)]='none',_0xd60065['classList'][_0x4158f1(0xe82)](_0x4158f1(0x149d));}function _0x244d9f(){const _0xeaf499=_0x475790,_0x2cabfd=document[_0xeaf499(0x2ec)](_0xeaf499(0xc79));_0x2cabfd[_0xeaf499(0xc43)]='';const _0x50de95=document[_0xeaf499(0x14ae)]('div');_0x50de95[_0xeaf499(0xdd1)]='clear-posts-item',_0x50de95[_0xeaf499(0xe93)][_0xeaf499(0x152e)]='user',_0x50de95[_0xeaf499(0xc43)]=_0xeaf499(0x1312)+(_0x28f30a[_0xeaf499(0x1506)]['nickname']||'我')+_0xeaf499(0x442),_0x2cabfd[_0xeaf499(0x998)](_0x50de95),Object['values'](_0x28f30a[_0xeaf499(0x6ce)])[_0xeaf499(0xf99)](_0x1d9d5c=>{const _0x4d31b8=_0xeaf499;if(!_0x1d9d5c[_0x4d31b8(0x1423)]){const _0x1aa7e2=document[_0x4d31b8(0x14ae)](_0x4d31b8(0xaa5));_0x1aa7e2[_0x4d31b8(0xdd1)]=_0x4d31b8(0x10a9),_0x1aa7e2[_0x4d31b8(0xe93)]['charId']=_0x1d9d5c['id'],_0x1aa7e2[_0x4d31b8(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x1d9d5c[_0x4d31b8(0xe36)]+_0x4d31b8(0x1384),_0x2cabfd['appendChild'](_0x1aa7e2);}});}function _0x3206de(){const _0x362d31=_0x475790,_0x155f4a=document[_0x362d31(0x2ec)](_0x362d31(0xb85));_0x155f4a[_0x362d31(0xc43)]='';const _0x1c7817=[{'id':'chat','name':_0x362d31(0xe3f),'description':_0x362d31(0x1046)},{'id':_0x362d31(0x13fa),'name':'动态与互动','description':_0x362d31(0xa52)},{'id':_0x362d31(0xa3b),'name':_0x362d31(0x681),'description':'将清空选定角色的所有通话记录。'},{'id':_0x362d31(0xc40),'name':'心声','description':_0x362d31(0xc98)},{'id':_0x362d31(0xf49),'name':_0x362d31(0x1535),'description':_0x362d31(0x200)},{'id':_0x362d31(0x101f),'name':'收藏','description':_0x362d31(0x7cf)},{'id':_0x362d31(0xe1f),'name':_0x362d31(0x33f),'description':_0x362d31(0x10b5)}];_0x1c7817[_0x362d31(0xf99)](_0x53c8b4=>{const _0x4fe802=_0x362d31,_0x23e2d8=document[_0x4fe802(0x14ae)](_0x4fe802(0xaa5));_0x23e2d8[_0x4fe802(0xdd1)]=_0x4fe802(0x10a9),_0x23e2d8[_0x4fe802(0xe93)][_0x4fe802(0xf4a)]=_0x53c8b4['id'],_0x23e2d8[_0x4fe802(0xc43)]=_0x4fe802(0x93c)+_0x53c8b4[_0x4fe802(0xe36)]+_0x4fe802(0x1ed)+_0x53c8b4[_0x4fe802(0x9cc)]+_0x4fe802(0xaa3),_0x155f4a['appendChild'](_0x23e2d8);});}function _0x62d4d1(){const _0x1e3f91=_0x475790,_0x10b34a=document[_0x1e3f91(0x5d6)](_0x1e3f91(0x10d2));if(_0x10b34a[_0x1e3f91(0x9a1)]===0x0){alert(_0x1e3f91(0xfbb));return;}_0x461efa=Array[_0x1e3f91(0x13d1)](_0x10b34a)[_0x1e3f91(0x11c6)](_0x938aa4=>_0x938aa4[_0x1e3f91(0xe93)]['charId']),_0x3206de(),document[_0x1e3f91(0x2ec)]('data-clear-step-1')[_0x1e3f91(0x589)]['display']=_0x1e3f91(0x5b1),document['getElementById'](_0x1e3f91(0x10ac))[_0x1e3f91(0x589)]['display']=_0x1e3f91(0xc67);}function _0x53eb92(){const _0x370513=_0x475790;document['getElementById'](_0x370513(0x10ac))[_0x370513(0x589)][_0x370513(0x701)]=_0x370513(0x5b1),document[_0x370513(0x2ec)](_0x370513(0x621))[_0x370513(0x589)]['display']='flex',document[_0x370513(0x5d6)](_0x370513(0xae8))[_0x370513(0xf99)](_0x54208c=>{const _0x5b310d=_0x370513;_0x461efa[_0x5b310d(0x138a)](_0x54208c['dataset']['charId'])&&_0x54208c[_0x5b310d(0xff6)][_0x5b310d(0xe82)](_0x5b310d(0xba2));});}async function _0x29888d(){const _0x3aabf8=_0x475790,_0xb47890=document[_0x3aabf8(0x5d6)](_0x3aabf8(0x1171));if(_0xb47890[_0x3aabf8(0x9a1)]===0x0){alert(_0x3aabf8(0xddb));return;}_0x3d47ba=Array[_0x3aabf8(0x13d1)](_0xb47890)[_0x3aabf8(0x11c6)](_0xf1add0=>_0xf1add0['dataset'][_0x3aabf8(0xf4a)]);const _0x3c7392=await _0x4436ba(_0x3aabf8(0x11d0),_0x3aabf8(0xa22),{'confirmButtonClass':'btn-danger','confirmText':_0x3aabf8(0x10d9)});if(!_0x3c7392)return;await _0x34d596('请稍候...',_0x3aabf8(0x3e3));try{await _0x5b9d83[_0x3aabf8(0xe5b)]('rw',_0x5b9d83[_0x3aabf8(0x7ed)],async()=>{const _0x495f1d=_0x3aabf8;for(const _0x6938b4 of _0x461efa){for(const _0x59d6b6 of _0x3d47ba){if(_0x59d6b6===_0x495f1d(0x73b)){if(_0x6938b4===_0x495f1d(0xcc9)){const _0x26faa9=await _0x5b9d83[_0x495f1d(0x6ce)][_0x495f1d(0x14b5)]();for(const _0x26c3db of _0x26faa9){_0x26c3db[_0x495f1d(0x12c3)]=_0x26c3db[_0x495f1d(0x12c3)][_0x495f1d(0xebc)](_0x5f4935=>_0x5f4935[_0x495f1d(0x9be)]!==_0x495f1d(0xcc9)),await _0x5b9d83[_0x495f1d(0x6ce)]['put'](_0x26c3db);}}else{const _0x5ff9bc=await _0x5b9d83['chats'][_0x495f1d(0x6b5)](_0x6938b4);_0x5ff9bc&&(_0x5ff9bc['history']=[],_0x5ff9bc[_0x495f1d(0x28a)]=_0x495f1d(0x4e6),_0x5ff9bc[_0x495f1d(0xe97)]=_0x495f1d(0x4e6),Array[_0x495f1d(0x624)](_0x5ff9bc['nameHistory'])&&(_0x5ff9bc[_0x495f1d(0x316)]=[]),_0x5ff9bc[_0x495f1d(0x362)]&&(_0x5ff9bc[_0x495f1d(0x362)][_0x495f1d(0xa28)]='我'),await _0x5b9d83[_0x495f1d(0x6ce)][_0x495f1d(0x7c3)](_0x5ff9bc));}}if(_0x59d6b6===_0x495f1d(0x13fa)){const _0x4ac5e7=_0x6938b4===_0x495f1d(0xcc9)?'user':_0x6938b4;await _0x5b9d83['qzonePosts'][_0x495f1d(0x67e)](_0x495f1d(0xe87))[_0x495f1d(0x129a)](_0x4ac5e7)[_0x495f1d(0x54b)]();}_0x59d6b6===_0x495f1d(0xa3b)&&_0x6938b4!=='user'&&await _0x5b9d83['callRecords']['where'](_0x495f1d(0xdd0))[_0x495f1d(0x129a)](_0x6938b4)[_0x495f1d(0x54b)]();if(_0x59d6b6==='thoughts'&&_0x6938b4!=='user'){const _0x12e689=await _0x5b9d83['chats'][_0x495f1d(0x6b5)](_0x6938b4);_0x12e689&&(_0x12e689[_0x495f1d(0x2be)]=[],_0x12e689[_0x495f1d(0x28a)]=_0x495f1d(0x4e6),_0x12e689[_0x495f1d(0xe97)]='...',await _0x5b9d83[_0x495f1d(0x6ce)][_0x495f1d(0x7c3)](_0x12e689));}if(_0x59d6b6==='memories'&&_0x6938b4!=='user'){const _0x334388=await _0x5b9d83[_0x495f1d(0x6ce)]['get'](_0x6938b4);_0x334388&&(_0x334388['longTermMemory']=[],await _0x5b9d83['chats'][_0x495f1d(0x7c3)](_0x334388));}_0x59d6b6===_0x495f1d(0x101f)&&(_0x6938b4===_0x495f1d(0xcc9)?(await _0x5b9d83[_0x495f1d(0x101f)][_0x495f1d(0x67e)](_0x495f1d(0xb4b))[_0x495f1d(0x129a)]('qzone_post')[_0x495f1d(0xebc)](_0x45ec7a=>_0x45ec7a[_0x495f1d(0x1047)][_0x495f1d(0xe87)]==='user')['delete'](),await _0x5b9d83[_0x495f1d(0x101f)][_0x495f1d(0x67e)]('type')[_0x495f1d(0x129a)](_0x495f1d(0xfec))[_0x495f1d(0xebc)](_0x532950=>_0x532950[_0x495f1d(0x1047)]['role']===_0x495f1d(0xcc9))[_0x495f1d(0x54b)]()):(await _0x5b9d83[_0x495f1d(0x101f)]['where'](_0x495f1d(0xb4b))[_0x495f1d(0x129a)](_0x495f1d(0xfec))[_0x495f1d(0x79f)](_0x4277af=>_0x4277af[_0x495f1d(0xdd0)]===_0x6938b4)[_0x495f1d(0x54b)](),await _0x5b9d83[_0x495f1d(0x101f)][_0x495f1d(0x67e)](_0x495f1d(0xb4b))['equals'](_0x495f1d(0x9eb))[_0x495f1d(0xebc)](_0x4614d0=>_0x4614d0[_0x495f1d(0x1047)]['authorId']===_0x6938b4)[_0x495f1d(0x54b)](),await _0x5b9d83[_0x495f1d(0x101f)][_0x495f1d(0x67e)](_0x495f1d(0xb4b))['equals'](_0x495f1d(0x1278))['filter'](_0x281560=>_0x281560[_0x495f1d(0x1047)][_0x495f1d(0x1061)]===_0x6938b4)[_0x495f1d(0x54b)](),await _0x5b9d83[_0x495f1d(0x101f)][_0x495f1d(0x67e)]('type')['equals']('char_browser_article')[_0x495f1d(0xebc)](_0x23b9b3=>_0x23b9b3[_0x495f1d(0x1047)][_0x495f1d(0x1061)]===_0x6938b4)[_0x495f1d(0x54b)](),await _0x5b9d83[_0x495f1d(0x101f)][_0x495f1d(0x67e)](_0x495f1d(0xb4b))[_0x495f1d(0x129a)]('char_memo')['filter'](_0x2c643b=>_0x2c643b[_0x495f1d(0x1047)][_0x495f1d(0x1061)]===_0x6938b4)[_0x495f1d(0x54b)]()));if(_0x59d6b6===_0x495f1d(0xe1f)&&_0x6938b4!==_0x495f1d(0xcc9)){const _0x15cbed=await _0x5b9d83['chats']['get'](_0x6938b4);_0x15cbed&&(_0x15cbed['simulatedAlbum']=[],_0x15cbed[_0x495f1d(0x1400)]=[],_0x15cbed['simulatedBrowserHistory']=[],_0x15cbed[_0x495f1d(0x14e8)]=null,_0x15cbed[_0x495f1d(0x1015)]=[],_0x15cbed[_0x495f1d(0x4d4)]=[],_0x15cbed[_0x495f1d(0xdab)]=[],_0x15cbed[_0x495f1d(0x1564)]=[],_0x15cbed['memos']=[],await _0x5b9d83[_0x495f1d(0x6ce)][_0x495f1d(0x7c3)](_0x15cbed));}}}}),await _0x15e928(),await _0x5db8a3(),document[_0x3aabf8(0x2ec)](_0x3aabf8(0x12e7))['classList'][_0x3aabf8(0x1424)](_0x3aabf8(0x149d)),await _0x34d596(_0x3aabf8(0x8ed),_0x3aabf8(0x10ec));}catch(_0x28b510){console['error'](_0x3aabf8(0xfe8),_0x28b510),await _0x34d596(_0x3aabf8(0x91a),_0x3aabf8(0x470)+_0x28b510[_0x3aabf8(0x13bc)]);}}async function _0x2f298d(_0x2bb742,_0x57854b,_0x13d1c5){const _0x546908=_0x475790,_0x508ed3=_0x13d1c5['querySelector'](_0x546908(0x73c))['alt'],_0x550024=await _0x3d2f35(_0x546908(0x88a)+_0x508ed3+_0x546908(0x769),[{'text':'📁\x20从本地上传','value':'local'},{'text':_0x546908(0x1173),'value':'url'}]);let _0x521375=null;if(_0x550024===_0x546908(0x252))_0x521375=await _0x1fcca6();else{if(_0x550024===_0x546908(0x6d1)){const _0x47eb5e=_0x57854b===_0x546908(0xe1f)?_0x28f30a['globalSettings']['cphoneAppIcons'][_0x2bb742]:_0x28f30a[_0x546908(0x1062)][_0x546908(0x12e8)][_0x2bb742],_0x306a7e=_0x47eb5e['startsWith'](_0x546908(0x590)),_0x2467ac=_0x306a7e?'':_0x47eb5e;_0x521375=await _0x33419a(_0x546908(0x9b9),_0x546908(0xf16),_0x2467ac,_0x546908(0x6d1));}}if(_0x521375&&_0x521375['trim']()){const _0x54085e=_0x521375[_0x546908(0x97e)]();_0x57854b===_0x546908(0xe1f)?_0x28f30a[_0x546908(0x1062)][_0x546908(0x978)][_0x2bb742]=_0x54085e:_0x28f30a[_0x546908(0x1062)][_0x546908(0x12e8)][_0x2bb742]=_0x54085e,_0x13d1c5['querySelector']('.icon-preview')[_0x546908(0xce4)]=_0x54085e;}else _0x521375!==null&&alert(_0x546908(0xbdf));}async function _0x5154cc(){const _0x238178=_0x475790,_0xa34d24=await _0x4436ba(_0x238178(0xf76),_0x238178(0x11c1),{'confirmButtonClass':_0x238178(0xd8f),'confirmText':_0x238178(0xc9c)});if(!_0xa34d24)return;await _0x34d596(_0x238178(0x13e4),_0x238178(0x52c));let _0x208fff={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console[_0x238178(0x415)]('压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...');const _0x335140=[_0x238178(0x6ce),_0x238178(0x1062),'qzoneSettings',_0x238178(0xf28),'customAvatarFrames'],_0x5e50c6=[];for(const _0x3c3484 of _0x335140){const _0x5c5951=_0x5b9d83[_0x238178(0xd32)](_0x3c3484),_0x3bd3a4=await _0x5c5951[_0x238178(0x14b5)]();_0x5e50c6['push']({'tableName':_0x3c3484,'records':_0x3bd3a4});}console['log'](_0x238178(0x11a7));for(const _0x3a109e of _0x5e50c6){for(const _0x76abd7 of _0x3a109e['records']){await _0x3272cc(_0x76abd7,_0x208fff);}}console[_0x238178(0x415)](_0x238178(0x135c)),await _0x5b9d83[_0x238178(0xe5b)]('rw',_0x335140,async()=>{const _0x29e4f9=_0x238178;for(const _0x18d471 of _0x5e50c6){await _0x5b9d83[_0x29e4f9(0xd32)](_0x18d471['tableName'])[_0x29e4f9(0xdb2)](_0x18d471['records']);}});const _0x5c7f2e=_0x208fff['originalSize']-_0x208fff['newSize'],_0x59f775=_0x208fff[_0x238178(0xa1d)]>0x0?(_0x5c7f2e/_0x208fff[_0x238178(0xa1d)]*0x64)[_0x238178(0x5c3)](0x2):0x0;await _0x34d596(_0x238178(0x11e9),_0x238178(0xb46)+_0x208fff['found']+_0x238178(0xadf)+_0x208fff[_0x238178(0x5de)]+_0x238178(0x554)+_0x208fff['skipped']+_0x238178(0x1186)+(_0x5c7f2e/0x400/0x400)['toFixed'](0x2)+'\x20MB</strong>\x20(压缩率\x20'+_0x59f775+'%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。');}catch(_0x53d583){console[_0x238178(0x1518)](_0x238178(0x134e),_0x53d583),await _0x34d596('压缩失败','操作失败:\x20'+_0x53d583['message']);}}function _0x1963fb(_0x1ef97d,_0x2e5eb5=''){const _0x356b17=_0x475790;let _0x29718c=0x0;for(const _0x514fd in _0x1ef97d){if(_0x1ef97d['hasOwnProperty'](_0x514fd)){const _0x2efaf9=_0x1ef97d[_0x514fd];if(typeof _0x2efaf9===_0x356b17(0x863)&&_0x2efaf9[_0x356b17(0x741)](_0x356b17(0x590))){const _0x363bfe=_0x2e5eb5==='globalSettings'&&(_0x514fd===_0x356b17(0x638)||_0x514fd===_0x356b17(0x152d)||_0x514fd===_0x356b17(0x9b7))||_0x2e5eb5===_0x356b17(0x14f7)||_0x2e5eb5===_0x356b17(0x362)&&_0x514fd==='background'||(_0x2e5eb5===_0x356b17(0x12e8)||_0x2e5eb5===_0x356b17(0x978));!_0x363bfe&&(_0x29718c+=_0x2efaf9[_0x356b17(0x9a1)]);}else typeof _0x2efaf9===_0x356b17(0x10c0)&&_0x2efaf9!==null&&(_0x29718c+=_0x1963fb(_0x2efaf9,_0x514fd));}}return _0x29718c;}async function _0x99c946(){const _0x568776=_0x475790,_0x3c3d13=document[_0x568776(0x2ec)](_0x568776(0x86d));if(!_0x3c3d13)return;_0x3c3d13[_0x568776(0xc43)]=_0x568776(0xfaf);try{let _0x15c61a=0x0;const _0x3c5fa3=[_0x568776(0x6ce),_0x568776(0x1062),_0x568776(0x1506),'userStickers',_0x568776(0x1e9)];for(const _0x577d38 of _0x3c5fa3){const _0x4dd845=_0x5b9d83[_0x568776(0xd32)](_0x577d38);await _0x4dd845[_0x568776(0x13ce)](_0x289963=>{_0x15c61a+=_0x1963fb(_0x289963);});}const _0x398fcb=(_0x15c61a/0x400/0x400)['toFixed'](0x2);_0x3c3d13[_0x568776(0xc43)]=_0x568776(0x10a5)+_0x398fcb+_0x568776(0x12d3);}catch(_0x3811da){console['error'](_0x568776(0xb5f),_0x3811da),_0x3c3d13['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>计算图片大小时出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>Error</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function _0x3272cc(_0x26fce5,_0x4ac476,_0x4d78c1=''){const _0x135a90=_0x475790;for(const _0x5a8d94 in _0x26fce5){if(_0x26fce5[_0x135a90(0x1433)](_0x5a8d94)){const _0x33fa68=_0x26fce5[_0x5a8d94];if(typeof _0x33fa68===_0x135a90(0x863)&&_0x33fa68[_0x135a90(0x741)](_0x135a90(0x590))){const _0x52c8d2=_0x4d78c1===_0x135a90(0x1062)&&(_0x5a8d94===_0x135a90(0x638)||_0x5a8d94===_0x135a90(0x152d)||_0x5a8d94===_0x135a90(0x9b7))||_0x4d78c1===_0x135a90(0x14f7)||_0x4d78c1===_0x135a90(0x362)&&_0x5a8d94==='background'||(_0x4d78c1==='appIcons'||_0x4d78c1===_0x135a90(0x978));if(_0x52c8d2)continue;_0x4ac476['found']++,_0x4ac476['originalSize']+=_0x33fa68['length'];const _0x1e39da=await _0x302873(_0x33fa68);_0x1e39da&&_0x1e39da!==_0x33fa68?(_0x26fce5[_0x5a8d94]=_0x1e39da,_0x4ac476['compressed']++,_0x4ac476[_0x135a90(0xe0a)]+=_0x1e39da['length']):(_0x4ac476['skipped']++,_0x4ac476[_0x135a90(0xe0a)]+=_0x33fa68[_0x135a90(0x9a1)]);}else typeof _0x33fa68===_0x135a90(0x10c0)&&_0x33fa68!==null&&await _0x3272cc(_0x33fa68,_0x4ac476,_0x5a8d94);}}}async function _0x302873(_0x58ac0a){const _0x149006=_0x475790;if(!_0x58ac0a[_0x149006(0x741)](_0x149006(0x590)))return _0x58ac0a;try{const _0x34d30d=await(await fetch(_0x58ac0a))[_0x149006(0x465)](),_0x3140f7={'maxSizeMB':0.5,'maxWidthOrHeight':0x320,'useWebWorker':!![],'initialQuality':0.5,'fileType':'image/jpeg'};console[_0x149006(0x415)](_0x149006(0xbc0)+(_0x34d30d[_0x149006(0x2d2)]/0x400/0x400)['toFixed'](0x2)+_0x149006(0x576));const _0x497935=await imageCompression(_0x34d30d,_0x3140f7);return console[_0x149006(0x415)](_0x149006(0xc59)+(_0x497935['size']/0x400/0x400)['toFixed'](0x2)+_0x149006(0x576)),new Promise((_0x2e800b,_0x3819d7)=>{const _0x2781ce=_0x149006,_0xbf96e2=new FileReader();_0xbf96e2[_0x2781ce(0x3d6)]=()=>_0x2e800b(_0xbf96e2[_0x2781ce(0x42a)]),_0xbf96e2['onerror']=_0x3819d7,_0xbf96e2[_0x2781ce(0x60e)](_0x497935);});}catch(_0x1c53cd){return console[_0x149006(0x1518)](_0x149006(0x11e7),_0x1c53cd),_0x58ac0a;}}function _0x493055(_0x4d8e1d,_0x454b50){const _0x285d59=_0x475790;if(!_0x4d8e1d||!_0x454b50||typeof _0x4d8e1d!=='string'||typeof _0x454b50!==_0x285d59(0x863))return 0x0;const _0x5aa6ab=_0x4d8e1d[_0x285d59(0xa8a)]('.')['map'](Number),_0x5d1d33=_0x454b50[_0x285d59(0xa8a)]('.')['map'](Number),_0x1c02d9=Math[_0x285d59(0x7ac)](_0x5aa6ab[_0x285d59(0x9a1)],_0x5d1d33[_0x285d59(0x9a1)]);for(let _0x3ac1ec=0x0;_0x3ac1ec<_0x1c02d9;_0x3ac1ec++){const _0x926dc7=_0x5aa6ab[_0x3ac1ec]||0x0,_0x379eab=_0x5d1d33[_0x3ac1ec]||0x0;if(_0x926dc7>_0x379eab)return 0x1;if(_0x926dc7<_0x379eab)return-0x1;}return 0x0;}async function _0x3f13cc(){const _0xdaba0f=_0x475790,_0x44dbc7='1.0';try{const _0x10f3db=await fetch(_0xdaba0f(0x55c)+Date[_0xdaba0f(0x487)]());if(!_0x10f3db['ok']){console[_0xdaba0f(0x664)](_0xdaba0f(0x814));return;}const _0x3922cf=await _0x10f3db[_0xdaba0f(0x10ca)](),_0x10a66d=document[_0xdaba0f(0x14ae)]('div');_0x10a66d[_0xdaba0f(0xc43)]=_0x3922cf;const _0x16e83c=_0x10a66d['querySelector'](_0xdaba0f(0x13d5));if(!_0x16e83c){console['error'](_0xdaba0f(0x1090));return;}const _0x49f78f=_0x16e83c[_0xdaba0f(0xe93)][_0xdaba0f(0xc8f)],_0x4c3787=localStorage[_0xdaba0f(0x11c3)]('dismissedUpdateVersion');!_0x4c3787||_0x493055(_0x49f78f,_0x4c3787)>0x0?(console['log']('发现新版本通知:\x20'+_0x49f78f+'\x20(已忽略版本:\x20'+(_0x4c3787||'无')+')'),_0x10867a(_0x49f78f,_0x16e83c[_0xdaba0f(0xc43)])):console[_0xdaba0f(0x415)](_0xdaba0f(0xccc)+_0x49f78f+_0xdaba0f(0x145a));}catch(_0x5d9db9){console[_0xdaba0f(0x1518)](_0xdaba0f(0x141f),_0x5d9db9);}}function _0x10867a(_0x9a6497,_0x2f342f){const _0x4fcbde=_0x475790,_0xa7bc2a=document[_0x4fcbde(0x2ec)]('update-notice-modal'),_0x19d368=document[_0x4fcbde(0x2ec)](_0x4fcbde(0x704)),_0x5e29a6=document['getElementById'](_0x4fcbde(0x3a3)),_0x303d33=document['getElementById'](_0x4fcbde(0x1160));_0x19d368['innerHTML']=_0x2f342f,_0x5e29a6[_0x4fcbde(0x6b6)]=()=>{const _0x531805=_0x4fcbde;_0xa7bc2a[_0x531805(0xff6)][_0x531805(0x1424)](_0x531805(0x149d));},_0x303d33[_0x4fcbde(0x6b6)]=()=>{const _0x445312=_0x4fcbde;localStorage[_0x445312(0x1048)](_0x445312(0x148c),_0x9a6497),_0xa7bc2a[_0x445312(0xff6)][_0x445312(0x1424)](_0x445312(0x149d)),console[_0x445312(0x415)]('用户已忽略版本:\x20'+_0x9a6497);},_0xa7bc2a['classList'][_0x4fcbde(0xe82)](_0x4fcbde(0x149d));}function _0x44a2f8(){const _0xdba3e6=_0x475790,_0xba5d97=document[_0xdba3e6(0x2ec)](_0xdba3e6(0x1475));document[_0xdba3e6(0x2ec)](_0xdba3e6(0x110f))[_0xdba3e6(0x11a4)]=_0x28f30a[_0xdba3e6(0x1062)][_0xdba3e6(0x45c)]||0xc,document['getElementById'](_0xdba3e6(0x98d))[_0xdba3e6(0x11a4)]=_0x28f30a[_0xdba3e6(0x1062)][_0xdba3e6(0x170)]||0x14,_0xba5d97['classList'][_0xdba3e6(0xe82)]('visible');}async function _0x39a847(){const _0xdef82d=_0x475790,_0x3860d1=document[_0xdef82d(0x2ec)](_0xdef82d(0x110f)),_0x4d2e19=document['getElementById'](_0xdef82d(0x98d)),_0x4424bf=parseInt(_0x3860d1[_0xdef82d(0x11a4)]),_0x262953=parseInt(_0x4d2e19[_0xdef82d(0x11a4)]);if(isNaN(_0x4424bf)||isNaN(_0x262953)||_0x4424bf<0x1||_0x262953<0x1){alert(_0xdef82d(0x10f5));return;}if(_0x4424bf>_0x262953){alert('最小帖子数不能大于最大帖子数！');return;}_0x28f30a[_0xdef82d(0x1062)][_0xdef82d(0x45c)]=_0x4424bf,_0x28f30a[_0xdef82d(0x1062)][_0xdef82d(0x170)]=_0x262953,await _0x5b9d83[_0xdef82d(0x1062)][_0xdef82d(0x7c3)](_0x28f30a['globalSettings']),document[_0xdef82d(0x2ec)](_0xdef82d(0x1475))['classList'][_0xdef82d(0x1424)]('visible'),await _0x34d596(_0xdef82d(0x1dd),_0xdef82d(0xfdf));}async function _0x4c63d3(_0x50eb1a){const _0x4f292c=_0x475790,_0x4ce0b5=document[_0x4f292c(0x2ec)]('werewolf-lobby-modal'),_0x34a1ea=document[_0x4f292c(0x2ec)](_0x4f292c(0x3d5));_0x34a1ea[_0x4f292c(0xc43)]='';let _0x38b451=[];if(_0x50eb1a==='global'){const _0x40227d=Object[_0x4f292c(0x74e)](_0x28f30a[_0x4f292c(0x6ce)])[_0x4f292c(0xebc)](_0x121697=>!_0x121697[_0x4f292c(0x1423)]),_0x5bbeac=await _0x5b9d83[_0x4f292c(0x8f4)][_0x4f292c(0x14b5)]();_0x38b451=[{'id':'user','name':_0x28f30a[_0x4f292c(0x1506)]['nickname']||'我','originalName':_0x28f30a[_0x4f292c(0x1506)]['nickname']||'我','avatar':_0x28f30a[_0x4f292c(0x1506)][_0x4f292c(0x516)],'type':'user'},..._0x40227d[_0x4f292c(0x11c6)](_0x3b71cc=>({'id':_0x3b71cc['id'],'name':_0x3b71cc[_0x4f292c(0xe36)],'originalName':_0x3b71cc['originalName'],'avatar':_0x3b71cc['settings'][_0x4f292c(0xe91)],'type':_0x4f292c(0x8e7)})),..._0x5bbeac[_0x4f292c(0x11c6)](_0x40d977=>({'id':'npc_'+_0x40d977['id'],'name':_0x40d977[_0x4f292c(0xe36)],'originalName':_0x40d977['name'],'avatar':_0x40d977[_0x4f292c(0x516)],'type':_0x4f292c(0xcd0)}))],_0x5aea71[_0x4f292c(0xdd0)]=null;}else{const _0x15ca6d=_0x28f30a[_0x4f292c(0x6ce)][_0x28f30a['activeChatId']];if(!_0x15ca6d||!_0x15ca6d['isGroup'])return;_0x38b451=[{'id':'user','name':_0x15ca6d[_0x4f292c(0x362)][_0x4f292c(0xa28)]||'我','originalName':_0x28f30a[_0x4f292c(0x1506)]['nickname']||'我','avatar':_0x15ca6d[_0x4f292c(0x362)][_0x4f292c(0x10a3)],'type':_0x4f292c(0xcc9)},..._0x15ca6d[_0x4f292c(0x10f2)]['map'](_0x53d75d=>{const _0x5e729e=_0x4f292c,_0x4422db=_0x28f30a['chats'][_0x53d75d['id']],_0x3094d2=_0x53d75d[_0x5e729e(0x516)]||(_0x4422db?_0x4422db['settings'][_0x5e729e(0xe91)]:_0xd71c66);return{'id':_0x53d75d['id'],'name':_0x53d75d['groupNickname'],'originalName':_0x53d75d[_0x5e729e(0x66c)],'avatar':_0x3094d2,'type':_0x53d75d[_0x5e729e(0xe94)]?_0x5e729e(0xcd0):_0x5e729e(0x8e7)};})],_0x5aea71[_0x4f292c(0xdd0)]=_0x28f30a['activeChatId'];}_0x38b451[_0x4f292c(0xf99)](_0x5c7fc2=>{const _0x38adcb=_0x4f292c,_0x253cd7=document[_0x38adcb(0x14ae)](_0x38adcb(0xaa5));_0x253cd7[_0x38adcb(0xdd1)]=_0x38adcb(0x11c2),_0x253cd7[_0x38adcb(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27'+JSON[_0x38adcb(0xe4d)](_0x5c7fc2)+'\x27\x20'+(_0x5c7fc2[_0x38adcb(0xb4b)]===_0x38adcb(0xcc9)?_0x38adcb(0x12e6):_0x38adcb(0x13b8))+_0x38adcb(0xfb4)+_0x5c7fc2['avatar']+_0x38adcb(0xfc7)+_0x5c7fc2[_0x38adcb(0xe36)]+_0x38adcb(0xc69),_0x34a1ea[_0x38adcb(0x998)](_0x253cd7);}),_0x4ce0b5[_0x4f292c(0xff6)][_0x4f292c(0xe82)](_0x4f292c(0x149d));}async function _0x556473(){const _0x4fbda1=_0x475790,_0x12c4ad=document[_0x4fbda1(0x5d6)](_0x4fbda1(0x124e)),_0x5202fc=_0x12c4ad[_0x4fbda1(0x9a1)];let _0x4e2e4a=[];if(_0x5202fc===0x6)_0x5aea71[_0x4fbda1(0x3e6)]='6p',_0x4e2e4a=['狼人','狼人','平民','平民',_0x4fbda1(0x1063),'猎人'];else{if(_0x5202fc===0x9)_0x5aea71[_0x4fbda1(0x3e6)]='9p',_0x4e2e4a=['狼人','狼人','狼人','平民','平民','平民',_0x4fbda1(0x1063),'女巫','猎人'];else{if(_0x5202fc===0xc)_0x5aea71['gameMode']='12p',_0x4e2e4a=['狼人','狼人','狼人','狼人','平民','平民','平民','平民',_0x4fbda1(0x1063),'女巫','猎人','守卫'];else{alert(_0x4fbda1(0x2f4)+_0x5202fc+_0x4fbda1(0x40c));return;}}}document[_0x4fbda1(0x2ec)](_0x4fbda1(0xa36))['classList']['remove'](_0x4fbda1(0x149d)),await _0x34d596(_0x4fbda1(0x107b),'游戏即将开始，正在为各位玩家分配身份...');for(let _0x5b58a3=_0x4e2e4a['length']-0x1;_0x5b58a3>0x0;_0x5b58a3--){const _0x20169c=Math[_0x4fbda1(0x5f8)](Math['random']()*(_0x5b58a3+0x1));[_0x4e2e4a[_0x5b58a3],_0x4e2e4a[_0x20169c]]=[_0x4e2e4a[_0x20169c],_0x4e2e4a[_0x5b58a3]];}const _0x5da167=Array[_0x4fbda1(0x13d1)](_0x12c4ad)[_0x4fbda1(0x11c6)](_0x4de1b3=>JSON[_0x4fbda1(0xd91)](_0x4de1b3['dataset'][_0x4fbda1(0x355)]));_0x5aea71[_0x4fbda1(0x7f8)]=[];for(let _0x518665=0x0;_0x518665<_0x5da167[_0x4fbda1(0x9a1)];_0x518665++){const _0x1f2352=_0x5da167[_0x518665],_0x3ce46e=_0x4e2e4a[_0x518665];let _0x22ca07=_0x4fbda1(0x1508);if(_0x1f2352[_0x4fbda1(0xb4b)]==='character'){const _0x518b9c=_0x28f30a[_0x4fbda1(0x6ce)][_0x1f2352['id']];_0x22ca07=_0x518b9c?_0x518b9c[_0x4fbda1(0x362)][_0x4fbda1(0x67c)]:'未知设定的角色';}else{if(_0x1f2352['type']===_0x4fbda1(0xcd0)){const _0x261b7c=await _0x5b9d83[_0x4fbda1(0x8f4)][_0x4fbda1(0x14b5)](),_0x4ffa93=_0x261b7c[_0x4fbda1(0x412)](_0xa7bd04=>'npc_'+_0xa7bd04['id']===_0x1f2352['id']);_0x22ca07=_0x4ffa93?_0x4ffa93[_0x4fbda1(0xe32)]:_0x4fbda1(0x6aa);}else{if(_0x1f2352[_0x4fbda1(0xb4b)]===_0x4fbda1(0xcc9)){const _0x47b7da=_0x5aea71[_0x4fbda1(0xdd0)]?_0x28f30a[_0x4fbda1(0x6ce)][_0x5aea71[_0x4fbda1(0xdd0)]]:null;_0x22ca07=_0x47b7da?_0x47b7da['settings'][_0x4fbda1(0x1528)]:_0x4fbda1(0x91c);}}}const _0x558044={..._0x1f2352,'role':_0x3ce46e,'isAlive':!![],'character_persona':_0x22ca07};_0x3ce46e==='女巫'&&(_0x558044[_0x4fbda1(0x1be)]=![],_0x558044[_0x4fbda1(0x17d)]=![]),_0x3ce46e==='守卫'&&(_0x558044[_0x4fbda1(0x902)]=null),_0x5aea71[_0x4fbda1(0x7f8)][_0x4fbda1(0x367)](_0x558044);}_0x5aea71[_0x4fbda1(0xffc)]=!![],_0x5aea71[_0x4fbda1(0xe06)]=0x1,_0x5aea71[_0x4fbda1(0xa17)]='start',_0x5aea71['gameLog']=[],_0x5aea71[_0x4fbda1(0x132c)]=[];const _0x4bea70=_0x4e2e4a[_0x4fbda1(0xcdd)]((_0x38d69c,_0x309145)=>{return _0x38d69c[_0x309145]=(_0x38d69c[_0x309145]||0x0)+0x1,_0x38d69c;},{}),_0x105e2b=Object[_0x4fbda1(0x127b)](_0x4bea70)[_0x4fbda1(0x11c6)](([_0x6dbfe4,_0x1a312d])=>_0x6dbfe4+'\x20x'+_0x1a312d)['join']('、');_0x13846c(_0x4fbda1(0xaca)+_0x5202fc+_0x4fbda1(0x90d)+_0x105e2b+'。');const _0x5ee1e1=_0x5aea71[_0x4fbda1(0x7f8)][_0x4fbda1(0x412)](_0x1f2954=>_0x1f2954['id']==='user');_0x28fe1d(),_0x17ec27(_0x4fbda1(0x8b2)),_0x51ee1b(_0x5ee1e1[_0x4fbda1(0x9be)]);}function _0x28fe1d(){const _0xdb320c=_0x475790,_0x112829=document[_0xdb320c(0x2ec)]('werewolf-player-grid');_0x112829[_0xdb320c(0xc43)]='';const _0x5735ff=[..._0x5aea71['players']][_0xdb320c(0x126b)]((_0x2fd579,_0x1b6eb8)=>_0x2fd579['isAlive']-_0x1b6eb8[_0xdb320c(0x232)]);_0x5735ff['forEach']((_0x462cde,_0x5a2b51)=>{const _0x19283c=_0xdb320c,_0x288127=_0x5aea71[_0x19283c(0x7f8)]['findIndex'](_0x54fb86=>_0x54fb86['id']===_0x462cde['id'])+0x1,_0x1be0ce=document[_0x19283c(0x14ae)](_0x19283c(0xaa5));_0x1be0ce[_0x19283c(0xdd1)]=_0x19283c(0x30c);if(!_0x462cde[_0x19283c(0x232)])_0x1be0ce[_0x19283c(0xff6)]['add'](_0x19283c(0xa4a));_0x1be0ce[_0x19283c(0xc43)]=_0x19283c(0x152a)+_0x462cde[_0x19283c(0x516)]+_0x19283c(0x9d9)+_0x288127+'.\x20'+_0x462cde[_0x19283c(0xe36)]+_0x19283c(0xc69),_0x112829[_0x19283c(0x998)](_0x1be0ce);});const _0x194389=document[_0xdb320c(0x2ec)](_0xdb320c(0x10b1));_0x194389[_0xdb320c(0xc43)]='';for(let _0x58fb95=0x1;_0x58fb95<=_0x5aea71[_0xdb320c(0xe06)];_0x58fb95++){const _0x5aa0a5=[..._0x5aea71['gameLog'][_0xdb320c(0xebc)](_0x1046d2=>_0x1046d2[_0xdb320c(0x588)]===_0x58fb95),..._0x5aea71[_0xdb320c(0x132c)][_0xdb320c(0xebc)](_0x3ea182=>_0x3ea182['day']===_0x58fb95)][_0xdb320c(0x126b)]((_0x463bde,_0x2174e9)=>(_0x463bde[_0xdb320c(0x69a)]||0x0)-(_0x2174e9[_0xdb320c(0x69a)]||0x0));if(_0x5aa0a5[_0xdb320c(0x9a1)]>0x0){const _0x41b3d2=document['createElement'](_0xdb320c(0xaa5));_0x41b3d2[_0xdb320c(0xdd1)]=_0xdb320c(0x3ef),_0x41b3d2[_0xdb320c(0x15f)]=_0xdb320c(0xed1)+_0x58fb95+'\x20天\x20---',_0x41b3d2['style'][_0xdb320c(0x57a)]=_0xdb320c(0x2e9),_0x194389['appendChild'](_0x41b3d2),_0x5aa0a5[_0xdb320c(0xf99)](_0xb23c66=>{const _0x298ca9=_0xdb320c,_0x49d2ea=document[_0x298ca9(0x14ae)](_0x298ca9(0xaa5));_0x49d2ea[_0x298ca9(0xdd1)]=_0x298ca9(0x489)+_0xb23c66[_0x298ca9(0xb4b)],_0xb23c66[_0x298ca9(0xb4b)]===_0x298ca9(0x6c4)?_0x49d2ea[_0x298ca9(0xc43)]=_0x298ca9(0x949)+_0xb23c66['speaker']+':</span>\x20'+_0xb23c66[_0x298ca9(0x1047)]:_0x49d2ea['textContent']=_0xb23c66[_0x298ca9(0x1047)],_0x194389['appendChild'](_0x49d2ea);});}}_0x194389[_0xdb320c(0x12be)]=_0x194389[_0xdb320c(0x1ce)];const _0x20b476={'start':_0xdb320c(0x11ea),'night':'第'+_0x5aea71['currentDay']+_0xdb320c(0xd73),'day':'第'+_0x5aea71[_0xdb320c(0xe06)]+_0xdb320c(0x33d),'discussion':'第'+_0x5aea71[_0xdb320c(0xe06)]+_0xdb320c(0x262),'voting':'第'+_0x5aea71['currentDay']+_0xdb320c(0x2bc),'gameover':_0xdb320c(0x10c4)};document[_0xdb320c(0x2ec)](_0xdb320c(0x11f0))[_0xdb320c(0x15f)]=_0xdb320c(0x19e)+(_0x20b476[_0x5aea71[_0xdb320c(0xa17)]]||_0x5aea71['currentPhase']);}function _0x51ee1b(_0x328b23){const _0x565e1a=_0x475790,_0x161a8f={'狼人':_0x565e1a(0x109d),'平民':_0x565e1a(0xc3e),'预言家':_0x565e1a(0x585),'猎人':_0x565e1a(0x10bf),'女巫':_0x565e1a(0x7af),'守卫':'每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。'};document[_0x565e1a(0x2ec)]('werewolf-role-name')[_0x565e1a(0x15f)]=_0x328b23,document[_0x565e1a(0x2ec)]('werewolf-role-description')[_0x565e1a(0x15f)]=_0x161a8f[_0x328b23]||_0x565e1a(0x5a3),document['getElementById']('werewolf-role-modal')['classList']['add']('visible');}async function _0x321782(){const _0x11b4c5=_0x475790;_0x5aea71[_0x11b4c5(0xa17)]='第'+_0x5aea71[_0x11b4c5(0xe06)]+_0x11b4c5(0xd73),_0x5aea71[_0x11b4c5(0x8a1)]={},_0x13846c(_0x11b4c5(0xddd)),_0x28fe1d(),document['getElementById'](_0x11b4c5(0xc10))['style']['display']=_0x11b4c5(0x5b1),document['getElementById'](_0x11b4c5(0x371))['style'][_0x11b4c5(0x701)]=_0x11b4c5(0x5b1),await new Promise(_0x42e211=>setTimeout(_0x42e211,0x5dc));const _0x51a9ef=_0x5aea71['players'][_0x11b4c5(0x412)](_0xad5b05=>_0xad5b05[_0x11b4c5(0x9be)]==='守卫'&&_0xad5b05[_0x11b4c5(0x232)]);if(_0x51a9ef){_0x13846c(_0x11b4c5(0x1387)),_0x28fe1d();let _0x34715a=null;if(_0x51a9ef['id']===_0x11b4c5(0xcc9))_0x34715a=await _0x40d225(_0x11b4c5(0x10f0),_0x51a9ef[_0x11b4c5(0x902)]);else{const _0x564cde=_0x5aea71['players'][_0x11b4c5(0xebc)](_0x3bad5f=>_0x3bad5f[_0x11b4c5(0x232)]&&_0x3bad5f['id']!==_0x51a9ef[_0x11b4c5(0x902)]);_0x564cde[_0x11b4c5(0x9a1)]>0x0&&(_0x34715a=_0x564cde[Math[_0x11b4c5(0x5f8)](Math[_0x11b4c5(0x1337)]()*_0x564cde['length'])]['id']);}_0x34715a&&(_0x5aea71['nightActions']['guardedId']=_0x34715a,_0x51a9ef[_0x11b4c5(0x902)]=_0x34715a),_0x13846c('守卫已行动，守卫请闭眼。'),_0x28fe1d(),await new Promise(_0x4330e7=>setTimeout(_0x4330e7,0x5dc));}_0x13846c(_0x11b4c5(0xec7)),_0x28fe1d();const _0x29ba43=_0x5aea71['players']['filter'](_0x428d78=>_0x428d78[_0x11b4c5(0x9be)]==='狼人'&&_0x428d78[_0x11b4c5(0x232)]),_0x2810b8=_0x29ba43[_0x11b4c5(0x7e2)](_0x46773c=>_0x46773c['id']===_0x11b4c5(0xcc9));let _0x3dbf2b=null;_0x5aea71['lastFailedAction']='wolfKill';try{if(_0x2810b8)_0x13846c('你是狼人，请选择刀人目标。'),_0x28fe1d(),_0x3dbf2b=await _0x3a41e7();else{if(_0x5aea71[_0x11b4c5(0xe06)]===0x1){console['log'](_0x11b4c5(0x3b5));const _0x20f029=_0x5aea71[_0x11b4c5(0x7f8)]['filter'](_0x2046f3=>_0x2046f3[_0x11b4c5(0x232)]&&_0x2046f3[_0x11b4c5(0x9be)]!=='狼人');_0x20f029[_0x11b4c5(0x9a1)]>0x0&&(_0x3dbf2b=_0x20f029[Math['floor'](Math[_0x11b4c5(0x1337)]()*_0x20f029['length'])]['id']);}else _0x3dbf2b=await _0x44843f();}_0x5aea71['lastFailedAction']=null;}catch(_0x187007){console[_0x11b4c5(0x1518)](_0x11b4c5(0xbf5),_0x187007),await _0x34d596(_0x11b4c5(0x221),_0x11b4c5(0x743)),document[_0x11b4c5(0x2ec)](_0x11b4c5(0x371))[_0x11b4c5(0x589)]['display']=_0x11b4c5(0x13f7);return;}_0x5aea71[_0x11b4c5(0x8a1)][_0x11b4c5(0x1f8)]=_0x3dbf2b,_0x13846c(_0x11b4c5(0x9ee)),_0x28fe1d(),await new Promise(_0x58c92=>setTimeout(_0x58c92,0x5dc));const _0x4c9b26=_0x5aea71[_0x11b4c5(0x7f8)][_0x11b4c5(0x412)](_0xbaa81b=>_0xbaa81b[_0x11b4c5(0x9be)]==='女巫'&&_0xbaa81b['isAlive']);if(_0x4c9b26){_0x13846c(_0x11b4c5(0xf5b)),_0x28fe1d();const _0x59d089=_0x5aea71[_0x11b4c5(0x7f8)]['find'](_0x2be04b=>_0x2be04b['id']===_0x5aea71[_0x11b4c5(0x8a1)]['killedId']),_0x3def56=_0x5aea71[_0x11b4c5(0x8a1)]['guardedId']===_0x5aea71[_0x11b4c5(0x8a1)][_0x11b4c5(0x1f8)],_0x283532=_0x3def56||!_0x59d089?null:_0x59d089;if(_0x4c9b26['id']===_0x11b4c5(0xcc9)){let _0x21f1cd=await _0x103210(_0x283532,_0x4c9b26);_0x21f1cd[_0x11b4c5(0x42f)]&&(_0x5aea71[_0x11b4c5(0x8a1)][_0x11b4c5(0x131d)]=_0x5aea71[_0x11b4c5(0x8a1)][_0x11b4c5(0x1f8)],_0x4c9b26[_0x11b4c5(0x1be)]=!![]),_0x21f1cd['poison']&&(_0x5aea71[_0x11b4c5(0x8a1)][_0x11b4c5(0x1505)]=_0x21f1cd[_0x11b4c5(0x340)],_0x4c9b26['poisonUsed']=!![]);}else{if(!_0x4c9b26[_0x11b4c5(0x1be)]&&_0x283532){let _0x40964e=0x0;_0x5aea71['currentDay']===0x1?_0x40964e=0.3:_0x40964e=0.8,console[_0x11b4c5(0x415)]('AI女巫决策：今天是第'+_0x5aea71[_0x11b4c5(0xe06)]+'天，救人概率为\x20'+_0x40964e*0x64+'%'),Math[_0x11b4c5(0x1337)]()<_0x40964e?(console[_0x11b4c5(0x415)]('AI女巫决定使用解药！'),_0x5aea71[_0x11b4c5(0x8a1)][_0x11b4c5(0x131d)]=_0x5aea71[_0x11b4c5(0x8a1)][_0x11b4c5(0x1f8)],_0x4c9b26[_0x11b4c5(0x1be)]=!![]):console[_0x11b4c5(0x415)](_0x11b4c5(0x42e));}if(!_0x5aea71[_0x11b4c5(0x8a1)]['savedId']&&!_0x4c9b26[_0x11b4c5(0x17d)]&&Math[_0x11b4c5(0x1337)]()<0.5){const _0x4b04dd=_0x5aea71[_0x11b4c5(0x7f8)][_0x11b4c5(0xebc)](_0x29d54f=>_0x29d54f[_0x11b4c5(0x232)]&&_0x29d54f['id']!==_0x5aea71[_0x11b4c5(0x8a1)][_0x11b4c5(0x1f8)]);if(_0x4b04dd[_0x11b4c5(0x9a1)]>0x0){const _0x122def=_0x4b04dd[Math['floor'](Math[_0x11b4c5(0x1337)]()*_0x4b04dd[_0x11b4c5(0x9a1)])];_0x5aea71[_0x11b4c5(0x8a1)][_0x11b4c5(0x1505)]=_0x122def['id'],_0x4c9b26[_0x11b4c5(0x17d)]=!![],console['log'](_0x11b4c5(0xb83)+_0x122def['name']);}}}_0x13846c('女巫已行动，女巫请闭眼。'),_0x28fe1d(),await new Promise(_0xdf7f71=>setTimeout(_0xdf7f71,0x5dc));}const _0x5ec3c1=_0x5aea71[_0x11b4c5(0x7f8)][_0x11b4c5(0x412)](_0x5eb49a=>_0x5eb49a[_0x11b4c5(0x9be)]==='预言家'&&_0x5eb49a['isAlive']);if(_0x5ec3c1){_0x13846c(_0x11b4c5(0xf8b)),_0x28fe1d();if(_0x5ec3c1['id']===_0x11b4c5(0xcc9)){const _0x2ad57c=await _0x40d225('prophet'),_0xb7f4e1=_0x5aea71[_0x11b4c5(0x7f8)][_0x11b4c5(0x412)](_0x579bd9=>_0x579bd9['id']===_0x2ad57c);if(_0xb7f4e1){const _0x1bb888=_0xb7f4e1[_0x11b4c5(0x9be)]==='狼人';await _0x34d596(_0x11b4c5(0x7d4),'你查验的玩家\x20'+_0xb7f4e1['name']+_0x11b4c5(0xcd2)+(_0x1bb888?'狼人':'好人')),_0x5aea71[_0x11b4c5(0x8a1)][_0x11b4c5(0xd1e)]={'target':_0x2ad57c,'result':_0x1bb888?'狼人':'好人'};}}else{const _0x1708e7=_0x5aea71[_0x11b4c5(0x7f8)][_0x11b4c5(0xebc)](_0x57cac0=>_0x57cac0[_0x11b4c5(0x232)]&&_0x57cac0['id']!==_0x5ec3c1['id']);if(_0x1708e7['length']>0x0){const _0x330540=_0x1708e7[Math[_0x11b4c5(0x5f8)](Math['random']()*_0x1708e7[_0x11b4c5(0x9a1)])];_0x5aea71[_0x11b4c5(0x8a1)][_0x11b4c5(0xd1e)]={'target':_0x330540['id'],'result':_0x330540[_0x11b4c5(0x9be)]==='狼人'?'狼人':'好人'};}}_0x13846c(_0x11b4c5(0xfbd)),_0x28fe1d(),await new Promise(_0x45da79=>setTimeout(_0x45da79,0x5dc));}_0x137bbd();}async function _0x137bbd(){const _0x32897b=_0x475790;_0x5aea71[_0x32897b(0xa17)]='第'+_0x5aea71[_0x32897b(0xe06)]+'天\x20-\x20白天',_0x5aea71[_0x32897b(0xf9c)]={},_0x13846c(_0x32897b(0xc9b));const {killedId:_0x510eda,guardedId:_0x33d6a8,savedId:_0x46d97f,poisonedId:_0x6455c9}=_0x5aea71[_0x32897b(0x8a1)],_0x2732fc=new Set();_0x510eda&&_0x510eda!==_0x33d6a8&&_0x510eda!==_0x46d97f&&_0x2732fc[_0x32897b(0xe82)](_0x510eda);_0x6455c9&&_0x2732fc[_0x32897b(0xe82)](_0x6455c9);if(_0x2732fc[_0x32897b(0x2d2)]===0x0)_0x13846c(_0x32897b(0x1259));else for(const _0x3372df of _0x2732fc){const _0x3dd937=_0x5aea71[_0x32897b(0x7f8)]['find'](_0x8dabc0=>_0x8dabc0['id']===_0x3372df);if(_0x3dd937&&_0x3dd937['isAlive']){_0x3dd937[_0x32897b(0x232)]=![],_0x13846c(_0x32897b(0xd0f)+_0x3dd937[_0x32897b(0xe36)]+_0x32897b(0x105f));if(_0x3dd937[_0x32897b(0x9be)]==='猎人'){_0x13846c(_0x32897b(0x134d)),_0x28fe1d();let _0x430a2b=null;if(_0x3dd937['id']===_0x32897b(0xcc9))_0x430a2b=await _0x40d225('hunter');else{const _0x2d60bf=_0x5aea71['players']['filter'](_0x2752f2=>_0x2752f2[_0x32897b(0x232)]&&_0x2752f2['id']!==_0x3dd937['id']);_0x2d60bf[_0x32897b(0x9a1)]>0x0&&(_0x430a2b=_0x2d60bf[Math[_0x32897b(0x5f8)](Math[_0x32897b(0x1337)]()*_0x2d60bf[_0x32897b(0x9a1)])]['id']);}const _0x10a939=_0x5aea71[_0x32897b(0x7f8)]['find'](_0x31bf92=>_0x31bf92['id']===_0x430a2b);_0x10a939&&(_0x10a939[_0x32897b(0x232)]=![],_0x13846c(_0x32897b(0x14e6)+_0x10a939[_0x32897b(0xe36)]+'。'));}}}_0x28fe1d();if(_0x2ce980())return;await _0x1300de();}async function _0x1300de(){const _0x24d8d9=_0x475790;_0x13846c(_0x24d8d9(0x1c1)),_0x28fe1d();const {proxyUrl:_0x42e51f,apiKey:_0x544d42,model:_0x1f972b}=_0x28f30a[_0x24d8d9(0x1537)];if(!_0x42e51f||!_0x544d42||!_0x1f972b){alert(_0x24d8d9(0x626));return;}const _0x3aefad=_0x24ca67();_0x5aea71[_0x24d8d9(0x143f)]='startDiscussion';try{await _0x34d596(_0x24d8d9(0x999),_0x24d8d9(0x11e3));let _0x1665ff=_0x42e51f[_0x24d8d9(0x138a)](_0x24d8d9(0xe9c)),_0x461ef7=[{'role':_0x24d8d9(0xcc9),'content':_0x24d8d9(0x12b8)}],_0x60870a=_0x4fff3d(_0x1f972b,_0x544d42,_0x3aefad,_0x461ef7);const _0x4752e5=_0x1665ff?await fetch(_0x60870a['url'],_0x60870a[_0x24d8d9(0x1418)]):await fetch(_0x42e51f+_0x24d8d9(0x1427),{'method':_0x24d8d9(0x655),'headers':{'Content-Type':'application/json','Authorization':_0x24d8d9(0xe83)+_0x544d42},'body':JSON[_0x24d8d9(0xe4d)]({'model':_0x1f972b,'messages':[{'role':_0x24d8d9(0x10a7),'content':_0x3aefad},..._0x461ef7],'temperature':_0x28f30a[_0x24d8d9(0x1062)][_0x24d8d9(0x294)]||0.95})});if(!_0x4752e5['ok']){const _0x552ec0=await _0x4752e5[_0x24d8d9(0x12a2)]();throw new Error(_0x24d8d9(0xe6d)+_0x552ec0[_0x24d8d9(0x1518)][_0x24d8d9(0x13bc)]);}const _0x100d3d=await _0x4752e5['json'](),_0xe4499=getGeminiResponseText(_0x100d3d),_0x25c000=_0xe4499[_0x24d8d9(0x49a)](/(\[[\s\S]*\])/);if(!_0x25c000)throw new Error(_0x24d8d9(0x52d)+_0xe4499);const _0x8ceeae=JSON[_0x24d8d9(0xd91)](_0x25c000[0x0]);for(const _0x399cf3 of _0x8ceeae){_0x399cf3[_0x24d8d9(0x76c)]&&_0x399cf3['dialogue']&&(_0x5c0c86(_0x399cf3['speaker_name'],_0x399cf3[_0x24d8d9(0x6c4)]),_0x28fe1d(),await new Promise(_0x53dafb=>setTimeout(_0x53dafb,0x5dc+Math[_0x24d8d9(0x1337)]()*0x7d0)));}_0x5aea71['lastFailedAction']=null;}catch(_0x1ad763){console[_0x24d8d9(0x1518)]('狼人杀AI讨论生成失败:',_0x1ad763),await _0x34d596(_0x24d8d9(0xb7d),_0x24d8d9(0x1445)+_0x1ad763['message']),document[_0x24d8d9(0x2ec)](_0x24d8d9(0x371))['style'][_0x24d8d9(0x701)]=_0x24d8d9(0x13f7);return;}const _0x353af5=_0x5aea71[_0x24d8d9(0x7f8)][_0x24d8d9(0x412)](_0x45620f=>_0x45620f['id']==='user'),_0x377388=document[_0x24d8d9(0x2ec)](_0x24d8d9(0xc10)),_0x36090a=document[_0x24d8d9(0x2ec)]('werewolf-wait-reply-btn'),_0x1f3ee7=document[_0x24d8d9(0x2ec)](_0x24d8d9(0xd41)),_0x41dc38=document[_0x24d8d9(0x2ec)](_0x24d8d9(0x244));_0x377388[_0x24d8d9(0x589)][_0x24d8d9(0x701)]=_0x24d8d9(0xc67);if(_0x353af5&&_0x353af5[_0x24d8d9(0x232)]){_0x36090a['textContent']=_0x24d8d9(0x3a9),_0x1f3ee7[_0x24d8d9(0x15f)]=_0x24d8d9(0x59a),_0x36090a['style'][_0x24d8d9(0x701)]='block',_0x1f3ee7[_0x24d8d9(0x589)][_0x24d8d9(0x701)]='block',_0x41dc38['disabled']=![],_0x41dc38[_0x24d8d9(0xa0a)]=_0x24d8d9(0x1552),_0x41dc38['focus']();const _0x57f623=_0x36090a[_0x24d8d9(0x303)](!![]);_0x36090a[_0x24d8d9(0x1092)][_0x24d8d9(0x6ab)](_0x57f623,_0x36090a),_0x57f623[_0x24d8d9(0xf79)](_0x24d8d9(0x1177),_0x51afba);const _0x3f79a7=_0x1f3ee7[_0x24d8d9(0x303)](!![]);_0x1f3ee7[_0x24d8d9(0x1092)][_0x24d8d9(0x6ab)](_0x3f79a7,_0x1f3ee7),_0x3f79a7['addEventListener'](_0x24d8d9(0x1177),_0x1100ad);}else{_0x13846c(_0x24d8d9(0xe1c)),_0x28fe1d(),_0x36090a[_0x24d8d9(0x15f)]=_0x24d8d9(0x147b),_0x1f3ee7[_0x24d8d9(0x15f)]=_0x24d8d9(0xb44),_0x36090a[_0x24d8d9(0x589)]['display']=_0x24d8d9(0x13f7),_0x1f3ee7['style'][_0x24d8d9(0x701)]=_0x24d8d9(0x13f7),_0x41dc38[_0x24d8d9(0x1373)]=!![],_0x41dc38['placeholder']=_0x24d8d9(0xbe6);const _0x5a4154=_0x36090a['cloneNode'](!![]);_0x36090a[_0x24d8d9(0x1092)][_0x24d8d9(0x6ab)](_0x5a4154,_0x36090a),_0x5a4154[_0x24d8d9(0xf79)](_0x24d8d9(0x1177),_0xaac0cc);const _0x2df04e=_0x1f3ee7[_0x24d8d9(0x303)](!![]);_0x1f3ee7['parentNode'][_0x24d8d9(0x6ab)](_0x2df04e,_0x1f3ee7),_0x2df04e['addEventListener'](_0x24d8d9(0x1177),_0x5f5478);}}function _0x24ca67(){const _0x39dc40=_0x475790,_0x2e57d7=_0x5aea71[_0x39dc40(0x7f8)]['filter'](_0x3798de=>_0x3798de[_0x39dc40(0x232)]),_0xe88082=_0x5aea71[_0x39dc40(0x7f8)][_0x39dc40(0x412)](_0x1b019b=>_0x1b019b['id']==='user'),_0xf3a31b=_0xe88082?_0xe88082['name']:'用户',_0x4f6a89=_0x2e57d7[_0x39dc40(0x7e2)](_0x1abbed=>_0x1abbed['id']==='user');let _0x581957=_0x39dc40(0x888);_0x581957+=_0x39dc40(0x8f7),_0x2e57d7['forEach']((_0x1e8c5e,_0x127353)=>{const _0x3272a4=_0x39dc40,_0xbef3bc=_0x5aea71[_0x3272a4(0x7f8)][_0x3272a4(0x535)](_0xb7ac9a=>_0xb7ac9a['id']===_0x1e8c5e['id'])+0x1;let _0x4695d7='';const _0x1284a6=_0x28f30a[_0x3272a4(0x6ce)][_0x1e8c5e['id']];if(_0x1284a6){const _0x1588f7=_0x2e57d7['filter'](_0x1c90ea=>_0x1c90ea['id']!==_0x1e8c5e['id']&&_0x28f30a['chats'][_0x1c90ea['id']]&&_0x28f30a[_0x3272a4(0x6ce)][_0x1c90ea['id']][_0x3272a4(0x1542)]===_0x1284a6['groupId']&&_0x1284a6[_0x3272a4(0x1542)]!==null)['map'](_0x217c4e=>_0x217c4e['name'])[_0x3272a4(0xbad)]('、');_0x1588f7&&(_0x4695d7+=_0x3272a4(0x6c5)+_0x1588f7+_0x3272a4(0x860));}_0x1e8c5e['id']!=='user'&&(_0x4695d7+=_0x3272a4(0xd94)+_0xf3a31b+')的关系请参考你的人设、长期记忆和最近的对话。\x0a');_0x581957+=_0x3272a4(0xa2e)+_0xbef3bc+'号玩家:\x20'+_0x1e8c5e[_0x3272a4(0xe36)]+'\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20'+_0x1e8c5e[_0x3272a4(0x66c)]+_0x3272a4(0x383)+(_0x1e8c5e['id']===_0x3272a4(0xcc9)?'【用户\x20(User)】':_0x3272a4(0xee8))+_0x3272a4(0x7a5)+_0x1e8c5e['character_persona']+'\x0a';if(_0x1e8c5e[_0x3272a4(0xb4b)]===_0x3272a4(0x8e7)){const _0x1dc7bf=_0x28f30a[_0x3272a4(0x6ce)][_0x1e8c5e['id']];if(_0x1dc7bf&&_0x1dc7bf[_0x3272a4(0x153f)]&&_0x1dc7bf[_0x3272a4(0x153f)][_0x3272a4(0x9a1)]>0x0){const _0x10d38c=_0x1dc7bf[_0x3272a4(0x153f)]['map'](_0x48ce61=>_0x48ce61[_0x3272a4(0x1047)])[_0x3272a4(0xbad)](';\x20');_0x581957+=_0x3272a4(0x591)+_0x10d38c+'\x0a';}}_0x4695d7&&(_0x581957+=_0x3272a4(0xca5)+_0x4695d7);});let _0x5638ea=_0x39dc40(0x308);_0x5638ea+='这是所有玩家都能听到的【公开信息】。\x0a';const _0x26a57c=_0x5aea71['gameLog'][_0x39dc40(0xebc)](_0x22193a=>_0x22193a[_0x39dc40(0x1047)][_0x39dc40(0x138a)](_0x39dc40(0x1189))&&_0x22193a[_0x39dc40(0x588)]===_0x5aea71[_0x39dc40(0xe06)]);_0x26a57c[_0x39dc40(0x9a1)]===0x0?_0x5638ea+=_0x39dc40(0x7a0):_0x26a57c[_0x39dc40(0xf99)](_0x5dabd7=>{_0x5638ea+='-\x20'+_0x5dabd7['content']+'\x0a';});let _0x357ad6=_0x39dc40(0x7e4);if(_0x5aea71[_0x39dc40(0xe06)]>0x1)for(let _0x6e6929=0x1;_0x6e6929<_0x5aea71[_0x39dc40(0xe06)];_0x6e6929++){_0x357ad6+=_0x39dc40(0x1272)+_0x6e6929+_0x39dc40(0xf89);const _0x5ec311=_0x5aea71[_0x39dc40(0x986)][_0x39dc40(0xebc)](_0x161b61=>_0x161b61[_0x39dc40(0x588)]===_0x6e6929&&(_0x161b61[_0x39dc40(0x1047)]['includes']('死亡')||_0x161b61[_0x39dc40(0x1047)][_0x39dc40(0x138a)]('放逐')));_0x5ec311['length']>0x0?_0x357ad6+=_0x39dc40(0xfeb)+_0x5ec311[_0x39dc40(0x11c6)](_0x34c90b=>_0x34c90b[_0x39dc40(0x1047)])['join']('\x20')+'\x0a':_0x357ad6+=_0x39dc40(0xb38);const _0x26671a=_0x5aea71['discussionLog'][_0x39dc40(0xebc)](_0x3f89ec=>_0x3f89ec[_0x39dc40(0x588)]===_0x6e6929);_0x26671a['length']>0x0&&(_0x357ad6+=_0x39dc40(0x734)+_0x26671a[_0x39dc40(0x11c6)](_0x5017e2=>'-\x20'+_0x5017e2['speaker']+':\x20'+_0x5017e2[_0x39dc40(0x1047)])[_0x39dc40(0xbad)]('\x0a')+'\x0a');}else _0x357ad6+='(今天是第一天，没有历史记录)\x0a';let _0x1f4a9d='#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a';const _0x46c4a3=_0x5aea71[_0x39dc40(0x132c)][_0x39dc40(0xebc)](_0xe5c4dc=>_0xe5c4dc[_0x39dc40(0x588)]===_0x5aea71['currentDay']);_0x46c4a3['length']>0x0?_0x1f4a9d+=_0x46c4a3['map'](_0xf7f576=>_0x39dc40(0xa82)+_0xf7f576[_0x39dc40(0x115f)]+'**:\x20'+_0xf7f576['content'])['join']('\x0a'):_0x1f4a9d+=_0x39dc40(0xd0d);let _0x54a49d=_0x39dc40(0xbee);_0x2e57d7[_0x39dc40(0xf99)](_0x3deae3=>{const _0x1c119e=_0x39dc40;if(_0x3deae3['id']!==_0x1c119e(0xcc9)){const _0x21b242=_0x5aea71[_0x1c119e(0x7f8)][_0x1c119e(0x535)](_0x489b57=>_0x489b57['id']===_0x3deae3['id'])+0x1;_0x54a49d+=_0x1c119e(0x1f1)+_0x21b242+'号玩家:\x20'+_0x3deae3[_0x1c119e(0xe36)]+'\x20(本名:\x20'+_0x3deae3[_0x1c119e(0x66c)]+_0x1c119e(0x639)+_0x3deae3['role']+'】。\x0a2.\x20\x20**我掌握的秘密信息\x20(仅我可见)**:\x0a';let _0x5938b4='';if(_0x3deae3[_0x1c119e(0x9be)]==='狼人'){const _0x48fbc0=_0x5aea71[_0x1c119e(0x7f8)][_0x1c119e(0xebc)](_0x4a58d3=>_0x4a58d3[_0x1c119e(0x9be)]==='狼人'&&_0x4a58d3['id']!==_0x3deae3['id']&&_0x4a58d3[_0x1c119e(0x232)])[_0x1c119e(0x11c6)](_0x2b18ae=>_0x2b18ae[_0x1c119e(0xe36)])[_0x1c119e(0xbad)]('、');_0x5938b4+=_0x1c119e(0x255)+(_0x48fbc0||'无')+'\x0a';const _0x27ce01=_0x5aea71[_0x1c119e(0x7f8)][_0x1c119e(0x412)](_0xb6884=>_0xb6884['id']===_0x5aea71['nightActions'][_0x1c119e(0x1f8)]);_0x5938b4+=_0x1c119e(0x4c6)+(_0x27ce01?_0x27ce01[_0x1c119e(0xe36)]:'空刀')+'\x0a';}if(_0x3deae3[_0x1c119e(0x9be)]===_0x1c119e(0x1063)&&_0x5aea71[_0x1c119e(0x8a1)][_0x1c119e(0xd1e)]){const _0x2a881d=_0x5aea71[_0x1c119e(0x7f8)][_0x1c119e(0x412)](_0x174b0c=>_0x174b0c['id']===_0x5aea71[_0x1c119e(0x8a1)]['prophetCheck'][_0x1c119e(0x1104)]);_0x5938b4+='\x20\x20\x20\x20-\x20我昨晚查验了\x20'+_0x2a881d[_0x1c119e(0xe36)]+_0x1c119e(0x9bc)+_0x5aea71['nightActions']['prophetCheck'][_0x1c119e(0x42a)]+'】\x0a';}if(_0x3deae3[_0x1c119e(0x9be)]==='女巫'){if(_0x5aea71[_0x1c119e(0x8a1)][_0x1c119e(0x131d)]){const _0x43e693=_0x5aea71[_0x1c119e(0x7f8)][_0x1c119e(0x412)](_0xb39068=>_0xb39068['id']===_0x5aea71[_0x1c119e(0x8a1)]['savedId']);_0x5938b4+='\x20\x20\x20\x20-\x20我昨晚用解药救了\x20'+_0x43e693[_0x1c119e(0xe36)]+'。\x0a';}if(_0x5aea71[_0x1c119e(0x8a1)][_0x1c119e(0x1505)]){const _0x411879=_0x5aea71[_0x1c119e(0x7f8)][_0x1c119e(0x412)](_0x567dd7=>_0x567dd7['id']===_0x5aea71[_0x1c119e(0x8a1)][_0x1c119e(0x1505)]);_0x5938b4+='\x20\x20\x20\x20-\x20我昨晚用毒药毒了\x20'+_0x411879[_0x1c119e(0xe36)]+'。\x0a';}_0x5938b4+=_0x1c119e(0x117b)+(_0x3deae3['antidoteUsed']?_0x1c119e(0x11e0):'未使用')+'\x0a',_0x5938b4+=_0x1c119e(0x12b2)+(_0x3deae3[_0x1c119e(0x17d)]?_0x1c119e(0x11e0):'未使用')+'\x0a';}if(_0x3deae3[_0x1c119e(0x9be)]==='守卫'){if(_0x5aea71[_0x1c119e(0x8a1)][_0x1c119e(0x1c8)]){const _0x30ede7=_0x5aea71[_0x1c119e(0x7f8)][_0x1c119e(0x412)](_0x210d18=>_0x210d18['id']===_0x5aea71[_0x1c119e(0x8a1)][_0x1c119e(0x1c8)]);_0x5938b4+=_0x1c119e(0xb31)+_0x30ede7[_0x1c119e(0xe36)]+'。\x0a';}else _0x5938b4+=_0x1c119e(0xad3);}_0x5938b4===''&&(_0x5938b4=_0x1c119e(0x1006));_0x54a49d+=_0x5938b4,_0x54a49d+='3.\x20\x20**我看到的公开信息\x20(所有人可见)**:\x0a\x20\x20\x20\x20-\x20**昨晚事件**:\x20'+_0x5638ea[_0x1c119e(0x13ed)](/\n/g,'\x20')+_0x1c119e(0x11aa)+_0x1f4a9d[_0x1c119e(0x13ed)](/\n/g,'\x20')+_0x1c119e(0xc2f)+_0x3deae3['character_persona']+'\x0a\x20\x20\x20\x20-\x20**社交**:\x20\x0a';let _0x4eb9e4='';const _0x35d0e5=_0x28f30a[_0x1c119e(0x6ce)][_0x3deae3['id']];if(_0x35d0e5){const _0x468535=_0x2e57d7['filter'](_0x13b1dc=>_0x13b1dc['id']!==_0x3deae3['id']&&_0x28f30a['chats'][_0x13b1dc['id']]&&_0x28f30a[_0x1c119e(0x6ce)][_0x13b1dc['id']][_0x1c119e(0x1542)]===_0x35d0e5[_0x1c119e(0x1542)]&&_0x35d0e5[_0x1c119e(0x1542)]!==null)[_0x1c119e(0x11c6)](_0x31068b=>_0x31068b[_0x1c119e(0xe36)])[_0x1c119e(0xbad)]('、');_0x468535&&(_0x4eb9e4+=_0x1c119e(0x1579)+_0x468535+_0x1c119e(0xa7f));}_0x3deae3['id']!==_0x1c119e(0xcc9)&&(_0x4eb9e4+=_0x1c119e(0x1579)+_0xf3a31b+'\x20是我的重要互动对象（用户）。\x0a'),_0x4eb9e4===''&&(_0x4eb9e4=_0x1c119e(0x11e5)),_0x54a49d+=_0x4eb9e4,_0x54a49d+=_0x1c119e(0xd59)+_0xf3a31b+_0x1c119e(0x2e5)+(_0x46c4a3[_0x1c119e(0x9a1)]>0x0?_0x1c119e(0x11a1):'昨晚的死讯')+_0x1c119e(0x13be)+_0xf3a31b+_0x1c119e(0x9b6)+_0xf3a31b+_0x1c119e(0x1328)+_0x3deae3[_0x1c119e(0x9be)]+_0x1c119e(0x2c4)+_0x3deae3[_0x1c119e(0xe99)][_0x1c119e(0xa6b)](0x0,0x14)+_0x1c119e(0x1b0);}}),_0x54a49d+=_0x39dc40(0x788);const _0x276f22=_0x39dc40(0x1ef)+(_0x4f6a89?_0x39dc40(0x145b)+_0xf3a31b+')':_0x39dc40(0x4ae)+_0xf3a31b+')')+_0x39dc40(0x13f4)+_0x581957+_0x39dc40(0x5a8)+(_0x5aea71['gameMode']===_0x39dc40(0x3ba)?_0x39dc40(0x67d):'屠城局：狼人杀死所有好人即获胜。')+'\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20'+_0x5aea71[_0x39dc40(0xe06)]+'\x20天的讨论环节。\x0a'+_0x5638ea+_0x39dc40(0x5ab)+_0x2e57d7[_0x39dc40(0x11c6)](_0x33ce0e=>_0x33ce0e[_0x39dc40(0xe36)]+'\x20('+(_0x33ce0e['id']==='user'?'用户':'AI')+')')[_0x39dc40(0xbad)](',\x20')+_0x39dc40(0x1364)+_0xf3a31b+'\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20'+_0x357ad6+_0x39dc40(0xd13)+_0x1f4a9d+'\x0a\x0a'+_0x54a49d+_0x39dc40(0x5c9);return _0x276f22;}function _0x26b9ef(_0x5c9628){const _0x3cf260=_0x475790;let _0x57d34c=_0x3cf260(0x1342);const _0x2a8f5b=_0x5c9628[_0x3cf260(0x986)][_0x3cf260(0x412)](_0x4740b5=>_0x4740b5[_0x3cf260(0x1047)][_0x3cf260(0x138a)]('胜利'))?.[_0x3cf260(0x1047)]||_0x3cf260(0xd11);_0x57d34c+='###\x20最终结果:\x20'+_0x2a8f5b+'\x0a\x0a',_0x57d34c+=_0x3cf260(0xabe),_0x5c9628[_0x3cf260(0x7f8)][_0x3cf260(0xf99)](_0x18bfac=>{const _0x42f5fd=_0x3cf260,_0x4e2c5a=_0x18bfac['isAlive']?'存活':_0x42f5fd(0x98a);_0x57d34c+='-\x20'+_0x18bfac[_0x42f5fd(0xe36)]+':\x20'+_0x18bfac[_0x42f5fd(0x9be)]+'\x20('+_0x4e2c5a+')\x0a';}),_0x57d34c+=_0x3cf260(0xb08);for(let _0xd39697=0x1;_0xd39697<=_0x5c9628[_0x3cf260(0xe06)];_0xd39697++){_0x57d34c+=_0x3cf260(0x1272)+_0xd39697+_0x3cf260(0xf89);const _0x3d3696=_0x5c9628[_0x3cf260(0x986)][_0x3cf260(0xebc)](_0x2c09c9=>_0x2c09c9[_0x3cf260(0x588)]===_0xd39697&&_0x2c09c9[_0x3cf260(0x1047)][_0x3cf260(0x138a)]('死亡'));if(_0x3d3696['length']>0x0)_0x57d34c+=_0x3cf260(0x9c1)+_0x3d3696[_0x3cf260(0x11c6)](_0x5b3369=>_0x5b3369[_0x3cf260(0x1047)])[_0x3cf260(0xbad)]('\x20')+'\x0a';else(_0xd39697>0x1||_0xd39697===0x1&&_0x5c9628[_0x3cf260(0xe06)]>0x1)&&(_0x57d34c+='**[夜晚]**\x20平安夜。\x0a');const _0x494d5e=_0x5c9628['discussionLog'][_0x3cf260(0xebc)](_0x184d76=>_0x184d76[_0x3cf260(0x588)]===_0xd39697);_0x494d5e['length']>0x0&&(_0x57d34c+=_0x3cf260(0x142d)+_0x494d5e['map'](_0x3ba56b=>'-\x20'+_0x3ba56b[_0x3cf260(0x115f)]+':\x20'+_0x3ba56b[_0x3cf260(0x1047)])['join']('\x0a')+'\x0a');const _0x14fd61=_0x5c9628[_0x3cf260(0x986)][_0x3cf260(0x412)](_0x27c98a=>_0x27c98a[_0x3cf260(0x588)]===_0xd39697&&_0x27c98a[_0x3cf260(0x1047)][_0x3cf260(0x138a)]('被投票放逐'));_0x14fd61&&(_0x57d34c+=_0x3cf260(0x70c)+_0x14fd61[_0x3cf260(0x1047)]+'\x0a');}return _0x57d34c+='\x0a---\x20复盘结束\x20---',_0x57d34c;}async function _0x47aca6(_0x45a637){const _0x5e7bb9=_0x475790;let _0x1bda8a=0x0;for(const _0x3533c1 of _0x5aea71[_0x5e7bb9(0x7f8)]){if(_0x3533c1[_0x5e7bb9(0xb4b)]==='character'){const _0x1a18b0=_0x28f30a[_0x5e7bb9(0x6ce)][_0x3533c1['id']];if(_0x1a18b0){const _0x1e7249={'content':_0x45a637,'timestamp':Date['now'](),'source':_0x5e7bb9(0x514)};!_0x1a18b0['longTermMemory']&&(_0x1a18b0['longTermMemory']=[]),_0x1a18b0[_0x5e7bb9(0x153f)][_0x5e7bb9(0x367)](_0x1e7249),await _0x5b9d83[_0x5e7bb9(0x6ce)]['put'](_0x1a18b0),_0x1bda8a++;}}}return _0x1bda8a;}async function _0x3499c3(){const _0x5cef99=_0x475790;if(!_0x5aea71[_0x5cef99(0xffc)]&&_0x5aea71['currentPhase']===_0x5cef99(0xbb8)){await _0x34d596('请稍候...',_0x5cef99(0x1345));try{const _0x5956e0=_0x26b9ef(_0x5aea71),_0x53a82c=await _0x47aca6(_0x5956e0);await _0x34d596('成功',_0x5cef99(0x23a)+_0x53a82c+_0x5cef99(0xfe2));}catch(_0x18989d){console[_0x5cef99(0x1518)]('手动注入狼人杀记忆失败:',_0x18989d),await _0x34d596('失败',_0x5cef99(0xe85)+_0x18989d['message']);}}else alert(_0x5cef99(0x13e6));}async function _0x20b7e5(_0x5ed2c6){const _0x2b2964=_0x475790;_0x5aea71[_0x2b2964(0xffc)]=![],_0x5aea71[_0x2b2964(0xa17)]=_0x2b2964(0xbb8),_0x13846c(_0x5ed2c6+_0x2b2964(0x241)),document[_0x2b2964(0x2ec)](_0x2b2964(0x520))['textContent']=_0x5ed2c6+_0x2b2964(0xad9);let _0x4e299e='';_0x5ed2c6==='好人'?_0x4e299e=_0x2b2964(0x1486):_0x4e299e=_0x2b2964(0x13ab);const _0x5a05cc=document[_0x2b2964(0x2ec)](_0x2b2964(0x11e4));_0x5a05cc[_0x2b2964(0x15f)]=_0x4e299e;const _0x805df9=document[_0x2b2964(0x2ec)](_0x2b2964(0x1386));_0x805df9['innerHTML']='';const _0x562df6=[..._0x5aea71[_0x2b2964(0x7f8)]][_0x2b2964(0x126b)]((_0x564ae8,_0x4f28e8)=>{const _0x4d68c9=_0x2b2964,_0x40f4b5=_0x5aea71['players'][_0x4d68c9(0x535)](_0x35a630=>_0x35a630['id']===_0x564ae8['id']),_0xa54861=_0x5aea71[_0x4d68c9(0x7f8)][_0x4d68c9(0x535)](_0x4ebca9=>_0x4ebca9['id']===_0x4f28e8['id']);return _0x40f4b5-_0xa54861;});_0x562df6[_0x2b2964(0xf99)]((_0x31da27,_0x37248f)=>{const _0x59e202=_0x2b2964,_0x575f5c=document[_0x59e202(0x14ae)](_0x59e202(0xaa5));_0x575f5c[_0x59e202(0x589)]['cssText']=_0x59e202(0xf7e);if(_0x37248f===_0x562df6[_0x59e202(0x9a1)]-0x1)_0x575f5c['style'][_0x59e202(0xf73)]='none';const _0x7e2ea=_0x31da27[_0x59e202(0x9be)]==='狼人'?_0x59e202(0x2e6):'#52c41a';_0x575f5c['innerHTML']=_0x59e202(0xdbe)+_0x31da27[_0x59e202(0x516)]+_0x59e202(0xa26)+(_0x31da27['isAlive']?_0x59e202(0x5b1):_0x59e202(0x268))+_0x59e202(0x134a)+(_0x31da27[_0x59e202(0x232)]?_0x59e202(0x5b1):_0x59e202(0x5e5))+_0x59e202(0xf58)+(_0x37248f+0x1)+'.\x20'+_0x31da27[_0x59e202(0xe36)]+_0x59e202(0x14bb)+_0x7e2ea+_0x59e202(0xf58)+_0x31da27['role']+_0x59e202(0x719),_0x805df9[_0x59e202(0x998)](_0x575f5c);}),document[_0x2b2964(0x2ec)](_0x2b2964(0xb5b))['classList'][_0x2b2964(0xe82)](_0x2b2964(0x149d));try{console[_0x2b2964(0x415)]('游戏结束，开始自动总结并注入记忆...');const _0x3ce9ba=_0x26b9ef(_0x5aea71),_0xdfced0=await generateAndInjectWerewolfMemories(_0x3ce9ba);console[_0x2b2964(0x415)]('狼人杀游戏总结已自动存入\x20'+_0xdfced0+_0x2b2964(0xd6e));}catch(_0x5e47be){console[_0x2b2964(0x1518)](_0x2b2964(0xb26),_0x5e47be),_0x5a05cc&&(_0x5a05cc['innerHTML']+='<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>');}}function _0x13846c(_0x5e8e3e){const _0x2d2387=_0x475790;_0x5aea71['gameLog'][_0x2d2387(0x367)]({'type':'system','content':_0x5e8e3e,'timestamp':Date['now'](),'day':_0x5aea71[_0x2d2387(0xe06)]});}function _0x5c0c86(_0xb768c1,_0x435894){const _0x4ee37c=_0x475790;_0x5aea71['discussionLog']['push']({'type':'dialogue','speaker':_0xb768c1,'content':_0x435894,'timestamp':Date['now'](),'day':_0x5aea71[_0x4ee37c(0xe06)]});}function _0x40d225(_0x16ec47){return new Promise(_0x2e1ac2=>{const _0x33b169=_0x1937,_0x1de43a='werewolf-'+_0x16ec47+_0x33b169(0x11b4),_0x210f4a=_0x33b169(0x127a)+_0x16ec47+'-selection-list';let _0x21bd1c='';if(_0x16ec47===_0x33b169(0xd7c))_0x21bd1c='confirm-prophet-check-btn';if(_0x16ec47===_0x33b169(0x955))_0x21bd1c=_0x33b169(0x11fd);if(_0x16ec47===_0x33b169(0x2e2))_0x21bd1c=_0x33b169(0xb61);const _0x255622=document[_0x33b169(0x2ec)](_0x1de43a),_0x185530=document[_0x33b169(0x2ec)](_0x210f4a),_0x1cbc22=document[_0x33b169(0x2ec)](_0x21bd1c);_0x185530[_0x33b169(0xc43)]='';let _0x242301=null;const _0x301c62=_0x5aea71[_0x33b169(0x7f8)][_0x33b169(0xebc)](_0x169a36=>_0x169a36[_0x33b169(0x232)]&&(_0x16ec47==='hunter'||_0x16ec47==='vote'||_0x169a36['id']!=='user'));_0x301c62[_0x33b169(0xf99)](_0x2c1757=>{const _0x37df34=_0x33b169,_0x2fd60d=document[_0x37df34(0x14ae)]('div');_0x2fd60d[_0x37df34(0xdd1)]=_0x37df34(0xec6),_0x2fd60d[_0x37df34(0xe93)]['id']=_0x2c1757['id'],_0x2fd60d['innerHTML']='<img\x20src=\x22'+_0x2c1757[_0x37df34(0x516)]+_0x37df34(0x24b)+_0x2c1757['name']+_0x37df34(0x718),_0x2fd60d[_0x37df34(0x6b6)]=()=>{const _0x1fc0d6=_0x37df34;_0x185530[_0x1fc0d6(0x5d6)](_0x1fc0d6(0x900))[_0x1fc0d6(0xf99)](_0x5b3932=>_0x5b3932[_0x1fc0d6(0xff6)]['remove']('selected')),_0x2fd60d[_0x1fc0d6(0xff6)][_0x1fc0d6(0xe82)]('selected'),_0x242301=_0x2c1757['id'];},_0x185530[_0x37df34(0x998)](_0x2fd60d);});const _0x333fcb=_0x1cbc22[_0x33b169(0x303)](!![]);_0x1cbc22[_0x33b169(0x1092)][_0x33b169(0x6ab)](_0x333fcb,_0x1cbc22),_0x333fcb[_0x33b169(0x6b6)]=()=>{const _0x35af7d=_0x33b169;_0x242301?(_0x255622['classList'][_0x35af7d(0x1424)](_0x35af7d(0x149d)),_0x2e1ac2(_0x242301)):alert(_0x35af7d(0xac8));},_0x255622[_0x33b169(0xff6)][_0x33b169(0xe82)]('visible');});}function _0x3a41e7(){return new Promise(_0x515072=>{const _0x1f30e4=_0x1937,_0x5b3508=document['getElementById'](_0x1f30e4(0x76f)),_0x11d8e3=document[_0x1f30e4(0x2ec)]('werewolf-kill-selection-list'),_0x4b4f71=document['getElementById'](_0x1f30e4(0xc5d)),_0x27a386=_0x5b3508['querySelector'](_0x1f30e4(0x3bf)),_0x4052c6=_0x5aea71[_0x1f30e4(0x7f8)][_0x1f30e4(0xebc)](_0x200383=>_0x200383[_0x1f30e4(0x9be)]==='狼人'&&_0x200383[_0x1f30e4(0x232)]),_0x3246d8=_0x4052c6[_0x1f30e4(0xebc)](_0x57bd7c=>_0x57bd7c['id']!==_0x1f30e4(0xcc9))[_0x1f30e4(0x11c6)](_0x27e658=>_0x27e658[_0x1f30e4(0xe36)])[_0x1f30e4(0xbad)]('、');_0x3246d8?_0x27a386[_0x1f30e4(0xc43)]=_0x1f30e4(0x724)+_0x3246d8+'</small>':_0x27a386[_0x1f30e4(0x15f)]=_0x1f30e4(0x12c8);_0x11d8e3[_0x1f30e4(0xc43)]='';let _0x1941d3=null;const _0x2a26db=_0x5aea71[_0x1f30e4(0x7f8)][_0x1f30e4(0xebc)](_0x265883=>_0x265883[_0x1f30e4(0x232)]&&_0x265883[_0x1f30e4(0x9be)]!=='狼人');_0x2a26db['forEach'](_0x2d6bce=>{const _0x17c864=_0x1f30e4,_0x1d5586=document[_0x17c864(0x14ae)](_0x17c864(0xaa5));_0x1d5586['className']=_0x17c864(0xec6),_0x1d5586[_0x17c864(0xe93)]['id']=_0x2d6bce['id'],_0x1d5586['innerHTML']=_0x17c864(0x416)+_0x2d6bce['avatar']+_0x17c864(0x24b)+_0x2d6bce[_0x17c864(0xe36)]+_0x17c864(0x718),_0x1d5586[_0x17c864(0x6b6)]=()=>{const _0x55ff62=_0x17c864;_0x11d8e3[_0x55ff62(0x5d6)](_0x55ff62(0x900))[_0x55ff62(0xf99)](_0x20b352=>_0x20b352['classList']['remove'](_0x55ff62(0xba2))),_0x1d5586[_0x55ff62(0xff6)][_0x55ff62(0xe82)](_0x55ff62(0xba2)),_0x1941d3=_0x2d6bce['id'];},_0x11d8e3['appendChild'](_0x1d5586);});const _0x33ecc3=_0x4b4f71[_0x1f30e4(0x303)](!![]);_0x4b4f71['parentNode'][_0x1f30e4(0x6ab)](_0x33ecc3,_0x4b4f71),_0x33ecc3['onclick']=()=>{const _0x21dddc=_0x1f30e4;_0x1941d3?(_0x5b3508['classList']['remove'](_0x21dddc(0x149d)),_0x515072(_0x1941d3)):alert(_0x21dddc(0xac8));},_0x5b3508[_0x1f30e4(0xff6)][_0x1f30e4(0xe82)](_0x1f30e4(0x149d));});}function _0x1100ad(){const _0xde90b1=_0x475790,_0x47acbc=_0x5aea71[_0xde90b1(0x7f8)][_0xde90b1(0x412)](_0x5a874a=>_0x5a874a['id']==='user');if(!_0x47acbc||!_0x47acbc[_0xde90b1(0x232)])return;const _0x1fb9c5=document[_0xde90b1(0x2ec)](_0xde90b1(0x244)),_0x240c67=_0x1fb9c5[_0xde90b1(0x11a4)][_0xde90b1(0x97e)]();_0x240c67&&(_0x5c0c86(_0x47acbc[_0xde90b1(0xe36)],_0x240c67),_0x28fe1d()),document[_0xde90b1(0x2ec)](_0xde90b1(0xc10))['style'][_0xde90b1(0x701)]=_0xde90b1(0x5b1),_0x1fb9c5[_0xde90b1(0x11a4)]='',_0x5f5478();}async function _0xaac0cc(){const _0x41bc95=_0x475790;_0x13846c(_0x41bc95(0x38c)),_0x28fe1d();const _0x3eb2bd=document['getElementById'](_0x41bc95(0x98f));if(_0x3eb2bd)_0x3eb2bd[_0x41bc95(0x1373)]=!![];await _0x34d596(_0x41bc95(0x999),_0x41bc95(0x14e4));const {proxyUrl:_0x3e160e,apiKey:_0xdceb44,model:_0x2e5c55}=_0x28f30a['apiConfig'];if(!_0x3e160e||!_0xdceb44||!_0x2e5c55){alert(_0x41bc95(0x626));return;}const _0x94ccf6=_0x24ca67();try{let _0x4e18b7=_0x3e160e[_0x41bc95(0x138a)](_0x41bc95(0xe9c)),_0x350642=[{'role':_0x41bc95(0xcc9),'content':_0x41bc95(0x38a)}],_0x5afa2b=_0x4fff3d(_0x2e5c55,_0xdceb44,_0x94ccf6,_0x350642);const _0x1832a9=_0x4e18b7?await fetch(_0x5afa2b['url'],_0x5afa2b[_0x41bc95(0x1418)]):await fetch(_0x3e160e+'/v1/chat/completions',{'method':_0x41bc95(0x655),'headers':{'Content-Type':_0x41bc95(0x1446),'Authorization':_0x41bc95(0xe83)+_0xdceb44},'body':JSON[_0x41bc95(0xe4d)]({'model':_0x2e5c55,'messages':[{'role':_0x41bc95(0x10a7),'content':_0x94ccf6},..._0x350642],'temperature':_0x28f30a[_0x41bc95(0x1062)]['apiTemperature']||0.9})});if(!_0x1832a9['ok']){const _0x49ea44=await _0x1832a9['json']();throw new Error(_0x41bc95(0xe6d)+_0x49ea44[_0x41bc95(0x1518)][_0x41bc95(0x13bc)]);}const _0x3f362d=await _0x1832a9[_0x41bc95(0x12a2)](),_0x12b04d=getGeminiResponseText(_0x3f362d),_0x3a2328=_0x12b04d[_0x41bc95(0x49a)](/(\[[\s\S]*\])/);if(!_0x3a2328)throw new Error(_0x41bc95(0xf15)+_0x12b04d);const _0x5b2e27=JSON['parse'](_0x3a2328[0x0]);for(const _0x2d2f6 of _0x5b2e27){_0x2d2f6[_0x41bc95(0x76c)]&&_0x2d2f6[_0x41bc95(0x6c4)]&&(_0x5c0c86(_0x2d2f6[_0x41bc95(0x76c)],_0x2d2f6[_0x41bc95(0x6c4)]),_0x28fe1d(),await new Promise(_0x544f0a=>setTimeout(_0x544f0a,0x5dc+Math[_0x41bc95(0x1337)]()*0x7d0)));}}catch(_0x4fe1d3){console['error'](_0x41bc95(0x271),_0x4fe1d3),await _0x34d596(_0x41bc95(0xb7d),'错误:\x20'+_0x4fe1d3[_0x41bc95(0x13bc)]);}finally{if(_0x3eb2bd)_0x3eb2bd[_0x41bc95(0x1373)]=![];}}async function _0x51afba(){const _0x1dcba2=_0x475790,_0x403bec=_0x5aea71[_0x1dcba2(0x7f8)][_0x1dcba2(0x412)](_0x3c7c88=>_0x3c7c88['id']===_0x1dcba2(0xcc9));if(!_0x403bec||!_0x403bec[_0x1dcba2(0x232)]){console[_0x1dcba2(0x664)]('handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。');return;}const _0x1208d2=document[_0x1dcba2(0x2ec)](_0x1dcba2(0x244)),_0x5720e4=_0x1208d2[_0x1dcba2(0x11a4)]['trim']();if(!_0x5720e4){alert(_0x1dcba2(0xbe4));return;}_0x5c0c86(_0x403bec['name'],_0x5720e4),_0x28fe1d(),_0x1208d2[_0x1dcba2(0x11a4)]='',await _0x34d596(_0x1dcba2(0x999),_0x1dcba2(0x1439));const {proxyUrl:_0x51bb53,apiKey:_0x2771ba,model:_0x309311}=_0x28f30a[_0x1dcba2(0x1537)];if(!_0x51bb53||!_0x2771ba||!_0x309311){alert(_0x1dcba2(0x626));return;}const _0x22788a=_0x24ca67();try{let _0x1884a4=_0x51bb53[_0x1dcba2(0x138a)](_0x1dcba2(0xe9c)),_0x5b3637=[{'role':'user','content':_0x1dcba2(0x1184)+_0x403bec['name']+_0x1dcba2(0x12fb)}],_0x15d5e7=_0x4fff3d(_0x309311,_0x2771ba,_0x22788a,_0x5b3637);const _0x26744e=_0x1884a4?await fetch(_0x15d5e7[_0x1dcba2(0x6d1)],_0x15d5e7[_0x1dcba2(0x1418)]):await fetch(_0x51bb53+_0x1dcba2(0x1427),{'method':_0x1dcba2(0x655),'headers':{'Content-Type':_0x1dcba2(0x1446),'Authorization':_0x1dcba2(0xe83)+_0x2771ba},'body':JSON[_0x1dcba2(0xe4d)]({'model':_0x309311,'messages':[{'role':_0x1dcba2(0x10a7),'content':_0x22788a},..._0x5b3637],'temperature':_0x28f30a[_0x1dcba2(0x1062)]['apiTemperature']||0.9})});if(!_0x26744e['ok']){const _0x11569b=await _0x26744e[_0x1dcba2(0x12a2)]();throw new Error(_0x1dcba2(0xe6d)+_0x11569b[_0x1dcba2(0x1518)][_0x1dcba2(0x13bc)]);}const _0x51593d=await _0x26744e[_0x1dcba2(0x12a2)](),_0x588079=getGeminiResponseText(_0x51593d);let _0xe0a8ee;try{let _0x208698=_0x588079[_0x1dcba2(0x13ed)](/^```json\s*/,'')['replace'](/```$/,'')[_0x1dcba2(0x97e)]();const _0x6ea6d5=_0x208698[_0x1dcba2(0x6d3)]('['),_0x5f528d=_0x208698[_0x1dcba2(0x3df)](']');if(_0x6ea6d5===-0x1||_0x5f528d===-0x1||_0x5f528d<_0x6ea6d5)throw new Error('AI返回的内容中未找到有效的JSON数组结构\x20(`[...]`)。');const _0x203f9b=_0x208698[_0x1dcba2(0xa6b)](_0x6ea6d5,_0x5f528d+0x1);_0xe0a8ee=JSON[_0x1dcba2(0xd91)](_0x203f9b);}catch(_0x3a1416){if(_0x3a1416[_0x1dcba2(0x13bc)]['includes'](_0x1dcba2(0x9db))){console[_0x1dcba2(0x664)](_0x1dcba2(0xe3a));const _0x4e4dfd=_0xb4d96d=>{const _0x1974cd=_0x1dcba2;let _0xe95c8c=![],_0x3bb4c0=![],_0x5b0eac='';for(let _0x21aae6=0x0;_0x21aae6<_0xb4d96d[_0x1974cd(0x9a1)];_0x21aae6++){const _0x626c99=_0xb4d96d[_0x21aae6];if(_0x3bb4c0){_0x5b0eac+=_0x626c99,_0x3bb4c0=![];continue;}if(_0x626c99==='\x5c'){_0x5b0eac+=_0x626c99,_0x3bb4c0=!![];continue;}if(_0x626c99==='\x22'){_0x5b0eac+=_0x626c99,_0xe95c8c=!_0xe95c8c;continue;}if(_0xe95c8c){if(_0x626c99==='\x0a')_0x5b0eac+='\x5cn';else{if(_0x626c99==='\x0d')_0x5b0eac+='\x5cr';else{if(_0x626c99==='\x09')_0x5b0eac+='\x5ct';else{if(_0x626c99[_0x1974cd(0xe26)](0x0)<0x20)continue;else _0x5b0eac+=_0x626c99;}}}}else _0x5b0eac+=_0x626c99;}return _0x5b0eac;};let _0x2d99e3=_0x588079['replace'](/^```json\s*/,'')[_0x1dcba2(0x13ed)](/```$/,'')[_0x1dcba2(0x97e)]();const _0x5012ab=_0x4e4dfd(_0x2d99e3),_0x15862c=_0x5012ab[_0x1dcba2(0x49a)](/(\[[\s\S]*\])/);if(!_0x15862c)throw new Error(_0x1dcba2(0xf4e));_0xe0a8ee=JSON[_0x1dcba2(0xd91)](_0x15862c[0x0]);}else throw new Error(_0x1dcba2(0x1044)+_0x3a1416[_0x1dcba2(0x13bc)]+_0x1dcba2(0x441)+_0x588079);}for(const _0xdf26c6 of _0xe0a8ee){_0xdf26c6[_0x1dcba2(0x76c)]&&_0xdf26c6[_0x1dcba2(0x6c4)]&&(_0x5c0c86(_0xdf26c6[_0x1dcba2(0x76c)],_0xdf26c6[_0x1dcba2(0x6c4)]),_0x28fe1d(),await new Promise(_0x32241f=>setTimeout(_0x32241f,0x5dc+Math[_0x1dcba2(0x1337)]()*0x7d0)));}}catch(_0x2ee05f){console[_0x1dcba2(0x1518)](_0x1dcba2(0x271),_0x2ee05f),await _0x34d596('AI\x20发言失败','错误:\x20'+_0x2ee05f[_0x1dcba2(0x13bc)]);}}async function _0x5f5478(){const _0x5c02ec=_0x475790;_0x13846c(_0x5c02ec(0xe86)),_0x28fe1d(),_0x5aea71[_0x5c02ec(0x7ba)]={};let _0x5af663=null;_0x5aea71[_0x5c02ec(0x143f)]=_0x5c02ec(0xc64);try{_0x5af663=await _0x5dba8f(),_0x5af663&&_0x5af663[_0x5c02ec(0xf99)](_0x11a5f7=>{const _0x52eb5c=_0x5c02ec,_0x34c7f0=_0x5aea71[_0x52eb5c(0x7f8)]['find'](_0x36c406=>_0x36c406['name']===_0x11a5f7[_0x52eb5c(0xc66)]),_0x5b9de2=_0x5aea71[_0x52eb5c(0x7f8)]['find'](_0x249d65=>_0x249d65[_0x52eb5c(0xe36)]===_0x11a5f7[_0x52eb5c(0x457)]);_0x34c7f0&&_0x34c7f0[_0x52eb5c(0x232)]&&_0x5b9de2&&(_0x5aea71['votes'][_0x34c7f0[_0x52eb5c(0xe36)]]=_0x5b9de2['name']);}),_0x5aea71[_0x5c02ec(0x143f)]=null;}catch(_0x5ec930){console[_0x5c02ec(0x1518)](_0x5c02ec(0x105b),_0x5ec930),await _0x34d596(_0x5c02ec(0x221),_0x5c02ec(0x121d)+_0x5ec930[_0x5c02ec(0x13bc)]),document[_0x5c02ec(0x2ec)](_0x5c02ec(0x371))['style'][_0x5c02ec(0x701)]='block';return;}const _0x476bac=_0x5aea71['players']['find'](_0x5933de=>_0x5933de['id']===_0x5c02ec(0xcc9));if(_0x476bac&&_0x476bac['isAlive']){_0x13846c(_0x5c02ec(0x1441)),_0x28fe1d();const _0x1ad95e=await _0x40d225('vote'),_0x5d8ebe=_0x5aea71[_0x5c02ec(0x7f8)][_0x5c02ec(0x412)](_0x40ebf7=>_0x40ebf7['id']===_0x1ad95e);_0x5d8ebe&&(_0x5aea71[_0x5c02ec(0x7ba)][_0x476bac['name']]=_0x5d8ebe[_0x5c02ec(0xe36)]);}_0x125707();}async function _0x5dba8f(){const _0x390c65=_0x475790,{proxyUrl:_0x4638b5,apiKey:_0x2a1863,model:_0x572c70}=_0x28f30a[_0x390c65(0x1537)];if(!_0x4638b5||!_0x2a1863||!_0x572c70)return null;const _0x1cf16a=_0x5aea71[_0x390c65(0x7f8)][_0x390c65(0xebc)](_0x2f153b=>_0x2f153b[_0x390c65(0x232)]&&_0x2f153b['id']!==_0x390c65(0xcc9)),_0x189a4c=_0x5aea71[_0x390c65(0x7f8)][_0x390c65(0xebc)](_0x14e3d6=>_0x14e3d6[_0x390c65(0x232)])[_0x390c65(0x11c6)](_0x24c6fb=>_0x24c6fb['name']);let _0xa84f38=_0x24ca67();_0xa84f38+=_0x390c65(0xc85)+_0x189a4c[_0x390c65(0xbad)](',\x20')+_0x390c65(0x72b);try{let _0x1627cf=_0x4638b5[_0x390c65(0x138a)](_0x390c65(0xe9c)),_0xd7dfa1=[{'role':'user','content':_0x390c65(0x332)}],_0x3ded08=_0x4fff3d(_0x572c70,_0x2a1863,_0xa84f38,_0xd7dfa1);const _0x6c4465=_0x1627cf?await fetch(_0x3ded08[_0x390c65(0x6d1)],_0x3ded08[_0x390c65(0x1418)]):await fetch(_0x4638b5+'/v1/chat/completions',{'method':_0x390c65(0x655),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x2a1863},'body':JSON['stringify']({'model':_0x572c70,'messages':[{'role':'system','content':_0xa84f38},..._0xd7dfa1],'temperature':_0x28f30a[_0x390c65(0x1062)][_0x390c65(0x294)]||0.8})});if(!_0x6c4465['ok'])throw new Error((await _0x6c4465['json']())[_0x390c65(0x1518)][_0x390c65(0x13bc)]);const _0x13317d=await _0x6c4465[_0x390c65(0x12a2)](),_0x2ff157=getGeminiResponseText(_0x13317d);let _0x39318d=_0x2ff157[_0x390c65(0x13ed)](/^```json\s*/,'')[_0x390c65(0x13ed)](/```$/,'')['trim']();const _0x129665=_0x39318d[_0x390c65(0x6d3)]('['),_0x24c56e=_0x39318d[_0x390c65(0x3df)](']');if(_0x129665===-0x1||_0x24c56e===-0x1||_0x24c56e<_0x129665)throw new Error('AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。');const _0x26f172=_0x39318d[_0x390c65(0xa6b)](_0x129665,_0x24c56e+0x1);try{const _0x2c192c=_0x26f172[_0x390c65(0x49a)](/(\[[\s\S]*?\])/g);if(_0x2c192c&&_0x2c192c['length']>0x0)return JSON[_0x390c65(0xd91)](_0x2c192c[_0x2c192c[_0x390c65(0x9a1)]-0x1]);return JSON['parse'](_0x26f172);}catch(_0x31cec4){throw new Error(_0x390c65(0x1290)+_0x31cec4[_0x390c65(0x13bc)]+_0x390c65(0x441)+_0x2ff157);}}catch(_0x1a3541){console[_0x390c65(0x1518)]('获取AI投票失败:',_0x1a3541);throw new Error(_0x390c65(0x13a7)+_0x1a3541['message']);}}function _0x125707(){const _0x344856=_0x475790,_0xe59678={},_0x460bb8={};for(const _0x53e0b0 in _0x5aea71[_0x344856(0x7ba)]){const _0x37ab33=_0x5aea71[_0x344856(0x7ba)][_0x53e0b0];_0xe59678[_0x37ab33]=(_0xe59678[_0x37ab33]||0x0)+0x1,!_0x460bb8[_0x37ab33]&&(_0x460bb8[_0x37ab33]=[]),_0x460bb8[_0x37ab33][_0x344856(0x367)](_0x53e0b0);}let _0x55151b=0x0,_0x2f4e96=[];for(const _0x29af92 in _0xe59678){const _0xb6a790=_0xe59678[_0x29af92];if(_0xb6a790>_0x55151b)_0x55151b=_0xb6a790,_0x2f4e96=[_0x29af92];else _0xb6a790===_0x55151b&&_0x2f4e96[_0x344856(0x367)](_0x29af92);}_0x13846c(_0x344856(0x12e3));for(const _0x48de5d in _0x460bb8){_0x13846c(_0x48de5d+'\x20('+_0x460bb8[_0x48de5d][_0x344856(0x9a1)]+_0x344856(0x5d3)+_0x460bb8[_0x48de5d]['join']('、\x20'));}if(_0x2f4e96[_0x344856(0x9a1)]===0x1&&_0x55151b>0x0){const _0x13bb64=_0x5aea71[_0x344856(0x7f8)][_0x344856(0x412)](_0x2580d1=>_0x2580d1[_0x344856(0xe36)]===_0x2f4e96[0x0]);if(_0x13bb64){_0x13bb64[_0x344856(0x232)]=![],_0x13846c(_0x13bb64[_0x344856(0xe36)]+_0x344856(0xb0d));if(_0x13bb64[_0x344856(0x9be)]==='猎人'){}}}else _0x13846c('平票或无人投票，此轮无人出局。');_0x28fe1d();if(_0x2ce980())return;_0x5aea71[_0x344856(0xe06)]++,_0x321782();}async function _0x44843f(){const _0x36d9ec=_0x475790,{proxyUrl:_0x13c013,apiKey:_0x555e5c,model:_0x35e277}=_0x28f30a[_0x36d9ec(0x1537)];if(!_0x13c013||!_0x555e5c||!_0x35e277)return null;const _0x5cdd82=_0x5aea71[_0x36d9ec(0x7f8)][_0x36d9ec(0xebc)](_0x3bd1f1=>_0x3bd1f1['role']==='狼人'&&_0x3bd1f1[_0x36d9ec(0x232)]),_0x1b4273=_0x5aea71[_0x36d9ec(0x7f8)][_0x36d9ec(0xebc)](_0x28f272=>_0x28f272[_0x36d9ec(0x232)]&&_0x28f272['role']!=='狼人'),_0x13f932='\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20'+_0x5cdd82[_0x36d9ec(0x11c6)](_0x5b402b=>_0x5b402b['name'])[_0x36d9ec(0xbad)]('、\x20')+_0x36d9ec(0x105a)+_0x1b4273['map'](_0x38156d=>_0x38156d[_0x36d9ec(0xe36)])[_0x36d9ec(0xbad)]('、\x20')+'\x0a-\x20**讨论摘要**:\x20\x0a'+_0x5aea71[_0x36d9ec(0x132c)][_0x36d9ec(0x11c6)](_0x31b3ca=>_0x31b3ca['speaker']+':\x20'+_0x31b3ca[_0x36d9ec(0x1047)])['join']('\x0a')+_0x36d9ec(0x101b);try{let _0x28e599=_0x13c013[_0x36d9ec(0x138a)](_0x36d9ec(0xe9c)),_0x491fa0=[{'role':_0x36d9ec(0xcc9),'content':_0x36d9ec(0x1a0)}],_0x568c22=_0x4fff3d(_0x35e277,_0x555e5c,_0x13f932,_0x491fa0);const _0x58b99b=_0x28e599?await fetch(_0x568c22[_0x36d9ec(0x6d1)],_0x568c22[_0x36d9ec(0x1418)]):await fetch(_0x13c013+_0x36d9ec(0x1427),{'method':_0x36d9ec(0x655),'headers':{'Content-Type':_0x36d9ec(0x1446),'Authorization':'Bearer\x20'+_0x555e5c},'body':JSON[_0x36d9ec(0xe4d)]({'model':_0x35e277,'messages':[{'role':_0x36d9ec(0x10a7),'content':_0x13f932},..._0x491fa0],'temperature':_0x28f30a['globalSettings'][_0x36d9ec(0x294)]||0.8})});if(!_0x58b99b['ok'])throw new Error((await _0x58b99b['json']())['error'][_0x36d9ec(0x13bc)]);const _0x5df2ba=await _0x58b99b['json'](),_0x21dd80=getGeminiResponseText(_0x5df2ba),_0x2bf008=_0x21dd80['match'](/({[\s\S]*})/);if(!_0x2bf008)throw new Error(_0x36d9ec(0x3ea));const _0x46fa8c=JSON['parse'](_0x2bf008[0x0]),_0x1d8a58=_0x5aea71[_0x36d9ec(0x7f8)][_0x36d9ec(0x412)](_0x4ca61d=>_0x4ca61d['name']===_0x46fa8c[_0x36d9ec(0x88f)]);return _0x1d8a58?_0x1d8a58['id']:null;}catch(_0x142da5){return console[_0x36d9ec(0x1518)](_0x36d9ec(0x3b1),_0x142da5),_0x1b4273[Math[_0x36d9ec(0x5f8)](Math['random']()*_0x1b4273[_0x36d9ec(0x9a1)])]['id'];}}function _0x103210(_0x456324,_0x2b4927){return new Promise(_0xdff028=>{const _0x11f7b5=_0x1937,_0x5da8f6=document[_0x11f7b5(0x2ec)](_0x11f7b5(0x961)),_0x13e1ef=document[_0x11f7b5(0x2ec)]('werewolf-witch-selection-list'),_0x678126=document[_0x11f7b5(0x2ec)]('witch-modal-title'),_0x5b61b5=document[_0x11f7b5(0x2ec)]('confirm-witch-poison-btn'),_0x33f04f=document['getElementById'](_0x11f7b5(0x4b8));_0x13e1ef[_0x11f7b5(0xc43)]='';const _0x36347b=_0x5b61b5['cloneNode'](!![]);_0x5b61b5['parentNode'][_0x11f7b5(0x6ab)](_0x36347b,_0x5b61b5);const _0x22d581=_0x33f04f[_0x11f7b5(0x303)](!![]);_0x33f04f['parentNode'][_0x11f7b5(0x6ab)](_0x22d581,_0x33f04f),_0x36347b[_0x11f7b5(0x589)][_0x11f7b5(0x701)]=_0x11f7b5(0x13f7),_0x36347b[_0x11f7b5(0x1373)]=!![];let _0x3ae418={'save':![],'poison':null},_0x5516f6=null;if(_0x456324&&!_0x2b4927[_0x11f7b5(0x1be)]){_0x678126[_0x11f7b5(0x15f)]=_0x11f7b5(0xd0f)+_0x456324[_0x11f7b5(0xe36)]+_0x11f7b5(0xf08);const _0x17caa4=document[_0x11f7b5(0x14ae)](_0x11f7b5(0xd5a));_0x17caa4[_0x11f7b5(0xdd1)]=_0x11f7b5(0x4a6),_0x17caa4['textContent']=_0x11f7b5(0x14e1),_0x17caa4[_0x11f7b5(0x589)][_0x11f7b5(0x212)]=_0x11f7b5(0x4a7),_0x17caa4['onclick']=()=>{const _0x26e6bd=_0x11f7b5;_0x3ae418[_0x26e6bd(0x42f)]=!![],_0x5da8f6[_0x26e6bd(0xff6)][_0x26e6bd(0x1424)](_0x26e6bd(0x149d)),_0xdff028(_0x3ae418);},_0x13e1ef[_0x11f7b5(0x998)](_0x17caa4);}else _0x456324?_0x678126['textContent']=_0x11f7b5(0xd0f)+_0x456324[_0x11f7b5(0xe36)]+_0x11f7b5(0x1490):_0x678126[_0x11f7b5(0x15f)]=_0x11f7b5(0x1221);if(!_0x2b4927[_0x11f7b5(0x17d)]){const _0x11f9a7=document[_0x11f7b5(0x14ae)]('p');_0x11f9a7[_0x11f7b5(0x15f)]=_0x11f7b5(0x733),_0x11f9a7[_0x11f7b5(0x589)][_0x11f7b5(0x1025)]=_0x11f7b5(0x40e),_0x11f9a7['style']['marginTop']=_0x11f7b5(0x4a7),_0x13e1ef[_0x11f7b5(0x998)](_0x11f9a7);const _0x3d9a27=_0x5aea71['players'][_0x11f7b5(0xebc)](_0x3a1ade=>_0x3a1ade[_0x11f7b5(0x232)]&&_0x3a1ade['id']!==_0x456324?.['id']);_0x3d9a27[_0x11f7b5(0xf99)](_0x3f11fb=>{const _0x3b0b43=_0x11f7b5,_0x551e28=document['createElement'](_0x3b0b43(0xaa5));_0x551e28['className']=_0x3b0b43(0xec6),_0x551e28[_0x3b0b43(0xe93)]['id']=_0x3f11fb['id'],_0x551e28['innerHTML']=_0x3b0b43(0x416)+_0x3f11fb[_0x3b0b43(0x516)]+_0x3b0b43(0x24b)+_0x3f11fb[_0x3b0b43(0xe36)]+_0x3b0b43(0x718),_0x551e28[_0x3b0b43(0x6b6)]=()=>{const _0x774f80=_0x3b0b43;_0x13e1ef[_0x774f80(0x5d6)]('.selected')[_0x774f80(0xf99)](_0x53e4bb=>_0x53e4bb[_0x774f80(0xff6)][_0x774f80(0x1424)]('selected')),_0x551e28['classList'][_0x774f80(0xe82)](_0x774f80(0xba2)),_0x5516f6=_0x3f11fb['id'],_0x36347b[_0x774f80(0x1373)]=![];},_0x13e1ef[_0x3b0b43(0x998)](_0x551e28);});}_0x36347b[_0x11f7b5(0x6b6)]=()=>{const _0x32188a=_0x11f7b5;_0x5516f6&&(_0x3ae418['poison']=_0x5516f6,_0x5da8f6[_0x32188a(0xff6)][_0x32188a(0x1424)](_0x32188a(0x149d)),_0xdff028(_0x3ae418));},_0x22d581[_0x11f7b5(0x6b6)]=()=>{const _0x5c653a=_0x11f7b5;_0x5da8f6[_0x5c653a(0xff6)][_0x5c653a(0x1424)](_0x5c653a(0x149d)),_0xdff028(_0x3ae418);},_0x5da8f6[_0x11f7b5(0xff6)][_0x11f7b5(0xe82)](_0x11f7b5(0x149d));});}async function _0x25bc98(){const _0x2189a0=_0x475790,_0x5b3573=_0x5aea71[_0x2189a0(0x143f)];if(!_0x5b3573)return;document[_0x2189a0(0x2ec)](_0x2189a0(0x371))['style'][_0x2189a0(0x701)]=_0x2189a0(0x5b1),await _0x34d596(_0x2189a0(0x13e4),_0x2189a0(0xeba)+_0x5b3573+_0x2189a0(0x460));switch(_0x5b3573){case _0x2189a0(0xc96):await _0x321782();break;case _0x2189a0(0xcf8):await _0x1300de();break;case _0x2189a0(0xc64):await _0x5f5478();break;}}function _0x2ce980(){const _0x32e6e4=_0x475790,_0x2210a6=_0x5aea71[_0x32e6e4(0x7f8)][_0x32e6e4(0xebc)](_0x17effb=>_0x17effb['isAlive']),_0x1bc8e4=_0x2210a6['filter'](_0x28dc84=>_0x28dc84['role']==='狼人'),_0x1278c3=_0x2210a6[_0x32e6e4(0xebc)](_0x2870ae=>[_0x32e6e4(0x1063),'女巫','猎人','守卫'][_0x32e6e4(0x138a)](_0x2870ae['role'])),_0x487aa3=_0x2210a6[_0x32e6e4(0xebc)](_0x42cc3c=>_0x42cc3c[_0x32e6e4(0x9be)]==='平民');let _0x4d1a63=null;if(_0x1bc8e4['length']===0x0)_0x4d1a63='好人';else{if(_0x1bc8e4[_0x32e6e4(0x9a1)]>=_0x1278c3[_0x32e6e4(0x9a1)]+_0x487aa3['length'])_0x4d1a63='狼人';else _0x5aea71[_0x32e6e4(0x3e6)]===_0x32e6e4(0x3ba)?(_0x1278c3['length']===0x0||_0x487aa3[_0x32e6e4(0x9a1)]===0x0)&&(_0x4d1a63='狼人'):_0x1278c3[_0x32e6e4(0x9a1)]===0x0&&_0x487aa3['length']===0x0&&(_0x4d1a63='狼人');}if(_0x4d1a63)return _0x20b7e5(_0x4d1a63),!![];return![];}async function _0x95aee4(){const _0x4d6746=_0x475790,_0x38f0f5=await _0x4436ba(_0x4d6746(0xc1c),'此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>',{'confirmText':_0x4d6746(0x523)});if(!_0x38f0f5)return;await _0x34d596(_0x4d6746(0x13e4),_0x4d6746(0x1463));try{const _0x3957ba=await _0x5b9d83[_0x4d6746(0x6ce)][_0x4d6746(0x14b5)]();let _0x5d32bf=0x0;for(const _0x4273c8 of _0x3957ba){let _0x1d229b=![];!Array[_0x4d6746(0x624)](_0x4273c8['history'])&&(_0x4273c8['history']=[],_0x1d229b=!![]),(typeof _0x4273c8['settings']!==_0x4d6746(0x10c0)||_0x4273c8[_0x4d6746(0x362)]===null)&&(_0x4273c8[_0x4d6746(0x362)]={},_0x1d229b=!![]),!_0x4273c8[_0x4d6746(0x1423)]&&!_0x4273c8['originalName']&&(_0x4273c8['originalName']=_0x4273c8[_0x4d6746(0xe36)],_0x1d229b=!![]),typeof _0x4273c8[_0x4d6746(0xce1)]===_0x4d6746(0xe40)&&(_0x4273c8[_0x4d6746(0xce1)]=0x0,_0x1d229b=!![]),!Array['isArray'](_0x4273c8[_0x4d6746(0x153f)])&&(_0x4273c8['longTermMemory']=[],_0x1d229b=!![]),_0x1d229b&&(_0x5d32bf++,console['log'](_0x4d6746(0x7ce)+_0x4273c8[_0x4d6746(0xe36)]+'\x22\x20(ID:\x20'+_0x4273c8['id']+')\x20的残缺数据。'),await _0x5b9d83[_0x4d6746(0x6ce)][_0x4d6746(0x7c3)](_0x4273c8)),_0x28f30a[_0x4d6746(0x6ce)][_0x4273c8['id']]=_0x4273c8;}_0x5d32bf>0x0?(await _0x34d596('修复完成！',_0x4d6746(0x466)+_0x5d32bf+_0x4d6746(0x59f)),await _0x5db8a3()):await _0x34d596(_0x4d6746(0xc93),_0x4d6746(0x113b));}catch(_0x185d69){console[_0x4d6746(0x1518)](_0x4d6746(0x511),_0x185d69),await _0x34d596(_0x4d6746(0x221),'执行检查时发生错误:\x20'+_0x185d69[_0x4d6746(0x13bc)]);}}function _0x5d72d6(_0x2c4ef8,_0x385ce7='top'){const _0x2e15f5=_0x475790;if(_0x2c4ef8[_0x2e15f5(0x765)](_0x2e15f5(0x603)))return;const _0x5a7785=document[_0x2e15f5(0x14ae)](_0x2e15f5(0xaa5));_0x5a7785[_0x2e15f5(0xdd1)]=_0x2e15f5(0xc54),_0x5a7785[_0x2e15f5(0xc43)]='<div\x20class=\x22spinner\x22></div>',_0x385ce7===_0x2e15f5(0xe39)?_0x2c4ef8[_0x2e15f5(0x998)](_0x5a7785):_0x2c4ef8[_0x2e15f5(0x41f)](_0x5a7785);}function _0x66d5be(_0x4aca6f){const _0x59f6a4=_0x475790,_0x2c9d6c=_0x4aca6f[_0x59f6a4(0x765)]('.loader-container');_0x2c9d6c&&_0x2c9d6c['remove']();}async function _0x6a765d(){const _0x217a52=_0x475790,_0x152483=document[_0x217a52(0x2ec)]('delete-world-books-modal'),_0x1aaacc=document[_0x217a52(0x2ec)](_0x217a52(0x39d)),_0x59341c=document[_0x217a52(0x2ec)](_0x217a52(0x956));_0x1aaacc[_0x217a52(0xc43)]='',_0x59341c['checked']=![];const _0x246ffc=await _0x5b9d83['worldBooks']['toArray']();_0x246ffc[_0x217a52(0x9a1)]===0x0?_0x1aaacc['innerHTML']=_0x217a52(0x122d):_0x246ffc[_0x217a52(0xf99)](_0xa4a4d7=>{const _0x1a5978=_0x217a52,_0x20eb89=document[_0x1a5978(0x14ae)](_0x1a5978(0xaa5));_0x20eb89[_0x1a5978(0xdd1)]=_0x1a5978(0x10a9),_0x20eb89[_0x1a5978(0xe93)][_0x1a5978(0x7f9)]=_0xa4a4d7['id'],_0x20eb89[_0x1a5978(0xc43)]=_0x1a5978(0x1558)+_0xa4a4d7[_0x1a5978(0xe36)]+_0x1a5978(0x728),_0x1aaacc[_0x1a5978(0x998)](_0x20eb89);}),_0x152483['classList'][_0x217a52(0xe82)](_0x217a52(0x149d));}async function _0x13f24d(){const _0x5499f2=_0x475790,_0x11da17=document[_0x5499f2(0x5d6)](_0x5499f2(0x2af));if(_0x11da17['length']===0x0){alert('请至少选择一个要删除的世界书。');return;}const _0x37b08d=Array[_0x5499f2(0x13d1)](_0x11da17)[_0x5499f2(0x11c6)](_0x492d0c=>_0x492d0c[_0x5499f2(0xe93)]['bookId']),_0x10d10d=await _0x4436ba(_0x5499f2(0x11d0),_0x5499f2(0xb9e)+_0x11da17[_0x5499f2(0x9a1)]+_0x5499f2(0x645),{'confirmButtonClass':_0x5499f2(0xd8f),'confirmText':_0x5499f2(0x10d9)});if(!_0x10d10d)return;await _0x34d596(_0x5499f2(0x13e4),_0x5499f2(0xb7b));try{await _0x5b9d83[_0x5499f2(0xe5b)]('rw',_0x5b9d83[_0x5499f2(0x13b9)],_0x5b9d83['chats'],async()=>{const _0x442c18=_0x5499f2;await _0x5b9d83[_0x442c18(0x13b9)][_0x442c18(0x1521)](_0x37b08d);const _0x520f3c=await _0x5b9d83[_0x442c18(0x6ce)][_0x442c18(0x14b5)]();for(const _0x3e72b7 of _0x520f3c){if(_0x3e72b7[_0x442c18(0x362)]&&Array[_0x442c18(0x624)](_0x3e72b7['settings'][_0x442c18(0x684)])){const _0xd7aff8=_0x3e72b7[_0x442c18(0x362)]['linkedWorldBookIds'][_0x442c18(0x9a1)];_0x3e72b7[_0x442c18(0x362)]['linkedWorldBookIds']=_0x3e72b7[_0x442c18(0x362)][_0x442c18(0x684)]['filter'](_0x52e025=>!_0x37b08d[_0x442c18(0x138a)](_0x52e025)),_0x3e72b7[_0x442c18(0x362)][_0x442c18(0x684)][_0x442c18(0x9a1)]<_0xd7aff8&&await _0x5b9d83['chats'][_0x442c18(0x7c3)](_0x3e72b7);}}}),_0x28f30a[_0x5499f2(0x13b9)]=_0x28f30a['worldBooks'][_0x5499f2(0xebc)](_0x5a279a=>!_0x37b08d[_0x5499f2(0x138a)](_0x5a279a['id'])),document[_0x5499f2(0x2ec)](_0x5499f2(0x4eb))[_0x5499f2(0xff6)]['remove'](_0x5499f2(0x149d)),await _0x34d596(_0x5499f2(0x1557),_0x11da17[_0x5499f2(0x9a1)]+_0x5499f2(0x4c1));}catch(_0x49ac50){console['error'](_0x5499f2(0x11b7),_0x49ac50),await _0x34d596(_0x5499f2(0x7f2),_0x5499f2(0x470)+_0x49ac50['message']);}}function _0x3e21cb(){const _0xdd6e0=_0x475790;if(!_0x28f30a[_0xdd6e0(0x11b9)])return;const _0x500058=_0x28f30a[_0xdd6e0(0x11b9)],_0x431744=document[_0xdd6e0(0x2ec)](_0xdd6e0(0x30e)),_0x4dff2e=document[_0xdd6e0(0x2ec)](_0xdd6e0(0x28c)),_0x420426=document['getElementById']('reading-restore-btn');let _0x2a0cfc=_0x4dbc69[_0x500058];if(_0x2a0cfc&&_0x2a0cfc[_0xdd6e0(0xffc)]){_0x2a0cfc[_0xdd6e0(0x1283)]&&_0x211e18();_0x431744[_0xdd6e0(0x589)][_0xdd6e0(0x701)]=_0xdd6e0(0xc67);return;}_0x389854(_0x500058),_0x37e154(_0x500058),_0x431744[_0xdd6e0(0x589)][_0xdd6e0(0x701)]=_0xdd6e0(0xc67),_0x4dff2e[_0xdd6e0(0xff6)][_0xdd6e0(0x1424)]('minimized'),_0x420426['style']['display']=_0xdd6e0(0x5b1);const _0x5638f4=document[_0xdd6e0(0x2ec)](_0xdd6e0(0x1007)),_0x36bdf1=_0x4dff2e[_0xdd6e0(0x410)](),_0x2f4f39=(_0x5638f4[_0xdd6e0(0x1512)]-_0x36bdf1[_0xdd6e0(0x11d3)])/0x2,_0x2122cd=(_0x5638f4[_0xdd6e0(0xadd)]-_0x36bdf1[_0xdd6e0(0xeb4)])/0x2;_0x4dff2e[_0xdd6e0(0x589)][_0xdd6e0(0xdd5)]=_0x2f4f39+'px',_0x4dff2e[_0xdd6e0(0x589)]['left']=_0x2122cd+'px',_0x4dff2e['style'][_0xdd6e0(0x1244)]='';}function _0x389854(_0x4717d8){const _0x1f5a66=_0x475790;_0x4dbc69[_0x4717d8]={'isActive':!![],'isMinimized':![],'title':_0x1f5a66(0xb6b),'contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0x90c1f8(){const _0x1873b8=_0x475790,_0x364e17=_0x28f30a[_0x1873b8(0x11b9)];if(!_0x364e17||!_0x4dbc69[_0x364e17]||!_0x4dbc69[_0x364e17][_0x1873b8(0xffc)])return;document[_0x1873b8(0x2ec)](_0x1873b8(0x30e))['style'][_0x1873b8(0x701)]=_0x1873b8(0x5b1),document[_0x1873b8(0x2ec)](_0x1873b8(0x8f1))[_0x1873b8(0x589)][_0x1873b8(0x701)]=_0x1873b8(0x5b1),document[_0x1873b8(0x2ec)](_0x1873b8(0x28c))[_0x1873b8(0xff6)]['remove'](_0x1873b8(0x6e6)),_0x4dbc69[_0x364e17][_0x1873b8(0xffc)]=![],console[_0x1873b8(0x415)](_0x1873b8(0x7f3));}function _0x344671(){const _0x3e306f=_0x475790,_0x9b4c2f=_0x4dbc69[_0x28f30a[_0x3e306f(0x11b9)]];if(!_0x9b4c2f||!_0x9b4c2f[_0x3e306f(0xffc)]||_0x9b4c2f[_0x3e306f(0x1283)])return;_0x9b4c2f[_0x3e306f(0x1283)]=!![],document[_0x3e306f(0x2ec)]('reading-window')[_0x3e306f(0xff6)]['add'](_0x3e306f(0x6e6)),document['getElementById'](_0x3e306f(0x8f1))['style']['display']=_0x3e306f(0xc67);}function _0x211e18(){const _0x12dcfa=_0x475790,_0x6aea99=_0x4dbc69[_0x28f30a[_0x12dcfa(0x11b9)]];if(!_0x6aea99||!_0x6aea99['isActive']||!_0x6aea99[_0x12dcfa(0x1283)])return;_0x6aea99[_0x12dcfa(0x1283)]=![],document[_0x12dcfa(0x2ec)](_0x12dcfa(0x8f1))[_0x12dcfa(0x589)][_0x12dcfa(0x701)]=_0x12dcfa(0x5b1),document[_0x12dcfa(0x2ec)](_0x12dcfa(0x28c))[_0x12dcfa(0xff6)][_0x12dcfa(0x1424)](_0x12dcfa(0x6e6));}function _0x181632(_0x5ccc6b,_0x4be947){const _0x407506=_0x475790;let _0x569b04=0x0,_0x3400e9=0x0,_0x4cc0d0=0x0,_0x36ce5a=0x0;const _0x5bbd04=document[_0x407506(0x2ec)](_0x407506(0x1007)),_0x283801=_0x27dd12=>{const _0x586dea=_0x407506;if(_0x27dd12[_0x586dea(0x1104)][_0x586dea(0x3f2)](_0x586dea(0xd5a)))return;if(_0x5ccc6b['style']['transform']){const _0x1b1426=_0x5ccc6b['getBoundingClientRect'](),_0x3b7e00=_0x5ccc6b[_0x586dea(0xe34)]['getBoundingClientRect']();_0x5ccc6b[_0x586dea(0x589)]['top']=_0x1b1426['top']-_0x3b7e00[_0x586dea(0xdd5)]+'px',_0x5ccc6b[_0x586dea(0x589)][_0x586dea(0xd02)]=_0x1b1426[_0x586dea(0xd02)]-_0x3b7e00[_0x586dea(0xd02)]+'px',_0x5ccc6b[_0x586dea(0x589)]['transform']='';}_0x27dd12[_0x586dea(0x10bd)]();const _0x21ba12=_0x27dd12[_0x586dea(0xb4b)]===_0x586dea(0x9a8)?_0x27dd12[_0x586dea(0x5b2)][0x0]:_0x27dd12;_0x4cc0d0=_0x21ba12['clientX'],_0x36ce5a=_0x21ba12[_0x586dea(0x745)],document[_0x586dea(0xf79)](_0x586dea(0x106b),_0x198f85),document[_0x586dea(0xf79)](_0x586dea(0x6fa),_0x4a9acd),document[_0x586dea(0xf79)](_0x586dea(0xe2a),_0x198f85),document[_0x586dea(0xf79)](_0x586dea(0xba4),_0x4a9acd);},_0x4a9acd=_0x2cbda9=>{const _0x281930=_0x407506,_0x14eb44=_0x2cbda9[_0x281930(0xb4b)]===_0x281930(0xba4)?_0x2cbda9['touches'][0x0]:_0x2cbda9;_0x569b04=_0x4cc0d0-_0x14eb44[_0x281930(0xdad)],_0x3400e9=_0x36ce5a-_0x14eb44['clientY'],_0x4cc0d0=_0x14eb44[_0x281930(0xdad)],_0x36ce5a=_0x14eb44[_0x281930(0x745)];let _0xb7233a=_0x5ccc6b[_0x281930(0x117e)]-_0x3400e9,_0x5aeec0=_0x5ccc6b[_0x281930(0xce8)]-_0x569b04;const _0x447da2=_0x5bbd04[_0x281930(0x1512)]-_0x5ccc6b[_0x281930(0x361)]-0xa,_0x40ace0=_0x5bbd04[_0x281930(0xadd)]-_0x5ccc6b['offsetWidth']-0xa;_0xb7233a=Math[_0x281930(0x7ac)](0xa,Math[_0x281930(0x675)](_0xb7233a,_0x447da2)),_0x5aeec0=Math[_0x281930(0x7ac)](0xa,Math['min'](_0x5aeec0,_0x40ace0)),_0x5ccc6b[_0x281930(0x589)][_0x281930(0xdd5)]=_0xb7233a+'px',_0x5ccc6b[_0x281930(0x589)]['left']=_0x5aeec0+'px';},_0x198f85=()=>{const _0x2f9dbb=_0x407506;document[_0x2f9dbb(0x1f0)](_0x2f9dbb(0x106b),_0x198f85),document[_0x2f9dbb(0x1f0)](_0x2f9dbb(0x6fa),_0x4a9acd),document[_0x2f9dbb(0x1f0)]('touchend',_0x198f85),document[_0x2f9dbb(0x1f0)](_0x2f9dbb(0xba4),_0x4a9acd);};_0x4be947[_0x407506(0xf79)](_0x407506(0xcfa),_0x283801),_0x4be947[_0x407506(0xf79)](_0x407506(0x9a8),_0x283801);}function _0x37e154(_0x5a6f6b){const _0x4929b8=_0x475790,_0x28f138=_0x4dbc69[_0x5a6f6b];if(!_0x28f138)return;const _0x41cad3=document[_0x4929b8(0x2ec)](_0x4929b8(0x9e9)),_0x494ec7=document[_0x4929b8(0x2ec)](_0x4929b8(0x131f)),_0x4ba083=document[_0x4929b8(0x2ec)](_0x4929b8(0xbb7)),_0xbe198=document[_0x4929b8(0x2ec)](_0x4929b8(0x934)),_0x470137=document[_0x4929b8(0x2ec)](_0x4929b8(0xa4b));_0x41cad3[_0x4929b8(0x15f)]=_0x28f138[_0x4929b8(0x141e)];if(_0x28f138[_0x4929b8(0x1127)]['length']===0x0)_0x494ec7['innerHTML']='<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>',_0x28f138['totalPages']=0x0,_0x28f138['currentPage']=0x0;else{const _0xfd741=_0x28f138[_0x4929b8(0xcfd)]*_0x28f138[_0x4929b8(0x7b5)],_0x661070=_0xfd741+_0x28f138[_0x4929b8(0x7b5)];_0x494ec7[_0x4929b8(0x15f)]=_0x28f138['contentLines'][_0x4929b8(0x225)](_0xfd741,_0x661070)[_0x4929b8(0xbad)]('\x0a');}_0x4ba083[_0x4929b8(0x15f)]=_0x28f138[_0x4929b8(0xcfd)]+0x1+_0x4929b8(0x875)+_0x28f138[_0x4929b8(0x9a5)],_0xbe198[_0x4929b8(0x1373)]=_0x28f138[_0x4929b8(0xcfd)]===0x0,_0x470137[_0x4929b8(0x1373)]=_0x28f138[_0x4929b8(0xcfd)]>=_0x28f138[_0x4929b8(0x9a5)]-0x1;}function _0x156585(){const _0x791312=_0x475790,_0x1b88e1=_0x4dbc69[_0x28f30a[_0x791312(0x11b9)]];_0x1b88e1&&_0x1b88e1[_0x791312(0xcfd)]<_0x1b88e1[_0x791312(0x9a5)]-0x1&&(_0x1b88e1[_0x791312(0xcfd)]++,_0x37e154(_0x28f30a['activeChatId']),document[_0x791312(0x2ec)](_0x791312(0x131f))['scrollTop']=0x0,_0x1034c4(_0x1b88e1[_0x791312(0x4ed)],_0x1b88e1[_0x791312(0xcfd)]));}async function _0x331fc8(){const _0x16e5e6=_0x475790,_0x14f942=_0x4dbc69[_0x28f30a[_0x16e5e6(0x11b9)]];_0x14f942&&_0x14f942[_0x16e5e6(0xcfd)]>0x0&&(_0x14f942[_0x16e5e6(0xcfd)]--,_0x37e154(_0x28f30a[_0x16e5e6(0x11b9)]),document[_0x16e5e6(0x2ec)](_0x16e5e6(0x131f))[_0x16e5e6(0x12be)]=0x0,await _0x1034c4(_0x14f942[_0x16e5e6(0x4ed)],_0x14f942[_0x16e5e6(0xcfd)]),await notifyAiOfPageTurn(_0x28f30a[_0x16e5e6(0x11b9)],_0x14f942));}function _0x23c847(){const _0x5b477e=_0x475790;document[_0x5b477e(0x2ec)](_0x5b477e(0x1336))['click']();}async function _0x11ed97(_0x300298){const _0x58f6df=_0x475790,_0x5cf3dd=new Uint8Array(_0x300298);if(_0x5cf3dd[_0x58f6df(0x9a1)]>=0x3&&_0x5cf3dd[0x0]===0xef&&_0x5cf3dd[0x1]===0xbb&&_0x5cf3dd[0x2]===0xbf)return console['log'](_0x58f6df(0x1401)),new TextDecoder('utf-8')[_0x58f6df(0x8ea)](_0x5cf3dd);if(_0x5cf3dd['length']>=0x2&&_0x5cf3dd[0x0]===0xff&&_0x5cf3dd[0x1]===0xfe)return console[_0x58f6df(0x415)](_0x58f6df(0x76e)),new TextDecoder('utf-16le')[_0x58f6df(0x8ea)](_0x5cf3dd);if(_0x5cf3dd['length']>=0x2&&_0x5cf3dd[0x0]===0xfe&&_0x5cf3dd[0x1]===0xff)return console[_0x58f6df(0x415)]('检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。'),new TextDecoder(_0x58f6df(0x1519))[_0x58f6df(0x8ea)](_0x5cf3dd);try{console[_0x58f6df(0x415)](_0x58f6df(0x42b));const _0x4f5b32=new TextDecoder(_0x58f6df(0x118f),{'fatal':!![]})['decode'](_0x5cf3dd);return console[_0x58f6df(0x415)](_0x58f6df(0x312)),_0x4f5b32;}catch(_0x50c22c){console['log']('UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...');try{const _0x306022=new TextDecoder(_0x58f6df(0x1353))['decode'](_0x5cf3dd);return console[_0x58f6df(0x415)](_0x58f6df(0x138f)),_0x306022;}catch(_0x225a6f){console['error'](_0x58f6df(0x6f9),_0x225a6f);throw new Error(_0x58f6df(0x70e));}}}async function _0x544f2e(_0x46a67f){const _0xf394b1=_0x475790,_0x22cfbb=_0x46a67f[_0xf394b1(0x1104)][_0xf394b1(0x8d6)][0x0];if(!_0x22cfbb)return;try{const _0x4de4f1=await _0x22cfbb[_0xf394b1(0x7be)](),_0x2c103a=await _0x11ed97(_0x4de4f1),_0x591bc2=_0x22cfbb[_0xf394b1(0xe36)][_0xf394b1(0x13ed)](/\.txt$/i,''),_0x1aa591=await _0x5b9d83[_0xf394b1(0x13d2)][_0xf394b1(0xe82)]({'title':_0x591bc2,'content':_0x2c103a,'lastOpened':Date[_0xf394b1(0x487)]()});await _0xf0a10c(_0x1aa591),document[_0xf394b1(0x2ec)]('reading-library-modal')[_0xf394b1(0xff6)][_0xf394b1(0xe9a)](_0xf394b1(0x149d))&&_0xe1cec4();}catch(_0x46a5b5){console[_0xf394b1(0x1518)]('导入书籍失败:',_0x46a5b5),await _0x34d596('导入失败',_0x46a5b5[_0xf394b1(0x13bc)]);}finally{_0x46a67f[_0xf394b1(0x1104)]['value']=null;}}async function _0x3b2e12(){const _0x333b83=_0x475790,_0xf8938a=_0x28f30a[_0x333b83(0x11b9)];if(!_0xf8938a)return;const _0x2ffbb0=_0x4dbc69[_0xf8938a];if(!_0x2ffbb0||_0x2ffbb0[_0x333b83(0x9a5)]<=0x1)return;const _0x8d51a=await _0x33419a(_0x333b83(0xcf5),_0x333b83(0x829)+_0x2ffbb0[_0x333b83(0x9a5)]+')',_0x2ffbb0[_0x333b83(0xcfd)]+0x1);if(_0x8d51a===null)return;const _0x161ca7=parseInt(_0x8d51a);if(isNaN(_0x161ca7)||_0x161ca7<0x1||_0x161ca7>_0x2ffbb0[_0x333b83(0x9a5)]){alert(_0x333b83(0x10a2));return;}_0x2ffbb0[_0x333b83(0xcfd)]=_0x161ca7-0x1,_0x37e154(_0xf8938a),_0x1034c4(_0x2ffbb0[_0x333b83(0x4ed)],_0x2ffbb0['currentPage']);}async function _0x1034c4(_0x39097e,_0x41a898){const _0x2167c7=_0x475790;if(!_0x39097e)return;try{await _0x5b9d83['readingLibrary'][_0x2167c7(0x130a)](_0x39097e,{'currentPage':_0x41a898});}catch(_0x53850c){console[_0x2167c7(0x1518)](_0x2167c7(0x1b2)+_0x39097e+_0x2167c7(0xe4a),_0x53850c);}}async function _0x156585(){const _0x1ab342=_0x475790,_0x110518=_0x4dbc69[_0x28f30a[_0x1ab342(0x11b9)]];_0x110518&&_0x110518[_0x1ab342(0xcfd)]<_0x110518[_0x1ab342(0x9a5)]-0x1&&(_0x110518[_0x1ab342(0xcfd)]++,_0x37e154(_0x28f30a['activeChatId']),document[_0x1ab342(0x2ec)](_0x1ab342(0x131f))[_0x1ab342(0x12be)]=0x0,await _0x1034c4(_0x110518['activeBookId'],_0x110518[_0x1ab342(0xcfd)]),await notifyAiOfPageTurn(_0x28f30a[_0x1ab342(0x11b9)],_0x110518));}function _0x353a9b(_0x2b0877,_0x3dce38){const _0x35ea2a=_0x475790,_0x216811=_0x28f30a['activeChatId'];if(!_0x216811)return;const _0x3bacb9=_0x4dbc69[_0x216811];_0x3bacb9[_0x35ea2a(0x141e)]=_0x2b0877[_0x35ea2a(0x13ed)](/\.txt$/i,''),_0x3bacb9['contentLines']=_0x3dce38[_0x35ea2a(0xa8a)](/\r\n?|\n/)[_0x35ea2a(0x11c6)](_0x486567=>_0x486567[_0x35ea2a(0x13ed)](/ +/g,'\x20')),_0x3bacb9[_0x35ea2a(0x9a5)]=Math['ceil'](_0x3bacb9[_0x35ea2a(0x1127)][_0x35ea2a(0x9a1)]/_0x3bacb9[_0x35ea2a(0x7b5)]),_0x3bacb9[_0x35ea2a(0xcfd)]=0x0,_0x37e154(_0x216811);}async function _0x5c00a7(){const _0x1cd86d=_0x475790;document[_0x1cd86d(0x2ec)]('reading-library-search-input')[_0x1cd86d(0x11a4)]='',await _0xe1cec4(),document[_0x1cd86d(0x2ec)](_0x1cd86d(0x94f))[_0x1cd86d(0xff6)][_0x1cd86d(0xe82)](_0x1cd86d(0x149d));}async function _0xe1cec4(_0x4cecec=''){const _0x155314=_0x475790,_0x51da66=document[_0x155314(0x2ec)]('reading-library-list');let _0x9ef7cd=await _0x5b9d83['readingLibrary'][_0x155314(0x106d)]('lastOpened')[_0x155314(0x6c9)]()[_0x155314(0x14b5)]();_0x51da66[_0x155314(0xc43)]='';_0x4cecec&&(_0x9ef7cd=_0x9ef7cd['filter'](_0x43024c=>_0x43024c[_0x155314(0x141e)][_0x155314(0x1430)]()[_0x155314(0x138a)](_0x4cecec[_0x155314(0x1430)]())));if(_0x9ef7cd[_0x155314(0x9a1)]===0x0){const _0x22cf49=_0x4cecec?'找不到匹配的书籍':_0x155314(0xd53);_0x51da66['innerHTML']=_0x155314(0x115c)+_0x22cf49+_0x155314(0x1251);return;}_0x9ef7cd[_0x155314(0xf99)](_0x305bb8=>{const _0x28ec7e=_0x155314,_0x36a8c0=document[_0x28ec7e(0x14ae)]('div');_0x36a8c0[_0x28ec7e(0xdd1)]=_0x28ec7e(0xe3c),_0x36a8c0[_0x28ec7e(0xc43)]=_0x28ec7e(0x969)+_0x305bb8['id']+'\x22>'+_0x305bb8[_0x28ec7e(0x141e)]+_0x28ec7e(0x1c4)+_0x305bb8['id']+'\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x51da66[_0x28ec7e(0x998)](_0x36a8c0);});}async function _0xf0a10c(_0x2630d3){const _0x7d2ace=_0x475790,_0x5cb936=_0x28f30a[_0x7d2ace(0x11b9)];if(!_0x5cb936)return;const _0x5041cc=await _0x5b9d83[_0x7d2ace(0x13d2)][_0x7d2ace(0x6b5)](_0x2630d3);if(!_0x5041cc){alert('找不到这本书！');return;}await _0x5b9d83['readingLibrary'][_0x7d2ace(0x130a)](_0x2630d3,{'lastOpened':Date[_0x7d2ace(0x487)]()});const _0x4a4d30=_0x4dbc69[_0x5cb936];_0x4a4d30[_0x7d2ace(0x4ed)]=_0x2630d3,_0x4a4d30[_0x7d2ace(0x141e)]=_0x5041cc[_0x7d2ace(0x141e)],_0x4a4d30[_0x7d2ace(0x1127)]=_0x5041cc[_0x7d2ace(0x1047)]['split'](/\r\n?|\n/)[_0x7d2ace(0x11c6)](_0xa2c99e=>_0xa2c99e[_0x7d2ace(0x13ed)](/ +/g,'\x20')),_0x4a4d30[_0x7d2ace(0x9a5)]=Math['ceil'](_0x4a4d30['contentLines'][_0x7d2ace(0x9a1)]/_0x4a4d30[_0x7d2ace(0x7b5)]),_0x4a4d30['currentPage']=_0x5041cc[_0x7d2ace(0xcfd)]||0x0,_0x37e154(_0x5cb936),document[_0x7d2ace(0x2ec)](_0x7d2ace(0x131f))[_0x7d2ace(0x12be)]=0x0,document[_0x7d2ace(0x2ec)](_0x7d2ace(0x94f))[_0x7d2ace(0xff6)][_0x7d2ace(0x1424)](_0x7d2ace(0x149d));}async function _0x414517(_0x53d960){const _0x556283=_0x475790,_0x2bb729=await _0x5b9d83[_0x556283(0x13d2)][_0x556283(0x6b5)](_0x53d960);if(!_0x2bb729)return;const _0x13c434=await _0x4436ba(_0x556283(0x4db),'确定要删除《'+_0x2bb729[_0x556283(0x141e)]+'》吗？',{'confirmButtonClass':_0x556283(0xd8f)});_0x13c434&&(await _0x5b9d83[_0x556283(0x13d2)]['delete'](_0x53d960),await _0xe1cec4());}function _0x353a9b(_0x367483,_0x3dd9c8){const _0x5943ef=_0x475790,_0x575dbc=_0x28f30a[_0x5943ef(0x11b9)];if(!_0x575dbc)return;const _0xbc58dc=_0x4dbc69[_0x575dbc];_0xbc58dc[_0x5943ef(0x141e)]=_0x367483[_0x5943ef(0x13ed)](/\.txt$/i,''),_0xbc58dc[_0x5943ef(0x1127)]=_0x3dd9c8['split'](/\r\n?|\n/),_0xbc58dc[_0x5943ef(0x9a5)]=Math['ceil'](_0xbc58dc[_0x5943ef(0x1127)][_0x5943ef(0x9a1)]/_0xbc58dc[_0x5943ef(0x7b5)]),_0xbc58dc['currentPage']=0x0,_0x37e154(_0x575dbc);}function _0x181632(_0x32d7f8,_0x3bd7a8){const _0xb65b0=_0x475790;let _0xaf7e6a=0x0,_0xe4fb2b=0x0,_0x37ed52=0x0,_0x3d752d=0x0,_0x30be11=![],_0x4f7c54=![];const _0x1ac039=document[_0xb65b0(0x2ec)](_0xb65b0(0x1007)),_0xd46003=_0x56a588=>{const _0xf72ba3=_0xb65b0;if(_0x32d7f8!==_0x3bd7a8&&_0x56a588['target'][_0xf72ba3(0x3f2)]('button'))return;_0x30be11=!![],_0x4f7c54=![];const _0x269d41=_0x56a588[_0xf72ba3(0xb4b)]===_0xf72ba3(0x9a8)?_0x56a588['touches'][0x0]:_0x56a588;_0x37ed52=_0x269d41['clientX'],_0x3d752d=_0x269d41[_0xf72ba3(0x745)],_0x32d7f8[_0xf72ba3(0x589)][_0xf72ba3(0xdd5)]=_0x32d7f8[_0xf72ba3(0x117e)]+'px',_0x32d7f8[_0xf72ba3(0x589)]['left']=_0x32d7f8[_0xf72ba3(0xce8)]+'px',_0x32d7f8[_0xf72ba3(0x589)][_0xf72ba3(0x1244)]='',document['addEventListener'](_0xf72ba3(0x106b),_0x122a65),document[_0xf72ba3(0xf79)]('mousemove',_0x16df3a),document[_0xf72ba3(0xf79)](_0xf72ba3(0xe2a),_0x122a65),document[_0xf72ba3(0xf79)]('touchmove',_0x16df3a,{'passive':![]});},_0x16df3a=_0x2d8262=>{const _0x16407c=_0xb65b0;if(!_0x30be11)return;const _0x5bcece=_0x2d8262['type']==='touchmove'?_0x2d8262[_0x16407c(0x5b2)][0x0]:_0x2d8262,_0x38959e=_0x5bcece[_0x16407c(0xdad)]-_0x37ed52,_0x178918=_0x5bcece[_0x16407c(0x745)]-_0x3d752d;!_0x4f7c54&&(Math[_0x16407c(0x264)](_0x38959e)>0x5||Math['abs'](_0x178918)>0x5)&&(_0x4f7c54=!![]);_0x4f7c54&&_0x2d8262[_0x16407c(0x839)]&&_0x2d8262[_0x16407c(0x10bd)]();_0xaf7e6a=_0x37ed52-_0x5bcece['clientX'],_0xe4fb2b=_0x3d752d-_0x5bcece[_0x16407c(0x745)],_0x37ed52=_0x5bcece[_0x16407c(0xdad)],_0x3d752d=_0x5bcece[_0x16407c(0x745)];let _0x2e2610=_0x32d7f8[_0x16407c(0x117e)]-_0xe4fb2b,_0xd828ec=_0x32d7f8[_0x16407c(0xce8)]-_0xaf7e6a;const _0x347453=_0x1ac039[_0x16407c(0x1512)]-_0x32d7f8['offsetHeight']-0xa,_0x3ad568=_0x1ac039[_0x16407c(0xadd)]-_0x32d7f8[_0x16407c(0x144c)]-0xa;_0x2e2610=Math[_0x16407c(0x7ac)](0xa,Math[_0x16407c(0x675)](_0x2e2610,_0x347453)),_0xd828ec=Math[_0x16407c(0x7ac)](0xa,Math[_0x16407c(0x675)](_0xd828ec,_0x3ad568)),_0x32d7f8[_0x16407c(0x589)][_0x16407c(0xdd5)]=_0x2e2610+'px',_0x32d7f8['style'][_0x16407c(0xd02)]=_0xd828ec+'px';},_0x122a65=()=>{const _0x32c709=_0xb65b0;document[_0x32c709(0x1f0)](_0x32c709(0x106b),_0x122a65),document[_0x32c709(0x1f0)](_0x32c709(0x6fa),_0x16df3a),document['removeEventListener'](_0x32c709(0xe2a),_0x122a65),document[_0x32c709(0x1f0)](_0x32c709(0xba4),_0x16df3a);if(!_0x30be11)return;_0x30be11=![],!_0x4f7c54&&_0x32d7f8[_0x32c709(0x1177)]();};_0x3bd7a8['addEventListener'](_0xb65b0(0xcfa),_0xd46003),_0x3bd7a8[_0xb65b0(0xf79)](_0xb65b0(0x9a8),_0xd46003,{'passive':![]});}function _0x344671(){const _0x45a0d5=_0x475790,_0x370e12=_0x4dbc69[_0x28f30a[_0x45a0d5(0x11b9)]];if(!_0x370e12||!_0x370e12[_0x45a0d5(0xffc)])return;document[_0x45a0d5(0x2ec)](_0x45a0d5(0x28c))['classList'][_0x45a0d5(0xe82)]('minimized'),document[_0x45a0d5(0x2ec)](_0x45a0d5(0x8f1))[_0x45a0d5(0x589)]['display']=_0x45a0d5(0xc67),_0x370e12['isMinimized']=!![];}function _0x211e18(){const _0x1bc281=_0x475790,_0x4dddd9=_0x4dbc69[_0x28f30a[_0x1bc281(0x11b9)]];if(!_0x4dddd9||!_0x4dddd9[_0x1bc281(0xffc)])return;document['getElementById'](_0x1bc281(0x8f1))[_0x1bc281(0x589)]['display']=_0x1bc281(0x5b1),document[_0x1bc281(0x2ec)]('reading-window')[_0x1bc281(0xff6)][_0x1bc281(0x1424)](_0x1bc281(0x6e6)),_0x4dddd9['isMinimized']=![];}function _0x2d3d91(_0x46b0ba,_0x299a35){let _0x126cfc;return function(..._0x5e500a){const _0x124940=_0x1937,_0x32428d=this;clearTimeout(_0x126cfc),_0x126cfc=setTimeout(()=>_0x46b0ba[_0x124940(0x853)](_0x32428d,_0x5e500a),_0x299a35);};}function _0xf9a226(_0x5d6751){const _0x22ec54=_0x475790,_0x44de40=_0x4dbc69[_0x5d6751];if(!_0x44de40||!_0x44de40['isActive'])return'';const _0x2e53e1=_0x44de40[_0x22ec54(0x141e)]||_0x22ec54(0xf3e);let _0x4542c6='',_0x5a7a20='';if(_0x44de40[_0x22ec54(0x62b)]&&_0x44de40['currentSnippet'][_0x22ec54(0x97e)]())_0x4542c6=_0x44de40['currentSnippet'],_0x5a7a20=_0x22ec54(0x148e);else{if(_0x44de40[_0x22ec54(0x1127)][_0x22ec54(0x9a1)]>0x0){const _0x151666=_0x44de40[_0x22ec54(0xcfd)]*_0x44de40[_0x22ec54(0x7b5)],_0x252869=_0x151666+_0x44de40['linesPerPage'];_0x4542c6=_0x44de40[_0x22ec54(0x1127)][_0x22ec54(0x225)](_0x151666,_0x252869)[_0x22ec54(0xbad)]('\x0a')[_0x22ec54(0xa6b)](0x0,0xc8),_0x5a7a20=_0x22ec54(0x10b0);}else _0x4542c6=_0x22ec54(0xa21),_0x5a7a20='内容';}return _0x22ec54(0x11a0)+_0x2e53e1+_0x22ec54(0x12ab)+_0x5a7a20+_0x22ec54(0x1301)+_0x4542c6+_0x22ec54(0x14db)+(_0x28f30a[_0x22ec54(0x6ce)][_0x5d6751]?.[_0x22ec54(0x66c)]||_0x22ec54(0x292))+_0x22ec54(0xf22);}function _0x1c86d1(){const _0x58a262=_0x475790,_0x58724a=_0x28f30a['activeChatId'];if(!_0x58724a||!_0x4dbc69[_0x58724a])return;const _0x3afd08=_0x4dbc69[_0x58724a],_0x532b99=document['getElementById'](_0x58a262(0x131f)),_0x554fc7=_0x532b99[_0x58a262(0x12be)],_0x551482=_0x532b99['clientHeight'],_0x51d85f=_0x554fc7+_0x551482,_0x65c0e7=0xf*1.8,_0x382f5e=Math[_0x58a262(0x5f8)](_0x554fc7/_0x65c0e7),_0xd3bf0e=Math[_0x58a262(0xda0)](_0x51d85f/_0x65c0e7),_0x2acbbb=_0x3afd08[_0x58a262(0xcfd)]*_0x3afd08['linesPerPage']+_0x382f5e,_0x1bdfbe=_0x3afd08['currentPage']*_0x3afd08['linesPerPage']+_0xd3bf0e;if(_0x2acbbb<0x0||_0x2acbbb>=_0x3afd08[_0x58a262(0x1127)][_0x58a262(0x9a1)])return;const _0x150b42=_0x3afd08[_0x58a262(0x1127)][_0x58a262(0x225)](Math[_0x58a262(0x7ac)](0x0,_0x2acbbb),Math[_0x58a262(0x675)](_0x3afd08[_0x58a262(0x1127)][_0x58a262(0x9a1)],_0x1bdfbe))[_0x58a262(0xbad)]('\x0a');_0x3afd08[_0x58a262(0x62b)]=_0x150b42;}function _0x5445ef(){const _0x568c91=_0x475790,_0x133cad=document[_0x568c91(0x2ec)](_0x568c91(0xc56));if(_0x133cad){const _0x1a27ba=_0x133cad[_0x568c91(0x23f)]();_0x1a27ba!==undefined&&_0x1a27ba['then'](_0x4a6d81=>{const _0x1b5c3e=_0x568c91;console[_0x1b5c3e(0x415)](_0x1b5c3e(0x3e1));})[_0x568c91(0xd6b)](_0x58f790=>{const _0x130f45=_0x568c91;console[_0x130f45(0x664)](_0x130f45(0x14d3),_0x58f790);});}}function _0x15f646(){const _0x5c3ad4=_0x475790,_0xe46b0f=document[_0x5c3ad4(0x2ec)](_0x5c3ad4(0xc56));_0xe46b0f&&!_0xe46b0f[_0x5c3ad4(0x1368)]&&(_0xe46b0f[_0x5c3ad4(0x964)](),_0xe46b0f['currentTime']=0x0,console[_0x5c3ad4(0x415)]('静音音频已停止。'));}async function _0x5e1c7e(_0x64a949){const _0x54d873=_0x475790,_0x6de8ee=decodeURIComponent(_0x64a949[_0x54d873(0xe93)][_0x54d873(0x10ca)]),_0x1370c4=_0x64a949['dataset'][_0x54d873(0x9c3)],_0x51e92b=_0x64a949[_0x54d873(0x765)](_0x54d873(0x84f)),_0x237ff9=_0x64a949[_0x54d873(0x765)](_0x54d873(0x8f8)),_0xb0401a=document[_0x54d873(0x2ec)](_0x54d873(0xd03));if(!_0xb0401a[_0x54d873(0x1368)]&&_0xb0401a[_0x54d873(0xe93)][_0x54d873(0x13a3)]===_0x6de8ee&&_0xb0401a[_0x54d873(0xe93)][_0x54d873(0x11b6)]===_0x1370c4){_0xb0401a[_0x54d873(0x964)]();return;}_0xb0401a[_0x54d873(0x964)](),document[_0x54d873(0x5d6)](_0x54d873(0x84f))['forEach'](_0x4db737=>_0x4db737[_0x54d873(0x15f)]='▶');const _0x1a2603=_0x54d873(0xaae)+_0x1370c4+'_'+_0x6de8ee;let _0x3fe5db=_0x28f30a['ttsCache'][_0x54d873(0x6b5)](_0x1a2603);if(_0x3fe5db){console[_0x54d873(0x415)](_0x54d873(0x1417)),await _0x14faa0(_0x3fe5db[_0x54d873(0x6d1)],_0x3fe5db[_0x54d873(0xb4b)],_0x6de8ee,_0x1370c4,_0x64a949);return;}console['log']('无缓存，正在请求\x20Minimax\x20TTS\x20API...');if(_0x51e92b)_0x51e92b[_0x54d873(0x589)][_0x54d873(0x701)]=_0x54d873(0x5b1);_0x237ff9[_0x54d873(0x589)]['display']='block';const {minimaxGroupId:_0x14f5ba,minimaxApiKey:_0x57560c}=_0x28f30a['apiConfig'];if(!_0x14f5ba||!_0x57560c){await _0x34d596(_0x54d873(0x1284),'请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。'),_0x237ff9['style']['display']=_0x54d873(0x5b1);if(_0x51e92b)_0x51e92b['style'][_0x54d873(0x701)]=_0x54d873(0xc67);return;}try{const _0xf73271=await fetch(_0x54d873(0x7d7)+_0x14f5ba,{'method':_0x54d873(0x655),'headers':{'Authorization':_0x54d873(0xe83)+_0x57560c,'Content-Type':_0x54d873(0x1446)},'body':JSON[_0x54d873(0xe4d)]({'text':_0x6de8ee,'voice_id':_0x1370c4,'model':_0x28f30a[_0x54d873(0x1537)][_0x54d873(0xced)]||_0x54d873(0x878),'speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0xf73271['ok']){let _0x53a174='API\x20返回错误:\x20'+_0xf73271[_0x54d873(0x2a3)];try{const _0x28d64e=await _0xf73271[_0x54d873(0x12a2)]();_0x53a174=_0x28d64e[_0x54d873(0x10ad)]?.[_0x54d873(0x1e8)]||JSON[_0x54d873(0xe4d)](_0x28d64e);}catch(_0x5e1725){_0x53a174=await _0xf73271['text']();}throw new Error(_0x53a174);}const _0x17b666=await _0xf73271[_0x54d873(0x465)](),_0x3ae460=URL[_0x54d873(0x23d)](_0x17b666);await _0x14faa0(_0x3ae460,_0x17b666[_0x54d873(0xb4b)],_0x6de8ee,_0x1370c4,_0x64a949);const _0x388880=new FileReader();_0x388880['onloadend']=function(){const _0x5ab08c=_0x54d873;_0x28f30a[_0x5ab08c(0xafc)]['set'](_0x1a2603,{'url':_0x388880['result'],'type':_0x17b666[_0x5ab08c(0xb4b)]}),console[_0x5ab08c(0x415)]('TTS\x20音频已保存到缓存。');},_0x388880['readAsDataURL'](_0x17b666);}catch(_0x3e810b){console[_0x54d873(0x1518)](_0x54d873(0x1037),_0x3e810b),await _0x34d596(_0x54d873(0x35b),'错误:\x20'+_0x3e810b['message']);}finally{_0x237ff9['style'][_0x54d873(0x701)]=_0x54d873(0x5b1);if(_0x51e92b)_0x51e92b['style']['display']='flex';}}function _0x14faa0(_0x5755a7,_0x10032b,_0x2b927f,_0x5beaa3,_0x398350){return new Promise((_0x396b7e,_0x484ea0)=>{const _0x1fab86=_0x1937,_0x27f4b3=document[_0x1fab86(0x2ec)](_0x1fab86(0xd03));_0x27f4b3[_0x1fab86(0xce4)]=_0x5755a7,_0x27f4b3[_0x1fab86(0xb4b)]=_0x10032b,_0x27f4b3['dataset']['currentText']=_0x2b927f,_0x27f4b3[_0x1fab86(0xe93)]['currentVoiceId']=_0x5beaa3;const _0x2945c5=_0x27f4b3[_0x1fab86(0x23f)]();_0x2945c5!==undefined&&_0x2945c5[_0x1fab86(0x333)](()=>{const _0x30a9e8=_0x1fab86,_0xaab585=_0x398350['querySelector'](_0x30a9e8(0x84f));if(_0xaab585)_0xaab585[_0x30a9e8(0x15f)]='❚❚';_0x396b7e();})['catch'](_0x54eaec=>{const _0x29d378=_0x1fab86;console[_0x29d378(0x1518)](_0x29d378(0x37b),_0x54eaec),_0x484ea0(_0x54eaec);}),_0x27f4b3[_0x1fab86(0x77c)]=()=>{const _0x39ede2=_0x1fab86,_0x5d775a=_0x398350['querySelector'](_0x39ede2(0x84f));if(_0x5d775a)_0x5d775a[_0x39ede2(0x15f)]='▶';},_0x27f4b3[_0x1fab86(0xea3)]=()=>{const _0x29bcdd=_0x1fab86,_0x3119a5=_0x398350['querySelector'](_0x29bcdd(0x84f));if(_0x3119a5)_0x3119a5[_0x29bcdd(0x15f)]='▶';};});}function _0x2eb46c(_0x297d48){const _0x4f0050=_0x475790,_0x37c6bb=_0x297d48[_0x4f0050(0x3f2)](_0x4f0050(0x124c));if(!_0x37c6bb)return;const _0x311aca=_0x37c6bb[_0x4f0050(0x765)](_0x4f0050(0x92e)),_0x5c3e02=decodeURIComponent(_0x297d48[_0x4f0050(0xe93)][_0x4f0050(0x10ca)]);_0x311aca[_0x4f0050(0x589)]['display']===_0x4f0050(0x13f7)?_0x311aca[_0x4f0050(0x589)]['display']=_0x4f0050(0x5b1):(_0x311aca[_0x4f0050(0x15f)]=_0x5c3e02,_0x311aca[_0x4f0050(0x589)][_0x4f0050(0x701)]=_0x4f0050(0x13f7));}async function _0x3e8350(){const _0x14cdad=_0x475790;await _0x49bcd0(),document[_0x14cdad(0x2ec)](_0x14cdad(0xb03))[_0x14cdad(0xff6)]['add'](_0x14cdad(0x149d));}async function _0x49bcd0(){const _0x2530aa=_0x475790,_0x527585=document[_0x2530aa(0x2ec)](_0x2530aa(0x822)),_0x281696=await _0x5b9d83[_0x2530aa(0x1117)][_0x2530aa(0x14b5)]();_0x527585[_0x2530aa(0xc43)]='';if(_0x281696[_0x2530aa(0x9a1)]===0x0){_0x527585[_0x2530aa(0xc43)]=_0x2530aa(0x1001);return;}_0x281696[_0x2530aa(0xf99)](_0x553d13=>{const _0x4e7e33=_0x2530aa,_0x51c78e=document[_0x4e7e33(0x14ae)](_0x4e7e33(0xaa5));_0x51c78e[_0x4e7e33(0xdd1)]='existing-group-item',_0x51c78e[_0x4e7e33(0xc43)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x553d13[_0x4e7e33(0xe36)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x553d13['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x527585[_0x4e7e33(0x998)](_0x51c78e);});}async function _0x685e4b(){const _0x393db6=_0x475790,_0x3a29f3=document['getElementById'](_0x393db6(0xd8b)),_0x361652=_0x3a29f3[_0x393db6(0x11a4)][_0x393db6(0x97e)]();if(!_0x361652)return alert(_0x393db6(0x8d0));const _0x5280d4=await _0x5b9d83['shoppingCategories'][_0x393db6(0x67e)]('name')[_0x393db6(0x129a)](_0x361652)[_0x393db6(0x942)]();if(_0x5280d4)return alert(_0x393db6(0xaa1)+_0x361652+'\x22\x20已经存在了！');await _0x5b9d83[_0x393db6(0x1117)]['add']({'name':_0x361652}),_0x3a29f3['value']='',await _0x49bcd0();}async function _0x3e3223(_0x3c82c5){const _0x8125d6=_0x475790,_0x295c9c=await _0x4436ba(_0x8125d6(0x10d9),_0x8125d6(0xeb3),{'confirmButtonClass':_0x8125d6(0xd8f)});_0x295c9c&&(await _0x5b9d83['shoppingCategories'][_0x8125d6(0x54b)](_0x3c82c5),await _0x5b9d83[_0x8125d6(0x120e)][_0x8125d6(0x67e)](_0x8125d6(0x10ce))[_0x8125d6(0x129a)](_0x3c82c5)[_0x8125d6(0xa88)]({'categoryId':null}),await _0x49bcd0());}function _0x5c3541(_0x4b8dbc={}){const _0x4dd291=_0x475790,_0x3696d1=document['getElementById'](_0x4dd291(0xf71)),_0x1328a9=document[_0x4dd291(0x14ae)]('div');return _0x1328a9[_0x4dd291(0xdd1)]=_0x4dd291(0x14fa),_0x1328a9[_0x4dd291(0xc43)]=_0x4dd291(0x1372)+(_0x4b8dbc['name']||'')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22'+(_0x4b8dbc[_0x4dd291(0x1309)]||'')+_0x4dd291(0x196)+(_0x4b8dbc[_0x4dd291(0x6c6)]||_0x4dd291(0xc76))+_0x4dd291(0xccd),_0x1328a9[_0x4dd291(0x765)](_0x4dd291(0x81c))['addEventListener'](_0x4dd291(0x1177),()=>_0x1328a9[_0x4dd291(0x1424)]()),_0x1328a9[_0x4dd291(0x765)]('.upload-variation-image-btn')[_0x4dd291(0xf79)](_0x4dd291(0x1177),()=>{const _0x2f617a=_0x4dd291;_0x1328a9['querySelector'](_0x2f617a(0x1149))[_0x2f617a(0x1177)]();}),_0x1328a9[_0x4dd291(0x765)](_0x4dd291(0x1149))[_0x4dd291(0xf79)](_0x4dd291(0x217),_0x3f3af9=>{const _0x197517=_0x4dd291,_0x54a60d=_0x3f3af9['target']['files'][0x0];if(_0x54a60d){const _0x309ec4=new FileReader();_0x309ec4[_0x197517(0xf2d)]=_0x2609c1=>{const _0x25a7b2=_0x197517;_0x1328a9['querySelector'](_0x25a7b2(0xb50))[_0x25a7b2(0xce4)]=_0x2609c1[_0x25a7b2(0x1104)][_0x25a7b2(0x42a)];},_0x309ec4[_0x197517(0x60e)](_0x54a60d);}}),_0x3696d1[_0x4dd291(0x998)](_0x1328a9),_0x1328a9;}async function _0x4047a7(_0x34b4b4){const _0x255ff5=_0x475790,_0x17a495=await _0x5b9d83[_0x255ff5(0x120e)][_0x255ff5(0x6b5)](_0x34b4b4);if(!_0x17a495||!_0x17a495['variations']||_0x17a495[_0x255ff5(0xaab)]['length']===0x0)return;const _0x26db67=document[_0x255ff5(0x2ec)](_0x255ff5(0xd2f));document['getElementById'](_0x255ff5(0xdd8))[_0x255ff5(0xce4)]=_0x17a495['imageUrl'],document[_0x255ff5(0x2ec)](_0x255ff5(0x1114))[_0x255ff5(0x15f)]=_0x17a495[_0x255ff5(0xe36)];const _0x22482a=document['getElementById'](_0x255ff5(0x79c));_0x22482a['innerHTML']='',_0x17a495[_0x255ff5(0xaab)][_0x255ff5(0xf99)]((_0x3a7b92,_0x32baf1)=>{const _0x43908e=_0x255ff5,_0x54fe08=document['createElement'](_0x43908e(0x6a9));_0x54fe08[_0x43908e(0xb4b)]='radio',_0x54fe08[_0x43908e(0xe36)]=_0x43908e(0x147d),_0x54fe08['id']=_0x43908e(0x1511)+_0x34b4b4+'-'+_0x32baf1,_0x54fe08['value']=_0x32baf1,_0x54fe08['style'][_0x43908e(0x701)]=_0x43908e(0x5b1);if(_0x32baf1===0x0)_0x54fe08[_0x43908e(0x13b8)]=!![];const _0x2bb933=document[_0x43908e(0x14ae)](_0x43908e(0xa05));_0x2bb933[_0x43908e(0x12d9)]=_0x43908e(0x1511)+_0x34b4b4+'-'+_0x32baf1,_0x2bb933[_0x43908e(0x15f)]=_0x3a7b92[_0x43908e(0xe36)],_0x2bb933[_0x43908e(0x589)][_0x43908e(0x57a)]=_0x43908e(0x64c),_0x22482a[_0x43908e(0x998)](_0x54fe08),_0x22482a[_0x43908e(0x998)](_0x2bb933);});const _0x56315f=()=>{const _0x3c80b0=_0x255ff5,_0x1424b3=_0x22482a['querySelector'](_0x3c80b0(0x1077));_0x22482a[_0x3c80b0(0x5d6)](_0x3c80b0(0xa05))[_0x3c80b0(0xf99)](_0x3d0c3c=>{const _0x405964=_0x3c80b0;_0x3d0c3c['style'][_0x405964(0xcd5)]=_0x405964(0x631),_0x3d0c3c['style'][_0x405964(0x49c)]=_0x405964(0xc2a),_0x3d0c3c[_0x405964(0x589)]['backgroundColor']=_0x405964(0x8dd);});if(_0x1424b3){const _0x18a450=_0x22482a[_0x3c80b0(0x765)](_0x3c80b0(0x815)+_0x1424b3['id']+'\x22]');_0x18a450[_0x3c80b0(0x589)]['borderColor']=_0x3c80b0(0xa94),_0x18a450[_0x3c80b0(0x589)][_0x3c80b0(0x49c)]='var(--accent-color)',_0x18a450[_0x3c80b0(0x589)][_0x3c80b0(0xc34)]=_0x3c80b0(0x6a2);const _0x233a9f=_0x17a495['variations'][parseInt(_0x1424b3['value'])];document['getElementById'](_0x3c80b0(0x74d))[_0x3c80b0(0x15f)]='¥'+_0x233a9f[_0x3c80b0(0x1309)]['toFixed'](0x2),_0x233a9f[_0x3c80b0(0x6c6)]?document[_0x3c80b0(0x2ec)](_0x3c80b0(0xdd8))[_0x3c80b0(0xce4)]=_0x233a9f[_0x3c80b0(0x6c6)]:document['getElementById'](_0x3c80b0(0xdd8))[_0x3c80b0(0xce4)]=_0x17a495[_0x3c80b0(0x6c6)];}};_0x22482a[_0x255ff5(0xf79)]('change',_0x56315f),_0x56315f(),document[_0x255ff5(0x2ec)]('variation-quantity-display')[_0x255ff5(0x15f)]='1';const _0x2cdb0b=document[_0x255ff5(0x2ec)](_0x255ff5(0xb49)),_0x5a4681=_0x2cdb0b[_0x255ff5(0x303)](!![]);_0x2cdb0b['parentNode']['replaceChild'](_0x5a4681,_0x2cdb0b),_0x5a4681[_0x255ff5(0xf79)](_0x255ff5(0x1177),async()=>{const _0x4d21d7=_0x255ff5,_0x34634c=_0x22482a[_0x4d21d7(0x765)](_0x4d21d7(0x1077)),_0x2b4764=parseInt(document[_0x4d21d7(0x2ec)]('variation-quantity-display')[_0x4d21d7(0x15f)]);if(_0x34634c){const _0x5f377c=_0x17a495[_0x4d21d7(0xaab)][parseInt(_0x34634c[_0x4d21d7(0x11a4)])];await _0x229d95(_0x34b4b4,_0x2b4764,_0x5f377c),_0x26db67[_0x4d21d7(0xff6)][_0x4d21d7(0x1424)](_0x4d21d7(0x149d)),await _0x34d596('成功','已成功加入购物车！');}}),_0x26db67[_0x255ff5(0xff6)][_0x255ff5(0xe82)]('visible');}function _0x33a97f(){const _0x5403f6=_0x475790,_0x5d4376=document['getElementById']('shopping-settings-modal');document['getElementById'](_0x5403f6(0x1f5))['value']=_0x28f30a[_0x5403f6(0x1062)][_0x5403f6(0x1da)]||0x3,document[_0x5403f6(0x2ec)](_0x5403f6(0x50b))[_0x5403f6(0x11a4)]=_0x28f30a[_0x5403f6(0x1062)][_0x5403f6(0x1190)]||0x8,_0x5d4376[_0x5403f6(0xff6)][_0x5403f6(0xe82)](_0x5403f6(0x149d));}async function _0x237298(){const _0x192ca7=_0x475790,_0x4e0b3b=document[_0x192ca7(0x2ec)](_0x192ca7(0x1f5)),_0x246551=document[_0x192ca7(0x2ec)]('shopping-product-count-input'),_0x26f926=parseInt(_0x4e0b3b[_0x192ca7(0x11a4)]),_0x269484=parseInt(_0x246551['value']);if(isNaN(_0x26f926)||isNaN(_0x269484)||_0x26f926<0x1||_0x269484<0x1){alert('请输入有效的正整数！');return;}_0x28f30a[_0x192ca7(0x1062)][_0x192ca7(0x1da)]=_0x26f926,_0x28f30a[_0x192ca7(0x1062)]['shoppingProductCount']=_0x269484,await _0x5b9d83[_0x192ca7(0x1062)][_0x192ca7(0x7c3)](_0x28f30a['globalSettings']),document[_0x192ca7(0x2ec)]('shopping-settings-modal')['classList'][_0x192ca7(0x1424)]('visible'),await _0x34d596(_0x192ca7(0x1dd),_0x192ca7(0x35f));}async function _0x2176f7(){const _0x347350=_0x475790;if(!_0x28f30a['activeChatId']){await _0x34d596(_0x347350(0x221),'请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。');return;}const _0x4ea980=_0x28f30a[_0x347350(0x6ce)][_0x28f30a[_0x347350(0x11b9)]],_0x3472c2=await _0x4436ba('为“'+_0x4ea980[_0x347350(0xe36)]+_0x347350(0x68d),_0x347350(0xc30),{'confirmText':'确认生成'});if(!_0x3472c2)return;await _0x34d596('请稍候...','正在根据“'+_0x4ea980['name']+_0x347350(0x12f1));const _0x36177e=_0x28f30a[_0x347350(0x1537)][_0x347350(0xcf0)]&&_0x28f30a[_0x347350(0x1537)]['secondaryApiKey']&&_0x28f30a['apiConfig']['secondaryModel'],{proxyUrl:_0x347d6a,apiKey:_0x3cb045,model:_0x5a018e}=_0x36177e?{'proxyUrl':_0x28f30a['apiConfig'][_0x347350(0xcf0)],'apiKey':_0x28f30a['apiConfig']['secondaryApiKey'],'model':_0x28f30a[_0x347350(0x1537)][_0x347350(0xf3f)]}:_0x28f30a[_0x347350(0x1537)];if(!_0x347d6a||!_0x3cb045||!_0x5a018e){await _0x34d596(_0x347350(0x5ff),_0x347350(0x9e1));return;}const _0x2f95e9=_0x28f30a[_0x347350(0x1062)][_0x347350(0x1da)]||0x3,_0xf0603d=_0x28f30a[_0x347350(0x1062)][_0x347350(0x1190)]||0x8,_0x1d0eb5=await _0x5b9d83[_0x347350(0x1117)][_0x347350(0x14b5)]();let _0x51013c='';_0x1d0eb5[_0x347350(0x9a1)]>0x0&&(_0x51013c=_0x347350(0x10cf)+_0x1d0eb5[_0x347350(0x11c6)](_0xb7908=>'\x22'+_0xb7908[_0x347350(0xe36)]+'\x22')[_0x347350(0xbad)](',\x20')+']\x0a');const _0x29ac11=_0x28f30a[_0x347350(0x1506)][_0x347350(0x19a)]||'我',_0x1bf2da=_0x4ea980['longTermMemory']&&_0x4ea980[_0x347350(0x153f)][_0x347350(0x9a1)]>0x0?_0x4ea980[_0x347350(0x153f)][_0x347350(0x11c6)](_0x500780=>_0x347350(0x151a)+_0xf1c86d(_0x500780[_0x347350(0x69a)])+')\x20'+_0x500780['content'])['join']('\x0a'):'无',_0x27307c=_0x4ea980[_0x347350(0x12c3)]['slice'](-0xa)[_0x347350(0x11c6)](_0x23d6de=>(_0x23d6de[_0x347350(0x9be)]===_0x347350(0xcc9)?_0x29ac11:_0x4ea980[_0x347350(0xe36)])+':\x20'+String(_0x23d6de[_0x347350(0x1047)])['substring'](0x0,0x1e)+_0x347350(0x4e6))[_0x347350(0xbad)]('\x0a');let _0x266528='';if(_0x4ea980[_0x347350(0x362)]['linkedWorldBookIds']&&_0x4ea980[_0x347350(0x362)][_0x347350(0x684)][_0x347350(0x9a1)]>0x0){const _0x54dcbf=_0x4ea980[_0x347350(0x362)][_0x347350(0x684)][_0x347350(0x11c6)](_0x116376=>{const _0x593201=_0x347350,_0x247c73=_0x28f30a[_0x593201(0x13b9)][_0x593201(0x412)](_0x354ae3=>_0x354ae3['id']===_0x116376);if(!_0x247c73||!Array[_0x593201(0x624)](_0x247c73[_0x593201(0x1047)]))return'';const _0x81d022=_0x247c73['content'][_0x593201(0xebc)](_0x24d752=>_0x24d752['enabled']!==![])[_0x593201(0x11c6)](_0x430486=>'-\x20'+_0x430486[_0x593201(0x1047)])[_0x593201(0xbad)]('\x0a');return _0x81d022?_0x593201(0x148a)+_0x247c73[_0x593201(0xe36)]+_0x593201(0xc35)+_0x81d022:'';})[_0x347350(0xebc)](Boolean)[_0x347350(0xbad)]('');_0x54dcbf&&(_0x266528=_0x347350(0xebf)+_0x54dcbf+'\x0a');}const _0x3b6d09=_0x347350(0x1390)+_0x4ea980[_0x347350(0xe36)]+_0x347350(0x1180)+_0x2f95e9+_0x347350(0xdc6)+_0xf0603d+'\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20'+_0x4ea980[_0x347350(0xe36)]+'\x0a-\x20**角色人设**:\x20'+_0x4ea980['settings'][_0x347350(0x67c)]+'\x0a-\x20**长期记忆**:\x20'+_0x1bf2da+_0x347350(0xa9e)+_0x266528+'\x0a'+_0x51013c+_0x347350(0x379)+_0x27307c+_0x347350(0x10d7)+_0x4ea980['name']+_0x347350(0x99b);try{const _0x2b94e9=[{'role':_0x347350(0xcc9),'content':_0x347350(0x914)}];let _0x36421f=_0x347d6a[_0x347350(0x138a)](_0x347350(0xe9c)),_0x380069=_0x4fff3d(_0x5a018e,_0x3cb045,_0x3b6d09,_0x2b94e9);const _0x41f916=_0x36421f?await fetch(_0x380069[_0x347350(0x6d1)],_0x380069[_0x347350(0x1418)]):await fetch(_0x347d6a+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x347350(0x1446),'Authorization':_0x347350(0xe83)+_0x3cb045},'body':JSON[_0x347350(0xe4d)]({'model':_0x5a018e,'messages':[{'role':'system','content':_0x3b6d09},..._0x2b94e9],'temperature':_0x28f30a[_0x347350(0x1062)]['apiTemperature']||0.9})});if(!_0x41f916['ok'])throw new Error('API\x20错误:\x20'+_0x41f916[_0x347350(0x1066)]);const _0xe5fc8f=await _0x41f916[_0x347350(0x12a2)](),_0x4069ff=getGeminiResponseText(_0xe5fc8f),_0x3d311c=_0x4069ff[_0x347350(0x49a)](/({[\s\S]*})/);if(!_0x3d311c)throw new Error(_0x347350(0xea5));const _0x3ceaf4=JSON[_0x347350(0xd91)](_0x3d311c[0x0]);if(!_0x3ceaf4[_0x347350(0xd31)]||!Array['isArray'](_0x3ceaf4[_0x347350(0xd31)]))throw new Error(_0x347350(0xe12));await _0x5b9d83[_0x347350(0xe5b)]('rw',_0x5b9d83[_0x347350(0x120e)],_0x5b9d83[_0x347350(0x1117)],async()=>{const _0x15f24c=_0x347350;for(const _0x198bd0 of _0x3ceaf4['categories']){let _0x11cf48;const _0x4a0728=await _0x5b9d83[_0x15f24c(0x1117)][_0x15f24c(0x67e)](_0x15f24c(0xe36))[_0x15f24c(0x5e2)](_0x198bd0[_0x15f24c(0xe36)])[_0x15f24c(0x942)]();_0x4a0728?_0x11cf48=_0x4a0728['id']:_0x11cf48=await _0x5b9d83[_0x15f24c(0x1117)][_0x15f24c(0xe82)]({'name':_0x198bd0[_0x15f24c(0xe36)]});const _0x3139de=_0x198bd0[_0x15f24c(0xfaa)][_0x15f24c(0x11c6)](_0x26c7d8=>{const _0x2c2391=_0x15f24c;return{'name':_0x26c7d8[_0x2c2391(0xe36)],'price':_0x26c7d8[_0x2c2391(0x1309)]||0x0,'description':_0x26c7d8[_0x2c2391(0x9cc)]||'','imageUrl':'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x26c7d8[_0x2c2391(0xe8f)]),'variations':(_0x26c7d8[_0x2c2391(0xaab)]||[])['map'](_0x480098=>({..._0x480098,'imageUrl':_0x2c2391(0x6d0)+encodeURIComponent(_0x480098[_0x2c2391(0xe8f)])})),'categoryId':_0x11cf48};});_0x3139de[_0x15f24c(0x9a1)]>0x0&&await _0x5b9d83['shoppingProducts'][_0x15f24c(0x11f3)](_0x3139de);}}),activeShoppingCategoryId=_0x347350(0xa92),await _0x275258(),await _0x34d596(_0x347350(0x456),'为“'+_0x4ea980[_0x347350(0xe36)]+_0x347350(0xb34));}catch(_0x121c89){console[_0x347350(0x1518)](_0x347350(0x709),_0x121c89),await _0x34d596(_0x347350(0x1ea),'无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20'+_0x121c89['message']);}}async function _0x3cc22b(_0x10c904){const _0x3481ca=_0x475790,_0x4902a9=document[_0x3481ca(0x2ec)](_0x10c904);if(!_0x4902a9)return;const _0x8805b3=await _0x3d2f35(_0x3481ca(0x692),[{'text':_0x3481ca(0xdc3),'value':'local'},{'text':_0x3481ca(0x1173),'value':_0x3481ca(0x6d1)}]);let _0xa8dc9f=null;if(_0x8805b3===_0x3481ca(0x252))_0xa8dc9f=await _0x1fcca6();else _0x8805b3===_0x3481ca(0x6d1)&&(_0xa8dc9f=await _0x33419a('更换图片',_0x3481ca(0x156c),_0x4902a9[_0x3481ca(0xce4)],_0x3481ca(0x6d1)));if(_0xa8dc9f&&_0xa8dc9f[_0x3481ca(0x97e)]()){const _0x171773=_0xa8dc9f[_0x3481ca(0x97e)]();_0x4902a9['src']=_0x171773,!_0x28f30a[_0x3481ca(0x1062)][_0x3481ca(0x14f7)]&&(_0x28f30a['globalSettings'][_0x3481ca(0x14f7)]={}),_0x28f30a[_0x3481ca(0x1062)][_0x3481ca(0x14f7)][_0x10c904]=_0x171773,await _0x5b9d83[_0x3481ca(0x1062)][_0x3481ca(0x7c3)](_0x28f30a[_0x3481ca(0x1062)]),await _0x34d596('成功',_0x3481ca(0xbf4));}}window[_0x475790(0x1ec)]=_0x3cc22b;async function _0x112432(){const _0x1cea29=_0x475790;if(!window[_0x1cea29(0x1349)]||typeof JSZip===_0x1cea29(0xe40)){await _0x34d596(_0x1cea29(0xe2d),_0x1cea29(0x6f7));return;}await _0x34d596(_0x1cea29(0x1150),_0x1cea29(0x42d));const _0x435ae4=streamSaver[_0x1cea29(0x14ad)]('EPhone-Sliced-Backup-'+new Date()[_0x1cea29(0xaf8)]()[_0x1cea29(0xa8a)]('T')[0x0]+_0x1cea29(0x2b0)),_0x3d335f=new JSZip(),_0x2fada1=0x5f*0x400*0x400;let _0x30f195=0x1,_0x51a326={},_0x502f3a=0x0;const _0x4ae45e=new TextEncoder();try{const _0x3954af=_0x5b9d83[_0x1cea29(0x7ed)]['map'](_0x4820a8=>_0x4820a8[_0x1cea29(0xe36)]);for(const _0x3f714b of _0x3954af){console[_0x1cea29(0x415)](_0x1cea29(0x116a)+_0x3f714b+_0x1cea29(0x4e6));const _0x2f9c17=await _0x5b9d83['table'](_0x3f714b)[_0x1cea29(0x14b5)]();if(_0x2f9c17[_0x1cea29(0x9a1)]===0x0)continue;const _0x17830b=JSON[_0x1cea29(0xe4d)](_0x2f9c17),_0x5e18bd=_0x4ae45e[_0x1cea29(0x27c)](_0x17830b)['length'];if(_0x5e18bd>_0x2fada1){console[_0x1cea29(0x664)](_0x1cea29(0x111b)+_0x3f714b+_0x1cea29(0x1304)+(_0x5e18bd/0x400/0x400)[_0x1cea29(0x5c3)](0x2)+_0x1cea29(0x14c2));_0x502f3a>0x0&&(_0x3d335f[_0x1cea29(0xc9d)](_0x1cea29(0x254)+_0x30f195++ +'.json',JSON[_0x1cea29(0xe4d)]({'version':0x4,'type':'slice','data':_0x51a326})),_0x51a326={},_0x502f3a=0x0);_0x51a326[_0x3f714b]=_0x2f9c17,_0x3d335f[_0x1cea29(0xc9d)](_0x1cea29(0x254)+_0x30f195++ +'.json',JSON[_0x1cea29(0xe4d)]({'version':0x4,'type':_0x1cea29(0x225),'data':_0x51a326})),_0x51a326={},_0x502f3a=0x0;continue;}_0x502f3a>0x0&&_0x502f3a+_0x5e18bd>_0x2fada1&&(console[_0x1cea29(0x415)]('切片\x20'+_0x30f195+'\x20已满\x20(大小:\x20'+(_0x502f3a/0x400/0x400)[_0x1cea29(0x5c3)](0x2)+_0x1cea29(0x30a)),_0x3d335f['file']('slice_'+_0x30f195++ +'.json',JSON[_0x1cea29(0xe4d)]({'version':0x4,'type':_0x1cea29(0x225),'data':_0x51a326})),_0x51a326={},_0x502f3a=0x0),_0x51a326[_0x3f714b]=_0x2f9c17,_0x502f3a+=_0x5e18bd;}_0x502f3a>0x0&&(console[_0x1cea29(0x415)](_0x1cea29(0x2b6)+_0x30f195+_0x1cea29(0xd7f)+(_0x502f3a/0x400/0x400)[_0x1cea29(0x5c3)](0x2)+_0x1cea29(0x698)),_0x3d335f[_0x1cea29(0xc9d)](_0x1cea29(0x254)+_0x30f195+_0x1cea29(0x44e),JSON[_0x1cea29(0xe4d)]({'version':0x4,'type':'slice','data':_0x51a326})));console[_0x1cea29(0x415)](_0x1cea29(0xedd));const _0x1a7573=_0x3d335f[_0x1cea29(0x46b)]({'type':'blob','streamFiles':!![]}),_0x46ed3d=new ReadableStream({'start'(_0x2370f3){const _0x31a147=_0x1cea29;_0x1a7573['on'](_0x31a147(0x1418),_0x474eba=>{const _0x3065eb=_0x31a147;_0x2370f3[_0x3065eb(0xe3e)](_0x474eba);})['on'](_0x31a147(0x1316),()=>{const _0x1bc19d=_0x31a147;console[_0x1bc19d(0x415)](_0x1bc19d(0xd1d)),_0x2370f3[_0x1bc19d(0x785)]();})['on'](_0x31a147(0x1518),_0x3b100b=>{const _0x19dcba=_0x31a147;console['error']('JSZip\x20流错误:',_0x3b100b),_0x2370f3[_0x19dcba(0x1518)](_0x3b100b);})[_0x31a147(0x1561)]();}});await _0x46ed3d['pipeTo'](_0x435ae4),await _0x34d596(_0x1cea29(0x13d6),_0x1cea29(0x41b));}catch(_0x293a01){console[_0x1cea29(0x1518)](_0x1cea29(0xd51),_0x293a01),await _0x34d596('导出失败',_0x1cea29(0xe16)+_0x293a01['message']);try{const _0x160342=_0x435ae4[_0x1cea29(0xd35)]();_0x160342[_0x1cea29(0x478)](_0x293a01);}catch(_0x4f2650){}}}async function _0x4f5cd(){const _0x25bacd=_0x475790;if(!window[_0x25bacd(0x1349)]){alert('流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。');return;}await _0x34d596(_0x25bacd(0x88d),_0x25bacd(0xe25));const _0x5da859=streamSaver[_0x25bacd(0x14ad)](_0x25bacd(0x935)+new Date()[_0x25bacd(0xaf8)]()[_0x25bacd(0xa8a)]('T')[0x0]+_0x25bacd(0x44e)),_0x3214cb=_0x5da859[_0x25bacd(0xd35)](),_0x5998b9=new TextEncoder();try{await _0x3214cb[_0x25bacd(0xf38)](_0x5998b9['encode'](_0x25bacd(0x108f)+Date['now']()+_0x25bacd(0xb88)));const _0xd84922=await _0x5b9d83[_0x25bacd(0x7ed)][_0x25bacd(0x11c6)](_0x453708=>_0x453708[_0x25bacd(0xe36)]);for(let _0x446550=0x0;_0x446550<_0xd84922[_0x25bacd(0x9a1)];_0x446550++){const _0x556cea=_0xd84922[_0x446550],_0x12cea6=_0x5b9d83[_0x25bacd(0xd32)](_0x556cea);await _0x3214cb['write'](_0x5998b9[_0x25bacd(0x27c)]('\x22'+_0x556cea+_0x25bacd(0x14f0)));let _0x45957b=!![];await _0x12cea6[_0x25bacd(0x13ce)](_0x242ef5=>{const _0x38910e=_0x25bacd;!_0x45957b&&_0x3214cb[_0x38910e(0xf38)](_0x5998b9[_0x38910e(0x27c)](',\x0a')),_0x3214cb['write'](_0x5998b9['encode'](JSON[_0x38910e(0xe4d)](_0x242ef5))),_0x45957b=![];}),await _0x3214cb[_0x25bacd(0xf38)](_0x5998b9[_0x25bacd(0x27c)]('\x0a]')),_0x446550<_0xd84922[_0x25bacd(0x9a1)]-0x1&&await _0x3214cb[_0x25bacd(0xf38)](_0x5998b9[_0x25bacd(0x27c)](',\x0a'));}await _0x3214cb[_0x25bacd(0xf38)](_0x5998b9[_0x25bacd(0x27c)]('\x0a}\x0a}'));}catch(_0x1a9362){console[_0x25bacd(0x1518)](_0x25bacd(0x108e),_0x1a9362),await _0x34d596(_0x25bacd(0x4aa),'在写入文件流时发生错误:\x20'+_0x1a9362[_0x25bacd(0x13bc)]);}finally{await _0x3214cb[_0x25bacd(0x785)]();}}async function _0x5b33fa(){const _0x465829=_0x475790;await _0x34d596(_0x465829(0x88d),_0x465829(0x31b));try{const _0x32e4eb={'version':0x3,'timestamp':Date[_0x465829(0x487)](),'data':{}},_0x3b1208=_0x5b9d83[_0x465829(0x7ed)][_0x465829(0x11c6)](_0x5d1c23=>_0x5d1c23[_0x465829(0xe36)]);for(const _0x35ac90 of _0x3b1208){const _0x5764ca=await _0x5b9d83['table'](_0x35ac90)[_0x465829(0x14b5)]();_0x32e4eb['data'][_0x35ac90]=_0x5764ca,console[_0x465829(0x415)](_0x465829(0x768)+_0x35ac90+_0x465829(0x7c4)+_0x5764ca[_0x465829(0x9a1)]);}const _0xaa590e=new Blob([JSON[_0x465829(0xe4d)](_0x32e4eb,null,0x2)],{'type':_0x465829(0x1446)}),_0x314342=URL[_0x465829(0x23d)](_0xaa590e),_0x7f4f76=document[_0x465829(0x14ae)]('a');_0x7f4f76[_0x465829(0xe15)]=_0x314342,_0x7f4f76[_0x465829(0x3eb)]='EPhone-Full-Backup-Legacy-'+new Date()[_0x465829(0xaf8)]()['split']('T')[0x0]+_0x465829(0x44e),_0x7f4f76[_0x465829(0x1177)](),URL[_0x465829(0x18d)](_0x314342),await _0x34d596(_0x465829(0x583),_0x465829(0xf7d));}catch(_0x2126e8){console[_0x465829(0x1518)](_0x465829(0x974),_0x2126e8),await _0x34d596('导出失败',_0x465829(0x5a6)+_0x2126e8[_0x465829(0x13bc)]);}}function _0x4a1a61(){const _0x1bce40=_0x475790,_0x2b1fca=Object[_0x1bce40(0x74e)](_0x28f30a[_0x1bce40(0x6ce)])[_0x1bce40(0xcdd)]((_0x47834b,_0x4197b8)=>{const _0x3b058c=_0x1bce40;if(_0x4197b8['id']===_0x28f30a[_0x3b058c(0x11b9)])return _0x47834b;return _0x47834b+(_0x4197b8['unreadCount']||0x0);},0x0),_0x63d7dc=_0x461b99||0x0,_0x28993d=_0x2b1fca+_0x63d7dc,_0xa8054e=document[_0x1bce40(0x2ec)](_0x1bce40(0x1394));if(!_0xa8054e)return;let _0x3edd32=_0xa8054e['querySelector']('.unread-indicator');!_0x3edd32&&(_0x3edd32=document[_0x1bce40(0x14ae)](_0x1bce40(0xf82)),_0x3edd32[_0x1bce40(0xdd1)]=_0x1bce40(0xdb3),_0xa8054e['appendChild'](_0x3edd32));let _0x41f3f7=_0xa8054e[_0x1bce40(0x765)](_0x1bce40(0xc0c));_0x41f3f7&&_0x41f3f7[_0x1bce40(0x1424)](),_0x28993d>0x0?(_0x3edd32['textContent']=_0x28993d>0x63?_0x1bce40(0x21a):_0x28993d,_0x3edd32[_0x1bce40(0x589)][_0x1bce40(0x701)]='block',_0x3edd32[_0x1bce40(0x589)]['zIndex']='20',_0x3edd32[_0x1bce40(0x589)][_0x1bce40(0x1244)]='scale(0.8)'):_0x3edd32['style'][_0x1bce40(0x701)]=_0x1bce40(0x5b1);}async function _0x13dbaf(_0x319b01){const _0x3621b8=_0x475790,_0x1244ed=_0x319b01===_0x3621b8(0x17c)?{'id':_0x3621b8(0x17c),'name':_0x3621b8(0x5d8)}:await _0x5b9d83[_0x3621b8(0xc70)][_0x3621b8(0x6b5)](_0x319b01);if(!_0x1244ed){console[_0x3621b8(0x1518)](_0x3621b8(0xeb2),_0x319b01);return;}const _0x18737d=document['getElementById'](_0x3621b8(0x31e)),_0x25bfd4=document[_0x3621b8(0x2ec)](_0x3621b8(0x1bf)),_0x35df3d=_0x18737d[_0x3621b8(0x765)](_0x3621b8(0x3bf));_0x25bfd4[_0x3621b8(0xc43)]='',_0x35df3d[_0x3621b8(0x15f)]=_0x3621b8(0xcb1)+_0x1244ed[_0x3621b8(0xe36)]+'”\x20绑定到...';const _0x17ad43=Object[_0x3621b8(0x74e)](_0x28f30a[_0x3621b8(0x6ce)])['sort']((_0x1e6f6e,_0x1fae96)=>_0x1e6f6e[_0x3621b8(0xe36)][_0x3621b8(0x57b)](_0x1fae96[_0x3621b8(0xe36)],'zh-CN'));_0x17ad43['forEach'](_0x5cd02b=>{const _0x18fca1=_0x3621b8,_0x364b01=Array[_0x18fca1(0x624)](_0x5cd02b['settings']?.['stickerCategoryIds'])&&_0x5cd02b[_0x18fca1(0x362)]['stickerCategoryIds']['includes'](_0x319b01),_0x203ec7=document[_0x18fca1(0x14ae)](_0x18fca1(0xaa5));_0x203ec7[_0x18fca1(0xdd1)]=_0x18fca1(0x11c2),_0x203ec7[_0x18fca1(0xc43)]=_0x18fca1(0x104d)+_0x5cd02b['id']+'\x22\x20'+(_0x364b01?_0x18fca1(0x13b8):'')+_0x18fca1(0x2ab)+(_0x5cd02b[_0x18fca1(0x1423)]?_0x5cd02b[_0x18fca1(0x362)][_0x18fca1(0x42c)]:_0x5cd02b[_0x18fca1(0x362)][_0x18fca1(0xe91)]||_0x825cf1)+_0x18fca1(0xfc7)+_0x5cd02b['name']+_0x18fca1(0xc69),_0x25bfd4[_0x18fca1(0x998)](_0x203ec7);}),document[_0x3621b8(0x2ec)](_0x3621b8(0xd70))[_0x3621b8(0x6b6)]=()=>_0x222fc1(_0x319b01),document['getElementById']('cancel-sticker-binding-btn')['onclick']=()=>_0x18737d[_0x3621b8(0xff6)]['remove']('visible'),_0x18737d[_0x3621b8(0xff6)][_0x3621b8(0xe82)](_0x3621b8(0x149d));}async function _0x222fc1(_0x5faa1a){const _0x4e13a0=_0x475790,_0x52c40c=new Set(Array[_0x4e13a0(0x13d1)](document['querySelectorAll'](_0x4e13a0(0xd09)))[_0x4e13a0(0x11c6)](_0x7ed3ad=>_0x7ed3ad['dataset'][_0x4e13a0(0xdd0)])),_0x29ee45=[];for(const _0x307c25 in _0x28f30a[_0x4e13a0(0x6ce)]){const _0x4bf4e9=_0x28f30a[_0x4e13a0(0x6ce)][_0x307c25];!Array[_0x4e13a0(0x624)](_0x4bf4e9[_0x4e13a0(0x362)][_0x4e13a0(0xb1f)])&&(_0x4bf4e9[_0x4e13a0(0x362)][_0x4e13a0(0xb1f)]=[]);const _0x18d743=_0x4bf4e9[_0x4e13a0(0x362)][_0x4e13a0(0xb1f)][_0x4e13a0(0x138a)](_0x5faa1a),_0x17682c=_0x52c40c[_0x4e13a0(0xbf1)](_0x307c25);if(_0x18d743&&!_0x17682c)_0x4bf4e9[_0x4e13a0(0x362)]['stickerCategoryIds']=_0x4bf4e9['settings']['stickerCategoryIds'][_0x4e13a0(0xebc)](_0x405a63=>_0x405a63!==_0x5faa1a),_0x29ee45[_0x4e13a0(0x367)](_0x4bf4e9);else!_0x18d743&&_0x17682c&&(_0x4bf4e9[_0x4e13a0(0x362)][_0x4e13a0(0xb1f)][_0x4e13a0(0x367)](_0x5faa1a),_0x29ee45[_0x4e13a0(0x367)](_0x4bf4e9));}_0x29ee45['length']>0x0&&(await _0x5b9d83[_0x4e13a0(0x6ce)]['bulkPut'](_0x29ee45),await _0x34d596(_0x4e13a0(0x1dd),'表情包分类绑定已更新！')),document['getElementById'](_0x4e13a0(0x31e))[_0x4e13a0(0xff6)][_0x4e13a0(0x1424)](_0x4e13a0(0x149d));}function _0x23eb2e(_0x498e4d){const _0xb813a5=_0x475790;if(!_0x498e4d||!_0x498e4d[_0xb813a5(0x362)][_0xb813a5(0xb1f)]||_0x498e4d[_0xb813a5(0x362)][_0xb813a5(0xb1f)]['length']===0x0)return'';const _0x24445a=_0x498e4d[_0xb813a5(0x362)]['stickerCategoryIds'];let _0x34987c=[];const _0x1eaff9=new Set();_0x24445a[_0xb813a5(0xf99)](_0x13fea4=>{const _0x21828b=_0xb813a5;let _0x37a2cd;_0x13fea4==='uncategorized'?_0x37a2cd=_0x28f30a[_0x21828b(0xf28)][_0x21828b(0xebc)](_0x59b1f7=>!_0x59b1f7[_0x21828b(0x10ce)]):_0x37a2cd=_0x28f30a[_0x21828b(0xf28)][_0x21828b(0xebc)](_0x28d11b=>_0x28d11b[_0x21828b(0x10ce)]===_0x13fea4),_0x37a2cd[_0x21828b(0xf99)](_0x248721=>{const _0x3b2467=_0x21828b;!_0x1eaff9[_0x3b2467(0xbf1)](_0x248721[_0x3b2467(0xe36)])&&(_0x34987c[_0x3b2467(0x367)](_0x248721),_0x1eaff9['add'](_0x248721[_0x3b2467(0xe36)]));});});if(_0x34987c[_0xb813a5(0x9a1)]===0x0)return'';const _0xcde04e=_0x34987c[_0xb813a5(0x11c6)](_0x118801=>'-\x20'+_0x118801[_0xb813a5(0xe36)])[_0xb813a5(0xbad)]('\x0a');return _0xb813a5(0x403)+_0xcde04e+'\x0a';}function _0x2dece1(_0x2dff2d){const _0x1e1896=_0x475790;if(!_0x2dff2d||!_0x2dff2d['isGroup'])return'';let _0x4aa426='\x0a#\x20可用表情包\x20(优先使用)\x0a每个AI角色都被设置了专属表情包，在需要发送表情时，他们应该【优先】从自己的专属列表中选择。尽量让你的表情丰富多样，避免重复。\x0a',_0x1fe942=![];return _0x2dff2d[_0x1e1896(0x10f2)][_0x1e1896(0xf99)](_0x3e0b10=>{const _0x5f231b=_0x1e1896;if(_0x3e0b10['id']===_0x5f231b(0xcc9))return;const _0x2dc202=_0x28f30a[_0x5f231b(0x6ce)][_0x3e0b10['id']];if(_0x2dc202&&_0x2dc202[_0x5f231b(0x362)][_0x5f231b(0xb1f)]&&_0x2dc202[_0x5f231b(0x362)]['stickerCategoryIds'][_0x5f231b(0x9a1)]>0x0){const _0x9ab4b=_0x2dc202[_0x5f231b(0x362)]['stickerCategoryIds'];let _0x4ffa07=[];const _0x16bbe8=new Set();_0x9ab4b[_0x5f231b(0xf99)](_0x448d29=>{const _0xe09c5=_0x5f231b;let _0x43a2ea;_0x448d29==='uncategorized'?_0x43a2ea=_0x28f30a[_0xe09c5(0xf28)]['filter'](_0x498310=>!_0x498310[_0xe09c5(0x10ce)]):_0x43a2ea=_0x28f30a[_0xe09c5(0xf28)][_0xe09c5(0xebc)](_0x5ec154=>_0x5ec154[_0xe09c5(0x10ce)]===_0x448d29),_0x43a2ea[_0xe09c5(0xf99)](_0xacf2b1=>{const _0xf0fd0=_0xe09c5;!_0x16bbe8['has'](_0xacf2b1[_0xf0fd0(0xe36)])&&(_0x4ffa07[_0xf0fd0(0x367)](_0xacf2b1),_0x16bbe8[_0xf0fd0(0xe82)](_0xacf2b1[_0xf0fd0(0xe36)]));});}),_0x4ffa07['length']>0x0&&(_0x1fe942=!![],_0x4aa426+=_0x5f231b(0xa2e)+_0x3e0b10['groupNickname']+_0x5f231b(0xc17)+_0x3e0b10[_0x5f231b(0x66c)]+_0x5f231b(0x747),_0x4aa426+=_0x4ffa07[_0x5f231b(0x11c6)](_0x252d6e=>'-\x20'+_0x252d6e[_0x5f231b(0xe36)])[_0x5f231b(0xbad)]('\x0a'));}}),_0x1fe942?_0x4aa426:'';}function _0x16e225(_0x23d168){const _0x725b66=_0x475790;if(!_0x23d168)return 0x0;return Math[_0x725b66(0xda0)](_0x23d168[_0x725b66(0x9a1)]/1.5);}async function _0x7cd12b(){const _0x39b810=_0x475790;if(!_0x28f30a[_0x39b810(0x11b9)])return 0x0;const _0x4409be=_0x28f30a[_0x39b810(0x6ce)][_0x28f30a['activeChatId']];if(!_0x4409be)return 0x0;const _0x3437d8=parseInt(document[_0x39b810(0x2ec)](_0x39b810(0xda2))[_0x39b810(0x11a4)])||0xa,_0xcbcb4f=parseInt(document['getElementById'](_0x39b810(0x8b3))[_0x39b810(0x11a4)])||0xa,_0x5df83e=document[_0x39b810(0x2ec)](_0x39b810(0x1282))['checked'],_0x3e8dc9=document[_0x39b810(0x2ec)]('ai-persona')[_0x39b810(0x11a4)],_0x10828e=document[_0x39b810(0x2ec)]('my-persona')[_0x39b810(0x11a4)];let _0x5d9c39='';const _0x24aa15=Array[_0x39b810(0x13d1)](document[_0x39b810(0x5d6)](_0x39b810(0x90b)))[_0x39b810(0x11c6)](_0x597cb2=>_0x597cb2[_0x39b810(0x11a4)][_0x39b810(0x13ed)]('book_',''));if(_0x24aa15[_0x39b810(0x9a1)]>0x0){const _0x5dc70e=_0x24aa15[_0x39b810(0x11c6)](_0x207159=>{const _0x816eb7=_0x39b810,_0x57c619=_0x28f30a[_0x816eb7(0x13b9)][_0x816eb7(0x412)](_0x535214=>_0x535214['id']===_0x207159);if(!_0x57c619||!Array['isArray'](_0x57c619[_0x816eb7(0x1047)]))return'';return _0x57c619[_0x816eb7(0x1047)][_0x816eb7(0xebc)](_0x1caf30=>_0x1caf30[_0x816eb7(0x400)]!==![])['map'](_0x198545=>_0x198545[_0x816eb7(0x1047)])[_0x816eb7(0xbad)]('\x0a');})[_0x39b810(0xebc)](Boolean)[_0x39b810(0xbad)]('\x0a');_0x5d9c39+=_0x5dc70e;}_0x4409be[_0x39b810(0x153f)]&&_0x4409be[_0x39b810(0x153f)][_0x39b810(0x9a1)]>0x0&&(_0x5d9c39+=_0x4409be[_0x39b810(0x153f)][_0x39b810(0x11c6)](_0x11140c=>_0x11140c[_0x39b810(0x1047)])[_0x39b810(0xbad)]('\x0a'));const _0x594634=document['getElementById'](_0x39b810(0x995))['checked'];if(_0x594634){const _0x2a7d09=Array['from'](document[_0x39b810(0x5d6)](_0x39b810(0x3d7)))['map'](_0x2e6fa4=>_0x2e6fa4[_0x39b810(0x11a4)]);for(const _0x42bc79 of _0x2a7d09){const _0x5dce34=_0x28f30a[_0x39b810(0x6ce)][_0x42bc79];_0x5dce34&&_0x5dce34[_0x39b810(0x12c3)][_0x39b810(0x9a1)]>0x0&&(_0x5d9c39+=_0x5dce34[_0x39b810(0x12c3)][_0x39b810(0x225)](-_0xcbcb4f)[_0x39b810(0x11c6)](_0x47891d=>String(_0x47891d[_0x39b810(0x1047)]))[_0x39b810(0xbad)]('\x0a'));}}_0x4409be['isGroup']?_0x4409be[_0x39b810(0x10f2)][_0x39b810(0xf99)](_0xd149e2=>{const _0x533bed=_0x39b810;_0x5d9c39+=_0xd149e2[_0x533bed(0xe32)];}):_0x5d9c39+=_0x3e8dc9;_0x5d9c39+=_0x10828e,_0x5d9c39+=_0x23eb2e(_0x4409be);_0x4409be['isGroup']&&(_0x5d9c39+=_0x2dece1(_0x4409be));if(!_0x4409be[_0x39b810(0x1423)]&&_0x5df83e){const _0x2dde49=document[_0x39b810(0x2ec)](_0x39b810(0x1192))[_0x39b810(0x11a4)];if(_0x2dde49){const _0x107dad=_0x28f30a[_0x39b810(0x1504)][_0x39b810(0x412)](_0x4b39a4=>_0x4b39a4['id']===_0x2dde49);_0x107dad&&(_0x5d9c39+=_0x107dad[_0x39b810(0x1047)][_0x39b810(0xebc)](_0x1ae4ee=>_0x1ae4ee[_0x39b810(0x400)]!==![])[_0x39b810(0x11c6)](_0x2d8025=>_0x2d8025[_0x39b810(0x1047)])[_0x39b810(0xbad)]('\x0a'));}}const _0x1237c0=_0x4409be[_0x39b810(0x12c3)]['slice'](-_0x3437d8);return _0x5d9c39+=_0x1237c0[_0x39b810(0x11c6)](_0x5acaac=>{const _0x406be3=_0x39b810;if(typeof _0x5acaac[_0x406be3(0x1047)]==='string')return _0x5acaac[_0x406be3(0x1047)];if(Array['isArray'](_0x5acaac[_0x406be3(0x1047)]))return _0x5acaac[_0x406be3(0x1047)][_0x406be3(0x11c6)](_0x5f185d=>_0x5f185d['text'])[_0x406be3(0xbad)]('\x20');return'';})['join']('\x0a'),_0x16e225(_0x5d9c39);}const _0x361fc8=_0x2d3d91(async()=>{const _0x53676f=_0x475790,_0x27846a=document[_0x53676f(0x2ec)]('token-count-display');if(!_0x27846a)return;_0x27846a[_0x53676f(0xc43)]=_0x53676f(0x136b);try{const _0x867e63=await _0x7cd12b();_0x27846a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22><strong>\x20'+_0x867e63+_0x53676f(0x779);}catch(_0x3545c7){console[_0x53676f(0x1518)]('Token\x20calculation\x20error:',_0x3545c7),_0x27846a[_0x53676f(0xc43)]=_0x53676f(0xc89);}},0x12c);async function _0x20a69b(){const _0x17dbb8=_0x475790,_0xbe2b06=document[_0x17dbb8(0x2ec)](_0x17dbb8(0x1313));_0xbe2b06[_0x17dbb8(0xc43)]='',_0x160b5e=[],_0x1b554d=0x0,_0x585648=![];const _0x3de9df=[];try{const _0x1f83dd=await _0x5b9d83[_0x17dbb8(0x6ce)][_0x17dbb8(0x14b5)]();for(const _0x4bd46a of _0x1f83dd){_0x4bd46a['history']&&_0x4bd46a[_0x17dbb8(0x12c3)][_0x17dbb8(0x9a1)]>0x0&&_0x4bd46a[_0x17dbb8(0x12c3)][_0x17dbb8(0xf99)](_0x35d124=>{const _0x4eb2f2=_0x17dbb8;_0x35d124[_0x4eb2f2(0xb4b)]==='naiimag'&&_0x35d124[_0x4eb2f2(0x6c6)]&&_0x3de9df[_0x4eb2f2(0x367)]({'sourceType':_0x4eb2f2(0x73b),'imageUrl':_0x35d124[_0x4eb2f2(0x6c6)],'prompt':_0x35d124['prompt']||_0x35d124[_0x4eb2f2(0x5ae)]||'NAI\x20Image','chatId':_0x4bd46a['id'],'msgTimestamp':_0x35d124[_0x4eb2f2(0x69a)]});});}}catch(_0x4dec87){console[_0x17dbb8(0x1518)]('扫描聊天记录失败:',_0x4dec87);}try{const _0x592978=await _0x5b9d83[_0x17dbb8(0xc7a)][_0x17dbb8(0x14b5)]();_0x592978[_0x17dbb8(0xf99)](_0x448e81=>{const _0x22a421=_0x17dbb8;if(_0x448e81[_0x22a421(0xb4b)]===_0x22a421(0xd92)){const _0x9436f8=_0x448e81[_0x22a421(0xece)]||(_0x448e81[_0x22a421(0x6c6)]?[_0x448e81[_0x22a421(0x6c6)]]:[]),_0x312600=Array['isArray'](_0x448e81[_0x22a421(0x9fd)])?_0x448e81[_0x22a421(0x9fd)]:[_0x448e81[_0x22a421(0x9fd)]||_0x22a421(0x47c)];_0x9436f8['forEach']((_0x165e22,_0x3ced05)=>{_0x3de9df['push']({'sourceType':'qzone','imageUrl':_0x165e22,'prompt':_0x312600[_0x3ced05]||_0x312600[0x0],'postId':_0x448e81['id'],'imageIndex':_0x3ced05});});}});}catch(_0x4f4794){console[_0x17dbb8(0x1518)](_0x17dbb8(0xf74),_0x4f4794);}_0x160b5e=_0x3de9df[_0x17dbb8(0x126b)]((_0x318b70,_0x44faac)=>(_0x44faac[_0x17dbb8(0xdc1)]||_0x44faac['postId']||0x0)-(_0x318b70['msgTimestamp']||_0x318b70[_0x17dbb8(0xa53)]||0x0)),_0x160b5e[_0x17dbb8(0x9a1)]===0x0?_0xbe2b06['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x22>画廊还是空的，快去生成一些图片吧！</p>':_0x300101(),document[_0x17dbb8(0x2ec)](_0x17dbb8(0x378))['classList'][_0x17dbb8(0xe82)]('visible');}function _0x38f0ee(_0xbfb7){const _0xb52b47=_0x475790,_0x127707=document['getElementById'](_0xb52b47(0x1313));if(_0xbfb7[_0xb52b47(0x9a1)]===0x0&&_0x1b554d===0x0){_0x127707[_0xb52b47(0xc43)]=_0xb52b47(0x4da);return;}const _0x3caec7=document[_0xb52b47(0x12c0)]();_0xbfb7['forEach']((_0x3313ce,_0x178866)=>{const _0x2bc708=_0xb52b47,_0x235e97=document['createElement'](_0x2bc708(0xaa5));_0x235e97[_0x2bc708(0xdd1)]=_0x2bc708(0x9dd),_0x235e97[_0x2bc708(0x141e)]=_0x3313ce[_0x2bc708(0x9fd)];const _0x58e29d=_0x3313ce[_0x2bc708(0x983)]+'_'+(_0x3313ce[_0x2bc708(0xdd0)]||_0x3313ce['postId'])+'_'+(_0x3313ce[_0x2bc708(0xdc1)]||_0x3313ce[_0x2bc708(0x48e)]);_0x235e97['dataset']['key']=_0x58e29d,_0x235e97['dataset'][_0x2bc708(0x6c6)]=_0x3313ce[_0x2bc708(0x6c6)],_0x235e97['dataset'][_0x2bc708(0x9fd)]=_0x3313ce[_0x2bc708(0x9fd)],_0x235e97[_0x2bc708(0xc43)]=_0x2bc708(0x76d)+_0x3313ce['imageUrl']+_0x2bc708(0x8be)+_0x3313ce[_0x2bc708(0x9fd)]+_0x2bc708(0xc69),_0x3caec7[_0x2bc708(0x998)](_0x235e97);}),_0x127707[_0xb52b47(0x998)](_0x3caec7);}async function _0x300101(){const _0x2c944c=_0x475790;if(_0x585648||_0x1b554d>=_0x160b5e['length'])return;_0x585648=!![];const _0x13f5f0=document[_0x2c944c(0x2ec)](_0x2c944c(0x1313));_0x5d72d6(_0x13f5f0,_0x2c944c(0xe39)),setTimeout(()=>{const _0x23b9bd=_0x2c944c,_0x3a8759=_0x160b5e[_0x23b9bd(0x225)](_0x1b554d,_0x1b554d+_0x3d2745);_0x66d5be(_0x13f5f0),_0x3a8759[_0x23b9bd(0x9a1)]>0x0&&(_0x38f0ee(_0x3a8759),_0x1b554d+=_0x3a8759[_0x23b9bd(0x9a1)]),_0x585648=![];},0x1f4);}function _0x343866(){const _0x1d4ac0=_0x475790;_0x2a141d=!_0x2a141d;const _0x1805a2=document['getElementById'](_0x1d4ac0(0x1313)),_0x40111c=document['getElementById']('manage-nai-gallery-btn'),_0xe0d8e1=document[_0x1d4ac0(0x2ec)](_0x1d4ac0(0x1365)),_0x282c64=document['getElementById'](_0x1d4ac0(0x273));_0x1805a2[_0x1d4ac0(0xff6)][_0x1d4ac0(0x14c8)](_0x1d4ac0(0x919),_0x2a141d),_0x2a141d?(_0x40111c[_0x1d4ac0(0x15f)]='完成',_0xe0d8e1[_0x1d4ac0(0x589)][_0x1d4ac0(0x701)]=_0x1d4ac0(0xc67),_0x1be0c6[_0x1d4ac0(0xe98)](),_0x282c64[_0x1d4ac0(0x13b8)]=![],_0x4c18a6()):(_0x40111c['textContent']='管理',_0xe0d8e1[_0x1d4ac0(0x589)]['display']='none',_0x1805a2[_0x1d4ac0(0x5d6)](_0x1d4ac0(0x1276))[_0x1d4ac0(0xf99)](_0x822f97=>_0x822f97['classList'][_0x1d4ac0(0x1424)](_0x1d4ac0(0xba2))));}function _0x4c18a6(){const _0x50111e=_0x475790,_0x1fc5e6=document[_0x50111e(0x2ec)]('delete-selected-nai-gallery-btn'),_0x1a6e10=document[_0x50111e(0x2ec)](_0x50111e(0x9df)),_0x5dd115=_0x1be0c6[_0x50111e(0x2d2)];if(_0x1fc5e6)_0x1fc5e6[_0x50111e(0x15f)]='删除\x20('+_0x5dd115+')';if(_0x1a6e10)_0x1a6e10[_0x50111e(0x15f)]='下载\x20('+_0x5dd115+')';}function _0x1eaee3(_0x1a0975){const _0x3d1533=_0x475790,_0x4dade3=_0x1a0975[_0x3d1533(0x1104)][_0x3d1533(0x3f2)](_0x3d1533(0xa56));if(!_0x4dade3)return;const _0x998b53=_0x4dade3[_0x3d1533(0xe93)]['key'],_0x5960c2=_0x4dade3['dataset'][_0x3d1533(0x6c6)],_0x4a6982=_0x4dade3[_0x3d1533(0xe93)]['prompt'];if(_0x1a0975[_0x3d1533(0x1104)][_0x3d1533(0x3f2)]('.nai-gallery-download-btn')){_0x1a0975[_0x3d1533(0x106c)](),_0x2d2f51(_0x5960c2,_0x4a6982);return;}if(_0x1a0975[_0x3d1533(0x1104)][_0x3d1533(0x3f2)](_0x3d1533(0x6c1))){_0x1a0975[_0x3d1533(0x106c)](),_0x3c731b(new Set([_0x998b53]));return;}if(_0x2a141d)_0x4dade3['classList']['toggle'](_0x3d1533(0xba2)),_0x1be0c6['has'](_0x998b53)?_0x1be0c6[_0x3d1533(0x54b)](_0x998b53):_0x1be0c6['add'](_0x998b53),_0x4c18a6();else{const _0x5104da='图片详情',_0x19c0e3='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x5960c2+_0x3d1533(0x1245);_0x34d596(_0x5104da,_0x19c0e3);}}async function _0x4ad9fc(){const _0x5e6df1=_0x475790,_0x22ecd0=_0x1be0c6;if(_0x22ecd0[_0x5e6df1(0x2d2)]===0x0){alert(_0x5e6df1(0x14de));return;}if(typeof JSZip===_0x5e6df1(0xe40)||!window[_0x5e6df1(0x1349)]){await _0x34d596(_0x5e6df1(0x347),_0x5e6df1(0x497));return;}await _0x34d596(_0x5e6df1(0x13e4),_0x5e6df1(0xce2)+_0x22ecd0['size']+_0x5e6df1(0xc09));const _0xee87df=new JSZip();let _0x58d027=0x0;const _0x183c35=[];_0x22ecd0[_0x5e6df1(0xf99)](_0x3235c5=>{const _0x4a9fc5=_0x5e6df1,_0x458ef1=document['querySelector'](_0x4a9fc5(0x1407)+_0x3235c5+'\x22]');if(!_0x458ef1)return;const _0x39274c=_0x458ef1['dataset'][_0x4a9fc5(0x6c6)],_0xf6d330=_0x458ef1[_0x4a9fc5(0xe93)]['prompt'],_0x40bfb9=_0x13cc95(_0xf6d330),_0x1b19e0=((async()=>{const _0x324d5e=_0x4a9fc5;try{let _0x53f32e;if(_0x39274c[_0x324d5e(0x741)](_0x324d5e(0x54c))){const _0x3d656a=await fetch(_0x39274c);_0x53f32e=await _0x3d656a['blob']();}else{let _0x18fd0e;try{_0x18fd0e=await fetch(_0x39274c,{'mode':_0x324d5e(0xfdb)});if(!_0x18fd0e['ok'])throw new Error(_0x324d5e(0x12e9));}catch(_0x40f27e){console['warn'](_0x324d5e(0xcc1),_0x40f27e[_0x324d5e(0x13bc)]);const _0x490af0=_0x4cb256();let _0x498cd6=_0x490af0[_0x324d5e(0x9c0)]===_0x324d5e(0x1334)?_0x490af0[_0x324d5e(0xb73)]:_0x490af0[_0x324d5e(0x9c0)];if(!_0x498cd6||_0x498cd6==='')_0x498cd6=_0x324d5e(0x925);const _0x3abbe0=_0x498cd6+encodeURIComponent(_0x39274c);_0x18fd0e=await fetch(_0x3abbe0);}if(!_0x18fd0e['ok'])throw new Error('Fetch\x20failed:\x20'+_0x18fd0e[_0x324d5e(0x2a3)]);_0x53f32e=await _0x18fd0e[_0x324d5e(0x465)]();}_0xee87df[_0x324d5e(0xc9d)](_0x40bfb9,_0x53f32e,{'binary':!![]});}catch(_0x15ef0f){console[_0x324d5e(0x1518)]('下载图片失败:\x20'+_0x39274c,_0x15ef0f),_0x58d027++;}})());_0x183c35['push'](_0x1b19e0);}),await Promise[_0x5e6df1(0xa92)](_0x183c35);if(_0x58d027===_0x22ecd0['size']){await _0x34d596(_0x5e6df1(0x347),_0x5e6df1(0x1302));return;}await _0x34d596(_0x5e6df1(0x1165),_0x5e6df1(0x14d9));try{const _0x2b8081=streamSaver['createWriteStream'](_0x5e6df1(0x9bf)+Date['now']()+_0x5e6df1(0x2b0)),_0x46c65e=_0xee87df[_0x5e6df1(0x46b)]({'type':_0x5e6df1(0x465),'streamFiles':!![]}),_0x17f596=new ReadableStream({'start'(_0x53fa8c){const _0x19eb24=_0x5e6df1;_0x46c65e['on'](_0x19eb24(0x1418),_0x52af72=>{const _0x49fcf4=_0x19eb24;_0x53fa8c[_0x49fcf4(0xe3e)](_0x52af72);})['on'](_0x19eb24(0x1316),()=>{const _0x514c08=_0x19eb24;console[_0x514c08(0x415)](_0x514c08(0xd1d)),_0x53fa8c[_0x514c08(0x785)]();})['on'](_0x19eb24(0x1518),_0x21dad4=>{const _0x583eba=_0x19eb24;console[_0x583eba(0x1518)](_0x583eba(0x73d),_0x21dad4),_0x53fa8c['error'](_0x21dad4);})[_0x19eb24(0x1561)]();}});await _0x17f596['pipeTo'](_0x2b8081),_0x58d027>0x0&&_0x34d596(_0x5e6df1(0x38e),'成功打包\x20'+(_0x22ecd0['size']-_0x58d027)+_0x5e6df1(0xb02)+_0x58d027+'\x20张图片因网络或CORS限制下载失败。');}catch(_0xe7ea70){console[_0x5e6df1(0x1518)]('流式下载ZIP失败:',_0xe7ea70),await _0x34d596(_0x5e6df1(0x351),'创建ZIP流时出错:\x20'+_0xe7ea70[_0x5e6df1(0x13bc)]);}}async function _0x3c731b(_0x55b58e=null){const _0x49e43d=_0x475790,_0x4330a1=_0x55b58e||_0x1be0c6;if(_0x4330a1[_0x49e43d(0x2d2)]===0x0)return;const _0x357785=await _0x4436ba('确认删除','确定要从【聊天记录和动态】中永久删除这\x20'+_0x4330a1['size']+_0x49e43d(0x99f),{'confirmButtonClass':_0x49e43d(0xd8f)});if(!_0x357785)return;await _0x34d596('请稍候...','正在执行删除操作...');let _0x5a7209=0x0;const _0x5e1c31=new Map(),_0x22aa6c=new Set(),_0xb047eb=new Map(),_0x9a2bc5=new Set();for(const _0xd7a9cc of _0x4330a1){if(_0xd7a9cc[_0x49e43d(0x741)](_0x49e43d(0x8c2))){const _0x4b8bf7=_0xd7a9cc['split']('_'),_0x3913f3=parseInt(_0x4b8bf7[0x1]);!isNaN(_0x3913f3)&&_0x9a2bc5[_0x49e43d(0xe82)](_0x3913f3);}}const _0x3bf564=new Map();if(_0x9a2bc5[_0x49e43d(0x2d2)]>0x0){const _0x387e03=await _0x5b9d83[_0x49e43d(0xc7a)][_0x49e43d(0x67e)]('id')[_0x49e43d(0x3fc)](Array['from'](_0x9a2bc5))[_0x49e43d(0x14b5)]();_0x387e03['forEach'](_0x1afc1a=>_0x3bf564[_0x49e43d(0xa63)](_0x1afc1a['id'],_0x1afc1a));}for(const _0x5a133a of _0x4330a1){const _0x325bc3=_0x5a133a['split']('_');if(_0x325bc3[_0x49e43d(0x9a1)]<0x3){console[_0x49e43d(0x664)](_0x49e43d(0xe44),_0x5a133a);continue;}const _0x570331=_0x325bc3[0x0],_0x118c7d=_0x325bc3[_0x49e43d(0xdba)](),_0x58da56=_0x325bc3[_0x49e43d(0x225)](0x1)['join']('_');if(_0x570331===_0x49e43d(0x73b)){const _0x429d9e=_0x58da56,_0x177d82=parseInt(_0x118c7d);if(!_0x5e1c31[_0x49e43d(0xbf1)](_0x429d9e)){const _0x246725=await _0x5b9d83[_0x49e43d(0x6ce)]['get'](_0x429d9e);if(_0x246725)_0x5e1c31['set'](_0x429d9e,_0x246725);else{console['warn'](_0x49e43d(0x10f6)+_0x429d9e+_0x49e43d(0x1195));continue;}}const _0x4b96e1=_0x5e1c31[_0x49e43d(0x6b5)](_0x429d9e);if(_0x4b96e1&&_0x4b96e1[_0x49e43d(0x12c3)]){const _0x4597e4=_0x4b96e1[_0x49e43d(0x12c3)][_0x49e43d(0x9a1)];_0x4b96e1['history']=_0x4b96e1[_0x49e43d(0x12c3)][_0x49e43d(0xebc)](_0x159140=>_0x159140[_0x49e43d(0x69a)]!==_0x177d82),_0x4b96e1[_0x49e43d(0x12c3)][_0x49e43d(0x9a1)]<_0x4597e4&&(_0x5a7209++,_0x5e1c31[_0x49e43d(0xa63)](_0x429d9e,_0x4b96e1));}}else{if(_0x570331===_0x49e43d(0x13fa)){const _0x147cd6=parseInt(_0x58da56),_0x10e1e5=parseInt(_0x118c7d),_0x4938c3=_0xb047eb[_0x49e43d(0x6b5)](_0x147cd6)||_0x3bf564['get'](_0x147cd6);if(!_0x4938c3){console['warn'](_0x49e43d(0x1560)+_0x147cd6+_0x49e43d(0x1195));continue;}const _0x5b58e3=_0x4938c3[_0x49e43d(0xece)]||(_0x4938c3[_0x49e43d(0x6c6)]?[_0x4938c3['imageUrl']]:[]);if(_0x5b58e3[_0x49e43d(0x9a1)]<=0x1)_0x22aa6c[_0x49e43d(0xe82)](_0x147cd6),_0xb047eb['has'](_0x147cd6)&&_0xb047eb[_0x49e43d(0x54b)](_0x147cd6);else{const _0x2c5d88=_0x5b58e3[_0x10e1e5];_0x4938c3[_0x49e43d(0xece)]=_0x4938c3[_0x49e43d(0xece)][_0x49e43d(0xebc)](_0x24d016=>_0x24d016!==_0x2c5d88),_0x4938c3['prompt']&&Array[_0x49e43d(0x624)](_0x4938c3[_0x49e43d(0x9fd)])&&_0x4938c3['prompt'][_0x10e1e5]&&_0x4938c3[_0x49e43d(0x9fd)][_0x49e43d(0x510)](_0x10e1e5,0x1),_0x4938c3[_0x49e43d(0x6c6)]=_0x4938c3[_0x49e43d(0xece)][0x0]||null,_0xb047eb[_0x49e43d(0xa63)](_0x147cd6,_0x4938c3);}_0x5a7209++;}}}try{await _0x5b9d83['transaction']('rw',_0x5b9d83[_0x49e43d(0x6ce)],_0x5b9d83[_0x49e43d(0xc7a)],async()=>{const _0x354c2e=_0x49e43d;_0x5e1c31[_0x354c2e(0x2d2)]>0x0&&await _0x5b9d83[_0x354c2e(0x6ce)][_0x354c2e(0xdb2)](Array[_0x354c2e(0x13d1)](_0x5e1c31[_0x354c2e(0x74e)]())),_0xb047eb['size']>0x0&&await _0x5b9d83[_0x354c2e(0xc7a)][_0x354c2e(0xdb2)](Array[_0x354c2e(0x13d1)](_0xb047eb[_0x354c2e(0x74e)]())),_0x22aa6c[_0x354c2e(0x2d2)]>0x0&&await _0x5b9d83[_0x354c2e(0xc7a)][_0x354c2e(0x1521)](Array[_0x354c2e(0x13d1)](_0x22aa6c));}),_0x343866(),await _0x20a69b(),await _0x34d596(_0x49e43d(0x1557),_0x49e43d(0x12e0)+_0x5a7209+_0x49e43d(0xae6)),document[_0x49e43d(0x2ec)](_0x49e43d(0x120a))['classList']['contains']('active')&&_0xc55746(_0x28f30a[_0x49e43d(0x11b9)]),document['getElementById']('qzone-screen')[_0x49e43d(0xff6)][_0x49e43d(0xe9a)](_0x49e43d(0xd43))&&_0x472608();}catch(_0x31c6b5){console['error'](_0x49e43d(0x146f),_0x31c6b5),await _0x34d596(_0x49e43d(0x7f2),_0x49e43d(0x470)+_0x31c6b5[_0x49e43d(0x13bc)]);}}function _0x13cc95(_0x198849){const _0x361f79=_0x475790,_0x56b0e6=_0x198849||_0x361f79(0x6d2);let _0x3f82f3=_0x56b0e6[_0x361f79(0x13ed)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')[_0x361f79(0x13ed)](/\s+/g,'_')[_0x361f79(0xa6b)](0x0,0x1e);!_0x3f82f3&&(_0x3f82f3=_0x361f79(0x6d2));const _0x140677=new Date()[_0x361f79(0xaf8)]()[_0x361f79(0x13ed)](/[-:]/g,'')['replace']('T','_')[_0x361f79(0xa8a)]('.')[0x0];return _0x3f82f3+'_'+_0x140677+_0x361f79(0xbb2);}async function _0x55ad0c(){const _0x2ea2d1=_0x475790;initLanguage();async function _0x266c60(_0x29adcb){const _0x1977da=_0x1937;if(!_0x29adcb)return;try{const _0x15112e=await _0x29adcb[_0x1977da(0x10ca)](),_0x549c74=JSON[_0x1977da(0xd91)](_0x15112e);if(_0x549c74[_0x1977da(0xb4b)]===_0x1977da(0x11c0))console[_0x1977da(0x415)](_0x1977da(0xd19)),await _0x1dedb6(_0x549c74);else{if(_0x549c74['entries']&&typeof _0x549c74[_0x1977da(0x127b)]===_0x1977da(0x10c0))console[_0x1977da(0x415)](_0x1977da(0xa07)),await _0x209009(_0x549c74,_0x29adcb[_0x1977da(0xe36)]);else throw new Error(_0x1977da(0xa4f));}}catch(_0x1e05d3){console[_0x1977da(0x1518)](_0x1977da(0x108a),_0x1e05d3),await _0x34d596(_0x1977da(0x493),'文件解析或应用失败:\x20'+_0x1e05d3[_0x1977da(0x13bc)]);}}async function _0x209009(_0x34a79e,_0x2a849e){const _0x45f975=_0x1937,_0x5d117f=_0x2a849e[_0x45f975(0x13ed)](/\.json$/i,''),_0x3a63a0=await _0x33419a(_0x45f975(0x1436),_0x45f975(0x2da),_0x5d117f);if(!_0x3a63a0||!_0x3a63a0['trim']()){alert('导入已取消，因为未提供书名。');return;}const _0x29a144=Object[_0x45f975(0x74e)](_0x34a79e[_0x45f975(0x127b)])[_0x45f975(0x11c6)](_0x5bac35=>{const _0x507838=_0x45f975;return{'keys':_0x5bac35['key']||[],'comment':_0x5bac35[_0x507838(0x70d)]||_0x507838(0x342),'content':_0x5bac35['content']||'','enabled':!_0x5bac35[_0x507838(0x29f)]};})[_0x45f975(0xebc)](_0x2253b5=>_0x2253b5[_0x45f975(0x1047)]);if(_0x29a144['length']===0x0){alert(_0x45f975(0x6f6));return;}const _0x3290ea={'id':_0x45f975(0x944)+Date[_0x45f975(0x487)](),'name':_0x3a63a0['trim'](),'content':_0x29a144,'categoryId':null};await _0x5b9d83['worldBooks'][_0x45f975(0xe82)](_0x3290ea),_0x28f30a[_0x45f975(0x13b9)][_0x45f975(0x367)](_0x3290ea),await _0x6f6974(),await _0x34d596('导入成功！',_0x45f975(0xd8e)+_0x3a63a0+'》。');}async function _0x541b43(){const _0x2b5d9b=_0x1937;try{const _0x792a57=await _0x5b9d83['worldBooks'][_0x2b5d9b(0x14b5)](),_0x220d36=await _0x5b9d83[_0x2b5d9b(0x5c0)][_0x2b5d9b(0x14b5)]();if(_0x792a57[_0x2b5d9b(0x9a1)]===0x0&&_0x220d36[_0x2b5d9b(0x9a1)]===0x0){alert(_0x2b5d9b(0x97c));return;}const _0x3d68b8={'type':_0x2b5d9b(0x11c0),'version':0x1,'timestamp':Date[_0x2b5d9b(0x487)](),'books':_0x792a57,'categories':_0x220d36},_0x5bc19e=new Blob([JSON[_0x2b5d9b(0xe4d)](_0x3d68b8,null,0x2)],{'type':_0x2b5d9b(0x1446)}),_0x318783=URL['createObjectURL'](_0x5bc19e),_0x1cc41f=document['createElement']('a');_0x1cc41f['href']=_0x318783,_0x1cc41f['download']='EPhone-WorldBooks-'+new Date()[_0x2b5d9b(0xaf8)]()[_0x2b5d9b(0xa8a)]('T')[0x0]+'.json',_0x1cc41f['click'](),URL[_0x2b5d9b(0x18d)](_0x318783),await _0x34d596(_0x2b5d9b(0x583),_0x2b5d9b(0x216));}catch(_0x576780){console[_0x2b5d9b(0x1518)](_0x2b5d9b(0x1081),_0x576780),await _0x34d596(_0x2b5d9b(0x4aa),'发生了一个错误:\x20'+_0x576780[_0x2b5d9b(0x13bc)]);}}async function _0x1dedb6(_0x1f8f1b){const _0x301136=_0x1937;try{if(_0x1f8f1b['type']!=='EPhoneWorldBookBackup'||!_0x1f8f1b['books'])throw new Error(_0x301136(0x6e7));const _0x615cf3=await _0x4436ba(_0x301136(0x11a8),_0x301136(0x439),{'confirmButtonClass':_0x301136(0xd8f),'confirmText':_0x301136(0x282)});if(!_0x615cf3)return;await _0x5b9d83[_0x301136(0xe5b)]('rw',_0x5b9d83[_0x301136(0x13b9)],_0x5b9d83['worldBookCategories'],async()=>{const _0x5a08b3=_0x301136;await _0x5b9d83[_0x5a08b3(0x13b9)][_0x5a08b3(0xe98)](),await _0x5b9d83[_0x5a08b3(0x5c0)][_0x5a08b3(0xe98)](),Array[_0x5a08b3(0x624)](_0x1f8f1b[_0x5a08b3(0xbc8)])&&await _0x5b9d83['worldBooks'][_0x5a08b3(0xdb2)](_0x1f8f1b[_0x5a08b3(0xbc8)]),Array[_0x5a08b3(0x624)](_0x1f8f1b[_0x5a08b3(0xd31)])&&await _0x5b9d83[_0x5a08b3(0x5c0)][_0x5a08b3(0xdb2)](_0x1f8f1b[_0x5a08b3(0xd31)]);}),_0x28f30a['worldBooks']=await _0x5b9d83[_0x301136(0x13b9)][_0x301136(0x14b5)](),await _0x6f6974(),await _0x34d596(_0x301136(0x685),_0x301136(0x963));}catch(_0x3b81fc){console['error'](_0x301136(0x108a),_0x3b81fc),await _0x34d596(_0x301136(0x493),_0x301136(0x1264)+_0x3b81fc[_0x301136(0x13bc)]);}}const _0x221676=localStorage[_0x2ea2d1(0x11c3)]('ephoneLastActiveTimestamp');if(_0x221676){const _0x1ef0a2=(Date[_0x2ea2d1(0x487)]()-parseInt(_0x221676))/(0x3e8*0x3c);_0x1ef0a2>0x5&&_0x4a5a6f(_0x1ef0a2);}_0x8f3176(),window[_0x2ea2d1(0xf87)]=_0x17ec27,window[_0x2ea2d1(0x1481)]=_0x2a29d0,window[_0x2ea2d1(0x842)]=_0x213f2c,window['openCharacterSelector']=_0xb6d174,window[_0x2ea2d1(0xa2d)]=_0x144166,window[_0x2ea2d1(0x10eb)]=_0x2e8af5,window[_0x2ea2d1(0x187)]=_0x2e51cf,window[_0x2ea2d1(0xa25)]=_0x2dffa2,window[_0x2ea2d1(0xe68)]=_0x7ad5c6;const _0x1a4620=document['createElement'](_0x2ea2d1(0xaa5));_0x1a4620['id']='sticker-action-bar',_0x1a4620['innerHTML']=_0x2ea2d1(0xef8),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x65f))[_0x2ea2d1(0x998)](_0x1a4620);const _0x5de07f=document[_0x2ea2d1(0x14ae)]('style');_0x5de07f['id']=_0x2ea2d1(0x137f),document[_0x2ea2d1(0x150d)][_0x2ea2d1(0x998)](_0x5de07f),_0x3006bc[_0x2ea2d1(0x97a)]=document['getElementById'](_0x2ea2d1(0x965)),_0x3006bc['gridEl']=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x10ff));const _0x2351c2=localStorage[_0x2ea2d1(0x11c3)](_0x2ea2d1(0x823))||_0x2ea2d1(0x883);_0x472780(_0x2351c2);const _0x48d72a=document['createElement']('style');_0x48d72a['id']='custom-bubble-style',document[_0x2ea2d1(0x150d)][_0x2ea2d1(0x998)](_0x48d72a);const _0x4e19a8=document['createElement'](_0x2ea2d1(0x589));_0x4e19a8['id']=_0x2ea2d1(0x10d3),document[_0x2ea2d1(0x150d)][_0x2ea2d1(0x998)](_0x4e19a8),_0x4171f3('',_0x2ea2d1(0x939),_0x2ea2d1(0x103b)),_0x4171f3('',_0x2ea2d1(0x4ef),_0x2ea2d1(0x10d3)),window[_0x2ea2d1(0x1481)]=_0x2a29d0,window['showScreen']=_0x17ec27,window['renderChatListProxy']=_0x5db8a3,window['renderApiSettingsProxy']=_0x210b86,window[_0x2ea2d1(0x10d6)]=_0x1bf18e,window[_0x2ea2d1(0xf84)]=_0x6f6974,await _0x15e928(),_0x435075(),await _0x25e92e(),_0x276bb0(_0x28f30a[_0x2ea2d1(0x1062)][_0x2ea2d1(0x1099)]);const _0x36d597=parseInt(localStorage['getItem'](_0x2ea2d1(0xd3f)))||0x0;_0x3f09c8(_0x36d597);_0x28f30a[_0x2ea2d1(0x1062)]&&_0x28f30a[_0x2ea2d1(0x1062)][_0x2ea2d1(0x6ee)]&&_0x155408(_0x28f30a[_0x2ea2d1(0x1062)][_0x2ea2d1(0x6ee)]);_0x375281(),setInterval(_0x375281,0x3e8*0x1e),_0x1993ff(),_0x53fe12(),_0x3b4945(),_0x47251c(),document['getElementById'](_0x2ea2d1(0x1525))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x269cb0=>{const _0xba354f=_0x2ea2d1;_0x269cb0[_0xba354f(0x1104)][_0xba354f(0xff6)][_0xba354f(0xe9a)](_0xba354f(0x72f))&&_0x1960e7(_0x269cb0[_0xba354f(0x1104)]['dataset'][_0xba354f(0x10ce)]);}),document[_0x2ea2d1(0x2ec)]('add-new-rule-btn')[_0x2ea2d1(0xf79)]('click',()=>_0x153256(null)),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xcae))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x476f74=_0x2ea2d1;document['getElementById'](_0x476f74(0xf5e))[_0x476f74(0xff6)]['remove'](_0x476f74(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1550))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x17eb80),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1396))[_0x2ea2d1(0xf79)]('click',()=>{const _0x56dd4e=_0x2ea2d1;if(_0x28f30a[_0x56dd4e(0x11b9)]&&!_0x28f30a[_0x56dd4e(0x6ce)][_0x28f30a[_0x56dd4e(0x11b9)]][_0x56dd4e(0x1423)]){const _0x3d88ea=_0x28f30a[_0x56dd4e(0x6ce)][_0x28f30a[_0x56dd4e(0x11b9)]];_0x367dc2(_0x3d88ea['id'],_0x3d88ea[_0x56dd4e(0x66c)]);}});let _0x46012b=null;function _0x54d174(_0x37b6fe){const _0x2c8231=_0x2ea2d1;_0x46012b=_0x37b6fe;const _0x3532a0=_0x28f30a[_0x2c8231(0x6ce)][_0x28f30a[_0x2c8231(0x11b9)]],_0x510b53=_0x3532a0[_0x2c8231(0x380)][_0x2c8231(0x412)](_0xd60a5c=>_0xd60a5c['id']===_0x37b6fe);if(!_0x510b53)return;const _0xcf791b=document[_0x2c8231(0x2ec)](_0x2c8231(0x5f2));_0xcf791b[_0x2c8231(0x15f)]=_0x510b53[_0x2c8231(0xa1c)]?_0x2c8231(0xb14):_0x2c8231(0x475),document[_0x2c8231(0x2ec)](_0x2c8231(0x10f9))['classList']['add'](_0x2c8231(0x149d));}async function _0x21b47f(){const _0x24b169=_0x2ea2d1;if(!_0x46012b)return;const _0x38c5f6=_0x28f30a['chats'][_0x28f30a['activeChatId']],_0x3761d9=_0x38c5f6[_0x24b169(0x380)][_0x24b169(0x412)](_0x31a1bc=>_0x31a1bc['id']===_0x46012b);_0x3761d9&&(_0x3761d9[_0x24b169(0xa1c)]=!_0x3761d9[_0x24b169(0xa1c)],await _0x5b9d83[_0x24b169(0x6ce)][_0x24b169(0x7c3)](_0x38c5f6),_0x15093e()),document[_0x24b169(0x2ec)](_0x24b169(0x10f9))[_0x24b169(0xff6)][_0x24b169(0x1424)]('visible');}async function _0x429863(){const _0x525210=_0x2ea2d1;if(!_0x46012b)return;const _0x9621c8=await _0x4436ba(_0x525210(0x10d9),_0x525210(0x1531),{'confirmButtonClass':_0x525210(0xd8f)});if(_0x9621c8){const _0x303e67=_0x28f30a[_0x525210(0x6ce)][_0x28f30a[_0x525210(0x11b9)]];_0x303e67[_0x525210(0x380)]=_0x303e67[_0x525210(0x380)][_0x525210(0xebc)](_0x355bc8=>_0x355bc8['id']!==_0x46012b),await _0x5b9d83['chats'][_0x525210(0x7c3)](_0x303e67),_0x15093e();}document[_0x525210(0x2ec)](_0x525210(0x10f9))[_0x525210(0xff6)]['remove'](_0x525210(0x149d));}document['getElementById']('custom-modal-cancel')['addEventListener'](_0x2ea2d1(0x1177),_0x50c3bc),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x605))['addEventListener']('click',_0x5c44ad=>{const _0xf640f1=_0x2ea2d1;if(_0x5c44ad[_0xf640f1(0x1104)]===_0x57e7c2)_0x50c3bc();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xb7c))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x4cbccb=_0x2ea2d1,_0x4ace7e=await _0x3d2f35(_0x4cbccb(0x791),[{'text':_0x4cbccb(0xc5c),'value':_0x4cbccb(0x225)},{'text':'智能导出\x20(单个大文件，太大可能会导致导入不了)','value':_0x4cbccb(0x10a6)},{'text':_0x4cbccb(0xe20),'value':_0x4cbccb(0x465)}]);if(_0x4ace7e===_0x4cbccb(0x225))_0x112432();else{if(_0x4ace7e===_0x4cbccb(0x10a6))_0x4f5cd();else _0x4ace7e==='blob'&&_0x5b33fa();}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x954))[_0x2ea2d1(0xf79)]('click',_0x1498c4),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1282))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x35e0ae=>{const _0xd01a71=_0x2ea2d1;document[_0xd01a71(0x2ec)]('offline-mode-options')[_0xd01a71(0x589)][_0xd01a71(0x701)]=_0x35e0ae[_0xd01a71(0x1104)]['checked']?'block':'none';}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x10e6))['addEventListener'](_0x2ea2d1(0x1177),()=>document[_0x2ea2d1(0x2ec)]('import-data-input')[_0x2ea2d1(0x1177)]()),document[_0x2ea2d1(0x2ec)]('time-perception-toggle')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0xf36c7e=>{const _0x43c268=_0x2ea2d1;document[_0x43c268(0x2ec)](_0x43c268(0xe23))[_0x43c268(0x589)][_0x43c268(0x701)]=_0xf36c7e[_0x43c268(0x1104)][_0x43c268(0x13b8)]?_0x43c268(0x13f7):'none';}),document[_0x2ea2d1(0x2ec)]('import-data-input')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x3e6b02=>_0x366913(_0x3e6b02['target'][_0x2ea2d1(0x8d6)][0x0])),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xa3a))['addEventListener'](_0x2ea2d1(0x217),_0x18ed3d),document['getElementById'](_0x2ea2d1(0x1394))[_0x2ea2d1(0xf79)]('click',()=>{const _0x53dab5=_0x2ea2d1;_0x2b6c0f={},_0x4171f3('',_0x53dab5(0x939),'custom-bubble-style'),_0x4171f3('',_0x53dab5(0x4ef),_0x53dab5(0x10d3)),_0x13d807(),_0x28f30a[_0x53dab5(0x11b9)]=null,_0x17ec27(_0x53dab5(0xf4d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x48d))['addEventListener']('click',async()=>{const _0x28216a=_0x2ea2d1,_0x1e124e=await _0x3d2f35(_0x28216a(0xc31),[{'text':_0x28216a(0x321),'value':_0x28216a(0x9ba)},{'text':_0x28216a(0x14a3),'value':_0x28216a(0x224)}]);if(_0x1e124e==='manual'){const _0x4c3e74=await _0x33419a(_0x28216a(0x13fb),'请输入你想为Ta设置的【备注名】(例如:\x20哥哥)');if(!_0x4c3e74||!_0x4c3e74[_0x28216a(0x97e)]())return;const _0x580a05=await _0x33419a(_0x28216a(0x1128),_0x28216a(0x60f));if(!_0x580a05||!_0x580a05[_0x28216a(0x97e)]())return;const _0x32fc41=_0x28216a(0xc1e)+Date[_0x28216a(0x487)](),_0x22b6ae={'id':_0x32fc41,'name':_0x4c3e74[_0x28216a(0x97e)](),'originalName':_0x580a05[_0x28216a(0x97e)](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':_0x28216a(0xab9),'blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date[_0x28216a(0x487)](),'isBusy':![]},'settings':{'aiPersona':_0x28216a(0x640),'myPersona':_0x28216a(0x91c),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x825cf1,'myAvatar':_0x825cf1,'background':'','theme':_0x28216a(0x44a),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':'Asia/Shanghai'},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x28f30a[_0x28216a(0x6ce)][_0x32fc41]=_0x22b6ae,await _0x5b9d83[_0x28216a(0x6ce)][_0x28216a(0x7c3)](_0x22b6ae),_0x5db8a3();}else _0x1e124e===_0x28216a(0x224)&&document['getElementById'](_0x28216a(0xa3a))['click']();}),document[_0x2ea2d1(0x2ec)]('add-group-chat-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x27bfb0),document['getElementById'](_0x2ea2d1(0x4cf))[_0x2ea2d1(0xf79)]('click',()=>document[_0x2ea2d1(0x2ec)]('transfer-modal')[_0x2ea2d1(0xff6)][_0x2ea2d1(0x1424)](_0x2ea2d1(0x149d))),document[_0x2ea2d1(0x2ec)]('transfer-confirm-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x561080),document['getElementById'](_0x2ea2d1(0xe79))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x213f2c),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x85d))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>_0x159f2b(!![])),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x502))['addEventListener'](_0x2ea2d1(0x1177),_0x533c83),document['getElementById'](_0x2ea2d1(0xf4c))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x42ba6c),document['getElementById'](_0x2ea2d1(0x13cc))['addEventListener'](_0x2ea2d1(0x1177),_0x3bea80),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xf98))[_0x2ea2d1(0xf79)]('click',_0x46f4b5),document[_0x2ea2d1(0x2ec)]('music-mode-btn')['addEventListener'](_0x2ea2d1(0x1177),_0x5b708b),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x8ca))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x125443=_0x2ea2d1;_0x1f11de(),document['getElementById'](_0x125443(0x696))['classList']['add'](_0x125443(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x666))['addEventListener'](_0x2ea2d1(0x1177),()=>document['getElementById'](_0x2ea2d1(0x696))[_0x2ea2d1(0xff6)]['remove'](_0x2ea2d1(0x149d))),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xc50))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x2621bf),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xbc7))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1d1))[_0x2ea2d1(0x1177)]()),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1d1))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x29043d),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x4d2))['addEventListener'](_0x2ea2d1(0x1177),_0x1e277d=>{const _0x4c359b=_0x2ea2d1,_0x249bf9=_0x1e277d['target'],_0x23a825=parseInt(_0x249bf9[_0x4c359b(0xe93)]['index']);if(isNaN(_0x23a825))return;if(_0x249bf9[_0x4c359b(0xff6)][_0x4c359b(0xe9a)]('album-art-btn'))_0x32eda6(_0x23a825);else{if(_0x249bf9[_0x4c359b(0xff6)]['contains'](_0x4c359b(0x651)))_0x1fd5f6(_0x23a825);else{if(_0x249bf9[_0x4c359b(0xff6)][_0x4c359b(0xe9a)](_0x4c359b(0xe67)))_0x133c3a(_0x23a825);else _0x249bf9[_0x4c359b(0xff6)][_0x4c359b(0xe9a)]('delete-track-btn')&&_0x5d04e4(_0x23a825);}}}),_0x4da7ed['addEventListener'](_0x2ea2d1(0xc13),()=>{const _0x49f2e7=_0x2ea2d1;document[_0x49f2e7(0x2ec)](_0x49f2e7(0x729))['classList'][_0x49f2e7(0x1424)]('spinning'),_0x3bea80();});const _0x4deced=document['getElementById'](_0x2ea2d1(0x146d));document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xbc2))[_0x2ea2d1(0xf79)]('click',()=>{const _0x757c5c=_0x2ea2d1;_0x5445ef();const _0x157c95=_0x4deced[_0x757c5c(0x11a4)][_0x757c5c(0x97e)]();if(!_0x157c95||!_0x28f30a[_0x757c5c(0x11b9)])return;const _0x333ba9=_0x28f30a[_0x757c5c(0x6ce)][_0x28f30a[_0x757c5c(0x11b9)]],_0x41cd7c={'role':'user','content':_0x157c95,'timestamp':Date[_0x757c5c(0x487)]()};_0x2e3d99&&(_0x41cd7c['quote']=_0x2e3d99),_0x4cc03e(_0x41cd7c,_0x333ba9),((async()=>{const _0x14a2d3=_0x757c5c;_0x333ba9[_0x14a2d3(0x12c3)][_0x14a2d3(0x367)](_0x41cd7c),await _0x5b9d83[_0x14a2d3(0x6ce)]['put'](_0x333ba9),_0x5db8a3();})()),_0x4deced[_0x757c5c(0x11a4)]='',_0x4deced[_0x757c5c(0x589)][_0x757c5c(0x11d3)]='auto',_0x4deced[_0x757c5c(0x52b)](),_0x1c45dd();}),document['getElementById'](_0x2ea2d1(0x36e))['addEventListener'](_0x2ea2d1(0x1177),_0x36bcc9),_0x4deced[_0x2ea2d1(0xf79)](_0x2ea2d1(0x44f),_0x161012=>{const _0x4d52ed=_0x2ea2d1;_0x161012[_0x4d52ed(0x50e)]===_0x4d52ed(0x184)&&!_0x161012[_0x4d52ed(0xcfb)]&&(_0x161012[_0x4d52ed(0x10bd)](),document[_0x4d52ed(0x2ec)](_0x4d52ed(0xbc2))[_0x4d52ed(0x1177)]());}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x387))['addEventListener'](_0x2ea2d1(0x217),async _0x4608fd=>{const _0x7b0124=_0x2ea2d1,_0x164cc0=_0x4608fd[_0x7b0124(0x1104)][_0x7b0124(0x8d6)][0x0];if(_0x164cc0){const _0x13633b=await new Promise((_0x3c7b9d,_0x4a70f0)=>{const _0x5ec381=_0x7b0124,_0x51dc09=new FileReader();_0x51dc09['onload']=()=>_0x3c7b9d(_0x51dc09[_0x5ec381(0x42a)]),_0x51dc09['onerror']=()=>_0x4a70f0(_0x51dc09[_0x5ec381(0x1518)]),_0x51dc09['readAsDataURL'](_0x164cc0);});_0x1f5717=_0x13633b,_0x1bf18e();}}),document['getElementById']('save-wallpaper-btn')['addEventListener']('click',async()=>{const _0x557ebe=_0x2ea2d1;_0x1f5717&&(_0x28f30a[_0x557ebe(0x1062)][_0x557ebe(0x638)]=_0x1f5717),_0x28f30a[_0x557ebe(0x1062)]['globalCss']=document[_0x557ebe(0x2ec)](_0x557ebe(0x1247))[_0x557ebe(0x11a4)][_0x557ebe(0x97e)](),_0x28f30a[_0x557ebe(0x1062)][_0x557ebe(0xaf0)]=document[_0x557ebe(0x2ec)]('notification-sound-url-input')[_0x557ebe(0x11a4)][_0x557ebe(0x97e)](),_0x28f30a[_0x557ebe(0x1062)][_0x557ebe(0x1f3)]=document[_0x557ebe(0x2ec)](_0x557ebe(0x558))[_0x557ebe(0x13b8)],await _0x5b9d83[_0x557ebe(0x1062)]['put'](_0x28f30a[_0x557ebe(0x1062)]),_0x1993ff(),_0x543c4d(),_0x1f5717=null,_0x3b4945(),_0x5d626d(),_0x276bb0(_0x28f30a['globalSettings']['globalCss']),_0x435075(),alert(_0x557ebe(0xd93)),_0x17ec27(_0x557ebe(0x436));});const _0x479ef5=document[_0x2ea2d1(0x2ec)]('messages-view');_0x479ef5[_0x2ea2d1(0xf79)](_0x2ea2d1(0xd8a),()=>{const {scrollTop:_0x1d85e2,scrollHeight:_0x215c7e,clientHeight:_0x2182d0}=_0x479ef5;_0x215c7e-_0x1d85e2-_0x2182d0<_0x2182d0&&(!_0x27d082&&_0xf4e5e0());}),document['getElementById'](_0x2ea2d1(0xfd1))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x2698e5=_0x2ea2d1;_0x28f30a[_0x2698e5(0x1537)][_0x2698e5(0xd71)]=document[_0x2698e5(0x2ec)]('proxy-url')[_0x2698e5(0x11a4)][_0x2698e5(0x97e)](),_0x28f30a[_0x2698e5(0x1537)][_0x2698e5(0x1420)]=document['getElementById']('api-key')[_0x2698e5(0x11a4)][_0x2698e5(0x97e)](),_0x28f30a[_0x2698e5(0x1537)][_0x2698e5(0x2bf)]=document[_0x2698e5(0x2ec)](_0x2698e5(0x12a6))['value'],_0x28f30a['apiConfig'][_0x2698e5(0x104e)]=document['getElementById'](_0x2698e5(0xc9e))[_0x2698e5(0x11a4)]['trim'](),_0x28f30a['apiConfig'][_0x2698e5(0x1382)]=document['getElementById'](_0x2698e5(0x7ff))[_0x2698e5(0x11a4)][_0x2698e5(0x97e)](),_0x28f30a[_0x2698e5(0x1537)][_0x2698e5(0xced)]=document[_0x2698e5(0x2ec)](_0x2698e5(0x1083))[_0x2698e5(0x11a4)],_0x28f30a[_0x2698e5(0x1537)]['secondaryProxyUrl']=document['getElementById'](_0x2698e5(0x8f3))[_0x2698e5(0x11a4)][_0x2698e5(0x97e)](),_0x28f30a[_0x2698e5(0x1537)][_0x2698e5(0xeae)]=document[_0x2698e5(0x2ec)]('secondary-api-key')['value']['trim'](),_0x28f30a[_0x2698e5(0x1537)][_0x2698e5(0xf3f)]=document['getElementById'](_0x2698e5(0x1256))[_0x2698e5(0x11a4)],await _0x5b9d83[_0x2698e5(0x1537)][_0x2698e5(0x7c3)](_0x28f30a[_0x2698e5(0x1537)]);const _0x291da2=document[_0x2698e5(0x2ec)]('background-activity-switch'),_0x4ffeb5=document[_0x2698e5(0x2ec)]('background-interval-input'),_0x144472=document[_0x2698e5(0x2ec)](_0x2698e5(0x12a9));_0x28f30a[_0x2698e5(0x1062)]['enableBackgroundActivity']=_0x291da2[_0x2698e5(0x13b8)],_0x28f30a[_0x2698e5(0x1062)][_0x2698e5(0x146a)]=parseInt(_0x4ffeb5['value'])||0x3c,_0x28f30a[_0x2698e5(0x1062)][_0x2698e5(0xd04)]=parseFloat(_0x144472[_0x2698e5(0x11a4)])||0x1,_0x28f30a[_0x2698e5(0x1062)][_0x2698e5(0x10fa)]=document[_0x2698e5(0x2ec)](_0x2698e5(0x270))['checked'],_0x28f30a[_0x2698e5(0x1062)][_0x2698e5(0x1002)]=parseInt(document[_0x2698e5(0x2ec)](_0x2698e5(0xb97))[_0x2698e5(0x11a4)])||0x32,_0x28f30a[_0x2698e5(0x1062)][_0x2698e5(0xd2b)]=parseInt(document[_0x2698e5(0x2ec)](_0x2698e5(0x3f4))['value'])||0x1e,_0x28f30a[_0x2698e5(0x1062)][_0x2698e5(0x294)]=parseFloat(document['getElementById'](_0x2698e5(0x133f))[_0x2698e5(0x11a4)]),await _0x5b9d83[_0x2698e5(0x1062)][_0x2698e5(0x7c3)](_0x28f30a[_0x2698e5(0x1062)]),_0x329a7b();_0x28f30a[_0x2698e5(0x1062)][_0x2698e5(0x12ed)]?(_0xe2b398(),console[_0x2698e5(0x415)](_0x2698e5(0x14df)+_0x28f30a[_0x2698e5(0x1062)][_0x2698e5(0x146a)]+'秒')):console[_0x2698e5(0x415)](_0x2698e5(0x4f4));const _0x3cb470=document['getElementById'](_0x2698e5(0xcd4))[_0x2698e5(0x13b8)],_0x147bb1=document['getElementById'](_0x2698e5(0x13f6))[_0x2698e5(0x11a4)],_0x136792=document[_0x2698e5(0x2ec)]('novelai-api-key')[_0x2698e5(0x11a4)]['trim']();localStorage[_0x2698e5(0x1048)](_0x2698e5(0x89f),_0x3cb470),localStorage[_0x2698e5(0x1048)](_0x2698e5(0x13f6),_0x147bb1),localStorage[_0x2698e5(0x1048)](_0x2698e5(0x5da),_0x136792),alert(_0x2698e5(0x803));});const _0x4007b1=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xf25));_0x4007b1[_0x2ea2d1(0xf79)](_0x2ea2d1(0x52b),_0x204203=>{const _0x21e5e2=_0x2ea2d1;_0x204203[_0x21e5e2(0x1104)][_0x21e5e2(0x3b0)](_0x21e5e2(0xb4b),_0x21e5e2(0x10ca));}),_0x4007b1['addEventListener']('blur',_0x200a2b=>{const _0x2dd2fd=_0x2ea2d1;_0x200a2b['target'][_0x2dd2fd(0x3b0)]('type',_0x2dd2fd(0xc81));});async function _0x4d1b6a(_0x15e159,_0x100176,_0x280e8b){const _0x13e38a=_0x2ea2d1,_0xde2e5b=document[_0x13e38a(0x2ec)](_0x15e159)['value'][_0x13e38a(0x97e)](),_0x766894=document['getElementById'](_0x100176)[_0x13e38a(0x11a4)][_0x13e38a(0x97e)]();if(!_0xde2e5b||!_0x766894)return alert(_0x13e38a(0xef0));try{let _0x3bd8e1=_0xde2e5b===GEMINI_API_URL;const _0x105768=await fetch(_0x3bd8e1?GEMINI_API_URL+_0x13e38a(0x494)+getRandomValue(_0x766894):_0xde2e5b+_0x13e38a(0x813),_0x3bd8e1?undefined:{'headers':{'Authorization':_0x13e38a(0xe83)+_0x766894}});if(!_0x105768['ok'])throw new Error(_0x13e38a(0x525));const _0x5940cb=await _0x105768['json']();let _0x3df87b=_0x3bd8e1?_0x5940cb['models'][_0x13e38a(0x11c6)](_0x358442=>({'id':_0x358442[_0x13e38a(0xe36)]['split']('/')[0x1]||_0x358442['name']})):_0x5940cb[_0x13e38a(0x1418)];const _0x386873=document[_0x13e38a(0x2ec)](_0x280e8b);_0x386873[_0x13e38a(0xc43)]='';const _0x32f1eb=_0x280e8b===_0x13e38a(0x12a6)?_0x28f30a['apiConfig'][_0x13e38a(0x2bf)]:_0x28f30a[_0x13e38a(0x1537)]['secondaryModel'];_0x3df87b[_0x13e38a(0xf99)](_0x29991b=>{const _0x22b2dd=_0x13e38a,_0xda85d4=document['createElement']('option');_0xda85d4[_0x22b2dd(0x11a4)]=_0x29991b['id'],_0xda85d4[_0x22b2dd(0x15f)]=_0x29991b['id'];if(_0x29991b['id']===_0x32f1eb)_0xda85d4[_0x22b2dd(0xba2)]=!![];_0x386873[_0x22b2dd(0x998)](_0xda85d4);}),alert(_0x13e38a(0x726));}catch(_0x19b414){alert('拉取模型失败:\x20'+_0x19b414[_0x13e38a(0x13bc)]);}}document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xd65))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x2e8cff=_0x2ea2d1;_0x4d1b6a(_0x2e8cff(0x1580),_0x2e8cff(0xf25),_0x2e8cff(0x12a6));}),document[_0x2ea2d1(0x2ec)]('fetch-secondary-models-btn')[_0x2ea2d1(0xf79)]('click',()=>{const _0x21e749=_0x2ea2d1;_0x4d1b6a(_0x21e749(0x8f3),_0x21e749(0x13ec),'secondary-model-select');}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xc37))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x1efe59=_0x2ea2d1,_0x639313=await _0x33419a('创建世界书',_0x1efe59(0x1458));if(_0x639313&&_0x639313[_0x1efe59(0x97e)]()){const _0x1cf7ad={'id':_0x1efe59(0x944)+Date[_0x1efe59(0x487)](),'name':_0x639313[_0x1efe59(0x97e)](),'content':''};await _0x5b9d83[_0x1efe59(0x13b9)][_0x1efe59(0xe82)](_0x1cf7ad),_0x28f30a[_0x1efe59(0x13b9)][_0x1efe59(0x367)](_0x1cf7ad),_0x6f6974(),_0x39b32a(_0x1cf7ad['id']);}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x109a))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x6c7f90=_0x2ea2d1;if(!_0x143e12)return;const _0x417b17=_0x28f30a[_0x6c7f90(0x13b9)]['find'](_0x36f556=>_0x36f556['id']===_0x143e12);if(!_0x417b17)return;const _0x24d23e=document[_0x6c7f90(0x2ec)]('world-book-name-input')[_0x6c7f90(0x11a4)]['trim']();if(!_0x24d23e){alert(_0x6c7f90(0x1263));return;}_0x417b17[_0x6c7f90(0xe36)]=_0x24d23e;const _0x3c7620=document[_0x6c7f90(0x2ec)](_0x6c7f90(0xddc))['value'];_0x417b17[_0x6c7f90(0x10ce)]=_0x3c7620?parseInt(_0x3c7620):null;const _0x7ccf9a=document[_0x6c7f90(0x2ec)]('world-book-entries-container'),_0x3e8d18=_0x7ccf9a[_0x6c7f90(0x5d6)](_0x6c7f90(0x131b)),_0x105ab3=[];_0x3e8d18[_0x6c7f90(0xf99)](_0x231dec=>{const _0x216ac2=_0x6c7f90,_0x1586c5=_0x231dec[_0x216ac2(0x765)](_0x216ac2(0xb04))[_0x216ac2(0x11a4)][_0x216ac2(0x97e)](),_0xca3842=_0x231dec[_0x216ac2(0x765)](_0x216ac2(0x88e))[_0x216ac2(0x11a4)][_0x216ac2(0x97e)](),_0x5d42d3=_0x231dec[_0x216ac2(0x765)](_0x216ac2(0x8af))[_0x216ac2(0x13b8)];_0xca3842&&_0x105ab3[_0x216ac2(0x367)]({'comment':_0x231dec['querySelector'](_0x216ac2(0x981))[_0x216ac2(0x11a4)][_0x216ac2(0x97e)](),'keys':_0x1586c5?_0x1586c5[_0x216ac2(0xa8a)](',')['map'](_0x371a80=>_0x371a80[_0x216ac2(0x97e)]())[_0x216ac2(0xebc)](_0x2cac41=>_0x2cac41):[],'content':_0xca3842,'enabled':_0x5d42d3});}),_0x417b17['content']=_0x105ab3,await _0x5b9d83['worldBooks'][_0x6c7f90(0x7c3)](_0x417b17),document[_0x6c7f90(0x2ec)](_0x6c7f90(0x8fd))['textContent']=_0x24d23e,_0x143e12=null,_0x17ec27(_0x6c7f90(0x122b)),await _0x6f6974();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x156b))['addEventListener'](_0x2ea2d1(0x1177),async _0x26c6da=>{const _0x5880ca=_0x2ea2d1,_0xdfb377=_0x26c6da[_0x5880ca(0x1104)][_0x5880ca(0x3f2)](_0x5880ca(0x136f));if(_0xdfb377){_0x26c6da[_0x5880ca(0x106c)]();const _0x16a56c=_0x26c6da[_0x5880ca(0x1104)]['closest']('.message-bubble');if(_0x16a56c){const _0x6ae036=parseInt(_0x16a56c[_0x5880ca(0xe93)][_0x5880ca(0x69a)]);!isNaN(_0x6ae036)&&await _0x15c50f(_0x6ae036,_0xdfb377);}return;}const _0x231b36=_0x26c6da['target'][_0x5880ca(0x3f2)]('.voice-message-body[data-text]');if(_0x231b36){const _0x44b0aa=_0x28f30a[_0x5880ca(0x6ce)][_0x28f30a['activeChatId']];if(!_0x44b0aa)return;_0x2eb46c(_0x231b36);const _0x37ff4a=_0x231b36[_0x5880ca(0x3f2)](_0x5880ca(0x124c)),_0xafecaf=_0x37ff4a?_0x37ff4a[_0x5880ca(0x765)](_0x5880ca(0x92e)):null;if(_0x231b36['dataset'][_0x5880ca(0x9c3)]&&_0xafecaf&&_0xafecaf[_0x5880ca(0x589)][_0x5880ca(0x701)]===_0x5880ca(0x13f7)){if(_0x44b0aa[_0x5880ca(0x1423)]){console[_0x5880ca(0x415)](_0x5880ca(0xedf));return;}if(_0x44b0aa[_0x5880ca(0x362)][_0x5880ca(0x1ee)]===![]){console[_0x5880ca(0x415)]('“'+_0x44b0aa['name']+_0x5880ca(0xe76));return;}_0x5e1c7e(_0x231b36);}return;}const _0x40ed5a=_0x26c6da['target']['closest'](_0x5880ca(0xcc8));if(_0x40ed5a){const _0x1795bf=_0x40ed5a[_0x5880ca(0x3f2)]('.message-bubble');if(_0x1795bf){const _0x3f0f76=parseInt(_0x1795bf[_0x5880ca(0xe93)][_0x5880ca(0x69a)]);if(!isNaN(_0x3f0f76)){_0x12fdd1(_0x3f0f76);return;}}}const _0x50ead4=_0x26c6da['target'][_0x5880ca(0x3f2)](_0x5880ca(0xc8a));if(_0x50ead4){const _0x2d2957=_0x50ead4[_0x5880ca(0x3f2)](_0x5880ca(0x124c));if(_0x2d2957){const _0x2c7ec1=parseInt(_0x2d2957['dataset']['timestamp']),_0x7a4713=_0x50ead4[_0x5880ca(0xe93)][_0x5880ca(0x75f)];if(!isNaN(_0x2c7ec1)&&_0x7a4713){await _0x54b6d0(_0x2c7ec1,_0x7a4713);return;}}}const _0x17dcab=_0x26c6da['target'][_0x5880ca(0x3f2)](_0x5880ca(0x1134));if(_0x17dcab){const _0x26eb33=parseInt(_0x17dcab['dataset'][_0x5880ca(0xa53)]);if(!isNaN(_0x26eb33)){const _0x140296=await _0x5b9d83[_0x5880ca(0xc7a)]['get'](_0x26eb33);if(_0x140296){let _0xb70a12='';const _0x2f1a7d=_0x140296[_0x5880ca(0xe87)]===_0x5880ca(0xcc9)?_0x28f30a[_0x5880ca(0x1506)][_0x5880ca(0x19a)]:_0x28f30a[_0x5880ca(0x6ce)][_0x140296[_0x5880ca(0xe87)]]?.[_0x5880ca(0xe36)]||_0x5880ca(0x4cd);if(_0x140296[_0x5880ca(0xb4b)]===_0x5880ca(0x5e8))_0xb70a12=_0x140296[_0x5880ca(0x1047)];else{_0xb70a12=_0x140296[_0x5880ca(0x1202)]||'';if(_0x140296[_0x5880ca(0x6c6)])_0xb70a12+=_0x5880ca(0x543);if(_0x140296['hiddenContent'])_0xb70a12+=_0x5880ca(0xe5a)+_0x140296['hiddenContent']+']';}_0x34d596(_0x5880ca(0xe9f)+_0x2f1a7d+_0x5880ca(0xf92),_0xb70a12[_0x5880ca(0x13ed)](/\n/g,'<br>'));}else _0x34d596('提示',_0x5880ca(0xc3f));}return;}const _0x52ccce=_0x26c6da['target'][_0x5880ca(0x3f2)]('.ai-generated-image');if(_0x52ccce){const _0x592e86=_0x52ccce['dataset'][_0x5880ca(0x9cc)];if(_0x592e86)_0x34d596('照片描述',_0x592e86);return;}const _0x10bdec=_0x26c6da['target'][_0x5880ca(0x3f2)](_0x5880ca(0x907));if(_0x10bdec&&_0x10bdec[_0x5880ca(0xe93)][_0x5880ca(0x83b)]){const _0x55291f=parseInt(_0x10bdec['dataset'][_0x5880ca(0x83b)]);!isNaN(_0x55291f)&&_0x44e2b8(_0x55291f);}const _0x2178d2=_0x26c6da[_0x5880ca(0x1104)][_0x5880ca(0x3f2)](_0x5880ca(0xb59));if(_0x2178d2){const _0x315bc1=_0x2178d2['closest'](_0x5880ca(0x124c));_0x315bc1&&_0x1fb062(parseInt(_0x315bc1[_0x5880ca(0xe93)]['timestamp']));}const _0x4ba51f=_0x26c6da[_0x5880ca(0x1104)][_0x5880ca(0x3f2)]('.red-packet-card');if(_0x4ba51f){const _0x29afd0=_0x4ba51f[_0x5880ca(0x3f2)](_0x5880ca(0x124c));if(_0x29afd0&&_0x29afd0['dataset'][_0x5880ca(0x69a)]){const _0x3cba5c=parseInt(_0x29afd0[_0x5880ca(0xe93)][_0x5880ca(0x69a)]);_0x1b1fff(_0x3cba5c);}}const _0xc7ca57=_0x26c6da[_0x5880ca(0x1104)][_0x5880ca(0x3f2)]('.poll-card');if(_0xc7ca57){const _0x1dcd0b=parseInt(_0xc7ca57[_0x5880ca(0xe93)][_0x5880ca(0xbd7)]);if(isNaN(_0x1dcd0b))return;const _0x45f81e=_0x26c6da[_0x5880ca(0x1104)][_0x5880ca(0x3f2)](_0x5880ca(0xbc3));if(_0x45f81e&&!_0xc7ca57[_0x5880ca(0xff6)]['contains'](_0x5880ca(0x7df))){_0xa54a77(_0x1dcd0b,_0x45f81e[_0x5880ca(0xe93)][_0x5880ca(0x29d)]);return;}const _0x545d9b=_0x26c6da['target'][_0x5880ca(0x3f2)](_0x5880ca(0xd25));if(_0x545d9b){_0xc7ca57['classList']['contains'](_0x5880ca(0x7df))?_0x53f237(_0x1dcd0b):_0xa95d12(_0x1dcd0b);return;}_0xc7ca57[_0x5880ca(0xff6)]['contains']('closed')&&_0x53f237(_0x1dcd0b);}const _0x4b3b12=_0x26c6da[_0x5880ca(0x1104)][_0x5880ca(0x3f2)](_0x5880ca(0x37c));if(_0x4b3b12){const _0x463003=_0x28f30a[_0x5880ca(0x6ce)][_0x28f30a[_0x5880ca(0x11b9)]],_0xe50e0d=_0x4b3b12['closest'](_0x5880ca(0x1571));if(_0x463003&&_0xe50e0d){const _0xc0d9b=parseInt(_0xe50e0d[_0x5880ca(0xe93)][_0x5880ca(0x69a)]),_0x396c28=_0x463003['history'][_0x5880ca(0x412)](_0x341ed5=>_0x341ed5[_0x5880ca(0x69a)]===_0xc0d9b);if(_0x396c28&&_0x396c28[_0x5880ca(0x6cd)]){let _0x3e0f32='';const _0x141487=_0x396c28['recalledData'];_0x141487[_0x5880ca(0x223)]==='text'?_0x3e0f32=_0x5880ca(0xb00)+_0x141487[_0x5880ca(0x37f)]+'\x22':_0x3e0f32=_0x5880ca(0x77a)+_0x141487[_0x5880ca(0x223)]+_0x5880ca(0x7e6),_0x34d596(_0x5880ca(0x8ac),_0x3e0f32);}}}const _0x177233=_0x26c6da['target'][_0x5880ca(0x3f2)](_0x5880ca(0x111c));if(_0x177233&&_0x177233[_0x5880ca(0x3f2)]('.message-bubble.is-link-share')){const _0x1d01a5=parseInt(_0x177233['dataset'][_0x5880ca(0x69a)]);_0x599bb7(_0x1d01a5);}const _0x2512b3=_0x26c6da[_0x5880ca(0x1104)][_0x5880ca(0x3f2)](_0x5880ca(0x124c));if(_0x2512b3&&_0x2512b3[_0x5880ca(0xff6)][_0x5880ca(0xe9a)]('ai')&&_0x2512b3[_0x5880ca(0xff6)][_0x5880ca(0xe9a)](_0x5880ca(0xb80))&&_0x2512b3['dataset']['status']===_0x5880ca(0x8c9)){const _0x316d92=parseInt(_0x2512b3[_0x5880ca(0xe93)][_0x5880ca(0x69a)]);!isNaN(_0x316d92)&&_0x1c5e62(_0x316d92);}});const _0x5a9526=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x144a)),_0x3adc0b=document['querySelector'](_0x2ea2d1(0x1453)),_0x26e20a=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x4c2));function _0x4261fd(){const _0x4572c5=_0x2ea2d1,_0x1313d8=_0x26e20a[_0x4572c5(0x5d6)](_0x4572c5(0x104a)),_0xf7be42=document[_0x4572c5(0x765)](_0x4572c5(0x3bd));if(_0x1313d8[_0x4572c5(0x9a1)]===0x0)_0xf7be42[_0x4572c5(0x15f)]=_0x4572c5(0xb68);else{if(_0x1313d8[_0x4572c5(0x9a1)]>0x2)_0xf7be42[_0x4572c5(0x15f)]=_0x4572c5(0x7f1)+_0x1313d8[_0x4572c5(0x9a1)]+_0x4572c5(0x613);else{const _0x11bc87=Array['from'](_0x1313d8)[_0x4572c5(0x11c6)](_0x43a264=>{const _0x3e00c5=_0x4572c5;return _0x43a264[_0x3e00c5(0x9e3)][_0x3e00c5(0x15f)][_0x3e00c5(0x97e)]();});_0xf7be42[_0x4572c5(0x15f)]=_0x11bc87[_0x4572c5(0xbad)](',\x20');}}}_0x3adc0b[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x342bb5=>{const _0x59115e=_0x2ea2d1;_0x342bb5[_0x59115e(0x106c)](),_0x26e20a[_0x59115e(0xff6)][_0x59115e(0x14c8)](_0x59115e(0x149d)),_0x3adc0b[_0x59115e(0xff6)]['toggle'](_0x59115e(0x82e));}),document[_0x2ea2d1(0x2ec)]('world-book-checkboxes-container')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x4261fd),window[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x168202=>{const _0x2f0d80=_0x2ea2d1;!document[_0x2f0d80(0x765)]('.custom-multiselect')[_0x2f0d80(0xe9a)](_0x168202['target'])&&(_0x26e20a[_0x2f0d80(0xff6)][_0x2f0d80(0x1424)]('visible'),_0x3adc0b[_0x2f0d80(0xff6)][_0x2f0d80(0x1424)]('expanded'));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x128a))[_0x2ea2d1(0xf79)]('click',async()=>{const _0xa55da0=_0x2ea2d1;_0x514a81();if(!_0x28f30a[_0xa55da0(0x11b9)])return;const _0x2b6555=_0x28f30a[_0xa55da0(0x6ce)][_0x28f30a[_0xa55da0(0x11b9)]],_0x21cb9d=_0x2b6555[_0xa55da0(0x1423)],_0x1387e1=document[_0xa55da0(0x2ec)](_0xa55da0(0x2f9));!_0x21cb9d&&_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0x87b)]&&_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0x87b)][_0xa55da0(0x9a1)]>0x0?_0x1387e1[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0xa55da0(0x13f7):_0x1387e1[_0xa55da0(0x589)]['display']=_0xa55da0(0x5b1);document[_0xa55da0(0x2ec)]('chat-name-group')['style'][_0xa55da0(0x701)]=_0xa55da0(0x13f7),document[_0xa55da0(0x2ec)](_0xa55da0(0x960))[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0xa55da0(0x13f7),document[_0xa55da0(0x2ec)](_0xa55da0(0x7cd))[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0xa55da0(0x13f7),document[_0xa55da0(0x2ec)](_0xa55da0(0xc2d))[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0x21cb9d?_0xa55da0(0x13f7):_0xa55da0(0x5b1),document[_0xa55da0(0x2ec)](_0xa55da0(0x700))['style'][_0xa55da0(0x701)]=_0x21cb9d?'none':_0xa55da0(0x13f7),document[_0xa55da0(0x2ec)]('group-avatar-group')[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0x21cb9d?_0xa55da0(0x13f7):_0xa55da0(0x5b1),document[_0xa55da0(0x2ec)]('group-members-group')[_0xa55da0(0x589)]['display']=_0x21cb9d?_0xa55da0(0x13f7):_0xa55da0(0x5b1),document[_0xa55da0(0x2ec)](_0xa55da0(0xe0c))[_0xa55da0(0x589)]['display']=_0x21cb9d?_0xa55da0(0x5b1):_0xa55da0(0x13f7),document[_0xa55da0(0x2ec)]('ai-avatar-group')[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0x21cb9d?'none':'block',document[_0xa55da0(0x2ec)](_0xa55da0(0x1268))[_0xa55da0(0x589)]['display']=_0x21cb9d?_0xa55da0(0x5b1):_0xa55da0(0x13f7),document[_0xa55da0(0x2ec)](_0xa55da0(0x120d))[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0x21cb9d?_0xa55da0(0x5b1):'block',document[_0xa55da0(0x2ec)]('ai-voice-id-group')['style'][_0xa55da0(0x701)]=_0x21cb9d?_0xa55da0(0x5b1):_0xa55da0(0x13f7),document[_0xa55da0(0x2ec)]('inject-thought-group')[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0x21cb9d?_0xa55da0(0x5b1):_0xa55da0(0x13f7),document[_0xa55da0(0x2ec)](_0xa55da0(0x14ee))['style'][_0xa55da0(0x701)]=_0x21cb9d?_0xa55da0(0x5b1):'block',document[_0xa55da0(0x2ec)](_0xa55da0(0x5a5))[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0x21cb9d?'none':_0xa55da0(0x13f7),document[_0xa55da0(0x2ec)](_0xa55da0(0x22c))['style'][_0xa55da0(0x701)]=_0x21cb9d?'block':_0xa55da0(0x5b1),document[_0xa55da0(0x2ec)](_0xa55da0(0xc82))['value']=_0x2b6555[_0xa55da0(0xe36)],document[_0xa55da0(0x2ec)]('my-persona')['value']=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0x1528)],document[_0xa55da0(0x2ec)](_0xa55da0(0xead))[_0xa55da0(0xce4)]=_0x2b6555[_0xa55da0(0x362)]['myAvatar']||(_0x21cb9d?_0x3ba305:_0x825cf1),document[_0xa55da0(0x2ec)](_0xa55da0(0xda2))[_0xa55da0(0x11a4)]=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0xfcd)],document[_0xa55da0(0x2ec)](_0xa55da0(0x8b3))[_0xa55da0(0x11a4)]=_0x2b6555['settings'][_0xa55da0(0x13cb)]||0xa;const _0x228c0a=document['getElementById'](_0xa55da0(0x100b)),_0x276688=document['getElementById'](_0xa55da0(0x9b8));_0x2b6555[_0xa55da0(0x362)]['background']?(_0x228c0a['src']=_0x2b6555['settings'][_0xa55da0(0x137c)],_0x228c0a[_0xa55da0(0x589)]['display']='block',_0x276688['style'][_0xa55da0(0x701)]='inline-block'):(_0x228c0a[_0xa55da0(0x589)][_0xa55da0(0x701)]='none',_0x276688[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0xa55da0(0x5b1));document[_0xa55da0(0x2ec)](_0xa55da0(0x14a7))[_0xa55da0(0x589)]['display']=_0x21cb9d?_0xa55da0(0x5b1):'block',document['getElementById'](_0xa55da0(0x140f))[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0x21cb9d?_0xa55da0(0x5b1):_0xa55da0(0x13f7),document[_0xa55da0(0x2ec)]('group-background-activity-group')[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0x21cb9d?_0xa55da0(0x13f7):'none';const _0xf5d16=document[_0xa55da0(0x2ec)]('time-perception-toggle'),_0x175138=document[_0xa55da0(0x2ec)]('time-zone-group');_0xf5d16[_0xa55da0(0x13b8)]=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0x425)],_0x175138[_0xa55da0(0x589)]['display']=_0xf5d16[_0xa55da0(0x13b8)]?_0xa55da0(0x13f7):_0xa55da0(0x5b1);const _0x33becf=document[_0xa55da0(0x2ec)](_0xa55da0(0x1167)),_0x587fbc=Intl[_0xa55da0(0x8df)](_0xa55da0(0xfbe));_0x33becf['innerHTML']='',_0x587fbc[_0xa55da0(0xf99)](_0x5ba3b4=>{const _0x2c15f3=_0xa55da0,_0x35fa49=document['createElement'](_0x2c15f3(0x29d));_0x35fa49[_0x2c15f3(0x11a4)]=_0x5ba3b4,_0x35fa49[_0x2c15f3(0x15f)]=_0x5ba3b4,_0x33becf['appendChild'](_0x35fa49);}),_0x33becf[_0xa55da0(0x11a4)]=_0x2b6555['settings']['timeZone']||_0xa55da0(0x96c);if(_0x21cb9d)document['getElementById'](_0xa55da0(0xf55))[_0xa55da0(0x13b8)]=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0x12ed)],document[_0xa55da0(0x2ec)](_0xa55da0(0x12b5))['value']=_0x2b6555['settings'][_0xa55da0(0xa28)]||'',document[_0xa55da0(0x2ec)]('group-avatar-preview')[_0xa55da0(0xce4)]=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0x42c)]||_0x563b2b,document[_0xa55da0(0x2ec)](_0xa55da0(0xd2d))[_0xa55da0(0x11a4)]=_0x2b6555['settings']['actionCooldownMinutes']||0xa,document[_0xa55da0(0x2ec)]('single-char-background-activity-group')[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0xa55da0(0x5b1),_0x111ce8(_0x2b6555[_0xa55da0(0x10f2)]);else{document[_0xa55da0(0x2ec)]('single-char-background-activity-group')[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0xa55da0(0x13f7),document['getElementById']('char-background-activity-switch')['checked']=_0x2b6555['settings'][_0xa55da0(0x12ed)],document[_0xa55da0(0x2ec)](_0xa55da0(0x1042))[_0xa55da0(0x13b8)]=_0x2b6555['settings']['injectLatestThought'];const _0x5e6591=document[_0xa55da0(0x2ec)](_0xa55da0(0x1282)),_0x48014b=document[_0xa55da0(0x2ec)](_0xa55da0(0x11fc)),_0x199b44=document[_0xa55da0(0x2ec)](_0xa55da0(0x8e1)),_0x4f0b3e=document[_0xa55da0(0x2ec)](_0xa55da0(0x1009));_0x5e6591[_0xa55da0(0x13b8)]=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0x1448)]||![],_0x48014b['style'][_0xa55da0(0x701)]=_0x5e6591['checked']?_0xa55da0(0x13f7):_0xa55da0(0x5b1),_0x199b44[_0xa55da0(0x11a4)]=_0x2b6555[_0xa55da0(0x362)]['offlineMinLength']||0x64,_0x4f0b3e[_0xa55da0(0x11a4)]=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0xd67)]||0x12c,await _0x2bda92(_0x2b6555),document[_0xa55da0(0x2ec)](_0xa55da0(0x13f9))['value']=_0x2b6555[_0xa55da0(0x66c)],document['getElementById']('ai-voice-id-input')[_0xa55da0(0x11a4)]=_0x2b6555['settings'][_0xa55da0(0x8c4)]||'',document[_0xa55da0(0x2ec)]('enable-tts-switch')['checked']=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0x1ee)]!==![],document['getElementById'](_0xa55da0(0xd26))['value']=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0x67c)],document['getElementById']('ai-avatar-preview')['src']=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0xe91)]||_0x825cf1,document[_0xa55da0(0x2ec)]('my-nickname-input')[_0xa55da0(0x11a4)]=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0xa28)]||'我',document[_0xa55da0(0x2ec)](_0xa55da0(0x469))['value']=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0xff3)]||0xa;const _0x59b225=document['getElementById'](_0xa55da0(0x21f));_0x59b225[_0xa55da0(0xc43)]=_0xa55da0(0x3f8);const _0x249835=await _0x5b9d83[_0xa55da0(0x1479)][_0xa55da0(0x14b5)]();_0x249835[_0xa55da0(0xf99)](_0x2d3b91=>{const _0x37b3f8=_0xa55da0,_0x36868f=document[_0x37b3f8(0x14ae)](_0x37b3f8(0x29d));_0x36868f[_0x37b3f8(0x11a4)]=_0x2d3b91['id'],_0x36868f['textContent']=_0x2d3b91['name'];if(_0x2b6555[_0x37b3f8(0x1542)]===_0x2d3b91['id'])_0x36868f[_0x37b3f8(0xba2)]=!![];_0x59b225[_0x37b3f8(0x998)](_0x36868f);});const _0xea73a=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0xd88)]||{'vertical':_0xa55da0(0xdd5),'horizontal':_0xa55da0(0x40e),'offset':0xa};document[_0xa55da0(0x2ec)](_0xa55da0(0x1451))['value']=_0xea73a[_0xa55da0(0x3c4)],document['getElementById'](_0xa55da0(0xc4e))[_0xa55da0(0x11a4)]=_0xea73a[_0xa55da0(0x121c)],document[_0xa55da0(0x2ec)](_0xa55da0(0xac1))[_0xa55da0(0x11a4)]=_0xea73a['offset'];}const _0x5cc515=document['getElementById']('world-book-checkboxes-container');_0x5cc515[_0xa55da0(0xc43)]='';const [_0x275a9f,_0x117c3c]=await Promise[_0xa55da0(0xa92)]([_0x5b9d83[_0xa55da0(0x5c0)]['toArray'](),_0x5b9d83[_0xa55da0(0x13b9)][_0xa55da0(0x14b5)]()]),_0x3f165f=new Set(_0x2b6555[_0xa55da0(0x362)]['linkedWorldBookIds']||[]);if(_0x117c3c[_0xa55da0(0x9a1)]===0x0)_0x5cc515[_0xa55da0(0xc43)]=_0xa55da0(0xd29);else{_0x275a9f[_0xa55da0(0xf99)](_0x4eb989=>{const _0x14c4c0=_0xa55da0,_0x455e27=_0x117c3c[_0x14c4c0(0xebc)](_0x4c1b98=>_0x4c1b98[_0x14c4c0(0x10ce)]===_0x4eb989['id']);if(_0x455e27['length']>0x0){const _0x43757e=document[_0x14c4c0(0x14ae)]('h4');_0x43757e[_0x14c4c0(0x15f)]=_0x4eb989[_0x14c4c0(0xe36)],_0x43757e[_0x14c4c0(0x589)]['cssText']=_0x14c4c0(0x827),_0x5cc515[_0x14c4c0(0x998)](_0x43757e),_0x455e27[_0x14c4c0(0xf99)](_0x4348dd=>{const _0x580115=_0x14c4c0,_0x5e9ed3=_0x3f165f[_0x580115(0xbf1)](_0x4348dd['id']),_0x380537=document[_0x580115(0x14ae)]('label');_0x380537['innerHTML']=_0x580115(0x106a)+_0x4348dd['id']+'\x22\x20'+(_0x5e9ed3?'checked':'')+'>\x20'+_0x4348dd[_0x580115(0xe36)],_0x5cc515[_0x580115(0x998)](_0x380537);});}});const _0x137601=_0x117c3c[_0xa55da0(0xebc)](_0x1e5a50=>!_0x1e5a50[_0xa55da0(0x10ce)]);if(_0x137601[_0xa55da0(0x9a1)]>0x0){const _0x32456f=document['createElement']('h4');_0x32456f['textContent']=_0xa55da0(0x5d8),_0x32456f[_0xa55da0(0x589)][_0xa55da0(0x57a)]=_0xa55da0(0xfc0),_0x5cc515[_0xa55da0(0x998)](_0x32456f),_0x137601[_0xa55da0(0xf99)](_0x595fe3=>{const _0x437a64=_0xa55da0,_0x285706=_0x3f165f[_0x437a64(0xbf1)](_0x595fe3['id']),_0x321050=document[_0x437a64(0x14ae)](_0x437a64(0xa05));_0x321050[_0x437a64(0xc43)]=_0x437a64(0x106a)+_0x595fe3['id']+'\x22\x20'+(_0x285706?_0x437a64(0x13b8):'')+'>\x20'+_0x595fe3[_0x437a64(0xe36)],_0x5cc515[_0x437a64(0x998)](_0x321050);});}}_0x4261fd();const _0x3d3e43=document[_0xa55da0(0x2ec)](_0xa55da0(0x995)),_0xc3a757=document[_0xa55da0(0x2ec)](_0xa55da0(0xa31)),_0x2e0a24=document[_0xa55da0(0x2ec)](_0xa55da0(0xed8)),_0x58815e=_0x2b6555[_0xa55da0(0x362)]['linkedMemoryChatIds']||[];_0x3d3e43['checked']=_0x58815e[_0xa55da0(0x9a1)]>0x0,_0xc3a757[_0xa55da0(0x589)][_0xa55da0(0x701)]=_0x3d3e43[_0xa55da0(0x13b8)]?'block':_0xa55da0(0x5b1),_0x2e0a24[_0xa55da0(0xc43)]='',Object[_0xa55da0(0x74e)](_0x28f30a['chats'])[_0xa55da0(0xf99)](_0xa8f6b5=>{const _0x2b69c0=_0xa55da0;if(_0xa8f6b5['id']===_0x2b6555['id'])return;const _0x350a64=_0x58815e[_0x2b69c0(0x138a)](_0xa8f6b5['id']),_0x360c74=_0xa8f6b5['isGroup']?'[群聊]':_0x2b69c0(0xe1d),_0x589244=document[_0x2b69c0(0x14ae)](_0x2b69c0(0xa05));_0x589244[_0x2b69c0(0xc43)]='<input\x20type=\x22checkbox\x22\x20value=\x22'+_0xa8f6b5['id']+'\x22\x20'+(_0x350a64?_0x2b69c0(0x13b8):'')+'>\x20'+_0x360c74+'\x20'+_0xa8f6b5['name'],_0x2e0a24['appendChild'](_0x589244);});function _0x5d6f54(){const _0x566166=_0xa55da0,_0x51cadf=_0x2e0a24[_0x566166(0x5d6)](_0x566166(0x104a)),_0x100a2b=_0xc3a757['querySelector']('.selected-options-text');if(_0x51cadf[_0x566166(0x9a1)]===0x0)_0x100a2b[_0x566166(0x15f)]=_0x566166(0xb68);else _0x51cadf[_0x566166(0x9a1)]>0x2?_0x100a2b[_0x566166(0x15f)]=_0x566166(0x7f1)+_0x51cadf[_0x566166(0x9a1)]+'\x20项':_0x100a2b['textContent']=Array['from'](_0x51cadf)[_0x566166(0x11c6)](_0x4c34df=>_0x4c34df['parentElement'][_0x566166(0x15f)][_0x566166(0x97e)]())[_0x566166(0xbad)](',\x20');}_0x5d6f54(),_0x3d3e43[_0xa55da0(0xf79)](_0xa55da0(0x217),()=>{const _0x10b91c=_0xa55da0;_0xc3a757[_0x10b91c(0x589)][_0x10b91c(0x701)]=_0x3d3e43['checked']?'block':_0x10b91c(0x5b1);});const _0xdda0f4=_0xc3a757['querySelector'](_0xa55da0(0x4b3)),_0x4ae48f=_0xdda0f4[_0xa55da0(0x303)](!![]);_0xdda0f4[_0xa55da0(0x1092)][_0xa55da0(0x6ab)](_0x4ae48f,_0xdda0f4),_0x4ae48f['addEventListener'](_0xa55da0(0x1177),_0xc4943d=>{const _0xb14094=_0xa55da0;_0xc4943d[_0xb14094(0x106c)](),_0x2e0a24[_0xb14094(0xff6)]['toggle'](_0xb14094(0x149d)),_0x4ae48f[_0xb14094(0xff6)][_0xb14094(0x14c8)](_0xb14094(0x82e));}),_0x2e0a24['addEventListener']('change',_0x5d6f54);const _0x294716=document[_0xa55da0(0x765)]('input[name=\x22theme-select\x22][value=\x22'+(_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0x2a7)]||'default')+'\x22]');if(_0x294716)_0x294716[_0xa55da0(0x13b8)]=!![];const _0x2ab933=document[_0xa55da0(0x2ec)](_0xa55da0(0x3ca));_0x2ab933[_0xa55da0(0x11a4)]=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0x14b8)]||0xd,document['getElementById'](_0xa55da0(0x7a1))[_0xa55da0(0x15f)]=_0x2ab933[_0xa55da0(0x11a4)]+'px';const _0x17f2e0=document['getElementById'](_0xa55da0(0x12b0));_0x17f2e0['value']=_0x2b6555['settings'][_0xa55da0(0x9f1)]||'',_0xa23065(),document[_0xa55da0(0x2ec)]('auto-memory-toggle')[_0xa55da0(0x13b8)]=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0x129c)]||![],document[_0xa55da0(0x2ec)](_0xa55da0(0xf95))[_0xa55da0(0x11a4)]=_0x2b6555[_0xa55da0(0x362)][_0xa55da0(0x424)]||0x14,setTimeout(()=>{const _0xc45e47=_0xa55da0;_0x361fc8();const _0x2b2b83=[_0xc45e47(0xd26),_0xc45e47(0xe6f),_0xc45e47(0xda2),_0xc45e47(0x8b3),_0xc45e47(0x606),'auto-memory-interval','offline-mode-toggle',_0xc45e47(0x8e1),'offline-max-length-input',_0xc45e47(0x1192)];_0x2b2b83[_0xc45e47(0xf99)](_0x209736=>{const _0x1f5908=_0xc45e47,_0x2bb6d4=document[_0x1f5908(0x2ec)](_0x209736);_0x2bb6d4&&_0x2bb6d4[_0x1f5908(0xf79)](_0x1f5908(0x6a9),_0x361fc8);}),document[_0xc45e47(0x2ec)](_0xc45e47(0x4c2))['addEventListener'](_0xc45e47(0x217),_0x361fc8),document['getElementById'](_0xc45e47(0xed8))['addEventListener'](_0xc45e47(0x217),_0x361fc8),document[_0xc45e47(0x2ec)](_0xc45e47(0x995))[_0xc45e47(0xf79)](_0xc45e47(0x217),_0x361fc8);},0x64),_0x17ec27('chat-settings-screen');});function _0x111ce8(_0x324c86){const _0x5f3199=_0x2ea2d1,_0x29c144=document['getElementById'](_0x5f3199(0xb48));_0x29c144[_0x5f3199(0xc43)]='',_0x324c86[_0x5f3199(0xf99)](_0x3089c0=>{const _0x5da300=_0x5f3199,_0x129c7a=document[_0x5da300(0x14ae)]('div');_0x129c7a[_0x5da300(0xdd1)]='member-editor',_0x129c7a[_0x5da300(0xe93)]['memberId']=_0x3089c0['id'];const _0x578fe6=_0x3089c0[_0x5da300(0x516)]||(_0x28f30a[_0x5da300(0x6ce)][_0x3089c0['id']]?_0x28f30a[_0x5da300(0x6ce)][_0x3089c0['id']][_0x5da300(0x362)][_0x5da300(0xe91)]:_0xd71c66);_0x129c7a[_0x5da300(0xc43)]=_0x5da300(0x416)+_0x578fe6+'\x22\x20alt=\x22'+_0x3089c0[_0x5da300(0x8a8)]+_0x5da300(0x8ae)+_0x3089c0[_0x5da300(0x8a8)]+_0x5da300(0xd21),_0x129c7a[_0x5da300(0xf79)](_0x5da300(0x1177),()=>_0x5ab36b(_0x3089c0['id'])),_0x29c144[_0x5da300(0x998)](_0x129c7a);});}document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xb54))['addEventListener']('click',async()=>{const _0x299b34=_0x2ea2d1;if(!_0x6c1e72)return;const _0x1d618a=_0x28f30a[_0x299b34(0x6ce)][_0x28f30a[_0x299b34(0x11b9)]],_0x1370bd=_0x1d618a[_0x299b34(0x10f2)][_0x299b34(0x412)](_0x1007c1=>_0x1007c1['id']===_0x6c1e72);if(!_0x1370bd)return;const _0x56ff03=document[_0x299b34(0x2ec)](_0x299b34(0x6ad))['value'][_0x299b34(0x97e)]();if(!_0x56ff03){alert(_0x299b34(0xdf0));return;}_0x1370bd[_0x299b34(0x8a8)]=_0x56ff03,_0x1370bd[_0x299b34(0xe32)]=document[_0x299b34(0x2ec)](_0x299b34(0x1412))[_0x299b34(0x11a4)];const _0x51e746=document[_0x299b34(0x2ec)]('member-avatar-preview')[_0x299b34(0xce4)];_0x1370bd[_0x299b34(0x516)]=_0x51e746;const _0x2d9941=_0x28f30a[_0x299b34(0x6ce)][_0x1370bd['id']];_0x2d9941&&(_0x2d9941[_0x299b34(0x362)][_0x299b34(0xe91)]=_0x51e746,await _0x5b9d83[_0x299b34(0x6ce)]['put'](_0x2d9941)),await _0x5b9d83['chats']['put'](_0x1d618a),_0x111ce8(_0x1d618a[_0x299b34(0x10f2)]),document[_0x299b34(0x2ec)](_0x299b34(0x657))[_0x299b34(0xff6)][_0x299b34(0x1424)]('visible'),_0x6c1e72=null;});function _0x5ab36b(_0x1465f0){const _0x3722ca=_0x2ea2d1;_0x6c1e72=_0x1465f0;const _0x4543b0=_0x28f30a['chats'][_0x28f30a[_0x3722ca(0x11b9)]],_0x4f1156=_0x4543b0[_0x3722ca(0x10f2)][_0x3722ca(0x412)](_0x48ac29=>_0x48ac29['id']===_0x1465f0);if(!_0x4f1156)return;document[_0x3722ca(0x2ec)](_0x3722ca(0x6ad))[_0x3722ca(0x11a4)]=_0x4f1156[_0x3722ca(0x8a8)],document[_0x3722ca(0x2ec)](_0x3722ca(0x1412))[_0x3722ca(0x11a4)]=_0x4f1156[_0x3722ca(0xe32)];const _0x38da8e=_0x4f1156['avatar']||(_0x28f30a[_0x3722ca(0x6ce)][_0x4f1156['id']]?_0x28f30a[_0x3722ca(0x6ce)][_0x4f1156['id']]['settings'][_0x3722ca(0xe91)]:_0xd71c66);document[_0x3722ca(0x2ec)](_0x3722ca(0x150c))[_0x3722ca(0xce4)]=_0x38da8e,document[_0x3722ca(0x2ec)](_0x3722ca(0x657))[_0x3722ca(0xff6)][_0x3722ca(0xe82)](_0x3722ca(0x149d));}document['getElementById']('cancel-member-settings-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x446ff9=_0x2ea2d1;document['getElementById'](_0x446ff9(0x657))['classList'][_0x446ff9(0x1424)](_0x446ff9(0x149d)),_0x6c1e72=null;}),document['getElementById'](_0x2ea2d1(0xb54))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x1c16f9=_0x2ea2d1;if(!_0x6c1e72)return;const _0x22d337=_0x28f30a['chats'][_0x28f30a['activeChatId']],_0x1b806a=_0x22d337[_0x1c16f9(0x10f2)][_0x1c16f9(0x412)](_0x16c03b=>_0x16c03b['id']===_0x6c1e72);if(!_0x1b806a)return;const _0x48ceb5=document['getElementById'](_0x1c16f9(0x6ad))[_0x1c16f9(0x11a4)][_0x1c16f9(0x97e)]();if(!_0x48ceb5){alert(_0x1c16f9(0xdf0));return;}_0x1b806a[_0x1c16f9(0x8a8)]=_0x48ceb5,_0x1b806a[_0x1c16f9(0xe32)]=document[_0x1c16f9(0x2ec)]('member-persona-input')[_0x1c16f9(0x11a4)];const _0x2ccdbe=document['getElementById'](_0x1c16f9(0x150c))[_0x1c16f9(0xce4)];_0x1b806a[_0x1c16f9(0x516)]=_0x2ccdbe;const _0x7ae885=_0x28f30a['chats'][_0x1b806a['id']];_0x7ae885&&(_0x7ae885[_0x1c16f9(0x362)][_0x1c16f9(0xe91)]=_0x2ccdbe,await _0x5b9d83[_0x1c16f9(0x6ce)][_0x1c16f9(0x7c3)](_0x7ae885)),await _0x5b9d83[_0x1c16f9(0x6ce)][_0x1c16f9(0x7c3)](_0x22d337),_0x111ce8(_0x22d337[_0x1c16f9(0x10f2)]),document[_0x1c16f9(0x2ec)](_0x1c16f9(0x657))[_0x1c16f9(0xff6)]['remove'](_0x1c16f9(0x149d)),_0x6c1e72=null;}),document[_0x2ea2d1(0x2ec)]('reset-theme-btn')[_0x2ea2d1(0xf79)]('click',()=>{const _0x1ff3df=_0x2ea2d1;document['getElementById'](_0x1ff3df(0x138c))[_0x1ff3df(0x13b8)]=!![];}),document['getElementById']('save-chat-settings-btn')[_0x2ea2d1(0xf79)]('click',async()=>{const _0x16fb4c=_0x2ea2d1;if(!_0x28f30a[_0x16fb4c(0x11b9)])return;const _0x3539e6=_0x28f30a[_0x16fb4c(0x6ce)][_0x28f30a[_0x16fb4c(0x11b9)]],_0x5d420d=_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x1448)]||![],_0x360224=document[_0x16fb4c(0x2ec)]('chat-name-input')['value'][_0x16fb4c(0x97e)]();if(!_0x360224)return alert(_0x16fb4c(0x11a5));if(!_0x3539e6[_0x16fb4c(0x1423)]&&_0x360224!==_0x3539e6[_0x16fb4c(0xe36)]){if(!_0x3539e6['nameHistory'])_0x3539e6[_0x16fb4c(0x316)]=[];if(!_0x3539e6[_0x16fb4c(0x316)][_0x16fb4c(0x138a)](_0x3539e6[_0x16fb4c(0xe36)]))_0x3539e6['nameHistory']['push'](_0x3539e6[_0x16fb4c(0xe36)]);}_0x3539e6['name']=_0x360224;const _0x546e05=document[_0x16fb4c(0x765)](_0x16fb4c(0x13ad));_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x2a7)]=_0x546e05?_0x546e05[_0x16fb4c(0x11a4)]:'default',_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x14b8)]=parseInt(document[_0x16fb4c(0x2ec)](_0x16fb4c(0x3ca))['value']),_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x9f1)]=document['getElementById'](_0x16fb4c(0x12b0))['value']['trim'](),_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x1528)]=document[_0x16fb4c(0x2ec)](_0x16fb4c(0xe6f))[_0x16fb4c(0x11a4)],_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x10a3)]=document[_0x16fb4c(0x2ec)](_0x16fb4c(0xead))[_0x16fb4c(0xce4)],_0x3539e6['settings']['maxMemory']=parseInt(document[_0x16fb4c(0x2ec)](_0x16fb4c(0xda2))[_0x16fb4c(0x11a4)])||0xa,_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x13cb)]=parseInt(document[_0x16fb4c(0x2ec)]('linked-memory-count')[_0x16fb4c(0x11a4)])||0xa;const _0x3942c1=document[_0x16fb4c(0x5d6)](_0x16fb4c(0xf11)),_0x19acdf=[];_0x3942c1['forEach'](_0x4e28f0=>{const _0x28ee76=_0x16fb4c;_0x4e28f0[_0x28ee76(0x11a4)][_0x28ee76(0x741)]('book_')&&_0x19acdf['push'](_0x4e28f0[_0x28ee76(0x11a4)][_0x28ee76(0x13ed)]('book_',''));}),_0x3539e6[_0x16fb4c(0x362)]['linkedWorldBookIds']=_0x19acdf;const _0x3e8c5c=document[_0x16fb4c(0x2ec)](_0x16fb4c(0x995))[_0x16fb4c(0x13b8)];if(_0x3e8c5c){const _0x2d1d56=document[_0x16fb4c(0x5d6)](_0x16fb4c(0x3d7));_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x239)]=Array[_0x16fb4c(0x13d1)](_0x2d1d56)['map'](_0x2fa849=>_0x2fa849[_0x16fb4c(0x11a4)]);}else _0x3539e6['settings'][_0x16fb4c(0x239)]=[];_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x129c)]=document[_0x16fb4c(0x2ec)]('auto-memory-toggle')['checked'],_0x3539e6['settings'][_0x16fb4c(0x424)]=parseInt(document['getElementById'](_0x16fb4c(0xf95))[_0x16fb4c(0x11a4)])||0x14,_0x3539e6['settings']['enableTimePerception']=document[_0x16fb4c(0x2ec)](_0x16fb4c(0x16d))['checked'],_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0xfbe)]=document[_0x16fb4c(0x2ec)](_0x16fb4c(0x1167))['value'];if(_0x3539e6[_0x16fb4c(0x1423)])_0x3539e6[_0x16fb4c(0x362)]['enableBackgroundActivity']=document[_0x16fb4c(0x2ec)](_0x16fb4c(0xf55))[_0x16fb4c(0x13b8)],_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0xa28)]=document[_0x16fb4c(0x2ec)](_0x16fb4c(0x12b5))[_0x16fb4c(0x11a4)][_0x16fb4c(0x97e)](),_0x3539e6['settings']['groupAvatar']=document[_0x16fb4c(0x2ec)](_0x16fb4c(0x13ae))['src'],_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0xff3)]=parseInt(document[_0x16fb4c(0x2ec)](_0x16fb4c(0xd2d))['value'])||0xa;else{_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x12ed)]=document['getElementById']('char-background-activity-switch')['checked'];const _0x36ee15=document[_0x16fb4c(0x2ec)]('offline-mode-toggle')['checked'];_0x3539e6[_0x16fb4c(0x362)]['isOfflineMode']=_0x36ee15;if(_0x5d420d===!![]&&_0x36ee15===![]){const _0x5c925a={'role':_0x16fb4c(0x10a7),'content':'[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','timestamp':Date[_0x16fb4c(0x487)](),'isHidden':!![]};_0x3539e6[_0x16fb4c(0x12c3)]['push'](_0x5c925a),console[_0x16fb4c(0x415)](_0x16fb4c(0xace));}_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x431)]=document['getElementById'](_0x16fb4c(0x1042))[_0x16fb4c(0x13b8)],_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0xa11)]=parseInt(document[_0x16fb4c(0x2ec)](_0x16fb4c(0x8e1))[_0x16fb4c(0x11a4)])||0x64,_0x3539e6[_0x16fb4c(0x362)]['offlineMaxLength']=parseInt(document['getElementById'](_0x16fb4c(0x1009))[_0x16fb4c(0x11a4)])||0x12c,_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x1248)]=document[_0x16fb4c(0x2ec)](_0x16fb4c(0x1192))[_0x16fb4c(0x11a4)]||null;const _0x459032=document[_0x16fb4c(0x2ec)](_0x16fb4c(0x13f9))[_0x16fb4c(0x11a4)][_0x16fb4c(0x97e)]();if(!_0x459032)return alert(_0x16fb4c(0x7c0));_0x3539e6[_0x16fb4c(0x66c)]=_0x459032,_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x67c)]=document[_0x16fb4c(0x2ec)](_0x16fb4c(0xd26))[_0x16fb4c(0x11a4)],_0x3539e6[_0x16fb4c(0x362)]['minimaxVoiceId']=document[_0x16fb4c(0x2ec)](_0x16fb4c(0x763))[_0x16fb4c(0x11a4)][_0x16fb4c(0x97e)](),_0x3539e6[_0x16fb4c(0x362)]['enableTts']=document[_0x16fb4c(0x2ec)](_0x16fb4c(0x5bd))[_0x16fb4c(0x13b8)],_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0xe91)]=document[_0x16fb4c(0x2ec)](_0x16fb4c(0xdde))[_0x16fb4c(0xce4)],_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0xa28)]=document['getElementById'](_0x16fb4c(0xef5))[_0x16fb4c(0x11a4)][_0x16fb4c(0x97e)]()||'我',_0x3539e6['settings']['actionCooldownMinutes']=parseInt(document[_0x16fb4c(0x2ec)]('ai-action-cooldown-input')[_0x16fb4c(0x11a4)])||0xa,_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0xd88)]={'vertical':document[_0x16fb4c(0x2ec)](_0x16fb4c(0x1451))['value'],'horizontal':document[_0x16fb4c(0x2ec)](_0x16fb4c(0xc4e))['value'],'offset':parseInt(document[_0x16fb4c(0x2ec)](_0x16fb4c(0xac1))[_0x16fb4c(0x11a4)])||0xa};const _0x1e1365=document[_0x16fb4c(0x2ec)](_0x16fb4c(0x21f))['value'];_0x3539e6['groupId']=_0x1e1365?parseInt(_0x1e1365):null;}await _0x5b9d83['chats'][_0x16fb4c(0x7c3)](_0x3539e6),!_0x3539e6[_0x16fb4c(0x1423)]&&(await _0x24e380(_0x3539e6),await _0x50cbc4(_0x3539e6)),_0x3b419e(_0x3539e6),_0x4171f3(_0x3539e6[_0x16fb4c(0x362)][_0x16fb4c(0x9f1)],_0x16fb4c(0x939),_0x16fb4c(0x103b)),_0x17ec27(_0x16fb4c(0x120a)),_0xc55746(_0x28f30a[_0x16fb4c(0x11b9)]),_0x5db8a3();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xd50))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x551c25=>{const _0x1f8923=_0x2ea2d1;_0x551c25[_0x1f8923(0x1104)]['classList'][_0x1f8923(0xe9a)]('change-frame-btn')&&_0x48c1ce(_0x1f8923(0x73b));}),document[_0x2ea2d1(0x2ec)]('member-settings-modal')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x4038ac=>{const _0x2a803c=_0x2ea2d1;_0x4038ac[_0x2a803c(0x1104)][_0x2a803c(0xff6)][_0x2a803c(0xe9a)](_0x2a803c(0xd0c))&&_0x48c1ce(_0x2a803c(0x19f));});const _0x20ec01=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x508)),_0x3ed490=document['getElementById']('ai-frame-tab'),_0x89e573=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x11f5)),_0x5982d1=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x553)),_0x57340e=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x13fe));document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x635))['addEventListener']('click',_0x3c1ab7),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x4c8))[_0x2ea2d1(0xf79)]('click',()=>{const _0xe05daf=_0x2ea2d1;_0x20ec01[_0xe05daf(0xff6)][_0xe05daf(0x1424)]('visible'),_0x54ff18=![];}),_0x3ed490[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x5879fb=_0x2ea2d1;_0x3ed490[_0x5879fb(0xff6)][_0x5879fb(0xe82)](_0x5879fb(0xd43)),_0x89e573[_0x5879fb(0xff6)][_0x5879fb(0x1424)](_0x5879fb(0xd43)),_0x5982d1['style']['display']=_0x5879fb(0x13f7),_0x57340e[_0x5879fb(0x589)][_0x5879fb(0x701)]='none';}),_0x89e573[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x397a71=_0x2ea2d1;_0x89e573[_0x397a71(0xff6)][_0x397a71(0xe82)](_0x397a71(0xd43)),_0x3ed490[_0x397a71(0xff6)][_0x397a71(0x1424)](_0x397a71(0xd43)),_0x57340e[_0x397a71(0x589)]['display']=_0x397a71(0x13f7),_0x5982d1[_0x397a71(0x589)][_0x397a71(0x701)]=_0x397a71(0x5b1);}),document['getElementById'](_0x2ea2d1(0x1435))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x4730cb=_0x2ea2d1;if(!_0x28f30a[_0x4730cb(0x11b9)])return;const _0x75dd7d=_0x28f30a[_0x4730cb(0x6ce)][_0x28f30a[_0x4730cb(0x11b9)]],_0x4817db=await _0x4436ba(_0x4730cb(0x96f),_0x4730cb(0x6f3),{'confirmButtonClass':_0x4730cb(0xd8f)});_0x4817db&&(_0x75dd7d[_0x4730cb(0x12c3)]=[],_0x75dd7d['heartfeltVoice']=_0x4730cb(0x4e6),_0x75dd7d[_0x4730cb(0xe97)]=_0x4730cb(0x4e6),await _0x5b9d83[_0x4730cb(0x6ce)][_0x4730cb(0x7c3)](_0x75dd7d),_0xc55746(_0x28f30a[_0x4730cb(0x11b9)]),_0x5db8a3(),_0x5a9526[_0x4730cb(0xff6)][_0x4730cb(0x1424)](_0x4730cb(0x149d)));});const _0x12a9ef=(_0x79c0e7,_0x18624e)=>{const _0x353750=_0x2ea2d1;document[_0x353750(0x2ec)](_0x79c0e7)[_0x353750(0xf79)](_0x353750(0x217),async _0x25fcec=>{const _0x22e543=_0x353750,_0x279dcc=_0x25fcec[_0x22e543(0x1104)][_0x22e543(0x8d6)][0x0];if(_0x279dcc){const _0x2244e9=await new Promise((_0x2bee5b,_0x4e4031)=>{const _0x4572c1=_0x22e543,_0x5440c1=new FileReader();_0x5440c1[_0x4572c1(0xf2d)]=()=>_0x2bee5b(_0x5440c1[_0x4572c1(0x42a)]),_0x5440c1['onerror']=()=>_0x4e4031(_0x5440c1[_0x4572c1(0x1518)]),_0x5440c1[_0x4572c1(0x60e)](_0x279dcc);});_0x18624e(_0x2244e9),_0x25fcec['target'][_0x22e543(0x11a4)]=null;}});};_0x12a9ef(_0x2ea2d1(0xa7b),_0x42211c=>document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xdde))[_0x2ea2d1(0xce4)]=_0x42211c),_0x12a9ef(_0x2ea2d1(0xa19),_0x584f06=>document['getElementById']('my-avatar-preview')[_0x2ea2d1(0xce4)]=_0x584f06),_0x12a9ef('group-avatar-input',_0x34c176=>document['getElementById'](_0x2ea2d1(0x13ae))['src']=_0x34c176),_0x12a9ef(_0x2ea2d1(0x6eb),_0x3187cf=>document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x150c))[_0x2ea2d1(0xce4)]=_0x3187cf),_0x12a9ef(_0x2ea2d1(0x55f),_0x48cd93=>{const _0x5a9390=_0x2ea2d1;if(_0x28f30a[_0x5a9390(0x11b9)]){_0x28f30a[_0x5a9390(0x6ce)][_0x28f30a[_0x5a9390(0x11b9)]]['settings']['background']=_0x48cd93;const _0x33bd5f=document['getElementById'](_0x5a9390(0x100b));_0x33bd5f['src']=_0x48cd93,_0x33bd5f[_0x5a9390(0x589)][_0x5a9390(0x701)]='block',document[_0x5a9390(0x2ec)](_0x5a9390(0x9b8))['style'][_0x5a9390(0x701)]=_0x5a9390(0x51c);}}),_0x12a9ef(_0x2ea2d1(0x10ef),_0x5cde8e=>document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x8a7))[_0x2ea2d1(0xce4)]=_0x5cde8e),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x9b8))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x5f5538=_0x2ea2d1;if(_0x28f30a[_0x5f5538(0x11b9)]){_0x28f30a[_0x5f5538(0x6ce)][_0x28f30a[_0x5f5538(0x11b9)]][_0x5f5538(0x362)][_0x5f5538(0x137c)]='';const _0x46a1df=document[_0x5f5538(0x2ec)](_0x5f5538(0x100b));_0x46a1df['src']='',_0x46a1df[_0x5f5538(0x589)][_0x5f5538(0x701)]=_0x5f5538(0x5b1),document[_0x5f5538(0x2ec)](_0x5f5538(0x9b8))[_0x5f5538(0x589)][_0x5f5538(0x701)]=_0x5f5538(0x5b1);}});const _0x3e8412=document['getElementById']('sticker-panel');document['getElementById'](_0x2ea2d1(0xc4a))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x3d79e5=_0x2ea2d1,_0x3c8046=_0x28f30a[_0x3d79e5(0x6ce)][_0x28f30a['activeChatId']];_0x3c8046&&_0x3c8046[_0x3d79e5(0x362)][_0x3d79e5(0x1574)]?_0x592042=_0x3c8046[_0x3d79e5(0x362)][_0x3d79e5(0x1574)]:_0x592042='all',_0xfb88c2(),_0x3e8412[_0x3d79e5(0xff6)][_0x3d79e5(0xe82)](_0x3d79e5(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x26e))['addEventListener']('click',()=>_0x3e8412['classList'][_0x2ea2d1(0x1424)](_0x2ea2d1(0x149d))),document['getElementById']('add-sticker-batch-btn')['addEventListener'](_0x2ea2d1(0x1177),_0x46f85a),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x93e))['addEventListener']('click',()=>document[_0x2ea2d1(0x2ec)]('sticker-upload-input')[_0x2ea2d1(0x1177)]()),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1477))[_0x2ea2d1(0xf79)]('change',async _0x26efc6=>{const _0x44615f=_0x2ea2d1,_0x49b517=_0x26efc6[_0x44615f(0x1104)]['files'][0x0];if(!_0x49b517)return;const _0x2fcb1b=new FileReader();_0x2fcb1b[_0x44615f(0x60e)](_0x49b517),_0x2fcb1b[_0x44615f(0xf2d)]=async()=>{const _0x3fc7c2=_0x44615f,_0x55f251=_0x2fcb1b[_0x3fc7c2(0x42a)],_0x4adc5b=await _0x33419a(_0x3fc7c2(0xe62),'请为这个表情命名\x20(例如：好耶、疑惑)');if(_0x4adc5b&&_0x4adc5b[_0x3fc7c2(0x97e)]()){const _0x11d1d7={'id':'sticker_'+Date['now'](),'url':_0x55f251,'name':_0x4adc5b[_0x3fc7c2(0x97e)](),'categoryId':_0x592042!=='all'&&_0x592042!==_0x3fc7c2(0x17c)?_0x592042:null};await _0x5b9d83[_0x3fc7c2(0xf28)][_0x3fc7c2(0xe82)](_0x11d1d7),_0x28f30a['userStickers']['push'](_0x11d1d7),_0xfb88c2();}else{if(_0x4adc5b!==null)alert(_0x3fc7c2(0x203));}},_0x26efc6[_0x44615f(0x1104)][_0x44615f(0x11a4)]=null;}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x128f))[_0x2ea2d1(0xf79)]('click',()=>document[_0x2ea2d1(0x2ec)]('image-upload-input')[_0x2ea2d1(0x1177)]()),document['getElementById']('image-upload-input')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),async _0x3e45fe=>{const _0x47b00c=_0x2ea2d1,_0x274153=_0x3e45fe[_0x47b00c(0x1104)][_0x47b00c(0x8d6)][0x0];if(!_0x274153||!_0x28f30a[_0x47b00c(0x11b9)])return;const _0x2a603a=new FileReader();_0x2a603a[_0x47b00c(0xf2d)]=async _0x5a1ec1=>{const _0x3841bc=_0x47b00c,_0x4904ee=_0x5a1ec1['target'][_0x3841bc(0x42a)],_0x3f437b=_0x28f30a[_0x3841bc(0x6ce)][_0x28f30a[_0x3841bc(0x11b9)]],_0x399126={'role':_0x3841bc(0xcc9),'content':[{'type':_0x3841bc(0x1014),'image_url':{'url':_0x4904ee}}],'timestamp':Date[_0x3841bc(0x487)]()};_0x3f437b[_0x3841bc(0x12c3)][_0x3841bc(0x367)](_0x399126),await _0x5b9d83[_0x3841bc(0x6ce)][_0x3841bc(0x7c3)](_0x3f437b),_0x4cc03e(_0x399126,_0x3f437b),_0x5db8a3();},_0x2a603a['readAsDataURL'](_0x274153),_0x3e45fe[_0x47b00c(0x1104)][_0x47b00c(0x11a4)]=null;}),document['getElementById'](_0x2ea2d1(0x293))[_0x2ea2d1(0xf79)]('click',async()=>{const _0x3a886b=_0x2ea2d1;if(!_0x28f30a[_0x3a886b(0x11b9)])return;const _0x1f5428=await _0x33419a(_0x3a886b(0x10b2),'请输入你想说的内容：');if(_0x1f5428&&_0x1f5428[_0x3a886b(0x97e)]()){const _0x1f07b9=_0x28f30a[_0x3a886b(0x6ce)][_0x28f30a[_0x3a886b(0x11b9)]],_0x388b59={'role':_0x3a886b(0xcc9),'type':'voice_message','content':_0x1f5428[_0x3a886b(0x97e)](),'timestamp':Date['now']()};_0x1f07b9[_0x3a886b(0x12c3)][_0x3a886b(0x367)](_0x388b59),await _0x5b9d83[_0x3a886b(0x6ce)][_0x3a886b(0x7c3)](_0x1f07b9),_0x4cc03e(_0x388b59,_0x1f07b9),_0x5db8a3();}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x29c))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x197916=_0x2ea2d1;if(!_0x28f30a[_0x197916(0x11b9)])return;const _0x310e02=await _0x33419a('发送照片',_0x197916(0x895));if(_0x310e02&&_0x310e02['trim']()){const _0x27131c=_0x28f30a[_0x197916(0x6ce)][_0x28f30a['activeChatId']],_0x4fe874={'role':_0x197916(0xcc9),'type':_0x197916(0x7f7),'content':_0x310e02[_0x197916(0x97e)](),'timestamp':Date['now']()};_0x27131c[_0x197916(0x12c3)][_0x197916(0x367)](_0x4fe874),await _0x5b9d83['chats'][_0x197916(0x7c3)](_0x27131c),_0x4cc03e(_0x4fe874,_0x27131c),_0x5db8a3();}});const _0x3eef69=document['getElementById'](_0x2ea2d1(0xb69));document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1148))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x341b54=_0x2ea2d1;_0x3eef69[_0x341b54(0xff6)][_0x341b54(0xe82)](_0x341b54(0x149d));}),_0x3eef69['addEventListener']('click',_0x2cdfc9=>{const _0x390c94=_0x2ea2d1;_0x2cdfc9[_0x390c94(0x1104)]===_0x3eef69&&_0x3eef69[_0x390c94(0xff6)][_0x390c94(0x1424)]('visible');}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xbe1))['addEventListener'](_0x2ea2d1(0x1177),_0x32aa6b),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x5ca))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x555ec2=_0x2ea2d1;if(!_0x28f30a['activeChatId'])return;const _0x48dc18=document[_0x555ec2(0x2ec)](_0x555ec2(0x11e2)),_0x5d24db=document['getElementById']('waimai-amount'),_0x36c9a4=_0x48dc18[_0x555ec2(0x11a4)][_0x555ec2(0x97e)](),_0x1795ff=parseFloat(_0x5d24db[_0x555ec2(0x11a4)]);if(!_0x36c9a4||isNaN(_0x1795ff)||_0x1795ff<=0x0){alert(_0x555ec2(0x1523));return;}const _0x51e228=_0x28f30a['chats'][_0x28f30a[_0x555ec2(0x11b9)]],_0x57a125=Date[_0x555ec2(0x487)](),_0x2074fd=_0x51e228[_0x555ec2(0x1423)]?_0x51e228[_0x555ec2(0x362)][_0x555ec2(0xa28)]||'我':'我',_0x2e6914={'role':_0x555ec2(0xcc9),'senderName':_0x2074fd,'type':'waimai_request','productInfo':_0x36c9a4,'amount':_0x1795ff,'status':_0x555ec2(0x8c9),'countdownEndTime':_0x57a125+0xf*0x3c*0x3e8,'timestamp':_0x57a125};_0x51e228[_0x555ec2(0x12c3)][_0x555ec2(0x367)](_0x2e6914),await _0x5b9d83[_0x555ec2(0x6ce)][_0x555ec2(0x7c3)](_0x51e228),_0x4cc03e(_0x2e6914,_0x51e228),_0x5db8a3(),_0x48dc18['value']='',_0x5d24db[_0x555ec2(0x11a4)]='',_0x3eef69[_0x555ec2(0xff6)][_0x555ec2(0x1424)](_0x555ec2(0x149d));}),document[_0x2ea2d1(0x2ec)]('open-persona-library-btn')['addEventListener'](_0x2ea2d1(0x1177),_0x3d4df1),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x672))[_0x2ea2d1(0xf79)]('click',_0x53e6e8),document['getElementById']('add-persona-preset-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x31d842),document['getElementById']('cancel-persona-editor-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x34370c),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1236))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x214887),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1e5))['addEventListener'](_0x2ea2d1(0x1177),_0xca66b5),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x795))['addEventListener'](_0x2ea2d1(0x1177),_0x57857f),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x756))['addEventListener'](_0x2ea2d1(0x1177),_0x4c110a),document['getElementById'](_0x2ea2d1(0x100d))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x13d807),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x12cd))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x2c3067=_0x2ea2d1;if(_0x2c905a['size']===0x0)return;const _0x11d101=await _0x4436ba(_0x2c3067(0xde9),_0x2c3067(0x417)+_0x2c905a[_0x2c3067(0x2d2)]+_0x2c3067(0xac9),{'confirmButtonClass':_0x2c3067(0xd8f)});if(_0x11d101){const _0x491b7b=_0x28f30a[_0x2c3067(0x6ce)][_0x28f30a[_0x2c3067(0x11b9)]];let _0x4dfd4c=[];for(const _0x5e84b3 of _0x2c905a){const _0x5c4b94=_0x491b7b[_0x2c3067(0x12c3)]['find'](_0x14bce6=>_0x14bce6[_0x2c3067(0x69a)]===_0x5e84b3);_0x5c4b94&&_0x5c4b94['type']===_0x2c3067(0xc2c)&&_0x4dfd4c[_0x2c3067(0x367)](_0x2c3067(0x11c5)+_0x5c4b94['question']+'”的投票(时间戳:\x20'+_0x5c4b94[_0x2c3067(0x69a)]+')');}_0x491b7b[_0x2c3067(0x12c3)]=_0x491b7b[_0x2c3067(0x12c3)][_0x2c3067(0xebc)](_0x55542c=>!_0x2c905a['has'](_0x55542c[_0x2c3067(0x69a)]));let _0x3cdc1b=_0x2c3067(0xf53);_0x4dfd4c[_0x2c3067(0x9a1)]>0x0&&(_0x3cdc1b+=_0x2c3067(0x1082)+_0x4dfd4c['join']('；')+'。');_0x3cdc1b+='\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。';const _0x2a5fce={'role':'system','content':_0x2c3067(0x10e2)+_0x3cdc1b+']','timestamp':Date[_0x2c3067(0x487)](),'isHidden':!![]};_0x491b7b[_0x2c3067(0x12c3)][_0x2c3067(0x367)](_0x2a5fce),await _0x5b9d83['chats']['put'](_0x491b7b),_0xc55746(_0x28f30a['activeChatId']),_0x5db8a3();}}),document[_0x2ea2d1(0x2ec)]('selection-erase-btn')[_0x2ea2d1(0xf79)]('click',async()=>{const _0x25af84=_0x2ea2d1;if(_0x2c905a['size']===0x0)return;const _0x2c0628=await _0x4436ba(_0x25af84(0xb0c),_0x25af84(0xcef)+_0x2c905a[_0x25af84(0x2d2)]+_0x25af84(0x4f0),{'confirmButtonClass':_0x25af84(0xd8f),'confirmText':_0x25af84(0xf09)});if(_0x2c0628){const _0xd123df=_0x28f30a[_0x25af84(0x6ce)][_0x28f30a[_0x25af84(0x11b9)]];_0xd123df[_0x25af84(0x12c3)]=_0xd123df[_0x25af84(0x12c3)][_0x25af84(0xebc)](_0x4e7137=>!_0x2c905a[_0x25af84(0xbf1)](_0x4e7137[_0x25af84(0x69a)])),await _0x5b9d83[_0x25af84(0x6ce)][_0x25af84(0x7c3)](_0xd123df),_0xc55746(_0x28f30a['activeChatId']),_0x5db8a3();}});const _0x60850b=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x472));_0x60850b['addEventListener'](_0x2ea2d1(0x6a9),()=>_0x155408(_0x60850b[_0x2ea2d1(0x11a4)][_0x2ea2d1(0x97e)](),!![])),document[_0x2ea2d1(0x2ec)]('save-font-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x22d7cf=_0x2ea2d1,_0xd252ae=_0x60850b[_0x22d7cf(0x11a4)][_0x22d7cf(0x97e)]();if(!_0xd252ae){alert(_0x22d7cf(0x8d3));return;}_0x155408(_0xd252ae,![]),_0x28f30a['globalSettings']['fontUrl']=_0xd252ae,await _0x5b9d83['globalSettings']['put'](_0x28f30a[_0x22d7cf(0x1062)]),alert(_0x22d7cf(0x60c));}),document[_0x2ea2d1(0x2ec)]('reset-font-btn')[_0x2ea2d1(0xf79)]('click',_0x5c886f),document[_0x2ea2d1(0x5d6)](_0x2ea2d1(0x1aa))[_0x2ea2d1(0xf99)](_0x197860=>{const _0x19e4e5=_0x2ea2d1;_0x197860[_0x19e4e5(0xf79)]('click',()=>_0x52c3ce(_0x197860[_0x19e4e5(0xe93)][_0x19e4e5(0x33b)]));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xd89))['addEventListener'](_0x2ea2d1(0x1177),()=>_0x52c3ce(_0x2ea2d1(0x1e2))),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xbf9))[_0x2ea2d1(0xf79)]('click',async()=>{const _0x13028a=_0x2ea2d1,_0x4b8335=await _0x33419a(_0x13028a(0x500),'请输入新的昵称',_0x28f30a[_0x13028a(0x1506)][_0x13028a(0x19a)]);_0x4b8335&&_0x4b8335[_0x13028a(0x97e)]()&&(_0x28f30a[_0x13028a(0x1506)]['nickname']=_0x4b8335[_0x13028a(0x97e)](),await _0x37a3ff(),_0xc009fa());}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x940))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>document['getElementById'](_0x2ea2d1(0x265))[_0x2ea2d1(0x1177)]()),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x12c5))['addEventListener'](_0x2ea2d1(0x1177),()=>document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x305))[_0x2ea2d1(0x1177)]()),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x265))['addEventListener'](_0x2ea2d1(0x217),async _0x5d99ba=>{const _0x25d987=_0x2ea2d1,_0x5d346d=_0x5d99ba[_0x25d987(0x1104)][_0x25d987(0x8d6)][0x0];if(_0x5d346d){const _0x59161a=await new Promise(_0x235270=>{const _0x3475f2=_0x25d987,_0x1b40e7=new FileReader();_0x1b40e7[_0x3475f2(0xf2d)]=()=>_0x235270(_0x1b40e7[_0x3475f2(0x42a)]),_0x1b40e7[_0x3475f2(0x60e)](_0x5d346d);});_0x28f30a['qzoneSettings'][_0x25d987(0x516)]=_0x59161a,await _0x37a3ff(),_0xc009fa();}_0x5d99ba['target'][_0x25d987(0x11a4)]=null;}),document['getElementById']('qzone-banner-input')['addEventListener']('change',async _0x3625e1=>{const _0x28448d=_0x2ea2d1,_0x8e0af4=_0x3625e1['target'][_0x28448d(0x8d6)][0x0];if(_0x8e0af4){const _0xb20475=await new Promise(_0x183698=>{const _0x1087dd=_0x28448d,_0xddd1f9=new FileReader();_0xddd1f9['onload']=()=>_0x183698(_0xddd1f9[_0x1087dd(0x42a)]),_0xddd1f9[_0x1087dd(0x60e)](_0x8e0af4);});_0x28f30a[_0x28448d(0x1506)][_0x28448d(0x137d)]=_0xb20475,await _0x37a3ff(),_0xc009fa();}_0x3625e1[_0x28448d(0x1104)][_0x28448d(0x11a4)]=null;}),document['getElementById'](_0x2ea2d1(0xee5))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x21854b=_0x2ea2d1;_0x4f7890();const _0x3471d1=document[_0x21854b(0x2ec)](_0x21854b(0x4fa));_0x3471d1[_0x21854b(0xe93)][_0x21854b(0x8da)]=_0x21854b(0x5e8),_0x3471d1['querySelector'](_0x21854b(0xfef))[_0x21854b(0x589)]['display']='none',_0x3471d1['querySelector']('#image-mode-content')[_0x21854b(0x589)][_0x21854b(0x701)]=_0x21854b(0x5b1),_0x3471d1[_0x21854b(0x765)](_0x21854b(0x1040))[_0x21854b(0x589)][_0x21854b(0x701)]=_0x21854b(0x5b1),_0x3471d1['querySelector'](_0x21854b(0x712))['placeholder']=_0x21854b(0xc15);const _0x55fe69=document[_0x21854b(0x2ec)](_0x21854b(0xed5));_0x55fe69[_0x21854b(0xc43)]='';const _0x32703d=await _0x5b9d83[_0x21854b(0x1479)][_0x21854b(0x14b5)]();_0x32703d[_0x21854b(0x9a1)]>0x0?_0x32703d[_0x21854b(0xf99)](_0x493ceb=>{const _0xe24234=_0x21854b,_0x32b5d3=document[_0xe24234(0x14ae)](_0xe24234(0xa05));_0x32b5d3['style'][_0xe24234(0x701)]=_0xe24234(0x13f7),_0x32b5d3[_0xe24234(0xc43)]='<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22'+_0x493ceb['id']+'\x22>\x20'+_0x493ceb['name'],_0x55fe69[_0xe24234(0x998)](_0x32b5d3);}):_0x55fe69['innerHTML']='<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>',_0x3471d1[_0x21854b(0xff6)][_0x21854b(0xe82)](_0x21854b(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1fc))[_0x2ea2d1(0xf79)]('click',async()=>{const _0x33825b=_0x2ea2d1;_0x4f7890();const _0x8e512c=document[_0x33825b(0x2ec)](_0x33825b(0x4fa));_0x8e512c['dataset'][_0x33825b(0x8da)]=_0x33825b(0x612),_0x8e512c[_0x33825b(0x765)]('.post-mode-switcher')[_0x33825b(0x589)][_0x33825b(0x701)]='flex',_0x8e512c[_0x33825b(0x765)](_0x33825b(0xb9a))[_0x33825b(0xff6)][_0x33825b(0xe82)]('active'),_0x8e512c[_0x33825b(0x765)]('#text-image-mode-content')[_0x33825b(0xff6)][_0x33825b(0x1424)]('active'),_0x8e512c[_0x33825b(0x765)](_0x33825b(0x712))[_0x33825b(0xa0a)]='分享新鲜事...（非必填的公开文字）';const _0x1e06e7=document[_0x33825b(0x2ec)](_0x33825b(0xed5));_0x1e06e7[_0x33825b(0xc43)]='';const _0x2dfb53=await _0x5b9d83[_0x33825b(0x1479)][_0x33825b(0x14b5)]();_0x2dfb53[_0x33825b(0x9a1)]>0x0?_0x2dfb53[_0x33825b(0xf99)](_0x15b484=>{const _0x46ca1f=_0x33825b,_0x21048c=document[_0x46ca1f(0x14ae)](_0x46ca1f(0xa05));_0x21048c[_0x46ca1f(0x589)][_0x46ca1f(0x701)]=_0x46ca1f(0x13f7),_0x21048c[_0x46ca1f(0xc43)]=_0x46ca1f(0x1a9)+_0x15b484['id']+'\x22>\x20'+_0x15b484[_0x46ca1f(0xe36)],_0x1e06e7[_0x46ca1f(0x998)](_0x21048c);}):_0x1e06e7[_0x33825b(0xc43)]=_0x33825b(0x641),_0x8e512c[_0x33825b(0xff6)][_0x33825b(0xe82)]('visible');}),document[_0x2ea2d1(0x2ec)]('open-album-btn')['addEventListener'](_0x2ea2d1(0x1177),async()=>{await _0x1995db(),_0x17ec27('album-screen');}),document['getElementById'](_0x2ea2d1(0x1421))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x42b69e=_0x2ea2d1;_0x17ec27(_0x42b69e(0xf4d)),_0x52c3ce(_0x42b69e(0x11b2));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1098))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x30c6da=_0x2ea2d1;_0x28f30a[_0x30c6da(0x94a)]=null,_0x17ec27('album-screen');}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x2d8))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x10c7))[_0x2ea2d1(0x1177)]()),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x10c7))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),async _0x525fe2=>{const _0x5daedf=_0x2ea2d1;if(!_0x28f30a[_0x5daedf(0x94a)])return;const _0x447663=_0x525fe2['target'][_0x5daedf(0x8d6)];if(!_0x447663['length'])return;const _0x1cfbfb=await _0x5b9d83[_0x5daedf(0x550)][_0x5daedf(0x6b5)](_0x28f30a[_0x5daedf(0x94a)]);for(const _0x3108b5 of _0x447663){const _0x258c3d=await new Promise(_0x11ffed=>{const _0x59d7ae=_0x5daedf,_0x201034=new FileReader();_0x201034[_0x59d7ae(0xf2d)]=()=>_0x11ffed(_0x201034[_0x59d7ae(0x42a)]),_0x201034[_0x59d7ae(0x60e)](_0x3108b5);});await _0x5b9d83[_0x5daedf(0x4e3)]['add']({'albumId':_0x28f30a[_0x5daedf(0x94a)],'url':_0x258c3d,'createdAt':Date['now']()});}const _0x2b994d=await _0x5b9d83[_0x5daedf(0x4e3)][_0x5daedf(0x67e)](_0x5daedf(0xf67))['equals'](_0x28f30a['activeAlbumId'])[_0x5daedf(0xdd4)](),_0xdc215f={'photoCount':_0x2b994d};if(!_0x1cfbfb[_0x5daedf(0x1103)]||_0x1cfbfb['coverUrl'][_0x5daedf(0x138a)](_0x5daedf(0xa0a))){const _0x15d982=await _0x5b9d83[_0x5daedf(0x4e3)]['where'](_0x5daedf(0xf67))['equals'](_0x28f30a[_0x5daedf(0x94a)])['first']();if(_0x15d982)_0xdc215f['coverUrl']=_0x15d982[_0x5daedf(0x6d1)];}await _0x5b9d83['qzoneAlbums'][_0x5daedf(0x130a)](_0x28f30a[_0x5daedf(0x94a)],_0xdc215f),await _0x3aa0a4(),await _0x1995db(),_0x525fe2[_0x5daedf(0x1104)][_0x5daedf(0x11a4)]=null,alert(_0x5daedf(0xc7f));}),document['getElementById'](_0x2ea2d1(0x3ec))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async _0x131552=>{const _0x3a3954=_0x2ea2d1,_0x19f3a2=_0x131552[_0x3a3954(0x1104)][_0x3a3954(0x3f2)](_0x3a3954(0x198)),_0x548737=_0x131552['target'][_0x3a3954(0x3f2)](_0x3a3954(0xf1d));if(_0x19f3a2){_0x131552[_0x3a3954(0x106c)]();const _0x116a66=parseInt(_0x19f3a2[_0x3a3954(0xe93)]['photoId']),_0x5942d7=await _0x4436ba('删除照片',_0x3a3954(0x730),{'confirmButtonClass':_0x3a3954(0xd8f)});if(_0x5942d7){const _0x5bae81=await _0x5b9d83[_0x3a3954(0x4e3)]['get'](_0x116a66);if(!_0x5bae81)return;await _0x5b9d83[_0x3a3954(0x4e3)][_0x3a3954(0x54b)](_0x116a66);const _0x10a2f0=await _0x5b9d83[_0x3a3954(0x550)][_0x3a3954(0x6b5)](_0x28f30a[_0x3a3954(0x94a)]),_0x1ff77c=(_0x10a2f0[_0x3a3954(0x1103)]||0x1)-0x1,_0x544489={'photoCount':_0x1ff77c};if(_0x10a2f0[_0x3a3954(0xb81)]===_0x5bae81['url']){const _0x4e0a1d=await _0x5b9d83['qzonePhotos']['where'](_0x3a3954(0xf67))[_0x3a3954(0x129a)](_0x28f30a[_0x3a3954(0x94a)])['first']();_0x544489[_0x3a3954(0xb81)]=_0x4e0a1d?_0x4e0a1d[_0x3a3954(0x6d1)]:_0x3a3954(0x44d);}await _0x5b9d83[_0x3a3954(0x550)][_0x3a3954(0x130a)](_0x28f30a['activeAlbumId'],_0x544489),await _0x3aa0a4(),await _0x1995db(),alert('照片已删除。');}}else _0x548737&&_0x336c06(_0x548737[_0x3a3954(0xce4)]);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xd5d))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x1dbb4e),document['getElementById'](_0x2ea2d1(0x12eb))[_0x2ea2d1(0xf79)]('click',_0x58787a),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x84a))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x2c7836),document[_0x2ea2d1(0xf79)](_0x2ea2d1(0x5b4),_0x48cf4b=>{const _0x42c1e5=_0x2ea2d1;if(!_0x30c3d1['isOpen'])return;if(_0x48cf4b[_0x42c1e5(0x50e)]===_0x42c1e5(0x1031))_0x58787a();else{if(_0x48cf4b[_0x42c1e5(0x50e)]==='ArrowLeft')_0x2c7836();else _0x48cf4b[_0x42c1e5(0x50e)]==='Escape'&&_0x1dbb4e();}}),document['getElementById'](_0x2ea2d1(0x6bd))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x11ba4b=_0x2ea2d1,_0x149c70=await _0x33419a(_0x11ba4b(0x14c7),_0x11ba4b(0x83e));if(_0x149c70&&_0x149c70[_0x11ba4b(0x97e)]()){const _0x500c51={'name':_0x149c70[_0x11ba4b(0x97e)](),'coverUrl':'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','photoCount':0x0,'createdAt':Date['now']()};await _0x5b9d83[_0x11ba4b(0x550)][_0x11ba4b(0xe82)](_0x500c51),await _0x1995db(),alert('相册\x20\x22'+_0x149c70+'\x22\x20创建成功！');}else _0x149c70!==null&&alert(_0x11ba4b(0xb96));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x8e9))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>document[_0x2ea2d1(0x2ec)]('create-post-modal')['classList'][_0x2ea2d1(0x1424)](_0x2ea2d1(0x149d))),document['getElementById'](_0x2ea2d1(0xad6))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x950))[_0x2ea2d1(0x1177)]()),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x950))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x2e0f9c=>{const _0x3f6144=_0x2ea2d1,_0x5ca9b0=_0x2e0f9c[_0x3f6144(0x1104)][_0x3f6144(0x8d6)][0x0];if(_0x5ca9b0){const _0x2b938e=new FileReader();_0x2b938e[_0x3f6144(0xf2d)]=_0x470676=>{const _0x3b70bf=_0x3f6144;document[_0x3b70bf(0x2ec)](_0x3b70bf(0x104c))[_0x3b70bf(0xce4)]=_0x470676[_0x3b70bf(0x1104)][_0x3b70bf(0x42a)],document[_0x3b70bf(0x2ec)](_0x3b70bf(0xe8a))[_0x3b70bf(0xff6)][_0x3b70bf(0xe82)](_0x3b70bf(0x149d)),document[_0x3b70bf(0x2ec)](_0x3b70bf(0x128d))[_0x3b70bf(0x589)][_0x3b70bf(0x701)]=_0x3b70bf(0x13f7);},_0x2b938e['readAsDataURL'](_0x5ca9b0);}}),document[_0x2ea2d1(0x2ec)]('post-use-url-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x78bcc3=_0x2ea2d1,_0x9d5586=await _0x33419a(_0x78bcc3(0x536),_0x78bcc3(0x1058),'',_0x78bcc3(0x6d1));_0x9d5586&&(document[_0x78bcc3(0x2ec)]('post-image-preview')[_0x78bcc3(0xce4)]=_0x9d5586,document[_0x78bcc3(0x2ec)](_0x78bcc3(0xe8a))[_0x78bcc3(0xff6)][_0x78bcc3(0xe82)](_0x78bcc3(0x149d)),document[_0x78bcc3(0x2ec)](_0x78bcc3(0x128d))[_0x78bcc3(0x589)][_0x78bcc3(0x701)]=_0x78bcc3(0x13f7));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1323))['addEventListener']('click',()=>_0x4f7890());const _0x27b8c8=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x564)),_0x573fb5=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x636)),_0x316d5e=document['getElementById'](_0x2ea2d1(0x14b4)),_0xd495e6=document['getElementById'](_0x2ea2d1(0xeff));_0x27b8c8[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x43bb59=_0x2ea2d1;_0x27b8c8['classList'][_0x43bb59(0xe82)](_0x43bb59(0xd43)),_0x573fb5[_0x43bb59(0xff6)][_0x43bb59(0x1424)](_0x43bb59(0xd43)),_0x316d5e[_0x43bb59(0xff6)][_0x43bb59(0xe82)]('active'),_0xd495e6['classList'][_0x43bb59(0x1424)](_0x43bb59(0xd43));}),_0x573fb5[_0x2ea2d1(0xf79)]('click',()=>{const _0x4c8dc3=_0x2ea2d1;_0x573fb5['classList']['add'](_0x4c8dc3(0xd43)),_0x27b8c8[_0x4c8dc3(0xff6)]['remove']('active'),_0xd495e6[_0x4c8dc3(0xff6)][_0x4c8dc3(0xe82)]('active'),_0x316d5e[_0x4c8dc3(0xff6)]['remove'](_0x4c8dc3(0xd43));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x155f))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x5b7e56=_0x2ea2d1,_0x38ccd8=document[_0x5b7e56(0x2ec)](_0x5b7e56(0x4fa)),_0x41f3a7=_0x38ccd8[_0x5b7e56(0xe93)]['mode'],_0x183850=document['querySelector'](_0x5b7e56(0x107f))[_0x5b7e56(0x11a4)];let _0x17f13b=null;_0x183850===_0x5b7e56(0x1388)&&(_0x17f13b=Array[_0x5b7e56(0x13d1)](document['querySelectorAll'](_0x5b7e56(0x185)))['map'](_0x5b1667=>parseInt(_0x5b1667['value'])));let _0x22c43e={};const _0xbee952={'timestamp':Date[_0x5b7e56(0x487)](),'authorId':_0x5b7e56(0xcc9),'visibleGroupIds':_0x17f13b};if(_0x41f3a7===_0x5b7e56(0x5e8)){const _0x47a075=document[_0x5b7e56(0x2ec)]('post-public-text')['value'][_0x5b7e56(0x97e)]();if(!_0x47a075){alert(_0x5b7e56(0x374));return;}_0x22c43e={..._0xbee952,'type':_0x5b7e56(0x5e8),'content':_0x47a075};}else{const _0x271d69=document[_0x5b7e56(0x2ec)](_0x5b7e56(0x56d))[_0x5b7e56(0x11a4)][_0x5b7e56(0x97e)](),_0x1af28d=document[_0x5b7e56(0x2ec)]('image-mode-content')[_0x5b7e56(0xff6)]['contains']('active');if(_0x1af28d){const _0xa2728a=document[_0x5b7e56(0x2ec)]('post-image-preview')['src'],_0x158e04=document[_0x5b7e56(0x2ec)](_0x5b7e56(0x1513))[_0x5b7e56(0x11a4)][_0x5b7e56(0x97e)]();if(!_0xa2728a||!(_0xa2728a[_0x5b7e56(0x741)]('http')||_0xa2728a[_0x5b7e56(0x741)](_0x5b7e56(0x54c)))){alert(_0x5b7e56(0x556));return;}if(!_0x158e04){alert(_0x5b7e56(0x210));return;}_0x22c43e={..._0xbee952,'type':_0x5b7e56(0x126c),'publicText':_0x271d69,'imageUrl':_0xa2728a,'imageDescription':_0x158e04};}else{const _0x9ecdc6=document[_0x5b7e56(0x2ec)]('post-hidden-text')[_0x5b7e56(0x11a4)][_0x5b7e56(0x97e)]();if(!_0x9ecdc6){alert(_0x5b7e56(0xa74));return;}_0x22c43e={..._0xbee952,'type':'text_image','publicText':_0x271d69,'hiddenContent':_0x9ecdc6};}}const _0x1076da=await _0x5b9d83[_0x5b7e56(0xc7a)][_0x5b7e56(0xe82)](_0x22c43e);let _0x47a080=_0x22c43e['content']||_0x22c43e[_0x5b7e56(0x1202)]||_0x22c43e[_0x5b7e56(0x7ca)]||_0x22c43e[_0x5b7e56(0xf05)]||_0x5b7e56(0x1322);_0x47a080=_0x47a080[_0x5b7e56(0xa6b)](0x0,0x32)+(_0x47a080['length']>0x32?_0x5b7e56(0x4e6):'');for(const _0x51ecb0 in _0x28f30a['chats']){const _0x4027d9=_0x28f30a[_0x5b7e56(0x6ce)][_0x51ecb0];if(_0x4027d9[_0x5b7e56(0x1423)])continue;let _0x5a1e75=![];const _0x4c2938=_0x22c43e[_0x5b7e56(0x884)];if(!_0x4c2938||_0x4c2938[_0x5b7e56(0x9a1)]===0x0)_0x5a1e75=!![];else _0x4027d9['groupId']&&_0x4c2938['includes'](_0x4027d9['groupId'])&&(_0x5a1e75=!![]);if(_0x5a1e75){const _0x5930dd={'role':'system','content':'[系统提示：用户刚刚发布了一条动态(ID:\x20'+_0x1076da+_0x5b7e56(0xc12)+_0x47a080+_0x5b7e56(0x65b),'timestamp':Date[_0x5b7e56(0x487)](),'isHidden':!![]};_0x4027d9[_0x5b7e56(0x12c3)]['push'](_0x5930dd),await _0x5b9d83[_0x5b7e56(0x6ce)][_0x5b7e56(0x7c3)](_0x4027d9);}}await _0x472608(),_0x38ccd8[_0x5b7e56(0xff6)][_0x5b7e56(0x1424)]('visible'),alert(_0x5b7e56(0x1fe));});const _0x11aa8b=document[_0x2ea2d1(0x2ec)]('qzone-posts-list');let _0x70ee45={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0x6036ec(_0x5b1b0c=null){const _0xafc2ef=_0x2ea2d1;document['querySelectorAll'](_0xafc2ef(0xb11))['forEach'](_0x136fc3=>{const _0x1ff103=_0xafc2ef;_0x136fc3!==_0x5b1b0c&&_0x136fc3[_0x1ff103(0x765)]('.qzone-post-item')[_0x1ff103(0xff6)]['remove'](_0x1ff103(0x144d));});}async function _0x3045a5(_0x3c93b1){const _0x1acf33=_0x2ea2d1;_0x3c93b1[_0x1acf33(0x106c)]();const _0x139c07=_0x3c93b1[_0x1acf33(0x1104)],_0x570a84=_0x139c07[_0x1acf33(0x3f2)]('.comment-delete-btn');if(_0x570a84){const _0x52d39b=_0x570a84[_0x1acf33(0x3f2)]('.qzone-post-container'),_0x5b8180=parseInt(_0x52d39b['dataset'][_0x1acf33(0xa53)]),_0x5d0119=parseInt(_0x570a84[_0x1acf33(0xe93)][_0x1acf33(0x1253)]);if(isNaN(_0x5b8180)||isNaN(_0x5d0119))return;const _0x457e5b=_0x4e343b[_0x1acf33(0x412)](_0x3dc55f=>_0x3dc55f['id']===_0x5b8180);if(!_0x457e5b||!_0x457e5b['comments']||!_0x457e5b[_0x1acf33(0x8a4)][_0x5d0119])return;const _0x3afe91=_0x457e5b[_0x1acf33(0x8a4)][_0x5d0119],_0x4b74d2=await _0x4436ba(_0x1acf33(0x110a),_0x1acf33(0x668),{'confirmButtonClass':_0x1acf33(0xd8f)});if(_0x4b74d2){_0x457e5b[_0x1acf33(0x8a4)]['splice'](_0x5d0119,0x1),await _0x5b9d83[_0x1acf33(0xc7a)][_0x1acf33(0x130a)](_0x5b8180,{'comments':_0x457e5b[_0x1acf33(0x8a4)]});if(_0x3afe91&&_0x3afe91[_0x1acf33(0x498)]===_0x28f30a[_0x1acf33(0x1506)][_0x1acf33(0x19a)]){console[_0x1acf33(0x415)](_0x1acf33(0xea2));const _0x2ad5e6=new Set();_0x457e5b['authorId']!==_0x1acf33(0xcc9)&&_0x2ad5e6['add'](_0x457e5b[_0x1acf33(0xe87)]);if(_0x3afe91[_0x1acf33(0x2f2)]){const _0x237f1f=Object[_0x1acf33(0x74e)](_0x28f30a[_0x1acf33(0x6ce)])[_0x1acf33(0x412)](_0x46c8f9=>_0x46c8f9[_0x1acf33(0x66c)]===_0x3afe91[_0x1acf33(0x2f2)]);_0x237f1f&&_0x2ad5e6['add'](_0x237f1f['id']);}const _0x45c080=(_0x457e5b['publicText']||_0x457e5b[_0x1acf33(0x1047)]||'')['substring'](0x0,0x1e),_0x4f0581=_0x28f30a[_0x1acf33(0x1506)]['nickname'];let _0x1175c2;const _0x59c5f4=_0x28f30a[_0x1acf33(0xf28)][_0x1acf33(0x412)](_0x594fa5=>_0x594fa5[_0x1acf33(0x6d1)]===_0x3afe91[_0x1acf33(0x10ca)]);if(_0x59c5f4)_0x1175c2=_0x1acf33(0x4c4)+_0x4f0581+'\x27刚刚在你的动态“'+_0x45c080+_0x1acf33(0xb63)+_0x59c5f4['name']+'”。';else{if(_0x3afe91[_0x1acf33(0x2f2)]){const _0x23bee0=_0x2fa4e1(_0x3afe91['replyTo']);_0x1175c2=_0x1acf33(0x4c4)+_0x4f0581+_0x1acf33(0x24c)+_0x45c080+_0x1acf33(0x6bb)+_0x23bee0+'\x27的评论，内容是：“'+_0x3afe91[_0x1acf33(0x10ca)]+'”。';}else _0x1175c2='用户\x27'+_0x4f0581+'\x27刚刚评论了你的动态“'+_0x45c080+_0x1acf33(0x2b5)+_0x3afe91['text']+'”。';}const _0xe6ab8b=_0x1acf33(0x10e2)+_0x1175c2+'请你对此作出回应。]';for(const _0x134542 of _0x2ad5e6){const _0x3d8137=_0x28f30a[_0x1acf33(0x6ce)][_0x134542];if(_0x3d8137){const _0x58e555=_0x3d8137[_0x1acf33(0x12c3)][_0x1acf33(0x9a1)];_0x3d8137[_0x1acf33(0x12c3)]=_0x3d8137[_0x1acf33(0x12c3)][_0x1acf33(0xebc)](_0x1e5677=>!(_0x1e5677[_0x1acf33(0x1162)]&&_0x1e5677['role']===_0x1acf33(0x10a7)&&_0x1e5677['content']===_0xe6ab8b)),_0x3d8137[_0x1acf33(0x12c3)][_0x1acf33(0x9a1)]<_0x58e555&&(console['log'](_0x1acf33(0x1300)+_0x3d8137[_0x1acf33(0xe36)]+_0x1acf33(0xdc9)),await _0x5b9d83[_0x1acf33(0x6ce)]['put'](_0x3d8137));}}}await _0x23b949(_0x5b8180);}return;}const _0x1c1a2e=_0x139c07[_0x1acf33(0x3f2)](_0x1acf33(0x2ae));if(_0x1c1a2e){const _0x461136=_0x1c1a2e[_0x1acf33(0x3f2)](_0x1acf33(0xb11));if(!_0x461136)return;const _0x29069f=parseInt(_0x461136['dataset'][_0x1acf33(0xa53)]);_0x3006bc['isOpen']&&_0x3006bc['activePostId']===_0x29069f?_0x4feed8():_0x81499(_0x29069f,_0x1c1a2e);return;}const _0x546565=_0x139c07[_0x1acf33(0x3f2)](_0x1acf33(0x435));if(_0x546565){const _0x5b914d=parseInt(_0x546565[_0x1acf33(0xe93)][_0x1acf33(0xa53)]),_0x25475d=_0x546565['dataset'][_0x1acf33(0x97d)],_0x4f0812=_0x546565[_0x1acf33(0xe93)][_0x1acf33(0xdb8)];if(!_0x25475d||!_0x4f0812||_0x25475d===_0x28f30a['qzoneSettings'][_0x1acf33(0x19a)]){_0x32374a(_0x546565['closest'](_0x1acf33(0xb11)));return;}_0xbdfe41={'postId':_0x5b914d,'replyToName':_0x25475d,'replyToDisplayName':_0x4f0812};const _0x1157ef=_0x546565[_0x1acf33(0x3f2)]('.qzone-post-container'),_0x3a5287=_0x1157ef[_0x1acf33(0x765)](_0x1acf33(0x46e));_0x3a5287[_0x1acf33(0xa0a)]=_0x1acf33(0x48b)+_0x4f0812+':',_0x3a5287[_0x1acf33(0x52b)]();return;}if(_0x139c07['classList'][_0x1acf33(0xe9a)](_0x1acf33(0x114b))){const _0x36a3fc=_0x139c07[_0x1acf33(0x3f2)](_0x1acf33(0xb11));if(_0x36a3fc&&_0x36a3fc[_0x1acf33(0xe93)][_0x1acf33(0xa53)])_0x3652c0(parseInt(_0x36a3fc['dataset'][_0x1acf33(0xa53)]));return;}if(_0x139c07[_0x1acf33(0xdf4)]===_0x1acf33(0x23e)&&_0x139c07[_0x1acf33(0xe93)][_0x1acf33(0xf3b)]){_0x34d596(_0x1acf33(0xde0),_0x139c07[_0x1acf33(0xe93)][_0x1acf33(0xf3b)]['replace'](/<br>/g,'\x0a'));return;}const _0x2e28ff=_0x139c07[_0x1acf33(0x3f2)](_0x1acf33(0xb11));if(!_0x2e28ff)return;const _0x8de6b0=parseInt(_0x2e28ff[_0x1acf33(0xe93)][_0x1acf33(0xa53)]);if(isNaN(_0x8de6b0))return;if(_0x139c07['closest'](_0x1acf33(0x982))){const _0xabefcf=await _0x4436ba('删除动态','确定要永久删除这条动态吗？',{'confirmButtonClass':_0x1acf33(0xd8f)});_0xabefcf&&(_0x2e28ff[_0x1acf33(0x589)][_0x1acf33(0x89c)]=_0x1acf33(0x56a),_0x2e28ff[_0x1acf33(0x589)][_0x1acf33(0x1244)]=_0x1acf33(0x2e4),_0x2e28ff[_0x1acf33(0x589)][_0x1acf33(0xb92)]='0',setTimeout(async()=>{const _0x5b9423=_0x1acf33;await _0x5b9d83[_0x5b9423(0xc7a)][_0x5b9423(0x54b)](_0x8de6b0);const _0x53aef2=_0x5b9423(0x67f)+_0x8de6b0+')';for(const _0x5083e4 in _0x28f30a[_0x5b9423(0x6ce)]){const _0x21dc96=_0x28f30a[_0x5b9423(0x6ce)][_0x5083e4],_0x16bf0f=_0x21dc96[_0x5b9423(0x12c3)][_0x5b9423(0x9a1)];_0x21dc96[_0x5b9423(0x12c3)]=_0x21dc96[_0x5b9423(0x12c3)][_0x5b9423(0xebc)](_0x1c0107=>!(_0x1c0107['role']===_0x5b9423(0x10a7)&&_0x1c0107['content'][_0x5b9423(0x138a)](_0x53aef2)));if(_0x21dc96[_0x5b9423(0x12c3)]['length']<_0x16bf0f)await _0x5b9d83['chats'][_0x5b9423(0x7c3)](_0x21dc96);}await _0x472608(),alert(_0x5b9423(0x601));},0x12c));return;}const _0x105138=_0x139c07['closest']('.action-icon');if(_0x105138){if(_0x105138[_0x1acf33(0xff6)]['contains'](_0x1acf33(0x11d5))){_0x5355eb(_0x8de6b0);return;}if(_0x105138[_0x1acf33(0xff6)]['contains'](_0x1acf33(0x41e))){const _0x2cade6=_0x4e343b[_0x1acf33(0x412)](_0x2b90b7=>_0x2b90b7['id']===_0x8de6b0);if(!_0x2cade6)return;if(!_0x2cade6[_0x1acf33(0x12b3)])_0x2cade6[_0x1acf33(0x12b3)]=[];const _0x3877e9=_0x28f30a[_0x1acf33(0x1506)]['nickname'],_0x24e570=_0x2cade6['likes'][_0x1acf33(0x6d3)](_0x3877e9);_0x24e570>-0x1?_0x2cade6[_0x1acf33(0x12b3)][_0x1acf33(0x510)](_0x24e570,0x1):(_0x2cade6[_0x1acf33(0x12b3)][_0x1acf33(0x367)](_0x3877e9),_0x105138[_0x1acf33(0xff6)][_0x1acf33(0xe82)](_0x1acf33(0xcd1)),_0x105138[_0x1acf33(0xf79)]('animationend',()=>_0x105138[_0x1acf33(0xff6)][_0x1acf33(0x1424)]('animate-like'),{'once':!![]})),await _0x5b9d83[_0x1acf33(0xc7a)][_0x1acf33(0x130a)](_0x8de6b0,{'likes':_0x2cade6[_0x1acf33(0x12b3)]}),await _0x23b949(_0x8de6b0);}if(_0x105138['classList'][_0x1acf33(0xe9a)](_0x1acf33(0xfee))){const _0x19c588=await _0x5b9d83[_0x1acf33(0x101f)][_0x1acf33(0x67e)]({'type':_0x1acf33(0x9eb),'content.id':_0x8de6b0})['first']();if(_0x19c588)await _0x5b9d83[_0x1acf33(0x101f)]['delete'](_0x19c588['id']),await _0x34d596('提示','已取消收藏');else{const _0x4a5243=await _0x5b9d83[_0x1acf33(0xc7a)]['get'](_0x8de6b0);_0x4a5243&&(await _0x5b9d83[_0x1acf33(0x101f)][_0x1acf33(0xe82)]({'type':_0x1acf33(0x9eb),'content':_0x4a5243,'timestamp':Date['now']()}),await _0x34d596('提示',_0x1acf33(0x1545)));}await _0x23b949(_0x8de6b0);}return;}const _0xe4023a=_0x139c07[_0x1acf33(0x3f2)]('.comment-send-btn');if(_0xe4023a){const _0x44983a=_0x2e28ff[_0x1acf33(0x765)](_0x1acf33(0x46e)),_0x282545=_0x44983a[_0x1acf33(0x11a4)][_0x1acf33(0x97e)]();if(!_0x282545)return alert(_0x1acf33(0x94e));const _0x2afa66=_0x4e343b[_0x1acf33(0x412)](_0x5e567f=>_0x5e567f['id']===_0x8de6b0);if(!_0x2afa66)return;if(!_0x2afa66[_0x1acf33(0x8a4)])_0x2afa66[_0x1acf33(0x8a4)]=[];const _0x1090e5={'commenterName':_0x28f30a[_0x1acf33(0x1506)][_0x1acf33(0x19a)],'text':_0x282545,'timestamp':Date[_0x1acf33(0x487)](),'replyTo':_0xbdfe41&&_0xbdfe41['postId']===_0x8de6b0?_0xbdfe41[_0x1acf33(0x32a)]:null};_0x2afa66[_0x1acf33(0x8a4)][_0x1acf33(0x367)](_0x1090e5),await _0x5b9d83[_0x1acf33(0xc7a)][_0x1acf33(0x130a)](_0x8de6b0,{'comments':_0x2afa66[_0x1acf33(0x8a4)]});let _0x59d871=(_0x2afa66[_0x1acf33(0x1202)]||_0x2afa66[_0x1acf33(0x1047)]||'')[_0x1acf33(0xa6b)](0x0,0x1e);const _0x2248c1=_0x28f30a[_0x1acf33(0x1506)]['nickname'],_0x52d907=new Set();if(_0x2afa66[_0x1acf33(0xe87)]!==_0x1acf33(0xcc9))_0x52d907[_0x1acf33(0xe82)](_0x2afa66[_0x1acf33(0xe87)]);if(_0x1090e5[_0x1acf33(0x2f2)]&&_0x1090e5['replyTo']!==_0x2248c1){const _0x3ff187=Object['values'](_0x28f30a[_0x1acf33(0x6ce)])[_0x1acf33(0x412)](_0xd57d5a=>_0xd57d5a['originalName']===_0x1090e5['replyTo']);if(_0x3ff187)_0x52d907[_0x1acf33(0xe82)](_0x3ff187['id']);}for(const _0xad3259 of _0x52d907){const _0x1fdb2f=_0x28f30a[_0x1acf33(0x6ce)][_0xad3259];if(_0x1fdb2f&&!_0x1fdb2f[_0x1acf33(0x1423)]){const _0x20f344=_0x28f30a['userStickers']['find'](_0x41894b=>_0x41894b[_0x1acf33(0x6d1)]===_0x282545);let _0xcc0bfa=_0x20f344?_0x1acf33(0x4c4)+_0x2248c1+_0x1acf33(0x24c)+_0x59d871+_0x1acf33(0xb63)+_0x20f344[_0x1acf33(0xe36)]+'”。':_0x1090e5['replyTo']?_0x1acf33(0x4c4)+_0x2248c1+_0x1acf33(0x24c)+_0x59d871+_0x1acf33(0x6bb)+_0xbdfe41[_0x1acf33(0xf59)]+'\x27的评论，内容是：“'+_0x282545+'”。':_0x1acf33(0x4c4)+_0x2248c1+_0x1acf33(0xd4b)+_0x59d871+_0x1acf33(0x2b5)+_0x282545+'”。';const _0x4f9d5a={'role':'system','content':_0x1acf33(0x10e2)+_0xcc0bfa+_0x1acf33(0x71b),'timestamp':Date[_0x1acf33(0x487)](),'isHidden':!![]};_0x1fdb2f['history'][_0x1acf33(0x367)](_0x4f9d5a),await _0x5b9d83[_0x1acf33(0x6ce)][_0x1acf33(0x7c3)](_0x1fdb2f);}}_0x44983a[_0x1acf33(0x11a4)]='',_0x32374a(_0x2e28ff),await _0x23b949(_0x8de6b0);return;}}const _0x49c9de=_0x3253ad=>{const _0x262841=_0x2ea2d1,_0x10769c=_0x3253ad['target'];if(_0x10769c[_0x262841(0x3f2)](_0x262841(0xb65)))return;const _0x819b68=_0x3253ad['target']['closest']('.qzone-post-container');if(!_0x819b68)return;_0x6036ec(_0x819b68),_0x70ee45['activeContainer']=_0x819b68,_0x70ee45[_0x262841(0xba3)]=!![],_0x70ee45['isClick']=!![],_0x70ee45['swipeDirection']=null,_0x70ee45[_0x262841(0x157c)]=_0x3253ad['type']['includes']('mouse')?_0x3253ad[_0x262841(0xe27)]:_0x3253ad[_0x262841(0x5b2)][0x0][_0x262841(0xe27)],_0x70ee45[_0x262841(0x10fb)]=_0x3253ad[_0x262841(0xb4b)][_0x262841(0x138a)](_0x262841(0x69b))?_0x3253ad[_0x262841(0x4e5)]:_0x3253ad[_0x262841(0x5b2)][0x0]['pageY'],_0x70ee45['activeContainer'][_0x262841(0x765)](_0x262841(0x77b))[_0x262841(0x589)][_0x262841(0x89c)]='none',document[_0x262841(0xf79)]('mousemove',_0x1d64ab),document[_0x262841(0xf79)](_0x262841(0x106b),_0x3c043c),document[_0x262841(0xf79)]('touchmove',_0x1d64ab,{'passive':![]}),document[_0x262841(0xf79)]('touchend',_0x3c043c);},_0x1d64ab=_0x55f503=>{const _0x3cf783=_0x2ea2d1;if(!_0x70ee45[_0x3cf783(0xba3)]||!_0x70ee45[_0x3cf783(0x97f)])return;const _0x48df0a=_0x55f503[_0x3cf783(0xb4b)][_0x3cf783(0x138a)](_0x3cf783(0x69b))?_0x55f503[_0x3cf783(0xe27)]:_0x55f503['touches'][0x0][_0x3cf783(0xe27)],_0x21b7a1=_0x55f503['type']['includes'](_0x3cf783(0x69b))?_0x55f503[_0x3cf783(0x4e5)]:_0x55f503[_0x3cf783(0x5b2)][0x0]['pageY'],_0x210d87=_0x48df0a-_0x70ee45['startX'],_0x51004c=_0x21b7a1-_0x70ee45[_0x3cf783(0x10fb)];_0x70ee45[_0x3cf783(0x1578)]&&(Math[_0x3cf783(0x264)](_0x210d87)>0x5||Math[_0x3cf783(0x264)](_0x51004c)>0x5)&&(_0x70ee45[_0x3cf783(0x1578)]=![]);!_0x70ee45[_0x3cf783(0x12f6)]&&(Math['abs'](_0x210d87)>Math[_0x3cf783(0x264)](_0x51004c)?_0x70ee45[_0x3cf783(0x12f6)]=_0x3cf783(0x121c):_0x70ee45[_0x3cf783(0x12f6)]=_0x3cf783(0x3c4));if(_0x70ee45[_0x3cf783(0x12f6)]===_0x3cf783(0x121c)){_0x55f503['preventDefault'](),_0x70ee45[_0x3cf783(0x5d0)]=_0x48df0a;let _0x1bee43=Math[_0x3cf783(0x675)](0x0,Math[_0x3cf783(0x7ac)](-0x5a,_0x210d87));_0x70ee45[_0x3cf783(0x97f)]['querySelector'](_0x3cf783(0x77b))[_0x3cf783(0x589)]['transform']=_0x3cf783(0xd74)+_0x1bee43+_0x3cf783(0xc5e);}},_0x3c043c=_0x5c38be=>{const _0x31fda4=_0x2ea2d1;document['removeEventListener'](_0x31fda4(0x6fa),_0x1d64ab),document[_0x31fda4(0x1f0)](_0x31fda4(0x106b),_0x3c043c),document[_0x31fda4(0x1f0)]('touchmove',_0x1d64ab),document[_0x31fda4(0x1f0)](_0x31fda4(0xe2a),_0x3c043c);if(!_0x70ee45[_0x31fda4(0xba3)]||!_0x70ee45[_0x31fda4(0x97f)])return;const _0x3eeaab=_0x70ee45[_0x31fda4(0x97f)]['querySelector']('.qzone-post-item');_0x3eeaab['style'][_0x31fda4(0x89c)]='transform\x200.3s\x20ease';if(_0x70ee45[_0x31fda4(0x12f6)]===_0x31fda4(0x121c)&&!_0x70ee45[_0x31fda4(0x1578)]){const _0x343818=_0x5c38be[_0x31fda4(0xb4b)][_0x31fda4(0x138a)](_0x31fda4(0xe2a))?_0x5c38be['changedTouches'][0x0][_0x31fda4(0xe27)]:_0x5c38be[_0x31fda4(0xe27)],_0x1edd17=_0x343818-_0x70ee45[_0x31fda4(0x157c)];_0x1edd17<-0x28?_0x3eeaab[_0x31fda4(0xff6)]['add'](_0x31fda4(0x144d)):_0x3eeaab[_0x31fda4(0xff6)][_0x31fda4(0x1424)]('swiped');}_0x3eeaab[_0x31fda4(0x589)][_0x31fda4(0x1244)]='',_0x70ee45['isDragging']=![],_0x70ee45[_0x31fda4(0x97f)]=null,_0x70ee45[_0x31fda4(0x12f6)]=null,_0x70ee45['isClick']=!![];};_0x11aa8b[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x3045a5),_0x11aa8b[_0x2ea2d1(0xf79)]('mousedown',_0x49c9de),_0x11aa8b[_0x2ea2d1(0xf79)](_0x2ea2d1(0x9a8),_0x49c9de,{'passive':!![]}),_0x11aa8b[_0x2ea2d1(0xf79)]('click',_0x588596=>{const _0x15f5f4=_0x2ea2d1;_0x588596['target']&&_0x588596[_0x15f5f4(0x1104)]['id']===_0x15f5f4(0xf1c)&&_0x3abe5b();}),document[_0x2ea2d1(0x2ec)]('refine-memory-btn-header')[_0x2ea2d1(0xf79)]('click',()=>{const _0x2c0ae2=_0x2ea2d1;_0x28f30a[_0x2c0ae2(0x11b9)]&&_0x1bd93e(_0x28f30a['activeChatId']);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xfa2))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x24ac92),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x12e4))['addEventListener'](_0x2ea2d1(0x1177),_0x4d9285),document[_0x2ea2d1(0x2ec)]('delete-api-preset-btn')['addEventListener'](_0x2ea2d1(0x1177),_0x8c2d0a),document[_0x2ea2d1(0x2ec)]('add-world-book-entry-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x260351=_0x2ea2d1,_0x459d05=document[_0x260351(0x2ec)](_0x260351(0xf68));_0x459d05[_0x260351(0x765)]('p')&&(_0x459d05['innerHTML']='');const _0x3073a0=_0x3c5856();_0x459d05['appendChild'](_0x3073a0),_0x3073a0[_0x260351(0x765)](_0x260351(0x88e))[_0x260351(0x52b)]();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xa46))['addEventListener'](_0x2ea2d1(0x1177),_0x5d6742),document[_0x2ea2d1(0x2ec)]('thoughts-history-list')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x145a75=>{const _0x1d2e4b=_0x2ea2d1;_0x145a75[_0x1d2e4b(0x1104)]&&_0x145a75[_0x1d2e4b(0x1104)]['id']==='load-more-thoughts-btn'&&_0x4e6d47();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x2c6))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x4f27a5),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x834))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x43d89d),document['getElementById'](_0x2ea2d1(0x37d))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x11776c=>{const _0x34baf1=_0x2ea2d1;_0x11776c[_0x34baf1(0x1104)]['id']===_0x34baf1(0x37d)&&_0x11776c[_0x34baf1(0x1104)][_0x34baf1(0xff6)][_0x34baf1(0x1424)]('visible');}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xe13))['addEventListener'](_0x2ea2d1(0x1177),_0x35e02d),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x53c))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x1747e8),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xd89))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>_0x52c3ce(_0x2ea2d1(0x1e2))),document[_0x2ea2d1(0x2ec)]('favorites-back-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>_0x52c3ce('messages-view'));const _0x5a94cc=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x653)),_0x3cf556=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x9bb));_0x5a94cc['addEventListener']('input',()=>{const _0x2cd2c6=_0x2ea2d1,_0x1e4dcb=_0x5a94cc[_0x2cd2c6(0x11a4)][_0x2cd2c6(0x97e)]()[_0x2cd2c6(0x1430)]();_0x3cf556[_0x2cd2c6(0x589)][_0x2cd2c6(0x701)]=_0x1e4dcb?'block':_0x2cd2c6(0x5b1);if(!_0x1e4dcb){_0x2f6186(allFavoriteItems);return;}const _0x30006c=allFavoriteItems[_0x2cd2c6(0xebc)](_0x18536a=>{const _0x514782=_0x2cd2c6;let _0xd95cf='',_0x5b1c64='';if(_0x18536a[_0x514782(0xb4b)]===_0x514782(0x9eb)){const _0x381cfc=_0x18536a[_0x514782(0x1047)];_0xd95cf+=(_0x381cfc['publicText']||'')+'\x20'+(_0x381cfc[_0x514782(0x1047)]||'');if(_0x381cfc[_0x514782(0xe87)]==='user')_0x5b1c64=_0x28f30a[_0x514782(0x1506)][_0x514782(0x19a)];else _0x28f30a[_0x514782(0x6ce)][_0x381cfc[_0x514782(0xe87)]]&&(_0x5b1c64=_0x28f30a[_0x514782(0x6ce)][_0x381cfc[_0x514782(0xe87)]][_0x514782(0xe36)]);}else{if(_0x18536a[_0x514782(0xb4b)]===_0x514782(0xfec)){const _0x227113=_0x18536a[_0x514782(0x1047)];typeof _0x227113[_0x514782(0x1047)]==='string'&&(_0xd95cf=_0x227113[_0x514782(0x1047)]);const _0x34e9e3=_0x28f30a['chats'][_0x18536a[_0x514782(0xdd0)]];_0x34e9e3&&(_0x227113[_0x514782(0x9be)]===_0x514782(0xcc9)?_0x5b1c64=_0x34e9e3[_0x514782(0x1423)]?_0x34e9e3[_0x514782(0x362)][_0x514782(0xa28)]||'我':'我':_0x5b1c64=_0x34e9e3[_0x514782(0x1423)]?_0x227113['senderName']:_0x34e9e3[_0x514782(0xe36)]);}}return _0xd95cf[_0x514782(0x1430)]()[_0x514782(0x138a)](_0x1e4dcb)||_0x5b1c64[_0x514782(0x1430)]()[_0x514782(0x138a)](_0x1e4dcb);});_0x2f6186(_0x30006c);}),_0x3cf556[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x16e2e6=_0x2ea2d1;_0x5a94cc[_0x16e2e6(0x11a4)]='',_0x3cf556[_0x16e2e6(0x589)][_0x16e2e6(0x701)]='none',_0x2f6186(allFavoriteItems),_0x5a94cc[_0x16e2e6(0x52b)]();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1b7))['addEventListener'](_0x2ea2d1(0x1177),async()=>{const _0x5c8fa0=_0x2ea2d1;if(_0x2c905a['size']===0x0)return;const _0x1a2ffa=_0x28f30a[_0x5c8fa0(0x6ce)][_0x28f30a['activeChatId']];if(!_0x1a2ffa)return;const _0x2dd131=[],_0xa86758=[..._0x2c905a];for(const _0x12d798 of _0xa86758){const _0x4882f8=await _0x5b9d83[_0x5c8fa0(0x101f)][_0x5c8fa0(0x67e)](_0x5c8fa0(0x83b))[_0x5c8fa0(0x129a)](_0x12d798)['first']();if(!_0x4882f8){const _0x34de8b=_0x1a2ffa['history'][_0x5c8fa0(0x412)](_0x25eb7c=>_0x25eb7c[_0x5c8fa0(0x69a)]===_0x12d798);_0x34de8b&&_0x2dd131[_0x5c8fa0(0x367)]({'type':'chat_message','content':_0x34de8b,'chatId':_0x28f30a['activeChatId'],'timestamp':Date[_0x5c8fa0(0x487)](),'originalTimestamp':_0x34de8b['timestamp']});}}_0x2dd131[_0x5c8fa0(0x9a1)]>0x0?(await _0x5b9d83['favorites'][_0x5c8fa0(0x11f3)](_0x2dd131),allFavoriteItems=await _0x5b9d83[_0x5c8fa0(0x101f)][_0x5c8fa0(0x106d)](_0x5c8fa0(0x69a))[_0x5c8fa0(0x6c9)]()[_0x5c8fa0(0x14b5)](),await _0x34d596(_0x5c8fa0(0xdcf),_0x5c8fa0(0x1144)+_0x2dd131[_0x5c8fa0(0x9a1)]+_0x5c8fa0(0xae3))):await _0x34d596('提示',_0x5c8fa0(0xbeb)),_0x13d807();});const _0x5444a3=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x121e)),_0x5ea2c6=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1175)),_0x1ff467=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xac2)),_0x277441=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1155)),_0x28c0c0=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x678));_0x5444a3[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x55dedd=_0x2ea2d1;_0x8c830a=!_0x8c830a,_0x5ea2c6[_0x55dedd(0xff6)][_0x55dedd(0x14c8)](_0x55dedd(0x38d),_0x8c830a),_0x8c830a?(_0x5444a3['textContent']='完成',_0x1ff467[_0x55dedd(0x589)][_0x55dedd(0x701)]='block',_0x277441[_0x55dedd(0x589)][_0x55dedd(0x701)]=_0x55dedd(0x5b1),_0x28c0c0[_0x55dedd(0x589)][_0x55dedd(0x8a3)]=_0x55dedd(0xcbf)):(_0x5444a3['textContent']='编辑',_0x1ff467[_0x55dedd(0x589)]['display']=_0x55dedd(0x5b1),_0x277441[_0x55dedd(0x589)][_0x55dedd(0x701)]=_0x55dedd(0xc67),_0x28c0c0[_0x55dedd(0x589)][_0x55dedd(0x8a3)]='',_0xefcc57[_0x55dedd(0xe98)](),document[_0x55dedd(0x5d6)](_0x55dedd(0x18a))[_0x55dedd(0xf99)](_0x23039b=>_0x23039b['classList'][_0x55dedd(0x1424)]('selected')),document[_0x55dedd(0x2ec)]('favorites-delete-selected-btn')['textContent']=_0x55dedd(0xd4f));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x678))[_0x2ea2d1(0xf79)]('click',_0x47d2a0=>{const _0x333c61=_0x2ea2d1,_0x12a3cf=_0x47d2a0[_0x333c61(0x1104)],_0x2c8e49=_0x12a3cf[_0x333c61(0x3f2)]('.favorite-item-card');if(_0x12a3cf['tagName']===_0x333c61(0x23e)&&_0x12a3cf[_0x333c61(0xe93)][_0x333c61(0xf3b)]){const _0x4885af=_0x12a3cf['dataset'][_0x333c61(0xf3b)];_0x34d596(_0x333c61(0xde0),_0x4885af[_0x333c61(0x13ed)](/<br>/g,'\x0a'));return;}if(!_0x8c830a)return;if(!_0x2c8e49)return;const _0x579ef5=parseInt(_0x2c8e49['dataset']['favid']);if(isNaN(_0x579ef5))return;_0xefcc57[_0x333c61(0xbf1)](_0x579ef5)?(_0xefcc57[_0x333c61(0x54b)](_0x579ef5),_0x2c8e49['classList'][_0x333c61(0x1424)](_0x333c61(0xba2))):(_0xefcc57[_0x333c61(0xe82)](_0x579ef5),_0x2c8e49[_0x333c61(0xff6)][_0x333c61(0xe82)](_0x333c61(0xba2))),document['getElementById']('favorites-delete-selected-btn')[_0x333c61(0x15f)]='删除\x20('+_0xefcc57['size']+')';}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1075))['addEventListener'](_0x2ea2d1(0x1177),async()=>{const _0x46c246=_0x2ea2d1;if(_0xefcc57[_0x46c246(0x2d2)]===0x0)return;const _0x49c8de=await _0x4436ba('确认删除',_0x46c246(0xa1a)+_0xefcc57['size']+_0x46c246(0x12ae),{'confirmButtonClass':'btn-danger'});if(_0x49c8de){const _0x3dd54e=[..._0xefcc57];await _0x5b9d83[_0x46c246(0x101f)][_0x46c246(0x1521)](_0x3dd54e),await _0x34d596('删除成功',_0x46c246(0xcd3)),allFavoriteItems=allFavoriteItems['filter'](_0x5bfad8=>!_0x3dd54e[_0x46c246(0x138a)](_0x5bfad8['id'])),_0x2f6186(allFavoriteItems),_0x5444a3[_0x46c246(0x1177)]();}});_0x28f30a[_0x2ea2d1(0x1062)]['enableBackgroundActivity']&&(_0xe2b398(),console['log'](_0x2ea2d1(0x163)));document['querySelectorAll']('input[name=\x22theme-select\x22]')[_0x2ea2d1(0xf99)](_0x2db9d7=>{const _0x27addb=_0x2ea2d1;_0x2db9d7[_0x27addb(0xf79)]('change',_0xa23065);});const _0x4b2d42=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x3ca));_0x4b2d42[_0x2ea2d1(0xf79)](_0x2ea2d1(0x6a9),()=>{const _0x4e3e6f=_0x2ea2d1;document[_0x4e3e6f(0x2ec)]('font-size-value')[_0x4e3e6f(0x15f)]=_0x4b2d42[_0x4e3e6f(0x11a4)]+'px',_0xa23065();});const _0x4efed4=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x12b0));_0x4efed4[_0x2ea2d1(0xf79)](_0x2ea2d1(0x6a9),_0xa23065),document[_0x2ea2d1(0x2ec)]('reset-theme-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x2d8c9b=_0x2ea2d1;document[_0x2d8c9b(0x2ec)](_0x2d8c9b(0x138c))[_0x2d8c9b(0x13b8)]=!![],_0xa23065();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x14c5))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x34f894=_0x2ea2d1;document[_0x34f894(0x2ec)](_0x34f894(0x12b0))[_0x34f894(0x11a4)]='',_0xa23065();}),document['getElementById']('lyrics-vertical-pos')[_0x2ea2d1(0xf79)]('change',_0xa23065),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xc4e))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0xa23065),document['getElementById']('lyrics-offset-input')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x6a9),_0xa23065),document[_0x2ea2d1(0x5d6)](_0x2ea2d1(0x68b))[_0x2ea2d1(0xf99)](_0x1f80ca=>{_0x1f80ca['addEventListener']('change',function(){const _0x398cff=_0x1937,_0x56d340=document[_0x398cff(0x2ec)](_0x398cff(0xed5));this[_0x398cff(0x11a4)]===_0x398cff(0x1388)||this['value']===_0x398cff(0xfd3)?_0x56d340[_0x398cff(0x589)]['display']='block':_0x56d340[_0x398cff(0x589)][_0x398cff(0x701)]=_0x398cff(0x5b1);});}),document['getElementById']('manage-groups-btn')['addEventListener'](_0x2ea2d1(0x1177),_0x42b40d),document['getElementById'](_0x2ea2d1(0x13af))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x2db5d7=_0x2ea2d1;document[_0x2db5d7(0x2ec)](_0x2db5d7(0x1158))[_0x2db5d7(0xff6)]['remove'](_0x2db5d7(0x149d));const _0xec891f=document['getElementById'](_0x2db5d7(0x128a));document[_0x2db5d7(0x2ec)](_0x2db5d7(0x144a))['classList'][_0x2db5d7(0xe9a)](_0x2db5d7(0x149d))&&_0xec891f['click']();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x124d))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x46140a),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x8c7))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x1af7e2=>{const _0xe8b9c0=_0x2ea2d1;if(_0x1af7e2[_0xe8b9c0(0x1104)][_0xe8b9c0(0xff6)][_0xe8b9c0(0xe9a)](_0xe8b9c0(0x1d2))){const _0x4ab077=parseInt(_0x1af7e2[_0xe8b9c0(0x1104)][_0xe8b9c0(0xe93)]['id']);_0x3a5368(_0x4ab077);}}),document['getElementById'](_0x2ea2d1(0x13bf))['addEventListener'](_0x2ea2d1(0x1177),_0x3d2470),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xc65))[_0x2ea2d1(0xf79)]('click',_0x1217b4),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1399))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x797b61),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xf20))[_0x2ea2d1(0xf79)]('click',_0x1f5b74),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xdf1))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x5c751d=_0x38f399;_0x3d2470(),_0x5c751d&&_0x40f100(_0x5c751d);}),document['getElementById']('chat-messages')[_0x2ea2d1(0xf79)]('click',_0xeed91b=>{const _0x3af191=_0x2ea2d1,_0x546e0f=_0xeed91b[_0x3af191(0x1104)]['closest'](_0x3af191(0x124c));if(!_0x546e0f)return;if(_0x546e0f[_0x3af191(0xff6)]['contains']('ai')&&_0x546e0f[_0x3af191(0xff6)][_0x3af191(0xe9a)](_0x3af191(0xb80))&&_0x546e0f[_0x3af191(0xe93)][_0x3af191(0x2a3)]===_0x3af191(0x8c9)){const _0x50699b=parseInt(_0x546e0f[_0x3af191(0xe93)][_0x3af191(0x69a)]);!isNaN(_0x50699b)&&_0x1c5e62(_0x50699b);}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x4a9))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>_0x2c10a4('accepted')),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xb41))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>_0x2c10a4(_0x2ea2d1(0x757))),document[_0x2ea2d1(0x2ec)]('transfer-action-cancel')['addEventListener'](_0x2ea2d1(0x1177),_0x4eb421),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x10d1))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x531bf2),document[_0x2ea2d1(0x2ec)]('copy-post-btn')['addEventListener'](_0x2ea2d1(0x1177),_0x2684ce),document['getElementById'](_0x2ea2d1(0x105e))['addEventListener'](_0x2ea2d1(0x1177),_0x4d2639),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x390))['addEventListener']('click',()=>{_0x17ec27('chat-list-screen');}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x11ef))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x467397=>{const _0x4390b3=_0x2ea2d1,_0x2b42af=_0x467397[_0x4390b3(0x1104)][_0x4390b3(0x3f2)](_0x4390b3(0x973));if(!_0x2b42af)return;const _0x4675b9=_0x2b42af[_0x4390b3(0xe93)][_0x4390b3(0xdac)];_0x2b42af[_0x4390b3(0xff6)][_0x4390b3(0x14c8)](_0x4390b3(0xba2)),_0x488644[_0x4390b3(0xbf1)](_0x4675b9)?_0x488644[_0x4390b3(0x54b)](_0x4675b9):_0x488644[_0x4390b3(0xe82)](_0x4675b9),_0x152a37();}),document[_0x2ea2d1(0x2ec)]('manage-members-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{_0x2f535f();}),document['getElementById']('back-from-member-management')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x344588=_0x2ea2d1;_0x17ec27(_0x344588(0x120a)),document[_0x344588(0x2ec)]('chat-settings-btn')[_0x344588(0x1177)]();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x363))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x297a66=>{const _0x5595b6=_0x2ea2d1;_0x297a66[_0x5595b6(0x1104)][_0x5595b6(0xff6)][_0x5595b6(0xe9a)](_0x5595b6(0x375))&&_0x115daf(_0x297a66[_0x5595b6(0x1104)][_0x5595b6(0xe93)]['memberId']);}),document[_0x2ea2d1(0x2ec)]('add-existing-contact-btn')[_0x2ea2d1(0xf79)]('click',async()=>{const _0x2f9d05=_0x2ea2d1,_0x523544=document[_0x2f9d05(0x2ec)](_0x2f9d05(0x3dc)),_0x308297=_0x523544[_0x2f9d05(0x303)](!![]);_0x523544[_0x2f9d05(0x1092)][_0x2f9d05(0x6ab)](_0x308297,_0x523544),_0x308297['addEventListener'](_0x2f9d05(0x1177),_0x1f0df9),await _0x5eb5c5();}),document['getElementById'](_0x2ea2d1(0x266))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x5951fa),document[_0x2ea2d1(0x2ec)]('video-call-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x4ae15c),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x57e))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x4ae15c),document['getElementById'](_0x2ea2d1(0x11fa))['addEventListener']('click',_0x4e33b8),document[_0x2ea2d1(0x2ec)]('cancel-call-btn')[_0x2ea2d1(0xf79)]('click',()=>{const _0x30d7a4=_0x2ea2d1;_0x20bfc1[_0x30d7a4(0x122a)]=![],_0x17ec27(_0x30d7a4(0x120a));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x135e))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x19fb1a),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x10d0))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x26b90a=_0x2ea2d1;_0x2dce72();const _0x171869=_0x28f30a[_0x26b90a(0x6ce)][_0x20bfc1['activeChatId']];if(!_0x171869)return;if(_0x20bfc1[_0x26b90a(0x131e)]){_0x20bfc1[_0x26b90a(0x402)]=![];const _0x206555={'role':_0x26b90a(0x10a7),'content':_0x26b90a(0x622),'timestamp':Date[_0x26b90a(0x487)](),'isHidden':!![]};_0x171869[_0x26b90a(0x12c3)]['push'](_0x206555),await _0x5b9d83[_0x26b90a(0x6ce)][_0x26b90a(0x7c3)](_0x171869),await _0x36bcc9();}else{const _0x1255d9={'role':_0x26b90a(0xcc9),'content':'我拒绝了你的视频通话请求。','timestamp':Date[_0x26b90a(0x487)]()};_0x171869[_0x26b90a(0x12c3)][_0x26b90a(0x367)](_0x1255d9),await _0x5b9d83[_0x26b90a(0x6ce)][_0x26b90a(0x7c3)](_0x171869),_0x17ec27(_0x26b90a(0x120a)),_0x4cc03e(_0x1255d9,_0x171869),_0x36bcc9();}_0x20bfc1[_0x26b90a(0x122a)]=![];}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x2ff))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0xd518af=_0x2ea2d1;_0x2dce72(),_0x20bfc1[_0xd518af(0xb3c)]='ai',_0x20bfc1['isUserParticipating']=!![],_0x20bfc1[_0xd518af(0x11b9)]=_0x28f30a[_0xd518af(0x11b9)];if(_0x20bfc1['isGroupCall']){const _0x29446a=_0x28f30a['chats'][_0x20bfc1[_0xd518af(0x11b9)]],_0x2ffc37=_0x29446a[_0xd518af(0x10f2)][_0xd518af(0x412)](_0x456068=>_0x456068['name']===_0x20bfc1[_0xd518af(0x2bb)]);_0x2ffc37?_0x20bfc1[_0xd518af(0x73e)]=[_0x2ffc37]:_0x20bfc1[_0xd518af(0x73e)]=[];}_0x5821d3();}),document[_0x2ea2d1(0x2ec)]('user-speak-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x25deae=_0x2ea2d1;if(!_0x20bfc1[_0x25deae(0xffc)])return;const _0x364e84=document['querySelector']('.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar');_0x364e84&&_0x364e84[_0x25deae(0xff6)][_0x25deae(0xe82)](_0x25deae(0x112c));const _0x16b962=await _0x33419a('你说',_0x25deae(0x5a1));_0x364e84&&_0x364e84[_0x25deae(0xff6)][_0x25deae(0x1424)](_0x25deae(0x112c)),_0x16b962&&_0x16b962[_0x25deae(0x97e)]()&&_0x1df4a2(_0x16b962['trim']());}),document[_0x2ea2d1(0x765)]('.nav-item[data-view=\x22memories-view\x22]')[_0x2ea2d1(0xf79)]('click',()=>{const _0x5b2780=_0x2ea2d1;_0x8c830a&&document[_0x5b2780(0x2ec)](_0x5b2780(0x121e))[_0x5b2780(0x1177)](),_0x52c3ce(_0x5b2780(0x4ad)),_0x50688b();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x5ac))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>_0x52c3ce(_0x2ea2d1(0x1e2))),document[_0x2ea2d1(0x2ec)]('confirm-create-countdown-btn')[_0x2ea2d1(0xf79)]('click',async()=>{const _0x108540=_0x2ea2d1,_0x872896=document[_0x108540(0x2ec)](_0x108540(0xa2a))[_0x108540(0x11a4)][_0x108540(0x97e)](),_0x172a3c=document[_0x108540(0x2ec)]('countdown-date-input')[_0x108540(0x11a4)];if(!_0x872896||!_0x172a3c){alert(_0x108540(0x11f9));return;}const _0x11f78b=new Date(_0x172a3c);if(isNaN(_0x11f78b)||_0x11f78b<=new Date()){alert(_0x108540(0x10e4));return;}const _0x19cede={'authorId':'user','description':_0x872896,'timestamp':Date['now'](),'type':_0x108540(0x975),'targetDate':_0x11f78b[_0x108540(0x33c)]()};await _0x5b9d83[_0x108540(0xf49)][_0x108540(0xe82)](_0x19cede),document[_0x108540(0x2ec)](_0x108540(0x3ad))[_0x108540(0xff6)]['remove']('visible'),_0x50688b();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x650))['addEventListener']('click',async()=>{const _0x1b282a=_0x2ea2d1;if(!_0x28f30a[_0x1b282a(0x11b9)]||_0x28f30a[_0x1b282a(0x6ce)][_0x28f30a['activeChatId']]['isGroup'])return;const _0x5e0cfb=_0x28f30a['chats'][_0x28f30a['activeChatId']],_0x290bcf=await _0x4436ba(_0x1b282a(0xf78),'确定要拉黑“'+_0x5e0cfb[_0x1b282a(0xe36)]+_0x1b282a(0xbc6),{'confirmButtonClass':_0x1b282a(0xd8f)});if(_0x290bcf){_0x5e0cfb[_0x1b282a(0xaf4)][_0x1b282a(0x2a3)]=_0x1b282a(0x214),_0x5e0cfb[_0x1b282a(0xaf4)][_0x1b282a(0xee3)]=Date[_0x1b282a(0x487)]();const _0x3e1a0b={'role':'system','content':_0x1b282a(0x2a4),'timestamp':Date[_0x1b282a(0x487)]()+0x1,'isHidden':!![]};_0x5e0cfb[_0x1b282a(0x12c3)][_0x1b282a(0x367)](_0x3e1a0b),await _0x5b9d83['chats'][_0x1b282a(0x7c3)](_0x5e0cfb),document['getElementById'](_0x1b282a(0x144a))[_0x1b282a(0xff6)][_0x1b282a(0x1424)](_0x1b282a(0x149d)),_0xc55746(_0x28f30a[_0x1b282a(0x11b9)]),_0x5db8a3();}}),document['getElementById'](_0x2ea2d1(0x2c9))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async _0x594bcd=>{const _0x37cf86=_0x2ea2d1,_0x188b8f=_0x28f30a[_0x37cf86(0x6ce)][_0x28f30a[_0x37cf86(0x11b9)]];if(!_0x188b8f)return;if(_0x594bcd['target']['id']===_0x37cf86(0xf2a)){alert(_0x37cf86(0x596)),await _0x581fd5(_0x188b8f['id']),_0xc55746(_0x188b8f['id']);return;}if(_0x594bcd[_0x37cf86(0x1104)]['id']===_0x37cf86(0x1462)){_0x188b8f[_0x37cf86(0xaf4)][_0x37cf86(0x2a3)]='friend',_0x188b8f[_0x37cf86(0xaf4)]['blockedTimestamp']=null;const _0x26e3ca={'role':_0x37cf86(0x10a7),'content':_0x37cf86(0x84c),'timestamp':Date[_0x37cf86(0x487)](),'isHidden':!![]};_0x188b8f[_0x37cf86(0x12c3)][_0x37cf86(0x367)](_0x26e3ca),await _0x5b9d83[_0x37cf86(0x6ce)][_0x37cf86(0x7c3)](_0x188b8f),_0xc55746(_0x188b8f['id']),_0x5db8a3(),_0x36bcc9();}else{if(_0x594bcd[_0x37cf86(0x1104)]['id']==='accept-friend-btn'){_0x188b8f['relationship'][_0x37cf86(0x2a3)]=_0x37cf86(0xab9),_0x188b8f[_0x37cf86(0xaf4)]['applicationReason']='';const _0x2ba4a2={'role':_0x37cf86(0x10a7),'type':_0x37cf86(0x10aa),'content':_0x37cf86(0x897)+_0x188b8f[_0x37cf86(0xe36)]+'”的好友请求','timestamp':Date[_0x37cf86(0x487)]()};_0x188b8f[_0x37cf86(0x12c3)]['push'](_0x2ba4a2);const _0x5c1065={'role':_0x37cf86(0x6d9),'senderName':_0x188b8f[_0x37cf86(0xe36)],'content':'太好了！我们又可以聊天啦！','timestamp':Date[_0x37cf86(0x487)]()+0x1};_0x188b8f['history']['push'](_0x5c1065),await _0x5b9d83[_0x37cf86(0x6ce)][_0x37cf86(0x7c3)](_0x188b8f),_0xc55746(_0x188b8f['id']),_0x5db8a3();}else{if(_0x594bcd[_0x37cf86(0x1104)]['id']===_0x37cf86(0x609))_0x188b8f[_0x37cf86(0xaf4)]['status']=_0x37cf86(0x214),_0x188b8f['relationship'][_0x37cf86(0xee3)]=Date[_0x37cf86(0x487)](),_0x188b8f[_0x37cf86(0xaf4)][_0x37cf86(0x2d1)]='',await _0x5b9d83[_0x37cf86(0x6ce)][_0x37cf86(0x7c3)](_0x188b8f),_0xc55746(_0x188b8f['id']);else{if(_0x594bcd[_0x37cf86(0x1104)]['id']===_0x37cf86(0x24f)){const _0x48ad02=await _0x33419a('发送好友申请','请输入你想对“'+_0x188b8f['name']+_0x37cf86(0x1539),_0x37cf86(0x1f4));_0x48ad02!==null&&(_0x188b8f[_0x37cf86(0xaf4)]['status']=_0x37cf86(0x890),_0x188b8f['relationship'][_0x37cf86(0x2d1)]=_0x48ad02,await _0x5b9d83[_0x37cf86(0x6ce)][_0x37cf86(0x7c3)](_0x188b8f),_0xc55746(_0x188b8f['id']),_0x5db8a3(),_0x36bcc9());}}}}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xf52))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0xebf407),document['getElementById'](_0x2ea2d1(0xa51))[_0x2ea2d1(0xf79)]('click',()=>{const _0x47ce18=_0x2ea2d1;document[_0x47ce18(0x2ec)](_0x47ce18(0x2b8))[_0x47ce18(0xff6)][_0x47ce18(0x1424)](_0x47ce18(0x149d));}),document['getElementById'](_0x2ea2d1(0x1076))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x4a0410),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x2b3))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x4f9780);const _0x1dfd0f=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x4ec)),_0x38d2b5=document['getElementById'](_0x2ea2d1(0xf45)),_0xe0e564=document['getElementById'](_0x2ea2d1(0x131a)),_0x49585c=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x64d));_0x1dfd0f[_0x2ea2d1(0xf79)]('click',()=>{const _0x1748a9=_0x2ea2d1;_0x1dfd0f[_0x1748a9(0xff6)]['add'](_0x1748a9(0xd43)),_0x38d2b5[_0x1748a9(0xff6)][_0x1748a9(0x1424)]('active'),_0xe0e564['style'][_0x1748a9(0x701)]=_0x1748a9(0x13f7),_0x49585c['style'][_0x1748a9(0x701)]=_0x1748a9(0x5b1);}),_0x38d2b5[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x37a839=_0x2ea2d1;_0x38d2b5[_0x37a839(0xff6)]['add'](_0x37a839(0xd43)),_0x1dfd0f[_0x37a839(0xff6)][_0x37a839(0x1424)]('active'),_0x49585c[_0x37a839(0x589)][_0x37a839(0x701)]=_0x37a839(0x13f7),_0xe0e564['style']['display']=_0x37a839(0x5b1);}),document['getElementById'](_0x2ea2d1(0x59b))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x6a9),_0x3c665f=>{const _0x431d73=_0x2ea2d1,_0x3aae40=parseFloat(_0x3c665f[_0x431d73(0x1104)]['value'])||0x0;document[_0x431d73(0x2ec)](_0x431d73(0xb99))[_0x431d73(0x15f)]='¥\x20'+_0x3aae40[_0x431d73(0x5c3)](0x2);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x11ff))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x6a9),_0x15266e=>{const _0x4e3158=_0x2ea2d1,_0x11926f=parseFloat(_0x15266e[_0x4e3158(0x1104)]['value'])||0x0;document[_0x4e3158(0x2ec)](_0x4e3158(0x13c7))[_0x4e3158(0x15f)]='¥\x20'+_0x11926f[_0x4e3158(0x5c3)](0x2);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x156b))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x3a858d=>{const _0x13df79=_0x2ea2d1,_0x4886b7=_0x3a858d[_0x13df79(0x1104)][_0x13df79(0x3f2)](_0x13df79(0x13e5));if(!_0x4886b7)return;const _0x3a1c36=_0x4886b7[_0x13df79(0x3f2)](_0x13df79(0x124c));if(!_0x3a1c36||!_0x3a1c36[_0x13df79(0xe93)]['timestamp'])return;const _0xd6e0e4=parseInt(_0x3a1c36[_0x13df79(0xe93)][_0x13df79(0x69a)]);_0x1b1fff(_0xd6e0e4);}),document['getElementById']('send-poll-btn')['addEventListener']('click',_0x3ff437),document['getElementById'](_0x2ea2d1(0xb20))['addEventListener'](_0x2ea2d1(0x1177),_0x2acf1e),document['getElementById'](_0x2ea2d1(0x32f))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x4ac25a=_0x2ea2d1;document[_0x4ac25a(0x2ec)]('create-poll-modal')['classList'][_0x4ac25a(0x1424)](_0x4ac25a(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x105d))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x2ffdcb),document[_0x2ea2d1(0x2ec)]('chat-messages')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0xf64849=>{const _0x487294=_0x2ea2d1,_0x426c5b=_0xf64849[_0x487294(0x1104)]['closest']('.poll-card');if(!_0x426c5b)return;const _0x62b895=parseInt(_0x426c5b[_0x487294(0xe93)]['pollTimestamp']);if(isNaN(_0x62b895))return;const _0x1a61c7=_0xf64849[_0x487294(0x1104)][_0x487294(0x3f2)]('.poll-option-item');if(_0x1a61c7&&!_0x426c5b[_0x487294(0xff6)][_0x487294(0xe9a)](_0x487294(0x7df))){_0xa54a77(_0x62b895,_0x1a61c7[_0x487294(0xe93)][_0x487294(0x29d)]);return;}const _0x291dbb=_0xf64849[_0x487294(0x1104)][_0x487294(0x3f2)](_0x487294(0xd25));if(_0x291dbb){_0x426c5b['classList'][_0x487294(0xe9a)](_0x487294(0x7df))?_0x53f237(_0x62b895):_0xa95d12(_0x62b895);return;}_0x426c5b[_0x487294(0xff6)]['contains'](_0x487294(0x7df))&&_0x53f237(_0x62b895);}),document['getElementById'](_0x2ea2d1(0x474))[_0x2ea2d1(0xf79)]('click',_0x27ef70),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x11db))['addEventListener'](_0x2ea2d1(0x1177),()=>_0x40b739('ai')),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x3cb))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>_0x40b739('group')),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x496))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x58156c),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1125))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x52d430=_0x2ea2d1;document['getElementById'](_0x52d430(0x11d1))[_0x52d430(0x1177)]();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x11d1))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x275feb),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x78b))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0xc9bd7),document['getElementById'](_0x2ea2d1(0x173))['addEventListener']('click',_0x1196a8),document[_0x2ea2d1(0x2ec)]('add-group-avatar-url-btn')[_0x2ea2d1(0xf79)]('click',_0x34a111),document['getElementById']('add-group-avatar-upload-btn')[_0x2ea2d1(0xf79)]('click',()=>{const _0x44819e=_0x2ea2d1;document['getElementById']('group-avatar-upload-input')[_0x44819e(0x1177)]();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xd81))['addEventListener'](_0x2ea2d1(0x217),_0x4676f5),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xb24))[_0x2ea2d1(0xf79)]('click',_0x3bb8d7),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x2ac))[_0x2ea2d1(0xf79)]('click',_0x35b198=>{const _0x5ac644=_0x2ea2d1;if(_0x35b198[_0x5ac644(0x1104)][_0x5ac644(0xff6)][_0x5ac644(0xe9a)]('change-icon-btn')){const _0x36b58a=_0x35b198[_0x5ac644(0x1104)]['closest']('.icon-setting-item'),_0x4faa9b=_0x36b58a[_0x5ac644(0xe93)][_0x5ac644(0x1019)];_0x4faa9b&&_0x2f298d(_0x4faa9b,_0x5ac644(0x8c5),_0x36b58a);}}),document[_0x2ea2d1(0x2ec)]('chat-messages')[_0x2ea2d1(0xf79)]('click',_0x44e1f1=>{const _0x3d3af8=_0x2ea2d1,_0x4b68a5=_0x44e1f1[_0x3d3af8(0x1104)][_0x3d3af8(0x3f2)]('.link-share-card');if(_0x4b68a5){const _0x21d932=parseInt(_0x4b68a5[_0x3d3af8(0xe93)][_0x3d3af8(0x69a)]);!isNaN(_0x21d932)&&_0x32e580(_0x21d932);}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x28b))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x5eda5f=_0x2ea2d1;_0x17ec27(_0x5eda5f(0x120a));}),_0x3006bc[_0x2ea2d1(0x97a)]['addEventListener']('click',async _0xae2dd9=>{const _0x1854b8=_0x2ea2d1,_0x3302b0=_0xae2dd9[_0x1854b8(0x1104)][_0x1854b8(0x3f2)](_0x1854b8(0x55a));if(_0x3302b0&&_0x3006bc[_0x1854b8(0xa50)]!==null){const _0x370aec=_0x3302b0[_0x1854b8(0x589)][_0x1854b8(0xe00)][_0x1854b8(0x225)](0x5,-0x2),_0x10bb33=_0x28f30a['userStickers'][_0x1854b8(0x412)](_0x3971c9=>_0x3971c9['url']===_0x370aec);_0x10bb33?await _0x4cc08e(_0x3006bc[_0x1854b8(0xa50)],_0x10bb33):console[_0x1854b8(0x664)]('在动态评论区点击了表情，但在表情库中未找到对象:',_0x370aec);}}),document['addEventListener'](_0x2ea2d1(0x1177),_0x4950e6=>{const _0x4282e3=_0x2ea2d1;_0x3006bc[_0x4282e3(0x404)]&&!_0x3006bc['panelEl'][_0x4282e3(0xe9a)](_0x4950e6[_0x4282e3(0x1104)])&&!_0x4950e6['target'][_0x4282e3(0x3f2)](_0x4282e3(0x2ae))&&_0x4feed8();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x577))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x3a262d),document[_0x2ea2d1(0x2ec)]('cancel-share-link-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x4c3f4d=_0x2ea2d1;document[_0x4c3f4d(0x2ec)]('share-link-modal')[_0x4c3f4d(0xff6)]['remove'](_0x4c3f4d(0x149d));}),document[_0x2ea2d1(0x2ec)]('confirm-share-link-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x40257c),document['getElementById'](_0x2ea2d1(0x1381))['addEventListener'](_0x2ea2d1(0x217),_0x3470f6),document['getElementById']('share-location-btn')[_0x2ea2d1(0xf79)]('click',_0x32e1b4),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xdea))['addEventListener'](_0x2ea2d1(0x1177),_0xe4e999),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xbd9))[_0x2ea2d1(0xf79)]('click',()=>{const _0x2afe5e=_0x2ea2d1;_0x17ec27(_0x2afe5e(0xf4d));}),document[_0x2ea2d1(0x2ec)]('call-history-list')['addEventListener'](_0x2ea2d1(0x1177),_0x72ddee=>{const _0x12c8f9=_0x2ea2d1,_0xd2d2c0=_0x72ddee[_0x12c8f9(0x1104)][_0x12c8f9(0x3f2)](_0x12c8f9(0x1397));_0xd2d2c0&&_0xd2d2c0[_0x12c8f9(0xe93)][_0x12c8f9(0x13e8)]&&_0x45f423(parseInt(_0xd2d2c0['dataset'][_0x12c8f9(0x13e8)]));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xc72))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x9dff1b=_0x2ea2d1;document['getElementById'](_0x9dff1b(0x46d))['classList'][_0x9dff1b(0x1424)](_0x9dff1b(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x139a))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x51d0d8),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x721))['addEventListener'](_0x2ea2d1(0x1177),()=>{_0x2c905a['size']>0x0&&_0x289de8();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x582))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x1040dc),document['getElementById']('confirm-share-target-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x3cde5a=_0x2ea2d1,_0xa5a878=_0x28f30a[_0x3cde5a(0x6ce)][_0x28f30a['activeChatId']],_0xf0869d=Array[_0x3cde5a(0x13d1)](document[_0x3cde5a(0x5d6)]('.share-target-checkbox:checked'))[_0x3cde5a(0x11c6)](_0x490e4e=>_0x490e4e[_0x3cde5a(0xe93)][_0x3cde5a(0xdd0)]);if(_0xf0869d[_0x3cde5a(0x9a1)]===0x0){alert(_0x3cde5a(0x1281));return;}const _0x3791a8=[],_0xa96954=[..._0x2c905a][_0x3cde5a(0x126b)]((_0x4b50ed,_0x1f974b)=>_0x4b50ed-_0x1f974b);for(const _0x190bba of _0xa96954){const _0x42e580=_0xa5a878[_0x3cde5a(0x12c3)][_0x3cde5a(0x412)](_0x30439c=>_0x30439c['timestamp']===_0x190bba);_0x42e580&&_0x3791a8[_0x3cde5a(0x367)](_0x42e580);}const _0x3eec22={'role':_0x3cde5a(0xcc9),'senderName':_0xa5a878[_0x3cde5a(0x1423)]?_0xa5a878[_0x3cde5a(0x362)][_0x3cde5a(0xa28)]||'我':'我','type':_0x3cde5a(0x886),'timestamp':Date['now'](),'payload':{'sourceChatName':_0xa5a878[_0x3cde5a(0xe36)],'title':_0x3cde5a(0x13c3)+_0xa5a878[_0x3cde5a(0xe36)]+_0x3cde5a(0x420),'sharedHistory':_0x3791a8}};for(const _0x33ae04 of _0xf0869d){const _0x3e7caf=_0x28f30a[_0x3cde5a(0x6ce)][_0x33ae04];_0x3e7caf&&(_0x3e7caf[_0x3cde5a(0x12c3)][_0x3cde5a(0x367)](_0x3eec22),await _0x5b9d83[_0x3cde5a(0x6ce)][_0x3cde5a(0x7c3)](_0x3e7caf));}document['getElementById']('share-target-modal')[_0x3cde5a(0xff6)]['remove'](_0x3cde5a(0x149d)),_0x13d807(),await _0x34d596(_0x3cde5a(0x27d),_0x3cde5a(0x4a8)+_0xf0869d[_0x3cde5a(0x9a1)]+_0x3cde5a(0x1366)),_0x5db8a3();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xa60))[_0x2ea2d1(0xf79)]('click',()=>{const _0xb02f10=_0x2ea2d1;document[_0xb02f10(0x2ec)](_0xb02f10(0xc24))[_0xb02f10(0xff6)][_0xb02f10(0x1424)](_0xb02f10(0x149d));}),document['getElementById'](_0x2ea2d1(0x156b))['addEventListener'](_0x2ea2d1(0x1177),_0x3c780f=>{const _0x123a8f=_0x2ea2d1,_0x1d4c37=_0x3c780f[_0x123a8f(0x1104)][_0x123a8f(0x3f2)](_0x123a8f(0x45e));if(_0x1d4c37&&_0x1d4c37[_0x123a8f(0x3f2)]('.message-bubble.is-link-share')){const _0x581ecd=parseInt(_0x1d4c37['dataset'][_0x123a8f(0x69a)]);_0x599bb7(_0x581ecd);}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x13c6))['addEventListener']('click',()=>{const _0x544808=_0x2ea2d1;document[_0x544808(0x2ec)]('shared-history-viewer-modal')[_0x544808(0xff6)]['remove'](_0x544808(0x149d));});async function _0x599bb7(_0x430263){const _0x3bd245=_0x2ea2d1,_0x2fb093=_0x28f30a[_0x3bd245(0x6ce)][_0x28f30a[_0x3bd245(0x11b9)]];if(!_0x2fb093)return;const _0x46fde7=_0x2fb093[_0x3bd245(0x12c3)][_0x3bd245(0x412)](_0x197c44=>_0x197c44['timestamp']===_0x430263);if(!_0x46fde7){console[_0x3bd245(0x1518)](_0x3bd245(0x5d7),_0x430263),await _0x34d596('查看失败',_0x3bd245(0xc11));return;}if(_0x46fde7[_0x3bd245(0xb4b)]==='share_link'){_0x32e580(_0x430263);return;}if(_0x46fde7[_0x3bd245(0xb4b)]===_0x3bd245(0x886)){if(!_0x46fde7[_0x3bd245(0x13a6)]||!_0x46fde7[_0x3bd245(0x13a6)][_0x3bd245(0xcc0)]){console['error'](_0x3bd245(0x454),_0x46fde7),await _0x34d596('查看失败',_0x3bd245(0x1305));return;}}else{console['error'](_0x3bd245(0x2dc),_0x46fde7[_0x3bd245(0xb4b)]),await _0x34d596(_0x3bd245(0xf69),'不支持的分享类型。');return;}const _0x3c311c=document['getElementById'](_0x3bd245(0x1013)),_0x3d4070=document[_0x3bd245(0x2ec)](_0x3bd245(0x1060)),_0xe9e8cf=document[_0x3bd245(0x2ec)](_0x3bd245(0xe51));_0x3d4070[_0x3bd245(0x15f)]=_0x46fde7['payload'][_0x3bd245(0x141e)],_0xe9e8cf['innerHTML']='';const _0x5d3782=document[_0x3bd245(0x12c0)](),_0x50400f=Object['values'](_0x28f30a[_0x3bd245(0x6ce)])[_0x3bd245(0x412)](_0x148717=>_0x148717['name']===_0x46fde7['payload'][_0x3bd245(0xede)])||_0x2fb093;for(const _0x29adac of _0x46fde7[_0x3bd245(0x13a6)][_0x3bd245(0xcc0)]){const _0x58981d=await _0x43f190(_0x29adac,_0x50400f);_0x58981d&&_0x5d3782['appendChild'](_0x58981d);}_0xe9e8cf['appendChild'](_0x5d3782),_0x3c311c[_0x3bd245(0xff6)][_0x3bd245(0xe82)](_0x3bd245(0x149d));}_0x4da7ed[_0x2ea2d1(0xf79)](_0x2ea2d1(0xc4b),_0x9574d4),_0x4da7ed['addEventListener'](_0x2ea2d1(0x964),()=>{const _0x35e3b3=_0x2ea2d1;_0x79cac3['isActive']&&(_0x79cac3[_0x35e3b3(0x25e)]=![],_0xdde111());}),_0x4da7ed[_0x2ea2d1(0xf79)](_0x2ea2d1(0x23f),()=>{const _0x915fcf=_0x2ea2d1;_0x79cac3[_0x915fcf(0xffc)]&&(_0x79cac3[_0x915fcf(0x25e)]=!![],_0xdde111());}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x4d2))[_0x2ea2d1(0xf79)]('click',async _0x47ba39=>{const _0x4335e6=_0x2ea2d1,_0x44484b=_0x47ba39[_0x4335e6(0x1104)],_0x5858d3=_0x44484b[_0x4335e6(0x3f2)](_0x4335e6(0x4e7));if(_0x5858d3){const _0x433ccd=parseInt(_0x5858d3[_0x4335e6(0xe93)][_0x4335e6(0x8d1)]);!isNaN(_0x433ccd)&&await _0x32eda6(_0x433ccd);return;}const _0x5821e6=_0x44484b[_0x4335e6(0x3f2)](_0x4335e6(0xacd));if(_0x5821e6){const _0x4d2055=parseInt(_0x5821e6[_0x4335e6(0xe93)][_0x4335e6(0x8d1)]);if(isNaN(_0x4d2055))return;await _0x1fd5f6(_0x4d2055);return;}const _0x4050e5=_0x44484b[_0x4335e6(0x3f2)](_0x4335e6(0x848));if(_0x4050e5){const _0xdd8257=parseInt(_0x4050e5[_0x4335e6(0xe93)][_0x4335e6(0x8d1)]);if(isNaN(_0xdd8257))return;const _0xb44221=_0x79cac3['playlist'][_0xdd8257],_0x3a268d=await _0x4436ba(_0x4335e6(0x189),_0x4335e6(0xd8c)+_0xb44221[_0x4335e6(0xe36)]+_0x4335e6(0x1443));_0x3a268d&&_0x5d04e4(_0xdd8257);return;}const _0x54b1d9=_0x44484b[_0x4335e6(0x3f2)]('.playlist-item-info');if(_0x54b1d9){const _0x412b06=_0x54b1d9['closest']('.playlist-item'),_0x34cb37=Array[_0x4335e6(0x13d1)](_0x412b06[_0x4335e6(0x9e3)][_0x4335e6(0x1492)])[_0x4335e6(0x6d3)](_0x412b06);_0x34cb37>-0x1&&_0x144635(_0x34cb37);}}),document['querySelector'](_0x2ea2d1(0x877))['addEventListener'](_0x2ea2d1(0x1177),_0x4ad694=>{const _0x217a4c=_0x2ea2d1;if(!_0x4da7ed['duration'])return;const _0x3103ee=_0x4ad694[_0x217a4c(0x396)],_0x2e04e7=_0x3103ee['clientWidth'],_0x6d9ca3=_0x4ad694[_0x217a4c(0x8fa)];_0x4da7ed[_0x217a4c(0x3e5)]=_0x6d9ca3/_0x2e04e7*_0x4da7ed[_0x217a4c(0x157d)];}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x156b))['addEventListener'](_0x2ea2d1(0x1177),_0x5d15f5=>{const _0x30053b=_0x2ea2d1,_0x1fff7d=_0x5d15f5['target'][_0x30053b(0x3f2)](_0x30053b(0x37c));if(_0x1fff7d){const _0x886282=_0x28f30a[_0x30053b(0x6ce)][_0x28f30a[_0x30053b(0x11b9)]],_0x364669=_0x1fff7d[_0x30053b(0x3f2)](_0x30053b(0x1571));if(_0x886282&&_0x364669){const _0x108707=parseInt(_0x364669[_0x30053b(0xe93)][_0x30053b(0x69a)]),_0x5d3543=_0x886282[_0x30053b(0x12c3)][_0x30053b(0x412)](_0x4f51d2=>_0x4f51d2[_0x30053b(0x69a)]===_0x108707);if(_0x5d3543&&_0x5d3543[_0x30053b(0x6cd)]){let _0xc7b8b2='';const _0x271e33=_0x5d3543['recalledData'];switch(_0x271e33[_0x30053b(0x223)]){case _0x30053b(0x10ca):_0xc7b8b2=_0x30053b(0xb00)+_0x271e33[_0x30053b(0x37f)]+'\x22';break;case _0x30053b(0x7f7):case _0x30053b(0x11c7):case _0x30053b(0xaa4):_0xc7b8b2=_0x30053b(0x54a)+_0x271e33[_0x30053b(0x37f)]+'\x22';break;case _0x30053b(0x8bc):_0xc7b8b2=_0x30053b(0x1020)+_0x271e33[_0x30053b(0x37f)]+'\x22';break;case'sticker':_0xc7b8b2=_0x30053b(0x557)+(_0x271e33[_0x30053b(0x218)]||_0x30053b(0xa0b))+_0x30053b(0x9d1)+_0x271e33[_0x30053b(0x37f)];break;case _0x30053b(0x277):_0xc7b8b2=_0x30053b(0xb75);break;default:_0xc7b8b2=_0x30053b(0x77a)+_0x271e33[_0x30053b(0x223)]+_0x30053b(0x7aa)+JSON[_0x30053b(0xe4d)](_0x271e33['originalContent']);break;}_0x34d596(_0x30053b(0x8ac),_0xc7b8b2);}}}}),document['getElementById'](_0x2ea2d1(0x64f))['addEventListener']('click',_0x4d26d7),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xde3))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x3773c7=_0x2ea2d1;document[_0x3773c7(0x2ec)](_0x3773c7(0x3c3))[_0x3773c7(0xff6)][_0x3773c7(0x1424)]('visible'),_0x6f6974();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xb3f))['addEventListener'](_0x2ea2d1(0x1177),_0x5285aa),document['getElementById'](_0x2ea2d1(0xa76))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x17f0b5=>{const _0x4eaa9e=_0x2ea2d1;if(_0x17f0b5[_0x4eaa9e(0x1104)][_0x4eaa9e(0xff6)][_0x4eaa9e(0xe9a)]('delete-group-btn')){const _0x2a132b=parseInt(_0x17f0b5[_0x4eaa9e(0x1104)][_0x4eaa9e(0xe93)]['id']);_0x15e6ad(_0x2a132b);}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xfca))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0xaa70b4),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1565))['addEventListener']('click',_0x304e57),document[_0x2ea2d1(0x2ec)]('quote-message-btn')['addEventListener'](_0x2ea2d1(0x1177),_0x4a6fb9),document['getElementById'](_0x2ea2d1(0x1199))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x1c45dd),document['getElementById'](_0x2ea2d1(0x63d))['addEventListener'](_0x2ea2d1(0x6a9),_0x22870f=>{const _0xdac421=_0x2ea2d1;if(!_0x22870f[_0xdac421(0x1104)][_0xdac421(0xb22)]('.comment-input'))return;const _0x106b7c=_0x22870f[_0xdac421(0x1104)],_0x52939f=_0x106b7c['closest'](_0xdac421(0xb11));if(!_0x52939f)return;const _0xd5297e=_0x52939f['querySelector'](_0xdac421(0x517)),_0x5f5679=_0x106b7c[_0xdac421(0x11a4)],_0x3deac8=_0x5f5679[_0xdac421(0x49a)](/@([\p{L}\w]*)$/u);if(_0x3deac8){const _0x591481=new Set(),_0x3608e1=_0x52939f['querySelector']('.post-nickname')?.[_0xdac421(0x15f)];if(_0x3608e1)_0x591481[_0xdac421(0xe82)](_0x3608e1);_0x52939f[_0xdac421(0x5d6)](_0xdac421(0xde8))[_0xdac421(0xf99)](_0x47a807=>{const _0xbea5d3=_0xdac421;_0x591481[_0xbea5d3(0xe82)](_0x47a807[_0xbea5d3(0x15f)]['replace'](':',''));}),_0x591481[_0xdac421(0x54b)](_0x28f30a['qzoneSettings'][_0xdac421(0x19a)]),_0xd5297e[_0xdac421(0xc43)]='';if(_0x591481['size']>0x0){const _0x1f0b2e=_0x3deac8[0x1];_0x591481[_0xdac421(0xf99)](_0x52ae6d=>{const _0xb97956=_0xdac421;if(_0x52ae6d[_0xb97956(0x1430)]()['includes'](_0x1f0b2e[_0xb97956(0x1430)]())){const _0x35b1b7=document['createElement'](_0xb97956(0xaa5));_0x35b1b7['className']=_0xb97956(0xc0a),_0x35b1b7[_0xb97956(0x15f)]=_0x52ae6d,_0x35b1b7[_0xb97956(0xf79)](_0xb97956(0xcfa),_0x5a4a6f=>{const _0x130b10=_0xb97956;_0x5a4a6f['preventDefault']();const _0x223296=_0x5f5679[_0x130b10(0xa6b)](0x0,_0x3deac8[_0x130b10(0x8d1)])+('@'+_0x52ae6d+'\x20');_0x106b7c['value']=_0x223296,_0xd5297e['style'][_0x130b10(0x701)]='none',_0x106b7c[_0x130b10(0x52b)]();}),_0xd5297e[_0xb97956(0x998)](_0x35b1b7);}}),_0xd5297e[_0xdac421(0x589)]['display']=_0xd5297e[_0xdac421(0x1492)][_0xdac421(0x9a1)]>0x0?'block':_0xdac421(0x5b1);}else _0xd5297e[_0xdac421(0x589)][_0xdac421(0x701)]=_0xdac421(0x5b1);}else _0xd5297e[_0xdac421(0x589)][_0xdac421(0x701)]=_0xdac421(0x5b1);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x63d))['addEventListener'](_0x2ea2d1(0x12d8),_0x13464d=>{const _0x2a68bc=_0x2ea2d1;if(_0x13464d[_0x2a68bc(0x1104)]['matches'](_0x2a68bc(0x46e))){const _0x27d991=_0x13464d[_0x2a68bc(0x1104)]['closest'](_0x2a68bc(0xb11));if(_0x27d991){const _0x4d037b=_0x27d991[_0x2a68bc(0x765)](_0x2a68bc(0x517));_0x4d037b&&setTimeout(()=>{const _0xd16141=_0x2a68bc;_0x4d037b['style']['display']=_0xd16141(0x5b1);},0xc8);}}});const _0x1fb6dc=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x146d)),_0x29ace5=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x192));_0x1fb6dc[_0x2ea2d1(0xf79)]('input',()=>{const _0x6aad28=_0x2ea2d1;if(!_0x28f30a['activeChatId']||!_0x28f30a[_0x6aad28(0x6ce)][_0x28f30a[_0x6aad28(0x11b9)]][_0x6aad28(0x1423)]){_0x29ace5[_0x6aad28(0x589)][_0x6aad28(0x701)]=_0x6aad28(0x5b1);return;}const _0x152dfe=_0x28f30a[_0x6aad28(0x6ce)][_0x28f30a['activeChatId']],_0x51a4a4=_0x1fb6dc[_0x6aad28(0x11a4)],_0x1b98f6=_0x51a4a4[_0x6aad28(0x49a)](/@([\p{L}\w]*)$/u);if(_0x1b98f6){const _0x499832=_0x152dfe['settings'][_0x6aad28(0xa28)]||'我',_0xd0b15c=_0x152dfe[_0x6aad28(0x10f2)][_0x6aad28(0x11c6)](_0x4141f4=>_0x4141f4[_0x6aad28(0x8a8)])[_0x6aad28(0xebc)](_0x3cc217=>_0x3cc217!==_0x499832);_0x29ace5[_0x6aad28(0xc43)]='';if(_0xd0b15c['length']>0x0){const _0x55e553=_0x1b98f6[0x1];_0xd0b15c[_0x6aad28(0xf99)](_0xd9e433=>{const _0x298a72=_0x6aad28;if(_0xd9e433[_0x298a72(0x1430)]()[_0x298a72(0x138a)](_0x55e553[_0x298a72(0x1430)]())){const _0x3d3666=document['createElement'](_0x298a72(0xaa5));_0x3d3666[_0x298a72(0xdd1)]=_0x298a72(0xc0a),_0x3d3666[_0x298a72(0x15f)]=_0xd9e433,_0x3d3666['addEventListener'](_0x298a72(0xcfa),_0x57c89f=>{const _0x5efcba=_0x298a72;_0x57c89f[_0x5efcba(0x10bd)]();const _0x475c7f=_0x51a4a4[_0x5efcba(0xa6b)](0x0,_0x1b98f6['index'])+('@'+_0xd9e433+'\x20');_0x1fb6dc['value']=_0x475c7f,_0x29ace5[_0x5efcba(0x589)][_0x5efcba(0x701)]=_0x5efcba(0x5b1),_0x1fb6dc[_0x5efcba(0x52b)]();}),_0x29ace5['appendChild'](_0x3d3666);}}),_0x29ace5[_0x6aad28(0x589)][_0x6aad28(0x701)]=_0x29ace5[_0x6aad28(0x1492)][_0x6aad28(0x9a1)]>0x0?_0x6aad28(0x13f7):_0x6aad28(0x5b1);}else _0x29ace5[_0x6aad28(0x589)][_0x6aad28(0x701)]=_0x6aad28(0x5b1);}else _0x29ace5[_0x6aad28(0x589)]['display']=_0x6aad28(0x5b1);}),_0x1fb6dc[_0x2ea2d1(0xf79)](_0x2ea2d1(0x845),()=>{setTimeout(()=>{const _0x4f1346=_0x1937;_0x29ace5[_0x4f1346(0x589)][_0x4f1346(0x701)]=_0x4f1346(0x5b1);},0xc8);}),document[_0x2ea2d1(0x2ec)]('publish-to-announcement-btn')['addEventListener']('click',_0x4f0108),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x62e))[_0x2ea2d1(0xf79)]('click',_0x15093e),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x4c3))[_0x2ea2d1(0xf79)]('click',()=>{const _0x124c3d=_0x2ea2d1;document['getElementById'](_0x124c3d(0x14a0))[_0x124c3d(0xff6)][_0x124c3d(0x1424)](_0x124c3d(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x24e))['addEventListener'](_0x2ea2d1(0x1177),_0x2e8194=>{const _0x47b522=_0x2ea2d1;if(_0x2e8194['target']['classList'][_0x47b522(0xe9a)](_0x47b522(0x1109))){const _0x12680e=_0x2e8194[_0x47b522(0x1104)][_0x47b522(0xe93)][_0x47b522(0x72d)];_0x12680e&&_0x54d174(_0x12680e);}}),document[_0x2ea2d1(0x2ec)]('announcement-action-pin')['addEventListener'](_0x2ea2d1(0x1177),_0x21b47f),document['getElementById'](_0x2ea2d1(0x882))['addEventListener'](_0x2ea2d1(0x1177),_0x429863),document[_0x2ea2d1(0x2ec)]('announcement-action-cancel')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x3d7925=_0x2ea2d1;document[_0x3d7925(0x2ec)]('announcement-actions-modal')[_0x3d7925(0xff6)][_0x3d7925(0x1424)]('visible');}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x279))[_0x2ea2d1(0xf79)]('click',()=>{const _0x54bf66=_0x2ea2d1;document[_0x54bf66(0x2ec)]('global-css-input')[_0x54bf66(0x11a4)]='';}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1524))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x32dd45),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xfc4))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x1620e6=_0x2ea2d1;_0x17ec27(_0x1620e6(0x120a));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xbcd))['addEventListener'](_0x2ea2d1(0x1177),_0x26eba6),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x4bc))['addEventListener'](_0x2ea2d1(0x1177),_0x3e17ce),document[_0x2ea2d1(0x2ec)]('memory-list-container')['addEventListener'](_0x2ea2d1(0x1177),_0x3ca578=>{const _0x3141d1=_0x2ea2d1,_0x52a16e=_0x3ca578[_0x3141d1(0x1104)][_0x3141d1(0x3f2)](_0x3141d1(0x2f8));if(_0x52a16e){_0x5d3a06(_0x52a16e[_0x3141d1(0xe93)][_0x3141d1(0xe87)],parseInt(_0x52a16e['dataset'][_0x3141d1(0x66f)]));return;}const _0x2b3358=_0x3ca578[_0x3141d1(0x1104)][_0x3141d1(0x3f2)](_0x3141d1(0xc55));if(_0x2b3358){_0x251305(_0x2b3358[_0x3141d1(0xe93)][_0x3141d1(0xe87)],parseInt(_0x2b3358['dataset']['memoryTimestamp']));return;}}),document['getElementById']('gomoku-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x27d058),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x2d5))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x290b85);const _0x16ae8a=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x7cc));_0x16ae8a[_0x2ea2d1(0xf79)](_0x2ea2d1(0x6fa),_0xce7651),_0x16ae8a[_0x2ea2d1(0xf79)](_0x2ea2d1(0x758),()=>_0x3ca98d(_0x28f30a[_0x2ea2d1(0x11b9)])),_0x16ae8a[_0x2ea2d1(0xf79)]('click',_0x4a89d7),document['getElementById']('add-countdown-btn')['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x45b86f=_0x2ea2d1;document[_0x45b86f(0x2ec)]('countdown-title-input')[_0x45b86f(0x11a4)]='',document[_0x45b86f(0x2ec)]('countdown-date-input')[_0x45b86f(0x11a4)]='',document[_0x45b86f(0x2ec)]('create-countdown-modal')[_0x45b86f(0xff6)]['add'](_0x45b86f(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xdbc))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x127f88=_0x2ea2d1;document['getElementById'](_0x127f88(0x3ad))[_0x127f88(0xff6)]['remove'](_0x127f88(0x149d));}),document['getElementById']('edit-call-message-btn')['addEventListener']('click',_0x49851c),document[_0x2ea2d1(0x2ec)]('delete-call-message-btn')['addEventListener'](_0x2ea2d1(0x1177),_0x30fb6b),document['getElementById'](_0x2ea2d1(0x12ee))['addEventListener'](_0x2ea2d1(0x1177),_0x1d49ce),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xdbf))['addEventListener'](_0x2ea2d1(0x1177),_0x503dba),document[_0x2ea2d1(0x2ec)]('cancel-ai-response-editor-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x225ce8=_0x2ea2d1;document[_0x225ce8(0x2ec)](_0x225ce8(0x117d))[_0x225ce8(0xff6)][_0x225ce8(0x1424)]('visible');}),document['getElementById'](_0x2ea2d1(0x8ab))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x599b65),document[_0x2ea2d1(0x2ec)]('add-ai-response-block-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x50d9ad=_0x2ea2d1,_0x5f5b4f=document['getElementById'](_0x50d9ad(0x51d)),_0x468f66=_0x1c4fcf(_0x50d9ad(0x736));_0x5f5b4f[_0x50d9ad(0x998)](_0x468f66),_0x468f66[_0x50d9ad(0x765)]('textarea')['focus']();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x938))[_0x2ea2d1(0xf79)]('click',_0x1659a6),document[_0x2ea2d1(0x2ec)]('close-my-avatar-library-btn')[_0x2ea2d1(0xf79)]('click',_0x24609b),document['getElementById']('add-my-avatar-url-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x54f0ca),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x12fa))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x1a148c=_0x2ea2d1;document[_0x1a148c(0x2ec)]('my-avatar-upload-input')[_0x1a148c(0x1177)]();}),document['getElementById'](_0x2ea2d1(0xc41))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x535a2e),document['getElementById'](_0x2ea2d1(0x4f1))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x36c7ca=_0x2ea2d1,_0x506d83=_0x36c7ca(0x464),_0x48cdd7=await _0x33419a(_0x36c7ca(0x1229),_0x506d83,'',_0x36c7ca(0x382));_0x48cdd7&&_0x48cdd7['trim']()&&await _0x21fe64(_0x48cdd7);}),document[_0x2ea2d1(0x2ec)]('open-shopping-btn')[_0x2ea2d1(0xf79)]('click',_0x79b711),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x298))[_0x2ea2d1(0xf79)]('click',()=>_0x17ec27('chat-interface-screen')),document[_0x2ea2d1(0x2ec)]('go-to-cart-btn')[_0x2ea2d1(0xf79)]('click',_0x34b0a8),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x6ba))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x79b711),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x615))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x43b2b6),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x920))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x1fa1ad=_0x2ea2d1;document[_0x1fa1ad(0x2ec)](_0x1fa1ad(0x680))['classList'][_0x1fa1ad(0x1424)](_0x1fa1ad(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1141))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x4586f8=_0x2ea2d1;_0x2228a2=!_0x2228a2;const _0x41b874=document[_0x4586f8(0x2ec)](_0x4586f8(0x1141)),_0x32d1c3=document[_0x4586f8(0x2ec)](_0x4586f8(0xdaa)),_0x17e859=document['getElementById']('product-grid');_0x41b874[_0x4586f8(0x589)][_0x4586f8(0x49c)]=_0x2228a2?_0x4586f8(0xa94):_0x4586f8(0x13df),_0x2228a2?(_0x32d1c3[_0x4586f8(0x589)]['display']=_0x4586f8(0xc67),_0x17e859[_0x4586f8(0x589)]['paddingBottom']=_0x4586f8(0xcbf)):(_0x32d1c3[_0x4586f8(0x589)]['display']=_0x4586f8(0x5b1),_0x17e859[_0x4586f8(0x589)]['paddingBottom']='',_0x5936d4['clear'](),document[_0x4586f8(0x5d6)]('.product-item.selected')[_0x4586f8(0xf99)](_0x4da621=>_0x4da621[_0x4586f8(0xff6)][_0x4586f8(0x1424)](_0x4586f8(0xba2))),document[_0x4586f8(0x2ec)]('delete-selected-products-btn')[_0x4586f8(0x15f)]=_0x4586f8(0xd4f),document[_0x4586f8(0x2ec)](_0x4586f8(0xbff))[_0x4586f8(0x13b8)]=![]),_0x275258(),_0x1b1a8c();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xa90))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{_0x2228a2?_0x2a7440(null):alert('请先点击扳手图标进入管理模式，才能添加新商品。');}),document['getElementById'](_0x2ea2d1(0x129e))[_0x2ea2d1(0xf79)]('click',async _0x2a6b02=>{const _0xc5027b=_0x2ea2d1,_0x567d70=_0x2a6b02['target']['closest'](_0xc5027b(0x108b));if(!_0x567d70)return;const _0x231553=parseInt(_0x567d70[_0xc5027b(0xe93)]['id']);if(isNaN(_0x231553))return;if(_0x2228a2){if(_0x2a6b02[_0xc5027b(0x1104)]['classList']['contains'](_0xc5027b(0xc8c))){_0x2a7440(_0x231553);return;}if(_0x2a6b02[_0xc5027b(0x1104)][_0xc5027b(0xff6)][_0xc5027b(0xe9a)](_0xc5027b(0x801))){const _0x26feff=await _0x5b9d83[_0xc5027b(0x120e)]['get'](_0x231553);if(!_0x26feff)return;const _0x4c34a8=await _0x4436ba(_0xc5027b(0x4f6),'确定要永久删除商品\x20“'+_0x26feff['name']+_0xc5027b(0x52e),{'confirmButtonClass':_0xc5027b(0xd8f)});_0x4c34a8&&(await _0x5b9d83[_0xc5027b(0x120e)][_0xc5027b(0x54b)](_0x231553),await _0x275258(),alert(_0xc5027b(0xb0a)));return;}_0x567d70[_0xc5027b(0xff6)][_0xc5027b(0x14c8)]('selected');_0x5936d4['has'](_0x231553)?_0x5936d4[_0xc5027b(0x54b)](_0x231553):_0x5936d4['add'](_0x231553);document[_0xc5027b(0x2ec)](_0xc5027b(0xd72))[_0xc5027b(0x15f)]='删除\x20('+_0x5936d4[_0xc5027b(0x2d2)]+')';return;}if(_0x2a6b02[_0xc5027b(0x1104)][_0xc5027b(0xff6)][_0xc5027b(0xe9a)](_0xc5027b(0x147f))){const _0x1aabf2=await _0x5b9d83[_0xc5027b(0x120e)][_0xc5027b(0x6b5)](_0x231553);_0x1aabf2['variations']&&_0x1aabf2['variations'][_0xc5027b(0x9a1)]>0x0?_0x4047a7(_0x231553):(await _0x229d95(_0x231553),await _0x34d596('成功',_0xc5027b(0x112d)));return;}_0x567d70[_0xc5027b(0xe9a)](_0x2a6b02[_0xc5027b(0x1104)])&&console['log'](_0xc5027b(0x3d3)+_0x231553);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xbea))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x29c2a6=>{const _0x34fbd9=_0x2ea2d1,_0x59e43e=_0x29c2a6[_0x34fbd9(0x1104)];_0x59e43e[_0x34fbd9(0xff6)]['contains'](_0x34fbd9(0x567))&&_0x2aeca3(parseInt(_0x59e43e[_0x34fbd9(0xe93)]['id']),-0x1),_0x59e43e[_0x34fbd9(0xff6)][_0x34fbd9(0xe9a)]('increase-qty-btn')&&_0x2aeca3(parseInt(_0x59e43e[_0x34fbd9(0xe93)]['id']),0x1),_0x59e43e[_0x34fbd9(0xff6)][_0x34fbd9(0xe9a)](_0x34fbd9(0x1138))&&_0x43c50b();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x7e5))['addEventListener'](_0x2ea2d1(0x1177),async()=>{const _0x204db7=_0x2ea2d1;if(_0x54e872['length']===0x0)return;const _0x22f854=await _0x4436ba(_0x204db7(0xd98),'确定要清空购物车中的所有商品吗？');_0x22f854&&(_0x54e872=[],_0x48b874(),_0x5d0d8b());}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xde2))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),function(_0x1d0808){const _0x1b76fc=_0x2ea2d1;document[_0x1b76fc(0x5d6)](_0x1b76fc(0x798))['forEach'](_0x584b63=>{const _0x385288=_0x1b76fc;_0x584b63[_0x385288(0x13b8)]=_0x1d0808['target'][_0x385288(0x13b8)];}),_0x43c50b();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x14f1))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x2bb1cc=_0x2ea2d1;document[_0x2bb1cc(0x2ec)](_0x2bb1cc(0x4bd))['classList'][_0x2bb1cc(0x1424)](_0x2bb1cc(0x149d));}),document['getElementById'](_0x2ea2d1(0xfb6))['addEventListener'](_0x2ea2d1(0x1177),_0x472a33),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xe19))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x43c07c=>{const _0x30e615=_0x2ea2d1,_0x20a2b1=_0x43c07c[_0x30e615(0x1104)][_0x30e615(0x8d6)][0x0];if(_0x20a2b1){const _0x1309ce=new FileReader();_0x1309ce['onload']=_0x26588e=>{const _0x42b52a=_0x30e615;document[_0x42b52a(0x2ec)](_0x42b52a(0x5d9))[_0x42b52a(0xce4)]=_0x26588e[_0x42b52a(0x1104)][_0x42b52a(0x42a)];},_0x1309ce['readAsDataURL'](_0x20a2b1);}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x156b))['addEventListener']('click',_0x214815=>{const _0x43abac=_0x2ea2d1,_0x3af871=_0x214815[_0x43abac(0x1104)][_0x43abac(0x3f2)]('.gift-card');if(_0x3af871){const _0x4b2d18=_0x3af871[_0x43abac(0x3f2)](_0x43abac(0x124c));_0x4b2d18&&_0x1fb062(parseInt(_0x4b2d18[_0x43abac(0xe93)]['timestamp']));}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x968))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0xe9d91c=_0x2ea2d1;document[_0xe9d91c(0x2ec)](_0xe9d91c(0x18e))[_0xe9d91c(0xff6)][_0xe9d91c(0x1424)](_0xe9d91c(0x149d));}),document['getElementById']('confirm-gift-recipient-btn')[_0x2ea2d1(0xf79)]('click',async()=>{const _0x264368=_0x2ea2d1,_0x3982df=Array['from'](document[_0x264368(0x5d6)](_0x264368(0xb1e)))[_0x264368(0x11c6)](_0x1013ce=>_0x1013ce[_0x264368(0xe93)][_0x264368(0xa9c)]);if(_0x3982df['length']===0x0){alert('请至少选择一位收礼人。');return;}const _0xe4d748=_0x54e872[_0x264368(0xebc)](_0x416369=>document['querySelector']('.cart-item-checkbox[data-id=\x22'+_0x416369['productId']+'\x22]:checked'));await _0x5b0e4e(_0xe4d748,_0x3982df),document[_0x264368(0x2ec)](_0x264368(0x18e))['classList'][_0x264368(0x1424)](_0x264368(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1181))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x18e752=>{const _0x317af3=_0x2ea2d1,_0x17144e=_0x18e752[_0x317af3(0x1104)][_0x317af3(0x3f2)](_0x317af3(0x973));_0x17144e&&_0x17144e[_0x317af3(0xff6)][_0x317af3(0x14c8)]('selected');}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x116e))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),function(_0x1fe817){const _0x2eb162=_0x2ea2d1,_0x334950=_0x1fe817[_0x2eb162(0x1104)][_0x2eb162(0x13b8)];document[_0x2eb162(0x5d6)](_0x2eb162(0xb29))['forEach'](_0x47a844=>{const _0x27dab3=_0x2eb162;_0x47a844[_0x27dab3(0xff6)]['toggle']('selected',_0x334950);});}),document[_0x2ea2d1(0x2ec)]('regenerate-btn')['addEventListener']('click',_0x1dc26a),document['getElementById'](_0x2ea2d1(0xfa7))[_0x2ea2d1(0xf79)]('click',_0x4fedd0),document['getElementById'](_0x2ea2d1(0x4dd))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x28f5ce),document['getElementById']('test-sound-btn')[_0x2ea2d1(0xf79)]('click',()=>{const _0x2e8bf3=_0x2ea2d1,_0xc6939f=document[_0x2e8bf3(0x2ec)]('notification-sound-player'),_0x1c19f9=document[_0x2e8bf3(0x2ec)](_0x2e8bf3(0x10f8))[_0x2e8bf3(0x11a4)][_0x2e8bf3(0x97e)]()||_0xa4eded;_0xc6939f[_0x2e8bf3(0xce4)]=_0x1c19f9,_0xc6939f[_0x2e8bf3(0x23f)]()['catch'](_0x2a5cf1=>alert(_0x2e8bf3(0x3fe)));}),document['getElementById'](_0x2ea2d1(0xaa2))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0xb656dd=_0x2ea2d1;document[_0xb656dd(0x2ec)](_0xb656dd(0x10f8))[_0xb656dd(0x11a4)]='',alert(_0xb656dd(0x231));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x436))['addEventListener']('click',_0x19546e=>{const _0x28696f=_0x2ea2d1,_0x2e388c=_0x19546e[_0x28696f(0x1104)];_0x2e388c[_0x28696f(0xff6)][_0x28696f(0xe9a)](_0x28696f(0x607))&&_0x52f8aa(_0x2e388c),_0x2e388c['classList'][_0x28696f(0xe9a)](_0x28696f(0xd79))&&_0x971f49(_0x2e388c);}),document['getElementById'](_0x2ea2d1(0x599))[_0x2ea2d1(0xf79)]('click',_0x45b89b),document['getElementById']('cancel-music-search-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x209d6c=_0x2ea2d1;document['getElementById'](_0x209d6c(0x1055))[_0x209d6c(0xff6)][_0x209d6c(0x1424)](_0x209d6c(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x599))['addEventListener'](_0x2ea2d1(0x1177),_0x45b89b),document[_0x2ea2d1(0x2ec)]('cancel-music-search-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x616c60=_0x2ea2d1;document[_0x616c60(0x2ec)]('music-search-results-modal')['classList'][_0x616c60(0x1424)](_0x616c60(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x181))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),function(_0x5e8d92){const _0x5ebc36=_0x2ea2d1;document[_0x5ebc36(0x5d6)]('#search-results-list\x20.music-search-checkbox')[_0x5ebc36(0xf99)](_0x68195a=>{const _0x528001=_0x5ebc36;_0x68195a[_0x528001(0x13b8)]=_0x5e8d92[_0x528001(0x1104)][_0x528001(0x13b8)];});}),document[_0x2ea2d1(0x2ec)]('search-results-list')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x454c40=>{const _0x548cde=_0x2ea2d1,_0x44e8fa=_0x454c40[_0x548cde(0x1104)][_0x548cde(0x3f2)]('.search-result-item');if(_0x44e8fa){const _0x50256f=_0x44e8fa[_0x548cde(0x765)](_0x548cde(0x893));_0x50256f&&(_0x454c40['target']!==_0x50256f&&(_0x50256f[_0x548cde(0x13b8)]=!_0x50256f['checked']));}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x314))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x2d8807=_0x2ea2d1,_0x5bdac7=document['querySelectorAll']('.music-search-checkbox:checked');if(_0x5bdac7['length']===0x0){alert(_0x2d8807(0x13b5));return;}document['getElementById']('music-search-results-modal')[_0x2d8807(0xff6)][_0x2d8807(0x1424)]('visible'),await _0x34d596(_0x2d8807(0x13e4),_0x2d8807(0x538)+_0x5bdac7[_0x2d8807(0x9a1)]+_0x2d8807(0x111d));const _0x31704e=Array[_0x2d8807(0x13d1)](_0x5bdac7)[_0x2d8807(0x11c6)](_0x4fbc08=>JSON[_0x2d8807(0xd91)](_0x4fbc08[_0x2d8807(0x3f2)](_0x2d8807(0x1572))[_0x2d8807(0xe93)][_0x2d8807(0x75a)]));let _0x28da6d=0x0,_0x597999=[];const _0x522a06=_0x31704e[_0x2d8807(0x11c6)](_0x2cc7ae=>_0x4376e7(_0x2cc7ae)),_0x553ac3=await Promise[_0x2d8807(0xa92)](_0x522a06);_0x553ac3[_0x2d8807(0xf99)]((_0xed962d,_0x50742a)=>{const _0x22a669=_0x2d8807;_0xed962d?(_0x79cac3['playlist'][_0x22a669(0x367)](_0xed962d),_0x28da6d++):_0x597999['push'](_0x31704e[_0x50742a][_0x22a669(0xe36)]);});_0x28da6d>0x0&&(await _0x10fa70(),_0x1f11de(),_0x79cac3['currentIndex']===-0x1&&(_0x79cac3[_0x2d8807(0xf35)]=_0x79cac3[_0x2d8807(0x5fd)]['length']-_0x28da6d,_0xdde111()));let _0x15ec04=_0x2d8807(0x783)+_0x28da6d+'\x20首歌曲。';_0x597999[_0x2d8807(0x9a1)]>0x0&&(_0x15ec04+='\x0a\x0a'+_0x597999[_0x2d8807(0x9a1)]+_0x2d8807(0x81d)+_0x597999[_0x2d8807(0xbad)](_0x2d8807(0x1e1))),await _0x34d596(_0x2d8807(0x3b8),_0x15ec04);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xfce))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x1f6f5b=_0x2ea2d1;document[_0x1f6f5b(0x2ec)]('music-visual-container')[_0x1f6f5b(0xff6)][_0x1f6f5b(0x14c8)](_0x1f6f5b(0x10cb));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x599))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x45b89b),document['getElementById'](_0x2ea2d1(0x423))['addEventListener']('click',()=>{const _0xaba8c5=_0x2ea2d1;document[_0xaba8c5(0x2ec)](_0xaba8c5(0x1055))[_0xaba8c5(0xff6)][_0xaba8c5(0x1424)]('visible');}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x6ac))['addEventListener'](_0x2ea2d1(0x1177),_0x14664a=>{const _0x2cd1c5=_0x2ea2d1,_0x1fd192=_0x14664a[_0x2cd1c5(0x1104)]['closest'](_0x2cd1c5(0x1572));if(_0x1fd192&&_0x1fd192['dataset']['songJson']){const _0x1d671a=JSON[_0x2cd1c5(0xd91)](_0x1fd192[_0x2cd1c5(0xe93)][_0x2cd1c5(0x75a)]);handleSearchResultClick(_0x1d671a);}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x4d7))[_0x2ea2d1(0xf79)]('click',_0x3ad699),document['getElementById'](_0x2ea2d1(0x2c0))['addEventListener'](_0x2ea2d1(0x1177),_0x12a1c3),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x399))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x4f3f67),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xa2c))['addEventListener']('click',_0x72e25c),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x558))['addEventListener']('change',()=>{const _0x39113e=_0x2ea2d1;_0x28f30a[_0x39113e(0x1062)]['showStatusBar']=document[_0x39113e(0x2ec)]('status-bar-toggle-switch')[_0x39113e(0x13b8)],_0x435075();}),document['getElementById'](_0x2ea2d1(0x373))['addEventListener'](_0x2ea2d1(0x1177),_0x2e0bb3),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xc4f))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x30d56e=_0x2ea2d1;document[_0x30d56e(0x2ec)]('clear-posts-modal')[_0x30d56e(0xff6)][_0x30d56e(0x1424)](_0x30d56e(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xe6c))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x29c0d7),document[_0x2ea2d1(0x2ec)]('clear-posts-list')[_0x2ea2d1(0xf79)]('click',_0x2d21aa=>{const _0x2da3d2=_0x2ea2d1,_0x1673b=_0x2d21aa[_0x2da3d2(0x1104)][_0x2da3d2(0x3f2)](_0x2da3d2(0xf9f));_0x1673b&&_0x1673b[_0x2da3d2(0xff6)][_0x2da3d2(0x14c8)]('selected');}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x6ca))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),async _0x2ef8c6=>{const _0x94825e=_0x2ea2d1,_0x101de1=_0x2ef8c6[_0x94825e(0x1104)][_0x94825e(0x8d6)][0x0];if(_0x101de1){const _0x4040f9=await new Promise(_0x5a6beb=>{const _0x192c55=_0x94825e,_0x96a079=new FileReader();_0x96a079['onload']=()=>_0x5a6beb(_0x96a079[_0x192c55(0x42a)]),_0x96a079[_0x192c55(0x60e)](_0x101de1);});_0x28f30a['globalSettings']['globalChatBackground']=_0x4040f9,_0x1bf18e();}_0x2ef8c6[_0x94825e(0x1104)][_0x94825e(0x11a4)]=null;}),document[_0x2ea2d1(0x2ec)]('remove-global-bg-btn')['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x3f4256=_0x2ea2d1;_0x28f30a[_0x3f4256(0x1062)][_0x3f4256(0x9b7)]='',_0x1bf18e();}),document['getElementById'](_0x2ea2d1(0x1004))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x2ca76b=_0x2ea2d1;_0x1f5717&&(_0x28f30a[_0x2ca76b(0x1062)][_0x2ca76b(0x638)]=_0x1f5717),_0x28f30a['globalSettings']['globalCss']=document[_0x2ca76b(0x2ec)](_0x2ca76b(0x1247))[_0x2ca76b(0x11a4)]['trim'](),_0x28f30a['globalSettings']['notificationSoundUrl']=document[_0x2ca76b(0x2ec)](_0x2ca76b(0x10f8))['value'][_0x2ca76b(0x97e)](),_0x28f30a[_0x2ca76b(0x1062)][_0x2ca76b(0x1f3)]=document['getElementById'](_0x2ca76b(0x558))['checked'],await _0x5b9d83[_0x2ca76b(0x1062)][_0x2ca76b(0x7c3)](_0x28f30a[_0x2ca76b(0x1062)]),_0x1993ff(),_0x1f5717=null,_0x3b4945(),_0x276bb0(_0x28f30a['globalSettings'][_0x2ca76b(0x1099)]),_0x435075(),alert(_0x2ca76b(0xd93)),_0x17ec27(_0x2ca76b(0x436));}),document[_0x2ea2d1(0x2ec)]('upload-global-bg-url-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x20d22c=_0x2ea2d1,_0x3c805a=await _0x33419a(_0x20d22c(0x246),_0x20d22c(0x99d),'',_0x20d22c(0x6d1));if(_0x3c805a&&_0x3c805a['trim']())_0x28f30a[_0x20d22c(0x1062)][_0x20d22c(0x9b7)]=_0x3c805a['trim'](),_0x1bf18e();else _0x3c805a!==null&&alert(_0x20d22c(0xfbc));}),document[_0x2ea2d1(0x2ec)]('upload-ephone-bg-url-btn')['addEventListener'](_0x2ea2d1(0x1177),async()=>{const _0x238cb4=_0x2ea2d1,_0x2e1ba3=await _0x33419a(_0x238cb4(0x5a9),_0x238cb4(0xfe7),'',_0x238cb4(0x6d1));if(_0x2e1ba3&&_0x2e1ba3[_0x238cb4(0x97e)]())_0x1f5717=_0x2e1ba3['trim'](),_0x1bf18e();else _0x2e1ba3!==null&&alert(_0x238cb4(0xfbc));}),document['getElementById'](_0x2ea2d1(0x2a8))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x467876=_0x2ea2d1,_0x4a080b=await _0x33419a(_0x467876(0xfa8),_0x467876(0xc6d),'',_0x467876(0x6d1));if(_0x4a080b&&_0x4a080b[_0x467876(0x97e)]())_0x28f30a[_0x467876(0x1062)]['cphoneWallpaper']=_0x4a080b[_0x467876(0x97e)](),_0x1bf18e();else _0x4a080b!==null&&alert(_0x467876(0xfbc));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xeac))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0xac229c=_0x2ea2d1;_0x1f5717=null,_0x28f30a[_0xac229c(0x1062)]['wallpaper']='',_0x1bf18e();}),document['getElementById'](_0x2ea2d1(0x12da))[_0x2ea2d1(0xf79)]('click',()=>{const _0x274ad9=_0x2ea2d1;_0x28f30a['globalSettings'][_0x274ad9(0x152d)]='',_0x1bf18e();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1147))['addEventListener'](_0x2ea2d1(0x217),_0x4bc387),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1438))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x26b130),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x14fc))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x212377),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x6fd))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x44cade),document['getElementById'](_0x2ea2d1(0x3bb))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x35aa47),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x572))[_0x2ea2d1(0xf79)]('click',_0x541882),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xa79))[_0x2ea2d1(0xf79)]('change',_0xf7d0eb),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x365))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x3ec693),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x459))[_0x2ea2d1(0xf79)]('click',_0x390e5b),document[_0x2ea2d1(0x2ec)]('manage-sticker-categories-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x32dcf5),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x134b))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x4fd83f=_0x2ea2d1;document[_0x4fd83f(0x2ec)]('sticker-category-manager-modal')[_0x4fd83f(0xff6)][_0x4fd83f(0x1424)](_0x4fd83f(0x149d)),_0xfb88c2();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x68f))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0xf5e3dc),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x103d))['addEventListener'](_0x2ea2d1(0x1177),_0x56a706=>{const _0x2b174a=_0x2ea2d1;if(_0x56a706['target'][_0x2b174a(0xff6)][_0x2b174a(0xe9a)](_0x2b174a(0x1d2))){const _0x1c0a24=parseInt(_0x56a706[_0x2b174a(0x1104)][_0x2b174a(0xe93)]['id']);_0x1ddd46(_0x1c0a24);}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x917))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x4365b6=>{const _0x58846f=_0x2ea2d1;if(_0x4365b6[_0x58846f(0x1104)][_0x58846f(0xff6)][_0x58846f(0xe9a)]('sticker-category-tab')){const _0x33fc12=_0x4365b6[_0x58846f(0x1104)][_0x58846f(0xe93)][_0x58846f(0x10ce)],_0x186197=_0x33fc12!==_0x58846f(0xa92)&&_0x33fc12!==_0x58846f(0x17c)?parseInt(_0x33fc12):_0x33fc12;_0x3674b6(_0x186197);}}),document['getElementById'](_0x2ea2d1(0x1b1))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x1dae09),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xb33))['addEventListener'](_0x2ea2d1(0x1177),_0x46f0cd),document['getElementById'](_0x2ea2d1(0xeb0))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x2b6d2f=_0x2ea2d1;document[_0x2b6d2f(0x2ec)](_0x2b6d2f(0xb36))[_0x2b6d2f(0x1177)]();}),document['getElementById'](_0x2ea2d1(0xb36))[_0x2ea2d1(0xf79)]('change',_0x48af9e=>{const _0x22729f=_0x2ea2d1,_0x288ed2=_0x48af9e[_0x22729f(0x1104)][_0x22729f(0x8d6)][0x0];_0x288ed2&&_0x4c7de6(_0x288ed2),_0x48af9e[_0x22729f(0x1104)][_0x22729f(0x11a4)]=null;}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1551))[_0x2ea2d1(0xf79)]('click',()=>_0x282fff()),document[_0x2ea2d1(0x2ec)]('add-char-diary-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>openDiaryEditor()),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xc3c))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x38db0f),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xcf4))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x59968c),document['getElementById']('favorite-memo-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x5c7b45),document['getElementById'](_0x2ea2d1(0xf88))['addEventListener']('click',()=>{const _0x150e8e=_0x2ea2d1,_0xdae7f2=document['getElementById'](_0x150e8e(0x5c1))['innerText'];_0x1f9eee(_0xdae7f2,'日记内容已复制！');}),document[_0x2ea2d1(0x2ec)]('copy-memo-content-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x2560ab=_0x2ea2d1,_0x21ffb5=document[_0x2560ab(0x2ec)]('char-memo-detail-content')['value'];_0x1f9eee(_0x21ffb5,_0x2560ab(0x58a));}),document[_0x2ea2d1(0x2ec)]('copy-article-content-btn')['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x365c75=_0x2ea2d1,_0x39d1fd=document[_0x365c75(0x2ec)](_0x365c75(0x7e9))[_0x365c75(0xc02)];_0x1f9eee(_0x39d1fd,_0x365c75(0xd0b));}),document[_0x2ea2d1(0x2ec)]('regenerate-char-qq-btn')[_0x2ea2d1(0xf79)]('click',async()=>{const _0x1cf4cf=_0x2ea2d1;_0x34d596(_0x1cf4cf(0x11cd),_0x1cf4cf(0x1123));try{await Promise[_0x1cf4cf(0xa92)]([_0x2b6562(),_0x6ebfcb()]),console[_0x1cf4cf(0x415)](_0x1cf4cf(0xb3d));}catch(_0x433587){console[_0x1cf4cf(0x1518)](_0x1cf4cf(0x263),_0x433587),await _0x34d596('操作失败',_0x1cf4cf(0x1317)+_0x433587[_0x1cf4cf(0x13bc)]);}}),document['getElementById'](_0x2ea2d1(0x3b2))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x14025e=>{const _0x21a12f=_0x2ea2d1,_0x3f54f7=_0x14025e[_0x21a12f(0x1104)][_0x21a12f(0x3f2)](_0x21a12f(0x80a));if(_0x3f54f7&&_0x3f54f7[_0x21a12f(0xe93)][_0x21a12f(0x174)]){const _0x2b1f1f=parseInt(_0x3f54f7[_0x21a12f(0xe93)][_0x21a12f(0x174)]);!isNaN(_0x2b1f1f)&&_0x237dee(_0x2b1f1f);}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x9a4))['addEventListener']('click',()=>{const _0x5246b7=_0x2ea2d1;_0x38e7ae(_0x5246b7(0xcb9));});const _0xee3a9d=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xaad)),_0x45ff74=()=>{const _0x4b81cc=_0x2ea2d1;if(_0x4a6199!=='private_user')return;if(_0xee3a9d['scrollTop']<0x1&&!_0x24e903){const _0x253e12=_0x28f30a[_0x4b81cc(0x6ce)][_0x579fa9]?.[_0x4b81cc(0x12c3)]['length']||0x0;_0x253e12>_0x2d3c48&&_0x40d28b();}};_0xee3a9d[_0x2ea2d1(0xf79)]('scroll',_0x45ff74),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x10e9))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{alert('这是模拟对话，无法发送消息哦~');}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1529))['addEventListener'](_0x2ea2d1(0x1177),_0x2443cd),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x13a0))['addEventListener']('click',_0x53f724=>{const _0x5b57d1=_0x2ea2d1,_0x3eb15a=_0x53f724['target'][_0x5b57d1(0x3f2)](_0x5b57d1(0xa59));if(_0x3eb15a&&_0x3eb15a[_0x5b57d1(0xe93)][_0x5b57d1(0x9cc)]){const _0x454925=_0x3eb15a[_0x5b57d1(0xe93)][_0x5b57d1(0x9cc)];_0x34d596(_0x5b57d1(0x2fb),_0x454925[_0x5b57d1(0x13ed)](/\n/g,_0x5b57d1(0xfd7)));}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x959))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x48b643),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x20a))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x97ebab),document[_0x2ea2d1(0x2ec)]('char-product-grid')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x35d299=>{const _0x1bf07d=_0x2ea2d1,_0x16c577=_0x35d299[_0x1bf07d(0x1104)][_0x1bf07d(0x3f2)](_0x1bf07d(0x251));if(_0x16c577&&_0x16c577[_0x1bf07d(0xe93)][_0x1bf07d(0x6a4)]){const _0x2e9d31=_0x16c577['dataset'][_0x1bf07d(0x6a4)];_0x34d596(_0x1bf07d(0x1176),_0x2e9d31['replace'](/\n/g,_0x1bf07d(0xfd7)));}}),window[_0x2ea2d1(0x187)]=_0x2e51cf,document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xcaf))[_0x2ea2d1(0xf79)]('click',_0x82952),document['getElementById'](_0x2ea2d1(0xb2f))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>_0x38e7ae(_0x2ea2d1(0x573))),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xeaf))[_0x2ea2d1(0xf79)]('click',_0x2e99f0),document['getElementById'](_0x2ea2d1(0x578))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x452d06),document[_0x2ea2d1(0x2ec)]('char-diary-detail-back-btn')['addEventListener']('click',()=>_0x38e7ae(_0x2ea2d1(0xf33))),document[_0x2ea2d1(0x2ec)]('regenerate-char-amap-btn')['addEventListener'](_0x2ea2d1(0x1177),_0x3bdf10),document[_0x2ea2d1(0x2ec)]('regenerate-char-usage-btn')['addEventListener'](_0x2ea2d1(0x1177),_0x4684f3),document['getElementById'](_0x2ea2d1(0x6b7))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x25074b),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x5ec))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x1cafbb),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x14bc))['addEventListener'](_0x2ea2d1(0x1177),_0x266ab4),document[_0x2ea2d1(0x2ec)]('regenerate-douban-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x266ab4),document[_0x2ea2d1(0x2ec)]('douban-detail-back-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>_0x17ec27(_0x2ea2d1(0x1122))),document['getElementById'](_0x2ea2d1(0x1d6))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x465643),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xf29))['addEventListener']('click',_0x590096),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1341))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),async _0x3d212c=>{const _0x344d21=_0x2ea2d1,_0x257b12=_0x3d212c[_0x344d21(0x1104)]['files'][0x0];if(_0x257b12){const _0xb316bf=await new Promise(_0x295029=>{const _0x14a7ac=_0x344d21,_0x3c4139=new FileReader();_0x3c4139[_0x14a7ac(0xf2d)]=()=>_0x295029(_0x3c4139[_0x14a7ac(0x42a)]),_0x3c4139[_0x14a7ac(0x60e)](_0x257b12);});_0x28f30a[_0x344d21(0x1062)][_0x344d21(0x152d)]=_0xb316bf,_0x1bf18e();}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1295))[_0x2ea2d1(0xf79)]('click',_0x4d6cc9=>{const _0x2e944d=_0x2ea2d1;if(_0x4d6cc9[_0x2e944d(0x1104)][_0x2e944d(0xff6)]['contains'](_0x2e944d(0x504))){const _0x35fb64=_0x4d6cc9[_0x2e944d(0x1104)][_0x2e944d(0x3f2)](_0x2e944d(0x584)),_0x571f82=_0x35fb64[_0x2e944d(0xe93)][_0x2e944d(0x1019)];_0x571f82&&_0x2f298d(_0x571f82,_0x2e944d(0xe1f),_0x35fb64);}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x14a9))[_0x2ea2d1(0xf79)]('click',()=>{const _0x1a2e4a=_0x2ea2d1;document[_0x1a2e4a(0x2ec)]('import-appearance-input')[_0x1a2e4a(0x1177)]();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1240))['addEventListener'](_0x2ea2d1(0x217),_0x3af270=>{const _0x1733c0=_0x2ea2d1,_0x8e5e81=_0x3af270[_0x1733c0(0x1104)][_0x1733c0(0x8d6)][0x0];_0x8e5e81&&_0x24f23a(_0x8e5e81),_0x3af270[_0x1733c0(0x1104)][_0x1733c0(0x11a4)]=null;}),document[_0x2ea2d1(0xf79)](_0x2ea2d1(0x3e2),()=>{const _0x4c3f80=_0x2ea2d1;document[_0x4c3f80(0x1105)]===_0x4c3f80(0x3c2)&&(localStorage[_0x4c3f80(0x1048)](_0x4c3f80(0x48f),Date[_0x4c3f80(0x487)]()),console['log'](_0x4c3f80(0xee7)));}),document[_0x2ea2d1(0x2ec)]('export-world-book-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x541b43),document['getElementById']('import-world-book-btn')['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x5dc93a=_0x2ea2d1;document[_0x5dc93a(0x2ec)]('import-world-book-input')[_0x5dc93a(0x1177)]();}),document['getElementById']('import-world-book-input')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x571d78=>{const _0x1949a8=_0x2ea2d1,_0x1f3ecf=_0x571d78[_0x1949a8(0x1104)][_0x1949a8(0x8d6)][0x0];_0x1f3ecf&&_0x266c60(_0x1f3ecf),_0x571d78[_0x1949a8(0x1104)][_0x1949a8(0x11a4)]=null;}),document[_0x2ea2d1(0x2ec)]('enable-ai-drawing-switch')['addEventListener'](_0x2ea2d1(0x217),async _0x562809=>{const _0x2198e9=_0x2ea2d1,_0x3e8b8d=_0x562809[_0x2198e9(0x1104)][_0x2198e9(0x13b8)];_0x28f30a[_0x2198e9(0x1062)][_0x2198e9(0x10fa)]=_0x3e8b8d,await _0x5b9d83[_0x2198e9(0x1062)]['put'](_0x28f30a[_0x2198e9(0x1062)]);const _0x1f91de=document[_0x2198e9(0x765)](_0x2198e9(0xa8b));if(_0x1f91de)switch(_0x1f91de['id']){case _0x2198e9(0x120a):_0xc55746(_0x28f30a['activeChatId']);break;case _0x2198e9(0xf4d):if(document[_0x2198e9(0x2ec)](_0x2198e9(0x11b2))['classList'][_0x2198e9(0xe9a)](_0x2198e9(0xd43)))_0x472608();if(document['getElementById'](_0x2198e9(0x1175))[_0x2198e9(0xff6)]['contains'](_0x2198e9(0xd43)))_0x5303e6();break;case _0x2198e9(0x1122):_0x37ff8e();break;case'douban-post-detail-screen':_0x18ed0e(_0x250bff);break;case _0x2198e9(0xfe4):const _0x3d6fb1=document[_0x2198e9(0x765)]('.char-screen.active');if(_0x3d6fb1)switch(_0x3d6fb1['id']){case _0x2198e9(0xc57):_0xcf12a8();break;case _0x2198e9(0xd24):_0x4eab6a();break;case _0x2198e9(0x1530):const _0x20c544=_0x28f30a[_0x2198e9(0x6ce)][_0x579fa9],_0xba7937=_0x20c544['simulatedBrowserHistory']||[],_0x574a62=_0xba7937[_0x2198e9(0x9a1)]>0x0?_0xba7937[_0x2198e9(0x9a1)]-0x1:0x0;_0x1385e8(_0xba7937[_0x574a62]);break;case _0x2198e9(0x115a):_0x25a30a();break;case'char-qq-screen':_0x254b80();break;case _0x2198e9(0xd9d):const _0x35c8b1=document['querySelector'](_0x2198e9(0xf1b))?.['dataset'][_0x2198e9(0x174)]||0x0;_0x237dee(parseInt(_0x35c8b1));break;}break;}_0x34d596(_0x2198e9(0x360),_0x2198e9(0x1133)+(_0x3e8b8d?'开启':'关闭')+'。');}),document['getElementById'](_0x2ea2d1(0xeda))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x418ff5),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xa55))['addEventListener']('click',()=>{_0x17ec27('chat-settings-screen');}),document[_0x2ea2d1(0x2ec)]('execute-search-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x40f8ca),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x586))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x531a13),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1367))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x51e35b),document['getElementById'](_0x2ea2d1(0xb74))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x41fbba),document[_0x2ea2d1(0x765)](_0x2ea2d1(0x13d3))[_0x2ea2d1(0xf79)]('click',_0x46e29d=>{const _0x56ca9a=_0x2ea2d1;if(_0x46e29d['target'][_0x56ca9a(0xff6)][_0x56ca9a(0xe9a)](_0x56ca9a(0xaaa))){const _0x52b5b2=parseInt(_0x46e29d[_0x56ca9a(0x1104)][_0x56ca9a(0xe93)]['id']);!isNaN(_0x52b5b2)&&_0x91ea9b(_0x52b5b2);}}),_0x23fa06(),window[_0x2ea2d1(0x175)]=_0x59ad88,document['getElementById'](_0x2ea2d1(0x39a))[_0x2ea2d1(0xf79)]('click',async()=>{const _0x13eddd=_0x2ea2d1,_0x443e90=await _0x33419a(_0x13eddd(0x2de),_0x13eddd(0x112f));if(_0x443e90&&_0x443e90[_0x13eddd(0x97e)]()){const _0x4f32da={'id':'preset_'+Date[_0x13eddd(0x487)](),'name':_0x443e90['trim'](),'content':[]};await _0x5b9d83[_0x13eddd(0x1504)]['add'](_0x4f32da),await _0x2ed701(),_0x104122(_0x4f32da['id']);}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x108d))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x4bff1f),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x14d4))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x323560=_0x2ea2d1,_0x37aad5=document['getElementById'](_0x323560(0x1362));_0x37aad5[_0x323560(0x765)]('p')&&(_0x37aad5['innerHTML']='');const _0x26a0bc=_0x2489be();_0x37aad5[_0x323560(0x998)](_0x26a0bc),_0x26a0bc[_0x323560(0x765)](_0x323560(0x88e))[_0x323560(0x52b)]();}),document[_0x2ea2d1(0x2ec)]('save-preset-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x2618e8=_0x2ea2d1;if(!_0x84d184)return;const _0x180a01=await _0x5b9d83[_0x2618e8(0x1504)]['get'](_0x84d184);if(!_0x180a01)return;const _0x3b9f2c=document[_0x2618e8(0x2ec)](_0x2618e8(0x4df))[_0x2618e8(0x11a4)]['trim']();if(!_0x3b9f2c){alert('预设名称不能为空！');return;}_0x180a01['name']=_0x3b9f2c,_0x180a01['categoryId']=parseInt(document[_0x2618e8(0x2ec)](_0x2618e8(0x519))['value'])||null;const _0x55f423=document[_0x2618e8(0x2ec)](_0x2618e8(0x1362)),_0x4ff542=_0x55f423[_0x2618e8(0x5d6)](_0x2618e8(0x131b)),_0x3a4522=[];_0x4ff542['forEach'](_0x404bca=>{const _0x421d24=_0x2618e8,_0x15efe1=_0x404bca[_0x421d24(0x765)]('.entry-content-textarea')[_0x421d24(0x11a4)][_0x421d24(0x97e)]();_0x15efe1&&_0x3a4522[_0x421d24(0x367)]({'comment':_0x404bca[_0x421d24(0x765)]('.entry-comment-input')[_0x421d24(0x11a4)][_0x421d24(0x97e)](),'keys':(_0x404bca[_0x421d24(0x765)](_0x421d24(0xb04))[_0x421d24(0x11a4)][_0x421d24(0x97e)]()||'')[_0x421d24(0xa8a)](',')[_0x421d24(0x11c6)](_0x109848=>_0x109848[_0x421d24(0x97e)]())[_0x421d24(0xebc)](Boolean),'content':_0x15efe1,'enabled':_0x404bca['querySelector'](_0x421d24(0x8af))[_0x421d24(0x13b8)]});}),_0x180a01[_0x2618e8(0x1047)]=_0x3a4522,await _0x5b9d83[_0x2618e8(0x1504)][_0x2618e8(0x7c3)](_0x180a01),_0x84d184=null,_0x17ec27(_0x2618e8(0xaac)),await _0x2ed701();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x6b2))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{document['getElementById']('import-preset-input')['click']();}),document['getElementById'](_0x2ea2d1(0xa41))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x5485a3),document['getElementById'](_0x2ea2d1(0x1ad))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x15de31),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x45f))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x39d4b2),document['getElementById'](_0x2ea2d1(0xa70))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x32a33e=_0x2ea2d1;document['getElementById'](_0x32a33e(0x12e7))[_0x32a33e(0xff6)][_0x32a33e(0x1424)](_0x32a33e(0x149d));}),document['getElementById']('go-to-clear-step2-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x62d4d1),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1526))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x53eb92),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x14ce))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x40d37a=_0x2ea2d1;document[_0x40d37a(0x2ec)](_0x40d37a(0x12e7))[_0x40d37a(0xff6)]['remove'](_0x40d37a(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x39c))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x29888d),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x12e7))['addEventListener'](_0x2ea2d1(0x1177),_0x76373f=>{const _0x110807=_0x2ea2d1,_0x3a3684=_0x76373f[_0x110807(0x1104)]['closest'](_0x110807(0xf9f));_0x3a3684&&(_0x76373f[_0x110807(0x106c)](),_0x3a3684[_0x110807(0xff6)][_0x110807(0x14c8)](_0x110807(0xba2)));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x12e7))[_0x2ea2d1(0xf79)]('change',_0x2d8b98=>{const _0x1c3117=_0x2ea2d1;if(_0x2d8b98['target']['id']===_0x1c3117(0x391)){const _0x1be8a6=_0x2d8b98['target'][_0x1c3117(0x13b8)];document[_0x1c3117(0x5d6)](_0x1c3117(0xae8))['forEach'](_0x3f5307=>{const _0x1a903d=_0x1c3117;_0x3f5307[_0x1a903d(0xff6)][_0x1a903d(0x14c8)](_0x1a903d(0xba2),_0x1be8a6);});}else{if(_0x2d8b98[_0x1c3117(0x1104)]['id']===_0x1c3117(0x1555)){const _0x39461a=_0x2d8b98['target'][_0x1c3117(0x13b8)];document['querySelectorAll'](_0x1c3117(0x8dc))[_0x1c3117(0xf99)](_0x5add7c=>{const _0x32a253=_0x1c3117;_0x5add7c[_0x32a253(0xff6)][_0x32a253(0x14c8)](_0x32a253(0xba2),_0x39461a);});}}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xee6))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x5154cc),document[_0x2ea2d1(0x2ec)]('copy-message-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x797b61),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x906))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x6d7da8),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x70b))['addEventListener']('click',()=>{const _0x25fd30=_0x2ea2d1;_0x52c3ce(_0x25fd30(0x1e2));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xd07))['addEventListener'](_0x2ea2d1(0x1177),()=>_0x7ad5c6(null)),document['getElementById'](_0x2ea2d1(0x125b))[_0x2ea2d1(0xf79)]('click',_0x338462),document[_0x2ea2d1(0x2ec)]('npc-editor-modal')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x8471b9=>{const _0x55c73c=_0x2ea2d1;_0x8471b9[_0x55c73c(0x1104)]['id']===_0x55c73c(0xa4c)&&_0x6deb33();}),document['getElementById'](_0x2ea2d1(0x1402))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x3f4474=_0x2ea2d1;document[_0x3f4474(0x2ec)](_0x3f4474(0xe73))[_0x3f4474(0xff6)][_0x3f4474(0x1424)](_0x3f4474(0x149d)),document[_0x3f4474(0x2ec)]('npc-editor-modal')[_0x3f4474(0xff6)][_0x3f4474(0xe9a)]('visible')&&_0x7ad5c6(editingNpcId);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xda6))[_0x2ea2d1(0xf79)]('click',_0xa5c389),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xe43))[_0x2ea2d1(0xf79)]('click',_0x1de90f=>{const _0x4f0314=_0x2ea2d1;_0x1de90f[_0x4f0314(0x1104)][_0x4f0314(0xff6)][_0x4f0314(0xe9a)](_0x4f0314(0x1d2))&&_0x59c145(parseInt(_0x1de90f['target'][_0x4f0314(0xe93)]['id']));}),document['getElementById'](_0x2ea2d1(0x1f7))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x46bd63=_0x2ea2d1;document[_0x46bd63(0x2ec)]('npc-editor-modal')['classList'][_0x46bd63(0x1424)](_0x46bd63(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x156d))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x2b57db=>{const _0x37d432=_0x2ea2d1,_0x3cd7c1=_0x2b57db[_0x37d432(0x1104)]['files'][0x0];if(_0x3cd7c1){const _0x1aa3bd=new FileReader();_0x1aa3bd[_0x37d432(0xf2d)]=_0x507f7e=>{const _0x41504c=_0x37d432;document[_0x41504c(0x2ec)]('npc-avatar-preview')[_0x41504c(0xce4)]=_0x507f7e[_0x41504c(0x1104)][_0x41504c(0x42a)];},_0x1aa3bd[_0x37d432(0x60e)](_0x3cd7c1);}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x2c9))['addEventListener']('click',_0x5c66a3=>{const _0xc2bdbe=_0x2ea2d1;if(_0x5c66a3[_0xc2bdbe(0x1104)]['id']===_0xc2bdbe(0x85f))_0x1687a2();else _0x5c66a3['target']['id']===_0xc2bdbe(0x5af)&&_0x503dba();}),_0x131542(document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xfce)),()=>{const _0x2361e3=_0x2ea2d1;_0x79cac3[_0x2361e3(0xf35)]>-0x1&&_0x32eda6(_0x79cac3[_0x2361e3(0xf35)]);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x804))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x44a2f8),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x5e7))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x39a847),document['getElementById'](_0x2ea2d1(0xce9))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x1da80a=_0x2ea2d1;document['getElementById'](_0x1da80a(0x1475))[_0x1da80a(0xff6)][_0x1da80a(0x1424)](_0x1da80a(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x116b))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x6a9),_0x574cee=>{const _0x291580=_0x2ea2d1,_0x1e1b07=_0x574cee['target'][_0x291580(0x11a4)][_0x291580(0x1430)](),_0x1b9fb5=document[_0x291580(0x2ec)](_0x291580(0x1167));for(const _0x10e2f4 of _0x1b9fb5[_0x291580(0x793)]){const _0x5b2c61=_0x10e2f4[_0x291580(0x15f)]['toLowerCase']();_0x5b2c61[_0x291580(0x138a)](_0x1e1b07)?_0x10e2f4[_0x291580(0x589)][_0x291580(0x701)]='':_0x10e2f4[_0x291580(0x589)][_0x291580(0x701)]=_0x291580(0x5b1);}}),window['openWerewolfLobby']=_0x4c63d3,document['getElementById']('werewolf-game-btn')['addEventListener'](_0x2ea2d1(0x1177),()=>_0x4c63d3(_0x2ea2d1(0x1356))),document['getElementById']('cancel-werewolf-lobby-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x268d70=_0x2ea2d1;document[_0x268d70(0x2ec)](_0x268d70(0xa36))[_0x268d70(0xff6)]['remove'](_0x268d70(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x267))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x556473),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x65d))['addEventListener']('click',()=>{const _0x1e0f57=_0x2ea2d1;document[_0x1e0f57(0x2ec)](_0x1e0f57(0x4dc))['classList'][_0x1e0f57(0x1424)](_0x1e0f57(0x149d)),_0x321782();}),document['getElementById']('exit-werewolf-game-btn')['addEventListener'](_0x2ea2d1(0x1177),async()=>{const _0x297238=_0x2ea2d1,_0x5b5a8b=await _0x4436ba(_0x297238(0x659),'确定要退出当前这局狼人杀吗？游戏进度将不会被保存。',{'confirmButtonClass':_0x297238(0xd8f)});_0x5b5a8b&&(_0x5aea71[_0x297238(0xffc)]=![],_0x17ec27(_0x5aea71[_0x297238(0xdd0)]?_0x297238(0x120a):_0x297238(0x436)));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x552))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x522d1e=_0x2ea2d1;document[_0x522d1e(0x2ec)](_0x522d1e(0xb5b))[_0x522d1e(0xff6)][_0x522d1e(0x1424)]('visible'),_0x17ec27(_0x5aea71[_0x522d1e(0xdd0)]?_0x522d1e(0xf4d):_0x522d1e(0x436));}),document['getElementById'](_0x2ea2d1(0x1102))['addEventListener']('click',()=>{const _0x3f2086=_0x2ea2d1;document[_0x3f2086(0x2ec)](_0x3f2086(0x76f))[_0x3f2086(0xff6)]['remove'](_0x3f2086(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x4ea))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x59254d=_0x2ea2d1;document[_0x59254d(0x2ec)](_0x59254d(0xa36))[_0x59254d(0xff6)][_0x59254d(0x1424)](_0x59254d(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x371))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x25bc98),document[_0x2ea2d1(0x2ec)]('manual-werewolf-summary-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x3499c3),document['getElementById'](_0x2ea2d1(0x10b3))['addEventListener'](_0x2ea2d1(0x1177),_0x95aee4),document[_0x2ea2d1(0x2ec)]('delete-world-books-btn')['addEventListener'](_0x2ea2d1(0x1177),_0x6a765d),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x130f))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x4649aa=_0x2ea2d1;document[_0x4649aa(0x2ec)](_0x4649aa(0x4eb))['classList'][_0x4649aa(0x1424)]('visible');}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xf2c))['addEventListener'](_0x2ea2d1(0x1177),_0x13f24d),document[_0x2ea2d1(0x2ec)]('delete-world-books-modal')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x47f44f=>{const _0x48c0b6=_0x2ea2d1,_0x26be7=_0x47f44f[_0x48c0b6(0x1104)]['closest'](_0x48c0b6(0xf9f));_0x26be7&&_0x26be7[_0x48c0b6(0xff6)]['toggle'](_0x48c0b6(0xba2));if(_0x47f44f['target']['id']==='select-all-world-books-for-clear'){const _0x51af37=_0x47f44f[_0x48c0b6(0x1104)]['checked'];document['querySelectorAll'](_0x48c0b6(0x9af))[_0x48c0b6(0xf99)](_0x160e9e=>{const _0x35d530=_0x48c0b6;_0x160e9e[_0x35d530(0xff6)][_0x35d530(0x14c8)](_0x35d530(0xba2),_0x51af37);});}}),document['getElementById']('sticker-search-input')['addEventListener'](_0x2ea2d1(0x6a9),()=>{_0xfb88c2(![]);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x917))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x4c82b3=>{const _0x1c0e1a=_0x2ea2d1;if(_0x4c82b3[_0x1c0e1a(0x1104)][_0x1c0e1a(0xff6)][_0x1c0e1a(0xe9a)](_0x1c0e1a(0x1319))){const _0x370ede=_0x4c82b3['target'][_0x1c0e1a(0xe93)]['categoryId'],_0x3702c7=_0x370ede!==_0x1c0e1a(0xa92)&&_0x370ede!==_0x1c0e1a(0x17c)?parseInt(_0x370ede):_0x370ede;document[_0x1c0e1a(0x2ec)](_0x1c0e1a(0x485))[_0x1c0e1a(0x11a4)]='',_0x3674b6(_0x3702c7);}});const _0x159fab=document['getElementById'](_0x2ea2d1(0x156b));_0x159fab['addEventListener'](_0x2ea2d1(0xd8a),()=>{const _0x4aafa8=_0x2ea2d1;if(_0x159fab['scrollTop']<0x1&&!_0x51e675){const _0xc55c49=_0x28f30a[_0x4aafa8(0x6ce)][_0x28f30a[_0x4aafa8(0x11b9)]]?.[_0x4aafa8(0x12c3)][_0x4aafa8(0x9a1)]||0x0;_0xc55c49>_0x5df89d&&_0x33df8e();}});const _0x2df12a=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xd68));_0x2df12a[_0x2ea2d1(0xf79)](_0x2ea2d1(0xd8a),()=>{const _0x9660ef=_0x2ea2d1,{scrollTop:_0x30bcc4,scrollHeight:_0x314317,clientHeight:_0x4ad772}=_0x2df12a;if(_0x314317-_0x30bcc4<=_0x4ad772+0x32&&!_0xca1dd0){const _0x49e2b8=_0x28f30a[_0x9660ef(0x6ce)][_0x28f30a['activeChatId']]?.[_0x9660ef(0x2be)]['length']||0x0;_0x49e2b8>_0xf09860&&_0x4e6d47();}});const _0x4e775f=document[_0x2ea2d1(0x765)](_0x2ea2d1(0x45d));_0x4e775f[_0x2ea2d1(0xf79)](_0x2ea2d1(0xd8a),()=>{const _0x2b3ea0=_0x2ea2d1,{scrollTop:_0x325b79,scrollHeight:_0x33554c,clientHeight:_0x58d43c}=_0x4e775f;_0x33554c-_0x325b79<=_0x58d43c+0x64&&!_0x168c65&&(_0x4e343b[_0x2b3ea0(0x9a1)]>_0x5adb76&&_0x3abe5b());});const _0x3946d0=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1313));_0x3946d0['addEventListener']('scroll',()=>{const {scrollTop:_0x2ee91a,scrollHeight:_0xa4be7f,clientHeight:_0x41cf18}=_0x3946d0;_0xa4be7f-_0x2ee91a<=_0x41cf18+0x64&&!_0x585648&&(_0x160b5e['length']>_0x1b554d&&_0x300101());}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xf5f))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x3e21cb);const _0x443439=document['getElementById'](_0x2ea2d1(0x8f1));_0x181632(_0x443439,_0x443439),document[_0x2ea2d1(0x2ec)]('close-reading-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x90c1f8),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x2c2))[_0x2ea2d1(0xf79)]('click',_0x5c00a7),document['getElementById'](_0x2ea2d1(0xa4b))['addEventListener'](_0x2ea2d1(0x1177),_0x156585),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x934))['addEventListener']('click',_0x331fc8),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1336))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x544f2e),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x432))['addEventListener'](_0x2ea2d1(0x1177),_0x344671),document[_0x2ea2d1(0x2ec)]('reading-restore-btn')[_0x2ea2d1(0xf79)]('click',_0x211e18),_0x181632(document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x28c)),document[_0x2ea2d1(0x765)]('#reading-window\x20.reading-header')),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x2c2))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x5c00a7),document['getElementById'](_0x2ea2d1(0x12e1))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x54e197=_0x2ea2d1;document[_0x54e197(0x2ec)]('reading-library-modal')[_0x54e197(0xff6)][_0x54e197(0x1424)](_0x54e197(0x149d));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x11da))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x23c847),document['getElementById'](_0x2ea2d1(0xd9f))['addEventListener'](_0x2ea2d1(0x1177),_0x2b475a=>{const _0x330f8e=_0x2ea2d1,_0x1313fb=_0x2b475a['target'];if(_0x1313fb[_0x330f8e(0xff6)][_0x330f8e(0xe9a)](_0x330f8e(0x597))){const _0x2e5599=parseInt(_0x1313fb[_0x330f8e(0xe93)][_0x330f8e(0x7f9)]);_0xf0a10c(_0x2e5599);}else{if(_0x1313fb[_0x330f8e(0xff6)][_0x330f8e(0xe9a)](_0x330f8e(0x1d2))){const _0xb7ff81=parseInt(_0x1313fb[_0x330f8e(0xe93)][_0x330f8e(0x7f9)]);_0x414517(_0xb7ff81);}}}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xbb7))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x3b2e12),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xb2e))['addEventListener'](_0x2ea2d1(0x6a9),_0x2d4339=>{const _0x2720f7=_0x2ea2d1;_0xe1cec4(_0x2d4339['target'][_0x2720f7(0x11a4)]);});const _0x26589e=_0x2d3d91(_0x1c86d1,0x12c);document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x131f))[_0x2ea2d1(0xf79)](_0x2ea2d1(0xd8a),_0x26589e),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x133f))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x6a9),_0x368aa6=>{const _0xedb9dc=_0x2ea2d1;document[_0xedb9dc(0x2ec)](_0xedb9dc(0xaf6))['textContent']=_0x368aa6[_0xedb9dc(0x1104)][_0xedb9dc(0x11a4)];});const _0xb1ff2a=document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1e2));_0xb1ff2a[_0x2ea2d1(0xf79)](_0x2ea2d1(0xd8a),()=>{const {scrollTop:_0x134c15,scrollHeight:_0x4113a5,clientHeight:_0x3d9db7}=_0xb1ff2a;_0x4113a5-_0x134c15<=_0x3d9db7+0x96&&!_0x27d082&&_0xf4e5e0();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xa93))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x3e8350),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x12b9))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x531e7c=_0x2ea2d1;document['getElementById']('product-category-manager-modal')[_0x531e7c(0xff6)][_0x531e7c(0x1424)]('visible'),_0x2a7440(_0x45682c);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xd46))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x685e4b),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x822))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x43db9d=>{const _0x50b065=_0x2ea2d1;_0x43db9d['target'][_0x50b065(0xff6)][_0x50b065(0xe9a)](_0x50b065(0x1d2))&&_0x3e3223(parseInt(_0x43db9d[_0x50b065(0x1104)]['dataset']['id']));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x133e))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>_0x5c3541()),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x206))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x5b4064=_0x2ea2d1;document[_0x5b4064(0x2ec)]('variation-selection-modal')[_0x5b4064(0xff6)]['remove']('visible');}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x388))['addEventListener']('click',()=>{const _0x47c1c1=_0x2ea2d1,_0x430adb=document['getElementById']('variation-quantity-display');let _0x4705b9=parseInt(_0x430adb[_0x47c1c1(0x15f)]);if(_0x4705b9>0x1)_0x430adb[_0x47c1c1(0x15f)]=_0x4705b9-0x1;}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x50a))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x5c1856=_0x2ea2d1,_0x3bc2b1=document[_0x5c1856(0x2ec)](_0x5c1856(0x2b2));_0x3bc2b1[_0x5c1856(0x15f)]=parseInt(_0x3bc2b1[_0x5c1856(0x15f)])+0x1;}),document['getElementById'](_0x2ea2d1(0x723))['addEventListener'](_0x2ea2d1(0x1177),_0x33eb82=>{const _0x44630d=_0x2ea2d1;if(_0x33eb82['target'][_0x44630d(0xff6)][_0x44630d(0xe9a)]('product-category-tab')){const _0x145e65=_0x33eb82[_0x44630d(0x1104)][_0x44630d(0xe93)][_0x44630d(0x10ce)]===_0x44630d(0xa92)?_0x44630d(0xa92):parseInt(_0x33eb82['target']['dataset']['categoryId']);_0x44125d(_0x145e65);}}),document['getElementById'](_0x2ea2d1(0x565))[_0x2ea2d1(0xf79)]('click',_0x2176f7),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xf7a))['addEventListener'](_0x2ea2d1(0x1177),_0x33a97f),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1379))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x237298),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xc95))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x534339=_0x2ea2d1;document[_0x534339(0x2ec)](_0x534339(0xad5))[_0x534339(0xff6)]['remove'](_0x534339(0x149d));}),document['getElementById']('select-all-products-checkbox')['addEventListener'](_0x2ea2d1(0x217),_0x504ffc=>{const _0x503717=_0x2ea2d1,_0x9411c0=_0x504ffc[_0x503717(0x1104)]['checked'],_0x36354d=document[_0x503717(0x5d6)](_0x503717(0xad0));_0x36354d[_0x503717(0xf99)](_0x284bb0=>{const _0x25d378=_0x503717,_0x48582c=parseInt(_0x284bb0['dataset']['id']);_0x284bb0[_0x25d378(0xff6)][_0x25d378(0x14c8)](_0x25d378(0xba2),_0x9411c0),_0x9411c0?_0x5936d4['add'](_0x48582c):_0x5936d4[_0x25d378(0x54b)](_0x48582c);}),document[_0x503717(0x2ec)](_0x503717(0xd72))[_0x503717(0x15f)]=_0x503717(0xc6e)+_0x5936d4[_0x503717(0x2d2)]+')';}),document[_0x2ea2d1(0x2ec)]('delete-selected-products-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{const _0x20d3d1=_0x2ea2d1;if(_0x5936d4[_0x20d3d1(0x2d2)]===0x0){alert('请先选择要删除的商品。');return;}const _0x1f7c3f=await _0x4436ba('确认删除','确定要永久删除选中的\x20'+_0x5936d4['size']+'\x20个商品吗？此操作不可恢复。',{'confirmButtonClass':'btn-danger'});_0x1f7c3f&&(await _0x5b9d83[_0x20d3d1(0x120e)][_0x20d3d1(0x1521)]([..._0x5936d4]),document[_0x20d3d1(0x2ec)](_0x20d3d1(0x1141))[_0x20d3d1(0x1177)](),await _0x275258(),await _0x34d596('成功',_0x20d3d1(0xe29)));}),document['getElementById'](_0x2ea2d1(0x428))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x41eb62),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x11c9))[_0x2ea2d1(0xf79)]('click',_0x57e27b),document[_0x2ea2d1(0x2ec)]('delete-appearance-preset-btn')[_0x2ea2d1(0xf79)]('click',_0x326b6a),document['getElementById'](_0x2ea2d1(0xcd4))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0xd880bf=>{const _0x23150f=_0x2ea2d1,_0x3cf0bc=document[_0x23150f(0x2ec)](_0x23150f(0xd15));_0x3cf0bc[_0x23150f(0x589)][_0x23150f(0x701)]=_0xd880bf[_0x23150f(0x1104)][_0x23150f(0x13b8)]?_0x23150f(0x13f7):_0x23150f(0x5b1);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xb05))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),function(){const _0x10de42=_0x2ea2d1,_0x5c9c07=document[_0x10de42(0x2ec)](_0x10de42(0x5da));_0x5c9c07['type']===_0x10de42(0xc81)?(_0x5c9c07[_0x10de42(0xb4b)]='text',this[_0x10de42(0x15f)]='😌'):(_0x5c9c07[_0x10de42(0xb4b)]=_0x10de42(0xc81),this['textContent']='🧐');}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x79e))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0xc5f3bb=_0x2ea2d1;_0x5143d7(),document['getElementById'](_0xc5f3bb(0x1af))[_0xc5f3bb(0x589)][_0xc5f3bb(0x701)]=_0xc5f3bb(0xc67);}),document['getElementById'](_0x2ea2d1(0x703))[_0x2ea2d1(0xf79)]('change',_0x3a70c9=>{const _0x4cb287=_0x2ea2d1,_0x4f0829=document[_0x4cb287(0x2ec)](_0x4cb287(0x1a2));_0x3a70c9[_0x4cb287(0x1104)][_0x4cb287(0x11a4)]===_0x4cb287(0x1334)?_0x4f0829['style'][_0x4cb287(0x701)]=_0x4cb287(0x13f7):_0x4f0829['style'][_0x4cb287(0x701)]=_0x4cb287(0x5b1);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x115e))[_0x2ea2d1(0xf79)]('click',()=>{const _0x43f5c4=_0x2ea2d1;document['getElementById'](_0x43f5c4(0x1af))[_0x43f5c4(0x589)][_0x43f5c4(0x701)]=_0x43f5c4(0x5b1);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xbf2))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x428451=_0x2ea2d1;_0x616ebd(),document[_0x428451(0x2ec)]('novelai-settings-modal')[_0x428451(0x589)][_0x428451(0x701)]=_0x428451(0x5b1),alert(_0x428451(0x600));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x135a))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{confirm('确定要恢复默认设置吗？')&&_0x54a2ef();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x9da))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x2b9250=_0x2ea2d1,_0x2c4c8e=document['getElementById'](_0x2b9250(0x5da))[_0x2b9250(0x11a4)][_0x2b9250(0x97e)]();if(!_0x2c4c8e){alert(_0x2b9250(0xec5));return;}document[_0x2b9250(0x2ec)](_0x2b9250(0xe17))[_0x2b9250(0x589)][_0x2b9250(0x701)]=_0x2b9250(0xc67),document[_0x2b9250(0x2ec)]('nai-test-result')[_0x2b9250(0x589)]['display']=_0x2b9250(0x5b1),document[_0x2b9250(0x2ec)](_0x2b9250(0x26d))[_0x2b9250(0x589)][_0x2b9250(0x701)]=_0x2b9250(0x5b1);}),document['getElementById'](_0x2ea2d1(0x9e8))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x24027b=_0x2ea2d1;document[_0x24027b(0x2ec)](_0x24027b(0xe17))[_0x24027b(0x589)][_0x24027b(0x701)]='none';}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x611))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x4ef65e=_0x2ea2d1;document[_0x4ef65e(0x2ec)]('novelai-test-modal')[_0x4ef65e(0x589)][_0x4ef65e(0x701)]=_0x4ef65e(0x5b1);}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x36a))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),async()=>{await _0x3ff984();}),document[_0x2ea2d1(0x2ec)]('nai-download-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x27ba82=_0x2ea2d1,_0xd9b2b5=document[_0x27ba82(0x2ec)]('nai-result-image'),_0x1b5cd2=document[_0x27ba82(0x14ae)]('a');_0x1b5cd2[_0x27ba82(0xe15)]=_0xd9b2b5[_0x27ba82(0xce4)],_0x1b5cd2[_0x27ba82(0x3eb)]='novelai-generated-'+Date[_0x27ba82(0x487)]()+_0x27ba82(0xbb2),_0x1b5cd2['click']();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x9b3))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x18280e=_0x2ea2d1;if(!_0x28f30a[_0x18280e(0x11b9)])return;const _0x1e8cb6=_0x28f30a[_0x18280e(0x6ce)][_0x28f30a[_0x18280e(0x11b9)]],_0x45e89f=_0x1e8cb6[_0x18280e(0x362)][_0x18280e(0x64a)]||{'promptSource':_0x18280e(0x10a7),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x18280e(0x2ec)](_0x18280e(0x121a))[_0x18280e(0x11a4)]=_0x45e89f['characterPositivePrompt']||'',document['getElementById'](_0x18280e(0x1074))[_0x18280e(0x11a4)]=_0x45e89f[_0x18280e(0xb8f)]||'',document[_0x18280e(0x2ec)](_0x18280e(0x11e1))[_0x18280e(0x589)][_0x18280e(0x701)]='flex';}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xbdc))['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x19b8ee=_0x2ea2d1;document[_0x19b8ee(0x2ec)](_0x19b8ee(0x11e1))[_0x19b8ee(0x589)]['display']=_0x19b8ee(0x5b1);}),document['getElementById'](_0x2ea2d1(0x4c0))['addEventListener'](_0x2ea2d1(0x1177),async()=>{const _0x2615a7=_0x2ea2d1;if(!_0x28f30a[_0x2615a7(0x11b9)])return;const _0x4ff05e=_0x28f30a[_0x2615a7(0x6ce)][_0x28f30a[_0x2615a7(0x11b9)]];!_0x4ff05e['settings'][_0x2615a7(0x64a)]&&(_0x4ff05e[_0x2615a7(0x362)][_0x2615a7(0x64a)]={'promptSource':_0x2615a7(0x10a7)}),_0x4ff05e[_0x2615a7(0x362)][_0x2615a7(0x64a)][_0x2615a7(0x1467)]=document[_0x2615a7(0x2ec)]('character-nai-positive')['value'][_0x2615a7(0x97e)](),_0x4ff05e['settings'][_0x2615a7(0x64a)][_0x2615a7(0xb8f)]=document['getElementById'](_0x2615a7(0x1074))[_0x2615a7(0x11a4)][_0x2615a7(0x97e)](),console[_0x2615a7(0x415)](_0x2615a7(0x10fe)),console[_0x2615a7(0x415)](_0x2615a7(0xfe9),_0x4ff05e[_0x2615a7(0x362)][_0x2615a7(0x64a)]['characterPositivePrompt']),console[_0x2615a7(0x415)](_0x2615a7(0x915),_0x4ff05e[_0x2615a7(0x362)][_0x2615a7(0x64a)]['characterNegativePrompt']),console[_0x2615a7(0x415)](_0x2615a7(0x65c),_0x4ff05e[_0x2615a7(0x362)][_0x2615a7(0x64a)]['promptSource']),await _0x5b9d83[_0x2615a7(0x6ce)][_0x2615a7(0x7c3)](_0x4ff05e),document['getElementById'](_0x2615a7(0x11e1))[_0x2615a7(0x589)]['display']=_0x2615a7(0x5b1),alert(_0x2615a7(0x11d4));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xef6))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x4423ed=_0x2ea2d1;confirm(_0x4423ed(0xc84))&&(document[_0x4423ed(0x2ec)]('character-nai-positive')[_0x4423ed(0x11a4)]='',document[_0x4423ed(0x2ec)](_0x4423ed(0x1074))[_0x4423ed(0x11a4)]='');}),document[_0x2ea2d1(0x2ec)]('group-character-nai-prompts-btn')['addEventListener'](_0x2ea2d1(0x1177),()=>{const _0x1d5a93=_0x2ea2d1;if(!_0x28f30a['activeChatId'])return;const _0x954f35=_0x28f30a['chats'][_0x28f30a[_0x1d5a93(0x11b9)]],_0x38000d=_0x954f35[_0x1d5a93(0x362)]['naiSettings']||{'promptSource':_0x1d5a93(0x10a7),'characterPositivePrompt':'','characterNegativePrompt':''};document['getElementById'](_0x1d5a93(0x121a))[_0x1d5a93(0x11a4)]=_0x38000d[_0x1d5a93(0x1467)]||'',document[_0x1d5a93(0x2ec)](_0x1d5a93(0x1074))['value']=_0x38000d[_0x1d5a93(0xb8f)]||'',document[_0x1d5a93(0x2ec)](_0x1d5a93(0x11e1))['style'][_0x1d5a93(0x701)]='flex';}),document['getElementById'](_0x2ea2d1(0x323))[_0x2ea2d1(0xf79)]('click',_0x3adfa8),document[_0x2ea2d1(0x2ec)]('select-all-frames-checkbox')[_0x2ea2d1(0xf79)]('change',_0x1c83f3),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x349))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x36e1c8),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xe02))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x4db1ae),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0xfcc))['addEventListener']('click',()=>{const _0x284eee=_0x2ea2d1;_0x38e7ae(_0x284eee(0xd24));}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1bf))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),_0x3634f2=>{const _0x7c1e3c=_0x2ea2d1,_0x557bfb=_0x3634f2[_0x7c1e3c(0x1104)][_0x7c1e3c(0x3f2)](_0x7c1e3c(0x973));if(_0x557bfb){const _0x54a2d9=_0x557bfb[_0x7c1e3c(0x765)](_0x7c1e3c(0x854));_0x54a2d9&&_0x3634f2[_0x7c1e3c(0x1104)]!==_0x54a2d9&&(_0x54a2d9[_0x7c1e3c(0x13b8)]=!_0x54a2d9['checked']);}});const _0xdf8e9=document['getElementById']('sticker-category-tabs');_0x131542(_0xdf8e9,_0x5e9c1c=>{const _0x5c66da=_0x2ea2d1,_0x146ac2=_0x5e9c1c['target'][_0x5c66da(0x3f2)](_0x5c66da(0xc19));if(_0x146ac2){_0x5e9c1c['preventDefault']();const _0x179740=_0x146ac2['dataset'][_0x5c66da(0x10ce)];if(_0x179740===_0x5c66da(0xa92)){_0x34d596('提示',_0x5c66da(0x872));return;}const _0x4c84a2=_0x179740===_0x5c66da(0x17c)?_0x5c66da(0x17c):parseInt(_0x179740);_0x13dbaf(_0x4c84a2);}}),document['getElementById'](_0x2ea2d1(0x90f))['addEventListener'](_0x2ea2d1(0x1177),_0x20a69b),document['getElementById']('close-nai-gallery-btn')[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>{const _0x660f5a=_0x2ea2d1;document[_0x660f5a(0x2ec)](_0x660f5a(0x378))[_0x660f5a(0xff6)][_0x660f5a(0x1424)](_0x660f5a(0x149d));}),document['getElementById']('manage-nai-gallery-btn')[_0x2ea2d1(0xf79)]('click',_0x343866),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x1313))['addEventListener'](_0x2ea2d1(0x1177),_0x43b5fe=>{_0x1eaee3(_0x43b5fe);}),document['getElementById'](_0x2ea2d1(0x273))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x217),_0x11e901=>{const _0x40399a=_0x2ea2d1,_0x36af20=_0x11e901['target'][_0x40399a(0x13b8)];document[_0x40399a(0x5d6)](_0x40399a(0x1346))[_0x40399a(0xf99)](_0x5bc40f=>{const _0x342684=_0x40399a;_0x5bc40f[_0x342684(0xff6)][_0x342684(0x14c8)](_0x342684(0xba2),_0x36af20);const _0x3266a8=_0x5bc40f[_0x342684(0xe93)]['key'];_0x36af20?_0x1be0c6[_0x342684(0xe82)](_0x3266a8):_0x1be0c6[_0x342684(0x54b)](_0x3266a8);}),_0x4c18a6();}),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x9df))[_0x2ea2d1(0xf79)](_0x2ea2d1(0x1177),()=>_0x4ad9fc()),document[_0x2ea2d1(0x2ec)](_0x2ea2d1(0x405))['addEventListener']('click',()=>_0x3c731b()),_0x3f13cc(),_0x17ec27(_0x2ea2d1(0x436));}_0x55ad0c();});
