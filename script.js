function _0x272e(){const _0x4bfcd2=['delete-current-category-btn','warn','werewolf-user-input','back-to-char-qq-list-btn','select-all-products-checkbox','findLast','Character\x20Avatar','user-speak-btn','送给了\x20','reading-window','狼人杀','*事件*:\x20','https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','确定要结束这个投票吗？结束后将无法再进行投票。','\x20中找到世界书。','ai-voice-id-group','【重要提示】','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','char-usage-screen','”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22post-main-content\x22>','danger-option','note','”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','用户\x20(','tencent','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','douban-cast-select-btn','isRefund','rp-group-count','devicePixelRatio','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','findIndex','创建新聊天','clear-posts-list','</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','manage-groups-btn','.delete-memory-btn','songJson','\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ephone','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>','frame_7','更新通知文件中缺少\x20data-version\x20属性。','is-transfer','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>','压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...','https://i.postimg.cc/05DLr0yj/IMG-4427.gif','\x22\x20class=\x22chat-image\x22></div>','lyrics-vertical-pos','https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20创建了一个新约定:','douban-settings-modal','确定要删除分类《','歌曲背景已更新！','.post-deleted-placeholder','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','本日核心议题','pat-animation','werewolf-game-screen','ai-action-cooldown-input','讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','备忘录','antidoteUsed','url(','https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','bulkAdd','”吗？','#\x20你的互动对象\x20(用户和其他角色)\x0a','API未配置，无法生成内容。','获取更新通知文件失败。','压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...','是否要使用毒药？','\x22\x20触发了后台行动！','stringify','转发成功！','导入单个聊天时出错:','-\x20你的毒药状态：','char-simulated-input','currentLyricIndex','ai-voice-id-input','https://i.postimg.cc/fLTc42dg/IMG-4391.gif','secondary-api-key','https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','正在重试\x22','https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','toDateString','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22><div\x20class=\x22member-name\x22>','memories-view','AI返回的讨论内容格式不正确。原始返回:\x20','</div><div\x20class=\x22transfer-amount\x22>¥\x20','）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','justifyContent','close-sticker-category-manager-btn','save-css-preset-btn','文件格式不正确，这不是一个有效的世界书备份文件。','px))','配置错误','selected','taobao','\x20条红包记录。','无法生成新回复:\x20',')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]','本次发送给AI的【挂载记忆】内容如下：\x0a','\x20之间的有效数字。','lyrics-btn','reject-friend-btn','天\x20-\x20讨论','AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','frame-item','fileType','group-management-modal','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','[系统提示：五子棋游戏已结束。最终结果是：','”\x20吗？','https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','blockCooldownHours','data-clear-char-list','https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif','display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;','music-visual-container','请输入一个有效的、未来的日期！','生成中...','<span\x20style=\x22color:\x20green;\x22>已开启</span>','hasShown10','latestTimestamp','activeContainer','has','平票或无人投票，此轮无人出局。','read-together-btn','https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','删除分类后，该分类下的所有商品将变为“未分类”。确定吗？','的设定集','waimai_request','。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20','close-shared-history-viewer-btn','regenerate-char-usage-btn','chargingchange',')\x20和情景的感知。','groupHeader','transfer','.comment-sticker-btn','无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20','.remove-option-btn','pat_user','is-card-like','publisher','ai-response-editor-block','cancel-contact-picker-btn','请输入对方现在的新状态：','generate-shopping-items-btn',',\x20内容摘要:\x20“','\x0a-\x20**你最近和“','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','douban-my-comment-avatar','自动总结成功：已成功添加\x201\x20条新的长期记忆！','\x20本世界书已成功删除。','诊断：在\x20data.extensions.character_book\x20中找到世界书。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','你们在','shuoshuo','AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。','https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','ai-persona','#custom-modal\x20.custom-modal-footer','进入投票','确定要永久删除这条通话记录吗？此操作不可恢复。','rules-tab','-\x20**对话状态**:\x20上次互动于\x20','setDate','currentTarget','modify','notification-sound-url-input','无备注','savedId','[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]','”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','douban-post-item','shared-history-viewer-modal','manual-summarize-btn','link-content-input','”的特点生成专属商品...','请先添加一张图片再发布动态哦！','status-bar-time','.status-text','quality','字体URL不能为空！','stickerMeaning','margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','temp_user_chat_mirror','rule-editor-title','myAvatar','\x22></div>','predicate\x20must\x20be\x20a\x20function','offline','font','cancel-call-btn','speech-01','.link-share-card','达到自动总结阈值\x20(','\x22><div\x20class=\x22title\x22>','抱歉，我拒绝了你的好友申请。','werewolf-player-grid','blur','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','call-history-list','这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？','close-ai-avatar-library-btn','qzone-sticker-panel','请你投票。','load','share-link-modal','”]\x20','offlineMinLength','create-album-btn-page','”。请你回顾一下刚才和“','inline-flex','智能导出\x20(推荐，速度快，内存占用小)','未知会话','call-message-actions-modal','comment','thoughtsHistory','catch','video-call-btn','.char-product-item','恭喜！','无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','existing-product-categories-list','vote','全部记忆\x20(','is-location-share','编辑商品','--chat-font-size','base_resp','”量身定制的商品已上架！','++id,\x20name,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp','正在呼叫所有成员...','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','请根据你的设定，生成你的备忘录内容。','lastMemorySummaryTimestamp','<p>','</p>\x0a\x20\x20\x20\x20','variation-product-image','\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。','[表情]','search-history-back-btn','\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27','https://i.postimg.cc/fyyGgW61/IMG-7115.gif','删除\x20(0)','...]','正在为角色“','save-npc-btn','message-editor-block','清空购物车','https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','刷新页面？','操作已取消','isTemporary','https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','avatar-frame-modal','[系统提示：你\x20','###\x20玩家身份配置:\x0a','world-book-entries-container','请输入新的名称（留空则恢复默认）','.product-item.selected','simulatedAlbum','shared-history-viewer-content','\x22\x20id=\x22','总结长期记忆时出错:','originalType','poll','npc-editor-modal','https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','号玩家:\x20','book-upload-input','切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？','-\x20(ID:\x20','已成功加入购物车！','无法找到对应的分享记录或记录已损坏。','<span\x20class=\x22offline-dialogue\x22>','聊天记录已成功分享到\x20','select-all-recipients','data:image','消息已更新！','save-preset-btn','https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','”的手机使用习惯...','shopping-back-btn','createWriteStream','product-editor-modal','douban-detail-post-title','music-time-counter','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]','编辑记忆','share-link-btn',':generateContent?key=','.rules-tab','游戏即将开始，正在为各位玩家分配身份...','.call-record-card','。你可以使用\x20\x27vote\x27\x20指令参与投票。]','-\x20(头像库是空的，无法更换头像)','thoughts-history-list','voiceId','\x0a-\x20\x20\x20**五子棋局势**:\x20','export-single-chat-btn','删除对话','**。','qzone-banner-input','请先从下拉框中选择一个要删除的预设。','总结成功','\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“','\x20其中包括以下投票：','\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20','修复完成！','share_card','思考中...','https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','switchToCharScreen','message-editor-block\x20variation-block','.message-wrapper','transfer-sender-name','加载失败','finishReason','create-poll-modal','检测到\x20Tavern\x20AI\x20世界书文件，执行兼容导入...','.custom-multiselect\x20.select-box','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','paid','reset-custom-css-btn','严重警告！','switch-greeting-btn','add-ai-avatar-upload-btn','Cphone','https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','--\x20点击选择\x20--','.frame-grid','clear-posts-modal','**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（','\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','showStatusBar','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22','declined','在这里输入图片描述...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','tableName','”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','AI女巫决定使用毒药，目标是:\x20','cart-total','.upload-variation-image-btn','<div\x20class=\x22poll-card\x20','\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','edit-post-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','(你是第一个发言的人)','ai-persona-group','zIndex','linked-chats-checkboxes-container','werewolf-game-btn','is-waimai-request','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>','spectator-propel-btn','<span\x20style=\x22color:\x20red;\x22>未运行</span>','offlineMaxLength','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','-\x20昨晚是平安夜，无人死亡。\x0a','regenerate-char-diary-btn','offsetLeft','Sticker','rp-direct-receiver','AI\x20角色\x20\x22','cancel-wolf-kill-btn','cancel-frame-settings-btn','chat-settings-modal','https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','SAFETY','music-playlist-btn','role','检测到旧版完整备份文件，开始导入...','\x20条消息吗？这会通知AI这些消息已被删除。','custom','\x0a**---\x20第\x20','https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','[语音消息:\x20','网络图片','》吗？','文件解析或应用失败:\x20','\x0a-\x20','manage-world-book-categories-btn','》:\x0a','horizontal','label[for=\x22','<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>','专辑封面已更新！','\x22\x20data-description=\x22','\x0a\x0aAI原始返回内容:\x0a','\x0a\x0a##\x20世界书:\x20',')\x20刚刚投票给了\x20“','showRedPacketDetails收到了无效的packet对象','.loading-spinner','cart-item','修复了角色\x20\x22','\x22\x20的记忆中清除了1条关于已删除评论的通知。','callRecords','最近\x2020\x20条','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.','write','content','qzone-nickname','https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','\x0a**内容:**\x0a','.poll-option-item','修改昵称','https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','.cart-item-checkbox[data-id=\x22','inject-thought-group','max','.selected','基础数据不完整，无法开始总结。','isDeleted','请输入新的封面图片链接','replyTo','生成模拟淘宝记录失败:','对方已收款','命名头像','char-memo-detail-back-btn','无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20','用户向你发送了一张图片','memories-back-btn','[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“','mes_example','删除消息','\x0a\x0a#\x20待总结的群组视频通话记录\x0a','.entry-enabled-switch','\x0a-\x20**可以刀的玩家列表**:\x20','rp-direct-total','char-taobao-screen','handleWidgetImageChange','.photo-delete-btn','</span><span\x20class=\x22poll-option-votes\x22>','https://api.vkeys.cn/v2/music/netease?word=','确定要从你的头像库中删除“','rp-direct-amount','\x20发布了一条新公告','appIcons','确认清空动态？','\x20死亡了。','participants','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','”。\x0a','将清空选定角色的所有对话消息、曾用备注和你的昵称。','tts_','（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a','full','https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','call-message-bubble\x20','add-chat-btn','button','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','getBattery','https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','已死亡的用户(','days','send-poll-btn','结算(','visibilitychange','文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。','<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27','选择歌词导入方式','world-book-tabs','favorites-back-btn','保存\x20API\x20预设','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>','qzone_like','sticker','querySelector','getHours','@[[','char-memo-screen','aiAvatarFrame','https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','检测到刚结束的通话，正在注入通话记录上下文...','\x20发送了一个【专属红包】(时间戳:\x20','预设已删除。','change_group_name','replace','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20','image-mode-content','prepend','仅清空\x20','and','天\x20-\x20白天','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg','\x0a##\x20---\x20来自','reverse','检查更新时出错:','level','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>',')，内容摘要是：“','请输入一个有效的图片URL！','poll-options-container','删除预设','go-to-cart-btn','werewolf-role-description','locationName','npc-avatar-input','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','reject','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>','cssText','change_remark_name','\x22\x20class=\x22avatar-frame\x22></div>','favorites-action-bar','📁\x20从本地文件\x20(.lrc)','https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','导出成功','<p\x20style=\x22font-size:12px;color:#888;\x22>','filter','API\x20请求失败:\x20','游戏开始','\x20分享了Ta的位置：\x27','-\x20**即将演唱**:\x20','.contact-picker-item[data-contact-id=\x22','请输入群聊的名字','music-player-overlay','head','avatar','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>','请至少选择一个要添加的联系人。','product-variations-container','red-packet-details-modal','blocked_by_user','编辑规则','通话记录已成功总结并存入角色“','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20','保存CSS预设','[系统提示：你于时间戳\x20','now','#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：[','-9999px','.sticker-item[data-sticker-id=\x22','用户删除了自己的评论，开始清理AI记忆...','lyric-line','stores','borderColor','”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','all\x200.3s\x20ease','transition','sender-name','confirm-share-link-btn','查看失败','summaries','custom-bubble-style','传统导出\x20(兼容旧版或内存小的浏览器)','已经一起听了','https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','chat-list-bottom-nav','char-amap-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>','无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20','#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','input:checked','\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a','theme-preset-select','qzoneSettings','游戏结束，开始自动总结并注入记忆...','numeric','album-photos-screen','preset-tabs','发送好友申请','猎人带走了\x20','heartfeltVoice','”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20的后台活动开关已关闭，本次跳过。','QQ音乐','close-transcript-modal-btn','highlighted','(无标题)','char-wallet-content','isPlaying','rotating','.music-search-checkbox','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>','删除分类及表情时出错:','https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20如果选择评论，优先回复那些提到了你或回复了你的评论。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','shoppingProducts','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20','user_photo','创建新聊天\x20(第1/2步)','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','groupAvatarLibrary','change_user_avatar','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','#product-grid\x20.product-item','对方本名不能为空！','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>','<input\x20type=\x22checkbox\x22\x20value=\x22','[发送了一条复杂消息，如卡片或转账]','values','该消息发送已超过2分钟，无法撤回。','chatItem','qzoneGroups','检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。','secondaryModel','消息内容已复制到剪贴板。','frame_11','\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>','commentText','生成模拟日记失败:','padding','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>','在这里输入回复内容','char-music-player-modal','rejected','https://www.myinstants.com/media/sounds/notification-sound-2.mp3','</div><div\x20class=\x22description\x22>','cphone-icon-settings-grid','正在等待AI角色们进行激烈的讨论...','**[讨论环节]**\x0a','hang-up-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','import-world-book-input','select-all-cart-items','activeChatId','没有聊天了。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','contactId','\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合“今天是','douban-settings-btn','\x22\x20点赞了动态\x20#','[系统提示：你接受了“','removeChild','clipboard','delete-css-preset-btn','.text','delete-world-books-list','chat-list-render-window-input','已被用户删除','paste','导入书籍失败:','openRenderingRulesScreen','playerJson','save-advanced-editor-btn','未知用户','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>','main-chat-list-header','字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a','<input\x20type=\x22','”写一篇新日记...','请输入歌名','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20元</div>','newSize','游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20','请为这个头像起个名字（例如：春日野餐、学习时间）','announcement-item-actions','请输入一个有效的URL或选择一个文件！','greeting','isGameOver','\x27\x20在你的动态(ID:\x20','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20','确认送出礼物','char-diary-detail-title','\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。','https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','char-conversation-partner-name',')\x20内容:\x20\x22','setItem','\x0a-\x20**长期记忆**:\x20','update-notice-modal','secondary-proxy-url','\x0a你必须严格遵守','-\x20\x20\x20**对话状态**:\x20','address','[表情]\x20含义:\x20\x22','var-','lyrics-offset-input','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','input[name=\x22visibility\x22]:checked','https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','请选择一个接收人！','\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','save-shopping-settings-btn','诊断：在\x20data.character_book\x20中找到世界书。','编辑通话消息','save-world-book-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','world-book-screen','”下，回复了\x27','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','20px','\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','请输入要精炼的最近记忆条数\x20(最多\x20','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','notification-sound-player','（无有效对话记录）','frame_9','category','poll-option-input-wrapper','reduce','https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','\x20的日记','join-call-btn','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','reason','已成功收藏到“我的收藏”页面！','4.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20(','https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','\x20剩余红包将在','你们没有在读书。','reading-library-list','isFullyClaimed','offsetX','</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20','char-music-next-btn','\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a','votes','poisonUsed','gift','currentText','小组风格','**[投票结果]**\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','removeEventListener','EPhone-长截图-','global-bg-preview','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','status-bar-toggle-switch','meaning','\x22\x20class=\x22avatar\x22>','manage-sticker-categories-btn','close-my-avatar-library-btn','show-announcement-board-btn','[data-version]','line-through','message-bubble\x20post-deleted-placeholder','♪\x20♪\x20♪','没有配置为后台活跃的角色，跳过模拟。','total','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','死亡了','1px\x20solid\x20#e0e0e0','[发送了一条语音，内容是：\x27','https://image.pollinations.ai/prompt/','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>','你赢了','https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','setAttribute','请为这个表情命名\x20(例如：开心、疑惑)','https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','visible','代付请求已被拒绝','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','readAsText','<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22','游戏结束','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a','AI幻觉已被拦截！试图使用群名\x20(\x22','appName','targetId','https://i.postimg.cc/B6T59xGK/IMG-7101.gif','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','精炼“','没有可供重新生成的AI响应。','{{user}}','小红书','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22','https://i.postimg.cc/SNByPrf9/IMG-7005.gif','import-single-chat-btn','char-browser-screen','npc-list-view','你是狼人，请选择刀人目标。','...”)','</span></div><div\x20class=\x22rp-type\x22>','这将用备份文件中的数据【完全覆盖】当前与“','</p>','toLocaleString','\x20-\x20','price','检测到并成功修复了\x20','save-api-settings-btn','女巫已行动，女巫请闭眼。','werewolf-player-avatar','find','isAlive','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','index','已成功注入“切换到线上模式”的系统指令。','\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','\x22)\x20作为角色名。消息内容:','检测到AI执行了动态操作，立即刷新好友动态页面。','offlinePresetId','clear-posts-item','API错误:\x20','secondaryProxyUrl','participant-avatar-wrapper','chat-settings-btn','请开始整合。','\x20\x20-\x20你评论说:\x20','\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>','confirm-create-poll-btn','1635058JSnoFG','-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','[一张图片，描述为：“','call-history-title','下在(','linked-memory-selection','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','data-clear-step-2','</div>\x0a\x20\x20\x20\x20','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','bg-btn','拼手气红包','complex','确定要永久删除这条动态吗？','countdownEndTime','<label><input\x20type=\x22checkbox\x22\x20value=\x22','上一条消息的发送时间是\x20','htmlFor','browser-back-btn','清理完成','gomoku_move','https://i.postimg.cc/CKgDNYVb/IMG-5577.gif','\x22\x20转发了动态\x20#','商品已删除。','presetCategories','reset-button-order-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>','创建群聊','appendChild','AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。','options','<textarea\x20id=\x22','outgoing-call-screen','dataset','isAwaitingResponse','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>','\x20\x0a-\x20**你最近和“','已返回我的手机','https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','scale(0.8)','log','\x22\x20已经存在了！','）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20','.post-mode-switcher','waimai-amount','”)下发送了一个表情评论，意思是：“','确定要删除选中的\x20','chat-input','<img\x20src=\x22','chat-header-title','char-background-activity-switch','导入成功！','已成功收藏\x20','发来了\x20','User\x20Avatar','settings','https://i.postimg.cc/cLPP10Vm/4.jpg','\x0a[文字图内容:\x20','\x20的外卖订单支付了\x20','转账已被拒收','<div\x20class=\x22custom-title\x22>','备注名/群名不能为空！','offsetTop','fetch-secondary-models-btn','claimedBy','未知发送者','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22','[系统提示：你\x20(','#avatar-frame-modal\x20.frame-tabs','.variation-image-input','lastFailedAction','\x22\x20处于行动冷却中，本次独立行动跳过。','clientY','检测到\x20EPhone\x20备份文件，执行标准导入...','white','proxyUrl','\x20更换了头像]','错误:\x20','timestamp','ai-frame-grid','reading-library-modal','对方正在输入...','\x20回复了你。','isOpen','ttsCache','order','wb_','.cart-item-checkbox:checked','\x0a\x0a#\x20情景感知:\x0a\x20\x20\x20\x20','direct','.custom-multiselect','qzone','操作失败:\x20','浏览器不支持电池状态API。','正在读取所有数据到内存中，请稍候...','找不到主角\x20“','bg-input','position',';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20','data-clear-type-list','\x20天的讨论环节。\x0a','为什么','pinned',')。操作已被拦截。','.playlist-item','.char-photo-item','从完整链接批量导入','right','remove-bg-btn','activePostId','...\x22):\x20','decline-call-btn','douban-send-comment-btn','用户\x27','groupNickname','existing-group-item','memberId','</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','new-category-name-input','<button\x20class=\x22sticker-category-tab\x20','existing-categories-list','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是','hasListener','选择导出方式','unreadPostsCount','AbortError','个月前','werewolf-selection-item','确定要删除这条渲染规则吗？','.format-btn','.toggle-content-btn','long','约定达成！','...','https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','”的好友请求','\x22\x20尝试执行未知的后台动作:','https://i.postimg.cc/ThMMVfW4/10.jpg','检测到新版流式备份文件，开始导入...','没有找到可导入的内容。','show-avatars-btn','isGroupCall','persona','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','.voice-play-btn','variation-product-name','cancel-member-settings-btn','\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','点击下方上传','upload-global-bg-url-btn','<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>','\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22','char-music-screen','test-sound-btn','guard','dblclick','https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','#music-lyrics-container','确定要从播放列表中删除《','product-category-tab','\x20同步所有群聊内的名称信息...','music','data:','.ai-generated-image','-\x20\x22','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','injectLatestThought','waimai-confirm-btn','world-book-checkboxes-container','call-history-back-btn','waimai-product-info','cancel-create-poll-btn','结束投票','预言家请睁眼，请选择要查验的玩家。','\x22\x20的本次后台活动跳过。','设置已应用','本地头像上传及识别失败:','https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','请你对此作出回应。]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','chat-list-screen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','char-browser-history','werewolf-','\x20请根据这个结果发表你的评论。]','执行出错','player','\x22)。操作已被程序阻止。','选择要精炼记忆的角色','现在，请所有AI角色针对刚刚的发言（特别是\x27','toFixed',']类型的消息','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','refine-memory-btn-header','取消置顶','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','status-bar-battery','狼人已行动，狼人请闭眼。','豆瓣设定','description','replyToName',')\x20已被用户忽略，无需显示。','frame_13','\x22\x20class=\x22sticker-image\x22>','票):\x20','global-custom-style','”这个信息，将其转换为【具体的公历日期】（例如：“约定了明天见面”应总结为“我们约定了','prev-page-btn','rp-group-total','”分享TA的备忘录...','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20','https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','https://i.postimg.cc/wMxmCZVC/IMG-7099.gif','请根据你的设定，生成你的淘宝购买记录和余额。','确定要永久删除这条心声记录吗？此操作不可恢复。','bookId','editable-text','(暂无有效聊天记录)\x0a','chatRenderWindow','toLocaleDateString','undefined','touchstart','export-data-btn','送给大家的礼物','load-more-thoughts-btn','守卫已行动，守卫请闭眼。','\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22','splice','regex','https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','get',']\x20(ID:\x20','(回复\x20','span','所有解码尝试均失败:','simulatedMusicPlaylist','\x22\x20记录了一条新回忆:','parts','isHidden','相册已成功删除。','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','add','...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】(','boxSizing','function','music-player-avatar-display','cancel-share-target-btn','天，救人概率为\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','block-cooldown-input','data-clear-wizard-modal','generativelanguage','char-music-progress-fill','https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20','minimaxVoiceId','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>','》设定:\x0a','\x20分钟)</span>','https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','删除分类后，该分类下的所有预设将变为“未分类”。确定吗？','#data-clear-type-list\x20.clear-posts-item','下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>','生成失败','AI返回的数据不是一个数组。原始返回:\x20','remove-member-btn','worldBooks','groupId','\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20','innerText','https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27','维基百科','\x22\x20已经存在了，换个名字吧！','\x22\x20data-commenter-original-name=\x22','<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20','管理预设分类','my-persona','</span>:\x20','恭喜发财，大吉大利！','在此修改，或点击上方按钮使用格式模板...','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cphone-wallpaper-upload-input','AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:','确定要将以下消息发布到公告板吗？\x0a\x0a“','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>','来自\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','draggable-button-item','status-bar-visible',')**:\x20','send-btn','world-book-tab','cphoneAppIcons','blockedTimestamp','</option>','AI\x20获胜了！','totalTime','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cancelable','font-url-input','”。请你对此作出回应。]','<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>','https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','douban-detail-content','char-music-mode-btn','无法推进剧情:\x20','保存字体预设','您的旧有记忆已被完整保留，未作任何修改。','**\x20(本名:\x20','charId','groupAvatar','\x0a\x0a#\x20对话者的角色设定\x0a','preset-entries-container','聊天记录已成功覆盖！正在刷新界面...','create-post-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20','chat-list-item','repost-modal','#gift-recipient-list\x20.contact-picker-item','transfer-action-cancel','delete-appearance-preset-btn','尝试打开一个不存在的世界书，ID:','favorite','currentPlaylist','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>','world-book-category-pane','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','创建新聊天\x20(第2/2步)','notification-avatar','aiAvatar','[发送了一张图片，描述为：\x27','sticker-category-manager-modal','已使用','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','download','switch-to-image-mode','startY','API未配置，无法进行总结。','preset-screen','assistant','wolfKill','狼人杀AI回应生成失败:','生成模拟足迹失败:','#gift-recipient-list\x20.contact-picker-item.selected','#333','tables','lyricsPosition','doubanActiveCharacterIds','import-card-input','beginPath','confirm-gift-recipient-btn','char-diary-list','<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20','处理通话请求时API出错:','API失败:\x20','posts','variation','请输入背景图片的URL','packetType','system','#music-lyrics-container\x20#music-lyrics-list','lucky','QQ音乐搜索API失败:','chatLinks','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','\x27的发言）继续进行讨论。','edit-call-message-btn','touches','target','<span\x20style=\x22color:\x20green;\x22>是</span>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','manual','https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','search-results-list','<tr><td\x20class=\x22item-name\x22>','AI返回的change_music指令中，歌曲名无效或缺失:','char-music-total-time','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg','gift-receipt-modal','rules-tab\x20active','请所有AI角色开始投票。','.voice-transcript','minimax-group-id','表情名不能为空！','<input\x20type=\x22checkbox\x22\x20value=\x22book_','.qzone-post-delete-action','https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','album-screen','manage-preset-categories-btn','open-sticker-panel-btn','【原动态内容:\x20','https://i.postimg.cc/13hhJ77p/IMG-4419.gif','操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20','未选择书籍','world-book-group-container','add-preset-btn','-\x20**当前时间**:\x20','”准备好友申请...','font-preview','<span>','battery-alert-text','(未设置)','https://i.postimg.cc/PrcKH436/IMG-4376.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**','playlist-body','data','.chat-group-content','在角色\x20\x22','检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。','api-key','{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}','memories','messages-view','专属红包:\x20给\x20','add-ai-avatar-batch-btn','.message-bubble[data-timestamp=\x22','worldBookCategories','product-price-input','确定要删除NPC\x20“','）完成了支付。此订单已关闭，其他成员不能再支付。]','currentX','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','postType','is_busy','players','toggle-fullscreen-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','cancel-rule-editor-btn','用户(','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','post-public-text','last','https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','douban-comment-input','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>','manage-products-btn','check-and-fix-data-btn','表情含义','https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toggle-blur-btn','\x22\x20(ID:\x20','置顶公告','touchmove','custom-frame-upload-input','NPC人设','\x27)\x22\x20data-comment=\x22','amount','商店空空如也，点击“管理”添加商品吧！','内心独白','10BXRimv','彻底删除消息','cart-count','accept_transfer','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','**:\x20关于\x20**','load-more-btn','douban-detail-content-wrapper','button-order-editor','save-frame-settings-btn','thoughts','preset-category-select','announcement-action-delete','Caching\x20rendering\x20rules\x20for\x20chat:\x20','char-memo-detail-screen','offline-mode-group','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20class=\x22avatar-frame\x22></div></div>','”\x20将备注修改为\x20“','\x20发起了一个投票\x20(时间戳:\x20','temp_npc_chat','发现新版本通知:\x20','custom-prompt-input','获取AI投票失败:','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','”\x20的详细角色信息。','remove-ephone-bg-btn','https://i.postimg.cc/k45sd8gn/IMG-6375.gif','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20','\x20的红包已被领完','未知NPC','originalName','px)','已成功导出所有数据！','save-font-preset-btn','”的参考记忆','https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','已取消收藏。','add-new-category-btn','导出数据时出错:','<s>$1</s>','https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','cancel-clear-wizard-btn-step1','option','add-my-avatar-batch-btn','icon-settings-grid','<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>','\x0a#\x20群成员列表\x20(你的总结目标)\x0a','打开预设编辑器时发生严重错误:','load-more-chats-btn','is-acting','page-indicator','\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“','send-direct-packet-btn','bubble_theme','https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','数据迁移完成！总共修复了\x20','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','-\x20你昨晚查验了\x20','\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','在动态评论区点击了表情，但在表情库中未找到对象:','sendQzoneStickerComment:\x20找不到帖子:','primaryKeys','playlist-item','.nav-item[data-view=\x22qzone-screen\x22]','请输入一个有效的数字（建议大于20）。','）刚刚撤回了一条消息。撤回前的内容是：','1.0','编辑人设预设','music-play-pause-btn','用户已忽略版本:\x20','api-temperature-slider','hasOwnProperty','board','model-select','正在请求网易云音乐API:','cancel-reply-btn','申请失败','hasShown20','delete-btn','value','touchend','from','.chat-list-item','https://api.vkeys.cn/v2/music/tencent/lyric?id=','https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。','.frame-item.selected','[收到一个外卖代付请求]','EPhoneWorldBookBackup','请输入新的图片URL：','清空所有动态\x20(危险)','gridEl','system_message','update_status','memo','shopping-settings-modal','save-api-preset-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','当你死亡时，你可以选择带走场上任意一名玩家。','已成功批量导入\x20','无共同好友','<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>','AI返回的内容中未找到有效的JSON对象。','角色\x20“','找不到匹配的书籍','\x20群里已经安静了','无法访问剪贴板。','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。','”图标','variations','https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','myAvatarFrame','内容因安全策略被屏蔽\x20(原因:\x20','精炼长期记忆时出错:','文件不是一个有效的PNG。','3914406mTqJJd','characterName','\x0a#\x20身份与核心任务\x0a你正在扮演角色“','https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','body','auto','请输入预设名称','member-persona-input','[转账]','timeupdate','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20的消息:\x20\x22','recordId','ruleId','AI\x20\x22','gomoku-board','chat-lock-content','silent-audio-player','chatActionButtonsOrder','每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。','请输入歌手名','我拒绝了你的视频通话请求。','.werewolf-player-checkbox:checked','commenterOriginalName','导入世界书','\x20领取</div>','更换图片','.waimai-user-actions\x20button','https://generativelanguage.googleapis.com/v1beta/models/','ai-cooldown-group','读书会话已关闭。','成功移除了\x20','\x0a#\x20【【【行为倾向指令\x20(高优先级)】】】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【首要任务】应该是去**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【应该避免】再次发布新动态，除非你有一个非常紧急或绝佳的新想法。\x0a','publicText','currentSnippet','成功检查并修复了\x20','receiver','product-category-manager-modal','\x20[社交背景:\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','分钟前聊过。','你已拒收','npc','myAvatarLibrary','trans','#avatar-frame-modal\x20.modal-body','<span\x20class=\x22diary-handwritten\x22>$1</span>','replaceChild','\x20的图片消息替换为文字描述...','https://api.vkeys.cn/v2/music/netease?id=','https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','is-red-packet','contact-picker-screen','char-product-item','-\x20(空)','\x20的头像框到群聊\x20\x22','my-nickname-group','post-visibility-groups','#000000','收到了未知的AI指令类型:','width','data-clear-step-1','https://i.postimg.cc/3NDQ0dWG/image.jpg','请稍候','https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','linkedMemoryCount','\x0a---\x0a','charging','还没有任何评论，无法等待回复。','\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20','font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);','\x0a-\x20**世界观**:\x20','\x22\x20placeholder=\x22','currentIndex','说说内容不能为空哦！','https://i.postimg.cc/wx72fhr2/IMG-5968.gif','昨晚是平安夜。','shoppingCategoryCount','quote_reply','页面跳转','#\x20对话示例\x0a','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22','最近的消息太少，无法进行有意义的总结。','input','在这里输入图片描述','\x0a-\x20**帖子内容摘要**:\x20','播放失败，请检查URL是否正确或浏览器是否支持该格式。','my-nickname-input','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','notificationSoundUrl','name','\x22\x20中的成员信息更新','delete-selected-stickers-btn','substring','add-ai-avatar-url-btn','诊断：在\x20extensions.character_book\x20中找到世界书。','red_packet','\x22\x20的整个对话吗？此操作不可撤销。','character-profile-modal','确认抹除','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','delete-world-books-modal','preset-content-container','link-description-input','在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。','动态发布成功！','global-lyrics-bar','message-actions-modal','messageTimestamp','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','EPhone-Full-Backup-Streamed-','\x0a\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。','AI返回的刀人目标格式不正确。','”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','album-art-btn','https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','\x0a###\x20详细对局流程:\x0a','confirm-variation-selection-btn','reset-global-css-btn','random','.entry-comment-input','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“','.countdown-card\x20.timer','prompt_order','repost-comment-input','https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','在同时执行两个函数时出错:','pageY','确定要拉黑“','选中的表情已成功删除。',']类型的消息。\x0a内容:\x20','hasShown40','请AI角色们继续进行讨论。','/v1/chat/completions','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>','\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20','\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a','检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。','确认替换','复制失败','创建世界书','删除相册','(Timestamp:\x20','qzone-back-btn','#delete-world-books-list\x20.clear-posts-item','\x20被投票放逐。','https://i.postimg.cc/xTk5xN49/IMG-7233.gif','sticker_','\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a','更换歌曲背景','&id','\x22\x20触发行动决策...','一位成员','mousedown','announcements','round','对方拒绝了你的视频通话请求。','char-memo-list','https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','group-avatar-upload-input','post-image-desc-group','</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>','items',')。详情:\x20','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','[系统提示：用户\x20(','announcement-board-modal','sticker-category-tab','chat-name-group','group-video-call-btn','文字已更新！','phone-screen','\x20(本名:\x20','display','npc_','<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>','werewolf-witch-selection-list','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22','https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','change_music','select-all-music-search','char-diary-detail-screen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','.incoming-call-content\x20.caller-text','\x22:\x20[\x0a','手动注入记忆时出错:\x20','transcript-modal-title','公用规则','postTitle','postId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','imageProcessed','渲染聊天项\x20[','群里已经安静了\x20','qzone-sticker-grid','countdown','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>','stopPropagation','\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动。\x0a3.\x20\x20**【简洁性铁律】**:\x20每条个人记忆总结【绝对不能超过60个字】。\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我今天在群里和大家讨论了电影，感觉很开心。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我在群里和','reading-library-search-input','[系统提示：用户(','分钟前','uncategorized','\x20更换了群头像','冗余数据清理流程已启动...','chat-list-action-delete','cancelText','cart-back-btn','<span\x20class=\x22commenter-name\x22>','\x0a-\x20**你的曾用名**:\x20[','13810yRREPj','douban-detail-back-btn','getTime','.world-book-group-content','findLastIndex','后台活动模拟已停止。','相册\x20\x22','#b5b5b5','char-music-artist','backgroundColor','post-remove-image-btn','parsedLyrics','Bilibili','该条记录已成功删除。','更换“','callHistory','https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','跳过一个无法解析为JSON的编辑块:','生成模拟相册失败:','call','https://i.postimg.cc/bJDMQVkj/IMG-7112.gif','new-product-category-name-input','要为《','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','未知设定的角色','\x20天\x20---**\x0a','.sender','clientX','https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','通话结束，时长\x20','wallpaper-upload-input','播放已暂停','records','群聊\x20\x22','pointer','werewolf-lobby-modal','”的对话摘要**:\x0a','offsetHeight','disable','members','.douban-cast-checkbox','theme-default','vote_for_name','renderWorldBookScreenProxy','将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。','./sw.js','music-mode-btn','\x20\x20-\x20评论:\x20','commentIndex','请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。','startX','isBgClear','shopping-product-count-input','onplay','导出单个聊天时出错:','time-zone-select','后台活动模拟已自动启动。','send_and_recall','gameMode','char-music-prev-btn','cphoneWallpaper','member-management-list','确认总结','\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)','\x0a#\x20你的聊天对象（用户）的人设\x0a','https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','cancel-message-action-btn','.variation-block','frame_tech','globalCss','\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>','font-size-value','target_timestamp','originalContent','cursor','blob','确认操作','99+','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','center','”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','添加完成！\x0a\x0a成功添加\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>','请输入关键词或选择一个日期。','<div\x20class=\x22post-comments-container\x22>','add-group-chat-btn','请输入网络图片的链接','你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！','#data-clear-type-list\x20.clear-posts-item.selected','recipients','请输入有效的金额！','\x20的对话\x20(只读)','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20','https://i.postimg.cc/XY63sTS3/IMG-4393.gif','chat-header-status','歌曲信息','close-call-transcript-btn','\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？','这是你们最近的对话：\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20','\x20邀请你加入群视频','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','default','https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','sticker-grid','群聊已建立...','\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','确定要删除与\x20\x22','https://i.postimg.cc/yx2m4nbs/IMG-7231.gif','请根据以上设定开始你的决策。','获取AI狼人目标失败:','red-packet-modal','\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>','.avatar','scrollIntoView','global-css-input','请先在API设置中配置好（主或副）API。','currentVoiceId','一个普通玩家','[系统提示：用户加入了通话]','pin','npc-background-activity-switch','</span>','https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','NPC\x20\x22','renderingRules','</td><td\x20class=\x22item-qty\x22>','char-article-content','\x20当前时间是\x20','minimaxModel','#delete-world-books-list\x20.clear-posts-item.selected','placeholder','<strong>','originalPost','最后确认！','photoCount','test','decision','<div\x20class=\x22poll-options-list\x22>','post_deleted_notice','enabled','memory-list-container','.qzone-post-item','[照片]','https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','recipientName','local',']。当在对话历史中看到这些名字时，它们都指的是【你】自己。','manage-product-categories-btn','animate-like','.recalled-message-placeholder','你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥','music-search-results-modal','已选择\x20','错误：找不到该通话记录所属的聊天对象。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥','还没有可供编辑的AI响应。请先让AI回复一次。','”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x20\x20\x22messages\x22:\x20[\x0a\x20\x20\x20\x20{\x22sender\x22:\x20\x22','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','shoppingCategories','\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a','<p>♪\x20暂无歌词\x20♪</p>','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','female-shaonv-jingpin','主API和副API均未配置或配置不完整。','favorite-memo-btn','\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“','close-playlist-btn','voteResults','map','ended','https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','activeAlbumId','\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>','toArray','.post-nickname','#outgoing-call-screen\x20.caller-text','mousemove','请先在API设置中配置好API信息。','textarea','确认清理冗余数据？','\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerUrl\x22:\x20\x22...\x22,\x20\x22stickerMeaning\x22:\x20\x22含义\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','\x0a-\x20**身份**:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','8px','lastActionTimestamp','copy-message-btn','handleListenTogetherClick','char_browser_article','utf-16be','music-current-time','我通过了你的好友申请，我们现在是好友啦！','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','save-product-btn','timerId','linked-memory-count','chat','https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','.delete-btn','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【【【长度铁律】】】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**','confirm-wolf-kill-btn','https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','isDragging','####\x20','rule-template-input','\x0a#\x20可用指令列表\x20(按需组合使用)\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22url\x22:\x20\x22https://...表情URL...\x22,\x20\x22meaning\x22:\x20\x22(可选)表情含义\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','secondary-model-select','regenerate-char-taobao-btn','gomoku-overlay','无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20','#\x20场景设定\x0a','\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','”翻开TA的日记本...','\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','cancel-persona-editor-btn','请输入头像的图片URL','\x20\x20-\x20在群聊“','confirm-delete-world-books-btn','music-playlist-panel','image/*','删除商品','LOW','authorAvatarPrompt','isActive','pat_message','这是群里的第一条消息。','”的长期记忆中。','call-message-bubble\x20user-speech','{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20','”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','group_call_request','offsetWidth','video_call_request','\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','getElementsByTagName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','music-exit-btn','.delete-track-btn','entries','.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a','\x0a\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a','聊了关于生日派对的事，我们约好了10月1日见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a','preset-action-delete','\x22\x20更换了头像','char-album-screen','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','您正和「','你领取了\x20','记忆链接','请至少选择一个要清空的范围。','nextElementSibling','transfer-modal','sourceChatName','*对方按下了接听键...*','}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','[♪\x20','cancel-create-countdown-btn','通话记录已删除。','commentsCount','https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','rule-regex-input','[私聊]','authorName','-\x20\x20\x20**当前时间**:','chara','active','开场\x20','\x20删除了自己的一条动态]','#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a','游戏配置：','normal','promptFeedback','已撤回的消息','》的歌词已成功保存！','送出礼物','https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','change-frame-btn','applicationReason','char-browser-article-screen','video_call_response','stickerUrl','each','mouseup','favorites-search-clear-btn','https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','50%','my-group-nickname-group','orderBy','\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','[系统提示：用户打开了五子棋棋盘，游戏开始了。]','确定切换','[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','</span></div></div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','</p><p>','preset-editor-title','https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','appearancePresets','#e9ecef','zh-CN','https://generativelanguage.googleapis.com/v1beta/models','\x20.message-bubble.user\x20$1','delete-group-btn','\x20觉得很赞</span></div>','chatListRenderWindow','char-main-date','[表情:\x20\x27','char-usage-item','#\x20性格补充\x0a','从CPhone推进真实对话失败:','cart-item-checkbox','cart-title','user','\x22\x20data-commenter-display-name=\x22','-\x20公告内容:\x20\x22','\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a','parentElement','ServiceWorker\x20注册成功，作用域为:\x20','[表情，含义:\x20','currentPhase','likesCount','\x0a#\x20待总结的对话历史\x0a','\x20元。]','\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。','onloadend','current','关于“','</span><span>','.qzone-post-container[data-post-id=\x22','未知成员','\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20','checked','select-message-btn','\x20拍了拍我','clear-specific-data-btn','qzone-posts-list','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','douban-detail-comments-list','my-frame-grid','preview-bubble-style','点击了商品卡片:\x20','TA的好友包括:\x20','#text-image-mode-content','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','合计:\x20¥','当前人数\x20','selection-cancel-btn','https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','senderName','https://i.postimg.cc/htZppbS4/IMG-7107.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**','includes','post-actions-btn','char-main-time','song','models','你们正在一起听歌，','readAsDataURL','[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','AI\x20的下棋指令无效或位置已被占据:','昨晚是平安夜','save-theme-preset-btn','AI已将新头像命名为：“','propel-btn','offset','被投票放逐','anime\x20person','”添加记忆','css-preset-select','\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a','正在请求AI进行记忆精炼...','typing-indicator','请根据以上情景，生成新的评论。','visibilityState','call-transcript-modal','.world-book-tab','[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]','https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','\x0a#\x20当前五子棋局势\x0a','狼人杀AI讨论生成失败:','删除失败','target_name','categoryId','reading-overlay','确认清空','contains','preCallContext','外观设置已保存并应用！','compress-images-btn','chats','文章详情','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20','</td><td\x20class=\x22item-price\x22>¥','AI生成的图片','call_summary','import-preset-input','reading-content','product-grid','custom-modal-confirm','error','qzone-post-delete-action','object','toDataURL','change','#fullscreen-lyrics-container\x20.music-lyrics-list','image_url','，我们一起见证了这个约定。','EPhone-Full-Backup-Legacy-','¥\x200.00','AI\x20尝试赠送一个格式不正确的随机礼物:','variation-quantity-display','artist','请根据你的设定，生成你的高德地图足迹。','https://i.postimg.cc/fRTF24jS/IMG-4430.gif','block_user','clientHeight','确认压缩图片？','image_post','\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','分组名不能为空！','delete-selected-products-btn','切换听歌对象','getTimezoneOffset','setHours','AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。','标题:\x20','[图片动态]','-\x20**姓名**:\x20','forEach','https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','werewolf-action-bar','group_','minimax-api-key','【用户\x20(User)】','https://i.postimg.cc/T2yKJ0DV/40.jpg','ai_image','[表情:\x20','buttonId','syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','pat-btn',',\x20价格:\x20¥','等待回应','image-upload-input','isUserParticipating','这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？','\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>','sender','annoId','confirm-create-post-btn','Autoplay\x20was\x20prevented\x20by\x20the\x20browser.','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','ServiceWorker\x20注册失败:\x20','table','https://i.postimg.cc/RZNLhbbr/IMG-4389.gif','stickerCategories','删除歌曲','true','group-name','my-avatar-library-title','<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22','onloadedmetadata','已取消收藏','轮到你发言了...','\x20同步所有群聊内的头像...','.screen','moveTo','[图片]\x20','a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting','json','\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！','无法找到或消息类型不匹配的分享链接:','删除头像','\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','itemName','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','确定要删除这个约定吗？','\x22)\x20在播放列表中未找到。','》吗？此操作将同时删除相册内的所有照片，且无法恢复。','werewolf-game-over-close-btn','\x22\x20(群名)\x20的消息。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a','现在开始讨论，请各位玩家依次发言。','[约定达成]\x20','\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a','还没有人','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20','offsetParent','input[name=\x22variation-select\x22]:checked','暂无内容...','未知作者','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url(','确定要删除这条评论吗？','流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','authorId','textAlign','lrc','\x20个表情吗？此操作不可恢复。','API设置','确认清理','maxMemory','++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','readingLibrary','arrayBuffer','product-editor-title','小时前','qzone_post','AI的五子棋移动指令包含无效坐标，已忽略:','member-avatar-input','<div\x20class=\x22spinner\x22></div>','background','save-wallpaper-btn',']\x20[最近对话:\x20','\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a','openNpcEditor','https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','showScreen','\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a','char-vinyl-container','找不到这个预设的详细信息。','*讨论记录*:\x0a','<p\x20class=\x22char-browser-image-description\x22>','upload-custom-frame-btn','gbk','\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。','\x20的动态\x20(角色)','favorite-item-card','\x20分钟，开始模拟后台活动...','删除成功','天\x20-\x20夜晚','api-preset-select','apiKey','werewolf-log-entry\x20system','确定要从头像库中删除“','群里还没有任何消息。','\x22\x20data-memory-timestamp=\x22','chat-list-actions-modal','没有可导出的世界书数据。','handlePacketClick','\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','translateY(','\x20票</span></div></div>','#listen-together-btn\x20img','\x22\x20class=\x22avatar-img\x22><img\x20src=\x22','hours','home-screen','\x0a#\x20---\x20世界书设定结束\x20---\x0a','正在生成“','offline-mode-options','background-interval-input','localeCompare','originalSize','send-waimai-request-btn','旁观模式推进剧情失败:','检测到群聊\x20\x22','）。]','请至少选择一个要删除的世界书。','location','style','删除表情','该预设包含\x20','imageDescription','announcement-action-pin','video-call-main','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22','npc-list-back-btn','确定要删除这条通话消息吗？','utf-16le','className','clear-chat-btn','selection-count','targetDate','products','++id,\x20timestamp','<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22','reading-restore-btn','<br>','isClosed','已同步角色\x20','请开始总结。','.cart-item-checkbox','\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','en-US','\x20的浏览记录','status_msg','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','.clear-posts-item','https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','decode','阵营胜利！','.message-bubble.is-link-share','countdown-date-input','getFullYear','人局，身份为\x20','endsWith','AI方','文件格式不正确，这不是一个有效的单聊备份文件。','\x20条旧的红包消息！页面将自动刷新以应用更改。','文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。','\x20已为','cleanup-data-btn','》及其下的表情已成功删除。','add-world-book-btn','browser','\x20个条目。','收藏成功','char_diary','\x20被刀了','rule-card\x20','公告已发布！','include','preset_','正在模拟“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','[系统提示：','gameLog','recalled_message','call-message-bubble\x20ai-speech','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','小时前聊过。','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>','is-gift','simulatedConversations','rp-group-amount','https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','我们和好吧！','对方撤回了一条消息','totalAmount','refined','cancel-ai-response-editor-btn','...\x0a-\x20**已有评论**:\x0a','rules-category-pane','.commenter-name','猎人死亡，请选择一名玩家带走！','照片详情','presetId','.nav-item[data-view=\x22memories-view\x22]','\x0a[图片]','https://i.postimg.cc/nryNzTXK/IMG-6915.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>','update_thoughts','group-members-settings','\x22\x20value=\x22','fullscreen-active','\x0a\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22','.participant-avatar-wrapper[data-participant-id=\x22','doubanMinPosts','character_book','waimai-order-for-ai-btn','https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','anno_','delete','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','”下，发送了一个表情评论，意思是：“','originalMeaning','导演模式保存了一个无效的五子棋移动指令:','分类《','toISOString','groupMembers','外观设置','sticker-category-tabs','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','link-memory-toggle','批量导入格式错误，已跳过此行:','my-avatar-upload-input','onchange','修改文字','probability','next-page-btn','save','import-new-book-btn-header','select-all-frames-checkbox','在PNG中找到角色数据，但解码或解析失败。错误:\x20','has-frame','”，内容是：“','member-management-screen','npc-name-input','char-photo-item','fullscreen','(无)','https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','char-wallet-back-btn','.lyric-line','预言家已行动，预言家请闭眼。','chat-list-action-cancel','createElement','getElementById','\x20.message-bubble.ai\x20$1','question','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','trim','apiTemperature','status','###\x20最终结果:\x20','无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。','private_user','你已收款','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>','model','18319697XkquqQ','change_user_nickname','ᗜωᗜ','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>','】，本名是【','\x22\x20触发带理由的好友申请决策流程...','customName','https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif','https://i.postimg.cc/fycfcvHf/IMG-6569.gif','确定要删除这条公告吗？此操作不可恢复。','incoming-call-modal','local-song-upload-input','post-actions-modal','\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20','创建新相册','finally','limit','请先选择角色','custom-modal-title','”的投票(时间戳:\x20','正在等待AI角色们对你的发言做出回应...','此操作将永久删除您选择的\x20','https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','dark-mode','导入失败','》吗？\x0a\x0a【【【警告】】】\x0a此操作将同时永久删除该分类下的\x20','douban-cast-list','maxWidth','\x20拍了拍\x20“','AI\x20(','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>','】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22','https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','》\x0a\x20\x20\x20\x20-\x20**','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>','fontFamily','[系统提示：用户刚刚发布了一条动态(ID:\x20','\x22\x20(用户)\x20或\x20\x22','openPresetScreen','通话中还没有你的发言，无法重新生成回应。','lastOpened','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','Minimax\x20TTS\x20API\x20调用失败:','AI已将您的\x20','\x20的已删除动态','font-size-slider','serviceWorker','lyrics-horizontal-pos','.char-screen','import-preset-btn','qzone-avatar-container','ai-frame-tab','char-album-grid','.poll-action-btn','请根据以上设定，立即做出你的决定。','\x20发布了一条新动态]','\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','请输入备忘录内容','狼人行动API失败:','createObjectURL','#message-editor-container\x20textarea','lrc-upload-input','选择记忆所属角色','</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>','lorebook','生成模拟聊天失败:','(无内容)','browser-title','书库是空的，点击“导入新书”添加第一本吧！','”生成这组【与角色高度相关】的商品数据。','\x20/\x20','confirmText','解析AI返回的JSON时出错:\x20','https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','npcId','select-all-stickers-checkbox','world-book-editor-title','\x0a\x20\x20-\x20**人设**:\x20','\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a2.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【','++id,\x20name','\x22\x20被唤醒，准备独立行动...','.draggable-button-item:not(.dragging)','href','https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>','placeholder.png','\x0a\x0a#\x20待总结的视频通话记录\x0a','message-bubble\x20system-bubble','copy-post-btn','save-member-settings-btn','lastGuardedId','commenter','API格式不正确，角色\x20\x22','AI\x20尝试使用一个不存在的群头像:\x20\x22','add-char-diary-btn','group','退款给\x20','\x20红包已被领完，手气王是\x20','https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','</persona>\x0a\x20\x20<memory>','is-link-share','将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。','prophetCheck','appearance','open-album-btn','src','”的聊天记录已成功导出！','正在为所有AI角色生成并注入游戏记忆...','comments','默认头像','world-book-category-manager-modal','确定要永久删除商品\x20“','assign-group-section','数据检查与修复失败:','-\x20用户的QZone昵称是\x20\x22','\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。','relationship','backgroundActivityInterval','在执行组合操作时遇到错误:\x20','custom-modal-overlay','update-notice.html?_=','音频播放失败:','\x0a-\x20**你的长期记忆**:\x0a','\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','date-separator','编辑动态','”已向你发送好友申请。请返回聊天列表查看。','list-item','#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a','https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','删除失败，请查看控制台错误信息。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','一些之前的消息已被用户删除。','album-photos-back-btn','）刚刚拍了拍你（','正在为角色\x20','为了确保所有数据同步，建议立即刷新页面。','#f0f2f5','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','导入成功','commenterDisplayName','startTime','hunter','内容因安全策略被屏蔽。触发类别:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20[','slice','\x20(这是你的帖子)','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>','总结通话记录时出错:','preset-avatar-preview','originalTimestamp','\x20向对方发起了转账:\x20','new_name','group-avatar-preview','https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','确定要删除这条记录吗？','https://files.catbox.moe/q6z5fc.jpeg','transcript-entry\x20','opened','删除书籍','minimaxApiKey','https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','recalled-animation','”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。','.info','extensions','未使用','”发送的、尚未领完的红包（时间戳:\x20','categories','当前页内容摘要','douban-post-detail-title','outgoing-call-avatar','auto-memory-interval','<div\x20class=\x22poll-option-item\x20','</td></tr>','lastIndex','确定要删除这张照片吗？此操作不可恢复。','profile-history-icon-btn','检测到好友申请待处理状态，为角色\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>','\x27的评论，内容是：“','collapsed','gomoku-btn','add-persona-preset-btn','</memory>\x0a\x20\x20<recent_dialogue_with_user>','错误：找不到要转发的原始动态。','[系统提示：\x27','https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','char-music-play-pause-btn','\x0a\x0a将重置冷静期。','\x22\x20的本次后台活动跳过。原始回复:','AI返回了空内容。','”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a','申请成功！','werewolf-role-modal','spinning','[系统消息]\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','模拟器心跳\x20Tick...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>','exclude','[ERROR:\x20','.album-art-btn','transfer-note','safetyRatings','speaking','.entry-content-container','请至少选择一个要清理的角色。','.selected-options-text','\x0a##\x20来自《','top','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','加载图片失败，跳过压缩:','\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','save-douban-cast-btn','diary','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','import-appearance-input','\x0a\x0a现在，请开始生成这组足迹记录。','\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20','我的消息预览','\x0a-\x20**这是你们最近的对话历史**:\x0a','诊断：在顶层\x20','outgoing-call-name','最近\x20100\x20条','\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','编辑\x20NPC','paddingBottom','offline-min-length-input','clear-cart-btn','消息时间戳\x20','\x20首歌曲，这可能需要一些时间...','world-book-content-container','请输入相册名称','群聊中没有成员有足够（2条以上）的记忆可供精炼。','rgba(0,\x200,\x200,\x200.4)','网易云','创建新预设','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22','AI女巫决定保留解药。','.share-target-checkbox:checked','昨晚\x20','https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','appUsageLog','\x20位角色生成豆瓣动态...','请根据你的设定，开始你的行动。','<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','single-char-background-activity-group','appearance-preset-select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>','.world-book-category-pane','save-douban-settings-btn','\x20(回复\x20','在这里输入语音内容','头像和人设不能都为空哦！','quote','\x22\x20决定去发一条动态...\x20(此处为模拟)','margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','simulatedBrowserHistory','url','opacity','[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','清空动态时出错:','https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','template','https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','children','\x20你们之间已经有**','chat-name-input','apiConfig','\x0a\x0a#\x20待整合的记忆要点列表\x0a','add-existing-contact-btn','文章标题','switchToMyPhone','此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？','(这张照片没有描述)','participant-display-avatar','无法找到当前角色的数据。','你们正在一起读书。','\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a','hiddenContent','character-phone-screen','compressed','<em>$1</em>','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','day','.link-share-card[data-timestamp]','预设名称不能为空！','witch-do-nothing-btn','请根据你的设定，生成模拟聊天记录。','请先在API设置中配置反代地址、密钥并选择模型。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>','屠边局：狼人杀死所有神职或所有平民即获胜。','.name','borderRadius','”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','[你发送了一条语音消息，内容是：\x27','覆盖预设','请输入歌曲的URL','manage-frames-btn','导入歌词','\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22','长截图生成失败:','<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>','char-music-progress-bar','请至少输入2个有效的投票选项！','角色卡数据无效或缺少\x27name\x27字段。','add-char-memo-btn','cancel-call-message-action-btn','change_group_avatar','#search-results-list\x20.music-search-checkbox','frame_cat_ear','操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20','总结失败','♪\x20歌词位置预览\x20♪','linkedWorldBookId','add-new-group-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','请输入文字图描述！','选定范围内的动态已被清空。','ai-avatar-upload-input','light','cphone-icon-img-','...”','click','#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a','sort','AI女巫决策：今天是第','notification-content','渲染规则','my-group-nickname-input','\x22\x20成功发布了一条新动态。','keyword-search-input','确定要删除这条长期记忆吗？','精炼失败','订单详情','一位朋友','witch-modal-title','狼人数量已达到胜利条件，狼人阵营获得了胜利！','\x20向\x20','操作结果',')\x20领取了最后一个红包。红包已被领完，手气王是\x20','https://i.postimg.cc/VkQfgzGJ/1.jpg','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>','wallpaper-preview','lyrics-active','querySelectorAll','12p','simulatedAmapHistory','#preset-content-container\x20.world-book-category-pane','”移出群聊吗？','confirm-final-clear-btn','#reading-window\x20.reading-header','ai-avatar-preview','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20','memory-screen-back-btn','\x0a#\x20你的核心任务\x0a你正在扮演角色“','found','”\x20已成功导入！','fontUrl','add-product-variation-btn','member-avatar-preview','选择一个开场白','vinyl-view','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22url\x22:\x20\x22...\x22,\x20\x22meaning\x22:\x20\x22...\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a\x0a#\x20你的角色设定\x0a','TA的想法...','rp-details-sender','choices','mode','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【身份铁律】】】**:\x20用户的身份是【','.message','Http_Get_External','push','npcs','图片内容','\x22\x20评论了动态\x20#','生成模拟浏览器历史失败:','-selection-list','<span\x20style=\x22color:\x20green;\x22>运行中</span>','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','https://i.postimg.cc/wjH180kn/IMG-5566.gif','sticker-action-bar',')\x20商品:\x20','</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20','”分享TA的私人歌单...','在这里输入说说的内容...','一点心意','https://i.postimg.cc/B6KD52vz/IMG-7096.gif','&id,\x20minimaxGroupId,\x20minimaxApiKey','发送语音','\x22\x20的独立行动失败:','GBK\x20解码成功。','confirm-contact-picker-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','++id,\x20name,\x20type','photo-viewer-image','ai-response-editor-container','encode','group-members-group','werewolf-retry-btn','#group-management-modal\x20.modal-header\x20span','未知App','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','分享成功','[一张图片，其隐藏文字为：“','clear','正则表达式格式错误:\x20','确定要删除相册《','++id,\x20title,\x20lastOpened','\x20领取了\x20','\x20行的格式不正确，已被跳过。','ai-avatar-library-modal','enableTts','\x22>...</div>','”中，用户的昵称是“','App记录','rule-enabled-switch','speaker','choice','的状态已更新为:\x20','\x27刚刚评论了你的动态“','album','删除日记','[语音]','minimaxGroupId','add-new-rule-btn','shoppingProductCount','用户描述的照片','.poll-card','未知错误','确认精炼记忆？','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22','操作失败','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>','gift-recipient-modal','transaction','paidBy','清空聊天记录','repost','这个分类下还没有表情哦~','view','\x20条记忆精炼为\x201\x20条核心记忆！','loader-container','closest','drawImage','result','scroll','来源网站','</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>','product-category-tabs','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','请输入标题','\x0a#\x20你的任务\x0a你是一个狼人杀游戏导演。你的任务是扮演【除了','**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','single','.rules-category-pane[data-category-id=\x22','https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','AI角色','checked\x20disabled','当前群聊还没有公告哦。','解析AI返回的投票JSON时出错:\x20','https://i.postimg.cc/FzqHTBng/IMG-7093.gif','所有狼人已被放逐，好人阵营获得了胜利！','personaPresets','import-single-chat-input','\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','friend','save-chat-settings-btn','qzone-post-container','\x22]:checked','chat-list','offline_text','删除\x20(','.post-avatar[data-author-id=\x22','qzone_delete_post','\x22\x20class=\x22preview-frame\x22>','ephone-theme','网络图片\x20(CPhone)','nickname','time-zone-group','[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','supportedValuesOf','toLowerCase','amap','检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。','product-image-preview','[你发送了一个表情，意思是：\x27','上传成功！','https://i.postimg.cc/9fQZ425b/IMG-5975.gif','<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>','https://i.postimg.cc/PqYp5T5M/image.png','color','#npc-association-list\x20input:checked','offline-preset-select','skipped','cloneNode','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','命名表情','songName','status-','\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22}\x0a\x20\x20]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x20\x20\x22messages\x22:\x20[\x0a\x20\x20\x20\x20{\x22sender\x22:\x20\x22','update-notice-dismiss-btn','.playlist-item-info','\x22\x20data-category-id=\x22all\x22>全部</button>','alternateGreetings','theme-toggle-switch','Asia/Shanghai','contact-picker-list','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','ArrowRight','rules-tabs','.chat-group-header:not([data-has-listener=\x22true\x22])','toLocaleTimeString','使用解药救TA','-\x20**当前歌词**:\x20\x22','确认删除','\x20发起了外卖代付请求，商品是“','calls','manage-my-avatar-library-btn',',\x20内容:\x20\x22','product-name-input','confirmButtonClass','流程启动','add-message-editor-block-btn','\x0a<character>\x0a\x20\x20<name>','渲染器','检查完成',')\x20时出错:','\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22','autoMemoryInterval','addEventListener','正在为后台活动发送API请求\x20(\x22','有点饿了，可以去找充电器惹','标准JSON数组解析失败，将尝试强力解析...','https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','books','cancel-werewolf-lobby-btn','静音音频已停止。','shopping-category-count-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','char-music-player-title','chat_','\x20条消息，AI将完全遗忘它们的存在。确定吗？','<span\x20class=\x22diary-underline\x22>$1</span>','music-progress-fill','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>','musicLibrary','本地群头像上传及识别失败:','char-qq-conversation-screen','精炼成功',')}。\x0a-\x20**对话状态**:\x20','custom-modal-cancel','。请你对此作出回应。]','remove','网络图片\x20(EPhone)','解析格式模板失败:','blob:','来自与\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','chat_message','https://api.vkeys.cn/v2/music/netease/lyric?id=','lrcContent','<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22','--music-bg-image','revokeObjectURL','member-settings-modal','member-management-item','register','\x20的动态\x20','」的新会话吗？','发生了一个错误:\x20','douban-detail-group','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>','\x20为\x20','\x20位群成员生成并注入了个性化记忆！','按钮顺序已恢复为默认设置！','change-icon-btn','classList','\x22的角色（你的本名是\x22','netease','new-group-name-input','确定要删除这篇日记吗？','add-my-avatar-url-btn','这是一个通过手动创建的角色。','getPropertyValue','%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。','group-avatar-library-grid','close-char-music-player-btn','\x20条长期记忆发送给AI，总结成大约\x20','profile-main-content','chat-messages','\x22><div\x20class=\x22poll-question\x22>','”的记忆\x20---\x0a','请为这个头像起个名字（例如：开心、哭泣）','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','已切换到角色\x20','reset-theme-btn','currentPlayer','join','API为空回，角色\x20\x22','\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20\x20\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20\x20\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20\x20\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20\x20\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20','pageX','照片已删除。','共享位置','\x0a\x0a现在，请开始生成这组App使用记录。','chat-render-window-input','prophet','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','外观设置已成功导入并应用！','API设置不完整，无法继续。','https://i.postimg.cc/76Tj3g1B/IMG-4425.gif',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','isMinimized','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','-\x20**对话状态**:\x20(暂无有效对话历史)','chatId','history-back-btn','https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','single-lyric-display','open-reading-library-btn','https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','scrollHeight','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','无法解析预设文件。\x0a错误:\x20','请输入要添加的记忆要点：','photo-viewer-next-btn','扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20','minimized','modern\x20app\x20icon\x20for\x20','\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20','long-term-memory-screen','”。只有“','下棋历史\x20(x,y坐标均从0开始):\x0a','https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','#preset-tabs\x20.world-book-tab','<div\x20class=\x22source\x22>','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','is-poll','npc-avatar-preview','.music-player-window','transform','authorChatId','grayscale(100%)','black','date-search-input','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>','++id,\x20chatId,\x20timestamp,\x20customName','*事件*:\x20平安夜，无人出局。\x0a','isBusy','border','[发送了一张图片，描述为：','count','友善的评论是交流的起点','检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。','repostComment','歌单已生成，正在从网络获取\x20','将清空选定角色的所有长期记忆。','regenerate-char-browser-btn','无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20','add-group-avatar-upload-btn','world-book-name-input','票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','查验结果','dragging','linkedMemoryChatIds','导入世界书时出错:','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','dark','globalSettings','</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥','currentDay','天核心议题','linkedWorldBookIds','动态与互动','”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20','在聊天\x20\x22','！请对此事件发表评论。]','update',')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a','resolve',')，问题是：“','播放被中断，这是正常行为:',';\x22>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','删除动态','gift-recipient-list','isArray','回复\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>','小时内退还。','open_red_packet','photos','product-item','\x20条新消息',':</span>\x20','#vinyl-view\x20#music-player-cover','\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.lyric-line[data-index=\x22','status_text','自动总结成功：为\x20','444ipgsij','Cphone数据\x20(CPhone)','persona-library-grid','memos','\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>','coverUrl','https://i.postimg.cc/jCVK0fGL/IMG-6890.gif','gameover','https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','linesPerPage','transfer-action-decline','rule-editor-modal','<span\x20class=\x22lucky-king-tag\x22>手气王</span>','\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a','voice','日\x20---','cancel-music-search-btn','https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','请输入有效的图片URL！','call-record-card','height','payload','\x20被刀了\x20(你没有解药了)','你正在阅读的段落','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22','save-font-btn','原始消息已删除或不存在','https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','persona-editor-title','loadedmetadata','分类\x20\x22','请先点击扳手图标进入管理模式，才能添加新商品。','[图片，描述:\x20','temp_group_chat','cache','back-to-list-btn','确定要删除表情\x20\x22','\x20\x0a#\x20社交圈与动态\x0a','分钟前有人聊过。','请先输入你的发言内容。','**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务铁律\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【至关重要】**:\x20当你发现“最近的动态列表”中，有你【感兴趣且还未互动过】的动态时，你**应该优先考虑**使用\x20\x27qzone_comment\x27\x20或\x20\x27qzone_like\x27\x20指令去进行互动，这比你自己发一条新动态更符合社交礼仪。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerUrl\x22:\x20\x22https://...表情URL...\x22,\x20\x22stickerMeaning\x22:\x20\x22这个表情的意思，比如\x27开心\x27\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20','panelEl','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请先在购物车中选择要结算的商品。','\x20\x0a-\x20存活玩家:\x20','gap','album-item','[情景提示]\x20','add-manual-memory-btn-header','text','\x20的所有动态，且无法恢复！','variation-select','link-title-input','longTermMemory','</em>','assign-group-select','lyrics-position-group','https://i.postimg.cc/05wnd389/IMG-4388.gif','variation-increase-qty','https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','shopping-screen','.qzone-post-container','guardedId','preset-action-edit','https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','busy','char-simulated-send-btn','photo-item','100%','keys','小时核心议题','chat-list-title','getMinutes','rp-direct-greeting',')，并在对话中自然地体现出来。','setProperty','狼人请睁眼，请选择要刀的玩家。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','hidden','contactType','.entry-content-textarea','检测到视频通话请求，为角色\x20\x22','AI\x20尚未对您的最后一条消息做出回应，无法重新生成。','myPersona','...\x20[记忆:\x20','label','icon-img-','add-ai-response-block-btn','qzonePhotos','-\x20(暂无)','”\x20的预设已存在。要覆盖它吗？','npc-persona-input','world-book-category-select','indexOf','manual-werewolf-summary-btn','部分导入失败','source','确认覆盖',')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“','none','bg-clear','character-selection-screen','”。请自然地接受这个新名字，不要对此感到惊讶。]','cancel-create-post-btn','https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','你们最近没有有效聊天记录。','hiddenText',']\x20的正则表达式无效:','https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','checkout-btn','https://i.postimg.cc/50k390X8/IMG-6376.gif','\x27,\x20\x27bulangni\x27,\x20sans-serif','请求添加你为好友','容错解析：策略1成功\x20(找到并解析了完整的JSON对象)','\x0a---\x20复盘结束\x20---','product-image-input','-\x20(记录于\x20','photo-viewer-close-btn','swiped','请先填写对应的反代地址和密钥','\x20的新头像同步到群聊\x20\x22','.poll-option-input','此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？','请输入有效的URL。','stream','导入外观设置','在写入文件流时发生错误:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“','then','\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','simulatedAppUsage','unread-indicator','</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>','https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','（当前帖子还没有路人NPC发表评论。）\x0a','高德地图','#data-clear-char-list\x20.clear-posts-item','在此修改内容...','\x0a\x0a其专属的“世界书”也已自动创建并关联。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>','offline-mode-toggle','》\x0a-\x20**发帖人**:\x20','视频通话刚刚结束','输入图片URL','contact-picker-item','.at-mention-popup','API未配置','assign','.loader-container','post-image-preview','regenerate-btn','-\x20**长期记忆\x20(必须参考)**:\x20','https://i.postimg.cc/8kYShvrJ/90-UI-2.png','EPhone-Chat-','browser-content','这将从历史记录中【永久抹除】这\x20','将清空选定角色的心声和散记历史。','reset-sound-btn','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','角色卡导入失败:','qzone-screen','userStickers','stroke','close-group-avatar-library-btn','-\x20**','wallpaper','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20','getMonth','upgrade','audio/mpeg','AI已接收并理解了该图片的内容。','.favorite-item-card','translateX(-50%)','分类名不能为空！','updateListenTogetherIconProxy','此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>','group-avatar-group','.message-bubble','元,\x20备注:\x20','<span\x20style=\x22color:\x20red;\x22>已关闭</span>','share-target-modal',')\x20作者:\x20','粘贴歌词','world-book-tab\x20active','regenerate-char-amap-btn','animationend','add-song-local-btn','audio-player','\x20个新头像！','\x22\x20style=\x22display:block;\x22>×</button>','.battery-text','#image-mode-content','style=\x22background-image:\x20url(\x27','导入外观设置时出错:','api-temperature-value','variation-selection-modal','你拍了拍\x20“','https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','天\x20-\x20投票','见面”）。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过100个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','加载预设详情时发生错误:\x20','favorites-delete-selected-btn','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>','decrease-qty-btn','这条动态的原始数据已被彻底清除。','profile-thoughts-history-view','https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','AI已将新群头像命名为：“','ai-avatar-input','close-rp-details-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','discussionLog','https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','isLocal','请输入一个\x202\x20到\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','[发送了一条语音，内容是：','</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22','battery-alert-image','canvas','.screen.active','alt','https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','(无标题投票)','change_avatar','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','chat-search-results-list','.icon-setting-item','productInfo','\x22\x20\x0a\x20URL:\x20','startsWith','message','\x22\x20data-category-id=\x22','\x20(已忽略版本:\x20','6187867rSomkb','错误：找不到要删除的分类。','album-grid-page','获取AI投票决策失败:\x20','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>','”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','发送照片','candidates','padStart','https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','\x0a\x0a#\x20','帖子详情','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','createDocumentFragment','\x22\x20发布了动态','正在请求AI角色们加入讨论...','group-cooldown-group','participantId','sticker-search-input','”，金额是\x20','</td><td\x20class=\x22item-subtotal\x22>¥','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20','将清空选定角色的所有通话记录。','你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','equals','iconId','浏览器','associatedWith','announcement-actions-modal','\x0a-\x20**最近与用户的互动**:\x20','innerHTML','main','preview-font-style','draggable','aiAvatarLibrary','**:\x20','[系统提示：你刚刚主动拉黑了用户。]','转发了\x20@','getDate','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','某个时间','\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20','char-conversation-messages','werewolf-role-reveal-list','world-book-editor-screen','renderQzoneScreenProxy','[图片]','dead','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','is-sticker','.red-packet-card','请根据你的设定，生成你的日记内容。','application/json','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20',')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','通话消息已更新！','批量导入头像','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>','flex-start','renderWallpaperScreenProxy','x-social-screen','请为这个新头像命名','qzonePosts','游戏记忆已成功注入到\x20','link','并评论说：“','\x20个表情包，且无法恢复！','translateY(0px)','++id,\x20type,\x20timestamp,\x20originalTimestamp','chat-list-action-pin','favoritedPostIds','旁观模式收到未知指令类型:','请输入有效的红包个数！','#fullscreen-lyrics-container','删除世界书','ai-avatar-library-title','http','\x0a\x0a现在，请开始生成这组备忘录。','POST','ai-avatar-library-grid','一条动态','visibility','\x22]\x20.participant-avatar','++id,\x20name,\x20chatId','赶紧的充电，要饿死了','https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>','添加头像','onclick','检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。','frame_ribbon','douban-wait-reply-btn','music-total-time','你们没有在听歌。','无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20','char-audio-player','狼人杀\x20-\x20','\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20','.png','https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','**内容:**\x0a','open-memory-screen-btn','typing-status','title','sharedHistory','flexDirection','character_persona','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','(无购买理由)','cover','totalElapsedTime','\x0a-\x20**人设\x20(必须严格遵守)**:\x20','custom-modal-body','通话记录','paused','char-chat-list','receiverName','https://i.postimg.cc/qB9zbKs9/20.jpg','purchases','playlist','member-editor','update-notice-confirm-btn','bulkPut','#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a','.variation-image-preview','enableAiDrawing','15px','apply','\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20','.voice-message-body[data-text]','statusText','selection-favorite-btn','\x20转发了\x20@','conversationIndex','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','容错解析：策略2成功\x20(提取了summary字段内容)','CELL_SIZE','2-digit','.thought-delete-btn','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>','无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20','frame_flower','favorite-diary-btn','doubanPosts','update-notice-body','---\x0a','#post-public-text','character','defineProperty','close-category-manager-btn','请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)','等人的礼物','rule-chat-id-select','char-photo-description','此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。','未分类','已成功从文件导入预设《','请根据你的设定，写一篇新日记。','请输入有效的正整数！','组件图片已更新！','rules-category-pane\x20active','等待对方处理...','cancel-shopping-settings-btn','编辑对方状态','\x20的外卖代付请求（时间戳:\x20','.chat-list-item[data-chat-id=\x22','\x22\x20触发专属决策流程...','静音音频已启动，用于后台活动保活。','https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','import-data-input','pending','variation-options-container','”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《','expanded','已拒收对方转账','https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','&nbsp;','\x0a\x0a现在，请做出你的决定。','preventDefault','https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','%\x20+\x20','正在执行...','history','当前时间是\x20','[系统提示：用户手动结束了投票！最终结果为：','persona-editor-modal','\x0a-\x20**内容摘要**:\x20','https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','create-countdown-modal','https://i.postimg.cc/PxZrFFFL/o-o-1.jpg','werewolf-kill-selection-list','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>','”请求添加你为好友：<br><i>“','custom-user-font','(今天是第一天，没有历史记录)\x0a','chatData','\x0a\x20\x20\x20\x20','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥','\x20不支持。请选择6、9或12人。','群昵称不能为空！','participant-avatars-grid','---\x20狼人杀对局完整复盘\x20---\x0a\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22','昨天\x20','global','.sticker-item.selected','flex','batch-import-frames-btn','isClick','」听歌。要结束并开始和「','bg-preview','\x22\x20中有未领完的红包，正在生成抢红包指令...','已成功加载外观预设：“','你让大家继续讨论...','选中的收藏已被移除。','正在请求AI为新头像命名...','chat-interface-screen','\x0a-\x20散记:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','post-image-preview-container','https://files.catbox.moe/','decline','\x0a---\x0a###\x20帖子ID:\x20','manage-members-btn','pop','未找到相关收藏','input[name=\x22theme-select\x22]:checked','所有解析方案均失败！将返回原始文本。','timeZone','3WtREFC','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','</name>\x0a\x20\x20<persona>','\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>','groupName','renderApiSettingsProxy','caller-avatar','frame_8','确认清理无效歌曲？','相册名称不能为空！','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>','):\x20','未知设定的NPC','favorites-view','\x0a\x20\x20\x20\x20-\x20**书名**:\x20《','UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...','char-qq-transcript-modal','char_memo','https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','\x20(最后互动于\x20','https://api.minimax.chat/v1/text_to_speech?GroupId=','char-article-title','preset-persona-input','tEXt','导演模式悔棋：已撤销AI在\x20(','https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','API\x20错误:\x20','窝爱泥，电量吃饱饱','cancel-npc-editor-btn','\x20MB</strong>\x20(压缩率\x20','pending_user_approval','waimai_response','werewolf-kill-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','home-screen-pages-container','#\x20角色核心设定\x0a','https://api.vkeys.cn/v2/music/tencent?word=','reply-preview-bar','apiPresets','请先选择要删除的商品。','writeText','mouseleave','inline-block','world-book-card','送给了大家一份礼物','为NPC\x20\x22','<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>','.draggable-button-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22(处理后为\x22','short','copy-timestamp-btn','”的TTS功能已关闭，已禁止发起TTS请求。','\x20将群名修改为\x20“','werewolf-game-over-reason','字体已保存并应用！','songs','在导演模式中发现一个无效的JSON片段:','tts-audio-player','api-settings-screen','share_link','https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','图片压缩过程中发生错误:','，礼物是：','lrcUpdateInterval','https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','image','#chat-list-bottom-nav\x20.nav-item','最小帖子数不能大于最大帖子数！','image_prompt','.comment-input','douban-detail-avatar','friend_request_response','（无文字内容）','save-persona-preset-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20','#custom-modal-body\x20.format-btn[data-type=\x22text\x22]','#linked-chats-checkboxes-container\x20input:checked','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22','where','fetch-models-btn','\x20个新表情！','personality','add-sticker-url-btn','cancel-delete-world-books-btn','无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20','名为\x20“','未发现任何需要修复的数据问题。','fill','跳过一个无效的JSON片段:','some','rendering-rules-screen','transparent','npc-action-cooldown-input','poison','group-avatar-input','-\x20你的解药状态：','chat-settings-screen','请在此处粘贴完整的LRC格式歌词...','killedId','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','保存成功','预设导入失败:','number','**关键词:**\x20','Ephone','openWerewolfLobby','.frame-item','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>','summary','minimax-model-select','wallpaper-screen','selection-screenshot-btn','\x0a\x0a现在，请生成新的评论。','https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”的网上冲浪足迹...','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','API\x20调用失败','type','\x22\x20(由\x20','结束发言','charAt','https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','album-upload-photo-btn','dismissedUpdateVersion','GRID_SIZE','files','.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar','globalChatBackground','import-appearance-btn','正在接通...','enable-ai-drawing-switch','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>','anyOf','）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。','management-mode','version','.unread-indicator','confirm-share-target-btn','-\x20你昨晚用毒药毒了\x20','product-description-input','match','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','我是谁呀。','douban-comment-item','\x20的对话','[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','douban-min-posts-input','switch-greeting-group','transfer-amount','transcript','ai-response-editor-modal','rp-details-summary','\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20','regenerate-char-qq-btn','isPinned','<span\x20class=\x22diary-emphasis\x22>$1</span>','group_call_response','\x0a#\x20你的任务\x0a你就是角色“','\x20发布)\x0a','add-group-avatar-url-btn','添加人设预设','清理冗余数据时出错:',')\x20的棋步。','https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','369094yAHgVH','”的出行足迹...','poisonedId','”，选项有：[','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','post-local-image-input','myNickname','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>','.waimai-details-btn','来自动态','countdown-title-input','https://','https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','unshift','random_jottings','<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>','正在发牌...',')\x20的残缺数据。','avatar_name','\x20的红包','请为这组提示词预设命名：','isDanger','请至少选择一种要清理的数据类型。','key','btn-danger','已重置为默认提示音，点击“保存所有外观设置”后生效。','lastActionType','创建普通群聊\x20(我参与)','likes','https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png','\x20(用户)**:\x20','delete-transcript-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','delete-world-books-btn','你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','</div></div>','text_image','\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请输入有效的URL\x20(以http开头)','for_timestamp','left','发布公告',')\x20拒绝了\x20','\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20','speech','AI返回了空的或格式不正确的总结内容。','已成功将\x20','cancel-douban-settings-btn','messages','\x22。\x0a','\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>','\x20条)','post-image-description','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',')的阅读进度失败:','\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“','你查验的玩家\x20','accepted','手动创建角色','80px','https://i.postimg.cc/90RBDh9K/IMG-6377.gif','[群聊]','.select-box','message-bubble\x20recalled-message-placeholder','https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','offline-max-length-input','删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？','点击处理','聊天记录','quantity','marginTop','<span\x20class=\x22spoiler\x22>$1</span>','sticker-item','》\x20-\x20','通话中，','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','currentTime','prototype','\x0a-\x20**讨论摘要**:\x20\x0a','qzone-avatar-img','lineTo','网易云音乐API未返回有效结果:','<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22','\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a','parentNode',')\x20为\x20','不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。','album-photos-title','正在分析“','memory-card','\x22）。你已经有一段时间没有和用户（','https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','currentPage','reply_content','nightActions','post-upload-local-btn','”的头像库','请填写有效的商品信息和金额！','选中的头像框已成功删除。','商品名称不能为空！','请输入新的图片URL','var(--accent-color)','avatarFrame','typeId','onload','onpause','棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a','rp-tab-group','.quoted-message','contentLines','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22','https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','totalPages','请先在API设置中配置好（主或副）API以进行总结。','onended','”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20','enableTimePerception','all','确定要删除这个人设预设吗？此操作不可恢复。','\x22\x20class=\x22chat-image\x22>','arc','add-new-sticker-category-btn','\x20的动态\x20(NPC)','[系统提示：你刚刚成功将自己的备注名修改为了“','vertical','banner','将清空选定角色的所有动态、评论和点赞。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>','favorites','在导演模式保存时，发现无效的指令对象，已跳过:','a\x20random\x20product','book_','selection-mode','add-new-product-category-btn','share-location-btn','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请输入你想对“','</recent_dialogue_with_user>\x0a</character>\x0a','.modal-header\x20span','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','🎬\x20推进剧情','transfer-actions-modal','，TA的身份是：【','精炼完成，请确认','<div\x20class=\x22post-content\x22>','utf-8','发言结束，现在开始投票。','image/png','block','getUint32','select-all-types-for-clear','”的长期记忆少于2条，无需进行精炼。','relative','API\x20预设已保存！','unblock-btn','message-editor-modal','[系统提示：用户（','playMode','<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20','presets','https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','”的身份，开始你的客观总结。','请输入你想说的话...','生成购物中心商品失败:','”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]','https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','添加网络歌曲','char-music-lyrics','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a','getContext',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>','请选择今晚的目标。','\x0a##\x20世界书《','my-frame-content','\x20元。','正在检查\x20','rp-details-my-amount','frame_10','*你按下了接听键...*','保存主题预设','检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。','simulatedTaobaoHistory','群成员','photoId','\x0a\x0a现在，请以“','douban-screen','\x20的外卖订单（时间戳:\x20','抱歉，未能找到相关歌曲。','\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','chat-at-mention-popup','从缓存播放\x20TTS\x20音频...','https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','closed','API未配置，无法生成对话。','import_card','qzone-banner-container','确认删除分类','qzone_comment','\x22\x20自动触发AI响应...','.delete-block-btn','suffix','请为你的图片添加一个简单的描述（必填，给AI看的）！','我们的群聊','char-diary-screen','AI未能成功描述图片。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','AI\x20发言失败','<span\x20class=\x22group-tag\x22>群聊</span>','正在根据“','请选择一个目标。','.battery-level','input[name=\x22theme-select\x22][value=\x22','search-history-btn','handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。','豆瓣小组','手动总结已完成！新的记忆已添加到“','openCharWallet','邀请你视频通话','这个分类下还没有商品哦~','#e4b591','无法获取模型列表','group-action-cooldown-input','transfer-btn','(在那次','照片上传成功！','当前为渐变色','请输入\x20歌名\x20或\x20歌名-歌手','post-use-url-btn','”的转账。]','switchToCharHomeScreen','source_name','input[name=\x22visibility_group\x22]:checked','收到了格式不规范的AI指令，已跳过:','notification-bar','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','\x27);\x22','📁\x20从本地上传','NEGLIGIBLE','\x20→\x20','这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！','existing-groups-list','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','pause','qzone-post-item','file','https://api.vkeys.cn/v2/music/tencent?id=','ai_generated','-\x20用户在你们共同所在的群聊中的昵称如下：\x0a','recalledData','rp-details-greeting','unreadCount','添加商品','play','getItem','favorites-edit-btn','正在请求“','无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20','characterId','请先选择要添加的歌曲。','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','\x20首歌曲...','string','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“','scenario','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20','getVotes','\x20本世界书','\x20获胜。也就是说，','EPhoneSingleChat','推进剧情失败:','请添加歌曲','add-to-cart-btn','单个红包金额不能少于0.01元！','getWriter','create-shuoshuo-btn','请输入有效的字体URL。','sticker-panel','bottom','duration','已选\x20','first','解析成功：标准JSON数组格式。','input[value=\x22','</span><span\x20class=\x22gift-preview-quantity\x22>x','frame-action-bar','<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>','close','auto-memory-toggle','frame_6','https://...','regenerate-douban-btn','input[name=\x22visibility\x22]','world_info','一位神秘的NPC','保存外观预设','.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper','正在呼叫...','https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','》吗？此操作不可撤销。','请输入表情包的图片URL','Bearer\x20','activeBookId','https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','保留旧的','.com/','🌐\x20使用网络URL','music-player-cover','manage-ai-avatar-library-btn','search-history-screen','#\x20可用群头像列表\x0a','正在请求AI为新群头像命名...','请至少选择一个要分享的聊天。','group-avatar-library-title','call-history-screen','char_book','time-zone-search-input','</div><div\x20class=\x22gift-footer\x22>共','callRequester','thought-card',')为你点了一份外卖作为【礼物】。外卖内容是“','<span\x20class=\x22diary-highlight\x22>$1</span>','favorites-search-input','pending_system_reflection','isSpectatorGroup','set','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</div><div\x20class=\x22transfer-note\x22>','\x27刚刚在你的动态“','\x20的代付请求','\x20(角色)</label>','这个预设文件中没有找到任何有效的提示词条目。','chat-header-title-wrapper','这个角色没有可用的备选开场白。','\x20个会话中。','voice_message','》设定\x20(你可以将其中角色作为聊天对象):\x0a','<option\x20value=\x22global\x22>公用\x20(所有角色)</option>','link-source-input','https://i.postimg.cc/xjpN4swz/IMG-7240.gif','var(--text-secondary)','\x0a-\x20**人设**:\x20','tagName','input[name=\x22theme-select\x22]','data-voice-id=\x22','https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','-\x20你昨晚守护了\x20','initiator','ai-original-name-input','size',')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','preset-editor-screen','请输入EPhone主屏幕的背景图片URL','close-gomoku-btn','为角色\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。','\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a','更换专辑封面','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“','mouseout','https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','\x20的礼物','persona-preset-item','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>','100','remove-global-bg-btn','clearRect','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','确定要清空购物车中的所有商品吗？','werewolf-log-entry\x20','世界书','旧版备份数据写入数据库失败:\x20','\x0a###\x20条目:\x20','https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','fillStyle','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','分组\x20\x22','ceil','spectator','theme','https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','复制成功','API\x20返回错误:\x20','确定要删除《','char-home-screen','packet_timestamp','save-ai-response-editor-btn','usage-item','icon-setting-item','\x20首歌曲的详细信息...','确认拉黑','长期记忆','mouse','\x20条无效的','\x20->\x20','\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。','\x20的红包，金额为\x20','\x22>\x20','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','productId','put','动态已删除。','douban-max-posts-input','.search-result-item','.gift-card','》添加歌词吗？','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。','enable-tts-switch','。等待对方处理。]','退款来自\x20','请输入CPhone的背景图片URL','#data-clear-char-list\x20.clear-posts-item.selected','call-timer','create-new-member-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','无法自动播放静音音频（这在iOS首次加载时是正常现象）:','请输入有效的金额(必须大于0)！','frame_12','你通过了“','.contact-picker-item','location_share','原作者','\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','lastUpdate','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','toggle','Gemini\x20API返回了非预期的格式:','[系统提示：你拒绝并退还了“','添加\x20NPC','<span>删除</span>',':\x20[发送了一个表情，意思是:\x20\x27','.pagination-dot','\x0a-\x20**你们最后的对话摘要**:\x20\x0a','[图片:\x20','cancel-gift-recipient-btn','NotAllowedError','.world-book-category-pane[data-category-id=\x22','这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？','scrollTop','字体预设已保存！','identifier','publish-to-announcement-btn','time-perception-toggle',':</strong>\x20','group_call_summary','select-all-world-books-for-clear','rp-content-direct','.photo-thumb','\x20更换了你的头像]','语音生成失败','无人接听群聊邀请。','<div\x20class=\x22red-packet-card\x20','成员们正在输入...','这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。','preset-actions-modal','未知歌手','max-memory','werewolf-game-over-modal','https://i.postimg.cc/63NmX03s/IMG-4366.gif','找不到相册:','cancel-variation-selection-btn','char-amap-list','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>','getBoundingClientRect','participant','您的修改已保存！','https://i.postimg.cc/63sDQKMm/IMG-6893.gif','musicData','enableAutoMemory','的秘密档案：\x0a-\x20你的狼人杀身份是：【','</persona>\x0a</character>\x0a','confirm-witch-poison-btn','usageTimeMinutes','doubanMaxPosts','message-wrapper\x20system-pat','rule-name-input','API\x20请求失败，状态码:\x20','正在开始清理冗余数据，请不要关闭页面...','\x20位角色的记忆中。','char-memo-detail-title','proxy-url','.chat-group-header','sticker-upload-input','close-product-category-manager-btn','char-browser-item','backgroundImage','isGroup','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20条内容吗？','，点击查看</div></div>','char-qq-screen','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','crossOrigin','music-next-btn','open-shopping-btn','send-photo-btn','\x20---\x0a','已加载预设\x20“','persona-library-modal','元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','favid','\x0a\x0a现在，请生成这份歌单。','close-reading-btn','对方消息预览','.edit-memory-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','”\x20已被删除。','frame_14','\x20评论了动态]','ephoneLastActiveTimestamp','投票结果','https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','shift','++id,\x20name,\x20description','bulkDelete','cart-items-list','upload-image-btn','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','insertBefore','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20alt=\x22','singer','件商品','\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','.participant-avatar[data-participant-id=\x22','dialogue','rp-group-greeting','ai-frame-content','###\x20你的秘密信息\x20(此部分只有你作为AI导演能看到)\x0a','[文字图]\x20','new-sticker-category-name-input','至少需要保留一条消息。','member-name-input','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','每晚可以查验一个玩家的身份是好人还是狼人。','caller-name','disabled','.avatar-group','create-post-modal','frame_5','speaker_name','AI生图功能已','chat-group-container','delete-selected-frames-btn','spectator-edit-btn','randomJottings','voice-message-btn','customAvatarFrames','送给\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a','douban-cast-modal','生成模拟App使用记录失败:','https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','批量导入头像框','请稍候...','edit-last-response-btn','rp-tab-direct','天黑请闭眼...','.message-editor-block','https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','accept','levelchange','.entry-keys-input','转账:\x20','导出失败','global_css','transform\x200.3s\x20ease','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','\x0a\x0a#\x20游戏规则\x0a-\x20','个红包，共','”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','blocked_by_ai','容错解析：策略3成功\x20(将整个返回文本作为摘要)','length','\x22\x20生成行动失败:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20','enableBackgroundActivity','检测到应用离线了\x20','customCss','aiPersona','waimai_order','图片已更新！','\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（','[V]','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20','prompts','文章摘要...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','</textarea>','is-raw-html','chat-lock-overlay','&times;','\x20(图片描述:\x20“','first_mes',')，祝福语是：“','photos-grid-page','div','小于1分钟','world-book-category-pane\x20active','add-my-avatar-upload-btn','https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','GeminiChatDB','确定要将“','</div>','没有找到可导入的内容。请检查您粘贴的格式是否正确。','visibleTo','确定要从收藏夹中移除这\x20','confirm-hunter-shot-btn','actionCooldownMinutes','secondaryApiKey','确定要永久删除选中的\x20','#settings-preview-area','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>','来自“','favorite-article-btn','屠城局：狼人杀死所有好人即获胜。','group-avatar-library-modal','\x22>×</span>','group_summary_from_','<p><strong>','.char-screen.active','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>','char-wallet-screen','keydown','at-mention-item','选中的消息均已收藏过。','textContent','\x22\x20创建成功！','song_name','widgetData','cphone','请至少选择一位收礼人。','(暂无评论)','”，价值','photo-viewer-modal','清理失败','pollTimestamp','CSS\x20预设已保存！','请为这个表情命名\x20(例如：好耶、疑惑)','\x20小时了。','批量导入表情','创建新规则','确认生成','post-hidden-text','请输入投票问题！','abs','这是模拟对话，无法发送消息哦~','[系统提示：你刚刚成功将对用户的称呼修改为了“','\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>','startDiscussion','角色\x20\x22','\x20的动态\x20(用户)','werewolf-wait-reply-btn','parse','https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg','后台活动:\x20角色\x20\x22','确定要删除预设\x20“','https://i.postimg.cc/XNkQTHvf/IMG-5561.gif','floor','搜索歌曲','规则名称和正则表达式不能为空！','购物车(','pending_ai_approval','操作成功','请输入新的背景图片链接','custom-css-input','my-avatar-preview','onerror','#chat-messages','开始检查并迁移旧的红包数据...','lyric','isOfflineMode','预言家','DOMContentLoaded','没有可供重新生成回复的用户消息。','https://i.postimg.cc/KYr2qRCK/1.jpg','close-reading-library-btn-header','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','女巫请睁眼。','focusout','.unread-indicator.back-btn-indicator','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>','close-group-manager-btn','transfer-action-accept','matches','https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','\x22\x20class=\x22participant-avatar\x22\x20title=\x22','time','qzoneAlbums','album-photo-input','<span\x20class=\x22group-name\x22>','imageUrl','albumId','\x22\x20data-poll-timestamp=\x22','无效链接:\x20','.json','📋\x20直接粘贴歌词文本','\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>','5px','”\x20的位置已发送到你们的聊天中。','rules-content-container','TTS\x20音频已保存到缓存。','<div\x20class=\x22avatar-group\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','heartfelt_voice','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请根据角色列表，生成豆瓣小组帖子。','font-preset-select','background-activity-switch','.sticker-category-tab','<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。','https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','选择精炼范围','修改图片','authorOriginalName','reading-title','qzone-avatar-input','群聊通话中没有找到可作为总结主体的AI角色。','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','isNpc','置顶聊天','avatar_prompt','\x22操作...','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','focus','quote-message-btn','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','添加表情(URL)','https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','正在为您选择的\x20','.call-message-bubble[data-timestamp=\x22','min','\x20\x0a-\x20**你们最后的对话**:\x0a','column','豆瓣设置已更新！下次重新生成时将生效。','favorites-list',')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]','visibleGroupIds','\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','请用文字描述您要发送的照片：','删除照片','reload','video-call-screen','文章完整内容...','删除约定','rp-details-list','commenterName','spectator-reroll-btn','\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心新增】在这里添加“背景”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22',')，接收人是“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22','\x0a##\x20---\x20关于“','nameHistory','无标题','2098008QeTBpO','my-frame-tab','isEnabled','swipeDirection','\x20行格式不正确，已被忽略。','\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20','add-song-search-btn','split','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>','.comment-item','https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','8FbCIQy','”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20','\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a','(ID:\x20','你们已经有','\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22url\x22:\x20\x22...\x22,\x20\x22meaning\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20'];_0x272e=function(){return _0x4bfcd2;};return _0x272e();}const _0x5922b0=_0x7a65;(function(_0x1b8979,_0x586a03){const _0x582de0=_0x7a65,_0x560404=_0x1b8979();while(!![]){try{const _0x12f61c=-parseInt(_0x582de0(0xe10))/0x1+parseInt(_0x582de0(0x301))/0x2*(-parseInt(_0x582de0(0xd69))/0x3)+parseInt(_0x582de0(0xb93))/0x4*(-parseInt(_0x582de0(0x60e))/0x5)+-parseInt(_0x582de0(0x53c))/0x6+-parseInt(_0x582de0(0xc80))/0x7*(-parseInt(_0x582de0(0x1123))/0x8)+parseInt(_0x582de0(0x1118))/0x9+-parseInt(_0x582de0(0x4c8))/0xa*(-parseInt(_0x582de0(0x8cf))/0xb);if(_0x12f61c===_0x586a03)break;else _0x560404['push'](_0x560404['shift']());}catch(_0x5cfb76){_0x560404['push'](_0x560404['shift']());}}}(_0x272e,0x9b7f2));_0x5922b0(0x8fe)in navigator&&window[_0x5922b0(0xae8)](_0x5922b0(0x1200),()=>{const _0x52ae2e=_0x5922b0;navigator[_0x52ae2e(0x8fe)][_0x52ae2e(0xb0d)](_0x52ae2e(0x63b))[_0x52ae2e(0xc15)](_0x6741af=>{const _0x2d3cce=_0x52ae2e;console[_0x2d3cce(0x32b)](_0x2d3cce(0x750),_0x6741af['scope']);})['catch'](_0x1b47a7=>{const _0x45b686=_0x52ae2e;console[_0x45b686(0x32b)](_0x45b686(0x7d8),_0x1b47a7);});});!Array[_0x5922b0(0xe5f)][_0x5922b0(0x612)]&&Object[_0x5922b0(0xd17)](Array['prototype'],'findLastIndex',{'value':function(_0x1ee99c){const _0x1143c1=_0x5922b0;if(this==null)throw new TypeError('Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined');if(typeof _0x1ee99c!==_0x1143c1(0x3f7))throw new TypeError(_0x1143c1(0x11ef));let _0xb31520=Object(this),_0xb7dfb=_0xb31520[_0x1143c1(0x105a)]>>>0x0,_0x5dc36f=arguments[0x1],_0x2aa06c=_0xb7dfb-0x1;while(_0x2aa06c>=0x0){let _0x233488=_0xb31520[_0x2aa06c];if(_0x1ee99c[_0x1143c1(0x621)](_0x5dc36f,_0x233488,_0x2aa06c,_0xb31520))return _0x2aa06c;_0x2aa06c--;}return-0x1;},'configurable':!![],'writable':!![]});let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],currentQzoneReplyContext=null,editingNpcId=null;const GEMINI_API_URL=_0x5922b0(0x73f);function getRandomValue(_0x140165){const _0x2ed8c2=_0x5922b0;if(_0x140165[_0x2ed8c2(0x773)](',')){const _0x574205=_0x140165[_0x2ed8c2(0x111f)](',')['map'](_0xcb9739=>_0xcb9739['trim']()),_0x2c4a6b=Math['floor'](Math[_0x2ed8c2(0x5b3)]()*_0x574205['length']);return _0x574205[_0x2c4a6b];}return _0x140165;}function isImage(_0x2c04d2){const _0x318b9b=_0x5922b0;if(_0x2c04d2[_0x318b9b(0x7a9)]&&_0x2c04d2[_0x318b9b(0x7a9)][_0x318b9b(0x9d6)]){let _0x35c935=_0x2c04d2[_0x318b9b(0x7a9)]['url'];const _0xbd718f=_0x35c935[_0x318b9b(0x111f)](',')[0x1],_0x1640cc=_0x35c935['match'](/^data:(.*);base64/)[0x1];return[{'text':_0x318b9b(0x17c)},{'inline_data':{'mime_type':_0x1640cc,'data':_0xbd718f}}];}return[];}function getGeminiResponseText(_0x44a8b2){const _0x3d0354=_0x5922b0;if(_0x44a8b2[_0x3d0354(0xa44)]&&Array[_0x3d0354(0xb85)](_0x44a8b2[_0x3d0354(0xa44)])&&_0x44a8b2[_0x3d0354(0xa44)][_0x3d0354(0x105a)]>0x0&&_0x44a8b2['choices'][0x0]['message']&&_0x44a8b2[_0x3d0354(0xa44)][0x0][_0x3d0354(0xc7d)]['content'])return _0x44a8b2[_0x3d0354(0xa44)][0x0][_0x3d0354(0xc7d)]['content'];if(_0x44a8b2['candidates']&&Array[_0x3d0354(0xb85)](_0x44a8b2['candidates'])&&_0x44a8b2[_0x3d0354(0xc88)][_0x3d0354(0x105a)]>0x0&&_0x44a8b2['candidates'][0x0][_0x3d0354(0x168)]&&_0x44a8b2['candidates'][0x0][_0x3d0354(0x168)][_0x3d0354(0x3f0)])return _0x44a8b2[_0x3d0354(0xc88)][0x0][_0x3d0354(0x168)]['parts'][0x0][_0x3d0354(0xbc6)];console[_0x3d0354(0x7a3)](_0x3d0354(0xfc4),_0x44a8b2);let _0x5039d3='AI返回了空内容或未知格式。';if(_0x44a8b2['candidates']&&Array[_0x3d0354(0xb85)](_0x44a8b2[_0x3d0354(0xc88)])&&_0x44a8b2[_0x3d0354(0xc88)]['length']>0x0&&_0x44a8b2[_0x3d0354(0xc88)][0x0][_0x3d0354(0x1273)]===_0x3d0354(0x148)){const _0x5c0f34=_0x44a8b2[_0x3d0354(0xc88)][0x0][_0x3d0354(0x99e)],_0x4cacc1=_0x5c0f34['filter'](_0x2d2353=>_0x2d2353['probability']!==_0x3d0354(0xf03)&&_0x2d2353['probability']!==_0x3d0354(0x6ee))[_0x3d0354(0x6b9)](_0x13c4e4=>_0x13c4e4[_0x3d0354(0x298)]+'\x20(概率:\x20'+_0x13c4e4[_0x3d0354(0x8af)]+')')[_0x3d0354(0xb2c)](',\x20');_0x5039d3=_0x3d0354(0x95f)+(_0x4cacc1||'未知');}else{if(_0x44a8b2['promptFeedback']?.['blockReason']){const _0x50b481=_0x44a8b2[_0x3d0354(0x721)]['blockReason'],_0x1a232e=_0x44a8b2['promptFeedback'][_0x3d0354(0x99e)]?.['map'](_0x44f28d=>_0x44f28d[_0x3d0354(0x298)]+':\x20'+_0x44f28d['probability'])[_0x3d0354(0xb2c)](',\x20');_0x5039d3=_0x3d0354(0x539)+_0x50b481+_0x3d0354(0x5df)+(_0x1a232e||'无');}else _0x44a8b2[_0x3d0354(0x7a3)]&&(_0x5039d3=_0x3d0354(0x2f9)+_0x44a8b2['error'][_0x3d0354(0xc7d)]);}throw new Error(_0x5039d3);}function _0x7a65(_0x26add1,_0x5297bb){const _0x272ec4=_0x272e();return _0x7a65=function(_0x7a6555,_0x568329){_0x7a6555=_0x7a6555-0x138;let _0x2cd7c2=_0x272ec4[_0x7a6555];return _0x2cd7c2;},_0x7a65(_0x26add1,_0x5297bb);}document[_0x5922b0(0xae8)](_0x5922b0(0x10c1),()=>{const _0x18b51e=_0x5922b0;function _0x282b7e(_0x3acd19,_0x248398,_0x39d856,_0x48be95){const _0x168c76=_0x7a65,_0x2bd9b4=_0x405767['globalSettings']['apiTemperature']||0.8,_0x169588={'user':_0x168c76(0x74b),'assistant':_0x168c76(0x8ce),'system':_0x168c76(0x74b)},_0x55e86d=[{'role':_0x168c76(0x74b),'parts':[{'text':_0x39d856}]},{'role':'model','parts':[{'text':'好的，我明白了。我会严格遵守以上所有规则和设定。'}]},..._0x48be95['map'](_0x29a353=>{const _0x332d13=_0x168c76,_0x43f9f2=[];return Array[_0x332d13(0xb85)](_0x29a353['content'])?_0x29a353[_0x332d13(0x168)][_0x332d13(0x7c0)](_0x85271=>{const _0x136168=_0x332d13;if(_0x85271[_0x136168(0xde0)]===_0x136168(0xbc6))_0x43f9f2[_0x136168(0xa49)]({'text':_0x85271[_0x136168(0xbc6)]});else{if(_0x85271[_0x136168(0xde0)]==='image_url'&&_0x85271[_0x136168(0x7a9)]&&_0x85271['image_url'][_0x136168(0x9d6)]){const _0x2913ef=_0x85271[_0x136168(0x7a9)][_0x136168(0x9d6)],_0x264e6b=_0x2913ef[_0x136168(0x111f)](',')[0x1],_0x3c3e80=_0x2913ef[_0x136168(0xdf8)](/^data:(.*);base64/);_0x3c3e80&&_0x264e6b&&_0x43f9f2['push']({'inline_data':{'mime_type':_0x3c3e80[0x1],'data':_0x264e6b}});}}}):_0x43f9f2[_0x332d13(0xa49)]({'text':String(_0x29a353[_0x332d13(0x168)])}),{'role':_0x169588[_0x29a353['role']],'parts':_0x43f9f2};})];return{'url':_0x168c76(0x558)+_0x3acd19+_0x168c76(0x1257)+getRandomValue(_0x248398),'data':{'method':_0x168c76(0xcd0),'headers':{'Content-Type':_0x168c76(0xcb6)},'body':JSON[_0x168c76(0x1175)]({'contents':_0x55e86d,'generationConfig':{'temperature':_0x2bd9b4}})}};}const _0x15043e=new Dexie(_0x18b51e(0x1077)),_0x469d4b=[{'id':'none','url':'','name':'无'},{'id':_0x18b51e(0xa0a),'url':_0x18b51e(0x78d),'name':'1'},{'id':_0x18b51e(0xcdc),'url':'https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','name':'2'},{'id':_0x18b51e(0xd10),'url':_0x18b51e(0xb99),'name':'3'},{'id':_0x18b51e(0x652),'url':'https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','name':'4'},{'id':'frame_5','url':_0x18b51e(0x5da),'name':'5'},{'id':_0x18b51e(0xf36),'url':_0x18b51e(0xfec),'name':'6'},{'id':_0x18b51e(0x1154),'url':_0x18b51e(0x122d),'name':'7'},{'id':'frame_8','url':'https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','name':'8'},{'id':_0x18b51e(0x297),'url':_0x18b51e(0x407),'name':'9'},{'id':_0x18b51e(0xec5),'url':_0x18b51e(0xfe4),'name':'10'},{'id':_0x18b51e(0x236),'url':_0x18b51e(0x10e9),'name':'11'},{'id':_0x18b51e(0xfbb),'url':'https://i.postimg.cc/prsGKMBx/IMG-4370.gif','name':'12'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0xf88),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x124c),'name':'14'},{'id':'frame_cat_ear','url':'https://i.postimg.cc/kGgwJhPH/IMG-4374.gif','name':'1'},{'id':_0x18b51e(0xcdc),'url':_0x18b51e(0x497),'name':'2'},{'id':_0x18b51e(0xd10),'url':'https://i.postimg.cc/fRV86FMq/IMG-4381.gif','name':'3'},{'id':_0x18b51e(0x652),'url':'https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','name':'4'},{'id':_0x18b51e(0x1036),'url':_0x18b51e(0x126d),'name':'5'},{'id':_0x18b51e(0xf36),'url':_0x18b51e(0xbce),'name':'6'},{'id':_0x18b51e(0x1154),'url':_0x18b51e(0x7da),'name':'7'},{'id':_0x18b51e(0xd70),'url':_0x18b51e(0x117c),'name':'8'},{'id':_0x18b51e(0x297),'url':_0x18b51e(0x1135),'name':'9'},{'id':'frame_10','url':_0x18b51e(0x66b),'name':'10'},{'id':_0x18b51e(0x236),'url':'https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif','name':'11'},{'id':_0x18b51e(0xfbb),'url':'https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif','name':'12'},{'id':'frame_13','url':'https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xf90),'name':'14'},{'id':'frame_cat_ear','url':'https://i.postimg.cc/yN3s8szM/IMG-4400.gif','name':'1'},{'id':_0x18b51e(0xcdc),'url':_0x18b51e(0x11d0),'name':'2'},{'id':_0x18b51e(0xd10),'url':_0x18b51e(0x19d),'name':'3'},{'id':_0x18b51e(0x652),'url':'https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','name':'4'},{'id':_0x18b51e(0x1036),'url':_0x18b51e(0x389),'name':'5'},{'id':_0x18b51e(0xf36),'url':_0x18b51e(0x4f1),'name':'6'},{'id':_0x18b51e(0x1154),'url':_0x18b51e(0x4ec),'name':'7'},{'id':_0x18b51e(0xd70),'url':_0x18b51e(0xd2b),'name':'8'},{'id':_0x18b51e(0x297),'url':_0x18b51e(0x487),'name':'9'},{'id':_0x18b51e(0xec5),'url':_0x18b51e(0xbfd),'name':'10'},{'id':'frame_11','url':_0x18b51e(0x9da),'name':'11'},{'id':_0x18b51e(0xfbb),'url':'https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','name':'12'},{'id':'frame_13','url':'https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xa40),'name':'14'},{'id':_0x18b51e(0xa0a),'url':'https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','name':'1'},{'id':'frame_ribbon','url':_0x18b51e(0xeff),'name':'2'},{'id':'frame_flower','url':_0x18b51e(0x48c),'name':'3'},{'id':_0x18b51e(0x652),'url':_0x18b51e(0x11a0),'name':'4'},{'id':_0x18b51e(0x1036),'url':'https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','name':'5'},{'id':_0x18b51e(0xf36),'url':_0x18b51e(0xddb),'name':'6'},{'id':_0x18b51e(0x1154),'url':_0x18b51e(0xb38),'name':'7'},{'id':'frame_8','url':_0x18b51e(0x200),'name':'8'},{'id':_0x18b51e(0x297),'url':_0x18b51e(0x1159),'name':'9'},{'id':_0x18b51e(0xec5),'url':_0x18b51e(0xc6a),'name':'10'},{'id':_0x18b51e(0x236),'url':_0x18b51e(0x7b1),'name':'11'},{'id':_0x18b51e(0xfbb),'url':_0x18b51e(0xb4f),'name':'12'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x329),'name':'13'},{'id':_0x18b51e(0x1016),'url':'https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','name':'14'},{'id':_0x18b51e(0xa0a),'url':_0x18b51e(0x10b1),'name':'1'},{'id':'frame_ribbon','url':'https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','name':'2'},{'id':_0x18b51e(0xd10),'url':_0x18b51e(0x4b6),'name':'3'},{'id':_0x18b51e(0x652),'url':_0x18b51e(0x1122),'name':'4'},{'id':_0x18b51e(0x1036),'url':'https://i.postimg.cc/g2XykNGB/IMG-4727.gif','name':'5'},{'id':'frame_6','url':_0x18b51e(0x675),'name':'6'},{'id':_0x18b51e(0x1154),'url':_0x18b51e(0x817),'name':'7'},{'id':_0x18b51e(0xd70),'url':_0x18b51e(0x801),'name':'8'},{'id':_0x18b51e(0x297),'url':_0x18b51e(0x61e),'name':'9'},{'id':_0x18b51e(0xec5),'url':'https://i.postimg.cc/DZshzKv6/IMG-5576.gif','name':'10'},{'id':_0x18b51e(0x236),'url':'https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','name':'11'},{'id':_0x18b51e(0xfbb),'url':_0x18b51e(0x69e),'name':'12'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0xa51),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xcd7),'name':'14'},{'id':_0x18b51e(0xa0a),'url':_0x18b51e(0x317),'name':'1'},{'id':_0x18b51e(0xcdc),'url':_0x18b51e(0x10fa),'name':'2'},{'id':_0x18b51e(0xd10),'url':_0x18b51e(0x10fa),'name':'3'},{'id':_0x18b51e(0x652),'url':_0x18b51e(0x8f0),'name':'4'},{'id':'frame_5','url':_0x18b51e(0x919),'name':'5'},{'id':'frame_6','url':_0x18b51e(0xf3f),'name':'6'},{'id':'frame_7','url':_0x18b51e(0xaec),'name':'7'},{'id':_0x18b51e(0xd70),'url':_0x18b51e(0xdaa),'name':'8'},{'id':_0x18b51e(0x297),'url':'https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','name':'9'},{'id':'frame_10','url':_0x18b51e(0x587),'name':'10'},{'id':_0x18b51e(0x236),'url':'https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','name':'12'},{'id':_0x18b51e(0x3cd),'url':'https://i.postimg.cc/1zmcp66p/IMG-5973.gif','name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','name':'14'},{'id':_0x18b51e(0xa0a),'url':'https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','name':'1'},{'id':'frame_ribbon','url':_0x18b51e(0xabe),'name':'2'},{'id':_0x18b51e(0xd10),'url':_0x18b51e(0xed3),'name':'3'},{'id':_0x18b51e(0x652),'url':_0x18b51e(0xf6e),'name':'4'},{'id':_0x18b51e(0x1036),'url':_0x18b51e(0x11af),'name':'5'},{'id':'frame_6','url':_0x18b51e(0xc5a),'name':'6'},{'id':_0x18b51e(0x1154),'url':'https://i.postimg.cc/qRCtnMms/IMG-6145.gif','name':'7'},{'id':_0x18b51e(0xd70),'url':_0x18b51e(0x479),'name':'8'},{'id':'frame_9','url':_0x18b51e(0x28e),'name':'9'},{'id':_0x18b51e(0xec5),'url':'https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','name':'10'},{'id':'frame_11','url':_0x18b51e(0x433),'name':'11'},{'id':_0x18b51e(0xfbb),'url':_0x18b51e(0x1045),'name':'12'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x412),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x714),'name':'14'},{'id':'frame_cat_ear','url':_0x18b51e(0xc1a),'name':'1'},{'id':_0x18b51e(0xcdc),'url':_0x18b51e(0x4e3),'name':'2'},{'id':_0x18b51e(0xd10),'url':_0x18b51e(0xc03),'name':'3'},{'id':'frame_tech','url':_0x18b51e(0xe4e),'name':'4'},{'id':_0x18b51e(0x1036),'url':_0x18b51e(0x116c),'name':'5'},{'id':'frame_6','url':_0x18b51e(0x2c9),'name':'6'},{'id':_0x18b51e(0x1154),'url':'https://i.postimg.cc/gkhf597g/IMG-6555.gif','name':'7'},{'id':_0x18b51e(0xd70),'url':_0x18b51e(0x4bc),'name':'8'},{'id':_0x18b51e(0x297),'url':_0x18b51e(0x56e),'name':'9'},{'id':'frame_10','url':_0x18b51e(0xe0f),'name':'10'},{'id':_0x18b51e(0x236),'url':_0x18b51e(0xf44),'name':'11'},{'id':_0x18b51e(0xfbb),'url':_0x18b51e(0x932),'name':'12'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x1b2),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x62a),'name':'14'},{'id':'frame_cat_ear','url':'https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','name':'1'},{'id':_0x18b51e(0xcdc),'url':'https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','name':'2'},{'id':_0x18b51e(0xd10),'url':_0x18b51e(0x115c),'name':'3'},{'id':'frame_tech','url':_0x18b51e(0x8d7),'name':'4'},{'id':'frame_5','url':_0x18b51e(0xd36),'name':'5'},{'id':_0x18b51e(0xf36),'url':_0x18b51e(0x8bc),'name':'6'},{'id':_0x18b51e(0x1154),'url':_0x18b51e(0x29b),'name':'7'},{'id':_0x18b51e(0xd70),'url':_0x18b51e(0x6d5),'name':'8'},{'id':_0x18b51e(0x297),'url':'https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','name':'9'},{'id':'frame_10','url':_0x18b51e(0xbd5),'name':'10'},{'id':'frame_11','url':_0x18b51e(0x8e6),'name':'11'},{'id':_0x18b51e(0xfbb),'url':'https://i.postimg.cc/28TsrxRV/IMG-6852.gif','name':'12'},{'id':_0x18b51e(0x3cd),'url':'https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x884),'name':'14'},{'id':'frame_cat_ear','url':_0x18b51e(0xf8e),'name':'1'},{'id':_0x18b51e(0xcdc),'url':_0x18b51e(0x101a),'name':'2'},{'id':_0x18b51e(0xd10),'url':'https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','name':'3'},{'id':_0x18b51e(0x652),'url':'https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','name':'4'},{'id':_0x18b51e(0x1036),'url':_0x18b51e(0xc64),'name':'5'},{'id':_0x18b51e(0xf36),'url':'https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','name':'6'},{'id':'frame_7','url':_0x18b51e(0x283),'name':'7'},{'id':_0x18b51e(0xd70),'url':_0x18b51e(0xeb3),'name':'8'},{'id':_0x18b51e(0x297),'url':_0x18b51e(0x9c4),'name':'9'},{'id':_0x18b51e(0xec5),'url':_0x18b51e(0x892),'name':'10'},{'id':_0x18b51e(0x236),'url':_0x18b51e(0xc74),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','name':'12'},{'id':_0x18b51e(0x3cd),'url':'https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','name':'13'},{'id':_0x18b51e(0x1016),'url':'https://i.postimg.cc/d0WCKxff/IMG-6932.gif','name':'14'},{'id':'frame_11','url':_0x18b51e(0x1f6),'name':'11'},{'id':_0x18b51e(0xfbb),'url':_0x18b51e(0xdf9),'name':'12'},{'id':_0x18b51e(0x3cd),'url':'https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/sDFhySn3/IMG-6936.gif','name':'14'},{'id':_0x18b51e(0x3cd),'url':'https://i.postimg.cc/43PhvxRq/IMG-6922.gif','name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xd7b),'name':'14'},{'id':_0x18b51e(0x3cd),'url':'https://i.postimg.cc/PJppkbvn/IMG-6918.gif','name':'13'},{'id':'frame_14','url':_0x18b51e(0x72e),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x10fc),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x4ff),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x8d6),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x104c),'name':'14'},{'id':_0x18b51e(0xfbb),'url':_0x18b51e(0x972),'name':'12'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x57c),'name':'13'},{'id':'frame_14','url':_0x18b51e(0xce6),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x39f),'name':'13'},{'id':_0x18b51e(0x1016),'url':'https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','name':'14'},{'id':'frame_13','url':_0x18b51e(0x6d9),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x21e),'name':'14'},{'id':'frame_14','url':_0x18b51e(0x5af),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x76f),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xb9b),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x2a2),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','name':'14'},{'id':_0x18b51e(0x1016),'url':'https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','name':'14'},{'id':'frame_14','url':_0x18b51e(0x2df),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x11c7),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xbd0),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x1d5),'name':'14'},{'id':_0x18b51e(0x3cd),'url':'https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x96b),'name':'14'},{'id':'frame_14','url':_0x18b51e(0x16a),'name':'14'},{'id':_0x18b51e(0x3cd),'url':'https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif','name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x689),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x117e),'name':'14'},{'id':'frame_14','url':_0x18b51e(0x197),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x738),'name':'13'},{'id':'frame_14','url':_0x18b51e(0x11a3),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xda6),'name':'14'},{'id':'frame_13','url':_0x18b51e(0x725),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x400),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x89d),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x53f),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x1231),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x16e),'name':'14'},{'id':'frame_14','url':_0x18b51e(0x5ee),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x123f),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xd3f),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x147),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xe6d),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x14f),'name':'13'},{'id':_0x18b51e(0x1016),'url':'https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0xf96),'name':'13'},{'id':_0x18b51e(0x1016),'url':'https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xca9),'name':'14'},{'id':'frame_14','url':_0x18b51e(0x274),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0xbaf),'name':'13'},{'id':'frame_14','url':_0x18b51e(0xb3f),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x951),'name':'14'},{'id':_0x18b51e(0x3cd),'url':'https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif','name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xa9d),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xde4),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xf68),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0xd82),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xe81),'name':'14'},{'id':_0x18b51e(0x1016),'url':'https://i.postimg.cc/W40f9qtd/IMG-7098.gif','name':'14'},{'id':'frame_13','url':_0x18b51e(0x85f),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x3b4),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xc01),'name':'14'},{'id':'frame_14','url':_0x18b51e(0x5ce),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0xf87),'name':'13'},{'id':'frame_14','url':_0x18b51e(0x67a),'name':'14'},{'id':_0x18b51e(0x1016),'url':'https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif','name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/pddJj9zN/IMG-7094.gif','name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x537),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xe1c),'name':'14'},{'id':'frame_14','url':_0x18b51e(0xa58),'name':'14'},{'id':_0x18b51e(0x3cd),'url':'https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xe52),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif','name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x10ac),'name':'13'},{'id':_0x18b51e(0x1016),'url':'https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x1226),'name':'14'},{'id':'frame_14','url':_0x18b51e(0x5b9),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x51d),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x6bb),'name':'14'},{'id':'frame_14','url':_0x18b51e(0xc8a),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0xd3e),'name':'13'},{'id':_0x18b51e(0x1016),'url':'https://i.postimg.cc/zvWGPjms/IMG-7090.gif','name':'14'},{'id':'frame_14','url':_0x18b51e(0xf80),'name':'14'},{'id':'frame_14','url':_0x18b51e(0xaa2),'name':'14'},{'id':'frame_13','url':_0x18b51e(0xba4),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x3d6),'name':'14'},{'id':'frame_14','url':_0x18b51e(0x3d7),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0xb44),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x2d8),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xeb8),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x771),'name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x98c),'name':'13'},{'id':_0x18b51e(0x1016),'url':'https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','name':'14'},{'id':_0x18b51e(0x1016),'url':'https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','name':'14'},{'id':_0x18b51e(0x3cd),'url':_0x18b51e(0x622),'name':'13'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0xc63),'name':'14'},{'id':_0x18b51e(0x1016),'url':_0x18b51e(0x9dc),'name':'14'}];let _0x405767={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map()},_0x54c7b5={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':'setup','nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0x4099a9=0x0;const _0x3e233a=0xf;let _0x37c049=0x0;const _0x4bd2cf=0xa;let _0x3c4d9a=[],_0x4a77e1={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':'order','totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0x1b5b07={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x3fd13b=document[_0x18b51e(0x8c2)](_0x18b51e(0xc50));let _0xca7708=null,_0x324554=![],_0x2564c3=0x0,_0x14e3cf=null,_0x451dc7=![],_0x5abf24='all',_0x13ef23=new Set(),_0x4c8670=null,_0x2db465=![],_0x4ec30d=null,_0x123726=null,_0x5314bd=![],_0x2a9ed2=![],_0xfd5f49=![],_0x5a2592=![],_0x2e87a6=[],_0x1342a5=null,_0x19e711=null,_0x4fd4bd={},_0x39784f=null,_0x1f6e46=null,_0x6f0af7=null,_0x369d4b=null,_0x2a4f08=null,_0x5267dc=null,_0x41e425=null,_0x52311a=[],_0x1036b6=null,_0x43724b=null,_0x45640a=new Set(),_0x31af8a=null,_0x2338bf=null,_0x32ff0a=null,_0x41f39d={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x38d2a9=0x0,_0x7e4f8a=![],_0x5388ea=new Set(),_0x57a066=null;const _0x49d2a4=_0x18b51e(0xd41),_0x38e728=_0x18b51e(0x33b),_0x9fdc61=_0x18b51e(0xa29),_0x56835c='https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg';let _0x18be2b,_0x3976af={};const _0x93749c=_0x18b51e(0x23f);let _0x5d05df={},_0x2fd142={},_0x5488b0=null;const _0x85529d={'qq':_0x18b51e(0x2cc),'world-book':_0x18b51e(0x73b),'wallpaper':_0x18b51e(0xb42),'renderer':_0x18b51e(0x4aa),'api-settings':_0x18b51e(0x923),'font':_0x18b51e(0xd32),'char-phone':_0x18b51e(0x10ce),'douban':'https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','preset':_0x18b51e(0x47e),'tutorial':'https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','werewolf':'https://i.postimg.cc/k401K5g7/IMG-7304.jpg','x':'https://i.postimg.cc/Y9d3BztC/1.png'},_0x1c31bc={'qq':_0x18b51e(0x2cc),'album':_0x18b51e(0x73b),'browser':_0x18b51e(0x7c1),'taobao':_0x18b51e(0x3e8),'memo':_0x18b51e(0x127f),'diary':_0x18b51e(0x64f),'amap':_0x18b51e(0xce5),'usage':_0x18b51e(0x1076),'music':_0x18b51e(0x1180),'ephone':_0x18b51e(0x10ce)};let _0x134b0f=null;const _0x3ba794=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0x5ea6d4=0x0,_0x6fc3f5=0x1,_0x7de39a={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0x5596ec;const _0x401daa=document[_0x18b51e(0x8c1)](_0x18b51e(0x842));_0x401daa['id']='dynamic-font-style',document[_0x18b51e(0x1e0)][_0x18b51e(0x31e)](_0x401daa);const _0x869e2c=document[_0x18b51e(0x8c2)](_0x18b51e(0x947)),_0x1b0614=document[_0x18b51e(0x8c2)](_0x18b51e(0x8e2)),_0x5d13a9=document[_0x18b51e(0x8c2)](_0x18b51e(0xcf3)),_0x5baefc=document[_0x18b51e(0x8c2)](_0x18b51e(0x7a2)),_0x542efe=document[_0x18b51e(0x8c2)](_0x18b51e(0xafd));let _0x8ae021;function _0x1af628(){const _0x6fd98c=_0x18b51e;_0x869e2c[_0x6fd98c(0xb17)][_0x6fd98c(0x3f4)]('visible');}function _0x2c84fc(){const _0x594790=_0x18b51e;_0x869e2c[_0x594790(0xb17)][_0x594790(0xaff)]('visible'),_0x5baefc['classList']['remove'](_0x594790(0xe2a));if(_0x8ae021)_0x8ae021(null);}function _0x37055b(_0x1bf9da){const _0x5573c1=_0x18b51e,_0x3ca4c5=document['getElementById']('global-lyrics-bar'),_0x59d6e1=_0x1bf9da[_0x5573c1(0x33a)][_0x5573c1(0x45f)]||{'vertical':_0x5573c1(0x9a4),'horizontal':_0x5573c1(0x65d),'offset':0xa};_0x3ca4c5[_0x5573c1(0x842)][_0x5573c1(0x9a4)]=_0x5573c1(0x541),_0x3ca4c5[_0x5573c1(0x842)][_0x5573c1(0xf2b)]=_0x5573c1(0x541),_0x3ca4c5[_0x5573c1(0x842)][_0x5573c1(0xe3a)]=_0x5573c1(0x541),_0x3ca4c5[_0x5573c1(0x842)][_0x5573c1(0x36e)]=_0x5573c1(0x541),_0x3ca4c5[_0x5573c1(0x842)][_0x5573c1(0xb56)]='none';_0x59d6e1['vertical']==='top'?_0x3ca4c5[_0x5573c1(0x842)]['top']=_0x59d6e1[_0x5573c1(0x780)]+'px':_0x3ca4c5[_0x5573c1(0x842)][_0x5573c1(0xf2b)]=_0x59d6e1[_0x5573c1(0x780)]+'px';switch(_0x59d6e1[_0x5573c1(0x157)]){case _0x5573c1(0xe3a):_0x3ca4c5[_0x5573c1(0x842)][_0x5573c1(0xe3a)]=_0x5573c1(0xd01);break;case _0x5573c1(0x36e):_0x3ca4c5[_0x5573c1(0x842)][_0x5573c1(0x36e)]=_0x5573c1(0xd01);break;case'center':default:_0x3ca4c5[_0x5573c1(0x842)][_0x5573c1(0xe3a)]=_0x5573c1(0x72f),_0x3ca4c5[_0x5573c1(0x842)][_0x5573c1(0xb56)]=_0x5573c1(0xc41);break;}}async function _0x236764(_0x2cf31e){const _0x1dd2cd=_0x18b51e,_0x25857c=_0x2cf31e[_0x1dd2cd(0x475)][_0x1dd2cd(0xde8)][0x0];if(!_0x25857c)return;const _0xdb055d=await new Promise(_0x4dc24f=>{const _0x21349f=_0x1dd2cd,_0x20d53c=new FileReader();_0x20d53c[_0x21349f(0xe7a)]=()=>_0x4dc24f(_0x20d53c[_0x21349f(0xa92)]),_0x20d53c[_0x21349f(0x779)](_0x25857c);});await _0x501c7b(_0x1dd2cd(0x1047),_0x1dd2cd(0xf4c));try{const _0x46799c=await _0x3b82c3(_0xdb055d);if(!_0x46799c)throw new Error(_0x1dd2cd(0xee0));const _0x1dc846=_0x405767[_0x1dd2cd(0x799)][_0x405767[_0x1dd2cd(0x248)]];!_0x1dc846['settings'][_0x1dd2cd(0x227)]&&(_0x1dc846[_0x1dd2cd(0x33a)]['groupAvatarLibrary']=[]),_0x1dc846['settings']['groupAvatarLibrary'][_0x1dd2cd(0xa49)]({'name':_0x46799c,'url':_0xdb055d}),await _0x15043e['chats']['put'](_0x1dc846),_0x4096ca(),await _0x501c7b(_0x1dd2cd(0xabd),_0x1dd2cd(0xc65)+_0x46799c+'”');}catch(_0x4d3531){console['error'](_0x1dd2cd(0xaf9),_0x4d3531),await _0x501c7b(_0x1dd2cd(0xa85),_0x1dd2cd(0xa97)+_0x4d3531[_0x1dd2cd(0xc7d)]);}finally{_0x2cf31e[_0x1dd2cd(0x475)][_0x1dd2cd(0x518)]=null;}}async function _0x4da1eb(_0x438b89){const _0x1a1741=_0x18b51e,_0x163b83=_0x438b89[_0x1a1741(0x475)][_0x1a1741(0xde8)][0x0];if(!_0x163b83)return;const _0x5c4bef=await new Promise(_0x58c752=>{const _0x10a1cd=_0x1a1741,_0x3811ce=new FileReader();_0x3811ce[_0x10a1cd(0xe7a)]=()=>_0x58c752(_0x3811ce['result']),_0x3811ce[_0x10a1cd(0x779)](_0x163b83);});await _0x501c7b(_0x1a1741(0x1047),_0x1a1741(0xd5b));try{const _0x2a0b06=await _0x3b82c3(_0x5c4bef);if(!_0x2a0b06)throw new Error(_0x1a1741(0xee0));const _0x3fe8ef=_0x405767['chats'][_0x405767[_0x1a1741(0x248)]];!_0x3fe8ef[_0x1a1741(0x33a)][_0x1a1741(0xca4)]&&(_0x3fe8ef[_0x1a1741(0x33a)][_0x1a1741(0xca4)]=[]),_0x3fe8ef[_0x1a1741(0x33a)]['aiAvatarLibrary']['push']({'name':_0x2a0b06,'url':_0x5c4bef}),await _0x15043e[_0x1a1741(0x799)][_0x1a1741(0xfaa)](_0x3fe8ef),_0x370e39(),await _0x501c7b(_0x1a1741(0xabd),_0x1a1741(0x77e)+_0x2a0b06+'”');}catch(_0x4a1ef4){console['error'](_0x1a1741(0x3b3),_0x4a1ef4),await _0x501c7b(_0x1a1741(0xa85),_0x1a1741(0xa97)+_0x4a1ef4['message']);}finally{_0x438b89[_0x1a1741(0x475)][_0x1a1741(0x518)]=null;}}async function _0x3b82c3(_0x4ad9f0){const _0x4a32fe=_0x18b51e,_0x1b5d6f=_0x405767[_0x4a32fe(0x9e0)][_0x4a32fe(0x2fa)]&&_0x405767[_0x4a32fe(0x9e0)][_0x4a32fe(0x107f)]&&_0x405767[_0x4a32fe(0x9e0)][_0x4a32fe(0x234)],{proxyUrl:_0x1fa8b6,apiKey:_0x2af635,model:_0x39e4dc}=_0x1b5d6f?{'proxyUrl':_0x405767['apiConfig']['secondaryProxyUrl'],'apiKey':_0x405767[_0x4a32fe(0x9e0)][_0x4a32fe(0x107f)],'model':_0x405767['apiConfig'][_0x4a32fe(0x234)]}:_0x405767['apiConfig'];if(!_0x1fa8b6||!_0x2af635||!_0x39e4dc)throw new Error(_0x4a32fe(0x6b4));const _0x7586e4=_0x4a32fe(0x63f);let _0x362da2=_0x1fa8b6[_0x4a32fe(0x773)](_0x4a32fe(0x3fe)),_0xf4a813;if(_0x362da2){const _0x36152a=_0x4ad9f0['match'](/^data:(.*);base64/)[0x1],_0x4e4732=_0x4ad9f0[_0x4a32fe(0x111f)](',')[0x1],_0x31da0f={'contents':[{'parts':[{'text':_0x7586e4},{'inline_data':{'mime_type':_0x36152a,'data':_0x4e4732}}]}]};_0xf4a813=await fetch(_0x1fa8b6+'/'+_0x39e4dc+_0x4a32fe(0x1257)+_0x2af635,{'method':'POST','headers':{'Content-Type':_0x4a32fe(0xcb6)},'body':JSON['stringify'](_0x31da0f)});}else{const _0x4259a7={'model':_0x39e4dc,'messages':[{'role':'user','content':[{'type':_0x4a32fe(0xbc6),'text':_0x7586e4},{'type':'image_url','image_url':{'url':_0x4ad9f0}}]}],'max_tokens':0x32};_0xf4a813=await fetch(_0x1fa8b6+'/v1/chat/completions',{'method':_0x4a32fe(0xcd0),'headers':{'Content-Type':_0x4a32fe(0xcb6),'Authorization':'Bearer\x20'+_0x2af635},'body':JSON[_0x4a32fe(0x1175)](_0x4259a7)});}if(!_0xf4a813['ok']){const _0x25f68b=await _0xf4a813['json']();throw new Error(_0x4a32fe(0xd83)+_0x25f68b['error'][_0x4a32fe(0xc7d)]);}const _0x3eabc4=await _0xf4a813[_0x4a32fe(0x7e9)]();let _0x44fd3a=_0x362da2?getGeminiResponseText(_0x3eabc4):_0x3eabc4[_0x4a32fe(0xa44)][0x0]['message']['content'];return _0x44fd3a[_0x4a32fe(0x8c6)]()['replace'](/["'“”‘’]/g,'');}async function _0x4b93d2(_0x5838f6){const _0x58fa23=_0x18b51e;if(!_0x5838f6||_0x5838f6[_0x58fa23(0x1000)]){console[_0x58fa23(0x112a)]('syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。');return;}const _0x2b87f0=_0x5838f6['id'],_0x561887=_0x5838f6[_0x58fa23(0x596)],_0x489fb5=_0x5838f6[_0x58fa23(0x4e7)];console[_0x58fa23(0x32b)](_0x58fa23(0x957)+_0x2b87f0+_0x58fa23(0x3a3));for(const _0x50a302 in _0x405767[_0x58fa23(0x799)]){const _0x435356=_0x405767[_0x58fa23(0x799)][_0x50a302];if(_0x435356[_0x58fa23(0x1000)]&&_0x435356[_0x58fa23(0x635)]){const _0x590aa4=_0x435356['members'][_0x58fa23(0x2ef)](_0x686db9=>_0x686db9['id']===_0x2b87f0);if(_0x590aa4){let _0x377bef=![];_0x590aa4[_0x58fa23(0x375)]!==_0x561887&&(_0x590aa4['groupNickname']=_0x561887,_0x377bef=!![]),_0x590aa4[_0x58fa23(0x4e7)]!==_0x489fb5&&(_0x590aa4[_0x58fa23(0x4e7)]=_0x489fb5,_0x377bef=!![]),_0x377bef&&(await _0x15043e['chats'][_0x58fa23(0xfaa)](_0x435356),console[_0x58fa23(0x32b)]('成功将群聊\x20\x22'+_0x435356[_0x58fa23(0x596)]+_0x58fa23(0x597)));}}}}async function _0x19507d(_0x1efe00){const _0x1dd58b=_0x18b51e;if(!_0x1efe00||_0x1efe00['isGroup']){console[_0x1dd58b(0x112a)](_0x1dd58b(0x7cb));return;}const _0x359984=_0x1efe00['id'],_0x311fa4=_0x1efe00[_0x1dd58b(0x33a)][_0x1dd58b(0x44e)];console['log'](_0x1dd58b(0x957)+_0x359984+_0x1dd58b(0x7e4));for(const _0x555d7a of Object[_0x1dd58b(0x22f)](_0x405767['chats'])){if(_0x555d7a[_0x1dd58b(0x1000)]&&_0x555d7a[_0x1dd58b(0x635)]){const _0x30e8ff=_0x555d7a[_0x1dd58b(0x635)][_0x1dd58b(0x2ef)](_0x31541d=>_0x31541d['id']===_0x359984);_0x30e8ff&&_0x30e8ff[_0x1dd58b(0x1e1)]!==_0x311fa4&&(_0x30e8ff[_0x1dd58b(0x1e1)]=_0x311fa4,await _0x15043e[_0x1dd58b(0x799)]['put'](_0x555d7a),console[_0x1dd58b(0x32b)]('成功将角色\x20'+_0x359984+_0x1dd58b(0xc0d)+_0x555d7a['name']+'\x22'));}}}function _0x1ba34a(_0x58b538,_0x566fd9){const _0x1aa3bb=_0x18b51e;if(!_0x58b538||!_0x58b538[_0x1aa3bb(0x1000)]||!_0x566fd9)return _0x566fd9;const _0x5c3f8e=_0x405767['qzoneSettings'][_0x1aa3bb(0xab3)]||_0x1aa3bb(0x2dc);if(_0x566fd9===_0x5c3f8e)return _0x58b538[_0x1aa3bb(0x33a)][_0x1aa3bb(0xe16)]||'我';const _0x27c9bb=_0x58b538['members'][_0x1aa3bb(0x2ef)](_0x1cfcbe=>_0x1cfcbe[_0x1aa3bb(0x4e7)]===_0x566fd9);return _0x27c9bb?_0x27c9bb['groupNickname']:_0x566fd9;}function _0x5ad026(_0x1c6e03){const _0xba68c8=_0x18b51e;document[_0xba68c8(0xa2d)]('.rules-tab')[_0xba68c8(0x7c0)](_0x30202d=>{const _0x43c286=_0xba68c8;_0x30202d['classList'][_0x43c286(0xfc3)](_0x43c286(0x71b),_0x30202d[_0x43c286(0x323)]['categoryId']===_0x1c6e03);}),document[_0xba68c8(0xa2d)]('.rules-category-pane')[_0xba68c8(0x7c0)](_0x347229=>{const _0x37d849=_0xba68c8;_0x347229[_0x37d849(0xb17)][_0x37d849(0xfc3)](_0x37d849(0x71b),_0x347229[_0x37d849(0x323)]['categoryId']===_0x1c6e03);});}function _0x4846a6(_0x35a749){const _0xd896e5=_0x18b51e;if(!_0x35a749)return'';if(_0x405767[_0xd896e5(0x20a)]&&_0x35a749===_0x405767['qzoneSettings'][_0xd896e5(0xab3)])return _0x405767[_0xd896e5(0x20a)]['nickname'];let _0x5c6594=Object['values'](_0x405767[_0xd896e5(0x799)])[_0xd896e5(0x2ef)](_0x59ff7a=>!_0x59ff7a['isGroup']&&_0x59ff7a[_0xd896e5(0x4e7)]===_0x35a749);if(_0x5c6594)return _0x5c6594[_0xd896e5(0x596)];_0x5c6594=Object[_0xd896e5(0x22f)](_0x405767['chats'])['find'](_0x60f15f=>!_0x60f15f[_0xd896e5(0x1000)]&&(_0x60f15f[_0xd896e5(0x1116)]&&_0x60f15f['nameHistory'][_0xd896e5(0x773)](_0x35a749)));if(_0x5c6594)return _0x5c6594['name'];return _0x35a749;}function _0x206f67(_0x48be62,_0x4d1f70=null){const _0x1b33d3=_0x18b51e;if(!_0x48be62||typeof _0x48be62!==_0x1b33d3(0xf1b)||!_0x48be62[_0x1b33d3(0x773)](_0x1b33d3(0x1af)))return _0x48be62;return _0x48be62[_0x1b33d3(0x1b7)](/@\[\[([^\]]+)\]\]/g,(_0x12a791,_0x12d6c6)=>{const _0x4abcdd=_0x1b33d3,_0x52f254=_0x12d6c6[_0x4abcdd(0x8c6)]();let _0x4f86e8;return _0x4d1f70&&_0x4d1f70[_0x4abcdd(0x1000)]?_0x4f86e8=_0x1ba34a(_0x4d1f70,_0x52f254):_0x4f86e8=_0x4846a6(_0x52f254),'@'+_0x4f86e8;});}function _0x8b9cb8(_0x4f0861,_0x4fbd2c,_0x47dcdf={}){return new Promise(_0x4848b5=>{const _0x57bf7a=_0x7a65;_0x8ae021=_0x4848b5,_0x1b0614[_0x57bf7a(0x1090)]=_0x4f0861,_0x5d13a9[_0x57bf7a(0xca0)]=_0x57bf7a(0x121f)+_0x4fbd2c+_0x57bf7a(0x2e7);const _0xc04aae=document[_0x57bf7a(0x8c2)](_0x57bf7a(0x7a2)),_0x57c89e=document['getElementById']('custom-modal-cancel');_0x57c89e[_0x57bf7a(0x842)][_0x57bf7a(0x5e9)]=_0x57bf7a(0xea7),_0xc04aae[_0x57bf7a(0x1090)]=_0x47dcdf[_0x57bf7a(0x917)]||'确定',_0x57c89e[_0x57bf7a(0x1090)]=_0x47dcdf[_0x57bf7a(0x60a)]||'取消',_0x47dcdf[_0x57bf7a(0xadf)]?_0xc04aae[_0x57bf7a(0xb17)][_0x57bf7a(0x3f4)](_0x47dcdf['confirmButtonClass']):_0xc04aae[_0x57bf7a(0xb17)][_0x57bf7a(0xaff)](_0x57bf7a(0xe2a)),_0xc04aae['onclick']=()=>{_0x4848b5(!![]),_0x2c84fc();},_0x57c89e[_0x57bf7a(0xcda)]=()=>{_0x4848b5(![]),_0x2c84fc();},_0x1af628();});}function _0x501c7b(_0x2f1c50,_0x4e0173){return new Promise(_0x50e412=>{const _0x2d6bf3=_0x7a65;_0x8ae021=_0x50e412,_0x1b0614[_0x2d6bf3(0x1090)]=_0x2f1c50,_0x5d13a9['innerHTML']='<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>'+_0x4e0173+'</p>';const _0x37a959=document[_0x2d6bf3(0x8c2)]('custom-modal-confirm'),_0x3f8abc=document[_0x2d6bf3(0x8c2)]('custom-modal-cancel');_0x3f8abc[_0x2d6bf3(0x842)][_0x2d6bf3(0x5e9)]='none',_0x37a959[_0x2d6bf3(0x1090)]='好的',_0x37a959[_0x2d6bf3(0xcda)]=()=>{const _0xb2f27b=_0x2d6bf3;_0x3f8abc[_0xb2f27b(0x842)][_0xb2f27b(0x5e9)]=_0xb2f27b(0xea7),_0x37a959[_0xb2f27b(0x1090)]='确定',_0x50e412(!![]),_0x2c84fc();},_0x1af628();});}function _0x180f74(_0x517060,_0x325051,_0x16827a='',_0x35714e=_0x18b51e(0xbc6),_0x50c7bf=''){return new Promise(_0x5893e4=>{const _0x31aa31=_0x7a65;_0x8ae021=_0x5893e4,_0x1b0614[_0x31aa31(0x1090)]=_0x517060;const _0x53fb1f=_0x31aa31(0x4de),_0x5b4d03=_0x35714e===_0x31aa31(0x6c3)?_0x31aa31(0x321)+_0x53fb1f+_0x31aa31(0x584)+_0x325051+'\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>'+_0x16827a+_0x31aa31(0x106a):_0x31aa31(0x262)+_0x35714e+_0x31aa31(0x123a)+_0x53fb1f+_0x31aa31(0x584)+_0x325051+_0x31aa31(0x896)+_0x16827a+'\x22>';_0x5d13a9[_0x31aa31(0xca0)]=_0x50c7bf+_0x5b4d03;const _0x1be799=document[_0x31aa31(0x8c2)](_0x53fb1f);_0x5d13a9[_0x31aa31(0xa2d)]('.format-btn')[_0x31aa31(0x7c0)](_0x6e9ea3=>{const _0x354d1a=_0x31aa31;_0x6e9ea3[_0x354d1a(0xae8)](_0x354d1a(0xa17),()=>{const _0x17ea1d=_0x354d1a,_0x2c110f=_0x6e9ea3[_0x17ea1d(0x323)]['template'];if(_0x2c110f)try{const _0x4953b7=JSON['parse'](_0x2c110f);_0x1be799[_0x17ea1d(0x518)]=JSON[_0x17ea1d(0x1175)](_0x4953b7,null,0x2),_0x1be799['focus']();}catch(_0x54c070){console[_0x17ea1d(0x7a3)](_0x17ea1d(0xb01),_0x54c070);}});});const _0x4199ff=document['getElementById'](_0x31aa31(0x7a2)),_0x4c3dd2=document['getElementById'](_0x31aa31(0xafd));_0x4199ff[_0x31aa31(0xcda)]=()=>{const _0x19cb33=_0x31aa31;_0x5893e4(_0x1be799[_0x19cb33(0x518)]),_0x2c84fc();},_0x4c3dd2[_0x31aa31(0xcda)]=()=>{_0x5893e4(null),_0x2c84fc();},_0x1af628(),setTimeout(()=>_0x1be799['focus'](),0x64);});}function _0x40fef8(_0x1bc233,_0x40f6f0){const _0x2be260=_0x18b51e;return new Promise(_0x535597=>{const _0x374fa5=_0x7a65,_0x58b729=document['getElementById'](_0x374fa5(0x947)),_0x3e8d48=document['getElementById'](_0x374fa5(0x8e2)),_0x37e18b=document['getElementById'](_0x374fa5(0xcf3)),_0x4315a8=document[_0x374fa5(0x1ad)]('#custom-modal\x20.custom-modal-footer');_0x3e8d48[_0x374fa5(0x1090)]=_0x1bc233,_0x37e18b[_0x374fa5(0xca0)]='',_0x4315a8['innerHTML']='',_0x4315a8[_0x374fa5(0x842)][_0x374fa5(0xcec)]='column',_0x40f6f0[_0x374fa5(0x7c0)](_0x2bc10f=>{const _0x9b1fff=_0x374fa5,_0x484688=document[_0x9b1fff(0x8c1)](_0x9b1fff(0x19a));_0x484688[_0x9b1fff(0x1090)]=_0x2bc10f[_0x9b1fff(0xbc6)],_0x484688[_0x9b1fff(0xcda)]=()=>{const _0x3198d4=_0x9b1fff;_0x58b729['classList'][_0x3198d4(0xaff)](_0x3198d4(0x2cd)),_0x535597(_0x2bc10f[_0x3198d4(0x518)]);},_0x4315a8[_0x9b1fff(0x31e)](_0x484688);});const _0x4c224c=document['createElement'](_0x374fa5(0x19a));_0x4c224c[_0x374fa5(0x1090)]='取消',_0x4c224c[_0x374fa5(0x842)][_0x374fa5(0xe58)]='8px',_0x4c224c[_0x374fa5(0x842)][_0x374fa5(0x9f9)]=_0x374fa5(0x6c8),_0x4c224c[_0x374fa5(0x842)][_0x374fa5(0x617)]='#f0f0f0',_0x4c224c['onclick']=()=>{const _0xa7d23d=_0x374fa5;_0x58b729['classList'][_0xa7d23d(0xaff)](_0xa7d23d(0x2cd)),_0x535597(null);},_0x4315a8['appendChild'](_0x4c224c),_0x58b729[_0x374fa5(0xb17)][_0x374fa5(0x3f4)](_0x374fa5(0x2cd));})[_0x2be260(0x8df)](()=>{const _0xe27145=_0x2be260,_0x137885=document[_0xe27145(0x1ad)](_0xe27145(0x11d2));_0x137885[_0xe27145(0x842)][_0xe27145(0xcec)]='row',_0x137885[_0xe27145(0xca0)]=_0xe27145(0xd99),document['getElementById']('custom-modal-cancel')['addEventListener'](_0xe27145(0xa17),_0x2c84fc);});}async function _0xd2f4cb(){const _0x5cbf27=_0x18b51e,_0x2ac814=await _0x40fef8(_0x5cbf27(0x1a6),[{'text':_0x5cbf27(0x1d4),'value':_0x5cbf27(0xf0a)},{'text':_0x5cbf27(0x10d9),'value':_0x5cbf27(0x258)}]);if(_0x2ac814===_0x5cbf27(0xf0a))return new Promise(_0x577a15=>{const _0x35d594=_0x5cbf27,_0x1b44ec=document[_0x35d594(0x8c2)](_0x35d594(0x90d)),_0x33d307=_0x3352fc=>{const _0x32895e=_0x35d594,_0x481f12=_0x3352fc[_0x32895e(0x475)]['files'][0x0];if(_0x481f12){const _0x5dc55b=new FileReader();_0x5dc55b[_0x32895e(0xe7a)]=_0x57e0b8=>_0x577a15(_0x57e0b8[_0x32895e(0x475)][_0x32895e(0xa92)]),_0x5dc55b['onerror']=()=>_0x577a15(''),_0x5dc55b[_0x32895e(0x2d0)](_0x481f12);}else _0x577a15(null);_0x1b44ec[_0x32895e(0x2b2)]('change',_0x33d307),_0x1b44ec[_0x32895e(0x518)]='';};_0x1b44ec[_0x35d594(0xae8)](_0x35d594(0x7a7),_0x33d307,{'once':!![]}),_0x1b44ec['click']();});else{if(_0x2ac814===_0x5cbf27(0x258)){const _0x1e9668=await _0x180f74(_0x5cbf27(0xc4b),_0x5cbf27(0xdcb),'',_0x5cbf27(0x6c3));if(_0x1e9668){const _0x5a3007=_0x1e9668[_0x5cbf27(0x1b7)](/\[/g,'\x0a[')['trim']();return _0x5a3007;}return _0x1e9668;}else return null;}}_0x15043e['version'](0x27)[_0x18b51e(0x1f3)]({'doubanPosts':_0x18b51e(0x851),'chats':'&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','apiConfig':_0x18b51e(0xa59),'globalSettings':_0x18b51e(0x5d2),'userStickers':'&id,\x20url,\x20name,\x20categoryId','worldBooks':'&id,\x20name,\x20categoryId','worldBookCategories':_0x18b51e(0x91f),'musicLibrary':'&id','personaPresets':_0x18b51e(0x5d2),'qzoneSettings':'&id','qzonePosts':'++id,\x20timestamp,\x20authorId','qzoneAlbums':'++id,\x20name,\x20createdAt','qzonePhotos':'++id,\x20albumId','favorites':_0x18b51e(0xcc6),'qzoneGroups':_0x18b51e(0x91f),'memories':_0x18b51e(0x809),'callRecords':_0x18b51e(0xb5c),'shoppingProducts':_0x18b51e(0x101c),'shoppingCategories':_0x18b51e(0x91f),'apiPresets':_0x18b51e(0x91f),'renderingRules':_0x18b51e(0xcd5),'appearancePresets':_0x18b51e(0xa5f),'stickerCategories':_0x18b51e(0x91f),'customAvatarFrames':_0x18b51e(0x91f),'presets':'&id,\x20name,\x20categoryId','presetCategories':'++id,\x20name','readingLibrary':_0x18b51e(0xa6d),'npcs':_0x18b51e(0x121a)})[_0x18b51e(0xc3d)](_0x5670c1=>{const _0xe5cb5e=_0x18b51e;return _0x5670c1[_0xe5cb5e(0x7d9)]('worldBooks')['toCollection']()[_0xe5cb5e(0x11d9)](_0x4d75c8=>{const _0x307d50=_0xe5cb5e;if(typeof _0x4d75c8[_0x307d50(0x168)]===_0x307d50(0xf1b)&&_0x4d75c8['content'][_0x307d50(0x8c6)]()!=='')_0x4d75c8[_0x307d50(0x168)]=[{'keys':[],'comment':'从旧版本迁移的条目','content':_0x4d75c8[_0x307d50(0x168)]}];else!Array[_0x307d50(0xb85)](_0x4d75c8['content'])&&(_0x4d75c8[_0x307d50(0x168)]=[]);_0x4d75c8[_0x307d50(0x168)][_0x307d50(0x7c0)](_0x3ea2bf=>{const _0x56c4d2=_0x307d50;typeof _0x3ea2bf['enabled']===_0x56c4d2(0x3df)&&(_0x3ea2bf[_0x56c4d2(0x69a)]=!![]);});});}),window['db']=_0x15043e;function _0x3d1990(_0x3be4fa){const _0x110d13=_0x18b51e;_0x3be4fa==='chat-list-screen'&&(window['renderChatListProxy'](),_0x3d8143(_0x110d13(0x4a1)));if(_0x3be4fa===_0x110d13(0xda4))window[_0x110d13(0xd6e)]();if(_0x3be4fa===_0x110d13(0xdd8))window[_0x110d13(0xcbd)]();if(_0x3be4fa==='world-book-screen')window[_0x110d13(0x639)]();if(_0x3be4fa===_0x110d13(0xcbe))window['renderXSocialScreenProxy']();if(_0x3be4fa===_0x110d13(0xecd))_0x420532();document['querySelectorAll'](_0x110d13(0x7e5))['forEach'](_0x327ae7=>_0x327ae7[_0x110d13(0xb17)][_0x110d13(0xaff)]('active'));const _0x83f8c7=document[_0x110d13(0x8c2)](_0x3be4fa);if(_0x83f8c7)_0x83f8c7[_0x110d13(0xb17)][_0x110d13(0x3f4)](_0x110d13(0x71b));if(_0x3be4fa===_0x110d13(0xd5c))window[_0x110d13(0xc43)](_0x405767[_0x110d13(0x248)]);_0x3be4fa==='font-settings-screen'&&(_0x180194(),document[_0x110d13(0x8c2)](_0x110d13(0x430))[_0x110d13(0x518)]=_0x405767[_0x110d13(0xb73)]['fontUrl']||'',_0x218332(_0x405767['globalSettings'][_0x110d13(0xa3a)]||'',!![]));}window[_0x18b51e(0xc43)]=()=>{};function _0x3d8143(_0x4447c3){const _0x273d93=_0x18b51e,_0x3c5c4f=document[_0x273d93(0x8c2)](_0x273d93(0x3b7)),_0x251229={'messages-view':document[_0x273d93(0x8c2)](_0x273d93(0x4a1)),'qzone-screen':document[_0x273d93(0x8c2)](_0x273d93(0xc35)),'favorites-view':document['getElementById'](_0x273d93(0xd76)),'memories-view':document[_0x273d93(0x8c2)](_0x273d93(0x1184)),'npc-list-view':document[_0x273d93(0x8c2)](_0x273d93(0x2e2))},_0x242933=document[_0x273d93(0x8c2)](_0x273d93(0x260)),_0x34bd46=document[_0x273d93(0x8c2)](_0x273d93(0x201));_0x7e4f8a&&document[_0x273d93(0x8c2)](_0x273d93(0xf14))[_0x273d93(0xa17)]();Object[_0x273d93(0x22f)](_0x251229)[_0x273d93(0x7c0)](_0x30667b=>_0x30667b[_0x273d93(0xb17)][_0x273d93(0xaff)](_0x273d93(0x71b)));_0x251229[_0x4447c3]&&_0x251229[_0x4447c3]['classList'][_0x273d93(0x3f4)]('active');document[_0x273d93(0xa2d)](_0x273d93(0xdac))[_0x273d93(0x7c0)](_0x591b39=>{const _0x8aea8=_0x273d93;_0x591b39[_0x8aea8(0xb17)][_0x8aea8(0xfc3)](_0x8aea8(0x71b),_0x591b39['dataset'][_0x8aea8(0xa8d)]===_0x4447c3);});_0x4447c3==='messages-view'?(_0x242933[_0x273d93(0x842)][_0x273d93(0x5e9)]=_0x273d93(0xd52),_0x34bd46[_0x273d93(0x842)][_0x273d93(0x5e9)]=_0x273d93(0xd52)):(_0x242933[_0x273d93(0x842)][_0x273d93(0x5e9)]=_0x273d93(0xbf8),_0x34bd46['style'][_0x273d93(0x5e9)]='none');_0x4447c3!==_0x273d93(0x1184)&&(_0xde4184[_0x273d93(0x7c0)](_0x282ad7=>clearInterval(_0x282ad7)),_0xde4184=[]);switch(_0x4447c3){case'qzone-screen':_0x251229[_0x273d93(0xc35)][_0x273d93(0x842)][_0x273d93(0x617)]=_0x273d93(0x959),_0x156368(0x0),_0x5168d7(),_0xa34c48();break;case _0x273d93(0xd76):_0x251229[_0x273d93(0xd76)][_0x273d93(0x842)][_0x273d93(0x617)]='#f9f9f9',_0x436ace();break;case _0x273d93(0x4a1):break;case'npc-list-view':_0x28d18c();break;}}function _0x407120(){const _0x4fff37=_0x18b51e;console[_0x4fff37(0x32b)]('渲染X社交页面');}window['renderXSocialScreenProxy']=_0x407120;function _0x5168d7(){const _0x74aba3=_0x18b51e;if(_0x405767&&_0x405767[_0x74aba3(0x20a)]){const _0x36ddfd=_0x405767[_0x74aba3(0x20a)];document[_0x74aba3(0x8c2)](_0x74aba3(0x169))[_0x74aba3(0x1090)]=_0x36ddfd[_0x74aba3(0xab3)],document['getElementById'](_0x74aba3(0xe61))[_0x74aba3(0x939)]=_0x36ddfd[_0x74aba3(0x1e1)],document[_0x74aba3(0x8c2)]('qzone-banner-img')[_0x74aba3(0x939)]=_0x36ddfd[_0x74aba3(0xe90)];}}window[_0x18b51e(0xcaf)]=_0x5168d7;async function _0x5abef7(){const _0x2b0682=_0x18b51e;_0x15043e&&_0x405767[_0x2b0682(0x20a)]&&await _0x15043e['qzoneSettings']['put'](_0x405767[_0x2b0682(0x20a)]);}function _0x491559(_0x443f1b){const _0x2a085f=_0x18b51e;if(!_0x443f1b)return'';const _0x2e97c6=new Date(),_0x1456ad=new Date(_0x443f1b),_0xe4b46f=Math[_0x2a085f(0x10b2)]((_0x2e97c6-_0x1456ad)/0x3e8),_0x68163d=Math[_0x2a085f(0x10b2)](_0xe4b46f/0x3c),_0x52aba7=Math[_0x2a085f(0x10b2)](_0x68163d/0x3c);if(_0x68163d<0x1)return'刚刚';if(_0x68163d<0x3c)return _0x68163d+_0x2a085f(0x605);if(_0x52aba7<0x18)return _0x52aba7+'小时前';const _0x311299=_0x1456ad['getFullYear'](),_0x1e5693=String(_0x1456ad[_0x2a085f(0xc3c)]()+0x1)['padStart'](0x2,'0'),_0x50b4a4=String(_0x1456ad[_0x2a085f(0xca8)]())[_0x2a085f(0xc89)](0x2,'0'),_0x377d9e=String(_0x1456ad[_0x2a085f(0x1ae)]())['padStart'](0x2,'0'),_0x3e3727=String(_0x1456ad[_0x2a085f(0xbdd)]())[_0x2a085f(0xc89)](0x2,'0');return _0x2e97c6[_0x2a085f(0x864)]()===_0x311299?_0x1e5693+'-'+_0x50b4a4+'\x20'+_0x377d9e+':'+_0x3e3727:_0x311299+'-'+_0x1e5693+'-'+_0x50b4a4+'\x20'+_0x377d9e+':'+_0x3e3727;}function _0x3bfb66(_0x28fed9){const _0x5c3003=_0x18b51e,_0x9e2f50=document[_0x5c3003(0x1ad)](_0x5c3003(0x75c)+_0x28fed9['id']+'\x22]'),_0x98bfb6=!!_0x9e2f50,_0x1da7fa=_0x98bfb6?_0x9e2f50:document[_0x5c3003(0x8c1)](_0x5c3003(0x1072));!_0x98bfb6&&(_0x1da7fa[_0x5c3003(0x84c)]='qzone-post-container',_0x1da7fa[_0x5c3003(0x323)][_0x5c3003(0x5f9)]=_0x28fed9['id']);const _0x200639=_0x98bfb6?_0x1da7fa[_0x5c3003(0x1ad)](_0x5c3003(0x69c)):document[_0x5c3003(0x8c1)](_0x5c3003(0x1072));!_0x98bfb6&&(_0x200639['className']=_0x5c3003(0xf09));let _0x462a80='',_0x24ba9d='',_0xf15a42=_0x405767[_0x5c3003(0x20a)][_0x5c3003(0x1e1)];if(_0x28fed9[_0x5c3003(0x802)]===_0x5c3003(0x74b))_0x462a80=_0x405767[_0x5c3003(0x20a)][_0x5c3003(0x1e1)],_0x24ba9d=_0x405767[_0x5c3003(0x20a)][_0x5c3003(0xab3)];else{if(_0x405767[_0x5c3003(0x799)][_0x28fed9['authorId']]){const _0x3497a7=_0x405767['chats'][_0x28fed9['authorId']];_0x462a80=_0x3497a7[_0x5c3003(0x33a)]['aiAvatar']||_0x49d2a4,_0x24ba9d=_0x3497a7[_0x5c3003(0x596)];}else _0x24ba9d=_0x4846a6(_0x28fed9[_0x5c3003(0x10ec)]),_0x462a80=_0x49d2a4;}function _0x4ab2b2(_0x2e1e2d){const _0x39ab2f=_0x5c3003;let _0xfc0d48='';const _0x56f3a7=_0x2e1e2d[_0x39ab2f(0x55d)]?_0x39ab2f(0xea3)+_0x16059c(_0x2e1e2d['publicText'])['replace'](/\n/g,_0x39ab2f(0x854))+_0x39ab2f(0x1079):'';if(_0x2e1e2d[_0x39ab2f(0xde0)]==='shuoshuo')_0xfc0d48=_0x39ab2f(0x85d)+_0x16059c(_0x2e1e2d[_0x39ab2f(0x168)])[_0x39ab2f(0x1b7)](/\n/g,_0x39ab2f(0x854))+'</div>';else{if(_0x2e1e2d[_0x39ab2f(0xde0)]==='image_post'&&_0x2e1e2d['imageUrl'])_0xfc0d48=_0x56f3a7?_0x56f3a7+_0x39ab2f(0x1005)+_0x2e1e2d['imageUrl']+_0x39ab2f(0x115a):'<img\x20src=\x22'+_0x2e1e2d['imageUrl']+_0x39ab2f(0xe8a);else{if(_0x2e1e2d['type']==='text_image'){const _0x2667aa=_0x405767[_0x39ab2f(0xb73)][_0x39ab2f(0xd00)]&&_0x2e1e2d[_0x39ab2f(0xdae)]?_0x39ab2f(0x2c6)+_0x2e1e2d[_0x39ab2f(0xdae)]:_0x39ab2f(0x10c3);_0xfc0d48=_0x56f3a7?_0x56f3a7+_0x39ab2f(0x1005)+_0x2667aa+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x2e1e2d[_0x39ab2f(0x9eb)]+_0x39ab2f(0x11ee):_0x39ab2f(0x333)+_0x2667aa+_0x39ab2f(0x226)+_0x2e1e2d[_0x39ab2f(0x9eb)]+'\x22>';}}}return _0xfc0d48;}let _0x15bb84;if(_0x28fed9['type']===_0x5c3003(0xa8b)){const _0x586adb=_0x28fed9[_0x5c3003(0xb64)]?_0x5c3003(0xea3)+_0x16059c(_0x28fed9[_0x5c3003(0xb64)])['replace'](/\n/g,_0x5c3003(0x854))+_0x5c3003(0x1079):'';let _0x558be8=_0x49d2a4,_0x50eaff=_0x5c3003(0xfbf);if(_0x28fed9[_0x5c3003(0x693)][_0x5c3003(0x802)]==='user')_0x558be8=_0x405767[_0x5c3003(0x20a)]['avatar'],_0x50eaff=_0x405767[_0x5c3003(0x20a)][_0x5c3003(0xab3)];else{const _0x54c2b8=_0x405767[_0x5c3003(0x799)][_0x28fed9[_0x5c3003(0x693)][_0x5c3003(0x802)]];_0x54c2b8&&(_0x558be8=_0x54c2b8['settings'][_0x5c3003(0x44e)]||_0x49d2a4),_0x50eaff=_0x4846a6(_0x28fed9[_0x5c3003(0x693)][_0x5c3003(0x10ec)]);}_0x15bb84=_0x5c3003(0xb35)+_0x586adb+_0x5c3003(0xf7d)+_0x558be8+_0x5c3003(0xac6)+_0x50eaff+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x491559(_0x28fed9[_0x5c3003(0x693)][_0x5c3003(0x351)])+_0x5c3003(0xaf7)+_0x4ab2b2(_0x28fed9[_0x5c3003(0x693)])+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}else _0x15bb84=_0x5c3003(0x113d)+_0x4ab2b2(_0x28fed9)+_0x5c3003(0x1079);let _0x443a38='';if(_0x28fed9[_0x5c3003(0xe2e)]&&_0x28fed9[_0x5c3003(0xe2e)][_0x5c3003(0x105a)]>0x0){const _0x515a6f=_0x28fed9['likes'][_0x5c3003(0x6b9)](_0x44136c=>_0x4846a6(_0x44136c))['join']('、');_0x443a38=_0x5c3003(0x4f6)+_0x515a6f+_0x5c3003(0x742);}let _0x15df14='';_0x28fed9[_0x5c3003(0x93c)]&&_0x28fed9['comments']['length']>0x0&&(_0x15df14=_0x5c3003(0x662),_0x28fed9[_0x5c3003(0x93c)]['forEach']((_0x1cd1ae,_0x137328)=>{const _0x31d82b=_0x5c3003;if(typeof _0x1cd1ae===_0x31d82b(0x7a5)&&_0x1cd1ae!==null&&_0x1cd1ae[_0x31d82b(0x110f)]){const _0x3f6820=_0x1cd1ae[_0x31d82b(0x110f)],_0xdecf9c=_0x4846a6(_0x3f6820);let _0x2f3f8d;_0x3ba794[_0x31d82b(0x696)](_0x1cd1ae[_0x31d82b(0xbc6)])?_0x2f3f8d=_0x31d82b(0x333)+_0x1cd1ae[_0x31d82b(0xbc6)]+_0x31d82b(0x1041):_0x2f3f8d=_0x16059c(_0x1cd1ae['text']);let _0x4fa191='';if(_0x1cd1ae[_0x31d82b(0x176)]){const _0x1022f2=_0x4846a6(_0x1cd1ae[_0x31d82b(0x176)]);_0x4fa191=_0x31d82b(0x60c)+_0xdecf9c+'</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>'+_0x1022f2+'</span>:\x20'+_0x2f3f8d;}else _0x4fa191=_0x31d82b(0x60c)+_0xdecf9c+'</span>:\x20'+_0x2f3f8d;_0x15df14+=_0x31d82b(0xb52)+_0x28fed9['id']+_0x31d82b(0x416)+_0x3f6820+'\x22\x20data-commenter-display-name=\x22'+_0xdecf9c+_0x31d82b(0x5a0)+_0x4fa191+_0x31d82b(0xba5)+_0x137328+_0x31d82b(0x26f);}else _0x15df14+=_0x31d82b(0x1211)+_0x16059c(String(_0x1cd1ae))+_0x31d82b(0x4cc);}),_0x15df14+=_0x5c3003(0x1079));const _0x43aaee=_0x405767[_0x5c3003(0x20a)][_0x5c3003(0xab3)],_0x28f635=_0x28fed9[_0x5c3003(0xe2e)]&&_0x28fed9[_0x5c3003(0xe2e)][_0x5c3003(0x773)](_0x43aaee),_0x4165ae=_0x405767[_0x5c3003(0xcc8)]&&_0x405767[_0x5c3003(0xcc8)]['has'](_0x28fed9['id']);let _0x3603cb='';_0x28fed9[_0x5c3003(0xde0)]!==_0x5c3003(0xa8b)&&(_0x3603cb=_0x5c3003(0x8d2));_0x200639[_0x5c3003(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x462a80+'\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22'+_0x28fed9[_0x5c3003(0x802)]+_0x5c3003(0xcd8)+_0x24ba9d+_0x5c3003(0xfb8)+_0x491559(_0x28fed9['timestamp'])+_0x5c3003(0x1001)+_0x15bb84+_0x5c3003(0x245)+_0x3603cb+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20'+(_0x28f635?_0x5c3003(0x71b):'')+_0x5c3003(0xa35)+(_0x4165ae?_0x5c3003(0x71b):'')+_0x5c3003(0x706)+_0x443a38+_0x5c3003(0x2cf)+_0x15df14+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0xf15a42+'\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';if(!_0x98bfb6){const _0x2b5632=document[_0x5c3003(0x8c1)]('div');_0x2b5632[_0x5c3003(0x84c)]='qzone-post-delete-action',_0x2b5632[_0x5c3003(0xca0)]='<span>删除</span>',_0x1da7fa[_0x5c3003(0x31e)](_0x200639),_0x1da7fa[_0x5c3003(0x31e)](_0x2b5632);}return _0x1da7fa;}async function _0x4762ca(_0x1dff77){const _0x223f65=_0x18b51e,_0x5eeeee=await _0x15043e[_0x223f65(0xcc0)]['get'](_0x1dff77);if(!_0x5eeeee){const _0x10deb3=document[_0x223f65(0x1ad)](_0x223f65(0x75c)+_0x1dff77+'\x22]');if(_0x10deb3)_0x10deb3[_0x223f65(0xaff)]();return;}const _0x5427d9=_0x3c4d9a[_0x223f65(0x1149)](_0x277616=>_0x277616['id']===_0x1dff77);if(_0x5427d9>-0x1)_0x3c4d9a[_0x5427d9]=_0x5eeeee;const _0x34064c=await _0x15043e['favorites'][_0x223f65(0xdb8)](_0x223f65(0xde0))[_0x223f65(0xc9a)](_0x223f65(0x80e))[_0x223f65(0x6be)]();_0x405767[_0x223f65(0xcc8)]=new Set(_0x34064c[_0x223f65(0x6b9)](_0xabece7=>_0xabece7[_0x223f65(0x168)]['id'])),_0x3bfb66(_0x5eeeee);}function _0x4f34be(_0x2344e1){const _0x53aba4=_0x18b51e,_0x11fb34=Date[_0x53aba4(0x1ed)](),_0x2da52f=Math[_0x53aba4(0x10b2)]((_0x11fb34-_0x2344e1)/0x3e8),_0x1f6ce=Math[_0x53aba4(0x10b2)](_0x2da52f/0x3c);if(_0x1f6ce<0x2)return'刚刚';if(_0x1f6ce<0x3c)return _0x1f6ce+'分钟前';const _0x58a029=Math[_0x53aba4(0x10b2)](_0x1f6ce/0x3c);if(_0x58a029<0x18)return _0x58a029+_0x53aba4(0x80d);const _0x27a8ff=Math[_0x53aba4(0x10b2)](_0x58a029/0x18);return _0x27a8ff+'天前';}async function _0x3bfb66(_0x5df4b4){const _0x552324=_0x18b51e,_0x19b50d=document[_0x552324(0x1ad)](_0x552324(0x75c)+_0x5df4b4['id']+'\x22]'),_0x2ad8b5=!!_0x19b50d,_0x4c3fef=_0x2ad8b5?_0x19b50d:document['createElement']('div');!_0x2ad8b5&&(_0x4c3fef[_0x552324(0x84c)]=_0x552324(0xaa9),_0x4c3fef[_0x552324(0x323)][_0x552324(0x5f9)]=_0x5df4b4['id']);const _0x41d3ee=_0x2ad8b5?_0x4c3fef[_0x552324(0x1ad)](_0x552324(0x69c)):document['createElement'](_0x552324(0x1072));!_0x2ad8b5&&(_0x41d3ee[_0x552324(0x84c)]='qzone-post-item');let _0x287387='',_0x22f561='',_0x50e90f=_0x405767[_0x552324(0x20a)][_0x552324(0x1e1)];if(_0x5df4b4[_0x552324(0x802)]==='user')_0x287387=_0x405767[_0x552324(0x20a)][_0x552324(0x1e1)],_0x22f561=_0x405767[_0x552324(0x20a)][_0x552324(0xab3)];else{if(_0x405767[_0x552324(0x799)][_0x5df4b4[_0x552324(0x802)]]){const _0x4cb00b=_0x405767[_0x552324(0x799)][_0x5df4b4['authorId']];_0x287387=_0x4cb00b[_0x552324(0x33a)][_0x552324(0x44e)]||_0x49d2a4,_0x22f561=_0x4cb00b[_0x552324(0x596)];}else{if(String(_0x5df4b4[_0x552324(0x802)])[_0x552324(0xc7c)](_0x552324(0x5ea))){const _0x28c70e=parseInt(String(_0x5df4b4[_0x552324(0x802)])['replace'](_0x552324(0x5ea),''));if(!isNaN(_0x28c70e)){const _0x437ace=await _0x15043e[_0x552324(0xa4a)][_0x552324(0x3e9)](_0x28c70e);_0x437ace?(_0x287387=_0x437ace[_0x552324(0x1e1)]||_0x9fdc61,_0x22f561=_0x437ace[_0x552324(0x596)]):(_0x22f561=_0x5df4b4[_0x552324(0x10ec)]||_0x552324(0x4e6),_0x287387=_0x9fdc61);}}else _0x22f561=_0x4846a6(_0x5df4b4[_0x552324(0x10ec)]),_0x287387=_0x49d2a4;}}function _0x331d92(_0x31c060){const _0x516115=_0x552324;let _0x2bff09='';const _0x41ea17=_0x31c060[_0x516115(0x55d)]?_0x516115(0xea3)+_0x16059c(_0x31c060[_0x516115(0x55d)])[_0x516115(0x1b7)](/\n/g,_0x516115(0x854))+_0x516115(0x1079):'';if(_0x31c060[_0x516115(0xde0)]===_0x516115(0x11ce))_0x2bff09='<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>'+_0x16059c(_0x31c060[_0x516115(0x168)])[_0x516115(0x1b7)](/\n/g,_0x516115(0x854))+_0x516115(0x1079);else{if(_0x31c060[_0x516115(0xde0)]==='image_post'&&_0x31c060[_0x516115(0x10d4)])_0x2bff09=_0x41ea17?_0x41ea17+_0x516115(0x1005)+_0x31c060[_0x516115(0x10d4)]+_0x516115(0x115a):_0x516115(0x333)+_0x31c060[_0x516115(0x10d4)]+_0x516115(0xe8a);else{if(_0x31c060[_0x516115(0xde0)]==='text_image'){const _0x2fa7b3=_0x405767[_0x516115(0xb73)]['enableAiDrawing']&&_0x31c060[_0x516115(0xdae)]?_0x516115(0x2c6)+_0x31c060[_0x516115(0xdae)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x2bff09=_0x41ea17?_0x41ea17+_0x516115(0x1005)+_0x2fa7b3+_0x516115(0x226)+_0x31c060['hiddenContent']+'\x22></div>':_0x516115(0x333)+_0x2fa7b3+_0x516115(0x226)+_0x31c060['hiddenContent']+'\x22>';}}}return _0x2bff09;}let _0x4c83f1;if(_0x5df4b4['type']===_0x552324(0xa8b)){const _0x2f264a=_0x5df4b4[_0x552324(0xb64)]?'<div\x20class=\x22post-content\x22>'+_0x5df4b4[_0x552324(0xb64)][_0x552324(0x1b7)](/\n/g,'<br>')+_0x552324(0x1079):'';let _0x5231be=_0x49d2a4,_0x119286=_0x552324(0xfbf);if(_0x5df4b4['originalPost']['authorId']==='user')_0x5231be=_0x405767[_0x552324(0x20a)][_0x552324(0x1e1)],_0x119286=_0x405767['qzoneSettings'][_0x552324(0xab3)];else{const _0x32b35e=_0x405767[_0x552324(0x799)][_0x5df4b4[_0x552324(0x693)][_0x552324(0x802)]];_0x32b35e&&(_0x5231be=_0x32b35e[_0x552324(0x33a)][_0x552324(0x44e)]||_0x49d2a4),_0x119286=_0x4846a6(_0x5df4b4[_0x552324(0x693)][_0x552324(0x10ec)]);}_0x4c83f1=_0x552324(0xb35)+_0x2f264a+_0x552324(0xf7d)+_0x5231be+_0x552324(0xac6)+_0x119286+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x491559(_0x5df4b4[_0x552324(0x693)][_0x552324(0x351)])+_0x552324(0xaf7)+_0x331d92(_0x5df4b4[_0x552324(0x693)])+_0x552324(0x6b2);}else _0x4c83f1=_0x552324(0x113d)+_0x331d92(_0x5df4b4)+_0x552324(0x1079);let _0x4fbd5d='';if(_0x5df4b4[_0x552324(0xe2e)]&&_0x5df4b4[_0x552324(0xe2e)][_0x552324(0x105a)]>0x0){const _0x4ae6b6=_0x5df4b4[_0x552324(0xe2e)][_0x552324(0x6b9)](_0x285414=>_0x4846a6(_0x285414))['join']('、');_0x4fbd5d=_0x552324(0x4f6)+_0x4ae6b6+_0x552324(0x742);}let _0xae6d11='';_0x5df4b4[_0x552324(0x93c)]&&_0x5df4b4[_0x552324(0x93c)][_0x552324(0x105a)]>0x0&&(_0xae6d11='<div\x20class=\x22post-comments-container\x22>',_0x5df4b4[_0x552324(0x93c)][_0x552324(0x7c0)]((_0x344f1a,_0x3c1502)=>{const _0xfdc514=_0x552324;if(typeof _0x344f1a===_0xfdc514(0x7a5)&&_0x344f1a!==null&&_0x344f1a[_0xfdc514(0x110f)]){const _0x2f4eb7=_0x344f1a[_0xfdc514(0x110f)],_0xb62484=_0x4846a6(_0x2f4eb7);let _0x372f0e;_0x3ba794[_0xfdc514(0x696)](_0x344f1a[_0xfdc514(0xbc6)])?_0x372f0e=_0xfdc514(0x333)+_0x344f1a[_0xfdc514(0xbc6)]+'\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>':_0x372f0e=_0x16059c(_0x344f1a[_0xfdc514(0xbc6)]);let _0x4dc7c6='';if(_0x344f1a[_0xfdc514(0x176)]){const _0x59467c=_0x4846a6(_0x344f1a['replyTo']);_0x4dc7c6=_0xfdc514(0x60c)+_0xb62484+_0xfdc514(0x501)+_0x59467c+_0xfdc514(0x41a)+_0x372f0e;}else _0x4dc7c6=_0xfdc514(0x60c)+_0xb62484+_0xfdc514(0x41a)+_0x372f0e;_0xae6d11+='<div\x20class=\x22comment-item\x22\x20data-post-id=\x22'+_0x5df4b4['id']+'\x22\x20data-commenter-original-name=\x22'+_0x2f4eb7+'\x22\x20data-commenter-display-name=\x22'+_0xb62484+_0xfdc514(0x5a0)+_0x4dc7c6+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22'+_0x3c1502+_0xfdc514(0x26f);}else _0xae6d11+='<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>'+String(_0x344f1a)+_0xfdc514(0x4cc);}),_0xae6d11+=_0x552324(0x1079));const _0x3a1ff3=_0x405767[_0x552324(0x20a)][_0x552324(0xab3)],_0x35c059=_0x5df4b4[_0x552324(0xe2e)]&&_0x5df4b4[_0x552324(0xe2e)][_0x552324(0x773)](_0x3a1ff3),_0x21e2ff=_0x405767[_0x552324(0xcc8)]&&_0x405767[_0x552324(0xcc8)][_0x552324(0x11ac)](_0x5df4b4['id']);let _0x511861='';_0x5df4b4['type']!==_0x552324(0xa8b)&&(_0x511861=_0x552324(0x8d2));_0x41d3ee[_0x552324(0xca0)]=_0x552324(0xc68)+_0x287387+_0x552324(0xae6)+_0x5df4b4[_0x552324(0x802)]+_0x552324(0xcd8)+_0x22f561+_0x552324(0xfb8)+_0x491559(_0x5df4b4['timestamp'])+_0x552324(0x1001)+_0x4c83f1+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x511861+_0x552324(0x7f9)+(_0x35c059?'active':'')+_0x552324(0xa35)+(_0x21e2ff?_0x552324(0x71b):'')+_0x552324(0x706)+_0x4fbd5d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xae6d11+_0x552324(0x95a)+_0x50e90f+_0x552324(0x30b);if(!_0x2ad8b5){const _0x4f7a65=document[_0x552324(0x8c1)]('div');_0x4f7a65['className']=_0x552324(0x7a4),_0x4f7a65['innerHTML']=_0x552324(0xfc7),_0x4c3fef[_0x552324(0x31e)](_0x41d3ee),_0x4c3fef['appendChild'](_0x4f7a65);}return _0x4c3fef;}async function _0x4762ca(_0x26e02d){const _0x22a320=_0x18b51e,_0x47bc3b=await _0x15043e[_0x22a320(0xcc0)]['get'](_0x26e02d);if(!_0x47bc3b){const _0x1e632e=document[_0x22a320(0x1ad)]('.qzone-post-container[data-post-id=\x22'+_0x26e02d+'\x22]');_0x1e632e&&_0x1e632e[_0x22a320(0xaff)]();return;}const _0x362d3c=_0x3c4d9a[_0x22a320(0x1149)](_0x24e61d=>_0x24e61d['id']===_0x26e02d);_0x362d3c>-0x1&&(_0x3c4d9a[_0x362d3c]=_0x47bc3b);const _0x181eeb=await _0x15043e['favorites'][_0x22a320(0xdb8)](_0x22a320(0xde0))[_0x22a320(0xc9a)](_0x22a320(0x80e))['toArray']();_0x405767[_0x22a320(0xcc8)]=new Set(_0x181eeb[_0x22a320(0x6b9)](_0xbbebe1=>_0xbbebe1[_0x22a320(0x168)]['id'])),await _0x3bfb66(_0x47bc3b);}async function _0xa34c48(){const _0x316ea2=_0x18b51e,_0x2862da=document[_0x316ea2(0x8c2)](_0x316ea2(0x763));if(!_0x2862da)return;const [_0x2a34aa,_0x42480e]=await Promise[_0x316ea2(0xe88)]([_0x15043e[_0x316ea2(0xcc0)]['orderBy'](_0x316ea2(0x351))[_0x316ea2(0x1c0)]()[_0x316ea2(0x1d8)](_0x28d66a=>!_0x28d66a[_0x316ea2(0x174)])['toArray'](),_0x15043e[_0x316ea2(0xe93)][_0x316ea2(0xdb8)](_0x316ea2(0xde0))[_0x316ea2(0xc9a)]('qzone_post')[_0x316ea2(0x6be)]()]);_0x3c4d9a=_0x2a34aa,_0x405767[_0x316ea2(0xcc8)]=new Set(_0x42480e[_0x316ea2(0x6b9)](_0x570ac5=>_0x570ac5[_0x316ea2(0x168)]['id'])),_0x2862da[_0x316ea2(0xca0)]='',_0x37c049=0x0;if(_0x3c4d9a[_0x316ea2(0x105a)]===0x0){_0x2862da['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>';return;}_0x411133();}async function _0x411133(){const _0x17e374=_0x18b51e;if(_0x5a2592)return;_0x5a2592=!![];const _0x32453b=document[_0x17e374(0x8c2)](_0x17e374(0x763));if(!_0x32453b){_0x5a2592=![];return;}_0x21c28a(_0x32453b,_0x17e374(0xf2b)),setTimeout(async()=>{const _0x4479ff=_0x17e374;_0x45f5dc(_0x32453b);const _0x25ae49=_0x37c049,_0x54b68b=_0x37c049+_0x4bd2cf,_0x507f33=_0x3c4d9a[_0x4479ff(0x961)](_0x25ae49,_0x54b68b),_0x40a9eb=document[_0x4479ff(0xc8e)]();for(const _0x911f40 of _0x507f33){const _0x4de6cc=await _0x3bfb66(_0x911f40);_0x40a9eb['appendChild'](_0x4de6cc);}_0x32453b[_0x4479ff(0x31e)](_0x40a9eb),_0x37c049+=_0x507f33[_0x4479ff(0x105a)],_0x5a2592=![];},0x1f4);}function _0x37b873(_0x3e3c17,_0x1d335b){const _0x1f275f=_0x18b51e,_0x1935ef=_0x1b5b07['panelEl'],_0x4cde09=_0x1b5b07[_0x1f275f(0x524)];_0x4cde09[_0x1f275f(0xca0)]='';_0x405767[_0x1f275f(0xc36)][_0x1f275f(0x105a)]===0x0?_0x4cde09[_0x1f275f(0xca0)]=_0x1f275f(0x600):_0x405767[_0x1f275f(0xc36)][_0x1f275f(0x7c0)](_0x5499b4=>{const _0x2e3585=_0x1f275f,_0x2ddbab=document[_0x2e3585(0x8c1)]('div');_0x2ddbab[_0x2e3585(0x84c)]='sticker-item',_0x2ddbab[_0x2e3585(0x842)][_0x2e3585(0xfff)]='url('+_0x5499b4[_0x2e3585(0x9d6)]+')',_0x2ddbab[_0x2e3585(0xcea)]=_0x5499b4[_0x2e3585(0x596)],_0x4cde09[_0x2e3585(0x31e)](_0x2ddbab);});const _0x3b4e6a=_0x1d335b['getBoundingClientRect'](),_0x38c1f4=document['getElementById'](_0x1f275f(0x5e7))[_0x1f275f(0xfe9)]();_0x1935ef[_0x1f275f(0x842)]['display']='flex';const _0x1dbae0=_0x1935ef[_0x1f275f(0xfe9)](),_0x118f17=_0x1dbae0[_0x1f275f(0xba8)],_0x3f22ba=_0x1dbae0[_0x1f275f(0x578)];_0x1935ef['style'][_0x1f275f(0x9a4)]=_0x3b4e6a[_0x1f275f(0x9a4)]-_0x118f17-0x5-_0x38c1f4[_0x1f275f(0x9a4)]+'px';const _0x3c6d1a=_0x3b4e6a[_0x1f275f(0xe3a)]-_0x38c1f4[_0x1f275f(0xe3a)];_0x3c6d1a+_0x3f22ba>_0x38c1f4[_0x1f275f(0x578)]?(_0x1935ef['style']['left']=_0x1f275f(0x541),_0x1935ef[_0x1f275f(0x842)][_0x1f275f(0x36e)]=_0x1f275f(0x10db)):(_0x1935ef['style'][_0x1f275f(0xe3a)]=_0x3c6d1a+'px',_0x1935ef[_0x1f275f(0x842)][_0x1f275f(0x36e)]='auto'),_0x1b5b07[_0x1f275f(0x356)]=!![],_0x1b5b07[_0x1f275f(0x370)]=_0x3e3c17;}function _0xef4146(){const _0x5c7614=_0x18b51e;_0x1b5b07[_0x5c7614(0x356)]&&(_0x1b5b07[_0x5c7614(0xbbe)]['style'][_0x5c7614(0x5e9)]=_0x5c7614(0xbf8),_0x1b5b07[_0x5c7614(0x356)]=![],_0x1b5b07['activePostId']=null);}async function _0x9f73b8(_0x540f83,_0x519d88){const _0x3ceb45=_0x18b51e;if(!_0x519d88||!_0x519d88['url'])return;const _0x428567=await _0x15043e['qzonePosts']['get'](_0x540f83);if(!_0x428567){console[_0x3ceb45(0x7a3)](_0x3ceb45(0x505),_0x540f83);return;}!_0x428567[_0x3ceb45(0x93c)]&&(_0x428567[_0x3ceb45(0x93c)]=[]);const _0x4d680b={'commenterName':_0x405767[_0x3ceb45(0x20a)][_0x3ceb45(0xab3)],'text':_0x519d88[_0x3ceb45(0x9d6)],'meaning':_0x519d88[_0x3ceb45(0x596)],'timestamp':Date[_0x3ceb45(0x1ed)]()};_0x428567[_0x3ceb45(0x93c)][_0x3ceb45(0xa49)](_0x4d680b),await _0x15043e[_0x3ceb45(0xcc0)]['update'](_0x540f83,{'comments':_0x428567[_0x3ceb45(0x93c)]}),_0xef4146(),await _0xa34c48();const _0x307972=(_0x428567[_0x3ceb45(0x55d)]||_0x428567[_0x3ceb45(0x168)]||_0x3ceb45(0x7be))[_0x3ceb45(0x599)](0x0,0x1e);for(const _0x2156b8 in _0x405767['chats']){const _0x29134c=_0x405767[_0x3ceb45(0x799)][_0x2156b8];if(!_0x29134c['isGroup']){const _0x3249bf=_0x3ceb45(0x98b)+_0x405767[_0x3ceb45(0x20a)][_0x3ceb45(0xab3)]+_0x3ceb45(0x26e)+_0x540f83+_0x3ceb45(0x11c4)+_0x307972+_0x3ceb45(0x330)+_0x519d88[_0x3ceb45(0x596)]+_0x3ceb45(0x431),_0x5a32bc={'role':_0x3ceb45(0x46c),'content':_0x3249bf,'timestamp':Date[_0x3ceb45(0x1ed)](),'isHidden':!![]};_0x29134c[_0x3ceb45(0xd39)]['push'](_0x5a32bc),await _0x15043e[_0x3ceb45(0x799)][_0x3ceb45(0xfaa)](_0x29134c);}}}function _0x17b877(_0x51ddf0){const _0x55932c=_0x18b51e;_0x134b0f=_0x51ddf0,document[_0x55932c(0x8c2)](_0x55932c(0x5b8))[_0x55932c(0x518)]='',document[_0x55932c(0x8c2)](_0x55932c(0x442))[_0x55932c(0xb17)]['add'](_0x55932c(0x2cd));}function _0x9e1400(){const _0xc9da91=_0x18b51e;document[_0xc9da91(0x8c2)]('repost-modal')[_0xc9da91(0xb17)][_0xc9da91(0xaff)](_0xc9da91(0x2cd)),_0x134b0f=null;}async function _0x1f8884(){const _0x4c25c8=_0x18b51e;if(!_0x134b0f)return;const _0x12d315=document[_0x4c25c8(0x8c2)](_0x4c25c8(0x5b8))['value'][_0x4c25c8(0x8c6)](),_0x24adca=await _0x15043e[_0x4c25c8(0xcc0)]['get'](_0x134b0f);if(!_0x24adca){alert(_0x4c25c8(0x98a)),_0x9e1400();return;}const _0x46ff0c={'type':_0x4c25c8(0xa8b),'timestamp':Date['now'](),'authorId':_0x4c25c8(0x74b),'repostComment':_0x12d315,'originalPost':_0x24adca,'visibleGroupIds':null};await _0x15043e['qzonePosts'][_0x4c25c8(0x3f4)](_0x46ff0c),_0x9e1400(),await _0xa34c48(),alert(_0x4c25c8(0x1176));}function _0x4141a3(_0x5f1c3b){const _0x3cd5d7=_0x18b51e,_0x6b42b8=document['getElementById'](_0x3cd5d7(0x1103));_0x6b42b8[_0x3cd5d7(0xca0)]='';if(_0x5f1c3b[_0x3cd5d7(0x105a)]===0x0){const _0x43d2a2=document[_0x3cd5d7(0x8c2)](_0x3cd5d7(0xf57))[_0x3cd5d7(0x518)],_0x4be3f6=_0x43d2a2?_0x3cd5d7(0xd65):_0x3cd5d7(0x665);_0x6b42b8[_0x3cd5d7(0xca0)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>'+_0x4be3f6+_0x3cd5d7(0x2e7);return;}for(const _0x5ac92c of _0x5f1c3b){const _0x130738=document['createElement'](_0x3cd5d7(0x1072));_0x130738['className']=_0x3cd5d7(0x822),_0x130738[_0x3cd5d7(0x323)][_0x3cd5d7(0x100e)]=_0x5ac92c['id'];let _0x414ec6='',_0x5dc348='',_0x2ba442='',_0x537425='';if(_0x5ac92c['type']===_0x3cd5d7(0x80e)){const _0x2e5e36=_0x5ac92c[_0x3cd5d7(0x168)];_0x2ba442=_0x3cd5d7(0xe19);let _0x4f402b=_0x49d2a4,_0x44ff0c='未知用户';if(_0x2e5e36[_0x3cd5d7(0x802)]===_0x3cd5d7(0x74b))_0x4f402b=_0x405767[_0x3cd5d7(0x20a)][_0x3cd5d7(0x1e1)],_0x44ff0c=_0x405767[_0x3cd5d7(0x20a)][_0x3cd5d7(0xab3)];else _0x405767[_0x3cd5d7(0x799)][_0x2e5e36[_0x3cd5d7(0x802)]]&&(_0x4f402b=_0x405767[_0x3cd5d7(0x799)][_0x2e5e36[_0x3cd5d7(0x802)]][_0x3cd5d7(0x33a)]['aiAvatar'],_0x44ff0c=_0x405767[_0x3cd5d7(0x799)][_0x2e5e36[_0x3cd5d7(0x802)]]['name']);_0x414ec6='<img\x20src=\x22'+_0x4f402b+_0x3cd5d7(0x281)+_0x44ff0c+_0x3cd5d7(0xe35);const _0x40cde9=_0x2e5e36[_0x3cd5d7(0x55d)]?_0x3cd5d7(0xea3)+_0x2e5e36[_0x3cd5d7(0x55d)]['replace'](/\n/g,'<br>')+_0x3cd5d7(0x1079):'';if(_0x2e5e36[_0x3cd5d7(0xde0)]===_0x3cd5d7(0x11ce))_0x5dc348=_0x3cd5d7(0xea3)+_0x2e5e36[_0x3cd5d7(0x168)]['replace'](/\n/g,_0x3cd5d7(0x854))+_0x3cd5d7(0x1079);else{if(_0x2e5e36[_0x3cd5d7(0xde0)]===_0x3cd5d7(0x7b5)&&_0x2e5e36[_0x3cd5d7(0x10d4)]){const _0x5a6d82=_0x405767[_0x3cd5d7(0xb73)][_0x3cd5d7(0xd00)]&&_0x2e5e36['image_prompt']?_0x3cd5d7(0x2c6)+_0x2e5e36[_0x3cd5d7(0xdae)]:_0x3cd5d7(0x10c3);_0x5dc348=_0x40cde9?_0x40cde9+_0x3cd5d7(0x1005)+_0x5a6d82+_0x3cd5d7(0x115a):_0x3cd5d7(0x333)+_0x5a6d82+_0x3cd5d7(0xe8a);}else{if(_0x2e5e36[_0x3cd5d7(0xde0)]==='text_image'){const _0x17ad4f=_0x405767[_0x3cd5d7(0xb73)][_0x3cd5d7(0xd00)]&&_0x2e5e36[_0x3cd5d7(0xdae)]?_0x3cd5d7(0x2c6)+_0x2e5e36[_0x3cd5d7(0xdae)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x5dc348=_0x40cde9?_0x40cde9+_0x3cd5d7(0x1005)+_0x17ad4f+_0x3cd5d7(0x226)+_0x2e5e36[_0x3cd5d7(0x9eb)]+_0x3cd5d7(0x11ee):_0x3cd5d7(0x333)+_0x17ad4f+_0x3cd5d7(0x226)+_0x2e5e36[_0x3cd5d7(0x9eb)]+'\x22>';}}}let _0x2b147d='';_0x2e5e36[_0x3cd5d7(0xe2e)]&&_0x2e5e36['likes'][_0x3cd5d7(0x105a)]>0x0&&(_0x2b147d='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+_0x2e5e36[_0x3cd5d7(0xe2e)][_0x3cd5d7(0xb2c)]('、')+_0x3cd5d7(0xc16));let _0x538eb1='';_0x2e5e36[_0x3cd5d7(0x93c)]&&_0x2e5e36['comments']['length']>0x0&&(_0x538eb1='<div\x20class=\x22post-comments-container\x22>',_0x2e5e36['comments'][_0x3cd5d7(0x7c0)]((_0xfc2405,_0x131dc8)=>{const _0x210c18=_0x3cd5d7;if(typeof _0xfc2405==='object'&&_0xfc2405!==null&&_0xfc2405[_0x210c18(0x110f)]){const _0x2a7204=_0xfc2405[_0x210c18(0x110f)],_0x78505a=_0x4846a6(_0x2a7204);let _0x4de7c9;_0x3ba794[_0x210c18(0x696)](_0xfc2405[_0x210c18(0xbc6)])?_0x4de7c9='<img\x20src=\x22'+_0xfc2405[_0x210c18(0xbc6)]+'\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>':_0x4de7c9=_0xfc2405[_0x210c18(0xbc6)];let _0x30563a='';if(_0xfc2405[_0x210c18(0x176)]){const _0x1b5201=_0x4846a6(_0xfc2405[_0x210c18(0x176)]);_0x30563a=_0x210c18(0x60c)+_0x78505a+_0x210c18(0x501)+_0x1b5201+_0x210c18(0x41a)+_0x4de7c9;}else _0x30563a=_0x210c18(0x60c)+_0x78505a+_0x210c18(0x41a)+_0x4de7c9;_0x538eb1+=_0x210c18(0xb52)+_0x2e5e36['id']+_0x210c18(0x416)+_0x2a7204+_0x210c18(0x74c)+_0x78505a+_0x210c18(0x28f)+_0x30563a+_0x210c18(0xf91)+_0x131dc8+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}else _0x538eb1+='<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>'+String(_0xfc2405)+_0x210c18(0x121c);}),_0x538eb1+=_0x3cd5d7(0x1079)),_0x537425=''+_0x2b147d+_0x538eb1;}else{if(_0x5ac92c['type']===_0x3cd5d7(0xb05)){const _0x52e8f5=_0x5ac92c[_0x3cd5d7(0x168)],_0x3ceb0f=_0x405767[_0x3cd5d7(0x799)][_0x5ac92c[_0x3cd5d7(0xb3d)]];if(!_0x3ceb0f)continue;_0x2ba442=_0x3cd5d7(0xb03)+_0x3ceb0f[_0x3cd5d7(0x596)]+'\x20的聊天';const _0x89d18=_0x52e8f5[_0x3cd5d7(0x14a)]===_0x3cd5d7(0x74b);let _0x295662,_0x45e73c;if(_0x89d18)_0x295662=_0x3ceb0f[_0x3cd5d7(0x1000)]?_0x3ceb0f['settings'][_0x3cd5d7(0xe16)]||'我':'我',_0x45e73c=_0x3ceb0f[_0x3cd5d7(0x33a)][_0x3cd5d7(0x11ed)]||(_0x3ceb0f['isGroup']?_0x38e728:_0x49d2a4);else{if(_0x3ceb0f[_0x3cd5d7(0x1000)]){const _0x521a18=_0x3ceb0f[_0x3cd5d7(0x635)][_0x3cd5d7(0x2ef)](_0x60271c=>_0x60271c[_0x3cd5d7(0x4e7)]===_0x52e8f5[_0x3cd5d7(0x770)]);_0x295662=_0x52e8f5[_0x3cd5d7(0x770)],_0x45e73c=_0x521a18?_0x521a18[_0x3cd5d7(0x1e1)]:_0x9fdc61;}else _0x295662=_0x3ceb0f[_0x3cd5d7(0x596)],_0x45e73c=_0x3ceb0f[_0x3cd5d7(0x33a)][_0x3cd5d7(0x44e)]||_0x49d2a4;}_0x414ec6=_0x3cd5d7(0x333)+_0x45e73c+_0x3cd5d7(0x281)+_0x295662+_0x3cd5d7(0xe35);if(typeof _0x52e8f5['content']===_0x3cd5d7(0xf1b)&&_0x3ba794[_0x3cd5d7(0x696)](_0x52e8f5['content']))_0x5dc348=_0x3cd5d7(0x333)+_0x52e8f5[_0x3cd5d7(0x168)]+_0x3cd5d7(0xb97);else Array[_0x3cd5d7(0xb85)](_0x52e8f5[_0x3cd5d7(0x168)])&&_0x52e8f5[_0x3cd5d7(0x168)][0x0]?.[_0x3cd5d7(0xde0)]==='image_url'?_0x5dc348=_0x3cd5d7(0x333)+_0x52e8f5[_0x3cd5d7(0x168)][0x0][_0x3cd5d7(0x7a9)][_0x3cd5d7(0x9d6)]+_0x3cd5d7(0xe8a):_0x5dc348=String(_0x52e8f5[_0x3cd5d7(0x168)]||'')['replace'](/\n/g,_0x3cd5d7(0x854));}else{if(_0x5ac92c[_0x3cd5d7(0xde0)]===_0x3cd5d7(0x872)){const _0xcd6ec1=_0x5ac92c[_0x3cd5d7(0x168)];_0x2ba442='来自\x20'+_0xcd6ec1[_0x3cd5d7(0x53d)]+_0x3cd5d7(0x29c);const _0x47b5d9=_0x405767['chats'][_0xcd6ec1['characterId']],_0x3280f8=_0x47b5d9?_0x47b5d9['settings'][_0x3cd5d7(0x44e)]:_0x49d2a4;_0x414ec6=_0x3cd5d7(0x333)+_0x3280f8+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0xcd6ec1[_0x3cd5d7(0x53d)]+_0x3cd5d7(0xe35);const _0x251968=_0xcd6ec1['content']||'',_0x2d61f0=_0x16059c(_0x251968)[_0x3cd5d7(0x1b7)](/\n/g,'<br>');_0x5dc348='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>'+_0xcd6ec1[_0x3cd5d7(0xcea)]+_0x3cd5d7(0x893)+_0x2d61f0+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}else{if(_0x5ac92c[_0x3cd5d7(0xde0)]===_0x3cd5d7(0x6cc)){const _0x151456=_0x5ac92c[_0x3cd5d7(0x168)];_0x2ba442=_0x3cd5d7(0x422)+_0x151456['characterName']+_0x3cd5d7(0x85b);const _0x202556=_0x405767['chats'][_0x151456[_0x3cd5d7(0xf17)]],_0x5e6755=_0x202556?_0x202556[_0x3cd5d7(0x33a)][_0x3cd5d7(0x44e)]:_0x49d2a4;_0x414ec6=_0x3cd5d7(0x333)+_0x5e6755+_0x3cd5d7(0x281)+_0x151456[_0x3cd5d7(0x53d)]+_0x3cd5d7(0xe35),_0x5dc348=_0x3cd5d7(0x308)+_0x151456['title']+_0x3cd5d7(0x13d)+(_0x151456[_0x3cd5d7(0x168)]||'')['replace'](/\n/g,'<br>')+_0x3cd5d7(0xe47);}else{if(_0x5ac92c[_0x3cd5d7(0xde0)]===_0x3cd5d7(0xd7a)){const _0xa3d716=_0x5ac92c[_0x3cd5d7(0x168)];_0x2ba442=_0x3cd5d7(0x422)+_0xa3d716[_0x3cd5d7(0x53d)]+'\x20的备忘录';const _0x54c011=_0x405767['chats'][_0xa3d716['characterId']],_0x4424bb=_0x54c011?_0x54c011[_0x3cd5d7(0x33a)][_0x3cd5d7(0x44e)]:_0x49d2a4;_0x414ec6=_0x3cd5d7(0x333)+_0x4424bb+_0x3cd5d7(0x281)+_0xa3d716[_0x3cd5d7(0x53d)]+'</div></div>',_0x5dc348='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>'+_0xa3d716[_0x3cd5d7(0xcea)]+_0x3cd5d7(0x4e0)+_0xa3d716[_0x3cd5d7(0x168)][_0x3cd5d7(0x1b7)](/\n/g,_0x3cd5d7(0x854))+_0x3cd5d7(0x30a);}}}}}_0x130738[_0x3cd5d7(0xca0)]=_0x3cd5d7(0x9cc)+_0x414ec6+_0x3cd5d7(0xb51)+_0x2ba442+_0x3cd5d7(0x90f)+_0x5dc348+_0x3cd5d7(0x6c7)+_0x537425,_0x6b42b8[_0x3cd5d7(0x31e)](_0x130738);}}async function _0x436ace(){const _0xf7bba8=_0x18b51e;allFavoriteItems=await _0x15043e['favorites'][_0xf7bba8(0x731)]('timestamp')[_0xf7bba8(0x1c0)]()[_0xf7bba8(0x6be)]();const _0x56f519=document['getElementById'](_0xf7bba8(0xf57)),_0x45ddeb=document[_0xf7bba8(0x8c2)](_0xf7bba8(0x72d));_0x56f519['value']='',_0x45ddeb[_0xf7bba8(0x842)]['display']=_0xf7bba8(0xbf8),_0x4141a3(allFavoriteItems);}function _0x3f56a7(){const _0x20a48c=_0x18b51e;document[_0x20a48c(0x8c2)](_0x20a48c(0x4b4))['value']='',document[_0x20a48c(0x8c2)]('post-image-preview')[_0x20a48c(0x939)]='',document[_0x20a48c(0x8c2)](_0x20a48c(0xe46))[_0x20a48c(0x518)]='',document['getElementById'](_0x20a48c(0xd5f))[_0x20a48c(0xb17)][_0x20a48c(0xaff)](_0x20a48c(0x2cd)),document[_0x20a48c(0x8c2)](_0x20a48c(0x5dc))[_0x20a48c(0x842)][_0x20a48c(0x5e9)]=_0x20a48c(0xbf8),document['getElementById']('post-local-image-input')[_0x20a48c(0x518)]='',document[_0x20a48c(0x8c2)](_0x20a48c(0x10a1))['value']='',document[_0x20a48c(0x8c2)](_0x20a48c(0x454))[_0x20a48c(0xa17)]();}async function _0x55815a(){const _0x12af75=_0x18b51e,_0xac9992=await _0x8b9cb8(_0x12af75(0x6c4),_0x12af75(0xd1d),{'confirmButtonClass':_0x12af75(0xe2a),'confirmText':_0x12af75(0x807)});if(!_0xac9992)return;await _0x501c7b('请稍候...',_0x12af75(0xff7)),console[_0x12af75(0x32b)](_0x12af75(0x608));let _0x2cc94c={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0x15043e[_0x12af75(0xa88)]('rw',_0x15043e[_0x12af75(0x45e)],async()=>{const _0x16fb14=_0x12af75,_0x3733d4=await _0x15043e[_0x16fb14(0x799)][_0x16fb14(0x6be)](),_0x199930=await _0x15043e[_0x16fb14(0xa4a)][_0x16fb14(0x6be)](),_0x747e06=new Set(_0x3733d4[_0x16fb14(0x6b9)](_0xebbcaf=>_0xebbcaf['id'])),_0x365133=new Set(_0x199930['map'](_0x387e10=>_0x16fb14(0x5ea)+_0x387e10['id'])),_0xa4610=new Set(_0x3733d4['filter'](_0x275c63=>!_0x275c63[_0x16fb14(0x1000)])[_0x16fb14(0x6b9)](_0x70eece=>_0x70eece[_0x16fb14(0x4e7)]));_0xa4610[_0x16fb14(0x3f4)](_0x405767['qzoneSettings'][_0x16fb14(0xab3)]||_0x16fb14(0x2dc)),_0x199930[_0x16fb14(0x7c0)](_0x2d48db=>_0xa4610[_0x16fb14(0x3f4)](_0x2d48db[_0x16fb14(0x596)]));for(const _0x2769e9 of _0x3733d4){let _0x425be9=![];if(_0x2769e9[_0x16fb14(0x1000)]&&_0x2769e9[_0x16fb14(0x635)]){const _0x5ab3f1=_0x2769e9[_0x16fb14(0x635)]['length'];_0x2769e9[_0x16fb14(0x635)]=_0x2769e9[_0x16fb14(0x635)][_0x16fb14(0x1d8)](_0x1dd726=>_0x747e06[_0x16fb14(0x11ac)](_0x1dd726['id'])||_0x365133[_0x16fb14(0x11ac)](_0x1dd726['id'])),_0x2769e9[_0x16fb14(0x635)][_0x16fb14(0x105a)]<_0x5ab3f1&&(_0x2cc94c[_0x16fb14(0x8a6)]+=_0x5ab3f1-_0x2769e9[_0x16fb14(0x635)][_0x16fb14(0x105a)],_0x425be9=!![]);}if(_0x2769e9[_0x16fb14(0x33a)]?.[_0x16fb14(0xb6e)]?.[_0x16fb14(0x105a)]>0x0){const _0x1d7710=_0x2769e9[_0x16fb14(0x33a)]['linkedMemoryChatIds'][_0x16fb14(0x105a)];_0x2769e9['settings'][_0x16fb14(0xb6e)]=_0x2769e9[_0x16fb14(0x33a)][_0x16fb14(0xb6e)]['filter'](_0x314aea=>_0x747e06[_0x16fb14(0x11ac)](_0x314aea)),_0x2769e9['settings'][_0x16fb14(0xb6e)][_0x16fb14(0x105a)]<_0x1d7710&&(_0x2cc94c[_0x16fb14(0x470)]+=_0x1d7710-_0x2769e9['settings'][_0x16fb14(0xb6e)][_0x16fb14(0x105a)],_0x425be9=!![]);}_0x425be9&&await _0x15043e[_0x16fb14(0x799)][_0x16fb14(0xfaa)](_0x2769e9);}const _0x3f4740=await _0x15043e[_0x16fb14(0xcc0)][_0x16fb14(0x6be)]();for(const _0x4f49ab of _0x3f4740){let _0x4f8eb2=![];const _0x5a8581=_0x4f49ab['authorId']===_0x16fb14(0x74b)||_0x747e06['has'](_0x4f49ab[_0x16fb14(0x802)])||_0x365133[_0x16fb14(0x11ac)](_0x4f49ab[_0x16fb14(0x802)]);if(!_0x5a8581){await _0x15043e[_0x16fb14(0xcc0)]['delete'](_0x4f49ab['id']),_0x2cc94c[_0x16fb14(0x468)]++;continue;}if(_0x4f49ab[_0x16fb14(0xe2e)]&&_0x4f49ab['likes'][_0x16fb14(0x105a)]>0x0){const _0x3db8f8=_0x4f49ab[_0x16fb14(0xe2e)][_0x16fb14(0x105a)];_0x4f49ab[_0x16fb14(0xe2e)]=_0x4f49ab[_0x16fb14(0xe2e)]['filter'](_0xc25814=>_0xa4610[_0x16fb14(0x11ac)](_0xc25814)),_0x4f49ab[_0x16fb14(0xe2e)]['length']<_0x3db8f8&&(_0x2cc94c['likes']+=_0x3db8f8-_0x4f49ab[_0x16fb14(0xe2e)][_0x16fb14(0x105a)],_0x4f8eb2=!![]);}if(_0x4f49ab[_0x16fb14(0x93c)]&&_0x4f49ab[_0x16fb14(0x93c)][_0x16fb14(0x105a)]>0x0){const _0x368d0f=_0x4f49ab[_0x16fb14(0x93c)][_0x16fb14(0x105a)];_0x4f49ab[_0x16fb14(0x93c)]=_0x4f49ab[_0x16fb14(0x93c)][_0x16fb14(0x1d8)](_0x275a0f=>{const _0x28cc9b=_0x16fb14;if(typeof _0x275a0f===_0x28cc9b(0x7a5)&&_0x275a0f[_0x28cc9b(0x110f)])return _0xa4610[_0x28cc9b(0x11ac)](_0x275a0f['commenterName']);return!![];}),_0x4f49ab['comments'][_0x16fb14(0x105a)]<_0x368d0f&&(_0x2cc94c[_0x16fb14(0x93c)]+=_0x368d0f-_0x4f49ab[_0x16fb14(0x93c)][_0x16fb14(0x105a)],_0x4f8eb2=!![]);}_0x4f8eb2&&await _0x15043e[_0x16fb14(0xcc0)]['put'](_0x4f49ab);}await _0x15043e[_0x16fb14(0x4a0)]['where'](_0x16fb14(0xb3d))['noneOf']([..._0x747e06])[_0x16fb14(0x89f)]()[_0x16fb14(0xc15)](_0x5b2737=>_0x2cc94c[_0x16fb14(0x4a0)]+=_0x5b2737),await _0x15043e[_0x16fb14(0x164)]['where'](_0x16fb14(0xb3d))['noneOf']([..._0x747e06])['delete']()[_0x16fb14(0xc15)](_0xbecc49=>_0x2cc94c[_0x16fb14(0x164)]+=_0xbecc49);const _0x100056=await _0x15043e[_0x16fb14(0x68b)][_0x16fb14(0x6be)]();for(const _0x4566d2 of _0x100056){_0x4566d2[_0x16fb14(0xb3d)]!=='global'&&!_0x747e06[_0x16fb14(0x11ac)](_0x4566d2[_0x16fb14(0xb3d)])&&(await _0x15043e[_0x16fb14(0x68b)][_0x16fb14(0x89f)](_0x4566d2['id']),_0x2cc94c[_0x16fb14(0x68b)]++);}});let _0x3fb33a='✅\x20清理完成！\x0a\x0a',_0x42fa26=![];Object[_0x12af75(0x6ff)](_0x2cc94c)[_0x12af75(0x7c0)](([_0x209450,_0x5e5e29])=>{const _0x44583f=_0x12af75;if(_0x5e5e29>0x0){const _0x27a6bf={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':_0x44583f(0xcf4),'renderingRules':_0x44583f(0xa1c),'groupMembers':_0x44583f(0xeca),'chatLinks':_0x44583f(0x709)};_0x3fb33a+='-\x20清理了\x20'+_0x5e5e29+_0x44583f(0xfa3)+(_0x27a6bf[_0x209450]||_0x209450)+'。\x0a',_0x42fa26=!![];}});!_0x42fa26&&(_0x3fb33a='✅\x20检查完成，未发现任何冗余数据。');_0x3fb33a+='\x0a建议刷新页面以确保所有更改生效。',await _0x501c7b(_0x12af75(0x10b7),_0x3fb33a);const _0x512705=await _0x8b9cb8(_0x12af75(0x122e),_0x12af75(0x958));_0x512705&&location[_0x12af75(0x110a)]();}catch(_0x39378b){console[_0x12af75(0x7a3)](_0x12af75(0xe0d),_0x39378b),await _0x501c7b(_0x12af75(0x1099),'发生了一个错误:\x20'+_0x39378b[_0x12af75(0xc7d)]);}}async function _0x50817e(){const _0x31c6c7=_0x18b51e;try{const _0x3813e3={'version':0x1,'timestamp':Date[_0x31c6c7(0x1ed)]()},[_0x4a90a9,_0x55c715,_0x31da09,_0x2576e1,_0x4aa232,_0x36f47b,_0x2ef4cd,_0x7173e4,_0x5ca314,_0x201f10,_0x51ee57,_0x3fd92b,_0x211866,_0x38fa11,_0x4623c1,_0x116d82,_0x41567d,_0x28178d,_0x1f10ca,_0x491aa4,_0x3164cf,_0x9629b8,_0x2b3da5,_0x4ebe29,_0x2bd9c9]=await Promise['all']([_0x15043e['chats']['toArray'](),_0x15043e[_0x31c6c7(0x40e)][_0x31c6c7(0x6be)](),_0x15043e['userStickers'][_0x31c6c7(0x6be)](),_0x15043e['apiConfig']['get'](_0x31c6c7(0xca1)),_0x15043e[_0x31c6c7(0xb73)][_0x31c6c7(0x3e9)]('main'),_0x15043e[_0x31c6c7(0xaa4)][_0x31c6c7(0x6be)](),_0x15043e[_0x31c6c7(0xaf8)][_0x31c6c7(0x3e9)]('main'),_0x15043e[_0x31c6c7(0x20a)][_0x31c6c7(0x3e9)](_0x31c6c7(0xca1)),_0x15043e[_0x31c6c7(0xcc0)][_0x31c6c7(0x6be)](),_0x15043e[_0x31c6c7(0x10d1)][_0x31c6c7(0x6be)](),_0x15043e[_0x31c6c7(0xbed)][_0x31c6c7(0x6be)](),_0x15043e['favorites'][_0x31c6c7(0x6be)](),_0x15043e[_0x31c6c7(0x232)][_0x31c6c7(0x6be)](),_0x15043e['memories'][_0x31c6c7(0x6be)](),_0x15043e[_0x31c6c7(0x4a5)][_0x31c6c7(0x6be)](),_0x15043e[_0x31c6c7(0xd8f)][_0x31c6c7(0x6be)](),_0x15043e['shoppingProducts'][_0x31c6c7(0x6be)](),_0x15043e[_0x31c6c7(0x164)]['toArray'](),_0x15043e[_0x31c6c7(0x68b)][_0x31c6c7(0x6be)](),_0x15043e[_0x31c6c7(0xd12)][_0x31c6c7(0x6be)](),_0x15043e['stickerCategories'][_0x31c6c7(0x6be)](),_0x15043e[_0x31c6c7(0x73c)][_0x31c6c7(0x6be)](),_0x15043e[_0x31c6c7(0xeb2)]['toArray'](),_0x15043e[_0x31c6c7(0x31a)][_0x31c6c7(0x6be)](),_0x15043e[_0x31c6c7(0xa4a)][_0x31c6c7(0x6be)]()]);Object[_0x31c6c7(0xc28)](_0x3813e3,{'chats':_0x4a90a9,'worldBooks':_0x55c715,'userStickers':_0x31da09,'apiConfig':_0x2576e1,'globalSettings':_0x4aa232,'personaPresets':_0x36f47b,'musicLibrary':_0x2ef4cd,'qzoneSettings':_0x7173e4,'qzonePosts':_0x5ca314,'qzoneAlbums':_0x201f10,'qzonePhotos':_0x51ee57,'favorites':_0x3fd92b,'qzoneGroups':_0x211866,'memories':_0x38fa11,'worldBookCategories':_0x4623c1,'apiPresets':_0x116d82,'shoppingProducts':_0x41567d,'callRecords':_0x28178d,'renderingRules':_0x1f10ca,'doubanPosts':_0x491aa4,'stickerCategories':_0x3164cf,'appearancePresets':_0x9629b8,'presets':_0x2b3da5,'presetCategories':_0x4ebe29,'npcs':_0x2bd9c9});const _0x2da720=new Blob([JSON[_0x31c6c7(0x1175)](_0x3813e3,null,0x2)],{'type':'application/json'}),_0xf68a02=URL[_0x31c6c7(0x90b)](_0x2da720),_0xb12185=Object[_0x31c6c7(0xc28)](document[_0x31c6c7(0x8c1)]('a'),{'href':_0xf68a02,'download':'EPhone-Full-Backup-'+new Date()[_0x31c6c7(0x8a5)]()['split']('T')[0x0]+_0x31c6c7(0x10d8)});_0xb12185[_0x31c6c7(0xa17)](),URL[_0x31c6c7(0xb0a)](_0xf68a02),await _0x501c7b(_0x31c6c7(0x1d6),_0x31c6c7(0x4e9));}catch(_0x140374){console[_0x31c6c7(0x7a3)](_0x31c6c7(0x4ef),_0x140374),await _0x501c7b(_0x31c6c7(0x1051),_0x31c6c7(0xb10)+_0x140374[_0x31c6c7(0xc7d)]);}}async function _0x410744(_0x28d139){const _0x54dd72=_0x18b51e;try{await _0x15043e[_0x54dd72(0xa88)]('rw',_0x15043e[_0x54dd72(0x45e)],async()=>{const _0x1139ba=_0x54dd72;for(const _0x3d5377 of _0x15043e[_0x1139ba(0x45e)]){await _0x3d5377[_0x1139ba(0xa6a)]();}for(const _0x1f9ba7 in _0x28d139){Array[_0x1139ba(0xb85)](_0x28d139[_0x1f9ba7])&&(console[_0x1139ba(0x32b)]('正在导入表:\x20'+_0x1f9ba7+',\x20记录数:\x20'+_0x28d139[_0x1f9ba7][_0x1139ba(0x105a)]),await _0x15043e[_0x1139ba(0x7d9)](_0x1f9ba7)['bulkPut'](_0x28d139[_0x1f9ba7]));}});}catch(_0x2d5432){throw new Error('数据库写入失败:\x20'+_0x2d5432[_0x54dd72(0xc7d)]);}}async function _0x4ec9da(_0x583958){const _0x40f034=_0x18b51e;if(!_0x583958)return;const _0x3888d1=await _0x8b9cb8(_0x40f034(0x127b),'导入备份将完全覆盖您当前的所有数据。此操作不可撤销！确定要继续吗？',{'confirmButtonClass':'btn-danger'});if(!_0x3888d1)return;await _0x501c7b(_0x40f034(0x1047),'正在读取并解析备份文件...');try{const _0x3c95e0=await _0x583958[_0x40f034(0xbc6)](),_0x2f85e3=JSON[_0x40f034(0x10ab)](_0x3c95e0);if(_0x2f85e3[_0x40f034(0x49a)]&&typeof _0x2f85e3['data']==='object'&&_0x2f85e3[_0x40f034(0x49a)][_0x40f034(0x799)])console['log'](_0x40f034(0x38d)),await _0x410744(_0x2f85e3[_0x40f034(0x49a)]);else{if(_0x2f85e3[_0x40f034(0x799)])console[_0x40f034(0x32b)](_0x40f034(0x14b)),await _0x5de886(_0x2f85e3);else throw new Error(_0x40f034(0xfb0));}await _0x501c7b(_0x40f034(0x95b),'所有数据已成功恢复！应用即将刷新以应用所有更改。'),setTimeout(()=>{const _0x3fbd61=_0x40f034;window[_0x3fbd61(0x841)][_0x3fbd61(0x110a)]();},0x5dc);}catch(_0x3eb238){console['error']('导入数据时出错:',_0x3eb238),await _0x501c7b(_0x40f034(0x8e8),_0x40f034(0x153)+_0x3eb238[_0x40f034(0xc7d)]);}}async function _0x5de886(_0x2dd455){const _0x16366d=_0x18b51e;try{await _0x15043e['transaction']('rw',_0x15043e['tables'],async()=>{const _0x3c06be=_0x7a65;await _0x15043e[_0x3c06be(0x799)][_0x3c06be(0xa6a)](),await _0x15043e[_0x3c06be(0x40e)][_0x3c06be(0xa6a)]();for(const _0x22dbc1 of _0x15043e[_0x3c06be(0x45e)]){await _0x22dbc1[_0x3c06be(0xa6a)]();}if(Array['isArray'](_0x2dd455[_0x3c06be(0x799)]))await _0x15043e[_0x3c06be(0x799)][_0x3c06be(0xcfd)](_0x2dd455[_0x3c06be(0x799)]);if(Array[_0x3c06be(0xb85)](_0x2dd455['worldBooks']))await _0x15043e[_0x3c06be(0x40e)][_0x3c06be(0xcfd)](_0x2dd455[_0x3c06be(0x40e)]);if(Array[_0x3c06be(0xb85)](_0x2dd455['userStickers']))await _0x15043e[_0x3c06be(0xc36)]['bulkPut'](_0x2dd455[_0x3c06be(0xc36)]);if(_0x2dd455['apiConfig'])await _0x15043e[_0x3c06be(0x9e0)][_0x3c06be(0xfaa)](_0x2dd455[_0x3c06be(0x9e0)]);if(_0x2dd455[_0x3c06be(0xb73)])await _0x15043e['globalSettings']['put'](_0x2dd455[_0x3c06be(0xb73)]);if(Array[_0x3c06be(0xb85)](_0x2dd455[_0x3c06be(0xaa4)]))await _0x15043e[_0x3c06be(0xaa4)][_0x3c06be(0xcfd)](_0x2dd455['personaPresets']);if(_0x2dd455[_0x3c06be(0xaf8)])await _0x15043e[_0x3c06be(0xaf8)][_0x3c06be(0xfaa)](_0x2dd455['musicLibrary']);if(_0x2dd455[_0x3c06be(0x20a)])await _0x15043e[_0x3c06be(0x20a)][_0x3c06be(0xfaa)](_0x2dd455['qzoneSettings']);if(Array[_0x3c06be(0xb85)](_0x2dd455[_0x3c06be(0xcc0)]))await _0x15043e[_0x3c06be(0xcc0)][_0x3c06be(0xcfd)](_0x2dd455[_0x3c06be(0xcc0)]);if(Array[_0x3c06be(0xb85)](_0x2dd455['qzoneAlbums']))await _0x15043e[_0x3c06be(0x10d1)][_0x3c06be(0xcfd)](_0x2dd455[_0x3c06be(0x10d1)]);if(Array['isArray'](_0x2dd455[_0x3c06be(0xbed)]))await _0x15043e[_0x3c06be(0xbed)][_0x3c06be(0xcfd)](_0x2dd455[_0x3c06be(0xbed)]);if(Array[_0x3c06be(0xb85)](_0x2dd455[_0x3c06be(0xe93)]))await _0x15043e['favorites'][_0x3c06be(0xcfd)](_0x2dd455['favorites']);if(Array[_0x3c06be(0xb85)](_0x2dd455['qzoneGroups']))await _0x15043e[_0x3c06be(0x232)]['bulkPut'](_0x2dd455['qzoneGroups']);if(Array[_0x3c06be(0xb85)](_0x2dd455[_0x3c06be(0x4a0)]))await _0x15043e[_0x3c06be(0x4a0)][_0x3c06be(0xcfd)](_0x2dd455[_0x3c06be(0x4a0)]);if(Array['isArray'](_0x2dd455[_0x3c06be(0x4a5)]))await _0x15043e[_0x3c06be(0x4a5)][_0x3c06be(0xcfd)](_0x2dd455[_0x3c06be(0x4a5)]);if(Array['isArray'](_0x2dd455[_0x3c06be(0xd8f)]))await _0x15043e[_0x3c06be(0xd8f)][_0x3c06be(0xcfd)](_0x2dd455[_0x3c06be(0xd8f)]);if(Array[_0x3c06be(0xb85)](_0x2dd455['shoppingProducts']))await _0x15043e[_0x3c06be(0x221)][_0x3c06be(0xcfd)](_0x2dd455['shoppingProducts']);if(Array[_0x3c06be(0xb85)](_0x2dd455[_0x3c06be(0x164)]))await _0x15043e[_0x3c06be(0x164)][_0x3c06be(0xcfd)](_0x2dd455[_0x3c06be(0x164)]);if(Array['isArray'](_0x2dd455[_0x3c06be(0x68b)]))await _0x15043e['renderingRules'][_0x3c06be(0xcfd)](_0x2dd455[_0x3c06be(0x68b)]);if(Array['isArray'](_0x2dd455[_0x3c06be(0xd12)]))await _0x15043e[_0x3c06be(0xd12)][_0x3c06be(0xcfd)](_0x2dd455['doubanPosts']);if(Array[_0x3c06be(0xb85)](_0x2dd455[_0x3c06be(0x7db)]))await _0x15043e[_0x3c06be(0x7db)][_0x3c06be(0xcfd)](_0x2dd455[_0x3c06be(0x7db)]);if(Array['isArray'](_0x2dd455[_0x3c06be(0x73c)]))await _0x15043e[_0x3c06be(0x73c)][_0x3c06be(0xcfd)](_0x2dd455[_0x3c06be(0x73c)]);if(Array[_0x3c06be(0xb85)](_0x2dd455[_0x3c06be(0xeb2)]))await _0x15043e['presets']['bulkPut'](_0x2dd455[_0x3c06be(0xeb2)]);if(Array[_0x3c06be(0xb85)](_0x2dd455['presetCategories']))await _0x15043e['presetCategories'][_0x3c06be(0xcfd)](_0x2dd455[_0x3c06be(0x31a)]);if(Array['isArray'](_0x2dd455[_0x3c06be(0xa4a)]))await _0x15043e[_0x3c06be(0xa4a)][_0x3c06be(0xcfd)](_0x2dd455['npcs']);});}catch(_0x157fa4){throw new Error(_0x16366d(0xf8c)+_0x157fa4['message']);}}function _0x218332(_0x3a131b,_0xf74318=![]){const _0x58d479=_0x18b51e;if(!_0x3a131b){_0x401daa[_0x58d479(0xca0)]='',document[_0x58d479(0x8c2)](_0x58d479(0x493))[_0x58d479(0x842)][_0x58d479(0x8f3)]='';return;}const _0x55787a=_0x58d479(0xd45),_0x1ec1a6=_0x58d479(0x1278)+_0x55787a+_0x58d479(0x1225)+_0x3a131b+_0x58d479(0xf00);if(_0xf74318){const _0x309f8d=document[_0x58d479(0x8c2)](_0x58d479(0xca2))||document[_0x58d479(0x8c1)]('style');_0x309f8d['id']=_0x58d479(0xca2),_0x309f8d[_0x58d479(0xca0)]=_0x1ec1a6;if(!document[_0x58d479(0x8c2)]('preview-font-style'))document['head'][_0x58d479(0x31e)](_0x309f8d);document[_0x58d479(0x8c2)]('font-preview')[_0x58d479(0x842)][_0x58d479(0x8f3)]='\x27'+_0x55787a+_0x58d479(0xc04);}else _0x401daa[_0x58d479(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1ec1a6+_0x58d479(0x2b5)+_0x55787a+_0x58d479(0x1285);}async function _0x27758a(){const _0x4ce252=_0x18b51e;_0x401daa[_0x4ce252(0xca0)]='',_0x405767['globalSettings'][_0x4ce252(0xa3a)]='',await _0x15043e[_0x4ce252(0xb73)][_0x4ce252(0xfaa)](_0x405767['globalSettings']),document[_0x4ce252(0x8c2)]('font-url-input')[_0x4ce252(0x518)]='',document['getElementById']('font-preview')[_0x4ce252(0x842)][_0x4ce252(0x8f3)]='',alert('已恢复默认字体。');}async function _0x343828(){const _0x517343=_0x18b51e,[_0x471b13,_0x167c25,_0x58ca60,_0x256a21,_0x386272,_0x2e4459,_0x54aa51,_0x16e295,_0x4addf4,_0x4b3a4f,_0x1385fe]=await Promise[_0x517343(0xe88)]([_0x15043e[_0x517343(0x799)]['toArray'](),_0x15043e['apiConfig'][_0x517343(0x3e9)](_0x517343(0xca1)),_0x15043e[_0x517343(0xb73)][_0x517343(0x3e9)](_0x517343(0xca1)),_0x15043e['userStickers'][_0x517343(0x6be)](),_0x15043e['worldBooks'][_0x517343(0x6be)](),_0x15043e[_0x517343(0xaf8)]['get'](_0x517343(0xca1)),_0x15043e[_0x517343(0xaa4)]['toArray'](),_0x15043e['qzoneSettings'][_0x517343(0x3e9)](_0x517343(0xca1)),_0x15043e[_0x517343(0xe93)]['orderBy'](_0x517343(0x351))[_0x517343(0x1c0)]()['toArray'](),_0x15043e[_0x517343(0x4a0)][_0x517343(0x6be)](),_0x15043e['presets']['toArray']()]);_0x405767['presets']=_0x1385fe||[];const _0xd4288c={'id':_0x517343(0xca1),'showStatusBar':![],'wallpaper':_0x517343(0xf19),'fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0x85529d},'cphoneWallpaper':'linear-gradient(135deg,\x20#f6d365,\x20#fda085)','cphoneAppIcons':{..._0x1c31bc},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x405767[_0x517343(0xb73)]={..._0xd4288c,..._0x58ca60||{}},_0x405767['globalSettings'][_0x517343(0x18d)]={..._0xd4288c[_0x517343(0x18d)],..._0x405767[_0x517343(0xb73)]['appIcons']||{}},_0x405767[_0x517343(0xb73)]['cphoneAppIcons']={..._0xd4288c[_0x517343(0x429)],..._0x405767['globalSettings'][_0x517343(0x429)]||{}},_0x471b13[_0x517343(0x7c0)](_0x497d9b=>{const _0x1d2d24=_0x517343;typeof _0x497d9b['settings'][_0x1d2d24(0xe87)]===_0x1d2d24(0x3df)&&(_0x497d9b[_0x1d2d24(0x33a)][_0x1d2d24(0xe87)]=!![]),!_0x497d9b[_0x1d2d24(0x33a)]['lyricsPosition']&&(_0x497d9b[_0x1d2d24(0x33a)][_0x1d2d24(0x45f)]={'vertical':_0x1d2d24(0x9a4),'horizontal':_0x1d2d24(0x65d),'offset':0xa}),!_0x497d9b[_0x1d2d24(0x1000)]&&!_0x497d9b['settings'][_0x1d2d24(0x567)]&&(_0x497d9b[_0x1d2d24(0x33a)][_0x1d2d24(0x567)]=[]),!_0x497d9b['isGroup']&&typeof _0x497d9b[_0x1d2d24(0x4e7)]===_0x1d2d24(0x3df)&&(_0x497d9b[_0x1d2d24(0x4e7)]=_0x497d9b[_0x1d2d24(0x596)]);}),_0x405767[_0x517343(0x799)]=_0x471b13[_0x517343(0x29a)]((_0x1a390b,_0x38d615)=>{const _0x2111e3=_0x517343;if(typeof _0x38d615[_0x2111e3(0xf10)]===_0x2111e3(0x3df))_0x38d615[_0x2111e3(0xf10)]=0x0;_0x38d615[_0x2111e3(0x1000)]&&(typeof _0x38d615[_0x2111e3(0x33a)][_0x2111e3(0x105d)]==='undefined'&&(_0x38d615['settings'][_0x2111e3(0x105d)]=!![]),_0x38d615[_0x2111e3(0x635)]&&_0x38d615['members']['length']>0x0&&_0x38d615['members'][0x0][_0x2111e3(0x596)]&&_0x38d615['members'][_0x2111e3(0x7c0)](_0x543676=>{const _0x3a469c=_0x2111e3;typeof _0x543676[_0x3a469c(0x4e7)]===_0x3a469c(0x3df)&&(_0x543676['originalName']=_0x543676[_0x3a469c(0x596)],_0x543676[_0x3a469c(0x375)]=_0x543676[_0x3a469c(0x596)],delete _0x543676[_0x3a469c(0x596)]);}));if(!_0x38d615[_0x2111e3(0x33a)])_0x38d615['settings']={};typeof _0x38d615[_0x2111e3(0x33a)][_0x2111e3(0x107e)]==='undefined'&&(_0x38d615[_0x2111e3(0x33a)][_0x2111e3(0x107e)]=0xa);if(!_0x38d615[_0x2111e3(0x1000)]&&!_0x38d615[_0x2111e3(0x8c8)])_0x38d615[_0x2111e3(0x8c8)]={'text':'在线','lastUpdate':Date[_0x2111e3(0x1ed)](),'isBusy':![]};if(!_0x38d615[_0x2111e3(0x1000)]&&!_0x38d615[_0x2111e3(0x944)])_0x38d615[_0x2111e3(0x944)]={'status':_0x2111e3(0xaa7),'blockedTimestamp':null,'applicationReason':''};if(!_0x38d615[_0x2111e3(0x1000)]&&(!_0x38d615[_0x2111e3(0x33a)]||!_0x38d615[_0x2111e3(0x33a)][_0x2111e3(0xca4)])){if(!_0x38d615['settings'])_0x38d615['settings']={};_0x38d615[_0x2111e3(0x33a)]['aiAvatarLibrary']=[];}_0x38d615[_0x2111e3(0x1000)]&&(_0x38d615[_0x2111e3(0x635)]||[])[_0x2111e3(0x7c0)](_0xc393f3=>{const _0x34b619=_0x2111e3;if(typeof _0xc393f3['avatarFrame']===_0x34b619(0x3df))_0xc393f3[_0x34b619(0xe78)]='';});if(!_0x38d615[_0x2111e3(0xfed)])_0x38d615['musicData']={'totalTime':0x0};_0x38d615[_0x2111e3(0x33a)]&&_0x38d615[_0x2111e3(0x33a)][_0x2111e3(0xa0e)]&&!_0x38d615[_0x2111e3(0x33a)][_0x2111e3(0xb77)]&&(_0x38d615['settings'][_0x2111e3(0xb77)]=[_0x38d615[_0x2111e3(0x33a)]['linkedWorldBookId']],delete _0x38d615['settings'][_0x2111e3(0xa0e)]);if(typeof _0x38d615[_0x2111e3(0xe06)]===_0x2111e3(0x3df))_0x38d615[_0x2111e3(0xe06)]=![];!_0x38d615[_0x2111e3(0x1000)]&&typeof _0x38d615[_0x2111e3(0x33a)][_0x2111e3(0xe16)]===_0x2111e3(0x3df)&&(_0x38d615['settings'][_0x2111e3(0xe16)]='我');if(_0x38d615[_0x2111e3(0x1000)]&&_0x38d615[_0x2111e3(0x635)]){let _0x4782da=![];_0x471b13[_0x2111e3(0x7c0)](_0x36bcdc=>{const _0x21f2d9=_0x2111e3;_0x36bcdc['id']===_0x38d615['id']&&_0x36bcdc[_0x21f2d9(0x4e7)]&&delete _0x36bcdc['originalName'];}),_0x38d615[_0x2111e3(0x635)][_0x2111e3(0x7c0)](_0x439b4b=>{const _0x33718a=_0x2111e3,_0xdb65fc=_0x471b13[_0x33718a(0x2ef)](_0x5068e5=>_0x5068e5['id']===_0x439b4b['id']);if(_0xdb65fc&&_0xdb65fc['settings']){const _0x12defc=_0xdb65fc[_0x33718a(0x33a)][_0x33718a(0x1b1)]||'';_0x439b4b[_0x33718a(0xe78)]!==_0x12defc&&(_0x439b4b[_0x33718a(0xe78)]=_0x12defc,_0x4782da=!![]);}else typeof _0x439b4b[_0x33718a(0xe78)]==='undefined'&&(_0x439b4b[_0x33718a(0xe78)]='',_0x4782da=!![]);});if(_0x4782da)_0x15043e[_0x2111e3(0x799)][_0x2111e3(0xfaa)](_0x38d615);}if(!_0x38d615[_0x2111e3(0x33a)][_0x2111e3(0xfee)])_0x38d615[_0x2111e3(0x33a)][_0x2111e3(0xfee)]=![];if(!_0x38d615[_0x2111e3(0x33a)][_0x2111e3(0xae7)])_0x38d615[_0x2111e3(0x33a)][_0x2111e3(0xae7)]=0x14;if(!_0x38d615['longTermMemory'])_0x38d615[_0x2111e3(0xbca)]=[];if(!_0x38d615[_0x2111e3(0x121e)])_0x38d615['lastMemorySummaryTimestamp']=0x0;if(!_0x38d615['isGroup']){typeof _0x38d615[_0x2111e3(0x33a)][_0x2111e3(0x105d)]===_0x2111e3(0x3df)&&(_0x38d615[_0x2111e3(0x33a)][_0x2111e3(0x105d)]=!![]);typeof _0x38d615[_0x2111e3(0x33a)][_0x2111e3(0xa71)]===_0x2111e3(0x3df)&&(_0x38d615[_0x2111e3(0x33a)][_0x2111e3(0xa71)]=![]);if(!_0x38d615['status'])_0x38d615[_0x2111e3(0x8c8)]={'text':'在线','lastUpdate':Date[_0x2111e3(0x1ed)](),'isBusy':![]};if(!_0x38d615[_0x2111e3(0x944)])_0x38d615[_0x2111e3(0x944)]={'status':'friend','blockedTimestamp':null,'applicationReason':''};if(!_0x38d615['settings']||!_0x38d615[_0x2111e3(0x33a)]['aiAvatarLibrary']){if(!_0x38d615['settings'])_0x38d615[_0x2111e3(0x33a)]={};_0x38d615[_0x2111e3(0x33a)]['aiAvatarLibrary']=[];}if(typeof _0x38d615['settings'][_0x2111e3(0x10bf)]===_0x2111e3(0x3df))_0x38d615[_0x2111e3(0x33a)][_0x2111e3(0x10bf)]=![];if(typeof _0x38d615[_0x2111e3(0x33a)][_0x2111e3(0x1203)]===_0x2111e3(0x3df))_0x38d615[_0x2111e3(0x33a)][_0x2111e3(0x1203)]=0x64;if(typeof _0x38d615[_0x2111e3(0x33a)][_0x2111e3(0x13c)]===_0x2111e3(0x3df))_0x38d615[_0x2111e3(0x33a)][_0x2111e3(0x13c)]=0x12c;typeof _0x38d615['settings']['injectLatestThought']==='undefined'&&(_0x38d615[_0x2111e3(0x33a)]['injectLatestThought']=![]);if(typeof _0x38d615[_0x2111e3(0x211)]===_0x2111e3(0x3df))_0x38d615[_0x2111e3(0x211)]='...';if(typeof _0x38d615[_0x2111e3(0x103c)]===_0x2111e3(0x3df))_0x38d615[_0x2111e3(0x103c)]='...';!Array['isArray'](_0x38d615[_0x2111e3(0x120b)])&&(_0x38d615[_0x2111e3(0x120b)]=[]);}return _0x1a390b[_0x38d615['id']]=_0x38d615,_0x1a390b;},{});const _0xf6b3b3=[];_0x4b3a4f[_0x517343(0x7c0)](_0x4cf45a=>{const _0xe142fb=_0x517343;if(_0x4cf45a[_0xe142fb(0xde0)]===_0xe142fb(0xf0c)&&_0x4cf45a[_0xe142fb(0x718)]&&!_0x4cf45a[_0xe142fb(0x802)]){const _0x97e203=_0x471b13[_0xe142fb(0x2ef)](_0x1ba59a=>!_0x1ba59a[_0xe142fb(0x1000)]&&_0x1ba59a[_0xe142fb(0x4e7)]===_0x4cf45a[_0xe142fb(0x718)]);if(_0x97e203)_0x4cf45a['authorId']=_0x97e203['id'],_0xf6b3b3['push'](_0x4cf45a);else{const _0x2f0017=_0x471b13['find'](_0x205624=>!_0x205624[_0xe142fb(0x1000)]&&_0x205624[_0xe142fb(0x596)]===_0x4cf45a[_0xe142fb(0x718)]);_0x2f0017&&(_0x4cf45a[_0xe142fb(0x802)]=_0x2f0017['id'],_0xf6b3b3[_0xe142fb(0xa49)](_0x4cf45a));}}}),_0xf6b3b3['length']>0x0&&await _0x15043e[_0x517343(0x4a0)][_0x517343(0xcfd)](_0xf6b3b3),_0x405767[_0x517343(0x9e0)]=_0x167c25||{'id':_0x517343(0xca1),'proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':_0x517343(0x11f3)},_0x405767[_0x517343(0xc36)]=_0x256a21||[],_0x405767[_0x517343(0x40e)]=_0x386272||[],_0x4a77e1['playlist']=_0x2e4459?.[_0x517343(0xcfa)]||[],_0x405767[_0x517343(0xaa4)]=_0x54aa51||[],_0x405767[_0x517343(0x20a)]=_0x16e295||{'id':_0x517343(0xca1),'nickname':_0x517343(0x2dc),'avatar':_0x517343(0x96d),'banner':'https://files.catbox.moe/r5heyt.gif'},allFavoriteItems=_0x4addf4||[];}async function _0x2b48e0(){const _0x1d8e00=_0x18b51e;await _0x15043e[_0x1d8e00(0xaf8)][_0x1d8e00(0xfaa)]({'id':'main','playlist':_0x4a77e1['playlist']});}function _0x75dca3(_0x367156){const _0x34b73a=_0x18b51e;if(!_0x367156)return'';const _0x2bcd96=new Date(_0x367156),_0x12af8d=String(_0x2bcd96[_0x34b73a(0x1ae)]())[_0x34b73a(0xc89)](0x2,'0'),_0x2e5b1d=String(_0x2bcd96[_0x34b73a(0xbdd)]())['padStart'](0x2,'0');return _0x12af8d+':'+_0x2e5b1d;}function _0x4f34be(_0xbaa687){const _0x59be3b=_0x18b51e,_0x2004f1=Date['now'](),_0x3d0704=Math[_0x59be3b(0x10b2)]((_0x2004f1-_0xbaa687)/0x3e8);if(_0x3d0704<0x3c)return'刚刚';const _0x308da5=Math[_0x59be3b(0x10b2)](_0x3d0704/0x3c);if(_0x308da5<0x3c)return _0x308da5+_0x59be3b(0x605);const _0x3af016=Math[_0x59be3b(0x10b2)](_0x308da5/0x3c);if(_0x3af016<0x18)return _0x3af016+_0x59be3b(0x80d);const _0x4c4e2e=Math[_0x59be3b(0x10b2)](_0x3af016/0x18);if(_0x4c4e2e<0x1e)return _0x4c4e2e+'天前';const _0x59c8e5=Math[_0x59be3b(0x10b2)](_0x4c4e2e/0x1e);if(_0x59c8e5<0xc)return'大约'+_0x59c8e5+_0x59be3b(0x381);const _0x2b4e1a=Math[_0x59be3b(0x10b2)](_0x4c4e2e/0x16d);return'大约'+_0x2b4e1a+'年前';}function _0x3dbc6f(_0xcf4970){const _0x5c5d49=_0x18b51e;if(!_0xcf4970)return'';const _0x3cf64a=new Date(),_0x1a3026=new Date(_0xcf4970),_0x313321=String(_0x1a3026['getHours']())[_0x5c5d49(0xc89)](0x2,'0'),_0x2cbbd9=String(_0x1a3026[_0x5c5d49(0xbdd)]())['padStart'](0x2,'0'),_0x4e8148=_0x313321+':'+_0x2cbbd9;if(_0x3cf64a['toDateString']()===_0x1a3026[_0x5c5d49(0x1181)]())return'今天\x20'+_0x4e8148;const _0x37457a=new Date();_0x37457a[_0x5c5d49(0x11d7)](_0x3cf64a[_0x5c5d49(0xca8)]()-0x1);if(_0x37457a[_0x5c5d49(0x1181)]()===_0x1a3026[_0x5c5d49(0x1181)]())return _0x5c5d49(0xd4f)+_0x4e8148;if(_0x3cf64a['getFullYear']()===_0x1a3026[_0x5c5d49(0x864)]()){const _0x33dc45=String(_0x1a3026[_0x5c5d49(0xc3c)]()+0x1),_0x29a330=String(_0x1a3026[_0x5c5d49(0xca8)]());return _0x33dc45+'月'+_0x29a330+'日\x20'+_0x4e8148;}const _0x2a41b2=_0x1a3026[_0x5c5d49(0x864)](),_0x17f4e0=String(_0x1a3026[_0x5c5d49(0xc3c)]()+0x1),_0x4b3856=String(_0x1a3026[_0x5c5d49(0xca8)]());return _0x2a41b2+'年'+_0x17f4e0+'月'+_0x4b3856+'日\x20'+_0x4e8148;}function _0x979d69(_0x595130,_0x26ddc5){const _0x546f0a=_0x18b51e;_0x36b53b(),clearTimeout(_0x18be2b);const _0x1b9aaf=_0x405767['chats'][_0x595130];if(!_0x1b9aaf)return;const _0x3da97a=document['getElementById'](_0x546f0a(0xefd));document['getElementById'](_0x546f0a(0x44d))['src']=_0x1b9aaf['settings'][_0x546f0a(0x44e)]||_0x1b9aaf[_0x546f0a(0x33a)][_0x546f0a(0x43b)]||_0x49d2a4,document[_0x546f0a(0x8c2)](_0x546f0a(0xa1b))['querySelector'](_0x546f0a(0x9f8))[_0x546f0a(0x1090)]=_0x1b9aaf[_0x546f0a(0x596)],document[_0x546f0a(0x8c2)](_0x546f0a(0xa1b))[_0x546f0a(0x1ad)](_0x546f0a(0xa47))[_0x546f0a(0x1090)]=_0x26ddc5,_0x3da97a[_0x546f0a(0xb17)][_0x546f0a(0xaff)]('visible'),void _0x3da97a[_0x546f0a(0x6f8)],_0x3da97a[_0x546f0a(0xb17)][_0x546f0a(0x3f4)]('visible');const _0x5cccad=_0x3da97a[_0x546f0a(0xac5)](!![]);_0x3da97a['parentNode'][_0x546f0a(0x56b)](_0x5cccad,_0x3da97a),_0x5cccad[_0x546f0a(0xae8)]('click',()=>{const _0x13d787=_0x546f0a;_0x426b8d(_0x595130),_0x5cccad[_0x13d787(0xb17)][_0x13d787(0xaff)](_0x13d787(0x2cd));}),_0x18be2b=setTimeout(()=>{const _0x42c276=_0x546f0a;_0x5cccad[_0x42c276(0xb17)][_0x42c276(0xaff)](_0x42c276(0x2cd));},0xfa0),_0xedf06();}function _0x202ddb(){const _0x150c7f=_0x18b51e,_0x5e9294=new Date(),_0x425c28=_0x5e9294[_0x150c7f(0xad6)]('zh-CN',{'hour':'2-digit','minute':_0x150c7f(0xd0c)}),_0x1fb5f4=_0x5e9294['toLocaleDateString'](_0x150c7f(0x73e),{'weekday':_0x150c7f(0x386),'month':_0x150c7f(0x386),'day':'numeric'});document[_0x150c7f(0x8c2)](_0x150c7f(0x11e5))['textContent']=_0x425c28;}function _0x5196dd(_0x5012c7){const _0x56230c=_0x18b51e,_0xc5c1a6=_0x5012c7[_0x56230c(0x8c6)]();if(_0xc5c1a6['startsWith']('[')&&_0xc5c1a6[_0x56230c(0x866)](']'))try{const _0x5b4ad3=JSON[_0x56230c(0x10ab)](_0xc5c1a6);if(Array['isArray'](_0x5b4ad3))return console[_0x56230c(0x32b)](_0x56230c(0xf2f)),_0x5b4ad3;}catch(_0xeff35){console[_0x56230c(0x112a)](_0x56230c(0xaeb));}const _0x5266cd=_0xc5c1a6[_0x56230c(0xdf8)](/{[^{}]*}/g);if(_0x5266cd){const _0x4e68ba=[];for(const _0x48ae18 of _0x5266cd){try{const _0x4e8a00=JSON['parse'](_0x48ae18);_0x4e68ba[_0x56230c(0xa49)](_0x4e8a00);}catch(_0x370593){console[_0x56230c(0x112a)](_0x56230c(0xdc2),_0x48ae18);}}if(_0x4e68ba['length']>0x0)return console[_0x56230c(0x32b)]('解析成功：通过强力提取模式。'),_0x4e68ba;}return console[_0x56230c(0x7a3)](_0x56230c(0xd67)),[{'type':_0x56230c(0xbc6),'content':_0x5012c7}];}function _0x1a88fc(_0x2c8751=new Date()){const _0x279a57=_0x18b51e,_0x5ec2cc=_0x2c8751[_0x279a57(0x1ae)]();if(_0x5ec2cc>=0x0&&_0x5ec2cc<0x5)return'凌晨';else{if(_0x5ec2cc>=0x5&&_0x5ec2cc<0x9)return'早上';else{if(_0x5ec2cc>=0x9&&_0x5ec2cc<0xd)return'上午';else{if(_0x5ec2cc>=0xd&&_0x5ec2cc<0x12)return'下午';else{if(_0x5ec2cc>=0x12&&_0x5ec2cc<0x18)return'晚上';}}}}return'现在';}async function _0x18986a(){const _0x2411a2=_0x18b51e,_0x136b6f=document[_0x2411a2(0x8c2)](_0x2411a2(0x826));_0x136b6f[_0x2411a2(0xca0)]='<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>';const _0x3941b0=await _0x15043e[_0x2411a2(0xd8f)][_0x2411a2(0x6be)]();_0x3941b0[_0x2411a2(0x7c0)](_0x1d387d=>{const _0x7929be=_0x2411a2,_0x3fc7d8=document[_0x7929be(0x8c1)](_0x7929be(0x4f3));_0x3fc7d8[_0x7929be(0x518)]=_0x1d387d['id'],_0x3fc7d8[_0x7929be(0x1090)]=_0x1d387d[_0x7929be(0x596)],_0x136b6f[_0x7929be(0x31e)](_0x3fc7d8);});const _0x2caad7=_0x405767[_0x2411a2(0x9e0)];let _0x50d908=null;for(const _0x202769 of _0x3941b0){if(_0x202769[_0x2411a2(0x34e)]===_0x2caad7[_0x2411a2(0x34e)]&&_0x202769[_0x2411a2(0x827)]===_0x2caad7[_0x2411a2(0x827)]&&_0x202769[_0x2411a2(0x8ce)]===_0x2caad7[_0x2411a2(0x8ce)]&&_0x202769[_0x2411a2(0x2fa)]===_0x2caad7[_0x2411a2(0x2fa)]&&_0x202769['secondaryApiKey']===_0x2caad7[_0x2411a2(0x107f)]&&_0x202769[_0x2411a2(0x234)]===_0x2caad7['secondaryModel']&&(_0x202769[_0x2411a2(0xa7d)]||'')===(_0x2caad7[_0x2411a2(0xa7d)]||'')&&(_0x202769[_0x2411a2(0x971)]||'')===(_0x2caad7['minimaxApiKey']||'')&&(_0x202769[_0x2411a2(0x68f)]||_0x2411a2(0x11f3))===(_0x2caad7[_0x2411a2(0x68f)]||_0x2411a2(0x11f3))){_0x50d908=_0x202769['id'];break;}}_0x50d908?_0x136b6f['value']=_0x50d908:_0x136b6f[_0x2411a2(0x518)]=_0x2411a2(0x759);}async function _0x2b4a0b(){const _0x374cfa=_0x18b51e,_0x4ed4a0=document[_0x374cfa(0x8c2)]('api-preset-select'),_0x1c861d=parseInt(_0x4ed4a0['value']);if(isNaN(_0x1c861d))return;const _0x8e1a7c=await _0x15043e[_0x374cfa(0xd8f)][_0x374cfa(0x3e9)](_0x1c861d);_0x8e1a7c&&(_0x405767[_0x374cfa(0x9e0)]={'id':_0x374cfa(0xca1),'proxyUrl':_0x8e1a7c['proxyUrl'],'apiKey':_0x8e1a7c[_0x374cfa(0x827)],'model':_0x8e1a7c[_0x374cfa(0x8ce)],'secondaryProxyUrl':_0x8e1a7c['secondaryProxyUrl'],'secondaryApiKey':_0x8e1a7c[_0x374cfa(0x107f)],'secondaryModel':_0x8e1a7c[_0x374cfa(0x234)],'minimaxGroupId':_0x8e1a7c[_0x374cfa(0xa7d)],'minimaxApiKey':_0x8e1a7c[_0x374cfa(0x971)],'minimaxModel':_0x8e1a7c[_0x374cfa(0x68f)]},await _0x15043e['apiConfig']['put'](_0x405767[_0x374cfa(0x9e0)]),_0x4fa943(),document[_0x374cfa(0x8c2)](_0x374cfa(0xdb9))[_0x374cfa(0xa17)](),_0x8e1a7c['secondaryProxyUrl']&&_0x8e1a7c[_0x374cfa(0x107f)]&&document[_0x374cfa(0x8c2)](_0x374cfa(0x342))['click'](),alert(_0x374cfa(0x100b)+_0x8e1a7c['name']+'”'));}async function _0x21bb4e(){const _0x52d332=_0x18b51e,_0x3064e7=await _0x180f74(_0x52d332(0x1a9),_0x52d332(0x542));if(!_0x3064e7||!_0x3064e7[_0x52d332(0x8c6)]())return;const _0x2a683d={'name':_0x3064e7[_0x52d332(0x8c6)](),'proxyUrl':document[_0x52d332(0x8c2)](_0x52d332(0xffa))[_0x52d332(0x518)][_0x52d332(0x8c6)](),'apiKey':document[_0x52d332(0x8c2)](_0x52d332(0x49e))['value'][_0x52d332(0x8c6)](),'model':document[_0x52d332(0x8c2)]('model-select')[_0x52d332(0x518)],'secondaryProxyUrl':document[_0x52d332(0x8c2)]('secondary-proxy-url')[_0x52d332(0x518)][_0x52d332(0x8c6)](),'secondaryApiKey':document['getElementById']('secondary-api-key')[_0x52d332(0x518)][_0x52d332(0x8c6)](),'secondaryModel':document[_0x52d332(0x8c2)](_0x52d332(0x6df))[_0x52d332(0x518)],'minimaxGroupId':document[_0x52d332(0x8c2)](_0x52d332(0x483))[_0x52d332(0x518)][_0x52d332(0x8c6)](),'minimaxApiKey':document[_0x52d332(0x8c2)](_0x52d332(0x7c5))['value'][_0x52d332(0x8c6)](),'minimaxModel':document[_0x52d332(0x8c2)](_0x52d332(0xdd7))[_0x52d332(0x518)]},_0x1f0271=await _0x15043e['apiPresets']['where'](_0x52d332(0x596))[_0x52d332(0xc9a)](_0x2a683d[_0x52d332(0x596)])[_0x52d332(0xf2e)]();if(_0x1f0271){const _0x52b287=await _0x8b9cb8('覆盖预设',_0x52d332(0xdbf)+_0x2a683d[_0x52d332(0x596)]+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':_0x52d332(0xe2a)});if(!_0x52b287)return;_0x2a683d['id']=_0x1f0271['id'];}await _0x15043e['apiPresets'][_0x52d332(0xfaa)](_0x2a683d),await _0x18986a(),alert(_0x52d332(0xeac));}async function _0x2d4563(){const _0x9689c3=_0x18b51e,_0xf44671=document[_0x9689c3(0x8c2)](_0x9689c3(0x826)),_0x5bc4d2=parseInt(_0xf44671[_0x9689c3(0x518)]);if(isNaN(_0x5bc4d2)){alert(_0x9689c3(0x1264));return;}const _0x4defc3=await _0x15043e[_0x9689c3(0xd8f)]['get'](_0x5bc4d2);if(!_0x4defc3)return;const _0x916160=await _0x8b9cb8(_0x9689c3(0x1c8),_0x9689c3(0x10b0)+_0x4defc3[_0x9689c3(0x596)]+_0x9689c3(0x119f),{'confirmButtonClass':_0x9689c3(0xe2a)});_0x916160&&(await _0x15043e[_0x9689c3(0xd8f)]['delete'](_0x5bc4d2),await _0x18986a(),alert(_0x9689c3(0x1b5)));}function _0x4fa943(){const _0x52f4d0=_0x18b51e;document[_0x52f4d0(0x8c2)](_0x52f4d0(0xffa))[_0x52f4d0(0x518)]=_0x405767[_0x52f4d0(0x9e0)][_0x52f4d0(0x34e)]||'',document['getElementById']('api-key')['value']=_0x405767[_0x52f4d0(0x9e0)][_0x52f4d0(0x827)]||'',document['getElementById'](_0x52f4d0(0x27a))[_0x52f4d0(0x518)]=_0x405767[_0x52f4d0(0x9e0)][_0x52f4d0(0x2fa)]||'',document[_0x52f4d0(0x8c2)]('secondary-api-key')[_0x52f4d0(0x518)]=_0x405767[_0x52f4d0(0x9e0)][_0x52f4d0(0x107f)]||'',document[_0x52f4d0(0x8c2)](_0x52f4d0(0x10e5))[_0x52f4d0(0x75f)]=_0x405767[_0x52f4d0(0xb73)]['enableBackgroundActivity']||![],document[_0x52f4d0(0x8c2)](_0x52f4d0(0x839))[_0x52f4d0(0x518)]=_0x405767['globalSettings'][_0x52f4d0(0x945)]||0x3c,document[_0x52f4d0(0x8c2)]('block-cooldown-input')[_0x52f4d0(0x518)]=_0x405767[_0x52f4d0(0xb73)][_0x52f4d0(0x11a1)]||0x1,document[_0x52f4d0(0x8c2)](_0x52f4d0(0xded))[_0x52f4d0(0x75f)]=_0x405767[_0x52f4d0(0xb73)][_0x52f4d0(0xd00)],document[_0x52f4d0(0x8c2)](_0x52f4d0(0xb33))['value']=_0x405767[_0x52f4d0(0xb73)][_0x52f4d0(0x3dd)]||0x32,document[_0x52f4d0(0x8c2)](_0x52f4d0(0x256))[_0x52f4d0(0x518)]=_0x405767[_0x52f4d0(0xb73)][_0x52f4d0(0x743)]||0x1e;const _0x271cdc=document[_0x52f4d0(0x8c2)](_0x52f4d0(0x50f)),_0x5602ee=document[_0x52f4d0(0x8c2)](_0x52f4d0(0xc57)),_0x4ab2c5=_0x405767['globalSettings'][_0x52f4d0(0x8c7)]||0.8;_0x271cdc[_0x52f4d0(0x518)]=_0x4ab2c5,_0x5602ee['textContent']=_0x4ab2c5,document[_0x52f4d0(0x8c2)]('minimax-group-id')['value']=_0x405767[_0x52f4d0(0x9e0)][_0x52f4d0(0xa7d)]||'',document[_0x52f4d0(0x8c2)](_0x52f4d0(0x7c5))[_0x52f4d0(0x518)]=_0x405767[_0x52f4d0(0x9e0)][_0x52f4d0(0x971)]||'',document['getElementById']('minimax-model-select')[_0x52f4d0(0x518)]=_0x405767[_0x52f4d0(0x9e0)][_0x52f4d0(0x68f)]||'speech-01',_0x18986a();}window['renderApiSettingsProxy']=_0x4fa943;async function _0x28d18c(){const _0x290f25=_0x18b51e,_0x325f22=document['getElementById']('npc-list');_0x325f22[_0x290f25(0xca0)]='';const _0x2b6fed=await _0x15043e[_0x290f25(0xa4a)][_0x290f25(0x6be)]();if(_0x2b6fed[_0x290f25(0x105a)]===0x0){_0x325f22[_0x290f25(0xca0)]=_0x290f25(0x326);return;}_0x2b6fed[_0x290f25(0x7c0)](_0x19a5b7=>{const _0x4b2cbd=_0x290f25,_0x531ecb=document[_0x4b2cbd(0x8c1)]('div');_0x531ecb[_0x4b2cbd(0x84c)]=_0x4b2cbd(0x441),_0x531ecb[_0x4b2cbd(0x323)][_0x4b2cbd(0x91a)]=_0x19a5b7['id'],_0x531ecb[_0x4b2cbd(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x19a5b7[_0x4b2cbd(0x1e1)]||_0x9fdc61)+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x19a5b7['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>'+_0x19a5b7[_0x4b2cbd(0x391)][_0x4b2cbd(0x599)](0x0,0x1e)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x531ecb[_0x4b2cbd(0xae8)](_0x4b2cbd(0xa17),()=>_0x2a7a98(_0x19a5b7['id'])),_0x5dcbd7(_0x531ecb,async()=>{await _0x5ebd7d(_0x19a5b7['id']);}),_0x325f22['appendChild'](_0x531ecb);});}async function _0x2a7a98(_0x10ab4c=null){const _0x2e66bb=_0x18b51e;editingNpcId=_0x10ab4c;const _0x55c147=document[_0x2e66bb(0x8c2)](_0x2e66bb(0x123e)),_0x20dbe0=document[_0x2e66bb(0x8c2)]('npc-editor-title'),_0x52d14b=document['getElementById']('npc-name-input'),_0x35e937=document[_0x2e66bb(0x8c2)](_0x2e66bb(0xbf0)),_0x44826e=document['getElementById']('npc-avatar-preview'),_0x314e8c=document['getElementById']('npc-association-list'),_0x347aaa=document[_0x2e66bb(0x8c2)](_0x2e66bb(0x687)),_0x2a95c6=document['getElementById'](_0x2e66bb(0xdc6));_0x314e8c['innerHTML']='',_0x314e8c['innerHTML']+='<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20'+(_0x405767[_0x2e66bb(0x20a)][_0x2e66bb(0xab3)]||'我')+'\x20(用户)</label>',Object[_0x2e66bb(0x22f)](_0x405767[_0x2e66bb(0x799)])[_0x2e66bb(0x1d8)](_0x3ed586=>!_0x3ed586['isGroup'])[_0x2e66bb(0x7c0)](_0x2c0b70=>{const _0x212df9=_0x2e66bb;_0x314e8c[_0x212df9(0xca0)]+=_0x212df9(0x311)+_0x2c0b70['id']+'\x22>\x20'+_0x2c0b70[_0x212df9(0x596)]+_0x212df9(0xf5f);});if(_0x10ab4c){_0x20dbe0[_0x2e66bb(0x1090)]=_0x2e66bb(0x9b4);const _0x42780d=await _0x15043e[_0x2e66bb(0xa4a)][_0x2e66bb(0x3e9)](_0x10ab4c);_0x42780d&&(_0x52d14b[_0x2e66bb(0x518)]=_0x42780d[_0x2e66bb(0x596)],_0x35e937['value']=_0x42780d[_0x2e66bb(0x391)],_0x44826e['src']=_0x42780d['avatar']||_0x9fdc61,_0x347aaa[_0x2e66bb(0x75f)]=_0x42780d[_0x2e66bb(0x105d)]!==![],_0x2a95c6[_0x2e66bb(0x518)]=_0x42780d[_0x2e66bb(0x107e)]||0xf,_0x42780d[_0x2e66bb(0xc9d)]&&Array[_0x2e66bb(0xb85)](_0x42780d[_0x2e66bb(0xc9d)])&&_0x42780d['associatedWith'][_0x2e66bb(0x7c0)](_0x5d5b7e=>{const _0x3f0785=_0x2e66bb,_0x4cca0c=_0x314e8c[_0x3f0785(0x1ad)](_0x3f0785(0xf30)+_0x5d5b7e+'\x22]');if(_0x4cca0c)_0x4cca0c[_0x3f0785(0x75f)]=!![];}));}else{_0x20dbe0[_0x2e66bb(0x1090)]=_0x2e66bb(0xfc6),_0x52d14b[_0x2e66bb(0x518)]='',_0x35e937[_0x2e66bb(0x518)]='',_0x44826e[_0x2e66bb(0x939)]=_0x9fdc61,_0x347aaa['checked']=!![],_0x2a95c6[_0x2e66bb(0x518)]=0xf;const _0x42da40=_0x314e8c[_0x2e66bb(0x1ad)]('input[value=\x22user\x22]');if(_0x42da40)_0x42da40['checked']=!![];}_0x55c147['classList'][_0x2e66bb(0x3f4)]('visible');}async function _0x4031f2(){const _0x336c4a=_0x18b51e,_0x583ceb=document[_0x336c4a(0x8c2)](_0x336c4a(0x8b8))[_0x336c4a(0x518)][_0x336c4a(0x8c6)](),_0x11de5e=document[_0x336c4a(0x8c2)]('npc-persona-input')['value']['trim']();if(!_0x583ceb||!_0x11de5e){alert('NPC的昵称和人设都不能为空！');return;}const _0xf83ba7=Array[_0x336c4a(0x51a)](document['querySelectorAll'](_0x336c4a(0xac2)))[_0x336c4a(0x6b9)](_0x4d924f=>_0x4d924f[_0x336c4a(0x518)]),_0x22b938=document[_0x336c4a(0x8c2)]('npc-background-activity-switch')[_0x336c4a(0x75f)],_0x444f49=parseInt(document[_0x336c4a(0x8c2)](_0x336c4a(0xdc6))[_0x336c4a(0x518)])||0xf,_0x1ec4b7={'name':_0x583ceb,'persona':_0x11de5e,'avatar':document[_0x336c4a(0x8c2)](_0x336c4a(0xb54))[_0x336c4a(0x939)],'associatedWith':_0xf83ba7,'enableBackgroundActivity':_0x22b938,'actionCooldownMinutes':_0x444f49};if(editingNpcId)await _0x15043e['npcs'][_0x336c4a(0xb7c)](editingNpcId,_0x1ec4b7);else{const _0x134464=await _0x15043e['npcs'][_0x336c4a(0x3f4)](_0x1ec4b7);if(_0x2db465&&_0x405767[_0x336c4a(0x248)]){const _0x560b4d=_0x405767[_0x336c4a(0x799)][_0x405767[_0x336c4a(0x248)]];_0x560b4d[_0x336c4a(0x1000)]&&(_0x560b4d['members'][_0x336c4a(0xa49)]({'id':_0x336c4a(0x5ea)+_0x134464,'originalName':_0x583ceb,'groupNickname':_0x583ceb,'persona':_0x11de5e,'avatar':_0x1ec4b7['avatar'],'isNpc':!![]}),await _0x15043e[_0x336c4a(0x799)][_0x336c4a(0xfaa)](_0x560b4d));}}document[_0x336c4a(0x8c2)](_0x336c4a(0x123e))[_0x336c4a(0xb17)][_0x336c4a(0xaff)](_0x336c4a(0x2cd)),_0x2db465?(_0x2db465=![],_0x9f9279()):await _0x28d18c();}async function _0x5ebd7d(_0x5bd570){const _0x3fba4d=_0x18b51e,_0x57f8ef=await _0x15043e[_0x3fba4d(0xa4a)][_0x3fba4d(0x3e9)](_0x5bd570);if(!_0x57f8ef)return;const _0x466eed=await _0x8b9cb8('删除NPC',_0x3fba4d(0x4a7)+_0x57f8ef[_0x3fba4d(0x596)]+'”\x20吗？',{'confirmButtonClass':_0x3fba4d(0xe2a)});_0x466eed&&(await _0x15043e[_0x3fba4d(0xa4a)][_0x3fba4d(0x89f)](_0x5bd570),await _0x28d18c());}let _0x10e3dd=0x0;function _0xc2c428(_0x27dd22){const _0x3ddf43=_0x18b51e,_0x53d26c=document[_0x3ddf43(0x8c1)](_0x3ddf43(0x1072));return _0x53d26c[_0x3ddf43(0x84c)]=_0x3ddf43(0x1039),_0x53d26c[_0x3ddf43(0xca0)]=_0x3ddf43(0x25e)+_0x27dd22[_0x3ddf43(0x596)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20',_0x53d26c;}function _0x330f15(_0x1e344f){const _0x22d813=_0x18b51e,_0x4c1ab3=document[_0x22d813(0x8c2)](_0x22d813(0xaab)),_0x318780=document[_0x22d813(0x8c2)](_0x22d813(0x4f9));if(_0x318780)_0x318780[_0x22d813(0xaff)]();const _0x5ed839=_0x10e3dd,_0x15d007=_0x10e3dd+CHAT_LIST_RENDER_WINDOW,_0x40b7cd=_0x1e344f[_0x22d813(0x961)](_0x5ed839,_0x15d007),_0x3206ec=document['createDocumentFragment']();let _0x305c01=_0x4c1ab3[_0x22d813(0x1ad)]('.chat-group-content:last-of-type');_0x40b7cd['forEach'](_0x1239d6=>{const _0x37e4cd=_0x22d813;if(_0x1239d6['type']===_0x37e4cd(0x11b8)){const _0x1c8447=_0xc2c428(_0x1239d6[_0x37e4cd(0x92f)]);_0x3206ec[_0x37e4cd(0x31e)](_0x1c8447),_0x305c01=_0x1c8447['querySelector'](_0x37e4cd(0x49b));}else{if(_0x1239d6[_0x37e4cd(0xde0)]==='chatItem'){const _0x5d3409=_0x13c0f2(_0x1239d6[_0x37e4cd(0x6d4)]);_0x305c01&&_0x1239d6[_0x37e4cd(0x6d4)][_0x37e4cd(0x40f)]?_0x305c01[_0x37e4cd(0x31e)](_0x5d3409):(_0x3206ec[_0x37e4cd(0x31e)](_0x5d3409),_0x305c01=null);}}}),_0x4c1ab3[_0x22d813(0x31e)](_0x3206ec),_0x10e3dd+=_0x40b7cd[_0x22d813(0x105a)],_0x1e344f[_0x22d813(0x105a)]>_0x10e3dd&&_0x4952b7(_0x4c1ab3,_0x1e344f),document[_0x22d813(0xa2d)](_0x22d813(0xffb))[_0x22d813(0x7c0)](_0x2b707f=>{const _0x56f9e8=_0x22d813,_0x235628=_0x2b707f[_0x56f9e8(0xac5)](!![]);_0x2b707f[_0x56f9e8(0xe66)][_0x56f9e8(0x56b)](_0x235628,_0x2b707f),_0x235628[_0x56f9e8(0xae8)](_0x56f9e8(0xa17),()=>{const _0x5dcc1b=_0x56f9e8;_0x235628[_0x5dcc1b(0xb17)][_0x5dcc1b(0xfc3)]('collapsed'),_0x235628[_0x5dcc1b(0x70b)][_0x5dcc1b(0xb17)][_0x5dcc1b(0xfc3)](_0x5dcc1b(0x986));});});}async function _0x2b55d1(){const _0x338394=_0x18b51e,_0x4b8439=document[_0x338394(0x8c2)](_0x338394(0xaab));_0x4b8439[_0x338394(0xca0)]='';const _0x1931d7=Object[_0x338394(0x22f)](_0x405767[_0x338394(0x799)])[_0x338394(0xa19)]((_0x18785b,_0x2b41df)=>{const _0x171079=_0x338394,_0x49e2f1=(_0x2b41df['isPinned']||![])-(_0x18785b[_0x171079(0xe06)]||![]);if(_0x49e2f1!==0x0)return _0x49e2f1;return(_0x2b41df[_0x171079(0xd39)][_0x171079(0x961)](-0x1)[0x0]?.[_0x171079(0x351)]||0x0)-(_0x18785b['history'][_0x171079(0x961)](-0x1)[0x0]?.[_0x171079(0x351)]||0x0);}),_0xdb82eb=await _0x15043e['qzoneGroups'][_0x338394(0x6be)]();if(_0x1931d7[_0x338394(0x105a)]===0x0){_0x4b8439[_0x338394(0xca0)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>';return;}_0xdb82eb[_0x338394(0x7c0)](_0x3d2b8c=>{const _0x14921a=_0x338394,_0x1a1272=_0x1931d7[_0x14921a(0x2ef)](_0x173c82=>_0x173c82[_0x14921a(0x40f)]===_0x3d2b8c['id']);_0x3d2b8c[_0x14921a(0x11aa)]=_0x1a1272?_0x1a1272[_0x14921a(0xd39)][_0x14921a(0x961)](-0x1)[0x0]?.[_0x14921a(0x351)]||0x0:0x0;}),_0xdb82eb['sort']((_0x3c1997,_0x265b28)=>_0x265b28[_0x338394(0x11aa)]-_0x3c1997[_0x338394(0x11aa)]),_0x2e87a6=[];const _0x35f5e0=new Set();_0xdb82eb[_0x338394(0x7c0)](_0x503aa9=>{const _0x11cdf3=_0x338394,_0x585fb8=_0x1931d7[_0x11cdf3(0x1d8)](_0x10511f=>!_0x10511f[_0x11cdf3(0x1000)]&&_0x10511f[_0x11cdf3(0x40f)]===_0x503aa9['id']);_0x585fb8[_0x11cdf3(0x105a)]>0x0&&(_0x2e87a6[_0x11cdf3(0xa49)]({'type':_0x11cdf3(0x11b8),'group':_0x503aa9}),_0x585fb8['forEach'](_0x47ba67=>{const _0x385a3f=_0x11cdf3;_0x2e87a6[_0x385a3f(0xa49)]({'type':_0x385a3f(0x231),'chat':_0x47ba67}),_0x35f5e0[_0x385a3f(0x3f4)](_0x47ba67['id']);}));}),_0x1931d7['forEach'](_0x5e91da=>{const _0x57dd24=_0x338394;!_0x35f5e0[_0x57dd24(0x11ac)](_0x5e91da['id'])&&_0x2e87a6[_0x57dd24(0xa49)]({'type':_0x57dd24(0x231),'chat':_0x5e91da});}),_0x10e3dd=0x0,_0x330f15();}function _0xc2c428(_0x18f7d){const _0x9438f2=_0x18b51e,_0x36c06b=document['createElement']('div');return _0x36c06b[_0x9438f2(0x84c)]=_0x9438f2(0x1039),_0x36c06b[_0x9438f2(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x18f7d['name']+_0x9438f2(0x4d8),_0x36c06b;}function _0x4952b7(_0x15bee4,_0x3289d0){const _0x4919b5=_0x18b51e,_0x4c901f=document[_0x4919b5(0x8c1)](_0x4919b5(0x19a));_0x4c901f['id']=_0x4919b5(0x4f9),_0x4c901f[_0x4919b5(0x1090)]='加载更早的会话',_0x4c901f[_0x4919b5(0x84c)]=_0x4919b5(0x4ce),_0x4c901f['addEventListener'](_0x4919b5(0xa17),()=>_0x330f15(_0x3289d0),{'once':!![]}),_0x15bee4[_0x4919b5(0x1ba)](_0x4c901f);}function _0x330f15(){const _0x17a941=_0x18b51e;if(_0x5314bd)return;const _0x421dc4=document[_0x17a941(0x8c2)](_0x17a941(0xaab)),_0x243855=document[_0x17a941(0x8c2)](_0x17a941(0x4a1));if(!_0x421dc4||!_0x243855)return;if(_0x10e3dd>=_0x2e87a6['length'])return;_0x5314bd=!![];const _0x682d98=_0x10e3dd===0x0,_0x5039f1=()=>{const _0x8bc6a2=_0x17a941;_0x45f5dc(_0x421dc4);const _0x4cdfd1=_0x405767[_0x8bc6a2(0xb73)]['chatListRenderWindow']||0x1e,_0x3c068a=_0x10e3dd,_0x158b78=_0x10e3dd+_0x4cdfd1,_0xdf3d5a=_0x2e87a6[_0x8bc6a2(0x961)](_0x3c068a,_0x158b78),_0x515778=document[_0x8bc6a2(0xc8e)]();let _0x4f2bcb=_0x421dc4[_0x8bc6a2(0x1ad)]('.chat-group-content:last-of-type');_0xdf3d5a[_0x8bc6a2(0x7c0)](_0x2f2843=>{const _0x354511=_0x8bc6a2;if(_0x2f2843[_0x354511(0xde0)]==='groupHeader'){const _0x41c8aa=_0xc2c428(_0x2f2843['group']);_0x515778[_0x354511(0x31e)](_0x41c8aa),_0x4f2bcb=_0x41c8aa[_0x354511(0x1ad)](_0x354511(0x49b));}else{if(_0x2f2843[_0x354511(0xde0)]==='chatItem'){const _0x13e7f3=_0x13c0f2(_0x2f2843[_0x354511(0x6d4)]);if(_0x2f2843[_0x354511(0x6d4)][_0x354511(0x40f)]&&_0x4f2bcb)_0x4f2bcb[_0x354511(0x31e)](_0x13e7f3);else{_0x515778[_0x354511(0x31e)](_0x13e7f3);if(!_0x2f2843['chat'][_0x354511(0x40f)])_0x4f2bcb=null;}}}}),_0x421dc4[_0x8bc6a2(0x31e)](_0x515778),_0x10e3dd+=_0xdf3d5a[_0x8bc6a2(0x105a)],_0x421dc4['querySelectorAll'](_0x8bc6a2(0xad5))[_0x8bc6a2(0x7c0)](_0x20cd21=>{const _0x524997=_0x8bc6a2;_0x20cd21['dataset'][_0x524997(0x37d)]='true',_0x20cd21[_0x524997(0xae8)]('click',()=>{const _0x63351c=_0x524997;_0x20cd21[_0x63351c(0xb17)][_0x63351c(0xfc3)](_0x63351c(0x986)),_0x20cd21[_0x63351c(0x70b)][_0x63351c(0xb17)]['toggle'](_0x63351c(0x986));});}),_0x5314bd=![],_0x243855[_0x8bc6a2(0xb43)]<=_0x243855[_0x8bc6a2(0x7b3)]&&_0x10e3dd<_0x2e87a6['length']&&_0x330f15();};_0x682d98?_0x5039f1():(_0x21c28a(_0x421dc4,_0x17a941(0xf2b)),setTimeout(_0x5039f1,0x1f4));}function _0x13c0f2(_0x51e6a4){const _0x54f66a=_0x18b51e;try{const _0x4fcd66=_0x51e6a4[_0x54f66a(0xd39)][_0x54f66a(0x1d8)](_0x1f50f4=>!_0x1f50f4[_0x54f66a(0x3f1)])[_0x54f66a(0x961)](-0x1)[0x0]||{};let _0x59d135;if(!_0x51e6a4[_0x54f66a(0x1000)]&&_0x51e6a4['relationship']?.[_0x54f66a(0x8c8)]===_0x54f66a(0xd87))_0x59d135=_0x54f66a(0xeb1)+(_0x51e6a4[_0x54f66a(0x944)]['applicationReason']||_0x54f66a(0xc05))+_0x54f66a(0x688);else{if(!_0x51e6a4[_0x54f66a(0x1000)]&&_0x51e6a4['relationship']?.[_0x54f66a(0x8c8)]==='blocked_by_ai')_0x59d135=_0x54f66a(0xabf);else{if(_0x51e6a4[_0x54f66a(0x1000)]){if(_0x4fcd66[_0x54f66a(0xde0)]===_0x54f66a(0x6f1))_0x59d135=_0x54f66a(0x995)+_0x4fcd66[_0x54f66a(0x168)];else{if(_0x4fcd66[_0x54f66a(0xde0)]===_0x54f66a(0x11b9))_0x59d135='[转账]';else{if(_0x4fcd66['type']===_0x54f66a(0x7c8)||_0x4fcd66[_0x54f66a(0xde0)]===_0x54f66a(0x223))_0x59d135=_0x54f66a(0x69d);else{if(_0x4fcd66[_0x54f66a(0xde0)]===_0x54f66a(0xf64))_0x59d135=_0x54f66a(0xa7c);else{if(typeof _0x4fcd66[_0x54f66a(0x168)]==='string'&&_0x3ba794[_0x54f66a(0x696)](_0x4fcd66['content']))_0x59d135=_0x4fcd66[_0x54f66a(0x2b7)]?_0x54f66a(0x7c9)+_0x4fcd66[_0x54f66a(0x2b7)]+']':_0x54f66a(0x1223);else Array[_0x54f66a(0xb85)](_0x4fcd66[_0x54f66a(0x168)])?_0x59d135=_0x54f66a(0xcb0):_0x59d135=String(_0x4fcd66[_0x54f66a(0x168)]||'...')[_0x54f66a(0x599)](0x0,0x14);}}}}if(_0x4fcd66['senderName']&&_0x4fcd66[_0x54f66a(0xde0)]!==_0x54f66a(0x6f1)){const _0x24ae19=_0x1ba34a(_0x51e6a4,_0x4fcd66['senderName']);_0x59d135=_0x24ae19+':\x20'+_0x59d135;}}else{const _0x49c002=_0x51e6a4['status']?.[_0x54f66a(0xbc6)]||'在线';_0x59d135='['+_0x49c002+']';}}}const _0x329533=document[_0x54f66a(0x8c1)]('div');_0x329533[_0x54f66a(0x84c)]=_0x54f66a(0x441),_0x329533[_0x54f66a(0x323)]['chatId']=_0x51e6a4['id'];_0x51e6a4['isPinned']&&_0x329533[_0x54f66a(0xb17)][_0x54f66a(0x3f4)](_0x54f66a(0x369));const _0xfe77b5=_0x51e6a4[_0x54f66a(0x1000)]?_0x51e6a4[_0x54f66a(0x33a)][_0x54f66a(0x43b)]:_0x51e6a4[_0x54f66a(0x33a)][_0x54f66a(0x44e)],_0x4beae1=_0x51e6a4[_0x54f66a(0x1000)]?'':_0x51e6a4[_0x54f66a(0x33a)]['aiAvatarFrame']||'';let _0x47cedb;_0x4beae1?_0x47cedb=_0x54f66a(0xb08)+(_0xfe77b5||_0x49d2a4)+_0x54f66a(0x833)+_0x4beae1+_0x54f66a(0x1d2):_0x47cedb=_0x54f66a(0x333)+(_0xfe77b5||_0x49d2a4)+_0x54f66a(0x2b8);const _0x530fde=_0x4beae1?_0x54f66a(0x8b5):'',_0x577fda=_0x54f66a(0x10df)+_0x530fde+'\x22>'+_0x47cedb+_0x54f66a(0x1079);_0x329533['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x577fda+_0x54f66a(0x76b)+_0x51e6a4[_0x54f66a(0x596)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x51e6a4[_0x54f66a(0x1000)]?_0x54f66a(0xee3):'')+_0x54f66a(0x105c)+(_0x51e6a4[_0x54f66a(0x1000)]?_0x54f66a(0xf69):_0x54f66a(0x615))+';\x20font-style:\x20italic;\x22>'+_0x59d135+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x38fcb8=_0x51e6a4[_0x54f66a(0xf10)]||0x0,_0x5f0b6b=_0x329533[_0x54f66a(0x1ad)]('.unread-count');_0x38fcb8>0x0?(_0x5f0b6b[_0x54f66a(0x1090)]=_0x38fcb8>0x63?'99+':_0x38fcb8,_0x5f0b6b[_0x54f66a(0x842)][_0x54f66a(0x5e9)]=_0x54f66a(0x1206)):_0x5f0b6b[_0x54f66a(0x842)][_0x54f66a(0x5e9)]=_0x54f66a(0xbf8);const _0x4a0b80=_0x329533[_0x54f66a(0x1ad)](_0x54f66a(0x1034));_0x4a0b80&&(_0x4a0b80[_0x54f66a(0x842)]['cursor']=_0x54f66a(0x630),_0x4a0b80[_0x54f66a(0xae8)](_0x54f66a(0x39e),_0x528ebc=>{const _0x54c274=_0x54f66a;_0x528ebc[_0x54c274(0x601)]();const _0x3e12da=_0x51e6a4[_0x54c274(0x1000)]?_0x51e6a4[_0x54c274(0x596)]:_0x51e6a4[_0x54c274(0x4e7)];_0x4803c2(_0x51e6a4['id'],_0x3e12da);}));const _0x50e2d8=_0x329533['querySelector'](_0x54f66a(0x975));return _0x50e2d8&&_0x50e2d8[_0x54f66a(0xae8)](_0x54f66a(0xa17),()=>_0x426b8d(_0x51e6a4['id'])),_0x5dcbd7(_0x329533,async _0x57ccf4=>{const _0x1d60da=_0x54f66a,_0x4314e3=await _0x2f7db0(_0x51e6a4);switch(_0x4314e3){case'pin':_0x51e6a4[_0x1d60da(0xe06)]=!_0x51e6a4[_0x1d60da(0xe06)],await _0x15043e[_0x1d60da(0x799)][_0x1d60da(0xfaa)](_0x51e6a4),_0x2b55d1();break;case _0x1d60da(0x89f):const _0x3ef90f=await _0x8b9cb8(_0x1d60da(0x1261),_0x1d60da(0x679)+_0x51e6a4[_0x1d60da(0x596)]+_0x1d60da(0x59d),{'confirmButtonClass':'btn-danger'});if(_0x3ef90f){_0x4a77e1[_0x1d60da(0x6f0)]&&_0x4a77e1['activeChatId']===_0x51e6a4['id']&&await _0x221338(![]);delete _0x405767['chats'][_0x51e6a4['id']];if(_0x405767[_0x1d60da(0x248)]===_0x51e6a4['id'])_0x405767[_0x1d60da(0x248)]=null;await _0x15043e[_0x1d60da(0x799)][_0x1d60da(0x89f)](_0x51e6a4['id']),_0x2b55d1();}break;default:break;}}),_0x329533;}catch(_0x214065){return console[_0x54f66a(0x7a3)](_0x54f66a(0x5fc)+(_0x51e6a4[_0x54f66a(0x596)]||'未知')+_0x54f66a(0x3ea)+_0x51e6a4['id']+_0x54f66a(0xae5),_0x214065),null;}}async function _0x7dbe71(_0x36cdef){const _0x57b045=_0x18b51e;_0x249d78(),_0x579bb3();const _0x5e911a=_0x405767[_0x57b045(0x799)][_0x36cdef];if(!_0x5e911a)return;_0x23ba0c();const _0x47a59d=document[_0x57b045(0x8c2)](_0x57b045(0xb24)),_0x1a51ff=document[_0x57b045(0x8c2)]('chat-input-area'),_0x38d764=document[_0x57b045(0x8c2)](_0x57b045(0x106c)),_0x48b983=document[_0x57b045(0x8c2)](_0x57b045(0x54c));_0x47a59d[_0x57b045(0x323)][_0x57b045(0xf95)]=_0x5e911a[_0x57b045(0x33a)]['theme']||_0x57b045(0x674);const _0x133f1d=_0x5e911a[_0x57b045(0x33a)]['fontSize']||0xd;_0x47a59d['style'][_0x57b045(0xbe0)](_0x57b045(0x1217),_0x133f1d+'px'),_0x51f7b6(_0x5e911a[_0x57b045(0x33a)][_0x57b045(0x105f)]||'',_0x57b045(0x10bc),_0x57b045(0x1fd)),document['getElementById'](_0x57b045(0x334))['textContent']=_0x5e911a[_0x57b045(0x596)];const _0xf7f35d=document[_0x57b045(0x8c2)](_0x57b045(0x66c)),_0x583cae=_0xf7f35d[_0x57b045(0x1ad)](_0x57b045(0x11e6));_0x5e911a['isGroup']?(_0xf7f35d[_0x57b045(0x842)]['display']=_0x57b045(0xbf8),document[_0x57b045(0x8c2)](_0x57b045(0xf61))[_0x57b045(0x842)]['justifyContent']=_0x57b045(0x65d)):(_0xf7f35d[_0x57b045(0x842)][_0x57b045(0x5e9)]=_0x57b045(0xd52),document['getElementById'](_0x57b045(0xf61))[_0x57b045(0x842)][_0x57b045(0x1189)]=_0x57b045(0xcbc),_0x583cae[_0x57b045(0x1090)]=_0x5e911a[_0x57b045(0x8c8)]?.[_0x57b045(0xbc6)]||'在线',_0xf7f35d['classList']['toggle'](_0x57b045(0xbd6),_0x5e911a[_0x57b045(0x8c8)]?.['isBusy']||![]));const _0x288c04=document[_0x57b045(0x8c2)](_0x57b045(0xd5c)),_0x26440f=_0x5e911a[_0x57b045(0x33a)][_0x57b045(0x812)],_0x909c4=_0x405767['globalSettings'][_0x57b045(0xdea)],_0x43eae5=document['getElementById'](_0x57b045(0x5e7))[_0x57b045(0xb17)][_0x57b045(0x795)](_0x57b045(0x8e7)),_0x14e773=_0x43eae5?_0x57b045(0x576):'#f0f2f5';if(_0x26440f)_0x288c04[_0x57b045(0x842)]['backgroundImage']=_0x57b045(0x116b)+_0x26440f+')',_0x288c04[_0x57b045(0x842)][_0x57b045(0x617)]=_0x57b045(0xdc5);else _0x909c4?(_0x288c04[_0x57b045(0x842)][_0x57b045(0xfff)]=_0x57b045(0x116b)+_0x909c4+')',_0x288c04['style']['backgroundColor']=_0x57b045(0xdc5)):(_0x288c04['style'][_0x57b045(0xfff)]=_0x57b045(0xbf8),_0x288c04[_0x57b045(0x842)][_0x57b045(0x617)]=_0x14e773);if(_0x5e911a[_0x57b045(0xf59)])_0x1a51ff['style'][_0x57b045(0x5e9)]='none',_0x38d764[_0x57b045(0x842)]['display']=_0x57b045(0xd52),_0x48b983[_0x57b045(0xca0)]=_0x57b045(0x3b6),document[_0x57b045(0x8c2)](_0x57b045(0x13a))['onclick']=_0x52aced;else{_0x1a51ff[_0x57b045(0x842)][_0x57b045(0x5e9)]=_0x57b045(0xd52),_0x38d764[_0x57b045(0x842)][_0x57b045(0x5e9)]=_0x57b045(0xbf8),_0x48b983[_0x57b045(0xca0)]='';if(!_0x5e911a[_0x57b045(0x1000)]&&_0x5e911a[_0x57b045(0x944)][_0x57b045(0x8c8)]!==_0x57b045(0xaa7)){_0x38d764[_0x57b045(0x842)][_0x57b045(0x5e9)]=_0x57b045(0xd52),_0x1a51ff['style'][_0x57b045(0xcd3)]=_0x57b045(0xbe3);let _0x1d2a83='';switch(_0x5e911a['relationship']['status']){case _0x57b045(0x1e6):const _0x376ece=_0x57a066!==null,_0x21c5f7=_0x5e911a[_0x57b045(0x944)][_0x57b045(0x42a)],_0x21c1ad=_0x405767[_0x57b045(0xb73)][_0x57b045(0x11a1)]||0x1,_0x3da48e=_0x21c1ad*0x3c*0x3c*0x3e8,_0x588097=Date[_0x57b045(0x1ed)]()-_0x21c5f7,_0x219c1f=_0x588097>_0x3da48e,_0x185843=Math[_0x57b045(0x171)](0x0,Math[_0x57b045(0xf93)]((_0x3da48e-_0x588097)/(0x3e8*0x3c)));_0x1d2a83=_0x57b045(0xc14)+_0x5e911a[_0x57b045(0x596)]+_0x57b045(0x1124)+(_0x405767[_0x57b045(0xb73)][_0x57b045(0x105d)]?_0x57b045(0x11a8):_0x57b045(0xc48))+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20'+(_0x376ece?_0x57b045(0xa4f):_0x57b045(0x13b))+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>'+_0x5e911a[_0x57b045(0x944)]['status']+_0x57b045(0xa86)+_0x21c1ad+'</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20'+(_0x219c1f?_0x57b045(0x476):_0x57b045(0xfc2)+_0x185843+_0x57b045(0x406))+_0x57b045(0x402)+(_0x219c1f&&_0x405767['globalSettings'][_0x57b045(0x105d)]?'<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>':'<span\x20style=\x22color:\x20red;\x22>未满足</span>')+_0x57b045(0x625);break;case _0x57b045(0x1058):_0x1d2a83=_0x57b045(0x220);break;case _0x57b045(0xd87):_0x1d2a83=_0x57b045(0x1113)+_0x5e911a['name']+_0x57b045(0xd44)+_0x5e911a['relationship'][_0x57b045(0x727)]+'”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';break;case _0x57b045(0x10b6):_0x1d2a83=_0x57b045(0xd97);break;}_0x48b983[_0x57b045(0xca0)]=_0x1d2a83;}else _0x38d764[_0x57b045(0x842)][_0x57b045(0x5e9)]=_0x57b045(0xbf8),_0x1a51ff[_0x57b045(0x842)][_0x57b045(0xcd3)]=_0x57b045(0x2cd);}_0x47a59d['innerHTML']='';const _0x48c1ce=_0x5e911a[_0x57b045(0xd39)];_0x5ea6d4=0x0;const _0x1a7d62=_0x405767[_0x57b045(0xb73)][_0x57b045(0x3dd)]||0x32,_0x40b848=_0x48c1ce[_0x57b045(0x961)](-_0x1a7d62),_0x5c6ada=[];let _0x15d2dc=0x0;for(const _0x2de1fa of _0x40b848){_0x15d2dc>0x0&&_0x2de1fa[_0x57b045(0x351)]-_0x15d2dc>0x927c0&&_0x5c6ada[_0x57b045(0xa49)](Promise[_0x57b045(0xb7e)](_0x436749(_0x2de1fa['timestamp']))),_0x5c6ada[_0x57b045(0xa49)](_0x3cd22d(_0x2de1fa,_0x5e911a,!![])),_0x15d2dc=_0x2de1fa[_0x57b045(0x351)];}const _0x4f66f4=await Promise[_0x57b045(0xe88)](_0x5c6ada),_0x393ea5=document[_0x57b045(0xc8e)]();_0x4f66f4['filter'](Boolean)[_0x57b045(0x7c0)](_0x1e84d9=>_0x393ea5['appendChild'](_0x1e84d9)),_0x47a59d[_0x57b045(0x31e)](_0x393ea5),_0x5ea6d4=_0x40b848['length'];const _0x534373=document[_0x57b045(0x8c1)]('div');_0x534373['id']='typing-indicator',_0x534373[_0x57b045(0x842)][_0x57b045(0x5e9)]='none',_0x534373['textContent']='对方正在输入...',_0x47a59d[_0x57b045(0x31e)](_0x534373),setTimeout(()=>_0x47a59d['scrollTop']=_0x47a59d['scrollHeight'],0x0);}async function _0x18e095(){const _0x36db24=_0x18b51e;if(_0x2a9ed2)return;_0x2a9ed2=!![];const _0x11dbf2=document[_0x36db24(0x8c2)](_0x36db24(0xb24)),_0x493b1b=_0x405767['chats'][_0x405767[_0x36db24(0x248)]];if(!_0x493b1b){_0x2a9ed2=![];return;}_0x21c28a(_0x11dbf2,_0x36db24(0x9a4));const _0x937a46=_0x11dbf2[_0x36db24(0xb43)];await new Promise(_0x5cceb9=>setTimeout(_0x5cceb9,0x1f4));const _0x2e0018=_0x493b1b['history']['length'],_0x4851cf=_0x405767[_0x36db24(0xb73)][_0x36db24(0x3dd)]||0x32,_0x481ee9=_0x2e0018-_0x5ea6d4-_0x4851cf,_0x5c463a=_0x2e0018-_0x5ea6d4,_0x3f4a5e=_0x493b1b['history'][_0x36db24(0x961)](Math[_0x36db24(0x171)](0x0,_0x481ee9),_0x5c463a),_0x30e769=_0x11dbf2['querySelector']('.message-wrapper[data-timestamp]');let _0x57edd6=_0x30e769?parseInt(_0x30e769[_0x36db24(0x323)][_0x36db24(0x351)]):0x0;for(const _0x5cbb6a of _0x3f4a5e['reverse']()){if(_0x57edd6>0x0&&_0x57edd6-_0x5cbb6a[_0x36db24(0x351)]>0x927c0){const _0x71c1ed=_0x436749(_0x57edd6);_0x11dbf2[_0x36db24(0x1ba)](_0x71c1ed);}await _0x5aabdc(_0x5cbb6a,_0x493b1b),_0x57edd6=_0x5cbb6a[_0x36db24(0x351)];}_0x5ea6d4+=_0x3f4a5e['length'];const _0x1579c4=_0x11dbf2['scrollHeight'];_0x11dbf2[_0x36db24(0xfd0)]=_0x1579c4-_0x937a46,_0x45f5dc(_0x11dbf2),_0x2a9ed2=![];}function _0x519e14(){const _0x36aff6=_0x18b51e;_0x3c6828(),_0x52184c();const _0x1a4e70=document[_0x36aff6(0x8c2)](_0x36aff6(0xa2b)),_0x43bd94=_0x405767['globalSettings'][_0x36aff6(0xc3a)];_0x43bd94?(_0x1a4e70[_0x36aff6(0x842)][_0x36aff6(0xfff)]='url('+_0x43bd94+')',_0x1a4e70[_0x36aff6(0x1090)]=''):(_0x1a4e70[_0x36aff6(0x842)][_0x36aff6(0xfff)]='linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)',_0x1a4e70[_0x36aff6(0x1090)]=_0x36aff6(0xef5));const _0x4a30a1=document[_0x36aff6(0x8c2)]('cphone-wallpaper-preview'),_0xb51dcd=_0x405767['globalSettings'][_0x36aff6(0x64a)];_0xb51dcd?(_0x4a30a1['style'][_0x36aff6(0xfff)]=_0x36aff6(0x116b)+_0xb51dcd+')',_0x4a30a1['textContent']=''):(_0x4a30a1['style']['backgroundImage']=_0x36aff6(0xd6a),_0x4a30a1[_0x36aff6(0x1090)]=_0x36aff6(0xef5));const _0x459a1f=document['getElementById'](_0x36aff6(0x2b4)),_0x4c5f84=_0x405767[_0x36aff6(0xb73)][_0x36aff6(0xdea)];_0x4c5f84?(_0x459a1f[_0x36aff6(0x842)][_0x36aff6(0xfff)]=_0x36aff6(0x116b)+_0x4c5f84+')',_0x459a1f[_0x36aff6(0x1090)]='',document[_0x36aff6(0x8c2)](_0x36aff6(0xf85))[_0x36aff6(0x842)]['display']=_0x36aff6(0xd93)):(_0x459a1f[_0x36aff6(0x842)][_0x36aff6(0xfff)]=_0x36aff6(0xbf8),_0x459a1f[_0x36aff6(0x1090)]=_0x36aff6(0x397),document[_0x36aff6(0x8c2)](_0x36aff6(0xf85))[_0x36aff6(0x842)]['display']=_0x36aff6(0xbf8)),_0x1d40b4(),_0x3fb772(),document[_0x36aff6(0x8c2)]('global-css-input')[_0x36aff6(0x518)]=_0x405767['globalSettings'][_0x36aff6(0x653)]||'',document[_0x36aff6(0x8c2)](_0x36aff6(0x11da))[_0x36aff6(0x518)]=_0x405767['globalSettings'][_0x36aff6(0x595)]||'',document[_0x36aff6(0x8c2)]('status-bar-toggle-switch')[_0x36aff6(0x75f)]=_0x405767[_0x36aff6(0xb73)][_0x36aff6(0x1286)]||![],_0x3c0a3b(),_0x5b2c2f();}window['renderWallpaperScreenProxy']=_0x519e14;function _0x1017e4(){const _0x349679=_0x18b51e,_0x1669ed=document['getElementById'](_0x349679(0x835)),_0x5f0f63=_0x405767[_0x349679(0xb73)][_0x349679(0xc3a)];_0x5f0f63?_0x1669ed['style'][_0x349679(0xfff)]=_0x349679(0x116b)+_0x5f0f63+')':_0x1669ed['style'][_0x349679(0xfff)]='linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)';}function _0x2d22a8(_0x49ae2a){const _0x242f68=_0x18b51e;document['querySelectorAll'](_0x242f68(0x78b))[_0x242f68(0x7c0)](_0x5e0312=>{const _0x208fd5=_0x242f68;_0x5e0312[_0x208fd5(0xb17)]['toggle'](_0x208fd5(0x71b),_0x5e0312['dataset'][_0x208fd5(0x792)]===_0x49ae2a);}),document[_0x242f68(0xa2d)](_0x242f68(0x9cd))[_0x242f68(0x7c0)](_0x55cbba=>{const _0x56754f=_0x242f68;_0x55cbba['classList'][_0x56754f(0xfc3)](_0x56754f(0x71b),_0x55cbba[_0x56754f(0x323)][_0x56754f(0x792)]===_0x49ae2a);});}async function _0x2d3fe9(){const _0x2d6007=_0x18b51e,_0x4af369=document[_0x2d6007(0x8c2)](_0x2d6007(0x1a7)),_0x36d0bb=document['getElementById'](_0x2d6007(0x9ba));_0x4af369[_0x2d6007(0xca0)]='',_0x36d0bb[_0x2d6007(0xca0)]='';const [_0x21ad62,_0x393dd3]=await Promise[_0x2d6007(0xe88)]([_0x15043e[_0x2d6007(0x40e)][_0x2d6007(0x6be)](),_0x15043e[_0x2d6007(0x4a5)]['orderBy']('name')[_0x2d6007(0x6be)]()]);_0x405767['worldBooks']=_0x21ad62;if(_0x21ad62[_0x2d6007(0x105a)]===0x0){_0x36d0bb['innerHTML']=_0x2d6007(0x8ee);return;}const _0x4762aa=document[_0x2d6007(0x8c1)](_0x2d6007(0x19a));_0x4762aa[_0x2d6007(0x84c)]=_0x2d6007(0xc4c),_0x4762aa[_0x2d6007(0x1090)]='全部',_0x4762aa[_0x2d6007(0x323)][_0x2d6007(0x792)]=_0x2d6007(0xe88),_0x4af369[_0x2d6007(0x31e)](_0x4762aa);const _0x2c6cfa=document[_0x2d6007(0x8c1)](_0x2d6007(0x1072));_0x2c6cfa[_0x2d6007(0x84c)]='world-book-category-pane\x20active',_0x2c6cfa[_0x2d6007(0x323)][_0x2d6007(0x792)]='all',_0x36d0bb[_0x2d6007(0x31e)](_0x2c6cfa),_0x393dd3[_0x2d6007(0x7c0)](_0x18f093=>{const _0x2e2811=_0x2d6007,_0x314374=document['createElement'](_0x2e2811(0x19a));_0x314374[_0x2e2811(0x84c)]='world-book-tab',_0x314374[_0x2e2811(0x1090)]=_0x18f093[_0x2e2811(0x596)],_0x314374[_0x2e2811(0x323)][_0x2e2811(0x792)]=String(_0x18f093['id']),_0x4af369['appendChild'](_0x314374);const _0x3656ba=document[_0x2e2811(0x8c1)](_0x2e2811(0x1072));_0x3656ba[_0x2e2811(0x84c)]='world-book-category-pane',_0x3656ba[_0x2e2811(0x323)]['categoryId']=String(_0x18f093['id']),_0x36d0bb['appendChild'](_0x3656ba);});const _0x44429d=_0x21ad62['some'](_0x10a45f=>!_0x10a45f['categoryId']);if(_0x44429d){const _0x27190a=document[_0x2d6007(0x8c1)](_0x2d6007(0x19a));_0x27190a[_0x2d6007(0x84c)]=_0x2d6007(0x428),_0x27190a[_0x2d6007(0x1090)]=_0x2d6007(0xd1e),_0x27190a[_0x2d6007(0x323)][_0x2d6007(0x792)]=_0x2d6007(0x606),_0x4af369[_0x2d6007(0x31e)](_0x27190a);const _0x291754=document['createElement']('div');_0x291754[_0x2d6007(0x84c)]='world-book-category-pane',_0x291754[_0x2d6007(0x323)]['categoryId']=_0x2d6007(0x606),_0x36d0bb[_0x2d6007(0x31e)](_0x291754);}_0x21ad62['forEach'](_0x2bbe51=>{const _0x1b2374=_0x2d6007;let _0x17d0f5='暂无内容...';if(Array[_0x1b2374(0xb85)](_0x2bbe51[_0x1b2374(0x168)])&&_0x2bbe51[_0x1b2374(0x168)][_0x1b2374(0x105a)]>0x0){const _0x392b78=_0x2bbe51[_0x1b2374(0x168)][0x0];_0x17d0f5=_0x392b78[_0x1b2374(0x120a)]||_0x392b78[_0x1b2374(0x168)]||'';}else typeof _0x2bbe51['content']===_0x1b2374(0xf1b)&&_0x2bbe51[_0x1b2374(0x168)][_0x1b2374(0x8c6)]()!==''&&(_0x17d0f5=_0x2bbe51['content']);const _0x49f55f=document[_0x1b2374(0x8c1)]('div');_0x49f55f['className']=_0x1b2374(0xd94),_0x49f55f[_0x1b2374(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x2bbe51['name']+_0x1b2374(0x477)+_0x17d0f5+_0x1b2374(0x953);const _0xb4f16d=()=>_0x339e40(_0x2bbe51['id']),_0x3d57d4=async()=>{const _0x570aa0=_0x1b2374,_0x5e1fee=await _0x8b9cb8(_0x570aa0(0xccc),_0x570aa0(0xf99)+_0x2bbe51[_0x570aa0(0x596)]+_0x570aa0(0x152),{'confirmButtonClass':_0x570aa0(0xe2a)});_0x5e1fee&&(await _0x15043e[_0x570aa0(0x40e)][_0x570aa0(0x89f)](_0x2bbe51['id']),_0x405767[_0x570aa0(0x40e)]=_0x405767[_0x570aa0(0x40e)][_0x570aa0(0x1d8)](_0x980ac9=>_0x980ac9['id']!==_0x2bbe51['id']),_0x2d3fe9());};_0x49f55f[_0x1b2374(0xae8)](_0x1b2374(0xa17),_0xb4f16d),_0x5dcbd7(_0x49f55f,_0x3d57d4);const _0x57e61b=_0x49f55f[_0x1b2374(0xac5)](!![]);_0x57e61b[_0x1b2374(0xae8)](_0x1b2374(0xa17),_0xb4f16d),_0x5dcbd7(_0x57e61b,_0x3d57d4),_0x2c6cfa[_0x1b2374(0x31e)](_0x57e61b);const _0x1e9b1a=_0x2bbe51[_0x1b2374(0x792)]?String(_0x2bbe51[_0x1b2374(0x792)]):_0x1b2374(0x606),_0x246d1e=_0x36d0bb[_0x1b2374(0x1ad)]('.world-book-category-pane[data-category-id=\x22'+_0x1e9b1a+'\x22]');_0x246d1e&&_0x246d1e[_0x1b2374(0x31e)](_0x49f55f);}),document[_0x2d6007(0xa2d)](_0x2d6007(0x78b))[_0x2d6007(0x7c0)](_0x4fd3d7=>{const _0x2f1026=_0x2d6007;_0x4fd3d7[_0x2f1026(0xae8)](_0x2f1026(0xa17),()=>_0x2d22a8(_0x4fd3d7[_0x2f1026(0x323)]['categoryId']));});}function _0x4090ca(_0x135708,_0x305e49){const _0x3c13d7=_0x18b51e,_0xaeb867=document[_0x3c13d7(0x8c1)]('div');_0xaeb867[_0x3c13d7(0x84c)]=_0x3c13d7(0x48f),_0xaeb867[_0x3c13d7(0xca0)]=_0x3c13d7(0x52a)+_0x135708+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x9229c0=_0xaeb867[_0x3c13d7(0x1ad)](_0x3c13d7(0x611));return _0x305e49[_0x3c13d7(0xa19)]((_0xa4423b,_0x2eb070)=>_0xa4423b[_0x3c13d7(0x596)][_0x3c13d7(0x83a)](_0x2eb070['name'],_0x3c13d7(0x73e))),_0x305e49[_0x3c13d7(0x7c0)](_0x8aebb1=>{const _0x38e1a1=_0x3c13d7;let _0x4d8152=_0x38e1a1(0x7fc);if(Array[_0x38e1a1(0xb85)](_0x8aebb1[_0x38e1a1(0x168)])&&_0x8aebb1['content'][_0x38e1a1(0x105a)]>0x0){const _0x1c6611=_0x8aebb1[_0x38e1a1(0x168)][0x0];_0x4d8152=_0x1c6611[_0x38e1a1(0x120a)]||_0x1c6611['content']||'';}else typeof _0x8aebb1['content']===_0x38e1a1(0xf1b)&&_0x8aebb1[_0x38e1a1(0x168)][_0x38e1a1(0x8c6)]()!==''&&(_0x4d8152=_0x8aebb1[_0x38e1a1(0x168)]);const _0x5cda08=document[_0x38e1a1(0x8c1)](_0x38e1a1(0x1072));_0x5cda08['className']=_0x38e1a1(0x94f),_0x5cda08['dataset']['bookId']=_0x8aebb1['id'],_0x5cda08[_0x38e1a1(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>'+_0x8aebb1['name']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>'+String(_0x4d8152)[_0x38e1a1(0x599)](0x0,0x32)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x5cda08[_0x38e1a1(0xae8)](_0x38e1a1(0xa17),()=>_0x339e40(_0x8aebb1['id'])),_0x5dcbd7(_0x5cda08,async()=>{const _0x146083=_0x38e1a1,_0x3f16ec=await _0x8b9cb8(_0x146083(0xccc),'确定要删除《'+_0x8aebb1[_0x146083(0x596)]+_0x146083(0xf40),{'confirmButtonClass':'btn-danger'});_0x3f16ec&&(await _0x15043e[_0x146083(0x40e)][_0x146083(0x89f)](_0x8aebb1['id']),_0x405767[_0x146083(0x40e)]=_0x405767[_0x146083(0x40e)][_0x146083(0x1d8)](_0x78d265=>_0x78d265['id']!==_0x8aebb1['id']),_0x2d3fe9());}),_0x9229c0[_0x38e1a1(0x31e)](_0x5cda08);}),_0xaeb867;}window[_0x18b51e(0x639)]=_0x2d3fe9;async function _0x339e40(_0x571e3b){const _0x4d0d8c=_0x18b51e;_0x3d1990(_0x4d0d8c(0xcae)),_0x4ec30d=_0x571e3b;const [_0x1d230b,_0x3fd5ea]=await Promise[_0x4d0d8c(0xe88)]([_0x15043e['worldBooks'][_0x4d0d8c(0x3e9)](_0x571e3b),_0x15043e[_0x4d0d8c(0x4a5)]['toArray']()]);if(!_0x1d230b){console[_0x4d0d8c(0x7a3)](_0x4d0d8c(0x446),_0x571e3b),_0x3d1990(_0x4d0d8c(0x28c));return;}document['getElementById'](_0x4d0d8c(0x91c))[_0x4d0d8c(0x1090)]=_0x1d230b[_0x4d0d8c(0x596)],document[_0x4d0d8c(0x8c2)]('world-book-name-input')[_0x4d0d8c(0x518)]=_0x1d230b['name'];const _0x5b3eb9=document[_0x4d0d8c(0x8c2)](_0x4d0d8c(0xbf1));_0x5b3eb9[_0x4d0d8c(0xca0)]=_0x4d0d8c(0x594),_0x3fd5ea['forEach'](_0xa20523=>{const _0xded39=_0x4d0d8c,_0x65282d=document[_0xded39(0x8c1)](_0xded39(0x4f3));_0x65282d[_0xded39(0x518)]=_0xa20523['id'],_0x65282d[_0xded39(0x1090)]=_0xa20523['name'];if(_0x1d230b[_0xded39(0x792)]===_0xa20523['id'])_0x65282d[_0xded39(0x118f)]=!![];_0x5b3eb9['appendChild'](_0x65282d);});const _0x1f8127=document[_0x4d0d8c(0x8c2)](_0x4d0d8c(0x1235));_0x1f8127[_0x4d0d8c(0xca0)]='',Array[_0x4d0d8c(0xb85)](_0x1d230b[_0x4d0d8c(0x168)])&&_0x1d230b[_0x4d0d8c(0x168)][_0x4d0d8c(0x105a)]>0x0?_0x1d230b[_0x4d0d8c(0x168)]['forEach'](_0x198cf1=>{const _0x5702ba=_0x4d0d8c,_0x4796d2=_0x18faa4(_0x198cf1);_0x1f8127[_0x5702ba(0x31e)](_0x4796d2);}):_0x1f8127[_0x4d0d8c(0xca0)]=_0x4d0d8c(0x1188);}async function _0x1def9c(_0x53e97f=!![]){const _0x1a1ff1=_0x18b51e,_0xd0eecc=document[_0x1a1ff1(0x8c2)](_0x1a1ff1(0x676)),_0x3a58b3=document[_0x1a1ff1(0x8c2)](_0x1a1ff1(0x8a8)),_0x393d6c=document[_0x1a1ff1(0x8c2)](_0x1a1ff1(0xc93)),_0x417086=_0x393d6c[_0x1a1ff1(0x518)][_0x1a1ff1(0x8c6)]()[_0x1a1ff1(0xab8)]();if(_0x53e97f){_0x3a58b3[_0x1a1ff1(0xca0)]='';const _0x32c5ee=await _0x15043e[_0x1a1ff1(0x7db)]['toArray']();_0x3a58b3[_0x1a1ff1(0xca0)]+=_0x1a1ff1(0x37a)+(_0x5abf24===_0x1a1ff1(0xe88)?'active':'')+_0x1a1ff1(0xacd),_0x32c5ee[_0x1a1ff1(0x7c0)](_0x24ad19=>{const _0x5301e1=_0x1a1ff1;_0x3a58b3['innerHTML']+='<button\x20class=\x22sticker-category-tab\x20'+(_0x5abf24===_0x24ad19['id']?_0x5301e1(0x71b):'')+_0x5301e1(0xc7e)+_0x24ad19['id']+'\x22>'+_0x24ad19[_0x5301e1(0x596)]+'</button>';}),_0x3a58b3['innerHTML']+=_0x1a1ff1(0x37a)+(_0x5abf24==='uncategorized'?_0x1a1ff1(0x71b):'')+_0x1a1ff1(0xd6c);}_0xd0eecc['innerHTML']='';let _0x29d17a;if(_0x5abf24===_0x1a1ff1(0xe88))_0x29d17a=_0x405767['userStickers'];else _0x5abf24==='uncategorized'?_0x29d17a=_0x405767[_0x1a1ff1(0xc36)]['filter'](_0x451a4f=>!_0x451a4f[_0x1a1ff1(0x792)]):_0x29d17a=_0x405767['userStickers']['filter'](_0x3fbfaf=>_0x3fbfaf['categoryId']===_0x5abf24);const _0x43119c=_0x417086?_0x29d17a['filter'](_0x1b50c2=>_0x1b50c2[_0x1a1ff1(0x596)][_0x1a1ff1(0xab8)]()[_0x1a1ff1(0x773)](_0x417086)):_0x29d17a;if(_0x43119c[_0x1a1ff1(0x105a)]===0x0){const _0x54b55f=_0x417086?'找不到匹配的表情':_0x1a1ff1(0xa8c);_0xd0eecc[_0x1a1ff1(0xca0)]=_0x1a1ff1(0xd43)+_0x54b55f+_0x1a1ff1(0x2e7);return;}_0x43119c[_0x1a1ff1(0x7c0)](_0x183e7f=>{const _0x1877b2=_0x1a1ff1,_0x88e4cb=document[_0x1877b2(0x8c1)](_0x1877b2(0x1072));_0x88e4cb[_0x1877b2(0x84c)]=_0x1877b2(0xe5a),_0x88e4cb['title']=_0x183e7f[_0x1877b2(0x596)],_0x88e4cb['dataset']['stickerId']=_0x183e7f['id'],_0x88e4cb[_0x1877b2(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url('+_0x183e7f[_0x1877b2(0x9d6)]+_0x1877b2(0xcb8)+_0x183e7f['name']+_0x1877b2(0x10e2),_0x88e4cb[_0x1877b2(0xae8)](_0x1877b2(0xa17),()=>{_0x212e24?_0x5774df(_0x88e4cb):_0x1a6327(_0x183e7f);});const _0x162dce=document[_0x1877b2(0x8c1)]('div');_0x162dce[_0x1877b2(0x84c)]=_0x1877b2(0x517),_0x162dce[_0x1877b2(0xca0)]=_0x1877b2(0x106d),_0x162dce['onclick']=async _0x195812=>{const _0x54a680=_0x1877b2;_0x195812['stopPropagation']();const _0xc5ab9=await _0x8b9cb8(_0x54a680(0x843),_0x54a680(0xbb9)+_0x183e7f['name']+'\x22\x20吗？',{'confirmButtonClass':_0x54a680(0xe2a)});_0xc5ab9&&(await _0x15043e[_0x54a680(0xc36)][_0x54a680(0x89f)](_0x183e7f['id']),_0x405767[_0x54a680(0xc36)]=_0x405767[_0x54a680(0xc36)]['filter'](_0x301bbb=>_0x301bbb['id']!==_0x183e7f['id']),_0x1def9c());},_0x88e4cb['appendChild'](_0x162dce),_0xd0eecc['appendChild'](_0x88e4cb);});}let _0x212e24=![],_0x2f0e3c=new Set();function _0x57a4b6(){const _0x45bed7=_0x18b51e;_0x212e24=!_0x212e24;const _0x4b20cf=document[_0x45bed7(0x8c2)](_0x45bed7(0x676)),_0x3144f1=document[_0x45bed7(0x8c2)]('manage-stickers-btn'),_0x2a8f6d=document[_0x45bed7(0x8c2)](_0x45bed7(0xa52)),_0x35dd77=document['getElementById'](_0x45bed7(0x91b));_0x4b20cf[_0x45bed7(0xb17)]['toggle'](_0x45bed7(0xdf2),_0x212e24),_0x212e24?(_0x3144f1[_0x45bed7(0x1090)]='完成',_0x2a8f6d[_0x45bed7(0x842)]['display']=_0x45bed7(0xd52),_0x2f0e3c[_0x45bed7(0xa6a)](),_0x35dd77[_0x45bed7(0x75f)]=![],_0x276240()):(_0x3144f1['textContent']='管理',_0x2a8f6d[_0x45bed7(0x842)][_0x45bed7(0x5e9)]=_0x45bed7(0xbf8),_0x4b20cf[_0x45bed7(0xa2d)](_0x45bed7(0xd51))[_0x45bed7(0x7c0)](_0x477077=>_0x477077[_0x45bed7(0xb17)][_0x45bed7(0xaff)](_0x45bed7(0x118f))));}function _0x446bf2(){const _0x57602b=_0x18b51e,_0x1c9773=document[_0x57602b(0x8c2)](_0x57602b(0x91b)),_0x406fda=_0x1c9773[_0x57602b(0x75f)];let _0x31cb02;if(_0x5abf24===_0x57602b(0xe88))_0x31cb02=_0x405767[_0x57602b(0xc36)];else _0x5abf24===_0x57602b(0x606)?_0x31cb02=_0x405767[_0x57602b(0xc36)][_0x57602b(0x1d8)](_0x523713=>!_0x523713[_0x57602b(0x792)]):_0x31cb02=_0x405767[_0x57602b(0xc36)][_0x57602b(0x1d8)](_0x5ccc0e=>_0x5ccc0e[_0x57602b(0x792)]===_0x5abf24);_0x31cb02[_0x57602b(0x7c0)](_0x11c369=>{const _0x2854e5=_0x57602b,_0x5ad9e5=_0x11c369['id'],_0x3fb9b1=document['querySelector'](_0x2854e5(0x1f0)+_0x5ad9e5+'\x22]');if(_0x406fda){_0x2f0e3c[_0x2854e5(0x3f4)](_0x5ad9e5);if(_0x3fb9b1)_0x3fb9b1[_0x2854e5(0xb17)][_0x2854e5(0x3f4)]('selected');}else{_0x2f0e3c[_0x2854e5(0x89f)](_0x5ad9e5);if(_0x3fb9b1)_0x3fb9b1[_0x2854e5(0xb17)]['remove'](_0x2854e5(0x118f));}}),_0x276240();}function _0x276240(){const _0x1a474c=_0x18b51e,_0x1668ce=document[_0x1a474c(0x8c2)](_0x1a474c(0x598));_0x1668ce[_0x1a474c(0x1090)]=_0x1a474c(0xaad)+_0x2f0e3c[_0x1a474c(0xf72)]+')';}function _0x5774df(_0x349887){const _0x2d3031=_0x18b51e;if(!_0x212e24)return;const _0x312629=_0x349887[_0x2d3031(0x323)]['stickerId'];if(!_0x312629)return;_0x349887['classList']['toggle'](_0x2d3031(0x118f)),_0x2f0e3c['has'](_0x312629)?_0x2f0e3c['delete'](_0x312629):_0x2f0e3c[_0x2d3031(0x3f4)](_0x312629),_0x276240();}async function _0x1c0b58(){const _0x288f50=_0x18b51e;if(_0x2f0e3c[_0x288f50(0xf72)]===0x0)return;const _0x53be7a=await _0x8b9cb8('确认删除','确定要删除选中的\x20'+_0x2f0e3c[_0x288f50(0xf72)]+_0x288f50(0x805),{'confirmButtonClass':'btn-danger'});if(_0x53be7a){const _0x4918ab=[..._0x2f0e3c];await _0x15043e['userStickers'][_0x288f50(0x101d)](_0x4918ab),_0x405767[_0x288f50(0xc36)]=_0x405767[_0x288f50(0xc36)]['filter'](_0x2639a8=>!_0x4918ab[_0x288f50(0x773)](_0x2639a8['id'])),_0x57a4b6(),_0x1def9c(),await _0x501c7b(_0x288f50(0x824),_0x288f50(0x5bd));}}async function _0x10c4c5(){const _0x35d1d3=_0x18b51e,_0x26d5e9='请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a',_0x522bb9=await _0x180f74(_0x35d1d3(0x109e),_0x26d5e9,'',_0x35d1d3(0x6c3));_0x522bb9&&_0x522bb9[_0x35d1d3(0x8c6)]()&&await _0x46b990(_0x522bb9);}async function _0x46b990(_0x331f95){const _0x19f0af=_0x18b51e,_0x43f391=_0x331f95['trim']()[_0x19f0af(0x111f)]('\x0a'),_0x18351c=[],_0x1b134f='https://files.catbox.moe/';let _0x4d352e=0x0;const _0x18daff=_0x5abf24!==_0x19f0af(0xe88)&&_0x5abf24!==_0x19f0af(0x606)?_0x5abf24:null;for(const _0x271710 of _0x43f391){const _0x55e605=_0x271710[_0x19f0af(0x8c6)]();if(!_0x55e605||_0x55e605[_0x19f0af(0x773)]('填入'))continue;const _0x3b90e8=_0x55e605[_0x19f0af(0xdf8)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x3b90e8){const _0x1eef38=_0x3b90e8[0x1]['trim'](),_0x1f6e79=_0x3b90e8[0x2][_0x19f0af(0x8c6)]();_0x18351c[_0x19f0af(0xa49)]({'id':_0x19f0af(0x5cf)+Date[_0x19f0af(0x1ed)]()+Math[_0x19f0af(0x5b3)](),'name':_0x1eef38,'url':_0x1f6e79,'categoryId':_0x18daff});continue;}let _0x1aef22=null,_0x5f1364=null;const _0x25ab68=_0x55e605[_0x19f0af(0xdf8)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x25ab68)_0x1aef22=_0x25ab68[0x1],_0x5f1364=_0x25ab68[0x2];else{const _0x3c966a=_0x55e605[_0x19f0af(0x111f)](/\s+/);_0x3c966a['length']>=0x2&&(_0x5f1364=_0x3c966a[_0x19f0af(0xd64)](),_0x1aef22=_0x3c966a[_0x19f0af(0xb2c)]('\x20'));}_0x1aef22&&_0x5f1364&&_0x5f1364[_0x19f0af(0x773)]('.')?_0x18351c[_0x19f0af(0xa49)]({'id':_0x19f0af(0x5cf)+Date['now']()+Math[_0x19f0af(0x5b3)](),'name':_0x1aef22,'url':_0x1b134f+_0x5f1364,'categoryId':_0x18daff}):(_0x4d352e++,console[_0x19f0af(0x112a)]('批量导入格式错误，已跳过此行:',_0x55e605));}_0x4d352e>0x0&&await _0x501c7b(_0x19f0af(0xbf4),'有\x20'+_0x4d352e+'\x20行的格式不正确，已被系统跳过。');if(_0x18351c[_0x19f0af(0x105a)]>0x0)await _0x15043e[_0x19f0af(0xc36)][_0x19f0af(0x116d)](_0x18351c),_0x405767[_0x19f0af(0xc36)][_0x19f0af(0xa49)](..._0x18351c),_0x1def9c(),await _0x501c7b(_0x19f0af(0x95b),_0x19f0af(0x52c)+_0x18351c[_0x19f0af(0x105a)]+_0x19f0af(0xdba));else _0x4d352e===0x0&&alert(_0x19f0af(0x107a));}function _0x2a883c(_0x524ad2){const _0x1974b4=_0x18b51e,_0x29c9f0=_0x1974b4(0x4a4)+_0x524ad2+'\x22]',_0x32615e=document[_0x1974b4(0x1ad)](_0x29c9f0);_0x32615e?(_0x32615e[_0x1974b4(0x680)]({'behavior':'smooth','block':_0x1974b4(0x65d)}),_0x32615e[_0x1974b4(0xb17)][_0x1974b4(0x3f4)](_0x1974b4(0x216)),setTimeout(()=>{const _0xcd748e=_0x1974b4;document[_0xcd748e(0x540)][_0xcd748e(0x795)](_0x32615e)&&_0x32615e[_0xcd748e(0xb17)][_0xcd748e(0xaff)](_0xcd748e(0x216));},0x5dc)):alert('找不到原始消息。可能已被删除或位于更早的历史记录中。');}async function _0x3cd22d(_0xadea07,_0x17cf68){const _0x2065ab=_0x18b51e;if(_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0x87c)){const _0x500ebb=document[_0x2065ab(0x8c1)]('div');_0x500ebb[_0x2065ab(0x84c)]=_0x2065ab(0xff4),_0x500ebb['dataset']['timestamp']=_0xadea07['timestamp'];const _0x131191=document[_0x2065ab(0x8c1)](_0x2065ab(0x1072));return _0x131191[_0x2065ab(0x84c)]=_0x2065ab(0xe51),_0x131191[_0x2065ab(0x323)][_0x2065ab(0x351)]=_0xadea07[_0x2065ab(0x351)],_0x131191[_0x2065ab(0x1090)]=_0xadea07[_0x2065ab(0x168)],_0x500ebb[_0x2065ab(0x31e)](_0x131191),_0x5dcbd7(_0x500ebb,()=>_0x457c69(_0xadea07[_0x2065ab(0x351)])),_0x500ebb['addEventListener'](_0x2065ab(0xa17),()=>{_0x324554&&_0xd7c822(_0xadea07['timestamp']);}),_0x500ebb;}else{if(_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0x699)){const _0x5d8567=document[_0x2065ab(0x8c1)](_0x2065ab(0x1072));_0x5d8567[_0x2065ab(0x84c)]=_0x2065ab(0xff4),_0x5d8567[_0x2065ab(0x323)]['timestamp']=_0xadea07[_0x2065ab(0x351)];const _0x38898d=document[_0x2065ab(0x8c1)](_0x2065ab(0x1072));return _0x38898d['className']=_0x2065ab(0x2be),_0x38898d[_0x2065ab(0x323)]['postId']=_0xadea07[_0x2065ab(0x5f9)],_0x38898d[_0x2065ab(0x1090)]=_0xadea07[_0x2065ab(0x168)],_0x5d8567[_0x2065ab(0x31e)](_0x38898d),_0x5dcbd7(_0x5d8567,()=>_0x457c69(_0xadea07[_0x2065ab(0x351)])),_0x5d8567[_0x2065ab(0xae8)]('click',()=>{const _0x22cdf5=_0x2065ab;_0x324554&&_0xd7c822(_0xadea07[_0x22cdf5(0x351)]);}),_0x5d8567;}}if(_0xadea07[_0x2065ab(0x3f1)])return null;if(_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0x6f1)){const _0x644f49=document[_0x2065ab(0x8c1)](_0x2065ab(0x1072));_0x644f49['className']=_0x2065ab(0xff4);const _0x12e640=document['createElement'](_0x2065ab(0x1072));return _0x12e640[_0x2065ab(0x84c)]=_0x2065ab(0x927),_0x12e640[_0x2065ab(0x323)][_0x2065ab(0x351)]=_0xadea07[_0x2065ab(0x351)],_0x12e640[_0x2065ab(0x1090)]=_0xadea07[_0x2065ab(0x168)],_0x644f49[_0x2065ab(0x31e)](_0x12e640),_0x5dcbd7(_0x644f49,()=>_0x457c69(_0xadea07[_0x2065ab(0x351)])),_0x644f49['addEventListener']('click',()=>{const _0x537fb3=_0x2065ab;if(_0x324554)_0xd7c822(_0xadea07[_0x537fb3(0x351)]);}),_0x644f49;}const _0xd6798d=_0xadea07[_0x2065ab(0x14a)]===_0x2065ab(0x74b),_0x5cbda4=_0x17cf68[_0x2065ab(0x33a)][_0x2065ab(0xe16)]||'我',_0x333616=document[_0x2065ab(0x8c1)](_0x2065ab(0x1072));_0x333616[_0x2065ab(0x84c)]='message-wrapper\x20'+(_0xd6798d?_0x2065ab(0x74b):'ai');if(_0x17cf68[_0x2065ab(0x1000)]&&!_0xd6798d){const _0xe7cdb5=_0x17cf68[_0x2065ab(0x635)][_0x2065ab(0x2ef)](_0x4fe62e=>_0x4fe62e[_0x2065ab(0x4e7)]===_0xadea07[_0x2065ab(0x770)]),_0x259856=document[_0x2065ab(0x8c1)](_0x2065ab(0x1072));_0x259856[_0x2065ab(0x84c)]=_0x2065ab(0x1f9),_0x259856[_0x2065ab(0x1090)]=_0xe7cdb5?_0xe7cdb5[_0x2065ab(0x375)]:_0xadea07[_0x2065ab(0x770)]||_0x2065ab(0x75d),_0x333616[_0x2065ab(0x31e)](_0x259856);}const _0x4ab5cb=document[_0x2065ab(0x8c1)]('div');_0x4ab5cb[_0x2065ab(0x84c)]='message-bubble\x20'+(_0xd6798d?_0x2065ab(0x74b):'ai'),_0x4ab5cb[_0x2065ab(0x323)][_0x2065ab(0x351)]=_0xadea07[_0x2065ab(0x351)];const _0x43a5c2=document[_0x2065ab(0x8c1)](_0x2065ab(0x3ec));_0x43a5c2['className']=_0x2065ab(0x351),_0x43a5c2[_0x2065ab(0x1090)]=_0x75dca3(_0xadea07[_0x2065ab(0x351)]);let _0x4eff5f,_0x2e4a3f='';if(_0xd6798d)_0x4eff5f=_0x17cf68[_0x2065ab(0x33a)][_0x2065ab(0x11ed)]||(_0x17cf68['isGroup']?_0x38e728:_0x49d2a4),_0x2e4a3f=_0x17cf68['settings'][_0x2065ab(0x538)]||'';else{if(_0x17cf68['isGroup']){const _0x2c7786=_0x17cf68[_0x2065ab(0x635)][_0x2065ab(0x2ef)](_0x4cb94e=>_0x4cb94e[_0x2065ab(0x4e7)]===_0xadea07[_0x2065ab(0x770)]);if(_0x2c7786){const _0x27f0d1=_0x405767[_0x2065ab(0x799)][_0x2c7786['id']];_0x4eff5f=_0x2c7786[_0x2065ab(0x1e1)]||(_0x27f0d1?_0x27f0d1[_0x2065ab(0x33a)]['aiAvatar']:_0x9fdc61),_0x2e4a3f=_0x2c7786[_0x2065ab(0xe78)]||(_0x27f0d1?_0x27f0d1[_0x2065ab(0x33a)][_0x2065ab(0x1b1)]:'');}else _0x4eff5f=_0x9fdc61,_0x2e4a3f='';}else _0x4eff5f=_0x17cf68[_0x2065ab(0x33a)][_0x2065ab(0x44e)]||_0x49d2a4,_0x2e4a3f=_0x17cf68[_0x2065ab(0x33a)][_0x2065ab(0x1b1)]||'';}let _0x47a266;_0x2e4a3f?_0x47a266=_0x2065ab(0xb08)+_0x4eff5f+_0x2065ab(0x833)+_0x2e4a3f+_0x2065ab(0x1d2):_0x47a266='<img\x20src=\x22'+_0x4eff5f+_0x2065ab(0x2b8);const _0x4e7e2e=_0x2e4a3f?_0x2065ab(0x8b5):'',_0x2a9a8a=_0x2065ab(0x10df)+_0x4e7e2e+'\x22>'+_0x47a266+_0x2065ab(0x1079);let _0x5721b7,_0x1f0849='';if(_0xadea07[_0x2065ab(0x9d2)]){const _0x3e56c8=_0x1ba34a(_0x17cf68,_0xadea07[_0x2065ab(0x9d2)][_0x2065ab(0x770)]),_0x21effa=String(_0xadea07[_0x2065ab(0x9d2)][_0x2065ab(0x168)]||'');_0x1f0849='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22'+_0xadea07[_0x2065ab(0x9d2)][_0x2065ab(0x351)]+'\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20'+_0x3e56c8+':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>'+_0x21effa+_0x2065ab(0x6b2);}let _0x436b5=_0xadea07[_0x2065ab(0x168)];if(typeof _0x436b5===_0x2065ab(0xf1b)&&_0x436b5[_0x2065ab(0x8c6)]()['startsWith']('<')&&_0x436b5[_0x2065ab(0x8c6)]()[_0x2065ab(0x866)]('>'))_0x5721b7=_0x436b5,_0x4ab5cb[_0x2065ab(0xb17)]['add'](_0x2065ab(0x106b));else{if(_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0xaac)||_0xadea07['type']===_0x2065ab(0xda5)||_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0x126b)||_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0xfbe)||_0xadea07['type']==='ai_image'||_0xadea07[_0x2065ab(0xde0)]==='user_photo'||_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0xf64)||_0xadea07['type']===_0x2065ab(0x11b9)||_0xadea07[_0x2065ab(0xde0)]==='waimai_request'||_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0x1061)||_0xadea07[_0x2065ab(0xde0)]==='red_packet'||_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0x123d)||_0xadea07['type']==='gift'){if(_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0xaac)){const _0x5b4017=_0xadea07[_0x2065ab(0x168)]||((_0xadea07[_0x2065ab(0x1028)]||'')+'\x20'+(_0xadea07[_0x2065ab(0x3ca)]||''))[_0x2065ab(0x8c6)](),_0x2f87cc=/(「.*?」|“.*?”)/g,_0x10669d=_0x5b4017[_0x2065ab(0x111f)](_0x2f87cc)[_0x2065ab(0x1d8)](_0x3c1056=>_0x3c1056);_0x5721b7=_0x10669d[_0x2065ab(0x6b9)](_0x3dd3a3=>{const _0x2a85c9=_0x2065ab;return _0x3dd3a3[_0x2a85c9(0xc7c)]('「')||_0x3dd3a3[_0x2a85c9(0xc7c)]('“')?_0x2a85c9(0x1246)+_0x16059c(_0x3dd3a3)+'</span>':'<span\x20class=\x22offline-description\x22>'+_0x16059c(_0x3dd3a3[_0x2a85c9(0x8c6)]())[_0x2a85c9(0x1b7)](/\n/g,_0x2a85c9(0x854))+_0x2a85c9(0x688);})[_0x2065ab(0xb2c)]('');}else{if(_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0xda5))_0x4ab5cb[_0x2065ab(0xb17)][_0x2065ab(0x3f4)](_0x2065ab(0x934),'is-card-like'),_0x5721b7=_0x2065ab(0xe64)+_0xadea07[_0x2065ab(0x351)]+_0x2065ab(0x11f6)+(_0xadea07[_0x2065ab(0xcea)]||_0x2065ab(0x1117))+_0x2065ab(0x240)+(_0xadea07['description']||'点击查看详情...')+_0x2065ab(0xa95)+(_0xadea07['source_name']||'链接分享')+_0x2065ab(0x736);else{if(_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0x126b))_0x4ab5cb['classList']['add']('is-link-share','is-card-like'),_0x5721b7=_0x2065ab(0x2d1)+_0xadea07['timestamp']+'\x22><div\x20class=\x22title\x22>'+_0xadea07['payload'][_0x2065ab(0xcea)]+'</div><div\x20class=\x22description\x22>共\x20'+_0xadea07[_0x2065ab(0xba9)][_0x2065ab(0xceb)][_0x2065ab(0x105a)]+_0x2065ab(0x10a6);else{if(_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0xfbe)){_0x4ab5cb['classList'][_0x2065ab(0x3f4)](_0x2065ab(0x1215),_0x2065ab(0x11be));let _0x14b721;if(_0xadea07[_0x2065ab(0x10d4)])_0x14b721=_0xadea07[_0x2065ab(0x10d4)];else _0x405767[_0x2065ab(0xb73)][_0x2065ab(0xd00)]&&_0xadea07[_0x2065ab(0xdae)]?_0x14b721=_0x2065ab(0x2c6)+encodeURIComponent(_0xadea07[_0x2065ab(0xdae)]):_0x14b721=_0x2065ab(0xc99);const _0x35615b=_0x2065ab(0xc55)+_0x14b721+_0x2065ab(0xf01);_0x5721b7='<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>'+_0xadea07['content']+_0x2065ab(0xa54)+_0x35615b+'><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>';}else{if(_0xadea07[_0x2065ab(0xde0)]==='user_photo'||_0xadea07[_0x2065ab(0xde0)]==='ai_image'){_0x4ab5cb[_0x2065ab(0xb17)][_0x2065ab(0x3f4)]('is-ai-image',_0x2065ab(0x11be));const _0x27b447=_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0x223)?_0x2065ab(0xa80):_0x2065ab(0x79d),_0x45a48e=_0x405767['globalSettings'][_0x2065ab(0xd00)]&&_0xadea07[_0x2065ab(0xdae)]?_0x2065ab(0x2c6)+_0xadea07[_0x2065ab(0xdae)]:_0x2065ab(0x10c3);_0x5721b7=_0x2065ab(0x333)+_0x45a48e+_0x2065ab(0x39a)+_0x27b447+_0x2065ab(0x15b)+_0xadea07[_0x2065ab(0x168)]+'\x22>';}else{if(_0xadea07[_0x2065ab(0xde0)]==='voice_message'){_0x4ab5cb[_0x2065ab(0xb17)][_0x2065ab(0x3f4)]('is-voice-message','is-card-like');const _0x2f4894=Math[_0x2065ab(0x171)](0x1,Math['round']((_0xadea07[_0x2065ab(0x168)]||'')[_0x2065ab(0x105a)]/0x5)),_0x21e4f1='0:'+String(_0x2f4894)[_0x2065ab(0xc89)](0x2,'0')+'\x27\x27',_0x50c777='<div></div><div></div><div></div><div></div><div></div>';if(_0xd6798d)_0x5721b7=_0x2065ab(0x5f2)+encodeURIComponent(_0xadea07[_0x2065ab(0x168)])+_0x2065ab(0x1280)+_0x50c777+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>'+_0x21e4f1+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';else{const _0x10bb90=!_0x17cf68[_0x2065ab(0x1000)]&&_0x17cf68['settings'][_0x2065ab(0xa71)]!==![],_0x2eb813=_0x17cf68['settings']['minimaxVoiceId']||_0x2065ab(0x6b3),_0x39d6d5=_0x10bb90?_0x2065ab(0xf6d)+_0x2eb813+'\x22':'';_0x5721b7=_0x2065ab(0x5f2)+encodeURIComponent(_0xadea07[_0x2065ab(0x168)])+'\x22\x20'+_0x39d6d5+_0x2065ab(0x19e)+_0x50c777+_0x2065ab(0x2f1)+_0x21e4f1+_0x2065ab(0x44b);}}else{if(_0xadea07['type']===_0x2065ab(0x11b9)){_0x4ab5cb[_0x2065ab(0xb17)][_0x2065ab(0x3f4)]('is-transfer',_0x2065ab(0x11be));let _0x22e070,_0x47f874;const _0xa8cc75=_0x17cf68[_0x2065ab(0x1000)]?_0x17cf68[_0x2065ab(0x33a)]['myNickname']||'我':'我',_0x47e838=_0x1ba34a(_0x17cf68,_0xadea07[_0x2065ab(0x770)]),_0x515e93=_0x1ba34a(_0x17cf68,_0xadea07['receiverName']||_0x17cf68[_0x2065ab(0x596)]);if(_0xd6798d){if(_0xadea07['isRefund'])_0x22e070=_0x2065ab(0x930)+_0x515e93,_0x47f874=_0x2065ab(0xd31);else{_0x22e070='转账给\x20'+_0x515e93;if(_0xadea07['status']==='accepted')_0x47f874=_0x2065ab(0x178);else{if(_0xadea07[_0x2065ab(0x8c8)]===_0x2065ab(0x1288))_0x47f874='对方已拒收';else _0x47f874=_0xadea07[_0x2065ab(0x113f)]||_0x2065ab(0xd24);}}}else{if(_0xadea07[_0x2065ab(0x1145)])_0x22e070=_0x2065ab(0xfb3)+_0x47e838,_0x47f874=_0x2065ab(0x33e);else{if(_0xadea07[_0x2065ab(0xcf7)]===_0xa8cc75){_0x22e070='转账给\x20'+_0xa8cc75;if(_0xadea07[_0x2065ab(0x8c8)]===_0x2065ab(0xe4b))_0x47f874=_0x2065ab(0x8cc);else{if(_0xadea07[_0x2065ab(0x8c8)]===_0x2065ab(0x1288))_0x47f874=_0x2065ab(0x565);else _0x4ab5cb[_0x2065ab(0x842)]['cursor']=_0x2065ab(0x630),_0x4ab5cb[_0x2065ab(0x323)]['status']=_0x2065ab(0xd2d),_0x47f874=_0xadea07['note']||_0x2065ab(0xe55);}}else _0x22e070=_0x2065ab(0x1050)+_0x47e838+_0x2065ab(0xf04)+_0x515e93,_0x47f874=_0xadea07[_0x2065ab(0x113f)]||'群聊内转账';}}const _0xa3bae6='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>';_0x5721b7=_0x2065ab(0xf33)+_0xa3bae6+'\x20'+_0x22e070+_0x2065ab(0x1186)+Number(_0xadea07[_0x2065ab(0x4c5)])[_0x2065ab(0x3c1)](0x2)+_0x2065ab(0xf5c)+_0x47f874+_0x2065ab(0xe35);}else{if(_0xadea07[_0x2065ab(0xde0)]===_0x2065ab(0x11b2)){_0x4ab5cb[_0x2065ab(0xb17)][_0x2065ab(0x3f4)](_0x2065ab(0x138),_0x2065ab(0x11be));if(_0xadea07['status']===_0x2065ab(0x1279)||_0xadea07[_0x2065ab(0x8c8)]==='rejected')_0x4ab5cb[_0x2065ab(0xb17)][_0x2065ab(0x3f4)](_0x2065ab(0xac9)+_0xadea07[_0x2065ab(0x8c8)]);const _0x884365=_0x1ba34a(_0x17cf68,_0xadea07['senderName']),_0xe9ccad=_0x2065ab(0x422)+_0x884365+_0x2065ab(0xf5e);let _0xb7e291='';_0xadea07[_0x2065ab(0x8c8)]===_0x2065ab(0xd2d)&&!_0xd6798d&&(_0xb7e291='<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>'),_0x5721b7='<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>'+_0xe9ccad+'</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥'+Number(_0xadea07[_0x2065ab(0x4c5)])[_0x2065ab(0x3c1)](0x2)+'</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-'+_0xadea07[_0x2065ab(0x351)]+_0x2065ab(0x654)+_0xb7e291+'</div>',setTimeout(()=>{const _0x310576=_0x2065ab;if(_0xadea07['status']==='pending'){const _0x34b66f=document['getElementById']('waimai-timer-'+_0xadea07[_0x310576(0x351)]);if(_0x34b66f){const _0x22c4c2=_0x3b31a1(_0x34b66f,_0xadea07[_0x310576(0x310)]);_0x4fd4bd[_0xadea07[_0x310576(0x351)]]=_0x22c4c2;}}},0x0);}else{if(_0xadea07['type']===_0x2065ab(0x1061)){_0x4ab5cb[_0x2065ab(0xb17)]['add']('is-waimai-request',_0x2065ab(0x11be));const _0x5111b8=_0x1ba34a(_0x17cf68,_0xadea07[_0x2065ab(0x770)]);let _0x45a390='你';_0x17cf68['isGroup']&&(_0x45a390=_0x1ba34a(_0x17cf68,_0xadea07[_0x2065ab(0x69f)])),_0x5721b7=_0x2065ab(0xdee)+_0x5111b8+_0x2065ab(0x86b)+_0x45a390+_0x2065ab(0x40a)+_0xadea07[_0x2065ab(0xc7a)]+_0x2065ab(0x6aa)+Number(_0xadea07[_0x2065ab(0x4c5)])[_0x2065ab(0x3c1)](0x2)+_0x2065ab(0x8a9);}else{if(_0xadea07['type']===_0x2065ab(0x59c)){_0x4ab5cb[_0x2065ab(0xb17)][_0x2065ab(0x3f4)](_0x2065ab(0x56f),_0x2065ab(0x11be));const _0x6835b=_0x405767[_0x2065ab(0x20a)][_0x2065ab(0xab3)]||_0x2065ab(0x2dc),_0x5741fe=_0xadea07[_0x2065ab(0x2a6)],_0x5b2195=_0xadea07[_0x2065ab(0x343)]&&_0xadea07['claimedBy'][_0x6835b];let _0x45592a='',_0x1e899e='',_0x107e02=_0x2065ab(0x30d);_0x5741fe&&(_0x45592a=_0x2065ab(0x96f));if(_0xadea07['packetType']===_0x2065ab(0x35c)){const _0x4ba833=_0x1ba34a(_0x17cf68,_0xadea07[_0x2065ab(0xcf7)]);_0x107e02=_0x2065ab(0x4a2)+_0x4ba833;if(Object[_0x2065ab(0xbda)](_0xadea07[_0x2065ab(0x343)]||{})[_0x2065ab(0x105a)]>0x0)_0x45592a=_0x2065ab(0x96f);}if(_0x5b2195){const _0x544201=_0xadea07[_0x2065ab(0x343)][_0x6835b]||0x0;_0x1e899e=_0x2065ab(0x417)+_0x544201[_0x2065ab(0x3c1)](0x2)+_0x2065ab(0x266);}else{if(_0x5741fe)_0x1e899e='<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>';else{if(_0xadea07[_0x2065ab(0x46b)]===_0x2065ab(0x35c)&&Object['keys'](_0xadea07['claimedBy']||{})[_0x2065ab(0x105a)]>0x0){const _0x14b5d1=_0x1ba34a(_0x17cf68,_0xadea07['receiverName']);_0x1e899e='<div\x20class=\x22rp-claimed-info\x22>已被\x20'+_0x14b5d1+_0x2065ab(0x555);}}}_0x5721b7=_0x2065ab(0xfdd)+_0x45592a+_0x2065ab(0x7d2)+(_0xadea07[_0x2065ab(0x26c)]||_0x2065ab(0x41b))+_0x2065ab(0x2e5)+_0x107e02+_0x2065ab(0x1079)+_0x1e899e+'</div>';}else{if(_0xadea07[_0x2065ab(0xde0)]==='poll'){_0x4ab5cb['classList']['add'](_0x2065ab(0xb53),'is-card-like');const _0x503678=_0xadea07['question']||_0xadea07['content']||_0x2065ab(0xc75);let _0x4dc272=0x0;const _0xc7f150={};for(const _0x877b39 in _0xadea07[_0x2065ab(0x2ab)]){const _0x64871f=_0xadea07[_0x2065ab(0x2ab)][_0x877b39][_0x2065ab(0x105a)];_0xc7f150[_0x877b39]=_0x64871f,_0x4dc272+=_0x64871f;}const _0x1f1b80=_0x405767[_0x2065ab(0x20a)][_0x2065ab(0xab3)]||_0x2065ab(0x2dc);let _0xc0c336=null;for(const _0xb421dc in _0xadea07[_0x2065ab(0x2ab)]){if(_0xadea07[_0x2065ab(0x2ab)][_0xb421dc]['includes'](_0x1f1b80)){_0xc0c336=_0xb421dc;break;}}let _0x5c46da=_0x2065ab(0x698);_0xadea07[_0x2065ab(0x320)][_0x2065ab(0x7c0)](_0x1667d3=>{const _0xe2ddd0=_0x2065ab,_0x1984ee=_0xc7f150[_0x1667d3]||0x0,_0x2ef09d=_0x4dc272>0x0?_0x1984ee/_0x4dc272*0x64:0x0,_0x46ace0=_0xc0c336===_0x1667d3;_0x5c46da+=_0xe2ddd0(0x97e)+(_0x46ace0?'voted':'')+'\x22\x20data-option=\x22'+_0x1667d3+_0xe2ddd0(0xd03)+_0x2ef09d+'%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>'+_0x1667d3+_0xe2ddd0(0x188)+_0x1984ee+_0xe2ddd0(0x831);}),_0x5c46da+=_0x2065ab(0x1079);let _0x4c1245=_0xadea07['isClosed']?_0x2065ab(0x465)+_0x4dc272+_0x2065ab(0xf83):_0x2065ab(0x465)+_0x4dc272+_0x2065ab(0xa2a);_0x5721b7=_0x2065ab(0x1290)+(_0xadea07[_0x2065ab(0x855)]?_0x2065ab(0xed4):'')+_0x2065ab(0x10d6)+_0xadea07['timestamp']+_0x2065ab(0xb25)+_0x503678+_0x2065ab(0x1079)+_0x5c46da+_0x4c1245+'</div>';}else{if(_0xadea07[_0x2065ab(0xde0)]==='gift'){_0x4ab5cb['classList'][_0x2065ab(0x3f4)](_0x2065ab(0x881),_0x2065ab(0x11be));let _0x373ffd;const _0x321b82=_0x17cf68[_0x2065ab(0x33a)][_0x2065ab(0xe16)]||'我';if(_0x17cf68[_0x2065ab(0x1000)]){if(_0xadea07[_0x2065ab(0x667)]&&_0xadea07[_0x2065ab(0x667)][_0x2065ab(0x105a)]>0x0){const _0x151da5=_0xadea07['recipients'][_0x2065ab(0x6b9)](_0x1dd514=>_0x1ba34a(_0x17cf68,_0x1dd514));_0x151da5[_0x2065ab(0x105a)]===0x1?_0x373ffd='送给\x20'+_0x151da5[0x0]+_0x2065ab(0xf81):_0x373ffd=_0x2065ab(0x103f)+_0x151da5['slice'](0x0,0x2)['join']('、')+_0x2065ab(0xd1a);}else _0x373ffd=_0x2065ab(0x3e2);}else{if(_0xd6798d)_0x373ffd=_0x2065ab(0x103f)+_0x17cf68[_0x2065ab(0x596)]+_0x2065ab(0xf81);else{const _0x4078f2=_0x17cf68[_0x2065ab(0x33a)][_0x2065ab(0xe16)]||'你';_0x373ffd=_0x2065ab(0x103f)+_0x4078f2+_0x2065ab(0xf81);}}const _0x25c5b1=_0xadea07[_0x2065ab(0x5de)][_0x2065ab(0x961)](0x0,0x3);let _0x2520d7='';_0x25c5b1[_0x2065ab(0x7c0)](_0x33c71a=>{const _0x266621=_0x2065ab;_0x2520d7+=_0x266621(0x7e0)+_0x33c71a[_0x266621(0x10d4)]+_0x266621(0x6bd)+_0x33c71a[_0x266621(0x596)]+_0x266621(0xf31)+_0x33c71a[_0x266621(0xe57)]+'</span></div>';});let _0x11c76d='';_0xadea07[_0x2065ab(0x5de)][_0x2065ab(0x105a)]>0x3&&(_0x11c76d='\x20等'+_0xadea07[_0x2065ab(0x5de)]['length']+_0x2065ab(0x1025)),_0x5721b7=_0x2065ab(0x432)+_0x373ffd+'</span></div><div\x20class=\x22gift-items-preview\x22>'+_0x2520d7+_0x2065ab(0xf52)+_0xadea07[_0x2065ab(0x5de)][_0x2065ab(0x105a)]+'件商品'+_0x11c76d+_0x2065ab(0x1003);}}}}}}}}}}}}}else{const _0x30086a=String(_0x436b5);let _0x14e6ae=await _0x2ae9a6(_0x30086a,_0x17cf68['id']);if(_0x14e6ae!==_0x30086a)_0x5721b7=_0x14e6ae,_0x4ab5cb[_0x2065ab(0xb17)][_0x2065ab(0x3f4)](_0x2065ab(0x11be));else{if(Array[_0x2065ab(0xb85)](_0xadea07[_0x2065ab(0x168)])&&_0xadea07['content'][0x0]?.[_0x2065ab(0xde0)]==='image_url'){const _0x22db1c=_0xadea07[_0x2065ab(0x168)][0x0][_0x2065ab(0x7a9)]['url'];_0x5721b7=_0x2065ab(0x333)+_0x22db1c+_0x2065ab(0xe8a);}else{if(_0x3ba794['test'](_0x14e6ae))_0x4ab5cb[_0x2065ab(0xb17)][_0x2065ab(0x3f4)](_0x2065ab(0xcb3),_0x2065ab(0x11be)),_0x5721b7=_0x2065ab(0x333)+_0x14e6ae+_0x2065ab(0x1023)+(_0xadea07[_0x2065ab(0x2b7)]||_0x2065ab(0x141))+_0x2065ab(0x3ce);else{let _0x19bed3=_0x206f67(_0x14e6ae,_0x17cf68);_0x5721b7=_0x16059c(_0x19bed3)[_0x2065ab(0x1b7)](/\n/g,'<br>');}}}}}_0x4ab5cb[_0x2065ab(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2a9a8a+_0x2065ab(0x423)+_0x1f0849+_0x2065ab(0xb35)+_0x5721b7+_0x2065ab(0x11cc),_0x333616[_0x2065ab(0x31e)](_0x4ab5cb),_0x333616['appendChild'](_0x43a5c2),_0x5dcbd7(_0x333616,()=>_0x457c69(_0xadea07['timestamp'])),_0x333616[_0x2065ab(0xae8)](_0x2065ab(0xa17),()=>{if(_0x324554)_0xd7c822(_0xadea07['timestamp']);});if(!_0xd6798d){const _0x10fdcc=_0x333616[_0x2065ab(0x1ad)](_0x2065ab(0x1034));_0x10fdcc&&(_0x10fdcc['style'][_0x2065ab(0x658)]=_0x2065ab(0x630),!_0x17cf68[_0x2065ab(0x1000)]?_0x10fdcc[_0x2065ab(0xae8)](_0x2065ab(0xa17),_0x2a62f3=>{const _0x59fd6a=_0x2065ab;_0x2a62f3[_0x59fd6a(0x601)](),_0x40eb65(_0x17cf68['id']);}):_0x10fdcc[_0x2065ab(0xae8)](_0x2065ab(0x39e),_0x47252d=>{const _0x301c0d=_0x2065ab;_0x47252d[_0x301c0d(0x601)](),_0x4803c2(_0x17cf68['id'],_0xadea07[_0x301c0d(0x770)]);}));}return _0x333616;}async function _0x5aabdc(_0x4a0a87,_0x4777ed){const _0x394028=_0x18b51e,_0x336b8c=document[_0x394028(0x8c2)](_0x394028(0xb24)),_0x54dd5c=await _0x3cd22d(_0x4a0a87,_0x4777ed);if(!_0x54dd5c)return;const _0x1448ea=document['getElementById'](_0x394028(0x4ce));_0x1448ea?_0x336b8c[_0x394028(0x1021)](_0x54dd5c,_0x1448ea['nextSibling']):_0x336b8c['prepend'](_0x54dd5c);}async function _0x5c5c92(_0x19abc7,_0x24b880,_0x40e908=![]){const _0x231efb=_0x18b51e,_0x655345=document['getElementById'](_0x231efb(0xb24)),_0x2a0080=document[_0x231efb(0x8c2)](_0x231efb(0x787)),_0x16dd8c=_0x24b880[_0x231efb(0xd39)][_0x231efb(0x1d8)](_0x1ba5a3=>!_0x1ba5a3['isHidden'])[_0x231efb(0xd64)]();if(_0x16dd8c&&_0x19abc7[_0x231efb(0x351)]-_0x16dd8c[_0x231efb(0x351)]>0x927c0){const _0x22a3e8=_0x436749(_0x19abc7['timestamp']);_0x655345[_0x231efb(0x1021)](_0x22a3e8,_0x2a0080);}const _0x3aa4b3=await _0x3cd22d(_0x19abc7,_0x24b880);if(!_0x3aa4b3)return;_0x19abc7[_0x231efb(0x14a)]===_0x231efb(0x458)&&!_0x40e908&&_0x36b53b(),!_0x40e908&&_0x3aa4b3[_0x231efb(0xb17)]['add']('animate-in'),_0x655345[_0x231efb(0x1021)](_0x3aa4b3,_0x2a0080),!_0x40e908&&(_0x655345['scrollTop']=_0x655345[_0x231efb(0xb43)],_0x5ea6d4++);}async function _0x426b8d(_0x37eda2){const _0x1883c5=_0x18b51e;_0x405767['activeChatId']=_0x37eda2;const _0x130be9=_0x405767[_0x1883c5(0x799)][_0x37eda2];if(!_0x130be9)return;_0x130be9['unreadCount']>0x0&&(_0x130be9[_0x1883c5(0xf10)]=0x0,await _0x15043e[_0x1883c5(0x799)][_0x1883c5(0xfaa)](_0x130be9));_0x37055b(_0x130be9),_0x7dbe71(_0x37eda2),_0x3d1990(_0x1883c5(0xd5c)),window[_0x1883c5(0xc43)](_0x405767[_0x1883c5(0x248)]);const _0x16fda2=_0x130be9[_0x1883c5(0x1000)]||![];_0x3263b2(_0x16fda2),document['getElementById'](_0x1883c5(0x2bb))['style']['display']=_0x16fda2?_0x1883c5(0xd52):_0x1883c5(0xbf8);const _0x46baec=document['getElementById'](_0x1883c5(0x7cc));_0x46baec&&(_0x46baec[_0x1883c5(0x842)][_0x1883c5(0x5e9)]=_0x16fda2?_0x1883c5(0xbf8):'flex');const _0x449d52=document[_0x1883c5(0x8c2)](_0x1883c5(0x77f)),_0x4beac7=document['getElementById']('open-shopping-btn'),_0x49a729=document[_0x1883c5(0x8c2)](_0x1883c5(0x987)),_0x329a15=document[_0x1883c5(0x8c2)](_0x1883c5(0x1298));_0x4beac7&&_0x49a729&&_0x329a15&&_0x449d52&&(_0x4beac7['style'][_0x1883c5(0x5e9)]=_0x1883c5(0xd52),_0x49a729[_0x1883c5(0x842)]['display']=_0x16fda2?'none':'flex',_0x329a15[_0x1883c5(0x842)][_0x1883c5(0x5e9)]=_0x16fda2?_0x1883c5(0xd52):'none',_0x449d52[_0x1883c5(0x842)][_0x1883c5(0x5e9)]=_0x16fda2?'none':_0x1883c5(0xd52)),_0xedf06(),!_0x130be9[_0x1883c5(0x1000)]&&_0x130be9[_0x1883c5(0x944)]?.['status']===_0x1883c5(0x10b6)&&(console[_0x1883c5(0x32b)](_0x1883c5(0x983)+_0x130be9[_0x1883c5(0x596)]+_0x1883c5(0xeda)),_0x523815()),document[_0x1883c5(0x8c2)](_0x1883c5(0x1a1))['style']['display']=_0x16fda2?_0x1883c5(0xd52):_0x1883c5(0xbf8);}function _0x24fb6c(_0x475467,_0x549e9a){const _0x2e992c=_0x18b51e,_0xbd53d2=_0x549e9a?_0x2e992c(0x3f4):_0x2e992c(0xaff),_0x4435b9=_0xafee40=>{const _0x4f5d6b=_0x2e992c;_0xafee40&&_0xafee40[_0x4f5d6b(0xb17)][_0xbd53d2](_0x4f5d6b(0x4fa));},_0x3b1d9c=document[_0x2e992c(0x1ad)](_0x2e992c(0xd28)+_0x475467+'\x22]\x20.avatar');_0x4435b9(_0x3b1d9c);const _0xc599d1=document[_0x2e992c(0xa2d)](_0x2e992c(0xaae)+_0x475467+'\x22]');_0xc599d1['forEach'](_0x4435b9);const _0x1e6d5a=document[_0x2e992c(0x1ad)](_0x2e992c(0x1027)+_0x475467+'\x22]');_0x4435b9(_0x1e6d5a);}async function _0x52aced(){const _0x4f21a7=_0x18b51e;if(!_0x405767['activeChatId'])return;const _0x46c0e3=_0x405767[_0x4f21a7(0x248)],_0x138eb8=_0x405767[_0x4f21a7(0x799)][_0x46c0e3];lastRawAiResponse='',lastResponseTimestamps=[];const _0x555dbe=document['getElementById'](_0x4f21a7(0x13a));_0x555dbe&&(_0x555dbe[_0x4f21a7(0x1033)]=!![],_0x555dbe[_0x4f21a7(0x1090)]=_0x4f21a7(0x126c));_0x24fb6c(_0x46c0e3,!![]);try{const {proxyUrl:_0x3cf5bc,apiKey:_0x3b099d,model:_0x28d9de}=_0x405767[_0x4f21a7(0x9e0)];if(!_0x3cf5bc||!_0x3b099d||!_0x28d9de)throw new Error('API未配置，无法生成对话。');const _0x4b1b69=parseInt(_0x138eb8[_0x4f21a7(0x33a)][_0x4f21a7(0x808)])||0xa,_0x1a37b1=_0x138eb8[_0x4f21a7(0xd39)][_0x4f21a7(0x961)](-_0x4b1b69);let _0x3c553f='';if(_0x138eb8[_0x4f21a7(0x33a)][_0x4f21a7(0xb77)]&&_0x138eb8[_0x4f21a7(0x33a)]['linkedWorldBookIds'][_0x4f21a7(0x105a)]>0x0){const _0x8eb209=_0x138eb8[_0x4f21a7(0x33a)][_0x4f21a7(0xb77)][_0x4f21a7(0x6b9)](_0x22f9b0=>{const _0x387f6e=_0x4f21a7,_0x3e00a7=_0x405767['worldBooks'][_0x387f6e(0x2ef)](_0xdfd952=>_0xdfd952['id']===_0x22f9b0);if(!_0x3e00a7||!Array['isArray'](_0x3e00a7[_0x387f6e(0x168)]))return'';const _0x5d8590=_0x3e00a7['content'][_0x387f6e(0x1d8)](_0x3b9893=>_0x3b9893['enabled']!==![])[_0x387f6e(0x6b9)](_0xa335b6=>{const _0x2576dc=_0x387f6e;let _0x25c7a0=_0x2576dc(0xf8d)+(_0xa335b6[_0x2576dc(0x120a)]||_0x2576dc(0x11db))+'\x0a';if(_0xa335b6['keys'][_0x2576dc(0x105a)]>0x0)_0x25c7a0+=_0x2576dc(0xdd1)+_0xa335b6[_0x2576dc(0xbda)]['join'](',\x20')+'\x0a';return _0x25c7a0+=_0x2576dc(0xce7)+_0xa335b6[_0x2576dc(0x168)],_0x25c7a0;})['join']('');return _0x5d8590?_0x387f6e(0x15d)+_0x3e00a7[_0x387f6e(0x596)]+'\x0a'+_0x5d8590:'';})[_0x4f21a7(0x1d8)](Boolean)[_0x4f21a7(0xb2c)]('');_0x8eb209&&(_0x3c553f=_0x4f21a7(0xcee)+_0x8eb209+_0x4f21a7(0x836));}let _0x2f6b5e=_0x4f21a7(0x205),_0xbf8d23=![];_0x138eb8[_0x4f21a7(0x635)]['forEach'](_0xb12fa2=>{const _0x4c5472=_0x4f21a7,_0x4fbca9=_0x405767[_0x4c5472(0x799)][_0xb12fa2['id']];_0x4fbca9&&_0x4fbca9[_0x4c5472(0xbca)]&&_0x4fbca9[_0x4c5472(0xbca)][_0x4c5472(0x105a)]>0x0&&(_0x2f6b5e+=_0x4c5472(0x1115)+_0xb12fa2['groupNickname']+_0x4c5472(0xb26),_0x2f6b5e+=_0x4fbca9[_0x4c5472(0xbca)]['map'](_0x1a5b40=>_0x4c5472(0xc09)+_0x4f34be(_0x1a5b40[_0x4c5472(0x351)])+')\x20'+_0x1a5b40['content'])[_0x4c5472(0xb2c)]('\x0a'),_0xbf8d23=!![]);});!_0xbf8d23&&(_0x2f6b5e+=_0x4f21a7(0xbee));let _0x163dfb='';const _0x179b42=_0x138eb8[_0x4f21a7(0x33a)][_0x4f21a7(0x57d)]||0xa;if(_0x138eb8['settings']['linkedMemoryChatIds']&&_0x138eb8['settings'][_0x4f21a7(0xb6e)]['length']>0x0){}const _0x351bf1=_0x138eb8[_0x4f21a7(0x635)][_0x4f21a7(0x6b9)](_0x57a90e=>_0x4f21a7(0xc39)+_0x57a90e[_0x4f21a7(0x375)]+_0x4f21a7(0x439)+_0x57a90e['originalName']+_0x4f21a7(0xd74)+_0x57a90e[_0x4f21a7(0x391)])[_0x4f21a7(0xb2c)]('\x0a'),_0x12274f=_0x4f21a7(0x4fc)+_0x138eb8[_0x4f21a7(0x596)]+'”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22url\x22:\x20\x22https://...表情URL...\x22,\x20\x22meaning\x22:\x20\x22(可选)表情含义\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20'+_0x138eb8[_0x4f21a7(0x596)]+_0x4f21a7(0x1125)+_0x2f6b5e+'\x0a'+_0x3c553f+'\x0a\x0a'+_0x163dfb+_0x4f21a7(0x9af)+_0x1a37b1[_0x4f21a7(0x6b9)](_0xa51868=>_0x1ba34a(_0x138eb8,_0xa51868[_0x4f21a7(0x770)])+':\x20'+_0xa51868[_0x4f21a7(0x168)])[_0x4f21a7(0xb2c)]('\x0a')+'\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a'+_0x351bf1+'\x0a\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a',_0xab4b5b=_0x1a37b1[_0x4f21a7(0x6b9)](_0x5560bb=>({'role':_0x4f21a7(0x74b),'content':_0x1ba34a(_0x138eb8,_0x5560bb['senderName'])+':\x20'+_0x5560bb['content']}));let _0x3efe6f=_0x3cf5bc[_0x4f21a7(0x773)]('generativelanguage.googleapis.com'),_0x5659f5;if(_0x3efe6f){let _0x5e4999=_0x282b7e(_0x28d9de,_0x3b099d,_0x12274f,_0xab4b5b);_0x5659f5=await fetch(_0x5e4999[_0x4f21a7(0x9d6)],_0x5e4999[_0x4f21a7(0x49a)]);}else _0x5659f5=await fetch(_0x3cf5bc+_0x4f21a7(0x5c1),{'method':_0x4f21a7(0xcd0),'headers':{'Content-Type':_0x4f21a7(0xcb6),'Authorization':'Bearer\x20'+_0x3b099d},'body':JSON[_0x4f21a7(0x1175)]({'model':_0x28d9de,'messages':[{'role':_0x4f21a7(0x46c),'content':_0x12274f},..._0xab4b5b],'temperature':_0x405767[_0x4f21a7(0xb73)][_0x4f21a7(0x8c7)]||0.9})});if(!_0x5659f5['ok']){const _0x427557=await _0x5659f5[_0x4f21a7(0x7e9)]()[_0x4f21a7(0x120c)](()=>({'error':{'message':_0x5659f5['statusText']}}));throw new Error(_0x4f21a7(0x1d9)+_0x5659f5['status']+_0x4f21a7(0x2e9)+(_0x427557[_0x4f21a7(0x7a3)]?.[_0x4f21a7(0xc7d)]||_0x4f21a7(0xa82)));}const _0x1482f6=await _0x5659f5[_0x4f21a7(0x7e9)](),_0x1ad4b9=getGeminiResponseText(_0x1482f6);lastRawAiResponse=_0x1ad4b9;const _0x568695=_0x5196dd(_0x1ad4b9);let _0x267204=Date['now']();for(const _0x4ec0cd of _0x568695){if(!_0x4ec0cd||!_0x4ec0cd['type']||!_0x4ec0cd[_0x4f21a7(0x596)])continue;let _0x279ac6=null;const _0x2372f8=_0x267204++;lastResponseTimestamps['push'](_0x2372f8);const _0x1def00={'role':_0x4f21a7(0x458),'senderName':_0x4ec0cd[_0x4f21a7(0x596)],'timestamp':_0x2372f8};switch(_0x4ec0cd['type']){case _0x4f21a7(0xbc6):_0x279ac6={..._0x1def00,'content':_0x4ec0cd[_0x4f21a7(0x168)]};break;case'sticker':_0x279ac6={..._0x1def00,'type':_0x4f21a7(0x1ac),'content':_0x4ec0cd[_0x4f21a7(0x9d6)],'meaning':_0x4ec0cd[_0x4f21a7(0x2b7)]||''};break;case _0x4f21a7(0x7c8):_0x279ac6={..._0x1def00,'type':_0x4f21a7(0x7c8),'content':_0x4ec0cd['description'],'image_prompt':_0x4ec0cd[_0x4f21a7(0xdae)]};break;case _0x4f21a7(0xf64):_0x279ac6={..._0x1def00,'type':_0x4f21a7(0xf64),'content':_0x4ec0cd['content']};break;case _0x4f21a7(0x58a):const _0x11b194=_0x138eb8['history'][_0x4f21a7(0x2ef)](_0x371676=>_0x371676['timestamp']===_0x4ec0cd[_0x4f21a7(0x656)]);_0x11b194?_0x279ac6={..._0x1def00,'content':_0x4ec0cd['reply_content'],'quote':{'timestamp':_0x11b194[_0x4f21a7(0x351)],'senderName':_0x11b194[_0x4f21a7(0x770)],'content':String(_0x11b194[_0x4f21a7(0x168)]||'')[_0x4f21a7(0x599)](0x0,0x32)}}:_0x279ac6={..._0x1def00,'content':_0x4ec0cd[_0x4f21a7(0xe6f)]};break;default:console[_0x4f21a7(0x112a)](_0x4f21a7(0xcc9),_0x4ec0cd['type']);continue;}_0x279ac6&&(_0x138eb8[_0x4f21a7(0xd39)][_0x4f21a7(0xa49)](_0x279ac6),_0x5c5c92(_0x279ac6,_0x138eb8),await new Promise(_0x4ba59c=>setTimeout(_0x4ba59c,Math['random']()*0x4b0+0x320)));}await _0x15043e[_0x4f21a7(0x799)]['put'](_0x138eb8),_0x2b55d1();}catch(_0x27bd3d){console[_0x4f21a7(0x7a3)](_0x4f21a7(0x83d),_0x27bd3d),await _0x501c7b(_0x4f21a7(0xa85),_0x4f21a7(0x436)+_0x27bd3d['message']);}finally{_0x555dbe&&(_0x555dbe[_0x4f21a7(0x1033)]=![],_0x555dbe[_0x4f21a7(0x1090)]=_0x4f21a7(0xe9f)),_0x24fb6c(_0x46c0e3,![]);}}async function _0x523815(){const _0x583c65=_0x18b51e;if(!_0x405767[_0x583c65(0x248)])return;const _0x284636=_0x405767[_0x583c65(0x248)],_0x46f493=_0x405767[_0x583c65(0x799)][_0x405767[_0x583c65(0x248)]],_0x535870=document[_0x583c65(0x8c2)](_0x583c65(0xd5c))['classList'][_0x583c65(0x795)]('active')&&_0x405767['activeChatId']===_0x284636;_0x24fb6c(_0x284636,!![]);const _0x4962b3=document[_0x583c65(0x8c2)]('chat-header-title'),_0x37ccd9=document['getElementById'](_0x583c65(0x787)),_0x2fbb73=document['querySelector'](_0x583c65(0xd28)+_0x284636+'\x22]'),_0x952c07=_0x2fbb73?_0x2fbb73[_0x583c65(0x1ad)](_0x583c65(0x67f)):null;_0x952c07&&_0x952c07[_0x583c65(0xb17)][_0x583c65(0x3f4)](_0x583c65(0x4fa));_0x46f493[_0x583c65(0x1000)]?_0x37ccd9&&(_0x37ccd9[_0x583c65(0x1090)]=_0x583c65(0xfde),_0x37ccd9[_0x583c65(0x842)][_0x583c65(0x5e9)]=_0x583c65(0xea7)):_0x4962b3&&(_0x4962b3['style'][_0x583c65(0x9d7)]=0x0,setTimeout(()=>{const _0xc388d7=_0x583c65;_0x4962b3[_0xc388d7(0x1090)]=_0xc388d7(0x354),_0x4962b3[_0xc388d7(0xb17)]['add']('typing-status'),_0x4962b3[_0xc388d7(0x842)][_0xc388d7(0x9d7)]=0x1;},0xc8));let _0x5c1ab5=![];try{const {proxyUrl:_0x5ecff7,apiKey:_0x4aaab5,model:_0x297b37}=_0x405767[_0x583c65(0x9e0)];if(!_0x5ecff7||!_0x4aaab5||!_0x297b37){alert(_0x583c65(0x9f5));if(_0x46f493['isGroup']){if(_0x37ccd9)_0x37ccd9['style'][_0x583c65(0x5e9)]=_0x583c65(0xbf8);}else _0x4962b3&&_0x405767[_0x583c65(0x799)][_0x284636]&&(_0x4962b3['textContent']=_0x405767['chats'][_0x284636]['name'],_0x4962b3['classList'][_0x583c65(0xaff)](_0x583c65(0xce9)));return;}const _0x1b92b8=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x961)](-0x1)[0x0],_0x175fca=_0x1b92b8&&_0x1b92b8[_0x583c65(0x14a)]===_0x583c65(0x46c)&&_0x1b92b8[_0x583c65(0x168)]['includes']('视频通话请求');if(_0x175fca){console[_0x583c65(0x32b)](_0x583c65(0xbe6)+_0x46f493[_0x583c65(0x596)]+_0x583c65(0xd29));let _0x443ab1;_0x46f493[_0x583c65(0x1000)]?_0x443ab1=_0x583c65(0x546)+_0x46f493['members'][_0x583c65(0x6b9)](_0x401e45=>'-\x20'+_0x401e45[_0x583c65(0x375)]+'\x20(本名:\x20'+_0x401e45['originalName']+'):\x20'+_0x401e45['persona'])[_0x583c65(0xb2c)]('\x0a')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。':_0x443ab1=_0x583c65(0xaf1)+_0x46f493[_0x583c65(0x33a)][_0x583c65(0x1060)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。';const _0xb5cecd=[{'role':_0x583c65(0x74b),'content':_0x443ab1}];try{let _0x32e2ed=_0x282b7e(_0x297b37,_0x4aaab5,_0x443ab1,_0xb5cecd),_0x4861d2=_0x5ecff7===GEMINI_API_URL;const _0x12de24=_0x4861d2?await fetch(_0x32e2ed['url'],_0x32e2ed[_0x583c65(0x49a)]):await fetch(_0x5ecff7+_0x583c65(0x5c1),{'method':_0x583c65(0xcd0),'headers':{'Content-Type':_0x583c65(0xcb6),'Authorization':_0x583c65(0xf42)+_0x4aaab5},'body':JSON[_0x583c65(0x1175)]({'model':_0x297b37,'messages':_0xb5cecd,'temperature':0.7})});if(!_0x12de24['ok'])throw new Error(_0x583c65(0x467)+(await _0x12de24[_0x583c65(0x7e9)]())[_0x583c65(0x7a3)]['message']);const _0x44d022=await _0x12de24[_0x583c65(0x7e9)](),_0x127934=getGeminiResponseText(_0x44d022),_0x109b76=_0x5196dd(_0x127934);let _0x4ee214=![];for(const _0x3cdbd2 of _0x109b76){if(_0x3cdbd2[_0x583c65(0xde0)]==='video_call_response'){_0x49beae[_0x583c65(0x324)]=![];if(_0x3cdbd2[_0x583c65(0x697)]===_0x583c65(0x104d))_0x543413();else{const _0x1ffc2c={'role':_0x583c65(0x458),'content':'对方拒绝了你的视频通话请求。','timestamp':Date[_0x583c65(0x1ed)]()};_0x46f493['history'][_0x583c65(0xa49)](_0x1ffc2c),await _0x15043e[_0x583c65(0x799)][_0x583c65(0xfaa)](_0x46f493),_0x3d1990(_0x583c65(0xd5c)),_0x7dbe71(_0x284636);}_0x4ee214=!![];break;}if(_0x3cdbd2[_0x583c65(0xde0)]===_0x583c65(0xe08)){if(_0x3cdbd2['decision']===_0x583c65(0xb2c)){const _0x5114a4=_0x46f493[_0x583c65(0x635)][_0x583c65(0x2ef)](_0x454428=>_0x454428['originalName']===_0x3cdbd2[_0x583c65(0x596)]);_0x5114a4&&!_0x49beae[_0x583c65(0x190)][_0x583c65(0xdc3)](_0x84ed0f=>_0x84ed0f['id']===_0x5114a4['id'])&&_0x49beae[_0x583c65(0x190)][_0x583c65(0xa49)](_0x5114a4);}_0x4ee214=!![];}}_0x4ee214&&_0x49beae[_0x583c65(0x390)]&&(_0x49beae[_0x583c65(0x324)]=![],_0x49beae['participants'][_0x583c65(0x105a)]>0x0?_0x543413():(_0x49beae={..._0x49beae,'isAwaitingResponse':![],'participants':[]},_0x3d1990(_0x583c65(0xd5c)),alert(_0x583c65(0xfdc))));}catch(_0x1541fb){console[_0x583c65(0x7a3)](_0x583c65(0x466),_0x1541fb);const _0x43fb99=_0x46f493[_0x583c65(0x1000)]?_0x46f493[_0x583c65(0x635)]['map'](_0x1137c4=>({'type':'group_call_response','name':_0x1137c4[_0x583c65(0x4e7)],'decision':_0x583c65(0xd61)})):[{'type':_0x583c65(0x729),'decision':_0x583c65(0x1ce)}];if(_0x46f493[_0x583c65(0x1000)])_0x49beae[_0x583c65(0x324)]=![],_0x49beae['participants']=[],alert('无人接听群聊邀请。'),_0x3d1990('chat-interface-screen');else{const _0x228f5f={'role':_0x583c65(0x458),'content':_0x583c65(0x5d8),'timestamp':Date['now']()};_0x46f493[_0x583c65(0xd39)]['push'](_0x228f5f),await _0x15043e['chats'][_0x583c65(0xfaa)](_0x46f493),_0x3d1990(_0x583c65(0xd5c)),_0x7dbe71(_0x284636);}}finally{_0x24fb6c(_0x284636,![]);return;}}if(!_0x46f493['isGroup']&&_0x46f493[_0x583c65(0x944)]?.[_0x583c65(0x8c8)]===_0x583c65(0x10b6)){console[_0x583c65(0x32b)](_0x583c65(0xf78)+_0x46f493['name']+_0x583c65(0x8d4));const _0x29970a=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x1d8)](_0x5e7181=>!_0x5e7181['isHidden'])[_0x583c65(0x961)](-0xa,-0x5)['map'](_0x35bf1f=>{const _0x577b5a=_0x583c65,_0x3487f5=_0x35bf1f[_0x577b5a(0x14a)]===_0x577b5a(0x74b)?'用户':_0x46f493['name'];return _0x3487f5+':\x20'+String(_0x35bf1f[_0x577b5a(0x168)])[_0x577b5a(0x599)](0x0,0x32)+_0x577b5a(0x388);})[_0x583c65(0xb2c)]('\x0a'),_0x24f1e8='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“'+_0x46f493[_0x583c65(0x596)]+_0x583c65(0x270)+_0x46f493[_0x583c65(0x33a)][_0x583c65(0x1060)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“'+_0x46f493[_0x583c65(0x944)][_0x583c65(0x727)]+_0x583c65(0x113c)+(_0x29970a||_0x583c65(0x296))+_0x583c65(0x19b);try{const _0x237a80=[{'role':_0x583c65(0x46c),'content':_0x24f1e8},{'role':_0x583c65(0x74b),'content':_0x583c65(0x906)}];let _0x55f3e3=_0x5ecff7===GEMINI_API_URL,_0x31d774=_0x282b7e(_0x297b37,_0x4aaab5,_0x24f1e8,[{'role':_0x583c65(0x74b),'content':_0x583c65(0x906)}]);const _0x1f8ee8=_0x55f3e3?await fetch(_0x31d774[_0x583c65(0x9d6)],_0x31d774['data']):await fetch(_0x5ecff7+_0x583c65(0x5c1),{'method':_0x583c65(0xcd0),'headers':{'Content-Type':_0x583c65(0xcb6),'Authorization':_0x583c65(0xf42)+_0x4aaab5},'body':JSON[_0x583c65(0x1175)]({'model':_0x297b37,'messages':_0x237a80,'temperature':_0x405767[_0x583c65(0xb73)][_0x583c65(0x8c7)]||0.8})});if(!_0x1f8ee8['ok'])throw new Error(_0x583c65(0x467)+(await _0x1f8ee8[_0x583c65(0x7e9)]())[_0x583c65(0x7a3)]['message']);const _0x1897ad=await _0x1f8ee8[_0x583c65(0x7e9)](),_0x2fa0c8=getGeminiResponseText(_0x1897ad)[_0x583c65(0x1b7)](/^```json\s*/,'')[_0x583c65(0x1b7)](/```$/,'')[_0x583c65(0x8c6)](),_0x4d90d5=JSON[_0x583c65(0x10ab)](_0x2fa0c8);if(_0x4d90d5[_0x583c65(0x697)]===_0x583c65(0x104d)){_0x46f493[_0x583c65(0x944)]['status']=_0x583c65(0xaa7);const _0x40df03={'role':_0x583c65(0x458),'senderName':_0x46f493[_0x583c65(0x596)],'content':_0x4d90d5[_0x583c65(0x29f)],'timestamp':Date['now']()};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0x40df03);}else{_0x46f493[_0x583c65(0x944)]['status']=_0x583c65(0x1058);const _0x3c9132={'role':'assistant','senderName':_0x46f493['name'],'content':_0x4d90d5[_0x583c65(0x29f)],'timestamp':Date[_0x583c65(0x1ed)]()};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0x3c9132);}_0x46f493[_0x583c65(0x944)][_0x583c65(0x727)]='',await _0x15043e[_0x583c65(0x799)][_0x583c65(0xfaa)](_0x46f493),_0x7dbe71(_0x284636),_0x2b55d1();}catch(_0x576476){_0x46f493[_0x583c65(0x944)][_0x583c65(0x8c8)]=_0x583c65(0x1058),await _0x15043e[_0x583c65(0x799)][_0x583c65(0xfaa)](_0x46f493),await _0x501c7b(_0x583c65(0x515),'AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20'+_0x576476[_0x583c65(0xc7d)]),_0x7dbe71(_0x284636);}return;}let _0x3021d0='';const _0x23308f=new Date(),_0x5be882=_0x46f493[_0x583c65(0x33a)][_0x583c65(0xd68)]||'Asia/Shanghai',_0x3079c4=_0x23308f[_0x583c65(0x2e8)]('zh-CN',{'timeZone':_0x5be882,'dateStyle':_0x583c65(0x196),'timeStyle':'short'}),_0x7ad868=new Date(_0x23308f[_0x583c65(0x2e8)](_0x583c65(0x85a),{'timeZone':_0x5be882})),_0x5c5e82=_0x1a88fc(_0x7ad868);let _0x14b32c,_0x2d5d1d;const _0x48e191=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x1d8)](_0x394a0b=>_0x394a0b[_0x583c65(0x3f1)])[_0x583c65(0xd64)]();if(_0x48e191&&_0x48e191[_0x583c65(0x168)][_0x583c65(0x773)](_0x583c65(0xc23))){const _0x10ff5b=await _0x15043e['callRecords'][_0x583c65(0xdb8)](_0x583c65(0xb3d))['equals'](_0x284636)[_0x583c65(0x4b5)]();if(_0x10ff5b&&_0x10ff5b[_0x583c65(0xe01)]){console[_0x583c65(0x32b)](_0x583c65(0x1b3));const _0x598a19=_0x10ff5b['transcript']['map'](_0x4b51e0=>{const _0x93fa47=_0x583c65,_0x15d75f=_0x4b51e0[_0x93fa47(0x14a)]===_0x93fa47(0x74b)?_0x46f493[_0x93fa47(0x33a)]['myNickname']||'我':_0x4b51e0[_0x93fa47(0x770)];return _0x15d75f+':\x20'+_0x4b51e0['content'];})['join']('\x0a');_0x3021d0=_0x583c65(0xf7b)+_0x598a19+'\x0a---\x0a';}}const _0x256970=_0x2de4e7(_0x5d05df[_0x284636]);let _0x9a380a='';if(_0x46f493[_0x583c65(0x33a)][_0x583c65(0xb77)]&&_0x46f493['settings'][_0x583c65(0xb77)][_0x583c65(0x105a)]>0x0){const _0x1c8420=_0x46f493[_0x583c65(0x33a)][_0x583c65(0xb77)]['map'](_0x44db13=>{const _0x3c6adb=_0x583c65,_0x5c9de0=_0x405767[_0x3c6adb(0x40e)]['find'](_0xcc75e9=>_0xcc75e9['id']===_0x44db13);if(!_0x5c9de0||!Array[_0x3c6adb(0xb85)](_0x5c9de0['content']))return'';const _0xc55619=_0x5c9de0[_0x3c6adb(0x168)][_0x3c6adb(0x1d8)](_0x3c38d0=>_0x3c38d0[_0x3c6adb(0x69a)]!==![])[_0x3c6adb(0x6b9)](_0x10f4f3=>{const _0xa65574=_0x3c6adb;let _0x1bd2b6=_0xa65574(0xf8d)+(_0x10f4f3[_0xa65574(0x120a)]||_0xa65574(0x11db))+'\x0a';return _0x10f4f3[_0xa65574(0xbda)][_0xa65574(0x105a)]>0x0&&(_0x1bd2b6+='**关键词:**\x20'+_0x10f4f3[_0xa65574(0xbda)]['join'](',\x20')+'\x0a'),_0x1bd2b6+=_0xa65574(0xce7)+_0x10f4f3[_0xa65574(0x168)],_0x1bd2b6;})[_0x3c6adb(0xb2c)]('');return _0xc55619?_0x3c6adb(0x15d)+_0x5c9de0[_0x3c6adb(0x596)]+'\x0a'+_0xc55619:'';})[_0x583c65(0x1d8)](Boolean)['join']('');_0x1c8420&&(_0x9a380a='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x1c8420+_0x583c65(0x836));}let _0x202bcf='';if(_0x4a77e1[_0x583c65(0x6f0)]&&_0x4a77e1[_0x583c65(0x248)]===_0x284636){const _0x4a1cb5=_0x4a77e1['currentIndex']>-0x1?_0x4a77e1[_0x583c65(0xcfa)][_0x4a77e1[_0x583c65(0x585)]]:null,_0x1a5428=_0x4a77e1[_0x583c65(0xcfa)]['map'](_0x187e4d=>'\x22'+_0x187e4d[_0x583c65(0x596)]+'\x22')[_0x583c65(0xb2c)](',\x20');let _0x2e3f05='';if(_0x4a1cb5&&_0x4a77e1[_0x583c65(0x619)]&&_0x4a77e1[_0x583c65(0x619)][_0x583c65(0x105a)]>0x0&&_0x4a77e1[_0x583c65(0x117a)]>-0x1){const _0x558903=_0x4a77e1[_0x583c65(0x619)][_0x4a77e1['currentLyricIndex']],_0x3bb60b=_0x4a77e1[_0x583c65(0x619)][_0x583c65(0x961)](_0x4a77e1[_0x583c65(0x117a)]+0x1,_0x4a77e1['currentLyricIndex']+0x3);_0x2e3f05+=_0x583c65(0xad8)+_0x558903['text']+'\x22\x0a',_0x3bb60b[_0x583c65(0x105a)]>0x0&&(_0x2e3f05+=_0x583c65(0x1dc)+_0x3bb60b['map'](_0x426abb=>'\x22'+_0x426abb[_0x583c65(0xbc6)]+'\x22')['join']('\x20/\x20')+'\x0a');}_0x202bcf=_0x583c65(0xe04)+(_0x4a1cb5?'《'+_0x4a1cb5[_0x583c65(0x596)]+_0x583c65(0xe5b)+_0x4a1cb5['artist']:'无')+_0x583c65(0x960)+_0x1a5428+']\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2e3f05+_0x583c65(0x24a);}const _0x2e10ca=parseInt(_0x46f493[_0x583c65(0x33a)][_0x583c65(0x808)])||0xa,_0x1b9265=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x961)](-_0x2e10ca);let _0x413061='';const _0x57005a=_0x46f493[_0x583c65(0xd39)]['findLastIndex'](_0x584e57=>_0x584e57[_0x583c65(0x14a)]===_0x583c65(0x458)),_0x3a3eca=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x961)](_0x57005a+0x1),_0x3cc576=_0x3a3eca[_0x583c65(0x2ef)](_0xf8198d=>_0xf8198d[_0x583c65(0xde0)]===_0x583c65(0x126b));if(_0x3cc576){const _0x3f7253=_0x3cc576[_0x583c65(0xba9)],_0x4734d8=_0x3f7253[_0x583c65(0xceb)][_0x583c65(0x6b9)](_0x5bb511=>{const _0x2c0df8=_0x583c65,_0x358aed=_0x5bb511[_0x2c0df8(0x770)]||(_0x5bb511['role']===_0x2c0df8(0x74b)?_0x46f493[_0x2c0df8(0x33a)][_0x2c0df8(0xe16)]||'我':_0x2c0df8(0x344));let _0x5afb9e='';if(_0x5bb511['type']===_0x2c0df8(0xf64))_0x5afb9e=_0x2c0df8(0x150)+_0x5bb511[_0x2c0df8(0x168)]+']';else{if(_0x5bb511[_0x2c0df8(0xde0)]===_0x2c0df8(0x7c8))_0x5afb9e=_0x2c0df8(0xfcb)+_0x5bb511['description']+']';else _0x5afb9e=String(_0x5bb511['content']);}return _0x358aed+':\x20'+_0x5afb9e;})[_0x583c65(0xb2c)]('\x0a');_0x413061=_0x583c65(0x996)+_0x3f7253[_0x583c65(0x70d)]+'”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4734d8+_0x583c65(0x10e0);}let _0x1eba10='';const _0x7b6c9d=_0x46f493[_0x583c65(0x33a)][_0x583c65(0x57d)]||0xa;if(_0x46f493['settings'][_0x583c65(0xb6e)]&&_0x46f493['settings']['linkedMemoryChatIds'][_0x583c65(0x105a)]>0x0){const _0x3d0d9b=_0x46f493[_0x583c65(0x33a)][_0x583c65(0xb6e)][_0x583c65(0x1d8)](_0x1647c9=>_0x1647c9!==_0x284636);if(_0x3d0d9b[_0x583c65(0x105a)]>0x0){const _0x114eac=_0x3d0d9b[_0x583c65(0x6b9)](_0x588a08=>{const _0x46b90a=_0x583c65,_0x1a2b9a=_0x405767[_0x46b90a(0x799)][_0x588a08];if(!_0x1a2b9a)return null;const _0x26897c=_0x1a2b9a[_0x46b90a(0xd39)][_0x46b90a(0x961)](-0x1);return{'chat':_0x1a2b9a,'latestTimestamp':_0x26897c?_0x26897c[_0x46b90a(0x351)]:0x0};})[_0x583c65(0x1d8)](Boolean);_0x114eac[_0x583c65(0xa19)]((_0x5c90be,_0x2cb22b)=>_0x2cb22b['latestTimestamp']-_0x5c90be[_0x583c65(0x11aa)]),_0x1eba10+=_0x583c65(0xa50);for(const _0x4c856d of _0x114eac){const _0x521cd0=_0x4c856d[_0x583c65(0x6d4)],_0x22229d=_0x521cd0[_0x583c65(0x1000)]?_0x583c65(0xe4f):'[私聊]',_0x43e4be=_0x4c856d[_0x583c65(0x11aa)]>0x0?_0x583c65(0xd7c)+_0x4f34be(_0x4c856d[_0x583c65(0x11aa)])+')':'';_0x1eba10+=_0x583c65(0x1bf)+_0x22229d+'“'+_0x521cd0[_0x583c65(0x596)]+_0x583c65(0x4eb)+_0x43e4be+_0x583c65(0x100a);const _0x334fc0=_0x521cd0[_0x583c65(0xd39)][_0x583c65(0x961)](-_0x7b6c9d),_0x532ca1=_0x334fc0[_0x583c65(0x1d8)](_0x1d25d7=>!String(_0x1d25d7[_0x583c65(0x168)])['includes'](_0x583c65(0x257)));_0x532ca1['length']>0x0?_0x532ca1[_0x583c65(0x7c0)](_0x11c91a=>{const _0x434cc4=_0x583c65,_0x366ee2=_0x11c91a[_0x434cc4(0x14a)]===_0x434cc4(0x74b)?_0x521cd0['settings'][_0x434cc4(0xe16)]||'我':_0x11c91a[_0x434cc4(0x770)]||_0x521cd0['name'];let _0xbad3ff=String(_0x11c91a[_0x434cc4(0x168)]);if(_0x11c91a[_0x434cc4(0xde0)]===_0x434cc4(0x7c8)||_0x11c91a[_0x434cc4(0xde0)]===_0x434cc4(0x223))_0xbad3ff=_0x434cc4(0xb60)+_0x11c91a[_0x434cc4(0x168)]+']';else _0x11c91a[_0x434cc4(0xde0)]===_0x434cc4(0xf64)&&(_0xbad3ff=_0x434cc4(0xc6e)+_0x11c91a[_0x434cc4(0x168)]+']');const _0xf99899=_0x4f34be(_0x11c91a[_0x434cc4(0x351)]);_0x1eba10+='('+_0xf99899+')\x20'+_0x366ee2+':\x20'+_0xbad3ff+'\x0a';}):_0x1eba10+=_0x583c65(0x3dc);}}}console[_0x583c65(0x32b)](_0x583c65(0x1194),_0x1eba10);if(_0x46f493[_0x583c65(0x1000)]){let _0x241522='';const _0x598ae1=_0x46f493[_0x583c65(0x33a)]['linkedMemoryCount']||0xa;if(_0x46f493[_0x583c65(0x33a)][_0x583c65(0xb6e)]&&_0x46f493[_0x583c65(0x33a)]['linkedMemoryChatIds'][_0x583c65(0x105a)]>0x0){const _0x4ef0b1=_0x46f493[_0x583c65(0x33a)][_0x583c65(0xb6e)][_0x583c65(0x1d8)](_0x345a91=>_0x345a91!==_0x284636);if(_0x4ef0b1[_0x583c65(0x105a)]>0x0){const _0x68f049=_0x4ef0b1['map'](_0x165ac3=>{const _0x4a2e78=_0x583c65,_0x27eeb9=_0x405767[_0x4a2e78(0x799)][_0x165ac3];if(!_0x27eeb9)return null;const _0x581c1b=_0x27eeb9[_0x4a2e78(0xd39)]['slice'](-0x1);return{'chat':_0x27eeb9,'latestTimestamp':_0x581c1b?_0x581c1b[_0x4a2e78(0x351)]:0x0};})[_0x583c65(0x1d8)](Boolean);_0x68f049[_0x583c65(0xa19)]((_0x487559,_0x12160a)=>_0x12160a[_0x583c65(0x11aa)]-_0x487559[_0x583c65(0x11aa)]),_0x241522+=_0x583c65(0x819);for(const _0x332f88 of _0x68f049){const _0xddd486=_0x332f88[_0x583c65(0x6d4)],_0x19c6c1=_0xddd486['isGroup']?'[群聊]':_0x583c65(0x717),_0x1a0e46=_0x332f88[_0x583c65(0x11aa)]>0x0?'\x20(最后互动于\x20'+_0x4f34be(_0x332f88['latestTimestamp'])+')':'';_0x241522+=_0x583c65(0x1bf)+_0x19c6c1+'“'+_0xddd486['name']+_0x583c65(0x4eb)+_0x1a0e46+_0x583c65(0x100a);const _0x54543a=_0xddd486[_0x583c65(0xd39)][_0x583c65(0x961)](-_0x598ae1),_0x3de952=_0x54543a[_0x583c65(0x1d8)](_0x1a285c=>!String(_0x1a285c[_0x583c65(0x168)])[_0x583c65(0x773)](_0x583c65(0x257)));_0x3de952[_0x583c65(0x105a)]>0x0?_0x3de952['forEach'](_0x1925e7=>{const _0x44d8e6=_0x583c65,_0x23829a=_0x1925e7[_0x44d8e6(0x14a)]===_0x44d8e6(0x74b)?_0xddd486[_0x44d8e6(0x33a)][_0x44d8e6(0xe16)]||'我':_0x1925e7[_0x44d8e6(0x770)]||_0xddd486[_0x44d8e6(0x596)];let _0x59bf74=String(_0x1925e7['content']);if(_0x1925e7[_0x44d8e6(0xde0)]===_0x44d8e6(0x7c8)||_0x1925e7[_0x44d8e6(0xde0)]===_0x44d8e6(0x223))_0x59bf74=_0x44d8e6(0xb60)+_0x1925e7['content']+']';else _0x1925e7[_0x44d8e6(0xde0)]===_0x44d8e6(0xf64)&&(_0x59bf74=_0x44d8e6(0xc6e)+_0x1925e7['content']+']');_0x241522+=_0x23829a+':\x20'+_0x59bf74+'\x0a';}):_0x241522+=_0x583c65(0x3dc);}}}let _0x497efe=_0x583c65(0x205),_0x20b954=![];_0x46f493[_0x583c65(0x635)]['forEach'](_0x201d74=>{const _0x3a4c7a=_0x583c65,_0x276eaa=_0x405767['chats'][_0x201d74['id']];_0x276eaa&&_0x276eaa[_0x3a4c7a(0xbca)]&&_0x276eaa[_0x3a4c7a(0xbca)][_0x3a4c7a(0x105a)]>0x0&&(_0x497efe+=_0x3a4c7a(0x1115)+_0x201d74['groupNickname']+_0x3a4c7a(0xb26),_0x497efe+=_0x276eaa[_0x3a4c7a(0xbca)]['map'](_0x16ce19=>_0x3a4c7a(0xc09)+_0x4f34be(_0x16ce19[_0x3a4c7a(0x351)])+')\x20'+_0x16ce19[_0x3a4c7a(0x168)])[_0x3a4c7a(0xb2c)]('\x0a'),_0x20b954=!![]);});!_0x20b954&&(_0x497efe+='-\x20(暂无)');let _0x512c90='',_0x114db6=![];if(_0x46f493[_0x583c65(0x33a)][_0x583c65(0xe87)]){const _0x4d529a=_0x1b9265[_0x583c65(0x961)](-0x1)[0x0];if(_0x4d529a){const _0x397705=_0x3dbc6f(_0x4d529a['timestamp']);_0x512c90=_0x583c65(0x312)+_0x397705+'。';const _0x4611a9=(Date[_0x583c65(0x1ed)]()-_0x4d529a[_0x583c65(0x351)])/(0x3e8*0x3c*0x3c);if(_0x4611a9>0x3){_0x114db6=!![];const _0x193d14=Math[_0x583c65(0x10b2)](_0x4611a9/0x18);_0x512c90+=_0x583c65(0x532)+(_0x193d14>0x0?_0x193d14+'天':Math[_0x583c65(0x10b2)](_0x4611a9)+'小时')+'。';}}else _0x512c90=_0x583c65(0x6f2);}const _0x4ba2c9=await _0x15043e[_0x583c65(0x221)][_0x583c65(0x6be)]();let _0x1b8cea='';_0x4ba2c9['length']>0x0&&(_0x1b8cea=_0x583c65(0x74e),_0x4ba2c9[_0x583c65(0x7c0)](_0x5959f4=>{const _0x4b71fc=_0x583c65;_0x1b8cea+=_0x4b71fc(0x1243)+_0x5959f4['id']+_0x4b71fc(0xa53)+_0x5959f4['name']+',\x20价格:\x20¥'+_0x5959f4[_0x4b71fc(0x2ea)][_0x4b71fc(0x3c1)](0x2)+'\x0a';}));let _0x536e2b=_0x46f493[_0x583c65(0x635)][_0x583c65(0x6b9)](_0x111af6=>{const _0x50a034=_0x583c65,_0xc036e8=_0x405767[_0x50a034(0x799)][_0x111af6['id']];let _0x45a1d2=_0x50a034(0x52d);if(_0xc036e8&&_0xc036e8[_0x50a034(0x40f)]){const _0x120917=Object[_0x50a034(0x22f)](_0x405767['chats'])[_0x50a034(0x1d8)](_0x4cac50=>!_0x4cac50[_0x50a034(0x1000)]&&_0x4cac50['id']!==_0x111af6['id']&&_0x4cac50[_0x50a034(0x40f)]===_0xc036e8[_0x50a034(0x40f)]);_0x120917[_0x50a034(0x105a)]>0x0&&(_0x45a1d2=_0x50a034(0x769)+_0x120917[_0x50a034(0x6b9)](_0x10b917=>_0x10b917['name'])['join']('、\x20'));}return'-\x20**'+_0x111af6[_0x50a034(0x375)]+_0x50a034(0x439)+_0x111af6[_0x50a034(0x4e7)]+'):\x20'+_0x111af6[_0x50a034(0x391)]+_0x50a034(0x562)+_0x45a1d2+']';})[_0x583c65(0xb2c)]('\x0a');const _0x1c04b6=_0x46f493[_0x583c65(0x33a)][_0x583c65(0xe16)]||'我',_0xdd6a07=_0x405767[_0x583c65(0x20a)]['nickname']||'{{user}}';let _0xce564b='';const _0x4601ec=(_0x46f493[_0x583c65(0x5d6)]||[])['filter'](_0x2d7de9=>_0x2d7de9[_0x583c65(0xe06)]);_0x4601ec[_0x583c65(0x105a)]>0x0&&(_0xce564b+=_0x583c65(0x2d4),_0x4601ec[_0x583c65(0x7c0)](_0x5d6583=>{const _0x318940=_0x583c65,_0x3ee0f1=_0x46f493[_0x318940(0xd39)]['find'](_0x1c1cfd=>_0x1c1cfd[_0x318940(0x351)]===_0x5d6583[_0x318940(0x5a8)]);if(_0x3ee0f1){let _0x1901b9=String(_0x3ee0f1['content']||'');_0x3ee0f1['type']==='ai_image'&&(_0x1901b9='[图片内容:\x20'+_0x1901b9+']'),_0xce564b+=_0x318940(0x74d)+_0x1901b9+_0x318940(0xde1)+_0x5d6583[_0x318940(0x11bf)]+_0x318940(0xe0a);}}),_0xce564b+=_0x583c65(0xd14));const _0x326058=_0x46f493[_0x583c65(0x635)]['map'](_0x107605=>_0x107605[_0x583c65(0x4e7)]),_0x1fd9b4=_0x583c65(0x1ee)+_0x326058[_0x583c65(0xb2c)]('、\x20')+']';let _0x598349=_0x583c65(0xf4b);_0x46f493[_0x583c65(0x33a)]['groupAvatarLibrary']&&_0x46f493['settings'][_0x583c65(0x227)][_0x583c65(0x105a)]>0x0?_0x598349+=_0x46f493['settings'][_0x583c65(0x227)]['map'](_0x2acc03=>'-\x20'+_0x2acc03[_0x583c65(0x596)])[_0x583c65(0xb2c)]('\x0a'):_0x598349+=_0x583c65(0x125c);const _0x7f9b10=_0x4e8d2c(_0x284636),_0x35cdd7=_0x5e1bc2(_0x46f493,0x3,_0x583c65(0x834)),_0x1d0bbc=_0x5e1bc2(_0x46f493,0x6,'hours'),_0x2ce977=_0x5e1bc2(_0x46f493,0x9,_0x583c65(0x834)),_0x2345b2=_0x5e1bc2(_0x46f493,0x1,'days'),_0x563dcb=_0x5e1bc2(_0x46f493,0x3,_0x583c65(0x1a0)),_0x5d4f1e=_0x5e1bc2(_0x46f493,0x7,_0x583c65(0x1a0));let _0x553383='';if(_0x35cdd7||_0x1d0bbc||_0x2ce977||_0x2345b2||_0x563dcb||_0x5d4f1e){_0x553383+=_0x583c65(0x7f7);if(_0x35cdd7)_0x553383+=_0x35cdd7;if(_0x1d0bbc)_0x553383+=_0x1d0bbc;if(_0x2ce977)_0x553383+=_0x2ce977;if(_0x35cdd7||_0x1d0bbc||_0x2ce977)_0x553383+='\x0a';if(_0x2345b2)_0x553383+=_0x2345b2;if(_0x563dcb)_0x553383+=_0x563dcb;if(_0x5d4f1e)_0x553383+=_0x5d4f1e;}_0x14b32c=_0x583c65(0x91e)+_0x1c04b6+_0x583c65(0x8d3)+_0xdd6a07+'】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22'+_0x1c04b6+_0x583c65(0x8f5)+_0x46f493[_0x583c65(0x596)]+_0x583c65(0x7f4)+(_0x46f493['settings'][_0x583c65(0xe87)]?_0x583c65(0x2a1)+_0x3079c4+_0x583c65(0x11b7)+(_0x114db6?_0x583c65(0x1139)+_0x512c90+'\x20你应该让角色们主动开启新话题来打破沉默。':''):'')+_0x583c65(0x9a5)+(_0x7f9b10?_0x583c65(0x9e9)+_0x7f9b10:'你们没有在读书。')+'\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20'+_0x46f493[_0x583c65(0x596)]+'\x0a'+(_0x46f493['settings'][_0x583c65(0xe87)]?_0x583c65(0x11d6)+_0x512c90:'')+_0x583c65(0x701)+_0x536e2b+'\x0a#\x20用户的角色\x0a-\x20**'+_0x1c04b6+'**:\x20'+_0x46f493[_0x583c65(0x33a)]['myPersona']+_0x583c65(0x9ea)+_0x9a380a+'\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a'+_0x497efe+'\x0a'+(_0x46f493[_0x583c65(0xbca)]&&_0x46f493[_0x583c65(0xbca)][_0x583c65(0x105a)]>0x0?_0x46f493[_0x583c65(0xbca)][_0x583c65(0x6b9)](_0x519fc6=>'-\x20'+_0x519fc6[_0x583c65(0x168)])[_0x583c65(0xb2c)]('\x0a'):_0x583c65(0xbee))+'\x0a'+_0x553383+'\x0a'+_0x241522+'\x0a'+_0x202bcf+'\x0a'+_0x413061+'\x0a'+_0x598349+'\x0a\x0a'+_0x1fd9b4+'\x0a'+_0x3021d0+_0x583c65(0x6dd),_0x2d5d1d=_0x1b9265['map'](_0x1bcf58=>{const _0x4ecf24=_0x583c65,_0x246d7c=_0x1bcf58[_0x4ecf24(0x14a)]===_0x4ecf24(0x74b)?_0x1c04b6:_0x1bcf58[_0x4ecf24(0x770)];let _0x318483=''+_0x246d7c;if(_0x1bcf58[_0x4ecf24(0x9d2)]){const _0x140bf1=String(_0x1bcf58[_0x4ecf24(0x9d2)][_0x4ecf24(0x168)]||'')[_0x4ecf24(0x599)](0x0,0x32);_0x318483+=_0x4ecf24(0x9cf)+_0x1bcf58[_0x4ecf24(0x9d2)][_0x4ecf24(0x770)]+_0x4ecf24(0x547)+_0x140bf1+'...\x22)';}_0x318483+=':\x20';let _0x510402;if(_0x1bcf58[_0x4ecf24(0xde0)]===_0x4ecf24(0x223))_0x510402='['+_0x246d7c+'\x20发送了一张图片，内容是：\x27'+_0x1bcf58[_0x4ecf24(0x168)]+'\x27]';else{if(_0x1bcf58[_0x4ecf24(0xde0)]===_0x4ecf24(0x7c8))_0x510402='['+_0x246d7c+'\x20发送了一张图片，图片内容描述为：\x27'+_0x1bcf58['content']+'\x27]';else{if(_0x1bcf58[_0x4ecf24(0xde0)]===_0x4ecf24(0xf64))_0x510402='['+_0x246d7c+'\x20发送了一条语音，内容是：\x27'+_0x1bcf58['content']+'\x27]';else{if(_0x1bcf58[_0x4ecf24(0xde0)]===_0x4ecf24(0x11b9))_0x510402='['+_0x1bcf58[_0x4ecf24(0x770)]+_0x4ecf24(0xa26)+_0x1bcf58[_0x4ecf24(0xcf7)]+'\x20转账\x20'+_0x1bcf58[_0x4ecf24(0x4c5)]+_0x4ecf24(0xc47)+_0x1bcf58['note']+']';else{if(_0x1bcf58['type']===_0x4ecf24(0xfbe))_0x510402='['+_0x246d7c+_0x4ecf24(0x1db)+_0x1bcf58['content']+'\x27]';else{if(_0x1bcf58[_0x4ecf24(0xde0)]===_0x4ecf24(0xa8b)){const _0x4dff87=_0x1bcf58[_0x4ecf24(0xb64)]?'并评论说：“'+_0x1bcf58[_0x4ecf24(0xb64)]+'”':'';let _0xb36e36=_0x4ecf24(0xfbf);const _0x3beb52=_0x1bcf58['originalPost'][_0x4ecf24(0x802)];if(_0x3beb52===_0x4ecf24(0x74b))_0xb36e36=_0x405767[_0x4ecf24(0x20a)][_0x4ecf24(0xab3)];else _0x405767['chats'][_0x3beb52]&&(_0xb36e36=_0x405767[_0x4ecf24(0x799)][_0x3beb52]['name']);let _0xfe6ee8;const _0xb39b71=_0x1bcf58[_0x4ecf24(0x693)];if(_0xb39b71[_0x4ecf24(0xde0)]===_0x4ecf24(0xe36))_0xfe6ee8=_0x4ecf24(0x102c)+(_0xb39b71[_0x4ecf24(0x55d)]||'')+_0x4ecf24(0x106e)+(_0xb39b71['hiddenContent']||'')[_0x4ecf24(0x599)](0x0,0x28)+_0x4ecf24(0x2e4);else _0xb39b71['type']==='image_post'?_0xfe6ee8=_0x4ecf24(0x7e7)+(_0xb39b71[_0x4ecf24(0x55d)]||'')+_0x4ecf24(0x106e)+(_0xb39b71['imageDescription']||'')[_0x4ecf24(0x599)](0x0,0x28)+_0x4ecf24(0x2e4):_0xfe6ee8='“'+(_0xb39b71[_0x4ecf24(0x168)]||'')['substring'](0x0,0x28)+_0x4ecf24(0xa16);_0x510402='['+_0x246d7c+_0x4ecf24(0xd07)+_0xb36e36+_0x4ecf24(0xb0e)+_0x4dff87+'【原动态内容:\x20'+_0xfe6ee8+'】]';}else{if(_0x1bcf58[_0x4ecf24(0xde0)]===_0x4ecf24(0x11b2))_0x1bcf58[_0x4ecf24(0x8c8)]===_0x4ecf24(0x1279)?_0x510402=_0x4ecf24(0x87a)+_0x1bcf58['paidBy']+_0x4ecf24(0xb13)+_0x246d7c+_0x4ecf24(0x33d)+_0x1bcf58[_0x4ecf24(0x4c5)]+'\x20元。此订单已完成。]':_0x510402='['+_0x246d7c+'\x20发起了外卖代付请求，商品是“'+_0x1bcf58[_0x4ecf24(0xc7a)]+_0x4ecf24(0xc94)+_0x1bcf58[_0x4ecf24(0x4c5)]+'\x20元，订单时间戳为\x20'+_0x1bcf58[_0x4ecf24(0x351)]+']';else{if(_0x1bcf58[_0x4ecf24(0xde0)]==='red_packet'){const _0x57f21c=_0x1bcf58[_0x4ecf24(0x770)]===_0x1c04b6?_0x4ecf24(0x1141)+_0x1c04b6+')':_0x1bcf58[_0x4ecf24(0x770)];let _0xa2737f;_0x1bcf58[_0x4ecf24(0x46b)]==='direct'?_0xa2737f=_0x4ecf24(0x87a)+_0x57f21c+_0x4ecf24(0x1b4)+_0x1bcf58[_0x4ecf24(0x351)]+_0x4ecf24(0x1112)+_0x1bcf58[_0x4ecf24(0xcf7)]+_0x4ecf24(0xb4d)+_0x1bcf58[_0x4ecf24(0xcf7)]+'”才能使用\x20\x27open_red_packet\x27\x20指令领取。]':_0xa2737f=_0x4ecf24(0x87a)+_0x57f21c+'\x20发送了一个【拼手气红包】(时间戳:\x20'+_0x1bcf58['timestamp']+_0x4ecf24(0x1070)+_0x1bcf58[_0x4ecf24(0x26c)]+_0x4ecf24(0xeb7),_0x510402=_0xa2737f;}else{if(_0x1bcf58['type']===_0x4ecf24(0x2ad)){const _0x39f901=_0x1bcf58[_0x4ecf24(0x14a)]===_0x4ecf24(0x74b)?_0x1c04b6:_0x1ba34a(_0x46f493,_0x1bcf58[_0x4ecf24(0x770)]),_0x3f4585=_0x1bcf58[_0x4ecf24(0x5de)][_0x4ecf24(0x6b9)](_0x51d359=>_0x51d359[_0x4ecf24(0x596)]+'\x20x'+_0x51d359[_0x4ecf24(0xe57)])[_0x4ecf24(0xb2c)]('、\x20');let _0x162ab1='';if(_0x1bcf58[_0x4ecf24(0x667)]&&_0x1bcf58[_0x4ecf24(0x667)][_0x4ecf24(0x105a)]>0x0){const _0x462c99=_0x1bcf58[_0x4ecf24(0x667)]['map'](_0x5090bb=>_0x1ba34a(_0x46f493,_0x5090bb))[_0x4ecf24(0xb2c)]('、\x20');_0x162ab1=_0x4ecf24(0x1131)+_0x462c99;}else _0x162ab1=_0x4ecf24(0xd95);return _0x510402=_0x4ecf24(0x87a)+_0x39f901+'\x20'+_0x162ab1+_0x4ecf24(0xda8)+_0x3f4585+']',{'role':_0x4ecf24(0x74b),'content':_0x510402};}else{if(_0x1bcf58[_0x4ecf24(0xde0)]===_0x4ecf24(0x123d)){const _0x436e0f=Object[_0x4ecf24(0x22f)](_0x1bcf58[_0x4ecf24(0x2ab)]||{})['flat']()[_0x4ecf24(0xb2c)](',\x20')||_0x4ecf24(0x7f8);_0x510402=_0x4ecf24(0x87a)+_0x1bcf58[_0x4ecf24(0x770)]+_0x4ecf24(0x4db)+_0x1bcf58[_0x4ecf24(0x351)]+_0x4ecf24(0xb7f)+_0x1bcf58[_0x4ecf24(0x8c4)]+_0x4ecf24(0xe13)+_0x1bcf58[_0x4ecf24(0x320)][_0x4ecf24(0xb2c)](',\x20')+']。目前投票的人有：'+_0x436e0f+_0x4ecf24(0x125b);}else{if(_0x1bcf58[_0x4ecf24(0x2b7)])_0x510402=_0x246d7c+_0x4ecf24(0xfc8)+_0x1bcf58['meaning']+'\x27]';else{if(Array[_0x4ecf24(0xb85)](_0x1bcf58[_0x4ecf24(0x168)]))return{'role':_0x4ecf24(0x74b),'content':[..._0x1bcf58[_0x4ecf24(0x168)],{'type':'text','text':_0x318483}]};else _0x510402=''+_0x318483+_0x1bcf58['content'];}}}}}}}}}}}return{'role':_0x4ecf24(0x74b),'content':_0x510402};})['filter'](Boolean);}else{const _0x5a2220=_0x46f493['settings'][_0x583c65(0x10bf)];let _0x2e58de='';_0x46f493[_0x583c65(0x33a)][_0x583c65(0x3a9)]&&_0x46f493[_0x583c65(0x211)]&&!_0x5a2220&&(_0x2e58de=_0x583c65(0xcab)+_0x46f493[_0x583c65(0x211)]+_0x583c65(0xd5d)+_0x46f493['randomJottings']+'\x0a');let _0xfb93a6='';const _0x41a941=_0x46f493[_0x583c65(0x33a)][_0x583c65(0x57d)]||0xa;if(_0x46f493[_0x583c65(0x33a)][_0x583c65(0xb6e)]&&_0x46f493['settings'][_0x583c65(0xb6e)][_0x583c65(0x105a)]>0x0){const _0x5c86bb=_0x46f493[_0x583c65(0x33a)][_0x583c65(0xb6e)]['filter'](_0xf4737e=>_0xf4737e!==_0x284636);if(_0x5c86bb[_0x583c65(0x105a)]>0x0){const _0xa14e0=_0x5c86bb['map'](_0x449b4b=>{const _0x1fa1fb=_0x583c65,_0x285904=_0x405767[_0x1fa1fb(0x799)][_0x449b4b];if(!_0x285904)return null;const _0x3e1de8=_0x285904[_0x1fa1fb(0xd39)][_0x1fa1fb(0x961)](-0x1)[0x0];return{'chat':_0x285904,'latestTimestamp':_0x3e1de8?_0x3e1de8[_0x1fa1fb(0x351)]:0x0};})[_0x583c65(0x1d8)](Boolean);_0xa14e0[_0x583c65(0xa19)]((_0xf1bf36,_0x142b2e)=>_0x142b2e['latestTimestamp']-_0xf1bf36[_0x583c65(0x11aa)]),_0xfb93a6+=_0x583c65(0xa50);for(const _0x4c86c9 of _0xa14e0){const _0x1f33a8=_0x4c86c9[_0x583c65(0x6d4)],_0x1d7ba7=_0x1f33a8['isGroup']?_0x583c65(0xe4f):_0x583c65(0x717),_0x1a0553=_0x4c86c9[_0x583c65(0x11aa)]>0x0?_0x583c65(0xd7c)+_0x4f34be(_0x4c86c9[_0x583c65(0x11aa)])+')':'';_0xfb93a6+=_0x583c65(0x1bf)+_0x1d7ba7+'“'+_0x1f33a8['name']+_0x583c65(0x4eb)+_0x1a0553+_0x583c65(0x100a);const _0x5cc66e=_0x1f33a8[_0x583c65(0xd39)]['slice'](-_0x41a941),_0x4de3c8=_0x5cc66e['filter'](_0x3b2822=>!String(_0x3b2822[_0x583c65(0x168)])[_0x583c65(0x773)](_0x583c65(0x257)));_0x4de3c8['length']>0x0?_0x4de3c8[_0x583c65(0x7c0)](_0x372278=>{const _0x3736fa=_0x583c65,_0x56cbd6=_0x372278[_0x3736fa(0x14a)]===_0x3736fa(0x74b)?_0x1f33a8[_0x3736fa(0x33a)][_0x3736fa(0xe16)]||'我':_0x372278[_0x3736fa(0x770)]||_0x1f33a8[_0x3736fa(0x596)];let _0x33077b=String(_0x372278[_0x3736fa(0x168)]);if(_0x372278[_0x3736fa(0xde0)]===_0x3736fa(0x7c8)||_0x372278[_0x3736fa(0xde0)]===_0x3736fa(0x223))_0x33077b='[发送了一张图片，描述为：'+_0x372278['content']+']';else _0x372278[_0x3736fa(0xde0)]===_0x3736fa(0xf64)&&(_0x33077b=_0x3736fa(0xc6e)+_0x372278[_0x3736fa(0x168)]+']');const _0x243479=_0x4f34be(_0x372278[_0x3736fa(0x351)]);_0xfb93a6+='('+_0x243479+')\x20'+_0x56cbd6+':\x20'+_0x33077b+'\x0a';}):_0xfb93a6+=_0x583c65(0x3dc);}}}const _0x95d389=await _0x15043e[_0x583c65(0x221)][_0x583c65(0x6be)]();let _0x1fce6f='';_0x95d389[_0x583c65(0x105a)]>0x0&&(_0x1fce6f=_0x583c65(0x5d0),_0x95d389['forEach'](_0x4756b3=>{const _0x54cdad=_0x583c65;_0x1fce6f+='-\x20(ID:\x20'+_0x4756b3['id']+_0x54cdad(0xa53)+_0x4756b3['name']+_0x54cdad(0x7cd)+_0x4756b3[_0x54cdad(0x2ea)][_0x54cdad(0x3c1)](0x2)+'\x0a';}));if(_0x5a2220){const _0xf7bd02=_0x46f493[_0x583c65(0x33a)][_0x583c65(0x1203)]||0x64,_0x4c1500=_0x46f493[_0x583c65(0x33a)][_0x583c65(0x13c)]||0x12c,_0x478bed=_0x46f493[_0x583c65(0x33a)][_0x583c65(0xe16)]||'我';let _0xd5a02='';if(_0x46f493['settings'][_0x583c65(0x2f7)]){const _0x1ba30a=_0x405767['presets'][_0x583c65(0x2ef)](_0x1189aa=>_0x1189aa['id']===_0x46f493[_0x583c65(0x33a)]['offlinePresetId']);if(_0x1ba30a&&Array['isArray'](_0x1ba30a['content'])){const _0xd5610d=_0x1ba30a[_0x583c65(0x168)]['filter'](_0x320b2a=>_0x320b2a['enabled']!==![])[_0x583c65(0x6b9)](_0x3900b8=>'-\x20'+_0x3900b8['content'])[_0x583c65(0xb2c)]('\x0a');_0xd5610d&&(_0xd5a02='\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a'+_0xd5610d+'\x0a---\x0a');}}_0x14b32c=_0x583c65(0x1114)+_0x46f493[_0x583c65(0x4e7)]+_0x583c65(0x285)+_0xd5a02+'\x0a#\x20你的角色设定：\x0a你必须严格遵守'+_0x46f493[_0x583c65(0x33a)]['aiPersona']+_0x583c65(0x43c)+_0x46f493[_0x583c65(0x33a)][_0x583c65(0xbe8)]+'\x0a\x0a#\x20供你参考的信息\x0a'+(_0x46f493[_0x583c65(0x33a)][_0x583c65(0xe87)]?'-\x20**当前时间**:\x20'+_0x3079c4+'\x20('+_0x5c5e82+')':'')+_0x583c65(0x27b)+_0x9a380a+_0x583c65(0xe65)+(_0x46f493[_0x583c65(0xbca)]&&_0x46f493[_0x583c65(0xbca)]['length']>0x0?_0x46f493['longTermMemory'][_0x583c65(0x6b9)](_0x41bb20=>'-\x20'+_0x41bb20[_0x583c65(0x168)])[_0x583c65(0xb2c)]('\x0a'):_0x583c65(0xbee))+'\x0a\x0a'+_0xfb93a6+_0x583c65(0xfca)+_0x1b9265[_0x583c65(0x6b9)](_0x3a7002=>{const _0x452000=_0x583c65;let _0xc2018f=(_0x3a7002[_0x452000(0x14a)]===_0x452000(0x74b)?_0x478bed:_0x46f493[_0x452000(0x596)])+':\x20';return _0x3a7002[_0x452000(0xde0)]===_0x452000(0xaac)?_0xc2018f+='「'+(_0x3a7002[_0x452000(0x1028)]||'')+'」\x20'+(_0x3a7002[_0x452000(0x3ca)]||''):_0xc2018f+=String(_0x3a7002[_0x452000(0x168)]),_0xc2018f;})[_0x583c65(0xb2c)]('\x0a')+'\x0a\x0a\x0a\x20#\x20【格式铁律\x20(最高优先级)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，格式如下:\x0a\x20\x20\x20\x20`[{\x22type\x22:\x20\x22offline_text\x22,\x20\x22content\x22:\x20\x22在这里写入你创作的、混合了对话和描写的完整段落。\x22}]`\x0a2.\x20\x20**【内容风格】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由地将对话穿插在描写的任何位置，实现自然分段。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a3.\x20\x20**【禁止】**:\x20绝对禁止在\x20`content`\x20字段中出现\x20\x22dialogue\x22\x20或\x20\x22description\x22\x20这两个词。\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**'+_0xf7bd02+'到'+_0x4c1500+_0x583c65(0x261),_0x2d5d1d=_0x1b9265['map'](_0x282f05=>{const _0x1c57bc=_0x583c65;if(_0x282f05['isHidden'])return null;if(_0x282f05[_0x1c57bc(0xde0)]===_0x1c57bc(0xaac)){const _0x4a2a2d=_0x282f05[_0x1c57bc(0x14a)]===_0x1c57bc(0x74b)?_0x46f493[_0x1c57bc(0x33a)]['myNickname']||'我':_0x46f493[_0x1c57bc(0x596)];let _0x43ac6d='';if(_0x282f05[_0x1c57bc(0x168)])_0x43ac6d=_0x282f05['content'];else{const _0x22fa51=_0x282f05[_0x1c57bc(0x1028)]?'「'+_0x282f05[_0x1c57bc(0x1028)]+'」':'',_0x3a7ad4=_0x282f05[_0x1c57bc(0x3ca)]?'('+_0x282f05['description']+')':'';_0x43ac6d=(_0x22fa51+'\x20'+_0x3a7ad4)[_0x1c57bc(0x8c6)]();}return{'role':_0x282f05[_0x1c57bc(0x14a)],'content':_0x4a2a2d+':\x20'+_0x43ac6d};}if(_0x282f05[_0x1c57bc(0x14a)]===_0x1c57bc(0x74b)){const _0x231558=_0x478bed+':\x20';let _0x309e65='';if(Array['isArray'](_0x282f05[_0x1c57bc(0x168)])&&_0x282f05[_0x1c57bc(0x168)][0x0]?.[_0x1c57bc(0xde0)]===_0x1c57bc(0x7a9))return{'role':_0x1c57bc(0x74b),'content':[{'type':_0x1c57bc(0xbc6),'text':_0x231558},..._0x282f05['content']]};if(_0x282f05[_0x1c57bc(0x9d2)]){const _0x5644d3=String(_0x282f05[_0x1c57bc(0x9d2)]['content']||'')['substring'](0x0,0x32);_0x309e65+=_0x1c57bc(0x3eb)+_0x282f05['quote'][_0x1c57bc(0x770)]+_0x1c57bc(0x547)+_0x5644d3+'...\x22):\x20'+_0x282f05['content'];}else _0x309e65+=_0x282f05[_0x1c57bc(0x168)];if(_0x282f05['type']===_0x1c57bc(0x223))return{'role':_0x1c57bc(0x74b),'content':_0x231558+'[你发送了一张需要AI识别的图片，图片内容是：\x27'+_0x282f05[_0x1c57bc(0x168)]+'\x27]'};if(_0x282f05['type']===_0x1c57bc(0xf64))return{'role':_0x1c57bc(0x74b),'content':_0x231558+_0x1c57bc(0x9fb)+_0x282f05[_0x1c57bc(0x168)]+'\x27]'};if(_0x282f05[_0x1c57bc(0xde0)]==='transfer')return{'role':_0x1c57bc(0x74b),'content':_0x231558+_0x1c57bc(0x1ec)+_0x282f05[_0x1c57bc(0x351)]+_0x1c57bc(0x968)+_0x282f05[_0x1c57bc(0x4c5)]+_0x1c57bc(0xc47)+_0x282f05[_0x1c57bc(0x113f)]+_0x1c57bc(0xfb2)};if(_0x282f05[_0x1c57bc(0xde0)]===_0x1c57bc(0x11b2))return{'role':_0x1c57bc(0x74b),'content':_0x231558+_0x1c57bc(0x1ec)+_0x282f05[_0x1c57bc(0x351)]+_0x1c57bc(0xada)+_0x282f05['productInfo']+_0x1c57bc(0xc94)+_0x282f05[_0x1c57bc(0x4c5)]+_0x1c57bc(0x755)};else{if(_0x282f05[_0x1c57bc(0xde0)]===_0x1c57bc(0x2ad)){const _0x320369=_0x282f05[_0x1c57bc(0x5de)][_0x1c57bc(0x6b9)](_0x40501a=>_0x40501a[_0x1c57bc(0x596)]+'\x20x'+_0x40501a['quantity'])[_0x1c57bc(0xb2c)]('、\x20');let _0x3dcc7f=_0x46f493[_0x1c57bc(0x1000)]?'送给了\x20'+_0x282f05[_0x1c57bc(0x667)][_0x1c57bc(0x6b9)](_0x37383a=>_0x1ba34a(_0x46f493,_0x37383a))[_0x1c57bc(0xb2c)]('、\x20'):_0x1c57bc(0x1131)+_0x46f493['name'];return{'role':_0x1c57bc(0x74b),'content':_0x231558+_0x1c57bc(0x1233)+_0x3dcc7f+'，礼物是：'+_0x320369+']'};}}if(_0x282f05[_0x1c57bc(0x2b7)])return{'role':_0x1c57bc(0x74b),'content':_0x231558+_0x1c57bc(0xabc)+_0x282f05[_0x1c57bc(0x2b7)]+'\x27]'};return{'role':_0x282f05[_0x1c57bc(0x14a)],'content':_0x231558+_0x309e65};}else{if(_0x282f05[_0x1c57bc(0x14a)]===_0x1c57bc(0x458)){let _0x4f3c7d={'type':_0x282f05[_0x1c57bc(0xde0)]||_0x1c57bc(0xbc6)};if(_0x282f05[_0x1c57bc(0xde0)]===_0x1c57bc(0x1ac))_0x4f3c7d[_0x1c57bc(0x9d6)]=_0x282f05['content'],_0x4f3c7d['meaning']=_0x282f05[_0x1c57bc(0x2b7)];else{if(_0x282f05['type']===_0x1c57bc(0x11b9))_0x4f3c7d[_0x1c57bc(0x4c5)]=_0x282f05['amount'],_0x4f3c7d[_0x1c57bc(0x113f)]=_0x282f05[_0x1c57bc(0x113f)];else _0x282f05[_0x1c57bc(0xde0)]===_0x1c57bc(0x11b2)?(_0x4f3c7d[_0x1c57bc(0xc7a)]=_0x282f05[_0x1c57bc(0xc7a)],_0x4f3c7d[_0x1c57bc(0x4c5)]=_0x282f05[_0x1c57bc(0x4c5)]):_0x282f05[_0x1c57bc(0x9d2)]?_0x4f3c7d['quote_reply']={'target_sender':_0x282f05[_0x1c57bc(0x9d2)][_0x1c57bc(0x770)],'target_content':_0x282f05[_0x1c57bc(0x9d2)]['content'],'reply_content':_0x282f05[_0x1c57bc(0x168)]}:_0x4f3c7d[_0x1c57bc(0x168)]=_0x282f05['content'];}const _0x1018e4=JSON['stringify']([_0x4f3c7d]);return{'role':_0x1c57bc(0x458),'content':_0x1c57bc(0x5ca)+_0x282f05[_0x1c57bc(0x351)]+')\x20'+_0x1018e4};}}return null;})[_0x583c65(0x1d8)](Boolean);}else{let _0x2d6536='';_0x46f493[_0x583c65(0x1116)]&&_0x46f493['nameHistory'][_0x583c65(0x105a)]>0x0&&(_0x2d6536=_0x583c65(0x60d)+_0x46f493[_0x583c65(0x1116)][_0x583c65(0xb2c)](',\x20')+_0x583c65(0x6a1));let _0x4d4207='';const _0x27d3fe=_0x405767[_0x583c65(0x20a)][_0x583c65(0xab3)]||'用户';_0x4d4207+=_0x583c65(0x942)+_0x27d3fe+'\x22。\x0a';const _0x9f52b=Object[_0x583c65(0x22f)](_0x405767['chats']),_0x451478=_0x9f52b[_0x583c65(0x1d8)](_0x4b0df2=>_0x4b0df2[_0x583c65(0x1000)]&&_0x4b0df2[_0x583c65(0x635)][_0x583c65(0xdc3)](_0x290c69=>_0x290c69['id']===_0x46f493['id']));_0x451478[_0x583c65(0x105a)]>0x0&&(_0x4d4207+=_0x583c65(0xf0d),_0x451478['forEach'](_0xcd938b=>{const _0x48c266=_0x583c65,_0x171a8e=_0xcd938b['settings'][_0x48c266(0xe16)]||_0x27d3fe;_0x4d4207+=_0x48c266(0x6e9)+_0xcd938b['name']+'”中，用户的昵称是“'+_0x171a8e+_0x48c266(0x192);}));_0x4d4207+=_0x583c65(0x4b3);let _0x176707='';const _0x54eace=_0x9f52b[_0x583c65(0x1d8)](_0x568f8d=>!_0x568f8d['isGroup']&&_0x568f8d['id']!==_0x46f493['id']&&_0x568f8d[_0x583c65(0x40f)]===_0x46f493[_0x583c65(0x40f)]&&_0x46f493['groupId']!==null);_0x54eace[_0x583c65(0x105a)]>0x0&&(_0x176707+='\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a',_0x54eace[_0x583c65(0x7c0)](_0x25ffc8=>{const _0x1bb180=_0x583c65;_0x176707+='-\x20**昵称:\x20'+_0x25ffc8[_0x1bb180(0x596)]+_0x1bb180(0x439)+_0x25ffc8['originalName']+')\x0a';}));const _0x46cdaf=await _0x15043e['qzonePosts']['orderBy'](_0x583c65(0x351))[_0x583c65(0x1c0)]()[_0x583c65(0x8e0)](0xa)[_0x583c65(0x6be)](),_0x2bf78a=_0x12538d(_0x46cdaf,_0x46f493);let _0x5f5168='';if(_0x2bf78a['length']>0x0){_0x5f5168=_0x583c65(0x2aa);const _0x1f4c60=_0x46f493[_0x583c65(0x4e7)];for(const _0xd55e49 of _0x2bf78a){let _0x4b12b1;if(_0xd55e49[_0x583c65(0x802)]===_0x583c65(0x74b))_0x4b12b1=_0x405767[_0x583c65(0x20a)]['nickname'];else{if(String(_0xd55e49['authorId'])[_0x583c65(0xc7c)](_0x583c65(0x5ea)))_0x4b12b1=_0xd55e49['authorOriginalName']||'一位神秘的NPC';else{const _0x4fe58b=_0x405767[_0x583c65(0x799)][_0xd55e49[_0x583c65(0x802)]];_0x4b12b1=_0x4fe58b?_0x4fe58b[_0x583c65(0x596)]:_0x583c65(0xa23);}}if(_0xd55e49[_0x583c65(0x802)]===_0x284636)_0x4b12b1+='\x20(这是你的帖子)';let _0x1fd08c;if(_0xd55e49[_0x583c65(0xde0)]==='repost'){const _0x54a6a2=_0xd55e49[_0x583c65(0xb64)]?_0x583c65(0xcc3)+_0xd55e49[_0x583c65(0xb64)]+'”':'';let _0x3178f8='原作者';const _0x26f9ab=_0xd55e49['originalPost'][_0x583c65(0x802)];if(_0x26f9ab===_0x583c65(0x74b))_0x3178f8=_0x405767[_0x583c65(0x20a)][_0x583c65(0xab3)];else _0x405767[_0x583c65(0x799)][_0x26f9ab]&&(_0x3178f8=_0x405767['chats'][_0x26f9ab][_0x583c65(0x596)]);let _0x7aea6e;const _0x5ac57f=_0xd55e49[_0x583c65(0x693)];if(_0x5ac57f[_0x583c65(0xde0)]==='text_image')_0x7aea6e=_0x583c65(0x102c)+(_0x5ac57f[_0x583c65(0x55d)]||'')+_0x583c65(0x106e)+(_0x5ac57f[_0x583c65(0x9eb)]||'')[_0x583c65(0x599)](0x0,0x28)+_0x583c65(0x2e4);else _0x5ac57f['type']==='image_post'?_0x7aea6e=_0x583c65(0x7e7)+(_0x5ac57f[_0x583c65(0x55d)]||'')+'\x20(图片描述:\x20“'+(_0x5ac57f[_0x583c65(0x845)]||'')[_0x583c65(0x599)](0x0,0x28)+_0x583c65(0x2e4):_0x7aea6e='“'+(_0x5ac57f['content']||'')[_0x583c65(0x599)](0x0,0x28)+_0x583c65(0xa16);_0x1fd08c='转发了\x20@'+_0x3178f8+_0x583c65(0xb0e)+_0x54a6a2+'【原动态内容:\x20'+_0x7aea6e+'】';}else{if(_0xd55e49[_0x583c65(0xde0)]===_0x583c65(0xe36))_0x1fd08c=(_0x583c65(0xa69)+_0xd55e49[_0x583c65(0x9eb)]+_0x583c65(0x1202)+(_0xd55e49[_0x583c65(0x55d)]||''))[_0x583c65(0x599)](0x0,0x32)+_0x583c65(0x388);else _0xd55e49[_0x583c65(0xde0)]==='image_post'?_0x1fd08c=(_0x583c65(0x304)+_0xd55e49[_0x583c65(0x845)]+_0x583c65(0x1202)+(_0xd55e49[_0x583c65(0x55d)]||''))[_0x583c65(0x599)](0x0,0x32)+'...':_0x1fd08c=String(_0xd55e49[_0x583c65(0x55d)]||_0xd55e49['content']||_0x583c65(0xcd2))['substring'](0x0,0x32)+'...';}_0x5f5168+=_0x583c65(0x1243)+_0xd55e49['id']+_0x583c65(0xc4a)+_0x4b12b1+',\x20内容:\x20\x22'+_0x1fd08c+'\x22\x0a';if(_0xd55e49['comments']&&_0xd55e49[_0x583c65(0x93c)][_0x583c65(0x105a)]>0x0)for(const _0x44650e of _0xd55e49['comments']){if(typeof _0x44650e===_0x583c65(0x7a5)&&_0x44650e[_0x583c65(0x110f)]){const _0x36c0cd=_0x4846a6(_0x44650e[_0x583c65(0x110f)]);let _0x34d14e=_0x44650e['meaning']?_0x583c65(0x745)+_0x44650e[_0x583c65(0x2b7)]+'\x27]':_0x44650e[_0x583c65(0xbc6)];_0x44650e[_0x583c65(0x110f)]===_0x1f4c60?_0x5f5168+=_0x583c65(0x2fe)+_0x34d14e+'\x0a':_0x5f5168+=_0x583c65(0x63d)+_0x36c0cd+_0x583c65(0x5e8)+_0x44650e[_0x583c65(0x110f)]+'):\x20'+_0x34d14e+'\x0a';}}}}const _0x77b936=_0x46f493[_0x583c65(0x33a)][_0x583c65(0xe16)]||'我';let _0xa5ed1c='',_0x36e345=![];if(_0x46f493[_0x583c65(0x33a)][_0x583c65(0xe87)]){const _0x3f8185=_0x1b9265['findLast'](_0x2c8b88=>_0x2c8b88[_0x583c65(0x14a)]==='user'&&!_0x2c8b88['isHidden']),_0x4b7374=_0x1b9265[_0x583c65(0x112e)](_0x2ecf1c=>_0x2ecf1c['role']===_0x583c65(0x458)&&!_0x2ecf1c[_0x583c65(0x3f1)]);if(_0x3f8185){const _0x55611f=_0x3dbc6f(_0x3f8185['timestamp']);if(_0x4b7374){const _0x58be57=_0x3dbc6f(_0x4b7374['timestamp']);_0xa5ed1c='-\x20**对话状态**:\x20你的上一条消息发送于\x20'+_0x58be57+'，用户刚刚在\x20'+_0x55611f+_0x583c65(0x355);const _0x210bf2=(_0x3f8185[_0x583c65(0x351)]-_0x4b7374['timestamp'])/(0x3e8*0x3c*0x3c);if(_0x210bf2>0x3){_0x36e345=!![];const _0x4a182f=Math[_0x583c65(0x10b2)](_0x210bf2/0x18);_0xa5ed1c+=_0x583c65(0x9de)+(_0x4a182f>0x0?_0x4a182f+'天':Math[_0x583c65(0x10b2)](_0x210bf2)+'小时')+_0x583c65(0x1284)+_0x5c5e82+_0x583c65(0xdf1);}}else _0xa5ed1c=_0x583c65(0x302)+_0x55611f+'。';}else _0xa5ed1c=_0x583c65(0xb3c);}const _0x5e01df=_0x4e8d2c(_0x284636),_0x5f5bb0=_0x5e1bc2(_0x46f493,0x3,_0x583c65(0x834)),_0x1f4336=_0x5e1bc2(_0x46f493,0x6,'hours'),_0x1794d8=_0x5e1bc2(_0x46f493,0x9,'hours'),_0x2af4c7=_0x5e1bc2(_0x46f493,0x1,'days'),_0x57d38c=_0x5e1bc2(_0x46f493,0x3,_0x583c65(0x1a0)),_0x37fa73=_0x5e1bc2(_0x46f493,0x7,_0x583c65(0x1a0));let _0xe420d5='';if(_0x5f5bb0||_0x1f4336||_0x1794d8||_0x2af4c7||_0x57d38c||_0x37fa73){_0xe420d5+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x5f5bb0)_0xe420d5+=_0x5f5bb0;if(_0x1f4336)_0xe420d5+=_0x1f4336;if(_0x1794d8)_0xe420d5+=_0x1794d8;if(_0x5f5bb0||_0x1f4336||_0x1794d8)_0xe420d5+='\x0a';if(_0x2af4c7)_0xe420d5+=_0x2af4c7;if(_0x57d38c)_0xe420d5+=_0x57d38c;if(_0x37fa73)_0xe420d5+=_0x37fa73;}_0x14b32c='\x0a#\x20身份与核心任务\x0a你正在扮演角色“'+_0x46f493['originalName']+'”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-10条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a2.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a3.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20你的角色设定\x0a你必须严格遵守'+_0x46f493['settings'][_0x583c65(0x1060)]+'\x0a'+_0x2e58de+'\x0a#\x20对话者的角色设定\x0a'+_0x46f493[_0x583c65(0x33a)][_0x583c65(0xbe8)]+'\x0a\x0a#\x20当前情景\x0a'+(_0x46f493[_0x583c65(0x33a)][_0x583c65(0xe87)]?_0x583c65(0x491)+_0x3079c4+'\x20('+_0x5c5e82+')':'')+'\x0a'+_0xa5ed1c+'\x0a#\x20世界观\x20(必须严格遵守)\x0a'+_0x9a380a+'\x0a'+_0xfb93a6+_0x583c65(0x756)+(_0x46f493[_0x583c65(0xbca)]&&_0x46f493[_0x583c65(0xbca)][_0x583c65(0x105a)]>0x0?_0x46f493[_0x583c65(0xbca)][_0x583c65(0x6b9)](_0x2cb7ab=>'-\x20'+_0x2cb7ab['content'])[_0x583c65(0xb2c)]('\x0a'):_0x583c65(0xbee))+'\x0a'+_0xe420d5+_0x583c65(0x82f)+_0x46f493[_0x583c65(0x4e7)]+'\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22'+_0x46f493[_0x583c65(0x596)]+_0x583c65(0x1266)+_0x77b936+_0x583c65(0xe86)+_0x4d4207+_0x583c65(0xd48)+_0x2d6536+'\x0a\x0a'+_0x413061+'\x0a'+_0x3021d0+_0x583c65(0xbba)+_0x176707+'\x0a'+_0x5f5168+_0x583c65(0x35b)+(_0x46f493[_0x583c65(0x33a)][_0x583c65(0xe87)]?'-\x20**时间**:\x20你必须感知到当前是\x20'+_0x3079c4+'\x20('+_0x5c5e82+_0x583c65(0xbdf):'')+'\x0a\x20\x20\x20\x20-\x20**音乐**:\x20'+(_0x202bcf?_0x583c65(0x778)+_0x202bcf:_0x583c65(0xcdf))+'\x0a\x20\x20\x20\x20-\x20**读书**:\x20'+(_0x5e01df?'你们正在一起读书。'+_0x5e01df:_0x583c65(0x2a4))+_0x583c65(0xed0)+(_0x46f493[_0x583c65(0x33a)][_0x583c65(0xca4)]&&_0x46f493['settings'][_0x583c65(0xca4)][_0x583c65(0x105a)]>0x0?_0x46f493[_0x583c65(0x33a)][_0x583c65(0xca4)][_0x583c65(0x6b9)](_0x44959b=>'-\x20'+_0x44959b[_0x583c65(0x596)])[_0x583c65(0xb2c)]('\x0a'):_0x583c65(0x572))+_0x583c65(0x294)+(_0x46f493[_0x583c65(0x33a)]['myAvatarLibrary']&&_0x46f493[_0x583c65(0x33a)][_0x583c65(0x567)][_0x583c65(0x105a)]>0x0?_0x46f493[_0x583c65(0x33a)][_0x583c65(0x567)][_0x583c65(0x6b9)](_0x2ee433=>'-\x20'+_0x2ee433['name'])[_0x583c65(0xb2c)]('\x0a'):_0x583c65(0x572))+_0x583c65(0x125f)+_0x256970+'\x0a\x0a\x0a\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22url\x22:\x20\x22https://...表情URL...\x22,\x20\x22meaning\x22:\x20\x22(可选)表情含义\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22'+_0x46f493[_0x583c65(0x4e7)]+_0x583c65(0xaa6)+_0x46f493[_0x583c65(0x4e7)]+_0x583c65(0x6c5)+_0x46f493[_0x583c65(0x4e7)]+_0x583c65(0x1063)+_0x46f493[_0x583c65(0x4e7)]+_0x583c65(0x732),_0x2d5d1d=_0x1b9265[_0x583c65(0x6b9)](_0x343b01=>{const _0x2b2959=_0x583c65;if(_0x343b01[_0x2b2959(0x3f1)]&&_0x343b01[_0x2b2959(0x14a)]===_0x2b2959(0x46c))return{'role':_0x2b2959(0x74b),'content':_0x343b01[_0x2b2959(0x168)]};else{if(_0x343b01['isHidden'])return null;}if(_0x343b01[_0x2b2959(0xde0)]===_0x2b2959(0xaac)){const _0x37a2b5=_0x343b01[_0x2b2959(0x14a)]===_0x2b2959(0x74b)?_0x46f493[_0x2b2959(0x33a)][_0x2b2959(0xe16)]||'我':_0x46f493[_0x2b2959(0x596)];let _0x3b9ddf='';if(_0x343b01[_0x2b2959(0x168)])_0x3b9ddf=_0x343b01[_0x2b2959(0x168)];else{const _0x3cf583=_0x343b01[_0x2b2959(0x1028)]?'「'+_0x343b01['dialogue']+'」':'',_0x16ac24=_0x343b01[_0x2b2959(0x3ca)]?'('+_0x343b01['description']+')':'';_0x3b9ddf=(_0x3cf583+'\x20'+_0x16ac24)['trim']();}return{'role':_0x343b01[_0x2b2959(0x14a)],'content':_0x2b2959(0x5ca)+_0x343b01[_0x2b2959(0x351)]+')\x20'+_0x37a2b5+':\x20'+_0x3b9ddf};}if(_0x343b01[_0x2b2959(0x14a)]===_0x2b2959(0x74b)){const _0x12cfcb=_0x2b2959(0x5ca)+_0x343b01[_0x2b2959(0x351)]+')\x20';let _0x244e96='';if(Array['isArray'](_0x343b01[_0x2b2959(0x168)])&&_0x343b01[_0x2b2959(0x168)][0x0]?.['type']==='image_url')return{'role':'user','content':[{'type':_0x2b2959(0xbc6),'text':_0x12cfcb},..._0x343b01['content']]};if(_0x343b01['quote']){const _0x3e7ee0=String(_0x343b01['quote'][_0x2b2959(0x168)]||'')[_0x2b2959(0x599)](0x0,0x32);_0x244e96+=_0x2b2959(0x3eb)+_0x343b01[_0x2b2959(0x9d2)]['senderName']+_0x2b2959(0x547)+_0x3e7ee0+_0x2b2959(0x371)+_0x343b01['content'];}else _0x244e96+=_0x343b01[_0x2b2959(0x168)];if(_0x343b01[_0x2b2959(0xde0)]==='user_photo')return{'role':'user','content':_0x12cfcb+'[你发送了一张需要AI识别的图片，图片内容是：\x27'+_0x343b01[_0x2b2959(0x168)]+'\x27]'};if(_0x343b01[_0x2b2959(0xde0)]===_0x2b2959(0xf64))return{'role':_0x2b2959(0x74b),'content':_0x12cfcb+'[你发送了一条语音消息，内容是：\x27'+_0x343b01[_0x2b2959(0x168)]+'\x27]'};if(_0x343b01[_0x2b2959(0xde0)]===_0x2b2959(0x11b9))return{'role':_0x2b2959(0x74b),'content':_0x12cfcb+_0x2b2959(0x1ec)+_0x343b01[_0x2b2959(0x351)]+_0x2b2959(0x968)+_0x343b01[_0x2b2959(0x4c5)]+_0x2b2959(0xc47)+_0x343b01[_0x2b2959(0x113f)]+'。等待对方处理。]'};if(_0x343b01[_0x2b2959(0xde0)]==='waimai_request')return{'role':_0x2b2959(0x74b),'content':_0x12cfcb+'[系统提示：你于时间戳\x20'+_0x343b01['timestamp']+'\x20发起了外卖代付请求，商品是“'+_0x343b01['productInfo']+_0x2b2959(0xc94)+_0x343b01[_0x2b2959(0x4c5)]+_0x2b2959(0x755)};else{if(_0x343b01[_0x2b2959(0xde0)]===_0x2b2959(0x2ad)){const _0x11fb3d=_0x343b01[_0x2b2959(0x5de)]['map'](_0x195751=>_0x195751[_0x2b2959(0x596)]+'\x20x'+_0x195751['quantity'])[_0x2b2959(0xb2c)]('、\x20');let _0x5cac2b=_0x46f493['isGroup']?'送给了\x20'+_0x343b01[_0x2b2959(0x667)][_0x2b2959(0x6b9)](_0x2cd99c=>_0x1ba34a(_0x46f493,_0x2cd99c))[_0x2b2959(0xb2c)]('、\x20'):_0x2b2959(0x1131)+_0x46f493[_0x2b2959(0x596)];return{'role':_0x2b2959(0x74b),'content':_0x12cfcb+_0x2b2959(0x1233)+_0x5cac2b+_0x2b2959(0xda8)+_0x11fb3d+']'};}}if(_0x343b01['meaning'])return{'role':_0x2b2959(0x74b),'content':_0x12cfcb+_0x2b2959(0xabc)+_0x343b01[_0x2b2959(0x2b7)]+'\x27]'};return{'role':_0x343b01[_0x2b2959(0x14a)],'content':_0x12cfcb+_0x244e96};}else{if(_0x343b01[_0x2b2959(0x14a)]===_0x2b2959(0x458)){let _0x1dfaf8={'type':_0x343b01[_0x2b2959(0xde0)]||_0x2b2959(0xbc6)};if(_0x343b01['type']===_0x2b2959(0x1ac))_0x1dfaf8['url']=_0x343b01[_0x2b2959(0x168)],_0x1dfaf8['meaning']=_0x343b01[_0x2b2959(0x2b7)];else{if(_0x343b01['type']==='transfer')_0x1dfaf8[_0x2b2959(0x4c5)]=_0x343b01[_0x2b2959(0x4c5)],_0x1dfaf8[_0x2b2959(0x113f)]=_0x343b01[_0x2b2959(0x113f)];else _0x343b01['type']===_0x2b2959(0x11b2)?(_0x1dfaf8['productInfo']=_0x343b01[_0x2b2959(0xc7a)],_0x1dfaf8['amount']=_0x343b01['amount']):_0x343b01[_0x2b2959(0x9d2)]?_0x1dfaf8[_0x2b2959(0x58a)]={'target_sender':_0x343b01[_0x2b2959(0x9d2)][_0x2b2959(0x770)],'target_content':_0x343b01[_0x2b2959(0x9d2)]['content'],'reply_content':_0x343b01['content']}:_0x1dfaf8[_0x2b2959(0x168)]=_0x343b01['content'];}const _0x15c5c5=JSON['stringify']([_0x1dfaf8]);return{'role':_0x2b2959(0x458),'content':_0x2b2959(0x5ca)+_0x343b01[_0x2b2959(0x351)]+')\x20'+_0x15c5c5};}}return null;})[_0x583c65(0x1d8)](Boolean);if(!_0x46f493[_0x583c65(0x1000)]&&_0x46f493[_0x583c65(0x944)]?.[_0x583c65(0x8c8)]===_0x583c65(0x10b6)){const _0x569301=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x1d8)](_0x5ef632=>!_0x5ef632['isHidden'])[_0x583c65(0x961)](-0xa)[_0x583c65(0x6b9)](_0x5881b9=>{const _0x1801ee=_0x583c65,_0x17c57b=_0x5881b9[_0x1801ee(0x14a)]==='user'?'用户':_0x46f493[_0x1801ee(0x596)];return _0x17c57b+':\x20'+String(_0x5881b9['content'])[_0x1801ee(0x599)](0x0,0x32)+_0x1801ee(0x388);})[_0x583c65(0xb2c)]('\x0a'),_0x4cf062={'role':'user','content':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“'+_0x46f493[_0x583c65(0x944)][_0x583c65(0x727)]+_0x583c65(0x87e)+_0x569301+_0x583c65(0xf79)};_0x2d5d1d[_0x583c65(0xa49)](_0x4cf062);}}}let _0x4d400a=_0x5ecff7===GEMINI_API_URL,_0x3880b0=_0x282b7e(_0x297b37,_0x4aaab5,_0x14b32c,_0x2d5d1d),_0x52d55b;try{_0x52d55b=_0x4d400a?await fetch(_0x3880b0['url'],_0x3880b0['data']):await fetch(_0x5ecff7+_0x583c65(0x5c1),{'method':_0x583c65(0xcd0),'headers':{'Content-Type':_0x583c65(0xcb6),'Authorization':_0x583c65(0xf42)+_0x4aaab5},'body':JSON['stringify']({'model':_0x297b37,'messages':[{'role':_0x583c65(0x46c),'content':_0x14b32c},..._0x2d5d1d],'temperature':_0x405767[_0x583c65(0xb73)][_0x583c65(0x8c7)]||0.8,'stream':![]})});}catch(_0x4091b1){throw new Error('网络请求失败:\x20'+_0x4091b1[_0x583c65(0xc7d)]);}if(!_0x52d55b['ok']){let _0x1192d3='API\x20返回错误:\x20'+_0x52d55b[_0x583c65(0x8c8)]+'\x20'+_0x52d55b[_0x583c65(0xd05)];try{const _0x8d6d21=await _0x52d55b[_0x583c65(0x7e9)]();_0x8d6d21[_0x583c65(0x7a3)]&&_0x8d6d21[_0x583c65(0x7a3)][_0x583c65(0xc7d)]?_0x1192d3+=_0x583c65(0x2e9)+_0x8d6d21[_0x583c65(0x7a3)][_0x583c65(0xc7d)]:_0x1192d3+=_0x583c65(0x2e9)+JSON[_0x583c65(0x1175)](_0x8d6d21);}catch(_0x2775cb){_0x1192d3+='\x20-\x20响应内容:\x20'+await _0x52d55b[_0x583c65(0xbc6)]();}throw new Error(_0x1192d3);}const _0x5a0f6e=await _0x52d55b[_0x583c65(0x7e9)](),_0x51e771=getGeminiResponseText(_0x5a0f6e);lastRawAiResponse=_0x51e771,lastResponseTimestamps=[],_0x46f493[_0x583c65(0xd39)]=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x1d8)](_0x39d66d=>!_0x39d66d[_0x583c65(0x1230)]);const _0x1bb3fb=_0x5196dd(_0x51e771);let _0x58d4af=[];if(_0x46f493[_0x583c65(0x33a)]['isOfflineMode']){let _0x42a908={'content':[],'dialogue':[],'description':[]};for(const _0x120fe3 of _0x1bb3fb){if(_0x120fe3[_0x583c65(0xde0)]===_0x583c65(0xaac)){if(_0x120fe3[_0x583c65(0x168)])_0x42a908[_0x583c65(0x168)][_0x583c65(0xa49)](_0x120fe3['content']);else{if(_0x120fe3['dialogue'])_0x42a908[_0x583c65(0x1028)][_0x583c65(0xa49)](_0x120fe3[_0x583c65(0x1028)]);if(_0x120fe3['description'])_0x42a908['description'][_0x583c65(0xa49)](_0x120fe3['description']);}}else(_0x42a908[_0x583c65(0x168)]['length']>0x0||_0x42a908[_0x583c65(0x1028)][_0x583c65(0x105a)]>0x0||_0x42a908[_0x583c65(0x3ca)]['length']>0x0)&&(_0x42a908['content'][_0x583c65(0x105a)]>0x0&&_0x58d4af[_0x583c65(0xa49)]({'type':_0x583c65(0xaac),'content':_0x42a908[_0x583c65(0x168)][_0x583c65(0xb2c)]('\x0a')}),(_0x42a908[_0x583c65(0x1028)][_0x583c65(0x105a)]>0x0||_0x42a908[_0x583c65(0x3ca)][_0x583c65(0x105a)]>0x0)&&_0x58d4af[_0x583c65(0xa49)]({'type':_0x583c65(0xaac),'dialogue':_0x42a908[_0x583c65(0x1028)][_0x583c65(0xb2c)]('\x0a'),'description':_0x42a908[_0x583c65(0x3ca)][_0x583c65(0xb2c)]('\x0a')}),_0x42a908={'content':[],'dialogue':[],'description':[]}),_0x58d4af[_0x583c65(0xa49)](_0x120fe3);}_0x42a908[_0x583c65(0x168)][_0x583c65(0x105a)]>0x0&&_0x58d4af['push']({'type':'offline_text','content':_0x42a908['content'][_0x583c65(0xb2c)]('\x0a')}),(_0x42a908[_0x583c65(0x1028)][_0x583c65(0x105a)]>0x0||_0x42a908[_0x583c65(0x3ca)]['length']>0x0)&&_0x58d4af[_0x583c65(0xa49)]({'type':_0x583c65(0xaac),'dialogue':_0x42a908[_0x583c65(0x1028)][_0x583c65(0xb2c)]('\x0a'),'description':_0x42a908[_0x583c65(0x3ca)][_0x583c65(0xb2c)]('\x0a')});}else _0x58d4af=_0x1bb3fb;const _0x41f0f4=_0x46f493['history'][_0x583c65(0x1d8)](_0x49f173=>_0x49f173[_0x583c65(0x14a)]==='user'&&!_0x49f173[_0x583c65(0x3f1)])[_0x583c65(0xd64)]();if(_0x41f0f4&&Array['isArray'](_0x41f0f4[_0x583c65(0x168)])&&_0x41f0f4[_0x583c65(0x168)][0x0]?.['type']===_0x583c65(0x7a9)&&!_0x41f0f4[_0x583c65(0x5fb)]){const _0x196cbd=_0x1bb3fb['find'](_0x42c877=>_0x42c877[_0x583c65(0xde0)]==='text');let _0x15c724;_0x196cbd&&(_0x196cbd['content']||_0x196cbd[_0x583c65(0xc7d)])?_0x15c724=String(_0x196cbd[_0x583c65(0x168)]||_0x196cbd[_0x583c65(0xc7d)])[_0x583c65(0x8c6)]():_0x15c724=_0x583c65(0xc3f);const _0x570140=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x1149)](_0x2ee9dd=>_0x2ee9dd[_0x583c65(0x351)]===_0x41f0f4[_0x583c65(0x351)]);if(_0x570140>-0x1){console[_0x583c65(0x32b)]('识图优化：正在将时间戳为\x20'+_0x41f0f4[_0x583c65(0x351)]+_0x583c65(0x56c));const _0x2270e9=_0x583c65(0x17e)+_0x15c724+'”]';_0x46f493[_0x583c65(0xd39)][_0x570140]['content']=_0x2270e9,_0x46f493[_0x583c65(0xd39)][_0x570140][_0x583c65(0x5fb)]=!![],_0x46f493[_0x583c65(0xd39)][_0x570140][_0x583c65(0xde0)]='text';}}const _0x3aa4d8=document[_0x583c65(0x8c2)](_0x583c65(0xd5c))['classList'][_0x583c65(0x795)]('active')&&_0x405767[_0x583c65(0x248)]===_0x284636;let _0x492a80=![],_0x243c85=Date[_0x583c65(0x1ed)](),_0x57075e=[],_0xead394=![];for(const _0x1ba053 of _0x58d4af){_0x46f493[_0x583c65(0x33a)][_0x583c65(0xa71)]!==![]&&_0x1ba053[_0x583c65(0xde0)]==='text'&&typeof _0x1ba053['content']==='string'&&_0x1ba053[_0x583c65(0x168)]['trim']()[_0x583c65(0xc7c)](_0x583c65(0x1065))&&(_0x1ba053[_0x583c65(0xde0)]=_0x583c65(0xf64),_0x1ba053[_0x583c65(0x168)]=_0x1ba053['content'][_0x583c65(0x1b7)](_0x583c65(0x1065),'')['trim']());if(_0x46f493[_0x583c65(0x1000)]&&_0x1ba053['name']&&_0x1ba053[_0x583c65(0x596)]===_0x46f493[_0x583c65(0x596)]){console['error'](_0x583c65(0x2d5)+_0x46f493[_0x583c65(0x596)]+_0x583c65(0x2f5),_0x1ba053);continue;}if(!_0x1ba053||typeof _0x1ba053!==_0x583c65(0x7a5)){console['warn'](_0x583c65(0xefc),_0x1ba053);continue;}if(!_0x1ba053[_0x583c65(0xde0)]){if(_0x46f493['isGroup']&&_0x1ba053[_0x583c65(0x596)]&&_0x1ba053[_0x583c65(0xc7d)])_0x1ba053[_0x583c65(0xde0)]=_0x583c65(0xbc6);else{if(_0x1ba053[_0x583c65(0x168)])_0x1ba053[_0x583c65(0xde0)]=_0x583c65(0xbc6);else{console['warn']('收到了格式不规范的AI指令（缺少type和content），已跳过:',_0x1ba053);continue;}}}if(_0x1ba053[_0x583c65(0xde0)]==='video_call_response'){_0x49beae[_0x583c65(0x324)]=![];if(_0x1ba053[_0x583c65(0x697)]===_0x583c65(0x104d))_0x543413();else{const _0x46b86b={'role':_0x583c65(0x458),'content':'对方拒绝了你的视频通话请求。','timestamp':Date[_0x583c65(0x1ed)]()};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0x46b86b),await _0x15043e[_0x583c65(0x799)][_0x583c65(0xfaa)](_0x46f493),_0x3d1990(_0x583c65(0xd5c)),_0x7dbe71(_0x284636);}_0x492a80=!![];break;}if(_0x1ba053[_0x583c65(0xde0)]===_0x583c65(0xe08)){if(_0x1ba053[_0x583c65(0x697)]==='join'){const _0x2ebd73=_0x46f493[_0x583c65(0x635)]['find'](_0x19f390=>_0x19f390[_0x583c65(0x4e7)]===_0x1ba053[_0x583c65(0x596)]);_0x2ebd73&&!_0x49beae[_0x583c65(0x190)][_0x583c65(0xdc3)](_0x227edd=>_0x227edd['id']===_0x2ebd73['id'])&&_0x49beae[_0x583c65(0x190)][_0x583c65(0xa49)](_0x2ebd73);}_0x492a80=!![];continue;}if(_0x46f493[_0x583c65(0x1000)]&&_0x1ba053[_0x583c65(0x596)]&&_0x1ba053[_0x583c65(0x596)]===_0x46f493['name']){console[_0x583c65(0x7a3)](_0x583c65(0x2d5)+_0x46f493[_0x583c65(0x596)]+_0x583c65(0x2f5),_0x1ba053);continue;}if(_0x46f493[_0x583c65(0x1000)]&&!_0x1ba053[_0x583c65(0x596)]){console[_0x583c65(0x7a3)](_0x583c65(0x41f),_0x1ba053);continue;}let _0x16cb3a=null;const _0x28e140=_0x243c85++,_0xa74f1b={'role':'assistant','senderName':_0x1ba053[_0x583c65(0x596)]||_0x46f493['name'],'timestamp':_0x28e140};lastResponseTimestamps['push'](_0x28e140);switch(_0x1ba053[_0x583c65(0xde0)]){case _0x583c65(0x894):if(!_0x46f493[_0x583c65(0x1000)]){_0x1ba053[_0x583c65(0x10e1)]&&(_0x46f493['heartfeltVoice']=String(_0x1ba053[_0x583c65(0x10e1)]));_0x1ba053[_0x583c65(0xe1f)]&&(_0x46f493[_0x583c65(0x103c)]=String(_0x1ba053[_0x583c65(0xe1f)]));!Array[_0x583c65(0xb85)](_0x46f493[_0x583c65(0x120b)])&&(_0x46f493[_0x583c65(0x120b)]=[]);_0x46f493[_0x583c65(0x120b)][_0x583c65(0xa49)]({'heartfeltVoice':_0x46f493[_0x583c65(0x211)],'randomJottings':_0x46f493[_0x583c65(0x103c)],'timestamp':Date['now']()});_0x46f493['thoughtsHistory'][_0x583c65(0x105a)]>0x32&&_0x46f493[_0x583c65(0x120b)][_0x583c65(0x101b)]();const _0x233dcb=_0x583c65(0x10ad)+_0x46f493[_0x583c65(0x211)]+_0x583c65(0xd5d)+_0x46f493[_0x583c65(0x103c)],_0x583d51={'role':_0x583c65(0x46c),'content':_0x233dcb,'timestamp':Date[_0x583c65(0x1ed)](),'isHidden':!![]};}continue;case _0x583c65(0x8d0):if(!_0x46f493['isGroup']&&_0x1ba053[_0x583c65(0x969)]){const _0x110d04=_0x1ba053[_0x583c65(0x969)][_0x583c65(0x8c6)]();if(_0x110d04){_0x46f493[_0x583c65(0x33a)][_0x583c65(0xe16)]=_0x110d04;const _0x226dfd={'role':_0x583c65(0x46c),'type':_0x583c65(0x6f1),'content':'“'+_0x46f493[_0x583c65(0x596)]+'”\x20将对你的称呼修改为\x20“'+_0x110d04+'”','timestamp':_0x243c85++};_0x46f493['history']['push'](_0x226dfd);const _0x39700b={'role':_0x583c65(0x46c),'content':_0x583c65(0x10a5)+_0x110d04+'”。]','timestamp':_0x243c85++,'isHidden':!![]};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0x39700b),_0x3aa4d8&&_0x5c5c92(_0x226dfd,_0x46f493);}}continue;case _0x583c65(0x1d1):if(!_0x46f493[_0x583c65(0x1000)]&&_0x1ba053[_0x583c65(0x969)]){const _0x28c7fe=_0x46f493[_0x583c65(0x596)],_0x25f3e5=_0x1ba053[_0x583c65(0x969)]['trim']();if(_0x25f3e5&&_0x25f3e5!==_0x28c7fe){!_0x46f493[_0x583c65(0x1116)]&&(_0x46f493[_0x583c65(0x1116)]=[]);!_0x46f493['nameHistory']['includes'](_0x28c7fe)&&_0x46f493['nameHistory']['push'](_0x28c7fe);_0x46f493[_0x583c65(0x596)]=_0x25f3e5;const _0x4a8299={'role':_0x583c65(0x46c),'type':'pat_message','content':'“'+_0x46f493['originalName']+_0x583c65(0x4da)+_0x25f3e5+'”','timestamp':_0x243c85++};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0x4a8299);const _0xef20b={'role':'system','content':_0x583c65(0xe8e)+_0x25f3e5+'”。请自然地接受这个新名字，不要对此感到惊讶。]','timestamp':_0x243c85++,'isHidden':!![]};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0xef20b),_0x3aa4d8&&(_0x5c5c92(_0x4a8299,_0x46f493),document[_0x583c65(0x8c2)](_0x583c65(0x334))['textContent']=_0x25f3e5),await _0x4b93d2(_0x46f493);}}continue;case _0x583c65(0xc76):{const _0x542b10=_0x1ba053[_0x583c65(0x596)],_0x2d238=_0x46f493['settings'][_0x583c65(0xca4)][_0x583c65(0x2ef)](_0x2be551=>_0x2be551[_0x583c65(0x596)]===_0x542b10);if(_0x2d238){_0x46f493[_0x583c65(0x33a)][_0x583c65(0x44e)]=_0x2d238[_0x583c65(0x9d6)];const _0x516bfd={'role':'system','type':_0x583c65(0x6f1),'content':'['+_0x46f493['name']+'\x20更换了头像]','timestamp':Date['now']()};_0x46f493['history'][_0x583c65(0xa49)](_0x516bfd),await _0x19507d(_0x46f493),_0x3aa4d8&&(_0x5c5c92(_0x516bfd,_0x46f493),_0x7dbe71(_0x284636));}continue;}case _0x583c65(0x228):{const _0xc0a694=_0x1ba053['name'],_0x186d2b=_0x46f493['settings'][_0x583c65(0x567)][_0x583c65(0x2ef)](_0x205f17=>_0x205f17[_0x583c65(0x596)]===_0xc0a694);if(_0x186d2b){_0x46f493['settings'][_0x583c65(0x11ed)]=_0x186d2b[_0x583c65(0x9d6)];const _0x262283={'role':'system','type':_0x583c65(0x6f1),'content':'['+_0x46f493[_0x583c65(0x596)]+_0x583c65(0xfda),'timestamp':Date[_0x583c65(0x1ed)]()};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0x262283),_0x3aa4d8&&(_0x5c5c92(_0x262283,_0x46f493),_0x7dbe71(_0x284636));}continue;}case _0x583c65(0x316):{const _0x5c7e30=parseInt(_0x1ba053['x']),_0x599bef=parseInt(_0x1ba053['y']);!isNaN(_0x5c7e30)&&!isNaN(_0x599bef)?_0x4a5d9b({'x':_0x5c7e30,'y':_0x599bef}):console[_0x583c65(0x112a)](_0x583c65(0x80f),_0x1ba053);continue;}case _0x583c65(0xd88):const _0x554e57=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x1149)](_0x2d1ea9=>_0x2d1ea9[_0x583c65(0x351)]===_0x1ba053[_0x583c65(0xe39)]);if(_0x554e57>-0x1){const _0x1c488d=_0x46f493[_0x583c65(0xd39)][_0x554e57];_0x1c488d['status']=_0x1ba053[_0x583c65(0x8c8)],_0x1c488d['paidBy']=_0x1ba053[_0x583c65(0x8c8)]===_0x583c65(0x1279)?_0x1ba053[_0x583c65(0x596)]:null;}continue;case _0x583c65(0x80e):const _0x430d92={'type':_0x1ba053['postType'],'content':_0x1ba053[_0x583c65(0x168)]||'','publicText':_0x1ba053[_0x583c65(0x55d)]||'','hiddenContent':_0x1ba053[_0x583c65(0x9eb)]||'','image_prompt':_0x1ba053[_0x583c65(0xdae)]||'','timestamp':Date['now'](),'authorId':_0x284636,'authorOriginalName':_0x46f493[_0x583c65(0x4e7)],'authorGroupId':_0x46f493[_0x583c65(0x40f)],'visibleGroupIds':null};await _0x15043e[_0x583c65(0xcc0)][_0x583c65(0x3f4)](_0x430d92),_0x156368(_0x38d2a9+0x1);_0x3aa4d8&&document[_0x583c65(0x8c2)](_0x583c65(0xc35))[_0x583c65(0xb17)][_0x583c65(0x795)]('active')&&await _0xa34c48();continue;case'qzone_comment':{const _0x2cd988=await _0x15043e['qzonePosts'][_0x583c65(0x3e9)](parseInt(_0x1ba053[_0x583c65(0x5f9)]));if(_0x2cd988){if(!_0x2cd988[_0x583c65(0x93c)])_0x2cd988['comments']=[];const _0x5a39b0=_0x1ba053[_0x583c65(0x596)]||_0x46f493[_0x583c65(0x4e7)],_0xf624e1=(_0x326494,_0x46cb17=null,_0x5806e9=null)=>({'commenterName':_0x5a39b0,'text':_0x206f67(_0x326494,_0x46f493),'meaning':_0x46cb17,'replyTo':_0x5806e9,'timestamp':Date[_0x583c65(0x1ed)]()});if(_0x1ba053[_0x583c65(0x72a)]&&_0x1ba053[_0x583c65(0x11e9)])_0x2cd988[_0x583c65(0x93c)][_0x583c65(0xa49)](_0xf624e1(_0x1ba053['stickerUrl'],_0x1ba053[_0x583c65(0x11e9)],_0x1ba053[_0x583c65(0x176)]||null));else{if(Array[_0x583c65(0xb85)](_0x1ba053[_0x583c65(0x93c)]))_0x1ba053[_0x583c65(0x93c)][_0x583c65(0x7c0)](_0x4b762d=>{const _0x34820e=_0x583c65;typeof _0x4b762d===_0x34820e(0xf1b)&&_0x4b762d[_0x34820e(0x8c6)]()&&_0x2cd988[_0x34820e(0x93c)]['push'](_0xf624e1(_0x4b762d,null,_0x1ba053[_0x34820e(0x176)]||null));});else{const _0x220636=_0x1ba053['commentText']||_0x1ba053[_0x583c65(0x168)];typeof _0x220636==='string'&&_0x220636['trim']()&&_0x2cd988['comments'][_0x583c65(0xa49)](_0xf624e1(_0x220636,null,_0x1ba053['replyTo']||null));}}await _0x15043e[_0x583c65(0xcc0)]['update'](_0x2cd988['id'],{'comments':_0x2cd988['comments']}),_0x156368(_0x38d2a9+0x1),document['getElementById'](_0x583c65(0xc35))['classList'][_0x583c65(0x795)](_0x583c65(0x71b))&&await _0xa34c48();}continue;}case _0x583c65(0x1ab):const _0x539cf0=await _0x15043e[_0x583c65(0xcc0)]['get'](parseInt(_0x1ba053['postId']));if(_0x539cf0){if(!_0x539cf0[_0x583c65(0xe2e)])_0x539cf0[_0x583c65(0xe2e)]=[];!_0x539cf0[_0x583c65(0xe2e)][_0x583c65(0x773)](_0x46f493[_0x583c65(0x596)])&&(_0x539cf0['likes'][_0x583c65(0xa49)](_0x46f493[_0x583c65(0x596)]),await _0x15043e[_0x583c65(0xcc0)][_0x583c65(0xb7c)](_0x539cf0['id'],{'likes':_0x539cf0['likes']}),_0x156368(_0x38d2a9+0x1),_0x3aa4d8&&document['getElementById'](_0x583c65(0xc35))[_0x583c65(0xb17)]['contains'](_0x583c65(0x71b))&&await _0xa34c48());}continue;case _0x583c65(0xa8b):{const _0x3b6311=await _0x15043e[_0x583c65(0xcc0)][_0x583c65(0x3e9)](parseInt(_0x1ba053[_0x583c65(0x5f9)]));if(_0x3b6311){const _0x370540={'type':_0x583c65(0xa8b),'timestamp':Date['now'](),'authorId':_0x284636,'authorGroupId':_0x46f493[_0x583c65(0x40f)],'repostComment':_0x1ba053['comment']||'','originalPost':_0x3b6311,'visibleGroupIds':null};await _0x15043e[_0x583c65(0xcc0)][_0x583c65(0x3f4)](_0x370540),_0x156368(_0x38d2a9+0x1),console[_0x583c65(0x32b)](_0x583c65(0x10af)+_0x46f493[_0x583c65(0x596)]+_0x583c65(0x318)+_0x1ba053[_0x583c65(0x5f9)]);}continue;}case _0x583c65(0x6f9):!_0x49beae[_0x583c65(0x6f0)]&&!_0x49beae[_0x583c65(0x324)]&&(_0x405767[_0x583c65(0x248)]=_0x284636,_0x49beae[_0x583c65(0x248)]=_0x284636,_0x49beae['isAwaitingResponse']=!![],_0x49beae['isGroupCall']=_0x46f493[_0x583c65(0x1000)],_0x49beae['callRequester']=_0x1ba053[_0x583c65(0x596)]||_0x46f493[_0x583c65(0x596)],_0x431406());continue;case _0x583c65(0x6f7):!_0x49beae['isActive']&&!_0x49beae['isAwaitingResponse']&&(_0x405767[_0x583c65(0x248)]=_0x284636,_0x49beae[_0x583c65(0x324)]=!![],_0x49beae[_0x583c65(0x390)]=!![],_0x49beae[_0x583c65(0xf70)]='ai',_0x49beae['callRequester']=_0x1ba053['name'],_0x431406());continue;case _0x583c65(0x11bd):let _0x32c3b8;if(_0x46f493[_0x583c65(0x1000)]){const _0x50fd2d=_0x46f493[_0x583c65(0x635)][_0x583c65(0x2ef)](_0x204cd0=>_0x204cd0[_0x583c65(0x4e7)]===_0x1ba053[_0x583c65(0x596)]);_0x32c3b8=_0x50fd2d?_0x50fd2d[_0x583c65(0x375)]:_0x1ba053[_0x583c65(0x596)];}else _0x32c3b8=_0x46f493[_0x583c65(0x596)];const _0x3af87f=_0x1ba053['suffix']?'\x20'+_0x1ba053[_0x583c65(0xedc)][_0x583c65(0x8c6)]():'',_0x2c8504=_0x32c3b8+_0x583c65(0x761)+_0x3af87f,_0x1c80d2={'role':_0x583c65(0x46c),'type':_0x583c65(0x6f1),'content':_0x2c8504,'timestamp':Date['now']()};_0x46f493['history'][_0x583c65(0xa49)](_0x1c80d2);if(_0x3aa4d8){const _0x18fc40=document['getElementById'](_0x583c65(0x5e7));_0x18fc40[_0x583c65(0xb17)]['remove'](_0x583c65(0x1165)),void _0x18fc40[_0x583c65(0x6f8)],_0x18fc40['classList'][_0x583c65(0x3f4)](_0x583c65(0x1165)),setTimeout(()=>_0x18fc40['classList'][_0x583c65(0xaff)]('pat-animation'),0x1f4),_0x5c5c92(_0x1c80d2,_0x46f493);}else _0x979d69(_0x284636,_0x2c8504);continue;case _0x583c65(0x526):_0x46f493[_0x583c65(0x8c8)][_0x583c65(0xbc6)]=_0x1ba053[_0x583c65(0xb91)],_0x46f493[_0x583c65(0x8c8)][_0x583c65(0xb5e)]=_0x1ba053[_0x583c65(0x4ad)]||![],_0x46f493[_0x583c65(0x8c8)]['lastUpdate']=Date[_0x583c65(0x1ed)]();const _0xa0b7f3={'role':_0x583c65(0x46c),'type':'pat_message','content':'['+_0x46f493['name']+_0x583c65(0xa78)+_0x1ba053['status_text']+']','timestamp':Date[_0x583c65(0x1ed)]()};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0xa0b7f3);_0x3aa4d8&&_0x5c5c92(_0xa0b7f3,_0x46f493);_0x2b55d1();continue;case _0x583c65(0xfbe):_0x16cb3a={..._0xa74f1b,'type':'location_share','content':_0x1ba053[_0x583c65(0x168)]};break;case _0x583c65(0x5ef):if(_0x4a77e1['isActive']&&_0x4a77e1[_0x583c65(0x248)]===_0x284636){const _0x5b65c7=_0x1ba053[_0x583c65(0x1092)]||_0x1ba053[_0x583c65(0x776)]||_0x1ba053[_0x583c65(0x596)];if(typeof _0x5b65c7===_0x583c65(0xf1b)&&_0x5b65c7['trim']()){const _0x3a2312=_0x5b65c7[_0x583c65(0x1b7)](/^\[?\d+\]?[\s.-]*/,'')['trim'](),_0x15c993=_0x4a77e1[_0x583c65(0xcfa)][_0x583c65(0x1149)](_0x186c52=>_0x186c52[_0x583c65(0x596)][_0x583c65(0xab8)]()===_0x3a2312[_0x583c65(0xab8)]());if(_0x15c993>-0x1){_0x2e10b2(_0x15c993);const _0x1fa0f1=_0x4a77e1[_0x583c65(0xcfa)][_0x15c993];let _0x1a2a61;if(_0x46f493['isGroup']){const _0x1d3dfc=_0x46f493[_0x583c65(0x635)][_0x583c65(0x2ef)](_0x250607=>_0x250607[_0x583c65(0x4e7)]===_0x1ba053[_0x583c65(0x596)]);_0x1a2a61=_0x1d3dfc?_0x1d3dfc[_0x583c65(0x375)]:_0x1ba053['name'];}else _0x1a2a61=_0x46f493['name'];const _0x9ca641={'role':'system','type':_0x583c65(0x6f1),'content':_0x583c65(0x710)+_0x1a2a61+'\x20为你切歌:\x20《'+_0x1fa0f1[_0x583c65(0x596)]+_0x583c65(0xe5b)+_0x1fa0f1[_0x583c65(0x7af)]+']','timestamp':Date[_0x583c65(0x1ed)]()};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0x9ca641),_0x3aa4d8&&_0x5c5c92(_0x9ca641,_0x46f493);}else console[_0x583c65(0x112a)]('歌曲查找失败:\x20AI请求的歌曲名\x22'+_0x5b65c7+_0x583c65(0xd9a)+_0x3a2312+_0x583c65(0x7f1));}else console[_0x583c65(0x7a3)](_0x583c65(0x47c),_0x1ba053);}continue;case'create_memory':const _0x39c559={'chatId':_0x284636,'authorId':_0x284636,'description':_0x1ba053[_0x583c65(0x3ca)],'timestamp':Date['now'](),'type':_0x583c65(0xf0c)};await _0x15043e[_0x583c65(0x4a0)][_0x583c65(0x3f4)](_0x39c559),console[_0x583c65(0x32b)](_0x583c65(0x54a)+_0x46f493[_0x583c65(0x596)]+_0x583c65(0x3ef),_0x1ba053[_0x583c65(0x3ca)]);continue;case'create_countdown':const _0x127e51=new Date(_0x1ba053['date']);if(!isNaN(_0x127e51)&&_0x127e51>new Date()){const _0x309e48={'chatId':_0x284636,'authorId':_0x284636,'description':_0x1ba053[_0x583c65(0xcea)],'timestamp':Date[_0x583c65(0x1ed)](),'type':_0x583c65(0x5ff),'targetDate':_0x127e51[_0x583c65(0x610)]()};await _0x15043e[_0x583c65(0x4a0)][_0x583c65(0x3f4)](_0x309e48),console[_0x583c65(0x32b)](_0x583c65(0x54a)+_0x46f493['name']+_0x583c65(0x115e),_0x1ba053[_0x583c65(0xcea)]);}continue;case _0x583c65(0x7b2):if(!_0x46f493[_0x583c65(0x1000)]){_0x46f493[_0x583c65(0x944)]['status']=_0x583c65(0x1058);const _0x477c79={'role':_0x583c65(0x46c),'content':_0x583c65(0xca6),'timestamp':Date['now'](),'isHidden':!![]};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0x477c79),await _0x15043e[_0x583c65(0x799)][_0x583c65(0xfaa)](_0x46f493);_0x3aa4d8&&_0x7dbe71(_0x284636);_0x2b55d1();break;}continue;case _0x583c65(0xdb1):!_0x46f493['isGroup']&&_0x46f493['relationship']?.[_0x583c65(0x8c8)]===_0x583c65(0x10b6)&&(_0x1ba053[_0x583c65(0x697)]==='accept'?(_0x46f493['relationship'][_0x583c65(0x8c8)]=_0x583c65(0xaa7),_0x16cb3a={..._0xa74f1b,'content':_0x583c65(0x6cf)}):(_0x46f493[_0x583c65(0x944)][_0x583c65(0x8c8)]=_0x583c65(0x1058),_0x16cb3a={..._0xa74f1b,'content':_0x583c65(0x11f7)}),_0x46f493['relationship'][_0x583c65(0x727)]='');break;case'poll':const _0x4b16a2=typeof _0x1ba053[_0x583c65(0x320)]===_0x583c65(0xf1b)?_0x1ba053['options']['split']('\x0a')[_0x583c65(0x1d8)](_0x24be7d=>_0x24be7d[_0x583c65(0x8c6)]()):Array[_0x583c65(0xb85)](_0x1ba053['options'])?_0x1ba053[_0x583c65(0x320)]:[];if(_0x4b16a2['length']<0x2)continue;_0x16cb3a={..._0xa74f1b,'type':_0x583c65(0x123d),'question':_0x1ba053[_0x583c65(0x8c4)],'options':_0x4b16a2,'votes':{},'isClosed':![]};break;case _0x583c65(0x2ad):{const {itemName:_0x206850,itemPrice:_0x377b7d,image_prompt:_0x2c74ff}=_0x1ba053;if(_0x206850&&!isNaN(parseFloat(_0x377b7d))&&_0x2c74ff){const _0x5bacbc=_0x583c65(0x2c6)+encodeURIComponent(_0x2c74ff);_0x16cb3a={..._0xa74f1b,'type':_0x583c65(0x2ad),'items':[{'name':_0x206850,'price':parseFloat(_0x377b7d),'imageUrl':_0x5bacbc,'quantity':0x1}],'total':parseFloat(_0x377b7d),'recipients':_0x1ba053[_0x583c65(0x667)]||null};}else console['warn'](_0x583c65(0x7ad),_0x1ba053);break;}case _0x583c65(0x1213):const _0x308f80=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x2ef)](_0xa03697=>_0xa03697[_0x583c65(0x351)]===_0x1ba053['poll_timestamp']);_0x308f80&&!_0x308f80['isClosed']&&(Object['keys'](_0x308f80[_0x583c65(0x2ab)])['forEach'](_0x1943e3=>{const _0x504dc1=_0x583c65,_0x525ce3=_0x308f80[_0x504dc1(0x2ab)][_0x1943e3][_0x504dc1(0xbf2)](_0x1ba053['name']);_0x525ce3>-0x1&&_0x308f80[_0x504dc1(0x2ab)][_0x1943e3][_0x504dc1(0x3e6)](_0x525ce3,0x1);}),!_0x308f80[_0x583c65(0x2ab)][_0x1ba053['choice']]&&(_0x308f80[_0x583c65(0x2ab)][_0x1ba053[_0x583c65(0xa77)]]=[]),!_0x308f80[_0x583c65(0x2ab)][_0x1ba053[_0x583c65(0xa77)]]['includes'](_0x1ba053[_0x583c65(0x596)])&&_0x308f80[_0x583c65(0x2ab)][_0x1ba053[_0x583c65(0xa77)]]['push'](_0x1ba053['name']),_0x3aa4d8&&_0x7dbe71(_0x284636));continue;case _0x583c65(0x59c):_0x16cb3a={..._0xa74f1b,..._0x1ba053,'totalAmount':_0x1ba053['amount'],'claimedBy':{},'isFullyClaimed':![]};_0x1ba053['receiver']&&(_0x16cb3a['receiverName']=_0x1ba053['receiver'],delete _0x16cb3a[_0x583c65(0x560)]);break;case _0x583c65(0xb89):const _0x13619c=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x2ef)](_0x3642c9=>_0x3642c9[_0x583c65(0x351)]===_0x1ba053[_0x583c65(0xf9b)]),_0x52ecb1=_0x1ba053[_0x583c65(0x596)],_0x355618=_0x46f493[_0x583c65(0x635)][_0x583c65(0xdc3)](_0x5a59c9=>_0x5a59c9['originalName']===_0x52ecb1);if(!_0x355618){console['warn'](_0x583c65(0x143)+_0x52ecb1+_0x583c65(0x1222));continue;}if(_0x13619c&&_0x13619c[_0x583c65(0x46b)]===_0x583c65(0x35c)){if(_0x13619c[_0x583c65(0xcf7)]!==_0x1ba053[_0x583c65(0x596)]){console['warn'](_0x583c65(0x143)+_0x1ba053[_0x583c65(0x596)]+_0x583c65(0xce3)+_0x13619c['receiverName']+_0x583c65(0x36a));continue;}}if(_0x13619c&&!_0x13619c[_0x583c65(0x2a6)]&&!(_0x13619c[_0x583c65(0x343)]&&_0x13619c[_0x583c65(0x343)][_0x1ba053[_0x583c65(0x596)]])){let _0x5b760f=0x0;const _0x22828f=_0x13619c['totalAmount']-Object[_0x583c65(0x22f)](_0x13619c[_0x583c65(0x343)]||{})[_0x583c65(0x29a)]((_0x7760ab,_0x50abff)=>_0x7760ab+_0x50abff,0x0),_0x311f3a=_0x13619c[_0x583c65(0xb61)]-Object[_0x583c65(0xbda)](_0x13619c['claimedBy']||{})[_0x583c65(0x105a)];if(_0x311f3a>0x0){if(_0x13619c[_0x583c65(0x46b)]===_0x583c65(0x35c))_0x5b760f=_0x13619c[_0x583c65(0x887)];else{if(_0x311f3a===0x1)_0x5b760f=_0x22828f;else{const _0x514890=0.01,_0x5471e0=_0x22828f-(_0x311f3a-0x1)*_0x514890;_0x5b760f=Math[_0x583c65(0x5b3)]()*(_0x5471e0-_0x514890)+_0x514890;}}_0x5b760f=parseFloat(_0x5b760f['toFixed'](0x2));if(!_0x13619c[_0x583c65(0x343)])_0x13619c[_0x583c65(0x343)]={};_0x13619c[_0x583c65(0x343)][_0x1ba053['name']]=_0x5b760f;const _0x3999ec=_0x46f493[_0x583c65(0x635)][_0x583c65(0x2ef)](_0x1e5b9e=>_0x1e5b9e['originalName']===_0x1ba053[_0x583c65(0x596)]),_0x56ad5e=_0x3999ec?_0x3999ec[_0x583c65(0x375)]:_0x1ba053['name'],_0x61004=_0x1ba34a(_0x46f493,_0x13619c[_0x583c65(0x770)]),_0x2f8e8c={'role':'system','type':'pat_message','content':_0x56ad5e+_0x583c65(0xa6e)+_0x61004+_0x583c65(0xe25),'timestamp':Date[_0x583c65(0x1ed)]()};_0x46f493['history']['push'](_0x2f8e8c);let _0x1526ab=_0x583c65(0x346)+_0x56ad5e+')\x20成功抢到了\x20'+_0x5b760f['toFixed'](0x2)+_0x583c65(0xec2);if(Object[_0x583c65(0xbda)](_0x13619c['claimedBy'])['length']>=_0x13619c[_0x583c65(0xb61)]){_0x13619c[_0x583c65(0x2a6)]=!![];const _0x246a6c={'role':_0x583c65(0x46c),'type':_0x583c65(0x6f1),'content':_0x61004+_0x583c65(0x4e5),'timestamp':Date['now']()+0x1};_0x46f493[_0x583c65(0xd39)]['push'](_0x246a6c);let _0x32066b={'name':'','amount':-0x1};_0x13619c['packetType']===_0x583c65(0x46e)&&_0x13619c[_0x583c65(0xb61)]>0x1&&Object[_0x583c65(0x6ff)](_0x13619c[_0x583c65(0x343)])['forEach'](([_0x402aa2,_0x41c7e9])=>{_0x41c7e9>_0x32066b['amount']&&(_0x32066b={'name':_0x402aa2,'amount':_0x41c7e9});});if(_0x32066b['name']){const _0x12f82d=_0x46f493[_0x583c65(0x635)][_0x583c65(0x2ef)](_0x14ec2a=>_0x14ec2a[_0x583c65(0x4e7)]===_0x32066b[_0x583c65(0x596)]),_0x2f787b=_0x12f82d?_0x12f82d['groupNickname']:_0x32066b[_0x583c65(0x596)];_0x1526ab+=_0x583c65(0x931)+_0x2f787b+'！';}else _0x1526ab+='\x20红包已被领完。';}_0x1526ab+='\x20请根据这个结果发表你的评论。]';const _0x3f8a9b={'role':_0x583c65(0x46c),'content':_0x1526ab,'timestamp':Date[_0x583c65(0x1ed)]()+0x2,'isHidden':!![]};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0x3f8a9b);}_0x3aa4d8&&(_0x7dbe71(_0x284636),_0x2b55d1());}continue;case _0x583c65(0x4cb):{const _0x501a94=_0x46f493[_0x583c65(0xd39)]['findIndex'](_0x1ee89f=>_0x1ee89f['timestamp']===_0x1ba053[_0x583c65(0xe39)]);if(_0x501a94>-0x1){const _0x118064=_0x46f493[_0x583c65(0xd39)][_0x501a94];_0x118064[_0x583c65(0x8c8)]=_0x583c65(0xe4b);}continue;}case'decline_transfer':{const _0x4466ce=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x1149)](_0xf6fe0c=>_0xf6fe0c[_0x583c65(0x351)]===_0x1ba053['for_timestamp']);if(_0x4466ce>-0x1){const _0xa20f5a=_0x46f493[_0x583c65(0xd39)][_0x4466ce];_0xa20f5a[_0x583c65(0x8c8)]=_0x583c65(0x1288);const _0x37f8fa={'role':_0x583c65(0x458),'senderName':_0x46f493[_0x583c65(0x596)],'type':_0x583c65(0x11b9),'isRefund':!![],'amount':_0xa20f5a[_0x583c65(0x4c5)],'note':'转账已被拒收','timestamp':_0x243c85++};_0x46f493['history'][_0x583c65(0xa49)](_0x37f8fa),_0x3aa4d8&&(_0x5c5c92(_0x37f8fa,_0x46f493),_0x7dbe71(_0x284636));}continue;}case _0x583c65(0x1b6):if(_0x46f493[_0x583c65(0x1000)]&&_0x1ba053[_0x583c65(0x969)]){const _0x553ee9=_0x1ba053['new_name'][_0x583c65(0x8c6)](),_0x11e3ef=_0x46f493[_0x583c65(0x635)][_0x583c65(0x6b9)](_0x542ddb=>_0x542ddb[_0x583c65(0x4e7)]);if(_0x11e3ef[_0x583c65(0x773)](_0x553ee9)){console['warn'](_0x583c65(0x8ed)+_0x1ba053[_0x583c65(0x596)]+')\x20试图将群名更改为成员名\x20(\x22'+_0x553ee9+_0x583c65(0x3be));continue;}_0x46f493[_0x583c65(0x596)]=_0x553ee9;const _0x3bb94b=_0x46f493[_0x583c65(0x635)][_0x583c65(0x2ef)](_0x4c17ad=>_0x4c17ad[_0x583c65(0x4e7)]===_0x1ba053[_0x583c65(0x596)]),_0x116755=_0x3bb94b?_0x3bb94b[_0x583c65(0x375)]:_0x1ba053[_0x583c65(0x596)],_0x535afc={'role':_0x583c65(0x46c),'type':_0x583c65(0x6f1),'content':_0x116755+_0x583c65(0xd9e)+_0x46f493[_0x583c65(0x596)]+'”','timestamp':_0x243c85++};_0x46f493['history'][_0x583c65(0xa49)](_0x535afc),_0x3aa4d8&&(_0x5c5c92(_0x535afc,_0x46f493),document[_0x583c65(0x8c2)](_0x583c65(0x334))[_0x583c65(0x1090)]=_0x46f493['name']);}continue;case'change_remark_name':if(!_0x46f493[_0x583c65(0x1000)]&&_0x1ba053[_0x583c65(0x969)]){const _0x5322c3=_0x46f493[_0x583c65(0x596)],_0x45ce4b=_0x1ba053['new_name'][_0x583c65(0x8c6)]();if(_0x45ce4b&&_0x45ce4b!==_0x5322c3){!_0x46f493[_0x583c65(0x1116)]&&(_0x46f493[_0x583c65(0x1116)]=[]);!_0x46f493[_0x583c65(0x1116)]['includes'](_0x5322c3)&&_0x46f493[_0x583c65(0x1116)][_0x583c65(0xa49)](_0x5322c3);_0x46f493[_0x583c65(0x596)]=_0x45ce4b;const _0x4cfe91={'role':_0x583c65(0x46c),'type':_0x583c65(0x6f1),'content':'“'+_0x46f493['originalName']+'”\x20将备注修改为\x20“'+_0x45ce4b+'”','timestamp':_0x243c85++};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0x4cfe91);const _0x3e74cd={'role':_0x583c65(0x46c),'content':'[系统提示：你刚刚成功将自己的备注名修改为了“'+_0x45ce4b+_0x583c65(0xbfb),'timestamp':_0x243c85++,'isHidden':!![]};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0x3e74cd),_0x3aa4d8&&(_0x5c5c92(_0x4cfe91,_0x46f493),document[_0x583c65(0x8c2)](_0x583c65(0x334))[_0x583c65(0x1090)]=_0x45ce4b),await _0x4b93d2(_0x46f493);}}continue;case _0x583c65(0xa08):if(_0x46f493[_0x583c65(0x1000)]&&_0x1ba053[_0x583c65(0xe24)]){const _0x4f6f29=_0x1ba053['avatar_name'],_0x44b30c=_0x46f493[_0x583c65(0x33a)][_0x583c65(0x227)]||[],_0x23b31c=_0x44b30c['find'](_0x26ebbf=>_0x26ebbf[_0x583c65(0x596)]===_0x4f6f29);if(_0x23b31c){_0x46f493['settings'][_0x583c65(0x43b)]=_0x23b31c[_0x583c65(0x9d6)];const _0x29a483=_0x46f493[_0x583c65(0x635)][_0x583c65(0x2ef)](_0x1d0c5e=>_0x1d0c5e[_0x583c65(0x4e7)]===_0x1ba053[_0x583c65(0x596)]),_0x4be793=_0x29a483?_0x29a483[_0x583c65(0x375)]:_0x1ba053[_0x583c65(0x596)],_0x47abb1={'role':'system','type':_0x583c65(0x6f1),'content':_0x4be793+_0x583c65(0x607),'timestamp':_0x243c85++};_0x46f493[_0x583c65(0xd39)][_0x583c65(0xa49)](_0x47abb1),_0x3aa4d8&&_0x5c5c92(_0x47abb1,_0x46f493);}else console[_0x583c65(0x112a)](_0x583c65(0x92d)+_0x4f6f29+'\x22');}continue;case _0x583c65(0x525):_0x16cb3a={'role':'system','type':'pat_message','content':_0x1ba053[_0x583c65(0x168)],'timestamp':Date['now']()};break;case _0x583c65(0xda5):_0x16cb3a={..._0xa74f1b,'type':_0x583c65(0xda5),'title':_0x1ba053[_0x583c65(0xcea)],'description':_0x1ba053['description'],'source_name':_0x1ba053[_0x583c65(0xefa)],'content':_0x1ba053[_0x583c65(0x168)]};break;case _0x583c65(0x58a):const _0x1b028b=_0x46f493['history'][_0x583c65(0x2ef)](_0x3ee694=>_0x3ee694[_0x583c65(0x351)]===_0x1ba053['target_timestamp']);if(_0x1b028b){const _0xb6a08a={'timestamp':_0x1b028b[_0x583c65(0x351)],'senderName':_0x1b028b[_0x583c65(0x770)]||(_0x1b028b[_0x583c65(0x14a)]===_0x583c65(0x74b)?_0x46f493[_0x583c65(0x33a)][_0x583c65(0xe16)]||'我':_0x46f493[_0x583c65(0x596)]),'content':String(_0x1b028b[_0x583c65(0x168)]||'')[_0x583c65(0x599)](0x0,0x32)};_0x16cb3a={..._0xa74f1b,'content':_0x1ba053[_0x583c65(0xe6f)],'quote':_0xb6a08a};}else _0x16cb3a={..._0xa74f1b,'content':_0x1ba053[_0x583c65(0xe6f)]};break;case _0x583c65(0x647):{if(!_0x3aa4d8)continue;const _0x525662={..._0xa74f1b,'content':_0x1ba053[_0x583c65(0x168)]},_0x3bcad4=_0x3cd22d(_0x525662,_0x46f493);_0x5c5c92(_0x525662,_0x46f493,!![]),await new Promise(_0x326e14=>setTimeout(_0x326e14,Math[_0x583c65(0x5b3)]()*0x3e8+0x5dc));const _0x533b8d=document['querySelector'](_0x583c65(0x4a4)+_0x525662[_0x583c65(0x351)]+'\x22]')?.[_0x583c65(0xa90)](_0x583c65(0x1270));if(_0x533b8d){_0x533b8d[_0x583c65(0xb17)][_0x583c65(0x3f4)](_0x583c65(0x973)),await new Promise(_0x3a7880=>setTimeout(_0x3a7880,0x12c));const _0x57067c={'role':_0x583c65(0x458),'senderName':_0x1ba053[_0x583c65(0x596)]||_0x46f493[_0x583c65(0x596)],'type':_0x583c65(0x87c),'content':_0x583c65(0x886),'timestamp':_0x525662[_0x583c65(0x351)],'recalledData':{'originalType':_0x583c65(0xbc6),'originalContent':_0x1ba053[_0x583c65(0x168)]}},_0x4ed6ec=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x1149)](_0x495cdf=>_0x495cdf[_0x583c65(0x351)]===_0x525662[_0x583c65(0x351)]);_0x4ed6ec>-0x1?_0x46f493[_0x583c65(0xd39)][_0x4ed6ec]=_0x57067c:_0x46f493['history'][_0x583c65(0xa49)](_0x57067c);const _0x89a614=await _0x3cd22d(_0x57067c,_0x46f493);document[_0x583c65(0x540)][_0x583c65(0x795)](_0x533b8d)&&_0x533b8d[_0x583c65(0xe66)]['replaceChild'](_0x89a614,_0x533b8d);}continue;}case _0x583c65(0xbc6):_0x16cb3a={..._0xa74f1b,'content':String(_0x1ba053[_0x583c65(0x168)]||_0x1ba053['message'])};break;case _0x583c65(0x1ac):_0x16cb3a={..._0xa74f1b,'type':_0x583c65(0x1ac),'content':_0x1ba053[_0x583c65(0x9d6)],'meaning':_0x1ba053[_0x583c65(0x2b7)]||''};break;case'ai_image':_0x16cb3a={..._0xa74f1b,'type':_0x583c65(0x7c8),'content':_0x1ba053['description'],'image_prompt':_0x1ba053[_0x583c65(0xdae)]};break;case'voice_message':_0x16cb3a={..._0xa74f1b,'type':'voice_message','content':_0x1ba053['content']};break;case'transfer':_0x16cb3a={..._0xa74f1b,'type':_0x583c65(0x11b9),'amount':_0x1ba053[_0x583c65(0x4c5)],'note':_0x1ba053[_0x583c65(0x113f)],'receiverName':_0x1ba053[_0x583c65(0x560)]||'我'};break;case _0x583c65(0x11b2):_0x16cb3a={..._0xa74f1b,'type':'waimai_request','productInfo':_0x1ba053[_0x583c65(0xc7a)],'amount':_0x1ba053[_0x583c65(0x4c5)],'status':_0x583c65(0xd2d),'countdownEndTime':Date[_0x583c65(0x1ed)]()+0xf*0x3c*0x3e8};break;case _0x583c65(0x1061):_0x16cb3a={..._0xa74f1b,'type':_0x583c65(0x1061),'productInfo':_0x1ba053[_0x583c65(0xc7a)],'amount':_0x1ba053['amount'],'greeting':_0x1ba053[_0x583c65(0x26c)],'recipientName':_0x1ba053[_0x583c65(0x69f)]||null};break;case _0x583c65(0xaac):_0x16cb3a={..._0xa74f1b,..._0x1ba053};default:console[_0x583c65(0x112a)](_0x583c65(0x577),_0x1ba053[_0x583c65(0xde0)]);break;}if(_0x16cb3a){_0x46f493[_0x583c65(0xd39)]['push'](_0x16cb3a);!_0x3aa4d8&&(_0x46f493[_0x583c65(0xf10)]=(_0x46f493[_0x583c65(0xf10)]||0x0)+0x1);if(!_0x3aa4d8&&!_0xead394){let _0x5c0954;switch(_0x16cb3a['type']){case'transfer':_0x5c0954='[收到一笔转账]';break;case _0x583c65(0x11b2):_0x5c0954=_0x583c65(0x520);break;case _0x583c65(0x7c8):_0x5c0954=_0x583c65(0xcb0);break;case _0x583c65(0xf64):_0x5c0954=_0x583c65(0xa7c);break;case _0x583c65(0x1ac):_0x5c0954=_0x16cb3a[_0x583c65(0x2b7)]?'[表情:\x20'+_0x16cb3a[_0x583c65(0x2b7)]+']':'[表情]';break;case _0x583c65(0xaac):_0x5c0954=_0x16cb3a[_0x583c65(0x1028)]?'「'+_0x16cb3a[_0x583c65(0x1028)]+'」':'['+_0x16cb3a[_0x583c65(0x3ca)][_0x583c65(0x599)](0x0,0x14)+_0x583c65(0x1228);break;default:_0x5c0954=String(_0x16cb3a['content']||'');}const _0x936dd7=_0x46f493[_0x583c65(0x1000)]?_0x16cb3a['senderName']+':\x20'+_0x5c0954:_0x5c0954;_0x979d69(_0x284636,_0x936dd7['substring'](0x0,0x28)+(_0x936dd7['length']>0x28?_0x583c65(0x388):'')),_0xead394=!![];}_0x3aa4d8&&(_0x5c5c92(_0x16cb3a,_0x46f493),await new Promise(_0x18583c=>setTimeout(_0x18583c,Math[_0x583c65(0x5b3)]()*0x708+0x3e8)));}}_0x492a80&&_0x49beae['isGroupCall']&&(_0x49beae['isAwaitingResponse']=![],_0x49beae['participants']['length']>0x0?_0x543413():(_0x49beae={..._0x49beae,'isAwaitingResponse':![],'participants':[]},_0x3d1990(_0x583c65(0xd5c)),alert(_0x583c65(0xfdc))));if(_0x5c1ab5){await _0x523815();return;}await _0x15043e[_0x583c65(0x799)][_0x583c65(0xfaa)](_0x46f493);const _0x35b0fe=_0x1bb3fb[_0x583c65(0xdc3)](_0x4eeb42=>_0x4eeb42[_0x583c65(0xde0)]===_0x583c65(0x80e)||_0x4eeb42[_0x583c65(0xde0)]===_0x583c65(0x1ab)||_0x4eeb42['type']===_0x583c65(0xed9)||_0x4eeb42[_0x583c65(0xde0)]===_0x583c65(0xa8b));_0x35b0fe&&(console[_0x583c65(0x32b)](_0x583c65(0x2f6)),await _0xa34c48());}catch(_0x1c3cb0){_0x46f493[_0x583c65(0xd39)]=_0x46f493[_0x583c65(0xd39)][_0x583c65(0x1d8)](_0x26af5c=>!_0x26af5c[_0x583c65(0x1230)]),!_0x46f493[_0x583c65(0x1000)]&&_0x46f493[_0x583c65(0x944)]?.[_0x583c65(0x8c8)]===_0x583c65(0x10b6)?(_0x46f493[_0x583c65(0x944)][_0x583c65(0x8c8)]=_0x583c65(0x1058),await _0x501c7b(_0x583c65(0x515),_0x583c65(0x1066)+_0x1c3cb0[_0x583c65(0xc7d)])):await _0x501c7b(_0x583c65(0xddf),_0x583c65(0xebc)+_0x1c3cb0['message']),!_0x46f493[_0x583c65(0x1000)]&&_0x46f493[_0x583c65(0x944)]?.[_0x583c65(0x8c8)]===_0x583c65(0x1058)&&await _0x15043e['chats'][_0x583c65(0xfaa)](_0x46f493),_0x49beae[_0x583c65(0x324)]=![];}finally{_0x24fb6c(_0x284636,![]),_0x46f493[_0x583c65(0x1000)]?_0x37ccd9&&(_0x37ccd9[_0x583c65(0x842)]['display']=_0x583c65(0xbf8)):_0x4962b3&&_0x405767[_0x583c65(0x799)][_0x284636]&&(_0x4962b3[_0x583c65(0x842)][_0x583c65(0x9d7)]=0x0,setTimeout(()=>{const _0x2a74b0=_0x583c65;_0x4962b3[_0x2a74b0(0x1090)]=_0x405767['chats'][_0x284636]['name'],_0x4962b3[_0x2a74b0(0xb17)][_0x2a74b0(0xaff)]('typing-status'),_0x4962b3[_0x2a74b0(0x842)][_0x2a74b0(0x9d7)]=0x1;},0xc8)),_0x2b55d1(),_0x535870&&_0x153c8b(_0x284636),_0x5c79b7();}}async function _0x1a6327(_0x5a0083){const _0x456ddd=_0x18b51e;if(!_0x405767[_0x456ddd(0x248)])return;const _0x1cde3d=_0x405767['chats'][_0x405767[_0x456ddd(0x248)]],_0x558995={'role':_0x456ddd(0x74b),'content':_0x5a0083['url'],'meaning':_0x5a0083['name'],'timestamp':Date[_0x456ddd(0x1ed)]()};_0x1cde3d[_0x456ddd(0xd39)][_0x456ddd(0xa49)](_0x558995),await _0x15043e[_0x456ddd(0x799)][_0x456ddd(0xfaa)](_0x1cde3d),_0x5c5c92(_0x558995,_0x1cde3d),_0x2b55d1(),document[_0x456ddd(0x8c2)]('sticker-panel')[_0x456ddd(0xb17)]['remove'](_0x456ddd(0x2cd));}async function _0x1b76f1(){const _0x5f48f8=_0x18b51e;if(!_0x405767[_0x5f48f8(0x248)])return;const _0x3a3ec1=document[_0x5f48f8(0x8c2)](_0x5f48f8(0xe00)),_0x3e6992=document[_0x5f48f8(0x8c2)](_0x5f48f8(0x99d)),_0x376502=parseFloat(_0x3a3ec1[_0x5f48f8(0x518)]),_0x561bc3=_0x3e6992[_0x5f48f8(0x518)][_0x5f48f8(0x8c6)]();if(isNaN(_0x376502)||_0x376502<0x0){alert(_0x5f48f8(0xfba));return;}const _0x549633=_0x405767['chats'][_0x405767['activeChatId']],_0x26b1cd=_0x549633[_0x5f48f8(0x1000)]?_0x549633[_0x5f48f8(0x33a)][_0x5f48f8(0xe16)]||'我':'我',_0x1de29d=_0x549633['isGroup']?'群聊':_0x549633[_0x5f48f8(0x596)],_0x5250a6={'role':'user','type':'transfer','amount':_0x376502,'note':_0x561bc3,'senderName':_0x26b1cd,'receiverName':_0x1de29d,'timestamp':Date[_0x5f48f8(0x1ed)]()};_0x549633[_0x5f48f8(0xd39)][_0x5f48f8(0xa49)](_0x5250a6),await _0x15043e[_0x5f48f8(0x799)][_0x5f48f8(0xfaa)](_0x549633),_0x5c5c92(_0x5250a6,_0x549633),_0x2b55d1(),document[_0x5f48f8(0x8c2)]('transfer-modal')['classList'][_0x5f48f8(0xaff)](_0x5f48f8(0x2cd)),_0x3a3ec1[_0x5f48f8(0x518)]='',_0x3e6992[_0x5f48f8(0x518)]='';}async function _0x2ada65(){const _0x21f349=_0x18b51e;if(!_0x405767['activeChatId'])return;const _0xe6292f=document[_0x21f349(0x8c2)](_0x21f349(0x3ad)),_0x28cd76=document[_0x21f349(0x8c2)](_0x21f349(0x32f)),_0x710d1e=_0xe6292f['value'][_0x21f349(0x8c6)](),_0x1071ee=parseFloat(_0x28cd76[_0x21f349(0x518)]);if(!_0x710d1e||isNaN(_0x1071ee)||_0x1071ee<=0x0){alert('请填写有效的商品信息和金额！');return;}const _0x44bf31=_0x405767[_0x21f349(0x799)][_0x405767['activeChatId']],_0x264ed9=Date[_0x21f349(0x1ed)](),_0x464630=_0x44bf31[_0x21f349(0x1000)]?_0x44bf31[_0x21f349(0x33a)]['myNickname']||'我':'我',_0x5df625={'role':_0x21f349(0x74b),'senderName':_0x464630,'type':_0x21f349(0x1061),'productInfo':_0x710d1e,'amount':_0x1071ee,'timestamp':_0x264ed9};_0x44bf31[_0x21f349(0xd39)][_0x21f349(0xa49)](_0x5df625);const _0x8bd1e1={'role':_0x21f349(0x46c),'content':_0x21f349(0x604)+_0x464630+_0x21f349(0xf55)+_0x710d1e+_0x21f349(0x1097)+_0x1071ee+_0x21f349(0x100d),'timestamp':_0x264ed9+0x1,'isHidden':!![]};_0x44bf31[_0x21f349(0xd39)][_0x21f349(0xa49)](_0x8bd1e1),await _0x15043e[_0x21f349(0x799)][_0x21f349(0xfaa)](_0x44bf31),_0x5c5c92(_0x5df625,_0x44bf31),_0x2b55d1(),_0xe6292f[_0x21f349(0x518)]='',_0x28cd76[_0x21f349(0x518)]='',document[_0x21f349(0x8c2)]('waimai-request-modal')[_0x21f349(0xb17)][_0x21f349(0xaff)](_0x21f349(0x2cd));}async function _0x3e520e(){const _0x27cd2e=_0x18b51e;if(!_0x405767[_0x27cd2e(0x248)])return;const _0x3bb1ac=await _0x180f74(_0x27cd2e(0xb31),'你现在在哪里呀？','');if(!_0x3bb1ac||!_0x3bb1ac[_0x27cd2e(0x8c6)]())return;const _0x58d584=_0x27cd2e(0xc99),_0x24a80e=_0x405767[_0x27cd2e(0x799)][_0x405767[_0x27cd2e(0x248)]],_0xc784f={'role':_0x27cd2e(0x74b),'type':_0x27cd2e(0xfbe),'content':_0x3bb1ac[_0x27cd2e(0x8c6)](),'imageUrl':_0x58d584,'timestamp':Date[_0x27cd2e(0x1ed)]()};_0x24a80e[_0x27cd2e(0xd39)][_0x27cd2e(0xa49)](_0xc784f),await _0x15043e[_0x27cd2e(0x799)][_0x27cd2e(0xfaa)](_0x24a80e),_0x5c5c92(_0xc784f,_0x24a80e),_0x2b55d1();}function _0x4bac0a(_0x5e5ba3){const _0x4dd2ac=_0x18b51e;if(_0x324554)return;_0x324554=!![],document[_0x4dd2ac(0x8c2)](_0x4dd2ac(0xd5c))['classList'][_0x4dd2ac(0x3f4)](_0x4dd2ac(0xe97)),_0xd7c822(_0x5e5ba3);}function _0x23ba0c(){const _0x3f79e2=_0x18b51e;_0x579bb3();if(!_0x324554)return;_0x324554=![],document[_0x3f79e2(0x8c2)]('chat-interface-screen')['classList'][_0x3f79e2(0xaff)](_0x3f79e2(0xe97)),_0x13ef23[_0x3f79e2(0x7c0)](_0x33e14=>{const _0x219308=_0x3f79e2,_0x3d4cb1=document[_0x219308(0x1ad)]('.message-bubble[data-timestamp=\x22'+_0x33e14+'\x22]');if(_0x3d4cb1)_0x3d4cb1[_0x219308(0xb17)][_0x219308(0xaff)](_0x219308(0x118f));}),_0x13ef23[_0x3f79e2(0xa6a)]();}function _0xd7c822(_0x547675){const _0x1f3ff5=_0x18b51e,_0x174c1e=document[_0x1f3ff5(0x1ad)](_0x1f3ff5(0x4a4)+_0x547675+'\x22]');if(!_0x174c1e)return;_0x13ef23[_0x1f3ff5(0x11ac)](_0x547675)?(_0x13ef23[_0x1f3ff5(0x89f)](_0x547675),_0x174c1e['classList'][_0x1f3ff5(0xaff)]('selected')):(_0x13ef23[_0x1f3ff5(0x3f4)](_0x547675),_0x174c1e[_0x1f3ff5(0xb17)][_0x1f3ff5(0x3f4)](_0x1f3ff5(0x118f))),document[_0x1f3ff5(0x8c2)](_0x1f3ff5(0x84e))[_0x1f3ff5(0x1090)]=_0x1f3ff5(0xf2d)+_0x13ef23[_0x1f3ff5(0xf72)]+'\x20条',_0x13ef23[_0x1f3ff5(0xf72)]===0x0&&_0x23ba0c();}function _0x5dcbd7(_0x20b61a,_0x47032b){const _0x537a93=_0x18b51e;let _0x4619d3;const _0x27929c=_0x262a2a=>{const _0x3c3f24=_0x7a65;if(_0x324554)return;_0x262a2a[_0x3c3f24(0xd35)](),_0x4619d3=window['setTimeout'](()=>_0x47032b(_0x262a2a),0x1f4);},_0x4e6981=()=>clearTimeout(_0x4619d3);_0x20b61a[_0x537a93(0xae8)](_0x537a93(0x5d5),_0x27929c),_0x20b61a[_0x537a93(0xae8)](_0x537a93(0x72c),_0x4e6981),_0x20b61a['addEventListener']('mouseleave',_0x4e6981),_0x20b61a['addEventListener']('touchstart',_0x27929c,{'passive':!![]}),_0x20b61a[_0x537a93(0xae8)](_0x537a93(0x519),_0x4e6981),_0x20b61a[_0x537a93(0xae8)](_0x537a93(0x4c1),_0x4e6981);}async function _0x39aa4d(){const _0x1aed3f=_0x18b51e,_0x13ad7b=_0x405767[_0x1aed3f(0x248)];if(!_0x13ad7b)return;if(!_0x4a77e1[_0x1aed3f(0x6f0)]){_0x52b290(_0x13ad7b);return;}if(_0x4a77e1[_0x1aed3f(0x248)]===_0x13ad7b)document[_0x1aed3f(0x8c2)]('music-player-overlay')[_0x1aed3f(0xb17)][_0x1aed3f(0x3f4)]('visible');else{const _0x56bafa=_0x405767[_0x1aed3f(0x799)][_0x4a77e1[_0x1aed3f(0x248)]]?.[_0x1aed3f(0x596)]||'未知',_0x415eaf=_0x405767['chats'][_0x13ad7b]?.['name']||'当前',_0x27ca2b=await _0x8b9cb8(_0x1aed3f(0x7b9),_0x1aed3f(0x707)+_0x56bafa+_0x1aed3f(0xd55)+_0x415eaf+_0x1aed3f(0xb0f),{'confirmButtonClass':'btn-danger'});_0x27ca2b&&(await _0x221338(!![]),await new Promise(_0x18517c=>setTimeout(_0x18517c,0x32)),_0x52b290(_0x13ad7b));}}async function _0x52b290(_0x301158){const _0x36af43=_0x18b51e,_0x1a8f21=_0x405767['chats'][_0x301158];if(!_0x1a8f21)return;_0x4a77e1[_0x36af43(0xcf1)]=_0x1a8f21[_0x36af43(0xfed)][_0x36af43(0x42d)]||0x0,_0x4a77e1[_0x36af43(0x6f0)]=!![],_0x4a77e1['activeChatId']=_0x301158;_0x4a77e1[_0x36af43(0xcfa)][_0x36af43(0x105a)]>0x0?_0x4a77e1['currentIndex']=0x0:_0x4a77e1['currentIndex']=-0x1;if(_0x4a77e1[_0x36af43(0x6d2)])clearInterval(_0x4a77e1[_0x36af43(0x6d2)]);_0x4a77e1['timerId']=setInterval(()=>{const _0xd090b6=_0x36af43;_0x4a77e1[_0xd090b6(0x219)]&&(_0x4a77e1['totalElapsedTime']++,_0x5cf71c());},0x3e8),_0x59d0b7(),_0x3439d6(),document['getElementById'](_0x36af43(0x1df))[_0x36af43(0xb17)][_0x36af43(0x3f4)](_0x36af43(0x2cd));}async function _0x221338(_0x1f4496=!![]){const _0x2261aa=_0x18b51e;if(!_0x4a77e1['isActive'])return;const _0x1ae139=_0x4a77e1['activeChatId'];document[_0x2261aa(0x8c2)](_0x2261aa(0x5a6))[_0x2261aa(0xb17)][_0x2261aa(0xaff)](_0x2261aa(0x2cd));const _0x364c63=async()=>{const _0x361f0e=_0x2261aa;if(_0x4a77e1[_0x361f0e(0x6d2)])clearInterval(_0x4a77e1[_0x361f0e(0x6d2)]);if(_0x4a77e1[_0x361f0e(0x219)])_0x3fd13b['pause']();if(_0x1f4496&&_0x1ae139&&_0x405767[_0x361f0e(0x799)][_0x1ae139]){const _0xcf0ca8=_0x405767[_0x361f0e(0x799)][_0x1ae139];_0xcf0ca8[_0x361f0e(0xfed)][_0x361f0e(0x42d)]=_0x4a77e1['totalElapsedTime'],await _0x15043e['chats'][_0x361f0e(0xfaa)](_0xcf0ca8);}_0x4a77e1[_0x361f0e(0x6f0)]=![],_0x4a77e1[_0x361f0e(0x248)]=null,_0x4a77e1[_0x361f0e(0xcf1)]=0x0,_0x4a77e1[_0x361f0e(0x6d2)]=null,_0x50a5a8(_0x1ae139,!![]);};_0x8d5530(_0x364c63);}function _0x31e6d3(){_0x8d5530();}function _0x50a5a8(_0x17a25d,_0x23362c=![]){const _0x2868fe=_0x18b51e,_0x149830=document[_0x2868fe(0x1ad)](_0x2868fe(0x832));if(!_0x149830)return;if(_0x23362c||!_0x4a77e1[_0x2868fe(0x6f0)]||_0x4a77e1[_0x2868fe(0x248)]!==_0x17a25d){_0x149830[_0x2868fe(0x939)]=_0x2868fe(0xc2d),_0x149830[_0x2868fe(0x84c)]='';return;}_0x149830[_0x2868fe(0x939)]=_0x2868fe(0xe2f),_0x149830['classList'][_0x2868fe(0x3f4)](_0x2868fe(0x21a));if(_0x4a77e1[_0x2868fe(0x219)])_0x149830['classList'][_0x2868fe(0xaff)]('paused');else _0x149830['classList'][_0x2868fe(0x3f4)](_0x2868fe(0xcf5));}window[_0x18b51e(0xc43)]=_0x50a5a8;function _0x59d0b7(){const _0x447996=_0x18b51e;_0x50a5a8(_0x4a77e1[_0x447996(0x248)]),_0x5cf71c();const _0x215cdd=document[_0x447996(0x8c2)]('music-player-song-title'),_0x2fd802=document[_0x447996(0x8c2)]('music-player-artist'),_0x35bdcc=document[_0x447996(0x8c2)](_0x447996(0x50d));if(_0x4a77e1['currentIndex']>-0x1&&_0x4a77e1['playlist'][_0x447996(0x105a)]>0x0){const _0x3b4029=_0x4a77e1['playlist'][_0x4a77e1[_0x447996(0x585)]];_0x215cdd['textContent']=_0x3b4029[_0x447996(0x596)],_0x2fd802[_0x447996(0x1090)]=_0x3b4029[_0x447996(0x7af)];}else _0x215cdd[_0x447996(0x1090)]=_0x447996(0xf24),_0x2fd802[_0x447996(0x1090)]='...';_0x35bdcc[_0x447996(0x1090)]=_0x4a77e1[_0x447996(0x219)]?'❚❚':'▶';}function _0x5cf71c(){const _0x459c70=_0x18b51e,_0x3071fe=(_0x4a77e1[_0x459c70(0xcf1)]/0xe10)[_0x459c70(0x3c1)](0x1);document[_0x459c70(0x8c2)](_0x459c70(0x1252))[_0x459c70(0x1090)]=_0x459c70(0x1ff)+_0x3071fe+'小时';}function _0x3439d6(){const _0xc3108d=_0x18b51e,_0xbead3f=document[_0xc3108d(0x8c2)](_0xc3108d(0x499));_0xbead3f['innerHTML']='';if(_0x4a77e1[_0xc3108d(0xcfa)]['length']===0x0){_0xbead3f[_0xc3108d(0xca0)]='<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>';return;}_0x4a77e1['playlist']['forEach']((_0x264c7d,_0x36b826)=>{const _0x878fbf=_0xc3108d,_0x223a1c=document[_0x878fbf(0x8c1)](_0x878fbf(0x1072));_0x223a1c[_0x878fbf(0x84c)]=_0x878fbf(0x507);if(_0x36b826===_0x4a77e1[_0x878fbf(0x585)])_0x223a1c[_0x878fbf(0xb17)][_0x878fbf(0x3f4)]('playing');_0x223a1c['innerHTML']=_0x878fbf(0xe1d)+_0x264c7d[_0x878fbf(0x596)]+_0x878fbf(0x2d3)+_0x264c7d[_0x878fbf(0x7af)]+_0x878fbf(0xc6f)+_0x36b826+'\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22'+_0x36b826+_0x878fbf(0x1111)+_0x36b826+'\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22'+_0x36b826+_0x878fbf(0x785),_0x223a1c['querySelector'](_0x878fbf(0xacc))[_0x878fbf(0xae8)](_0x878fbf(0xa17),()=>_0x2e10b2(_0x36b826)),_0xbead3f[_0x878fbf(0x31e)](_0x223a1c);});}async function _0x3801a5(){const _0x1ee741=_0x18b51e;if(_0x3fd13b[_0x1ee741(0xcf5)]){if(_0x4a77e1['currentIndex']===-0x1&&_0x4a77e1['playlist'][_0x1ee741(0x105a)]>0x0)_0x2e10b2(0x0);else _0x4a77e1['currentIndex']>-0x1&&_0x2e10b2(_0x4a77e1[_0x1ee741(0x585)]);}else _0x3fd13b[_0x1ee741(0xf08)](),await _0x5b5f95('暂停了音乐');}function _0x3110d1(){const _0x27b88d=_0x18b51e;if(_0x4a77e1[_0x27b88d(0xcfa)]['length']===0x0)return;let _0x3858ea;switch(_0x4a77e1['playMode']){case _0x27b88d(0x5b3):_0x3858ea=Math[_0x27b88d(0x10b2)](Math['random']()*_0x4a77e1[_0x27b88d(0xcfa)]['length']);break;case _0x27b88d(0xa9b):_0x2e10b2(_0x4a77e1[_0x27b88d(0x585)]);return;case'order':default:_0x3858ea=(_0x4a77e1[_0x27b88d(0x585)]+0x1)%_0x4a77e1[_0x27b88d(0xcfa)]['length'];break;}_0x2e10b2(_0x3858ea);}function _0x1634b6(){const _0x4a9f69=_0x18b51e;if(_0x4a77e1[_0x4a9f69(0xcfa)][_0x4a9f69(0x105a)]===0x0)return;const _0x3d8526=(_0x4a77e1[_0x4a9f69(0x585)]-0x1+_0x4a77e1[_0x4a9f69(0xcfa)][_0x4a9f69(0x105a)])%_0x4a77e1[_0x4a9f69(0xcfa)]['length'];_0x2e10b2(_0x3d8526);}function _0x20970f(){const _0x2543d8=_0x18b51e,_0x26f7c8=[_0x2543d8(0x358),_0x2543d8(0x5b3),_0x2543d8(0xa9b)],_0x3207c0=_0x26f7c8[_0x2543d8(0xbf2)](_0x4a77e1[_0x2543d8(0xeb0)]);_0x4a77e1[_0x2543d8(0xeb0)]=_0x26f7c8[(_0x3207c0+0x1)%_0x26f7c8['length']],document[_0x2543d8(0x8c2)](_0x2543d8(0x63c))[_0x2543d8(0x1090)]={'order':'顺序','random':'随机','single':'单曲'}[_0x4a77e1[_0x2543d8(0xeb0)]];}async function _0x213a7d(){const _0x332009=_0x18b51e,_0x353897=await _0x180f74(_0x332009(0xeb9),_0x332009(0x9fd),'','url');if(!_0x353897)return;const _0x5c9d75=await _0x180f74(_0x332009(0x66d),_0x332009(0x264));if(!_0x5c9d75)return;const _0x28cfc2=await _0x180f74(_0x332009(0x66d),_0x332009(0x550));if(!_0x28cfc2)return;_0x4a77e1[_0x332009(0xcfa)][_0x332009(0xa49)]({'name':_0x5c9d75,'artist':_0x28cfc2,'src':_0x353897,'isLocal':![]}),await _0x2b48e0(),_0x3439d6(),_0x4a77e1[_0x332009(0x585)]===-0x1&&(_0x4a77e1[_0x332009(0x585)]=_0x4a77e1[_0x332009(0xcfa)][_0x332009(0x105a)]-0x1,_0x59d0b7());}async function _0x391a58(_0x2d0d50){const _0x461259=_0x18b51e,_0xe57655=_0x2d0d50[_0x461259(0x475)][_0x461259(0xde8)];if(!_0xe57655[_0x461259(0x105a)])return;for(const _0x175877 of _0xe57655){let _0x224419=_0x175877[_0x461259(0x596)][_0x461259(0x1b7)](/\.[^/.]+$/,'');_0x224419=await _0x180f74(_0x461259(0x66d),_0x461259(0x264),_0x224419);if(_0x224419===null)continue;const _0x3c89a7=await _0x180f74(_0x461259(0x66d),_0x461259(0x550),_0x461259(0xfe1));if(_0x3c89a7===null)continue;const _0x36646b=await _0x175877['arrayBuffer']();let _0x2f66a2='';const _0x59613f=await _0x8b9cb8('导入歌词','要为《'+_0x224419+_0x461259(0xfaf));_0x59613f&&(_0x2f66a2=await _0xd2f4cb()||''),_0x4a77e1[_0x461259(0xcfa)]['push']({'name':_0x224419,'artist':_0x3c89a7,'src':_0x36646b,'fileType':_0x175877[_0x461259(0xde0)],'isLocal':!![],'lrcContent':_0x2f66a2,'cover':_0x461259(0x1be)});}await _0x2b48e0(),_0x3439d6(),_0x4a77e1[_0x461259(0x585)]===-0x1&&_0x4a77e1[_0x461259(0xcfa)][_0x461259(0x105a)]>0x0&&(_0x4a77e1[_0x461259(0x585)]=0x0,_0x59d0b7()),_0x2d0d50[_0x461259(0x475)][_0x461259(0x518)]=null;}async function _0x2e10b2(_0x170db9){const _0x1f1941=_0x18b51e;if(_0x170db9<0x0||_0x170db9>=_0x4a77e1[_0x1f1941(0xcfa)]['length'])return;_0x3fd13b[_0x1f1941(0xf08)](),_0x4a77e1['currentIndex']=_0x170db9;const _0x223d87=_0x4a77e1[_0x1f1941(0xcfa)][_0x170db9],_0x2d1038=_0x405767[_0x1f1941(0x799)][_0x4a77e1['activeChatId']],_0x537cb6=document['getElementById'](_0x1f1941(0x3f8));if(_0x2d1038&&_0x537cb6){_0x537cb6[_0x1f1941(0xca0)]='';const _0x15a97e=_0x2d1038[_0x1f1941(0x1000)]?_0x2d1038[_0x1f1941(0x635)]['find'](_0x2da7ce=>_0x2da7ce['originalName']===_0x223d87[_0x1f1941(0x7af)])?.[_0x1f1941(0x1e1)]||_0x49d2a4:_0x2d1038[_0x1f1941(0x33a)][_0x1f1941(0x44e)]||_0x49d2a4,_0xf44401=_0x2d1038[_0x1f1941(0x33a)]['myAvatar']||_0x49d2a4,_0x38f0a1=document['createElement']('img');_0x38f0a1[_0x1f1941(0x939)]=_0x15a97e,_0x38f0a1[_0x1f1941(0x84c)]=_0x1f1941(0x9e7),_0x38f0a1['alt']=_0x1f1941(0x112f),_0x537cb6[_0x1f1941(0x31e)](_0x38f0a1);const _0x52792a=document[_0x1f1941(0x8c1)]('img');_0x52792a[_0x1f1941(0x939)]=_0xf44401,_0x52792a[_0x1f1941(0x84c)]=_0x1f1941(0x9e7),_0x52792a[_0x1f1941(0xc73)]=_0x1f1941(0x339),_0x537cb6[_0x1f1941(0x31e)](_0x52792a);}const _0x3b1927=document['querySelector'](_0x1f1941(0xb55)),_0xa938ec=document['getElementById'](_0x1f1941(0x4be));_0x3b1927&&(_0x3b1927[_0x1f1941(0x842)][_0x1f1941(0xbe0)](_0x1f1941(0xb09),_0x223d87[_0x1f1941(0x812)]?_0x1f1941(0x116b)+_0x223d87['background']+')':_0x1f1941(0xbf8)),_0x3b1927['classList'][_0x1f1941(0xfc3)]('bg-clear',!!_0x223d87[_0x1f1941(0x641)]));_0xa938ec&&_0xa938ec['classList'][_0x1f1941(0xfc3)]('active',!!_0x223d87[_0x1f1941(0x641)]);document[_0x1f1941(0x8c2)]('music-visual-container')[_0x1f1941(0xb17)][_0x1f1941(0xaff)](_0x1f1941(0xa2c));const _0x25b52b=document[_0x1f1941(0x8c2)](_0x1f1941(0xf48));_0x25b52b&&(_0x25b52b['src']=_0x223d87[_0x1f1941(0xcf0)]||_0x1f1941(0x1be));await _0x5b5f95('将歌曲切换为了《'+_0x223d87[_0x1f1941(0x596)]+'》'),_0x4a77e1[_0x1f1941(0x619)]=_0x584f3f(_0x223d87[_0x1f1941(0xb07)]||''),_0x542c77();const _0x360773=document[_0x1f1941(0x8c2)](_0x1f1941(0xb40));_0x360773&&(!_0x4a77e1[_0x1f1941(0x619)]||_0x4a77e1[_0x1f1941(0x619)]['length']===0x0?_0x360773['textContent']='纯音乐，请欣赏':_0x360773[_0x1f1941(0x1090)]=_0x1f1941(0x2bf));if(_0x223d87[_0x1f1941(0xc6b)]&&_0x223d87[_0x1f1941(0x939)]instanceof ArrayBuffer){const _0x51ac2a=new Blob([_0x223d87[_0x1f1941(0x939)]],{'type':_0x223d87['fileType']||_0x1f1941(0xc3e)});_0x3fd13b[_0x1f1941(0x939)]=URL[_0x1f1941(0x90b)](_0x51ac2a);}else{if(_0x223d87['isLocal']&&_0x223d87[_0x1f1941(0x939)]instanceof Blob)_0x3fd13b[_0x1f1941(0x939)]=URL['createObjectURL'](_0x223d87[_0x1f1941(0x939)]);else{if(!_0x223d87['isLocal'])_0x3fd13b[_0x1f1941(0x939)]=_0x223d87[_0x1f1941(0x939)];else{console[_0x1f1941(0x7a3)]('本地歌曲源错误:',_0x223d87);return;}}}const _0x2b5c77=_0x3fd13b[_0x1f1941(0xf12)]();_0x2b5c77!==undefined&&_0x2b5c77[_0x1f1941(0x120c)](_0x12ab44=>{const _0x3601d3=_0x1f1941;if(_0x12ab44[_0x3601d3(0x596)]===_0x3601d3(0xfcd))console[_0x3601d3(0x112a)](_0x3601d3(0x7d6)),_0x3fd13b['pause'](),_0x501c7b(_0x3601d3(0x62d),'由于浏览器安全限制，AI切换的歌曲无法自动播放。请手动点击播放按钮\x20▶\x20继续欣赏。');else _0x12ab44[_0x3601d3(0x596)]!==_0x3601d3(0x380)&&console[_0x3601d3(0x7a3)]('Playback\x20error:',_0x12ab44);});_0x3439d6(),_0x59d0b7(),_0x265f34();const _0x4187f6=document[_0x1f1941(0x8c2)](_0x1f1941(0x5a6));_0x4a77e1[_0x1f1941(0x619)]&&_0x4a77e1[_0x1f1941(0x619)][_0x1f1941(0x105a)]>0x0?(_0x4187f6[_0x1f1941(0x1090)]='♪',_0x4187f6[_0x1f1941(0xb17)][_0x1f1941(0x3f4)](_0x1f1941(0x2cd))):_0x4187f6[_0x1f1941(0xb17)][_0x1f1941(0xaff)](_0x1f1941(0x2cd));}async function _0x38c179(_0x36acf1){const _0x495e26=_0x18b51e;if(_0x36acf1<0x0||_0x36acf1>=_0x4a77e1[_0x495e26(0xcfa)][_0x495e26(0x105a)])return;const _0x19d8fa=await _0x40fef8(_0x495e26(0x5d1),[{'text':'📁\x20从本地上传','value':_0x495e26(0x6a0)},{'text':'🌐\x20使用网络URL','value':_0x495e26(0x9d6)}]);let _0x1242b3=null;if(_0x19d8fa==='local')_0x1242b3=await _0x434b4d();else _0x19d8fa===_0x495e26(0x9d6)&&(_0x1242b3=await _0x180f74(_0x495e26(0xc24),_0x495e26(0x10b8),'','url'));if(_0x1242b3&&_0x1242b3[_0x495e26(0x8c6)]()){_0x4a77e1[_0x495e26(0xcfa)][_0x36acf1][_0x495e26(0x812)]=_0x1242b3['trim'](),await _0x2b48e0();if(_0x4a77e1[_0x495e26(0x585)]===_0x36acf1){const _0x13b896=document[_0x495e26(0x1ad)]('.music-player-window');_0x13b896['style'][_0x495e26(0xbe0)](_0x495e26(0xb09),_0x495e26(0x116b)+_0x1242b3['trim']()+')');}await _0x501c7b('成功',_0x495e26(0x1161));}}async function _0x52f1d7(_0x14fd69){const _0x2501cd=_0x18b51e;if(_0x14fd69<0x0||_0x14fd69>=_0x4a77e1[_0x2501cd(0xcfa)][_0x2501cd(0x105a)])return;const _0x4cf710=await _0x40fef8(_0x2501cd(0xf7c),[{'text':'📁\x20从本地上传','value':_0x2501cd(0x6a0)},{'text':'🌐\x20使用网络URL','value':_0x2501cd(0x9d6)}]);let _0x1430bb=null;if(_0x4cf710===_0x2501cd(0x6a0))_0x1430bb=await _0x434b4d();else _0x4cf710===_0x2501cd(0x9d6)&&(_0x1430bb=await _0x180f74('输入图片URL',_0x2501cd(0x175),'',_0x2501cd(0x9d6)));if(_0x1430bb&&_0x1430bb[_0x2501cd(0x8c6)]()){_0x4a77e1['playlist'][_0x14fd69][_0x2501cd(0xcf0)]=_0x1430bb[_0x2501cd(0x8c6)](),await _0x2b48e0();if(_0x4a77e1[_0x2501cd(0x585)]===_0x14fd69){document[_0x2501cd(0x8c2)](_0x2501cd(0xf48))['src']=_0x1430bb[_0x2501cd(0x8c6)]();const _0xb52755=document[_0x2501cd(0x1ad)](_0x2501cd(0xb8e));if(_0xb52755)_0xb52755[_0x2501cd(0x939)]=_0x1430bb[_0x2501cd(0x8c6)]();}await _0x501c7b('成功',_0x2501cd(0x15a));}}async function _0x48f800(_0x1c8ad4){const _0x1e555c=_0x18b51e;if(_0x1c8ad4<0x0||_0x1c8ad4>=_0x4a77e1[_0x1e555c(0xcfa)][_0x1e555c(0x105a)])return;const _0x5a8ee3=_0x4a77e1[_0x1e555c(0xcfa)][_0x1c8ad4],_0x576da1=_0x4a77e1[_0x1e555c(0x219)]&&_0x4a77e1[_0x1e555c(0x585)]===_0x1c8ad4;if(_0x5a8ee3['isLocal']&&_0x3fd13b[_0x1e555c(0x939)][_0x1e555c(0xc7c)](_0x1e555c(0xb02))&&_0x4a77e1['currentIndex']===_0x1c8ad4)URL[_0x1e555c(0xb0a)](_0x3fd13b[_0x1e555c(0x939)]);_0x4a77e1['playlist'][_0x1e555c(0x3e6)](_0x1c8ad4,0x1),await _0x2b48e0();if(_0x4a77e1['playlist'][_0x1e555c(0x105a)]===0x0){if(_0x4a77e1[_0x1e555c(0x219)])_0x3fd13b[_0x1e555c(0xf08)]();_0x3fd13b[_0x1e555c(0x939)]='',_0x4a77e1['currentIndex']=-0x1,_0x4a77e1[_0x1e555c(0x219)]=![];}else{if(_0x576da1)_0x3110d1();else{if(_0x4a77e1[_0x1e555c(0x585)]>=_0x1c8ad4)_0x4a77e1['currentIndex']=Math[_0x1e555c(0x171)](0x0,_0x4a77e1['currentIndex']-0x1);}}_0x59d0b7(),_0x3439d6();}async function _0x391a58(_0x11b005){const _0x4c1332=_0x18b51e,_0xb2fc72=_0x11b005[_0x4c1332(0x475)]['files'];if(!_0xb2fc72[_0x4c1332(0x105a)])return;for(const _0xe53063 of _0xb2fc72){let _0x52244f=_0xe53063[_0x4c1332(0x596)]['replace'](/\.[^/.]+$/,'');_0x52244f=await _0x180f74(_0x4c1332(0x66d),_0x4c1332(0x264),_0x52244f);if(_0x52244f===null)continue;const _0x17df09=await _0x180f74(_0x4c1332(0x66d),'请输入歌手名',_0x4c1332(0xfe1));if(_0x17df09===null)continue;let _0x46b05d='';const _0x3facf3=await _0x8b9cb8(_0x4c1332(0x9ff),_0x4c1332(0x624)+_0x52244f+_0x4c1332(0xfaf));_0x3facf3&&(_0x46b05d=await _0xd2f4cb()||''),_0x4a77e1[_0x4c1332(0xcfa)][_0x4c1332(0xa49)]({'name':_0x52244f,'artist':_0x17df09,'src':_0xe53063,'isLocal':!![],'lrcContent':_0x46b05d});}await _0x2b48e0(),_0x3439d6(),_0x4a77e1[_0x4c1332(0x585)]===-0x1&&_0x4a77e1[_0x4c1332(0xcfa)][_0x4c1332(0x105a)]>0x0&&(_0x4a77e1[_0x4c1332(0x585)]=0x0,_0x59d0b7()),_0x11b005[_0x4c1332(0x475)]['value']=null;}async function _0x48f800(_0xc61020){const _0x13d4e5=_0x18b51e;if(_0xc61020<0x0||_0xc61020>=_0x4a77e1[_0x13d4e5(0xcfa)]['length'])return;const _0x103c15=_0x4a77e1[_0x13d4e5(0xcfa)][_0xc61020],_0x5392b3=_0x4a77e1[_0x13d4e5(0x219)]&&_0x4a77e1[_0x13d4e5(0x585)]===_0xc61020;if(_0x103c15[_0x13d4e5(0xc6b)]&&_0x3fd13b[_0x13d4e5(0x939)]['startsWith'](_0x13d4e5(0xb02))&&_0x4a77e1[_0x13d4e5(0x585)]===_0xc61020)URL[_0x13d4e5(0xb0a)](_0x3fd13b['src']);_0x4a77e1[_0x13d4e5(0xcfa)]['splice'](_0xc61020,0x1),await _0x2b48e0();if(_0x4a77e1['playlist'][_0x13d4e5(0x105a)]===0x0){if(_0x4a77e1['isPlaying'])_0x3fd13b[_0x13d4e5(0xf08)]();_0x3fd13b[_0x13d4e5(0x939)]='',_0x4a77e1[_0x13d4e5(0x585)]=-0x1,_0x4a77e1[_0x13d4e5(0x219)]=![];}else{if(_0x5392b3)_0x3110d1();else{if(_0x4a77e1[_0x13d4e5(0x585)]>=_0xc61020)_0x4a77e1[_0x13d4e5(0x585)]=Math[_0x13d4e5(0x171)](0x0,_0x4a77e1['currentIndex']-0x1);}}_0x59d0b7(),_0x3439d6();}const _0x2f4ef4=document[_0x18b51e(0x8c2)](_0x18b51e(0x100c)),_0x41953d=document['getElementById'](_0x18b51e(0xd3c)),_0x464525=document[_0x18b51e(0x8c2)](_0x18b51e(0xfe0));function _0x359910(){const _0x931329=_0x18b51e;_0x24e797(),_0x2f4ef4[_0x931329(0xb17)][_0x931329(0x3f4)](_0x931329(0x2cd));}function _0x11bd20(){const _0x1c2fbb=_0x18b51e;_0x2f4ef4['classList']['remove'](_0x1c2fbb(0x2cd));}function _0x24e797(){const _0x15fbef=_0x18b51e,_0x53a5ca=document[_0x15fbef(0x8c2)](_0x15fbef(0xb95));_0x53a5ca[_0x15fbef(0xca0)]='';if(_0x405767[_0x15fbef(0xaa4)]['length']===0x0){_0x53a5ca['innerHTML']=_0x15fbef(0x9ef);return;}_0x405767[_0x15fbef(0xaa4)][_0x15fbef(0x7c0)](_0x42e12a=>{const _0x519686=_0x15fbef,_0x22e5f0=document[_0x519686(0x8c1)]('div');_0x22e5f0['className']=_0x519686(0xf82),_0x22e5f0[_0x519686(0x842)][_0x519686(0xfff)]=_0x519686(0x116b)+_0x42e12a[_0x519686(0x1e1)]+')',_0x22e5f0[_0x519686(0x323)][_0x519686(0x88f)]=_0x42e12a['id'],_0x22e5f0['addEventListener'](_0x519686(0xa17),()=>_0x2aa881(_0x42e12a['id'])),_0x5dcbd7(_0x22e5f0,()=>_0x5a5d8f(_0x42e12a['id'])),_0x53a5ca[_0x519686(0x31e)](_0x22e5f0);});}function _0x5a5d8f(_0x5d96aa){const _0x512cb4=_0x18b51e;_0x1342a5=_0x5d96aa,_0x464525[_0x512cb4(0xb17)]['add'](_0x512cb4(0x2cd));}function _0x2c686b(){const _0x4164d9=_0x18b51e;_0x464525[_0x4164d9(0xb17)][_0x4164d9(0xaff)](_0x4164d9(0x2cd)),_0x1342a5=null;}function _0x2aa881(_0x2205fe){const _0x5c75a0=_0x18b51e,_0x7dd6db=_0x405767[_0x5c75a0(0xaa4)][_0x5c75a0(0x2ef)](_0x263429=>_0x263429['id']===_0x2205fe);_0x7dd6db&&(document[_0x5c75a0(0x8c2)](_0x5c75a0(0x10ba))['src']=_0x7dd6db['avatar'],document[_0x5c75a0(0x8c2)](_0x5c75a0(0x419))['value']=_0x7dd6db[_0x5c75a0(0x391)]),_0x11bd20();}function _0x2be6f6(){const _0x340b1b=_0x18b51e;_0x1342a5=null,document[_0x340b1b(0x8c2)](_0x340b1b(0xbb1))[_0x340b1b(0x1090)]=_0x340b1b(0xe0c),document['getElementById'](_0x340b1b(0x966))[_0x340b1b(0x939)]=_0x49d2a4,document[_0x340b1b(0x8c2)]('preset-persona-input')[_0x340b1b(0x518)]='',_0x41953d[_0x340b1b(0xb17)]['add'](_0x340b1b(0x2cd));}function _0x20f044(){const _0x233340=_0x18b51e,_0x49138e=_0x405767[_0x233340(0xaa4)]['find'](_0x1ca0b0=>_0x1ca0b0['id']===_0x1342a5);if(!_0x49138e)return;document['getElementById'](_0x233340(0xbb1))[_0x233340(0x1090)]=_0x233340(0x50c),document[_0x233340(0x8c2)](_0x233340(0x966))[_0x233340(0x939)]=_0x49138e[_0x233340(0x1e1)],document['getElementById'](_0x233340(0xd7f))[_0x233340(0x518)]=_0x49138e['persona'],_0x464525[_0x233340(0xb17)][_0x233340(0xaff)](_0x233340(0x2cd)),_0x41953d[_0x233340(0xb17)]['add'](_0x233340(0x2cd));}async function _0x4f581f(){const _0x110e19=_0x18b51e,_0x4619be=await _0x8b9cb8(_0x110e19(0x1c8),_0x110e19(0xe89),{'confirmButtonClass':'btn-danger'});_0x4619be&&_0x1342a5&&(await _0x15043e['personaPresets'][_0x110e19(0x89f)](_0x1342a5),_0x405767[_0x110e19(0xaa4)]=_0x405767[_0x110e19(0xaa4)]['filter'](_0x1e886d=>_0x1e886d['id']!==_0x1342a5),_0x2c686b(),_0x24e797());}function _0x354b50(){const _0x30e23a=_0x18b51e;_0x41953d['classList'][_0x30e23a(0xaff)]('visible'),_0x1342a5=null;}async function _0x339451(){const _0x26d938=_0x18b51e,_0x4c6023=document[_0x26d938(0x8c2)](_0x26d938(0x966))[_0x26d938(0x939)],_0x34fddd=document[_0x26d938(0x8c2)](_0x26d938(0xd7f))['value'][_0x26d938(0x8c6)]();if(_0x4c6023===_0x49d2a4&&!_0x34fddd){alert(_0x26d938(0x9d1));return;}if(_0x1342a5){const _0x5278d7=_0x405767[_0x26d938(0xaa4)][_0x26d938(0x2ef)](_0x43766d=>_0x43766d['id']===_0x1342a5);_0x5278d7&&(_0x5278d7[_0x26d938(0x1e1)]=_0x4c6023,_0x5278d7[_0x26d938(0x391)]=_0x34fddd,await _0x15043e[_0x26d938(0xaa4)][_0x26d938(0xfaa)](_0x5278d7));}else{const _0x375dda={'id':_0x26d938(0x877)+Date[_0x26d938(0x1ed)](),'avatar':_0x4c6023,'persona':_0x34fddd};await _0x15043e['personaPresets'][_0x26d938(0x3f4)](_0x375dda),_0x405767[_0x26d938(0xaa4)][_0x26d938(0xa49)](_0x375dda);}_0x24e797(),_0x354b50();}const _0x123b3d=document[_0x18b51e(0x8c2)]('battery-alert-modal');function _0x9133c2(_0xaa2c49,_0x1764cd){const _0xcef0c0=_0x18b51e;clearTimeout(_0x5596ec),document[_0xcef0c0(0x8c2)](_0xcef0c0(0xc70))[_0xcef0c0(0x939)]=_0xaa2c49,document[_0xcef0c0(0x8c2)](_0xcef0c0(0x495))[_0xcef0c0(0x1090)]=_0x1764cd,_0x123b3d[_0xcef0c0(0xb17)][_0xcef0c0(0x3f4)](_0xcef0c0(0x2cd));const _0x4497a9=()=>{const _0x17ceed=_0xcef0c0;_0x123b3d[_0x17ceed(0xb17)][_0x17ceed(0xaff)](_0x17ceed(0x2cd)),_0x123b3d[_0x17ceed(0x2b2)]('click',_0x4497a9);};_0x123b3d[_0xcef0c0(0xae8)]('click',_0x4497a9),_0x5596ec=setTimeout(_0x4497a9,0x7d0);}function _0x2758cd(_0x5195b5){const _0x2d2be0=_0x18b51e,_0x288603=document[_0x2d2be0(0x8c2)](_0x2d2be0(0x3c7)),_0x562c9a=_0x288603[_0x2d2be0(0x1ad)](_0x2d2be0(0xee6)),_0x2c911d=_0x288603[_0x2d2be0(0x1ad)](_0x2d2be0(0xc53)),_0x457772=Math[_0x2d2be0(0x10b2)](_0x5195b5[_0x2d2be0(0x1c2)]*0x64);_0x562c9a[_0x2d2be0(0x842)][_0x2d2be0(0x578)]=_0x457772+'%',_0x2c911d['textContent']=_0x457772+'%',_0x5195b5[_0x2d2be0(0x57f)]?_0x288603['classList'][_0x2d2be0(0x3f4)]('charging'):_0x288603[_0x2d2be0(0xb17)]['remove'](_0x2d2be0(0x57f));}function _0x31ba5f(_0xed06af){const _0x3d0a5c=_0x18b51e;_0x2758cd(_0xed06af);const _0x131101=_0xed06af['level'];!_0xed06af[_0x3d0a5c(0x57f)]&&(_0x131101<=0.4&&_0x6fc3f5>0.4&&!_0x7de39a[_0x3d0a5c(0x5bf)]&&(_0x9133c2(_0x3d0a5c(0x7c7),_0x3d0a5c(0xaea)),_0x7de39a[_0x3d0a5c(0x5bf)]=!![]),_0x131101<=0.2&&_0x6fc3f5>0.2&&!_0x7de39a[_0x3d0a5c(0x516)]&&(_0x9133c2(_0x3d0a5c(0xcf8),_0x3d0a5c(0xcd6)),_0x7de39a['hasShown20']=!![]),_0x131101<=0.1&&_0x6fc3f5>0.1&&!_0x7de39a[_0x3d0a5c(0x11a9)]&&(_0x9133c2(_0x3d0a5c(0x38c),'已阵亡，还有30秒爆炸'),_0x7de39a[_0x3d0a5c(0x11a9)]=!![]));if(_0x131101>0.4)_0x7de39a['hasShown40']=![];if(_0x131101>0.2)_0x7de39a[_0x3d0a5c(0x516)]=![];if(_0x131101>0.1)_0x7de39a['hasShown10']=![];_0x6fc3f5=_0x131101;}async function _0x131a64(){const _0x5691e8=_0x18b51e;if(_0x5691e8(0x19c)in navigator)try{const _0x3c072b=await navigator[_0x5691e8(0x19c)]();_0x6fc3f5=_0x3c072b[_0x5691e8(0x1c2)],_0x31ba5f(_0x3c072b),_0x3c072b[_0x5691e8(0xae8)](_0x5691e8(0x104e),()=>_0x31ba5f(_0x3c072b)),_0x3c072b[_0x5691e8(0xae8)](_0x5691e8(0x11b6),()=>{const _0x50bb94=_0x5691e8;_0x31ba5f(_0x3c072b),_0x3c072b['charging']&&_0x9133c2(_0x50bb94(0x57a),_0x50bb94(0xd84));});}catch(_0x2f2983){console['error']('无法获取电池信息:',_0x2f2983),document[_0x5691e8(0x1ad)](_0x5691e8(0xc53))[_0x5691e8(0x1090)]=_0x5691e8(0x8d1);}else console[_0x5691e8(0x32b)](_0x5691e8(0x360)),document[_0x5691e8(0x1ad)]('.battery-text')[_0x5691e8(0x1090)]=_0x5691e8(0x8d1);}async function _0x31eada(){const _0x3621f7=_0x18b51e,_0x5918f1=document[_0x3621f7(0x8c2)](_0x3621f7(0xc82));if(!_0x5918f1)return;const _0x3b2ac0=await _0x15043e[_0x3621f7(0x10d1)][_0x3621f7(0x731)]('createdAt')['reverse']()['toArray']();_0x5918f1['innerHTML']='';if(_0x3b2ac0[_0x3621f7(0x105a)]===0x0){_0x5918f1[_0x3621f7(0xca0)]=_0x3621f7(0xfe8);return;}_0x3b2ac0[_0x3621f7(0x7c0)](_0xe3ed7b=>{const _0x4504ff=_0x3621f7,_0x5c138f=document['createElement'](_0x4504ff(0x1072));_0x5c138f['className']=_0x4504ff(0xbc3),_0x5c138f[_0x4504ff(0xca0)]=_0x4504ff(0x7fe)+_0xe3ed7b[_0x4504ff(0xb98)]+_0x4504ff(0xebe)+_0xe3ed7b[_0x4504ff(0x596)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>'+(_0xe3ed7b[_0x4504ff(0x695)]||0x0)+_0x4504ff(0x6fa),_0x5c138f['addEventListener']('click',()=>{_0x39b6b1(_0xe3ed7b['id']);}),_0x5dcbd7(_0x5c138f,async()=>{const _0x5e140b=_0x4504ff,_0x1322fa=await _0x8b9cb8(_0x5e140b(0x5c9),_0x5e140b(0xa6c)+_0xe3ed7b[_0x5e140b(0x596)]+_0x5e140b(0x7f2),{'confirmButtonClass':_0x5e140b(0xe2a)});_0x1322fa&&(await _0x15043e[_0x5e140b(0xbed)][_0x5e140b(0xdb8)]('albumId')['equals'](_0xe3ed7b['id'])[_0x5e140b(0x89f)](),await _0x15043e[_0x5e140b(0x10d1)][_0x5e140b(0x89f)](_0xe3ed7b['id']),await _0x31eada(),alert(_0x5e140b(0x3f2)));}),_0x5918f1['appendChild'](_0x5c138f);});}async function _0x39b6b1(_0x322066){const _0x548478=_0x18b51e;_0x405767[_0x548478(0x6bc)]=_0x322066,await _0x3f7ddf(),_0x3d1990(_0x548478(0x20d));}async function _0x3f7ddf(){const _0x52d964=_0x18b51e;if(!_0x405767[_0x52d964(0x6bc)])return;const _0x9e109b=document[_0x52d964(0x8c2)](_0x52d964(0x1071)),_0x20c65d=document[_0x52d964(0x8c2)](_0x52d964(0xe69)),_0x297b65=await _0x15043e[_0x52d964(0x10d1)][_0x52d964(0x3e9)](_0x405767[_0x52d964(0x6bc)]);if(!_0x297b65){console['error'](_0x52d964(0xfe5),_0x405767['activeAlbumId']),_0x3d1990(_0x52d964(0x488));return;}_0x20c65d[_0x52d964(0x1090)]=_0x297b65[_0x52d964(0x596)];const _0x407c33=await _0x15043e[_0x52d964(0xbed)]['where'](_0x52d964(0x10d5))['equals'](_0x405767[_0x52d964(0x6bc)])[_0x52d964(0x6be)]();_0x9e109b[_0x52d964(0xca0)]='',_0x407c33['length']===0x0?_0x9e109b[_0x52d964(0xca0)]=_0x52d964(0x4b8):_0x407c33[_0x52d964(0x7c0)](_0x242f8c=>{const _0x154424=_0x52d964,_0x37baa0=document[_0x154424(0x8c1)]('div');_0x37baa0[_0x154424(0x84c)]=_0x154424(0xbd8),_0x37baa0[_0x154424(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x242f8c[_0x154424(0x9d6)]+_0x154424(0xa00)+_0x242f8c['id']+'\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x9e109b[_0x154424(0x31e)](_0x37baa0);});}async function _0x30d881(_0x52c8a7){const _0x54b716=_0x18b51e;if(!_0x405767[_0x54b716(0x6bc)])return;const _0x1aa326=await _0x15043e['qzonePhotos']['where']('albumId')[_0x54b716(0xc9a)](_0x405767['activeAlbumId'])[_0x54b716(0x6be)]();_0x41f39d[_0x54b716(0xb8a)]=_0x1aa326[_0x54b716(0x6b9)](_0x21ccc1=>_0x21ccc1[_0x54b716(0x9d6)]),_0x41f39d[_0x54b716(0x585)]=_0x41f39d['photos'][_0x54b716(0x1149)](_0x19ca4c=>_0x19ca4c===_0x52c8a7);if(_0x41f39d[_0x54b716(0x585)]===-0x1)return;document[_0x54b716(0x8c2)](_0x54b716(0x1098))['classList'][_0x54b716(0x3f4)](_0x54b716(0x2cd)),_0x4c0151(),_0x41f39d['isOpen']=!![];}function _0x4c0151(){const _0x505ba2=_0x18b51e;if(_0x41f39d[_0x505ba2(0x585)]===-0x1)return;const _0x24a6b9=document['getElementById'](_0x505ba2(0xa60)),_0x37ecd5=document['getElementById']('photo-viewer-prev-btn'),_0x5285f=document['getElementById']('photo-viewer-next-btn');_0x24a6b9[_0x505ba2(0x842)][_0x505ba2(0x9d7)]=0x0,setTimeout(()=>{const _0x2e4410=_0x505ba2;_0x24a6b9['src']=_0x41f39d['photos'][_0x41f39d[_0x2e4410(0x585)]],_0x24a6b9[_0x2e4410(0x842)][_0x2e4410(0x9d7)]=0x1;},0x64),_0x37ecd5['disabled']=_0x41f39d[_0x505ba2(0x585)]===0x0,_0x5285f[_0x505ba2(0x1033)]=_0x41f39d[_0x505ba2(0x585)]===_0x41f39d[_0x505ba2(0xb8a)]['length']-0x1;}function _0x1a57a2(){const _0x573743=_0x18b51e;_0x41f39d[_0x573743(0x585)]<_0x41f39d[_0x573743(0xb8a)][_0x573743(0x105a)]-0x1&&(_0x41f39d[_0x573743(0x585)]++,_0x4c0151());}function _0x50d088(){const _0x445593=_0x18b51e;_0x41f39d[_0x445593(0x585)]>0x0&&(_0x41f39d['currentIndex']--,_0x4c0151());}function _0x275b23(){const _0x56ec18=_0x18b51e;document[_0x56ec18(0x8c2)](_0x56ec18(0x1098))[_0x56ec18(0xb17)][_0x56ec18(0xaff)]('visible'),_0x41f39d[_0x56ec18(0x356)]=![],_0x41f39d[_0x56ec18(0xb8a)]=[],_0x41f39d[_0x56ec18(0x585)]=-0x1,document[_0x56ec18(0x8c2)](_0x56ec18(0xa60))[_0x56ec18(0x939)]='';}function _0x156368(_0x404e6c){const _0x1757dd=_0x18b51e;_0x38d2a9=_0x404e6c,localStorage[_0x1757dd(0x277)]('unreadPostsCount',_0x404e6c);const _0x209585=document[_0x1757dd(0x1ad)](_0x1757dd(0x508)),_0x5b93a0=_0x209585[_0x1757dd(0x1ad)]('span');let _0x2c053f=_0x209585[_0x1757dd(0x1ad)](_0x1757dd(0xdf4));_0x404e6c>0x0?(!_0x2c053f&&(_0x2c053f=document['createElement']('span'),_0x2c053f[_0x1757dd(0x84c)]=_0x1757dd(0xc18),_0x5b93a0[_0x1757dd(0x842)][_0x1757dd(0x364)]=_0x1757dd(0xeab),_0x5b93a0[_0x1757dd(0x31e)](_0x2c053f)),_0x2c053f[_0x1757dd(0x1090)]=_0x404e6c>0x63?'99+':_0x404e6c,_0x2c053f[_0x1757dd(0x842)]['display']=_0x1757dd(0xea7)):_0x2c053f&&(_0x2c053f[_0x1757dd(0x842)]['display']='none'),_0xedf06();}function _0x1af605(){const _0x3c9597=_0x18b51e;if(_0x57a066)return;const _0x2d80bb=_0x405767[_0x3c9597(0xb73)][_0x3c9597(0x945)]||0x3c;_0x57a066=setInterval(_0x107299,_0x2d80bb*0x3e8),_0x39230f();}function _0x50f373(){_0x57a066&&(clearInterval(_0x57a066),_0x57a066=null),_0x5c79b7();}async function _0x107299(){const _0x4d5a08=_0x18b51e;console['log'](_0x4d5a08(0x998));if(!_0x405767[_0x4d5a08(0xb73)]['enableBackgroundActivity']){_0x50f373();return;}const _0x3e7dbb=Object['values'](_0x405767[_0x4d5a08(0x799)])[_0x4d5a08(0x1d8)](_0x2fa43f=>!_0x2fa43f[_0x4d5a08(0x1000)]);_0x3e7dbb[_0x4d5a08(0x7c0)](_0x151538=>{const _0x13415d=_0x4d5a08;if(_0x151538[_0x13415d(0x944)]?.[_0x13415d(0x8c8)]===_0x13415d(0x1e6)){const _0x2523e8=_0x151538['relationship'][_0x13415d(0x42a)];if(!_0x2523e8)return;const _0x539188=Date['now']()-_0x2523e8,_0x3a8cde=(_0x405767[_0x13415d(0xb73)][_0x13415d(0x11a1)]||0x1)*0x3c*0x3c*0x3e8;_0x539188>_0x3a8cde&&(_0x151538['relationship'][_0x13415d(0x8c8)]=_0x13415d(0xf58),_0x50ee11(_0x151538['id']));}else{if(_0x151538[_0x13415d(0x944)]?.[_0x13415d(0x8c8)]===_0x13415d(0xaa7)&&_0x151538['id']!==_0x405767[_0x13415d(0x248)]){if(_0x151538[_0x13415d(0x33a)]['enableBackgroundActivity']===![]){console[_0x13415d(0x32b)](_0x13415d(0x10a8)+_0x151538['name']+'\x22\x20的独立后台活动开关已关闭，本次跳过。');return;}Math['random']()<0.2&&(console[_0x13415d(0x32b)]('角色\x20\x22'+_0x151538[_0x13415d(0x596)]+_0x13415d(0x920)),_0x197f43(_0x151538['id']));}}});const _0x590d45=Object['values'](_0x405767[_0x4d5a08(0x799)])[_0x4d5a08(0x1d8)](_0x4f7893=>_0x4f7893[_0x4d5a08(0x1000)]);_0x590d45[_0x4d5a08(0x7c0)](_0xf0b12=>{const _0x4f8f41=_0x4d5a08;if(_0xf0b12[_0x4f8f41(0x33a)]['enableBackgroundActivity']===![]){console[_0x4f8f41(0x32b)](_0x4f8f41(0x62f)+_0xf0b12[_0x4f8f41(0x596)]+_0x4f8f41(0x213));return;}_0xf0b12['id']!==_0x405767[_0x4f8f41(0x248)]&&Math['random']()<0.1&&(console['log'](_0x4f8f41(0x62f)+_0xf0b12['name']+_0x4f8f41(0x920)),_0x5ab933(_0xf0b12['id']));});try{const _0x5309d4=await _0x15043e[_0x4d5a08(0xa4a)][_0x4d5a08(0x6be)]();if(_0x5309d4['length']===0x0)return;const _0x2b0b45=await _0x15043e[_0x4d5a08(0xcc0)]['orderBy']('timestamp')[_0x4d5a08(0x1c0)]()[_0x4d5a08(0x8e0)](0xa)[_0x4d5a08(0x6be)]();for(const _0x551a50 of _0x5309d4){if(_0x551a50[_0x4d5a08(0x105d)]===![])continue;const _0x33668e=_0x551a50['actionCooldownMinutes']||0xf;if(_0x551a50[_0x4d5a08(0x6c9)]){const _0x1c073b=(Date[_0x4d5a08(0x1ed)]()-_0x551a50[_0x4d5a08(0x6c9)])/(0x3e8*0x3c);if(_0x1c073b<_0x33668e)continue;}if(Math['random']()>0.3)continue;const _0x478d6e=[];for(const _0x2f9ee0 of _0x2b0b45){if(_0x2f9ee0[_0x4d5a08(0x802)]===_0x4d5a08(0x5ea)+_0x551a50['id'])continue;const _0x473313=_0x2f9ee0[_0x4d5a08(0x93c)]?.[_0x4d5a08(0xdc3)](_0x2edc87=>_0x2edc87[_0x4d5a08(0x176)]===_0x551a50[_0x4d5a08(0x596)]),_0x251d39=_0x2f9ee0['comments']?.[_0x4d5a08(0x961)](-0x1)[0x0]?.[_0x4d5a08(0x110f)];if(_0x251d39===_0x551a50['name'])continue;let _0x29bc6b=![];if(_0x2f9ee0[_0x4d5a08(0x802)]===_0x4d5a08(0x74b)||_0x2f9ee0[_0x4d5a08(0x802)][_0x4d5a08(0xc7c)]('chat_'))_0x551a50['associatedWith'][_0x4d5a08(0x773)](_0x2f9ee0['authorId'])&&(_0x29bc6b=!![]);else{if(_0x2f9ee0['authorId'][_0x4d5a08(0xc7c)](_0x4d5a08(0x5ea))){const _0x952100=parseInt(_0x2f9ee0[_0x4d5a08(0x802)][_0x4d5a08(0x1b7)](_0x4d5a08(0x5ea),'')),_0x38aa88=await _0x15043e[_0x4d5a08(0xa4a)][_0x4d5a08(0x3e9)](_0x952100);if(_0x38aa88&&_0x38aa88[_0x4d5a08(0xc9d)]){const _0x4cd802=_0x551a50['associatedWith'][_0x4d5a08(0x1d8)](_0x26a7ca=>_0x38aa88['associatedWith']['includes'](_0x26a7ca));_0x4cd802[_0x4d5a08(0x105a)]>0x0&&(_0x29bc6b=!![]);}}}(_0x29bc6b||_0x473313)&&_0x478d6e[_0x4d5a08(0xa49)](_0x2f9ee0);}if(_0x478d6e[_0x4d5a08(0x105a)]>0x0||Math[_0x4d5a08(0x5b3)]()<0.2){console[_0x4d5a08(0x32b)](_0x4d5a08(0x68a)+_0x551a50[_0x4d5a08(0x596)]+_0x4d5a08(0x5d3));const _0x599df6=await _0xcb0f20(_0x551a50,_0x478d6e);if(_0x599df6&&_0x599df6[_0x4d5a08(0x105a)]>0x0){for(const _0x55f370 of _0x599df6){if(_0x55f370[_0x4d5a08(0xde0)]==='qzone_comment'){const _0x413175=await _0x15043e[_0x4d5a08(0xcc0)][_0x4d5a08(0x3e9)](_0x55f370[_0x4d5a08(0x5f9)]);if(_0x413175){if(!_0x413175[_0x4d5a08(0x93c)])_0x413175['comments']=[];_0x413175['comments'][_0x4d5a08(0xa49)]({'commenterName':_0x551a50[_0x4d5a08(0x596)],'text':_0x55f370[_0x4d5a08(0x238)],'replyTo':_0x55f370[_0x4d5a08(0x176)]||null,'timestamp':Date['now']()+Math[_0x4d5a08(0x5b3)]()}),await _0x15043e[_0x4d5a08(0xcc0)][_0x4d5a08(0xb7c)](_0x55f370[_0x4d5a08(0x5f9)],{'comments':_0x413175['comments']}),_0x156368(_0x38d2a9+0x1);}}else{if(_0x55f370['type']===_0x4d5a08(0x80e)){const _0x2ba9f7={'type':_0x55f370['postType']||_0x4d5a08(0x11ce),'content':_0x55f370[_0x4d5a08(0x168)],'timestamp':Date[_0x4d5a08(0x1ed)](),'authorId':_0x4d5a08(0x5ea)+_0x551a50['id'],'authorOriginalName':_0x551a50[_0x4d5a08(0x596)],'visibleTo':_0x551a50[_0x4d5a08(0xc9d)],'likes':[],'comments':[],'isDeleted':![]};await _0x15043e[_0x4d5a08(0xcc0)][_0x4d5a08(0x3f4)](_0x2ba9f7),console[_0x4d5a08(0x32b)]('NPC\x20\x22'+_0x551a50['name']+_0x4d5a08(0xa1e)),_0x156368(_0x38d2a9+0x1);}}}await _0x15043e[_0x4d5a08(0xa4a)][_0x4d5a08(0xb7c)](_0x551a50['id'],{'lastActionTimestamp':Date[_0x4d5a08(0x1ed)]()}),document['getElementById']('qzone-screen')[_0x4d5a08(0xb17)][_0x4d5a08(0x795)](_0x4d5a08(0x71b))&&await _0xa34c48();}}}}catch(_0x571931){console[_0x4d5a08(0x7a3)]('处理NPC后台活动时出错:',_0x571931);}}async function _0xcb0f20(_0x368b7d,_0x4de782){const _0x434192=_0x18b51e,{proxyUrl:_0x375e2f,apiKey:_0x589867,model:_0x11ae97}=_0x405767['apiConfig'];if(!_0x375e2f||!_0x589867||!_0x11ae97)return console[_0x434192(0x7a3)]('NPC行动失败：API未配置。'),null;let _0x1bde1e=_0x434192(0x116f);const _0x3f1e3c=_0x405767['qzoneSettings'][_0x434192(0xab3)]||'我',_0x1c67fc=_0x405767[_0x434192(0x799)][Object[_0x434192(0xbda)](_0x405767['chats'])[0x0]]?.['settings'][_0x434192(0xbe8)]||_0x434192(0x496);_0x1bde1e+='-\x20**'+_0x3f1e3c+_0x434192(0xe30)+_0x1c67fc+'\x0a';_0x368b7d[_0x434192(0xc9d)]&&_0x368b7d[_0x434192(0xc9d)][_0x434192(0x105a)]>0x0&&_0x368b7d[_0x434192(0xc9d)][_0x434192(0x7c0)](_0x5764e9=>{const _0x3fc65b=_0x434192,_0x208250=_0x405767[_0x3fc65b(0x799)][_0x5764e9];_0x208250&&!_0x208250[_0x3fc65b(0x1000)]&&(_0x1bde1e+=_0x3fc65b(0xc39)+_0x208250[_0x3fc65b(0x596)]+_0x3fc65b(0x5e8)+_0x208250[_0x3fc65b(0x4e7)]+_0x3fc65b(0x426)+_0x208250[_0x3fc65b(0x33a)][_0x3fc65b(0x1060)]+'\x0a');});const _0x42df04=(await Promise['all'](_0x4de782['map'](async _0x40447a=>{const _0x53f44f=_0x434192;let _0x590306=_0x53f44f(0x7fd);if(_0x40447a[_0x53f44f(0x802)]===_0x53f44f(0x74b))_0x590306=_0x405767[_0x53f44f(0x20a)][_0x53f44f(0xab3)]||'用户';else{if(_0x40447a[_0x53f44f(0x802)][_0x53f44f(0xc7c)](_0x53f44f(0xaf3)))_0x590306=_0x4846a6(_0x40447a[_0x53f44f(0x10ec)]||_0x40447a[_0x53f44f(0x802)]);else{if(_0x40447a[_0x53f44f(0x802)][_0x53f44f(0xc7c)]('npc_')){const _0x30008a=parseInt(_0x40447a[_0x53f44f(0x802)][_0x53f44f(0x1b7)](_0x53f44f(0x5ea),'')),_0x4a6310=await _0x15043e[_0x53f44f(0xa4a)][_0x53f44f(0x3e9)](_0x30008a);_0x4a6310&&(_0x590306=_0x4a6310[_0x53f44f(0x596)]);}}}const _0x277ebb=(_0x40447a[_0x53f44f(0x93c)]||[])[_0x53f44f(0x6b9)](_0x493c97=>{const _0x1f5bab=_0x53f44f;if(typeof _0x493c97===_0x1f5bab(0x7a5)&&_0x493c97[_0x1f5bab(0x110f)]){const _0x1dcc76=_0x4846a6(_0x493c97[_0x1f5bab(0x110f)]);return _0x1f5bab(0xc39)+_0x1dcc76+_0x1f5bab(0xca5)+_0x493c97[_0x1f5bab(0xbc6)];}return'-\x20'+_0x493c97;})[_0x53f44f(0xb2c)]('\x0a');return _0x53f44f(0xd62)+_0x40447a['id']+'\x0a-\x20**作者**:\x20'+_0x590306+_0x53f44f(0xd3d)+(_0x40447a['content']||_0x40447a[_0x53f44f(0x55d)]||'')['substring'](0x0,0x96)+'...\x0a-\x20**已有评论**:\x0a'+(_0x277ebb||_0x53f44f(0x1096))+_0x53f44f(0x57e);})))[_0x434192(0xb2c)]('\x0a'),_0x280602='npc_'+_0x368b7d['id'],_0x2a9f70=Date[_0x434192(0x1ed)]()-0xc*0x3c*0x3c*0x3e8,_0x1858d2=await _0x15043e[_0x434192(0xcc0)][_0x434192(0xdb8)](_0x434192(0x802))[_0x434192(0xc9a)](_0x280602)[_0x434192(0x1bc)](_0x57f285=>_0x57f285[_0x434192(0x351)]>_0x2a9f70)[_0x434192(0x6be)]();let _0x59c789='';_0x1858d2[_0x434192(0x105a)]>0x0&&(_0x59c789=_0x434192(0x55c));const _0x1798d6='\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“'+_0x368b7d[_0x434192(0x596)]+_0x434192(0x991)+_0x59c789+_0x434192(0x21f)+_0x368b7d['name']+_0x434192(0xf6a)+_0x368b7d[_0x434192(0x391)]+'\x0a\x0a'+_0x1bde1e+'\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a'+_0x42df04+'\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。';try{const _0x304fbb=[{'role':'user','content':_0x434192(0x9c7)}];let _0xe1fb16=_0x375e2f[_0x434192(0x773)](_0x434192(0x3fe)),_0x3b9ca3=_0x282b7e(_0x11ae97,_0x589867,_0x1798d6,_0x304fbb);const _0x586df9=_0xe1fb16?await fetch(_0x3b9ca3['url'],_0x3b9ca3['data']):await fetch(_0x375e2f+_0x434192(0x5c1),{'method':'POST','headers':{'Content-Type':_0x434192(0xcb6),'Authorization':'Bearer\x20'+_0x589867},'body':JSON['stringify']({'model':_0x11ae97,'messages':[{'role':'system','content':_0x1798d6},..._0x304fbb],'temperature':_0x405767[_0x434192(0xb73)][_0x434192(0x8c7)]||0.9})});if(!_0x586df9['ok'])throw new Error('API\x20错误:\x20'+_0x586df9[_0x434192(0xd05)]);const _0x5992c6=await _0x586df9[_0x434192(0x7e9)](),_0x13ae2f=getGeminiResponseText(_0x5992c6),_0xc98dbd=_0x13ae2f[_0x434192(0xdf8)](/(\[[\s\S]*\])/);if(!_0xc98dbd)throw new Error('AI返回的行动中未找到有效的JSON数组。');return JSON[_0x434192(0x10ab)](_0xc98dbd[0x0]);}catch(_0x3f9baf){return console[_0x434192(0x7a3)](_0x434192(0xd96)+_0x368b7d[_0x434192(0x596)]+_0x434192(0x105b),_0x3f9baf),null;}}async function _0x197f43(_0x427513){const _0x1a7e46=_0x18b51e,_0x5480e7=_0x405767[_0x1a7e46(0x799)][_0x427513];if(!_0x5480e7)return;const _0x3b0030=_0x5480e7[_0x1a7e46(0x33a)][_0x1a7e46(0x107e)]||0xa;if(_0x5480e7[_0x1a7e46(0x6c9)]){const _0x39e8f3=(Date[_0x1a7e46(0x1ed)]()-_0x5480e7[_0x1a7e46(0x6c9)])/(0x3e8*0x3c);if(_0x39e8f3<_0x3b0030){console[_0x1a7e46(0x32b)](_0x1a7e46(0x10a8)+_0x5480e7[_0x1a7e46(0x596)]+'\x22\x20处于行动冷却中\x20(还剩\x20'+Math[_0x1a7e46(0x5d7)](_0x3b0030-_0x39e8f3)+'\x20分钟)，本次独立行动跳过。');return;}}_0x24fb6c(_0x427513,!![]);const {proxyUrl:_0x448b21,apiKey:_0x4a9871,model:_0x21271e}=_0x405767[_0x1a7e46(0x9e0)];if(!_0x448b21||!_0x4a9871||!_0x21271e)return;const _0x10bc8f=_0x405767[_0x1a7e46(0x20a)][_0x1a7e46(0xab3)],_0x58f662=new Date(),_0x54e19e=_0x5480e7[_0x1a7e46(0x33a)][_0x1a7e46(0xd68)]||'Asia/Shanghai',_0x471fcf=_0x58f662[_0x1a7e46(0x2e8)](_0x1a7e46(0x73e),{'timeZone':_0x54e19e,'dateStyle':_0x1a7e46(0x196),'timeStyle':_0x1a7e46(0xd9b)}),_0x1d999f=new Date(_0x58f662[_0x1a7e46(0x2e8)](_0x1a7e46(0x85a),{'timeZone':_0x54e19e}));let _0x178cc2='',_0x1db48a='',_0x40da66,_0x3657b2=![];const _0x6f50d5=_0x5480e7[_0x1a7e46(0x33a)][_0x1a7e46(0x808)]||0xa,_0x5b83e1=_0x5480e7['history'][_0x1a7e46(0x1d8)](_0x114f6a=>!_0x114f6a[_0x1a7e46(0x3f1)])['slice'](-_0x6f50d5),_0x61324a=_0x5480e7['history']['filter'](_0x5ec621=>!_0x5ec621['isHidden'])[_0x1a7e46(0x961)](-0x1)[0x0];if(_0x5480e7[_0x1a7e46(0x33a)][_0x1a7e46(0xe87)]){_0x178cc2=_0x1a88fc(_0x1d999f);const _0x477cc2=_0x5480e7[_0x1a7e46(0xd39)][_0x1a7e46(0x1d8)](_0x5a242e=>!_0x5a242e[_0x1a7e46(0x3f1)])[_0x1a7e46(0x961)](-0x1)[0x0],_0xb3b3fe=new Date();let _0x49e611='',_0x29598b=![];if(_0x477cc2){const _0x3f0815=new Date(_0x477cc2[_0x1a7e46(0x351)]),_0x4e1566=(_0xb3b3fe-_0x3f0815)/(0x3e8*0x3c*0x3c);if(_0x4e1566>0xc){_0x29598b=!![];const _0x2ffa03=Math[_0x1a7e46(0x10b2)](_0x4e1566/0x18);_0x49e611=_0x1a7e46(0x1127)+(_0x2ffa03>0x0?_0x2ffa03+'天':Math[_0x1a7e46(0x10b2)](_0x4e1566)+'小时')+_0x1a7e46(0x249);}else{const _0x43c6d0=Math[_0x1a7e46(0x10b2)](_0x4e1566*0x3c);if(_0x43c6d0<0x5)_0x49e611='你们的对话刚刚还在继续。';else _0x43c6d0<0x3c?_0x49e611=_0x1a7e46(0x11cd)+_0x43c6d0+_0x1a7e46(0x564):_0x49e611=_0x1a7e46(0x11cd)+Math['floor'](_0x4e1566)+_0x1a7e46(0x87f);}}else _0x29598b=!![],_0x49e611='这是你们的第一次互动。';let _0x3b2db4=_0x1a7e46(0xbfe);_0x5b83e1[_0x1a7e46(0x105a)]>0x0&&(_0x3b2db4=_0x1a7e46(0x670)+_0x5b83e1[_0x1a7e46(0x6b9)](_0x3c0cc9=>{const _0x5989ab=_0x1a7e46,_0x1d0ed0=_0x3c0cc9[_0x5989ab(0x14a)]===_0x5989ab(0x74b)?_0x10bc8f:_0x5480e7[_0x5989ab(0x596)];return _0x1d0ed0+':\x20'+String(_0x3c0cc9[_0x5989ab(0x168)])[_0x5989ab(0x599)](0x0,0x32)+_0x5989ab(0x388);})['join']('\x0a')),_0x29598b?_0x40da66=_0x1a7e46(0xbc4)+_0x49e611+_0x1a7e46(0x68e)+_0x471fcf+_0x1a7e46(0x700)+_0x3b2db4:_0x40da66=''+_0x3b2db4;}else _0x5b83e1[_0x1a7e46(0x105a)]>0x0?_0x40da66=_0x1a7e46(0x670)+_0x5b83e1['map'](_0x597bf6=>{const _0x214b4d=_0x1a7e46,_0x140cc4=_0x597bf6[_0x214b4d(0x14a)]==='user'?_0x10bc8f:_0x5480e7[_0x214b4d(0x596)];return _0x140cc4+':\x20'+String(_0x597bf6[_0x214b4d(0x168)])[_0x214b4d(0x599)](0x0,0x32)+'...';})[_0x1a7e46(0xb2c)]('\x0a'):_0x40da66=_0x1a7e46(0xbfe);const _0x1f7244=await _0x15043e[_0x1a7e46(0xcc0)][_0x1a7e46(0x731)]('timestamp')['reverse']()[_0x1a7e46(0x8e0)](0x5)[_0x1a7e46(0x6be)](),_0x59a46f=_0x12538d(_0x1f7244,_0x5480e7),_0x2c8d55=_0x59a46f['filter'](_0x4c7fd7=>_0x4c7fd7['authorId']===_0x427513);let _0xcfecdf='';_0x2c8d55[_0x1a7e46(0x105a)]>0x0&&(_0xcfecdf='\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a',_0x2c8d55[_0x1a7e46(0x7c0)](_0x49cb8e=>{const _0x29d78e=_0x1a7e46;let _0x4dcde6=(_0x49cb8e['publicText']||_0x49cb8e[_0x29d78e(0x168)]||_0x29d78e(0xcd2))[_0x29d78e(0x599)](0x0,0x28)+_0x29d78e(0x388);_0xcfecdf+='-\x20(ID:\x20'+_0x49cb8e['id']+_0x29d78e(0x276)+_0x4dcde6+'\x22\x0a';}));let _0xfa1d16=[];_0x59a46f[_0x1a7e46(0x105a)]>0x0&&(_0xfa1d16=_0x59a46f[_0x1a7e46(0x6b9)](_0x2f9695=>{const _0x2693f1=_0x1a7e46;let _0x760d2;if(_0x2f9695[_0x2693f1(0xde0)]===_0x2693f1(0xe36))_0x760d2=('[一张图片，其隐藏文字为：“'+_0x2f9695[_0x2693f1(0x9eb)]+'”]\x20'+(_0x2f9695['publicText']||''))[_0x2693f1(0x599)](0x0,0x32)+'...';else _0x2f9695[_0x2693f1(0xde0)]===_0x2693f1(0x7b5)?_0x760d2=(_0x2693f1(0x304)+_0x2f9695[_0x2693f1(0x845)]+_0x2693f1(0x1202)+(_0x2f9695['publicText']||''))[_0x2693f1(0x599)](0x0,0x32)+_0x2693f1(0x388):_0x760d2=String(_0x2f9695[_0x2693f1(0x55d)]||_0x2f9695[_0x2693f1(0x168)]||_0x2693f1(0xcd2))[_0x2693f1(0x599)](0x0,0x32)+_0x2693f1(0x388);return _0x2693f1(0x3a7)+_0x760d2+'\x22';}));let _0x190e63='';_0xfa1d16[_0x1a7e46(0x105a)]>0x0&&(_0x190e63=_0x1a7e46(0x222)+_0xfa1d16['join']('\x0a')+_0x1a7e46(0x1022));let _0x384c8e='';if(_0x5480e7[_0x1a7e46(0x33a)][_0x1a7e46(0xb77)]&&_0x5480e7[_0x1a7e46(0x33a)]['linkedWorldBookIds'][_0x1a7e46(0x105a)]>0x0){const _0x4b0f34=_0x5480e7[_0x1a7e46(0x33a)][_0x1a7e46(0xb77)][_0x1a7e46(0x6b9)](_0x34dd35=>{const _0x4143d1=_0x1a7e46,_0x2c1263=_0x405767[_0x4143d1(0x40e)][_0x4143d1(0x2ef)](_0x4a3cf9=>_0x4a3cf9['id']===_0x34dd35);if(!_0x2c1263||!Array['isArray'](_0x2c1263['content']))return'';const _0x41c8bc=_0x2c1263[_0x4143d1(0x168)]['filter'](_0x2056f5=>_0x2056f5[_0x4143d1(0x69a)]!==![])[_0x4143d1(0x6b9)](_0x212ecf=>{const _0x13d29a=_0x4143d1;let _0x173b31=_0x13d29a(0xf8d)+(_0x212ecf['comment']||'无备注')+'\x0a';return _0x212ecf[_0x13d29a(0xbda)]['length']>0x0&&(_0x173b31+='**关键词:**\x20'+_0x212ecf[_0x13d29a(0xbda)][_0x13d29a(0xb2c)](',\x20')+'\x0a'),_0x173b31+='**内容:**\x0a'+_0x212ecf[_0x13d29a(0x168)],_0x173b31;})[_0x4143d1(0xb2c)]('');return _0x41c8bc?_0x4143d1(0x15d)+_0x2c1263['name']+'\x0a'+_0x41c8bc:'';})[_0x1a7e46(0x1d8)](Boolean)[_0x1a7e46(0xb2c)]('');_0x4b0f34&&(_0x384c8e=_0x1a7e46(0xcee)+_0x4b0f34+_0x1a7e46(0x836));}let _0x261676='';const _0x1a48f5=_0x5480e7[_0x1a7e46(0x33a)][_0x1a7e46(0x57d)]||0xa;if(_0x5480e7[_0x1a7e46(0x33a)][_0x1a7e46(0xb6e)]&&_0x5480e7['settings'][_0x1a7e46(0xb6e)][_0x1a7e46(0x105a)]>0x0){const _0x66ad23=_0x5480e7[_0x1a7e46(0x33a)]['linkedMemoryChatIds'][_0x1a7e46(0x6b9)](_0x8c12d7=>{const _0x5267c7=_0x1a7e46,_0x54b336=_0x405767[_0x5267c7(0x799)][_0x8c12d7];if(!_0x54b336)return null;const _0x56e2fc=_0x54b336[_0x5267c7(0xd39)][_0x5267c7(0x961)](-0x1)[0x0];return{'chat':_0x54b336,'latestTimestamp':_0x56e2fc?_0x56e2fc[_0x5267c7(0x351)]:0x0};})['filter'](Boolean);_0x66ad23['sort']((_0x44ef2d,_0x19243f)=>_0x19243f[_0x1a7e46(0x11aa)]-_0x44ef2d[_0x1a7e46(0x11aa)]),_0x261676+=_0x1a7e46(0xa50);for(const _0x204036 of _0x66ad23){const _0xaa7458=_0x204036['chat'],_0x3062ea=_0xaa7458[_0x1a7e46(0x1000)]?_0x1a7e46(0xe4f):'[私聊]',_0x742adb=_0x204036[_0x1a7e46(0x11aa)]>0x0?_0x1a7e46(0xd7c)+_0x4f34be(_0x204036[_0x1a7e46(0x11aa)])+')':'';_0x261676+=_0x1a7e46(0x1bf)+_0x3062ea+'“'+_0xaa7458['name']+'”的参考记忆'+_0x742adb+'\x20---\x0a';const _0x37eff5=_0xaa7458[_0x1a7e46(0xd39)][_0x1a7e46(0x961)](-_0x1a48f5),_0x5b7b53=_0x37eff5[_0x1a7e46(0x1d8)](_0x45496e=>!String(_0x45496e[_0x1a7e46(0x168)])[_0x1a7e46(0x773)](_0x1a7e46(0x257)));_0x5b7b53['length']>0x0?_0x5b7b53[_0x1a7e46(0x7c0)](_0x1ce5d6=>{const _0x5f4a81=_0x1a7e46,_0x1d5435=_0x1ce5d6[_0x5f4a81(0x14a)]===_0x5f4a81(0x74b)?_0xaa7458[_0x5f4a81(0x33a)][_0x5f4a81(0xe16)]||'我':_0x1ce5d6[_0x5f4a81(0x770)]||_0xaa7458[_0x5f4a81(0x596)];let _0x745b7a=String(_0x1ce5d6['content']);if(_0x1ce5d6[_0x5f4a81(0xde0)]==='ai_image'||_0x1ce5d6['type']===_0x5f4a81(0x223))_0x745b7a=_0x5f4a81(0xb60)+_0x1ce5d6[_0x5f4a81(0x168)]+']';else _0x1ce5d6[_0x5f4a81(0xde0)]===_0x5f4a81(0xf64)&&(_0x745b7a='[发送了一条语音，内容是：'+_0x1ce5d6[_0x5f4a81(0x168)]+']');_0x261676+=_0x1d5435+':\x20'+_0x745b7a+'\x0a';}):_0x261676+='(暂无有效聊天记录)\x0a';}}let _0x30de95='';if(_0x59a46f[_0x1a7e46(0x105a)]>0x0){let _0x318b54='\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a';for(const _0x233ad4 of _0x59a46f){let _0x56df41;if(_0x233ad4[_0x1a7e46(0x802)]===_0x1a7e46(0x74b))_0x56df41=_0x405767[_0x1a7e46(0x20a)][_0x1a7e46(0xab3)];else{if(String(_0x233ad4[_0x1a7e46(0x802)])[_0x1a7e46(0xc7c)]('npc_'))_0x56df41=_0x233ad4[_0x1a7e46(0x10ec)]||_0x1a7e46(0xf3b);else{const _0x512dde=_0x405767['chats'][_0x233ad4['authorId']];_0x56df41=_0x512dde?_0x512dde[_0x1a7e46(0x596)]:_0x1a7e46(0xa23);}}if(_0x233ad4[_0x1a7e46(0x802)]===_0x427513)_0x56df41+=_0x1a7e46(0x962);let _0x523789;if(_0x233ad4[_0x1a7e46(0xde0)]===_0x1a7e46(0xa8b)){const _0x257379=_0x233ad4['repostComment']?'并评论说：“'+_0x233ad4[_0x1a7e46(0xb64)]+'”':'';let _0x37b2c4=_0x1a7e46(0xfbf);const _0x4446cd=_0x233ad4[_0x1a7e46(0x693)][_0x1a7e46(0x802)];if(_0x4446cd===_0x1a7e46(0x74b))_0x37b2c4=_0x405767[_0x1a7e46(0x20a)][_0x1a7e46(0xab3)];else _0x405767['chats'][_0x4446cd]&&(_0x37b2c4=_0x405767[_0x1a7e46(0x799)][_0x4446cd][_0x1a7e46(0x596)]);let _0x1c5021;const _0x47685b=_0x233ad4[_0x1a7e46(0x693)];if(_0x47685b['type']===_0x1a7e46(0xe36))_0x1c5021=_0x1a7e46(0x102c)+(_0x47685b[_0x1a7e46(0x55d)]||'')+_0x1a7e46(0x106e)+(_0x47685b[_0x1a7e46(0x9eb)]||'')[_0x1a7e46(0x599)](0x0,0x28)+_0x1a7e46(0x2e4);else _0x47685b[_0x1a7e46(0xde0)]==='image_post'?_0x1c5021=_0x1a7e46(0x7e7)+(_0x47685b[_0x1a7e46(0x55d)]||'')+_0x1a7e46(0x106e)+(_0x47685b[_0x1a7e46(0x845)]||'')[_0x1a7e46(0x599)](0x0,0x28)+_0x1a7e46(0x2e4):_0x1c5021='“'+(_0x47685b['content']||'')[_0x1a7e46(0x599)](0x0,0x28)+_0x1a7e46(0xa16);_0x523789='转发了\x20@'+_0x37b2c4+'\x20的动态\x20'+_0x257379+_0x1a7e46(0x48b)+_0x1c5021+'】';}else{if(_0x233ad4['type']===_0x1a7e46(0xe36))_0x523789=(_0x1a7e46(0xa69)+_0x233ad4[_0x1a7e46(0x9eb)]+'”]\x20'+(_0x233ad4[_0x1a7e46(0x55d)]||''))['substring'](0x0,0x32)+_0x1a7e46(0x388);else _0x233ad4[_0x1a7e46(0xde0)]===_0x1a7e46(0x7b5)?_0x523789=(_0x1a7e46(0x304)+_0x233ad4['imageDescription']+_0x1a7e46(0x1202)+(_0x233ad4['publicText']||''))[_0x1a7e46(0x599)](0x0,0x32)+'...':_0x523789=String(_0x233ad4['publicText']||_0x233ad4[_0x1a7e46(0x168)]||'一条动态')[_0x1a7e46(0x599)](0x0,0x32)+_0x1a7e46(0x388);}_0x318b54+='-\x20(ID:\x20'+_0x233ad4['id']+_0x1a7e46(0xc4a)+_0x56df41+_0x1a7e46(0xadd)+_0x523789+'\x22\x0a';if(_0x233ad4['comments']&&_0x233ad4[_0x1a7e46(0x93c)]['length']>0x0)for(const _0x298a83 of _0x233ad4[_0x1a7e46(0x93c)]){if(typeof _0x298a83===_0x1a7e46(0x7a5)&&_0x298a83[_0x1a7e46(0x110f)]){const _0x32c63d=_0x4846a6(_0x298a83['commenterName']);let _0x51c7d8=_0x298a83[_0x1a7e46(0x2b7)]?_0x1a7e46(0x745)+_0x298a83['meaning']+'\x27]':_0x298a83[_0x1a7e46(0xbc6)];_0x298a83[_0x1a7e46(0x110f)]===_0x5480e7[_0x1a7e46(0x4e7)]?_0x318b54+='\x20\x20-\x20你评论说:\x20'+_0x51c7d8+'\x0a':_0x318b54+='\x20\x20-\x20评论:\x20'+_0x32c63d+_0x1a7e46(0x5e8)+_0x298a83[_0x1a7e46(0x110f)]+_0x1a7e46(0xd74)+_0x51c7d8+'\x0a';}}}_0x30de95=_0x318b54;}const _0x26d428=_0x1a7e46(0x71e)+(_0x5480e7[_0x1a7e46(0xbca)]&&_0x5480e7['longTermMemory'][_0x1a7e46(0x105a)]>0x0?_0x5480e7[_0x1a7e46(0xbca)][_0x1a7e46(0x6b9)](_0xb61cc=>'-\x20(记录于\x20'+_0x4f34be(_0xb61cc[_0x1a7e46(0x351)])+')\x20'+_0xb61cc[_0x1a7e46(0x168)])[_0x1a7e46(0xb2c)]('\x0a'):'-\x20(暂无)'),_0x4c23ff=_0x5e1bc2(_0x5480e7,0x3,_0x1a7e46(0x834)),_0x1dd342=_0x5e1bc2(_0x5480e7,0x6,_0x1a7e46(0x834)),_0xf17f17=_0x5e1bc2(_0x5480e7,0x9,_0x1a7e46(0x834)),_0x51ecbd=_0x5e1bc2(_0x5480e7,0x1,_0x1a7e46(0x1a0)),_0x1c0e84=_0x5e1bc2(_0x5480e7,0x3,_0x1a7e46(0x1a0)),_0x48a78f=_0x5e1bc2(_0x5480e7,0x7,_0x1a7e46(0x1a0));let _0x22d60d='';if(_0x4c23ff||_0x1dd342||_0xf17f17||_0x51ecbd||_0x1c0e84||_0x48a78f){_0x22d60d+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x4c23ff)_0x22d60d+=_0x4c23ff;if(_0x1dd342)_0x22d60d+=_0x1dd342;if(_0xf17f17)_0x22d60d+=_0xf17f17;if(_0x4c23ff||_0x1dd342||_0xf17f17)_0x22d60d+='\x0a';if(_0x51ecbd)_0x22d60d+=_0x51ecbd;if(_0x1c0e84)_0x22d60d+=_0x1c0e84;if(_0x48a78f)_0x22d60d+=_0x48a78f;}const _0x344b00='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22'+_0x5480e7['name']+_0x1a7e46(0xb18)+_0x5480e7['originalName']+_0x1a7e46(0xe6c)+_0x10bc8f+_0x1a7e46(0x1187)+(_0x5480e7[_0x1a7e46(0x33a)]['enableTimePerception']?'\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是'+_0x471fcf+'\x20('+_0x178cc2+_0x1a7e46(0xafc)+_0x1db48a+'\x0a'+(_0x3657b2?'【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！':''):'')+_0x1a7e46(0x498)+(_0x5480e7[_0x1a7e46(0xe2c)]||'无')+_0x1a7e46(0xbbd)+_0x190e63+_0x1a7e46(0x1022)+_0xcfecdf+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20'+_0x5480e7[_0x1a7e46(0x33a)][_0x1a7e46(0x1060)]+_0x1a7e46(0x1022)+_0x384c8e+_0x1a7e46(0x1022)+(_0x5480e7[_0x1a7e46(0xbca)]&&_0x5480e7[_0x1a7e46(0xbca)][_0x1a7e46(0x105a)]>0x0?_0x5480e7[_0x1a7e46(0xbca)][_0x1a7e46(0x6b9)](_0x363b27=>'-\x20(记录于\x20'+_0x4f34be(_0x363b27[_0x1a7e46(0x351)])+')\x20'+_0x363b27[_0x1a7e46(0x168)])[_0x1a7e46(0xb2c)]('\x0a'):'无')+_0x1a7e46(0x1022)+_0x22d60d+_0x1a7e46(0xb8f)+_0x261676+_0x1a7e46(0x1022)+(_0x5480e7[_0x1a7e46(0x33a)][_0x1a7e46(0xe87)]?_0x1a7e46(0x719)+_0x471fcf+'\x20('+_0x178cc2+')':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x5480e7[_0x1a7e46(0x33a)][_0x1a7e46(0xe87)]?_0x1a7e46(0x27c)+_0x1db48a:'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20'+_0x40da66+_0x1a7e46(0x1022)+_0x30de95+'\x0a',_0x296284=[{'role':_0x1a7e46(0x46c),'content':_0x344b00},..._0x5b83e1['map'](_0x59454f=>{const _0x5761bd=_0x1a7e46,_0xe2a5ab=_0x59454f[_0x5761bd(0x14a)]===_0x5761bd(0x74b)?_0x10bc8f:_0x5480e7[_0x5761bd(0x596)];let _0x4a82ba=_0x59454f[_0x5761bd(0x168)];return typeof _0x4a82ba!==_0x5761bd(0xf1b)&&(_0x4a82ba=JSON['stringify'](_0x4a82ba)),{'role':_0x59454f[_0x5761bd(0x14a)],'content':_0xe2a5ab+':\x20'+_0x4a82ba};})];try{const _0x4ab842=[{'role':_0x1a7e46(0x74b),'content':_0x344b00+_0x1a7e46(0x815)+_0x30de95}];console[_0x1a7e46(0x32b)](_0x1a7e46(0xae9)+_0x5480e7[_0x1a7e46(0x596)]+'\x22)');let _0xb07705=_0x448b21===GEMINI_API_URL,_0x465e04=_0x282b7e(_0x21271e,_0x4a9871,_0x344b00,_0x4ab842);const _0x3fc002=_0xb07705?await fetch(_0x465e04['url'],_0x465e04[_0x1a7e46(0x49a)]):await fetch(_0x448b21+'/v1/chat/completions',{'method':_0x1a7e46(0xcd0),'headers':{'Content-Type':_0x1a7e46(0xcb6),'Authorization':_0x1a7e46(0xf42)+_0x4a9871},'body':JSON[_0x1a7e46(0x1175)]({'model':_0x21271e,'messages':_0x4ab842,'temperature':_0x405767[_0x1a7e46(0xb73)]['apiTemperature']||0.9})});if(!_0x3fc002['ok']){const _0x4fe53b=await _0x3fc002[_0x1a7e46(0x7e9)]();throw new Error('API请求失败:\x20'+_0x3fc002[_0x1a7e46(0x8c8)]+'\x20-\x20'+JSON['stringify'](_0x4fe53b));}const _0x463cf2=await _0x3fc002['json'](),_0x5734cc=_0xb07705?getGeminiResponseText(_0x463cf2):_0x463cf2[_0x1a7e46(0xa44)][0x0][_0x1a7e46(0xc7d)][_0x1a7e46(0x168)];if(!_0x5734cc||_0x5734cc['trim']()===''){console[_0x1a7e46(0x112a)](_0x1a7e46(0xb2d)+_0x5480e7[_0x1a7e46(0x596)]+_0x1a7e46(0x3b1));return;}const _0x3738de=_0x5196dd(_0x5734cc);if(!_0x3738de||_0x3738de[_0x1a7e46(0x105a)]===0x0){console[_0x1a7e46(0x112a)](_0x1a7e46(0x92c)+_0x5480e7[_0x1a7e46(0x596)]+_0x1a7e46(0x98f),_0x5734cc);return;}let _0x32ed45=Date[_0x1a7e46(0x1ed)](),_0x1d20f7=![];const _0x5ccf60=[];for(const _0x2c7ae3 of _0x3738de){const _0x3d331d=String(_0x2c7ae3[_0x1a7e46(0x168)]||''),_0x5e8639=_0x3d331d['trim']()[_0x1a7e46(0xc7c)]('<')&&_0x3d331d[_0x1a7e46(0x8c6)]()[_0x1a7e46(0x866)]('>');if(_0x2c7ae3[_0x1a7e46(0xde0)]===_0x1a7e46(0xbc6)&&!_0x5e8639&&_0x3d331d[_0x1a7e46(0x773)]('\x0a')){const _0x59d65a=_0x3d331d[_0x1a7e46(0x111f)](/\n+/)[_0x1a7e46(0x1d8)](_0xb59532=>_0xb59532[_0x1a7e46(0x8c6)]());_0x59d65a[_0x1a7e46(0x7c0)](_0x2d0030=>{const _0x54a56d=_0x1a7e46;_0x5ccf60[_0x54a56d(0xa49)]({..._0x2c7ae3,'content':_0x2d0030});});}else _0x5ccf60[_0x1a7e46(0xa49)](_0x2c7ae3);}for(const _0x13f43c of _0x5ccf60){_0x5480e7['lastActionType']=_0x13f43c[_0x1a7e46(0xde0)],_0x5480e7['lastActionTimestamp']=_0x32ed45;let _0x4e86e5=null;const _0x1a0716={'role':_0x1a7e46(0x458),'senderName':_0x5480e7[_0x1a7e46(0x4e7)],'timestamp':_0x32ed45++};let _0x20306c=null;switch(_0x13f43c[_0x1a7e46(0xde0)]){case _0x1a7e46(0xaaf):{const _0x108623=parseInt(_0x13f43c[_0x1a7e46(0x5f9)]),_0x300821=await _0x15043e[_0x1a7e46(0xcc0)][_0x1a7e46(0x3e9)](_0x108623);if(_0x300821&&_0x300821['authorId']===_0x427513){await _0x15043e['qzonePosts']['update'](_0x108623,{'isDeleted':!![]});document[_0x1a7e46(0x8c2)]('qzone-screen')['classList'][_0x1a7e46(0x795)](_0x1a7e46(0x71b))&&_0xa34c48();const _0x54725f={'role':_0x1a7e46(0x46c),'type':'post_deleted_notice','content':'['+_0x5480e7['name']+'\x20删除了自己的一条动态]','postId':_0x108623,'timestamp':_0x32ed45++};_0x5480e7['history'][_0x1a7e46(0xa49)](_0x54725f),isViewingThisChat?_0x5c5c92(_0x54725f,_0x5480e7):(_0x5480e7[_0x1a7e46(0xf10)]=(_0x5480e7[_0x1a7e46(0xf10)]||0x0)+0x1,_0x979d69(_0x427513,'['+_0x5480e7[_0x1a7e46(0x596)]+_0x1a7e46(0x71d)),_0x1d20f7=!![]);}else console[_0x1a7e46(0x112a)]('AI\x20\x22'+_0x5480e7['name']+'\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20'+_0x13f43c[_0x1a7e46(0x5f9)]+')');continue;}case _0x1a7e46(0xbc6):_0x4e86e5={..._0x1a0716,'content':_0x13f43c[_0x1a7e46(0x168)]};break;case _0x1a7e46(0x7c8):_0x4e86e5={..._0x1a0716,'type':'ai_image','content':_0x13f43c[_0x1a7e46(0x3ca)]};break;case _0x1a7e46(0x526):_0x5480e7[_0x1a7e46(0x8c8)][_0x1a7e46(0xbc6)]=_0x13f43c[_0x1a7e46(0xb91)],_0x5480e7[_0x1a7e46(0x8c8)][_0x1a7e46(0xb5e)]=_0x13f43c['is_busy']||![],_0x5480e7[_0x1a7e46(0x8c8)]['lastUpdate']=Date[_0x1a7e46(0x1ed)]();break;case _0x1a7e46(0x80e):const _0x178d7b={'type':_0x13f43c[_0x1a7e46(0x4ac)],'content':_0x13f43c[_0x1a7e46(0x168)]||'','publicText':_0x13f43c['publicText']||'','hiddenContent':_0x13f43c[_0x1a7e46(0x9eb)]||'','image_prompt':_0x13f43c[_0x1a7e46(0xdae)]||'','timestamp':Date[_0x1a7e46(0x1ed)](),'authorId':_0x427513,'authorOriginalName':_0x5480e7[_0x1a7e46(0x4e7)],'authorGroupId':_0x5480e7[_0x1a7e46(0x40f)],'visibleGroupIds':null};await _0x15043e[_0x1a7e46(0xcc0)][_0x1a7e46(0x3f4)](_0x178d7b),_0x156368(_0x38d2a9+0x1),console[_0x1a7e46(0x32b)]('后台活动:\x20角色\x20\x22'+_0x5480e7[_0x1a7e46(0x596)]+_0x1a7e46(0xc8f));break;case _0x1a7e46(0xa8b):const _0x2be665=await _0x15043e[_0x1a7e46(0xcc0)]['get'](parseInt(_0x13f43c[_0x1a7e46(0x5f9)]));if(_0x2be665){const _0x21c23a={'type':_0x1a7e46(0xa8b),'timestamp':Date['now'](),'authorId':_0x427513,'authorGroupId':_0x5480e7[_0x1a7e46(0x40f)],'authorOriginalName':_0x5480e7[_0x1a7e46(0x4e7)],'repostComment':_0x13f43c[_0x1a7e46(0x120a)]||'','originalPost':_0x2be665,'visibleGroupIds':null};await _0x15043e['qzonePosts']['add'](_0x21c23a),_0x156368(_0x38d2a9+0x1),console['log'](_0x1a7e46(0x10af)+_0x5480e7['name']+_0x1a7e46(0x318)+_0x13f43c[_0x1a7e46(0x5f9)]);}break;case _0x1a7e46(0x1ab):const _0x11584e=await _0x15043e[_0x1a7e46(0xcc0)][_0x1a7e46(0x3e9)](parseInt(_0x13f43c[_0x1a7e46(0x5f9)]));if(_0x11584e){if(!_0x11584e[_0x1a7e46(0xe2e)])_0x11584e[_0x1a7e46(0xe2e)]=[];!_0x11584e[_0x1a7e46(0xe2e)][_0x1a7e46(0x773)](_0x5480e7[_0x1a7e46(0x4e7)])&&(_0x11584e[_0x1a7e46(0xe2e)][_0x1a7e46(0xa49)](_0x5480e7[_0x1a7e46(0x4e7)]),await _0x15043e[_0x1a7e46(0xcc0)][_0x1a7e46(0xb7c)](_0x11584e['id'],{'likes':_0x11584e[_0x1a7e46(0xe2e)]}),_0x156368(_0x38d2a9+0x1),console[_0x1a7e46(0x32b)](_0x1a7e46(0x10af)+_0x5480e7[_0x1a7e46(0x596)]+_0x1a7e46(0x24f)+_0x13f43c['postId']));}break;case'qzone_comment':const _0x5806b5=await _0x15043e[_0x1a7e46(0xcc0)][_0x1a7e46(0x3e9)](parseInt(_0x13f43c[_0x1a7e46(0x5f9)]));if(_0x5806b5){if(!_0x5806b5[_0x1a7e46(0x93c)])_0x5806b5[_0x1a7e46(0x93c)]=[];const _0x5210b6=_0x13f43c[_0x1a7e46(0x596)]||_0x5480e7['originalName'],_0x26ab09=(_0x1972b5,_0x57962d=null,_0x5af725=null)=>({'commenterName':_0x5210b6,'text':_0x206f67(_0x1972b5,_0x5480e7),'meaning':_0x57962d,'replyTo':_0x5af725,'timestamp':Date['now']()});if(_0x13f43c[_0x1a7e46(0x72a)]&&_0x13f43c[_0x1a7e46(0x11e9)])_0x5806b5[_0x1a7e46(0x93c)][_0x1a7e46(0xa49)](_0x26ab09(_0x13f43c[_0x1a7e46(0x72a)],_0x13f43c[_0x1a7e46(0x11e9)],_0x13f43c[_0x1a7e46(0x176)]||null));else{if(Array[_0x1a7e46(0xb85)](_0x13f43c[_0x1a7e46(0x93c)]))_0x13f43c['comments'][_0x1a7e46(0x7c0)](_0x498e42=>{const _0x179e44=_0x1a7e46;typeof _0x498e42===_0x179e44(0xf1b)&&_0x498e42['trim']()&&_0x5806b5[_0x179e44(0x93c)][_0x179e44(0xa49)](_0x26ab09(_0x498e42,null,_0x13f43c[_0x179e44(0x176)]||null));});else typeof _0x13f43c[_0x1a7e46(0x238)]===_0x1a7e46(0xf1b)&&_0x13f43c['commentText'][_0x1a7e46(0x8c6)]()&&_0x5806b5[_0x1a7e46(0x93c)]['push'](_0x26ab09(_0x13f43c[_0x1a7e46(0x238)],null,_0x13f43c[_0x1a7e46(0x176)]||null));}await _0x15043e['qzonePosts']['update'](_0x5806b5['id'],{'comments':_0x5806b5['comments']}),_0x156368(_0x38d2a9+0x1),console[_0x1a7e46(0x32b)](_0x1a7e46(0x10af)+_0x5480e7['name']+_0x1a7e46(0xa4c)+_0x13f43c['postId']);if(!_0x5480e7['commentCooldowns'])_0x5480e7['commentCooldowns']={};_0x5480e7['commentCooldowns'][_0x13f43c[_0x1a7e46(0x5f9)]]=Date[_0x1a7e46(0x1ed)]();}break;case _0x1a7e46(0x6f9):!_0x49beae[_0x1a7e46(0x6f0)]&&!_0x49beae[_0x1a7e46(0x324)]&&(_0x49beae['isAwaitingResponse']=!![],_0x49beae[_0x1a7e46(0x248)]=_0x427513,_0x49beae[_0x1a7e46(0x390)]=![],_0x49beae[_0x1a7e46(0xf53)]=_0x5480e7[_0x1a7e46(0x596)],_0x431406());break;default:console['warn'](_0x1a7e46(0x10a8)+_0x5480e7['name']+_0x1a7e46(0x38b),_0x13f43c[_0x1a7e46(0xde0)]);break;case'change_avatar':{const _0x45d4cd=_0x13f43c[_0x1a7e46(0x596)],_0x105f83=_0x5480e7[_0x1a7e46(0x33a)][_0x1a7e46(0xca4)][_0x1a7e46(0x2ef)](_0x1eafe5=>_0x1eafe5[_0x1a7e46(0x596)]===_0x45d4cd);_0x105f83&&(_0x5480e7['settings'][_0x1a7e46(0x44e)]=_0x105f83[_0x1a7e46(0x9d6)],await _0x19507d(_0x5480e7),visibleSystemMessage={'content':'['+_0x5480e7[_0x1a7e46(0x596)]+_0x1a7e46(0x34f)},console[_0x1a7e46(0x32b)]('后台活动:\x20角色\x20\x22'+_0x5480e7[_0x1a7e46(0x596)]+_0x1a7e46(0x704)));break;}}if(_0x4e86e5){_0x5480e7[_0x1a7e46(0xd39)][_0x1a7e46(0xa49)](_0x4e86e5),_0x5480e7[_0x1a7e46(0xf10)]=(_0x5480e7[_0x1a7e46(0xf10)]||0x0)+0x1;if(!_0x1d20f7){let _0x1e488c=_0x4e86e5['type']===_0x1a7e46(0x7c8)?_0x1a7e46(0xcb0):_0x4e86e5[_0x1a7e46(0x168)]||'';_0x979d69(_0x427513,_0x1e488c),_0x1d20f7=!![];}}}await _0x15043e[_0x1a7e46(0x799)][_0x1a7e46(0xfaa)](_0x5480e7);}catch(_0x173092){console['error'](_0x1a7e46(0x10a8)+_0x5480e7[_0x1a7e46(0x596)]+_0x1a7e46(0xa5b),_0x173092);}finally{_0x24fb6c(_0x427513,![]),_0x2b55d1(),document[_0x1a7e46(0x8c2)]('qzone-screen')['classList']['contains'](_0x1a7e46(0x71b))&&_0xa34c48();}}async function _0x5ab933(_0xa72ca7){const _0x2cae47=_0x18b51e,_0x40e2d7=_0x405767[_0x2cae47(0x799)][_0xa72ca7];if(!_0x40e2d7||!_0x40e2d7[_0x2cae47(0x1000)])return;const _0x78b492=_0x40e2d7[_0x2cae47(0x33a)][_0x2cae47(0x107e)]||0xa;if(_0x40e2d7[_0x2cae47(0x6c9)]){const _0x337f83=(Date[_0x2cae47(0x1ed)]()-_0x40e2d7[_0x2cae47(0x6c9)])/(0x3e8*0x3c);if(_0x337f83<_0x78b492){console['log'](_0x2cae47(0x62f)+_0x40e2d7['name']+_0x2cae47(0x34a));return;}}const {proxyUrl:_0x4e52b4,apiKey:_0x5c70a7,model:_0x302757}=_0x405767[_0x2cae47(0x9e0)];if(!_0x4e52b4||!_0x5c70a7||!_0x302757)return;const _0x44b877=_0x40e2d7[_0x2cae47(0x33a)][_0x2cae47(0xe16)]||'我',_0x317036=new Date();let _0x446668;const _0x17456e=_0x40e2d7['history']['filter'](_0x42a7ee=>!_0x42a7ee[_0x2cae47(0x3f1)])[_0x2cae47(0x961)](-0x5),_0x2306a5=_0x17456e[_0x2cae47(0x2ef)](_0xdbceb5=>_0xdbceb5['type']==='red_packet'&&!_0xdbceb5['isFullyClaimed']);if(_0x2306a5){const _0x4c272a=_0x1ba34a(_0x40e2d7,_0x2306a5[_0x2cae47(0x770)]);console[_0x2cae47(0x32b)](_0x2cae47(0x83e)+_0x40e2d7[_0x2cae47(0x596)]+_0x2cae47(0xd57)),_0x446668='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“'+_0x4c272a+_0x2cae47(0x978)+_0x2306a5[_0x2cae47(0x351)]+_0x2cae47(0x32d)+_0x2306a5[_0x2cae47(0x351)]+_0x2cae47(0x70f);}else{let _0x334955='';const _0x58c7a0=_0x40e2d7[_0x2cae47(0x33a)][_0x2cae47(0xd68)]||_0x2cae47(0xad0),_0x53a8a2=_0x317036[_0x2cae47(0x2e8)](_0x2cae47(0x73e),{'timeZone':_0x58c7a0,'dateStyle':_0x2cae47(0x196),'timeStyle':'short'}),_0x591b3f=new Date(_0x317036['toLocaleString'](_0x2cae47(0x85a),{'timeZone':_0x58c7a0}));if(_0x40e2d7[_0x2cae47(0x33a)][_0x2cae47(0xe87)]){const _0x21eefe=_0x40e2d7[_0x2cae47(0xd39)][_0x2cae47(0x1d8)](_0x9e3f07=>!_0x9e3f07['isHidden'])[_0x2cae47(0x961)](-0x1)[0x0];if(_0x21eefe){const _0x2a7aae=new Date(_0x21eefe[_0x2cae47(0x351)]),_0x3e4471=(_0x317036-_0x2a7aae)/(0x3e8*0x3c);_0x3e4471>0x3c?_0x334955=_0x2cae47(0x5fd)+Math[_0x2cae47(0x5d7)](_0x3e4471/0x3c)+_0x2cae47(0x109d):_0x334955='群里在'+Math[_0x2cae47(0x10b2)](_0x3e4471)+_0x2cae47(0xbbb);}else _0x334955=_0x2cae47(0x82a);}let _0x423892=_0x2cae47(0xbfe);const _0x447f1a=_0x40e2d7[_0x2cae47(0x33a)][_0x2cae47(0x808)]||0xa,_0x5be39c=_0x40e2d7['history'][_0x2cae47(0x1d8)](_0x181f81=>!_0x181f81[_0x2cae47(0x3f1)])[_0x2cae47(0x961)](-_0x447f1a);_0x5be39c[_0x2cae47(0x105a)]>0x0&&(_0x423892=_0x2cae47(0x670)+_0x5be39c[_0x2cae47(0x6b9)](_0xdcb65d=>{const _0xbd0927=_0x2cae47,_0x25860d=_0xdcb65d[_0xbd0927(0x14a)]===_0xbd0927(0x74b)?_0x44b877:_0x1ba34a(_0x40e2d7,_0xdcb65d[_0xbd0927(0x770)]),_0x2381c5=String(_0xdcb65d[_0xbd0927(0x168)]||_0xdcb65d[_0xbd0927(0xc7d)]||'')['substring'](0x0,0x32);return _0x25860d+':\x20'+_0x2381c5+_0xbd0927(0x388);})[_0x2cae47(0xb2c)]('\x0a'));const _0x1c133d=_0x40e2d7[_0x2cae47(0x635)][_0x2cae47(0x6b9)](_0x2a0409=>'-\x20**'+_0x2a0409[_0x2cae47(0x375)]+'**\x20(本名:\x20'+_0x2a0409[_0x2cae47(0x4e7)]+_0x2cae47(0xd74)+_0x2a0409[_0x2cae47(0x391)])['join']('\x0a');let _0x2eec18='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0x53b50c=![];_0x40e2d7[_0x2cae47(0x635)]['forEach'](_0x5b4ccd=>{const _0x358bf7=_0x2cae47,_0x1cfbfb=_0x405767[_0x358bf7(0x799)][_0x5b4ccd['id']];_0x1cfbfb&&_0x1cfbfb['longTermMemory']&&_0x1cfbfb[_0x358bf7(0xbca)][_0x358bf7(0x105a)]>0x0&&(_0x2eec18+=_0x358bf7(0x1115)+_0x5b4ccd[_0x358bf7(0x375)]+_0x358bf7(0xb26),_0x2eec18+=_0x1cfbfb[_0x358bf7(0xbca)]['map'](_0xeee628=>'-\x20'+_0xeee628[_0x358bf7(0x168)])[_0x358bf7(0xb2c)]('\x0a'),_0x53b50c=!![]);});!_0x53b50c&&(_0x2eec18+='-\x20(暂无)');let _0x735a71='';if(_0x40e2d7[_0x2cae47(0x33a)][_0x2cae47(0xb77)]&&_0x40e2d7[_0x2cae47(0x33a)][_0x2cae47(0xb77)][_0x2cae47(0x105a)]>0x0){const _0x272136=_0x40e2d7['settings']['linkedWorldBookIds'][_0x2cae47(0x6b9)](_0x542090=>{const _0x5b07da=_0x2cae47,_0x534e36=_0x405767[_0x5b07da(0x40e)][_0x5b07da(0x2ef)](_0x138476=>_0x138476['id']===_0x542090);if(!_0x534e36||!Array[_0x5b07da(0xb85)](_0x534e36[_0x5b07da(0x168)]))return'';const _0x2c6a30=_0x534e36[_0x5b07da(0x168)][_0x5b07da(0x1d8)](_0x5e3cbb=>_0x5e3cbb[_0x5b07da(0x69a)]!==![])[_0x5b07da(0x6b9)](_0xd4ecac=>{const _0x108336=_0x5b07da;let _0x120679=_0x108336(0xf8d)+(_0xd4ecac[_0x108336(0x120a)]||_0x108336(0x11db))+'\x0a';return _0xd4ecac['keys'][_0x108336(0x105a)]>0x0&&(_0x120679+=_0x108336(0xdd1)+_0xd4ecac['keys'][_0x108336(0xb2c)](',\x20')+'\x0a'),_0x120679+=_0x108336(0xce7)+_0xd4ecac[_0x108336(0x168)],_0x120679;})['join']('');return _0x2c6a30?_0x5b07da(0x15d)+_0x534e36[_0x5b07da(0x596)]+'\x0a'+_0x2c6a30:'';})[_0x2cae47(0x1d8)](Boolean)[_0x2cae47(0xb2c)]('');_0x272136&&(_0x735a71=_0x2cae47(0xcee)+_0x272136+_0x2cae47(0x836));}let _0x42ec9e='';const _0x4ffbda=_0x40e2d7[_0x2cae47(0x33a)][_0x2cae47(0x57d)]||0xa;if(_0x40e2d7[_0x2cae47(0x33a)][_0x2cae47(0xb6e)]&&_0x40e2d7[_0x2cae47(0x33a)][_0x2cae47(0xb6e)]['length']>0x0){const _0x120b28=_0x40e2d7['settings'][_0x2cae47(0xb6e)][_0x2cae47(0x6b9)](_0x5d3d83=>{const _0x248896=_0x2cae47,_0x32bef2=_0x405767[_0x248896(0x799)][_0x5d3d83];if(!_0x32bef2)return null;const _0x3d8116=_0x32bef2[_0x248896(0xd39)][_0x248896(0x961)](-0x1)[0x0];return{'chat':_0x32bef2,'latestTimestamp':_0x3d8116?_0x3d8116['timestamp']:0x0};})['filter'](Boolean);_0x120b28[_0x2cae47(0xa19)]((_0x18dae5,_0x2732fc)=>_0x2732fc[_0x2cae47(0x11aa)]-_0x18dae5[_0x2cae47(0x11aa)]),_0x42ec9e+=_0x2cae47(0x819);for(const _0x31f0c2 of _0x120b28){const _0xe4753f=_0x31f0c2[_0x2cae47(0x6d4)],_0x1f3ea1=_0xe4753f['isGroup']?_0x2cae47(0xe4f):_0x2cae47(0x717),_0x1bb83a=_0x31f0c2[_0x2cae47(0x11aa)]>0x0?_0x2cae47(0xd7c)+_0x4f34be(_0x31f0c2[_0x2cae47(0x11aa)])+')':'';_0x42ec9e+=_0x2cae47(0x1bf)+_0x1f3ea1+'“'+_0xe4753f[_0x2cae47(0x596)]+'”的参考记忆'+_0x1bb83a+_0x2cae47(0x100a);const _0x1a2326=_0xe4753f[_0x2cae47(0xd39)]['slice'](-_0x4ffbda),_0x4069b5=_0x1a2326[_0x2cae47(0x1d8)](_0x119936=>!String(_0x119936[_0x2cae47(0x168)])[_0x2cae47(0x773)](_0x2cae47(0x257)));_0x4069b5[_0x2cae47(0x105a)]>0x0?_0x4069b5[_0x2cae47(0x7c0)](_0x335d73=>{const _0x21b155=_0x2cae47,_0x43db3d=_0x335d73[_0x21b155(0x14a)]===_0x21b155(0x74b)?_0xe4753f[_0x21b155(0x33a)][_0x21b155(0xe16)]||'我':_0x335d73[_0x21b155(0x770)]||_0xe4753f['name'];let _0x54b87a=String(_0x335d73['content']);if(_0x335d73['type']===_0x21b155(0x7c8)||_0x335d73[_0x21b155(0xde0)]===_0x21b155(0x223))_0x54b87a='[发送了一张图片，描述为：'+_0x335d73['content']+']';else _0x335d73[_0x21b155(0xde0)]==='voice_message'&&(_0x54b87a=_0x21b155(0xc6e)+_0x335d73[_0x21b155(0x168)]+']');_0x42ec9e+=_0x43db3d+':\x20'+_0x54b87a+'\x0a';}):_0x42ec9e+=_0x2cae47(0x3dc);}}const _0x105bb5=await _0x15043e['qzonePosts']['orderBy'](_0x2cae47(0x351))[_0x2cae47(0x1c0)]()['limit'](0x5)[_0x2cae47(0x6be)]();let _0x256237='';const _0x2c8845=new Set();for(const _0x441a48 of _0x40e2d7[_0x2cae47(0x635)]){const _0x5a9143=_0x405767[_0x2cae47(0x799)][_0x441a48['id']];if(_0x5a9143){const _0x476cf1=_0x12538d(_0x105bb5,_0x5a9143);_0x476cf1[_0x2cae47(0x7c0)](_0xaf060c=>_0x2c8845[_0x2cae47(0x3f4)](_0xaf060c));}}const _0x482554=new Set(_0x40e2d7['members'][_0x2cae47(0x6b9)](_0x322981=>_0x322981[_0x2cae47(0x4e7)])),_0x39219f=[..._0x2c8845][_0x2cae47(0x1d8)](_0x3e3c51=>{const _0x571e81=_0x2cae47,_0x52a237=_0x3e3c51[_0x571e81(0xe2e)]&&_0x3e3c51[_0x571e81(0xe2e)][_0x571e81(0xdc3)](_0x2946f3=>_0x482554['has'](_0x2946f3)),_0x57ffd7=_0x3e3c51['comments']&&_0x3e3c51[_0x571e81(0x93c)][_0x571e81(0xdc3)](_0x4c93be=>typeof _0x4c93be===_0x571e81(0x7a5)&&_0x482554[_0x571e81(0x11ac)](_0x4c93be[_0x571e81(0x110f)]));return!_0x52a237&&!_0x57ffd7;});if(_0x39219f[_0x2cae47(0x105a)]>0x0){let _0x661e6='\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a';for(const _0x5d4c2a of _0x39219f){let _0x561dba=_0x5d4c2a['authorId']===_0x2cae47(0x74b)?_0x44b877:_0x405767[_0x2cae47(0x799)][_0x5d4c2a[_0x2cae47(0x802)]]?.[_0x2cae47(0x596)]||'一位朋友',_0x16ff75;if(_0x5d4c2a['type']===_0x2cae47(0xa8b)){const _0x701352=_0x5d4c2a[_0x2cae47(0xb64)]?_0x2cae47(0xcc3)+_0x5d4c2a['repostComment']+'”':'';let _0x51051b=_0x2cae47(0xfbf);const _0x5cfe0b=_0x5d4c2a['originalPost'][_0x2cae47(0x802)];if(_0x5cfe0b==='user')_0x51051b=_0x405767['qzoneSettings']['nickname'];else _0x405767[_0x2cae47(0x799)][_0x5cfe0b]&&(_0x51051b=_0x405767['chats'][_0x5cfe0b][_0x2cae47(0x596)]);let _0x4b02bd;const _0x579a02=_0x5d4c2a['originalPost'];if(_0x579a02[_0x2cae47(0xde0)]==='text_image')_0x4b02bd=_0x2cae47(0x102c)+(_0x579a02['publicText']||'')+_0x2cae47(0x106e)+(_0x579a02[_0x2cae47(0x9eb)]||'')[_0x2cae47(0x599)](0x0,0x28)+_0x2cae47(0x2e4);else _0x579a02[_0x2cae47(0xde0)]===_0x2cae47(0x7b5)?_0x4b02bd=_0x2cae47(0x7e7)+(_0x579a02['publicText']||'')+_0x2cae47(0x106e)+(_0x579a02[_0x2cae47(0x845)]||'')[_0x2cae47(0x599)](0x0,0x28)+_0x2cae47(0x2e4):_0x4b02bd='“'+(_0x579a02[_0x2cae47(0x168)]||'')[_0x2cae47(0x599)](0x0,0x28)+_0x2cae47(0xa16);_0x16ff75=_0x2cae47(0xca7)+_0x51051b+'\x20的动态\x20'+_0x701352+_0x2cae47(0x48b)+_0x4b02bd+'】';}else{if(_0x5d4c2a[_0x2cae47(0xde0)]==='text_image')_0x16ff75=(_0x2cae47(0xa69)+_0x5d4c2a[_0x2cae47(0x9eb)]+_0x2cae47(0x1202)+(_0x5d4c2a[_0x2cae47(0x55d)]||''))[_0x2cae47(0x599)](0x0,0x32)+'...';else _0x5d4c2a[_0x2cae47(0xde0)]===_0x2cae47(0x7b5)?_0x16ff75=('[一张图片，描述为：“'+_0x5d4c2a['imageDescription']+_0x2cae47(0x1202)+(_0x5d4c2a['publicText']||''))[_0x2cae47(0x599)](0x0,0x32)+_0x2cae47(0x388):_0x16ff75=String(_0x5d4c2a['publicText']||_0x5d4c2a[_0x2cae47(0x168)]||'一条动态')[_0x2cae47(0x599)](0x0,0x32)+_0x2cae47(0x388);}_0x661e6+=_0x2cae47(0x1243)+_0x5d4c2a['id']+')\x20作者:\x20'+_0x561dba+',\x20内容:\x20\x22'+_0x16ff75+'\x22\x0a';if(_0x5d4c2a['comments']&&_0x5d4c2a['comments'][_0x2cae47(0x105a)]>0x0)for(const _0x4556e6 of _0x5d4c2a[_0x2cae47(0x93c)]){if(typeof _0x4556e6===_0x2cae47(0x7a5)&&_0x4556e6[_0x2cae47(0x110f)]){const _0xf075c5=_0x4846a6(_0x4556e6[_0x2cae47(0x110f)]);let _0x267da0=_0x4556e6[_0x2cae47(0x2b7)]?_0x2cae47(0x745)+_0x4556e6[_0x2cae47(0x2b7)]+'\x27]':_0x4556e6[_0x2cae47(0xbc6)];_0x661e6+=_0x2cae47(0x63d)+_0xf075c5+'\x20(本名:\x20'+_0x4556e6[_0x2cae47(0x110f)]+'):\x20'+_0x267da0+'\x0a';}}}_0x256237=_0x661e6;}const _0x12afc3=_0x5e1bc2(_0x40e2d7,0x3,_0x2cae47(0x834)),_0xe08279=_0x5e1bc2(_0x40e2d7,0x6,_0x2cae47(0x834)),_0x461adc=_0x5e1bc2(_0x40e2d7,0x9,'hours'),_0x38b376=_0x5e1bc2(_0x40e2d7,0x1,_0x2cae47(0x1a0)),_0x2eb3f3=_0x5e1bc2(_0x40e2d7,0x3,'days'),_0x16be63=_0x5e1bc2(_0x40e2d7,0x7,_0x2cae47(0x1a0));let _0x15a080='';if(_0x12afc3||_0xe08279||_0x461adc||_0x38b376||_0x2eb3f3||_0x16be63){_0x15a080+=_0x2cae47(0x7f7);if(_0x12afc3)_0x15a080+=_0x12afc3;if(_0xe08279)_0x15a080+=_0xe08279;if(_0x461adc)_0x15a080+=_0x461adc;if(_0x12afc3||_0xe08279||_0x461adc)_0x15a080+='\x0a';if(_0x38b376)_0x15a080+=_0x38b376;if(_0x2eb3f3)_0x15a080+=_0x2eb3f3;if(_0x16be63)_0x15a080+=_0x16be63;}_0x446668='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“'+_0x40e2d7[_0x2cae47(0x596)]+_0x2cae47(0x1057)+(_0x40e2d7[_0x2cae47(0x33a)][_0x2cae47(0xe87)]?_0x2cae47(0xd3a)+_0x53a8a2+'。':'')+_0x2cae47(0x1022)+(_0x334955?_0x334955+'\x20':'')+_0x2cae47(0x1163)+_0x2eec18+_0x2cae47(0x2de)+_0x44b877+_0x2cae47(0x1128)+_0x40e2d7[_0x2cae47(0x596)]+_0x2cae47(0x1022)+_0x735a71+_0x2cae47(0xddc)+(_0x40e2d7[_0x2cae47(0xbca)]&&_0x40e2d7['longTermMemory'][_0x2cae47(0x105a)]>0x0?_0x40e2d7[_0x2cae47(0xbca)][_0x2cae47(0x6b9)](_0x27052e=>'-\x20'+_0x27052e[_0x2cae47(0x168)])['join']('\x0a'):_0x2cae47(0xbee))+_0x2cae47(0x94b)+_0x15a080+_0x2cae47(0x1022)+_0x42ec9e+_0x2cae47(0xd8a)+_0x1c133d+_0x2cae47(0x772)+_0x44b877+'**:\x20'+_0x40e2d7[_0x2cae47(0x33a)]['myPersona']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x423892+_0x2cae47(0x6fc)+_0x256237+_0x2cae47(0x737);}const _0x492659=_0x40e2d7[_0x2cae47(0xd39)]['filter'](_0x1e0ca2=>!_0x1e0ca2['isHidden'])[_0x2cae47(0x961)](-0xa),_0x17c6e3=[{'role':_0x2cae47(0x46c),'content':_0x446668},..._0x492659[_0x2cae47(0x6b9)](_0x54616c=>{const _0x4de244=_0x2cae47,_0x2f5e8f=_0x54616c[_0x4de244(0x14a)]===_0x4de244(0x74b)?_0x44b877:_0x1ba34a(_0x40e2d7,_0x54616c[_0x4de244(0x770)]);let _0x3b9008=_0x54616c[_0x4de244(0x168)];if(_0x54616c['type']===_0x4de244(0x7c8)||_0x54616c[_0x4de244(0xde0)]===_0x4de244(0x223))_0x3b9008=_0x4de244(0x44f)+_0x54616c[_0x4de244(0x168)]+'\x27]';else{if(_0x54616c[_0x4de244(0xde0)]==='voice_message')_0x3b9008=_0x4de244(0x2c5)+_0x54616c[_0x4de244(0x168)]+'\x27]';else typeof _0x3b9008!==_0x4de244(0xf1b)&&(_0x3b9008=_0x4de244(0x22e));}return{'role':_0x4de244(0x74b),'content':_0x2f5e8f+':\x20'+_0x3b9008};})];try{const _0x18c070=[{'role':'user','content':_0x446668}];let _0x3a6274=_0x4e52b4===GEMINI_API_URL,_0x42cbfa=_0x282b7e(_0x302757,_0x5c70a7,_0x446668,_0x18c070);const _0x110a61=_0x3a6274?await fetch(_0x42cbfa[_0x2cae47(0x9d6)],_0x42cbfa[_0x2cae47(0x49a)]):await fetch(_0x4e52b4+_0x2cae47(0x5c1),{'method':_0x2cae47(0xcd0),'headers':{'Content-Type':'application/json','Authorization':_0x2cae47(0xf42)+_0x5c70a7},'body':JSON['stringify']({'model':_0x302757,'messages':_0x18c070,'temperature':_0x405767[_0x2cae47(0xb73)]['apiTemperature']||0.9})});if(!_0x110a61['ok'])throw new Error((await _0x110a61[_0x2cae47(0x7e9)]())[_0x2cae47(0x7a3)]['message']);const _0x11154d=await _0x110a61[_0x2cae47(0x7e9)](),_0x24edd4=_0x3a6274?_0x11154d[_0x2cae47(0xc88)][0x0][_0x2cae47(0x168)][_0x2cae47(0x3f0)][0x0][_0x2cae47(0xbc6)]:_0x11154d['choices'][0x0][_0x2cae47(0xc7d)]['content'],_0x17e8db=_0x5196dd(_0x24edd4);if(!_0x17e8db||_0x17e8db[_0x2cae47(0x105a)]===0x0){console[_0x2cae47(0x112a)](_0x2cae47(0x62f)+_0x40e2d7[_0x2cae47(0x596)]+'\x22\x20的独立行动API返回为空或格式不正确，本次跳过。');return;}let _0x6d7683=Date[_0x2cae47(0x1ed)](),_0x4dc332=![],_0x31e70a='',_0x6caca4='';const _0x1e436f=[];for(const _0x3d3da5 of _0x17e8db){const _0xb3dc4d=String(_0x3d3da5[_0x2cae47(0x168)]||''),_0x4a5fd6=_0xb3dc4d[_0x2cae47(0x8c6)]()['startsWith']('<')&&_0xb3dc4d[_0x2cae47(0x8c6)]()[_0x2cae47(0x866)]('>');if(_0x3d3da5['type']==='text'&&!_0x4a5fd6&&_0xb3dc4d[_0x2cae47(0x773)]('\x0a')){const _0x33f1a6=_0xb3dc4d['split'](/\n+/)[_0x2cae47(0x1d8)](_0x28a2d1=>_0x28a2d1[_0x2cae47(0x8c6)]());_0x33f1a6['forEach'](_0x3a9b7a=>{const _0x5a93d5=_0x2cae47;_0x1e436f[_0x5a93d5(0xa49)]({..._0x3d3da5,'content':_0x3a9b7a});});}else _0x1e436f[_0x2cae47(0xa49)](_0x3d3da5);}for(const _0x3aface of _0x1e436f){if(!_0x3aface||!_0x3aface['type']||!_0x3aface[_0x2cae47(0x596)])continue;const _0x19fe80=_0x1ba34a(_0x40e2d7,_0x3aface['name']);let _0x26f314=null,_0x15f7ff=null;const _0x14853c={'role':_0x2cae47(0x458),'senderName':_0x3aface['name'],'timestamp':_0x6d7683++};if(_0x3aface[_0x2cae47(0xde0)]===_0x2cae47(0xb89)){const _0x275da6=_0x40e2d7[_0x2cae47(0xd39)][_0x2cae47(0x2ef)](_0x383170=>_0x383170['timestamp']===_0x3aface[_0x2cae47(0xf9b)]);if(_0x275da6&&!_0x275da6[_0x2cae47(0x2a6)]&&!(_0x275da6[_0x2cae47(0x343)]&&_0x275da6[_0x2cae47(0x343)][_0x3aface[_0x2cae47(0x596)]])){let _0x4d610f=0x0;const _0x5c9fe3=_0x275da6[_0x2cae47(0x887)]-Object[_0x2cae47(0x22f)](_0x275da6['claimedBy']||{})[_0x2cae47(0x29a)]((_0x45bf21,_0x43cb3d)=>_0x45bf21+_0x43cb3d,0x0),_0x3b23e3=_0x275da6[_0x2cae47(0xb61)]-Object[_0x2cae47(0xbda)](_0x275da6[_0x2cae47(0x343)]||{})[_0x2cae47(0x105a)];if(_0x3b23e3>0x0){if(_0x3b23e3===0x1)_0x4d610f=_0x5c9fe3;else{const _0x4a53e5=0.01,_0x1feaa4=_0x5c9fe3-(_0x3b23e3-0x1)*_0x4a53e5;_0x4d610f=Math['random']()*(_0x1feaa4-_0x4a53e5)+_0x4a53e5;}_0x4d610f=parseFloat(_0x4d610f[_0x2cae47(0x3c1)](0x2));if(!_0x275da6['claimedBy'])_0x275da6[_0x2cae47(0x343)]={};_0x275da6[_0x2cae47(0x343)][_0x3aface[_0x2cae47(0x596)]]=_0x4d610f,_0x40e2d7[_0x2cae47(0xd39)]['push']({'role':_0x2cae47(0x46c),'type':'pat_message','content':_0x19fe80+_0x2cae47(0xa6e)+_0x1ba34a(_0x40e2d7,_0x275da6[_0x2cae47(0x770)])+_0x2cae47(0xe25),'timestamp':Date[_0x2cae47(0x1ed)]()});let _0xd4a092=_0x2cae47(0x346)+_0x19fe80+')\x20成功抢到了\x20'+_0x4d610f[_0x2cae47(0x3c1)](0x2)+_0x2cae47(0xec2);if(Object[_0x2cae47(0xbda)](_0x275da6[_0x2cae47(0x343)])[_0x2cae47(0x105a)]>=_0x275da6[_0x2cae47(0xb61)]){_0x275da6['isFullyClaimed']=!![],_0x40e2d7['history'][_0x2cae47(0xa49)]({'role':_0x2cae47(0x46c),'type':_0x2cae47(0x6f1),'content':_0x1ba34a(_0x40e2d7,_0x275da6[_0x2cae47(0x770)])+'\x20的红包已被领完','timestamp':Date['now']()+0x1});let _0x2c4f84={'name':'','amount':-0x1};Object[_0x2cae47(0x6ff)](_0x275da6[_0x2cae47(0x343)])[_0x2cae47(0x7c0)](([_0xe485b,_0x5e3aa7])=>{const _0x5614e0=_0x2cae47;_0x5e3aa7>_0x2c4f84[_0x5614e0(0x4c5)]&&(_0x2c4f84={'name':_0xe485b,'amount':_0x5e3aa7});});if(_0x2c4f84[_0x2cae47(0x596)]){const _0x3122c1=_0x1ba34a(_0x40e2d7,_0x2c4f84[_0x2cae47(0x596)]);_0xd4a092+='\x20红包已被领完，手气王是\x20'+_0x3122c1+'！';}}_0xd4a092+=_0x2cae47(0x3bb),_0x40e2d7[_0x2cae47(0xd39)]['push']({'role':_0x2cae47(0x46c),'content':_0xd4a092,'timestamp':Date[_0x2cae47(0x1ed)]()+0x2,'isHidden':!![]});}}_0x4dc332=!![];continue;}switch(_0x3aface[_0x2cae47(0xde0)]){case'qzone_post':const _0x568417={'type':_0x3aface[_0x2cae47(0x4ac)]||'shuoshuo','content':_0x3aface['content'],'timestamp':Date[_0x2cae47(0x1ed)](),'authorId':_0x405767[_0x2cae47(0x799)][Object[_0x2cae47(0xbda)](_0x405767[_0x2cae47(0x799)])[_0x2cae47(0x2ef)](_0x57cc78=>_0x405767[_0x2cae47(0x799)][_0x57cc78]['originalName']===_0x3aface[_0x2cae47(0x596)])]?.['id']||_0x3aface['name'],'authorOriginalName':_0x3aface['name'],'visibleGroupIds':null};await _0x15043e['qzonePosts']['add'](_0x568417),_0x156368(_0x38d2a9+0x1),_0x26f314={'content':'['+_0x19fe80+_0x2cae47(0x907)};break;case _0x2cae47(0xed9):const _0x5818c0=await _0x15043e[_0x2cae47(0xcc0)][_0x2cae47(0x3e9)](parseInt(_0x3aface[_0x2cae47(0x5f9)]));if(_0x5818c0){if(!_0x5818c0[_0x2cae47(0x93c)])_0x5818c0[_0x2cae47(0x93c)]=[];_0x5818c0['comments'][_0x2cae47(0xa49)]({'commenterName':_0x3aface['name'],'text':_0x3aface[_0x2cae47(0x238)],'timestamp':Date['now']()}),await _0x15043e[_0x2cae47(0xcc0)][_0x2cae47(0xb7c)](_0x5818c0['id'],{'comments':_0x5818c0[_0x2cae47(0x93c)]}),_0x156368(_0x38d2a9+0x1),_0x26f314={'content':'['+_0x19fe80+_0x2cae47(0x1017)};}break;case _0x2cae47(0x1ab):const _0x2867d2=await _0x15043e[_0x2cae47(0xcc0)][_0x2cae47(0x3e9)](parseInt(_0x3aface[_0x2cae47(0x5f9)]));if(_0x2867d2){if(!_0x2867d2[_0x2cae47(0xe2e)])_0x2867d2[_0x2cae47(0xe2e)]=[];!_0x2867d2[_0x2cae47(0xe2e)][_0x2cae47(0x773)](_0x3aface['name'])&&(_0x2867d2[_0x2cae47(0xe2e)][_0x2cae47(0xa49)](_0x3aface[_0x2cae47(0x596)]),await _0x15043e[_0x2cae47(0xcc0)][_0x2cae47(0xb7c)](_0x2867d2['id'],{'likes':_0x2867d2[_0x2cae47(0xe2e)]}),_0x156368(_0x38d2a9+0x1),_0x26f314={'content':'['+_0x19fe80+'\x20点赞了动态]'});}break;case'ai_image':_0x15f7ff={..._0x14853c,'type':_0x2cae47(0x7c8),'content':_0x3aface['description'],'image_prompt':msgData[_0x2cae47(0xdae)]};break;default:if(_0x3aface[_0x2cae47(0xde0)]===_0x2cae47(0x123d)){const _0x58e856=typeof _0x3aface[_0x2cae47(0x320)]===_0x2cae47(0xf1b)?_0x3aface[_0x2cae47(0x320)][_0x2cae47(0x111f)]('\x0a')[_0x2cae47(0x1d8)](_0x11452d=>_0x11452d[_0x2cae47(0x8c6)]()):Array[_0x2cae47(0xb85)](_0x3aface[_0x2cae47(0x320)])?_0x3aface[_0x2cae47(0x320)]:[];if(_0x58e856[_0x2cae47(0x105a)]<0x2)continue;_0x15f7ff={..._0x14853c,..._0x3aface,'options':_0x58e856,'votes':{},'isClosed':![]};}else{const _0x24a1bf=_0x3aface[_0x2cae47(0x168)]||_0x3aface[_0x2cae47(0xc7d)];_0x15f7ff={..._0x14853c,..._0x3aface};if(_0x24a1bf)_0x15f7ff['content']=_0x24a1bf;}break;}if(_0x26f314)_0x40e2d7[_0x2cae47(0xd39)][_0x2cae47(0xa49)]({'role':'system','type':_0x2cae47(0x6f1),'content':_0x26f314[_0x2cae47(0x168)],'timestamp':_0x6d7683++});else _0x15f7ff&&(_0x40e2d7[_0x2cae47(0xd39)][_0x2cae47(0xa49)](_0x15f7ff),!_0x6caca4&&(_0x6caca4=_0x19fe80,_0x31e70a=_0x15f7ff[_0x2cae47(0xde0)]===_0x2cae47(0x7c8)?'[图片]':_0x15f7ff['content']||'['+_0x15f7ff[_0x2cae47(0xde0)]+']'));_0x4dc332=!![];}_0x4dc332&&(_0x40e2d7[_0x2cae47(0x6c9)]=Date[_0x2cae47(0x1ed)](),_0x40e2d7['unreadCount']=(_0x40e2d7[_0x2cae47(0xf10)]||0x0)+_0x17e8db[_0x2cae47(0x1d8)](_0xcbbc2a=>_0xcbbc2a[_0x2cae47(0xde0)]!==_0x2cae47(0x80e)&&_0xcbbc2a[_0x2cae47(0xde0)]!==_0x2cae47(0xed9)&&_0xcbbc2a[_0x2cae47(0xde0)]!==_0x2cae47(0x1ab))[_0x2cae47(0x105a)],_0x6caca4&&_0x31e70a&&_0x979d69(_0xa72ca7,_0x6caca4+':\x20'+_0x31e70a),await _0x15043e['chats']['put'](_0x40e2d7));}catch(_0x44f7ce){console[_0x2cae47(0x7a3)](_0x2cae47(0x62f)+_0x40e2d7[_0x2cae47(0x596)]+_0x2cae47(0xa5b),_0x44f7ce);}finally{_0x2b55d1();}}function _0x51f7b6(_0x5d645d,_0x58b46c,_0x1187b6){const _0x186452=_0x18b51e,_0x195036=document['getElementById'](_0x1187b6);if(!_0x195036)return;if(!_0x5d645d||_0x5d645d['trim']()===''){_0x195036[_0x186452(0xca0)]='';return;}const _0x22a387=_0x5d645d['replace'](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x58b46c+_0x186452(0x740))['replace'](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x58b46c+_0x186452(0x8c3))[_0x186452(0x1b7)](/\s*\.message-bubble\s+([^{]+\{)/g,_0x58b46c+'\x20.message-bubble\x20$1');_0x195036[_0x186452(0xca0)]=_0x22a387;}async function _0x9e9510(){const _0x11cb59=_0x18b51e;if(!_0x405767[_0x11cb59(0x248)])return;const _0x30c741=_0x405767['chats'][_0x405767[_0x11cb59(0x248)]],_0x171db8=document[_0x11cb59(0x8c2)]('settings-preview-area');if(!_0x171db8)return;const _0x214f32=document['querySelector']('input[name=\x22theme-select\x22]:checked')?.[_0x11cb59(0x518)]||_0x11cb59(0x674),_0x2c7158=document['getElementById'](_0x11cb59(0x8fd))[_0x11cb59(0x518)],_0x1be707=document[_0x11cb59(0x8c2)](_0x11cb59(0x10b9))['value'],_0x43553b=_0x30c741[_0x11cb59(0x33a)]['background'];_0x171db8[_0x11cb59(0x323)][_0x11cb59(0xf95)]=_0x214f32,_0x171db8[_0x11cb59(0x842)]['setProperty']('--chat-font-size',_0x2c7158+'px');_0x43553b&&_0x43553b['startsWith'](_0x11cb59(0x1249))?(_0x171db8[_0x11cb59(0x842)][_0x11cb59(0xfff)]=_0x11cb59(0x116b)+_0x43553b+')',_0x171db8[_0x11cb59(0x842)][_0x11cb59(0x617)]=_0x11cb59(0xdc5)):(_0x171db8[_0x11cb59(0x842)][_0x11cb59(0xfff)]='none',_0x171db8[_0x11cb59(0x842)][_0x11cb59(0x812)]=_0x43553b||_0x11cb59(0x959));_0x171db8['innerHTML']='';const _0x11e660={'role':'ai','content':_0x11cb59(0x1011),'timestamp':0x1,'senderName':_0x30c741[_0x11cb59(0x596)]},_0x37f28d=await _0x3cd22d(_0x11e660,_0x30c741);if(_0x37f28d)_0x171db8[_0x11cb59(0x31e)](_0x37f28d);const _0x2fba56={'role':'user','content':_0x11cb59(0x9ae),'timestamp':0x2},_0x1b8337=await _0x3cd22d(_0x2fba56,_0x30c741);if(_0x1b8337)_0x171db8['appendChild'](_0x1b8337);const _0x2b91a2=document['createElement'](_0x11cb59(0x1072));_0x2b91a2['style'][_0x11cb59(0x1d0)]=_0x11cb59(0xbe2),_0x2b91a2[_0x11cb59(0x1090)]=_0x11cb59(0xa0d),_0x171db8[_0x11cb59(0x31e)](_0x2b91a2);const _0x4921cc=document[_0x11cb59(0x8c2)](_0x11cb59(0x115b))[_0x11cb59(0x518)],_0x4bf99a=document[_0x11cb59(0x8c2)](_0x11cb59(0x8ff))[_0x11cb59(0x518)],_0x20a342=parseInt(document[_0x11cb59(0x8c2)](_0x11cb59(0x280))[_0x11cb59(0x518)])||0xa;_0x4921cc===_0x11cb59(0x9a4)?_0x2b91a2[_0x11cb59(0x842)][_0x11cb59(0x9a4)]=_0x20a342+'px':_0x2b91a2[_0x11cb59(0x842)][_0x11cb59(0xf2b)]=_0x20a342+'px';switch(_0x4bf99a){case _0x11cb59(0xe3a):_0x2b91a2[_0x11cb59(0x842)][_0x11cb59(0xe3a)]=_0x11cb59(0xd01);break;case _0x11cb59(0x36e):_0x2b91a2['style'][_0x11cb59(0x36e)]=_0x11cb59(0xd01);break;default:_0x2b91a2[_0x11cb59(0x842)][_0x11cb59(0xe3a)]=_0x11cb59(0x72f),_0x2b91a2[_0x11cb59(0x842)][_0x11cb59(0xb56)]=_0x11cb59(0xc41);break;}_0x51f7b6(_0x1be707,_0x11cb59(0x1081),_0x11cb59(0x767));}async function _0x28297a(){const _0x10f398=_0x18b51e;await _0x5bcced(),document[_0x10f398(0x8c2)](_0x10f398(0x119c))[_0x10f398(0xb17)][_0x10f398(0x3f4)](_0x10f398(0x2cd));}async function _0x5bcced(){const _0x24acc2=_0x18b51e,_0x14d146=document[_0x24acc2(0x8c2)](_0x24acc2(0xf06)),_0x53b266=await _0x15043e[_0x24acc2(0x232)][_0x24acc2(0x6be)]();_0x14d146[_0x24acc2(0xca0)]='',_0x53b266[_0x24acc2(0x105a)]===0x0&&(_0x14d146[_0x24acc2(0xca0)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>'),_0x53b266[_0x24acc2(0x7c0)](_0x1ce7e3=>{const _0x24143c=_0x24acc2,_0x1f0c71=document[_0x24143c(0x8c1)](_0x24143c(0x1072));_0x1f0c71[_0x24143c(0x84c)]=_0x24143c(0x376),_0x1f0c71[_0x24143c(0xca0)]=_0x24143c(0x1293)+_0x1ce7e3[_0x24143c(0x596)]+_0x24143c(0x5a9)+_0x1ce7e3['id']+_0x24143c(0x113a),_0x14d146[_0x24143c(0x31e)](_0x1f0c71);});}async function _0x1ecd34(){const _0x82ed8e=_0x18b51e,_0x5b8956=document['getElementById'](_0x82ed8e(0xb1a)),_0x151dab=_0x5b8956[_0x82ed8e(0x518)]['trim']();if(!_0x151dab){alert(_0x82ed8e(0x7b7));return;}const _0x3a97f9=await _0x15043e[_0x82ed8e(0x232)][_0x82ed8e(0xdb8)](_0x82ed8e(0x596))[_0x82ed8e(0xc9a)](_0x151dab)['first']();if(_0x3a97f9){alert(_0x82ed8e(0xf92)+_0x151dab+_0x82ed8e(0x415));return;}await _0x15043e[_0x82ed8e(0x232)][_0x82ed8e(0x3f4)]({'name':_0x151dab}),_0x5b8956['value']='',await _0x5bcced();}async function _0x3d2746(_0x576c32){const _0x3aa320=_0x18b51e,_0xd5fba5=await _0x8b9cb8(_0x3aa320(0xad9),'删除分组后，该组内的好友将变为“未分组”。确定要删除吗？',{'confirmButtonClass':'btn-danger'});if(_0xd5fba5){await _0x15043e[_0x3aa320(0x232)][_0x3aa320(0x89f)](_0x576c32);const _0x5bcf43=await _0x15043e['chats']['where']('groupId')['equals'](_0x576c32)[_0x3aa320(0x6be)]();for(const _0x5042c1 of _0x5bcf43){_0x5042c1[_0x3aa320(0x40f)]=null,await _0x15043e[_0x3aa320(0x799)]['put'](_0x5042c1);if(_0x405767[_0x3aa320(0x799)][_0x5042c1['id']])_0x405767[_0x3aa320(0x799)][_0x5042c1['id']]['groupId']=null;}await _0x5bcced();}}function _0x457c69(_0xd1b70b){const _0x14e2bf=_0x18b51e,_0x40c8de=_0x405767[_0x14e2bf(0x799)][_0x405767[_0x14e2bf(0x248)]];document[_0x14e2bf(0x8c2)]('publish-to-announcement-btn')[_0x14e2bf(0x842)][_0x14e2bf(0x5e9)]=_0x40c8de['isGroup']?_0x14e2bf(0xea7):_0x14e2bf(0xbf8);if(_0x324554)return;_0x39784f=_0xd1b70b,document['getElementById'](_0x14e2bf(0x5a7))[_0x14e2bf(0xb17)]['add'](_0x14e2bf(0x2cd));}function _0x152bc1(){const _0x48db1d=_0x18b51e;document[_0x48db1d(0x8c2)](_0x48db1d(0x5a7))['classList'][_0x48db1d(0xaff)]('visible'),_0x39784f=null;}async function _0x31e7a0(){const _0x2646ba=_0x18b51e;if(!_0x39784f)return;const _0x2170b4=_0x39784f,_0x1d126c=_0x405767[_0x2646ba(0x799)][_0x405767[_0x2646ba(0x248)]],_0x230030=_0x1d126c[_0x2646ba(0xd39)]['find'](_0x6fb114=>_0x6fb114[_0x2646ba(0x351)]===_0x2170b4);if(!_0x230030)return;_0x152bc1();let _0x5952ab;const _0x328589=_0x230030['type']&&[_0x2646ba(0xf64),'ai_image',_0x2646ba(0x11b9),_0x2646ba(0xda5)][_0x2646ba(0x773)](_0x230030['type']);if(_0x328589){let _0x5146b9={'type':_0x230030[_0x2646ba(0xde0)]};if(_0x230030['type']===_0x2646ba(0xf64))_0x5146b9[_0x2646ba(0x168)]=_0x230030[_0x2646ba(0x168)];else{if(_0x230030[_0x2646ba(0xde0)]===_0x2646ba(0x7c8))_0x5146b9[_0x2646ba(0x3ca)]=_0x230030[_0x2646ba(0x168)];else{if(_0x230030[_0x2646ba(0xde0)]===_0x2646ba(0x11b9))_0x5146b9['amount']=_0x230030[_0x2646ba(0x4c5)],_0x5146b9[_0x2646ba(0x113f)]=_0x230030[_0x2646ba(0x113f)];else _0x230030[_0x2646ba(0xde0)]===_0x2646ba(0xda5)&&(_0x5146b9[_0x2646ba(0xcea)]=_0x230030[_0x2646ba(0xcea)],_0x5146b9[_0x2646ba(0x3ca)]=_0x230030[_0x2646ba(0x3ca)],_0x5146b9['source_name']=_0x230030['source_name'],_0x5146b9['content']=_0x230030[_0x2646ba(0x168)]);}}_0x5952ab=JSON['stringify'](_0x5146b9,null,0x2);}else typeof _0x230030[_0x2646ba(0x168)]===_0x2646ba(0x7a5)?_0x5952ab=JSON[_0x2646ba(0x1175)](_0x230030[_0x2646ba(0x168)],null,0x2):_0x5952ab=_0x230030[_0x2646ba(0x168)];const _0x1ff209={'voice':{'type':_0x2646ba(0xf64),'content':_0x2646ba(0x9d0)},'image':{'type':_0x2646ba(0x7c8),'description':_0x2646ba(0x590)},'transfer':{'type':_0x2646ba(0x11b9),'amount':5.2,'note':_0x2646ba(0xa57)},'link':{'type':'share_link','title':_0x2646ba(0x9e3),'description':_0x2646ba(0x1068),'source_name':_0x2646ba(0xa94),'content':_0x2646ba(0x110c)}},_0x1419e3=_0x2646ba(0xebb)+JSON[_0x2646ba(0x1175)](_0x1ff209[_0x2646ba(0xba1)])+_0x2646ba(0x1014)+JSON[_0x2646ba(0x1175)](_0x1ff209[_0x2646ba(0xdab)])+'\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x2646ba(0x1175)](_0x1ff209['transfer'])+_0x2646ba(0x206)+JSON[_0x2646ba(0x1175)](_0x1ff209['link'])+_0x2646ba(0xbbf),_0x34b70f=await _0x180f74('编辑消息',_0x2646ba(0x41c),_0x5952ab,_0x2646ba(0x6c3),_0x1419e3);_0x34b70f!==null&&await _0x355f41(_0x2170b4,_0x34b70f,!![]);}async function _0x43542b(){const _0x9d6a57=_0x18b51e;if(!_0x39784f)return;const _0x9254fa=_0x405767[_0x9d6a57(0x799)][_0x405767['activeChatId']],_0x577d8e=_0x9254fa[_0x9d6a57(0xd39)][_0x9d6a57(0x2ef)](_0x2580f5=>_0x2580f5[_0x9d6a57(0x351)]===_0x39784f);if(!_0x577d8e)return;let _0x427f72;typeof _0x577d8e[_0x9d6a57(0x168)]==='object'?_0x427f72=JSON[_0x9d6a57(0x1175)](_0x577d8e[_0x9d6a57(0x168)]):_0x427f72=String(_0x577d8e[_0x9d6a57(0x168)]);try{await navigator[_0x9d6a57(0x252)][_0x9d6a57(0xd91)](_0x427f72),await _0x501c7b(_0x9d6a57(0xf97),_0x9d6a57(0x235));}catch(_0x40c02c){await _0x501c7b(_0x9d6a57(0x5c7),_0x9d6a57(0x533));}_0x152bc1();}async function _0x389346(){const _0xbcd97f=_0x18b51e;if(!_0x39784f)return;try{await navigator[_0xbcd97f(0x252)][_0xbcd97f(0xd91)](_0x39784f),await _0x501c7b(_0xbcd97f(0xf97),_0xbcd97f(0x9b8)+_0x39784f+'\x20已复制到剪贴板。');}catch(_0x3c3067){await _0x501c7b('复制失败',_0xbcd97f(0x533));}_0x152bc1();}function _0x3037a3(_0x6bf72b=''){const _0x16dd40=_0x18b51e,_0x10dbe1=document[_0x16dd40(0x8c1)](_0x16dd40(0x1072));_0x10dbe1[_0x16dd40(0x84c)]=_0x16dd40(0x122b);const _0x9cc4cf={'voice':{'type':_0x16dd40(0xf64),'content':_0x16dd40(0x9d0)},'image':{'type':'ai_image','description':_0x16dd40(0x590)},'transfer':{'type':_0x16dd40(0x11b9),'amount':5.2,'note':_0x16dd40(0xa57)},'link':{'type':_0x16dd40(0xda5),'title':_0x16dd40(0x9e3),'description':'文章摘要...','source_name':_0x16dd40(0xa94),'content':'文章完整内容...'},'offline':{'type':_0x16dd40(0xaac),'content':'「在这里输入对话内容」\x0a(在这里输入动作或环境描写)'},'quote':{'type':_0x16dd40(0x58a),'target_timestamp':0x499602d2,'reply_content':'在这里输入回复内容'}};return _0x10dbe1[_0x16dd40(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>'+_0x6bf72b+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x9cc4cf[_0x16dd40(0xba1)])+'\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x16dd40(0x1175)](_0x9cc4cf[_0x16dd40(0xdab)])+'\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x16dd40(0x1175)](_0x9cc4cf['transfer'])+'\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x16dd40(0x1175)](_0x9cc4cf[_0x16dd40(0xcc2)])+'\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x16dd40(0x1175)](_0x9cc4cf[_0x16dd40(0x11f0)])+'\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x9cc4cf['quote'])+_0x16dd40(0x3f3),_0x10dbe1['querySelector'](_0x16dd40(0xedb))['addEventListener'](_0x16dd40(0xa17),()=>{const _0x41315b=_0x16dd40;document[_0x41315b(0xa2d)]('.message-editor-block')[_0x41315b(0x105a)]>0x1?_0x10dbe1[_0x41315b(0xaff)]():alert(_0x41315b(0x102e));}),_0x10dbe1[_0x16dd40(0xa2d)](_0x16dd40(0x384))[_0x16dd40(0x7c0)](_0x4d58e9=>{const _0x2a545a=_0x16dd40;_0x4d58e9[_0x2a545a(0xae8)](_0x2a545a(0xa17),()=>{const _0x43cace=_0x2a545a,_0x18ec26=_0x4d58e9[_0x43cace(0x323)][_0x43cace(0x9db)],_0x4684d7=_0x10dbe1['querySelector'](_0x43cace(0x6c3));if(_0x18ec26&&_0x4684d7)try{const _0x65a9e=JSON[_0x43cace(0x10ab)](_0x18ec26);_0x4684d7['value']=JSON['stringify'](_0x65a9e,null,0x2),_0x4684d7[_0x43cace(0x10f7)]();}catch(_0x2bed22){console[_0x43cace(0x7a3)](_0x43cace(0xb01),_0x2bed22);}});}),_0x10dbe1;}function _0x23ebbe(){const _0x526691=_0x18b51e;if(!_0x39784f)return;const _0x1da252=_0x39784f,_0x19b9d7=_0x405767['chats'][_0x405767[_0x526691(0x248)]],_0x9cf449=_0x19b9d7[_0x526691(0xd39)][_0x526691(0x2ef)](_0x1e15d6=>_0x1e15d6[_0x526691(0x351)]===_0x1da252);if(!_0x9cf449)return;_0x152bc1();const _0x590be4=document[_0x526691(0x8c2)]('message-editor-modal'),_0x5e7fe6=document['getElementById']('message-editor-container');_0x5e7fe6[_0x526691(0xca0)]='';let _0x24a068;if(_0x9cf449['quote']){const _0x2c636d={'type':'quote_reply','target_timestamp':_0x9cf449[_0x526691(0x9d2)][_0x526691(0x351)],'reply_content':_0x9cf449[_0x526691(0x168)]};_0x24a068=JSON[_0x526691(0x1175)](_0x2c636d,null,0x2);}else{if(_0x9cf449[_0x526691(0xde0)]&&[_0x526691(0xf64),_0x526691(0x7c8),_0x526691(0x11b9),_0x526691(0xaac),_0x526691(0xda5)][_0x526691(0x773)](_0x9cf449[_0x526691(0xde0)])){let _0x400174={'type':_0x9cf449['type']};if(_0x9cf449['type']===_0x526691(0xf64))_0x400174[_0x526691(0x168)]=_0x9cf449[_0x526691(0x168)];else{if(_0x9cf449[_0x526691(0xde0)]===_0x526691(0x7c8))_0x400174[_0x526691(0x3ca)]=_0x9cf449['content'];else{if(_0x9cf449['type']===_0x526691(0x11b9))_0x400174[_0x526691(0x4c5)]=_0x9cf449['amount'],_0x400174[_0x526691(0x113f)]=_0x9cf449[_0x526691(0x113f)];else{if(_0x9cf449[_0x526691(0xde0)]==='offline_text')_0x9cf449[_0x526691(0x168)]?_0x400174[_0x526691(0x168)]=_0x9cf449['content']:(_0x400174[_0x526691(0x1028)]=_0x9cf449[_0x526691(0x1028)],_0x400174[_0x526691(0x3ca)]=_0x9cf449['description']);else _0x9cf449[_0x526691(0xde0)]==='share_link'&&(_0x400174[_0x526691(0xcea)]=_0x9cf449['title'],_0x400174['description']=_0x9cf449[_0x526691(0x3ca)],_0x400174[_0x526691(0xefa)]=_0x9cf449[_0x526691(0xefa)],_0x400174[_0x526691(0x168)]=_0x9cf449[_0x526691(0x168)]);}}}_0x24a068=JSON[_0x526691(0x1175)](_0x400174,null,0x2);}else typeof _0x9cf449[_0x526691(0x168)]===_0x526691(0x7a5)?_0x24a068=JSON[_0x526691(0x1175)](_0x9cf449[_0x526691(0x168)],null,0x2):_0x24a068=_0x9cf449[_0x526691(0x168)];}const _0x30cbfa=_0x3037a3(_0x24a068);_0x5e7fe6['appendChild'](_0x30cbfa);const _0x207293=document[_0x526691(0x8c2)](_0x526691(0xae1)),_0x50d580=_0x207293[_0x526691(0xac5)](!![]);_0x207293[_0x526691(0xe66)][_0x526691(0x56b)](_0x50d580,_0x207293),_0x50d580[_0x526691(0xae8)](_0x526691(0xa17),()=>{const _0x1a9f02=_0x526691,_0x5a2f5a=_0x3037a3();_0x5e7fe6[_0x1a9f02(0x31e)](_0x5a2f5a),_0x5a2f5a[_0x1a9f02(0x1ad)](_0x1a9f02(0x6c3))['focus']();});const _0x5aa043=document['getElementById']('cancel-advanced-editor-btn'),_0x40e592=_0x5aa043[_0x526691(0xac5)](!![]);_0x5aa043['parentNode'][_0x526691(0x56b)](_0x40e592,_0x5aa043),_0x40e592[_0x526691(0xae8)](_0x526691(0xa17),()=>{const _0xd07ba8=_0x526691;_0x590be4[_0xd07ba8(0xb17)][_0xd07ba8(0xaff)](_0xd07ba8(0x2cd));});const _0x2ba4a7=document[_0x526691(0x8c2)](_0x526691(0x25c)),_0x56f3e2=_0x2ba4a7['cloneNode'](!![]);_0x2ba4a7['parentNode'][_0x526691(0x56b)](_0x56f3e2,_0x2ba4a7),_0x56f3e2[_0x526691(0xae8)](_0x526691(0xa17),()=>{_0x355f41(_0x1da252);}),_0x590be4['classList'][_0x526691(0x3f4)](_0x526691(0x2cd));}async function _0x43542b(){const _0x211804=_0x18b51e;if(!_0x39784f)return;const _0x555046=_0x405767[_0x211804(0x799)][_0x405767['activeChatId']],_0x1373a3=_0x555046[_0x211804(0xd39)]['find'](_0x260d28=>_0x260d28[_0x211804(0x351)]===_0x39784f);if(!_0x1373a3)return;let _0x1eb583;if(_0x1373a3[_0x211804(0xde0)]==='offline_text')_0x1373a3[_0x211804(0x168)]?_0x1eb583=_0x1373a3['content']:_0x1eb583='「'+(_0x1373a3[_0x211804(0x1028)]||'')+'」\x0a'+(_0x1373a3[_0x211804(0x3ca)]||'');else typeof _0x1373a3[_0x211804(0x168)]===_0x211804(0x7a5)?_0x1eb583=JSON[_0x211804(0x1175)](_0x1373a3['content']):_0x1eb583=String(_0x1373a3[_0x211804(0x168)]);try{await navigator['clipboard']['writeText'](_0x1eb583),await _0x501c7b(_0x211804(0xf97),'消息内容已复制到剪贴板。');}catch(_0x587f2c){await _0x501c7b('复制失败',_0x211804(0x533));}_0x152bc1();}function _0x56cb18(_0x262d42){const _0x1a483d=_0x18b51e,_0x320a4a=_0x262d42[_0x1a483d(0x8c6)]();if(_0x320a4a[_0x1a483d(0xc7c)]('{')&&_0x320a4a[_0x1a483d(0x866)]('}'))try{const _0x18c06e=JSON[_0x1a483d(0x10ab)](_0x320a4a);if(_0x18c06e[_0x1a483d(0xde0)])return _0x18c06e;}catch(_0x22a425){}if(_0x3ba794[_0x1a483d(0x696)](_0x320a4a))return{'type':_0x1a483d(0x1ac),'content':_0x320a4a};return{'type':_0x1a483d(0xbc6),'content':_0x320a4a};}async function _0x355f41(_0x16b85b,_0x4009b5=null){const _0x5dbed0=_0x18b51e;if(!_0x16b85b)return;const _0x444282=_0x405767['chats'][_0x405767[_0x5dbed0(0x248)]],_0x88319b=_0x444282[_0x5dbed0(0xd39)][_0x5dbed0(0x1149)](_0x26dab4=>_0x26dab4[_0x5dbed0(0x351)]===_0x16b85b);if(_0x88319b===-0x1)return;const _0x37e5db=_0x444282[_0x5dbed0(0xd39)][_0x88319b];let _0x3deea9=[];const _0x4dca5b=_0x4009b5!==null?[_0x4009b5]:Array[_0x5dbed0(0x51a)](document[_0x5dbed0(0xa2d)](_0x5dbed0(0x90c)))['map'](_0x5cf4c0=>_0x5cf4c0[_0x5dbed0(0x518)]);for(const _0x3ab5cb of _0x4dca5b){if(!_0x3ab5cb[_0x5dbed0(0x8c6)]())continue;const _0x1b7b85=_0x56cb18(_0x3ab5cb['trim']()),_0x55184d={'role':_0x37e5db[_0x5dbed0(0x14a)],'senderName':_0x37e5db[_0x5dbed0(0x770)],'timestamp':_0x37e5db['timestamp']};switch(_0x1b7b85[_0x5dbed0(0xde0)]){case _0x5dbed0(0xbc6):_0x55184d['type']='text',_0x55184d[_0x5dbed0(0x168)]=_0x1b7b85['content'];break;case'offline_text':_0x55184d[_0x5dbed0(0xde0)]='offline_text';_0x1b7b85[_0x5dbed0(0x168)]?_0x55184d['content']=_0x1b7b85[_0x5dbed0(0x168)]:(_0x55184d['dialogue']=_0x1b7b85['dialogue'],_0x55184d['description']=_0x1b7b85[_0x5dbed0(0x3ca)]);break;case _0x5dbed0(0x58a):_0x55184d['type']=_0x5dbed0(0x58a),_0x55184d[_0x5dbed0(0x168)]=_0x1b7b85[_0x5dbed0(0xe6f)];const _0x3f49cd=_0x444282['history']['find'](_0x2d22c0=>_0x2d22c0['timestamp']===_0x1b7b85[_0x5dbed0(0x656)]);if(_0x3f49cd){let _0x5a71d0=_0x3f49cd[_0x5dbed0(0x770)];_0x3f49cd[_0x5dbed0(0x14a)]===_0x5dbed0(0x74b)&&(_0x5a71d0=_0x405767[_0x5dbed0(0x20a)][_0x5dbed0(0xab3)]||_0x5dbed0(0x2dc)),_0x55184d[_0x5dbed0(0x9d2)]={'timestamp':_0x1b7b85['target_timestamp'],'senderName':_0x5a71d0,'content':String(_0x3f49cd[_0x5dbed0(0x168)]||'')};}else _0x55184d[_0x5dbed0(0x9d2)]={'timestamp':_0x1b7b85[_0x5dbed0(0x656)],'senderName':_0x5dbed0(0x25d),'content':_0x5dbed0(0xbae)};break;case _0x5dbed0(0xf64):case _0x5dbed0(0x1ac):case _0x5dbed0(0x7c8):case _0x5dbed0(0x223):_0x55184d[_0x5dbed0(0xde0)]=_0x1b7b85[_0x5dbed0(0xde0)],_0x55184d[_0x5dbed0(0x168)]=_0x1b7b85[_0x5dbed0(0x168)]||_0x1b7b85[_0x5dbed0(0x3ca)];if(_0x1b7b85[_0x5dbed0(0x2b7)])_0x55184d[_0x5dbed0(0x2b7)]=_0x1b7b85[_0x5dbed0(0x2b7)];break;case'transfer':_0x55184d[_0x5dbed0(0xde0)]=_0x5dbed0(0x11b9),_0x55184d[_0x5dbed0(0x4c5)]=_0x1b7b85[_0x5dbed0(0x4c5)],_0x55184d['note']=_0x1b7b85[_0x5dbed0(0x113f)];break;case _0x5dbed0(0xda5):_0x55184d[_0x5dbed0(0xde0)]=_0x5dbed0(0xda5),_0x55184d[_0x5dbed0(0xcea)]=_0x1b7b85[_0x5dbed0(0xcea)],_0x55184d['description']=_0x1b7b85['description'],_0x55184d[_0x5dbed0(0xefa)]=_0x1b7b85[_0x5dbed0(0xefa)],_0x55184d[_0x5dbed0(0x168)]=_0x1b7b85[_0x5dbed0(0x168)];break;default:Object[_0x5dbed0(0xc28)](_0x55184d,_0x1b7b85);break;}_0x3deea9['push'](_0x55184d);}if(_0x3deea9[_0x5dbed0(0x105a)]===0x0){document[_0x5dbed0(0x8c2)](_0x5dbed0(0xeae))['classList'][_0x5dbed0(0xaff)](_0x5dbed0(0x2cd));return;}_0x444282[_0x5dbed0(0xd39)][_0x5dbed0(0x3e6)](_0x88319b,0x1,..._0x3deea9);let _0x1c2c7f=_0x16b85b;for(let _0x513adc=_0x88319b;_0x513adc<_0x444282[_0x5dbed0(0xd39)][_0x5dbed0(0x105a)];_0x513adc++){_0x444282[_0x5dbed0(0xd39)][_0x513adc]['timestamp']=_0x1c2c7f,_0x1c2c7f++;}await _0x15043e[_0x5dbed0(0x799)]['put'](_0x444282),document[_0x5dbed0(0x8c2)](_0x5dbed0(0xeae))['classList']['remove'](_0x5dbed0(0x2cd)),_0x7dbe71(_0x405767[_0x5dbed0(0x248)]),await _0x501c7b('成功',_0x5dbed0(0x124a));}function _0x34a1b0(_0x383b6e){const _0xbe05ef=_0x18b51e;_0x2338bf=_0x383b6e,document[_0xbe05ef(0x8c2)](_0xbe05ef(0x8db))[_0xbe05ef(0xb17)]['add'](_0xbe05ef(0x2cd));}function _0x599801(){const _0x3dec19=_0x18b51e;document[_0x3dec19(0x8c2)](_0x3dec19(0x8db))[_0x3dec19(0xb17)][_0x3dec19(0xaff)](_0x3dec19(0x2cd)),_0x2338bf=null;}async function _0x2513d5(){const _0x3daab8=_0x18b51e;if(!_0x2338bf)return;const _0x3af13d=_0x2338bf,_0x4aec41=await _0x15043e[_0x3daab8(0xcc0)]['get'](_0x3af13d);if(!_0x4aec41)return;_0x599801();let _0x1cc8d8;if(_0x4aec41[_0x3daab8(0xde0)]===_0x3daab8(0x11ce))_0x1cc8d8=_0x4aec41['content'];else{const _0x1869ed={'type':_0x4aec41[_0x3daab8(0xde0)],'publicText':_0x4aec41[_0x3daab8(0x55d)]||''};if(_0x4aec41[_0x3daab8(0xde0)]===_0x3daab8(0x7b5))_0x1869ed['imageUrl']=_0x4aec41['imageUrl'],_0x1869ed[_0x3daab8(0x845)]=_0x4aec41[_0x3daab8(0x845)];else _0x4aec41[_0x3daab8(0xde0)]==='text_image'&&(_0x1869ed['hiddenContent']=_0x4aec41[_0x3daab8(0x9eb)]);_0x1cc8d8=JSON['stringify'](_0x1869ed,null,0x2);}const _0x31e51c={'shuoshuo':_0x3daab8(0xa56),'image':{'type':_0x3daab8(0x7b5),'publicText':'','imageUrl':_0x3daab8(0xf37),'imageDescription':''},'text_image':{'type':_0x3daab8(0xe36),'publicText':'','hiddenContent':''}},_0x3f9290='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x3daab8(0x1175)](_0x31e51c[_0x3daab8(0xdab)])+_0x3daab8(0x9a7)+JSON[_0x3daab8(0x1175)](_0x31e51c[_0x3daab8(0xe36)])+_0x3daab8(0x396),_0x1f1ff6=await _0x180f74(_0x3daab8(0x94d),_0x3daab8(0xc1e),_0x1cc8d8,_0x3daab8(0x6c3),_0x3f9290);setTimeout(()=>{const _0x5cb929=_0x3daab8,_0x20f1bf=document[_0x5cb929(0x1ad)](_0x5cb929(0xdb5));_0x20f1bf&&_0x20f1bf[_0x5cb929(0xae8)](_0x5cb929(0xa17),()=>{const _0x50b65b=_0x5cb929,_0x78d022=document[_0x50b65b(0x8c2)](_0x50b65b(0x4de));_0x78d022['value']=_0x31e51c['shuoshuo'],_0x78d022[_0x50b65b(0x10f7)]();});},0x64),_0x1f1ff6!==null&&await _0xe8ec51(_0x3af13d,_0x1f1ff6);}async function _0xe8ec51(_0x17167b,_0x3444e6){const _0x2a6e51=_0x18b51e,_0x34c437=await _0x15043e['qzonePosts'][_0x2a6e51(0x3e9)](_0x17167b);if(!_0x34c437)return;const _0x2b3b02=_0x3444e6[_0x2a6e51(0x8c6)]();try{const _0x34507f=JSON[_0x2a6e51(0x10ab)](_0x2b3b02);_0x34c437['type']=_0x34507f[_0x2a6e51(0xde0)]||_0x2a6e51(0x7b5),_0x34c437['publicText']=_0x34507f[_0x2a6e51(0x55d)]||'',_0x34c437[_0x2a6e51(0x10d4)]=_0x34507f[_0x2a6e51(0x10d4)]||'',_0x34c437[_0x2a6e51(0x845)]=_0x34507f[_0x2a6e51(0x845)]||'',_0x34c437[_0x2a6e51(0x9eb)]=_0x34507f[_0x2a6e51(0x9eb)]||'',_0x34c437[_0x2a6e51(0x168)]='';}catch(_0x452dfe){_0x34c437['type']=_0x2a6e51(0x11ce),_0x34c437[_0x2a6e51(0x168)]=_0x2b3b02,_0x34c437[_0x2a6e51(0x55d)]='',_0x34c437['imageUrl']='',_0x34c437[_0x2a6e51(0x845)]='',_0x34c437[_0x2a6e51(0x9eb)]='';}await _0x15043e[_0x2a6e51(0xcc0)][_0x2a6e51(0xfaa)](_0x34c437),await _0xa34c48(),await _0x501c7b('成功','动态已更新！');}async function _0xbc5169(){const _0x190bd6=_0x18b51e;if(!_0x2338bf)return;const _0x17b37f=await _0x15043e[_0x190bd6(0xcc0)][_0x190bd6(0x3e9)](_0x2338bf);if(!_0x17b37f)return;let _0x388a93=_0x17b37f['content']||_0x17b37f[_0x190bd6(0x55d)]||_0x17b37f['hiddenContent']||_0x17b37f[_0x190bd6(0x845)]||'（无文字内容）';try{await navigator[_0x190bd6(0x252)][_0x190bd6(0xd91)](_0x388a93),await _0x501c7b('复制成功','动态内容已复制到剪贴板。');}catch(_0x567c31){await _0x501c7b('复制失败',_0x190bd6(0x533));}_0x599801();}let _0x45a6e8=new Set();async function _0x555ccb(){const _0x52f9c3=_0x18b51e,_0x4e9b01=await _0x40fef8(_0x52f9c3(0x31d),[{'text':_0x52f9c3(0xe2d),'value':_0x52f9c3(0x720)},{'text':'创建旁观群聊\x20(我围观)','value':'spectator'}]);if(_0x4e9b01===_0x52f9c3(0x720)){_0x45a6e8[_0x52f9c3(0xa6a)]();const _0x1ba800=document['getElementById'](_0x52f9c3(0xa5d)),_0x51655a=_0x1ba800[_0x52f9c3(0xac5)](!![]);_0x1ba800[_0x52f9c3(0xe66)][_0x52f9c3(0x56b)](_0x51655a,_0x1ba800),_0x51655a[_0x52f9c3(0xae8)](_0x52f9c3(0xa17),_0x2446a9),await _0x2b3b7f(),_0x3d1990(_0x52f9c3(0x570));}else _0x4e9b01===_0x52f9c3(0xf94)&&_0x15e4ea();}async function _0x15e4ea(){const _0x2e8703=_0x18b51e;_0x45a6e8[_0x2e8703(0xa6a)]();const _0x3f21d5=document[_0x2e8703(0x8c2)](_0x2e8703(0xa5d)),_0x8ee02b=_0x3f21d5['cloneNode'](!![]);_0x3f21d5[_0x2e8703(0xe66)][_0x2e8703(0x56b)](_0x8ee02b,_0x3f21d5),_0x8ee02b[_0x2e8703(0xae8)](_0x2e8703(0xa17),_0x1cb605),await _0x3fc4e9(),_0x3d1990(_0x2e8703(0x570));}async function _0x3fc4e9(){const _0x3ed511=_0x18b51e,_0x53aca1=document[_0x3ed511(0x8c2)](_0x3ed511(0xad1));_0x53aca1['innerHTML']='';const _0x32b7e5=Object[_0x3ed511(0x22f)](_0x405767[_0x3ed511(0x799)])[_0x3ed511(0x1d8)](_0x158b2d=>!_0x158b2d['isGroup']),_0x48c465=await _0x15043e[_0x3ed511(0xa4a)][_0x3ed511(0x6be)]();if(_0x32b7e5[_0x3ed511(0x105a)]===0x0&&_0x48c465['length']===0x0){_0x53aca1[_0x3ed511(0xca0)]=_0x3ed511(0x1120);return;}_0x32b7e5[_0x3ed511(0x7c0)](_0x3b9cd7=>{const _0x4557ad=_0x3ed511,_0x5a40e1=document['createElement'](_0x4557ad(0x1072));_0x5a40e1[_0x4557ad(0x84c)]=_0x4557ad(0xc25),_0x5a40e1[_0x4557ad(0x323)][_0x4557ad(0x24b)]=_0x3b9cd7['id'],_0x5a40e1['innerHTML']=_0x4557ad(0x997)+(_0x3b9cd7[_0x4557ad(0x33a)]['aiAvatar']||_0x49d2a4)+_0x4557ad(0x11c6)+_0x3b9cd7[_0x4557ad(0x596)]+_0x4557ad(0x6d0),_0x53aca1[_0x4557ad(0x31e)](_0x5a40e1);}),_0x48c465[_0x3ed511(0x7c0)](_0x1e61a4=>{const _0xd8b643=_0x3ed511,_0x26ec92=document['createElement'](_0xd8b643(0x1072));_0x26ec92['className']='contact-picker-item',_0x26ec92['dataset']['contactId']=_0x1e61a4['id'],_0x26ec92[_0xd8b643(0x323)][_0xd8b643(0x10f2)]=_0xd8b643(0x7dd),_0x26ec92[_0xd8b643(0xca0)]=_0xd8b643(0x997)+(_0x1e61a4[_0xd8b643(0x1e1)]||_0x9fdc61)+_0xd8b643(0x11c6)+_0x1e61a4['name']+'\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x53aca1[_0xd8b643(0x31e)](_0x26ec92);}),_0x1526cb();}async function _0x1cb605(){const _0x555711=_0x18b51e;if(_0x45a6e8['size']<0x2){alert('旁观群聊至少需要选择2个成员。');return;}const _0x5cd185=await _0x180f74('设置群名',_0x555711(0x1de),'AI们的茶话会');if(!_0x5cd185||!_0x5cd185[_0x555711(0x8c6)]())return;const _0x14e29e='group_'+Date[_0x555711(0x1ed)](),_0x22b887=[],_0x178aea=await _0x15043e['npcs'][_0x555711(0x6be)]();for(const _0x3824c5 of _0x45a6e8){const _0x2cac7c=document['querySelector'](_0x555711(0x1dd)+_0x3824c5+'\x22]')[_0x555711(0x323)][_0x555711(0x10f2)]===_0x555711(0x7dd);if(_0x2cac7c){const _0x5156c1=_0x178aea[_0x555711(0x2ef)](_0x4eed82=>_0x4eed82['id']===parseInt(_0x3824c5));_0x5156c1&&_0x22b887[_0x555711(0xa49)]({'id':'npc_'+_0x5156c1['id'],'originalName':_0x5156c1[_0x555711(0x596)],'groupNickname':_0x5156c1[_0x555711(0x596)],'persona':_0x5156c1[_0x555711(0x391)],'avatar':_0x5156c1[_0x555711(0x1e1)]||_0x9fdc61,'isNpc':!![]});}else{const _0x416e38=_0x405767[_0x555711(0x799)][_0x3824c5];_0x416e38&&_0x22b887['push']({'id':_0x3824c5,'originalName':_0x416e38[_0x555711(0x4e7)],'groupNickname':_0x416e38[_0x555711(0x596)],'persona':_0x416e38[_0x555711(0x33a)][_0x555711(0x1060)],'avatar':_0x416e38[_0x555711(0x33a)][_0x555711(0x44e)]||_0x49d2a4,'isNpc':![]});}}const _0x507764={'id':_0x14e29e,'name':_0x5cd185[_0x555711(0x8c6)](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x22b887,'settings':{'maxMemory':0xa,'groupAvatar':_0x56835c,'background':'','theme':_0x555711(0x674),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':_0x555711(0x46c),'content':_0x555711(0xb71),'timestamp':Date[_0x555711(0x1ed)](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x405767[_0x555711(0x799)][_0x14e29e]=_0x507764,await _0x15043e['chats'][_0x555711(0xfaa)](_0x507764),await _0x2b55d1(),_0x3d1990(_0x555711(0x3b7)),_0x426b8d(_0x14e29e);}async function _0x2b3b7f(){const _0x3a3894=_0x18b51e,_0x3789c4=document[_0x3a3894(0x8c2)](_0x3a3894(0xad1));_0x3789c4[_0x3a3894(0xca0)]='';const _0x4b170b=Object[_0x3a3894(0x22f)](_0x405767[_0x3a3894(0x799)])[_0x3a3894(0x1d8)](_0x122357=>!_0x122357[_0x3a3894(0x1000)]),_0x2e255a=await _0x15043e[_0x3a3894(0xa4a)][_0x3a3894(0x6be)]();if(_0x4b170b[_0x3a3894(0x105a)]===0x0&&_0x2e255a['length']===0x0){_0x3789c4[_0x3a3894(0xca0)]=_0x3a3894(0x880);return;}_0x4b170b[_0x3a3894(0x7c0)](_0x571582=>{const _0x35ef82=_0x3a3894,_0x3a2ea4=document[_0x35ef82(0x8c1)](_0x35ef82(0x1072));_0x3a2ea4['className']='contact-picker-item',_0x3a2ea4[_0x35ef82(0x323)]['contactId']=_0x571582['id'],_0x3a2ea4['innerHTML']=_0x35ef82(0x997)+(_0x571582[_0x35ef82(0x33a)][_0x35ef82(0x44e)]||_0x49d2a4)+_0x35ef82(0x11c6)+_0x571582['name']+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x3789c4[_0x35ef82(0x31e)](_0x3a2ea4);}),_0x2e255a[_0x3a3894(0x7c0)](_0x4335b3=>{const _0x43bfb7=_0x3a3894,_0xc9243b=document[_0x43bfb7(0x8c1)](_0x43bfb7(0x1072));_0xc9243b[_0x43bfb7(0x84c)]='contact-picker-item',_0xc9243b[_0x43bfb7(0x323)][_0x43bfb7(0x24b)]=_0x43bfb7(0x5ea)+_0x4335b3['id'],_0xc9243b[_0x43bfb7(0xca0)]=_0x43bfb7(0x997)+(_0x4335b3[_0x43bfb7(0x1e1)]||_0x9fdc61)+_0x43bfb7(0x11c6)+_0x4335b3[_0x43bfb7(0x596)]+_0x43bfb7(0xc8d),_0x3789c4[_0x43bfb7(0x31e)](_0xc9243b);}),_0x1526cb();}function _0x1526cb(){const _0x5a8ea2=_0x18b51e,_0x43885c=document['getElementById'](_0x5a8ea2(0xa5d));_0x43885c[_0x5a8ea2(0x1090)]='完成('+_0x45a6e8[_0x5a8ea2(0xf72)]+')',_0x43885c[_0x5a8ea2(0x1033)]=_0x45a6e8[_0x5a8ea2(0xf72)]<0x2;}async function _0x2446a9(){const _0x18eeda=_0x18b51e;if(_0x45a6e8[_0x18eeda(0xf72)]<0x2){alert('创建群聊至少需要选择2个联系人。');return;}const _0x2f5b17=await _0x180f74('设置群名','请输入群聊的名字',_0x18eeda(0xede));if(!_0x2f5b17||!_0x2f5b17['trim']())return;const _0x309338=_0x18eeda(0x7c4)+Date['now'](),_0x46cb1a=[],_0x29fef0=await _0x15043e['npcs'][_0x18eeda(0x6be)]();for(const _0x58ab35 of _0x45a6e8){if(_0x58ab35[_0x18eeda(0xc7c)](_0x18eeda(0x5ea))){const _0x2a58fc=parseInt(_0x58ab35['replace'](_0x18eeda(0x5ea),'')),_0x2602a4=_0x29fef0[_0x18eeda(0x2ef)](_0x446856=>_0x446856['id']===_0x2a58fc);_0x2602a4&&_0x46cb1a[_0x18eeda(0xa49)]({'id':_0x58ab35,'originalName':_0x2602a4[_0x18eeda(0x596)],'groupNickname':_0x2602a4['name'],'persona':_0x2602a4[_0x18eeda(0x391)],'avatar':_0x2602a4[_0x18eeda(0x1e1)]||_0x9fdc61,'isNpc':!![]});}else{const _0x598c58=_0x405767[_0x18eeda(0x799)][_0x58ab35];_0x598c58&&_0x46cb1a['push']({'id':_0x58ab35,'originalName':_0x598c58['originalName'],'groupNickname':_0x598c58[_0x18eeda(0x596)],'persona':_0x598c58[_0x18eeda(0x33a)]['aiPersona'],'avatar':_0x598c58[_0x18eeda(0x33a)]['aiAvatar']||_0x49d2a4,'isNpc':![]});}}const _0x55b02a={'id':_0x309338,'name':_0x2f5b17[_0x18eeda(0x8c6)](),'isGroup':!![],'members':_0x46cb1a,'settings':{'myPersona':_0x18eeda(0xdfa),'myNickname':'我','maxMemory':0xa,'groupAvatar':_0x56835c,'myAvatar':_0x38e728,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x405767[_0x18eeda(0x799)][_0x309338]=_0x55b02a,await _0x15043e[_0x18eeda(0x799)][_0x18eeda(0xfaa)](_0x55b02a),await _0x2b55d1(),_0x3d1990(_0x18eeda(0x3b7)),_0x426b8d(_0x309338);}function _0x9f9279(){const _0x52c34b=_0x18b51e;if(!_0x405767['activeChatId']||!_0x405767[_0x52c34b(0x799)][_0x405767[_0x52c34b(0x248)]][_0x52c34b(0x1000)])return;_0x1befc2(),_0x3d1990(_0x52c34b(0x8b7));}function _0x1befc2(){const _0x15965b=_0x18b51e,_0x546120=document['getElementById'](_0x15965b(0x64b)),_0x377e79=_0x405767[_0x15965b(0x799)][_0x405767[_0x15965b(0x248)]];_0x546120['innerHTML']='',_0x377e79[_0x15965b(0x635)]['forEach'](_0x4568e5=>{const _0x20fb6b=_0x15965b,_0x5a8d31=document[_0x20fb6b(0x8c1)](_0x20fb6b(0x1072));_0x5a8d31[_0x20fb6b(0x84c)]=_0x20fb6b(0xb0c),_0x5a8d31[_0x20fb6b(0xca0)]=_0x20fb6b(0x3c6)+_0x4568e5[_0x20fb6b(0x1e1)]+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x4568e5[_0x20fb6b(0x375)]+_0x20fb6b(0x58d)+_0x4568e5['id']+_0x20fb6b(0x1268),_0x546120[_0x20fb6b(0x31e)](_0x5a8d31);});}async function _0x2ebc2f(_0x324a5e){const _0x2a372b=_0x18b51e,_0x1dfe23=_0x405767[_0x2a372b(0x799)][_0x405767[_0x2a372b(0x248)]],_0x328bb6=_0x1dfe23[_0x2a372b(0x635)][_0x2a372b(0x1149)](_0x178e23=>_0x178e23['id']===_0x324a5e);if(_0x328bb6===-0x1)return;if(_0x1dfe23[_0x2a372b(0x635)][_0x2a372b(0x105a)]<=0x2){alert('群聊人数不能少于2人。');return;}const _0x4a2390=_0x1dfe23['members'][_0x328bb6][_0x2a372b(0x375)],_0x175735=await _0x8b9cb8('移出成员',_0x2a372b(0x1078)+_0x4a2390+_0x2a372b(0xa31),{'confirmButtonClass':_0x2a372b(0xe2a)});_0x175735&&(_0x1dfe23['members'][_0x2a372b(0x3e6)](_0x328bb6,0x1),await _0x15043e[_0x2a372b(0x799)][_0x2a372b(0xfaa)](_0x1dfe23),_0x1befc2(),document[_0x2a372b(0x8c2)](_0x2a372b(0x2fc))[_0x2a372b(0xa17)]());}async function _0x1aae64(){const _0x3ddd12=_0x18b51e,_0x3c4d0e=document[_0x3ddd12(0x8c2)](_0x3ddd12(0xa5d)),_0x2ba61f=_0x3c4d0e[_0x3ddd12(0xac5)](!![]);_0x3c4d0e[_0x3ddd12(0xe66)]['replaceChild'](_0x2ba61f,_0x3c4d0e),_0x2ba61f['addEventListener'](_0x3ddd12(0xa17),_0x350faf),await _0x268e0(),_0x3d1990('contact-picker-screen');}async function _0x268e0(){const _0x2e2868=_0x18b51e,_0x173752=document[_0x2e2868(0x8c2)](_0x2e2868(0xad1));_0x173752[_0x2e2868(0xca0)]='',_0x45a6e8['clear']();const _0x411355=_0x405767[_0x2e2868(0x799)][_0x405767[_0x2e2868(0x248)]],_0x18a345=new Set(_0x411355[_0x2e2868(0x635)]['map'](_0x2a1302=>_0x2a1302['id'])),_0x2a5882=Object[_0x2e2868(0x22f)](_0x405767['chats'])[_0x2e2868(0x1d8)](_0x10b35e=>!_0x10b35e['isGroup']&&!_0x18a345[_0x2e2868(0x11ac)](_0x10b35e['id'])),_0x2fe4cb=(await _0x15043e[_0x2e2868(0xa4a)]['toArray']())[_0x2e2868(0x1d8)](_0x2144e8=>!_0x18a345[_0x2e2868(0x11ac)](_0x2e2868(0x5ea)+_0x2144e8['id']));_0x2a5882[_0x2e2868(0x105a)]===0x0&&_0x2fe4cb[_0x2e2868(0x105a)]===0x0?(_0x173752['innerHTML']=_0x2e2868(0x139),document[_0x2e2868(0x8c2)]('confirm-contact-picker-btn')[_0x2e2868(0x842)][_0x2e2868(0x5e9)]=_0x2e2868(0xbf8)):(document[_0x2e2868(0x8c2)](_0x2e2868(0xa5d))[_0x2e2868(0x842)][_0x2e2868(0x5e9)]=_0x2e2868(0xea7),_0x2a5882[_0x2e2868(0x7c0)](_0x2941b0=>{const _0x5d905f=_0x2e2868,_0x5e2245=document[_0x5d905f(0x8c1)](_0x5d905f(0x1072));_0x5e2245[_0x5d905f(0x84c)]=_0x5d905f(0xc25),_0x5e2245[_0x5d905f(0x323)][_0x5d905f(0x24b)]=_0x2941b0['id'],_0x5e2245[_0x5d905f(0x323)]['contactType']=_0x5d905f(0xd16),_0x5e2245[_0x5d905f(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x2941b0[_0x5d905f(0x33a)][_0x5d905f(0x44e)]||_0x49d2a4)+_0x5d905f(0x29e)+_0x2941b0[_0x5d905f(0x596)]+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x173752[_0x5d905f(0x31e)](_0x5e2245);}),_0x2fe4cb['forEach'](_0x3973a4=>{const _0x1d5fa7=_0x2e2868,_0x27455b=document[_0x1d5fa7(0x8c1)](_0x1d5fa7(0x1072));_0x27455b[_0x1d5fa7(0x84c)]=_0x1d5fa7(0xc25),_0x27455b['dataset'][_0x1d5fa7(0x24b)]=_0x1d5fa7(0x5ea)+_0x3973a4['id'],_0x27455b[_0x1d5fa7(0x323)][_0x1d5fa7(0xbe4)]=_0x1d5fa7(0x566),_0x27455b[_0x1d5fa7(0x323)][_0x1d5fa7(0x91a)]=_0x3973a4['id'],_0x27455b[_0x1d5fa7(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x3973a4['avatar']||_0x9fdc61)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x3973a4[_0x1d5fa7(0x596)]+_0x1d5fa7(0x9aa),_0x173752['appendChild'](_0x27455b);})),_0x1526cb();}async function _0x350faf(){const _0x4d58a4=_0x18b51e;if(_0x45a6e8[_0x4d58a4(0xf72)]===0x0){alert(_0x4d58a4(0x1e3));return;}const _0x55a972=_0x405767[_0x4d58a4(0x799)][_0x405767[_0x4d58a4(0x248)]],_0x724e94=await _0x15043e[_0x4d58a4(0xa4a)][_0x4d58a4(0x6be)]();for(const _0x2a7743 of _0x45a6e8){const _0x2bcc14=document['querySelector'](_0x4d58a4(0x1dd)+_0x2a7743+'\x22]');if(!_0x2bcc14)continue;const _0x1dfdfc=_0x2bcc14[_0x4d58a4(0x323)][_0x4d58a4(0xbe4)];if(_0x1dfdfc===_0x4d58a4(0xd16)){const _0x20239c=_0x405767[_0x4d58a4(0x799)][_0x2a7743];_0x20239c&&_0x55a972[_0x4d58a4(0x635)]['push']({'id':_0x2a7743,'originalName':_0x20239c[_0x4d58a4(0x4e7)],'groupNickname':_0x20239c[_0x4d58a4(0x596)],'persona':_0x20239c[_0x4d58a4(0x33a)][_0x4d58a4(0x1060)],'avatar':_0x20239c[_0x4d58a4(0x33a)]['aiAvatar']||_0x49d2a4,'isNpc':![]});}else{if(_0x1dfdfc==='npc'){const _0x533037=parseInt(_0x2bcc14[_0x4d58a4(0x323)][_0x4d58a4(0x91a)]),_0x88a305=_0x724e94['find'](_0x2ef1a0=>_0x2ef1a0['id']===_0x533037);_0x88a305&&_0x55a972[_0x4d58a4(0x635)][_0x4d58a4(0xa49)]({'id':_0x4d58a4(0x5ea)+_0x533037,'originalName':_0x88a305['name'],'groupNickname':_0x88a305[_0x4d58a4(0x596)],'persona':_0x88a305[_0x4d58a4(0x391)],'avatar':_0x88a305['avatar']||_0x9fdc61,'isNpc':!![]});}}}await _0x15043e['chats'][_0x4d58a4(0xfaa)](_0x55a972),_0x9f9279();}function _0x4c65fa(){_0x2db465=!![],_0x2a7a98(null);}function _0x3b31a1(_0x46f5d6,_0x14ce7e){const _0x45c594=setInterval(()=>{const _0x382a49=_0x7a65,_0x6e1e5b=Date[_0x382a49(0x1ed)](),_0x908a8f=_0x14ce7e-_0x6e1e5b;if(_0x908a8f<0x0){clearInterval(_0x45c594),_0x46f5d6[_0x382a49(0xca0)]='<span>已</span><span>超</span><span>时</span>';return;}const _0x380762=Math[_0x382a49(0x10b2)](_0x908a8f%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x41f465=Math[_0x382a49(0x10b2)](_0x908a8f%(0x3e8*0x3c)/0x3e8),_0x496178=String(_0x380762)[_0x382a49(0xc89)](0x2,'0'),_0x55beff=String(_0x41f465)[_0x382a49(0xc89)](0x2,'0');_0x46f5d6[_0x382a49(0xca0)]=_0x382a49(0x494)+_0x496178['charAt'](0x0)+_0x382a49(0x75b)+_0x496178[_0x382a49(0xde3)](0x1)+'</span>\x20:\x20<span>'+_0x55beff[_0x382a49(0xde3)](0x0)+_0x382a49(0x75b)+_0x55beff[_0x382a49(0xde3)](0x1)+_0x382a49(0x688);},0x3e8);return _0x45c594;}function _0x579bb3(){for(const _0x2c6e7b in _0x4fd4bd){clearInterval(_0x4fd4bd[_0x2c6e7b]);}_0x4fd4bd={};}async function _0x10ee62(_0x434f20){const _0x22dd82=_0x18b51e,_0x37ec4e=_0x405767[_0x22dd82(0x799)][_0x405767[_0x22dd82(0x248)]];if(!_0x37ec4e)return;const _0x24e911=_0x37ec4e[_0x22dd82(0xd39)][_0x22dd82(0x2ef)](_0xb53bcf=>_0xb53bcf[_0x22dd82(0x351)]===_0x434f20);if(!_0x24e911||![_0x22dd82(0x11b2),_0x22dd82(0x1061)][_0x22dd82(0x773)](_0x24e911[_0x22dd82(0xde0)])){console['error']('showWaimaiDetails:\x20找不到消息或消息类型不正确',_0x434f20);return;}let _0x31eabd='';if(_0x24e911[_0x22dd82(0xde0)]==='waimai_request'){let _0x1caa93;switch(_0x24e911['status']){case _0x22dd82(0x1279):const _0x5c6227=_0x24e911[_0x22dd82(0xa89)]||'对方',_0x23e612=_0x1ba34a(_0x37ec4e,_0x5c6227);_0x1caa93='由\x20'+_0x23e612+'\x20为您代付成功';break;case _0x22dd82(0x23e):_0x1caa93=_0x22dd82(0x2ce);break;default:_0x1caa93='等待对方处理';break;}_0x31eabd=_0x22dd82(0x5fa)+_0x24e911[_0x22dd82(0xc7a)]+_0x22dd82(0xd49)+Number(_0x24e911[_0x22dd82(0x4c5)])[_0x22dd82(0x3c1)](0x2)+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20'+_0x1caa93+_0x22dd82(0xf5b);}else{if(_0x24e911['type']==='waimai_order'){let _0x2708a5,_0x58b13d;_0x37ec4e[_0x22dd82(0x1000)]?(_0x2708a5=_0x1ba34a(_0x37ec4e,_0x24e911[_0x22dd82(0x770)]),_0x58b13d=_0x1ba34a(_0x37ec4e,_0x24e911[_0x22dd82(0x69f)])):_0x24e911[_0x22dd82(0x14a)]==='user'?(_0x2708a5=_0x37ec4e[_0x22dd82(0x33a)]['myNickname']||'我',_0x58b13d=_0x37ec4e[_0x22dd82(0x596)]):(_0x2708a5=_0x37ec4e['name'],_0x58b13d=_0x37ec4e[_0x22dd82(0x33a)][_0x22dd82(0xe16)]||'我'),_0x31eabd=_0x22dd82(0xdb4)+_0x2708a5+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20'+_0x58b13d+_0x22dd82(0x3c3)+_0x24e911[_0x22dd82(0xc7a)]+_0x22dd82(0xd49)+Number(_0x24e911['amount'])[_0x22dd82(0x3c1)](0x2)+_0x22dd82(0xf5b);}}await _0x501c7b(_0x22dd82(0xa22),_0x31eabd);}async function _0x253ee0(_0x20d302,_0x25ef2e){const _0x31cb8b=_0x18b51e,_0x159889=_0x405767[_0x31cb8b(0x799)][_0x405767['activeChatId']];if(!_0x159889)return;const _0x22d009=_0x159889[_0x31cb8b(0xd39)][_0x31cb8b(0x1149)](_0x311bf4=>_0x311bf4[_0x31cb8b(0x351)]===_0x20d302);if(_0x22d009===-0x1)return;const _0x567759=_0x159889[_0x31cb8b(0xd39)][_0x22d009];_0x567759[_0x31cb8b(0x8c8)]=_0x25ef2e;let _0x4b13f6;const _0x374793=_0x159889['isGroup']?_0x159889['settings']['myNickname']||'我':'我';_0x25ef2e===_0x31cb8b(0x1279)?(_0x567759[_0x31cb8b(0xa89)]=_0x374793,_0x4b13f6='[系统提示：你\x20('+_0x374793+_0x31cb8b(0xe67)+_0x567759['senderName']+_0x31cb8b(0xece)+_0x20d302+_0x31cb8b(0x4a8)):_0x4b13f6=_0x31cb8b(0x346)+_0x374793+_0x31cb8b(0xe3c)+_0x567759['senderName']+_0x31cb8b(0xd27)+_0x20d302+_0x31cb8b(0x83f);const _0x9de8d0={'role':'system','content':_0x4b13f6,'timestamp':Date[_0x31cb8b(0x1ed)](),'isHidden':!![]};_0x159889[_0x31cb8b(0xd39)][_0x31cb8b(0xa49)](_0x9de8d0),await _0x15043e[_0x31cb8b(0x799)][_0x31cb8b(0xfaa)](_0x159889),_0x7dbe71(_0x405767[_0x31cb8b(0x248)]);}let _0x49beae={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x3b1534=null;async function _0xb611f0(){const _0x333516=_0x18b51e;if(!_0x405767[_0x333516(0x248)]||_0x49beae[_0x333516(0x6f0)]||_0x49beae[_0x333516(0x324)])return;const _0x339237=_0x405767[_0x333516(0x799)][_0x405767[_0x333516(0x248)]];_0x49beae[_0x333516(0x390)]=_0x339237[_0x333516(0x1000)],_0x49beae[_0x333516(0x324)]=!![],_0x49beae[_0x333516(0xf70)]=_0x333516(0x74b),_0x49beae[_0x333516(0x248)]=_0x339237['id'],_0x49beae[_0x333516(0x7d0)]=!![];_0x339237[_0x333516(0x1000)]?(document[_0x333516(0x8c2)](_0x333516(0x97c))[_0x333516(0x939)]=_0x339237[_0x333516(0x33a)]['myAvatar']||_0x38e728,document[_0x333516(0x8c2)](_0x333516(0x9b1))[_0x333516(0x1090)]=_0x339237[_0x333516(0x33a)][_0x333516(0xe16)]||'我'):(document[_0x333516(0x8c2)](_0x333516(0x97c))[_0x333516(0x939)]=_0x339237[_0x333516(0x33a)][_0x333516(0x44e)]||_0x49d2a4,document[_0x333516(0x8c2)](_0x333516(0x9b1))[_0x333516(0x1090)]=_0x339237[_0x333516(0x596)]);document[_0x333516(0x1ad)](_0x333516(0x6c0))['textContent']=_0x339237['isGroup']?_0x333516(0x121b):_0x333516(0xf3e),_0x3d1990(_0x333516(0x322));const _0x37b228={'role':_0x333516(0x46c),'content':_0x339237[_0x333516(0x1000)]?_0x333516(0x5e1)+(_0x339237[_0x333516(0x33a)][_0x333516(0xe16)]||'我')+_0x333516(0x1104):_0x333516(0x11dd),'timestamp':Date[_0x333516(0x1ed)](),'isHidden':!![]};_0x339237[_0x333516(0xd39)][_0x333516(0xa49)](_0x37b228),await _0x15043e[_0x333516(0x799)][_0x333516(0xfaa)](_0x339237),await _0x523815();}function _0x543413(){const _0x1bbb48=_0x18b51e,_0x3ec5d9=_0x405767[_0x1bbb48(0x799)][_0x49beae['activeChatId']];if(!_0x3ec5d9)return;_0x49beae[_0x1bbb48(0x6f0)]=!![],_0x49beae[_0x1bbb48(0x324)]=![],_0x49beae[_0x1bbb48(0x95d)]=Date['now'](),_0x49beae[_0x1bbb48(0x61d)]=[];const _0x3cd3ba=_0x3ec5d9[_0x1bbb48(0xd39)]['slice'](-0xa);_0x49beae[_0x1bbb48(0x796)]=_0x3cd3ba[_0x1bbb48(0x6b9)](_0x25b0c9=>{const _0x43d3f6=_0x1bbb48,_0x292784=_0x25b0c9['role']===_0x43d3f6(0x74b)?_0x3ec5d9[_0x43d3f6(0x33a)][_0x43d3f6(0xe16)]||'我':_0x25b0c9[_0x43d3f6(0x770)]||_0x3ec5d9[_0x43d3f6(0x596)];return _0x292784+':\x20'+String(_0x25b0c9[_0x43d3f6(0x168)])[_0x43d3f6(0x599)](0x0,0x32)+_0x43d3f6(0x388);})[_0x1bbb48(0xb2c)]('\x0a'),_0x47e905(),document['getElementById']('video-call-main')[_0x1bbb48(0xca0)]='<em>'+(_0x49beae[_0x1bbb48(0x390)]?_0x1bbb48(0x677):_0x1bbb48(0xdec))+_0x1bbb48(0xbcb),_0x3d1990(_0x1bbb48(0x110b)),document[_0x1bbb48(0x8c2)](_0x1bbb48(0x1130))[_0x1bbb48(0x842)][_0x1bbb48(0x5e9)]=_0x49beae[_0x1bbb48(0x7d0)]?'block':_0x1bbb48(0xbf8),document['getElementById'](_0x1bbb48(0x29d))[_0x1bbb48(0x842)][_0x1bbb48(0x5e9)]=_0x49beae['isUserParticipating']?_0x1bbb48(0xbf8):'block';if(_0x3b1534)clearInterval(_0x3b1534);_0x3b1534=setInterval(_0xd7bdac,0x3e8),_0xd7bdac(),_0x519abd();}async function _0x408ee2(){const _0x251cbd=_0x18b51e;if(!_0x49beae['isActive'])return;const _0x5ae8bf=Math[_0x251cbd(0x10b2)]((Date[_0x251cbd(0x1ed)]()-_0x49beae[_0x251cbd(0x95d)])/0x3e8),_0x1025a8=Math[_0x251cbd(0x10b2)](_0x5ae8bf/0x3c)+'分'+_0x5ae8bf%0x3c+'秒',_0x1bfc45=_0x251cbd(0x62b)+_0x1025a8,_0x279f6f=_0x405767['chats'][_0x49beae[_0x251cbd(0x248)]];if(_0x279f6f){const _0x4c7f48=[];_0x49beae[_0x251cbd(0x390)]?(_0x49beae[_0x251cbd(0x190)][_0x251cbd(0x7c0)](_0x229d48=>_0x4c7f48[_0x251cbd(0xa49)]({'name':_0x229d48[_0x251cbd(0x4e7)],'avatar':_0x229d48[_0x251cbd(0x1e1)]})),_0x49beae[_0x251cbd(0x7d0)]&&_0x4c7f48[_0x251cbd(0xe1e)]({'name':_0x279f6f[_0x251cbd(0x33a)][_0x251cbd(0xe16)]||'我','avatar':_0x279f6f[_0x251cbd(0x33a)][_0x251cbd(0x11ed)]||_0x38e728})):(_0x4c7f48[_0x251cbd(0xa49)]({'name':_0x279f6f['name'],'avatar':_0x279f6f[_0x251cbd(0x33a)][_0x251cbd(0x44e)]||_0x49d2a4}),_0x4c7f48[_0x251cbd(0xe1e)]({'name':'我','avatar':_0x279f6f['settings']['myAvatar']||_0x49d2a4}));const _0x202061={'chatId':_0x49beae['activeChatId'],'timestamp':Date[_0x251cbd(0x1ed)](),'duration':_0x5ae8bf,'participants':_0x4c7f48,'transcript':[..._0x49beae['callHistory']]};await _0x15043e[_0x251cbd(0x164)]['add'](_0x202061),console[_0x251cbd(0x32b)]('通话记录已保存:',_0x202061);let _0xbdc8c2={'role':_0x49beae[_0x251cbd(0xf70)]===_0x251cbd(0x74b)?_0x251cbd(0x74b):_0x251cbd(0x458),'content':_0x1bfc45,'timestamp':Date['now']()};_0x279f6f[_0x251cbd(0x1000)]&&_0xbdc8c2[_0x251cbd(0x14a)]==='assistant'&&(_0xbdc8c2[_0x251cbd(0x770)]=_0x49beae[_0x251cbd(0xf53)]||_0x279f6f[_0x251cbd(0x635)][0x0]?.[_0x251cbd(0x4e7)]||_0x279f6f[_0x251cbd(0x596)]);_0x279f6f['history'][_0x251cbd(0xa49)](_0xbdc8c2);const _0x510b9f=_0x49beae['callHistory'][_0x251cbd(0x6b9)](_0x39e6ce=>{const _0x57b1ed=_0x251cbd,_0x7b4c90=_0x39e6ce[_0x57b1ed(0x14a)]===_0x57b1ed(0x74b)?_0x279f6f[_0x57b1ed(0x33a)][_0x57b1ed(0xe16)]||'我':_0x39e6ce[_0x57b1ed(0x770)];return _0x7b4c90+':\x20'+_0x39e6ce['content'];})['join']('\x0a');_0x1c46b5(_0x279f6f['id'],_0x510b9f);const _0x33553c={'role':'system','content':_0x251cbd(0x77a),'timestamp':Date[_0x251cbd(0x1ed)]()+0x1,'isHidden':!![]};_0x279f6f[_0x251cbd(0xd39)]['push'](_0x33553c),await _0x15043e[_0x251cbd(0x799)][_0x251cbd(0xfaa)](_0x279f6f);}clearInterval(_0x3b1534),_0x3b1534=null,_0x49beae={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x279f6f&&(_0x426b8d(_0x279f6f['id']),_0x523815());}function _0x47e905(){const _0x2879d9=_0x18b51e,_0x224772=document[_0x2879d9(0x8c2)](_0x2879d9(0xd4c));_0x224772['innerHTML']='';const _0x3f190b=_0x405767[_0x2879d9(0x799)][_0x49beae[_0x2879d9(0x248)]];if(!_0x3f190b)return;let _0x37a017=[];_0x49beae['isGroupCall']?(_0x37a017=[..._0x49beae[_0x2879d9(0x190)]],_0x49beae[_0x2879d9(0x7d0)]&&_0x37a017[_0x2879d9(0xe1e)]({'id':_0x2879d9(0x74b),'name':_0x3f190b[_0x2879d9(0x33a)][_0x2879d9(0xe16)]||'我','avatar':_0x3f190b['settings']['myAvatar']||_0x38e728})):_0x37a017[_0x2879d9(0xa49)]({'id':'ai','name':_0x3f190b[_0x2879d9(0x596)],'avatar':_0x3f190b[_0x2879d9(0x33a)][_0x2879d9(0x44e)]||_0x49d2a4}),_0x37a017['forEach'](_0x4390fe=>{const _0x5b75f6=_0x2879d9,_0x3cab0e=document['createElement']('div');_0x3cab0e[_0x5b75f6(0x84c)]=_0x5b75f6(0x2fb),_0x3cab0e[_0x5b75f6(0x323)][_0x5b75f6(0xc92)]=_0x4390fe['id'];const _0x55cf43=_0x4390fe[_0x5b75f6(0x375)]||_0x4390fe['name'];_0x3cab0e[_0x5b75f6(0xca0)]=_0x5b75f6(0x1069)+_0x4390fe[_0x5b75f6(0x1e1)]+'\x22\x20class=\x22participant-avatar\x22\x20alt=\x22'+_0x55cf43+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>'+_0x55cf43+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x224772[_0x5b75f6(0x31e)](_0x3cab0e);});}function _0x23a3d3(){const _0x3ac3e8=_0x18b51e;if(!_0x49beae[_0x3ac3e8(0x6f0)]||_0x49beae[_0x3ac3e8(0x7d0)])return;_0x49beae[_0x3ac3e8(0x7d0)]=!![],_0x47e905(),document['getElementById'](_0x3ac3e8(0x1130))[_0x3ac3e8(0x842)][_0x3ac3e8(0x5e9)]='block',document['getElementById'](_0x3ac3e8(0x29d))[_0x3ac3e8(0x842)][_0x3ac3e8(0x5e9)]='none',_0x519abd(_0x3ac3e8(0x685));}function _0xd7bdac(){const _0x5883b6=_0x18b51e;if(!_0x49beae['isActive'])return;const _0x37b8f2=Math['floor']((Date[_0x5883b6(0x1ed)]()-_0x49beae[_0x5883b6(0x95d)])/0x3e8),_0x28a849=Math[_0x5883b6(0x10b2)](_0x37b8f2/0x3c),_0x363fb1=_0x37b8f2%0x3c;document[_0x5883b6(0x8c2)](_0x5883b6(0xfb6))[_0x5883b6(0x1090)]=String(_0x28a849)[_0x5883b6(0xc89)](0x2,'0')+':'+String(_0x363fb1)['padStart'](0x2,'0');}function _0x431406(){const _0x14d822=_0x18b51e,_0x9ca33b=_0x405767[_0x14d822(0x799)][_0x405767[_0x14d822(0x248)]];if(!_0x9ca33b)return;if(_0x9ca33b[_0x14d822(0x1000)]){const _0x22d171=_0x49beae['callRequester']||_0x9ca33b[_0x14d822(0x635)][0x0]?.[_0x14d822(0x596)]||_0x14d822(0x5d4);document[_0x14d822(0x8c2)](_0x14d822(0xd6f))[_0x14d822(0x939)]=_0x9ca33b[_0x14d822(0x33a)]['groupAvatar']||_0x56835c,document[_0x14d822(0x8c2)](_0x14d822(0x1032))[_0x14d822(0x1090)]=_0x9ca33b[_0x14d822(0x596)],document[_0x14d822(0x1ad)]('.incoming-call-content\x20.caller-text')[_0x14d822(0x1090)]=_0x22d171+_0x14d822(0x672);}else document[_0x14d822(0x8c2)]('caller-avatar')[_0x14d822(0x939)]=_0x9ca33b[_0x14d822(0x33a)]['aiAvatar']||_0x49d2a4,document[_0x14d822(0x8c2)](_0x14d822(0x1032))[_0x14d822(0x1090)]=_0x9ca33b[_0x14d822(0x596)],document[_0x14d822(0x1ad)](_0x14d822(0x5f3))[_0x14d822(0x1090)]=_0x14d822(0xeed);document['getElementById'](_0x14d822(0x8d9))[_0x14d822(0xb17)][_0x14d822(0x3f4)]('visible');}function _0x1e514a(){const _0x30bfd1=_0x18b51e;document[_0x30bfd1(0x8c2)]('incoming-call-modal')[_0x30bfd1(0xb17)][_0x30bfd1(0xaff)](_0x30bfd1(0x2cd));}async function _0x519abd(_0x3442e7=null){const _0x1d968f=_0x18b51e;if(!_0x49beae[_0x1d968f(0x6f0)])return;const _0xe2ba8b=_0x405767[_0x1d968f(0x799)][_0x49beae[_0x1d968f(0x248)]],{proxyUrl:_0x47503c,apiKey:_0x561a3f,model:_0x4aee08}=_0x405767[_0x1d968f(0x9e0)],_0xab1101=document[_0x1d968f(0x8c2)]('video-call-main'),_0x45ce7d=_0xe2ba8b[_0x1d968f(0x33a)]['myNickname']||'我';let _0x4cbdcc='';if(_0xe2ba8b[_0x1d968f(0x33a)][_0x1d968f(0xb77)]&&_0xe2ba8b[_0x1d968f(0x33a)][_0x1d968f(0xb77)]['length']>0x0){const _0x1dce3d=_0xe2ba8b['settings'][_0x1d968f(0xb77)]['map'](_0x3d1b73=>{const _0x1a8d4d=_0x1d968f,_0x6289eb=_0x405767[_0x1a8d4d(0x40e)][_0x1a8d4d(0x2ef)](_0x3c6553=>_0x3c6553['id']===_0x3d1b73);return _0x6289eb&&_0x6289eb['content']?'\x0a\x0a##\x20世界书:\x20'+_0x6289eb[_0x1a8d4d(0x596)]+'\x0a'+_0x6289eb[_0x1a8d4d(0x168)]:'';})[_0x1d968f(0x1d8)](Boolean)[_0x1d968f(0xb2c)]('');_0x1dce3d&&(_0x4cbdcc='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x1dce3d+_0x1d968f(0x836));}if(_0x3442e7&&_0x49beae[_0x1d968f(0x7d0)]){const _0x1459ce=Date[_0x1d968f(0x1ed)](),_0x58d746=document[_0x1d968f(0x8c1)](_0x1d968f(0x1072));_0x58d746[_0x1d968f(0x84c)]=_0x1d968f(0x6f4),_0x58d746['textContent']=_0x3442e7,_0x58d746[_0x1d968f(0x323)]['timestamp']=_0x1459ce,_0x5dcbd7(_0x58d746,()=>_0x1fca53(_0x1459ce)),_0xab1101['appendChild'](_0x58d746),_0xab1101[_0x1d968f(0xfd0)]=_0xab1101[_0x1d968f(0xb43)],_0x49beae[_0x1d968f(0x61d)][_0x1d968f(0xa49)]({'role':_0x1d968f(0x74b),'content':_0x3442e7,'timestamp':_0x1459ce});}let _0x2fed1c;if(_0x49beae['isGroupCall']){const _0x89d079=_0x49beae[_0x1d968f(0x190)][_0x1d968f(0x6b9)](_0x83d08e=>_0x83d08e['name']);_0x49beae[_0x1d968f(0x7d0)]&&_0x89d079['unshift'](_0x45ce7d),_0x2fed1c=_0x1d968f(0xa46)+_0x45ce7d+_0x1d968f(0x8ef)+_0x45ce7d+_0x1d968f(0xe82)+_0x49beae['preCallContext']+_0x1d968f(0x671)+_0x89d079[_0x1d968f(0xb2c)]('、\x20')+_0x1d968f(0x11b3)+_0x4cbdcc+'\x20//\x20<--\x20【核心】注入世界书\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}else{let _0x228699=_0x49beae[_0x1d968f(0xf70)]==='user'?'你刚刚接听了用户的视频通话请求。':'用户刚刚接听了你主动发起的视频通话。';_0x2fed1c=_0x1d968f(0xc3b)+_0xe2ba8b[_0x1d968f(0x596)]+'\x20('+_0xe2ba8b[_0x1d968f(0x33a)][_0x1d968f(0x1060)]+_0x1d968f(0xbf7)+_0xe2ba8b['name']+_0x1d968f(0x1064)+_0x45ce7d+'，人设:\x20'+_0xe2ba8b['settings'][_0x1d968f(0xbe8)]+'）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**'+_0x228699+_0x1d968f(0xa9a)+_0x49beae[_0x1d968f(0x796)]+_0x1d968f(0x11fa);}const _0x4989ed=[{'role':_0x1d968f(0x46c),'content':_0x2fed1c},..._0x49beae[_0x1d968f(0x61d)][_0x1d968f(0x6b9)](_0x579d27=>({'role':_0x579d27['role'],'content':_0x579d27['content']}))];if(_0x49beae[_0x1d968f(0x61d)][_0x1d968f(0x105a)]===0x0){const _0x217295=_0x49beae[_0x1d968f(0xf70)]===_0x1d968f(0x74b)?_0x1d968f(0xec6):_0x1d968f(0x70e);_0x4989ed[_0x1d968f(0xa49)]({'role':_0x1d968f(0x74b),'content':_0x217295});}try{let _0x55c1fa=_0x47503c===GEMINI_API_URL,_0x11fd42=_0x282b7e(_0x4aee08,_0x561a3f,_0x2fed1c,_0x4989ed);const _0xcea68e=_0x55c1fa?await fetch(_0x11fd42[_0x1d968f(0x9d6)],_0x11fd42[_0x1d968f(0x49a)]):await fetch(_0x47503c+_0x1d968f(0x5c1),{'method':_0x1d968f(0xcd0),'headers':{'Content-Type':_0x1d968f(0xcb6),'Authorization':_0x1d968f(0xf42)+_0x561a3f},'body':JSON[_0x1d968f(0x1175)]({'model':_0x4aee08,'messages':_0x4989ed,'temperature':_0x405767['globalSettings']['apiTemperature']||0.8})});if(!_0xcea68e['ok'])throw new Error((await _0xcea68e[_0x1d968f(0x7e9)]())[_0x1d968f(0x7a3)][_0x1d968f(0xc7d)]);const _0x29fe0c=await _0xcea68e[_0x1d968f(0x7e9)](),_0x495609=_0x55c1fa?_0x29fe0c['candidates'][0x0][_0x1d968f(0x168)]['parts'][0x0][_0x1d968f(0xbc6)]:_0x29fe0c[_0x1d968f(0xa44)][0x0][_0x1d968f(0xc7d)]['content'],_0x3b229e=_0xab1101['querySelector']('em');if(_0x3b229e)_0x3b229e[_0x1d968f(0xaff)]();if(_0x49beae['isGroupCall']){const _0x4847a6=_0x5196dd(_0x495609);_0x4847a6[_0x1d968f(0x7c0)](_0x190bf7=>{const _0xda5655=_0x1d968f;if(!_0x190bf7['name']||_0x190bf7['name']===_0x45ce7d||!_0x190bf7['speech'])return;const _0x375879=Date['now']()+Math[_0xda5655(0x5b3)](),_0x339ce0=document[_0xda5655(0x8c1)](_0xda5655(0x1072));_0x339ce0[_0xda5655(0x84c)]='call-message-bubble\x20ai-speech',_0x339ce0[_0xda5655(0xca0)]=_0xda5655(0x692)+_0x190bf7['name']+_0xda5655(0xfd5)+_0x190bf7[_0xda5655(0xe3e)],_0x339ce0['dataset'][_0xda5655(0x351)]=_0x375879,_0x5dcbd7(_0x339ce0,()=>_0x1fca53(_0x375879)),_0xab1101[_0xda5655(0x31e)](_0x339ce0),_0x49beae['callHistory'][_0xda5655(0xa49)]({'role':'assistant','content':_0x190bf7['name']+':\x20'+_0x190bf7[_0xda5655(0xe3e)],'timestamp':_0x375879});const _0x1bf46a=_0x49beae['participants'][_0xda5655(0x2ef)](_0x56f1b0=>_0x56f1b0[_0xda5655(0x596)]===_0x190bf7[_0xda5655(0x596)]);if(_0x1bf46a){const _0x6bc353=document[_0xda5655(0x1ad)](_0xda5655(0x899)+_0x1bf46a['id']+_0xda5655(0xcd4));_0x6bc353&&(_0x6bc353['classList'][_0xda5655(0x3f4)](_0xda5655(0x99f)),setTimeout(()=>_0x6bc353[_0xda5655(0xb17)][_0xda5655(0xaff)]('speaking'),0x7d0));}});}else{const _0x29fd1d=Date[_0x1d968f(0x1ed)](),_0x1d8f42=document[_0x1d968f(0x8c1)]('div');_0x1d8f42['className']='call-message-bubble\x20ai-speech',_0x1d8f42['textContent']=_0x495609,_0x1d8f42[_0x1d968f(0x323)][_0x1d968f(0x351)]=_0x29fd1d,_0x5dcbd7(_0x1d8f42,()=>_0x1fca53(_0x29fd1d)),_0xab1101['appendChild'](_0x1d8f42),_0x49beae[_0x1d968f(0x61d)][_0x1d968f(0xa49)]({'role':_0x1d968f(0x458),'content':_0x495609,'timestamp':_0x29fd1d});const _0x2cace5=document[_0x1d968f(0x1ad)]('.participant-avatar-wrapper\x20.participant-avatar');_0x2cace5&&(_0x2cace5[_0x1d968f(0xb17)]['add'](_0x1d968f(0x99f)),setTimeout(()=>_0x2cace5[_0x1d968f(0xb17)][_0x1d968f(0xaff)]('speaking'),0x7d0));}_0xab1101[_0x1d968f(0xfd0)]=_0xab1101[_0x1d968f(0xb43)];}catch(_0x9f1554){const _0x11e291=document[_0x1d968f(0x8c1)]('div');_0x11e291[_0x1d968f(0x84c)]=_0x1d968f(0x87d),_0x11e291[_0x1d968f(0x842)][_0x1d968f(0xac1)]='#ff8a80',_0x11e291[_0x1d968f(0x1090)]='[ERROR:\x20'+_0x9f1554[_0x1d968f(0xc7d)]+']',_0xab1101[_0x1d968f(0x31e)](_0x11e291),_0xab1101[_0x1d968f(0xfd0)]=_0xab1101['scrollHeight'],_0x49beae['callHistory'][_0x1d968f(0xa49)]({'role':'assistant','content':_0x1d968f(0x99b)+_0x9f1554[_0x1d968f(0xc7d)]+']'});}}function _0x3263b2(_0x49c6fc){const _0x526664=_0x18b51e;document['getElementById'](_0x526664(0x120d))[_0x526664(0x842)][_0x526664(0x5e9)]=_0x49c6fc?_0x526664(0xbf8):_0x526664(0xd52),document[_0x526664(0x8c2)](_0x526664(0x5e5))[_0x526664(0x842)]['display']=_0x49c6fc?_0x526664(0xd52):'none';}async function _0x253ee0(_0x489e92,_0x292211){const _0x1c31b6=_0x18b51e,_0x31f313=_0x405767[_0x1c31b6(0x799)][_0x405767['activeChatId']];if(!_0x31f313)return;const _0x47ce7e=_0x31f313[_0x1c31b6(0xd39)][_0x1c31b6(0x1149)](_0x108084=>_0x108084[_0x1c31b6(0x351)]===_0x489e92);if(_0x47ce7e===-0x1)return;const _0x3c2099=_0x31f313[_0x1c31b6(0xd39)][_0x47ce7e];_0x3c2099['status']=_0x292211;let _0x36375b;const _0x1eca45=_0x31f313['isGroup']?_0x31f313['settings']['myNickname']||'我':'我';_0x292211===_0x1c31b6(0x1279)?(_0x3c2099[_0x1c31b6(0xa89)]=_0x1eca45,_0x36375b=_0x1c31b6(0x346)+_0x1eca45+')\x20为\x20'+_0x3c2099[_0x1c31b6(0x770)]+_0x1c31b6(0xece)+_0x489e92+_0x1c31b6(0x4a8)):_0x36375b='[系统提示：你\x20('+_0x1eca45+_0x1c31b6(0xe3c)+_0x3c2099[_0x1c31b6(0x770)]+_0x1c31b6(0xd27)+_0x489e92+_0x1c31b6(0x83f);const _0x3f93b6={'role':_0x1c31b6(0x46c),'content':_0x36375b,'timestamp':Date[_0x1c31b6(0x1ed)](),'isHidden':!![]};_0x31f313[_0x1c31b6(0xd39)]['push'](_0x3f93b6),await _0x15043e[_0x1c31b6(0x799)][_0x1c31b6(0xfaa)](_0x31f313),_0x7dbe71(_0x405767[_0x1c31b6(0x248)]),_0x292211===_0x1c31b6(0x1279)&&_0x523815();}async function _0x4803c2(_0x2f3f89,_0xda2e65){const _0x463741=_0x18b51e,_0x573f4f=_0x405767['chats'][_0x2f3f89];if(!_0x573f4f)return;let _0x3d60cf;_0x573f4f[_0x463741(0x1000)]?_0x3d60cf=_0x1ba34a(_0x573f4f,_0xda2e65):_0x3d60cf=_0x573f4f[_0x463741(0x596)];const _0x1b888f=document[_0x463741(0x8c2)](_0x463741(0x5e7));_0x1b888f['classList'][_0x463741(0xaff)](_0x463741(0x1165)),void _0x1b888f[_0x463741(0x6f8)],_0x1b888f['classList'][_0x463741(0x3f4)]('pat-animation');const _0x4b5562=await _0x180f74(_0x463741(0xc59)+_0x3d60cf+'”','（可选）输入后缀','','text');if(_0x4b5562===null)return;const _0x41f477=_0x1ba34a(_0x573f4f,_0x405767[_0x463741(0x20a)]['nickname']),_0x58b3c8=_0x41f477+_0x463741(0x8ec)+_0x3d60cf+'”\x20'+_0x4b5562[_0x463741(0x8c6)](),_0x28cbb0={'role':_0x463741(0x46c),'type':_0x463741(0x6f1),'content':_0x58b3c8,'timestamp':Date[_0x463741(0x1ed)]()};_0x573f4f[_0x463741(0xd39)][_0x463741(0xa49)](_0x28cbb0);const _0x49927d=_0x463741(0xeaf)+_0x41f477+_0x463741(0x956)+_0xda2e65+'）'+_0x4b5562[_0x463741(0x8c6)]()+_0x463741(0xafe),_0x2c2496={'role':_0x463741(0x46c),'content':_0x49927d,'timestamp':Date[_0x463741(0x1ed)]()+0x1,'isHidden':!![]};_0x573f4f[_0x463741(0xd39)]['push'](_0x2c2496),await _0x15043e[_0x463741(0x799)][_0x463741(0xfaa)](_0x573f4f),_0x405767['activeChatId']===_0x2f3f89&&_0x5c5c92(_0x28cbb0,_0x573f4f),await _0x2b55d1();}let _0x5372c3=null,_0x1ac766=![],_0xe92b02=new Set();function _0x1fca53(_0x17f9eb){const _0x521d09=_0x18b51e;_0x5372c3=_0x17f9eb,document[_0x521d09(0x8c2)](_0x521d09(0x1209))['classList'][_0x521d09(0x3f4)](_0x521d09(0x2cd));}function _0x53ec74(){const _0x4d4fdb=_0x18b51e;document['getElementById'](_0x4d4fdb(0x1209))['classList'][_0x4d4fdb(0xaff)]('visible'),_0x5372c3=null;}async function _0x571fbd(){const _0x4c0291=_0x18b51e;if(!_0x5372c3)return;const _0x170352=_0x5372c3,_0x356db1=_0x49beae[_0x4c0291(0x61d)][_0x4c0291(0x2ef)](_0x8413ff=>_0x8413ff[_0x4c0291(0x351)]===_0x170352);if(!_0x356db1)return;_0x53ec74();let _0x53fdeb=_0x356db1[_0x4c0291(0x168)];if(_0x49beae['isGroupCall']&&_0x356db1['role']===_0x4c0291(0x458)){const _0x76c684=_0x356db1[_0x4c0291(0x168)]['split'](':\x20');_0x76c684[_0x4c0291(0x105a)]>0x1&&(_0x53fdeb=_0x76c684[_0x4c0291(0x961)](0x1)[_0x4c0291(0xb2c)](':\x20'));}const _0x24bd90=await _0x180f74(_0x4c0291(0x289),_0x4c0291(0xc1e),_0x53fdeb,_0x4c0291(0x6c3));_0x24bd90!==null&&await _0x3d30a0(_0x170352,_0x24bd90);}async function _0x3d30a0(_0x1145a8,_0x7aa5f1){const _0x3c7069=_0x18b51e,_0x37e220=_0x49beae['callHistory'][_0x3c7069(0x2ef)](_0x3a189c=>_0x3a189c[_0x3c7069(0x351)]===_0x1145a8);if(_0x37e220){let _0x3e7967=_0x7aa5f1;if(_0x49beae[_0x3c7069(0x390)]&&_0x37e220[_0x3c7069(0x14a)]===_0x3c7069(0x458)){const _0x122888=_0x37e220['content'][_0x3c7069(0x111f)](':\x20'),_0x3ed942=_0x122888[0x0];_0x3e7967=_0x3ed942+':\x20'+_0x7aa5f1;}_0x37e220['content']=_0x3e7967;const _0x406321=document[_0x3c7069(0x1ad)](_0x3c7069(0x10fe)+_0x1145a8+'\x22]');if(_0x406321){if(_0x49beae[_0x3c7069(0x390)]&&_0x37e220['role']==='assistant'){const _0x14b91e=_0x37e220[_0x3c7069(0x168)][_0x3c7069(0x111f)](':\x20'),_0x25ccd0=_0x14b91e[0x0];_0x406321[_0x3c7069(0xca0)]='<strong>'+_0x25ccd0+_0x3c7069(0xfd5)+_0x7aa5f1;}else _0x406321['textContent']=_0x7aa5f1;}}await _0x501c7b('成功',_0x3c7069(0xcb9));}async function _0x26f3ad(){const _0x4bd61f=_0x18b51e;if(!_0x5372c3)return;const _0x5b224a=await _0x8b9cb8(_0x4bd61f(0x180),_0x4bd61f(0x84a),{'confirmButtonClass':_0x4bd61f(0xe2a)});if(_0x5b224a){const _0x15ec3b=_0x5372c3;_0x53ec74();const _0x56e907=_0x49beae['callHistory'][_0x4bd61f(0x1149)](_0xe1bb81=>_0xe1bb81[_0x4bd61f(0x351)]===_0x15ec3b);_0x56e907>-0x1&&_0x49beae[_0x4bd61f(0x61d)][_0x4bd61f(0x3e6)](_0x56e907,0x1);const _0x106e85=document[_0x4bd61f(0x1ad)](_0x4bd61f(0x10fe)+_0x15ec3b+'\x22]');_0x106e85&&_0x106e85['remove']();}else _0x53ec74();}function _0x39c7cd(_0x4fefdf){const _0x3e9b51=_0x18b51e;_0x42bf96=_0x4fefdf;const _0xd7b7fc=_0x405767[_0x3e9b51(0x799)][_0x405767[_0x3e9b51(0x248)]],_0xc014f9=_0xd7b7fc[_0x3e9b51(0xd39)]['find'](_0x382e38=>_0x382e38[_0x3e9b51(0x351)]===_0x4fefdf);_0xc014f9&&(document[_0x3e9b51(0x8c2)]('transfer-sender-name')[_0x3e9b51(0x1090)]=_0xc014f9[_0x3e9b51(0x770)]),document['getElementById']('transfer-actions-modal')[_0x3e9b51(0xb17)][_0x3e9b51(0x3f4)](_0x3e9b51(0x2cd));}function _0x5b4d91(){const _0xaf99eb=_0x18b51e;document[_0xaf99eb(0x8c2)](_0xaf99eb(0xea0))[_0xaf99eb(0xb17)]['remove'](_0xaf99eb(0x2cd)),_0x42bf96=null;}async function _0x23fcf7(_0x1426a8){const _0x3efd43=_0x18b51e;if(!_0x42bf96)return;const _0x5d246e=_0x42bf96,_0x515316=_0x405767['chats'][_0x405767['activeChatId']],_0x583454=_0x515316[_0x3efd43(0xd39)]['findIndex'](_0x5807d4=>_0x5807d4[_0x3efd43(0x351)]===_0x5d246e);if(_0x583454===-0x1)return;const _0x1284e5=_0x515316[_0x3efd43(0xd39)][_0x583454];_0x1284e5[_0x3efd43(0x8c8)]=_0x1426a8;let _0x5e3000;if(_0x1426a8===_0x3efd43(0x1288)){const _0x1e98a5={'role':_0x3efd43(0x74b),'type':_0x3efd43(0x11b9),'isRefund':!![],'amount':_0x1284e5[_0x3efd43(0x4c5)],'note':_0x3efd43(0xd31),'timestamp':Date[_0x3efd43(0x1ed)]()};_0x515316[_0x3efd43(0xd39)][_0x3efd43(0xa49)](_0x1e98a5),_0x5e3000=_0x3efd43(0xfc5)+_0x1284e5[_0x3efd43(0x770)]+_0x3efd43(0xef8);}else _0x5e3000=_0x3efd43(0x250)+_0x1284e5[_0x3efd43(0x770)]+_0x3efd43(0xef8);const _0x19d2bd={'role':_0x3efd43(0x46c),'content':_0x5e3000,'timestamp':Date[_0x3efd43(0x1ed)]()+0x1,'isHidden':!![]};_0x515316[_0x3efd43(0xd39)][_0x3efd43(0xa49)](_0x19d2bd),await _0x15043e['chats'][_0x3efd43(0xfaa)](_0x515316),_0x5b4d91(),_0x7dbe71(_0x405767[_0x3efd43(0x248)]),_0x2b55d1();}function _0x56d432(_0x17932f){const _0x53b831=_0x18b51e;_0x31af8a=null;if(_0x17932f){const _0x20fbd0=_0x17932f[_0x53b831(0x1ad)](_0x53b831(0xdaf));_0x20fbd0&&(_0x20fbd0[_0x53b831(0x691)]=_0x53b831(0xb62));}}async function _0x1c4375(){const _0x40c32f=_0x18b51e,_0x51f490=document['getElementById']('memories-list');_0x51f490[_0x40c32f(0xca0)]='';const _0xa41b49=await _0x15043e['memories'][_0x40c32f(0x731)]('timestamp')['reverse']()[_0x40c32f(0x6be)]();if(_0xa41b49[_0x40c32f(0x105a)]===0x0){_0x51f490['innerHTML']=_0x40c32f(0x1aa);return;}_0xa41b49[_0x40c32f(0xa19)]((_0x2d1f4f,_0x84a0c4)=>{const _0x2314d2=_0x40c32f,_0x1d8b6c=_0x2d1f4f[_0x2314d2(0xde0)]==='countdown'&&_0x2d1f4f[_0x2314d2(0x84f)]>Date[_0x2314d2(0x1ed)](),_0x138c71=_0x84a0c4['type']===_0x2314d2(0x5ff)&&_0x84a0c4[_0x2314d2(0x84f)]>Date[_0x2314d2(0x1ed)]();if(_0x1d8b6c&&!_0x138c71)return-0x1;if(!_0x1d8b6c&&_0x138c71)return 0x1;if(_0x1d8b6c&&_0x138c71)return _0x2d1f4f[_0x2314d2(0x84f)]-_0x84a0c4[_0x2314d2(0x84f)];return 0x0;}),_0xa41b49['forEach'](_0xf471da=>{const _0x43c90b=_0x40c32f;let _0x2518de;_0xf471da[_0x43c90b(0xde0)]===_0x43c90b(0x5ff)&&_0xf471da[_0x43c90b(0x84f)]>Date[_0x43c90b(0x1ed)]()?_0x2518de=_0x49e3ae(_0xf471da):_0x2518de=_0x3b450b(_0xf471da),_0x51f490[_0x43c90b(0x31e)](_0x2518de);}),_0x28a0a7();}function _0x3b450b(_0x3ac7f3){const _0x59c86f=_0x18b51e,_0x568992=document[_0x59c86f(0x8c1)](_0x59c86f(0x1072));_0x568992['className']=_0x59c86f(0xe6b);const _0x444155=new Date(_0x3ac7f3[_0x59c86f(0x351)]),_0x4a1542=_0x444155[_0x59c86f(0x864)]()+'-'+String(_0x444155[_0x59c86f(0xc3c)]()+0x1)['padStart'](0x2,'0')+'-'+String(_0x444155[_0x59c86f(0xca8)]())[_0x59c86f(0xc89)](0x2,'0')+'\x20'+String(_0x444155[_0x59c86f(0x1ae)]())[_0x59c86f(0xc89)](0x2,'0')+':'+String(_0x444155['getMinutes']())['padStart'](0x2,'0');let _0xa520e6,_0xeff547;if(_0x3ac7f3[_0x59c86f(0xde0)]===_0x59c86f(0x5ff)&&_0x3ac7f3[_0x59c86f(0x84f)])_0xa520e6=_0x59c86f(0x7f6)+_0x3ac7f3[_0x59c86f(0x3ca)],_0xeff547=_0x16059c('在\x20'+new Date(_0x3ac7f3[_0x59c86f(0x84f)])['toLocaleString']()+_0x59c86f(0x7aa))[_0x59c86f(0x1b7)](/\n/g,_0x59c86f(0x854));else{let _0x5b62d1='我们的回忆';if(_0x3ac7f3[_0x59c86f(0x802)]){const _0xd74ed0=_0x405767[_0x59c86f(0x799)][_0x3ac7f3['authorId']];_0xd74ed0?_0x5b62d1=_0xd74ed0[_0x59c86f(0x596)]:_0x5b62d1=_0x3ac7f3['authorName']||_0x59c86f(0xa23);}else _0x3ac7f3[_0x59c86f(0x718)]&&(_0x5b62d1=_0x3ac7f3[_0x59c86f(0x718)]);_0xa520e6=_0x5b62d1+_0x59c86f(0x29c),_0xeff547=_0x16059c(_0x3ac7f3[_0x59c86f(0x3ca)]);}return _0x568992[_0x59c86f(0xca0)]=_0x59c86f(0xe92)+_0x4a1542+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>'+_0xa520e6+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>'+_0xeff547+_0x59c86f(0x6de),_0x5dcbd7(_0x568992,async()=>{const _0xbad7d6=_0x59c86f,_0x440c5c=await _0x8b9cb8('删除记录',_0xbad7d6(0x96c),{'confirmButtonClass':'btn-danger'});_0x440c5c&&(await _0x15043e[_0xbad7d6(0x4a0)][_0xbad7d6(0x89f)](_0x3ac7f3['id']),_0x1c4375());}),_0x568992;}function _0x49e3ae(_0x36bcd7){const _0x5620ed=_0x18b51e,_0x3f101f=document[_0x5620ed(0x8c1)](_0x5620ed(0x1072));_0x3f101f[_0x5620ed(0x84c)]='countdown-card';const _0xbdf907=new Date(_0x36bcd7['targetDate']),_0x1c9dd8=_0xbdf907[_0x5620ed(0x2e8)](_0x5620ed(0x73e),{'dateStyle':'full','timeStyle':_0x5620ed(0xd9b)});return _0x3f101f[_0x5620ed(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x36bcd7['description']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22'+_0x36bcd7[_0x5620ed(0x84f)]+_0x5620ed(0x5c3)+_0x1c9dd8+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x5dcbd7(_0x3f101f,async()=>{const _0x4ad01a=_0x5620ed,_0x557f56=await _0x8b9cb8(_0x4ad01a(0x110d),_0x4ad01a(0x7f0),{'confirmButtonClass':_0x4ad01a(0xe2a)});_0x557f56&&(await _0x15043e[_0x4ad01a(0x4a0)][_0x4ad01a(0x89f)](_0x36bcd7['id']),_0x1c4375());}),_0x3f101f;}let _0xde4184=[];function _0x28a0a7(){const _0x3e1b52=_0x18b51e;_0xde4184['forEach'](_0x56e15f=>clearInterval(_0x56e15f)),_0xde4184=[],document[_0x3e1b52(0xa2d)](_0x3e1b52(0x5b6))[_0x3e1b52(0x7c0)](_0x32493e=>{const _0x3f12f6=_0x3e1b52,_0x59565f=parseInt(_0x32493e['dataset'][_0x3f12f6(0x84f)]);let _0x44a8dc;const _0x249117=()=>{const _0x6c498=_0x3f12f6,_0x307705=Date[_0x6c498(0x1ed)](),_0x4afb63=_0x59565f-_0x307705;if(_0x4afb63<0x0){_0x32493e['textContent']=_0x6c498(0x387),clearInterval(_0x44a8dc),setTimeout(()=>_0x1c4375(),0x7d0);return;}const _0x1e5068=Math[_0x6c498(0x10b2)](_0x4afb63/(0x3e8*0x3c*0x3c*0x18)),_0x202ec6=Math[_0x6c498(0x10b2)](_0x4afb63%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0xb2e54a=Math[_0x6c498(0x10b2)](_0x4afb63%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x4a238d=Math[_0x6c498(0x10b2)](_0x4afb63%(0x3e8*0x3c)/0x3e8);_0x32493e[_0x6c498(0x1090)]=_0x1e5068+'天\x20'+_0x202ec6+'时\x20'+_0xb2e54a+'分\x20'+_0x4a238d+'秒';};_0x249117(),_0x44a8dc=setInterval(_0x249117,0x3e8),_0xde4184['push'](_0x44a8dc);});}async function _0x50ee11(_0xbb3a39){const _0x150326=_0x18b51e,_0x50348e=_0x405767[_0x150326(0x799)][_0xbb3a39];if(!_0x50348e)return;await _0x501c7b(_0x150326(0xae0),_0x150326(0x1229)+_0x50348e['name']+_0x150326(0x492));const {proxyUrl:_0x2f7d13,apiKey:_0x41547d,model:_0x1287de}=_0x405767[_0x150326(0x9e0)];if(!_0x2f7d13||!_0x41547d||!_0x1287de){await _0x501c7b(_0x150326(0x118e),_0x150326(0xb37));return;}const _0x2354ff=_0x50348e[_0x150326(0xd39)][_0x150326(0x961)](-0x5)[_0x150326(0x6b9)](_0x4bcf96=>{const _0x463f2b=_0x150326,_0x5f08a4=_0x4bcf96[_0x463f2b(0x14a)]===_0x463f2b(0x74b)?_0x50348e[_0x463f2b(0x33a)]['myNickname']||'我':_0x4bcf96[_0x463f2b(0x770)]||_0x50348e[_0x463f2b(0x596)];return _0x5f08a4+':\x20'+String(_0x4bcf96[_0x463f2b(0x168)])['substring'](0x0,0x32)+_0x463f2b(0x388);})[_0x150326(0xb2c)]('\x0a');let _0x131528='';if(_0x50348e[_0x150326(0x33a)][_0x150326(0xb77)]&&_0x50348e[_0x150326(0x33a)][_0x150326(0xb77)]['length']>0x0){const _0x5d22f3=_0x50348e['settings'][_0x150326(0xb77)]['map'](_0x394f61=>{const _0x30585e=_0x150326,_0x501ed0=_0x405767[_0x30585e(0x40e)][_0x30585e(0x2ef)](_0xef7b2b=>_0xef7b2b['id']===_0x394f61);if(!_0x501ed0||!Array[_0x30585e(0xb85)](_0x501ed0[_0x30585e(0x168)]))return'';const _0x1c0a78=_0x501ed0[_0x30585e(0x168)][_0x30585e(0x6b9)](_0x4b193d=>{const _0x58334f=_0x30585e;let _0x206304='\x0a###\x20条目:\x20'+(_0x4b193d[_0x58334f(0x120a)]||_0x58334f(0x11db))+'\x0a';return _0x4b193d[_0x58334f(0xbda)][_0x58334f(0x105a)]>0x0&&(_0x206304+=_0x58334f(0xdd1)+_0x4b193d[_0x58334f(0xbda)]['join'](',\x20')+'\x0a'),_0x206304+=_0x58334f(0xce7)+_0x4b193d[_0x58334f(0x168)],_0x206304;})[_0x30585e(0xb2c)]('\x0a');return _0x1c0a78?_0x30585e(0x15d)+_0x501ed0[_0x30585e(0x596)]+'\x0a'+_0x1c0a78:'';})[_0x150326(0x1d8)](Boolean)[_0x150326(0xb2c)]('');_0x5d22f3&&(_0x131528='\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a'+_0x5d22f3+'\x0a');}const _0x70276c='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“'+_0x50348e[_0x150326(0x596)]+_0x150326(0x212)+_0x50348e[_0x150326(0x33a)]['aiPersona']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x131528+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2354ff+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20';try{const _0xd4f416=[{'role':_0x150326(0x46c),'content':_0x70276c},{'role':_0x150326(0x74b),'content':_0x150326(0x67b)}];let _0x5e41db=_0x2f7d13===GEMINI_API_URL,_0xc50fdb=_0x282b7e(_0x1287de,_0x41547d,_0x70276c,_0xd4f416);const _0x56bd2d=_0x5e41db?await fetch(_0xc50fdb[_0x150326(0x9d6)],_0xc50fdb[_0x150326(0x49a)]):await fetch(_0x2f7d13+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x150326(0xcb6),'Authorization':_0x150326(0xf42)+_0x41547d},'body':JSON[_0x150326(0x1175)]({'model':_0x1287de,'messages':_0xd4f416,'temperature':_0x405767['globalSettings'][_0x150326(0x8c7)]||0.9})});if(!_0x56bd2d['ok']){const _0x4c62cb=await _0x56bd2d['json']();throw new Error(_0x150326(0x1d9)+_0x56bd2d[_0x150326(0x8c8)]+'\x20-\x20'+_0x4c62cb[_0x150326(0x7a3)][_0x150326(0xc7d)]);}const _0x36023d=await _0x56bd2d[_0x150326(0x7e9)]();let _0x2518c3=_0x5e41db?_0x36023d[_0x150326(0xc88)][0x0][_0x150326(0x168)][_0x150326(0x3f0)][0x0][_0x150326(0xbc6)]:_0x36023d[_0x150326(0xa44)][0x0][_0x150326(0xc7d)][_0x150326(0x168)];_0x2518c3=_0x2518c3[_0x150326(0x1b7)](/^```json\s*/,'')['replace'](/```$/,'');const _0x50a023=_0x2518c3[_0x150326(0x8c6)](),_0xc47962=JSON[_0x150326(0x10ab)](_0x50a023);_0xc47962[_0x150326(0x697)]===_0x150326(0xd02)&&_0xc47962[_0x150326(0x29f)]?(_0x50348e[_0x150326(0x944)][_0x150326(0x8c8)]=_0x150326(0xd87),_0x50348e[_0x150326(0x944)]['applicationReason']=_0xc47962[_0x150326(0x29f)],_0x405767['chats'][_0xbb3a39]=_0x50348e,_0x2b55d1(),await _0x501c7b(_0x150326(0x992),'“'+_0x50348e[_0x150326(0x596)]+_0x150326(0x94e))):(await _0x501c7b('AI决策','“'+_0x50348e[_0x150326(0x596)]+'”思考后决定暂时不发送好友申请，将重置冷静期。'),_0x50348e[_0x150326(0x944)][_0x150326(0x8c8)]=_0x150326(0x1e6),_0x50348e[_0x150326(0x944)][_0x150326(0x42a)]=Date['now']());}catch(_0x39aa3d){await _0x501c7b(_0x150326(0x3bc),'为“'+_0x50348e[_0x150326(0x596)]+'”申请好友时发生错误：\x0a\x0a'+_0x39aa3d[_0x150326(0xc7d)]+_0x150326(0x98e)),_0x50348e[_0x150326(0x944)][_0x150326(0x8c8)]='blocked_by_user',_0x50348e[_0x150326(0x944)][_0x150326(0x42a)]=Date[_0x150326(0x1ed)]();}finally{await _0x15043e[_0x150326(0x799)][_0x150326(0xfaa)](_0x50348e),_0x7dbe71(_0xbb3a39);}}function _0x1ae447(){const _0xaa82b5=_0x18b51e;if(!_0x405767[_0xaa82b5(0x248)])return;const _0x2b09cb=_0x405767[_0xaa82b5(0x799)][_0x405767[_0xaa82b5(0x248)]];_0x2b09cb[_0xaa82b5(0x1000)]?_0x40d08d():document[_0xaa82b5(0x8c2)](_0xaa82b5(0x70c))['classList'][_0xaa82b5(0x3f4)](_0xaa82b5(0x2cd));}function _0x40d08d(){const _0x27ddc6=_0x18b51e,_0x5020a0=document[_0x27ddc6(0x8c2)]('red-packet-modal'),_0x4bba2d=_0x405767[_0x27ddc6(0x799)][_0x405767[_0x27ddc6(0x248)]];document['getElementById']('rp-group-amount')[_0x27ddc6(0x518)]='',document['getElementById']('rp-group-count')[_0x27ddc6(0x518)]='',document[_0x27ddc6(0x8c2)](_0x27ddc6(0x1029))[_0x27ddc6(0x518)]='',document[_0x27ddc6(0x8c2)](_0x27ddc6(0x18b))['value']='',document['getElementById'](_0x27ddc6(0xbde))['value']='',document[_0x27ddc6(0x8c2)](_0x27ddc6(0x3d3))['textContent']=_0x27ddc6(0x7ac),document[_0x27ddc6(0x8c2)](_0x27ddc6(0x184))[_0x27ddc6(0x1090)]=_0x27ddc6(0x7ac);const _0x222f2b=document[_0x27ddc6(0x8c2)](_0x27ddc6(0x142));_0x222f2b['innerHTML']='',_0x4bba2d[_0x27ddc6(0x635)]['forEach'](_0x3c943c=>{const _0xad29cc=_0x27ddc6,_0x4c8368=document[_0xad29cc(0x8c1)](_0xad29cc(0x4f3));_0x4c8368[_0xad29cc(0x518)]=_0x3c943c['originalName'],_0x4c8368[_0xad29cc(0x1090)]=_0x3c943c[_0xad29cc(0x375)],_0x222f2b[_0xad29cc(0x31e)](_0x4c8368);}),document[_0x27ddc6(0x8c2)](_0x27ddc6(0xe7d))[_0x27ddc6(0xa17)](),_0x5020a0[_0x27ddc6(0xb17)][_0x27ddc6(0x3f4)]('visible');}async function _0x49fc2c(){const _0x3b55f7=_0x18b51e,_0x1ee7ad=_0x405767[_0x3b55f7(0x799)][_0x405767['activeChatId']],_0x28b61f=parseFloat(document['getElementById'](_0x3b55f7(0x883))[_0x3b55f7(0x518)]),_0x426ab9=parseInt(document[_0x3b55f7(0x8c2)](_0x3b55f7(0x1146))[_0x3b55f7(0x518)]),_0x4282b4=document[_0x3b55f7(0x8c2)](_0x3b55f7(0x1029))[_0x3b55f7(0x518)][_0x3b55f7(0x8c6)]();if(isNaN(_0x28b61f)||_0x28b61f<=0x0){alert('请输入有效的总金额！');return;}if(isNaN(_0x426ab9)||_0x426ab9<=0x0){alert(_0x3b55f7(0xcca));return;}if(_0x28b61f/_0x426ab9<0.01){alert(_0x3b55f7(0xf26));return;}const _0x16f1ed=_0x1ee7ad['settings'][_0x3b55f7(0xe16)]||'我',_0x2781a5={'role':_0x3b55f7(0x74b),'senderName':_0x16f1ed,'type':_0x3b55f7(0x59c),'packetType':'lucky','timestamp':Date[_0x3b55f7(0x1ed)](),'totalAmount':_0x28b61f,'count':_0x426ab9,'greeting':_0x4282b4||_0x3b55f7(0x41b),'claimedBy':{},'isFullyClaimed':![]};_0x1ee7ad[_0x3b55f7(0xd39)][_0x3b55f7(0xa49)](_0x2781a5),await _0x15043e[_0x3b55f7(0x799)][_0x3b55f7(0xfaa)](_0x1ee7ad),_0x5c5c92(_0x2781a5,_0x1ee7ad),_0x2b55d1(),document[_0x3b55f7(0x8c2)](_0x3b55f7(0x67d))[_0x3b55f7(0xb17)][_0x3b55f7(0xaff)](_0x3b55f7(0x2cd));}async function _0x49eb4a(){const _0x1e8a4e=_0x18b51e,_0x520fda=_0x405767[_0x1e8a4e(0x799)][_0x405767[_0x1e8a4e(0x248)]],_0x455c85=parseFloat(document[_0x1e8a4e(0x8c2)](_0x1e8a4e(0x18b))[_0x1e8a4e(0x518)]),_0x41908b=document[_0x1e8a4e(0x8c2)](_0x1e8a4e(0x142))[_0x1e8a4e(0x518)],_0x2a8bcb=document[_0x1e8a4e(0x8c2)]('rp-direct-greeting')['value'][_0x1e8a4e(0x8c6)]();if(isNaN(_0x455c85)||_0x455c85<=0x0){alert(_0x1e8a4e(0x668));return;}if(!_0x41908b){alert(_0x1e8a4e(0x284));return;}const _0x107856=_0x520fda[_0x1e8a4e(0x33a)]['myNickname']||'我',_0x1fc07e={'role':_0x1e8a4e(0x74b),'senderName':_0x107856,'type':_0x1e8a4e(0x59c),'packetType':_0x1e8a4e(0x35c),'timestamp':Date[_0x1e8a4e(0x1ed)](),'totalAmount':_0x455c85,'count':0x1,'greeting':_0x2a8bcb||'给你准备了一个红包','receiverName':_0x41908b,'claimedBy':{},'isFullyClaimed':![]};_0x520fda[_0x1e8a4e(0xd39)][_0x1e8a4e(0xa49)](_0x1fc07e),await _0x15043e['chats'][_0x1e8a4e(0xfaa)](_0x520fda),_0x5c5c92(_0x1fc07e,_0x520fda),_0x2b55d1(),document[_0x1e8a4e(0x8c2)](_0x1e8a4e(0x67d))[_0x1e8a4e(0xb17)][_0x1e8a4e(0xaff)](_0x1e8a4e(0x2cd));}async function _0x1ee22(_0x368b59){const _0x2a101c=_0x18b51e,_0x40dde4=_0x405767[_0x2a101c(0x248)],_0x551e23=await _0x15043e[_0x2a101c(0x799)][_0x2a101c(0x3e9)](_0x40dde4);if(!_0x551e23)return;_0x405767['chats'][_0x40dde4]=_0x551e23;const _0xa58fee=_0x551e23[_0x2a101c(0xd39)][_0x2a101c(0x2ef)](_0x7ec2be=>_0x7ec2be[_0x2a101c(0x351)]===_0x368b59);if(!_0xa58fee)return;const _0xc6020c=_0x405767[_0x2a101c(0x20a)][_0x2a101c(0xab3)]||_0x2a101c(0x2dc),_0x26b666=_0xa58fee[_0x2a101c(0x343)]&&_0xa58fee['claimedBy'][_0xc6020c];if(_0xa58fee['packetType']==='direct'&&_0xa58fee[_0x2a101c(0xcf7)]!==_0xc6020c&&Object[_0x2a101c(0xbda)](_0xa58fee[_0x2a101c(0x343)])[_0x2a101c(0x105a)]>0x0||_0xa58fee[_0x2a101c(0x2a6)]||_0x26b666){_0x2080c8(_0xa58fee);return;}const _0xada34d=await _0x5ebdbb(_0xa58fee);_0xada34d!==null&&(await _0x7dbe71(_0x40dde4),await _0x501c7b(_0x2a101c(0x120f),_0x2a101c(0x708)+_0x1ba34a(_0x551e23,_0xa58fee[_0x2a101c(0x770)])+_0x2a101c(0xfa6)+_0xada34d['toFixed'](0x2)+'\x20元。'));const _0x52b7d9=_0x405767[_0x2a101c(0x799)][_0x40dde4][_0x2a101c(0xd39)][_0x2a101c(0x2ef)](_0x2ec97a=>_0x2ec97a['timestamp']===_0x368b59);_0x52b7d9&&_0x2080c8(_0x52b7d9);}async function _0x5ebdbb(_0x4232bd){const _0x14dd21=_0x18b51e,_0x6fbeea=_0x405767[_0x14dd21(0x799)][_0x405767['activeChatId']];let _0x22d9db=Date[_0x14dd21(0x1ed)]();const _0x5afe81=_0x405767[_0x14dd21(0x20a)][_0x14dd21(0xab3)]||_0x14dd21(0x2dc),_0x35e887=_0x4232bd[_0x14dd21(0xb61)]-Object['keys'](_0x4232bd['claimedBy']||{})['length'];if(_0x35e887<=0x0)return _0x4232bd[_0x14dd21(0x2a6)]=!![],await _0x15043e['chats'][_0x14dd21(0xfaa)](_0x6fbeea),await _0x501c7b('手慢了','红包已被领完！'),null;let _0x4bd591=0x0;const _0x1673b8=_0x4232bd[_0x14dd21(0x887)]-Object['values'](_0x4232bd[_0x14dd21(0x343)]||{})[_0x14dd21(0x29a)]((_0xcdb5f5,_0x532a1c)=>_0xcdb5f5+_0x532a1c,0x0);if(_0x4232bd[_0x14dd21(0x46b)]===_0x14dd21(0x46e)){if(_0x35e887===0x1)_0x4bd591=_0x1673b8;else{const _0x2e7b94=0.01,_0x5f2045=_0x1673b8-(_0x35e887-0x1)*_0x2e7b94;_0x4bd591=Math['random']()*(_0x5f2045-_0x2e7b94)+_0x2e7b94;}}else _0x4bd591=_0x4232bd['totalAmount'];_0x4bd591=parseFloat(_0x4bd591['toFixed'](0x2));if(!_0x4232bd[_0x14dd21(0x343)])_0x4232bd[_0x14dd21(0x343)]={};_0x4232bd['claimedBy'][_0x5afe81]=_0x4bd591;const _0x30b2f7=Object[_0x14dd21(0xbda)](_0x4232bd[_0x14dd21(0x343)])[_0x14dd21(0x105a)]>=_0x4232bd[_0x14dd21(0xb61)];_0x30b2f7&&(_0x4232bd['isFullyClaimed']=!![]);const _0x4bd191=_0x1ba34a(_0x6fbeea,_0x5afe81),_0x1cffc1=_0x1ba34a(_0x6fbeea,_0x4232bd['senderName']),_0x36e49d={'role':_0x14dd21(0x46c),'type':_0x14dd21(0x6f1),'content':'你领取了\x20'+_0x1cffc1+_0x14dd21(0xe25),'timestamp':_0x22d9db++};_0x6fbeea['history']['push'](_0x36e49d);let _0x192e2b;if(_0x30b2f7){const _0x12bec4={'role':_0x14dd21(0x46c),'type':'pat_message','content':_0x1cffc1+_0x14dd21(0x4e5),'timestamp':_0x22d9db++};_0x6fbeea['history'][_0x14dd21(0xa49)](_0x12bec4);let _0x2ba6c9={'name':'','amount':-0x1};_0x4232bd[_0x14dd21(0x46b)]===_0x14dd21(0x46e)&&_0x4232bd[_0x14dd21(0xb61)]>0x1&&Object[_0x14dd21(0x6ff)](_0x4232bd[_0x14dd21(0x343)])[_0x14dd21(0x7c0)](([_0x2f4f91,_0x1fcde9])=>{const _0x8cd5df=_0x14dd21;_0x1fcde9>_0x2ba6c9[_0x8cd5df(0x4c5)]&&(_0x2ba6c9={'name':_0x2f4f91,'amount':_0x1fcde9});});const _0x179778=_0x2ba6c9[_0x14dd21(0x596)]?_0x1ba34a(_0x6fbeea,_0x2ba6c9[_0x14dd21(0x596)]):'无';_0x192e2b=_0x14dd21(0x5e1)+_0x4bd191+_0x14dd21(0xa28)+_0x179778+_0x14dd21(0xb7b);}else _0x192e2b=_0x14dd21(0x5e1)+_0x4bd191+')\x20刚刚领取了红包\x20(时间戳:\x20'+_0x4232bd[_0x14dd21(0x351)]+_0x14dd21(0x1193);const _0x54aa71={'role':_0x14dd21(0x46c),'content':_0x192e2b,'timestamp':_0x22d9db++,'isHidden':!![]};return _0x6fbeea['history'][_0x14dd21(0xa49)](_0x54aa71),await _0x15043e['chats']['put'](_0x6fbeea),_0x4bd591;}async function _0x2080c8(_0x510462){const _0x285968=_0x18b51e;if(!_0x510462){console[_0x285968(0x7a3)](_0x285968(0x15f));return;}const _0x1153fa=_0x405767['chats'][_0x405767[_0x285968(0x248)]];if(!_0x1153fa)return;const _0x253208=document['getElementById'](_0x285968(0x1e5)),_0x431b09=_0x405767[_0x285968(0x20a)][_0x285968(0xab3)]||'{{user}}',_0x46767e=_0x1ba34a(_0x1153fa,_0x510462[_0x285968(0x770)]);document[_0x285968(0x8c2)](_0x285968(0xa43))[_0x285968(0x1090)]=_0x46767e,document['getElementById'](_0x285968(0xf0f))[_0x285968(0x1090)]=_0x510462[_0x285968(0x26c)]||_0x285968(0x41b);const _0x39731e=document[_0x285968(0x8c2)](_0x285968(0xec4));_0x510462[_0x285968(0x343)]&&_0x510462[_0x285968(0x343)][_0x431b09]?(_0x39731e[_0x285968(0x1ad)]('span:first-child')['textContent']=_0x510462['claimedBy'][_0x431b09]['toFixed'](0x2),_0x39731e['style'][_0x285968(0x5e9)]=_0x285968(0xea7)):_0x39731e['style']['display']=_0x285968(0xbf8);const _0x32f03f=Object[_0x285968(0xbda)](_0x510462[_0x285968(0x343)]||{})['length'],_0x25951c=Object[_0x285968(0x22f)](_0x510462['claimedBy']||{})[_0x285968(0x29a)]((_0x4e9d97,_0x2673d4)=>_0x4e9d97+_0x2673d4,0x0);let _0x4c6312=_0x32f03f+'/'+_0x510462['count']+_0x285968(0x1056)+_0x25951c['toFixed'](0x2)+'/'+_0x510462[_0x285968(0x887)][_0x285968(0x3c1)](0x2)+'元。';if(!_0x510462['isFullyClaimed']&&_0x32f03f<_0x510462['count']){const _0x38c07=Math[_0x285968(0x10b2)]((_0x510462[_0x285968(0x351)]+0x18*0x3c*0x3c*0x3e8-Date[_0x285968(0x1ed)]())/(0x3e8*0x3c*0x3c));if(_0x38c07>0x0)_0x4c6312+=_0x285968(0x2a3)+_0x38c07+_0x285968(0xb88);}document['getElementById'](_0x285968(0xe03))['textContent']=_0x4c6312;const _0xd7ff22=document[_0x285968(0x8c2)](_0x285968(0x110e));_0xd7ff22[_0x285968(0xca0)]='';const _0x2749d6=Object[_0x285968(0x6ff)](_0x510462[_0x285968(0x343)]||{});let _0x101cb3={'name':'','amount':-0x1};_0x510462[_0x285968(0x46b)]===_0x285968(0x46e)&&_0x510462[_0x285968(0x2a6)]&&_0x2749d6['length']>0x1&&_0x2749d6[_0x285968(0x7c0)](([_0x292031,_0x30f6ae])=>{_0x30f6ae>_0x101cb3['amount']&&(_0x101cb3={'name':_0x292031,'amount':_0x30f6ae});}),_0x2749d6[_0x285968(0xa19)]((_0x4d92f8,_0x119034)=>_0x119034[0x1]-_0x4d92f8[0x1]),_0x2749d6[_0x285968(0x7c0)](([_0x4c1c8d,_0x4e50de])=>{const _0x5b1f73=_0x285968,_0x49fa2b=document[_0x5b1f73(0x8c1)](_0x5b1f73(0x1072));_0x49fa2b[_0x5b1f73(0x84c)]='rp-details-item';let _0x14553f='';_0x101cb3[_0x5b1f73(0x596)]&&_0x4c1c8d===_0x101cb3['name']&&(_0x14553f=_0x5b1f73(0xb9f));const _0x20adf5=_0x1ba34a(_0x1153fa,_0x4c1c8d);_0x49fa2b['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x20adf5+_0x5b1f73(0x325)+_0x4e50de[_0x5b1f73(0x3c1)](0x2)+_0x5b1f73(0x9b3)+_0x14553f+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xd7ff22['appendChild'](_0x49fa2b);}),_0x253208[_0x285968(0xb17)][_0x285968(0x3f4)](_0x285968(0x2cd));}document[_0x18b51e(0x8c2)](_0x18b51e(0xc67))[_0x18b51e(0xae8)](_0x18b51e(0xa17),()=>{const _0x18b255=_0x18b51e;document[_0x18b255(0x8c2)](_0x18b255(0x1e5))['classList'][_0x18b255(0xaff)]('visible');}),window[_0x18b51e(0x82e)]=_0x1ee22;function _0x284a1d(){const _0x4c86a9=_0x18b51e,_0x529ab7=document[_0x4c86a9(0x8c2)](_0x4c86a9(0x1274));document[_0x4c86a9(0x8c2)]('poll-question-input')[_0x4c86a9(0x518)]='';const _0xf9ac2f=document[_0x4c86a9(0x8c2)]('poll-options-container');_0xf9ac2f[_0x4c86a9(0xca0)]='',_0x21b36b(),_0x21b36b(),_0x529ab7[_0x4c86a9(0xb17)]['add'](_0x4c86a9(0x2cd));}function _0x21b36b(){const _0x2f2cf6=_0x18b51e,_0x1b21dc=document[_0x2f2cf6(0x8c2)](_0x2f2cf6(0x1c7)),_0x10e7b5=document[_0x2f2cf6(0x8c1)](_0x2f2cf6(0x1072));_0x10e7b5[_0x2f2cf6(0x84c)]=_0x2f2cf6(0x299),_0x10e7b5['innerHTML']=_0x2f2cf6(0x1143),_0x10e7b5[_0x2f2cf6(0x1ad)](_0x2f2cf6(0x11bc))['addEventListener'](_0x2f2cf6(0xa17),()=>{const _0x1dc931=_0x2f2cf6;_0x1b21dc[_0x1dc931(0x9dd)][_0x1dc931(0x105a)]>0x2?_0x10e7b5['remove']():alert('投票至少需要2个选项。');}),_0x1b21dc['appendChild'](_0x10e7b5);}async function _0x3f2645(){const _0x51a0e8=_0x18b51e;if(!_0x405767[_0x51a0e8(0x248)])return;const _0x215a25=document[_0x51a0e8(0x8c2)]('poll-question-input')[_0x51a0e8(0x518)][_0x51a0e8(0x8c6)]();if(!_0x215a25){alert(_0x51a0e8(0x10a2));return;}const _0x19ca26=Array[_0x51a0e8(0x51a)](document[_0x51a0e8(0xa2d)](_0x51a0e8(0xc0e)))[_0x51a0e8(0x6b9)](_0x14c739=>_0x14c739[_0x51a0e8(0x518)][_0x51a0e8(0x8c6)]())[_0x51a0e8(0x1d8)](_0x1414ca=>_0x1414ca);if(_0x19ca26[_0x51a0e8(0x105a)]<0x2){alert(_0x51a0e8(0xa04));return;}const _0x3b6868=_0x405767[_0x51a0e8(0x799)][_0x405767['activeChatId']],_0x4e923e=_0x3b6868['isGroup']?_0x3b6868[_0x51a0e8(0x33a)]['myNickname']||'我':'我',_0x341ecd={'role':_0x51a0e8(0x74b),'senderName':_0x4e923e,'type':'poll','timestamp':Date[_0x51a0e8(0x1ed)](),'question':_0x215a25,'options':_0x19ca26,'votes':{},'isClosed':![]};_0x3b6868[_0x51a0e8(0xd39)][_0x51a0e8(0xa49)](_0x341ecd),await _0x15043e[_0x51a0e8(0x799)][_0x51a0e8(0xfaa)](_0x3b6868),_0x5c5c92(_0x341ecd,_0x3b6868),_0x2b55d1(),document['getElementById'](_0x51a0e8(0x1274))['classList']['remove']('visible');}async function _0x148de8(_0x274dd4,_0x104ff6){const _0x176e5e=_0x18b51e,_0x22da16=_0x405767[_0x176e5e(0x799)][_0x405767[_0x176e5e(0x248)]],_0x1993a2=_0x22da16[_0x176e5e(0xd39)][_0x176e5e(0x2ef)](_0x5f4043=>_0x5f4043[_0x176e5e(0x351)]===_0x274dd4),_0x136dee=_0x22da16['isGroup']?_0x22da16[_0x176e5e(0x33a)][_0x176e5e(0xe16)]||'我':'我';if(!_0x1993a2||_0x1993a2[_0x176e5e(0x855)]){_0x1993a2&&_0x1993a2[_0x176e5e(0x855)]&&_0x57f1a4(_0x274dd4);return;}const _0xeb0ce=_0x1993a2[_0x176e5e(0x2ab)][_0x104ff6]&&_0x1993a2['votes'][_0x104ff6]['includes'](_0x136dee);if(!_0xeb0ce){for(const _0xabee35 in _0x1993a2[_0x176e5e(0x2ab)]){const _0x1b9acc=_0x1993a2['votes'][_0xabee35]['indexOf'](_0x136dee);_0x1b9acc>-0x1&&_0x1993a2['votes'][_0xabee35][_0x176e5e(0x3e6)](_0x1b9acc,0x1);}!_0x1993a2[_0x176e5e(0x2ab)][_0x104ff6]&&(_0x1993a2[_0x176e5e(0x2ab)][_0x104ff6]=[]),_0x1993a2[_0x176e5e(0x2ab)][_0x104ff6][_0x176e5e(0xa49)](_0x136dee);}let _0x2802d2=null;!_0xeb0ce&&(_0x2802d2='[系统提示：用户\x20('+_0x136dee+_0x176e5e(0x15e)+_0x104ff6+'”。]');if(_0x2802d2){const _0x4d9a48={'role':_0x176e5e(0x46c),'content':_0x2802d2,'timestamp':Date[_0x176e5e(0x1ed)](),'isHidden':!![]};_0x22da16[_0x176e5e(0xd39)][_0x176e5e(0xa49)](_0x4d9a48);}await _0x15043e['chats'][_0x176e5e(0xfaa)](_0x22da16),_0x7dbe71(_0x405767['activeChatId']);}async function _0xac2567(_0xa36910){const _0x31f005=_0x18b51e,_0x117ae6=_0x405767[_0x31f005(0x799)][_0x405767[_0x31f005(0x248)]],_0x2ae700=_0x117ae6[_0x31f005(0xd39)][_0x31f005(0x2ef)](_0xf473a0=>_0xf473a0[_0x31f005(0x351)]===_0xa36910);if(!_0x2ae700||_0x2ae700[_0x31f005(0x855)])return;const _0x346359=await _0x8b9cb8(_0x31f005(0x3af),_0x31f005(0x1136));if(_0x346359){_0x2ae700[_0x31f005(0x855)]=!![];const _0x1487aa=_0x2ae700[_0x31f005(0x320)]['map'](_0x567ef8=>'“'+_0x567ef8+'”('+(_0x2ae700[_0x31f005(0x2ab)][_0x567ef8]?.['length']||0x0)+'票)')[_0x31f005(0xb2c)]('，'),_0x25e2f1=_0x31f005(0xd3b)+_0x1487aa+'。]',_0x44b1a2={'role':'system','content':_0x25e2f1,'timestamp':Date[_0x31f005(0x1ed)](),'isHidden':!![]};_0x117ae6[_0x31f005(0xd39)][_0x31f005(0xa49)](_0x44b1a2),await _0x15043e['chats'][_0x31f005(0xfaa)](_0x117ae6),_0x7dbe71(_0x405767['activeChatId']);}}function _0x57f1a4(_0x35c8b4){const _0x2b6c91=_0x18b51e,_0x2a2110=_0x405767[_0x2b6c91(0x799)][_0x405767['activeChatId']],_0x496e60=_0x2a2110[_0x2b6c91(0xd39)]['find'](_0x2d42c4=>_0x2d42c4[_0x2b6c91(0x351)]===_0x35c8b4);if(!_0x496e60||!_0x496e60[_0x2b6c91(0x855)])return;let _0x53a184=_0x2b6c91(0x1089)+_0x496e60[_0x2b6c91(0x8c4)]+_0x2b6c91(0x5dd);Object[_0x2b6c91(0xbda)](_0x496e60[_0x2b6c91(0x2ab)])[_0x2b6c91(0x105a)]===0x0?_0x53a184+=_0x2b6c91(0x399):_0x496e60['options'][_0x2b6c91(0x7c0)](_0x2a6fd8=>{const _0x974b08=_0x2b6c91,_0x5e81e6=_0x496e60[_0x974b08(0x2ab)][_0x2a6fd8]||[],_0x2701a6=_0x5e81e6[_0x974b08(0x6b9)](_0x48125d=>_0x1ba34a(_0x2a2110,_0x48125d))['join']('、\x20');_0x53a184+=_0x974b08(0x999)+_0x2a6fd8+'\x20('+_0x5e81e6[_0x974b08(0x105a)]+_0x974b08(0xb6b)+(_0x5e81e6['length']>0x0?_0x2701a6:'无人投票')+_0x974b08(0x1182);}),_0x501c7b(_0x2b6c91(0x1019),_0x53a184);}function _0x134fcc(){const _0x1a057a=_0x18b51e;if(!_0x405767['activeChatId'])return;const _0x2b4d20=_0x405767[_0x1a057a(0x799)][_0x405767[_0x1a057a(0x248)]];document['getElementById'](_0x1a057a(0xccd))['textContent']='“'+_0x2b4d20['name']+_0x1a057a(0xe72),_0x370e39(),document[_0x1a057a(0x8c2)](_0x1a057a(0xa70))[_0x1a057a(0xb17)][_0x1a057a(0x3f4)]('visible');}function _0x370e39(){const _0x479ef9=_0x18b51e,_0x29bc43=document[_0x479ef9(0x8c2)](_0x479ef9(0xcd1));_0x29bc43[_0x479ef9(0xca0)]='';const _0x24c0d5=_0x405767[_0x479ef9(0x799)][_0x405767['activeChatId']],_0x40980c=_0x24c0d5[_0x479ef9(0x33a)][_0x479ef9(0xca4)]||[];if(_0x40980c[_0x479ef9(0x105a)]===0x0){_0x29bc43[_0x479ef9(0xca0)]=_0x479ef9(0xe17);return;}_0x40980c[_0x479ef9(0x7c0)]((_0x2453ab,_0x261a94)=>{const _0x58359a=_0x479ef9,_0xdf4e08=document[_0x58359a(0x8c1)](_0x58359a(0x1072));_0xdf4e08['className']=_0x58359a(0xe5a),_0xdf4e08[_0x58359a(0xcea)]=_0x2453ab['name'],_0xdf4e08['innerHTML']=_0x58359a(0x4ab)+_0x2453ab[_0x58359a(0x9d6)]+_0x58359a(0xb39)+_0x2453ab['name']+_0x58359a(0x10e2);const _0x1a3224=document['createElement'](_0x58359a(0x1072));_0x1a3224[_0x58359a(0x84c)]=_0x58359a(0x517),_0x1a3224['innerHTML']='×',_0x1a3224[_0x58359a(0x842)][_0x58359a(0x5e9)]=_0x58359a(0xea7),_0x1a3224[_0x58359a(0xcda)]=async _0x26a5f1=>{const _0x2fdd0d=_0x58359a;_0x26a5f1[_0x2fdd0d(0x601)]();const _0x2a15f4=await _0x8b9cb8('删除头像',_0x2fdd0d(0x829)+_0x2453ab[_0x2fdd0d(0x596)]+_0x2fdd0d(0x116e),{'confirmButtonClass':_0x2fdd0d(0xe2a)});_0x2a15f4&&(_0x24c0d5[_0x2fdd0d(0x33a)]['aiAvatarLibrary'][_0x2fdd0d(0x3e6)](_0x261a94,0x1),await _0x15043e['chats'][_0x2fdd0d(0xfaa)](_0x24c0d5),_0x370e39());},_0xdf4e08[_0x58359a(0x31e)](_0x1a3224),_0x29bc43['appendChild'](_0xdf4e08);});}async function _0x492bb2(){const _0x134cd5=_0x18b51e,_0x40236e=await _0x180f74(_0x134cd5(0xcd9),_0x134cd5(0xb27));if(!_0x40236e||!_0x40236e[_0x134cd5(0x8c6)]())return;const _0x1e79c7=await _0x180f74(_0x134cd5(0xcd9),_0x134cd5(0x6e8),'',_0x134cd5(0x9d6));if(!_0x1e79c7||!_0x1e79c7[_0x134cd5(0x8c6)]()['startsWith'](_0x134cd5(0xcce))){alert(_0x134cd5(0xba6));return;}const _0x31c2f0=_0x405767['chats'][_0x405767['activeChatId']];!_0x31c2f0[_0x134cd5(0x33a)][_0x134cd5(0xca4)]&&(_0x31c2f0['settings']['aiAvatarLibrary']=[]),_0x31c2f0[_0x134cd5(0x33a)][_0x134cd5(0xca4)][_0x134cd5(0xa49)]({'name':_0x40236e[_0x134cd5(0x8c6)](),'url':_0x1e79c7[_0x134cd5(0x8c6)]()}),await _0x15043e['chats'][_0x134cd5(0xfaa)](_0x31c2f0),_0x370e39();}function _0x90f937(){const _0x3fd937=_0x18b51e;document[_0x3fd937(0x8c2)](_0x3fd937(0xa70))['classList'][_0x3fd937(0xaff)](_0x3fd937(0x2cd));}function _0x700281(){const _0x69b516=_0x18b51e;if(!_0x405767['activeChatId'])return;const _0x4c1bdf=_0x405767[_0x69b516(0x799)][_0x405767[_0x69b516(0x248)]];document[_0x69b516(0x8c2)](_0x69b516(0x7df))[_0x69b516(0x1090)]='“'+(_0x4c1bdf[_0x69b516(0x33a)][_0x69b516(0xe16)]||'我')+'”的头像库',_0x4f5b7f(),document[_0x69b516(0x8c2)]('my-avatar-library-modal')[_0x69b516(0xb17)][_0x69b516(0x3f4)](_0x69b516(0x2cd));}function _0x4f5b7f(){const _0x16d4d2=_0x18b51e,_0x79a44d=document['getElementById']('my-avatar-library-grid');_0x79a44d[_0x16d4d2(0xca0)]='';const _0x889f5e=_0x405767[_0x16d4d2(0x799)][_0x405767['activeChatId']],_0xe8ca84=_0x889f5e['settings'][_0x16d4d2(0x567)]||[];if(_0xe8ca84[_0x16d4d2(0x105a)]===0x0){_0x79a44d[_0x16d4d2(0xca0)]=_0x16d4d2(0xe17);return;}_0xe8ca84[_0x16d4d2(0x7c0)]((_0x2b63a2,_0x4d6399)=>{const _0x4fe959=_0x16d4d2,_0x161d02=document[_0x4fe959(0x8c1)]('div');_0x161d02['className']='sticker-item',_0x161d02[_0x4fe959(0xcea)]=_0x2b63a2['name'],_0x161d02[_0x4fe959(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url('+_0x2b63a2[_0x4fe959(0x9d6)]+_0x4fe959(0xb39)+_0x2b63a2[_0x4fe959(0x596)]+_0x4fe959(0x10e2);const _0x4f4f3f=document[_0x4fe959(0x8c1)](_0x4fe959(0x1072));_0x4f4f3f[_0x4fe959(0x84c)]='delete-btn',_0x4f4f3f['innerHTML']='×',_0x4f4f3f[_0x4fe959(0x842)]['display']=_0x4fe959(0xea7),_0x4f4f3f[_0x4fe959(0xcda)]=async _0x5aff1d=>{const _0x486521=_0x4fe959;_0x5aff1d[_0x486521(0x601)]();const _0x232d38=await _0x8b9cb8(_0x486521(0x7ec),_0x486521(0x18a)+_0x2b63a2['name']+_0x486521(0x116e),{'confirmButtonClass':_0x486521(0xe2a)});_0x232d38&&(_0x889f5e[_0x486521(0x33a)][_0x486521(0x567)][_0x486521(0x3e6)](_0x4d6399,0x1),await _0x15043e[_0x486521(0x799)]['put'](_0x889f5e),_0x4f5b7f());},_0x161d02[_0x4fe959(0x31e)](_0x4f4f3f),_0x79a44d[_0x4fe959(0x31e)](_0x161d02);});}async function _0x1cf9e3(){const _0x563d21=_0x18b51e,_0x3d90c4=await _0x180f74(_0x563d21(0xcd9),_0x563d21(0xb27));if(!_0x3d90c4||!_0x3d90c4[_0x563d21(0x8c6)]())return;const _0x150011=await _0x180f74(_0x563d21(0xcd9),'请输入头像的图片URL','',_0x563d21(0x9d6));if(!_0x150011||!_0x150011['trim']()[_0x563d21(0xc7c)](_0x563d21(0xcce))){alert(_0x563d21(0xba6));return;}const _0x37b115=_0x405767[_0x563d21(0x799)][_0x405767['activeChatId']];!_0x37b115[_0x563d21(0x33a)][_0x563d21(0x567)]&&(_0x37b115['settings'][_0x563d21(0x567)]=[]),_0x37b115[_0x563d21(0x33a)][_0x563d21(0x567)]['push']({'name':_0x3d90c4[_0x563d21(0x8c6)](),'url':_0x150011[_0x563d21(0x8c6)]()}),await _0x15043e[_0x563d21(0x799)]['put'](_0x37b115),_0x4f5b7f();}async function _0x4a1c97(_0x418254){const _0x521464=_0x18b51e,_0x2f2fc9=_0x418254['target'][_0x521464(0xde8)][0x0];if(!_0x2f2fc9)return;const _0x270b9a=await new Promise(_0x144b88=>{const _0x4da7fa=_0x521464,_0x3d015d=new FileReader();_0x3d015d[_0x4da7fa(0xe7a)]=()=>_0x144b88(_0x3d015d[_0x4da7fa(0xa92)]),_0x3d015d[_0x4da7fa(0x779)](_0x2f2fc9);}),_0x32d91c=await _0x180f74(_0x521464(0x179),_0x521464(0xcbf));if(!_0x32d91c||!_0x32d91c[_0x521464(0x8c6)]())return;const _0x1b780b=_0x405767[_0x521464(0x799)][_0x405767['activeChatId']];!_0x1b780b[_0x521464(0x33a)][_0x521464(0x567)]&&(_0x1b780b[_0x521464(0x33a)][_0x521464(0x567)]=[]),_0x1b780b[_0x521464(0x33a)][_0x521464(0x567)]['push']({'name':_0x32d91c[_0x521464(0x8c6)](),'url':_0x270b9a}),await _0x15043e[_0x521464(0x799)][_0x521464(0xfaa)](_0x1b780b),_0x4f5b7f(),_0x418254['target'][_0x521464(0x518)]=null;}async function _0x1cd58d(_0x5be86c){const _0x193e47=_0x18b51e,_0xdeb297=_0x405767[_0x193e47(0x799)][_0x405767[_0x193e47(0x248)]];if(!_0xdeb297)return;const _0x535f91=_0x5be86c[_0x193e47(0x8c6)]()['split']('\x0a'),_0x5f30bb=[],_0x6c4d44=_0x193e47(0xd60);let _0x321209=0x0;for(const _0x2655e0 of _0x535f91){const _0x4fc523=_0x2655e0[_0x193e47(0x8c6)]();if(!_0x4fc523||_0x4fc523[_0x193e47(0x773)]('http')||_0x4fc523[_0x193e47(0x773)]('填入'))continue;let _0x310861=null,_0x4dfaf4=null;const _0x5a2926=_0x4fc523['match'](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x5a2926)_0x310861=_0x5a2926[0x1],_0x4dfaf4=_0x5a2926[0x2];else{const _0x5cd751=_0x4fc523[_0x193e47(0x111f)](/\s+/);_0x5cd751[_0x193e47(0x105a)]>=0x2&&(_0x4dfaf4=_0x5cd751[_0x193e47(0xd64)](),_0x310861=_0x5cd751[_0x193e47(0xb2c)]('\x20'));}_0x310861&&_0x4dfaf4&&_0x4dfaf4[_0x193e47(0x773)]('.')?_0x5f30bb[_0x193e47(0xa49)]({'name':_0x310861,'url':_0x6c4d44+_0x4dfaf4}):_0x321209++;}if(_0x321209>0x0)await _0x501c7b(_0x193e47(0xbf4),'有\x20'+_0x321209+_0x193e47(0xa6f));if(_0x5f30bb[_0x193e47(0x105a)]>0x0){if(!_0xdeb297[_0x193e47(0x33a)][_0x193e47(0x567)])_0xdeb297[_0x193e47(0x33a)]['myAvatarLibrary']=[];_0xdeb297[_0x193e47(0x33a)]['myAvatarLibrary'][_0x193e47(0xa49)](..._0x5f30bb),await _0x15043e[_0x193e47(0x799)][_0x193e47(0xfaa)](_0xdeb297),_0x4f5b7f(),await _0x501c7b(_0x193e47(0x95b),'已成功批量导入\x20'+_0x5f30bb[_0x193e47(0x105a)]+_0x193e47(0xc51));}else _0x321209===0x0&&alert(_0x193e47(0x38e));}function _0x4d3455(){const _0x230021=_0x18b51e;document['getElementById']('my-avatar-library-modal')[_0x230021(0xb17)][_0x230021(0xaff)]('visible');}function _0x284075(){const _0x4c5ffb=_0x18b51e;if(!_0x405767[_0x4c5ffb(0x248)])return;const _0x347536=_0x405767[_0x4c5ffb(0x799)][_0x405767[_0x4c5ffb(0x248)]];document[_0x4c5ffb(0x8c2)](_0x4c5ffb(0xf4e))[_0x4c5ffb(0x1090)]='“'+_0x347536[_0x4c5ffb(0x596)]+_0x4c5ffb(0xe72),_0x4096ca(),document[_0x4c5ffb(0x8c2)](_0x4c5ffb(0x1086))['classList'][_0x4c5ffb(0x3f4)](_0x4c5ffb(0x2cd));}function _0x4096ca(){const _0xed75a7=_0x18b51e,_0xb038d0=document[_0xed75a7(0x8c2)](_0xed75a7(0xb20));_0xb038d0['innerHTML']='';const _0x11f2bb=_0x405767[_0xed75a7(0x799)][_0x405767[_0xed75a7(0x248)]],_0x3b5935=_0x11f2bb[_0xed75a7(0x33a)]['groupAvatarLibrary']||[];if(_0x3b5935[_0xed75a7(0x105a)]===0x0){_0xb038d0[_0xed75a7(0xca0)]=_0xed75a7(0xe17);return;}_0x3b5935[_0xed75a7(0x7c0)]((_0x3cc3b5,_0x359990)=>{const _0x11d783=_0xed75a7,_0xff0281=document[_0x11d783(0x8c1)](_0x11d783(0x1072));_0xff0281[_0x11d783(0x84c)]='sticker-item',_0xff0281[_0x11d783(0xcea)]=_0x3cc3b5[_0x11d783(0x596)],_0xff0281[_0x11d783(0xca0)]=_0x11d783(0x4ab)+_0x3cc3b5['url']+');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>'+_0x3cc3b5[_0x11d783(0x596)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x229d9e=document[_0x11d783(0x8c1)](_0x11d783(0x1072));_0x229d9e[_0x11d783(0x84c)]=_0x11d783(0x517),_0x229d9e[_0x11d783(0xca0)]='×',_0x229d9e[_0x11d783(0x842)][_0x11d783(0x5e9)]=_0x11d783(0xea7),_0x229d9e[_0x11d783(0xcda)]=async _0x525d59=>{const _0x15ebd8=_0x11d783;_0x525d59['stopPropagation']();const _0x32ccb7=await _0x8b9cb8(_0x15ebd8(0x7ec),_0x15ebd8(0x829)+_0x3cc3b5['name']+'”吗？',{'confirmButtonClass':'btn-danger'});_0x32ccb7&&(_0x11f2bb[_0x15ebd8(0x33a)]['groupAvatarLibrary'][_0x15ebd8(0x3e6)](_0x359990,0x1),await _0x15043e[_0x15ebd8(0x799)]['put'](_0x11f2bb),_0x4096ca());},_0xff0281['appendChild'](_0x229d9e),_0xb038d0[_0x11d783(0x31e)](_0xff0281);});}async function _0x3964af(){const _0x442c38=_0x18b51e,_0x3743bc=await _0x180f74(_0x442c38(0xcd9),_0x442c38(0x269));if(!_0x3743bc||!_0x3743bc[_0x442c38(0x8c6)]())return;const _0xeea9aa=await _0x180f74(_0x442c38(0xcd9),_0x442c38(0x6e8),'',_0x442c38(0x9d6));if(!_0xeea9aa||!_0xeea9aa['trim']()[_0x442c38(0xc7c)](_0x442c38(0xcce))){alert('请输入有效的图片URL！');return;}const _0x339162=_0x405767[_0x442c38(0x799)][_0x405767[_0x442c38(0x248)]];!_0x339162['settings'][_0x442c38(0x227)]&&(_0x339162[_0x442c38(0x33a)][_0x442c38(0x227)]=[]),_0x339162[_0x442c38(0x33a)]['groupAvatarLibrary'][_0x442c38(0xa49)]({'name':_0x3743bc[_0x442c38(0x8c6)](),'url':_0xeea9aa['trim']()}),await _0x15043e['chats'][_0x442c38(0xfaa)](_0x339162),_0x4096ca();}function _0xe3fc74(){const _0x3e5f53=_0x18b51e;document[_0x3e5f53(0x8c2)](_0x3e5f53(0x1086))[_0x3e5f53(0xb17)][_0x3e5f53(0xaff)](_0x3e5f53(0x2cd));}async function _0x2cdedb(_0x40471d){const _0x3920b8=_0x18b51e,_0x121670=_0x3920b8(0xe9e),_0x475bf0=await _0x180f74(_0x3920b8(0xcba),_0x121670,'',_0x3920b8(0x6c3));_0x475bf0&&_0x475bf0[_0x3920b8(0x8c6)]()&&await _0x478ecf(_0x40471d,_0x475bf0);}async function _0x478ecf(_0x4af99e,_0x93c396){const _0x4b4d30=_0x18b51e,_0x3a4984=_0x405767['chats'][_0x405767[_0x4b4d30(0x248)]];if(!_0x3a4984)return;const _0x44f159=_0x93c396['trim']()[_0x4b4d30(0x111f)]('\x0a'),_0x46f03e=[],_0x41de92=_0x4b4d30(0xd60);let _0x6c0adc=0x0;for(const _0x5ce51e of _0x44f159){const _0x364916=_0x5ce51e[_0x4b4d30(0x8c6)]();if(!_0x364916||_0x364916[_0x4b4d30(0x773)](_0x4b4d30(0xcce))||_0x364916[_0x4b4d30(0x773)]('填入'))continue;let _0xa6e3c9=null,_0x354509=null;const _0x275cb3=_0x364916['match'](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x275cb3)_0xa6e3c9=_0x275cb3[0x1],_0x354509=_0x275cb3[0x2];else{const _0x6716cb=_0x364916[_0x4b4d30(0x111f)](/\s+/);_0x6716cb['length']>=0x2&&(_0x354509=_0x6716cb[_0x4b4d30(0xd64)](),_0xa6e3c9=_0x6716cb['join']('\x20'));}_0xa6e3c9&&_0x354509&&_0x354509[_0x4b4d30(0x773)]('.')?_0x46f03e[_0x4b4d30(0xa49)]({'name':_0xa6e3c9,'url':_0x41de92+_0x354509}):(_0x6c0adc++,console[_0x4b4d30(0x112a)](_0x4b4d30(0x8ab),_0x364916));}_0x6c0adc>0x0&&await _0x501c7b(_0x4b4d30(0xbf4),'有\x20'+_0x6c0adc+'\x20行的格式不正确，已被系统跳过。');if(_0x46f03e[_0x4b4d30(0x105a)]>0x0){if(_0x4af99e==='ai'){if(!_0x3a4984['settings'][_0x4b4d30(0xca4)])_0x3a4984[_0x4b4d30(0x33a)][_0x4b4d30(0xca4)]=[];_0x3a4984[_0x4b4d30(0x33a)][_0x4b4d30(0xca4)][_0x4b4d30(0xa49)](..._0x46f03e),await _0x15043e[_0x4b4d30(0x799)][_0x4b4d30(0xfaa)](_0x3a4984),_0x370e39();}else{if(_0x4af99e===_0x4b4d30(0x92f)){if(!_0x3a4984[_0x4b4d30(0x33a)][_0x4b4d30(0x227)])_0x3a4984[_0x4b4d30(0x33a)][_0x4b4d30(0x227)]=[];_0x3a4984[_0x4b4d30(0x33a)][_0x4b4d30(0x227)][_0x4b4d30(0xa49)](..._0x46f03e),await _0x15043e[_0x4b4d30(0x799)]['put'](_0x3a4984),_0x4096ca();}}await _0x501c7b(_0x4b4d30(0x95b),_0x4b4d30(0x52c)+_0x46f03e[_0x4b4d30(0x105a)]+_0x4b4d30(0xc51));}else _0x6c0adc===0x0&&alert('没有找到可导入的内容。请检查您粘贴的格式是否正确。');}async function _0x21dd40(){const _0x1054f6=_0x18b51e,_0x57de2f=await _0x180f74(_0x1054f6(0xcd9),_0x1054f6(0x269));if(!_0x57de2f||!_0x57de2f['trim']())return;const _0x2147f2=await _0x180f74('添加头像',_0x1054f6(0x6e8),'',_0x1054f6(0x9d6));if(!_0x2147f2||!_0x2147f2[_0x1054f6(0x8c6)]()[_0x1054f6(0xc7c)]('http')){alert(_0x1054f6(0xba6));return;}const _0x2d68fc=_0x405767[_0x1054f6(0x799)][_0x405767[_0x1054f6(0x248)]];!_0x2d68fc[_0x1054f6(0x33a)][_0x1054f6(0x227)]&&(_0x2d68fc['settings'][_0x1054f6(0x227)]=[]),_0x2d68fc[_0x1054f6(0x33a)][_0x1054f6(0x227)][_0x1054f6(0xa49)]({'name':_0x57de2f[_0x1054f6(0x8c6)](),'url':_0x2147f2[_0x1054f6(0x8c6)]()}),await _0x15043e['chats'][_0x1054f6(0xfaa)](_0x2d68fc),_0x4096ca();}function _0x2f7db0(_0x103d54){return new Promise(_0x421439=>{const _0x4a7ba0=_0x7a65,_0x632773=document[_0x4a7ba0(0x8c2)](_0x4a7ba0(0x82c)),_0x2bbffe=document[_0x4a7ba0(0x8c2)](_0x4a7ba0(0xcc7)),_0x3274ac=document[_0x4a7ba0(0x8c2)](_0x4a7ba0(0x609)),_0x406435=document['getElementById'](_0x4a7ba0(0x8c0));_0x2bbffe[_0x4a7ba0(0x1090)]=_0x103d54[_0x4a7ba0(0xe06)]?_0x4a7ba0(0x3c5):_0x4a7ba0(0x10f3);const _0x1aa7cc=_0x2bbffe[_0x4a7ba0(0xac5)](!![]);_0x2bbffe['parentNode'][_0x4a7ba0(0x56b)](_0x1aa7cc,_0x2bbffe),_0x1aa7cc[_0x4a7ba0(0xcda)]=()=>{const _0x3a27da=_0x4a7ba0;_0x632773[_0x3a27da(0xb17)][_0x3a27da(0xaff)](_0x3a27da(0x2cd)),_0x421439(_0x3a27da(0x686));};const _0x230f9e=_0x3274ac[_0x4a7ba0(0xac5)](!![]);_0x3274ac[_0x4a7ba0(0xe66)][_0x4a7ba0(0x56b)](_0x230f9e,_0x3274ac),_0x230f9e[_0x4a7ba0(0xcda)]=()=>{const _0x2e60e1=_0x4a7ba0;_0x632773[_0x2e60e1(0xb17)][_0x2e60e1(0xaff)](_0x2e60e1(0x2cd)),_0x421439(_0x2e60e1(0x89f));};const _0x105d97=_0x406435[_0x4a7ba0(0xac5)](!![]);_0x406435[_0x4a7ba0(0xe66)][_0x4a7ba0(0x56b)](_0x105d97,_0x406435),_0x105d97['onclick']=()=>{const _0x421d9b=_0x4a7ba0;_0x632773['classList'][_0x421d9b(0xaff)]('visible'),_0x421439(null);},_0x632773[_0x4a7ba0(0xb17)][_0x4a7ba0(0x3f4)](_0x4a7ba0(0x2cd));});}function _0x5f1ba2(){const _0xa82375=_0x18b51e,_0x284686=document['getElementById'](_0xa82375(0x9ec)),_0x5ebf82=_0x405767['globalSettings'][_0xa82375(0x64a)];_0x5ebf82?_0x284686[_0xa82375(0x842)][_0xa82375(0xfff)]='url('+_0x5ebf82+')':_0x284686['style']['backgroundImage']=_0xa82375(0xd6a);}function _0xf3d9cb(){const _0x35eaee=_0x18b51e;if(!_0x405767['globalSettings'][_0x35eaee(0x429)])return;for(const _0x161225 in _0x405767[_0x35eaee(0xb73)][_0x35eaee(0x429)]){const _0xe80598=document['getElementById'](_0x35eaee(0xa15)+_0x161225);_0xe80598&&(_0xe80598[_0x35eaee(0x939)]=_0x405767[_0x35eaee(0xb73)][_0x35eaee(0x429)][_0x161225]);}}function _0x3fb772(){const _0xeaec69=_0x18b51e,_0x20333c=document[_0xeaec69(0x8c2)](_0xeaec69(0x241));if(!_0x20333c)return;_0x20333c[_0xeaec69(0xca0)]='';const _0x25a20c={'qq':'QQ','album':'相册','browser':_0xeaec69(0xc9c),'taobao':'淘宝','memo':_0xeaec69(0x1169),'diary':'日记','amap':_0xeaec69(0xc1c),'usage':'App记录','music':_0xeaec69(0x9be),'ephone':_0xeaec69(0xdd2)};for(const _0x24f6e2 in _0x405767[_0xeaec69(0xb73)][_0xeaec69(0x429)]){const _0x89198e=_0x405767[_0xeaec69(0xb73)]['cphoneAppIcons'][_0x24f6e2],_0x196170=_0x25a20c[_0x24f6e2]||_0xeaec69(0xa66),_0x3433e1=document[_0xeaec69(0x8c1)](_0xeaec69(0x1072));_0x3433e1[_0xeaec69(0x84c)]=_0xeaec69(0xf9e),_0x3433e1[_0xeaec69(0x323)][_0xeaec69(0xc9b)]=_0x24f6e2,_0x3433e1[_0xeaec69(0xca0)]=_0xeaec69(0xdb7)+_0x89198e+_0xeaec69(0x1023)+_0x196170+_0xeaec69(0x563),_0x20333c[_0xeaec69(0x31e)](_0x3433e1);}}function _0x1ff3cc(){const _0x284396=_0x18b51e;if(!_0x405767[_0x284396(0xb73)][_0x284396(0x18d)])return;for(const _0x264edb in _0x405767['globalSettings'][_0x284396(0x18d)]){const _0x3fff19=document[_0x284396(0x8c2)](_0x284396(0xbeb)+_0x264edb);_0x3fff19&&(_0x3fff19[_0x284396(0x939)]=_0x405767['globalSettings'][_0x284396(0x18d)][_0x264edb]);}}function _0x1d40b4(){const _0x1496c0=_0x18b51e,_0x3895e6=document[_0x1496c0(0x8c2)]('icon-settings-grid');if(!_0x3895e6)return;_0x3895e6[_0x1496c0(0xca0)]='';const _0x2cec47={'qq':'QQ','world-book':_0x1496c0(0xf8b),'wallpaper':_0x1496c0(0x8a7),'renderer':_0x1496c0(0xae3),'api-settings':_0x1496c0(0x806),'font':'字体','char-phone':_0x1496c0(0x127e),'douban':_0x1496c0(0xeea),'preset':'预设','tutorial':'教程','werewolf':_0x1496c0(0x1133),'x':'X'};for(const _0x3c9a56 in _0x405767['globalSettings'][_0x1496c0(0x18d)]){const _0x2859eb=_0x405767[_0x1496c0(0xb73)][_0x1496c0(0x18d)][_0x3c9a56],_0x2ad5f1=_0x2cec47[_0x3c9a56]||_0x1496c0(0x127e),_0x5458ec=document[_0x1496c0(0x8c1)]('div');_0x5458ec[_0x1496c0(0x84c)]=_0x1496c0(0xf9e),_0x5458ec[_0x1496c0(0x323)][_0x1496c0(0xc9b)]=_0x3c9a56,_0x5458ec[_0x1496c0(0xca0)]=_0x1496c0(0xdb7)+_0x2859eb+'\x22\x20alt=\x22'+_0x2ad5f1+_0x1496c0(0x563),_0x3895e6['appendChild'](_0x5458ec);}}function _0xf68cbe(_0x3d1b30){const _0x4b4556=_0x18b51e;if(!_0x405767['activeChatId'])return;const _0x446c2c=_0x405767[_0x4b4556(0x799)][_0x405767[_0x4b4556(0x248)]];if(!_0x446c2c||!_0x446c2c['history'])return;const _0x54f035=_0x446c2c[_0x4b4556(0xd39)][_0x4b4556(0x2ef)](_0x211489=>_0x211489[_0x4b4556(0x351)]===_0x3d1b30);if(!_0x54f035||_0x54f035[_0x4b4556(0xde0)]!=='share_link'){console[_0x4b4556(0x7a3)](_0x4b4556(0x7eb),_0x3d1b30);return;}document[_0x4b4556(0x8c2)](_0x4b4556(0x913))['textContent']=_0x54f035[_0x4b4556(0xefa)]||_0x4b4556(0x79a);const _0x1dc53f=document['getElementById'](_0x4b4556(0xc2f));_0x1dc53f['innerHTML']=_0x4b4556(0x31c)+(_0x54f035[_0x4b4556(0xcea)]||'无标题')+_0x4b4556(0x2a8)+(_0x54f035['source_name']||'未知')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+(_0x54f035[_0x4b4556(0x168)]||'内容为空。')[_0x4b4556(0x1b7)](/\n/g,'</p><p>')+_0x4b4556(0x3a8),_0x3d1990('browser-screen');}function _0x42415b(){_0x3d1990('chat-interface-screen');}function _0x42415b(){const _0x4bbc0b=_0x18b51e;_0x3d1990(_0x4bbc0b(0xd5c));}function _0x3e074c(){const _0x196a3b=_0x18b51e;if(!_0x405767['activeChatId'])return;document[_0x196a3b(0x8c2)](_0x196a3b(0xbc9))[_0x196a3b(0x518)]='',document[_0x196a3b(0x8c2)](_0x196a3b(0x5a3))[_0x196a3b(0x518)]='',document[_0x196a3b(0x8c2)](_0x196a3b(0xf67))['value']='',document[_0x196a3b(0x8c2)](_0x196a3b(0x11e2))[_0x196a3b(0x518)]='',document['getElementById'](_0x196a3b(0x1201))['classList'][_0x196a3b(0x3f4)](_0x196a3b(0x2cd));}async function _0xa4fd57(){const _0x4ca694=_0x18b51e;if(!_0x405767[_0x4ca694(0x248)])return;const _0x45a6d6=document[_0x4ca694(0x8c2)]('link-title-input')['value'][_0x4ca694(0x8c6)]();if(!_0x45a6d6){alert('标题是必填项哦！');return;}const _0x5ca2ad=document[_0x4ca694(0x8c2)](_0x4ca694(0x5a3))[_0x4ca694(0x518)][_0x4ca694(0x8c6)](),_0x4bbc02=document['getElementById'](_0x4ca694(0xf67))['value']['trim'](),_0x5de55a=document[_0x4ca694(0x8c2)](_0x4ca694(0x11e2))[_0x4ca694(0x518)][_0x4ca694(0x8c6)](),_0x52c691=_0x405767[_0x4ca694(0x799)][_0x405767['activeChatId']],_0x2d0952={'role':'user','type':'share_link','timestamp':Date[_0x4ca694(0x1ed)](),'title':_0x45a6d6,'description':_0x5ca2ad,'source_name':_0x4bbc02,'content':_0x5de55a,'thumbnail_url':null};_0x52c691['history']['push'](_0x2d0952),await _0x15043e[_0x4ca694(0x799)][_0x4ca694(0xfaa)](_0x52c691),_0x5c5c92(_0x2d0952,_0x52c691),_0x2b55d1(),document['getElementById'](_0x4ca694(0x1201))[_0x4ca694(0xb17)][_0x4ca694(0xaff)](_0x4ca694(0x2cd));}function _0x12538d(_0x3a239e,_0x1b4585){const _0x1a2e9b=_0x18b51e;if(!_0x1b4585||!_0x1b4585['id'])return[];const _0x3d9a52=_0x1b4585[_0x1a2e9b(0x40f)],_0x6dbda5=_0x1b4585['id'];return _0x3a239e[_0x1a2e9b(0x1d8)](_0x751354=>{const _0x4f6a4f=_0x1a2e9b;if(_0x751354[_0x4f6a4f(0x802)]==='user'){if(_0x751354[_0x4f6a4f(0x1105)]&&_0x751354[_0x4f6a4f(0x1105)][_0x4f6a4f(0x105a)]>0x0)return _0x3d9a52&&_0x751354['visibleGroupIds'][_0x4f6a4f(0x773)](_0x3d9a52);return!![];}if(String(_0x751354[_0x4f6a4f(0x802)])[_0x4f6a4f(0xc7c)](_0x4f6a4f(0x5ea))){if(Array[_0x4f6a4f(0xb85)](_0x751354[_0x4f6a4f(0x107b)]))return _0x751354['visibleTo'][_0x4f6a4f(0x773)](_0x6dbda5);return![];}const _0x4ee6b7=_0x405767['chats'][_0x751354['authorId']];if(!_0x4ee6b7)return![];const _0xe7bb69=_0x4ee6b7['groupId'],_0xce4fbe=_0xe7bb69&&_0x3d9a52&&_0xe7bb69===_0x3d9a52,_0x1c3307=!_0xe7bb69&&!_0x3d9a52;return _0xce4fbe||_0x1c3307;});}function _0x569569(_0x5c339c){const _0x2ee094=_0x18b51e,_0x480596=document[_0x2ee094(0x8c2)](_0x2ee094(0x5e7)),_0x4a8590=document[_0x2ee094(0x8c2)](_0x2ee094(0xacf)),_0x225475=_0x5c339c===_0x2ee094(0xb72);_0x480596[_0x2ee094(0xb17)][_0x2ee094(0xfc3)]('dark-mode',_0x225475),_0x4a8590&&(_0x4a8590[_0x2ee094(0x75f)]=_0x225475),localStorage[_0x2ee094(0x277)]('ephone-theme',_0x5c339c);}function _0x56038d(){const _0x1d78e3=_0x18b51e,_0x5f331e=document[_0x1d78e3(0x8c2)](_0x1d78e3(0xacf)),_0x5c4919=_0x5f331e[_0x1d78e3(0x75f)]?_0x1d78e3(0xb72):_0x1d78e3(0xa14);_0x569569(_0x5c4919);}function _0x13d5c4(){const _0x1eb3d1=_0x18b51e;if(!_0x405767[_0x1eb3d1(0x248)])return;_0x4d8753(),_0x3d1990('long-term-memory-screen');}function _0x4d8753(){const _0x24708d=_0x18b51e,_0x319f8b=document[_0x24708d(0x8c2)](_0x24708d(0x69b)),_0xe398f4=_0x405767['chats'][_0x405767['activeChatId']];_0x319f8b[_0x24708d(0xca0)]='';let _0x3c3b62=[];_0xe398f4[_0x24708d(0x1000)]?_0xe398f4['members'][_0x24708d(0x7c0)](_0x5e8819=>{const _0x23915e=_0x24708d,_0x5d3bcd=_0x405767[_0x23915e(0x799)][_0x5e8819['id']];if(_0x5d3bcd&&_0x5d3bcd[_0x23915e(0xbca)]){const _0x2c218f=_0x5d3bcd[_0x23915e(0xbca)]['map'](_0x1d9d35=>({..._0x1d9d35,'authorName':_0x5e8819[_0x23915e(0x375)],'authorChatId':_0x5e8819['id']}));_0x3c3b62[_0x23915e(0xa49)](..._0x2c218f);}}):_0xe398f4[_0x24708d(0xbca)]&&(_0x3c3b62=_0xe398f4['longTermMemory']['map'](_0x3add64=>({..._0x3add64,'authorName':_0xe398f4[_0x24708d(0x596)],'authorChatId':_0xe398f4['id']})));if(_0x3c3b62[_0x24708d(0x105a)]===0x0){_0x319f8b[_0x24708d(0xca0)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>';return;}_0x3c3b62[_0x24708d(0xa19)]((_0x452ae6,_0x3883ce)=>_0x3883ce['timestamp']-_0x452ae6[_0x24708d(0x351)]),_0x3c3b62[_0x24708d(0x7c0)]((_0x26ea5a,_0x457544)=>{const _0x13d5b1=_0x24708d,_0x36ab54=document[_0x13d5b1(0x8c1)]('div');_0x36ab54[_0x13d5b1(0x84c)]=_0x13d5b1(0xe6b),_0x36ab54[_0x13d5b1(0x842)][_0x13d5b1(0x658)]=_0x13d5b1(0x674),_0x36ab54['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20'+_0x26ea5a[_0x13d5b1(0x718)]+_0x13d5b1(0x503)+_0x26ea5a[_0x13d5b1(0x168)][_0x13d5b1(0x1b7)](/\n/g,'<br>')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22'+_0x26ea5a['authorChatId']+_0x13d5b1(0x82b)+_0x26ea5a[_0x13d5b1(0x351)]+'\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22'+_0x26ea5a[_0x13d5b1(0xb57)]+_0x13d5b1(0x82b)+_0x26ea5a[_0x13d5b1(0x351)]+'\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x319f8b[_0x13d5b1(0x31e)](_0x36ab54);});}async function _0x19f806(){const _0x273eb7=_0x18b51e,_0x9aee4b=_0x405767[_0x273eb7(0x799)][_0x405767[_0x273eb7(0x248)]];if(!_0x9aee4b)return;let _0x5ac2a3=_0x9aee4b;if(_0x9aee4b[_0x273eb7(0x1000)]){const _0x2c5b56=_0x9aee4b[_0x273eb7(0x635)][_0x273eb7(0x6b9)](_0xf0b515=>({'text':'为“'+_0xf0b515['groupNickname']+_0x273eb7(0x783),'value':_0xf0b515['id']})),_0x5ee5d3=await _0x40fef8(_0x273eb7(0x90e),_0x2c5b56);if(!_0x5ee5d3)return;_0x5ac2a3=_0x405767[_0x273eb7(0x799)][_0x5ee5d3];if(!_0x5ac2a3){alert('错误：找不到该成员的个人档案。');return;}}const _0x554d28=await _0x180f74('为“'+_0x5ac2a3[_0x273eb7(0x596)]+_0x273eb7(0x783),_0x273eb7(0xb46),'',_0x273eb7(0x6c3));if(_0x554d28&&_0x554d28[_0x273eb7(0x8c6)]()){if(!_0x5ac2a3[_0x273eb7(0xbca)])_0x5ac2a3[_0x273eb7(0xbca)]=[];_0x5ac2a3[_0x273eb7(0xbca)][_0x273eb7(0xa49)]({'content':_0x554d28['trim'](),'timestamp':Date['now'](),'source':_0x273eb7(0x478)}),await _0x15043e[_0x273eb7(0x799)][_0x273eb7(0xfaa)](_0x5ac2a3),_0x4d8753();}}async function _0x56a457(_0xd7a14d,_0x5a3be6){const _0x31af7b=_0x18b51e,_0x10c686=_0x405767[_0x31af7b(0x799)][_0xd7a14d];if(!_0x10c686||!_0x10c686[_0x31af7b(0xbca)])return;const _0x11c036=_0x10c686[_0x31af7b(0xbca)][_0x31af7b(0x1149)](_0x166afa=>_0x166afa[_0x31af7b(0x351)]===_0x5a3be6);if(_0x11c036===-0x1)return;const _0x17b135=_0x10c686[_0x31af7b(0xbca)][_0x11c036],_0x4807bd=await _0x180f74(_0x31af7b(0x1255),'请修改记忆要点：',_0x17b135[_0x31af7b(0x168)],'textarea');_0x4807bd&&_0x4807bd[_0x31af7b(0x8c6)]()&&(_0x17b135['content']=_0x4807bd[_0x31af7b(0x8c6)](),await _0x15043e['chats'][_0x31af7b(0xfaa)](_0x10c686),_0x4d8753());}async function _0x48a1a6(_0x4a22c6,_0x5a64e5){const _0x24c2f1=_0x18b51e,_0x104fab=await _0x8b9cb8(_0x24c2f1(0xad9),_0x24c2f1(0xa20),{'confirmButtonClass':'btn-danger'});if(_0x104fab){const _0x515b6f=_0x405767[_0x24c2f1(0x799)][_0x4a22c6];if(!_0x515b6f||!_0x515b6f[_0x24c2f1(0xbca)])return;_0x515b6f['longTermMemory']=_0x515b6f['longTermMemory'][_0x24c2f1(0x1d8)](_0x2e1390=>_0x2e1390[_0x24c2f1(0x351)]!==_0x5a64e5),await _0x15043e['chats'][_0x24c2f1(0xfaa)](_0x515b6f),_0x4d8753();}}async function _0x5acd3c(){const _0x4e06cc=_0x18b51e,_0x2a6b17=await _0x8b9cb8(_0x4e06cc(0x65a),_0x4e06cc(0xfcf));_0x2a6b17&&await _0x183218(_0x405767[_0x4e06cc(0x248)],!![]);}async function _0x153c8b(_0x5a1ed8){const _0x5bfb8d=_0x18b51e,_0x1c5089=_0x405767['chats'][_0x5a1ed8];if(!_0x1c5089||!_0x1c5089[_0x5bfb8d(0x33a)][_0x5bfb8d(0xfee)])return;const _0x2da0da=_0x1c5089['lastMemorySummaryTimestamp']||0x0,_0xb01cb0=_0x1c5089[_0x5bfb8d(0xd39)][_0x5bfb8d(0x1d8)](_0x4e4c7a=>_0x4e4c7a[_0x5bfb8d(0x351)]>_0x2da0da&&!_0x4e4c7a[_0x5bfb8d(0x3f1)]);_0xb01cb0['length']>=_0x1c5089[_0x5bfb8d(0x33a)][_0x5bfb8d(0xae7)]&&(console['log'](_0x5bfb8d(0x11f5)+_0xb01cb0[_0x5bfb8d(0x105a)]+'/'+_0x1c5089['settings']['autoMemoryInterval']+')，开始总结...'),await _0x183218(_0x5a1ed8));}async function _0x1c46b5(_0x242a4c,_0x172b32){const _0x2a7a1f=_0x18b51e,_0xe6fe0=_0x405767[_0x2a7a1f(0x799)][_0x242a4c];if(!_0xe6fe0||!_0x172b32)throw new Error(_0x2a7a1f(0x173));const _0x490017=_0x405767['qzoneSettings']['nickname']||'用户';let _0xf218e0,_0x5aa081=_0xe6fe0;const _0x36e84a=new Date()['toLocaleDateString'](_0x2a7a1f(0x73e),{'year':_0x2a7a1f(0x20c),'month':_0x2a7a1f(0x386),'day':_0x2a7a1f(0x20c)});if(_0xe6fe0[_0x2a7a1f(0x1000)]){let _0x3ac340=null;_0x49beae['callRequester']&&(_0x3ac340=_0xe6fe0[_0x2a7a1f(0x635)]['find'](_0x15fab9=>_0x15fab9['originalName']===_0x49beae[_0x2a7a1f(0xf53)]));!_0x3ac340&&(_0x3ac340=_0xe6fe0[_0x2a7a1f(0x635)]['find'](_0x3f8f94=>_0x3f8f94['id']!==_0x2a7a1f(0x74b)&&_0x49beae[_0x2a7a1f(0x190)][_0x2a7a1f(0xdc3)](_0x4d5d30=>_0x4d5d30['id']===_0x3f8f94['id'])));!_0x3ac340&&(_0x3ac340=_0xe6fe0[_0x2a7a1f(0x635)][_0x2a7a1f(0x2ef)](_0xece737=>_0xece737['id']!==_0x2a7a1f(0x74b)));if(!_0x3ac340)throw new Error(_0x2a7a1f(0x10ef));const _0x48a521=_0x405767[_0x2a7a1f(0x799)][_0x3ac340['id']];if(!_0x48a521)throw new Error(_0x2a7a1f(0x362)+_0x3ac340[_0x2a7a1f(0x375)]+_0x2a7a1f(0x4e1));const _0x2fdd50=_0xe6fe0[_0x2a7a1f(0x33a)][_0x2a7a1f(0xbe8)]||_0x2a7a1f(0x496);_0xf218e0=_0x2a7a1f(0xe09)+_0x3ac340[_0x2a7a1f(0x4e7)]+'”。请你回顾一下刚才和\x20“'+_0x490017+_0x2a7a1f(0x715)+_0x36e84a+_0x2a7a1f(0xa67)+_0x36e84a+_0x2a7a1f(0x7c2)+_0x48a521['settings'][_0x2a7a1f(0x1060)]+_0x2a7a1f(0xdde)+_0x2fdd50+_0x2a7a1f(0x181)+_0x172b32+_0x2a7a1f(0xecc)+_0x3ac340['originalName']+_0x2a7a1f(0xeb4),_0x5aa081=_0x48a521;}else _0xf218e0=_0x2a7a1f(0xe09)+_0xe6fe0[_0x2a7a1f(0x4e7)]+_0x2a7a1f(0x1205)+_0x490017+_0x2a7a1f(0x1f5)+_0x36e84a+'**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是'+_0x36e84a+_0x2a7a1f(0xad2)+_0xe6fe0[_0x2a7a1f(0x33a)][_0x2a7a1f(0x1060)]+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0xe6fe0['settings'][_0x2a7a1f(0xbe8)]+_0x2a7a1f(0x926)+_0x172b32+_0x2a7a1f(0xecc)+_0xe6fe0[_0x2a7a1f(0x4e7)]+_0x2a7a1f(0xeb4);try{const _0x97acc0=_0x405767[_0x2a7a1f(0x9e0)][_0x2a7a1f(0x2fa)]&&_0x405767[_0x2a7a1f(0x9e0)][_0x2a7a1f(0x107f)]&&_0x405767[_0x2a7a1f(0x9e0)][_0x2a7a1f(0x234)],{proxyUrl:_0x196e74,apiKey:_0x42fd4f,model:_0x3bad8e}=_0x97acc0?{'proxyUrl':_0x405767[_0x2a7a1f(0x9e0)][_0x2a7a1f(0x2fa)],'apiKey':_0x405767[_0x2a7a1f(0x9e0)]['secondaryApiKey'],'model':_0x405767[_0x2a7a1f(0x9e0)][_0x2a7a1f(0x234)]}:_0x405767['apiConfig'];if(!_0x196e74||!_0x42fd4f||!_0x3bad8e)throw new Error(_0x2a7a1f(0x456));let _0x13637b=_0x196e74[_0x2a7a1f(0x773)](_0x2a7a1f(0x3fe)),_0x515f6c=_0x282b7e(_0x3bad8e,_0x42fd4f,_0xf218e0,[{'role':_0x2a7a1f(0x74b),'content':'请开始总结。'}]);const _0x327966=_0x13637b?await fetch(_0x515f6c[_0x2a7a1f(0x9d6)],_0x515f6c[_0x2a7a1f(0x49a)]):await fetch(_0x196e74+'/v1/chat/completions',{'method':_0x2a7a1f(0xcd0),'headers':{'Content-Type':'application/json','Authorization':_0x2a7a1f(0xf42)+_0x42fd4f},'body':JSON[_0x2a7a1f(0x1175)]({'model':_0x3bad8e,'messages':[{'role':_0x2a7a1f(0x46c),'content':_0xf218e0},{'role':'user','content':_0x2a7a1f(0x857)}],'temperature':0.1})});if(!_0x327966['ok']){const _0x2c448b=await _0x327966[_0x2a7a1f(0x7e9)]()['catch'](()=>({'error':{'message':_0x327966['statusText']}}));throw new Error(_0x2a7a1f(0x1d9)+_0x327966['status']+_0x2a7a1f(0x2e9)+_0x2c448b[_0x2a7a1f(0x7a3)][_0x2a7a1f(0xc7d)]);}const _0x1b2297=await _0x327966[_0x2a7a1f(0x7e9)]();let _0x65d197=_0x13637b?getGeminiResponseText(_0x1b2297):_0x1b2297['choices'][0x0]['message'][_0x2a7a1f(0x168)];_0x65d197=_0x65d197[_0x2a7a1f(0x1b7)](/^```json\s*/,'')[_0x2a7a1f(0x1b7)](/```$/,'')['trim']();const _0x2903e4=JSON[_0x2a7a1f(0x10ab)](_0x65d197);if(_0x2903e4[_0x2a7a1f(0xdd6)]&&_0x2903e4[_0x2a7a1f(0xdd6)]['trim']()){const _0x1d8dcf={'content':_0x2a7a1f(0xef3)+(_0xe6fe0[_0x2a7a1f(0x1000)]?'群聊':'')+_0x2a7a1f(0xe5c)+_0x2903e4[_0x2a7a1f(0xdd6)][_0x2a7a1f(0x8c6)]()+')','timestamp':Date[_0x2a7a1f(0x1ed)](),'source':_0xe6fe0[_0x2a7a1f(0x1000)]?_0x2a7a1f(0xfd6):_0x2a7a1f(0x79e)};if(!_0x5aa081['longTermMemory'])_0x5aa081[_0x2a7a1f(0xbca)]=[];return _0x5aa081[_0x2a7a1f(0xbca)]['push'](_0x1d8dcf),await _0x15043e[_0x2a7a1f(0x799)][_0x2a7a1f(0xfaa)](_0x5aa081),console[_0x2a7a1f(0x32b)](_0x2a7a1f(0x1e8)+_0x5aa081[_0x2a7a1f(0x596)]+_0x2a7a1f(0x6f3)),!![];}else throw new Error('AI返回了空的或格式不正确的总结内容。');}catch(_0x31d82c){console[_0x2a7a1f(0x7a3)](_0x2a7a1f(0x965),_0x31d82c);throw _0x31d82c;}}function _0x2db8ab(_0x2d3240){const _0x28a178=_0x18b51e,_0x483452=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么',_0x28a178(0x368),'哪个','一些','这个','那个','还有']),_0x47c8ad=_0x2d3240[_0x28a178(0xdf8)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x3cfd44=new Map();let _0x57eb44=0x0;_0x47c8ad['forEach'](_0x4e7657=>{const _0x55771b=_0x28a178;if(_0x4e7657[_0x55771b(0x105a)]>0x1&&!_0x483452[_0x55771b(0x11ac)](_0x4e7657)){const _0x5cc3a2=(_0x3cfd44[_0x55771b(0x3e9)](_0x4e7657)||0x0)+0x1;_0x3cfd44[_0x55771b(0xf5a)](_0x4e7657,_0x5cc3a2);if(_0x5cc3a2>_0x57eb44)_0x57eb44=_0x5cc3a2;}});const _0x4457dc=[],_0x355353=[],_0x430e17=_0x57eb44*0.9,_0x4bde3c=_0x57eb44*0.6;_0x3cfd44[_0x28a178(0x7c0)]((_0x307ddb,_0x39a4b9)=>{if(_0x307ddb>=_0x430e17)_0x4457dc['push'](_0x39a4b9);else _0x307ddb>=_0x4bde3c&&_0x355353['push'](_0x39a4b9);});const _0x5a4977=new Set(_0x4457dc),_0x43aea8=_0x355353['filter'](_0x5ed2dd=>!_0x5a4977[_0x28a178(0x11ac)](_0x5ed2dd))[_0x28a178(0x961)](0x0,0x5);return{'coreKeywords':_0x4457dc[_0x28a178(0x961)](0x0,0x3),'situationalKeywords':_0x43aea8};}function _0x5e1bc2(_0x424ffb,_0x2050f4,_0x4cf882){const _0x270e9d=_0x18b51e;let _0x5054b1;_0x4cf882===_0x270e9d(0x834)?_0x5054b1=Date[_0x270e9d(0x1ed)]()-_0x2050f4*0x3c*0x3c*0x3e8:_0x5054b1=Date['now']()-_0x2050f4*0x18*0x3c*0x3c*0x3e8;const _0x1886f2=_0x424ffb[_0x270e9d(0xd39)][_0x270e9d(0x1d8)](_0x3231d6=>_0x3231d6[_0x270e9d(0x351)]>_0x5054b1&&!_0x3231d6[_0x270e9d(0x3f1)]);if(_0x1886f2[_0x270e9d(0x105a)]<0x3)return'';const _0x52bf8c=_0x1886f2['map'](_0xea9af6=>{const _0x1215ee=_0x270e9d;if(typeof _0xea9af6[_0x1215ee(0x168)]==='string')return _0xea9af6[_0x1215ee(0x168)];if(_0xea9af6[_0x1215ee(0xde0)]==='voice_message')return _0xea9af6['content'];if(_0xea9af6[_0x1215ee(0xde0)]==='offline_text')return(_0xea9af6[_0x1215ee(0x1028)]||'')+'\x20'+(_0xea9af6[_0x1215ee(0x3ca)]||'');return'';})['join']('\x20'),_0x123c25=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0x32eace=_0x52bf8c['match'](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0xd01263=new Map();_0x32eace[_0x270e9d(0x7c0)](_0x2386d2=>{const _0x1e2d2f=_0x270e9d;_0x2386d2['length']>0x1&&!_0x123c25[_0x1e2d2f(0x11ac)](_0x2386d2)&&_0xd01263['set'](_0x2386d2,(_0xd01263[_0x1e2d2f(0x3e9)](_0x2386d2)||0x0)+0x1);});const _0x266e63=[..._0xd01263[_0x270e9d(0x6ff)]()][_0x270e9d(0xa19)]((_0xecd50a,_0x1935d5)=>_0x1935d5[0x1]-_0xecd50a[0x1])[_0x270e9d(0x6b9)](_0x19a628=>_0x19a628[0x0]);if(_0x266e63[_0x270e9d(0x105a)]===0x0)return'';let _0x42fd41;return _0x4cf882===_0x270e9d(0x834)?_0x42fd41='最近'+_0x2050f4+_0x270e9d(0xbdb):_0x2050f4===0x1?_0x42fd41=_0x270e9d(0x1164):_0x42fd41='最近'+_0x2050f4+_0x270e9d(0xb76),'\x0a-\x20**'+_0x42fd41+_0x270e9d(0x4cd)+_0x266e63[_0x270e9d(0x961)](0x0,0x3)['join']('、\x20')+_0x270e9d(0x1262);}function _0x439807(_0x32ae35){const _0x35f216=_0x18b51e;if(!_0x32ae35||typeof _0x32ae35!==_0x35f216(0xf1b))return null;const _0x2a56c6=_0x32ae35[_0x35f216(0x1b7)](/^```json\s*/,'')[_0x35f216(0x1b7)](/```$/,'')['trim'](),_0xf5123a=_0x2a56c6[_0x35f216(0xdf8)](/{[\s\S]*}/);if(_0xf5123a)try{const _0x2ae34a=JSON[_0x35f216(0x10ab)](_0xf5123a[0x0]);return console[_0x35f216(0x32b)](_0x35f216(0xc06)),_0x2ae34a;}catch(_0x4fb416){console[_0x35f216(0x112a)]('容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...');}const _0x49ed1a=_0x2a56c6[_0x35f216(0xdf8)](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0x49ed1a&&_0x49ed1a[0x1])return console[_0x35f216(0x32b)](_0x35f216(0xd0a)),{'summary':_0x49ed1a[0x1][_0x35f216(0x1b7)](/\\"/g,'\x22')};if(_0x2a56c6)return console[_0x35f216(0x32b)](_0x35f216(0x1059)),{'summary':_0x2a56c6};return null;}async function _0x5cf6ce(_0x39eed8){const _0x1ca7b4=_0x18b51e;let _0x38b2bf=_0x405767[_0x1ca7b4(0x799)][_0x39eed8];if(!_0x38b2bf)return;let _0x4b2ea7=_0x38b2bf;if(_0x38b2bf[_0x1ca7b4(0x1000)]){const _0x52ee75=_0x38b2bf[_0x1ca7b4(0x635)][_0x1ca7b4(0x6b9)](_0x4cbdf4=>{const _0x3f86b5=_0x1ca7b4,_0x26aef9=_0x405767['chats'][_0x4cbdf4['id']];if(_0x26aef9&&_0x26aef9[_0x3f86b5(0xbca)]&&_0x26aef9[_0x3f86b5(0xbca)][_0x3f86b5(0x105a)]>=0x2)return{'text':_0x3f86b5(0x2da)+_0x4cbdf4[_0x3f86b5(0x375)]+'”的记忆\x20('+_0x26aef9['longTermMemory'][_0x3f86b5(0x105a)]+'条)','value':_0x4cbdf4['id']};return null;})[_0x1ca7b4(0x1d8)](Boolean);if(_0x52ee75[_0x1ca7b4(0x105a)]===0x0){alert(_0x1ca7b4(0x9bc));return;}const _0x17c81a=await _0x40fef8(_0x1ca7b4(0x3bf),_0x52ee75);if(!_0x17c81a)return;_0x4b2ea7=_0x405767[_0x1ca7b4(0x799)][_0x17c81a];}if(!_0x4b2ea7[_0x1ca7b4(0xbca)]||_0x4b2ea7[_0x1ca7b4(0xbca)][_0x1ca7b4(0x105a)]<0x2){alert('“'+_0x4b2ea7[_0x1ca7b4(0x596)]+_0x1ca7b4(0xeaa));return;}const _0x2af9c6=_0x4b2ea7['longTermMemory'][_0x1ca7b4(0x105a)],_0x4ffbbe=await _0x40fef8(_0x1ca7b4(0x10ea),[{'text':_0x1ca7b4(0x1214)+_0x2af9c6+'条)','value':_0x1ca7b4(0xe88)},{'text':_0x1ca7b4(0x165),'value':'20'},{'text':'最近\x2050\x20条','value':'50'},{'text':_0x1ca7b4(0x9b2),'value':_0x1ca7b4(0xf84)},{'text':'自定义数量...','value':'custom'}][_0x1ca7b4(0x1d8)](_0x15a0a4=>_0x15a0a4[_0x1ca7b4(0x518)]===_0x1ca7b4(0xe88)||_0x15a0a4['value']===_0x1ca7b4(0x14d)||parseInt(_0x15a0a4[_0x1ca7b4(0x518)])<_0x2af9c6));if(_0x4ffbbe===null)return;let _0x3cb0d7,_0x380c3f=_0x2af9c6;if(_0x4ffbbe===_0x1ca7b4(0xe88))_0x3cb0d7=[..._0x4b2ea7[_0x1ca7b4(0xbca)]];else{if(_0x4ffbbe===_0x1ca7b4(0x14d)){const _0x1aaa1a=await _0x180f74('自定义数量',_0x1ca7b4(0x293)+_0x2af9c6+_0x1ca7b4(0xe45));if(_0x1aaa1a===null)return;const _0x3c45b7=parseInt(_0x1aaa1a);if(isNaN(_0x3c45b7)||_0x3c45b7<0x2||_0x3c45b7>_0x2af9c6){alert(_0x1ca7b4(0xc6c)+_0x2af9c6+_0x1ca7b4(0x1195));return;}_0x380c3f=_0x3c45b7,_0x3cb0d7=_0x4b2ea7[_0x1ca7b4(0xbca)]['slice'](-_0x380c3f);}else _0x380c3f=parseInt(_0x4ffbbe),_0x380c3f>=_0x2af9c6?(_0x3cb0d7=[..._0x4b2ea7['longTermMemory']],_0x380c3f=_0x2af9c6):_0x3cb0d7=_0x4b2ea7[_0x1ca7b4(0xbca)][_0x1ca7b4(0x961)](-_0x380c3f);}const _0x4e705f=await _0x180f74('设置精炼字数','请输入精炼后核心记忆的大致字数：','150');if(_0x4e705f===null)return;const _0x307f9e=parseInt(_0x4e705f);if(isNaN(_0x307f9e)||_0x307f9e<0x14){alert(_0x1ca7b4(0x509));return;}const _0x4c46c3=await _0x8b9cb8(_0x1ca7b4(0xa83),'此操作会将选定的\x20'+_0x380c3f+_0x1ca7b4(0xb22)+_0x307f9e+_0x1ca7b4(0x66f),{'confirmButtonClass':_0x1ca7b4(0xe2a),'confirmText':'确认精炼'});if(!_0x4c46c3)return;const _0x1dfaa=_0x3cb0d7[_0x1ca7b4(0x6b9)](_0x1a02e0=>'-\x20'+_0x1a02e0[_0x1ca7b4(0x168)])[_0x1ca7b4(0xb2c)]('\x0a'),_0x38bdd0=_0x405767[_0x1ca7b4(0x20a)][_0x1ca7b4(0xab3)]||'用户',_0x2bf485=new Date()[_0x1ca7b4(0x3de)](_0x1ca7b4(0x73e),{'year':_0x1ca7b4(0x20c),'month':_0x1ca7b4(0x386),'day':_0x1ca7b4(0x20c)}),_0x43300a=_0x1ca7b4(0xe09)+_0x4b2ea7[_0x1ca7b4(0x4e7)]+'”。请你回顾一下你和“'+_0x38bdd0+'”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x2bf485+_0x1ca7b4(0x37c)+_0x2bf485+_0x1ca7b4(0x6d7)+_0x307f9e+_0x1ca7b4(0x1106)+_0x4b2ea7[_0x1ca7b4(0x33a)][_0x1ca7b4(0x1060)]+_0x1ca7b4(0xdde)+_0x4b2ea7[_0x1ca7b4(0x33a)][_0x1ca7b4(0xbe8)]+_0x1ca7b4(0x9e1)+_0x1dfaa+_0x1ca7b4(0xecc)+_0x4b2ea7['originalName']+'”的身份，开始你的回忆梳理与精炼。';await _0x501c7b(_0x1ca7b4(0x1047),_0x1ca7b4(0x786));try{const _0x5b1913=_0x405767[_0x1ca7b4(0x9e0)]['secondaryProxyUrl']&&_0x405767[_0x1ca7b4(0x9e0)][_0x1ca7b4(0x107f)]&&_0x405767[_0x1ca7b4(0x9e0)]['secondaryModel'],{proxyUrl:_0xcc503f,apiKey:_0x110315,model:_0x1f00eb}=_0x5b1913?{'proxyUrl':_0x405767[_0x1ca7b4(0x9e0)][_0x1ca7b4(0x2fa)],'apiKey':_0x405767['apiConfig'][_0x1ca7b4(0x107f)],'model':_0x405767[_0x1ca7b4(0x9e0)][_0x1ca7b4(0x234)]}:_0x405767[_0x1ca7b4(0x9e0)];if(!_0xcc503f||!_0x110315||!_0x1f00eb)throw new Error(_0x1ca7b4(0xe84));let _0x143b4e=_0xcc503f[_0x1ca7b4(0x773)]('generativelanguage'),_0x1fd5cd=_0x282b7e(_0x1f00eb,_0x110315,_0x43300a,[{'role':'user','content':_0x1ca7b4(0x2fd)}]);const _0x36b515=_0x143b4e?await fetch(_0x1fd5cd[_0x1ca7b4(0x9d6)],_0x1fd5cd['data']):await fetch(_0xcc503f+_0x1ca7b4(0x5c1),{'method':_0x1ca7b4(0xcd0),'headers':{'Content-Type':_0x1ca7b4(0xcb6),'Authorization':_0x1ca7b4(0xf42)+_0x110315},'body':JSON[_0x1ca7b4(0x1175)]({'model':_0x1f00eb,'messages':[{'role':'system','content':_0x43300a},{'role':_0x1ca7b4(0x74b),'content':'请开始整合。'}],'temperature':0.2})});if(!_0x36b515['ok'])throw new Error(_0x1ca7b4(0xd83)+_0x36b515['statusText']);const _0x569c33=await _0x36b515[_0x1ca7b4(0x7e9)]();let _0x54806b=_0x143b4e?getGeminiResponseText(_0x569c33):_0x569c33[_0x1ca7b4(0xa44)][0x0][_0x1ca7b4(0xc7d)]['content'];const _0x24861f=_0x439807(_0x54806b);if(_0x24861f&&_0x24861f['summary']&&typeof _0x24861f[_0x1ca7b4(0xdd6)]===_0x1ca7b4(0xf1b)&&_0x24861f[_0x1ca7b4(0xdd6)][_0x1ca7b4(0x8c6)]()){const _0x1f84e2=await _0x8b9cb8(_0x1ca7b4(0xea2),_0x1ca7b4(0x8fb)+_0x380c3f+_0x1ca7b4(0x2ff)+_0x24861f[_0x1ca7b4(0xdd6)][_0x1ca7b4(0x8c6)]()+'</div><br>是否用这条新记忆替换掉这些旧记忆？',{'confirmText':_0x1ca7b4(0x5c6),'cancelText':_0x1ca7b4(0xf45),'confirmButtonClass':_0x1ca7b4(0xe2a)});if(_0x1f84e2){const _0x1b5795={'content':_0x24861f[_0x1ca7b4(0xdd6)][_0x1ca7b4(0x8c6)](),'timestamp':Date[_0x1ca7b4(0x1ed)](),'source':_0x1ca7b4(0x888)},_0x4e0e8b=_0x2af9c6-_0x380c3f,_0x1b923b=_0x4e0e8b>0x0?_0x4b2ea7[_0x1ca7b4(0xbca)][_0x1ca7b4(0x961)](0x0,_0x4e0e8b):[];_0x4b2ea7['longTermMemory']=[..._0x1b923b,_0x1b5795],_0x4b2ea7[_0x1ca7b4(0x121e)]=Date[_0x1ca7b4(0x1ed)](),await _0x15043e[_0x1ca7b4(0x799)]['put'](_0x4b2ea7),document[_0x1ca7b4(0x8c2)](_0x1ca7b4(0xb4c))[_0x1ca7b4(0xb17)][_0x1ca7b4(0x795)]('active')&&_0x4d8753(),await _0x501c7b(_0x1ca7b4(0xafb),_0x1ca7b4(0xe40)+_0x380c3f+_0x1ca7b4(0xa8e));}else await _0x501c7b(_0x1ca7b4(0x122f),_0x1ca7b4(0x438));}else throw new Error(_0x1ca7b4(0xe3f));}catch(_0x3d7a13){console[_0x1ca7b4(0x7a3)](_0x1ca7b4(0x53a),_0x3d7a13),await _0x501c7b(_0x1ca7b4(0xa21),_0x1ca7b4(0xa0b)+_0x3d7a13[_0x1ca7b4(0xc7d)]);}}async function _0x183218(_0x5d6471,_0x524363=![]){const _0x33aa3e=_0x18b51e,_0xc4504b=_0x405767['chats'][_0x5d6471];if(!_0xc4504b)return;const _0x7fd2f6=_0xc4504b[_0x33aa3e(0x121e)]||0x0,_0x892d58=_0x524363?_0xc4504b[_0x33aa3e(0xd39)][_0x33aa3e(0x1d8)](_0x1e8f3e=>!_0x1e8f3e[_0x33aa3e(0x3f1)]||_0x1e8f3e['role']===_0x33aa3e(0x46c)&&_0x1e8f3e[_0x33aa3e(0x168)][_0x33aa3e(0x773)]('内心独白'))['slice'](-(_0xc4504b[_0x33aa3e(0x33a)][_0x33aa3e(0xae7)]||0x14)):_0xc4504b[_0x33aa3e(0xd39)][_0x33aa3e(0x1d8)](_0x525c89=>_0x525c89[_0x33aa3e(0x351)]>_0x7fd2f6&&(!_0x525c89[_0x33aa3e(0x3f1)]||_0x525c89[_0x33aa3e(0x14a)]===_0x33aa3e(0x46c)&&_0x525c89[_0x33aa3e(0x168)]['includes'](_0x33aa3e(0x4c7))));if(_0x892d58['length']<0x5){if(_0x524363)alert(_0x33aa3e(0x58e));return;}const _0x39c3a3=_0x405767['qzoneSettings'][_0x33aa3e(0xab3)]||'用户',_0x203162=_0x892d58[_0x33aa3e(0x6b9)](_0x2d8239=>{const _0x462490=_0x33aa3e;if(_0x2d8239['isHidden']&&_0x2d8239['role']===_0x462490(0x46c)&&_0x2d8239[_0x462490(0x168)][_0x462490(0x773)](_0x462490(0x4c7)))return _0x2d8239[_0x462490(0x168)];let _0x1b5ca9;_0x2d8239[_0x462490(0x14a)]===_0x462490(0x74b)?_0x1b5ca9=_0x39c3a3:_0x1b5ca9=_0x2d8239[_0x462490(0x770)]||_0xc4504b[_0x462490(0x4e7)];let _0x5330b6='';if(_0x2d8239[_0x462490(0xde0)]===_0x462490(0xaac)){if(_0x2d8239[_0x462490(0x168)])_0x5330b6=_0x2d8239[_0x462490(0x168)];else{const _0x41b51a=_0x2d8239['dialogue']?'「'+_0x2d8239[_0x462490(0x1028)]+'」':'',_0x1d4df=_0x2d8239[_0x462490(0x3ca)]?'('+_0x2d8239['description']+')':'';_0x5330b6=(_0x41b51a+'\x20'+_0x1d4df)[_0x462490(0x8c6)]();}}else _0x5330b6=String(_0x2d8239[_0x462490(0x168)]);return _0x1b5ca9+':\x20'+_0x5330b6;})[_0x33aa3e(0xb2c)]('\x0a');let _0x343e6c;if(_0xc4504b[_0x33aa3e(0x1000)])_0x343e6c=_0x33aa3e(0x602)+_0x39c3a3+_0x33aa3e(0x702)+_0x203162+_0x33aa3e(0x4f7)+_0xc4504b[_0x33aa3e(0x635)]['map'](_0x3e1649=>'-\x20'+_0x3e1649[_0x33aa3e(0x375)]+'\x20(本名:\x20'+_0x3e1649[_0x33aa3e(0x4e7)]+')')[_0x33aa3e(0xb2c)]('\x0a')+'\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。';else{const _0x21d757=new Date()['toLocaleDateString']('zh-CN',{'year':_0x33aa3e(0x20c),'month':_0x33aa3e(0x386),'day':_0x33aa3e(0x20c)});_0x343e6c=_0x33aa3e(0xe09)+_0xc4504b[_0x33aa3e(0x4e7)]+'”。请你回顾一下刚才和“'+_0x39c3a3+'”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x21d757+_0x33aa3e(0x24d)+_0x21d757+_0x33aa3e(0x3d1)+new Date(Date[_0x33aa3e(0x1ed)]()+0x5265c00)['toLocaleDateString'](_0x33aa3e(0x73e),{'month':_0x33aa3e(0x386),'day':_0x33aa3e(0x20c)})+_0x33aa3e(0xc5c)+_0xc4504b[_0x33aa3e(0x33a)]['aiPersona']+_0x33aa3e(0x64e)+_0xc4504b[_0x33aa3e(0x33a)][_0x33aa3e(0xbe8)]+_0x33aa3e(0x754)+_0x203162+_0x33aa3e(0xecc)+_0xc4504b[_0x33aa3e(0x4e7)]+_0x33aa3e(0xeb4);}try{const _0x5a490b=_0x405767['apiConfig'][_0x33aa3e(0x2fa)]&&_0x405767[_0x33aa3e(0x9e0)][_0x33aa3e(0x107f)]&&_0x405767[_0x33aa3e(0x9e0)]['secondaryModel'],{proxyUrl:_0x346ea8,apiKey:_0x7b2b0a,model:_0x2a155e}=_0x5a490b?{'proxyUrl':_0x405767[_0x33aa3e(0x9e0)][_0x33aa3e(0x2fa)],'apiKey':_0x405767[_0x33aa3e(0x9e0)][_0x33aa3e(0x107f)],'model':_0x405767[_0x33aa3e(0x9e0)][_0x33aa3e(0x234)]}:_0x405767[_0x33aa3e(0x9e0)];if(!_0x346ea8||!_0x7b2b0a||!_0x2a155e)throw new Error(_0x33aa3e(0xc27));let _0x36e58b=_0x346ea8['includes'](_0x33aa3e(0x3fe)),_0x520ff2=_0x282b7e(_0x2a155e,_0x7b2b0a,_0x343e6c,[{'role':'user','content':'请开始总结。'}]);const _0x3ac4a2=_0x36e58b?await fetch(_0x520ff2[_0x33aa3e(0x9d6)],_0x520ff2[_0x33aa3e(0x49a)]):await fetch(_0x346ea8+_0x33aa3e(0x5c1),{'method':_0x33aa3e(0xcd0),'headers':{'Content-Type':'application/json','Authorization':_0x33aa3e(0xf42)+_0x7b2b0a},'body':JSON['stringify']({'model':_0x2a155e,'messages':[{'role':_0x33aa3e(0x46c),'content':_0x343e6c},{'role':'user','content':_0x33aa3e(0x857)}],'temperature':0.2})});if(!_0x3ac4a2['ok'])throw new Error(_0x33aa3e(0xd83)+_0x3ac4a2[_0x33aa3e(0xd05)]);const _0x2328e8=await _0x3ac4a2[_0x33aa3e(0x7e9)]();let _0x3293ba=_0x36e58b?getGeminiResponseText(_0x2328e8):_0x2328e8[_0x33aa3e(0xa44)][0x0][_0x33aa3e(0xc7d)][_0x33aa3e(0x168)];_0x3293ba=_0x3293ba[_0x33aa3e(0x1b7)](/^```json\s*/,'')['replace'](/```$/,'')['trim']();const _0x5eaaed=JSON[_0x33aa3e(0x10ab)](_0x3293ba);if(_0xc4504b[_0x33aa3e(0x1000)]){if(_0x5eaaed[_0x33aa3e(0x1fc)]&&typeof _0x5eaaed[_0x33aa3e(0x1fc)]==='object'){let _0x13aac7=0x0;for(const _0x5f1a3b in _0x5eaaed[_0x33aa3e(0x1fc)]){const _0x5ae5f1=_0x5eaaed[_0x33aa3e(0x1fc)][_0x5f1a3b];if(_0x5ae5f1&&_0x5ae5f1[_0x33aa3e(0x8c6)]()){const _0x13e6d5=Object[_0x33aa3e(0x22f)](_0x405767[_0x33aa3e(0x799)])[_0x33aa3e(0x2ef)](_0x1cb5eb=>_0x1cb5eb[_0x33aa3e(0x4e7)]===_0x5f1a3b);if(_0x13e6d5){const _0xfe46b4={'content':_0x5ae5f1[_0x33aa3e(0x8c6)](),'timestamp':Date['now'](),'source':_0x33aa3e(0x1088)+_0xc4504b[_0x33aa3e(0x596)]};if(!_0x13e6d5['longTermMemory'])_0x13e6d5[_0x33aa3e(0xbca)]=[];_0x13e6d5['longTermMemory'][_0x33aa3e(0xa49)](_0xfe46b4),await _0x15043e[_0x33aa3e(0x799)][_0x33aa3e(0xfaa)](_0x13e6d5),_0x13aac7++;}}}if(_0x13aac7>0x0)console[_0x33aa3e(0x32b)](_0x33aa3e(0xb92)+_0x13aac7+_0x33aa3e(0xb14));else throw new Error('AI返回了空的或格式不正确的总结内容。');}else throw new Error('AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。');}else{if(_0x5eaaed['summary']&&_0x5eaaed[_0x33aa3e(0xdd6)][_0x33aa3e(0x8c6)]()){const _0x5e36d7={'content':_0x5eaaed['summary'][_0x33aa3e(0x8c6)](),'timestamp':Date[_0x33aa3e(0x1ed)](),'source':_0x33aa3e(0x541)};_0xc4504b[_0x33aa3e(0xbca)][_0x33aa3e(0xa49)](_0x5e36d7),await _0x15043e[_0x33aa3e(0x799)][_0x33aa3e(0xfaa)](_0xc4504b),console['log'](_0x33aa3e(0x11c9));}else throw new Error(_0x33aa3e(0xe3f));}_0xc4504b[_0x33aa3e(0x121e)]=_0x892d58[_0x33aa3e(0x961)](-0x1)[0x0][_0x33aa3e(0x351)],await _0x15043e[_0x33aa3e(0x799)][_0x33aa3e(0xfaa)](_0xc4504b),document[_0x33aa3e(0x8c2)](_0x33aa3e(0xb4c))[_0x33aa3e(0xb17)][_0x33aa3e(0x795)](_0x33aa3e(0x71b))&&_0x4d8753();}catch(_0x208d49){console[_0x33aa3e(0x7a3)](_0x33aa3e(0x123b),_0x208d49),await _0x501c7b(_0x33aa3e(0xa0c),'操作失败:\x20'+_0x208d49[_0x33aa3e(0xc7d)]);}}function _0x3020c7(){const _0x390b2a=_0x18b51e;if(!_0x39784f)return;const _0x1974cf=_0x405767[_0x390b2a(0x799)][_0x405767[_0x390b2a(0x248)]],_0x41f5d2=_0x1974cf[_0x390b2a(0xd39)]['find'](_0x1e151f=>_0x1e151f[_0x390b2a(0x351)]===_0x39784f);if(!_0x41f5d2)return;let _0x22fd45;_0x41f5d2[_0x390b2a(0x14a)]===_0x390b2a(0x74b)?_0x22fd45=_0x1974cf[_0x390b2a(0x1000)]?_0x1974cf[_0x390b2a(0x33a)]['myNickname']||'我':'我':_0x1974cf[_0x390b2a(0x1000)]?_0x22fd45=_0x1ba34a(_0x1974cf,_0x41f5d2[_0x390b2a(0x770)]):_0x22fd45=_0x1974cf[_0x390b2a(0x596)];const _0x4ca647=String(_0x41f5d2['content']||'');let _0x4a1107='';if(typeof _0x41f5d2['content']===_0x390b2a(0xf1b)&&_0x3ba794['test'](_0x41f5d2['content']))_0x4a1107='[表情]';else{if(_0x41f5d2[_0x390b2a(0xde0)]==='ai_image'||_0x41f5d2[_0x390b2a(0xde0)]===_0x390b2a(0x223))_0x4a1107=_0x390b2a(0xcb0);else _0x41f5d2['type']===_0x390b2a(0xf64)?_0x4a1107=_0x390b2a(0xa7c):_0x4a1107=_0x4ca647[_0x390b2a(0x599)](0x0,0x32)+(_0x4ca647[_0x390b2a(0x105a)]>0x32?_0x390b2a(0x388):'');}_0x19e711={'timestamp':_0x41f5d2[_0x390b2a(0x351)],'senderName':_0x22fd45,'content':_0x4ca647};const _0x6956db=document[_0x390b2a(0x8c2)]('reply-preview-bar');_0x6956db[_0x390b2a(0x1ad)](_0x390b2a(0x628))['textContent']=_0x390b2a(0xb86)+_0x19e711[_0x390b2a(0x770)]+':',_0x6956db[_0x390b2a(0x1ad)](_0x390b2a(0x254))[_0x390b2a(0x1090)]=_0x4a1107,_0x6956db['style']['display']=_0x390b2a(0xea7),_0x152bc1(),document['getElementById'](_0x390b2a(0x332))[_0x390b2a(0x10f7)]();}function _0x54747e(){const _0x382ffc=_0x18b51e;_0x19e711=null,document[_0x382ffc(0x8c2)](_0x382ffc(0xd8e))[_0x382ffc(0x842)][_0x382ffc(0x5e9)]=_0x382ffc(0xbf8);}let _0x42bf96=null;function _0x39c7cd(_0x267d60){const _0x38e7b1=_0x18b51e;_0x42bf96=_0x267d60;const _0x493aea=_0x405767[_0x38e7b1(0x799)][_0x405767[_0x38e7b1(0x248)]],_0x2e06a7=_0x493aea[_0x38e7b1(0xd39)]['find'](_0x418877=>_0x418877[_0x38e7b1(0x351)]===_0x267d60);_0x2e06a7&&(document[_0x38e7b1(0x8c2)](_0x38e7b1(0x1271))['textContent']=_0x2e06a7['senderName']),document[_0x38e7b1(0x8c2)]('transfer-actions-modal')['classList'][_0x38e7b1(0x3f4)](_0x38e7b1(0x2cd));}function _0x5b4d91(){const _0x18dd26=_0x18b51e;document[_0x18dd26(0x8c2)](_0x18dd26(0xea0))[_0x18dd26(0xb17)][_0x18dd26(0xaff)](_0x18dd26(0x2cd)),_0x42bf96=null;}async function _0x23fcf7(_0x122279){const _0x394a04=_0x18b51e;if(!_0x42bf96)return;const _0x499e36=_0x42bf96,_0x15c2b9=_0x405767[_0x394a04(0x799)][_0x405767[_0x394a04(0x248)]],_0x5573ab=_0x15c2b9[_0x394a04(0xd39)]['findIndex'](_0x456b0e=>_0x456b0e['timestamp']===_0x499e36);if(_0x5573ab===-0x1)return;const _0x46dba2=_0x15c2b9[_0x394a04(0xd39)][_0x5573ab];_0x46dba2['status']=_0x122279;let _0xcd43be;if(_0x122279===_0x394a04(0x1288)){const _0x16bc41={'role':_0x394a04(0x74b),'type':_0x394a04(0x11b9),'isRefund':!![],'amount':_0x46dba2[_0x394a04(0x4c5)],'note':_0x394a04(0xd31),'timestamp':Date[_0x394a04(0x1ed)]()};_0x15c2b9[_0x394a04(0xd39)][_0x394a04(0xa49)](_0x16bc41),_0xcd43be=_0x394a04(0xfc5)+_0x46dba2['senderName']+_0x394a04(0xef8);}else _0xcd43be=_0x394a04(0x250)+_0x46dba2[_0x394a04(0x770)]+_0x394a04(0xef8);const _0x455061={'role':_0x394a04(0x46c),'content':_0xcd43be,'timestamp':Date[_0x394a04(0x1ed)]()+0x1,'isHidden':!![]};_0x15c2b9['history']['push'](_0x455061),await _0x15043e['chats'][_0x394a04(0xfaa)](_0x15c2b9),_0x5b4d91(),_0x7dbe71(_0x405767[_0x394a04(0x248)]),_0x2b55d1();}async function _0x192cae(){const _0x1f2a4e=_0x18b51e;_0x3d1990(_0x1f2a4e(0xf4f));const _0x44a30f=document[_0x1f2a4e(0x8c2)](_0x1f2a4e(0x11fb)),_0x4867c6=document['getElementById'](_0x1f2a4e(0x305));_0x44a30f[_0x1f2a4e(0xca0)]='',_0x4867c6['textContent']='所有通话记录';const _0x17d997=await _0x15043e[_0x1f2a4e(0x164)][_0x1f2a4e(0x731)](_0x1f2a4e(0x351))[_0x1f2a4e(0x1c0)]()[_0x1f2a4e(0x6be)]();if(_0x17d997['length']===0x0){_0x44a30f['innerHTML']=_0x1f2a4e(0x1c3);return;}_0x17d997[_0x1f2a4e(0x7c0)](_0x34fa67=>{const _0x454bd1=_0x1f2a4e,_0x3ac930=_0x5be0bf(_0x34fa67);_0x5dcbd7(_0x3ac930,async()=>{const _0x745943=_0x7a65,_0x4169dc=await _0x180f74('自定义通话名称',_0x745943(0x1236),_0x34fa67[_0x745943(0x8d5)]||'');if(_0x4169dc===null)return;await _0x15043e[_0x745943(0x164)]['update'](_0x34fa67['id'],{'customName':_0x4169dc[_0x745943(0x8c6)]()}),await _0x192cae(),await _0x501c7b('成功','通话名称已更新！');}),_0x44a30f[_0x454bd1(0x31e)](_0x3ac930);});}function _0x5be0bf(_0x22973c){const _0x447390=_0x18b51e,_0x313dac=document['createElement'](_0x447390(0x1072));_0x313dac['className']=_0x447390(0xba7),_0x313dac['dataset'][_0x447390(0x548)]=_0x22973c['id'];const _0x9c75ec=_0x405767['chats'][_0x22973c[_0x447390(0xb3d)]],_0x5c7958=_0x9c75ec?_0x9c75ec['name']:_0x447390(0x1208),_0x3459a0=new Date(_0x22973c[_0x447390(0x351)]),_0x41e859=_0x3459a0[_0x447390(0x864)]()+'-'+String(_0x3459a0[_0x447390(0xc3c)]()+0x1)['padStart'](0x2,'0')+'-'+String(_0x3459a0[_0x447390(0xca8)]())[_0x447390(0xc89)](0x2,'0')+'\x20'+String(_0x3459a0['getHours']())['padStart'](0x2,'0')+':'+String(_0x3459a0['getMinutes']())[_0x447390(0xc89)](0x2,'0'),_0x1a2356=Math[_0x447390(0x10b2)](_0x22973c[_0x447390(0xf2c)]/0x3c)+'分'+_0x22973c[_0x447390(0xf2c)]%0x3c+'秒',_0x5e9163=_0x22973c[_0x447390(0x190)][_0x447390(0x6b9)](_0x5a9d49=>_0x447390(0x333)+_0x5a9d49[_0x447390(0x1e1)]+_0x447390(0x1023)+_0x5a9d49[_0x447390(0x596)]+_0x447390(0x10cf)+_0x5a9d49[_0x447390(0x596)]+'\x22>')[_0x447390(0xb2c)]('');return _0x313dac['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>'+_0x41e859+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>'+_0x1a2356+_0x447390(0x1151)+(_0x22973c[_0x447390(0x8d5)]?_0x447390(0x33f)+_0x22973c['customName']+_0x447390(0x1079):'')+_0x447390(0x203)+_0x5e9163+_0x447390(0x79b)+_0x5c7958+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x313dac;}async function _0x52ac9c(_0x5eb506){const _0x38fcdf=_0x18b51e,_0x343f2f=await _0x15043e['callRecords'][_0x38fcdf(0x3e9)](_0x5eb506);if(!_0x343f2f)return;const _0x45d3cf=document[_0x38fcdf(0x8c2)](_0x38fcdf(0x78a)),_0x2e5d01=document[_0x38fcdf(0x8c2)](_0x38fcdf(0x5f6)),_0x1c3859=document[_0x38fcdf(0x8c2)]('call-transcript-modal-body');_0x2e5d01[_0x38fcdf(0x1090)]='通话于\x20'+new Date(_0x343f2f[_0x38fcdf(0x351)])[_0x38fcdf(0x2e8)]()+'\x20(时长:\x20'+Math[_0x38fcdf(0x10b2)](_0x343f2f[_0x38fcdf(0xf2c)]/0x3c)+'分'+_0x343f2f[_0x38fcdf(0xf2c)]%0x3c+'秒)',_0x1c3859[_0x38fcdf(0xca0)]='';const _0x2b9f33=document[_0x38fcdf(0x8c2)](_0x38fcdf(0xe31)),_0x2d5fa7=document[_0x38fcdf(0x8c2)](_0x38fcdf(0x11e1));!_0x343f2f[_0x38fcdf(0xe01)]||_0x343f2f['transcript'][_0x38fcdf(0x105a)]===0x0?(_0x1c3859[_0x38fcdf(0xca0)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>',_0x2d5fa7['style'][_0x38fcdf(0x5e9)]=_0x38fcdf(0xbf8)):(_0x2d5fa7[_0x38fcdf(0x842)][_0x38fcdf(0x5e9)]=_0x38fcdf(0xea7),_0x343f2f[_0x38fcdf(0xe01)][_0x38fcdf(0x7c0)](_0x1da47b=>{const _0x46d4b9=_0x38fcdf,_0x484860=document['createElement'](_0x46d4b9(0x1072));_0x484860[_0x46d4b9(0x84c)]=_0x46d4b9(0x96e)+_0x1da47b[_0x46d4b9(0x14a)],_0x484860[_0x46d4b9(0x1090)]=_0x1da47b['content'],_0x1c3859['appendChild'](_0x484860);}));const _0x2dd3e8=_0x2b9f33['cloneNode'](!![]);_0x2b9f33['parentNode'][_0x38fcdf(0x56b)](_0x2dd3e8,_0x2b9f33);const _0x218006=_0x2d5fa7['cloneNode'](!![]);_0x2d5fa7['parentNode'][_0x38fcdf(0x56b)](_0x218006,_0x2d5fa7),_0x2dd3e8[_0x38fcdf(0xae8)](_0x38fcdf(0xa17),async()=>{const _0x42a388=_0x38fcdf,_0x4bd25f=await _0x8b9cb8(_0x42a388(0xad9),_0x42a388(0x11d4),{'confirmButtonClass':_0x42a388(0xe2a)});_0x4bd25f&&(_0x45d3cf[_0x42a388(0xb17)][_0x42a388(0xaff)]('visible'),await _0x15043e[_0x42a388(0x164)][_0x42a388(0x89f)](_0x5eb506),await _0x192cae(),alert(_0x42a388(0x712)));}),_0x218006[_0x38fcdf(0xae8)]('click',async()=>{const _0x37fa5e=_0x38fcdf,_0xb34ac1=await _0x8b9cb8('确认操作',_0x37fa5e(0x11fc),{'confirmText':_0x37fa5e(0x64c)});if(!_0xb34ac1)return;_0x45d3cf['classList'][_0x37fa5e(0xaff)]('visible');const _0x3277e5=_0x405767[_0x37fa5e(0x799)][_0x343f2f[_0x37fa5e(0xb3d)]];if(!_0x3277e5){alert(_0x37fa5e(0x6a9));return;}await _0x501c7b(_0x37fa5e(0x1047),'正在请求AI进行手动总结...');try{const _0x73f731=_0x343f2f[_0x37fa5e(0xe01)][_0x37fa5e(0x6b9)](_0x1e4ba0=>{const _0x191223=_0x37fa5e,_0x42528a=_0x1e4ba0[_0x191223(0x14a)]===_0x191223(0x74b)?_0x3277e5['settings']['myNickname']||'我':_0x1e4ba0['senderName']||_0x3277e5[_0x191223(0x596)];return _0x42528a+':\x20'+_0x1e4ba0['content'];})[_0x37fa5e(0xb2c)]('\x0a');await _0x1c46b5(_0x343f2f[_0x37fa5e(0xb3d)],_0x73f731),await _0x501c7b(_0x37fa5e(0x1265),_0x37fa5e(0xeeb)+_0x3277e5[_0x37fa5e(0x596)]+_0x37fa5e(0x6f3));}catch(_0x3994d0){await _0x501c7b('总结失败',_0x37fa5e(0x48d)+_0x3994d0[_0x37fa5e(0xc7d)]);}});const _0x5bb256=document[_0x38fcdf(0x8c2)](_0x38fcdf(0x215)),_0x3ce383=_0x5bb256[_0x38fcdf(0xac5)](!![]);_0x5bb256[_0x38fcdf(0xe66)][_0x38fcdf(0x56b)](_0x3ce383,_0x5bb256),_0x3ce383[_0x38fcdf(0xae8)](_0x38fcdf(0xa17),()=>{const _0x378021=_0x38fcdf;_0x45d3cf['classList']['remove'](_0x378021(0x2cd));}),_0x45d3cf[_0x38fcdf(0xb17)][_0x38fcdf(0x3f4)](_0x38fcdf(0x2cd));}async function _0x188fb3(){const _0x179d7d=_0x18b51e;if(!_0x405767[_0x179d7d(0x248)]||_0x405767[_0x179d7d(0x799)][_0x405767[_0x179d7d(0x248)]][_0x179d7d(0x1000)])return;const _0x45a85a=_0x405767[_0x179d7d(0x799)][_0x405767[_0x179d7d(0x248)]],_0x3253e8=await _0x180f74(_0x179d7d(0xd26),_0x179d7d(0x11c2),_0x45a85a['status'][_0x179d7d(0xbc6)]);_0x3253e8!==null&&(_0x45a85a[_0x179d7d(0x8c8)][_0x179d7d(0xbc6)]=_0x3253e8[_0x179d7d(0x8c6)]()||'在线',_0x45a85a[_0x179d7d(0x8c8)][_0x179d7d(0xb5e)]=![],_0x45a85a[_0x179d7d(0x8c8)][_0x179d7d(0xfc1)]=Date['now'](),await _0x15043e[_0x179d7d(0x799)][_0x179d7d(0xfaa)](_0x45a85a),_0x7dbe71(_0x405767[_0x179d7d(0x248)]),_0x2b55d1(),await _0x501c7b('状态已更新','“'+_0x45a85a[_0x179d7d(0x596)]+'”的当前状态已更新为：'+_0x45a85a[_0x179d7d(0x8c8)][_0x179d7d(0xbc6)]));}async function _0x21c59b(){const _0x5606bc=_0x18b51e,_0x4a0029=document[_0x5606bc(0x8c2)](_0x5606bc(0xc49)),_0x35bb1d=document[_0x5606bc(0x8c2)]('share-target-list');_0x35bb1d[_0x5606bc(0xca0)]='';const _0x2ef1e2=Object[_0x5606bc(0x22f)](_0x405767['chats']);_0x2ef1e2['forEach'](_0x148d8c=>{const _0x457709=_0x5606bc,_0x2dfa5c=document[_0x457709(0x8c1)](_0x457709(0x1072));_0x2dfa5c['className']=_0x457709(0xc25),_0x2dfa5c[_0x457709(0xca0)]=_0x457709(0xa84)+_0x148d8c['id']+_0x457709(0x859)+(_0x148d8c[_0x457709(0x1000)]?_0x148d8c[_0x457709(0x33a)][_0x457709(0x43b)]:_0x148d8c[_0x457709(0x33a)][_0x457709(0x44e)]||_0x49d2a4)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x148d8c[_0x457709(0x596)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x35bb1d[_0x457709(0x31e)](_0x2dfa5c);}),_0x4a0029[_0x5606bc(0xb17)][_0x5606bc(0x3f4)]('visible');}function _0x8d5530(_0x5b5508){const _0x187f42=_0x18b51e,_0x1c94e7=document[_0x187f42(0x8c2)](_0x187f42(0x1df));if(!_0x1c94e7[_0x187f42(0xb17)][_0x187f42(0x795)](_0x187f42(0x2cd))){if(_0x5b5508)_0x5b5508();return;}_0x1c94e7['classList']['remove']('visible'),setTimeout(()=>{const _0x1d9ada=_0x187f42;document[_0x1d9ada(0x8c2)]('music-playlist-panel')[_0x1d9ada(0xb17)][_0x1d9ada(0xaff)]('visible');if(_0x5b5508)_0x5b5508();},0x190);}function _0x584f3f(_0x589009){const _0x44622e=_0x18b51e;if(!_0x589009)return[];const _0x292256=String(_0x589009)['split'](/\r\n?|\n/),_0x269c55=[],_0x5c06ff=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0x8606d2 of _0x292256){const _0x490d98=_0x8606d2[_0x44622e(0x1b7)](_0x5c06ff,'')[_0x44622e(0x8c6)]();if(!_0x490d98)continue;_0x5c06ff[_0x44622e(0x980)]=0x0;let _0x39e4b6;while((_0x39e4b6=_0x5c06ff['exec'](_0x8606d2))!==null){const _0x5ac23f=parseInt(_0x39e4b6[0x1],0xa),_0x1600b9=parseInt(_0x39e4b6[0x2],0xa),_0x4e4e2c=parseInt(_0x39e4b6[0x3]['padEnd'](0x3,'0'),0xa),_0x361c65=_0x5ac23f*0x3c+_0x1600b9+_0x4e4e2c/0x3e8;_0x269c55[_0x44622e(0xa49)]({'time':_0x361c65,'text':_0x490d98});}}return _0x269c55['sort']((_0x22b387,_0xd0206b)=>_0x22b387[_0x44622e(0x10d0)]-_0xd0206b[_0x44622e(0x10d0)]);}function _0x542c77(){const _0x5b8c6c=_0x18b51e,_0xed01df=document['getElementById']('music-lyrics-list');_0xed01df[_0x5b8c6c(0xca0)]='';if(!_0x4a77e1[_0x5b8c6c(0x619)]||_0x4a77e1[_0x5b8c6c(0x619)][_0x5b8c6c(0x105a)]===0x0){_0xed01df['innerHTML']=_0x5b8c6c(0x52e);return;}_0x4a77e1[_0x5b8c6c(0x619)][_0x5b8c6c(0x7c0)]((_0x33b4a0,_0x3af62d)=>{const _0x672f66=_0x5b8c6c,_0x4d9e06=document[_0x672f66(0x8c1)]('div');_0x4d9e06[_0x672f66(0x84c)]=_0x672f66(0x1f2),_0x4d9e06[_0x672f66(0x1090)]=_0x33b4a0[_0x672f66(0xbc6)],_0x4d9e06[_0x672f66(0x323)][_0x672f66(0x2f2)]=_0x3af62d,_0xed01df[_0x672f66(0x31e)](_0x4d9e06);}),_0xed01df['style']['transform']=_0x5b8c6c(0xcc5);}function _0x539bbd(_0x58c50c){const _0x1092ab=_0x18b51e;if(_0x4a77e1['parsedLyrics'][_0x1092ab(0x105a)]===0x0)return;let _0x1e7010=-0x1;for(let _0x4a1a4f=0x0;_0x4a1a4f<_0x4a77e1[_0x1092ab(0x619)][_0x1092ab(0x105a)];_0x4a1a4f++){if(_0x58c50c>=_0x4a77e1[_0x1092ab(0x619)][_0x4a1a4f][_0x1092ab(0x10d0)])_0x1e7010=_0x4a1a4f;else break;}if(_0x1e7010===_0x4a77e1[_0x1092ab(0x117a)])return;_0x4a77e1[_0x1092ab(0x117a)]=_0x1e7010,_0x57987f();const _0xa2ab7=document['getElementById'](_0x1092ab(0xb40));_0xa2ab7&&(_0x1e7010>-0x1&&_0x4a77e1[_0x1092ab(0x619)][_0x1e7010]?_0xa2ab7[_0x1092ab(0x1090)]=_0x4a77e1[_0x1092ab(0x619)][_0x1e7010]['text']:_0xa2ab7[_0x1092ab(0x1090)]='♪\x20♪\x20♪');const _0x3ebd12=document['getElementById'](_0x1092ab(0x5a6));_0x3ebd12[_0x1092ab(0xb17)][_0x1092ab(0x795)]('visible')&&(_0x1e7010>-0x1&&_0x4a77e1[_0x1092ab(0x619)][_0x1e7010]?_0x3ebd12[_0x1092ab(0x1090)]=_0x4a77e1[_0x1092ab(0x619)][_0x1e7010][_0x1092ab(0xbc6)]:_0x3ebd12[_0x1092ab(0x1090)]='♪');}function _0x57987f(_0x410462=![]){const _0x40eaa5=_0x18b51e,_0x1ce001=_0x410462?_0x40eaa5(0x7a8):_0x40eaa5(0x46d),_0x4c6496=_0x410462?_0x40eaa5(0xccb):_0x40eaa5(0x3a0),_0x59911a=document[_0x40eaa5(0x1ad)](_0x1ce001),_0x4c0450=document[_0x40eaa5(0x1ad)](_0x4c6496);if(!_0x59911a||!_0x4c0450)return;const _0x3f93a0=_0x59911a[_0x40eaa5(0xa2d)](_0x40eaa5(0x8be));_0x3f93a0[_0x40eaa5(0x7c0)](_0x1b1341=>_0x1b1341[_0x40eaa5(0xb17)][_0x40eaa5(0xaff)]('active'));if(_0x4a77e1[_0x40eaa5(0x117a)]===-0x1){_0x59911a[_0x40eaa5(0x842)][_0x40eaa5(0xb56)]='translateY(0px)';return;}const _0x32463c=_0x59911a[_0x40eaa5(0x1ad)](_0x40eaa5(0xb90)+_0x4a77e1['currentLyricIndex']+'\x22]');if(_0x32463c){_0x32463c['classList'][_0x40eaa5(0x3f4)]('active');const _0x438480=_0x4c0450['offsetHeight'],_0x54f895=_0x438480/2.2-_0x32463c[_0x40eaa5(0x341)]-_0x32463c[_0x40eaa5(0x633)]/0x2;_0x59911a[_0x40eaa5(0x842)][_0x40eaa5(0xb56)]='translateY('+_0x54f895+_0x40eaa5(0x4e8);}}function _0x5a2954(_0x390df1){const _0x10f008=_0x18b51e;if(isNaN(_0x390df1)||_0x390df1<0x0)return'0:00';const _0x55d2f8=Math['floor'](_0x390df1/0x3c),_0x28903c=Math[_0x10f008(0x10b2)](_0x390df1%0x3c);return _0x55d2f8+':'+String(_0x28903c)[_0x10f008(0xc89)](0x2,'0');}let _0x55153a=0x0,_0x1030f4;function _0x265f34(){_0x1030f4&&cancelAnimationFrame(_0x1030f4);function _0x26fb9c(){const _0x13e077=_0x7a65;if(!_0x4a77e1['isPlaying']||!_0x3fd13b[_0x13e077(0xf2c)])return;const _0x4a4f0c=performance[_0x13e077(0x1ed)](),_0x220ee8=_0x3fd13b[_0x13e077(0xe5e)],_0x44d0e9=_0x3fd13b['duration'],_0x14f7da=_0x220ee8/_0x44d0e9*0x64;document[_0x13e077(0x8c2)](_0x13e077(0xaf6))[_0x13e077(0x842)][_0x13e077(0x578)]=_0x14f7da+'%',_0x4a4f0c-_0x55153a>0x3e8&&(document[_0x13e077(0x8c2)](_0x13e077(0x6ce))[_0x13e077(0x1090)]=_0x5a2954(_0x220ee8),document['getElementById'](_0x13e077(0xcde))[_0x13e077(0x1090)]=_0x5a2954(_0x44d0e9),_0x55153a=_0x4a4f0c),_0x539bbd(_0x220ee8),_0x1030f4=requestAnimationFrame(_0x26fb9c);}_0x1030f4=requestAnimationFrame(_0x26fb9c);}function _0x3bf696(){const _0x3d89b1=_0x18b51e;if(!lastRawAiResponse){alert(_0x3d89b1(0x6ab));return;}const _0x5e10a9=document['getElementById']('ai-response-editor-modal'),_0x34e105=document['getElementById'](_0x3d89b1(0xa61));_0x34e105['innerHTML']='';const _0x776b01=lastRawAiResponse[_0x3d89b1(0xdf8)](/{[^{}]*}/g);if(_0x776b01)_0x776b01['forEach'](_0x5bb571=>{const _0x3ad0d1=_0x3d89b1;try{const _0x1b6296=JSON[_0x3ad0d1(0x10ab)](_0x5bb571),_0x5dfe62=JSON['stringify'](_0x1b6296,null,0x2),_0x31286d=_0x17c4cd(_0x5dfe62);_0x34e105[_0x3ad0d1(0x31e)](_0x31286d);}catch(_0x64d4b9){const _0x506f28=_0x17c4cd(_0x5bb571);_0x34e105['appendChild'](_0x506f28),console[_0x3ad0d1(0x112a)](_0x3ad0d1(0xda2),_0x5bb571);}});else{const _0xdc9bc2=_0x17c4cd(lastRawAiResponse);_0x34e105[_0x3d89b1(0x31e)](_0xdc9bc2);}_0x5e10a9[_0x3d89b1(0xb17)]['add'](_0x3d89b1(0x2cd));}function _0x17c4cd(_0x212154=''){const _0x152574=_0x18b51e,_0x2806db=document[_0x152574(0x8c1)]('div');_0x2806db[_0x152574(0x84c)]=_0x152574(0x11c0);const _0x5203e8={'text':{'type':'text','content':'在这里输入文本...'},'sticker':{'type':_0x152574(0x1ac),'url':_0x152574(0xf37),'meaning':_0x152574(0x4bb)},'image':{'type':_0x152574(0x7c8),'description':_0x152574(0x1289)},'voice':{'type':'voice_message','content':'在这里输入语音内容...'},'transfer':{'type':_0x152574(0x11b9),'amount':5.2,'note':_0x152574(0xa57)},'offline':{'type':'offline_text','content':'「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)'},'quote':{'type':_0x152574(0x58a),'target_timestamp':0x499602d2,'reply_content':_0x152574(0x23c)}};return _0x2806db['innerHTML']=_0x152574(0x2b1)+_0x212154+_0x152574(0x764)+JSON[_0x152574(0x1175)](_0x5203e8[_0x152574(0xbc6)])+_0x152574(0x678)+JSON[_0x152574(0x1175)](_0x5203e8['sticker'])+_0x152574(0x1291)+JSON['stringify'](_0x5203e8[_0x152574(0xdab)])+_0x152574(0x10f0)+JSON[_0x152574(0x1175)](_0x5203e8[_0x152574(0xba1)])+_0x152574(0xe14)+JSON[_0x152574(0x1175)](_0x5203e8[_0x152574(0x11b9)])+_0x152574(0x10f9)+JSON['stringify'](_0x5203e8[_0x152574(0x11f0)])+'\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x152574(0x1175)](_0x5203e8[_0x152574(0x9d2)])+_0x152574(0x3f3),_0x2806db['querySelector'](_0x152574(0xedb))[_0x152574(0xae8)](_0x152574(0xa17),()=>{const _0x28021e=_0x152574;_0x2806db[_0x28021e(0xaff)]();}),_0x2806db[_0x152574(0xa2d)](_0x152574(0x384))['forEach'](_0x407a2a=>{const _0x333d43=_0x152574;_0x407a2a[_0x333d43(0xae8)](_0x333d43(0xa17),()=>{const _0x5f3a86=_0x333d43,_0x12f253=_0x407a2a[_0x5f3a86(0x323)][_0x5f3a86(0x9db)],_0x109c29=_0x2806db[_0x5f3a86(0x1ad)]('textarea');if(_0x12f253&&_0x109c29)try{const _0x41df17=JSON[_0x5f3a86(0x10ab)](_0x12f253);_0x109c29[_0x5f3a86(0x518)]=JSON[_0x5f3a86(0x1175)](_0x41df17,null,0x2),_0x109c29[_0x5f3a86(0x10f7)]();}catch(_0x35e1bb){console[_0x5f3a86(0x7a3)](_0x5f3a86(0xb01),_0x35e1bb);}});}),_0x2806db;}async function _0x3d359a(){const _0xddad8=_0x18b51e,_0x2fe370=_0x405767[_0xddad8(0x799)][_0x405767[_0xddad8(0x248)]];if(!_0x2fe370)return;const _0x5a011b=document[_0xddad8(0x8c2)](_0xddad8(0xa61)),_0x4f3c9b=_0x5a011b['querySelectorAll'](_0xddad8(0x6c3)),_0x16c59d=Array[_0xddad8(0x51a)](_0x4f3c9b)[_0xddad8(0x6b9)](_0x3004ec=>_0x3004ec[_0xddad8(0x518)][_0xddad8(0x8c6)]())[_0xddad8(0x1d8)](Boolean);if(_0x16c59d[_0xddad8(0x105a)]===0x0){_0x2fe370['history']=_0x2fe370['history'][_0xddad8(0x1d8)](_0x371514=>!lastResponseTimestamps['includes'](_0x371514[_0xddad8(0x351)])),await _0x15043e[_0xddad8(0x799)][_0xddad8(0xfaa)](_0x2fe370),_0x7dbe71(_0x405767[_0xddad8(0x248)]),_0x2b55d1(),document[_0xddad8(0x8c2)](_0xddad8(0xe02))['classList'][_0xddad8(0xaff)](_0xddad8(0x2cd)),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0x320e85=[];for(const _0x51f00e of _0x16c59d){try{const _0x8b8de3=JSON[_0xddad8(0x10ab)](_0x51f00e);_0x320e85[_0xddad8(0xa49)](_0x8b8de3);}catch(_0x571da5){console['warn'](_0xddad8(0x61f),_0x51f00e);}}_0x2fe370[_0xddad8(0xd39)]=_0x2fe370[_0xddad8(0xd39)]['filter'](_0x49f9f2=>!lastResponseTimestamps[_0xddad8(0x773)](_0x49f9f2[_0xddad8(0x351)]));let _0x3a5df6=[],_0x2379dd=Date[_0xddad8(0x1ed)]();for(const _0x4e688d of _0x320e85){if(!_0x4e688d||typeof _0x4e688d!==_0xddad8(0x7a5)||!_0x4e688d[_0xddad8(0xde0)]){console[_0xddad8(0x112a)](_0xddad8(0xe94),_0x4e688d);continue;}let _0x5cddcd=null;const _0x5e5649={'role':_0xddad8(0x458),'senderName':_0x4e688d['name']||_0x2fe370['originalName'],'timestamp':_0x2379dd++};switch(_0x4e688d['type']){case _0xddad8(0xbc6):_0x5cddcd={..._0x5e5649,'content':String(_0x4e688d['content']||_0x4e688d[_0xddad8(0xc7d)])};break;case _0xddad8(0x1ac):_0x5cddcd={..._0x5e5649,'type':_0xddad8(0x1ac),'content':_0x4e688d['url'],'meaning':_0x4e688d[_0xddad8(0x2b7)]||''};break;case'ai_image':_0x5cddcd={..._0x5e5649,'type':'ai_image','content':_0x4e688d[_0xddad8(0x3ca)]};break;case _0xddad8(0xf64):_0x5cddcd={..._0x5e5649,'type':'voice_message','content':_0x4e688d[_0xddad8(0x168)]};break;case'transfer':_0x5cddcd={..._0x5e5649,'type':'transfer','amount':_0x4e688d[_0xddad8(0x4c5)],'note':_0x4e688d[_0xddad8(0x113f)],'receiverName':_0x4e688d['receiver']||'我'};break;case'waimai_request':_0x5cddcd={..._0x5e5649,'type':_0xddad8(0x11b2),'productInfo':_0x4e688d[_0xddad8(0xc7a)],'amount':_0x4e688d['amount'],'status':'pending','countdownEndTime':Date[_0xddad8(0x1ed)]()+0xf*0x3c*0x3e8};break;case'offline_text':_0x5cddcd={..._0x5e5649,..._0x4e688d};break;case'gomoku_move':{const _0x48c4e0=_0x5d05df[_0x2fe370['id']];if(_0x48c4e0){const _0x10d535=_0x48c4e0[_0xddad8(0xd39)][_0xddad8(0x612)](_0x5828c2=>_0x5828c2[_0xddad8(0x3bd)]===0x2);if(_0x10d535>-0x1){const _0xaf2a9f=_0x48c4e0['history'][_0x10d535];_0x48c4e0[_0xddad8(0x511)][_0xaf2a9f['y']][_0xaf2a9f['x']]=0x0,_0x48c4e0[_0xddad8(0xd39)]['splice'](_0x10d535,0x1),console['log'](_0xddad8(0xd81)+_0xaf2a9f['x']+',\x20'+_0xaf2a9f['y']+_0xddad8(0xe0e));}}const _0x1a130d=parseInt(_0x4e688d['x']),_0xf036c3=parseInt(_0x4e688d['y']);!isNaN(_0x1a130d)&&!isNaN(_0xf036c3)?_0x4a5d9b({'x':_0x1a130d,'y':_0xf036c3},!![]):console['warn'](_0xddad8(0x8a3),_0x4e688d);continue;}case _0xddad8(0x894):{if(!_0x2fe370[_0xddad8(0x1000)]){_0x4e688d[_0xddad8(0x10e1)]&&(_0x2fe370[_0xddad8(0x211)]=String(_0x4e688d[_0xddad8(0x10e1)]));_0x4e688d[_0xddad8(0xe1f)]&&(_0x2fe370[_0xddad8(0x103c)]=String(_0x4e688d[_0xddad8(0xe1f)]));!Array[_0xddad8(0xb85)](_0x2fe370['thoughtsHistory'])&&(_0x2fe370[_0xddad8(0x120b)]=[]);_0x2fe370[_0xddad8(0x120b)]['push']({'heartfeltVoice':_0x2fe370[_0xddad8(0x211)],'randomJottings':_0x2fe370[_0xddad8(0x103c)],'timestamp':Date[_0xddad8(0x1ed)]()});_0x2fe370['thoughtsHistory'][_0xddad8(0x105a)]>0x32&&_0x2fe370[_0xddad8(0x120b)][_0xddad8(0x101b)]();const _0xcff57e='[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20'+_0x2fe370['heartfeltVoice']+'\x0a-\x20散记:\x20'+_0x2fe370[_0xddad8(0x103c)],_0x474616={'role':_0xddad8(0x46c),'content':_0xcff57e,'timestamp':Date[_0xddad8(0x1ed)](),'isHidden':!![]};}continue;}case _0xddad8(0x58a):{const _0x5db6d5=_0x2fe370[_0xddad8(0xd39)][_0xddad8(0x2ef)](_0x50914b=>_0x50914b['timestamp']===_0x4e688d[_0xddad8(0x656)]);let _0x48781d=null;if(_0x5db6d5){let _0x19981b=_0x5db6d5[_0xddad8(0x770)];_0x5db6d5[_0xddad8(0x14a)]===_0xddad8(0x74b)&&(_0x19981b=_0x2fe370[_0xddad8(0x1000)]?_0x2fe370['settings'][_0xddad8(0xe16)]||'我':_0x405767[_0xddad8(0x20a)][_0xddad8(0xab3)]||_0xddad8(0x2dc)),_0x48781d={'timestamp':_0x4e688d[_0xddad8(0x656)],'senderName':_0x19981b,'content':String(_0x5db6d5[_0xddad8(0x168)]||'')};}else _0x48781d={'timestamp':_0x4e688d[_0xddad8(0x656)],'senderName':'未知用户','content':_0xddad8(0xbae)};_0x5cddcd={..._0x5e5649,'content':_0x4e688d[_0xddad8(0xe6f)],'quote':_0x48781d};break;}default:console[_0xddad8(0x112a)]('在导演模式保存时，遇到了未知的AI指令类型:',_0x4e688d['type']);break;}_0x5cddcd&&(_0x2fe370[_0xddad8(0xd39)][_0xddad8(0xa49)](_0x5cddcd),_0x3a5df6[_0xddad8(0xa49)](_0x5cddcd[_0xddad8(0x351)]));}await _0x15043e[_0xddad8(0x799)][_0xddad8(0xfaa)](_0x2fe370),_0x7dbe71(_0x405767[_0xddad8(0x248)]),_0x2b55d1(),document[_0xddad8(0x8c2)](_0xddad8(0xe02))['classList'][_0xddad8(0xaff)](_0xddad8(0x2cd)),lastRawAiResponse=_0x16c59d[_0xddad8(0xb2c)]('\x0a\x0a'),lastResponseTimestamps=_0x3a5df6,await _0x501c7b('导演模式',_0xddad8(0xfeb));}async function _0x53f0e1(){const _0x4b039e=_0x18b51e;if(!_0x39784f)return;const _0x47af69=0x2*0x3c*0x3e8,_0x5be20a=_0x39784f,_0x15520a=Date[_0x4b039e(0x1ed)]();if(_0x15520a-_0x5be20a>_0x47af69){_0x152bc1(),await _0x501c7b(_0x4b039e(0xa85),_0x4b039e(0x230));return;}await _0x3f2923(_0x5be20a,!![]),_0x152bc1();}async function _0x3f2923(_0x5db6b7,_0x37b745){const _0x1571bc=_0x18b51e,_0x1725fd=_0x405767[_0x1571bc(0x799)][_0x405767[_0x1571bc(0x248)]];if(!_0x1725fd)return;const _0x3d9117=_0x1725fd['history'][_0x1571bc(0x1149)](_0xa2e145=>_0xa2e145[_0x1571bc(0x351)]===_0x5db6b7);if(_0x3d9117===-0x1)return;const _0x2812d5=_0x1725fd['history'][_0x3d9117],_0x3832ff={'originalType':_0x2812d5[_0x1571bc(0xde0)]||_0x1571bc(0xbc6),'originalContent':_0x2812d5[_0x1571bc(0x168)],'originalMeaning':_0x2812d5[_0x1571bc(0x2b7)],'originalQuote':_0x2812d5[_0x1571bc(0x9d2)]};_0x2812d5['type']=_0x1571bc(0x87c),_0x2812d5[_0x1571bc(0x168)]=_0x37b745?'你撤回了一条消息':_0x1571bc(0x886),_0x2812d5[_0x1571bc(0xf0e)]=_0x3832ff,delete _0x2812d5[_0x1571bc(0x2b7)],delete _0x2812d5[_0x1571bc(0x9d2)];if(_0x37b745){const _0xd3e034=_0x1725fd[_0x1571bc(0x1000)]?_0x1725fd[_0x1571bc(0x33a)][_0x1571bc(0xe16)]||'我':'我';let _0x14b049='';if(_0x3832ff[_0x1571bc(0x123c)]===_0x1571bc(0x1ac))_0x14b049=_0x1571bc(0x751)+(_0x3832ff[_0x1571bc(0x8a2)]||'未知')+']';else _0x3832ff[_0x1571bc(0x123c)]===_0x1571bc(0x7c8)||_0x3832ff[_0x1571bc(0x123c)]===_0x1571bc(0x223)?_0x14b049=_0x1571bc(0xbb5)+_0x3832ff[_0x1571bc(0x657)]+']':_0x14b049='“'+String(_0x3832ff[_0x1571bc(0x657)])+'”';const _0x2a0c54={'role':_0x1571bc(0x46c),'content':_0x1571bc(0xeaf)+_0xd3e034+_0x1571bc(0x50a)+_0x14b049+'。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','timestamp':Date[_0x1571bc(0x1ed)](),'isHidden':!![]};_0x1725fd[_0x1571bc(0xd39)][_0x1571bc(0xa49)](_0x2a0c54);}await _0x15043e[_0x1571bc(0x799)][_0x1571bc(0xfaa)](_0x1725fd),_0x7dbe71(_0x405767[_0x1571bc(0x248)]),_0x37b745&&(_0x2b55d1(),_0x523815());}async function _0x4a1d46(){const _0x181c5f=_0x18b51e;await _0x24c579(),document[_0x181c5f(0x8c2)](_0x181c5f(0x93e))[_0x181c5f(0xb17)][_0x181c5f(0x3f4)](_0x181c5f(0x2cd));}async function _0x24c579(){const _0xf63419=_0x18b51e,_0x2c2476=document[_0xf63419(0x8c2)](_0xf63419(0x37b)),_0xa721b7=await _0x15043e['worldBookCategories'][_0xf63419(0x6be)]();_0x2c2476[_0xf63419(0xca0)]='',_0xa721b7[_0xf63419(0x105a)]===0x0&&(_0x2c2476[_0xf63419(0xca0)]=_0xf63419(0xfa8)),_0xa721b7[_0xf63419(0x7c0)](_0x170fd0=>{const _0x509a88=_0xf63419,_0x365863=document[_0x509a88(0x8c1)]('div');_0x365863[_0x509a88(0x84c)]=_0x509a88(0x376),_0x365863['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x170fd0['name']+_0x509a88(0x5a9)+_0x170fd0['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2c2476[_0x509a88(0x31e)](_0x365863);});}async function _0x1c0a47(){const _0x3a4c44=_0x18b51e,_0x5375fe=document['getElementById'](_0x3a4c44(0x379)),_0x5ebd41=_0x5375fe['value']['trim']();if(!_0x5ebd41){alert(_0x3a4c44(0xc42));return;}const _0x36ebd7=await _0x15043e[_0x3a4c44(0x4a5)][_0x3a4c44(0xdb8)]('name')[_0x3a4c44(0xc9a)](_0x5ebd41)[_0x3a4c44(0xf2e)]();if(_0x36ebd7){alert(_0x3a4c44(0xbb3)+_0x5ebd41+'\x22\x20已经存在了！');return;}await _0x15043e['worldBookCategories'][_0x3a4c44(0x3f4)]({'name':_0x5ebd41}),_0x5375fe[_0x3a4c44(0x518)]='',await _0x24c579();}async function _0x111f54(_0x57b1d6){const _0x168984=_0x18b51e,_0x3402af=await _0x8b9cb8(_0x168984(0xad9),_0x168984(0xe54),{'confirmButtonClass':_0x168984(0xe2a)});if(_0x3402af){await _0x15043e[_0x168984(0x4a5)]['delete'](_0x57b1d6);const _0x58bfc3=await _0x15043e[_0x168984(0x40e)][_0x168984(0xdb8)](_0x168984(0x792))['equals'](_0x57b1d6)[_0x168984(0x6be)]();for(const _0x84f008 of _0x58bfc3){_0x84f008['categoryId']=null,await _0x15043e[_0x168984(0x40e)][_0x168984(0xfaa)](_0x84f008);const _0x11bf08=_0x405767['worldBooks']['find'](_0x4dcc58=>_0x4dcc58['id']===_0x84f008['id']);if(_0x11bf08)_0x11bf08[_0x168984(0x792)]=null;}await _0x24c579();}}async function _0x39e4d0(){const _0x43aab9=_0x18b51e;if(!_0x39784f)return;const _0x59ddb5=_0x39784f;_0x152bc1();const _0x5bbe00=_0x405767[_0x43aab9(0x799)][_0x405767[_0x43aab9(0x248)]],_0xa1f9b3=_0x5bbe00[_0x43aab9(0xd39)][_0x43aab9(0x2ef)](_0x9ea004=>_0x9ea004[_0x43aab9(0x351)]===_0x59ddb5);if(!_0xa1f9b3)return;let _0x3402dc=String(_0xa1f9b3[_0x43aab9(0x168)]||'')[_0x43aab9(0x599)](0x0,0x32)+_0x43aab9(0x388);if(_0xa1f9b3[_0x43aab9(0xde0)]===_0x43aab9(0x7c8))_0x3402dc=_0x43aab9(0x7e7)+_0x3402dc;const _0x1c0bf6=await _0x8b9cb8(_0x43aab9(0xe3b),_0x43aab9(0x420)+_0x3402dc+'”',{'confirmText':'确定发布'});if(_0x1c0bf6){const _0x13b7c8=_0x5bbe00[_0x43aab9(0x33a)][_0x43aab9(0xe16)]||'我';!Array[_0x43aab9(0xb85)](_0x5bbe00['announcements'])&&(_0x5bbe00[_0x43aab9(0x5d6)]=[]);const _0x3a8a1e={'id':_0x43aab9(0x89e)+Date[_0x43aab9(0x1ed)](),'messageTimestamp':_0x59ddb5,'publisher':_0x13b7c8,'publishedAt':Date[_0x43aab9(0x1ed)](),'isPinned':![]};_0x5bbe00[_0x43aab9(0x5d6)][_0x43aab9(0xa49)](_0x3a8a1e);const _0x4a7f1a={'role':_0x43aab9(0x46c),'type':_0x43aab9(0x6f1),'content':_0x13b7c8+_0x43aab9(0x18c),'timestamp':Date['now']()};_0x5bbe00['history'][_0x43aab9(0xa49)](_0x4a7f1a),await _0x15043e[_0x43aab9(0x799)][_0x43aab9(0xfaa)](_0x5bbe00),_0x5c5c92(_0x4a7f1a,_0x5bbe00),_0x2b55d1(),await _0x501c7b('成功',_0x43aab9(0x875));}}async function _0x86a8ba(){const _0x5e2d90=_0x18b51e,_0x4e3a81=_0x405767['chats'][_0x405767[_0x5e2d90(0x248)]],_0x289d88=_0x4e3a81[_0x5e2d90(0x5d6)]||[];if(!_0x4e3a81||_0x289d88[_0x5e2d90(0x105a)]===0x0){_0x501c7b('提示',_0x5e2d90(0xaa0));return;}const _0x598df9=document['getElementById']('announcement-board-content');_0x598df9[_0x5e2d90(0xca0)]='',_0x289d88[_0x5e2d90(0xa19)]((_0x3b5d12,_0xd788a7)=>(_0xd788a7['isPinned']?0x1:0x0)-(_0x3b5d12[_0x5e2d90(0xe06)]?0x1:0x0));for(const _0x403c99 of _0x289d88){const _0x9bc48c=_0x4e3a81['history'][_0x5e2d90(0x2ef)](_0x1116dc=>_0x1116dc[_0x5e2d90(0x351)]===_0x403c99[_0x5e2d90(0x5a8)]),_0x2816f6=document['createElement']('div');_0x2816f6[_0x5e2d90(0x84c)]='announcement-item-wrapper';if(_0x9bc48c){const _0xe33027=await _0x3cd22d(_0x9bc48c,_0x4e3a81);_0xe33027&&_0x2816f6[_0x5e2d90(0x31e)](_0xe33027);}else _0x2816f6['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>';_0x403c99[_0x5e2d90(0xe06)]&&(_0x2816f6[_0x5e2d90(0xca0)]+='<div\x20class=\x22pinned-indicator\x22>📌</div>'),_0x2816f6[_0x5e2d90(0xca0)]+=_0x5e2d90(0x852)+_0x403c99['id']+_0x5e2d90(0xa72),_0x598df9[_0x5e2d90(0x31e)](_0x2816f6);}document['getElementById'](_0x5e2d90(0x5e2))[_0x5e2d90(0xb17)][_0x5e2d90(0x3f4)](_0x5e2d90(0x2cd));}let _0x23ed02=null;function _0x2da1ef(_0x130491){const _0x2b47be=_0x18b51e;_0x23ed02=_0x130491;const _0x2ba9da=_0x405767['chats'][_0x405767[_0x2b47be(0x248)]],_0x2eabb6=_0x2ba9da[_0x2b47be(0x5d6)][_0x2b47be(0x2ef)](_0x3f96e7=>_0x3f96e7['id']===_0x130491);if(!_0x2eabb6)return;const _0x1c75b0=document['getElementById']('announcement-action-pin');_0x1c75b0['textContent']=_0x2eabb6[_0x2b47be(0xe06)]?_0x2b47be(0x3c5):'置顶公告',document['getElementById'](_0x2b47be(0xc9e))['classList'][_0x2b47be(0x3f4)](_0x2b47be(0x2cd));}async function _0x190e62(){const _0x279edb=_0x18b51e;if(!_0x23ed02)return;const _0x441cb6=_0x405767[_0x279edb(0x799)][_0x405767['activeChatId']],_0x31372d=_0x441cb6[_0x279edb(0x5d6)][_0x279edb(0x2ef)](_0x52d78e=>_0x52d78e['id']===_0x23ed02);_0x31372d&&(_0x31372d[_0x279edb(0xe06)]=!_0x31372d['isPinned'],await _0x15043e[_0x279edb(0x799)]['put'](_0x441cb6),_0x86a8ba()),document[_0x279edb(0x8c2)](_0x279edb(0xc9e))['classList'][_0x279edb(0xaff)]('visible');}async function _0x2d02d0(){const _0x569532=_0x18b51e;if(!_0x23ed02)return;const _0x6fc399=await _0x8b9cb8(_0x569532(0xad9),_0x569532(0x8d8),{'confirmButtonClass':'btn-danger'});if(_0x6fc399){const _0x155e49=_0x405767[_0x569532(0x799)][_0x405767[_0x569532(0x248)]];_0x155e49['announcements']=_0x155e49[_0x569532(0x5d6)]['filter'](_0x42a08f=>_0x42a08f['id']!==_0x23ed02),await _0x15043e[_0x569532(0x799)][_0x569532(0xfaa)](_0x155e49),_0x86a8ba();}document[_0x569532(0x8c2)]('announcement-actions-modal')[_0x569532(0xb17)][_0x569532(0xaff)](_0x569532(0x2cd));}let _0x309580=![],_0x4c9544={'ai':null,'my':null};function _0x11b4e7(_0xb79120=_0x18b51e(0x6d4)){const _0x233298=_0x18b51e,_0x18ba6f=document[_0x233298(0x8c2)]('avatar-frame-modal');if(!_0x405767[_0x233298(0x248)])return;const _0x5be3d3=_0x405767[_0x233298(0x799)][_0x405767[_0x233298(0x248)]];_0x309580=_0xb79120==='member';if(_0x309580){const _0x32af86=_0x5be3d3[_0x233298(0x635)][_0x233298(0x2ef)](_0x3f494e=>_0x3f494e['id']===_0x4c8670);if(!_0x32af86)return;_0x4c9544['my']=_0x32af86['avatarFrame']||'',_0x515f1c(!![],_0x32af86['avatar'],_0x32af86[_0x233298(0xe78)]);}else _0x4c9544['ai']=_0x5be3d3[_0x233298(0x33a)][_0x233298(0x1b1)]||'',_0x4c9544['my']=_0x5be3d3[_0x233298(0x33a)][_0x233298(0x538)]||'',_0x515f1c(![]);_0x18ba6f['classList'][_0x233298(0x3f4)]('visible');}function _0x515f1c(_0x4ae2c3=![],_0x3936f2=null,_0x3ac2ee=null){const _0x3f3637=_0x18b51e,_0x215cd1=document[_0x3f3637(0x8c2)]('ai-frame-grid'),_0x1dd637=document[_0x3f3637(0x8c2)]('my-frame-grid'),_0x251240=_0x405767[_0x3f3637(0x799)][_0x405767[_0x3f3637(0x248)]];_0x215cd1[_0x3f3637(0xca0)]='',_0x1dd637[_0x3f3637(0xca0)]='',document[_0x3f3637(0x1ad)](_0x3f3637(0x347))[_0x3f3637(0x842)]['display']=_0x4ae2c3?'none':'flex',document[_0x3f3637(0x8c2)](_0x3f3637(0x102a))[_0x3f3637(0x842)]['display']=_0x3f3637(0xea7),document[_0x3f3637(0x8c2)](_0x3f3637(0xec1))[_0x3f3637(0x842)][_0x3f3637(0x5e9)]=_0x3f3637(0xbf8),document[_0x3f3637(0x8c2)](_0x3f3637(0x903))['classList'][_0x3f3637(0x3f4)](_0x3f3637(0x71b)),document[_0x3f3637(0x8c2)]('my-frame-tab')[_0x3f3637(0xb17)][_0x3f3637(0xaff)](_0x3f3637(0x71b));if(_0x4ae2c3)_0x469d4b['forEach'](_0x34eba7=>{const _0x15019a=_0x3f3637,_0x1f8727=_0x3d3174(_0x34eba7,'my',_0x3936f2);_0x34eba7[_0x15019a(0x9d6)]===_0x3ac2ee&&_0x1f8727[_0x15019a(0xb17)][_0x15019a(0x3f4)](_0x15019a(0x118f)),_0x215cd1['appendChild'](_0x1f8727);});else{const _0x7fdb33=_0x251240[_0x3f3637(0x33a)][_0x3f3637(0x44e)]||_0x49d2a4,_0x1298c3=_0x251240[_0x3f3637(0x33a)][_0x3f3637(0x11ed)]||(_0x251240[_0x3f3637(0x1000)]?_0x38e728:_0x49d2a4);_0x469d4b[_0x3f3637(0x7c0)](_0x183840=>{const _0x3e3d42=_0x3f3637,_0x5eee00=_0x3d3174(_0x183840,'ai',_0x7fdb33);if(_0x183840['url']===_0x4c9544['ai'])_0x5eee00['classList'][_0x3e3d42(0x3f4)]('selected');_0x215cd1[_0x3e3d42(0x31e)](_0x5eee00);const _0x5ca104=_0x3d3174(_0x183840,'my',_0x1298c3);if(_0x183840['url']===_0x4c9544['my'])_0x5ca104[_0x3e3d42(0xb17)][_0x3e3d42(0x3f4)]('selected');_0x1dd637['appendChild'](_0x5ca104);});}}function _0x3d3174(_0x4dc044,_0x442c46,_0x278821){const _0x567d63=_0x18b51e,_0x152754=document['createElement']('div');return _0x152754[_0x567d63(0x84c)]='frame-item',_0x152754[_0x567d63(0x323)]['frameUrl']=_0x4dc044[_0x567d63(0x9d6)],_0x152754[_0x567d63(0xcea)]=_0x4dc044[_0x567d63(0x596)],_0x152754[_0x567d63(0xca0)]=_0x567d63(0x3fb)+_0x278821+_0x567d63(0xe9a)+(_0x4dc044[_0x567d63(0x9d6)]?_0x567d63(0x333)+_0x4dc044[_0x567d63(0x9d6)]+_0x567d63(0xab0):'')+_0x567d63(0x115d),_0x152754['addEventListener'](_0x567d63(0xa17),()=>{const _0x4ef862=_0x567d63;_0x4c9544[_0x442c46]=_0x4dc044[_0x4ef862(0x9d6)];const _0x513498=_0x442c46==='ai'?document['getElementById']('ai-frame-grid'):document[_0x4ef862(0x8c2)](_0x4ef862(0x766));_0x513498[_0x4ef862(0xa2d)]('.frame-item')[_0x4ef862(0x7c0)](_0x3b4d16=>_0x3b4d16[_0x4ef862(0xb17)][_0x4ef862(0xaff)](_0x4ef862(0x118f))),_0x152754['classList'][_0x4ef862(0x3f4)](_0x4ef862(0x118f));}),_0x152754;}async function _0x552ef8(){const _0x3ec53f=_0x18b51e;if(!_0x405767['activeChatId'])return;const _0x48f623=_0x405767[_0x3ec53f(0x799)][_0x405767['activeChatId']];if(_0x309580){const _0x34d81d=_0x48f623[_0x3ec53f(0x635)][_0x3ec53f(0x2ef)](_0x2aa5ae=>_0x2aa5ae['id']===_0x4c8670);_0x34d81d&&(_0x34d81d[_0x3ec53f(0xe78)]=_0x4c9544['my']);}else _0x48f623['settings'][_0x3ec53f(0x1b1)]=_0x4c9544['ai'],_0x48f623[_0x3ec53f(0x33a)][_0x3ec53f(0x538)]=_0x4c9544['my'];await _0x15043e[_0x3ec53f(0x799)]['put'](_0x48f623);if(!_0x309580&&!_0x48f623['isGroup']){const _0x24dd13=_0x48f623['id'];for(const _0x4d067b of Object[_0x3ec53f(0x22f)](_0x405767['chats'])){if(_0x4d067b[_0x3ec53f(0x1000)]&&_0x4d067b[_0x3ec53f(0x635)]){const _0x1ac698=_0x4d067b['members'][_0x3ec53f(0x2ef)](_0x2572d8=>_0x2572d8['id']===_0x24dd13);_0x1ac698&&(_0x1ac698['avatarFrame']=_0x48f623[_0x3ec53f(0x33a)][_0x3ec53f(0x1b1)],await _0x15043e[_0x3ec53f(0x799)][_0x3ec53f(0xfaa)](_0x4d067b),console[_0x3ec53f(0x32b)](_0x3ec53f(0x856)+_0x24dd13+_0x3ec53f(0x573)+_0x4d067b[_0x3ec53f(0x596)]+'\x22'));}}}document[_0x3ec53f(0x8c2)](_0x3ec53f(0x1232))['classList'][_0x3ec53f(0xaff)](_0x3ec53f(0x2cd)),_0x7dbe71(_0x405767[_0x3ec53f(0x248)]),alert('头像框已保存并同步！'),_0x309580=![];}function _0x115ab1(){const _0x355072=_0x18b51e;_0x1ac766=!_0x1ac766;const _0x5f4bad=document[_0x355072(0x8c2)](_0x355072(0x9fe)),_0xb1a585=document['getElementById'](_0x355072(0xf32)),_0x5287ed=document[_0x355072(0x8c2)](_0x355072(0x8b3));document[_0x355072(0xa2d)](_0x355072(0x1282))['forEach'](_0x3ee459=>{const _0x26b527=_0x355072;_0x3ee459[_0x26b527(0xb17)][_0x26b527(0xfc3)](_0x26b527(0xdf2),_0x1ac766);}),_0x1ac766?(_0x5f4bad[_0x355072(0x1090)]='完成',_0xb1a585[_0x355072(0x842)][_0x355072(0x5e9)]=_0x355072(0xd52),_0xe92b02['clear'](),_0x5287ed['checked']=![],_0x876e6f()):(_0x5f4bad[_0x355072(0x1090)]='管理',_0xb1a585['style']['display']=_0x355072(0xbf8),document['querySelectorAll'](_0x355072(0x51f))[_0x355072(0x7c0)](_0x59a0ac=>{const _0xe99d1a=_0x355072;_0x59a0ac[_0xe99d1a(0xb17)]['remove']('selected');}));}function _0x876e6f(){const _0x54a6f1=_0x18b51e,_0x3f531d=document[_0x54a6f1(0x8c2)](_0x54a6f1(0x103a));_0x3f531d[_0x54a6f1(0x1090)]=_0x54a6f1(0xaad)+_0xe92b02[_0x54a6f1(0xf72)]+')';}function _0x5d1592(){const _0x3a6ec3=_0x18b51e,_0x4a5541=document['getElementById'](_0x3a6ec3(0x8b3))[_0x3a6ec3(0x75f)],_0x1ee214=document[_0x3a6ec3(0x1ad)]('.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid');if(!_0x1ee214)return;_0x1ee214[_0x3a6ec3(0xa2d)]('.frame-item:has(.delete-btn)')[_0x3a6ec3(0x7c0)](_0x31602a=>{const _0x4d022a=_0x3a6ec3,_0x242b9a=parseInt(_0x31602a[_0x4d022a(0x1ad)](_0x4d022a(0x6d6))[_0x4d022a(0x323)]['id']);if(isNaN(_0x242b9a))return;_0x31602a['classList']['toggle'](_0x4d022a(0x118f),_0x4a5541),_0x4a5541?_0xe92b02[_0x4d022a(0x3f4)](_0x242b9a):_0xe92b02['delete'](_0x242b9a);}),_0x876e6f();}async function _0x323c26(){const _0x92551f=_0x18b51e;if(_0xe92b02[_0x92551f(0xf72)]===0x0)return;const _0x57b273=await _0x8b9cb8('确认删除',_0x92551f(0x1080)+_0xe92b02[_0x92551f(0xf72)]+'\x20个自定义头像框吗？',{'confirmButtonClass':_0x92551f(0xe2a)});if(_0x57b273){const _0x380a08=[..._0xe92b02];await _0x15043e[_0x92551f(0x103e)][_0x92551f(0x101d)](_0x380a08),_0x115ab1(),_0x515f1c(_0x309580),await _0x501c7b('删除成功',_0x92551f(0xe74));}}function _0x3b4393(_0x469e52){const _0x547650=_0x18b51e,_0xe6b6e8=document[_0x547650(0x8c2)](_0x547650(0x3d0));_0xe6b6e8&&(_0xe6b6e8[_0x547650(0xca0)]=_0x469e52||'');}async function _0x5b5f95(_0x2632ec){const _0x26ab07=_0x18b51e;if(!_0x4a77e1[_0x26ab07(0x6f0)]||!_0x4a77e1['activeChatId'])return;const _0x4c8858=_0x405767[_0x26ab07(0x799)][_0x4a77e1['activeChatId']];if(!_0x4c8858)return;const _0xa6816d=_0x4c8858['isGroup']?_0x4c8858['settings'][_0x26ab07(0xe16)]||'我':'我',_0x4a2f48='[系统提示：用户\x20('+_0xa6816d+')\x20'+_0x2632ec+']',_0x35f09a={'role':'system','content':_0x4a2f48,'timestamp':Date[_0x26ab07(0x1ed)](),'isHidden':!![]};_0x4c8858['history'][_0x26ab07(0xa49)](_0x35f09a),await _0x15043e['chats']['put'](_0x4c8858);}async function _0x2bcfad(){const _0x12979e=_0x18b51e;if(_0x13ef23[_0x12979e(0xf72)]===0x0)return;const _0x4d0fd2=_0x405767['chats'][_0x405767[_0x12979e(0x248)]];if(!_0x4d0fd2)return;const _0x1b413f=document[_0x12979e(0x8c2)](_0x12979e(0xdd9)),_0xf9bc6f=_0x1b413f[_0x12979e(0x1090)];_0x1b413f[_0x12979e(0x1090)]=_0x12979e(0x11a7),_0x1b413f[_0x12979e(0x1033)]=!![];const _0x57f31c=document[_0x12979e(0x8c1)](_0x12979e(0x1072)),_0x1f53db=document[_0x12979e(0x8c2)](_0x12979e(0x5e7));_0x57f31c[_0x12979e(0x842)][_0x12979e(0x578)]=_0x1f53db['offsetWidth']+'px',_0x57f31c[_0x12979e(0x842)][_0x12979e(0x364)]='absolute',_0x57f31c[_0x12979e(0x842)][_0x12979e(0x9a4)]=_0x12979e(0x1ef),_0x57f31c['style']['left']=_0x12979e(0x1ef),_0x57f31c[_0x12979e(0x842)][_0x12979e(0x5e9)]='flex',_0x57f31c['style'][_0x12979e(0xcec)]='column',_0x57f31c['style'][_0x12979e(0xba8)]=_0x12979e(0x541);const _0x5f0794=document[_0x12979e(0x8c2)](_0x12979e(0xd5c));_0x57f31c[_0x12979e(0x842)][_0x12979e(0xfff)]=_0x5f0794[_0x12979e(0x842)][_0x12979e(0xfff)],_0x57f31c['style']['backgroundColor']=_0x5f0794[_0x12979e(0x842)][_0x12979e(0x617)]||(document['getElementById'](_0x12979e(0x5e7))[_0x12979e(0xb17)][_0x12979e(0x795)](_0x12979e(0x8e7))?_0x12979e(0x576):_0x12979e(0x959));const _0x5b5dff=document['createElement'](_0x12979e(0x842));_0x5b5dff[_0x12979e(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x12979e(0x1e0)][_0x12979e(0x31e)](_0x5b5dff);try{const _0xc6d2d2=_0x5f0794['querySelector']('.header')[_0x12979e(0xac5)](!![]);_0xc6d2d2[_0x12979e(0xb17)][_0x12979e(0x3f4)]('cloned-header');const _0x5f568e=document['createElement']('div'),_0x3bf9d1=document['getElementById'](_0x12979e(0xb24));_0x5f568e[_0x12979e(0x842)][_0x12979e(0x5e9)]='flex',_0x5f568e[_0x12979e(0x842)]['flexDirection']=_0x12979e(0x1101),_0x5f568e['style'][_0x12979e(0xbc2)]=_0x12979e(0x290),_0x5f568e[_0x12979e(0x842)][_0x12979e(0x23a)]='10px\x2015px\x2020px\x2015px',_0x5f568e[_0x12979e(0x842)][_0x12979e(0x578)]=_0x12979e(0xbd9),_0x5f568e['style'][_0x12979e(0x3f6)]='border-box',_0x5f568e['dataset'][_0x12979e(0xf95)]=_0x3bf9d1[_0x12979e(0x323)][_0x12979e(0xf95)],_0x5f568e[_0x12979e(0x842)][_0x12979e(0xbe0)]('--chat-font-size',_0x3bf9d1[_0x12979e(0x842)][_0x12979e(0xb1e)](_0x12979e(0x1217)));const _0x4440b0=_0x5f0794[_0x12979e(0x1ad)]('#chat-input-area')['cloneNode'](!![]),_0x254cfd=[..._0x13ef23][_0x12979e(0xa19)]((_0x1fd604,_0xdfacbb)=>_0x1fd604-_0xdfacbb);_0x254cfd['forEach'](_0x2a8570=>{const _0x157c58=_0x12979e,_0x44de0b=document[_0x157c58(0x1ad)]('.message-bubble[data-timestamp=\x22'+_0x2a8570+'\x22]');if(_0x44de0b){const _0x2f8f17=_0x44de0b[_0x157c58(0xa90)]('.message-wrapper');_0x2f8f17&&_0x5f568e['appendChild'](_0x2f8f17['cloneNode'](!![]));}}),_0x57f31c[_0x12979e(0x31e)](_0xc6d2d2),_0x57f31c[_0x12979e(0x31e)](_0x5f568e),_0x57f31c[_0x12979e(0x31e)](_0x4440b0),document[_0x12979e(0x540)][_0x12979e(0x31e)](_0x57f31c);const _0x39f2f2=Array[_0x12979e(0x51a)](_0x57f31c[_0x12979e(0x6fb)]('img')),_0x19b19f=_0x39f2f2['map'](_0x4960bf=>new Promise((_0x18346b,_0x2b0cf1)=>{const _0x41d3d7=_0x12979e;if(_0x4960bf['src'][_0x41d3d7(0xc7c)](_0x41d3d7(0x3a5))){_0x18346b();return;}const _0x4c8662=new Image();_0x4c8662[_0x41d3d7(0x1006)]='anonymous',_0x4c8662[_0x41d3d7(0xe7a)]=_0x18346b,_0x4c8662[_0x41d3d7(0x10bb)]=_0x18346b,_0x4c8662[_0x41d3d7(0x939)]=_0x4960bf[_0x41d3d7(0x939)];}));await Promise[_0x12979e(0xe88)](_0x19b19f);const _0x4b6bf1=await html2canvas(_0x57f31c,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window[_0x12979e(0x1147)]||0x2});_0x4b6bf1['toBlob'](function(_0xdc7869){const _0x188963=_0x12979e,_0x156da8=URL[_0x188963(0x90b)](_0xdc7869),_0x5afbb0=document[_0x188963(0x8c1)]('a');_0x5afbb0['download']=_0x188963(0x2b3)+_0x4d0fd2['name']+'-'+Date['now']()+'.png',_0x5afbb0['href']=_0x156da8,document['body']['appendChild'](_0x5afbb0),_0x5afbb0[_0x188963(0xa17)](),document[_0x188963(0x540)][_0x188963(0x251)](_0x5afbb0),URL[_0x188963(0xb0a)](_0x156da8);},_0x12979e(0xea6));}catch(_0x5b5cdc){console[_0x12979e(0x7a3)](_0x12979e(0xa01),_0x5b5cdc),await _0x501c7b(_0x12979e(0x40b),'生成截图时发生错误，请检查控制台获取详情。');}finally{document['body'][_0x12979e(0x251)](_0x57f31c),document[_0x12979e(0x1e0)][_0x12979e(0x251)](_0x5b5dff),_0x1b413f[_0x12979e(0x1090)]=_0xf9bc6f,_0x1b413f[_0x12979e(0x1033)]=![],_0x23ba0c();}}function _0x16059c(_0xdeea69){const _0x5ba4f5=_0x18b51e;if(!_0xdeea69||typeof _0xdeea69!==_0x5ba4f5(0xf1b))return'';return _0xdeea69=_0xdeea69[_0x5ba4f5(0x1b7)](/!h\{(.*?)\}/g,_0x5ba4f5(0xf56)),_0xdeea69=_0xdeea69[_0x5ba4f5(0x1b7)](/!u\{(.*?)\}/g,_0x5ba4f5(0xaf5)),_0xdeea69=_0xdeea69[_0x5ba4f5(0x1b7)](/!e\{(.*?)\}/g,_0x5ba4f5(0xe07)),_0xdeea69=_0xdeea69[_0x5ba4f5(0x1b7)](/!w\{(.*?)\}/g,_0x5ba4f5(0x56a)),_0xdeea69=_0xdeea69[_0x5ba4f5(0x1b7)](/!m\{(.*?)\}/g,'<span\x20class=\x22diary-messy\x22>$1</span>'),_0xdeea69=_0xdeea69[_0x5ba4f5(0x1b7)](/\|\|(.*?)\|\|/g,_0x5ba4f5(0xe59)),_0xdeea69=_0xdeea69[_0x5ba4f5(0x1b7)](/\*\*(.*?)\*\*/g,'<strong>$1</strong>'),_0xdeea69=_0xdeea69['replace'](/\~\~(.*?)\~\~/g,_0x5ba4f5(0x4f0)),_0xdeea69=_0xdeea69[_0x5ba4f5(0x1b7)](/\*(.*?)\*/g,_0x5ba4f5(0x9ee)),_0xdeea69;}async function _0x519cf5(){const _0x67f7ed=_0x18b51e;console[_0x67f7ed(0x32b)](_0x67f7ed(0x10bd));let _0x447f94=0x0;const _0x5964fd=Object[_0x67f7ed(0x22f)](_0x405767[_0x67f7ed(0x799)]);for(const _0x51f2ff of _0x5964fd){let _0xb29a05=![];for(const _0x383563 of _0x51f2ff[_0x67f7ed(0xd39)]){_0x383563['type']==='red_packet'&&_0x383563[_0x67f7ed(0x46b)]===_0x67f7ed(0x35c)&&_0x383563['role']===_0x67f7ed(0x458)&&_0x383563[_0x67f7ed(0x510)](_0x67f7ed(0x560))&&!_0x383563[_0x67f7ed(0x510)](_0x67f7ed(0xcf7))&&(_0x383563['receiverName']=_0x383563[_0x67f7ed(0x560)],delete _0x383563[_0x67f7ed(0x560)],_0xb29a05=!![],_0x447f94++);}_0xb29a05&&(console['log'](_0x67f7ed(0xb7a)+_0x51f2ff[_0x67f7ed(0x596)]+'\x22\x20中发现并修复了旧红包数据。'),await _0x15043e[_0x67f7ed(0x799)]['put'](_0x51f2ff));}_0x447f94>0x0?(console[_0x67f7ed(0x32b)](_0x67f7ed(0x500)+_0x447f94+_0x67f7ed(0x1191)),alert(_0x67f7ed(0x2eb)+_0x447f94+_0x67f7ed(0x869)),location[_0x67f7ed(0x110a)]()):console[_0x67f7ed(0x32b)]('未发现需要迁移的旧红包数据。');}function _0x40eb65(_0x1298c9){const _0x564a80=_0x18b51e,_0x131c71=_0x405767[_0x564a80(0x799)][_0x1298c9];if(!_0x131c71||_0x131c71[_0x564a80(0x1000)])return;document[_0x564a80(0x8c2)]('profile-heartfelt-voice')['textContent']=_0x131c71['heartfeltVoice']||'...',document['getElementById']('profile-random-jottings')[_0x564a80(0x1090)]=_0x131c71[_0x564a80(0x103c)]||_0x564a80(0x388);const _0x5a4a85=document[_0x564a80(0x8c2)](_0x564a80(0x59e));_0x5a4a85['classList'][_0x564a80(0x3f4)](_0x564a80(0x2cd));}function _0x34b0ba(){const _0x4c27e3=_0x18b51e;document[_0x4c27e3(0x8c2)](_0x4c27e3(0xb23))[_0x4c27e3(0x842)][_0x4c27e3(0x5e9)]=_0x4c27e3(0xbf8),document['getElementById'](_0x4c27e3(0xc62))['style'][_0x4c27e3(0x5e9)]=_0x4c27e3(0xd52),_0x1a6bfa();}function _0x689d3(){const _0x40dc00=_0x18b51e;document[_0x40dc00(0x8c2)](_0x40dc00(0xc62))['style'][_0x40dc00(0x5e9)]=_0x40dc00(0xbf8),document[_0x40dc00(0x8c2)](_0x40dc00(0xb23))[_0x40dc00(0x842)][_0x40dc00(0x5e9)]=_0x40dc00(0xd52);}function _0x1a6bfa(){const _0x19c2fe=_0x18b51e,_0x367ed5=document[_0x19c2fe(0x8c2)](_0x19c2fe(0x125d)),_0xa9c130=_0x405767[_0x19c2fe(0x799)][_0x405767[_0x19c2fe(0x248)]];_0x367ed5['innerHTML']='';if(!_0xa9c130||!_0xa9c130[_0x19c2fe(0x120b)]||_0xa9c130['thoughtsHistory'][_0x19c2fe(0x105a)]===0x0){_0x367ed5['innerHTML']=_0x19c2fe(0x421);return;}const _0x52842c=[..._0xa9c130[_0x19c2fe(0x120b)]][_0x19c2fe(0x1c0)](),_0x329126=_0x52842c[_0x19c2fe(0x961)](0x0,_0x3e233a);_0x329126[_0x19c2fe(0x7c0)](_0x166b87=>{const _0x56c6ac=_0x19c2fe,_0x3c9ac6=_0x3feb68(_0x166b87);_0x367ed5[_0x56c6ac(0x31e)](_0x3c9ac6);}),_0x4099a9=_0x329126['length'],_0x52842c['length']>_0x4099a9&&appendLoadMoreThoughtsButton(_0x367ed5);}async function _0x1dd5af(){const _0x3df530=_0x18b51e;if(_0xfd5f49)return;_0xfd5f49=!![];const _0x144a1c=document['getElementById'](_0x3df530(0x125d)),_0x5bceab=_0x405767['chats'][_0x405767[_0x3df530(0x248)]];if(!_0x5bceab){_0xfd5f49=![];return;}_0x21c28a(_0x144a1c,_0x3df530(0xf2b)),await new Promise(_0x6ac3f6=>setTimeout(_0x6ac3f6,0x1f4));const _0x3e4f87=[..._0x5bceab[_0x3df530(0x120b)]][_0x3df530(0x1c0)](),_0x1dbd7c=_0x3e4f87[_0x3df530(0x105a)],_0xde3d92=_0x4099a9,_0x4265a5=_0x4099a9+_0x3e233a,_0x554f65=_0x3e4f87[_0x3df530(0x961)](_0xde3d92,_0x4265a5);_0x45f5dc(_0x144a1c),_0x554f65['forEach'](_0x27412e=>{const _0x548954=_0x3df530,_0x46d7c9=_0x3feb68(_0x27412e);_0x144a1c[_0x548954(0x31e)](_0x46d7c9);}),_0x4099a9+=_0x554f65['length'],_0xfd5f49=![];}function _0x3feb68(_0x87afaa){const _0x446772=_0x18b51e,_0x13e4f0=document[_0x446772(0x8c1)](_0x446772(0x1072));_0x13e4f0[_0x446772(0x84c)]=_0x446772(0xf54);const _0x4067d9=new Date(_0x87afaa[_0x446772(0x351)]),_0x51b6d6=_0x4067d9['getFullYear']()+'-'+String(_0x4067d9[_0x446772(0xc3c)]()+0x1)[_0x446772(0xc89)](0x2,'0')+'-'+String(_0x4067d9[_0x446772(0xca8)]())[_0x446772(0xc89)](0x2,'0')+'\x20'+String(_0x4067d9['getHours']())[_0x446772(0xc89)](0x2,'0')+':'+String(_0x4067d9[_0x446772(0xbdd)]())[_0x446772(0xc89)](0x2,'0');return _0x13e4f0[_0x446772(0xca0)]=_0x446772(0xd4e)+_0x87afaa[_0x446772(0x351)]+'\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>'+_0x51b6d6+_0x446772(0xc77)+_0x87afaa[_0x446772(0x211)]+_0x446772(0x303)+_0x87afaa['randomJottings']+_0x446772(0xb82),_0x13e4f0;}async function _0x126837(_0x47210f){const _0x38bd4d=_0x18b51e,_0x2cee58=_0x47210f[_0x38bd4d(0x475)][_0x38bd4d(0xde8)][0x0];if(!_0x2cee58)return;try{let _0x10ab71,_0x12a532=null;if(_0x2cee58['name'][_0x38bd4d(0x866)](_0x38bd4d(0x10d8))){const _0x337574=await _0x2cee58[_0x38bd4d(0xbc6)]();_0x10ab71=JSON['parse'](_0x337574);}else{if(_0x2cee58[_0x38bd4d(0x596)]['endsWith'](_0x38bd4d(0xce4))){const _0x1cc850=await _0x2cee58[_0x38bd4d(0x80b)]();_0x10ab71=await _0xa7b96(_0x1cc850),_0x12a532=await new Promise(_0x35a0d4=>{const _0x1712a5=_0x38bd4d,_0x35df7e=new FileReader();_0x35df7e[_0x1712a5(0xe7a)]=()=>_0x35a0d4(_0x35df7e['result']),_0x35df7e[_0x1712a5(0x779)](_0x2cee58);});}else throw new Error(_0x38bd4d(0xe68));}await _0x20159c(_0x10ab71,_0x12a532);}catch(_0x463d91){console[_0x38bd4d(0x7a3)](_0x38bd4d(0xc34),_0x463d91),await _0x501c7b(_0x38bd4d(0x8e8),'无法解析角色卡文件。\x0a错误:\x20'+_0x463d91[_0x38bd4d(0xc7d)]);}finally{_0x47210f[_0x38bd4d(0x475)][_0x38bd4d(0x518)]=null;}}function _0xa7b96(_0x9c52e3){return new Promise((_0xe636e0,_0x55c82c)=>{const _0x57420c=_0x7a65,_0x36bc67=new DataView(_0x9c52e3);if(_0x36bc67[_0x57420c(0xea8)](0x0)!==0x89504e47||_0x36bc67[_0x57420c(0xea8)](0x4)!==0xd0a1a0a)return _0x55c82c(new Error(_0x57420c(0x53b)));let _0x7dc6b0=0x8;const _0x251b87=new TextDecoder();while(_0x7dc6b0<_0x36bc67['byteLength']){const _0x1f5c17=_0x36bc67[_0x57420c(0xea8)](_0x7dc6b0),_0x91f98d=_0x251b87['decode'](_0x9c52e3[_0x57420c(0x961)](_0x7dc6b0+0x4,_0x7dc6b0+0x8));if(_0x91f98d===_0x57420c(0xd80)){const _0x1d3697=new Uint8Array(_0x9c52e3,_0x7dc6b0+0x8,_0x1f5c17),_0x50f630=_0x1d3697[_0x57420c(0xbf2)](0x0);if(_0x50f630!==-0x1){const _0xa14c5c=_0x251b87[_0x57420c(0x860)](_0x1d3697['slice'](0x0,_0x50f630));if(_0xa14c5c===_0x57420c(0x71a)){const _0x2e89f9=_0x251b87['decode'](_0x1d3697[_0x57420c(0x961)](_0x50f630+0x1));try{const _0x12f621=atob(_0x2e89f9),_0x3401ec=new Uint8Array(_0x12f621[_0x57420c(0x105a)]);for(let _0x55a307=0x0;_0x55a307<_0x12f621[_0x57420c(0x105a)];_0x55a307++){_0x3401ec[_0x55a307]=_0x12f621['charCodeAt'](_0x55a307);}const _0xf00a00=new TextDecoder(_0x57420c(0xea4))[_0x57420c(0x860)](_0x3401ec);_0xe636e0(JSON[_0x57420c(0x10ab)](_0xf00a00));return;}catch(_0x2ad572){return _0x55c82c(new Error(_0x57420c(0x8b4)+_0x2ad572[_0x57420c(0xc7d)]));}}}}_0x7dc6b0+=0x4+0x4+_0x1f5c17+0x4;}_0x55c82c(new Error(_0x57420c(0x5a4)));});}function _0x327cf2(_0x42ffe9){const _0x4dd9e0=_0x18b51e;if(_0x42ffe9[_0x4dd9e0(0x49a)]?.[_0x4dd9e0(0x89b)]?.['entries']?.['length']>0x0)return console[_0x4dd9e0(0x32b)](_0x4dd9e0(0x288)),_0x42ffe9['data'][_0x4dd9e0(0x89b)][_0x4dd9e0(0x6ff)];if(_0x42ffe9[_0x4dd9e0(0x976)]?.[_0x4dd9e0(0x89b)]?.[_0x4dd9e0(0x6ff)]?.[_0x4dd9e0(0x105a)]>0x0)return console['log'](_0x4dd9e0(0x59b)),_0x42ffe9[_0x4dd9e0(0x976)][_0x4dd9e0(0x89b)]['entries'];if(_0x42ffe9[_0x4dd9e0(0x49a)]?.[_0x4dd9e0(0x976)]?.[_0x4dd9e0(0x89b)]?.[_0x4dd9e0(0x6ff)]?.[_0x4dd9e0(0x105a)]>0x0)return console[_0x4dd9e0(0x32b)](_0x4dd9e0(0x11cb)),_0x42ffe9[_0x4dd9e0(0x49a)][_0x4dd9e0(0x976)][_0x4dd9e0(0x89b)][_0x4dd9e0(0x6ff)];const _0x34ce48=[_0x4dd9e0(0x89b),_0x4dd9e0(0x910),_0x4dd9e0(0xf3a),_0x4dd9e0(0xf50)];for(const _0x5cce39 of _0x34ce48){if(_0x42ffe9[_0x5cce39]?.[_0x4dd9e0(0x6ff)]?.[_0x4dd9e0(0x105a)]>0x0)return console[_0x4dd9e0(0x32b)](_0x4dd9e0(0x9b0)+_0x5cce39+_0x4dd9e0(0x1137)),_0x42ffe9[_0x5cce39][_0x4dd9e0(0x6ff)];}return console['log']('诊断：未在此角色卡中找到任何有效的世界书数据。'),null;}async function _0x20159c(_0x4932f7,_0x3cf7f8=null){const _0x66595=_0x18b51e,_0x500506=_0x4932f7[_0x66595(0x49a)]||_0x4932f7;if(!_0x500506['name'])throw new Error(_0x66595(0xa05));let _0x4b20f4=null;const _0x3dc711=_0x327cf2(_0x4932f7);if(_0x3dc711){const _0x2876aa=_0x3dc711[_0x66595(0x1d8)](_0x2ca4df=>_0x2ca4df['enabled']&&_0x2ca4df[_0x66595(0x168)])[_0x66595(0x6b9)](_0x50391d=>({'keys':_0x50391d['keys']||[],'comment':_0x50391d['comment']||'','content':_0x50391d['content'][_0x66595(0x1b7)](/<memory>|<\/memory>/g,'')['trim']()}));if(_0x2876aa[_0x66595(0x105a)]>0x0){const _0x17aaeb={'id':'wb_'+Date[_0x66595(0x1ed)](),'name':_0x500506[_0x66595(0x596)]+_0x66595(0x11b1),'content':_0x2876aa,'categoryId':null};await _0x15043e[_0x66595(0x40e)]['add'](_0x17aaeb),_0x405767['worldBooks'][_0x66595(0xa49)](_0x17aaeb),_0x4b20f4=_0x17aaeb['id'];}}let _0x42fea7=_0x500506[_0x66595(0x3ca)]||_0x4932f7['description']||'无';_0x42fea7=_0x42fea7[_0x66595(0x1b7)](/```yaml/g,'')[_0x66595(0x1b7)](/```/g,'')[_0x66595(0x1b7)](/<\/?info>/g,'')[_0x66595(0x1b7)](/<\/?character>/g,'')[_0x66595(0x1b7)](/<\/?writing_rule>/g,'')[_0x66595(0x1b7)](/\[OOC：.*?\]/g,'')[_0x66595(0x8c6)]();let _0x2506ac=_0x66595(0xd8c)+_0x42fea7+'\x0a\x0a';if(_0x500506[_0x66595(0xdbb)])_0x2506ac+=_0x66595(0x747)+_0x500506[_0x66595(0xdbb)]+'\x0a\x0a';if(_0x500506['scenario'])_0x2506ac+=_0x66595(0x6e3)+_0x500506[_0x66595(0xf1d)]+'\x0a\x0a';if(_0x500506['mes_example'])_0x2506ac+=_0x66595(0x58c)+_0x500506[_0x66595(0x17f)]+'\x0a\x0a';const _0x1da845=_0x500506[_0x66595(0x596)],_0x47c042=_0x500506[_0x66595(0x596)],_0x13f5dc=_0x66595(0xaf3)+Date[_0x66595(0x1ed)](),_0x34273e={'id':_0x13f5dc,'name':_0x1da845[_0x66595(0x8c6)](),'originalName':_0x47c042[_0x66595(0x8c6)](),'isGroup':![],'relationship':{'status':_0x66595(0xaa7)},'status':{'text':'在线','lastUpdate':Date['now'](),'isBusy':![]},'settings':{'aiPersona':_0x2506ac,'myPersona':_0x66595(0xdfa),'maxMemory':0xa,'aiAvatar':_0x49d2a4,'myAvatar':_0x49d2a4,'background':'','theme':_0x66595(0x674),'fontSize':0xd,'customCss':'','linkedWorldBookIds':_0x4b20f4?[_0x4b20f4]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0x3cf7f8&&(_0x34273e[_0x66595(0x33a)]['aiAvatar']=_0x3cf7f8,_0x34273e[_0x66595(0x33a)][_0x66595(0xca4)][_0x66595(0xa49)]({'name':_0x66595(0x93d),'url':_0x3cf7f8}));const _0x5e6387=_0x500506[_0x66595(0x106f)]||_0x4932f7['first_mes'];if(_0x5e6387&&typeof _0x5e6387==='string'){const _0x1aef0f=document[_0x66595(0x8c1)](_0x66595(0x1072));_0x1aef0f['innerHTML']=_0x5e6387;const _0x35f842=(_0x1aef0f['textContent']||_0x1aef0f[_0x66595(0x411)]||'')[_0x66595(0x1b7)](/原作者UR.*?开局/s,'')['trim']();_0x35f842&&_0x34273e['history'][_0x66595(0xa49)]({'role':_0x66595(0x458),'senderName':_0x34273e[_0x66595(0x4e7)],'content':_0x35f842,'timestamp':Date[_0x66595(0x1ed)]()});}_0x405767['chats'][_0x13f5dc]=_0x34273e,await _0x15043e[_0x66595(0x799)][_0x66595(0xfaa)](_0x34273e),_0x2b55d1();let _0x639fe0=_0x66595(0x530)+_0x34273e[_0x66595(0x596)]+_0x66595(0xa39);_0x4b20f4&&(_0x639fe0+=_0x66595(0xc1f)),await _0x501c7b(_0x66595(0x336),_0x639fe0);}async function _0x912db8(){const _0x4ec915=_0x18b51e;if(!_0x405767[_0x4ec915(0x248)])return;const _0x4c749a=_0x405767['chats'][_0x405767[_0x4ec915(0x248)]],_0x3ac55d=_0x4c749a[_0x4ec915(0x33a)][_0x4ec915(0xace)];if(!_0x3ac55d||_0x3ac55d[_0x4ec915(0x105a)]===0x0){alert(_0x4ec915(0xf62));return;}const _0xebdb33=_0x3ac55d['map']((_0xecb13d,_0x4ecd5a)=>{const _0x1efe79=_0x4ec915,_0x52681a=_0xecb13d[_0x1efe79(0x1b7)](/<[^>]*>/g,'')[_0x1efe79(0x8c6)]()[_0x1efe79(0x599)](0x0,0x14);return{'text':_0x1efe79(0x71c)+(_0x4ecd5a+0x1)+':\x20'+_0x52681a+_0x1efe79(0x388),'value':_0x4ecd5a};}),_0x3f4963=await _0x40fef8(_0x4ec915(0xa3d),_0xebdb33);if(_0x3f4963!==null){const _0x4a7ac6=await _0x8b9cb8(_0x4ec915(0x65a),_0x4ec915(0x1242),{'confirmButtonClass':'btn-danger','confirmText':_0x4ec915(0x734)});if(_0x4a7ac6){const _0x25a359=_0x3ac55d[_0x3f4963],_0x16c13b={'role':_0x4ec915(0x458),'senderName':_0x4c749a[_0x4ec915(0x4e7)],'content':_0x25a359,'timestamp':Date[_0x4ec915(0x1ed)]()};_0x4c749a['history']=[_0x16c13b],await _0x15043e['chats']['put'](_0x4c749a),_0x7dbe71(_0x4c749a['id']),document[_0x4ec915(0x8c2)](_0x4ec915(0x146))[_0x4ec915(0xb17)][_0x4ec915(0xaff)](_0x4ec915(0x2cd)),await _0x501c7b('成功','已切换到新的开场故事！');}}}function _0x18faa4(_0x275d7b={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x239a3c=_0x18b51e,_0x449839=document[_0x239a3c(0x8c1)](_0x239a3c(0x1072));_0x449839[_0x239a3c(0x84c)]=_0x239a3c(0x122b);const _0xf779fa=_0x275d7b[_0x239a3c(0x69a)]!==![]?_0x239a3c(0x75f):'';return _0x449839['innerHTML']=_0x239a3c(0x392)+_0xf779fa+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22'+(_0x275d7b[_0x239a3c(0x120a)]||'')+_0x239a3c(0x908)+(_0x275d7b['keys']||[])[_0x239a3c(0xb2c)](',\x20')+_0x239a3c(0x6e4)+(_0x275d7b['content']||'')+_0x239a3c(0x42e),_0x449839[_0x239a3c(0x1ad)](_0x239a3c(0xedb))[_0x239a3c(0xae8)](_0x239a3c(0xa17),()=>{const _0x2ba39f=_0x239a3c;_0x449839[_0x2ba39f(0xaff)]();}),_0x449839;}async function _0x235f7d(){const _0x4d8c5c=_0x18b51e;if(!_0x405767['activeChatId'])return;const _0x20edc6=_0x405767['activeChatId'],_0x306a3b=document[_0x4d8c5c(0x8c2)](_0x4d8c5c(0x6e1));if(!_0x306a3b[_0x4d8c5c(0xb17)][_0x4d8c5c(0x795)](_0x4d8c5c(0x2cd))){const _0x1826cc=document[_0x4d8c5c(0x1ad)]('#chat-interface-screen\x20>\x20.header');_0x306a3b[_0x4d8c5c(0x842)][_0x4d8c5c(0x9a4)]=_0x1826cc[_0x4d8c5c(0x633)]+'px',_0x306a3b[_0x4d8c5c(0x842)][_0x4d8c5c(0x5e9)]=_0x4d8c5c(0xea7),(!_0x5d05df[_0x20edc6]||!_0x5d05df[_0x20edc6]['isActive'])&&_0x4df63d(_0x20edc6),_0x210865(_0x20edc6),setTimeout(async()=>{const _0x368d71=_0x4d8c5c;_0x306a3b['classList'][_0x368d71(0x3f4)](_0x368d71(0x2cd));const _0x3eaa19={'role':_0x368d71(0x46c),'content':_0x368d71(0x733),'timestamp':Date[_0x368d71(0x1ed)](),'isHidden':!![]};_0x405767[_0x368d71(0x799)][_0x20edc6][_0x368d71(0xd39)][_0x368d71(0xa49)](_0x3eaa19),await _0x15043e[_0x368d71(0x799)]['put'](_0x405767[_0x368d71(0x799)][_0x20edc6]);},0xa);}else await _0x4391ab();}async function _0x4391ab(){const _0x2aaf31=_0x18b51e;if(!_0x405767['activeChatId'])return;const _0x543514=_0x405767[_0x2aaf31(0x248)],_0x391874=document[_0x2aaf31(0x8c2)](_0x2aaf31(0x6e1));_0x391874[_0x2aaf31(0xb17)][_0x2aaf31(0xaff)](_0x2aaf31(0x2cd)),setTimeout(()=>{const _0x3dd257=_0x2aaf31;_0x391874[_0x3dd257(0x842)][_0x3dd257(0x5e9)]=_0x3dd257(0xbf8);},0x12c);if(_0x5d05df[_0x543514]){_0x5d05df[_0x543514][_0x2aaf31(0x6f0)]=![];const _0x551a81={'role':_0x2aaf31(0x46c),'content':_0x2aaf31(0xdfd),'timestamp':Date['now'](),'isHidden':!![]};_0x405767[_0x2aaf31(0x799)][_0x543514][_0x2aaf31(0xd39)][_0x2aaf31(0xa49)](_0x551a81),await _0x15043e[_0x2aaf31(0x799)]['put'](_0x405767[_0x2aaf31(0x799)][_0x543514]);}}function _0x4df63d(_0x1b8d41){const _0x422214=_0x18b51e,_0x218ab9=document[_0x422214(0x8c2)]('gomoku-board'),_0x1b9c74=document[_0x422214(0x8c2)](_0x422214(0x6e1)),_0x59c730=document[_0x422214(0x8c2)]('gomoku-controls'),_0xd06a91=_0x1b9c74['offsetWidth']-0x28,_0x21dd1e=_0x1b9c74[_0x422214(0x633)]-_0x59c730[_0x422214(0x633)]-0x28,_0x51be56=Math['floor'](Math[_0x422214(0x10ff)](_0xd06a91,_0x21dd1e)),_0x4cc185=0xf,_0x319191=Math['floor'](_0x51be56/_0x4cc185),_0x28179b=_0x319191*_0x4cc185;_0x218ab9[_0x422214(0x578)]=_0x28179b,_0x218ab9[_0x422214(0xba8)]=_0x28179b,_0x5d05df[_0x1b8d41]={'isActive':!![],'board':Array(_0x4cc185)[_0x422214(0xdc1)](0x0)[_0x422214(0x6b9)](()=>Array(_0x4cc185)[_0x422214(0xdc1)](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0x4cc185,'CELL_SIZE':_0x319191};}function _0x210865(_0x3e2b43){const _0x2d7449=_0x18b51e,_0x405c9e=_0x5d05df[_0x3e2b43];if(!_0x405c9e)return;const _0x279f54=document[_0x2d7449(0x8c2)](_0x2d7449(0x54b)),_0xf7734e=_0x279f54['getContext']('2d'),{GRID_SIZE:_0x4ce1fa,CELL_SIZE:_0x2c9651}=_0x405c9e,_0x3ab012=_0x2c9651/0x2;_0xf7734e[_0x2d7449(0xf86)](0x0,0x0,_0x279f54[_0x2d7449(0x578)],_0x279f54[_0x2d7449(0xba8)]),_0xf7734e['fillStyle']=_0x2d7449(0xeef),_0xf7734e['fillRect'](0x0,0x0,_0x279f54[_0x2d7449(0x578)],_0x279f54[_0x2d7449(0xba8)]),_0xf7734e['strokeStyle']='#5b3a29',_0xf7734e['lineWidth']=0x1;for(let _0x2beb39=0x0;_0x2beb39<_0x4ce1fa;_0x2beb39++){_0xf7734e[_0x2d7449(0x462)](),_0xf7734e[_0x2d7449(0x7e6)](_0x3ab012,_0x3ab012+_0x2beb39*_0x2c9651),_0xf7734e[_0x2d7449(0xe62)](_0x279f54['width']-_0x3ab012,_0x3ab012+_0x2beb39*_0x2c9651),_0xf7734e[_0x2d7449(0xc37)](),_0xf7734e['beginPath'](),_0xf7734e['moveTo'](_0x3ab012+_0x2beb39*_0x2c9651,_0x3ab012),_0xf7734e[_0x2d7449(0xe62)](_0x3ab012+_0x2beb39*_0x2c9651,_0x279f54[_0x2d7449(0xba8)]-_0x3ab012),_0xf7734e[_0x2d7449(0xc37)]();}for(let _0x46dbdc=0x0;_0x46dbdc<_0x4ce1fa;_0x46dbdc++){for(let _0x10c1f5=0x0;_0x10c1f5<_0x4ce1fa;_0x10c1f5++){_0x405c9e['board'][_0x46dbdc][_0x10c1f5]!==0x0&&_0x5577f3(_0xf7734e,_0x10c1f5,_0x46dbdc,_0x405c9e[_0x2d7449(0x511)][_0x46dbdc][_0x10c1f5],_0x405c9e);}}}function _0x5577f3(_0x284954,_0x31782d,_0x3d12ea,_0x113214,_0x1884f6){const _0xbb61ae=_0x18b51e,{CELL_SIZE:_0x3dc17d}=_0x1884f6,_0x257c7f=_0x3dc17d/0x2,_0x542c8f=_0x3dc17d/0x2-0x2;_0x284954[_0xbb61ae(0x462)](),_0x284954[_0xbb61ae(0xe8b)](_0x257c7f+_0x31782d*_0x3dc17d,_0x257c7f+_0x3d12ea*_0x3dc17d,_0x542c8f,0x0,0x2*Math['PI']),_0x113214===0x1?_0x284954['fillStyle']=_0xbb61ae(0xb59):_0x284954['fillStyle']=_0xbb61ae(0x34d),_0x284954[_0xbb61ae(0xdc1)]();}function _0x9bc2f8(_0x491283){const _0x24b99c=_0x18b51e,_0x2fad13=_0x405767[_0x24b99c(0x248)],_0xe8537d=_0x5d05df[_0x2fad13];if(!_0xe8537d||_0xe8537d['isGameOver']||_0xe8537d[_0x24b99c(0xb2b)]!==0x1)return;const _0x538039=document[_0x24b99c(0x8c2)](_0x24b99c(0x54b)),_0xeeabc8=_0x538039[_0x24b99c(0xebd)]('2d'),_0x18c957=_0x538039['getBoundingClientRect'](),_0x4a3bb3=_0x491283['clientX']-_0x18c957['left'],_0x435f66=_0x491283['clientY']-_0x18c957[_0x24b99c(0x9a4)],_0x54d241=Math[_0x24b99c(0x5d7)]((_0x4a3bb3-_0xe8537d[_0x24b99c(0xd0b)]/0x2)/_0xe8537d[_0x24b99c(0xd0b)]),_0x5a5e1c=Math[_0x24b99c(0x5d7)]((_0x435f66-_0xe8537d[_0x24b99c(0xd0b)]/0x2)/_0xe8537d[_0x24b99c(0xd0b)]);_0x210865(_0x2fad13);if(_0x54d241>=0x0&&_0x54d241<_0xe8537d[_0x24b99c(0xde7)]&&_0x5a5e1c>=0x0&&_0x5a5e1c<_0xe8537d[_0x24b99c(0xde7)]&&_0xe8537d[_0x24b99c(0x511)][_0x5a5e1c][_0x54d241]===0x0){const _0x1b5a2d=_0xe8537d[_0x24b99c(0xd0b)]/0x2-0x2;_0xeeabc8[_0x24b99c(0x462)](),_0xeeabc8[_0x24b99c(0xe8b)](_0xe8537d[_0x24b99c(0xd0b)]/0x2+_0x54d241*_0xe8537d[_0x24b99c(0xd0b)],_0xe8537d[_0x24b99c(0xd0b)]/0x2+_0x5a5e1c*_0xe8537d['CELL_SIZE'],_0x1b5a2d,0x0,0x2*Math['PI']),_0xeeabc8[_0x24b99c(0xf8f)]=_0x24b99c(0x9bd),_0xeeabc8['fill']();}}function _0x570947(_0x3699a3){const _0x1efb2c=_0x18b51e,_0x835546=_0x405767['activeChatId'],_0x51dc0f=_0x5d05df[_0x835546];if(!_0x51dc0f||_0x51dc0f[_0x1efb2c(0x26d)]||_0x51dc0f['currentPlayer']!==0x1)return;const _0x421996=document[_0x1efb2c(0x8c2)](_0x1efb2c(0x54b)),_0x2e700c=_0x421996['getBoundingClientRect'](),_0x1cf9cb=_0x3699a3[_0x1efb2c(0x629)]-_0x2e700c['left'],_0x519fb1=_0x3699a3[_0x1efb2c(0x34b)]-_0x2e700c['top'],_0x29671b=Math[_0x1efb2c(0x5d7)]((_0x1cf9cb-_0x51dc0f['CELL_SIZE']/0x2)/_0x51dc0f[_0x1efb2c(0xd0b)]),_0x130911=Math[_0x1efb2c(0x5d7)]((_0x519fb1-_0x51dc0f[_0x1efb2c(0xd0b)]/0x2)/_0x51dc0f['CELL_SIZE']);_0x29671b>=0x0&&_0x29671b<_0x51dc0f['GRID_SIZE']&&_0x130911>=0x0&&_0x130911<_0x51dc0f[_0x1efb2c(0xde7)]&&_0x51dc0f[_0x1efb2c(0x511)][_0x130911][_0x29671b]===0x0&&(_0x51dc0f[_0x1efb2c(0x511)][_0x130911][_0x29671b]=0x1,_0x51dc0f[_0x1efb2c(0xd39)][_0x1efb2c(0xa49)]({'x':_0x29671b,'y':_0x130911,'player':0x1}),_0x210865(_0x835546),_0x5ddcb7(_0x29671b,_0x130911,0x1,_0x51dc0f)?(_0x51dc0f[_0x1efb2c(0x26d)]=!![],setTimeout(()=>alert('恭喜你，你赢了！'),0x64),_0x3d0a47('user')):_0x51dc0f[_0x1efb2c(0xb2b)]=0x2);}function _0x4a5d9b(_0x7ba991,_0x1f6cbf=![]){const _0x34ef68=_0x18b51e,_0x1d5017=_0x405767['activeChatId'],_0x225d49=_0x5d05df[_0x1d5017];if(!_0x225d49||_0x225d49[_0x34ef68(0x26d)])return;if(!_0x1f6cbf&&_0x225d49['currentPlayer']!==0x2)return;const {x:_0x43dd4c,y:_0x13669e}=_0x7ba991;_0x43dd4c>=0x0&&_0x43dd4c<_0x225d49[_0x34ef68(0xde7)]&&_0x13669e>=0x0&&_0x13669e<_0x225d49[_0x34ef68(0xde7)]&&_0x225d49['board'][_0x13669e][_0x43dd4c]===0x0?(_0x225d49['board'][_0x13669e][_0x43dd4c]=0x2,_0x225d49[_0x34ef68(0xd39)][_0x34ef68(0xa49)]({'x':_0x43dd4c,'y':_0x13669e,'player':0x2}),_0x210865(_0x1d5017),_0x5ddcb7(_0x43dd4c,_0x13669e,0x2,_0x225d49)?(_0x225d49[_0x34ef68(0x26d)]=!![],setTimeout(()=>alert(_0x34ef68(0x42c)),0x64),_0x3d0a47('ai')):_0x225d49[_0x34ef68(0xb2b)]=0x1):(console[_0x34ef68(0x112a)](_0x34ef68(0x77b),_0x7ba991),_0x225d49[_0x34ef68(0xb2b)]=0x1);}function _0x5ddcb7(_0x46db5a,_0x1d23ac,_0x3c0132,_0x1800f7){const {board:_0x2e9537,GRID_SIZE:_0x3366e8}=_0x1800f7,_0x145f7e=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x50ddc5,_0x279b58]of _0x145f7e){let _0x5d2491=0x1;for(let _0x28cedc=0x1;_0x28cedc<0x5;_0x28cedc++){const _0x452f1f=_0x46db5a+_0x28cedc*_0x50ddc5,_0x36c801=_0x1d23ac+_0x28cedc*_0x279b58;if(_0x452f1f>=0x0&&_0x452f1f<_0x3366e8&&_0x36c801>=0x0&&_0x36c801<_0x3366e8&&_0x2e9537[_0x36c801][_0x452f1f]===_0x3c0132)_0x5d2491++;else break;}for(let _0x18b8e3=0x1;_0x18b8e3<0x5;_0x18b8e3++){const _0x128bea=_0x46db5a-_0x18b8e3*_0x50ddc5,_0x326da4=_0x1d23ac-_0x18b8e3*_0x279b58;if(_0x128bea>=0x0&&_0x128bea<_0x3366e8&&_0x326da4>=0x0&&_0x326da4<_0x3366e8&&_0x2e9537[_0x326da4][_0x128bea]===_0x3c0132)_0x5d2491++;else break;}if(_0x5d2491>=0x5)return!![];}return![];}function _0x2de4e7(_0x120e97){const _0x1d040e=_0x18b51e;if(!_0x120e97||!_0x120e97[_0x1d040e(0x6f0)])return'';let _0x150134=_0x1d040e(0xe7c);_0x150134+=_0x120e97['board'][_0x1d040e(0x6b9)](_0x57460e=>_0x57460e['join']('\x20'))[_0x1d040e(0xb2c)]('\x0a');let _0x263ce0=_0x1d040e(0xb4e);return _0x263ce0+=_0x120e97[_0x1d040e(0xd39)][_0x1d040e(0x6b9)](_0x479e34=>'玩家'+_0x479e34['player']+_0x1d040e(0x306)+_0x479e34['x']+','+_0x479e34['y']+')')['join'](_0x1d040e(0xfa4)),_0x1d040e(0x78e)+_0x150134+_0x1d040e(0xc8b)+_0x263ce0+_0x1d040e(0x208);}async function _0x3d0a47(_0x39aa12){const _0x41f620=_0x18b51e,_0x56a6f8=_0x405767[_0x41f620(0x248)],_0x8a666e=_0x405767[_0x41f620(0x799)][_0x56a6f8];if(!_0x8a666e)return;const _0x3ff89e=_0x8a666e[_0x41f620(0x1000)]?_0x8a666e[_0x41f620(0x33a)]['myNickname']||'我':'我',_0x57e2f7=_0x8a666e[_0x41f620(0x1000)]?_0x41f620(0x867):_0x8a666e[_0x41f620(0x596)],_0x1eeac6=_0x39aa12===_0x41f620(0x74b)?_0x3ff89e:_0x57e2f7,_0x3ef492=_0x39aa12==='user'?'你输了':_0x41f620(0x2c8),_0x5161fc=_0x41f620(0x119e)+_0x1eeac6+_0x41f620(0xf21)+_0x3ef492+'。]',_0xc42c52={'role':_0x41f620(0x46c),'content':_0x5161fc,'timestamp':Date[_0x41f620(0x1ed)](),'isHidden':!![]};_0x8a666e[_0x41f620(0xd39)][_0x41f620(0xa49)](_0xc42c52),await _0x15043e[_0x41f620(0x799)][_0x41f620(0xfaa)](_0x8a666e),console[_0x41f620(0x32b)](_0x41f620(0x268)+_0x39aa12);}let _0x399ecc=![];async function _0x34f254(){const _0x41bcb5=_0x18b51e,_0xeae51c=document[_0x41bcb5(0x8c2)](_0x41bcb5(0x7a1)),_0x13dce3=document['getElementById'](_0x41bcb5(0xa96)),_0x47512f=document[_0x41bcb5(0x8c2)](_0x41bcb5(0xbd1));_0xeae51c[_0x41bcb5(0xca0)]='',_0x13dce3[_0x41bcb5(0xca0)]='';const [_0x588d0b,_0x288281]=await Promise[_0x41bcb5(0xe88)]([_0x15043e[_0x41bcb5(0x221)]['toArray'](),_0x15043e['shoppingCategories'][_0x41bcb5(0x731)](_0x41bcb5(0x596))[_0x41bcb5(0x6be)]()]);_0x47512f[_0x41bcb5(0xb17)]['toggle'](_0x41bcb5(0xdf2),_0x399ecc);const _0x4ef6ac=document[_0x41bcb5(0x8c1)](_0x41bcb5(0x19a));_0x4ef6ac[_0x41bcb5(0x84c)]='product-category-tab',_0x4ef6ac[_0x41bcb5(0x1090)]='全部',_0x4ef6ac[_0x41bcb5(0x323)][_0x41bcb5(0x792)]=_0x41bcb5(0xe88);if(activeShoppingCategoryId===_0x41bcb5(0xe88))_0x4ef6ac[_0x41bcb5(0xb17)][_0x41bcb5(0x3f4)]('active');_0x13dce3[_0x41bcb5(0x31e)](_0x4ef6ac),_0x288281[_0x41bcb5(0x7c0)](_0x41c7a2=>{const _0x3d0c91=_0x41bcb5,_0x11f86c=document[_0x3d0c91(0x8c1)]('button');_0x11f86c['className']=_0x3d0c91(0x3a2),_0x11f86c[_0x3d0c91(0x1090)]=_0x41c7a2[_0x3d0c91(0x596)],_0x11f86c['dataset'][_0x3d0c91(0x792)]=_0x41c7a2['id'];if(activeShoppingCategoryId===_0x41c7a2['id'])_0x11f86c[_0x3d0c91(0xb17)]['add'](_0x3d0c91(0x71b));_0x13dce3[_0x3d0c91(0x31e)](_0x11f86c);});let _0x2d151f;activeShoppingCategoryId===_0x41bcb5(0xe88)?_0x2d151f=_0x588d0b:_0x2d151f=_0x588d0b[_0x41bcb5(0x1d8)](_0x47d10d=>_0x47d10d['categoryId']===activeShoppingCategoryId);if(_0x2d151f[_0x41bcb5(0x105a)]===0x0){const _0x335444=activeShoppingCategoryId===_0x41bcb5(0xe88)?_0x41bcb5(0x4c6):_0x41bcb5(0xeee);_0xeae51c['innerHTML']=_0x41bcb5(0x6b1)+_0x335444+_0x41bcb5(0x2e7);return;}_0x2d151f[_0x41bcb5(0x7c0)](_0x42de55=>{const _0x708146=_0x41bcb5,_0x298a14=document['createElement'](_0x708146(0x1072));_0x298a14['className']=_0x708146(0xb8b),_0x298a14[_0x708146(0x323)]['id']=_0x42de55['id'];const _0x4efe1d='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x298a14[_0x708146(0xca0)]=_0x708146(0xb35)+_0x4efe1d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x42de55['imageUrl']+_0x708146(0x9c9)+_0x42de55[_0x708146(0x596)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>'+_0x42de55[_0x708146(0x2ea)][_0x708146(0x3c1)](0x2)+_0x708146(0x28b),_0xeae51c['appendChild'](_0x298a14);});}function _0x5deee6(_0x33062b){activeShoppingCategoryId=_0x33062b,_0x34f254(),_0x19109d();}function _0x19109d(){const _0x3e013c=_0x18b51e,_0x22edbe=document[_0x3e013c(0x8c2)](_0x3e013c(0x1129));if(!_0x22edbe)return;const _0x4feb56=_0x399ecc&&activeShoppingCategoryId!==_0x3e013c(0xe88);_0x22edbe[_0x3e013c(0x842)][_0x3e013c(0x5e9)]=_0x4feb56?'flex':'none';}async function _0x371c37(){const _0x8434aa=_0x18b51e;if(activeShoppingCategoryId===_0x8434aa(0xe88))return;const _0x51fce0=activeShoppingCategoryId,_0xf7d8d9=await _0x15043e[_0x8434aa(0x6ae)][_0x8434aa(0x3e9)](_0x51fce0);if(!_0xf7d8d9){alert(_0x8434aa(0xc81));return;}const _0x3c74ef='确定要永久删除分类\x20“'+_0xf7d8d9[_0x8434aa(0x596)]+_0x8434aa(0x10e8),_0xc9d701=await _0x8b9cb8(_0x8434aa(0xed8),_0x3c74ef,{'confirmButtonClass':'btn-danger','confirmText':_0x8434aa(0xad9)});_0xc9d701&&(await _0x495bdf(_0x51fce0),activeShoppingCategoryId=_0x8434aa(0xe88),await _0x34f254(),_0x19109d(),await _0x501c7b('成功','分类\x20“'+_0xf7d8d9['name']+_0x8434aa(0x1015)));}async function _0x489333(){const _0x2afe70=_0x18b51e;activeShoppingCategoryId=_0x2afe70(0xe88),await _0x34f254(),_0x3d1990(_0x2afe70(0xbd1)),_0x19109d();}async function _0x34f254(){const _0x321662=_0x18b51e,_0x15501d=document['getElementById']('product-grid'),_0x30d64e=document[_0x321662(0x8c2)](_0x321662(0xa96)),_0x42d440=document[_0x321662(0x8c2)](_0x321662(0xbd1));_0x15501d[_0x321662(0xca0)]='',_0x30d64e[_0x321662(0xca0)]='';const [_0x3d486e,_0x4b15eb]=await Promise['all']([_0x15043e[_0x321662(0x221)][_0x321662(0x6be)](),_0x15043e['shoppingCategories'][_0x321662(0x731)](_0x321662(0x596))['toArray']()]);_0x42d440[_0x321662(0xb17)][_0x321662(0xfc3)](_0x321662(0xdf2),_0x399ecc);const _0x24a837=document[_0x321662(0x8c1)]('button');_0x24a837[_0x321662(0x84c)]=_0x321662(0x3a2),_0x24a837[_0x321662(0x1090)]='全部',_0x24a837['dataset']['categoryId']=_0x321662(0xe88);if(activeShoppingCategoryId===_0x321662(0xe88))_0x24a837[_0x321662(0xb17)][_0x321662(0x3f4)](_0x321662(0x71b));_0x30d64e[_0x321662(0x31e)](_0x24a837),_0x4b15eb[_0x321662(0x7c0)](_0x3a4fc0=>{const _0x5d9f2f=_0x321662,_0x48b11a=document['createElement']('button');_0x48b11a[_0x5d9f2f(0x84c)]=_0x5d9f2f(0x3a2),_0x48b11a['textContent']=_0x3a4fc0[_0x5d9f2f(0x596)],_0x48b11a[_0x5d9f2f(0x323)][_0x5d9f2f(0x792)]=_0x3a4fc0['id'];if(activeShoppingCategoryId===_0x3a4fc0['id'])_0x48b11a[_0x5d9f2f(0xb17)]['add'](_0x5d9f2f(0x71b));_0x30d64e[_0x5d9f2f(0x31e)](_0x48b11a);});let _0x479dce;activeShoppingCategoryId==='all'?_0x479dce=_0x3d486e:_0x479dce=_0x3d486e[_0x321662(0x1d8)](_0x524694=>_0x524694[_0x321662(0x792)]===activeShoppingCategoryId);if(_0x479dce[_0x321662(0x105a)]===0x0){const _0x369362=activeShoppingCategoryId===_0x321662(0xe88)?_0x321662(0x4c6):'这个分类下还没有商品哦~';_0x15501d[_0x321662(0xca0)]='<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>'+_0x369362+_0x321662(0x2e7);return;}_0x479dce[_0x321662(0x7c0)](_0x4c1a29=>{const _0x290ef4=_0x321662,_0x31fa42=document[_0x290ef4(0x8c1)]('div');_0x31fa42[_0x290ef4(0x84c)]=_0x290ef4(0xb8b),_0x31fa42[_0x290ef4(0x323)]['id']=_0x4c1a29['id'];const _0x41e7b0=_0x399ecc?_0x290ef4(0xf07):'';_0x31fa42[_0x290ef4(0xca0)]=_0x290ef4(0x115d)+_0x41e7b0+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x4c1a29[_0x290ef4(0x10d4)]+_0x290ef4(0xe5d)+_0x4c1a29[_0x290ef4(0x596)]+_0x290ef4(0x7ef)+_0x4c1a29[_0x290ef4(0x2ea)]['toFixed'](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x15501d[_0x290ef4(0x31e)](_0x31fa42);});}async function _0xf1dfb0(_0x5026d9,_0x14b2be=0x1,_0x2ed0a5=null){const _0x17ef86=_0x18b51e,_0x52cfd6=_0x2ed0a5?_0x52311a['find'](_0x5e7942=>_0x5e7942['productId']===_0x5026d9&&_0x5e7942[_0x17ef86(0x469)]?.[_0x17ef86(0x596)]===_0x2ed0a5['name']):_0x52311a[_0x17ef86(0x2ef)](_0x22eb1f=>_0x22eb1f[_0x17ef86(0xfa9)]===_0x5026d9&&!_0x22eb1f[_0x17ef86(0x469)]);if(_0x52cfd6)_0x52cfd6[_0x17ef86(0xe57)]+=_0x14b2be;else{const _0x3a19e9=await _0x15043e[_0x17ef86(0x221)][_0x17ef86(0x3e9)](_0x5026d9);_0x3a19e9&&_0x52311a[_0x17ef86(0xa49)]({'productId':_0x3a19e9['id'],'quantity':_0x14b2be,'variation':_0x2ed0a5});}_0x22e6fe();}function _0x412727(_0xfe6c29,_0x217765){const _0x1cd7d1=_0x18b51e,_0x310e5e=_0x52311a[_0x1cd7d1(0x1149)](_0x4a8ed5=>_0x4a8ed5[_0x1cd7d1(0xfa9)]===_0xfe6c29);_0x310e5e>-0x1&&(_0x52311a[_0x310e5e][_0x1cd7d1(0xe57)]+=_0x217765,_0x52311a[_0x310e5e][_0x1cd7d1(0xe57)]<=0x0&&_0x52311a[_0x1cd7d1(0x3e6)](_0x310e5e,0x1),_0x22e6fe(),_0x45cce9());}function _0x22e6fe(){const _0x492374=_0x18b51e,_0x2c74e6=_0x52311a['reduce']((_0x2d1ea2,_0x103e2c)=>_0x2d1ea2+_0x103e2c[_0x492374(0xe57)],0x0);document[_0x492374(0x8c2)](_0x492374(0x4ca))[_0x492374(0x1090)]=_0x2c74e6,document['getElementById'](_0x492374(0x74a))[_0x492374(0x1090)]=_0x492374(0x10b5)+_0x2c74e6+')',document[_0x492374(0x8c2)](_0x492374(0xc02))[_0x492374(0x1090)]=_0x492374(0x1a2)+_0x2c74e6+')';}function _0x33fc26(){_0x45cce9(),_0x3d1990('cart-screen');}async function _0x45cce9(){const _0x312b13=_0x18b51e,_0x36409e=document['getElementById'](_0x312b13(0x101e));_0x36409e['innerHTML']='';let _0x4a3856=0x0;if(_0x52311a[_0x312b13(0x105a)]===0x0)_0x36409e[_0x312b13(0xca0)]=_0x312b13(0x23b);else{const _0x3b0ac0=_0x52311a['map'](_0x284a4b=>_0x284a4b[_0x312b13(0xfa9)]),_0x11447a=await _0x15043e['shoppingProducts'][_0x312b13(0xdb8)]('id')[_0x312b13(0xdf0)](_0x3b0ac0)[_0x312b13(0x6be)](),_0x3d28b1=new Map(_0x11447a[_0x312b13(0x6b9)](_0x3c7fc5=>[_0x3c7fc5['id'],_0x3c7fc5]));_0x52311a[_0x312b13(0x7c0)](_0x1ad4c4=>{const _0x222536=_0x312b13,_0x560a51=_0x3d28b1[_0x222536(0x3e9)](_0x1ad4c4['productId']);if(_0x560a51){const _0x4a38cd=document[_0x222536(0x8c1)]('div');_0x4a38cd[_0x222536(0x84c)]=_0x222536(0x161);const _0xfce35f=_0x1ad4c4[_0x222536(0x469)]?_0x222536(0xe20)+_0x1ad4c4[_0x222536(0x469)][_0x222536(0x596)]+_0x222536(0x1079):'';_0x4a38cd[_0x222536(0xca0)]=_0x222536(0xe80)+_0x560a51['id']+_0x222536(0x24c)+(_0x1ad4c4[_0x222536(0x469)]?.['imageUrl']||_0x560a51['imageUrl'])+_0x222536(0x10da)+_0x560a51[_0x222536(0x596)]+_0x222536(0x41d)+_0xfce35f+_0x222536(0x6a6)+(_0x1ad4c4[_0x222536(0x469)]?.['price']||_0x560a51[_0x222536(0x2ea)])[_0x222536(0x3c1)](0x2)+_0x222536(0x9c0)+_0x560a51['id']+_0x222536(0x21c)+_0x1ad4c4['quantity']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22'+_0x560a51['id']+_0x222536(0xfc0),_0x36409e['appendChild'](_0x4a38cd);}});}_0x13a07c();}async function _0x13a07c(){const _0x672ac8=_0x18b51e;let _0x340f50=0x0;const _0x1341b5=document[_0x672ac8(0xa2d)](_0x672ac8(0x35a)),_0x3c6bbf=Array['from'](_0x1341b5)[_0x672ac8(0x6b9)](_0x4111af=>parseInt(_0x4111af[_0x672ac8(0x323)]['id']));if(_0x3c6bbf[_0x672ac8(0x105a)]>0x0){const _0x4dd50c=await _0x15043e[_0x672ac8(0x221)][_0x672ac8(0xdb8)]('id')[_0x672ac8(0xdf0)](_0x3c6bbf)[_0x672ac8(0x6be)](),_0x1244ab=new Map(_0x4dd50c['map'](_0x575b5c=>[_0x575b5c['id'],_0x575b5c]));_0x52311a[_0x672ac8(0x7c0)](_0x28a690=>{const _0x2c2308=_0x672ac8;if(_0x3c6bbf[_0x2c2308(0x773)](_0x28a690['productId'])){const _0x17d265=_0x1244ab['get'](_0x28a690[_0x2c2308(0xfa9)]);if(_0x17d265){const _0x464544=_0x28a690[_0x2c2308(0x469)]?_0x28a690[_0x2c2308(0x469)][_0x2c2308(0x2ea)]:_0x17d265[_0x2c2308(0x2ea)];_0x340f50+=_0x464544*_0x28a690['quantity'];}}});}document['getElementById'](_0x672ac8(0x128e))['textContent']=_0x672ac8(0x76c)+_0x340f50[_0x672ac8(0x3c1)](0x2);}async function _0x3d6a51(){const _0x76509b=_0x18b51e,_0x21a797=_0x405767[_0x76509b(0x799)][_0x405767['activeChatId']];if(!_0x21a797||!_0x21a797[_0x76509b(0x1000)])return;const _0x303eea=document[_0x76509b(0x8c2)](_0x76509b(0xa87)),_0x417919=document[_0x76509b(0x8c2)]('gift-recipient-list');_0x417919['innerHTML']='';const _0xf5d75a=_0x21a797[_0x76509b(0x33a)][_0x76509b(0xe16)]||'我',_0x205fa2=_0x21a797[_0x76509b(0x635)][_0x76509b(0x1d8)](_0x575958=>_0x575958[_0x76509b(0x375)]!==_0xf5d75a);_0x205fa2[_0x76509b(0x7c0)](_0xef473f=>{const _0x4d4bac=_0x76509b,_0xf064a8=document[_0x4d4bac(0x8c1)]('div');_0xf064a8['className']=_0x4d4bac(0xc25),_0xf064a8['dataset']['recipientName']=_0xef473f[_0x4d4bac(0x4e7)],_0xf064a8['innerHTML']=_0x4d4bac(0x10f1)+(_0xef473f[_0x4d4bac(0x1e1)]||_0x9fdc61)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0xef473f[_0x4d4bac(0x375)]+_0x4d4bac(0x4bd),_0x417919[_0x4d4bac(0x31e)](_0xf064a8);}),document[_0x76509b(0x8c2)](_0x76509b(0x1248))[_0x76509b(0x75f)]=![],_0x303eea['classList'][_0x76509b(0x3f4)](_0x76509b(0x2cd));}async function _0x5956a6(){const _0x5e81a1=_0x18b51e,_0x927eaa=_0x405767[_0x5e81a1(0x799)][_0x405767['activeChatId']],_0x2705c2=_0x52311a[_0x5e81a1(0x1d8)](_0x4582fa=>document[_0x5e81a1(0x1ad)](_0x5e81a1(0x16f)+_0x4582fa['productId']+_0x5e81a1(0xaaa)));if(_0x2705c2[_0x5e81a1(0x105a)]===0x0){alert(_0x5e81a1(0xbc0));return;}if(_0x927eaa['isGroup'])_0x3d6a51();else{const _0x52fd3b=await _0x8b9cb8(_0x5e81a1(0x271),'确定要将选中的商品作为礼物送出吗？',{'confirmText':_0x5e81a1(0x724)});_0x52fd3b&&await _0x3b7e38(_0x2705c2);}}async function _0x3b7e38(_0x46fe4a,_0x5b2cd=null){const _0x5daf56=_0x18b51e;if(!_0x405767[_0x5daf56(0x248)])return;const _0x20c2e7=_0x405767[_0x5daf56(0x799)][_0x405767['activeChatId']],_0x4c01fd=_0x46fe4a[_0x5daf56(0x6b9)](_0x3f1e7d=>_0x3f1e7d[_0x5daf56(0xfa9)]),_0x433d66=await _0x15043e[_0x5daf56(0x221)][_0x5daf56(0xdb8)]('id')[_0x5daf56(0xdf0)](_0x4c01fd)[_0x5daf56(0x6be)](),_0x370c3c=new Map(_0x433d66['map'](_0x19dd21=>[_0x19dd21['id'],_0x19dd21])),_0x29e88f=_0x46fe4a[_0x5daf56(0x6b9)](_0x1e48e1=>{const _0x2ea0c6=_0x5daf56,_0x56cf41=_0x370c3c[_0x2ea0c6(0x3e9)](_0x1e48e1[_0x2ea0c6(0xfa9)]);return _0x1e48e1[_0x2ea0c6(0x469)]?{'name':_0x56cf41[_0x2ea0c6(0x596)]+_0x2ea0c6(0x2e9)+_0x1e48e1[_0x2ea0c6(0x469)]['name'],'price':_0x1e48e1['variation'][_0x2ea0c6(0x2ea)],'imageUrl':_0x1e48e1[_0x2ea0c6(0x469)]['imageUrl']||_0x56cf41[_0x2ea0c6(0x10d4)],'quantity':_0x1e48e1[_0x2ea0c6(0xe57)]}:{'name':_0x56cf41['name'],'price':_0x56cf41[_0x2ea0c6(0x2ea)],'imageUrl':_0x56cf41['imageUrl'],'quantity':_0x1e48e1[_0x2ea0c6(0xe57)]};}),_0x872911={'role':_0x5daf56(0x74b),'type':_0x5daf56(0x2ad),'timestamp':Date[_0x5daf56(0x1ed)](),'items':_0x29e88f,'total':_0x29e88f['reduce']((_0x56d5bb,_0x3fddac)=>_0x56d5bb+_0x3fddac['price']*_0x3fddac[_0x5daf56(0xe57)],0x0),'recipients':_0x5b2cd};_0x20c2e7['history'][_0x5daf56(0xa49)](_0x872911);if(_0x5b2cd&&_0x5b2cd[_0x5daf56(0x105a)]>0x0){const _0x5b6322=_0x5b2cd[_0x5daf56(0x6b9)](_0xae8143=>_0x1ba34a(_0x20c2e7,_0xae8143))['join']('、'),_0x1013a6={'role':_0x5daf56(0x46c),'content':_0x5daf56(0x5e1)+(_0x20c2e7[_0x5daf56(0x33a)][_0x5daf56(0xe16)]||'我')+')\x20送出了一份礼物，收礼人是：'+_0x5b6322+'。请收礼的角色表示感谢，其他角色可以自由发挥。]','timestamp':Date['now']()+0x1,'isHidden':!![]};_0x20c2e7['history'][_0x5daf56(0xa49)](_0x1013a6);}await _0x15043e['chats'][_0x5daf56(0xfaa)](_0x20c2e7),_0x5c5c92(_0x872911,_0x20c2e7),_0x2b55d1(),_0x52311a=_0x52311a[_0x5daf56(0x1d8)](_0xa5215e=>!_0x46fe4a[_0x5daf56(0xdc3)](_0x2b37b7=>_0x2b37b7[_0x5daf56(0xfa9)]===_0xa5215e['productId'])),_0x22e6fe(),_0x3d1990(_0x5daf56(0xd5c)),await _0x501c7b('成功','礼物已成功送出！');}function _0x506bc6(_0x6b2568){const _0x44108b=_0x18b51e,_0x22e855=_0x405767['chats'][_0x405767[_0x44108b(0x248)]],_0x2c49be=_0x22e855[_0x44108b(0xd39)][_0x44108b(0x2ef)](_0x5716ef=>_0x5716ef[_0x44108b(0x351)]===_0x6b2568);if(!_0x2c49be||_0x2c49be[_0x44108b(0xde0)]!==_0x44108b(0x2ad))return;const _0x34ed9e=document[_0x44108b(0x8c2)]('gift-receipt-body');let _0x4c063c='';_0x2c49be[_0x44108b(0x5de)]['forEach'](_0x5f37e4=>{const _0x20267e=_0x44108b;_0x4c063c+=_0x20267e(0x47b)+_0x5f37e4[_0x20267e(0x596)]+_0x20267e(0x68c)+_0x5f37e4[_0x20267e(0xe57)]+_0x20267e(0x79c)+_0x5f37e4['price'][_0x20267e(0x3c1)](0x2)+_0x20267e(0xc95)+(_0x5f37e4[_0x20267e(0x2ea)]*_0x5f37e4[_0x20267e(0xe57)])[_0x20267e(0x3c1)](0x2)+_0x20267e(0x97f);}),_0x34ed9e[_0x44108b(0xca0)]='<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20'+new Date(_0x2c49be['timestamp'])[_0x44108b(0x2e8)]()+'</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>'+_0x4c063c+_0x44108b(0xb74)+_0x2c49be[_0x44108b(0x2c1)][_0x44108b(0x3c1)](0x2)+_0x44108b(0xc19),document['getElementById']('gift-receipt-modal')[_0x44108b(0xb17)]['add'](_0x44108b(0x2cd));}async function _0x164f71(_0xdf9928=null){const _0x3caca2=_0x18b51e;_0x1036b6=_0xdf9928;const _0x1ddade=document[_0x3caca2(0x8c2)](_0x3caca2(0x1250)),_0x51528f=document['getElementById'](_0x3caca2(0x80c)),_0x516777=document['getElementById']('product-name-input'),_0x252d7d=document['getElementById'](_0x3caca2(0x4a6)),_0x5c7180=document[_0x3caca2(0x8c2)](_0x3caca2(0xdf7)),_0x5858c5=document[_0x3caca2(0x8c2)](_0x3caca2(0xabb)),_0x46ea90=document[_0x3caca2(0x8c2)]('product-category-select'),_0x29302f=document[_0x3caca2(0x8c2)](_0x3caca2(0x1e4));_0x29302f[_0x3caca2(0xca0)]='',_0x46ea90[_0x3caca2(0xca0)]='<option\x20value=\x22\x22>--\x20未分类\x20--</option>';const _0x35ff2a=await _0x15043e['shoppingCategories']['toArray']();_0x35ff2a[_0x3caca2(0x7c0)](_0x3fdcd2=>{const _0x2a6e89=_0x3caca2,_0x38f1ff=document[_0x2a6e89(0x8c1)]('option');_0x38f1ff[_0x2a6e89(0x518)]=_0x3fdcd2['id'],_0x38f1ff['textContent']=_0x3fdcd2[_0x2a6e89(0x596)],_0x46ea90[_0x2a6e89(0x31e)](_0x38f1ff);});if(_0xdf9928){_0x51528f[_0x3caca2(0x1090)]=_0x3caca2(0x1216);const _0x3d1f8b=await _0x15043e[_0x3caca2(0x221)]['get'](_0xdf9928);_0x516777['value']=_0x3d1f8b['name'],_0x252d7d[_0x3caca2(0x518)]=_0x3d1f8b[_0x3caca2(0x2ea)],_0x5c7180[_0x3caca2(0x518)]=_0x3d1f8b['description']||'',_0x5858c5[_0x3caca2(0x939)]=_0x3d1f8b['imageUrl'],_0x46ea90[_0x3caca2(0x518)]=_0x3d1f8b[_0x3caca2(0x792)]||'',_0x3d1f8b[_0x3caca2(0x536)]&&_0x3d1f8b[_0x3caca2(0x536)][_0x3caca2(0x105a)]>0x0&&_0x3d1f8b[_0x3caca2(0x536)]['forEach'](_0x330d31=>_0x334fe3(_0x330d31));}else _0x51528f[_0x3caca2(0x1090)]=_0x3caca2(0xf11),_0x516777['value']='',_0x252d7d[_0x3caca2(0x518)]='',_0x5c7180[_0x3caca2(0x518)]='',_0x5858c5[_0x3caca2(0x939)]=_0x3caca2(0x10ae),_0x46ea90[_0x3caca2(0x518)]='';_0x1ddade['classList'][_0x3caca2(0x3f4)](_0x3caca2(0x2cd));}async function _0x2afd24(){const _0x538f60=_0x18b51e,_0x361d25=document[_0x538f60(0x8c2)](_0x538f60(0xade))['value'][_0x538f60(0x8c6)](),_0x3d32a3=parseFloat(document[_0x538f60(0x8c2)]('product-price-input')[_0x538f60(0x518)]),_0x57911e=document[_0x538f60(0x8c2)]('product-description-input')[_0x538f60(0x518)][_0x538f60(0x8c6)](),_0x590d75=document[_0x538f60(0x8c2)](_0x538f60(0xabb))['src'],_0xbb2bc0=parseInt(document[_0x538f60(0x8c2)]('product-category-select')[_0x538f60(0x518)])||null;if(!_0x361d25){alert(_0x538f60(0xe75));return;}if(isNaN(_0x3d32a3)||_0x3d32a3<0x0){alert('请输入有效的默认价格！');return;}const _0x3fe791=[];document[_0x538f60(0xa2d)](_0x538f60(0x651))[_0x538f60(0x7c0)](_0x46ef9e=>{const _0x44cd8d=_0x538f60,_0x4221fb=_0x46ef9e[_0x44cd8d(0x1ad)]('.variation-name-input')[_0x44cd8d(0x518)][_0x44cd8d(0x8c6)](),_0x20d45c=parseFloat(_0x46ef9e['querySelector']('.variation-price-input')[_0x44cd8d(0x518)]),_0x3de762=_0x46ef9e[_0x44cd8d(0x1ad)](_0x44cd8d(0xcff))[_0x44cd8d(0x939)];_0x4221fb&&!isNaN(_0x20d45c)&&_0x20d45c>=0x0&&_0x3fe791[_0x44cd8d(0xa49)]({'name':_0x4221fb,'price':_0x20d45c,'imageUrl':_0x3de762[_0x44cd8d(0x773)](_0x44cd8d(0x925))?null:_0x3de762});});const _0x3483a6={'name':_0x361d25,'price':_0x3d32a3,'description':_0x57911e,'imageUrl':_0x590d75,'categoryId':_0xbb2bc0,'variations':_0x3fe791};_0x1036b6?await _0x15043e[_0x538f60(0x221)][_0x538f60(0xb7c)](_0x1036b6,_0x3483a6):await _0x15043e[_0x538f60(0x221)]['add'](_0x3483a6),document[_0x538f60(0x8c2)](_0x538f60(0x1250))[_0x538f60(0xb17)][_0x538f60(0xaff)]('visible'),await _0x34f254();}async function _0x7c4b0f(){const _0x5f2b6b=_0x18b51e;await _0x13de65(),_0x3d1990(_0x5f2b6b(0xdc4));}async function _0x13de65(){const _0x52350c=_0x18b51e,_0x58fcb6=document[_0x52350c(0x8c2)]('rules-tabs'),_0x3dcfc4=document[_0x52350c(0x8c2)](_0x52350c(0x10dd));_0x58fcb6[_0x52350c(0xca0)]='',_0x3dcfc4[_0x52350c(0xca0)]='';const _0x2d693a=await _0x15043e['renderingRules']['toArray']();if(_0x2d693a[_0x52350c(0x105a)]===0x0){_0x3dcfc4['innerHTML']=_0x52350c(0xdef);return;}const _0x373a9c=document[_0x52350c(0x8c1)](_0x52350c(0x19a));_0x373a9c[_0x52350c(0x84c)]=_0x52350c(0x480),_0x373a9c[_0x52350c(0x1090)]=_0x52350c(0x5f7),_0x373a9c[_0x52350c(0x323)][_0x52350c(0x792)]='global',_0x58fcb6[_0x52350c(0x31e)](_0x373a9c);const _0xae5701=document[_0x52350c(0x8c1)](_0x52350c(0x1072));_0xae5701[_0x52350c(0x84c)]=_0x52350c(0xd23),_0xae5701['dataset'][_0x52350c(0x792)]=_0x52350c(0xd50),_0x3dcfc4[_0x52350c(0x31e)](_0xae5701);const _0x332b44=Object['values'](_0x405767[_0x52350c(0x799)])['filter'](_0x135199=>!_0x135199['isGroup']&&_0x2d693a[_0x52350c(0xdc3)](_0x32f33f=>_0x32f33f[_0x52350c(0xb3d)]===_0x135199['id']));_0x332b44[_0x52350c(0x7c0)](_0x3d9fc1=>{const _0x3634c8=_0x52350c,_0x395523=document['createElement'](_0x3634c8(0x19a));_0x395523[_0x3634c8(0x84c)]=_0x3634c8(0x11d5),_0x395523[_0x3634c8(0x1090)]=_0x3d9fc1[_0x3634c8(0x596)],_0x395523['dataset'][_0x3634c8(0x792)]=_0x3d9fc1['id'],_0x58fcb6['appendChild'](_0x395523);const _0x15b040=document[_0x3634c8(0x8c1)](_0x3634c8(0x1072));_0x15b040[_0x3634c8(0x84c)]=_0x3634c8(0x88b),_0x15b040[_0x3634c8(0x323)]['categoryId']=_0x3d9fc1['id'],_0x3dcfc4[_0x3634c8(0x31e)](_0x15b040);}),_0x2d693a['forEach'](_0x28451c=>{const _0x18a016=_0x52350c,_0x4c92fa=_0x3d3593(_0x28451c),_0x2ee11a=_0x3dcfc4[_0x18a016(0x1ad)]('.rules-category-pane[data-category-id=\x22'+_0x28451c['chatId']+'\x22]');_0x2ee11a&&_0x2ee11a[_0x18a016(0x31e)](_0x4c92fa);}),document['querySelectorAll'](_0x52350c(0x1258))['forEach'](_0xe749f0=>{const _0x30b2d0=_0x52350c;_0xe749f0[_0x30b2d0(0xae8)](_0x30b2d0(0xa17),()=>_0x5ad026(_0xe749f0['dataset']['categoryId']));});}function _0x3d3593(_0x5dd0dd){const _0x1cb6b4=_0x18b51e,_0x15768e=document[_0x1cb6b4(0x8c1)](_0x1cb6b4(0x1072));return _0x15768e[_0x1cb6b4(0x84c)]=_0x1cb6b4(0x874)+(_0x5dd0dd[_0x1cb6b4(0x111a)]?_0x1cb6b4(0x69a):''),_0x15768e['dataset'][_0x1cb6b4(0x549)]=_0x5dd0dd['id'],_0x15768e['innerHTML']=_0x1cb6b4(0x10c6)+_0x5dd0dd[_0x1cb6b4(0x596)]+_0x1cb6b4(0x229)+_0x5dd0dd[_0x1cb6b4(0x3e7)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x15768e[_0x1cb6b4(0xae8)]('click',()=>_0x119253(_0x5dd0dd['id'])),_0x5dcbd7(_0x15768e,()=>_0x312aa5(_0x5dd0dd['id'])),_0x15768e;}async function _0x119253(_0xdf3ec6=null){const _0x219524=_0x18b51e;_0x123726=_0xdf3ec6;const _0x597dbb=document[_0x219524(0x8c2)](_0x219524(0xb9e)),_0x1f67a0=document[_0x219524(0x8c2)](_0x219524(0x11ec)),_0x4c0481=document[_0x219524(0x8c2)](_0x219524(0xff5)),_0x267ca8=document[_0x219524(0x8c2)](_0x219524(0xd1b)),_0x8ebf09=document['getElementById'](_0x219524(0x716)),_0x55accb=document[_0x219524(0x8c2)](_0x219524(0x6dc)),_0x2e09e5=document['getElementById'](_0x219524(0xa75));_0x267ca8['innerHTML']=_0x219524(0xf66),Object[_0x219524(0x22f)](_0x405767[_0x219524(0x799)])[_0x219524(0x1d8)](_0x35d6bd=>!_0x35d6bd[_0x219524(0x1000)])['forEach'](_0x483410=>{_0x267ca8['innerHTML']+='<option\x20value=\x22'+_0x483410['id']+'\x22>'+_0x483410['name']+'</option>';});if(_0xdf3ec6){_0x1f67a0[_0x219524(0x1090)]=_0x219524(0x1e7);const _0x250bf0=await _0x15043e[_0x219524(0x68b)][_0x219524(0x3e9)](_0xdf3ec6);_0x4c0481[_0x219524(0x518)]=_0x250bf0['name'],_0x267ca8[_0x219524(0x518)]=_0x250bf0[_0x219524(0xb3d)],_0x8ebf09['value']=_0x250bf0[_0x219524(0x3e7)],_0x55accb['value']=_0x250bf0[_0x219524(0x9db)],_0x2e09e5[_0x219524(0x75f)]=_0x250bf0[_0x219524(0x111a)];}else _0x1f67a0[_0x219524(0x1090)]=_0x219524(0x109f),_0x4c0481['value']='',_0x267ca8['value']=_0x219524(0xd50),_0x8ebf09[_0x219524(0x518)]='',_0x55accb[_0x219524(0x518)]='',_0x2e09e5['checked']=!![];_0x597dbb[_0x219524(0xb17)][_0x219524(0x3f4)]('visible');}async function _0x18d739(){const _0xf0eb5=_0x18b51e,_0x4942e9=document[_0xf0eb5(0x8c2)]('rule-name-input')[_0xf0eb5(0x518)]['trim'](),_0x586ea9=document[_0xf0eb5(0x8c2)](_0xf0eb5(0x716))[_0xf0eb5(0x518)][_0xf0eb5(0x8c6)]();if(!_0x4942e9||!_0x586ea9){alert(_0xf0eb5(0x10b4));return;}try{new RegExp(_0x586ea9);}catch(_0xddb2c5){alert(_0xf0eb5(0xa6b)+_0xddb2c5['message']);return;}const _0x2812bc={'name':_0x4942e9,'chatId':document[_0xf0eb5(0x8c2)](_0xf0eb5(0xd1b))[_0xf0eb5(0x518)],'regex':_0x586ea9,'template':document[_0xf0eb5(0x8c2)](_0xf0eb5(0x6dc))[_0xf0eb5(0x518)],'isEnabled':document['getElementById'](_0xf0eb5(0xa75))['checked']};_0x123726?await _0x15043e[_0xf0eb5(0x68b)][_0xf0eb5(0xb7c)](_0x123726,_0x2812bc):await _0x15043e[_0xf0eb5(0x68b)][_0xf0eb5(0x3f4)](_0x2812bc),document[_0xf0eb5(0x8c2)](_0xf0eb5(0xb9e))['classList'][_0xf0eb5(0xaff)]('visible'),await _0x13de65();}async function _0x312aa5(_0xb9a13f){const _0x35822c=_0x18b51e,_0x149aae=await _0x8b9cb8('删除规则',_0x35822c(0x383),{'confirmButtonClass':_0x35822c(0xe2a)});_0x149aae&&(await _0x15043e['renderingRules'][_0x35822c(0x89f)](_0xb9a13f),await _0x13de65());}async function _0x2ae9a6(_0x3cd6ee,_0x3c7b0d){const _0x16f013=_0x18b51e;if(_0x3cd6ee[_0x16f013(0x8c6)]()[_0x16f013(0xc7c)]('<')||!_0x3cd6ee[_0x16f013(0x773)]('[')&&!_0x3cd6ee[_0x16f013(0x773)]('{'))return _0x3cd6ee;const _0x2eac61=await _0x15043e[_0x16f013(0x68b)]['where'](_0x16f013(0xb3d))[_0x16f013(0xc9a)](_0x16f013(0xd50))['or']('chatId')[_0x16f013(0xc9a)](_0x3c7b0d)[_0x16f013(0x6be)]();let _0x30cb8d=_0x3cd6ee;for(const _0x2af632 of _0x2eac61[_0x16f013(0x1d8)](_0x2f9ce9=>_0x2f9ce9[_0x16f013(0x111a)])){try{const _0x30a673=new RegExp(_0x2af632[_0x16f013(0x3e7)],'g');_0x30a673[_0x16f013(0x696)](_0x30cb8d)&&(_0x30cb8d=_0x30cb8d[_0x16f013(0x1b7)](_0x30a673,_0x2af632[_0x16f013(0x9db)]));}catch(_0x977c82){console[_0x16f013(0x7a3)]('渲染规则\x20['+_0x2af632[_0x16f013(0x596)]+_0x16f013(0xc00),_0x977c82);}}return _0x30cb8d;}async function _0x7c4b0f(){await _0x13de65(),_0x3d1990('rendering-rules-screen');}async function _0x13de65(){const _0x4b0b48=_0x18b51e,_0x384931=document[_0x4b0b48(0x8c2)](_0x4b0b48(0xad4)),_0x679341=document[_0x4b0b48(0x8c2)](_0x4b0b48(0x10dd));_0x384931[_0x4b0b48(0xca0)]='',_0x679341[_0x4b0b48(0xca0)]='';const _0x692b2c=await _0x15043e[_0x4b0b48(0x68b)][_0x4b0b48(0x6be)]();if(_0x692b2c[_0x4b0b48(0x105a)]===0x0){_0x679341['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>';return;}const _0x19ca28=document[_0x4b0b48(0x8c1)](_0x4b0b48(0x19a));_0x19ca28[_0x4b0b48(0x84c)]=_0x4b0b48(0x480),_0x19ca28[_0x4b0b48(0x1090)]=_0x4b0b48(0x5f7),_0x19ca28['dataset'][_0x4b0b48(0x792)]=_0x4b0b48(0xd50),_0x384931[_0x4b0b48(0x31e)](_0x19ca28);const _0x1eca8d=document[_0x4b0b48(0x8c1)]('div');_0x1eca8d[_0x4b0b48(0x84c)]=_0x4b0b48(0xd23),_0x1eca8d[_0x4b0b48(0x323)][_0x4b0b48(0x792)]=_0x4b0b48(0xd50),_0x679341[_0x4b0b48(0x31e)](_0x1eca8d);const _0x223ba8=Object[_0x4b0b48(0x22f)](_0x405767['chats'])[_0x4b0b48(0x1d8)](_0xb314c8=>!_0xb314c8[_0x4b0b48(0x1000)]&&_0x692b2c[_0x4b0b48(0xdc3)](_0x2256db=>_0x2256db[_0x4b0b48(0xb3d)]===_0xb314c8['id']));_0x223ba8[_0x4b0b48(0x7c0)](_0x933fc6=>{const _0x21c39e=_0x4b0b48,_0x22627b=document[_0x21c39e(0x8c1)](_0x21c39e(0x19a));_0x22627b[_0x21c39e(0x84c)]=_0x21c39e(0x11d5),_0x22627b[_0x21c39e(0x1090)]=_0x933fc6[_0x21c39e(0x596)],_0x22627b[_0x21c39e(0x323)][_0x21c39e(0x792)]=_0x933fc6['id'],_0x384931[_0x21c39e(0x31e)](_0x22627b);const _0x29c576=document[_0x21c39e(0x8c1)](_0x21c39e(0x1072));_0x29c576[_0x21c39e(0x84c)]=_0x21c39e(0x88b),_0x29c576[_0x21c39e(0x323)][_0x21c39e(0x792)]=_0x933fc6['id'],_0x679341[_0x21c39e(0x31e)](_0x29c576);}),_0x692b2c[_0x4b0b48(0x7c0)](_0x17c3b5=>{const _0x115a69=_0x4b0b48,_0x12dab5=_0x3d3593(_0x17c3b5),_0x1fba03=_0x679341['querySelector'](_0x115a69(0xa9c)+_0x17c3b5[_0x115a69(0xb3d)]+'\x22]');_0x1fba03&&_0x1fba03['appendChild'](_0x12dab5);}),document[_0x4b0b48(0xa2d)](_0x4b0b48(0x1258))[_0x4b0b48(0x7c0)](_0x32d4bd=>{const _0x21fc63=_0x4b0b48;_0x32d4bd[_0x21fc63(0xae8)](_0x21fc63(0xa17),()=>_0x5ad026(_0x32d4bd['dataset'][_0x21fc63(0x792)]));});}function _0x3d3593(_0x198464){const _0x2658cf=_0x18b51e,_0x22aec0=document[_0x2658cf(0x8c1)](_0x2658cf(0x1072));return _0x22aec0[_0x2658cf(0x84c)]=_0x2658cf(0x874)+(_0x198464[_0x2658cf(0x111a)]?_0x2658cf(0x69a):''),_0x22aec0['dataset'][_0x2658cf(0x549)]=_0x198464['id'],_0x22aec0['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x198464[_0x2658cf(0x596)]+_0x2658cf(0x229)+_0x198464[_0x2658cf(0x3e7)]+_0x2658cf(0x6de),_0x22aec0[_0x2658cf(0xae8)]('click',()=>_0x119253(_0x198464['id'])),_0x5dcbd7(_0x22aec0,()=>_0x312aa5(_0x198464['id'])),_0x22aec0;}async function _0x119253(_0x43fba2=null){const _0x45a540=_0x18b51e;_0x123726=_0x43fba2;const _0x4f42f2=document[_0x45a540(0x8c2)](_0x45a540(0xb9e)),_0x12b670=document[_0x45a540(0x8c2)](_0x45a540(0x11ec)),_0x2d9937=document[_0x45a540(0x8c2)](_0x45a540(0xff5)),_0x2c11e6=document[_0x45a540(0x8c2)](_0x45a540(0xd1b)),_0xc01578=document[_0x45a540(0x8c2)](_0x45a540(0x716)),_0x4b538d=document[_0x45a540(0x8c2)](_0x45a540(0x6dc)),_0x55a36b=document[_0x45a540(0x8c2)](_0x45a540(0xa75));_0x2c11e6['innerHTML']=_0x45a540(0xf66),Object[_0x45a540(0x22f)](_0x405767[_0x45a540(0x799)])[_0x45a540(0x1d8)](_0xb2debf=>!_0xb2debf[_0x45a540(0x1000)])[_0x45a540(0x7c0)](_0x15d75e=>{const _0x5a5816=_0x45a540;_0x2c11e6[_0x5a5816(0xca0)]+='<option\x20value=\x22'+_0x15d75e['id']+'\x22>'+_0x15d75e[_0x5a5816(0x596)]+_0x5a5816(0x42b);});if(_0x43fba2){_0x12b670[_0x45a540(0x1090)]=_0x45a540(0x1e7);const _0x5d8807=await _0x15043e[_0x45a540(0x68b)][_0x45a540(0x3e9)](_0x43fba2);_0x2d9937[_0x45a540(0x518)]=_0x5d8807[_0x45a540(0x596)],_0x2c11e6['value']=_0x5d8807[_0x45a540(0xb3d)],_0xc01578[_0x45a540(0x518)]=_0x5d8807[_0x45a540(0x3e7)],_0x4b538d['value']=_0x5d8807[_0x45a540(0x9db)],_0x55a36b[_0x45a540(0x75f)]=_0x5d8807[_0x45a540(0x111a)];}else _0x12b670[_0x45a540(0x1090)]=_0x45a540(0x109f),_0x2d9937[_0x45a540(0x518)]='',_0x2c11e6[_0x45a540(0x518)]=_0x45a540(0xd50),_0xc01578[_0x45a540(0x518)]='',_0x4b538d[_0x45a540(0x518)]='',_0x55a36b[_0x45a540(0x75f)]=!![];_0x4f42f2[_0x45a540(0xb17)][_0x45a540(0x3f4)](_0x45a540(0x2cd));}async function _0x18d739(){const _0x59e0b4=_0x18b51e,_0xa16769=document['getElementById'](_0x59e0b4(0xff5))[_0x59e0b4(0x518)]['trim'](),_0x436c68=document['getElementById'](_0x59e0b4(0x716))[_0x59e0b4(0x518)][_0x59e0b4(0x8c6)]();if(!_0xa16769||!_0x436c68){alert(_0x59e0b4(0x10b4));return;}try{new RegExp(_0x436c68);}catch(_0x3ceb38){alert(_0x59e0b4(0xa6b)+_0x3ceb38[_0x59e0b4(0xc7d)]);return;}const _0x4d004e={'name':_0xa16769,'chatId':document['getElementById'](_0x59e0b4(0xd1b))[_0x59e0b4(0x518)],'regex':_0x436c68,'template':document[_0x59e0b4(0x8c2)](_0x59e0b4(0x6dc))[_0x59e0b4(0x518)],'isEnabled':document[_0x59e0b4(0x8c2)](_0x59e0b4(0xa75))[_0x59e0b4(0x75f)]};_0x123726?await _0x15043e[_0x59e0b4(0x68b)]['update'](_0x123726,_0x4d004e):await _0x15043e[_0x59e0b4(0x68b)][_0x59e0b4(0x3f4)](_0x4d004e),document['getElementById'](_0x59e0b4(0xb9e))[_0x59e0b4(0xb17)][_0x59e0b4(0xaff)]('visible'),await _0x13de65();}async function _0x312aa5(_0x38e49f){const _0x4fd4fb=_0x18b51e,_0x4e58cc=await _0x8b9cb8('删除规则','确定要删除这条渲染规则吗？',{'confirmButtonClass':_0x4fd4fb(0xe2a)});_0x4e58cc&&(await _0x15043e[_0x4fd4fb(0x68b)][_0x4fd4fb(0x89f)](_0x38e49f),await _0x13de65());}async function _0x2ae9a6(_0x189d35,_0x57b902){const _0x54b0c3=_0x18b51e;if(_0x189d35[_0x54b0c3(0x8c6)]()[_0x54b0c3(0xc7c)]('<')||!_0x189d35[_0x54b0c3(0x773)]('[')&&!_0x189d35['includes']('{'))return _0x189d35;if(!_0x3976af[_0x57b902]){console['log'](_0x54b0c3(0x4d5)+_0x57b902);const _0x380340=await _0x15043e[_0x54b0c3(0x68b)][_0x54b0c3(0xdb8)]('chatId')['equals'](_0x54b0c3(0xd50))['or'](_0x54b0c3(0xb3d))[_0x54b0c3(0xc9a)](_0x57b902)[_0x54b0c3(0x6be)]();_0x3976af[_0x57b902]=_0x380340['filter'](_0x46d659=>_0x46d659[_0x54b0c3(0x111a)]);}const _0x9ae092=_0x3976af[_0x57b902];let _0x23feda=_0x189d35;for(const _0x1b7221 of _0x9ae092){try{const _0x3a7272=new RegExp(_0x1b7221['regex'],'g');let _0x3a2c02=_0x23feda;_0x3a7272[_0x54b0c3(0x696)](_0x3a2c02)&&(_0x23feda=_0x23feda[_0x54b0c3(0x1b7)](_0x3a7272,_0x1b7221[_0x54b0c3(0x9db)]));}catch(_0x5bdc63){console[_0x54b0c3(0x7a3)]('渲染规则\x20['+_0x1b7221[_0x54b0c3(0x596)]+']\x20的正则表达式无效:',_0x5bdc63);}}return _0x23feda;}function _0x1e932e(_0xd2795e){const _0x27baa2=_0x18b51e;if(!_0xd2795e)return'';const _0x160e7d=new Date(),_0x458b9d=new Date(_0xd2795e),_0x1933df=String(_0x458b9d[_0x27baa2(0x1ae)]())['padStart'](0x2,'0'),_0xc44e9a=String(_0x458b9d['getMinutes']())['padStart'](0x2,'0'),_0x48ff3=_0x1933df+':'+_0xc44e9a;if(_0x160e7d[_0x27baa2(0x1181)]()===_0x458b9d[_0x27baa2(0x1181)]())return _0x48ff3;const _0x5f1766=new Date();_0x5f1766['setDate'](_0x160e7d[_0x27baa2(0xca8)]()-0x1);if(_0x5f1766[_0x27baa2(0x1181)]()===_0x458b9d[_0x27baa2(0x1181)]())return _0x27baa2(0xd4f)+_0x48ff3;const _0x4ec486=_0x458b9d[_0x27baa2(0x864)](),_0x34fb01=String(_0x458b9d[_0x27baa2(0xc3c)]()+0x1)[_0x27baa2(0xc89)](0x2,'0'),_0x3c4646=String(_0x458b9d[_0x27baa2(0xca8)]())[_0x27baa2(0xc89)](0x2,'0');return _0x160e7d[_0x27baa2(0x864)]()===_0x4ec486?_0x34fb01+'月'+_0x3c4646+'日\x20'+_0x48ff3:_0x4ec486+'年'+_0x34fb01+'月'+_0x3c4646+'日\x20'+_0x48ff3;}function _0x436749(_0x192795){const _0xfdcd7d=_0x18b51e,_0x55646b=document[_0xfdcd7d(0x8c1)](_0xfdcd7d(0x1072));_0x55646b[_0xfdcd7d(0x84c)]=_0xfdcd7d(0xff4);const _0x177443=document[_0xfdcd7d(0x8c1)](_0xfdcd7d(0x1072));return _0x177443[_0xfdcd7d(0x84c)]=_0xfdcd7d(0x927),_0x177443['textContent']=_0x1e932e(_0x192795),_0x55646b['appendChild'](_0x177443),_0x55646b;}async function _0x2d9a2f(){const _0x1d8454=_0x18b51e,_0x3bdc30=_0x405767['chats'][_0x405767['activeChatId']];if(!_0x3bdc30||!lastResponseTimestamps||lastResponseTimestamps[_0x1d8454(0x105a)]===0x0){alert(_0x1d8454(0x2db));return;}_0x3bdc30[_0x1d8454(0xd39)]=_0x3bdc30[_0x1d8454(0xd39)][_0x1d8454(0x1d8)](_0x39ec6d=>!lastResponseTimestamps[_0x1d8454(0x773)](_0x39ec6d['timestamp'])),await _0x15043e[_0x1d8454(0x799)][_0x1d8454(0xfaa)](_0x3bdc30),await _0x7dbe71(_0x405767[_0x1d8454(0x248)]),_0x52aced();}async function _0x2e9449(){const _0x14013e=_0x18b51e,_0x4942ea=_0x405767[_0x14013e(0x799)][_0x405767[_0x14013e(0x248)]];if(!_0x4942ea)return;const _0x18b5d6=_0x4942ea[_0x14013e(0xd39)][_0x14013e(0x612)](_0x40e712=>_0x40e712[_0x14013e(0x14a)]==='user'&&!_0x40e712[_0x14013e(0x3f1)]);if(_0x18b5d6===-0x1){alert(_0x14013e(0x10c2));return;}const _0x275652=_0x4942ea[_0x14013e(0xd39)]['findLastIndex'](_0x59f0e5=>_0x59f0e5[_0x14013e(0x14a)]==='assistant');if(_0x275652<_0x18b5d6){alert(_0x14013e(0xbe7));return;}_0x4942ea[_0x14013e(0xd39)][_0x14013e(0x3e6)](_0x18b5d6+0x1),await _0x15043e[_0x14013e(0x799)][_0x14013e(0xfaa)](_0x4942ea),await _0x7dbe71(_0x405767[_0x14013e(0x248)]),await _0x523815();}async function _0xe41d17(){const _0x4dcedc=_0x18b51e;if(!_0x49beae[_0x4dcedc(0x6f0)])return;const _0x1d0fb0=_0x49beae[_0x4dcedc(0x61d)][_0x4dcedc(0x612)](_0x1fb827=>_0x1fb827[_0x4dcedc(0x14a)]===_0x4dcedc(0x74b));if(_0x1d0fb0===-0x1){alert(_0x4dcedc(0x8f7));return;}_0x49beae[_0x4dcedc(0x61d)][_0x4dcedc(0x3e6)](_0x1d0fb0+0x1);const _0x556dc6=document['getElementById'](_0x4dcedc(0x847));_0x556dc6[_0x4dcedc(0xca0)]='',_0x49beae[_0x4dcedc(0x61d)][_0x4dcedc(0x7c0)](_0x27cff1=>{const _0x573082=_0x4dcedc,_0xe6f4=document[_0x573082(0x8c1)](_0x573082(0x1072));_0xe6f4[_0x573082(0x84c)]=_0x573082(0x198)+_0x27cff1[_0x573082(0x14a)]+'-speech',_0xe6f4[_0x573082(0x323)]['timestamp']=_0x27cff1['timestamp'],_0x27cff1[_0x573082(0x14a)]===_0x573082(0x74b)?_0xe6f4[_0x573082(0x1090)]=_0x27cff1[_0x573082(0x168)]:_0xe6f4[_0x573082(0xca0)]=_0x27cff1[_0x573082(0x168)],_0x5dcbd7(_0xe6f4,()=>_0x1fca53(_0x27cff1[_0x573082(0x351)])),_0x556dc6[_0x573082(0x31e)](_0xe6f4);}),_0x556dc6[_0x4dcedc(0xfd0)]=_0x556dc6[_0x4dcedc(0xb43)],_0x519abd(null);}async function _0x356dce(){const _0x2708a7=_0x18b51e,_0x12a4b6=_0x405767[_0x2708a7(0x799)][_0x405767[_0x2708a7(0x248)]];if(!_0x12a4b6)return;_0x24fb6c(_0x12a4b6['id'],!![]);const _0x5bf89f=document[_0x2708a7(0x8c2)](_0x2708a7(0x334));!_0x12a4b6[_0x2708a7(0x1000)]&&(_0x5bf89f[_0x2708a7(0x842)][_0x2708a7(0x9d7)]=0x0,setTimeout(()=>{const _0x277b5b=_0x2708a7;_0x5bf89f['textContent']=_0x277b5b(0x354),_0x5bf89f[_0x277b5b(0xb17)][_0x277b5b(0x3f4)](_0x277b5b(0xce9)),_0x5bf89f[_0x277b5b(0x842)]['opacity']=0x1;},0xc8));try{const {proxyUrl:_0x218a71,apiKey:_0x3c3506,model:_0x5b0d2a}=_0x405767[_0x2708a7(0x9e0)];if(!_0x218a71||!_0x3c3506||!_0x5b0d2a)throw new Error(_0x2708a7(0xc27));const _0x19a55d=parseInt(_0x12a4b6[_0x2708a7(0x33a)]['maxMemory'])||0xa,_0x499582=_0x12a4b6['history'][_0x2708a7(0x961)](-_0x19a55d),_0xc8f64d=new Date(),_0x33d3c6=new Date(_0xc8f64d[_0x2708a7(0x610)]()+_0xc8f64d[_0x2708a7(0x7ba)]()*0xea60+0x36ee80*0x8),_0x2e1649=_0x33d3c6[_0x2708a7(0x2e8)](_0x2708a7(0x73e),{'timeZone':_0x2708a7(0xad0),'dateStyle':'full','timeStyle':_0x2708a7(0xd9b)}),_0x569121=_0x1a88fc(_0x33d3c6),_0x4192d7=_0x12a4b6[_0x2708a7(0x33a)][_0x2708a7(0xe16)]||'我';let _0x574d4a='';if(_0x12a4b6['settings'][_0x2708a7(0xb77)]&&_0x12a4b6['settings'][_0x2708a7(0xb77)][_0x2708a7(0x105a)]>0x0){const _0xf8244d=_0x12a4b6[_0x2708a7(0x33a)][_0x2708a7(0xb77)][_0x2708a7(0x6b9)](_0x4ea43b=>{const _0x2d56d9=_0x2708a7,_0x2637eb=_0x405767['worldBooks'][_0x2d56d9(0x2ef)](_0x46f41c=>_0x46f41c['id']===_0x4ea43b);if(!_0x2637eb||!Array[_0x2d56d9(0xb85)](_0x2637eb[_0x2d56d9(0x168)]))return'';const _0x458a94=_0x2637eb['content']['filter'](_0x57e800=>_0x57e800[_0x2d56d9(0x69a)]!==![])[_0x2d56d9(0x6b9)](_0x3ad297=>{const _0x1ae715=_0x2d56d9;let _0x578056=_0x1ae715(0xf8d)+(_0x3ad297[_0x1ae715(0x120a)]||_0x1ae715(0x11db))+'\x0a';if(_0x3ad297[_0x1ae715(0xbda)][_0x1ae715(0x105a)]>0x0)_0x578056+=_0x1ae715(0xdd1)+_0x3ad297[_0x1ae715(0xbda)][_0x1ae715(0xb2c)](',\x20')+'\x0a';return _0x578056+=_0x1ae715(0xce7)+_0x3ad297[_0x1ae715(0x168)],_0x578056;})[_0x2d56d9(0xb2c)]('');return _0x458a94?_0x2d56d9(0x15d)+_0x2637eb[_0x2d56d9(0x596)]+'\x0a'+_0x458a94:'';})[_0x2708a7(0x1d8)](Boolean)[_0x2708a7(0xb2c)]('');_0xf8244d&&(_0x574d4a=_0x2708a7(0xcee)+_0xf8244d+_0x2708a7(0x836));}let _0x4a5cab='';if(_0x4a77e1['isActive']&&_0x4a77e1[_0x2708a7(0x248)]===_0x12a4b6['id']){const _0x4a89fe=_0x4a77e1[_0x2708a7(0x585)]>-0x1?_0x4a77e1[_0x2708a7(0xcfa)][_0x4a77e1[_0x2708a7(0x585)]]:null;_0x4a5cab=_0x2708a7(0x64d);}const _0x55ee3a=_0x2de4e7(_0x5d05df[_0x12a4b6['id']]);let _0x51666d='';_0x12a4b6['nameHistory']&&_0x12a4b6[_0x2708a7(0x1116)][_0x2708a7(0x105a)]>0x0&&(_0x51666d='\x0a-\x20**你的曾用名**:\x20['+_0x12a4b6[_0x2708a7(0x1116)][_0x2708a7(0xb2c)](',\x20')+']。当在对话历史中看到这些名字时，它们都指的是【你】自己。');let _0x5c1100='';const _0x8e34b9=_0x405767[_0x2708a7(0x20a)][_0x2708a7(0xab3)]||'用户';_0x5c1100+=_0x2708a7(0x942)+_0x8e34b9+_0x2708a7(0xe43);const _0x1283d6=Object[_0x2708a7(0x22f)](_0x405767[_0x2708a7(0x799)])['filter'](_0x355740=>_0x355740[_0x2708a7(0x1000)]&&_0x355740['members'][_0x2708a7(0xdc3)](_0x58cfe8=>_0x58cfe8['id']===_0x12a4b6['id']));_0x1283d6[_0x2708a7(0x105a)]>0x0&&(_0x5c1100+='-\x20用户在你们共同所在的群聊中的昵称如下：\x0a',_0x1283d6['forEach'](_0x5abfa7=>{const _0x1efb35=_0x2708a7,_0xceb4dd=_0x5abfa7[_0x1efb35(0x33a)][_0x1efb35(0xe16)]||_0x8e34b9;_0x5c1100+=_0x1efb35(0x6e9)+_0x5abfa7['name']+_0x1efb35(0xa73)+_0xceb4dd+'”。\x0a';}));_0x5c1100+='当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。';const _0x380cae=_0x2708a7(0x53e)+_0x12a4b6[_0x2708a7(0x4e7)]+_0x2708a7(0x1ea)+_0x2e1649+'\x20('+_0x569121+_0x2708a7(0xf73)+(_0x4a5cab?_0x2708a7(0x778)+_0x4a5cab:_0x2708a7(0xcdf))+_0x2708a7(0x2f4)+(_0x12a4b6[_0x2708a7(0xbca)]&&_0x12a4b6['longTermMemory'][_0x2708a7(0x105a)]>0x0?_0x12a4b6['longTermMemory'][_0x2708a7(0x6b9)](_0x151af9=>'-\x20'+_0x151af9[_0x2708a7(0x168)])[_0x2708a7(0xb2c)]('\x0a'):_0x2708a7(0xbee))+'\x0a\x0a#\x20你的角色设定\x0a'+_0x12a4b6['settings']['aiPersona']+_0x2708a7(0x7b6)+_0x12a4b6[_0x2708a7(0x4e7)]+_0x2708a7(0x10c5)+_0x12a4b6[_0x2708a7(0x596)]+_0x2708a7(0x1150)+_0x4192d7+'”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20'+_0x5c1100+'\x0a\x20\x20\x20\x20'+_0x51666d+_0x2708a7(0xd48)+_0x574d4a+_0x2708a7(0x6e6)+(_0x12a4b6[_0x2708a7(0x33a)][_0x2708a7(0xca4)]&&_0x12a4b6['settings']['aiAvatarLibrary'][_0x2708a7(0x105a)]>0x0?_0x12a4b6[_0x2708a7(0x33a)][_0x2708a7(0xca4)][_0x2708a7(0x6b9)](_0x48a587=>'-\x20'+_0x48a587[_0x2708a7(0x596)])[_0x2708a7(0xb2c)]('\x0a'):_0x2708a7(0x572))+_0x2708a7(0x294)+(_0x12a4b6[_0x2708a7(0x33a)][_0x2708a7(0x567)]&&_0x12a4b6[_0x2708a7(0x33a)][_0x2708a7(0x567)]['length']>0x0?_0x12a4b6[_0x2708a7(0x33a)]['myAvatarLibrary'][_0x2708a7(0x6b9)](_0x4ced96=>'-\x20'+_0x4ced96[_0x2708a7(0x596)])[_0x2708a7(0xb2c)]('\x0a'):_0x2708a7(0x572))+'\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22url\x22:\x20\x22https://...表情URL...\x22,\x20\x22meaning\x22:\x20\x22(可选)表情含义\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a'+_0x12a4b6['settings'][_0x2708a7(0xbe8)]+_0x2708a7(0x7ed),_0x3384dc=_0x499582[_0x2708a7(0x6b9)](_0xc19770=>({'role':_0xc19770[_0x2708a7(0x14a)],'content':String(_0xc19770[_0x2708a7(0x168)])}));_0x3384dc[_0x2708a7(0xa49)]({'role':'user','content':_0x2708a7(0x78c)});let _0x54b87f=_0x218a71===GEMINI_API_URL,_0x4d13bb=_0x282b7e(_0x5b0d2a,_0x3c3506,_0x380cae,_0x3384dc);const _0x1c62d2=_0x54b87f?await fetch(_0x4d13bb[_0x2708a7(0x9d6)],_0x4d13bb[_0x2708a7(0x49a)]):await fetch(_0x218a71+_0x2708a7(0x5c1),{'method':_0x2708a7(0xcd0),'headers':{'Content-Type':_0x2708a7(0xcb6),'Authorization':_0x2708a7(0xf42)+_0x3c3506},'body':JSON[_0x2708a7(0x1175)]({'model':_0x5b0d2a,'messages':[{'role':'system','content':_0x380cae},..._0x3384dc],'temperature':_0x405767[_0x2708a7(0xb73)]['apiTemperature']||0.8})});if(!_0x1c62d2['ok']){const _0x16e0b0=await _0x1c62d2[_0x2708a7(0x7e9)]();throw new Error(_0x2708a7(0x1d9)+_0x16e0b0[_0x2708a7(0x7a3)]['message']);}const _0xcf6e8d=await _0x1c62d2['json'](),_0x37dfcf=getGeminiResponseText(_0xcf6e8d),_0x458a7b=_0x5196dd(_0x37dfcf),_0x451c1a=[];for(const _0x5ee2f3 of _0x458a7b){if(_0x5ee2f3[_0x2708a7(0xde0)]===_0x2708a7(0xbc6)&&typeof _0x5ee2f3[_0x2708a7(0x168)]==='string'&&_0x5ee2f3[_0x2708a7(0x168)]['includes']('\x0a')){const _0x1611a7=_0x5ee2f3[_0x2708a7(0x168)]['split'](/\n+/)[_0x2708a7(0x1d8)](_0x2679d4=>_0x2679d4['trim']());_0x1611a7[_0x2708a7(0x7c0)](_0x348521=>{_0x451c1a['push']({..._0x5ee2f3,'content':_0x348521});});}else _0x451c1a[_0x2708a7(0xa49)](_0x5ee2f3);}let _0xc60864=Date[_0x2708a7(0x1ed)]();for(const _0x4d718f of _0x451c1a){const _0xf9970b={'role':'assistant','senderName':_0x12a4b6['originalName'],'timestamp':_0xc60864++,'content':_0x4d718f[_0x2708a7(0x168)]||_0x4d718f['message'],'type':_0x4d718f['type']||_0x2708a7(0xbc6)};if(_0x4d718f[_0x2708a7(0xde0)]===_0x2708a7(0x894)){if(!_0x12a4b6[_0x2708a7(0x1000)]){if(_0x4d718f[_0x2708a7(0x10e1)])_0x12a4b6[_0x2708a7(0x211)]=String(_0x4d718f[_0x2708a7(0x10e1)]);if(_0x4d718f[_0x2708a7(0xe1f)])_0x12a4b6[_0x2708a7(0x103c)]=String(_0x4d718f[_0x2708a7(0xe1f)]);}continue;}_0x12a4b6[_0x2708a7(0xd39)][_0x2708a7(0xa49)](_0xf9970b),_0x5c5c92(_0xf9970b,_0x12a4b6),await new Promise(_0x12faab=>setTimeout(_0x12faab,Math[_0x2708a7(0x5b3)]()*0x3e8+0x320));}await _0x15043e['chats'][_0x2708a7(0xfaa)](_0x12a4b6),_0x2b55d1();}catch(_0x12d0e4){console['error'](_0x2708a7(0xf23),_0x12d0e4),await _0x501c7b(_0x2708a7(0xa85),_0x2708a7(0x436)+_0x12d0e4[_0x2708a7(0xc7d)]);}finally{_0x24fb6c(_0x12a4b6['id'],![]);if(!_0x12a4b6['isGroup']&&document['getElementById'](_0x2708a7(0x334))){const _0x5270f8=document['getElementById'](_0x2708a7(0x334));_0x5270f8[_0x2708a7(0x842)]['opacity']=0x0,setTimeout(()=>{const _0x5085a4=_0x2708a7;_0x5270f8[_0x5085a4(0x1090)]=_0x12a4b6[_0x5085a4(0x596)],_0x5270f8['classList'][_0x5085a4(0xaff)](_0x5085a4(0xce9)),_0x5270f8[_0x5085a4(0x842)][_0x5085a4(0x9d7)]=0x1;},0xc8);}}}function _0x36b53b(){const _0x413e01=_0x18b51e,_0x5e2ac0=document[_0x413e01(0x8c2)](_0x413e01(0x295)),_0x131ab1=_0x405767[_0x413e01(0xb73)][_0x413e01(0x595)]||_0x93749c;_0x131ab1&&_0x131ab1['trim']()&&(_0x5e2ac0[_0x413e01(0x939)]=_0x131ab1,_0x5e2ac0['play']()[_0x413e01(0x120c)](_0x5c64f7=>console['log'](_0x413e01(0xb80),_0x5c64f7)));}function _0x1a0ab7(){const _0x1facec=_0x18b51e;if(!_0x405767[_0x1facec(0xb73)][_0x1facec(0x1093)])return;for(const _0x2cc2e1 in _0x405767[_0x1facec(0xb73)][_0x1facec(0x1093)]){const _0x403e06=document[_0x1facec(0x8c2)](_0x2cc2e1),_0x38e75f=_0x405767[_0x1facec(0xb73)]['widgetData'][_0x2cc2e1];_0x403e06&&(_0x403e06['tagName']==='IMG'?_0x403e06[_0x1facec(0x939)]=_0x38e75f:_0x403e06[_0x1facec(0x1090)]=_0x38e75f);}}function _0x434b4d(){return new Promise(_0x417ac5=>{const _0x7bc8c2=_0x7a65,_0x386e8c=document[_0x7bc8c2(0x8c1)]('input');_0x386e8c['type']='file',_0x386e8c['accept']=_0x7bc8c2(0x6ec),_0x386e8c[_0x7bc8c2(0x8ad)]=_0x3a69ba=>{const _0x269f57=_0x7bc8c2,_0xaa5092=_0x3a69ba[_0x269f57(0x475)][_0x269f57(0xde8)][0x0];if(_0xaa5092){const _0x343b71=new FileReader();_0x343b71[_0x269f57(0xe7a)]=_0x190b46=>{_0x417ac5(_0x190b46['target']['result']);},_0x343b71['readAsDataURL'](_0xaa5092);}else _0x417ac5(null);},_0x386e8c[_0x7bc8c2(0xa17)]();});}async function _0x57118b(_0x22e67d){const _0x3a2180=_0x18b51e,_0x3723d7=_0x22e67d['id'],_0x5f4b74=_0x22e67d['textContent'],_0x5dba7e=await _0x180f74(_0x3a2180(0x8ae),'请输入新的内容：',_0x5f4b74);if(_0x5dba7e!==null&&_0x5dba7e[_0x3a2180(0x8c6)]()!==''){const _0x1e33bd=_0x5dba7e[_0x3a2180(0x8c6)]();_0x22e67d[_0x3a2180(0x1090)]=_0x1e33bd,_0x405767[_0x3a2180(0xb73)][_0x3a2180(0x1093)][_0x3723d7]=_0x1e33bd,await _0x15043e[_0x3a2180(0xb73)][_0x3a2180(0xfaa)](_0x405767[_0x3a2180(0xb73)]),alert(_0x3a2180(0x5e6));}}async function _0x15b93c(_0x20a3c0){const _0x1f0454=_0x18b51e,_0x20ea8f=_0x20a3c0['id'],_0x4a8901=await _0x40fef8(_0x1f0454(0x10eb),[{'text':_0x1f0454(0xf02),'value':'local'},{'text':_0x1f0454(0xf47),'value':_0x1f0454(0x9d6)}]);let _0x58beb1=null;if(_0x4a8901===_0x1f0454(0x6a0))_0x58beb1=await _0x434b4d();else _0x4a8901==='url'&&(_0x58beb1=await _0x180f74('修改图片',_0x1f0454(0x522),_0x20a3c0['src'],_0x1f0454(0x9d6)));if(_0x58beb1&&_0x58beb1['trim']()){const _0x455885=_0x58beb1[_0x1f0454(0x8c6)]();_0x20a3c0[_0x1f0454(0x939)]=_0x455885,_0x405767[_0x1f0454(0xb73)]['widgetData'][_0x20ea8f]=_0x455885,await _0x15043e[_0x1f0454(0xb73)][_0x1f0454(0xfaa)](_0x405767['globalSettings']),alert(_0x1f0454(0x1062));}else _0x4a8901===_0x1f0454(0x9d6)&&_0x58beb1!==null&&alert(_0x1f0454(0x1c6));}const _0x519dca={'getSongCache'(_0x37aac4,_0x4e8c15){const _0x5704ef=_0x18b51e,_0x20858f=(_0x4e8c15||_0x5704ef(0xe88))+':'+_0x37aac4;if(_0x405767[_0x5704ef(0xbb7)]&&_0x405767[_0x5704ef(0xbb7)]['songs']){const _0x1cafaf=_0x405767['cache']['songs']['get'](_0x20858f);if(_0x1cafaf&&Date[_0x5704ef(0x1ed)]()-_0x1cafaf['timestamp']<0x36ee80)return _0x1cafaf['data'];}return null;},'setSongCache'(_0x32baa1,_0x4c378a,_0x293a97){const _0x30d861=_0x18b51e,_0x11693f=(_0x293a97||'all')+':'+_0x32baa1;if(!_0x405767[_0x30d861(0xbb7)])_0x405767[_0x30d861(0xbb7)]={};if(!_0x405767[_0x30d861(0xbb7)][_0x30d861(0xda1)])_0x405767[_0x30d861(0xbb7)]['songs']=new Map();_0x405767[_0x30d861(0xbb7)][_0x30d861(0xda1)][_0x30d861(0xf5a)](_0x11693f,{'data':_0x4c378a,'timestamp':Date[_0x30d861(0x1ed)]()});}};typeof Http_Get_External===_0x18b51e(0x3df)&&(window[_0x18b51e(0xa48)]=function(_0x323513){return new Promise(_0x34075a=>{const _0x44b300=_0x7a65;fetch(_0x323513)['then'](_0x1bfd43=>_0x1bfd43['json']()[_0x44b300(0x120c)](()=>_0x1bfd43[_0x44b300(0xbc6)]()))[_0x44b300(0xc15)](_0x34075a)[_0x44b300(0x120c)](()=>_0x34075a(null));});});async function _0x1c0ce5(_0x18b27c){return await Http_Get_External(_0x18b27c);}function _0x426912(_0x3b7971){return new Promise(_0x2c19a4=>{const _0x1252de=_0x7a65,_0x5567bd=new Audio();_0x5567bd['addEventListener'](_0x1252de(0xbb2),()=>_0x2c19a4(!![]),{'once':!![]}),_0x5567bd[_0x1252de(0xae8)](_0x1252de(0x7a3),()=>_0x2c19a4(![]),{'once':!![]}),_0x5567bd['src']=_0x3b7971;});}async function _0x3141b5(_0xcfa60a,_0x5477f6){const _0x1f2053=_0x18b51e;try{let _0x3c051b=_0xcfa60a['replace'](/\s/g,'');_0x5477f6&&(_0x3c051b+='\x20'+_0x5477f6[_0x1f2053(0x1b7)](/\s/g,''));const _0x2bf272=_0x1f2053(0x189)+encodeURIComponent(_0x3c051b);console[_0x1f2053(0x32b)](_0x1f2053(0x513),_0x2bf272);const _0x28ef89=await fetch(_0x2bf272);if(!_0x28ef89['ok'])throw new Error(_0x1f2053(0xff6)+_0x28ef89[_0x1f2053(0x8c8)]);const _0x49ba93=await _0x28ef89['json']();if(_0x49ba93['code']!==0xc8||!_0x49ba93[_0x1f2053(0x49a)]||_0x49ba93[_0x1f2053(0x49a)]['length']===0x0)return console[_0x1f2053(0x32b)](_0x1f2053(0xe63),_0x49ba93),[];return _0x49ba93[_0x1f2053(0x49a)][_0x1f2053(0x6b9)](_0x14f379=>({'name':_0x14f379[_0x1f2053(0x776)],'artist':_0x14f379[_0x1f2053(0x1024)],'id':_0x14f379['id'],'cover':_0x14f379[_0x1f2053(0xcf0)]||_0x1f2053(0x292),'source':_0x1f2053(0xb19)}))[_0x1f2053(0x961)](0x0,0x1e);}catch(_0xd62c52){return console[_0x1f2053(0x7a3)]('网易云音乐搜索失败:',_0xd62c52),[];}}async function _0x168471(_0x471d8a){const _0x5abc1f=_0x18b51e;try{_0x471d8a=_0x471d8a['replace'](/\s/g,'');const _0x20c9c3=await _0x1c0ce5(_0x5abc1f(0xd8d)+encodeURIComponent(_0x471d8a));if(!_0x20c9c3?.['data']?.[_0x5abc1f(0x105a)])return[];return _0x20c9c3[_0x5abc1f(0x49a)][_0x5abc1f(0x6b9)](_0x111fbd=>({'name':_0x111fbd[_0x5abc1f(0x776)],'artist':_0x111fbd[_0x5abc1f(0x1024)],'id':_0x111fbd['id'],'cover':_0x111fbd[_0x5abc1f(0xcf0)]||_0x5abc1f(0x1be),'source':_0x5abc1f(0x1142)}))[_0x5abc1f(0x961)](0x0,0x1e);}catch(_0x171612){return console['error'](_0x5abc1f(0x46f),_0x171612),[];}}async function _0x145ea5(){const _0x8d76ae=_0x18b51e,_0x3c9076=await _0x180f74(_0x8d76ae(0x10b3),_0x8d76ae(0xef6));if(!_0x3c9076||!_0x3c9076[_0x8d76ae(0x8c6)]())return;await _0x501c7b('请稍候...','正在全网搜索歌曲资源...');let _0x5ce3e4=_0x3c9076[_0x8d76ae(0x8c6)](),_0x243d0a='';if(_0x3c9076[_0x8d76ae(0x773)]('-')||_0x3c9076['includes']('–')){const _0x2dd20e=_0x3c9076[_0x8d76ae(0x111f)](/[-–]/);_0x5ce3e4=_0x2dd20e[0x0]['trim'](),_0x243d0a=_0x2dd20e['slice'](0x1)[_0x8d76ae(0xb2c)]('\x20')[_0x8d76ae(0x8c6)]();}const [_0x386d8,_0x98a71c]=await Promise['all']([_0x3141b5(_0x5ce3e4,_0x243d0a),_0x168471(_0x5ce3e4)]),_0x5ca55a=[..._0x386d8,..._0x98a71c];if(_0x5ca55a[_0x8d76ae(0x105a)]===0x0){await _0x501c7b('无结果',_0x8d76ae(0xecf));return;}const _0x266f21=document[_0x8d76ae(0x8c2)]('music-search-results-modal'),_0x1dfdbd=document['getElementById'](_0x8d76ae(0x47a));_0x1dfdbd[_0x8d76ae(0xca0)]='',document['getElementById'](_0x8d76ae(0x5f0))[_0x8d76ae(0x75f)]=![],_0x5ca55a[_0x8d76ae(0x7c0)](_0x46240e=>{const _0x547d02=_0x8d76ae,_0xa96ed6=document[_0x547d02(0x8c1)](_0x547d02(0x1072));_0xa96ed6[_0x547d02(0x84c)]='search-result-item',_0xa96ed6[_0x547d02(0x323)]['songJson']=JSON[_0x547d02(0x1175)](_0x46240e),_0xa96ed6[_0x547d02(0xca0)]=_0x547d02(0x286)+_0x46240e[_0x547d02(0x596)]+_0x547d02(0x8f9)+_0x46240e[_0x547d02(0x7af)]+'\x20<span\x20class=\x22source\x22>'+(_0x46240e[_0x547d02(0xbf5)]===_0x547d02(0xb19)?_0x547d02(0x9be):_0x547d02(0x214))+_0x547d02(0x114c),_0x1dfdbd[_0x547d02(0x31e)](_0xa96ed6);}),_0x266f21['classList']['add']('visible');}async function _0x544e17(_0x55c318){const _0x31bec0=_0x18b51e;let _0x4412d8=null,_0x4560f2=_0x55c318[_0x31bec0(0xbf5)];const _0x58c490=_0x55c318[_0x31bec0(0xbf5)]===_0x31bec0(0xb19)?_0x31bec0(0x56d)+_0x55c318['id']:_0x31bec0(0xf0b)+_0x55c318['id'];let _0x5a4caa=await _0x1c0ce5(_0x58c490);_0x5a4caa?.['data']?.['url']&&(_0x4412d8={'url':_0x5a4caa[_0x31bec0(0x49a)][_0x31bec0(0x9d6)],'id':_0x55c318['id'],'source':_0x55c318[_0x31bec0(0xbf5)]});if(!_0x4412d8){const _0x4a36e2=_0x55c318['source']===_0x31bec0(0xb19)?'tencent':_0x31bec0(0xb19),_0x502849=_0x4a36e2===_0x31bec0(0x1142)?await _0x168471(_0x55c318[_0x31bec0(0x596)]):await _0x3141b5(_0x55c318[_0x31bec0(0x596)],_0x55c318['artist']);if(_0x502849['length']>0x0){const _0xef0a25=_0x4a36e2===_0x31bec0(0xb19)?_0x31bec0(0x56d)+_0x502849[0x0]['id']:'https://api.vkeys.cn/v2/music/tencent?id='+_0x502849[0x0]['id'],_0x45da72=await _0x1c0ce5(_0xef0a25);_0x45da72?.[_0x31bec0(0x49a)]?.[_0x31bec0(0x9d6)]&&(_0x4412d8={'url':_0x45da72['data']['url'],'id':_0x502849[0x0]['id'],'source':_0x4a36e2},_0x4560f2=_0x4a36e2);}}if(_0x4412d8){_0x4412d8[_0x31bec0(0x9d6)]&&typeof _0x4412d8['url']===_0x31bec0(0xf1b)&&(_0x4412d8[_0x31bec0(0x9d6)]=_0x4412d8['url']['replace'](/^http:\/\//i,_0x31bec0(0xe1b)));_0x55c318[_0x31bec0(0xcf0)]&&typeof _0x55c318[_0x31bec0(0xcf0)]===_0x31bec0(0xf1b)&&(_0x55c318[_0x31bec0(0xcf0)]=_0x55c318[_0x31bec0(0xcf0)][_0x31bec0(0x1b7)](/^http:\/\//i,_0x31bec0(0xe1b)));const _0x4762fb=await _0x2b7b85(_0x4412d8['id'],_0x4560f2)||'';return{'name':_0x55c318[_0x31bec0(0x596)],'artist':_0x55c318[_0x31bec0(0x7af)],'src':_0x4412d8[_0x31bec0(0x9d6)],'cover':_0x55c318[_0x31bec0(0xcf0)],'isLocal':![],'lrcContent':_0x4762fb};}return null;}async function _0x2b7b85(_0x3194e0,_0x450351){const _0x11d107=_0x18b51e,_0x368fd8=_0x450351===_0x11d107(0xb19)?_0x11d107(0xb06)+_0x3194e0:_0x11d107(0x51c)+_0x3194e0,_0x38def5=await _0x1c0ce5(_0x368fd8);if(_0x38def5?.['data']){const _0x2f8052=_0x38def5['data'][_0x11d107(0x804)]||_0x38def5[_0x11d107(0x49a)][_0x11d107(0x10be)]||'',_0x458e5e=_0x38def5['data'][_0x11d107(0x568)]||_0x38def5['data']['tlyric']||'';return _0x2f8052+'\x0a'+_0x458e5e;}return'';}async function _0x12b922(_0x36dc6c){const _0x36291a=_0x18b51e;if(_0x36dc6c<0x0||_0x36dc6c>=_0x4a77e1[_0x36291a(0xcfa)][_0x36291a(0x105a)])return;const _0x1ef781=await _0x40fef8('选择歌词导入方式',[{'text':_0x36291a(0x1d4),'value':_0x36291a(0xf0a)},{'text':'📋\x20直接粘贴歌词文本','value':_0x36291a(0x258)}]);let _0x5bb330=null;if(_0x1ef781===_0x36291a(0xf0a))_0x5bb330=await new Promise(_0x375540=>{const _0x4b56ce=_0x36291a,_0x22f8c9=document[_0x4b56ce(0x8c2)]('lrc-upload-input'),_0x2128bc=_0x54b952=>{const _0xdc729c=_0x4b56ce,_0x25ff16=_0x54b952[_0xdc729c(0x475)][_0xdc729c(0xde8)][0x0];if(_0x25ff16){const _0x100427=new FileReader();_0x100427[_0xdc729c(0xe7a)]=_0x119a61=>_0x375540(_0x119a61[_0xdc729c(0x475)][_0xdc729c(0xa92)]),_0x100427['onerror']=()=>_0x375540(null),_0x100427[_0xdc729c(0x2d0)](_0x25ff16);}else _0x375540(null);_0x22f8c9[_0xdc729c(0x2b2)]('change',_0x2128bc),_0x22f8c9[_0xdc729c(0x518)]='';};_0x22f8c9[_0x4b56ce(0xae8)](_0x4b56ce(0x7a7),_0x2128bc,{'once':!![]}),_0x22f8c9[_0x4b56ce(0xa17)]();});else{if(_0x1ef781===_0x36291a(0x258)){const _0x19a866=await _0x180f74(_0x36291a(0xc4b),_0x36291a(0xdcb),'',_0x36291a(0x6c3));if(_0x19a866)_0x5bb330=_0x19a866[_0x36291a(0x1b7)](/\[/g,'\x0a[')['trim']();}}_0x5bb330!==null&&(_0x4a77e1['playlist'][_0x36dc6c][_0x36291a(0xb07)]=_0x5bb330,await _0x2b48e0(),_0x4a77e1['currentIndex']===_0x36dc6c&&(_0x4a77e1[_0x36291a(0x619)]=_0x584f3f(_0x5bb330),_0x542c77(),_0x57987f()),await _0x501c7b('成功','《'+_0x4a77e1[_0x36291a(0xcfa)][_0x36dc6c][_0x36291a(0x596)]+_0x36291a(0x723)));}async function _0x3ce539(){const _0x24f65f=_0x18b51e;if(_0x4a77e1[_0x24f65f(0x585)]===-0x1)return;const _0x18d6a6=_0x4a77e1[_0x24f65f(0xcfa)][_0x4a77e1['currentIndex']];if(!_0x18d6a6)return;_0x18d6a6['isBgClear']=!_0x18d6a6[_0x24f65f(0x641)],await _0x2b48e0();const _0xd9a904=document[_0x24f65f(0x1ad)]('.music-player-window'),_0x4571a2=document[_0x24f65f(0x8c2)]('toggle-blur-btn');_0xd9a904[_0x24f65f(0xb17)]['toggle'](_0x24f65f(0xbf9),_0x18d6a6[_0x24f65f(0x641)]),_0x4571a2[_0x24f65f(0xb17)]['toggle'](_0x24f65f(0x71b),_0x18d6a6[_0x24f65f(0x641)]);}function _0x4852f1(){const _0x162afe=_0x18b51e,_0x5571e8=document[_0x162afe(0x8c2)](_0x162afe(0x3f8)),_0x2c976f=document['getElementById'](_0x162afe(0x38f));_0x5571e8&&_0x2c976f&&(_0x5571e8['classList'][_0x162afe(0xfc3)](_0x162afe(0x2cd)),_0x2c976f[_0x162afe(0xb17)]['toggle'](_0x162afe(0x71b)));}function _0x1d4815(){const _0x3930fa=_0x18b51e,_0x3b649a=document[_0x3930fa(0x1ad)](_0x3930fa(0xb55)),_0x39208f=document[_0x3930fa(0x8c2)](_0x3930fa(0x1df));_0x3b649a&&_0x39208f&&(_0x3b649a['classList'][_0x3930fa(0xfc3)](_0x3930fa(0x8ba)),_0x39208f[_0x3930fa(0xb17)][_0x3930fa(0xfc3)](_0x3930fa(0x897)));}window['togglePlayerFullscreen']=_0x1d4815;async function _0x16548e(){const _0x968989=_0x18b51e;if(_0x4a77e1[_0x968989(0xcfa)][_0x968989(0x105a)]===0x0){alert('播放列表是空的，无需清理。');return;}const _0xf21e08=await _0x8b9cb8(_0x968989(0xd71),'此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。',{'confirmText':'开始清理'});if(!_0xf21e08)return;await _0x501c7b(_0x968989(0x1047),_0x968989(0xec3)+_0x4a77e1[_0x968989(0xcfa)]['length']+_0x968989(0x9b9));const _0x72e0de=_0x4a77e1[_0x968989(0xcfa)][_0x968989(0x105a)],_0x59de66=[],_0xb85792=[],_0x344afd=_0x4a77e1[_0x968989(0xcfa)][_0x968989(0x6b9)](async _0x24e020=>{const _0x20bd9c=_0x968989;if(_0x24e020[_0x20bd9c(0xc6b)]){_0x59de66[_0x20bd9c(0xa49)](_0x24e020);return;}const _0x4f9264=await _0x426912(_0x24e020[_0x20bd9c(0x939)]);_0x4f9264?_0x59de66['push'](_0x24e020):(_0xb85792['push'](_0x24e020[_0x20bd9c(0x596)]),console[_0x20bd9c(0x112a)](_0x20bd9c(0x10d7)+_0x24e020[_0x20bd9c(0x596)]+'\x20-\x20'+_0x24e020[_0x20bd9c(0x939)]));});await Promise[_0x968989(0xe88)](_0x344afd);const _0x3d4ca4=_0x72e0de-_0x59de66['length'];if(_0x3d4ca4>0x0){const _0x4c3919=_0x4a77e1[_0x968989(0xcfa)][_0x4a77e1[_0x968989(0x585)]],_0x3ea960=_0xb85792[_0x968989(0x773)](_0x4c3919?.[_0x968989(0x596)]);_0x4a77e1[_0x968989(0xcfa)]=_0x59de66,await _0x2b48e0();if(_0x3ea960)_0x3fd13b['pause'](),_0x3fd13b[_0x968989(0x939)]='',_0x4a77e1[_0x968989(0x585)]=_0x4a77e1[_0x968989(0xcfa)]['length']>0x0?0x0:-0x1,_0x4a77e1[_0x968989(0x219)]=![];else _0x4c3919&&(_0x4a77e1[_0x968989(0x585)]=_0x4a77e1[_0x968989(0xcfa)][_0x968989(0x1149)](_0x3ea438=>_0x3ea438['src']===_0x4c3919[_0x968989(0x939)]));_0x3439d6(),_0x59d0b7(),await _0x501c7b(_0x968989(0x315),_0x968989(0x55b)+_0x3d4ca4+'\x20首无效歌曲:\x0a\x0a-\x20'+_0xb85792[_0x968989(0xb2c)](_0x968989(0x154)));}else await _0x501c7b('检查完成','所有歌曲链接均有效，无需清理！');}function _0x48f995(){const _0x13adfa=_0x18b51e,_0x20f828=document[_0x13adfa(0x8c2)]('phone-screen');_0x20f828[_0x13adfa(0xb17)][_0x13adfa(0xfc3)](_0x13adfa(0x425),!!_0x405767[_0x13adfa(0xb73)][_0x13adfa(0x1286)]);}async function _0x90e4b2(){const _0x50fb4b=_0x18b51e,_0x263e97=document['getElementById'](_0x50fb4b(0x1283)),_0x60a266=document[_0x50fb4b(0x8c2)](_0x50fb4b(0x114b));_0x60a266[_0x50fb4b(0xca0)]='';const _0x3056f6=[];_0x3056f6[_0x50fb4b(0xa49)]({'text':_0x50fb4b(0x523),'value':_0x50fb4b(0xe88),'isDanger':!![]});const _0x2ca726=_0x405767[_0x50fb4b(0x20a)][_0x50fb4b(0xab3)]||'我';_0x3056f6['push']({'text':_0x50fb4b(0x1bb)+_0x2ca726+_0x50fb4b(0x10a9),'value':_0x50fb4b(0x74b)}),Object['values'](_0x405767[_0x50fb4b(0x799)])['forEach'](_0x23be2a=>{const _0x1fba3f=_0x50fb4b;!_0x23be2a[_0x1fba3f(0x1000)]&&_0x3056f6[_0x1fba3f(0xa49)]({'text':_0x1fba3f(0x1bb)+_0x23be2a['name']+_0x1fba3f(0x821),'value':_0x23be2a['id']});});try{const _0x1222bd=await _0x15043e['npcs'][_0x50fb4b(0x6be)]();_0x1222bd[_0x50fb4b(0x105a)]>0x0&&(_0x3056f6[_0x50fb4b(0xa49)]({'isSeparator':!![],'text':'NPC\x20列表'}),_0x1222bd[_0x50fb4b(0x7c0)](_0x50a424=>{const _0x435c4d=_0x50fb4b;_0x3056f6['push']({'text':_0x435c4d(0x1bb)+_0x50a424[_0x435c4d(0x596)]+_0x435c4d(0xe8d),'value':_0x435c4d(0x5ea)+_0x50a424['id']});}));}catch(_0x3ea369){console[_0x50fb4b(0x7a3)]('加载NPC列表失败:',_0x3ea369);}_0x3056f6[_0x50fb4b(0x7c0)](_0x3702cf=>{const _0x1c12cd=_0x50fb4b;if(_0x3702cf['isSeparator']){const _0xc13c5=document[_0x1c12cd(0x8c1)](_0x1c12cd(0x1072));_0xc13c5[_0x1c12cd(0x1090)]=_0x3702cf['text'],_0xc13c5[_0x1c12cd(0x842)][_0x1c12cd(0x1d0)]=_0x1c12cd(0xe32),_0x60a266[_0x1c12cd(0x31e)](_0xc13c5);return;}const _0x540dd5=document[_0x1c12cd(0x8c1)](_0x1c12cd(0x1072));_0x540dd5[_0x1c12cd(0x84c)]='clear-posts-item',_0x3702cf[_0x1c12cd(0xe27)]&&_0x540dd5['classList'][_0x1c12cd(0x3f4)](_0x1c12cd(0x113e)),_0x540dd5['dataset']['targetId']=_0x3702cf['value'],_0x540dd5[_0x1c12cd(0xca0)]=_0x1c12cd(0xa3f)+_0x3702cf['text']+_0x1c12cd(0x10e2),_0x60a266[_0x1c12cd(0x31e)](_0x540dd5);}),_0x263e97[_0x50fb4b(0xb17)][_0x50fb4b(0x3f4)]('visible');}async function _0x1d907c(){const _0x5017e0=_0x18b51e,_0x1f4b1a=document[_0x5017e0(0xa2d)]('#clear-posts-list\x20.clear-posts-item.selected');if(_0x1f4b1a[_0x5017e0(0x105a)]===0x0){alert(_0x5017e0(0x70a));return;}const _0x2141bb=Array[_0x5017e0(0x51a)](_0x1f4b1a)[_0x5017e0(0x6b9)](_0x2c7977=>_0x2c7977[_0x5017e0(0x323)][_0x5017e0(0x2d7)]);let _0x3fa651=[];_0x2141bb[_0x5017e0(0x773)](_0x5017e0(0xe88))?_0x3fa651[_0x5017e0(0xa49)]('所有动态'):(_0x2141bb['includes'](_0x5017e0(0x74b))&&_0x3fa651[_0x5017e0(0xa49)]('“'+_0x405767[_0x5017e0(0x20a)][_0x5017e0(0xab3)]+'”'),_0x2141bb[_0x5017e0(0x7c0)](_0x27b330=>{const _0x37b942=_0x5017e0,_0x396ade=_0x405767[_0x37b942(0x799)][_0x27b330];_0x396ade&&_0x3fa651['push']('“'+_0x396ade[_0x37b942(0x596)]+'”');}));const _0x2fdc62='此操作将永久删除\x20'+_0x3fa651[_0x5017e0(0xb2c)]('、\x20')+_0x5017e0(0xbc7),_0x4811b0=await _0x8b9cb8(_0x5017e0(0x18e),_0x2fdc62,{'confirmButtonClass':_0x5017e0(0xe2a),'confirmText':_0x5017e0(0x794)});if(!_0x4811b0)return;try{_0x2141bb[_0x5017e0(0x773)](_0x5017e0(0xe88))?await _0x15043e[_0x5017e0(0xcc0)]['clear']():await _0x15043e[_0x5017e0(0xcc0)][_0x5017e0(0xdb8)](_0x5017e0(0x802))[_0x5017e0(0xdf0)](_0x2141bb)[_0x5017e0(0x89f)](),_0x3c4d9a=await _0x15043e[_0x5017e0(0xcc0)][_0x5017e0(0x731)](_0x5017e0(0x351))[_0x5017e0(0x1c0)]()[_0x5017e0(0x6be)](),_0x37c049=0x0,await _0xa34c48(),document[_0x5017e0(0x8c2)](_0x5017e0(0x1283))[_0x5017e0(0xb17)][_0x5017e0(0xaff)]('visible'),await _0x501c7b('操作成功',_0x5017e0(0xa12));}catch(_0x4f90e2){console[_0x5017e0(0x7a3)](_0x5017e0(0x9d9),_0x4f90e2),await _0x501c7b('操作失败','清空动态时发生错误:\x20'+_0x4f90e2[_0x5017e0(0xc7d)]);}}async function _0x58cbb9(_0xc62d56){const _0x102952=_0x18b51e,_0x4d0fc7=await _0x8b9cb8(_0x102952(0xad9),_0x102952(0x3d9),{'confirmButtonClass':'btn-danger','confirmText':_0x102952(0xad9)});if(_0x4d0fc7){const _0x30a817=_0x405767[_0x102952(0x799)][_0x405767['activeChatId']];if(!_0x30a817||!_0x30a817[_0x102952(0x120b)])return;_0x30a817[_0x102952(0x120b)]=_0x30a817[_0x102952(0x120b)]['filter'](_0x2bdf7e=>_0x2bdf7e['timestamp']!==_0xc62d56),await _0x15043e[_0x102952(0x799)]['put'](_0x30a817),_0x1a6bfa(),await _0x501c7b('成功',_0x102952(0x61b));}}document[_0x18b51e(0x8c2)](_0x18b51e(0x125d))[_0x18b51e(0xae8)]('click',_0x5919d1=>{const _0x14c609=_0x18b51e,_0x323654=_0x5919d1[_0x14c609(0x475)][_0x14c609(0xa90)](_0x14c609(0xd0d));if(_0x323654){const _0x5c467b=parseInt(_0x323654[_0x14c609(0x323)][_0x14c609(0x351)]);!isNaN(_0x5c467b)&&_0x58cbb9(_0x5c467b);}});async function _0x3c6828(){const _0x867659=_0x18b51e,_0x5346f1=document[_0x867659(0x8c2)](_0x867659(0x784));_0x5346f1[_0x867659(0xca0)]='<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>';const _0x39e01c=await _0x15043e[_0x867659(0x73c)][_0x867659(0xdb8)]('type')['equals']('global_css')[_0x867659(0x6be)]();_0x39e01c[_0x867659(0x7c0)](_0x581a29=>{const _0x2d08d6=_0x867659,_0x17d39e=document[_0x2d08d6(0x8c1)](_0x2d08d6(0x4f3));_0x17d39e[_0x2d08d6(0x518)]=_0x581a29['id'],_0x17d39e[_0x2d08d6(0x1090)]=_0x581a29[_0x2d08d6(0x596)],_0x5346f1[_0x2d08d6(0x31e)](_0x17d39e);});}async function _0x4dcfbf(){const _0x585b6f=_0x18b51e,_0xda07fe=document[_0x585b6f(0x8c2)](_0x585b6f(0x784)),_0x1a793c=parseInt(_0xda07fe[_0x585b6f(0x518)]);if(isNaN(_0x1a793c))return;const _0x2603e6=await _0x15043e[_0x585b6f(0x73c)][_0x585b6f(0x3e9)](_0x1a793c);if(_0x2603e6){const _0x48d053=document[_0x585b6f(0x8c2)]('global-css-input');_0x48d053[_0x585b6f(0x518)]=_0x2603e6[_0x585b6f(0x518)],_0x3b4393(_0x2603e6[_0x585b6f(0x518)]);}}async function _0x55768d(){const _0x5667fc=_0x18b51e,_0x57d040=await _0x180f74(_0x5667fc(0x1eb),_0x5667fc(0x542));if(!_0x57d040||!_0x57d040[_0x5667fc(0x8c6)]())return;const _0x48d54b=document['getElementById'](_0x5667fc(0x681))[_0x5667fc(0x518)],_0x5bf2fa=await _0x15043e[_0x5667fc(0x73c)]['where']({'name':_0x57d040[_0x5667fc(0x8c6)](),'type':'global_css'})[_0x5667fc(0xf2e)]();if(_0x5bf2fa){const _0xe9d453=await _0x8b9cb8('覆盖预设',_0x5667fc(0xdbf)+_0x57d040[_0x5667fc(0x8c6)]()+_0x5667fc(0xbef),{'confirmButtonClass':_0x5667fc(0xe2a)});if(!_0xe9d453)return;await _0x15043e[_0x5667fc(0x73c)]['update'](_0x5bf2fa['id'],{'value':_0x48d54b});}else await _0x15043e[_0x5667fc(0x73c)]['add']({'name':_0x57d040[_0x5667fc(0x8c6)](),'type':_0x5667fc(0x1052),'value':_0x48d54b});await _0x3c6828(),alert(_0x5667fc(0x109b));}async function _0x519a83(){const _0x3a1545=_0x18b51e,_0x352e79=document[_0x3a1545(0x8c2)](_0x3a1545(0x784)),_0xa56591=parseInt(_0x352e79[_0x3a1545(0x518)]);if(isNaN(_0xa56591)){alert(_0x3a1545(0x1264));return;}const _0x48ab03=await _0x15043e[_0x3a1545(0x73c)]['get'](_0xa56591);if(!_0x48ab03)return;const _0x4fb73c=await _0x8b9cb8(_0x3a1545(0x1c8),'确定要删除预设\x20“'+_0x48ab03[_0x3a1545(0x596)]+_0x3a1545(0x119f),{'confirmButtonClass':_0x3a1545(0xe2a)});_0x4fb73c&&(await _0x15043e['appearancePresets'][_0x3a1545(0x89f)](_0xa56591),await _0x3c6828(),alert(_0x3a1545(0x1b5)));}async function _0x180194(){const _0x4c12e0=_0x18b51e,_0x8acb05=document[_0x4c12e0(0x8c2)](_0x4c12e0(0x10e4));_0x8acb05[_0x4c12e0(0xca0)]=_0x4c12e0(0x8c5);const _0x223085=await _0x15043e[_0x4c12e0(0x73c)][_0x4c12e0(0xdb8)](_0x4c12e0(0xde0))[_0x4c12e0(0xc9a)](_0x4c12e0(0x11f1))['toArray']();_0x223085[_0x4c12e0(0x7c0)](_0x3c7b3=>{const _0x3c748d=_0x4c12e0,_0x3dad83=document[_0x3c748d(0x8c1)](_0x3c748d(0x4f3));_0x3dad83[_0x3c748d(0x518)]=_0x3c7b3['id'],_0x3dad83['textContent']=_0x3c7b3[_0x3c748d(0x596)],_0x8acb05[_0x3c748d(0x31e)](_0x3dad83);});}async function _0xe1591(){const _0x3d9c06=_0x18b51e,_0x4e6a2b=document[_0x3d9c06(0x8c2)](_0x3d9c06(0x10e4)),_0x4ac0df=parseInt(_0x4e6a2b[_0x3d9c06(0x518)]);if(isNaN(_0x4ac0df))return;const _0x267c72=await _0x15043e[_0x3d9c06(0x73c)][_0x3d9c06(0x3e9)](_0x4ac0df);if(_0x267c72){const _0x20e14=document[_0x3d9c06(0x8c2)](_0x3d9c06(0x430));_0x20e14[_0x3d9c06(0x518)]=_0x267c72[_0x3d9c06(0x518)],_0x218332(_0x267c72['value'],!![]);}}async function _0x302322(){const _0xd778f=_0x18b51e,_0x346277=await _0x180f74(_0xd778f(0x437),_0xd778f(0x542));if(!_0x346277||!_0x346277[_0xd778f(0x8c6)]())return;const _0x5f0850=document['getElementById'](_0xd778f(0x430))[_0xd778f(0x518)][_0xd778f(0x8c6)]();if(!_0x5f0850){alert(_0xd778f(0x11e8));return;}const _0x2508be=await _0x15043e[_0xd778f(0x73c)][_0xd778f(0xdb8)]({'name':_0x346277[_0xd778f(0x8c6)](),'type':_0xd778f(0x11f1)})[_0xd778f(0xf2e)]();if(_0x2508be){const _0x5457e3=await _0x8b9cb8(_0xd778f(0x9fc),_0xd778f(0xdbf)+_0x346277['trim']()+_0xd778f(0xbef),{'confirmButtonClass':_0xd778f(0xe2a)});if(!_0x5457e3)return;await _0x15043e['appearancePresets']['update'](_0x2508be['id'],{'value':_0x5f0850});}else await _0x15043e[_0xd778f(0x73c)]['add']({'name':_0x346277['trim'](),'type':_0xd778f(0x11f1),'value':_0x5f0850});await _0x180194(),alert(_0xd778f(0xfd1));}async function _0x4b58e8(){const _0x4f3d86=_0x18b51e,_0x5ac1a2=document[_0x4f3d86(0x8c2)](_0x4f3d86(0x10e4)),_0x5eb44d=parseInt(_0x5ac1a2[_0x4f3d86(0x518)]);if(isNaN(_0x5eb44d)){alert('请先从下拉框中选择一个要删除的预设。');return;}const _0x1d387c=await _0x15043e[_0x4f3d86(0x73c)][_0x4f3d86(0x3e9)](_0x5eb44d);if(!_0x1d387c)return;const _0x3f6e52=await _0x8b9cb8(_0x4f3d86(0x1c8),'确定要删除预设\x20“'+_0x1d387c[_0x4f3d86(0x596)]+_0x4f3d86(0x119f),{'confirmButtonClass':_0x4f3d86(0xe2a)});_0x3f6e52&&(await _0x15043e[_0x4f3d86(0x73c)]['delete'](_0x5eb44d),await _0x180194(),alert(_0x4f3d86(0x1b5)));}async function _0x52184c(){const _0x124ca4=_0x18b51e,_0x5c3960=document[_0x124ca4(0x8c2)](_0x124ca4(0x9cb));_0x5c3960[_0x124ca4(0xca0)]=_0x124ca4(0x8c5);const _0x52ac42=await _0x15043e[_0x124ca4(0x73c)][_0x124ca4(0xdb8)](_0x124ca4(0xde0))[_0x124ca4(0xc9a)](_0x124ca4(0x937))[_0x124ca4(0x6be)]();_0x52ac42[_0x124ca4(0x7c0)](_0x53bcda=>{const _0x4bd22a=_0x124ca4,_0x54e2cf=document[_0x4bd22a(0x8c1)](_0x4bd22a(0x4f3));_0x54e2cf[_0x4bd22a(0x518)]=_0x53bcda['id'],_0x54e2cf[_0x4bd22a(0x1090)]=_0x53bcda[_0x4bd22a(0x596)],_0x5c3960[_0x4bd22a(0x31e)](_0x54e2cf);});const _0x2c4acd={'wallpaper':_0x405767[_0x124ca4(0xb73)][_0x124ca4(0xc3a)],'cphoneWallpaper':_0x405767[_0x124ca4(0xb73)][_0x124ca4(0x64a)],'globalChatBackground':_0x405767['globalSettings'][_0x124ca4(0xdea)],'appIcons':_0x405767[_0x124ca4(0xb73)]['appIcons'],'cphoneAppIcons':_0x405767[_0x124ca4(0xb73)][_0x124ca4(0x429)],'chatActionButtonsOrder':_0x405767[_0x124ca4(0xb73)]['chatActionButtonsOrder'],'theme':localStorage[_0x124ca4(0xf13)](_0x124ca4(0xab1))||'light','showStatusBar':_0x405767['globalSettings'][_0x124ca4(0x1286)],'notificationSoundUrl':_0x405767['globalSettings'][_0x124ca4(0x595)],'widgetData':_0x405767[_0x124ca4(0xb73)]['widgetData']};let _0x2d417b=null;for(const _0x1fee26 of _0x52ac42){if(JSON[_0x124ca4(0x1175)](_0x1fee26[_0x124ca4(0x518)])===JSON['stringify'](_0x2c4acd)){_0x2d417b=_0x1fee26['id'];break;}}_0x2d417b?_0x5c3960[_0x124ca4(0x518)]=_0x2d417b:_0x5c3960[_0x124ca4(0x518)]='';}async function _0x1c4776(){const _0x2ca482=_0x18b51e,_0xdc1695=document[_0x2ca482(0x8c2)](_0x2ca482(0x9cb)),_0x21961c=parseInt(_0xdc1695[_0x2ca482(0x518)]);if(isNaN(_0x21961c))return;const _0x57ea81=await _0x15043e[_0x2ca482(0x73c)][_0x2ca482(0x3e9)](_0x21961c);if(_0x57ea81&&_0x57ea81[_0x2ca482(0x518)]){const _0x371cc0=_0x57ea81[_0x2ca482(0x518)];Object[_0x2ca482(0xc28)](_0x405767['globalSettings'],_0x371cc0),_0x569569(_0x371cc0[_0x2ca482(0xf95)]||_0x2ca482(0xa14)),await _0x15043e[_0x2ca482(0xb73)][_0x2ca482(0xfaa)](_0x405767[_0x2ca482(0xb73)]),_0x1017e4(),_0x5f1ba2(),_0x1ff3cc(),_0xf3d9cb(),_0x48f995(),_0x1a0ab7(),_0x519e14(),alert(_0x2ca482(0xd58)+_0x57ea81[_0x2ca482(0x596)]+'”');}}async function _0x1e9d04(){const _0x1346b5=_0x18b51e,_0x69fbe8=await _0x180f74(_0x1346b5(0xf3c),_0x1346b5(0x542));if(!_0x69fbe8||!_0x69fbe8['trim']())return;const _0x1889fa={'wallpaper':_0x405767[_0x1346b5(0xb73)][_0x1346b5(0xc3a)],'cphoneWallpaper':_0x405767[_0x1346b5(0xb73)][_0x1346b5(0x64a)],'globalChatBackground':_0x405767[_0x1346b5(0xb73)]['globalChatBackground'],'appIcons':_0x405767[_0x1346b5(0xb73)][_0x1346b5(0x18d)],'cphoneAppIcons':_0x405767[_0x1346b5(0xb73)]['cphoneAppIcons'],'chatActionButtonsOrder':_0x405767[_0x1346b5(0xb73)][_0x1346b5(0x54e)],'theme':localStorage[_0x1346b5(0xf13)](_0x1346b5(0xab1))||_0x1346b5(0xa14),'showStatusBar':_0x405767[_0x1346b5(0xb73)][_0x1346b5(0x1286)],'notificationSoundUrl':_0x405767[_0x1346b5(0xb73)][_0x1346b5(0x595)],'widgetData':_0x405767[_0x1346b5(0xb73)]['widgetData']},_0x3670e4=await _0x15043e[_0x1346b5(0x73c)][_0x1346b5(0xdb8)]({'name':_0x69fbe8[_0x1346b5(0x8c6)](),'type':_0x1346b5(0x937)})[_0x1346b5(0xf2e)]();if(_0x3670e4){const _0x44db86=await _0x8b9cb8('覆盖预设',_0x1346b5(0xdbf)+_0x69fbe8[_0x1346b5(0x8c6)]()+_0x1346b5(0xbef),{'confirmButtonClass':_0x1346b5(0xe2a)});if(!_0x44db86)return;await _0x15043e['appearancePresets'][_0x1346b5(0xb7c)](_0x3670e4['id'],{'value':_0x1889fa});}else await _0x15043e[_0x1346b5(0x73c)][_0x1346b5(0x3f4)]({'name':_0x69fbe8[_0x1346b5(0x8c6)](),'type':_0x1346b5(0x937),'value':_0x1889fa});await _0x52184c(),alert('外观预设已保存！');}async function _0x500d16(){const _0x27a542=_0x18b51e,_0x38615c=document['getElementById'](_0x27a542(0x9cb)),_0x4c86d2=parseInt(_0x38615c[_0x27a542(0x518)]);if(isNaN(_0x4c86d2)){alert(_0x27a542(0x1264));return;}const _0x4005d0=await _0x15043e['appearancePresets'][_0x27a542(0x3e9)](_0x4c86d2);if(!_0x4005d0)return;const _0x52253f=await _0x8b9cb8(_0x27a542(0x1c8),_0x27a542(0x10b0)+_0x4005d0['name']+'”\x20吗？',{'confirmButtonClass':_0x27a542(0xe2a)});_0x52253f&&(await _0x15043e['appearancePresets'][_0x27a542(0x89f)](_0x4c86d2),await _0x52184c(),alert(_0x27a542(0x1b5)));}async function _0x954c8(){const _0x55bc7b=_0x18b51e,_0x4ead73=document['getElementById']('theme-preset-select');_0x4ead73[_0x55bc7b(0xca0)]=_0x55bc7b(0x8c5);const _0xe0b039=await _0x15043e[_0x55bc7b(0x73c)][_0x55bc7b(0xdb8)](_0x55bc7b(0xde0))[_0x55bc7b(0xc9a)](_0x55bc7b(0x4fe))['toArray']();_0xe0b039[_0x55bc7b(0x7c0)](_0x3a30dc=>{const _0x577102=_0x55bc7b,_0x2aa91d=document[_0x577102(0x8c1)](_0x577102(0x4f3));_0x2aa91d[_0x577102(0x518)]=_0x3a30dc['id'],_0x2aa91d[_0x577102(0x1090)]=_0x3a30dc[_0x577102(0x596)],_0x4ead73['appendChild'](_0x2aa91d);});}async function _0x557845(){const _0x24f10b=_0x18b51e,_0xf8e8f1=document[_0x24f10b(0x8c2)](_0x24f10b(0x209)),_0x4f81ef=parseInt(_0xf8e8f1['value']);if(isNaN(_0x4f81ef))return;const _0x4c503d=await _0x15043e['appearancePresets']['get'](_0x4f81ef);if(_0x4c503d){const _0x18e978=_0x4c503d[_0x24f10b(0x518)]['base']||_0x24f10b(0x674),_0x364f9f=_0x4c503d[_0x24f10b(0x518)][_0x24f10b(0x14d)]||'',_0x13f8c7=document['querySelector'](_0x24f10b(0xee7)+_0x18e978+'\x22]');_0x13f8c7&&(_0x13f8c7[_0x24f10b(0x75f)]=!![]);const _0xff32f=document[_0x24f10b(0x8c2)](_0x24f10b(0x10b9));_0xff32f[_0x24f10b(0x518)]=_0x364f9f,_0x9e9510();}}async function _0x263cc1(){const _0x3c5ae9=_0x18b51e,_0x1f03ec=await _0x180f74(_0x3c5ae9(0xec7),_0x3c5ae9(0x542));if(!_0x1f03ec||!_0x1f03ec[_0x3c5ae9(0x8c6)]())return;const _0x59c5ac=document[_0x3c5ae9(0x1ad)]('input[name=\x22theme-select\x22]:checked'),_0x584e5f=_0x59c5ac?_0x59c5ac['value']:'default',_0x1fc599=document[_0x3c5ae9(0x8c2)]('custom-css-input')[_0x3c5ae9(0x518)]['trim'](),_0x38e307={'base':_0x584e5f,'custom':_0x1fc599},_0x233195=await _0x15043e[_0x3c5ae9(0x73c)][_0x3c5ae9(0xdb8)]({'name':_0x1f03ec[_0x3c5ae9(0x8c6)](),'type':_0x3c5ae9(0x4fe)})[_0x3c5ae9(0xf2e)]();if(_0x233195){const _0x361481=await _0x8b9cb8(_0x3c5ae9(0x9fc),'名为\x20“'+_0x1f03ec[_0x3c5ae9(0x8c6)]()+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':_0x3c5ae9(0xe2a)});if(!_0x361481)return;await _0x15043e[_0x3c5ae9(0x73c)]['update'](_0x233195['id'],{'value':_0x38e307});}else await _0x15043e[_0x3c5ae9(0x73c)]['add']({'name':_0x1f03ec[_0x3c5ae9(0x8c6)](),'type':'bubble_theme','value':_0x38e307});await _0x954c8(),alert('主题预设已保存！');}async function _0x5ed40c(){const _0x5cf65a=_0x18b51e,_0x587070=document[_0x5cf65a(0x8c2)](_0x5cf65a(0x209)),_0x18fcbd=parseInt(_0x587070[_0x5cf65a(0x518)]);if(isNaN(_0x18fcbd)){alert('请先从下拉框中选择一个要删除的预设。');return;}const _0x11e484=await _0x15043e[_0x5cf65a(0x73c)][_0x5cf65a(0x3e9)](_0x18fcbd);if(!_0x11e484)return;const _0x577e56=await _0x8b9cb8(_0x5cf65a(0x1c8),_0x5cf65a(0x10b0)+_0x11e484[_0x5cf65a(0x596)]+_0x5cf65a(0x119f),{'confirmButtonClass':_0x5cf65a(0xe2a)});_0x577e56&&(await _0x15043e[_0x5cf65a(0x73c)][_0x5cf65a(0x89f)](_0x18fcbd),await _0x954c8(),alert(_0x5cf65a(0x1b5)));}async function _0x9c45d0(){const _0x2471c4=_0x18b51e;await _0x5cfeed(),document[_0x2471c4(0x8c2)](_0x2471c4(0x450))[_0x2471c4(0xb17)][_0x2471c4(0x3f4)](_0x2471c4(0x2cd));}async function _0x5cfeed(){const _0x26775b=_0x18b51e,_0x48769b=document[_0x26775b(0x8c2)]('existing-sticker-categories-list'),_0x139a93=await _0x15043e[_0x26775b(0x7db)][_0x26775b(0x6be)]();_0x48769b[_0x26775b(0xca0)]='';if(_0x139a93['length']===0x0){_0x48769b[_0x26775b(0xca0)]=_0x26775b(0xfa8);return;}_0x139a93[_0x26775b(0x7c0)](_0x5d33cc=>{const _0x33a12d=_0x26775b,_0x138498=document[_0x33a12d(0x8c1)](_0x33a12d(0x1072));_0x138498['className']='existing-group-item',_0x138498[_0x33a12d(0xca0)]=_0x33a12d(0x1293)+_0x5d33cc['name']+_0x33a12d(0x5a9)+_0x5d33cc['id']+_0x33a12d(0x113a),_0x48769b[_0x33a12d(0x31e)](_0x138498);});}async function _0x8487bc(){const _0x23b5e1=_0x18b51e,_0x431473=document[_0x23b5e1(0x8c2)](_0x23b5e1(0x102d)),_0x1f26ec=_0x431473[_0x23b5e1(0x518)]['trim']();if(!_0x1f26ec){alert(_0x23b5e1(0xc42));return;}const _0x153963=await _0x15043e['stickerCategories'][_0x23b5e1(0xdb8)](_0x23b5e1(0x596))[_0x23b5e1(0xc9a)](_0x1f26ec)[_0x23b5e1(0xf2e)]();if(_0x153963){alert(_0x23b5e1(0xbb3)+_0x1f26ec+'\x22\x20已经存在了！');return;}await _0x15043e['stickerCategories'][_0x23b5e1(0x3f4)]({'name':_0x1f26ec}),_0x431473[_0x23b5e1(0x518)]='',await _0x5cfeed();}async function _0x353cd2(_0x22cea7){const _0x4414c3=_0x18b51e,_0x10ac1b=await _0x15043e[_0x4414c3(0x7db)][_0x4414c3(0x3e9)](_0x22cea7);if(!_0x10ac1b)return;const _0x42c2be=await _0x15043e['userStickers']['where']('categoryId')[_0x4414c3(0xc9a)](_0x22cea7)['count'](),_0xeb21b5=_0x42c2be>0x0?_0x4414c3(0x1160)+_0x10ac1b[_0x4414c3(0x596)]+_0x4414c3(0x8e9)+_0x42c2be+_0x4414c3(0xcc4):_0x4414c3(0x1160)+_0x10ac1b['name']+'》吗？',_0x38567f=await _0x8b9cb8(_0x4414c3(0xed8),_0xeb21b5,{'confirmButtonClass':'btn-danger'});if(_0x38567f)try{await _0x15043e[_0x4414c3(0xa88)]('rw',_0x15043e[_0x4414c3(0x7db)],_0x15043e[_0x4414c3(0xc36)],async()=>{const _0x10d13f=_0x4414c3,_0x1584a4=await _0x15043e[_0x10d13f(0xc36)]['where']('categoryId')[_0x10d13f(0xc9a)](_0x22cea7)[_0x10d13f(0x506)]();_0x1584a4[_0x10d13f(0x105a)]>0x0&&await _0x15043e[_0x10d13f(0xc36)][_0x10d13f(0x101d)](_0x1584a4),await _0x15043e[_0x10d13f(0x7db)][_0x10d13f(0x89f)](_0x22cea7);}),_0x405767['userStickers']=await _0x15043e[_0x4414c3(0xc36)][_0x4414c3(0x6be)](),_0x5abf24===_0x22cea7&&(_0x5abf24=_0x4414c3(0xe88)),await _0x5cfeed(),await _0x1def9c(),alert(_0x4414c3(0x8a4)+_0x10ac1b[_0x4414c3(0x596)]+_0x4414c3(0x86d));}catch(_0x559e67){console[_0x4414c3(0x7a3)](_0x4414c3(0x21d),_0x559e67),alert(_0x4414c3(0x952));}}function _0xcca698(_0x1a58cf){const _0x27670a=_0x18b51e;_0x5abf24=_0x1a58cf,document['querySelectorAll'](_0x27670a(0x10e6))[_0x27670a(0x7c0)](_0xc6da3a=>{const _0x10989a=_0x27670a;_0xc6da3a[_0x10989a(0xb17)][_0x10989a(0xfc3)](_0x10989a(0x71b),String(_0xc6da3a[_0x10989a(0x323)][_0x10989a(0x792)])===String(_0x1a58cf));}),_0x1def9c(![]);const _0x2c0f8c=document[_0x27670a(0x8c2)](_0x27670a(0x91b));if(_0x2c0f8c)_0x2c0f8c[_0x27670a(0x75f)]=![];}async function _0x3a8637(){const _0x20801a=_0x18b51e;if(!_0x405767[_0x20801a(0x248)])return;const _0x9c10f3=_0x405767['chats'][_0x405767['activeChatId']];if(!_0x9c10f3)return;try{const _0x2f168b={'type':_0x20801a(0xf22),'version':0x1,'chatData':_0x9c10f3},_0x350756=new Blob([JSON['stringify'](_0x2f168b,null,0x2)],{'type':_0x20801a(0xcb6)}),_0x21285c=URL[_0x20801a(0x90b)](_0x350756),_0x5d8da3=document[_0x20801a(0x8c1)]('a');_0x5d8da3[_0x20801a(0x922)]=_0x21285c,_0x5d8da3['download']=_0x20801a(0xc2e)+_0x9c10f3['name']+'-'+new Date()['toISOString']()[_0x20801a(0x111f)]('T')[0x0]+'.json',_0x5d8da3[_0x20801a(0xa17)](),URL[_0x20801a(0xb0a)](_0x21285c),await _0x501c7b(_0x20801a(0x1d6),'与“'+_0x9c10f3[_0x20801a(0x596)]+_0x20801a(0x93a));}catch(_0x2d4228){console['error'](_0x20801a(0x644),_0x2d4228),await _0x501c7b(_0x20801a(0x1051),'发生了一个错误:\x20'+_0x2d4228[_0x20801a(0xc7d)]);}}async function _0x182a59(_0x2241c1){const _0x5e215f=_0x18b51e;if(!_0x2241c1||!_0x405767[_0x5e215f(0x248)])return;const _0x441831=_0x405767[_0x5e215f(0x248)],_0x49b4b9=_0x405767[_0x5e215f(0x799)][_0x441831];try{const _0x4b1bf3=await _0x2241c1[_0x5e215f(0xbc6)](),_0x531213=JSON[_0x5e215f(0x10ab)](_0x4b1bf3);if(_0x531213[_0x5e215f(0xde0)]!==_0x5e215f(0xf22)||!_0x531213[_0x5e215f(0xd47)])throw new Error(_0x5e215f(0x868));const _0x1c85f7=await _0x8b9cb8(_0x5e215f(0x127b),_0x5e215f(0x2e6)+_0x49b4b9[_0x5e215f(0x596)]+_0x5e215f(0x11de),{'confirmButtonClass':_0x5e215f(0xe2a),'confirmText':_0x5e215f(0xbf6)});if(!_0x1c85f7)return;const _0x20b252=_0x531213[_0x5e215f(0xd47)];_0x20b252['id']=_0x441831,await _0x15043e[_0x5e215f(0x799)]['put'](_0x20b252),_0x405767[_0x5e215f(0x799)][_0x441831]=_0x20b252,await _0x501c7b(_0x5e215f(0x95b),_0x5e215f(0x43e)),_0x7dbe71(_0x441831),_0x2b55d1(),document[_0x5e215f(0x8c2)](_0x5e215f(0x2fc))[_0x5e215f(0xa17)]();}catch(_0x5d6772){console[_0x5e215f(0x7a3)](_0x5e215f(0x1177),_0x5d6772),await _0x501c7b(_0x5e215f(0x8e8),'文件解析或应用失败:\x20'+_0x5d6772[_0x5e215f(0xc7d)]);}}function _0x1fbe5a(){const _0x4e9987=_0x18b51e;_0x18220c(),_0x3d1990(_0x4e9987(0xbfa));}function _0x18220c(){const _0x128f0d=_0x18b51e,_0x102618=document['getElementById']('character-grid');_0x102618[_0x128f0d(0xca0)]='';const _0x2618f9=Object['values'](_0x405767[_0x128f0d(0x799)])[_0x128f0d(0x1d8)](_0x2f227a=>!_0x2f227a[_0x128f0d(0x1000)]);if(_0x2618f9[_0x128f0d(0x105a)]===0x0){_0x102618['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>';return;}_0x2618f9['forEach'](_0x421a81=>{const _0xe5dcad=_0x128f0d,_0x51b246=document[_0xe5dcad(0x8c1)](_0xe5dcad(0x1072));_0x51b246[_0xe5dcad(0x84c)]='character-select-item',_0x51b246[_0xe5dcad(0xca0)]=_0xe5dcad(0x1069)+(_0x421a81[_0xe5dcad(0x33a)]['aiAvatar']||_0x49d2a4)+_0xe5dcad(0x11c6)+_0x421a81[_0xe5dcad(0x596)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x51b246['addEventListener'](_0xe5dcad(0xa17),()=>_0x54f3af(_0x421a81['id'])),_0x102618[_0xe5dcad(0x31e)](_0x51b246);});}async function _0x54f3af(_0x829164){const _0x10772f=_0x18b51e;_0x1f6e46=_0x829164,console['log'](_0x10772f(0xb29)+_0x829164+'\x20的手机'),_0x5f1ba2(),_0xf3d9cb(),_0x3afcda(),_0x3d1990(_0x10772f(0x9ec));}function _0x1707ba(){const _0x5a4aa8=_0x18b51e;_0x1f6e46=null,console[_0x5a4aa8(0x32b)](_0x5a4aa8(0x328)),_0x3d1990(_0x5a4aa8(0x835));}function _0x3afcda(){const _0x30d9f7=_0x18b51e,_0x30d322=new Date(),_0x7ed57c=_0x30d322['toLocaleTimeString'](_0x30d9f7(0x73e),{'hour':_0x30d9f7(0xd0c),'minute':_0x30d9f7(0xd0c)}),_0x1f1e8a=_0x30d322[_0x30d9f7(0x3de)]('zh-CN',{'weekday':_0x30d9f7(0x386),'month':_0x30d9f7(0x386),'day':_0x30d9f7(0x20c)});document['getElementById'](_0x30d9f7(0x775))[_0x30d9f7(0x1090)]=_0x7ed57c,document[_0x30d9f7(0x8c2)](_0x30d9f7(0x744))[_0x30d9f7(0x1090)]=_0x1f1e8a,_0x5c2ffa(_0x30d9f7(0xf9a));}function _0x5c2ffa(_0x4585d9){const _0x406ed9=_0x18b51e;document['querySelectorAll'](_0x406ed9(0x900))[_0x406ed9(0x7c0)](_0x1f7655=>_0x1f7655[_0x406ed9(0xb17)]['remove'](_0x406ed9(0x71b))),document['getElementById'](_0x4585d9)[_0x406ed9(0xb17)][_0x406ed9(0x3f4)](_0x406ed9(0x71b));}window[_0x18b51e(0x126e)]=_0x5c2ffa;async function _0x42db29(_0x31153c){const _0xe749e1=_0x18b51e;if(!_0x1f6e46)return;const _0x392819=_0x405767[_0xe749e1(0x799)][_0x1f6e46];await _0x244e40(_0x1f6e46,_0x31153c);switch(_0x31153c){case'qq':_0x1ee832(),_0x5c2ffa(_0xe749e1(0x1004));break;case _0xe749e1(0xa7a):_0x5d895e(),_0x5c2ffa(_0xe749e1(0x705));break;case _0xe749e1(0x86f):_0x7dbc17(),_0x5c2ffa(_0xe749e1(0x2e1));break;case _0xe749e1(0x1190):_0x16090f(),_0x5c2ffa(_0xe749e1(0x185));break;case _0xe749e1(0x527):_0x35e23d(),_0x5c2ffa(_0xe749e1(0x1b0));break;case _0xe749e1(0x9a9):_0x42cb09(),_0x5c2ffa('char-diary-screen');break;case _0xe749e1(0xab9):_0x49b697(),_0x5c2ffa('char-amap-screen');break;case _0xe749e1(0x3a4):_0x5b3fa9(),_0x5c2ffa(_0xe749e1(0x39b));break;case'usage':_0x5434d9(),_0x5c2ffa('char-usage-screen');break;}}async function _0x5d895e(){const _0x4ba331=_0x18b51e,_0x842909=document[_0x4ba331(0x8c2)](_0x4ba331(0x904));_0x842909[_0x4ba331(0xca0)]='';if(!_0x1f6e46)return;const _0x18c58a=_0x405767[_0x4ba331(0x799)][_0x1f6e46],_0x1f96c9=_0x18c58a[_0x4ba331(0x1238)]||[];if(_0x1f96c9[_0x4ba331(0x105a)]===0x0){_0x842909[_0x4ba331(0xca0)]=_0x4ba331(0x1157);return;}const _0x19dd34=_0x4ba331(0x10c3);_0x1f96c9[_0x4ba331(0x7c0)](_0x310f1c=>{const _0xd60e3c=_0x4ba331,_0x1c6203=document['createElement'](_0xd60e3c(0x1072));_0x1c6203[_0xd60e3c(0x84c)]=_0xd60e3c(0x8b9),_0x1c6203[_0xd60e3c(0x323)][_0xd60e3c(0x3ca)]=_0x310f1c[_0xd60e3c(0x3ca)],_0x842909[_0xd60e3c(0x31e)](_0x1c6203);if(_0x405767[_0xd60e3c(0xb73)][_0xd60e3c(0xd00)]){_0x1c6203['style'][_0xd60e3c(0x617)]=_0xd60e3c(0x73d);const _0x328242=/[^\x00-\x7F]/[_0xd60e3c(0x696)](_0x310f1c[_0xd60e3c(0xdae)]),_0x5f2796=_0x310f1c[_0xd60e3c(0xdae)]&&_0x310f1c['image_prompt'][_0xd60e3c(0x8c6)]()&&!_0x328242,_0x2a770f=_0x5f2796?_0x310f1c[_0xd60e3c(0xdae)]:_0xd60e3c(0x7e8),_0x5e02fa=_0xd60e3c(0x2c6)+encodeURIComponent(_0x2a770f),_0x1fca50=new Image();_0x1fca50[_0xd60e3c(0xe7a)]=function(){const _0x325429=_0xd60e3c;_0x1c6203['style'][_0x325429(0xfff)]=_0x325429(0x116b)+this[_0x325429(0x939)]+')';},_0x1fca50['onerror']=function(){const _0x574111=_0xd60e3c;_0x1c6203[_0x574111(0x842)][_0x574111(0xfff)]='url('+_0x19dd34+')';},_0x1fca50[_0xd60e3c(0x939)]=_0x5e02fa;}else{_0x1c6203['style'][_0xd60e3c(0x617)]='#f0f2f5',_0x1c6203[_0xd60e3c(0x842)][_0xd60e3c(0xb5f)]=_0xd60e3c(0x2c4);const _0x2c98f6=document[_0xd60e3c(0x8c1)]('p');_0x2c98f6['className']=_0xd60e3c(0xd1c),_0x2c98f6[_0xd60e3c(0x1090)]=_0x310f1c[_0xd60e3c(0x3ca)]||_0xd60e3c(0x9e6),_0x1c6203[_0xd60e3c(0x31e)](_0x2c98f6);}});}function _0x7dbc17(){const _0x2b8d5e=_0x18b51e,_0x4945ca=document[_0x2b8d5e(0x8c2)](_0x2b8d5e(0x3b9));_0x4945ca[_0x2b8d5e(0xca0)]='';if(!_0x1f6e46)return;const _0xde805f=_0x405767['chats'][_0x1f6e46],_0x5b8d6b=[_0xde805f[_0x2b8d5e(0x596)],'爱好','旅游','美食','新闻',..._0xde805f[_0x2b8d5e(0x33a)][_0x2b8d5e(0x1060)][_0x2b8d5e(0x111f)](/，|。|\s/)['slice'](0x0,0x5)],_0x3fc7ea=['知乎',_0x2b8d5e(0x61a),_0x2b8d5e(0x2dd),'微博',_0x2b8d5e(0x414)];for(let _0x57565b=0x0;_0x57565b<0xf;_0x57565b++){const _0x4703d2=_0x5b8d6b[Math[_0x2b8d5e(0x10b2)](Math[_0x2b8d5e(0x5b3)]()*_0x5b8d6b[_0x2b8d5e(0x105a)])],_0x432a90=_0x3fc7ea[Math['floor'](Math[_0x2b8d5e(0x5b3)]()*_0x3fc7ea['length'])],_0x1f0644=document['createElement'](_0x2b8d5e(0x1072));_0x1f0644['className']='char-browser-item',_0x1f0644[_0x2b8d5e(0xca0)]=_0x2b8d5e(0x1148)+_0x4703d2+_0x2b8d5e(0x2e9)+_0x432a90+_0x2b8d5e(0x166)+_0x432a90[_0x2b8d5e(0xab8)]()+_0x2b8d5e(0xf46)+_0x4703d2+_0x2b8d5e(0xe47),_0x4945ca[_0x2b8d5e(0x31e)](_0x1f0644);}}function _0x16090f(){const _0x2f436e=_0x18b51e,_0x39aa47=document['getElementById']('char-product-grid');_0x39aa47[_0x2f436e(0xca0)]='';if(!_0x1f6e46)return;const _0x2464d2=_0x405767[_0x2f436e(0x799)][_0x1f6e46],_0x1e9ad0=_0x2464d2[_0x2f436e(0xec9)]?.['purchases']||[];if(_0x1e9ad0['length']===0x0){_0x39aa47[_0x2f436e(0xca0)]=_0x2f436e(0xd73);return;}_0x1e9ad0[_0x2f436e(0x7c0)](_0x1f6680=>{const _0x3706d1=_0x2f436e,_0x2917a1=document[_0x3706d1(0x8c1)](_0x3706d1(0x1072));_0x2917a1[_0x3706d1(0x84c)]=_0x3706d1(0x571),_0x2917a1[_0x3706d1(0x323)][_0x3706d1(0x29f)]=_0x1f6680[_0x3706d1(0x29f)];let _0x139cb8;if(_0x405767['globalSettings'][_0x3706d1(0xd00)]){const _0x49ac55=_0x3706d1(0x2c6)+encodeURIComponent(_0x1f6680[_0x3706d1(0xdae)]||_0x3706d1(0xe95));_0x139cb8=_0x3706d1(0x333)+_0x49ac55+'\x22\x20class=\x22product-image\x22>';}else _0x139cb8=_0x3706d1(0x984)+(_0x1f6680[_0x3706d1(0x29f)]||_0x3706d1(0xcef))+_0x3706d1(0xb28);_0x2917a1['innerHTML']=_0x3706d1(0xb35)+_0x139cb8+_0x3706d1(0xab6)+_0x1f6680[_0x3706d1(0x7ee)]+_0x3706d1(0x1e9)+(_0x1f6680[_0x3706d1(0x2ea)]||0x0)[_0x3706d1(0x3c1)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>'+_0x1f6680[_0x3706d1(0x8c8)]+_0x3706d1(0x6ad),_0x39aa47[_0x3706d1(0x31e)](_0x2917a1);});}function _0x476eb8(){_0x5c2ffa('char-home-screen');}function _0x3b8b9a(){const _0x1e7671=_0x18b51e,_0xd65dbc=document[_0x1e7671(0x8c2)]('char-chat-list');_0xd65dbc['innerHTML']='';if(!_0x1f6e46)return;const _0x561e40=Object[_0x1e7671(0x22f)](_0x405767[_0x1e7671(0x799)])[_0x1e7671(0x1d8)](_0x24b4d7=>{const _0x8c818=_0x1e7671;if(_0x24b4d7['id']===_0x1f6e46)return!![];if(_0x24b4d7[_0x8c818(0x1000)]&&_0x24b4d7[_0x8c818(0x635)][_0x8c818(0xdc3)](_0xe6993c=>_0xe6993c['id']===_0x1f6e46))return!![];return![];});_0x561e40['forEach'](_0x2fcb73=>{const _0x329e2f=_0x13c0f2(_0x2fcb73);_0xd65dbc['appendChild'](_0x329e2f);});}async function _0x244e40(_0x46854d,_0x57ca9e){const _0x21db78=_0x18b51e,_0x81c4a5=_0x405767[_0x21db78(0x799)][_0x46854d];if(!_0x81c4a5)return;!_0x81c4a5[_0x21db78(0x9c5)]&&(_0x81c4a5[_0x21db78(0x9c5)]=[]),_0x81c4a5[_0x21db78(0x9c5)][_0x21db78(0xa49)]({'appName':_0x57ca9e,'timestamp':Date['now']()}),_0x81c4a5[_0x21db78(0x9c5)][_0x21db78(0x105a)]>0x32&&_0x81c4a5['appUsageLog'][_0x21db78(0x101b)](),await _0x15043e[_0x21db78(0x799)][_0x21db78(0xfaa)](_0x81c4a5);}function _0x5434d9(){const _0x54ad71=_0x18b51e,_0x269612=document[_0x54ad71(0x8c2)]('char-usage-list');_0x269612[_0x54ad71(0xca0)]='';const _0x311248=_0x405767[_0x54ad71(0x799)][_0x1f6e46],_0x6162ac=(_0x311248[_0x54ad71(0x9c5)]||[])[_0x54ad71(0x961)]()[_0x54ad71(0x1c0)]();if(_0x6162ac[_0x54ad71(0x105a)]===0x0){_0x269612[_0x54ad71(0xca0)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>';return;}const _0xc79703={'qq':'QQ','album':'相册','browser':_0x54ad71(0xc9c),'taobao':'淘宝','memo':_0x54ad71(0x1169),'diary':'日记','amap':_0x54ad71(0xc1c),'usage':_0x54ad71(0xa74)};_0x6162ac[_0x54ad71(0x7c0)](_0xb2b878=>{const _0x438d2a=_0x54ad71,_0x4845eb=document[_0x438d2a(0x8c1)](_0x438d2a(0x1072));_0x4845eb[_0x438d2a(0x84c)]=_0x438d2a(0xf9d),_0x4845eb['innerHTML']=_0x438d2a(0xe21)+new Date(_0xb2b878[_0x438d2a(0x351)])[_0x438d2a(0x2e8)]()+_0x438d2a(0x25f)+(_0xc79703[_0xb2b878[_0x438d2a(0x2d6)]]||_0xb2b878[_0x438d2a(0x2d6)])+'</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x269612[_0x438d2a(0x31e)](_0x4845eb);});}async function _0x3f51f4(_0x40abb8){const _0x486fdf=_0x18b51e,_0x5a429c=_0x405767['chats'][_0x1f6e46];if(!_0x5a429c)return;const _0x3dfe16={'role':_0x486fdf(0x458),'senderName':_0x5a429c['originalName'],'type':'location_share','content':_0x40abb8,'imageUrl':_0x486fdf(0xc99),'timestamp':Date[_0x486fdf(0x1ed)]()};_0x5a429c[_0x486fdf(0xd39)][_0x486fdf(0xa49)](_0x3dfe16),await _0x15043e[_0x486fdf(0x799)][_0x486fdf(0xfaa)](_0x5a429c),_0x405767[_0x486fdf(0x248)]===_0x1f6e46&&_0x5c5c92(_0x3dfe16,_0x5a429c),await _0x501c7b(_0x486fdf(0xa68),'“'+_0x5a429c[_0x486fdf(0x596)]+_0x486fdf(0x10dc));}async function _0xd30f54(_0xed17b4){const _0xead9b4=_0x18b51e,_0x2511a=_0x405767[_0xead9b4(0x799)][_0x1f6e46];if(!_0x2511a||!_0x2511a[_0xead9b4(0xb96)])return;const _0x35dbc1=_0x2511a[_0xead9b4(0xb96)][_0xead9b4(0x2ef)](_0x8f55be=>_0x8f55be['id']===_0xed17b4);if(_0x35dbc1){_0x41e425=_0x35dbc1;const _0x375daa=document[_0xead9b4(0x8c2)](_0xead9b4(0xff9)),_0x43492b=document[_0xead9b4(0x8c2)]('char-memo-detail-content'),_0x37e317=document[_0xead9b4(0x8c2)](_0xead9b4(0x6b5));if(_0x375daa)_0x375daa['textContent']=_0x35dbc1[_0xead9b4(0xcea)];if(_0x43492b)_0x43492b['value']=_0x35dbc1[_0xead9b4(0x168)];const _0x1032d4=await _0x15043e['favorites'][_0xead9b4(0xdb8)]({'type':_0xead9b4(0xd7a),'content.id':_0xed17b4})['first']();_0x37e317[_0xead9b4(0xb17)][_0xead9b4(0xfc3)](_0xead9b4(0x71b),!!_0x1032d4),_0x5c2ffa(_0xead9b4(0x4d6));}}function _0x35e23d(){const _0x581817=_0x18b51e,_0x54fcb0=document[_0x581817(0x8c2)](_0x581817(0x5d9));_0x54fcb0['innerHTML']='';const _0x50208d=_0x405767[_0x581817(0x799)][_0x1f6e46],_0x59343a=(_0x50208d['memos']||[])[_0x581817(0x961)]()[_0x581817(0x1c0)]();if(_0x59343a[_0x581817(0x105a)]===0x0){_0x54fcb0[_0x581817(0xca0)]=_0x581817(0x5c2);return;}_0x59343a[_0x581817(0x7c0)](_0x9061b9=>{const _0x25736c=_0x581817,_0x5ca6fa=document[_0x25736c(0x8c1)](_0x25736c(0x1072));_0x5ca6fa[_0x25736c(0x84c)]='list-item',_0x5ca6fa[_0x25736c(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>'+_0x9061b9[_0x25736c(0xcea)]+_0x25736c(0xb04)+(_0x9061b9[_0x25736c(0x168)]||'')['split']('\x0a')[0x0]+_0x25736c(0xe47),_0x5ca6fa[_0x25736c(0xae8)](_0x25736c(0xa17),()=>_0xd30f54(_0x9061b9['id'])),_0x5dcbd7(_0x5ca6fa,()=>deleteMemo(_0x9061b9['id'])),_0x54fcb0['appendChild'](_0x5ca6fa);});}async function _0x290e38(_0xba7baa=null){const _0x408084=_0x18b51e;_0x6f0af7=null;const _0x27ffaa=await _0x180f74('新建备忘录',_0x408084(0xa98));if(_0x27ffaa===null||!_0x27ffaa[_0x408084(0x8c6)]())return;const _0x4146f7=await _0x180f74(_0x408084(0x7bd)+_0x27ffaa,_0x408084(0x909),'',_0x408084(0x6c3));_0x4146f7!==null&&(await _0x2e2d92({'title':_0x27ffaa[_0x408084(0x8c6)](),'content':_0x4146f7}),_0x5c2ffa(_0x408084(0x1b0)));}async function _0x2e2d92(_0x165df5){const _0x36b3ed=_0x18b51e,_0x207076=_0x405767[_0x36b3ed(0x799)][_0x1f6e46];if(!_0x207076[_0x36b3ed(0xb96)])_0x207076[_0x36b3ed(0xb96)]=[];_0x207076['memos'][_0x36b3ed(0xa49)]({'id':Date[_0x36b3ed(0x1ed)](),'title':_0x165df5['title'],'content':_0x165df5['content']}),await _0x15043e[_0x36b3ed(0x799)][_0x36b3ed(0xfaa)](_0x207076),_0x35e23d();}async function _0x2e2d92(_0xf571f1){const _0x436aae=_0x18b51e,_0x34c7b0=_0x405767[_0x436aae(0x799)][_0x1f6e46];if(!_0x34c7b0['memos'])_0x34c7b0['memos']=[];if(_0x6f0af7){const _0x3e789f=_0x34c7b0['memos'][_0x436aae(0x2ef)](_0x20a822=>_0x20a822['id']===_0x6f0af7);if(_0x3e789f)_0x3e789f[_0x436aae(0x168)]=_0xf571f1;}else _0x34c7b0['memos'][_0x436aae(0xa49)]({'id':Date[_0x436aae(0x1ed)](),'content':_0xf571f1});await _0x15043e[_0x436aae(0x799)][_0x436aae(0xfaa)](_0x34c7b0),_0x35e23d(),_0x6f0af7=null;}async function _0x397e25(){const _0x2b16f3=_0x18b51e;if(!_0x1f6e46)return;const _0x4b3c72=_0x405767['chats'][_0x1f6e46];if(!_0x4b3c72)return;await _0x501c7b(_0x2b16f3(0x1047),'正在请求“'+_0x4b3c72[_0x2b16f3(0x596)]+_0x2b16f3(0x6e5));const {proxyUrl:_0x5eb5cd,apiKey:_0x146121,model:_0x2f0050}=_0x405767['apiConfig'];if(!_0x5eb5cd||!_0x146121||!_0x2f0050){alert(_0x2b16f3(0x6c2));return;}const _0x3edf5a=_0x405767[_0x2b16f3(0x20a)][_0x2b16f3(0xab3)]===_0x2b16f3(0x2dc)||!_0x405767['qzoneSettings']['nickname']?'用户':_0x405767['qzoneSettings'][_0x2b16f3(0xab3)],_0x3125de=_0x4b3c72[_0x2b16f3(0xbca)]&&_0x4b3c72['longTermMemory'][_0x2b16f3(0x105a)]>0x0?_0x4b3c72[_0x2b16f3(0xbca)][_0x2b16f3(0x6b9)](_0x3035a6=>_0x2b16f3(0xc09)+_0x4f34be(_0x3035a6[_0x2b16f3(0x351)])+')\x20'+_0x3035a6[_0x2b16f3(0x168)])[_0x2b16f3(0xb2c)]('\x0a'):'无',_0x33441c=_0x4b3c72[_0x2b16f3(0x33a)][_0x2b16f3(0x808)]||0xa,_0x4a88f6=_0x4b3c72[_0x2b16f3(0xd39)][_0x2b16f3(0x961)](-_0x33441c)['map'](_0x511345=>(_0x511345['role']==='user'?_0x3edf5a:_0x4b3c72['name'])+':\x20'+String(_0x511345[_0x2b16f3(0x168)])[_0x2b16f3(0x599)](0x0,0x1e)+'...')[_0x2b16f3(0xb2c)]('\x0a'),_0x69e10c=(_0x4b3c72['settings']['linkedWorldBookIds']||[])[_0x2b16f3(0x6b9)](_0x4d6f34=>_0x405767[_0x2b16f3(0x40e)][_0x2b16f3(0x2ef)](_0x383300=>_0x383300['id']===_0x4d6f34))[_0x2b16f3(0x1d8)](Boolean)['map'](_0x357e68=>_0x2b16f3(0xec0)+_0x357e68[_0x2b16f3(0x596)]+_0x2b16f3(0x405)+_0x357e68[_0x2b16f3(0x168)]['filter'](_0x108ed0=>_0x108ed0['enabled'])[_0x2b16f3(0x6b9)](_0x2d43db=>'-\x20'+_0x2d43db[_0x2b16f3(0x168)])[_0x2b16f3(0xb2c)]('\x0a'))[_0x2b16f3(0xb2c)](''),_0x1de773=_0x5e1bc2(_0x4b3c72,0x3,_0x2b16f3(0x834)),_0x1fc986=_0x5e1bc2(_0x4b3c72,0x6,'hours'),_0x49e09e=_0x5e1bc2(_0x4b3c72,0x9,_0x2b16f3(0x834)),_0x12a570=_0x5e1bc2(_0x4b3c72,0x1,_0x2b16f3(0x1a0)),_0x1cc041=_0x5e1bc2(_0x4b3c72,0x3,_0x2b16f3(0x1a0)),_0x5ba9b1=_0x5e1bc2(_0x4b3c72,0x7,_0x2b16f3(0x1a0));let _0xee50e6='';if(_0x1de773||_0x1fc986||_0x49e09e||_0x12a570||_0x1cc041||_0x5ba9b1){_0xee50e6+=_0x2b16f3(0x2c2);if(_0x1de773)_0xee50e6+=_0x1de773;if(_0x1fc986)_0xee50e6+=_0x1fc986;if(_0x49e09e)_0xee50e6+=_0x49e09e;if(_0x1de773||_0x1fc986||_0x49e09e)_0xee50e6+='\x0a';if(_0x12a570)_0xee50e6+=_0x12a570;if(_0x1cc041)_0xee50e6+=_0x1cc041;if(_0x5ba9b1)_0xee50e6+=_0x5ba9b1;}const _0x18d6ba=_0x2b16f3(0x452)+_0x4b3c72[_0x2b16f3(0x596)]+_0x2b16f3(0x6f6)+new Date()[_0x2b16f3(0x3de)](_0x2b16f3(0x73e))+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“'+_0x3edf5a+'”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x4b3c72[_0x2b16f3(0x33a)][_0x2b16f3(0x1060)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0x3125de+'\x0a'+_0x69e10c+'\x0a'+_0xee50e6+'\x20\x0a-\x20**你最近和“'+_0x3edf5a+_0x2b16f3(0x632)+_0x4a88f6+'\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。';try{const _0x3fa1e5=[{'role':_0x2b16f3(0x74b),'content':_0x2b16f3(0xcb5)}];let _0x49ccc5=_0x5eb5cd['includes']('generativelanguage'),_0x5f500b=_0x282b7e(_0x2f0050,_0x146121,_0x18d6ba,_0x3fa1e5);const _0x24f397=_0x49ccc5?await fetch(_0x5f500b['url'],_0x5f500b['data']):await fetch(_0x5eb5cd+_0x2b16f3(0x5c1),{'method':_0x2b16f3(0xcd0),'headers':{'Content-Type':_0x2b16f3(0xcb6),'Authorization':'Bearer\x20'+_0x146121},'body':JSON[_0x2b16f3(0x1175)]({'model':_0x2f0050,'messages':[{'role':_0x2b16f3(0x46c),'content':_0x18d6ba},..._0x3fa1e5],'temperature':_0x405767[_0x2b16f3(0xb73)]['apiTemperature']||0.95})});if(!_0x24f397['ok'])throw new Error(_0x2b16f3(0xd83)+_0x24f397[_0x2b16f3(0xd05)]);const _0x19670b=await _0x24f397[_0x2b16f3(0x7e9)](),_0x39e4d6=getGeminiResponseText(_0x19670b),_0x3b307b=_0x39e4d6['match'](/(\[[\s\S]*\])/);if(!_0x3b307b||!_0x3b307b[0x0])throw new Error(_0x2b16f3(0x119d)+_0x39e4d6);const _0x554456=_0x3b307b[0x0];let _0x58d007;try{_0x58d007=JSON[_0x2b16f3(0x10ab)](_0x554456);}catch(_0x1f671f){throw new Error(_0x2b16f3(0x918)+_0x1f671f[_0x2b16f3(0xc7d)]+_0x2b16f3(0x15c)+_0x39e4d6);}_0x4b3c72['diary']=_0x58d007[_0x2b16f3(0x6b9)](_0x10ee3f=>({'id':Date[_0x2b16f3(0x1ed)]()+Math[_0x2b16f3(0x5b3)](),'title':_0x10ee3f[_0x2b16f3(0xcea)],'content':_0x10ee3f['content'],'timestamp':Date[_0x2b16f3(0x1ed)]()})),await _0x15043e[_0x2b16f3(0x799)]['put'](_0x4b3c72),await _0x42cb09();}catch(_0x302ada){console['error'](_0x2b16f3(0x239),_0x302ada),await _0x501c7b('生成失败',_0x2b16f3(0x204)+_0x302ada[_0x2b16f3(0xc7d)]);}}async function _0x5aa085(){const _0x4fd61e=_0x18b51e;if(!_0x1f6e46)return;const _0x3ea659=_0x405767[_0x4fd61e(0x799)][_0x1f6e46];if(!_0x3ea659)return;await _0x501c7b(_0x4fd61e(0x1047),_0x4fd61e(0xf15)+_0x3ea659['name']+_0x4fd61e(0x263));const {proxyUrl:_0x5b9590,apiKey:_0x2550f6,model:_0x1f9f96}=_0x405767[_0x4fd61e(0x9e0)];if(!_0x5b9590||!_0x2550f6||!_0x1f9f96)return;const _0x4986fd=_0x405767[_0x4fd61e(0x20a)]['nickname']===_0x4fd61e(0x2dc)||!_0x405767['qzoneSettings'][_0x4fd61e(0xab3)]?'用户':_0x405767[_0x4fd61e(0x20a)][_0x4fd61e(0xab3)],_0x282a29=_0x3ea659[_0x4fd61e(0xbca)]&&_0x3ea659[_0x4fd61e(0xbca)]['length']>0x0?_0x3ea659[_0x4fd61e(0xbca)][_0x4fd61e(0x6b9)](_0x5d3697=>_0x4fd61e(0xc09)+_0x4f34be(_0x5d3697[_0x4fd61e(0x351)])+')\x20'+_0x5d3697[_0x4fd61e(0x168)])[_0x4fd61e(0xb2c)]('\x0a'):'无',_0x2e380c=_0x3ea659[_0x4fd61e(0x33a)][_0x4fd61e(0x808)]||0xa,_0x509d50=_0x3ea659['history']['slice'](-_0x2e380c)['map'](_0x2fd9d4=>(_0x2fd9d4[_0x4fd61e(0x14a)]==='user'?_0x4986fd:_0x3ea659['name'])+':\x20'+String(_0x2fd9d4[_0x4fd61e(0x168)])[_0x4fd61e(0x599)](0x0,0x1e)+'...')[_0x4fd61e(0xb2c)]('\x0a'),_0x46d81a=(_0x3ea659[_0x4fd61e(0x33a)]['linkedWorldBookIds']||[])[_0x4fd61e(0x6b9)](_0x2f93ee=>_0x405767[_0x4fd61e(0x40e)][_0x4fd61e(0x2ef)](_0xe22bb5=>_0xe22bb5['id']===_0x2f93ee))[_0x4fd61e(0x1d8)](Boolean)[_0x4fd61e(0x6b9)](_0x49ea95=>_0x4fd61e(0xec0)+_0x49ea95[_0x4fd61e(0x596)]+_0x4fd61e(0x405)+_0x49ea95[_0x4fd61e(0x168)][_0x4fd61e(0x1d8)](_0x1083d6=>_0x1083d6['enabled'])[_0x4fd61e(0x6b9)](_0x3aa564=>'-\x20'+_0x3aa564[_0x4fd61e(0x168)])['join']('\x0a'))[_0x4fd61e(0xb2c)](''),_0x4bfbbb=_0x4fd61e(0x65c)+_0x3ea659[_0x4fd61e(0x596)]+_0x4fd61e(0xc86)+new Date()[_0x4fd61e(0x3de)](_0x4fd61e(0x73e))+_0x4fd61e(0x673)+_0x3ea659['settings']['aiPersona']+'\x0a-\x20**你的长期记忆**:\x0a'+_0x282a29+'\x0a'+_0x46d81a+'\x0a-\x20**你最近和“'+_0x4986fd+_0x4fd61e(0x632)+_0x509d50+_0x4fd61e(0x820);try{const _0xcd432d=[{'role':'user','content':_0x4fd61e(0xd20)}];let _0xfe6789=_0x5b9590[_0x4fd61e(0x773)](_0x4fd61e(0x3fe)),_0x548b77=_0x282b7e(_0x1f9f96,_0x2550f6,_0x4bfbbb,_0xcd432d);const _0x755177=_0xfe6789?await fetch(_0x548b77[_0x4fd61e(0x9d6)],_0x548b77['data']):await fetch(_0x5b9590+_0x4fd61e(0x5c1),{'method':_0x4fd61e(0xcd0),'headers':{'Content-Type':'application/json','Authorization':_0x4fd61e(0xf42)+_0x2550f6},'body':JSON[_0x4fd61e(0x1175)]({'model':_0x1f9f96,'messages':[{'role':_0x4fd61e(0x46c),'content':_0x4bfbbb},..._0xcd432d],'temperature':_0x405767['globalSettings']['apiTemperature']||0.95})});if(!_0x755177['ok'])throw new Error(_0x4fd61e(0xd83)+_0x755177['statusText']);const _0x40be7d=await _0x755177[_0x4fd61e(0x7e9)](),_0x1c6b4a=getGeminiResponseText(_0x40be7d),_0x58a8f0=_0x1c6b4a['match'](/(\[[\s\S]*\])/);if(!_0x58a8f0||!_0x58a8f0[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x1c6b4a);const _0x17eb67=_0x58a8f0[0x0];let _0x4e5e04;try{_0x4e5e04=JSON[_0x4fd61e(0x10ab)](_0x17eb67)[0x0];}catch(_0x2f33a0){throw new Error(_0x4fd61e(0x918)+_0x2f33a0[_0x4fd61e(0xc7d)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x1c6b4a);}if(!_0x3ea659['diary'])_0x3ea659['diary']=[];_0x3ea659['diary'][_0x4fd61e(0xa49)]({'id':Date[_0x4fd61e(0x1ed)](),'title':_0x4e5e04[_0x4fd61e(0xcea)],'content':_0x4e5e04[_0x4fd61e(0x168)],'timestamp':Date[_0x4fd61e(0x1ed)]()}),await _0x15043e[_0x4fd61e(0x799)][_0x4fd61e(0xfaa)](_0x3ea659),await _0x42cb09();}catch(_0x393c3a){console['error']('生成新日记失败:',_0x393c3a),await _0x501c7b(_0x4fd61e(0x40b),_0x4fd61e(0x350)+_0x393c3a[_0x4fd61e(0xc7d)]);}}function _0x42cb09(){const _0x110335=_0x18b51e,_0x41805a=document[_0x110335(0x8c2)](_0x110335(0x464));_0x41805a[_0x110335(0xca0)]='';const _0x2a8c94=_0x405767[_0x110335(0x799)][_0x1f6e46],_0x5d96a1=(_0x2a8c94[_0x110335(0x9a9)]||[])['slice']()[_0x110335(0x1c0)]();if(_0x5d96a1[_0x110335(0x105a)]===0x0){_0x41805a[_0x110335(0xca0)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>';return;}_0x5d96a1['forEach'](_0xe6e30c=>{const _0x41f3e2=_0x110335,_0x1258a2=document[_0x41f3e2(0x8c1)]('div');_0x1258a2['className']=_0x41f3e2(0x94f),_0x1258a2[_0x41f3e2(0xca0)]=_0x41f3e2(0x128a)+_0xe6e30c[_0x41f3e2(0xcea)]+_0x41f3e2(0x1107)+new Date(_0xe6e30c[_0x41f3e2(0x351)])[_0x41f3e2(0x3de)]()+_0x41f3e2(0x953),_0x1258a2['addEventListener'](_0x41f3e2(0xa17),()=>_0x254293(_0xe6e30c['id'])),_0x5dcbd7(_0x1258a2,()=>_0x2c04ea(_0xe6e30c['id'])),_0x41805a[_0x41f3e2(0x31e)](_0x1258a2);});}async function _0x254293(_0x306e93){const _0x3a838c=_0x18b51e,_0x22f74b=_0x405767[_0x3a838c(0x799)][_0x1f6e46];if(!_0x22f74b||!_0x22f74b['diary'])return;const _0x1b6094=_0x22f74b[_0x3a838c(0x9a9)][_0x3a838c(0x2ef)](_0x50b358=>_0x50b358['id']===_0x306e93);if(_0x1b6094){_0x2a4f08=_0x1b6094;const _0x5cb4fd=document[_0x3a838c(0x8c2)](_0x3a838c(0x272)),_0x13c547=document[_0x3a838c(0x8c2)]('char-diary-detail-content'),_0x31ea6b=document[_0x3a838c(0x8c2)](_0x3a838c(0xd11));_0x5cb4fd[_0x3a838c(0x1090)]=_0x1b6094[_0x3a838c(0xcea)];const _0x25cae2=_0x16059c(_0x1b6094[_0x3a838c(0x168)])['split']('\x0a')[_0x3a838c(0x6b9)](_0x460329=>'<p>'+(_0x460329||_0x3a838c(0xd33))+_0x3a838c(0x2e7))[_0x3a838c(0xb2c)]('');_0x13c547[_0x3a838c(0xca0)]=_0x25cae2;const _0x3c0b21=await _0x15043e['favorites'][_0x3a838c(0xdb8)]({'type':_0x3a838c(0x872),'content.id':_0x306e93})['first']();_0x31ea6b[_0x3a838c(0xb17)][_0x3a838c(0xfc3)](_0x3a838c(0x71b),!!_0x3c0b21),_0x5c2ffa(_0x3a838c(0x5f1));}}async function _0x466abc(){const _0x1033be=_0x18b51e;if(!_0x2a4f08||!_0x1f6e46)return;const _0x5ee6f7=_0x2a4f08,_0x5524dd=_0x405767[_0x1033be(0x799)][_0x1f6e46],_0x432e51=document[_0x1033be(0x8c2)](_0x1033be(0xd11)),_0x569598=await _0x15043e[_0x1033be(0xe93)][_0x1033be(0xdb8)]({'type':'char_diary','content.id':_0x5ee6f7['id']})[_0x1033be(0xf2e)]();if(_0x569598)await _0x15043e[_0x1033be(0xe93)][_0x1033be(0x89f)](_0x569598['id']),_0x432e51[_0x1033be(0xb17)]['remove'](_0x1033be(0x71b)),await _0x501c7b(_0x1033be(0x10b7),_0x1033be(0x4ed));else{const _0x32150c={'type':_0x1033be(0x872),'content':{'id':_0x5ee6f7['id'],'title':_0x5ee6f7[_0x1033be(0xcea)],'content':_0x5ee6f7[_0x1033be(0x168)],'timestamp':_0x5ee6f7[_0x1033be(0x351)],'characterId':_0x1f6e46,'characterName':_0x5524dd[_0x1033be(0x596)]},'timestamp':Date[_0x1033be(0x1ed)]()};await _0x15043e['favorites'][_0x1033be(0x3f4)](_0x32150c),_0x432e51[_0x1033be(0xb17)][_0x1033be(0x3f4)](_0x1033be(0x71b)),await _0x501c7b(_0x1033be(0x10b7),_0x1033be(0x2a0));}}async function _0x5558d0(){const _0x3cc2af=_0x18b51e;if(!_0x41e425||!_0x1f6e46)return;const _0x1352ed=_0x41e425,_0x1c3402=_0x405767[_0x3cc2af(0x799)][_0x1f6e46],_0x415900=document[_0x3cc2af(0x8c2)](_0x3cc2af(0x6b5)),_0x123d2b=await _0x15043e[_0x3cc2af(0xe93)][_0x3cc2af(0xdb8)]({'type':_0x3cc2af(0xd7a),'content.id':_0x1352ed['id']})[_0x3cc2af(0xf2e)]();if(_0x123d2b)await _0x15043e[_0x3cc2af(0xe93)][_0x3cc2af(0x89f)](_0x123d2b['id']),_0x415900[_0x3cc2af(0xb17)]['remove'](_0x3cc2af(0x71b)),await _0x501c7b(_0x3cc2af(0x10b7),_0x3cc2af(0x4ed));else{const _0x40345d={'type':_0x3cc2af(0xd7a),'content':{'id':_0x1352ed['id'],'title':_0x1352ed['title'],'content':_0x1352ed[_0x3cc2af(0x168)],'timestamp':_0x1352ed['timestamp'],'characterId':_0x1f6e46,'characterName':_0x1c3402[_0x3cc2af(0x596)]},'timestamp':Date[_0x3cc2af(0x1ed)]()};await _0x15043e[_0x3cc2af(0xe93)]['add'](_0x40345d),_0x415900[_0x3cc2af(0xb17)][_0x3cc2af(0x3f4)]('active'),await _0x501c7b('操作成功',_0x3cc2af(0x2a0));}}async function _0x2c04ea(_0x282e33){const _0x41f322=_0x18b51e,_0xeeb96f=await _0x8b9cb8(_0x41f322(0xa7b),_0x41f322(0xb1b),{'confirmButtonClass':_0x41f322(0xe2a)});if(_0xeeb96f){const _0x473f8a=_0x405767[_0x41f322(0x799)][_0x1f6e46];_0x473f8a[_0x41f322(0x9a9)]=_0x473f8a[_0x41f322(0x9a9)]['filter'](_0x2d1125=>_0x2d1125['id']!==_0x282e33),await _0x15043e[_0x41f322(0x799)][_0x41f322(0xfaa)](_0x473f8a),_0x42cb09();}}async function _0x1ee832(){const _0x488c2f=_0x18b51e,_0x18853c=document[_0x488c2f(0x8c2)](_0x488c2f(0xcf6));_0x18853c[_0x488c2f(0xca0)]='';const _0x1b6400=_0x405767['chats'][_0x1f6e46];if(!_0x1b6400)return;const _0x5ea263=_0x1b6400[_0x488c2f(0x33a)][_0x488c2f(0xe16)]||(_0x405767[_0x488c2f(0x20a)][_0x488c2f(0xab3)]||'我'),_0x429f6f=_0x1b6400[_0x488c2f(0xd39)][_0x488c2f(0x1d8)](_0x4a71d9=>!_0x4a71d9[_0x488c2f(0x3f1)])['slice'](-0x1)[0x0]||{'content':_0x488c2f(0x388)};let _0x423fcb='...';if(_0x429f6f){if(typeof _0x429f6f['content']===_0x488c2f(0xf1b))_0x423fcb=_0x429f6f[_0x488c2f(0x168)];else{if(Array[_0x488c2f(0xb85)](_0x429f6f[_0x488c2f(0x168)])&&_0x429f6f[_0x488c2f(0x168)][0x0]?.['type']===_0x488c2f(0x7a9))_0x423fcb='[图片]';else{if(_0x429f6f[_0x488c2f(0xde0)]){const _0x5ef75f={'voice_message':_0x488c2f(0xa7c),'transfer':_0x488c2f(0x544),'ai_image':_0x488c2f(0xcb0)};_0x423fcb=_0x5ef75f[_0x429f6f[_0x488c2f(0xde0)]]||'['+_0x429f6f[_0x488c2f(0xde0)]+']';}}}}const _0x5df013=_0x1b6400['settings']['myAvatar']||_0x49d2a4,_0x1d103a=_0x1b6400[_0x488c2f(0x33a)][_0x488c2f(0x538)]||'';let _0x23e812;_0x1d103a?_0x23e812=_0x488c2f(0x10e7)+_0x5df013+_0x488c2f(0x3e5)+_0x1d103a+_0x488c2f(0x4d9):_0x23e812=_0x488c2f(0x9c8)+_0x5df013+_0x488c2f(0xb12);const _0x5d8f30=document['createElement'](_0x488c2f(0x1072));_0x5d8f30[_0x488c2f(0x84c)]=_0x488c2f(0x441),_0x5d8f30['dataset'][_0x488c2f(0xd08)]='-1',_0x5d8f30[_0x488c2f(0xca0)]=_0x488c2f(0x1022)+_0x23e812+_0x488c2f(0xd09)+_0x5ea263+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>'+String(_0x423fcb)['substring'](0x0,0x14)+_0x488c2f(0x5e0),_0x18853c[_0x488c2f(0x31e)](_0x5d8f30);const _0x44ae31=await _0x15043e[_0x488c2f(0xa4a)][_0x488c2f(0x6be)](),_0x4a81a6=new Map(_0x44ae31[_0x488c2f(0x6b9)](_0x20538b=>[_0x20538b['name'],_0x20538b])),_0x4614ff=_0x1b6400[_0x488c2f(0x882)]||[];if(_0x4614ff[_0x488c2f(0x105a)]===0x0&&!_0x5d8f30){_0x18853c[_0x488c2f(0xca0)]=_0x488c2f(0x8f2);return;}_0x4614ff[_0x488c2f(0x7c0)]((_0x427cb0,_0x412125)=>{const _0x3dafbb=_0x488c2f;if(_0x427cb0['type']===_0x3dafbb(0x8cb))return;const _0x4e0623=document[_0x3dafbb(0x8c1)]('div');_0x4e0623['className']=_0x3dafbb(0x441),_0x4e0623[_0x3dafbb(0x323)][_0x3dafbb(0xd08)]=_0x412125;let _0x324ef2,_0xa621f7,_0x43d5d6;if(_0x427cb0[_0x3dafbb(0xde0)]===_0x3dafbb(0x92f)){_0x43d5d6=_0x427cb0[_0x3dafbb(0xd6d)]+'\x20<span\x20class=\x22group-tag\x22>群</span>',_0x324ef2=_0x427cb0[_0x3dafbb(0xe42)][_0x3dafbb(0x961)](-0x1)[0x0]||{'content':_0x3dafbb(0x388)};const _0x4498b6='logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27'+_0x427cb0[_0x3dafbb(0xd6d)]+'\x27',_0x27cff3=_0x405767[_0x3dafbb(0xb73)][_0x3dafbb(0xd00)]?_0x3dafbb(0x2c6)+encodeURIComponent(_0x4498b6):_0x56835c;_0xa621f7=_0x3dafbb(0xc84)+_0x27cff3+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>';}else{_0x43d5d6=_0x427cb0[_0x3dafbb(0xfea)][_0x3dafbb(0x596)],_0x324ef2=_0x427cb0['messages'][_0x3dafbb(0x961)](-0x1)[0x0]||{'content':'...'};const _0x44f965=_0x4a81a6[_0x3dafbb(0x3e9)](_0x43d5d6);let _0x22626b=_0x44f965&&_0x44f965['avatar']?_0x44f965[_0x3dafbb(0x1e1)]:_0x405767['globalSettings'][_0x3dafbb(0xd00)]?_0x3dafbb(0x2c6)+encodeURIComponent(_0x427cb0[_0x3dafbb(0xfea)][_0x3dafbb(0x10f4)]||_0x3dafbb(0x782)):_0x9fdc61;_0xa621f7=_0x3dafbb(0xc84)+_0x22626b+_0x3dafbb(0x1020);}let _0x3a7f9f=_0x3dafbb(0x388);_0x324ef2&&_0x324ef2[_0x3dafbb(0x168)]&&(_0x3a7f9f=_0x324ef2[_0x3dafbb(0x168)]),_0x4e0623['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xa621f7+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x43d5d6+_0x3dafbb(0xb3b)+String(_0x3a7f9f)[_0x3dafbb(0x599)](0x0,0x14)+_0x3dafbb(0x2d9),_0x18853c[_0x3dafbb(0x31e)](_0x4e0623);});}async function _0x63671b(){const _0x4d01ff=_0x18b51e;if(!_0x1f6e46)return;const _0x16913e=_0x405767[_0x4d01ff(0x799)][_0x1f6e46];if(!_0x16913e)return;await _0x501c7b(_0x4d01ff(0x1047),_0x4d01ff(0xee4)+_0x16913e[_0x4d01ff(0x596)]+'”的记忆和人设，生成全新的社交动态...');const {proxyUrl:_0x426740,apiKey:_0x481b2f,model:_0xe05f12}=_0x405767[_0x4d01ff(0x9e0)];if(!_0x426740||!_0x481b2f||!_0xe05f12){alert(_0x4d01ff(0x6c2));return;}const _0x55a56c=await _0x15043e['npcs'][_0x4d01ff(0x6be)](),_0x20ecff=_0x55a56c[_0x4d01ff(0x1d8)](_0x2beeae=>_0x2beeae[_0x4d01ff(0xc9d)]&&_0x2beeae[_0x4d01ff(0xc9d)][_0x4d01ff(0x773)](_0x1f6e46));let _0x4613dd='#\x20你的社交圈\x20(绑定的NPC)\x0a';_0x20ecff[_0x4d01ff(0x105a)]>0x0?(_0x4613dd+='这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a',_0x20ecff[_0x4d01ff(0x7c0)](_0x38288f=>{const _0x4cf0ea=_0x4d01ff;_0x4613dd+=_0x4cf0ea(0x7bf)+_0x38288f['name']+_0x4cf0ea(0x91d)+_0x38288f['persona']+'\x0a';})):_0x4613dd+=_0x4d01ff(0x195);const _0xbf66fa=_0x405767['qzoneSettings'][_0x4d01ff(0xab3)]==='{{user}}'||!_0x405767[_0x4d01ff(0x20a)]['nickname']?'用户':_0x405767['qzoneSettings'][_0x4d01ff(0xab3)],_0x2b3450=_0x16913e[_0x4d01ff(0x33a)][_0x4d01ff(0xe16)]||_0xbf66fa,_0x17b81e=_0x16913e[_0x4d01ff(0xbca)]&&_0x16913e[_0x4d01ff(0xbca)][_0x4d01ff(0x105a)]>0x0?_0x16913e['longTermMemory'][_0x4d01ff(0x6b9)](_0x333341=>_0x4d01ff(0xc09)+_0x4f34be(_0x333341[_0x4d01ff(0x351)])+')\x20'+_0x333341[_0x4d01ff(0x168)])[_0x4d01ff(0xb2c)]('\x0a'):'无',_0xfd8aee=_0x16913e[_0x4d01ff(0x33a)][_0x4d01ff(0x808)]||0xa,_0x359929=_0x16913e['history'][_0x4d01ff(0x961)](-_0xfd8aee)[_0x4d01ff(0x6b9)](_0x4c0ff2=>(_0x4c0ff2[_0x4d01ff(0x14a)]===_0x4d01ff(0x74b)?_0x2b3450:_0x16913e['name'])+':\x20'+String(_0x4c0ff2['content'])['substring'](0x0,0x1e)+_0x4d01ff(0x388))[_0x4d01ff(0xb2c)]('\x0a'),_0x2ee92e=(_0x16913e[_0x4d01ff(0x33a)]['linkedWorldBookIds']||[])['map'](_0x4babcc=>_0x405767[_0x4d01ff(0x40e)][_0x4d01ff(0x2ef)](_0x20d1d8=>_0x20d1d8['id']===_0x4babcc))[_0x4d01ff(0x1d8)](Boolean)['map'](_0x19fc38=>_0x4d01ff(0xec0)+_0x19fc38[_0x4d01ff(0x596)]+_0x4d01ff(0xf65)+_0x19fc38[_0x4d01ff(0x168)][_0x4d01ff(0x1d8)](_0x25f89e=>_0x25f89e[_0x4d01ff(0x69a)])[_0x4d01ff(0x6b9)](_0x5ea0fa=>'-\x20'+_0x5ea0fa[_0x4d01ff(0x168)])[_0x4d01ff(0xb2c)]('\x0a'))[_0x4d01ff(0xb2c)](''),_0x4ff31b=_0x16913e['originalName']||_0x16913e[_0x4d01ff(0x596)],_0x125ecb=_0x4d01ff(0xe49)+_0x16913e[_0x4d01ff(0x596)]+_0x4d01ff(0x6ac)+_0x4ff31b+_0x4d01ff(0xaca)+_0x4ff31b+'\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22}\x0a\x20\x20]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20'+_0x16913e[_0x4d01ff(0x33a)][_0x4d01ff(0x1060)]+'\x0a-\x20**你的长期记忆**:\x20'+_0x17b81e+_0x4d01ff(0x583)+_0x2ee92e+_0x4d01ff(0xc9f)+_0x359929+'\x0a'+_0x4613dd+_0x4d01ff(0x5ab);try{const _0xce7aaf=[{'role':_0x4d01ff(0x74b),'content':_0x4d01ff(0x9f4)}];let _0x2ae6d1=_0x426740[_0x4d01ff(0x773)](_0x4d01ff(0x3fe)),_0x21b0b1=_0x282b7e(_0xe05f12,_0x481b2f,_0x125ecb,_0xce7aaf);const _0x335ce8=_0x2ae6d1?await fetch(_0x21b0b1['url'],_0x21b0b1[_0x4d01ff(0x49a)]):await fetch(_0x426740+_0x4d01ff(0x5c1),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x481b2f},'body':JSON['stringify']({'model':_0xe05f12,'messages':[{'role':_0x4d01ff(0x46c),'content':_0x125ecb},..._0xce7aaf],'temperature':_0x405767[_0x4d01ff(0xb73)][_0x4d01ff(0x8c7)]||0.9})});if(!_0x335ce8['ok'])throw new Error(_0x4d01ff(0xd83)+_0x335ce8[_0x4d01ff(0xd05)]);const _0x3d29e1=await _0x335ce8[_0x4d01ff(0x7e9)](),_0x2745c5=getGeminiResponseText(_0x3d29e1),_0x42e1ed=_0x2745c5[_0x4d01ff(0xdf8)](/(\[[\s\S]*\])/);if(!_0x42e1ed||!_0x42e1ed[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x2745c5);const _0x102765=_0x42e1ed[0x0];let _0x47eddd;try{_0x47eddd=JSON[_0x4d01ff(0x10ab)](_0x102765);}catch(_0x450e85){throw new Error(_0x4d01ff(0x918)+_0x450e85[_0x4d01ff(0xc7d)]+_0x4d01ff(0x15c)+_0x2745c5);}_0x16913e['simulatedConversations']=_0x47eddd,await _0x15043e['chats']['put'](_0x16913e),await _0x1ee832();const _0x1d1997={'role':_0x4d01ff(0x46c),'content':_0x4d01ff(0x735),'timestamp':Date[_0x4d01ff(0x1ed)](),'isHidden':!![]};_0x16913e[_0x4d01ff(0xd39)][_0x4d01ff(0xa49)](_0x1d1997),await _0x15043e['chats'][_0x4d01ff(0xfaa)](_0x16913e),_0x523815();}catch(_0x59dcf8){console[_0x4d01ff(0x7a3)](_0x4d01ff(0x911),_0x59dcf8),await _0x501c7b(_0x4d01ff(0x40b),_0x4d01ff(0x11bb)+_0x59dcf8['message']);}}async function _0x365b33(){const _0x1d18be=_0x18b51e;if(!_0x1f6e46)return;const _0x34afa3=_0x405767['chats'][_0x1f6e46];if(!_0x34afa3)return;try{const {proxyUrl:_0x4d11f4,apiKey:_0x422c2b,model:_0x58a7c7}=_0x405767[_0x1d18be(0x9e0)];if(!_0x4d11f4||!_0x422c2b||!_0x58a7c7)throw new Error(_0x1d18be(0xed5));const _0x2cf4d2=parseInt(_0x34afa3[_0x1d18be(0x33a)][_0x1d18be(0x808)])||0xa,_0x4226e6=_0x34afa3[_0x1d18be(0xd39)][_0x1d18be(0x961)](-_0x2cf4d2),_0x583e6d=_0x34afa3[_0x1d18be(0x33a)][_0x1d18be(0xe16)]||'我',_0x402c68=_0x34afa3[_0x1d18be(0x33a)][_0x1d18be(0xbe8)]||'用户',_0x18f18d='#\x20长期记忆\x20(必须严格遵守)\x0a'+(_0x34afa3['longTermMemory']&&_0x34afa3['longTermMemory'][_0x1d18be(0x105a)]>0x0?_0x34afa3[_0x1d18be(0xbca)][_0x1d18be(0x6b9)](_0x10f450=>'-\x20'+_0x10f450[_0x1d18be(0x168)])[_0x1d18be(0xb2c)]('\x0a'):_0x1d18be(0xbee));let _0x4331d4='';if(_0x34afa3[_0x1d18be(0x33a)]['linkedWorldBookIds']&&_0x34afa3[_0x1d18be(0x33a)][_0x1d18be(0xb77)][_0x1d18be(0x105a)]>0x0){const _0x82daba=_0x34afa3[_0x1d18be(0x33a)][_0x1d18be(0xb77)]['map'](_0x268809=>{const _0xbf36ca=_0x1d18be,_0x2dac14=_0x405767[_0xbf36ca(0x40e)][_0xbf36ca(0x2ef)](_0x1776d9=>_0x1776d9['id']===_0x268809);if(!_0x2dac14||!Array[_0xbf36ca(0xb85)](_0x2dac14[_0xbf36ca(0x168)]))return'';const _0x2e4ecb=_0x2dac14[_0xbf36ca(0x168)][_0xbf36ca(0x1d8)](_0xe9b3c0=>_0xe9b3c0[_0xbf36ca(0x69a)]!==![])['map'](_0x4e55c1=>_0xbf36ca(0xf8d)+(_0x4e55c1['comment']||_0xbf36ca(0x11db))+_0xbf36ca(0x16b)+_0x4e55c1[_0xbf36ca(0x168)])[_0xbf36ca(0xb2c)]('');return _0x2e4ecb?_0xbf36ca(0x15d)+_0x2dac14[_0xbf36ca(0x596)]+'\x0a'+_0x2e4ecb:'';})[_0x1d18be(0x1d8)](Boolean)[_0x1d18be(0xb2c)]('');_0x82daba&&(_0x4331d4='\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a'+_0x82daba+'\x0a');}const _0x5444d0=_0x5e1bc2(_0x34afa3,0x3,_0x1d18be(0x834)),_0x16d01a=_0x5e1bc2(_0x34afa3,0x6,_0x1d18be(0x834)),_0x574df5=_0x5e1bc2(_0x34afa3,0x9,'hours'),_0x1a3505=_0x5e1bc2(_0x34afa3,0x1,_0x1d18be(0x1a0)),_0x32144b=_0x5e1bc2(_0x34afa3,0x3,_0x1d18be(0x1a0)),_0x3e7376=_0x5e1bc2(_0x34afa3,0x7,_0x1d18be(0x1a0));let _0xa583e7='';if(_0x5444d0||_0x16d01a||_0x574df5||_0x1a3505||_0x32144b||_0x3e7376){_0xa583e7+=_0x1d18be(0x2c2);if(_0x5444d0)_0xa583e7+=_0x5444d0;if(_0x16d01a)_0xa583e7+=_0x16d01a;if(_0x574df5)_0xa583e7+=_0x574df5;if(_0x5444d0||_0x16d01a||_0x574df5)_0xa583e7+='\x0a';if(_0x1a3505)_0xa583e7+=_0x1a3505;if(_0x32144b)_0xa583e7+=_0x32144b;if(_0x3e7376)_0xa583e7+=_0x3e7376;}const _0x4bf40c=_0x1d18be(0xa37)+_0x34afa3[_0x1d18be(0x4e7)]+_0x1d18be(0xa41)+_0x34afa3[_0x1d18be(0x33a)][_0x1d18be(0x1060)]+'\x0a\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x402c68+_0x1d18be(0x898)+_0x34afa3['originalName']+'\x22\x0a-\x20**用户的备注**:\x20\x22'+_0x583e6d+'\x22\x0a'+_0x4331d4+'\x0a'+_0x18f18d+'\x0a'+_0xa583e7+_0x1d18be(0x1100)+_0x4226e6[_0x1d18be(0x6b9)](_0x53492d=>(_0x53492d['role']===_0x1d18be(0x74b)?_0x583e6d:_0x34afa3[_0x1d18be(0x596)])+':\x20'+String(_0x53492d['content']))[_0x1d18be(0xb2c)]('\x0a')+'\x0a\x0a现在，请继续这场对话。\x0a',_0x343271=_0x4226e6[_0x1d18be(0x6b9)](_0x5c7aed=>({'role':_0x5c7aed[_0x1d18be(0x14a)],'content':(_0x5c7aed['role']===_0x1d18be(0x74b)?_0x583e6d:_0x34afa3[_0x1d18be(0x596)])+':\x20'+String(_0x5c7aed['content'])}));let _0xfde092=_0x4d11f4[_0x1d18be(0x773)](_0x1d18be(0x3fe)),_0x3604a3=_0x282b7e(_0x58a7c7,_0x422c2b,_0x4bf40c,_0x343271);const _0x5087d6=_0xfde092?await fetch(_0x3604a3[_0x1d18be(0x9d6)],_0x3604a3[_0x1d18be(0x49a)]):await fetch(_0x4d11f4+_0x1d18be(0x5c1),{'method':_0x1d18be(0xcd0),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x422c2b},'body':JSON[_0x1d18be(0x1175)]({'model':_0x58a7c7,'messages':[{'role':_0x1d18be(0x46c),'content':_0x4bf40c},..._0x343271],'temperature':_0x405767[_0x1d18be(0xb73)][_0x1d18be(0x8c7)]||0.8})});if(!_0x5087d6['ok'])throw new Error(_0x1d18be(0x1d9)+(await _0x5087d6[_0x1d18be(0x7e9)]())[_0x1d18be(0x7a3)][_0x1d18be(0xc7d)]);const _0x19cff9=await _0x5087d6['json'](),_0x44a5e4=getGeminiResponseText(_0x19cff9),_0x55dc02=_0x5196dd(_0x44a5e4);if(!_0x55dc02||_0x55dc02['length']===0x0)throw new Error(_0x1d18be(0x990));let _0x5a00d6=0x0,_0x3e9920=Date[_0x1d18be(0x1ed)]();for(const _0x2f4b0d of _0x55dc02){const _0x49de62={'role':_0x1d18be(0x458),'senderName':_0x34afa3[_0x1d18be(0x4e7)],'timestamp':_0x3e9920++};let _0x870c8d=null;switch(_0x2f4b0d['type']){case _0x1d18be(0xbc6):_0x870c8d={..._0x49de62,'content':String(_0x2f4b0d['content']||_0x2f4b0d[_0x1d18be(0xc7d)])};break;case'sticker':_0x870c8d={..._0x49de62,'type':'sticker','content':_0x2f4b0d[_0x1d18be(0x9d6)],'meaning':_0x2f4b0d[_0x1d18be(0x2b7)]||''};break;}_0x870c8d&&(_0x34afa3[_0x1d18be(0xd39)][_0x1d18be(0xa49)](_0x870c8d),_0x5a00d6++);}_0x5a00d6>0x0&&(_0x34afa3[_0x1d18be(0xf10)]=(_0x34afa3[_0x1d18be(0xf10)]||0x0)+_0x5a00d6),await _0x15043e[_0x1d18be(0x799)][_0x1d18be(0xfaa)](_0x34afa3),await _0x2b55d1(),_0x5a00d6>0x0&&_0x979d69(_0x34afa3['id'],_0x1d18be(0x338)+_0x5a00d6+_0x1d18be(0xb8c));}catch(_0x6060d2){console[_0x1d18be(0x7a3)](_0x1d18be(0x748),_0x6060d2),await _0x501c7b(_0x1d18be(0xa85),_0x1d18be(0x1192)+_0x6060d2[_0x1d18be(0xc7d)]);}}async function _0x1ecca3(){const _0x2f9c83=_0x18b51e;if(_0x451dc7||!_0x1f6e46)return;_0x451dc7=!![];const _0x472ad9=document[_0x2f9c83(0x8c2)](_0x2f9c83(0xcac)),_0x3034a1=_0x405767['chats'][_0x1f6e46];if(!_0x3034a1){_0x451dc7=![];return;}_0x21c28a(_0x472ad9,_0x2f9c83(0x9a4));const _0x1394dd=_0x472ad9[_0x2f9c83(0xb43)];await new Promise(_0x342951=>setTimeout(_0x342951,0x1f4));const _0xfc4903=_0x3034a1['history']['length'],_0x26a50c=_0x405767[_0x2f9c83(0xb73)][_0x2f9c83(0x3dd)]||0x32,_0x566129=_0xfc4903-_0x2564c3,_0x4f80e5=Math[_0x2f9c83(0x171)](0x0,_0x566129-_0x26a50c),_0xf747b9=_0x3034a1[_0x2f9c83(0xd39)][_0x2f9c83(0x961)](_0x4f80e5,_0x566129);_0x45f5dc(_0x472ad9);if(_0xf747b9[_0x2f9c83(0x105a)]===0x0){_0x451dc7=![];return;}for(const _0x436067 of _0xf747b9['reverse']()){const _0x1fcd54={..._0x436067,'role':_0x436067[_0x2f9c83(0x14a)]===_0x2f9c83(0x74b)?_0x2f9c83(0x458):_0x2f9c83(0x74b)},_0x189f98={'id':_0x2f9c83(0x11eb),'isGroup':![],'name':_0x3034a1[_0x2f9c83(0x596)],'settings':{..._0x3034a1[_0x2f9c83(0x33a)],'myAvatar':_0x3034a1[_0x2f9c83(0x33a)][_0x2f9c83(0x44e)],'myAvatarFrame':_0x3034a1[_0x2f9c83(0x33a)][_0x2f9c83(0x1b1)],'aiAvatar':_0x3034a1[_0x2f9c83(0x33a)][_0x2f9c83(0x11ed)],'aiAvatarFrame':_0x3034a1[_0x2f9c83(0x33a)][_0x2f9c83(0x538)]}},_0xac192=await _0x3cd22d(_0x1fcd54,_0x189f98);_0xac192&&_0x472ad9[_0x2f9c83(0x1ba)](_0xac192);}_0x2564c3+=_0xf747b9[_0x2f9c83(0x105a)];const _0x384cfb=_0x472ad9[_0x2f9c83(0xb43)];_0x472ad9[_0x2f9c83(0xfd0)]=_0x384cfb-_0x1394dd,_0x451dc7=![];}async function _0x14c4a9(_0x117887){const _0x5a4529=_0x18b51e,_0x1a30b4=_0x405767[_0x5a4529(0x799)][_0x1f6e46];if(_0x117887===-0x1){_0x14e3cf=_0x5a4529(0x8cb);const _0x2247b7=document[_0x5a4529(0x8c2)](_0x5a4529(0x275)),_0x17eab0=document['getElementById'](_0x5a4529(0xcac)),_0x1547b0=document[_0x5a4529(0x8c2)]('char-simulated-input');_0x17eab0[_0x5a4529(0xca0)]='',_0x2247b7[_0x5a4529(0x1090)]=_0x1a30b4['settings']['myNickname']||(_0x405767[_0x5a4529(0x20a)][_0x5a4529(0xab3)]||'我'),_0x1547b0[_0x5a4529(0x691)]='与\x20'+(_0x1a30b4[_0x5a4529(0x33a)]['myNickname']||'我')+_0x5a4529(0x669),_0x2564c3=0x0,_0x451dc7=![];const _0x4ed868=_0x1a30b4[_0x5a4529(0xd39)],_0x18b722=_0x405767[_0x5a4529(0xb73)]['chatRenderWindow']||0x32,_0x4ddd81=_0x4ed868[_0x5a4529(0x961)](-_0x18b722),_0x23d602={'id':'temp_user_chat_mirror','isGroup':![],'name':_0x1a30b4[_0x5a4529(0x596)],'settings':{..._0x1a30b4[_0x5a4529(0x33a)],'myAvatar':_0x1a30b4[_0x5a4529(0x33a)][_0x5a4529(0x44e)],'myAvatarFrame':_0x1a30b4[_0x5a4529(0x33a)][_0x5a4529(0x1b1)],'aiAvatar':_0x1a30b4['settings'][_0x5a4529(0x11ed)],'aiAvatarFrame':_0x1a30b4[_0x5a4529(0x33a)][_0x5a4529(0x538)]}};for(const _0x1068dd of _0x4ddd81){const _0x57d4cd={..._0x1068dd,'role':_0x1068dd[_0x5a4529(0x14a)]===_0x5a4529(0x74b)?_0x5a4529(0x458):_0x5a4529(0x74b)},_0x6102c6=await _0x3cd22d(_0x57d4cd,_0x23d602);_0x6102c6&&_0x17eab0[_0x5a4529(0x31e)](_0x6102c6);}_0x2564c3=_0x4ddd81[_0x5a4529(0x105a)],_0x5c2ffa(_0x5a4529(0xafa)),setTimeout(()=>_0x17eab0['scrollTop']=_0x17eab0[_0x5a4529(0xb43)],0x0);return;}const _0x172d8d=_0x1a30b4[_0x5a4529(0x882)][_0x117887];if(!_0x172d8d)return;_0x14e3cf=_0x172d8d[_0x5a4529(0xde0)];const _0x19ddc7=await _0x15043e[_0x5a4529(0xa4a)]['toArray'](),_0x5e213e=new Map(_0x19ddc7[_0x5a4529(0x6b9)](_0x35dadc=>[_0x35dadc[_0x5a4529(0x596)],_0x35dadc])),_0x139e38=document['getElementById'](_0x5a4529(0x275)),_0x40c110=document[_0x5a4529(0x8c2)](_0x5a4529(0xcac)),_0x38dfaf=document[_0x5a4529(0x8c2)](_0x5a4529(0x1179));_0x40c110[_0x5a4529(0xca0)]='',_0x40c110['dataset'][_0x5a4529(0xf95)]=_0x1a30b4[_0x5a4529(0x33a)][_0x5a4529(0xf95)]||_0x5a4529(0x674);const _0x16fe0d=document[_0x5a4529(0x8c2)](_0x5a4529(0x5e7))[_0x5a4529(0xb17)][_0x5a4529(0x795)]('dark-mode');_0x40c110[_0x5a4529(0x842)][_0x5a4529(0x617)]=_0x16fe0d?_0x5a4529(0x576):'#f0f2f5';let _0x33a6d0;if(_0x172d8d[_0x5a4529(0xde0)]===_0x5a4529(0x92f)){_0x139e38[_0x5a4529(0x1090)]=_0x172d8d[_0x5a4529(0xd6d)]+'\x20('+(_0x172d8d[_0x5a4529(0x190)][_0x5a4529(0x105a)]+0x1)+')',_0x38dfaf[_0x5a4529(0x691)]='在\x20'+_0x172d8d['groupName']+'\x20中聊天',_0x33a6d0={'id':_0x5a4529(0xbb6),'isGroup':!![],'name':_0x172d8d[_0x5a4529(0xd6d)],'originalName':_0x1a30b4[_0x5a4529(0x4e7)],'members':_0x172d8d[_0x5a4529(0x190)][_0x5a4529(0x6b9)](_0x571524=>{const _0x2bbc63=_0x5a4529,_0x499f5c=_0x5e213e[_0x2bbc63(0x3e9)](_0x571524[_0x2bbc63(0x596)]);let _0xab0928=_0x499f5c&&_0x499f5c['avatar']?_0x499f5c['avatar']:_0x405767[_0x2bbc63(0xb73)]['enableAiDrawing']?_0x2bbc63(0x2c6)+encodeURIComponent(_0x571524['avatar_prompt']||_0x2bbc63(0x782)):_0x9fdc61;return{'originalName':_0x571524['name'],'groupNickname':_0x571524[_0x2bbc63(0x596)],'avatar':_0xab0928};}),'settings':{..._0x1a30b4['settings'],'myNickname':_0x1a30b4[_0x5a4529(0x596)],'myAvatar':_0x1a30b4[_0x5a4529(0x33a)][_0x5a4529(0x44e)],'myAvatarFrame':_0x1a30b4[_0x5a4529(0x33a)][_0x5a4529(0x1b1)]}};for(const _0xeaaca7 of _0x172d8d[_0x5a4529(0xe42)]){const _0x128517=_0xeaaca7[_0x5a4529(0x7d3)]===(_0x1a30b4[_0x5a4529(0x4e7)]||_0x1a30b4['name']),_0x2f625c=_0x128517?_0x5a4529(0x74b):_0x5a4529(0x458),_0x4f3e4a={'role':_0x2f625c,'senderName':_0xeaaca7[_0x5a4529(0x7d3)],'content':_0xeaaca7[_0x5a4529(0x168)],'timestamp':Date[_0x5a4529(0x1ed)]()+Math[_0x5a4529(0x5b3)]()},_0x419c5f=await _0x3cd22d(_0x4f3e4a,_0x33a6d0);_0x419c5f&&_0x40c110['appendChild'](_0x419c5f);}}else{_0x139e38['textContent']=_0x172d8d['participant'][_0x5a4529(0x596)],_0x38dfaf[_0x5a4529(0x691)]='与\x20'+_0x172d8d[_0x5a4529(0xfea)][_0x5a4529(0x596)]+_0x5a4529(0xdfc);const _0x395ea0=_0x5e213e[_0x5a4529(0x3e9)](_0x172d8d[_0x5a4529(0xfea)][_0x5a4529(0x596)]),_0x3f2b5a=_0x395ea0&&_0x395ea0[_0x5a4529(0x1e1)]?_0x395ea0[_0x5a4529(0x1e1)]:_0x405767[_0x5a4529(0xb73)]['enableAiDrawing']?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x172d8d[_0x5a4529(0xfea)][_0x5a4529(0x10f4)]||_0x5a4529(0x782)):_0x9fdc61;_0x33a6d0={'id':_0x5a4529(0x4dc),'isGroup':![],'name':_0x172d8d[_0x5a4529(0xfea)][_0x5a4529(0x596)],'originalName':_0x1a30b4[_0x5a4529(0x4e7)],'settings':{..._0x1a30b4[_0x5a4529(0x33a)],'myAvatar':_0x1a30b4[_0x5a4529(0x33a)][_0x5a4529(0x44e)],'myAvatarFrame':_0x1a30b4[_0x5a4529(0x33a)][_0x5a4529(0x1b1)],'aiAvatar':_0x3f2b5a,'aiAvatarFrame':''}};for(const _0x189bf4 of _0x172d8d[_0x5a4529(0xe42)]){const _0x145d88=_0x189bf4[_0x5a4529(0x7d3)]===(_0x1a30b4[_0x5a4529(0x4e7)]||_0x1a30b4[_0x5a4529(0x596)]),_0x53dfd7=_0x145d88?_0x5a4529(0x74b):'assistant',_0x4d6777={'role':_0x53dfd7,'senderName':_0x189bf4[_0x5a4529(0x7d3)],'content':_0x189bf4['content'],'timestamp':Date['now']()+Math[_0x5a4529(0x5b3)]()},_0x22005c=await _0x3cd22d(_0x4d6777,_0x33a6d0);_0x22005c&&_0x40c110[_0x5a4529(0x31e)](_0x22005c);}}_0x5c2ffa('char-qq-conversation-screen'),_0x40c110[_0x5a4529(0xfd0)]=_0x40c110[_0x5a4529(0xb43)];}function _0x43a562(){const _0x1cc145=_0x18b51e;document[_0x1cc145(0x8c2)](_0x1cc145(0xd79))[_0x1cc145(0xb17)][_0x1cc145(0xaff)](_0x1cc145(0x2cd));}async function _0x525d8a(){const _0xc11cdf=_0x18b51e;if(!_0x1f6e46)return;const _0x51baaa=_0x405767['chats'][_0x1f6e46];if(!_0x51baaa){await _0x501c7b(_0xc11cdf(0xa85),_0xc11cdf(0x9e8));return;}await _0x501c7b(_0xc11cdf(0x1047),_0xc11cdf(0xf15)+_0x51baaa[_0xc11cdf(0x596)]+'”回忆TA的相册照片...');const {proxyUrl:_0x177de3,apiKey:_0x1f9d25,model:_0x1b6ab0}=_0x405767[_0xc11cdf(0x9e0)];if(!_0x177de3||!_0x1f9d25||!_0x1b6ab0){alert(_0xc11cdf(0x6c2));return;}const _0xad8fb7=_0x405767['qzoneSettings']['nickname']===_0xc11cdf(0x2dc)||!_0x405767[_0xc11cdf(0x20a)][_0xc11cdf(0xab3)]?'用户':_0x405767[_0xc11cdf(0x20a)]['nickname'],_0x480b45=_0x51baaa[_0xc11cdf(0xbca)]&&_0x51baaa[_0xc11cdf(0xbca)][_0xc11cdf(0x105a)]>0x0?_0x51baaa[_0xc11cdf(0xbca)][_0xc11cdf(0x6b9)](_0x5e6ee5=>'-\x20(记录于\x20'+_0x4f34be(_0x5e6ee5[_0xc11cdf(0x351)])+')\x20'+_0x5e6ee5[_0xc11cdf(0x168)])[_0xc11cdf(0xb2c)]('\x0a'):'无',_0x27e77f=_0x51baaa['settings']['maxMemory']||0xa,_0x29f600=_0x51baaa[_0xc11cdf(0xd39)]['slice'](-_0x27e77f)[_0xc11cdf(0x6b9)](_0x2acd84=>(_0x2acd84['role']==='user'?_0xad8fb7:_0x51baaa[_0xc11cdf(0x596)])+':\x20'+String(_0x2acd84[_0xc11cdf(0x168)])['substring'](0x0,0x1e)+_0xc11cdf(0x388))[_0xc11cdf(0xb2c)]('\x0a'),_0x4738be=(_0x51baaa[_0xc11cdf(0x33a)][_0xc11cdf(0xb77)]||[])[_0xc11cdf(0x6b9)](_0x1974c4=>_0x405767['worldBooks'][_0xc11cdf(0x2ef)](_0x2d5f6e=>_0x2d5f6e['id']===_0x1974c4))[_0xc11cdf(0x1d8)](Boolean)[_0xc11cdf(0x6b9)](_0x5ccdcf=>_0xc11cdf(0xec0)+_0x5ccdcf[_0xc11cdf(0x596)]+_0xc11cdf(0x405)+_0x5ccdcf[_0xc11cdf(0x168)][_0xc11cdf(0x1d8)](_0xbc7ab=>_0xbc7ab[_0xc11cdf(0x69a)])[_0xc11cdf(0x6b9)](_0x426779=>'-\x20'+_0x426779['content'])['join']('\x0a'))[_0xc11cdf(0xb2c)](''),_0x50b09f=_0x5e1bc2(_0x51baaa,0x3,_0xc11cdf(0x834)),_0x3ae3e6=_0x5e1bc2(_0x51baaa,0x6,'hours'),_0x20fb9a=_0x5e1bc2(_0x51baaa,0x9,'hours'),_0x56284c=_0x5e1bc2(_0x51baaa,0x1,'days'),_0x115bc8=_0x5e1bc2(_0x51baaa,0x3,_0xc11cdf(0x1a0)),_0x5b350a=_0x5e1bc2(_0x51baaa,0x7,_0xc11cdf(0x1a0));let _0x2ad468='';if(_0x50b09f||_0x3ae3e6||_0x20fb9a||_0x56284c||_0x115bc8||_0x5b350a){_0x2ad468+=_0xc11cdf(0x2c2);if(_0x50b09f)_0x2ad468+=_0x50b09f;if(_0x3ae3e6)_0x2ad468+=_0x3ae3e6;if(_0x20fb9a)_0x2ad468+=_0x20fb9a;if(_0x50b09f||_0x3ae3e6||_0x20fb9a)_0x2ad468+='\x0a';if(_0x56284c)_0x2ad468+=_0x56284c;if(_0x115bc8)_0x2ad468+=_0x115bc8;if(_0x5b350a)_0x2ad468+=_0x5b350a;}const _0x367ff4='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x51baaa['name']+_0xc11cdf(0x65e)+_0x51baaa[_0xc11cdf(0x33a)][_0xc11cdf(0x1060)]+'\x0a'+_0x480b45+'\x0a'+_0x4738be+'\x0a'+_0x2ad468+_0xc11cdf(0x327)+_0xad8fb7+_0xc11cdf(0x632)+_0x29f600+'\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。';try{const _0x20aab8=[{'role':_0xc11cdf(0x74b),'content':'请根据你的设定，生成你的相册内容。'}];let _0x10d2f9=_0x177de3['includes'](_0xc11cdf(0x3fe)),_0x40e6f2=_0x282b7e(_0x1b6ab0,_0x1f9d25,_0x367ff4,_0x20aab8);const _0x4aeff7=_0x10d2f9?await fetch(_0x40e6f2[_0xc11cdf(0x9d6)],_0x40e6f2['data']):await fetch(_0x177de3+_0xc11cdf(0x5c1),{'method':_0xc11cdf(0xcd0),'headers':{'Content-Type':_0xc11cdf(0xcb6),'Authorization':_0xc11cdf(0xf42)+_0x1f9d25},'body':JSON['stringify']({'model':_0x1b6ab0,'messages':[{'role':_0xc11cdf(0x46c),'content':_0x367ff4},..._0x20aab8],'temperature':_0x405767[_0xc11cdf(0xb73)]['apiTemperature']||0.9})});if(!_0x4aeff7['ok'])throw new Error('API\x20错误:\x20'+_0x4aeff7[_0xc11cdf(0xd05)]);const _0xbb9fd4=await _0x4aeff7[_0xc11cdf(0x7e9)](),_0xdcbdd4=getGeminiResponseText(_0xbb9fd4),_0x2e7989=_0xdcbdd4['match'](/(\[[\s\S]*\])/);if(!_0x2e7989||!_0x2e7989[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0xdcbdd4);const _0x3b73d3=_0x2e7989[0x0];let _0x3145bc;try{_0x3145bc=JSON[_0xc11cdf(0x10ab)](_0x3b73d3);}catch(_0x39251c){throw new Error(_0xc11cdf(0x918)+_0x39251c[_0xc11cdf(0xc7d)]+_0xc11cdf(0x15c)+_0xdcbdd4);}_0x51baaa[_0xc11cdf(0x1238)]=_0x3145bc,await _0x15043e[_0xc11cdf(0x799)][_0xc11cdf(0xfaa)](_0x51baaa),await _0x5d895e();}catch(_0x59b6ac){console[_0xc11cdf(0x7a3)](_0xc11cdf(0x620),_0x59b6ac),await _0x501c7b(_0xc11cdf(0x40b),_0xc11cdf(0xd0f)+_0x59b6ac[_0xc11cdf(0xc7d)]);}}async function _0x5d895e(){const _0x596bf7=_0x18b51e,_0x355e0e=document[_0x596bf7(0x8c2)](_0x596bf7(0x904));_0x355e0e[_0x596bf7(0xca0)]='';if(!_0x1f6e46)return;const _0x3a180d=_0x405767['chats'][_0x1f6e46],_0x400a7a=_0x3a180d[_0x596bf7(0x1238)]||[];if(_0x400a7a[_0x596bf7(0x105a)]===0x0){_0x355e0e[_0x596bf7(0xca0)]=_0x596bf7(0x1157);return;}const _0xd4639f=_0x596bf7(0x10c3);_0x400a7a[_0x596bf7(0x7c0)](_0x409c0b=>{const _0x4b0774=_0x596bf7,_0x1ea8c5=document[_0x4b0774(0x8c1)]('div');_0x1ea8c5[_0x4b0774(0x84c)]=_0x4b0774(0x8b9),_0x1ea8c5['dataset'][_0x4b0774(0x3ca)]=_0x409c0b[_0x4b0774(0x3ca)],_0x355e0e['appendChild'](_0x1ea8c5);if(_0x405767[_0x4b0774(0xb73)][_0x4b0774(0xd00)]){_0x1ea8c5[_0x4b0774(0x842)][_0x4b0774(0x617)]=_0x4b0774(0x73d);const _0x26a0eb=/[^\x00-\x7F]/['test'](_0x409c0b[_0x4b0774(0xdae)]),_0x472819=_0x409c0b['image_prompt']&&_0x409c0b[_0x4b0774(0xdae)][_0x4b0774(0x8c6)]()&&!_0x26a0eb,_0x145a47=_0x472819?_0x409c0b[_0x4b0774(0xdae)]:_0x4b0774(0x7e8),_0x436c7c='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x145a47),_0x1eeb72=new Image();_0x1eeb72[_0x4b0774(0xe7a)]=function(){const _0x684500=_0x4b0774;_0x1ea8c5[_0x684500(0x842)][_0x684500(0xfff)]='url('+this[_0x684500(0x939)]+')';},_0x1eeb72[_0x4b0774(0x10bb)]=function(){const _0x15f4d4=_0x4b0774;_0x1ea8c5[_0x15f4d4(0x842)][_0x15f4d4(0xfff)]=_0x15f4d4(0x116b)+_0xd4639f+')';},_0x1eeb72[_0x4b0774(0x939)]=_0x436c7c;}else{_0x1ea8c5[_0x4b0774(0x842)][_0x4b0774(0x617)]=_0x4b0774(0x959),_0x1ea8c5[_0x4b0774(0x842)][_0x4b0774(0xb5f)]=_0x4b0774(0x2c4);const _0x5b98e0=document[_0x4b0774(0x8c1)]('p');_0x5b98e0[_0x4b0774(0x84c)]=_0x4b0774(0xd1c),_0x5b98e0[_0x4b0774(0x1090)]=_0x409c0b['description']||_0x4b0774(0x9e6),_0x1ea8c5[_0x4b0774(0x31e)](_0x5b98e0);}});}async function _0x2cdbc3(){const _0x29952c=_0x18b51e;if(!_0x1f6e46)return;const _0xed7cb4=_0x405767[_0x29952c(0x799)][_0x1f6e46];if(!_0xed7cb4)return;await _0x501c7b(_0x29952c(0x1047),_0x29952c(0x878)+_0xed7cb4[_0x29952c(0x596)]+_0x29952c(0xddd));const {proxyUrl:_0x271c4f,apiKey:_0x438806,model:_0x5e966a}=_0x405767[_0x29952c(0x9e0)];if(!_0x271c4f||!_0x438806||!_0x5e966a){alert(_0x29952c(0x1170));return;}const _0x56308b=_0x405767[_0x29952c(0x20a)][_0x29952c(0xab3)]===_0x29952c(0x2dc)||!_0x405767[_0x29952c(0x20a)]['nickname']?'用户':_0x405767[_0x29952c(0x20a)][_0x29952c(0xab3)],_0x3687b0=_0xed7cb4['longTermMemory']&&_0xed7cb4['longTermMemory'][_0x29952c(0x105a)]>0x0?_0xed7cb4[_0x29952c(0xbca)]['map'](_0x41c1b9=>_0x29952c(0xc09)+_0x4f34be(_0x41c1b9['timestamp'])+')\x20'+_0x41c1b9[_0x29952c(0x168)])[_0x29952c(0xb2c)]('\x0a'):'无',_0x14b1b1=_0xed7cb4[_0x29952c(0x33a)]['maxMemory']||0xa,_0x26ab80=_0xed7cb4[_0x29952c(0xd39)]['slice'](-_0x14b1b1)[_0x29952c(0x6b9)](_0x207fec=>(_0x207fec['role']==='user'?_0x56308b:_0xed7cb4[_0x29952c(0x596)])+':\x20'+String(_0x207fec[_0x29952c(0x168)])[_0x29952c(0x599)](0x0,0x1e)+_0x29952c(0x388))[_0x29952c(0xb2c)]('\x0a'),_0x3fcb5d=(_0xed7cb4[_0x29952c(0x33a)][_0x29952c(0xb77)]||[])[_0x29952c(0x6b9)](_0xd9b994=>_0x405767['worldBooks']['find'](_0x18b4d5=>_0x18b4d5['id']===_0xd9b994))['filter'](Boolean)['map'](_0xa65fe7=>_0x29952c(0xec0)+_0xa65fe7[_0x29952c(0x596)]+_0x29952c(0x405)+_0xa65fe7['content']['filter'](_0x1dd3f0=>_0x1dd3f0[_0x29952c(0x69a)])[_0x29952c(0x6b9)](_0x3048da=>'-\x20'+_0x3048da['content'])[_0x29952c(0xb2c)]('\x0a'))[_0x29952c(0xb2c)](''),_0x24c44d=_0x5e1bc2(_0xed7cb4,0x3,_0x29952c(0x834)),_0x331612=_0x5e1bc2(_0xed7cb4,0x6,'hours'),_0x60370=_0x5e1bc2(_0xed7cb4,0x9,_0x29952c(0x834)),_0x480a72=_0x5e1bc2(_0xed7cb4,0x1,_0x29952c(0x1a0)),_0x5444a5=_0x5e1bc2(_0xed7cb4,0x3,_0x29952c(0x1a0)),_0xeaba34=_0x5e1bc2(_0xed7cb4,0x7,_0x29952c(0x1a0));let _0x99494f='';if(_0x24c44d||_0x331612||_0x60370||_0x480a72||_0x5444a5||_0xeaba34){_0x99494f+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x24c44d)_0x99494f+=_0x24c44d;if(_0x331612)_0x99494f+=_0x331612;if(_0x60370)_0x99494f+=_0x60370;if(_0x24c44d||_0x331612||_0x60370)_0x99494f+='\x0a';if(_0x480a72)_0x99494f+=_0x480a72;if(_0x5444a5)_0x99494f+=_0x5444a5;if(_0xeaba34)_0x99494f+=_0xeaba34;}const _0xea3cee='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0xed7cb4[_0x29952c(0x596)]+_0x29952c(0x128c)+_0xed7cb4[_0x29952c(0x33a)][_0x29952c(0x1060)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0x3687b0+'\x0a'+_0x3fcb5d+'\x0a'+_0x99494f+_0x29952c(0x327)+_0x56308b+_0x29952c(0x632)+_0x26ab80+_0x29952c(0x757);try{const _0x225cda=[{'role':_0x29952c(0x74b),'content':'请根据你的设定，生成你的浏览器记录。'}];let _0x319305=_0x271c4f[_0x29952c(0x773)](_0x29952c(0x3fe)),_0x1c3bea=_0x282b7e(_0x5e966a,_0x438806,_0xea3cee,_0x225cda);const _0x5e56a6=_0x319305?await fetch(_0x1c3bea[_0x29952c(0x9d6)],_0x1c3bea[_0x29952c(0x49a)]):await fetch(_0x271c4f+_0x29952c(0x5c1),{'method':_0x29952c(0xcd0),'headers':{'Content-Type':'application/json','Authorization':_0x29952c(0xf42)+_0x438806},'body':JSON[_0x29952c(0x1175)]({'model':_0x5e966a,'messages':[{'role':_0x29952c(0x46c),'content':_0xea3cee},..._0x225cda],'temperature':_0x405767['globalSettings'][_0x29952c(0x8c7)]||0.9})});if(!_0x5e56a6['ok'])throw new Error(_0x29952c(0xd83)+_0x5e56a6[_0x29952c(0xd05)]);const _0x13ae1d=await _0x5e56a6['json'](),_0x10328e=getGeminiResponseText(_0x13ae1d),_0x173052=_0x10328e['match'](/(\[[\s\S]*\])/);if(!_0x173052||!_0x173052[0x0])throw new Error(_0x29952c(0x119d)+_0x10328e);const _0x2e9f68=_0x173052[0x0];let _0x14c551;try{_0x14c551=JSON[_0x29952c(0x10ab)](_0x2e9f68);}catch(_0x37d555){throw new Error(_0x29952c(0x918)+_0x37d555[_0x29952c(0xc7d)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x10328e);}_0xed7cb4[_0x29952c(0x9d5)]=_0x14c551,await _0x15043e[_0x29952c(0x799)][_0x29952c(0xfaa)](_0xed7cb4),await _0x7dbc17();}catch(_0x3a2e34){console[_0x29952c(0x7a3)](_0x29952c(0xa4d),_0x3a2e34),await _0x501c7b('生成失败',_0x29952c(0x4e4)+_0x3a2e34['message']);}}function _0x7dbc17(){const _0x3fbd94=_0x18b51e,_0x5b29bc=document['getElementById'](_0x3fbd94(0x3b9));_0x5b29bc[_0x3fbd94(0xca0)]='';if(!_0x1f6e46)return;const _0x287015=_0x405767[_0x3fbd94(0x799)][_0x1f6e46],_0x49e6d4=_0x287015['simulatedBrowserHistory']||[];if(_0x49e6d4[_0x3fbd94(0x105a)]===0x0){_0x5b29bc[_0x3fbd94(0xca0)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>';return;}_0x49e6d4[_0x3fbd94(0x7c0)]((_0x5bd07c,_0x592879)=>{const _0x1c1246=_0x3fbd94,_0x5761a3=document[_0x1c1246(0x8c1)](_0x1c1246(0x1072));_0x5761a3['className']=_0x1c1246(0xffe),_0x5761a3[_0x1c1246(0xca0)]=_0x1c1246(0x1148)+_0x5bd07c[_0x1c1246(0xcea)]+_0x1c1246(0x2c7)+_0x5bd07c['url']+_0x1c1246(0xe47),_0x5761a3[_0x1c1246(0xae8)]('click',()=>_0x58b0fc(_0x592879)),_0x5b29bc[_0x1c1246(0x31e)](_0x5761a3);});}async function _0x58b0fc(_0x42367c){const _0x1799df=_0x18b51e,_0x4d6caa=_0x405767['chats'][_0x1f6e46],_0x693110=_0x4d6caa['simulatedBrowserHistory'][_0x42367c];if(!_0x693110)return;_0x5267dc=_0x693110,_0x4087bf(_0x693110),_0x5c2ffa('char-browser-article-screen');const _0x4b4bec=document['getElementById'](_0x1799df(0x1084)),_0x3b1dfe=await _0x15043e[_0x1799df(0xe93)][_0x1799df(0xdb8)]({'type':_0x1799df(0x6cc),'content.url':_0x693110[_0x1799df(0x9d6)]})[_0x1799df(0xf2e)]();_0x4b4bec[_0x1799df(0xb17)][_0x1799df(0xfc3)](_0x1799df(0x71b),!!_0x3b1dfe);}async function _0x55f2d2(){const _0x2b5f41=_0x18b51e;if(!_0x5267dc||!_0x1f6e46)return;const _0x557f0c=_0x5267dc,_0x3ff3a9=_0x405767[_0x2b5f41(0x799)][_0x1f6e46],_0x502af9=document[_0x2b5f41(0x8c2)](_0x2b5f41(0x1084)),_0x24cd85=await _0x15043e[_0x2b5f41(0xe93)]['where']({'type':_0x2b5f41(0x6cc),'content.url':_0x557f0c[_0x2b5f41(0x9d6)]})[_0x2b5f41(0xf2e)]();if(_0x24cd85)await _0x15043e[_0x2b5f41(0xe93)][_0x2b5f41(0x89f)](_0x24cd85['id']),_0x502af9[_0x2b5f41(0xb17)][_0x2b5f41(0xaff)]('active'),await _0x501c7b('操作成功',_0x2b5f41(0x4ed));else{const _0x43a302={'type':_0x2b5f41(0x6cc),'content':{..._0x557f0c,'characterId':_0x1f6e46,'characterName':_0x3ff3a9[_0x2b5f41(0x596)]},'timestamp':Date[_0x2b5f41(0x1ed)]()};await _0x15043e[_0x2b5f41(0xe93)]['add'](_0x43a302),_0x502af9[_0x2b5f41(0xb17)][_0x2b5f41(0x3f4)](_0x2b5f41(0x71b)),await _0x501c7b(_0x2b5f41(0x10b7),_0x2b5f41(0x2a0));}}function _0x4087bf(_0x268ca2){const _0x30867b=_0x18b51e,_0x46e673=document['getElementById'](_0x30867b(0xd7e)),_0x3bc162=document['getElementById'](_0x30867b(0x68d));_0x46e673['textContent']=_0x268ca2[_0x30867b(0xcea)],_0x3bc162['innerHTML']='',_0x268ca2[_0x30867b(0xde0)]===_0x30867b(0xdab)?_0x3bc162[_0x30867b(0xca0)]=_0x30867b(0x81d)+(_0x268ca2['title']||_0x30867b(0x217))+'</p>':_0x3bc162['innerHTML']='<p>'+(_0x268ca2['content']||'内容加载失败...')[_0x30867b(0x1b7)](/\n/g,_0x30867b(0x739))+_0x30867b(0x2e7);}async function _0x424678(){const _0x5987f4=_0x18b51e;if(!_0x1f6e46)return;const _0x3ccae2=_0x405767[_0x5987f4(0x799)][_0x1f6e46];if(!_0x3ccae2)return;await _0x501c7b(_0x5987f4(0x1047),'正在模拟“'+_0x3ccae2['name']+'”的购物习惯...');const {proxyUrl:_0x452a19,apiKey:_0x520053,model:_0x31cdbc}=_0x405767[_0x5987f4(0x9e0)];if(!_0x452a19||!_0x520053||!_0x31cdbc){alert(_0x5987f4(0x1170));return;}const _0xff8a31=_0x405767[_0x5987f4(0x20a)][_0x5987f4(0xab3)]===_0x5987f4(0x2dc)||!_0x405767['qzoneSettings']['nickname']?'用户':_0x405767[_0x5987f4(0x20a)][_0x5987f4(0xab3)],_0x38ed4e=_0x3ccae2[_0x5987f4(0xbca)]&&_0x3ccae2[_0x5987f4(0xbca)][_0x5987f4(0x105a)]>0x0?_0x3ccae2['longTermMemory']['map'](_0x7f9b0a=>'-\x20(记录于\x20'+_0x4f34be(_0x7f9b0a['timestamp'])+')\x20'+_0x7f9b0a[_0x5987f4(0x168)])[_0x5987f4(0xb2c)]('\x0a'):'无',_0x514496=_0x3ccae2[_0x5987f4(0x33a)][_0x5987f4(0x808)]||0xa,_0x106ee8=_0x3ccae2[_0x5987f4(0xd39)][_0x5987f4(0x961)](-_0x514496)['map'](_0x433662=>(_0x433662[_0x5987f4(0x14a)]===_0x5987f4(0x74b)?_0xff8a31:_0x3ccae2[_0x5987f4(0x596)])+':\x20'+String(_0x433662[_0x5987f4(0x168)])[_0x5987f4(0x599)](0x0,0x1e)+_0x5987f4(0x388))[_0x5987f4(0xb2c)]('\x0a'),_0x5a1313=(_0x3ccae2[_0x5987f4(0x33a)][_0x5987f4(0xb77)]||[])[_0x5987f4(0x6b9)](_0x2a2798=>_0x405767[_0x5987f4(0x40e)]['find'](_0x1fea6f=>_0x1fea6f['id']===_0x2a2798))[_0x5987f4(0x1d8)](Boolean)[_0x5987f4(0x6b9)](_0xae4339=>_0x5987f4(0xec0)+_0xae4339['name']+_0x5987f4(0x405)+_0xae4339[_0x5987f4(0x168)]['filter'](_0xcc1298=>_0xcc1298[_0x5987f4(0x69a)])['map'](_0x2a9f4c=>'-\x20'+_0x2a9f4c[_0x5987f4(0x168)])[_0x5987f4(0xb2c)]('\x0a'))[_0x5987f4(0xb2c)](''),_0x5b6c94=_0x5e1bc2(_0x3ccae2,0x3,_0x5987f4(0x834)),_0x3a1113=_0x5e1bc2(_0x3ccae2,0x6,'hours'),_0x5e9665=_0x5e1bc2(_0x3ccae2,0x9,_0x5987f4(0x834)),_0x2aa2e0=_0x5e1bc2(_0x3ccae2,0x1,_0x5987f4(0x1a0)),_0x4d34be=_0x5e1bc2(_0x3ccae2,0x3,_0x5987f4(0x1a0)),_0x3d109c=_0x5e1bc2(_0x3ccae2,0x7,_0x5987f4(0x1a0));let _0x2dc520='';if(_0x5b6c94||_0x3a1113||_0x5e9665||_0x2aa2e0||_0x4d34be||_0x3d109c){_0x2dc520+=_0x5987f4(0x2c2);if(_0x5b6c94)_0x2dc520+=_0x5b6c94;if(_0x3a1113)_0x2dc520+=_0x3a1113;if(_0x5e9665)_0x2dc520+=_0x5e9665;if(_0x5b6c94||_0x3a1113||_0x5e9665)_0x2dc520+='\x0a';if(_0x2aa2e0)_0x2dc520+=_0x2aa2e0;if(_0x4d34be)_0x2dc520+=_0x4d34be;if(_0x3d109c)_0x2dc520+=_0x3d109c;}const _0x56880a=_0x5987f4(0xc33)+_0x3ccae2[_0x5987f4(0x596)]+'”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x3ccae2[_0x5987f4(0x33a)][_0x5987f4(0x1060)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0x38ed4e+'\x0a'+_0x5a1313+'\x0a'+_0x2dc520+_0x5987f4(0x327)+_0xff8a31+_0x5987f4(0x632)+_0x106ee8+_0x5987f4(0x943);try{const _0xd5bb5=[{'role':_0x5987f4(0x74b),'content':_0x5987f4(0x3d8)}];let _0xf1107c=_0x452a19[_0x5987f4(0x773)]('generativelanguage'),_0x53200c=_0x282b7e(_0x31cdbc,_0x520053,_0x56880a,_0xd5bb5);const _0x43d560=_0xf1107c?await fetch(_0x53200c[_0x5987f4(0x9d6)],_0x53200c[_0x5987f4(0x49a)]):await fetch(_0x452a19+'/v1/chat/completions',{'method':_0x5987f4(0xcd0),'headers':{'Content-Type':_0x5987f4(0xcb6),'Authorization':'Bearer\x20'+_0x520053},'body':JSON[_0x5987f4(0x1175)]({'model':_0x31cdbc,'messages':[{'role':_0x5987f4(0x46c),'content':_0x56880a},..._0xd5bb5],'temperature':_0x405767[_0x5987f4(0xb73)][_0x5987f4(0x8c7)]||0.9})});if(!_0x43d560['ok'])throw new Error(_0x5987f4(0xd83)+_0x43d560[_0x5987f4(0xd05)]);const _0xc2d914=await _0x43d560[_0x5987f4(0x7e9)](),_0x37a1f6=getGeminiResponseText(_0xc2d914),_0x50495d=_0x37a1f6[_0x5987f4(0xdf8)](/({[\s\S]*})/);if(!_0x50495d)throw new Error(_0x5987f4(0x52f));const _0x13e227=JSON['parse'](_0x50495d[0x0]);!_0x13e227[_0x5987f4(0xcf9)]&&(_0x13e227[_0x5987f4(0xcf9)]=[]),_0x3ccae2['simulatedTaobaoHistory']=_0x13e227,await _0x15043e['chats']['put'](_0x3ccae2),await _0x16090f();}catch(_0x15a69c){console[_0x5987f4(0x7a3)](_0x5987f4(0x177),_0x15a69c),await _0x501c7b(_0x5987f4(0x40b),_0x5987f4(0xce0)+_0x15a69c[_0x5987f4(0xc7d)]);}}function _0x275dcf(){const _0x1052b4=_0x18b51e;_0x4f4862(),_0x5c2ffa(_0x1052b4(0x108c));}function _0x4f4862(){const _0x1c16ce=_0x18b51e,_0x360eb8=document['getElementById'](_0x1c16ce(0x218));_0x360eb8[_0x1c16ce(0xca0)]='';const _0x446e1e=_0x405767[_0x1c16ce(0x799)][_0x1f6e46],_0xa34599=_0x446e1e[_0x1c16ce(0xec9)]||{},_0x1b3f6f=_0xa34599[_0x1c16ce(0xcf9)]||[],_0x10fd6e=_0xa34599['totalBalance']||0x0,_0x386d26=document[_0x1c16ce(0x8c1)](_0x1c16ce(0x1072));_0x386d26[_0x1c16ce(0x842)][_0x1c16ce(0x1d0)]=_0x1c16ce(0x440),_0x386d26[_0x1c16ce(0xca0)]=_0x1c16ce(0x1013)+_0x10fd6e[_0x1c16ce(0x3c1)](0x2)+_0x1c16ce(0x1220),_0x360eb8[_0x1c16ce(0x31e)](_0x386d26);const _0x9bd151=document[_0x1c16ce(0x8c1)]('h3');_0x9bd151['textContent']='最近支出',_0x9bd151[_0x1c16ce(0x842)][_0x1c16ce(0x1d0)]='font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;',_0x360eb8[_0x1c16ce(0x31e)](_0x9bd151);if(_0x1b3f6f[_0x1c16ce(0x105a)]===0x0){_0x360eb8[_0x1c16ce(0xca0)]+=_0x1c16ce(0x1040);return;}_0x1b3f6f[_0x1c16ce(0x7c0)](_0x4a0abe=>{const _0xf5aed6=_0x1c16ce,_0x4a87d4=document['createElement'](_0xf5aed6(0x1072));_0x4a87d4['style'][_0xf5aed6(0x1d0)]=_0xf5aed6(0xcb7),_0x4a87d4[_0xf5aed6(0xca0)]=_0xf5aed6(0x1082)+_0x4a0abe[_0xf5aed6(0x7ee)]+_0xf5aed6(0xd0e)+_0x4a0abe[_0xf5aed6(0x8c8)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥'+(_0x4a0abe[_0xf5aed6(0x2ea)]||0x0)['toFixed'](0x2)+_0xf5aed6(0xe47),_0x360eb8['appendChild'](_0x4a87d4);});}async function _0x1f5fcb(){const _0x2752a3=_0x18b51e;if(!_0x1f6e46)return;const _0x15245=_0x405767[_0x2752a3(0x799)][_0x1f6e46];if(!_0x15245)return;await _0x501c7b(_0x2752a3(0x1047),'正在请求“'+_0x15245[_0x2752a3(0x596)]+_0x2752a3(0x3d4));const {proxyUrl:_0x79419a,apiKey:_0x391a4a,model:_0x23a1b8}=_0x405767[_0x2752a3(0x9e0)];if(!_0x79419a||!_0x391a4a||!_0x23a1b8){alert(_0x2752a3(0x6c2));return;}const _0x33032c=_0x405767[_0x2752a3(0x20a)][_0x2752a3(0xab3)]==='{{user}}'||!_0x405767[_0x2752a3(0x20a)][_0x2752a3(0xab3)]?'用户':_0x405767[_0x2752a3(0x20a)]['nickname'],_0x18f751=_0x15245[_0x2752a3(0xbca)]&&_0x15245[_0x2752a3(0xbca)][_0x2752a3(0x105a)]>0x0?_0x15245[_0x2752a3(0xbca)]['map'](_0x4b12bc=>_0x2752a3(0xc09)+_0x4f34be(_0x4b12bc[_0x2752a3(0x351)])+')\x20'+_0x4b12bc[_0x2752a3(0x168)])['join']('\x0a'):'无',_0x581f6f=_0x15245[_0x2752a3(0x33a)][_0x2752a3(0x808)]||0xa,_0x1aef40=_0x15245[_0x2752a3(0xd39)][_0x2752a3(0x961)](-_0x581f6f)[_0x2752a3(0x6b9)](_0x1165f0=>(_0x1165f0['role']===_0x2752a3(0x74b)?_0x33032c:_0x15245[_0x2752a3(0x596)])+':\x20'+String(_0x1165f0['content'])[_0x2752a3(0x599)](0x0,0x1e)+_0x2752a3(0x388))['join']('\x0a'),_0x1570fa=(_0x15245[_0x2752a3(0x33a)][_0x2752a3(0xb77)]||[])[_0x2752a3(0x6b9)](_0x1d253e=>_0x405767[_0x2752a3(0x40e)][_0x2752a3(0x2ef)](_0x3efe8e=>_0x3efe8e['id']===_0x1d253e))[_0x2752a3(0x1d8)](Boolean)[_0x2752a3(0x6b9)](_0x113470=>_0x2752a3(0xec0)+_0x113470[_0x2752a3(0x596)]+_0x2752a3(0x405)+_0x113470[_0x2752a3(0x168)][_0x2752a3(0x1d8)](_0x4e354d=>_0x4e354d[_0x2752a3(0x69a)])[_0x2752a3(0x6b9)](_0x340cea=>'-\x20'+_0x340cea[_0x2752a3(0x168)])['join']('\x0a'))[_0x2752a3(0xb2c)](''),_0x43fa89=_0x5e1bc2(_0x15245,0x3,_0x2752a3(0x834)),_0x2b76c0=_0x5e1bc2(_0x15245,0x6,_0x2752a3(0x834)),_0x45dd55=_0x5e1bc2(_0x15245,0x9,_0x2752a3(0x834)),_0x579909=_0x5e1bc2(_0x15245,0x1,_0x2752a3(0x1a0)),_0x3dc1d5=_0x5e1bc2(_0x15245,0x3,_0x2752a3(0x1a0)),_0x415342=_0x5e1bc2(_0x15245,0x7,'days');let _0x582d2c='';if(_0x43fa89||_0x2b76c0||_0x45dd55||_0x579909||_0x3dc1d5||_0x415342){_0x582d2c+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x43fa89)_0x582d2c+=_0x43fa89;if(_0x2b76c0)_0x582d2c+=_0x2b76c0;if(_0x45dd55)_0x582d2c+=_0x45dd55;if(_0x43fa89||_0x2b76c0||_0x45dd55)_0x582d2c+='\x0a';if(_0x579909)_0x582d2c+=_0x579909;if(_0x3dc1d5)_0x582d2c+=_0x3dc1d5;if(_0x415342)_0x582d2c+=_0x415342;}const _0x17a24d='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x15245[_0x2752a3(0x596)]+_0x2752a3(0x191)+_0x15245['settings']['aiPersona']+'\x0a-\x20**你的长期记忆**:\x0a'+_0x18f751+'\x0a'+_0x1570fa+'\x0a'+_0x582d2c+_0x2752a3(0x11c5)+_0x33032c+_0x2752a3(0x632)+_0x1aef40+_0x2752a3(0xccf);try{const _0x1b744d=[{'role':_0x2752a3(0x74b),'content':_0x2752a3(0x121d)}];let _0x20be76=_0x79419a['includes'](_0x2752a3(0x3fe)),_0x5c230a=_0x282b7e(_0x23a1b8,_0x391a4a,_0x17a24d,_0x1b744d);const _0x5a08c1=_0x20be76?await fetch(_0x5c230a[_0x2752a3(0x9d6)],_0x5c230a[_0x2752a3(0x49a)]):await fetch(_0x79419a+_0x2752a3(0x5c1),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x2752a3(0xf42)+_0x391a4a},'body':JSON['stringify']({'model':_0x23a1b8,'messages':[{'role':_0x2752a3(0x46c),'content':_0x17a24d},..._0x1b744d],'temperature':_0x405767[_0x2752a3(0xb73)][_0x2752a3(0x8c7)]||0.9})});if(!_0x5a08c1['ok']){const _0x1214a7=await _0x5a08c1[_0x2752a3(0x7e9)]()['catch'](()=>null),_0x417721=_0x1214a7?.[_0x2752a3(0x7a3)]?.[_0x2752a3(0xc7d)]||_0x5a08c1['statusText'];throw new Error(_0x2752a3(0xd83)+_0x5a08c1[_0x2752a3(0x8c8)]+'\x20-\x20'+_0x417721);}const _0x1e5f63=await _0x5a08c1['json'](),_0x422f23=getGeminiResponseText(_0x1e5f63),_0x5b5898=_0x422f23[_0x2752a3(0xdf8)](/(\[[\s\S]*\])/);if(!_0x5b5898||!_0x5b5898[0x0])throw new Error(_0x2752a3(0x119d)+_0x422f23);const _0xbf5876=_0x5b5898[0x0];let _0x5d95d4;try{_0x5d95d4=JSON[_0x2752a3(0x10ab)](_0xbf5876);}catch(_0x3c689c){throw new Error(_0x2752a3(0x918)+_0x3c689c[_0x2752a3(0xc7d)]+_0x2752a3(0x15c)+_0x422f23);}if(!Array[_0x2752a3(0xb85)](_0x5d95d4))throw new Error(_0x2752a3(0x40c)+JSON[_0x2752a3(0x1175)](_0x5d95d4));_0x15245['memos']=_0x5d95d4[_0x2752a3(0x6b9)](_0x5e7b25=>({'id':Date[_0x2752a3(0x1ed)]()+Math[_0x2752a3(0x5b3)](),'title':_0x5e7b25[_0x2752a3(0xcea)],'content':_0x5e7b25[_0x2752a3(0x168)]})),await _0x15043e[_0x2752a3(0x799)][_0x2752a3(0xfaa)](_0x15245),await _0x35e23d();}catch(_0x74b47b){console[_0x2752a3(0x7a3)]('生成模拟备忘录失败:',_0x74b47b),await _0x501c7b('生成失败',_0x2752a3(0x1210)+_0x74b47b['message']);}}async function _0x550389(){const _0x3059c6=_0x18b51e;if(!_0x1f6e46)return;const _0x58e849=_0x405767[_0x3059c6(0x799)][_0x1f6e46];if(!_0x58e849)return;await _0x501c7b('请稍候...',_0x3059c6(0x837)+_0x58e849[_0x3059c6(0x596)]+_0x3059c6(0xe11));const {proxyUrl:_0x1f1793,apiKey:_0x17b955,model:_0x380515}=_0x405767[_0x3059c6(0x9e0)];if(!_0x1f1793||!_0x17b955||!_0x380515){alert(_0x3059c6(0x1170));return;}const _0x185398=_0x405767[_0x3059c6(0x20a)][_0x3059c6(0xab3)]==='{{user}}'||!_0x405767[_0x3059c6(0x20a)][_0x3059c6(0xab3)]?'用户':_0x405767[_0x3059c6(0x20a)][_0x3059c6(0xab3)],_0x3072b4=_0x58e849[_0x3059c6(0xbca)]&&_0x58e849[_0x3059c6(0xbca)][_0x3059c6(0x105a)]>0x0?_0x58e849[_0x3059c6(0xbca)][_0x3059c6(0x6b9)](_0x206692=>'-\x20(记录于\x20'+_0x4f34be(_0x206692[_0x3059c6(0x351)])+')\x20'+_0x206692[_0x3059c6(0x168)])[_0x3059c6(0xb2c)]('\x0a'):'无',_0x2b1b2c=_0x58e849['settings'][_0x3059c6(0x808)]||0xa,_0x8c1961=_0x58e849[_0x3059c6(0xd39)][_0x3059c6(0x961)](-_0x2b1b2c)[_0x3059c6(0x6b9)](_0xefed=>(_0xefed[_0x3059c6(0x14a)]===_0x3059c6(0x74b)?_0x185398:_0x58e849[_0x3059c6(0x596)])+':\x20'+String(_0xefed[_0x3059c6(0x168)])[_0x3059c6(0x599)](0x0,0x1e)+'...')['join']('\x0a'),_0x17aab3=(_0x58e849['settings']['linkedWorldBookIds']||[])['map'](_0x2bed8a=>_0x405767[_0x3059c6(0x40e)][_0x3059c6(0x2ef)](_0x2a8e92=>_0x2a8e92['id']===_0x2bed8a))[_0x3059c6(0x1d8)](Boolean)[_0x3059c6(0x6b9)](_0x114587=>_0x3059c6(0xec0)+_0x114587[_0x3059c6(0x596)]+'》设定:\x0a'+_0x114587['content'][_0x3059c6(0x1d8)](_0x16998a=>_0x16998a[_0x3059c6(0x69a)])['map'](_0x199430=>'-\x20'+_0x199430[_0x3059c6(0x168)])[_0x3059c6(0xb2c)]('\x0a'))[_0x3059c6(0xb2c)](''),_0x1848e8=_0x5e1bc2(_0x58e849,0x3,_0x3059c6(0x834)),_0x158f6b=_0x5e1bc2(_0x58e849,0x6,_0x3059c6(0x834)),_0x37dcbe=_0x5e1bc2(_0x58e849,0x9,_0x3059c6(0x834)),_0x2ec258=_0x5e1bc2(_0x58e849,0x1,'days'),_0x6a68=_0x5e1bc2(_0x58e849,0x3,'days'),_0xe9f813=_0x5e1bc2(_0x58e849,0x7,_0x3059c6(0x1a0));let _0x134f78='';if(_0x1848e8||_0x158f6b||_0x37dcbe||_0x2ec258||_0x6a68||_0xe9f813){_0x134f78+=_0x3059c6(0x2c2);if(_0x1848e8)_0x134f78+=_0x1848e8;if(_0x158f6b)_0x134f78+=_0x158f6b;if(_0x37dcbe)_0x134f78+=_0x37dcbe;if(_0x1848e8||_0x158f6b||_0x37dcbe)_0x134f78+='\x0a';if(_0x2ec258)_0x134f78+=_0x2ec258;if(_0x6a68)_0x134f78+=_0x6a68;if(_0xe9f813)_0x134f78+=_0xe9f813;}const _0x527584='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x58e849['name']+_0x3059c6(0xb70)+new Date()['toISOString']()+_0x3059c6(0x963)+_0x58e849[_0x3059c6(0x33a)][_0x3059c6(0x1060)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0x3072b4+'\x0a'+_0x17aab3+'\x0a'+_0x134f78+_0x3059c6(0x11c5)+_0x185398+_0x3059c6(0x632)+_0x8c1961+_0x3059c6(0x9ac);try{const _0x53a93a=[{'role':_0x3059c6(0x74b),'content':_0x3059c6(0x7b0)}];let _0x375406=_0x1f1793[_0x3059c6(0x773)]('generativelanguage'),_0x431e57=_0x282b7e(_0x380515,_0x17b955,_0x527584,_0x53a93a);const _0x199c74=_0x375406?await fetch(_0x431e57[_0x3059c6(0x9d6)],_0x431e57[_0x3059c6(0x49a)]):await fetch(_0x1f1793+_0x3059c6(0x5c1),{'method':_0x3059c6(0xcd0),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x17b955},'body':JSON[_0x3059c6(0x1175)]({'model':_0x380515,'messages':[{'role':'system','content':_0x527584},..._0x53a93a],'temperature':_0x405767['globalSettings'][_0x3059c6(0x8c7)]||0.9})});if(!_0x199c74['ok'])throw new Error(_0x3059c6(0xd83)+_0x199c74[_0x3059c6(0xd05)]);const _0x1c858b=await _0x199c74[_0x3059c6(0x7e9)](),_0x4bb928=getGeminiResponseText(_0x1c858b),_0x3bec24=_0x4bb928['match'](/(\[[\s\S]*\])/);if(!_0x3bec24||!_0x3bec24[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x4bb928);const _0x2d0b10=_0x3bec24[0x0];let _0x51da81;try{_0x51da81=JSON[_0x3059c6(0x10ab)](_0x2d0b10);}catch(_0x11f1b0){throw new Error(_0x3059c6(0x918)+_0x11f1b0[_0x3059c6(0xc7d)]+_0x3059c6(0x15c)+_0x4bb928);}_0x58e849[_0x3059c6(0xa2f)]=_0x51da81,await _0x15043e[_0x3059c6(0x799)][_0x3059c6(0xfaa)](_0x58e849),await _0x49b697();}catch(_0x1161e3){console[_0x3059c6(0x7a3)](_0x3059c6(0x45b),_0x1161e3),await _0x501c7b('生成失败','无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20'+_0x1161e3[_0x3059c6(0xc7d)]);}}function _0x49b697(){const _0x19fc22=_0x18b51e,_0x2de32f=document[_0x19fc22(0x8c2)](_0x19fc22(0xfe7));_0x2de32f[_0x19fc22(0xca0)]='';if(!_0x1f6e46)return;const _0x4d2000=_0x405767[_0x19fc22(0x799)][_0x1f6e46],_0x460f84=_0x4d2000[_0x19fc22(0xa2f)]||[];if(_0x460f84[_0x19fc22(0x105a)]===0x0){_0x2de32f['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>';return;}_0x460f84['forEach'](_0x59db9a=>{const _0x1d0528=_0x19fc22,_0xd9706=document['createElement'](_0x1d0528(0x1072));_0xd9706['className']=_0x1d0528(0x202);let _0x3aefdf='';if(_0x59db9a[_0x1d0528(0xdae)]){const _0x2e7a53=_0x1d0528(0x2c6)+encodeURIComponent(_0x59db9a['image_prompt']);_0x3aefdf=_0x1d0528(0x1a5)+_0x2e7a53+_0x1d0528(0x4c4)+_0x59db9a[_0x1d0528(0x120a)]+_0x1d0528(0x11ee);}const _0x31f440=_0x59db9a[_0x1d0528(0x351)]?_0x4f34be(new Date(_0x59db9a[_0x1d0528(0x351)])[_0x1d0528(0x610)]()):_0x1d0528(0xcaa);_0xd9706[_0x1d0528(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>'+_0x59db9a[_0x1d0528(0x1cb)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>'+_0x59db9a[_0x1d0528(0x27d)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>'+_0x59db9a['comment'][_0x1d0528(0x1b7)](/\n/g,_0x1d0528(0x854))+_0x1d0528(0xd5e)+_0x3aefdf+_0x1d0528(0xc20)+_0x31f440+_0x1d0528(0x953),_0x2de32f[_0x1d0528(0x31e)](_0xd9706);});}async function _0x598644(){const _0x48e9d2=_0x18b51e;if(!_0x1f6e46)return;const _0x45ec27=_0x405767[_0x48e9d2(0x799)][_0x1f6e46];if(!_0x45ec27)return;await _0x501c7b(_0x48e9d2(0x1047),_0x48e9d2(0xe6a)+_0x45ec27[_0x48e9d2(0x596)]+_0x48e9d2(0x124d));const {proxyUrl:_0x12fe18,apiKey:_0x455385,model:_0x22c6e2}=_0x405767['apiConfig'];if(!_0x12fe18||!_0x455385||!_0x22c6e2){alert(_0x48e9d2(0x1170));return;}const _0x2ea2cf=_0x405767['qzoneSettings']['nickname']===_0x48e9d2(0x2dc)||!_0x405767[_0x48e9d2(0x20a)][_0x48e9d2(0xab3)]?'用户':_0x405767[_0x48e9d2(0x20a)][_0x48e9d2(0xab3)],_0x4bea3c=_0x45ec27[_0x48e9d2(0xbca)]&&_0x45ec27[_0x48e9d2(0xbca)][_0x48e9d2(0x105a)]>0x0?_0x45ec27[_0x48e9d2(0xbca)][_0x48e9d2(0x6b9)](_0x25ceea=>_0x48e9d2(0xc09)+_0x4f34be(_0x25ceea[_0x48e9d2(0x351)])+')\x20'+_0x25ceea[_0x48e9d2(0x168)])[_0x48e9d2(0xb2c)]('\x0a'):'无',_0x202050=_0x45ec27[_0x48e9d2(0x33a)]['maxMemory']||0xa,_0x1d89e3=_0x45ec27[_0x48e9d2(0xd39)][_0x48e9d2(0x961)](-_0x202050)[_0x48e9d2(0x6b9)](_0x4482db=>(_0x4482db[_0x48e9d2(0x14a)]===_0x48e9d2(0x74b)?_0x2ea2cf:_0x45ec27['name'])+':\x20'+String(_0x4482db[_0x48e9d2(0x168)])['substring'](0x0,0x1e)+_0x48e9d2(0x388))[_0x48e9d2(0xb2c)]('\x0a'),_0x4fb018=(_0x45ec27[_0x48e9d2(0x33a)][_0x48e9d2(0xb77)]||[])[_0x48e9d2(0x6b9)](_0x52f8f8=>_0x405767[_0x48e9d2(0x40e)][_0x48e9d2(0x2ef)](_0x2d3e76=>_0x2d3e76['id']===_0x52f8f8))[_0x48e9d2(0x1d8)](Boolean)[_0x48e9d2(0x6b9)](_0x62eb6=>'\x0a##\x20世界书《'+_0x62eb6[_0x48e9d2(0x596)]+'》设定:\x0a'+_0x62eb6[_0x48e9d2(0x168)][_0x48e9d2(0x1d8)](_0x39b987=>_0x39b987[_0x48e9d2(0x69a)])[_0x48e9d2(0x6b9)](_0x53b997=>'-\x20'+_0x53b997[_0x48e9d2(0x168)])['join']('\x0a'))[_0x48e9d2(0xb2c)](''),_0x15e8c0=_0x5e1bc2(_0x45ec27,0x3,'hours'),_0x1ae5d7=_0x5e1bc2(_0x45ec27,0x6,'hours'),_0xfa3b4c=_0x5e1bc2(_0x45ec27,0x9,_0x48e9d2(0x834)),_0x166366=_0x5e1bc2(_0x45ec27,0x1,_0x48e9d2(0x1a0)),_0x37a5b9=_0x5e1bc2(_0x45ec27,0x3,_0x48e9d2(0x1a0)),_0x2d2392=_0x5e1bc2(_0x45ec27,0x7,_0x48e9d2(0x1a0));let _0x1bad85='';if(_0x15e8c0||_0x1ae5d7||_0xfa3b4c||_0x166366||_0x37a5b9||_0x2d2392){_0x1bad85+=_0x48e9d2(0x2c2);if(_0x15e8c0)_0x1bad85+=_0x15e8c0;if(_0x1ae5d7)_0x1bad85+=_0x1ae5d7;if(_0xfa3b4c)_0x1bad85+=_0xfa3b4c;if(_0x15e8c0||_0x1ae5d7||_0xfa3b4c)_0x1bad85+='\x0a';if(_0x166366)_0x1bad85+=_0x166366;if(_0x37a5b9)_0x1bad85+=_0x37a5b9;if(_0x2d2392)_0x1bad85+=_0x2d2392;}const _0x96f07b=_0x48e9d2(0xc33)+_0x45ec27['name']+_0x48e9d2(0x5ad)+_0x45ec27[_0x48e9d2(0x33a)][_0x48e9d2(0x1060)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0x4bea3c+'\x0a'+_0x4fb018+'\x0a'+_0x1bad85+_0x48e9d2(0x11c5)+_0x2ea2cf+_0x48e9d2(0x632)+_0x1d89e3+_0x48e9d2(0xb32);try{const _0x3470c3=[{'role':_0x48e9d2(0x74b),'content':'请根据你的设定，生成你的App使用记录。'}];let _0x1feece=_0x12fe18[_0x48e9d2(0x773)](_0x48e9d2(0x3fe)),_0x4e087b=_0x282b7e(_0x22c6e2,_0x455385,_0x96f07b,_0x3470c3);const _0x577e1e=_0x1feece?await fetch(_0x4e087b[_0x48e9d2(0x9d6)],_0x4e087b[_0x48e9d2(0x49a)]):await fetch(_0x12fe18+_0x48e9d2(0x5c1),{'method':_0x48e9d2(0xcd0),'headers':{'Content-Type':_0x48e9d2(0xcb6),'Authorization':'Bearer\x20'+_0x455385},'body':JSON[_0x48e9d2(0x1175)]({'model':_0x22c6e2,'messages':[{'role':_0x48e9d2(0x46c),'content':_0x96f07b},..._0x3470c3],'temperature':_0x405767['globalSettings'][_0x48e9d2(0x8c7)]||0.9})});if(!_0x577e1e['ok'])throw new Error(_0x48e9d2(0xd83)+_0x577e1e[_0x48e9d2(0xd05)]);const _0x4cbdf1=await _0x577e1e['json'](),_0x5800d3=getGeminiResponseText(_0x4cbdf1),_0x5d631e=_0x5800d3['replace'](/^```json\s*/,'')[_0x48e9d2(0x1b7)](/```$/,''),_0x50da6c=JSON[_0x48e9d2(0x10ab)](_0x5d631e);_0x45ec27[_0x48e9d2(0xc17)]=_0x50da6c,await _0x15043e[_0x48e9d2(0x799)]['put'](_0x45ec27),await _0x5434d9();}catch(_0xbd33c4){console[_0x48e9d2(0x7a3)](_0x48e9d2(0x1044),_0xbd33c4),await _0x501c7b(_0x48e9d2(0x40b),_0x48e9d2(0xdbe)+_0xbd33c4['message']);}}function _0x5434d9(){const _0x1d7cee=_0x18b51e,_0x55a8d8=document[_0x1d7cee(0x8c2)]('char-usage-list');_0x55a8d8['innerHTML']='';if(!_0x1f6e46)return;const _0x5de08d=_0x405767['chats'][_0x1f6e46],_0x1059c1=(_0x5de08d[_0x1d7cee(0xc17)]||[])['sort']((_0x1271b6,_0x121eb5)=>_0x121eb5[_0x1d7cee(0xff2)]-_0x1271b6['usageTimeMinutes']);if(_0x1059c1[_0x1d7cee(0x105a)]===0x0){_0x55a8d8[_0x1d7cee(0xca0)]=_0x1d7cee(0x1153);return;}_0x1059c1[_0x1d7cee(0x7c0)](_0x3ad6ac=>{const _0x5e8f1a=_0x1d7cee,_0x5d53f3=document[_0x5e8f1a(0x8c1)]('div');_0x5d53f3[_0x5e8f1a(0x84c)]=_0x5e8f1a(0x746);const _0x3a7db2=Math['floor'](_0x3ad6ac['usageTimeMinutes']/0x3c),_0x2b7947=_0x3ad6ac[_0x5e8f1a(0xff2)]%0x3c;let _0x450069='';if(_0x3a7db2>0x0)_0x450069+=_0x3a7db2+'小时';if(_0x2b7947>0x0)_0x450069+=_0x2b7947+'分钟';if(!_0x450069)_0x450069=_0x5e8f1a(0x1073);const _0x568c9d=_0x3ad6ac[_0x5e8f1a(0xdae)]||_0x5e8f1a(0xb4a)+_0x3ad6ac[_0x5e8f1a(0x2d6)]+',\x20flat\x20design,\x20simple',_0x55f6a3=_0x5e8f1a(0x2c6)+encodeURIComponent(_0x568c9d);_0x5d53f3['innerHTML']=_0x5e8f1a(0x3c6)+_0x55f6a3+_0x5e8f1a(0x67e)+_0x3ad6ac['appName']+_0x5e8f1a(0xb5b)+_0x3ad6ac['category']+_0x5e8f1a(0x1cf)+_0x450069+_0x5e8f1a(0x953),_0x55a8d8[_0x5e8f1a(0x31e)](_0x5d53f3);});}async function _0x486f02(){const _0x332148=_0x18b51e;if(!_0x1f6e46)return;const _0x2c1b1b=_0x405767['chats'][_0x1f6e46];if(!_0x2c1b1b)return;await _0x501c7b('请稍候...',_0x332148(0xf15)+_0x2c1b1b[_0x332148(0x596)]+_0x332148(0xa55));const {proxyUrl:_0x2ac604,apiKey:_0x4779fb,model:_0x2da3a7}=_0x405767[_0x332148(0x9e0)];if(!_0x2ac604||!_0x4779fb||!_0x2da3a7){alert(_0x332148(0x6c2));return;}const _0x10a48b=_0x405767[_0x332148(0x20a)]['nickname']===_0x332148(0x2dc)||!_0x405767[_0x332148(0x20a)][_0x332148(0xab3)]?'用户':_0x405767[_0x332148(0x20a)][_0x332148(0xab3)],_0x35bb33=_0x2c1b1b['longTermMemory']&&_0x2c1b1b[_0x332148(0xbca)][_0x332148(0x105a)]>0x0?_0x2c1b1b[_0x332148(0xbca)]['map'](_0x5adcbd=>_0x332148(0xc09)+_0x4f34be(_0x5adcbd[_0x332148(0x351)])+')\x20'+_0x5adcbd[_0x332148(0x168)])['join']('\x0a'):'无',_0x1e5a4a=_0x2c1b1b[_0x332148(0x33a)][_0x332148(0x808)]||0xa,_0x4d03a8=_0x2c1b1b[_0x332148(0xd39)][_0x332148(0x961)](-_0x1e5a4a)['map'](_0x37dde7=>(_0x37dde7['role']===_0x332148(0x74b)?_0x10a48b:_0x2c1b1b[_0x332148(0x596)])+':\x20'+String(_0x37dde7['content'])[_0x332148(0x599)](0x0,0x1e)+'...')[_0x332148(0xb2c)]('\x0a'),_0x4c8853=(_0x2c1b1b[_0x332148(0x33a)][_0x332148(0xb77)]||[])[_0x332148(0x6b9)](_0x3c9386=>_0x405767[_0x332148(0x40e)][_0x332148(0x2ef)](_0x1067ca=>_0x1067ca['id']===_0x3c9386))[_0x332148(0x1d8)](Boolean)[_0x332148(0x6b9)](_0x4a190e=>_0x332148(0xec0)+_0x4a190e[_0x332148(0x596)]+_0x332148(0x405)+_0x4a190e[_0x332148(0x168)][_0x332148(0x1d8)](_0x198a7c=>_0x198a7c[_0x332148(0x69a)])[_0x332148(0x6b9)](_0xfd59eb=>'-\x20'+_0xfd59eb['content'])[_0x332148(0xb2c)]('\x0a'))[_0x332148(0xb2c)](''),_0x1c680f=_0x332148(0x291)+_0x2c1b1b[_0x332148(0x596)]+'”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x2c1b1b['settings'][_0x332148(0x1060)]+_0x332148(0x94a)+_0x35bb33+'\x0a'+_0x4c8853+'\x0a-\x20**你最近和“'+_0x10a48b+_0x332148(0x632)+_0x4d03a8+_0x332148(0x100f);try{const _0x39e756=[{'role':_0x332148(0x74b),'content':'请根据你的设定，生成你的歌单。'}];let _0x4c4ef7=_0x2ac604['includes'](_0x332148(0x3fe)),_0x5ec84e=_0x282b7e(_0x2da3a7,_0x4779fb,_0x1c680f,_0x39e756);const _0x25a6c3=_0x4c4ef7?await fetch(_0x5ec84e[_0x332148(0x9d6)],_0x5ec84e[_0x332148(0x49a)]):await fetch(_0x2ac604+_0x332148(0x5c1),{'method':_0x332148(0xcd0),'headers':{'Content-Type':'application/json','Authorization':_0x332148(0xf42)+_0x4779fb},'body':JSON[_0x332148(0x1175)]({'model':_0x2da3a7,'messages':[{'role':_0x332148(0x46c),'content':_0x1c680f},..._0x39e756],'temperature':_0x405767[_0x332148(0xb73)][_0x332148(0x8c7)]||0x1})});if(!_0x25a6c3['ok'])throw new Error(_0x332148(0xd83)+_0x25a6c3[_0x332148(0xd05)]);const _0x1ec8b1=await _0x25a6c3[_0x332148(0x7e9)](),_0x3d8fc9=getGeminiResponseText(_0x1ec8b1),_0xd6a228=_0x3d8fc9['replace'](/^```json\s*/,'')['replace'](/```$/,''),_0x76a633=JSON['parse'](_0xd6a228);await _0x501c7b('请稍候...',_0x332148(0xb65)+_0x76a633[_0x332148(0x105a)]+_0x332148(0xf9f));const _0x10542b=_0x76a633[_0x332148(0x6b9)](async _0x41dbcc=>{const _0x5ec9fa=_0x332148;let _0x45f9c8=await _0x3141b5(_0x41dbcc['songName'],_0x41dbcc['artistName']);(!_0x45f9c8||_0x45f9c8['length']===0x0)&&(_0x45f9c8=await _0x168471(_0x41dbcc[_0x5ec9fa(0xac8)]));if(_0x45f9c8[_0x5ec9fa(0x105a)]>0x0)return _0x544e17(_0x45f9c8[0x0]);return console[_0x5ec9fa(0x112a)]('所有音乐源都未能找到歌曲：“'+_0x41dbcc[_0x5ec9fa(0xac8)]+_0x5ec9fa(0x2e9)+_0x41dbcc['artistName']+'”'),null;}),_0x55d735=(await Promise[_0x332148(0xe88)](_0x10542b))[_0x332148(0x1d8)](Boolean);_0x2c1b1b[_0x332148(0x3ee)]=_0x55d735,await _0x15043e[_0x332148(0x799)]['put'](_0x2c1b1b),await _0x5b3fa9();}catch(_0x50a2c5){console[_0x332148(0x7a3)]('生成模拟歌单失败:',_0x50a2c5),await _0x501c7b(_0x332148(0x40b),_0x332148(0x17b)+_0x50a2c5[_0x332148(0xc7d)]);}}function _0x5b3fa9(){const _0xc46cf2=_0x18b51e,_0x335862=document[_0xc46cf2(0x8c2)]('char-music-list');_0x335862[_0xc46cf2(0xca0)]='';if(!_0x1f6e46)return;const _0x3a11b8=_0x405767[_0xc46cf2(0x799)][_0x1f6e46],_0x5c91ce=_0x3a11b8['simulatedMusicPlaylist']||[];if(_0x5c91ce['length']===0x0){_0x335862['innerHTML']=_0xc46cf2(0x10ca);return;}_0x5c91ce['forEach']((_0x4936c9,_0x55b1f0)=>{const _0x1960b5=_0xc46cf2,_0x138e26=document[_0x1960b5(0x8c1)](_0x1960b5(0x1072));_0x138e26[_0x1960b5(0x84c)]='char-music-item',_0x138e26[_0x1960b5(0xca0)]=_0x1960b5(0x1069)+_0x4936c9[_0x1960b5(0xcf0)]+_0x1960b5(0xe44)+_0x4936c9[_0x1960b5(0x596)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>'+_0x4936c9[_0x1960b5(0x7af)]+_0x1960b5(0xa5e),_0x138e26[_0x1960b5(0xae8)](_0x1960b5(0xa17),()=>_0xc32c1d(_0x4936c9)),_0x335862[_0x1960b5(0x31e)](_0x138e26);});}let _0x4dee71={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':_0x18b51e(0x358),'lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0xc32c1d(_0x5570fe){const _0x42ab37=_0x18b51e,_0x3f2c80=document[_0x42ab37(0x8c2)](_0x42ab37(0xce1)),_0x16c29a=document[_0x42ab37(0x8c2)](_0x42ab37(0x23d));if(_0x4dee71[_0x42ab37(0xda9)])clearInterval(_0x4dee71[_0x42ab37(0xda9)]);_0x3f2c80[_0x42ab37(0xf08)]();const _0x5ac6ce=_0x4dee71[_0x42ab37(0x448)]['findIndex'](_0xf0f096=>_0xf0f096[_0x42ab37(0x939)]===_0x5570fe[_0x42ab37(0x939)]);_0x5ac6ce>-0x1?_0x4dee71[_0x42ab37(0x585)]=_0x5ac6ce:(_0x4dee71[_0x42ab37(0x448)]=[_0x5570fe],_0x4dee71[_0x42ab37(0x585)]=0x0);document[_0x42ab37(0x8c2)](_0x42ab37(0xaf2))[_0x42ab37(0x1090)]=_0x5570fe[_0x42ab37(0x596)],document['getElementById'](_0x42ab37(0x616))[_0x42ab37(0x1090)]=_0x5570fe[_0x42ab37(0x7af)],document['getElementById']('char-music-cover')[_0x42ab37(0x939)]=_0x5570fe[_0x42ab37(0xcf0)],_0x4dee71[_0x42ab37(0x619)]=_0x584f3f(_0x5570fe[_0x42ab37(0xb07)]||''),_0x18df58();if(_0x5570fe[_0x42ab37(0xc6b)]){const _0x167d0c=new Blob([_0x5570fe[_0x42ab37(0x939)]],{'type':_0x5570fe[_0x42ab37(0x119b)]||_0x42ab37(0xc3e)});_0x3f2c80[_0x42ab37(0x939)]=URL['createObjectURL'](_0x167d0c);}else _0x3f2c80['src']=_0x5570fe[_0x42ab37(0x939)];_0x3f2c80[_0x42ab37(0xf12)]()[_0x42ab37(0x120c)](_0x2159f3=>console[_0x42ab37(0x7a3)](_0x42ab37(0x949),_0x2159f3)),_0x3f2c80[_0x42ab37(0x7e1)]=()=>{const _0x9e38fd=_0x42ab37;document[_0x9e38fd(0x8c2)](_0x9e38fd(0x47d))[_0x9e38fd(0x1090)]=_0x5a2954(_0x3f2c80[_0x9e38fd(0xf2c)]),_0x4dee71[_0x9e38fd(0xda9)]=setInterval(_0x4be093,0x1f4);},_0x16c29a[_0x42ab37(0xb17)]['add'](_0x42ab37(0x2cd));}function _0x5e38d4(){const _0x51393c=_0x18b51e,_0x21c7ee=document[_0x51393c(0x8c2)]('char-music-player-modal'),_0x3a9096=document[_0x51393c(0x8c2)]('char-audio-player');if(_0x4dee71[_0x51393c(0xda9)])clearInterval(_0x4dee71[_0x51393c(0xda9)]);_0x3a9096[_0x51393c(0xf08)](),_0x3a9096[_0x51393c(0x939)]='',_0x21c7ee[_0x51393c(0xb17)]['remove'](_0x51393c(0x2cd)),_0x4dee71[_0x51393c(0x219)]=![],document[_0x51393c(0x8c2)](_0x51393c(0x81a))[_0x51393c(0xb17)][_0x51393c(0xaff)](_0x51393c(0x994));}function _0x4be093(){const _0x1e448=_0x18b51e,_0xa6f07c=document[_0x1e448(0x8c2)]('char-audio-player');if(!_0xa6f07c['duration'])return;const _0x30c2e6=_0xa6f07c[_0x1e448(0xe5e)],_0x41bbe7=_0xa6f07c[_0x1e448(0xf2c)];document['getElementById'](_0x1e448(0x3ff))[_0x1e448(0x842)][_0x1e448(0x578)]=_0x30c2e6/_0x41bbe7*0x64+'%',document[_0x1e448(0x8c2)]('char-music-current-time')[_0x1e448(0x1090)]=_0x5a2954(_0x30c2e6),_0x2a9451(_0x30c2e6);}function _0x18df58(){const _0x1e85ed=_0x18b51e,_0x4eef78=document['getElementById']('char-music-lyrics');_0x4eef78[_0x1e85ed(0xca0)]='',_0x4dee71[_0x1e85ed(0x117a)]=-0x1;if(!_0x4dee71[_0x1e85ed(0x619)]||_0x4dee71[_0x1e85ed(0x619)][_0x1e85ed(0x105a)]===0x0){_0x4eef78['innerHTML']=_0x1e85ed(0x6b0);return;}_0x4dee71['parsedLyrics']['forEach']((_0x59d82c,_0x16c6cc)=>{const _0xe0ba56=_0x1e85ed,_0x4816b7=document[_0xe0ba56(0x8c1)]('p');_0x4816b7[_0xe0ba56(0x1090)]=_0x59d82c[_0xe0ba56(0xbc6)],_0x4816b7['dataset'][_0xe0ba56(0x2f2)]=_0x16c6cc,_0x4eef78[_0xe0ba56(0x31e)](_0x4816b7);});}function _0x2a9451(_0x1d4791){const _0x48ce51=_0x18b51e,_0x49466b=_0x4dee71[_0x48ce51(0x619)];if(_0x49466b[_0x48ce51(0x105a)]===0x0)return;let _0x35792b=-0x1;for(let _0x2be747=0x0;_0x2be747<_0x49466b[_0x48ce51(0x105a)];_0x2be747++){if(_0x1d4791>=_0x49466b[_0x2be747]['time'])_0x35792b=_0x2be747;else break;}if(_0x35792b===_0x4dee71[_0x48ce51(0x117a)])return;_0x4dee71['currentLyricIndex']=_0x35792b;const _0x142133=document[_0x48ce51(0x8c2)](_0x48ce51(0xeba)),_0x39b1=_0x142133[_0x48ce51(0xa2d)]('p');_0x39b1[_0x48ce51(0x7c0)](_0x180b4b=>_0x180b4b['classList'][_0x48ce51(0xaff)](_0x48ce51(0x71b)));if(_0x35792b>-0x1){const _0x52db34=_0x142133[_0x48ce51(0x1ad)]('p[data-index=\x22'+_0x35792b+'\x22]');if(_0x52db34){_0x52db34[_0x48ce51(0xb17)][_0x48ce51(0x3f4)]('active');const _0x2ecc74=_0x142133[_0x48ce51(0x7b3)]/0x2-_0x52db34['offsetTop']-_0x52db34[_0x48ce51(0x633)]/0x2;_0x39b1[_0x48ce51(0x7c0)](_0x4f1dcb=>{const _0x1cd9a1=_0x48ce51;_0x4f1dcb['style'][_0x1cd9a1(0xb56)]=_0x1cd9a1(0x830)+_0x2ecc74+_0x1cd9a1(0x4e8);});}}}function _0x475502(){const _0x134609=_0x18b51e;if(_0x4dee71[_0x134609(0x448)][_0x134609(0x105a)]===0x0)return;let _0x1b923d;switch(_0x4dee71['playMode']){case _0x134609(0x5b3):_0x1b923d=Math[_0x134609(0x10b2)](Math['random']()*_0x4dee71[_0x134609(0x448)][_0x134609(0x105a)]);break;case _0x134609(0xa9b):_0xc32c1d(_0x4dee71[_0x134609(0x448)][_0x4dee71['currentIndex']]);return;case _0x134609(0x358):default:_0x1b923d=(_0x4dee71[_0x134609(0x585)]+0x1)%_0x4dee71[_0x134609(0x448)][_0x134609(0x105a)];break;}_0xc32c1d(_0x4dee71[_0x134609(0x448)][_0x1b923d]);}function _0x2996e0(){const _0x4afb09=_0x18b51e;if(_0x4dee71[_0x4afb09(0x448)]['length']===0x0)return;const _0xbdcb5b=(_0x4dee71['currentIndex']-0x1+_0x4dee71[_0x4afb09(0x448)][_0x4afb09(0x105a)])%_0x4dee71[_0x4afb09(0x448)][_0x4afb09(0x105a)];_0xc32c1d(_0x4dee71[_0x4afb09(0x448)][_0xbdcb5b]);}function _0x2c8055(){const _0x2e8dc0=_0x18b51e,_0x90fe45=['order',_0x2e8dc0(0x5b3),'single'],_0x5d1d5f=_0x90fe45[_0x2e8dc0(0xbf2)](_0x4dee71[_0x2e8dc0(0xeb0)]);_0x4dee71['playMode']=_0x90fe45[(_0x5d1d5f+0x1)%_0x90fe45[_0x2e8dc0(0x105a)]],document[_0x2e8dc0(0x8c2)](_0x2e8dc0(0x435))[_0x2e8dc0(0x1090)]={'order':'顺序','random':'随机','single':'单曲'}[_0x4dee71[_0x2e8dc0(0xeb0)]];}function _0x4a132f(){const _0x1529be=_0x18b51e,_0x159c26=document[_0x1529be(0x8c2)]('char-audio-player'),_0x270879=document['getElementById'](_0x1529be(0x98d)),_0x3e1611=document['getElementById'](_0x1529be(0x81a));_0x270879['addEventListener'](_0x1529be(0xa17),()=>{const _0xa7c1f2=_0x1529be;if(_0x159c26['paused']){if(_0x4dee71[_0xa7c1f2(0x585)]>-0x1)_0x159c26[_0xa7c1f2(0xf12)]();}else _0x159c26['pause']();}),_0x159c26[_0x1529be(0x643)]=()=>{const _0x524c3a=_0x1529be;_0x270879[_0x524c3a(0xca0)]=_0x524c3a(0x924),_0x3e1611[_0x524c3a(0xb17)][_0x524c3a(0x3f4)](_0x524c3a(0x994)),_0x4dee71[_0x524c3a(0x219)]=!![];},_0x159c26[_0x1529be(0xe7b)]=()=>{const _0x275c88=_0x1529be;_0x270879[_0x275c88(0xca0)]=_0x275c88(0x404),_0x3e1611[_0x275c88(0xb17)][_0x275c88(0xaff)](_0x275c88(0x994)),_0x4dee71[_0x275c88(0x219)]=![];},_0x159c26[_0x1529be(0xe85)]=()=>{const _0x32b15e=_0x1529be;_0x3e1611['classList'][_0x32b15e(0xaff)](_0x32b15e(0x994)),_0x4dee71[_0x32b15e(0x219)]=![],_0x475502();},document[_0x1529be(0x8c2)](_0x1529be(0x649))[_0x1529be(0xae8)]('click',_0x2996e0),document[_0x1529be(0x8c2)](_0x1529be(0x2a9))[_0x1529be(0xae8)]('click',_0x475502),document['getElementById'](_0x1529be(0x435))['addEventListener'](_0x1529be(0xa17),_0x2c8055),document[_0x1529be(0x8c2)](_0x1529be(0xa03))[_0x1529be(0xae8)](_0x1529be(0xa17),_0x3c4920=>{const _0x117dd4=_0x1529be;if(!_0x159c26[_0x117dd4(0xf2c)])return;const _0x275072=_0x3c4920[_0x117dd4(0x11d8)],_0x2e3841=_0x3c4920[_0x117dd4(0x2a7)];_0x159c26['currentTime']=_0x2e3841/_0x275072['clientWidth']*_0x159c26[_0x117dd4(0xf2c)];});}async function _0x420532(){const _0xbcfd33=_0x18b51e,_0x2620ce=document[_0xbcfd33(0x8c2)]('douban-posts-list');_0x2620ce[_0xbcfd33(0xca0)]='';const _0x2e872b=await _0x15043e['doubanPosts'][_0xbcfd33(0x731)]('timestamp')[_0xbcfd33(0x1c0)]()['toArray']();if(_0x2e872b['length']===0x0){_0x2620ce[_0xbcfd33(0xca0)]=_0xbcfd33(0x660);return;}_0x2e872b[_0xbcfd33(0x7c0)](_0x2f3199=>{const _0xc5e8a=_0xbcfd33;let _0x3b7ef6;const _0x136bd9=_0x2f3199[_0xc5e8a(0x10ec)]?Object[_0xc5e8a(0x22f)](_0x405767['chats'])['find'](_0x521d1c=>!_0x521d1c[_0xc5e8a(0x1000)]&&_0x521d1c[_0xc5e8a(0x596)]===_0x2f3199[_0xc5e8a(0x10ec)]):null;if(_0x136bd9)_0x3b7ef6=_0x136bd9[_0xc5e8a(0x33a)]['aiAvatar'];else{const _0x943497=Object[_0xc5e8a(0x22f)](_0x405767[_0xc5e8a(0x799)])[_0xc5e8a(0x2ef)](_0x54088a=>!_0x54088a[_0xc5e8a(0x1000)]&&_0x54088a[_0xc5e8a(0x596)]===_0x2f3199[_0xc5e8a(0x718)]);if(_0x943497)_0x3b7ef6=_0x943497['settings'][_0xc5e8a(0x44e)];else _0x2f3199[_0xc5e8a(0x6ef)]?_0x3b7ef6='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x2f3199[_0xc5e8a(0x6ef)]):_0x3b7ef6=_0x49d2a4;}const _0xc1410f=document['createElement']('div');_0xc1410f[_0xc5e8a(0x84c)]=_0xc5e8a(0x11df),_0xc1410f[_0xc5e8a(0xcda)]=()=>_0x4d304b(_0x2f3199['id']),_0xc1410f[_0xc5e8a(0xca0)]=_0xc5e8a(0xc6d)+_0x3b7ef6+_0xc5e8a(0x10f6)+_0x2f3199[_0xc5e8a(0x718)]+_0xc5e8a(0xc96)+_0x2f3199[_0xc5e8a(0xd6d)]+_0xc5e8a(0xcbb)+_0x2f3199['postTitle']+_0xc5e8a(0xb87)+_0x2f3199[_0xc5e8a(0x168)]['replace'](/\n/g,_0xc5e8a(0x854))+_0xc5e8a(0xf1e)+_0x2f3199[_0xc5e8a(0x753)]+_0xc5e8a(0x66a)+_0x2f3199[_0xc5e8a(0x713)]+_0xc5e8a(0x1c4)+_0x4f34be(_0x2f3199[_0xc5e8a(0x351)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x2620ce[_0xc5e8a(0x31e)](_0xc1410f);});}async function _0x53a131(){const _0x34c1ba=_0x18b51e,_0x3e7329=_0x405767['globalSettings'][_0x34c1ba(0x460)]||[];if(_0x3e7329[_0x34c1ba(0x105a)]===0x0){await _0x501c7b(_0x34c1ba(0x8e1),'请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。');return;}await _0x501c7b(_0x34c1ba(0x1047),_0x34c1ba(0x10fd)+_0x3e7329[_0x34c1ba(0x105a)]+_0x34c1ba(0x9c6));const {proxyUrl:_0xb427b,apiKey:_0x1eb20d,model:_0xb15042}=_0x405767[_0x34c1ba(0x9e0)];if(!_0xb427b||!_0x1eb20d||!_0xb15042){alert(_0x34c1ba(0x6c2));return;}const _0xdc6faa=new Set();_0x3e7329['forEach'](_0x4044fa=>{const _0x3d2021=_0x34c1ba,_0x1882c0=_0x405767[_0x3d2021(0x799)][_0x4044fa];_0x1882c0&&_0x1882c0[_0x3d2021(0x33a)]['linkedWorldBookIds']&&_0x1882c0['settings']['linkedWorldBookIds'][_0x3d2021(0x7c0)](_0x42303c=>_0xdc6faa[_0x3d2021(0x3f4)](_0x42303c));});let _0xa99e8f='';_0xdc6faa[_0x34c1ba(0xf72)]>0x0&&(_0xa99e8f+=_0x34c1ba(0x5c4),_0xdc6faa[_0x34c1ba(0x7c0)](_0xd78658=>{const _0x167e85=_0x34c1ba,_0x3cec9a=_0x405767[_0x167e85(0x40e)][_0x167e85(0x2ef)](_0x32a01d=>_0x32a01d['id']===_0xd78658);if(_0x3cec9a){const _0x1f9994=_0x3cec9a[_0x167e85(0x168)][_0x167e85(0x1d8)](_0x4ae56e=>_0x4ae56e[_0x167e85(0x69a)]!==![])[_0x167e85(0x6b9)](_0xbceaa4=>'-\x20'+_0xbceaa4[_0x167e85(0x168)])[_0x167e85(0xb2c)]('\x0a');_0x1f9994&&(_0xa99e8f+=_0x167e85(0x9a3)+_0x3cec9a[_0x167e85(0x596)]+_0x167e85(0x156)+_0x1f9994);}}));const _0x323095=_0x405767['worldBooks'][_0x34c1ba(0x2ef)](_0x4bb222=>_0x4bb222[_0x34c1ba(0x596)]===_0x34c1ba(0x3c9));let _0x344aec='',_0x1e18f6=[];_0x323095&&_0x323095[_0x34c1ba(0x168)][_0x34c1ba(0x7c0)](_0x25ba08=>{const _0x41c7ec=_0x34c1ba;_0x25ba08[_0x41c7ec(0x120a)]['includes'](_0x41c7ec(0x2af))&&(_0x344aec+=_0x41c7ec(0xba0)+_0x25ba08[_0x41c7ec(0x168)]);if(_0x25ba08[_0x41c7ec(0x120a)]['includes'](_0x41c7ec(0x4c3))){const _0x575a9e=_0x25ba08[_0x41c7ec(0x168)][_0x41c7ec(0x111f)]('\x0a');_0x575a9e['forEach'](_0x5a286d=>{const _0x32663f=_0x41c7ec,_0x7b4026=_0x5a286d[_0x32663f(0xdf8)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x7b4026&&_0x1e18f6[_0x32663f(0xa49)]({'name':_0x7b4026[0x1]['trim'](),'persona':_0x7b4026[0x2]['trim']()});});}});const _0x51937e=_0x405767[_0x34c1ba(0x20a)]['nickname']||'我',_0x8d5b2b=_0x3e7329['length']>0x0&&_0x405767[_0x34c1ba(0x799)][_0x3e7329[0x0]]?_0x405767[_0x34c1ba(0x799)][_0x3e7329[0x0]][_0x34c1ba(0x33a)][_0x34c1ba(0xbe8)]:_0x34c1ba(0x496);let _0x51ab18='';_0x3e7329[_0x34c1ba(0x7c0)](_0x33fcbd=>{const _0xaec47b=_0x34c1ba,_0x58edfd=_0x405767[_0xaec47b(0x799)][_0x33fcbd];if(_0x58edfd){const _0x5267e0=_0x58edfd['longTermMemory']&&_0x58edfd[_0xaec47b(0xbca)]['length']>0x0?_0x58edfd[_0xaec47b(0xbca)][_0xaec47b(0x6b9)](_0xc96050=>_0xc96050[_0xaec47b(0x168)])[_0xaec47b(0xb2c)](';\x20'):'无',_0x8f29c2=_0x58edfd[_0xaec47b(0xd39)][_0xaec47b(0x961)](-0xa)[_0xaec47b(0x6b9)](_0x3ab76c=>(_0x3ab76c['role']==='user'?_0x51937e:_0x58edfd['name'])+':\x20'+String(_0x3ab76c['content'])[_0xaec47b(0x599)](0x0,0x1e)+_0xaec47b(0x388))[_0xaec47b(0xb2c)]('\x0a');_0x51ab18+='\x0a<character>\x0a\x20\x20<name>'+_0x58edfd['name']+_0xaec47b(0xd6b)+_0x58edfd[_0xaec47b(0x33a)][_0xaec47b(0x1060)]+_0xaec47b(0x933)+_0x5267e0+_0xaec47b(0x989)+_0x8f29c2+_0xaec47b(0xe9c);}}),_0x1e18f6['forEach'](_0x5bf2c7=>{const _0x12c65e=_0x34c1ba;_0x51ab18+=_0x12c65e(0xae2)+_0x5bf2c7[_0x12c65e(0x596)]+_0x12c65e(0xd6b)+_0x5bf2c7[_0x12c65e(0x391)]+_0x12c65e(0xff0);});const _0x5978e4=new Date(),_0x46aff3=_0x5978e4[_0x34c1ba(0x2e8)](_0x34c1ba(0x73e),{'dateStyle':_0x34c1ba(0x196),'timeStyle':_0x34c1ba(0xd9b)}),_0x1e954c=_0x405767[_0x34c1ba(0xb73)][_0x34c1ba(0x89a)]||0xc,_0x5aa27c=_0x405767[_0x34c1ba(0xb73)][_0x34c1ba(0xff3)]||0x14,_0x478a12='\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【'+_0x1e954c+'到'+_0x5aa27c+'篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**'+_0x46aff3+_0x34c1ba(0x401)+_0x51937e+_0x34c1ba(0x5b5)+_0x51937e+'”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a'+_0x344aec+'\x0a'+_0xa99e8f+_0x34c1ba(0xe3d)+_0x46aff3+_0x34c1ba(0xb4b)+_0x51937e+_0x34c1ba(0xf6a)+_0x8d5b2b+_0x34c1ba(0x6af)+_0x51ab18+_0x34c1ba(0x51e);try{const _0x109420=[{'role':_0x34c1ba(0x74b),'content':_0x34c1ba(0x10e3)}];let _0x4839b0=_0xb427b[_0x34c1ba(0x773)](_0x34c1ba(0x3fe)),_0x319567=_0x282b7e(_0xb15042,_0x1eb20d,_0x478a12,_0x109420);const _0x5e8e52=_0x4839b0?await fetch(_0x319567[_0x34c1ba(0x9d6)],_0x319567['data']):await fetch(_0xb427b+'/v1/chat/completions',{'method':_0x34c1ba(0xcd0),'headers':{'Content-Type':_0x34c1ba(0xcb6),'Authorization':_0x34c1ba(0xf42)+_0x1eb20d},'body':JSON[_0x34c1ba(0x1175)]({'model':_0xb15042,'messages':[{'role':_0x34c1ba(0x46c),'content':_0x478a12},..._0x109420],'temperature':_0x405767[_0x34c1ba(0xb73)]['apiTemperature']||0x1})});if(!_0x5e8e52['ok'])throw new Error('API\x20错误:\x20'+_0x5e8e52[_0x34c1ba(0xd05)]);const _0xb066a3=await _0x5e8e52[_0x34c1ba(0x7e9)](),_0x219b6f=getGeminiResponseText(_0xb066a3),_0x5814ee=_0x219b6f[_0x34c1ba(0xdf8)](/\[[\s\S]*\]/);if(!_0x5814ee)throw new Error(_0x34c1ba(0x119d)+_0x219b6f);const _0x3914c7=JSON[_0x34c1ba(0x10ab)](_0x5814ee[0x0]);await _0x15043e[_0x34c1ba(0xd12)][_0x34c1ba(0xa6a)](),await _0x15043e[_0x34c1ba(0xd12)][_0x34c1ba(0x116d)](_0x3914c7[_0x34c1ba(0x6b9)](_0x127e98=>({..._0x127e98,'timestamp':Date['now']()-Math[_0x34c1ba(0x5b3)]()*0x186a0}))),await _0x420532();}catch(_0x268978){console[_0x34c1ba(0x7a3)]('生成豆瓣帖子失败:',_0x268978),await _0x501c7b(_0x34c1ba(0x40b),_0x34c1ba(0xb68)+_0x268978[_0x34c1ba(0xc7d)]);}}async function _0x4d304b(_0x3852ae){const _0x5878fb=_0x18b51e;_0x3d1990('douban-post-detail-screen'),_0x32ff0a=_0x3852ae;const _0x320872=await _0x15043e[_0x5878fb(0xd12)][_0x5878fb(0x3e9)](_0x3852ae);if(!_0x320872){_0x3d1990('douban-screen');return;}document[_0x5878fb(0x8c2)](_0x5878fb(0x97b))[_0x5878fb(0x1090)]=_0x5878fb(0xc8c);let _0x232f61=_0x49d2a4,_0x265cc7=_0x320872[_0x5878fb(0x718)];const _0x33821a=_0x320872['authorOriginalName']?Object[_0x5878fb(0x22f)](_0x405767[_0x5878fb(0x799)])[_0x5878fb(0x2ef)](_0x4b0f57=>!_0x4b0f57[_0x5878fb(0x1000)]&&_0x4b0f57[_0x5878fb(0x4e7)]===_0x320872[_0x5878fb(0x10ec)]):null;if(_0x33821a)_0x232f61=_0x33821a[_0x5878fb(0x33a)][_0x5878fb(0x44e)];else{const _0x2678c4=Object[_0x5878fb(0x22f)](_0x405767[_0x5878fb(0x799)])[_0x5878fb(0x2ef)](_0x2fc70e=>!_0x2fc70e[_0x5878fb(0x1000)]&&_0x2fc70e[_0x5878fb(0x596)]===_0x320872[_0x5878fb(0x718)]);if(_0x2678c4)_0x232f61=_0x2678c4[_0x5878fb(0x33a)]['aiAvatar'];else _0x320872['authorAvatarPrompt']&&(_0x232f61=_0x5878fb(0x2c6)+encodeURIComponent(_0x320872['authorAvatarPrompt']));}document[_0x5878fb(0x8c2)](_0x5878fb(0xdb0))[_0x5878fb(0x939)]=_0x232f61,document[_0x5878fb(0x8c2)]('douban-detail-author')[_0x5878fb(0x1090)]=_0x265cc7,document[_0x5878fb(0x8c2)](_0x5878fb(0xb11))['textContent']=_0x5878fb(0x422)+_0x320872[_0x5878fb(0xd6d)],document['getElementById'](_0x5878fb(0x1251))[_0x5878fb(0x1090)]=_0x320872[_0x5878fb(0x5f8)],document[_0x5878fb(0x8c2)](_0x5878fb(0x434))[_0x5878fb(0xca0)]=_0x320872['content'][_0x5878fb(0x1b7)](/\n/g,'<br>'),document[_0x5878fb(0x8c2)](_0x5878fb(0x11c8))[_0x5878fb(0x939)]=_0x405767['qzoneSettings'][_0x5878fb(0x1e1)],document[_0x5878fb(0x8c2)](_0x5878fb(0x4b7))[_0x5878fb(0x518)]='';const _0x562915=document[_0x5878fb(0x8c2)](_0x5878fb(0x765));_0x562915[_0x5878fb(0xca0)]='';if(_0x320872[_0x5878fb(0x93c)]&&_0x320872[_0x5878fb(0x93c)][_0x5878fb(0x105a)]>0x0){const _0x123255=new Map();_0x320872['comments'][_0x5878fb(0x7c0)](_0x43cfc8=>{const _0x4d88e5=_0x5878fb;let _0x2d86fd=_0x49d2a4;const _0x15b2fe=_0x405767[_0x4d88e5(0x20a)][_0x4d88e5(0xab3)]||'我',_0x377807=_0x43cfc8[_0x4d88e5(0x92b)];if(_0x123255[_0x4d88e5(0x11ac)](_0x377807))_0x2d86fd=_0x123255['get'](_0x377807);else{if(_0x377807===_0x15b2fe)_0x2d86fd=_0x405767[_0x4d88e5(0x20a)][_0x4d88e5(0x1e1)];else{if(_0x377807===_0x320872[_0x4d88e5(0x718)])_0x2d86fd=_0x232f61;else{const _0x333393=_0x43cfc8['commenterOriginalName']?Object['values'](_0x405767['chats'])[_0x4d88e5(0x2ef)](_0x10997a=>!_0x10997a[_0x4d88e5(0x1000)]&&_0x10997a[_0x4d88e5(0x4e7)]===_0x43cfc8[_0x4d88e5(0x553)]):null;if(_0x333393)_0x2d86fd=_0x333393['settings']['aiAvatar'];else{const _0x8d9729=Object['values'](_0x405767[_0x4d88e5(0x799)])[_0x4d88e5(0x2ef)](_0x5e65ed=>!_0x5e65ed[_0x4d88e5(0x1000)]&&_0x5e65ed['name']===_0x377807);if(_0x8d9729)_0x2d86fd=_0x8d9729['settings']['aiAvatar'];else _0x43cfc8['avatar_prompt']&&(_0x2d86fd=_0x4d88e5(0x2c6)+encodeURIComponent(_0x43cfc8[_0x4d88e5(0x10f4)]));}}}_0x123255[_0x4d88e5(0xf5a)](_0x377807,_0x2d86fd);}const _0xabdac6=document[_0x4d88e5(0x8c1)]('div');_0xabdac6[_0x4d88e5(0x84c)]=_0x4d88e5(0xdfb),_0xabdac6[_0x4d88e5(0xca0)]=_0x4d88e5(0x3fb)+_0x2d86fd+_0x4d88e5(0x237)+_0x377807+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>'+_0x43cfc8[_0x4d88e5(0xbc6)][_0x4d88e5(0x1b7)](/\n/g,'<br>')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x562915['appendChild'](_0xabdac6);});}else _0x562915[_0x5878fb(0xca0)]=_0x5878fb(0x964);const _0x25d1d5=document['getElementById'](_0x5878fb(0x4cf));if(_0x25d1d5)_0x25d1d5[_0x5878fb(0xfd0)]=0x0;}async function _0x442a66(){const _0x48cb64=_0x18b51e;if(!_0x32ff0a)return;const _0x1f5910=document[_0x48cb64(0x8c2)]('douban-comment-input'),_0xb789df=_0x1f5910['value'][_0x48cb64(0x8c6)]();if(!_0xb789df)return;const _0x27e453=await _0x15043e['doubanPosts']['get'](_0x32ff0a);if(!_0x27e453)return;!_0x27e453[_0x48cb64(0x93c)]&&(_0x27e453['comments']=[]);const _0x108ff5=_0x405767[_0x48cb64(0x20a)]['nickname']||'我';_0x27e453[_0x48cb64(0x93c)][_0x48cb64(0xa49)]({'commenter':_0x108ff5,'text':_0xb789df}),_0x27e453[_0x48cb64(0x713)]++,await _0x15043e['doubanPosts'][_0x48cb64(0xfaa)](_0x27e453),_0x1f5910[_0x48cb64(0x518)]='',await _0x4d304b(_0x32ff0a);}async function _0x5ac4ce(){const _0xb8eb8c=_0x18b51e;if(!_0x32ff0a)return;const _0x1b0f46=_0x32ff0a,_0x3c42f5=await _0x15043e[_0xb8eb8c(0xd12)][_0xb8eb8c(0x3e9)](_0x1b0f46);if(!_0x3c42f5)return;const _0x272648=_0x3c42f5[_0xb8eb8c(0x93c)]&&_0x3c42f5[_0xb8eb8c(0x93c)]['slice'](-0x1)[0x0];if(!_0x272648){alert(_0xb8eb8c(0x580));return;}await _0x501c7b(_0xb8eb8c(0x1047),_0xb8eb8c(0xc90));try{const {proxyUrl:_0x1a78ff,apiKey:_0x312d98,model:_0xc888dd}=_0x405767['apiConfig'];if(!_0x1a78ff||!_0x312d98||!_0xc888dd)throw new Error(_0xb8eb8c(0x1170));const _0x4bd08e=_0x405767[_0xb8eb8c(0x20a)][_0xb8eb8c(0xab3)]||'我',_0x2ec293=_0x405767[_0xb8eb8c(0x799)][Object[_0xb8eb8c(0xbda)](_0x405767['chats'])[0x0]]?.[_0xb8eb8c(0x33a)][_0xb8eb8c(0xbe8)]||_0xb8eb8c(0x496),_0x4c50c5=new Map();_0x3c42f5[_0xb8eb8c(0x93c)]&&_0x3c42f5['comments']['forEach'](_0x47accf=>{const _0x536cac=_0xb8eb8c,_0x4699c8=(_0x405767['globalSettings'][_0x536cac(0x460)]||[])[_0x536cac(0xdc3)](_0x2a4584=>_0x405767[_0x536cac(0x799)][_0x2a4584]?.[_0x536cac(0x596)]===_0x47accf['commenter']);!_0x4699c8&&_0x47accf[_0x536cac(0x10f4)]&&_0x4c50c5[_0x536cac(0xf5a)](_0x47accf['commenter'],_0x47accf[_0x536cac(0x10f4)]);});let _0x396d42=_0xb8eb8c(0x1042);_0x4c50c5['size']>0x0?(_0x396d42+='如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a',_0x4c50c5['forEach']((_0xfcb3c9,_0x1670fa)=>{const _0x22de69=_0xb8eb8c;_0x396d42+=_0x22de69(0xc39)+_0x1670fa+'**:\x20\x22'+_0xfcb3c9+'\x22\x0a';})):_0x396d42+=_0xb8eb8c(0xc1b);const _0x36d4cc=_0x405767[_0xb8eb8c(0x40e)][_0xb8eb8c(0x2ef)](_0x51476e=>_0x51476e['name']==='豆瓣设定');let _0x893ddb=[];_0x36d4cc&&_0x36d4cc[_0xb8eb8c(0x168)][_0xb8eb8c(0x7c0)](_0x1374b2=>{const _0x4e187b=_0xb8eb8c;if(_0x1374b2[_0x4e187b(0x120a)][_0x4e187b(0x773)](_0x4e187b(0x4c3))){const _0x30a3c1=_0x1374b2[_0x4e187b(0x168)]['split']('\x0a');_0x30a3c1[_0x4e187b(0x7c0)](_0x4a5e6e=>{const _0x454434=_0x4e187b,_0x598114=_0x4a5e6e['match'](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x598114&&_0x893ddb[_0x454434(0xa49)]({'name':_0x598114[0x1][_0x454434(0x8c6)](),'persona':_0x598114[0x2][_0x454434(0x8c6)]()});});}});let _0x550839='';const _0x1ebf62=_0x405767[_0xb8eb8c(0xb73)][_0xb8eb8c(0x460)]||[];_0x1ebf62[_0xb8eb8c(0x7c0)](_0x47cc0a=>{const _0x455a52=_0xb8eb8c,_0x42ff06=_0x405767[_0x455a52(0x799)][_0x47cc0a];if(_0x42ff06){const _0x4d1496=_0x42ff06[_0x455a52(0xbca)]&&_0x42ff06[_0x455a52(0xbca)][_0x455a52(0x105a)]>0x0?_0x42ff06[_0x455a52(0xbca)][_0x455a52(0x6b9)](_0x4b3d84=>_0x4b3d84[_0x455a52(0x168)])[_0x455a52(0xb2c)](';\x20'):'无',_0x26bfa9=_0x42ff06[_0x455a52(0xd39)][_0x455a52(0x961)](-0xa)[_0x455a52(0x6b9)](_0x152a38=>(_0x152a38[_0x455a52(0x14a)]===_0x455a52(0x74b)?_0x4bd08e:_0x42ff06['name'])+':\x20'+String(_0x152a38['content'])[_0x455a52(0x599)](0x0,0x1e)+_0x455a52(0x388))[_0x455a52(0xb2c)]('\x0a');_0x550839+=_0x455a52(0x154)+_0x42ff06[_0x455a52(0x596)]+':\x20'+_0x42ff06[_0x455a52(0x33a)][_0x455a52(0x1060)][_0x455a52(0x599)](0x0,0x32)+_0x455a52(0xbe9)+_0x4d1496+_0x455a52(0x814)+_0x26bfa9+']';}}),_0x893ddb['forEach'](_0x2c92c7=>{const _0x437684=_0xb8eb8c;_0x550839+=_0x437684(0x154)+_0x2c92c7[_0x437684(0x596)]+':\x20'+_0x2c92c7[_0x437684(0x391)];});const _0x4eb92a=new Date(),_0x42fd39=_0x4eb92a['toLocaleString'](_0xb8eb8c(0x73e),{'dateStyle':_0xb8eb8c(0x196),'timeStyle':_0xb8eb8c(0xd9b)}),_0x42dc5c=_0xb8eb8c(0xf1c)+_0x4bd08e+_0xb8eb8c(0x1140)+_0x42fd39+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“'+_0x4bd08e+_0xb8eb8c(0xf7e)+_0x4bd08e+_0xb8eb8c(0xd2f)+_0x3c42f5[_0xb8eb8c(0x5f8)]+_0xb8eb8c(0xc22)+_0x3c42f5[_0xb8eb8c(0x718)]+_0xb8eb8c(0x591)+_0x3c42f5['content']['substring'](0x0,0x64)+_0xb8eb8c(0x88a)+_0x3c42f5[_0xb8eb8c(0x93c)][_0xb8eb8c(0x6b9)](_0x3b1411=>'-\x20'+_0x3b1411[_0xb8eb8c(0x92b)]+':\x20'+_0x3b1411[_0xb8eb8c(0xbc6)])[_0xb8eb8c(0xb2c)]('\x0a')+'\x0a\x0a'+_0x396d42+_0xb8eb8c(0xe3d)+_0x42fd39+_0xb8eb8c(0x8dd)+_0x4bd08e+_0xb8eb8c(0xf6a)+_0x2ec293+'\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a'+_0x550839+_0xb8eb8c(0xdda),_0x40b6d6=[{'role':'user','content':_0xb8eb8c(0x788)}];let _0xa8ca0e=_0x1a78ff[_0xb8eb8c(0x773)]('generativelanguage'),_0x2c7c66=_0x282b7e(_0xc888dd,_0x312d98,_0x42dc5c,_0x40b6d6);const _0x147b5e=_0xa8ca0e?await fetch(_0x2c7c66['url'],_0x2c7c66[_0xb8eb8c(0x49a)]):await fetch(_0x1a78ff+_0xb8eb8c(0x5c1),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0xb8eb8c(0xf42)+_0x312d98},'body':JSON[_0xb8eb8c(0x1175)]({'model':_0xc888dd,'messages':[{'role':_0xb8eb8c(0x46c),'content':_0x42dc5c},..._0x40b6d6],'temperature':_0x405767[_0xb8eb8c(0xb73)]['apiTemperature']||0x1})});if(!_0x147b5e['ok'])throw new Error(_0xb8eb8c(0xd83)+_0x147b5e['statusText']);const _0x452547=await _0x147b5e[_0xb8eb8c(0x7e9)](),_0x4a7bd2=getGeminiResponseText(_0x452547),_0x2b60f7=_0x4a7bd2[_0xb8eb8c(0x1b7)](/^```json\s*/,'')[_0xb8eb8c(0x1b7)](/```$/,''),_0x3ba44b=JSON['parse'](_0x2b60f7);Array[_0xb8eb8c(0xb85)](_0x3ba44b)&&_0x3ba44b[_0xb8eb8c(0x105a)]>0x0&&(_0x3c42f5[_0xb8eb8c(0x93c)][_0xb8eb8c(0xa49)](..._0x3ba44b),_0x3c42f5[_0xb8eb8c(0x713)]+=_0x3ba44b['length'],await _0x15043e['doubanPosts']['put'](_0x3c42f5)),await _0x4d304b(_0x1b0f46),_0x2c84fc();}catch(_0x194f68){console[_0xb8eb8c(0x7a3)]('等待回复失败:',_0x194f68),await _0x501c7b(_0xb8eb8c(0xa85),_0xb8eb8c(0xf16)+_0x194f68[_0xb8eb8c(0xc7d)]);}}async function _0x4b104e(){const _0x3527c0=_0x18b51e,_0x3bb5c5=document[_0x3527c0(0x8c2)]('douban-cast-modal'),_0x584873=document['getElementById'](_0x3527c0(0x8ea));_0x584873['innerHTML']='';const _0x59982b=Object[_0x3527c0(0x22f)](_0x405767[_0x3527c0(0x799)])[_0x3527c0(0x1d8)](_0x2646a9=>!_0x2646a9['isGroup']),_0xbd2050=new Set(_0x405767[_0x3527c0(0xb73)][_0x3527c0(0x460)]||[]);_0x59982b[_0x3527c0(0x105a)]===0x0?_0x584873['innerHTML']='<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>':_0x59982b[_0x3527c0(0x7c0)](_0x123c2d=>{const _0xae8312=_0x3527c0,_0x1d17e7=document['createElement'](_0xae8312(0x1072));_0x1d17e7['className']=_0xae8312(0xc25),_0x1d17e7[_0xae8312(0xca0)]=_0xae8312(0x848)+_0x123c2d['id']+'\x22\x20'+(_0xbd2050['has'](_0x123c2d['id'])?_0xae8312(0x75f):'')+'\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x123c2d['settings'][_0xae8312(0x44e)]||_0x49d2a4)+_0xae8312(0x29e)+_0x123c2d['name']+_0xae8312(0xee1),_0x584873[_0xae8312(0x31e)](_0x1d17e7);}),_0x3bb5c5['classList'][_0x3527c0(0x3f4)]('visible');}async function _0xeaf7d0(){const _0xf8cd4f=_0x18b51e,_0x33a82c=document[_0xf8cd4f(0xa2d)]('#douban-cast-list\x20.douban-cast-checkbox:checked'),_0xf389b2=Array[_0xf8cd4f(0x51a)](_0x33a82c)[_0xf8cd4f(0x6b9)](_0x5e90fa=>_0x5e90fa[_0xf8cd4f(0x323)][_0xf8cd4f(0xb3d)]);_0x405767['globalSettings']['doubanActiveCharacterIds']=_0xf389b2,await _0x15043e[_0xf8cd4f(0xb73)]['put'](_0x405767['globalSettings']),document[_0xf8cd4f(0x8c2)](_0xf8cd4f(0x1043))['classList'][_0xf8cd4f(0xaff)](_0xf8cd4f(0x2cd)),await _0x53a131();}document['getElementById'](_0x18b51e(0x1144))[_0x18b51e(0xae8)]('click',_0x4b104e),document[_0x18b51e(0x8c2)]('cancel-douban-cast-btn')[_0x18b51e(0xae8)](_0x18b51e(0xa17),()=>{const _0x23104a=_0x18b51e;document[_0x23104a(0x8c2)](_0x23104a(0x1043))[_0x23104a(0xb17)]['remove'](_0x23104a(0x2cd));}),document[_0x18b51e(0x8c2)](_0x18b51e(0x9a8))[_0x18b51e(0xae8)](_0x18b51e(0xa17),_0xeaf7d0),document[_0x18b51e(0x8c2)](_0x18b51e(0x8ea))[_0x18b51e(0xae8)](_0x18b51e(0xa17),_0x391e28=>{const _0x54483f=_0x18b51e,_0x5e8e77=_0x391e28[_0x54483f(0x475)][_0x54483f(0xa90)](_0x54483f(0xfbd));if(_0x5e8e77){const _0x1c5173=_0x5e8e77[_0x54483f(0x1ad)](_0x54483f(0x636));_0x1c5173&&_0x391e28[_0x54483f(0x475)]!==_0x1c5173&&(_0x1c5173[_0x54483f(0x75f)]=!_0x1c5173['checked']);}});async function _0x28773c(_0x1a6708){const _0x46efd3=_0x18b51e;if(!_0x1a6708)return;const _0x347dce=await _0x8b9cb8(_0x46efd3(0xc12),_0x46efd3(0x7d1),{'confirmText':'确认导入'});if(!_0x347dce)return;try{const _0xff9512=await _0x1a6708[_0x46efd3(0xbc6)](),_0x3c27b0=JSON['parse'](_0xff9512);if(!_0x3c27b0[_0x46efd3(0xc3a)]&&!_0x3c27b0[_0x46efd3(0x653)]&&!_0x3c27b0[_0x46efd3(0x18d)])throw new Error('文件格式不正确，缺少关键的外观设置项。');Object[_0x46efd3(0xc28)](_0x405767['globalSettings'],_0x3c27b0),await _0x15043e['globalSettings'][_0x46efd3(0xfaa)](_0x405767[_0x46efd3(0xb73)]),_0x1017e4(),_0x5f1ba2(),_0x1ff3cc(),_0xf3d9cb(),_0x3b4393(_0x405767['globalSettings']['globalCss']),_0x218332(_0x405767[_0x46efd3(0xb73)][_0x46efd3(0xa3a)]),_0x48f995(),_0x1a0ab7(),_0x519e14(),await _0x501c7b('导入成功',_0x46efd3(0xb36));}catch(_0x4c3548){console[_0x46efd3(0x7a3)](_0x46efd3(0xc56),_0x4c3548),await _0x501c7b(_0x46efd3(0x8e8),'文件解析或应用失败:\x20'+_0x4c3548['message']);}}async function _0x41c769(_0x24d725){const _0x4b7151=_0x18b51e;console[_0x4b7151(0x32b)](_0x4b7151(0x105e)+_0x24d725[_0x4b7151(0x3c1)](0x1)+_0x4b7151(0x823));const _0x5671da=Object[_0x4b7151(0x22f)](_0x405767['chats'])[_0x4b7151(0x1d8)](_0x2c08c9=>!_0x2c08c9[_0x4b7151(0x1000)]&&_0x2c08c9[_0x4b7151(0x33a)][_0x4b7151(0x105d)]&&_0x2c08c9[_0x4b7151(0x944)]?.[_0x4b7151(0x8c8)]===_0x4b7151(0xaa7));if(_0x5671da[_0x4b7151(0x105a)]===0x0){console[_0x4b7151(0x32b)](_0x4b7151(0x2c0));return;}for(const _0x179f1f of _0x5671da){const _0x2fe65b=_0x179f1f[_0x4b7151(0x33a)]['actionCooldownMinutes']||0xf,_0x304e11=_0x179f1f[_0x4b7151(0x6c9)]?(Date[_0x4b7151(0x1ed)]()-_0x179f1f[_0x4b7151(0x6c9)])/(0x3e8*0x3c):Infinity;_0x24d725>_0x2fe65b&&_0x304e11>_0x2fe65b&&(Math[_0x4b7151(0x5b3)]()<0.3&&(console[_0x4b7151(0x32b)](_0x4b7151(0x10a8)+_0x179f1f['name']+_0x4b7151(0x1174)),Math['random']()<0.7?await _0x197f43(_0x179f1f['id']):console['log'](_0x4b7151(0x10a8)+_0x179f1f[_0x4b7151(0x596)]+_0x4b7151(0x9d3))));}}function _0x240acd(){const _0x22b920=_0x18b51e;if(!_0x405767[_0x22b920(0x248)])return;const _0x55d3c1=_0x405767[_0x22b920(0x799)][_0x405767[_0x22b920(0x248)]];document[_0x22b920(0x8c2)](_0x22b920(0xa1f))['value']='',document[_0x22b920(0x8c2)]('date-search-input')[_0x22b920(0x518)]='',document['getElementById'](_0x22b920(0xc78))[_0x22b920(0xca0)]=_0x22b920(0x1e2),_0x3d1990(_0x22b920(0xf4a));}async function _0x204a43(){const _0x5b74c9=_0x18b51e,_0x317e6a=_0x405767[_0x5b74c9(0x799)][_0x405767[_0x5b74c9(0x248)]];if(!_0x317e6a)return;const _0x2b8960=document[_0x5b74c9(0x8c2)](_0x5b74c9(0xa1f))[_0x5b74c9(0x518)][_0x5b74c9(0x8c6)]()[_0x5b74c9(0xab8)](),_0x7fa396=document[_0x5b74c9(0x8c2)]('date-search-input')[_0x5b74c9(0x518)];if(!_0x2b8960&&!_0x7fa396){alert(_0x5b74c9(0x661));return;}let _0x5bf796=_0x317e6a[_0x5b74c9(0xd39)]['filter'](_0x2ba511=>!_0x2ba511[_0x5b74c9(0x3f1)]);_0x2b8960&&(_0x5bf796=_0x5bf796[_0x5b74c9(0x1d8)](_0x42bc32=>{const _0x4109f4=_0x5b74c9;let _0x2b6118='';if(typeof _0x42bc32['content']===_0x4109f4(0xf1b))_0x2b6118=_0x42bc32[_0x4109f4(0x168)];else{if(_0x42bc32['type']==='voice_message')_0x2b6118=_0x42bc32[_0x4109f4(0x168)];else{if(_0x42bc32['type']===_0x4109f4(0x7c8)||_0x42bc32['type']===_0x4109f4(0x223))_0x2b6118=_0x42bc32['content'];else{if(_0x42bc32[_0x4109f4(0xde0)]===_0x4109f4(0xaac))_0x2b6118=(_0x42bc32[_0x4109f4(0x1028)]||'')+'\x20'+(_0x42bc32[_0x4109f4(0x3ca)]||'');else _0x42bc32[_0x4109f4(0x9d2)]&&(_0x2b6118=_0x42bc32[_0x4109f4(0x168)]);}}}return _0x2b6118[_0x4109f4(0xab8)]()[_0x4109f4(0x773)](_0x2b8960);}));if(_0x7fa396){const _0xcf6cd=new Date(_0x7fa396),_0x68a5dd=new Date(_0xcf6cd['setHours'](0x0,0x0,0x0,0x0))[_0x5b74c9(0x610)](),_0x449150=new Date(_0xcf6cd[_0x5b74c9(0x7bb)](0x17,0x3b,0x3b,0x3e7))[_0x5b74c9(0x610)]();_0x5bf796=_0x5bf796[_0x5b74c9(0x1d8)](_0x1c9349=>_0x1c9349[_0x5b74c9(0x351)]>=_0x68a5dd&&_0x1c9349[_0x5b74c9(0x351)]<=_0x449150);}await _0x746c1(_0x5bf796);}async function _0x746c1(_0x3ed353){const _0x5e3d3e=_0x18b51e,_0x204056=document[_0x5e3d3e(0x8c2)](_0x5e3d3e(0xc78)),_0x547670=_0x405767['chats'][_0x405767[_0x5e3d3e(0x248)]];_0x204056[_0x5e3d3e(0xca0)]='';if(_0x3ed353[_0x5e3d3e(0x105a)]===0x0){_0x204056[_0x5e3d3e(0xca0)]=_0x5e3d3e(0x449);return;}let _0x49816d='';for(const _0x284a30 of _0x3ed353){const _0x533c71=new Date(_0x284a30[_0x5e3d3e(0x351)]),_0xbd03f6=_0x533c71['toLocaleDateString']();if(_0xbd03f6!==_0x49816d){const _0x6518d8=document[_0x5e3d3e(0x8c1)](_0x5e3d3e(0x1072));_0x6518d8['className']=_0x5e3d3e(0x94c),_0x6518d8[_0x5e3d3e(0x1090)]='---\x20'+_0x533c71[_0x5e3d3e(0x864)]()+'年'+(_0x533c71[_0x5e3d3e(0xc3c)]()+0x1)+'月'+_0x533c71[_0x5e3d3e(0xca8)]()+_0x5e3d3e(0xba2),_0x204056[_0x5e3d3e(0x31e)](_0x6518d8),_0x49816d=_0xbd03f6;}const _0x728cfa=await _0x3cd22d(_0x284a30,_0x547670);_0x728cfa&&(_0x728cfa[_0x5e3d3e(0x842)][_0x5e3d3e(0x658)]=_0x5e3d3e(0x630),_0x728cfa[_0x5e3d3e(0xae8)](_0x5e3d3e(0xa17),()=>_0x50e736(_0x284a30[_0x5e3d3e(0x351)])),_0x204056[_0x5e3d3e(0x31e)](_0x728cfa));}}async function _0x50e736(_0x36680c){const _0x286643=_0x18b51e,_0x469dc1=_0x405767[_0x286643(0x248)];if(!_0x469dc1)return;_0x3d1990(_0x286643(0xd5c)),setTimeout(async()=>{const _0x438d38=_0x286643,_0x45948c=document['getElementById'](_0x438d38(0xb24)),_0x137dc6=_0x438d38(0x4a4)+_0x36680c+'\x22]';let _0x429e8f=_0x45948c[_0x438d38(0x1ad)](_0x137dc6),_0x51f9c5=0x0;const _0x58ea12=0x14;while(!_0x429e8f&&_0x51f9c5<_0x58ea12){const _0x331322=document[_0x438d38(0x8c2)]('load-more-btn');if(_0x331322)console[_0x438d38(0x32b)](_0x438d38(0x1269)+(_0x51f9c5+0x1)+')'),await _0x18e095(),_0x429e8f=_0x45948c[_0x438d38(0x1ad)](_0x137dc6),_0x51f9c5++;else break;}_0x2a883c(_0x36680c);},0xc8);}async function _0x2bff97(){const _0x24985e=_0x18b51e;document['getElementById'](_0x24985e(0xa1f))[_0x24985e(0x518)]='',document[_0x24985e(0x8c2)](_0x24985e(0xb5a))[_0x24985e(0x518)]='',await _0x746c1(_0x405767[_0x24985e(0x799)][_0x405767[_0x24985e(0x248)]][_0x24985e(0xd39)][_0x24985e(0x1d8)](_0x56055b=>!_0x56055b[_0x24985e(0x3f1)]));}async function _0x515f1c(_0x2f682b=![],_0x19ffe6=null,_0x489fa3=null){const _0x25da1b=_0x18b51e,_0x29f6a0=document[_0x25da1b(0x8c2)]('ai-frame-grid'),_0x285f6a=document[_0x25da1b(0x8c2)](_0x25da1b(0x766)),_0x31f95b=_0x405767[_0x25da1b(0x799)][_0x405767[_0x25da1b(0x248)]];_0x29f6a0[_0x25da1b(0xca0)]='',_0x285f6a[_0x25da1b(0xca0)]='';const _0x568f14=await _0x15043e[_0x25da1b(0x103e)][_0x25da1b(0x6be)](),_0x49160a=[..._0x469d4b,..._0x568f14];document[_0x25da1b(0x1ad)](_0x25da1b(0x347))['style'][_0x25da1b(0x5e9)]=_0x2f682b?_0x25da1b(0xbf8):_0x25da1b(0xd52),document['getElementById']('ai-frame-content')[_0x25da1b(0x842)]['display']=_0x25da1b(0xea7),document['getElementById'](_0x25da1b(0xec1))['style'][_0x25da1b(0x5e9)]=_0x25da1b(0xbf8),document[_0x25da1b(0x8c2)](_0x25da1b(0x903))[_0x25da1b(0xb17)][_0x25da1b(0x3f4)](_0x25da1b(0x71b)),document[_0x25da1b(0x8c2)](_0x25da1b(0x1119))['classList'][_0x25da1b(0xaff)](_0x25da1b(0x71b));if(_0x2f682b)_0x49160a[_0x25da1b(0x7c0)](_0x382c35=>{const _0x4a2456=_0x25da1b,_0x30e361=_0x3d3174(_0x382c35,'my',_0x19ffe6);_0x382c35[_0x4a2456(0x9d6)]===_0x489fa3&&_0x30e361['classList'][_0x4a2456(0x3f4)](_0x4a2456(0x118f)),_0x29f6a0[_0x4a2456(0x31e)](_0x30e361);});else{const _0x4c57fa=_0x31f95b['settings'][_0x25da1b(0x44e)]||_0x49d2a4,_0x5aa21d=_0x31f95b['settings'][_0x25da1b(0x11ed)]||(_0x31f95b[_0x25da1b(0x1000)]?_0x38e728:_0x49d2a4);_0x49160a[_0x25da1b(0x7c0)](_0x5d5a0a=>{const _0x5c21a7=_0x25da1b,_0x5ac278=_0x3d3174(_0x5d5a0a,'ai',_0x4c57fa);if(_0x5d5a0a['url']===_0x4c9544['ai'])_0x5ac278[_0x5c21a7(0xb17)][_0x5c21a7(0x3f4)]('selected');_0x29f6a0[_0x5c21a7(0x31e)](_0x5ac278);const _0x800f23=_0x3d3174(_0x5d5a0a,'my',_0x5aa21d);if(_0x5d5a0a['url']===_0x4c9544['my'])_0x800f23[_0x5c21a7(0xb17)]['add']('selected');_0x285f6a[_0x5c21a7(0x31e)](_0x800f23);});}}function _0x3d3174(_0xfbf969,_0xe8ad9a,_0x2fb6ea){const _0x4b5308=_0x18b51e,_0x2bcbeb=document['createElement'](_0x4b5308(0x1072));_0x2bcbeb['className']=_0x4b5308(0x119a),_0x2bcbeb[_0x4b5308(0x323)]['frameUrl']=_0xfbf969[_0x4b5308(0x9d6)],_0x2bcbeb[_0x4b5308(0xcea)]=_0xfbf969['name'];const _0x15a7d1=typeof _0xfbf969['id']===_0x4b5308(0xdd0),_0x198f49=_0x15a7d1?'<button\x20class=\x22delete-btn\x22\x20data-id=\x22'+_0xfbf969['id']+_0x4b5308(0xc52):'';return _0x2bcbeb['innerHTML']=_0x4b5308(0x1022)+_0x198f49+_0x4b5308(0xefe)+_0x2fb6ea+_0x4b5308(0x1277)+(_0xfbf969[_0x4b5308(0x9d6)]?_0x4b5308(0x333)+_0xfbf969['url']+'\x22\x20class=\x22preview-frame\x22>':'')+_0x4b5308(0xd48),_0x2bcbeb[_0x4b5308(0xae8)](_0x4b5308(0xa17),_0x232449=>{const _0x13ea12=_0x4b5308;if(_0x232449['target']['classList'][_0x13ea12(0x795)]('delete-btn'))return;if(_0x1ac766){if(_0x15a7d1){const _0x29a538=parseInt(_0xfbf969['id']);_0x2bcbeb[_0x13ea12(0xb17)][_0x13ea12(0xfc3)]('selected'),_0xe92b02[_0x13ea12(0x11ac)](_0x29a538)?_0xe92b02[_0x13ea12(0x89f)](_0x29a538):_0xe92b02['add'](_0x29a538),_0x876e6f();}}else{_0x4c9544[_0xe8ad9a]=_0xfbf969[_0x13ea12(0x9d6)];const _0x4a51f6=_0xe8ad9a==='ai'?document[_0x13ea12(0x8c2)](_0x13ea12(0x352)):document[_0x13ea12(0x8c2)]('my-frame-grid');_0x4a51f6[_0x13ea12(0xa2d)](_0x13ea12(0xdd4))[_0x13ea12(0x7c0)](_0x15507a=>_0x15507a['classList'][_0x13ea12(0xaff)](_0x13ea12(0x118f))),_0x2bcbeb['classList']['add'](_0x13ea12(0x118f));}}),_0x2bcbeb;}async function _0x56ebd7(){const _0x2b1a17=_0x18b51e,_0x51fe95=document[_0x2b1a17(0x8c2)](_0x2b1a17(0x4c2)),_0x1faec8=await new Promise(_0xc10ba4=>{const _0x43218b=_0x2b1a17,_0x42c6e5=_0x1d102c=>{const _0x2644d8=_0x7a65;_0xc10ba4(_0x1d102c['target'][_0x2644d8(0xde8)][0x0]||null),_0x51fe95[_0x2644d8(0x2b2)]('change',_0x42c6e5);};_0x51fe95[_0x43218b(0xae8)](_0x43218b(0x7a7),_0x42c6e5,{'once':!![]}),_0x51fe95[_0x43218b(0xa17)]();});if(!_0x1faec8)return;const _0x48bce8=await _0x180f74('命名头像框','请为这个新头像框起个名字');if(!_0x48bce8||!_0x48bce8[_0x2b1a17(0x8c6)]())return;const _0x426cad=await new Promise(_0xa307e3=>{const _0x53827f=_0x2b1a17,_0x3ef84e=new FileReader();_0x3ef84e[_0x53827f(0xe7a)]=()=>_0xa307e3(_0x3ef84e[_0x53827f(0xa92)]),_0x3ef84e[_0x53827f(0x779)](_0x1faec8);});await _0x15043e['customAvatarFrames'][_0x2b1a17(0x3f4)]({'name':_0x48bce8['trim'](),'url':_0x426cad}),_0x515f1c(_0x309580);}async function _0x2e498a(){const _0x5c1899=_0x18b51e,_0x380d7f='请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif',_0x1257e4=await _0x180f74(_0x5c1899(0x1046),_0x5c1899(0x36d),'',_0x5c1899(0x6c3),_0x5c1899(0x1d7)+_0x380d7f+_0x5c1899(0x2e7));if(!_0x1257e4||!_0x1257e4[_0x5c1899(0x8c6)]())return;const _0x538048=_0x1257e4['trim']()[_0x5c1899(0x111f)]('\x0a'),_0x26d345=[];let _0x50d675=0x0;for(const _0x4d762d of _0x538048){const _0x3ad3fc=_0x4d762d[_0x5c1899(0xdf8)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x3ad3fc)_0x26d345[_0x5c1899(0xa49)]({'name':_0x3ad3fc[0x1]['trim'](),'url':_0x3ad3fc[0x2][_0x5c1899(0x8c6)]()});else _0x4d762d[_0x5c1899(0x8c6)]()&&_0x50d675++;}_0x26d345[_0x5c1899(0x105a)]>0x0&&(await _0x15043e[_0x5c1899(0x103e)]['bulkAdd'](_0x26d345),_0x515f1c(_0x309580),await _0x501c7b(_0x5c1899(0x95b),'成功导入\x20'+_0x26d345[_0x5c1899(0x105a)]+'\x20个新头像框！')),_0x50d675>0x0&&await _0x501c7b('部分失败','有\x20'+_0x50d675+_0x5c1899(0x111c));}async function _0x4e5646(_0x3b50c0){const _0x4dc56c=_0x18b51e,_0x8115be=await _0x15043e[_0x4dc56c(0x103e)]['get'](_0x3b50c0);if(!_0x8115be)return;const _0x1d9371=await _0x8b9cb8('确认删除','确定要删除头像框\x20“'+_0x8115be['name']+_0x4dc56c(0x119f),{'confirmButtonClass':'btn-danger'});_0x1d9371&&(await _0x15043e[_0x4dc56c(0x103e)][_0x4dc56c(0x89f)](_0x3b50c0),_0x515f1c(_0x309580));}let _0x3831df=0x0;const _0x47f8a6=0x2;function _0x271118(){const _0x5f38ec=_0x18b51e,_0x169ef5=document[_0x5f38ec(0x8c2)](_0x5f38ec(0xd8b)),_0x15c3de=document['getElementById']('home-screen-pages'),_0x100687=document['querySelectorAll'](_0x5f38ec(0xfc9));let _0x5cf5f9=0x0,_0x14d012=0x0,_0x53b511=0x0,_0x5137d4=![],_0x1d311d=!![];const _0x12ba51=()=>{const _0xc59a58=_0x5f38ec;_0x15c3de[_0xc59a58(0x842)]['transform']='translateX(-'+_0x3831df*(0x64/_0x47f8a6)+'%)',_0x100687[_0xc59a58(0x7c0)]((_0x49a130,_0x1e4ffa)=>{const _0x154666=_0xc59a58;_0x49a130['classList'][_0x154666(0xfc3)](_0x154666(0x71b),_0x1e4ffa===_0x3831df);});},_0x2ebcfe=_0x50df96=>{const _0x2c5986=_0x5f38ec;_0x5137d4=!![],_0x1d311d=!![],_0x5cf5f9=_0x50df96[_0x2c5986(0xde0)][_0x2c5986(0x773)](_0x2c5986(0xfa2))?_0x50df96['pageX']:_0x50df96[_0x2c5986(0x474)][0x0][_0x2c5986(0xb2f)],_0x14d012=_0x50df96[_0x2c5986(0xde0)][_0x2c5986(0x773)](_0x2c5986(0xfa2))?_0x50df96[_0x2c5986(0x5bb)]:_0x50df96[_0x2c5986(0x474)][0x0]['pageY'],_0x15c3de[_0x2c5986(0x842)][_0x2c5986(0x1f8)]='none';},_0xf9cf9d=_0x5524a4=>{const _0x5899c8=_0x5f38ec;if(!_0x5137d4)return;const _0x1b8b25=_0x5524a4[_0x5899c8(0xde0)][_0x5899c8(0x773)]('mouse')?_0x5524a4[_0x5899c8(0x5bb)]:_0x5524a4[_0x5899c8(0x474)][0x0][_0x5899c8(0x5bb)];_0x53b511=_0x5524a4['type'][_0x5899c8(0x773)](_0x5899c8(0xfa2))?_0x5524a4[_0x5899c8(0xb2f)]:_0x5524a4[_0x5899c8(0x474)][0x0]['pageX'];const _0x7c4d0=_0x53b511-_0x5cf5f9,_0x3d12f6=_0x1b8b25-_0x14d012;_0x1d311d&&(Math[_0x5899c8(0x10a3)](_0x7c4d0)>0xa||Math['abs'](_0x3d12f6)>0xa)&&(_0x1d311d=![]);if(Math[_0x5899c8(0x10a3)](_0x7c4d0)>Math['abs'](_0x3d12f6)){if(_0x5524a4[_0x5899c8(0x42f)])_0x5524a4[_0x5899c8(0xd35)]();_0x15c3de[_0x5899c8(0x842)][_0x5899c8(0xb56)]='translateX(calc(-'+_0x3831df*(0x64/_0x47f8a6)+_0x5899c8(0xd37)+_0x7c4d0+_0x5899c8(0x118d);}},_0x4fc6fd=_0xcdad2=>{const _0x340a83=_0x5f38ec;if(!_0x5137d4)return;_0x5137d4=![],_0x15c3de[_0x340a83(0x842)]['transition']='transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)';if(_0x1d311d){_0x12ba51();return;}const _0xbb54be=_0x53b511-_0x5cf5f9;if(Math[_0x340a83(0x10a3)](_0xbb54be)>_0x169ef5[_0x340a83(0x6f8)]/0x4){if(_0xbb54be>0x0&&_0x3831df>0x0)_0x3831df--;else _0xbb54be<0x0&&_0x3831df<_0x47f8a6-0x1&&_0x3831df++;}_0x12ba51();};_0x169ef5['addEventListener'](_0x5f38ec(0x5d5),_0x2ebcfe),_0x169ef5[_0x5f38ec(0xae8)](_0x5f38ec(0x6c1),_0xf9cf9d),_0x169ef5['addEventListener'](_0x5f38ec(0x72c),_0x4fc6fd),_0x169ef5[_0x5f38ec(0xae8)](_0x5f38ec(0xd92),_0x4fc6fd),_0x169ef5[_0x5f38ec(0xae8)](_0x5f38ec(0x3e0),_0x2ebcfe,{'passive':![]}),_0x169ef5[_0x5f38ec(0xae8)](_0x5f38ec(0x4c1),_0xf9cf9d,{'passive':![]}),_0x169ef5[_0x5f38ec(0xae8)]('touchend',_0x4fc6fd);}let _0x81ab90=null;async function _0x59f21b(){await _0x26ef07(),_0x3d1990('preset-screen');}async function _0x26ef07(){const _0x3c15b2=_0x18b51e,_0x3487cf=document[_0x3c15b2(0x8c2)](_0x3c15b2(0x20e)),_0x466945=document[_0x3c15b2(0x8c2)](_0x3c15b2(0x5a2));_0x3487cf[_0x3c15b2(0xca0)]='',_0x466945[_0x3c15b2(0xca0)]='';const [_0x262e30,_0x3dfb6e]=await Promise[_0x3c15b2(0xe88)]([_0x15043e[_0x3c15b2(0xeb2)]['toArray'](),_0x15043e['presetCategories'][_0x3c15b2(0x731)](_0x3c15b2(0x596))[_0x3c15b2(0x6be)]()]);_0x405767['presets']=_0x262e30;if(_0x262e30[_0x3c15b2(0x105a)]===0x0){_0x466945[_0x3c15b2(0xca0)]=_0x3c15b2(0x22c);return;}const _0x3ccb4a=document[_0x3c15b2(0x8c1)](_0x3c15b2(0x19a));_0x3ccb4a[_0x3c15b2(0x84c)]=_0x3c15b2(0xc4c),_0x3ccb4a[_0x3c15b2(0x1090)]='全部',_0x3ccb4a[_0x3c15b2(0x323)][_0x3c15b2(0x792)]='all',_0x3487cf[_0x3c15b2(0x31e)](_0x3ccb4a);const _0x3e5f91=document[_0x3c15b2(0x8c1)](_0x3c15b2(0x1072));_0x3e5f91[_0x3c15b2(0x84c)]=_0x3c15b2(0x1074),_0x3e5f91['dataset']['categoryId']=_0x3c15b2(0xe88),_0x466945[_0x3c15b2(0x31e)](_0x3e5f91),_0x3dfb6e['forEach'](_0x1b3054=>{const _0x765a43=_0x3c15b2,_0xa1c88c=document[_0x765a43(0x8c1)](_0x765a43(0x19a));_0xa1c88c['className']=_0x765a43(0x428),_0xa1c88c[_0x765a43(0x1090)]=_0x1b3054['name'],_0xa1c88c[_0x765a43(0x323)][_0x765a43(0x792)]=String(_0x1b3054['id']),_0x3487cf[_0x765a43(0x31e)](_0xa1c88c);const _0x5299b9=document[_0x765a43(0x8c1)](_0x765a43(0x1072));_0x5299b9['className']=_0x765a43(0x44a),_0x5299b9[_0x765a43(0x323)][_0x765a43(0x792)]=String(_0x1b3054['id']),_0x466945['appendChild'](_0x5299b9);});const _0xb6a4b4=_0x262e30['some'](_0x2fc64e=>!_0x2fc64e[_0x3c15b2(0x792)]);if(_0xb6a4b4){const _0x331e71=document[_0x3c15b2(0x8c1)](_0x3c15b2(0x19a));_0x331e71[_0x3c15b2(0x84c)]='world-book-tab',_0x331e71[_0x3c15b2(0x1090)]='未分类',_0x331e71[_0x3c15b2(0x323)][_0x3c15b2(0x792)]=_0x3c15b2(0x606),_0x3487cf['appendChild'](_0x331e71);const _0x18ea7f=document[_0x3c15b2(0x8c1)]('div');_0x18ea7f['className']='world-book-category-pane',_0x18ea7f[_0x3c15b2(0x323)][_0x3c15b2(0x792)]='uncategorized',_0x466945['appendChild'](_0x18ea7f);}_0x262e30[_0x3c15b2(0x7c0)](_0x35e02a=>{const _0xbc81d1=_0x3c15b2,_0x31c2f9=_0xbc81d1(0x844)+_0x35e02a[_0xbc81d1(0x168)]['length']+_0xbc81d1(0x870),_0x5f2896=document[_0xbc81d1(0x8c1)](_0xbc81d1(0x1072));_0x5f2896[_0xbc81d1(0x84c)]=_0xbc81d1(0xd94),_0x5f2896[_0xbc81d1(0xca0)]=_0xbc81d1(0x1054)+_0x35e02a['name']+_0xbc81d1(0xf74)+_0x31c2f9+_0xbc81d1(0xe47);const _0x449790=()=>_0x3a691e(_0x35e02a['id']),_0x59a9b9=async()=>{const _0x23dae5=_0xbc81d1,_0x2689c2=await _0x8b9cb8(_0x23dae5(0x1c8),_0x23dae5(0xf99)+_0x35e02a[_0x23dae5(0x596)]+'》吗？',{'confirmButtonClass':_0x23dae5(0xe2a)});_0x2689c2&&(await _0x15043e[_0x23dae5(0xeb2)][_0x23dae5(0x89f)](_0x35e02a['id']),_0x405767[_0x23dae5(0xeb2)]=await _0x15043e[_0x23dae5(0xeb2)][_0x23dae5(0x6be)](),_0x26ef07());};_0x5f2896[_0xbc81d1(0xae8)](_0xbc81d1(0xa17),_0x449790),_0x5dcbd7(_0x5f2896,_0x59a9b9);const _0x473b99=_0x5f2896[_0xbc81d1(0xac5)](!![]);_0x473b99['addEventListener'](_0xbc81d1(0xa17),_0x449790),_0x5dcbd7(_0x473b99,_0x59a9b9),_0x3e5f91[_0xbc81d1(0x31e)](_0x473b99);const _0x1fccc2=_0x35e02a['categoryId']?String(_0x35e02a['categoryId']):_0xbc81d1(0x606),_0x399965=_0x466945[_0xbc81d1(0x1ad)](_0xbc81d1(0xfce)+_0x1fccc2+'\x22]');_0x399965&&_0x399965[_0xbc81d1(0x31e)](_0x5f2896);}),document['querySelectorAll'](_0x3c15b2(0xb50))[_0x3c15b2(0x7c0)](_0x597805=>{const _0x391861=_0x3c15b2;_0x597805[_0x391861(0xae8)](_0x391861(0xa17),()=>_0x111015(_0x597805[_0x391861(0x323)][_0x391861(0x792)]));});}function _0x111015(_0x2dfce4){const _0x54c993=_0x18b51e;document['querySelectorAll'](_0x54c993(0xb50))[_0x54c993(0x7c0)](_0x3bb8ed=>{const _0x4085e7=_0x54c993;_0x3bb8ed[_0x4085e7(0xb17)][_0x4085e7(0xfc3)](_0x4085e7(0x71b),_0x3bb8ed[_0x4085e7(0x323)][_0x4085e7(0x792)]===_0x2dfce4);}),document[_0x54c993(0xa2d)](_0x54c993(0xa30))['forEach'](_0x124195=>{const _0x1ed038=_0x54c993;_0x124195[_0x1ed038(0xb17)][_0x1ed038(0xfc3)]('active',_0x124195[_0x1ed038(0x323)][_0x1ed038(0x792)]===_0x2dfce4);});}async function _0x3a691e(_0x3d840e){const _0x46f362=_0x18b51e;_0x3d1990(_0x46f362(0xf75)),_0x81ab90=_0x3d840e;try{const [_0x44b94e,_0x5b0c39]=await Promise[_0x46f362(0xe88)]([_0x15043e[_0x46f362(0xeb2)][_0x46f362(0x3e9)](_0x3d840e),_0x15043e[_0x46f362(0x31a)]['toArray']()]);if(!_0x44b94e){console[_0x46f362(0x7a3)]('错误：尝试打开一个不存在的预设，ID:',_0x3d840e),await _0x501c7b('加载失败',_0x46f362(0x81b)),_0x3d1990(_0x46f362(0x457));return;}setTimeout(()=>{const _0x556b84=_0x46f362;document[_0x556b84(0x8c2)](_0x556b84(0x73a))['textContent']=_0x44b94e['name'],document['getElementById']('preset-name-input')['value']=_0x44b94e[_0x556b84(0x596)];const _0x512908=document[_0x556b84(0x8c2)](_0x556b84(0x4d3));_0x512908[_0x556b84(0xca0)]=_0x556b84(0x594),_0x5b0c39[_0x556b84(0x7c0)](_0xab802=>{const _0x38363d=_0x556b84,_0x33e49f=document[_0x38363d(0x8c1)](_0x38363d(0x4f3));_0x33e49f[_0x38363d(0x518)]=_0xab802['id'],_0x33e49f['textContent']=_0xab802[_0x38363d(0x596)];if(_0x44b94e[_0x38363d(0x792)]===_0xab802['id'])_0x33e49f['selected']=!![];_0x512908[_0x38363d(0x31e)](_0x33e49f);});const _0x453f18=document[_0x556b84(0x8c2)](_0x556b84(0x43d));_0x453f18[_0x556b84(0xca0)]='',Array[_0x556b84(0xb85)](_0x44b94e[_0x556b84(0x168)])&&_0x44b94e[_0x556b84(0x168)][_0x556b84(0x105a)]>0x0?_0x44b94e[_0x556b84(0x168)]['forEach'](_0x44ee61=>{const _0x4ccf0d=_0x556b84,_0x1c0f10=_0x4cea7f(_0x44ee61);_0x453f18[_0x4ccf0d(0x31e)](_0x1c0f10);}):_0x453f18['innerHTML']=_0x556b84(0x1188);},0x32);}catch(_0x47cfbd){console[_0x46f362(0x7a3)](_0x46f362(0x4f8),_0x47cfbd),await _0x501c7b(_0x46f362(0x1272),_0x46f362(0xc5d)+_0x47cfbd[_0x46f362(0xc7d)]),_0x3d1990('preset-screen');}}function _0x4cea7f(_0x3b7e07={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x493cd8=_0x18b51e,_0x4c223c=document['createElement'](_0x493cd8(0x1072));_0x4c223c[_0x493cd8(0x84c)]=_0x493cd8(0x122b);const _0x44ce3a=_0x3b7e07[_0x493cd8(0x69a)]!==![]?'checked':'';_0x4c223c[_0x493cd8(0xca0)]=_0x493cd8(0xbb0)+_0x44ce3a+_0x493cd8(0xdcd)+(_0x3b7e07[_0x493cd8(0x120a)]||'')+_0x493cd8(0x8dc)+(_0x3b7e07[_0x493cd8(0xbda)]||[])[_0x493cd8(0xb2c)](',\x20')+_0x493cd8(0x1026)+(_0x3b7e07['content']||'')+_0x493cd8(0x1cd),_0x4c223c['querySelector'](_0x493cd8(0xedb))[_0x493cd8(0xae8)](_0x493cd8(0xa17),()=>_0x4c223c[_0x493cd8(0xaff)]());const _0x2f4456=_0x4c223c[_0x493cd8(0x1ad)](_0x493cd8(0x385)),_0x31ee23=_0x4c223c['querySelector'](_0x493cd8(0x9a0));return _0x2f4456[_0x493cd8(0xae8)](_0x493cd8(0xa17),()=>{const _0x3dc53d=_0x493cd8,_0x1d1c2e=_0x31ee23[_0x3dc53d(0x842)]['display']===_0x3dc53d(0xbf8);_0x31ee23['style'][_0x3dc53d(0x5e9)]=_0x1d1c2e?_0x3dc53d(0xea7):_0x3dc53d(0xbf8),_0x2f4456[_0x3dc53d(0x1090)]=_0x1d1c2e?'收起':'展开';}),_0x4c223c;}async function _0x32c9c8(){const _0xa8fbc8=_0x18b51e;await _0x57e5ce(),document['querySelector'](_0xa8fbc8(0xa65))[_0xa8fbc8(0x1090)]=_0xa8fbc8(0x418),document[_0xa8fbc8(0x8c2)](_0xa8fbc8(0xa0f))[_0xa8fbc8(0xcda)]=_0x425fab,document[_0xa8fbc8(0x8c2)](_0xa8fbc8(0xf06))['onclick']=_0x12a8e6=>{const _0x40c560=_0xa8fbc8;_0x12a8e6[_0x40c560(0x475)][_0x40c560(0xb17)][_0x40c560(0x795)]('delete-group-btn')&&_0x299dbd(parseInt(_0x12a8e6[_0x40c560(0x475)]['dataset']['id']));},document[_0xa8fbc8(0x8c2)](_0xa8fbc8(0x10cb))[_0xa8fbc8(0xcda)]=()=>{const _0x55dffd=_0xa8fbc8;document[_0x55dffd(0x8c2)](_0x55dffd(0x119c))[_0x55dffd(0xb17)][_0x55dffd(0xaff)](_0x55dffd(0x2cd)),_0x26ef07();},document['getElementById'](_0xa8fbc8(0x119c))[_0xa8fbc8(0xb17)]['add']('visible');}async function _0x57e5ce(){const _0x2438e6=_0x18b51e,_0x5a2042=document[_0x2438e6(0x8c2)]('existing-groups-list'),_0x3ec7bb=await _0x15043e['presetCategories']['toArray']();_0x5a2042['innerHTML']='',_0x3ec7bb['length']===0x0&&(_0x5a2042[_0x2438e6(0xca0)]=_0x2438e6(0xfa8)),_0x3ec7bb[_0x2438e6(0x7c0)](_0x17aa77=>{const _0x544ba5=_0x2438e6,_0xb882f=document[_0x544ba5(0x8c1)](_0x544ba5(0x1072));_0xb882f[_0x544ba5(0x84c)]=_0x544ba5(0x376),_0xb882f[_0x544ba5(0xca0)]=_0x544ba5(0x10d3)+_0x17aa77[_0x544ba5(0x596)]+_0x544ba5(0x378)+_0x17aa77['id']+_0x544ba5(0x1087),_0x5a2042['appendChild'](_0xb882f);});}async function _0x425fab(){const _0x29b46f=_0x18b51e,_0x3643f5=document['getElementById'](_0x29b46f(0xb1a)),_0x5a3264=_0x3643f5[_0x29b46f(0x518)][_0x29b46f(0x8c6)]();if(!_0x5a3264)return alert(_0x29b46f(0xc42));const _0x30999a=await _0x15043e[_0x29b46f(0x31a)][_0x29b46f(0xdb8)](_0x29b46f(0x596))[_0x29b46f(0xc9a)](_0x5a3264)['first']();if(_0x30999a)return alert(_0x29b46f(0xbb3)+_0x5a3264+_0x29b46f(0x32c));await _0x15043e[_0x29b46f(0x31a)][_0x29b46f(0x3f4)]({'name':_0x5a3264}),_0x3643f5[_0x29b46f(0x518)]='',await _0x57e5ce();}async function _0x299dbd(_0x404ef4){const _0x198c96=_0x18b51e,_0x132f20=await _0x8b9cb8('确认删除',_0x198c96(0x408),{'confirmButtonClass':'btn-danger'});_0x132f20&&(await _0x15043e['presetCategories'][_0x198c96(0x89f)](_0x404ef4),await _0x15043e[_0x198c96(0xeb2)]['where'](_0x198c96(0x792))['equals'](_0x404ef4)[_0x198c96(0x11d9)]({'categoryId':null}),_0x405767[_0x198c96(0xeb2)]=await _0x15043e[_0x198c96(0xeb2)][_0x198c96(0x6be)](),await _0x57e5ce());}async function _0x560b7b(_0x14f3f1){const _0x2b58bb=_0x18b51e,_0x2b96ac=_0x14f3f1['target'][_0x2b58bb(0xde8)][0x0];if(!_0x2b96ac)return;try{if(!_0x2b96ac[_0x2b58bb(0x596)][_0x2b58bb(0x866)]('.json'))throw new Error(_0x2b58bb(0x1a4));const _0x1b48a5=await _0x2b96ac[_0x2b58bb(0xbc6)](),_0x42781b=JSON[_0x2b58bb(0x10ab)](_0x1b48a5);await _0x151958(_0x42781b,_0x2b96ac[_0x2b58bb(0x596)]);}catch(_0x3ef6f9){console[_0x2b58bb(0x7a3)](_0x2b58bb(0xdcf),_0x3ef6f9),await _0x501c7b(_0x2b58bb(0x8e8),_0x2b58bb(0xb45)+_0x3ef6f9['message']);}finally{_0x14f3f1[_0x2b58bb(0x475)][_0x2b58bb(0x518)]=null;}}async function _0x151958(_0x269ee5,_0x41dcc4){const _0x456180=_0x18b51e;let _0xec490b=[];if(Array['isArray'](_0x269ee5[_0x456180(0x1067)])&&Array['isArray'](_0x269ee5[_0x456180(0x5b7)])&&_0x269ee5[_0x456180(0x5b7)][_0x456180(0x105a)]>0x0){console[_0x456180(0x32b)](_0x456180(0xb63));const _0x3465be=new Map(_0x269ee5[_0x456180(0x1067)][_0x456180(0x6b9)](_0x33f913=>[_0x33f913['identifier'],_0x33f913])),_0x2a395f=_0x269ee5[_0x456180(0x5b7)][_0x456180(0x29a)]((_0x63b9e3,_0x1266b2)=>_0x1266b2[_0x456180(0x358)]&&_0x1266b2[_0x456180(0x358)][_0x456180(0x105a)]>(_0x63b9e3[_0x456180(0x105a)]||0x0)?_0x1266b2[_0x456180(0x358)]:_0x63b9e3,[]);_0x2a395f&&_0x2a395f[_0x456180(0x105a)]>0x0&&(_0xec490b=_0x2a395f[_0x456180(0x6b9)](_0x1eafeb=>{const _0x4ac768=_0x456180,_0x267d51=_0x3465be[_0x4ac768(0x3e9)](_0x1eafeb[_0x4ac768(0xfd2)]);if(_0x267d51)return{'keys':[],'comment':_0x267d51['name']||_0x4ac768(0x1117),'content':_0x267d51['content']||'','enabled':_0x1eafeb[_0x4ac768(0x69a)]};return null;})[_0x456180(0x1d8)](Boolean));}else{if(_0x269ee5['entries']&&typeof _0x269ee5[_0x456180(0x6ff)]===_0x456180(0x7a5))console[_0x456180(0x32b)](_0x456180(0xcdb)),Array[_0x456180(0xb85)](_0x269ee5['order'])?(console[_0x456180(0x32b)](_0x456180(0xec8)),_0xec490b=_0x269ee5[_0x456180(0x358)][_0x456180(0x6b9)](_0x14f745=>_0x269ee5[_0x456180(0x6ff)][_0x14f745])[_0x456180(0x1d8)](Boolean)[_0x456180(0x6b9)](_0x59544b=>({'keys':_0x59544b[_0x456180(0xe29)]||[],'comment':_0x59544b['comment']||_0x456180(0x11db),'content':_0x59544b['content']||'','enabled':!_0x59544b[_0x456180(0x634)]}))):(console[_0x456180(0x112a)]('未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。'),_0xec490b=Object[_0x456180(0x22f)](_0x269ee5[_0x456180(0x6ff)])['map'](_0x890020=>({'keys':_0x890020['key']||[],'comment':_0x890020[_0x456180(0x120a)]||_0x456180(0x11db),'content':_0x890020['content']||'','enabled':!_0x890020[_0x456180(0x634)]})));else{if(Array[_0x456180(0xb85)](_0x269ee5[_0x456180(0x1067)]))console[_0x456180(0x32b)](_0x456180(0xaba)),_0xec490b=_0x269ee5[_0x456180(0x1067)][_0x456180(0x6b9)](_0x1a499f=>({'keys':[],'comment':_0x1a499f[_0x456180(0x596)]||_0x456180(0x1117),'content':_0x1a499f[_0x456180(0x168)]||'','enabled':!![]}));else throw new Error(_0x456180(0x86a));}}_0xec490b=_0xec490b[_0x456180(0x1d8)](_0x57eb80=>_0x57eb80[_0x456180(0x168)]);if(_0xec490b[_0x456180(0x105a)]===0x0){alert(_0x456180(0xf60));return;}const _0x3fade2=_0x41dcc4[_0x456180(0x1b7)](/\.json$/i,''),_0x3de2af=await _0x180f74('导入\x20Tavern\x20预设',_0x456180(0xe26),_0x3fade2);if(!_0x3de2af||!_0x3de2af[_0x456180(0x8c6)]()){alert('导入已取消，因为未提供名称。');return;}const _0x58ff82={'id':_0x456180(0x877)+Date[_0x456180(0x1ed)](),'name':_0x3de2af[_0x456180(0x8c6)](),'content':_0xec490b,'categoryId':null};await _0x15043e[_0x456180(0xeb2)]['add'](_0x58ff82),_0x405767[_0x456180(0xeb2)][_0x456180(0xa49)](_0x58ff82),await _0x26ef07(),await _0x501c7b(_0x456180(0x336),_0x456180(0xd1f)+_0x3de2af+'》。');}async function _0x2516b4(_0x52023b){const _0x377ac5=_0x18b51e,_0x21f900=document[_0x377ac5(0x8c2)](_0x377ac5(0xac3));if(!_0x21f900)return;const _0x3cedf2=_0x405767[_0x377ac5(0xeb2)]||[];_0x21f900[_0x377ac5(0xca0)]='<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>',_0x3cedf2['forEach'](_0x58e8c6=>{const _0x4e0b5c=_0x377ac5,_0x2371a0=document[_0x4e0b5c(0x8c1)](_0x4e0b5c(0x4f3));_0x2371a0[_0x4e0b5c(0x518)]=_0x58e8c6['id'],_0x2371a0[_0x4e0b5c(0x1090)]=_0x58e8c6[_0x4e0b5c(0x596)],_0x21f900['appendChild'](_0x2371a0);}),_0x52023b[_0x377ac5(0x33a)][_0x377ac5(0x2f7)]&&(_0x21f900[_0x377ac5(0x518)]=_0x52023b[_0x377ac5(0x33a)][_0x377ac5(0x2f7)]);}function _0x3c0a3b(){const _0x31f1d0=_0x18b51e,_0x549d41=document[_0x31f1d0(0x8c2)](_0x31f1d0(0x4d0));if(!_0x549d41)return;_0x549d41[_0x31f1d0(0xca0)]='';let _0x58c1c6=_0x405767['globalSettings'][_0x31f1d0(0x54e)]||_0x43fda0;_0x58c1c6['forEach'](_0x11ad6d=>{const _0xeec7c0=_0x31f1d0,_0x5b31c9=document[_0xeec7c0(0x8c2)](_0x11ad6d);if(_0x5b31c9){const _0x11b85d=document['createElement'](_0xeec7c0(0x1072));_0x11b85d[_0xeec7c0(0x84c)]=_0xeec7c0(0x424),_0x11b85d[_0xeec7c0(0xca3)]=!![],_0x11b85d[_0xeec7c0(0x323)][_0xeec7c0(0x7ca)]=_0x11ad6d,_0x11b85d['innerHTML']=_0x5b31c9[_0xeec7c0(0xca0)],_0x549d41['appendChild'](_0x11b85d);}});}function _0x5b2c2f(){const _0x4344b9=_0x18b51e,_0x18ac68=document['getElementById']('button-order-editor');if(!_0x18ac68)return;let _0x2e9b1b=null;const _0xafdf3d=_0x198a92=>{const _0x5d7ba6=_0x7a65,_0x7aaafc=_0x198a92[_0x5d7ba6(0x475)][_0x5d7ba6(0xa90)](_0x5d7ba6(0xd98));if(!_0x7aaafc)return;_0x2e9b1b=_0x7aaafc,_0x2e9b1b[_0x5d7ba6(0xb17)]['add'](_0x5d7ba6(0xb6d));if(_0x198a92['cancelable'])_0x198a92['preventDefault']();},_0x3d67ad=_0x2a96ae=>{const _0x32d60b=_0x7a65;if(!_0x2e9b1b)return;const _0x3b3a15=_0x2a96ae[_0x32d60b(0xde0)][_0x32d60b(0x773)](_0x32d60b(0xfa2))?_0x2a96ae[_0x32d60b(0x629)]:_0x2a96ae[_0x32d60b(0x474)][0x0][_0x32d60b(0x629)],_0x22116a=_0x57eede(_0x18ac68,_0x3b3a15);_0x22116a==null?_0x18ac68['appendChild'](_0x2e9b1b):_0x18ac68[_0x32d60b(0x1021)](_0x2e9b1b,_0x22116a);},_0x381e42=()=>{const _0x219b89=_0x7a65;if(!_0x2e9b1b)return;_0x2e9b1b['classList']['remove'](_0x219b89(0xb6d)),_0x2e9b1b=null,_0xf962e4();};_0x18ac68['addEventListener'](_0x4344b9(0x5d5),_0xafdf3d),_0x18ac68['addEventListener'](_0x4344b9(0x3e0),_0xafdf3d,{'passive':![]}),_0x18ac68[_0x4344b9(0xae8)](_0x4344b9(0x6c1),_0x3d67ad),_0x18ac68[_0x4344b9(0xae8)](_0x4344b9(0x4c1),_0x3d67ad,{'passive':![]}),_0x18ac68['addEventListener'](_0x4344b9(0x72c),_0x381e42),_0x18ac68[_0x4344b9(0xae8)]('mouseleave',_0x381e42),_0x18ac68['addEventListener']('touchend',_0x381e42);}function _0x57eede(_0x1d67f8,_0x115bb6){const _0x167be6=_0x18b51e,_0x2ce30=[..._0x1d67f8[_0x167be6(0xa2d)](_0x167be6(0x921))];return _0x2ce30['reduce']((_0x2a6173,_0x5b1979)=>{const _0x46916e=_0x167be6,_0x1098e5=_0x5b1979[_0x46916e(0xfe9)](),_0x50a199=_0x115bb6-_0x1098e5['left']-_0x1098e5[_0x46916e(0x578)]/0x2;return _0x50a199<0x0&&_0x50a199>_0x2a6173['offset']?{'offset':_0x50a199,'element':_0x5b1979}:_0x2a6173;},{'offset':Number['NEGATIVE_INFINITY']})['element'];}async function _0xf962e4(){const _0x44ace3=_0x18b51e,_0x3d992d=document[_0x44ace3(0x8c2)](_0x44ace3(0x4d0)),_0x2a0c0e=Array[_0x44ace3(0x51a)](_0x3d992d[_0x44ace3(0xa2d)](_0x44ace3(0xd98)))[_0x44ace3(0x6b9)](_0x437ea1=>_0x437ea1['dataset']['buttonId']);_0x405767['globalSettings'][_0x44ace3(0x54e)]=_0x2a0c0e,await _0x15043e[_0x44ace3(0xb73)][_0x44ace3(0xfaa)](_0x405767[_0x44ace3(0xb73)]);}function _0x249d78(){const _0x5aa9fd=_0x18b51e,_0x19ee37=_0x405767[_0x5aa9fd(0xb73)]['chatActionButtonsOrder'];if(!_0x19ee37||!Array[_0x5aa9fd(0xb85)](_0x19ee37)||_0x19ee37[_0x5aa9fd(0x105a)]===0x0)return;const _0x20ff34=document[_0x5aa9fd(0x8c2)]('chat-input-actions-top');if(!_0x20ff34)return;_0x19ee37[_0x5aa9fd(0x7c0)](_0x5c16bb=>{const _0x244ab9=_0x5aa9fd,_0x32bca8=document[_0x244ab9(0x8c2)](_0x5c16bb);_0x32bca8&&_0x20ff34['appendChild'](_0x32bca8);});}const _0x43fda0=['open-sticker-panel-btn',_0x18b51e(0x1009),_0x18b51e(0x101f),_0x18b51e(0xef2),_0x18b51e(0x103d),_0x18b51e(0x83c),_0x18b51e(0x120d),'group-video-call-btn',_0x18b51e(0x1a1),_0x18b51e(0x1256),_0x18b51e(0xe99),_0x18b51e(0x987),'open-shopping-btn','pat-btn',_0x18b51e(0x1048),'regenerate-btn',_0x18b51e(0x77f),_0x18b51e(0x2bb),_0x18b51e(0x1298),'read-together-btn'];async function _0x4db8ae(){const _0x3aec7f=_0x18b51e;_0x405767['globalSettings']['chatActionButtonsOrder']=null,await _0x15043e['globalSettings'][_0x3aec7f(0xfaa)](_0x405767[_0x3aec7f(0xb73)]),_0x3c0a3b(),_0x249d78(),await _0x501c7b('成功',_0x3aec7f(0xb15));}let _0x1d6f44=[],_0x31acc5=[];function _0x5bf9b4(){const _0x4dfbcd=_0x18b51e,_0x1950d1=document[_0x4dfbcd(0x8c2)](_0x4dfbcd(0x3fd));_0x1d6f44=[],_0x31acc5=[],_0x50ff2d(),document[_0x4dfbcd(0x8c2)](_0x4dfbcd(0x579))[_0x4dfbcd(0x842)][_0x4dfbcd(0x5e9)]=_0x4dfbcd(0xd52),document['getElementById'](_0x4dfbcd(0x309))[_0x4dfbcd(0x842)]['display']=_0x4dfbcd(0xbf8),_0x1950d1[_0x4dfbcd(0xb17)][_0x4dfbcd(0x3f4)](_0x4dfbcd(0x2cd));}function _0x50ff2d(){const _0x293c6a=_0x18b51e,_0x597794=document['getElementById'](_0x293c6a(0x11a2));_0x597794[_0x293c6a(0xca0)]='';const _0x4aeb9d=document[_0x293c6a(0x8c1)](_0x293c6a(0x1072));_0x4aeb9d[_0x293c6a(0x84c)]=_0x293c6a(0x2f8),_0x4aeb9d[_0x293c6a(0x323)][_0x293c6a(0x43a)]=_0x293c6a(0x74b),_0x4aeb9d[_0x293c6a(0xca0)]=_0x293c6a(0x879)+(_0x405767[_0x293c6a(0x20a)]['nickname']||'我')+'\x20(用户)</span>\x0a\x20\x20\x20\x20',_0x597794['appendChild'](_0x4aeb9d),Object[_0x293c6a(0x22f)](_0x405767[_0x293c6a(0x799)])[_0x293c6a(0x7c0)](_0x3934f1=>{const _0x115da3=_0x293c6a;if(!_0x3934f1[_0x115da3(0x1000)]){const _0x443aca=document[_0x115da3(0x8c1)](_0x115da3(0x1072));_0x443aca[_0x115da3(0x84c)]=_0x115da3(0x2f8),_0x443aca[_0x115da3(0x323)]['charId']=_0x3934f1['id'],_0x443aca[_0x115da3(0xca0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x3934f1['name']+_0x115da3(0xe37),_0x597794[_0x115da3(0x31e)](_0x443aca);}});}function _0x1b5456(){const _0x2e0e97=_0x18b51e,_0x301227=document[_0x2e0e97(0x8c2)](_0x2e0e97(0x366));_0x301227['innerHTML']='';const _0x4bf8ba=[{'id':_0x2e0e97(0x6d4),'name':_0x2e0e97(0xe56),'description':_0x2e0e97(0x193)},{'id':_0x2e0e97(0x35e),'name':_0x2e0e97(0xb78),'description':_0x2e0e97(0xe91)},{'id':'calls','name':_0x2e0e97(0xcf4),'description':_0x2e0e97(0xc97)},{'id':'thoughts','name':'心声','description':_0x2e0e97(0xc31)},{'id':_0x2e0e97(0x4a0),'name':_0x2e0e97(0xfa1),'description':_0x2e0e97(0xb66)},{'id':'favorites','name':'收藏','description':_0x2e0e97(0x63a)},{'id':_0x2e0e97(0x1094),'name':_0x2e0e97(0xb94),'description':_0x2e0e97(0x935)}];_0x4bf8ba[_0x2e0e97(0x7c0)](_0x416e53=>{const _0x1e626e=_0x2e0e97,_0x56d78a=document[_0x1e626e(0x8c1)](_0x1e626e(0x1072));_0x56d78a[_0x1e626e(0x84c)]=_0x1e626e(0x2f8),_0x56d78a[_0x1e626e(0x323)][_0x1e626e(0xe79)]=_0x416e53['id'],_0x56d78a[_0x1e626e(0xca0)]=_0x1e626e(0x1253)+_0x416e53[_0x1e626e(0x596)]+_0x1e626e(0x8cd)+_0x416e53[_0x1e626e(0x3ca)]+_0x1e626e(0x265),_0x301227[_0x1e626e(0x31e)](_0x56d78a);});}function _0x48c312(){const _0x3eb6a3=_0x18b51e,_0x465bcb=document[_0x3eb6a3(0xa2d)](_0x3eb6a3(0xfb5));if(_0x465bcb[_0x3eb6a3(0x105a)]===0x0){alert(_0x3eb6a3(0x9a1));return;}_0x1d6f44=Array['from'](_0x465bcb)['map'](_0x3b378e=>_0x3b378e['dataset']['charId']),_0x1b5456(),document[_0x3eb6a3(0x8c2)](_0x3eb6a3(0x579))[_0x3eb6a3(0x842)][_0x3eb6a3(0x5e9)]='none',document[_0x3eb6a3(0x8c2)]('data-clear-step-2')[_0x3eb6a3(0x842)][_0x3eb6a3(0x5e9)]=_0x3eb6a3(0xd52);}function _0x5d0c1b(){const _0x54db1a=_0x18b51e;document[_0x54db1a(0x8c2)](_0x54db1a(0x309))[_0x54db1a(0x842)][_0x54db1a(0x5e9)]=_0x54db1a(0xbf8),document[_0x54db1a(0x8c2)]('data-clear-step-1')[_0x54db1a(0x842)]['display']=_0x54db1a(0xd52),document[_0x54db1a(0xa2d)](_0x54db1a(0xc1d))[_0x54db1a(0x7c0)](_0x279318=>{const _0x188809=_0x54db1a;_0x1d6f44[_0x188809(0x773)](_0x279318[_0x188809(0x323)][_0x188809(0x43a)])&&_0x279318[_0x188809(0xb17)][_0x188809(0x3f4)](_0x188809(0x118f));});}async function _0x36de15(){const _0x1e8839=_0x18b51e,_0xc37411=document[_0x1e8839(0xa2d)](_0x1e8839(0x666));if(_0xc37411[_0x1e8839(0x105a)]===0x0){alert(_0x1e8839(0xe28));return;}_0x31acc5=Array[_0x1e8839(0x51a)](_0xc37411)[_0x1e8839(0x6b9)](_0x3a5051=>_0x3a5051[_0x1e8839(0x323)][_0x1e8839(0xe79)]);const _0x1a5842=await _0x8b9cb8(_0x1e8839(0x694),_0x1e8839(0xc0f),{'confirmButtonClass':_0x1e8839(0xe2a),'confirmText':_0x1e8839(0xad9)});if(!_0x1a5842)return;await _0x501c7b('请稍候...','正在执行清理操作，请不要关闭页面...');try{await _0x15043e[_0x1e8839(0xa88)]('rw',_0x15043e[_0x1e8839(0x45e)],async()=>{const _0x19ac91=_0x1e8839;for(const _0x41b800 of _0x1d6f44){for(const _0x2ab7b7 of _0x31acc5){if(_0x2ab7b7===_0x19ac91(0x6d4)){if(_0x41b800===_0x19ac91(0x74b)){const _0x516b06=await _0x15043e[_0x19ac91(0x799)][_0x19ac91(0x6be)]();for(const _0x305009 of _0x516b06){_0x305009['history']=_0x305009[_0x19ac91(0xd39)][_0x19ac91(0x1d8)](_0x32df8a=>_0x32df8a[_0x19ac91(0x14a)]!==_0x19ac91(0x74b)),await _0x15043e[_0x19ac91(0x799)][_0x19ac91(0xfaa)](_0x305009);}}else{const _0x3775f1=await _0x15043e[_0x19ac91(0x799)][_0x19ac91(0x3e9)](_0x41b800);_0x3775f1&&(_0x3775f1['history']=[],_0x3775f1[_0x19ac91(0x211)]=_0x19ac91(0x388),_0x3775f1[_0x19ac91(0x103c)]=_0x19ac91(0x388),Array[_0x19ac91(0xb85)](_0x3775f1[_0x19ac91(0x1116)])&&(_0x3775f1[_0x19ac91(0x1116)]=[]),_0x3775f1[_0x19ac91(0x33a)]&&(_0x3775f1[_0x19ac91(0x33a)][_0x19ac91(0xe16)]='我'),await _0x15043e[_0x19ac91(0x799)][_0x19ac91(0xfaa)](_0x3775f1));}}if(_0x2ab7b7===_0x19ac91(0x35e)){const _0x91b632=_0x41b800===_0x19ac91(0x74b)?_0x19ac91(0x74b):_0x41b800;await _0x15043e[_0x19ac91(0xcc0)][_0x19ac91(0xdb8)](_0x19ac91(0x802))[_0x19ac91(0xc9a)](_0x91b632)[_0x19ac91(0x89f)]();}_0x2ab7b7===_0x19ac91(0xadb)&&_0x41b800!==_0x19ac91(0x74b)&&await _0x15043e[_0x19ac91(0x164)][_0x19ac91(0xdb8)](_0x19ac91(0xb3d))[_0x19ac91(0xc9a)](_0x41b800)[_0x19ac91(0x89f)]();if(_0x2ab7b7===_0x19ac91(0x4d2)&&_0x41b800!==_0x19ac91(0x74b)){const _0xc32c78=await _0x15043e[_0x19ac91(0x799)]['get'](_0x41b800);_0xc32c78&&(_0xc32c78[_0x19ac91(0x120b)]=[],_0xc32c78['heartfeltVoice']=_0x19ac91(0x388),_0xc32c78[_0x19ac91(0x103c)]='...',await _0x15043e[_0x19ac91(0x799)][_0x19ac91(0xfaa)](_0xc32c78));}if(_0x2ab7b7===_0x19ac91(0x4a0)&&_0x41b800!=='user'){const _0x23f099=await _0x15043e[_0x19ac91(0x799)][_0x19ac91(0x3e9)](_0x41b800);_0x23f099&&(_0x23f099[_0x19ac91(0xbca)]=[],await _0x15043e['chats'][_0x19ac91(0xfaa)](_0x23f099));}_0x2ab7b7===_0x19ac91(0xe93)&&(_0x41b800===_0x19ac91(0x74b)?(await _0x15043e[_0x19ac91(0xe93)][_0x19ac91(0xdb8)]('type')[_0x19ac91(0xc9a)](_0x19ac91(0x80e))[_0x19ac91(0x1d8)](_0x263b8a=>_0x263b8a['content']['authorId']==='user')[_0x19ac91(0x89f)](),await _0x15043e[_0x19ac91(0xe93)][_0x19ac91(0xdb8)](_0x19ac91(0xde0))[_0x19ac91(0xc9a)]('chat_message')['filter'](_0x53c41d=>_0x53c41d[_0x19ac91(0x168)][_0x19ac91(0x14a)]===_0x19ac91(0x74b))['delete']()):(await _0x15043e[_0x19ac91(0xe93)][_0x19ac91(0xdb8)](_0x19ac91(0xde0))['equals']('chat_message')[_0x19ac91(0x1bc)](_0x273471=>_0x273471[_0x19ac91(0xb3d)]===_0x41b800)[_0x19ac91(0x89f)](),await _0x15043e[_0x19ac91(0xe93)][_0x19ac91(0xdb8)](_0x19ac91(0xde0))[_0x19ac91(0xc9a)](_0x19ac91(0x80e))['filter'](_0x37af5b=>_0x37af5b[_0x19ac91(0x168)]['authorId']===_0x41b800)[_0x19ac91(0x89f)](),await _0x15043e['favorites']['where']('type')[_0x19ac91(0xc9a)](_0x19ac91(0x872))['filter'](_0x4a348c=>_0x4a348c[_0x19ac91(0x168)][_0x19ac91(0xf17)]===_0x41b800)[_0x19ac91(0x89f)](),await _0x15043e[_0x19ac91(0xe93)]['where'](_0x19ac91(0xde0))[_0x19ac91(0xc9a)](_0x19ac91(0x6cc))[_0x19ac91(0x1d8)](_0x4147f7=>_0x4147f7['content'][_0x19ac91(0xf17)]===_0x41b800)[_0x19ac91(0x89f)](),await _0x15043e[_0x19ac91(0xe93)][_0x19ac91(0xdb8)](_0x19ac91(0xde0))[_0x19ac91(0xc9a)](_0x19ac91(0xd7a))[_0x19ac91(0x1d8)](_0x19f1ea=>_0x19f1ea[_0x19ac91(0x168)][_0x19ac91(0xf17)]===_0x41b800)['delete']()));if(_0x2ab7b7===_0x19ac91(0x1094)&&_0x41b800!==_0x19ac91(0x74b)){const _0x28e884=await _0x15043e[_0x19ac91(0x799)][_0x19ac91(0x3e9)](_0x41b800);_0x28e884&&(_0x28e884['simulatedAlbum']=[],_0x28e884[_0x19ac91(0x882)]=[],_0x28e884[_0x19ac91(0x9d5)]=[],_0x28e884[_0x19ac91(0xec9)]=null,_0x28e884[_0x19ac91(0xa2f)]=[],_0x28e884[_0x19ac91(0xc17)]=[],_0x28e884[_0x19ac91(0x3ee)]=[],_0x28e884['diary']=[],_0x28e884['memos']=[],await _0x15043e[_0x19ac91(0x799)]['put'](_0x28e884));}}}}),await _0x343828(),await _0x2b55d1(),document['getElementById'](_0x1e8839(0x3fd))[_0x1e8839(0xb17)][_0x1e8839(0xaff)](_0x1e8839(0x2cd)),await _0x501c7b('清理完成','指定的数据已成功清除。');}catch(_0x3b605b){console[_0x1e8839(0x7a3)]('高级数据清理失败:',_0x3b605b),await _0x501c7b('清理失败',_0x1e8839(0x35f)+_0x3b605b[_0x1e8839(0xc7d)]);}}async function _0x119b2c(_0x1003e3,_0x196a2c,_0x527ecc){const _0x2a7692=_0x18b51e,_0x1d3a23=_0x527ecc[_0x2a7692(0x1ad)]('.icon-preview')[_0x2a7692(0xc73)],_0x1811d8=await _0x40fef8(_0x2a7692(0x61c)+_0x1d3a23+_0x2a7692(0x535),[{'text':_0x2a7692(0xf02),'value':_0x2a7692(0x6a0)},{'text':_0x2a7692(0xf47),'value':_0x2a7692(0x9d6)}]);let _0x5ab33a=null;if(_0x1811d8===_0x2a7692(0x6a0))_0x5ab33a=await _0x434b4d();else{if(_0x1811d8===_0x2a7692(0x9d6)){const _0x161d4a=_0x196a2c==='cphone'?_0x405767[_0x2a7692(0xb73)][_0x2a7692(0x429)][_0x1003e3]:_0x405767['globalSettings']['appIcons'][_0x1003e3],_0x2b1fae=_0x161d4a[_0x2a7692(0xc7c)](_0x2a7692(0x1249)),_0x5aa478=_0x2b1fae?'':_0x161d4a;_0x5ab33a=await _0x180f74('更换图标',_0x2a7692(0xe76),_0x5aa478,_0x2a7692(0x9d6));}}if(_0x5ab33a&&_0x5ab33a[_0x2a7692(0x8c6)]()){const _0x8fe28=_0x5ab33a[_0x2a7692(0x8c6)]();_0x196a2c===_0x2a7692(0x1094)?_0x405767['globalSettings'][_0x2a7692(0x429)][_0x1003e3]=_0x8fe28:_0x405767['globalSettings'][_0x2a7692(0x18d)][_0x1003e3]=_0x8fe28,_0x527ecc['querySelector']('.icon-preview')[_0x2a7692(0x939)]=_0x8fe28;}else _0x5ab33a!==null&&alert(_0x2a7692(0x26b));}async function _0x25e890(){const _0x187363=_0x18b51e,_0x57bb73=await _0x8b9cb8(_0x187363(0x7b4),_0x187363(0xc44),{'confirmButtonClass':_0x187363(0xe2a),'confirmText':'我已了解风险，确认压缩'});if(!_0x57bb73)return;await _0x501c7b(_0x187363(0x1047),'正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...');let _0x373c97={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console[_0x187363(0x32b)](_0x187363(0x1172));const _0x15bb3d=[_0x187363(0x799),_0x187363(0xb73),_0x187363(0x20a),'userStickers','customAvatarFrames'],_0x793bc9=[];for(const _0x58c44b of _0x15bb3d){const _0xbac8b1=_0x15043e[_0x187363(0x7d9)](_0x58c44b),_0x55538d=await _0xbac8b1[_0x187363(0x6be)]();_0x793bc9[_0x187363(0xa49)]({'tableName':_0x58c44b,'records':_0x55538d});}console[_0x187363(0x32b)](_0x187363(0x1158));for(const _0xbdb31f of _0x793bc9){for(const _0x265270 of _0xbdb31f[_0x187363(0x62e)]){await _0x31c6aa(_0x265270,_0x373c97);}}console['log']('压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...'),await _0x15043e[_0x187363(0xa88)]('rw',_0x15bb3d,async()=>{const _0xbdd698=_0x187363;for(const _0x5b69f9 of _0x793bc9){await _0x15043e['table'](_0x5b69f9[_0xbdd698(0x128b)])[_0xbdd698(0xcfd)](_0x5b69f9[_0xbdd698(0x62e)]);}});const _0xfb8d62=_0x373c97[_0x187363(0x83b)]-_0x373c97[_0x187363(0x267)],_0x25663=_0x373c97['originalSize']>0x0?(_0xfb8d62/_0x373c97[_0x187363(0x83b)]*0x64)[_0x187363(0x3c1)](0x2):0x0;await _0x501c7b('压缩完成！',_0x187363(0xb48)+_0x373c97[_0x187363(0xa38)]+_0x187363(0x75e)+_0x373c97[_0x187363(0x9ed)]+_0x187363(0x1b8)+_0x373c97[_0x187363(0xac4)]+_0x187363(0xc5f)+(_0xfb8d62/0x400/0x400)['toFixed'](0x2)+_0x187363(0xd86)+_0x25663+_0x187363(0xb1f));}catch(_0x163b0b){console[_0x187363(0x7a3)](_0x187363(0xda7),_0x163b0b),await _0x501c7b('压缩失败','操作失败:\x20'+_0x163b0b['message']);}}async function _0x31c6aa(_0x12b42a,_0x30200b){const _0x320e31=_0x18b51e;for(const _0xd882ff in _0x12b42a){if(typeof _0x12b42a[_0xd882ff]===_0x320e31(0xf1b)&&_0x12b42a[_0xd882ff][_0x320e31(0xc7c)](_0x320e31(0x1249))){_0x30200b[_0x320e31(0xa38)]++;const _0x4f6165=_0x12b42a[_0xd882ff];_0x30200b[_0x320e31(0x83b)]+=_0x4f6165['length'];const _0x1a2680=await _0x39588a(_0x4f6165);_0x1a2680&&_0x1a2680!==_0x4f6165?(_0x12b42a[_0xd882ff]=_0x1a2680,_0x30200b[_0x320e31(0x9ed)]++,_0x30200b[_0x320e31(0x267)]+=_0x1a2680[_0x320e31(0x105a)]):(_0x30200b[_0x320e31(0xac4)]++,_0x30200b[_0x320e31(0x267)]+=_0x4f6165['length']);}else typeof _0x12b42a[_0xd882ff]===_0x320e31(0x7a5)&&_0x12b42a[_0xd882ff]!==null&&await _0x31c6aa(_0x12b42a[_0xd882ff],_0x30200b);}}function _0x39588a(_0x373b94,_0x24822f={}){return new Promise(_0x42ec14=>{const _0x309539=_0x7a65;if(_0x373b94['startsWith']('data:image/jpeg')||!_0x373b94[_0x309539(0xc7c)](_0x309539(0x1249))){_0x42ec14(_0x373b94);return;}const _0x584b72=_0x24822f[_0x309539(0x11e7)]||0.7,_0x562dff=_0x24822f[_0x309539(0x8eb)]||0x400,_0x35f38e=new Image();_0x35f38e[_0x309539(0xe7a)]=()=>{const _0x781bbd=_0x309539;let _0x1e6df8=_0x35f38e[_0x781bbd(0x578)],_0x196fd9=_0x35f38e[_0x781bbd(0xba8)];_0x1e6df8>_0x562dff&&(_0x196fd9=_0x562dff/_0x1e6df8*_0x196fd9,_0x1e6df8=_0x562dff);const _0x1204ae=document[_0x781bbd(0x8c1)](_0x781bbd(0xc71));_0x1204ae[_0x781bbd(0x578)]=_0x1e6df8,_0x1204ae['height']=_0x196fd9;const _0x406ad6=_0x1204ae[_0x781bbd(0xebd)]('2d');_0x406ad6[_0x781bbd(0xa91)](_0x35f38e,0x0,0x0,_0x1e6df8,_0x196fd9);const _0x160596=_0x1204ae[_0x781bbd(0x7a6)]('image/jpeg',_0x584b72);_0x160596[_0x781bbd(0x105a)]<_0x373b94[_0x781bbd(0x105a)]?_0x42ec14(_0x160596):_0x42ec14(_0x373b94);},_0x35f38e[_0x309539(0x10bb)]=()=>{const _0x143c68=_0x309539;console['warn'](_0x143c68(0x9a6),_0x373b94['substring'](0x0,0x32)+_0x143c68(0x388)),_0x42ec14(_0x373b94);},_0x35f38e[_0x309539(0x939)]=_0x373b94;});}async function _0x1a66b3(){const _0xfbefe8=_0x18b51e,_0x22c655=_0xfbefe8(0x50b);try{const _0x3d8a8a=await fetch(_0xfbefe8(0x948)+Date[_0xfbefe8(0x1ed)]());if(!_0x3d8a8a['ok']){console[_0xfbefe8(0x112a)](_0xfbefe8(0x1171));return;}const _0x2dc4e6=await _0x3d8a8a[_0xfbefe8(0xbc6)](),_0x4e5b9c=document[_0xfbefe8(0x8c1)](_0xfbefe8(0x1072));_0x4e5b9c[_0xfbefe8(0xca0)]=_0x2dc4e6;const _0x48177d=_0x4e5b9c[_0xfbefe8(0x1ad)](_0xfbefe8(0x2bc));if(!_0x48177d){console[_0xfbefe8(0x7a3)](_0xfbefe8(0x1155));return;}const _0x4baff5=_0x48177d[_0xfbefe8(0x323)][_0xfbefe8(0xdf3)],_0x25acd6=localStorage[_0xfbefe8(0xf13)](_0xfbefe8(0xde6));_0x4baff5>_0x25acd6?(console['log'](_0xfbefe8(0x4dd)+_0x4baff5+_0xfbefe8(0xc7f)+_0x25acd6+')'),_0x2adce1(_0x4baff5,_0x48177d['innerHTML'])):console[_0xfbefe8(0x32b)]('当前通知版本\x20('+_0x4baff5+_0xfbefe8(0x3cc));}catch(_0x400c98){console[_0xfbefe8(0x7a3)](_0xfbefe8(0x1c1),_0x400c98);}}function _0x2adce1(_0x5a8022,_0x4ed6ad){const _0x5db7b=_0x18b51e,_0x5e76bd=document[_0x5db7b(0x8c2)](_0x5db7b(0x279)),_0x14aac4=document['getElementById'](_0x5db7b(0xd13)),_0x28b724=document['getElementById'](_0x5db7b(0xcfc)),_0x4a2f78=document['getElementById'](_0x5db7b(0xacb));_0x14aac4['innerHTML']=_0x4ed6ad,_0x28b724[_0x5db7b(0xcda)]=()=>{const _0x747240=_0x5db7b;_0x5e76bd[_0x747240(0xb17)][_0x747240(0xaff)](_0x747240(0x2cd));},_0x4a2f78[_0x5db7b(0xcda)]=()=>{const _0x42228b=_0x5db7b;localStorage['setItem'](_0x42228b(0xde6),_0x5a8022),_0x5e76bd[_0x42228b(0xb17)][_0x42228b(0xaff)]('visible'),console[_0x42228b(0x32b)](_0x42228b(0x50e)+_0x5a8022);},_0x5e76bd[_0x5db7b(0xb17)]['add'](_0x5db7b(0x2cd));}function _0x1f7c9f(){const _0x1b598d=_0x18b51e,_0x242de5=document['getElementById'](_0x1b598d(0x115f));document[_0x1b598d(0x8c2)](_0x1b598d(0xdfe))['value']=_0x405767[_0x1b598d(0xb73)][_0x1b598d(0x89a)]||0xc,document[_0x1b598d(0x8c2)](_0x1b598d(0xfac))[_0x1b598d(0x518)]=_0x405767[_0x1b598d(0xb73)]['doubanMaxPosts']||0x14,_0x242de5[_0x1b598d(0xb17)][_0x1b598d(0x3f4)]('visible');}async function _0x4ff99b(){const _0x27c28c=_0x18b51e,_0x494b79=document[_0x27c28c(0x8c2)](_0x27c28c(0xdfe)),_0x337500=document[_0x27c28c(0x8c2)](_0x27c28c(0xfac)),_0x5a5887=parseInt(_0x494b79['value']),_0x1c1826=parseInt(_0x337500[_0x27c28c(0x518)]);if(isNaN(_0x5a5887)||isNaN(_0x1c1826)||_0x5a5887<0x1||_0x1c1826<0x1){alert(_0x27c28c(0xd21));return;}if(_0x5a5887>_0x1c1826){alert(_0x27c28c(0xdad));return;}_0x405767[_0x27c28c(0xb73)][_0x27c28c(0x89a)]=_0x5a5887,_0x405767[_0x27c28c(0xb73)][_0x27c28c(0xff3)]=_0x1c1826,await _0x15043e[_0x27c28c(0xb73)]['put'](_0x405767[_0x27c28c(0xb73)]),document['getElementById'](_0x27c28c(0x115f))[_0x27c28c(0xb17)][_0x27c28c(0xaff)]('visible'),await _0x501c7b(_0x27c28c(0xdce),_0x27c28c(0x1102));}async function _0x7f1d62(_0x253f85){const _0x34d06c=_0x18b51e,_0x3ed363=document[_0x34d06c(0x8c2)](_0x34d06c(0x631)),_0x14e40a=document[_0x34d06c(0x8c2)]('werewolf-player-selection-list');_0x14e40a[_0x34d06c(0xca0)]='';let _0xe3d057=[];if(_0x253f85===_0x34d06c(0xd50)){const _0x26e007=Object[_0x34d06c(0x22f)](_0x405767[_0x34d06c(0x799)])['filter'](_0x99bc77=>!_0x99bc77[_0x34d06c(0x1000)]),_0x23076f=await _0x15043e[_0x34d06c(0xa4a)][_0x34d06c(0x6be)]();_0xe3d057=[{'id':_0x34d06c(0x74b),'name':_0x405767[_0x34d06c(0x20a)]['nickname']||'我','originalName':_0x405767[_0x34d06c(0x20a)][_0x34d06c(0xab3)]||'我','avatar':_0x405767[_0x34d06c(0x20a)][_0x34d06c(0x1e1)],'type':_0x34d06c(0x74b)},..._0x26e007[_0x34d06c(0x6b9)](_0x305253=>({'id':_0x305253['id'],'name':_0x305253[_0x34d06c(0x596)],'originalName':_0x305253[_0x34d06c(0x4e7)],'avatar':_0x305253['settings'][_0x34d06c(0x44e)],'type':_0x34d06c(0xd16)})),..._0x23076f[_0x34d06c(0x6b9)](_0xff5a95=>({'id':_0x34d06c(0x5ea)+_0xff5a95['id'],'name':_0xff5a95[_0x34d06c(0x596)],'originalName':_0xff5a95[_0x34d06c(0x596)],'avatar':_0xff5a95['avatar'],'type':'npc'}))],_0x54c7b5[_0x34d06c(0xb3d)]=null;}else{const _0x31f289=_0x405767[_0x34d06c(0x799)][_0x405767[_0x34d06c(0x248)]];if(!_0x31f289||!_0x31f289['isGroup'])return;_0xe3d057=[{'id':'user','name':_0x31f289['settings'][_0x34d06c(0xe16)]||'我','originalName':_0x405767[_0x34d06c(0x20a)][_0x34d06c(0xab3)]||'我','avatar':_0x31f289[_0x34d06c(0x33a)][_0x34d06c(0x11ed)],'type':_0x34d06c(0x74b)},..._0x31f289[_0x34d06c(0x635)][_0x34d06c(0x6b9)](_0x7330d1=>{const _0x1d06a3=_0x34d06c,_0x1b12dc=_0x405767['chats'][_0x7330d1['id']],_0x37b628=_0x7330d1[_0x1d06a3(0x1e1)]||(_0x1b12dc?_0x1b12dc[_0x1d06a3(0x33a)]['aiAvatar']:_0x9fdc61);return{'id':_0x7330d1['id'],'name':_0x7330d1[_0x1d06a3(0x375)],'originalName':_0x7330d1[_0x1d06a3(0x4e7)],'avatar':_0x37b628,'type':_0x7330d1[_0x1d06a3(0x10f2)]?_0x1d06a3(0x566):_0x1d06a3(0xd16)};})],_0x54c7b5['chatId']=_0x405767[_0x34d06c(0x248)];}_0xe3d057[_0x34d06c(0x7c0)](_0x12a36a=>{const _0x33bcd9=_0x34d06c,_0x2bd108=document[_0x33bcd9(0x8c1)]('div');_0x2bd108[_0x33bcd9(0x84c)]='contact-picker-item',_0x2bd108[_0x33bcd9(0xca0)]=_0x33bcd9(0x413)+JSON['stringify'](_0x12a36a)+'\x27\x20'+(_0x12a36a[_0x33bcd9(0xde0)]===_0x33bcd9(0x74b)?_0x33bcd9(0xa9f):_0x33bcd9(0x75f))+_0x33bcd9(0xcb2)+_0x12a36a['avatar']+_0x33bcd9(0x11c6)+_0x12a36a[_0x33bcd9(0x596)]+_0x33bcd9(0x10e2),_0x14e40a[_0x33bcd9(0x31e)](_0x2bd108);}),_0x3ed363[_0x34d06c(0xb17)]['add'](_0x34d06c(0x2cd));}async function _0x49da84(){const _0x3b5c84=_0x18b51e,_0xc6655d=document['querySelectorAll'](_0x3b5c84(0x552)),_0xcd28b=_0xc6655d[_0x3b5c84(0x105a)];let _0xfd4fc2=[];if(_0xcd28b===0x6)_0x54c7b5[_0x3b5c84(0x648)]='6p',_0xfd4fc2=['狼人','狼人','平民','平民',_0x3b5c84(0x10c0),'猎人'];else{if(_0xcd28b===0x9)_0x54c7b5[_0x3b5c84(0x648)]='9p',_0xfd4fc2=['狼人','狼人','狼人','平民','平民','平民',_0x3b5c84(0x10c0),'女巫','猎人'];else{if(_0xcd28b===0xc)_0x54c7b5['gameMode']=_0x3b5c84(0xa2e),_0xfd4fc2=['狼人','狼人','狼人','狼人','平民','平民','平民','平民',_0x3b5c84(0x10c0),'女巫','猎人','守卫'];else{alert(_0x3b5c84(0x76d)+_0xcd28b+_0x3b5c84(0xd4a));return;}}}document[_0x3b5c84(0x8c2)](_0x3b5c84(0x631))['classList'][_0x3b5c84(0xaff)](_0x3b5c84(0x2cd)),await _0x501c7b(_0x3b5c84(0xe22),_0x3b5c84(0x1259));for(let _0x306451=_0xfd4fc2[_0x3b5c84(0x105a)]-0x1;_0x306451>0x0;_0x306451--){const _0x246cf7=Math[_0x3b5c84(0x10b2)](Math['random']()*(_0x306451+0x1));[_0xfd4fc2[_0x306451],_0xfd4fc2[_0x246cf7]]=[_0xfd4fc2[_0x246cf7],_0xfd4fc2[_0x306451]];}const _0x31dd95=Array[_0x3b5c84(0x51a)](_0xc6655d)[_0x3b5c84(0x6b9)](_0x1234f6=>JSON[_0x3b5c84(0x10ab)](_0x1234f6['dataset'][_0x3b5c84(0x25b)]));_0x54c7b5[_0x3b5c84(0x4ae)]=[];for(let _0x166686=0x0;_0x166686<_0x31dd95[_0x3b5c84(0x105a)];_0x166686++){const _0x14e29c=_0x31dd95[_0x166686],_0x2b119e=_0xfd4fc2[_0x166686];let _0x133486=_0x3b5c84(0x684);if(_0x14e29c['type']===_0x3b5c84(0xd16)){const _0x42ec64=_0x405767[_0x3b5c84(0x799)][_0x14e29c['id']];_0x133486=_0x42ec64?_0x42ec64[_0x3b5c84(0x33a)][_0x3b5c84(0x1060)]:_0x3b5c84(0x626);}else{if(_0x14e29c[_0x3b5c84(0xde0)]===_0x3b5c84(0x566)){const _0x36c671=await _0x15043e[_0x3b5c84(0xa4a)]['toArray'](),_0x581ecd=_0x36c671['find'](_0x27db28=>'npc_'+_0x27db28['id']===_0x14e29c['id']);_0x133486=_0x581ecd?_0x581ecd[_0x3b5c84(0x391)]:_0x3b5c84(0xd75);}else{if(_0x14e29c[_0x3b5c84(0xde0)]===_0x3b5c84(0x74b)){const _0x3e5577=_0x54c7b5[_0x3b5c84(0xb3d)]?_0x405767[_0x3b5c84(0x799)][_0x54c7b5[_0x3b5c84(0xb3d)]]:null;_0x133486=_0x3e5577?_0x3e5577['settings'][_0x3b5c84(0xbe8)]:_0x3b5c84(0xdfa);}}}const _0x70d4bb={..._0x14e29c,'role':_0x2b119e,'isAlive':!![],'character_persona':_0x133486};_0x2b119e==='女巫'&&(_0x70d4bb[_0x3b5c84(0x116a)]=![],_0x70d4bb['poisonUsed']=![]),_0x2b119e==='守卫'&&(_0x70d4bb['lastGuardedId']=null),_0x54c7b5[_0x3b5c84(0x4ae)][_0x3b5c84(0xa49)](_0x70d4bb);}_0x54c7b5[_0x3b5c84(0x6f0)]=!![],_0x54c7b5['currentDay']=0x1,_0x54c7b5[_0x3b5c84(0x752)]='start',_0x54c7b5[_0x3b5c84(0x87b)]=[],_0x54c7b5[_0x3b5c84(0xc69)]=[];const _0x195d86=_0xfd4fc2[_0x3b5c84(0x29a)]((_0x1aa6b3,_0x207912)=>{return _0x1aa6b3[_0x207912]=(_0x1aa6b3[_0x207912]||0x0)+0x1,_0x1aa6b3;},{}),_0x31ef51=Object[_0x3b5c84(0x6ff)](_0x195d86)[_0x3b5c84(0x6b9)](([_0x434e90,_0x3adfb1])=>_0x434e90+'\x20x'+_0x3adfb1)[_0x3b5c84(0xb2c)]('、');_0x25990f(_0x3b5c84(0x71f)+_0xcd28b+_0x3b5c84(0x865)+_0x31ef51+'。');const _0x179d19=_0x54c7b5[_0x3b5c84(0x4ae)][_0x3b5c84(0x2ef)](_0x1672ed=>_0x1672ed['id']==='user');_0x46fe95(),_0x3d1990(_0x3b5c84(0x1166)),_0x3c7136(_0x179d19[_0x3b5c84(0x14a)]);}function _0x46fe95(){const _0x4aa3d0=_0x18b51e,_0x2b5ca5=document[_0x4aa3d0(0x8c2)](_0x4aa3d0(0x11f8));_0x2b5ca5['innerHTML']='';const _0x3a240a=[..._0x54c7b5['players']][_0x4aa3d0(0xa19)]((_0x48bc36,_0x135e0c)=>_0x48bc36[_0x4aa3d0(0x2f0)]-_0x135e0c['isAlive']);_0x3a240a['forEach']((_0x5ebb9a,_0x2fd940)=>{const _0xfb7aeb=_0x4aa3d0,_0x5119b8=_0x54c7b5[_0xfb7aeb(0x4ae)][_0xfb7aeb(0x1149)](_0xbd6d5b=>_0xbd6d5b['id']===_0x5ebb9a['id'])+0x1,_0x19d71c=document[_0xfb7aeb(0x8c1)](_0xfb7aeb(0x1072));_0x19d71c[_0xfb7aeb(0x84c)]=_0xfb7aeb(0x2ee);if(!_0x5ebb9a['isAlive'])_0x19d71c['classList'][_0xfb7aeb(0x3f4)](_0xfb7aeb(0xcb1));_0x19d71c[_0xfb7aeb(0xca0)]=_0xfb7aeb(0x1069)+_0x5ebb9a[_0xfb7aeb(0x1e1)]+_0xfb7aeb(0x108b)+_0x5119b8+'.\x20'+_0x5ebb9a['name']+_0xfb7aeb(0x10e2),_0x2b5ca5[_0xfb7aeb(0x31e)](_0x19d71c);});const _0x29fbda=document[_0x4aa3d0(0x8c2)]('werewolf-log');_0x29fbda['innerHTML']='';for(let _0xe1605b=0x1;_0xe1605b<=_0x54c7b5[_0x4aa3d0(0xb75)];_0xe1605b++){const _0x1dc765=[..._0x54c7b5[_0x4aa3d0(0x87b)][_0x4aa3d0(0x1d8)](_0x48dd4e=>_0x48dd4e['day']===_0xe1605b),..._0x54c7b5[_0x4aa3d0(0xc69)][_0x4aa3d0(0x1d8)](_0x5e9dff=>_0x5e9dff['day']===_0xe1605b)]['sort']((_0x1d7cd6,_0x3d4d92)=>(_0x1d7cd6[_0x4aa3d0(0x351)]||0x0)-(_0x3d4d92[_0x4aa3d0(0x351)]||0x0));if(_0x1dc765[_0x4aa3d0(0x105a)]>0x0){const _0x309cb2=document['createElement'](_0x4aa3d0(0x1072));_0x309cb2[_0x4aa3d0(0x84c)]=_0x4aa3d0(0x828),_0x309cb2[_0x4aa3d0(0x1090)]='---\x20第\x20'+_0xe1605b+'\x20天\x20---',_0x309cb2[_0x4aa3d0(0x842)][_0x4aa3d0(0x1d0)]=_0x4aa3d0(0x582),_0x29fbda['appendChild'](_0x309cb2),_0x1dc765[_0x4aa3d0(0x7c0)](_0x415f22=>{const _0x47aefe=_0x4aa3d0,_0x2c1b46=document[_0x47aefe(0x8c1)]('div');_0x2c1b46[_0x47aefe(0x84c)]=_0x47aefe(0xf8a)+_0x415f22[_0x47aefe(0xde0)],_0x415f22[_0x47aefe(0xde0)]===_0x47aefe(0x1028)?_0x2c1b46['innerHTML']='<span\x20class=\x22speaker\x22>'+_0x415f22[_0x47aefe(0xa76)]+_0x47aefe(0xb8d)+_0x415f22[_0x47aefe(0x168)]:_0x2c1b46[_0x47aefe(0x1090)]=_0x415f22[_0x47aefe(0x168)],_0x29fbda[_0x47aefe(0x31e)](_0x2c1b46);});}}_0x29fbda[_0x4aa3d0(0xfd0)]=_0x29fbda['scrollHeight'];const _0xc2453b={'start':_0x4aa3d0(0x1da),'night':'第'+_0x54c7b5[_0x4aa3d0(0xb75)]+_0x4aa3d0(0x825),'day':'第'+_0x54c7b5[_0x4aa3d0(0xb75)]+'天\x20-\x20白天','discussion':'第'+_0x54c7b5[_0x4aa3d0(0xb75)]+_0x4aa3d0(0x1198),'voting':'第'+_0x54c7b5[_0x4aa3d0(0xb75)]+_0x4aa3d0(0xc5b),'gameover':_0x4aa3d0(0x2d2)};document[_0x4aa3d0(0x8c2)]('werewolf-game-title')[_0x4aa3d0(0x1090)]=_0x4aa3d0(0xce2)+(_0xc2453b[_0x54c7b5[_0x4aa3d0(0x752)]]||_0x54c7b5['currentPhase']);}function _0x3c7136(_0x585fa9){const _0xb7b8f4=_0x18b51e,_0x501458={'狼人':_0xb7b8f4(0xc98),'平民':_0xb7b8f4(0x6a5),'预言家':_0xb7b8f4(0x1031),'猎人':_0xb7b8f4(0x52b),'女巫':_0xb7b8f4(0xe34),'守卫':_0xb7b8f4(0x54f)};document[_0xb7b8f4(0x8c2)]('werewolf-role-name')['textContent']=_0x585fa9,document[_0xb7b8f4(0x8c2)](_0xb7b8f4(0x1ca))[_0xb7b8f4(0x1090)]=_0x501458[_0x585fa9]||'一个神秘的角色。',document[_0xb7b8f4(0x8c2)](_0xb7b8f4(0x993))[_0xb7b8f4(0xb17)]['add'](_0xb7b8f4(0x2cd));}async function _0x99a3d1(){const _0x366e54=_0x18b51e;_0x54c7b5[_0x366e54(0x752)]='第'+_0x54c7b5[_0x366e54(0xb75)]+'天\x20-\x20夜晚',_0x54c7b5['nightActions']={},_0x25990f(_0x366e54(0x104a)),_0x46fe95(),document[_0x366e54(0x8c2)](_0x366e54(0x7c3))[_0x366e54(0x842)][_0x366e54(0x5e9)]=_0x366e54(0xbf8),document['getElementById']('werewolf-retry-btn')[_0x366e54(0x842)]['display']=_0x366e54(0xbf8),await new Promise(_0x32e620=>setTimeout(_0x32e620,0x5dc));const _0x38c60e=_0x54c7b5[_0x366e54(0x4ae)][_0x366e54(0x2ef)](_0x5e6f72=>_0x5e6f72[_0x366e54(0x14a)]==='守卫'&&_0x5e6f72[_0x366e54(0x2f0)]);if(_0x38c60e){_0x25990f('守卫请睁眼，请选择要守护的玩家。'),_0x46fe95();let _0x4f1c90=null;if(_0x38c60e['id']==='user')_0x4f1c90=await _0x3e036a(_0x366e54(0x39d),_0x38c60e[_0x366e54(0x92a)]);else{const _0x1a82ce=_0x54c7b5[_0x366e54(0x4ae)][_0x366e54(0x1d8)](_0x486389=>_0x486389[_0x366e54(0x2f0)]&&_0x486389['id']!==_0x38c60e[_0x366e54(0x92a)]);_0x1a82ce[_0x366e54(0x105a)]>0x0&&(_0x4f1c90=_0x1a82ce[Math[_0x366e54(0x10b2)](Math[_0x366e54(0x5b3)]()*_0x1a82ce[_0x366e54(0x105a)])]['id']);}_0x4f1c90&&(_0x54c7b5[_0x366e54(0xe70)]['guardedId']=_0x4f1c90,_0x38c60e['lastGuardedId']=_0x4f1c90),_0x25990f(_0x366e54(0x3e4)),_0x46fe95(),await new Promise(_0x524f40=>setTimeout(_0x524f40,0x5dc));}_0x25990f(_0x366e54(0xbe1)),_0x46fe95();const _0x3d9eab=_0x54c7b5['players'][_0x366e54(0x1d8)](_0x17a6e8=>_0x17a6e8[_0x366e54(0x14a)]==='狼人'&&_0x17a6e8[_0x366e54(0x2f0)]),_0x1e3523=_0x3d9eab[_0x366e54(0xdc3)](_0x3bba7a=>_0x3bba7a['id']==='user');let _0x42ca20=null;_0x54c7b5[_0x366e54(0x349)]='wolfKill';try{if(_0x1e3523)_0x25990f(_0x366e54(0x2e3)),_0x46fe95(),_0x42ca20=await _0x2a8263();else{if(_0x54c7b5['currentDay']===0x1){console[_0x366e54(0x32b)]('第一夜，执行本地随机刀人逻辑...');const _0x29284c=_0x54c7b5[_0x366e54(0x4ae)][_0x366e54(0x1d8)](_0x3d36f4=>_0x3d36f4['isAlive']&&_0x3d36f4[_0x366e54(0x14a)]!=='狼人');_0x29284c[_0x366e54(0x105a)]>0x0&&(_0x42ca20=_0x29284c[Math[_0x366e54(0x10b2)](Math[_0x366e54(0x5b3)]()*_0x29284c[_0x366e54(0x105a)])]['id']);}else _0x42ca20=await _0x767c2b();}_0x54c7b5[_0x366e54(0x349)]=null;}catch(_0x36c74c){console[_0x366e54(0x7a3)](_0x366e54(0x90a),_0x36c74c),await _0x501c7b(_0x366e54(0xa85),_0x366e54(0x31f)),document[_0x366e54(0x8c2)](_0x366e54(0xa64))[_0x366e54(0x842)]['display']=_0x366e54(0xea7);return;}_0x54c7b5['nightActions'][_0x366e54(0xdcc)]=_0x42ca20,_0x25990f(_0x366e54(0x3c8)),_0x46fe95(),await new Promise(_0x9c67b2=>setTimeout(_0x9c67b2,0x5dc));const _0x1f880d=_0x54c7b5['players'][_0x366e54(0x2ef)](_0x426277=>_0x426277[_0x366e54(0x14a)]==='女巫'&&_0x426277[_0x366e54(0x2f0)]);if(_0x1f880d){_0x25990f(_0x366e54(0x10c7)),_0x46fe95();const _0x3e469=_0x54c7b5[_0x366e54(0x4ae)][_0x366e54(0x2ef)](_0x39c744=>_0x39c744['id']===_0x54c7b5['nightActions'][_0x366e54(0xdcc)]),_0x19bac7=_0x54c7b5[_0x366e54(0xe70)][_0x366e54(0xbd3)]===_0x54c7b5['nightActions'][_0x366e54(0xdcc)],_0x25da08=_0x19bac7||!_0x3e469?null:_0x3e469;if(_0x1f880d['id']===_0x366e54(0x74b)){let _0x62457=await _0x3a19ab(_0x25da08,_0x1f880d);_0x62457[_0x366e54(0x8b1)]&&(_0x54c7b5['nightActions']['savedId']=_0x54c7b5[_0x366e54(0xe70)][_0x366e54(0xdcc)],_0x1f880d['antidoteUsed']=!![]),_0x62457[_0x366e54(0xdc7)]&&(_0x54c7b5[_0x366e54(0xe70)][_0x366e54(0xe12)]=_0x62457[_0x366e54(0xdc7)],_0x1f880d[_0x366e54(0x2ac)]=!![]);}else{if(!_0x1f880d[_0x366e54(0x116a)]&&_0x25da08){let _0x133c55=0x0;_0x54c7b5[_0x366e54(0xb75)]===0x1?_0x133c55=0.3:_0x133c55=0.8,console[_0x366e54(0x32b)](_0x366e54(0xa1a)+_0x54c7b5[_0x366e54(0xb75)]+_0x366e54(0x3fa)+_0x133c55*0x64+'%'),Math[_0x366e54(0x5b3)]()<_0x133c55?(console[_0x366e54(0x32b)]('AI女巫决定使用解药！'),_0x54c7b5[_0x366e54(0xe70)][_0x366e54(0x11dc)]=_0x54c7b5[_0x366e54(0xe70)][_0x366e54(0xdcc)],_0x1f880d[_0x366e54(0x116a)]=!![]):console[_0x366e54(0x32b)](_0x366e54(0x9c1));}if(!_0x54c7b5[_0x366e54(0xe70)][_0x366e54(0x11dc)]&&!_0x1f880d[_0x366e54(0x2ac)]&&Math[_0x366e54(0x5b3)]()<0.5){const _0x2a5cc8=_0x54c7b5[_0x366e54(0x4ae)][_0x366e54(0x1d8)](_0x287b87=>_0x287b87[_0x366e54(0x2f0)]&&_0x287b87['id']!==_0x54c7b5[_0x366e54(0xe70)][_0x366e54(0xdcc)]);if(_0x2a5cc8['length']>0x0){const _0x17bd32=_0x2a5cc8[Math['floor'](Math['random']()*_0x2a5cc8[_0x366e54(0x105a)])];_0x54c7b5[_0x366e54(0xe70)]['poisonedId']=_0x17bd32['id'],_0x1f880d['poisonUsed']=!![],console[_0x366e54(0x32b)](_0x366e54(0x128d)+_0x17bd32['name']);}}}_0x25990f(_0x366e54(0x2ed)),_0x46fe95(),await new Promise(_0x33d575=>setTimeout(_0x33d575,0x5dc));}const _0x2fc3e5=_0x54c7b5[_0x366e54(0x4ae)][_0x366e54(0x2ef)](_0x1dd0d3=>_0x1dd0d3[_0x366e54(0x14a)]===_0x366e54(0x10c0)&&_0x1dd0d3[_0x366e54(0x2f0)]);if(_0x2fc3e5){_0x25990f(_0x366e54(0x3b0)),_0x46fe95();if(_0x2fc3e5['id']==='user'){const _0x163677=await _0x3e036a(_0x366e54(0xb34)),_0xf0edf9=_0x54c7b5[_0x366e54(0x4ae)]['find'](_0x3ec971=>_0x3ec971['id']===_0x163677);if(_0xf0edf9){const _0x4cda7e=_0xf0edf9[_0x366e54(0x14a)]==='狼人';await _0x501c7b(_0x366e54(0xb6c),_0x366e54(0xe4a)+_0xf0edf9[_0x366e54(0x596)]+'\x20的身份是：'+(_0x4cda7e?'狼人':'好人')),_0x54c7b5[_0x366e54(0xe70)][_0x366e54(0x936)]={'target':_0x163677,'result':_0x4cda7e?'狼人':'好人'};}}else{const _0x43e374=_0x54c7b5[_0x366e54(0x4ae)]['filter'](_0x30d4c0=>_0x30d4c0['isAlive']&&_0x30d4c0['id']!==_0x2fc3e5['id']);if(_0x43e374[_0x366e54(0x105a)]>0x0){const _0x1e809a=_0x43e374[Math['floor'](Math[_0x366e54(0x5b3)]()*_0x43e374[_0x366e54(0x105a)])];_0x54c7b5[_0x366e54(0xe70)]['prophetCheck']={'target':_0x1e809a['id'],'result':_0x1e809a[_0x366e54(0x14a)]==='狼人'?'狼人':'好人'};}}_0x25990f(_0x366e54(0x8bf)),_0x46fe95(),await new Promise(_0x1357ba=>setTimeout(_0x1357ba,0x5dc));}_0x14205a();}async function _0x14205a(){const _0x18ac73=_0x18b51e;_0x54c7b5[_0x18ac73(0x752)]='第'+_0x54c7b5['currentDay']+_0x18ac73(0x1bd),_0x54c7b5[_0x18ac73(0x6b8)]={},_0x25990f('天亮了。');const {killedId:_0x213994,guardedId:_0xfc4d6,savedId:_0x2d8cc2,poisonedId:_0x5cb25f}=_0x54c7b5[_0x18ac73(0xe70)],_0x12f576=new Set();_0x213994&&_0x213994!==_0xfc4d6&&_0x213994!==_0x2d8cc2&&_0x12f576[_0x18ac73(0x3f4)](_0x213994);_0x5cb25f&&_0x12f576[_0x18ac73(0x3f4)](_0x5cb25f);if(_0x12f576['size']===0x0)_0x25990f(_0x18ac73(0x588));else for(const _0x243ef6 of _0x12f576){const _0x1f0616=_0x54c7b5['players']['find'](_0x5d15d3=>_0x5d15d3['id']===_0x243ef6);if(_0x1f0616&&_0x1f0616['isAlive']){_0x1f0616['isAlive']=![],_0x25990f(_0x18ac73(0x9c3)+_0x1f0616[_0x18ac73(0x596)]+_0x18ac73(0x18f));if(_0x1f0616[_0x18ac73(0x14a)]==='猎人'){_0x25990f(_0x18ac73(0x88d)),_0x46fe95();let _0x53e32d=null;if(_0x1f0616['id']==='user')_0x53e32d=await _0x3e036a('hunter');else{const _0x5ba69e=_0x54c7b5[_0x18ac73(0x4ae)][_0x18ac73(0x1d8)](_0xff99ba=>_0xff99ba[_0x18ac73(0x2f0)]&&_0xff99ba['id']!==_0x1f0616['id']);_0x5ba69e['length']>0x0&&(_0x53e32d=_0x5ba69e[Math['floor'](Math[_0x18ac73(0x5b3)]()*_0x5ba69e['length'])]['id']);}const _0x25bedd=_0x54c7b5[_0x18ac73(0x4ae)][_0x18ac73(0x2ef)](_0x1d11a6=>_0x1d11a6['id']===_0x53e32d);_0x25bedd&&(_0x25bedd[_0x18ac73(0x2f0)]=![],_0x25990f(_0x18ac73(0x210)+_0x25bedd['name']+'。'));}}}_0x46fe95();if(_0x264fef())return;await _0x15f23f();}async function _0x15f23f(){const _0x244280=_0x18b51e;_0x25990f(_0x244280(0x7f5)),_0x46fe95();const {proxyUrl:_0x403abd,apiKey:_0x25c6f6,model:_0x4e801b}=_0x405767['apiConfig'];if(!_0x403abd||!_0x25c6f6||!_0x4e801b){alert(_0x244280(0xed5));return;}const _0x393092=_0x2aa56a();_0x54c7b5[_0x244280(0x349)]='startDiscussion';try{await _0x501c7b(_0x244280(0x57b),_0x244280(0x242));let _0x239789=_0x403abd['includes'](_0x244280(0x3fe)),_0x1c6507=[{'role':_0x244280(0x74b),'content':'请所有AI角色根据你们的身份和人设开始发言。'}],_0x555b0e=_0x282b7e(_0x4e801b,_0x25c6f6,_0x393092,_0x1c6507);const _0x507b90=_0x239789?await fetch(_0x555b0e[_0x244280(0x9d6)],_0x555b0e[_0x244280(0x49a)]):await fetch(_0x403abd+_0x244280(0x5c1),{'method':_0x244280(0xcd0),'headers':{'Content-Type':'application/json','Authorization':_0x244280(0xf42)+_0x25c6f6},'body':JSON[_0x244280(0x1175)]({'model':_0x4e801b,'messages':[{'role':_0x244280(0x46c),'content':_0x393092},..._0x1c6507],'temperature':_0x405767[_0x244280(0xb73)][_0x244280(0x8c7)]||0.95})});if(!_0x507b90['ok']){const _0x329696=await _0x507b90[_0x244280(0x7e9)]();throw new Error('API\x20错误:\x20'+_0x329696[_0x244280(0x7a3)][_0x244280(0xc7d)]);}const _0x27faf1=await _0x507b90['json'](),_0x5b8edf=getGeminiResponseText(_0x27faf1),_0x740003=_0x5b8edf['match'](/(\[[\s\S]*\])/);if(!_0x740003)throw new Error(_0x244280(0x1185)+_0x5b8edf);const _0x2c8c29=JSON[_0x244280(0x10ab)](_0x740003[0x0]);for(const _0x599622 of _0x2c8c29){_0x599622['speaker_name']&&_0x599622[_0x244280(0x1028)]&&(_0xc3b03a(_0x599622['speaker_name'],_0x599622['dialogue']),_0x46fe95(),await new Promise(_0x2995ff=>setTimeout(_0x2995ff,0x5dc+Math[_0x244280(0x5b3)]()*0x7d0)));}_0x54c7b5[_0x244280(0x349)]=null;}catch(_0x3c6a57){console[_0x244280(0x7a3)](_0x244280(0x78f),_0x3c6a57),await _0x501c7b(_0x244280(0xee2),_0x244280(0x1168)+_0x3c6a57[_0x244280(0xc7d)]),document[_0x244280(0x8c2)]('werewolf-retry-btn')[_0x244280(0x842)]['display']=_0x244280(0xea7);return;}const _0x7d3cef=_0x54c7b5['players'][_0x244280(0x2ef)](_0x3c9d2c=>_0x3c9d2c['id']===_0x244280(0x74b)),_0x520927=document[_0x244280(0x8c2)]('werewolf-action-bar'),_0x292897=document['getElementById'](_0x244280(0x10aa)),_0x4bf9f0=document[_0x244280(0x8c2)]('werewolf-finish-speech-btn'),_0x4b6aa9=document[_0x244280(0x8c2)](_0x244280(0x112b));_0x520927[_0x244280(0x842)][_0x244280(0x5e9)]=_0x244280(0xd52);if(_0x7d3cef&&_0x7d3cef[_0x244280(0x2f0)]){_0x292897[_0x244280(0x1090)]=_0x244280(0x7ce),_0x4bf9f0[_0x244280(0x1090)]=_0x244280(0xde2),_0x292897[_0x244280(0x842)][_0x244280(0x5e9)]=_0x244280(0xea7),_0x4bf9f0[_0x244280(0x842)][_0x244280(0x5e9)]=_0x244280(0xea7),_0x4b6aa9[_0x244280(0x1033)]=![],_0x4b6aa9[_0x244280(0x691)]=_0x244280(0x7e3),_0x4b6aa9['focus']();const _0x2980f7=_0x292897[_0x244280(0xac5)](!![]);_0x292897[_0x244280(0xe66)]['replaceChild'](_0x2980f7,_0x292897),_0x2980f7[_0x244280(0xae8)](_0x244280(0xa17),_0x16e4e3);const _0x5758f9=_0x4bf9f0[_0x244280(0xac5)](!![]);_0x4bf9f0['parentNode'][_0x244280(0x56b)](_0x5758f9,_0x4bf9f0),_0x5758f9[_0x244280(0xae8)](_0x244280(0xa17),_0x13dbe7);}else{_0x25990f('你已经死亡，无法发言。请等待其他玩家发言结束。'),_0x46fe95(),_0x292897['textContent']='继续讨论',_0x4bf9f0[_0x244280(0x1090)]=_0x244280(0x11d3),_0x292897['style'][_0x244280(0x5e9)]=_0x244280(0xea7),_0x4bf9f0[_0x244280(0x842)][_0x244280(0x5e9)]=_0x244280(0xea7),_0x4b6aa9[_0x244280(0x1033)]=!![],_0x4b6aa9[_0x244280(0x691)]='你已死亡，正在围观...';const _0xddfe1a=_0x292897[_0x244280(0xac5)](!![]);_0x292897['parentNode'][_0x244280(0x56b)](_0xddfe1a,_0x292897),_0xddfe1a[_0x244280(0xae8)]('click',_0xb6a192);const _0x1ada85=_0x4bf9f0[_0x244280(0xac5)](!![]);_0x4bf9f0[_0x244280(0xe66)][_0x244280(0x56b)](_0x1ada85,_0x4bf9f0),_0x1ada85[_0x244280(0xae8)](_0x244280(0xa17),_0xa06689);}}function _0x2aa56a(){const _0x8738be=_0x18b51e,_0x4dfe6a=_0x54c7b5[_0x8738be(0x4ae)][_0x8738be(0x1d8)](_0x11a19c=>_0x11a19c['isAlive']),_0x3748d7=_0x54c7b5[_0x8738be(0x4ae)][_0x8738be(0x2ef)](_0x49219c=>_0x49219c['id']==='user'),_0x10cce7=_0x3748d7?_0x3748d7[_0x8738be(0x596)]:'用户',_0x4e98e3=_0x4dfe6a[_0x8738be(0xdc3)](_0x3a3e5c=>_0x3a3e5c['id']===_0x8738be(0x74b));let _0x3534ab=_0x8738be(0xcfe);_0x4dfe6a['forEach']((_0x5268fc,_0x21f0a6)=>{const _0x1c0175=_0x8738be,_0x5c2bec=_0x54c7b5[_0x1c0175(0x4ae)][_0x1c0175(0x1149)](_0x212cab=>_0x212cab['id']===_0x5268fc['id'])+0x1;_0x3534ab+='\x0a##\x20'+_0x5c2bec+_0x1c0175(0x1240)+_0x5268fc[_0x1c0175(0x596)]+'\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20'+_0x5268fc[_0x1c0175(0x4e7)]+_0x1c0175(0x6c6)+(_0x5268fc['id']===_0x1c0175(0x74b)?_0x1c0175(0x7c6):'【AI角色】')+_0x1c0175(0xcf2)+_0x5268fc[_0x1c0175(0xced)]+'\x0a';if(_0x5268fc[_0x1c0175(0xde0)]==='character'){const _0x35c9e1=_0x405767[_0x1c0175(0x799)][_0x5268fc['id']];if(_0x35c9e1&&_0x35c9e1[_0x1c0175(0xbca)]&&_0x35c9e1[_0x1c0175(0xbca)]['length']>0x0){const _0xc4e760=_0x35c9e1[_0x1c0175(0xbca)][_0x1c0175(0x6b9)](_0x5dbac4=>_0x5dbac4[_0x1c0175(0x168)])['join'](';\x20');_0x3534ab+=_0x1c0175(0xc2c)+_0xc4e760+'\x0a';}}});let _0x68bb55=_0x8738be(0xa18);const _0xf0c286=_0x54c7b5[_0x8738be(0x87b)][_0x8738be(0x1d8)](_0x966ca1=>_0x966ca1[_0x8738be(0x168)]['includes'](_0x8738be(0x2c3))&&_0x966ca1[_0x8738be(0x9f0)]===_0x54c7b5[_0x8738be(0xb75)]);_0xf0c286[_0x8738be(0x105a)]===0x0?_0x68bb55+=_0x8738be(0x13e):_0xf0c286['forEach'](_0x345cb7=>{const _0x5c4c25=_0x8738be;_0x68bb55+='-\x20'+_0x345cb7[_0x5c4c25(0x168)]+'\x0a';});let _0xbfda1f=_0x8738be(0x950);if(_0x54c7b5['currentDay']>0x1)for(let _0x113721=0x1;_0x113721<_0x54c7b5['currentDay'];_0x113721++){_0xbfda1f+=_0x8738be(0x14e)+_0x113721+_0x8738be(0x627);const _0x2fa68a=_0x54c7b5[_0x8738be(0x87b)]['filter'](_0x1da7f3=>_0x1da7f3[_0x8738be(0x9f0)]===_0x113721&&(_0x1da7f3['content'][_0x8738be(0x773)]('死亡')||_0x1da7f3[_0x8738be(0x168)][_0x8738be(0x773)]('放逐')));_0x2fa68a[_0x8738be(0x105a)]>0x0?_0xbfda1f+=_0x8738be(0x1134)+_0x2fa68a[_0x8738be(0x6b9)](_0x2b00fe=>_0x2b00fe['content'])['join']('\x20')+'\x0a':_0xbfda1f+=_0x8738be(0xb5d);const _0x2a999c=_0x54c7b5[_0x8738be(0xc69)][_0x8738be(0x1d8)](_0x2e899d=>_0x2e899d[_0x8738be(0x9f0)]===_0x113721);_0x2a999c['length']>0x0&&(_0xbfda1f+=_0x8738be(0x81c)+_0x2a999c[_0x8738be(0x6b9)](_0x273970=>'-\x20'+_0x273970[_0x8738be(0xa76)]+':\x20'+_0x273970[_0x8738be(0x168)])['join']('\x0a')+'\x0a');}else _0xbfda1f+=_0x8738be(0xd46);let _0x4547f2=_0x8738be(0x102b);_0x4dfe6a[_0x8738be(0x7c0)](_0x1371d6=>{const _0x2f08de=_0x8738be;if(_0x1371d6['id']!==_0x2f08de(0x74b)){_0x4547f2+=_0x2f08de(0x6db)+_0x1371d6[_0x2f08de(0x596)]+_0x2f08de(0xfef)+_0x1371d6['role']+'】\x0a';if(_0x1371d6['role']==='狼人'){const _0x270fa6=_0x54c7b5[_0x2f08de(0x4ae)][_0x2f08de(0x1d8)](_0xe01c9c=>_0xe01c9c[_0x2f08de(0x14a)]==='狼人'&&_0xe01c9c['id']!==_0x1371d6['id'])[_0x2f08de(0x6b9)](_0x130d43=>_0x130d43[_0x2f08de(0x596)])['join']('、');_0x4547f2+='-\x20你的狼队友是：'+(_0x270fa6||'无')+'\x0a';const _0x4c40ba=_0x54c7b5['players'][_0x2f08de(0x2ef)](_0x8fc94f=>_0x8fc94f['id']===_0x54c7b5['nightActions']['killedId']);_0x4547f2+='-\x20你们昨晚尝试攻击的玩家是：'+(_0x4c40ba?_0x4c40ba[_0x2f08de(0x596)]:'空刀')+'\x0a';}if(_0x1371d6[_0x2f08de(0x14a)]===_0x2f08de(0x10c0)&&_0x54c7b5[_0x2f08de(0xe70)][_0x2f08de(0x936)]){const _0x578b5e=_0x54c7b5['players'][_0x2f08de(0x2ef)](_0xf65927=>_0xf65927['id']===_0x54c7b5[_0x2f08de(0xe70)][_0x2f08de(0x936)][_0x2f08de(0x475)]);_0x4547f2+=_0x2f08de(0x502)+_0x578b5e[_0x2f08de(0x596)]+_0x2f08de(0xea1)+_0x54c7b5[_0x2f08de(0xe70)][_0x2f08de(0x936)][_0x2f08de(0xa92)]+'】\x0a';}if(_0x1371d6[_0x2f08de(0x14a)]==='女巫'){if(_0x54c7b5[_0x2f08de(0xe70)][_0x2f08de(0x11dc)]){const _0x35255c=_0x54c7b5[_0x2f08de(0x4ae)][_0x2f08de(0x2ef)](_0x41477e=>_0x41477e['id']===_0x54c7b5['nightActions'][_0x2f08de(0x11dc)]);_0x4547f2+='-\x20你昨晚用解药救了\x20'+_0x35255c[_0x2f08de(0x596)]+'。\x0a';}if(_0x54c7b5[_0x2f08de(0xe70)]['poisonedId']){const _0x27004c=_0x54c7b5[_0x2f08de(0x4ae)][_0x2f08de(0x2ef)](_0x36476c=>_0x36476c['id']===_0x54c7b5[_0x2f08de(0xe70)]['poisonedId']);_0x4547f2+=_0x2f08de(0xdf6)+_0x27004c[_0x2f08de(0x596)]+'。\x0a';}_0x4547f2+=_0x2f08de(0xdc9)+(_0x1371d6[_0x2f08de(0x116a)]?_0x2f08de(0x451):_0x2f08de(0x977))+'\x0a',_0x4547f2+=_0x2f08de(0x1178)+(_0x1371d6[_0x2f08de(0x2ac)]?'已使用':_0x2f08de(0x977))+'\x0a';}if(_0x1371d6[_0x2f08de(0x14a)]==='守卫'){if(_0x54c7b5[_0x2f08de(0xe70)][_0x2f08de(0xbd3)]){const _0x46c9d8=_0x54c7b5['players'][_0x2f08de(0x2ef)](_0x5a5f73=>_0x5a5f73['id']===_0x54c7b5[_0x2f08de(0xe70)][_0x2f08de(0xbd3)]);_0x4547f2+=_0x2f08de(0xf6f)+_0x46c9d8[_0x2f08de(0x596)]+'。\x0a';}else _0x4547f2+='-\x20你昨晚空守了。\x0a';}_0x4547f2+='\x0a';}});let _0x3133c1='#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a';const _0x47b5f7=_0x54c7b5[_0x8738be(0xc69)][_0x8738be(0x1d8)](_0x3ebbd1=>_0x3ebbd1[_0x8738be(0x9f0)]===_0x54c7b5['currentDay']);_0x47b5f7['length']>0x0?_0x3133c1+=_0x47b5f7[_0x8738be(0x6b9)](_0x4ed521=>_0x8738be(0xc39)+_0x4ed521['speaker']+'**:\x20'+_0x4ed521['content'])[_0x8738be(0xb2c)]('\x0a'):_0x3133c1+=_0x8738be(0x1294);const _0x128d52=_0x8738be(0xa99)+(_0x4e98e3?_0x8738be(0x4b2)+_0x10cce7+')':_0x8738be(0x19f)+_0x10cce7+')')+'以外】的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a'+_0x3534ab+_0x8738be(0x1055)+(_0x54c7b5[_0x8738be(0x648)]==='12p'?_0x8738be(0x9f7):_0x8738be(0x1085))+'\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20'+_0x54c7b5[_0x8738be(0xb75)]+_0x8738be(0x367)+_0x68bb55+_0x8738be(0xbc1)+_0x4dfe6a[_0x8738be(0x6b9)](_0x176189=>_0x176189[_0x8738be(0x596)]+'\x20('+(_0x176189['id']===_0x8738be(0x74b)?'用户':'AI')+')')['join'](',\x20')+_0x8738be(0xb2e)+_0x10cce7+'\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a\x0a//\x20【核心修改2】明确了JSON格式中\x20speaker_name\x20和对话中称呼的不同要求\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20'+_0xbfda1f+_0x8738be(0xc8b)+_0x3133c1+'\x0a\x0a'+_0x4547f2+'\x0a\x0a现在，请为所有【存活的AI角色】生成他们充满策略和博弈的发言。';return _0x128d52;}function _0x43fab4(_0x2de56e){const _0x3162d4=_0x18b51e;let _0x28bccb=_0x3162d4(0xd4d);const _0x47e11f=_0x2de56e[_0x3162d4(0x87b)][_0x3162d4(0x2ef)](_0x5b3d93=>_0x5b3d93['content'][_0x3162d4(0x773)]('胜利'))?.[_0x3162d4(0x168)]||'胜负未分';_0x28bccb+=_0x3162d4(0x8c9)+_0x47e11f+'\x0a\x0a',_0x28bccb+=_0x3162d4(0x1234),_0x2de56e[_0x3162d4(0x4ae)][_0x3162d4(0x7c0)](_0x4cfef0=>{const _0x571add=_0x3162d4,_0x25421b=_0x4cfef0[_0x571add(0x2f0)]?'存活':'已死亡';_0x28bccb+='-\x20'+_0x4cfef0['name']+':\x20'+_0x4cfef0[_0x571add(0x14a)]+'\x20('+_0x25421b+')\x0a';}),_0x28bccb+=_0x3162d4(0x5b0);for(let _0x1c96f7=0x1;_0x1c96f7<=_0x2de56e[_0x3162d4(0xb75)];_0x1c96f7++){_0x28bccb+=_0x3162d4(0x14e)+_0x1c96f7+_0x3162d4(0x627);const _0x3845a0=_0x2de56e[_0x3162d4(0x87b)][_0x3162d4(0x1d8)](_0x395f1b=>_0x395f1b[_0x3162d4(0x9f0)]===_0x1c96f7&&_0x395f1b[_0x3162d4(0x168)][_0x3162d4(0x773)]('死亡'));if(_0x3845a0['length']>0x0)_0x28bccb+='**[夜晚]**\x20'+_0x3845a0[_0x3162d4(0x6b9)](_0x4fcb8f=>_0x4fcb8f[_0x3162d4(0x168)])[_0x3162d4(0xb2c)]('\x20')+'\x0a';else(_0x1c96f7>0x1||_0x1c96f7===0x1&&_0x2de56e[_0x3162d4(0xb75)]>0x1)&&(_0x28bccb+='**[夜晚]**\x20平安夜。\x0a');const _0x37b342=_0x2de56e[_0x3162d4(0xc69)][_0x3162d4(0x1d8)](_0x3027e2=>_0x3027e2[_0x3162d4(0x9f0)]===_0x1c96f7);_0x37b342[_0x3162d4(0x105a)]>0x0&&(_0x28bccb+=_0x3162d4(0x243)+_0x37b342[_0x3162d4(0x6b9)](_0x53d0c2=>'-\x20'+_0x53d0c2[_0x3162d4(0xa76)]+':\x20'+_0x53d0c2[_0x3162d4(0x168)])[_0x3162d4(0xb2c)]('\x0a')+'\x0a');const _0x4f1bbc=_0x2de56e[_0x3162d4(0x87b)][_0x3162d4(0x2ef)](_0x24efc8=>_0x24efc8[_0x3162d4(0x9f0)]===_0x1c96f7&&_0x24efc8[_0x3162d4(0x168)][_0x3162d4(0x773)](_0x3162d4(0x781)));_0x4f1bbc&&(_0x28bccb+=_0x3162d4(0x2b0)+_0x4f1bbc[_0x3162d4(0x168)]+'\x0a');}return _0x28bccb+=_0x3162d4(0xc07),_0x28bccb;}async function _0x17daa4(_0x2952b8){const _0x2652e7=_0x18b51e;let _0xac8188=0x0;for(const _0x3cebfb of _0x54c7b5[_0x2652e7(0x4ae)]){if(_0x3cebfb['type']===_0x2652e7(0xd16)){const _0x3d916d=_0x405767[_0x2652e7(0x799)][_0x3cebfb['id']];if(_0x3d916d){const _0x216088={'content':_0x2952b8,'timestamp':Date['now'](),'source':'werewolf_summary'};!_0x3d916d[_0x2652e7(0xbca)]&&(_0x3d916d[_0x2652e7(0xbca)]=[]),_0x3d916d['longTermMemory'][_0x2652e7(0xa49)](_0x216088),await _0x15043e[_0x2652e7(0x799)][_0x2652e7(0xfaa)](_0x3d916d),_0xac8188++;}}}return _0xac8188;}async function _0x9c04b8(){const _0x104f23=_0x18b51e;if(!_0x54c7b5[_0x104f23(0x6f0)]&&_0x54c7b5[_0x104f23(0x752)]===_0x104f23(0xb9a)){await _0x501c7b('请稍候...',_0x104f23(0x93b));try{const _0x34afde=_0x43fab4(_0x54c7b5),_0x4cf926=await _0x17daa4(_0x34afde);await _0x501c7b('成功',_0x104f23(0xcc1)+_0x4cf926+'\x20位AI角色的长期记忆中！');}catch(_0x1fcf11){console[_0x104f23(0x7a3)]('手动注入狼人杀记忆失败:',_0x1fcf11),await _0x501c7b('失败',_0x104f23(0x5f5)+_0x1fcf11[_0x104f23(0xc7d)]);}}else alert('游戏尚未结束，无法进行总结。');}async function _0xbe5df0(_0x51b34e){const _0x376ae2=_0x18b51e;_0x54c7b5['isActive']=![],_0x54c7b5['currentPhase']=_0x376ae2(0xb9a),_0x25990f(_0x51b34e+_0x376ae2(0x861)),document[_0x376ae2(0x8c2)]('werewolf-game-over-title')[_0x376ae2(0x1090)]=_0x51b34e+'胜利！';let _0x5939f4='';_0x51b34e==='好人'?_0x5939f4=_0x376ae2(0xaa3):_0x5939f4=_0x376ae2(0xa25);const _0x39bbb3=document[_0x376ae2(0x8c2)](_0x376ae2(0xd9f));_0x39bbb3[_0x376ae2(0x1090)]=_0x5939f4;const _0x40d9a=document[_0x376ae2(0x8c2)](_0x376ae2(0xcad));_0x40d9a[_0x376ae2(0xca0)]='';const _0x23b6e2=[..._0x54c7b5['players']][_0x376ae2(0xa19)]((_0x134882,_0x34fcc8)=>{const _0x10a25a=_0x376ae2,_0x4d622f=_0x54c7b5[_0x10a25a(0x4ae)][_0x10a25a(0x1149)](_0x4bed1c=>_0x4bed1c['id']===_0x134882['id']),_0x40b9a9=_0x54c7b5[_0x10a25a(0x4ae)][_0x10a25a(0x1149)](_0x1b2353=>_0x1b2353['id']===_0x34fcc8['id']);return _0x4d622f-_0x40b9a9;});_0x23b6e2[_0x376ae2(0x7c0)]((_0x46a27b,_0x4865fb)=>{const _0x432be4=_0x376ae2,_0x5b5b85=document[_0x432be4(0x8c1)]('div');_0x5b5b85['style'][_0x432be4(0x1d0)]=_0x432be4(0x11a4);if(_0x4865fb===_0x23b6e2[_0x432be4(0x105a)]-0x1)_0x5b5b85[_0x432be4(0x842)]['borderBottom']=_0x432be4(0xbf8);const _0x4e4f7d=_0x46a27b[_0x432be4(0x14a)]==='狼人'?'#ff4d4d':'#52c41a';_0x5b5b85[_0x432be4(0xca0)]=_0x432be4(0x3c6)+_0x46a27b[_0x432be4(0x1e1)]+_0x432be4(0x581)+(_0x46a27b[_0x432be4(0x2f0)]?_0x432be4(0xbf8):_0x432be4(0xb58))+_0x432be4(0x365)+(_0x46a27b[_0x432be4(0x2f0)]?'none':_0x432be4(0x2bd))+_0x432be4(0xb81)+(_0x4865fb+0x1)+'.\x20'+_0x46a27b[_0x432be4(0x596)]+_0x432be4(0x3d5)+_0x4e4f7d+';\x22>'+_0x46a27b['role']+_0x432be4(0x1030),_0x40d9a[_0x432be4(0x31e)](_0x5b5b85);}),document[_0x376ae2(0x8c2)]('werewolf-game-over-modal')[_0x376ae2(0xb17)][_0x376ae2(0x3f4)](_0x376ae2(0x2cd));try{console['log'](_0x376ae2(0x20b));const _0x47e78c=_0x43fab4(_0x54c7b5),_0x3561ab=await generateAndInjectWerewolfMemories(_0x47e78c);console[_0x376ae2(0x32b)]('狼人杀游戏总结已自动存入\x20'+_0x3561ab+_0x376ae2(0xff8));}catch(_0x2c33e2){console['error']('自动总结狼人杀游戏失败:',_0x2c33e2),_0x39bbb3&&(_0x39bbb3[_0x376ae2(0xca0)]+=_0x376ae2(0x159));}}function _0x25990f(_0x5deaa1){const _0x28e77a=_0x18b51e;_0x54c7b5['gameLog'][_0x28e77a(0xa49)]({'type':_0x28e77a(0x46c),'content':_0x5deaa1,'timestamp':Date[_0x28e77a(0x1ed)](),'day':_0x54c7b5[_0x28e77a(0xb75)]});}function _0xc3b03a(_0x3c231e,_0x3aab63){const _0x4959a5=_0x18b51e;_0x54c7b5['discussionLog'][_0x4959a5(0xa49)]({'type':_0x4959a5(0x1028),'speaker':_0x3c231e,'content':_0x3aab63,'timestamp':Date[_0x4959a5(0x1ed)](),'day':_0x54c7b5['currentDay']});}function _0x3e036a(_0x53b165){return new Promise(_0x3568c0=>{const _0x4a795e=_0x7a65,_0x6abf56=_0x4a795e(0x3ba)+_0x53b165+'-modal',_0xf9d5cc=_0x4a795e(0x3ba)+_0x53b165+_0x4a795e(0xa4e);let _0x269230='';if(_0x53b165==='prophet')_0x269230='confirm-prophet-check-btn';if(_0x53b165===_0x4a795e(0x95e))_0x269230=_0x4a795e(0x107d);if(_0x53b165===_0x4a795e(0x1213))_0x269230='confirm-vote-btn';const _0x586810=document[_0x4a795e(0x8c2)](_0x6abf56),_0x5e6136=document[_0x4a795e(0x8c2)](_0xf9d5cc),_0x31bf26=document[_0x4a795e(0x8c2)](_0x269230);_0x5e6136['innerHTML']='';let _0x471bf1=null;const _0x32b711=_0x54c7b5[_0x4a795e(0x4ae)][_0x4a795e(0x1d8)](_0x3eacb3=>_0x3eacb3[_0x4a795e(0x2f0)]&&(_0x53b165===_0x4a795e(0x95e)||_0x53b165===_0x4a795e(0x1213)||_0x3eacb3['id']!==_0x4a795e(0x74b)));_0x32b711[_0x4a795e(0x7c0)](_0x138e65=>{const _0x4c710a=_0x4a795e,_0x5a491=document['createElement'](_0x4c710a(0x1072));_0x5a491[_0x4c710a(0x84c)]=_0x4c710a(0x382),_0x5a491[_0x4c710a(0x323)]['id']=_0x138e65['id'],_0x5a491[_0x4c710a(0xca0)]=_0x4c710a(0x333)+_0x138e65[_0x4c710a(0x1e1)]+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0x138e65['name']+_0x4c710a(0x688),_0x5a491['onclick']=()=>{const _0x1ed169=_0x4c710a;_0x5e6136[_0x1ed169(0xa2d)](_0x1ed169(0x172))[_0x1ed169(0x7c0)](_0x735308=>_0x735308[_0x1ed169(0xb17)][_0x1ed169(0xaff)](_0x1ed169(0x118f))),_0x5a491['classList']['add']('selected'),_0x471bf1=_0x138e65['id'];},_0x5e6136[_0x4c710a(0x31e)](_0x5a491);});const _0x3fda89=_0x31bf26['cloneNode'](!![]);_0x31bf26[_0x4a795e(0xe66)][_0x4a795e(0x56b)](_0x3fda89,_0x31bf26),_0x3fda89[_0x4a795e(0xcda)]=()=>{const _0x11dba6=_0x4a795e;_0x471bf1?(_0x586810[_0x11dba6(0xb17)][_0x11dba6(0xaff)](_0x11dba6(0x2cd)),_0x3568c0(_0x471bf1)):alert(_0x11dba6(0xee5));},_0x586810[_0x4a795e(0xb17)][_0x4a795e(0x3f4)](_0x4a795e(0x2cd));});}function _0x2a8263(){return new Promise(_0x55d36a=>{const _0x2e25c8=_0x7a65,_0x1dbfae=document[_0x2e25c8(0x8c2)]('werewolf-kill-modal'),_0x3e3e42=document[_0x2e25c8(0x8c2)](_0x2e25c8(0xd42)),_0x2eff9b=document[_0x2e25c8(0x8c2)](_0x2e25c8(0x6d8)),_0x1a1f0e=_0x1dbfae[_0x2e25c8(0x1ad)](_0x2e25c8(0xe9d)),_0x527db3=_0x54c7b5['players'][_0x2e25c8(0x1d8)](_0x84f677=>_0x84f677[_0x2e25c8(0x14a)]==='狼人'&&_0x84f677[_0x2e25c8(0x2f0)]),_0x545e28=_0x527db3[_0x2e25c8(0x1d8)](_0x1f0c18=>_0x1f0c18['id']!=='user')[_0x2e25c8(0x6b9)](_0x505036=>_0x505036[_0x2e25c8(0x596)])['join']('、');_0x545e28?_0x1a1f0e[_0x2e25c8(0xca0)]='狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20'+_0x545e28+'</small>':_0x1a1f0e[_0x2e25c8(0x1090)]='狼人请选择刀人对象';_0x3e3e42[_0x2e25c8(0xca0)]='';let _0x192fb0=null;const _0x1947ab=_0x54c7b5[_0x2e25c8(0x4ae)][_0x2e25c8(0x1d8)](_0x4b3fa8=>_0x4b3fa8[_0x2e25c8(0x2f0)]&&_0x4b3fa8[_0x2e25c8(0x14a)]!=='狼人');_0x1947ab['forEach'](_0x4def04=>{const _0x543347=_0x2e25c8,_0x4739b2=document[_0x543347(0x8c1)](_0x543347(0x1072));_0x4739b2[_0x543347(0x84c)]=_0x543347(0x382),_0x4739b2[_0x543347(0x323)]['id']=_0x4def04['id'],_0x4739b2[_0x543347(0xca0)]=_0x543347(0x333)+_0x4def04['avatar']+_0x543347(0x225)+_0x4def04['name']+_0x543347(0x688),_0x4739b2[_0x543347(0xcda)]=()=>{const _0x9d8543=_0x543347;_0x3e3e42[_0x9d8543(0xa2d)](_0x9d8543(0x172))[_0x9d8543(0x7c0)](_0x36e338=>_0x36e338[_0x9d8543(0xb17)][_0x9d8543(0xaff)](_0x9d8543(0x118f))),_0x4739b2[_0x9d8543(0xb17)][_0x9d8543(0x3f4)]('selected'),_0x192fb0=_0x4def04['id'];},_0x3e3e42['appendChild'](_0x4739b2);});const _0x1dcdfa=_0x2eff9b[_0x2e25c8(0xac5)](!![]);_0x2eff9b['parentNode'][_0x2e25c8(0x56b)](_0x1dcdfa,_0x2eff9b),_0x1dcdfa[_0x2e25c8(0xcda)]=()=>{_0x192fb0?(_0x1dbfae['classList']['remove']('visible'),_0x55d36a(_0x192fb0)):alert('请选择一个目标。');},_0x1dbfae[_0x2e25c8(0xb17)]['add'](_0x2e25c8(0x2cd));});}function _0x13dbe7(){const _0x1bc385=_0x18b51e,_0x1707ec=_0x54c7b5[_0x1bc385(0x4ae)][_0x1bc385(0x2ef)](_0x468e2a=>_0x468e2a['id']===_0x1bc385(0x74b));if(!_0x1707ec||!_0x1707ec[_0x1bc385(0x2f0)])return;const _0x1f57b3=document['getElementById'](_0x1bc385(0x112b)),_0x425baa=_0x1f57b3[_0x1bc385(0x518)][_0x1bc385(0x8c6)]();_0x425baa&&(_0xc3b03a(_0x1707ec[_0x1bc385(0x596)],_0x425baa),_0x46fe95()),document['getElementById']('werewolf-action-bar')['style'][_0x1bc385(0x5e9)]=_0x1bc385(0xbf8),_0x1f57b3[_0x1bc385(0x518)]='',_0xa06689();}async function _0xb6a192(){const _0x1af7d4=_0x18b51e;_0x25990f(_0x1af7d4(0xd59)),_0x46fe95();const _0x9eccc7=document[_0x1af7d4(0x8c2)](_0x1af7d4(0x10aa));if(_0x9eccc7)_0x9eccc7[_0x1af7d4(0x1033)]=!![];await _0x501c7b('请稍候','正在等待AI角色们继续讨论...');const {proxyUrl:_0x4ad206,apiKey:_0x5b42ed,model:_0x522372}=_0x405767[_0x1af7d4(0x9e0)];if(!_0x4ad206||!_0x5b42ed||!_0x522372){alert(_0x1af7d4(0xed5));return;}const _0x5528e7=_0x2aa56a();try{let _0x3309ef=_0x4ad206[_0x1af7d4(0x773)](_0x1af7d4(0x3fe)),_0x3ed0bc=[{'role':_0x1af7d4(0x74b),'content':_0x1af7d4(0x5c0)}],_0x546ea2=_0x282b7e(_0x522372,_0x5b42ed,_0x5528e7,_0x3ed0bc);const _0x23a04e=_0x3309ef?await fetch(_0x546ea2[_0x1af7d4(0x9d6)],_0x546ea2[_0x1af7d4(0x49a)]):await fetch(_0x4ad206+_0x1af7d4(0x5c1),{'method':_0x1af7d4(0xcd0),'headers':{'Content-Type':_0x1af7d4(0xcb6),'Authorization':_0x1af7d4(0xf42)+_0x5b42ed},'body':JSON['stringify']({'model':_0x522372,'messages':[{'role':_0x1af7d4(0x46c),'content':_0x5528e7},..._0x3ed0bc],'temperature':_0x405767['globalSettings'][_0x1af7d4(0x8c7)]||0.9})});if(!_0x23a04e['ok']){const _0x42df2f=await _0x23a04e['json']();throw new Error('API\x20错误:\x20'+_0x42df2f[_0x1af7d4(0x7a3)]['message']);}const _0xcf4c8c=await _0x23a04e[_0x1af7d4(0x7e9)](),_0x5a7743=getGeminiResponseText(_0xcf4c8c),_0x5856d3=_0x5a7743[_0x1af7d4(0xdf8)](/(\[[\s\S]*\])/);if(!_0x5856d3)throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x5a7743);const _0x2eed0e=JSON[_0x1af7d4(0x10ab)](_0x5856d3[0x0]);for(const _0x40f897 of _0x2eed0e){_0x40f897[_0x1af7d4(0x1037)]&&_0x40f897[_0x1af7d4(0x1028)]&&(_0xc3b03a(_0x40f897[_0x1af7d4(0x1037)],_0x40f897[_0x1af7d4(0x1028)]),_0x46fe95(),await new Promise(_0x331005=>setTimeout(_0x331005,0x5dc+Math[_0x1af7d4(0x5b3)]()*0x7d0)));}}catch(_0x32c33b){console[_0x1af7d4(0x7a3)](_0x1af7d4(0x45a),_0x32c33b),await _0x501c7b('AI\x20发言失败',_0x1af7d4(0x350)+_0x32c33b[_0x1af7d4(0xc7d)]);}finally{if(_0x9eccc7)_0x9eccc7[_0x1af7d4(0x1033)]=![];}}async function _0x16e4e3(){const _0x468115=_0x18b51e,_0x4affb4=_0x54c7b5['players']['find'](_0x2e93b0=>_0x2e93b0['id']===_0x468115(0x74b));if(!_0x4affb4||!_0x4affb4[_0x468115(0x2f0)]){console['warn'](_0x468115(0xee9));return;}const _0x1b62a7=document[_0x468115(0x8c2)](_0x468115(0x112b)),_0x3a2ff3=_0x1b62a7[_0x468115(0x518)][_0x468115(0x8c6)]();if(!_0x3a2ff3){alert(_0x468115(0xbbc));return;}_0xc3b03a(_0x4affb4[_0x468115(0x596)],_0x3a2ff3),_0x46fe95(),_0x1b62a7['value']='',await _0x501c7b(_0x468115(0x57b),_0x468115(0x8e4));const {proxyUrl:_0x19b91e,apiKey:_0x564f16,model:_0x5d9914}=_0x405767[_0x468115(0x9e0)];if(!_0x19b91e||!_0x564f16||!_0x5d9914){alert(_0x468115(0xed5));return;}const _0x4c9c54=_0x2aa56a();try{let _0x1572ca=_0x19b91e[_0x468115(0x773)](_0x468115(0x3fe)),_0x2e505c=[{'role':_0x468115(0x74b),'content':_0x468115(0x3c0)+_0x4affb4[_0x468115(0x596)]+_0x468115(0x472)}],_0xca40=_0x282b7e(_0x5d9914,_0x564f16,_0x4c9c54,_0x2e505c);const _0x5c6787=_0x1572ca?await fetch(_0xca40[_0x468115(0x9d6)],_0xca40[_0x468115(0x49a)]):await fetch(_0x19b91e+'/v1/chat/completions',{'method':_0x468115(0xcd0),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x564f16},'body':JSON[_0x468115(0x1175)]({'model':_0x5d9914,'messages':[{'role':'system','content':_0x4c9c54},..._0x2e505c],'temperature':_0x405767[_0x468115(0xb73)][_0x468115(0x8c7)]||0.9})});if(!_0x5c6787['ok']){const _0x584187=await _0x5c6787[_0x468115(0x7e9)]();throw new Error(_0x468115(0xd83)+_0x584187[_0x468115(0x7a3)][_0x468115(0xc7d)]);}const _0x345484=await _0x5c6787['json'](),_0x34b592=getGeminiResponseText(_0x345484),_0x58b1f8=_0x34b592[_0x468115(0xdf8)](/(\[[\s\S]*\])/);if(!_0x58b1f8)throw new Error(_0x468115(0x119d)+_0x34b592);const _0x443039=JSON['parse'](_0x58b1f8[0x0]);for(const _0xcc1428 of _0x443039){_0xcc1428[_0x468115(0x1037)]&&_0xcc1428[_0x468115(0x1028)]&&(_0xc3b03a(_0xcc1428['speaker_name'],_0xcc1428[_0x468115(0x1028)]),_0x46fe95(),await new Promise(_0x3b1fcb=>setTimeout(_0x3b1fcb,0x5dc+Math[_0x468115(0x5b3)]()*0x7d0)));}}catch(_0x535754){console[_0x468115(0x7a3)]('狼人杀AI回应生成失败:',_0x535754),await _0x501c7b('AI\x20发言失败',_0x468115(0x350)+_0x535754[_0x468115(0xc7d)]);}}async function _0xa06689(){const _0x53a629=_0x18b51e;_0x25990f(_0x53a629(0xea5)),_0x46fe95(),_0x54c7b5[_0x53a629(0x2ab)]={};let _0x53475=null;_0x54c7b5[_0x53a629(0x349)]=_0x53a629(0xf1f);try{_0x53475=await _0x4a67d9(),_0x53475&&_0x53475[_0x53a629(0x7c0)](_0x5cd2d0=>{const _0x20c77b=_0x53a629,_0x77deeb=_0x54c7b5[_0x20c77b(0x4ae)]['find'](_0x359cf2=>_0x359cf2['name']===_0x5cd2d0['voter_name']),_0x354342=_0x54c7b5[_0x20c77b(0x4ae)][_0x20c77b(0x2ef)](_0x85bd5b=>_0x85bd5b[_0x20c77b(0x596)]===_0x5cd2d0[_0x20c77b(0x638)]);_0x77deeb&&_0x77deeb[_0x20c77b(0x2f0)]&&_0x354342&&(_0x54c7b5['votes'][_0x77deeb[_0x20c77b(0x596)]]=_0x354342[_0x20c77b(0x596)]);}),_0x54c7b5['lastFailedAction']=null;}catch(_0x2167ce){console[_0x53a629(0x7a3)]('AI投票决策API失败:',_0x2167ce),await _0x501c7b('操作失败',_0x53a629(0x1199)+_0x2167ce['message']),document[_0x53a629(0x8c2)](_0x53a629(0xa64))[_0x53a629(0x842)][_0x53a629(0x5e9)]=_0x53a629(0xea7);return;}const _0x7e51b9=_0x54c7b5[_0x53a629(0x4ae)][_0x53a629(0x2ef)](_0x42aa59=>_0x42aa59['id']===_0x53a629(0x74b));if(_0x7e51b9&&_0x7e51b9[_0x53a629(0x2f0)]){_0x25990f(_0x53a629(0x11ff)),_0x46fe95();const _0x36e229=await _0x3e036a(_0x53a629(0x1213)),_0x3148bd=_0x54c7b5['players']['find'](_0x44c75b=>_0x44c75b['id']===_0x36e229);_0x3148bd&&(_0x54c7b5['votes'][_0x7e51b9[_0x53a629(0x596)]]=_0x3148bd[_0x53a629(0x596)]);}_0x25ab1b();}async function _0x4a67d9(){const _0x506a65=_0x18b51e,{proxyUrl:_0x1cd430,apiKey:_0x324028,model:_0x22ebba}=_0x405767[_0x506a65(0x9e0)];if(!_0x1cd430||!_0x324028||!_0x22ebba)return null;const _0x58bb60=_0x54c7b5[_0x506a65(0x4ae)][_0x506a65(0x1d8)](_0x460824=>_0x460824[_0x506a65(0x2f0)]&&_0x460824['id']!==_0x506a65(0x74b)),_0x280093=_0x54c7b5['players'][_0x506a65(0x1d8)](_0x26a242=>_0x26a242[_0x506a65(0x2f0)])[_0x506a65(0x6b9)](_0x77200b=>_0x77200b[_0x506a65(0x596)]);let _0x289242=_0x2aa56a();_0x289242+=_0x506a65(0x111d)+_0x280093['join'](',\x20')+_0x506a65(0xfa5);try{let _0x162ff9=_0x1cd430[_0x506a65(0x773)](_0x506a65(0x3fe)),_0x3c9ec4=[{'role':'user','content':_0x506a65(0x481)}],_0x3a1482=_0x282b7e(_0x22ebba,_0x324028,_0x289242,_0x3c9ec4);const _0x48b010=_0x162ff9?await fetch(_0x3a1482[_0x506a65(0x9d6)],_0x3a1482[_0x506a65(0x49a)]):await fetch(_0x1cd430+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x324028},'body':JSON[_0x506a65(0x1175)]({'model':_0x22ebba,'messages':[{'role':'system','content':_0x289242},..._0x3c9ec4],'temperature':_0x405767[_0x506a65(0xb73)][_0x506a65(0x8c7)]||0.8})});if(!_0x48b010['ok'])throw new Error((await _0x48b010[_0x506a65(0x7e9)]())['error'][_0x506a65(0xc7d)]);const _0x13e5d7=await _0x48b010['json'](),_0x56fa80=getGeminiResponseText(_0x13e5d7);let _0x5e1c7d=_0x56fa80[_0x506a65(0x1b7)](/^```json\s*/,'')['replace'](/```$/,'')['trim']();const _0x1a5786=_0x5e1c7d[_0x506a65(0xbf2)]('['),_0x4dd4cc=_0x5e1c7d['lastIndexOf'](']');if(_0x1a5786===-0x1||_0x4dd4cc===-0x1||_0x4dd4cc<_0x1a5786)throw new Error(_0x506a65(0x7bc));const _0x221841=_0x5e1c7d[_0x506a65(0x599)](_0x1a5786,_0x4dd4cc+0x1);try{const _0x2c695d=_0x221841[_0x506a65(0xdf8)](/(\[[\s\S]*?\])/g);if(_0x2c695d&&_0x2c695d[_0x506a65(0x105a)]>0x0)return JSON['parse'](_0x2c695d[_0x2c695d['length']-0x1]);return JSON[_0x506a65(0x10ab)](_0x221841);}catch(_0x3a1258){throw new Error(_0x506a65(0xaa1)+_0x3a1258[_0x506a65(0xc7d)]+_0x506a65(0x15c)+_0x56fa80);}}catch(_0x3ecbec){console[_0x506a65(0x7a3)](_0x506a65(0x4df),_0x3ecbec);throw new Error(_0x506a65(0xc83)+_0x3ecbec['message']);}}function _0x25ab1b(){const _0x531a83=_0x18b51e,_0x155abf={},_0x1f12c5={};for(const _0x3e21ad in _0x54c7b5[_0x531a83(0x2ab)]){const _0x240c10=_0x54c7b5[_0x531a83(0x2ab)][_0x3e21ad];_0x155abf[_0x240c10]=(_0x155abf[_0x240c10]||0x0)+0x1,!_0x1f12c5[_0x240c10]&&(_0x1f12c5[_0x240c10]=[]),_0x1f12c5[_0x240c10][_0x531a83(0xa49)](_0x3e21ad);}let _0x1e7351=0x0,_0x557d8b=[];for(const _0x22ea63 in _0x155abf){const _0x3789af=_0x155abf[_0x22ea63];if(_0x3789af>_0x1e7351)_0x1e7351=_0x3789af,_0x557d8b=[_0x22ea63];else _0x3789af===_0x1e7351&&_0x557d8b[_0x531a83(0xa49)](_0x22ea63);}_0x25990f('投票结果：');for(const _0x53a4eb in _0x1f12c5){_0x25990f(_0x53a4eb+'\x20('+_0x1f12c5[_0x53a4eb][_0x531a83(0x105a)]+_0x531a83(0x3cf)+_0x1f12c5[_0x53a4eb][_0x531a83(0xb2c)]('、\x20'));}if(_0x557d8b[_0x531a83(0x105a)]===0x1&&_0x1e7351>0x0){const _0x45a056=_0x54c7b5[_0x531a83(0x4ae)][_0x531a83(0x2ef)](_0x1eb533=>_0x1eb533[_0x531a83(0x596)]===_0x557d8b[0x0]);if(_0x45a056){_0x45a056[_0x531a83(0x2f0)]=![],_0x25990f(_0x45a056[_0x531a83(0x596)]+_0x531a83(0x5cd));if(_0x45a056['role']==='猎人'){}}}else _0x25990f(_0x531a83(0x11ad));_0x46fe95();if(_0x264fef())return;_0x54c7b5[_0x531a83(0xb75)]++,_0x99a3d1();}async function _0x767c2b(){const _0x3d1615=_0x18b51e,{proxyUrl:_0x39aa00,apiKey:_0x4269d3,model:_0x3810e3}=_0x405767['apiConfig'];if(!_0x39aa00||!_0x4269d3||!_0x3810e3)return null;const _0x2cec39=_0x54c7b5[_0x3d1615(0x4ae)]['filter'](_0x24d4bd=>_0x24d4bd[_0x3d1615(0x14a)]==='狼人'&&_0x24d4bd[_0x3d1615(0x2f0)]),_0x22b667=_0x54c7b5[_0x3d1615(0x4ae)][_0x3d1615(0x1d8)](_0x42b2a1=>_0x42b2a1[_0x3d1615(0x2f0)]&&_0x42b2a1['role']!=='狼人'),_0x3bed80=_0x3d1615(0x9ad)+_0x2cec39['map'](_0x3f2bed=>_0x3f2bed[_0x3d1615(0x596)])[_0x3d1615(0xb2c)]('、\x20')+_0x3d1615(0x183)+_0x22b667[_0x3d1615(0x6b9)](_0x3018dc=>_0x3018dc[_0x3d1615(0x596)])[_0x3d1615(0xb2c)]('、\x20')+_0x3d1615(0xe60)+_0x54c7b5[_0x3d1615(0xc69)][_0x3d1615(0x6b9)](_0x1969df=>_0x1969df[_0x3d1615(0xa76)]+':\x20'+_0x1969df['content'])['join']('\x0a')+_0x3d1615(0xd34);try{let _0x2db3d8=_0x39aa00[_0x3d1615(0x773)]('generativelanguage'),_0x3fef88=[{'role':_0x3d1615(0x74b),'content':_0x3d1615(0xebf)}],_0x431cb0=_0x282b7e(_0x3810e3,_0x4269d3,_0x3bed80,_0x3fef88);const _0x27f6fd=_0x2db3d8?await fetch(_0x431cb0['url'],_0x431cb0[_0x3d1615(0x49a)]):await fetch(_0x39aa00+'/v1/chat/completions',{'method':_0x3d1615(0xcd0),'headers':{'Content-Type':'application/json','Authorization':_0x3d1615(0xf42)+_0x4269d3},'body':JSON['stringify']({'model':_0x3810e3,'messages':[{'role':_0x3d1615(0x46c),'content':_0x3bed80},..._0x3fef88],'temperature':_0x405767[_0x3d1615(0xb73)][_0x3d1615(0x8c7)]||0.8})});if(!_0x27f6fd['ok'])throw new Error((await _0x27f6fd[_0x3d1615(0x7e9)]())[_0x3d1615(0x7a3)]['message']);const _0x4a4e0b=await _0x27f6fd[_0x3d1615(0x7e9)](),_0x2e702d=getGeminiResponseText(_0x4a4e0b),_0x4a67a7=_0x2e702d[_0x3d1615(0xdf8)](/({[\s\S]*})/);if(!_0x4a67a7)throw new Error(_0x3d1615(0x5ac));const _0x375291=JSON[_0x3d1615(0x10ab)](_0x4a67a7[0x0]),_0x31f267=_0x54c7b5['players']['find'](_0x4540b1=>_0x4540b1[_0x3d1615(0x596)]===_0x375291[_0x3d1615(0x791)]);return _0x31f267?_0x31f267['id']:null;}catch(_0x1c3213){return console['error'](_0x3d1615(0x67c),_0x1c3213),_0x22b667[Math[_0x3d1615(0x10b2)](Math['random']()*_0x22b667['length'])]['id'];}}function _0x3a19ab(_0x187faa,_0xea91f5){return new Promise(_0x5c0183=>{const _0x4080f3=_0x7a65,_0x207d7d=document[_0x4080f3(0x8c2)]('werewolf-witch-modal'),_0x11c243=document[_0x4080f3(0x8c2)](_0x4080f3(0x5ec)),_0x530e30=document[_0x4080f3(0x8c2)](_0x4080f3(0xa24)),_0x5de44e=document[_0x4080f3(0x8c2)](_0x4080f3(0xff1)),_0x51c5f2=document[_0x4080f3(0x8c2)](_0x4080f3(0x9f3));_0x11c243[_0x4080f3(0xca0)]='';const _0x4bc0e2=_0x5de44e[_0x4080f3(0xac5)](!![]);_0x5de44e['parentNode'][_0x4080f3(0x56b)](_0x4bc0e2,_0x5de44e);const _0xef22f7=_0x51c5f2[_0x4080f3(0xac5)](!![]);_0x51c5f2[_0x4080f3(0xe66)]['replaceChild'](_0xef22f7,_0x51c5f2),_0x4bc0e2[_0x4080f3(0x842)][_0x4080f3(0x5e9)]=_0x4080f3(0xea7),_0x4bc0e2['disabled']=!![];let _0x66f576={'save':![],'poison':null},_0x407617=null;if(_0x187faa&&!_0xea91f5['antidoteUsed']){_0x530e30[_0x4080f3(0x1090)]=_0x4080f3(0x9c3)+_0x187faa[_0x4080f3(0x596)]+_0x4080f3(0x873);const _0x193224=document[_0x4080f3(0x8c1)](_0x4080f3(0x19a));_0x193224['className']='form-button',_0x193224['textContent']=_0x4080f3(0xad7),_0x193224[_0x4080f3(0x842)]['margin']=_0x4080f3(0x290),_0x193224[_0x4080f3(0xcda)]=()=>{const _0x20a1e9=_0x4080f3;_0x66f576[_0x20a1e9(0x8b1)]=!![],_0x207d7d[_0x20a1e9(0xb17)][_0x20a1e9(0xaff)](_0x20a1e9(0x2cd)),_0x5c0183(_0x66f576);},_0x11c243[_0x4080f3(0x31e)](_0x193224);}else _0x187faa?_0x530e30['textContent']=_0x4080f3(0x9c3)+_0x187faa[_0x4080f3(0x596)]+_0x4080f3(0xbaa):_0x530e30[_0x4080f3(0x1090)]=_0x4080f3(0x77c);if(!_0xea91f5[_0x4080f3(0x2ac)]){const _0x39236e=document[_0x4080f3(0x8c1)]('p');_0x39236e[_0x4080f3(0x1090)]=_0x4080f3(0x1173),_0x39236e['style'][_0x4080f3(0x803)]=_0x4080f3(0x65d),_0x39236e[_0x4080f3(0x842)][_0x4080f3(0xe58)]=_0x4080f3(0x290),_0x11c243[_0x4080f3(0x31e)](_0x39236e);const _0x1f6e57=_0x54c7b5[_0x4080f3(0x4ae)][_0x4080f3(0x1d8)](_0xb7f85f=>_0xb7f85f[_0x4080f3(0x2f0)]&&_0xb7f85f['id']!==_0x187faa?.['id']);_0x1f6e57[_0x4080f3(0x7c0)](_0x17fdcd=>{const _0x3cf991=_0x4080f3,_0x514117=document['createElement']('div');_0x514117[_0x3cf991(0x84c)]='werewolf-selection-item',_0x514117['dataset']['id']=_0x17fdcd['id'],_0x514117[_0x3cf991(0xca0)]=_0x3cf991(0x333)+_0x17fdcd[_0x3cf991(0x1e1)]+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0x17fdcd[_0x3cf991(0x596)]+_0x3cf991(0x688),_0x514117['onclick']=()=>{const _0x2d7e1d=_0x3cf991;_0x11c243['querySelectorAll'](_0x2d7e1d(0x172))[_0x2d7e1d(0x7c0)](_0x48e1d1=>_0x48e1d1[_0x2d7e1d(0xb17)][_0x2d7e1d(0xaff)](_0x2d7e1d(0x118f))),_0x514117['classList'][_0x2d7e1d(0x3f4)](_0x2d7e1d(0x118f)),_0x407617=_0x17fdcd['id'],_0x4bc0e2[_0x2d7e1d(0x1033)]=![];},_0x11c243[_0x3cf991(0x31e)](_0x514117);});}_0x4bc0e2[_0x4080f3(0xcda)]=()=>{const _0x49bbb5=_0x4080f3;_0x407617&&(_0x66f576[_0x49bbb5(0xdc7)]=_0x407617,_0x207d7d[_0x49bbb5(0xb17)][_0x49bbb5(0xaff)](_0x49bbb5(0x2cd)),_0x5c0183(_0x66f576));},_0xef22f7[_0x4080f3(0xcda)]=()=>{const _0x1d501e=_0x4080f3;_0x207d7d['classList']['remove'](_0x1d501e(0x2cd)),_0x5c0183(_0x66f576);},_0x207d7d['classList'][_0x4080f3(0x3f4)](_0x4080f3(0x2cd));});}async function _0x5c035d(){const _0x3e7421=_0x18b51e,_0x190e2d=_0x54c7b5[_0x3e7421(0x349)];if(!_0x190e2d)return;document[_0x3e7421(0x8c2)](_0x3e7421(0xa64))[_0x3e7421(0x842)]['display']=_0x3e7421(0xbf8),await _0x501c7b('请稍候...',_0x3e7421(0x117f)+_0x190e2d+_0x3e7421(0x10f5));switch(_0x190e2d){case _0x3e7421(0x459):await _0x99a3d1();break;case _0x3e7421(0x10a7):await _0x15f23f();break;case _0x3e7421(0xf1f):await _0xa06689();break;}}function _0x264fef(){const _0x12f80a=_0x18b51e,_0x524c29=_0x54c7b5['players']['filter'](_0x631859=>_0x631859[_0x12f80a(0x2f0)]),_0x4bfdf8=_0x524c29[_0x12f80a(0x1d8)](_0x3918f1=>_0x3918f1[_0x12f80a(0x14a)]==='狼人'),_0x542510=_0x524c29[_0x12f80a(0x1d8)](_0x4de76b=>[_0x12f80a(0x10c0),'女巫','猎人','守卫'][_0x12f80a(0x773)](_0x4de76b[_0x12f80a(0x14a)])),_0x316d37=_0x524c29[_0x12f80a(0x1d8)](_0x451e57=>_0x451e57['role']==='平民');let _0x5580fa=null;if(_0x4bfdf8[_0x12f80a(0x105a)]===0x0)_0x5580fa='好人';else{if(_0x4bfdf8[_0x12f80a(0x105a)]>=_0x542510[_0x12f80a(0x105a)]+_0x316d37['length'])_0x5580fa='狼人';else _0x54c7b5[_0x12f80a(0x648)]===_0x12f80a(0xa2e)?(_0x542510[_0x12f80a(0x105a)]===0x0||_0x316d37[_0x12f80a(0x105a)]===0x0)&&(_0x5580fa='狼人'):_0x542510[_0x12f80a(0x105a)]===0x0&&_0x316d37[_0x12f80a(0x105a)]===0x0&&(_0x5580fa='狼人');}if(_0x5580fa)return _0xbe5df0(_0x5580fa),!![];return![];}async function _0x16a788(){const _0x1a61b7=_0x18b51e,_0x2a7046=await _0x8b9cb8(_0x1a61b7(0x65a),'此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>',{'confirmText':'开始检查'});if(!_0x2a7046)return;await _0x501c7b('请稍候...','正在扫描和修复数据...');try{const _0x16c9cd=await _0x15043e['chats']['toArray']();let _0x2a00f8=0x0;for(const _0x2fba66 of _0x16c9cd){let _0x308d3f=![];!Array[_0x1a61b7(0xb85)](_0x2fba66[_0x1a61b7(0xd39)])&&(_0x2fba66[_0x1a61b7(0xd39)]=[],_0x308d3f=!![]),(typeof _0x2fba66[_0x1a61b7(0x33a)]!=='object'||_0x2fba66['settings']===null)&&(_0x2fba66['settings']={},_0x308d3f=!![]),!_0x2fba66[_0x1a61b7(0x1000)]&&!_0x2fba66[_0x1a61b7(0x4e7)]&&(_0x2fba66[_0x1a61b7(0x4e7)]=_0x2fba66[_0x1a61b7(0x596)],_0x308d3f=!![]),typeof _0x2fba66['unreadCount']===_0x1a61b7(0x3df)&&(_0x2fba66[_0x1a61b7(0xf10)]=0x0,_0x308d3f=!![]),!Array[_0x1a61b7(0xb85)](_0x2fba66[_0x1a61b7(0xbca)])&&(_0x2fba66['longTermMemory']=[],_0x308d3f=!![]),_0x308d3f&&(_0x2a00f8++,console[_0x1a61b7(0x32b)](_0x1a61b7(0x162)+_0x2fba66[_0x1a61b7(0x596)]+_0x1a61b7(0x4bf)+_0x2fba66['id']+_0x1a61b7(0xe23)),await _0x15043e[_0x1a61b7(0x799)][_0x1a61b7(0xfaa)](_0x2fba66)),_0x405767['chats'][_0x2fba66['id']]=_0x2fba66;}_0x2a00f8>0x0?(await _0x501c7b(_0x1a61b7(0x126a),_0x1a61b7(0x55f)+_0x2a00f8+_0x1a61b7(0x273)),await _0x2b55d1()):await _0x501c7b(_0x1a61b7(0xae4),_0x1a61b7(0xdc0));}catch(_0x2a72bb){console[_0x1a61b7(0x7a3)](_0x1a61b7(0x941),_0x2a72bb),await _0x501c7b(_0x1a61b7(0xa85),'执行检查时发生错误:\x20'+_0x2a72bb['message']);}}function _0x21c28a(_0x3938f3,_0x88bded='top'){const _0xb4a198=_0x18b51e;if(_0x3938f3['querySelector'](_0xb4a198(0xc29)))return;const _0x444a93=document['createElement']('div');_0x444a93[_0xb4a198(0x84c)]=_0xb4a198(0xa8f),_0x444a93['innerHTML']=_0xb4a198(0x811),_0x88bded===_0xb4a198(0xf2b)?_0x3938f3[_0xb4a198(0x31e)](_0x444a93):_0x3938f3[_0xb4a198(0x1ba)](_0x444a93);}function _0x45f5dc(_0x4b217a){const _0x1e6316=_0x18b51e,_0x1e5329=_0x4b217a[_0x1e6316(0x1ad)](_0x1e6316(0xc29));_0x1e5329&&_0x1e5329[_0x1e6316(0xaff)]();}async function _0x32ef94(){const _0xe2c1c3=_0x18b51e,_0x39d099=document[_0xe2c1c3(0x8c2)](_0xe2c1c3(0x5a1)),_0xee58f=document['getElementById'](_0xe2c1c3(0x255)),_0x465298=document[_0xe2c1c3(0x8c2)](_0xe2c1c3(0xfd7));_0xee58f['innerHTML']='',_0x465298[_0xe2c1c3(0x75f)]=![];const _0x58ff0d=await _0x15043e['worldBooks']['toArray']();_0x58ff0d[_0xe2c1c3(0x105a)]===0x0?_0xee58f['innerHTML']=_0xe2c1c3(0x9f6):_0x58ff0d[_0xe2c1c3(0x7c0)](_0x5dcc5e=>{const _0xb421c5=_0xe2c1c3,_0x3a6a25=document[_0xb421c5(0x8c1)](_0xb421c5(0x1072));_0x3a6a25[_0xb421c5(0x84c)]='clear-posts-item',_0x3a6a25[_0xb421c5(0x323)][_0xb421c5(0x3da)]=_0x5dcc5e['id'],_0x3a6a25[_0xb421c5(0xca0)]=_0xb421c5(0x3b8)+_0x5dcc5e[_0xb421c5(0x596)]+_0xb421c5(0xee1),_0xee58f[_0xb421c5(0x31e)](_0x3a6a25);}),_0x39d099[_0xe2c1c3(0xb17)][_0xe2c1c3(0x3f4)](_0xe2c1c3(0x2cd));}async function _0x2da18b(){const _0x5eb66c=_0x18b51e,_0x2b4d7d=document['querySelectorAll'](_0x5eb66c(0x690));if(_0x2b4d7d[_0x5eb66c(0x105a)]===0x0){alert(_0x5eb66c(0x840));return;}const _0x5acc03=Array[_0x5eb66c(0x51a)](_0x2b4d7d)[_0x5eb66c(0x6b9)](_0x180b35=>_0x180b35[_0x5eb66c(0x323)][_0x5eb66c(0x3da)]),_0x44b2db=await _0x8b9cb8(_0x5eb66c(0x694),_0x5eb66c(0x8e5)+_0x2b4d7d[_0x5eb66c(0x105a)]+_0x5eb66c(0x7ea),{'confirmButtonClass':_0x5eb66c(0xe2a),'confirmText':_0x5eb66c(0xad9)});if(!_0x44b2db)return;await _0x501c7b(_0x5eb66c(0x1047),'正在执行删除操作...');try{await _0x15043e[_0x5eb66c(0xa88)]('rw',_0x15043e['worldBooks'],_0x15043e[_0x5eb66c(0x799)],async()=>{const _0x5c3bc5=_0x5eb66c;await _0x15043e[_0x5c3bc5(0x40e)]['bulkDelete'](_0x5acc03);const _0x19b967=await _0x15043e['chats'][_0x5c3bc5(0x6be)]();for(const _0x3d2b91 of _0x19b967){if(_0x3d2b91[_0x5c3bc5(0x33a)]&&Array[_0x5c3bc5(0xb85)](_0x3d2b91['settings'][_0x5c3bc5(0xb77)])){const _0x28b3e2=_0x3d2b91[_0x5c3bc5(0x33a)]['linkedWorldBookIds'][_0x5c3bc5(0x105a)];_0x3d2b91['settings'][_0x5c3bc5(0xb77)]=_0x3d2b91[_0x5c3bc5(0x33a)]['linkedWorldBookIds'][_0x5c3bc5(0x1d8)](_0x2f8577=>!_0x5acc03[_0x5c3bc5(0x773)](_0x2f8577)),_0x3d2b91['settings'][_0x5c3bc5(0xb77)][_0x5c3bc5(0x105a)]<_0x28b3e2&&await _0x15043e['chats']['put'](_0x3d2b91);}}}),_0x405767[_0x5eb66c(0x40e)]=_0x405767[_0x5eb66c(0x40e)][_0x5eb66c(0x1d8)](_0x31ac10=>!_0x5acc03[_0x5eb66c(0x773)](_0x31ac10['id'])),document[_0x5eb66c(0x8c2)](_0x5eb66c(0x5a1))['classList'][_0x5eb66c(0xaff)](_0x5eb66c(0x2cd)),await _0x501c7b(_0x5eb66c(0x824),_0x2b4d7d[_0x5eb66c(0x105a)]+_0x5eb66c(0x11ca));}catch(_0x57bbd5){console[_0x5eb66c(0x7a3)]('删除世界书失败:',_0x57bbd5),await _0x501c7b(_0x5eb66c(0x790),_0x5eb66c(0x35f)+_0x57bbd5[_0x5eb66c(0xc7d)]);}}function _0x59e7df(){const _0x2f3fb0=_0x18b51e;if(!_0x405767['activeChatId'])return;const _0x1343be=_0x405767[_0x2f3fb0(0x248)],_0x4b3f90=document[_0x2f3fb0(0x8c2)](_0x2f3fb0(0x793)),_0xd5fa80=document[_0x2f3fb0(0x8c2)](_0x2f3fb0(0x1132)),_0x3f1c94=document[_0x2f3fb0(0x8c2)](_0x2f3fb0(0x853));let _0x2ba77e=_0x2fd142[_0x1343be];if(_0x2ba77e&&_0x2ba77e[_0x2f3fb0(0x6f0)]){_0x2ba77e[_0x2f3fb0(0xb3a)]&&_0x346c57();_0x4b3f90[_0x2f3fb0(0x842)][_0x2f3fb0(0x5e9)]=_0x2f3fb0(0xd52);return;}_0x21c393(_0x1343be),_0x5f5201(_0x1343be),_0x4b3f90['style'][_0x2f3fb0(0x5e9)]='flex',_0xd5fa80[_0x2f3fb0(0xb17)][_0x2f3fb0(0xaff)](_0x2f3fb0(0xb49)),_0x3f1c94[_0x2f3fb0(0x842)][_0x2f3fb0(0x5e9)]=_0x2f3fb0(0xbf8);const _0x13cdc0=document[_0x2f3fb0(0x8c2)](_0x2f3fb0(0x5e7)),_0x1d7dc6=_0xd5fa80['getBoundingClientRect'](),_0x24718d=(_0x13cdc0[_0x2f3fb0(0x7b3)]-_0x1d7dc6['height'])/0x2,_0x267a25=(_0x13cdc0['clientWidth']-_0x1d7dc6[_0x2f3fb0(0x578)])/0x2;_0xd5fa80[_0x2f3fb0(0x842)]['top']=_0x24718d+'px',_0xd5fa80[_0x2f3fb0(0x842)][_0x2f3fb0(0xe3a)]=_0x267a25+'px',_0xd5fa80[_0x2f3fb0(0x842)][_0x2f3fb0(0xb56)]='';}function _0x21c393(_0x830a5a){const _0x28f834=_0x18b51e;_0x2fd142[_0x830a5a]={'isActive':!![],'isMinimized':![],'title':_0x28f834(0x48e),'contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0x4c7464(){const _0x4e212d=_0x18b51e,_0x4f2d83=_0x405767[_0x4e212d(0x248)];if(!_0x4f2d83||!_0x2fd142[_0x4f2d83]||!_0x2fd142[_0x4f2d83][_0x4e212d(0x6f0)])return;document[_0x4e212d(0x8c2)]('reading-overlay')[_0x4e212d(0x842)][_0x4e212d(0x5e9)]='none',document[_0x4e212d(0x8c2)]('reading-restore-btn')['style'][_0x4e212d(0x5e9)]='none',document[_0x4e212d(0x8c2)](_0x4e212d(0x1132))[_0x4e212d(0xb17)]['remove'](_0x4e212d(0xb49)),_0x2fd142[_0x4f2d83][_0x4e212d(0x6f0)]=![],console['log'](_0x4e212d(0x55a));}function _0x5b6ea2(){const _0x2df407=_0x18b51e,_0x4fc6ee=_0x2fd142[_0x405767[_0x2df407(0x248)]];if(!_0x4fc6ee||!_0x4fc6ee['isActive']||_0x4fc6ee[_0x2df407(0xb3a)])return;_0x4fc6ee[_0x2df407(0xb3a)]=!![],document['getElementById']('reading-window')[_0x2df407(0xb17)][_0x2df407(0x3f4)](_0x2df407(0xb49)),document[_0x2df407(0x8c2)](_0x2df407(0x853))['style'][_0x2df407(0x5e9)]=_0x2df407(0xd52);}function _0x346c57(){const _0x43a372=_0x18b51e,_0x417930=_0x2fd142[_0x405767['activeChatId']];if(!_0x417930||!_0x417930[_0x43a372(0x6f0)]||!_0x417930[_0x43a372(0xb3a)])return;_0x417930[_0x43a372(0xb3a)]=![],document[_0x43a372(0x8c2)]('reading-restore-btn')['style'][_0x43a372(0x5e9)]=_0x43a372(0xbf8),document[_0x43a372(0x8c2)](_0x43a372(0x1132))['classList']['remove'](_0x43a372(0xb49));}function _0x347e60(_0x5cbe0a,_0xc05e90){const _0x36eb4a=_0x18b51e;let _0x4b3385=0x0,_0xc7d4e3=0x0,_0x36d4e3=0x0,_0x5083f0=0x0;const _0x27d6cb=document[_0x36eb4a(0x8c2)](_0x36eb4a(0x5e7)),_0x1da1b0=_0x56fb04=>{const _0x47149a=_0x36eb4a;if(_0x56fb04[_0x47149a(0x475)][_0x47149a(0xa90)](_0x47149a(0x19a)))return;if(_0x5cbe0a[_0x47149a(0x842)][_0x47149a(0xb56)]){const _0x34a27c=_0x5cbe0a[_0x47149a(0xfe9)](),_0x2397a2=_0x5cbe0a[_0x47149a(0x7fa)][_0x47149a(0xfe9)]();_0x5cbe0a['style'][_0x47149a(0x9a4)]=_0x34a27c['top']-_0x2397a2['top']+'px',_0x5cbe0a[_0x47149a(0x842)]['left']=_0x34a27c[_0x47149a(0xe3a)]-_0x2397a2[_0x47149a(0xe3a)]+'px',_0x5cbe0a[_0x47149a(0x842)][_0x47149a(0xb56)]='';}_0x56fb04[_0x47149a(0xd35)]();const _0x46df55=_0x56fb04[_0x47149a(0xde0)]===_0x47149a(0x3e0)?_0x56fb04[_0x47149a(0x474)][0x0]:_0x56fb04;_0x36d4e3=_0x46df55[_0x47149a(0x629)],_0x5083f0=_0x46df55[_0x47149a(0x34b)],document[_0x47149a(0xae8)](_0x47149a(0x72c),_0x2ed67f),document['addEventListener']('mousemove',_0x162ca),document[_0x47149a(0xae8)](_0x47149a(0x519),_0x2ed67f),document['addEventListener'](_0x47149a(0x4c1),_0x162ca);},_0x162ca=_0x5c79c1=>{const _0x589b55=_0x36eb4a,_0x22616c=_0x5c79c1[_0x589b55(0xde0)]===_0x589b55(0x4c1)?_0x5c79c1[_0x589b55(0x474)][0x0]:_0x5c79c1;_0x4b3385=_0x36d4e3-_0x22616c['clientX'],_0xc7d4e3=_0x5083f0-_0x22616c[_0x589b55(0x34b)],_0x36d4e3=_0x22616c['clientX'],_0x5083f0=_0x22616c['clientY'];let _0x44f140=_0x5cbe0a[_0x589b55(0x341)]-_0xc7d4e3,_0x1db5ce=_0x5cbe0a['offsetLeft']-_0x4b3385;const _0x5f05ac=_0x27d6cb[_0x589b55(0x7b3)]-_0x5cbe0a[_0x589b55(0x633)]-0xa,_0x4eacec=_0x27d6cb['clientWidth']-_0x5cbe0a[_0x589b55(0x6f8)]-0xa;_0x44f140=Math[_0x589b55(0x171)](0xa,Math[_0x589b55(0x10ff)](_0x44f140,_0x5f05ac)),_0x1db5ce=Math[_0x589b55(0x171)](0xa,Math[_0x589b55(0x10ff)](_0x1db5ce,_0x4eacec)),_0x5cbe0a[_0x589b55(0x842)][_0x589b55(0x9a4)]=_0x44f140+'px',_0x5cbe0a[_0x589b55(0x842)][_0x589b55(0xe3a)]=_0x1db5ce+'px';},_0x2ed67f=()=>{const _0x4b5b41=_0x36eb4a;document[_0x4b5b41(0x2b2)](_0x4b5b41(0x72c),_0x2ed67f),document[_0x4b5b41(0x2b2)](_0x4b5b41(0x6c1),_0x162ca),document[_0x4b5b41(0x2b2)](_0x4b5b41(0x519),_0x2ed67f),document['removeEventListener'](_0x4b5b41(0x4c1),_0x162ca);};_0xc05e90['addEventListener'](_0x36eb4a(0x5d5),_0x1da1b0),_0xc05e90[_0x36eb4a(0xae8)](_0x36eb4a(0x3e0),_0x1da1b0);}function _0x5f5201(_0x35872f){const _0x566bf2=_0x18b51e,_0x37c0a1=_0x2fd142[_0x35872f];if(!_0x37c0a1)return;const _0xc0896c=document[_0x566bf2(0x8c2)](_0x566bf2(0x10ed)),_0x94a743=document[_0x566bf2(0x8c2)](_0x566bf2(0x7a0)),_0x53a751=document[_0x566bf2(0x8c2)]('page-indicator'),_0x1cc1b3=document[_0x566bf2(0x8c2)](_0x566bf2(0x3d2)),_0x2cf517=document['getElementById'](_0x566bf2(0x8b0));_0xc0896c[_0x566bf2(0x1090)]=_0x37c0a1[_0x566bf2(0xcea)];if(_0x37c0a1[_0x566bf2(0xe7f)][_0x566bf2(0x105a)]===0x0)_0x94a743[_0x566bf2(0xca0)]=_0x566bf2(0xa02),_0x37c0a1[_0x566bf2(0xe83)]=0x0,_0x37c0a1['currentPage']=0x0;else{const _0x97ba3=_0x37c0a1[_0x566bf2(0xe6e)]*_0x37c0a1[_0x566bf2(0xb9c)],_0x3d741d=_0x97ba3+_0x37c0a1['linesPerPage'];_0x94a743['textContent']=_0x37c0a1[_0x566bf2(0xe7f)]['slice'](_0x97ba3,_0x3d741d)['join']('\x0a');}_0x53a751[_0x566bf2(0x1090)]=_0x37c0a1[_0x566bf2(0xe6e)]+0x1+_0x566bf2(0x916)+_0x37c0a1[_0x566bf2(0xe83)],_0x1cc1b3['disabled']=_0x37c0a1[_0x566bf2(0xe6e)]===0x0,_0x2cf517[_0x566bf2(0x1033)]=_0x37c0a1[_0x566bf2(0xe6e)]>=_0x37c0a1[_0x566bf2(0xe83)]-0x1;}function _0x3be27b(){const _0x5c50b2=_0x18b51e,_0xfe9150=_0x2fd142[_0x405767['activeChatId']];_0xfe9150&&_0xfe9150[_0x5c50b2(0xe6e)]<_0xfe9150[_0x5c50b2(0xe83)]-0x1&&(_0xfe9150['currentPage']++,_0x5f5201(_0x405767[_0x5c50b2(0x248)]),document[_0x5c50b2(0x8c2)]('reading-content')[_0x5c50b2(0xfd0)]=0x0,_0x120f56(_0xfe9150[_0x5c50b2(0xf43)],_0xfe9150['currentPage']));}async function _0x1d6129(){const _0x4676bf=_0x18b51e,_0x22444d=_0x2fd142[_0x405767[_0x4676bf(0x248)]];_0x22444d&&_0x22444d[_0x4676bf(0xe6e)]>0x0&&(_0x22444d[_0x4676bf(0xe6e)]--,_0x5f5201(_0x405767[_0x4676bf(0x248)]),document[_0x4676bf(0x8c2)](_0x4676bf(0x7a0))[_0x4676bf(0xfd0)]=0x0,await _0x120f56(_0x22444d[_0x4676bf(0xf43)],_0x22444d[_0x4676bf(0xe6e)]),await notifyAiOfPageTurn(_0x405767[_0x4676bf(0x248)],_0x22444d));}function _0x128525(){const _0x226ef0=_0x18b51e;document[_0x226ef0(0x8c2)](_0x226ef0(0x1241))['click']();}async function _0x11614c(_0x3cee09){const _0x47a8c4=_0x18b51e,_0x3898ba=new Uint8Array(_0x3cee09);if(_0x3898ba['length']>=0x3&&_0x3898ba[0x0]===0xef&&_0x3898ba[0x1]===0xbb&&_0x3898ba[0x2]===0xbf)return console[_0x47a8c4(0x32b)](_0x47a8c4(0x233)),new TextDecoder(_0x47a8c4(0xea4))[_0x47a8c4(0x860)](_0x3898ba);if(_0x3898ba[_0x47a8c4(0x105a)]>=0x2&&_0x3898ba[0x0]===0xff&&_0x3898ba[0x1]===0xfe)return console[_0x47a8c4(0x32b)](_0x47a8c4(0x49d)),new TextDecoder(_0x47a8c4(0x84b))[_0x47a8c4(0x860)](_0x3898ba);if(_0x3898ba[_0x47a8c4(0x105a)]>=0x2&&_0x3898ba[0x0]===0xfe&&_0x3898ba[0x1]===0xff)return console[_0x47a8c4(0x32b)](_0x47a8c4(0x5c5)),new TextDecoder(_0x47a8c4(0x6cd))['decode'](_0x3898ba);try{console[_0x47a8c4(0x32b)]('未检测到BOM，尝试使用\x20UTF-8\x20解码...');const _0x4e85c6=new TextDecoder(_0x47a8c4(0xea4),{'fatal':!![]})['decode'](_0x3898ba);return console[_0x47a8c4(0x32b)]('UTF-8\x20解码成功。'),_0x4e85c6;}catch(_0x1b0731){console[_0x47a8c4(0x32b)](_0x47a8c4(0xd78));try{const _0x22d89f=new TextDecoder(_0x47a8c4(0x81f))[_0x47a8c4(0x860)](_0x3898ba);return console['log'](_0x47a8c4(0xa5c)),_0x22d89f;}catch(_0x307bd0){console[_0x47a8c4(0x7a3)](_0x47a8c4(0x3ed),_0x307bd0);throw new Error(_0x47a8c4(0x8ca));}}}async function _0x2cfe24(_0x4bbc1f){const _0xb8ec28=_0x18b51e,_0x4244c4=_0x4bbc1f[_0xb8ec28(0x475)][_0xb8ec28(0xde8)][0x0];if(!_0x4244c4)return;try{const _0x375adf=await _0x4244c4[_0xb8ec28(0x80b)](),_0x30fea8=await _0x11614c(_0x375adf),_0x2485f6=_0x4244c4['name'][_0xb8ec28(0x1b7)](/\.txt$/i,''),_0x22afa1=await _0x15043e['readingLibrary'][_0xb8ec28(0x3f4)]({'title':_0x2485f6,'content':_0x30fea8,'lastOpened':Date[_0xb8ec28(0x1ed)]()});await _0x5e36c3(_0x22afa1),document[_0xb8ec28(0x8c2)](_0xb8ec28(0x353))[_0xb8ec28(0xb17)]['contains']('visible')&&_0x3d60c6();}catch(_0x4f4880){console[_0xb8ec28(0x7a3)](_0xb8ec28(0x259),_0x4f4880),await _0x501c7b(_0xb8ec28(0x8e8),_0x4f4880[_0xb8ec28(0xc7d)]);}finally{_0x4bbc1f[_0xb8ec28(0x475)][_0xb8ec28(0x518)]=null;}}async function _0x36c87a(){const _0x566327=_0x18b51e,_0x55caa0=_0x405767[_0x566327(0x248)];if(!_0x55caa0)return;const _0x5cc586=_0x2fd142[_0x55caa0];if(!_0x5cc586||_0x5cc586['totalPages']<=0x1)return;const _0x29f7c4=await _0x180f74(_0x566327(0x58b),'请输入想跳转的页码\x20(1\x20-\x20'+_0x5cc586[_0x566327(0xe83)]+')',_0x5cc586['currentPage']+0x1);if(_0x29f7c4===null)return;const _0x836d4c=parseInt(_0x29f7c4);if(isNaN(_0x836d4c)||_0x836d4c<0x1||_0x836d4c>_0x5cc586[_0x566327(0xe83)]){alert('请输入一个有效的页码！');return;}_0x5cc586[_0x566327(0xe6e)]=_0x836d4c-0x1,_0x5f5201(_0x55caa0),_0x120f56(_0x5cc586[_0x566327(0xf43)],_0x5cc586[_0x566327(0xe6e)]);}async function _0x120f56(_0x9d61e9,_0x214424){const _0xd26474=_0x18b51e;if(!_0x9d61e9)return;try{await _0x15043e[_0xd26474(0x80a)][_0xd26474(0xb7c)](_0x9d61e9,{'currentPage':_0x214424});}catch(_0xe3cdcd){console[_0xd26474(0x7a3)]('保存书籍(ID:\x20'+_0x9d61e9+_0xd26474(0xe48),_0xe3cdcd);}}async function _0x3be27b(){const _0x3be536=_0x18b51e,_0x35c141=_0x2fd142[_0x405767['activeChatId']];_0x35c141&&_0x35c141[_0x3be536(0xe6e)]<_0x35c141[_0x3be536(0xe83)]-0x1&&(_0x35c141[_0x3be536(0xe6e)]++,_0x5f5201(_0x405767[_0x3be536(0x248)]),document[_0x3be536(0x8c2)](_0x3be536(0x7a0))[_0x3be536(0xfd0)]=0x0,await _0x120f56(_0x35c141[_0x3be536(0xf43)],_0x35c141['currentPage']),await notifyAiOfPageTurn(_0x405767['activeChatId'],_0x35c141));}function _0x28fb4c(_0x289e8b,_0x48c064){const _0x43aa30=_0x18b51e,_0x3d2ec7=_0x405767[_0x43aa30(0x248)];if(!_0x3d2ec7)return;const _0x32b09f=_0x2fd142[_0x3d2ec7];_0x32b09f['title']=_0x289e8b[_0x43aa30(0x1b7)](/\.txt$/i,''),_0x32b09f[_0x43aa30(0xe7f)]=_0x48c064['split'](/\r\n?|\n/)[_0x43aa30(0x6b9)](_0x257de6=>_0x257de6[_0x43aa30(0x1b7)](/ +/g,'\x20')),_0x32b09f[_0x43aa30(0xe83)]=Math['ceil'](_0x32b09f['contentLines'][_0x43aa30(0x105a)]/_0x32b09f[_0x43aa30(0xb9c)]),_0x32b09f['currentPage']=0x0,_0x5f5201(_0x3d2ec7);}async function _0x3d1071(){const _0x5ea26e=_0x18b51e;document[_0x5ea26e(0x8c2)](_0x5ea26e(0x603))[_0x5ea26e(0x518)]='',await _0x3d60c6(),document[_0x5ea26e(0x8c2)]('reading-library-modal')[_0x5ea26e(0xb17)][_0x5ea26e(0x3f4)]('visible');}async function _0x3d60c6(_0x2161a1=''){const _0x1987e7=_0x18b51e,_0x21c352=document['getElementById'](_0x1987e7(0x2a5));let _0x27d99d=await _0x15043e[_0x1987e7(0x80a)][_0x1987e7(0x731)](_0x1987e7(0x8f8))[_0x1987e7(0x1c0)]()[_0x1987e7(0x6be)]();_0x21c352[_0x1987e7(0xca0)]='';_0x2161a1&&(_0x27d99d=_0x27d99d[_0x1987e7(0x1d8)](_0x396669=>_0x396669[_0x1987e7(0xcea)]['toLowerCase']()[_0x1987e7(0x773)](_0x2161a1[_0x1987e7(0xab8)]())));if(_0x27d99d[_0x1987e7(0x105a)]===0x0){const _0x3d5c2f=_0x2161a1?_0x1987e7(0x531):_0x1987e7(0x914);_0x21c352[_0x1987e7(0xca0)]=_0x1987e7(0xdd5)+_0x3d5c2f+_0x1987e7(0x2e7);return;}_0x27d99d['forEach'](_0x344133=>{const _0x3a3a5b=_0x1987e7,_0x39ca89=document[_0x3a3a5b(0x8c1)](_0x3a3a5b(0x1072));_0x39ca89[_0x3a3a5b(0x84c)]=_0x3a3a5b(0x376),_0x39ca89[_0x3a3a5b(0xca0)]=_0x3a3a5b(0x1287)+_0x344133['id']+'\x22>'+_0x344133[_0x3a3a5b(0xcea)]+_0x3a3a5b(0xbac)+_0x344133['id']+'\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x21c352[_0x3a3a5b(0x31e)](_0x39ca89);});}async function _0x5e36c3(_0x770d1a){const _0x3a3d80=_0x18b51e,_0x531b57=_0x405767[_0x3a3d80(0x248)];if(!_0x531b57)return;const _0x168902=await _0x15043e[_0x3a3d80(0x80a)][_0x3a3d80(0x3e9)](_0x770d1a);if(!_0x168902){alert('找不到这本书！');return;}await _0x15043e['readingLibrary'][_0x3a3d80(0xb7c)](_0x770d1a,{'lastOpened':Date[_0x3a3d80(0x1ed)]()});const _0x446491=_0x2fd142[_0x531b57];_0x446491[_0x3a3d80(0xf43)]=_0x770d1a,_0x446491['title']=_0x168902[_0x3a3d80(0xcea)],_0x446491[_0x3a3d80(0xe7f)]=_0x168902[_0x3a3d80(0x168)][_0x3a3d80(0x111f)](/\r\n?|\n/)['map'](_0x1a7d93=>_0x1a7d93['replace'](/ +/g,'\x20')),_0x446491[_0x3a3d80(0xe83)]=Math[_0x3a3d80(0xf93)](_0x446491[_0x3a3d80(0xe7f)]['length']/_0x446491[_0x3a3d80(0xb9c)]),_0x446491['currentPage']=_0x168902['currentPage']||0x0,_0x5f5201(_0x531b57),document[_0x3a3d80(0x8c2)]('reading-content')[_0x3a3d80(0xfd0)]=0x0,document[_0x3a3d80(0x8c2)](_0x3a3d80(0x353))[_0x3a3d80(0xb17)][_0x3a3d80(0xaff)]('visible');}async function _0x1300f9(_0x161d63){const _0x29c10b=_0x18b51e,_0x1da715=await _0x15043e[_0x29c10b(0x80a)][_0x29c10b(0x3e9)](_0x161d63);if(!_0x1da715)return;const _0x2d9ee7=await _0x8b9cb8(_0x29c10b(0x970),_0x29c10b(0xf99)+_0x1da715['title']+_0x29c10b(0x152),{'confirmButtonClass':_0x29c10b(0xe2a)});_0x2d9ee7&&(await _0x15043e[_0x29c10b(0x80a)][_0x29c10b(0x89f)](_0x161d63),await _0x3d60c6());}function _0x28fb4c(_0x3a0ce0,_0x4a7359){const _0x494f7a=_0x18b51e,_0x32b043=_0x405767['activeChatId'];if(!_0x32b043)return;const _0x524685=_0x2fd142[_0x32b043];_0x524685[_0x494f7a(0xcea)]=_0x3a0ce0[_0x494f7a(0x1b7)](/\.txt$/i,''),_0x524685['contentLines']=_0x4a7359[_0x494f7a(0x111f)](/\r\n?|\n/),_0x524685[_0x494f7a(0xe83)]=Math[_0x494f7a(0xf93)](_0x524685[_0x494f7a(0xe7f)]['length']/_0x524685[_0x494f7a(0xb9c)]),_0x524685[_0x494f7a(0xe6e)]=0x0,_0x5f5201(_0x32b043);}function _0x347e60(_0x44fdea,_0xb68155){const _0x4e9206=_0x18b51e;let _0x5ef7f2=0x0,_0x28469d=0x0,_0x56a61a=0x0,_0x16ae02=0x0,_0x36bce5=![],_0x28f2dc=![];const _0x471b84=document[_0x4e9206(0x8c2)](_0x4e9206(0x5e7)),_0x9061a9=_0x2c4300=>{const _0x56df8c=_0x4e9206;if(_0x44fdea!==_0xb68155&&_0x2c4300[_0x56df8c(0x475)]['closest'](_0x56df8c(0x19a)))return;_0x36bce5=!![],_0x28f2dc=![];const _0x26de33=_0x2c4300[_0x56df8c(0xde0)]===_0x56df8c(0x3e0)?_0x2c4300['touches'][0x0]:_0x2c4300;_0x56a61a=_0x26de33[_0x56df8c(0x629)],_0x16ae02=_0x26de33[_0x56df8c(0x34b)],_0x44fdea[_0x56df8c(0x842)][_0x56df8c(0x9a4)]=_0x44fdea[_0x56df8c(0x341)]+'px',_0x44fdea[_0x56df8c(0x842)][_0x56df8c(0xe3a)]=_0x44fdea[_0x56df8c(0x140)]+'px',_0x44fdea[_0x56df8c(0x842)]['transform']='',document[_0x56df8c(0xae8)](_0x56df8c(0x72c),_0x231970),document['addEventListener'](_0x56df8c(0x6c1),_0x15c3e),document['addEventListener'](_0x56df8c(0x519),_0x231970),document['addEventListener']('touchmove',_0x15c3e,{'passive':![]});},_0x15c3e=_0x1d1999=>{const _0x1302e6=_0x4e9206;if(!_0x36bce5)return;const _0x318c5b=_0x1d1999[_0x1302e6(0xde0)]===_0x1302e6(0x4c1)?_0x1d1999['touches'][0x0]:_0x1d1999,_0x3669d0=_0x318c5b[_0x1302e6(0x629)]-_0x56a61a,_0x323771=_0x318c5b['clientY']-_0x16ae02;!_0x28f2dc&&(Math[_0x1302e6(0x10a3)](_0x3669d0)>0x5||Math[_0x1302e6(0x10a3)](_0x323771)>0x5)&&(_0x28f2dc=!![]);_0x28f2dc&&_0x1d1999[_0x1302e6(0x42f)]&&_0x1d1999[_0x1302e6(0xd35)]();_0x5ef7f2=_0x56a61a-_0x318c5b['clientX'],_0x28469d=_0x16ae02-_0x318c5b['clientY'],_0x56a61a=_0x318c5b['clientX'],_0x16ae02=_0x318c5b[_0x1302e6(0x34b)];let _0x39e012=_0x44fdea[_0x1302e6(0x341)]-_0x28469d,_0x1cf147=_0x44fdea[_0x1302e6(0x140)]-_0x5ef7f2;const _0x1c908f=_0x471b84[_0x1302e6(0x7b3)]-_0x44fdea[_0x1302e6(0x633)]-0xa,_0x528e40=_0x471b84['clientWidth']-_0x44fdea[_0x1302e6(0x6f8)]-0xa;_0x39e012=Math[_0x1302e6(0x171)](0xa,Math[_0x1302e6(0x10ff)](_0x39e012,_0x1c908f)),_0x1cf147=Math[_0x1302e6(0x171)](0xa,Math[_0x1302e6(0x10ff)](_0x1cf147,_0x528e40)),_0x44fdea['style'][_0x1302e6(0x9a4)]=_0x39e012+'px',_0x44fdea['style']['left']=_0x1cf147+'px';},_0x231970=()=>{const _0x1e2de9=_0x4e9206;document[_0x1e2de9(0x2b2)](_0x1e2de9(0x72c),_0x231970),document[_0x1e2de9(0x2b2)](_0x1e2de9(0x6c1),_0x15c3e),document[_0x1e2de9(0x2b2)](_0x1e2de9(0x519),_0x231970),document['removeEventListener'](_0x1e2de9(0x4c1),_0x15c3e);if(!_0x36bce5)return;_0x36bce5=![],!_0x28f2dc&&_0x44fdea[_0x1e2de9(0xa17)]();};_0xb68155[_0x4e9206(0xae8)](_0x4e9206(0x5d5),_0x9061a9),_0xb68155[_0x4e9206(0xae8)](_0x4e9206(0x3e0),_0x9061a9,{'passive':![]});}function _0x5b6ea2(){const _0x49278d=_0x18b51e,_0x884657=_0x2fd142[_0x405767[_0x49278d(0x248)]];if(!_0x884657||!_0x884657['isActive'])return;document['getElementById'](_0x49278d(0x1132))[_0x49278d(0xb17)]['add']('minimized'),document['getElementById']('reading-restore-btn')[_0x49278d(0x842)][_0x49278d(0x5e9)]=_0x49278d(0xd52),_0x884657[_0x49278d(0xb3a)]=!![];}function _0x346c57(){const _0x4fd916=_0x18b51e,_0x54468c=_0x2fd142[_0x405767[_0x4fd916(0x248)]];if(!_0x54468c||!_0x54468c[_0x4fd916(0x6f0)])return;document[_0x4fd916(0x8c2)](_0x4fd916(0x853))[_0x4fd916(0x842)][_0x4fd916(0x5e9)]=_0x4fd916(0xbf8),document[_0x4fd916(0x8c2)](_0x4fd916(0x1132))['classList'][_0x4fd916(0xaff)](_0x4fd916(0xb49)),_0x54468c['isMinimized']=![];}function _0xdc25ea(_0x2606ed,_0x2a904c){let _0x39e274;return function(..._0x2e95f1){const _0x4e41d8=_0x7a65,_0x37b9ef=this;clearTimeout(_0x39e274),_0x39e274=setTimeout(()=>_0x2606ed[_0x4e41d8(0xd02)](_0x37b9ef,_0x2e95f1),_0x2a904c);};}function _0x4e8d2c(_0x7a0b03){const _0x167b31=_0x18b51e,_0x44df63=_0x2fd142[_0x7a0b03];if(!_0x44df63||!_0x44df63[_0x167b31(0x6f0)])return'';const _0x392136=_0x44df63[_0x167b31(0xcea)]||'未知书籍';let _0x48dd10='',_0x406950='';if(_0x44df63[_0x167b31(0x55e)]&&_0x44df63['currentSnippet'][_0x167b31(0x8c6)]())_0x48dd10=_0x44df63[_0x167b31(0x55e)],_0x406950=_0x167b31(0xbab);else{if(_0x44df63[_0x167b31(0xe7f)][_0x167b31(0x105a)]>0x0){const _0x77c647=_0x44df63['currentPage']*_0x44df63['linesPerPage'],_0x461a74=_0x77c647+_0x44df63[_0x167b31(0xb9c)];_0x48dd10=_0x44df63[_0x167b31(0xe7f)][_0x167b31(0x961)](_0x77c647,_0x461a74)['join']('\x0a')['substring'](0x0,0xc8),_0x406950=_0x167b31(0x97a);}else _0x48dd10=_0x167b31(0x912),_0x406950='内容';}return _0x167b31(0xd77)+_0x392136+_0x167b31(0x8f1)+_0x406950+'**:\x20\x22'+_0x48dd10+_0x167b31(0x3f5)+(_0x405767[_0x167b31(0x799)][_0x7a0b03]?.[_0x167b31(0x4e7)]||_0x167b31(0xa9e))+_0x167b31(0xb7d);}function _0x12e8f6(){const _0x55072f=_0x18b51e,_0x48950f=_0x405767[_0x55072f(0x248)];if(!_0x48950f||!_0x2fd142[_0x48950f])return;const _0x50d018=_0x2fd142[_0x48950f],_0x5611f4=document['getElementById'](_0x55072f(0x7a0)),_0x2a486f=_0x5611f4[_0x55072f(0xfd0)],_0x3bddab=_0x5611f4[_0x55072f(0x7b3)],_0x201445=_0x2a486f+_0x3bddab,_0x1eb5c9=0xf*1.8,_0x268b32=Math[_0x55072f(0x10b2)](_0x2a486f/_0x1eb5c9),_0x284915=Math['ceil'](_0x201445/_0x1eb5c9),_0x360e7c=_0x50d018['currentPage']*_0x50d018[_0x55072f(0xb9c)]+_0x268b32,_0x93b41d=_0x50d018[_0x55072f(0xe6e)]*_0x50d018[_0x55072f(0xb9c)]+_0x284915;if(_0x360e7c<0x0||_0x360e7c>=_0x50d018['contentLines']['length'])return;const _0x2837a6=_0x50d018['contentLines'][_0x55072f(0x961)](Math[_0x55072f(0x171)](0x0,_0x360e7c),Math[_0x55072f(0x10ff)](_0x50d018[_0x55072f(0xe7f)]['length'],_0x93b41d))['join']('\x0a');_0x50d018[_0x55072f(0x55e)]=_0x2837a6;}function _0x39230f(){const _0x595e91=_0x18b51e,_0x583abb=document[_0x595e91(0x8c2)](_0x595e91(0x54d));if(_0x583abb){const _0x32aeca=_0x583abb[_0x595e91(0xf12)]();_0x32aeca!==undefined&&_0x32aeca[_0x595e91(0xc15)](_0x2c2fea=>{const _0x2acfac=_0x595e91;console['log'](_0x2acfac(0xd2a));})[_0x595e91(0x120c)](_0xf34512=>{const _0xe9dc37=_0x595e91;console[_0xe9dc37(0x112a)](_0xe9dc37(0xfb9),_0xf34512);});}}function _0x5c79b7(){const _0x1f7273=_0x18b51e,_0x220500=document[_0x1f7273(0x8c2)](_0x1f7273(0x54d));_0x220500&&!_0x220500['paused']&&(_0x220500[_0x1f7273(0xf08)](),_0x220500[_0x1f7273(0xe5e)]=0x0,console[_0x1f7273(0x32b)](_0x1f7273(0xaef)));}async function _0x10f2be(_0x1eae29){const _0x45a6bf=_0x18b51e,_0x15e48d=decodeURIComponent(_0x1eae29[_0x45a6bf(0x323)][_0x45a6bf(0xbc6)]),_0x46f9a8=_0x1eae29['dataset'][_0x45a6bf(0x125e)],_0x179ed8=_0x1eae29[_0x45a6bf(0x1ad)](_0x45a6bf(0x393)),_0x2d6038=_0x1eae29['querySelector'](_0x45a6bf(0x160)),_0x1d7a2a=document[_0x45a6bf(0x8c2)](_0x45a6bf(0xda3));if(!_0x1d7a2a[_0x45a6bf(0xcf5)]&&_0x1d7a2a[_0x45a6bf(0x323)][_0x45a6bf(0x2ae)]===_0x15e48d&&_0x1d7a2a['dataset']['currentVoiceId']===_0x46f9a8){_0x1d7a2a['pause']();return;}_0x1d7a2a[_0x45a6bf(0xf08)](),document[_0x45a6bf(0xa2d)](_0x45a6bf(0x393))['forEach'](_0x367f89=>_0x367f89['textContent']='▶');const _0x3af90a=_0x45a6bf(0x194)+_0x46f9a8+'_'+_0x15e48d;let _0x53b3c0=_0x405767[_0x45a6bf(0x357)][_0x45a6bf(0x3e9)](_0x3af90a);if(_0x53b3c0){console[_0x45a6bf(0x32b)](_0x45a6bf(0xed2)),await _0x42ff03(_0x53b3c0[_0x45a6bf(0x9d6)],_0x53b3c0[_0x45a6bf(0xde0)],_0x15e48d,_0x46f9a8,_0x1eae29);return;}console[_0x45a6bf(0x32b)]('无缓存，正在请求\x20Minimax\x20TTS\x20API...');if(_0x179ed8)_0x179ed8[_0x45a6bf(0x842)]['display']='none';_0x2d6038[_0x45a6bf(0x842)][_0x45a6bf(0x5e9)]=_0x45a6bf(0xea7);const {minimaxGroupId:_0x17b4fc,minimaxApiKey:_0x44fa0c}=_0x405767[_0x45a6bf(0x9e0)];if(!_0x17b4fc||!_0x44fa0c){await _0x501c7b(_0x45a6bf(0x118e),'请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。'),_0x2d6038[_0x45a6bf(0x842)][_0x45a6bf(0x5e9)]=_0x45a6bf(0xbf8);if(_0x179ed8)_0x179ed8[_0x45a6bf(0x842)][_0x45a6bf(0x5e9)]='flex';return;}try{const _0x27d0a6=await fetch(_0x45a6bf(0xd7d)+_0x17b4fc,{'method':_0x45a6bf(0xcd0),'headers':{'Authorization':'Bearer\x20'+_0x44fa0c,'Content-Type':_0x45a6bf(0xcb6)},'body':JSON[_0x45a6bf(0x1175)]({'text':_0x15e48d,'voice_id':_0x46f9a8,'model':_0x405767[_0x45a6bf(0x9e0)][_0x45a6bf(0x68f)]||_0x45a6bf(0x11f3),'speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0x27d0a6['ok']){let _0x2e67f0=_0x45a6bf(0xf98)+_0x27d0a6[_0x45a6bf(0x8c8)];try{const _0x3a0a7d=await _0x27d0a6[_0x45a6bf(0x7e9)]();_0x2e67f0=_0x3a0a7d[_0x45a6bf(0x1218)]?.[_0x45a6bf(0x85c)]||JSON[_0x45a6bf(0x1175)](_0x3a0a7d);}catch(_0x58878e){_0x2e67f0=await _0x27d0a6[_0x45a6bf(0xbc6)]();}throw new Error(_0x2e67f0);}const _0x1c6857=await _0x27d0a6[_0x45a6bf(0x659)](),_0x3e85b6=URL[_0x45a6bf(0x90b)](_0x1c6857);await _0x42ff03(_0x3e85b6,_0x1c6857['type'],_0x15e48d,_0x46f9a8,_0x1eae29);const _0x463fcf=new FileReader();_0x463fcf[_0x45a6bf(0x758)]=function(){const _0x36719f=_0x45a6bf;_0x405767['ttsCache'][_0x36719f(0xf5a)](_0x3af90a,{'url':_0x463fcf[_0x36719f(0xa92)],'type':_0x1c6857[_0x36719f(0xde0)]}),console['log'](_0x36719f(0x10de));},_0x463fcf[_0x45a6bf(0x779)](_0x1c6857);}catch(_0x1bda45){console[_0x45a6bf(0x7a3)](_0x45a6bf(0x8fa),_0x1bda45),await _0x501c7b(_0x45a6bf(0xfdb),_0x45a6bf(0x350)+_0x1bda45[_0x45a6bf(0xc7d)]);}finally{_0x2d6038[_0x45a6bf(0x842)][_0x45a6bf(0x5e9)]=_0x45a6bf(0xbf8);if(_0x179ed8)_0x179ed8['style']['display']=_0x45a6bf(0xd52);}}function _0x42ff03(_0x22663d,_0x40fc98,_0x43f296,_0x536a2a,_0x46f9ab){return new Promise((_0x3425ba,_0xcb94ea)=>{const _0x5046b5=_0x7a65,_0xf600b4=document[_0x5046b5(0x8c2)](_0x5046b5(0xda3));_0xf600b4[_0x5046b5(0x939)]=_0x22663d,_0xf600b4['type']=_0x40fc98,_0xf600b4[_0x5046b5(0x323)][_0x5046b5(0x2ae)]=_0x43f296,_0xf600b4['dataset'][_0x5046b5(0x683)]=_0x536a2a;const _0x359f2e=_0xf600b4['play']();_0x359f2e!==undefined&&_0x359f2e['then'](()=>{const _0x19fc33=_0x5046b5,_0x566144=_0x46f9ab[_0x19fc33(0x1ad)](_0x19fc33(0x393));if(_0x566144)_0x566144[_0x19fc33(0x1090)]='❚❚';_0x3425ba();})[_0x5046b5(0x120c)](_0x4316f5=>{const _0x1c652f=_0x5046b5;console[_0x1c652f(0x7a3)](_0x1c652f(0x949),_0x4316f5),_0xcb94ea(_0x4316f5);}),_0xf600b4[_0x5046b5(0xe85)]=()=>{const _0x2d141c=_0x5046b5,_0x1e0c13=_0x46f9ab[_0x2d141c(0x1ad)](_0x2d141c(0x393));if(_0x1e0c13)_0x1e0c13[_0x2d141c(0x1090)]='▶';},_0xf600b4[_0x5046b5(0xe7b)]=()=>{const _0x323c4c=_0x5046b5,_0x4832c5=_0x46f9ab[_0x323c4c(0x1ad)](_0x323c4c(0x393));if(_0x4832c5)_0x4832c5[_0x323c4c(0x1090)]='▶';};});}function _0x38c7a9(_0x31004e){const _0x31bbf9=_0x18b51e,_0x157ddb=_0x31004e['closest'](_0x31bbf9(0xc46));if(!_0x157ddb)return;const _0x3e4a4c=_0x157ddb[_0x31bbf9(0x1ad)](_0x31bbf9(0x482)),_0x51a9f5=decodeURIComponent(_0x31004e[_0x31bbf9(0x323)][_0x31bbf9(0xbc6)]);_0x3e4a4c[_0x31bbf9(0x842)][_0x31bbf9(0x5e9)]===_0x31bbf9(0xea7)?_0x3e4a4c[_0x31bbf9(0x842)][_0x31bbf9(0x5e9)]='none':(_0x3e4a4c[_0x31bbf9(0x1090)]=_0x51a9f5,_0x3e4a4c['style'][_0x31bbf9(0x5e9)]='block');}async function _0x2bd311(){const _0x213059=_0x18b51e;await _0x2dff2a(),document[_0x213059(0x8c2)](_0x213059(0x561))[_0x213059(0xb17)]['add'](_0x213059(0x2cd));}async function _0x2dff2a(){const _0x293fbc=_0x18b51e,_0xc187c7=document['getElementById'](_0x293fbc(0x1212)),_0x3c463e=await _0x15043e[_0x293fbc(0x6ae)]['toArray']();_0xc187c7['innerHTML']='';if(_0x3c463e[_0x293fbc(0x105a)]===0x0){_0xc187c7['innerHTML']=_0x293fbc(0xfa8);return;}_0x3c463e[_0x293fbc(0x7c0)](_0x42245b=>{const _0x11d504=_0x293fbc,_0x2383ae=document[_0x11d504(0x8c1)]('div');_0x2383ae[_0x11d504(0x84c)]=_0x11d504(0x376),_0x2383ae[_0x11d504(0xca0)]=_0x11d504(0xa10)+_0x42245b[_0x11d504(0x596)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x42245b['id']+_0x11d504(0x7d7),_0xc187c7[_0x11d504(0x31e)](_0x2383ae);});}async function _0x1e4653(){const _0x8c4499=_0x18b51e,_0x5b4dd1=document[_0x8c4499(0x8c2)](_0x8c4499(0x623)),_0x1936a7=_0x5b4dd1['value']['trim']();if(!_0x1936a7)return alert(_0x8c4499(0xc42));const _0x23d552=await _0x15043e[_0x8c4499(0x6ae)][_0x8c4499(0xdb8)]('name')[_0x8c4499(0xc9a)](_0x1936a7)['first']();if(_0x23d552)return alert('分类\x20\x22'+_0x1936a7+'\x22\x20已经存在了！');await _0x15043e[_0x8c4499(0x6ae)][_0x8c4499(0x3f4)]({'name':_0x1936a7}),_0x5b4dd1['value']='',await _0x2dff2a();}async function _0x495bdf(_0x5c7fd0){const _0x545054=_0x18b51e,_0x14329c=await _0x8b9cb8(_0x545054(0xad9),_0x545054(0x11b0),{'confirmButtonClass':'btn-danger'});_0x14329c&&(await _0x15043e[_0x545054(0x6ae)][_0x545054(0x89f)](_0x5c7fd0),await _0x15043e[_0x545054(0x221)]['where']('categoryId')['equals'](_0x5c7fd0)[_0x545054(0x11d9)]({'categoryId':null}),await _0x2dff2a());}function _0x334fe3(_0x2ed034={}){const _0x307366=_0x18b51e,_0x54ca30=document[_0x307366(0x8c2)](_0x307366(0x1e4)),_0x2a63bb=document['createElement'](_0x307366(0x1072));return _0x2a63bb[_0x307366(0x84c)]=_0x307366(0x126f),_0x2a63bb[_0x307366(0xca0)]=_0x307366(0x345)+(_0x2ed034[_0x307366(0x596)]||'')+_0x307366(0x5ed)+(_0x2ed034[_0x307366(0x2ea)]||'')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22'+(_0x2ed034[_0x307366(0x10d4)]||_0x307366(0xac0))+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x2a63bb['querySelector']('.delete-block-btn')['addEventListener'](_0x307366(0xa17),()=>_0x2a63bb['remove']()),_0x2a63bb[_0x307366(0x1ad)](_0x307366(0x128f))[_0x307366(0xae8)]('click',()=>{const _0x195d2d=_0x307366;_0x2a63bb[_0x195d2d(0x1ad)](_0x195d2d(0x348))['click']();}),_0x2a63bb[_0x307366(0x1ad)]('.variation-image-input')['addEventListener'](_0x307366(0x7a7),_0x49823d=>{const _0x95416=_0x307366,_0x43c125=_0x49823d['target'][_0x95416(0xde8)][0x0];if(_0x43c125){const _0xe2d14b=new FileReader();_0xe2d14b[_0x95416(0xe7a)]=_0xefac40=>{const _0x3da8bd=_0x95416;_0x2a63bb[_0x3da8bd(0x1ad)]('.variation-image-preview')[_0x3da8bd(0x939)]=_0xefac40['target'][_0x3da8bd(0xa92)];},_0xe2d14b[_0x95416(0x779)](_0x43c125);}}),_0x54ca30[_0x307366(0x31e)](_0x2a63bb),_0x2a63bb;}async function _0x388e3c(_0xaeb08b){const _0x3387df=_0x18b51e,_0x5a6aea=await _0x15043e[_0x3387df(0x221)][_0x3387df(0x3e9)](_0xaeb08b);if(!_0x5a6aea||!_0x5a6aea['variations']||_0x5a6aea[_0x3387df(0x536)][_0x3387df(0x105a)]===0x0)return;const _0x56ffa8=document['getElementById'](_0x3387df(0xc58));document[_0x3387df(0x8c2)]('variation-product-image')[_0x3387df(0x939)]=_0x5a6aea['imageUrl'],document[_0x3387df(0x8c2)](_0x3387df(0x394))[_0x3387df(0x1090)]=_0x5a6aea['name'];const _0x4c9cf4=document[_0x3387df(0x8c2)](_0x3387df(0xd2e));_0x4c9cf4[_0x3387df(0xca0)]='',_0x5a6aea[_0x3387df(0x536)][_0x3387df(0x7c0)]((_0x54a390,_0x4c560e)=>{const _0x360ee7=_0x3387df,_0x41c97a=document[_0x360ee7(0x8c1)](_0x360ee7(0x58f));_0x41c97a[_0x360ee7(0xde0)]='radio',_0x41c97a[_0x360ee7(0x596)]=_0x360ee7(0xbc8),_0x41c97a['id']=_0x360ee7(0x27f)+_0xaeb08b+'-'+_0x4c560e,_0x41c97a[_0x360ee7(0x518)]=_0x4c560e,_0x41c97a[_0x360ee7(0x842)][_0x360ee7(0x5e9)]=_0x360ee7(0xbf8);if(_0x4c560e===0x0)_0x41c97a[_0x360ee7(0x75f)]=!![];const _0x2b7ac5=document['createElement'](_0x360ee7(0xbea));_0x2b7ac5[_0x360ee7(0x313)]=_0x360ee7(0x27f)+_0xaeb08b+'-'+_0x4c560e,_0x2b7ac5[_0x360ee7(0x1090)]=_0x54a390[_0x360ee7(0x596)],_0x2b7ac5[_0x360ee7(0x842)]['cssText']=_0x360ee7(0x4b0),_0x4c9cf4[_0x360ee7(0x31e)](_0x41c97a),_0x4c9cf4[_0x360ee7(0x31e)](_0x2b7ac5);});const _0x960ab=()=>{const _0x459dcb=_0x3387df,_0x36b10c=_0x4c9cf4[_0x459dcb(0x1ad)]('input[name=\x22variation-select\x22]:checked');_0x4c9cf4[_0x459dcb(0xa2d)]('label')[_0x459dcb(0x7c0)](_0x59f733=>{const _0x510890=_0x459dcb;_0x59f733['style']['borderColor']='#ccc',_0x59f733[_0x510890(0x842)]['color']=_0x510890(0x45d),_0x59f733[_0x510890(0x842)][_0x510890(0x617)]=_0x510890(0x34d);});if(_0x36b10c){const _0x3ed006=_0x4c9cf4['querySelector'](_0x459dcb(0x158)+_0x36b10c['id']+'\x22]');_0x3ed006[_0x459dcb(0x842)][_0x459dcb(0x1f4)]=_0x459dcb(0xe77),_0x3ed006[_0x459dcb(0x842)][_0x459dcb(0xac1)]=_0x459dcb(0xe77),_0x3ed006['style']['backgroundColor']='#e7f3ff';const _0x1122cf=_0x5a6aea[_0x459dcb(0x536)][parseInt(_0x36b10c[_0x459dcb(0x518)])];document[_0x459dcb(0x8c2)]('variation-selected-price')[_0x459dcb(0x1090)]='¥'+_0x1122cf[_0x459dcb(0x2ea)][_0x459dcb(0x3c1)](0x2),_0x1122cf['imageUrl']?document[_0x459dcb(0x8c2)](_0x459dcb(0x1221))[_0x459dcb(0x939)]=_0x1122cf[_0x459dcb(0x10d4)]:document['getElementById'](_0x459dcb(0x1221))['src']=_0x5a6aea['imageUrl'];}};_0x4c9cf4[_0x3387df(0xae8)](_0x3387df(0x7a7),_0x960ab),_0x960ab(),document[_0x3387df(0x8c2)](_0x3387df(0x7ae))['textContent']='1';const _0x31b012=document[_0x3387df(0x8c2)](_0x3387df(0x5b1)),_0x1f0be2=_0x31b012[_0x3387df(0xac5)](!![]);_0x31b012[_0x3387df(0xe66)][_0x3387df(0x56b)](_0x1f0be2,_0x31b012),_0x1f0be2[_0x3387df(0xae8)]('click',async()=>{const _0x1eaa61=_0x3387df,_0x49bb1b=_0x4c9cf4[_0x1eaa61(0x1ad)](_0x1eaa61(0x7fb)),_0x4d9676=parseInt(document[_0x1eaa61(0x8c2)](_0x1eaa61(0x7ae))[_0x1eaa61(0x1090)]);if(_0x49bb1b){const _0x520a55=_0x5a6aea[_0x1eaa61(0x536)][parseInt(_0x49bb1b[_0x1eaa61(0x518)])];await _0xf1dfb0(_0xaeb08b,_0x4d9676,_0x520a55),_0x56ffa8[_0x1eaa61(0xb17)]['remove'](_0x1eaa61(0x2cd)),await _0x501c7b('成功',_0x1eaa61(0x1244));}}),_0x56ffa8[_0x3387df(0xb17)][_0x3387df(0x3f4)](_0x3387df(0x2cd));}function _0x269782(){const _0x1fa947=_0x18b51e,_0x331d96=document[_0x1fa947(0x8c2)](_0x1fa947(0x528));document[_0x1fa947(0x8c2)](_0x1fa947(0xaf0))[_0x1fa947(0x518)]=_0x405767[_0x1fa947(0xb73)]['shoppingCategoryCount']||0x3,document[_0x1fa947(0x8c2)]('shopping-product-count-input')[_0x1fa947(0x518)]=_0x405767['globalSettings'][_0x1fa947(0xa7f)]||0x8,_0x331d96[_0x1fa947(0xb17)]['add'](_0x1fa947(0x2cd));}async function _0x31c2a5(){const _0x4deb19=_0x18b51e,_0x19927b=document[_0x4deb19(0x8c2)](_0x4deb19(0xaf0)),_0x567f1c=document[_0x4deb19(0x8c2)](_0x4deb19(0x642)),_0x2695eb=parseInt(_0x19927b[_0x4deb19(0x518)]),_0x5154bb=parseInt(_0x567f1c[_0x4deb19(0x518)]);if(isNaN(_0x2695eb)||isNaN(_0x5154bb)||_0x2695eb<0x1||_0x5154bb<0x1){alert(_0x4deb19(0xd21));return;}_0x405767[_0x4deb19(0xb73)][_0x4deb19(0x589)]=_0x2695eb,_0x405767[_0x4deb19(0xb73)][_0x4deb19(0xa7f)]=_0x5154bb,await _0x15043e['globalSettings'][_0x4deb19(0xfaa)](_0x405767[_0x4deb19(0xb73)]),document['getElementById'](_0x4deb19(0x528))[_0x4deb19(0xb17)][_0x4deb19(0xaff)](_0x4deb19(0x2cd)),await _0x501c7b(_0x4deb19(0xdce),'购物中心生成设置已更新！');}async function _0x497508(){const _0x5bb241=_0x18b51e;if(!_0x405767[_0x5bb241(0x248)]){await _0x501c7b(_0x5bb241(0xa85),'请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。');return;}const _0x23c87f=_0x405767[_0x5bb241(0x799)][_0x405767[_0x5bb241(0x248)]],_0x2c8c2e=await _0x8b9cb8('为“'+_0x23c87f[_0x5bb241(0x596)]+'”生成商品？',_0x5bb241(0x9e5),{'confirmText':_0x5bb241(0x10a0)});if(!_0x2c8c2e)return;await _0x501c7b(_0x5bb241(0x1047),'正在根据“'+_0x23c87f['name']+_0x5bb241(0x11e3));const _0x371282=_0x405767[_0x5bb241(0x9e0)][_0x5bb241(0x2fa)]&&_0x405767[_0x5bb241(0x9e0)][_0x5bb241(0x107f)]&&_0x405767['apiConfig'][_0x5bb241(0x234)],{proxyUrl:_0x5d00e0,apiKey:_0x2fad43,model:_0x351ae4}=_0x371282?{'proxyUrl':_0x405767[_0x5bb241(0x9e0)][_0x5bb241(0x2fa)],'apiKey':_0x405767[_0x5bb241(0x9e0)]['secondaryApiKey'],'model':_0x405767['apiConfig'][_0x5bb241(0x234)]}:_0x405767[_0x5bb241(0x9e0)];if(!_0x5d00e0||!_0x2fad43||!_0x351ae4){await _0x501c7b(_0x5bb241(0xc27),_0x5bb241(0x682));return;}const _0x3176dc=_0x405767[_0x5bb241(0xb73)]['shoppingCategoryCount']||0x3,_0x278e1b=_0x405767[_0x5bb241(0xb73)][_0x5bb241(0xa7f)]||0x8,_0x202912=await _0x15043e[_0x5bb241(0x6ae)][_0x5bb241(0x6be)]();let _0x3883f6='';_0x202912[_0x5bb241(0x105a)]>0x0&&(_0x3883f6='\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20['+_0x202912['map'](_0x10a84c=>'\x22'+_0x10a84c[_0x5bb241(0x596)]+'\x22')[_0x5bb241(0xb2c)](',\x20')+']\x0a');const _0x502fb2=_0x405767[_0x5bb241(0x20a)][_0x5bb241(0xab3)]||'我',_0x1f53a4=_0x23c87f['longTermMemory']&&_0x23c87f[_0x5bb241(0xbca)][_0x5bb241(0x105a)]>0x0?_0x23c87f[_0x5bb241(0xbca)][_0x5bb241(0x6b9)](_0x21a24e=>_0x5bb241(0xc09)+_0x4f34be(_0x21a24e['timestamp'])+')\x20'+_0x21a24e[_0x5bb241(0x168)])[_0x5bb241(0xb2c)]('\x0a'):'无',_0xa6b51e=_0x23c87f[_0x5bb241(0xd39)]['slice'](-0xa)['map'](_0x292907=>(_0x292907[_0x5bb241(0x14a)]===_0x5bb241(0x74b)?_0x502fb2:_0x23c87f[_0x5bb241(0x596)])+':\x20'+String(_0x292907['content'])[_0x5bb241(0x599)](0x0,0x1e)+'...')[_0x5bb241(0xb2c)]('\x0a');let _0xe9d805='';if(_0x23c87f['settings'][_0x5bb241(0xb77)]&&_0x23c87f[_0x5bb241(0x33a)][_0x5bb241(0xb77)][_0x5bb241(0x105a)]>0x0){const _0x1aaeb9=_0x23c87f['settings'][_0x5bb241(0xb77)]['map'](_0x4a784b=>{const _0xba38d=_0x5bb241,_0x9876e0=_0x405767[_0xba38d(0x40e)][_0xba38d(0x2ef)](_0x6fee69=>_0x6fee69['id']===_0x4a784b);if(!_0x9876e0||!Array[_0xba38d(0xb85)](_0x9876e0[_0xba38d(0x168)]))return'';const _0x56be3f=_0x9876e0[_0xba38d(0x168)][_0xba38d(0x1d8)](_0x58b8a5=>_0x58b8a5[_0xba38d(0x69a)]!==![])[_0xba38d(0x6b9)](_0x5c5ce9=>'-\x20'+_0x5c5ce9[_0xba38d(0x168)])[_0xba38d(0xb2c)]('\x0a');return _0x56be3f?_0xba38d(0x9a3)+_0x9876e0[_0xba38d(0x596)]+_0xba38d(0x156)+_0x56be3f:'';})[_0x5bb241(0x1d8)](Boolean)[_0x5bb241(0xb2c)]('');_0x1aaeb9&&(_0xe9d805='\x0a#\x20世界观设定\x20(必须参考)\x0a'+_0x1aaeb9+'\x0a');}const _0x571da2=_0x5bb241(0x6b6)+_0x23c87f[_0x5bb241(0x596)]+_0x5bb241(0xb79)+_0x3176dc+'\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20'+_0x278e1b+_0x5bb241(0x410)+_0x23c87f[_0x5bb241(0x596)]+'\x0a-\x20**角色人设**:\x20'+_0x23c87f['settings'][_0x5bb241(0x1060)]+_0x5bb241(0x278)+_0x1f53a4+'\x0a-\x20**世界书设定**:\x20'+_0xe9d805+'\x0a'+_0x3883f6+'\x0a-\x20**最近对话摘要**:\x0a'+_0xa6b51e+_0x5bb241(0x8a0)+_0x23c87f[_0x5bb241(0x596)]+_0x5bb241(0x915);try{const _0xc38f=[{'role':_0x5bb241(0x74b),'content':'请根据以上设定，生成商品数据。'}];let _0x1e401b=_0x5d00e0[_0x5bb241(0x773)](_0x5bb241(0x3fe)),_0x39f470=_0x282b7e(_0x351ae4,_0x2fad43,_0x571da2,_0xc38f);const _0x55581d=_0x1e401b?await fetch(_0x39f470[_0x5bb241(0x9d6)],_0x39f470[_0x5bb241(0x49a)]):await fetch(_0x5d00e0+_0x5bb241(0x5c1),{'method':_0x5bb241(0xcd0),'headers':{'Content-Type':_0x5bb241(0xcb6),'Authorization':'Bearer\x20'+_0x2fad43},'body':JSON[_0x5bb241(0x1175)]({'model':_0x351ae4,'messages':[{'role':'system','content':_0x571da2},..._0xc38f],'temperature':_0x405767[_0x5bb241(0xb73)][_0x5bb241(0x8c7)]||0.9})});if(!_0x55581d['ok'])throw new Error(_0x5bb241(0xd83)+_0x55581d['statusText']);const _0x4691a3=await _0x55581d[_0x5bb241(0x7e9)](),_0x1a06a0=getGeminiResponseText(_0x4691a3),_0x4c9e67=_0x1a06a0[_0x5bb241(0xdf8)](/({[\s\S]*})/);if(!_0x4c9e67)throw new Error('AI返回的内容中未找到有效的JSON对象。');const _0x42f84c=JSON['parse'](_0x4c9e67[0x0]);if(!_0x42f84c[_0x5bb241(0x979)]||!Array[_0x5bb241(0xb85)](_0x42f84c[_0x5bb241(0x979)]))throw new Error(_0x5bb241(0x11cf));await _0x15043e[_0x5bb241(0xa88)]('rw',_0x15043e['shoppingProducts'],_0x15043e['shoppingCategories'],async()=>{const _0x3eb60d=_0x5bb241;for(const _0x25c121 of _0x42f84c[_0x3eb60d(0x979)]){let _0x51ad32;const _0x573a72=await _0x15043e[_0x3eb60d(0x6ae)][_0x3eb60d(0xdb8)](_0x3eb60d(0x596))['equalsIgnoreCase'](_0x25c121[_0x3eb60d(0x596)])[_0x3eb60d(0xf2e)]();_0x573a72?_0x51ad32=_0x573a72['id']:_0x51ad32=await _0x15043e['shoppingCategories'][_0x3eb60d(0x3f4)]({'name':_0x25c121[_0x3eb60d(0x596)]});const _0x8764f3=_0x25c121[_0x3eb60d(0x850)][_0x3eb60d(0x6b9)](_0x5becaf=>{const _0xe3aa01=_0x3eb60d;return{'name':_0x5becaf[_0xe3aa01(0x596)],'price':_0x5becaf[_0xe3aa01(0x2ea)]||0x0,'description':_0x5becaf[_0xe3aa01(0x3ca)]||'','imageUrl':'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x5becaf[_0xe3aa01(0xdae)]),'variations':(_0x5becaf['variations']||[])[_0xe3aa01(0x6b9)](_0x3cd633=>({..._0x3cd633,'imageUrl':_0xe3aa01(0x2c6)+encodeURIComponent(_0x3cd633[_0xe3aa01(0xdae)])})),'categoryId':_0x51ad32};});_0x8764f3[_0x3eb60d(0x105a)]>0x0&&await _0x15043e[_0x3eb60d(0x221)][_0x3eb60d(0x116d)](_0x8764f3);}}),activeShoppingCategoryId=_0x5bb241(0xe88),await _0x34f254(),await _0x501c7b('生成成功！','为“'+_0x23c87f[_0x5bb241(0x596)]+_0x5bb241(0x1219));}catch(_0x1a346b){console['error'](_0x5bb241(0xeb6),_0x1a346b),await _0x501c7b('生成失败',_0x5bb241(0x6e2)+_0x1a346b[_0x5bb241(0xc7d)]);}}async function _0x3d564f(_0x5a0150){const _0x2e7732=_0x18b51e,_0x441d07=document['getElementById'](_0x5a0150);if(!_0x441d07)return;const _0x591a2a=await _0x40fef8(_0x2e7732(0x556),[{'text':_0x2e7732(0xf02),'value':_0x2e7732(0x6a0)},{'text':'🌐\x20使用网络URL','value':_0x2e7732(0x9d6)}]);let _0x1ff54d=null;if(_0x591a2a===_0x2e7732(0x6a0))_0x1ff54d=await _0x434b4d();else _0x591a2a==='url'&&(_0x1ff54d=await _0x180f74(_0x2e7732(0x556),'请输入新的图片URL：',_0x441d07[_0x2e7732(0x939)],_0x2e7732(0x9d6)));if(_0x1ff54d&&_0x1ff54d['trim']()){const _0x4043fb=_0x1ff54d[_0x2e7732(0x8c6)]();_0x441d07[_0x2e7732(0x939)]=_0x4043fb,!_0x405767['globalSettings'][_0x2e7732(0x1093)]&&(_0x405767[_0x2e7732(0xb73)][_0x2e7732(0x1093)]={}),_0x405767[_0x2e7732(0xb73)][_0x2e7732(0x1093)][_0x5a0150]=_0x4043fb,await _0x15043e[_0x2e7732(0xb73)][_0x2e7732(0xfaa)](_0x405767['globalSettings']),await _0x501c7b('成功',_0x2e7732(0xd22));}}window[_0x18b51e(0x186)]=_0x3d564f;async function _0x2e49a8(){const _0x219894=_0x18b51e;if(!window['streamSaver']){alert(_0x219894(0x800));return;}await _0x501c7b('正在准备...','即将开始下载您的完整备份文件。下载过程中请勿关闭页面。');const _0x3c2d01=streamSaver[_0x219894(0x124f)](_0x219894(0x5aa)+new Date()['toISOString']()[_0x219894(0x111f)]('T')[0x0]+_0x219894(0x10d8)),_0x30671a=_0x3c2d01[_0x219894(0xf27)](),_0x4dd430=new TextEncoder();try{await _0x30671a[_0x219894(0x167)](_0x4dd430['encode'](_0x219894(0x6f5)+Date[_0x219894(0x1ed)]()+',\x0a\x22data\x22:\x20{\x0a'));const _0x43e762=await _0x15043e[_0x219894(0x45e)]['map'](_0x19ad57=>_0x19ad57[_0x219894(0x596)]);for(let _0x425a4f=0x0;_0x425a4f<_0x43e762[_0x219894(0x105a)];_0x425a4f++){const _0x2fcc82=_0x43e762[_0x425a4f],_0xa39157=_0x15043e[_0x219894(0x7d9)](_0x2fcc82);await _0x30671a[_0x219894(0x167)](_0x4dd430[_0x219894(0xa62)]('\x22'+_0x2fcc82+_0x219894(0x5f4)));let _0x46d989=!![];await _0xa39157[_0x219894(0x72b)](_0x52cc20=>{const _0x10df98=_0x219894;!_0x46d989&&_0x30671a['write'](_0x4dd430[_0x10df98(0xa62)](',\x0a')),_0x30671a[_0x10df98(0x167)](_0x4dd430[_0x10df98(0xa62)](JSON[_0x10df98(0x1175)](_0x52cc20))),_0x46d989=![];}),await _0x30671a['write'](_0x4dd430['encode']('\x0a]')),_0x425a4f<_0x43e762[_0x219894(0x105a)]-0x1&&await _0x30671a['write'](_0x4dd430[_0x219894(0xa62)](',\x0a'));}await _0x30671a[_0x219894(0x167)](_0x4dd430['encode']('\x0a}\x0a}'));}catch(_0x293bea){console[_0x219894(0x7a3)]('流式导出过程中出错:',_0x293bea),await _0x501c7b('导出失败',_0x219894(0xc13)+_0x293bea['message']);}finally{await _0x30671a[_0x219894(0xf34)]();}}async function _0xdbf5f7(){const _0x2773f9=_0x18b51e;await _0x501c7b('正在准备...',_0x2773f9(0x361));try{const _0x38e624={'version':0x3,'timestamp':Date[_0x2773f9(0x1ed)](),'data':{}},_0x424dae=_0x15043e[_0x2773f9(0x45e)]['map'](_0x186292=>_0x186292[_0x2773f9(0x596)]);for(const _0x25e44f of _0x424dae){const _0x4a600a=await _0x15043e[_0x2773f9(0x7d9)](_0x25e44f)[_0x2773f9(0x6be)]();_0x38e624['data'][_0x25e44f]=_0x4a600a,console[_0x2773f9(0x32b)]('已打包表:\x20'+_0x25e44f+',\x20记录数:\x20'+_0x4a600a[_0x2773f9(0x105a)]);}const _0x2c9f08=new Blob([JSON[_0x2773f9(0x1175)](_0x38e624,null,0x2)],{'type':'application/json'}),_0x25c357=URL[_0x2773f9(0x90b)](_0x2c9f08),_0x2f7272=document[_0x2773f9(0x8c1)]('a');_0x2f7272['href']=_0x25c357,_0x2f7272[_0x2773f9(0x453)]=_0x2773f9(0x7ab)+new Date()[_0x2773f9(0x8a5)]()[_0x2773f9(0x111f)]('T')[0x0]+_0x2773f9(0x10d8),_0x2f7272[_0x2773f9(0xa17)](),URL['revokeObjectURL'](_0x25c357),await _0x501c7b(_0x2773f9(0x1d6),_0x2773f9(0x4e9));}catch(_0x423f04){console[_0x2773f9(0x7a3)]('传统导出数据时出错:',_0x423f04),await _0x501c7b(_0x2773f9(0x1051),'发生了一个错误:\x20'+_0x423f04[_0x2773f9(0xc7d)]);}}function _0xedf06(){const _0x3c3f93=_0x18b51e,_0x47a362=Object[_0x3c3f93(0x22f)](_0x405767['chats'])[_0x3c3f93(0x29a)]((_0x316ce2,_0x4afa99)=>{const _0x28a8f1=_0x3c3f93;if(_0x4afa99['id']===_0x405767[_0x28a8f1(0x248)])return _0x316ce2;return _0x316ce2+(_0x4afa99[_0x28a8f1(0xf10)]||0x0);},0x0),_0x5d2a8e=_0x38d2a9||0x0,_0xb8ba29=_0x47a362+_0x5d2a8e,_0x156502=document[_0x3c3f93(0x8c2)]('back-to-list-btn');if(!_0x156502)return;let _0x4e7340=_0x156502[_0x3c3f93(0x1ad)](_0x3c3f93(0xdf4));!_0x4e7340&&(_0x4e7340=document[_0x3c3f93(0x8c1)](_0x3c3f93(0x3ec)),_0x4e7340['className']=_0x3c3f93(0xc18),_0x156502[_0x3c3f93(0x31e)](_0x4e7340));let _0x1ddb47=_0x156502['querySelector'](_0x3c3f93(0x10c9));_0x1ddb47&&_0x1ddb47[_0x3c3f93(0xaff)](),_0xb8ba29>0x0?(_0x4e7340[_0x3c3f93(0x1090)]=_0xb8ba29>0x63?_0x3c3f93(0x65b):_0xb8ba29,_0x4e7340[_0x3c3f93(0x842)][_0x3c3f93(0x5e9)]=_0x3c3f93(0xea7),_0x4e7340[_0x3c3f93(0x842)][_0x3c3f93(0x1296)]='20',_0x4e7340['style']['transform']=_0x3c3f93(0x32a)):_0x4e7340[_0x3c3f93(0x842)]['display']=_0x3c3f93(0xbf8);}async function _0x1ccff2(){const _0x497273=_0x18b51e;async function _0x4a6b03(_0x462746){const _0x141d57=_0x7a65;if(!_0x462746)return;try{const _0x553590=await _0x462746['text'](),_0x4f62c3=JSON[_0x141d57(0x10ab)](_0x553590);if(_0x4f62c3[_0x141d57(0xde0)]==='EPhoneWorldBookBackup')console[_0x141d57(0x32b)](_0x141d57(0x34c)),await _0x595bb6(_0x4f62c3);else{if(_0x4f62c3[_0x141d57(0x6ff)]&&typeof _0x4f62c3['entries']===_0x141d57(0x7a5))console[_0x141d57(0x32b)](_0x141d57(0x1275)),await _0x434d49(_0x4f62c3,_0x462746[_0x141d57(0x596)]);else throw new Error(_0x141d57(0x534));}}catch(_0x226ddd){console[_0x141d57(0x7a3)]('导入世界书时出错:',_0x226ddd),await _0x501c7b('导入失败','文件解析或应用失败:\x20'+_0x226ddd[_0x141d57(0xc7d)]);}}async function _0x434d49(_0x57bb4a,_0x5d4401){const _0xd52fb4=_0x7a65,_0x4de29d=_0x5d4401[_0xd52fb4(0x1b7)](/\.json$/i,''),_0x2a052a=await _0x180f74('导入\x20Tavern\x20AI\x20世界书','请为这本设定集命名：',_0x4de29d);if(!_0x2a052a||!_0x2a052a[_0xd52fb4(0x8c6)]()){alert('导入已取消，因为未提供书名。');return;}const _0x514337=Object[_0xd52fb4(0x22f)](_0x57bb4a['entries'])['map'](_0x5d8280=>{const _0x3fe7ca=_0xd52fb4;return{'keys':_0x5d8280[_0x3fe7ca(0xe29)]||[],'comment':_0x5d8280[_0x3fe7ca(0x120a)]||'无备注','content':_0x5d8280[_0x3fe7ca(0x168)]||'','enabled':!_0x5d8280[_0x3fe7ca(0x634)]};})[_0xd52fb4(0x1d8)](_0x5ccc35=>_0x5ccc35[_0xd52fb4(0x168)]);if(_0x514337[_0xd52fb4(0x105a)]===0x0){alert(_0xd52fb4(0xfdf));return;}const _0x3acd25={'id':'wb_'+Date[_0xd52fb4(0x1ed)](),'name':_0x2a052a[_0xd52fb4(0x8c6)](),'content':_0x514337,'categoryId':null};await _0x15043e[_0xd52fb4(0x40e)][_0xd52fb4(0x3f4)](_0x3acd25),_0x405767[_0xd52fb4(0x40e)][_0xd52fb4(0xa49)](_0x3acd25),await _0x2d3fe9(),await _0x501c7b('导入成功！','已成功从\x20Tavern\x20AI\x20文件导入设定集《'+_0x2a052a+'》。');}async function _0x24f906(){const _0x3f1e85=_0x7a65;try{const _0x10fad2=await _0x15043e['worldBooks']['toArray'](),_0x504c59=await _0x15043e['worldBookCategories'][_0x3f1e85(0x6be)]();if(_0x10fad2[_0x3f1e85(0x105a)]===0x0&&_0x504c59[_0x3f1e85(0x105a)]===0x0){alert(_0x3f1e85(0x82d));return;}const _0x963f16={'type':_0x3f1e85(0x521),'version':0x1,'timestamp':Date[_0x3f1e85(0x1ed)](),'books':_0x10fad2,'categories':_0x504c59},_0x116e6a=new Blob([JSON[_0x3f1e85(0x1175)](_0x963f16,null,0x2)],{'type':'application/json'}),_0x414a59=URL[_0x3f1e85(0x90b)](_0x116e6a),_0x29aeb7=document[_0x3f1e85(0x8c1)]('a');_0x29aeb7[_0x3f1e85(0x922)]=_0x414a59,_0x29aeb7[_0x3f1e85(0x453)]='EPhone-WorldBooks-'+new Date()[_0x3f1e85(0x8a5)]()['split']('T')[0x0]+_0x3f1e85(0x10d8),_0x29aeb7['click'](),URL[_0x3f1e85(0xb0a)](_0x414a59),await _0x501c7b(_0x3f1e85(0x1d6),'所有世界书数据已成功导出！');}catch(_0x5803e9){console[_0x3f1e85(0x7a3)]('导出世界书时出错:',_0x5803e9),await _0x501c7b(_0x3f1e85(0x1051),_0x3f1e85(0xb10)+_0x5803e9['message']);}}async function _0x595bb6(_0x21f7bd){const _0x39b866=_0x7a65;try{if(_0x21f7bd['type']!=='EPhoneWorldBookBackup'||!_0x21f7bd[_0x39b866(0xaed)])throw new Error(_0x39b866(0x118c));const _0x344427=await _0x8b9cb8(_0x39b866(0x554),_0x39b866(0xf05),{'confirmButtonClass':_0x39b866(0xe2a),'confirmText':'确认覆盖'});if(!_0x344427)return;await _0x15043e['transaction']('rw',_0x15043e['worldBooks'],_0x15043e[_0x39b866(0x4a5)],async()=>{const _0x36abae=_0x39b866;await _0x15043e['worldBooks'][_0x36abae(0xa6a)](),await _0x15043e['worldBookCategories']['clear'](),Array['isArray'](_0x21f7bd['books'])&&await _0x15043e[_0x36abae(0x40e)][_0x36abae(0xcfd)](_0x21f7bd[_0x36abae(0xaed)]),Array[_0x36abae(0xb85)](_0x21f7bd[_0x36abae(0x979)])&&await _0x15043e['worldBookCategories'][_0x36abae(0xcfd)](_0x21f7bd[_0x36abae(0x979)]);}),_0x405767[_0x39b866(0x40e)]=await _0x15043e[_0x39b866(0x40e)]['toArray'](),await _0x2d3fe9(),await _0x501c7b(_0x39b866(0x95b),'世界书数据已成功恢复！');}catch(_0x4e0635){console[_0x39b866(0x7a3)](_0x39b866(0xb6f),_0x4e0635),await _0x501c7b(_0x39b866(0x8e8),_0x39b866(0x153)+_0x4e0635[_0x39b866(0xc7d)]);}}const _0xf7b19=localStorage['getItem'](_0x497273(0x1018));if(_0xf7b19){const _0x5e7535=(Date[_0x497273(0x1ed)]()-parseInt(_0xf7b19))/(0x3e8*0x3c);_0x5e7535>0x5&&_0x41c769(_0x5e7535);}_0x4a132f(),window[_0x497273(0x818)]=_0x3d1990,window['openRenderingRulesScreen']=_0x7c4b0f,window[_0x497273(0x6cb)]=_0x39aa4d,window['openCharacterSelector']=_0x1fbe5a,window['openCharApp']=_0x42db29,window[_0x497273(0x9e4)]=_0x1707ba,window[_0x497273(0xeec)]=_0x275dcf,window[_0x497273(0xef9)]=_0x476eb8,window[_0x497273(0x816)]=_0x2a7a98;const _0x54bfb6=document['createElement'](_0x497273(0x1072));_0x54bfb6['id']='sticker-action-bar',_0x54bfb6[_0x497273(0xca0)]='<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>',document[_0x497273(0x8c2)]('sticker-panel')[_0x497273(0x31e)](_0x54bfb6);const _0x49eba6=document[_0x497273(0x8c1)]('style');_0x49eba6['id']=_0x497273(0x3d0),document[_0x497273(0x1e0)][_0x497273(0x31e)](_0x49eba6),_0x1b5b07[_0x497273(0xbbe)]=document[_0x497273(0x8c2)](_0x497273(0x11fe)),_0x1b5b07['gridEl']=document['getElementById'](_0x497273(0x5fe));const _0xff99f7=localStorage[_0x497273(0xf13)](_0x497273(0xab1))||_0x497273(0xa14);_0x569569(_0xff99f7);const _0x58c9ed=document[_0x497273(0x8c1)](_0x497273(0x842));_0x58c9ed['id']=_0x497273(0x1fd),document[_0x497273(0x1e0)][_0x497273(0x31e)](_0x58c9ed);const _0x4d1775=document[_0x497273(0x8c1)](_0x497273(0x842));_0x4d1775['id']=_0x497273(0x767),document[_0x497273(0x1e0)]['appendChild'](_0x4d1775),_0x51f7b6('',_0x497273(0x10bc),_0x497273(0x1fd)),_0x51f7b6('','#settings-preview-area',_0x497273(0x767)),window[_0x497273(0x25a)]=_0x7c4b0f,window[_0x497273(0x818)]=_0x3d1990,window['renderChatListProxy']=_0x2b55d1,window[_0x497273(0xd6e)]=_0x4fa943,window['renderWallpaperScreenProxy']=_0x519e14,window['renderWorldBookScreenProxy']=_0x2d3fe9,await _0x343828(),_0x48f995(),await _0x519cf5(),_0x3b4393(_0x405767[_0x497273(0xb73)][_0x497273(0x653)]);const _0x3edfcc=parseInt(localStorage[_0x497273(0xf13)](_0x497273(0x37f)))||0x0;_0x156368(_0x3edfcc);_0x405767[_0x497273(0xb73)]&&_0x405767[_0x497273(0xb73)][_0x497273(0xa3a)]&&_0x218332(_0x405767[_0x497273(0xb73)][_0x497273(0xa3a)]);_0x202ddb(),setInterval(_0x202ddb,0x3e8*0x1e),_0x1017e4(),_0x131a64(),_0x1ff3cc(),_0x1a0ab7(),document[_0x497273(0x8c2)]('rules-tabs')[_0x497273(0xae8)]('click',_0x3e12ed=>{const _0x27e649=_0x497273;_0x3e12ed[_0x27e649(0x475)][_0x27e649(0xb17)]['contains']('rules-tab')&&_0x5ad026(_0x3e12ed[_0x27e649(0x475)][_0x27e649(0x323)][_0x27e649(0x792)]);}),document['getElementById'](_0x497273(0xa7e))[_0x497273(0xae8)]('click',()=>_0x119253(null)),document[_0x497273(0x8c2)](_0x497273(0x4b1))['addEventListener'](_0x497273(0xa17),()=>{const _0x15621e=_0x497273;document[_0x15621e(0x8c2)](_0x15621e(0xb9e))[_0x15621e(0xb17)][_0x15621e(0xaff)](_0x15621e(0x2cd));}),document[_0x497273(0x8c2)]('save-rule-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x18d739),document['getElementById'](_0x497273(0x7cc))['addEventListener'](_0x497273(0xa17),()=>{const _0xabdb6d=_0x497273;if(_0x405767[_0xabdb6d(0x248)]&&!_0x405767[_0xabdb6d(0x799)][_0x405767[_0xabdb6d(0x248)]][_0xabdb6d(0x1000)]){const _0x5d6321=_0x405767[_0xabdb6d(0x799)][_0x405767[_0xabdb6d(0x248)]];_0x4803c2(_0x5d6321['id'],_0x5d6321[_0xabdb6d(0x4e7)]);}});let _0x3bcd7d=null;function _0x118a01(_0x338e1f){const _0x53fac1=_0x497273;_0x3bcd7d=_0x338e1f;const _0x36b58b=_0x405767['chats'][_0x405767[_0x53fac1(0x248)]],_0x5ae0c5=_0x36b58b['announcements'][_0x53fac1(0x2ef)](_0x58b168=>_0x58b168['id']===_0x338e1f);if(!_0x5ae0c5)return;const _0x39fa3e=document[_0x53fac1(0x8c2)]('announcement-action-pin');_0x39fa3e[_0x53fac1(0x1090)]=_0x5ae0c5[_0x53fac1(0xe06)]?_0x53fac1(0x3c5):_0x53fac1(0x4c0),document[_0x53fac1(0x8c2)](_0x53fac1(0xc9e))['classList'][_0x53fac1(0x3f4)](_0x53fac1(0x2cd));}async function _0x2d09f2(){const _0xf20b22=_0x497273;if(!_0x3bcd7d)return;const _0x442c9f=_0x405767[_0xf20b22(0x799)][_0x405767[_0xf20b22(0x248)]],_0xab0209=_0x442c9f['announcements'][_0xf20b22(0x2ef)](_0x75067e=>_0x75067e['id']===_0x3bcd7d);_0xab0209&&(_0xab0209[_0xf20b22(0xe06)]=!_0xab0209[_0xf20b22(0xe06)],await _0x15043e[_0xf20b22(0x799)]['put'](_0x442c9f),_0x86a8ba()),document[_0xf20b22(0x8c2)](_0xf20b22(0xc9e))[_0xf20b22(0xb17)][_0xf20b22(0xaff)]('visible');}async function _0x299efa(){const _0x11cd79=_0x497273;if(!_0x3bcd7d)return;const _0x1aefbd=await _0x8b9cb8(_0x11cd79(0xad9),_0x11cd79(0x8d8),{'confirmButtonClass':_0x11cd79(0xe2a)});if(_0x1aefbd){const _0x5354b7=_0x405767[_0x11cd79(0x799)][_0x405767[_0x11cd79(0x248)]];_0x5354b7[_0x11cd79(0x5d6)]=_0x5354b7[_0x11cd79(0x5d6)][_0x11cd79(0x1d8)](_0x36c848=>_0x36c848['id']!==_0x3bcd7d),await _0x15043e[_0x11cd79(0x799)][_0x11cd79(0xfaa)](_0x5354b7),_0x86a8ba();}document[_0x11cd79(0x8c2)](_0x11cd79(0xc9e))['classList'][_0x11cd79(0xaff)](_0x11cd79(0x2cd));}document[_0x497273(0x8c2)](_0x497273(0xafd))['addEventListener'](_0x497273(0xa17),_0x2c84fc),document[_0x497273(0x8c2)](_0x497273(0x947))[_0x497273(0xae8)](_0x497273(0xa17),_0x3d4c99=>{const _0x3d7c64=_0x497273;if(_0x3d4c99[_0x3d7c64(0x475)]===_0x869e2c)_0x2c84fc();}),document[_0x497273(0x8c2)](_0x497273(0x3e1))[_0x497273(0xae8)]('click',async()=>{const _0x101ffb=_0x497273,_0x52018=await _0x40fef8(_0x101ffb(0x37e),[{'text':_0x101ffb(0x1207),'value':_0x101ffb(0xc11)},{'text':_0x101ffb(0x1fe),'value':_0x101ffb(0x659)}]);if(_0x52018==='stream')_0x2e49a8();else _0x52018===_0x101ffb(0x659)&&_0xdbf5f7();}),document[_0x497273(0x8c2)](_0x497273(0x86c))[_0x497273(0xae8)](_0x497273(0xa17),_0x55815a),document['getElementById'](_0x497273(0xc21))[_0x497273(0xae8)](_0x497273(0x7a7),_0x58f926=>{const _0x1ea94d=_0x497273;document[_0x1ea94d(0x8c2)](_0x1ea94d(0x838))[_0x1ea94d(0x842)][_0x1ea94d(0x5e9)]=_0x58f926[_0x1ea94d(0x475)][_0x1ea94d(0x75f)]?'block':_0x1ea94d(0xbf8);}),document[_0x497273(0x8c2)]('import-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>document[_0x497273(0x8c2)](_0x497273(0xd2c))['click']()),document[_0x497273(0x8c2)](_0x497273(0xfd4))[_0x497273(0xae8)](_0x497273(0x7a7),_0x284cb5=>{const _0x781a4d=_0x497273;document[_0x781a4d(0x8c2)](_0x781a4d(0xab4))[_0x781a4d(0x842)][_0x781a4d(0x5e9)]=_0x284cb5[_0x781a4d(0x475)][_0x781a4d(0x75f)]?_0x781a4d(0xea7):_0x781a4d(0xbf8);}),document[_0x497273(0x8c2)](_0x497273(0xd2c))[_0x497273(0xae8)](_0x497273(0x7a7),_0x4a032e=>_0x4ec9da(_0x4a032e[_0x497273(0x475)][_0x497273(0xde8)][0x0])),document['getElementById'](_0x497273(0x461))[_0x497273(0xae8)](_0x497273(0x7a7),_0x126837),document[_0x497273(0x8c2)](_0x497273(0xbb8))['addEventListener'](_0x497273(0xa17),()=>{const _0x47da87=_0x497273;_0x3976af={},_0x51f7b6('',_0x47da87(0x10bc),'custom-bubble-style'),_0x51f7b6('',_0x47da87(0x1081),_0x47da87(0x767)),_0x23ba0c(),_0x405767[_0x47da87(0x248)]=null,_0x3d1990(_0x47da87(0x3b7));}),document[_0x497273(0x8c2)](_0x497273(0x199))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x71c7ab=_0x497273,_0x3963ff=await _0x40fef8(_0x71c7ab(0x114a),[{'text':_0x71c7ab(0xe4c),'value':'manual'},{'text':'从角色卡导入\x20(.json/.png)','value':'import_card'}]);if(_0x3963ff===_0x71c7ab(0x478)){const _0x543100=await _0x180f74(_0x71c7ab(0x224),'请输入你想为Ta设置的【备注名】(例如:\x20哥哥)');if(!_0x543100||!_0x543100['trim']())return;const _0x340d79=await _0x180f74(_0x71c7ab(0x44c),_0x71c7ab(0xd19));if(!_0x340d79||!_0x340d79['trim']())return;const _0x3ed7be=_0x71c7ab(0xaf3)+Date[_0x71c7ab(0x1ed)](),_0xac755={'id':_0x3ed7be,'name':_0x543100[_0x71c7ab(0x8c6)](),'originalName':_0x340d79[_0x71c7ab(0x8c6)](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':_0x71c7ab(0xaa7),'blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date[_0x71c7ab(0x1ed)](),'isBusy':![]},'settings':{'aiPersona':_0x71c7ab(0xb1d),'myPersona':_0x71c7ab(0xdfa),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x49d2a4,'myAvatar':_0x49d2a4,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':_0x71c7ab(0xad0)},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x405767['chats'][_0x3ed7be]=_0xac755,await _0x15043e[_0x71c7ab(0x799)][_0x71c7ab(0xfaa)](_0xac755),_0x2b55d1();}else _0x3963ff===_0x71c7ab(0xed6)&&document[_0x71c7ab(0x8c2)]('import-card-input')[_0x71c7ab(0xa17)]();}),document[_0x497273(0x8c2)](_0x497273(0x663))['addEventListener']('click',_0x555ccb),document[_0x497273(0x8c2)]('transfer-cancel-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>document['getElementById'](_0x497273(0x70c))[_0x497273(0xb17)]['remove'](_0x497273(0x2cd))),document['getElementById']('transfer-confirm-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x1b76f1),document[_0x497273(0x8c2)]('listen-together-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x39aa4d),document[_0x497273(0x8c2)](_0x497273(0x6fd))[_0x497273(0xae8)](_0x497273(0xa17),()=>_0x221338(!![])),document[_0x497273(0x8c2)]('music-return-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x31e6d3),document[_0x497273(0x8c2)]('music-play-pause-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x3801a5),document[_0x497273(0x8c2)](_0x497273(0x1007))[_0x497273(0xae8)](_0x497273(0xa17),_0x3110d1),document['getElementById']('music-prev-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x1634b6),document['getElementById']('music-mode-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x20970f),document[_0x497273(0x8c2)](_0x497273(0x149))['addEventListener'](_0x497273(0xa17),()=>{const _0x5d554a=_0x497273;_0x3439d6(),document[_0x5d554a(0x8c2)](_0x5d554a(0x6eb))['classList'][_0x5d554a(0x3f4)](_0x5d554a(0x2cd));}),document['getElementById'](_0x497273(0x6b7))[_0x497273(0xae8)](_0x497273(0xa17),()=>document['getElementById'](_0x497273(0x6eb))[_0x497273(0xb17)]['remove'](_0x497273(0x2cd))),document[_0x497273(0x8c2)]('add-song-url-btn')[_0x497273(0xae8)]('click',_0x213a7d),document[_0x497273(0x8c2)](_0x497273(0xc4f))[_0x497273(0xae8)](_0x497273(0xa17),()=>document[_0x497273(0x8c2)](_0x497273(0x8da))[_0x497273(0xa17)]()),document[_0x497273(0x8c2)](_0x497273(0x8da))['addEventListener'](_0x497273(0x7a7),_0x391a58),document[_0x497273(0x8c2)](_0x497273(0x499))[_0x497273(0xae8)](_0x497273(0xa17),_0x3ff723=>{const _0x4404c7=_0x497273,_0xd5cbcf=_0x3ff723[_0x4404c7(0x475)],_0xc02d0f=parseInt(_0xd5cbcf['dataset']['index']);if(isNaN(_0xc02d0f))return;if(_0xd5cbcf[_0x4404c7(0xb17)][_0x4404c7(0x795)](_0x4404c7(0x5ae)))_0x52f1d7(_0xc02d0f);else{if(_0xd5cbcf['classList'][_0x4404c7(0x795)](_0x4404c7(0x1196)))_0x12b922(_0xc02d0f);else{if(_0xd5cbcf['classList'][_0x4404c7(0x795)](_0x4404c7(0x30c)))_0x38c179(_0xc02d0f);else _0xd5cbcf[_0x4404c7(0xb17)][_0x4404c7(0x795)]('delete-track-btn')&&_0x48f800(_0xc02d0f);}}}),_0x3fd13b[_0x497273(0xae8)](_0x497273(0x6ba),()=>{const _0xdecadd=_0x497273;document[_0xdecadd(0x8c2)](_0xdecadd(0xa3e))['classList']['remove']('spinning'),_0x3110d1();});const _0x2fbd81=document[_0x497273(0x8c2)](_0x497273(0x332));document[_0x497273(0x8c2)](_0x497273(0x427))[_0x497273(0xae8)]('click',()=>{const _0x3f2282=_0x497273;_0x39230f();const _0x366d68=_0x2fbd81[_0x3f2282(0x518)][_0x3f2282(0x8c6)]();if(!_0x366d68||!_0x405767[_0x3f2282(0x248)])return;const _0x307741=_0x405767[_0x3f2282(0x799)][_0x405767[_0x3f2282(0x248)]],_0x2ffbd1={'role':_0x3f2282(0x74b),'content':_0x366d68,'timestamp':Date[_0x3f2282(0x1ed)]()};_0x19e711&&(_0x2ffbd1['quote']=_0x19e711),_0x5c5c92(_0x2ffbd1,_0x307741),((async()=>{const _0x214461=_0x3f2282;_0x307741[_0x214461(0xd39)][_0x214461(0xa49)](_0x2ffbd1),await _0x15043e[_0x214461(0x799)][_0x214461(0xfaa)](_0x307741),_0x2b55d1();})()),_0x2fbd81['value']='',_0x2fbd81['style']['height']=_0x3f2282(0x541),_0x2fbd81[_0x3f2282(0x10f7)](),_0x54747e();}),document[_0x497273(0x8c2)]('wait-reply-btn')['addEventListener'](_0x497273(0xa17),_0x523815),_0x2fbd81[_0x497273(0xae8)]('keypress',_0xb931d2=>{const _0x2cae2a=_0x497273;_0xb931d2[_0x2cae2a(0xe29)]==='Enter'&&!_0xb931d2['shiftKey']&&(_0xb931d2[_0x2cae2a(0xd35)](),document[_0x2cae2a(0x8c2)](_0x2cae2a(0x427))['click']());}),document[_0x497273(0x8c2)](_0x497273(0x62c))[_0x497273(0xae8)](_0x497273(0x7a7),async _0x4ec7eb=>{const _0x45b33c=_0x4ec7eb['target']['files'][0x0];if(_0x45b33c){const _0x108ccb=await new Promise((_0x5c9f30,_0x2d542f)=>{const _0x2bc7d1=_0x7a65,_0x10cb77=new FileReader();_0x10cb77[_0x2bc7d1(0xe7a)]=()=>_0x5c9f30(_0x10cb77['result']),_0x10cb77['onerror']=()=>_0x2d542f(_0x10cb77[_0x2bc7d1(0x7a3)]),_0x10cb77['readAsDataURL'](_0x45b33c);});_0xca7708=_0x108ccb,_0x519e14();}}),document[_0x497273(0x8c2)](_0x497273(0x813))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x26b3e7=_0x497273;_0xca7708&&(_0x405767['globalSettings'][_0x26b3e7(0xc3a)]=_0xca7708),_0x405767[_0x26b3e7(0xb73)][_0x26b3e7(0x653)]=document[_0x26b3e7(0x8c2)]('global-css-input')[_0x26b3e7(0x518)][_0x26b3e7(0x8c6)](),_0x405767[_0x26b3e7(0xb73)]['notificationSoundUrl']=document['getElementById'](_0x26b3e7(0x11da))[_0x26b3e7(0x518)]['trim'](),_0x405767[_0x26b3e7(0xb73)][_0x26b3e7(0x1286)]=document[_0x26b3e7(0x8c2)](_0x26b3e7(0x2b6))[_0x26b3e7(0x75f)],await _0x15043e['globalSettings'][_0x26b3e7(0xfaa)](_0x405767['globalSettings']),_0x1017e4(),_0x5f1ba2(),_0xca7708=null,_0x1ff3cc(),_0xf3d9cb(),_0x3b4393(_0x405767['globalSettings'][_0x26b3e7(0x653)]),_0x48f995(),alert('外观设置已保存并应用！'),_0x3d1990(_0x26b3e7(0x835));});const _0x3f4408=document[_0x497273(0x8c2)]('messages-view');_0x3f4408[_0x497273(0xae8)]('scroll',()=>{const {scrollTop:_0x561502,scrollHeight:_0x4f03a5,clientHeight:_0x378239}=_0x3f4408;_0x4f03a5-_0x561502-_0x378239<_0x378239&&(!_0x5314bd&&_0x330f15());}),document[_0x497273(0x8c2)](_0x497273(0x2ec))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0xbe30d7=_0x497273;_0x405767[_0xbe30d7(0x9e0)][_0xbe30d7(0x34e)]=document['getElementById']('proxy-url')[_0xbe30d7(0x518)]['trim'](),_0x405767[_0xbe30d7(0x9e0)][_0xbe30d7(0x827)]=document[_0xbe30d7(0x8c2)]('api-key')[_0xbe30d7(0x518)][_0xbe30d7(0x8c6)](),_0x405767[_0xbe30d7(0x9e0)][_0xbe30d7(0x8ce)]=document[_0xbe30d7(0x8c2)](_0xbe30d7(0x512))[_0xbe30d7(0x518)],_0x405767[_0xbe30d7(0x9e0)][_0xbe30d7(0xa7d)]=document[_0xbe30d7(0x8c2)](_0xbe30d7(0x483))[_0xbe30d7(0x518)][_0xbe30d7(0x8c6)](),_0x405767[_0xbe30d7(0x9e0)][_0xbe30d7(0x971)]=document[_0xbe30d7(0x8c2)]('minimax-api-key')[_0xbe30d7(0x518)][_0xbe30d7(0x8c6)](),_0x405767[_0xbe30d7(0x9e0)][_0xbe30d7(0x68f)]=document[_0xbe30d7(0x8c2)](_0xbe30d7(0xdd7))[_0xbe30d7(0x518)],_0x405767[_0xbe30d7(0x9e0)][_0xbe30d7(0x2fa)]=document[_0xbe30d7(0x8c2)](_0xbe30d7(0x27a))[_0xbe30d7(0x518)][_0xbe30d7(0x8c6)](),_0x405767[_0xbe30d7(0x9e0)][_0xbe30d7(0x107f)]=document[_0xbe30d7(0x8c2)](_0xbe30d7(0x117d))[_0xbe30d7(0x518)]['trim'](),_0x405767[_0xbe30d7(0x9e0)][_0xbe30d7(0x234)]=document['getElementById'](_0xbe30d7(0x6df))['value'],await _0x15043e[_0xbe30d7(0x9e0)]['put'](_0x405767['apiConfig']);const _0x465e69=document['getElementById']('background-activity-switch'),_0x3a66b4=document['getElementById']('background-interval-input'),_0x557fc1=document[_0xbe30d7(0x8c2)](_0xbe30d7(0x3fc));_0x405767[_0xbe30d7(0xb73)][_0xbe30d7(0x105d)]=_0x465e69[_0xbe30d7(0x75f)],_0x405767[_0xbe30d7(0xb73)][_0xbe30d7(0x945)]=parseInt(_0x3a66b4['value'])||0x3c,_0x405767[_0xbe30d7(0xb73)][_0xbe30d7(0x11a1)]=parseFloat(_0x557fc1[_0xbe30d7(0x518)])||0x1,_0x405767[_0xbe30d7(0xb73)][_0xbe30d7(0xd00)]=document[_0xbe30d7(0x8c2)](_0xbe30d7(0xded))[_0xbe30d7(0x75f)],_0x405767[_0xbe30d7(0xb73)]['chatRenderWindow']=parseInt(document[_0xbe30d7(0x8c2)](_0xbe30d7(0xb33))[_0xbe30d7(0x518)])||0x32,_0x405767['globalSettings'][_0xbe30d7(0x743)]=parseInt(document[_0xbe30d7(0x8c2)](_0xbe30d7(0x256))[_0xbe30d7(0x518)])||0x1e,_0x405767['globalSettings'][_0xbe30d7(0x8c7)]=parseFloat(document['getElementById'](_0xbe30d7(0x50f))[_0xbe30d7(0x518)]),await _0x15043e[_0xbe30d7(0xb73)][_0xbe30d7(0xfaa)](_0x405767['globalSettings']),_0x50f373(),_0x405767['globalSettings'][_0xbe30d7(0x105d)]?(_0x1af605(),console[_0xbe30d7(0x32b)]('后台活动模拟已启动，间隔:\x20'+_0x405767[_0xbe30d7(0xb73)][_0xbe30d7(0x945)]+'秒')):console['log'](_0xbe30d7(0x613)),alert('所有API与后台设置已保存!');});const _0x21f8da=document[_0x497273(0x8c2)](_0x497273(0x49e));_0x21f8da['addEventListener'](_0x497273(0x10f7),_0x3d3a5d=>{const _0x48e8e9=_0x497273;_0x3d3a5d['target']['setAttribute']('type',_0x48e8e9(0xbc6));}),_0x21f8da[_0x497273(0xae8)](_0x497273(0x11f9),_0x28b08b=>{const _0x132640=_0x497273;_0x28b08b[_0x132640(0x475)][_0x132640(0x2ca)](_0x132640(0xde0),'password');});async function _0x97a07c(_0x8ffc83,_0xd46ecb,_0x12101a){const _0x45c155=_0x497273,_0x20a8d1=document['getElementById'](_0x8ffc83)['value'][_0x45c155(0x8c6)](),_0x49666e=document[_0x45c155(0x8c2)](_0xd46ecb)[_0x45c155(0x518)][_0x45c155(0x8c6)]();if(!_0x20a8d1||!_0x49666e)return alert(_0x45c155(0xc0c));try{let _0x4643f3=_0x20a8d1===GEMINI_API_URL;const _0x3fd6dc=await fetch(_0x4643f3?GEMINI_API_URL+'?key='+getRandomValue(_0x49666e):_0x20a8d1+'/v1/models',_0x4643f3?undefined:{'headers':{'Authorization':_0x45c155(0xf42)+_0x49666e}});if(!_0x3fd6dc['ok'])throw new Error(_0x45c155(0xef0));const _0x26167a=await _0x3fd6dc[_0x45c155(0x7e9)]();let _0x14922e=_0x4643f3?_0x26167a[_0x45c155(0x777)][_0x45c155(0x6b9)](_0x14a2ce=>({'id':_0x14a2ce['name'][_0x45c155(0x111f)]('/')[0x1]||_0x14a2ce[_0x45c155(0x596)]})):_0x26167a['data'];const _0x1d2883=document[_0x45c155(0x8c2)](_0x12101a);_0x1d2883[_0x45c155(0xca0)]='';const _0x5e03d8=_0x12101a===_0x45c155(0x512)?_0x405767[_0x45c155(0x9e0)][_0x45c155(0x8ce)]:_0x405767[_0x45c155(0x9e0)][_0x45c155(0x234)];_0x14922e[_0x45c155(0x7c0)](_0x5d1e53=>{const _0x49f96=_0x45c155,_0x251d85=document[_0x49f96(0x8c1)](_0x49f96(0x4f3));_0x251d85[_0x49f96(0x518)]=_0x5d1e53['id'],_0x251d85[_0x49f96(0x1090)]=_0x5d1e53['id'];if(_0x5d1e53['id']===_0x5e03d8)_0x251d85[_0x49f96(0x118f)]=!![];_0x1d2883[_0x49f96(0x31e)](_0x251d85);}),alert('模型列表已更新');}catch(_0xd15e45){alert('拉取模型失败:\x20'+_0xd15e45['message']);}}document[_0x497273(0x8c2)](_0x497273(0xdb9))[_0x497273(0xae8)]('click',()=>{const _0x40f479=_0x497273;_0x97a07c(_0x40f479(0xffa),_0x40f479(0x49e),_0x40f479(0x512));}),document[_0x497273(0x8c2)](_0x497273(0x342))['addEventListener']('click',()=>{const _0x40f696=_0x497273;_0x97a07c(_0x40f696(0x27a),_0x40f696(0x117d),_0x40f696(0x6df));}),document[_0x497273(0x8c2)](_0x497273(0x86e))['addEventListener'](_0x497273(0xa17),async()=>{const _0x4ae2e7=_0x497273,_0x16ceb6=await _0x180f74(_0x4ae2e7(0x5c8),'请输入书名');if(_0x16ceb6&&_0x16ceb6['trim']()){const _0x4d5883={'id':_0x4ae2e7(0x359)+Date[_0x4ae2e7(0x1ed)](),'name':_0x16ceb6[_0x4ae2e7(0x8c6)](),'content':''};await _0x15043e[_0x4ae2e7(0x40e)]['add'](_0x4d5883),_0x405767[_0x4ae2e7(0x40e)]['push'](_0x4d5883),_0x2d3fe9(),_0x339e40(_0x4d5883['id']);}}),document[_0x497273(0x8c2)](_0x497273(0x28a))[_0x497273(0xae8)]('click',async()=>{const _0x50e764=_0x497273;if(!_0x4ec30d)return;const _0x110d5c=_0x405767['worldBooks'][_0x50e764(0x2ef)](_0x473d2d=>_0x473d2d['id']===_0x4ec30d);if(!_0x110d5c)return;const _0xaeba30=document[_0x50e764(0x8c2)](_0x50e764(0xb6a))['value'][_0x50e764(0x8c6)]();if(!_0xaeba30){alert('书名不能为空！');return;}_0x110d5c[_0x50e764(0x596)]=_0xaeba30;const _0x4f6807=document[_0x50e764(0x8c2)]('world-book-category-select')[_0x50e764(0x518)];_0x110d5c[_0x50e764(0x792)]=_0x4f6807?parseInt(_0x4f6807):null;const _0xceaf1=document[_0x50e764(0x8c2)](_0x50e764(0x1235)),_0x5642ad=_0xceaf1['querySelectorAll'](_0x50e764(0x104b)),_0x143bf6=[];_0x5642ad[_0x50e764(0x7c0)](_0xe83a24=>{const _0x1c2741=_0x50e764,_0x278d61=_0xe83a24[_0x1c2741(0x1ad)](_0x1c2741(0x104f))[_0x1c2741(0x518)][_0x1c2741(0x8c6)](),_0x5e8745=_0xe83a24[_0x1c2741(0x1ad)](_0x1c2741(0xbe5))['value'][_0x1c2741(0x8c6)](),_0x22f135=_0xe83a24['querySelector'](_0x1c2741(0x182))['checked'];_0x5e8745&&_0x143bf6[_0x1c2741(0xa49)]({'comment':_0xe83a24['querySelector'](_0x1c2741(0x5b4))[_0x1c2741(0x518)][_0x1c2741(0x8c6)](),'keys':_0x278d61?_0x278d61[_0x1c2741(0x111f)](',')[_0x1c2741(0x6b9)](_0x516d62=>_0x516d62[_0x1c2741(0x8c6)]())['filter'](_0x1355d6=>_0x1355d6):[],'content':_0x5e8745,'enabled':_0x22f135});}),_0x110d5c[_0x50e764(0x168)]=_0x143bf6,await _0x15043e[_0x50e764(0x40e)][_0x50e764(0xfaa)](_0x110d5c),document[_0x50e764(0x8c2)](_0x50e764(0x91c))[_0x50e764(0x1090)]=_0xaeba30,_0x4ec30d=null,_0x3d1990(_0x50e764(0x28c)),await _0x2d3fe9();}),document[_0x497273(0x8c2)]('chat-messages')[_0x497273(0xae8)](_0x497273(0xa17),async _0x4e65fe=>{const _0xf3fad7=_0x497273,_0x48aa0b=_0x4e65fe[_0xf3fad7(0x475)][_0xf3fad7(0xa90)](_0xf3fad7(0xd04));if(_0x48aa0b){const _0x496d50=_0x405767['chats'][_0x405767[_0xf3fad7(0x248)]];if(!_0x496d50)return;_0x38c7a9(_0x48aa0b);const _0x48d5d0=_0x48aa0b[_0xf3fad7(0xa90)](_0xf3fad7(0xc46)),_0x288a99=_0x48d5d0?_0x48d5d0[_0xf3fad7(0x1ad)](_0xf3fad7(0x482)):null;if(_0x48aa0b[_0xf3fad7(0x323)][_0xf3fad7(0x125e)]&&_0x288a99&&_0x288a99[_0xf3fad7(0x842)][_0xf3fad7(0x5e9)]==='block'){if(_0x496d50[_0xf3fad7(0x1000)]){console[_0xf3fad7(0x32b)]('这是一条群聊语音消息，已禁止发起TTS请求。');return;}if(_0x496d50[_0xf3fad7(0x33a)][_0xf3fad7(0xa71)]===![]){console[_0xf3fad7(0x32b)]('“'+_0x496d50[_0xf3fad7(0x596)]+_0xf3fad7(0xd9d));return;}_0x10f2be(_0x48aa0b);}return;}const _0x289cfa=_0x4e65fe[_0xf3fad7(0x475)][_0xf3fad7(0xa90)](_0xf3fad7(0xe18));if(_0x289cfa){const _0x22cdab=_0x289cfa[_0xf3fad7(0xa90)](_0xf3fad7(0xc46));if(_0x22cdab){const _0x468c07=parseInt(_0x22cdab[_0xf3fad7(0x323)][_0xf3fad7(0x351)]);if(!isNaN(_0x468c07)){_0x10ee62(_0x468c07);return;}}}const _0x5586f9=_0x4e65fe[_0xf3fad7(0x475)]['closest'](_0xf3fad7(0x557));if(_0x5586f9){const _0x363f59=_0x5586f9[_0xf3fad7(0xa90)](_0xf3fad7(0xc46));if(_0x363f59){const _0x2210bf=parseInt(_0x363f59['dataset']['timestamp']),_0x2a29aa=_0x5586f9['dataset'][_0xf3fad7(0xa77)];if(!isNaN(_0x2210bf)&&_0x2a29aa){await _0x253ee0(_0x2210bf,_0x2a29aa);return;}}}const _0x410966=_0x4e65fe[_0xf3fad7(0x475)][_0xf3fad7(0xa90)](_0xf3fad7(0x1162));if(_0x410966){const _0x5c672d=parseInt(_0x410966['dataset']['postId']);if(!isNaN(_0x5c672d)){const _0x588253=await _0x15043e[_0xf3fad7(0xcc0)][_0xf3fad7(0x3e9)](_0x5c672d);if(_0x588253){let _0x5b2fdd='';const _0x2014e1=_0x588253[_0xf3fad7(0x802)]===_0xf3fad7(0x74b)?_0x405767[_0xf3fad7(0x20a)][_0xf3fad7(0xab3)]:_0x405767['chats'][_0x588253['authorId']]?.['name']||_0xf3fad7(0x7fd);if(_0x588253[_0xf3fad7(0xde0)]==='shuoshuo')_0x5b2fdd=_0x588253[_0xf3fad7(0x168)];else{_0x5b2fdd=_0x588253[_0xf3fad7(0x55d)]||'';if(_0x588253[_0xf3fad7(0x10d4)])_0x5b2fdd+=_0xf3fad7(0x891);if(_0x588253[_0xf3fad7(0x9eb)])_0x5b2fdd+=_0xf3fad7(0x33c)+_0x588253[_0xf3fad7(0x9eb)]+']';}_0x501c7b(_0xf3fad7(0x422)+_0x2014e1+_0xf3fad7(0x8fc),_0x5b2fdd[_0xf3fad7(0x1b7)](/\n/g,_0xf3fad7(0x854)));}else _0x501c7b('提示',_0xf3fad7(0xc61));}return;}const _0x11c6b1=_0x4e65fe[_0xf3fad7(0x475)][_0xf3fad7(0xa90)](_0xf3fad7(0x3a6));if(_0x11c6b1){const _0x5a186e=_0x11c6b1[_0xf3fad7(0x323)]['description'];if(_0x5a186e)_0x501c7b('照片描述',_0x5a186e);return;}const _0xd5948e=_0x4e65fe[_0xf3fad7(0x475)]['closest'](_0xf3fad7(0xe7e));if(_0xd5948e&&_0xd5948e['dataset'][_0xf3fad7(0x967)]){const _0x196507=parseInt(_0xd5948e[_0xf3fad7(0x323)][_0xf3fad7(0x967)]);!isNaN(_0x196507)&&_0x2a883c(_0x196507);}const _0x5071e2=_0x4e65fe[_0xf3fad7(0x475)][_0xf3fad7(0xa90)](_0xf3fad7(0xfae));if(_0x5071e2){const _0x2c18a5=_0x5071e2[_0xf3fad7(0xa90)](_0xf3fad7(0xc46));_0x2c18a5&&_0x506bc6(parseInt(_0x2c18a5[_0xf3fad7(0x323)][_0xf3fad7(0x351)]));}const _0x1e046e=_0x4e65fe[_0xf3fad7(0x475)][_0xf3fad7(0xa90)]('.red-packet-card');if(_0x1e046e){const _0x446151=_0x1e046e[_0xf3fad7(0xa90)]('.message-bubble');if(_0x446151&&_0x446151['dataset'][_0xf3fad7(0x351)]){const _0x4c591f=parseInt(_0x446151[_0xf3fad7(0x323)][_0xf3fad7(0x351)]);_0x1ee22(_0x4c591f);}}const _0x3a3ebb=_0x4e65fe[_0xf3fad7(0x475)][_0xf3fad7(0xa90)](_0xf3fad7(0xa81));if(_0x3a3ebb){const _0x4476d5=parseInt(_0x3a3ebb[_0xf3fad7(0x323)][_0xf3fad7(0x109a)]);if(isNaN(_0x4476d5))return;const _0x28a80c=_0x4e65fe[_0xf3fad7(0x475)][_0xf3fad7(0xa90)](_0xf3fad7(0x16c));if(_0x28a80c&&!_0x3a3ebb[_0xf3fad7(0xb17)][_0xf3fad7(0x795)](_0xf3fad7(0xed4))){_0x148de8(_0x4476d5,_0x28a80c[_0xf3fad7(0x323)]['option']);return;}const _0x620509=_0x4e65fe['target'][_0xf3fad7(0xa90)]('.poll-action-btn');if(_0x620509){_0x3a3ebb[_0xf3fad7(0xb17)][_0xf3fad7(0x795)](_0xf3fad7(0xed4))?_0x57f1a4(_0x4476d5):_0xac2567(_0x4476d5);return;}_0x3a3ebb[_0xf3fad7(0xb17)][_0xf3fad7(0x795)]('closed')&&_0x57f1a4(_0x4476d5);}const _0x245a7d=_0x4e65fe[_0xf3fad7(0x475)]['closest'](_0xf3fad7(0x6a4));if(_0x245a7d){const _0xf4f21e=_0x405767['chats'][_0x405767[_0xf3fad7(0x248)]],_0x545ebd=_0x245a7d[_0xf3fad7(0xa90)]('.message-wrapper');if(_0xf4f21e&&_0x545ebd){const _0x1f36a6=parseInt(_0x545ebd[_0xf3fad7(0x323)]['timestamp']),_0x2144ce=_0xf4f21e[_0xf3fad7(0xd39)][_0xf3fad7(0x2ef)](_0x4359ec=>_0x4359ec[_0xf3fad7(0x351)]===_0x1f36a6);if(_0x2144ce&&_0x2144ce['recalledData']){let _0x2530d5='';const _0x39c846=_0x2144ce[_0xf3fad7(0xf0e)];_0x39c846[_0xf3fad7(0x123c)]==='text'?_0x2530d5='原文:\x20\x22'+_0x39c846['originalContent']+'\x22':_0x2530d5='撤回了一条['+_0x39c846['originalType']+_0xf3fad7(0x3c2),_0x501c7b(_0xf3fad7(0x722),_0x2530d5);}}}const _0x2771f2=_0x4e65fe[_0xf3fad7(0x475)][_0xf3fad7(0xa90)]('.link-share-card');if(_0x2771f2&&_0x2771f2[_0xf3fad7(0xa90)](_0xf3fad7(0x862))){const _0xef302c=parseInt(_0x2771f2['dataset'][_0xf3fad7(0x351)]);_0x59355e(_0xef302c);}const _0x36e8b4=_0x4e65fe['target'][_0xf3fad7(0xa90)](_0xf3fad7(0xc46));if(_0x36e8b4&&_0x36e8b4[_0xf3fad7(0xb17)]['contains']('ai')&&_0x36e8b4['classList']['contains'](_0xf3fad7(0x1156))&&_0x36e8b4[_0xf3fad7(0x323)]['status']===_0xf3fad7(0xd2d)){const _0x5de11f=parseInt(_0x36e8b4[_0xf3fad7(0x323)]['timestamp']);!isNaN(_0x5de11f)&&_0x39c7cd(_0x5de11f);}});const _0x2236bf=document[_0x497273(0x8c2)]('chat-settings-modal'),_0x372705=document[_0x497273(0x1ad)](_0x497273(0x1276)),_0x186fdf=document[_0x497273(0x8c2)](_0x497273(0x3ab));function _0x372a9e(){const _0x4fb460=_0x497273,_0x1d28a9=_0x186fdf[_0x4fb460(0xa2d)]('input:checked'),_0x4d8b3b=document['querySelector'](_0x4fb460(0x9a2));if(_0x1d28a9[_0x4fb460(0x105a)]===0x0)_0x4d8b3b[_0x4fb460(0x1090)]=_0x4fb460(0x1281);else{if(_0x1d28a9[_0x4fb460(0x105a)]>0x2)_0x4d8b3b[_0x4fb460(0x1090)]=_0x4fb460(0x6a8)+_0x1d28a9[_0x4fb460(0x105a)]+_0x4fb460(0xf20);else{const _0x2daf2b=Array[_0x4fb460(0x51a)](_0x1d28a9)[_0x4fb460(0x6b9)](_0x52e25b=>{const _0x26318a=_0x4fb460;return _0x52e25b[_0x26318a(0x74f)][_0x26318a(0x1090)]['trim']();});_0x4d8b3b[_0x4fb460(0x1090)]=_0x2daf2b['join'](',\x20');}}}_0x372705[_0x497273(0xae8)](_0x497273(0xa17),_0x10d2eb=>{const _0x5a3fe2=_0x497273;_0x10d2eb[_0x5a3fe2(0x601)](),_0x186fdf['classList'][_0x5a3fe2(0xfc3)](_0x5a3fe2(0x2cd)),_0x372705[_0x5a3fe2(0xb17)][_0x5a3fe2(0xfc3)](_0x5a3fe2(0xd30));}),document[_0x497273(0x8c2)]('world-book-checkboxes-container')[_0x497273(0xae8)](_0x497273(0x7a7),_0x372a9e),window[_0x497273(0xae8)](_0x497273(0xa17),_0x90e54d=>{const _0x15d4ea=_0x497273;!document[_0x15d4ea(0x1ad)](_0x15d4ea(0x35d))['contains'](_0x90e54d['target'])&&(_0x186fdf[_0x15d4ea(0xb17)][_0x15d4ea(0xaff)](_0x15d4ea(0x2cd)),_0x372705['classList'][_0x15d4ea(0xaff)]('expanded'));}),document[_0x497273(0x8c2)](_0x497273(0x2fc))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x47737e=_0x497273;_0x954c8();if(!_0x405767['activeChatId'])return;const _0x4a3cae=_0x405767[_0x47737e(0x799)][_0x405767[_0x47737e(0x248)]],_0x5e36a7=_0x4a3cae[_0x47737e(0x1000)],_0x3f88ff=document[_0x47737e(0x8c2)](_0x47737e(0xdff));!_0x5e36a7&&_0x4a3cae['settings'][_0x47737e(0xace)]&&_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0xace)][_0x47737e(0x105a)]>0x0?_0x3f88ff[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x47737e(0xea7):_0x3f88ff[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x47737e(0xbf8);document['getElementById'](_0x47737e(0x5e4))['style'][_0x47737e(0x5e9)]=_0x47737e(0xea7),document[_0x47737e(0x8c2)]('my-persona-group')[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x47737e(0xea7),document['getElementById']('my-avatar-group')['style'][_0x47737e(0x5e9)]=_0x47737e(0xea7),document[_0x47737e(0x8c2)](_0x47737e(0x730))[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x5e36a7?_0x47737e(0xea7):_0x47737e(0xbf8),document[_0x47737e(0x8c2)](_0x47737e(0x574))[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x5e36a7?_0x47737e(0xbf8):_0x47737e(0xea7),document[_0x47737e(0x8c2)](_0x47737e(0xc45))[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x5e36a7?_0x47737e(0xea7):_0x47737e(0xbf8),document['getElementById'](_0x47737e(0xa63))['style']['display']=_0x5e36a7?_0x47737e(0xea7):'none',document[_0x47737e(0x8c2)](_0x47737e(0x1295))[_0x47737e(0x842)]['display']=_0x5e36a7?'none':_0x47737e(0xea7),document[_0x47737e(0x8c2)]('ai-avatar-group')[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x5e36a7?_0x47737e(0xbf8):_0x47737e(0xea7),document[_0x47737e(0x8c2)](_0x47737e(0x940))[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x5e36a7?_0x47737e(0xbf8):_0x47737e(0xea7),document[_0x47737e(0x8c2)]('ai-original-name-group')[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x5e36a7?'none':'block',document[_0x47737e(0x8c2)](_0x47737e(0x1138))[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x5e36a7?_0x47737e(0xbf8):_0x47737e(0xea7),document[_0x47737e(0x8c2)](_0x47737e(0x170))[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x5e36a7?_0x47737e(0xbf8):_0x47737e(0xea7),document[_0x47737e(0x8c2)](_0x47737e(0x4d7))['style']['display']=_0x5e36a7?_0x47737e(0xbf8):_0x47737e(0xea7),document[_0x47737e(0x8c2)](_0x47737e(0x559))[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x5e36a7?'none':'block',document[_0x47737e(0x8c2)](_0x47737e(0xc91))[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x5e36a7?_0x47737e(0xea7):_0x47737e(0xbf8),document['getElementById'](_0x47737e(0x9df))[_0x47737e(0x518)]=_0x4a3cae['name'],document[_0x47737e(0x8c2)](_0x47737e(0x419))[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)]['myPersona'],document[_0x47737e(0x8c2)](_0x47737e(0x10ba))[_0x47737e(0x939)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x11ed)]||(_0x5e36a7?_0x38e728:_0x49d2a4),document[_0x47737e(0x8c2)](_0x47737e(0xfe2))[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x808)],document[_0x47737e(0x8c2)](_0x47737e(0x6d3))[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x57d)]||0xa;const _0x5f4692=document[_0x47737e(0x8c2)](_0x47737e(0xd56)),_0x4d3709=document[_0x47737e(0x8c2)](_0x47737e(0x36f));_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x812)]?(_0x5f4692[_0x47737e(0x939)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x812)],_0x5f4692[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x47737e(0xea7),_0x4d3709['style'][_0x47737e(0x5e9)]=_0x47737e(0xd93)):(_0x5f4692[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x47737e(0xbf8),_0x4d3709['style'][_0x47737e(0x5e9)]='none');document[_0x47737e(0x8c2)](_0x47737e(0xbcd))[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x5e36a7?_0x47737e(0xbf8):_0x47737e(0xea7),document[_0x47737e(0x8c2)](_0x47737e(0x9ca))[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x5e36a7?_0x47737e(0xbf8):_0x47737e(0xea7),document[_0x47737e(0x8c2)]('group-background-activity-group')[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x5e36a7?'block':_0x47737e(0xbf8);const _0x426e1e=document[_0x47737e(0x8c2)]('time-perception-toggle'),_0x45f1a9=document[_0x47737e(0x8c2)]('time-zone-group');_0x426e1e['checked']=_0x4a3cae[_0x47737e(0x33a)]['enableTimePerception'],_0x45f1a9[_0x47737e(0x842)]['display']=_0x426e1e['checked']?_0x47737e(0xea7):'none';const _0x495b0d=document[_0x47737e(0x8c2)]('time-zone-select'),_0x345790=Intl[_0x47737e(0xab7)](_0x47737e(0xd68));_0x495b0d[_0x47737e(0xca0)]='',_0x345790[_0x47737e(0x7c0)](_0x39a728=>{const _0x2fa0e4=_0x47737e,_0x27b97d=document[_0x2fa0e4(0x8c1)](_0x2fa0e4(0x4f3));_0x27b97d[_0x2fa0e4(0x518)]=_0x39a728,_0x27b97d[_0x2fa0e4(0x1090)]=_0x39a728,_0x495b0d[_0x2fa0e4(0x31e)](_0x27b97d);}),_0x495b0d[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0xd68)]||_0x47737e(0xad0);if(_0x5e36a7)document[_0x47737e(0x8c2)]('group-background-activity-switch')[_0x47737e(0x75f)]=_0x4a3cae['settings'][_0x47737e(0x105d)],document[_0x47737e(0x8c2)](_0x47737e(0xa1d))[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0xe16)]||'',document[_0x47737e(0x8c2)](_0x47737e(0x96a))[_0x47737e(0x939)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x43b)]||_0x56835c,document[_0x47737e(0x8c2)](_0x47737e(0xef1))[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x107e)]||0xa,document[_0x47737e(0x8c2)](_0x47737e(0x9ca))[_0x47737e(0x842)][_0x47737e(0x5e9)]=_0x47737e(0xbf8),_0x4a129a(_0x4a3cae[_0x47737e(0x635)]);else{document[_0x47737e(0x8c2)](_0x47737e(0x9ca))[_0x47737e(0x842)]['display']=_0x47737e(0xea7),document[_0x47737e(0x8c2)](_0x47737e(0x335))[_0x47737e(0x75f)]=_0x4a3cae['settings'][_0x47737e(0x105d)],document['getElementById']('inject-thought-toggle')[_0x47737e(0x75f)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x3a9)];const _0x280835=document[_0x47737e(0x8c2)]('offline-mode-toggle'),_0x5e3dc0=document[_0x47737e(0x8c2)]('offline-mode-options'),_0x336c14=document[_0x47737e(0x8c2)](_0x47737e(0x9b6)),_0x3b3df5=document[_0x47737e(0x8c2)]('offline-max-length-input');_0x280835[_0x47737e(0x75f)]=_0x4a3cae[_0x47737e(0x33a)]['isOfflineMode']||![],_0x5e3dc0['style']['display']=_0x280835[_0x47737e(0x75f)]?_0x47737e(0xea7):'none',_0x336c14[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x1203)]||0x64,_0x3b3df5[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)]['offlineMaxLength']||0x12c,await _0x2516b4(_0x4a3cae),document[_0x47737e(0x8c2)]('ai-original-name-input')[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x4e7)],document[_0x47737e(0x8c2)]('ai-voice-id-input')[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x403)]||'',document[_0x47737e(0x8c2)]('enable-tts-switch')[_0x47737e(0x75f)]=_0x4a3cae['settings'][_0x47737e(0xa71)]!==![],document[_0x47737e(0x8c2)]('ai-persona')[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x1060)],document[_0x47737e(0x8c2)](_0x47737e(0xa34))['src']=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x44e)]||_0x49d2a4,document[_0x47737e(0x8c2)](_0x47737e(0x593))[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0xe16)]||'我',document[_0x47737e(0x8c2)](_0x47737e(0x1167))[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x107e)]||0xa;const _0x37de20=document['getElementById'](_0x47737e(0xbcc));_0x37de20[_0x47737e(0xca0)]='<option\x20value=\x22\x22>未分组</option>';const _0x288ca0=await _0x15043e[_0x47737e(0x232)][_0x47737e(0x6be)]();_0x288ca0[_0x47737e(0x7c0)](_0xfda9a=>{const _0x5a78b6=_0x47737e,_0x49f3ae=document[_0x5a78b6(0x8c1)](_0x5a78b6(0x4f3));_0x49f3ae[_0x5a78b6(0x518)]=_0xfda9a['id'],_0x49f3ae[_0x5a78b6(0x1090)]=_0xfda9a[_0x5a78b6(0x596)];if(_0x4a3cae[_0x5a78b6(0x40f)]===_0xfda9a['id'])_0x49f3ae[_0x5a78b6(0x118f)]=!![];_0x37de20['appendChild'](_0x49f3ae);});const _0x4763be=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0x45f)]||{'vertical':_0x47737e(0x9a4),'horizontal':'center','offset':0xa};document[_0x47737e(0x8c2)](_0x47737e(0x115b))['value']=_0x4763be[_0x47737e(0xe8f)],document[_0x47737e(0x8c2)](_0x47737e(0x8ff))[_0x47737e(0x518)]=_0x4763be[_0x47737e(0x157)],document[_0x47737e(0x8c2)](_0x47737e(0x280))['value']=_0x4763be[_0x47737e(0x780)];}const _0x5d1d90=document['getElementById'](_0x47737e(0x3ab));_0x5d1d90['innerHTML']='';const [_0x3c6c98,_0x4435a2]=await Promise[_0x47737e(0xe88)]([_0x15043e[_0x47737e(0x4a5)][_0x47737e(0x6be)](),_0x15043e[_0x47737e(0x40e)][_0x47737e(0x6be)]()]),_0x4e669=new Set(_0x4a3cae['settings']['linkedWorldBookIds']||[]);if(_0x4435a2[_0x47737e(0x105a)]===0x0)_0x5d1d90[_0x47737e(0xca0)]=_0x47737e(0xc85);else{_0x3c6c98['forEach'](_0x3152e8=>{const _0x486378=_0x47737e,_0xe80921=_0x4435a2[_0x486378(0x1d8)](_0xd56e75=>_0xd56e75[_0x486378(0x792)]===_0x3152e8['id']);if(_0xe80921[_0x486378(0x105a)]>0x0){const _0x2b7090=document[_0x486378(0x8c1)]('h4');_0x2b7090['textContent']=_0x3152e8[_0x486378(0x596)],_0x2b7090[_0x486378(0x842)][_0x486378(0x1d0)]=_0x486378(0x11ea),_0x5d1d90[_0x486378(0x31e)](_0x2b7090),_0xe80921[_0x486378(0x7c0)](_0x4b5dac=>{const _0x1add44=_0x486378,_0x5af836=_0x4e669[_0x1add44(0x11ac)](_0x4b5dac['id']),_0x1e090a=document[_0x1add44(0x8c1)](_0x1add44(0xbea));_0x1e090a[_0x1add44(0xca0)]='<input\x20type=\x22checkbox\x22\x20value=\x22book_'+_0x4b5dac['id']+'\x22\x20'+(_0x5af836?_0x1add44(0x75f):'')+'>\x20'+_0x4b5dac[_0x1add44(0x596)],_0x5d1d90['appendChild'](_0x1e090a);});}});const _0x246901=_0x4435a2['filter'](_0x1981d5=>!_0x1981d5[_0x47737e(0x792)]);if(_0x246901['length']>0x0){const _0x120412=document['createElement']('h4');_0x120412[_0x47737e(0x1090)]=_0x47737e(0xd1e),_0x120412['style'][_0x47737e(0x1d0)]=_0x47737e(0x9d4),_0x5d1d90[_0x47737e(0x31e)](_0x120412),_0x246901['forEach'](_0x5bc533=>{const _0x31b85a=_0x47737e,_0x32b698=_0x4e669[_0x31b85a(0x11ac)](_0x5bc533['id']),_0x12d273=document['createElement'](_0x31b85a(0xbea));_0x12d273[_0x31b85a(0xca0)]=_0x31b85a(0x485)+_0x5bc533['id']+'\x22\x20'+(_0x32b698?_0x31b85a(0x75f):'')+'>\x20'+_0x5bc533[_0x31b85a(0x596)],_0x5d1d90['appendChild'](_0x12d273);});}}_0x372a9e();const _0x4b6349=document['getElementById'](_0x47737e(0x8aa)),_0x2ce0d0=document[_0x47737e(0x8c2)](_0x47737e(0x307)),_0x2fd139=document[_0x47737e(0x8c2)](_0x47737e(0x1297)),_0x3124fb=_0x4a3cae['settings'][_0x47737e(0xb6e)]||[];_0x4b6349[_0x47737e(0x75f)]=_0x3124fb[_0x47737e(0x105a)]>0x0,_0x2ce0d0[_0x47737e(0x842)]['display']=_0x4b6349[_0x47737e(0x75f)]?_0x47737e(0xea7):_0x47737e(0xbf8),_0x2fd139['innerHTML']='',Object[_0x47737e(0x22f)](_0x405767[_0x47737e(0x799)])[_0x47737e(0x7c0)](_0x4ce6f7=>{const _0x201d9c=_0x47737e;if(_0x4ce6f7['id']===_0x4a3cae['id'])return;const _0x11f533=_0x3124fb[_0x201d9c(0x773)](_0x4ce6f7['id']),_0x335687=_0x4ce6f7[_0x201d9c(0x1000)]?'[群聊]':'[私聊]',_0x247bb9=document[_0x201d9c(0x8c1)](_0x201d9c(0xbea));_0x247bb9[_0x201d9c(0xca0)]=_0x201d9c(0x22d)+_0x4ce6f7['id']+'\x22\x20'+(_0x11f533?_0x201d9c(0x75f):'')+'>\x20'+_0x335687+'\x20'+_0x4ce6f7['name'],_0x2fd139[_0x201d9c(0x31e)](_0x247bb9);});function _0x59b67c(){const _0x915bc2=_0x47737e,_0x32cd29=_0x2fd139[_0x915bc2(0xa2d)](_0x915bc2(0x207)),_0x175ead=_0x2ce0d0[_0x915bc2(0x1ad)]('.selected-options-text');if(_0x32cd29[_0x915bc2(0x105a)]===0x0)_0x175ead[_0x915bc2(0x1090)]=_0x915bc2(0x1281);else _0x32cd29[_0x915bc2(0x105a)]>0x2?_0x175ead[_0x915bc2(0x1090)]=_0x915bc2(0x6a8)+_0x32cd29[_0x915bc2(0x105a)]+'\x20项':_0x175ead[_0x915bc2(0x1090)]=Array[_0x915bc2(0x51a)](_0x32cd29)[_0x915bc2(0x6b9)](_0x5989ba=>_0x5989ba['parentElement'][_0x915bc2(0x1090)][_0x915bc2(0x8c6)]())[_0x915bc2(0xb2c)](',\x20');}_0x59b67c(),_0x4b6349[_0x47737e(0xae8)]('change',()=>{const _0x29dcdc=_0x47737e;_0x2ce0d0[_0x29dcdc(0x842)][_0x29dcdc(0x5e9)]=_0x4b6349[_0x29dcdc(0x75f)]?_0x29dcdc(0xea7):_0x29dcdc(0xbf8);});const _0xe997ba=_0x2ce0d0[_0x47737e(0x1ad)](_0x47737e(0xe50)),_0x45cfc6=_0xe997ba[_0x47737e(0xac5)](!![]);_0xe997ba[_0x47737e(0xe66)][_0x47737e(0x56b)](_0x45cfc6,_0xe997ba),_0x45cfc6[_0x47737e(0xae8)](_0x47737e(0xa17),_0x2d961a=>{const _0x38acf1=_0x47737e;_0x2d961a['stopPropagation'](),_0x2fd139[_0x38acf1(0xb17)][_0x38acf1(0xfc3)]('visible'),_0x45cfc6[_0x38acf1(0xb17)][_0x38acf1(0xfc3)](_0x38acf1(0xd30));}),_0x2fd139['addEventListener'](_0x47737e(0x7a7),_0x59b67c);const _0x49f76b=document['querySelector'](_0x47737e(0xee7)+(_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0xf95)]||'default')+'\x22]');if(_0x49f76b)_0x49f76b[_0x47737e(0x75f)]=!![];const _0x2521a0=document['getElementById'](_0x47737e(0x8fd));_0x2521a0[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)]['fontSize']||0xd,document[_0x47737e(0x8c2)](_0x47737e(0x655))[_0x47737e(0x1090)]=_0x2521a0[_0x47737e(0x518)]+'px';const _0x54d1b9=document[_0x47737e(0x8c2)](_0x47737e(0x10b9));_0x54d1b9['value']=_0x4a3cae['settings'][_0x47737e(0x105f)]||'',_0x9e9510(),document['getElementById'](_0x47737e(0xf35))[_0x47737e(0x75f)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0xfee)]||![],document[_0x47737e(0x8c2)](_0x47737e(0x97d))[_0x47737e(0x518)]=_0x4a3cae[_0x47737e(0x33a)][_0x47737e(0xae7)]||0x14,_0x3d1990('chat-settings-screen');});function _0x4a129a(_0x504397){const _0x246f3f=_0x497273,_0x3e65ba=document[_0x246f3f(0x8c2)](_0x246f3f(0x895));_0x3e65ba[_0x246f3f(0xca0)]='',_0x504397[_0x246f3f(0x7c0)](_0x46c664=>{const _0x52cbec=_0x246f3f,_0x1d4abd=document['createElement'](_0x52cbec(0x1072));_0x1d4abd['className']=_0x52cbec(0xcfb),_0x1d4abd['dataset'][_0x52cbec(0x377)]=_0x46c664['id'];const _0xc5e876=_0x46c664[_0x52cbec(0x1e1)]||(_0x405767['chats'][_0x46c664['id']]?_0x405767['chats'][_0x46c664['id']]['settings'][_0x52cbec(0x44e)]:_0x9fdc61);_0x1d4abd[_0x52cbec(0xca0)]=_0x52cbec(0x333)+_0xc5e876+_0x52cbec(0x1023)+_0x46c664[_0x52cbec(0x375)]+_0x52cbec(0x1183)+_0x46c664[_0x52cbec(0x375)]+_0x52cbec(0x1079),_0x1d4abd[_0x52cbec(0xae8)](_0x52cbec(0xa17),()=>_0x244fb1(_0x46c664['id'])),_0x3e65ba[_0x52cbec(0x31e)](_0x1d4abd);});}document[_0x497273(0x8c2)](_0x497273(0x929))['addEventListener']('click',async()=>{const _0x50bd81=_0x497273;if(!_0x4c8670)return;const _0x3ba8e5=_0x405767[_0x50bd81(0x799)][_0x405767[_0x50bd81(0x248)]],_0x2bc2d9=_0x3ba8e5['members']['find'](_0x3f4784=>_0x3f4784['id']===_0x4c8670);if(!_0x2bc2d9)return;const _0x2ec6f0=document[_0x50bd81(0x8c2)](_0x50bd81(0x102f))[_0x50bd81(0x518)]['trim']();if(!_0x2ec6f0){alert(_0x50bd81(0xd4b));return;}_0x2bc2d9['groupNickname']=_0x2ec6f0,_0x2bc2d9[_0x50bd81(0x391)]=document[_0x50bd81(0x8c2)](_0x50bd81(0x543))[_0x50bd81(0x518)];const _0x1331ed=document[_0x50bd81(0x8c2)](_0x50bd81(0xa3c))[_0x50bd81(0x939)];_0x2bc2d9['avatar']=_0x1331ed;const _0x165f91=_0x405767[_0x50bd81(0x799)][_0x2bc2d9['id']];_0x165f91&&(_0x165f91['settings']['aiAvatar']=_0x1331ed,await _0x15043e[_0x50bd81(0x799)][_0x50bd81(0xfaa)](_0x165f91)),await _0x15043e['chats'][_0x50bd81(0xfaa)](_0x3ba8e5),_0x4a129a(_0x3ba8e5['members']),document[_0x50bd81(0x8c2)](_0x50bd81(0xb0b))['classList']['remove']('visible'),_0x4c8670=null;});function _0x244fb1(_0x43be3d){const _0x3b04b2=_0x497273;_0x4c8670=_0x43be3d;const _0x5e469c=_0x405767['chats'][_0x405767[_0x3b04b2(0x248)]],_0x3e558e=_0x5e469c[_0x3b04b2(0x635)][_0x3b04b2(0x2ef)](_0x58b926=>_0x58b926['id']===_0x43be3d);if(!_0x3e558e)return;document[_0x3b04b2(0x8c2)]('member-name-input')[_0x3b04b2(0x518)]=_0x3e558e[_0x3b04b2(0x375)],document['getElementById'](_0x3b04b2(0x543))['value']=_0x3e558e['persona'];const _0xc35cd3=_0x3e558e['avatar']||(_0x405767['chats'][_0x3e558e['id']]?_0x405767[_0x3b04b2(0x799)][_0x3e558e['id']][_0x3b04b2(0x33a)][_0x3b04b2(0x44e)]:_0x9fdc61);document[_0x3b04b2(0x8c2)]('member-avatar-preview')[_0x3b04b2(0x939)]=_0xc35cd3,document[_0x3b04b2(0x8c2)](_0x3b04b2(0xb0b))[_0x3b04b2(0xb17)][_0x3b04b2(0x3f4)](_0x3b04b2(0x2cd));}document[_0x497273(0x8c2)](_0x497273(0x395))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x4aca0a=_0x497273;document[_0x4aca0a(0x8c2)](_0x4aca0a(0xb0b))[_0x4aca0a(0xb17)][_0x4aca0a(0xaff)](_0x4aca0a(0x2cd)),_0x4c8670=null;}),document[_0x497273(0x8c2)](_0x497273(0x929))[_0x497273(0xae8)]('click',async()=>{const _0x14344e=_0x497273;if(!_0x4c8670)return;const _0x1b50d=_0x405767[_0x14344e(0x799)][_0x405767[_0x14344e(0x248)]],_0x37ddae=_0x1b50d[_0x14344e(0x635)][_0x14344e(0x2ef)](_0x598fe8=>_0x598fe8['id']===_0x4c8670);if(!_0x37ddae)return;const _0x1805f1=document[_0x14344e(0x8c2)](_0x14344e(0x102f))[_0x14344e(0x518)]['trim']();if(!_0x1805f1){alert(_0x14344e(0xd4b));return;}_0x37ddae['groupNickname']=_0x1805f1,_0x37ddae[_0x14344e(0x391)]=document[_0x14344e(0x8c2)](_0x14344e(0x543))[_0x14344e(0x518)];const _0x55773e=document['getElementById']('member-avatar-preview')['src'];_0x37ddae[_0x14344e(0x1e1)]=_0x55773e;const _0x246ff9=_0x405767[_0x14344e(0x799)][_0x37ddae['id']];_0x246ff9&&(_0x246ff9[_0x14344e(0x33a)][_0x14344e(0x44e)]=_0x55773e,await _0x15043e[_0x14344e(0x799)][_0x14344e(0xfaa)](_0x246ff9)),await _0x15043e[_0x14344e(0x799)][_0x14344e(0xfaa)](_0x1b50d),_0x4a129a(_0x1b50d[_0x14344e(0x635)]),document[_0x14344e(0x8c2)]('member-settings-modal')[_0x14344e(0xb17)][_0x14344e(0xaff)]('visible'),_0x4c8670=null;}),document['getElementById'](_0x497273(0xb2a))[_0x497273(0xae8)]('click',()=>{document['getElementById']('theme-default')['checked']=!![];}),document[_0x497273(0x8c2)](_0x497273(0xaa8))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x3858cb=_0x497273;if(!_0x405767['activeChatId'])return;const _0x42f934=_0x405767[_0x3858cb(0x799)][_0x405767[_0x3858cb(0x248)]],_0x1eef7b=_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0x10bf)]||![],_0x2530ad=document[_0x3858cb(0x8c2)](_0x3858cb(0x9df))[_0x3858cb(0x518)][_0x3858cb(0x8c6)]();if(!_0x2530ad)return alert(_0x3858cb(0x340));if(!_0x42f934[_0x3858cb(0x1000)]&&_0x2530ad!==_0x42f934[_0x3858cb(0x596)]){if(!_0x42f934[_0x3858cb(0x1116)])_0x42f934[_0x3858cb(0x1116)]=[];if(!_0x42f934[_0x3858cb(0x1116)]['includes'](_0x42f934[_0x3858cb(0x596)]))_0x42f934['nameHistory'][_0x3858cb(0xa49)](_0x42f934[_0x3858cb(0x596)]);}_0x42f934[_0x3858cb(0x596)]=_0x2530ad;const _0x3e7feb=document[_0x3858cb(0x1ad)](_0x3858cb(0xd66));_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0xf95)]=_0x3e7feb?_0x3e7feb[_0x3858cb(0x518)]:'default',_0x42f934[_0x3858cb(0x33a)]['fontSize']=parseInt(document[_0x3858cb(0x8c2)]('font-size-slider')[_0x3858cb(0x518)]),_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0x105f)]=document['getElementById'](_0x3858cb(0x10b9))['value'][_0x3858cb(0x8c6)](),_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0xbe8)]=document[_0x3858cb(0x8c2)]('my-persona')[_0x3858cb(0x518)],_0x42f934[_0x3858cb(0x33a)]['myAvatar']=document[_0x3858cb(0x8c2)](_0x3858cb(0x10ba))['src'],_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0x808)]=parseInt(document['getElementById']('max-memory')[_0x3858cb(0x518)])||0xa,_0x42f934[_0x3858cb(0x33a)]['linkedMemoryCount']=parseInt(document[_0x3858cb(0x8c2)](_0x3858cb(0x6d3))['value'])||0xa;const _0x46d5b0=document[_0x3858cb(0xa2d)]('#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked'),_0x56f8bc=[];_0x46d5b0['forEach'](_0x57e0d5=>{const _0x13f28f=_0x3858cb;_0x57e0d5[_0x13f28f(0x518)][_0x13f28f(0xc7c)](_0x13f28f(0xe96))&&_0x56f8bc[_0x13f28f(0xa49)](_0x57e0d5['value']['replace'](_0x13f28f(0xe96),''));}),_0x42f934['settings'][_0x3858cb(0xb77)]=_0x56f8bc;const _0x23f04e=document['getElementById'](_0x3858cb(0x8aa))[_0x3858cb(0x75f)];if(_0x23f04e){const _0x26e517=document['querySelectorAll'](_0x3858cb(0xdb6));_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0xb6e)]=Array['from'](_0x26e517)[_0x3858cb(0x6b9)](_0x578c2e=>_0x578c2e['value']);}else _0x42f934[_0x3858cb(0x33a)]['linkedMemoryChatIds']=[];_0x42f934['settings'][_0x3858cb(0xfee)]=document[_0x3858cb(0x8c2)](_0x3858cb(0xf35))[_0x3858cb(0x75f)],_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0xae7)]=parseInt(document[_0x3858cb(0x8c2)](_0x3858cb(0x97d))[_0x3858cb(0x518)])||0x14,_0x42f934['settings'][_0x3858cb(0xe87)]=document[_0x3858cb(0x8c2)]('time-perception-toggle')[_0x3858cb(0x75f)],_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0xd68)]=document[_0x3858cb(0x8c2)](_0x3858cb(0x645))[_0x3858cb(0x518)];if(_0x42f934[_0x3858cb(0x1000)])_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0x105d)]=document['getElementById']('group-background-activity-switch')['checked'],_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0xe16)]=document['getElementById']('my-group-nickname-input')[_0x3858cb(0x518)][_0x3858cb(0x8c6)](),_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0x43b)]=document[_0x3858cb(0x8c2)]('group-avatar-preview')[_0x3858cb(0x939)],_0x42f934[_0x3858cb(0x33a)]['actionCooldownMinutes']=parseInt(document[_0x3858cb(0x8c2)](_0x3858cb(0xef1))[_0x3858cb(0x518)])||0xa;else{_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0x105d)]=document[_0x3858cb(0x8c2)](_0x3858cb(0x335))['checked'];const _0x386320=document[_0x3858cb(0x8c2)](_0x3858cb(0xc21))['checked'];_0x42f934['settings'][_0x3858cb(0x10bf)]=_0x386320;if(_0x1eef7b===!![]&&_0x386320===![]){const _0x2605e1={'role':'system','content':_0x3858cb(0x9d8),'timestamp':Date[_0x3858cb(0x1ed)](),'isHidden':!![]};_0x42f934[_0x3858cb(0xd39)][_0x3858cb(0xa49)](_0x2605e1),console[_0x3858cb(0x32b)](_0x3858cb(0x2f3));}_0x42f934['settings'][_0x3858cb(0x3a9)]=document[_0x3858cb(0x8c2)]('inject-thought-toggle')[_0x3858cb(0x75f)],_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0x1203)]=parseInt(document[_0x3858cb(0x8c2)](_0x3858cb(0x9b6))['value'])||0x64,_0x42f934['settings'][_0x3858cb(0x13c)]=parseInt(document[_0x3858cb(0x8c2)](_0x3858cb(0xe53))[_0x3858cb(0x518)])||0x12c,_0x42f934[_0x3858cb(0x33a)]['offlinePresetId']=document[_0x3858cb(0x8c2)]('offline-preset-select')[_0x3858cb(0x518)]||null;const _0xbe6da=document['getElementById'](_0x3858cb(0xf71))[_0x3858cb(0x518)][_0x3858cb(0x8c6)]();if(!_0xbe6da)return alert(_0x3858cb(0x22b));_0x42f934[_0x3858cb(0x4e7)]=_0xbe6da,_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0x1060)]=document['getElementById'](_0x3858cb(0x11d1))[_0x3858cb(0x518)],_0x42f934['settings'][_0x3858cb(0x403)]=document[_0x3858cb(0x8c2)](_0x3858cb(0x117b))[_0x3858cb(0x518)]['trim'](),_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0xa71)]=document['getElementById'](_0x3858cb(0xfb1))[_0x3858cb(0x75f)],_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0x44e)]=document['getElementById'](_0x3858cb(0xa34))['src'],_0x42f934[_0x3858cb(0x33a)]['myNickname']=document[_0x3858cb(0x8c2)](_0x3858cb(0x593))[_0x3858cb(0x518)][_0x3858cb(0x8c6)]()||'我',_0x42f934[_0x3858cb(0x33a)]['actionCooldownMinutes']=parseInt(document['getElementById'](_0x3858cb(0x1167))['value'])||0xa,_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0x45f)]={'vertical':document[_0x3858cb(0x8c2)]('lyrics-vertical-pos')['value'],'horizontal':document[_0x3858cb(0x8c2)](_0x3858cb(0x8ff))[_0x3858cb(0x518)],'offset':parseInt(document[_0x3858cb(0x8c2)](_0x3858cb(0x280))['value'])||0xa};const _0x7bb500=document[_0x3858cb(0x8c2)](_0x3858cb(0xbcc))['value'];_0x42f934[_0x3858cb(0x40f)]=_0x7bb500?parseInt(_0x7bb500):null;}await _0x15043e[_0x3858cb(0x799)]['put'](_0x42f934),!_0x42f934[_0x3858cb(0x1000)]&&(await _0x4b93d2(_0x42f934),await _0x19507d(_0x42f934)),_0x37055b(_0x42f934),_0x51f7b6(_0x42f934[_0x3858cb(0x33a)][_0x3858cb(0x105f)],_0x3858cb(0x10bc),'custom-bubble-style'),_0x3d1990(_0x3858cb(0xd5c)),_0x7dbe71(_0x405767[_0x3858cb(0x248)]),_0x2b55d1();}),document[_0x497273(0x8c2)](_0x497273(0xdca))[_0x497273(0xae8)](_0x497273(0xa17),_0x461dab=>{const _0x4dc102=_0x497273;_0x461dab[_0x4dc102(0x475)]['classList'][_0x4dc102(0x795)](_0x4dc102(0x726))&&_0x11b4e7(_0x4dc102(0x6d4));}),document[_0x497273(0x8c2)](_0x497273(0xb0b))['addEventListener'](_0x497273(0xa17),_0x620fa0=>{const _0x1a9041=_0x497273;_0x620fa0[_0x1a9041(0x475)][_0x1a9041(0xb17)][_0x1a9041(0x795)]('change-frame-btn')&&_0x11b4e7('member');});const _0x21cbec=document[_0x497273(0x8c2)]('avatar-frame-modal'),_0x114d2f=document['getElementById'](_0x497273(0x903)),_0x2becdf=document[_0x497273(0x8c2)](_0x497273(0x1119)),_0x541769=document[_0x497273(0x8c2)](_0x497273(0x102a)),_0x3fa2c1=document[_0x497273(0x8c2)](_0x497273(0xec1));document[_0x497273(0x8c2)](_0x497273(0x4d1))[_0x497273(0xae8)](_0x497273(0xa17),_0x552ef8),document[_0x497273(0x8c2)](_0x497273(0x145))[_0x497273(0xae8)]('click',()=>{const _0x34963d=_0x497273;_0x21cbec[_0x34963d(0xb17)][_0x34963d(0xaff)](_0x34963d(0x2cd)),_0x309580=![];}),_0x114d2f[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x1b424b=_0x497273;_0x114d2f['classList'][_0x1b424b(0x3f4)](_0x1b424b(0x71b)),_0x2becdf[_0x1b424b(0xb17)][_0x1b424b(0xaff)](_0x1b424b(0x71b)),_0x541769[_0x1b424b(0x842)][_0x1b424b(0x5e9)]=_0x1b424b(0xea7),_0x3fa2c1[_0x1b424b(0x842)][_0x1b424b(0x5e9)]='none';}),_0x2becdf[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x3ff6b6=_0x497273;_0x2becdf['classList']['add']('active'),_0x114d2f['classList']['remove'](_0x3ff6b6(0x71b)),_0x3fa2c1[_0x3ff6b6(0x842)][_0x3ff6b6(0x5e9)]=_0x3ff6b6(0xea7),_0x541769['style'][_0x3ff6b6(0x5e9)]=_0x3ff6b6(0xbf8);}),document[_0x497273(0x8c2)](_0x497273(0x84d))['addEventListener'](_0x497273(0xa17),async()=>{const _0x164210=_0x497273;if(!_0x405767[_0x164210(0x248)])return;const _0xa3d293=_0x405767[_0x164210(0x799)][_0x405767[_0x164210(0x248)]],_0x3bf64e=await _0x8b9cb8(_0x164210(0xa8a),'此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？',{'confirmButtonClass':_0x164210(0xe2a)});_0x3bf64e&&(_0xa3d293[_0x164210(0xd39)]=[],_0xa3d293[_0x164210(0x211)]=_0x164210(0x388),_0xa3d293[_0x164210(0x103c)]='...',await _0x15043e[_0x164210(0x799)][_0x164210(0xfaa)](_0xa3d293),_0x7dbe71(_0x405767[_0x164210(0x248)]),_0x2b55d1(),_0x2236bf['classList'][_0x164210(0xaff)](_0x164210(0x2cd)));});const _0x37ee34=(_0x3e303b,_0x3db085)=>{const _0x5073a4=_0x497273;document[_0x5073a4(0x8c2)](_0x3e303b)[_0x5073a4(0xae8)](_0x5073a4(0x7a7),async _0x3b2a20=>{const _0x1723d3=_0x5073a4,_0x16eb39=_0x3b2a20[_0x1723d3(0x475)]['files'][0x0];if(_0x16eb39){const _0x5acc43=await new Promise((_0x126654,_0x8d6bd0)=>{const _0x3cca76=_0x1723d3,_0x1e363d=new FileReader();_0x1e363d[_0x3cca76(0xe7a)]=()=>_0x126654(_0x1e363d[_0x3cca76(0xa92)]),_0x1e363d[_0x3cca76(0x10bb)]=()=>_0x8d6bd0(_0x1e363d['error']),_0x1e363d[_0x3cca76(0x779)](_0x16eb39);});_0x3db085(_0x5acc43),_0x3b2a20[_0x1723d3(0x475)]['value']=null;}});};_0x37ee34(_0x497273(0xc66),_0x28487b=>document[_0x497273(0x8c2)](_0x497273(0xa34))[_0x497273(0x939)]=_0x28487b),_0x37ee34('my-avatar-input',_0x1f3fc4=>document[_0x497273(0x8c2)](_0x497273(0x10ba))['src']=_0x1f3fc4),_0x37ee34(_0x497273(0xdc8),_0x12868a=>document[_0x497273(0x8c2)](_0x497273(0x96a))['src']=_0x12868a),_0x37ee34(_0x497273(0x810),_0x45e187=>document[_0x497273(0x8c2)](_0x497273(0xa3c))[_0x497273(0x939)]=_0x45e187),_0x37ee34(_0x497273(0x363),_0x33f43b=>{const _0x4bf883=_0x497273;if(_0x405767[_0x4bf883(0x248)]){_0x405767[_0x4bf883(0x799)][_0x405767['activeChatId']][_0x4bf883(0x33a)][_0x4bf883(0x812)]=_0x33f43b;const _0x142e7a=document[_0x4bf883(0x8c2)]('bg-preview');_0x142e7a[_0x4bf883(0x939)]=_0x33f43b,_0x142e7a['style']['display']=_0x4bf883(0xea7),document[_0x4bf883(0x8c2)](_0x4bf883(0x36f))[_0x4bf883(0x842)][_0x4bf883(0x5e9)]=_0x4bf883(0xd93);}}),_0x37ee34('preset-avatar-input',_0x27eb2d=>document[_0x497273(0x8c2)](_0x497273(0x966))[_0x497273(0x939)]=_0x27eb2d),document['getElementById']('remove-bg-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x1073fb=_0x497273;if(_0x405767[_0x1073fb(0x248)]){_0x405767[_0x1073fb(0x799)][_0x405767[_0x1073fb(0x248)]][_0x1073fb(0x33a)][_0x1073fb(0x812)]='';const _0x4efcfe=document[_0x1073fb(0x8c2)](_0x1073fb(0xd56));_0x4efcfe[_0x1073fb(0x939)]='',_0x4efcfe[_0x1073fb(0x842)]['display']=_0x1073fb(0xbf8),document[_0x1073fb(0x8c2)](_0x1073fb(0x36f))[_0x1073fb(0x842)][_0x1073fb(0x5e9)]='none';}});const _0x50322e=document['getElementById'](_0x497273(0xf2a));document[_0x497273(0x8c2)](_0x497273(0x48a))['addEventListener'](_0x497273(0xa17),()=>{const _0x57ce4b=_0x497273;_0x1def9c(),_0x50322e[_0x57ce4b(0xb17)][_0x57ce4b(0x3f4)](_0x57ce4b(0x2cd));}),document[_0x497273(0x8c2)]('close-sticker-panel-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>_0x50322e[_0x497273(0xb17)][_0x497273(0xaff)](_0x497273(0x2cd))),document['getElementById']('add-sticker-batch-btn')[_0x497273(0xae8)]('click',_0x10c4c5),document[_0x497273(0x8c2)](_0x497273(0xdbc))['addEventListener'](_0x497273(0xa17),async()=>{const _0x30ee2c=_0x497273,_0x3c4b5a=await _0x180f74(_0x30ee2c(0x10fb),_0x30ee2c(0xf41));if(!_0x3c4b5a||!_0x3c4b5a[_0x30ee2c(0x8c6)]()[_0x30ee2c(0xc7c)](_0x30ee2c(0xcce))){if(_0x3c4b5a)alert(_0x30ee2c(0xe38));return;}const _0x39e561=await _0x180f74(_0x30ee2c(0xac7),_0x30ee2c(0x2cb));if(_0x39e561&&_0x39e561[_0x30ee2c(0x8c6)]()){const _0x4c1c7c={'id':'sticker_'+Date['now'](),'url':_0x3c4b5a[_0x30ee2c(0x8c6)](),'name':_0x39e561[_0x30ee2c(0x8c6)](),'categoryId':_0x5abf24!==_0x30ee2c(0xe88)&&_0x5abf24!==_0x30ee2c(0x606)?_0x5abf24:null};await _0x15043e['userStickers'][_0x30ee2c(0x3f4)](_0x4c1c7c),_0x405767[_0x30ee2c(0xc36)]['push'](_0x4c1c7c),_0x1def9c();}else _0x39e561!==null&&alert(_0x30ee2c(0x484));}),document[_0x497273(0x8c2)]('upload-sticker-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>document['getElementById']('sticker-upload-input')[_0x497273(0xa17)]()),document['getElementById'](_0x497273(0xffc))[_0x497273(0xae8)](_0x497273(0x7a7),async _0x538553=>{const _0x835a1b=_0x497273,_0x11a276=_0x538553[_0x835a1b(0x475)]['files'][0x0];if(!_0x11a276)return;const _0xb1f27a=new FileReader();_0xb1f27a[_0x835a1b(0x779)](_0x11a276),_0xb1f27a[_0x835a1b(0xe7a)]=async()=>{const _0x2d6204=_0x835a1b,_0x1bda1e=_0xb1f27a[_0x2d6204(0xa92)],_0x6e2d34=await _0x180f74(_0x2d6204(0xac7),_0x2d6204(0x109c));if(_0x6e2d34&&_0x6e2d34[_0x2d6204(0x8c6)]()){const _0x1c3437={'id':_0x2d6204(0x5cf)+Date['now'](),'url':_0x1bda1e,'name':_0x6e2d34[_0x2d6204(0x8c6)](),'categoryId':_0x5abf24!==_0x2d6204(0xe88)&&_0x5abf24!=='uncategorized'?_0x5abf24:null};await _0x15043e['userStickers'][_0x2d6204(0x3f4)](_0x1c3437),_0x405767['userStickers'][_0x2d6204(0xa49)](_0x1c3437),_0x1def9c();}else{if(_0x6e2d34!==null)alert(_0x2d6204(0x484));}},_0x538553[_0x835a1b(0x475)][_0x835a1b(0x518)]=null;}),document[_0x497273(0x8c2)]('upload-image-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>document[_0x497273(0x8c2)](_0x497273(0x7cf))[_0x497273(0xa17)]()),document[_0x497273(0x8c2)]('image-upload-input')[_0x497273(0xae8)](_0x497273(0x7a7),async _0xf17c0f=>{const _0x4d907f=_0x497273,_0x332192=_0xf17c0f['target'][_0x4d907f(0xde8)][0x0];if(!_0x332192||!_0x405767[_0x4d907f(0x248)])return;const _0x568acc=new FileReader();_0x568acc[_0x4d907f(0xe7a)]=async _0x3c8843=>{const _0x373281=_0x4d907f,_0x5bf80e=_0x3c8843[_0x373281(0x475)][_0x373281(0xa92)],_0x1c0e43=_0x405767[_0x373281(0x799)][_0x405767[_0x373281(0x248)]],_0x57cef7={'role':'user','content':[{'type':_0x373281(0x7a9),'image_url':{'url':_0x5bf80e}}],'timestamp':Date['now']()};_0x1c0e43[_0x373281(0xd39)]['push'](_0x57cef7),await _0x15043e[_0x373281(0x799)][_0x373281(0xfaa)](_0x1c0e43),_0x5c5c92(_0x57cef7,_0x1c0e43),_0x2b55d1();},_0x568acc[_0x4d907f(0x779)](_0x332192),_0xf17c0f[_0x4d907f(0x475)]['value']=null;}),document[_0x497273(0x8c2)](_0x497273(0x103d))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x157113=_0x497273;if(!_0x405767[_0x157113(0x248)])return;const _0x31da95=await _0x180f74(_0x157113(0xa5a),'请输入你想说的内容：');if(_0x31da95&&_0x31da95[_0x157113(0x8c6)]()){const _0x4a10e4=_0x405767[_0x157113(0x799)][_0x405767[_0x157113(0x248)]],_0x659e44={'role':_0x157113(0x74b),'type':_0x157113(0xf64),'content':_0x31da95[_0x157113(0x8c6)](),'timestamp':Date[_0x157113(0x1ed)]()};_0x4a10e4[_0x157113(0xd39)][_0x157113(0xa49)](_0x659e44),await _0x15043e['chats'][_0x157113(0xfaa)](_0x4a10e4),_0x5c5c92(_0x659e44,_0x4a10e4),_0x2b55d1();}}),document[_0x497273(0x8c2)](_0x497273(0x1009))['addEventListener']('click',async()=>{const _0x1b0d0a=_0x497273;if(!_0x405767['activeChatId'])return;const _0x256fb7=await _0x180f74(_0x1b0d0a(0xc87),_0x1b0d0a(0x1108));if(_0x256fb7&&_0x256fb7[_0x1b0d0a(0x8c6)]()){const _0x61fdf8=_0x405767['chats'][_0x405767['activeChatId']],_0x37deb5={'role':_0x1b0d0a(0x74b),'type':_0x1b0d0a(0x223),'content':_0x256fb7['trim'](),'timestamp':Date['now']()};_0x61fdf8[_0x1b0d0a(0xd39)][_0x1b0d0a(0xa49)](_0x37deb5),await _0x15043e[_0x1b0d0a(0x799)][_0x1b0d0a(0xfaa)](_0x61fdf8),_0x5c5c92(_0x37deb5,_0x61fdf8),_0x2b55d1();}});const _0x419ef0=document['getElementById']('waimai-request-modal');document[_0x497273(0x8c2)]('send-waimai-request-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x45d289=_0x497273;_0x419ef0['classList'][_0x45d289(0x3f4)](_0x45d289(0x2cd));}),_0x419ef0[_0x497273(0xae8)](_0x497273(0xa17),_0x35451d=>{const _0x556cf3=_0x497273;_0x35451d[_0x556cf3(0x475)]===_0x419ef0&&_0x419ef0[_0x556cf3(0xb17)]['remove'](_0x556cf3(0x2cd));}),document[_0x497273(0x8c2)](_0x497273(0x89c))['addEventListener'](_0x497273(0xa17),_0x2ada65),document[_0x497273(0x8c2)](_0x497273(0x3aa))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x427e33=_0x497273;if(!_0x405767[_0x427e33(0x248)])return;const _0x23a706=document[_0x427e33(0x8c2)](_0x427e33(0x3ad)),_0x634d2d=document['getElementById']('waimai-amount'),_0x50bcb1=_0x23a706['value'][_0x427e33(0x8c6)](),_0x22ecd1=parseFloat(_0x634d2d['value']);if(!_0x50bcb1||isNaN(_0x22ecd1)||_0x22ecd1<=0x0){alert(_0x427e33(0xe73));return;}const _0x385bbc=_0x405767[_0x427e33(0x799)][_0x405767[_0x427e33(0x248)]],_0x49334b=Date[_0x427e33(0x1ed)](),_0x17ab5e=_0x385bbc['isGroup']?_0x385bbc[_0x427e33(0x33a)][_0x427e33(0xe16)]||'我':'我',_0x57dfda={'role':_0x427e33(0x74b),'senderName':_0x17ab5e,'type':'waimai_request','productInfo':_0x50bcb1,'amount':_0x22ecd1,'status':_0x427e33(0xd2d),'countdownEndTime':_0x49334b+0xf*0x3c*0x3e8,'timestamp':_0x49334b};_0x385bbc['history'][_0x427e33(0xa49)](_0x57dfda),await _0x15043e['chats'][_0x427e33(0xfaa)](_0x385bbc),_0x5c5c92(_0x57dfda,_0x385bbc),_0x2b55d1(),_0x23a706[_0x427e33(0x518)]='',_0x634d2d['value']='',_0x419ef0['classList'][_0x427e33(0xaff)](_0x427e33(0x2cd));}),document[_0x497273(0x8c2)]('open-persona-library-btn')[_0x497273(0xae8)]('click',_0x359910),document[_0x497273(0x8c2)]('close-persona-library-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x11bd20),document[_0x497273(0x8c2)](_0x497273(0x988))[_0x497273(0xae8)](_0x497273(0xa17),_0x2be6f6),document[_0x497273(0x8c2)](_0x497273(0x6e7))[_0x497273(0xae8)](_0x497273(0xa17),_0x354b50),document['getElementById'](_0x497273(0xdb3))[_0x497273(0xae8)]('click',_0x339451),document[_0x497273(0x8c2)](_0x497273(0xbd4))[_0x497273(0xae8)](_0x497273(0xa17),_0x20f044),document['getElementById'](_0x497273(0x703))[_0x497273(0xae8)](_0x497273(0xa17),_0x4f581f),document[_0x497273(0x8c2)]('preset-action-cancel')[_0x497273(0xae8)](_0x497273(0xa17),_0x2c686b),document[_0x497273(0x8c2)](_0x497273(0x76e))[_0x497273(0xae8)]('click',_0x23ba0c),document[_0x497273(0x8c2)]('selection-soft-delete-btn')[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x5832f5=_0x497273;if(_0x13ef23['size']===0x0)return;const _0x57b02e=await _0x8b9cb8(_0x5832f5(0x180),_0x5832f5(0x331)+_0x13ef23[_0x5832f5(0xf72)]+_0x5832f5(0x14c),{'confirmButtonClass':_0x5832f5(0xe2a)});if(_0x57b02e){const _0x462bf7=_0x405767['chats'][_0x405767[_0x5832f5(0x248)]];let _0x1b6fda=[];for(const _0x5036ca of _0x13ef23){const _0x339e24=_0x462bf7[_0x5832f5(0xd39)][_0x5832f5(0x2ef)](_0x388438=>_0x388438[_0x5832f5(0x351)]===_0x5036ca);_0x339e24&&_0x339e24[_0x5832f5(0xde0)]===_0x5832f5(0x123d)&&_0x1b6fda[_0x5832f5(0xa49)](_0x5832f5(0x75a)+_0x339e24[_0x5832f5(0x8c4)]+_0x5832f5(0x8e3)+_0x339e24[_0x5832f5(0x351)]+')');}_0x462bf7['history']=_0x462bf7['history'][_0x5832f5(0x1d8)](_0x90a411=>!_0x13ef23[_0x5832f5(0x11ac)](_0x90a411[_0x5832f5(0x351)]));let _0x1a7066=_0x5832f5(0x954);_0x1b6fda[_0x5832f5(0x105a)]>0x0&&(_0x1a7066+=_0x5832f5(0x1267)+_0x1b6fda['join']('；')+'。');_0x1a7066+=_0x5832f5(0xf7a);const _0x3e7053={'role':'system','content':_0x5832f5(0x87a)+_0x1a7066+']','timestamp':Date[_0x5832f5(0x1ed)](),'isHidden':!![]};_0x462bf7[_0x5832f5(0xd39)][_0x5832f5(0xa49)](_0x3e7053),await _0x15043e[_0x5832f5(0x799)][_0x5832f5(0xfaa)](_0x462bf7),_0x7dbe71(_0x405767[_0x5832f5(0x248)]),_0x2b55d1();}}),document[_0x497273(0x8c2)]('selection-erase-btn')[_0x497273(0xae8)]('click',async()=>{const _0x50d975=_0x497273;if(_0x13ef23[_0x50d975(0xf72)]===0x0)return;const _0x2703d9=await _0x8b9cb8(_0x50d975(0x4c9),_0x50d975(0xc30)+_0x13ef23[_0x50d975(0xf72)]+_0x50d975(0xaf4),{'confirmButtonClass':_0x50d975(0xe2a),'confirmText':_0x50d975(0x59f)});if(_0x2703d9){const _0x3127a3=_0x405767['chats'][_0x405767[_0x50d975(0x248)]];_0x3127a3['history']=_0x3127a3['history']['filter'](_0x352d52=>!_0x13ef23['has'](_0x352d52[_0x50d975(0x351)])),await _0x15043e[_0x50d975(0x799)][_0x50d975(0xfaa)](_0x3127a3),_0x7dbe71(_0x405767['activeChatId']),_0x2b55d1();}});const _0x5f3ea7=document[_0x497273(0x8c2)]('font-url-input');_0x5f3ea7[_0x497273(0xae8)]('input',()=>_0x218332(_0x5f3ea7[_0x497273(0x518)][_0x497273(0x8c6)](),!![])),document[_0x497273(0x8c2)](_0x497273(0xbad))['addEventListener'](_0x497273(0xa17),async()=>{const _0x5c4999=_0x497273,_0x3ded8d=_0x5f3ea7[_0x5c4999(0x518)]['trim']();if(!_0x3ded8d){alert(_0x5c4999(0xf29));return;}_0x218332(_0x3ded8d,![]),_0x405767['globalSettings'][_0x5c4999(0xa3a)]=_0x3ded8d,await _0x15043e[_0x5c4999(0xb73)][_0x5c4999(0xfaa)](_0x405767[_0x5c4999(0xb73)]),alert(_0x5c4999(0xda0));}),document[_0x497273(0x8c2)]('reset-font-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x27758a),document[_0x497273(0xa2d)](_0x497273(0xdac))[_0x497273(0x7c0)](_0x4a14a1=>{const _0x3d400b=_0x497273;_0x4a14a1[_0x3d400b(0xae8)](_0x3d400b(0xa17),()=>_0x3d8143(_0x4a14a1['dataset']['view']));}),document[_0x497273(0x8c2)](_0x497273(0x5cb))['addEventListener'](_0x497273(0xa17),()=>_0x3d8143(_0x497273(0x4a1))),document['getElementById']('qzone-nickname')['addEventListener']('click',async()=>{const _0x4a19c3=_0x497273,_0x440e5d=await _0x180f74(_0x4a19c3(0x16d),'请输入新的昵称',_0x405767[_0x4a19c3(0x20a)]['nickname']);_0x440e5d&&_0x440e5d[_0x4a19c3(0x8c6)]()&&(_0x405767[_0x4a19c3(0x20a)][_0x4a19c3(0xab3)]=_0x440e5d[_0x4a19c3(0x8c6)](),await _0x5abef7(),_0x5168d7());}),document[_0x497273(0x8c2)](_0x497273(0x902))['addEventListener']('click',()=>document[_0x497273(0x8c2)]('qzone-avatar-input')[_0x497273(0xa17)]()),document[_0x497273(0x8c2)](_0x497273(0xed7))[_0x497273(0xae8)](_0x497273(0xa17),()=>document['getElementById'](_0x497273(0x1263))['click']()),document[_0x497273(0x8c2)](_0x497273(0x10ee))[_0x497273(0xae8)](_0x497273(0x7a7),async _0x1651dc=>{const _0x217bf3=_0x497273,_0x413d23=_0x1651dc[_0x217bf3(0x475)][_0x217bf3(0xde8)][0x0];if(_0x413d23){const _0x5c5d29=await new Promise(_0x226ca3=>{const _0x3f5d42=_0x217bf3,_0x263039=new FileReader();_0x263039[_0x3f5d42(0xe7a)]=()=>_0x226ca3(_0x263039[_0x3f5d42(0xa92)]),_0x263039[_0x3f5d42(0x779)](_0x413d23);});_0x405767[_0x217bf3(0x20a)]['avatar']=_0x5c5d29,await _0x5abef7(),_0x5168d7();}_0x1651dc['target'][_0x217bf3(0x518)]=null;}),document[_0x497273(0x8c2)](_0x497273(0x1263))[_0x497273(0xae8)](_0x497273(0x7a7),async _0x226330=>{const _0xc1ea68=_0x497273,_0xe70a5c=_0x226330[_0xc1ea68(0x475)][_0xc1ea68(0xde8)][0x0];if(_0xe70a5c){const _0x40ee2b=await new Promise(_0x28695c=>{const _0x2db0ea=_0xc1ea68,_0x2342bd=new FileReader();_0x2342bd['onload']=()=>_0x28695c(_0x2342bd['result']),_0x2342bd[_0x2db0ea(0x779)](_0xe70a5c);});_0x405767[_0xc1ea68(0x20a)][_0xc1ea68(0xe90)]=_0x40ee2b,await _0x5abef7(),_0x5168d7();}_0x226330[_0xc1ea68(0x475)]['value']=null;}),document[_0x497273(0x8c2)](_0x497273(0xf28))['addEventListener'](_0x497273(0xa17),async()=>{const _0x268f69=_0x497273;_0x3f56a7();const _0x5575b3=document[_0x268f69(0x8c2)](_0x268f69(0x1035));_0x5575b3[_0x268f69(0x323)][_0x268f69(0xa45)]=_0x268f69(0x11ce),_0x5575b3[_0x268f69(0x1ad)]('.post-mode-switcher')[_0x268f69(0x842)][_0x268f69(0x5e9)]=_0x268f69(0xbf8),_0x5575b3[_0x268f69(0x1ad)]('#image-mode-content')[_0x268f69(0x842)][_0x268f69(0x5e9)]=_0x268f69(0xbf8),_0x5575b3[_0x268f69(0x1ad)]('#text-image-mode-content')[_0x268f69(0x842)][_0x268f69(0x5e9)]='none',_0x5575b3[_0x268f69(0x1ad)](_0x268f69(0xd15))['placeholder']='分享新鲜事...';const _0x1810b0=document[_0x268f69(0x8c2)](_0x268f69(0x575));_0x1810b0[_0x268f69(0xca0)]='';const _0xb217a1=await _0x15043e[_0x268f69(0x232)][_0x268f69(0x6be)]();_0xb217a1[_0x268f69(0x105a)]>0x0?_0xb217a1[_0x268f69(0x7c0)](_0x422acd=>{const _0x2b7527=_0x268f69,_0x1bb2c9=document[_0x2b7527(0x8c1)](_0x2b7527(0xbea));_0x1bb2c9[_0x2b7527(0x842)][_0x2b7527(0x5e9)]='block',_0x1bb2c9['innerHTML']=_0x2b7527(0x471)+_0x422acd['id']+_0x2b7527(0xfa7)+_0x422acd['name'],_0x1810b0[_0x2b7527(0x31e)](_0x1bb2c9);}):_0x1810b0[_0x268f69(0xca0)]='<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>',_0x5575b3[_0x268f69(0xb17)][_0x268f69(0x3f4)](_0x268f69(0x2cd));}),document['getElementById'](_0x497273(0x43f))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x184436=_0x497273;_0x3f56a7();const _0x39f511=document[_0x184436(0x8c2)](_0x184436(0x1035));_0x39f511[_0x184436(0x323)][_0x184436(0xa45)]=_0x184436(0x30e),_0x39f511['querySelector'](_0x184436(0x32e))[_0x184436(0x842)][_0x184436(0x5e9)]=_0x184436(0xd52),_0x39f511[_0x184436(0x1ad)](_0x184436(0xc54))[_0x184436(0xb17)]['add']('active'),_0x39f511[_0x184436(0x1ad)](_0x184436(0x76a))[_0x184436(0xb17)][_0x184436(0xaff)](_0x184436(0x71b)),_0x39f511[_0x184436(0x1ad)](_0x184436(0xd15))[_0x184436(0x691)]='分享新鲜事...（非必填的公开文字）';const _0x34b65a=document['getElementById'](_0x184436(0x575));_0x34b65a['innerHTML']='';const _0x2f7d8b=await _0x15043e[_0x184436(0x232)][_0x184436(0x6be)]();_0x2f7d8b[_0x184436(0x105a)]>0x0?_0x2f7d8b[_0x184436(0x7c0)](_0x3324f1=>{const _0x34e04a=_0x184436,_0x575d52=document[_0x34e04a(0x8c1)](_0x34e04a(0xbea));_0x575d52[_0x34e04a(0x842)][_0x34e04a(0x5e9)]='block',_0x575d52[_0x34e04a(0xca0)]='<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22'+_0x3324f1['id']+_0x34e04a(0xfa7)+_0x3324f1[_0x34e04a(0x596)],_0x34b65a['appendChild'](_0x575d52);}):_0x34b65a[_0x184436(0xca0)]=_0x184436(0x5eb),_0x39f511[_0x184436(0xb17)][_0x184436(0x3f4)](_0x184436(0x2cd));}),document['getElementById'](_0x497273(0x938))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{await _0x31eada(),_0x3d1990('album-screen');}),document[_0x497273(0x8c2)]('album-back-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x434faf=_0x497273;_0x3d1990(_0x434faf(0x3b7)),_0x3d8143(_0x434faf(0xc35));}),document[_0x497273(0x8c2)](_0x497273(0x955))['addEventListener']('click',()=>{const _0x391121=_0x497273;_0x405767['activeAlbumId']=null,_0x3d1990(_0x391121(0x488));}),document[_0x497273(0x8c2)](_0x497273(0xde5))[_0x497273(0xae8)]('click',()=>document[_0x497273(0x8c2)](_0x497273(0x10d2))[_0x497273(0xa17)]()),document[_0x497273(0x8c2)](_0x497273(0x10d2))[_0x497273(0xae8)](_0x497273(0x7a7),async _0x51a471=>{const _0x52f080=_0x497273;if(!_0x405767[_0x52f080(0x6bc)])return;const _0x31c051=_0x51a471[_0x52f080(0x475)][_0x52f080(0xde8)];if(!_0x31c051['length'])return;const _0x448c72=await _0x15043e['qzoneAlbums']['get'](_0x405767[_0x52f080(0x6bc)]);for(const _0x5086ea of _0x31c051){const _0x3be4ca=await new Promise(_0x1d50e2=>{const _0x17e27a=_0x52f080,_0x3fb3b5=new FileReader();_0x3fb3b5[_0x17e27a(0xe7a)]=()=>_0x1d50e2(_0x3fb3b5[_0x17e27a(0xa92)]),_0x3fb3b5['readAsDataURL'](_0x5086ea);});await _0x15043e[_0x52f080(0xbed)][_0x52f080(0x3f4)]({'albumId':_0x405767[_0x52f080(0x6bc)],'url':_0x3be4ca,'createdAt':Date['now']()});}const _0x336e21=await _0x15043e[_0x52f080(0xbed)][_0x52f080(0xdb8)]('albumId')[_0x52f080(0xc9a)](_0x405767[_0x52f080(0x6bc)])['count'](),_0x53d8ef={'photoCount':_0x336e21};if(!_0x448c72[_0x52f080(0x695)]||_0x448c72[_0x52f080(0xb98)][_0x52f080(0x773)](_0x52f080(0x691))){const _0x4a2d32=await _0x15043e[_0x52f080(0xbed)][_0x52f080(0xdb8)](_0x52f080(0x10d5))[_0x52f080(0xc9a)](_0x405767['activeAlbumId'])['first']();if(_0x4a2d32)_0x53d8ef[_0x52f080(0xb98)]=_0x4a2d32[_0x52f080(0x9d6)];}await _0x15043e[_0x52f080(0x10d1)]['update'](_0x405767[_0x52f080(0x6bc)],_0x53d8ef),await _0x3f7ddf(),await _0x31eada(),_0x51a471[_0x52f080(0x475)][_0x52f080(0x518)]=null,alert(_0x52f080(0xef4));}),document[_0x497273(0x8c2)](_0x497273(0x1071))['addEventListener'](_0x497273(0xa17),async _0x147299=>{const _0xa94c49=_0x497273,_0x4e6f46=_0x147299[_0xa94c49(0x475)][_0xa94c49(0xa90)](_0xa94c49(0x187)),_0x43e66c=_0x147299[_0xa94c49(0x475)][_0xa94c49(0xa90)](_0xa94c49(0xfd9));if(_0x4e6f46){_0x147299[_0xa94c49(0x601)]();const _0xf79de6=parseInt(_0x4e6f46['dataset'][_0xa94c49(0xecb)]),_0x23b910=await _0x8b9cb8(_0xa94c49(0x1109),_0xa94c49(0x981),{'confirmButtonClass':'btn-danger'});if(_0x23b910){const _0x539a81=await _0x15043e[_0xa94c49(0xbed)]['get'](_0xf79de6);if(!_0x539a81)return;await _0x15043e[_0xa94c49(0xbed)][_0xa94c49(0x89f)](_0xf79de6);const _0x135a8a=await _0x15043e['qzoneAlbums']['get'](_0x405767[_0xa94c49(0x6bc)]),_0x4d019e=(_0x135a8a[_0xa94c49(0x695)]||0x1)-0x1,_0x558e4e={'photoCount':_0x4d019e};if(_0x135a8a[_0xa94c49(0xb98)]===_0x539a81[_0xa94c49(0x9d6)]){const _0x4903dc=await _0x15043e[_0xa94c49(0xbed)][_0xa94c49(0xdb8)](_0xa94c49(0x10d5))[_0xa94c49(0xc9a)](_0x405767[_0xa94c49(0x6bc)])[_0xa94c49(0xf2e)]();_0x558e4e[_0xa94c49(0xb98)]=_0x4903dc?_0x4903dc['url']:_0xa94c49(0x292);}await _0x15043e[_0xa94c49(0x10d1)][_0xa94c49(0xb7c)](_0x405767[_0xa94c49(0x6bc)],_0x558e4e),await _0x3f7ddf(),await _0x31eada(),alert(_0xa94c49(0xb30));}}else _0x43e66c&&_0x30d881(_0x43e66c[_0xa94c49(0x939)]);}),document[_0x497273(0x8c2)](_0x497273(0xc0a))[_0x497273(0xae8)](_0x497273(0xa17),_0x275b23),document[_0x497273(0x8c2)](_0x497273(0xb47))['addEventListener']('click',_0x1a57a2),document[_0x497273(0x8c2)]('photo-viewer-prev-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x50d088),document[_0x497273(0xae8)](_0x497273(0x108d),_0x55a15c=>{const _0x2f46f1=_0x497273;if(!_0x41f39d[_0x2f46f1(0x356)])return;if(_0x55a15c['key']===_0x2f46f1(0xad3))_0x1a57a2();else{if(_0x55a15c[_0x2f46f1(0xe29)]==='ArrowLeft')_0x50d088();else _0x55a15c[_0x2f46f1(0xe29)]==='Escape'&&_0x275b23();}}),document['getElementById'](_0x497273(0x1204))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x51cccb=_0x497273,_0x3d3417=await _0x180f74(_0x51cccb(0x8de),_0x51cccb(0x9bb));if(_0x3d3417&&_0x3d3417[_0x51cccb(0x8c6)]()){const _0x4d865c={'name':_0x3d3417[_0x51cccb(0x8c6)](),'coverUrl':_0x51cccb(0x292),'photoCount':0x0,'createdAt':Date[_0x51cccb(0x1ed)]()};await _0x15043e['qzoneAlbums'][_0x51cccb(0x3f4)](_0x4d865c),await _0x31eada(),alert(_0x51cccb(0x614)+_0x3d3417+_0x51cccb(0x1091));}else _0x3d3417!==null&&alert(_0x51cccb(0xd72));}),document['getElementById'](_0x497273(0xbfc))['addEventListener'](_0x497273(0xa17),()=>document[_0x497273(0x8c2)](_0x497273(0x1035))['classList'][_0x497273(0xaff)]('visible')),document[_0x497273(0x8c2)](_0x497273(0xe71))[_0x497273(0xae8)](_0x497273(0xa17),()=>document[_0x497273(0x8c2)](_0x497273(0xe15))['click']()),document[_0x497273(0x8c2)]('post-local-image-input')[_0x497273(0xae8)](_0x497273(0x7a7),_0x250a5d=>{const _0x454642=_0x497273,_0x33383=_0x250a5d[_0x454642(0x475)][_0x454642(0xde8)][0x0];if(_0x33383){const _0x53af11=new FileReader();_0x53af11[_0x454642(0xe7a)]=_0x1638da=>{const _0x431b72=_0x454642;document[_0x431b72(0x8c2)](_0x431b72(0xc2a))[_0x431b72(0x939)]=_0x1638da[_0x431b72(0x475)][_0x431b72(0xa92)],document[_0x431b72(0x8c2)]('post-image-preview-container')[_0x431b72(0xb17)][_0x431b72(0x3f4)](_0x431b72(0x2cd)),document[_0x431b72(0x8c2)](_0x431b72(0x5dc))[_0x431b72(0x842)][_0x431b72(0x5e9)]=_0x431b72(0xea7);},_0x53af11[_0x454642(0x779)](_0x33383);}}),document[_0x497273(0x8c2)](_0x497273(0xef7))[_0x497273(0xae8)]('click',async()=>{const _0x19106e=_0x497273,_0x299d79=await _0x180f74(_0x19106e(0xc24),_0x19106e(0x664),'',_0x19106e(0x9d6));_0x299d79&&(document[_0x19106e(0x8c2)](_0x19106e(0xc2a))[_0x19106e(0x939)]=_0x299d79,document[_0x19106e(0x8c2)]('post-image-preview-container')[_0x19106e(0xb17)][_0x19106e(0x3f4)]('visible'),document['getElementById']('post-image-desc-group')[_0x19106e(0x842)]['display']=_0x19106e(0xea7));}),document[_0x497273(0x8c2)](_0x497273(0x618))[_0x497273(0xae8)]('click',()=>_0x3f56a7());const _0xcfdb77=document['getElementById']('switch-to-image-mode'),_0x1285a2=document[_0x497273(0x8c2)]('switch-to-text-image-mode'),_0x3f971d=document['getElementById'](_0x497273(0x1b9)),_0x4a1ab4=document['getElementById']('text-image-mode-content');_0xcfdb77[_0x497273(0xae8)]('click',()=>{const _0xa0d0b6=_0x497273;_0xcfdb77[_0xa0d0b6(0xb17)][_0xa0d0b6(0x3f4)]('active'),_0x1285a2[_0xa0d0b6(0xb17)][_0xa0d0b6(0xaff)]('active'),_0x3f971d[_0xa0d0b6(0xb17)][_0xa0d0b6(0x3f4)](_0xa0d0b6(0x71b)),_0x4a1ab4['classList']['remove'](_0xa0d0b6(0x71b));}),_0x1285a2[_0x497273(0xae8)]('click',()=>{const _0x108766=_0x497273;_0x1285a2[_0x108766(0xb17)][_0x108766(0x3f4)]('active'),_0xcfdb77[_0x108766(0xb17)][_0x108766(0xaff)]('active'),_0x4a1ab4['classList'][_0x108766(0x3f4)](_0x108766(0x71b)),_0x3f971d[_0x108766(0xb17)][_0x108766(0xaff)](_0x108766(0x71b));}),document[_0x497273(0x8c2)](_0x497273(0x7d5))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x525d47=_0x497273,_0x3c4a01=document[_0x525d47(0x8c2)](_0x525d47(0x1035)),_0x459f1d=_0x3c4a01['dataset'][_0x525d47(0xa45)],_0x2dc635=document[_0x525d47(0x1ad)](_0x525d47(0x282))['value'];let _0x4dc527=null;_0x2dc635===_0x525d47(0x876)&&(_0x4dc527=Array['from'](document['querySelectorAll'](_0x525d47(0xefb)))[_0x525d47(0x6b9)](_0x56e2bc=>parseInt(_0x56e2bc[_0x525d47(0x518)])));let _0x58d92b={};const _0x34414a={'timestamp':Date[_0x525d47(0x1ed)](),'authorId':_0x525d47(0x74b),'visibleGroupIds':_0x4dc527};if(_0x459f1d==='shuoshuo'){const _0x547f8e=document[_0x525d47(0x8c2)](_0x525d47(0x4b4))[_0x525d47(0x518)]['trim']();if(!_0x547f8e){alert(_0x525d47(0x586));return;}_0x58d92b={..._0x34414a,'type':'shuoshuo','content':_0x547f8e};}else{const _0x56cdef=document['getElementById'](_0x525d47(0x4b4))[_0x525d47(0x518)][_0x525d47(0x8c6)](),_0x2eb5e2=document[_0x525d47(0x8c2)](_0x525d47(0x1b9))[_0x525d47(0xb17)][_0x525d47(0x795)](_0x525d47(0x71b));if(_0x2eb5e2){const _0x72d33d=document['getElementById']('post-image-preview')['src'],_0x43bfeb=document[_0x525d47(0x8c2)](_0x525d47(0xe46))['value'][_0x525d47(0x8c6)]();if(!_0x72d33d||!(_0x72d33d[_0x525d47(0xc7c)](_0x525d47(0xcce))||_0x72d33d['startsWith'](_0x525d47(0x3a5)))){alert(_0x525d47(0x11e4));return;}if(!_0x43bfeb){alert(_0x525d47(0xedd));return;}_0x58d92b={..._0x34414a,'type':_0x525d47(0x7b5),'publicText':_0x56cdef,'imageUrl':_0x72d33d,'imageDescription':_0x43bfeb};}else{const _0x5ed5c1=document['getElementById'](_0x525d47(0x10a1))[_0x525d47(0x518)]['trim']();if(!_0x5ed5c1){alert(_0x525d47(0xa11));return;}_0x58d92b={..._0x34414a,'type':_0x525d47(0xe36),'publicText':_0x56cdef,'hiddenContent':_0x5ed5c1};}}const _0x3efb6e=await _0x15043e['qzonePosts'][_0x525d47(0x3f4)](_0x58d92b);let _0x4ab303=_0x58d92b['content']||_0x58d92b[_0x525d47(0x55d)]||_0x58d92b[_0x525d47(0x845)]||_0x58d92b[_0x525d47(0x9eb)]||_0x525d47(0xdb2);_0x4ab303=_0x4ab303['substring'](0x0,0x32)+(_0x4ab303[_0x525d47(0x105a)]>0x32?_0x525d47(0x388):'');for(const _0x229968 in _0x405767[_0x525d47(0x799)]){const _0x2fc5d1=_0x405767[_0x525d47(0x799)][_0x229968];if(_0x2fc5d1['isGroup'])continue;let _0x5818bb=![];const _0x5d2429=_0x58d92b[_0x525d47(0x1105)];if(!_0x5d2429||_0x5d2429['length']===0x0)_0x5818bb=!![];else _0x2fc5d1[_0x525d47(0x40f)]&&_0x5d2429[_0x525d47(0x773)](_0x2fc5d1[_0x525d47(0x40f)])&&(_0x5818bb=!![]);if(_0x5818bb){const _0x3b9d50={'role':_0x525d47(0x46c),'content':_0x525d47(0x8f4)+_0x3efb6e+_0x525d47(0x1c5)+_0x4ab303+_0x525d47(0x9fa),'timestamp':Date[_0x525d47(0x1ed)](),'isHidden':!![]};_0x2fc5d1['history']['push'](_0x3b9d50),await _0x15043e[_0x525d47(0x799)][_0x525d47(0xfaa)](_0x2fc5d1);}}await _0xa34c48(),_0x3c4a01[_0x525d47(0xb17)][_0x525d47(0xaff)]('visible'),alert(_0x525d47(0x5a5));});const _0x468336=document[_0x497273(0x8c2)]('qzone-posts-list');let _0x59f210={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0x44e262(_0x2d34c4=null){const _0x95fd4a=_0x497273;document['querySelectorAll'](_0x95fd4a(0xbd2))[_0x95fd4a(0x7c0)](_0x3da594=>{const _0x5df215=_0x95fd4a;_0x3da594!==_0x2d34c4&&_0x3da594[_0x5df215(0x1ad)]('.qzone-post-item')[_0x5df215(0xb17)][_0x5df215(0xaff)](_0x5df215(0xc0b));});}async function _0x42bc06(_0x410a30){const _0x281b42=_0x497273;_0x410a30[_0x281b42(0x601)]();const _0x4e4976=_0x410a30['target'],_0x4ba1bd=_0x4e4976[_0x281b42(0xa90)]('.comment-delete-btn');if(_0x4ba1bd){const _0x49f8df=_0x4ba1bd['closest'](_0x281b42(0xbd2)),_0x4ba22a=parseInt(_0x49f8df[_0x281b42(0x323)][_0x281b42(0x5f9)]),_0x10ad1e=parseInt(_0x4ba1bd['dataset'][_0x281b42(0x63e)]);if(isNaN(_0x4ba22a)||isNaN(_0x10ad1e))return;const _0x42624a=_0x3c4d9a[_0x281b42(0x2ef)](_0x4a25c2=>_0x4a25c2['id']===_0x4ba22a);if(!_0x42624a||!_0x42624a[_0x281b42(0x93c)]||!_0x42624a[_0x281b42(0x93c)][_0x10ad1e])return;const _0x398330=_0x42624a[_0x281b42(0x93c)][_0x10ad1e],_0x5293a7=await _0x8b9cb8('删除评论',_0x281b42(0x7ff),{'confirmButtonClass':'btn-danger'});if(_0x5293a7){_0x42624a[_0x281b42(0x93c)][_0x281b42(0x3e6)](_0x10ad1e,0x1),await _0x15043e[_0x281b42(0xcc0)][_0x281b42(0xb7c)](_0x4ba22a,{'comments':_0x42624a[_0x281b42(0x93c)]});if(_0x398330&&_0x398330['commenterName']===_0x405767[_0x281b42(0x20a)][_0x281b42(0xab3)]){console['log'](_0x281b42(0x1f1));const _0x4fcbd7=new Set();_0x42624a[_0x281b42(0x802)]!=='user'&&_0x4fcbd7[_0x281b42(0x3f4)](_0x42624a[_0x281b42(0x802)]);if(_0x398330['replyTo']){const _0x48ba1d=Object[_0x281b42(0x22f)](_0x405767[_0x281b42(0x799)])[_0x281b42(0x2ef)](_0x4d5c0b=>_0x4d5c0b[_0x281b42(0x4e7)]===_0x398330[_0x281b42(0x176)]);_0x48ba1d&&_0x4fcbd7[_0x281b42(0x3f4)](_0x48ba1d['id']);}const _0x7464e3=(_0x42624a[_0x281b42(0x55d)]||_0x42624a[_0x281b42(0x168)]||'')[_0x281b42(0x599)](0x0,0x1e),_0x221467=_0x405767[_0x281b42(0x20a)][_0x281b42(0xab3)];let _0x31d6b5;const _0x50496f=_0x405767['userStickers'][_0x281b42(0x2ef)](_0x20e7ef=>_0x20e7ef[_0x281b42(0x9d6)]===_0x398330[_0x281b42(0xbc6)]);if(_0x50496f)_0x31d6b5=_0x281b42(0x374)+_0x221467+'\x27刚刚在你的动态“'+_0x7464e3+_0x281b42(0x8a1)+_0x50496f[_0x281b42(0x596)]+'”。';else{if(_0x398330[_0x281b42(0x176)]){const _0x447c32=_0x4846a6(_0x398330[_0x281b42(0x176)]);_0x31d6b5=_0x281b42(0x374)+_0x221467+_0x281b42(0xf5d)+_0x7464e3+_0x281b42(0x28d)+_0x447c32+_0x281b42(0x985)+_0x398330['text']+'”。';}else _0x31d6b5=_0x281b42(0x374)+_0x221467+_0x281b42(0xa79)+_0x7464e3+_0x281b42(0x8b6)+_0x398330['text']+'”。';}const _0x11e33c=_0x281b42(0x87a)+_0x31d6b5+_0x281b42(0x3b5);for(const _0x5e6f31 of _0x4fcbd7){const _0x164651=_0x405767['chats'][_0x5e6f31];if(_0x164651){const _0x1191e9=_0x164651[_0x281b42(0xd39)][_0x281b42(0x105a)];_0x164651['history']=_0x164651[_0x281b42(0xd39)]['filter'](_0x29c524=>!(_0x29c524['isHidden']&&_0x29c524['role']===_0x281b42(0x46c)&&_0x29c524[_0x281b42(0x168)]===_0x11e33c)),_0x164651['history']['length']<_0x1191e9&&(console[_0x281b42(0x32b)](_0x281b42(0x49c)+_0x164651[_0x281b42(0x596)]+_0x281b42(0x163)),await _0x15043e[_0x281b42(0x799)][_0x281b42(0xfaa)](_0x164651));}}}await _0x4762ca(_0x4ba22a);}return;}const _0xc9dd35=_0x4e4976[_0x281b42(0xa90)]('.comment-sticker-btn');if(_0xc9dd35){const _0x5e8f8a=_0xc9dd35['closest'](_0x281b42(0xbd2));if(!_0x5e8f8a)return;const _0xfb2a0b=parseInt(_0x5e8f8a[_0x281b42(0x323)]['postId']);_0x1b5b07[_0x281b42(0x356)]&&_0x1b5b07[_0x281b42(0x370)]===_0xfb2a0b?_0xef4146():_0x37b873(_0xfb2a0b,_0xc9dd35);return;}const _0x5d8771=_0x4e4976[_0x281b42(0xa90)](_0x281b42(0x1121));if(_0x5d8771){const _0x5193ac=parseInt(_0x5d8771['dataset'][_0x281b42(0x5f9)]),_0x38dba7=_0x5d8771[_0x281b42(0x323)][_0x281b42(0x553)],_0x5d0871=_0x5d8771[_0x281b42(0x323)][_0x281b42(0x95c)];if(!_0x38dba7||!_0x5d0871||_0x38dba7===_0x405767[_0x281b42(0x20a)][_0x281b42(0xab3)]){_0x56d432(_0x5d8771[_0x281b42(0xa90)](_0x281b42(0xbd2)));return;}_0x31af8a={'postId':_0x5193ac,'replyToName':_0x38dba7,'replyToDisplayName':_0x5d0871};const _0x20e8d9=_0x5d8771[_0x281b42(0xa90)](_0x281b42(0xbd2)),_0x273270=_0x20e8d9['querySelector'](_0x281b42(0xdaf));_0x273270[_0x281b42(0x691)]=_0x281b42(0xb86)+_0x5d0871+':',_0x273270['focus']();return;}if(_0x4e4976[_0x281b42(0xb17)][_0x281b42(0x795)](_0x281b42(0x774))){const _0x3f6885=_0x4e4976['closest'](_0x281b42(0xbd2));if(_0x3f6885&&_0x3f6885[_0x281b42(0x323)][_0x281b42(0x5f9)])_0x34a1b0(parseInt(_0x3f6885[_0x281b42(0x323)][_0x281b42(0x5f9)]));return;}if(_0x4e4976['tagName']==='IMG'&&_0x4e4976['dataset'][_0x281b42(0xbff)]){_0x501c7b(_0x281b42(0xa4b),_0x4e4976[_0x281b42(0x323)]['hiddenText'][_0x281b42(0x1b7)](/<br>/g,'\x0a'));return;}const _0x3eb650=_0x4e4976[_0x281b42(0xa90)](_0x281b42(0xbd2));if(!_0x3eb650)return;const _0x374c66=parseInt(_0x3eb650[_0x281b42(0x323)][_0x281b42(0x5f9)]);if(isNaN(_0x374c66))return;if(_0x4e4976[_0x281b42(0xa90)](_0x281b42(0x486))){const _0x53b2dc=await _0x8b9cb8(_0x281b42(0xb83),_0x281b42(0x30f),{'confirmButtonClass':'btn-danger'});_0x53b2dc&&(_0x3eb650[_0x281b42(0x842)][_0x281b42(0x1f8)]=_0x281b42(0x1f7),_0x3eb650[_0x281b42(0x842)]['transform']=_0x281b42(0x32a),_0x3eb650[_0x281b42(0x842)]['opacity']='0',setTimeout(async()=>{const _0x4ab200=_0x281b42;await _0x15043e[_0x4ab200(0xcc0)][_0x4ab200(0x89f)](_0x374c66);const _0x4c59e7=_0x4ab200(0x1126)+_0x374c66+')';for(const _0x221999 in _0x405767[_0x4ab200(0x799)]){const _0x3fcf94=_0x405767[_0x4ab200(0x799)][_0x221999],_0x5e3070=_0x3fcf94['history'][_0x4ab200(0x105a)];_0x3fcf94['history']=_0x3fcf94[_0x4ab200(0xd39)][_0x4ab200(0x1d8)](_0x2d6f7f=>!(_0x2d6f7f[_0x4ab200(0x14a)]===_0x4ab200(0x46c)&&_0x2d6f7f['content'][_0x4ab200(0x773)](_0x4c59e7)));if(_0x3fcf94[_0x4ab200(0xd39)][_0x4ab200(0x105a)]<_0x5e3070)await _0x15043e[_0x4ab200(0x799)]['put'](_0x3fcf94);}await _0xa34c48(),alert(_0x4ab200(0xfab));},0x12c));return;}const _0x2ec9b4=_0x4e4976[_0x281b42(0xa90)]('.action-icon');if(_0x2ec9b4){if(_0x2ec9b4['classList'][_0x281b42(0x795)](_0x281b42(0xa8b))){_0x17b877(_0x374c66);return;}if(_0x2ec9b4[_0x281b42(0xb17)][_0x281b42(0x795)]('like')){const _0x10bf4b=_0x3c4d9a['find'](_0x57fbe5=>_0x57fbe5['id']===_0x374c66);if(!_0x10bf4b)return;if(!_0x10bf4b[_0x281b42(0xe2e)])_0x10bf4b['likes']=[];const _0x182372=_0x405767[_0x281b42(0x20a)]['nickname'],_0x20e5ac=_0x10bf4b['likes'][_0x281b42(0xbf2)](_0x182372);_0x20e5ac>-0x1?_0x10bf4b[_0x281b42(0xe2e)][_0x281b42(0x3e6)](_0x20e5ac,0x1):(_0x10bf4b[_0x281b42(0xe2e)][_0x281b42(0xa49)](_0x182372),_0x2ec9b4[_0x281b42(0xb17)][_0x281b42(0x3f4)](_0x281b42(0x6a3)),_0x2ec9b4[_0x281b42(0xae8)](_0x281b42(0xc4e),()=>_0x2ec9b4[_0x281b42(0xb17)]['remove'](_0x281b42(0x6a3)),{'once':!![]})),await _0x15043e['qzonePosts'][_0x281b42(0xb7c)](_0x374c66,{'likes':_0x10bf4b[_0x281b42(0xe2e)]}),await _0x4762ca(_0x374c66);}if(_0x2ec9b4[_0x281b42(0xb17)][_0x281b42(0x795)](_0x281b42(0x447))){const _0x12fd4b=await _0x15043e['favorites']['where']({'type':_0x281b42(0x80e),'content.id':_0x374c66})[_0x281b42(0xf2e)]();if(_0x12fd4b)await _0x15043e[_0x281b42(0xe93)][_0x281b42(0x89f)](_0x12fd4b['id']),await _0x501c7b('提示',_0x281b42(0x7e2));else{const _0x290ef2=await _0x15043e[_0x281b42(0xcc0)][_0x281b42(0x3e9)](_0x374c66);_0x290ef2&&(await _0x15043e[_0x281b42(0xe93)][_0x281b42(0x3f4)]({'type':_0x281b42(0x80e),'content':_0x290ef2,'timestamp':Date[_0x281b42(0x1ed)]()}),await _0x501c7b('提示','收藏成功！'));}await _0x4762ca(_0x374c66);}return;}const _0x355e13=_0x4e4976[_0x281b42(0xa90)]('.comment-send-btn');if(_0x355e13){const _0x3c8505=_0x3eb650[_0x281b42(0x1ad)](_0x281b42(0xdaf)),_0xa7eb7e=_0x3c8505[_0x281b42(0x518)][_0x281b42(0x8c6)]();if(!_0xa7eb7e)return alert('评论内容不能为空哦！');const _0x2f161a=_0x3c4d9a[_0x281b42(0x2ef)](_0x2947df=>_0x2947df['id']===_0x374c66);if(!_0x2f161a)return;if(!_0x2f161a[_0x281b42(0x93c)])_0x2f161a[_0x281b42(0x93c)]=[];const _0x108b0f={'commenterName':_0x405767[_0x281b42(0x20a)][_0x281b42(0xab3)],'text':_0xa7eb7e,'timestamp':Date[_0x281b42(0x1ed)](),'replyTo':_0x31af8a&&_0x31af8a['postId']===_0x374c66?_0x31af8a[_0x281b42(0x3cb)]:null};_0x2f161a['comments'][_0x281b42(0xa49)](_0x108b0f),await _0x15043e[_0x281b42(0xcc0)][_0x281b42(0xb7c)](_0x374c66,{'comments':_0x2f161a[_0x281b42(0x93c)]});let _0x52a2fd=(_0x2f161a[_0x281b42(0x55d)]||_0x2f161a['content']||'')[_0x281b42(0x599)](0x0,0x1e);const _0xa2850d=_0x405767[_0x281b42(0x20a)]['nickname'],_0x4f7a8a=new Set();if(_0x2f161a[_0x281b42(0x802)]!==_0x281b42(0x74b))_0x4f7a8a[_0x281b42(0x3f4)](_0x2f161a[_0x281b42(0x802)]);if(_0x108b0f[_0x281b42(0x176)]&&_0x108b0f[_0x281b42(0x176)]!==_0xa2850d){const _0x3f499d=Object[_0x281b42(0x22f)](_0x405767[_0x281b42(0x799)])['find'](_0x3de2e5=>_0x3de2e5[_0x281b42(0x4e7)]===_0x108b0f[_0x281b42(0x176)]);if(_0x3f499d)_0x4f7a8a['add'](_0x3f499d['id']);}for(const _0x4ddff0 of _0x4f7a8a){const _0x31c796=_0x405767[_0x281b42(0x799)][_0x4ddff0];if(_0x31c796&&!_0x31c796[_0x281b42(0x1000)]){const _0x51dfb8=_0x405767[_0x281b42(0xc36)][_0x281b42(0x2ef)](_0x2e1d78=>_0x2e1d78[_0x281b42(0x9d6)]===_0xa7eb7e);let _0x280000=_0x51dfb8?_0x281b42(0x374)+_0xa2850d+_0x281b42(0xf5d)+_0x52a2fd+'”下，发送了一个表情评论，意思是：“'+_0x51dfb8['name']+'”。':_0x108b0f[_0x281b42(0x176)]?_0x281b42(0x374)+_0xa2850d+'\x27刚刚在你的动态“'+_0x52a2fd+_0x281b42(0x28d)+_0x31af8a['replyToDisplayName']+_0x281b42(0x985)+_0xa7eb7e+'”。':'用户\x27'+_0xa2850d+'\x27刚刚评论了你的动态“'+_0x52a2fd+_0x281b42(0x8b6)+_0xa7eb7e+'”。';const _0x227872={'role':_0x281b42(0x46c),'content':_0x281b42(0x87a)+_0x280000+_0x281b42(0x3b5),'timestamp':Date['now'](),'isHidden':!![]};_0x31c796[_0x281b42(0xd39)]['push'](_0x227872),await _0x15043e[_0x281b42(0x799)][_0x281b42(0xfaa)](_0x31c796);}}_0x3c8505['value']='',_0x56d432(_0x3eb650),await _0x4762ca(_0x374c66);return;}}const _0x4acde4=_0x3dd63e=>{const _0x1cdff1=_0x497273,_0x3f4b8d=_0x3dd63e[_0x1cdff1(0x475)];if(_0x3f4b8d[_0x1cdff1(0xa90)](_0x1cdff1(0xf3d)))return;const _0xd880d3=_0x3dd63e['target'][_0x1cdff1(0xa90)](_0x1cdff1(0xbd2));if(!_0xd880d3)return;_0x44e262(_0xd880d3),_0x59f210[_0x1cdff1(0x11ab)]=_0xd880d3,_0x59f210[_0x1cdff1(0x6da)]=!![],_0x59f210['isClick']=!![],_0x59f210[_0x1cdff1(0x111b)]=null,_0x59f210[_0x1cdff1(0x640)]=_0x3dd63e['type']['includes'](_0x1cdff1(0xfa2))?_0x3dd63e[_0x1cdff1(0xb2f)]:_0x3dd63e['touches'][0x0]['pageX'],_0x59f210[_0x1cdff1(0x455)]=_0x3dd63e[_0x1cdff1(0xde0)][_0x1cdff1(0x773)](_0x1cdff1(0xfa2))?_0x3dd63e[_0x1cdff1(0x5bb)]:_0x3dd63e['touches'][0x0][_0x1cdff1(0x5bb)],_0x59f210['activeContainer'][_0x1cdff1(0x1ad)](_0x1cdff1(0x69c))[_0x1cdff1(0x842)][_0x1cdff1(0x1f8)]='none',document[_0x1cdff1(0xae8)](_0x1cdff1(0x6c1),_0x8ae86e),document[_0x1cdff1(0xae8)]('mouseup',_0x26280e),document['addEventListener'](_0x1cdff1(0x4c1),_0x8ae86e,{'passive':![]}),document[_0x1cdff1(0xae8)](_0x1cdff1(0x519),_0x26280e);},_0x8ae86e=_0xad295=>{const _0x4debd8=_0x497273;if(!_0x59f210[_0x4debd8(0x6da)]||!_0x59f210[_0x4debd8(0x11ab)])return;const _0x1f9828=_0xad295[_0x4debd8(0xde0)][_0x4debd8(0x773)](_0x4debd8(0xfa2))?_0xad295['pageX']:_0xad295[_0x4debd8(0x474)][0x0][_0x4debd8(0xb2f)],_0x40d578=_0xad295[_0x4debd8(0xde0)]['includes'](_0x4debd8(0xfa2))?_0xad295[_0x4debd8(0x5bb)]:_0xad295[_0x4debd8(0x474)][0x0][_0x4debd8(0x5bb)],_0x6cd771=_0x1f9828-_0x59f210[_0x4debd8(0x640)],_0x3840d6=_0x40d578-_0x59f210[_0x4debd8(0x455)];_0x59f210[_0x4debd8(0xd54)]&&(Math[_0x4debd8(0x10a3)](_0x6cd771)>0x5||Math[_0x4debd8(0x10a3)](_0x3840d6)>0x5)&&(_0x59f210[_0x4debd8(0xd54)]=![]);!_0x59f210[_0x4debd8(0x111b)]&&(Math['abs'](_0x6cd771)>Math[_0x4debd8(0x10a3)](_0x3840d6)?_0x59f210[_0x4debd8(0x111b)]='horizontal':_0x59f210[_0x4debd8(0x111b)]=_0x4debd8(0xe8f));if(_0x59f210[_0x4debd8(0x111b)]===_0x4debd8(0x157)){_0xad295['preventDefault'](),_0x59f210[_0x4debd8(0x4a9)]=_0x1f9828;let _0x24f106=Math[_0x4debd8(0x10ff)](0x0,Math[_0x4debd8(0x171)](-0x5a,_0x6cd771));_0x59f210['activeContainer'][_0x4debd8(0x1ad)](_0x4debd8(0x69c))['style']['transform']='translateX('+_0x24f106+_0x4debd8(0x4e8);}},_0x26280e=_0x27e110=>{const _0x4d4dc7=_0x497273;document['removeEventListener'](_0x4d4dc7(0x6c1),_0x8ae86e),document[_0x4d4dc7(0x2b2)]('mouseup',_0x26280e),document[_0x4d4dc7(0x2b2)](_0x4d4dc7(0x4c1),_0x8ae86e),document[_0x4d4dc7(0x2b2)](_0x4d4dc7(0x519),_0x26280e);if(!_0x59f210['isDragging']||!_0x59f210[_0x4d4dc7(0x11ab)])return;const _0x3c0420=_0x59f210[_0x4d4dc7(0x11ab)][_0x4d4dc7(0x1ad)](_0x4d4dc7(0x69c));_0x3c0420[_0x4d4dc7(0x842)][_0x4d4dc7(0x1f8)]=_0x4d4dc7(0x1053);if(_0x59f210[_0x4d4dc7(0x111b)]===_0x4d4dc7(0x157)&&!_0x59f210[_0x4d4dc7(0xd54)]){const _0x414b77=_0x27e110[_0x4d4dc7(0xde0)][_0x4d4dc7(0x773)]('touchend')?_0x27e110['changedTouches'][0x0][_0x4d4dc7(0xb2f)]:_0x27e110[_0x4d4dc7(0xb2f)],_0x1b90de=_0x414b77-_0x59f210[_0x4d4dc7(0x640)];_0x1b90de<-0x28?_0x3c0420[_0x4d4dc7(0xb17)][_0x4d4dc7(0x3f4)]('swiped'):_0x3c0420[_0x4d4dc7(0xb17)][_0x4d4dc7(0xaff)](_0x4d4dc7(0xc0b));}_0x3c0420['style']['transform']='',_0x59f210['isDragging']=![],_0x59f210[_0x4d4dc7(0x11ab)]=null,_0x59f210['swipeDirection']=null,_0x59f210[_0x4d4dc7(0xd54)]=!![];};_0x468336[_0x497273(0xae8)](_0x497273(0xa17),_0x42bc06),_0x468336[_0x497273(0xae8)](_0x497273(0x5d5),_0x4acde4),_0x468336[_0x497273(0xae8)](_0x497273(0x3e0),_0x4acde4,{'passive':!![]}),_0x468336[_0x497273(0xae8)](_0x497273(0xa17),_0x2ba0aa=>{const _0x18754d=_0x497273;_0x2ba0aa[_0x18754d(0x475)]&&_0x2ba0aa[_0x18754d(0x475)]['id']==='load-more-qzone-btn'&&_0x411133();}),document['getElementById'](_0x497273(0x3c4))['addEventListener']('click',()=>{const _0x5402bf=_0x497273;_0x405767[_0x5402bf(0x248)]&&_0x5cf6ce(_0x405767[_0x5402bf(0x248)]);}),document[_0x497273(0x8c2)](_0x497273(0x826))[_0x497273(0xae8)]('change',_0x2b4a0b),document[_0x497273(0x8c2)](_0x497273(0x529))['addEventListener'](_0x497273(0xa17),_0x21bb4e),document[_0x497273(0x8c2)]('delete-api-preset-btn')['addEventListener'](_0x497273(0xa17),_0x2d4563),document[_0x497273(0x8c2)]('add-world-book-entry-btn')['addEventListener']('click',()=>{const _0x15a69b=_0x497273,_0x2ff892=document[_0x15a69b(0x8c2)]('world-book-entries-container');_0x2ff892[_0x15a69b(0x1ad)]('p')&&(_0x2ff892[_0x15a69b(0xca0)]='');const _0x1cd7b2=_0x18faa4();_0x2ff892[_0x15a69b(0x31e)](_0x1cd7b2),_0x1cd7b2[_0x15a69b(0x1ad)](_0x15a69b(0xbe5))[_0x15a69b(0x10f7)]();}),document['getElementById'](_0x497273(0x127c))['addEventListener'](_0x497273(0xa17),_0x912db8),document['getElementById'](_0x497273(0x125d))[_0x497273(0xae8)](_0x497273(0xa17),_0x3180c7=>{const _0x44d21e=_0x497273;_0x3180c7[_0x44d21e(0x475)]&&_0x3180c7['target']['id']===_0x44d21e(0x3e3)&&_0x1dd5af();}),document[_0x497273(0x8c2)](_0x497273(0x982))[_0x497273(0xae8)](_0x497273(0xa17),_0x34b0ba),document[_0x497273(0x8c2)](_0x497273(0xb3e))[_0x497273(0xae8)](_0x497273(0xa17),_0x689d3),document[_0x497273(0x8c2)](_0x497273(0x59e))[_0x497273(0xae8)](_0x497273(0xa17),_0x4affbd=>{const _0x2de7fd=_0x497273;_0x4affbd[_0x2de7fd(0x475)]['id']===_0x2de7fd(0x59e)&&_0x4affbd[_0x2de7fd(0x475)][_0x2de7fd(0xb17)][_0x2de7fd(0xaff)](_0x2de7fd(0x2cd));}),document['getElementById']('manage-stickers-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x57a4b6),document[_0x497273(0x8c2)](_0x497273(0x598))[_0x497273(0xae8)](_0x497273(0xa17),_0x1c0b58),document[_0x497273(0x8c2)](_0x497273(0x5cb))['addEventListener'](_0x497273(0xa17),()=>_0x3d8143('messages-view')),document[_0x497273(0x8c2)](_0x497273(0x1a8))[_0x497273(0xae8)](_0x497273(0xa17),()=>_0x3d8143(_0x497273(0x4a1)));const _0x13fdb7=document[_0x497273(0x8c2)](_0x497273(0xf57)),_0x198a16=document['getElementById'](_0x497273(0x72d));_0x13fdb7[_0x497273(0xae8)](_0x497273(0x58f),()=>{const _0x3adbfb=_0x497273,_0x52d970=_0x13fdb7[_0x3adbfb(0x518)]['trim']()['toLowerCase']();_0x198a16[_0x3adbfb(0x842)]['display']=_0x52d970?_0x3adbfb(0xea7):_0x3adbfb(0xbf8);if(!_0x52d970){_0x4141a3(allFavoriteItems);return;}const _0x5c6a38=allFavoriteItems['filter'](_0x37a6b5=>{const _0x459183=_0x3adbfb;let _0x18c835='',_0x4fe56e='';if(_0x37a6b5[_0x459183(0xde0)]===_0x459183(0x80e)){const _0x14a4bd=_0x37a6b5['content'];_0x18c835+=(_0x14a4bd[_0x459183(0x55d)]||'')+'\x20'+(_0x14a4bd[_0x459183(0x168)]||'');if(_0x14a4bd[_0x459183(0x802)]==='user')_0x4fe56e=_0x405767[_0x459183(0x20a)][_0x459183(0xab3)];else _0x405767[_0x459183(0x799)][_0x14a4bd[_0x459183(0x802)]]&&(_0x4fe56e=_0x405767[_0x459183(0x799)][_0x14a4bd[_0x459183(0x802)]][_0x459183(0x596)]);}else{if(_0x37a6b5[_0x459183(0xde0)]==='chat_message'){const _0x240ec0=_0x37a6b5[_0x459183(0x168)];typeof _0x240ec0[_0x459183(0x168)]===_0x459183(0xf1b)&&(_0x18c835=_0x240ec0[_0x459183(0x168)]);const _0x1464d9=_0x405767[_0x459183(0x799)][_0x37a6b5[_0x459183(0xb3d)]];_0x1464d9&&(_0x240ec0[_0x459183(0x14a)]===_0x459183(0x74b)?_0x4fe56e=_0x1464d9[_0x459183(0x1000)]?_0x1464d9['settings'][_0x459183(0xe16)]||'我':'我':_0x4fe56e=_0x1464d9[_0x459183(0x1000)]?_0x240ec0[_0x459183(0x770)]:_0x1464d9['name']);}}return _0x18c835['toLowerCase']()['includes'](_0x52d970)||_0x4fe56e[_0x459183(0xab8)]()[_0x459183(0x773)](_0x52d970);});_0x4141a3(_0x5c6a38);}),_0x198a16[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x5c8fde=_0x497273;_0x13fdb7[_0x5c8fde(0x518)]='',_0x198a16[_0x5c8fde(0x842)]['display']=_0x5c8fde(0xbf8),_0x4141a3(allFavoriteItems),_0x13fdb7[_0x5c8fde(0x10f7)]();}),document[_0x497273(0x8c2)](_0x497273(0xd06))[_0x497273(0xae8)]('click',async()=>{const _0x1e1642=_0x497273;if(_0x13ef23[_0x1e1642(0xf72)]===0x0)return;const _0x2794db=_0x405767[_0x1e1642(0x799)][_0x405767[_0x1e1642(0x248)]];if(!_0x2794db)return;const _0xa552cf=[],_0x2c02e7=[..._0x13ef23];for(const _0xa206cd of _0x2c02e7){const _0x28d566=await _0x15043e['favorites'][_0x1e1642(0xdb8)](_0x1e1642(0x967))[_0x1e1642(0xc9a)](_0xa206cd)[_0x1e1642(0xf2e)]();if(!_0x28d566){const _0x377320=_0x2794db['history'][_0x1e1642(0x2ef)](_0x116839=>_0x116839[_0x1e1642(0x351)]===_0xa206cd);_0x377320&&_0xa552cf['push']({'type':_0x1e1642(0xb05),'content':_0x377320,'chatId':_0x405767[_0x1e1642(0x248)],'timestamp':Date[_0x1e1642(0x1ed)](),'originalTimestamp':_0x377320[_0x1e1642(0x351)]});}}_0xa552cf[_0x1e1642(0x105a)]>0x0?(await _0x15043e[_0x1e1642(0xe93)][_0x1e1642(0x116d)](_0xa552cf),allFavoriteItems=await _0x15043e['favorites'][_0x1e1642(0x731)](_0x1e1642(0x351))['reverse']()[_0x1e1642(0x6be)](),await _0x501c7b(_0x1e1642(0x871),_0x1e1642(0x337)+_0xa552cf['length']+'\x20条消息。')):await _0x501c7b('提示',_0x1e1642(0x108f)),_0x23ba0c();});const _0x2ac0e6=document[_0x497273(0x8c2)](_0x497273(0xf14)),_0x4a19da=document[_0x497273(0x8c2)]('favorites-view'),_0x1b6b8a=document[_0x497273(0x8c2)](_0x497273(0x1d3)),_0x5f22c9=document[_0x497273(0x8c2)]('chat-list-bottom-nav'),_0x334993=document[_0x497273(0x8c2)](_0x497273(0x1103));_0x2ac0e6[_0x497273(0xae8)]('click',()=>{const _0x1b1533=_0x497273;_0x7e4f8a=!_0x7e4f8a,_0x4a19da[_0x1b1533(0xb17)]['toggle'](_0x1b1533(0xe97),_0x7e4f8a),_0x7e4f8a?(_0x2ac0e6['textContent']='完成',_0x1b6b8a['style'][_0x1b1533(0x5e9)]=_0x1b1533(0xea7),_0x5f22c9[_0x1b1533(0x842)][_0x1b1533(0x5e9)]=_0x1b1533(0xbf8),_0x334993[_0x1b1533(0x842)][_0x1b1533(0x9b5)]=_0x1b1533(0xe4d)):(_0x2ac0e6[_0x1b1533(0x1090)]='编辑',_0x1b6b8a[_0x1b1533(0x842)][_0x1b1533(0x5e9)]=_0x1b1533(0xbf8),_0x5f22c9['style']['display']=_0x1b1533(0xd52),_0x334993['style']['paddingBottom']='',_0x5388ea['clear'](),document[_0x1b1533(0xa2d)]('.favorite-item-card.selected')[_0x1b1533(0x7c0)](_0x22e247=>_0x22e247['classList']['remove']('selected')),document[_0x1b1533(0x8c2)]('favorites-delete-selected-btn')[_0x1b1533(0x1090)]=_0x1b1533(0x1227));}),document[_0x497273(0x8c2)](_0x497273(0x1103))['addEventListener']('click',_0x6bbffe=>{const _0x44a808=_0x497273,_0x32c478=_0x6bbffe[_0x44a808(0x475)],_0x1393ce=_0x32c478[_0x44a808(0xa90)](_0x44a808(0xc40));if(_0x32c478[_0x44a808(0xf6b)]==='IMG'&&_0x32c478[_0x44a808(0x323)][_0x44a808(0xbff)]){const _0x13237a=_0x32c478[_0x44a808(0x323)]['hiddenText'];_0x501c7b(_0x44a808(0xa4b),_0x13237a[_0x44a808(0x1b7)](/<br>/g,'\x0a'));return;}if(!_0x7e4f8a)return;if(!_0x1393ce)return;const _0x4fb373=parseInt(_0x1393ce[_0x44a808(0x323)]['favid']);if(isNaN(_0x4fb373))return;_0x5388ea[_0x44a808(0x11ac)](_0x4fb373)?(_0x5388ea[_0x44a808(0x89f)](_0x4fb373),_0x1393ce[_0x44a808(0xb17)][_0x44a808(0xaff)](_0x44a808(0x118f))):(_0x5388ea[_0x44a808(0x3f4)](_0x4fb373),_0x1393ce[_0x44a808(0xb17)][_0x44a808(0x3f4)](_0x44a808(0x118f))),document[_0x44a808(0x8c2)](_0x44a808(0xc5e))[_0x44a808(0x1090)]=_0x44a808(0xaad)+_0x5388ea['size']+')';}),document[_0x497273(0x8c2)](_0x497273(0xc5e))[_0x497273(0xae8)]('click',async()=>{const _0x6d9aa=_0x497273;if(_0x5388ea['size']===0x0)return;const _0x3cc210=await _0x8b9cb8('确认删除',_0x6d9aa(0x107c)+_0x5388ea[_0x6d9aa(0xf72)]+_0x6d9aa(0x1002),{'confirmButtonClass':_0x6d9aa(0xe2a)});if(_0x3cc210){const _0x4db939=[..._0x5388ea];await _0x15043e[_0x6d9aa(0xe93)][_0x6d9aa(0x101d)](_0x4db939),await _0x501c7b(_0x6d9aa(0x824),_0x6d9aa(0xd5a)),allFavoriteItems=allFavoriteItems[_0x6d9aa(0x1d8)](_0x1bacf8=>!_0x4db939[_0x6d9aa(0x773)](_0x1bacf8['id'])),_0x4141a3(allFavoriteItems),_0x2ac0e6['click']();}});_0x405767['globalSettings']['enableBackgroundActivity']&&(_0x1af605(),console[_0x497273(0x32b)](_0x497273(0x646)));document['querySelectorAll'](_0x497273(0xf6c))[_0x497273(0x7c0)](_0x262810=>{const _0x2d2c31=_0x497273;_0x262810[_0x2d2c31(0xae8)](_0x2d2c31(0x7a7),_0x9e9510);});const _0x5f46be=document['getElementById']('font-size-slider');_0x5f46be[_0x497273(0xae8)]('input',()=>{const _0x15dac0=_0x497273;document[_0x15dac0(0x8c2)](_0x15dac0(0x655))[_0x15dac0(0x1090)]=_0x5f46be[_0x15dac0(0x518)]+'px',_0x9e9510();});const _0x97063b=document[_0x497273(0x8c2)](_0x497273(0x10b9));_0x97063b[_0x497273(0xae8)](_0x497273(0x58f),_0x9e9510),document['getElementById']('reset-theme-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x45e50c=_0x497273;document[_0x45e50c(0x8c2)](_0x45e50c(0x637))[_0x45e50c(0x75f)]=!![],_0x9e9510();}),document[_0x497273(0x8c2)](_0x497273(0x127a))['addEventListener'](_0x497273(0xa17),()=>{const _0x3059de=_0x497273;document[_0x3059de(0x8c2)](_0x3059de(0x10b9))['value']='',_0x9e9510();}),document[_0x497273(0x8c2)](_0x497273(0x115b))[_0x497273(0xae8)](_0x497273(0x7a7),_0x9e9510),document['getElementById'](_0x497273(0x8ff))['addEventListener'](_0x497273(0x7a7),_0x9e9510),document[_0x497273(0x8c2)](_0x497273(0x280))['addEventListener']('input',_0x9e9510),document[_0x497273(0xa2d)](_0x497273(0xf39))[_0x497273(0x7c0)](_0x96cb87=>{const _0x5f5bcc=_0x497273;_0x96cb87[_0x5f5bcc(0xae8)](_0x5f5bcc(0x7a7),function(){const _0x586e02=_0x5f5bcc,_0x342a28=document[_0x586e02(0x8c2)](_0x586e02(0x575));this['value']===_0x586e02(0x876)||this[_0x586e02(0x518)]===_0x586e02(0x99a)?_0x342a28[_0x586e02(0x842)][_0x586e02(0x5e9)]=_0x586e02(0xea7):_0x342a28[_0x586e02(0x842)][_0x586e02(0x5e9)]=_0x586e02(0xbf8);});}),document[_0x497273(0x8c2)](_0x497273(0x114d))[_0x497273(0xae8)](_0x497273(0xa17),_0x28297a),document[_0x497273(0x8c2)](_0x497273(0x10cb))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0xfe673f=_0x497273;document[_0xfe673f(0x8c2)](_0xfe673f(0x119c))['classList']['remove'](_0xfe673f(0x2cd));const _0xdd744c=document[_0xfe673f(0x8c2)](_0xfe673f(0x2fc));document['getElementById'](_0xfe673f(0x146))['classList'][_0xfe673f(0x795)](_0xfe673f(0x2cd))&&_0xdd744c[_0xfe673f(0xa17)]();}),document[_0x497273(0x8c2)]('add-new-group-btn')[_0x497273(0xae8)]('click',_0x1ecd34),document[_0x497273(0x8c2)](_0x497273(0xf06))[_0x497273(0xae8)]('click',_0x498b29=>{const _0x587615=_0x497273;if(_0x498b29[_0x587615(0x475)][_0x587615(0xb17)][_0x587615(0x795)](_0x587615(0x741))){const _0x16d166=parseInt(_0x498b29[_0x587615(0x475)]['dataset']['id']);_0x3d2746(_0x16d166);}}),document[_0x497273(0x8c2)](_0x497273(0x650))[_0x497273(0xae8)](_0x497273(0xa17),_0x152bc1),document[_0x497273(0x8c2)]('edit-message-btn')[_0x497273(0xae8)]('click',_0x23ebbe),document[_0x497273(0x8c2)](_0x497273(0x6ca))['addEventListener'](_0x497273(0xa17),_0x43542b),document[_0x497273(0x8c2)]('recall-message-btn')[_0x497273(0xae8)]('click',_0x53f0e1),document['getElementById'](_0x497273(0x760))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x292da8=_0x39784f;_0x152bc1(),_0x292da8&&_0x4bac0a(_0x292da8);}),document[_0x497273(0x8c2)](_0x497273(0xb24))[_0x497273(0xae8)](_0x497273(0xa17),_0x96ad1=>{const _0x23269b=_0x497273,_0x4ff902=_0x96ad1['target'][_0x23269b(0xa90)](_0x23269b(0xc46));if(!_0x4ff902)return;if(_0x4ff902[_0x23269b(0xb17)][_0x23269b(0x795)]('ai')&&_0x4ff902[_0x23269b(0xb17)][_0x23269b(0x795)](_0x23269b(0x1156))&&_0x4ff902[_0x23269b(0x323)][_0x23269b(0x8c8)]===_0x23269b(0xd2d)){const _0x44888e=parseInt(_0x4ff902[_0x23269b(0x323)][_0x23269b(0x351)]);!isNaN(_0x44888e)&&_0x39c7cd(_0x44888e);}}),document[_0x497273(0x8c2)](_0x497273(0x10cc))['addEventListener'](_0x497273(0xa17),()=>_0x23fcf7(_0x497273(0xe4b))),document[_0x497273(0x8c2)](_0x497273(0xb9d))['addEventListener'](_0x497273(0xa17),()=>_0x23fcf7(_0x497273(0x1288))),document['getElementById'](_0x497273(0x444))[_0x497273(0xae8)](_0x497273(0xa17),_0x5b4d91),document['getElementById'](_0x497273(0x1292))[_0x497273(0xae8)]('click',_0x2513d5),document['getElementById'](_0x497273(0x928))[_0x497273(0xae8)](_0x497273(0xa17),_0xbc5169),document['getElementById']('cancel-post-action-btn')['addEventListener'](_0x497273(0xa17),_0x599801),document['getElementById'](_0x497273(0x11c1))[_0x497273(0xae8)]('click',()=>{const _0x4363bb=_0x497273;_0x3d1990(_0x4363bb(0x3b7));}),document[_0x497273(0x8c2)](_0x497273(0xad1))['addEventListener']('click',_0x3f1874=>{const _0x2daa02=_0x497273,_0x3ff283=_0x3f1874[_0x2daa02(0x475)][_0x2daa02(0xa90)]('.contact-picker-item');if(!_0x3ff283)return;const _0x1485b0=_0x3ff283[_0x2daa02(0x323)]['contactId'];_0x3ff283['classList']['toggle'](_0x2daa02(0x118f)),_0x45a6e8[_0x2daa02(0x11ac)](_0x1485b0)?_0x45a6e8[_0x2daa02(0x89f)](_0x1485b0):_0x45a6e8[_0x2daa02(0x3f4)](_0x1485b0),_0x1526cb();}),document[_0x497273(0x8c2)](_0x497273(0xd63))[_0x497273(0xae8)](_0x497273(0xa17),()=>{_0x9f9279();}),document['getElementById']('back-from-member-management')['addEventListener'](_0x497273(0xa17),()=>{const _0x3312b5=_0x497273;_0x3d1990(_0x3312b5(0xd5c)),document[_0x3312b5(0x8c2)](_0x3312b5(0x2fc))['click']();}),document[_0x497273(0x8c2)](_0x497273(0x64b))[_0x497273(0xae8)](_0x497273(0xa17),_0x595695=>{const _0x217d90=_0x497273;_0x595695[_0x217d90(0x475)][_0x217d90(0xb17)][_0x217d90(0x795)](_0x217d90(0x40d))&&_0x2ebc2f(_0x595695['target'][_0x217d90(0x323)][_0x217d90(0x377)]);}),document[_0x497273(0x8c2)](_0x497273(0x9e2))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x6a6018=_0x497273,_0x471ad6=document[_0x6a6018(0x8c2)](_0x6a6018(0xa5d)),_0x2a3977=_0x471ad6[_0x6a6018(0xac5)](!![]);_0x471ad6[_0x6a6018(0xe66)][_0x6a6018(0x56b)](_0x2a3977,_0x471ad6),_0x2a3977[_0x6a6018(0xae8)](_0x6a6018(0xa17),_0x350faf),await _0x1aae64();}),document['getElementById'](_0x497273(0xfb7))[_0x497273(0xae8)](_0x497273(0xa17),_0x4c65fa),document['getElementById'](_0x497273(0x120d))[_0x497273(0xae8)]('click',_0xb611f0),document[_0x497273(0x8c2)](_0x497273(0x5e5))[_0x497273(0xae8)]('click',_0xb611f0),document[_0x497273(0x8c2)](_0x497273(0x244))['addEventListener']('click',_0x408ee2),document[_0x497273(0x8c2)](_0x497273(0x11f2))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x5949a1=_0x497273;_0x49beae[_0x5949a1(0x324)]=![],_0x3d1990(_0x5949a1(0xd5c));}),document[_0x497273(0x8c2)](_0x497273(0x29d))[_0x497273(0xae8)](_0x497273(0xa17),_0x23a3d3),document[_0x497273(0x8c2)](_0x497273(0x372))[_0x497273(0xae8)]('click',async()=>{const _0x23eb2e=_0x497273;_0x1e514a();const _0x3aec12=_0x405767['chats'][_0x49beae[_0x23eb2e(0x248)]];if(!_0x3aec12)return;if(_0x49beae[_0x23eb2e(0x390)]){_0x49beae['isUserParticipating']=![];const _0x1c42f5={'role':_0x23eb2e(0x46c),'content':'[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','timestamp':Date['now'](),'isHidden':!![]};_0x3aec12[_0x23eb2e(0xd39)][_0x23eb2e(0xa49)](_0x1c42f5),await _0x15043e[_0x23eb2e(0x799)]['put'](_0x3aec12),await _0x523815();}else{const _0x36a2b8={'role':'user','content':_0x23eb2e(0x551),'timestamp':Date['now']()};_0x3aec12['history'][_0x23eb2e(0xa49)](_0x36a2b8),await _0x15043e[_0x23eb2e(0x799)][_0x23eb2e(0xfaa)](_0x3aec12),_0x3d1990(_0x23eb2e(0xd5c)),_0x5c5c92(_0x36a2b8,_0x3aec12),_0x523815();}_0x49beae[_0x23eb2e(0x324)]=![];}),document['getElementById']('accept-call-btn')[_0x497273(0xae8)]('click',async()=>{const _0x2c54b8=_0x497273;_0x1e514a(),_0x49beae[_0x2c54b8(0xf70)]='ai',_0x49beae[_0x2c54b8(0x7d0)]=!![],_0x49beae['activeChatId']=_0x405767[_0x2c54b8(0x248)];if(_0x49beae[_0x2c54b8(0x390)]){const _0x2a4692=_0x405767[_0x2c54b8(0x799)][_0x49beae[_0x2c54b8(0x248)]],_0x2da18e=_0x2a4692[_0x2c54b8(0x635)][_0x2c54b8(0x2ef)](_0x184f0f=>_0x184f0f[_0x2c54b8(0x596)]===_0x49beae[_0x2c54b8(0xf53)]);_0x2da18e?_0x49beae[_0x2c54b8(0x190)]=[_0x2da18e]:_0x49beae['participants']=[];}_0x543413();}),document[_0x497273(0x8c2)](_0x497273(0x1130))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x1c59de=_0x497273;if(!_0x49beae[_0x1c59de(0x6f0)])return;const _0x56d795=document[_0x1c59de(0x1ad)](_0x1c59de(0xde9));_0x56d795&&_0x56d795[_0x1c59de(0xb17)][_0x1c59de(0x3f4)](_0x1c59de(0x99f));const _0xc0acc=await _0x180f74('你说',_0x1c59de(0xeb5));_0x56d795&&_0x56d795[_0x1c59de(0xb17)][_0x1c59de(0xaff)](_0x1c59de(0x99f)),_0xc0acc&&_0xc0acc[_0x1c59de(0x8c6)]()&&_0x519abd(_0xc0acc['trim']());}),document[_0x497273(0x1ad)](_0x497273(0x890))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x2f7599=_0x497273;_0x7e4f8a&&document[_0x2f7599(0x8c2)]('favorites-edit-btn')[_0x2f7599(0xa17)](),_0x3d8143(_0x2f7599(0x1184)),_0x1c4375();}),document[_0x497273(0x8c2)](_0x497273(0x17d))[_0x497273(0xae8)](_0x497273(0xa17),()=>_0x3d8143(_0x497273(0x4a1))),document[_0x497273(0x8c2)]('confirm-create-countdown-btn')[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x4c73df=_0x497273,_0x50a6e0=document['getElementById'](_0x4c73df(0xe1a))[_0x4c73df(0x518)]['trim'](),_0x1e4d39=document['getElementById'](_0x4c73df(0x863))[_0x4c73df(0x518)];if(!_0x50a6e0||!_0x1e4d39){alert('请填写完整的约定标题和日期！');return;}const _0x4930a7=new Date(_0x1e4d39);if(isNaN(_0x4930a7)||_0x4930a7<=new Date()){alert(_0x4c73df(0x11a6));return;}const _0x1523ee={'authorId':'user','description':_0x50a6e0,'timestamp':Date[_0x4c73df(0x1ed)](),'type':_0x4c73df(0x5ff),'targetDate':_0x4930a7[_0x4c73df(0x610)]()};await _0x15043e[_0x4c73df(0x4a0)][_0x4c73df(0x3f4)](_0x1523ee),document[_0x4c73df(0x8c2)](_0x4c73df(0xd40))[_0x4c73df(0xb17)]['remove'](_0x4c73df(0x2cd)),_0x1c4375();}),document[_0x497273(0x8c2)]('block-chat-btn')[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x2aaf0b=_0x497273;if(!_0x405767[_0x2aaf0b(0x248)]||_0x405767[_0x2aaf0b(0x799)][_0x405767[_0x2aaf0b(0x248)]]['isGroup'])return;const _0x1e6408=_0x405767[_0x2aaf0b(0x799)][_0x405767[_0x2aaf0b(0x248)]],_0x303270=await _0x8b9cb8(_0x2aaf0b(0xfa0),_0x2aaf0b(0x5bc)+_0x1e6408[_0x2aaf0b(0x596)]+_0x2aaf0b(0x974),{'confirmButtonClass':_0x2aaf0b(0xe2a)});if(_0x303270){_0x1e6408['relationship'][_0x2aaf0b(0x8c8)]=_0x2aaf0b(0x1e6),_0x1e6408[_0x2aaf0b(0x944)][_0x2aaf0b(0x42a)]=Date[_0x2aaf0b(0x1ed)]();const _0xa0739d={'role':_0x2aaf0b(0x46c),'content':_0x2aaf0b(0xab5),'timestamp':Date[_0x2aaf0b(0x1ed)]()+0x1,'isHidden':!![]};_0x1e6408[_0x2aaf0b(0xd39)][_0x2aaf0b(0xa49)](_0xa0739d),await _0x15043e[_0x2aaf0b(0x799)][_0x2aaf0b(0xfaa)](_0x1e6408),document[_0x2aaf0b(0x8c2)](_0x2aaf0b(0x146))[_0x2aaf0b(0xb17)][_0x2aaf0b(0xaff)](_0x2aaf0b(0x2cd)),_0x7dbe71(_0x405767['activeChatId']),_0x2b55d1();}}),document['getElementById'](_0x497273(0x106c))[_0x497273(0xae8)](_0x497273(0xa17),async _0x47c518=>{const _0x148fe2=_0x497273,_0x58e98c=_0x405767[_0x148fe2(0x799)][_0x405767[_0x148fe2(0x248)]];if(!_0x58e98c)return;if(_0x47c518[_0x148fe2(0x475)]['id']==='force-apply-check-btn'){alert('正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。'),await _0x50ee11(_0x58e98c['id']),_0x7dbe71(_0x58e98c['id']);return;}if(_0x47c518[_0x148fe2(0x475)]['id']===_0x148fe2(0xead)){_0x58e98c[_0x148fe2(0x944)]['status']=_0x148fe2(0xaa7),_0x58e98c[_0x148fe2(0x944)][_0x148fe2(0x42a)]=null;const _0x32fbe6={'role':_0x148fe2(0x46c),'content':_0x148fe2(0x1254),'timestamp':Date[_0x148fe2(0x1ed)](),'isHidden':!![]};_0x58e98c['history'][_0x148fe2(0xa49)](_0x32fbe6),await _0x15043e['chats'][_0x148fe2(0xfaa)](_0x58e98c),_0x7dbe71(_0x58e98c['id']),_0x2b55d1(),_0x523815();}else{if(_0x47c518[_0x148fe2(0x475)]['id']==='accept-friend-btn'){_0x58e98c[_0x148fe2(0x944)]['status']=_0x148fe2(0xaa7),_0x58e98c['relationship'][_0x148fe2(0x727)]='';const _0x4021c2={'role':_0x148fe2(0x46c),'type':_0x148fe2(0x6f1),'content':_0x148fe2(0xfbc)+_0x58e98c[_0x148fe2(0x596)]+_0x148fe2(0x38a),'timestamp':Date[_0x148fe2(0x1ed)]()};_0x58e98c[_0x148fe2(0xd39)]['push'](_0x4021c2);const _0x3c5113={'role':_0x148fe2(0x458),'senderName':_0x58e98c[_0x148fe2(0x596)],'content':'太好了！我们又可以聊天啦！','timestamp':Date['now']()+0x1};_0x58e98c['history'][_0x148fe2(0xa49)](_0x3c5113),await _0x15043e['chats']['put'](_0x58e98c),_0x7dbe71(_0x58e98c['id']),_0x2b55d1();}else{if(_0x47c518['target']['id']===_0x148fe2(0x1197))_0x58e98c['relationship']['status']='blocked_by_user',_0x58e98c['relationship'][_0x148fe2(0x42a)]=Date['now'](),_0x58e98c['relationship']['applicationReason']='',await _0x15043e[_0x148fe2(0x799)][_0x148fe2(0xfaa)](_0x58e98c),_0x7dbe71(_0x58e98c['id']);else{if(_0x47c518['target']['id']==='apply-friend-btn'){const _0x1e32d2=await _0x180f74(_0x148fe2(0x20f),_0x148fe2(0xe9b)+_0x58e98c[_0x148fe2(0x596)]+'”说的申请理由：',_0x148fe2(0x885));_0x1e32d2!==null&&(_0x58e98c[_0x148fe2(0x944)][_0x148fe2(0x8c8)]='pending_ai_approval',_0x58e98c['relationship']['applicationReason']=_0x1e32d2,await _0x15043e[_0x148fe2(0x799)]['put'](_0x58e98c),_0x7dbe71(_0x58e98c['id']),_0x2b55d1(),_0x523815());}}}}}),document[_0x497273(0x8c2)](_0x497273(0xef2))[_0x497273(0xae8)](_0x497273(0xa17),_0x1ae447),document['getElementById']('cancel-red-packet-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x1f8a5f=_0x497273;document[_0x1f8a5f(0x8c2)]('red-packet-modal')['classList']['remove'](_0x1f8a5f(0x2cd));}),document['getElementById']('send-group-packet-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x49fc2c),document[_0x497273(0x8c2)](_0x497273(0x4fd))['addEventListener']('click',_0x49eb4a);const _0x309379=document[_0x497273(0x8c2)](_0x497273(0xe7d)),_0x415a9a=document['getElementById'](_0x497273(0x1049)),_0xb7ccd9=document[_0x497273(0x8c2)]('rp-content-group'),_0xa4fd2c=document[_0x497273(0x8c2)](_0x497273(0xfd8));_0x309379[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x3d4187=_0x497273;_0x309379['classList'][_0x3d4187(0x3f4)](_0x3d4187(0x71b)),_0x415a9a[_0x3d4187(0xb17)][_0x3d4187(0xaff)](_0x3d4187(0x71b)),_0xb7ccd9[_0x3d4187(0x842)][_0x3d4187(0x5e9)]=_0x3d4187(0xea7),_0xa4fd2c[_0x3d4187(0x842)]['display']=_0x3d4187(0xbf8);}),_0x415a9a[_0x497273(0xae8)]('click',()=>{const _0x394239=_0x497273;_0x415a9a[_0x394239(0xb17)]['add']('active'),_0x309379[_0x394239(0xb17)][_0x394239(0xaff)](_0x394239(0x71b)),_0xa4fd2c[_0x394239(0x842)][_0x394239(0x5e9)]=_0x394239(0xea7),_0xb7ccd9[_0x394239(0x842)][_0x394239(0x5e9)]='none';}),document[_0x497273(0x8c2)](_0x497273(0x883))['addEventListener'](_0x497273(0x58f),_0x3ebae6=>{const _0x15ef6f=_0x497273,_0x35c99d=parseFloat(_0x3ebae6['target'][_0x15ef6f(0x518)])||0x0;document['getElementById'](_0x15ef6f(0x3d3))[_0x15ef6f(0x1090)]='¥\x20'+_0x35c99d['toFixed'](0x2);}),document[_0x497273(0x8c2)]('rp-direct-amount')[_0x497273(0xae8)]('input',_0x5118ef=>{const _0x51700b=_0x497273,_0x2f2134=parseFloat(_0x5118ef[_0x51700b(0x475)][_0x51700b(0x518)])||0x0;document['getElementById'](_0x51700b(0x184))[_0x51700b(0x1090)]='¥\x20'+_0x2f2134['toFixed'](0x2);}),document[_0x497273(0x8c2)](_0x497273(0xb24))[_0x497273(0xae8)]('click',_0x8c051b=>{const _0x554159=_0x497273,_0x43ebe7=_0x8c051b[_0x554159(0x475)][_0x554159(0xa90)](_0x554159(0xcb4));if(!_0x43ebe7)return;const _0x26aa80=_0x43ebe7[_0x554159(0xa90)](_0x554159(0xc46));if(!_0x26aa80||!_0x26aa80[_0x554159(0x323)][_0x554159(0x351)])return;const _0x534d30=parseInt(_0x26aa80[_0x554159(0x323)]['timestamp']);_0x1ee22(_0x534d30);}),document[_0x497273(0x8c2)](_0x497273(0x1a1))[_0x497273(0xae8)]('click',_0x284a1d),document[_0x497273(0x8c2)]('add-poll-option-btn')[_0x497273(0xae8)]('click',_0x21b36b),document[_0x497273(0x8c2)](_0x497273(0x3ae))['addEventListener']('click',()=>{const _0x5b12f7=_0x497273;document[_0x5b12f7(0x8c2)](_0x5b12f7(0x1274))[_0x5b12f7(0xb17)][_0x5b12f7(0xaff)](_0x5b12f7(0x2cd));}),document[_0x497273(0x8c2)](_0x497273(0x300))[_0x497273(0xae8)](_0x497273(0xa17),_0x3f2645),document[_0x497273(0x8c2)]('chat-messages')[_0x497273(0xae8)]('click',_0x15eff6=>{const _0x137f82=_0x497273,_0x25d07f=_0x15eff6[_0x137f82(0x475)][_0x137f82(0xa90)](_0x137f82(0xa81));if(!_0x25d07f)return;const _0x93fd8e=parseInt(_0x25d07f[_0x137f82(0x323)][_0x137f82(0x109a)]);if(isNaN(_0x93fd8e))return;const _0x31f531=_0x15eff6['target'][_0x137f82(0xa90)](_0x137f82(0x16c));if(_0x31f531&&!_0x25d07f['classList'][_0x137f82(0x795)](_0x137f82(0xed4))){_0x148de8(_0x93fd8e,_0x31f531['dataset']['option']);return;}const _0x1de1f3=_0x15eff6[_0x137f82(0x475)][_0x137f82(0xa90)](_0x137f82(0x905));if(_0x1de1f3){_0x25d07f[_0x137f82(0xb17)][_0x137f82(0x795)](_0x137f82(0xed4))?_0x57f1a4(_0x93fd8e):_0xac2567(_0x93fd8e);return;}_0x25d07f[_0x137f82(0xb17)][_0x137f82(0x795)](_0x137f82(0xed4))&&_0x57f1a4(_0x93fd8e);}),document[_0x497273(0x8c2)](_0x497273(0xf49))['addEventListener']('click',_0x134fcc),document['getElementById'](_0x497273(0x4a3))['addEventListener'](_0x497273(0xa17),()=>_0x2cdedb('ai')),document['getElementById']('add-group-avatar-batch-btn')['addEventListener']('click',()=>_0x2cdedb(_0x497273(0x92f))),document[_0x497273(0x8c2)](_0x497273(0x59a))[_0x497273(0xae8)](_0x497273(0xa17),_0x492bb2),document[_0x497273(0x8c2)](_0x497273(0x127d))[_0x497273(0xae8)]('click',()=>{const _0x25de98=_0x497273;document[_0x25de98(0x8c2)](_0x25de98(0xa13))['click']();}),document[_0x497273(0x8c2)](_0x497273(0xa13))['addEventListener']('change',_0x4da1eb),document[_0x497273(0x8c2)](_0x497273(0x11fd))['addEventListener'](_0x497273(0xa17),_0x90f937),document['getElementById']('manage-group-avatar-library-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x284075),document['getElementById'](_0x497273(0xe0b))['addEventListener']('click',_0x21dd40),document[_0x497273(0x8c2)](_0x497273(0xb69))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0xdcdad9=_0x497273;document['getElementById'](_0xdcdad9(0x5db))['click']();}),document[_0x497273(0x8c2)](_0x497273(0x5db))[_0x497273(0xae8)](_0x497273(0x7a7),_0x236764),document[_0x497273(0x8c2)](_0x497273(0xc38))[_0x497273(0xae8)](_0x497273(0xa17),_0xe3fc74),document['getElementById'](_0x497273(0x4f5))[_0x497273(0xae8)](_0x497273(0xa17),_0x436fca=>{const _0x4bdd0e=_0x497273;if(_0x436fca[_0x4bdd0e(0x475)][_0x4bdd0e(0xb17)][_0x4bdd0e(0x795)](_0x4bdd0e(0xb16))){const _0x3f3cbd=_0x436fca[_0x4bdd0e(0x475)][_0x4bdd0e(0xa90)](_0x4bdd0e(0xc79)),_0x20b5a1=_0x3f3cbd['dataset'][_0x4bdd0e(0xc9b)];_0x20b5a1&&_0x119b2c(_0x20b5a1,_0x4bdd0e(0x1152),_0x3f3cbd);}}),document[_0x497273(0x8c2)]('chat-messages')[_0x497273(0xae8)]('click',_0x2ba6d2=>{const _0x45094f=_0x497273,_0xc65ff8=_0x2ba6d2['target'][_0x45094f(0xa90)](_0x45094f(0x11f4));if(_0xc65ff8){const _0x56a3c1=parseInt(_0xc65ff8['dataset']['timestamp']);!isNaN(_0x56a3c1)&&_0xf68cbe(_0x56a3c1);}}),document[_0x497273(0x8c2)](_0x497273(0x314))[_0x497273(0xae8)](_0x497273(0xa17),()=>{_0x3d1990('chat-interface-screen');}),_0x1b5b07[_0x497273(0xbbe)][_0x497273(0xae8)]('click',async _0x12a6d5=>{const _0x5d988f=_0x497273,_0xc96c3c=_0x12a6d5['target'][_0x5d988f(0xa90)]('.sticker-item');if(_0xc96c3c&&_0x1b5b07[_0x5d988f(0x370)]!==null){const _0x3b6e25=_0xc96c3c[_0x5d988f(0x842)]['backgroundImage'][_0x5d988f(0x961)](0x5,-0x2),_0x9704f0=_0x405767['userStickers'][_0x5d988f(0x2ef)](_0x2cc2ab=>_0x2cc2ab['url']===_0x3b6e25);_0x9704f0?await _0x9f73b8(_0x1b5b07[_0x5d988f(0x370)],_0x9704f0):console[_0x5d988f(0x112a)](_0x5d988f(0x504),_0x3b6e25);}}),document[_0x497273(0xae8)]('click',_0x4effee=>{const _0xab32ce=_0x497273;_0x1b5b07[_0xab32ce(0x356)]&&!_0x1b5b07[_0xab32ce(0xbbe)][_0xab32ce(0x795)](_0x4effee[_0xab32ce(0x475)])&&!_0x4effee[_0xab32ce(0x475)][_0xab32ce(0xa90)](_0xab32ce(0x11ba))&&_0xef4146();}),document['getElementById'](_0x497273(0x1256))['addEventListener'](_0x497273(0xa17),_0x3e074c),document[_0x497273(0x8c2)]('cancel-share-link-btn')['addEventListener'](_0x497273(0xa17),()=>{const _0x3c6f72=_0x497273;document[_0x3c6f72(0x8c2)](_0x3c6f72(0x1201))[_0x3c6f72(0xb17)][_0x3c6f72(0xaff)](_0x3c6f72(0x2cd));}),document[_0x497273(0x8c2)](_0x497273(0x1fa))[_0x497273(0xae8)](_0x497273(0xa17),_0xa4fd57),document[_0x497273(0x8c2)](_0x497273(0xacf))[_0x497273(0xae8)](_0x497273(0x7a7),_0x56038d),document[_0x497273(0x8c2)]('share-location-btn')[_0x497273(0xae8)]('click',_0x3e520e),document[_0x497273(0x8c2)](_0x497273(0xbdc))[_0x497273(0xae8)](_0x497273(0xa17),_0x192cae),document['getElementById'](_0x497273(0x3ac))[_0x497273(0xae8)](_0x497273(0xa17),()=>{_0x3d1990('chat-list-screen');}),document[_0x497273(0x8c2)](_0x497273(0x11fb))[_0x497273(0xae8)](_0x497273(0xa17),_0x273689=>{const _0x3c2a35=_0x497273,_0x141ce4=_0x273689[_0x3c2a35(0x475)][_0x3c2a35(0xa90)](_0x3c2a35(0x125a));_0x141ce4&&_0x141ce4[_0x3c2a35(0x323)][_0x3c2a35(0x548)]&&_0x52ac9c(parseInt(_0x141ce4[_0x3c2a35(0x323)][_0x3c2a35(0x548)]));}),document['getElementById'](_0x497273(0x66e))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x4bb6a8=_0x497273;document['getElementById'](_0x4bb6a8(0x78a))[_0x4bb6a8(0xb17)][_0x4bb6a8(0xaff)]('visible');}),document['getElementById']('chat-header-status')['addEventListener'](_0x497273(0xa17),_0x188fb3),document[_0x497273(0x8c2)]('selection-share-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x42e9ff=_0x497273;_0x13ef23[_0x42e9ff(0xf72)]>0x0&&_0x21c59b();}),document['getElementById'](_0x497273(0xdd9))[_0x497273(0xae8)](_0x497273(0xa17),_0x2bcfad),document[_0x497273(0x8c2)](_0x497273(0xdf5))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x3d4661=_0x497273,_0x57a4ef=_0x405767[_0x3d4661(0x799)][_0x405767['activeChatId']],_0x41449c=Array['from'](document[_0x3d4661(0xa2d)](_0x3d4661(0x9c2)))['map'](_0x399df6=>_0x399df6['dataset'][_0x3d4661(0xb3d)]);if(_0x41449c[_0x3d4661(0x105a)]===0x0){alert(_0x3d4661(0xf4d));return;}const _0x3a2ca7=[],_0x9f06d9=[..._0x13ef23][_0x3d4661(0xa19)]((_0x4c4105,_0x32db16)=>_0x4c4105-_0x32db16);for(const _0x2cba1d of _0x9f06d9){const _0x4daf04=_0x57a4ef[_0x3d4661(0xd39)]['find'](_0x214b8c=>_0x214b8c[_0x3d4661(0x351)]===_0x2cba1d);_0x4daf04&&_0x3a2ca7[_0x3d4661(0xa49)](_0x4daf04);}const _0x1e6f7e={'role':'user','senderName':_0x57a4ef[_0x3d4661(0x1000)]?_0x57a4ef[_0x3d4661(0x33a)]['myNickname']||'我':'我','type':_0x3d4661(0x126b),'timestamp':Date[_0x3d4661(0x1ed)](),'payload':{'sourceChatName':_0x57a4ef[_0x3d4661(0x596)],'title':_0x3d4661(0x1083)+_0x57a4ef[_0x3d4661(0x596)]+'”的聊天记录','sharedHistory':_0x3a2ca7}};for(const _0x261bbe of _0x41449c){const _0x57517a=_0x405767['chats'][_0x261bbe];_0x57517a&&(_0x57517a[_0x3d4661(0xd39)][_0x3d4661(0xa49)](_0x1e6f7e),await _0x15043e[_0x3d4661(0x799)][_0x3d4661(0xfaa)](_0x57517a));}document[_0x3d4661(0x8c2)](_0x3d4661(0xc49))[_0x3d4661(0xb17)][_0x3d4661(0xaff)](_0x3d4661(0x2cd)),_0x23ba0c(),await _0x501c7b(_0x3d4661(0xa68),_0x3d4661(0x1247)+_0x41449c[_0x3d4661(0x105a)]+_0x3d4661(0xf63)),_0x2b55d1();}),document[_0x497273(0x8c2)](_0x497273(0x3f9))[_0x497273(0xae8)]('click',()=>{const _0x1a42a0=_0x497273;document[_0x1a42a0(0x8c2)]('share-target-modal')[_0x1a42a0(0xb17)][_0x1a42a0(0xaff)](_0x1a42a0(0x2cd));}),document[_0x497273(0x8c2)]('chat-messages')[_0x497273(0xae8)](_0x497273(0xa17),_0x2754b5=>{const _0x549e8b=_0x497273,_0x3028a5=_0x2754b5[_0x549e8b(0x475)][_0x549e8b(0xa90)](_0x549e8b(0x9f1));if(_0x3028a5&&_0x3028a5[_0x549e8b(0xa90)](_0x549e8b(0x862))){const _0x224c39=parseInt(_0x3028a5[_0x549e8b(0x323)][_0x549e8b(0x351)]);_0x59355e(_0x224c39);}}),document[_0x497273(0x8c2)](_0x497273(0x11b4))['addEventListener'](_0x497273(0xa17),()=>{const _0x182ca1=_0x497273;document[_0x182ca1(0x8c2)](_0x182ca1(0x11e0))['classList']['remove'](_0x182ca1(0x2cd));});async function _0x59355e(_0x126741){const _0x1b9592=_0x497273,_0x192637=_0x405767[_0x1b9592(0x799)][_0x405767['activeChatId']],_0x36609b=_0x192637[_0x1b9592(0xd39)][_0x1b9592(0x2ef)](_0x2e3aeb=>_0x2e3aeb[_0x1b9592(0x351)]===_0x126741);if(!_0x36609b||_0x36609b[_0x1b9592(0xde0)]!=='share_card'||!_0x36609b[_0x1b9592(0xba9)]){console[_0x1b9592(0x7a3)]('无法找到或消息类型/内容不匹配的分享记录:',_0x126741),await _0x501c7b(_0x1b9592(0x1fb),_0x1b9592(0x1245));return;}const _0x14c458=document['getElementById'](_0x1b9592(0x11e0)),_0x46c2c6=document[_0x1b9592(0x8c2)]('shared-history-viewer-title'),_0x4dcc21=document[_0x1b9592(0x8c2)](_0x1b9592(0x1239));_0x46c2c6[_0x1b9592(0x1090)]=_0x36609b['payload'][_0x1b9592(0xcea)],_0x4dcc21['innerHTML']='';const _0x195bf7=document['createDocumentFragment'](),_0x2f7806=Object[_0x1b9592(0x22f)](_0x405767[_0x1b9592(0x799)])['find'](_0x2f0187=>_0x2f0187[_0x1b9592(0x596)]===_0x36609b[_0x1b9592(0xba9)][_0x1b9592(0x70d)])||_0x192637;for(const _0x1016f9 of _0x36609b['payload'][_0x1b9592(0xceb)]){const _0xa42ee=await _0x3cd22d(_0x1016f9,_0x2f7806);_0xa42ee&&_0x195bf7[_0x1b9592(0x31e)](_0xa42ee);}_0x4dcc21[_0x1b9592(0x31e)](_0x195bf7),_0x14c458[_0x1b9592(0xb17)][_0x1b9592(0x3f4)]('visible');}_0x3fd13b[_0x497273(0xae8)](_0x497273(0x545),_0x265f34),_0x3fd13b[_0x497273(0xae8)]('pause',()=>{const _0x316ab2=_0x497273;_0x4a77e1[_0x316ab2(0x6f0)]&&(_0x4a77e1[_0x316ab2(0x219)]=![],_0x59d0b7());}),_0x3fd13b['addEventListener'](_0x497273(0xf12),()=>{const _0xd2262f=_0x497273;_0x4a77e1[_0xd2262f(0x6f0)]&&(_0x4a77e1[_0xd2262f(0x219)]=!![],_0x59d0b7());}),document[_0x497273(0x8c2)](_0x497273(0x499))['addEventListener'](_0x497273(0xa17),async _0x5d6e00=>{const _0x4e4b8e=_0x497273,_0x1071a5=_0x5d6e00['target'],_0x431cef=_0x1071a5[_0x4e4b8e(0xa90)](_0x4e4b8e(0x99c));if(_0x431cef){const _0x19165b=parseInt(_0x431cef[_0x4e4b8e(0x323)][_0x4e4b8e(0x2f2)]);!isNaN(_0x19165b)&&await _0x52f1d7(_0x19165b);return;}const _0x2f6bd8=_0x1071a5[_0x4e4b8e(0xa90)]('.lyrics-btn');if(_0x2f6bd8){const _0x1d828d=parseInt(_0x2f6bd8[_0x4e4b8e(0x323)][_0x4e4b8e(0x2f2)]);if(isNaN(_0x1d828d))return;await _0x12b922(_0x1d828d);return;}const _0x6459c8=_0x1071a5['closest'](_0x4e4b8e(0x6fe));if(_0x6459c8){const _0x13f3da=parseInt(_0x6459c8['dataset'][_0x4e4b8e(0x2f2)]);if(isNaN(_0x13f3da))return;const _0x548257=_0x4a77e1['playlist'][_0x13f3da],_0x396603=await _0x8b9cb8(_0x4e4b8e(0x7dc),_0x4e4b8e(0x3a1)+_0x548257[_0x4e4b8e(0x596)]+_0x4e4b8e(0x152));_0x396603&&_0x48f800(_0x13f3da);return;}const _0xc94620=_0x1071a5[_0x4e4b8e(0xa90)](_0x4e4b8e(0xacc));if(_0xc94620){const _0x45089c=_0xc94620[_0x4e4b8e(0xa90)](_0x4e4b8e(0x36b)),_0x2050c1=Array[_0x4e4b8e(0x51a)](_0x45089c['parentElement'][_0x4e4b8e(0x9dd)])[_0x4e4b8e(0xbf2)](_0x45089c);_0x2050c1>-0x1&&_0x2e10b2(_0x2050c1);}}),document[_0x497273(0x1ad)]('.progress-bar')[_0x497273(0xae8)](_0x497273(0xa17),_0x2ece17=>{const _0x5967b3=_0x497273;if(!_0x3fd13b[_0x5967b3(0xf2c)])return;const _0x1d45d7=_0x2ece17[_0x5967b3(0x11d8)],_0x44135e=_0x1d45d7['clientWidth'],_0xf20ed1=_0x2ece17[_0x5967b3(0x2a7)];_0x3fd13b[_0x5967b3(0xe5e)]=_0xf20ed1/_0x44135e*_0x3fd13b[_0x5967b3(0xf2c)];}),document[_0x497273(0x8c2)](_0x497273(0xb24))['addEventListener'](_0x497273(0xa17),_0x4cc540=>{const _0x9be484=_0x497273,_0x542528=_0x4cc540[_0x9be484(0x475)]['closest']('.recalled-message-placeholder');if(_0x542528){const _0x180779=_0x405767[_0x9be484(0x799)][_0x405767[_0x9be484(0x248)]],_0xf8b548=_0x542528['closest'](_0x9be484(0x1270));if(_0x180779&&_0xf8b548){const _0x491edc=parseInt(_0xf8b548[_0x9be484(0x323)][_0x9be484(0x351)]),_0x2c55f4=_0x180779[_0x9be484(0xd39)][_0x9be484(0x2ef)](_0x3a48a7=>_0x3a48a7[_0x9be484(0x351)]===_0x491edc);if(_0x2c55f4&&_0x2c55f4[_0x9be484(0xf0e)]){let _0x172419='';const _0x1293da=_0x2c55f4[_0x9be484(0xf0e)];switch(_0x1293da[_0x9be484(0x123c)]){case'text':_0x172419='原文:\x20\x22'+_0x1293da[_0x9be484(0x657)]+'\x22';break;case _0x9be484(0x223):case _0x9be484(0x7c8):case _0x9be484(0xe36):_0x172419='[图片/文字图]\x20描述:\x20\x22'+_0x1293da['originalContent']+'\x22';break;case _0x9be484(0xf64):_0x172419='[语音]\x20内容:\x20\x22'+_0x1293da[_0x9be484(0x657)]+'\x22';break;case _0x9be484(0x1ac):_0x172419=_0x9be484(0x27e)+(_0x1293da[_0x9be484(0x8a2)]||_0x9be484(0x8bb))+_0x9be484(0xc7b)+_0x1293da['originalContent'];break;case _0x9be484(0x11b9):_0x172419='一条[转账]消息已被撤回。';break;default:_0x172419='撤回了一条['+_0x1293da['originalType']+_0x9be484(0x5be)+JSON[_0x9be484(0x1175)](_0x1293da['originalContent']);break;}_0x501c7b(_0x9be484(0x722),_0x172419);}}}}),document[_0x497273(0x8c2)](_0x497273(0x155))[_0x497273(0xae8)](_0x497273(0xa17),_0x4a1d46),document[_0x497273(0x8c2)](_0x497273(0xd18))['addEventListener'](_0x497273(0xa17),()=>{const _0x51927e=_0x497273;document[_0x51927e(0x8c2)](_0x51927e(0x93e))[_0x51927e(0xb17)]['remove'](_0x51927e(0x2cd)),_0x2d3fe9();}),document[_0x497273(0x8c2)](_0x497273(0x4ee))[_0x497273(0xae8)]('click',_0x1c0a47),document['getElementById'](_0x497273(0x37b))[_0x497273(0xae8)](_0x497273(0xa17),_0x2d196c=>{const _0x45a56f=_0x497273;if(_0x2d196c[_0x45a56f(0x475)][_0x45a56f(0xb17)][_0x45a56f(0x795)](_0x45a56f(0x741))){const _0x1c1e62=parseInt(_0x2d196c[_0x45a56f(0x475)]['dataset']['id']);_0x111f54(_0x1c1e62);}}),document[_0x497273(0x8c2)]('repost-cancel-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x9e1400),document[_0x497273(0x8c2)]('repost-confirm-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x1f8884),document[_0x497273(0x8c2)](_0x497273(0x10f8))[_0x497273(0xae8)](_0x497273(0xa17),_0x3020c7),document['getElementById'](_0x497273(0x514))['addEventListener'](_0x497273(0xa17),_0x54747e),document[_0x497273(0x8c2)](_0x497273(0x763))['addEventListener'](_0x497273(0x58f),_0x5c8042=>{const _0x4d63a0=_0x497273;if(!_0x5c8042[_0x4d63a0(0x475)][_0x4d63a0(0x10cd)](_0x4d63a0(0xdaf)))return;const _0x29dc37=_0x5c8042[_0x4d63a0(0x475)],_0x3257c1=_0x29dc37['closest'](_0x4d63a0(0xbd2));if(!_0x3257c1)return;const _0x1fc465=_0x3257c1[_0x4d63a0(0x1ad)]('.at-mention-popup'),_0x24cf76=_0x29dc37[_0x4d63a0(0x518)],_0x443a3a=_0x24cf76['match'](/@([\p{L}\w]*)$/u);if(_0x443a3a){const _0x222d9d=new Set(),_0x53c5ff=_0x3257c1[_0x4d63a0(0x1ad)](_0x4d63a0(0x6bf))?.[_0x4d63a0(0x1090)];if(_0x53c5ff)_0x222d9d[_0x4d63a0(0x3f4)](_0x53c5ff);_0x3257c1[_0x4d63a0(0xa2d)](_0x4d63a0(0x88c))[_0x4d63a0(0x7c0)](_0xb9de83=>{const _0x354d94=_0x4d63a0;_0x222d9d[_0x354d94(0x3f4)](_0xb9de83['textContent']['replace'](':',''));}),_0x222d9d[_0x4d63a0(0x89f)](_0x405767[_0x4d63a0(0x20a)][_0x4d63a0(0xab3)]),_0x1fc465[_0x4d63a0(0xca0)]='';if(_0x222d9d[_0x4d63a0(0xf72)]>0x0){const _0x4b39ea=_0x443a3a[0x1];_0x222d9d['forEach'](_0x366d02=>{const _0x140ed0=_0x4d63a0;if(_0x366d02[_0x140ed0(0xab8)]()['includes'](_0x4b39ea[_0x140ed0(0xab8)]())){const _0x3f805c=document[_0x140ed0(0x8c1)](_0x140ed0(0x1072));_0x3f805c[_0x140ed0(0x84c)]='at-mention-item',_0x3f805c[_0x140ed0(0x1090)]=_0x366d02,_0x3f805c[_0x140ed0(0xae8)](_0x140ed0(0x5d5),_0x5b6c28=>{const _0x275f97=_0x140ed0;_0x5b6c28[_0x275f97(0xd35)]();const _0x22ef11=_0x24cf76[_0x275f97(0x599)](0x0,_0x443a3a[_0x275f97(0x2f2)])+('@'+_0x366d02+'\x20');_0x29dc37['value']=_0x22ef11,_0x1fc465['style'][_0x275f97(0x5e9)]=_0x275f97(0xbf8),_0x29dc37['focus']();}),_0x1fc465[_0x140ed0(0x31e)](_0x3f805c);}}),_0x1fc465[_0x4d63a0(0x842)][_0x4d63a0(0x5e9)]=_0x1fc465[_0x4d63a0(0x9dd)]['length']>0x0?_0x4d63a0(0xea7):'none';}else _0x1fc465[_0x4d63a0(0x842)][_0x4d63a0(0x5e9)]=_0x4d63a0(0xbf8);}else _0x1fc465[_0x4d63a0(0x842)][_0x4d63a0(0x5e9)]=_0x4d63a0(0xbf8);}),document[_0x497273(0x8c2)](_0x497273(0x763))[_0x497273(0xae8)](_0x497273(0x10c8),_0x89e773=>{const _0x52ec19=_0x497273;if(_0x89e773[_0x52ec19(0x475)][_0x52ec19(0x10cd)](_0x52ec19(0xdaf))){const _0x223967=_0x89e773['target'][_0x52ec19(0xa90)]('.qzone-post-container');if(_0x223967){const _0x2ac2e3=_0x223967['querySelector'](_0x52ec19(0xc26));_0x2ac2e3&&setTimeout(()=>{const _0x275d0e=_0x52ec19;_0x2ac2e3['style'][_0x275d0e(0x5e9)]=_0x275d0e(0xbf8);},0xc8);}}});const _0x331e4e=document[_0x497273(0x8c2)](_0x497273(0x332)),_0x1dc6d5=document[_0x497273(0x8c2)](_0x497273(0xed1));_0x331e4e[_0x497273(0xae8)](_0x497273(0x58f),()=>{const _0x359926=_0x497273;if(!_0x405767[_0x359926(0x248)]||!_0x405767['chats'][_0x405767['activeChatId']][_0x359926(0x1000)]){_0x1dc6d5[_0x359926(0x842)][_0x359926(0x5e9)]=_0x359926(0xbf8);return;}const _0x58df14=_0x405767['chats'][_0x405767[_0x359926(0x248)]],_0x1559d9=_0x331e4e['value'],_0x777633=_0x1559d9[_0x359926(0xdf8)](/@([\p{L}\w]*)$/u);if(_0x777633){const _0x22568d=_0x58df14['settings']['myNickname']||'我',_0x22b6c3=_0x58df14['members'][_0x359926(0x6b9)](_0x275544=>_0x275544[_0x359926(0x375)])[_0x359926(0x1d8)](_0x51a99d=>_0x51a99d!==_0x22568d);_0x1dc6d5[_0x359926(0xca0)]='';if(_0x22b6c3[_0x359926(0x105a)]>0x0){const _0x9d9246=_0x777633[0x1];_0x22b6c3[_0x359926(0x7c0)](_0x4f0e55=>{const _0x83ce2b=_0x359926;if(_0x4f0e55['toLowerCase']()[_0x83ce2b(0x773)](_0x9d9246[_0x83ce2b(0xab8)]())){const _0x55b47c=document[_0x83ce2b(0x8c1)](_0x83ce2b(0x1072));_0x55b47c[_0x83ce2b(0x84c)]=_0x83ce2b(0x108e),_0x55b47c[_0x83ce2b(0x1090)]=_0x4f0e55,_0x55b47c['addEventListener'](_0x83ce2b(0x5d5),_0x1ab33e=>{const _0xe311d5=_0x83ce2b;_0x1ab33e[_0xe311d5(0xd35)]();const _0x28fedf=_0x1559d9[_0xe311d5(0x599)](0x0,_0x777633[_0xe311d5(0x2f2)])+('@'+_0x4f0e55+'\x20');_0x331e4e[_0xe311d5(0x518)]=_0x28fedf,_0x1dc6d5[_0xe311d5(0x842)][_0xe311d5(0x5e9)]=_0xe311d5(0xbf8),_0x331e4e[_0xe311d5(0x10f7)]();}),_0x1dc6d5['appendChild'](_0x55b47c);}}),_0x1dc6d5['style']['display']=_0x1dc6d5[_0x359926(0x9dd)]['length']>0x0?_0x359926(0xea7):_0x359926(0xbf8);}else _0x1dc6d5[_0x359926(0x842)][_0x359926(0x5e9)]=_0x359926(0xbf8);}else _0x1dc6d5[_0x359926(0x842)][_0x359926(0x5e9)]=_0x359926(0xbf8);}),_0x331e4e['addEventListener'](_0x497273(0x11f9),()=>{setTimeout(()=>{const _0x5e6117=_0x7a65;_0x1dc6d5['style'][_0x5e6117(0x5e9)]='none';},0xc8);}),document[_0x497273(0x8c2)](_0x497273(0xfd3))[_0x497273(0xae8)]('click',_0x39e4d0),document[_0x497273(0x8c2)]('show-announcement-board-btn')[_0x497273(0xae8)]('click',_0x86a8ba),document[_0x497273(0x8c2)]('close-announcement-board-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x2cc5a5=_0x497273;document[_0x2cc5a5(0x8c2)](_0x2cc5a5(0x5e2))[_0x2cc5a5(0xb17)][_0x2cc5a5(0xaff)](_0x2cc5a5(0x2cd));}),document[_0x497273(0x8c2)]('announcement-board-content')[_0x497273(0xae8)](_0x497273(0xa17),_0x1e63ec=>{const _0x5eaa7e=_0x497273;if(_0x1e63ec[_0x5eaa7e(0x475)][_0x5eaa7e(0xb17)][_0x5eaa7e(0x795)](_0x5eaa7e(0x26a))){const _0x4d493e=_0x1e63ec['target'][_0x5eaa7e(0x323)][_0x5eaa7e(0x7d4)];_0x4d493e&&_0x118a01(_0x4d493e);}}),document[_0x497273(0x8c2)](_0x497273(0x846))[_0x497273(0xae8)](_0x497273(0xa17),_0x2d09f2),document['getElementById'](_0x497273(0x4d4))[_0x497273(0xae8)](_0x497273(0xa17),_0x299efa),document[_0x497273(0x8c2)]('announcement-action-cancel')['addEventListener'](_0x497273(0xa17),()=>{const _0x6a4abe=_0x497273;document[_0x6a4abe(0x8c2)](_0x6a4abe(0xc9e))[_0x6a4abe(0xb17)]['remove'](_0x6a4abe(0x2cd));}),document['getElementById'](_0x497273(0x5b2))[_0x497273(0xae8)]('click',()=>{const _0x5e74cf=_0x497273;document['getElementById']('global-css-input')[_0x5e74cf(0x518)]='';}),document['getElementById'](_0x497273(0xce8))[_0x497273(0xae8)](_0x497273(0xa17),_0x13d5c4),document[_0x497273(0x8c2)](_0x497273(0xa36))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x300d85=_0x497273;_0x3d1990(_0x300d85(0xd5c));}),document[_0x497273(0x8c2)](_0x497273(0xbc5))['addEventListener'](_0x497273(0xa17),_0x19f806),document['getElementById']('summarize-recent-btn-header')[_0x497273(0xae8)](_0x497273(0xa17),_0x5acd3c),document['getElementById'](_0x497273(0x69b))[_0x497273(0xae8)](_0x497273(0xa17),_0x57b232=>{const _0x329c62=_0x497273,_0x29df58=_0x57b232[_0x329c62(0x475)]['closest'](_0x329c62(0x1012));if(_0x29df58){_0x56a457(_0x29df58[_0x329c62(0x323)][_0x329c62(0x802)],parseInt(_0x29df58['dataset']['memoryTimestamp']));return;}const _0xe7526f=_0x57b232[_0x329c62(0x475)]['closest'](_0x329c62(0x114e));if(_0xe7526f){_0x48a1a6(_0xe7526f[_0x329c62(0x323)][_0x329c62(0x802)],parseInt(_0xe7526f[_0x329c62(0x323)]['memoryTimestamp']));return;}}),document[_0x497273(0x8c2)](_0x497273(0x987))[_0x497273(0xae8)](_0x497273(0xa17),_0x235f7d),document['getElementById'](_0x497273(0xf77))[_0x497273(0xae8)](_0x497273(0xa17),_0x4391ab);const _0x282eb4=document['getElementById'](_0x497273(0x54b));_0x282eb4[_0x497273(0xae8)](_0x497273(0x6c1),_0x9bc2f8),_0x282eb4[_0x497273(0xae8)](_0x497273(0xf7f),()=>_0x210865(_0x405767[_0x497273(0x248)])),_0x282eb4['addEventListener'](_0x497273(0xa17),_0x570947),document[_0x497273(0x8c2)]('add-countdown-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0xa82fc1=_0x497273;document[_0xa82fc1(0x8c2)]('countdown-title-input')[_0xa82fc1(0x518)]='',document[_0xa82fc1(0x8c2)](_0xa82fc1(0x863))[_0xa82fc1(0x518)]='',document['getElementById'](_0xa82fc1(0xd40))[_0xa82fc1(0xb17)][_0xa82fc1(0x3f4)](_0xa82fc1(0x2cd));}),document[_0x497273(0x8c2)](_0x497273(0x711))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x51f90a=_0x497273;document[_0x51f90a(0x8c2)](_0x51f90a(0xd40))[_0x51f90a(0xb17)][_0x51f90a(0xaff)](_0x51f90a(0x2cd));}),document['getElementById'](_0x497273(0x473))[_0x497273(0xae8)](_0x497273(0xa17),_0x571fbd),document[_0x497273(0x8c2)]('delete-call-message-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x26f3ad),document[_0x497273(0x8c2)](_0x497273(0xa07))['addEventListener']('click',_0x53ec74),document['getElementById'](_0x497273(0x1048))['addEventListener'](_0x497273(0xa17),_0x3bf696),document[_0x497273(0x8c2)](_0x497273(0x889))['addEventListener'](_0x497273(0xa17),()=>{const _0x3f446d=_0x497273;document[_0x3f446d(0x8c2)]('ai-response-editor-modal')[_0x3f446d(0xb17)]['remove'](_0x3f446d(0x2cd));}),document['getElementById'](_0x497273(0xf9c))['addEventListener']('click',_0x3d359a),document[_0x497273(0x8c2)](_0x497273(0xbec))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x346a89=_0x497273,_0x3d810e=document[_0x346a89(0x8c2)](_0x346a89(0xa61)),_0x284606=_0x17c4cd(_0x346a89(0x49f));_0x3d810e[_0x346a89(0x31e)](_0x284606),_0x284606[_0x346a89(0x1ad)]('textarea')[_0x346a89(0x10f7)]();}),document[_0x497273(0x8c2)](_0x497273(0xadc))[_0x497273(0xae8)](_0x497273(0xa17),_0x700281),document['getElementById'](_0x497273(0x2ba))['addEventListener']('click',_0x4d3455),document[_0x497273(0x8c2)](_0x497273(0xb1c))[_0x497273(0xae8)]('click',_0x1cf9e3),document[_0x497273(0x8c2)](_0x497273(0x1075))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x1334b5=_0x497273;document[_0x1334b5(0x8c2)](_0x1334b5(0x8ac))[_0x1334b5(0xa17)]();}),document[_0x497273(0x8c2)](_0x497273(0x8ac))[_0x497273(0xae8)](_0x497273(0x7a7),_0x4a1c97),document[_0x497273(0x8c2)](_0x497273(0x4f4))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x270f67=_0x497273,_0x40e036='请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg',_0x30fe9c=await _0x180f74('批量导入头像',_0x40e036,'',_0x270f67(0x6c3));_0x30fe9c&&_0x30fe9c['trim']()&&await _0x1cd58d(_0x30fe9c);}),document[_0x497273(0x8c2)](_0x497273(0x1008))['addEventListener'](_0x497273(0xa17),_0x489333),document['getElementById'](_0x497273(0x124e))[_0x497273(0xae8)](_0x497273(0xa17),()=>_0x3d1990('chat-interface-screen')),document[_0x497273(0x8c2)](_0x497273(0x1c9))['addEventListener'](_0x497273(0xa17),_0x33fc26),document[_0x497273(0x8c2)](_0x497273(0x60b))['addEventListener']('click',_0x489333),document[_0x497273(0x8c2)](_0x497273(0xc02))[_0x497273(0xae8)](_0x497273(0xa17),_0x5956a6),document['getElementById']('close-receipt-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x3b98c3=_0x497273;document[_0x3b98c3(0x8c2)](_0x3b98c3(0x47f))[_0x3b98c3(0xb17)][_0x3b98c3(0xaff)](_0x3b98c3(0x2cd));}),document[_0x497273(0x8c2)]('manage-products-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x5bf018=_0x497273;_0x399ecc=!_0x399ecc;const _0x396c5e=document['getElementById'](_0x5bf018(0x4b9)),_0x49f4d2=document[_0x5bf018(0x8c2)]('shopping-action-bar'),_0x59b3ca=document[_0x5bf018(0x8c2)]('product-grid');_0x396c5e[_0x5bf018(0x842)][_0x5bf018(0xac1)]=_0x399ecc?'var(--accent-color)':'var(--text-primary)',_0x399ecc?(_0x49f4d2[_0x5bf018(0x842)][_0x5bf018(0x5e9)]='flex',_0x59b3ca[_0x5bf018(0x842)][_0x5bf018(0x9b5)]=_0x5bf018(0xe4d)):(_0x49f4d2[_0x5bf018(0x842)][_0x5bf018(0x5e9)]='none',_0x59b3ca['style']['paddingBottom']='',_0x45640a['clear'](),document['querySelectorAll'](_0x5bf018(0x1237))['forEach'](_0x5d1020=>_0x5d1020[_0x5bf018(0xb17)][_0x5bf018(0xaff)](_0x5bf018(0x118f))),document[_0x5bf018(0x8c2)]('delete-selected-products-btn')[_0x5bf018(0x1090)]='删除\x20(0)',document[_0x5bf018(0x8c2)](_0x5bf018(0x112d))['checked']=![]),_0x34f254(),_0x19109d();}),document[_0x497273(0x8c2)]('add-new-product-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x3c207e=_0x497273;_0x399ecc?_0x164f71(null):alert(_0x3c207e(0xbb4));}),document[_0x497273(0x8c2)]('product-grid')[_0x497273(0xae8)]('click',async _0xd74855=>{const _0x3c0176=_0x497273,_0x4aa1cf=_0xd74855[_0x3c0176(0x475)]['closest']('.product-item');if(!_0x4aa1cf)return;const _0x4df0da=parseInt(_0x4aa1cf[_0x3c0176(0x323)]['id']);if(isNaN(_0x4df0da))return;if(_0x399ecc){if(_0xd74855[_0x3c0176(0x475)][_0x3c0176(0xb17)][_0x3c0176(0x795)]('edit-product-btn')){_0x164f71(_0x4df0da);return;}if(_0xd74855[_0x3c0176(0x475)][_0x3c0176(0xb17)]['contains']('delete-product-btn')){const _0x4514f9=await _0x15043e['shoppingProducts'][_0x3c0176(0x3e9)](_0x4df0da);if(!_0x4514f9)return;const _0x4528eb=await _0x8b9cb8(_0x3c0176(0x6ed),_0x3c0176(0x93f)+_0x4514f9[_0x3c0176(0x596)]+'”\x20吗？',{'confirmButtonClass':_0x3c0176(0xe2a)});_0x4528eb&&(await _0x15043e[_0x3c0176(0x221)]['delete'](_0x4df0da),await _0x34f254(),alert(_0x3c0176(0x319)));return;}_0x4aa1cf['classList'][_0x3c0176(0xfc3)](_0x3c0176(0x118f));_0x45640a[_0x3c0176(0x11ac)](_0x4df0da)?_0x45640a[_0x3c0176(0x89f)](_0x4df0da):_0x45640a['add'](_0x4df0da);document['getElementById'](_0x3c0176(0x7b8))[_0x3c0176(0x1090)]=_0x3c0176(0xaad)+_0x45640a['size']+')';return;}if(_0xd74855[_0x3c0176(0x475)]['classList']['contains'](_0x3c0176(0xf25))){const _0x25fbed=await _0x15043e[_0x3c0176(0x221)][_0x3c0176(0x3e9)](_0x4df0da);_0x25fbed[_0x3c0176(0x536)]&&_0x25fbed['variations']['length']>0x0?_0x388e3c(_0x4df0da):(await _0xf1dfb0(_0x4df0da),await _0x501c7b('成功',_0x3c0176(0x1244)));return;}_0x4aa1cf[_0x3c0176(0x795)](_0xd74855[_0x3c0176(0x475)])&&console[_0x3c0176(0x32b)](_0x3c0176(0x768)+_0x4df0da);}),document[_0x497273(0x8c2)](_0x497273(0x101e))[_0x497273(0xae8)](_0x497273(0xa17),_0x3fca27=>{const _0x3b230d=_0x497273,_0x2c6f86=_0x3fca27[_0x3b230d(0x475)];_0x2c6f86['classList'][_0x3b230d(0x795)](_0x3b230d(0xc60))&&_0x412727(parseInt(_0x2c6f86[_0x3b230d(0x323)]['id']),-0x1),_0x2c6f86[_0x3b230d(0xb17)]['contains']('increase-qty-btn')&&_0x412727(parseInt(_0x2c6f86['dataset']['id']),0x1),_0x2c6f86[_0x3b230d(0xb17)]['contains'](_0x3b230d(0x749))&&_0x13a07c();}),document[_0x497273(0x8c2)](_0x497273(0x9b7))['addEventListener']('click',async()=>{const _0xbeab87=_0x497273;if(_0x52311a[_0xbeab87(0x105a)]===0x0)return;const _0x222dc4=await _0x8b9cb8(_0xbeab87(0x122c),_0xbeab87(0xf89));_0x222dc4&&(_0x52311a=[],_0x22e6fe(),_0x45cce9());}),document[_0x497273(0x8c2)](_0x497273(0x247))['addEventListener']('change',function(_0x3342aa){const _0x3d0642=_0x497273;document[_0x3d0642(0xa2d)](_0x3d0642(0x858))[_0x3d0642(0x7c0)](_0x3f89f4=>{const _0x1f7a04=_0x3d0642;_0x3f89f4[_0x1f7a04(0x75f)]=_0x3342aa[_0x1f7a04(0x475)][_0x1f7a04(0x75f)];}),_0x13a07c();}),document[_0x497273(0x8c2)]('cancel-product-editor-btn')['addEventListener'](_0x497273(0xa17),()=>{const _0x53a538=_0x497273;document[_0x53a538(0x8c2)](_0x53a538(0x1250))['classList'][_0x53a538(0xaff)](_0x53a538(0x2cd));}),document[_0x497273(0x8c2)](_0x497273(0x6d1))[_0x497273(0xae8)](_0x497273(0xa17),_0x2afd24),document[_0x497273(0x8c2)](_0x497273(0xc08))[_0x497273(0xae8)](_0x497273(0x7a7),_0x4a551e=>{const _0x4e24ac=_0x497273,_0x2c61d5=_0x4a551e[_0x4e24ac(0x475)][_0x4e24ac(0xde8)][0x0];if(_0x2c61d5){const _0x46cafb=new FileReader();_0x46cafb[_0x4e24ac(0xe7a)]=_0x197f31=>{const _0x31dc13=_0x4e24ac;document[_0x31dc13(0x8c2)](_0x31dc13(0xabb))['src']=_0x197f31[_0x31dc13(0x475)][_0x31dc13(0xa92)];},_0x46cafb[_0x4e24ac(0x779)](_0x2c61d5);}}),document[_0x497273(0x8c2)](_0x497273(0xb24))['addEventListener']('click',_0x3517df=>{const _0x121e28=_0x497273,_0x631124=_0x3517df[_0x121e28(0x475)][_0x121e28(0xa90)](_0x121e28(0xfae));if(_0x631124){const _0x455beb=_0x631124[_0x121e28(0xa90)](_0x121e28(0xc46));_0x455beb&&_0x506bc6(parseInt(_0x455beb['dataset'][_0x121e28(0x351)]));}}),document[_0x497273(0x8c2)](_0x497273(0xfcc))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x17495b=_0x497273;document[_0x17495b(0x8c2)]('gift-recipient-modal')['classList'][_0x17495b(0xaff)](_0x17495b(0x2cd));}),document['getElementById'](_0x497273(0x463))['addEventListener'](_0x497273(0xa17),async()=>{const _0x1185aa=_0x497273,_0x598881=Array[_0x1185aa(0x51a)](document[_0x1185aa(0xa2d)](_0x1185aa(0x45c)))[_0x1185aa(0x6b9)](_0x27e031=>_0x27e031[_0x1185aa(0x323)][_0x1185aa(0x69f)]);if(_0x598881[_0x1185aa(0x105a)]===0x0){alert(_0x1185aa(0x1095));return;}const _0xb88321=_0x52311a['filter'](_0x1d38fb=>document['querySelector'](_0x1185aa(0x16f)+_0x1d38fb[_0x1185aa(0xfa9)]+_0x1185aa(0xaaa)));await _0x3b7e38(_0xb88321,_0x598881),document[_0x1185aa(0x8c2)](_0x1185aa(0xa87))['classList']['remove'](_0x1185aa(0x2cd));}),document['getElementById'](_0x497273(0xb84))[_0x497273(0xae8)](_0x497273(0xa17),_0xb7188e=>{const _0x4611c9=_0x497273,_0xe03bde=_0xb7188e[_0x4611c9(0x475)]['closest'](_0x4611c9(0xfbd));_0xe03bde&&_0xe03bde[_0x4611c9(0xb17)][_0x4611c9(0xfc3)](_0x4611c9(0x118f));}),document[_0x497273(0x8c2)]('select-all-recipients')['addEventListener'](_0x497273(0x7a7),function(_0x2a9df7){const _0x112dfa=_0x497273,_0x7a4179=_0x2a9df7[_0x112dfa(0x475)]['checked'];document['querySelectorAll'](_0x112dfa(0x443))['forEach'](_0x4c6c1c=>{const _0x313bce=_0x112dfa;_0x4c6c1c[_0x313bce(0xb17)][_0x313bce(0xfc3)]('selected',_0x7a4179);});}),document[_0x497273(0x8c2)](_0x497273(0xc2b))[_0x497273(0xae8)]('click',_0x2e9449),document[_0x497273(0x8c2)]('regenerate-call-btn')['addEventListener'](_0x497273(0xa17),_0xe41d17),document[_0x497273(0x8c2)](_0x497273(0x77f))[_0x497273(0xae8)](_0x497273(0xa17),_0x356dce),document[_0x497273(0x8c2)](_0x497273(0x39c))[_0x497273(0xae8)]('click',()=>{const _0x2149b3=_0x497273,_0x2a0ad8=document[_0x2149b3(0x8c2)](_0x2149b3(0x295)),_0x416cd5=document['getElementById'](_0x2149b3(0x11da))[_0x2149b3(0x518)][_0x2149b3(0x8c6)]()||_0x93749c;_0x2a0ad8['src']=_0x416cd5,_0x2a0ad8[_0x2149b3(0xf12)]()[_0x2149b3(0x120c)](_0x3aec25=>alert(_0x2149b3(0x592)));}),document[_0x497273(0x8c2)](_0x497273(0xc32))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x3fb063=_0x497273;document['getElementById'](_0x3fb063(0x11da))[_0x3fb063(0x518)]='',alert(_0x3fb063(0xe2b));}),document[_0x497273(0x8c2)](_0x497273(0x835))[_0x497273(0xae8)](_0x497273(0xa17),_0x310a38=>{const _0x52ed41=_0x497273,_0x4c8191=_0x310a38[_0x52ed41(0x475)];_0x4c8191['classList'][_0x52ed41(0x795)](_0x52ed41(0x3db))&&_0x57118b(_0x4c8191),_0x4c8191[_0x52ed41(0xb17)][_0x52ed41(0x795)]('editable-image')&&_0x15b93c(_0x4c8191);}),document[_0x497273(0x8c2)](_0x497273(0x111e))[_0x497273(0xae8)](_0x497273(0xa17),_0x145ea5),document[_0x497273(0x8c2)]('cancel-music-search-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0xbe97d7=_0x497273;document[_0xbe97d7(0x8c2)](_0xbe97d7(0x6a7))[_0xbe97d7(0xb17)]['remove'](_0xbe97d7(0x2cd));}),document[_0x497273(0x8c2)](_0x497273(0x111e))[_0x497273(0xae8)](_0x497273(0xa17),_0x145ea5),document[_0x497273(0x8c2)]('cancel-music-search-btn')[_0x497273(0xae8)]('click',()=>{const _0x193e63=_0x497273;document['getElementById'](_0x193e63(0x6a7))['classList'][_0x193e63(0xaff)]('visible');}),document[_0x497273(0x8c2)]('select-all-music-search')[_0x497273(0xae8)](_0x497273(0x7a7),function(_0x5c2bd7){const _0x203e7e=_0x497273;document[_0x203e7e(0xa2d)](_0x203e7e(0xa09))[_0x203e7e(0x7c0)](_0x3b48f1=>{const _0x37f583=_0x203e7e;_0x3b48f1['checked']=_0x5c2bd7[_0x37f583(0x475)][_0x37f583(0x75f)];});}),document['getElementById'](_0x497273(0x47a))[_0x497273(0xae8)]('click',_0x4cacb5=>{const _0x4ee97d=_0x497273,_0x3d953c=_0x4cacb5[_0x4ee97d(0x475)]['closest']('.search-result-item');if(_0x3d953c){const _0x160d9e=_0x3d953c['querySelector'](_0x4ee97d(0x21b));_0x160d9e&&(_0x4cacb5[_0x4ee97d(0x475)]!==_0x160d9e&&(_0x160d9e[_0x4ee97d(0x75f)]=!_0x160d9e['checked']));}}),document[_0x497273(0x8c2)]('add-selected-music-btn')[_0x497273(0xae8)]('click',async()=>{const _0x14a754=_0x497273,_0x3dfedd=document['querySelectorAll']('.music-search-checkbox:checked');if(_0x3dfedd[_0x14a754(0x105a)]===0x0){alert(_0x14a754(0xf18));return;}document[_0x14a754(0x8c2)](_0x14a754(0x6a7))[_0x14a754(0xb17)][_0x14a754(0xaff)](_0x14a754(0x2cd)),await _0x501c7b(_0x14a754(0x1047),'正在批量添加\x20'+_0x3dfedd['length']+_0x14a754(0xf1a));const _0x318e28=Array['from'](_0x3dfedd)[_0x14a754(0x6b9)](_0x4448c2=>JSON[_0x14a754(0x10ab)](_0x4448c2['closest'](_0x14a754(0xfad))['dataset'][_0x14a754(0x114f)]));let _0xd32b28=0x0,_0x5e10e7=[];const _0x2bcec6=_0x318e28[_0x14a754(0x6b9)](_0x380029=>_0x544e17(_0x380029)),_0x8c4260=await Promise[_0x14a754(0xe88)](_0x2bcec6);_0x8c4260[_0x14a754(0x7c0)]((_0x241b25,_0x4f133b)=>{const _0x11f80a=_0x14a754;_0x241b25?(_0x4a77e1[_0x11f80a(0xcfa)][_0x11f80a(0xa49)](_0x241b25),_0xd32b28++):_0x5e10e7[_0x11f80a(0xa49)](_0x318e28[_0x4f133b][_0x11f80a(0x596)]);});_0xd32b28>0x0&&(await _0x2b48e0(),_0x3439d6(),_0x4a77e1[_0x14a754(0x585)]===-0x1&&(_0x4a77e1[_0x14a754(0x585)]=_0x4a77e1[_0x14a754(0xcfa)][_0x14a754(0x105a)]-_0xd32b28,_0x59d0b7()));let _0x24c07e=_0x14a754(0x65f)+_0xd32b28+'\x20首歌曲。';_0x5e10e7[_0x14a754(0x105a)]>0x0&&(_0x24c07e+='\x0a\x0a'+_0x5e10e7['length']+'\x20首歌曲获取失败:\x0a-\x20'+_0x5e10e7[_0x14a754(0xb2c)](_0x14a754(0x154))),await _0x501c7b(_0x14a754(0xa27),_0x24c07e);}),document[_0x497273(0x8c2)](_0x497273(0x11a5))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x28be9c=_0x497273;document['getElementById'](_0x28be9c(0x11a5))[_0x28be9c(0xb17)][_0x28be9c(0xfc3)](_0x28be9c(0xa2c));}),document[_0x497273(0x8c2)]('add-song-search-btn')['addEventListener'](_0x497273(0xa17),_0x145ea5),document['getElementById'](_0x497273(0xba3))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x169d75=_0x497273;document[_0x169d75(0x8c2)](_0x169d75(0x6a7))[_0x169d75(0xb17)][_0x169d75(0xaff)](_0x169d75(0x2cd));}),document[_0x497273(0x8c2)](_0x497273(0x47a))[_0x497273(0xae8)](_0x497273(0xa17),_0x34b717=>{const _0x12c3ce=_0x497273,_0xb25601=_0x34b717[_0x12c3ce(0x475)][_0x12c3ce(0xa90)](_0x12c3ce(0xfad));if(_0xb25601&&_0xb25601['dataset'][_0x12c3ce(0x114f)]){const _0x243649=JSON[_0x12c3ce(0x10ab)](_0xb25601[_0x12c3ce(0x323)][_0x12c3ce(0x114f)]);handleSearchResultClick(_0x243649);}}),document[_0x497273(0x8c2)]('cleanup-songs-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x16548e),document[_0x497273(0x8c2)](_0x497273(0x4be))['addEventListener'](_0x497273(0xa17),_0x3ce539),document[_0x497273(0x8c2)](_0x497273(0x4af))['addEventListener'](_0x497273(0xa17),_0x1d4815),document[_0x497273(0x8c2)](_0x497273(0x38f))[_0x497273(0xae8)](_0x497273(0xa17),_0x4852f1),document['getElementById']('status-bar-toggle-switch')[_0x497273(0xae8)](_0x497273(0x7a7),()=>{const _0x2f1419=_0x497273;_0x405767[_0x2f1419(0xb73)][_0x2f1419(0x1286)]=document[_0x2f1419(0x8c2)](_0x2f1419(0x2b6))[_0x2f1419(0x75f)],_0x48f995();}),document[_0x497273(0x8c2)]('qzone-more-actions-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x90e4b2),document[_0x497273(0x8c2)]('cancel-clear-posts-btn')[_0x497273(0xae8)]('click',()=>{const _0x511ee3=_0x497273;document[_0x511ee3(0x8c2)](_0x511ee3(0x1283))['classList'][_0x511ee3(0xaff)](_0x511ee3(0x2cd));}),document[_0x497273(0x8c2)]('confirm-clear-posts-btn')['addEventListener']('click',_0x1d907c),document[_0x497273(0x8c2)](_0x497273(0x114b))[_0x497273(0xae8)]('click',_0x1b6cf4=>{const _0x189fe5=_0x497273,_0x463274=_0x1b6cf4['target'][_0x189fe5(0xa90)](_0x189fe5(0x85e));_0x463274&&_0x463274[_0x189fe5(0xb17)][_0x189fe5(0xfc3)]('selected');}),document[_0x497273(0x8c2)]('global-bg-input')['addEventListener'](_0x497273(0x7a7),async _0x322e6e=>{const _0x43947d=_0x497273,_0x1c0795=_0x322e6e['target']['files'][0x0];if(_0x1c0795){const _0x3b9040=await new Promise(_0x435b77=>{const _0x1ec243=_0x7a65,_0x102947=new FileReader();_0x102947[_0x1ec243(0xe7a)]=()=>_0x435b77(_0x102947[_0x1ec243(0xa92)]),_0x102947[_0x1ec243(0x779)](_0x1c0795);});_0x405767['globalSettings'][_0x43947d(0xdea)]=_0x3b9040,_0x519e14();}_0x322e6e[_0x43947d(0x475)][_0x43947d(0x518)]=null;}),document[_0x497273(0x8c2)](_0x497273(0xf85))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x2e63cf=_0x497273;_0x405767[_0x2e63cf(0xb73)][_0x2e63cf(0xdea)]='',_0x519e14();}),document[_0x497273(0x8c2)](_0x497273(0x813))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x207248=_0x497273;_0xca7708&&(_0x405767['globalSettings'][_0x207248(0xc3a)]=_0xca7708),_0x405767[_0x207248(0xb73)][_0x207248(0x653)]=document[_0x207248(0x8c2)](_0x207248(0x681))[_0x207248(0x518)]['trim'](),_0x405767['globalSettings'][_0x207248(0x595)]=document[_0x207248(0x8c2)](_0x207248(0x11da))['value'][_0x207248(0x8c6)](),_0x405767[_0x207248(0xb73)][_0x207248(0x1286)]=document[_0x207248(0x8c2)]('status-bar-toggle-switch')[_0x207248(0x75f)],await _0x15043e[_0x207248(0xb73)][_0x207248(0xfaa)](_0x405767[_0x207248(0xb73)]),_0x1017e4(),_0xca7708=null,_0x1ff3cc(),_0x3b4393(_0x405767['globalSettings'][_0x207248(0x653)]),_0x48f995(),alert(_0x207248(0x797)),_0x3d1990('home-screen');}),document['getElementById'](_0x497273(0x398))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x158932=_0x497273,_0x24d79d=await _0x180f74(_0x158932(0x151),_0x158932(0x46a),'','url');if(_0x24d79d&&_0x24d79d[_0x158932(0x8c6)]())_0x405767[_0x158932(0xb73)]['globalChatBackground']=_0x24d79d[_0x158932(0x8c6)](),_0x519e14();else _0x24d79d!==null&&alert(_0x158932(0xc10));}),document[_0x497273(0x8c2)]('upload-ephone-bg-url-btn')[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x7e80cf=_0x497273,_0x329195=await _0x180f74(_0x7e80cf(0xb00),_0x7e80cf(0xf76),'','url');if(_0x329195&&_0x329195['trim']())_0xca7708=_0x329195[_0x7e80cf(0x8c6)](),_0x519e14();else _0x329195!==null&&alert(_0x7e80cf(0xc10));}),document[_0x497273(0x8c2)]('upload-cphone-bg-url-btn')[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x133273=_0x497273,_0x56c7b3=await _0x180f74(_0x133273(0xab2),_0x133273(0xfb4),'',_0x133273(0x9d6));if(_0x56c7b3&&_0x56c7b3['trim']())_0x405767['globalSettings'][_0x133273(0x64a)]=_0x56c7b3[_0x133273(0x8c6)](),_0x519e14();else _0x56c7b3!==null&&alert('请输入有效的URL。');}),document['getElementById'](_0x497273(0x4e2))[_0x497273(0xae8)]('click',()=>{const _0x4b7cf6=_0x497273;_0xca7708=null,_0x405767[_0x4b7cf6(0xb73)][_0x4b7cf6(0xc3a)]='',_0x519e14();}),document[_0x497273(0x8c2)]('remove-cphone-bg-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x2eb349=_0x497273;_0x405767[_0x2eb349(0xb73)][_0x2eb349(0x64a)]='',_0x519e14();}),document[_0x497273(0x8c2)]('css-preset-select')[_0x497273(0xae8)](_0x497273(0x7a7),_0x4dcfbf),document['getElementById'](_0x497273(0x118b))[_0x497273(0xae8)](_0x497273(0xa17),_0x55768d),document[_0x497273(0x8c2)](_0x497273(0x253))['addEventListener'](_0x497273(0xa17),_0x519a83),document['getElementById']('font-preset-select')[_0x497273(0xae8)](_0x497273(0x7a7),_0xe1591),document[_0x497273(0x8c2)](_0x497273(0x4ea))[_0x497273(0xae8)](_0x497273(0xa17),_0x302322),document['getElementById']('delete-font-preset-btn')['addEventListener'](_0x497273(0xa17),_0x4b58e8),document['getElementById'](_0x497273(0x209))[_0x497273(0xae8)](_0x497273(0x7a7),_0x557845),document['getElementById'](_0x497273(0x77d))[_0x497273(0xae8)](_0x497273(0xa17),_0x263cc1),document[_0x497273(0x8c2)]('delete-theme-preset-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x5ed40c),document[_0x497273(0x8c2)](_0x497273(0x2b9))['addEventListener'](_0x497273(0xa17),_0x9c45d0),document[_0x497273(0x8c2)](_0x497273(0x118a))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x374970=_0x497273;document[_0x374970(0x8c2)](_0x374970(0x450))[_0x374970(0xb17)][_0x374970(0xaff)]('visible'),_0x1def9c();}),document['getElementById'](_0x497273(0xe8c))[_0x497273(0xae8)]('click',_0x8487bc),document[_0x497273(0x8c2)]('existing-sticker-categories-list')[_0x497273(0xae8)]('click',_0x3c0c2d=>{const _0x49b020=_0x497273;if(_0x3c0c2d['target'][_0x49b020(0xb17)]['contains'](_0x49b020(0x741))){const _0x55577d=parseInt(_0x3c0c2d['target'][_0x49b020(0x323)]['id']);_0x353cd2(_0x55577d);}}),document[_0x497273(0x8c2)](_0x497273(0x8a8))[_0x497273(0xae8)](_0x497273(0xa17),_0x275b49=>{const _0x375436=_0x497273;if(_0x275b49[_0x375436(0x475)][_0x375436(0xb17)][_0x375436(0x795)](_0x375436(0x5e3))){const _0x9013a7=_0x275b49[_0x375436(0x475)][_0x375436(0x323)][_0x375436(0x792)],_0x263cd7=_0x9013a7!=='all'&&_0x9013a7!==_0x375436(0x606)?parseInt(_0x9013a7):_0x9013a7;_0xcca698(_0x263cd7);}}),document[_0x497273(0x8c2)]('select-all-stickers-checkbox')[_0x497273(0xae8)](_0x497273(0x7a7),_0x446bf2),document[_0x497273(0x8c2)](_0x497273(0x1260))[_0x497273(0xae8)]('click',_0x3a8637),document[_0x497273(0x8c2)](_0x497273(0x2e0))[_0x497273(0xae8)]('click',()=>{const _0x223797=_0x497273;document[_0x223797(0x8c2)](_0x223797(0xaa5))[_0x223797(0xa17)]();}),document[_0x497273(0x8c2)](_0x497273(0xaa5))['addEventListener']('change',_0x3404cf=>{const _0x5d4b12=_0x497273,_0xafadd=_0x3404cf[_0x5d4b12(0x475)][_0x5d4b12(0xde8)][0x0];_0xafadd&&_0x182a59(_0xafadd),_0x3404cf[_0x5d4b12(0x475)][_0x5d4b12(0x518)]=null;}),document[_0x497273(0x8c2)](_0x497273(0xa06))[_0x497273(0xae8)](_0x497273(0xa17),()=>_0x290e38()),document[_0x497273(0x8c2)]('add-char-diary-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>openDiaryEditor()),document['getElementById'](_0x497273(0xd11))['addEventListener'](_0x497273(0xa17),_0x466abc),document[_0x497273(0x8c2)](_0x497273(0x1084))[_0x497273(0xae8)]('click',_0x55f2d2),document[_0x497273(0x8c2)](_0x497273(0x6b5))[_0x497273(0xae8)](_0x497273(0xa17),_0x5558d0),document[_0x497273(0x8c2)](_0x497273(0xe05))[_0x497273(0xae8)]('click',async()=>{const _0x1b2606=_0x497273;_0x501c7b(_0x1b2606(0xd38),'正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...');try{await Promise[_0x1b2606(0xe88)]([_0x63671b(),_0x365b33()]),console[_0x1b2606(0x32b)]('CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。');}catch(_0x5c7fb6){console[_0x1b2606(0x7a3)](_0x1b2606(0x5ba),_0x5c7fb6),await _0x501c7b('操作失败',_0x1b2606(0x946)+_0x5c7fb6[_0x1b2606(0xc7d)]);}}),document[_0x497273(0x8c2)](_0x497273(0xcf6))['addEventListener'](_0x497273(0xa17),_0x570cd1=>{const _0x422508=_0x497273,_0x4a0c6c=_0x570cd1['target'][_0x422508(0xa90)](_0x422508(0x51b));if(_0x4a0c6c&&_0x4a0c6c[_0x422508(0x323)]['conversationIndex']){const _0x372c79=parseInt(_0x4a0c6c['dataset']['conversationIndex']);!isNaN(_0x372c79)&&_0x14c4a9(_0x372c79);}}),document[_0x497273(0x8c2)](_0x497273(0x112c))['addEventListener'](_0x497273(0xa17),()=>{const _0x478a1e=_0x497273;_0x5c2ffa(_0x478a1e(0x1004));});const _0x21d9f3=document['getElementById'](_0x497273(0xcac)),_0x19c8d9=()=>{const _0x410905=_0x497273;if(_0x14e3cf!==_0x410905(0x8cb))return;if(_0x21d9f3[_0x410905(0xfd0)]<0x1&&!_0x451dc7){const _0x5860cb=_0x405767['chats'][_0x1f6e46]?.[_0x410905(0xd39)]['length']||0x0;_0x5860cb>_0x2564c3&&_0x1ecca3();}};_0x21d9f3[_0x497273(0xae8)]('scroll',_0x19c8d9),document[_0x497273(0x8c2)](_0x497273(0xbd7))['addEventListener'](_0x497273(0xa17),()=>{const _0x755bba=_0x497273;alert(_0x755bba(0x10a4));}),document[_0x497273(0x8c2)]('regenerate-char-album-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x525d8a),document[_0x497273(0x8c2)](_0x497273(0x904))[_0x497273(0xae8)](_0x497273(0xa17),_0x30bb62=>{const _0x2c1aec=_0x497273,_0x58fcd6=_0x30bb62['target'][_0x2c1aec(0xa90)](_0x2c1aec(0x36c));if(_0x58fcd6&&_0x58fcd6['dataset'][_0x2c1aec(0x3ca)]){const _0x523fb3=_0x58fcd6[_0x2c1aec(0x323)][_0x2c1aec(0x3ca)];_0x501c7b(_0x2c1aec(0x88e),_0x523fb3[_0x2c1aec(0x1b7)](/\n/g,_0x2c1aec(0x854)));}}),document['getElementById'](_0x497273(0xb67))['addEventListener']('click',_0x2cdbc3),document[_0x497273(0x8c2)](_0x497273(0x6e0))[_0x497273(0xae8)](_0x497273(0xa17),_0x424678),document[_0x497273(0x8c2)]('char-product-grid')[_0x497273(0xae8)](_0x497273(0xa17),_0x469204=>{const _0x44d319=_0x497273,_0x53127b=_0x469204['target'][_0x44d319(0xa90)](_0x44d319(0x120e));if(_0x53127b&&_0x53127b[_0x44d319(0x323)][_0x44d319(0x29f)]){const _0x6ef593=_0x53127b[_0x44d319(0x323)][_0x44d319(0x29f)];_0x501c7b(_0x44d319(0xa42),_0x6ef593[_0x44d319(0x1b7)](/\n/g,_0x44d319(0x854)));}}),window[_0x497273(0xeec)]=_0x275dcf,document[_0x497273(0x8c2)]('regenerate-char-memo-btn')[_0x497273(0xae8)]('click',_0x1f5fcb),document[_0x497273(0x8c2)](_0x497273(0x17a))[_0x497273(0xae8)](_0x497273(0xa17),()=>_0x5c2ffa(_0x497273(0x1b0))),document[_0x497273(0x8c2)](_0x497273(0x13f))[_0x497273(0xae8)](_0x497273(0xa17),_0x397e25),document[_0x497273(0x8c2)](_0x497273(0x92e))['addEventListener']('click',_0x5aa085),document[_0x497273(0x8c2)]('char-diary-detail-back-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>_0x5c2ffa(_0x497273(0xedf))),document['getElementById'](_0x497273(0xc4d))['addEventListener'](_0x497273(0xa17),_0x550389),document[_0x497273(0x8c2)](_0x497273(0x11b5))[_0x497273(0xae8)](_0x497273(0xa17),_0x598644),document[_0x497273(0x8c2)]('regenerate-char-music-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x486f02),document[_0x497273(0x8c2)](_0x497273(0xb21))[_0x497273(0xae8)](_0x497273(0xa17),_0x5e38d4),document[_0x497273(0x8c2)](_0x497273(0xf38))[_0x497273(0xae8)](_0x497273(0xa17),_0x53a131),document['getElementById'](_0x497273(0xf38))[_0x497273(0xae8)](_0x497273(0xa17),_0x53a131),document[_0x497273(0x8c2)](_0x497273(0x60f))[_0x497273(0xae8)](_0x497273(0xa17),()=>_0x3d1990(_0x497273(0xecd))),document[_0x497273(0x8c2)](_0x497273(0x373))[_0x497273(0xae8)](_0x497273(0xa17),_0x442a66),document[_0x497273(0x8c2)](_0x497273(0xcdd))['addEventListener'](_0x497273(0xa17),_0x5ac4ce),document[_0x497273(0x8c2)](_0x497273(0x41e))['addEventListener']('change',async _0x11b7c9=>{const _0x168b8c=_0x497273,_0x38a249=_0x11b7c9[_0x168b8c(0x475)][_0x168b8c(0xde8)][0x0];if(_0x38a249){const _0x1e597e=await new Promise(_0x2d17e9=>{const _0x4a1b4f=_0x168b8c,_0x54ddd3=new FileReader();_0x54ddd3[_0x4a1b4f(0xe7a)]=()=>_0x2d17e9(_0x54ddd3['result']),_0x54ddd3[_0x4a1b4f(0x779)](_0x38a249);});_0x405767[_0x168b8c(0xb73)]['cphoneWallpaper']=_0x1e597e,_0x519e14();}}),document['getElementById']('cphone-icon-settings-grid')[_0x497273(0xae8)](_0x497273(0xa17),_0x1714e6=>{const _0x1e8a88=_0x497273;if(_0x1714e6[_0x1e8a88(0x475)]['classList'][_0x1e8a88(0x795)](_0x1e8a88(0xb16))){const _0x3ad6da=_0x1714e6[_0x1e8a88(0x475)]['closest']('.icon-setting-item'),_0x27d2e4=_0x3ad6da['dataset'][_0x1e8a88(0xc9b)];_0x27d2e4&&_0x119b2c(_0x27d2e4,_0x1e8a88(0x1094),_0x3ad6da);}}),document['getElementById'](_0x497273(0xdeb))['addEventListener'](_0x497273(0xa17),()=>{document['getElementById']('import-appearance-input')['click']();}),document[_0x497273(0x8c2)](_0x497273(0x9ab))['addEventListener']('change',_0x113dd4=>{const _0x4a20cf=_0x497273,_0x427a6b=_0x113dd4['target'][_0x4a20cf(0xde8)][0x0];_0x427a6b&&_0x28773c(_0x427a6b),_0x113dd4['target'][_0x4a20cf(0x518)]=null;}),document['addEventListener'](_0x497273(0x1a3),()=>{const _0x3bc792=_0x497273;document[_0x3bc792(0x789)]===_0x3bc792(0xbe3)&&(localStorage[_0x3bc792(0x277)]('ephoneLastActiveTimestamp',Date[_0x3bc792(0x1ed)]()),console['log']('应用已切换到后台，记录当前时间。'));}),document[_0x497273(0x8c2)]('export-world-book-btn')['addEventListener'](_0x497273(0xa17),_0x24f906),document[_0x497273(0x8c2)]('import-world-book-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x326b1b=_0x497273;document[_0x326b1b(0x8c2)](_0x326b1b(0x246))['click']();}),document[_0x497273(0x8c2)]('import-world-book-input')[_0x497273(0xae8)](_0x497273(0x7a7),_0x434b00=>{const _0x59fce0=_0x497273,_0x1fec51=_0x434b00['target']['files'][0x0];_0x1fec51&&_0x4a6b03(_0x1fec51),_0x434b00[_0x59fce0(0x475)][_0x59fce0(0x518)]=null;}),document[_0x497273(0x8c2)](_0x497273(0xded))[_0x497273(0xae8)](_0x497273(0x7a7),async _0xd8e224=>{const _0x4a79b3=_0x497273,_0x266a34=_0xd8e224[_0x4a79b3(0x475)][_0x4a79b3(0x75f)];_0x405767[_0x4a79b3(0xb73)][_0x4a79b3(0xd00)]=_0x266a34,await _0x15043e[_0x4a79b3(0xb73)][_0x4a79b3(0xfaa)](_0x405767[_0x4a79b3(0xb73)]);const _0x49016b=document[_0x4a79b3(0x1ad)](_0x4a79b3(0xc72));if(_0x49016b)switch(_0x49016b['id']){case _0x4a79b3(0xd5c):_0x7dbe71(_0x405767[_0x4a79b3(0x248)]);break;case _0x4a79b3(0x3b7):if(document['getElementById']('qzone-screen')[_0x4a79b3(0xb17)][_0x4a79b3(0x795)](_0x4a79b3(0x71b)))_0xa34c48();if(document['getElementById']('favorites-view')[_0x4a79b3(0xb17)][_0x4a79b3(0x795)](_0x4a79b3(0x71b)))_0x436ace();break;case _0x4a79b3(0xecd):_0x420532();break;case'douban-post-detail-screen':_0x4d304b(_0x32ff0a);break;case'character-phone-screen':const _0x57c739=document[_0x4a79b3(0x1ad)](_0x4a79b3(0x108a));if(_0x57c739)switch(_0x57c739['id']){case'char-album-screen':_0x5d895e();break;case'char-taobao-screen':_0x16090f();break;case _0x4a79b3(0x728):const _0x13fa74=_0x405767['chats'][_0x1f6e46],_0x15cca8=_0x13fa74['simulatedBrowserHistory']||[],_0x4a9e8f=_0x15cca8[_0x4a79b3(0x105a)]>0x0?_0x15cca8[_0x4a79b3(0x105a)]-0x1:0x0;_0x4087bf(_0x15cca8[_0x4a9e8f]);break;case _0x4a79b3(0x113b):_0x5434d9();break;case'char-qq-screen':_0x1ee832();break;case _0x4a79b3(0xafa):const _0x3b7138=document['querySelector']('#char-chat-list\x20.chat-list-item')?.[_0x4a79b3(0x323)][_0x4a79b3(0xd08)]||0x0;_0x14c4a9(parseInt(_0x3b7138));break;}break;}_0x501c7b(_0x4a79b3(0x3b2),_0x4a79b3(0x1038)+(_0x266a34?'开启':'关闭')+'。');}),document[_0x497273(0x8c2)](_0x497273(0xee8))[_0x497273(0xae8)](_0x497273(0xa17),_0x240acd),document[_0x497273(0x8c2)](_0x497273(0x1224))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x2e02bc=_0x497273;_0x3d1990(_0x2e02bc(0xdca));}),document[_0x497273(0x8c2)]('execute-search-btn')['addEventListener'](_0x497273(0xa17),_0x204a43),document[_0x497273(0x8c2)]('clear-search-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x2bff97),document['getElementById'](_0x497273(0x81e))[_0x497273(0xae8)](_0x497273(0xa17),_0x56ebd7),document[_0x497273(0x8c2)](_0x497273(0xd53))[_0x497273(0xae8)](_0x497273(0xa17),_0x2e498a),document[_0x497273(0x1ad)](_0x497273(0x569))[_0x497273(0xae8)](_0x497273(0xa17),_0x1cca07=>{const _0x594c5f=_0x497273;if(_0x1cca07[_0x594c5f(0x475)][_0x594c5f(0xb17)]['contains'](_0x594c5f(0x517))){const _0x5c8e8c=parseInt(_0x1cca07[_0x594c5f(0x475)][_0x594c5f(0x323)]['id']);!isNaN(_0x5c8e8c)&&_0x4e5646(_0x5c8e8c);}}),_0x271118(),window[_0x497273(0x8f6)]=_0x59f21b,document['getElementById'](_0x497273(0x490))[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x3be6b8=_0x497273,_0x593be1=await _0x180f74(_0x3be6b8(0x9bf),_0x3be6b8(0x542));if(_0x593be1&&_0x593be1[_0x3be6b8(0x8c6)]()){const _0x3ec803={'id':_0x3be6b8(0x877)+Date[_0x3be6b8(0x1ed)](),'name':_0x593be1[_0x3be6b8(0x8c6)](),'content':[]};await _0x15043e[_0x3be6b8(0xeb2)][_0x3be6b8(0x3f4)](_0x3ec803),await _0x26ef07(),_0x3a691e(_0x3ec803['id']);}}),document[_0x497273(0x8c2)](_0x497273(0x489))['addEventListener'](_0x497273(0xa17),_0x32c9c8),document['getElementById']('add-preset-entry-btn')['addEventListener'](_0x497273(0xa17),()=>{const _0x1bd471=_0x497273,_0xe17667=document[_0x1bd471(0x8c2)]('preset-entries-container');_0xe17667[_0x1bd471(0x1ad)]('p')&&(_0xe17667[_0x1bd471(0xca0)]='');const _0x3f84c0=_0x4cea7f();_0xe17667[_0x1bd471(0x31e)](_0x3f84c0),_0x3f84c0[_0x1bd471(0x1ad)](_0x1bd471(0xbe5))[_0x1bd471(0x10f7)]();}),document[_0x497273(0x8c2)](_0x497273(0x124b))[_0x497273(0xae8)]('click',async()=>{const _0x1edced=_0x497273;if(!_0x81ab90)return;const _0x189da4=await _0x15043e[_0x1edced(0xeb2)][_0x1edced(0x3e9)](_0x81ab90);if(!_0x189da4)return;const _0xe37efd=document['getElementById']('preset-name-input')['value'][_0x1edced(0x8c6)]();if(!_0xe37efd){alert(_0x1edced(0x9f2));return;}_0x189da4[_0x1edced(0x596)]=_0xe37efd,_0x189da4[_0x1edced(0x792)]=parseInt(document[_0x1edced(0x8c2)](_0x1edced(0x4d3))['value'])||null;const _0x2f76fe=document[_0x1edced(0x8c2)]('preset-entries-container'),_0x4ffb7f=_0x2f76fe[_0x1edced(0xa2d)](_0x1edced(0x104b)),_0x1a82a0=[];_0x4ffb7f['forEach'](_0x1ec20f=>{const _0x5e6940=_0x1edced,_0x2aa56f=_0x1ec20f[_0x5e6940(0x1ad)]('.entry-content-textarea')[_0x5e6940(0x518)][_0x5e6940(0x8c6)]();_0x2aa56f&&_0x1a82a0[_0x5e6940(0xa49)]({'comment':_0x1ec20f[_0x5e6940(0x1ad)](_0x5e6940(0x5b4))[_0x5e6940(0x518)]['trim'](),'keys':(_0x1ec20f[_0x5e6940(0x1ad)](_0x5e6940(0x104f))[_0x5e6940(0x518)][_0x5e6940(0x8c6)]()||'')['split'](',')[_0x5e6940(0x6b9)](_0x2f25f=>_0x2f25f[_0x5e6940(0x8c6)]())[_0x5e6940(0x1d8)](Boolean),'content':_0x2aa56f,'enabled':_0x1ec20f[_0x5e6940(0x1ad)](_0x5e6940(0x182))[_0x5e6940(0x75f)]});}),_0x189da4[_0x1edced(0x168)]=_0x1a82a0,await _0x15043e[_0x1edced(0xeb2)]['put'](_0x189da4),_0x81ab90=null,_0x3d1990(_0x1edced(0x457)),await _0x26ef07();}),document['getElementById'](_0x497273(0x901))['addEventListener'](_0x497273(0xa17),()=>{const _0x45f81a=_0x497273;document[_0x45f81a(0x8c2)](_0x45f81a(0x79f))['click']();}),document['getElementById']('import-preset-input')['addEventListener'](_0x497273(0x7a7),_0x560b7b),document[_0x497273(0x8c2)](_0x497273(0x31b))[_0x497273(0xae8)](_0x497273(0xa17),_0x4db8ae),document[_0x497273(0x8c2)](_0x497273(0x762))[_0x497273(0xae8)]('click',_0x5bf9b4),document['getElementById'](_0x497273(0x4f2))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x4ed095=_0x497273;document[_0x4ed095(0x8c2)](_0x4ed095(0x3fd))[_0x4ed095(0xb17)][_0x4ed095(0xaff)](_0x4ed095(0x2cd));}),document['getElementById']('go-to-clear-step2-btn')[_0x497273(0xae8)]('click',_0x48c312),document[_0x497273(0x8c2)]('back-to-clear-step1-btn')['addEventListener']('click',_0x5d0c1b),document['getElementById']('cancel-clear-wizard-btn-step2')['addEventListener']('click',()=>{const _0x3bda4b=_0x497273;document[_0x3bda4b(0x8c2)](_0x3bda4b(0x3fd))[_0x3bda4b(0xb17)][_0x3bda4b(0xaff)](_0x3bda4b(0x2cd));}),document[_0x497273(0x8c2)](_0x497273(0xa32))[_0x497273(0xae8)](_0x497273(0xa17),_0x36de15),document['getElementById'](_0x497273(0x3fd))[_0x497273(0xae8)](_0x497273(0xa17),_0xfa4f0a=>{const _0x113e5c=_0x497273,_0xab0ee7=_0xfa4f0a[_0x113e5c(0x475)][_0x113e5c(0xa90)]('.clear-posts-item');_0xab0ee7&&(_0xfa4f0a[_0x113e5c(0x601)](),_0xab0ee7[_0x113e5c(0xb17)]['toggle'](_0x113e5c(0x118f)));}),document['getElementById']('data-clear-wizard-modal')[_0x497273(0xae8)]('change',_0x176267=>{const _0xe142db=_0x497273;if(_0x176267['target']['id']==='select-all-chars-for-clear'){const _0x598790=_0x176267['target'][_0xe142db(0x75f)];document[_0xe142db(0xa2d)](_0xe142db(0xc1d))[_0xe142db(0x7c0)](_0x2ee9c2=>{const _0x191279=_0xe142db;_0x2ee9c2[_0x191279(0xb17)][_0x191279(0xfc3)](_0x191279(0x118f),_0x598790);});}else{if(_0x176267[_0xe142db(0x475)]['id']===_0xe142db(0xea9)){const _0x315c75=_0x176267[_0xe142db(0x475)][_0xe142db(0x75f)];document[_0xe142db(0xa2d)](_0xe142db(0x409))[_0xe142db(0x7c0)](_0x5cd1ad=>{const _0x33d532=_0xe142db;_0x5cd1ad[_0x33d532(0xb17)][_0x33d532(0xfc3)]('selected',_0x315c75);});}}}),document[_0x497273(0x8c2)](_0x497273(0x798))['addEventListener'](_0x497273(0xa17),_0x25e890),document[_0x497273(0x8c2)](_0x497273(0x6ca))[_0x497273(0xae8)](_0x497273(0xa17),_0x43542b),document[_0x497273(0x8c2)](_0x497273(0xd9c))['addEventListener'](_0x497273(0xa17),_0x389346),document[_0x497273(0x8c2)](_0x497273(0x849))[_0x497273(0xae8)](_0x497273(0xa17),()=>{_0x3d8143('messages-view');}),document[_0x497273(0x8c2)]('add-npc-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>_0x2a7a98(null)),document[_0x497273(0x8c2)](_0x497273(0x122a))[_0x497273(0xae8)]('click',_0x4031f2),document[_0x497273(0x8c2)](_0x497273(0xd85))['addEventListener'](_0x497273(0xa17),()=>{const _0x2a8245=_0x497273;document['getElementById'](_0x2a8245(0x123e))['classList'][_0x2a8245(0xaff)](_0x2a8245(0x2cd));}),document['getElementById'](_0x497273(0x1cc))[_0x497273(0xae8)](_0x497273(0x7a7),_0x1240dc=>{const _0x20fa1f=_0x497273,_0x27ab54=_0x1240dc[_0x20fa1f(0x475)][_0x20fa1f(0xde8)][0x0];if(_0x27ab54){const _0x118432=new FileReader();_0x118432['onload']=_0x1820b=>{const _0x42ebfb=_0x20fa1f;document[_0x42ebfb(0x8c2)]('npc-avatar-preview')[_0x42ebfb(0x939)]=_0x1820b['target'][_0x42ebfb(0xa92)];},_0x118432['readAsDataURL'](_0x27ab54);}}),document['getElementById']('chat-lock-overlay')[_0x497273(0xae8)](_0x497273(0xa17),_0x2fca92=>{const _0x18d228=_0x497273;if(_0x2fca92[_0x18d228(0x475)]['id']===_0x18d228(0x1110))_0x2d9a2f();else _0x2fca92[_0x18d228(0x475)]['id']===_0x18d228(0x103b)&&_0x3bf696();}),_0x5dcbd7(document[_0x497273(0x8c2)](_0x497273(0x11a5)),()=>{const _0x2dbe75=_0x497273;_0x4a77e1['currentIndex']>-0x1&&_0x52f1d7(_0x4a77e1[_0x2dbe75(0x585)]);}),document[_0x497273(0x8c2)](_0x497273(0x24e))[_0x497273(0xae8)](_0x497273(0xa17),_0x1f7c9f),document[_0x497273(0x8c2)](_0x497273(0x9ce))[_0x497273(0xae8)](_0x497273(0xa17),_0x4ff99b),document['getElementById'](_0x497273(0xe41))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x4f2013=_0x497273;document['getElementById'](_0x4f2013(0x115f))['classList'][_0x4f2013(0xaff)]('visible');}),document['getElementById'](_0x497273(0xf51))['addEventListener'](_0x497273(0x58f),_0x3c7139=>{const _0x1bf7e6=_0x497273,_0x4bfa7c=_0x3c7139[_0x1bf7e6(0x475)]['value']['toLowerCase'](),_0x52698f=document[_0x1bf7e6(0x8c2)]('time-zone-select');for(const _0x45a7fd of _0x52698f[_0x1bf7e6(0x320)]){const _0x49a165=_0x45a7fd[_0x1bf7e6(0x1090)][_0x1bf7e6(0xab8)]();_0x49a165['includes'](_0x4bfa7c)?_0x45a7fd[_0x1bf7e6(0x842)]['display']='':_0x45a7fd[_0x1bf7e6(0x842)][_0x1bf7e6(0x5e9)]=_0x1bf7e6(0xbf8);}}),window[_0x497273(0xdd3)]=_0x7f1d62,document[_0x497273(0x8c2)](_0x497273(0x1298))[_0x497273(0xae8)]('click',()=>_0x7f1d62('group')),document[_0x497273(0x8c2)](_0x497273(0xaee))['addEventListener'](_0x497273(0xa17),()=>{const _0x3eee53=_0x497273;document[_0x3eee53(0x8c2)]('werewolf-lobby-modal')[_0x3eee53(0xb17)][_0x3eee53(0xaff)](_0x3eee53(0x2cd));}),document[_0x497273(0x8c2)]('start-werewolf-game-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x49da84),document[_0x497273(0x8c2)]('werewolf-role-confirm-btn')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x3a2892=_0x497273;document[_0x3a2892(0x8c2)]('werewolf-role-modal')[_0x3a2892(0xb17)][_0x3a2892(0xaff)]('visible'),_0x99a3d1();}),document[_0x497273(0x8c2)]('exit-werewolf-game-btn')[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0xc156b=_0x497273,_0xba8c51=await _0x8b9cb8('退出游戏','确定要退出当前这局狼人杀吗？游戏进度将不会被保存。',{'confirmButtonClass':_0xc156b(0xe2a)});_0xba8c51&&(_0x54c7b5[_0xc156b(0x6f0)]=![],_0x3d1990(_0x54c7b5[_0xc156b(0xb3d)]?'chat-interface-screen':_0xc156b(0x835)));}),document[_0x497273(0x8c2)](_0x497273(0x7f3))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x72f91d=_0x497273;document[_0x72f91d(0x8c2)](_0x72f91d(0xfe3))[_0x72f91d(0xb17)][_0x72f91d(0xaff)]('visible'),_0x3d1990(_0x54c7b5['chatId']?_0x72f91d(0x3b7):_0x72f91d(0x835));}),document[_0x497273(0x8c2)](_0x497273(0x144))[_0x497273(0xae8)]('click',()=>{const _0x55b74e=_0x497273;document[_0x55b74e(0x8c2)](_0x55b74e(0xd89))['classList'][_0x55b74e(0xaff)](_0x55b74e(0x2cd));}),document[_0x497273(0x8c2)](_0x497273(0xaee))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x4d1b0f=_0x497273;document[_0x4d1b0f(0x8c2)]('werewolf-lobby-modal')[_0x4d1b0f(0xb17)][_0x4d1b0f(0xaff)]('visible');}),document[_0x497273(0x8c2)](_0x497273(0xa64))['addEventListener']('click',_0x5c035d),document['getElementById'](_0x497273(0xbf3))[_0x497273(0xae8)]('click',_0x9c04b8),document[_0x497273(0x8c2)](_0x497273(0x4ba))[_0x497273(0xae8)](_0x497273(0xa17),_0x16a788),document[_0x497273(0x8c2)](_0x497273(0xe33))['addEventListener']('click',_0x32ef94),document[_0x497273(0x8c2)](_0x497273(0xdbd))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x31cdf9=_0x497273;document[_0x31cdf9(0x8c2)](_0x31cdf9(0x5a1))['classList'][_0x31cdf9(0xaff)](_0x31cdf9(0x2cd));}),document['getElementById'](_0x497273(0x6ea))['addEventListener'](_0x497273(0xa17),_0x2da18b),document[_0x497273(0x8c2)](_0x497273(0x5a1))['addEventListener'](_0x497273(0xa17),_0x586a48=>{const _0x36e9d7=_0x497273,_0x4838d1=_0x586a48[_0x36e9d7(0x475)][_0x36e9d7(0xa90)](_0x36e9d7(0x85e));_0x4838d1&&_0x4838d1['classList']['toggle'](_0x36e9d7(0x118f));if(_0x586a48[_0x36e9d7(0x475)]['id']===_0x36e9d7(0xfd7)){const _0x551a8f=_0x586a48['target'][_0x36e9d7(0x75f)];document[_0x36e9d7(0xa2d)](_0x36e9d7(0x5cc))['forEach'](_0x52def6=>{const _0x3fa48f=_0x36e9d7;_0x52def6[_0x3fa48f(0xb17)][_0x3fa48f(0xfc3)]('selected',_0x551a8f);});}}),document['getElementById'](_0x497273(0xc93))[_0x497273(0xae8)](_0x497273(0x58f),()=>{_0x1def9c(![]);}),document[_0x497273(0x8c2)](_0x497273(0x8a8))['addEventListener'](_0x497273(0xa17),_0x42f6e0=>{const _0xf4e6b5=_0x497273;if(_0x42f6e0['target']['classList']['contains'](_0xf4e6b5(0x5e3))){const _0x8a3654=_0x42f6e0['target']['dataset'][_0xf4e6b5(0x792)],_0x126606=_0x8a3654!==_0xf4e6b5(0xe88)&&_0x8a3654!=='uncategorized'?parseInt(_0x8a3654):_0x8a3654;document['getElementById'](_0xf4e6b5(0xc93))[_0xf4e6b5(0x518)]='',_0xcca698(_0x126606);}});const _0x1a2c4f=document['getElementById']('chat-messages');_0x1a2c4f[_0x497273(0xae8)]('scroll',()=>{const _0x2735b5=_0x497273;if(_0x1a2c4f['scrollTop']<0x1&&!_0x2a9ed2){const _0x3a3f9a=_0x405767[_0x2735b5(0x799)][_0x405767[_0x2735b5(0x248)]]?.['history'][_0x2735b5(0x105a)]||0x0;_0x3a3f9a>_0x5ea6d4&&_0x18e095();}});const _0xa0635=document[_0x497273(0x8c2)](_0x497273(0x125d));_0xa0635[_0x497273(0xae8)](_0x497273(0xa93),()=>{const _0x466648=_0x497273,{scrollTop:_0x6526dd,scrollHeight:_0x50c9c4,clientHeight:_0x4adfbc}=_0xa0635;if(_0x50c9c4-_0x6526dd<=_0x4adfbc+0x32&&!_0xfd5f49){const _0x1643b0=_0x405767[_0x466648(0x799)][_0x405767[_0x466648(0x248)]]?.['thoughtsHistory'][_0x466648(0x105a)]||0x0;_0x1643b0>_0x4099a9&&_0x1dd5af();}});const _0x57c4dd=document[_0x497273(0x1ad)]('#qzone-screen\x20.qzone-content');_0x57c4dd[_0x497273(0xae8)](_0x497273(0xa93),()=>{const {scrollTop:_0x4d520c,scrollHeight:_0x2e8489,clientHeight:_0x193257}=_0x57c4dd;_0x2e8489-_0x4d520c<=_0x193257+0x64&&!_0x5a2592&&(_0x3c4d9a['length']>_0x37c049&&_0x411133());}),document[_0x497273(0x8c2)](_0x497273(0x11ae))[_0x497273(0xae8)](_0x497273(0xa17),_0x59e7df);const _0x3fb239=document[_0x497273(0x8c2)](_0x497273(0x853));_0x347e60(_0x3fb239,_0x3fb239),document['getElementById'](_0x497273(0x1010))[_0x497273(0xae8)]('click',_0x4c7464),document[_0x497273(0x8c2)](_0x497273(0xb41))['addEventListener'](_0x497273(0xa17),_0x3d1071),document[_0x497273(0x8c2)](_0x497273(0x8b0))[_0x497273(0xae8)](_0x497273(0xa17),_0x3be27b),document[_0x497273(0x8c2)](_0x497273(0x3d2))[_0x497273(0xae8)](_0x497273(0xa17),_0x1d6129),document[_0x497273(0x8c2)](_0x497273(0x1241))[_0x497273(0xae8)](_0x497273(0x7a7),_0x2cfe24),document[_0x497273(0x8c2)]('minimize-reading-btn')[_0x497273(0xae8)]('click',_0x5b6ea2),document[_0x497273(0x8c2)](_0x497273(0x853))['addEventListener'](_0x497273(0xa17),_0x346c57),_0x347e60(document['getElementById']('reading-window'),document[_0x497273(0x1ad)](_0x497273(0xa33))),document['getElementById']('open-reading-library-btn')[_0x497273(0xae8)]('click',_0x3d1071),document[_0x497273(0x8c2)](_0x497273(0x10c4))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x4245cd=_0x497273;document[_0x4245cd(0x8c2)](_0x4245cd(0x353))[_0x4245cd(0xb17)][_0x4245cd(0xaff)](_0x4245cd(0x2cd));}),document[_0x497273(0x8c2)](_0x497273(0x8b2))['addEventListener'](_0x497273(0xa17),_0x128525),document[_0x497273(0x8c2)]('reading-library-list')[_0x497273(0xae8)](_0x497273(0xa17),_0xdadcd7=>{const _0x442172=_0x497273,_0x2b05b1=_0xdadcd7['target'];if(_0x2b05b1[_0x442172(0xb17)][_0x442172(0x795)](_0x442172(0x7de))){const _0x567d24=parseInt(_0x2b05b1[_0x442172(0x323)][_0x442172(0x3da)]);_0x5e36c3(_0x567d24);}else{if(_0x2b05b1[_0x442172(0xb17)][_0x442172(0x795)](_0x442172(0x741))){const _0x16dc8f=parseInt(_0x2b05b1[_0x442172(0x323)][_0x442172(0x3da)]);_0x1300f9(_0x16dc8f);}}}),document[_0x497273(0x8c2)](_0x497273(0x4fb))[_0x497273(0xae8)](_0x497273(0xa17),_0x36c87a),document[_0x497273(0x8c2)]('reading-library-search-input')[_0x497273(0xae8)](_0x497273(0x58f),_0x1c60c7=>{const _0x2cb9f2=_0x497273;_0x3d60c6(_0x1c60c7[_0x2cb9f2(0x475)]['value']);});const _0x17b51d=_0xdc25ea(_0x12e8f6,0x12c);document[_0x497273(0x8c2)]('reading-content')[_0x497273(0xae8)]('scroll',_0x17b51d),document[_0x497273(0x8c2)](_0x497273(0x50f))[_0x497273(0xae8)](_0x497273(0x58f),_0x588015=>{const _0x56cca3=_0x497273;document[_0x56cca3(0x8c2)](_0x56cca3(0xc57))[_0x56cca3(0x1090)]=_0x588015[_0x56cca3(0x475)][_0x56cca3(0x518)];});const _0xf021f7=document['getElementById']('messages-view');_0xf021f7['addEventListener'](_0x497273(0xa93),()=>{const {scrollTop:_0x44d197,scrollHeight:_0x542603,clientHeight:_0x1a93d3}=_0xf021f7;_0x542603-_0x44d197<=_0x1a93d3+0x96&&!_0x5314bd&&_0x330f15();}),document[_0x497273(0x8c2)](_0x497273(0x6a2))[_0x497273(0xae8)]('click',_0x2bd311),document[_0x497273(0x8c2)](_0x497273(0xffd))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x575d4d=_0x497273;document[_0x575d4d(0x8c2)]('product-category-manager-modal')['classList']['remove'](_0x575d4d(0x2cd)),_0x164f71(_0x1036b6);}),document[_0x497273(0x8c2)](_0x497273(0xe98))[_0x497273(0xae8)]('click',_0x1e4653),document['getElementById'](_0x497273(0x1212))[_0x497273(0xae8)](_0x497273(0xa17),_0xff9b3f=>{const _0x59f6af=_0x497273;_0xff9b3f['target'][_0x59f6af(0xb17)][_0x59f6af(0x795)](_0x59f6af(0x741))&&_0x495bdf(parseInt(_0xff9b3f[_0x59f6af(0x475)][_0x59f6af(0x323)]['id']));}),document['getElementById'](_0x497273(0xa3b))[_0x497273(0xae8)](_0x497273(0xa17),()=>_0x334fe3()),document[_0x497273(0x8c2)](_0x497273(0xfe6))[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x3e9237=_0x497273;document[_0x3e9237(0x8c2)]('variation-selection-modal')['classList']['remove'](_0x3e9237(0x2cd));}),document[_0x497273(0x8c2)]('variation-decrease-qty')[_0x497273(0xae8)](_0x497273(0xa17),()=>{const _0x3b8622=_0x497273,_0x40cfa9=document['getElementById'](_0x3b8622(0x7ae));let _0x5df177=parseInt(_0x40cfa9['textContent']);if(_0x5df177>0x1)_0x40cfa9[_0x3b8622(0x1090)]=_0x5df177-0x1;}),document[_0x497273(0x8c2)](_0x497273(0xbcf))[_0x497273(0xae8)]('click',()=>{const _0xf00e35=_0x497273,_0x5df242=document[_0xf00e35(0x8c2)](_0xf00e35(0x7ae));_0x5df242[_0xf00e35(0x1090)]=parseInt(_0x5df242[_0xf00e35(0x1090)])+0x1;}),document[_0x497273(0x8c2)](_0x497273(0xa96))[_0x497273(0xae8)](_0x497273(0xa17),_0x5acea7=>{const _0x5af0e2=_0x497273;if(_0x5acea7[_0x5af0e2(0x475)][_0x5af0e2(0xb17)]['contains'](_0x5af0e2(0x3a2))){const _0x1ac374=_0x5acea7[_0x5af0e2(0x475)][_0x5af0e2(0x323)]['categoryId']==='all'?_0x5af0e2(0xe88):parseInt(_0x5acea7[_0x5af0e2(0x475)][_0x5af0e2(0x323)][_0x5af0e2(0x792)]);_0x5deee6(_0x1ac374);}}),document['getElementById'](_0x497273(0x11c3))[_0x497273(0xae8)](_0x497273(0xa17),_0x497508),document[_0x497273(0x8c2)]('shopping-settings-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x269782),document['getElementById'](_0x497273(0x287))['addEventListener'](_0x497273(0xa17),_0x31c2a5),document[_0x497273(0x8c2)](_0x497273(0xd25))['addEventListener'](_0x497273(0xa17),()=>{const _0xb141b4=_0x497273;document['getElementById']('shopping-settings-modal')['classList'][_0xb141b4(0xaff)](_0xb141b4(0x2cd));}),document['getElementById']('select-all-products-checkbox')[_0x497273(0xae8)]('change',_0x580f2f=>{const _0x21bfea=_0x497273,_0x41b5ba=_0x580f2f[_0x21bfea(0x475)][_0x21bfea(0x75f)],_0x5eae6a=document[_0x21bfea(0xa2d)](_0x21bfea(0x22a));_0x5eae6a[_0x21bfea(0x7c0)](_0x5a417d=>{const _0x29d0f=_0x21bfea,_0x21270a=parseInt(_0x5a417d[_0x29d0f(0x323)]['id']);_0x5a417d[_0x29d0f(0xb17)]['toggle']('selected',_0x41b5ba),_0x41b5ba?_0x45640a['add'](_0x21270a):_0x45640a[_0x29d0f(0x89f)](_0x21270a);}),document[_0x21bfea(0x8c2)](_0x21bfea(0x7b8))[_0x21bfea(0x1090)]=_0x21bfea(0xaad)+_0x45640a[_0x21bfea(0xf72)]+')';}),document[_0x497273(0x8c2)]('delete-selected-products-btn')[_0x497273(0xae8)](_0x497273(0xa17),async()=>{const _0x4ce701=_0x497273;if(_0x45640a[_0x4ce701(0xf72)]===0x0){alert(_0x4ce701(0xd90));return;}const _0x3f4947=await _0x8b9cb8(_0x4ce701(0xad9),_0x4ce701(0x1080)+_0x45640a[_0x4ce701(0xf72)]+'\x20个商品吗？此操作不可恢复。',{'confirmButtonClass':_0x4ce701(0xe2a)});_0x3f4947&&(await _0x15043e[_0x4ce701(0x221)][_0x4ce701(0x101d)]([..._0x45640a]),document[_0x4ce701(0x8c2)](_0x4ce701(0x4b9))[_0x4ce701(0xa17)](),await _0x34f254(),await _0x501c7b('成功','选中的商品已成功删除。'));}),document[_0x497273(0x8c2)]('appearance-preset-select')[_0x497273(0xae8)]('change',_0x1c4776),document[_0x497273(0x8c2)]('save-appearance-preset-btn')[_0x497273(0xae8)](_0x497273(0xa17),_0x1e9d04),document[_0x497273(0x8c2)](_0x497273(0x445))[_0x497273(0xae8)](_0x497273(0xa17),_0x500d16),document[_0x497273(0x8c2)](_0x497273(0x9fe))[_0x497273(0xae8)](_0x497273(0xa17),_0x115ab1),document[_0x497273(0x8c2)]('select-all-frames-checkbox')[_0x497273(0xae8)](_0x497273(0x7a7),_0x5d1592),document[_0x497273(0x8c2)](_0x497273(0x103a))[_0x497273(0xae8)](_0x497273(0xa17),_0x323c26),document[_0x497273(0x8c2)](_0x497273(0x1129))[_0x497273(0xae8)]('click',_0x371c37),document[_0x497273(0x8c2)](_0x497273(0x8bd))['addEventListener']('click',()=>{const _0x4f9a0d=_0x497273;_0x5c2ffa(_0x4f9a0d(0x185));}),_0x1a66b3(),_0x3d1990('home-screen');}_0x1ccff2();});
