const _0x3449ff=_0x3569;(function(_0x17178d,_0x3fff34){const _0x3ca6cb=_0x3569,_0xda23b7=_0x17178d();while(!![]){try{const _0x5ad991=parseInt(_0x3ca6cb(0xcf5))/0x1+parseInt(_0x3ca6cb(0x12cc))/0x2*(parseInt(_0x3ca6cb(0x30c))/0x3)+-parseInt(_0x3ca6cb(0x11a6))/0x4*(-parseInt(_0x3ca6cb(0x125a))/0x5)+-parseInt(_0x3ca6cb(0xffe))/0x6+-parseInt(_0x3ca6cb(0x129b))/0x7+parseInt(_0x3ca6cb(0x2ca))/0x8*(parseInt(_0x3ca6cb(0xa44))/0x9)+-parseInt(_0x3ca6cb(0x5b6))/0xa;if(_0x5ad991===_0x3fff34)break;else _0xda23b7['push'](_0xda23b7['shift']());}catch(_0x3498ef){_0xda23b7['push'](_0xda23b7['shift']());}}}(_0x1f49,0x5bc41));'serviceWorker'in navigator&&window[_0x3449ff(0xa0f)](_0x3449ff(0xf91),()=>{const _0x24b3f8=_0x3449ff;navigator[_0x24b3f8(0xc42)]['register']('./sw.js')[_0x24b3f8(0xcd7)](_0x3890b7=>{const _0x59ddba=_0x24b3f8;console['log'](_0x59ddba(0x613),_0x3890b7[_0x59ddba(0x1394)]);})['catch'](_0x20040d=>{const _0x5cf0b3=_0x24b3f8;console[_0x5cf0b3(0x283)]('ServiceWorker\x20注册失败:\x20',_0x20040d);});});!Array[_0x3449ff(0x1d1)][_0x3449ff(0x318)]&&Object[_0x3449ff(0x1296)](Array[_0x3449ff(0x1d1)],_0x3449ff(0x318),{'value':function(_0x56922e){const _0x5ecd37=_0x3449ff;if(this==null)throw new TypeError(_0x5ecd37(0x27c));if(typeof _0x56922e!==_0x5ecd37(0x968))throw new TypeError(_0x5ecd37(0x11e2));let _0x370670=Object(this),_0x2110c1=_0x370670[_0x5ecd37(0xa06)]>>>0x0,_0xa3249d=arguments[0x1],_0x3c90cd=_0x2110c1-0x1;while(_0x3c90cd>=0x0){let _0x116bfb=_0x370670[_0x3c90cd];if(_0x56922e[_0x5ecd37(0x121e)](_0xa3249d,_0x116bfb,_0x3c90cd,_0x370670))return _0x3c90cd;_0x3c90cd--;}return-0x1;},'configurable':!![],'writable':!![]});let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],currentQzoneReplyContext=null,editingNpcId=null;function _0x3569(_0x28c22c,_0x5b2c38){const _0x1f499b=_0x1f49();return _0x3569=function(_0x3569d6,_0x200b81){_0x3569d6=_0x3569d6-0x181;let _0x1d082c=_0x1f499b[_0x3569d6];return _0x1d082c;},_0x3569(_0x28c22c,_0x5b2c38);}const GEMINI_API_URL=_0x3449ff(0xbfb);function _0x1f49(){const _0x23cea8=['assign-group-select','lastFailedAction','https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','targetDate','<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22','狼人杀\x20-\x20','文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。','旧版备份数据写入数据库失败:\x20','files','”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]','music-current-time','<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22','lyric','global_css','load-more-btn','uc_preset','call','main','”的网上冲浪足迹...','error','&id,\x20url,\x20name,\x20categoryId','stickerCategoryId','ZIP文件中未找到图片','请先填写对应的反代地址和密钥','AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。','naiimag','search-history-back-btn','++id,\x20name,\x20description','temp_group_chat','还没有任何评论，无法等待回复。','speech','npc-association-list','appearance-preset-select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</memory>\x0a\x20\x20<recent_dialogue_with_user>','entries','猎人带走了\x20','请输入歌手名','对方已拒收','switchToCharHomeScreen','delete-css-preset-btn','for_timestamp','shuoshuo','innerText','isSpectatorGroup','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。','save-product-btn','最近\x20100\x20条','正在请求AI为新头像命名...','✅\x20清理完成！\x0a\x0a',';\x20font-style:\x20italic;\x22>','导出单个聊天时出错:','https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','<div\x20class=\x22rp-claimed-info\x22>已被\x20','移出成员','已返回我的手机','命名表情','分钟前','\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。','mousedown','确定要永久删除选中的\x20','[系统提示：用户（','结束投票','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。','✅\x20NAI提示词：使用系统配置','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**',';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“','my-group-nickname-group','wallpaper','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','global-custom-style','call_summary','https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','\x20首歌曲...','151540qSOiSr','你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','++id,\x20name,\x20type','目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20','width','确定要删除这条评论吗？','已成功将\x20','new_name','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22','批量导入头像','-\x20(暂无)','https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','world-book-entries-container','管理预设分类','revokeObjectURL','天\x20-\x20投票','transfer-confirm-btn','传统导出数据时出错:','请输入精炼后核心记忆的大致字数：','请为这个新头像命名','isMinimized','album','AI\x20(CPhone)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','applicationReason','utf-8','.name','npc-avatar-input','remove-bg-btn','\x22><div\x20class=\x22title\x22>','-modal','photo-viewer-close-btn','#\x20场景设定\x0a','presetId','已成功注入“切换到线上模式”的系统指令。','</span></div></div>','parentNode','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>','通话记录已成功总结并存入角色“','panelEl','api-preset-select','\x20//\x20<--\x20【核心】注入世界书\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','gomoku-overlay','werewolf-witch-selection-list','https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','nai-diffusion-4-5-full','home-screen-pages','label[for=\x22','cancel-shopping-settings-btn','data:\x20[DONE]','[图片动态]','postType','karras','decode','\x0a\x0a#\x20你的角色设定\x0a','getItem','heartfeltVoice','删除分组后，该组内的好友将变为“未分组”。确定要删除吗？','sticker-category-tab','isAlive','请根据以上情景，生成新的评论。','defineProperty','AI\x20\x22','\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是','[系统消息]\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','2146452ftShnL','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','手动注入记忆时出错:\x20','activeAlbumId','#chat-list-bottom-nav\x20.nav-item','regex','\x20为\x20','thoughts','export-single-chat-btn','扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20','share_link','nai-custom-proxy-url','save-character-nai-prompts-btn','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','置顶公告','https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','input[name=\x22theme-select\x22]:checked','<img\x20src=\x22','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>','https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','characterPositivePrompt',')，接收人是“','var(--text-primary)','variation-select','\x20条记忆精炼为\x201\x20条核心记忆！','预言家已行动，预言家请闭眼。','消息内容已复制到剪贴板。','left','世界书','isClosed','加载更早的会话','werewolf-kill-modal','data-clear-type-list','btn-danger','close-reading-library-btn-header','\x0a-\x20','arc','无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20','reduce','match','https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','https://i.postimg.cc/xjpN4swz/IMG-7240.gif','var(--accent-color)','</em>','announcement-board-modal','</span>','openNpcEditor','douban-post-detail-title','无缓存，正在请求\x20Minimax\x20TTS\x20API...','641348EtFvCw','lastGuardedId','https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','https://api.vkeys.cn/v2/music/netease?id=','\x0a-\x20**长期记忆**:\x20','选择记忆所属角色','内容因安全策略被屏蔽\x20(原因:\x20','confirm-wolf-kill-btn','waimai_request','https://image.pollinations.ai/prompt/','抱歉，未能找到相关歌曲。','ai-response-editor-block','[V]','type','公告已发布！','preset-editor-screen','.text','♪\x20♪\x20♪','rgba(0,\x200,\x200,\x200.4)','聊天记录已成功覆盖！正在刷新界面...','translateY(0px)','本日核心议题',')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','-\x20**对话状态**:\x20(暂无有效对话历史)','\x22\x20class=\x22avatar-frame\x22></div></div>','simulatedAmapHistory','请输入新的图片URL：','TTS\x20音频已保存到缓存。','search-history-btn','https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','长截图生成失败:','variation-selected-price','authorOriginalName','\x20\x20\x20characterNegativePrompt:','.quoted-message','option','AI返回的讨论内容格式不正确。原始返回:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20','[系统提示：你\x20','<input\x20type=\x22checkbox\x22\x20value=\x22','question','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“','静音音频已启动，用于后台活动保活。','https://api.vkeys.cn/v2/music/tencent/lyric?id=','）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a','对方已收款','AI决策','showRedPacketDetails收到了无效的packet对象','[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>','未发现需要迁移的旧红包数据。','records','usage-item','create-countdown-modal','nai-smea-dyn','请输入对方现在的新状态：','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。','删除世界书失败:','内容为空。',')\x20拒绝了\x20','stream','导演/编辑模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','douban-max-posts-input','棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a','#f9f9f9','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','final','clipboard','poison','购物车(','(无标题投票)','https://i.postimg.cc/28TsrxRV/IMG-6852.gif','\x20的礼物','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','请为这个头像起个名字（例如：春日野餐、学习时间）','add-world-book-btn','manage-world-book-categories-btn','（无有效对话记录）','\x20发送了一张图片，内容是：\x27','#linked-chats-checkboxes-container\x20input:checked','.custom-multiselect\x20.select-box','#data-clear-char-list\x20.clear-posts-item','内容因安全策略被屏蔽。触发类别:\x20','保存成功','删除照片','api-temperature-value','SAFETY','无效链接:\x20','\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','maxMemory','流式导出过程中出错:','收到了格式不规范的AI指令（缺少type和content），已跳过:','点击了商品卡片:\x20','专辑封面已更新！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22','add-existing-contact-btn','8px','custom-css-input','覆盖预设','\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a','draggable','apply','discussionLog','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请输入预设名称','获取AI投票决策失败:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥','要为《','change_group_name','\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','”\x20将对你的称呼修改为\x20“','[语音]','您正和「','stickerCategories','送给了\x20','正在批量添加\x20','https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','导演模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','共享位置','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>','renderingRules','werewolf-role-confirm-btn','[系统提示：用户(','用户向你发送了一张图片','friend_request_response','[表情:\x20\x27','至少需要保留一条消息。','无人投票','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','werewolf-witch-modal','票):\x20','post-public-text','has-frame','post-local-image-input','请输入提示词！','正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。','.sticker-item[data-sticker-id=\x22','当前通知版本\x20(','toLocaleString','apply-friend-btn','已拒收对方转账','导入成功','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','include','删除记录','douban-cast-select-btn','writeText','voiceId','确认清空动态？','\x22\x20value=\x22','天亮了。','worldBooks','思考中...','translateX(-','char_memo','link-memory-toggle','.chat-group-content:last-of-type','.entry-comment-input','rule-card\x20','确定要删除这个约定吗？','anyOf','transfer-note','❌\x20动态NAI图片生成失败:','.cart-item-checkbox','clearRect','logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27','🎬\x20推进剧情','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20',')\x20成功抢到了\x20',':</span>\x20','confirm-variation-selection-btn','memories','\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20','未知NPC','block-cooldown-input','</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>','globalSettings','var-','\x20的动态\x20(用户)','stickerMeaning','description','<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>','.comment-delete-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','动态已更新！','<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>','offsetWidth','<div\x20class=\x22pinned-indicator\x22>📌</div>','is_busy','\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','werewolf-','cancel-clear-wizard-btn-step2','scope','message-bubble\x20system-bubble','smooth','请AI角色们继续进行讨论。','https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','用户已忽略版本:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','regenerate-char-taobao-btn','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','.gift-card','https://i.postimg.cc/kGgwJhPH/IMG-4374.gif','participant-avatars-grid','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>','timerId','已成功加载外观预设：“','代付请求已被拒绝','update','from','输入图片URL','”吗？','pat_message','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','quote-message-btn','album-screen','请输入有效的URL。','https://i.postimg.cc/XNkQTHvf/IMG-5561.gif','\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','”。请你回顾一下刚才和“','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','\x20条内容吗？','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','NPC人设','豆瓣小组','isGameOver','my-group-nickname-input','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','\x22\x20(群名)\x20的消息。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a','minimax-api-key','”\x20的位置已发送到你们的聊天中。','#post-public-text','”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《','time','limit','wallpaper-upload-input','\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“','status-bar-toggle-switch','blockedTimestamp',';\x22>','label','custom','.unread-indicator.back-btn-indicator','#\x20对话示例\x0a','已加载预设\x20“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/zvWGPjms/IMG-7090.gif','poisonUsed','hidden','setAttribute','猎人死亡，请选择一名玩家带走！','batch-import-frames-btn','精炼长期记忆时出错:','https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','”下，回复了\x27','.rules-tab','user-speak-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>','char-vinyl-container','导入外观设置时出错:','请输入一个有效的数字（建议大于20）。','\x22\x20被唤醒，准备独立行动...','\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。','\x20发布了一条新动态]','target_timestamp','AbortError','状态已更新','nai-resolution','album-art-btn','在这里输入回复内容','import-world-book-input','送给\x20','parentElement','group-avatar-preview','》:\x0a','一条[转账]消息已被撤回。','ai-frame-tab','未知歌手','确定要永久删除这条通话记录吗？此操作不可恢复。','select-all-cart-items','tEXt','天，救人概率为\x20','-\x20清理了\x20','#gift-recipient-list\x20.contact-picker-item','call-transcript-modal','识图优化：正在将时间戳为\x20','\x22]\x20.participant-avatar','外观设置','请输入\x20歌名\x20或\x20歌名-歌手','已死亡','本地群头像上传及识别失败:','加载失败','assistant','\x20本世界书已成功删除。','transfer-modal','.poll-card','unblock-btn','API未配置，无法进行总结。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>','用户\x20(','waimai_order','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20','无法找到对应的分享记录或记录已损坏。','-\x20你的解药状态：','meaning','#ccc','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/13hhJ77p/IMG-4419.gif','keyword-search-input','图片解压失败:\x20','，用户刚刚在\x20','add-song-search-btn','preset-persona-input','**:\x20','\x20条)','fullPrompt','cancel-member-settings-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>','delete-world-books-list','safetyRatings','toggle','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','结束发言','time-zone-search-input','unshift','playlist-body','font-size-value','cancel-product-editor-btn','margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','在这里输入说说的内容...','<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>','#text-image-mode-content','设置精炼字数','已取消收藏','prototype','locationName','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','is-location-share','.participant-avatar-wrapper[data-participant-id=\x22','（可选）输入后缀','相册\x20\x22','删除商品','对方消息预览','正在导入表:\x20','找不到原始消息。可能已被删除或位于更早的历史记录中。','-\x20(记录于\x20','music-next-btn','custom-prompt-input','close-reading-btn','comments','AI\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','导出世界书时出错:','[系统提示：用户手动结束了投票！最终结果为：','scrollHeight','increase-qty-btn','usageTimeMinutes','douban-send-comment-btn','blur','char-browser-article-screen','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>','waimai-timer-','checked','》的歌词已成功保存！','show-avatars-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','\x20元。]','ceil','werewolf-player-avatar','confirm-clear-posts-btn','手慢了','isClick','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22><strong>\x20','https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','novelai-switch','paused','https://i.postimg.cc/Y9d3BztC/1.png','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','reset-theme-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>','\x22\x20class=\x22avatar\x22>','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“','https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','编辑商品','https://api.vkeys.cn/v2/music/netease?word=','AI生图功能已','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','add-song-url-btn','AI\x20尝试使用一个不存在的群头像:\x20\x22','*你按下了接听键...*','stopPropagation','日\x20---','https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','---\x20第\x20','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>','https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','rule-regex-input','\x20\x0a-\x20**你最近和“','amount','礼物已成功送出！','cancel-variation-selection-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','处理NPC后台活动时出错:','#e7f3ff','manage-preset-categories-btn','rp-details-item','memory-card','https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','找不到匹配的表情','char-amap-list','在这里输入文本...','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”请求添加你为好友：<br><i>“','female-shaonv-jingpin','clientX','is-voice-message','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥','\x20发送了一个【专属红包】(时间戳:\x20','audio-player','.lyric-line','isRefund','enableBackgroundActivity','import-card-input','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22','add-selected-music-btn','originalType','[data-version]','variations','select-all-world-books-for-clear','找不到这个预设的详细信息。','-\x20你的毒药状态：','update_thoughts','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','songs','rp-content-group','stickerCategoryIds','角色\x20\x22','Autoplay\x20was\x20prevented\x20by\x20the\x20browser.','删除歌曲','blocked_by_ai','\x20-\x20','waimai-product-info','\x20觉得很赞</span></div>','char-music-artist','call-message-actions-modal','https://i.postimg.cc/bJDMQVkj/IMG-7112.gif','》\x20-\x20','无结果','**内容:**\x0a','uncategorized','sticker-binding-chat-list','++id,\x20timestamp,\x20authorId','\x22)。操作已被程序阻止。','#outgoing-call-screen\x20.caller-text','min','操作失败','max','\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a','检测到\x20SSE\x20流式响应，开始解析...','\x0a#\x20当前五子棋局势\x0a','并评论说：“','粘贴歌词','请修改记忆要点：','nai-custom-proxy-group','bulkDelete','未知发送者','投票结果','LOW','确定要删除分类《','无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20','change','”的购物习惯...','utf-16le','📊\x20使用模型:','getMonth','昨晚\x20','确定要删除这个人设预设吗？此操作不可恢复。','char-diary-detail-screen','https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','”发送的、尚未领完的红包（时间戳:\x20','anonymous','reading-library-modal','cancel-douban-cast-btn','char-photo-description','participant-avatar-wrapper','pending_ai_approval','order','char-amap-item',':generateContent?key=','\x22\x20评论了动态\x20#','</div></div>','selection-soft-delete-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>','编辑消息','这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？','好的，我明白了。我会严格遵守以上所有规则和设定。','\x22）。你已经有一段时间没有和用户（','\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥','promptSource','Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined','frame_tech','add-char-memo-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>正在计算可压缩图片大小...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>--\x20MB</span>\x0a\x20\x20\x20\x20','busy','shoppingProducts','loadedmetadata','log','openRenderingRulesScreen','跳过一个无法解析为JSON的编辑块:','\x20将群名修改为\x20“','product-price-input','\x20点赞了动态]','simulatedConversations','createElement','call-timer','char-product-item','<span\x20style=\x22color:\x20red;\x22>已关闭</span>','group_call_request','write','请输入一个有效的URL或选择一个文件！','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','dark-mode','\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','https://i.postimg.cc/B6KD52vz/IMG-7096.gif','aiAvatarLibrary','<div\x20class=\x22source\x22>','world-book-category-pane','regenerate-char-amap-btn',')**:\x20','AI女巫决定使用毒药，目标是:\x20','的状态已更新为:\x20','myNickname','selection-erase-btn','无法自动播放静音音频（这在iOS首次加载时是正常现象）:','preset-category-select','\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20','.incoming-call-content\x20.caller-text','myAvatarFrame','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“','》设定:\x0a','\x20\x20-\x20在群聊“','\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','”的特点生成专属商品...','prepend','删除预设','preset-avatar-preview','><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>','ai-frame-grid','你正在阅读的段落','char-memo-screen','Content-Type:','https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','高德地图','decline-call-btn','ai-avatar-input','删除\x20(0)','exit-werewolf-game-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>','diary','shared-history-viewer-modal','https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','\x22\x20class=\x22participant-avatar\x22\x20title=\x22','尝试打开一个不存在的世界书，ID:','<div\x20class=\x22poll-options-list\x22>','keys','message-bubble\x20recalled-message-placeholder','activePostId','\x0a#\x20可用表情包\x0a\x20\x20\x20\x20','new-group-name-input','你让大家继续讨论...','\x20中找到世界书。','”，选项有：[','#delete-world-books-list\x20.clear-posts-item','\x20分享了Ta的位置：\x27','favorites-delete-selected-btn','https://i.postimg.cc/RZNLhbbr/IMG-4389.gif','char-music-progress-bar','758320yzvHjn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>本地图片(头像/表情/头像框/等)大小:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22><strong>','album-upload-photo-btn','https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','nextSibling','\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','appName','.screen','\x0a\x20\x20-\x20**人设**:\x20','（无文字内容）','\x20条红包记录。','albumId','”写一篇新日记...','无标题','rule-template-input','load-more-thoughts-btn','购物中心生成设置已更新！','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','lrc','tencent','NPC\x20\x22','ephone','transfer-actions-modal','...”','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','delete-api-preset-btn',')\x20领取了最后一个红包。红包已被领完，手气王是\x20','save-npc-btn','[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“','npc_','https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','handleListenTogetherClick','https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','temp_user_chat_mirror','cphone','memory-screen-back-btn','vote_for_name','”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','维基百科','世界书数据已成功恢复！','\x0a#\x20群成员列表\x20(你的总结目标)\x0a','平票或无人投票，此轮无人出局。','innerHTML','正在为后台活动发送API请求\x20(\x22','open_red_packet','profile-heartfelt-voice','\x22>\x20','onclick','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','无法为不存在的分类打开绑定模态框:','announcement-actions-modal','这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。','lrcUpdateInterval','home-screen-pages-container','):\x20','my-frame-grid','选中的消息均已收藏过。','检测到应用离线了\x20','狼人行动API失败:','isLocal','</recent_dialogue_with_user>\x0a</character>\x0a','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','packetType','char-simulated-input','3RMwzbs','nai-generate-btn','将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。','remove','恭喜你，你赢了！','\x22\x20处于行动冷却中\x20(还剩\x20','部分失败','操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20','AI已接收并理解了该图片的内容。','likes','https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20','findLastIndex','https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','currentTarget','#\x20可用群头像列表\x0a','delete-theme-preset-btn','douban-cast-list','alternateGreetings','injectLatestThought','错误:\x20','\x20的所有动态，且无法恢复！','.char-screen.active','longTermMemory','”的出行足迹...','「在这里输入对话内容」\x0a(在这里输入动作或环境描写)','commentsCount','home-screen','”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a4.请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','未知会话','skipped','found','qzoneSettings','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','werewolf-retry-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。','delete-transcript-btn','\x20行的格式不正确，已被系统跳过。','”中，用户的昵称是“','manage-product-categories-btn','&nbsp;','save-sticker-binding-btn','最近\x2050\x20条','readingLibrary','\x22\x20触发行动决策...','”\x20已被删除。','从缓存播放\x20TTS\x20音频...','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22','页面跳转','\x22\x20\x0a\x20URL:\x20','browser-content','来源网站','.favorite-item-card','狼人杀','simulatedAlbum','\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','”的身份，开始你的回忆梳理与精炼。','close-novelai-test','ai-avatar-preview','这将从历史记录中【永久抹除】这\x20','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','.unread-indicator','recall-message-btn','recordId','\x22\x20的记忆中清除了1条关于已删除评论的通知。','http','(Timestamp:\x20','manage-products-btn','<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>','这是你们最近的对话：\x0a','https://image.novelai.net/ai/generate-image-stream','char_browser_article','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20','waimai-confirm-btn','location_share','.werewolf-player-checkbox:checked','delete-current-category-btn','chat-list-render-window-input','图片格式处理失败:\x20','字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a','close-group-manager-btn','\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。','random','删除动态','正则表达式格式错误:\x20','close','regenerate-btn','https://api.vkeys.cn/v2/music/tencent?id=','从CPhone推进真实对话失败:','https://i.postimg.cc/PqYp5T5M/image.png','blockCooldownHours','开始检查','精炼失败','customAvatarFrames','确定要删除预设\x20“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','shopping-settings-modal','relationship','\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>','levelchange','</div><div\x20class=\x22transfer-note\x22>','qzonePhotos','请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。','[收到一笔转账]','select-all-recipients','查验结果','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>','https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','head','文件格式不正确，缺少关键的外观设置项。','未知作者','在动态评论区点击了表情，但在表情库中未找到对象:','外观设置已保存并应用！','\x22\x20触发专属决策流程...','rp-group-greeting','local-song-upload-input','unreadCount','编辑通话消息','\x20MB</strong></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20','isTemporary','doubanMinPosts','-\x20**','压缩完成！','enabled','nai-diffusion-4','高级数据清理失败:','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>','chat-input','char-diary-screen','.product-item.selected','product-category-select','💾\x20[专属弹窗]\x20保存角色NAI提示词','manual-summarize-btn','location','execute-search-btn','product-variations-container','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','copy-message-btn','statusText','.comment-sticker-btn','time-zone-select','speaking','对方撤回了一条消息','add-npc-btn','heartfelt_voice','pop','upload-cphone-bg-url-btn','文件解析或应用失败:\x20','offsetLeft','generate-shopping-items-btn','守卫已行动，守卫请闭眼。','getMinutes','\x20的外卖订单（时间戳:\x20','成功检查并修复了\x20','https://i.postimg.cc/wjH180kn/IMG-5566.gif','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','修复完成！','cancel-red-packet-btn','\x0a-\x20**世界观**:\x20','onplay','countdown-date-input','记忆链接','announcement-action-pin','nai-smea','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','冗余数据清理流程已启动...','发送语音','<option\x20value=\x22','openCharWallet','iconId','chatData','最终负面提示词:','添加\x20NPC','chat-settings-screen','ended','scroll','书库是空的，点击“导入新书”添加第一本吧！','netease','extensions','toDateString','nightActions','更换“','display','readAsText','global-css-input','save-world-book-btn','enable-ai-drawing-switch','announcement-action-delete','char-music-mode-btn','inline-flex','\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a-请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20','导演/编辑模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','save-appearance-preset-btn','world-book-screen','music-visual-container','等待回复失败:','.icon-preview','浏览器不支持电池状态API。','toISOString','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','从旧版本迁移的条目','📸\x20动态NovelAI图片生成开始，共','block','zIndex','activeContainer','sticker-upload-input','level','hasOwnProperty','头像和人设不能都为空哦！','toDataURL','vertical','导演模式保存(Sticker):\x20使用了\x20meaning\x20查找','renderQzoneScreenProxy','currentVoiceId','novelai-generated-','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','删除成功','padStart','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a','album-back-btn','严重警告！','character-phone-screen','@[[','input:checked','📸\x20NovelAI图片生成开始，AI提供的prompt:','trim','收到了未知的AI指令类型:','https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','表情名不能为空！','导演/编辑模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','reset-custom-css-btn','frame_14','chat-name-input','UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...','price','<input\x20type=\x22','】，本名是【','sticker-action-bar','sticker_','height','music-player-cover','filter','default_negative','NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。','<div\x20class=\x22poll-card\x20','all\x200.3s\x20ease','狼人请选择刀人对象','current','categoryId','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','小时前聊过。','char-qq-conversation-screen','add-group-avatar-upload-btn','personaPresets','Enter','bottom','favorite','qzone_post','删除日记','switch-greeting-group','like','dead','https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','persona-editor-title','导出成功','show-announcement-board-btn','linkedWorldBookIds','\x20[社交背景:\x20','werewolf-game-over-title','characterNegativePrompt','music-player-overlay','chat-header-status','已被用户删除','修改图片','.contact-picker-item','char_diary','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>','font-preset-select','gift-receipt-body','\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22','.call-message-bubble[data-timestamp=\x22','onload','确定要删除这条长期记忆吗？','lyrics-horizontal-pos','无法找到当前角色的数据。','status-bar-visible','\x20\x20\x20负面:','pageY','ready','chat-list-action-delete','精炼成功','spectator-reroll-btn','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','选中的收藏已被移除。','此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？','vinyl-view','\x20的动态\x20(角色)','\x0a-\x20**最近对话摘要**:\x0a','member','确定要删除这条通话消息吗？','async','50%','”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','simulatedMusicPlaylist','\x20(概率:\x20','product-editor-modal','enableAiDrawing','currentX','\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>','icon-setting-item','.ai-generated-image','创建普通群聊\x20(我参与)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>','📁\x20从本地文件\x20(.lrc)','[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>','部分导入失败','-\x20\x22','\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','paste','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20','negative','warn','EPhoneSingleChat','\x20\x0a#\x20社交圈与动态\x0a','werewolf-selection-item','\x20首歌曲，这可能需要一些时间...','\x20的外卖代付请求（时间戳:\x20','replace','index','我的消息预览','模拟器心跳\x20Tick...','#333','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','确定要删除与\x20\x22','✅\x20NAI提示词：使用角色配置','规则名称和正则表达式不能为空！','\x20的红包，金额为\x20','is-transfer','delete-btn','API未配置','visibilityState','成功移除了\x20','++id,\x20name','memories-view','\x20分享了一张NovelAI图片，prompt:\x20','character_book','\x22\x20决定去发一条动态...\x20(此处为模拟)','\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>','flex-start','检测到\x20EPhone\x20备份文件，执行标准导入...','篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','group_','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','shiftKey','first','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','[你发送了一个表情，意思是：\x27','removeItem',')\x20刚刚投票给了\x20“','toggle-blur-btn','alt','Sticker','https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','.message-bubble[data-timestamp=\x22','transfer-action-cancel','startDiscussion','分钟前聊过。','member-persona-input','\x20(图片描述:\x20“','totalElapsedTime','<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','save-font-preset-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','originalContent','”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20','profile-history-icon-btn','<em>','save-member-settings-btn',')为你点了一份外卖作为【礼物】。外卖内容是“','https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','note','[系统提示：五子棋游戏已结束。最终结果是：','https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','mode','\x22\x20style=\x22display:block;\x22>×</button>','existing-groups-list','notification-content','authorChatId','\x0a**---\x20第\x20','char-music-screen','件商品','chat-list-actions-modal','\x0a-\x20**可以刀的玩家列表**:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','minimaxGroupId','手动注入狼人杀记忆失败:','在PNG中找到角色数据，但解码或解析失败。错误:\x20','已删除最后一条心声，当前心声已重置。','sticker-grid','</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20','）完成了支付。此订单已关闭，其他成员不能再支付。]','%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。','将清空选定角色的所有动态、评论和点赞。','sharedHistory','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>','[图片]','memory-list-container','动态发布成功！','设置已应用','\x20天的讨论环节。\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>','\x0a#\x20你的角色设定：\x0a你必须严格遵守','onended','请根据你的设定，生成你的浏览器记录。','》吗？\x0a\x0a【【【警告】】】\x0a此操作将同时永久删除该分类下的\x20','表情含义','products','lyrics-btn','-\x20公告内容:\x20\x22','visibilitychange','\x0a##\x20来自《','-\x20\x20\x20**公开发布NovelAI真实图片动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20[\x22图片1详细英文描述\x22,\x20\x22图片2详细英文描述\x22]}`\x20\x0a\x20\x20*\x20**prompt撰写**：你可以根据当前对话上下文、你的角色人设、以及你想表达的情感和氛围，来撰写详细而具体的prompt。详细程度由你根据具体情况自己决定，并不强制。\x0a\x20\x20*\x20例如：\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22','https://www.myinstants.com/media/sounds/notification-sound-2.mp3','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]','minimaxApiKey','分类\x20“','群聊人数不能少于2人。','save-wallpaper-btn','element','删除分类后，该分类下的所有商品将变为“未分类”。确定吗？','未知App','\x0a\x0a现在，请以“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','char-music-list','AI\x20的下棋指令无效或位置已被占据:','清理完成','transcript-modal-title','reset-button-order-btn','update-notice-modal','在导演模式中发现一个无效的JSON片段:','start-werewolf-game-btn','\x20元。','marginTop','right','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。','.comment-input','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>','findLast','.countdown-card\x20.timer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','replaceChild','favorites-list','还没有可供编辑的AI响应。请先让AI回复一次。','修改昵称','.frame-grid','选择要精炼记忆的角色','无法找到或消息类型不匹配的分享链接:','apiConfig','max-memory','胜负未分','simulatedBrowserHistory','abs','\x22\x20的独立后台活动开关已关闭，本次跳过。','确定要恢复默认设置吗？','\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22','offline-preset-select','当前时间是\x20','test','.status-text','short','99+','world-book-editor-screen','Token\x20calculation\x20error:','auto','summaries','my-avatar-upload-input','\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','douban-settings-btn','”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','browser-back-btn','chatRenderWindow','ZIP\x20Blob\x20大小:','compress-images-btn','.world-book-category-pane','data-clear-step-1','imageCount','editable-image','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。','.delete-memory-btn','将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。','cancel-call-message-action-btn','<span\x20class=\x22offline-description\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“','<span\x20class=\x22diary-highlight\x22>$1</span>','chat-interface-screen','\x20请根据这个结果发表你的评论。]','variation-product-name','解析格式模板失败:','character-nai-negative','-\x20你昨晚守护了\x20','qzone-avatar-img','在这里输入图片描述','isPlaying',',\x20记录数:\x20','确定要将选中的商品作为礼物送出吗？','”的长期记忆少于2条，无需进行精炼。','photo-viewer-modal','offline-min-length-input','(暂无评论)','在角色\x20\x22','chat-group-container','close-call-transcript-btn','https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','qzone-banner-img','<p\x20class=\x22char-browser-image-description\x22>','gameover','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','个红包，共','member-settings-modal','”图标','\x0a-\x20**这是你们最近的对话历史**:\x0a','\x20\x20\x20promptSource:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“','操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20','fillRect','import-appearance-input','\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片','\x0a\x0a现在，请开始生成这组App使用记录。','https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','chatItem','save-api-preset-btn','favorite-article-btn','qzone-sticker-panel','\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','douban-post-detail-screen','chat-list-item','https://i.postimg.cc/fLTc42dg/IMG-4391.gif','”的长期记忆中。','memberId','save-preset-btn','\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>','https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','streamSaver','character-nai-prompts-btn','lucky','settings-preview-area','transfer-amount','custom-modal-title','content','musicLibrary','create-poll-modal','edit-last-response-btn','https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','replyToName','\x22\x20data-category-id=\x22all\x22>全部</button>','<label><input\x20type=\x22checkbox\x22\x20value=\x22','default_positive','players','source_name','model','chats','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>','-\x20你昨晚空守了。\x0a','80px','position','icon-settings-grid','chatId','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>','”\x20绑定到...','custom-modal-body','https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','custom-modal-confirm','[一张图片，描述为：\x22','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>','<div\x20class=\x22spinner\x22></div>','#\x20你的社交圈\x20(绑定的NPC)\x0a','\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a','</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥','offsetHeight','https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','image_post','save-rule-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','修复了角色\x20\x22','#\x20长期记忆\x20(必须严格遵守)\x0a','user_photo','span:first-child','计算图片总大小时出错:','qzone-banner-input','import-new-book-btn-header','.participant-avatar[data-participant-id=\x22','对方正在输入...','modern\x20app\x20icon\x20for\x20','nai-result-image','”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','regenerate-douban-btn','password','-9999px','theme','\x20已复制到剪贴板。','正在执行删除操作...','组件图片已更新！','播放已暂停','AI\x20(','已成功导出所有数据！','\x20位AI角色的长期记忆中！','classList','preset-action-cancel','当前群聊还没有公告哦。','拉取模型失败:\x20','<strong>$1</strong>','收到了格式不规范的AI指令，已跳过:','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>','auto-memory-interval','GRID_SIZE','https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','导入备份将完全覆盖您当前的所有数据。此操作不可撤销！确定要继续吗？','novelai-details','头像框已保存并同步！','is-realimag','favorites-action-bar','一个神秘的角色。','删除头像','user','ArrowRight','\x20更换了你的头像]','已切换到角色\x20','worldBookCategories','models','发生了一个错误:\x20','浏览器','群聊已建立...','-\x20(头像库是空的，无法更换头像)','https://i.postimg.cc/90RBDh9K/IMG-6377.gif','forEach','开场\x20','getUint32','请根据你的设定，生成你的高德地图足迹。','\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动。\x0a3.\x20\x20**【简洁性铁律】**:\x20每条个人记忆总结【绝对不能超过60个字】。\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我今天在群里和大家讨论了电影，感觉很开心。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我在群里和','image-upload-input','https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','”生成这组【与角色高度相关】的商品数据。','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','handleWidgetImageChange','将清空选定角色的心声和散记历史。','photos-grid-page','检查完成','请输入新的背景图片链接','未知成员','createDocumentFragment','”。请你回顾一下你和“','participantId','\x22操作...','请输入新的内容：','&times;','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥','https://i.postimg.cc/PJppkbvn/IMG-6918.gif','novelai-settings-modal','你已死亡，正在围观...','https://corsproxy.io/?','werewolf-wait-reply-btn','delete-group-btn','”移出群聊吗？','contact-picker-list','https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','播放被中断，这是正常行为:','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20','date-search-input','7865970iHGhTJ','nickname','clear-posts-list','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（','rp-details-my-amount','createObjectURL','rp-tab-direct','avatar_prompt','请根据以上设定，生成商品数据。','char-music-next-btn','<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>','{{user}}','close-nai-test-btn','post-remove-image-btn','链接分享','appUsageLog','https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','nextElementSibling','\x20被刀了','¥\x200.00','\x20(用户)</label>','字体已保存并应用！','AI方','import-btn','group-name','https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','char-diary-list','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','确定要删除《','AI女巫决策：今天是第','normal','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','buttonId','操作结果','.message-editor-block','📋\x20直接粘贴歌词文本','API未配置，无法生成内容。',')\x20送出了一份礼物，收礼人是：','AI投票决策API失败:','json','douban-screen','\x0a\x0a其专属的“世界书”也已自动创建并关联。','游戏结束，开始自动总结并注入记忆...','style','群昵称不能为空！','favorites-edit-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>','radio',':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>','back-to-char-qq-list-btn','聊了关于生日派对的事，我们约好了10月1日见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a','prophetCheck','\x22\x20的独立行动失败:','isEnabled','save-css-preset-btn','options','解析成功：标准JSON数组格式。','https://i.postimg.cc/sDFhySn3/IMG-6936.gif','---\x20','\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a','share-link-modal','photo-viewer-prev-btn','<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a','\x20被刀了\x20(你没有解药了)','speech-01','”的记忆\x20---\x0a','floor','字体预设已保存！','nai-uc-preset','\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心新增】在这里添加“背景”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22','toArray','#5b3a29','-\x20\x20\x20**当前时间**:','message-bubble\x20post-deleted-placeholder','showWaimaiDetails:\x20找不到消息或消息类型不正确','https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','.entry-enabled-switch','**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（','”。请你对此作出回应。]','通话于\x20','name','一个普通玩家',']\x20的正则表达式无效:','commentText','close-char-music-player-btn','批量导入表情','-\x20**当前时间**:\x20','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','character-grid','commentCooldowns','ServiceWorker\x20注册成功，作用域为:\x20','”已向你发送好友申请。请返回聊天列表查看。','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','reason','https://files.catbox.moe/q6z5fc.jpeg','**:\x20\x22','offline-mode-group','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','authorId','is-acting','my-persona-group','<div\x20class=\x22post-content\x22>','确认抹除','file','music-lyrics-list','\x22。\x0a','[系统提示：你于时间戳\x20','确定要清空当前角色的NAI提示词配置吗？','poisonedId','justifyContent','狼人杀AI讨论生成失败:','</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请为你的图片添加一个简单的描述（必填，给AI看的）！','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','添加完成！\x0a\x0a成功添加\x20','notification-avatar','items','secondaryModel','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20','selected','播放列表是空的，无需清理。','char-music-cover','角色\x20“','product-category-tabs','count','productId','编辑对方状态','\x0a[文字图内容:\x20','persona-library-modal','npc-list','\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','group-avatar-upload-input','</td><td\x20class=\x22item-subtotal\x22>¥','\x0a-\x20**世界书设定**:\x20','.sticker-binding-checkbox','nai-test-error','</td><td\x20class=\x22item-qty\x22>','\x20\x0a-\x20**你们最后的对话**:\x0a','message-wrapper\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合“今天是','这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？','请输入新的昵称','opened','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','enableTimePerception','linked-memory-selection','没有可供重新生成回复的用户消息。','AI女巫决定保留解药。','》及其下的表情已成功删除。','”下，发送了一个表情评论，意思是：“','为角色\x20\x22','所有通话记录','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','font-preview','save-persona-preset-btn','data-voice-id=\x22','现在开始讨论，请各位玩家依次发言。','hours','点击查看详情...','转账给\x20','\x0a###\x20详细对局流程:\x0a',',\x20价格:\x20¥','post-actions-modal','\x20首歌曲的详细信息...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','找不到匹配的书籍','model-select','》\x0a\x20\x20\x20\x20-\x20**','npc-background-activity-switch','actionCooldownMinutes','等待对方处理...','<button\x20class=\x22sticker-category-tab\x20','true','push','cover','currentPlaylist','sort','totalBalance','selection-favorite-btn','AI已将新头像命名为：“','来自“','\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a','https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','songName','\x22\x20data-commenter-original-name=\x22','请根据你的设定，生成你的App使用记录。','https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','\x22\x20placeholder=\x22','抱歉，我拒绝了你的好友申请。','</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>','https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','setTimeout','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url(','input[value=\x22user\x22]','\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20','<option\x20value=\x22\x22>未分组</option>','accept-friend-btn','导演模式','group-members-settings','isAwaitingResponse','findIndex','导入失败','-\x20昨晚是平安夜，无人死亡。\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','生成失败:\x20','\x0a\x0a将重置冷静期。','容错解析：策略2成功\x20(提取了summary字段内容)','订单详情','”]\x20','\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','add','<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20','post-hidden-text','2-digit','</span><span\x20class=\x22poll-option-votes\x22>','onchange','###\x20你的秘密信息\x20(此部分只有你作为AI导演能看到)\x0a','change_group_avatar','werewolf-role-modal','dismissedUpdateVersion','application/json','touchmove','#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：[','请至少选择一个要清理的角色。','”\x20将备注修改为\x20“','确认精炼记忆？','\x20/\x20','你们已经有','\x27刚刚在你的动态“','\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22','qzone-sticker-grid','”的转账。]','download','proxyUrl','https://i.postimg.cc/qB9zbKs9/20.jpg','<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>','++id,\x20chatId,\x20timestamp,\x20customName','你们没有在读书。','offlinePresetId','onloadedmetadata','选定范围内的动态已被清空。','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20','char-chat-list','single','https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','endsWith','你已收款','无法解析角色卡文件。\x0a错误:\x20','</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22','timestamp','创建新聊天','\x20群里已经安静了','transform\x200.3s\x20ease','initiator','\x20[包含','resolve','showScreen','char-music-play-pause-btn','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','chara','cancel-gift-recipient-btn','\x20<span\x20class=\x22source\x22>','recalledData','小于1分钟','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','最终正面提示词:','split','add-char-diary-btn','https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','spectator-propel-btn','请根据角色列表，生成豆瓣小组帖子。','**[投票结果]**\x20','https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','申请成功！','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','确定要永久删除这条心声记录吗？此操作不可恢复。','\x0a-\x20**你们最后的对话摘要**:\x20\x0a','realimag','delete','assign','send-btn','isBgClear','完成(','https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22','npc-list-view','<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>','send-group-packet-btn','qzoneAlbums','\x0a-\x20**人设\x20(必须严格遵守)**:\x20','send-waimai-request-btn','.nav-item[data-view=\x22qzone-screen\x22]','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>','删除消息','.contact-picker-item[data-contact-id=\x22','lastActionTimestamp','https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','\x22\x20已经存在了，换个名字吧！','expanded','memos','未分类','cancel-call-btn','https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20','”的手机使用习惯...','.album-art-btn','.message-wrapper','[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','pause','style=\x22background-image:\x20url(\x27','post-image-desc-group','base_resp','\x20.message-bubble.user\x20$1','borderRadius','add-preset-entry-btn','<button\x20class=\x22delete-btn\x22\x20data-id=\x22','请根据以上设定开始你的决策。','phone-screen','正在准备...','focus','add-world-book-entry-btn','replyTo','设置群名','css-preset-select','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','cphone-icon-settings-grid','group-members-group','.variation-image-input','edit-call-message-btn','positive','导演模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','close-character-nai-prompts','sticker-category-tabs','\x20领取了\x20','transfer-action-decline','[语音消息:\x20','douban-detail-avatar','insertBefore','100','\x0a#\x20可用表情包\x20(优先使用)\x0a每个AI角色都被设置了专属表情包，在需要发送表情时，他们应该【优先】从自己的专属列表中选择。尽量让你的表情丰富多样，避免重复。\x0a','post-actions-btn','请至少选择一个要添加的联系人。','<option\x20value=\x22global\x22>公用\x20(所有角色)</option>','reset-character-nai-prompts-btn','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','[一张图片，其隐藏文字为：\x22','检测到\x20Tavern\x20AI\x20世界书文件，执行兼容导入...','visibleGroupIds','昨晚是平安夜','transcript-entry\x20','confirm-vote-btn','shopping-category-count-input','\x20(回复\x20','favorites-view','\x0a#\x20可用表情包\x20(优先使用)\x0a-\x20请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a','https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','coverUrl','API请求失败:\x20','今天\x20','lrcContent','mousemove','import-preset-input','https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','Response\x20status:','ai-persona','arrayBuffer','DOMContentLoaded','checkout-btn','open-shopping-btn','voice','column','<span\x20class=\x22group-name\x22>','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','friend','你领取了\x20','close-sticker-category-manager-btn','”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','waimai_response','给你准备了一个红包','https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','globalChatBackground','<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>','banner','\x22\x20的后台活动开关已关闭，本次跳过。','profile-main-content','selection-cancel-btn','transparent','timeupdate','qzone-post-container','char-background-activity-switch','#e9ecef','group-management-modal','请先在购物车中选择要结算的商品。','character_persona','cancelable',')的阅读进度失败:','[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20','*对方按下了接听键...*','更换专辑封面','chat-render-window-input','\x20的新头像同步到群聊\x20\x22','lastActionType',')\x20的残缺数据。','正在呼叫...','toFixed','simulatedAppUsage','associatedWith','ZIP文件内容:','\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','transition','album-photos-title','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','repost','cloneNode','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>','AI已将新群头像命名为：“','qzonePosts','\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20','conversationIndex','转发了\x20@','拼手气红包','文章摘要...','正在请求网易云音乐API:','<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>','删除分类及表情时出错:','chat-input-area','https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','offsetParent','isDanger','edit-product-btn','notification-sound-player','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','API\x20返回错误:\x20','regenerate-char-album-btn','thoughts-history-list','https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','api-key','userStickers','发言结束，现在开始投票。','cloned-header','spectator-edit-btn','，TA的身份是：【','frame_ribbon','favorite-memo-btn','<textarea\x20id=\x22','\x0a---\x0a###\x20帖子ID:\x20','在写入文件流时发生错误:\x20','”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20你的角色设定\x0a','my-avatar-input','编辑记忆','touches','delete-track-btn','scrollTop','favid','product-category-tab','\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>','见面”）。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过100个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','请在此处粘贴完整的LRC格式歌词...','导演模式保存了一个无效的五子棋移动指令:','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>','...\x22):\x20','hasShown20','</p>','indexOf','”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。','avatar_name','pending_system_reflection','请先选择要删除的商品。','preview-bubble-style','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','加载预设详情时发生错误:\x20','syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','secondaryProxyUrl','char-memo-detail-content','相册已成功删除。','刷新页面？','正在生成“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20[','\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)','my-persona','grayscale(100%)','.rules-category-pane[data-category-id=\x22','\x20元。此订单已完成。]','getHours','<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>','请稍候...','manage-members-btn','正在开始清理冗余数据，请不要关闭页面...','management-mode','[表情]','取消置顶','配置错误','\x20红包已被领完，手气王是\x20','moveTo','bookId','未知用户','.rules-category-pane','add-manual-memory-btn-header','groupId','publicText','聊天记录已成功分享到\x20','direct','mouse','textAlign','generate','请稍候','appendChild','getElementsByTagName','https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','确定要删除这条渲染规则吗？','receiver','\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','您的修改已保存！','你们最近没有有效聊天记录。','指定的数据已成功清除。','预言家','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','variation-product-image','现在，请所有AI角色针对刚刚的发言（特别是\x27','https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif','is-card-like','preview-font-style','GeminiChatDB','https://i.postimg.cc/xTk5xN49/IMG-7233.gif','clear-cart-btn','游戏即将开始，正在为各位玩家分配身份...','publisher','文章标题','.entry-content-container','https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','https://i.postimg.cc/qRCtnMms/IMG-6145.gif','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','正在模拟“','rp-direct-total','确定发布','确认删除分类','frameUrl','video-call-screen','正在解压图片...','post-upload-local-btn','battery-alert-image','提取的图片大小:','操作成功','product-category-manager-modal','char-music-prev-btn','豆瓣设定','change-frame-btn','https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','querySelectorAll','key','contactType','确定要删除头像框\x20“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','save','\x22\x20data-option=\x22','通话记录已保存:','https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','动态与互动','照片详情','用户\x27','search-results-list','https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','选择精炼范围','[系统提示：你刚刚主动拉黑了用户。]','transfer-sender-name','switch-to-image-mode','werewolf-game-btn','byteLength','✅\x20NAI图片生成成功！','<div></div><div></div><div></div><div></div><div></div>','张图片，prompt:','private_user','一位朋友','role','url(','创建新相册','【AI角色】','</div><br>是否用这条新记忆替换掉这些旧记忆？','通话名称已更新！','该消息发送已超过2分钟，无法撤回。','群里已经安静了\x20','确定要从头像库中删除“','正在请求AI进行记忆精炼...','reading-overlay','[系统提示：','join','商店空空如也，点击“管理”添加商品吧！','char-amap-screen','cancel-create-countdown-btn','fontFamily','rp-direct-receiver','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</option>','export-world-book-btn','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-10条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a2.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a3.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性，尽量让你的表情丰富多样，避免重复。。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20你的角色设定\x0a你必须严格遵守','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','.world-book-category-pane[data-category-id=\x22','**:\x20关于\x20**','\x0a#\x20身份与核心任务\x0a你正在扮演角色“','\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>','rule-chat-id-select','.at-mention-popup','转账:\x20','qzone-screen','（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a','share_card','Cphone数据\x20(CPhone)','fillStyle','photoCount','手动总结已完成！新的记忆已添加到“','disabled','repost-cancel-btn','https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','fullscreen-active','share-link-btn','minimized','\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20','https://i.postimg.cc/g2XykNGB/IMG-4727.gif','douban-detail-content-wrapper','className','gomoku_move','确定要从收藏夹中移除这\x20','button','product-image-preview','rp-details-summary','动态内容已复制到剪贴板。','请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。','\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a','ai_image','📝\x20使用','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22','share-target-modal','p[data-index=\x22','.comment-send-btn','照片已删除。','messageTimestamp','cancel-delete-world-books-btn','sticker','\x20条消息。','is-raw-html','hiddenContent','####\x20','member-avatar-preview','fontSize','page-indicator','remove-cphone-bg-btn','#data-clear-char-list\x20.clear-posts-item.selected','https://i.postimg.cc/prsGKMBx/IMG-4370.gif','UTF-8\x20解码成功。','Bearer\x20','isOpen','animationend','通话结束，时长\x20','werewolf-role-description','.recalled-message-placeholder','NEGLIGIBLE','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg','callRecords','一点心意','music-time-counter','createWriteStream','确定要删除这篇日记吗？','lastIndexOf','导入成功！','declined','call-history-screen','pat-animation','.delete-block-btn','正在分析“',')，开始总结...','char-product-grid','confirm-prophet-check-btn','chat-list-bottom-nav','文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。','未知设定的NPC','ephone-theme','<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22','doubanActiveCharacterIds','生成图像','beginPath','char-music-total-time','\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','EPhone-Chat-','hiddenText','save-theme-preset-btn','message','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','close-gomoku-btn','incoming-call-modal','https://i.postimg.cc/B6T59xGK/IMG-7101.gif','https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','autoMemoryInterval','即将开始下载您的完整备份文件。下载过程中请勿关闭页面。','已成功批量导入\x20','char-main-date','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','bubble_theme','suffix','char-photo-item','qzone_delete_post','qzone-post-item','charAt','existing-sticker-categories-list','上一条消息的发送时间是\x20','userAgent','group-background-activity-switch','music-play-pause-btn','add-message-editor-block-btn','witch-modal-title','werewolf-role-name','✅\x20图片解压成功！','splice','img','fontUrl','已选择\x20','请先点击扳手图标进入管理模式，才能添加新商品。','\x20的备忘录','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>','reject-friend-btn','\x0a##\x20','\x22\x20吗？','add-group-avatar-batch-btn','导入数据时出错:','请输入有效的默认价格！','请根据你的设定，生成你的相册内容。','\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>','wallpaper-preview','执行出错','nai-cfg-scale','notification-sound-url-input','originalSize','</div><div\x20class=\x22gift-footer\x22>共','这是一条群聊语音消息，已禁止发起TTS请求。','所有歌曲链接均有效，无需清理！','cancel-werewolf-lobby-btn','char-music-progress-fill','cart-count','.lyrics-btn','天核心议题','被投票放逐','文件格式不正确，这不是一个有效的单聊备份文件。','”的身份，开始你的客观总结。','call-history-title','input[name=\x22theme-select\x22][value=\x22','<span\x20class=\x22diary-handwritten\x22>$1</span>','#qzone-screen\x20.qzone-content','API\x20错误:\x20','\x27);\x22','cart-title','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>','doubanPosts','chat','global-lyrics-bar','.poll-option-input','history','novelai-test-btn','qzone-nickname','\x0a**内容:**\x0a','authorAvatarPrompt','currentDay','search-history-screen','群里在','✅\x20检查完成，未发现任何冗余数据。','</button>','导演/编辑模式保存(Sticker):\x20使用了\x20meaning\x20查找','https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','commenterName','\x0a\x0a#\x20情景感知:\x0a\x20\x20\x20\x20','minimaxVoiceId','canvas','在聊天\x20\x22','请输入有效的正整数！','”的当前状态已更新为：','contentLines','正在执行...','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22','复制失败','preset-entries-container','recalled_message','\x22\x20class=\x22preview-frame\x22>','time-zone-group','back-to-clear-step1-btn','renderWorldBookScreenProxy','保存\x20API\x20预设','按钮顺序已恢复为默认设置！','rp-details-sender','https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','identifier','douban-cast-modal','translateX(-50%)','.char-photo-item','这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？','lastOpened','\x0a#\x20你的任务\x0a你就是角色“','\x20的日记','book_','group_summary_from_','\x0a-\x20**讨论摘要**:\x20\x0a','退出游戏','backgroundColor','流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。','cursor','novelai-model','playlist','清空动态时出错:','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22','video-call-main','orderBy','\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a','张NovelAI图片:\x20','确认拉黑','\x20的对话\x20(只读)','\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22','角色卡数据无效或缺少\x27name\x27字段。','draggable-button-item','\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','”翻开TA的日记本...','https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','none','「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22\x20style=\x22color:\x20red;\x22>计算出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','loadAsync','variation','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20','video_call_request','\x0a\x20\x20\x20\x20-\x20**书名**:\x20《','custom-bubble-style','\x20向对方发起了转账:\x20','sampler','block-chat-btn','outgoing-call-name','regenerate-call-btn','char-diary-detail-title','chatListRenderWindow','导演模式悔棋：已撤销AI在\x20(','parse','chat-list','\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','-\x20(ID:\x20','当前页内容摘要','\x0a}\x0a}','人局，身份为\x20','【原动态内容:\x20','.qzone-post-container','minimax-group-id','globalCss','doubanMaxPosts','ai-response-editor-container','nai-default-positive','清空动态时发生错误:\x20','nai-test-negative','*事件*:\x20平安夜，无人出局。\x0a','highlighted','旁观模式收到未知指令类型:','”的聊天记录已成功导出！','请根据你的设定，生成你的歌单。','decision','querySelector','steps','https://i.postimg.cc/fycfcvHf/IMG-6569.gif','reading-library-search-input','https://i.postimg.cc/fRV86FMq/IMG-4381.gif','”\x20的详细角色信息。','AI\x20角色\x20\x22','”\x20吗？','.voice-transcript','\x22(处理后为\x22','chat-lock-content','\x20个表情吗？此操作不可恢复。','days','cart-items-list','在这里输入语音内容','Character\x20Avatar','你们正在一起读书。','错误：尝试打开一个不存在的预设，ID:','member-name-input','includes','\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20',')\x20为\x20','》\x0a-\x20**发帖人**:\x20','\x22\x20class=\x22avatar-frame\x22></div>','5px','https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','分享成功','确定要删除这条记录吗？','\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。','[群聊]','您的旧有记忆已被完整保留，未作任何修改。','save-api-settings-btn','go-to-clear-step2-btn','将清空选定角色的所有长期记忆。','background','https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png','https://i.postimg.cc/DZshzKv6/IMG-5576.gif','frame_8','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg','album-grid-page','#ff4d4d','sticker-panel','.frame-item.selected','群聊内转账','preset-action-edit','offlineMaxLength','AI生成的图片','**。','group_call_summary','[私聊]','\x20的聊天','https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif','解析AI返回的投票JSON时出错:\x20','music-playlist-btn','call-message-bubble\x20','rejected','https://generativelanguage.googleapis.com/v1beta/models/','。你可以使用\x20\x27vote\x27\x20指令参与投票。]','https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg','qzone-posts-list','https://i.postimg.cc/htZppbS4/IMG-7107.gif','小时前','isOfflineMode','确认生成','douban-detail-group','批量导入头像框','#npc-association-list\x20input:checked','cancel-rule-editor-btn','waimai-amount','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','单个红包金额不能少于0.01元！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20可用表情包\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','confirm-share-target-btn','nai-cors-proxy','function','\x20的图片消息替换为文字描述...','werewolf-lobby-modal','确认送出礼物','character','clientY','gift','image_url','activeChatId','”。\x0a','\x22\x20的整个对话吗？此操作不可撤销。','我通过了你的好友申请，我们现在是好友啦！','\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20','transfer','[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','version','import-preset-btn','AI已将您的\x20','”准备好友申请...','\x20其中包括以下投票：','https://i.postimg.cc/pddJj9zN/IMG-7094.gif','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【【【长度铁律】】】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**','\x22\x20data-commenter-display-name=\x22','”的参考记忆','werewolf-log-entry\x20','global-bg-preview','【重要提示】','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20为您代付成功','》吗？此操作不可撤销。','AI返回的行动中未找到有效的JSON数组。','\x0a\x0a#\x20待总结的群组视频通话记录\x0a','offline-mode-options','flex','\x0a#\x20---\x20世界书设定结束\x20---\x0a','\x20(这是你的帖子)','0:00','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>正在计算...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22>--</span>\x0a\x20\x20\x20\x20','AI\x20(群聊后台)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','请输入一个有效的页码！','\x20评论了动态]','\x20(用户)</span>\x0a\x20\x20\x20\x20','character-select-item','ai-voice-id-group','char_book','.sender','https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','你已经死亡，无法发言。请等待其他玩家发言结束。','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','.world-book-tab','backgroundActivityInterval','.playlist-item-info','没有可导出的世界书数据。','网络请求失败:\x20','rp-group-total','presetCategories','chat-input-actions-top','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','未检测到BOM，尝试使用\x20UTF-8\x20解码...','album-photo-input','\x20更换了群头像','外观预设已保存！','groupName','red-packet-details-modal','.poll-option-item','proxy-url','正在等待AI角色们进行激烈的讨论...','正在接收流式数据...','character-profile-modal','---\x20狼人杀对局完整复盘\x20---\x0a\x0a','link-description-input','AI返回了空的或格式不正确的总结内容。','.char-screen','https://i.postimg.cc/50k390X8/IMG-6376.gif','歌曲查找失败:\x20AI请求的歌曲名\x22','获取更新通知文件失败。','请输入要添加的记忆要点：','确定要删除这条公告吗？此操作不可恢复。','-\x20你昨晚查验了\x20','now','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>','onloadend','歌曲信息','最近\x2020\x20条','template','\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a','\x20(最后互动于\x20','\x22\x20已经存在了！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>','在导演模式保存时，遇到了未知的AI指令类型:','char-taobao-screen','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','music-prev-btn','📁\x20从本地上传','getElementById','source','frame_flower','favorites-search-clear-btn','\x20个商品吗？此操作不可恢复。','target_name','最近支出','12p','recipientName','status-bar-time','(空)','cancel-frame-settings-btn','contact-picker-screen','werewolf-game-over-close-btn','\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','font','hunter','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','确认清理冗余数据？','(暂无有效聊天记录)\x0a','visibility','AI女巫决定使用解药！','请输入标题','\x20\x20\x20characterPositivePrompt:','char-music-player-modal','\x22\x20触发带理由的好友申请决策流程...','https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','小时内退还。','批量导入格式错误，已跳过此行:','<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>','<span\x20class=\x22commenter-name\x22>','这将用备份文件中的数据【完全覆盖】当前与“','theme-toggle-switch','auto-memory-toggle','songJson','swiped',')，祝福语是：“','EPhone-WorldBooks-','投票至少需要2个选项。','\x20红包已被领完。','frame_10','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','title','rp-direct-greeting','<span\x20style=\x22color:\x20green;\x22>是</span>','wolfKill','is-link-share','center','removeChild','\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**','variation-decrease-qty','AI\x20尝试评论一个不存在的表情:\x20\x22','**关键词:**\x20','https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','”添加记忆','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>','contactId','fetch-secondary-models-btn','lyrics-vertical-pos','cart-item','\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>','https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','length','无法从\x20SSE\x20响应中提取图片数据','playerJson','图片\x20Blob\x20创建成功，大小:','decline','https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','existing-product-categories-list','进入投票','.upload-variation-image-btn','addEventListener','请你对此作出回应。]','未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。','group-action-cooldown-input','getDate','\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20.message-bubble\x20$1','流程启动','rule-name-input','”申请好友时发生错误：\x0a\x0a','quote','randomJottings','渲染聊天项\x20[','voice-message-btn','等待回应','https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','.message-bubble.is-link-share','undefined','.avatar-group','https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','”。]','duration','照片上传成功！','char-diary-detail-content','upload-custom-frame-btn','cancel-music-search-btn','请至少输入2个有效的投票选项！','variation-selection-modal','imageProcessed','authorName','#message-editor-container\x20textarea','apiPresets','my-frame-content','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','confirm-contact-picker-btn','API设置不完整，无法继续。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22','getPropertyValue','\x22>×</span>','accepted','🔧\x20检测到Chrome浏览器，启用headers兼容性处理','world-book-tab','change_user_avatar','\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a','map','错误：找不到该通话记录所属的聊天对象。','\x20不支持。请选择6、9或12人。','personality','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','lastMemorySummaryTimestamp','https://i.postimg.cc/jCVK0fGL/IMG-6890.gif',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','45LdZPXz','手动创建角色','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>','audio/mpeg','\x0a\x0aAI原始返回内容:\x0a','history-back-btn','无法访问剪贴板。','将清空选定角色的所有通话记录。','\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a','https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','recalled-animation','保存CSS预设','</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-','预言家请睁眼，请选择要查验的玩家。','getTimezoneOffset','未选择书籍','主API和副API均未配置或配置不完整。','font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);','base','selection-share-btn','amap','ruleId','Ephone','请输入一个有效的图片URL！','1024x1024','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“','widgetData','cors_proxy','收到\x20SSE\x20数据，大小:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22','chat_','rp-group-amount','setItem','<strong>','size','\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>','werewolf-log-entry\x20system','getVotes','product-name-input','原始消息已删除或不存在','touchstart','blob','\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','member-avatar-input','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','⚠️\x20NAI提示词：没有角色，使用系统配置','https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','numeric','packet_timestamp','.info','已打包表:\x20','maxWidth','groupAvatar','https://files.catbox.moe/r5heyt.gif','https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','currentPhase','NPC的昵称和人设都不能为空！','global-bg-input','生成模拟足迹失败:','<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>','douban-detail-post-title','offlineMinLength','”的对话摘要**:\x0a','消息已更新！','at-mention-item','https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','文件不是一个有效的PNG。','transaction','countdown','尝试直接作为图片显示...','.douban-cast-checkbox','<p>♪\x20暂无歌词\x20♪</p>','refine-memory-btn-header','(这张照片没有描述)','.png','</span>\x20:\x20<span>',')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“','share-location-btn','<p\x20style=\x22font-size:12px;color:#888;\x22>','&id,\x20minimaxGroupId,\x20minimaxApiKey','女巫已行动，女巫请闭眼。','狼人数量已达到胜利条件，狼人阵营获得了胜利！','请输入备忘录内容','my-avatar-preview','[文字图]\x20','children','-\x20你的狼队友是：','下在(','不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。','setProperty','totalTime','closest','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>','[一张图片，描述为：“','.sticker-category-tab','#\x20角色核心设定\x0a','\x20发送了一张图片，图片内容描述为：\x27','offline-mode-toggle','请输入相册名称','getContext','close-announcement-board-btn','choice','EPhoneWorldBookBackup','群聊\x20\x22','<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','加载图片失败，跳过压缩:','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>','werewolf-action-bar','.link-share-card','直接使用\x20base64\x20数据','custom-modal-overlay','我们的回忆','upload-ephone-bg-url-btn','clear-posts-item','https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','offline','caller-avatar','<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>','postTitle','请开始整合。','转账已被拒收','https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>',')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','的秘密档案：\x0a-\x20你的狼人杀身份是：【','检测到刚结束的通话，正在注入通话记录上下文...','senderName','通话中还没有你的发言，无法重新生成回应。','renderApiSettingsProxy','add-my-avatar-upload-btn','EPhone-Full-Backup-','add-my-avatar-batch-btn','cache','#chat-input-area','char-usage-list',',\x20flat\x20design,\x20simple','请输入想跳转的页码\x20(1\x20-\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','选择歌词导入方式','.comment-item','\x20\x20-\x20你评论说:\x20','\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20','总结长期记忆时出错:','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是','werewolf-game-title','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20','red-packet-modal','waimai-request-modal','\x22\x20点赞了动态\x20#','生成成功！','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','生成第','close-shared-history-viewer-btn','”思考后决定暂时不发送好友申请，将重置冷静期。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>','aiPersona','publish-to-announcement-btn','manage-stickers-btn','没有找到可导入的内容。','bg-btn','.chat-group-header','nai-test-status','temp_npc_chat','\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。','shoppingCategoryCount','请根据以上设定，立即做出你的决定。','来自\x20','\x20本世界书','对方拒绝了你的视频通话请求。','cancel-post-action-btn','qzoneGroups','renderChatListProxy','dark','countdownEndTime','张图片','\x22\x20创建了一个新约定:','werewolf-user-input','rule-enabled-switch','API请求失败\x20(','blocked_by_user','我是谁呀。','AI\x20(独立行动)\x20尝试使用一个不存在的表情:\x20\x22','\x20拍了拍\x20“','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“','。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','rules-tab\x20active','getTime','.world-book-group-content','[系统提示：你刚刚成功将自己的备注名修改为了“','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>',']\x20(ID:\x20','这是群里的第一条消息。','appearance','”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','诊断：在\x20data.extensions.character_book\x20中找到世界书。','greeting','chat-list-title','favorite-item-card','.post-deleted-placeholder','大小:','++id,\x20title,\x20lastOpened','world-book-name-input','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','++id,\x20name,\x20chatId','shopping-screen','\x27的评论，内容是：“','opacity','cfg_scale','image/png','https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','无法获取电池信息:','AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。','检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。','link','无共同好友','📤\x20发送请求到\x20NovelAI\x20API','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>','create_memory','generativelanguage','confirm-create-post-btn','读书会话已关闭。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','isArray','生成的图片URL:','所有音乐源都未能找到歌曲：“','</span><span>','”说的申请理由：','\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','world-book-checkboxes-container','https://i.postimg.cc/ThMMVfW4/10.jpg','”量身定制的商品已上架！','#custom-modal\x20.custom-modal-footer','probability','https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','你撤回了一条消息','imageDescription','#image-mode-content','delete-selected-frames-btn','\x0a##\x20世界书《','.selected','\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“','NovelAI生成失败:','showStatusBar','chat_message','\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20','JSZip库未加载，请刷新页面重试','\x22\x20(由\x20','[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','select-all-products-checkbox','ai-voice-id-input','quote_reply','board','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','text/event-stream','char-wallet-content','\x22\x20中发现并修复了旧红包数据。','元,\x20备注:\x20','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','player','message-editor-modal','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>','prompt_order','setup','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>','未使用','poll-option-input-wrapper','typing-indicator','”生成商品？','regenerate-char-qq-btn','\x20领取</div>','char-album-screen','更换图片','repost-confirm-btn','https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','music-search-results-modal','”，金额是\x20','isDeleted','import-single-chat-input','请至少选择一个要分享的聊天。','myAvatar','.post-mode-switcher','gift-recipient-modal','reset-global-css-btn','system','恭喜发财，大吉大利！','change-icon-btn',']。当在对话历史中看到这些名字时，它们都指的是【你】自己。','标准JSON数组解析失败，将尝试强力解析...','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','customName','char-music-player-title','propel-btn','\x22\x20class=\x22realimag-image\x22\x20alt=\x22NovelAI图片分享\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22\x20title=\x22','px))','character-nai-prompts-modal','文件格式不正确，这不是一个有效的世界书备份文件。','poll','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','NPC\x20列表','预设已删除。','请输入你想说的内容：','chat-settings-modal','”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a','原作者','https://i.postimg.cc/fRTF24jS/IMG-4430.gif','notificationSoundUrl','\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20表情使用指南\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','API失败:\x20','block_user','hasListener','这个预设文件中没有找到任何有效的提示词条目。','总结通话记录时出错:','variation-options-container','product-description-input','status-bar-battery','compressed','请开始总结。','chat-settings-btn','tlyric','-\x20(空)','custom-modal-cancel','查看失败','add-group-avatar-url-btn','douban-comment-item','\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【','char-article-title','add-product-variation-btn','character-selection-screen','theme-preset-select','\x22\x20生成行动失败:','loader-container','.cart-item-checkbox:checked','\x22)\x20在播放列表中未找到。','existing-categories-list','QQ音乐','random_jottings','secondary-api-key','已成功收藏到“我的收藏”页面！','\x20个自定义头像框吗？','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','AI返回了空内容。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','rule-editor-title','</persona>\x0a</character>\x0a','\x22\x20中有未领完的红包，正在生成抢红包指令...','offline-max-length-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20','member-management-list','readAsDataURL','已删除最新心声，当前心声已回滚至上一条。','memoryTimestamp','你们在','poll-options-container','call-history-list','...”)','\x0a\x0a##\x20世界书:\x20','<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20','change_remark_name','\x20向\x20','char-browser-screen','\x20\x20-\x20评论:\x20','reply_content','world_info','当你死亡时，你可以选择带走场上任意一名玩家。','”才能使用\x20\x27open_red_packet\x27\x20指令领取。]','\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a','text','https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20','<span\x20style=\x22color:\x20red;\x22>未运行</span>','next-page-btn','\x27刚刚评论了你的动态“','是否要使用毒药？','\x0a#\x20对话者的角色设定\x0a','[ERROR:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','total-image-size-display','编辑人设预设','openCharacterSelector','rp-details-list','API\x20调用失败','douban-detail-author','当作\x20ZIP\x20文件处理...','messages-view','合计:\x20¥','tts-audio-player','等人的礼物','hasShown10','data-clear-char-list','tagName','https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','rotating','message-editor-block\x20variation-block','本地歌曲源错误:','这条动态的原始数据已被彻底清除。','npc-list-back-btn','candidates','。等待对方处理。]','add-ai-avatar-batch-btn','avatar-frame-modal','表情包分类绑定已更新！','https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','请输入投票问题！','crossOrigin','」听歌。要结束并开始和「','++id,\x20albumId','borderColor','mouseout','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','manage-my-avatar-library-btn','自动总结狼人杀游戏失败:','创建群聊至少需要选择2个联系人。','无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20','”)下发送了一个表情评论，意思是：“','从\x20JSON.data\x20中提取图片数据','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#f0f2f5','确认清理','musicData','诊断：在顶层\x20',')，问题是：“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','border','\x0a#\x20你的任务\x0a你是一个狼人杀游戏导演。你的任务是扮演【除了','“全部”分类无法被绑定。','https://i.postimg.cc/k401K5g7/IMG-7304.jpg','src','\x0a---\x20复盘结束\x20---','\x20天\x20---','voter_name','\x22]\x20.avatar','API设置','frame_cat_ear','https://generativelanguage.googleapis.com/v1beta/models','删除相册','在同时执行两个函数时出错:','qzone','chat-messages','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“','image-mode-content','</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','创建新预设','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>','ai-avatar-upload-input','flat','.modal-header\x20span','favorites','update-notice.html?_=','✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)','secondaryApiKey','sticker-category-manager-modal','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','#delete-world-books-list\x20.clear-posts-item.selected','countdown-title-input','退款给\x20','#char-chat-list\x20.chat-list-item','🌐\x20使用网络URL','artist','.format-btn','发来了\x20','-\x20你们昨晚尝试攻击的玩家是：','导演/编辑模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','row','\x20发起了外卖代付请求，商品是“','导入歌词','.delete-track-btn','margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','\x20已为','music-playlist-panel','</div><div\x20class=\x22transfer-amount\x22>¥\x20','char-main-time','无法生成新回复:\x20','custom_proxy_url','object','守卫请睁眼，请选择要守护的玩家。','originalPost','彻底删除消息','&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','\x22\x20class=\x22chat-image\x22></div>','input[value=\x22','请为这个头像起个名字（例如：开心、哭泣）','preset_','dialogue',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>','chatLinks','time-perception-toggle','https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','blockReason','substring','#preset-tabs\x20.world-book-tab','npcId','char-browser-item','\x20中聊天','https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','totalAmount','.photo-delete-btn','apiTemperature','请为这组提示词预设命名：','visible','本地头像上传及识别失败:','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','serviceWorker','[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','\x20---\x0a','所有解码尝试均失败:','**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务铁律\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【至关重要】**:\x20当你发现“最近的动态列表”中，有你【感兴趣且还未互动过】的动态时，你**应该优先考虑**使用\x20\x27qzone_comment\x27\x20或\x20\x27qzone_like\x27\x20指令去进行互动，这比你自己发一条新动态更符合社交礼仪。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27[{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]\x27\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20','world-book-editor-title','summary','请先填写NovelAI\x20API\x20Key！','href','rp-group-count','renderWallpaperScreenProxy','商品已删除。','https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','char-conversation-partner-name','add-new-category-btn','删除书籍','无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','favorites-back-btn','https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','<div\x20class=\x22post-comments-container\x22>','</name>\x0a\x20\x20<persona>','https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','.draggable-button-item:not(.dragging)','call-transcript-modal-body','\x0a-\x20**你的长期记忆**:\x0a','https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','participant','分类名不能为空！','清理冗余数据时出错:','toLowerCase','isHidden','\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a','relative','++id,\x20name,\x20createdAt','\x22\x20id=\x22','”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','请输入文字图描述！','call-message-bubble\x20ai-speech','parts','\x22>...</div>','qzone_comment','已选\x20','syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','https://files.catbox.moe/','load-more-chats-btn','accept-call-btn','正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...','add-new-group-btn','text-image-mode-content','imageUrls','[系统提示：用户\x20(','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','reset-font-btn','select-message-btn','添加网络歌曲','thought-card','正在请求AI为新群头像命名...','npc','.entry-content-textarea','https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','anno_','image/jpeg','customCss','.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid','resolution','】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22','\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>','-\x20用户在你们共同所在的群聊中的昵称如下：\x0a','local','receiverName','lineWidth','这是模拟对话，无法发送消息哦~','startsWith','{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','[图片]\x20','offline_text','[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]','go-to-cart-btn','singer','linked-chats-checkboxes-container','生成模拟浏览器历史失败:','manage-groups-btn','nai-steps','https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','导演模式保存(Sticker):\x20使用了编辑器提供的完整JSON\x20(url\x20+\x20meaning)','[系统提示：用户加入了通话]','GBK\x20解码成功。','removeEventListener','cancel-clear-wizard-btn-step1','dataset','一条动态','照片描述','select-all-frames-checkbox',':\x20[发送了一个表情，意思是:\x20\x27','为什么','15px','horizontal','startTime',')。详情:\x20','qzone-post-delete-action','antidoteUsed','\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a','\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a','prophet','CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。','创建新规则','操作失败:\x20','poll-question-input','应用已返回前台，正在检查更新...','[系统提示：\x27','.delete-btn','https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','新建备忘录','你已拒收','video_call_response','rp-content-direct','小时核心议题','product-image-input','ai-avatar-library-modal','posts','upgrade','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','\x0a\x0a现在，请做出你的决定。','create-shuoshuo-btn','padding','play','自定义通话名称','outgoing-call-avatar','single-lyric-display','https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','currentIndex','mouseleave','确定要永久删除商品\x20“','https://i.postimg.cc/cLPP10Vm/4.jpg','1.0','frame_11','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','ZIP解压失败:','https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','导出失败','你是狼人，请选择刀人目标。','swipeDirection','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#chat-messages','then','guardedId','[图片内容:\x20','AI幻觉已被拦截！试图使用群名\x20(\x22','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','转发成功！','douban-min-posts-input','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','reset-sound-btn','用户刚刚接听了你主动发起的视频通话。','noneOf','hasShown40','werewolf-game-over-modal','生成模拟聊天失败:','https://i.postimg.cc/PxZrFFFL/o-o-1.jpg','refined','https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','werewolf-game-screen','result','vote','开始检查并迁移旧的红包数据...','<p><strong>','请输入你想对“','announcement-board-content','status_text','[情景提示]\x20','Cphone','”。请你回顾一下刚才和\x20“','246330gsWfiK','正在为您选择的\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','pending','chat-header-title-wrapper','shoppingProductCount','消息时间戳\x20','送出礼物','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','确定要从你的头像库中删除“','close-sticker-panel-btn','\x0a---\x0a','douban-my-comment-avatar','下棋历史\x20(x,y坐标均从0开始):\x0a','.red-packet-card','</textarea>','#\x20你的互动对象\x20(用户和其他角色)\x0a','✅\x20找到\x20final\x20事件的图片数据','++id,\x20timestamp','导入世界书时出错:','cssText','all','cancel-create-poll-btn','-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20','https://i.postimg.cc/wMxmCZVC/IMG-7099.gif','preCallContext','sourceChatName','4.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20(','你拍了拍\x20“','请输入有效的字体URL。','仅清空\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>','groupMembers','\x0a\x0a\x0a\x20#\x20【格式铁律\x20(最高优先级)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，格式如下:\x0a\x20\x20\x20\x20`[{\x22type\x22:\x20\x22offline_text\x22,\x20\x22content\x22:\x20\x22在这里写入你创作的、混合了对话和描写的完整段落。\x22}]`\x0a2.\x20\x20**【内容风格】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由地将对话穿插在描写的任何位置，实现自然分段。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a3.\x20\x20**【禁止】**:\x20绝对禁止在\x20`content`\x20字段中出现\x20\x22dialogue\x22\x20或\x20\x22description\x22\x20这两个词。\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**','calls','lrc-upload-input','translateX(','song_name','</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','**[讨论环节]**\x0a','import_card','<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>','暂无内容...','-\x20用户的QZone昵称是\x20\x22','检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。','offsetTop','toLocaleDateString','token-count-display','ai-frame-content','payload','https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','linkedWorldBookId','data-clear-wizard-modal','iVBORw0KGgo','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','\x0a-\x20**最近与用户的互动**:\x20','blob:','https://i.postimg.cc/wx72fhr2/IMG-5968.gif','ttsCache','open-reading-library-btn','export-data-btn','save-chat-settings-btn','正在请求“','prompt','.post-avatar[data-author-id=\x22','create-album-btn-page','\x22\x20class=\x22chat-image\x22>','novelai-key-toggle','没有找到可导入的内容。请检查您粘贴的格式是否正确。','product-grid','更换图标','spectator','create-new-member-btn','members','https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','listen-together-btn','touchend','内容加载失败...','--\x20点击选择\x20--','）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**','https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','📋\x20请求体:','regenerate-char-usage-btn','countdown-card','\x22]\x20','生成模拟备忘录失败:','视频通话请求','\x0a-\x20散记:\x20','aiAvatar','gridEl','nameHistory','的设定集','预设导入失败:','killedId','content-type','}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','lyricsPosition','已重置为默认提示音，点击“保存所有外观设置”后生效。','https://api.vkeys.cn/v2/music/netease/lyric?id=','此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>','keydown','save-frame-settings-btn','请输入背景图片的URL','https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','\x27,\x20\x27bulangni\x27,\x20sans-serif','imageUrl','frame_5','speaker_name','#avatar-frame-modal\x20.modal-body','》添加歌词吗？','prev-page-btn','红包已被领完！','【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！','AI\x20发言失败','cancel-npc-editor-btn','char-conversation-messages','[转账]','”的TTS功能已关闭，已禁止发起TTS请求。','.chat-list-item[data-chat-id=\x22','.call-record-card','保存主题预设','shift','请选择一个接收人！','frame_9','newSize','long','image_prompt','请输入新的名称（留空则恢复默认）','contact-picker-item','https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','character-nai-positive','data:\x20','guard','myAvatarLibrary','theme-default','profile-random-jottings','所有数据已成功恢复！应用即将刷新以应用所有更改。','gameLog','catch','enableTts','确定要拉黑“','...]','AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。','speaker','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','groupAvatarLibrary','selection-screenshot-btn','qzone-avatar-input','发送好友申请','confirm-delete-world-books-btn','cancel-reply-btn','https://i.postimg.cc/W40f9qtd/IMG-7098.gif','正在执行清理操作，请不要关闭页面...','\x20个新头像框！','\x22\x20更换了头像','成功将角色\x20','pin','\x0a\x0a#\x20对话者的角色设定\x0a','每晚可以查验一个玩家的身份是好人还是狼人。','activeBookId','导入已取消，因为未提供名称。','(ID:\x20','has','该预设包含\x20','taobao','#gift-recipient-list\x20.contact-picker-item.selected','book-upload-input','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','post-image-description','」的新会话吗？','mes_example','recipients','headers','startX',')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a','togglePlayerFullscreen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“','equals','commenterOriginalName','image/*','已成功加入购物车！','\x20的已删除动态','clear','\x20条长期记忆发送给AI，总结成大约\x20','rendering-rules-screen','linked-memory-count','and','char-music-lyrics','simulatedTaobaoHistory','charging','\x22\x20(用户)\x20或\x20\x22',')\x20内容:\x20\x22','browser-screen','</p><p>','reading-content','备忘录','\x20发布了一条新公告','translateY(','未知表情','.voice-play-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a','ai-original-name-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20','list-item','没有聊天了。','appearancePresets','\x20的动态\x20','frame_13','分类\x20\x22','\x22:\x20[\x0a','new-category-name-input','\x20(本名:\x20','天黑请闭眼...','[系统提示：你接受了“','票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a','https://i.postimg.cc/63NmX03s/IMG-4366.gif','公用规则','AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','<span>删除</span>','并评论说：\x22','小红书','生成购物中心商品失败:','open-memory-screen-btn','https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','aiAvatarFrame','matches','群聊中没有成员有足够（2条以上）的记忆可供精炼。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','...\x22','display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;','productInfo','确认覆盖','请输入有效的金额！','send-poll-btn','你现在在哪里呀？','*讨论记录*:\x0a','已经一起听了','char-usage-screen','，点击查看</div></div>','\x20位群成员生成并注入了个性化记忆！','cancel-create-post-btn','smea_dyn','本次发送给AI的【挂载记忆】内容如下：\x0a','”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>','mouseup','生成模拟日记失败:','reading-library-list','https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','\x22\x20alt=\x22','AI未能成功描述图片。','persona-library-grid','.search-result-item','https://','get','撤回了一条[','Asia/Shanghai','\x22\x20的本次后台活动跳过。原始回复:','ai-response-editor-modal','.lyric-line[data-index=\x22','a\x20beautiful\x20scene','pending_user_approval','post-use-url-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','为了确保所有数据同步，建议立即刷新页面。','找到图片文件:','save-advanced-editor-btn','frame-item','douban-detail-content','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>计算图片大小时出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>Error</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','scrollIntoView','pat-btn','cphoneWallpaper','已成功收藏\x20','single-char-background-activity-group','frame_6','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','收到数据，类型:','animate-like','https://i.postimg.cc/76Tj3g1B/IMG-4425.gif','[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【身份铁律】】】**:\x20用户的身份是【','transcript','从\x20JSON.image\x20中提取图片数据','char-album-grid','命名头像','votes','API\x20请求失败:\x20','天\x20-\x20讨论','未发现任何需要修复的数据问题。','音频播放失败:','(未设置)','未知设定的角色','body','此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？','\x22\x0a-\x20**用户的备注**:\x20\x22','https://api.vkeys.cn/v2/music/tencent?word=','textContent','\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>','https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif','getWriter','，我们一起见证了这个约定。','memo','icon-img-','getBoundingClientRect','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>','请先配置NovelAI\x20API\x20Key！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请根据你的设定，生成你的淘宝购买记录和余额。','manage-ai-avatar-library-btn','commenter','传统导出\x20(兼容旧版或内存小的浏览器)','\x22\x20转发了动态\x20#','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','set','[你发送了一条语音消息，内容是：\x27','.progress-bar','---\x0a','ai-avatar-group','https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','native','https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','round','确认清理无效歌曲？','close-group-avatar-library-btn','-selection-list','tables','gift-recipient-list','https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','group_call_response','exclude','删除NPC','\x0a#\x20你的核心任务\x0a你正在扮演角色“','https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','checked\x20disabled','\x0a-\x20**帖子内容摘要**:\x20','#music-lyrics-container','select-all-music-search','自动总结成功：已成功添加\x201\x20条新的长期记忆！','-\x20**当前歌词**:\x20\x22','novelai-enabled','#chat-interface-screen\x20>\x20.header','\x0a##\x20---\x20关于“','change_avatar','callHistory','string','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','quantity','狼人杀AI回应生成失败:','visibleTo','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','stores','\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。',']。目前投票的人有：','select-all-types-for-clear','sticker-search-input','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','edit-message-btn','请输入关键词或选择一个日期。','rp-direct-amount','setDate','AI\x20尝试使用一个不存在的表情:\x20\x22','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','stickerId','\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22','add-sticker-batch-btn','关于“','.cart-item-checkbox[data-id=\x22','\x0a\x0a#\x20供你参考的信息\x0a','https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>','.battery-text','handlePacketClick','”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','input[name=\x22visibility\x22]:checked','Caching\x20rendering\x20rules\x20for\x20chat:\x20','\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','where','photo-viewer-image','\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','<span>','variation-quantity-display','请至少选择一种要清理的数据类型。','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20','将分类\x20“','https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','胜利！','https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','保存外观预设','旁观模式AI尝试使用不存在的表情:\x20\x22','导入单个聊天时出错:','save-ai-response-editor-btn','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','unreadPostsCount','未找到相关收藏','已恢复默认字体。','\x20发送了一个【拼手气红包】(时间戳:\x20','favorites-search-input','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>','custom-frame-upload-input','所有解析方案均失败！将返回原始文本。','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg','is-ai-image','我们和好吧！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','https://i.postimg.cc/KYr2qRCK/1.jpg','secondary-proxy-url','system_message','message-editor-block','latestTimestamp','https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','groupHeader','cphoneAppIcons','gomoku-btn','music-player-avatar-display','选中的表情已成功删除。','add-persona-preset-btn','已取消收藏。','onpause','code','正在请求AI角色们加入讨论...','此操作会将选定的\x20','world-book-tabs','reload','delete-world-books-modal','”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20','lineTo','错误：找不到该成员的个人档案。','</p>\x0a\x20\x20\x20\x20','该条记录已成功删除。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20','有点饿了，可以去找充电器惹','图片压缩过程中发生错误:','open-sticker-panel-btn','persona','values',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','char-audio-player','申请失败','cancel-message-action-btn','</small>','group-video-call-btn','&id','++id,\x20name,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp','qzone-back-btn','<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20','status','font-url-input','EPhone-长截图-','当前为渐变色','pointer','paidBy','confirm-hunter-shot-btn','getBattery','selection-mode','thoughtsHistory','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','fileType','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<span\x20style=\x22color:\x20green;\x22>运行中</span>','novelai-test-modal','名为\x20“','分享新鲜事...（非必填的公开文字）','精炼“','\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a\x0a//\x20【核心修改2】明确了JSON格式中\x20speaker_name\x20和对话中称呼的不同要求\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20','call-history-back-btn','music-player-artist','检测到好友申请待处理状态，为角色\x20\x22','\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20[','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“','无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20','检测到视频通话请求，为角色\x20\x22','原文:\x20\x22','已撤回的消息','profile-thoughts-history-view','secondary-model-select','分享新鲜事...','</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>','-\x20\x20\x20**NovelAI图片分享**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22name\x22:\x20\x22你的角色名\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20【禁止暴露这是novelai生成的图片!】\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20使用场景：当你想要基于当前对话情景、你的性格或上下文分享一张图片时使用。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。','chat-list-action-cancel','.com/','”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20','#000000','upload-global-bg-url-btn','</span>:\x20','✅\x20动态NovelAI图片全部生成完成:\x20','is-waimai-request','App记录','号玩家:\x20','发布公告','\x0a你必须严格遵守','rp-tab-group','reject','”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20','...\x22)','”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','<input\x20type=\x22checkbox\x22\x20value=\x22book_','[表情:\x20','所有动态','announcement-item-wrapper','\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“','image/','检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。','\x22\x20记录了一条新回忆:','.message-bubble','novelai-api-key','清理失败','EPhone-Full-Backup-Legacy-','tts_','manage-frames-btn','background-interval-input','###\x20玩家身份配置:\x0a','pageX','#fullscreen-lyrics-container\x20.music-lyrics-list','\x0a\x0a现在，请生成新的评论。','npc-action-cooldown-input','naiSettings','photo-viewer-next-btn','\x20删除了自己的一条动态]','请选择一个目标。','你们的对话刚刚还在继续。','category','/9j/','long-term-memory-screen','IMG','https://image.novelai.net/ai/generate-image','NEGATIVE_INFINITY','lyric-line','请输入有效的图片URL！','总结失败','API\x20预设已保存！','标题:\x20','确定要永久删除这条动态吗？','.frame-item:has(.delete-btn)','voted','world-book-category-manager-modal','\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','错误：找不到要删除的分类。','\x0a-\x20**你最近和“','https://i.postimg.cc/nryNzTXK/IMG-6915.gif','无法获取模型列表','span','角色卡导入失败:','stringify','，礼物是：','minimax-model-select','preset-screen','isBusy','postId','characterId','song','preventDefault','无备注','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>','\x22,\x20\x22postId\x22:\x20456,\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','\x20首歌曲获取失败:\x0a-\x20','备注名/群名不能为空！','cancel-share-target-btn','ai-avatar-library-grid','npc-editor-modal',')\x20商品:\x20','</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥','请求添加你为好友','douban-comment-input','favoritedPostIds','）。]','基础数据不完整，无法开始总结。','AI返回的change_music指令中，歌曲名无效或缺失:','sender-name','<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>','music-mode-btn','group-cooldown-group','announcements','请先在API设置中配置好API信息。','create_countdown','群成员','**[夜晚]**\x20平安夜。\x0a','[系统提示：用户刚刚发布了一条动态(ID:\x20','masterpiece,\x20best\x20quality,\x201girl,\x20beautiful,\x20detailed\x20face,\x20detailed\x20eyes,\x20long\x20hair,\x20anime\x20style','save-font-btn','\x20的红包','categories','gameMode','AI\x20获胜了！','\x22></div>','douban-detail-comments-list','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</span></div>','**[夜晚]**\x20','https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','#ff8a80','is-gift','\x20小时了。','》吗？','请根据你的设定，生成你的日记内容。','button-order-editor','删除\x20(','borderBottom','https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','currentSnippet','transform','load-more-qzone-btn','\x22><div\x20class=\x22poll-question\x22>','AI\x20(CPhone)\x20尝试使用一个不存在的表情:\x20\x22','.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar','click','confirmButtonClass','cphone-wallpaper-preview','(你是第一个发言的人)','API错误响应:','\x20个表情包，且无法恢复！','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。','.battery-level','confirm-final-clear-btn','...','red_packet','existing-group-item',')\x20的可用表情:\x0a','请输入头像的图片URL','\x0a\x0a#\x20待总结的视频通话记录\x0a','inline-block','create-post-modal','https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','gbk','找不到主角\x20“','message-actions-modal','.chat-group-header:not([data-has-listener=\x22true\x22])','.chat-group-content','text_image','repost-modal','charCodeAt','群里还没有任何消息。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22sticker-binding-checkbox\x22\x20data-chat-id=\x22','提示词配置','\x20的代付请求','char-qq-screen','<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>','[系统提示：用户打开了五子棋棋盘，游戏开始了。]','删除世界书','delete-selected-stickers-btn','char-simulated-send-btn','battery-alert-text','API未配置，无法生成对话。','\x22\x20处于行动冷却中，本次独立行动跳过。','color','message-wrapper\x20system-pat','is-poll','modify','”。只有“','save-nai-settings-btn','manual','accept','paddingBottom','生成失败','npc-persona-input','\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27','容错解析：策略3成功\x20(将整个返回文本作为摘要)','load','无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20','persona-preset-item','photos','请根据你的设定，生成你的备忘录内容。','生成豆瓣帖子失败:','游戏配置：','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','”的聊天记录','Response\x20headers:','nai-default-negative','确认精炼','inject-thought-toggle','post-image-preview','linkedMemoryCount','album-photos-back-btn','(无标题)','light','渲染规则\x20[','sender','line-through','静音音频已停止。','char-qq-transcript-modal','shoppingCategories','天\x20-\x20夜晚','douban-settings-modal','文章完整内容...','isPinned','\x0a-\x20**你的曾用名**:\x20[','导出数据时出错:','promptFeedback','change_user_nickname',')\x20刚刚领取了红包\x20(时间戳:\x20','.nav-item[data-view=\x22memories-view\x22]','update-notice-body','video-call-btn','werewolf-game-over-reason','font-size-slider','/v1/models','\x20行的格式不正确，已被跳过。','\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a','spinning','edit-post-btn','检测到新版流式备份文件，开始导入...','char-wallet-screen','评论内容不能为空哦！','apiKey','模型列表已更新','确定要删除NPC\x20“','openCharApp','find','announcement-action-cancel','无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20','clientWidth',',\x0a\x22data\x22:\x20{\x0a','未知错误','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>','AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:','从完整链接批量导入','ai-action-cooldown-input','\x20的头像框到群聊\x20\x22','clientHeight','rules-content-container','渲染X社交页面','https://i.postimg.cc/SNByPrf9/IMG-7005.gif','choices','api-temperature-slider','商品名称不能为空！','请输入EPhone主屏幕的背景图片URL','.qzone-post-item','请填写完整的约定标题和日期！','bg-preview','\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a2.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【','\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20','\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','歌单已生成，正在从网络获取\x20','confirm-gift-recipient-btn','delete-selected-products-btn','播放失败，请检查URL是否正确或浏览器是否支持该格式。','昨天\x20','继续讨论','NovelAI生成','delete-world-books-btn','删除对话','通话消息已更新！','#data-clear-type-list\x20.clear-posts-item','生成中...','qzone_like','\x20的消息:\x20\x22','close-product-category-manager-btn','linkedMemoryChatIds','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','charId','data:','douban-wait-reply-btn','回复\x20','cancel-ai-response-editor-btn','(无)','生成模拟淘宝记录失败:','pollTimestamp','put','var(--text-secondary)','\x27)\x22\x20data-comment=\x22','update_status','novelai-settings','\x22\x20data-poll-timestamp=\x22','pinned','address','\x0a\x20\x20\x20\x20','1249896NqTAth','。请收礼的角色表示感谢，其他角色可以自由发挥。]','成员们正在输入...','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','dblclick','collapsed','selection-count','API格式不正确，角色\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','offset','my-nickname-input','close-my-avatar-library-btn','置顶聊天','编辑规则','open-album-btn','data','typing-status','reply-preview-bar','<div\x20class=\x22poll-option-item\x20','当前人数\x20','#f0f0f0','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>','AI\x20(群聊后台)\x20尝试使用一个不存在的表情:\x20\x22','lyrics-offset-input','group','”的好友请求','\x0a##\x20---\x20来自','.selected-options-text','Minimax\x20TTS\x20API\x20调用失败:','zh-CN','确定要删除表情\x20\x22','确定要退出当前这局狼人杀吗？游戏进度将不会被保存。','reverse','api-settings-screen','commentIndex','帖子详情','<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>','最近的消息太少，无法进行有意义的总结。','global','day','werewolf-finish-speech-btn','link-source-input','equalsIgnoreCase','）刚刚拍了拍你（','.music-search-checkbox:checked','还没有人','正在重试\x22','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','remove-ephone-bg-btn','books','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20','purchases','ᗜωᗜ','<div\x20class=\x22post-images-grid\x20grid-','一位神秘的NPC','en-US','\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20','contains','char-home-screen','view','messages','</div>','updateListenTogetherIconProxy','\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>','isActive','\x27\x20在你的动态(ID:\x20','frame_7','#group-management-modal\x20.modal-header\x20span','#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a','slice','cart-item-checkbox','rp-details-greeting','placeholder','fetch-models-btn','通话记录已删除。','dragging','minimize-reading-btn','https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','repostComment','你们正在一起听歌，','npc-name-input','\x0a\x0a#\x20游戏规则\x0a-\x20','https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','link-title-input','确定要删除相册《','\x22\x20class=\x22avatar-img\x22><img\x20src=\x22','cart-total','chat-list-screen','border-box','wb_','[系统提示：你\x20(','\x20条消息吗？这会通知AI这些消息已被删除。','originalMeaning','import-data-input','#reading-window\x20.reading-header','\x0a\x0a#\x20待整合的记忆要点列表\x0a','member-editor','小组风格','[NovelAI图片:\x20','participant-display-avatar','<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20','custom-user-font','anime\x20person','\x20天\x20---**\x0a',']类型的消息。\x0a内容:\x20','-\x20**昵称:\x20','https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','请至少选择一位收礼人。','lyrics-position-group','isGroupCall','###\x20最终结果:\x20',':</strong>\x20','hang-up-btn','target','originalName','https://i.postimg.cc/yN3s8szM/IMG-4400.gif','fill','狼人请睁眼，请选择要刀的玩家。','each','caller-name','font-settings-screen','后台活动:\x20角色\x20\x22','data-clear-step-2','”。请自然地接受这个新名字，不要对此感到惊讶。]','link-content-input','[系统提示：你拒绝并退还了“','-\x20你昨晚用解药救了\x20','encode','openWerewolfLobby','quality_toggle','add-chat-btn','rule-editor-modal','.product-item','\x20\x20\x20正面:','\x0a###\x20条目:\x20','一位成员','无法解析预设文件。\x0a错误:\x20','full','\x0a-\x20**人设**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','default','reading-window','加载NPC列表失败:','.chat-list-item','(回复\x20','/v1/chat/completions','sticker-binding-modal','https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','解析AI返回的JSON时出错:\x20','npcs','import-single-chat-btn','\x20的红包已被领完','send-photo-btn','add-ai-response-block-btn','\x20首歌曲。','parsedLyrics','usage','https://i.postimg.cc/05DLr0yj/IMG-4427.gif','\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>','isSeparator','my-avatar-library-modal','</td></tr>','\x20更换了头像]','.music-search-checkbox','cart-screen','sticker-item','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','post_deleted_notice','”分享TA的备忘录...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','world-book-category-select','poll_timestamp','chat-search-results-list',')\x20时出错:','number','https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','<span\x20class=\x22diary-messy\x22>$1</span>','upload-image-btn','some','删除失败，请查看控制台错误信息。','frame_12','px)','[表情，含义:\x20','lyrics-active','ai-cooldown-group','这个分类下还没有商品哦~','AI返回的内容中未找到有效的JSON对象。','编辑动态','✅\x20图片转换成功！🎨','https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。','<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27','message-editor-container','voice_message','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','closed','请填写有效的商品信息和金额！','.action-icon','切换听歌对象','确认操作','waimai-order-for-ai-btn','avatar','playMode','智能导出\x20(推荐，速度快，内存占用小)','\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20','getFullYear','EPhone-Full-Backup-Streamed-','date','请为这本设定集命名：','[发送了一张图片，描述为：','AI\x20(独立行动)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','复制成功','flexDirection','旁观模式推进剧情失败:','select-all-stickers-checkbox','长期记忆','form-button','<br>','\x0a\x0a现在，请开始生成这组足迹记录。','<p>','来自与\x20','[图片:\x20','comment','enableAutoMemory','update-notice-dismiss-btn','tableName','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','white','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','群聊通话中没有找到可作为总结主体的AI角色。','无人接听群聊邀请。','.playlist-item','【用户\x20(User)】','\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22','https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','image','create-post-btn','\x22\x20data-memory-timestamp=\x22','cancel-clear-posts-btn','presets','minimaxModel','-\x20**姓名**:\x20','获取AI狼人目标失败:','#search-results-list\x20.music-search-checkbox','专属红包:\x20给\x20','char-memo-list','20px','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','seed','rules-category-pane\x20active','网易云',')，内容摘要是：“','ai_generated','.loading-spinner','发现新版本通知:\x20','\x22\x20触发了后台行动！','内心独白','数据迁移完成！总共修复了\x20','\x0a#\x20世界观\x20(必须严格遵守)\x0a','targetId','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>','最小帖子数不能大于最大帖子数！','你输了','.share-target-checkbox:checked','itemName','分钟前有人聊过。',',\x20内容:\x20\x22','isUserParticipating','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>','https://...','CELL_SIZE','\x20发送了一条语音，内容是：\x27','--chat-font-size','first_mes','favorite-diary-btn','bulkPut','\x20当前时间是\x20','group-avatar-input','请输入你想为Ta设置的【备注名】(例如:\x20哥哥)','添加商品','claimedBy','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','#preset-content-container\x20.world-book-category-pane','[发送了一条语音，内容是：',')，并在对话中自然地体现出来。','**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','[你发送了一张需要AI识别的图片，图片内容是：\x27','总结成功','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请输入群聊的名字','请根据你的设定，生成模拟聊天记录。','.remove-option-btn','back-to-list-btn','模拟表情含义\x20\x22','请输入一个有效的、未来的日期！','你们没有在听歌。','stroke','AI返回的刀人目标格式不正确。','图片内容','chargingchange',']\x20[最近对话:\x20','压缩失败','nai-seed','settings','groupNickname','\x20的外卖订单支付了\x20','chat-lock-overlay','post-image-preview-container','Bilibili','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','send_and_recall','字体URL不能为空！','\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员2\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20','\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a','preset-tabs','active','天\x20-\x20白天','nai-test-result','上传成功！','avatarFrame','post-visibility-groups','https://i.postimg.cc/d0WCKxff/IMG-6932.gif','”的头像库','generativelanguage.googleapis.com','rules-tabs','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>','https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','translateX(calc(-','top','currentLyricIndex','\x20元</div>','\x0a\x0a#\x20','lastUpdate','确认压缩图片？','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','myPersona',')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]','\x20被投票放逐。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','value','\x20个新头像！','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','\x20-\x20响应内容:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','游戏记忆已成功注入到\x20','确认删除','请先输入你的发言内容。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','bulkAdd','聊天记录','API错误:\x20','.frame-item','\x20发起了一个投票\x20(时间戳:\x20','status-','https://i.postimg.cc/k45sd8gn/IMG-6375.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','save-shopping-settings-btn','(无内容)','游戏尚未结束，无法进行总结。','\x0a-\x20**作者**:\x20','\x20条新消息','搜索歌曲','通话记录','characterName','smea','POST','remove-global-bg-btn','切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？','import-world-book-btn','正在请求AI进行手动总结...','join-call-btn','\x22]:checked','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','setHours','https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','”，内容是：“','QQ音乐搜索API失败:','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>','chat-header-title','currentTime','originalTimestamp','shopping-product-count-input','检查更新时出错:','已同步角色\x20','linesPerPage','callRequester','commenterDisplayName','”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','accept_transfer','totalPages','https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif','participants','.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper','”\x20的预设已存在。要覆盖它吗？','call-record-card','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>','qzone-avatar-container','finally','isDragging','无法推进剧情:\x20','**\x20(本名:\x20','此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？','&id,\x20name,\x20categoryId','decline_transfer','请所有AI角色开始投票。','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>','送给大家的礼物','\x22\x20发布了动态','渲染器','...\x0a-\x20**已有评论**:\x0a','event_type','https://i.postimg.cc/CKgDNYVb/IMG-5577.gif','preset-editor-title','确认导入','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','检测到群聊\x20\x22','shopping-action-bar','.variation-image-preview','data:image','84hrgqDk','添加头像','cphone-wallpaper-upload-input','#douban-cast-list\x20.douban-cast-checkbox:checked','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22','my-frame-tab','退款来自\x20','\x22)\x20作为角色名。消息内容:','strokeStyle','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>','isFullyClaimed','paid','确定要永久删除分类\x20“','appIcons','\x20的手机','后台活动模拟已自动启动。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22','#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a','.clear-posts-item','werewolf-kill-selection-list','\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>','视频通话刚刚结束','url','gomoku-controls','https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif','https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','rules-tab','currentPage','https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','currentText','\x0a-\x20**内容摘要**:\x20','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22','正在读取所有数据到内存中，请稍候...','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','chatActionButtonsOrder',')\x20作者:\x20','\x20(图片描述:\x20\x22','input','k_euler_ancestral','savedId','10px\x2015px\x2020px\x2015px','localeCompare','\x22\x20在库中未找到。','.json','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.','https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','找不到这本书！','backgroundImage','错误：找不到要转发的原始动态。','++id,\x20type,\x20timestamp,\x20originalTimestamp','reading-restore-btn','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','table','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','predicate\x20must\x20be\x20a\x20function','确定切换','isGroup','onerror','.qzone-post-container[data-post-id=\x22','annoId','startY','文字已更新！','所有狼人已被放逐，好人阵营获得了胜利！','devicePixelRatio','manage-sticker-categories-btn','prompts','timeZone','.message-wrapper[data-timestamp]','input[name=\x22variation-select\x22]:checked','.music-player-window','从角色卡导入\x20(.json/.png)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20','div','enable-tts-switch','<s>$1</s>','后台活动模拟已启动，间隔:\x20','artistName','textarea','lastIndex','导演模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','窝爱泥，电量吃饱饱','请先从下拉框中选择一个要删除的预设。','remove-member-btn','AI返回的数据不是一个数组。原始返回:\x20','请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>','currentPlayer','clear-posts-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','transfer-cancel-btn','danger-option','#avatar-frame-modal\x20.frame-tabs','#settings-preview-area','sendQzoneStickerComment:\x20找不到帖子:','close-receipt-btn','toLocaleTimeString','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20','gomoku-board'];_0x1f49=function(){return _0x23cea8;};return _0x1f49();}function getRandomValue(_0x47300d){const _0xc8d7d6=_0x3449ff;if(_0x47300d[_0xc8d7d6(0x930)](',')){const _0x474de0=_0x47300d[_0xc8d7d6(0x6c6)](',')[_0xc8d7d6(0xa3b)](_0x4d9cb7=>_0x4d9cb7[_0xc8d7d6(0x3f1)]()),_0x16bb32=Math[_0xc8d7d6(0x5fb)](Math[_0xc8d7d6(0x360)]()*_0x474de0[_0xc8d7d6(0xa06)]);return _0x474de0[_0x16bb32];}return _0x47300d;}function isImage(_0x1c42a2){const _0x5d5b47=_0x3449ff;if(_0x1c42a2[_0x5d5b47(0x96f)]&&_0x1c42a2['image_url']['url']){let _0xe01b83=_0x1c42a2['image_url']['url'];const _0x4ef5ea=_0xe01b83[_0x5d5b47(0x6c6)](',')[0x1],_0x859209=_0xe01b83[_0x5d5b47(0x12c2)](/^data:(.*);base64/)[0x1];return[{'text':_0x5d5b47(0x134c)},{'inline_data':{'mime_type':_0x859209,'data':_0x4ef5ea}}];}return[];}function getGeminiResponseText(_0x5a8195){const _0x2807a7=_0x3449ff;if(_0x5a8195[_0x2807a7(0xfd2)]&&Array[_0x2807a7(0xb27)](_0x5a8195[_0x2807a7(0xfd2)])&&_0x5a8195[_0x2807a7(0xfd2)][_0x2807a7(0xa06)]>0x0&&_0x5a8195['choices'][0x0][_0x2807a7(0x86e)]&&_0x5a8195[_0x2807a7(0xfd2)][0x0][_0x2807a7(0x86e)][_0x2807a7(0x53b)])return _0x5a8195[_0x2807a7(0xfd2)][0x0]['message'][_0x2807a7(0x53b)];if(_0x5a8195[_0x2807a7(0xbd6)]&&Array[_0x2807a7(0xb27)](_0x5a8195[_0x2807a7(0xbd6)])&&_0x5a8195['candidates']['length']>0x0&&_0x5a8195[_0x2807a7(0xbd6)][0x0][_0x2807a7(0x53b)]&&_0x5a8195['candidates'][0x0][_0x2807a7(0x53b)]['parts'])return _0x5a8195[_0x2807a7(0xbd6)][0x0][_0x2807a7(0x53b)][_0x2807a7(0xc6b)][0x0][_0x2807a7(0xbb7)];console['error']('Gemini\x20API返回了非预期的格式:',_0x5a8195);let _0x1eadae='AI返回了空内容或未知格式。';if(_0x5a8195[_0x2807a7(0xbd6)]&&Array[_0x2807a7(0xb27)](_0x5a8195[_0x2807a7(0xbd6)])&&_0x5a8195[_0x2807a7(0xbd6)]['length']>0x0&&_0x5a8195[_0x2807a7(0xbd6)][0x0]['finishReason']===_0x2807a7(0x1327)){const _0x440c23=_0x5a8195['candidates'][0x0][_0x2807a7(0x1c2)],_0x2bf814=_0x440c23[_0x2807a7(0x401)](_0x3bb8d8=>_0x3bb8d8[_0x2807a7(0xb31)]!==_0x2807a7(0x850)&&_0x3bb8d8['probability']!==_0x2807a7(0x259))[_0x2807a7(0xa3b)](_0x5179e8=>_0x5179e8[_0x2807a7(0xf08)]+_0x2807a7(0x441)+_0x5179e8[_0x2807a7(0xb31)]+')')[_0x2807a7(0x809)](',\x20');_0x1eadae=_0x2807a7(0x1323)+(_0x2bf814||'未知');}else{if(_0x5a8195[_0x2807a7(0xfaf)]?.[_0x2807a7(0xc33)]){const _0xb0715f=_0x5a8195[_0x2807a7(0xfaf)]['blockReason'],_0x3b6b7b=_0x5a8195[_0x2807a7(0xfaf)][_0x2807a7(0x1c2)]?.['map'](_0x272ed0=>_0x272ed0[_0x2807a7(0xf08)]+':\x20'+_0x272ed0[_0x2807a7(0xb31)])[_0x2807a7(0x809)](',\x20');_0x1eadae=_0x2807a7(0x12d2)+_0xb0715f+_0x2807a7(0xca8)+(_0x3b6b7b||'无');}else _0x5a8195[_0x2807a7(0x1221)]&&(_0x1eadae=_0x2807a7(0x1160)+_0x5a8195[_0x2807a7(0x1221)][_0x2807a7(0x86e)]);}throw new Error(_0x1eadae);}document[_0x3449ff(0xa0f)](_0x3449ff(0x72c),()=>{const _0x419fa8=_0x3449ff;document[_0x419fa8(0xa0f)]('visibilitychange',()=>{const _0xa881d2=_0x419fa8;document[_0xa881d2(0x467)]==='visible'&&(console['log'](_0xa881d2(0xcb2)),navigator[_0xa881d2(0xc42)][_0xa881d2(0x430)][_0xa881d2(0xcd7)](_0x5943fb=>{_0x5943fb['update']();}));});function _0x2e5c04(_0x15b02a,_0x980aff,_0x1df0d2,_0x9d9d16){const _0x5732a7=_0x419fa8,_0x3c113e=_0x9ebf46[_0x5732a7(0x1383)][_0x5732a7(0xc3d)]||0.8,_0xa3d4e3={'user':_0x5732a7(0x586),'assistant':_0x5732a7(0x546),'system':_0x5732a7(0x586)},_0x2595ab=[{'role':_0x5732a7(0x586),'parts':[{'text':_0x1df0d2}]},{'role':_0x5732a7(0x546),'parts':[{'text':_0x5732a7(0x277)}]},..._0x9d9d16[_0x5732a7(0xa3b)](_0x476823=>{const _0x29ad33=_0x5732a7,_0x3a5c1a=[];return Array[_0x29ad33(0xb27)](_0x476823[_0x29ad33(0x53b)])?_0x476823['content'][_0x29ad33(0x591)](_0x3e06da=>{const _0x4ca3d8=_0x29ad33;if(_0x3e06da[_0x4ca3d8(0x12d9)]===_0x4ca3d8(0xbb7))_0x3a5c1a[_0x4ca3d8(0x668)]({'text':_0x3e06da[_0x4ca3d8(0xbb7)]});else{if(_0x3e06da[_0x4ca3d8(0x12d9)]===_0x4ca3d8(0x96f)&&_0x3e06da[_0x4ca3d8(0x96f)]&&_0x3e06da['image_url'][_0x4ca3d8(0x11be)]){const _0x21b6e4=_0x3e06da[_0x4ca3d8(0x96f)][_0x4ca3d8(0x11be)],_0x3a1639=_0x21b6e4[_0x4ca3d8(0x6c6)](',')[0x1],_0x188908=_0x21b6e4['match'](/^data:(.*);base64/);_0x188908&&_0x3a1639&&_0x3a5c1a['push']({'inline_data':{'mime_type':_0x188908[0x1],'data':_0x3a1639}});}}}):_0x3a5c1a[_0x29ad33(0x668)]({'text':String(_0x476823['content'])}),{'role':_0xa3d4e3[_0x476823[_0x29ad33(0x7fd)]],'parts':_0x3a5c1a};})];return{'url':_0x5732a7(0x955)+_0x15b02a+_0x5732a7(0x270)+getRandomValue(_0x980aff),'data':{'method':'POST','headers':{'Content-Type':_0x5732a7(0x698)},'body':JSON['stringify']({'contents':_0x2595ab,'generationConfig':{'temperature':_0x3c113e}})}};}const _0x2c5bcf=new Dexie(_0x419fa8(0x7ca)),_0x4f4f26=[{'id':_0x419fa8(0x8f6),'url':'','name':'无'},{'id':_0x419fa8(0xbfa),'url':_0x419fa8(0x597),'name':'1'},{'id':_0x419fa8(0x779),'url':_0x419fa8(0xabf),'name':'2'},{'id':_0x419fa8(0x9ca),'url':_0x419fa8(0xa41),'name':'3'},{'id':'frame_tech','url':'https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','name':'4'},{'id':'frame_5','url':_0x419fa8(0xdf3),'name':'5'},{'id':_0x419fa8(0xe0e),'url':'https://i.postimg.cc/63sDQKMm/IMG-6893.gif','name':'6'},{'id':'frame_7','url':_0x419fa8(0x2f0),'name':'7'},{'id':_0x419fa8(0x942),'url':_0x419fa8(0x551),'name':'8'},{'id':_0x419fa8(0xd70),'url':'https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','name':'9'},{'id':_0x419fa8(0x9f0),'url':_0x419fa8(0xdd1),'name':'10'},{'id':_0x419fa8(0xccd),'url':_0x419fa8(0x12c3),'name':'11'},{'id':_0x419fa8(0x10b4),'url':_0x419fa8(0x848),'name':'12'},{'id':'frame_13','url':'https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','name':'13'},{'id':'frame_14','url':_0x419fa8(0x1345),'name':'14'},{'id':_0x419fa8(0xbfa),'url':_0x419fa8(0x139e),'name':'1'},{'id':_0x419fa8(0x779),'url':'https://i.postimg.cc/PrcKH436/IMG-4376.gif','name':'2'},{'id':_0x419fa8(0x9ca),'url':_0x419fa8(0x921),'name':'3'},{'id':_0x419fa8(0x27d),'url':'https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','name':'4'},{'id':_0x419fa8(0xd5f),'url':_0x419fa8(0x13b8),'name':'5'},{'id':_0x419fa8(0xe0e),'url':'https://i.postimg.cc/05wnd389/IMG-4388.gif','name':'6'},{'id':'frame_7','url':_0x419fa8(0x2c8),'name':'7'},{'id':_0x419fa8(0x942),'url':_0x419fa8(0x52f),'name':'8'},{'id':'frame_9','url':_0x419fa8(0x1178),'name':'9'},{'id':_0x419fa8(0x9f0),'url':'https://i.postimg.cc/XY63sTS3/IMG-4393.gif','name':'10'},{'id':_0x419fa8(0xccd),'url':'https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif','name':'11'},{'id':_0x419fa8(0x10b4),'url':_0x419fa8(0x950),'name':'12'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x316),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x732),'name':'14'},{'id':_0x419fa8(0xbfa),'url':_0x419fa8(0x1072),'name':'1'},{'id':'frame_ribbon','url':_0x419fa8(0x8d5),'name':'2'},{'id':'frame_flower','url':_0x419fa8(0x604),'name':'3'},{'id':_0x419fa8(0x27d),'url':'https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','name':'4'},{'id':_0x419fa8(0xd5f),'url':_0x419fa8(0x12ce),'name':'5'},{'id':_0x419fa8(0xe0e),'url':_0x419fa8(0x873),'name':'6'},{'id':_0x419fa8(0x1041),'url':_0x419fa8(0x769),'name':'7'},{'id':_0x419fa8(0x942),'url':'https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','name':'8'},{'id':_0x419fa8(0xd70),'url':_0x419fa8(0xce7),'name':'9'},{'id':_0x419fa8(0x9f0),'url':_0x419fa8(0x20c),'name':'10'},{'id':_0x419fa8(0xccd),'url':_0x419fa8(0xd27),'name':'11'},{'id':_0x419fa8(0x10b4),'url':_0x419fa8(0xe6f),'name':'12'},{'id':_0x419fa8(0xdc8),'url':'https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x1285),'name':'14'},{'id':_0x419fa8(0xbfa),'url':_0x419fa8(0x3f3),'name':'1'},{'id':_0x419fa8(0x779),'url':_0x419fa8(0x48f),'name':'2'},{'id':'frame_flower','url':_0x419fa8(0x1b6),'name':'3'},{'id':_0x419fa8(0x27d),'url':_0x419fa8(0x1360),'name':'4'},{'id':_0x419fa8(0xd5f),'url':_0x419fa8(0x7ec),'name':'5'},{'id':_0x419fa8(0xe0e),'url':_0x419fa8(0xd45),'name':'6'},{'id':_0x419fa8(0x1041),'url':_0x419fa8(0xe12),'name':'7'},{'id':_0x419fa8(0x942),'url':'https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','name':'8'},{'id':_0x419fa8(0xd70),'url':_0x419fa8(0x109c),'name':'9'},{'id':_0x419fa8(0x9f0),'url':'https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','name':'10'},{'id':_0x419fa8(0xccd),'url':_0x419fa8(0xb79),'name':'11'},{'id':_0x419fa8(0x10b4),'url':_0x419fa8(0xd3f),'name':'12'},{'id':'frame_13','url':_0x419fa8(0x130e),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x7bb),'name':'14'},{'id':_0x419fa8(0xbfa),'url':_0x419fa8(0x13ad),'name':'1'},{'id':'frame_ribbon','url':_0x419fa8(0x10bd),'name':'2'},{'id':_0x419fa8(0x9ca),'url':_0x419fa8(0x599),'name':'3'},{'id':'frame_tech','url':_0x419fa8(0x739),'name':'4'},{'id':_0x419fa8(0xd5f),'url':_0x419fa8(0x82a),'name':'5'},{'id':_0x419fa8(0xe0e),'url':_0x419fa8(0xad8),'name':'6'},{'id':_0x419fa8(0x1041),'url':_0x419fa8(0x5cf),'name':'7'},{'id':_0x419fa8(0x942),'url':_0x419fa8(0xa3f),'name':'8'},{'id':_0x419fa8(0xd70),'url':_0x419fa8(0xc3a),'name':'9'},{'id':_0x419fa8(0x9f0),'url':_0x419fa8(0x941),'name':'10'},{'id':'frame_11','url':'https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','name':'12'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x3a9),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xe3d),'name':'14'},{'id':'frame_cat_ear','url':_0x419fa8(0x119d),'name':'1'},{'id':'frame_ribbon','url':_0x419fa8(0x9fd),'name':'2'},{'id':_0x419fa8(0x9ca),'url':_0x419fa8(0x9fd),'name':'3'},{'id':'frame_tech','url':'https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','name':'4'},{'id':_0x419fa8(0xd5f),'url':_0x419fa8(0x379),'name':'5'},{'id':_0x419fa8(0xe0e),'url':_0x419fa8(0x728),'name':'6'},{'id':_0x419fa8(0x1041),'url':'https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','name':'7'},{'id':_0x419fa8(0x942),'url':_0x419fa8(0x825),'name':'8'},{'id':_0x419fa8(0xd70),'url':'https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','name':'9'},{'id':_0x419fa8(0x9f0),'url':_0x419fa8(0xd2e),'name':'10'},{'id':_0x419fa8(0xccd),'url':_0x419fa8(0x202),'name':'11'},{'id':_0x419fa8(0x10b4),'url':_0x419fa8(0x53f),'name':'12'},{'id':'frame_13','url':'https://i.postimg.cc/1zmcp66p/IMG-5973.gif','name':'13'},{'id':'frame_14','url':_0x419fa8(0xf4c),'name':'14'},{'id':_0x419fa8(0xbfa),'url':_0x419fa8(0x516),'name':'1'},{'id':_0x419fa8(0x779),'url':'https://i.postimg.cc/9fQZ425b/IMG-5975.gif','name':'2'},{'id':_0x419fa8(0x9ca),'url':_0x419fa8(0xa7b),'name':'3'},{'id':_0x419fa8(0x27d),'url':'https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','name':'4'},{'id':_0x419fa8(0xd5f),'url':_0x419fa8(0x2b9),'name':'5'},{'id':_0x419fa8(0xe0e),'url':_0x419fa8(0x492),'name':'6'},{'id':'frame_7','url':_0x419fa8(0x7d2),'name':'7'},{'id':_0x419fa8(0x942),'url':_0x419fa8(0x12ae),'name':'8'},{'id':_0x419fa8(0xd70),'url':_0x419fa8(0x11c7),'name':'9'},{'id':_0x419fa8(0x9f0),'url':_0x419fa8(0x1051),'name':'10'},{'id':_0x419fa8(0xccd),'url':'https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','name':'11'},{'id':_0x419fa8(0x10b4),'url':'https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','name':'12'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0xb5a),'name':'13'},{'id':'frame_14','url':_0x419fa8(0xf6e),'name':'14'},{'id':_0x419fa8(0xbfa),'url':_0x419fa8(0x996),'name':'1'},{'id':_0x419fa8(0x779),'url':_0x419fa8(0x1164),'name':'2'},{'id':_0x419fa8(0x9ca),'url':_0x419fa8(0x9b1),'name':'3'},{'id':'frame_tech','url':_0x419fa8(0x590),'name':'4'},{'id':_0x419fa8(0xd5f),'url':'https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','name':'5'},{'id':_0x419fa8(0xe0e),'url':_0x419fa8(0x1398),'name':'6'},{'id':_0x419fa8(0x1041),'url':'https://i.postimg.cc/gkhf597g/IMG-6555.gif','name':'7'},{'id':'frame_8','url':_0x419fa8(0x1265),'name':'8'},{'id':_0x419fa8(0xd70),'url':'https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','name':'9'},{'id':_0x419fa8(0x9f0),'url':'https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','name':'10'},{'id':_0x419fa8(0xccd),'url':_0x419fa8(0x675),'name':'11'},{'id':_0x419fa8(0x10b4),'url':_0x419fa8(0xb1a),'name':'12'},{'id':_0x419fa8(0xdc8),'url':'https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xc39),'name':'14'},{'id':_0x419fa8(0xbfa),'url':_0x419fa8(0xa86),'name':'1'},{'id':_0x419fa8(0x779),'url':_0x419fa8(0xa73),'name':'2'},{'id':_0x419fa8(0x9ca),'url':'https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','name':'3'},{'id':'frame_tech','url':_0x419fa8(0x91f),'name':'4'},{'id':_0x419fa8(0xd5f),'url':_0x419fa8(0x264),'name':'5'},{'id':_0x419fa8(0xe0e),'url':_0x419fa8(0x671),'name':'6'},{'id':_0x419fa8(0x1041),'url':_0x419fa8(0x57e),'name':'7'},{'id':_0x419fa8(0x942),'url':'https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','name':'8'},{'id':_0x419fa8(0xd70),'url':_0x419fa8(0xa1e),'name':'9'},{'id':_0x419fa8(0x9f0),'url':_0x419fa8(0x7e3),'name':'10'},{'id':_0x419fa8(0xccd),'url':_0x419fa8(0x1258),'name':'11'},{'id':_0x419fa8(0x10b4),'url':_0x419fa8(0x1318),'name':'12'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x10ea),'name':'13'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','name':'14'},{'id':_0x419fa8(0xbfa),'url':_0x419fa8(0x2ea),'name':'1'},{'id':_0x419fa8(0x779),'url':_0x419fa8(0x6e4),'name':'2'},{'id':_0x419fa8(0x9ca),'url':'https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','name':'3'},{'id':_0x419fa8(0x27d),'url':'https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','name':'4'},{'id':'frame_5','url':_0x419fa8(0x6e5),'name':'5'},{'id':_0x419fa8(0xe0e),'url':_0x419fa8(0x721),'name':'6'},{'id':_0x419fa8(0x1041),'url':_0x419fa8(0x6b0),'name':'7'},{'id':_0x419fa8(0x942),'url':_0x419fa8(0xe80),'name':'8'},{'id':_0x419fa8(0xd70),'url':_0x419fa8(0x5b1),'name':'9'},{'id':_0x419fa8(0x9f0),'url':_0x419fa8(0xf1a),'name':'10'},{'id':_0x419fa8(0xccd),'url':'https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','name':'11'},{'id':_0x419fa8(0x10b4),'url':_0x419fa8(0xcd0),'name':'12'},{'id':'frame_13','url':_0x419fa8(0xd76),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x1143),'name':'14'},{'id':'frame_11','url':'https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','name':'11'},{'id':_0x419fa8(0x10b4),'url':_0x419fa8(0x6c4),'name':'12'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x1f8),'name':'13'},{'id':'frame_14','url':_0x419fa8(0x5ef),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/43PhvxRq/IMG-6922.gif','name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xd5c),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x5a9),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xbb8),'name':'14'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x12e9),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x7c7),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xe4a),'name':'14'},{'id':'frame_12','url':_0x419fa8(0x6ec),'name':'12'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0xcc7),'name':'13'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','name':'14'},{'id':_0x419fa8(0xdc8),'url':'https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xa4d),'name':'14'},{'id':_0x419fa8(0xdc8),'url':'https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','name':'13'},{'id':'frame_14','url':_0x419fa8(0x319),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x1069),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x1210),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xab7),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xdd9),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x2cd),'name':'13'},{'id':'frame_14','url':_0x419fa8(0x12f2),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xe99),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xfd1),'name':'14'},{'id':_0x419fa8(0xdc8),'url':'https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x20f),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x12aa),'name':'14'},{'id':_0x419fa8(0xdc8),'url':'https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x9e2),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xc5d),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x1188),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x7d1),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x1092),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xf55),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x7f1),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x11c0),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x21b),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0xd9d),'name':'13'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','name':'14'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','name':'14'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x1242),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xe82),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x534),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xc80),'name':'14'},{'id':'frame_14','url':_0x419fa8(0x526),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x104c),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x11c1),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x416),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xe3b),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0xe44),'name':'13'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xcce),'name':'14'},{'id':'frame_14','url':_0x419fa8(0x6cc),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x5c6),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xa22),'name':'14'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0xe27),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xc68),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x8f5),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x12c4),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0xa05),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xd9e),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xd8c),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x55a),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x2e8),'name':'14'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x7cb),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0xf62),'name':'13'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/yx2m4nbs/IMG-7231.gif','name':'14'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif','name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x97c),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x11c4),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xc59),'name':'14'},{'id':'frame_14','url':_0x419fa8(0x294),'name':'14'},{'id':'frame_13','url':_0x419fa8(0x8be),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x10af),'name':'14'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif','name':'14'},{'id':_0x419fa8(0xdc8),'url':'https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xc99),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/fyyGgW61/IMG-7115.gif','name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x1121),'name':'14'},{'id':'frame_13','url':_0x419fa8(0x772),'name':'13'},{'id':'frame_14','url':_0x419fa8(0x6d7),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x679),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x936),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x13cb),'name':'14'},{'id':'frame_14','url':_0x419fa8(0x13d2),'name':'14'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/FzqHTBng/IMG-7093.gif','name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','name':'13'},{'id':_0x419fa8(0x3f7),'url':'https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xd0d),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x5f6),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x872),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x2b0),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x959),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0xbdb),'name':'13'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x1148),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0x11d7),'name':'14'},{'id':_0x419fa8(0xdc8),'url':_0x419fa8(0x243),'name':'13'},{'id':'frame_14','url':_0x419fa8(0xc56),'name':'14'},{'id':_0x419fa8(0x3f7),'url':_0x419fa8(0xb32),'name':'14'}];let _0x9ebf46={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map()},_0x1c1d43={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':_0x419fa8(0xb4f),'nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0x3e7d67=0x0;const _0x24712c=0xf;let _0xca834d=0x0;const _0xe60733=0xa;let _0x20f1b5=[],_0x5062a9={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':_0x419fa8(0x26e),'totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0x15329b={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x287389=document[_0x419fa8(0x9c8)](_0x419fa8(0x227));let _0x3d4f7d=null,_0x38ba45=![],_0x512a95=0x0,_0x47adf6=null,_0xb426e=![],_0x55c803=_0x419fa8(0xd0a),_0x24fb08=new Set(),_0x57617b=null,_0x2cf21d=![],_0x56f504=null,_0x541f35=null,_0x5daaec=![],_0x836281=![],_0x18bae1=![],_0x3d4398=![],_0x6e5b5a=[],_0x5d5bad=null,_0x309858=null,_0xdea4f7={},_0x1f2a43=null,_0x141b83=null,_0xde3ba7=null,_0x78520f=null,_0x246cff=null,_0x118ea3=null,_0xb8e4f0=null,_0x220929=[],_0x51315e=null,_0x2c1895=null,_0x524d97=new Set(),_0x370f8c=null,_0x52f277=null,_0x457a2a=null,_0x5daebe={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x776068=0x0,_0x24371e=![],_0x1fb797=new Set(),_0x3c8875=null;const _0x246753=_0x419fa8(0xce5),_0x1d990b=_0x419fa8(0xccb),_0x337c8f='https://i.postimg.cc/VkQfgzGJ/1.jpg',_0x5d7a94=_0x419fa8(0x957);let _0x5cf886,_0x45cf77={};const _0x178a2b=_0x419fa8(0x4ba);let _0x434409={},_0x57f4a4={},_0x305799=null;const _0x3949d8={'qq':_0x419fa8(0x1243),'world-book':'https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','wallpaper':'https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','renderer':'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','api-settings':_0x419fa8(0x6c8),'font':_0x419fa8(0xcb5),'char-phone':_0x419fa8(0xa0b),'douban':'https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','preset':_0x419fa8(0xe90),'tutorial':_0x419fa8(0xbd0),'werewolf':_0x419fa8(0xbf3),'x':_0x419fa8(0x1fb)},_0x20bbe1={'qq':_0x419fa8(0x1243),'album':_0x419fa8(0x67a),'browser':_0x419fa8(0x47e),'taobao':'https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','memo':_0x419fa8(0x8d4),'diary':_0x419fa8(0xc4e),'amap':_0x419fa8(0xc32),'usage':'https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','music':_0x419fa8(0x266),'ephone':_0x419fa8(0xa0b)};let _0x19e608=null;const _0x2d389f=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0x2200fe=0x0,_0x17befd=0x1,_0x40fe0a={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0xe54e94;const _0x471902=document['createElement'](_0x419fa8(0x5e1));_0x471902['id']='dynamic-font-style',document[_0x419fa8(0x37a)]['appendChild'](_0x471902);const _0x2e0a29=document['getElementById'](_0x419fa8(0xab3)),_0x1b2bf5=document[_0x419fa8(0x9c8)](_0x419fa8(0x53a)),_0x2004da=document[_0x419fa8(0x9c8)](_0x419fa8(0x550)),_0x354a97=document[_0x419fa8(0x9c8)](_0x419fa8(0x552)),_0x3c17f7=document[_0x419fa8(0x9c8)](_0x419fa8(0xb89));let _0xbc293f;function _0x1f9e41(){const _0x53d224=_0x419fa8;_0x2e0a29[_0x53d224(0x575)]['add']('visible');}function _0x1dc9df(){const _0x55de88=_0x419fa8;_0x2e0a29[_0x55de88(0x575)]['remove']('visible'),_0x354a97[_0x55de88(0x575)][_0x55de88(0x30f)](_0x55de88(0x12bc));if(_0xbc293f)_0xbc293f(null);}function _0x3eb3d2(_0x3a836d){const _0x4ec167=_0x419fa8,_0x6fef80=document['getElementById'](_0x4ec167(0x8b1)),_0x38ddb0=_0x3a836d['settings'][_0x4ec167(0xd55)]||{'vertical':_0x4ec167(0x114a),'horizontal':_0x4ec167(0x9f7),'offset':0xa};_0x6fef80['style'][_0x4ec167(0x114a)]='auto',_0x6fef80[_0x4ec167(0x5e1)][_0x4ec167(0x40f)]=_0x4ec167(0x4ee),_0x6fef80[_0x4ec167(0x5e1)][_0x4ec167(0x12b6)]=_0x4ec167(0x4ee),_0x6fef80[_0x4ec167(0x5e1)]['right']='auto',_0x6fef80['style']['transform']='none';_0x38ddb0['vertical']==='top'?_0x6fef80['style'][_0x4ec167(0x114a)]=_0x38ddb0[_0x4ec167(0x1007)]+'px':_0x6fef80[_0x4ec167(0x5e1)]['bottom']=_0x38ddb0[_0x4ec167(0x1007)]+'px';switch(_0x38ddb0[_0x4ec167(0xca6)]){case _0x4ec167(0x12b6):_0x6fef80[_0x4ec167(0x5e1)][_0x4ec167(0x12b6)]=_0x4ec167(0xca5);break;case _0x4ec167(0x4d0):_0x6fef80['style'][_0x4ec167(0x4d0)]=_0x4ec167(0xca5);break;case'center':default:_0x6fef80['style'][_0x4ec167(0x12b6)]=_0x4ec167(0x43e),_0x6fef80[_0x4ec167(0x5e1)][_0x4ec167(0xf57)]='translateX(-50%)';break;}}async function _0x15ab92(_0x2c56f8){const _0x3cf521=_0x419fa8,_0x5d2f06=_0x2c56f8[_0x3cf521(0x1070)][_0x3cf521(0x1216)][0x0];if(!_0x5d2f06)return;const _0x1f5f96=await new Promise(_0x20b7b8=>{const _0xeb46d4=_0x3cf521,_0x3194cf=new FileReader();_0x3194cf['onload']=()=>_0x20b7b8(_0x3194cf[_0xeb46d4(0xceb)]),_0x3194cf[_0xeb46d4(0xba5)](_0x5d2f06);});await _0x1bff53(_0x3cf521(0x7a4),_0x3cf521(0xc7d));try{const _0xf4e82=await _0x3d3471(_0x1f5f96);if(!_0xf4e82)throw new Error('AI未能成功描述图片。');const _0xd46769=_0x9ebf46[_0x3cf521(0x547)][_0x9ebf46['activeChatId']];!_0xd46769['settings'][_0x3cf521(0xd86)]&&(_0xd46769[_0x3cf521(0x1131)][_0x3cf521(0xd86)]=[]),_0xd46769[_0x3cf521(0x1131)][_0x3cf521(0xd86)][_0x3cf521(0x668)]({'name':_0xf4e82,'url':_0x1f5f96}),await _0x2c5bcf[_0x3cf521(0x547)][_0x3cf521(0xff5)](_0xd46769),_0x365b99(),await _0x1bff53(_0x3cf521(0x1140),_0x3cf521(0x75e)+_0xf4e82+'”');}catch(_0x190122){console[_0x3cf521(0x1221)](_0x3cf521(0x1a5),_0x190122),await _0x1bff53(_0x3cf521(0x24d),_0x3cf521(0x51a)+_0x190122[_0x3cf521(0x86e)]);}finally{_0x2c56f8[_0x3cf521(0x1070)][_0x3cf521(0x1155)]=null;}}async function _0x8e82fc(_0x9b6f1b){const _0x224d7d=_0x419fa8,_0x13c0cd=_0x9b6f1b[_0x224d7d(0x1070)][_0x224d7d(0x1216)][0x0];if(!_0x13c0cd)return;const _0x1175ed=await new Promise(_0x38bb28=>{const _0x4503d5=_0x224d7d,_0x54428e=new FileReader();_0x54428e[_0x4503d5(0x429)]=()=>_0x38bb28(_0x54428e['result']),_0x54428e[_0x4503d5(0xba5)](_0x13c0cd);});await _0x1bff53(_0x224d7d(0x7a4),_0x224d7d(0x123e));try{const _0x186407=await _0x3d3471(_0x1175ed);if(!_0x186407)throw new Error(_0x224d7d(0xdf5));const _0x36514b=_0x9ebf46['chats'][_0x9ebf46[_0x224d7d(0x970)]];!_0x36514b['settings'][_0x224d7d(0x295)]&&(_0x36514b[_0x224d7d(0x1131)][_0x224d7d(0x295)]=[]),_0x36514b[_0x224d7d(0x1131)]['aiAvatarLibrary'][_0x224d7d(0x668)]({'name':_0x186407,'url':_0x1175ed}),await _0x2c5bcf[_0x224d7d(0x547)][_0x224d7d(0xff5)](_0x36514b),_0x1386b6(),await _0x1bff53(_0x224d7d(0x1140),_0x224d7d(0x66e)+_0x186407+'”');}catch(_0x2d654a){console[_0x224d7d(0x1221)](_0x224d7d(0xc40),_0x2d654a),await _0x1bff53(_0x224d7d(0x24d),'无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20'+_0x2d654a['message']);}finally{_0x9b6f1b[_0x224d7d(0x1070)][_0x224d7d(0x1155)]=null;}}async function _0x3d3471(_0x31041e){const _0x16a971=_0x419fa8,_0x1f0170=_0x9ebf46[_0x16a971(0x4de)][_0x16a971(0x797)]&&_0x9ebf46[_0x16a971(0x4de)][_0x16a971(0xc0c)]&&_0x9ebf46[_0x16a971(0x4de)][_0x16a971(0x62f)],{proxyUrl:_0x4566c5,apiKey:_0x32cfe6,model:_0x56b88b}=_0x1f0170?{'proxyUrl':_0x9ebf46[_0x16a971(0x4de)][_0x16a971(0x797)],'apiKey':_0x9ebf46[_0x16a971(0x4de)]['secondaryApiKey'],'model':_0x9ebf46['apiConfig'][_0x16a971(0x62f)]}:_0x9ebf46[_0x16a971(0x4de)];if(!_0x4566c5||!_0x32cfe6||!_0x56b88b)throw new Error(_0x16a971(0xa54));const _0x1df9d4=_0x16a971(0x374);let _0x9f22af=_0x4566c5[_0x16a971(0x930)](_0x16a971(0xb23)),_0x3e7533;if(_0x9f22af){const _0x51fcd2=_0x31041e[_0x16a971(0x12c2)](/^data:(.*);base64/)[0x1],_0x10433c=_0x31041e[_0x16a971(0x6c6)](',')[0x1],_0x135067={'contents':[{'parts':[{'text':_0x1df9d4},{'inline_data':{'mime_type':_0x51fcd2,'data':_0x10433c}}]}]};_0x3e7533=await fetch(_0x4566c5+'/'+_0x56b88b+_0x16a971(0x270)+_0x32cfe6,{'method':_0x16a971(0x116f),'headers':{'Content-Type':_0x16a971(0x698)},'body':JSON['stringify'](_0x135067)});}else{const _0x44b6f2={'model':_0x56b88b,'messages':[{'role':'user','content':[{'type':'text','text':_0x1df9d4},{'type':_0x16a971(0x96f),'image_url':{'url':_0x31041e}}]}],'max_tokens':0x32};_0x3e7533=await fetch(_0x4566c5+_0x16a971(0x1090),{'method':_0x16a971(0x116f),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x32cfe6},'body':JSON[_0x16a971(0xf1e)](_0x44b6f2)});}if(!_0x3e7533['ok']){const _0x4ccbd7=await _0x3e7533[_0x16a971(0x5dd)]();throw new Error('API\x20错误:\x20'+_0x4ccbd7[_0x16a971(0x1221)][_0x16a971(0x86e)]);}const _0x1b0c38=await _0x3e7533[_0x16a971(0x5dd)]();let _0x5afb0f=_0x9f22af?getGeminiResponseText(_0x1b0c38):_0x1b0c38[_0x16a971(0xfd2)][0x0][_0x16a971(0x86e)]['content'];return _0x5afb0f[_0x16a971(0x3f1)]()['replace'](/["'“”‘’]/g,'');}async function _0x5eaa16(_0x5646ad){const _0x269577=_0x419fa8;if(!_0x5646ad||_0x5646ad[_0x269577(0x11e4)]){console[_0x269577(0x453)](_0x269577(0xc6f));return;}const _0x31006b=_0x5646ad['id'],_0x261507=_0x5646ad[_0x269577(0x609)],_0x1c2f99=_0x5646ad[_0x269577(0x1071)];console[_0x269577(0x283)]('正在为角色\x20'+_0x31006b+'\x20同步所有群聊内的名称信息...');for(const _0x4c9556 in _0x9ebf46['chats']){const _0x501592=_0x9ebf46['chats'][_0x4c9556];if(_0x501592[_0x269577(0x11e4)]&&_0x501592['members']){const _0x50ba0a=_0x501592[_0x269577(0xd3e)][_0x269577(0xfc3)](_0x395b02=>_0x395b02['id']===_0x31006b);if(_0x50ba0a){let _0x57949f=![];_0x50ba0a['groupNickname']!==_0x261507&&(_0x50ba0a['groupNickname']=_0x261507,_0x57949f=!![]),_0x50ba0a[_0x269577(0x1071)]!==_0x1c2f99&&(_0x50ba0a[_0x269577(0x1071)]=_0x1c2f99,_0x57949f=!![]),_0x57949f&&(await _0x2c5bcf[_0x269577(0x547)][_0x269577(0xff5)](_0x501592),console[_0x269577(0x283)]('成功将群聊\x20\x22'+_0x501592['name']+'\x22\x20中的成员信息更新'));}}}}async function _0x177091(_0x217c8e){const _0x322897=_0x419fa8;if(!_0x217c8e||_0x217c8e['isGroup']){console[_0x322897(0x453)](_0x322897(0x796));return;}const _0x1fe97b=_0x217c8e['id'],_0x134dd1=_0x217c8e[_0x322897(0x1131)]['aiAvatar'];console[_0x322897(0x283)]('正在为角色\x20'+_0x1fe97b+'\x20同步所有群聊内的头像...');for(const _0x35709c of Object[_0x322897(0xeb2)](_0x9ebf46[_0x322897(0x547)])){if(_0x35709c[_0x322897(0x11e4)]&&_0x35709c[_0x322897(0xd3e)]){const _0x4b12ce=_0x35709c['members']['find'](_0x2d6563=>_0x2d6563['id']===_0x1fe97b);_0x4b12ce&&_0x4b12ce[_0x322897(0x10c9)]!==_0x134dd1&&(_0x4b12ce[_0x322897(0x10c9)]=_0x134dd1,await _0x2c5bcf[_0x322897(0x547)][_0x322897(0xff5)](_0x35709c),console[_0x322897(0x283)](_0x322897(0xd90)+_0x1fe97b+_0x322897(0x74e)+_0x35709c[_0x322897(0x609)]+'\x22'));}}}function _0x227896(_0x17efe9,_0x1228e3){const _0x21f25b=_0x419fa8;if(!_0x17efe9||!_0x17efe9[_0x21f25b(0x11e4)]||!_0x1228e3)return _0x1228e3;const _0x2394da=_0x9ebf46[_0x21f25b(0x32c)][_0x21f25b(0x5b7)]||_0x21f25b(0x5c1);if(_0x1228e3===_0x2394da)return _0x17efe9[_0x21f25b(0x1131)][_0x21f25b(0x29c)]||'我';const _0x2fd2ed=_0x17efe9['members'][_0x21f25b(0xfc3)](_0x3bde74=>_0x3bde74[_0x21f25b(0x1071)]===_0x1228e3);return _0x2fd2ed?_0x2fd2ed[_0x21f25b(0x1132)]:_0x1228e3;}function _0x3d9f29(_0x343001){const _0x4cfb60=_0x419fa8;document[_0x4cfb60(0x7e4)]('.rules-tab')[_0x4cfb60(0x591)](_0x44ae9d=>{const _0x18358f=_0x4cfb60;_0x44ae9d[_0x18358f(0x575)][_0x18358f(0x1c3)]('active',_0x44ae9d[_0x18358f(0xc9f)][_0x18358f(0x408)]===_0x343001);}),document['querySelectorAll'](_0x4cfb60(0x7af))[_0x4cfb60(0x591)](_0xbe93c7=>{const _0x5fa7b1=_0x4cfb60;_0xbe93c7[_0x5fa7b1(0x575)][_0x5fa7b1(0x1c3)](_0x5fa7b1(0x113d),_0xbe93c7[_0x5fa7b1(0xc9f)][_0x5fa7b1(0x408)]===_0x343001);});}function _0x1dfc4e(_0x1d032e){const _0x1f1d68=_0x419fa8;if(!_0x1d032e)return'';if(_0x9ebf46[_0x1f1d68(0x32c)]&&_0x1d032e===_0x9ebf46[_0x1f1d68(0x32c)]['nickname'])return _0x9ebf46[_0x1f1d68(0x32c)]['nickname'];let _0x57b321=Object['values'](_0x9ebf46[_0x1f1d68(0x547)])[_0x1f1d68(0xfc3)](_0x524944=>!_0x524944[_0x1f1d68(0x11e4)]&&_0x524944['originalName']===_0x1d032e);if(_0x57b321)return _0x57b321[_0x1f1d68(0x609)];_0x57b321=Object[_0x1f1d68(0xeb2)](_0x9ebf46[_0x1f1d68(0x547)])[_0x1f1d68(0xfc3)](_0x741216=>!_0x741216[_0x1f1d68(0x11e4)]&&(_0x741216[_0x1f1d68(0xd4f)]&&_0x741216[_0x1f1d68(0xd4f)]['includes'](_0x1d032e)));if(_0x57b321)return _0x57b321[_0x1f1d68(0x609)];return _0x1d032e;}function _0x742a79(_0x197211,_0x1197fb=null){const _0x248a03=_0x419fa8;if(!_0x197211||typeof _0x197211!==_0x248a03(0xe56)||!_0x197211[_0x248a03(0x930)](_0x248a03(0x3ee)))return _0x197211;return _0x197211[_0x248a03(0x459)](/@\[\[([^\]]+)\]\]/g,(_0x2516a1,_0xd6f1e5)=>{const _0x2aae84=_0x248a03,_0x1b0949=_0xd6f1e5[_0x2aae84(0x3f1)]();let _0x190f0e;return _0x1197fb&&_0x1197fb['isGroup']?_0x190f0e=_0x227896(_0x1197fb,_0x1b0949):_0x190f0e=_0x1dfc4e(_0x1b0949),'@'+_0x190f0e;});}function _0x352ae9(_0x109a61,_0x60b311,_0x5140c0={}){return new Promise(_0x5ba352=>{const _0x1f9185=_0x3569;_0xbc293f=_0x5ba352,_0x1b2bf5['textContent']=_0x109a61,_0x2004da[_0x1f9185(0x2f5)]=_0x1f9185(0x10db)+_0x60b311+_0x1f9185(0x78d);const _0x3b9a84=document[_0x1f9185(0x9c8)](_0x1f9185(0x552)),_0x2f4757=document[_0x1f9185(0x9c8)](_0x1f9185(0xb89));_0x2f4757[_0x1f9185(0x5e1)]['display']='block',_0x3b9a84['textContent']=_0x5140c0['confirmText']||'确定',_0x2f4757[_0x1f9185(0xe24)]=_0x5140c0['cancelText']||'取消',_0x5140c0[_0x1f9185(0xf5d)]?_0x3b9a84[_0x1f9185(0x575)][_0x1f9185(0x68e)](_0x5140c0[_0x1f9185(0xf5d)]):_0x3b9a84[_0x1f9185(0x575)][_0x1f9185(0x30f)](_0x1f9185(0x12bc)),_0x3b9a84[_0x1f9185(0x2fa)]=()=>{_0x5ba352(!![]),_0x1dc9df();},_0x2f4757[_0x1f9185(0x2fa)]=()=>{_0x5ba352(![]),_0x1dc9df();},_0x1f9e41();});}function _0x1bff53(_0x485496,_0x50b6bd){return new Promise(_0x557caa=>{const _0x405ee0=_0x3569;_0xbc293f=_0x557caa,_0x1b2bf5[_0x405ee0(0xe24)]=_0x485496,_0x2004da[_0x405ee0(0x2f5)]=_0x405ee0(0x1022)+_0x50b6bd+_0x405ee0(0x78d);const _0x1297fb=document[_0x405ee0(0x9c8)](_0x405ee0(0x552)),_0x9331f0=document['getElementById']('custom-modal-cancel');_0x9331f0['style'][_0x405ee0(0x3c5)]=_0x405ee0(0x8f6),_0x1297fb['textContent']='好的',_0x1297fb[_0x405ee0(0x2fa)]=()=>{const _0x9ab8b0=_0x405ee0;_0x9331f0[_0x9ab8b0(0x5e1)][_0x9ab8b0(0x3c5)]=_0x9ab8b0(0x3d9),_0x1297fb[_0x9ab8b0(0xe24)]='确定',_0x557caa(!![]),_0x1dc9df();},_0x1f9e41();});}function _0xadb5df(_0x283189,_0x166b25,_0x4ee19c='',_0x2a359b=_0x419fa8(0xbb7),_0xe968aa=''){return new Promise(_0x32ef90=>{const _0x2b3b04=_0x3569;_0xbc293f=_0x32ef90,_0x1b2bf5[_0x2b3b04(0xe24)]=_0x283189;const _0x3e4247=_0x2b3b04(0x1de),_0x43b2df=_0x2a359b===_0x2b3b04(0x11f9)?_0x2b3b04(0x77b)+_0x3e4247+_0x2b3b04(0x676)+_0x166b25+'\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>'+_0x4ee19c+_0x2b3b04(0xd04):_0x2b3b04(0x3fb)+_0x2a359b+_0x2b3b04(0xc66)+_0x3e4247+_0x2b3b04(0x676)+_0x166b25+_0x2b3b04(0x1367)+_0x4ee19c+'\x22>';_0x2004da[_0x2b3b04(0x2f5)]=_0xe968aa+_0x43b2df;const _0x13ecd9=document[_0x2b3b04(0x9c8)](_0x3e4247);_0x2004da[_0x2b3b04(0x7e4)](_0x2b3b04(0xc15))[_0x2b3b04(0x591)](_0x3da674=>{const _0x2c86a3=_0x2b3b04;_0x3da674[_0x2c86a3(0xa0f)](_0x2c86a3(0xf5c),()=>{const _0x415caf=_0x2c86a3,_0x114a18=_0x3da674[_0x415caf(0xc9f)][_0x415caf(0x9bc)];if(_0x114a18)try{const _0x28b9bf=JSON[_0x415caf(0x907)](_0x114a18);_0x13ecd9[_0x415caf(0x1155)]=JSON[_0x415caf(0xf1e)](_0x28b9bf,null,0x2),_0x13ecd9[_0x415caf(0x6fd)]();}catch(_0x4b8199){console[_0x415caf(0x1221)](_0x415caf(0x507),_0x4b8199);}});});const _0x3b5012=document[_0x2b3b04(0x9c8)](_0x2b3b04(0x552)),_0x33060c=document['getElementById'](_0x2b3b04(0xb89));_0x3b5012['onclick']=()=>{const _0x36c761=_0x2b3b04;_0x32ef90(_0x13ecd9[_0x36c761(0x1155)]),_0x1dc9df();},_0x33060c[_0x2b3b04(0x2fa)]=()=>{_0x32ef90(null),_0x1dc9df();},_0x1f9e41(),setTimeout(()=>_0x13ecd9[_0x2b3b04(0x6fd)](),0x64);});}function _0xb8c832(_0x321833,_0x4c73d2){const _0x14c6f9=_0x419fa8;return new Promise(_0x3bf9b9=>{const _0x1724ac=_0x3569,_0x4bec01=document[_0x1724ac(0x9c8)]('custom-modal-overlay'),_0x2b3761=document[_0x1724ac(0x9c8)](_0x1724ac(0x53a)),_0x474ead=document[_0x1724ac(0x9c8)](_0x1724ac(0x550)),_0x3a7dd7=document[_0x1724ac(0x91d)]('#custom-modal\x20.custom-modal-footer');_0x2b3761[_0x1724ac(0xe24)]=_0x321833,_0x474ead[_0x1724ac(0x2f5)]='',_0x3a7dd7[_0x1724ac(0x2f5)]='',_0x3a7dd7[_0x1724ac(0x5e1)][_0x1724ac(0x10d4)]=_0x1724ac(0x730),_0x4c73d2['forEach'](_0x53d4e4=>{const _0x1fcc13=_0x1724ac,_0x33af04=document[_0x1fcc13(0x28a)]('button');_0x33af04[_0x1fcc13(0xe24)]=_0x53d4e4[_0x1fcc13(0xbb7)],_0x33af04[_0x1fcc13(0x2fa)]=()=>{const _0x5614cf=_0x1fcc13;_0x4bec01[_0x5614cf(0x575)][_0x5614cf(0x30f)](_0x5614cf(0xc3f)),_0x3bf9b9(_0x53d4e4['value']);},_0x3a7dd7[_0x1fcc13(0x7b9)](_0x33af04);});const _0x520c53=document['createElement'](_0x1724ac(0x82f));_0x520c53[_0x1724ac(0xe24)]='取消',_0x520c53['style']['marginTop']=_0x1724ac(0x1331),_0x520c53[_0x1724ac(0x5e1)][_0x1724ac(0x6f7)]='8px',_0x520c53[_0x1724ac(0x5e1)][_0x1724ac(0x8e2)]=_0x1724ac(0x1012),_0x520c53[_0x1724ac(0x2fa)]=()=>{const _0x2978b0=_0x1724ac;_0x4bec01[_0x2978b0(0x575)][_0x2978b0(0x30f)](_0x2978b0(0xc3f)),_0x3bf9b9(null);},_0x3a7dd7[_0x1724ac(0x7b9)](_0x520c53),_0x4bec01[_0x1724ac(0x575)][_0x1724ac(0x68e)]('visible');})[_0x14c6f9(0x118f)](()=>{const _0x3c8efd=_0x14c6f9,_0x30be38=document['querySelector'](_0x3c8efd(0xb30));_0x30be38[_0x3c8efd(0x5e1)]['flexDirection']=_0x3c8efd(0xc19),_0x30be38[_0x3c8efd(0x2f5)]=_0x3c8efd(0xcf7),document[_0x3c8efd(0x9c8)](_0x3c8efd(0xb89))[_0x3c8efd(0xa0f)](_0x3c8efd(0xf5c),_0x1dc9df);});}async function _0x1360d2(){const _0x112b61=_0x419fa8,_0x28f550=await _0xb8c832(_0x112b61(0xad0),[{'text':'📁\x20从本地文件\x20(.lrc)','value':_0x112b61(0x621)},{'text':'📋\x20直接粘贴歌词文本','value':_0x112b61(0x450)}]);if(_0x28f550===_0x112b61(0x621))return new Promise(_0x53e818=>{const _0x45e557=_0x112b61,_0x535bc0=document[_0x45e557(0x9c8)]('lrc-upload-input'),_0x4a2155=_0x28e36e=>{const _0x4be5c5=_0x45e557,_0x46874a=_0x28e36e[_0x4be5c5(0x1070)][_0x4be5c5(0x1216)][0x0];if(_0x46874a){const _0x31b753=new FileReader();_0x31b753['onload']=_0x325e20=>_0x53e818(_0x325e20[_0x4be5c5(0x1070)][_0x4be5c5(0xceb)]),_0x31b753[_0x4be5c5(0x11e5)]=()=>_0x53e818(''),_0x31b753[_0x4be5c5(0x3c6)](_0x46874a);}else _0x53e818(null);_0x535bc0[_0x4be5c5(0xc9d)](_0x4be5c5(0x25c),_0x4a2155),_0x535bc0[_0x4be5c5(0x1155)]='';};_0x535bc0['addEventListener'](_0x45e557(0x25c),_0x4a2155,{'once':!![]}),_0x535bc0[_0x45e557(0xf5c)]();});else{if(_0x28f550===_0x112b61(0x450)){const _0x5adf8e=await _0xadb5df(_0x112b61(0x253),_0x112b61(0x788),'','textarea');if(_0x5adf8e){const _0x126acf=_0x5adf8e[_0x112b61(0x459)](/\[/g,'\x0a[')[_0x112b61(0x3f1)]();return _0x126acf;}return _0x5adf8e;}else return null;}}_0x2c5bcf[_0x419fa8(0x977)](0x27)[_0x419fa8(0xe5d)]({'doubanPosts':_0x419fa8(0xd07),'chats':_0x419fa8(0xc28),'apiConfig':_0x419fa8(0xa94),'globalSettings':_0x419fa8(0xeb9),'userStickers':_0x419fa8(0x1222),'worldBooks':_0x419fa8(0x1194),'worldBookCategories':'++id,\x20name','musicLibrary':'&id','personaPresets':'&id','qzoneSettings':_0x419fa8(0xeb9),'qzonePosts':_0x419fa8(0x249),'qzoneAlbums':_0x419fa8(0xc65),'qzonePhotos':_0x419fa8(0xbdf),'favorites':_0x419fa8(0x11db),'qzoneGroups':_0x419fa8(0x469),'memories':'++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','callRecords':_0x419fa8(0x6a8),'shoppingProducts':_0x419fa8(0x1229),'shoppingCategories':_0x419fa8(0x469),'apiPresets':_0x419fa8(0x469),'renderingRules':_0x419fa8(0xb14),'appearancePresets':_0x419fa8(0x125c),'stickerCategories':_0x419fa8(0x469),'customAvatarFrames':_0x419fa8(0x469),'presets':_0x419fa8(0x1194),'presetCategories':_0x419fa8(0x469),'readingLibrary':_0x419fa8(0xb11),'npcs':_0x419fa8(0xeba)})[_0x419fa8(0xcbe)](_0x392c84=>{const _0x4e72c4=_0x419fa8;return _0x392c84[_0x4e72c4(0x11de)]('worldBooks')['toCollection']()['modify'](_0x2ab8cc=>{const _0x107476=_0x4e72c4;if(typeof _0x2ab8cc[_0x107476(0x53b)]===_0x107476(0xe56)&&_0x2ab8cc[_0x107476(0x53b)]['trim']()!=='')_0x2ab8cc[_0x107476(0x53b)]=[{'keys':[],'comment':_0x107476(0x3d7),'content':_0x2ab8cc['content']}];else!Array[_0x107476(0xb27)](_0x2ab8cc[_0x107476(0x53b)])&&(_0x2ab8cc[_0x107476(0x53b)]=[]);_0x2ab8cc['content'][_0x107476(0x591)](_0x54121e=>{const _0x5c838d=_0x107476;typeof _0x54121e[_0x5c838d(0x38a)]===_0x5c838d(0xa20)&&(_0x54121e['enabled']=!![]);});});}),window['db']=_0x2c5bcf;function _0xe5834e(_0x1c84f7){const _0x26abe4=_0x419fa8;_0x1c84f7==='chat-list-screen'&&(window[_0x26abe4(0xaf3)](),_0x55787a(_0x26abe4(0xbc9)));if(_0x1c84f7===_0x26abe4(0x101f))window[_0x26abe4(0xac6)]();if(_0x1c84f7==='wallpaper-screen')window[_0x26abe4(0xc4c)]();if(_0x1c84f7===_0x26abe4(0x3d0))window['renderWorldBookScreenProxy']();if(_0x1c84f7==='x-social-screen')window['renderXSocialScreenProxy']();if(_0x1c84f7==='douban-screen')_0x30f476();document[_0x26abe4(0x7e4)](_0x26abe4(0x2d1))[_0x26abe4(0x591)](_0x40b516=>_0x40b516[_0x26abe4(0x575)][_0x26abe4(0x30f)](_0x26abe4(0x113d)));const _0x479157=document[_0x26abe4(0x9c8)](_0x1c84f7);if(_0x479157)_0x479157[_0x26abe4(0x575)][_0x26abe4(0x68e)]('active');if(_0x1c84f7==='chat-interface-screen')window[_0x26abe4(0x103d)](_0x9ebf46[_0x26abe4(0x970)]);_0x1c84f7===_0x26abe4(0x1077)&&(_0x2b9f7f(),document['getElementById'](_0x26abe4(0xebe))['value']=_0x9ebf46['globalSettings'][_0x26abe4(0x88a)]||'',_0xd42b1c(_0x9ebf46['globalSettings'][_0x26abe4(0x88a)]||'',!![]));}window[_0x419fa8(0x103d)]=()=>{};function _0x55787a(_0x2b51b4){const _0x551cac=_0x419fa8,_0x12da89=document[_0x551cac(0x9c8)](_0x551cac(0x1056)),_0xd27bbf={'messages-view':document['getElementById'](_0x551cac(0xbc9)),'qzone-screen':document[_0x551cac(0x9c8)](_0x551cac(0x81c)),'favorites-view':document[_0x551cac(0x9c8)](_0x551cac(0x71f)),'memories-view':document[_0x551cac(0x9c8)](_0x551cac(0x46a)),'npc-list-view':document[_0x551cac(0x9c8)]('npc-list-view')},_0x170489=document[_0x551cac(0x9c8)]('main-chat-list-header'),_0x1a1b2a=document[_0x551cac(0x9c8)](_0x551cac(0x861));_0x24371e&&document[_0x551cac(0x9c8)](_0x551cac(0x5e3))['click']();Object['values'](_0xd27bbf)[_0x551cac(0x591)](_0x4f9aa2=>_0x4f9aa2['classList'][_0x551cac(0x30f)](_0x551cac(0x113d)));_0xd27bbf[_0x2b51b4]&&_0xd27bbf[_0x2b51b4][_0x551cac(0x575)][_0x551cac(0x68e)](_0x551cac(0x113d));document['querySelectorAll'](_0x551cac(0x129f))[_0x551cac(0x591)](_0x40aa6b=>{const _0x38d250=_0x551cac;_0x40aa6b[_0x38d250(0x575)][_0x38d250(0x1c3)](_0x38d250(0x113d),_0x40aa6b[_0x38d250(0xc9f)][_0x38d250(0x103a)]===_0x2b51b4);});_0x2b51b4===_0x551cac(0xbc9)?(_0x170489[_0x551cac(0x5e1)]['display']='flex',_0x1a1b2a['style'][_0x551cac(0x3c5)]=_0x551cac(0x989)):(_0x170489[_0x551cac(0x5e1)][_0x551cac(0x3c5)]=_0x551cac(0x8f6),_0x1a1b2a[_0x551cac(0x5e1)][_0x551cac(0x3c5)]=_0x551cac(0x8f6));_0x2b51b4!==_0x551cac(0x46a)&&(_0x1056e0['forEach'](_0x59880d=>clearInterval(_0x59880d)),_0x1056e0=[]);switch(_0x2b51b4){case _0x551cac(0x81c):_0xd27bbf['qzone-screen'][_0x551cac(0x5e1)][_0x551cac(0x8e2)]=_0x551cac(0xbea),_0xddb60e(0x0),_0xf26c4f(),_0x2c70a9();break;case'favorites-view':_0xd27bbf[_0x551cac(0x71f)][_0x551cac(0x5e1)]['backgroundColor']=_0x551cac(0x1311),_0x22a029();break;case'messages-view':break;case _0x551cac(0x6d9):_0x102f19();break;}}function _0x4205f6(){const _0x2cb55b=_0x419fa8;console[_0x2cb55b(0x283)](_0x2cb55b(0xfd0));}window['renderXSocialScreenProxy']=_0x4205f6;function _0xf26c4f(){const _0x21d5ad=_0x419fa8;if(_0x9ebf46&&_0x9ebf46['qzoneSettings']){const _0x490e31=_0x9ebf46['qzoneSettings'];document[_0x21d5ad(0x9c8)](_0x21d5ad(0x8b5))['textContent']=_0x490e31[_0x21d5ad(0x5b7)],document['getElementById'](_0x21d5ad(0x50a))[_0x21d5ad(0xbf4)]=_0x490e31[_0x21d5ad(0x10c9)],document[_0x21d5ad(0x9c8)](_0x21d5ad(0x517))[_0x21d5ad(0xbf4)]=_0x490e31[_0x21d5ad(0x73c)];}}window[_0x419fa8(0x3e3)]=_0xf26c4f;async function _0x1a3c11(){const _0x20380e=_0x419fa8;_0x2c5bcf&&_0x9ebf46[_0x20380e(0x32c)]&&await _0x2c5bcf[_0x20380e(0x32c)][_0x20380e(0xff5)](_0x9ebf46['qzoneSettings']);}function _0x12b12c(_0xa73b9d){const _0x17afdc=_0x419fa8;if(!_0xa73b9d)return'';const _0x4a85d4=new Date(),_0x405c4e=new Date(_0xa73b9d),_0x62153a=Math['floor']((_0x4a85d4-_0x405c4e)/0x3e8),_0x3a21e4=Math[_0x17afdc(0x5fb)](_0x62153a/0x3c),_0x162618=Math['floor'](_0x3a21e4/0x3c);if(_0x3a21e4<0x1)return'刚刚';if(_0x3a21e4<0x3c)return _0x3a21e4+_0x17afdc(0x1248);if(_0x162618<0x18)return _0x162618+_0x17afdc(0x95a);const _0x3434aa=_0x405c4e[_0x17afdc(0x10cd)](),_0x4d880c=String(_0x405c4e[_0x17afdc(0x260)]()+0x1)[_0x17afdc(0x3e8)](0x2,'0'),_0x5ee626=String(_0x405c4e['getDate']())['padStart'](0x2,'0'),_0x528feb=String(_0x405c4e['getHours']())[_0x17afdc(0x3e8)](0x2,'0'),_0x47e031=String(_0x405c4e[_0x17afdc(0x3a6)]())[_0x17afdc(0x3e8)](0x2,'0');return _0x4a85d4[_0x17afdc(0x10cd)]()===_0x3434aa?_0x4d880c+'-'+_0x5ee626+'\x20'+_0x528feb+':'+_0x47e031:_0x3434aa+'-'+_0x4d880c+'-'+_0x5ee626+'\x20'+_0x528feb+':'+_0x47e031;}function _0x4bf44e(_0x75600a){const _0x57e664=_0x419fa8,_0x40e6f8=document[_0x57e664(0x91d)](_0x57e664(0x11e6)+_0x75600a['id']+'\x22]'),_0x3654eb=!!_0x40e6f8,_0x462781=_0x3654eb?_0x40e6f8:document['createElement']('div');!_0x3654eb&&(_0x462781[_0x57e664(0x82c)]=_0x57e664(0x742),_0x462781['dataset']['postId']=_0x75600a['id']);const _0x510de4=_0x3654eb?_0x462781[_0x57e664(0x91d)](_0x57e664(0xfd6)):document[_0x57e664(0x28a)]('div');!_0x3654eb&&(_0x510de4[_0x57e664(0x82c)]=_0x57e664(0x87d));let _0xc9615a='',_0x227dc2='',_0x2134ac=_0x9ebf46['qzoneSettings']['avatar'];if(_0x75600a['authorId']===_0x57e664(0x586))_0xc9615a=_0x9ebf46[_0x57e664(0x32c)][_0x57e664(0x10c9)],_0x227dc2=_0x9ebf46[_0x57e664(0x32c)][_0x57e664(0x5b7)];else{if(_0x9ebf46[_0x57e664(0x547)][_0x75600a[_0x57e664(0x61c)]]){const _0x506bb5=_0x9ebf46[_0x57e664(0x547)][_0x75600a[_0x57e664(0x61c)]];_0xc9615a=_0x506bb5['settings'][_0x57e664(0xd4d)]||_0x246753,_0x227dc2=_0x506bb5[_0x57e664(0x609)];}else _0x227dc2=_0x1dfc4e(_0x75600a[_0x57e664(0x12ec)]),_0xc9615a=_0x246753;}function _0x27a66e(_0x5e51bf){const _0x5dbc85=_0x57e664;let _0x37c243='';const _0x512510=_0x5e51bf[_0x5dbc85(0x7b2)]?_0x5dbc85(0x61f)+_0x1ffeeb(_0x5e51bf[_0x5dbc85(0x7b2)])['replace'](/\n/g,'<br>')+_0x5dbc85(0x103c):'';if(_0x5e51bf[_0x5dbc85(0x12d9)]===_0x5dbc85(0x1238))_0x37c243='<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>'+_0x1ffeeb(_0x5e51bf[_0x5dbc85(0x53b)])['replace'](/\n/g,_0x5dbc85(0x10d9))+_0x5dbc85(0x103c);else{if(_0x5e51bf[_0x5dbc85(0x12d9)]===_0x5dbc85(0x55b)&&_0x5e51bf['imageUrl'])_0x37c243=_0x512510?_0x512510+_0x5dbc85(0x8f3)+_0x5e51bf['imageUrl']+_0x5dbc85(0xc2a):_0x5dbc85(0x12ac)+_0x5e51bf['imageUrl']+_0x5dbc85(0xd37);else{if(_0x5e51bf[_0x5dbc85(0x12d9)]===_0x5dbc85(0xf74)){const _0xdcf5ea=_0x9ebf46[_0x5dbc85(0x1383)][_0x5dbc85(0x443)]&&_0x5e51bf[_0x5dbc85(0xd73)]?'https://image.pollinations.ai/prompt/'+_0x5e51bf[_0x5dbc85(0xd73)]:_0x5dbc85(0xe94);_0x37c243=_0x512510?_0x512510+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0xdcf5ea+_0x5dbc85(0xce9)+_0x5e51bf['hiddenContent']+'\x22></div>':_0x5dbc85(0x12ac)+_0xdcf5ea+_0x5dbc85(0xce9)+_0x5e51bf[_0x5dbc85(0x841)]+'\x22>';}else{if(_0x5e51bf[_0x5dbc85(0x12d9)]===_0x5dbc85(0x1227)){const _0x50e84e=_0x5e51bf[_0x5dbc85(0xc76)]||(_0x5e51bf['imageUrl']?[_0x5e51bf['imageUrl']]:[]);if(_0x50e84e['length']>0x0){const _0x5d353b=_0x50e84e[_0x5dbc85(0xa06)];let _0x503223='';_0x503223='<div\x20class=\x22post-images-grid\x20grid-'+_0x5d353b+'\x22>',_0x50e84e[_0x5dbc85(0x591)]((_0x160357,_0x4f19e5)=>{const _0x288f14=_0x5dbc85;_0x503223+=_0x288f14(0x12ac)+_0x160357+_0x288f14(0x524)+(_0x4f19e5+0x1)+_0x288f14(0x533);}),_0x503223+=_0x5dbc85(0x103c),_0x37c243=_0x512510?''+_0x512510+_0x503223:_0x503223;}}}}}return _0x37c243;}let _0x5c2f72;if(_0x75600a[_0x57e664(0x12d9)]===_0x57e664(0x75b)){const _0x4d39b2=_0x75600a[_0x57e664(0x104d)]?'<div\x20class=\x22post-content\x22>'+_0x1ffeeb(_0x75600a[_0x57e664(0x104d)])[_0x57e664(0x459)](/\n/g,_0x57e664(0x10d9))+_0x57e664(0x103c):'';let _0x943920=_0x246753,_0x30ede5='原作者';if(_0x75600a[_0x57e664(0xc26)]['authorId']==='user')_0x943920=_0x9ebf46['qzoneSettings']['avatar'],_0x30ede5=_0x9ebf46[_0x57e664(0x32c)]['nickname'];else{const _0x4087d3=_0x9ebf46[_0x57e664(0x547)][_0x75600a[_0x57e664(0xc26)]['authorId']];_0x4087d3&&(_0x943920=_0x4087d3['settings'][_0x57e664(0xd4d)]||_0x246753),_0x30ede5=_0x1dfc4e(_0x75600a[_0x57e664(0xc26)][_0x57e664(0x12ec)]);}_0x5c2f72=_0x57e664(0x983)+_0x4d39b2+_0x57e664(0xdc0)+_0x943920+_0x57e664(0x12a8)+_0x30ede5+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x12b12c(_0x75600a['originalPost'][_0x57e664(0x6b5)])+_0x57e664(0x117b)+_0x27a66e(_0x75600a['originalPost'])+_0x57e664(0x11ca);}else _0x5c2f72='<div\x20class=\x22post-main-content\x22>'+_0x27a66e(_0x75600a)+_0x57e664(0x103c);let _0x184a61='';if(_0x75600a[_0x57e664(0x315)]&&_0x75600a[_0x57e664(0x315)][_0x57e664(0xa06)]>0x0){const _0x5c3fd4=_0x75600a[_0x57e664(0x315)][_0x57e664(0xa3b)](_0x352f23=>_0x1dfc4e(_0x352f23))[_0x57e664(0x809)]('、');_0x184a61=_0x57e664(0xf38)+_0x5c3fd4+_0x57e664(0x240);}let _0x5b26f4='';_0x75600a[_0x57e664(0x1e0)]&&_0x75600a[_0x57e664(0x1e0)]['length']>0x0&&(_0x5b26f4=_0x57e664(0xc57),_0x75600a[_0x57e664(0x1e0)][_0x57e664(0x591)]((_0x27a2a2,_0x1c773d)=>{const _0x5684bc=_0x57e664;if(typeof _0x27a2a2===_0x5684bc(0xc24)&&_0x27a2a2!==null&&_0x27a2a2[_0x5684bc(0x8bf)]){const _0x1584f9=_0x27a2a2[_0x5684bc(0x8bf)],_0x2c3b08=_0x1dfc4e(_0x1584f9);let _0x162e42;_0x2d389f[_0x5684bc(0x4e8)](_0x27a2a2[_0x5684bc(0xbb7)])?_0x162e42=_0x5684bc(0x12ac)+_0x27a2a2[_0x5684bc(0xbb7)]+'\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>':_0x162e42=_0x1ffeeb(_0x27a2a2[_0x5684bc(0xbb7)]);let _0x34d330='';if(_0x27a2a2['replyTo']){const _0x5f4807=_0x1dfc4e(_0x27a2a2[_0x5684bc(0x6ff)]);_0x34d330=_0x5684bc(0x9e6)+_0x2c3b08+'</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>'+_0x5f4807+_0x5684bc(0xee3)+_0x162e42;}else _0x34d330=_0x5684bc(0x9e6)+_0x2c3b08+_0x5684bc(0xee3)+_0x162e42;_0x5b26f4+=_0x5684bc(0x11e1)+_0x75600a['id']+_0x5684bc(0x673)+_0x1584f9+_0x5684bc(0x97e)+_0x2c3b08+_0x5684bc(0xe77)+_0x34d330+_0x5684bc(0x1165)+_0x1c773d+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}else _0x5b26f4+=_0x5684bc(0xd9f)+_0x1ffeeb(String(_0x27a2a2))+_0x5684bc(0xd9c);}),_0x5b26f4+='</div>');const _0x24c48a=_0x9ebf46['qzoneSettings'][_0x57e664(0x5b7)],_0x27616a=_0x75600a[_0x57e664(0x315)]&&_0x75600a[_0x57e664(0x315)][_0x57e664(0x930)](_0x24c48a),_0x56ae74=_0x9ebf46['favoritedPostIds']&&_0x9ebf46[_0x57e664(0xf33)][_0x57e664(0xd97)](_0x75600a['id']);let _0x15c862='';_0x75600a['type']!=='repost'&&(_0x15c862=_0x57e664(0x11d5));_0x510de4[_0x57e664(0x2f5)]=_0x57e664(0xbc1)+_0xc9615a+'\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22'+_0x75600a[_0x57e664(0x61c)]+_0x57e664(0x88e)+_0x227dc2+_0x57e664(0x55d)+_0x12b12c(_0x75600a[_0x57e664(0x6b5)])+_0x57e664(0x409)+_0x5c2f72+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x15c862+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20'+(_0x27616a?_0x57e664(0x113d):'')+_0x57e664(0x5b4)+(_0x56ae74?_0x57e664(0x113d):'')+_0x57e664(0x810)+_0x184a61+_0x57e664(0x9d9)+_0x5b26f4+_0x57e664(0x9a1)+_0x2134ac+_0x57e664(0x757);if(!_0x3654eb){const _0x322df7=document['createElement'](_0x57e664(0x11f4));_0x322df7[_0x57e664(0x82c)]=_0x57e664(0xca9),_0x322df7[_0x57e664(0x2f5)]=_0x57e664(0xdd4),_0x462781[_0x57e664(0x7b9)](_0x510de4),_0x462781[_0x57e664(0x7b9)](_0x322df7);}return _0x462781;}async function _0x374c25(_0x40f54b){const _0x2fc9da=_0x419fa8,_0x175e05=await _0x2c5bcf[_0x2fc9da(0x75f)]['get'](_0x40f54b);if(!_0x175e05){const _0x26cb41=document['querySelector'](_0x2fc9da(0x11e6)+_0x40f54b+'\x22]');if(_0x26cb41)_0x26cb41[_0x2fc9da(0x30f)]();return;}const _0x546847=_0x20f1b5[_0x2fc9da(0x684)](_0x1c9646=>_0x1c9646['id']===_0x40f54b);if(_0x546847>-0x1)_0x20f1b5[_0x546847]=_0x175e05;const _0x149dd0=await _0x2c5bcf[_0x2fc9da(0xc09)][_0x2fc9da(0xe78)](_0x2fc9da(0x12d9))[_0x2fc9da(0xda9)](_0x2fc9da(0x411))['toArray']();_0x9ebf46['favoritedPostIds']=new Set(_0x149dd0[_0x2fc9da(0xa3b)](_0x49c4ce=>_0x49c4ce[_0x2fc9da(0x53b)]['id'])),_0x4bf44e(_0x175e05);}function _0x4fcd92(_0xe3fb8){const _0xca7f2f=_0x419fa8,_0x3693a6=Date[_0xca7f2f(0x9b7)](),_0x23580c=Math[_0xca7f2f(0x5fb)]((_0x3693a6-_0xe3fb8)/0x3e8),_0x29bad3=Math[_0xca7f2f(0x5fb)](_0x23580c/0x3c);if(_0x29bad3<0x2)return'刚刚';if(_0x29bad3<0x3c)return _0x29bad3+_0xca7f2f(0x1248);const _0x38ce51=Math[_0xca7f2f(0x5fb)](_0x29bad3/0x3c);if(_0x38ce51<0x18)return _0x38ce51+'小时前';const _0xfe44b=Math[_0xca7f2f(0x5fb)](_0x38ce51/0x18);return _0xfe44b+'天前';}async function _0x4bf44e(_0x487dd2){const _0x3ee719=_0x419fa8,_0x4f7933=document[_0x3ee719(0x91d)](_0x3ee719(0x11e6)+_0x487dd2['id']+'\x22]'),_0xe5a694=!!_0x4f7933,_0x26060e=_0xe5a694?_0x4f7933:document[_0x3ee719(0x28a)](_0x3ee719(0x11f4));!_0xe5a694&&(_0x26060e[_0x3ee719(0x82c)]=_0x3ee719(0x742),_0x26060e[_0x3ee719(0xc9f)][_0x3ee719(0xf23)]=_0x487dd2['id']);const _0x34435b=_0xe5a694?_0x26060e[_0x3ee719(0x91d)]('.qzone-post-item'):document['createElement'](_0x3ee719(0x11f4));!_0xe5a694&&(_0x34435b[_0x3ee719(0x82c)]=_0x3ee719(0x87d));let _0x4a95e6='',_0x47ab71='',_0xe36701=_0x9ebf46[_0x3ee719(0x32c)][_0x3ee719(0x10c9)];if(_0x487dd2[_0x3ee719(0x61c)]===_0x3ee719(0x586))_0x4a95e6=_0x9ebf46[_0x3ee719(0x32c)]['avatar'],_0x47ab71=_0x9ebf46[_0x3ee719(0x32c)][_0x3ee719(0x5b7)];else{if(_0x9ebf46['chats'][_0x487dd2['authorId']]){const _0xe5a5b7=_0x9ebf46[_0x3ee719(0x547)][_0x487dd2['authorId']];_0x4a95e6=_0xe5a5b7[_0x3ee719(0x1131)][_0x3ee719(0xd4d)]||_0x246753,_0x47ab71=_0xe5a5b7[_0x3ee719(0x609)];}else{if(String(_0x487dd2['authorId'])[_0x3ee719(0xc8d)](_0x3ee719(0x2e7))){const _0x4b0c3c=parseInt(String(_0x487dd2['authorId'])[_0x3ee719(0x459)](_0x3ee719(0x2e7),''));if(!isNaN(_0x4b0c3c)){const _0x13fbce=await _0x2c5bcf[_0x3ee719(0x1094)][_0x3ee719(0xdf9)](_0x4b0c3c);_0x13fbce?(_0x4a95e6=_0x13fbce[_0x3ee719(0x10c9)]||_0x337c8f,_0x47ab71=_0x13fbce[_0x3ee719(0x609)]):(_0x47ab71=_0x487dd2[_0x3ee719(0x12ec)]||_0x3ee719(0x1380),_0x4a95e6=_0x337c8f);}}else _0x47ab71=_0x1dfc4e(_0x487dd2['authorOriginalName']),_0x4a95e6=_0x246753;}}function _0x34b68a(_0x20d531){const _0x511cca=_0x3ee719;let _0x2c3b59='';const _0x27babe=_0x20d531['publicText']?_0x511cca(0x61f)+_0x1ffeeb(_0x20d531[_0x511cca(0x7b2)])[_0x511cca(0x459)](/\n/g,_0x511cca(0x10d9))+_0x511cca(0x103c):'';if(_0x20d531['type']==='shuoshuo')_0x2c3b59=_0x511cca(0x6be)+_0x1ffeeb(_0x20d531[_0x511cca(0x53b)])[_0x511cca(0x459)](/\n/g,'<br>')+_0x511cca(0x103c);else{if(_0x20d531[_0x511cca(0x12d9)]===_0x511cca(0x55b)&&_0x20d531['imageUrl'])_0x2c3b59=_0x27babe?_0x27babe+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x20d531[_0x511cca(0xd5e)]+_0x511cca(0xc2a):_0x511cca(0x12ac)+_0x20d531[_0x511cca(0xd5e)]+_0x511cca(0xd37);else{if(_0x20d531['type']===_0x511cca(0xf74)){const _0x27d598=_0x9ebf46[_0x511cca(0x1383)][_0x511cca(0x443)]&&_0x20d531[_0x511cca(0xd73)]?'https://image.pollinations.ai/prompt/'+_0x20d531[_0x511cca(0xd73)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x2c3b59=_0x27babe?_0x27babe+_0x511cca(0x8f3)+_0x27d598+_0x511cca(0xce9)+_0x20d531['hiddenContent']+_0x511cca(0xf47):_0x511cca(0x12ac)+_0x27d598+_0x511cca(0xce9)+_0x20d531[_0x511cca(0x841)]+'\x22>';}else{if(_0x20d531['type']===_0x511cca(0x1227)){const _0x52b973=_0x20d531[_0x511cca(0xc76)]||(_0x20d531[_0x511cca(0xd5e)]?[_0x20d531[_0x511cca(0xd5e)]]:[]);if(_0x52b973[_0x511cca(0xa06)]>0x0){const _0x39aea2=_0x52b973['length'];let _0x2d68fa='';_0x2d68fa=_0x511cca(0x1033)+_0x39aea2+'\x22>',_0x52b973[_0x511cca(0x591)]((_0x57615e,_0x1c4041)=>{const _0x3d429e=_0x511cca;_0x2d68fa+=_0x3d429e(0x12ac)+_0x57615e+_0x3d429e(0x524)+(_0x1c4041+0x1)+_0x3d429e(0x533);}),_0x2d68fa+=_0x511cca(0x103c),_0x2c3b59=_0x27babe?''+_0x27babe+_0x2d68fa:_0x2d68fa;}}}}}return _0x2c3b59;}let _0x5971cc;if(_0x487dd2[_0x3ee719(0x12d9)]==='repost'){const _0x11ef2d=_0x487dd2[_0x3ee719(0x104d)]?_0x3ee719(0x61f)+_0x487dd2['repostComment'][_0x3ee719(0x459)](/\n/g,_0x3ee719(0x10d9))+'</div>':'';let _0x322c98=_0x246753,_0x58896e=_0x3ee719(0xb78);if(_0x487dd2['originalPost'][_0x3ee719(0x61c)]===_0x3ee719(0x586))_0x322c98=_0x9ebf46[_0x3ee719(0x32c)][_0x3ee719(0x10c9)],_0x58896e=_0x9ebf46[_0x3ee719(0x32c)][_0x3ee719(0x5b7)];else{const _0x33364d=_0x9ebf46[_0x3ee719(0x547)][_0x487dd2[_0x3ee719(0xc26)][_0x3ee719(0x61c)]];_0x33364d&&(_0x322c98=_0x33364d[_0x3ee719(0x1131)][_0x3ee719(0xd4d)]||_0x246753),_0x58896e=_0x1dfc4e(_0x487dd2[_0x3ee719(0xc26)][_0x3ee719(0x12ec)]);}_0x5971cc=_0x3ee719(0x983)+_0x11ef2d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x322c98+_0x3ee719(0x12a8)+_0x58896e+_0x3ee719(0x9c3)+_0x12b12c(_0x487dd2[_0x3ee719(0xc26)][_0x3ee719(0x6b5)])+_0x3ee719(0x117b)+_0x34b68a(_0x487dd2[_0x3ee719(0xc26)])+_0x3ee719(0x11ca);}else _0x5971cc='<div\x20class=\x22post-main-content\x22>'+_0x34b68a(_0x487dd2)+'</div>';let _0x467e4a='';if(_0x487dd2[_0x3ee719(0x315)]&&_0x487dd2[_0x3ee719(0x315)][_0x3ee719(0xa06)]>0x0){const _0x22962a=_0x487dd2[_0x3ee719(0x315)][_0x3ee719(0xa3b)](_0x369021=>_0x1dfc4e(_0x369021))['join']('、');_0x467e4a='<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>'+_0x22962a+_0x3ee719(0x240);}let _0x358deb='';_0x487dd2[_0x3ee719(0x1e0)]&&_0x487dd2[_0x3ee719(0x1e0)]['length']>0x0&&(_0x358deb=_0x3ee719(0xc57),_0x487dd2[_0x3ee719(0x1e0)][_0x3ee719(0x591)]((_0x183bda,_0x18a4c4)=>{const _0x1aff24=_0x3ee719;if(typeof _0x183bda===_0x1aff24(0xc24)&&_0x183bda!==null&&_0x183bda[_0x1aff24(0x8bf)]){const _0xe3e5db=_0x183bda[_0x1aff24(0x8bf)],_0x397069=_0x1dfc4e(_0xe3e5db);let _0x2dda90;_0x2d389f[_0x1aff24(0x4e8)](_0x183bda[_0x1aff24(0xbb7)])?_0x2dda90=_0x1aff24(0x12ac)+_0x183bda[_0x1aff24(0xbb7)]+'\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>':_0x2dda90=_0x1ffeeb(_0x183bda[_0x1aff24(0xbb7)]);let _0x164947='';if(_0x183bda[_0x1aff24(0x6ff)]){const _0x2fc7fe=_0x1dfc4e(_0x183bda[_0x1aff24(0x6ff)]);_0x164947=_0x1aff24(0x9e6)+_0x397069+_0x1aff24(0x3e9)+_0x2fc7fe+'</span>:\x20'+_0x2dda90;}else _0x164947='<span\x20class=\x22commenter-name\x22>'+_0x397069+'</span>:\x20'+_0x2dda90;_0x358deb+=_0x1aff24(0x11e1)+_0x487dd2['id']+_0x1aff24(0x673)+_0xe3e5db+_0x1aff24(0x97e)+_0x397069+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>'+_0x164947+_0x1aff24(0x1165)+_0x18a4c4+_0x1aff24(0x8c8);}else _0x358deb+=_0x1aff24(0xd9f)+String(_0x183bda)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}),_0x358deb+=_0x3ee719(0x103c));const _0x5aad65=_0x9ebf46[_0x3ee719(0x32c)][_0x3ee719(0x5b7)],_0x45de5b=_0x487dd2[_0x3ee719(0x315)]&&_0x487dd2['likes'][_0x3ee719(0x930)](_0x5aad65),_0x3fcc59=_0x9ebf46[_0x3ee719(0xf33)]&&_0x9ebf46[_0x3ee719(0xf33)][_0x3ee719(0xd97)](_0x487dd2['id']);let _0xc4bef9='';_0x487dd2[_0x3ee719(0x12d9)]!==_0x3ee719(0x75b)&&(_0xc4bef9=_0x3ee719(0x11d5));_0x34435b['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x4a95e6+_0x3ee719(0xe6a)+_0x487dd2[_0x3ee719(0x61c)]+_0x3ee719(0x88e)+_0x47ab71+_0x3ee719(0x55d)+_0x12b12c(_0x487dd2[_0x3ee719(0x6b5)])+_0x3ee719(0x409)+_0x5971cc+_0x3ee719(0x1338)+_0xc4bef9+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20'+(_0x45de5b?_0x3ee719(0x113d):'')+_0x3ee719(0x5b4)+(_0x3fcc59?_0x3ee719(0x113d):'')+_0x3ee719(0x810)+_0x467e4a+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x358deb+_0x3ee719(0x9a1)+_0xe36701+_0x3ee719(0x757);if(!_0xe5a694){const _0x7f6b5e=document[_0x3ee719(0x28a)](_0x3ee719(0x11f4));_0x7f6b5e[_0x3ee719(0x82c)]='qzone-post-delete-action',_0x7f6b5e['innerHTML']=_0x3ee719(0xdd4),_0x26060e[_0x3ee719(0x7b9)](_0x34435b),_0x26060e[_0x3ee719(0x7b9)](_0x7f6b5e);}return _0x26060e;}async function _0x374c25(_0x2c70db){const _0x48f937=_0x419fa8,_0xb41726=await _0x2c5bcf['qzonePosts'][_0x48f937(0xdf9)](_0x2c70db);if(!_0xb41726){const _0x16c7a2=document['querySelector'](_0x48f937(0x11e6)+_0x2c70db+'\x22]');_0x16c7a2&&_0x16c7a2[_0x48f937(0x30f)]();return;}const _0x205f12=_0x20f1b5['findIndex'](_0x586b7f=>_0x586b7f['id']===_0x2c70db);_0x205f12>-0x1&&(_0x20f1b5[_0x205f12]=_0xb41726);const _0x22b450=await _0x2c5bcf[_0x48f937(0xc09)][_0x48f937(0xe78)](_0x48f937(0x12d9))['equals'](_0x48f937(0x411))[_0x48f937(0x5ff)]();_0x9ebf46[_0x48f937(0xf33)]=new Set(_0x22b450[_0x48f937(0xa3b)](_0x5de35e=>_0x5de35e[_0x48f937(0x53b)]['id'])),await _0x4bf44e(_0xb41726);}async function _0x2c70a9(){const _0x1af7fd=_0x419fa8,_0x47b29c=document[_0x1af7fd(0x9c8)](_0x1af7fd(0x958));if(!_0x47b29c)return;const [_0x5b5076,_0x17a2fd]=await Promise['all']([_0x2c5bcf[_0x1af7fd(0x75f)][_0x1af7fd(0x8ea)]('timestamp')[_0x1af7fd(0x101e)]()[_0x1af7fd(0x401)](_0x223b59=>!_0x223b59[_0x1af7fd(0xb5d)])[_0x1af7fd(0x5ff)](),_0x2c5bcf[_0x1af7fd(0xc09)][_0x1af7fd(0xe78)](_0x1af7fd(0x12d9))[_0x1af7fd(0xda9)](_0x1af7fd(0x411))['toArray']()]);_0x20f1b5=_0x5b5076,_0x9ebf46[_0x1af7fd(0xf33)]=new Set(_0x17a2fd[_0x1af7fd(0xa3b)](_0x4b28b2=>_0x4b28b2[_0x1af7fd(0x53b)]['id'])),_0x47b29c['innerHTML']='',_0xca834d=0x0;if(_0x20f1b5[_0x1af7fd(0xa06)]===0x0){_0x47b29c[_0x1af7fd(0x2f5)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>';return;}_0x2a6c86();}async function _0x2a6c86(){const _0x4a86c2=_0x419fa8;if(_0x3d4398)return;_0x3d4398=!![];const _0x36f194=document['getElementById'](_0x4a86c2(0x958));if(!_0x36f194){_0x3d4398=![];return;}_0xde08bb(_0x36f194,_0x4a86c2(0x40f)),setTimeout(async()=>{const _0x4ec9a9=_0x4a86c2;_0xfb2eb9(_0x36f194);const _0x354689=_0xca834d,_0x397fea=_0xca834d+_0xe60733,_0x3a361b=_0x20f1b5['slice'](_0x354689,_0x397fea),_0x140ba8=document[_0x4ec9a9(0x5a2)]();for(const _0x4a3a7f of _0x3a361b){const _0x564414=await _0x4bf44e(_0x4a3a7f);_0x140ba8[_0x4ec9a9(0x7b9)](_0x564414);}_0x36f194[_0x4ec9a9(0x7b9)](_0x140ba8),_0xca834d+=_0x3a361b[_0x4ec9a9(0xa06)],_0x3d4398=![];},0x1f4);}function _0x1f1e10(_0x314b35,_0x1a0a4b){const _0x267405=_0x419fa8,_0x2eb730=_0x15329b[_0x267405(0x1280)],_0x2c407d=_0x15329b[_0x267405(0xd4e)];_0x2c407d[_0x267405(0x2f5)]='';_0x9ebf46[_0x267405(0x774)]['length']===0x0?_0x2c407d[_0x267405(0x2f5)]=_0x267405(0xd14):_0x9ebf46['userStickers'][_0x267405(0x591)](_0x4cc0e1=>{const _0x2cc35a=_0x267405,_0x22e027=document[_0x2cc35a(0x28a)](_0x2cc35a(0x11f4));_0x22e027[_0x2cc35a(0x82c)]=_0x2cc35a(0x10a4),_0x22e027['style'][_0x2cc35a(0x11d9)]='url('+_0x4cc0e1[_0x2cc35a(0x11be)]+')',_0x22e027[_0x2cc35a(0x9f2)]=_0x4cc0e1[_0x2cc35a(0x609)],_0x2c407d['appendChild'](_0x22e027);});const _0x485039=_0x1a0a4b[_0x267405(0xe2c)](),_0x4fdc61=document[_0x267405(0x9c8)](_0x267405(0x6fb))['getBoundingClientRect']();_0x2eb730[_0x267405(0x5e1)][_0x267405(0x3c5)]=_0x267405(0x989);const _0x2426e8=_0x2eb730[_0x267405(0xe2c)](),_0x56f541=_0x2426e8[_0x267405(0x3ff)],_0x182b62=_0x2426e8['width'];_0x2eb730['style']['top']=_0x485039[_0x267405(0x114a)]-_0x56f541-0x5-_0x4fdc61['top']+'px';const _0x17aba5=_0x485039[_0x267405(0x12b6)]-_0x4fdc61['left'];_0x17aba5+_0x182b62>_0x4fdc61[_0x267405(0x125e)]?(_0x2eb730[_0x267405(0x5e1)]['left']='auto',_0x2eb730[_0x267405(0x5e1)][_0x267405(0x4d0)]=_0x267405(0x935)):(_0x2eb730['style'][_0x267405(0x12b6)]=_0x17aba5+'px',_0x2eb730['style'][_0x267405(0x4d0)]='auto'),_0x15329b[_0x267405(0x84b)]=!![],_0x15329b[_0x267405(0x2bf)]=_0x314b35;}function _0x475b2e(){const _0x28be53=_0x419fa8;_0x15329b[_0x28be53(0x84b)]&&(_0x15329b['panelEl']['style'][_0x28be53(0x3c5)]='none',_0x15329b[_0x28be53(0x84b)]=![],_0x15329b['activePostId']=null);}async function _0x365251(_0x55c59c,_0x1c0cc9){const _0x5b68bb=_0x419fa8;if(!_0x1c0cc9||!_0x1c0cc9['url'])return;const _0x3745b4=await _0x2c5bcf[_0x5b68bb(0x75f)][_0x5b68bb(0xdf9)](_0x55c59c);if(!_0x3745b4){console[_0x5b68bb(0x1221)](_0x5b68bb(0x1209),_0x55c59c);return;}!_0x3745b4[_0x5b68bb(0x1e0)]&&(_0x3745b4['comments']=[]);const _0x5f3b79={'commenterName':_0x9ebf46['qzoneSettings'][_0x5b68bb(0x5b7)],'text':_0x1c0cc9['url'],'meaning':_0x1c0cc9[_0x5b68bb(0x609)],'timestamp':Date[_0x5b68bb(0x9b7)]()};_0x3745b4[_0x5b68bb(0x1e0)][_0x5b68bb(0x668)](_0x5f3b79),await _0x2c5bcf[_0x5b68bb(0x75f)][_0x5b68bb(0x13a4)](_0x55c59c,{'comments':_0x3745b4[_0x5b68bb(0x1e0)]}),_0x475b2e(),await _0x2c70a9();const _0x5149dc=(_0x3745b4[_0x5b68bb(0x7b2)]||_0x3745b4[_0x5b68bb(0x53b)]||_0x5b68bb(0x128b))[_0x5b68bb(0xc34)](0x0,0x1e);for(const _0x257cbc in _0x9ebf46['chats']){const _0x47b501=_0x9ebf46[_0x5b68bb(0x547)][_0x257cbc];if(!_0x47b501[_0x5b68bb(0x11e4)]){const _0x3312fe=_0x5b68bb(0xcb3)+_0x9ebf46[_0x5b68bb(0x32c)][_0x5b68bb(0x5b7)]+_0x5b68bb(0x1040)+_0x55c59c+',\x20内容摘要:\x20“'+_0x5149dc+_0x5b68bb(0xbe7)+_0x1c0cc9['name']+_0x5b68bb(0x607),_0x296a39={'role':'system','content':_0x3312fe,'timestamp':Date[_0x5b68bb(0x9b7)](),'isHidden':!![]};_0x47b501[_0x5b68bb(0x8b3)][_0x5b68bb(0x668)](_0x296a39),await _0x2c5bcf[_0x5b68bb(0x547)][_0x5b68bb(0xff5)](_0x47b501);}}}function _0x4020b6(_0x43a1c7){const _0x41ab43=_0x419fa8;_0x19e608=_0x43a1c7,document['getElementById']('repost-comment-input')[_0x41ab43(0x1155)]='',document['getElementById'](_0x41ab43(0xf75))[_0x41ab43(0x575)][_0x41ab43(0x68e)](_0x41ab43(0xc3f));}function _0x1b1003(){const _0x227b28=_0x419fa8;document[_0x227b28(0x9c8)](_0x227b28(0xf75))[_0x227b28(0x575)][_0x227b28(0x30f)](_0x227b28(0xc3f)),_0x19e608=null;}async function _0xf09c12(){const _0x4b8618=_0x419fa8;if(!_0x19e608)return;const _0x2e40e3=document['getElementById']('repost-comment-input')[_0x4b8618(0x1155)]['trim'](),_0x225097=await _0x2c5bcf['qzonePosts'][_0x4b8618(0xdf9)](_0x19e608);if(!_0x225097){alert(_0x4b8618(0x11da)),_0x1b1003();return;}const _0x539032={'type':_0x4b8618(0x75b),'timestamp':Date[_0x4b8618(0x9b7)](),'authorId':'user','repostComment':_0x2e40e3,'originalPost':_0x225097,'visibleGroupIds':null};await _0x2c5bcf[_0x4b8618(0x75f)][_0x4b8618(0x68e)](_0x539032),_0x1b1003(),await _0x2c70a9(),alert(_0x4b8618(0xcdc));}function _0x4336b7(_0x5bc604){const _0x4edbec=_0x419fa8,_0x380f1e=document['getElementById'](_0x4edbec(0x4d8));_0x380f1e[_0x4edbec(0x2f5)]='';if(_0x5bc604['length']===0x0){const _0x2833cb=document[_0x4edbec(0x9c8)](_0x4edbec(0xe8c))['value'],_0x388e1=_0x2833cb?_0x4edbec(0xe89):'你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！';_0x380f1e['innerHTML']=_0x4edbec(0xae2)+_0x388e1+_0x4edbec(0x78d);return;}for(const _0x1ae967 of _0x5bc604){const _0x36d929=document[_0x4edbec(0x28a)](_0x4edbec(0x11f4));_0x36d929['className']=_0x4edbec(0xb0e),_0x36d929[_0x4edbec(0xc9f)][_0x4edbec(0x784)]=_0x1ae967['id'];let _0x2af67f='',_0x3524e0='',_0x3fa0ed='',_0x483ceb='';if(_0x1ae967['type']===_0x4edbec(0x411)){const _0x121e97=_0x1ae967['content'];_0x3fa0ed='来自动态';let _0xd0cae3=_0x246753,_0x4abfb9=_0x4edbec(0x7ae);if(_0x121e97['authorId']===_0x4edbec(0x586))_0xd0cae3=_0x9ebf46[_0x4edbec(0x32c)][_0x4edbec(0x10c9)],_0x4abfb9=_0x9ebf46[_0x4edbec(0x32c)]['nickname'];else _0x9ebf46['chats'][_0x121e97[_0x4edbec(0x61c)]]&&(_0xd0cae3=_0x9ebf46[_0x4edbec(0x547)][_0x121e97[_0x4edbec(0x61c)]][_0x4edbec(0x1131)][_0x4edbec(0xd4d)],_0x4abfb9=_0x9ebf46[_0x4edbec(0x547)][_0x121e97['authorId']][_0x4edbec(0x609)]);_0x2af67f=_0x4edbec(0x12ac)+_0xd0cae3+_0x4edbec(0x716)+_0x4abfb9+_0x4edbec(0x272);const _0x49f52f=_0x121e97[_0x4edbec(0x7b2)]?'<div\x20class=\x22post-content\x22>'+_0x121e97[_0x4edbec(0x7b2)][_0x4edbec(0x459)](/\n/g,_0x4edbec(0x10d9))+_0x4edbec(0x103c):'';if(_0x121e97[_0x4edbec(0x12d9)]==='shuoshuo')_0x3524e0=_0x4edbec(0x61f)+_0x121e97[_0x4edbec(0x53b)][_0x4edbec(0x459)](/\n/g,_0x4edbec(0x10d9))+'</div>';else{if(_0x121e97['type']==='image_post'&&_0x121e97[_0x4edbec(0xd5e)]){const _0x2ac9fa=_0x9ebf46[_0x4edbec(0x1383)]['enableAiDrawing']&&_0x121e97[_0x4edbec(0xd73)]?_0x4edbec(0x12d5)+_0x121e97[_0x4edbec(0xd73)]:_0x4edbec(0xe94);_0x3524e0=_0x49f52f?_0x49f52f+_0x4edbec(0x8f3)+_0x2ac9fa+'\x22\x20class=\x22chat-image\x22></div>':'<img\x20src=\x22'+_0x2ac9fa+'\x22\x20class=\x22chat-image\x22>';}else{if(_0x121e97['type']===_0x4edbec(0xf74)){const _0xd22934=_0x9ebf46[_0x4edbec(0x1383)][_0x4edbec(0x443)]&&_0x121e97[_0x4edbec(0xd73)]?_0x4edbec(0x12d5)+_0x121e97[_0x4edbec(0xd73)]:_0x4edbec(0xe94);_0x3524e0=_0x49f52f?_0x49f52f+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0xd22934+_0x4edbec(0xce9)+_0x121e97['hiddenContent']+'\x22></div>':_0x4edbec(0x12ac)+_0xd22934+_0x4edbec(0xce9)+_0x121e97[_0x4edbec(0x841)]+'\x22>';}}}let _0x2535e5='';_0x121e97[_0x4edbec(0x315)]&&_0x121e97[_0x4edbec(0x315)][_0x4edbec(0xa06)]>0x0&&(_0x2535e5='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+_0x121e97['likes'][_0x4edbec(0x809)]('、')+_0x4edbec(0x909));let _0x113fcf='';_0x121e97[_0x4edbec(0x1e0)]&&_0x121e97[_0x4edbec(0x1e0)][_0x4edbec(0xa06)]>0x0&&(_0x113fcf=_0x4edbec(0xc57),_0x121e97['comments']['forEach']((_0x466617,_0x1ddaf7)=>{const _0x50ea66=_0x4edbec;if(typeof _0x466617==='object'&&_0x466617!==null&&_0x466617[_0x50ea66(0x8bf)]){const _0x79c424=_0x466617['commenterName'],_0x3ec47b=_0x1dfc4e(_0x79c424);let _0xb72d05;_0x2d389f['test'](_0x466617[_0x50ea66(0xbb7)])?_0xb72d05=_0x50ea66(0x12ac)+_0x466617[_0x50ea66(0xbb7)]+_0x50ea66(0xc03):_0xb72d05=_0x466617[_0x50ea66(0xbb7)];let _0x1d80a8='';if(_0x466617[_0x50ea66(0x6ff)]){const _0x506200=_0x1dfc4e(_0x466617[_0x50ea66(0x6ff)]);_0x1d80a8='<span\x20class=\x22commenter-name\x22>'+_0x3ec47b+_0x50ea66(0x3e9)+_0x506200+_0x50ea66(0xee3)+_0xb72d05;}else _0x1d80a8='<span\x20class=\x22commenter-name\x22>'+_0x3ec47b+'</span>:\x20'+_0xb72d05;_0x113fcf+=_0x50ea66(0x11e1)+_0x121e97['id']+_0x50ea66(0x673)+_0x79c424+_0x50ea66(0x97e)+_0x3ec47b+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>'+_0x1d80a8+_0x50ea66(0xc54)+_0x1ddaf7+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}else _0x113fcf+=_0x50ea66(0x13b0)+String(_0x466617)+_0x50ea66(0x1c4);}),_0x113fcf+=_0x4edbec(0x103c)),_0x483ceb=''+_0x2535e5+_0x113fcf;}else{if(_0x1ae967[_0x4edbec(0x12d9)]===_0x4edbec(0xb3c)){const _0x1b36d4=_0x1ae967[_0x4edbec(0x53b)],_0x52c752=_0x9ebf46[_0x4edbec(0x547)][_0x1ae967[_0x4edbec(0x54d)]];if(!_0x52c752)continue;_0x3fa0ed=_0x4edbec(0x10dc)+_0x52c752[_0x4edbec(0x609)]+_0x4edbec(0x94f);const _0x2ce6c2=_0x1b36d4[_0x4edbec(0x7fd)]===_0x4edbec(0x586);let _0x379664,_0x52c83f;if(_0x2ce6c2)_0x379664=_0x52c752['isGroup']?_0x52c752[_0x4edbec(0x1131)][_0x4edbec(0x29c)]||'我':'我',_0x52c83f=_0x52c752[_0x4edbec(0x1131)][_0x4edbec(0xb60)]||(_0x52c752[_0x4edbec(0x11e4)]?_0x1d990b:_0x246753);else{if(_0x52c752[_0x4edbec(0x11e4)]){const _0x35f422=_0x52c752[_0x4edbec(0xd3e)]['find'](_0x1351a9=>_0x1351a9['originalName']===_0x1b36d4['senderName']);_0x379664=_0x1b36d4['senderName'],_0x52c83f=_0x35f422?_0x35f422[_0x4edbec(0x10c9)]:_0x337c8f;}else _0x379664=_0x52c752[_0x4edbec(0x609)],_0x52c83f=_0x52c752[_0x4edbec(0x1131)]['aiAvatar']||_0x246753;}_0x2af67f=_0x4edbec(0x12ac)+_0x52c83f+_0x4edbec(0x716)+_0x379664+_0x4edbec(0x272);if(typeof _0x1b36d4[_0x4edbec(0x53b)]===_0x4edbec(0xe56)&&_0x2d389f[_0x4edbec(0x4e8)](_0x1b36d4[_0x4edbec(0x53b)]))_0x3524e0=_0x4edbec(0x12ac)+_0x1b36d4[_0x4edbec(0x53b)]+_0x4edbec(0x818);else Array[_0x4edbec(0xb27)](_0x1b36d4[_0x4edbec(0x53b)])&&_0x1b36d4[_0x4edbec(0x53b)][0x0]?.[_0x4edbec(0x12d9)]==='image_url'?_0x3524e0=_0x4edbec(0x12ac)+_0x1b36d4[_0x4edbec(0x53b)][0x0]['image_url'][_0x4edbec(0x11be)]+_0x4edbec(0xd37):_0x3524e0=String(_0x1b36d4[_0x4edbec(0x53b)]||'')[_0x4edbec(0x459)](/\n/g,_0x4edbec(0x10d9));}else{if(_0x1ae967[_0x4edbec(0x12d9)]===_0x4edbec(0x423)){const _0x50a8df=_0x1ae967[_0x4edbec(0x53b)];_0x3fa0ed='来自\x20'+_0x50a8df[_0x4edbec(0x116d)]+'\x20的日记';const _0x4dab58=_0x9ebf46[_0x4edbec(0x547)][_0x50a8df['characterId']],_0x2b44c6=_0x4dab58?_0x4dab58[_0x4edbec(0x1131)][_0x4edbec(0xd4d)]:_0x246753;_0x2af67f=_0x4edbec(0x12ac)+_0x2b44c6+_0x4edbec(0x716)+_0x50a8df['characterName']+'</div></div>';const _0x32999c=_0x50a8df[_0x4edbec(0x53b)]||'',_0x3b79f1=_0x1ffeeb(_0x32999c)[_0x4edbec(0x459)](/\n/g,_0x4edbec(0x10d9));_0x3524e0='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>'+_0x50a8df[_0x4edbec(0x9f2)]+_0x4edbec(0xc05)+_0x3b79f1+_0x4edbec(0xb72);}else{if(_0x1ae967[_0x4edbec(0x12d9)]===_0x4edbec(0x355)){const _0x4c6074=_0x1ae967[_0x4edbec(0x53b)];_0x3fa0ed=_0x4edbec(0xaee)+_0x4c6074[_0x4edbec(0x116d)]+'\x20的浏览记录';const _0x2d5740=_0x9ebf46[_0x4edbec(0x547)][_0x4c6074[_0x4edbec(0xf24)]],_0x492fef=_0x2d5740?_0x2d5740[_0x4edbec(0x1131)][_0x4edbec(0xd4d)]:_0x246753;_0x2af67f=_0x4edbec(0x12ac)+_0x492fef+_0x4edbec(0x716)+_0x4c6074['characterName']+'</div></div>',_0x3524e0=_0x4edbec(0x1f6)+_0x4c6074['title']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>'+(_0x4c6074[_0x4edbec(0x53b)]||'')['replace'](/\n/g,_0x4edbec(0x10d9))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}else{if(_0x1ae967['type']==='char_memo'){const _0x3ffd61=_0x1ae967['content'];_0x3fa0ed='来自\x20'+_0x3ffd61[_0x4edbec(0x116d)]+_0x4edbec(0x88d);const _0x2e18ce=_0x9ebf46[_0x4edbec(0x547)][_0x3ffd61[_0x4edbec(0xf24)]],_0x52575e=_0x2e18ce?_0x2e18ce[_0x4edbec(0x1131)][_0x4edbec(0xd4d)]:_0x246753;_0x2af67f=_0x4edbec(0x12ac)+_0x52575e+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x3ffd61[_0x4edbec(0x116d)]+_0x4edbec(0x272),_0x3524e0='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>'+_0x3ffd61[_0x4edbec(0x9f2)]+_0x4edbec(0xcde)+_0x3ffd61[_0x4edbec(0x53b)][_0x4edbec(0x459)](/\n/g,_0x4edbec(0x10d9))+'</div>\x0a\x20\x20\x20\x20';}}}}}_0x36d929[_0x4edbec(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>'+_0x2af67f+_0x4edbec(0x296)+_0x3fa0ed+_0x4edbec(0x1382)+_0x3524e0+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x483ceb,_0x380f1e[_0x4edbec(0x7b9)](_0x36d929);}}async function _0x22a029(){const _0x3074aa=_0x419fa8;allFavoriteItems=await _0x2c5bcf['favorites'][_0x3074aa(0x8ea)](_0x3074aa(0x6b5))['reverse']()[_0x3074aa(0x5ff)]();const _0x3804b3=document[_0x3074aa(0x9c8)](_0x3074aa(0xe8c)),_0x5c338a=document[_0x3074aa(0x9c8)](_0x3074aa(0x9cb));_0x3804b3[_0x3074aa(0x1155)]='',_0x5c338a['style'][_0x3074aa(0x3c5)]=_0x3074aa(0x8f6),_0x4336b7(allFavoriteItems);}function _0x1055ad(){const _0x5d6bf2=_0x419fa8;document['getElementById'](_0x5d6bf2(0x1354))[_0x5d6bf2(0x1155)]='',document[_0x5d6bf2(0x9c8)](_0x5d6bf2(0xf9e))[_0x5d6bf2(0xbf4)]='',document[_0x5d6bf2(0x9c8)]('post-image-description')[_0x5d6bf2(0x1155)]='',document[_0x5d6bf2(0x9c8)](_0x5d6bf2(0x1135))['classList'][_0x5d6bf2(0x30f)]('visible'),document[_0x5d6bf2(0x9c8)]('post-image-desc-group')[_0x5d6bf2(0x5e1)][_0x5d6bf2(0x3c5)]='none',document[_0x5d6bf2(0x9c8)]('post-local-image-input')[_0x5d6bf2(0x1155)]='',document[_0x5d6bf2(0x9c8)](_0x5d6bf2(0x690))[_0x5d6bf2(0x1155)]='',document[_0x5d6bf2(0x9c8)](_0x5d6bf2(0x7f5))[_0x5d6bf2(0xf5c)]();}async function _0x5ad329(){const _0x16d334=_0x419fa8,_0x674549=await _0x352ae9(_0x16d334(0x9da),'此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。',{'confirmButtonClass':_0x16d334(0x12bc),'confirmText':_0x16d334(0xbeb)});if(!_0x674549)return;await _0x1bff53(_0x16d334(0x7a4),_0x16d334(0x7a6)),console[_0x16d334(0x283)](_0x16d334(0x3b4));let _0x2398da={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0x2c5bcf[_0x16d334(0xa88)]('rw',_0x2c5bcf[_0x16d334(0xe42)],async()=>{const _0x35a427=_0x16d334,_0x5750ec=await _0x2c5bcf[_0x35a427(0x547)]['toArray'](),_0x2fc6d6=await _0x2c5bcf[_0x35a427(0x1094)]['toArray'](),_0x5214ff=new Set(_0x5750ec[_0x35a427(0xa3b)](_0x503107=>_0x503107['id'])),_0xf0ba23=new Set(_0x2fc6d6[_0x35a427(0xa3b)](_0x407646=>_0x35a427(0x2e7)+_0x407646['id'])),_0x5c72e0=new Set(_0x5750ec[_0x35a427(0x401)](_0x3c6801=>!_0x3c6801[_0x35a427(0x11e4)])[_0x35a427(0xa3b)](_0x1a4570=>_0x1a4570[_0x35a427(0x1071)]));_0x5c72e0[_0x35a427(0x68e)](_0x9ebf46['qzoneSettings'][_0x35a427(0x5b7)]||'{{user}}'),_0x2fc6d6[_0x35a427(0x591)](_0x374f04=>_0x5c72e0[_0x35a427(0x68e)](_0x374f04[_0x35a427(0x609)]));for(const _0xec45c7 of _0x5750ec){let _0x99b85a=![];if(_0xec45c7['isGroup']&&_0xec45c7[_0x35a427(0xd3e)]){const _0x1bf8aa=_0xec45c7['members'][_0x35a427(0xa06)];_0xec45c7[_0x35a427(0xd3e)]=_0xec45c7['members'][_0x35a427(0x401)](_0x19f62e=>_0x5214ff[_0x35a427(0xd97)](_0x19f62e['id'])||_0xf0ba23[_0x35a427(0xd97)](_0x19f62e['id'])),_0xec45c7[_0x35a427(0xd3e)]['length']<_0x1bf8aa&&(_0x2398da[_0x35a427(0xd15)]+=_0x1bf8aa-_0xec45c7[_0x35a427(0xd3e)][_0x35a427(0xa06)],_0x99b85a=!![]);}if(_0xec45c7[_0x35a427(0x1131)]?.[_0x35a427(0xfeb)]?.[_0x35a427(0xa06)]>0x0){const _0x49632b=_0xec45c7[_0x35a427(0x1131)][_0x35a427(0xfeb)][_0x35a427(0xa06)];_0xec45c7[_0x35a427(0x1131)]['linkedMemoryChatIds']=_0xec45c7[_0x35a427(0x1131)][_0x35a427(0xfeb)][_0x35a427(0x401)](_0x38ccd0=>_0x5214ff[_0x35a427(0xd97)](_0x38ccd0)),_0xec45c7['settings'][_0x35a427(0xfeb)][_0x35a427(0xa06)]<_0x49632b&&(_0x2398da[_0x35a427(0xc30)]+=_0x49632b-_0xec45c7[_0x35a427(0x1131)]['linkedMemoryChatIds'][_0x35a427(0xa06)],_0x99b85a=!![]);}_0x99b85a&&await _0x2c5bcf[_0x35a427(0x547)][_0x35a427(0xff5)](_0xec45c7);}const _0x48c5cd=await _0x2c5bcf[_0x35a427(0x75f)][_0x35a427(0x5ff)]();for(const _0x15f9ba of _0x48c5cd){let _0x249d98=![];const _0x3ddd0b=_0x15f9ba[_0x35a427(0x61c)]===_0x35a427(0x586)||_0x5214ff[_0x35a427(0xd97)](_0x15f9ba[_0x35a427(0x61c)])||_0xf0ba23['has'](_0x15f9ba['authorId']);if(!_0x3ddd0b){await _0x2c5bcf[_0x35a427(0x75f)][_0x35a427(0x6d2)](_0x15f9ba['id']),_0x2398da[_0x35a427(0xcbd)]++;continue;}if(_0x15f9ba[_0x35a427(0x315)]&&_0x15f9ba[_0x35a427(0x315)][_0x35a427(0xa06)]>0x0){const _0x5774d0=_0x15f9ba['likes']['length'];_0x15f9ba[_0x35a427(0x315)]=_0x15f9ba[_0x35a427(0x315)][_0x35a427(0x401)](_0xc8764=>_0x5c72e0['has'](_0xc8764)),_0x15f9ba[_0x35a427(0x315)]['length']<_0x5774d0&&(_0x2398da[_0x35a427(0x315)]+=_0x5774d0-_0x15f9ba[_0x35a427(0x315)]['length'],_0x249d98=!![]);}if(_0x15f9ba[_0x35a427(0x1e0)]&&_0x15f9ba['comments']['length']>0x0){const _0x907b05=_0x15f9ba[_0x35a427(0x1e0)]['length'];_0x15f9ba[_0x35a427(0x1e0)]=_0x15f9ba[_0x35a427(0x1e0)][_0x35a427(0x401)](_0x18e2e7=>{const _0x5ba53c=_0x35a427;if(typeof _0x18e2e7===_0x5ba53c(0xc24)&&_0x18e2e7[_0x5ba53c(0x8bf)])return _0x5c72e0[_0x5ba53c(0xd97)](_0x18e2e7[_0x5ba53c(0x8bf)]);return!![];}),_0x15f9ba[_0x35a427(0x1e0)][_0x35a427(0xa06)]<_0x907b05&&(_0x2398da[_0x35a427(0x1e0)]+=_0x907b05-_0x15f9ba['comments']['length'],_0x249d98=!![]);}_0x249d98&&await _0x2c5bcf[_0x35a427(0x75f)][_0x35a427(0xff5)](_0x15f9ba);}await _0x2c5bcf['memories'][_0x35a427(0xe78)]('chatId')[_0x35a427(0xce1)]([..._0x5214ff])[_0x35a427(0x6d2)]()[_0x35a427(0xcd7)](_0x4a0f77=>_0x2398da[_0x35a427(0x137e)]+=_0x4a0f77),await _0x2c5bcf['callRecords']['where'](_0x35a427(0x54d))[_0x35a427(0xce1)]([..._0x5214ff])[_0x35a427(0x6d2)]()[_0x35a427(0xcd7)](_0x4d6cc6=>_0x2398da[_0x35a427(0x852)]+=_0x4d6cc6);const _0x5abd73=await _0x2c5bcf['renderingRules'][_0x35a427(0x5ff)]();for(const _0x2bec3e of _0x5abd73){_0x2bec3e[_0x35a427(0x54d)]!==_0x35a427(0x1024)&&!_0x5214ff['has'](_0x2bec3e[_0x35a427(0x54d)])&&(await _0x2c5bcf[_0x35a427(0x1349)][_0x35a427(0x6d2)](_0x2bec3e['id']),_0x2398da[_0x35a427(0x1349)]++);}});let _0x4fb8c3=_0x16d334(0x123f),_0x4046cc=![];Object['entries'](_0x2398da)['forEach'](([_0x2d7664,_0x349d16])=>{const _0x3355b6=_0x16d334;if(_0x349d16>0x0){const _0x3c3b53={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':_0x3355b6(0x116c),'renderingRules':'渲染规则','groupMembers':_0x3355b6(0xf3e),'chatLinks':_0x3355b6(0x3b0)};_0x4fb8c3+=_0x3355b6(0x19d)+_0x349d16+'\x20条无效的'+(_0x3c3b53[_0x2d7664]||_0x2d7664)+'。\x0a',_0x4046cc=!![];}});!_0x4046cc&&(_0x4fb8c3=_0x16d334(0x8bb));_0x4fb8c3+='\x0a建议刷新页面以确保所有更改生效。',await _0x1bff53(_0x16d334(0x7de),_0x4fb8c3);const _0x317b87=await _0x352ae9(_0x16d334(0x79a),_0x16d334(0xe03));_0x317b87&&location[_0x16d334(0xea6)]();}catch(_0x5343df){console[_0x16d334(0x1221)](_0x16d334(0xc60),_0x5343df),await _0x1bff53(_0x16d334(0xef9),'发生了一个错误:\x20'+_0x5343df[_0x16d334(0x86e)]);}}async function _0x131058(){const _0x48e340=_0x419fa8;try{const _0x5bf254={'version':0x1,'timestamp':Date[_0x48e340(0x9b7)]()},[_0x121dd7,_0x1b4bf9,_0x5db6fa,_0x2cc833,_0x4e0d8c,_0x1baacc,_0x34b86d,_0x50b831,_0x1de678,_0x1efdb5,_0x3475a6,_0x5d65ca,_0x10b906,_0x522b64,_0x5c7494,_0x38aac8,_0x10182e,_0x8e1282,_0x5c32c8,_0x24df11,_0x5a41d4,_0x5354f0,_0x52a881,_0x31e1c7,_0x1abffa]=await Promise[_0x48e340(0xd0a)]([_0x2c5bcf['chats']['toArray'](),_0x2c5bcf[_0x48e340(0x1369)][_0x48e340(0x5ff)](),_0x2c5bcf['userStickers']['toArray'](),_0x2c5bcf[_0x48e340(0x4de)]['get'](_0x48e340(0x121f)),_0x2c5bcf[_0x48e340(0x1383)]['get']('main'),_0x2c5bcf[_0x48e340(0x40d)][_0x48e340(0x5ff)](),_0x2c5bcf[_0x48e340(0x53c)][_0x48e340(0xdf9)](_0x48e340(0x121f)),_0x2c5bcf[_0x48e340(0x32c)][_0x48e340(0xdf9)](_0x48e340(0x121f)),_0x2c5bcf[_0x48e340(0x75f)][_0x48e340(0x5ff)](),_0x2c5bcf[_0x48e340(0x6dc)]['toArray'](),_0x2c5bcf['qzonePhotos']['toArray'](),_0x2c5bcf[_0x48e340(0xc09)][_0x48e340(0x5ff)](),_0x2c5bcf['qzoneGroups'][_0x48e340(0x5ff)](),_0x2c5bcf['memories'][_0x48e340(0x5ff)](),_0x2c5bcf[_0x48e340(0x58a)][_0x48e340(0x5ff)](),_0x2c5bcf['apiPresets'][_0x48e340(0x5ff)](),_0x2c5bcf[_0x48e340(0x281)][_0x48e340(0x5ff)](),_0x2c5bcf[_0x48e340(0x852)][_0x48e340(0x5ff)](),_0x2c5bcf[_0x48e340(0x1349)]['toArray'](),_0x2c5bcf[_0x48e340(0x8af)][_0x48e340(0x5ff)](),_0x2c5bcf[_0x48e340(0x1342)][_0x48e340(0x5ff)](),_0x2c5bcf[_0x48e340(0xdc6)][_0x48e340(0x5ff)](),_0x2c5bcf['presets'][_0x48e340(0x5ff)](),_0x2c5bcf['presetCategories'][_0x48e340(0x5ff)](),_0x2c5bcf[_0x48e340(0x1094)]['toArray']()]);Object['assign'](_0x5bf254,{'chats':_0x121dd7,'worldBooks':_0x1b4bf9,'userStickers':_0x5db6fa,'apiConfig':_0x2cc833,'globalSettings':_0x4e0d8c,'personaPresets':_0x1baacc,'musicLibrary':_0x34b86d,'qzoneSettings':_0x50b831,'qzonePosts':_0x1de678,'qzoneAlbums':_0x1efdb5,'qzonePhotos':_0x3475a6,'favorites':_0x5d65ca,'qzoneGroups':_0x10b906,'memories':_0x522b64,'worldBookCategories':_0x5c7494,'apiPresets':_0x38aac8,'shoppingProducts':_0x10182e,'callRecords':_0x8e1282,'renderingRules':_0x5c32c8,'doubanPosts':_0x24df11,'stickerCategories':_0x5a41d4,'appearancePresets':_0x5354f0,'presets':_0x52a881,'presetCategories':_0x31e1c7,'npcs':_0x1abffa});const _0x489306=new Blob([JSON[_0x48e340(0xf1e)](_0x5bf254,null,0x2)],{'type':_0x48e340(0x698)}),_0x1b85bc=URL[_0x48e340(0x5bb)](_0x489306),_0xf42ec6=Object['assign'](document[_0x48e340(0x28a)]('a'),{'href':_0x1b85bc,'download':_0x48e340(0xac8)+new Date()[_0x48e340(0x3d5)]()['split']('T')[0x0]+_0x48e340(0x11d4)});_0xf42ec6[_0x48e340(0xf5c)](),URL['revokeObjectURL'](_0x1b85bc),await _0x1bff53(_0x48e340(0x418),'已成功导出所有数据！');}catch(_0x4878ee){console['error'](_0x48e340(0xfae),_0x4878ee),await _0x1bff53(_0x48e340(0xcd1),_0x48e340(0x58c)+_0x4878ee['message']);}}async function _0x5f42ec(_0x426170){const _0x1baf49=_0x419fa8;try{await _0x2c5bcf['transaction']('rw',_0x2c5bcf[_0x1baf49(0xe42)],async()=>{const _0x520652=_0x1baf49;for(const _0x92ac3a of _0x2c5bcf[_0x520652(0xe42)]){await _0x92ac3a[_0x520652(0xdae)]();}for(const _0x463215 in _0x426170){Array[_0x520652(0xb27)](_0x426170[_0x463215])&&(console[_0x520652(0x283)](_0x520652(0x1da)+_0x463215+_0x520652(0x50d)+_0x426170[_0x463215]['length']),await _0x2c5bcf[_0x520652(0x11de)](_0x463215)[_0x520652(0x1113)](_0x426170[_0x463215]));}});}catch(_0x1b63cd){throw new Error('数据库写入失败:\x20'+_0x1b63cd[_0x1baf49(0x86e)]);}}async function _0x5a6cbe(_0x2eb7b4){const _0x3680f9=_0x419fa8;if(!_0x2eb7b4)return;const _0x35b91a=await _0x352ae9(_0x3680f9(0x3ec),_0x3680f9(0x57f),{'confirmButtonClass':_0x3680f9(0x12bc)});if(!_0x35b91a)return;await _0x1bff53('请稍候...','正在读取并解析备份文件...');try{const _0x32cf26=await _0x2eb7b4['text'](),_0x4b7fa4=JSON['parse'](_0x32cf26);if(_0x4b7fa4['data']&&typeof _0x4b7fa4[_0x3680f9(0x100d)]===_0x3680f9(0xc24)&&_0x4b7fa4[_0x3680f9(0x100d)][_0x3680f9(0x547)])console[_0x3680f9(0x283)](_0x3680f9(0xfbc)),await _0x5f42ec(_0x4b7fa4['data']);else{if(_0x4b7fa4['chats'])console[_0x3680f9(0x283)]('检测到旧版完整备份文件，开始导入...'),await _0x1c23a6(_0x4b7fa4);else throw new Error(_0x3680f9(0x1307));}await _0x1bff53(_0x3680f9(0x135e),_0x3680f9(0xd7d)),setTimeout(()=>{const _0x18b865=_0x3680f9;window[_0x18b865(0x394)][_0x18b865(0xea6)]();},0x5dc);}catch(_0x30c8e7){console[_0x3680f9(0x1221)](_0x3680f9(0x893),_0x30c8e7),await _0x1bff53(_0x3680f9(0x685),_0x3680f9(0x3a2)+_0x30c8e7['message']);}}async function _0x1c23a6(_0x3377dc){const _0x165a12=_0x419fa8;try{await _0x2c5bcf['transaction']('rw',_0x2c5bcf[_0x165a12(0xe42)],async()=>{const _0x1c08b2=_0x165a12;await _0x2c5bcf[_0x1c08b2(0x547)][_0x1c08b2(0xdae)](),await _0x2c5bcf[_0x1c08b2(0x1369)][_0x1c08b2(0xdae)]();for(const _0x2eda41 of _0x2c5bcf[_0x1c08b2(0xe42)]){await _0x2eda41['clear']();}if(Array[_0x1c08b2(0xb27)](_0x3377dc['chats']))await _0x2c5bcf['chats'][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0x547)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc[_0x1c08b2(0x1369)]))await _0x2c5bcf['worldBooks'][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0x1369)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc[_0x1c08b2(0x774)]))await _0x2c5bcf[_0x1c08b2(0x774)][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0x774)]);if(_0x3377dc[_0x1c08b2(0x4de)])await _0x2c5bcf[_0x1c08b2(0x4de)][_0x1c08b2(0xff5)](_0x3377dc['apiConfig']);if(_0x3377dc[_0x1c08b2(0x1383)])await _0x2c5bcf[_0x1c08b2(0x1383)][_0x1c08b2(0xff5)](_0x3377dc[_0x1c08b2(0x1383)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc[_0x1c08b2(0x40d)]))await _0x2c5bcf[_0x1c08b2(0x40d)][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0x40d)]);if(_0x3377dc[_0x1c08b2(0x53c)])await _0x2c5bcf[_0x1c08b2(0x53c)]['put'](_0x3377dc[_0x1c08b2(0x53c)]);if(_0x3377dc['qzoneSettings'])await _0x2c5bcf[_0x1c08b2(0x32c)][_0x1c08b2(0xff5)](_0x3377dc[_0x1c08b2(0x32c)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc['qzonePosts']))await _0x2c5bcf[_0x1c08b2(0x75f)]['bulkPut'](_0x3377dc[_0x1c08b2(0x75f)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc[_0x1c08b2(0x6dc)]))await _0x2c5bcf[_0x1c08b2(0x6dc)]['bulkPut'](_0x3377dc[_0x1c08b2(0x6dc)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc['qzonePhotos']))await _0x2c5bcf[_0x1c08b2(0x373)][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0x373)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc[_0x1c08b2(0xc09)]))await _0x2c5bcf[_0x1c08b2(0xc09)][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0xc09)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc[_0x1c08b2(0xaf2)]))await _0x2c5bcf['qzoneGroups'][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0xaf2)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc['memories']))await _0x2c5bcf['memories'][_0x1c08b2(0x1113)](_0x3377dc['memories']);if(Array[_0x1c08b2(0xb27)](_0x3377dc['worldBookCategories']))await _0x2c5bcf[_0x1c08b2(0x58a)][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0x58a)]);if(Array['isArray'](_0x3377dc[_0x1c08b2(0xa2e)]))await _0x2c5bcf[_0x1c08b2(0xa2e)][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0xa2e)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc[_0x1c08b2(0x281)]))await _0x2c5bcf[_0x1c08b2(0x281)]['bulkPut'](_0x3377dc[_0x1c08b2(0x281)]);if(Array['isArray'](_0x3377dc[_0x1c08b2(0x852)]))await _0x2c5bcf[_0x1c08b2(0x852)]['bulkPut'](_0x3377dc['callRecords']);if(Array[_0x1c08b2(0xb27)](_0x3377dc[_0x1c08b2(0x1349)]))await _0x2c5bcf['renderingRules']['bulkPut'](_0x3377dc[_0x1c08b2(0x1349)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc['doubanPosts']))await _0x2c5bcf[_0x1c08b2(0x8af)][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0x8af)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc[_0x1c08b2(0x1342)]))await _0x2c5bcf[_0x1c08b2(0x1342)][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0x1342)]);if(Array['isArray'](_0x3377dc[_0x1c08b2(0xdc6)]))await _0x2c5bcf[_0x1c08b2(0xdc6)][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0xdc6)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc[_0x1c08b2(0x10ef)]))await _0x2c5bcf['presets']['bulkPut'](_0x3377dc['presets']);if(Array[_0x1c08b2(0xb27)](_0x3377dc[_0x1c08b2(0x99f)]))await _0x2c5bcf[_0x1c08b2(0x99f)][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0x99f)]);if(Array[_0x1c08b2(0xb27)](_0x3377dc['npcs']))await _0x2c5bcf[_0x1c08b2(0x1094)][_0x1c08b2(0x1113)](_0x3377dc[_0x1c08b2(0x1094)]);});}catch(_0x2df4e1){throw new Error(_0x165a12(0x1215)+_0x2df4e1[_0x165a12(0x86e)]);}}function _0xd42b1c(_0x51e29c,_0x48b6be=![]){const _0x143048=_0x419fa8;if(!_0x51e29c){_0x471902[_0x143048(0x2f5)]='',document[_0x143048(0x9c8)](_0x143048(0x654))[_0x143048(0x5e1)][_0x143048(0x80d)]='';return;}const _0x236c53=_0x143048(0x1064),_0x53ded1='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27'+_0x236c53+_0x143048(0xf8f)+_0x51e29c+_0x143048(0xe45);if(_0x48b6be){const _0x447e4b=document[_0x143048(0x9c8)](_0x143048(0x7c9))||document[_0x143048(0x28a)](_0x143048(0x5e1));_0x447e4b['id']=_0x143048(0x7c9),_0x447e4b[_0x143048(0x2f5)]=_0x53ded1;if(!document['getElementById'](_0x143048(0x7c9)))document[_0x143048(0x37a)]['appendChild'](_0x447e4b);document[_0x143048(0x9c8)](_0x143048(0x654))[_0x143048(0x5e1)][_0x143048(0x80d)]='\x27'+_0x236c53+_0x143048(0xd5d);}else _0x471902[_0x143048(0x2f5)]=_0x143048(0x138b)+_0x53ded1+_0x143048(0x4d6)+_0x236c53+_0x143048(0xe7a);}async function _0x3caa94(){const _0x3d5c56=_0x419fa8;_0x471902[_0x3d5c56(0x2f5)]='',_0x9ebf46[_0x3d5c56(0x1383)][_0x3d5c56(0x88a)]='',await _0x2c5bcf[_0x3d5c56(0x1383)][_0x3d5c56(0xff5)](_0x9ebf46[_0x3d5c56(0x1383)]),document['getElementById']('font-url-input')[_0x3d5c56(0x1155)]='',document[_0x3d5c56(0x9c8)](_0x3d5c56(0x654))[_0x3d5c56(0x5e1)]['fontFamily']='',alert(_0x3d5c56(0xe8a));}async function _0x41edb1(){const _0x3f2de4=_0x419fa8,[_0x28a468,_0x3cf335,_0x3dc234,_0x39fd9a,_0xed7e5c,_0x4c482c,_0x396726,_0x30ad6b,_0xbb5497,_0x43bbf3,_0x13b468]=await Promise['all']([_0x2c5bcf['chats'][_0x3f2de4(0x5ff)](),_0x2c5bcf[_0x3f2de4(0x4de)]['get'](_0x3f2de4(0x121f)),_0x2c5bcf[_0x3f2de4(0x1383)]['get'](_0x3f2de4(0x121f)),_0x2c5bcf['userStickers']['toArray'](),_0x2c5bcf['worldBooks'][_0x3f2de4(0x5ff)](),_0x2c5bcf['musicLibrary']['get'](_0x3f2de4(0x121f)),_0x2c5bcf[_0x3f2de4(0x40d)][_0x3f2de4(0x5ff)](),_0x2c5bcf['qzoneSettings']['get']('main'),_0x2c5bcf[_0x3f2de4(0xc09)][_0x3f2de4(0x8ea)](_0x3f2de4(0x6b5))[_0x3f2de4(0x101e)]()[_0x3f2de4(0x5ff)](),_0x2c5bcf[_0x3f2de4(0x137e)]['toArray'](),_0x2c5bcf['presets']['toArray']()]);_0x9ebf46[_0x3f2de4(0x10ef)]=_0x13b468||[];const _0x38804b={'id':_0x3f2de4(0x121f),'showStatusBar':![],'wallpaper':_0x3f2de4(0x10a5),'fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0x3949d8},'cphoneWallpaper':_0x3f2de4(0x435),'cphoneAppIcons':{..._0x20bbe1},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x9ebf46[_0x3f2de4(0x1383)]={..._0x38804b,..._0x3dc234||{}},_0x9ebf46['globalSettings']['appIcons']={..._0x38804b[_0x3f2de4(0x11b3)],..._0x9ebf46[_0x3f2de4(0x1383)][_0x3f2de4(0x11b3)]||{}},_0x9ebf46[_0x3f2de4(0x1383)][_0x3f2de4(0xe9b)]={..._0x38804b[_0x3f2de4(0xe9b)],..._0x9ebf46['globalSettings'][_0x3f2de4(0xe9b)]||{}},_0x28a468[_0x3f2de4(0x591)](_0x3a44e5=>{const _0x18da45=_0x3f2de4;typeof _0x3a44e5[_0x18da45(0x1131)][_0x18da45(0x64b)]==='undefined'&&(_0x3a44e5[_0x18da45(0x1131)]['enableTimePerception']=!![]),!_0x3a44e5[_0x18da45(0x1131)]['lyricsPosition']&&(_0x3a44e5['settings'][_0x18da45(0xd55)]={'vertical':_0x18da45(0x114a),'horizontal':'center','offset':0xa}),!_0x3a44e5['isGroup']&&!_0x3a44e5[_0x18da45(0x1131)][_0x18da45(0xd7a)]&&(_0x3a44e5[_0x18da45(0x1131)][_0x18da45(0xd7a)]=[]),!_0x3a44e5[_0x18da45(0x11e4)]&&typeof _0x3a44e5[_0x18da45(0x1071)]==='undefined'&&(_0x3a44e5[_0x18da45(0x1071)]=_0x3a44e5[_0x18da45(0x609)]);}),_0x9ebf46[_0x3f2de4(0x547)]=_0x28a468[_0x3f2de4(0x12c1)]((_0x24377b,_0x2b227a)=>{const _0x4cc343=_0x3f2de4;if(typeof _0x2b227a[_0x4cc343(0x382)]===_0x4cc343(0xa20))_0x2b227a[_0x4cc343(0x382)]=0x0;_0x2b227a[_0x4cc343(0x11e4)]&&(typeof _0x2b227a[_0x4cc343(0x1131)]['enableBackgroundActivity']==='undefined'&&(_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x22a)]=!![]),_0x2b227a[_0x4cc343(0xd3e)]&&_0x2b227a['members'][_0x4cc343(0xa06)]>0x0&&_0x2b227a[_0x4cc343(0xd3e)][0x0][_0x4cc343(0x609)]&&_0x2b227a[_0x4cc343(0xd3e)][_0x4cc343(0x591)](_0x31f304=>{const _0x180560=_0x4cc343;typeof _0x31f304[_0x180560(0x1071)]===_0x180560(0xa20)&&(_0x31f304[_0x180560(0x1071)]=_0x31f304[_0x180560(0x609)],_0x31f304[_0x180560(0x1132)]=_0x31f304[_0x180560(0x609)],delete _0x31f304[_0x180560(0x609)]);}));if(!_0x2b227a[_0x4cc343(0x1131)])_0x2b227a['settings']={};typeof _0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x664)]===_0x4cc343(0xa20)&&(_0x2b227a['settings']['actionCooldownMinutes']=0xa);if(!_0x2b227a['isGroup']&&!_0x2b227a[_0x4cc343(0xebd)])_0x2b227a[_0x4cc343(0xebd)]={'text':'在线','lastUpdate':Date['now'](),'isBusy':![]};if(!_0x2b227a[_0x4cc343(0x11e4)]&&!_0x2b227a[_0x4cc343(0x36f)])_0x2b227a[_0x4cc343(0x36f)]={'status':_0x4cc343(0x733),'blockedTimestamp':null,'applicationReason':''};if(!_0x2b227a[_0x4cc343(0x11e4)]&&(!_0x2b227a[_0x4cc343(0x1131)]||!_0x2b227a['settings'][_0x4cc343(0x295)])){if(!_0x2b227a[_0x4cc343(0x1131)])_0x2b227a[_0x4cc343(0x1131)]={};_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x295)]=[];}_0x2b227a['isGroup']&&(_0x2b227a[_0x4cc343(0xd3e)]||[])['forEach'](_0x4ccd74=>{const _0x304f0b=_0x4cc343;if(typeof _0x4ccd74[_0x304f0b(0x1141)]===_0x304f0b(0xa20))_0x4ccd74[_0x304f0b(0x1141)]='';});if(!_0x2b227a[_0x4cc343(0xbec)])_0x2b227a[_0x4cc343(0xbec)]={'totalTime':0x0};_0x2b227a[_0x4cc343(0x1131)]&&_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0xd28)]&&!_0x2b227a['settings']['linkedWorldBookIds']&&(_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x41a)]=[_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0xd28)]],delete _0x2b227a[_0x4cc343(0x1131)]['linkedWorldBookId']);if(typeof _0x2b227a[_0x4cc343(0xfac)]==='undefined')_0x2b227a['isPinned']=![];!_0x2b227a[_0x4cc343(0x11e4)]&&typeof _0x2b227a['settings'][_0x4cc343(0x29c)]===_0x4cc343(0xa20)&&(_0x2b227a['settings']['myNickname']='我');if(_0x2b227a[_0x4cc343(0x11e4)]&&_0x2b227a[_0x4cc343(0xd3e)]){let _0x532ab7=![];_0x28a468[_0x4cc343(0x591)](_0x3ed9ac=>{const _0x3bbf6b=_0x4cc343;_0x3ed9ac['id']===_0x2b227a['id']&&_0x3ed9ac['originalName']&&delete _0x3ed9ac[_0x3bbf6b(0x1071)];}),_0x2b227a['members'][_0x4cc343(0x591)](_0x15fd54=>{const _0x103db1=_0x4cc343,_0x3ba9ad=_0x28a468[_0x103db1(0xfc3)](_0x3d60e5=>_0x3d60e5['id']===_0x15fd54['id']);if(_0x3ba9ad&&_0x3ba9ad[_0x103db1(0x1131)]){const _0x21fa7f=_0x3ba9ad['settings']['aiAvatarFrame']||'';_0x15fd54['avatarFrame']!==_0x21fa7f&&(_0x15fd54[_0x103db1(0x1141)]=_0x21fa7f,_0x532ab7=!![]);}else typeof _0x15fd54[_0x103db1(0x1141)]===_0x103db1(0xa20)&&(_0x15fd54[_0x103db1(0x1141)]='',_0x532ab7=!![]);});if(_0x532ab7)_0x2c5bcf[_0x4cc343(0x547)]['put'](_0x2b227a);}if(!_0x2b227a[_0x4cc343(0x1131)]['enableAutoMemory'])_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x10df)]=![];if(!_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x874)])_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x874)]=0x14;if(!_0x2b227a[_0x4cc343(0x323)])_0x2b227a[_0x4cc343(0x323)]=[];if(!_0x2b227a[_0x4cc343(0xa40)])_0x2b227a['lastMemorySummaryTimestamp']=0x0;if(!_0x2b227a[_0x4cc343(0x11e4)]){typeof _0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x22a)]===_0x4cc343(0xa20)&&(_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x22a)]=!![]);typeof _0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0xd80)]===_0x4cc343(0xa20)&&(_0x2b227a['settings']['enableTts']=![]);if(!_0x2b227a[_0x4cc343(0xebd)])_0x2b227a[_0x4cc343(0xebd)]={'text':'在线','lastUpdate':Date[_0x4cc343(0x9b7)](),'isBusy':![]};if(!_0x2b227a[_0x4cc343(0x36f)])_0x2b227a['relationship']={'status':_0x4cc343(0x733),'blockedTimestamp':null,'applicationReason':''};if(!_0x2b227a[_0x4cc343(0x1131)]||!_0x2b227a['settings'][_0x4cc343(0x295)]){if(!_0x2b227a[_0x4cc343(0x1131)])_0x2b227a[_0x4cc343(0x1131)]={};_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x295)]=[];}if(typeof _0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x95b)]===_0x4cc343(0xa20))_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x95b)]=![];if(typeof _0x2b227a['settings'][_0x4cc343(0xa82)]===_0x4cc343(0xa20))_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0xa82)]=0x64;if(typeof _0x2b227a['settings']['offlineMaxLength']==='undefined')_0x2b227a[_0x4cc343(0x1131)]['offlineMaxLength']=0x12c;typeof _0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x31f)]===_0x4cc343(0xa20)&&(_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x31f)]=![]);if(typeof _0x2b227a[_0x4cc343(0x1291)]===_0x4cc343(0xa20))_0x2b227a['heartfeltVoice']=_0x4cc343(0xf66);if(typeof _0x2b227a[_0x4cc343(0xa1a)]===_0x4cc343(0xa20))_0x2b227a[_0x4cc343(0xa1a)]=_0x4cc343(0xf66);!Array[_0x4cc343(0xb27)](_0x2b227a['thoughtsHistory'])&&(_0x2b227a[_0x4cc343(0xec6)]=[]);}return typeof _0x2b227a[_0x4cc343(0x1131)]['stickerCategoryIds']===_0x4cc343(0xa20)&&(_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x1223)]?_0x2b227a['settings']['stickerCategoryIds']=[_0x2b227a[_0x4cc343(0x1131)][_0x4cc343(0x1223)]]:_0x2b227a[_0x4cc343(0x1131)]['stickerCategoryIds']=[],delete _0x2b227a[_0x4cc343(0x1131)]['stickerCategoryId']),_0x24377b[_0x2b227a['id']]=_0x2b227a,_0x24377b;},{});const _0x4384d6=[];_0x43bbf3[_0x3f2de4(0x591)](_0xe34dd6=>{const _0x270645=_0x3f2de4;if(_0xe34dd6[_0x270645(0x12d9)]===_0x270645(0x10fc)&&_0xe34dd6[_0x270645(0xa2c)]&&!_0xe34dd6[_0x270645(0x61c)]){const _0x545666=_0x28a468[_0x270645(0xfc3)](_0x308484=>!_0x308484[_0x270645(0x11e4)]&&_0x308484['originalName']===_0xe34dd6['authorName']);if(_0x545666)_0xe34dd6[_0x270645(0x61c)]=_0x545666['id'],_0x4384d6[_0x270645(0x668)](_0xe34dd6);else{const _0x54e808=_0x28a468['find'](_0x22239d=>!_0x22239d[_0x270645(0x11e4)]&&_0x22239d[_0x270645(0x609)]===_0xe34dd6['authorName']);_0x54e808&&(_0xe34dd6[_0x270645(0x61c)]=_0x54e808['id'],_0x4384d6[_0x270645(0x668)](_0xe34dd6));}}}),_0x4384d6['length']>0x0&&await _0x2c5bcf[_0x3f2de4(0x137e)][_0x3f2de4(0x1113)](_0x4384d6),_0x9ebf46[_0x3f2de4(0x4de)]=_0x3cf335||{'id':_0x3f2de4(0x121f),'proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':_0x3f2de4(0x5f9)},_0x9ebf46['userStickers']=_0x39fd9a||[],_0x9ebf46[_0x3f2de4(0x1369)]=_0xed7e5c||[],_0x5062a9[_0x3f2de4(0x8e6)]=_0x4c482c?.['playlist']||[],_0x9ebf46[_0x3f2de4(0x40d)]=_0x396726||[],_0x9ebf46['qzoneSettings']=_0x30ad6b||{'id':_0x3f2de4(0x121f),'nickname':'{{user}}','avatar':_0x3f2de4(0x617),'banner':_0x3f2de4(0xa7a)},allFavoriteItems=_0xbb5497||[];}async function _0x4b5360(){const _0xe3acb8=_0x419fa8;await _0x2c5bcf[_0xe3acb8(0x53c)][_0xe3acb8(0xff5)]({'id':_0xe3acb8(0x121f),'playlist':_0x5062a9['playlist']});}function _0x443608(_0x30ac3a){const _0x499406=_0x419fa8;if(!_0x30ac3a)return'';const _0x3ca8ea=new Date(_0x30ac3a),_0x25abf2=String(_0x3ca8ea[_0x499406(0x7a2)]())['padStart'](0x2,'0'),_0x5d78e4=String(_0x3ca8ea[_0x499406(0x3a6)]())[_0x499406(0x3e8)](0x2,'0');return _0x25abf2+':'+_0x5d78e4;}function _0x4fcd92(_0x30898f){const _0x42d1c4=_0x419fa8,_0x506fdc=Date['now'](),_0x5ddac0=Math[_0x42d1c4(0x5fb)]((_0x506fdc-_0x30898f)/0x3e8);if(_0x5ddac0<0x3c)return'刚刚';const _0x48223d=Math[_0x42d1c4(0x5fb)](_0x5ddac0/0x3c);if(_0x48223d<0x3c)return _0x48223d+_0x42d1c4(0x1248);const _0x490885=Math['floor'](_0x48223d/0x3c);if(_0x490885<0x18)return _0x490885+_0x42d1c4(0x95a);const _0x338259=Math[_0x42d1c4(0x5fb)](_0x490885/0x18);if(_0x338259<0x1e)return _0x338259+'天前';const _0x517db6=Math[_0x42d1c4(0x5fb)](_0x338259/0x1e);if(_0x517db6<0xc)return'大约'+_0x517db6+'个月前';const _0x710f36=Math['floor'](_0x338259/0x16d);return'大约'+_0x710f36+'年前';}function _0x47cd59(_0x5342c8){const _0x3f637b=_0x419fa8;if(!_0x5342c8)return'';const _0x4ca9b0=new Date(),_0x376a6b=new Date(_0x5342c8),_0x5d1b12=String(_0x376a6b[_0x3f637b(0x7a2)]())['padStart'](0x2,'0'),_0x1949d4=String(_0x376a6b[_0x3f637b(0x3a6)]())[_0x3f637b(0x3e8)](0x2,'0'),_0xce7f95=_0x5d1b12+':'+_0x1949d4;if(_0x4ca9b0[_0x3f637b(0x3c2)]()===_0x376a6b[_0x3f637b(0x3c2)]())return _0x3f637b(0x724)+_0xce7f95;const _0x137c6a=new Date();_0x137c6a[_0x3f637b(0xe66)](_0x4ca9b0[_0x3f637b(0xa13)]()-0x1);if(_0x137c6a['toDateString']()===_0x376a6b[_0x3f637b(0x3c2)]())return _0x3f637b(0xfe0)+_0xce7f95;if(_0x4ca9b0['getFullYear']()===_0x376a6b[_0x3f637b(0x10cd)]()){const _0x507f58=String(_0x376a6b['getMonth']()+0x1),_0x57f2dc=String(_0x376a6b[_0x3f637b(0xa13)]());return _0x507f58+'月'+_0x57f2dc+'日\x20'+_0xce7f95;}const _0x449b63=_0x376a6b[_0x3f637b(0x10cd)](),_0x5f3e99=String(_0x376a6b[_0x3f637b(0x260)]()+0x1),_0x100abf=String(_0x376a6b[_0x3f637b(0xa13)]());return _0x449b63+'年'+_0x5f3e99+'月'+_0x100abf+'日\x20'+_0xce7f95;}function _0x388726(){const _0x52b055=_0x419fa8,_0x14aab7=_0x462263();document[_0x52b055(0x9c8)]('nai-resolution')[_0x52b055(0x1155)]=_0x14aab7[_0x52b055(0xc85)],document['getElementById'](_0x52b055(0xc98))['value']=_0x14aab7['steps'],document[_0x52b055(0x9c8)](_0x52b055(0x899))['value']=_0x14aab7['cfg_scale'],document[_0x52b055(0x9c8)]('nai-sampler')[_0x52b055(0x1155)]=_0x14aab7['sampler'],document[_0x52b055(0x9c8)](_0x52b055(0x1130))[_0x52b055(0x1155)]=_0x14aab7['seed'],document[_0x52b055(0x9c8)]('nai-uc-preset')[_0x52b055(0x1155)]=_0x14aab7[_0x52b055(0x121d)],document['getElementById']('nai-quality-toggle')['checked']=_0x14aab7['quality_toggle'],document[_0x52b055(0x9c8)](_0x52b055(0x3b2))[_0x52b055(0x1ec)]=_0x14aab7[_0x52b055(0x116e)],document[_0x52b055(0x9c8)](_0x52b055(0x1305))['checked']=_0x14aab7['smea_dyn'],document[_0x52b055(0x9c8)](_0x52b055(0x914))['value']=_0x14aab7['default_positive'],document[_0x52b055(0x9c8)](_0x52b055(0xf9b))[_0x52b055(0x1155)]=_0x14aab7['default_negative'],document[_0x52b055(0x9c8)]('nai-cors-proxy')[_0x52b055(0x1155)]=_0x14aab7[_0x52b055(0xa5f)],document[_0x52b055(0x9c8)](_0x52b055(0x12a6))[_0x52b055(0x1155)]=_0x14aab7[_0x52b055(0xc23)]||'';const _0x5a8e01=document[_0x52b055(0x9c8)](_0x52b055(0x255));_0x5a8e01['style'][_0x52b055(0x3c5)]=_0x14aab7[_0x52b055(0xa5f)]===_0x52b055(0x13c6)?'block':_0x52b055(0x8f6);}function _0x43ebac(){const _0x22f490=_0x419fa8,_0x2d6b97=document[_0x22f490(0x9c8)]('novelai-switch')[_0x22f490(0x1ec)],_0x45725d=document[_0x22f490(0x9c8)](_0x22f490(0x8e5))[_0x22f490(0x1155)],_0x30dca8=document[_0x22f490(0x9c8)](_0x22f490(0xef8))[_0x22f490(0x1155)][_0x22f490(0x3f1)]();localStorage[_0x22f490(0xa65)](_0x22f490(0xe51),_0x2d6b97),localStorage['setItem'](_0x22f490(0x8e5),_0x45725d),localStorage[_0x22f490(0xa65)](_0x22f490(0xef8),_0x30dca8);const _0x12c451={'resolution':document['getElementById'](_0x22f490(0x18e))['value'],'steps':parseInt(document['getElementById'](_0x22f490(0xc98))[_0x22f490(0x1155)]),'cfg_scale':parseFloat(document[_0x22f490(0x9c8)]('nai-cfg-scale')[_0x22f490(0x1155)]),'sampler':document[_0x22f490(0x9c8)]('nai-sampler')[_0x22f490(0x1155)],'seed':parseInt(document['getElementById'](_0x22f490(0x1130))['value']),'uc_preset':parseInt(document['getElementById'](_0x22f490(0x5fd))[_0x22f490(0x1155)]),'quality_toggle':document['getElementById']('nai-quality-toggle')[_0x22f490(0x1ec)],'smea':document['getElementById'](_0x22f490(0x3b2))[_0x22f490(0x1ec)],'smea_dyn':document[_0x22f490(0x9c8)](_0x22f490(0x1305))[_0x22f490(0x1ec)],'default_positive':document[_0x22f490(0x9c8)]('nai-default-positive')[_0x22f490(0x1155)],'default_negative':document['getElementById'](_0x22f490(0xf9b))[_0x22f490(0x1155)],'cors_proxy':document[_0x22f490(0x9c8)](_0x22f490(0x967))[_0x22f490(0x1155)],'custom_proxy_url':document[_0x22f490(0x9c8)](_0x22f490(0x12a6))['value']};localStorage[_0x22f490(0xa65)](_0x22f490(0xff9),JSON[_0x22f490(0xf1e)](_0x12c451));}function _0x2a520e(){const _0x2964e1=_0x419fa8;localStorage[_0x2964e1(0x479)](_0x2964e1(0xff9)),_0x388726(),alert('已恢复默认设置！');}function _0x462263(){const _0x1a34b7=_0x419fa8,_0x548ed4={'resolution':_0x1a34b7(0xa5c),'steps':0x1c,'cfg_scale':0x5,'sampler':_0x1a34b7(0x11cf),'seed':-0x1,'uc_preset':0x1,'quality_toggle':!![],'smea':!![],'smea_dyn':![],'default_positive':_0x1a34b7(0xf41),'default_negative':_0x1a34b7(0x33b),'cors_proxy':_0x1a34b7(0x5ac),'custom_proxy_url':''},_0x36793d=localStorage[_0x1a34b7(0x1290)](_0x1a34b7(0xff9));if(_0x36793d)try{return{..._0x548ed4,...JSON['parse'](_0x36793d)};}catch(_0x5cb49c){return _0x548ed4;}return _0x548ed4;}function _0x141b22(_0x5cbac4){const _0x511d19=_0x419fa8,_0x159b9a=_0x462263();if(!_0x5cbac4||!_0x9ebf46[_0x511d19(0x547)][_0x5cbac4])return console[_0x511d19(0x283)](_0x511d19(0xa72)),{'positive':_0x159b9a[_0x511d19(0x543)],'negative':_0x159b9a[_0x511d19(0x402)],'source':_0x511d19(0xb64)};const _0xd2fb79=_0x9ebf46[_0x511d19(0x547)][_0x5cbac4],_0x59e369=_0xd2fb79[_0x511d19(0x1131)][_0x511d19(0xf03)]||{};return _0x59e369['promptSource']===_0x511d19(0x96c)?(console['log'](_0x511d19(0x461)),console['log'](_0x511d19(0x1084),_0x59e369[_0x511d19(0x12af)]||_0x511d19(0x9d2)),console[_0x511d19(0x283)](_0x511d19(0x42e),_0x59e369['characterNegativePrompt']||_0x511d19(0x9d2)),{'positive':_0x59e369[_0x511d19(0x12af)]||'','negative':_0x59e369['characterNegativePrompt']||'','source':_0x511d19(0x96c)}):(console[_0x511d19(0x283)](_0x511d19(0x124f)),console[_0x511d19(0x283)]('\x20\x20\x20正面:',_0x159b9a[_0x511d19(0x543)]||_0x511d19(0x9d2)),console['log'](_0x511d19(0x42e),_0x159b9a['default_negative']||_0x511d19(0x9d2)),{'positive':_0x159b9a[_0x511d19(0x543)],'negative':_0x159b9a[_0x511d19(0x402)],'source':_0x511d19(0xb64)});}async function _0xe6d441(){const _0x4a997b=_0x419fa8,_0xe09ed6=document[_0x4a997b(0x9c8)]('novelai-api-key')[_0x4a997b(0x1155)][_0x4a997b(0x3f1)](),_0x30f7ec=document[_0x4a997b(0x9c8)](_0x4a997b(0x8e5))[_0x4a997b(0x1155)],_0x46ad06=document[_0x4a997b(0x9c8)]('nai-test-prompt')[_0x4a997b(0x1155)]['trim']();if(!_0xe09ed6){alert(_0x4a997b(0xe2e));return;}if(!_0x46ad06){alert(_0x4a997b(0x1357));return;}const _0x279d69=_0x462263(),_0x287d79=document[_0x4a997b(0x9c8)](_0x4a997b(0x916))[_0x4a997b(0x1155)][_0x4a997b(0x3f1)](),_0x2c31eb=document[_0x4a997b(0x9c8)](_0x4a997b(0xae9)),_0x32b685=document[_0x4a997b(0x9c8)]('nai-test-result'),_0xe2c82d=document[_0x4a997b(0x9c8)](_0x4a997b(0x641)),_0x1d18a8=document[_0x4a997b(0x9c8)](_0x4a997b(0x30d));_0x2c31eb[_0x4a997b(0x5e1)]['display']=_0x4a997b(0x3d9),_0x32b685['style'][_0x4a997b(0x3c5)]=_0x4a997b(0x8f6),_0xe2c82d['style'][_0x4a997b(0x3c5)]=_0x4a997b(0x8f6),_0x1d18a8['disabled']=!![],_0x1d18a8[_0x4a997b(0xe24)]=_0x4a997b(0xfe7);try{const [_0x3a0ff0,_0x2cc1fe]=_0x279d69[_0x4a997b(0xc85)][_0x4a997b(0x6c6)]('x')['map'](Number);let _0x2eb526;_0x30f7ec[_0x4a997b(0x930)](_0x4a997b(0x38b))?_0x2eb526={'input':_0x46ad06,'model':_0x30f7ec,'action':'generate','parameters':{'params_version':0x3,'width':_0x3a0ff0,'height':_0x2cc1fe,'scale':_0x279d69[_0x4a997b(0xb18)],'sampler':_0x279d69['sampler'],'steps':_0x279d69[_0x4a997b(0x91e)],'seed':_0x279d69['seed']===-0x1?Math[_0x4a997b(0x5fb)](Math[_0x4a997b(0x360)]()*0x2540be3ff):_0x279d69['seed'],'n_samples':0x1,'ucPreset':_0x279d69['uc_preset'],'qualityToggle':_0x279d69[_0x4a997b(0x1080)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x4a997b(0x128d),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x46ad06,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x287d79,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x287d79,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x2eb526={'input':_0x46ad06,'model':_0x30f7ec,'action':_0x4a997b(0x7b7),'parameters':{'width':_0x3a0ff0,'height':_0x2cc1fe,'scale':_0x279d69['cfg_scale'],'sampler':_0x279d69[_0x4a997b(0x900)],'steps':_0x279d69[_0x4a997b(0x91e)],'seed':_0x279d69[_0x4a997b(0x10f8)]===-0x1?Math['floor'](Math[_0x4a997b(0x360)]()*0x2540be3ff):_0x279d69['seed'],'n_samples':0x1,'ucPreset':_0x279d69[_0x4a997b(0x121d)],'qualityToggle':_0x279d69[_0x4a997b(0x1080)],'sm':_0x279d69['smea'],'sm_dyn':_0x279d69['smea_dyn'],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x4a997b(0xe3c),'negative_prompt':_0x287d79}};console[_0x4a997b(0x283)](_0x4a997b(0xb20)),console[_0x4a997b(0x283)](_0x4a997b(0x25f),_0x30f7ec),console[_0x4a997b(0x283)](_0x4a997b(0xd46),JSON[_0x4a997b(0xf1e)](_0x2eb526,null,0x2));let _0x58da68;_0x30f7ec[_0x4a997b(0x930)](_0x4a997b(0x38b))?_0x58da68=_0x4a997b(0x354):_0x58da68='https://image.novelai.net/ai/generate-image';let _0x266584=_0x279d69[_0x4a997b(0xa5f)];_0x266584==='custom'&&(_0x266584=_0x279d69[_0x4a997b(0xc23)]||'');_0x266584&&_0x266584!==''&&(_0x58da68=_0x266584+encodeURIComponent(_0x58da68));const _0x153979=/Chrome/[_0x4a997b(0x4e8)](navigator[_0x4a997b(0x881)])&&!/Edg/['test'](navigator[_0x4a997b(0x881)]);let _0xf52406={'method':_0x4a997b(0x116f),'headers':{'Content-Type':_0x4a997b(0x698),'Authorization':_0x4a997b(0x84a)+_0xe09ed6},'body':JSON[_0x4a997b(0xf1e)](_0x2eb526)};if(_0x153979){console[_0x4a997b(0x283)](_0x4a997b(0xa37));const _0x39baa6={};for(const [_0xc9f2b3,_0x2a9c70]of Object[_0x4a997b(0x1231)](_0xf52406[_0x4a997b(0xda4)])){_0x39baa6[_0xc9f2b3]=_0x2a9c70['replace'](/[^\x00-\xFF]/g,'');}_0xf52406[_0x4a997b(0xda4)]=_0x39baa6;}const _0x26ae50=await fetch(_0x58da68,_0xf52406);console[_0x4a997b(0x283)]('Response\x20status:',_0x26ae50[_0x4a997b(0xebd)]),console[_0x4a997b(0x283)](_0x4a997b(0xf9a),[..._0x26ae50[_0x4a997b(0xda4)][_0x4a997b(0x1231)]()]);if(!_0x26ae50['ok']){const _0x2a0b99=await _0x26ae50[_0x4a997b(0xbb7)]();console[_0x4a997b(0x1221)]('API错误响应:',_0x2a0b99);throw new Error(_0x4a997b(0xafa)+_0x26ae50[_0x4a997b(0xebd)]+_0x4a997b(0x301)+_0x2a0b99);}const _0xe0ebff=_0x26ae50[_0x4a997b(0xda4)][_0x4a997b(0xdf9)]('content-type');console['log'](_0x4a997b(0x2af),_0xe0ebff);let _0x2dc50e;if(_0xe0ebff&&_0xe0ebff['includes']('text/event-stream')){console['log'](_0x4a997b(0x250)),_0x2c31eb[_0x4a997b(0xe24)]=_0x4a997b(0x9ab);const _0x3850a9=await _0x26ae50['text']();console[_0x4a997b(0x283)](_0x4a997b(0xa60),_0x3850a9[_0x4a997b(0xa06)]);const _0x43f38a=_0x3850a9[_0x4a997b(0x3f1)]()[_0x4a997b(0x6c6)]('\x0a');let _0x375ceb=null;for(let _0x3f51fb=_0x43f38a[_0x4a997b(0xa06)]-0x1;_0x3f51fb>=0x0;_0x3f51fb--){const _0x5bbf8c=_0x43f38a[_0x3f51fb][_0x4a997b(0x3f1)]();if(_0x5bbf8c['startsWith'](_0x4a997b(0xd78))&&_0x5bbf8c!==_0x4a997b(0x128a)){const _0x398378=_0x5bbf8c[_0x4a997b(0xc34)](0x6);try{const _0x4959e7=JSON[_0x4a997b(0x907)](_0x398378);if(_0x4959e7[_0x4a997b(0x119c)]===_0x4a997b(0x1313)&&_0x4959e7[_0x4a997b(0x10eb)]){_0x375ceb=_0x4959e7[_0x4a997b(0x10eb)],console[_0x4a997b(0x283)](_0x4a997b(0xd06));break;}if(_0x4959e7[_0x4a997b(0x100d)]){_0x375ceb=_0x4959e7['data'],console[_0x4a997b(0x283)](_0x4a997b(0xbe8));break;}if(_0x4959e7[_0x4a997b(0x10eb)]){_0x375ceb=_0x4959e7[_0x4a997b(0x10eb)],console['log']('从\x20JSON.image\x20中提取图片数据');break;}}catch(_0x3f80c4){_0x375ceb=_0x398378,console['log'](_0x4a997b(0xab2));break;}}}if(!_0x375ceb)throw new Error(_0x4a997b(0xa07));const _0xae5bdf=_0x375ceb[_0x4a997b(0xc8d)](_0x4a997b(0xd2a)),_0x510d1a=_0x375ceb[_0x4a997b(0xc8d)](_0x4a997b(0xf09));if(_0xae5bdf||_0x510d1a){console[_0x4a997b(0x283)](_0x4a997b(0xc0b));const _0x27c46b=atob(_0x375ceb),_0xdb2e54=new Uint8Array(_0x27c46b[_0x4a997b(0xa06)]);for(let _0xcf9459=0x0;_0xcf9459<_0x27c46b[_0x4a997b(0xa06)];_0xcf9459++){_0xdb2e54[_0xcf9459]=_0x27c46b[_0x4a997b(0xf76)](_0xcf9459);}const _0x3a920e=new Blob([_0xdb2e54],{'type':_0xae5bdf?_0x4a997b(0xb19):_0x4a997b(0xc82)});console[_0x4a997b(0x283)](_0x4a997b(0xa09),_0x3a920e[_0x4a997b(0xa67)]);const _0x513613=URL[_0x4a997b(0x5bb)](_0x3a920e);document['getElementById']('nai-result-image')[_0x4a997b(0xbf4)]=_0x513613,_0x2c31eb[_0x4a997b(0x5e1)][_0x4a997b(0x3c5)]=_0x4a997b(0x8f6),_0x32b685[_0x4a997b(0x5e1)][_0x4a997b(0x3c5)]=_0x4a997b(0x3d9),console[_0x4a997b(0x283)]('✅\x20图片显示成功！🎨');return;}console[_0x4a997b(0x283)](_0x4a997b(0xbc8));const _0x36c904=atob(_0x375ceb),_0x1ae64f=new Uint8Array(_0x36c904[_0x4a997b(0xa06)]);for(let _0x8432fc=0x0;_0x8432fc<_0x36c904[_0x4a997b(0xa06)];_0x8432fc++){_0x1ae64f[_0x8432fc]=_0x36c904['charCodeAt'](_0x8432fc);}_0x2dc50e=new Blob([_0x1ae64f]),console[_0x4a997b(0x283)](_0x4a997b(0x4f6),_0x2dc50e[_0x4a997b(0xa67)]);}else _0x2dc50e=await _0x26ae50[_0x4a997b(0xa6e)](),console['log'](_0x4a997b(0xe10),_0x2dc50e[_0x4a997b(0x12d9)],'大小:',_0x2dc50e[_0x4a997b(0xa67)]);try{if(typeof JSZip===_0x4a997b(0xa20))throw new Error('JSZip库未加载，请刷新页面重试');_0x2c31eb[_0x4a997b(0xe24)]=_0x4a997b(0x7da);const _0x2d63ab=await JSZip['loadAsync'](_0x2dc50e);console[_0x4a997b(0x283)](_0x4a997b(0x755),Object[_0x4a997b(0x2bd)](_0x2d63ab['files']));let _0x18c1c4=null;for(let _0x42d04b in _0x2d63ab['files']){if(_0x42d04b[_0x4a997b(0x12c2)](/\.(png|jpg|jpeg|webp)$/i)){_0x18c1c4=_0x2d63ab[_0x4a997b(0x1216)][_0x42d04b],console['log']('找到图片文件:',_0x42d04b);break;}}if(!_0x18c1c4)throw new Error(_0x4a997b(0x1224));const _0xa76fef=await _0x18c1c4[_0x4a997b(0x43d)](_0x4a997b(0xa6e));console[_0x4a997b(0x283)](_0x4a997b(0x7dd),_0xa76fef[_0x4a997b(0xa67)]);const _0x19ebe1=URL[_0x4a997b(0x5bb)](_0xa76fef);console[_0x4a997b(0x283)](_0x4a997b(0xb28),_0x19ebe1),document['getElementById']('nai-result-image')[_0x4a997b(0xbf4)]=_0x19ebe1,_0x2c31eb['style'][_0x4a997b(0x3c5)]='none',_0x32b685[_0x4a997b(0x5e1)][_0x4a997b(0x3c5)]='block';}catch(_0x244ec0){console[_0x4a997b(0x1221)](_0x4a997b(0xccf),_0x244ec0),console[_0x4a997b(0x283)](_0x4a997b(0xa8a));if(_0x2dc50e[_0x4a997b(0x12d9)][_0x4a997b(0xc8d)](_0x4a997b(0xef4))){const _0x8712a8=URL[_0x4a997b(0x5bb)](_0x2dc50e);document[_0x4a997b(0x9c8)](_0x4a997b(0x568))[_0x4a997b(0xbf4)]=_0x8712a8,_0x2c31eb[_0x4a997b(0x5e1)][_0x4a997b(0x3c5)]='none',_0x32b685[_0x4a997b(0x5e1)][_0x4a997b(0x3c5)]='block';}else throw new Error(_0x4a997b(0x35c)+_0x244ec0['message']);}}catch(_0x598661){console['error'](_0x4a997b(0xb3a),_0x598661),_0x2c31eb['style'][_0x4a997b(0x3c5)]=_0x4a997b(0x8f6),_0xe2c82d[_0x4a997b(0x5e1)]['display']=_0x4a997b(0x3d9),_0xe2c82d[_0x4a997b(0xe24)]=_0x4a997b(0x688)+_0x598661['message'];}finally{_0x1d18a8[_0x4a997b(0x823)]=![],_0x1d18a8['textContent']=_0x4a997b(0x867);}}function _0x52c10d(_0x18e9c2,_0x1cc42d){const _0x3eff60=_0x419fa8;_0xf6d7e9(),clearTimeout(_0x5cf886);const _0xe4cac4=_0x9ebf46[_0x3eff60(0x547)][_0x18e9c2];if(!_0xe4cac4)return;const _0x14b810=document['getElementById']('notification-bar');document[_0x3eff60(0x9c8)](_0x3eff60(0x62d))['src']=_0xe4cac4[_0x3eff60(0x1131)][_0x3eff60(0xd4d)]||_0xe4cac4['settings'][_0x3eff60(0xa79)]||_0x246753,document[_0x3eff60(0x9c8)](_0x3eff60(0x496))[_0x3eff60(0x91d)](_0x3eff60(0x1273))[_0x3eff60(0xe24)]=_0xe4cac4[_0x3eff60(0x609)],document[_0x3eff60(0x9c8)](_0x3eff60(0x496))[_0x3eff60(0x91d)]('.message')[_0x3eff60(0xe24)]=_0x1cc42d,_0x14b810[_0x3eff60(0x575)][_0x3eff60(0x30f)](_0x3eff60(0xc3f)),void _0x14b810[_0x3eff60(0x138e)],_0x14b810['classList'][_0x3eff60(0x68e)](_0x3eff60(0xc3f));const _0x3a1124=_0x14b810[_0x3eff60(0x75c)](!![]);_0x14b810[_0x3eff60(0x127d)][_0x3eff60(0x4d7)](_0x3a1124,_0x14b810),_0x3a1124[_0x3eff60(0xa0f)](_0x3eff60(0xf5c),()=>{const _0x4e6c11=_0x3eff60;_0x49f56e(_0x18e9c2),_0x3a1124[_0x4e6c11(0x575)][_0x4e6c11(0x30f)]('visible');}),_0x5cf886=setTimeout(()=>{const _0x497875=_0x3eff60;_0x3a1124['classList'][_0x497875(0x30f)](_0x497875(0xc3f));},0xfa0),_0x159e72();}function _0x1ed2c5(){const _0x27312c=_0x419fa8,_0x2c09c7=new Date(),_0x48b159=_0x2c09c7[_0x27312c(0x120b)](_0x27312c(0x101b),{'hour':_0x27312c(0x691),'minute':_0x27312c(0x691)}),_0x3d3971=_0x2c09c7[_0x27312c(0xd23)](_0x27312c(0x101b),{'weekday':_0x27312c(0xd72),'month':_0x27312c(0xd72),'day':_0x27312c(0xa74)});document[_0x27312c(0x9c8)](_0x27312c(0x9d1))[_0x27312c(0xe24)]=_0x48b159;}function _0x169d92(_0x418ce1){const _0x72a72e=_0x419fa8,_0x327617=_0x418ce1[_0x72a72e(0x3f1)]();if(_0x327617[_0x72a72e(0xc8d)]('[')&&_0x327617[_0x72a72e(0x6b1)](']'))try{const _0x3b6e70=JSON['parse'](_0x327617);if(Array[_0x72a72e(0xb27)](_0x3b6e70))return console['log'](_0x72a72e(0x5ee)),_0x3b6e70;}catch(_0x32d255){console[_0x72a72e(0x453)](_0x72a72e(0xb68));}const _0x55263e=_0x327617['match'](/{[^{}]*}/g);if(_0x55263e){const _0x4b6971=[];for(const _0xedb9dc of _0x55263e){try{const _0x123717=JSON[_0x72a72e(0x907)](_0xedb9dc);_0x4b6971[_0x72a72e(0x668)](_0x123717);}catch(_0x1be82d){console['warn']('跳过一个无效的JSON片段:',_0xedb9dc);}}if(_0x4b6971[_0x72a72e(0xa06)]>0x0)return console[_0x72a72e(0x283)]('解析成功：通过强力提取模式。'),_0x4b6971;}return console[_0x72a72e(0x1221)](_0x72a72e(0xe8f)),[{'type':_0x72a72e(0xbb7),'content':_0x418ce1}];}function _0x526327(_0x4c33bf=new Date()){const _0xfa2b88=_0x419fa8,_0x3279c8=_0x4c33bf[_0xfa2b88(0x7a2)]();if(_0x3279c8>=0x0&&_0x3279c8<0x5)return'凌晨';else{if(_0x3279c8>=0x5&&_0x3279c8<0x9)return'早上';else{if(_0x3279c8>=0x9&&_0x3279c8<0xd)return'上午';else{if(_0x3279c8>=0xd&&_0x3279c8<0x12)return'下午';else{if(_0x3279c8>=0x12&&_0x3279c8<0x18)return'晚上';}}}}return'现在';}async function _0x7b7500(){const _0xa4b2bd=_0x419fa8,_0xd970d5=document[_0xa4b2bd(0x9c8)]('api-preset-select');_0xd970d5[_0xa4b2bd(0x2f5)]=_0xa4b2bd(0x6a7);const _0x51fc41=await _0x2c5bcf[_0xa4b2bd(0xa2e)]['toArray']();_0x51fc41[_0xa4b2bd(0x591)](_0x29a715=>{const _0x1ff117=_0xa4b2bd,_0x5d5eb9=document[_0x1ff117(0x28a)](_0x1ff117(0x12ef));_0x5d5eb9['value']=_0x29a715['id'],_0x5d5eb9[_0x1ff117(0xe24)]=_0x29a715[_0x1ff117(0x609)],_0xd970d5['appendChild'](_0x5d5eb9);});const _0x569537=_0x9ebf46[_0xa4b2bd(0x4de)];let _0x295c8d=null;for(const _0x1ec7fc of _0x51fc41){if(_0x1ec7fc[_0xa4b2bd(0x6a5)]===_0x569537[_0xa4b2bd(0x6a5)]&&_0x1ec7fc[_0xa4b2bd(0xfbf)]===_0x569537[_0xa4b2bd(0xfbf)]&&_0x1ec7fc[_0xa4b2bd(0x546)]===_0x569537['model']&&_0x1ec7fc[_0xa4b2bd(0x797)]===_0x569537['secondaryProxyUrl']&&_0x1ec7fc['secondaryApiKey']===_0x569537[_0xa4b2bd(0xc0c)]&&_0x1ec7fc[_0xa4b2bd(0x62f)]===_0x569537[_0xa4b2bd(0x62f)]&&(_0x1ec7fc['minimaxGroupId']||'')===(_0x569537['minimaxGroupId']||'')&&(_0x1ec7fc[_0xa4b2bd(0x4bd)]||'')===(_0x569537['minimaxApiKey']||'')&&(_0x1ec7fc[_0xa4b2bd(0x10f0)]||_0xa4b2bd(0x5f9))===(_0x569537[_0xa4b2bd(0x10f0)]||_0xa4b2bd(0x5f9))){_0x295c8d=_0x1ec7fc['id'];break;}}_0x295c8d?_0xd970d5[_0xa4b2bd(0x1155)]=_0x295c8d:_0xd970d5[_0xa4b2bd(0x1155)]=_0xa4b2bd(0x407);}async function _0x3cf58f(){const _0x5b7c49=_0x419fa8,_0x40f43d=document[_0x5b7c49(0x9c8)](_0x5b7c49(0x1281)),_0x4eacab=parseInt(_0x40f43d['value']);if(isNaN(_0x4eacab))return;const _0xc158ef=await _0x2c5bcf[_0x5b7c49(0xa2e)][_0x5b7c49(0xdf9)](_0x4eacab);_0xc158ef&&(_0x9ebf46[_0x5b7c49(0x4de)]={'id':'main','proxyUrl':_0xc158ef[_0x5b7c49(0x6a5)],'apiKey':_0xc158ef['apiKey'],'model':_0xc158ef['model'],'secondaryProxyUrl':_0xc158ef[_0x5b7c49(0x797)],'secondaryApiKey':_0xc158ef['secondaryApiKey'],'secondaryModel':_0xc158ef['secondaryModel'],'minimaxGroupId':_0xc158ef[_0x5b7c49(0x49e)],'minimaxApiKey':_0xc158ef['minimaxApiKey'],'minimaxModel':_0xc158ef[_0x5b7c49(0x10f0)]},await _0x2c5bcf[_0x5b7c49(0x4de)][_0x5b7c49(0xff5)](_0x9ebf46[_0x5b7c49(0x4de)]),_0x64a68a(),document[_0x5b7c49(0x9c8)]('fetch-models-btn')[_0x5b7c49(0xf5c)](),_0xc158ef[_0x5b7c49(0x797)]&&_0xc158ef['secondaryApiKey']&&document[_0x5b7c49(0x9c8)](_0x5b7c49(0xa01))['click'](),alert(_0x5b7c49(0x13c9)+_0xc158ef[_0x5b7c49(0x609)]+'”'));}async function _0x51f885(){const _0x25fe81=_0x419fa8,_0x104c4a=await _0xadb5df(_0x25fe81(0x8d1),'请输入预设名称');if(!_0x104c4a||!_0x104c4a[_0x25fe81(0x3f1)]())return;const _0x142c52={'name':_0x104c4a[_0x25fe81(0x3f1)](),'proxyUrl':document['getElementById'](_0x25fe81(0x9a9))[_0x25fe81(0x1155)]['trim'](),'apiKey':document[_0x25fe81(0x9c8)](_0x25fe81(0x773))[_0x25fe81(0x1155)]['trim'](),'model':document[_0x25fe81(0x9c8)](_0x25fe81(0x661))[_0x25fe81(0x1155)],'secondaryProxyUrl':document['getElementById']('secondary-proxy-url')['value']['trim'](),'secondaryApiKey':document['getElementById']('secondary-api-key')[_0x25fe81(0x1155)][_0x25fe81(0x3f1)](),'secondaryModel':document[_0x25fe81(0x9c8)](_0x25fe81(0xeda))[_0x25fe81(0x1155)],'minimaxGroupId':document[_0x25fe81(0x9c8)](_0x25fe81(0x910))[_0x25fe81(0x1155)][_0x25fe81(0x3f1)](),'minimaxApiKey':document[_0x25fe81(0x9c8)]('minimax-api-key')['value'][_0x25fe81(0x3f1)](),'minimaxModel':document[_0x25fe81(0x9c8)]('minimax-model-select')['value']},_0x50d841=await _0x2c5bcf[_0x25fe81(0xa2e)][_0x25fe81(0xe78)](_0x25fe81(0x609))[_0x25fe81(0xda9)](_0x142c52[_0x25fe81(0x609)])[_0x25fe81(0x476)]();if(_0x50d841){const _0x44968f=await _0x352ae9('覆盖预设',_0x25fe81(0xecc)+_0x142c52[_0x25fe81(0x609)]+_0x25fe81(0x118b),{'confirmButtonClass':'btn-danger'});if(!_0x44968f)return;_0x142c52['id']=_0x50d841['id'];}await _0x2c5bcf[_0x25fe81(0xa2e)][_0x25fe81(0xff5)](_0x142c52),await _0x7b7500(),alert(_0x25fe81(0xf11));}async function _0x4d4ba0(){const _0x149b7f=_0x419fa8,_0x2684bd=document['getElementById'](_0x149b7f(0x1281)),_0x400232=parseInt(_0x2684bd[_0x149b7f(0x1155)]);if(isNaN(_0x400232)){alert(_0x149b7f(0x11fd));return;}const _0x143642=await _0x2c5bcf[_0x149b7f(0xa2e)][_0x149b7f(0xdf9)](_0x400232);if(!_0x143642)return;const _0x28f7a6=await _0x352ae9(_0x149b7f(0x2a9),'确定要删除预设\x20“'+_0x143642[_0x149b7f(0x609)]+_0x149b7f(0x924),{'confirmButtonClass':_0x149b7f(0x12bc)});_0x28f7a6&&(await _0x2c5bcf['apiPresets']['delete'](_0x400232),await _0x7b7500(),alert('预设已删除。'));}function _0x64a68a(){const _0x488bfd=_0x419fa8;document[_0x488bfd(0x9c8)](_0x488bfd(0x9a9))[_0x488bfd(0x1155)]=_0x9ebf46[_0x488bfd(0x4de)][_0x488bfd(0x6a5)]||'',document[_0x488bfd(0x9c8)](_0x488bfd(0x773))[_0x488bfd(0x1155)]=_0x9ebf46[_0x488bfd(0x4de)][_0x488bfd(0xfbf)]||'',document[_0x488bfd(0x9c8)](_0x488bfd(0xe95))[_0x488bfd(0x1155)]=_0x9ebf46['apiConfig']['secondaryProxyUrl']||'',document[_0x488bfd(0x9c8)](_0x488bfd(0xb99))[_0x488bfd(0x1155)]=_0x9ebf46[_0x488bfd(0x4de)][_0x488bfd(0xc0c)]||'',document['getElementById']('background-activity-switch')[_0x488bfd(0x1ec)]=_0x9ebf46[_0x488bfd(0x1383)][_0x488bfd(0x22a)]||![],document[_0x488bfd(0x9c8)](_0x488bfd(0xefd))[_0x488bfd(0x1155)]=_0x9ebf46[_0x488bfd(0x1383)][_0x488bfd(0x99a)]||0x3c,document[_0x488bfd(0x9c8)](_0x488bfd(0x1381))[_0x488bfd(0x1155)]=_0x9ebf46[_0x488bfd(0x1383)]['blockCooldownHours']||0x1,document['getElementById'](_0x488bfd(0x3c9))['checked']=_0x9ebf46[_0x488bfd(0x1383)]['enableAiDrawing'],document[_0x488bfd(0x9c8)](_0x488bfd(0x74d))['value']=_0x9ebf46[_0x488bfd(0x1383)][_0x488bfd(0x4f5)]||0x32,document[_0x488bfd(0x9c8)](_0x488bfd(0x35b))['value']=_0x9ebf46[_0x488bfd(0x1383)][_0x488bfd(0x905)]||0x1e;const _0x20d5ae=document['getElementById']('api-temperature-slider'),_0xdd82bf=document[_0x488bfd(0x9c8)](_0x488bfd(0x1326)),_0x113d83=_0x9ebf46[_0x488bfd(0x1383)][_0x488bfd(0xc3d)]||0.8;_0x20d5ae[_0x488bfd(0x1155)]=_0x113d83,_0xdd82bf[_0x488bfd(0xe24)]=_0x113d83,document[_0x488bfd(0x9c8)](_0x488bfd(0x910))[_0x488bfd(0x1155)]=_0x9ebf46[_0x488bfd(0x4de)][_0x488bfd(0x49e)]||'',document[_0x488bfd(0x9c8)](_0x488bfd(0x13ba))['value']=_0x9ebf46[_0x488bfd(0x4de)][_0x488bfd(0x4bd)]||'',document['getElementById'](_0x488bfd(0xf20))[_0x488bfd(0x1155)]=_0x9ebf46[_0x488bfd(0x4de)][_0x488bfd(0x10f0)]||_0x488bfd(0x5f9);const _0x42335a=localStorage[_0x488bfd(0x1290)](_0x488bfd(0xe51))===_0x488bfd(0x667),_0x5b48c7=localStorage[_0x488bfd(0x1290)](_0x488bfd(0x8e5))||'nai-diffusion-4-5-full',_0x80b8fe=localStorage[_0x488bfd(0x1290)]('novelai-api-key')||'';document[_0x488bfd(0x9c8)](_0x488bfd(0x1f9))[_0x488bfd(0x1ec)]=_0x42335a,document['getElementById'](_0x488bfd(0x8e5))[_0x488bfd(0x1155)]=_0x5b48c7,document['getElementById'](_0x488bfd(0xef8))[_0x488bfd(0x1155)]=_0x80b8fe,document[_0x488bfd(0x9c8)]('novelai-details')[_0x488bfd(0x5e1)][_0x488bfd(0x3c5)]=_0x42335a?_0x488bfd(0x3d9):'none',_0x7b7500(),_0x1671a7();}window['renderApiSettingsProxy']=_0x64a68a;async function _0x102f19(){const _0x41d51e=_0x419fa8,_0x24ae3e=document['getElementById'](_0x41d51e(0x63b));_0x24ae3e['innerHTML']='';const _0x24a35d=await _0x2c5bcf[_0x41d51e(0x1094)][_0x41d51e(0x5ff)]();if(_0x24a35d[_0x41d51e(0xa06)]===0x0){_0x24ae3e['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>';return;}_0x24a35d[_0x41d51e(0x591)](_0x5538eb=>{const _0x4f04d=_0x41d51e,_0x2176f2=document[_0x4f04d(0x28a)]('div');_0x2176f2[_0x4f04d(0x82c)]=_0x4f04d(0x52e),_0x2176f2['dataset']['npcId']=_0x5538eb['id'],_0x2176f2['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x5538eb[_0x4f04d(0x10c9)]||_0x337c8f)+_0x4f04d(0x2db)+_0x5538eb[_0x4f04d(0x609)]+_0x4f04d(0xe57)+_0x5538eb[_0x4f04d(0xeb1)][_0x4f04d(0xc34)](0x0,0x1e)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x2176f2['addEventListener'](_0x4f04d(0xf5c),()=>_0x2e413a(_0x5538eb['id'])),_0x43a60a(_0x2176f2,async()=>{await _0x398ba7(_0x5538eb['id']);}),_0x24ae3e['appendChild'](_0x2176f2);});}async function _0x2e413a(_0x55bd75=null){const _0x4f59ac=_0x419fa8;editingNpcId=_0x55bd75;const _0x1b9dee=document[_0x4f59ac(0x9c8)]('npc-editor-modal'),_0x1bd031=document[_0x4f59ac(0x9c8)]('npc-editor-title'),_0x12ed14=document[_0x4f59ac(0x9c8)](_0x4f59ac(0x104f)),_0x4bf329=document[_0x4f59ac(0x9c8)](_0x4f59ac(0xf8e)),_0x4d85e2=document['getElementById']('npc-avatar-preview'),_0x34d0e8=document[_0x4f59ac(0x9c8)](_0x4f59ac(0x122d)),_0x5531b4=document[_0x4f59ac(0x9c8)](_0x4f59ac(0x663)),_0xac87d8=document[_0x4f59ac(0x9c8)](_0x4f59ac(0xf02));_0x34d0e8[_0x4f59ac(0x2f5)]='',_0x34d0e8[_0x4f59ac(0x2f5)]+=_0x4f59ac(0xbad)+(_0x9ebf46[_0x4f59ac(0x32c)][_0x4f59ac(0x5b7)]||'我')+_0x4f59ac(0x5ca),Object[_0x4f59ac(0xeb2)](_0x9ebf46[_0x4f59ac(0x547)])[_0x4f59ac(0x401)](_0x27050b=>!_0x27050b[_0x4f59ac(0x11e4)])[_0x4f59ac(0x591)](_0x18f611=>{const _0x4d4811=_0x4f59ac;_0x34d0e8['innerHTML']+=_0x4d4811(0x542)+_0x18f611['id']+'\x22>\x20'+_0x18f611[_0x4d4811(0x609)]+'\x20(角色)</label>';});if(_0x55bd75){_0x1bd031[_0x4f59ac(0xe24)]='编辑\x20NPC';const _0x178299=await _0x2c5bcf[_0x4f59ac(0x1094)][_0x4f59ac(0xdf9)](_0x55bd75);_0x178299&&(_0x12ed14[_0x4f59ac(0x1155)]=_0x178299[_0x4f59ac(0x609)],_0x4bf329[_0x4f59ac(0x1155)]=_0x178299[_0x4f59ac(0xeb1)],_0x4d85e2['src']=_0x178299[_0x4f59ac(0x10c9)]||_0x337c8f,_0x5531b4['checked']=_0x178299['enableBackgroundActivity']!==![],_0xac87d8[_0x4f59ac(0x1155)]=_0x178299[_0x4f59ac(0x664)]||0xf,_0x178299[_0x4f59ac(0x754)]&&Array[_0x4f59ac(0xb27)](_0x178299['associatedWith'])&&_0x178299[_0x4f59ac(0x754)][_0x4f59ac(0x591)](_0x1a8a18=>{const _0x2e3a80=_0x4f59ac,_0x497a2d=_0x34d0e8[_0x2e3a80(0x91d)](_0x2e3a80(0xc2b)+_0x1a8a18+'\x22]');if(_0x497a2d)_0x497a2d['checked']=!![];}));}else{_0x1bd031[_0x4f59ac(0xe24)]=_0x4f59ac(0x3bb),_0x12ed14['value']='',_0x4bf329['value']='',_0x4d85e2[_0x4f59ac(0xbf4)]=_0x337c8f,_0x5531b4[_0x4f59ac(0x1ec)]=!![],_0xac87d8['value']=0xf;const _0x36b87f=_0x34d0e8[_0x4f59ac(0x91d)](_0x4f59ac(0x67d));if(_0x36b87f)_0x36b87f[_0x4f59ac(0x1ec)]=!![];}_0x1b9dee['classList'][_0x4f59ac(0x68e)]('visible');}async function _0x452c7a(){const _0x25c787=_0x419fa8,_0x2852cb=document[_0x25c787(0x9c8)]('npc-name-input')[_0x25c787(0x1155)][_0x25c787(0x3f1)](),_0x3c3ff0=document[_0x25c787(0x9c8)](_0x25c787(0xf8e))[_0x25c787(0x1155)][_0x25c787(0x3f1)]();if(!_0x2852cb||!_0x3c3ff0){alert(_0x25c787(0xa7d));return;}const _0xbfcb9d=Array[_0x25c787(0x13a5)](document[_0x25c787(0x7e4)](_0x25c787(0x95f)))[_0x25c787(0xa3b)](_0x1aed49=>_0x1aed49['value']),_0x5245be=document[_0x25c787(0x9c8)](_0x25c787(0x663))[_0x25c787(0x1ec)],_0x2a1d93=parseInt(document['getElementById'](_0x25c787(0xf02))[_0x25c787(0x1155)])||0xf,_0x171b4e={'name':_0x2852cb,'persona':_0x3c3ff0,'avatar':document[_0x25c787(0x9c8)]('npc-avatar-preview')[_0x25c787(0xbf4)],'associatedWith':_0xbfcb9d,'enableBackgroundActivity':_0x5245be,'actionCooldownMinutes':_0x2a1d93};if(editingNpcId)await _0x2c5bcf[_0x25c787(0x1094)][_0x25c787(0x13a4)](editingNpcId,_0x171b4e);else{const _0x35358c=await _0x2c5bcf[_0x25c787(0x1094)][_0x25c787(0x68e)](_0x171b4e);if(_0x2cf21d&&_0x9ebf46[_0x25c787(0x970)]){const _0x5d21a1=_0x9ebf46[_0x25c787(0x547)][_0x9ebf46[_0x25c787(0x970)]];_0x5d21a1['isGroup']&&(_0x5d21a1[_0x25c787(0xd3e)]['push']({'id':'npc_'+_0x35358c,'originalName':_0x2852cb,'groupNickname':_0x2852cb,'persona':_0x3c3ff0,'avatar':_0x171b4e['avatar'],'isNpc':!![]}),await _0x2c5bcf['chats'][_0x25c787(0xff5)](_0x5d21a1));}}document[_0x25c787(0x9c8)](_0x25c787(0xf2e))[_0x25c787(0x575)]['remove'](_0x25c787(0xc3f)),_0x2cf21d?(_0x2cf21d=![],_0x36c264()):await _0x102f19();}async function _0x398ba7(_0x36a65b){const _0x169be3=_0x419fa8,_0x2a4a86=await _0x2c5bcf[_0x169be3(0x1094)][_0x169be3(0xdf9)](_0x36a65b);if(!_0x2a4a86)return;const _0x92e308=await _0x352ae9(_0x169be3(0xe48),_0x169be3(0xfc1)+_0x2a4a86[_0x169be3(0x609)]+_0x169be3(0x924),{'confirmButtonClass':_0x169be3(0x12bc)});_0x92e308&&(await _0x2c5bcf['npcs']['delete'](_0x36a65b),await _0x102f19());}let _0x564124=0x0;function _0x3c575f(_0xa642eb){const _0x5a3751=_0x419fa8,_0x1d9550=document[_0x5a3751(0x28a)](_0x5a3751(0x11f4));return _0x1d9550[_0x5a3751(0x82c)]=_0x5a3751(0x514),_0x1d9550[_0x5a3751(0x2f5)]=_0x5a3751(0x36d)+_0xa642eb[_0x5a3751(0x609)]+_0x5a3751(0x317),_0x1d9550;}function _0x5ddf04(_0x5e6759){const _0x484902=_0x419fa8,_0x350028=document[_0x484902(0x9c8)](_0x484902(0x908)),_0x312db6=document[_0x484902(0x9c8)](_0x484902(0xc71));if(_0x312db6)_0x312db6[_0x484902(0x30f)]();const _0x5670d8=_0x564124,_0x1cbed3=_0x564124+CHAT_LIST_RENDER_WINDOW,_0x1cfc3e=_0x5e6759[_0x484902(0x1044)](_0x5670d8,_0x1cbed3),_0x13ccd2=document[_0x484902(0x5a2)]();let _0x1e9a92=_0x350028[_0x484902(0x91d)](_0x484902(0x136e));_0x1cfc3e[_0x484902(0x591)](_0xc8021b=>{const _0x10ab96=_0x484902;if(_0xc8021b[_0x10ab96(0x12d9)]===_0x10ab96(0xe9a)){const _0x609a44=_0x3c575f(_0xc8021b[_0x10ab96(0x1016)]);_0x13ccd2[_0x10ab96(0x7b9)](_0x609a44),_0x1e9a92=_0x609a44[_0x10ab96(0x91d)]('.chat-group-content');}else{if(_0xc8021b[_0x10ab96(0x12d9)]===_0x10ab96(0x528)){const _0x2cce31=_0x15f1c0(_0xc8021b[_0x10ab96(0x8b0)]);_0x1e9a92&&_0xc8021b[_0x10ab96(0x8b0)][_0x10ab96(0x7b1)]?_0x1e9a92[_0x10ab96(0x7b9)](_0x2cce31):(_0x13ccd2[_0x10ab96(0x7b9)](_0x2cce31),_0x1e9a92=null);}}}),_0x350028[_0x484902(0x7b9)](_0x13ccd2),_0x564124+=_0x1cfc3e[_0x484902(0xa06)],_0x5e6759[_0x484902(0xa06)]>_0x564124&&_0x2e3b8e(_0x350028,_0x5e6759),document[_0x484902(0x7e4)](_0x484902(0xae8))[_0x484902(0x591)](_0x4ffb8d=>{const _0x3c29d3=_0x484902,_0x1b64ae=_0x4ffb8d[_0x3c29d3(0x75c)](!![]);_0x4ffb8d[_0x3c29d3(0x127d)][_0x3c29d3(0x4d7)](_0x1b64ae,_0x4ffb8d),_0x1b64ae['addEventListener'](_0x3c29d3(0xf5c),()=>{const _0x238b45=_0x3c29d3;_0x1b64ae[_0x238b45(0x575)][_0x238b45(0x1c3)](_0x238b45(0x1003)),_0x1b64ae['nextElementSibling']['classList'][_0x238b45(0x1c3)](_0x238b45(0x1003));});});}async function _0x394b2c(){const _0x194838=_0x419fa8,_0x28965e=document['getElementById']('chat-list');_0x28965e['innerHTML']='';const _0x1793b2=Object[_0x194838(0xeb2)](_0x9ebf46['chats'])[_0x194838(0x66b)]((_0x18489d,_0x84e7f0)=>{const _0x2e4137=_0x194838,_0x2f806a=(_0x84e7f0[_0x2e4137(0xfac)]||![])-(_0x18489d[_0x2e4137(0xfac)]||![]);if(_0x2f806a!==0x0)return _0x2f806a;return(_0x84e7f0[_0x2e4137(0x8b3)][_0x2e4137(0x1044)](-0x1)[0x0]?.[_0x2e4137(0x6b5)]||0x0)-(_0x18489d[_0x2e4137(0x8b3)]['slice'](-0x1)[0x0]?.[_0x2e4137(0x6b5)]||0x0);}),_0x4bd6d6=await _0x2c5bcf['qzoneGroups'][_0x194838(0x5ff)]();if(_0x1793b2[_0x194838(0xa06)]===0x0){_0x28965e[_0x194838(0x2f5)]=_0x194838(0xfc9);return;}_0x4bd6d6['forEach'](_0x7297b3=>{const _0x358d6f=_0x194838,_0x10bb5c=_0x1793b2[_0x358d6f(0xfc3)](_0x969c9f=>_0x969c9f['groupId']===_0x7297b3['id']);_0x7297b3[_0x358d6f(0xe98)]=_0x10bb5c?_0x10bb5c[_0x358d6f(0x8b3)][_0x358d6f(0x1044)](-0x1)[0x0]?.[_0x358d6f(0x6b5)]||0x0:0x0;}),_0x4bd6d6['sort']((_0x38e728,_0xbe20f3)=>_0xbe20f3[_0x194838(0xe98)]-_0x38e728[_0x194838(0xe98)]),_0x6e5b5a=[];const _0x2fcdc6=new Set();_0x1793b2[_0x194838(0x591)](_0x1254ee=>{const _0x215af4=_0x194838;_0x1254ee[_0x215af4(0xfac)]&&(_0x6e5b5a[_0x215af4(0x668)]({'type':_0x215af4(0x528),'chat':_0x1254ee}),_0x2fcdc6[_0x215af4(0x68e)](_0x1254ee['id']));}),_0x4bd6d6['forEach'](_0x3a1007=>{const _0x3013ea=_0x194838,_0x5cd6ef=_0x1793b2[_0x3013ea(0x401)](_0x46c916=>!_0x46c916[_0x3013ea(0xfac)]&&!_0x46c916[_0x3013ea(0x11e4)]&&_0x46c916[_0x3013ea(0x7b1)]===_0x3a1007['id']);_0x5cd6ef['length']>0x0&&(_0x6e5b5a[_0x3013ea(0x668)]({'type':'groupHeader','group':_0x3a1007}),_0x5cd6ef[_0x3013ea(0x591)](_0x456559=>{const _0x4bf3b2=_0x3013ea;_0x6e5b5a[_0x4bf3b2(0x668)]({'type':'chatItem','chat':_0x456559}),_0x2fcdc6[_0x4bf3b2(0x68e)](_0x456559['id']);}));}),_0x1793b2[_0x194838(0x591)](_0x47b5f4=>{const _0x121fbf=_0x194838;!_0x2fcdc6[_0x121fbf(0xd97)](_0x47b5f4['id'])&&(_0x6e5b5a[_0x121fbf(0x668)]({'type':_0x121fbf(0x528),'chat':_0x47b5f4}),_0x2fcdc6['add'](_0x47b5f4['id']));}),_0x564124=0x0,_0x5ddf04();}function _0x3c575f(_0x21dfc7){const _0x4799a5=_0x419fa8,_0x168d21=document[_0x4799a5(0x28a)](_0x4799a5(0x11f4));return _0x168d21[_0x4799a5(0x82c)]=_0x4799a5(0x514),_0x168d21[_0x4799a5(0x2f5)]=_0x4799a5(0x13b2)+_0x21dfc7[_0x4799a5(0x609)]+_0x4799a5(0x477),_0x168d21;}function _0x2e3b8e(_0x594056,_0x2b5509){const _0x4d10de=_0x419fa8,_0x2a0249=document[_0x4d10de(0x28a)](_0x4d10de(0x82f));_0x2a0249['id']=_0x4d10de(0xc71),_0x2a0249[_0x4d10de(0xe24)]=_0x4d10de(0x12b9),_0x2a0249['className']=_0x4d10de(0x121c),_0x2a0249[_0x4d10de(0xa0f)](_0x4d10de(0xf5c),()=>_0x5ddf04(_0x2b5509),{'once':!![]}),_0x594056['prepend'](_0x2a0249);}function _0x5ddf04(){const _0x5d97ef=_0x419fa8;if(_0x5daaec)return;const _0x3878d9=document[_0x5d97ef(0x9c8)](_0x5d97ef(0x908)),_0x212997=document[_0x5d97ef(0x9c8)]('messages-view');if(!_0x3878d9||!_0x212997)return;if(_0x564124>=_0x6e5b5a[_0x5d97ef(0xa06)])return;_0x5daaec=!![];const _0x3b5d0a=_0x564124===0x0,_0x921479=()=>{const _0x28584e=_0x5d97ef;_0xfb2eb9(_0x3878d9);const _0x3a05c=_0x9ebf46[_0x28584e(0x1383)][_0x28584e(0x905)]||0x1e,_0x25cf10=_0x564124,_0x4cab2e=_0x564124+_0x3a05c,_0xd24792=_0x6e5b5a[_0x28584e(0x1044)](_0x25cf10,_0x4cab2e),_0x59e8ef=document[_0x28584e(0x5a2)]();let _0x34bb5c=_0x3878d9[_0x28584e(0x91d)](_0x28584e(0x136e));_0xd24792[_0x28584e(0x591)](_0x3459d7=>{const _0x168053=_0x28584e;if(_0x3459d7[_0x168053(0x12d9)]===_0x168053(0xe9a)){const _0x290efa=_0x3c575f(_0x3459d7['group']);_0x59e8ef[_0x168053(0x7b9)](_0x290efa),_0x34bb5c=_0x290efa[_0x168053(0x91d)](_0x168053(0xf73));}else{if(_0x3459d7[_0x168053(0x12d9)]===_0x168053(0x528)){const _0x389dca=_0x15f1c0(_0x3459d7[_0x168053(0x8b0)]);if(_0x3459d7[_0x168053(0x8b0)][_0x168053(0x7b1)]&&_0x34bb5c)_0x34bb5c['appendChild'](_0x389dca);else{_0x59e8ef[_0x168053(0x7b9)](_0x389dca);if(!_0x3459d7[_0x168053(0x8b0)]['groupId'])_0x34bb5c=null;}}}}),_0x3878d9[_0x28584e(0x7b9)](_0x59e8ef),_0x564124+=_0xd24792[_0x28584e(0xa06)],_0x3878d9['querySelectorAll'](_0x28584e(0xf72))[_0x28584e(0x591)](_0x362cbc=>{const _0x412b58=_0x28584e;_0x362cbc['dataset'][_0x412b58(0xb7e)]=_0x412b58(0x667),_0x362cbc[_0x412b58(0xa0f)](_0x412b58(0xf5c),()=>{const _0x5a714f=_0x412b58;_0x362cbc['classList'][_0x5a714f(0x1c3)]('collapsed'),_0x362cbc[_0x5a714f(0x5c7)][_0x5a714f(0x575)]['toggle'](_0x5a714f(0x1003));});}),_0x5daaec=![],_0x212997[_0x28584e(0x1e4)]<=_0x212997[_0x28584e(0xfce)]&&_0x564124<_0x6e5b5a['length']&&_0x5ddf04();};_0x3b5d0a?_0x921479():(_0xde08bb(_0x3878d9,_0x5d97ef(0x40f)),setTimeout(_0x921479,0x1f4));}function _0x15f1c0(_0x5c2554){const _0x430cda=_0x419fa8;try{const _0x48e02a=_0x5c2554[_0x430cda(0x8b3)][_0x430cda(0x401)](_0x2dd071=>!_0x2dd071[_0x430cda(0xc62)])['slice'](-0x1)[0x0]||{};let _0x57bdd3;if(!_0x5c2554['isGroup']&&_0x5c2554['relationship']?.['status']==='pending_user_approval')_0x57bdd3=_0x430cda(0x1063)+(_0x5c2554[_0x430cda(0x36f)][_0x430cda(0x1271)]||_0x430cda(0xf31))+_0x430cda(0x12c8);else{if(!_0x5c2554['isGroup']&&_0x5c2554[_0x430cda(0x36f)]?.['status']===_0x430cda(0x23d))_0x57bdd3=_0x430cda(0x766);else{if(_0x5c2554[_0x430cda(0x11e4)]){if(_0x48e02a[_0x430cda(0x12d9)]==='pat_message')_0x57bdd3=_0x430cda(0x1299)+_0x48e02a[_0x430cda(0x53b)];else{if(_0x48e02a[_0x430cda(0x12d9)]==='transfer')_0x57bdd3=_0x430cda(0xd69);else{if(_0x48e02a[_0x430cda(0x12d9)]===_0x430cda(0x835)||_0x48e02a[_0x430cda(0x12d9)]==='user_photo')_0x57bdd3='[照片]';else{if(_0x48e02a[_0x430cda(0x12d9)]===_0x430cda(0x10c1))_0x57bdd3='[语音]';else{if(typeof _0x48e02a[_0x430cda(0x53b)]===_0x430cda(0xe56)&&_0x2d389f['test'](_0x48e02a[_0x430cda(0x53b)]))_0x57bdd3=_0x48e02a['meaning']?_0x430cda(0xef0)+_0x48e02a[_0x430cda(0x1b3)]+']':'[表情]';else Array[_0x430cda(0xb27)](_0x48e02a[_0x430cda(0x53b)])?_0x57bdd3=_0x430cda(0x4a9):_0x57bdd3=String(_0x48e02a[_0x430cda(0x53b)]||_0x430cda(0xf66))[_0x430cda(0xc34)](0x0,0x14);}}}}if(_0x48e02a['senderName']&&_0x48e02a[_0x430cda(0x12d9)]!==_0x430cda(0x13a8)){const _0x5ccd1d=_0x227896(_0x5c2554,_0x48e02a['senderName']);_0x57bdd3=_0x5ccd1d+':\x20'+_0x57bdd3;}}else{const _0x5a1221=_0x5c2554[_0x430cda(0xebd)]?.[_0x430cda(0xbb7)]||'在线';_0x57bdd3='['+_0x5a1221+']';}}}const _0x1ad509=document[_0x430cda(0x28a)](_0x430cda(0x11f4));_0x1ad509['className']=_0x430cda(0x52e),_0x1ad509[_0x430cda(0xc9f)][_0x430cda(0x54d)]=_0x5c2554['id'];_0x5c2554[_0x430cda(0xfac)]&&_0x1ad509[_0x430cda(0x575)]['add'](_0x430cda(0xffb));const _0x137cd4=_0x5c2554[_0x430cda(0x11e4)]?_0x5c2554[_0x430cda(0x1131)][_0x430cda(0xa79)]:_0x5c2554[_0x430cda(0x1131)][_0x430cda(0xd4d)],_0x5e7936=_0x5c2554[_0x430cda(0x11e4)]?'':_0x5c2554[_0x430cda(0x1131)][_0x430cda(0xdda)]||'';let _0x3c5918;_0x5e7936?_0x3c5918=_0x430cda(0x1212)+(_0x137cd4||_0x246753)+_0x430cda(0x1054)+_0x5e7936+_0x430cda(0x934):_0x3c5918=_0x430cda(0x12ac)+(_0x137cd4||_0x246753)+_0x430cda(0x1ff);const _0x2de655=_0x5e7936?_0x430cda(0x1355):'',_0x4da8d5='<div\x20class=\x22avatar-group\x20'+_0x2de655+'\x22>'+_0x3c5918+_0x430cda(0x103c);_0x1ad509[_0x430cda(0x2f5)]=_0x430cda(0x11e0)+_0x4da8d5+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x5c2554[_0x430cda(0x609)]+_0x430cda(0xc41)+(_0x5c2554['isGroup']?'<span\x20class=\x22group-tag\x22>群聊</span>':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20'+(_0x5c2554[_0x430cda(0x11e4)]?_0x430cda(0xff6):'#b5b5b5')+_0x430cda(0x1240)+_0x57bdd3+_0x430cda(0x4bb);const _0xd80840=_0x5c2554[_0x430cda(0x382)]||0x0,_0x3163da=_0x1ad509[_0x430cda(0x91d)]('.unread-count');_0xd80840>0x0?(_0x3163da[_0x430cda(0xe24)]=_0xd80840>0x63?_0x430cda(0x4eb):_0xd80840,_0x3163da['style'][_0x430cda(0x3c5)]=_0x430cda(0x3cc)):_0x3163da[_0x430cda(0x5e1)][_0x430cda(0x3c5)]=_0x430cda(0x8f6);const _0x4426de=_0x1ad509[_0x430cda(0x91d)](_0x430cda(0xa21));_0x4426de&&(_0x4426de[_0x430cda(0x5e1)]['cursor']='pointer',_0x4426de[_0x430cda(0xa0f)](_0x430cda(0x1002),_0x25c492=>{const _0x27d4a6=_0x430cda;_0x25c492[_0x27d4a6(0x20a)]();const _0x3e24ee=_0x5c2554['isGroup']?_0x5c2554['name']:_0x5c2554['originalName'];_0x969182(_0x5c2554['id'],_0x3e24ee);}));const _0xea18e6=_0x1ad509[_0x430cda(0x91d)](_0x430cda(0xa76));return _0xea18e6&&_0xea18e6['addEventListener'](_0x430cda(0xf5c),()=>_0x49f56e(_0x5c2554['id'])),_0x43a60a(_0x1ad509,async _0x4ddc1b=>{const _0x2969ed=_0x430cda,_0x43694c=await _0x1971f8(_0x5c2554);switch(_0x43694c){case _0x2969ed(0xd91):_0x5c2554[_0x2969ed(0xfac)]=!_0x5c2554[_0x2969ed(0xfac)],await _0x2c5bcf['chats'][_0x2969ed(0xff5)](_0x5c2554),_0x394b2c();break;case _0x2969ed(0x6d2):const _0x450ba0=await _0x352ae9(_0x2969ed(0xfe4),_0x2969ed(0x460)+_0x5c2554[_0x2969ed(0x609)]+_0x2969ed(0x972),{'confirmButtonClass':'btn-danger'});if(_0x450ba0){_0x5062a9['isActive']&&_0x5062a9[_0x2969ed(0x970)]===_0x5c2554['id']&&await _0xce20b(![]);delete _0x9ebf46['chats'][_0x5c2554['id']];if(_0x9ebf46[_0x2969ed(0x970)]===_0x5c2554['id'])_0x9ebf46[_0x2969ed(0x970)]=null;await _0x2c5bcf[_0x2969ed(0x547)]['delete'](_0x5c2554['id']),_0x394b2c();}break;default:break;}}),_0x1ad509;}catch(_0x5779e5){return console[_0x430cda(0x1221)](_0x430cda(0xa1b)+(_0x5c2554[_0x430cda(0x609)]||'未知')+_0x430cda(0xb07)+_0x5c2554['id']+_0x430cda(0x10ad),_0x5779e5),null;}}async function _0x1a44b1(_0x356d5f){const _0x5c978a=_0x419fa8;_0x30dc98(),_0x1150e0();const _0x184caf=_0x9ebf46[_0x5c978a(0x547)][_0x356d5f];if(!_0x184caf)return;_0x2d6552();const _0x3536db=document[_0x5c978a(0x9c8)](_0x5c978a(0xbff)),_0x19bf24=document[_0x5c978a(0x9c8)](_0x5c978a(0x768)),_0x36a301=document[_0x5c978a(0x9c8)](_0x5c978a(0x1134)),_0x966bf1=document['getElementById'](_0x5c978a(0x927));_0x3536db[_0x5c978a(0xc9f)]['theme']=_0x184caf[_0x5c978a(0x1131)][_0x5c978a(0x56d)]||_0x5c978a(0x108b);const _0xdb7179=_0x184caf[_0x5c978a(0x1131)][_0x5c978a(0x844)]||0xd;_0x3536db[_0x5c978a(0x5e1)][_0x5c978a(0xa9e)](_0x5c978a(0x1110),_0xdb7179+'px'),_0x144843(_0x184caf['settings'][_0x5c978a(0xc83)]||'',_0x5c978a(0xcd6),_0x5c978a(0x8fe)),document[_0x5c978a(0x9c8)](_0x5c978a(0x117c))['textContent']=_0x184caf['name'];const _0x421aa2=document['getElementById'](_0x5c978a(0x41f)),_0x3b9be7=_0x421aa2['querySelector'](_0x5c978a(0x4e9));_0x184caf[_0x5c978a(0x11e4)]?(_0x421aa2[_0x5c978a(0x5e1)]['display']=_0x5c978a(0x8f6),document['getElementById']('chat-header-title-wrapper')[_0x5c978a(0x5e1)][_0x5c978a(0x627)]=_0x5c978a(0x9f7)):(_0x421aa2[_0x5c978a(0x5e1)][_0x5c978a(0x3c5)]=_0x5c978a(0x989),document[_0x5c978a(0x9c8)](_0x5c978a(0xcf9))[_0x5c978a(0x5e1)][_0x5c978a(0x627)]=_0x5c978a(0x470),_0x3b9be7[_0x5c978a(0xe24)]=_0x184caf['status']?.[_0x5c978a(0xbb7)]||'在线',_0x421aa2['classList'][_0x5c978a(0x1c3)](_0x5c978a(0x280),_0x184caf[_0x5c978a(0xebd)]?.[_0x5c978a(0xf22)]||![]));const _0x159380=document[_0x5c978a(0x9c8)](_0x5c978a(0x504)),_0x5ae32b=_0x184caf[_0x5c978a(0x1131)][_0x5c978a(0x93f)],_0x23e889=_0x9ebf46[_0x5c978a(0x1383)][_0x5c978a(0x73a)],_0x351d96=document[_0x5c978a(0x9c8)](_0x5c978a(0x6fb))[_0x5c978a(0x575)]['contains'](_0x5c978a(0x292)),_0x41817e=_0x351d96?_0x5c978a(0xee1):_0x5c978a(0xbea);if(_0x5ae32b)_0x159380[_0x5c978a(0x5e1)]['backgroundImage']=_0x5c978a(0x7fe)+_0x5ae32b+')',_0x159380[_0x5c978a(0x5e1)][_0x5c978a(0x8e2)]=_0x5c978a(0x740);else _0x23e889?(_0x159380[_0x5c978a(0x5e1)][_0x5c978a(0x11d9)]=_0x5c978a(0x7fe)+_0x23e889+')',_0x159380[_0x5c978a(0x5e1)][_0x5c978a(0x8e2)]='transparent'):(_0x159380['style'][_0x5c978a(0x11d9)]=_0x5c978a(0x8f6),_0x159380[_0x5c978a(0x5e1)][_0x5c978a(0x8e2)]=_0x41817e);if(_0x184caf[_0x5c978a(0x123a)])_0x19bf24[_0x5c978a(0x5e1)][_0x5c978a(0x3c5)]=_0x5c978a(0x8f6),_0x36a301[_0x5c978a(0x5e1)][_0x5c978a(0x3c5)]=_0x5c978a(0x989),_0x966bf1[_0x5c978a(0x2f5)]=_0x5c978a(0x964),document['getElementById'](_0x5c978a(0x6c9))[_0x5c978a(0x2fa)]=_0x13a3b1;else{_0x19bf24[_0x5c978a(0x5e1)][_0x5c978a(0x3c5)]=_0x5c978a(0x989),_0x36a301[_0x5c978a(0x5e1)][_0x5c978a(0x3c5)]=_0x5c978a(0x8f6),_0x966bf1['innerHTML']='';if(!_0x184caf[_0x5c978a(0x11e4)]&&_0x184caf['relationship'][_0x5c978a(0xebd)]!=='friend'){_0x36a301['style'][_0x5c978a(0x3c5)]='flex',_0x19bf24['style'][_0x5c978a(0x9dc)]='hidden';let _0x136a3d='';switch(_0x184caf[_0x5c978a(0x36f)][_0x5c978a(0xebd)]){case _0x5c978a(0xafb):const _0x1afb02=_0x3c8875!==null,_0x76ccbe=_0x184caf[_0x5c978a(0x36f)][_0x5c978a(0x13c3)],_0xb020d3=_0x9ebf46[_0x5c978a(0x1383)][_0x5c978a(0x368)]||0x1,_0x483029=_0xb020d3*0x3c*0x3c*0x3e8,_0x596241=Date[_0x5c978a(0x9b7)]()-_0x76ccbe,_0xb3ff77=_0x596241>_0x483029,_0xa0a3ea=Math[_0x5c978a(0x24e)](0x0,Math[_0x5c978a(0x1f1)]((_0x483029-_0x596241)/(0x3e8*0x3c)));_0x136a3d=_0x5c978a(0x520)+_0x184caf['name']+_0x5c978a(0x48a)+(_0x9ebf46[_0x5c978a(0x1383)][_0x5c978a(0x22a)]?'<span\x20style=\x22color:\x20green;\x22>已开启</span>':_0x5c978a(0x28d))+_0x5c978a(0x356)+(_0x1afb02?_0x5c978a(0xeca):_0x5c978a(0xbbb))+_0x5c978a(0xa46)+_0x184caf[_0x5c978a(0x36f)][_0x5c978a(0xebd)]+_0x5c978a(0x378)+_0xb020d3+_0x5c978a(0xe5b)+(_0xb3ff77?_0x5c978a(0x9f4):_0x5c978a(0x102d)+_0xa0a3ea+'\x20分钟)</span>')+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20'+(_0xb3ff77&&_0x9ebf46['globalSettings'][_0x5c978a(0x22a)]?_0x5c978a(0xa80):'<span\x20style=\x22color:\x20red;\x22>未满足</span>')+_0x5c978a(0xec7);break;case _0x5c978a(0x23d):_0x136a3d=_0x5c978a(0xe2f);break;case _0x5c978a(0xe00):_0x136a3d=_0x5c978a(0x1120)+_0x184caf[_0x5c978a(0x609)]+_0x5c978a(0x221)+_0x184caf[_0x5c978a(0x36f)][_0x5c978a(0x1271)]+'”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';break;case _0x5c978a(0x26d):_0x136a3d=_0x5c978a(0x5f4);break;}_0x966bf1[_0x5c978a(0x2f5)]=_0x136a3d;}else _0x36a301[_0x5c978a(0x5e1)][_0x5c978a(0x3c5)]=_0x5c978a(0x8f6),_0x19bf24[_0x5c978a(0x5e1)][_0x5c978a(0x9dc)]=_0x5c978a(0xc3f);}_0x3536db[_0x5c978a(0x2f5)]='';const _0x7e8c60=_0x184caf[_0x5c978a(0x8b3)];_0x2200fe=0x0;const _0x43a8e8=_0x9ebf46['globalSettings'][_0x5c978a(0x4f5)]||0x32,_0x45bd52=_0x7e8c60['slice'](-_0x43a8e8),_0x2aaf02=[];let _0x20b9a6=0x0;for(const _0x5b7c04 of _0x45bd52){_0x20b9a6>0x0&&_0x5b7c04[_0x5c978a(0x6b5)]-_0x20b9a6>0x927c0&&_0x2aaf02['push'](Promise[_0x5c978a(0x6bb)](_0x4b8eaa(_0x5b7c04['timestamp']))),_0x2aaf02[_0x5c978a(0x668)](_0x8ae2cf(_0x5b7c04,_0x184caf,!![])),_0x20b9a6=_0x5b7c04[_0x5c978a(0x6b5)];}const _0x1f7e99=await Promise[_0x5c978a(0xd0a)](_0x2aaf02),_0x22c5f9=document[_0x5c978a(0x5a2)]();_0x1f7e99['filter'](Boolean)[_0x5c978a(0x591)](_0x47cb0e=>_0x22c5f9['appendChild'](_0x47cb0e)),_0x3536db[_0x5c978a(0x7b9)](_0x22c5f9),_0x2200fe=_0x45bd52[_0x5c978a(0xa06)];const _0x2147f2=document[_0x5c978a(0x28a)](_0x5c978a(0x11f4));_0x2147f2['id']=_0x5c978a(0xb53),_0x2147f2['style']['display']=_0x5c978a(0x8f6),_0x2147f2[_0x5c978a(0xe24)]=_0x5c978a(0x566),_0x3536db[_0x5c978a(0x7b9)](_0x2147f2),setTimeout(()=>_0x3536db['scrollTop']=_0x3536db[_0x5c978a(0x1e4)],0x0);}async function _0x32afa4(){const _0x44326e=_0x419fa8;if(_0x836281)return;_0x836281=!![];const _0xcfa302=document[_0x44326e(0x9c8)](_0x44326e(0xbff)),_0x4e2e83=_0x9ebf46[_0x44326e(0x547)][_0x9ebf46[_0x44326e(0x970)]];if(!_0x4e2e83){_0x836281=![];return;}_0xde08bb(_0xcfa302,_0x44326e(0x114a));const _0x4f8ad7=_0xcfa302[_0x44326e(0x1e4)];await new Promise(_0x29ee0e=>setTimeout(_0x29ee0e,0x1f4));const _0x60043d=_0x4e2e83[_0x44326e(0x8b3)]['length'],_0x4060d2=_0x9ebf46['globalSettings'][_0x44326e(0x4f5)]||0x32,_0x32f414=_0x60043d-_0x2200fe-_0x4060d2,_0x1db0b1=_0x60043d-_0x2200fe,_0x472ec3=_0x4e2e83['history'][_0x44326e(0x1044)](Math[_0x44326e(0x24e)](0x0,_0x32f414),_0x1db0b1),_0x5eb66d=_0xcfa302[_0x44326e(0x91d)](_0x44326e(0x11ef));let _0x585d08=_0x5eb66d?parseInt(_0x5eb66d[_0x44326e(0xc9f)][_0x44326e(0x6b5)]):0x0;for(const _0x119ebb of _0x472ec3[_0x44326e(0x101e)]()){if(_0x585d08>0x0&&_0x585d08-_0x119ebb[_0x44326e(0x6b5)]>0x927c0){const _0x5a9135=_0x4b8eaa(_0x585d08);_0xcfa302['prepend'](_0x5a9135);}await _0x3e9e57(_0x119ebb,_0x4e2e83),_0x585d08=_0x119ebb[_0x44326e(0x6b5)];}_0x2200fe+=_0x472ec3[_0x44326e(0xa06)];const _0x4d859a=_0xcfa302[_0x44326e(0x1e4)];_0xcfa302[_0x44326e(0x783)]=_0x4d859a-_0x4f8ad7,_0xfb2eb9(_0xcfa302),_0x836281=![];}function _0xec3eb7(){const _0x4a735b=_0x419fa8;_0xd0ffc0(),_0x407950();const _0x4808d9=document[_0x4a735b(0x9c8)](_0x4a735b(0x897)),_0x586997=_0x9ebf46[_0x4a735b(0x1383)]['wallpaper'];_0x586997?(_0x4808d9[_0x4a735b(0x5e1)][_0x4a735b(0x11d9)]=_0x4a735b(0x7fe)+_0x586997+')',_0x4808d9[_0x4a735b(0xe24)]=''):(_0x4808d9[_0x4a735b(0x5e1)][_0x4a735b(0x11d9)]=_0x4a735b(0x10a5),_0x4808d9[_0x4a735b(0xe24)]='当前为渐变色');const _0x144405=document[_0x4a735b(0x9c8)](_0x4a735b(0xf5e)),_0x4f9e92=_0x9ebf46[_0x4a735b(0x1383)][_0x4a735b(0xe0b)];_0x4f9e92?(_0x144405[_0x4a735b(0x5e1)][_0x4a735b(0x11d9)]=_0x4a735b(0x7fe)+_0x4f9e92+')',_0x144405[_0x4a735b(0xe24)]=''):(_0x144405[_0x4a735b(0x5e1)][_0x4a735b(0x11d9)]=_0x4a735b(0x435),_0x144405[_0x4a735b(0xe24)]=_0x4a735b(0xec0));const _0xfcdd5b=document[_0x4a735b(0x9c8)](_0x4a735b(0x981)),_0x41ed1b=_0x9ebf46[_0x4a735b(0x1383)][_0x4a735b(0x73a)];_0x41ed1b?(_0xfcdd5b['style'][_0x4a735b(0x11d9)]=_0x4a735b(0x7fe)+_0x41ed1b+')',_0xfcdd5b['textContent']='',document['getElementById'](_0x4a735b(0x1170))[_0x4a735b(0x5e1)][_0x4a735b(0x3c5)]=_0x4a735b(0xf6c)):(_0xfcdd5b[_0x4a735b(0x5e1)][_0x4a735b(0x11d9)]=_0x4a735b(0x8f6),_0xfcdd5b['textContent']='点击下方上传',document['getElementById'](_0x4a735b(0x1170))[_0x4a735b(0x5e1)][_0x4a735b(0x3c5)]=_0x4a735b(0x8f6)),_0x14c32f(),_0x585ab4(),document['getElementById']('global-css-input')['value']=_0x9ebf46[_0x4a735b(0x1383)][_0x4a735b(0x911)]||'',document[_0x4a735b(0x9c8)](_0x4a735b(0x89a))['value']=_0x9ebf46[_0x4a735b(0x1383)]['notificationSoundUrl']||'',document[_0x4a735b(0x9c8)](_0x4a735b(0x13c2))[_0x4a735b(0x1ec)]=_0x9ebf46[_0x4a735b(0x1383)][_0x4a735b(0xb3b)]||![],_0x50cb6d(),_0xc4095b();}window[_0x419fa8(0xc4c)]=_0xec3eb7;function _0x2a99db(){const _0x36b6ef=_0x419fa8,_0x4449c8=document[_0x36b6ef(0x9c8)](_0x36b6ef(0x327)),_0x35eac8=_0x9ebf46[_0x36b6ef(0x1383)][_0x36b6ef(0x1254)];_0x35eac8?_0x4449c8[_0x36b6ef(0x5e1)][_0x36b6ef(0x11d9)]=_0x36b6ef(0x7fe)+_0x35eac8+')':_0x4449c8['style'][_0x36b6ef(0x11d9)]='linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)';}function _0x8ca9ec(_0x4c4c28){const _0x1ac1c8=_0x419fa8;document['querySelectorAll']('.world-book-tab')['forEach'](_0x3db4df=>{const _0x5171ce=_0x3569;_0x3db4df[_0x5171ce(0x575)]['toggle'](_0x5171ce(0x113d),_0x3db4df[_0x5171ce(0xc9f)]['categoryId']===_0x4c4c28);}),document[_0x1ac1c8(0x7e4)](_0x1ac1c8(0x4f8))[_0x1ac1c8(0x591)](_0x344968=>{const _0x2ea7a8=_0x1ac1c8;_0x344968[_0x2ea7a8(0x575)][_0x2ea7a8(0x1c3)]('active',_0x344968[_0x2ea7a8(0xc9f)][_0x2ea7a8(0x408)]===_0x4c4c28);});}async function _0x3ce340(){const _0x2aeb7f=_0x419fa8,_0x1aae3b=document[_0x2aeb7f(0x9c8)](_0x2aeb7f(0xea5)),_0x2befd9=document[_0x2aeb7f(0x9c8)]('world-book-content-container');_0x1aae3b[_0x2aeb7f(0x2f5)]='',_0x2befd9['innerHTML']='';const [_0x1e0591,_0xb4239e]=await Promise[_0x2aeb7f(0xd0a)]([_0x2c5bcf[_0x2aeb7f(0x1369)]['toArray'](),_0x2c5bcf[_0x2aeb7f(0x58a)][_0x2aeb7f(0x8ea)](_0x2aeb7f(0x609))[_0x2aeb7f(0x5ff)]()]);_0x9ebf46[_0x2aeb7f(0x1369)]=_0x1e0591;if(_0x1e0591['length']===0x0){_0x2befd9[_0x2aeb7f(0x2f5)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>';return;}const _0x1c298d=document[_0x2aeb7f(0x28a)](_0x2aeb7f(0x82f));_0x1c298d[_0x2aeb7f(0x82c)]='world-book-tab\x20active',_0x1c298d[_0x2aeb7f(0xe24)]='全部',_0x1c298d[_0x2aeb7f(0xc9f)][_0x2aeb7f(0x408)]=_0x2aeb7f(0xd0a),_0x1aae3b[_0x2aeb7f(0x7b9)](_0x1c298d);const _0x6c3935=document[_0x2aeb7f(0x28a)](_0x2aeb7f(0x11f4));_0x6c3935[_0x2aeb7f(0x82c)]='world-book-category-pane\x20active',_0x6c3935['dataset'][_0x2aeb7f(0x408)]=_0x2aeb7f(0xd0a),_0x2befd9['appendChild'](_0x6c3935),_0xb4239e[_0x2aeb7f(0x591)](_0x32a5b9=>{const _0x343e63=_0x2aeb7f,_0x492e24=document[_0x343e63(0x28a)]('button');_0x492e24['className']=_0x343e63(0xa38),_0x492e24[_0x343e63(0xe24)]=_0x32a5b9[_0x343e63(0x609)],_0x492e24[_0x343e63(0xc9f)][_0x343e63(0x408)]=String(_0x32a5b9['id']),_0x1aae3b['appendChild'](_0x492e24);const _0x5d3f48=document[_0x343e63(0x28a)](_0x343e63(0x11f4));_0x5d3f48[_0x343e63(0x82c)]=_0x343e63(0x297),_0x5d3f48[_0x343e63(0xc9f)][_0x343e63(0x408)]=String(_0x32a5b9['id']),_0x2befd9[_0x343e63(0x7b9)](_0x5d3f48);});const _0x44510f=_0x1e0591[_0x2aeb7f(0x10b2)](_0xb45a4e=>!_0xb45a4e[_0x2aeb7f(0x408)]);if(_0x44510f){const _0x59cc80=document[_0x2aeb7f(0x28a)](_0x2aeb7f(0x82f));_0x59cc80['className']=_0x2aeb7f(0xa38),_0x59cc80['textContent']=_0x2aeb7f(0x6ea),_0x59cc80[_0x2aeb7f(0xc9f)][_0x2aeb7f(0x408)]=_0x2aeb7f(0x247),_0x1aae3b[_0x2aeb7f(0x7b9)](_0x59cc80);const _0x24b5ed=document['createElement'](_0x2aeb7f(0x11f4));_0x24b5ed[_0x2aeb7f(0x82c)]='world-book-category-pane',_0x24b5ed[_0x2aeb7f(0xc9f)][_0x2aeb7f(0x408)]=_0x2aeb7f(0x247),_0x2befd9[_0x2aeb7f(0x7b9)](_0x24b5ed);}_0x1e0591[_0x2aeb7f(0x591)](_0x451cf5=>{const _0x1f5bae=_0x2aeb7f;let _0xbfa279=_0x1f5bae(0xd1f);if(Array[_0x1f5bae(0xb27)](_0x451cf5['content'])&&_0x451cf5['content'][_0x1f5bae(0xa06)]>0x0){const _0x548c80=_0x451cf5['content'][0x0];_0xbfa279=_0x548c80[_0x1f5bae(0x10de)]||_0x548c80[_0x1f5bae(0x53b)]||'';}else typeof _0x451cf5[_0x1f5bae(0x53b)]===_0x1f5bae(0xe56)&&_0x451cf5['content'][_0x1f5bae(0x3f1)]()!==''&&(_0xbfa279=_0x451cf5[_0x1f5bae(0x53b)]);const _0xa26589=document['createElement'](_0x1f5bae(0x11f4));_0xa26589[_0x1f5bae(0x82c)]='world-book-card',_0xa26589['innerHTML']=_0x1f5bae(0xacf)+_0x451cf5['name']+_0x1f5bae(0x687)+_0xbfa279+_0x1f5bae(0x1122);const _0x598b63=()=>_0x31b7ce(_0x451cf5['id']),_0xab405=async()=>{const _0x13ea1b=_0x1f5bae,_0x4cc5a9=await _0x352ae9(_0x13ea1b(0xf7e),'确定要删除《'+_0x451cf5[_0x13ea1b(0x609)]+_0x13ea1b(0xf50),{'confirmButtonClass':_0x13ea1b(0x12bc)});_0x4cc5a9&&(await _0x2c5bcf[_0x13ea1b(0x1369)][_0x13ea1b(0x6d2)](_0x451cf5['id']),_0x9ebf46['worldBooks']=_0x9ebf46[_0x13ea1b(0x1369)][_0x13ea1b(0x401)](_0x39096d=>_0x39096d['id']!==_0x451cf5['id']),_0x3ce340());};_0xa26589[_0x1f5bae(0xa0f)](_0x1f5bae(0xf5c),_0x598b63),_0x43a60a(_0xa26589,_0xab405);const _0x5cf4a5=_0xa26589[_0x1f5bae(0x75c)](!![]);_0x5cf4a5[_0x1f5bae(0xa0f)](_0x1f5bae(0xf5c),_0x598b63),_0x43a60a(_0x5cf4a5,_0xab405),_0x6c3935[_0x1f5bae(0x7b9)](_0x5cf4a5);const _0x1cef8a=_0x451cf5[_0x1f5bae(0x408)]?String(_0x451cf5['categoryId']):_0x1f5bae(0x247),_0x1213cf=_0x2befd9[_0x1f5bae(0x91d)](_0x1f5bae(0x815)+_0x1cef8a+'\x22]');_0x1213cf&&_0x1213cf[_0x1f5bae(0x7b9)](_0xa26589);}),document[_0x2aeb7f(0x7e4)](_0x2aeb7f(0x999))['forEach'](_0x4597c4=>{const _0x1a63ef=_0x2aeb7f;_0x4597c4[_0x1a63ef(0xa0f)](_0x1a63ef(0xf5c),()=>_0x8ca9ec(_0x4597c4[_0x1a63ef(0xc9f)][_0x1a63ef(0x408)]));});}function _0x5e363d(_0x1ea9af,_0x20d928){const _0x35b632=_0x419fa8,_0x20a168=document[_0x35b632(0x28a)](_0x35b632(0x11f4));_0x20a168[_0x35b632(0x82c)]='world-book-group-container',_0x20a168[_0x35b632(0x2f5)]=_0x35b632(0x1204)+_0x1ea9af+_0x35b632(0xc53);const _0x220b26=_0x20a168['querySelector'](_0x35b632(0xb04));return _0x20d928[_0x35b632(0x66b)]((_0x24a0b1,_0x15449b)=>_0x24a0b1[_0x35b632(0x609)]['localeCompare'](_0x15449b[_0x35b632(0x609)],_0x35b632(0x101b))),_0x20d928[_0x35b632(0x591)](_0x37c846=>{const _0x2c5742=_0x35b632;let _0x2b8de9='暂无内容...';if(Array[_0x2c5742(0xb27)](_0x37c846[_0x2c5742(0x53b)])&&_0x37c846[_0x2c5742(0x53b)]['length']>0x0){const _0xc965d=_0x37c846['content'][0x0];_0x2b8de9=_0xc965d[_0x2c5742(0x10de)]||_0xc965d[_0x2c5742(0x53b)]||'';}else typeof _0x37c846[_0x2c5742(0x53b)]==='string'&&_0x37c846['content']['trim']()!==''&&(_0x2b8de9=_0x37c846['content']);const _0x38386d=document[_0x2c5742(0x28a)]('div');_0x38386d[_0x2c5742(0x82c)]='list-item',_0x38386d['dataset'][_0x2c5742(0x7ad)]=_0x37c846['id'],_0x38386d[_0x2c5742(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>'+_0x37c846['name']+_0x2c5742(0xcdb)+String(_0x2b8de9)[_0x2c5742(0xc34)](0x0,0x32)+_0x2c5742(0x1122),_0x38386d['addEventListener']('click',()=>_0x31b7ce(_0x37c846['id'])),_0x43a60a(_0x38386d,async()=>{const _0x3357ed=_0x2c5742,_0x5a624b=await _0x352ae9(_0x3357ed(0xf7e),_0x3357ed(0x5d2)+_0x37c846[_0x3357ed(0x609)]+_0x3357ed(0x985),{'confirmButtonClass':_0x3357ed(0x12bc)});_0x5a624b&&(await _0x2c5bcf['worldBooks'][_0x3357ed(0x6d2)](_0x37c846['id']),_0x9ebf46[_0x3357ed(0x1369)]=_0x9ebf46[_0x3357ed(0x1369)]['filter'](_0x6dfd89=>_0x6dfd89['id']!==_0x37c846['id']),_0x3ce340());}),_0x220b26['appendChild'](_0x38386d);}),_0x20a168;}window[_0x419fa8(0x8d0)]=_0x3ce340;async function _0x31b7ce(_0x913535){const _0x16ef90=_0x419fa8;_0xe5834e(_0x16ef90(0x4ec)),_0x56f504=_0x913535;const [_0x407972,_0xff2a34]=await Promise[_0x16ef90(0xd0a)]([_0x2c5bcf['worldBooks']['get'](_0x913535),_0x2c5bcf['worldBookCategories']['toArray']()]);if(!_0x407972){console['error'](_0x16ef90(0x2bb),_0x913535),_0xe5834e(_0x16ef90(0x3d0));return;}document[_0x16ef90(0x9c8)](_0x16ef90(0xc47))['textContent']=_0x407972[_0x16ef90(0x609)],document[_0x16ef90(0x9c8)](_0x16ef90(0xb12))[_0x16ef90(0x1155)]=_0x407972[_0x16ef90(0x609)];const _0x657777=document[_0x16ef90(0x9c8)](_0x16ef90(0x10aa));_0x657777[_0x16ef90(0x2f5)]=_0x16ef90(0xaff),_0xff2a34[_0x16ef90(0x591)](_0x2c036f=>{const _0x4276b3=_0x16ef90,_0x271af7=document[_0x4276b3(0x28a)]('option');_0x271af7[_0x4276b3(0x1155)]=_0x2c036f['id'],_0x271af7[_0x4276b3(0xe24)]=_0x2c036f[_0x4276b3(0x609)];if(_0x407972['categoryId']===_0x2c036f['id'])_0x271af7[_0x4276b3(0x631)]=!![];_0x657777[_0x4276b3(0x7b9)](_0x271af7);});const _0x3773ff=document[_0x16ef90(0x9c8)]('world-book-entries-container');_0x3773ff['innerHTML']='',Array[_0x16ef90(0xb27)](_0x407972[_0x16ef90(0x53b)])&&_0x407972[_0x16ef90(0x53b)][_0x16ef90(0xa06)]>0x0?_0x407972[_0x16ef90(0x53b)][_0x16ef90(0x591)](_0x40b5c7=>{const _0x376ce3=_0x14ba38(_0x40b5c7);_0x3773ff['appendChild'](_0x376ce3);}):_0x3773ff['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>';}async function _0x43920d(_0x1e855f=!![]){const _0x2b4de0=_0x419fa8,_0x4d2273=document['getElementById'](_0x2b4de0(0x4a2)),_0x4a8687=document[_0x2b4de0(0x9c8)](_0x2b4de0(0x70a)),_0x1f4a98=document[_0x2b4de0(0x9c8)](_0x2b4de0(0xe61)),_0x3f0ade=_0x1f4a98[_0x2b4de0(0x1155)]['trim']()['toLowerCase']();if(_0x1e855f){_0x4a8687[_0x2b4de0(0x2f5)]='';const _0x567337=await _0x2c5bcf[_0x2b4de0(0x1342)][_0x2b4de0(0x5ff)]();_0x4a8687[_0x2b4de0(0x2f5)]+=_0x2b4de0(0x666)+(_0x55c803===_0x2b4de0(0xd0a)?_0x2b4de0(0x113d):'')+_0x2b4de0(0x541),_0x567337[_0x2b4de0(0x591)](_0x39541d=>{const _0x9f2d01=_0x2b4de0;_0x4a8687['innerHTML']+=_0x9f2d01(0x666)+(_0x55c803===_0x39541d['id']?_0x9f2d01(0x113d):'')+'\x22\x20data-category-id=\x22'+_0x39541d['id']+'\x22>'+_0x39541d[_0x9f2d01(0x609)]+_0x9f2d01(0x8bc);}),_0x4a8687[_0x2b4de0(0x2f5)]+=_0x2b4de0(0x666)+(_0x55c803==='uncategorized'?_0x2b4de0(0x113d):'')+_0x2b4de0(0x786);}_0x4d2273[_0x2b4de0(0x2f5)]='';let _0xe417d2;if(_0x55c803===_0x2b4de0(0xd0a))_0xe417d2=_0x9ebf46[_0x2b4de0(0x774)];else _0x55c803===_0x2b4de0(0x247)?_0xe417d2=_0x9ebf46['userStickers']['filter'](_0x4c44a7=>!_0x4c44a7[_0x2b4de0(0x408)]):_0xe417d2=_0x9ebf46['userStickers'][_0x2b4de0(0x401)](_0x39c8d9=>_0x39c8d9['categoryId']===_0x55c803);const _0x340c9a=_0x3f0ade?_0xe417d2[_0x2b4de0(0x401)](_0x217b49=>_0x217b49[_0x2b4de0(0x609)][_0x2b4de0(0xc61)]()[_0x2b4de0(0x930)](_0x3f0ade)):_0xe417d2;if(_0x340c9a[_0x2b4de0(0xa06)]===0x0){const _0x5524d6=_0x3f0ade?_0x2b4de0(0x21c):'这个分类下还没有表情哦~';_0x4d2273['innerHTML']=_0x2b4de0(0x4a8)+_0x5524d6+'</p>';return;}_0x340c9a['forEach'](_0xcae74a=>{const _0x2a0b04=_0x2b4de0,_0x281932=document['createElement']('div');_0x281932[_0x2a0b04(0x82c)]=_0x2a0b04(0x10a4),_0x281932[_0x2a0b04(0x9f2)]=_0xcae74a['name'],_0x281932[_0x2a0b04(0xc9f)][_0x2a0b04(0xe69)]=_0xcae74a['id'],_0x281932[_0x2a0b04(0x2f5)]=_0x2a0b04(0x1255)+_0xcae74a[_0x2a0b04(0x11be)]+_0x2a0b04(0x12e2)+_0xcae74a[_0x2a0b04(0x609)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x281932[_0x2a0b04(0xa0f)](_0x2a0b04(0xf5c),()=>{_0x51f0c1?_0x4923af(_0x281932):_0x4b747c(_0xcae74a);});const _0x4f9e63=document[_0x2a0b04(0x28a)](_0x2a0b04(0x11f4));_0x4f9e63[_0x2a0b04(0x82c)]=_0x2a0b04(0x465),_0x4f9e63[_0x2a0b04(0x2f5)]=_0x2a0b04(0x5a7),_0x4f9e63[_0x2a0b04(0x2fa)]=async _0x934911=>{const _0x153097=_0x2a0b04;_0x934911[_0x153097(0x20a)]();const _0x46552c=await _0x352ae9('删除表情',_0x153097(0x101c)+_0xcae74a[_0x153097(0x609)]+_0x153097(0x891),{'confirmButtonClass':'btn-danger'});_0x46552c&&(await _0x2c5bcf[_0x153097(0x774)][_0x153097(0x6d2)](_0xcae74a['id']),_0x9ebf46['userStickers']=_0x9ebf46['userStickers'][_0x153097(0x401)](_0x331681=>_0x331681['id']!==_0xcae74a['id']),_0x43920d());},_0x281932[_0x2a0b04(0x7b9)](_0x4f9e63),_0x4d2273[_0x2a0b04(0x7b9)](_0x281932);});}let _0x51f0c1=![],_0x29c818=new Set();function _0x207725(){const _0x3741c0=_0x419fa8;_0x51f0c1=!_0x51f0c1;const _0x545a42=document[_0x3741c0(0x9c8)]('sticker-grid'),_0x3cff2f=document[_0x3741c0(0x9c8)](_0x3741c0(0xae5)),_0x5c4460=document[_0x3741c0(0x9c8)](_0x3741c0(0x3fd)),_0x33e337=document[_0x3741c0(0x9c8)]('select-all-stickers-checkbox');_0x545a42[_0x3741c0(0x575)]['toggle'](_0x3741c0(0x7a7),_0x51f0c1),_0x51f0c1?(_0x3cff2f[_0x3741c0(0xe24)]='完成',_0x5c4460[_0x3741c0(0x5e1)]['display']=_0x3741c0(0x989),_0x29c818['clear'](),_0x33e337[_0x3741c0(0x1ec)]=![],_0x44bc4b()):(_0x3cff2f[_0x3741c0(0xe24)]='管理',_0x5c4460[_0x3741c0(0x5e1)][_0x3741c0(0x3c5)]=_0x3741c0(0x8f6),_0x545a42[_0x3741c0(0x7e4)]('.sticker-item.selected')[_0x3741c0(0x591)](_0x19b200=>_0x19b200[_0x3741c0(0x575)][_0x3741c0(0x30f)](_0x3741c0(0x631))));}function _0x36736d(){const _0x38ee51=_0x419fa8,_0x192e99=document['getElementById'](_0x38ee51(0x10d6)),_0x1ddaee=_0x192e99[_0x38ee51(0x1ec)];let _0x4c9cee;if(_0x55c803===_0x38ee51(0xd0a))_0x4c9cee=_0x9ebf46[_0x38ee51(0x774)];else _0x55c803===_0x38ee51(0x247)?_0x4c9cee=_0x9ebf46['userStickers'][_0x38ee51(0x401)](_0x3d8c5e=>!_0x3d8c5e[_0x38ee51(0x408)]):_0x4c9cee=_0x9ebf46[_0x38ee51(0x774)][_0x38ee51(0x401)](_0x223cd6=>_0x223cd6[_0x38ee51(0x408)]===_0x55c803);_0x4c9cee[_0x38ee51(0x591)](_0xbc9a6e=>{const _0x2e985a=_0x38ee51,_0x35eb6c=_0xbc9a6e['id'],_0x3ac608=document[_0x2e985a(0x91d)](_0x2e985a(0x1359)+_0x35eb6c+'\x22]');if(_0x1ddaee){_0x29c818[_0x2e985a(0x68e)](_0x35eb6c);if(_0x3ac608)_0x3ac608[_0x2e985a(0x575)]['add'](_0x2e985a(0x631));}else{_0x29c818[_0x2e985a(0x6d2)](_0x35eb6c);if(_0x3ac608)_0x3ac608[_0x2e985a(0x575)][_0x2e985a(0x30f)](_0x2e985a(0x631));}}),_0x44bc4b();}function _0x44bc4b(){const _0x32d4ea=_0x419fa8,_0x52027b=document['getElementById'](_0x32d4ea(0xf7f));_0x52027b[_0x32d4ea(0xe24)]='删除\x20('+_0x29c818[_0x32d4ea(0xa67)]+')';}function _0x4923af(_0x3aacd4){const _0x4db4bd=_0x419fa8;if(!_0x51f0c1)return;const _0x369c11=_0x3aacd4[_0x4db4bd(0xc9f)][_0x4db4bd(0xe69)];if(!_0x369c11)return;_0x3aacd4[_0x4db4bd(0x575)][_0x4db4bd(0x1c3)](_0x4db4bd(0x631)),_0x29c818[_0x4db4bd(0xd97)](_0x369c11)?_0x29c818['delete'](_0x369c11):_0x29c818[_0x4db4bd(0x68e)](_0x369c11),_0x44bc4b();}async function _0x27519a(){const _0x3eb131=_0x419fa8;if(_0x29c818[_0x3eb131(0xa67)]===0x0)return;const _0x383d54=await _0x352ae9(_0x3eb131(0x115b),'确定要删除选中的\x20'+_0x29c818[_0x3eb131(0xa67)]+_0x3eb131(0x928),{'confirmButtonClass':_0x3eb131(0x12bc)});if(_0x383d54){const _0x53aee9=[..._0x29c818];await _0x2c5bcf[_0x3eb131(0x774)][_0x3eb131(0x256)](_0x53aee9),_0x9ebf46['userStickers']=_0x9ebf46[_0x3eb131(0x774)][_0x3eb131(0x401)](_0x1a1ec1=>!_0x53aee9[_0x3eb131(0x930)](_0x1a1ec1['id'])),_0x207725(),_0x43920d(),await _0x1bff53('删除成功',_0x3eb131(0xe9e));}}async function _0x4077ba(){const _0x55e0de=_0x419fa8,_0x34e775=_0x55e0de(0xdc1),_0x276746=await _0xadb5df(_0x55e0de(0x60e),_0x34e775,'',_0x55e0de(0x11f9));_0x276746&&_0x276746[_0x55e0de(0x3f1)]()&&await _0x58fece(_0x276746);}async function _0x58fece(_0x5a957a){const _0x484b12=_0x419fa8,_0x3e9522=_0x5a957a['trim']()[_0x484b12(0x6c6)]('\x0a'),_0x40b342=[],_0x2748d8=_0x484b12(0xc70);let _0x3a18bd=0x0;const _0x4a9100=_0x55c803!=='all'&&_0x55c803!=='uncategorized'?_0x55c803:null;for(const _0x2a4df2 of _0x3e9522){const _0x3cf78a=_0x2a4df2[_0x484b12(0x3f1)]();if(!_0x3cf78a||_0x3cf78a[_0x484b12(0x930)]('填入'))continue;const _0x3e5c6e=_0x3cf78a[_0x484b12(0x12c2)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x3e5c6e){const _0x322b90=_0x3e5c6e[0x1]['trim'](),_0x2734b1=_0x3e5c6e[0x2][_0x484b12(0x3f1)]();_0x40b342[_0x484b12(0x668)]({'id':_0x484b12(0x3fe)+Date['now']()+Math['random'](),'name':_0x322b90,'url':_0x2734b1,'categoryId':_0x4a9100});continue;}let _0x983b1f=null,_0x16d9de=null;const _0x3e83ed=_0x3cf78a['match'](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x3e83ed)_0x983b1f=_0x3e83ed[0x1],_0x16d9de=_0x3e83ed[0x2];else{const _0x45a198=_0x3cf78a[_0x484b12(0x6c6)](/\s+/);_0x45a198[_0x484b12(0xa06)]>=0x2&&(_0x16d9de=_0x45a198[_0x484b12(0x3a0)](),_0x983b1f=_0x45a198[_0x484b12(0x809)]('\x20'));}_0x983b1f&&_0x16d9de&&_0x16d9de[_0x484b12(0x930)]('.')?_0x40b342[_0x484b12(0x668)]({'id':_0x484b12(0x3fe)+Date[_0x484b12(0x9b7)]()+Math[_0x484b12(0x360)](),'name':_0x983b1f,'url':_0x2748d8+_0x16d9de,'categoryId':_0x4a9100}):(_0x3a18bd++,console['warn'](_0x484b12(0x9e4),_0x3cf78a));}_0x3a18bd>0x0&&await _0x1bff53(_0x484b12(0x44d),'有\x20'+_0x3a18bd+_0x484b12(0x331));if(_0x40b342[_0x484b12(0xa06)]>0x0)await _0x2c5bcf['userStickers']['bulkAdd'](_0x40b342),_0x9ebf46[_0x484b12(0x774)][_0x484b12(0x668)](..._0x40b342),_0x43920d(),await _0x1bff53(_0x484b12(0x135e),_0x484b12(0x876)+_0x40b342[_0x484b12(0xa06)]+'\x20个新表情！');else _0x3a18bd===0x0&&alert(_0x484b12(0xd39));}function _0xc1ed1c(_0x12c1c9){const _0x24206c=_0x419fa8,_0x3aba1e=_0x24206c(0x47f)+_0x12c1c9+'\x22]',_0x3a2185=document['querySelector'](_0x3aba1e);_0x3a2185?(_0x3a2185[_0x24206c(0xe09)]({'behavior':_0x24206c(0x1396),'block':_0x24206c(0x9f7)}),_0x3a2185['classList'][_0x24206c(0x68e)](_0x24206c(0x918)),setTimeout(()=>{const _0x35d589=_0x24206c;document[_0x35d589(0xe20)][_0x35d589(0x1038)](_0x3a2185)&&_0x3a2185[_0x35d589(0x575)][_0x35d589(0x30f)](_0x35d589(0x918));},0x5dc)):alert(_0x24206c(0x1db));}async function _0x8ae2cf(_0x27fe6b,_0x357e71){const _0x4e6f3c=_0x419fa8;if(_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x8cc)){const _0x43abb6=document[_0x4e6f3c(0x28a)](_0x4e6f3c(0x11f4));_0x43abb6['className']=_0x4e6f3c(0xf85),_0x43abb6[_0x4e6f3c(0xc9f)][_0x4e6f3c(0x6b5)]=_0x27fe6b[_0x4e6f3c(0x6b5)];const _0x6abb8=document[_0x4e6f3c(0x28a)](_0x4e6f3c(0x11f4));return _0x6abb8[_0x4e6f3c(0x82c)]=_0x4e6f3c(0x2be),_0x6abb8[_0x4e6f3c(0xc9f)][_0x4e6f3c(0x6b5)]=_0x27fe6b[_0x4e6f3c(0x6b5)],_0x6abb8[_0x4e6f3c(0xe24)]=_0x27fe6b['content'],_0x43abb6[_0x4e6f3c(0x7b9)](_0x6abb8),_0x43a60a(_0x43abb6,()=>_0x37ae78(_0x27fe6b[_0x4e6f3c(0x6b5)])),_0x43abb6[_0x4e6f3c(0xa0f)](_0x4e6f3c(0xf5c),()=>{_0x38ba45&&_0x1c3bf3(_0x27fe6b['timestamp']);}),_0x43abb6;}else{if(_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x10a6)){const _0x3421b3=document[_0x4e6f3c(0x28a)]('div');_0x3421b3[_0x4e6f3c(0x82c)]=_0x4e6f3c(0xf85),_0x3421b3[_0x4e6f3c(0xc9f)][_0x4e6f3c(0x6b5)]=_0x27fe6b['timestamp'];const _0x51f33e=document[_0x4e6f3c(0x28a)](_0x4e6f3c(0x11f4));return _0x51f33e[_0x4e6f3c(0x82c)]=_0x4e6f3c(0x602),_0x51f33e[_0x4e6f3c(0xc9f)]['postId']=_0x27fe6b[_0x4e6f3c(0xf23)],_0x51f33e[_0x4e6f3c(0xe24)]=_0x27fe6b[_0x4e6f3c(0x53b)],_0x3421b3[_0x4e6f3c(0x7b9)](_0x51f33e),_0x43a60a(_0x3421b3,()=>_0x37ae78(_0x27fe6b[_0x4e6f3c(0x6b5)])),_0x3421b3[_0x4e6f3c(0xa0f)](_0x4e6f3c(0xf5c),()=>{const _0x6dcd8a=_0x4e6f3c;_0x38ba45&&_0x1c3bf3(_0x27fe6b[_0x6dcd8a(0x6b5)]);}),_0x3421b3;}}if(_0x27fe6b[_0x4e6f3c(0xc62)])return null;if(_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x13a8)){const _0x5aa482=document['createElement'](_0x4e6f3c(0x11f4));_0x5aa482[_0x4e6f3c(0x82c)]=_0x4e6f3c(0xf85);const _0x4319a4=document[_0x4e6f3c(0x28a)](_0x4e6f3c(0x11f4));return _0x4319a4[_0x4e6f3c(0x82c)]='message-bubble\x20system-bubble',_0x4319a4[_0x4e6f3c(0xc9f)]['timestamp']=_0x27fe6b[_0x4e6f3c(0x6b5)],_0x4319a4[_0x4e6f3c(0xe24)]=_0x27fe6b[_0x4e6f3c(0x53b)],_0x5aa482[_0x4e6f3c(0x7b9)](_0x4319a4),_0x43a60a(_0x5aa482,()=>_0x37ae78(_0x27fe6b[_0x4e6f3c(0x6b5)])),_0x5aa482[_0x4e6f3c(0xa0f)](_0x4e6f3c(0xf5c),()=>{const _0x50cd92=_0x4e6f3c;if(_0x38ba45)_0x1c3bf3(_0x27fe6b[_0x50cd92(0x6b5)]);}),_0x5aa482;}const _0x305925=_0x27fe6b[_0x4e6f3c(0x7fd)]==='user',_0x3c4b22=_0x357e71[_0x4e6f3c(0x1131)][_0x4e6f3c(0x29c)]||'我',_0x1ed029=document[_0x4e6f3c(0x28a)](_0x4e6f3c(0x11f4));_0x1ed029['className']=_0x4e6f3c(0x644)+(_0x305925?'user':'ai');if(_0x357e71[_0x4e6f3c(0x11e4)]&&!_0x305925){const _0x5a3a12=_0x357e71[_0x4e6f3c(0xd3e)][_0x4e6f3c(0xfc3)](_0x188397=>_0x188397['originalName']===_0x27fe6b['senderName']),_0x57cdd9=document['createElement'](_0x4e6f3c(0x11f4));_0x57cdd9[_0x4e6f3c(0x82c)]=_0x4e6f3c(0xf37),_0x57cdd9[_0x4e6f3c(0xe24)]=_0x5a3a12?_0x5a3a12[_0x4e6f3c(0x1132)]:_0x27fe6b[_0x4e6f3c(0xac4)]||_0x4e6f3c(0x5a1),_0x1ed029[_0x4e6f3c(0x7b9)](_0x57cdd9);}const _0x3f1f21=document[_0x4e6f3c(0x28a)](_0x4e6f3c(0x11f4));_0x3f1f21[_0x4e6f3c(0x82c)]='message-bubble\x20'+(_0x305925?_0x4e6f3c(0x586):'ai'),_0x3f1f21[_0x4e6f3c(0xc9f)][_0x4e6f3c(0x6b5)]=_0x27fe6b[_0x4e6f3c(0x6b5)];const _0x3b967f=document[_0x4e6f3c(0x28a)]('span');_0x3b967f[_0x4e6f3c(0x82c)]=_0x4e6f3c(0x6b5),_0x3b967f['textContent']=_0x443608(_0x27fe6b[_0x4e6f3c(0x6b5)]);let _0x524d44,_0x44650b='';if(_0x305925)_0x524d44=_0x357e71[_0x4e6f3c(0x1131)][_0x4e6f3c(0xb60)]||(_0x357e71['isGroup']?_0x1d990b:_0x246753),_0x44650b=_0x357e71['settings'][_0x4e6f3c(0x2a2)]||'';else{if(_0x357e71[_0x4e6f3c(0x11e4)]){const _0x5ec124=_0x357e71[_0x4e6f3c(0xd3e)][_0x4e6f3c(0xfc3)](_0x306700=>_0x306700[_0x4e6f3c(0x1071)]===_0x27fe6b[_0x4e6f3c(0xac4)]);if(_0x5ec124){const _0x4d5add=_0x9ebf46[_0x4e6f3c(0x547)][_0x5ec124['id']];_0x524d44=_0x5ec124[_0x4e6f3c(0x10c9)]||(_0x4d5add?_0x4d5add[_0x4e6f3c(0x1131)]['aiAvatar']:_0x337c8f),_0x44650b=_0x5ec124[_0x4e6f3c(0x1141)]||(_0x4d5add?_0x4d5add[_0x4e6f3c(0x1131)][_0x4e6f3c(0xdda)]:'');}else _0x524d44=_0x337c8f,_0x44650b='';}else _0x524d44=_0x357e71['settings']['aiAvatar']||_0x246753,_0x44650b=_0x357e71[_0x4e6f3c(0x1131)][_0x4e6f3c(0xdda)]||'';}let _0x1ef9e5;_0x44650b?_0x1ef9e5=_0x4e6f3c(0x1212)+_0x524d44+_0x4e6f3c(0x1054)+_0x44650b+'\x22\x20class=\x22avatar-frame\x22></div>':_0x1ef9e5=_0x4e6f3c(0x12ac)+_0x524d44+'\x22\x20class=\x22avatar\x22>';const _0x51bd43=_0x44650b?_0x4e6f3c(0x1355):'',_0x2c6d49='<div\x20class=\x22avatar-group\x20'+_0x51bd43+'\x22>'+_0x1ef9e5+_0x4e6f3c(0x103c);let _0x349ec6,_0x3c2b26='';if(_0x27fe6b['quote']){const _0x45a6b8=_0x227896(_0x357e71,_0x27fe6b[_0x4e6f3c(0xa19)]['senderName']),_0xe7b6d3=String(_0x27fe6b[_0x4e6f3c(0xa19)][_0x4e6f3c(0x53b)]||'');_0x3c2b26=_0x4e6f3c(0x132f)+_0x27fe6b[_0x4e6f3c(0xa19)]['timestamp']+'\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20'+_0x45a6b8+_0x4e6f3c(0x5e6)+_0xe7b6d3+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}let _0xd9620f=_0x27fe6b[_0x4e6f3c(0x53b)];if(typeof _0xd9620f===_0x4e6f3c(0xe56)&&_0xd9620f['trim']()[_0x4e6f3c(0xc8d)]('<')&&_0xd9620f[_0x4e6f3c(0x3f1)]()['endsWith']('>'))_0x349ec6=_0xd9620f,_0x3f1f21['classList'][_0x4e6f3c(0x68e)](_0x4e6f3c(0x840));else{if(_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0xc91)||_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x12a5)||_0x27fe6b['type']===_0x4e6f3c(0x81e)||_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x358)||_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x835)||_0x27fe6b['type']===_0x4e6f3c(0x560)||_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x10c1)||_0x27fe6b['type']==='transfer'||_0x27fe6b[_0x4e6f3c(0x12d9)]==='waimai_request'||_0x27fe6b['type']===_0x4e6f3c(0x1af)||_0x27fe6b[_0x4e6f3c(0x12d9)]==='red_packet'||_0x27fe6b[_0x4e6f3c(0x12d9)]==='poll'||_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x96e)||_0x27fe6b['type']===_0x4e6f3c(0x6d1)||_0x27fe6b[_0x4e6f3c(0x12d9)]==='naiimag'){if(_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0xc91)){const _0x1a13a9=_0x27fe6b[_0x4e6f3c(0x53b)]||((_0x27fe6b[_0x4e6f3c(0xc2e)]||'')+'\x20'+(_0x27fe6b[_0x4e6f3c(0x1387)]||''))[_0x4e6f3c(0x3f1)](),_0x2fb056=/(「.*?」|“.*?”)/g,_0x98fe9=_0x1a13a9[_0x4e6f3c(0x6c6)](_0x2fb056)[_0x4e6f3c(0x401)](_0x2df8ae=>_0x2df8ae);_0x349ec6=_0x98fe9['map'](_0x3a7f83=>{const _0x1593af=_0x4e6f3c;return _0x3a7f83[_0x1593af(0xc8d)]('「')||_0x3a7f83[_0x1593af(0xc8d)]('“')?'<span\x20class=\x22offline-dialogue\x22>'+_0x1ffeeb(_0x3a7f83)+_0x1593af(0x12c8):_0x1593af(0x501)+_0x1ffeeb(_0x3a7f83[_0x1593af(0x3f1)]())[_0x1593af(0x459)](/\n/g,'<br>')+'</span>';})['join']('');}else{if(_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x12a5))_0x3f1f21[_0x4e6f3c(0x575)]['add'](_0x4e6f3c(0x9f6),_0x4e6f3c(0x7c8)),_0x349ec6=_0x4e6f3c(0x1219)+_0x27fe6b[_0x4e6f3c(0x6b5)]+_0x4e6f3c(0x1276)+(_0x27fe6b['title']||_0x4e6f3c(0x2d7))+'</div><div\x20class=\x22description\x22>'+(_0x27fe6b['description']||_0x4e6f3c(0x659))+_0x4e6f3c(0x678)+(_0x27fe6b[_0x4e6f3c(0x545)]||_0x4e6f3c(0x5c4))+_0x4e6f3c(0x127c);else{if(_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x81e))_0x3f1f21[_0x4e6f3c(0x575)][_0x4e6f3c(0x68e)]('is-link-share','is-card-like'),_0x349ec6='<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22'+_0x27fe6b[_0x4e6f3c(0x6b5)]+_0x4e6f3c(0x1276)+_0x27fe6b[_0x4e6f3c(0xd26)][_0x4e6f3c(0x9f2)]+'</div><div\x20class=\x22description\x22>共\x20'+_0x27fe6b[_0x4e6f3c(0xd26)][_0x4e6f3c(0x4a7)][_0x4e6f3c(0xa06)]+_0x4e6f3c(0x109d);else{if(_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x358)){_0x3f1f21[_0x4e6f3c(0x575)][_0x4e6f3c(0x68e)](_0x4e6f3c(0x1d4),_0x4e6f3c(0x7c8));let _0x2a3558;if(_0x27fe6b[_0x4e6f3c(0xd5e)])_0x2a3558=_0x27fe6b[_0x4e6f3c(0xd5e)];else _0x9ebf46['globalSettings'][_0x4e6f3c(0x443)]&&_0x27fe6b[_0x4e6f3c(0xd73)]?_0x2a3558=_0x4e6f3c(0x12d5)+encodeURIComponent(_0x27fe6b[_0x4e6f3c(0xd73)]):_0x2a3558=_0x4e6f3c(0x236);const _0x23dedf=_0x4e6f3c(0x6f3)+_0x2a3558+_0x4e6f3c(0x8ac);_0x349ec6='<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>'+_0x27fe6b[_0x4e6f3c(0x53b)]+_0x4e6f3c(0x4a3)+_0x23dedf+_0x4e6f3c(0x2ab);}else{if(_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x560)||_0x27fe6b['type']==='ai_image'){_0x3f1f21[_0x4e6f3c(0x575)][_0x4e6f3c(0x68e)](_0x4e6f3c(0xe91),_0x4e6f3c(0x7c8));const _0x4135f2=_0x27fe6b['type']==='user_photo'?'用户描述的照片':_0x4e6f3c(0x94b),_0x101395=_0x9ebf46[_0x4e6f3c(0x1383)][_0x4e6f3c(0x443)]&&_0x27fe6b[_0x4e6f3c(0xd73)]?_0x4e6f3c(0x12d5)+_0x27fe6b[_0x4e6f3c(0xd73)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x349ec6=_0x4e6f3c(0x12ac)+_0x101395+_0x4e6f3c(0x6a1)+_0x4135f2+'\x22\x20data-description=\x22'+_0x27fe6b[_0x4e6f3c(0x53b)]+'\x22>';}else{if(_0x27fe6b['type']===_0x4e6f3c(0x1227))_0x3f1f21[_0x4e6f3c(0x575)]['add'](_0x4e6f3c(0x582),_0x4e6f3c(0x7c8)),_0x349ec6=_0x4e6f3c(0x12ac)+_0x27fe6b['imageUrl']+_0x4e6f3c(0xb6d)+(_0x27fe6b[_0x4e6f3c(0x1be)]||_0x27fe6b['prompt']||_0x4e6f3c(0xfe2))+'\x22>';else{if(_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x10c1)){_0x3f1f21[_0x4e6f3c(0x575)][_0x4e6f3c(0x68e)](_0x4e6f3c(0x224),_0x4e6f3c(0x7c8));const _0x2d2746=Math[_0x4e6f3c(0x24e)](0x1,Math[_0x4e6f3c(0xe3e)]((_0x27fe6b[_0x4e6f3c(0x53b)]||'')['length']/0x5)),_0xcfe062='0:'+String(_0x2d2746)[_0x4e6f3c(0x3e8)](0x2,'0')+'\x27\x27',_0x15d863=_0x4e6f3c(0x7f9);if(_0x305925)_0x349ec6='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22'+encodeURIComponent(_0x27fe6b[_0x4e6f3c(0x53b)])+_0x4e6f3c(0x11dd)+_0x15d863+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>'+_0xcfe062+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';else{const _0x516fde=!_0x357e71[_0x4e6f3c(0x11e4)]&&_0x357e71[_0x4e6f3c(0x1131)][_0x4e6f3c(0xd80)]!==![],_0x36fcfc=_0x357e71[_0x4e6f3c(0x1131)]['minimaxVoiceId']||_0x4e6f3c(0x222),_0x12d092=_0x516fde?_0x4e6f3c(0x656)+_0x36fcfc+'\x22':'';_0x349ec6=_0x4e6f3c(0x653)+encodeURIComponent(_0x27fe6b['content'])+'\x22\x20'+_0x12d092+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>'+_0x15d863+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>'+_0xcfe062+_0x4e6f3c(0x12f1);}}else{if(_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x975)){_0x3f1f21['classList'][_0x4e6f3c(0x68e)](_0x4e6f3c(0x464),_0x4e6f3c(0x7c8));let _0x571fe2,_0x56e0ea;const _0x5d8db3=_0x357e71[_0x4e6f3c(0x11e4)]?_0x357e71['settings'][_0x4e6f3c(0x29c)]||'我':'我',_0x9c7b80=_0x227896(_0x357e71,_0x27fe6b[_0x4e6f3c(0xac4)]),_0x663181=_0x227896(_0x357e71,_0x27fe6b[_0x4e6f3c(0xc8a)]||_0x357e71['name']);if(_0x305925){if(_0x27fe6b['isRefund'])_0x571fe2=_0x4e6f3c(0xc11)+_0x663181,_0x56e0ea='已拒收对方转账';else{_0x571fe2='转账给\x20'+_0x663181;if(_0x27fe6b[_0x4e6f3c(0xebd)]===_0x4e6f3c(0xa36))_0x56e0ea=_0x4e6f3c(0x12fb);else{if(_0x27fe6b[_0x4e6f3c(0xebd)]===_0x4e6f3c(0x859))_0x56e0ea=_0x4e6f3c(0x1234);else _0x56e0ea=_0x27fe6b[_0x4e6f3c(0x490)]||_0x4e6f3c(0x665);}}}else{if(_0x27fe6b[_0x4e6f3c(0x229)])_0x571fe2=_0x4e6f3c(0x11ac)+_0x9c7b80,_0x56e0ea='转账已被拒收';else{if(_0x27fe6b['receiverName']===_0x5d8db3){_0x571fe2=_0x4e6f3c(0x65a)+_0x5d8db3;if(_0x27fe6b[_0x4e6f3c(0xebd)]===_0x4e6f3c(0xa36))_0x56e0ea=_0x4e6f3c(0x6b2);else{if(_0x27fe6b[_0x4e6f3c(0xebd)]===_0x4e6f3c(0x859))_0x56e0ea=_0x4e6f3c(0xcb7);else _0x3f1f21[_0x4e6f3c(0x5e1)][_0x4e6f3c(0x8e4)]=_0x4e6f3c(0xec1),_0x3f1f21['dataset']['status']='pending',_0x56e0ea=_0x27fe6b[_0x4e6f3c(0x490)]||'点击处理';}}else _0x571fe2=_0x4e6f3c(0x81b)+_0x9c7b80+'\x20→\x20'+_0x663181,_0x56e0ea=_0x27fe6b[_0x4e6f3c(0x490)]||_0x4e6f3c(0x948);}}const _0x56bb24=_0x4e6f3c(0x38d);_0x349ec6=_0x4e6f3c(0x138d)+_0x56bb24+'\x20'+_0x571fe2+_0x4e6f3c(0xc20)+Number(_0x27fe6b[_0x4e6f3c(0x212)])[_0x4e6f3c(0x752)](0x2)+_0x4e6f3c(0x372)+_0x56e0ea+_0x4e6f3c(0x272);}else{if(_0x27fe6b[_0x4e6f3c(0x12d9)]==='waimai_request'){_0x3f1f21['classList'][_0x4e6f3c(0x68e)](_0x4e6f3c(0xee5),_0x4e6f3c(0x7c8));if(_0x27fe6b[_0x4e6f3c(0xebd)]===_0x4e6f3c(0x11b1)||_0x27fe6b[_0x4e6f3c(0xebd)]===_0x4e6f3c(0x954))_0x3f1f21[_0x4e6f3c(0x575)][_0x4e6f3c(0x68e)](_0x4e6f3c(0x1163)+_0x27fe6b['status']);const _0x4cd431=_0x227896(_0x357e71,_0x27fe6b[_0x4e6f3c(0xac4)]),_0x4d5fb1=_0x4e6f3c(0xaee)+_0x4cd431+_0x4e6f3c(0xf7a);let _0x592efc='';_0x27fe6b[_0x4e6f3c(0xebd)]===_0x4e6f3c(0xcf8)&&!_0x305925&&(_0x592efc='<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>'),_0x349ec6=_0x4e6f3c(0x9e5)+_0x4d5fb1+_0x4e6f3c(0xf30)+Number(_0x27fe6b[_0x4e6f3c(0x212)])[_0x4e6f3c(0x752)](0x2)+_0x4e6f3c(0xa50)+_0x27fe6b[_0x4e6f3c(0x6b5)]+'\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>'+_0x592efc+_0x4e6f3c(0x103c),setTimeout(()=>{const _0x1659db=_0x4e6f3c;if(_0x27fe6b[_0x1659db(0xebd)]==='pending'){const _0x2e3274=document['getElementById'](_0x1659db(0x1eb)+_0x27fe6b[_0x1659db(0x6b5)]);if(_0x2e3274){const _0x42208f=_0x58b12b(_0x2e3274,_0x27fe6b[_0x1659db(0xaf5)]);_0xdea4f7[_0x27fe6b[_0x1659db(0x6b5)]]=_0x42208f;}}},0x0);}else{if(_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x1af)){_0x3f1f21[_0x4e6f3c(0x575)][_0x4e6f3c(0x68e)](_0x4e6f3c(0xee5),'is-card-like');const _0x40c6c0=_0x227896(_0x357e71,_0x27fe6b[_0x4e6f3c(0xac4)]);let _0x453e0a='你';_0x357e71[_0x4e6f3c(0x11e4)]&&(_0x453e0a=_0x227896(_0x357e71,_0x27fe6b[_0x4e6f3c(0x9d0)])),_0x349ec6=_0x4e6f3c(0x352)+_0x40c6c0+_0x4e6f3c(0xc1e)+_0x453e0a+'下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>'+_0x27fe6b[_0x4e6f3c(0xde1)]+_0x4e6f3c(0x27a)+Number(_0x27fe6b[_0x4e6f3c(0x212)])[_0x4e6f3c(0x752)](0x2)+_0x4e6f3c(0x3d6);}else{if(_0x27fe6b[_0x4e6f3c(0x12d9)]==='red_packet'){_0x3f1f21[_0x4e6f3c(0x575)][_0x4e6f3c(0x68e)]('is-red-packet','is-card-like');const _0x593400=_0x9ebf46[_0x4e6f3c(0x32c)]['nickname']||'{{user}}',_0x5954ff=_0x27fe6b[_0x4e6f3c(0x11b0)],_0x647b90=_0x27fe6b[_0x4e6f3c(0x1118)]&&_0x27fe6b['claimedBy'][_0x593400];let _0xe38f13='',_0x56888a='',_0x28242d=_0x4e6f3c(0x763);_0x5954ff&&(_0xe38f13='opened');if(_0x27fe6b[_0x4e6f3c(0x30a)]===_0x4e6f3c(0x7b4)){const _0x3ff84b=_0x227896(_0x357e71,_0x27fe6b[_0x4e6f3c(0xc8a)]);_0x28242d=_0x4e6f3c(0x10f4)+_0x3ff84b;if(Object[_0x4e6f3c(0x2bd)](_0x27fe6b[_0x4e6f3c(0x1118)]||{})[_0x4e6f3c(0xa06)]>0x0)_0xe38f13=_0x4e6f3c(0x649);}if(_0x647b90){const _0x35af34=_0x27fe6b[_0x4e6f3c(0x1118)][_0x593400]||0x0;_0x56888a=_0x4e6f3c(0x68f)+_0x35af34[_0x4e6f3c(0x752)](0x2)+_0x4e6f3c(0x114c);}else{if(_0x5954ff)_0x56888a=_0x4e6f3c(0xaba);else{if(_0x27fe6b['packetType']===_0x4e6f3c(0x7b4)&&Object['keys'](_0x27fe6b[_0x4e6f3c(0x1118)]||{})[_0x4e6f3c(0xa06)]>0x0){const _0x4a6971=_0x227896(_0x357e71,_0x27fe6b[_0x4e6f3c(0xc8a)]);_0x56888a=_0x4e6f3c(0x1244)+_0x4a6971+_0x4e6f3c(0xb56);}}}_0x349ec6='<div\x20class=\x22red-packet-card\x20'+_0xe38f13+_0x4e6f3c(0xa04)+(_0x27fe6b[_0x4e6f3c(0xb0c)]||_0x4e6f3c(0xb65))+'</span></div><div\x20class=\x22rp-type\x22>'+_0x28242d+_0x4e6f3c(0x103c)+_0x56888a+_0x4e6f3c(0x103c);}else{if(_0x27fe6b[_0x4e6f3c(0x12d9)]==='poll'){_0x3f1f21[_0x4e6f3c(0x575)]['add'](_0x4e6f3c(0xf86),_0x4e6f3c(0x7c8));const _0x115ea3=_0x27fe6b[_0x4e6f3c(0x12f6)]||_0x27fe6b[_0x4e6f3c(0x53b)]||_0x4e6f3c(0x1317);let _0xfdb5d=0x0;const _0x1ce14a={};for(const _0x408477 in _0x27fe6b['votes']){const _0x1c6cbf=_0x27fe6b[_0x4e6f3c(0xe19)][_0x408477][_0x4e6f3c(0xa06)];_0x1ce14a[_0x408477]=_0x1c6cbf,_0xfdb5d+=_0x1c6cbf;}const _0x300046=_0x9ebf46['qzoneSettings'][_0x4e6f3c(0x5b7)]||_0x4e6f3c(0x5c1);let _0x13fd6e=null;for(const _0x3391a9 in _0x27fe6b[_0x4e6f3c(0xe19)]){if(_0x27fe6b['votes'][_0x3391a9][_0x4e6f3c(0x930)](_0x300046)){_0x13fd6e=_0x3391a9;break;}}let _0x48c6c0=_0x4e6f3c(0x2bc);_0x27fe6b[_0x4e6f3c(0x5ed)][_0x4e6f3c(0x591)](_0x550aa7=>{const _0x1fbf6a=_0x4e6f3c,_0x14e3e0=_0x1ce14a[_0x550aa7]||0x0,_0x4c6361=_0xfdb5d>0x0?_0x14e3e0/_0xfdb5d*0x64:0x0,_0x59a7ed=_0x13fd6e===_0x550aa7;_0x48c6c0+=_0x1fbf6a(0x1010)+(_0x59a7ed?_0x1fbf6a(0xf15):'')+_0x1fbf6a(0x7ea)+_0x550aa7+_0x1fbf6a(0xfda)+_0x4c6361+'%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>'+_0x550aa7+_0x1fbf6a(0x692)+_0x14e3e0+'\x20票</span></div></div>';}),_0x48c6c0+=_0x4e6f3c(0x103c);let _0x1b9e49=_0x27fe6b[_0x4e6f3c(0x12b8)]?_0x4e6f3c(0xebc)+_0xfdb5d+'\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>':'<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20'+_0xfdb5d+_0x4e6f3c(0x54e);_0x349ec6=_0x4e6f3c(0x404)+(_0x27fe6b['isClosed']?_0x4e6f3c(0x10c3):'')+_0x4e6f3c(0xffa)+_0x27fe6b[_0x4e6f3c(0x6b5)]+_0x4e6f3c(0xf59)+_0x115ea3+_0x4e6f3c(0x103c)+_0x48c6c0+_0x1b9e49+'</div>';}else{if(_0x27fe6b[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x96e)){_0x3f1f21['classList']['add'](_0x4e6f3c(0xf4e),_0x4e6f3c(0x7c8));let _0xaf559e;const _0x559087=_0x357e71['settings'][_0x4e6f3c(0x29c)]||'我';if(_0x357e71[_0x4e6f3c(0x11e4)]){if(_0x27fe6b[_0x4e6f3c(0xda3)]&&_0x27fe6b[_0x4e6f3c(0xda3)]['length']>0x0){const _0x527775=_0x27fe6b[_0x4e6f3c(0xda3)]['map'](_0x792faa=>_0x227896(_0x357e71,_0x792faa));_0x527775[_0x4e6f3c(0xa06)]===0x1?_0xaf559e=_0x4e6f3c(0x192)+_0x527775[0x0]+_0x4e6f3c(0x1319):_0xaf559e=_0x4e6f3c(0x192)+_0x527775[_0x4e6f3c(0x1044)](0x0,0x2)['join']('、')+_0x4e6f3c(0xbcc);}else _0xaf559e=_0x4e6f3c(0x1198);}else{if(_0x305925)_0xaf559e=_0x4e6f3c(0x192)+_0x357e71[_0x4e6f3c(0x609)]+_0x4e6f3c(0x1319);else{const _0x2ab02c=_0x357e71[_0x4e6f3c(0x1131)][_0x4e6f3c(0x29c)]||'你';_0xaf559e=_0x4e6f3c(0x192)+_0x2ab02c+_0x4e6f3c(0x1319);}}const _0x27a243=_0x27fe6b[_0x4e6f3c(0x62e)][_0x4e6f3c(0x1044)](0x0,0x3);let _0x25ae62='';_0x27a243[_0x4e6f3c(0x591)](_0x415eaf=>{const _0xa672b6=_0x4e6f3c;_0x25ae62+=_0xa672b6(0x865)+_0x415eaf[_0xa672b6(0xd5e)]+_0xa672b6(0xc87)+_0x415eaf['name']+'</span><span\x20class=\x22gift-preview-quantity\x22>x'+_0x415eaf[_0xa672b6(0xe58)]+_0xa672b6(0xf4a);});let _0x2bf977='';_0x27fe6b[_0x4e6f3c(0x62e)]['length']>0x3&&(_0x2bf977='\x20等'+_0x27fe6b[_0x4e6f3c(0x62e)]['length']+_0x4e6f3c(0x49a)),_0x349ec6=_0x4e6f3c(0x73b)+_0xaf559e+'</span></div><div\x20class=\x22gift-items-preview\x22>'+_0x25ae62+_0x4e6f3c(0x89c)+_0x27fe6b[_0x4e6f3c(0x62e)][_0x4e6f3c(0xa06)]+_0x4e6f3c(0x49a)+_0x2bf977+_0x4e6f3c(0xde9);}}}}}}}}}}}}}}else{const _0x38d58d=String(_0xd9620f);let _0x3f94cb=await _0x457ef2(_0x38d58d,_0x357e71['id']);if(_0x3f94cb!==_0x38d58d)_0x349ec6=_0x3f94cb,_0x3f1f21[_0x4e6f3c(0x575)][_0x4e6f3c(0x68e)]('is-card-like');else{if(Array['isArray'](_0x27fe6b[_0x4e6f3c(0x53b)])&&_0x27fe6b['content'][0x0]?.[_0x4e6f3c(0x12d9)]===_0x4e6f3c(0x96f)){const _0x639460=_0x27fe6b['content'][0x0][_0x4e6f3c(0x96f)][_0x4e6f3c(0x11be)];_0x349ec6=_0x4e6f3c(0x12ac)+_0x639460+_0x4e6f3c(0xd37);}else{if(_0x2d389f[_0x4e6f3c(0x4e8)](_0x3f94cb))_0x3f1f21[_0x4e6f3c(0x575)][_0x4e6f3c(0x68e)]('is-sticker','is-card-like'),_0x349ec6=_0x4e6f3c(0x12ac)+_0x3f94cb+_0x4e6f3c(0xdf4)+(_0x27fe6b[_0x4e6f3c(0x1b3)]||_0x4e6f3c(0x47d))+'\x22\x20class=\x22sticker-image\x22>';else{let _0x4f4d88=_0x742a79(_0x3f94cb,_0x357e71);_0x349ec6=_0x1ffeeb(_0x4f4d88)[_0x4e6f3c(0x459)](/\n/g,_0x4e6f3c(0x10d9));}}}}}_0x3f1f21[_0x4e6f3c(0x2f5)]=_0x4e6f3c(0x9d9)+_0x2c6d49+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3c2b26+_0x4e6f3c(0x983)+_0x349ec6+_0x4e6f3c(0x138a),_0x1ed029['appendChild'](_0x3f1f21),_0x1ed029[_0x4e6f3c(0x7b9)](_0x3b967f),_0x43a60a(_0x1ed029,()=>_0x37ae78(_0x27fe6b[_0x4e6f3c(0x6b5)])),_0x1ed029['addEventListener']('click',()=>{if(_0x38ba45)_0x1c3bf3(_0x27fe6b['timestamp']);});if(!_0x305925){const _0x4982f2=_0x1ed029[_0x4e6f3c(0x91d)](_0x4e6f3c(0xa21));_0x4982f2&&(_0x4982f2['style'][_0x4e6f3c(0x8e4)]=_0x4e6f3c(0xec1),!_0x357e71[_0x4e6f3c(0x11e4)]?_0x4982f2[_0x4e6f3c(0xa0f)](_0x4e6f3c(0xf5c),_0x574ea0=>{_0x574ea0['stopPropagation'](),_0x257d91(_0x357e71['id']);}):_0x4982f2[_0x4e6f3c(0xa0f)](_0x4e6f3c(0x1002),_0x20f5c3=>{const _0x141ba7=_0x4e6f3c;_0x20f5c3[_0x141ba7(0x20a)](),_0x969182(_0x357e71['id'],_0x27fe6b[_0x141ba7(0xac4)]);}));}return _0x1ed029;}async function _0x3e9e57(_0x160cc7,_0x2956c2){const _0x2a35df=_0x419fa8,_0x3337a7=document[_0x2a35df(0x9c8)](_0x2a35df(0xbff)),_0x2a2727=await _0x8ae2cf(_0x160cc7,_0x2956c2);if(!_0x2a2727)return;const _0x139573=document[_0x2a35df(0x9c8)](_0x2a35df(0x121c));_0x139573?_0x3337a7[_0x2a35df(0x70f)](_0x2a2727,_0x139573[_0x2a35df(0x2ce)]):_0x3337a7[_0x2a35df(0x2a8)](_0x2a2727);}async function _0xc4e879(_0x49791d,_0x21ac52,_0x44dc43=![]){const _0x425905=_0x419fa8,_0x186d7b=document[_0x425905(0x9c8)](_0x425905(0xbff)),_0xeed739=document[_0x425905(0x9c8)](_0x425905(0xb53)),_0x2c432a=_0x21ac52[_0x425905(0x8b3)][_0x425905(0x401)](_0x2fa670=>!_0x2fa670[_0x425905(0xc62)])['pop']();if(_0x2c432a&&_0x49791d[_0x425905(0x6b5)]-_0x2c432a[_0x425905(0x6b5)]>0x927c0){const _0x581e54=_0x4b8eaa(_0x49791d[_0x425905(0x6b5)]);_0x186d7b['insertBefore'](_0x581e54,_0xeed739);}const _0x1ac80b=await _0x8ae2cf(_0x49791d,_0x21ac52);if(!_0x1ac80b)return;_0x49791d[_0x425905(0x7fd)]===_0x425905(0x1a7)&&!_0x44dc43&&_0xf6d7e9(),!_0x44dc43&&_0x1ac80b[_0x425905(0x575)][_0x425905(0x68e)]('animate-in'),_0x186d7b[_0x425905(0x70f)](_0x1ac80b,_0xeed739),!_0x44dc43&&(_0x186d7b[_0x425905(0x783)]=_0x186d7b[_0x425905(0x1e4)],_0x2200fe++);}async function _0x49f56e(_0xb02a13){const _0x57688e=_0x419fa8;_0x9ebf46[_0x57688e(0x970)]=_0xb02a13;const _0x497c1c=_0x9ebf46[_0x57688e(0x547)][_0xb02a13];if(!_0x497c1c)return;_0x497c1c[_0x57688e(0x382)]>0x0&&(_0x497c1c[_0x57688e(0x382)]=0x0,await _0x2c5bcf[_0x57688e(0x547)][_0x57688e(0xff5)](_0x497c1c));_0x3eb3d2(_0x497c1c),_0x1a44b1(_0xb02a13),_0xe5834e(_0x57688e(0x504)),window['updateListenTogetherIconProxy'](_0x9ebf46[_0x57688e(0x970)]);const _0xae89c=_0x497c1c[_0x57688e(0x11e4)]||![];_0x6554ae(_0xae89c),document[_0x57688e(0x9c8)]('show-announcement-board-btn')[_0x57688e(0x5e1)]['display']=_0xae89c?_0x57688e(0x989):_0x57688e(0x8f6);const _0x8cb5d2=document[_0x57688e(0x9c8)](_0x57688e(0xe0a));_0x8cb5d2&&(_0x8cb5d2[_0x57688e(0x5e1)]['display']=_0xae89c?_0x57688e(0x8f6):_0x57688e(0x989));const _0x543425=document[_0x57688e(0x9c8)](_0x57688e(0xb6c)),_0x44d285=document[_0x57688e(0x9c8)](_0x57688e(0x72e)),_0x37622a=document[_0x57688e(0x9c8)](_0x57688e(0xe9c)),_0x13282a=document[_0x57688e(0x9c8)](_0x57688e(0x7f6));_0x44d285&&_0x37622a&&_0x13282a&&_0x543425&&(_0x44d285[_0x57688e(0x5e1)][_0x57688e(0x3c5)]=_0x57688e(0x989),_0x37622a[_0x57688e(0x5e1)][_0x57688e(0x3c5)]=_0xae89c?'none':_0x57688e(0x989),_0x13282a[_0x57688e(0x5e1)][_0x57688e(0x3c5)]=_0xae89c?_0x57688e(0x989):'none',_0x543425[_0x57688e(0x5e1)][_0x57688e(0x3c5)]=_0xae89c?_0x57688e(0x8f6):_0x57688e(0x989)),_0x159e72(),!_0x497c1c[_0x57688e(0x11e4)]&&_0x497c1c[_0x57688e(0x36f)]?.['status']===_0x57688e(0x26d)&&(console[_0x57688e(0x283)](_0x57688e(0xed2)+_0x497c1c['name']+'\x22\x20自动触发AI响应...'),_0x4128b4()),document[_0x57688e(0x9c8)](_0x57688e(0xde4))[_0x57688e(0x5e1)][_0x57688e(0x3c5)]=_0xae89c?_0x57688e(0x989):_0x57688e(0x8f6);}function _0x39290a(_0x307b73,_0x2ed049){const _0x862e1=_0x419fa8,_0x31462d=_0x2ed049?_0x862e1(0x68e):_0x862e1(0x30f),_0x4f9e36=_0x2d1271=>{const _0x5b3010=_0x862e1;_0x2d1271&&_0x2d1271[_0x5b3010(0x575)][_0x31462d](_0x5b3010(0x61d));},_0x410843=document[_0x862e1(0x91d)](_0x862e1(0xd6b)+_0x307b73+_0x862e1(0xbf8));_0x4f9e36(_0x410843);const _0x21ee26=document[_0x862e1(0x7e4)](_0x862e1(0xd35)+_0x307b73+'\x22]');_0x21ee26[_0x862e1(0x591)](_0x4f9e36);const _0x119317=document['querySelector'](_0x862e1(0x565)+_0x307b73+'\x22]');_0x4f9e36(_0x119317);}async function _0x13a3b1(){const _0x43e599=_0x419fa8;if(!_0x9ebf46[_0x43e599(0x970)])return;const _0x234865=_0x9ebf46['activeChatId'],_0x422c8d=_0x9ebf46[_0x43e599(0x547)][_0x234865];lastRawAiResponse='',lastResponseTimestamps=[];const _0x240cc0=document[_0x43e599(0x9c8)](_0x43e599(0x6c9));_0x240cc0&&(_0x240cc0[_0x43e599(0x823)]=!![],_0x240cc0[_0x43e599(0xe24)]=_0x43e599(0x136a));_0x39290a(_0x234865,!![]);try{const {proxyUrl:_0x32666e,apiKey:_0xe0223e,model:_0x206c7a}=_0x9ebf46[_0x43e599(0x4de)];if(!_0x32666e||!_0xe0223e||!_0x206c7a)throw new Error(_0x43e599(0xf82));const _0x43ca57=parseInt(_0x422c8d[_0x43e599(0x1131)][_0x43e599(0x132a)])||0xa,_0x508d4a=_0x422c8d['history'][_0x43e599(0x1044)](-_0x43ca57);let _0x283e19='';if(_0x422c8d[_0x43e599(0x1131)][_0x43e599(0x41a)]&&_0x422c8d[_0x43e599(0x1131)][_0x43e599(0x41a)][_0x43e599(0xa06)]>0x0){const _0x517c05=_0x422c8d[_0x43e599(0x1131)][_0x43e599(0x41a)]['map'](_0x207461=>{const _0x1551a6=_0x43e599,_0xbeba15=_0x9ebf46[_0x1551a6(0x1369)][_0x1551a6(0xfc3)](_0x3a546b=>_0x3a546b['id']===_0x207461);if(!_0xbeba15||!Array[_0x1551a6(0xb27)](_0xbeba15[_0x1551a6(0x53b)]))return'';const _0x39d791=_0xbeba15[_0x1551a6(0x53b)]['filter'](_0x3468bc=>_0x3468bc[_0x1551a6(0x38a)]!==![])[_0x1551a6(0xa3b)](_0x5718d3=>{const _0x27423a=_0x1551a6;let _0x5863df=_0x27423a(0x1085)+(_0x5718d3['comment']||'无备注')+'\x0a';if(_0x5718d3['keys'][_0x27423a(0xa06)]>0x0)_0x5863df+=_0x27423a(0x9fc)+_0x5718d3[_0x27423a(0x2bd)][_0x27423a(0x809)](',\x20')+'\x0a';return _0x5863df+=_0x27423a(0x246)+_0x5718d3[_0x27423a(0x53b)],_0x5863df;})[_0x1551a6(0x809)]('');return _0x39d791?_0x1551a6(0xbac)+_0xbeba15[_0x1551a6(0x609)]+'\x0a'+_0x39d791:'';})[_0x43e599(0x401)](Boolean)['join']('');_0x517c05&&(_0x283e19='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x517c05+_0x43e599(0x98a));}let _0x1193a8=_0x43e599(0x5f7),_0x700759=![];_0x422c8d[_0x43e599(0xd3e)][_0x43e599(0x591)](_0x4da74b=>{const _0x22ca2f=_0x43e599,_0x392aca=_0x9ebf46[_0x22ca2f(0x547)][_0x4da74b['id']];_0x392aca&&_0x392aca[_0x22ca2f(0x323)]&&_0x392aca[_0x22ca2f(0x323)][_0x22ca2f(0xa06)]>0x0&&(_0x1193a8+='\x0a##\x20---\x20关于“'+_0x4da74b[_0x22ca2f(0x1132)]+_0x22ca2f(0x5fa),_0x1193a8+=_0x392aca[_0x22ca2f(0x323)][_0x22ca2f(0xa3b)](_0x5cc929=>_0x22ca2f(0x1dc)+_0x4fcd92(_0x5cc929[_0x22ca2f(0x6b5)])+')\x20'+_0x5cc929[_0x22ca2f(0x53b)])[_0x22ca2f(0x809)]('\x0a'),_0x700759=!![]);});!_0x700759&&(_0x1193a8+=_0x43e599(0x1264));let _0x32a8bd='';const _0x4479f5=_0x422c8d[_0x43e599(0x1131)][_0x43e599(0xf9f)]||0xa;if(_0x422c8d[_0x43e599(0x1131)][_0x43e599(0xfeb)]&&_0x422c8d[_0x43e599(0x1131)][_0x43e599(0xfeb)]['length']>0x0){}const _0x11dcf5=_0x422c8d['members'][_0x43e599(0xa3b)](_0x5236b9=>_0x43e599(0x388)+_0x5236b9['groupNickname']+'**\x20(本名:\x20'+_0x5236b9[_0x43e599(0x1071)]+'):\x20'+_0x5236b9[_0x43e599(0xeb1)])[_0x43e599(0x809)]('\x0a'),_0x5b53b4=_0xe373a(_0x422c8d),_0x425ed7=_0x43e599(0x13c1)+_0x422c8d[_0x43e599(0x609)]+_0x43e599(0x328)+_0x422c8d[_0x43e599(0x609)]+_0x43e599(0x670)+_0x1193a8+'\x0a'+_0x283e19+'\x0a'+_0x32a8bd+_0x43e599(0x51e)+_0x508d4a[_0x43e599(0xa3b)](_0x493e60=>_0x227896(_0x422c8d,_0x493e60[_0x43e599(0xac4)])+':\x20'+_0x493e60[_0x43e599(0x53b)])[_0x43e599(0x809)]('\x0a')+'\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a'+_0x11dcf5+_0x43e599(0x5f1)+_0x5b53b4+'\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a',_0x3fb433=_0x508d4a[_0x43e599(0xa3b)](_0x2308a9=>({'role':_0x43e599(0x586),'content':_0x227896(_0x422c8d,_0x2308a9['senderName'])+':\x20'+_0x2308a9[_0x43e599(0x53b)]}));let _0x726782=_0x32666e[_0x43e599(0x930)](_0x43e599(0x1145)),_0x2f99da;if(_0x726782){let _0x174ee4=_0x2e5c04(_0x206c7a,_0xe0223e,_0x425ed7,_0x3fb433);_0x2f99da=await fetch(_0x174ee4['url'],_0x174ee4[_0x43e599(0x100d)]);}else _0x2f99da=await fetch(_0x32666e+_0x43e599(0x1090),{'method':_0x43e599(0x116f),'headers':{'Content-Type':_0x43e599(0x698),'Authorization':_0x43e599(0x84a)+_0xe0223e},'body':JSON[_0x43e599(0xf1e)]({'model':_0x206c7a,'messages':[{'role':_0x43e599(0xb64),'content':_0x425ed7},..._0x3fb433],'temperature':_0x9ebf46[_0x43e599(0x1383)][_0x43e599(0xc3d)]||0.9})});if(!_0x2f99da['ok']){const _0x4718d4=await _0x2f99da[_0x43e599(0x5dd)]()[_0x43e599(0xd7f)](()=>({'error':{'message':_0x2f99da[_0x43e599(0x399)]}}));throw new Error(_0x43e599(0xe1a)+_0x2f99da['status']+_0x43e599(0x23e)+(_0x4718d4[_0x43e599(0x1221)]?.[_0x43e599(0x86e)]||_0x43e599(0xfc8)));}const _0x55d51d=await _0x2f99da[_0x43e599(0x5dd)](),_0x9067f7=getGeminiResponseText(_0x55d51d);lastRawAiResponse=_0x9067f7;const _0x5dd0fc=_0x169d92(_0x9067f7);let _0x55dd12=Date['now']();for(const _0x5eb8fb of _0x5dd0fc){if(!_0x5eb8fb||!_0x5eb8fb[_0x43e599(0x12d9)]||!_0x5eb8fb['name'])continue;let _0x2daa3d=null;const _0x581e99=_0x55dd12++;lastResponseTimestamps[_0x43e599(0x668)](_0x581e99);const _0x45b455={'role':_0x43e599(0x1a7),'senderName':_0x5eb8fb[_0x43e599(0x609)],'timestamp':_0x581e99};switch(_0x5eb8fb[_0x43e599(0x12d9)]){case _0x43e599(0xbb7):_0x2daa3d={..._0x45b455,'content':_0x5eb8fb[_0x43e599(0x53b)]};break;case _0x43e599(0x83e):if(_0x5eb8fb[_0x43e599(0x1b3)]){const _0x6f9fc1=_0x9ebf46['userStickers'][_0x43e599(0xfc3)](_0x397f5a=>_0x397f5a[_0x43e599(0x609)]===_0x5eb8fb[_0x43e599(0x1b3)]);_0x6f9fc1?_0x2daa3d={..._0x45b455,'type':_0x43e599(0x83e),'content':_0x6f9fc1[_0x43e599(0x11be)],'meaning':_0x6f9fc1[_0x43e599(0x609)]}:(console['warn'](_0x43e599(0xe84)+_0x5eb8fb[_0x43e599(0x1b3)]+'\x22'),_0x2daa3d={..._0x45b455,'type':'text','content':_0x43e599(0xef0)+_0x5eb8fb['meaning']+']'});}else console[_0x43e599(0x453)]('旁观模式AI发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。',_0x5eb8fb);break;case _0x43e599(0x835):_0x2daa3d={..._0x45b455,'type':_0x43e599(0x835),'content':_0x5eb8fb[_0x43e599(0x1387)],'image_prompt':_0x5eb8fb['image_prompt']};break;case'voice_message':_0x2daa3d={..._0x45b455,'type':_0x43e599(0x10c1),'content':_0x5eb8fb[_0x43e599(0x53b)]};break;case _0x43e599(0xb43):const _0x31028f=_0x422c8d['history']['find'](_0x864884=>_0x864884['timestamp']===_0x5eb8fb['target_timestamp']);_0x31028f?_0x2daa3d={..._0x45b455,'content':_0x5eb8fb['reply_content'],'quote':{'timestamp':_0x31028f[_0x43e599(0x6b5)],'senderName':_0x31028f[_0x43e599(0xac4)],'content':String(_0x31028f['content']||'')[_0x43e599(0xc34)](0x0,0x32)}}:_0x2daa3d={..._0x45b455,'content':_0x5eb8fb['reply_content']};break;default:console[_0x43e599(0x453)](_0x43e599(0x919),_0x5eb8fb[_0x43e599(0x12d9)]);continue;}_0x2daa3d&&(_0x422c8d[_0x43e599(0x8b3)]['push'](_0x2daa3d),_0xc4e879(_0x2daa3d,_0x422c8d),await new Promise(_0x1e6ed9=>setTimeout(_0x1e6ed9,Math[_0x43e599(0x360)]()*0x4b0+0x320)));}await _0x2c5bcf[_0x43e599(0x547)][_0x43e599(0xff5)](_0x422c8d),_0x394b2c();}catch(_0x58d4d7){console[_0x43e599(0x1221)](_0x43e599(0x10d5),_0x58d4d7),await _0x1bff53(_0x43e599(0x24d),_0x43e599(0x1191)+_0x58d4d7['message']);}finally{_0x240cc0&&(_0x240cc0[_0x43e599(0x823)]=![],_0x240cc0[_0x43e599(0xe24)]=_0x43e599(0x1378)),_0x39290a(_0x234865,![]);}}async function _0x4128b4(){const _0x598b16=_0x419fa8;if(!_0x9ebf46[_0x598b16(0x970)])return;const _0x14346e=_0x9ebf46['activeChatId'],_0x1e2f12=_0x9ebf46['chats'][_0x9ebf46[_0x598b16(0x970)]],_0x1924c9=document[_0x598b16(0x9c8)](_0x598b16(0x504))[_0x598b16(0x575)]['contains']('active')&&_0x9ebf46[_0x598b16(0x970)]===_0x14346e;_0x39290a(_0x14346e,!![]);const _0x4020d5=document[_0x598b16(0x9c8)]('chat-header-title'),_0x426947=document['getElementById'](_0x598b16(0xb53)),_0x552dc9=document[_0x598b16(0x91d)](_0x598b16(0xd6b)+_0x14346e+'\x22]'),_0x5ef767=_0x552dc9?_0x552dc9[_0x598b16(0x91d)]('.avatar'):null;_0x5ef767&&_0x5ef767[_0x598b16(0x575)][_0x598b16(0x68e)](_0x598b16(0x61d));_0x1e2f12[_0x598b16(0x11e4)]?_0x426947&&(_0x426947['textContent']=_0x598b16(0x1000),_0x426947[_0x598b16(0x5e1)][_0x598b16(0x3c5)]=_0x598b16(0x3d9)):_0x4020d5&&(_0x4020d5[_0x598b16(0x5e1)][_0x598b16(0xb17)]=0x0,setTimeout(()=>{const _0x53f6f7=_0x598b16;_0x4020d5[_0x53f6f7(0xe24)]='对方正在输入...',_0x4020d5[_0x53f6f7(0x575)][_0x53f6f7(0x68e)](_0x53f6f7(0x100e)),_0x4020d5[_0x53f6f7(0x5e1)]['opacity']=0x1;},0xc8));let _0x514e4e=![];try{const {proxyUrl:_0x5af674,apiKey:_0x5bbfde,model:_0x17cff9}=_0x9ebf46[_0x598b16(0x4de)];if(!_0x5af674||!_0x5bbfde||!_0x17cff9){alert('请先在API设置中配置反代地址、密钥并选择模型。');if(_0x1e2f12[_0x598b16(0x11e4)]){if(_0x426947)_0x426947[_0x598b16(0x5e1)][_0x598b16(0x3c5)]=_0x598b16(0x8f6);}else _0x4020d5&&_0x9ebf46[_0x598b16(0x547)][_0x14346e]&&(_0x4020d5[_0x598b16(0xe24)]=_0x9ebf46[_0x598b16(0x547)][_0x14346e][_0x598b16(0x609)],_0x4020d5[_0x598b16(0x575)]['remove'](_0x598b16(0x100e)));return;}const _0x338df1=_0x1e2f12[_0x598b16(0x8b3)]['slice'](-0x1)[0x0],_0x5d693f=_0x338df1&&_0x338df1[_0x598b16(0x7fd)]===_0x598b16(0xb64)&&_0x338df1[_0x598b16(0x53b)][_0x598b16(0x930)](_0x598b16(0xd4b));if(_0x5d693f){console[_0x598b16(0x283)](_0x598b16(0xed6)+_0x1e2f12[_0x598b16(0x609)]+_0x598b16(0x37f));let _0x2145bd;_0x1e2f12[_0x598b16(0x11e4)]?_0x2145bd=_0x598b16(0x220)+_0x1e2f12['members'][_0x598b16(0xa3b)](_0x68564f=>'-\x20'+_0x68564f[_0x598b16(0x1132)]+_0x598b16(0xdcc)+_0x68564f[_0x598b16(0x1071)]+_0x598b16(0x301)+_0x68564f[_0x598b16(0xeb1)])[_0x598b16(0x809)]('\x0a')+_0x598b16(0x32f):_0x2145bd=_0x598b16(0x122f)+_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xae3)]+_0x598b16(0x4d1);const _0x4b35d1=[{'role':_0x598b16(0x586),'content':_0x2145bd}];try{let _0x3c7206=_0x2e5c04(_0x17cff9,_0x5bbfde,_0x2145bd,_0x4b35d1),_0x5e60ba=_0x5af674===GEMINI_API_URL;const _0x3e843e=_0x5e60ba?await fetch(_0x3c7206['url'],_0x3c7206[_0x598b16(0x100d)]):await fetch(_0x5af674+_0x598b16(0x1090),{'method':_0x598b16(0x116f),'headers':{'Content-Type':_0x598b16(0x698),'Authorization':_0x598b16(0x84a)+_0x5bbfde},'body':JSON[_0x598b16(0xf1e)]({'model':_0x17cff9,'messages':_0x4b35d1,'temperature':0.7})});if(!_0x3e843e['ok'])throw new Error('API失败:\x20'+(await _0x3e843e[_0x598b16(0x5dd)]())[_0x598b16(0x1221)][_0x598b16(0x86e)]);const _0x175e2c=await _0x3e843e['json'](),_0x2100e1=getGeminiResponseText(_0x175e2c),_0x44d506=_0x169d92(_0x2100e1);let _0xf7820b=![];for(const _0x59cc0e of _0x44d506){if(_0x59cc0e[_0x598b16(0x12d9)]===_0x598b16(0xcb8)){_0x3085d5[_0x598b16(0x683)]=![];if(_0x59cc0e[_0x598b16(0x91c)]===_0x598b16(0xf8b))_0x5ab059();else{const _0x49af98={'role':_0x598b16(0x1a7),'content':_0x598b16(0xaf0),'timestamp':Date[_0x598b16(0x9b7)]()};_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x668)](_0x49af98),await _0x2c5bcf['chats']['put'](_0x1e2f12),_0xe5834e(_0x598b16(0x504)),_0x1a44b1(_0x14346e);}_0xf7820b=!![];break;}if(_0x59cc0e['type']==='group_call_response'){if(_0x59cc0e[_0x598b16(0x91c)]===_0x598b16(0x809)){const _0x1941c2=_0x1e2f12[_0x598b16(0xd3e)][_0x598b16(0xfc3)](_0x591058=>_0x591058['originalName']===_0x59cc0e[_0x598b16(0x609)]);_0x1941c2&&!_0x3085d5[_0x598b16(0x1189)]['some'](_0x271e02=>_0x271e02['id']===_0x1941c2['id'])&&_0x3085d5[_0x598b16(0x1189)][_0x598b16(0x668)](_0x1941c2);}_0xf7820b=!![];}}_0xf7820b&&_0x3085d5[_0x598b16(0x106c)]&&(_0x3085d5[_0x598b16(0x683)]=![],_0x3085d5[_0x598b16(0x1189)][_0x598b16(0xa06)]>0x0?_0x5ab059():(_0x3085d5={..._0x3085d5,'isAwaitingResponse':![],'participants':[]},_0xe5834e(_0x598b16(0x504)),alert(_0x598b16(0x10e6))));}catch(_0x4da834){console[_0x598b16(0x1221)]('处理通话请求时API出错:',_0x4da834);const _0x3259ce=_0x1e2f12['isGroup']?_0x1e2f12[_0x598b16(0xd3e)][_0x598b16(0xa3b)](_0x58e0e4=>({'type':_0x598b16(0xe46),'name':_0x58e0e4[_0x598b16(0x1071)],'decision':_0x598b16(0xa0a)})):[{'type':_0x598b16(0xcb8),'decision':_0x598b16(0xeeb)}];if(_0x1e2f12[_0x598b16(0x11e4)])_0x3085d5[_0x598b16(0x683)]=![],_0x3085d5[_0x598b16(0x1189)]=[],alert(_0x598b16(0x10e6)),_0xe5834e(_0x598b16(0x504));else{const _0x2ff27a={'role':_0x598b16(0x1a7),'content':'对方拒绝了你的视频通话请求。','timestamp':Date[_0x598b16(0x9b7)]()};_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x668)](_0x2ff27a),await _0x2c5bcf['chats'][_0x598b16(0xff5)](_0x1e2f12),_0xe5834e(_0x598b16(0x504)),_0x1a44b1(_0x14346e);}}finally{_0x39290a(_0x14346e,![]);return;}}if(!_0x1e2f12[_0x598b16(0x11e4)]&&_0x1e2f12[_0x598b16(0x36f)]?.[_0x598b16(0xebd)]===_0x598b16(0x26d)){console[_0x598b16(0x283)](_0x598b16(0x651)+_0x1e2f12[_0x598b16(0x609)]+_0x598b16(0x9e1));const _0x24411c=_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x401)](_0x4e20f3=>!_0x4e20f3[_0x598b16(0xc62)])[_0x598b16(0x1044)](-0xa,-0x5)['map'](_0x371a70=>{const _0xea7bab=_0x598b16,_0x10a7a2=_0x371a70[_0xea7bab(0x7fd)]==='user'?'用户':_0x1e2f12[_0xea7bab(0x609)];return _0x10a7a2+':\x20'+String(_0x371a70['content'])['substring'](0x0,0x32)+_0xea7bab(0xf66);})[_0x598b16(0x809)]('\x0a'),_0xeead59='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“'+_0x1e2f12['name']+_0x598b16(0xee0)+_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xae3)]+_0x598b16(0x502)+_0x1e2f12[_0x598b16(0x36f)][_0x598b16(0x1271)]+_0x598b16(0x1185)+(_0x24411c||_0x598b16(0x131e))+_0x598b16(0xc8f);try{const _0x49b02a=[{'role':'system','content':_0xeead59},{'role':_0x598b16(0x586),'content':_0x598b16(0xaed)}];let _0x270d87=_0x5af674===GEMINI_API_URL,_0x29572a=_0x2e5c04(_0x17cff9,_0x5bbfde,_0xeead59,[{'role':'user','content':_0x598b16(0xaed)}]);const _0x4a24ae=_0x270d87?await fetch(_0x29572a[_0x598b16(0x11be)],_0x29572a['data']):await fetch(_0x5af674+_0x598b16(0x1090),{'method':_0x598b16(0x116f),'headers':{'Content-Type':_0x598b16(0x698),'Authorization':_0x598b16(0x84a)+_0x5bbfde},'body':JSON[_0x598b16(0xf1e)]({'model':_0x17cff9,'messages':_0x49b02a,'temperature':_0x9ebf46[_0x598b16(0x1383)]['apiTemperature']||0.8})});if(!_0x4a24ae['ok'])throw new Error(_0x598b16(0xb7c)+(await _0x4a24ae[_0x598b16(0x5dd)]())[_0x598b16(0x1221)]['message']);const _0x537bcf=await _0x4a24ae[_0x598b16(0x5dd)](),_0x55f7ba=getGeminiResponseText(_0x537bcf)['replace'](/^```json\s*/,'')[_0x598b16(0x459)](/```$/,'')[_0x598b16(0x3f1)](),_0x11f7e1=JSON['parse'](_0x55f7ba);if(_0x11f7e1[_0x598b16(0x91c)]===_0x598b16(0xf8b)){_0x1e2f12['relationship'][_0x598b16(0xebd)]=_0x598b16(0x733);const _0x36090d={'role':_0x598b16(0x1a7),'senderName':_0x1e2f12['name'],'content':_0x11f7e1['reason'],'timestamp':Date['now']()};_0x1e2f12[_0x598b16(0x8b3)]['push'](_0x36090d);}else{_0x1e2f12[_0x598b16(0x36f)]['status']=_0x598b16(0x23d);const _0x546356={'role':_0x598b16(0x1a7),'senderName':_0x1e2f12['name'],'content':_0x11f7e1[_0x598b16(0x616)],'timestamp':Date[_0x598b16(0x9b7)]()};_0x1e2f12['history'][_0x598b16(0x668)](_0x546356);}_0x1e2f12[_0x598b16(0x36f)]['applicationReason']='',await _0x2c5bcf[_0x598b16(0x547)][_0x598b16(0xff5)](_0x1e2f12),_0x1a44b1(_0x14346e),_0x394b2c();}catch(_0x2b8d88){_0x1e2f12[_0x598b16(0x36f)]['status']='blocked_by_ai',await _0x2c5bcf[_0x598b16(0x547)]['put'](_0x1e2f12),await _0x1bff53(_0x598b16(0xeb5),'AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20'+_0x2b8d88['message']),_0x1a44b1(_0x14346e);}return;}let _0x45c1b3='';const _0xe92b0c=new Date(),_0x4feedc=_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0x11ee)]||'Asia/Shanghai',_0x2c4b84=_0xe92b0c['toLocaleString'](_0x598b16(0x101b),{'timeZone':_0x4feedc,'dateStyle':_0x598b16(0x1088),'timeStyle':'short'}),_0x280798=new Date(_0xe92b0c[_0x598b16(0x135b)]('en-US',{'timeZone':_0x4feedc})),_0x9689f7=_0x526327(_0x280798);let _0x1ecfc5,_0x116b77;const _0x367ac8=_0x1e2f12[_0x598b16(0x8b3)]['filter'](_0x4a4b7a=>_0x4a4b7a[_0x598b16(0xc62)])[_0x598b16(0x3a0)]();if(_0x367ac8&&_0x367ac8[_0x598b16(0x53b)][_0x598b16(0x930)](_0x598b16(0x11bd))){const _0x49858f=await _0x2c5bcf['callRecords'][_0x598b16(0xe78)](_0x598b16(0x54d))[_0x598b16(0xda9)](_0x14346e)['last']();if(_0x49858f&&_0x49858f[_0x598b16(0xe15)]){console[_0x598b16(0x283)](_0x598b16(0xac3));const _0x23072c=_0x49858f['transcript']['map'](_0x4bc88d=>{const _0x21f4e4=_0x598b16,_0x4d2649=_0x4bc88d['role']===_0x21f4e4(0x586)?_0x1e2f12[_0x21f4e4(0x1131)][_0x21f4e4(0x29c)]||'我':_0x4bc88d[_0x21f4e4(0xac4)];return _0x4d2649+':\x20'+_0x4bc88d['content'];})[_0x598b16(0x809)]('\x0a');_0x45c1b3=_0x598b16(0xcac)+_0x23072c+_0x598b16(0xd00);}}const _0xa52343=_0x201fd8(_0x434409[_0x14346e]);let _0x26df17='';if(_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0x41a)]&&_0x1e2f12[_0x598b16(0x1131)]['linkedWorldBookIds'][_0x598b16(0xa06)]>0x0){const _0x1dd598=_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0x41a)][_0x598b16(0xa3b)](_0x79f817=>{const _0x8494db=_0x598b16,_0x452b5d=_0x9ebf46['worldBooks'][_0x8494db(0xfc3)](_0x15db5d=>_0x15db5d['id']===_0x79f817);if(!_0x452b5d||!Array['isArray'](_0x452b5d[_0x8494db(0x53b)]))return'';const _0x575c3b=_0x452b5d[_0x8494db(0x53b)][_0x8494db(0x401)](_0x5866e2=>_0x5866e2[_0x8494db(0x38a)]!==![])['map'](_0x1e7b6f=>{const _0x46604f=_0x8494db;let _0x3383c2=_0x46604f(0x1085)+(_0x1e7b6f['comment']||_0x46604f(0xf27))+'\x0a';return _0x1e7b6f[_0x46604f(0x2bd)][_0x46604f(0xa06)]>0x0&&(_0x3383c2+='**关键词:**\x20'+_0x1e7b6f['keys'][_0x46604f(0x809)](',\x20')+'\x0a'),_0x3383c2+=_0x46604f(0x246)+_0x1e7b6f[_0x46604f(0x53b)],_0x3383c2;})[_0x8494db(0x809)]('');return _0x575c3b?'\x0a\x0a##\x20世界书:\x20'+_0x452b5d[_0x8494db(0x609)]+'\x0a'+_0x575c3b:'';})['filter'](Boolean)[_0x598b16(0x809)]('');_0x1dd598&&(_0x26df17=_0x598b16(0xb13)+_0x1dd598+_0x598b16(0x98a));}let _0x4171ef='';if(_0x5062a9[_0x598b16(0x103f)]&&_0x5062a9[_0x598b16(0x970)]===_0x14346e){const _0x48cebb=_0x5062a9[_0x598b16(0xcc8)]>-0x1?_0x5062a9['playlist'][_0x5062a9[_0x598b16(0xcc8)]]:null,_0xf69617=_0x5062a9['playlist']['map'](_0x58fec1=>'\x22'+_0x58fec1['name']+'\x22')[_0x598b16(0x809)](',\x20');let _0x211efd='';if(_0x48cebb&&_0x5062a9[_0x598b16(0x109a)]&&_0x5062a9[_0x598b16(0x109a)]['length']>0x0&&_0x5062a9['currentLyricIndex']>-0x1){const _0x1d88fe=_0x5062a9[_0x598b16(0x109a)][_0x5062a9[_0x598b16(0x114b)]],_0x784c1c=_0x5062a9[_0x598b16(0x109a)][_0x598b16(0x1044)](_0x5062a9[_0x598b16(0x114b)]+0x1,_0x5062a9['currentLyricIndex']+0x3);_0x211efd+=_0x598b16(0xe50)+_0x1d88fe[_0x598b16(0xbb7)]+'\x22\x0a',_0x784c1c[_0x598b16(0xa06)]>0x0&&(_0x211efd+='-\x20**即将演唱**:\x20'+_0x784c1c[_0x598b16(0xa3b)](_0x4904d3=>'\x22'+_0x4904d3['text']+'\x22')[_0x598b16(0x809)](_0x598b16(0x69e))+'\x0a');}_0x4171ef=_0x598b16(0x974)+(_0x48cebb?'《'+_0x48cebb['name']+_0x598b16(0x244)+_0x48cebb['artist']:'无')+_0x598b16(0x79c)+_0xf69617+_0x598b16(0xa42)+_0x211efd+_0x598b16(0x13ca);}const _0x541a43=parseInt(_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0x132a)])||0xa,_0x5328d6=_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x1044)](-_0x541a43);let _0x17a31c='';const _0x2f60eb=_0x1e2f12['history'][_0x598b16(0x318)](_0x5a3ef1=>_0x5a3ef1[_0x598b16(0x7fd)]===_0x598b16(0x1a7)),_0x2f2bf7=_0x1e2f12[_0x598b16(0x8b3)]['slice'](_0x2f60eb+0x1),_0x5ddd90=_0x2f2bf7[_0x598b16(0xfc3)](_0x155d58=>_0x155d58['type']===_0x598b16(0x81e));if(_0x5ddd90){const _0x38d421=_0x5ddd90[_0x598b16(0xd26)],_0x559a18=_0x38d421[_0x598b16(0x4a7)][_0x598b16(0xa3b)](_0x247ad6=>{const _0x13578f=_0x598b16,_0x4ffe98=_0x247ad6[_0x13578f(0xac4)]||(_0x247ad6['role']==='user'?_0x1e2f12[_0x13578f(0x1131)][_0x13578f(0x29c)]||'我':_0x13578f(0x257));let _0x581b38='';if(_0x247ad6['type']==='voice_message')_0x581b38=_0x13578f(0x70d)+_0x247ad6['content']+']';else{if(_0x247ad6[_0x13578f(0x12d9)]===_0x13578f(0x835))_0x581b38=_0x13578f(0x10dd)+_0x247ad6['description']+']';else{if(_0x247ad6['type']===_0x13578f(0x1227))_0x581b38=_0x13578f(0x1061)+_0x247ad6[_0x13578f(0xd34)]+']';else _0x581b38=String(_0x247ad6[_0x13578f(0x53b)]);}}return _0x4ffe98+':\x20'+_0x581b38;})[_0x598b16(0x809)]('\x0a');_0x17a31c=_0x598b16(0xc00)+_0x38d421[_0x598b16(0xd0f)]+'”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x559a18+_0x598b16(0xcfd);}let _0x506762='';const _0x4db133=_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xf9f)]||0xa;if(_0x1e2f12[_0x598b16(0x1131)]['linkedMemoryChatIds']&&_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xfeb)][_0x598b16(0xa06)]>0x0){const _0x5ad24f=_0x1e2f12[_0x598b16(0x1131)]['linkedMemoryChatIds'][_0x598b16(0x401)](_0x3e39c3=>_0x3e39c3!==_0x14346e);if(_0x5ad24f[_0x598b16(0xa06)]>0x0){const _0x36e8a0=_0x5ad24f['map'](_0x4b2f57=>{const _0x1e8f9f=_0x598b16,_0xe7323c=_0x9ebf46[_0x1e8f9f(0x547)][_0x4b2f57];if(!_0xe7323c)return null;const _0x397e51=_0xe7323c[_0x1e8f9f(0x8b3)][_0x1e8f9f(0x1044)](-0x1);return{'chat':_0xe7323c,'latestTimestamp':_0x397e51?_0x397e51[_0x1e8f9f(0x6b5)]:0x0};})[_0x598b16(0x401)](Boolean);_0x36e8a0[_0x598b16(0x66b)]((_0x261067,_0x23a289)=>_0x23a289['latestTimestamp']-_0x261067[_0x598b16(0xe98)]),_0x506762+=_0x598b16(0xe68);for(const _0x3a8368 of _0x36e8a0){const _0x4a7301=_0x3a8368['chat'],_0x474145=_0x4a7301[_0x598b16(0x11e4)]?_0x598b16(0x93a):_0x598b16(0x94e),_0x12c228=_0x3a8368[_0x598b16(0xe98)]>0x0?_0x598b16(0x9be)+_0x4fcd92(_0x3a8368['latestTimestamp'])+')':'';_0x506762+='\x0a##\x20---\x20来自'+_0x474145+'“'+_0x4a7301[_0x598b16(0x609)]+_0x598b16(0x97f)+_0x12c228+_0x598b16(0xc44);const _0x51c187=_0x4a7301[_0x598b16(0x8b3)][_0x598b16(0x1044)](-_0x4db133),_0x4a6cc4=_0x51c187[_0x598b16(0x401)](_0x1fca9f=>!String(_0x1fca9f[_0x598b16(0x53b)])[_0x598b16(0x930)](_0x598b16(0x420)));_0x4a6cc4['length']>0x0?_0x4a6cc4['forEach'](_0x4dade9=>{const _0x596f4c=_0x598b16,_0x2f6302=_0x4dade9[_0x596f4c(0x7fd)]===_0x596f4c(0x586)?_0x4a7301['settings']['myNickname']||'我':_0x4dade9[_0x596f4c(0xac4)]||_0x4a7301[_0x596f4c(0x609)];let _0x27032b=String(_0x4dade9[_0x596f4c(0x53b)]);if(_0x4dade9[_0x596f4c(0x12d9)]===_0x596f4c(0x835)||_0x4dade9[_0x596f4c(0x12d9)]===_0x596f4c(0x560))_0x27032b='[发送了一张图片，描述为：'+_0x4dade9[_0x596f4c(0x53b)]+']';else _0x4dade9[_0x596f4c(0x12d9)]===_0x596f4c(0x10c1)&&(_0x27032b=_0x596f4c(0x111b)+_0x4dade9[_0x596f4c(0x53b)]+']');const _0x440c8c=_0x4fcd92(_0x4dade9[_0x596f4c(0x6b5)]);_0x506762+='('+_0x440c8c+')\x20'+_0x2f6302+':\x20'+_0x27032b+'\x0a';}):_0x506762+=_0x598b16(0x9db);}}}console[_0x598b16(0x283)](_0x598b16(0xded),_0x506762);if(_0x1e2f12[_0x598b16(0x11e4)]){let _0x596e8b='';const _0x185681=_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xf9f)]||0xa;if(_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xfeb)]&&_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xfeb)]['length']>0x0){const _0x308176=_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xfeb)][_0x598b16(0x401)](_0x3b02a6=>_0x3b02a6!==_0x14346e);if(_0x308176['length']>0x0){const _0x535d1f=_0x308176[_0x598b16(0xa3b)](_0x26df54=>{const _0x127a03=_0x598b16,_0xc10389=_0x9ebf46[_0x127a03(0x547)][_0x26df54];if(!_0xc10389)return null;const _0x163995=_0xc10389[_0x127a03(0x8b3)][_0x127a03(0x1044)](-0x1);return{'chat':_0xc10389,'latestTimestamp':_0x163995?_0x163995['timestamp']:0x0};})['filter'](Boolean);_0x535d1f[_0x598b16(0x66b)]((_0x5c9624,_0x44c268)=>_0x44c268['latestTimestamp']-_0x5c9624[_0x598b16(0xe98)]),_0x596e8b+=_0x598b16(0x8eb);for(const _0x54b26b of _0x535d1f){const _0x91415=_0x54b26b['chat'],_0x29f957=_0x91415[_0x598b16(0x11e4)]?_0x598b16(0x93a):_0x598b16(0x94e),_0x256cb1=_0x54b26b['latestTimestamp']>0x0?'\x20(最后互动于\x20'+_0x4fcd92(_0x54b26b['latestTimestamp'])+')':'';_0x596e8b+=_0x598b16(0x1018)+_0x29f957+'“'+_0x91415[_0x598b16(0x609)]+_0x598b16(0x97f)+_0x256cb1+_0x598b16(0xc44);const _0x4ba0fe=_0x91415[_0x598b16(0x8b3)][_0x598b16(0x1044)](-_0x185681),_0x40f37a=_0x4ba0fe[_0x598b16(0x401)](_0x1fa51f=>!String(_0x1fa51f[_0x598b16(0x53b)])[_0x598b16(0x930)](_0x598b16(0x420)));_0x40f37a[_0x598b16(0xa06)]>0x0?_0x40f37a[_0x598b16(0x591)](_0x546dbb=>{const _0x144a11=_0x598b16,_0x3fd465=_0x546dbb[_0x144a11(0x7fd)]===_0x144a11(0x586)?_0x91415[_0x144a11(0x1131)][_0x144a11(0x29c)]||'我':_0x546dbb[_0x144a11(0xac4)]||_0x91415[_0x144a11(0x609)];let _0x18fc3b=String(_0x546dbb[_0x144a11(0x53b)]);if(_0x546dbb[_0x144a11(0x12d9)]===_0x144a11(0x835)||_0x546dbb[_0x144a11(0x12d9)]===_0x144a11(0x560))_0x18fc3b=_0x144a11(0x10d1)+_0x546dbb[_0x144a11(0x53b)]+']';else _0x546dbb[_0x144a11(0x12d9)]===_0x144a11(0x10c1)&&(_0x18fc3b='[发送了一条语音，内容是：'+_0x546dbb[_0x144a11(0x53b)]+']');_0x596e8b+=_0x3fd465+':\x20'+_0x18fc3b+'\x0a';}):_0x596e8b+=_0x598b16(0x9db);}}}let _0x229433='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0xd6ce3=![];_0x1e2f12[_0x598b16(0xd3e)][_0x598b16(0x591)](_0x514ecb=>{const _0x513752=_0x598b16,_0x4ad7c5=_0x9ebf46[_0x513752(0x547)][_0x514ecb['id']];_0x4ad7c5&&_0x4ad7c5[_0x513752(0x323)]&&_0x4ad7c5[_0x513752(0x323)][_0x513752(0xa06)]>0x0&&(_0x229433+='\x0a##\x20---\x20关于“'+_0x514ecb[_0x513752(0x1132)]+_0x513752(0x5fa),_0x229433+=_0x4ad7c5[_0x513752(0x323)]['map'](_0x3f5583=>'-\x20(记录于\x20'+_0x4fcd92(_0x3f5583[_0x513752(0x6b5)])+')\x20'+_0x3f5583[_0x513752(0x53b)])[_0x513752(0x809)]('\x0a'),_0xd6ce3=!![]);});!_0xd6ce3&&(_0x229433+=_0x598b16(0x1264));let _0x2de7cb='',_0x5b071b=![];if(_0x1e2f12['settings'][_0x598b16(0x64b)]){const _0xc3c109=_0x5328d6[_0x598b16(0x1044)](-0x1)[0x0];if(_0xc3c109){const _0x14c38d=_0x47cd59(_0xc3c109[_0x598b16(0x6b5)]);_0x2de7cb=_0x598b16(0x880)+_0x14c38d+'。';const _0x2185bc=(Date['now']()-_0xc3c109[_0x598b16(0x6b5)])/(0x3e8*0x3c*0x3c);if(_0x2185bc>0x3){_0x5b071b=!![];const _0xb8778d=Math[_0x598b16(0x5fb)](_0x2185bc/0x18);_0x2de7cb+=_0x598b16(0x6b7)+(_0xb8778d>0x0?_0xb8778d+'天':Math[_0x598b16(0x5fb)](_0x2185bc)+'小时')+'。';}}else _0x2de7cb=_0x598b16(0xb08);}const _0x1d001b=await _0x2c5bcf[_0x598b16(0x281)][_0x598b16(0x5ff)]();let _0x1b592c='';_0x1d001b[_0x598b16(0xa06)]>0x0&&(_0x1b592c=_0x598b16(0x113b),_0x1d001b[_0x598b16(0x591)](_0x124dc2=>{const _0x11a3a8=_0x598b16;_0x1b592c+=_0x11a3a8(0x90a)+_0x124dc2['id']+')\x20商品:\x20'+_0x124dc2[_0x11a3a8(0x609)]+',\x20价格:\x20¥'+_0x124dc2[_0x11a3a8(0x3fa)]['toFixed'](0x2)+'\x0a';}));let _0x186a43=_0x1e2f12[_0x598b16(0xd3e)][_0x598b16(0xa3b)](_0x509893=>{const _0x15d681=_0x598b16,_0x426d10=_0x9ebf46[_0x15d681(0x547)][_0x509893['id']];let _0x30bec9=_0x15d681(0xb1f);if(_0x426d10&&_0x426d10[_0x15d681(0x7b1)]){const _0x559761=Object[_0x15d681(0xeb2)](_0x9ebf46[_0x15d681(0x547)])[_0x15d681(0x401)](_0x9f94ed=>!_0x9f94ed[_0x15d681(0x11e4)]&&_0x9f94ed['id']!==_0x509893['id']&&_0x9f94ed[_0x15d681(0x7b1)]===_0x426d10[_0x15d681(0x7b1)]);_0x559761[_0x15d681(0xa06)]>0x0&&(_0x30bec9='TA的好友包括:\x20'+_0x559761[_0x15d681(0xa3b)](_0x3882b0=>_0x3882b0['name'])[_0x15d681(0x809)]('、\x20'));}return _0x15d681(0x388)+_0x509893[_0x15d681(0x1132)]+_0x15d681(0x1192)+_0x509893[_0x15d681(0x1071)]+_0x15d681(0x301)+_0x509893[_0x15d681(0xeb1)]+_0x15d681(0x41b)+_0x30bec9+']';})[_0x598b16(0x809)]('\x0a');const _0x2e538b=_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0x29c)]||'我',_0x39da12=_0x9ebf46[_0x598b16(0x32c)]['nickname']||'{{user}}';let _0x2a3c0c='';const _0x742e8b=(_0x1e2f12['announcements']||[])['filter'](_0x3cdae1=>_0x3cdae1[_0x598b16(0xfac)]);_0x742e8b[_0x598b16(0xa06)]>0x0&&(_0x2a3c0c+=_0x598b16(0xdd0),_0x742e8b[_0x598b16(0x591)](_0x3d452b=>{const _0x28c32b=_0x598b16,_0x1ed1a3=_0x1e2f12[_0x28c32b(0x8b3)][_0x28c32b(0xfc3)](_0x313554=>_0x313554[_0x28c32b(0x6b5)]===_0x3d452b['messageTimestamp']);if(_0x1ed1a3){let _0x1813c6=String(_0x1ed1a3[_0x28c32b(0x53b)]||'');_0x1ed1a3[_0x28c32b(0x12d9)]==='ai_image'&&(_0x1813c6=_0x28c32b(0xcd9)+_0x1813c6+']'),_0x2a3c0c+=_0x28c32b(0x4b6)+_0x1813c6+_0x28c32b(0xb3f)+_0x3d452b[_0x28c32b(0x7ce)]+'\x20发布)\x0a';}}),_0x2a3c0c+=_0x598b16(0xe39));const _0x2b2408=_0x1e2f12[_0x598b16(0xd3e)][_0x598b16(0xa3b)](_0x26a33f=>_0x26a33f['originalName']),_0x699156=_0x598b16(0x69a)+_0x2b2408[_0x598b16(0x809)]('、\x20')+']';let _0x4b9d79=_0x598b16(0x31b);_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xd86)]&&_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xd86)]['length']>0x0?_0x4b9d79+=_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xd86)][_0x598b16(0xa3b)](_0x26213f=>'-\x20'+_0x26213f[_0x598b16(0x609)])['join']('\x0a'):_0x4b9d79+=_0x598b16(0x58f);const _0x418b34=_0x495144(_0x14346e),_0x4cedae=_0xbdd100(_0x1e2f12,0x3,_0x598b16(0x658)),_0x9b95=_0xbdd100(_0x1e2f12,0x6,_0x598b16(0x658)),_0x5ae664=_0xbdd100(_0x1e2f12,0x9,_0x598b16(0x658)),_0x2dd387=_0xbdd100(_0x1e2f12,0x1,_0x598b16(0x929)),_0x3b5c14=_0xbdd100(_0x1e2f12,0x3,_0x598b16(0x929)),_0x465241=_0xbdd100(_0x1e2f12,0x7,_0x598b16(0x929));let _0x39736c='';if(_0x4cedae||_0x9b95||_0x5ae664||_0x2dd387||_0x3b5c14||_0x465241){_0x39736c+=_0x598b16(0x8f2);if(_0x4cedae)_0x39736c+=_0x4cedae;if(_0x9b95)_0x39736c+=_0x9b95;if(_0x5ae664)_0x39736c+=_0x5ae664;if(_0x4cedae||_0x9b95||_0x5ae664)_0x39736c+='\x0a';if(_0x2dd387)_0x39736c+=_0x2dd387;if(_0x3b5c14)_0x39736c+=_0x3b5c14;if(_0x465241)_0x39736c+=_0x465241;}const _0x16b0b4=_0xe373a(_0x1e2f12);_0x1ecfc5=_0x598b16(0xfd9)+_0x2e538b+_0x598b16(0x3fc)+_0x39da12+_0x598b16(0x6d8)+_0x2e538b+_0x598b16(0xdb6)+_0x1e2f12[_0x598b16(0x609)]+_0x598b16(0x13b9)+(_0x1e2f12['settings'][_0x598b16(0x64b)]?_0x598b16(0xd10)+_0x2c4b84+')\x20和情景的感知。'+(_0x5b071b?_0x598b16(0x982)+_0x2de7cb+'\x20你应该让角色们主动开启新话题来打破沉默。':''):'')+_0x598b16(0x86f)+(_0x418b34?'你们正在一起读书。'+_0x418b34:_0x598b16(0x6a9))+_0x598b16(0xb7b)+_0x1e2f12['name']+'\x0a'+(_0x1e2f12['settings'][_0x598b16(0x64b)]?'-\x20**对话状态**:\x20上次互动于\x20'+_0x2de7cb:'')+'\x0a\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a'+_0x186a43+'\x0a#\x20用户的角色\x0a-\x20**'+_0x2e538b+_0x598b16(0x1bc)+_0x1e2f12['settings']['myPersona']+_0x598b16(0x834)+_0x26df17+'\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a'+_0x229433+'\x0a'+(_0x1e2f12[_0x598b16(0x323)]&&_0x1e2f12[_0x598b16(0x323)][_0x598b16(0xa06)]>0x0?_0x1e2f12[_0x598b16(0x323)][_0x598b16(0xa3b)](_0x50a575=>'-\x20'+_0x50a575['content'])[_0x598b16(0x809)]('\x0a'):'-\x20(暂无)')+'\x0a'+_0x39736c+'\x0a'+_0x596e8b+'\x0a'+_0x4171ef+'\x0a'+_0x17a31c+'\x0a'+_0x4b9d79+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x16b0b4+'\x0a'+_0x699156+'\x0a'+_0x45c1b3+'\x0a#\x20可用指令列表\x20(按需组合使用)\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a'+(localStorage[_0x598b16(0x1290)](_0x598b16(0xe51))==='true'?_0x598b16(0xedd):'')+_0x598b16(0x123b),_0x116b77=_0x5328d6[_0x598b16(0xa3b)](_0x5164df=>{const _0x1996ef=_0x598b16,_0x3c00ae=_0x5164df[_0x1996ef(0x7fd)]===_0x1996ef(0x586)?_0x2e538b:_0x5164df[_0x1996ef(0xac4)];let _0x431029=''+_0x3c00ae;if(_0x5164df[_0x1996ef(0xa19)]){const _0x417c06=String(_0x5164df[_0x1996ef(0xa19)][_0x1996ef(0x53b)]||'')[_0x1996ef(0xc34)](0x0,0x32);_0x431029+=_0x1996ef(0x71e)+_0x5164df[_0x1996ef(0xa19)][_0x1996ef(0xac4)]+_0x1996ef(0xfe9)+_0x417c06+_0x1996ef(0xeed);}_0x431029+=':\x20';let _0x3fa7d6;if(_0x5164df[_0x1996ef(0x12d9)]==='user_photo')_0x3fa7d6='['+_0x3c00ae+_0x1996ef(0x131f)+_0x5164df[_0x1996ef(0x53b)]+'\x27]';else{if(_0x5164df[_0x1996ef(0x12d9)]===_0x1996ef(0x835))_0x3fa7d6='['+_0x3c00ae+_0x1996ef(0xaa5)+_0x5164df[_0x1996ef(0x53b)]+'\x27]';else{if(_0x5164df[_0x1996ef(0x12d9)]===_0x1996ef(0x1227))_0x3fa7d6='['+_0x3c00ae+_0x1996ef(0x46b)+_0x5164df[_0x1996ef(0xd34)]+']';else{if(_0x5164df[_0x1996ef(0x12d9)]===_0x1996ef(0x10c1))_0x3fa7d6='['+_0x3c00ae+_0x1996ef(0x110f)+_0x5164df[_0x1996ef(0x53b)]+'\x27]';else{if(_0x5164df[_0x1996ef(0x12d9)]===_0x1996ef(0x975))_0x3fa7d6='['+_0x5164df[_0x1996ef(0xac4)]+_0x1996ef(0xbaf)+_0x5164df[_0x1996ef(0xc8a)]+'\x20转账\x20'+_0x5164df[_0x1996ef(0x212)]+_0x1996ef(0xb49)+_0x5164df[_0x1996ef(0x490)]+']';else{if(_0x5164df[_0x1996ef(0x12d9)]===_0x1996ef(0x358))_0x3fa7d6='['+_0x3c00ae+_0x1996ef(0x2c6)+_0x5164df[_0x1996ef(0x53b)]+'\x27]';else{if(_0x5164df[_0x1996ef(0x12d9)]==='repost'){const _0x55cc13=_0x5164df[_0x1996ef(0x104d)]?_0x1996ef(0x252)+_0x5164df[_0x1996ef(0x104d)]+'”':'';let _0x1bcb70=_0x1996ef(0xb78);const _0x6c0690=_0x5164df[_0x1996ef(0xc26)][_0x1996ef(0x61c)];if(_0x6c0690===_0x1996ef(0x586))_0x1bcb70=_0x9ebf46[_0x1996ef(0x32c)][_0x1996ef(0x5b7)];else _0x9ebf46[_0x1996ef(0x547)][_0x6c0690]&&(_0x1bcb70=_0x9ebf46[_0x1996ef(0x547)][_0x6c0690][_0x1996ef(0x609)]);let _0x54c981;const _0x325098=_0x5164df[_0x1996ef(0xc26)];if(_0x325098[_0x1996ef(0x12d9)]===_0x1996ef(0xf74))_0x54c981=_0x1996ef(0xa99)+(_0x325098['publicText']||'')+_0x1996ef(0x484)+(_0x325098[_0x1996ef(0x841)]||'')[_0x1996ef(0xc34)](0x0,0x28)+_0x1996ef(0xbab);else _0x325098[_0x1996ef(0x12d9)]===_0x1996ef(0x55b)?_0x54c981=_0x1996ef(0xc90)+(_0x325098[_0x1996ef(0x7b2)]||'')+_0x1996ef(0x484)+(_0x325098[_0x1996ef(0xb34)]||'')[_0x1996ef(0xc34)](0x0,0x28)+_0x1996ef(0xbab):_0x54c981='“'+(_0x325098[_0x1996ef(0x53b)]||'')[_0x1996ef(0xc34)](0x0,0x28)+_0x1996ef(0x2e1);_0x3fa7d6='['+_0x3c00ae+'\x20转发了\x20@'+_0x1bcb70+_0x1996ef(0xdc7)+_0x55cc13+_0x1996ef(0x90e)+_0x54c981+'】]';}else{if(_0x5164df[_0x1996ef(0x12d9)]==='waimai_request')_0x5164df['status']===_0x1996ef(0x11b1)?_0x3fa7d6=_0x1996ef(0x808)+_0x5164df[_0x1996ef(0xec2)]+_0x1996ef(0x12a1)+_0x3c00ae+_0x1996ef(0x1133)+_0x5164df[_0x1996ef(0x212)]+_0x1996ef(0x7a1):_0x3fa7d6='['+_0x3c00ae+_0x1996ef(0xc1a)+_0x5164df[_0x1996ef(0xde1)]+_0x1996ef(0xb5c)+_0x5164df[_0x1996ef(0x212)]+'\x20元，订单时间戳为\x20'+_0x5164df['timestamp']+']';else{if(_0x5164df['type']==='red_packet'){const _0x45b112=_0x5164df[_0x1996ef(0xac4)]===_0x2e538b?_0x1996ef(0x1ae)+_0x2e538b+')':_0x5164df[_0x1996ef(0xac4)];let _0x2bb12a;_0x5164df['packetType']===_0x1996ef(0x7b4)?_0x2bb12a=_0x1996ef(0x808)+_0x45b112+_0x1996ef(0x226)+_0x5164df[_0x1996ef(0x6b5)]+_0x1996ef(0x12b0)+_0x5164df[_0x1996ef(0xc8a)]+_0x1996ef(0xf88)+_0x5164df[_0x1996ef(0xc8a)]+_0x1996ef(0xbb5):_0x2bb12a=_0x1996ef(0x808)+_0x45b112+_0x1996ef(0xe8b)+_0x5164df[_0x1996ef(0x6b5)]+_0x1996ef(0x9ec)+_0x5164df[_0x1996ef(0xb0c)]+_0x1996ef(0x1217),_0x3fa7d6=_0x2bb12a;}else{if(_0x5164df[_0x1996ef(0x12d9)]===_0x1996ef(0x96e)){const _0x4b041e=_0x5164df['role']===_0x1996ef(0x586)?_0x2e538b:_0x227896(_0x1e2f12,_0x5164df['senderName']),_0x49f261=_0x5164df[_0x1996ef(0x62e)][_0x1996ef(0xa3b)](_0x9ab73b=>_0x9ab73b['name']+'\x20x'+_0x9ab73b['quantity'])[_0x1996ef(0x809)]('、\x20');let _0x13ee79='';if(_0x5164df['recipients']&&_0x5164df[_0x1996ef(0xda3)]['length']>0x0){const _0x3be621=_0x5164df[_0x1996ef(0xda3)][_0x1996ef(0xa3b)](_0x51b5b9=>_0x227896(_0x1e2f12,_0x51b5b9))[_0x1996ef(0x809)]('、\x20');_0x13ee79=_0x1996ef(0x1343)+_0x3be621;}else _0x13ee79='送给了大家一份礼物';return _0x3fa7d6=_0x1996ef(0x808)+_0x4b041e+'\x20'+_0x13ee79+_0x1996ef(0xf1f)+_0x49f261+']',{'role':_0x1996ef(0x586),'content':_0x3fa7d6};}else{if(_0x5164df[_0x1996ef(0x12d9)]==='poll'){const _0x38ae7b=Object[_0x1996ef(0xeb2)](_0x5164df['votes']||{})[_0x1996ef(0xc07)]()[_0x1996ef(0x809)](',\x20')||_0x1996ef(0x102b);_0x3fa7d6=_0x1996ef(0x808)+_0x5164df[_0x1996ef(0xac4)]+_0x1996ef(0x1162)+_0x5164df['timestamp']+_0x1996ef(0xbee)+_0x5164df[_0x1996ef(0x12f6)]+_0x1996ef(0x2c4)+_0x5164df[_0x1996ef(0x5ed)][_0x1996ef(0x809)](',\x20')+_0x1996ef(0xe5f)+_0x38ae7b+_0x1996ef(0x956);}else{if(_0x5164df['meaning'])_0x3fa7d6=_0x3c00ae+_0x1996ef(0xca3)+_0x5164df[_0x1996ef(0x1b3)]+'\x27]';else{if(Array[_0x1996ef(0xb27)](_0x5164df[_0x1996ef(0x53b)]))return{'role':_0x1996ef(0x586),'content':[..._0x5164df['content'],{'type':_0x1996ef(0xbb7),'text':_0x431029}]};else _0x3fa7d6=''+_0x431029+_0x5164df['content'];}}}}}}}}}}}}return{'role':_0x1996ef(0x586),'content':_0x3fa7d6};})['filter'](Boolean);}else{const _0x361e93=_0x1e2f12[_0x598b16(0x1131)]['isOfflineMode'],_0x42076f=_0x389fa5(_0x1e2f12);let _0x34c1e7='';_0x1e2f12['settings']['injectLatestThought']&&_0x1e2f12[_0x598b16(0x1291)]&&!_0x361e93&&(_0x34c1e7=_0x598b16(0xb3d)+_0x1e2f12[_0x598b16(0x1291)]+_0x598b16(0xd4c)+_0x1e2f12[_0x598b16(0xa1a)]+'\x0a');let _0x1aec31='';const _0x2380df=_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xf9f)]||0xa;if(_0x1e2f12['settings'][_0x598b16(0xfeb)]&&_0x1e2f12['settings'][_0x598b16(0xfeb)]['length']>0x0){const _0x40b450=_0x1e2f12['settings'][_0x598b16(0xfeb)]['filter'](_0x1ab419=>_0x1ab419!==_0x14346e);if(_0x40b450['length']>0x0){const _0xb233a1=_0x40b450[_0x598b16(0xa3b)](_0x1de369=>{const _0x34617f=_0x598b16,_0x256ef3=_0x9ebf46[_0x34617f(0x547)][_0x1de369];if(!_0x256ef3)return null;const _0x47fe95=_0x256ef3['history'][_0x34617f(0x1044)](-0x1)[0x0];return{'chat':_0x256ef3,'latestTimestamp':_0x47fe95?_0x47fe95[_0x34617f(0x6b5)]:0x0};})[_0x598b16(0x401)](Boolean);_0xb233a1[_0x598b16(0x66b)]((_0x4fb5f1,_0x137381)=>_0x137381[_0x598b16(0xe98)]-_0x4fb5f1[_0x598b16(0xe98)]),_0x1aec31+='\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a';for(const _0x31fb4a of _0xb233a1){const _0x406e4d=_0x31fb4a['chat'],_0x57eb30=_0x406e4d[_0x598b16(0x11e4)]?_0x598b16(0x93a):_0x598b16(0x94e),_0x1f482c=_0x31fb4a[_0x598b16(0xe98)]>0x0?_0x598b16(0x9be)+_0x4fcd92(_0x31fb4a[_0x598b16(0xe98)])+')':'';_0x1aec31+='\x0a##\x20---\x20来自'+_0x57eb30+'“'+_0x406e4d[_0x598b16(0x609)]+'”的参考记忆'+_0x1f482c+_0x598b16(0xc44);const _0x9b1c74=_0x406e4d[_0x598b16(0x8b3)][_0x598b16(0x1044)](-_0x2380df),_0x4e9c17=_0x9b1c74[_0x598b16(0x401)](_0x3d46c4=>!String(_0x3d46c4['content'])[_0x598b16(0x930)](_0x598b16(0x420)));_0x4e9c17['length']>0x0?_0x4e9c17['forEach'](_0x5860bc=>{const _0x26133b=_0x598b16,_0x1d0419=_0x5860bc[_0x26133b(0x7fd)]===_0x26133b(0x586)?_0x406e4d[_0x26133b(0x1131)][_0x26133b(0x29c)]||'我':_0x5860bc[_0x26133b(0xac4)]||_0x406e4d[_0x26133b(0x609)];let _0x142744=String(_0x5860bc[_0x26133b(0x53b)]);if(_0x5860bc['type']===_0x26133b(0x835)||_0x5860bc[_0x26133b(0x12d9)]==='user_photo')_0x142744='[发送了一张图片，描述为：'+_0x5860bc[_0x26133b(0x53b)]+']';else _0x5860bc[_0x26133b(0x12d9)]===_0x26133b(0x10c1)&&(_0x142744=_0x26133b(0x111b)+_0x5860bc[_0x26133b(0x53b)]+']');const _0x396269=_0x4fcd92(_0x5860bc[_0x26133b(0x6b5)]);_0x1aec31+='('+_0x396269+')\x20'+_0x1d0419+':\x20'+_0x142744+'\x0a';}):_0x1aec31+='(暂无有效聊天记录)\x0a';}}}const _0x972c9b=await _0x2c5bcf[_0x598b16(0x281)][_0x598b16(0x5ff)]();let _0x2fdeb5='';_0x972c9b[_0x598b16(0xa06)]>0x0&&(_0x2fdeb5=_0x598b16(0x557),_0x972c9b['forEach'](_0x581dc6=>{const _0x50c166=_0x598b16;_0x2fdeb5+=_0x50c166(0x90a)+_0x581dc6['id']+_0x50c166(0xf2f)+_0x581dc6['name']+_0x50c166(0x65c)+_0x581dc6[_0x50c166(0x3fa)][_0x50c166(0x752)](0x2)+'\x0a';}));if(_0x361e93){const _0xf1a676=_0x1e2f12['settings'][_0x598b16(0xa82)]||0x64,_0x5cf7e7=_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0x94a)]||0x12c,_0x459a91=_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0x29c)]||'我';let _0x4486b5='';if(_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0x6aa)]){const _0x4865b6=_0x9ebf46[_0x598b16(0x10ef)][_0x598b16(0xfc3)](_0x147572=>_0x147572['id']===_0x1e2f12[_0x598b16(0x1131)]['offlinePresetId']);if(_0x4865b6&&Array['isArray'](_0x4865b6['content'])){const _0x24c580=_0x4865b6[_0x598b16(0x53b)][_0x598b16(0x401)](_0x24515c=>_0x24515c['enabled']!==![])[_0x598b16(0xa3b)](_0x83dacb=>'-\x20'+_0x83dacb['content'])[_0x598b16(0x809)]('\x0a');_0x24c580&&(_0x4486b5='\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a'+_0x24c580+_0x598b16(0xd00));}}_0x1ecfc5=_0x598b16(0x8ef)+_0x1e2f12[_0x598b16(0x1071)]+_0x598b16(0x137f)+_0x4486b5+_0x598b16(0x4af)+_0x1e2f12[_0x598b16(0x1131)]['aiPersona']+_0x598b16(0xd92)+_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0x1151)]+_0x598b16(0xe6e)+(_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0x64b)]?'-\x20**当前时间**:\x20'+_0x2c4b84+'\x20('+_0x9689f7+')':'')+_0x598b16(0xee9)+_0x26df17+_0x598b16(0xfb9)+(_0x1e2f12[_0x598b16(0x323)]&&_0x1e2f12[_0x598b16(0x323)][_0x598b16(0xa06)]>0x0?_0x1e2f12['longTermMemory'][_0x598b16(0xa3b)](_0x2e8ad9=>'-\x20'+_0x2e8ad9[_0x598b16(0x53b)])['join']('\x0a'):_0x598b16(0x1264))+'\x0a\x0a'+_0x1aec31+_0x598b16(0x6d0)+_0x5328d6[_0x598b16(0xa3b)](_0x11d1d2=>{const _0x5f019a=_0x598b16;let _0x41635d=(_0x11d1d2[_0x5f019a(0x7fd)]===_0x5f019a(0x586)?_0x459a91:_0x1e2f12[_0x5f019a(0x609)])+':\x20';return _0x11d1d2[_0x5f019a(0x12d9)]===_0x5f019a(0xc91)?_0x41635d+='「'+(_0x11d1d2[_0x5f019a(0xc2e)]||'')+'」\x20'+(_0x11d1d2['description']||''):_0x41635d+=String(_0x11d1d2['content']),_0x41635d;})[_0x598b16(0x809)]('\x0a')+_0x598b16(0xd16)+_0xf1a676+'到'+_0x5cf7e7+_0x598b16(0x35d),_0x116b77=_0x5328d6['map'](_0x5d3988=>{const _0x4f7afc=_0x598b16;if(_0x5d3988['isHidden'])return null;if(_0x5d3988[_0x4f7afc(0x12d9)]===_0x4f7afc(0xc91)){const _0x36d4fe=_0x5d3988['role']===_0x4f7afc(0x586)?_0x1e2f12['settings']['myNickname']||'我':_0x1e2f12['name'];let _0x451444='';if(_0x5d3988[_0x4f7afc(0x53b)])_0x451444=_0x5d3988['content'];else{const _0x1ec58d=_0x5d3988[_0x4f7afc(0xc2e)]?'「'+_0x5d3988['dialogue']+'」':'',_0x423e98=_0x5d3988[_0x4f7afc(0x1387)]?'('+_0x5d3988[_0x4f7afc(0x1387)]+')':'';_0x451444=(_0x1ec58d+'\x20'+_0x423e98)[_0x4f7afc(0x3f1)]();}return{'role':_0x5d3988['role'],'content':_0x36d4fe+':\x20'+_0x451444};}if(_0x5d3988[_0x4f7afc(0x7fd)]==='user'){const _0x413731=_0x459a91+':\x20';let _0x276c59='';if(Array[_0x4f7afc(0xb27)](_0x5d3988[_0x4f7afc(0x53b)])&&_0x5d3988[_0x4f7afc(0x53b)][0x0]?.[_0x4f7afc(0x12d9)]==='image_url')return{'role':_0x4f7afc(0x586),'content':[{'type':'text','text':_0x413731},..._0x5d3988[_0x4f7afc(0x53b)]]};if(_0x5d3988[_0x4f7afc(0xa19)]){const _0x31150e=String(_0x5d3988[_0x4f7afc(0xa19)][_0x4f7afc(0x53b)]||'')['substring'](0x0,0x32);_0x276c59+=_0x4f7afc(0x108f)+_0x5d3988[_0x4f7afc(0xa19)][_0x4f7afc(0xac4)]+_0x4f7afc(0xfe9)+_0x31150e+_0x4f7afc(0x78b)+_0x5d3988[_0x4f7afc(0x53b)];}else _0x276c59+=_0x5d3988['content'];if(_0x5d3988[_0x4f7afc(0x12d9)]===_0x4f7afc(0x560))return{'role':_0x4f7afc(0x586),'content':_0x413731+_0x4f7afc(0x111e)+_0x5d3988[_0x4f7afc(0x53b)]+'\x27]'};if(_0x5d3988['type']===_0x4f7afc(0x10c1))return{'role':'user','content':_0x413731+_0x4f7afc(0xe37)+_0x5d3988[_0x4f7afc(0x53b)]+'\x27]'};if(_0x5d3988[_0x4f7afc(0x12d9)]===_0x4f7afc(0x975))return{'role':'user','content':_0x413731+_0x4f7afc(0x624)+_0x5d3988['timestamp']+_0x4f7afc(0x8ff)+_0x5d3988[_0x4f7afc(0x212)]+_0x4f7afc(0xb49)+_0x5d3988[_0x4f7afc(0x490)]+_0x4f7afc(0xbd7)};if(_0x5d3988[_0x4f7afc(0x12d9)]===_0x4f7afc(0x12d4))return{'role':_0x4f7afc(0x586),'content':_0x413731+_0x4f7afc(0x624)+_0x5d3988[_0x4f7afc(0x6b5)]+'\x20发起了外卖代付请求，商品是“'+_0x5d3988[_0x4f7afc(0xde1)]+_0x4f7afc(0xb5c)+_0x5d3988[_0x4f7afc(0x212)]+'\x20元。]'};else{if(_0x5d3988[_0x4f7afc(0x12d9)]===_0x4f7afc(0x96e)){const _0x3715ca=_0x5d3988[_0x4f7afc(0x62e)][_0x4f7afc(0xa3b)](_0x5d4dbf=>_0x5d4dbf[_0x4f7afc(0x609)]+'\x20x'+_0x5d4dbf[_0x4f7afc(0xe58)])['join']('、\x20');let _0x1084b1=_0x1e2f12['isGroup']?_0x4f7afc(0x1343)+_0x5d3988[_0x4f7afc(0xda3)][_0x4f7afc(0xa3b)](_0x277199=>_0x227896(_0x1e2f12,_0x277199))['join']('、\x20'):'送给了\x20'+_0x1e2f12['name'];return{'role':_0x4f7afc(0x586),'content':_0x413731+_0x4f7afc(0x12f4)+_0x1084b1+_0x4f7afc(0xf1f)+_0x3715ca+']'};}}if(_0x5d3988[_0x4f7afc(0x1b3)])return{'role':'user','content':_0x413731+'[你发送了一个表情，意思是：\x27'+_0x5d3988['meaning']+'\x27]'};return{'role':_0x5d3988['role'],'content':_0x413731+_0x276c59};}else{if(_0x5d3988[_0x4f7afc(0x7fd)]==='assistant'){let _0x4ecb62={'type':_0x5d3988[_0x4f7afc(0x12d9)]||'text'};if(_0x5d3988['type']==='sticker')_0x4ecb62[_0x4f7afc(0x11be)]=_0x5d3988['content'],_0x4ecb62[_0x4f7afc(0x1b3)]=_0x5d3988[_0x4f7afc(0x1b3)];else{if(_0x5d3988[_0x4f7afc(0x12d9)]===_0x4f7afc(0x975))_0x4ecb62[_0x4f7afc(0x212)]=_0x5d3988[_0x4f7afc(0x212)],_0x4ecb62[_0x4f7afc(0x490)]=_0x5d3988[_0x4f7afc(0x490)];else _0x5d3988[_0x4f7afc(0x12d9)]===_0x4f7afc(0x12d4)?(_0x4ecb62[_0x4f7afc(0xde1)]=_0x5d3988['productInfo'],_0x4ecb62[_0x4f7afc(0x212)]=_0x5d3988[_0x4f7afc(0x212)]):_0x5d3988[_0x4f7afc(0xa19)]?_0x4ecb62[_0x4f7afc(0xb43)]={'target_sender':_0x5d3988[_0x4f7afc(0xa19)]['senderName'],'target_content':_0x5d3988[_0x4f7afc(0xa19)][_0x4f7afc(0x53b)],'reply_content':_0x5d3988[_0x4f7afc(0x53b)]}:_0x4ecb62[_0x4f7afc(0x53b)]=_0x5d3988[_0x4f7afc(0x53b)];}const _0x48d0f4=JSON['stringify']([_0x4ecb62]);return{'role':_0x4f7afc(0x1a7),'content':_0x4f7afc(0x34f)+_0x5d3988[_0x4f7afc(0x6b5)]+')\x20'+_0x48d0f4};}}return null;})[_0x598b16(0x401)](Boolean);}else{let _0x3acf6f='';_0x1e2f12[_0x598b16(0xd4f)]&&_0x1e2f12[_0x598b16(0xd4f)][_0x598b16(0xa06)]>0x0&&(_0x3acf6f=_0x598b16(0xfad)+_0x1e2f12[_0x598b16(0xd4f)][_0x598b16(0x809)](',\x20')+_0x598b16(0xb67));let _0x2b7202='';const _0x35274e=_0x9ebf46[_0x598b16(0x32c)][_0x598b16(0x5b7)]||'用户';_0x2b7202+=_0x598b16(0xd20)+_0x35274e+_0x598b16(0x623);const _0x176ff2=Object[_0x598b16(0xeb2)](_0x9ebf46[_0x598b16(0x547)]),_0x4ad379=_0x176ff2[_0x598b16(0x401)](_0x39dfa6=>_0x39dfa6[_0x598b16(0x11e4)]&&_0x39dfa6[_0x598b16(0xd3e)][_0x598b16(0x10b2)](_0x12299d=>_0x12299d['id']===_0x1e2f12['id']));_0x4ad379[_0x598b16(0xa06)]>0x0&&(_0x2b7202+=_0x598b16(0xc88),_0x4ad379[_0x598b16(0x591)](_0x7918c3=>{const _0x14a1f4=_0x598b16,_0x302bcc=_0x7918c3[_0x14a1f4(0x1131)][_0x14a1f4(0x29c)]||_0x35274e;_0x2b7202+=_0x14a1f4(0x2a5)+_0x7918c3[_0x14a1f4(0x609)]+_0x14a1f4(0x332)+_0x302bcc+_0x14a1f4(0x971);}));_0x2b7202+=_0x598b16(0x135f);let _0x2ff582='';const _0x121471=_0x176ff2['filter'](_0x14d53c=>!_0x14d53c[_0x598b16(0x11e4)]&&_0x14d53c['id']!==_0x1e2f12['id']&&_0x14d53c['groupId']===_0x1e2f12['groupId']&&_0x1e2f12['groupId']!==null);_0x121471[_0x598b16(0xa06)]>0x0&&(_0x2ff582+='\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a',_0x121471[_0x598b16(0x591)](_0x46f6ae=>{const _0x53fb76=_0x598b16;_0x2ff582+=_0x53fb76(0x1068)+_0x46f6ae['name']+_0x53fb76(0x1192)+_0x46f6ae[_0x53fb76(0x1071)]+')\x0a';}));const _0x2d903f=await _0x2c5bcf['qzonePosts']['orderBy'](_0x598b16(0x6b5))[_0x598b16(0x101e)]()[_0x598b16(0x13bf)](0xa)['toArray'](),_0x529692=_0x499cd0(_0x2d903f,_0x1e2f12);let _0x26ff5f='';if(_0x529692[_0x598b16(0xa06)]>0x0){_0x26ff5f=_0x598b16(0x9bd);const _0x5940a5=_0x1e2f12[_0x598b16(0x1071)];for(const _0x282ad3 of _0x529692){let _0x4f7ca3;if(_0x282ad3[_0x598b16(0x61c)]===_0x598b16(0x586))_0x4f7ca3=_0x9ebf46[_0x598b16(0x32c)][_0x598b16(0x5b7)];else{if(String(_0x282ad3['authorId'])[_0x598b16(0xc8d)](_0x598b16(0x2e7)))_0x4f7ca3=_0x282ad3[_0x598b16(0x12ec)]||'一位神秘的NPC';else{const _0x1ef480=_0x9ebf46[_0x598b16(0x547)][_0x282ad3['authorId']];_0x4f7ca3=_0x1ef480?_0x1ef480['name']:_0x598b16(0x7fc);}}if(_0x282ad3[_0x598b16(0x61c)]===_0x14346e)_0x4f7ca3+=_0x598b16(0x98b);let _0x217e35;if(_0x282ad3[_0x598b16(0x12d9)]==='repost'){const _0x1c23ac=_0x282ad3[_0x598b16(0x104d)]?_0x598b16(0xdd5)+_0x282ad3[_0x598b16(0x104d)]+'\x22':'';let _0x561905=_0x598b16(0xb78);const _0xd3aa4b=_0x282ad3[_0x598b16(0xc26)][_0x598b16(0x61c)];if(_0xd3aa4b===_0x598b16(0x586))_0x561905=_0x9ebf46['qzoneSettings']['nickname'];else _0x9ebf46[_0x598b16(0x547)][_0xd3aa4b]&&(_0x561905=_0x9ebf46[_0x598b16(0x547)][_0xd3aa4b][_0x598b16(0x609)]);let _0x382fd9;const _0x35f8af=_0x282ad3[_0x598b16(0xc26)];if(_0x35f8af[_0x598b16(0x12d9)]===_0x598b16(0xf74))_0x382fd9=_0x598b16(0xa99)+(_0x35f8af[_0x598b16(0x7b2)]||'')+_0x598b16(0x11cd)+(_0x35f8af['hiddenContent']||'')[_0x598b16(0xc34)](0x0,0x28)+_0x598b16(0xeed);else _0x35f8af['type']===_0x598b16(0x55b)?_0x382fd9=_0x598b16(0xc90)+(_0x35f8af[_0x598b16(0x7b2)]||'')+_0x598b16(0x11cd)+(_0x35f8af[_0x598b16(0xb34)]||'')[_0x598b16(0xc34)](0x0,0x28)+'...\x22)':_0x382fd9='\x22'+(_0x35f8af[_0x598b16(0x53b)]||'')[_0x598b16(0xc34)](0x0,0x28)+_0x598b16(0xddf);_0x217e35=_0x598b16(0x762)+_0x561905+_0x598b16(0xdc7)+_0x1c23ac+_0x598b16(0x90e)+_0x382fd9+'】';}else{if(_0x282ad3[_0x598b16(0x12d9)]==='text_image')_0x217e35=(_0x598b16(0x717)+_0x282ad3[_0x598b16(0x841)]+'\x22]\x20'+(_0x282ad3[_0x598b16(0x7b2)]||''))[_0x598b16(0xc34)](0x0,0x32)+_0x598b16(0xf66);else{if(_0x282ad3[_0x598b16(0x12d9)]==='image_post')_0x217e35=(_0x598b16(0x553)+_0x282ad3[_0x598b16(0xb34)]+_0x598b16(0xd49)+(_0x282ad3[_0x598b16(0x7b2)]||''))[_0x598b16(0xc34)](0x0,0x32)+_0x598b16(0xf66);else{if(_0x282ad3['type']===_0x598b16(0x1227)&&_0x282ad3[_0x598b16(0xd34)]){const _0x1489fd=Array[_0x598b16(0xb27)](_0x282ad3['prompt'])?_0x282ad3[_0x598b16(0xd34)]:[_0x282ad3[_0x598b16(0xd34)]];_0x217e35=(_0x282ad3['publicText']||'')+(_0x598b16(0x6ba)+_0x1489fd[_0x598b16(0xa06)]+_0x598b16(0x8ec)+_0x1489fd[_0x598b16(0x809)](',\x20')+']');}else _0x217e35=String(_0x282ad3[_0x598b16(0x7b2)]||_0x282ad3[_0x598b16(0x53b)]||'一条动态')[_0x598b16(0xc34)](0x0,0x32)+_0x598b16(0xf66);}}}_0x26ff5f+=_0x598b16(0x90a)+_0x282ad3['id']+_0x598b16(0x11cc)+_0x4f7ca3+_0x598b16(0x110a)+_0x217e35+'\x22\x0a';if(_0x282ad3['comments']&&_0x282ad3[_0x598b16(0x1e0)]['length']>0x0)for(const _0x47b291 of _0x282ad3['comments']){if(typeof _0x47b291===_0x598b16(0xc24)&&_0x47b291[_0x598b16(0x8bf)]){const _0x363bad=_0x1dfc4e(_0x47b291['commenterName']);let _0x25dd6e=_0x47b291[_0x598b16(0x1b3)]?'[表情:\x20\x27'+_0x47b291[_0x598b16(0x1b3)]+'\x27]':_0x47b291[_0x598b16(0xbb7)];_0x47b291[_0x598b16(0x8bf)]===_0x5940a5?_0x26ff5f+=_0x598b16(0xad2)+_0x25dd6e+'\x0a':_0x26ff5f+='\x20\x20-\x20评论:\x20'+_0x363bad+_0x598b16(0xdcc)+_0x47b291[_0x598b16(0x8bf)]+_0x598b16(0x301)+_0x25dd6e+'\x0a';}}}}const _0x28dfdd=_0x1e2f12['settings'][_0x598b16(0x29c)]||'我';let _0x2a928e='',_0x5e41f0=![];if(_0x1e2f12[_0x598b16(0x1131)]['enableTimePerception']){const _0x43ef9e=_0x5328d6[_0x598b16(0x4d4)](_0x32f43b=>_0x32f43b[_0x598b16(0x7fd)]===_0x598b16(0x586)&&!_0x32f43b[_0x598b16(0xc62)]),_0xb1093b=_0x5328d6[_0x598b16(0x4d4)](_0xbbbe2=>_0xbbbe2[_0x598b16(0x7fd)]===_0x598b16(0x1a7)&&!_0xbbbe2[_0x598b16(0xc62)]);if(_0x43ef9e){const _0x4287df=_0x47cd59(_0x43ef9e[_0x598b16(0x6b5)]);if(_0xb1093b){const _0x251ae2=_0x47cd59(_0xb1093b[_0x598b16(0x6b5)]);_0x2a928e='-\x20**对话状态**:\x20你的上一条消息发送于\x20'+_0x251ae2+_0x598b16(0x1b9)+_0x4287df+'\x20回复了你。';const _0x3d895e=(_0x43ef9e['timestamp']-_0xb1093b[_0x598b16(0x6b5)])/(0x3e8*0x3c*0x3c);if(_0x3d895e>0x3){_0x5e41f0=!![];const _0x2ff4f9=Math[_0x598b16(0x5fb)](_0x3d895e/0x18);_0x2a928e+='\x20你们之间已经有**'+(_0x2ff4f9>0x0?_0x2ff4f9+'天':Math[_0x598b16(0x5fb)](_0x3d895e)+'小时')+_0x598b16(0x606)+_0x9689f7+'）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。';}}else _0x2a928e=_0x598b16(0xd0c)+_0x4287df+'。';}else _0x2a928e=_0x598b16(0x12e3);}const _0x2b3ffb=_0x495144(_0x14346e),_0x7f3576=_0xbdd100(_0x1e2f12,0x3,_0x598b16(0x658)),_0x1d3176=_0xbdd100(_0x1e2f12,0x6,_0x598b16(0x658)),_0x18b106=_0xbdd100(_0x1e2f12,0x9,_0x598b16(0x658)),_0x30ed64=_0xbdd100(_0x1e2f12,0x1,_0x598b16(0x929)),_0x22caa7=_0xbdd100(_0x1e2f12,0x3,_0x598b16(0x929)),_0x5cb86c=_0xbdd100(_0x1e2f12,0x7,_0x598b16(0x929));let _0x19a88b='';if(_0x7f3576||_0x1d3176||_0x18b106||_0x30ed64||_0x22caa7||_0x5cb86c){_0x19a88b+=_0x598b16(0x6ce);if(_0x7f3576)_0x19a88b+=_0x7f3576;if(_0x1d3176)_0x19a88b+=_0x1d3176;if(_0x18b106)_0x19a88b+=_0x18b106;if(_0x7f3576||_0x1d3176||_0x18b106)_0x19a88b+='\x0a';if(_0x30ed64)_0x19a88b+=_0x30ed64;if(_0x22caa7)_0x19a88b+=_0x22caa7;if(_0x5cb86c)_0x19a88b+=_0x5cb86c;}_0x1ecfc5='\x0a#\x20身份与核心任务\x0a你正在扮演角色“'+_0x1e2f12[_0x598b16(0x1071)]+_0x598b16(0x813)+_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xae3)]+'\x0a'+_0x34c1e7+_0x598b16(0xbbf)+_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0x1151)]+'\x0a\x0a#\x20当前情景\x0a'+(_0x1e2f12[_0x598b16(0x1131)]['enableTimePerception']?_0x598b16(0x60f)+_0x2c4b84+'\x20('+_0x9689f7+')':'')+'\x0a'+_0x2a928e+_0x598b16(0x1102)+_0x26df17+'\x0a'+_0x1aec31+'\x0a#\x20长期记忆\x20(必须严格遵守)\x0a'+(_0x1e2f12[_0x598b16(0x323)]&&_0x1e2f12[_0x598b16(0x323)][_0x598b16(0xa06)]>0x0?_0x1e2f12[_0x598b16(0x323)][_0x598b16(0xa3b)](_0x541f2b=>'-\x20'+_0x541f2b[_0x598b16(0x53b)])[_0x598b16(0x809)]('\x0a'):'-\x20(暂无)')+'\x0a'+_0x19a88b+'\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22'+_0x1e2f12[_0x598b16(0x1071)]+'\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22'+_0x1e2f12[_0x598b16(0x609)]+_0x598b16(0x201)+_0x28dfdd+_0x598b16(0xeec)+_0x2b7202+_0x598b16(0xffd)+_0x3acf6f+_0x598b16(0x5f1)+_0x42076f+'\x0a'+_0x17a31c+'\x0a'+_0x45c1b3+_0x598b16(0x455)+_0x2ff582+'\x0a'+_0x26ff5f+_0x598b16(0x8c0)+(_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0x64b)]?'-\x20**时间**:\x20你必须感知到当前是\x20'+_0x2c4b84+'\x20('+_0x9689f7+_0x598b16(0x111c):'')+_0x598b16(0x7be)+(_0x4171ef?_0x598b16(0x104e)+_0x4171ef:_0x598b16(0x1129))+_0x598b16(0x86f)+(_0x2b3ffb?_0x598b16(0x92d)+_0x2b3ffb:_0x598b16(0x6a9))+_0x598b16(0xfdb)+(_0x1e2f12[_0x598b16(0x1131)]['aiAvatarLibrary']&&_0x1e2f12[_0x598b16(0x1131)]['aiAvatarLibrary'][_0x598b16(0xa06)]>0x0?_0x1e2f12[_0x598b16(0x1131)]['aiAvatarLibrary'][_0x598b16(0xa3b)](_0x5619ca=>'-\x20'+_0x5619ca[_0x598b16(0x609)])[_0x598b16(0x809)]('\x0a'):_0x598b16(0xb88))+_0x598b16(0x1157)+(_0x1e2f12['settings'][_0x598b16(0xd7a)]&&_0x1e2f12['settings']['myAvatarLibrary'][_0x598b16(0xa06)]>0x0?_0x1e2f12['settings']['myAvatarLibrary'][_0x598b16(0xa3b)](_0x2df67c=>'-\x20'+_0x2df67c['name'])[_0x598b16(0x809)]('\x0a'):_0x598b16(0xb88))+'\x0a-\x20\x20\x20**五子棋局势**:\x20'+_0xa52343+'\x0a\x0a\x0a\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a'+(localStorage[_0x598b16(0x1290)]('novelai-enabled')===_0x598b16(0x667)?'-\x20\x20\x20**NovelAI真实图片分享\x20(在聊天中直接发送)**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20-\x20**【绝不能暴露是novelai生成的图片！】\x0a\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20-\x20使用场景：当你想要在【私聊对话中】直接给用户发送一张图片时使用。\x0a\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。\x0a\x20\x20\x20\x20-\x20注意：这会直接在聊天记录中显示图片，而不是发布到动态。':'')+'\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a'+(localStorage['getItem'](_0x598b16(0xe51))===_0x598b16(0x667)?_0x598b16(0x4b9):'')+_0x598b16(0x344)+_0x1e2f12[_0x598b16(0x1071)]+'\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22'+_0x1e2f12[_0x598b16(0x1071)]+_0x598b16(0xf29)+_0x1e2f12['originalName']+_0x598b16(0x427)+_0x1e2f12[_0x598b16(0x1071)]+'\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。',_0x116b77=_0x5328d6[_0x598b16(0xa3b)](_0x4d73ad=>{const _0x400c31=_0x598b16;if(_0x4d73ad[_0x400c31(0xc62)]&&_0x4d73ad[_0x400c31(0x7fd)]===_0x400c31(0xb64))return{'role':_0x400c31(0x586),'content':_0x4d73ad[_0x400c31(0x53b)]};else{if(_0x4d73ad[_0x400c31(0xc62)])return null;}if(_0x4d73ad[_0x400c31(0x12d9)]===_0x400c31(0xc91)){const _0x312189=_0x4d73ad['role']===_0x400c31(0x586)?_0x1e2f12['settings'][_0x400c31(0x29c)]||'我':_0x1e2f12[_0x400c31(0x609)];let _0x21c202='';if(_0x4d73ad[_0x400c31(0x53b)])_0x21c202=_0x4d73ad[_0x400c31(0x53b)];else{const _0x4adf02=_0x4d73ad[_0x400c31(0xc2e)]?'「'+_0x4d73ad[_0x400c31(0xc2e)]+'」':'',_0x304ec9=_0x4d73ad[_0x400c31(0x1387)]?'('+_0x4d73ad[_0x400c31(0x1387)]+')':'';_0x21c202=(_0x4adf02+'\x20'+_0x304ec9)[_0x400c31(0x3f1)]();}return{'role':_0x4d73ad[_0x400c31(0x7fd)],'content':_0x400c31(0x34f)+_0x4d73ad[_0x400c31(0x6b5)]+')\x20'+_0x312189+':\x20'+_0x21c202};}if(_0x4d73ad[_0x400c31(0x7fd)]===_0x400c31(0x586)){const _0x55caa1=_0x400c31(0x34f)+_0x4d73ad[_0x400c31(0x6b5)]+')\x20';let _0x353130='';if(Array[_0x400c31(0xb27)](_0x4d73ad[_0x400c31(0x53b)])&&_0x4d73ad[_0x400c31(0x53b)][0x0]?.[_0x400c31(0x12d9)]===_0x400c31(0x96f))return{'role':_0x400c31(0x586),'content':[{'type':_0x400c31(0xbb7),'text':_0x55caa1},..._0x4d73ad[_0x400c31(0x53b)]]};if(_0x4d73ad['quote']){const _0x4377f3=String(_0x4d73ad['quote'][_0x400c31(0x53b)]||'')[_0x400c31(0xc34)](0x0,0x32);_0x353130+='(回复\x20'+_0x4d73ad[_0x400c31(0xa19)][_0x400c31(0xac4)]+_0x400c31(0xfe9)+_0x4377f3+_0x400c31(0x78b)+_0x4d73ad['content'];}else _0x353130+=_0x4d73ad[_0x400c31(0x53b)];if(_0x4d73ad[_0x400c31(0x12d9)]===_0x400c31(0x560))return{'role':_0x400c31(0x586),'content':_0x55caa1+_0x400c31(0x111e)+_0x4d73ad[_0x400c31(0x53b)]+'\x27]'};if(_0x4d73ad[_0x400c31(0x12d9)]==='voice_message')return{'role':'user','content':_0x55caa1+_0x400c31(0xe37)+_0x4d73ad[_0x400c31(0x53b)]+'\x27]'};if(_0x4d73ad[_0x400c31(0x12d9)]==='transfer')return{'role':'user','content':_0x55caa1+_0x400c31(0x624)+_0x4d73ad['timestamp']+_0x400c31(0x8ff)+_0x4d73ad[_0x400c31(0x212)]+_0x400c31(0xb49)+_0x4d73ad['note']+_0x400c31(0xbd7)};if(_0x4d73ad[_0x400c31(0x12d9)]==='waimai_request')return{'role':_0x400c31(0x586),'content':_0x55caa1+'[系统提示：你于时间戳\x20'+_0x4d73ad[_0x400c31(0x6b5)]+_0x400c31(0xc1a)+_0x4d73ad[_0x400c31(0xde1)]+'”，金额是\x20'+_0x4d73ad['amount']+_0x400c31(0x1f0)};else{if(_0x4d73ad[_0x400c31(0x12d9)]===_0x400c31(0x96e)){const _0x52363d=_0x4d73ad[_0x400c31(0x62e)][_0x400c31(0xa3b)](_0x28a652=>_0x28a652[_0x400c31(0x609)]+'\x20x'+_0x28a652[_0x400c31(0xe58)])['join']('、\x20');let _0x6d376a=_0x1e2f12[_0x400c31(0x11e4)]?_0x400c31(0x1343)+_0x4d73ad[_0x400c31(0xda3)][_0x400c31(0xa3b)](_0x31417b=>_0x227896(_0x1e2f12,_0x31417b))[_0x400c31(0x809)]('、\x20'):_0x400c31(0x1343)+_0x1e2f12[_0x400c31(0x609)];return{'role':_0x400c31(0x586),'content':_0x55caa1+_0x400c31(0x12f4)+_0x6d376a+_0x400c31(0xf1f)+_0x52363d+']'};}}if(_0x4d73ad['meaning'])return{'role':_0x400c31(0x586),'content':_0x55caa1+_0x400c31(0x478)+_0x4d73ad[_0x400c31(0x1b3)]+'\x27]'};return{'role':_0x4d73ad[_0x400c31(0x7fd)],'content':_0x55caa1+_0x353130};}else{if(_0x4d73ad['role']===_0x400c31(0x1a7)){let _0x5ba229={'type':_0x4d73ad[_0x400c31(0x12d9)]||_0x400c31(0xbb7)};if(_0x4d73ad[_0x400c31(0x12d9)]===_0x400c31(0x83e))_0x5ba229[_0x400c31(0x11be)]=_0x4d73ad[_0x400c31(0x53b)],_0x5ba229[_0x400c31(0x1b3)]=_0x4d73ad[_0x400c31(0x1b3)];else{if(_0x4d73ad[_0x400c31(0x12d9)]==='transfer')_0x5ba229['amount']=_0x4d73ad[_0x400c31(0x212)],_0x5ba229[_0x400c31(0x490)]=_0x4d73ad[_0x400c31(0x490)];else _0x4d73ad['type']===_0x400c31(0x12d4)?(_0x5ba229[_0x400c31(0xde1)]=_0x4d73ad[_0x400c31(0xde1)],_0x5ba229[_0x400c31(0x212)]=_0x4d73ad[_0x400c31(0x212)]):_0x4d73ad[_0x400c31(0xa19)]?_0x5ba229[_0x400c31(0xb43)]={'target_sender':_0x4d73ad[_0x400c31(0xa19)][_0x400c31(0xac4)],'target_content':_0x4d73ad[_0x400c31(0xa19)][_0x400c31(0x53b)],'reply_content':_0x4d73ad['content']}:_0x5ba229[_0x400c31(0x53b)]=_0x4d73ad[_0x400c31(0x53b)];}const _0x108af1=JSON['stringify']([_0x5ba229]);return{'role':_0x400c31(0x1a7),'content':_0x400c31(0x34f)+_0x4d73ad[_0x400c31(0x6b5)]+')\x20'+_0x108af1};}}return null;})['filter'](Boolean);if(!_0x1e2f12[_0x598b16(0x11e4)]&&_0x1e2f12[_0x598b16(0x36f)]?.[_0x598b16(0xebd)]==='pending_ai_approval'){const _0x3ec6a3=_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x401)](_0x2e098e=>!_0x2e098e[_0x598b16(0xc62)])[_0x598b16(0x1044)](-0xa)['map'](_0x5602d1=>{const _0x5d0399=_0x598b16,_0x37803b=_0x5602d1[_0x5d0399(0x7fd)]===_0x5d0399(0x586)?'用户':_0x1e2f12[_0x5d0399(0x609)];return _0x37803b+':\x20'+String(_0x5602d1[_0x5d0399(0x53b)])[_0x5d0399(0xc34)](0x0,0x32)+_0x5d0399(0xf66);})['join']('\x0a'),_0x597be8={'role':_0x598b16(0x586),'content':_0x598b16(0x1252)+_0x1e2f12[_0x598b16(0x36f)]['applicationReason']+_0x598b16(0xb69)+_0x3ec6a3+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20'};_0x116b77['push'](_0x597be8);}}}let _0x504276=_0x5af674===GEMINI_API_URL,_0x4db27c=_0x2e5c04(_0x17cff9,_0x5bbfde,_0x1ecfc5,_0x116b77),_0x2fb8dc;try{_0x2fb8dc=_0x504276?await fetch(_0x4db27c[_0x598b16(0x11be)],_0x4db27c[_0x598b16(0x100d)]):await fetch(_0x5af674+_0x598b16(0x1090),{'method':_0x598b16(0x116f),'headers':{'Content-Type':_0x598b16(0x698),'Authorization':_0x598b16(0x84a)+_0x5bbfde},'body':JSON[_0x598b16(0xf1e)]({'model':_0x17cff9,'messages':[{'role':_0x598b16(0xb64),'content':_0x1ecfc5},..._0x116b77],'temperature':_0x9ebf46[_0x598b16(0x1383)]['apiTemperature']||0.8,'stream':![]})});}catch(_0x136e0c){throw new Error(_0x598b16(0x99d)+_0x136e0c[_0x598b16(0x86e)]);}if(!_0x2fb8dc['ok']){let _0x3648f3='API\x20返回错误:\x20'+_0x2fb8dc[_0x598b16(0xebd)]+'\x20'+_0x2fb8dc[_0x598b16(0x399)];try{const _0x427ad6=await _0x2fb8dc['json']();_0x427ad6[_0x598b16(0x1221)]&&_0x427ad6['error']['message']?_0x3648f3+=_0x598b16(0x23e)+_0x427ad6[_0x598b16(0x1221)]['message']:_0x3648f3+=_0x598b16(0x23e)+JSON[_0x598b16(0xf1e)](_0x427ad6);}catch(_0x310624){_0x3648f3+=_0x598b16(0x1158)+await _0x2fb8dc[_0x598b16(0xbb7)]();}throw new Error(_0x3648f3);}const _0x419aa8=await _0x2fb8dc['json'](),_0x2e2a1a=getGeminiResponseText(_0x419aa8);lastRawAiResponse=_0x2e2a1a,lastResponseTimestamps=[],_0x1e2f12['history']=_0x1e2f12['history'][_0x598b16(0x401)](_0x3dce54=>!_0x3dce54[_0x598b16(0x386)]);const _0x2b8201=_0x169d92(_0x2e2a1a);let _0x7bed55=[];if(_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0x95b)]){let _0x33a88e={'content':[],'dialogue':[],'description':[]};for(const _0x35210b of _0x2b8201){if(_0x35210b[_0x598b16(0x12d9)]===_0x598b16(0xc91)){if(_0x35210b[_0x598b16(0x53b)])_0x33a88e['content'][_0x598b16(0x668)](_0x35210b[_0x598b16(0x53b)]);else{if(_0x35210b[_0x598b16(0xc2e)])_0x33a88e['dialogue'][_0x598b16(0x668)](_0x35210b[_0x598b16(0xc2e)]);if(_0x35210b[_0x598b16(0x1387)])_0x33a88e[_0x598b16(0x1387)]['push'](_0x35210b[_0x598b16(0x1387)]);}}else(_0x33a88e[_0x598b16(0x53b)]['length']>0x0||_0x33a88e['dialogue'][_0x598b16(0xa06)]>0x0||_0x33a88e[_0x598b16(0x1387)]['length']>0x0)&&(_0x33a88e['content']['length']>0x0&&_0x7bed55['push']({'type':_0x598b16(0xc91),'content':_0x33a88e[_0x598b16(0x53b)][_0x598b16(0x809)]('\x0a')}),(_0x33a88e[_0x598b16(0xc2e)]['length']>0x0||_0x33a88e['description'][_0x598b16(0xa06)]>0x0)&&_0x7bed55[_0x598b16(0x668)]({'type':_0x598b16(0xc91),'dialogue':_0x33a88e[_0x598b16(0xc2e)][_0x598b16(0x809)]('\x0a'),'description':_0x33a88e['description'][_0x598b16(0x809)]('\x0a')}),_0x33a88e={'content':[],'dialogue':[],'description':[]}),_0x7bed55[_0x598b16(0x668)](_0x35210b);}_0x33a88e[_0x598b16(0x53b)][_0x598b16(0xa06)]>0x0&&_0x7bed55['push']({'type':_0x598b16(0xc91),'content':_0x33a88e[_0x598b16(0x53b)][_0x598b16(0x809)]('\x0a')}),(_0x33a88e[_0x598b16(0xc2e)][_0x598b16(0xa06)]>0x0||_0x33a88e[_0x598b16(0x1387)]['length']>0x0)&&_0x7bed55['push']({'type':'offline_text','dialogue':_0x33a88e[_0x598b16(0xc2e)][_0x598b16(0x809)]('\x0a'),'description':_0x33a88e[_0x598b16(0x1387)][_0x598b16(0x809)]('\x0a')});}else _0x7bed55=_0x2b8201;const _0x227166=_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x401)](_0x3368ca=>_0x3368ca[_0x598b16(0x7fd)]===_0x598b16(0x586)&&!_0x3368ca[_0x598b16(0xc62)])['pop']();if(_0x227166&&Array[_0x598b16(0xb27)](_0x227166[_0x598b16(0x53b)])&&_0x227166[_0x598b16(0x53b)][0x0]?.[_0x598b16(0x12d9)]==='image_url'&&!_0x227166[_0x598b16(0xa2b)]){const _0x2d1e5e=_0x2b8201['find'](_0x1c63d3=>_0x1c63d3[_0x598b16(0x12d9)]===_0x598b16(0xbb7));let _0x15407d;_0x2d1e5e&&(_0x2d1e5e[_0x598b16(0x53b)]||_0x2d1e5e['message'])?_0x15407d=String(_0x2d1e5e[_0x598b16(0x53b)]||_0x2d1e5e[_0x598b16(0x86e)])[_0x598b16(0x3f1)]():_0x15407d=_0x598b16(0x314);const _0x8dc8dc=_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x684)](_0x22e677=>_0x22e677[_0x598b16(0x6b5)]===_0x227166[_0x598b16(0x6b5)]);if(_0x8dc8dc>-0x1){console[_0x598b16(0x283)](_0x598b16(0x1a0)+_0x227166[_0x598b16(0x6b5)]+_0x598b16(0x969));const _0x5debb8=_0x598b16(0x2e6)+_0x15407d+'”]';_0x1e2f12[_0x598b16(0x8b3)][_0x8dc8dc][_0x598b16(0x53b)]=_0x5debb8,_0x1e2f12[_0x598b16(0x8b3)][_0x8dc8dc]['imageProcessed']=!![],_0x1e2f12[_0x598b16(0x8b3)][_0x8dc8dc][_0x598b16(0x12d9)]='text';}}const _0x32a015=document[_0x598b16(0x9c8)](_0x598b16(0x504))[_0x598b16(0x575)][_0x598b16(0x1038)]('active')&&_0x9ebf46[_0x598b16(0x970)]===_0x14346e;let _0x338129=![],_0xbd3f38=Date[_0x598b16(0x9b7)](),_0x42bb7d=[],_0x547db0=![];for(const _0x456d8f of _0x7bed55){_0x1e2f12['settings'][_0x598b16(0xd80)]!==![]&&_0x456d8f[_0x598b16(0x12d9)]==='text'&&typeof _0x456d8f['content']===_0x598b16(0xe56)&&_0x456d8f[_0x598b16(0x53b)][_0x598b16(0x3f1)]()['startsWith'](_0x598b16(0x12d8))&&(_0x456d8f['type']=_0x598b16(0x10c1),_0x456d8f[_0x598b16(0x53b)]=_0x456d8f[_0x598b16(0x53b)][_0x598b16(0x459)](_0x598b16(0x12d8),'')[_0x598b16(0x3f1)]());if(_0x1e2f12[_0x598b16(0x11e4)]&&_0x456d8f[_0x598b16(0x609)]&&_0x456d8f['name']===_0x1e2f12[_0x598b16(0x609)]){console['error']('AI幻觉已被拦截！试图使用群名\x20(\x22'+_0x1e2f12['name']+_0x598b16(0x11ad),_0x456d8f);continue;}if(!_0x456d8f||typeof _0x456d8f!=='object'){console[_0x598b16(0x453)](_0x598b16(0x57a),_0x456d8f);continue;}if(!_0x456d8f['type']){if(_0x1e2f12['isGroup']&&_0x456d8f[_0x598b16(0x609)]&&_0x456d8f[_0x598b16(0x86e)])_0x456d8f['type']=_0x598b16(0xbb7);else{if(_0x456d8f['content'])_0x456d8f[_0x598b16(0x12d9)]=_0x598b16(0xbb7);else{console[_0x598b16(0x453)](_0x598b16(0x132c),_0x456d8f);continue;}}}if(_0x456d8f['type']==='video_call_response'){_0x3085d5[_0x598b16(0x683)]=![];if(_0x456d8f[_0x598b16(0x91c)]==='accept')_0x5ab059();else{const _0xe04ae6={'role':_0x598b16(0x1a7),'content':_0x598b16(0xaf0),'timestamp':Date[_0x598b16(0x9b7)]()};_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x668)](_0xe04ae6),await _0x2c5bcf[_0x598b16(0x547)][_0x598b16(0xff5)](_0x1e2f12),_0xe5834e('chat-interface-screen'),_0x1a44b1(_0x14346e);}_0x338129=!![];break;}if(_0x456d8f[_0x598b16(0x12d9)]===_0x598b16(0xe46)){if(_0x456d8f[_0x598b16(0x91c)]===_0x598b16(0x809)){const _0x22bd0d=_0x1e2f12[_0x598b16(0xd3e)][_0x598b16(0xfc3)](_0x39ce15=>_0x39ce15['originalName']===_0x456d8f[_0x598b16(0x609)]);_0x22bd0d&&!_0x3085d5[_0x598b16(0x1189)][_0x598b16(0x10b2)](_0x57fcc2=>_0x57fcc2['id']===_0x22bd0d['id'])&&_0x3085d5['participants'][_0x598b16(0x668)](_0x22bd0d);}_0x338129=!![];continue;}if(_0x1e2f12[_0x598b16(0x11e4)]&&_0x456d8f['name']&&_0x456d8f[_0x598b16(0x609)]===_0x1e2f12['name']){console[_0x598b16(0x1221)](_0x598b16(0xcda)+_0x1e2f12[_0x598b16(0x609)]+'\x22)\x20作为角色名。消息内容:',_0x456d8f);continue;}if(_0x1e2f12[_0x598b16(0x11e4)]&&!_0x456d8f[_0x598b16(0x609)]){console[_0x598b16(0x1221)](_0x598b16(0xfca),_0x456d8f);continue;}let _0x4e2d38=null;const _0x5e54c5=_0xbd3f38++,_0x3c5c81={'role':_0x598b16(0x1a7),'senderName':_0x456d8f['name']||_0x1e2f12[_0x598b16(0x609)],'timestamp':_0x5e54c5};lastResponseTimestamps[_0x598b16(0x668)](_0x5e54c5);switch(_0x456d8f[_0x598b16(0x12d9)]){case _0x598b16(0x234):if(!_0x1e2f12[_0x598b16(0x11e4)]){_0x456d8f[_0x598b16(0x39f)]&&(_0x1e2f12[_0x598b16(0x1291)]=String(_0x456d8f[_0x598b16(0x39f)]));_0x456d8f[_0x598b16(0xb98)]&&(_0x1e2f12[_0x598b16(0xa1a)]=String(_0x456d8f[_0x598b16(0xb98)]));!Array[_0x598b16(0xb27)](_0x1e2f12[_0x598b16(0xec6)])&&(_0x1e2f12[_0x598b16(0xec6)]=[]);_0x1e2f12[_0x598b16(0xec6)]['push']({'heartfeltVoice':_0x1e2f12[_0x598b16(0x1291)],'randomJottings':_0x1e2f12['randomJottings'],'timestamp':Date[_0x598b16(0x9b7)]()});_0x1e2f12[_0x598b16(0xec6)][_0x598b16(0xa06)]>0x32&&_0x1e2f12[_0x598b16(0xec6)][_0x598b16(0xd6e)]();const _0x26a52c=_0x598b16(0x74a)+_0x1e2f12[_0x598b16(0x1291)]+'\x0a-\x20散记:\x20'+_0x1e2f12[_0x598b16(0xa1a)],_0x24640a={'role':'system','content':_0x26a52c,'timestamp':Date['now'](),'isHidden':!![]};}continue;case _0x598b16(0xfb0):if(!_0x1e2f12[_0x598b16(0x11e4)]&&_0x456d8f[_0x598b16(0x1261)]){const _0x58d02f=_0x456d8f['new_name']['trim']();if(_0x58d02f){_0x1e2f12[_0x598b16(0x1131)]['myNickname']=_0x58d02f;const _0x30c46f={'role':_0x598b16(0xb64),'type':'pat_message','content':'“'+_0x1e2f12[_0x598b16(0x609)]+_0x598b16(0x133f)+_0x58d02f+'”','timestamp':_0xbd3f38++};_0x1e2f12[_0x598b16(0x8b3)]['push'](_0x30c46f);const _0x5928c2={'role':_0x598b16(0xb64),'content':'[系统提示：你刚刚成功将对用户的称呼修改为了“'+_0x58d02f+_0x598b16(0xa23),'timestamp':_0xbd3f38++,'isHidden':!![]};_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x668)](_0x5928c2),_0x32a015&&_0xc4e879(_0x30c46f,_0x1e2f12);}}continue;case'change_remark_name':if(!_0x1e2f12['isGroup']&&_0x456d8f['new_name']){const _0x46b98c=_0x1e2f12['name'],_0x53bed0=_0x456d8f['new_name'][_0x598b16(0x3f1)]();if(_0x53bed0&&_0x53bed0!==_0x46b98c){!_0x1e2f12[_0x598b16(0xd4f)]&&(_0x1e2f12[_0x598b16(0xd4f)]=[]);!_0x1e2f12[_0x598b16(0xd4f)][_0x598b16(0x930)](_0x46b98c)&&_0x1e2f12[_0x598b16(0xd4f)][_0x598b16(0x668)](_0x46b98c);_0x1e2f12['name']=_0x53bed0;const _0x13aae5={'role':_0x598b16(0xb64),'type':'pat_message','content':'“'+_0x1e2f12[_0x598b16(0x1071)]+'”\x20将备注修改为\x20“'+_0x53bed0+'”','timestamp':_0xbd3f38++};_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x668)](_0x13aae5);const _0x589036={'role':'system','content':_0x598b16(0xb05)+_0x53bed0+_0x598b16(0x107a),'timestamp':_0xbd3f38++,'isHidden':!![]};_0x1e2f12['history'][_0x598b16(0x668)](_0x589036),_0x32a015&&(_0xc4e879(_0x13aae5,_0x1e2f12),document[_0x598b16(0x9c8)](_0x598b16(0x117c))['textContent']=_0x53bed0),await _0x5eaa16(_0x1e2f12);}}continue;case _0x598b16(0xe54):{const _0x4b2903=_0x456d8f['name'],_0x52bd08=_0x1e2f12[_0x598b16(0x1131)]['aiAvatarLibrary']['find'](_0x453e8a=>_0x453e8a[_0x598b16(0x609)]===_0x4b2903);if(_0x52bd08){_0x1e2f12[_0x598b16(0x1131)]['aiAvatar']=_0x52bd08[_0x598b16(0x11be)];const _0x52f852={'role':_0x598b16(0xb64),'type':'pat_message','content':'['+_0x1e2f12[_0x598b16(0x609)]+_0x598b16(0x10a1),'timestamp':Date[_0x598b16(0x9b7)]()};_0x1e2f12[_0x598b16(0x8b3)]['push'](_0x52f852),await _0x177091(_0x1e2f12),_0x32a015&&(_0xc4e879(_0x52f852,_0x1e2f12),_0x1a44b1(_0x14346e));}continue;}case _0x598b16(0xa39):{const _0x226313=_0x456d8f[_0x598b16(0x609)],_0x10da89=_0x1e2f12[_0x598b16(0x1131)]['myAvatarLibrary']['find'](_0x4dddde=>_0x4dddde['name']===_0x226313);if(_0x10da89){_0x1e2f12['settings'][_0x598b16(0xb60)]=_0x10da89[_0x598b16(0x11be)];const _0x3b2e34={'role':'system','type':_0x598b16(0x13a8),'content':'['+_0x1e2f12[_0x598b16(0x609)]+_0x598b16(0x588),'timestamp':Date[_0x598b16(0x9b7)]()};_0x1e2f12['history'][_0x598b16(0x668)](_0x3b2e34),_0x32a015&&(_0xc4e879(_0x3b2e34,_0x1e2f12),_0x1a44b1(_0x14346e));}continue;}case _0x598b16(0x82d):{const _0x3d0ced=parseInt(_0x456d8f['x']),_0x3d0d21=parseInt(_0x456d8f['y']);!isNaN(_0x3d0ced)&&!isNaN(_0x3d0d21)?_0x3a7522({'x':_0x3d0ced,'y':_0x3d0d21}):console[_0x598b16(0x453)]('AI的五子棋移动指令包含无效坐标，已忽略:',_0x456d8f);continue;}case _0x598b16(0x737):const _0x289524=_0x1e2f12['history'][_0x598b16(0x684)](_0x1d4e75=>_0x1d4e75[_0x598b16(0x6b5)]===_0x456d8f['for_timestamp']);if(_0x289524>-0x1){const _0x4a1593=_0x1e2f12[_0x598b16(0x8b3)][_0x289524];_0x4a1593[_0x598b16(0xebd)]=_0x456d8f['status'],_0x4a1593[_0x598b16(0xec2)]=_0x456d8f[_0x598b16(0xebd)]==='paid'?_0x456d8f['name']:null;}continue;case _0x598b16(0x411):const _0x3045b5={'type':_0x456d8f[_0x598b16(0x128c)],'content':_0x456d8f[_0x598b16(0x53b)]||'','publicText':_0x456d8f[_0x598b16(0x7b2)]||'','hiddenContent':_0x456d8f[_0x598b16(0x841)]||'','image_prompt':_0x456d8f['image_prompt']||'','timestamp':Date[_0x598b16(0x9b7)](),'authorId':_0x14346e,'authorGroupId':_0x1e2f12[_0x598b16(0x7b1)],'visibleGroupIds':null};if(_0x456d8f['postType']===_0x598b16(0x1227)&&_0x456d8f['prompt'])try{const _0x55b585=Array[_0x598b16(0xb27)](_0x456d8f['prompt'])?_0x456d8f[_0x598b16(0xd34)]['slice'](0x0,0x2):[_0x456d8f['prompt']];console['log'](_0x598b16(0x3d8)+_0x55b585['length']+_0x598b16(0xaf6));const _0x181578=[];for(let _0x508f8=0x0;_0x508f8<_0x55b585['length'];_0x508f8++){const _0x4694c6=_0x55b585[_0x508f8];console[_0x598b16(0x283)](_0x598b16(0xadf)+(_0x508f8+0x1)+_0x598b16(0x7fa),_0x4694c6);const _0x1cc917=_0x141b22(_0x1e2f12['id']),_0x316f94=_0x4694c6+',\x20'+_0x1cc917[_0x598b16(0x707)],_0x4069e4=_0x1cc917['negative'];console[_0x598b16(0x283)](_0x598b16(0x836)+(_0x1cc917[_0x598b16(0x9c9)]===_0x598b16(0x96c)?'角色专属':'系统')+_0x598b16(0xf79)),console[_0x598b16(0x283)](_0x598b16(0x6c5),_0x316f94),console[_0x598b16(0x283)](_0x598b16(0x3ba),_0x4069e4);const _0x459ba6=localStorage[_0x598b16(0x1290)](_0x598b16(0xef8)),_0x20d011=localStorage[_0x598b16(0x1290)]('novelai-model')||_0x598b16(0x1286),_0x36f6e0=_0x462263();if(!_0x459ba6)throw new Error(_0x598b16(0x403));const [_0x19eba7,_0x2c133a]=_0x36f6e0[_0x598b16(0xc85)][_0x598b16(0x6c6)]('x')['map'](Number);let _0x7fdc71;_0x20d011['includes'](_0x598b16(0x38b))?_0x7fdc71={'input':_0x316f94,'model':_0x20d011,'action':'generate','parameters':{'params_version':0x3,'width':_0x19eba7,'height':_0x2c133a,'scale':_0x36f6e0[_0x598b16(0xb18)],'sampler':_0x36f6e0['sampler'],'steps':_0x36f6e0[_0x598b16(0x91e)],'seed':_0x36f6e0[_0x598b16(0x10f8)]===-0x1?Math['floor'](Math[_0x598b16(0x360)]()*0x2540be3ff):_0x36f6e0[_0x598b16(0x10f8)],'n_samples':0x1,'ucPreset':_0x36f6e0[_0x598b16(0x121d)],'qualityToggle':_0x36f6e0['quality_toggle'],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x598b16(0x128d),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x316f94,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x4069e4,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x4069e4,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x7fdc71={'input':_0x316f94,'model':_0x20d011,'action':_0x598b16(0x7b7),'parameters':{'width':_0x19eba7,'height':_0x2c133a,'scale':_0x36f6e0[_0x598b16(0xb18)],'sampler':_0x36f6e0['sampler'],'steps':_0x36f6e0[_0x598b16(0x91e)],'seed':_0x36f6e0[_0x598b16(0x10f8)]===-0x1?Math['floor'](Math[_0x598b16(0x360)]()*0x2540be3ff):_0x36f6e0[_0x598b16(0x10f8)],'n_samples':0x1,'ucPreset':_0x36f6e0['uc_preset'],'qualityToggle':_0x36f6e0['quality_toggle'],'sm':_0x36f6e0[_0x598b16(0x116e)],'sm_dyn':_0x36f6e0[_0x598b16(0xdec)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x598b16(0xe3c),'negative_prompt':_0x4069e4}};console[_0x598b16(0x283)]('🚀\x20发送NAI请求:',_0x7fdc71);let _0x47a14c;_0x20d011[_0x598b16(0x930)](_0x598b16(0x38b))?_0x47a14c=_0x598b16(0x354):_0x47a14c=_0x598b16(0xf0c);let _0x29c4a0=_0x36f6e0['cors_proxy'];_0x29c4a0===_0x598b16(0x13c6)&&(_0x29c4a0=_0x36f6e0['custom_proxy_url']||'');_0x29c4a0&&_0x29c4a0!==''&&(_0x47a14c=_0x29c4a0+encodeURIComponent(_0x47a14c));const _0x20a6d3=await fetch(_0x47a14c,{'method':_0x598b16(0x116f),'headers':{'Content-Type':_0x598b16(0x698),'Authorization':_0x598b16(0x84a)+_0x459ba6},'body':JSON[_0x598b16(0xf1e)](_0x7fdc71)});console[_0x598b16(0x283)](_0x598b16(0x729),_0x20a6d3['status']),console[_0x598b16(0x283)](_0x598b16(0xf9a),[..._0x20a6d3[_0x598b16(0xda4)]['entries']()]);if(!_0x20a6d3['ok']){const _0x3843fd=await _0x20a6d3[_0x598b16(0xbb7)]();console['error'](_0x598b16(0xf60),_0x3843fd);throw new Error(_0x598b16(0xafa)+_0x20a6d3['status']+'):\x20'+_0x3843fd);}const _0x4784ad=_0x20a6d3[_0x598b16(0xda4)][_0x598b16(0xdf9)](_0x598b16(0xd53));console[_0x598b16(0x283)](_0x598b16(0x2af),_0x4784ad);let _0x1ee1c6,_0x14391d;if(_0x4784ad&&_0x4784ad[_0x598b16(0x930)](_0x598b16(0xb46))){console[_0x598b16(0x283)](_0x598b16(0x250));const _0x347bee=await _0x20a6d3[_0x598b16(0xbb7)]();console['log'](_0x598b16(0xa60),_0x347bee['length']);const _0x3b2538=_0x347bee[_0x598b16(0x3f1)]()[_0x598b16(0x6c6)]('\x0a');let _0x4fcf1f=null;for(let _0x256ff4=_0x3b2538['length']-0x1;_0x256ff4>=0x0;_0x256ff4--){const _0x166b1b=_0x3b2538[_0x256ff4][_0x598b16(0x3f1)]();if(_0x166b1b['startsWith'](_0x598b16(0xd78))&&_0x166b1b!==_0x598b16(0x128a)){const _0x37d496=_0x166b1b[_0x598b16(0xc34)](0x6);try{const _0x460a2e=JSON[_0x598b16(0x907)](_0x37d496);if(_0x460a2e[_0x598b16(0x119c)]===_0x598b16(0x1313)&&_0x460a2e['image']){_0x4fcf1f=_0x460a2e[_0x598b16(0x10eb)],console['log'](_0x598b16(0xd06));break;}if(_0x460a2e['data']){_0x4fcf1f=_0x460a2e['data'],console['log']('从\x20JSON.data\x20中提取图片数据');break;}if(_0x460a2e[_0x598b16(0x10eb)]){_0x4fcf1f=_0x460a2e['image'],console[_0x598b16(0x283)](_0x598b16(0xe16));break;}}catch(_0x429c7b){_0x4fcf1f=_0x37d496,console[_0x598b16(0x283)](_0x598b16(0xab2));break;}}}if(!_0x4fcf1f)throw new Error(_0x598b16(0xa07));const _0x1ed3f0=_0x4fcf1f[_0x598b16(0xc8d)]('iVBORw0KGgo'),_0x3ade8e=_0x4fcf1f['startsWith'](_0x598b16(0xf09));if(_0x1ed3f0||_0x3ade8e){console[_0x598b16(0x283)](_0x598b16(0xc0b));const _0x3cf39=atob(_0x4fcf1f),_0xf3c0b7=new Uint8Array(_0x3cf39[_0x598b16(0xa06)]);for(let _0x3df2db=0x0;_0x3df2db<_0x3cf39[_0x598b16(0xa06)];_0x3df2db++){_0xf3c0b7[_0x3df2db]=_0x3cf39[_0x598b16(0xf76)](_0x3df2db);}const _0x55cad8=new Blob([_0xf3c0b7],{'type':_0x1ed3f0?'image/png':_0x598b16(0xc82)});console[_0x598b16(0x283)](_0x598b16(0xa09),_0x55cad8[_0x598b16(0xa67)]);const _0x5c62a9=new FileReader();_0x14391d=await new Promise((_0x2985f9,_0x594ba9)=>{const _0x1d5021=_0x598b16;_0x5c62a9[_0x1d5021(0x9b9)]=()=>_0x2985f9(_0x5c62a9[_0x1d5021(0xceb)]),_0x5c62a9['onerror']=_0x594ba9,_0x5c62a9[_0x1d5021(0xba5)](_0x55cad8);}),console[_0x598b16(0x283)](_0x598b16(0x10bc));}else{console[_0x598b16(0x283)]('当作\x20ZIP\x20文件处理...');const _0x3eb148=atob(_0x4fcf1f),_0x1cfa15=new Uint8Array(_0x3eb148[_0x598b16(0xa06)]);for(let _0x592ce2=0x0;_0x592ce2<_0x3eb148[_0x598b16(0xa06)];_0x592ce2++){_0x1cfa15[_0x592ce2]=_0x3eb148['charCodeAt'](_0x592ce2);}_0x1ee1c6=new Blob([_0x1cfa15]),console[_0x598b16(0x283)](_0x598b16(0x4f6),_0x1ee1c6['size']);}}else _0x1ee1c6=await _0x20a6d3[_0x598b16(0xa6e)](),console[_0x598b16(0x283)]('收到数据，类型:',_0x1ee1c6['type'],_0x598b16(0xb10),_0x1ee1c6[_0x598b16(0xa67)]);if(!_0x14391d&&_0x1ee1c6)try{if(typeof JSZip===_0x598b16(0xa20))throw new Error('JSZip库未加载，请刷新页面重试');const _0x4356ef=await JSZip[_0x598b16(0x8f9)](_0x1ee1c6);console[_0x598b16(0x283)]('ZIP文件内容:',Object['keys'](_0x4356ef['files']));let _0xe155f4=null;for(let _0x5f515c in _0x4356ef[_0x598b16(0x1216)]){if(_0x5f515c[_0x598b16(0x12c2)](/\.(png|jpg|jpeg|webp)$/i)){_0xe155f4=_0x4356ef['files'][_0x5f515c],console['log'](_0x598b16(0xe04),_0x5f515c);break;}}if(!_0xe155f4)throw new Error(_0x598b16(0x1224));const _0x59f5a9=await _0xe155f4['async'](_0x598b16(0xa6e));console[_0x598b16(0x283)](_0x598b16(0x7dd),_0x59f5a9[_0x598b16(0xa67)]);const _0x1a6a30=new FileReader();_0x14391d=await new Promise((_0x4d2749,_0x209872)=>{const _0x58dafb=_0x598b16;_0x1a6a30[_0x58dafb(0x9b9)]=()=>_0x4d2749(_0x1a6a30[_0x58dafb(0xceb)]),_0x1a6a30[_0x58dafb(0x11e5)]=_0x209872,_0x1a6a30[_0x58dafb(0xba5)](_0x59f5a9);}),console['log'](_0x598b16(0x887));}catch(_0x5e6f67){console['error'](_0x598b16(0xccf),_0x5e6f67);throw new Error(_0x598b16(0x1b8)+_0x5e6f67[_0x598b16(0x86e)]);}console['log']('✅\x20NAI图片'+(_0x508f8+0x1)+_0x598b16(0xadd)),_0x181578[_0x598b16(0x668)](_0x14391d);}_0x3045b5[_0x598b16(0xc76)]=_0x181578,_0x181578['length']===0x1&&(_0x3045b5['imageUrl']=_0x181578[0x0]),_0x3045b5[_0x598b16(0xd34)]=_0x456d8f['prompt'],_0x3045b5[_0x598b16(0x4fa)]=_0x181578['length'],console[_0x598b16(0x283)](_0x598b16(0xee4)+_0x181578['length']+'张');}catch(_0x52e28e){console[_0x598b16(0x1221)](_0x598b16(0x1374),_0x52e28e),_0x3045b5[_0x598b16(0x53b)]=(_0x3045b5['content']||_0x3045b5['publicText']||'')+('\x0a[图片生成失败:\x20'+_0x52e28e['message']+']');}await _0x2c5bcf[_0x598b16(0x75f)][_0x598b16(0x68e)](_0x3045b5),_0xddb60e(_0x776068+0x1);_0x32a015&&document[_0x598b16(0x9c8)](_0x598b16(0x81c))['classList']['contains']('active')&&await _0x2c70a9();continue;case _0x598b16(0xc6d):{const _0x844946=await _0x2c5bcf['qzonePosts'][_0x598b16(0xdf9)](parseInt(_0x456d8f[_0x598b16(0xf23)]));if(_0x844946){if(!_0x844946[_0x598b16(0x1e0)])_0x844946['comments']=[];const _0x3c9094=_0x456d8f[_0x598b16(0x609)]||_0x1e2f12[_0x598b16(0x1071)],_0x1cc7df=(_0x123aa7,_0x46d18f=null,_0x578d85=null)=>({'commenterName':_0x3c9094,'text':_0x742a79(_0x123aa7,_0x1e2f12),'meaning':_0x46d18f,'replyTo':_0x578d85,'timestamp':Date['now']()});if(_0x456d8f[_0x598b16(0x1386)]){const _0x90213d=_0x9ebf46[_0x598b16(0x774)]['find'](_0x13f00e=>_0x13f00e['name']===_0x456d8f[_0x598b16(0x1386)]);_0x90213d?_0x844946['comments'][_0x598b16(0x668)](_0x1cc7df(_0x90213d[_0x598b16(0x11be)],_0x90213d[_0x598b16(0x609)],_0x456d8f[_0x598b16(0x6ff)]||null)):(console[_0x598b16(0x453)](_0x598b16(0x9fb)+_0x456d8f[_0x598b16(0x1386)]+'\x22'),_0x844946[_0x598b16(0x1e0)]['push'](_0x1cc7df(_0x598b16(0xef0)+_0x456d8f[_0x598b16(0x1386)]+']',null,_0x456d8f[_0x598b16(0x6ff)]||null)));}else{if(Array['isArray'](_0x456d8f[_0x598b16(0x1e0)]))_0x456d8f[_0x598b16(0x1e0)][_0x598b16(0x591)](_0x2a4af1=>{const _0x198c61=_0x598b16;typeof _0x2a4af1===_0x198c61(0xe56)&&_0x2a4af1[_0x198c61(0x3f1)]()&&_0x844946[_0x198c61(0x1e0)][_0x198c61(0x668)](_0x1cc7df(_0x2a4af1,null,_0x456d8f[_0x198c61(0x6ff)]||null));});else typeof _0x456d8f[_0x598b16(0x60c)]===_0x598b16(0xe56)&&_0x456d8f['commentText'][_0x598b16(0x3f1)]()&&_0x844946[_0x598b16(0x1e0)][_0x598b16(0x668)](_0x1cc7df(_0x456d8f[_0x598b16(0x60c)],null,_0x456d8f[_0x598b16(0x6ff)]||null));}await _0x2c5bcf[_0x598b16(0x75f)]['update'](_0x844946['id'],{'comments':_0x844946[_0x598b16(0x1e0)]}),_0xddb60e(_0x776068+0x1),console[_0x598b16(0x283)]('后台活动:\x20角色\x20\x22'+_0x1e2f12[_0x598b16(0x609)]+_0x598b16(0x271)+_0x456d8f[_0x598b16(0xf23)]);if(!_0x1e2f12[_0x598b16(0x612)])_0x1e2f12[_0x598b16(0x612)]={};_0x1e2f12['commentCooldowns'][_0x456d8f[_0x598b16(0xf23)]]=Date['now']();}continue;}case'qzone_like':const _0x67e2c0=await _0x2c5bcf[_0x598b16(0x75f)][_0x598b16(0xdf9)](parseInt(_0x456d8f[_0x598b16(0xf23)]));if(_0x67e2c0){if(!_0x67e2c0[_0x598b16(0x315)])_0x67e2c0[_0x598b16(0x315)]=[];!_0x67e2c0[_0x598b16(0x315)][_0x598b16(0x930)](_0x1e2f12['name'])&&(_0x67e2c0['likes']['push'](_0x1e2f12['name']),await _0x2c5bcf[_0x598b16(0x75f)][_0x598b16(0x13a4)](_0x67e2c0['id'],{'likes':_0x67e2c0[_0x598b16(0x315)]}),_0xddb60e(_0x776068+0x1),_0x32a015&&document[_0x598b16(0x9c8)]('qzone-screen')[_0x598b16(0x575)][_0x598b16(0x1038)](_0x598b16(0x113d))&&await _0x2c70a9());}continue;case _0x598b16(0x75b):{const _0x16be06=await _0x2c5bcf[_0x598b16(0x75f)]['get'](parseInt(_0x456d8f['postId']));if(_0x16be06){const _0x237deb={'type':_0x598b16(0x75b),'timestamp':Date[_0x598b16(0x9b7)](),'authorId':_0x14346e,'authorGroupId':_0x1e2f12['groupId'],'repostComment':_0x456d8f[_0x598b16(0x10de)]||'','originalPost':_0x16be06,'visibleGroupIds':null};await _0x2c5bcf[_0x598b16(0x75f)][_0x598b16(0x68e)](_0x237deb),_0xddb60e(_0x776068+0x1),console['log'](_0x598b16(0x1078)+_0x1e2f12[_0x598b16(0x609)]+'\x22\x20转发了动态\x20#'+_0x456d8f['postId']);}continue;}case _0x598b16(0x8fc):!_0x3085d5[_0x598b16(0x103f)]&&!_0x3085d5[_0x598b16(0x683)]&&(_0x9ebf46[_0x598b16(0x970)]=_0x14346e,_0x3085d5['activeChatId']=_0x14346e,_0x3085d5[_0x598b16(0x683)]=!![],_0x3085d5[_0x598b16(0x106c)]=_0x1e2f12[_0x598b16(0x11e4)],_0x3085d5[_0x598b16(0x1183)]=_0x456d8f['name']||_0x1e2f12[_0x598b16(0x609)],_0x2762f6());continue;case _0x598b16(0x28e):!_0x3085d5[_0x598b16(0x103f)]&&!_0x3085d5['isAwaitingResponse']&&(_0x9ebf46[_0x598b16(0x970)]=_0x14346e,_0x3085d5[_0x598b16(0x683)]=!![],_0x3085d5[_0x598b16(0x106c)]=!![],_0x3085d5['initiator']='ai',_0x3085d5[_0x598b16(0x1183)]=_0x456d8f[_0x598b16(0x609)],_0x2762f6());continue;case'pat_user':let _0x2120ea;if(_0x1e2f12['isGroup']){const _0x5f6039=_0x1e2f12[_0x598b16(0xd3e)][_0x598b16(0xfc3)](_0x438acb=>_0x438acb['originalName']===_0x456d8f[_0x598b16(0x609)]);_0x2120ea=_0x5f6039?_0x5f6039[_0x598b16(0x1132)]:_0x456d8f[_0x598b16(0x609)];}else _0x2120ea=_0x1e2f12[_0x598b16(0x609)];const _0x5ece1e=_0x456d8f[_0x598b16(0x87a)]?'\x20'+_0x456d8f[_0x598b16(0x87a)][_0x598b16(0x3f1)]():'',_0x1ac341=_0x2120ea+'\x20拍了拍我'+_0x5ece1e,_0x52af50={'role':_0x598b16(0xb64),'type':_0x598b16(0x13a8),'content':_0x1ac341,'timestamp':Date[_0x598b16(0x9b7)]()};_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x668)](_0x52af50);if(_0x32a015){const _0x954d3c=document[_0x598b16(0x9c8)](_0x598b16(0x6fb));_0x954d3c[_0x598b16(0x575)][_0x598b16(0x30f)](_0x598b16(0x85b)),void _0x954d3c[_0x598b16(0x138e)],_0x954d3c[_0x598b16(0x575)][_0x598b16(0x68e)](_0x598b16(0x85b)),setTimeout(()=>_0x954d3c[_0x598b16(0x575)][_0x598b16(0x30f)]('pat-animation'),0x1f4),_0xc4e879(_0x52af50,_0x1e2f12);}else _0x52c10d(_0x14346e,_0x1ac341);continue;case _0x598b16(0xff8):_0x1e2f12[_0x598b16(0xebd)][_0x598b16(0xbb7)]=_0x456d8f[_0x598b16(0xcf1)],_0x1e2f12[_0x598b16(0xebd)][_0x598b16(0xf22)]=_0x456d8f[_0x598b16(0x1390)]||![],_0x1e2f12[_0x598b16(0xebd)]['lastUpdate']=Date[_0x598b16(0x9b7)]();const _0x5a03e4={'role':_0x598b16(0xb64),'type':_0x598b16(0x13a8),'content':'['+_0x1e2f12[_0x598b16(0x609)]+_0x598b16(0x29b)+_0x456d8f[_0x598b16(0xcf1)]+']','timestamp':Date[_0x598b16(0x9b7)]()};_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x668)](_0x5a03e4);_0x32a015&&_0xc4e879(_0x5a03e4,_0x1e2f12);_0x394b2c();continue;case _0x598b16(0x358):_0x4e2d38={..._0x3c5c81,'type':_0x598b16(0x358),'content':_0x456d8f['content']};break;case'change_music':if(_0x5062a9[_0x598b16(0x103f)]&&_0x5062a9['activeChatId']===_0x14346e){const _0x13b4b3=_0x456d8f[_0x598b16(0xd1a)]||_0x456d8f['song']||_0x456d8f[_0x598b16(0x609)];if(typeof _0x13b4b3==='string'&&_0x13b4b3[_0x598b16(0x3f1)]()){const _0x441f70=_0x13b4b3[_0x598b16(0x459)](/^\[?\d+\]?[\s.-]*/,'')['trim'](),_0x53d793=_0x5062a9[_0x598b16(0x8e6)][_0x598b16(0x684)](_0x1ce916=>_0x1ce916[_0x598b16(0x609)][_0x598b16(0xc61)]()===_0x441f70[_0x598b16(0xc61)]());if(_0x53d793>-0x1){_0x187421(_0x53d793);const _0x430a87=_0x5062a9[_0x598b16(0x8e6)][_0x53d793];let _0x3ea6f2;if(_0x1e2f12[_0x598b16(0x11e4)]){const _0x1bc30e=_0x1e2f12[_0x598b16(0xd3e)]['find'](_0x435130=>_0x435130[_0x598b16(0x1071)]===_0x456d8f[_0x598b16(0x609)]);_0x3ea6f2=_0x1bc30e?_0x1bc30e['groupNickname']:_0x456d8f[_0x598b16(0x609)];}else _0x3ea6f2=_0x1e2f12[_0x598b16(0x609)];const _0x6ec023={'role':_0x598b16(0xb64),'type':_0x598b16(0x13a8),'content':'[♪\x20'+_0x3ea6f2+'\x20为你切歌:\x20《'+_0x430a87['name']+_0x598b16(0x244)+_0x430a87[_0x598b16(0xc14)]+']','timestamp':Date['now']()};_0x1e2f12['history'][_0x598b16(0x668)](_0x6ec023),_0x32a015&&_0xc4e879(_0x6ec023,_0x1e2f12);}else console[_0x598b16(0x453)](_0x598b16(0x9b2)+_0x13b4b3+_0x598b16(0x926)+_0x441f70+_0x598b16(0xb95));}else console[_0x598b16(0x1221)](_0x598b16(0xf36),_0x456d8f);}continue;case _0x598b16(0xb22):const _0x4ff1ca={'chatId':_0x14346e,'authorId':_0x14346e,'description':_0x456d8f[_0x598b16(0x1387)],'timestamp':Date[_0x598b16(0x9b7)](),'type':_0x598b16(0x10fc)};await _0x2c5bcf[_0x598b16(0x137e)]['add'](_0x4ff1ca),console[_0x598b16(0x283)]('AI\x20\x22'+_0x1e2f12['name']+_0x598b16(0xef6),_0x456d8f[_0x598b16(0x1387)]);continue;case _0x598b16(0xf3d):const _0x14ca23=new Date(_0x456d8f[_0x598b16(0x10cf)]);if(!isNaN(_0x14ca23)&&_0x14ca23>new Date()){const _0x128f64={'chatId':_0x14346e,'authorId':_0x14346e,'description':_0x456d8f[_0x598b16(0x9f2)],'timestamp':Date['now'](),'type':'countdown','targetDate':_0x14ca23[_0x598b16(0xb03)]()};await _0x2c5bcf[_0x598b16(0x137e)][_0x598b16(0x68e)](_0x128f64),console[_0x598b16(0x283)]('AI\x20\x22'+_0x1e2f12[_0x598b16(0x609)]+_0x598b16(0xaf7),_0x456d8f[_0x598b16(0x9f2)]);}continue;case _0x598b16(0xb7d):if(!_0x1e2f12[_0x598b16(0x11e4)]){_0x1e2f12['relationship'][_0x598b16(0xebd)]=_0x598b16(0x23d);const _0x157915={'role':_0x598b16(0xb64),'content':_0x598b16(0x7f3),'timestamp':Date['now'](),'isHidden':!![]};_0x1e2f12[_0x598b16(0x8b3)]['push'](_0x157915),await _0x2c5bcf[_0x598b16(0x547)][_0x598b16(0xff5)](_0x1e2f12);_0x32a015&&_0x1a44b1(_0x14346e);_0x394b2c();break;}continue;case _0x598b16(0x134d):!_0x1e2f12[_0x598b16(0x11e4)]&&_0x1e2f12[_0x598b16(0x36f)]?.[_0x598b16(0xebd)]===_0x598b16(0x26d)&&(_0x456d8f[_0x598b16(0x91c)]===_0x598b16(0xf8b)?(_0x1e2f12[_0x598b16(0x36f)]['status']=_0x598b16(0x733),_0x4e2d38={..._0x3c5c81,'content':_0x598b16(0x973)}):(_0x1e2f12[_0x598b16(0x36f)][_0x598b16(0xebd)]=_0x598b16(0x23d),_0x4e2d38={..._0x3c5c81,'content':_0x598b16(0x677)}),_0x1e2f12['relationship'][_0x598b16(0x1271)]='');break;case _0x598b16(0xb71):const _0x46ae2c=typeof _0x456d8f['options']===_0x598b16(0xe56)?_0x456d8f['options'][_0x598b16(0x6c6)]('\x0a')[_0x598b16(0x401)](_0x2394fa=>_0x2394fa[_0x598b16(0x3f1)]()):Array[_0x598b16(0xb27)](_0x456d8f[_0x598b16(0x5ed)])?_0x456d8f[_0x598b16(0x5ed)]:[];if(_0x46ae2c[_0x598b16(0xa06)]<0x2)continue;_0x4e2d38={..._0x3c5c81,'type':_0x598b16(0xb71),'question':_0x456d8f[_0x598b16(0x12f6)],'options':_0x46ae2c,'votes':{},'isClosed':![]};break;case _0x598b16(0x96e):{const {itemName:_0x41c067,itemPrice:_0x464745,image_prompt:_0xd5e6bc}=_0x456d8f;if(_0x41c067&&!isNaN(parseFloat(_0x464745))&&_0xd5e6bc){const _0x7fa0ed=_0x598b16(0x12d5)+encodeURIComponent(_0xd5e6bc);_0x4e2d38={..._0x3c5c81,'type':_0x598b16(0x96e),'items':[{'name':_0x41c067,'price':parseFloat(_0x464745),'imageUrl':_0x7fa0ed,'quantity':0x1}],'total':parseFloat(_0x464745),'recipients':_0x456d8f['recipients']||null};}else console[_0x598b16(0x453)]('AI\x20尝试赠送一个格式不正确的随机礼物:',_0x456d8f);break;}case _0x598b16(0xcec):const _0x26f430=_0x1e2f12['history']['find'](_0x26ffed=>_0x26ffed[_0x598b16(0x6b5)]===_0x456d8f[_0x598b16(0x10ab)]);_0x26f430&&!_0x26f430[_0x598b16(0x12b8)]&&(Object[_0x598b16(0x2bd)](_0x26f430[_0x598b16(0xe19)])[_0x598b16(0x591)](_0x3e2d01=>{const _0xd8f1d1=_0x598b16,_0x2dd861=_0x26f430[_0xd8f1d1(0xe19)][_0x3e2d01][_0xd8f1d1(0x78e)](_0x456d8f[_0xd8f1d1(0x609)]);_0x2dd861>-0x1&&_0x26f430[_0xd8f1d1(0xe19)][_0x3e2d01]['splice'](_0x2dd861,0x1);}),!_0x26f430[_0x598b16(0xe19)][_0x456d8f[_0x598b16(0xaaa)]]&&(_0x26f430[_0x598b16(0xe19)][_0x456d8f[_0x598b16(0xaaa)]]=[]),!_0x26f430['votes'][_0x456d8f['choice']]['includes'](_0x456d8f[_0x598b16(0x609)])&&_0x26f430[_0x598b16(0xe19)][_0x456d8f[_0x598b16(0xaaa)]]['push'](_0x456d8f[_0x598b16(0x609)]),_0x32a015&&_0x1a44b1(_0x14346e));continue;case _0x598b16(0xf67):_0x4e2d38={..._0x3c5c81,..._0x456d8f,'totalAmount':_0x456d8f[_0x598b16(0x212)],'claimedBy':{},'isFullyClaimed':![]};_0x456d8f[_0x598b16(0x7bd)]&&(_0x4e2d38[_0x598b16(0xc8a)]=_0x456d8f['receiver'],delete _0x4e2d38[_0x598b16(0x7bd)]);break;case _0x598b16(0x2f7):const _0x30e205=_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0xfc3)](_0x3b6d0b=>_0x3b6d0b['timestamp']===_0x456d8f[_0x598b16(0xa75)]),_0x3de3be=_0x456d8f[_0x598b16(0x609)],_0x430b08=_0x1e2f12[_0x598b16(0xd3e)][_0x598b16(0x10b2)](_0x158bbb=>_0x158bbb[_0x598b16(0x1071)]===_0x3de3be);if(!_0x430b08){console['warn'](_0x598b16(0x923)+_0x3de3be+'\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。');continue;}if(_0x30e205&&_0x30e205[_0x598b16(0x30a)]===_0x598b16(0x7b4)){if(_0x30e205[_0x598b16(0xc8a)]!==_0x456d8f[_0x598b16(0x609)]){console[_0x598b16(0x453)](_0x598b16(0x923)+_0x456d8f['name']+_0x598b16(0x931)+_0x30e205[_0x598b16(0xc8a)]+')。操作已被拦截。');continue;}}if(_0x30e205&&!_0x30e205[_0x598b16(0x11b0)]&&!(_0x30e205['claimedBy']&&_0x30e205[_0x598b16(0x1118)][_0x456d8f[_0x598b16(0x609)]])){let _0x3b8d81=0x0;const _0x14289a=_0x30e205[_0x598b16(0xc3b)]-Object['values'](_0x30e205[_0x598b16(0x1118)]||{})[_0x598b16(0x12c1)]((_0x392223,_0x4101e4)=>_0x392223+_0x4101e4,0x0),_0x5e4413=_0x30e205[_0x598b16(0x636)]-Object[_0x598b16(0x2bd)](_0x30e205[_0x598b16(0x1118)]||{})['length'];if(_0x5e4413>0x0){if(_0x30e205[_0x598b16(0x30a)]===_0x598b16(0x7b4))_0x3b8d81=_0x30e205[_0x598b16(0xc3b)];else{if(_0x5e4413===0x1)_0x3b8d81=_0x14289a;else{const _0x47f98f=0.01,_0x5f113d=_0x14289a-(_0x5e4413-0x1)*_0x47f98f;_0x3b8d81=Math[_0x598b16(0x360)]()*(_0x5f113d-_0x47f98f)+_0x47f98f;}}_0x3b8d81=parseFloat(_0x3b8d81[_0x598b16(0x752)](0x2));if(!_0x30e205['claimedBy'])_0x30e205[_0x598b16(0x1118)]={};_0x30e205['claimedBy'][_0x456d8f[_0x598b16(0x609)]]=_0x3b8d81;const _0x3a9aeb=_0x1e2f12['members'][_0x598b16(0xfc3)](_0x4d0704=>_0x4d0704[_0x598b16(0x1071)]===_0x456d8f['name']),_0x1d0b71=_0x3a9aeb?_0x3a9aeb[_0x598b16(0x1132)]:_0x456d8f[_0x598b16(0x609)],_0x1bb882=_0x227896(_0x1e2f12,_0x30e205[_0x598b16(0xac4)]),_0x381ed6={'role':_0x598b16(0xb64),'type':'pat_message','content':_0x1d0b71+_0x598b16(0x70b)+_0x1bb882+_0x598b16(0xf43),'timestamp':Date[_0x598b16(0x9b7)]()};_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x668)](_0x381ed6);let _0x5bc3e9='[系统提示：你\x20('+_0x1d0b71+_0x598b16(0x137b)+_0x3b8d81[_0x598b16(0x752)](0x2)+_0x598b16(0x4ce);if(Object[_0x598b16(0x2bd)](_0x30e205[_0x598b16(0x1118)])['length']>=_0x30e205[_0x598b16(0x636)]){_0x30e205[_0x598b16(0x11b0)]=!![];const _0x854c50={'role':'system','type':_0x598b16(0x13a8),'content':_0x1bb882+_0x598b16(0x1096),'timestamp':Date[_0x598b16(0x9b7)]()+0x1};_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x668)](_0x854c50);let _0x440023={'name':'','amount':-0x1};_0x30e205[_0x598b16(0x30a)]==='lucky'&&_0x30e205[_0x598b16(0x636)]>0x1&&Object[_0x598b16(0x1231)](_0x30e205[_0x598b16(0x1118)])['forEach'](([_0x55ca40,_0x52c384])=>{const _0x438892=_0x598b16;_0x52c384>_0x440023[_0x438892(0x212)]&&(_0x440023={'name':_0x55ca40,'amount':_0x52c384});});if(_0x440023[_0x598b16(0x609)]){const _0x108370=_0x1e2f12[_0x598b16(0xd3e)][_0x598b16(0xfc3)](_0x91ffd7=>_0x91ffd7[_0x598b16(0x1071)]===_0x440023[_0x598b16(0x609)]),_0x4333f4=_0x108370?_0x108370['groupNickname']:_0x440023[_0x598b16(0x609)];_0x5bc3e9+=_0x598b16(0x7ab)+_0x4333f4+'！';}else _0x5bc3e9+=_0x598b16(0x9ef);}_0x5bc3e9+=_0x598b16(0x505);const _0x568301={'role':_0x598b16(0xb64),'content':_0x5bc3e9,'timestamp':Date[_0x598b16(0x9b7)]()+0x2,'isHidden':!![]};_0x1e2f12[_0x598b16(0x8b3)]['push'](_0x568301);}_0x32a015&&(_0x1a44b1(_0x14346e),_0x394b2c());}continue;case _0x598b16(0x1186):{const _0x350e52=_0x1e2f12['history'][_0x598b16(0x684)](_0x5dd532=>_0x5dd532['timestamp']===_0x456d8f['for_timestamp']);if(_0x350e52>-0x1){const _0x21ea8a=_0x1e2f12[_0x598b16(0x8b3)][_0x350e52];_0x21ea8a[_0x598b16(0xebd)]='accepted';}continue;}case _0x598b16(0x1195):{const _0x2a9607=_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x684)](_0x374db7=>_0x374db7[_0x598b16(0x6b5)]===_0x456d8f[_0x598b16(0x1237)]);if(_0x2a9607>-0x1){const _0x2b0e64=_0x1e2f12[_0x598b16(0x8b3)][_0x2a9607];_0x2b0e64['status']='declined';const _0x5c7c54={'role':_0x598b16(0x1a7),'senderName':_0x1e2f12[_0x598b16(0x609)],'type':_0x598b16(0x975),'isRefund':!![],'amount':_0x2b0e64[_0x598b16(0x212)],'note':_0x598b16(0xabe),'timestamp':_0xbd3f38++};_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x668)](_0x5c7c54),_0x32a015&&(_0xc4e879(_0x5c7c54,_0x1e2f12),_0x1a44b1(_0x14346e));}continue;}case _0x598b16(0x133d):if(_0x1e2f12[_0x598b16(0x11e4)]&&_0x456d8f[_0x598b16(0x1261)]){const _0x3fbbd4=_0x456d8f[_0x598b16(0x1261)][_0x598b16(0x3f1)](),_0x1b0f28=_0x1e2f12[_0x598b16(0xd3e)][_0x598b16(0xa3b)](_0xea1a2d=>_0xea1a2d[_0x598b16(0x1071)]);if(_0x1b0f28[_0x598b16(0x930)](_0x3fbbd4)){console['warn'](_0x598b16(0x572)+_0x456d8f[_0x598b16(0x609)]+')\x20试图将群名更改为成员名\x20(\x22'+_0x3fbbd4+_0x598b16(0x24a));continue;}_0x1e2f12['name']=_0x3fbbd4;const _0x181365=_0x1e2f12['members'][_0x598b16(0xfc3)](_0x42a419=>_0x42a419[_0x598b16(0x1071)]===_0x456d8f[_0x598b16(0x609)]),_0x35f7ae=_0x181365?_0x181365[_0x598b16(0x1132)]:_0x456d8f['name'],_0x154799={'role':_0x598b16(0xb64),'type':_0x598b16(0x13a8),'content':_0x35f7ae+_0x598b16(0x286)+_0x1e2f12['name']+'”','timestamp':_0xbd3f38++};_0x1e2f12[_0x598b16(0x8b3)]['push'](_0x154799),_0x32a015&&(_0xc4e879(_0x154799,_0x1e2f12),document['getElementById'](_0x598b16(0x117c))[_0x598b16(0xe24)]=_0x1e2f12['name']);}continue;case _0x598b16(0xbae):if(!_0x1e2f12[_0x598b16(0x11e4)]&&_0x456d8f[_0x598b16(0x1261)]){const _0x9b5f8b=_0x1e2f12[_0x598b16(0x609)],_0x542333=_0x456d8f[_0x598b16(0x1261)]['trim']();if(_0x542333&&_0x542333!==_0x9b5f8b){!_0x1e2f12['nameHistory']&&(_0x1e2f12[_0x598b16(0xd4f)]=[]);!_0x1e2f12[_0x598b16(0xd4f)]['includes'](_0x9b5f8b)&&_0x1e2f12['nameHistory'][_0x598b16(0x668)](_0x9b5f8b);_0x1e2f12[_0x598b16(0x609)]=_0x542333;const _0x576cd2={'role':_0x598b16(0xb64),'type':_0x598b16(0x13a8),'content':'“'+_0x1e2f12[_0x598b16(0x1071)]+_0x598b16(0x69c)+_0x542333+'”','timestamp':_0xbd3f38++};_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x668)](_0x576cd2);const _0x337ba9={'role':'system','content':_0x598b16(0xb05)+_0x542333+_0x598b16(0x107a),'timestamp':_0xbd3f38++,'isHidden':!![]};_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x668)](_0x337ba9),_0x32a015&&(_0xc4e879(_0x576cd2,_0x1e2f12),document[_0x598b16(0x9c8)]('chat-header-title')['textContent']=_0x542333),await _0x5eaa16(_0x1e2f12);}}continue;case _0x598b16(0x695):if(_0x1e2f12[_0x598b16(0x11e4)]&&_0x456d8f['avatar_name']){const _0x4e2075=_0x456d8f[_0x598b16(0x790)],_0x39efb4=_0x1e2f12[_0x598b16(0x1131)][_0x598b16(0xd86)]||[],_0x8bd6c3=_0x39efb4[_0x598b16(0xfc3)](_0x5822f9=>_0x5822f9['name']===_0x4e2075);if(_0x8bd6c3){_0x1e2f12['settings'][_0x598b16(0xa79)]=_0x8bd6c3['url'];const _0x4744a1=_0x1e2f12[_0x598b16(0xd3e)][_0x598b16(0xfc3)](_0x2bb2ee=>_0x2bb2ee[_0x598b16(0x1071)]===_0x456d8f[_0x598b16(0x609)]),_0x3083a7=_0x4744a1?_0x4744a1[_0x598b16(0x1132)]:_0x456d8f[_0x598b16(0x609)],_0xd29474={'role':'system','type':_0x598b16(0x13a8),'content':_0x3083a7+_0x598b16(0x9a4),'timestamp':_0xbd3f38++};_0x1e2f12[_0x598b16(0x8b3)]['push'](_0xd29474),_0x32a015&&_0xc4e879(_0xd29474,_0x1e2f12);}else console[_0x598b16(0x453)](_0x598b16(0x208)+_0x4e2075+'\x22');}continue;case _0x598b16(0xe96):_0x4e2d38={'role':_0x598b16(0xb64),'type':_0x598b16(0x13a8),'content':_0x456d8f['content'],'timestamp':Date[_0x598b16(0x9b7)]()};break;case _0x598b16(0x12a5):_0x4e2d38={..._0x3c5c81,'type':_0x598b16(0x12a5),'title':_0x456d8f[_0x598b16(0x9f2)],'description':_0x456d8f[_0x598b16(0x1387)],'source_name':_0x456d8f[_0x598b16(0x545)],'content':_0x456d8f[_0x598b16(0x53b)]};break;case _0x598b16(0xb43):const _0x2b4a4c=_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0xfc3)](_0x43fe7d=>_0x43fe7d[_0x598b16(0x6b5)]===_0x456d8f['target_timestamp']);if(_0x2b4a4c){const _0x5ee8c6={'timestamp':_0x2b4a4c[_0x598b16(0x6b5)],'senderName':_0x2b4a4c[_0x598b16(0xac4)]||(_0x2b4a4c['role']===_0x598b16(0x586)?_0x1e2f12['settings'][_0x598b16(0x29c)]||'我':_0x1e2f12[_0x598b16(0x609)]),'content':String(_0x2b4a4c[_0x598b16(0x53b)]||'')[_0x598b16(0xc34)](0x0,0x32)};_0x4e2d38={..._0x3c5c81,'content':_0x456d8f[_0x598b16(0xbb2)],'quote':_0x5ee8c6};}else _0x4e2d38={..._0x3c5c81,'content':_0x456d8f[_0x598b16(0xbb2)]};break;case _0x598b16(0x1138):{if(!_0x32a015)continue;const _0x41838e={..._0x3c5c81,'content':_0x456d8f['content']},_0x540ec9=_0x8ae2cf(_0x41838e,_0x1e2f12);_0xc4e879(_0x41838e,_0x1e2f12,!![]),await new Promise(_0x35934b=>setTimeout(_0x35934b,Math[_0x598b16(0x360)]()*0x3e8+0x5dc));const _0x4058a1=document[_0x598b16(0x91d)](_0x598b16(0x47f)+_0x41838e['timestamp']+'\x22]')?.[_0x598b16(0xaa0)](_0x598b16(0x6f0));if(_0x4058a1){_0x4058a1[_0x598b16(0x575)][_0x598b16(0x68e)](_0x598b16(0xa4e)),await new Promise(_0x1ea48d=>setTimeout(_0x1ea48d,0x12c));const _0x4737ee={'role':_0x598b16(0x1a7),'senderName':_0x456d8f[_0x598b16(0x609)]||_0x1e2f12[_0x598b16(0x609)],'type':_0x598b16(0x8cc),'content':_0x598b16(0x39d),'timestamp':_0x41838e[_0x598b16(0x6b5)],'recalledData':{'originalType':'text','originalContent':_0x456d8f[_0x598b16(0x53b)]}},_0x3ed68c=_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x684)](_0x52cbfb=>_0x52cbfb['timestamp']===_0x41838e['timestamp']);_0x3ed68c>-0x1?_0x1e2f12[_0x598b16(0x8b3)][_0x3ed68c]=_0x4737ee:_0x1e2f12['history'][_0x598b16(0x668)](_0x4737ee);const _0x5cae48=await _0x8ae2cf(_0x4737ee,_0x1e2f12);document[_0x598b16(0xe20)][_0x598b16(0x1038)](_0x4058a1)&&_0x4058a1['parentNode']['replaceChild'](_0x5cae48,_0x4058a1);}continue;}case _0x598b16(0xbb7):_0x4e2d38={..._0x3c5c81,'content':String(_0x456d8f['content']||_0x456d8f['message'])};break;case _0x598b16(0x83e):if(_0x456d8f[_0x598b16(0x1b3)]){const _0x95ad3a=_0x9ebf46[_0x598b16(0x774)]['find'](_0x886f1e=>_0x886f1e[_0x598b16(0x609)]===_0x456d8f[_0x598b16(0x1b3)]);_0x95ad3a?_0x4e2d38={..._0x3c5c81,'type':_0x598b16(0x83e),'content':_0x95ad3a[_0x598b16(0x11be)],'meaning':_0x95ad3a[_0x598b16(0x609)]}:(console['warn'](_0x598b16(0xe67)+_0x456d8f['meaning']+'\x22'),_0x4e2d38={..._0x3c5c81,'type':_0x598b16(0xbb7),'content':_0x598b16(0xef0)+_0x456d8f[_0x598b16(0x1b3)]+']'});}else console[_0x598b16(0x453)](_0x598b16(0x1e1),_0x456d8f),_0x4e2d38={..._0x3c5c81,'type':'sticker','content':_0x456d8f[_0x598b16(0x11be)],'meaning':_0x598b16(0xdbe)};break;case _0x598b16(0x835):_0x4e2d38={..._0x3c5c81,'type':_0x598b16(0x835),'content':_0x456d8f[_0x598b16(0x1387)],'image_prompt':_0x456d8f[_0x598b16(0xd73)]};break;case _0x598b16(0x10c1):_0x4e2d38={..._0x3c5c81,'type':'voice_message','content':_0x456d8f[_0x598b16(0x53b)]};break;case _0x598b16(0x975):_0x4e2d38={..._0x3c5c81,'type':'transfer','amount':_0x456d8f[_0x598b16(0x212)],'note':_0x456d8f[_0x598b16(0x490)],'receiverName':_0x456d8f[_0x598b16(0x7bd)]||'我'};break;case _0x598b16(0x12d4):_0x4e2d38={..._0x3c5c81,'type':_0x598b16(0x12d4),'productInfo':_0x456d8f[_0x598b16(0xde1)],'amount':_0x456d8f['amount'],'status':'pending','countdownEndTime':Date[_0x598b16(0x9b7)]()+0xf*0x3c*0x3e8};break;case _0x598b16(0x1af):_0x4e2d38={..._0x3c5c81,'type':_0x598b16(0x1af),'productInfo':_0x456d8f[_0x598b16(0xde1)],'amount':_0x456d8f[_0x598b16(0x212)],'greeting':_0x456d8f['greeting'],'recipientName':_0x456d8f[_0x598b16(0x9d0)]||null};break;case _0x598b16(0xc91):_0x4e2d38={..._0x3c5c81,..._0x456d8f};break;case _0x598b16(0x1227):try{console[_0x598b16(0x283)](_0x598b16(0x3f0),_0x456d8f['prompt']);const _0x33007d=_0x141b22(_0x1e2f12['id']),_0x470579=_0x456d8f['prompt']||_0x598b16(0xdff),_0x5643cc=_0x470579+',\x20'+_0x33007d[_0x598b16(0x707)],_0x1fe6da=_0x33007d[_0x598b16(0x452)];console[_0x598b16(0x283)](_0x598b16(0x836)+(_0x33007d['source']===_0x598b16(0x96c)?'角色专属':'系统')+'提示词配置'),console[_0x598b16(0x283)](_0x598b16(0x6c5),_0x5643cc),console['log'](_0x598b16(0x3ba),_0x1fe6da);const _0x5e1fe8=localStorage['getItem'](_0x598b16(0xef8)),_0x43cd0e=localStorage[_0x598b16(0x1290)]('novelai-model')||_0x598b16(0x1286),_0x2d1847=_0x462263();if(!_0x5e1fe8)throw new Error(_0x598b16(0x403));const [_0x17d5e9,_0x271ad4]=_0x2d1847[_0x598b16(0xc85)][_0x598b16(0x6c6)]('x')[_0x598b16(0xa3b)](Number);let _0x42988f;_0x43cd0e[_0x598b16(0x930)](_0x598b16(0x38b))?_0x42988f={'input':_0x5643cc,'model':_0x43cd0e,'action':_0x598b16(0x7b7),'parameters':{'params_version':0x3,'width':_0x17d5e9,'height':_0x271ad4,'scale':_0x2d1847['cfg_scale'],'sampler':_0x2d1847[_0x598b16(0x900)],'steps':_0x2d1847[_0x598b16(0x91e)],'seed':_0x2d1847[_0x598b16(0x10f8)]===-0x1?Math[_0x598b16(0x5fb)](Math[_0x598b16(0x360)]()*0x2540be3ff):_0x2d1847['seed'],'n_samples':0x1,'ucPreset':_0x2d1847[_0x598b16(0x121d)],'qualityToggle':_0x2d1847['quality_toggle'],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x598b16(0x128d),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x5643cc,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x1fe6da,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x1fe6da,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x42988f={'input':_0x5643cc,'model':_0x43cd0e,'action':'generate','parameters':{'width':_0x17d5e9,'height':_0x271ad4,'scale':_0x2d1847[_0x598b16(0xb18)],'sampler':_0x2d1847[_0x598b16(0x900)],'steps':_0x2d1847[_0x598b16(0x91e)],'seed':_0x2d1847[_0x598b16(0x10f8)]===-0x1?Math['floor'](Math['random']()*0x2540be3ff):_0x2d1847[_0x598b16(0x10f8)],'n_samples':0x1,'ucPreset':_0x2d1847[_0x598b16(0x121d)],'qualityToggle':_0x2d1847[_0x598b16(0x1080)],'sm':_0x2d1847[_0x598b16(0x116e)],'sm_dyn':_0x2d1847[_0x598b16(0xdec)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x598b16(0xe3c),'negative_prompt':_0x1fe6da}};console[_0x598b16(0x283)]('🚀\x20发送NAI请求:',_0x42988f);let _0x3e52a0;_0x43cd0e[_0x598b16(0x930)](_0x598b16(0x38b))?_0x3e52a0=_0x598b16(0x354):_0x3e52a0=_0x598b16(0xf0c);let _0x46313c=_0x2d1847[_0x598b16(0xa5f)];_0x46313c===_0x598b16(0x13c6)&&(_0x46313c=_0x2d1847[_0x598b16(0xc23)]||'');_0x46313c&&_0x46313c!==''&&(_0x3e52a0=_0x46313c+encodeURIComponent(_0x3e52a0));const _0x2bc34d=await fetch(_0x3e52a0,{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x5e1fe8},'body':JSON[_0x598b16(0xf1e)](_0x42988f)});console['log']('Response\x20status:',_0x2bc34d['status']),console[_0x598b16(0x283)](_0x598b16(0xf9a),[..._0x2bc34d['headers'][_0x598b16(0x1231)]()]);if(!_0x2bc34d['ok']){const _0x45c985=await _0x2bc34d[_0x598b16(0xbb7)]();console[_0x598b16(0x1221)]('API错误响应:',_0x45c985);throw new Error(_0x598b16(0xafa)+_0x2bc34d[_0x598b16(0xebd)]+_0x598b16(0x301)+_0x45c985);}const _0x396e6b=_0x2bc34d['headers']['get']('content-type');console[_0x598b16(0x283)](_0x598b16(0x2af),_0x396e6b);let _0x538237,_0x359024;if(_0x396e6b&&_0x396e6b[_0x598b16(0x930)](_0x598b16(0xb46))){console['log'](_0x598b16(0x250));const _0x31ce2f=await _0x2bc34d[_0x598b16(0xbb7)]();console['log'](_0x598b16(0xa60),_0x31ce2f[_0x598b16(0xa06)]);const _0x418772=_0x31ce2f[_0x598b16(0x3f1)]()[_0x598b16(0x6c6)]('\x0a');let _0x2e14f4=null;for(let _0x281401=_0x418772[_0x598b16(0xa06)]-0x1;_0x281401>=0x0;_0x281401--){const _0x4e99fa=_0x418772[_0x281401][_0x598b16(0x3f1)]();if(_0x4e99fa[_0x598b16(0xc8d)](_0x598b16(0xd78))&&_0x4e99fa!==_0x598b16(0x128a)){const _0x89bbe2=_0x4e99fa[_0x598b16(0xc34)](0x6);try{const _0x4a6fb2=JSON[_0x598b16(0x907)](_0x89bbe2);if(_0x4a6fb2[_0x598b16(0x119c)]===_0x598b16(0x1313)&&_0x4a6fb2['image']){_0x2e14f4=_0x4a6fb2[_0x598b16(0x10eb)],console[_0x598b16(0x283)](_0x598b16(0xd06));break;}if(_0x4a6fb2['data']){_0x2e14f4=_0x4a6fb2[_0x598b16(0x100d)],console['log'](_0x598b16(0xbe8));break;}if(_0x4a6fb2[_0x598b16(0x10eb)]){_0x2e14f4=_0x4a6fb2[_0x598b16(0x10eb)],console['log'](_0x598b16(0xe16));break;}}catch(_0x23f9b7){_0x2e14f4=_0x89bbe2,console['log']('直接使用\x20base64\x20数据');break;}}}if(!_0x2e14f4)throw new Error(_0x598b16(0xa07));const _0x3988a7=_0x2e14f4[_0x598b16(0xc8d)](_0x598b16(0xd2a)),_0x5a90dc=_0x2e14f4[_0x598b16(0xc8d)]('/9j/');if(_0x3988a7||_0x5a90dc){console['log'](_0x598b16(0xc0b));const _0x6abdc5=atob(_0x2e14f4),_0x4a391b=new Uint8Array(_0x6abdc5['length']);for(let _0x3f19d1=0x0;_0x3f19d1<_0x6abdc5['length'];_0x3f19d1++){_0x4a391b[_0x3f19d1]=_0x6abdc5[_0x598b16(0xf76)](_0x3f19d1);}const _0x5303c0=new Blob([_0x4a391b],{'type':_0x3988a7?_0x598b16(0xb19):_0x598b16(0xc82)});console[_0x598b16(0x283)](_0x598b16(0xa09),_0x5303c0[_0x598b16(0xa67)]);const _0x2a1fde=new FileReader();_0x359024=await new Promise((_0x2fc689,_0x24a85c)=>{const _0x1b2e0a=_0x598b16;_0x2a1fde[_0x1b2e0a(0x9b9)]=()=>_0x2fc689(_0x2a1fde['result']),_0x2a1fde['onerror']=_0x24a85c,_0x2a1fde[_0x1b2e0a(0xba5)](_0x5303c0);}),console[_0x598b16(0x283)]('✅\x20图片转换成功！🎨');}else{console[_0x598b16(0x283)](_0x598b16(0xbc8));const _0x3511b5=atob(_0x2e14f4),_0x144c27=new Uint8Array(_0x3511b5[_0x598b16(0xa06)]);for(let _0x68994=0x0;_0x68994<_0x3511b5[_0x598b16(0xa06)];_0x68994++){_0x144c27[_0x68994]=_0x3511b5[_0x598b16(0xf76)](_0x68994);}_0x538237=new Blob([_0x144c27]),console[_0x598b16(0x283)](_0x598b16(0x4f6),_0x538237[_0x598b16(0xa67)]);}}else _0x538237=await _0x2bc34d[_0x598b16(0xa6e)](),console[_0x598b16(0x283)]('收到数据，类型:',_0x538237[_0x598b16(0x12d9)],_0x598b16(0xb10),_0x538237[_0x598b16(0xa67)]);if(!_0x359024&&_0x538237)try{if(typeof JSZip==='undefined')throw new Error(_0x598b16(0xb3e));const _0x47e98b=await JSZip['loadAsync'](_0x538237);console[_0x598b16(0x283)](_0x598b16(0x755),Object[_0x598b16(0x2bd)](_0x47e98b[_0x598b16(0x1216)]));let _0x518203=null;for(let _0x3a87eb in _0x47e98b['files']){if(_0x3a87eb[_0x598b16(0x12c2)](/\.(png|jpg|jpeg|webp)$/i)){_0x518203=_0x47e98b['files'][_0x3a87eb],console[_0x598b16(0x283)]('找到图片文件:',_0x3a87eb);break;}}if(!_0x518203)throw new Error('ZIP文件中未找到图片');const _0x5579f6=await _0x518203[_0x598b16(0x43d)](_0x598b16(0xa6e));console['log'](_0x598b16(0x7dd),_0x5579f6[_0x598b16(0xa67)]);const _0x33e905=new FileReader();_0x359024=await new Promise((_0x2b42a6,_0x1f04ba)=>{const _0x15aa9d=_0x598b16;_0x33e905[_0x15aa9d(0x9b9)]=()=>_0x2b42a6(_0x33e905[_0x15aa9d(0xceb)]),_0x33e905['onerror']=_0x1f04ba,_0x33e905[_0x15aa9d(0xba5)](_0x5579f6);}),console[_0x598b16(0x283)](_0x598b16(0x887));}catch(_0x602f95){console[_0x598b16(0x1221)](_0x598b16(0xccf),_0x602f95);throw new Error('图片解压失败:\x20'+_0x602f95[_0x598b16(0x86e)]);}console['log'](_0x598b16(0x7f8)),_0x4e2d38={..._0x3c5c81,'type':_0x598b16(0x1227),'imageUrl':_0x359024,'prompt':_0x470579,'fullPrompt':_0x5643cc};}catch(_0x5a9e32){console[_0x598b16(0x1221)]('❌\x20NAI图片生成失败:',_0x5a9e32),_0x4e2d38={..._0x3c5c81,'content':'[图片生成失败:\x20'+_0x5a9e32[_0x598b16(0x86e)]+']'};}break;default:console[_0x598b16(0x453)](_0x598b16(0x3f2),_0x456d8f[_0x598b16(0x12d9)]);break;}if(_0x4e2d38){_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x668)](_0x4e2d38);!_0x32a015&&(_0x1e2f12['unreadCount']=(_0x1e2f12[_0x598b16(0x382)]||0x0)+0x1);if(!_0x32a015&&!_0x547db0){let _0x545e08;switch(_0x4e2d38[_0x598b16(0x12d9)]){case _0x598b16(0x975):_0x545e08=_0x598b16(0x375);break;case _0x598b16(0x12d4):_0x545e08='[收到一个外卖代付请求]';break;case _0x598b16(0x835):_0x545e08=_0x598b16(0x4a9);break;case _0x598b16(0x10c1):_0x545e08='[语音]';break;case'sticker':_0x545e08=_0x4e2d38[_0x598b16(0x1b3)]?_0x598b16(0xef0)+_0x4e2d38[_0x598b16(0x1b3)]+']':_0x598b16(0x7a8);break;case'offline_text':_0x545e08=_0x4e2d38['dialogue']?'「'+_0x4e2d38['dialogue']+'」':'['+_0x4e2d38[_0x598b16(0x1387)][_0x598b16(0xc34)](0x0,0x14)+_0x598b16(0xd82);break;default:_0x545e08=String(_0x4e2d38['content']||'');}const _0x2bb315=_0x1e2f12[_0x598b16(0x11e4)]?_0x4e2d38['senderName']+':\x20'+_0x545e08:_0x545e08;_0x52c10d(_0x14346e,_0x2bb315[_0x598b16(0xc34)](0x0,0x28)+(_0x2bb315[_0x598b16(0xa06)]>0x28?_0x598b16(0xf66):'')),_0x547db0=!![];}_0x32a015&&(_0xc4e879(_0x4e2d38,_0x1e2f12),await new Promise(_0x218fa2=>setTimeout(_0x218fa2,Math[_0x598b16(0x360)]()*0x708+0x3e8)));}}_0x338129&&_0x3085d5['isGroupCall']&&(_0x3085d5[_0x598b16(0x683)]=![],_0x3085d5['participants'][_0x598b16(0xa06)]>0x0?_0x5ab059():(_0x3085d5={..._0x3085d5,'isAwaitingResponse':![],'participants':[]},_0xe5834e(_0x598b16(0x504)),alert(_0x598b16(0x10e6))));if(_0x514e4e){await _0x4128b4();return;}await _0x2c5bcf[_0x598b16(0x547)][_0x598b16(0xff5)](_0x1e2f12);const _0x43f2eb=_0x2b8201[_0x598b16(0x10b2)](_0x3e522e=>_0x3e522e[_0x598b16(0x12d9)]==='qzone_post'||_0x3e522e['type']==='qzone_like'||_0x3e522e[_0x598b16(0x12d9)]===_0x598b16(0xc6d)||_0x3e522e[_0x598b16(0x12d9)]===_0x598b16(0x75b));_0x43f2eb&&(console[_0x598b16(0x283)]('检测到AI执行了动态操作，立即刷新好友动态页面。'),await _0x2c70a9());}catch(_0x3570cc){_0x1e2f12[_0x598b16(0x8b3)]=_0x1e2f12[_0x598b16(0x8b3)][_0x598b16(0x401)](_0x4d39c9=>!_0x4d39c9[_0x598b16(0x386)]),!_0x1e2f12['isGroup']&&_0x1e2f12[_0x598b16(0x36f)]?.['status']===_0x598b16(0x26d)?(_0x1e2f12[_0x598b16(0x36f)]['status']=_0x598b16(0x23d),await _0x1bff53(_0x598b16(0xeb5),'AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20'+_0x3570cc['message'])):await _0x1bff53(_0x598b16(0xbc6),'发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a'+_0x3570cc[_0x598b16(0x86e)]),!_0x1e2f12[_0x598b16(0x11e4)]&&_0x1e2f12[_0x598b16(0x36f)]?.[_0x598b16(0xebd)]===_0x598b16(0x23d)&&await _0x2c5bcf[_0x598b16(0x547)][_0x598b16(0xff5)](_0x1e2f12),_0x3085d5[_0x598b16(0x683)]=![];}finally{_0x39290a(_0x14346e,![]),_0x1e2f12['isGroup']?_0x426947&&(_0x426947[_0x598b16(0x5e1)][_0x598b16(0x3c5)]=_0x598b16(0x8f6)):_0x4020d5&&_0x9ebf46[_0x598b16(0x547)][_0x14346e]&&(_0x4020d5[_0x598b16(0x5e1)]['opacity']=0x0,setTimeout(()=>{const _0x429ae7=_0x598b16;_0x4020d5[_0x429ae7(0xe24)]=_0x9ebf46[_0x429ae7(0x547)][_0x14346e][_0x429ae7(0x609)],_0x4020d5['classList'][_0x429ae7(0x30f)](_0x429ae7(0x100e)),_0x4020d5['style']['opacity']=0x1;},0xc8)),_0x394b2c(),_0x1924c9&&_0x3fd0d9(_0x14346e),_0x4762c1();}}async function _0x4b747c(_0x2cbe37){const _0x179af1=_0x419fa8;if(!_0x9ebf46['activeChatId'])return;const _0x4a4649=_0x9ebf46[_0x179af1(0x547)][_0x9ebf46[_0x179af1(0x970)]],_0x378d02={'role':'user','content':_0x2cbe37['url'],'meaning':_0x2cbe37[_0x179af1(0x609)],'timestamp':Date[_0x179af1(0x9b7)]()};_0x4a4649[_0x179af1(0x8b3)]['push'](_0x378d02),await _0x2c5bcf[_0x179af1(0x547)][_0x179af1(0xff5)](_0x4a4649),_0xc4e879(_0x378d02,_0x4a4649),_0x394b2c(),document[_0x179af1(0x9c8)](_0x179af1(0x946))[_0x179af1(0x575)][_0x179af1(0x30f)]('visible');}async function _0x3b7475(){const _0x49ca9b=_0x419fa8;if(!_0x9ebf46[_0x49ca9b(0x970)])return;const _0xfcd150=document[_0x49ca9b(0x9c8)](_0x49ca9b(0x539)),_0x45269a=document['getElementById'](_0x49ca9b(0x1373)),_0x38dfe3=parseFloat(_0xfcd150[_0x49ca9b(0x1155)]),_0x2b34bb=_0x45269a['value'][_0x49ca9b(0x3f1)]();if(isNaN(_0x38dfe3)||_0x38dfe3<0x0){alert('请输入有效的金额(必须大于0)！');return;}const _0x2c6c1b=_0x9ebf46[_0x49ca9b(0x547)][_0x9ebf46[_0x49ca9b(0x970)]],_0x33e239=_0x2c6c1b['isGroup']?_0x2c6c1b['settings'][_0x49ca9b(0x29c)]||'我':'我',_0x5b0589=_0x2c6c1b[_0x49ca9b(0x11e4)]?'群聊':_0x2c6c1b[_0x49ca9b(0x609)],_0x18dc7d={'role':_0x49ca9b(0x586),'type':'transfer','amount':_0x38dfe3,'note':_0x2b34bb,'senderName':_0x33e239,'receiverName':_0x5b0589,'timestamp':Date[_0x49ca9b(0x9b7)]()};_0x2c6c1b['history'][_0x49ca9b(0x668)](_0x18dc7d),await _0x2c5bcf['chats'][_0x49ca9b(0xff5)](_0x2c6c1b),_0xc4e879(_0x18dc7d,_0x2c6c1b),_0x394b2c(),document[_0x49ca9b(0x9c8)](_0x49ca9b(0x1a9))[_0x49ca9b(0x575)][_0x49ca9b(0x30f)](_0x49ca9b(0xc3f)),_0xfcd150[_0x49ca9b(0x1155)]='',_0x45269a[_0x49ca9b(0x1155)]='';}async function _0x8d3042(){const _0x272aaf=_0x419fa8;if(!_0x9ebf46[_0x272aaf(0x970)])return;const _0x195736=document[_0x272aaf(0x9c8)](_0x272aaf(0x23f)),_0x11f747=document[_0x272aaf(0x9c8)](_0x272aaf(0x961)),_0x307382=_0x195736[_0x272aaf(0x1155)][_0x272aaf(0x3f1)](),_0x583ee4=parseFloat(_0x11f747[_0x272aaf(0x1155)]);if(!_0x307382||isNaN(_0x583ee4)||_0x583ee4<=0x0){alert('请填写有效的商品信息和金额！');return;}const _0x1fd5c1=_0x9ebf46[_0x272aaf(0x547)][_0x9ebf46['activeChatId']],_0x227ced=Date[_0x272aaf(0x9b7)](),_0x337a29=_0x1fd5c1[_0x272aaf(0x11e4)]?_0x1fd5c1[_0x272aaf(0x1131)][_0x272aaf(0x29c)]||'我':'我',_0x435654={'role':_0x272aaf(0x586),'senderName':_0x337a29,'type':_0x272aaf(0x1af),'productInfo':_0x307382,'amount':_0x583ee4,'timestamp':_0x227ced};_0x1fd5c1[_0x272aaf(0x8b3)][_0x272aaf(0x668)](_0x435654);const _0x18f7b0={'role':_0x272aaf(0xb64),'content':_0x272aaf(0x134b)+_0x337a29+_0x272aaf(0x48e)+_0x307382+'”，价值'+_0x583ee4+'元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','timestamp':_0x227ced+0x1,'isHidden':!![]};_0x1fd5c1[_0x272aaf(0x8b3)][_0x272aaf(0x668)](_0x18f7b0),await _0x2c5bcf[_0x272aaf(0x547)][_0x272aaf(0xff5)](_0x1fd5c1),_0xc4e879(_0x435654,_0x1fd5c1),_0x394b2c(),_0x195736[_0x272aaf(0x1155)]='',_0x11f747[_0x272aaf(0x1155)]='',document[_0x272aaf(0x9c8)](_0x272aaf(0xadb))['classList'][_0x272aaf(0x30f)](_0x272aaf(0xc3f));}async function _0x158dea(){const _0x130caf=_0x419fa8;if(!_0x9ebf46['activeChatId'])return;const _0x4dcc6a=await _0xadb5df(_0x130caf(0x1347),_0x130caf(0xde5),'');if(!_0x4dcc6a||!_0x4dcc6a['trim']())return;const _0x2d3acd=_0x130caf(0x236),_0x244d38=_0x9ebf46[_0x130caf(0x547)][_0x9ebf46[_0x130caf(0x970)]],_0x5cc7ca={'role':_0x130caf(0x586),'type':'location_share','content':_0x4dcc6a[_0x130caf(0x3f1)](),'imageUrl':_0x2d3acd,'timestamp':Date[_0x130caf(0x9b7)]()};_0x244d38[_0x130caf(0x8b3)]['push'](_0x5cc7ca),await _0x2c5bcf[_0x130caf(0x547)][_0x130caf(0xff5)](_0x244d38),_0xc4e879(_0x5cc7ca,_0x244d38),_0x394b2c();}function _0x5f062d(_0x4979e2){const _0x555d2c=_0x419fa8;if(_0x38ba45)return;_0x38ba45=!![],document[_0x555d2c(0x9c8)](_0x555d2c(0x504))[_0x555d2c(0x575)][_0x555d2c(0x68e)](_0x555d2c(0xec5)),_0x1c3bf3(_0x4979e2);}function _0x2d6552(){const _0x2b15d0=_0x419fa8;_0x1150e0();if(!_0x38ba45)return;_0x38ba45=![],document['getElementById']('chat-interface-screen')['classList']['remove'](_0x2b15d0(0xec5)),_0x24fb08['forEach'](_0xb8a7b9=>{const _0x40b10a=_0x2b15d0,_0x1d241b=document[_0x40b10a(0x91d)](_0x40b10a(0x47f)+_0xb8a7b9+'\x22]');if(_0x1d241b)_0x1d241b['classList'][_0x40b10a(0x30f)](_0x40b10a(0x631));}),_0x24fb08[_0x2b15d0(0xdae)]();}function _0x1c3bf3(_0x1d3fe4){const _0x57239d=_0x419fa8,_0x1ba17f=document[_0x57239d(0x91d)](_0x57239d(0x47f)+_0x1d3fe4+'\x22]');if(!_0x1ba17f)return;_0x24fb08[_0x57239d(0xd97)](_0x1d3fe4)?(_0x24fb08[_0x57239d(0x6d2)](_0x1d3fe4),_0x1ba17f[_0x57239d(0x575)][_0x57239d(0x30f)]('selected')):(_0x24fb08[_0x57239d(0x68e)](_0x1d3fe4),_0x1ba17f[_0x57239d(0x575)]['add']('selected')),document['getElementById'](_0x57239d(0x1004))['textContent']=_0x57239d(0xc6e)+_0x24fb08[_0x57239d(0xa67)]+'\x20条',_0x24fb08['size']===0x0&&_0x2d6552();}function _0x43a60a(_0x551f09,_0xb60d04){const _0xd805f2=_0x419fa8;let _0x3901fe;const _0x2b3b44=_0x3d5fd5=>{const _0x576b79=_0x3569;if(_0x38ba45)return;_0x3d5fd5[_0x576b79(0xf26)](),_0x3901fe=window[_0x576b79(0x67b)](()=>_0xb60d04(_0x3d5fd5),0x1f4);},_0x47015e=()=>clearTimeout(_0x3901fe);_0x551f09[_0xd805f2(0xa0f)](_0xd805f2(0x124a),_0x2b3b44),_0x551f09[_0xd805f2(0xa0f)](_0xd805f2(0xdf0),_0x47015e),_0x551f09['addEventListener'](_0xd805f2(0xcc9),_0x47015e),_0x551f09[_0xd805f2(0xa0f)]('touchstart',_0x2b3b44,{'passive':!![]}),_0x551f09[_0xd805f2(0xa0f)](_0xd805f2(0xd41),_0x47015e),_0x551f09[_0xd805f2(0xa0f)](_0xd805f2(0x699),_0x47015e);}async function _0x1c3fee(){const _0x1eb5ea=_0x419fa8,_0x396146=_0x9ebf46[_0x1eb5ea(0x970)];if(!_0x396146)return;if(!_0x5062a9[_0x1eb5ea(0x103f)]){_0x2226cb(_0x396146);return;}if(_0x5062a9[_0x1eb5ea(0x970)]===_0x396146)document[_0x1eb5ea(0x9c8)]('music-player-overlay')[_0x1eb5ea(0x575)]['add']('visible');else{const _0x4be815=_0x9ebf46[_0x1eb5ea(0x547)][_0x5062a9[_0x1eb5ea(0x970)]]?.[_0x1eb5ea(0x609)]||'未知',_0x14d986=_0x9ebf46['chats'][_0x396146]?.['name']||'当前',_0x30f4b1=await _0x352ae9(_0x1eb5ea(0x10c6),_0x1eb5ea(0x1341)+_0x4be815+_0x1eb5ea(0xbde)+_0x14d986+_0x1eb5ea(0xda1),{'confirmButtonClass':_0x1eb5ea(0x12bc)});_0x30f4b1&&(await _0xce20b(!![]),await new Promise(_0x24adbd=>setTimeout(_0x24adbd,0x32)),_0x2226cb(_0x396146));}}async function _0x2226cb(_0x580b46){const _0x30e3b3=_0x419fa8,_0x5f46ef=_0x9ebf46[_0x30e3b3(0x547)][_0x580b46];if(!_0x5f46ef)return;_0x5062a9[_0x30e3b3(0x485)]=_0x5f46ef['musicData']['totalTime']||0x0,_0x5062a9[_0x30e3b3(0x103f)]=!![],_0x5062a9['activeChatId']=_0x580b46;_0x5062a9[_0x30e3b3(0x8e6)][_0x30e3b3(0xa06)]>0x0?_0x5062a9[_0x30e3b3(0xcc8)]=0x0:_0x5062a9[_0x30e3b3(0xcc8)]=-0x1;if(_0x5062a9['timerId'])clearInterval(_0x5062a9[_0x30e3b3(0x13a1)]);_0x5062a9[_0x30e3b3(0x13a1)]=setInterval(()=>{const _0x2e44e7=_0x30e3b3;_0x5062a9[_0x2e44e7(0x50c)]&&(_0x5062a9[_0x2e44e7(0x485)]++,_0x330fa3());},0x3e8),_0x424265(),_0x2330eb(),document[_0x30e3b3(0x9c8)]('music-player-overlay')[_0x30e3b3(0x575)]['add'](_0x30e3b3(0xc3f));}async function _0xce20b(_0x52f44c=!![]){const _0x4ff166=_0x419fa8;if(!_0x5062a9['isActive'])return;const _0x2ffa89=_0x5062a9[_0x4ff166(0x970)];document[_0x4ff166(0x9c8)]('global-lyrics-bar')[_0x4ff166(0x575)][_0x4ff166(0x30f)]('visible');const _0x28a332=async()=>{const _0x431877=_0x4ff166;if(_0x5062a9[_0x431877(0x13a1)])clearInterval(_0x5062a9[_0x431877(0x13a1)]);if(_0x5062a9[_0x431877(0x50c)])_0x287389['pause']();if(_0x52f44c&&_0x2ffa89&&_0x9ebf46[_0x431877(0x547)][_0x2ffa89]){const _0x26ca7e=_0x9ebf46[_0x431877(0x547)][_0x2ffa89];_0x26ca7e[_0x431877(0xbec)][_0x431877(0xa9f)]=_0x5062a9['totalElapsedTime'],await _0x2c5bcf[_0x431877(0x547)][_0x431877(0xff5)](_0x26ca7e);}_0x5062a9[_0x431877(0x103f)]=![],_0x5062a9[_0x431877(0x970)]=null,_0x5062a9[_0x431877(0x485)]=0x0,_0x5062a9['timerId']=null,_0x1e6731(_0x2ffa89,!![]);};_0x4c69e6(_0x28a332);}function _0x51f94a(){_0x4c69e6();}function _0x1e6731(_0x3ae0d3,_0x5179d8=![]){const _0x5cc7b8=_0x419fa8,_0x4baf32=document[_0x5cc7b8(0x91d)]('#listen-together-btn\x20img');if(!_0x4baf32)return;if(_0x5179d8||!_0x5062a9[_0x5cc7b8(0x103f)]||_0x5062a9[_0x5cc7b8(0x970)]!==_0x3ae0d3){_0x4baf32[_0x5cc7b8(0xbf4)]='https://i.postimg.cc/8kYShvrJ/90-UI-2.png',_0x4baf32[_0x5cc7b8(0x82c)]='';return;}_0x4baf32[_0x5cc7b8(0xbf4)]=_0x5cc7b8(0x940),_0x4baf32[_0x5cc7b8(0x575)][_0x5cc7b8(0x68e)](_0x5cc7b8(0xbd1));if(_0x5062a9['isPlaying'])_0x4baf32[_0x5cc7b8(0x575)]['remove'](_0x5cc7b8(0x1fa));else _0x4baf32[_0x5cc7b8(0x575)]['add'](_0x5cc7b8(0x1fa));}window[_0x419fa8(0x103d)]=_0x1e6731;function _0x424265(){const _0x3dc404=_0x419fa8;_0x1e6731(_0x5062a9[_0x3dc404(0x970)]),_0x330fa3();const _0x450805=document[_0x3dc404(0x9c8)]('music-player-song-title'),_0x24dba9=document[_0x3dc404(0x9c8)](_0x3dc404(0xed1)),_0x3c5c47=document[_0x3dc404(0x9c8)](_0x3dc404(0x883));if(_0x5062a9[_0x3dc404(0xcc8)]>-0x1&&_0x5062a9['playlist'][_0x3dc404(0xa06)]>0x0){const _0x41e26b=_0x5062a9[_0x3dc404(0x8e6)][_0x5062a9[_0x3dc404(0xcc8)]];_0x450805[_0x3dc404(0xe24)]=_0x41e26b[_0x3dc404(0x609)],_0x24dba9[_0x3dc404(0xe24)]=_0x41e26b[_0x3dc404(0xc14)];}else _0x450805[_0x3dc404(0xe24)]='请添加歌曲',_0x24dba9[_0x3dc404(0xe24)]='...';_0x3c5c47[_0x3dc404(0xe24)]=_0x5062a9['isPlaying']?'❚❚':'▶';}function _0x330fa3(){const _0x5e4ec5=_0x419fa8,_0x3e978b=(_0x5062a9[_0x5e4ec5(0x485)]/0xe10)[_0x5e4ec5(0x752)](0x1);document[_0x5e4ec5(0x9c8)](_0x5e4ec5(0x854))['textContent']=_0x5e4ec5(0xde7)+_0x3e978b+'小时';}function _0x2330eb(){const _0x19a989=_0x419fa8,_0xf18de1=document[_0x19a989(0x9c8)](_0x19a989(0x1c8));_0xf18de1[_0x19a989(0x2f5)]='';if(_0x5062a9[_0x19a989(0x8e6)]['length']===0x0){_0xf18de1[_0x19a989(0x2f5)]=_0x19a989(0x1cd);return;}_0x5062a9[_0x19a989(0x8e6)]['forEach']((_0x5952a2,_0x2557d4)=>{const _0x460905=_0x19a989,_0x10a4ab=document[_0x460905(0x28a)](_0x460905(0x11f4));_0x10a4ab['className']='playlist-item';if(_0x2557d4===_0x5062a9['currentIndex'])_0x10a4ab[_0x460905(0x575)][_0x460905(0x68e)]('playing');_0x10a4ab[_0x460905(0x2f5)]='\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x5952a2[_0x460905(0x609)]+_0x460905(0x139a)+_0x5952a2[_0x460905(0xc14)]+_0x460905(0x6b4)+_0x2557d4+'\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22'+_0x2557d4+_0x460905(0x5fe)+_0x2557d4+'\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22'+_0x2557d4+_0x460905(0xcab),_0x10a4ab['querySelector'](_0x460905(0x99b))[_0x460905(0xa0f)](_0x460905(0xf5c),()=>_0x187421(_0x2557d4)),_0xf18de1[_0x460905(0x7b9)](_0x10a4ab);});}async function _0x522563(){const _0x536021=_0x419fa8;if(_0x287389[_0x536021(0x1fa)]){if(_0x5062a9[_0x536021(0xcc8)]===-0x1&&_0x5062a9[_0x536021(0x8e6)][_0x536021(0xa06)]>0x0)_0x187421(0x0);else _0x5062a9[_0x536021(0xcc8)]>-0x1&&_0x187421(_0x5062a9['currentIndex']);}else _0x287389['pause'](),await _0x38b71e('暂停了音乐');}function _0x1894d5(){const _0x2b4c4e=_0x419fa8;if(_0x5062a9[_0x2b4c4e(0x8e6)][_0x2b4c4e(0xa06)]===0x0)return;let _0x231d70;switch(_0x5062a9[_0x2b4c4e(0x10ca)]){case _0x2b4c4e(0x360):_0x231d70=Math[_0x2b4c4e(0x5fb)](Math['random']()*_0x5062a9[_0x2b4c4e(0x8e6)]['length']);break;case _0x2b4c4e(0x6af):_0x187421(_0x5062a9[_0x2b4c4e(0xcc8)]);return;case _0x2b4c4e(0x26e):default:_0x231d70=(_0x5062a9[_0x2b4c4e(0xcc8)]+0x1)%_0x5062a9[_0x2b4c4e(0x8e6)][_0x2b4c4e(0xa06)];break;}_0x187421(_0x231d70);}function _0x321294(){const _0x51a42b=_0x419fa8;if(_0x5062a9['playlist'][_0x51a42b(0xa06)]===0x0)return;const _0x39f23c=(_0x5062a9[_0x51a42b(0xcc8)]-0x1+_0x5062a9[_0x51a42b(0x8e6)]['length'])%_0x5062a9[_0x51a42b(0x8e6)]['length'];_0x187421(_0x39f23c);}function _0x2d6b12(){const _0x1893f3=_0x419fa8,_0x20f9e2=['order',_0x1893f3(0x360),_0x1893f3(0x6af)],_0x12f0cb=_0x20f9e2[_0x1893f3(0x78e)](_0x5062a9[_0x1893f3(0x10ca)]);_0x5062a9[_0x1893f3(0x10ca)]=_0x20f9e2[(_0x12f0cb+0x1)%_0x20f9e2[_0x1893f3(0xa06)]],document[_0x1893f3(0x9c8)](_0x1893f3(0xf39))[_0x1893f3(0xe24)]={'order':'顺序','random':'随机','single':'单曲'}[_0x5062a9[_0x1893f3(0x10ca)]];}async function _0x1ad01e(){const _0xa094ed=_0x419fa8,_0x13f4d1=await _0xadb5df(_0xa094ed(0xc7b),'请输入歌曲的URL','',_0xa094ed(0x11be));if(!_0x13f4d1)return;const _0x40a4b4=await _0xadb5df(_0xa094ed(0x9ba),'请输入歌名');if(!_0x40a4b4)return;const _0x4b40fa=await _0xadb5df(_0xa094ed(0x9ba),_0xa094ed(0x1233));if(!_0x4b40fa)return;_0x5062a9['playlist'][_0xa094ed(0x668)]({'name':_0x40a4b4,'artist':_0x4b40fa,'src':_0x13f4d1,'isLocal':![]}),await _0x4b5360(),_0x2330eb(),_0x5062a9[_0xa094ed(0xcc8)]===-0x1&&(_0x5062a9['currentIndex']=_0x5062a9[_0xa094ed(0x8e6)][_0xa094ed(0xa06)]-0x1,_0x424265());}async function _0x537a8c(_0x351da0){const _0x421898=_0x419fa8,_0x5ed48f=_0x351da0[_0x421898(0x1070)][_0x421898(0x1216)];if(!_0x5ed48f['length'])return;for(const _0xfb394e of _0x5ed48f){let _0x9725f5=_0xfb394e['name'][_0x421898(0x459)](/\.[^/.]+$/,'');_0x9725f5=await _0xadb5df(_0x421898(0x9ba),'请输入歌名',_0x9725f5);if(_0x9725f5===null)continue;const _0x1a69d8=await _0xadb5df(_0x421898(0x9ba),'请输入歌手名',_0x421898(0x198));if(_0x1a69d8===null)continue;const _0x3d6aa1=await _0xfb394e[_0x421898(0x72b)]();let _0x205301='';const _0x4909d1=await _0x352ae9(_0x421898(0xc1b),_0x421898(0x133c)+_0x9725f5+_0x421898(0xd62));_0x4909d1&&(_0x205301=await _0x1360d2()||''),_0x5062a9[_0x421898(0x8e6)][_0x421898(0x668)]({'name':_0x9725f5,'artist':_0x1a69d8,'src':_0x3d6aa1,'fileType':_0xfb394e['type'],'isLocal':!![],'lrcContent':_0x205301,'cover':_0x421898(0x851)});}await _0x4b5360(),_0x2330eb(),_0x5062a9[_0x421898(0xcc8)]===-0x1&&_0x5062a9[_0x421898(0x8e6)][_0x421898(0xa06)]>0x0&&(_0x5062a9[_0x421898(0xcc8)]=0x0,_0x424265()),_0x351da0[_0x421898(0x1070)]['value']=null;}async function _0x187421(_0x4400e7){const _0x1cefa3=_0x419fa8;if(_0x4400e7<0x0||_0x4400e7>=_0x5062a9['playlist'][_0x1cefa3(0xa06)])return;_0x287389['pause'](),_0x5062a9[_0x1cefa3(0xcc8)]=_0x4400e7;const _0x2bb6e2=_0x5062a9[_0x1cefa3(0x8e6)][_0x4400e7],_0x308adb=_0x9ebf46[_0x1cefa3(0x547)][_0x5062a9[_0x1cefa3(0x970)]],_0x2fe0de=document[_0x1cefa3(0x9c8)](_0x1cefa3(0xe9d));if(_0x308adb&&_0x2fe0de){_0x2fe0de[_0x1cefa3(0x2f5)]='';const _0xd647bd=_0x308adb[_0x1cefa3(0x11e4)]?_0x308adb[_0x1cefa3(0xd3e)][_0x1cefa3(0xfc3)](_0x5a517d=>_0x5a517d[_0x1cefa3(0x1071)]===_0x2bb6e2['artist'])?.[_0x1cefa3(0x10c9)]||_0x246753:_0x308adb[_0x1cefa3(0x1131)]['aiAvatar']||_0x246753,_0x40cb0b=_0x308adb[_0x1cefa3(0x1131)][_0x1cefa3(0xb60)]||_0x246753,_0x2cf428=document['createElement'](_0x1cefa3(0x889));_0x2cf428[_0x1cefa3(0xbf4)]=_0xd647bd,_0x2cf428['className']=_0x1cefa3(0x1062),_0x2cf428[_0x1cefa3(0x47c)]=_0x1cefa3(0x92c),_0x2fe0de[_0x1cefa3(0x7b9)](_0x2cf428);const _0x49c01e=document[_0x1cefa3(0x28a)]('img');_0x49c01e[_0x1cefa3(0xbf4)]=_0x40cb0b,_0x49c01e['className']=_0x1cefa3(0x1062),_0x49c01e[_0x1cefa3(0x47c)]='User\x20Avatar',_0x2fe0de[_0x1cefa3(0x7b9)](_0x49c01e);}const _0x436698=document[_0x1cefa3(0x91d)](_0x1cefa3(0x11f1)),_0x22a43b=document[_0x1cefa3(0x9c8)](_0x1cefa3(0x47b));_0x436698&&(_0x436698[_0x1cefa3(0x5e1)][_0x1cefa3(0xa9e)]('--music-bg-image',_0x2bb6e2[_0x1cefa3(0x93f)]?_0x1cefa3(0x7fe)+_0x2bb6e2[_0x1cefa3(0x93f)]+')':'none'),_0x436698[_0x1cefa3(0x575)]['toggle']('bg-clear',!!_0x2bb6e2[_0x1cefa3(0x6d5)]));_0x22a43b&&_0x22a43b[_0x1cefa3(0x575)]['toggle']('active',!!_0x2bb6e2[_0x1cefa3(0x6d5)]);document[_0x1cefa3(0x9c8)](_0x1cefa3(0x3d1))[_0x1cefa3(0x575)]['remove'](_0x1cefa3(0x10b7));const _0x3b47ae=document['getElementById'](_0x1cefa3(0x400));_0x3b47ae&&(_0x3b47ae[_0x1cefa3(0xbf4)]=_0x2bb6e2[_0x1cefa3(0x669)]||'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg');await _0x38b71e('将歌曲切换为了《'+_0x2bb6e2[_0x1cefa3(0x609)]+'》'),_0x5062a9[_0x1cefa3(0x109a)]=_0x52e008(_0x2bb6e2[_0x1cefa3(0x725)]||''),_0x2e2dbe();const _0x582ef4=document['getElementById'](_0x1cefa3(0xcc6));_0x582ef4&&(!_0x5062a9['parsedLyrics']||_0x5062a9['parsedLyrics'][_0x1cefa3(0xa06)]===0x0?_0x582ef4['textContent']='纯音乐，请欣赏':_0x582ef4[_0x1cefa3(0xe24)]=_0x1cefa3(0x12dd));if(_0x2bb6e2['isLocal']&&_0x2bb6e2[_0x1cefa3(0xbf4)]instanceof ArrayBuffer){const _0x3a7d8b=new Blob([_0x2bb6e2[_0x1cefa3(0xbf4)]],{'type':_0x2bb6e2[_0x1cefa3(0xec8)]||_0x1cefa3(0xa47)});_0x287389[_0x1cefa3(0xbf4)]=URL['createObjectURL'](_0x3a7d8b);}else{if(_0x2bb6e2['isLocal']&&_0x2bb6e2['src']instanceof Blob)_0x287389[_0x1cefa3(0xbf4)]=URL[_0x1cefa3(0x5bb)](_0x2bb6e2[_0x1cefa3(0xbf4)]);else{if(!_0x2bb6e2[_0x1cefa3(0x306)])_0x287389[_0x1cefa3(0xbf4)]=_0x2bb6e2[_0x1cefa3(0xbf4)];else{console[_0x1cefa3(0x1221)](_0x1cefa3(0xbd3),_0x2bb6e2);return;}}}const _0xc440ae=_0x287389[_0x1cefa3(0xcc3)]();_0xc440ae!==undefined&&_0xc440ae['catch'](_0x1e6ea7=>{const _0x2c5803=_0x1cefa3;if(_0x1e6ea7[_0x2c5803(0x609)]==='NotAllowedError')console[_0x2c5803(0x453)](_0x2c5803(0x23b)),_0x287389[_0x2c5803(0x6f2)](),_0x1bff53(_0x2c5803(0x571),'由于浏览器安全限制，AI切换的歌曲无法自动播放。请手动点击播放按钮\x20▶\x20继续欣赏。');else _0x1e6ea7[_0x2c5803(0x609)]!==_0x2c5803(0x18c)&&console[_0x2c5803(0x1221)]('Playback\x20error:',_0x1e6ea7);});_0x2330eb(),_0x424265(),_0x1d5b7a();const _0x505fa1=document[_0x1cefa3(0x9c8)](_0x1cefa3(0x8b1));_0x5062a9[_0x1cefa3(0x109a)]&&_0x5062a9[_0x1cefa3(0x109a)]['length']>0x0?(_0x505fa1[_0x1cefa3(0xe24)]='♪',_0x505fa1[_0x1cefa3(0x575)]['add']('visible')):_0x505fa1[_0x1cefa3(0x575)][_0x1cefa3(0x30f)]('visible');}async function _0x790b09(_0x23845e){const _0x56b16f=_0x419fa8;if(_0x23845e<0x0||_0x23845e>=_0x5062a9[_0x56b16f(0x8e6)][_0x56b16f(0xa06)])return;const _0x5bc847=await _0xb8c832('更换歌曲背景',[{'text':'📁\x20从本地上传','value':_0x56b16f(0xc89)},{'text':_0x56b16f(0xc13),'value':_0x56b16f(0x11be)}]);let _0x3ea0a4=null;if(_0x5bc847===_0x56b16f(0xc89))_0x3ea0a4=await _0x750485();else _0x5bc847===_0x56b16f(0x11be)&&(_0x3ea0a4=await _0xadb5df('输入图片URL',_0x56b16f(0x5a0),'',_0x56b16f(0x11be)));if(_0x3ea0a4&&_0x3ea0a4[_0x56b16f(0x3f1)]()){_0x5062a9[_0x56b16f(0x8e6)][_0x23845e][_0x56b16f(0x93f)]=_0x3ea0a4[_0x56b16f(0x3f1)](),await _0x4b5360();if(_0x5062a9[_0x56b16f(0xcc8)]===_0x23845e){const _0x548b10=document[_0x56b16f(0x91d)]('.music-player-window');_0x548b10[_0x56b16f(0x5e1)][_0x56b16f(0xa9e)]('--music-bg-image',_0x56b16f(0x7fe)+_0x3ea0a4[_0x56b16f(0x3f1)]()+')');}await _0x1bff53('成功','歌曲背景已更新！');}}async function _0x357753(_0x503840){const _0x1103b2=_0x419fa8;if(_0x503840<0x0||_0x503840>=_0x5062a9[_0x1103b2(0x8e6)]['length'])return;const _0x555cfd=await _0xb8c832(_0x1103b2(0x74c),[{'text':_0x1103b2(0x9c7),'value':_0x1103b2(0xc89)},{'text':'🌐\x20使用网络URL','value':_0x1103b2(0x11be)}]);let _0x1fdccf=null;if(_0x555cfd===_0x1103b2(0xc89))_0x1fdccf=await _0x750485();else _0x555cfd===_0x1103b2(0x11be)&&(_0x1fdccf=await _0xadb5df(_0x1103b2(0x13a6),'请输入新的封面图片链接','',_0x1103b2(0x11be)));if(_0x1fdccf&&_0x1fdccf['trim']()){_0x5062a9[_0x1103b2(0x8e6)][_0x503840]['cover']=_0x1fdccf[_0x1103b2(0x3f1)](),await _0x4b5360();if(_0x5062a9[_0x1103b2(0xcc8)]===_0x503840){document[_0x1103b2(0x9c8)](_0x1103b2(0x400))[_0x1103b2(0xbf4)]=_0x1fdccf[_0x1103b2(0x3f1)]();const _0x29ae77=document[_0x1103b2(0x91d)]('#vinyl-view\x20#music-player-cover');if(_0x29ae77)_0x29ae77[_0x1103b2(0xbf4)]=_0x1fdccf[_0x1103b2(0x3f1)]();}await _0x1bff53('成功',_0x1103b2(0x132e));}}async function _0x4d498f(_0x50597c){const _0x326e8b=_0x419fa8;if(_0x50597c<0x0||_0x50597c>=_0x5062a9[_0x326e8b(0x8e6)][_0x326e8b(0xa06)])return;const _0x328db5=_0x5062a9[_0x326e8b(0x8e6)][_0x50597c],_0x41e18e=_0x5062a9[_0x326e8b(0x50c)]&&_0x5062a9['currentIndex']===_0x50597c;if(_0x328db5[_0x326e8b(0x306)]&&_0x287389[_0x326e8b(0xbf4)]['startsWith']('blob:')&&_0x5062a9['currentIndex']===_0x50597c)URL[_0x326e8b(0x1268)](_0x287389['src']);_0x5062a9[_0x326e8b(0x8e6)][_0x326e8b(0x888)](_0x50597c,0x1),await _0x4b5360();if(_0x5062a9['playlist'][_0x326e8b(0xa06)]===0x0){if(_0x5062a9[_0x326e8b(0x50c)])_0x287389[_0x326e8b(0x6f2)]();_0x287389[_0x326e8b(0xbf4)]='',_0x5062a9[_0x326e8b(0xcc8)]=-0x1,_0x5062a9[_0x326e8b(0x50c)]=![];}else{if(_0x41e18e)_0x1894d5();else{if(_0x5062a9[_0x326e8b(0xcc8)]>=_0x50597c)_0x5062a9[_0x326e8b(0xcc8)]=Math[_0x326e8b(0x24e)](0x0,_0x5062a9[_0x326e8b(0xcc8)]-0x1);}}_0x424265(),_0x2330eb();}async function _0x537a8c(_0x54404f){const _0x192bd5=_0x419fa8,_0x4e3822=_0x54404f[_0x192bd5(0x1070)]['files'];if(!_0x4e3822[_0x192bd5(0xa06)])return;for(const _0x56323e of _0x4e3822){let _0x2ca6b9=_0x56323e[_0x192bd5(0x609)][_0x192bd5(0x459)](/\.[^/.]+$/,'');_0x2ca6b9=await _0xadb5df(_0x192bd5(0x9ba),'请输入歌名',_0x2ca6b9);if(_0x2ca6b9===null)continue;const _0x36414b=await _0xadb5df('歌曲信息',_0x192bd5(0x1233),_0x192bd5(0x198));if(_0x36414b===null)continue;let _0x46f817='';const _0x40448f=await _0x352ae9(_0x192bd5(0xc1b),_0x192bd5(0x133c)+_0x2ca6b9+_0x192bd5(0xd62));_0x40448f&&(_0x46f817=await _0x1360d2()||''),_0x5062a9[_0x192bd5(0x8e6)][_0x192bd5(0x668)]({'name':_0x2ca6b9,'artist':_0x36414b,'src':_0x56323e,'isLocal':!![],'lrcContent':_0x46f817});}await _0x4b5360(),_0x2330eb(),_0x5062a9[_0x192bd5(0xcc8)]===-0x1&&_0x5062a9[_0x192bd5(0x8e6)]['length']>0x0&&(_0x5062a9[_0x192bd5(0xcc8)]=0x0,_0x424265()),_0x54404f[_0x192bd5(0x1070)][_0x192bd5(0x1155)]=null;}async function _0x4d498f(_0x3a756f){const _0x1581ce=_0x419fa8;if(_0x3a756f<0x0||_0x3a756f>=_0x5062a9[_0x1581ce(0x8e6)][_0x1581ce(0xa06)])return;const _0x5c7631=_0x5062a9[_0x1581ce(0x8e6)][_0x3a756f],_0x289040=_0x5062a9[_0x1581ce(0x50c)]&&_0x5062a9[_0x1581ce(0xcc8)]===_0x3a756f;if(_0x5c7631['isLocal']&&_0x287389[_0x1581ce(0xbf4)][_0x1581ce(0xc8d)](_0x1581ce(0xd2d))&&_0x5062a9['currentIndex']===_0x3a756f)URL[_0x1581ce(0x1268)](_0x287389['src']);_0x5062a9['playlist'][_0x1581ce(0x888)](_0x3a756f,0x1),await _0x4b5360();if(_0x5062a9['playlist'][_0x1581ce(0xa06)]===0x0){if(_0x5062a9[_0x1581ce(0x50c)])_0x287389['pause']();_0x287389[_0x1581ce(0xbf4)]='',_0x5062a9[_0x1581ce(0xcc8)]=-0x1,_0x5062a9[_0x1581ce(0x50c)]=![];}else{if(_0x289040)_0x1894d5();else{if(_0x5062a9[_0x1581ce(0xcc8)]>=_0x3a756f)_0x5062a9[_0x1581ce(0xcc8)]=Math[_0x1581ce(0x24e)](0x0,_0x5062a9[_0x1581ce(0xcc8)]-0x1);}}_0x424265(),_0x2330eb();}const _0x472d3a=document[_0x419fa8(0x9c8)](_0x419fa8(0x63a)),_0x3b4dcb=document['getElementById']('persona-editor-modal'),_0x43bb2b=document['getElementById']('preset-actions-modal');function _0x55bb50(){const _0x3200ef=_0x419fa8;_0x24c2d6(),_0x472d3a[_0x3200ef(0x575)]['add']('visible');}function _0x525a6e(){const _0x9a8b99=_0x419fa8;_0x472d3a[_0x9a8b99(0x575)][_0x9a8b99(0x30f)](_0x9a8b99(0xc3f));}function _0x24c2d6(){const _0x142809=_0x419fa8,_0x497ef2=document[_0x142809(0x9c8)](_0x142809(0xdf6));_0x497ef2[_0x142809(0x2f5)]='';if(_0x9ebf46['personaPresets'][_0x142809(0xa06)]===0x0){_0x497ef2[_0x142809(0x2f5)]=_0x142809(0xbb9);return;}_0x9ebf46[_0x142809(0x40d)][_0x142809(0x591)](_0x40548d=>{const _0x59510e=_0x142809,_0x13e599=document[_0x59510e(0x28a)]('div');_0x13e599[_0x59510e(0x82c)]=_0x59510e(0xf93),_0x13e599[_0x59510e(0x5e1)]['backgroundImage']='url('+_0x40548d['avatar']+')',_0x13e599[_0x59510e(0xc9f)][_0x59510e(0x127a)]=_0x40548d['id'],_0x13e599[_0x59510e(0xa0f)](_0x59510e(0xf5c),()=>_0xed332a(_0x40548d['id'])),_0x43a60a(_0x13e599,()=>_0x242a23(_0x40548d['id'])),_0x497ef2['appendChild'](_0x13e599);});}function _0x242a23(_0x1c4c28){const _0x37c833=_0x419fa8;_0x5d5bad=_0x1c4c28,_0x43bb2b[_0x37c833(0x575)]['add'](_0x37c833(0xc3f));}function _0x3e45cc(){const _0x14e007=_0x419fa8;_0x43bb2b[_0x14e007(0x575)]['remove'](_0x14e007(0xc3f)),_0x5d5bad=null;}function _0xed332a(_0x12d965){const _0x515ddf=_0x419fa8,_0xb22213=_0x9ebf46['personaPresets'][_0x515ddf(0xfc3)](_0x7f7b04=>_0x7f7b04['id']===_0x12d965);_0xb22213&&(document['getElementById'](_0x515ddf(0xa98))[_0x515ddf(0xbf4)]=_0xb22213[_0x515ddf(0x10c9)],document[_0x515ddf(0x9c8)](_0x515ddf(0x79e))[_0x515ddf(0x1155)]=_0xb22213[_0x515ddf(0xeb1)]),_0x525a6e();}function _0x17b66d(){const _0x4fac5e=_0x419fa8;_0x5d5bad=null,document['getElementById']('persona-editor-title')['textContent']='添加人设预设',document['getElementById'](_0x4fac5e(0x2aa))[_0x4fac5e(0xbf4)]=_0x246753,document[_0x4fac5e(0x9c8)](_0x4fac5e(0x1bb))['value']='',_0x3b4dcb[_0x4fac5e(0x575)][_0x4fac5e(0x68e)](_0x4fac5e(0xc3f));}function _0x134bed(){const _0x5b6e48=_0x419fa8,_0x255e7e=_0x9ebf46[_0x5b6e48(0x40d)][_0x5b6e48(0xfc3)](_0x544bf6=>_0x544bf6['id']===_0x5d5bad);if(!_0x255e7e)return;document['getElementById'](_0x5b6e48(0x417))[_0x5b6e48(0xe24)]=_0x5b6e48(0xbc3),document[_0x5b6e48(0x9c8)](_0x5b6e48(0x2aa))[_0x5b6e48(0xbf4)]=_0x255e7e[_0x5b6e48(0x10c9)],document[_0x5b6e48(0x9c8)](_0x5b6e48(0x1bb))[_0x5b6e48(0x1155)]=_0x255e7e['persona'],_0x43bb2b[_0x5b6e48(0x575)]['remove'](_0x5b6e48(0xc3f)),_0x3b4dcb[_0x5b6e48(0x575)][_0x5b6e48(0x68e)](_0x5b6e48(0xc3f));}async function _0x19f270(){const _0x5d83bc=_0x419fa8,_0x437fea=await _0x352ae9(_0x5d83bc(0x2a9),_0x5d83bc(0x262),{'confirmButtonClass':'btn-danger'});_0x437fea&&_0x5d5bad&&(await _0x2c5bcf[_0x5d83bc(0x40d)][_0x5d83bc(0x6d2)](_0x5d5bad),_0x9ebf46[_0x5d83bc(0x40d)]=_0x9ebf46[_0x5d83bc(0x40d)][_0x5d83bc(0x401)](_0x12a597=>_0x12a597['id']!==_0x5d5bad),_0x3e45cc(),_0x24c2d6());}function _0x3b4559(){const _0x3f76c0=_0x419fa8;_0x3b4dcb[_0x3f76c0(0x575)][_0x3f76c0(0x30f)]('visible'),_0x5d5bad=null;}async function _0x53cd90(){const _0x219ca2=_0x419fa8,_0x3a3083=document[_0x219ca2(0x9c8)](_0x219ca2(0x2aa))['src'],_0x5385f9=document[_0x219ca2(0x9c8)](_0x219ca2(0x1bb))[_0x219ca2(0x1155)][_0x219ca2(0x3f1)]();if(_0x3a3083===_0x246753&&!_0x5385f9){alert(_0x219ca2(0x3df));return;}if(_0x5d5bad){const _0x836cd6=_0x9ebf46['personaPresets'][_0x219ca2(0xfc3)](_0x3ba670=>_0x3ba670['id']===_0x5d5bad);_0x836cd6&&(_0x836cd6[_0x219ca2(0x10c9)]=_0x3a3083,_0x836cd6[_0x219ca2(0xeb1)]=_0x5385f9,await _0x2c5bcf['personaPresets'][_0x219ca2(0xff5)](_0x836cd6));}else{const _0xccbe30={'id':_0x219ca2(0xc2d)+Date['now'](),'avatar':_0x3a3083,'persona':_0x5385f9};await _0x2c5bcf[_0x219ca2(0x40d)]['add'](_0xccbe30),_0x9ebf46[_0x219ca2(0x40d)]['push'](_0xccbe30);}_0x24c2d6(),_0x3b4559();}const _0x167d6f=document[_0x419fa8(0x9c8)]('battery-alert-modal');function _0x4abe37(_0x523945,_0x3ae9a7){const _0x624fcb=_0x419fa8;clearTimeout(_0xe54e94),document[_0x624fcb(0x9c8)](_0x624fcb(0x7dc))[_0x624fcb(0xbf4)]=_0x523945,document[_0x624fcb(0x9c8)](_0x624fcb(0xf81))[_0x624fcb(0xe24)]=_0x3ae9a7,_0x167d6f[_0x624fcb(0x575)][_0x624fcb(0x68e)](_0x624fcb(0xc3f));const _0x5d8eb8=()=>{const _0x86f873=_0x624fcb;_0x167d6f[_0x86f873(0x575)][_0x86f873(0x30f)](_0x86f873(0xc3f)),_0x167d6f[_0x86f873(0xc9d)](_0x86f873(0xf5c),_0x5d8eb8);};_0x167d6f['addEventListener']('click',_0x5d8eb8),_0xe54e94=setTimeout(_0x5d8eb8,0x7d0);}function _0x1acfce(_0x247955){const _0x3a352f=_0x419fa8,_0x445969=document[_0x3a352f(0x9c8)](_0x3a352f(0xb83)),_0x2814a2=_0x445969[_0x3a352f(0x91d)](_0x3a352f(0xf64)),_0x13582f=_0x445969[_0x3a352f(0x91d)]('.battery-text'),_0x2f09b6=Math['floor'](_0x247955[_0x3a352f(0x3dd)]*0x64);_0x2814a2[_0x3a352f(0x5e1)][_0x3a352f(0x125e)]=_0x2f09b6+'%',_0x13582f[_0x3a352f(0xe24)]=_0x2f09b6+'%',_0x247955['charging']?_0x445969[_0x3a352f(0x575)][_0x3a352f(0x68e)]('charging'):_0x445969[_0x3a352f(0x575)][_0x3a352f(0x30f)](_0x3a352f(0xdb5));}function _0x3f06c9(_0x55c8b0){const _0x148347=_0x419fa8;_0x1acfce(_0x55c8b0);const _0x359b6c=_0x55c8b0[_0x148347(0x3dd)];!_0x55c8b0['charging']&&(_0x359b6c<=0.4&&_0x17befd>0.4&&!_0x40fe0a[_0x148347(0xce2)]&&(_0x4abe37('https://i.postimg.cc/T2yKJ0DV/40.jpg',_0x148347(0xeae)),_0x40fe0a[_0x148347(0xce2)]=!![]),_0x359b6c<=0.2&&_0x17befd>0.2&&!_0x40fe0a[_0x148347(0x78c)]&&(_0x4abe37(_0x148347(0x6a6),'赶紧的充电，要饿死了'),_0x40fe0a[_0x148347(0x78c)]=!![]),_0x359b6c<=0.1&&_0x17befd>0.1&&!_0x40fe0a[_0x148347(0xbcd)]&&(_0x4abe37(_0x148347(0xb2e),'已阵亡，还有30秒爆炸'),_0x40fe0a['hasShown10']=!![]));if(_0x359b6c>0.4)_0x40fe0a[_0x148347(0xce2)]=![];if(_0x359b6c>0.2)_0x40fe0a['hasShown20']=![];if(_0x359b6c>0.1)_0x40fe0a[_0x148347(0xbcd)]=![];_0x17befd=_0x359b6c;}async function _0x50141b(){const _0x3ec98b=_0x419fa8;if(_0x3ec98b(0xec4)in navigator)try{const _0xf52a95=await navigator['getBattery']();_0x17befd=_0xf52a95[_0x3ec98b(0x3dd)],_0x3f06c9(_0xf52a95),_0xf52a95['addEventListener'](_0x3ec98b(0x371),()=>_0x3f06c9(_0xf52a95)),_0xf52a95[_0x3ec98b(0xa0f)](_0x3ec98b(0x112d),()=>{const _0x4a57bc=_0x3ec98b;_0x3f06c9(_0xf52a95),_0xf52a95[_0x4a57bc(0xdb5)]&&_0x4abe37('https://i.postimg.cc/3NDQ0dWG/image.jpg',_0x4a57bc(0x11fc));});}catch(_0x25ab5a){console[_0x3ec98b(0x1221)](_0x3ec98b(0xb1b),_0x25ab5a),document[_0x3ec98b(0x91d)](_0x3ec98b(0xe71))[_0x3ec98b(0xe24)]='ᗜωᗜ';}else console[_0x3ec98b(0x283)](_0x3ec98b(0x3d4)),document[_0x3ec98b(0x91d)](_0x3ec98b(0xe71))[_0x3ec98b(0xe24)]=_0x3ec98b(0x1032);}async function _0x178ddd(){const _0x525248=_0x419fa8,_0x57750b=document[_0x525248(0x9c8)](_0x525248(0x944));if(!_0x57750b)return;const _0xe21d33=await _0x2c5bcf['qzoneAlbums'][_0x525248(0x8ea)]('createdAt')[_0x525248(0x101e)]()[_0x525248(0x5ff)]();_0x57750b[_0x525248(0x2f5)]='';if(_0xe21d33[_0x525248(0xa06)]===0x0){_0x57750b['innerHTML']=_0x525248(0xaaf);return;}_0xe21d33[_0x525248(0x591)](_0x142c1a=>{const _0x35396b=_0x525248,_0x5afc1e=document[_0x35396b(0x28a)](_0x35396b(0x11f4));_0x5afc1e[_0x35396b(0x82c)]='album-item',_0x5afc1e[_0x35396b(0x2f5)]=_0x35396b(0x67c)+_0x142c1a['coverUrl']+_0x35396b(0xc2f)+_0x142c1a[_0x35396b(0x609)]+_0x35396b(0xf28)+(_0x142c1a[_0x35396b(0x821)]||0x0)+_0x35396b(0xcd5),_0x5afc1e[_0x35396b(0xa0f)](_0x35396b(0xf5c),()=>{_0x73484(_0x142c1a['id']);}),_0x43a60a(_0x5afc1e,async()=>{const _0x14f06a=_0x35396b,_0x53b7d4=await _0x352ae9(_0x14f06a(0xbfc),_0x14f06a(0x1053)+_0x142c1a[_0x14f06a(0x609)]+'》吗？此操作将同时删除相册内的所有照片，且无法恢复。',{'confirmButtonClass':_0x14f06a(0x12bc)});_0x53b7d4&&(await _0x2c5bcf[_0x14f06a(0x373)][_0x14f06a(0xe78)](_0x14f06a(0x2d5))[_0x14f06a(0xda9)](_0x142c1a['id'])[_0x14f06a(0x6d2)](),await _0x2c5bcf[_0x14f06a(0x6dc)][_0x14f06a(0x6d2)](_0x142c1a['id']),await _0x178ddd(),alert(_0x14f06a(0x799)));}),_0x57750b[_0x35396b(0x7b9)](_0x5afc1e);});}async function _0x73484(_0x46628e){const _0x401c73=_0x419fa8;_0x9ebf46[_0x401c73(0x129e)]=_0x46628e,await _0x33fed7(),_0xe5834e('album-photos-screen');}async function _0x33fed7(){const _0x4e4ed5=_0x419fa8;if(!_0x9ebf46[_0x4e4ed5(0x129e)])return;const _0x177a3d=document[_0x4e4ed5(0x9c8)](_0x4e4ed5(0x59e)),_0x46168e=document['getElementById'](_0x4e4ed5(0x759)),_0x38c184=await _0x2c5bcf[_0x4e4ed5(0x6dc)][_0x4e4ed5(0xdf9)](_0x9ebf46[_0x4e4ed5(0x129e)]);if(!_0x38c184){console[_0x4e4ed5(0x1221)]('找不到相册:',_0x9ebf46[_0x4e4ed5(0x129e)]),_0xe5834e(_0x4e4ed5(0x13ab));return;}_0x46168e[_0x4e4ed5(0xe24)]=_0x38c184[_0x4e4ed5(0x609)];const _0x432e72=await _0x2c5bcf[_0x4e4ed5(0x373)][_0x4e4ed5(0xe78)](_0x4e4ed5(0x2d5))[_0x4e4ed5(0xda9)](_0x9ebf46[_0x4e4ed5(0x129e)])[_0x4e4ed5(0x5ff)]();_0x177a3d[_0x4e4ed5(0x2f5)]='',_0x432e72[_0x4e4ed5(0xa06)]===0x0?_0x177a3d['innerHTML']=_0x4e4ed5(0x75d):_0x432e72['forEach'](_0x55c997=>{const _0x2c432e=_0x4e4ed5,_0x258909=document[_0x2c432e(0x28a)](_0x2c432e(0x11f4));_0x258909['className']='photo-item',_0x258909['innerHTML']=_0x2c432e(0x65f)+_0x55c997[_0x2c432e(0x11be)]+'\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22'+_0x55c997['id']+'\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x177a3d['appendChild'](_0x258909);});}async function _0x4a3dab(_0x1dddb5){const _0x4a36f7=_0x419fa8;if(!_0x9ebf46['activeAlbumId'])return;const _0x599a44=await _0x2c5bcf[_0x4a36f7(0x373)]['where']('albumId')[_0x4a36f7(0xda9)](_0x9ebf46[_0x4a36f7(0x129e)])[_0x4a36f7(0x5ff)]();_0x5daebe['photos']=_0x599a44['map'](_0x54d4e4=>_0x54d4e4[_0x4a36f7(0x11be)]),_0x5daebe[_0x4a36f7(0xcc8)]=_0x5daebe[_0x4a36f7(0xf94)]['findIndex'](_0x2b5bac=>_0x2b5bac===_0x1dddb5);if(_0x5daebe[_0x4a36f7(0xcc8)]===-0x1)return;document[_0x4a36f7(0x9c8)](_0x4a36f7(0x510))['classList'][_0x4a36f7(0x68e)](_0x4a36f7(0xc3f)),_0x294b5d(),_0x5daebe[_0x4a36f7(0x84b)]=!![];}function _0x294b5d(){const _0x3627e8=_0x419fa8;if(_0x5daebe[_0x3627e8(0xcc8)]===-0x1)return;const _0xb45169=document[_0x3627e8(0x9c8)](_0x3627e8(0xe79)),_0x414f1b=document[_0x3627e8(0x9c8)](_0x3627e8(0x5f3)),_0x150bbd=document[_0x3627e8(0x9c8)](_0x3627e8(0xf04));_0xb45169[_0x3627e8(0x5e1)]['opacity']=0x0,setTimeout(()=>{const _0x24d208=_0x3627e8;_0xb45169[_0x24d208(0xbf4)]=_0x5daebe[_0x24d208(0xf94)][_0x5daebe['currentIndex']],_0xb45169[_0x24d208(0x5e1)][_0x24d208(0xb17)]=0x1;},0x64),_0x414f1b[_0x3627e8(0x823)]=_0x5daebe['currentIndex']===0x0,_0x150bbd['disabled']=_0x5daebe[_0x3627e8(0xcc8)]===_0x5daebe[_0x3627e8(0xf94)][_0x3627e8(0xa06)]-0x1;}function _0x171ef2(){const _0x4572c0=_0x419fa8;_0x5daebe[_0x4572c0(0xcc8)]<_0x5daebe[_0x4572c0(0xf94)][_0x4572c0(0xa06)]-0x1&&(_0x5daebe['currentIndex']++,_0x294b5d());}function _0x5b1734(){_0x5daebe['currentIndex']>0x0&&(_0x5daebe['currentIndex']--,_0x294b5d());}function _0xbe1012(){const _0xacc5df=_0x419fa8;document[_0xacc5df(0x9c8)](_0xacc5df(0x510))[_0xacc5df(0x575)][_0xacc5df(0x30f)](_0xacc5df(0xc3f)),_0x5daebe[_0xacc5df(0x84b)]=![],_0x5daebe[_0xacc5df(0xf94)]=[],_0x5daebe[_0xacc5df(0xcc8)]=-0x1,document[_0xacc5df(0x9c8)](_0xacc5df(0xe79))[_0xacc5df(0xbf4)]='';}function _0xddb60e(_0x4130f5){const _0x392897=_0x419fa8;_0x776068=_0x4130f5,localStorage[_0x392897(0xa65)]('unreadPostsCount',_0x4130f5);const _0x544cfb=document[_0x392897(0x91d)](_0x392897(0x6df)),_0x5782ac=_0x544cfb[_0x392897(0x91d)](_0x392897(0xf1c));let _0x3056d5=_0x544cfb[_0x392897(0x91d)](_0x392897(0x34a));_0x4130f5>0x0?(!_0x3056d5&&(_0x3056d5=document['createElement'](_0x392897(0xf1c)),_0x3056d5[_0x392897(0x82c)]='unread-indicator',_0x5782ac[_0x392897(0x5e1)][_0x392897(0x54b)]=_0x392897(0xc64),_0x5782ac[_0x392897(0x7b9)](_0x3056d5)),_0x3056d5[_0x392897(0xe24)]=_0x4130f5>0x63?'99+':_0x4130f5,_0x3056d5[_0x392897(0x5e1)][_0x392897(0x3c5)]=_0x392897(0x3d9)):_0x3056d5&&(_0x3056d5[_0x392897(0x5e1)][_0x392897(0x3c5)]=_0x392897(0x8f6)),_0x159e72();}function _0x27aa50(){const _0x2d1dad=_0x419fa8;if(_0x3c8875)return;const _0x3c771c=_0x9ebf46['globalSettings'][_0x2d1dad(0x99a)]||0x3c;_0x3c8875=setInterval(_0x3e9ce9,_0x3c771c*0x3e8),_0x35124d();}function _0x434560(){_0x3c8875&&(clearInterval(_0x3c8875),_0x3c8875=null),_0x4762c1();}async function _0x3e9ce9(){const _0x3b5e81=_0x419fa8;console[_0x3b5e81(0x283)](_0x3b5e81(0x45c));if(!_0x9ebf46[_0x3b5e81(0x1383)][_0x3b5e81(0x22a)]){_0x434560();return;}const _0x108ac4=Object['values'](_0x9ebf46['chats'])[_0x3b5e81(0x401)](_0x2d3cb6=>!_0x2d3cb6[_0x3b5e81(0x11e4)]);_0x108ac4[_0x3b5e81(0x591)](_0x5f25e4=>{const _0x4be448=_0x3b5e81;if(_0x5f25e4[_0x4be448(0x36f)]?.[_0x4be448(0xebd)]===_0x4be448(0xafb)){const _0x5e95cf=_0x5f25e4['relationship'][_0x4be448(0x13c3)];if(!_0x5e95cf)return;const _0x2ae375=Date['now']()-_0x5e95cf,_0x546e06=(_0x9ebf46[_0x4be448(0x1383)][_0x4be448(0x368)]||0x1)*0x3c*0x3c*0x3e8;_0x2ae375>_0x546e06&&(_0x5f25e4['relationship']['status']=_0x4be448(0x791),_0x2ce675(_0x5f25e4['id']));}else{if(_0x5f25e4[_0x4be448(0x36f)]?.['status']===_0x4be448(0x733)&&_0x5f25e4['id']!==_0x9ebf46[_0x4be448(0x970)]){if(_0x5f25e4[_0x4be448(0x1131)][_0x4be448(0x22a)]===![]){console[_0x4be448(0x283)](_0x4be448(0x23a)+_0x5f25e4[_0x4be448(0x609)]+_0x4be448(0x4e3));return;}Math[_0x4be448(0x360)]()<0.2&&(console[_0x4be448(0x283)](_0x4be448(0x23a)+_0x5f25e4[_0x4be448(0x609)]+_0x4be448(0x188)),_0x1dd4ec(_0x5f25e4['id']));}}});const _0x3a01db=Object['values'](_0x9ebf46[_0x3b5e81(0x547)])[_0x3b5e81(0x401)](_0x2c89bb=>_0x2c89bb[_0x3b5e81(0x11e4)]);_0x3a01db['forEach'](_0x2bcad2=>{const _0x2cc46d=_0x3b5e81;if(_0x2bcad2[_0x2cc46d(0x1131)][_0x2cc46d(0x22a)]===![]){console[_0x2cc46d(0x283)](_0x2cc46d(0xaac)+_0x2bcad2[_0x2cc46d(0x609)]+_0x2cc46d(0x73d));return;}_0x2bcad2['id']!==_0x9ebf46[_0x2cc46d(0x970)]&&Math[_0x2cc46d(0x360)]()<0.1&&(console[_0x2cc46d(0x283)](_0x2cc46d(0xaac)+_0x2bcad2[_0x2cc46d(0x609)]+_0x2cc46d(0x188)),_0x40b258(_0x2bcad2['id']));});try{const _0x44125c=await _0x2c5bcf[_0x3b5e81(0x1094)][_0x3b5e81(0x5ff)]();if(_0x44125c['length']===0x0)return;const _0x419c88=await _0x2c5bcf[_0x3b5e81(0x75f)][_0x3b5e81(0x8ea)](_0x3b5e81(0x6b5))[_0x3b5e81(0x101e)]()[_0x3b5e81(0x13bf)](0xa)['toArray']();for(const _0x1a7939 of _0x44125c){if(_0x1a7939[_0x3b5e81(0x22a)]===![])continue;const _0x527b86=_0x1a7939[_0x3b5e81(0x664)]||0xf;if(_0x1a7939[_0x3b5e81(0x6e3)]){const _0x226465=(Date['now']()-_0x1a7939[_0x3b5e81(0x6e3)])/(0x3e8*0x3c);if(_0x226465<_0x527b86)continue;}if(Math[_0x3b5e81(0x360)]()>0.3)continue;const _0x5ac818=[];for(const _0x4bf457 of _0x419c88){if(_0x4bf457[_0x3b5e81(0x61c)]===_0x3b5e81(0x2e7)+_0x1a7939['id'])continue;const _0x5e416b=_0x4bf457[_0x3b5e81(0x1e0)]?.['some'](_0x5afb46=>_0x5afb46[_0x3b5e81(0x6ff)]===_0x1a7939[_0x3b5e81(0x609)]),_0x3aba93=_0x4bf457[_0x3b5e81(0x1e0)]?.[_0x3b5e81(0x1044)](-0x1)[0x0]?.['commenterName'];if(_0x3aba93===_0x1a7939['name'])continue;let _0x502066=![];if(_0x4bf457['authorId']==='user'||_0x4bf457[_0x3b5e81(0x61c)][_0x3b5e81(0xc8d)](_0x3b5e81(0xa63)))_0x1a7939[_0x3b5e81(0x754)][_0x3b5e81(0x930)](_0x4bf457[_0x3b5e81(0x61c)])&&(_0x502066=!![]);else{if(_0x4bf457[_0x3b5e81(0x61c)][_0x3b5e81(0xc8d)](_0x3b5e81(0x2e7))){const _0x23111a=parseInt(_0x4bf457[_0x3b5e81(0x61c)]['replace'](_0x3b5e81(0x2e7),'')),_0x26f79d=await _0x2c5bcf[_0x3b5e81(0x1094)][_0x3b5e81(0xdf9)](_0x23111a);if(_0x26f79d&&_0x26f79d[_0x3b5e81(0x754)]){const _0x1c6696=_0x1a7939[_0x3b5e81(0x754)][_0x3b5e81(0x401)](_0x3aabbc=>_0x26f79d['associatedWith']['includes'](_0x3aabbc));_0x1c6696[_0x3b5e81(0xa06)]>0x0&&(_0x502066=!![]);}}}(_0x502066||_0x5e416b)&&_0x5ac818[_0x3b5e81(0x668)](_0x4bf457);}if(_0x5ac818['length']>0x0||Math[_0x3b5e81(0x360)]()<0.2){console['log']('NPC\x20\x22'+_0x1a7939['name']+_0x3b5e81(0x338));const _0xb2d312=await _0x5aebd6(_0x1a7939,_0x5ac818);if(_0xb2d312&&_0xb2d312[_0x3b5e81(0xa06)]>0x0){for(const _0x4660d0 of _0xb2d312){if(_0x4660d0[_0x3b5e81(0x12d9)]==='qzone_comment'){const _0x3d5719=await _0x2c5bcf['qzonePosts'][_0x3b5e81(0xdf9)](_0x4660d0[_0x3b5e81(0xf23)]);if(_0x3d5719){if(!_0x3d5719[_0x3b5e81(0x1e0)])_0x3d5719[_0x3b5e81(0x1e0)]=[];_0x3d5719[_0x3b5e81(0x1e0)][_0x3b5e81(0x668)]({'commenterName':_0x1a7939[_0x3b5e81(0x609)],'text':_0x4660d0[_0x3b5e81(0x60c)],'replyTo':_0x4660d0[_0x3b5e81(0x6ff)]||null,'timestamp':Date[_0x3b5e81(0x9b7)]()+Math[_0x3b5e81(0x360)]()}),await _0x2c5bcf[_0x3b5e81(0x75f)][_0x3b5e81(0x13a4)](_0x4660d0['postId'],{'comments':_0x3d5719[_0x3b5e81(0x1e0)]}),_0xddb60e(_0x776068+0x1);}}else{if(_0x4660d0[_0x3b5e81(0x12d9)]==='qzone_post'){const _0x35e4e1={'type':_0x4660d0[_0x3b5e81(0x128c)]||_0x3b5e81(0x1238),'content':_0x4660d0[_0x3b5e81(0x53b)],'timestamp':Date[_0x3b5e81(0x9b7)](),'authorId':_0x3b5e81(0x2e7)+_0x1a7939['id'],'authorOriginalName':_0x1a7939[_0x3b5e81(0x609)],'visibleTo':_0x1a7939[_0x3b5e81(0x754)],'likes':[],'comments':[],'isDeleted':![]};await _0x2c5bcf['qzonePosts'][_0x3b5e81(0x68e)](_0x35e4e1),console['log'](_0x3b5e81(0x2de)+_0x1a7939[_0x3b5e81(0x609)]+'\x22\x20成功发布了一条新动态。'),_0xddb60e(_0x776068+0x1);}}}await _0x2c5bcf[_0x3b5e81(0x1094)][_0x3b5e81(0x13a4)](_0x1a7939['id'],{'lastActionTimestamp':Date[_0x3b5e81(0x9b7)]()}),document[_0x3b5e81(0x9c8)](_0x3b5e81(0x81c))['classList']['contains'](_0x3b5e81(0x113d))&&await _0x2c70a9();}}}}catch(_0x557f1f){console['error'](_0x3b5e81(0x216),_0x557f1f);}}async function _0x5aebd6(_0x4fac4f,_0x369542){const _0x6409ad=_0x419fa8,{proxyUrl:_0x3eda23,apiKey:_0x4da422,model:_0x3794d8}=_0x9ebf46[_0x6409ad(0x4de)];if(!_0x3eda23||!_0x4da422||!_0x3794d8)return console['error']('NPC行动失败：API未配置。'),null;let _0x33a12a=_0x6409ad(0xd05);const _0x12ba76=_0x9ebf46['qzoneSettings']['nickname']||'我',_0x31d94d=_0x9ebf46[_0x6409ad(0x547)][Object[_0x6409ad(0x2bd)](_0x9ebf46[_0x6409ad(0x547)])[0x0]]?.[_0x6409ad(0x1131)]['myPersona']||_0x6409ad(0xe1e);_0x33a12a+=_0x6409ad(0x388)+_0x12ba76+'\x20(用户)**:\x20'+_0x31d94d+'\x0a';_0x4fac4f[_0x6409ad(0x754)]&&_0x4fac4f[_0x6409ad(0x754)][_0x6409ad(0xa06)]>0x0&&_0x4fac4f['associatedWith'][_0x6409ad(0x591)](_0x3aa322=>{const _0xd28eab=_0x6409ad,_0x15f872=_0x9ebf46['chats'][_0x3aa322];_0x15f872&&!_0x15f872[_0xd28eab(0x11e4)]&&(_0x33a12a+=_0xd28eab(0x388)+_0x15f872['name']+_0xd28eab(0xdcc)+_0x15f872[_0xd28eab(0x1071)]+_0xd28eab(0x299)+_0x15f872['settings'][_0xd28eab(0xae3)]+'\x0a');});const _0x56e145=(await Promise[_0x6409ad(0xd0a)](_0x369542[_0x6409ad(0xa3b)](async _0x54629b=>{const _0x5a0602=_0x6409ad;let _0x492a5f=_0x5a0602(0x37c);if(_0x54629b[_0x5a0602(0x61c)]===_0x5a0602(0x586))_0x492a5f=_0x9ebf46[_0x5a0602(0x32c)][_0x5a0602(0x5b7)]||'用户';else{if(_0x54629b[_0x5a0602(0x61c)][_0x5a0602(0xc8d)](_0x5a0602(0xa63)))_0x492a5f=_0x1dfc4e(_0x54629b[_0x5a0602(0x12ec)]||_0x54629b['authorId']);else{if(_0x54629b[_0x5a0602(0x61c)][_0x5a0602(0xc8d)](_0x5a0602(0x2e7))){const _0xc2ea48=parseInt(_0x54629b[_0x5a0602(0x61c)][_0x5a0602(0x459)](_0x5a0602(0x2e7),'')),_0x5e4c28=await _0x2c5bcf[_0x5a0602(0x1094)]['get'](_0xc2ea48);_0x5e4c28&&(_0x492a5f=_0x5e4c28[_0x5a0602(0x609)]);}}}const _0x2c0bd2=(_0x54629b[_0x5a0602(0x1e0)]||[])[_0x5a0602(0xa3b)](_0x2a4489=>{const _0x9e7586=_0x5a0602;if(typeof _0x2a4489===_0x9e7586(0xc24)&&_0x2a4489[_0x9e7586(0x8bf)]){const _0x15fc9a=_0x1dfc4e(_0x2a4489[_0x9e7586(0x8bf)]);return _0x9e7586(0x388)+_0x15fc9a+_0x9e7586(0x1bc)+_0x2a4489[_0x9e7586(0xbb7)];}return'-\x20'+_0x2a4489;})['join']('\x0a');return _0x5a0602(0x77c)+_0x54629b['id']+_0x5a0602(0x1169)+_0x492a5f+_0x5a0602(0x11c6)+(_0x54629b[_0x5a0602(0x53b)]||_0x54629b['publicText']||'')['substring'](0x0,0x96)+'...\x0a-\x20**已有评论**:\x0a'+(_0x2c0bd2||_0x5a0602(0x512))+_0x5a0602(0xd00);})))[_0x6409ad(0x809)]('\x0a'),_0x13f7e9=_0x6409ad(0x2e7)+_0x4fac4f['id'],_0x2a0422=Date[_0x6409ad(0x9b7)]()-0xc*0x3c*0x3c*0x3e8,_0x41760b=await _0x2c5bcf[_0x6409ad(0x75f)][_0x6409ad(0xe78)](_0x6409ad(0x61c))[_0x6409ad(0xda9)](_0x13f7e9)[_0x6409ad(0xdb2)](_0x29cd89=>_0x29cd89['timestamp']>_0x2a0422)['toArray']();let _0xd37544='';_0x41760b['length']>0x0&&(_0xd37544='\x0a#\x20【【【行为倾向指令\x20(高优先级)】】】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【首要任务】应该是去**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【应该避免】再次发布新动态，除非你有一个非常紧急或绝佳的新想法。\x0a');const _0x752ca=_0x6409ad(0xed4)+_0x4fac4f[_0x6409ad(0x609)]+'”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a'+_0xd37544+'\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20如果选择评论，优先回复那些提到了你或回复了你的评论。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20'+_0x4fac4f[_0x6409ad(0x609)]+_0x6409ad(0x1089)+_0x4fac4f[_0x6409ad(0xeb1)]+'\x0a\x0a'+_0x33a12a+_0x6409ad(0xc63)+_0x56e145+_0x6409ad(0xe76);try{const _0x366e77=[{'role':_0x6409ad(0x586),'content':'请根据你的设定，开始你的行动。'}];let _0x3336e3=_0x3eda23[_0x6409ad(0x930)](_0x6409ad(0xb23)),_0x1065de=_0x2e5c04(_0x3794d8,_0x4da422,_0x752ca,_0x366e77);const _0x12766a=_0x3336e3?await fetch(_0x1065de[_0x6409ad(0x11be)],_0x1065de[_0x6409ad(0x100d)]):await fetch(_0x3eda23+_0x6409ad(0x1090),{'method':'POST','headers':{'Content-Type':_0x6409ad(0x698),'Authorization':'Bearer\x20'+_0x4da422},'body':JSON['stringify']({'model':_0x3794d8,'messages':[{'role':_0x6409ad(0xb64),'content':_0x752ca},..._0x366e77],'temperature':_0x9ebf46['globalSettings'][_0x6409ad(0xc3d)]||0.9})});if(!_0x12766a['ok'])throw new Error(_0x6409ad(0x8ab)+_0x12766a[_0x6409ad(0x399)]);const _0x406065=await _0x12766a[_0x6409ad(0x5dd)](),_0x1968ce=getGeminiResponseText(_0x406065),_0x5f9d25=_0x1968ce[_0x6409ad(0x12c2)](/(\[[\s\S]*\])/);if(!_0x5f9d25)throw new Error(_0x6409ad(0x986));return JSON['parse'](_0x5f9d25[0x0]);}catch(_0x5732b3){return console[_0x6409ad(0x1221)]('为NPC\x20\x22'+_0x4fac4f[_0x6409ad(0x609)]+_0x6409ad(0xb92),_0x5732b3),null;}}async function _0x1dd4ec(_0x9d8526){const _0x112831=_0x419fa8,_0x243d95=_0x9ebf46[_0x112831(0x547)][_0x9d8526];if(!_0x243d95)return;const _0x4124dc=_0x243d95[_0x112831(0x1131)][_0x112831(0x664)]||0xa;if(_0x243d95[_0x112831(0x6e3)]){const _0x5773bf=(Date[_0x112831(0x9b7)]()-_0x243d95[_0x112831(0x6e3)])/(0x3e8*0x3c);if(_0x5773bf<_0x4124dc){console[_0x112831(0x283)]('角色\x20\x22'+_0x243d95[_0x112831(0x609)]+_0x112831(0x311)+Math[_0x112831(0xe3e)](_0x4124dc-_0x5773bf)+'\x20分钟)，本次独立行动跳过。');return;}}_0x39290a(_0x9d8526,!![]);const {proxyUrl:_0x428517,apiKey:_0x43a415,model:_0x3d68c8}=_0x9ebf46[_0x112831(0x4de)];if(!_0x428517||!_0x43a415||!_0x3d68c8)return;const _0x528941=_0x9ebf46[_0x112831(0x32c)][_0x112831(0x5b7)],_0x39f56c=new Date(),_0x111958=_0x243d95[_0x112831(0x1131)][_0x112831(0x11ee)]||_0x112831(0xdfb),_0x2ab117=_0x39f56c[_0x112831(0x135b)](_0x112831(0x101b),{'timeZone':_0x111958,'dateStyle':_0x112831(0x1088),'timeStyle':_0x112831(0x4ea)}),_0xb17117=new Date(_0x39f56c['toLocaleString'](_0x112831(0x1035),{'timeZone':_0x111958}));let _0x598c66='',_0x1ab23e='',_0x144e04,_0x3e963b=![];const _0x294032=_0x243d95[_0x112831(0x1131)]['maxMemory']||0xa,_0x1070ec=_0x243d95[_0x112831(0x8b3)][_0x112831(0x401)](_0x382eec=>!_0x382eec['isHidden'])[_0x112831(0x1044)](-_0x294032),_0x3d593c=_0x243d95['history'][_0x112831(0x401)](_0x4c5e12=>!_0x4c5e12['isHidden'])[_0x112831(0x1044)](-0x1)[0x0];if(_0x243d95['settings'][_0x112831(0x64b)]){_0x598c66=_0x526327(_0xb17117);const _0x4a288f=_0x243d95['history'][_0x112831(0x401)](_0x3ba0c3=>!_0x3ba0c3[_0x112831(0xc62)])[_0x112831(0x1044)](-0x1)[0x0],_0x204198=new Date();let _0x4c8cb3='',_0x53c12c=![];if(_0x4a288f){const _0x4780a1=new Date(_0x4a288f[_0x112831(0x6b5)]),_0x4140ea=(_0x204198-_0x4780a1)/(0x3e8*0x3c*0x3c);if(_0x4140ea>0xc){_0x53c12c=!![];const _0xc15c67=Math[_0x112831(0x5fb)](_0x4140ea/0x18);_0x4c8cb3=_0x112831(0x69f)+(_0xc15c67>0x0?_0xc15c67+'天':Math[_0x112831(0x5fb)](_0x4140ea)+'小时')+_0x112831(0xdc5);}else{const _0x4b2c6a=Math['floor'](_0x4140ea*0x3c);if(_0x4b2c6a<0x5)_0x4c8cb3=_0x112831(0xf07);else _0x4b2c6a<0x3c?_0x4c8cb3=_0x112831(0xba8)+_0x4b2c6a+_0x112831(0x482):_0x4c8cb3=_0x112831(0xba8)+Math['floor'](_0x4140ea)+_0x112831(0x40a);}}else _0x53c12c=!![],_0x4c8cb3='这是你们的第一次互动。';let _0x5f40a7='你们最近没有有效聊天记录。';_0x1070ec[_0x112831(0xa06)]>0x0&&(_0x5f40a7=_0x112831(0x353)+_0x1070ec['map'](_0x1962f5=>{const _0x12a2f1=_0x112831,_0x4741c9=_0x1962f5[_0x12a2f1(0x7fd)]===_0x12a2f1(0x586)?_0x528941:_0x243d95['name'];return _0x4741c9+':\x20'+String(_0x1962f5[_0x12a2f1(0x53b)])[_0x12a2f1(0xc34)](0x0,0x32)+_0x12a2f1(0xf66);})[_0x112831(0x809)]('\x0a')),_0x53c12c?_0x144e04=_0x112831(0xcf2)+_0x4c8cb3+_0x112831(0x1114)+_0x2ab117+_0x112831(0x3ea)+_0x5f40a7:_0x144e04=''+_0x5f40a7;}else _0x1070ec['length']>0x0?_0x144e04=_0x112831(0x353)+_0x1070ec[_0x112831(0xa3b)](_0x5d1d85=>{const _0x487e98=_0x112831,_0x2b07ac=_0x5d1d85['role']===_0x487e98(0x586)?_0x528941:_0x243d95[_0x487e98(0x609)];return _0x2b07ac+':\x20'+String(_0x5d1d85[_0x487e98(0x53b)])[_0x487e98(0xc34)](0x0,0x32)+_0x487e98(0xf66);})[_0x112831(0x809)]('\x0a'):_0x144e04=_0x112831(0x7c0);const _0x4e6f54=await _0x2c5bcf['qzonePosts'][_0x112831(0x8ea)](_0x112831(0x6b5))[_0x112831(0x101e)]()[_0x112831(0x13bf)](0x5)[_0x112831(0x5ff)](),_0x4231e9=_0x499cd0(_0x4e6f54,_0x243d95),_0x9f0e26=_0x4231e9[_0x112831(0x401)](_0x8dcc5d=>_0x8dcc5d['authorId']===_0x9d8526);let _0x1d3db5='';_0x9f0e26[_0x112831(0xa06)]>0x0&&(_0x1d3db5=_0x112831(0xbb6),_0x9f0e26['forEach'](_0x11bf5b=>{const _0x4abd0e=_0x112831;let _0x54f048=(_0x11bf5b['publicText']||_0x11bf5b['content']||_0x4abd0e(0xca0))[_0x4abd0e(0xc34)](0x0,0x28)+_0x4abd0e(0xf66);_0x1d3db5+=_0x4abd0e(0x90a)+_0x11bf5b['id']+_0x4abd0e(0xdb7)+_0x54f048+'\x22\x0a';}));let _0x5de0a2=[];_0x4231e9[_0x112831(0xa06)]>0x0&&(_0x5de0a2=_0x4231e9[_0x112831(0xa3b)](_0x37ef86=>{const _0x3c8f68=_0x112831;let _0x4901ef;if(_0x37ef86[_0x3c8f68(0x12d9)]===_0x3c8f68(0xf74))_0x4901ef=('[一张图片，其隐藏文字为：“'+_0x37ef86['hiddenContent']+_0x3c8f68(0x68c)+(_0x37ef86[_0x3c8f68(0x7b2)]||''))['substring'](0x0,0x32)+_0x3c8f68(0xf66);else _0x37ef86[_0x3c8f68(0x12d9)]===_0x3c8f68(0x55b)?_0x4901ef=(_0x3c8f68(0xaa2)+_0x37ef86[_0x3c8f68(0xb34)]+_0x3c8f68(0x68c)+(_0x37ef86[_0x3c8f68(0x7b2)]||''))[_0x3c8f68(0xc34)](0x0,0x32)+'...':_0x4901ef=String(_0x37ef86[_0x3c8f68(0x7b2)]||_0x37ef86[_0x3c8f68(0x53b)]||_0x3c8f68(0xca0))[_0x3c8f68(0xc34)](0x0,0x32)+'...';return _0x3c8f68(0x44e)+_0x4901ef+'\x22';}));let _0x40ff18='';_0x5de0a2[_0x112831(0xa06)]>0x0&&(_0x40ff18=_0x112831(0xba3)+_0x5de0a2[_0x112831(0x809)]('\x0a')+_0x112831(0xdde));let _0x49638a='';if(_0x243d95[_0x112831(0x1131)][_0x112831(0x41a)]&&_0x243d95[_0x112831(0x1131)][_0x112831(0x41a)][_0x112831(0xa06)]>0x0){const _0x487549=_0x243d95[_0x112831(0x1131)][_0x112831(0x41a)]['map'](_0x465f70=>{const _0x251d92=_0x112831,_0x1d3289=_0x9ebf46['worldBooks'][_0x251d92(0xfc3)](_0x18f3cb=>_0x18f3cb['id']===_0x465f70);if(!_0x1d3289||!Array[_0x251d92(0xb27)](_0x1d3289[_0x251d92(0x53b)]))return'';const _0xe01594=_0x1d3289['content'][_0x251d92(0x401)](_0x29eeb6=>_0x29eeb6[_0x251d92(0x38a)]!==![])[_0x251d92(0xa3b)](_0x3476a6=>{const _0x116203=_0x251d92;let _0x462dd8=_0x116203(0x1085)+(_0x3476a6[_0x116203(0x10de)]||_0x116203(0xf27))+'\x0a';return _0x3476a6[_0x116203(0x2bd)]['length']>0x0&&(_0x462dd8+=_0x116203(0x9fc)+_0x3476a6[_0x116203(0x2bd)][_0x116203(0x809)](',\x20')+'\x0a'),_0x462dd8+=_0x116203(0x246)+_0x3476a6[_0x116203(0x53b)],_0x462dd8;})[_0x251d92(0x809)]('');return _0xe01594?_0x251d92(0xbac)+_0x1d3289[_0x251d92(0x609)]+'\x0a'+_0xe01594:'';})[_0x112831(0x401)](Boolean)[_0x112831(0x809)]('');_0x487549&&(_0x49638a=_0x112831(0xb13)+_0x487549+_0x112831(0x98a));}let _0x4d6cb7='';const _0x48098e=_0x243d95[_0x112831(0x1131)][_0x112831(0xf9f)]||0xa;if(_0x243d95[_0x112831(0x1131)][_0x112831(0xfeb)]&&_0x243d95[_0x112831(0x1131)][_0x112831(0xfeb)][_0x112831(0xa06)]>0x0){const _0x2a9f98=_0x243d95[_0x112831(0x1131)]['linkedMemoryChatIds'][_0x112831(0xa3b)](_0x37f0f6=>{const _0x51286f=_0x112831,_0x13c70e=_0x9ebf46[_0x51286f(0x547)][_0x37f0f6];if(!_0x13c70e)return null;const _0xe254c3=_0x13c70e['history'][_0x51286f(0x1044)](-0x1)[0x0];return{'chat':_0x13c70e,'latestTimestamp':_0xe254c3?_0xe254c3[_0x51286f(0x6b5)]:0x0};})[_0x112831(0x401)](Boolean);_0x2a9f98[_0x112831(0x66b)]((_0xb88917,_0x14d10d)=>_0x14d10d['latestTimestamp']-_0xb88917[_0x112831(0xe98)]),_0x4d6cb7+='\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a';for(const _0xa319f7 of _0x2a9f98){const _0x36801c=_0xa319f7[_0x112831(0x8b0)],_0x167d17=_0x36801c['isGroup']?_0x112831(0x93a):_0x112831(0x94e),_0x121a57=_0xa319f7[_0x112831(0xe98)]>0x0?_0x112831(0x9be)+_0x4fcd92(_0xa319f7[_0x112831(0xe98)])+')':'';_0x4d6cb7+=_0x112831(0x1018)+_0x167d17+'“'+_0x36801c[_0x112831(0x609)]+_0x112831(0x97f)+_0x121a57+'\x20---\x0a';const _0x15a269=_0x36801c[_0x112831(0x8b3)][_0x112831(0x1044)](-_0x48098e),_0x4124c2=_0x15a269[_0x112831(0x401)](_0x290bc4=>!String(_0x290bc4[_0x112831(0x53b)])[_0x112831(0x930)](_0x112831(0x420)));_0x4124c2[_0x112831(0xa06)]>0x0?_0x4124c2[_0x112831(0x591)](_0x422d7d=>{const _0x3e7eaa=_0x112831,_0x6f23f7=_0x422d7d['role']===_0x3e7eaa(0x586)?_0x36801c[_0x3e7eaa(0x1131)][_0x3e7eaa(0x29c)]||'我':_0x422d7d[_0x3e7eaa(0xac4)]||_0x36801c['name'];let _0x195609=String(_0x422d7d['content']);if(_0x422d7d['type']===_0x3e7eaa(0x835)||_0x422d7d[_0x3e7eaa(0x12d9)]===_0x3e7eaa(0x560))_0x195609=_0x3e7eaa(0x10d1)+_0x422d7d['content']+']';else _0x422d7d[_0x3e7eaa(0x12d9)]===_0x3e7eaa(0x10c1)&&(_0x195609=_0x3e7eaa(0x111b)+_0x422d7d[_0x3e7eaa(0x53b)]+']');_0x4d6cb7+=_0x6f23f7+':\x20'+_0x195609+'\x0a';}):_0x4d6cb7+='(暂无有效聊天记录)\x0a';}}let _0x149d3a='';if(_0x4231e9[_0x112831(0xa06)]>0x0){let _0x3d5485=_0x112831(0x9bd);for(const _0x5e4c8d of _0x4231e9){let _0xdd67bc;if(_0x5e4c8d[_0x112831(0x61c)]===_0x112831(0x586))_0xdd67bc=_0x9ebf46[_0x112831(0x32c)][_0x112831(0x5b7)];else{if(String(_0x5e4c8d[_0x112831(0x61c)])[_0x112831(0xc8d)](_0x112831(0x2e7)))_0xdd67bc=_0x5e4c8d[_0x112831(0x12ec)]||_0x112831(0x1034);else{const _0x365dac=_0x9ebf46['chats'][_0x5e4c8d[_0x112831(0x61c)]];_0xdd67bc=_0x365dac?_0x365dac[_0x112831(0x609)]:_0x112831(0x7fc);}}if(_0x5e4c8d['authorId']===_0x9d8526)_0xdd67bc+=_0x112831(0x98b);let _0x4b34bc;if(_0x5e4c8d[_0x112831(0x12d9)]==='repost'){const _0x735915=_0x5e4c8d[_0x112831(0x104d)]?_0x112831(0xdd5)+_0x5e4c8d['repostComment']+'\x22':'';let _0x3f3f78='原作者';const _0x5b5a43=_0x5e4c8d[_0x112831(0xc26)]['authorId'];if(_0x5b5a43===_0x112831(0x586))_0x3f3f78=_0x9ebf46[_0x112831(0x32c)][_0x112831(0x5b7)];else _0x9ebf46['chats'][_0x5b5a43]&&(_0x3f3f78=_0x9ebf46[_0x112831(0x547)][_0x5b5a43][_0x112831(0x609)]);let _0x2c0f00;const _0x46fb40=_0x5e4c8d[_0x112831(0xc26)];if(_0x46fb40['type']===_0x112831(0xf74))_0x2c0f00=_0x112831(0xa99)+(_0x46fb40[_0x112831(0x7b2)]||'')+_0x112831(0x11cd)+(_0x46fb40[_0x112831(0x841)]||'')[_0x112831(0xc34)](0x0,0x28)+_0x112831(0xeed);else _0x46fb40[_0x112831(0x12d9)]===_0x112831(0x55b)?_0x2c0f00=_0x112831(0xc90)+(_0x46fb40[_0x112831(0x7b2)]||'')+_0x112831(0x11cd)+(_0x46fb40[_0x112831(0xb34)]||'')[_0x112831(0xc34)](0x0,0x28)+_0x112831(0xeed):_0x2c0f00='\x22'+(_0x46fb40[_0x112831(0x53b)]||'')['substring'](0x0,0x28)+'...\x22';_0x4b34bc='转发了\x20@'+_0x3f3f78+'\x20的动态\x20'+_0x735915+'【原动态内容:\x20'+_0x2c0f00+'】';}else{if(_0x5e4c8d['type']==='text_image')_0x4b34bc=(_0x112831(0x717)+_0x5e4c8d[_0x112831(0x841)]+_0x112831(0xd49)+(_0x5e4c8d[_0x112831(0x7b2)]||''))[_0x112831(0xc34)](0x0,0x32)+_0x112831(0xf66);else{if(_0x5e4c8d[_0x112831(0x12d9)]===_0x112831(0x55b))_0x4b34bc=(_0x112831(0x553)+_0x5e4c8d[_0x112831(0xb34)]+'\x22]\x20'+(_0x5e4c8d[_0x112831(0x7b2)]||''))[_0x112831(0xc34)](0x0,0x32)+_0x112831(0xf66);else{if(_0x5e4c8d[_0x112831(0x12d9)]===_0x112831(0x1227)&&_0x5e4c8d['prompt']){const _0x2039da=Array['isArray'](_0x5e4c8d[_0x112831(0xd34)])?_0x5e4c8d['prompt']:[_0x5e4c8d[_0x112831(0xd34)]];_0x4b34bc=(_0x5e4c8d[_0x112831(0x7b2)]||'')+('\x20[包含'+_0x2039da[_0x112831(0xa06)]+_0x112831(0x8ec)+_0x2039da[_0x112831(0x809)](',\x20')+']');}else _0x4b34bc=String(_0x5e4c8d[_0x112831(0x7b2)]||_0x5e4c8d[_0x112831(0x53b)]||_0x112831(0xca0))[_0x112831(0xc34)](0x0,0x32)+'...';}}}_0x3d5485+=_0x112831(0x90a)+_0x5e4c8d['id']+_0x112831(0x11cc)+_0xdd67bc+_0x112831(0x110a)+_0x4b34bc+'\x22\x0a';if(_0x5e4c8d[_0x112831(0x1e0)]&&_0x5e4c8d[_0x112831(0x1e0)][_0x112831(0xa06)]>0x0)for(const _0xbe64c2 of _0x5e4c8d[_0x112831(0x1e0)]){if(typeof _0xbe64c2===_0x112831(0xc24)&&_0xbe64c2['commenterName']){const _0x3efe23=_0x1dfc4e(_0xbe64c2[_0x112831(0x8bf)]);let _0x4ad884=_0xbe64c2['meaning']?_0x112831(0x134e)+_0xbe64c2[_0x112831(0x1b3)]+'\x27]':_0xbe64c2[_0x112831(0xbb7)];_0xbe64c2['commenterName']===_0x243d95[_0x112831(0x1071)]?_0x3d5485+='\x20\x20-\x20你评论说:\x20'+_0x4ad884+'\x0a':_0x3d5485+=_0x112831(0xbb1)+_0x3efe23+_0x112831(0xdcc)+_0xbe64c2['commenterName']+_0x112831(0x301)+_0x4ad884+'\x0a';}}}_0x149d3a=_0x3d5485;}const _0x5b18ed='#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a'+(_0x243d95[_0x112831(0x323)]&&_0x243d95[_0x112831(0x323)][_0x112831(0xa06)]>0x0?_0x243d95[_0x112831(0x323)]['map'](_0x54c10d=>'-\x20(记录于\x20'+_0x4fcd92(_0x54c10d['timestamp'])+')\x20'+_0x54c10d[_0x112831(0x53b)])[_0x112831(0x809)]('\x0a'):'-\x20(暂无)'),_0xef7e4b=_0xbdd100(_0x243d95,0x3,_0x112831(0x658)),_0xe67e53=_0xbdd100(_0x243d95,0x6,_0x112831(0x658)),_0x4a9c98=_0xbdd100(_0x243d95,0x9,_0x112831(0x658)),_0x2b56be=_0xbdd100(_0x243d95,0x1,_0x112831(0x929)),_0x2e4e04=_0xbdd100(_0x243d95,0x3,_0x112831(0x929)),_0xa336bf=_0xbdd100(_0x243d95,0x7,'days');let _0x43f0cd='';if(_0xef7e4b||_0xe67e53||_0x4a9c98||_0x2b56be||_0x2e4e04||_0xa336bf){_0x43f0cd+=_0x112831(0x6ce);if(_0xef7e4b)_0x43f0cd+=_0xef7e4b;if(_0xe67e53)_0x43f0cd+=_0xe67e53;if(_0x4a9c98)_0x43f0cd+=_0x4a9c98;if(_0xef7e4b||_0xe67e53||_0x4a9c98)_0x43f0cd+='\x0a';if(_0x2b56be)_0x43f0cd+=_0x2b56be;if(_0x2e4e04)_0x43f0cd+=_0x2e4e04;if(_0xa336bf)_0x43f0cd+=_0xa336bf;}const _0xbe5bb5=_0x389fa5(_0x243d95),_0x47f879='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22'+_0x243d95[_0x112831(0x609)]+'\x22的角色（你的本名是\x22'+_0x243d95[_0x112831(0x1071)]+_0x112831(0x278)+_0x528941+_0x112831(0x12fa)+(_0x243d95[_0x112831(0x1131)][_0x112831(0x64b)]?_0x112831(0x1298)+_0x2ab117+'\x20('+_0x598c66+')}。\x0a-\x20**对话状态**:\x20'+_0x1ab23e+'\x0a'+(_0x3e963b?_0x112831(0xd65):''):'')+_0x112831(0x1250)+(_0x243d95[_0x112831(0x74f)]||'无')+_0x112831(0xc46)+_0x40ff18+_0x112831(0xdde)+_0x1d3db5+_0x112831(0x1030)+_0x243d95[_0x112831(0x1131)][_0x112831(0xae3)]+_0x112831(0xdde)+_0x49638a+_0x112831(0xdde)+(_0x243d95[_0x112831(0x323)]&&_0x243d95[_0x112831(0x323)][_0x112831(0xa06)]>0x0?_0x243d95[_0x112831(0x323)]['map'](_0x56ed6a=>_0x112831(0x1dc)+_0x4fcd92(_0x56ed6a['timestamp'])+')\x20'+_0x56ed6a[_0x112831(0x53b)])[_0x112831(0x809)]('\x0a'):'无')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x43f0cd+_0x112831(0xa14)+_0x4d6cb7+_0x112831(0xdde)+(_0x243d95[_0x112831(0x1131)][_0x112831(0x64b)]?_0x112831(0x601)+_0x2ab117+'\x20('+_0x598c66+')':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x243d95[_0x112831(0x1131)]['enableTimePerception']?'-\x20\x20\x20**对话状态**:\x20'+_0x1ab23e:'')+_0x112831(0x965)+_0xbe5bb5+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20'+_0x144e04+_0x112831(0xdde)+_0x149d3a+'\x0a',_0x4a4c1f=[{'role':_0x112831(0xb64),'content':_0x47f879},..._0x1070ec[_0x112831(0xa3b)](_0x8833bd=>{const _0x514d92=_0x112831,_0x1365d8=_0x8833bd[_0x514d92(0x7fd)]==='user'?_0x528941:_0x243d95['name'];let _0x162356=_0x8833bd['content'];return typeof _0x162356!=='string'&&(_0x162356=JSON[_0x514d92(0xf1e)](_0x162356)),{'role':_0x8833bd['role'],'content':_0x1365d8+':\x20'+_0x162356};})];try{const _0x50c741=[{'role':'user','content':_0x47f879+'\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a'+_0x149d3a}];console[_0x112831(0x283)](_0x112831(0x2f6)+_0x243d95[_0x112831(0x609)]+'\x22)');let _0x1f8824=_0x428517===GEMINI_API_URL,_0x55f5f1=_0x2e5c04(_0x3d68c8,_0x43a415,_0x47f879,_0x50c741);const _0xf11c91=_0x1f8824?await fetch(_0x55f5f1[_0x112831(0x11be)],_0x55f5f1[_0x112831(0x100d)]):await fetch(_0x428517+_0x112831(0x1090),{'method':'POST','headers':{'Content-Type':_0x112831(0x698),'Authorization':'Bearer\x20'+_0x43a415},'body':JSON[_0x112831(0xf1e)]({'model':_0x3d68c8,'messages':_0x50c741,'temperature':_0x9ebf46['globalSettings'][_0x112831(0xc3d)]||0.9})});if(!_0xf11c91['ok']){const _0xec00be=await _0xf11c91[_0x112831(0x5dd)]();throw new Error(_0x112831(0x723)+_0xf11c91[_0x112831(0xebd)]+'\x20-\x20'+JSON[_0x112831(0xf1e)](_0xec00be));}const _0x3612c2=await _0xf11c91[_0x112831(0x5dd)](),_0x22063e=_0x1f8824?getGeminiResponseText(_0x3612c2):_0x3612c2[_0x112831(0xfd2)][0x0][_0x112831(0x86e)][_0x112831(0x53b)];if(!_0x22063e||_0x22063e[_0x112831(0x3f1)]()===''){console[_0x112831(0x453)]('API为空回，角色\x20\x22'+_0x243d95[_0x112831(0x609)]+'\x22\x20的本次后台活动跳过。');return;}const _0x2e27c9=_0x169d92(_0x22063e);if(!_0x2e27c9||_0x2e27c9[_0x112831(0xa06)]===0x0){console['warn'](_0x112831(0x1005)+_0x243d95['name']+_0x112831(0xdfc),_0x22063e);return;}let _0x4c41c7=Date[_0x112831(0x9b7)](),_0x3fe517=![];const _0x1ab418=[];for(const _0x1a3ff2 of _0x2e27c9){const _0x255a0a=String(_0x1a3ff2['content']||''),_0x4e49c0=_0x255a0a['trim']()[_0x112831(0xc8d)]('<')&&_0x255a0a[_0x112831(0x3f1)]()[_0x112831(0x6b1)]('>');if(_0x1a3ff2[_0x112831(0x12d9)]===_0x112831(0xbb7)&&!_0x4e49c0&&_0x255a0a[_0x112831(0x930)]('\x0a')){const _0x4fcd75=_0x255a0a['split'](/\n+/)[_0x112831(0x401)](_0xfa7a3f=>_0xfa7a3f[_0x112831(0x3f1)]());_0x4fcd75[_0x112831(0x591)](_0x428bba=>{_0x1ab418['push']({..._0x1a3ff2,'content':_0x428bba});});}else _0x1ab418[_0x112831(0x668)](_0x1a3ff2);}for(const _0x19c9bf of _0x1ab418){_0x243d95['lastActionType']=_0x19c9bf['type'],_0x243d95[_0x112831(0x6e3)]=_0x4c41c7;let _0x4ea9b3=null;const _0x1a2e27={'role':'assistant','senderName':_0x243d95['originalName'],'timestamp':_0x4c41c7++};let _0x369826=null;switch(_0x19c9bf[_0x112831(0x12d9)]){case _0x112831(0x87c):{const _0x25f321=parseInt(_0x19c9bf[_0x112831(0xf23)]),_0x72b165=await _0x2c5bcf[_0x112831(0x75f)]['get'](_0x25f321);if(_0x72b165&&_0x72b165[_0x112831(0x61c)]===_0x9d8526){await _0x2c5bcf[_0x112831(0x75f)]['update'](_0x25f321,{'isDeleted':!![]});document[_0x112831(0x9c8)](_0x112831(0x81c))[_0x112831(0x575)][_0x112831(0x1038)]('active')&&_0x2c70a9();const _0x192cdd={'role':_0x112831(0xb64),'type':_0x112831(0x10a6),'content':'['+_0x243d95[_0x112831(0x609)]+_0x112831(0xf05),'postId':_0x25f321,'timestamp':_0x4c41c7++};_0x243d95[_0x112831(0x8b3)][_0x112831(0x668)](_0x192cdd),isViewingThisChat?_0xc4e879(_0x192cdd,_0x243d95):(_0x243d95['unreadCount']=(_0x243d95['unreadCount']||0x0)+0x1,_0x52c10d(_0x9d8526,'['+_0x243d95[_0x112831(0x609)]+_0x112831(0xf05)),_0x3fe517=!![]);}else console[_0x112831(0x453)](_0x112831(0x1297)+_0x243d95[_0x112831(0x609)]+_0x112831(0x10cc)+_0x19c9bf[_0x112831(0xf23)]+')');continue;}case'text':_0x4ea9b3={..._0x1a2e27,'content':_0x19c9bf[_0x112831(0x53b)]};break;case _0x112831(0x835):_0x4ea9b3={..._0x1a2e27,'type':_0x112831(0x835),'content':_0x19c9bf[_0x112831(0x1387)]};break;case _0x112831(0x83e):if(_0x19c9bf[_0x112831(0x1b3)]){const _0x354c12=_0x9ebf46['userStickers']['find'](_0x59e40b=>_0x59e40b[_0x112831(0x609)]===_0x19c9bf[_0x112831(0x1b3)]);_0x354c12?_0x4ea9b3={..._0x1a2e27,'type':'sticker','content':_0x354c12['url'],'meaning':_0x354c12[_0x112831(0x609)]}:(console[_0x112831(0x453)](_0x112831(0xafd)+_0x19c9bf[_0x112831(0x1b3)]+'\x22'),_0x4ea9b3={..._0x1a2e27,'type':_0x112831(0xbb7),'content':_0x112831(0xef0)+_0x19c9bf[_0x112831(0x1b3)]+']'});}else console['warn'](_0x112831(0x10d2),_0x19c9bf),_0x4ea9b3={..._0x1a2e27,'type':_0x112831(0x83e),'content':_0x19c9bf['url'],'meaning':_0x112831(0xdbe)};break;case _0x112831(0xff8):_0x243d95[_0x112831(0xebd)][_0x112831(0xbb7)]=_0x19c9bf[_0x112831(0xcf1)],_0x243d95[_0x112831(0xebd)]['isBusy']=_0x19c9bf[_0x112831(0x1390)]||![],_0x243d95[_0x112831(0xebd)]['lastUpdate']=Date[_0x112831(0x9b7)]();break;case _0x112831(0x411):const _0x3e0ef4={'type':_0x19c9bf['postType'],'content':_0x19c9bf['content']||'','publicText':_0x19c9bf[_0x112831(0x7b2)]||'','hiddenContent':_0x19c9bf[_0x112831(0x841)]||'','image_prompt':_0x19c9bf[_0x112831(0xd73)]||'','timestamp':Date[_0x112831(0x9b7)](),'authorId':_0x9d8526,'authorOriginalName':_0x243d95['originalName'],'authorGroupId':_0x243d95[_0x112831(0x7b1)],'visibleGroupIds':null};await _0x2c5bcf['qzonePosts']['add'](_0x3e0ef4),_0xddb60e(_0x776068+0x1),console[_0x112831(0x283)](_0x112831(0x1078)+_0x243d95['name']+_0x112831(0x1199));break;case _0x112831(0x75b):const _0x1fbe24=await _0x2c5bcf['qzonePosts'][_0x112831(0xdf9)](parseInt(_0x19c9bf[_0x112831(0xf23)]));if(_0x1fbe24){const _0x24c04e={'type':_0x112831(0x75b),'timestamp':Date[_0x112831(0x9b7)](),'authorId':_0x9d8526,'authorGroupId':_0x243d95['groupId'],'authorOriginalName':_0x243d95[_0x112831(0x1071)],'repostComment':_0x19c9bf[_0x112831(0x10de)]||'','originalPost':_0x1fbe24,'visibleGroupIds':null};await _0x2c5bcf[_0x112831(0x75f)][_0x112831(0x68e)](_0x24c04e),_0xddb60e(_0x776068+0x1),console[_0x112831(0x283)](_0x112831(0x1078)+_0x243d95[_0x112831(0x609)]+_0x112831(0xe34)+_0x19c9bf[_0x112831(0xf23)]);}break;case _0x112831(0xfe8):const _0x1d8030=await _0x2c5bcf[_0x112831(0x75f)]['get'](parseInt(_0x19c9bf[_0x112831(0xf23)]));if(_0x1d8030){if(!_0x1d8030[_0x112831(0x315)])_0x1d8030['likes']=[];!_0x1d8030[_0x112831(0x315)][_0x112831(0x930)](_0x243d95[_0x112831(0x1071)])&&(_0x1d8030['likes'][_0x112831(0x668)](_0x243d95[_0x112831(0x1071)]),await _0x2c5bcf[_0x112831(0x75f)][_0x112831(0x13a4)](_0x1d8030['id'],{'likes':_0x1d8030[_0x112831(0x315)]}),_0xddb60e(_0x776068+0x1),console[_0x112831(0x283)](_0x112831(0x1078)+_0x243d95[_0x112831(0x609)]+_0x112831(0xadc)+_0x19c9bf['postId']));}break;case _0x112831(0xc6d):{const _0x46c2c5=await _0x2c5bcf[_0x112831(0x75f)][_0x112831(0xdf9)](parseInt(_0x19c9bf[_0x112831(0xf23)]));if(_0x46c2c5){if(!_0x46c2c5[_0x112831(0x1e0)])_0x46c2c5[_0x112831(0x1e0)]=[];const _0x1f0958=_0x19c9bf[_0x112831(0x609)]||_0x243d95['originalName'],_0x357d4b=(_0x161936,_0x5e47a4=null,_0x7332ec=null)=>({'commenterName':_0x1f0958,'text':_0x742a79(_0x161936,_0x243d95),'meaning':_0x5e47a4,'replyTo':_0x7332ec,'timestamp':Date[_0x112831(0x9b7)]()});if(_0x19c9bf[_0x112831(0x1386)]){const _0x2b0bf5=_0x9ebf46[_0x112831(0x774)][_0x112831(0xfc3)](_0x4118ac=>_0x4118ac[_0x112831(0x609)]===_0x19c9bf[_0x112831(0x1386)]);_0x2b0bf5?_0x46c2c5[_0x112831(0x1e0)][_0x112831(0x668)](_0x357d4b(_0x2b0bf5['url'],_0x2b0bf5[_0x112831(0x609)],_0x19c9bf[_0x112831(0x6ff)]||null)):(console[_0x112831(0x453)](_0x112831(0x9fb)+_0x19c9bf[_0x112831(0x1386)]+'\x22'),_0x46c2c5[_0x112831(0x1e0)][_0x112831(0x668)](_0x357d4b(_0x112831(0xef0)+_0x19c9bf['stickerMeaning']+']',null,_0x19c9bf[_0x112831(0x6ff)]||null)));}else{if(Array[_0x112831(0xb27)](_0x19c9bf[_0x112831(0x1e0)]))_0x19c9bf[_0x112831(0x1e0)][_0x112831(0x591)](_0x315e46=>{const _0x875bb8=_0x112831;typeof _0x315e46===_0x875bb8(0xe56)&&_0x315e46[_0x875bb8(0x3f1)]()&&_0x46c2c5['comments'][_0x875bb8(0x668)](_0x357d4b(_0x315e46,null,_0x19c9bf[_0x875bb8(0x6ff)]||null));});else typeof _0x19c9bf[_0x112831(0x60c)]===_0x112831(0xe56)&&_0x19c9bf['commentText'][_0x112831(0x3f1)]()&&_0x46c2c5[_0x112831(0x1e0)][_0x112831(0x668)](_0x357d4b(_0x19c9bf[_0x112831(0x60c)],null,_0x19c9bf[_0x112831(0x6ff)]||null));}await _0x2c5bcf[_0x112831(0x75f)][_0x112831(0x13a4)](_0x46c2c5['id'],{'comments':_0x46c2c5[_0x112831(0x1e0)]}),_0xddb60e(_0x776068+0x1),console[_0x112831(0x283)](_0x112831(0x1078)+_0x243d95[_0x112831(0x609)]+_0x112831(0x271)+_0x19c9bf[_0x112831(0xf23)]);if(!_0x243d95[_0x112831(0x612)])_0x243d95[_0x112831(0x612)]={};_0x243d95[_0x112831(0x612)][_0x19c9bf['postId']]=Date[_0x112831(0x9b7)]();}continue;}case _0x112831(0x8fc):!_0x3085d5[_0x112831(0x103f)]&&!_0x3085d5['isAwaitingResponse']&&(_0x3085d5[_0x112831(0x683)]=!![],_0x3085d5[_0x112831(0x970)]=_0x9d8526,_0x3085d5['isGroupCall']=![],_0x3085d5[_0x112831(0x1183)]=_0x243d95[_0x112831(0x609)],_0x2762f6());break;default:console[_0x112831(0x453)]('角色\x20\x22'+_0x243d95[_0x112831(0x609)]+'\x22\x20尝试执行未知的后台动作:',_0x19c9bf[_0x112831(0x12d9)]);break;case'change_avatar':{const _0x124ffc=_0x19c9bf[_0x112831(0x609)],_0x1af3be=_0x243d95[_0x112831(0x1131)][_0x112831(0x295)][_0x112831(0xfc3)](_0x1be7ba=>_0x1be7ba['name']===_0x124ffc);_0x1af3be&&(_0x243d95[_0x112831(0x1131)][_0x112831(0xd4d)]=_0x1af3be[_0x112831(0x11be)],await _0x177091(_0x243d95),visibleSystemMessage={'content':'['+_0x243d95['name']+_0x112831(0x10a1)},console[_0x112831(0x283)](_0x112831(0x1078)+_0x243d95[_0x112831(0x609)]+_0x112831(0xd8f)));break;}}if(_0x4ea9b3){_0x243d95['history'][_0x112831(0x668)](_0x4ea9b3),_0x243d95['unreadCount']=(_0x243d95['unreadCount']||0x0)+0x1;if(!_0x3fe517){let _0x48bacc=_0x4ea9b3[_0x112831(0x12d9)]===_0x112831(0x835)?'[图片]':_0x4ea9b3[_0x112831(0x53b)]||'';_0x52c10d(_0x9d8526,_0x48bacc),_0x3fe517=!![];}}}await _0x2c5bcf['chats']['put'](_0x243d95);}catch(_0x2d2616){console[_0x112831(0x1221)]('角色\x20\x22'+_0x243d95[_0x112831(0x609)]+_0x112831(0x5ea),_0x2d2616);}finally{_0x39290a(_0x9d8526,![]),_0x394b2c(),document[_0x112831(0x9c8)](_0x112831(0x81c))['classList'][_0x112831(0x1038)](_0x112831(0x113d))&&_0x2c70a9();}}async function _0x40b258(_0x4c7bfa){const _0x1e9f29=_0x419fa8,_0x217ec8=_0x9ebf46[_0x1e9f29(0x547)][_0x4c7bfa];if(!_0x217ec8||!_0x217ec8[_0x1e9f29(0x11e4)])return;const _0xc4fc92=_0x217ec8[_0x1e9f29(0x1131)][_0x1e9f29(0x664)]||0xa;if(_0x217ec8['lastActionTimestamp']){const _0x4243ce=(Date[_0x1e9f29(0x9b7)]()-_0x217ec8[_0x1e9f29(0x6e3)])/(0x3e8*0x3c);if(_0x4243ce<_0xc4fc92){console[_0x1e9f29(0x283)](_0x1e9f29(0xaac)+_0x217ec8[_0x1e9f29(0x609)]+_0x1e9f29(0xf83));return;}}const {proxyUrl:_0x24208f,apiKey:_0x3c754c,model:_0x7109a5}=_0x9ebf46[_0x1e9f29(0x4de)];if(!_0x24208f||!_0x3c754c||!_0x7109a5)return;const _0x5b0271=_0x217ec8['settings']['myNickname']||'我',_0x1c0f52=new Date();let _0xc57198;const _0x1e67a7=_0x217ec8[_0x1e9f29(0x8b3)][_0x1e9f29(0x401)](_0x3efc1f=>!_0x3efc1f[_0x1e9f29(0xc62)])[_0x1e9f29(0x1044)](-0x5),_0x5f55ab=_0x1e67a7['find'](_0x45bf3a=>_0x45bf3a[_0x1e9f29(0x12d9)]===_0x1e9f29(0xf67)&&!_0x45bf3a[_0x1e9f29(0x11b0)]);if(_0x5f55ab){const _0xe6f874=_0x227896(_0x217ec8,_0x5f55ab[_0x1e9f29(0xac4)]);console[_0x1e9f29(0x283)](_0x1e9f29(0x11a2)+_0x217ec8['name']+_0x1e9f29(0xba1)),_0xc57198='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“'+_0xe6f874+_0x1e9f29(0x267)+_0x5f55ab[_0x1e9f29(0x6b5)]+'）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20'+_0x5f55ab[_0x1e9f29(0x6b5)]+_0x1e9f29(0xd54);}else{let _0x2859d3='';const _0x4f5ade=_0x217ec8[_0x1e9f29(0x1131)][_0x1e9f29(0x11ee)]||_0x1e9f29(0xdfb),_0x405230=_0x1c0f52[_0x1e9f29(0x135b)](_0x1e9f29(0x101b),{'timeZone':_0x4f5ade,'dateStyle':_0x1e9f29(0x1088),'timeStyle':_0x1e9f29(0x4ea)}),_0x3b6f37=new Date(_0x1c0f52['toLocaleString'](_0x1e9f29(0x1035),{'timeZone':_0x4f5ade}));if(_0x217ec8[_0x1e9f29(0x1131)][_0x1e9f29(0x64b)]){const _0x2e3e96=_0x217ec8[_0x1e9f29(0x8b3)]['filter'](_0x5a310a=>!_0x5a310a[_0x1e9f29(0xc62)])[_0x1e9f29(0x1044)](-0x1)[0x0];if(_0x2e3e96){const _0x2fbff5=new Date(_0x2e3e96[_0x1e9f29(0x6b5)]),_0x434438=(_0x1c0f52-_0x2fbff5)/(0x3e8*0x3c);_0x434438>0x3c?_0x2859d3=_0x1e9f29(0x804)+Math[_0x1e9f29(0xe3e)](_0x434438/0x3c)+_0x1e9f29(0xf4f):_0x2859d3=_0x1e9f29(0x8ba)+Math['floor'](_0x434438)+_0x1e9f29(0x1109);}else _0x2859d3=_0x1e9f29(0xf77);}let _0x3977b7=_0x1e9f29(0x7c0);const _0x44ad2a=_0x217ec8[_0x1e9f29(0x1131)][_0x1e9f29(0x132a)]||0xa,_0x3169de=_0x217ec8[_0x1e9f29(0x8b3)][_0x1e9f29(0x401)](_0x1fe59c=>!_0x1fe59c[_0x1e9f29(0xc62)])['slice'](-_0x44ad2a);_0x3169de['length']>0x0&&(_0x3977b7=_0x1e9f29(0x353)+_0x3169de[_0x1e9f29(0xa3b)](_0x541e38=>{const _0x329e2c=_0x1e9f29,_0x40d921=_0x541e38[_0x329e2c(0x7fd)]===_0x329e2c(0x586)?_0x5b0271:_0x227896(_0x217ec8,_0x541e38[_0x329e2c(0xac4)]),_0x5d257d=String(_0x541e38[_0x329e2c(0x53b)]||_0x541e38['message']||'')[_0x329e2c(0xc34)](0x0,0x32);return _0x40d921+':\x20'+_0x5d257d+'...';})[_0x1e9f29(0x809)]('\x0a'));const _0x55f467=_0x217ec8[_0x1e9f29(0xd3e)][_0x1e9f29(0xa3b)](_0x43c7d5=>'-\x20**'+_0x43c7d5['groupNickname']+'**\x20(本名:\x20'+_0x43c7d5[_0x1e9f29(0x1071)]+_0x1e9f29(0x301)+_0x43c7d5[_0x1e9f29(0xeb1)])['join']('\x0a');let _0x3672b5=_0x1e9f29(0x5f7),_0x59859a=![];_0x217ec8[_0x1e9f29(0xd3e)][_0x1e9f29(0x591)](_0x33ca37=>{const _0xfdee1a=_0x1e9f29,_0x252972=_0x9ebf46[_0xfdee1a(0x547)][_0x33ca37['id']];_0x252972&&_0x252972[_0xfdee1a(0x323)]&&_0x252972[_0xfdee1a(0x323)][_0xfdee1a(0xa06)]>0x0&&(_0x3672b5+=_0xfdee1a(0xe53)+_0x33ca37[_0xfdee1a(0x1132)]+_0xfdee1a(0x5fa),_0x3672b5+=_0x252972[_0xfdee1a(0x323)][_0xfdee1a(0xa3b)](_0x35ae40=>'-\x20'+_0x35ae40[_0xfdee1a(0x53b)])['join']('\x0a'),_0x59859a=!![]);});!_0x59859a&&(_0x3672b5+=_0x1e9f29(0x1264));let _0x383528='';if(_0x217ec8[_0x1e9f29(0x1131)][_0x1e9f29(0x41a)]&&_0x217ec8['settings'][_0x1e9f29(0x41a)][_0x1e9f29(0xa06)]>0x0){const _0x263790=_0x217ec8[_0x1e9f29(0x1131)]['linkedWorldBookIds']['map'](_0x423305=>{const _0x3a8352=_0x1e9f29,_0xe773f5=_0x9ebf46[_0x3a8352(0x1369)][_0x3a8352(0xfc3)](_0x531af2=>_0x531af2['id']===_0x423305);if(!_0xe773f5||!Array[_0x3a8352(0xb27)](_0xe773f5[_0x3a8352(0x53b)]))return'';const _0x19e99b=_0xe773f5[_0x3a8352(0x53b)][_0x3a8352(0x401)](_0x1fb6d8=>_0x1fb6d8[_0x3a8352(0x38a)]!==![])['map'](_0x5527cb=>{const _0x3a68c8=_0x3a8352;let _0x36aaf1='\x0a###\x20条目:\x20'+(_0x5527cb['comment']||_0x3a68c8(0xf27))+'\x0a';return _0x5527cb[_0x3a68c8(0x2bd)][_0x3a68c8(0xa06)]>0x0&&(_0x36aaf1+='**关键词:**\x20'+_0x5527cb[_0x3a68c8(0x2bd)][_0x3a68c8(0x809)](',\x20')+'\x0a'),_0x36aaf1+=_0x3a68c8(0x246)+_0x5527cb[_0x3a68c8(0x53b)],_0x36aaf1;})[_0x3a8352(0x809)]('');return _0x19e99b?_0x3a8352(0xbac)+_0xe773f5['name']+'\x0a'+_0x19e99b:'';})[_0x1e9f29(0x401)](Boolean)[_0x1e9f29(0x809)]('');_0x263790&&(_0x383528=_0x1e9f29(0xb13)+_0x263790+_0x1e9f29(0x98a));}let _0x3a5751='';const _0xbaf117=_0x217ec8[_0x1e9f29(0x1131)]['linkedMemoryCount']||0xa;if(_0x217ec8['settings']['linkedMemoryChatIds']&&_0x217ec8[_0x1e9f29(0x1131)]['linkedMemoryChatIds']['length']>0x0){const _0x5bdd2e=_0x217ec8[_0x1e9f29(0x1131)]['linkedMemoryChatIds']['map'](_0x4471d9=>{const _0x3cbdad=_0x1e9f29,_0x2b2d73=_0x9ebf46[_0x3cbdad(0x547)][_0x4471d9];if(!_0x2b2d73)return null;const _0x4ce671=_0x2b2d73[_0x3cbdad(0x8b3)][_0x3cbdad(0x1044)](-0x1)[0x0];return{'chat':_0x2b2d73,'latestTimestamp':_0x4ce671?_0x4ce671[_0x3cbdad(0x6b5)]:0x0};})[_0x1e9f29(0x401)](Boolean);_0x5bdd2e[_0x1e9f29(0x66b)]((_0x322bc1,_0x466434)=>_0x466434[_0x1e9f29(0xe98)]-_0x322bc1[_0x1e9f29(0xe98)]),_0x3a5751+=_0x1e9f29(0x8eb);for(const _0xb0ea96 of _0x5bdd2e){const _0x5a6046=_0xb0ea96[_0x1e9f29(0x8b0)],_0x1ccac0=_0x5a6046[_0x1e9f29(0x11e4)]?_0x1e9f29(0x93a):'[私聊]',_0x4b48dd=_0xb0ea96[_0x1e9f29(0xe98)]>0x0?_0x1e9f29(0x9be)+_0x4fcd92(_0xb0ea96[_0x1e9f29(0xe98)])+')':'';_0x3a5751+=_0x1e9f29(0x1018)+_0x1ccac0+'“'+_0x5a6046[_0x1e9f29(0x609)]+_0x1e9f29(0x97f)+_0x4b48dd+_0x1e9f29(0xc44);const _0x32bb6f=_0x5a6046[_0x1e9f29(0x8b3)][_0x1e9f29(0x1044)](-_0xbaf117),_0x1932b8=_0x32bb6f[_0x1e9f29(0x401)](_0x24681e=>!String(_0x24681e[_0x1e9f29(0x53b)])[_0x1e9f29(0x930)](_0x1e9f29(0x420)));_0x1932b8[_0x1e9f29(0xa06)]>0x0?_0x1932b8[_0x1e9f29(0x591)](_0x343a51=>{const _0x6fd39=_0x1e9f29,_0x5382c3=_0x343a51[_0x6fd39(0x7fd)]===_0x6fd39(0x586)?_0x5a6046[_0x6fd39(0x1131)][_0x6fd39(0x29c)]||'我':_0x343a51['senderName']||_0x5a6046[_0x6fd39(0x609)];let _0x50376d=String(_0x343a51[_0x6fd39(0x53b)]);if(_0x343a51[_0x6fd39(0x12d9)]===_0x6fd39(0x835)||_0x343a51[_0x6fd39(0x12d9)]===_0x6fd39(0x560))_0x50376d=_0x6fd39(0x10d1)+_0x343a51[_0x6fd39(0x53b)]+']';else _0x343a51['type']==='voice_message'&&(_0x50376d=_0x6fd39(0x111b)+_0x343a51['content']+']');_0x3a5751+=_0x5382c3+':\x20'+_0x50376d+'\x0a';}):_0x3a5751+=_0x1e9f29(0x9db);}}const _0x4091e6=await _0x2c5bcf[_0x1e9f29(0x75f)][_0x1e9f29(0x8ea)](_0x1e9f29(0x6b5))[_0x1e9f29(0x101e)]()[_0x1e9f29(0x13bf)](0x5)['toArray']();let _0x44f002='';const _0x58c63e=new Set();for(const _0x3d576f of _0x217ec8[_0x1e9f29(0xd3e)]){const _0x381dc1=_0x9ebf46['chats'][_0x3d576f['id']];if(_0x381dc1){const _0xc25792=_0x499cd0(_0x4091e6,_0x381dc1);_0xc25792[_0x1e9f29(0x591)](_0x13daa6=>_0x58c63e[_0x1e9f29(0x68e)](_0x13daa6));}}const _0x303c70=new Set(_0x217ec8['members']['map'](_0x19480c=>_0x19480c[_0x1e9f29(0x1071)])),_0x16dd43=[..._0x58c63e][_0x1e9f29(0x401)](_0x20b98a=>{const _0x23604b=_0x1e9f29,_0x396d9a=_0x20b98a[_0x23604b(0x315)]&&_0x20b98a[_0x23604b(0x315)]['some'](_0x4ff5ba=>_0x303c70['has'](_0x4ff5ba)),_0x26363a=_0x20b98a[_0x23604b(0x1e0)]&&_0x20b98a[_0x23604b(0x1e0)][_0x23604b(0x10b2)](_0x17f8b2=>typeof _0x17f8b2===_0x23604b(0xc24)&&_0x303c70['has'](_0x17f8b2[_0x23604b(0x8bf)]));return!_0x396d9a&&!_0x26363a;});if(_0x16dd43[_0x1e9f29(0xa06)]>0x0){let _0x7dea15='\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a';for(const _0x20005f of _0x16dd43){let _0x139f0a=_0x20005f[_0x1e9f29(0x61c)]===_0x1e9f29(0x586)?_0x5b0271:_0x9ebf46[_0x1e9f29(0x547)][_0x20005f[_0x1e9f29(0x61c)]]?.['name']||_0x1e9f29(0x7fc),_0x50d5d1;if(_0x20005f['type']===_0x1e9f29(0x75b)){const _0x17346f=_0x20005f[_0x1e9f29(0x104d)]?_0x1e9f29(0x252)+_0x20005f['repostComment']+'”':'';let _0x4b1825=_0x1e9f29(0xb78);const _0x51c478=_0x20005f[_0x1e9f29(0xc26)][_0x1e9f29(0x61c)];if(_0x51c478===_0x1e9f29(0x586))_0x4b1825=_0x9ebf46[_0x1e9f29(0x32c)][_0x1e9f29(0x5b7)];else _0x9ebf46[_0x1e9f29(0x547)][_0x51c478]&&(_0x4b1825=_0x9ebf46[_0x1e9f29(0x547)][_0x51c478][_0x1e9f29(0x609)]);let _0x575c3a;const _0x1aa5fa=_0x20005f[_0x1e9f29(0xc26)];if(_0x1aa5fa[_0x1e9f29(0x12d9)]===_0x1e9f29(0xf74))_0x575c3a=_0x1e9f29(0xa99)+(_0x1aa5fa[_0x1e9f29(0x7b2)]||'')+_0x1e9f29(0x484)+(_0x1aa5fa['hiddenContent']||'')[_0x1e9f29(0xc34)](0x0,0x28)+_0x1e9f29(0xbab);else _0x1aa5fa['type']==='image_post'?_0x575c3a='[图片]\x20'+(_0x1aa5fa[_0x1e9f29(0x7b2)]||'')+'\x20(图片描述:\x20“'+(_0x1aa5fa[_0x1e9f29(0xb34)]||'')[_0x1e9f29(0xc34)](0x0,0x28)+_0x1e9f29(0xbab):_0x575c3a='“'+(_0x1aa5fa[_0x1e9f29(0x53b)]||'')[_0x1e9f29(0xc34)](0x0,0x28)+'...”';_0x50d5d1='转发了\x20@'+_0x4b1825+_0x1e9f29(0xdc7)+_0x17346f+_0x1e9f29(0x90e)+_0x575c3a+'】';}else{if(_0x20005f[_0x1e9f29(0x12d9)]===_0x1e9f29(0xf74))_0x50d5d1=('[一张图片，其隐藏文字为：“'+_0x20005f[_0x1e9f29(0x841)]+'”]\x20'+(_0x20005f[_0x1e9f29(0x7b2)]||''))[_0x1e9f29(0xc34)](0x0,0x32)+_0x1e9f29(0xf66);else _0x20005f[_0x1e9f29(0x12d9)]===_0x1e9f29(0x55b)?_0x50d5d1=('[一张图片，描述为：“'+_0x20005f[_0x1e9f29(0xb34)]+'”]\x20'+(_0x20005f['publicText']||''))[_0x1e9f29(0xc34)](0x0,0x32)+_0x1e9f29(0xf66):_0x50d5d1=String(_0x20005f[_0x1e9f29(0x7b2)]||_0x20005f['content']||_0x1e9f29(0xca0))['substring'](0x0,0x32)+'...';}_0x7dea15+='-\x20(ID:\x20'+_0x20005f['id']+')\x20作者:\x20'+_0x139f0a+',\x20内容:\x20\x22'+_0x50d5d1+'\x22\x0a';if(_0x20005f[_0x1e9f29(0x1e0)]&&_0x20005f['comments']['length']>0x0)for(const _0x39ba57 of _0x20005f[_0x1e9f29(0x1e0)]){if(typeof _0x39ba57===_0x1e9f29(0xc24)&&_0x39ba57[_0x1e9f29(0x8bf)]){const _0x129f21=_0x1dfc4e(_0x39ba57[_0x1e9f29(0x8bf)]);let _0x270c91=_0x39ba57[_0x1e9f29(0x1b3)]?_0x1e9f29(0x134e)+_0x39ba57[_0x1e9f29(0x1b3)]+'\x27]':_0x39ba57[_0x1e9f29(0xbb7)];_0x7dea15+=_0x1e9f29(0xbb1)+_0x129f21+'\x20(本名:\x20'+_0x39ba57[_0x1e9f29(0x8bf)]+_0x1e9f29(0x301)+_0x270c91+'\x0a';}}}_0x44f002=_0x7dea15;}const _0x165a0c=_0xbdd100(_0x217ec8,0x3,_0x1e9f29(0x658)),_0x1b50d5=_0xbdd100(_0x217ec8,0x6,_0x1e9f29(0x658)),_0x56fcb6=_0xbdd100(_0x217ec8,0x9,_0x1e9f29(0x658)),_0x20b23f=_0xbdd100(_0x217ec8,0x1,_0x1e9f29(0x929)),_0x3462a5=_0xbdd100(_0x217ec8,0x3,_0x1e9f29(0x929)),_0x595c06=_0xbdd100(_0x217ec8,0x7,'days');let _0x39b8f4='';if(_0x165a0c||_0x1b50d5||_0x56fcb6||_0x20b23f||_0x3462a5||_0x595c06){_0x39b8f4+=_0x1e9f29(0x8f2);if(_0x165a0c)_0x39b8f4+=_0x165a0c;if(_0x1b50d5)_0x39b8f4+=_0x1b50d5;if(_0x56fcb6)_0x39b8f4+=_0x56fcb6;if(_0x165a0c||_0x1b50d5||_0x56fcb6)_0x39b8f4+='\x0a';if(_0x20b23f)_0x39b8f4+=_0x20b23f;if(_0x3462a5)_0x39b8f4+=_0x3462a5;if(_0x595c06)_0x39b8f4+=_0x595c06;}const _0x537db2=_0xe373a(_0x217ec8);_0xc57198=_0x1e9f29(0xda8)+_0x217ec8[_0x1e9f29(0x609)]+'”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x217ec8[_0x1e9f29(0x1131)][_0x1e9f29(0x64b)]?_0x1e9f29(0x4e7)+_0x405230+'。':'')+_0x1e9f29(0xdde)+(_0x2859d3?_0x2859d3+'\x20':'')+_0x1e9f29(0x59b)+_0x3672b5+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22'+_0x5b0271+_0x1e9f29(0x3cd)+_0x217ec8[_0x1e9f29(0x609)]+_0x1e9f29(0xdde)+_0x383528+_0x1e9f29(0x11a1)+(_0x217ec8['longTermMemory']&&_0x217ec8[_0x1e9f29(0x323)]['length']>0x0?_0x217ec8[_0x1e9f29(0x323)]['map'](_0x147d52=>'-\x20'+_0x147d52[_0x1e9f29(0x53b)])[_0x1e9f29(0x809)]('\x0a'):_0x1e9f29(0x1264))+_0x1e9f29(0x1036)+_0x39b8f4+_0x1e9f29(0xdde)+_0x3a5751+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x55f467+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20可用表情包\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x537db2+_0x1e9f29(0x9f9)+_0x5b0271+'**:\x20'+_0x217ec8[_0x1e9f29(0x1131)][_0x1e9f29(0x1151)]+_0x1e9f29(0x10a8)+_0x3977b7+_0x1e9f29(0x61a)+_0x44f002+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}const _0x5bb302=_0x217ec8[_0x1e9f29(0x8b3)][_0x1e9f29(0x401)](_0x15320c=>!_0x15320c['isHidden'])[_0x1e9f29(0x1044)](-0xa),_0x3351ed=[{'role':_0x1e9f29(0xb64),'content':_0xc57198},..._0x5bb302[_0x1e9f29(0xa3b)](_0x22ee90=>{const _0x465b7c=_0x1e9f29,_0x4151ad=_0x22ee90['role']===_0x465b7c(0x586)?_0x5b0271:_0x227896(_0x217ec8,_0x22ee90[_0x465b7c(0xac4)]);let _0x5ada47=_0x22ee90[_0x465b7c(0x53b)];if(_0x22ee90[_0x465b7c(0x12d9)]===_0x465b7c(0x835)||_0x22ee90[_0x465b7c(0x12d9)]===_0x465b7c(0x560))_0x5ada47='[发送了一张图片，描述为：\x27'+_0x22ee90[_0x465b7c(0x53b)]+'\x27]';else{if(_0x22ee90[_0x465b7c(0x12d9)]===_0x465b7c(0x10c1))_0x5ada47='[发送了一条语音，内容是：\x27'+_0x22ee90['content']+'\x27]';else typeof _0x5ada47!=='string'&&(_0x5ada47='[发送了一条复杂消息，如卡片或转账]');}return{'role':_0x465b7c(0x586),'content':_0x4151ad+':\x20'+_0x5ada47};})];try{const _0x2ea594=[{'role':_0x1e9f29(0x586),'content':_0xc57198}];let _0x1dbe19=_0x24208f===GEMINI_API_URL,_0x2a9a60=_0x2e5c04(_0x7109a5,_0x3c754c,_0xc57198,_0x2ea594);const _0x2ef545=_0x1dbe19?await fetch(_0x2a9a60[_0x1e9f29(0x11be)],_0x2a9a60[_0x1e9f29(0x100d)]):await fetch(_0x24208f+_0x1e9f29(0x1090),{'method':'POST','headers':{'Content-Type':_0x1e9f29(0x698),'Authorization':_0x1e9f29(0x84a)+_0x3c754c},'body':JSON[_0x1e9f29(0xf1e)]({'model':_0x7109a5,'messages':_0x2ea594,'temperature':_0x9ebf46[_0x1e9f29(0x1383)][_0x1e9f29(0xc3d)]||0.9})});if(!_0x2ef545['ok'])throw new Error((await _0x2ef545[_0x1e9f29(0x5dd)]())[_0x1e9f29(0x1221)][_0x1e9f29(0x86e)]);const _0x21739f=await _0x2ef545[_0x1e9f29(0x5dd)](),_0x474985=_0x1dbe19?_0x21739f[_0x1e9f29(0xbd6)][0x0][_0x1e9f29(0x53b)]['parts'][0x0]['text']:_0x21739f[_0x1e9f29(0xfd2)][0x0][_0x1e9f29(0x86e)]['content'],_0x4259c1=_0x169d92(_0x474985);if(!_0x4259c1||_0x4259c1[_0x1e9f29(0xa06)]===0x0){console[_0x1e9f29(0x453)](_0x1e9f29(0xaac)+_0x217ec8[_0x1e9f29(0x609)]+'\x22\x20的独立行动API返回为空或格式不正确，本次跳过。');return;}let _0x40ee2d=Date[_0x1e9f29(0x9b7)](),_0x482f2f=![],_0x42c25a='',_0x2dfe68='';const _0x3e6f90=[];for(const _0xce4255 of _0x4259c1){const _0x3a4059=String(_0xce4255[_0x1e9f29(0x53b)]||''),_0x470540=_0x3a4059['trim']()[_0x1e9f29(0xc8d)]('<')&&_0x3a4059[_0x1e9f29(0x3f1)]()[_0x1e9f29(0x6b1)]('>');if(_0xce4255[_0x1e9f29(0x12d9)]==='text'&&!_0x470540&&_0x3a4059[_0x1e9f29(0x930)]('\x0a')){const _0x44e02a=_0x3a4059[_0x1e9f29(0x6c6)](/\n+/)[_0x1e9f29(0x401)](_0x3401b7=>_0x3401b7[_0x1e9f29(0x3f1)]());_0x44e02a[_0x1e9f29(0x591)](_0x52f006=>{_0x3e6f90['push']({..._0xce4255,'content':_0x52f006});});}else _0x3e6f90[_0x1e9f29(0x668)](_0xce4255);}for(const _0x58f7c4 of _0x3e6f90){if(!_0x58f7c4||!_0x58f7c4[_0x1e9f29(0x12d9)]||!_0x58f7c4[_0x1e9f29(0x609)])continue;const _0x25a684=_0x227896(_0x217ec8,_0x58f7c4[_0x1e9f29(0x609)]);let _0x31d791=null,_0x18ef6c=null;const _0x20a361={'role':_0x1e9f29(0x1a7),'senderName':_0x58f7c4[_0x1e9f29(0x609)],'timestamp':_0x40ee2d++};if(_0x58f7c4['type']===_0x1e9f29(0x2f7)){const _0x2b53fb=_0x217ec8[_0x1e9f29(0x8b3)][_0x1e9f29(0xfc3)](_0x5aaf04=>_0x5aaf04[_0x1e9f29(0x6b5)]===_0x58f7c4[_0x1e9f29(0xa75)]);if(_0x2b53fb&&!_0x2b53fb[_0x1e9f29(0x11b0)]&&!(_0x2b53fb[_0x1e9f29(0x1118)]&&_0x2b53fb[_0x1e9f29(0x1118)][_0x58f7c4[_0x1e9f29(0x609)]])){let _0x1e0169=0x0;const _0x342bf0=_0x2b53fb['totalAmount']-Object[_0x1e9f29(0xeb2)](_0x2b53fb[_0x1e9f29(0x1118)]||{})[_0x1e9f29(0x12c1)]((_0x3523de,_0x5b9d5a)=>_0x3523de+_0x5b9d5a,0x0),_0x4cd964=_0x2b53fb[_0x1e9f29(0x636)]-Object[_0x1e9f29(0x2bd)](_0x2b53fb['claimedBy']||{})['length'];if(_0x4cd964>0x0){if(_0x4cd964===0x1)_0x1e0169=_0x342bf0;else{const _0x1ffebc=0.01,_0x4e233e=_0x342bf0-(_0x4cd964-0x1)*_0x1ffebc;_0x1e0169=Math['random']()*(_0x4e233e-_0x1ffebc)+_0x1ffebc;}_0x1e0169=parseFloat(_0x1e0169[_0x1e9f29(0x752)](0x2));if(!_0x2b53fb[_0x1e9f29(0x1118)])_0x2b53fb[_0x1e9f29(0x1118)]={};_0x2b53fb[_0x1e9f29(0x1118)][_0x58f7c4[_0x1e9f29(0x609)]]=_0x1e0169,_0x217ec8['history']['push']({'role':'system','type':_0x1e9f29(0x13a8),'content':_0x25a684+_0x1e9f29(0x70b)+_0x227896(_0x217ec8,_0x2b53fb['senderName'])+_0x1e9f29(0xf43),'timestamp':Date[_0x1e9f29(0x9b7)]()});let _0x117402=_0x1e9f29(0x1059)+_0x25a684+_0x1e9f29(0x137b)+_0x1e0169['toFixed'](0x2)+_0x1e9f29(0x4ce);if(Object[_0x1e9f29(0x2bd)](_0x2b53fb[_0x1e9f29(0x1118)])[_0x1e9f29(0xa06)]>=_0x2b53fb['count']){_0x2b53fb['isFullyClaimed']=!![],_0x217ec8[_0x1e9f29(0x8b3)]['push']({'role':_0x1e9f29(0xb64),'type':_0x1e9f29(0x13a8),'content':_0x227896(_0x217ec8,_0x2b53fb[_0x1e9f29(0xac4)])+_0x1e9f29(0x1096),'timestamp':Date['now']()+0x1});let _0x1dae1d={'name':'','amount':-0x1};Object[_0x1e9f29(0x1231)](_0x2b53fb[_0x1e9f29(0x1118)])[_0x1e9f29(0x591)](([_0x4c01f0,_0x52b97f])=>{const _0x34e5a1=_0x1e9f29;_0x52b97f>_0x1dae1d[_0x34e5a1(0x212)]&&(_0x1dae1d={'name':_0x4c01f0,'amount':_0x52b97f});});if(_0x1dae1d['name']){const _0x477913=_0x227896(_0x217ec8,_0x1dae1d[_0x1e9f29(0x609)]);_0x117402+=_0x1e9f29(0x7ab)+_0x477913+'！';}}_0x117402+=_0x1e9f29(0x505),_0x217ec8['history'][_0x1e9f29(0x668)]({'role':'system','content':_0x117402,'timestamp':Date[_0x1e9f29(0x9b7)]()+0x2,'isHidden':!![]});}}_0x482f2f=!![];continue;}switch(_0x58f7c4[_0x1e9f29(0x12d9)]){case _0x1e9f29(0x83e):if(_0x58f7c4[_0x1e9f29(0x1b3)]){const _0xb39c31=_0x9ebf46['userStickers'][_0x1e9f29(0xfc3)](_0x3dcfba=>_0x3dcfba[_0x1e9f29(0x609)]===_0x58f7c4['meaning']);_0xb39c31?_0x18ef6c={..._0x20a361,'type':_0x1e9f29(0x83e),'content':_0xb39c31['url'],'meaning':_0xb39c31[_0x1e9f29(0x609)]}:(console[_0x1e9f29(0x453)](_0x1e9f29(0x1014)+_0x58f7c4[_0x1e9f29(0x1b3)]+'\x22'),_0x18ef6c={..._0x20a361,'type':'text','content':'[表情:\x20'+_0x58f7c4['meaning']+']'});}else console[_0x1e9f29(0x453)](_0x1e9f29(0x98e),_0x58f7c4),_0x18ef6c={..._0x20a361,'type':_0x1e9f29(0x83e),'content':_0x58f7c4[_0x1e9f29(0x11be)],'meaning':_0x1e9f29(0xdbe)};break;case _0x1e9f29(0x411):const _0x335207={'type':_0x58f7c4['postType']||'shuoshuo','content':_0x58f7c4[_0x1e9f29(0x53b)],'timestamp':Date['now'](),'authorId':_0x9ebf46[_0x1e9f29(0x547)][Object[_0x1e9f29(0x2bd)](_0x9ebf46[_0x1e9f29(0x547)])[_0x1e9f29(0xfc3)](_0x49f7bb=>_0x9ebf46[_0x1e9f29(0x547)][_0x49f7bb][_0x1e9f29(0x1071)]===_0x58f7c4[_0x1e9f29(0x609)])]?.['id']||_0x58f7c4['name'],'authorOriginalName':_0x58f7c4[_0x1e9f29(0x609)],'visibleGroupIds':null};await _0x2c5bcf[_0x1e9f29(0x75f)][_0x1e9f29(0x68e)](_0x335207),_0xddb60e(_0x776068+0x1),_0x31d791={'content':'['+_0x25a684+_0x1e9f29(0x18a)};break;case _0x1e9f29(0xc6d):const _0x260308=await _0x2c5bcf[_0x1e9f29(0x75f)][_0x1e9f29(0xdf9)](parseInt(_0x58f7c4[_0x1e9f29(0xf23)]));if(_0x260308){if(!_0x260308[_0x1e9f29(0x1e0)])_0x260308[_0x1e9f29(0x1e0)]=[];_0x260308['comments'][_0x1e9f29(0x668)]({'commenterName':_0x58f7c4['name'],'text':_0x58f7c4['commentText'],'timestamp':Date[_0x1e9f29(0x9b7)]()}),await _0x2c5bcf['qzonePosts']['update'](_0x260308['id'],{'comments':_0x260308[_0x1e9f29(0x1e0)]}),_0xddb60e(_0x776068+0x1),_0x31d791={'content':'['+_0x25a684+_0x1e9f29(0x990)};}break;case'qzone_like':const _0x251693=await _0x2c5bcf[_0x1e9f29(0x75f)]['get'](parseInt(_0x58f7c4[_0x1e9f29(0xf23)]));if(_0x251693){if(!_0x251693[_0x1e9f29(0x315)])_0x251693[_0x1e9f29(0x315)]=[];!_0x251693[_0x1e9f29(0x315)][_0x1e9f29(0x930)](_0x58f7c4['name'])&&(_0x251693['likes'][_0x1e9f29(0x668)](_0x58f7c4[_0x1e9f29(0x609)]),await _0x2c5bcf['qzonePosts']['update'](_0x251693['id'],{'likes':_0x251693[_0x1e9f29(0x315)]}),_0xddb60e(_0x776068+0x1),_0x31d791={'content':'['+_0x25a684+_0x1e9f29(0x288)});}break;case'ai_image':_0x18ef6c={..._0x20a361,'type':_0x1e9f29(0x835),'content':_0x58f7c4[_0x1e9f29(0x1387)],'image_prompt':msgData['image_prompt']};break;default:if(_0x58f7c4['type']===_0x1e9f29(0xb71)){const _0x5bbf59=typeof _0x58f7c4[_0x1e9f29(0x5ed)]==='string'?_0x58f7c4[_0x1e9f29(0x5ed)][_0x1e9f29(0x6c6)]('\x0a')[_0x1e9f29(0x401)](_0x2c07bb=>_0x2c07bb[_0x1e9f29(0x3f1)]()):Array[_0x1e9f29(0xb27)](_0x58f7c4[_0x1e9f29(0x5ed)])?_0x58f7c4[_0x1e9f29(0x5ed)]:[];if(_0x5bbf59[_0x1e9f29(0xa06)]<0x2)continue;_0x18ef6c={..._0x20a361,..._0x58f7c4,'options':_0x5bbf59,'votes':{},'isClosed':![]};}else{const _0xa2fc9b=_0x58f7c4[_0x1e9f29(0x53b)]||_0x58f7c4[_0x1e9f29(0x86e)];_0x18ef6c={..._0x20a361,..._0x58f7c4};if(_0xa2fc9b)_0x18ef6c[_0x1e9f29(0x53b)]=_0xa2fc9b;}break;}if(_0x31d791)_0x217ec8[_0x1e9f29(0x8b3)][_0x1e9f29(0x668)]({'role':'system','type':_0x1e9f29(0x13a8),'content':_0x31d791[_0x1e9f29(0x53b)],'timestamp':_0x40ee2d++});else _0x18ef6c&&(_0x217ec8['history'][_0x1e9f29(0x668)](_0x18ef6c),!_0x2dfe68&&(_0x2dfe68=_0x25a684,_0x42c25a=_0x18ef6c[_0x1e9f29(0x12d9)]==='ai_image'?_0x1e9f29(0x4a9):_0x18ef6c[_0x1e9f29(0x53b)]||'['+_0x18ef6c[_0x1e9f29(0x12d9)]+']'));_0x482f2f=!![];}_0x482f2f&&(_0x217ec8[_0x1e9f29(0x6e3)]=Date['now'](),_0x217ec8[_0x1e9f29(0x382)]=(_0x217ec8[_0x1e9f29(0x382)]||0x0)+_0x4259c1['filter'](_0x32b71f=>_0x32b71f['type']!==_0x1e9f29(0x411)&&_0x32b71f['type']!=='qzone_comment'&&_0x32b71f[_0x1e9f29(0x12d9)]!==_0x1e9f29(0xfe8))['length'],_0x2dfe68&&_0x42c25a&&_0x52c10d(_0x4c7bfa,_0x2dfe68+':\x20'+_0x42c25a),await _0x2c5bcf[_0x1e9f29(0x547)][_0x1e9f29(0xff5)](_0x217ec8));}catch(_0x26be7d){console[_0x1e9f29(0x1221)](_0x1e9f29(0xaac)+_0x217ec8[_0x1e9f29(0x609)]+'\x22\x20的独立行动失败:',_0x26be7d);}finally{_0x394b2c();}}function _0x144843(_0x5a186f,_0x1bb3cd,_0x6d1ff9){const _0x31fbd4=_0x419fa8,_0x5c98b7=document[_0x31fbd4(0x9c8)](_0x6d1ff9);if(!_0x5c98b7)return;if(!_0x5a186f||_0x5a186f[_0x31fbd4(0x3f1)]()===''){_0x5c98b7[_0x31fbd4(0x2f5)]='';return;}const _0xecf702=_0x5a186f['replace'](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x1bb3cd+_0x31fbd4(0x6f6))['replace'](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x1bb3cd+'\x20.message-bubble.ai\x20$1')[_0x31fbd4(0x459)](/\s*\.message-bubble\s+([^{]+\{)/g,_0x1bb3cd+_0x31fbd4(0xa15));_0x5c98b7[_0x31fbd4(0x2f5)]=_0xecf702;}async function _0x2c9d73(){const _0x1a69cd=_0x419fa8;if(!_0x9ebf46[_0x1a69cd(0x970)])return;const _0x4df7ba=_0x9ebf46[_0x1a69cd(0x547)][_0x9ebf46[_0x1a69cd(0x970)]],_0x120f97=document[_0x1a69cd(0x9c8)](_0x1a69cd(0x538));if(!_0x120f97)return;const _0x3e94c4=document[_0x1a69cd(0x91d)](_0x1a69cd(0x12ab))?.[_0x1a69cd(0x1155)]||'default',_0x4467a9=document[_0x1a69cd(0x9c8)](_0x1a69cd(0xfb6))[_0x1a69cd(0x1155)],_0x338944=document[_0x1a69cd(0x9c8)](_0x1a69cd(0x1332))[_0x1a69cd(0x1155)],_0x3f1286=_0x4df7ba['settings']['background'];_0x120f97[_0x1a69cd(0xc9f)][_0x1a69cd(0x56d)]=_0x3e94c4,_0x120f97['style']['setProperty'](_0x1a69cd(0x1110),_0x4467a9+'px');_0x3f1286&&_0x3f1286['startsWith'](_0x1a69cd(0x11a5))?(_0x120f97[_0x1a69cd(0x5e1)]['backgroundImage']='url('+_0x3f1286+')',_0x120f97['style'][_0x1a69cd(0x8e2)]=_0x1a69cd(0x740)):(_0x120f97['style'][_0x1a69cd(0x11d9)]=_0x1a69cd(0x8f6),_0x120f97['style'][_0x1a69cd(0x93f)]=_0x3f1286||'#f0f2f5');_0x120f97[_0x1a69cd(0x2f5)]='';const _0x4255ab={'role':'ai','content':_0x1a69cd(0x1d9),'timestamp':0x1,'senderName':_0x4df7ba[_0x1a69cd(0x609)]},_0x3e0bae=await _0x8ae2cf(_0x4255ab,_0x4df7ba);if(_0x3e0bae)_0x120f97[_0x1a69cd(0x7b9)](_0x3e0bae);const _0x3bb1af={'role':_0x1a69cd(0x586),'content':_0x1a69cd(0x45b),'timestamp':0x2},_0x29df7f=await _0x8ae2cf(_0x3bb1af,_0x4df7ba);if(_0x29df7f)_0x120f97[_0x1a69cd(0x7b9)](_0x29df7f);const _0x57421b=document[_0x1a69cd(0x28a)](_0x1a69cd(0x11f4));_0x57421b[_0x1a69cd(0x5e1)][_0x1a69cd(0xd09)]=_0x1a69cd(0xbe9),_0x57421b['textContent']='♪\x20歌词位置预览\x20♪',_0x120f97[_0x1a69cd(0x7b9)](_0x57421b);const _0x3b559a=document[_0x1a69cd(0x9c8)](_0x1a69cd(0xa02))['value'],_0x579c69=document[_0x1a69cd(0x9c8)]('lyrics-horizontal-pos')[_0x1a69cd(0x1155)],_0x491e00=parseInt(document[_0x1a69cd(0x9c8)]('lyrics-offset-input')[_0x1a69cd(0x1155)])||0xa;_0x3b559a===_0x1a69cd(0x114a)?_0x57421b[_0x1a69cd(0x5e1)][_0x1a69cd(0x114a)]=_0x491e00+'px':_0x57421b[_0x1a69cd(0x5e1)][_0x1a69cd(0x40f)]=_0x491e00+'px';switch(_0x579c69){case _0x1a69cd(0x12b6):_0x57421b['style'][_0x1a69cd(0x12b6)]=_0x1a69cd(0xca5);break;case _0x1a69cd(0x4d0):_0x57421b[_0x1a69cd(0x5e1)][_0x1a69cd(0x4d0)]=_0x1a69cd(0xca5);break;default:_0x57421b['style'][_0x1a69cd(0x12b6)]=_0x1a69cd(0x43e),_0x57421b['style'][_0x1a69cd(0xf57)]=_0x1a69cd(0x8d8);break;}_0x144843(_0x338944,_0x1a69cd(0x1208),'preview-bubble-style');}async function _0x259cff(){const _0x2dd70d=_0x419fa8;await _0x522f28(),document[_0x2dd70d(0x9c8)](_0x2dd70d(0x745))[_0x2dd70d(0x575)][_0x2dd70d(0x68e)](_0x2dd70d(0xc3f));}async function _0x522f28(){const _0x169e05=_0x419fa8,_0x4e64f4=document[_0x169e05(0x9c8)](_0x169e05(0x495)),_0x1e9d9c=await _0x2c5bcf[_0x169e05(0xaf2)][_0x169e05(0x5ff)]();_0x4e64f4[_0x169e05(0x2f5)]='',_0x1e9d9c[_0x169e05(0xa06)]===0x0&&(_0x4e64f4['innerHTML']='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>'),_0x1e9d9c[_0x169e05(0x591)](_0x262486=>{const _0x37ef61=_0x169e05,_0x21e357=document[_0x37ef61(0x28a)](_0x37ef61(0x11f4));_0x21e357[_0x37ef61(0x82c)]=_0x37ef61(0xf68),_0x21e357[_0x37ef61(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x262486['name']+_0x37ef61(0x1d3)+_0x262486['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4e64f4['appendChild'](_0x21e357);});}async function _0x1df651(){const _0x22f8ce=_0x419fa8,_0x31c38e=document[_0x22f8ce(0x9c8)](_0x22f8ce(0x2c1)),_0x49bfe3=_0x31c38e[_0x22f8ce(0x1155)][_0x22f8ce(0x3f1)]();if(!_0x49bfe3){alert('分组名不能为空！');return;}const _0x105754=await _0x2c5bcf[_0x22f8ce(0xaf2)][_0x22f8ce(0xe78)](_0x22f8ce(0x609))[_0x22f8ce(0xda9)](_0x49bfe3)[_0x22f8ce(0x476)]();if(_0x105754){alert('分组\x20\x22'+_0x49bfe3+_0x22f8ce(0x6e7));return;}await _0x2c5bcf['qzoneGroups']['add']({'name':_0x49bfe3}),_0x31c38e['value']='',await _0x522f28();}async function _0x27551f(_0x35d204){const _0x1bb2fb=_0x419fa8,_0xa1cbf4=await _0x352ae9(_0x1bb2fb(0x115b),_0x1bb2fb(0x1292),{'confirmButtonClass':_0x1bb2fb(0x12bc)});if(_0xa1cbf4){await _0x2c5bcf[_0x1bb2fb(0xaf2)][_0x1bb2fb(0x6d2)](_0x35d204);const _0x354fbf=await _0x2c5bcf[_0x1bb2fb(0x547)][_0x1bb2fb(0xe78)]('groupId')[_0x1bb2fb(0xda9)](_0x35d204)[_0x1bb2fb(0x5ff)]();for(const _0x2d9049 of _0x354fbf){_0x2d9049['groupId']=null,await _0x2c5bcf[_0x1bb2fb(0x547)][_0x1bb2fb(0xff5)](_0x2d9049);if(_0x9ebf46[_0x1bb2fb(0x547)][_0x2d9049['id']])_0x9ebf46['chats'][_0x2d9049['id']]['groupId']=null;}await _0x522f28();}}function _0x37ae78(_0x184b87){const _0x18ff34=_0x419fa8,_0x364f01=_0x9ebf46[_0x18ff34(0x547)][_0x9ebf46[_0x18ff34(0x970)]];document[_0x18ff34(0x9c8)](_0x18ff34(0xae4))[_0x18ff34(0x5e1)][_0x18ff34(0x3c5)]=_0x364f01['isGroup']?_0x18ff34(0x3d9):'none';if(_0x38ba45)return;_0x1f2a43=_0x184b87,document[_0x18ff34(0x9c8)](_0x18ff34(0xf71))[_0x18ff34(0x575)][_0x18ff34(0x68e)]('visible');}function _0x5c2bd9(){const _0x28f811=_0x419fa8;document[_0x28f811(0x9c8)](_0x28f811(0xf71))['classList'][_0x28f811(0x30f)](_0x28f811(0xc3f)),_0x1f2a43=null;}async function _0x431900(){const _0x156708=_0x419fa8;if(!_0x1f2a43)return;const _0x2c34e3=_0x1f2a43,_0x5eebe7=_0x9ebf46[_0x156708(0x547)][_0x9ebf46[_0x156708(0x970)]],_0x5216c=_0x5eebe7[_0x156708(0x8b3)][_0x156708(0xfc3)](_0x222e62=>_0x222e62[_0x156708(0x6b5)]===_0x2c34e3);if(!_0x5216c)return;_0x5c2bd9();let _0x4a23a4;const _0xafd89=_0x5216c[_0x156708(0x12d9)]&&[_0x156708(0x10c1),_0x156708(0x835),'transfer',_0x156708(0x12a5)][_0x156708(0x930)](_0x5216c[_0x156708(0x12d9)]);if(_0xafd89){let _0x44ee7f={'type':_0x5216c['type']};if(_0x5216c['type']==='voice_message')_0x44ee7f[_0x156708(0x53b)]=_0x5216c[_0x156708(0x53b)];else{if(_0x5216c['type']===_0x156708(0x835))_0x44ee7f[_0x156708(0x1387)]=_0x5216c[_0x156708(0x53b)];else{if(_0x5216c[_0x156708(0x12d9)]==='transfer')_0x44ee7f['amount']=_0x5216c['amount'],_0x44ee7f['note']=_0x5216c[_0x156708(0x490)];else _0x5216c[_0x156708(0x12d9)]==='share_link'&&(_0x44ee7f[_0x156708(0x9f2)]=_0x5216c['title'],_0x44ee7f[_0x156708(0x1387)]=_0x5216c[_0x156708(0x1387)],_0x44ee7f['source_name']=_0x5216c[_0x156708(0x545)],_0x44ee7f[_0x156708(0x53b)]=_0x5216c[_0x156708(0x53b)]);}}_0x4a23a4=JSON['stringify'](_0x44ee7f,null,0x2);}else typeof _0x5216c[_0x156708(0x53b)]===_0x156708(0xc24)?_0x4a23a4=JSON[_0x156708(0xf1e)](_0x5216c[_0x156708(0x53b)],null,0x2):_0x4a23a4=_0x5216c[_0x156708(0x53b)];const _0x57e0d9={'voice':{'type':_0x156708(0x10c1),'content':_0x156708(0x92b)},'image':{'type':_0x156708(0x835),'description':_0x156708(0x50b)},'transfer':{'type':_0x156708(0x975),'amount':5.2,'note':'一点心意'},'link':{'type':_0x156708(0x12a5),'title':_0x156708(0x7cf),'description':'文章摘要...','source_name':_0x156708(0x340),'content':_0x156708(0xfab)}},_0x1675c3='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x156708(0xf1e)](_0x57e0d9['voice'])+_0x156708(0xe87)+JSON[_0x156708(0xf1e)](_0x57e0d9['image'])+_0x156708(0x235)+JSON[_0x156708(0xf1e)](_0x57e0d9[_0x156708(0x975)])+_0x156708(0xb45)+JSON['stringify'](_0x57e0d9[_0x156708(0xb1e)])+_0x156708(0x200),_0x1949a8=await _0xadb5df(_0x156708(0x275),'在此修改，或点击上方按钮使用格式模板...',_0x4a23a4,_0x156708(0x11f9),_0x1675c3);_0x1949a8!==null&&await _0x485035(_0x2c34e3,_0x1949a8,!![]);}async function _0x3b2cc9(){const _0x5475ea=_0x419fa8;if(!_0x1f2a43)return;const _0x1548fa=_0x9ebf46[_0x5475ea(0x547)][_0x9ebf46['activeChatId']],_0xce89f4=_0x1548fa['history'][_0x5475ea(0xfc3)](_0xf7dcb0=>_0xf7dcb0[_0x5475ea(0x6b5)]===_0x1f2a43);if(!_0xce89f4)return;let _0x4717e0;typeof _0xce89f4[_0x5475ea(0x53b)]===_0x5475ea(0xc24)?_0x4717e0=JSON[_0x5475ea(0xf1e)](_0xce89f4['content']):_0x4717e0=String(_0xce89f4[_0x5475ea(0x53b)]);try{await navigator[_0x5475ea(0x1314)][_0x5475ea(0x1364)](_0x4717e0),await _0x1bff53('复制成功',_0x5475ea(0x12b5));}catch(_0x2afde1){await _0x1bff53('复制失败',_0x5475ea(0xa4a));}_0x5c2bd9();}async function _0x3149f3(){const _0x2b0fcb=_0x419fa8;if(!_0x1f2a43)return;try{await navigator[_0x2b0fcb(0x1314)][_0x2b0fcb(0x1364)](_0x1f2a43),await _0x1bff53(_0x2b0fcb(0x10d3),_0x2b0fcb(0xcfb)+_0x1f2a43+_0x2b0fcb(0x56e));}catch(_0x12a4a8){await _0x1bff53(_0x2b0fcb(0x8ca),'无法访问剪贴板。');}_0x5c2bd9();}function _0x6318fc(_0x3e02cf=''){const _0x2eec2d=_0x419fa8,_0x1d5e92=document['createElement'](_0x2eec2d(0x11f4));_0x1d5e92[_0x2eec2d(0x82c)]=_0x2eec2d(0xe97);const _0x2c4db2={'voice':{'type':_0x2eec2d(0x10c1),'content':_0x2eec2d(0x92b)},'image':{'type':_0x2eec2d(0x835),'description':_0x2eec2d(0x50b)},'transfer':{'type':_0x2eec2d(0x975),'amount':5.2,'note':_0x2eec2d(0x853)},'link':{'type':_0x2eec2d(0x12a5),'title':_0x2eec2d(0x7cf),'description':_0x2eec2d(0x764),'source_name':'来源网站','content':_0x2eec2d(0xfab)},'offline':{'type':_0x2eec2d(0xc91),'content':_0x2eec2d(0x325)},'quote':{'type':_0x2eec2d(0xb43),'target_timestamp':0x499602d2,'reply_content':_0x2eec2d(0x190)}};return _0x1d5e92[_0x2eec2d(0x2f5)]=_0x2eec2d(0x5f5)+_0x3e02cf+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x2eec2d(0xf1e)](_0x2c4db2[_0x2eec2d(0x72f)])+_0x2eec2d(0x12ff)+JSON['stringify'](_0x2c4db2[_0x2eec2d(0x10eb)])+_0x2eec2d(0x64a)+JSON[_0x2eec2d(0xf1e)](_0x2c4db2[_0x2eec2d(0x975)])+_0x2eec2d(0x11df)+JSON[_0x2eec2d(0xf1e)](_0x2c4db2[_0x2eec2d(0xb1e)])+_0x2eec2d(0xb4a)+JSON[_0x2eec2d(0xf1e)](_0x2c4db2['offline'])+'\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x2eec2d(0xf1e)](_0x2c4db2[_0x2eec2d(0xa19)])+_0x2eec2d(0x76e),_0x1d5e92['querySelector'](_0x2eec2d(0x85c))[_0x2eec2d(0xa0f)]('click',()=>{const _0x34db4f=_0x2eec2d;document[_0x34db4f(0x7e4)]('.message-editor-block')[_0x34db4f(0xa06)]>0x1?_0x1d5e92[_0x34db4f(0x30f)]():alert(_0x34db4f(0x134f));}),_0x1d5e92[_0x2eec2d(0x7e4)](_0x2eec2d(0xc15))[_0x2eec2d(0x591)](_0x1b2917=>{const _0x1526cf=_0x2eec2d;_0x1b2917[_0x1526cf(0xa0f)](_0x1526cf(0xf5c),()=>{const _0x5069ca=_0x1526cf,_0x490c6c=_0x1b2917['dataset'][_0x5069ca(0x9bc)],_0x40fe02=_0x1d5e92[_0x5069ca(0x91d)](_0x5069ca(0x11f9));if(_0x490c6c&&_0x40fe02)try{const _0x18b850=JSON[_0x5069ca(0x907)](_0x490c6c);_0x40fe02[_0x5069ca(0x1155)]=JSON[_0x5069ca(0xf1e)](_0x18b850,null,0x2),_0x40fe02[_0x5069ca(0x6fd)]();}catch(_0x4a812c){console[_0x5069ca(0x1221)](_0x5069ca(0x507),_0x4a812c);}});}),_0x1d5e92;}function _0x2e94e8(){const _0x30fb53=_0x419fa8;if(!_0x1f2a43)return;const _0xc91ba7=_0x1f2a43,_0x3b416e=_0x9ebf46[_0x30fb53(0x547)][_0x9ebf46[_0x30fb53(0x970)]],_0x52ece9=_0x3b416e[_0x30fb53(0x8b3)][_0x30fb53(0xfc3)](_0x5d1597=>_0x5d1597[_0x30fb53(0x6b5)]===_0xc91ba7);if(!_0x52ece9)return;_0x5c2bd9();const _0x57ca77=document[_0x30fb53(0x9c8)](_0x30fb53(0xb4c)),_0x5a820f=document['getElementById'](_0x30fb53(0x10c0));_0x5a820f['innerHTML']='';let _0x3dc89d;if(_0x52ece9[_0x30fb53(0xa19)]){const _0x28cdfb={'type':'quote_reply','target_timestamp':_0x52ece9[_0x30fb53(0xa19)][_0x30fb53(0x6b5)],'reply_content':_0x52ece9['content']};_0x3dc89d=JSON[_0x30fb53(0xf1e)](_0x28cdfb,null,0x2);}else{if(_0x52ece9[_0x30fb53(0x12d9)]&&[_0x30fb53(0x10c1),_0x30fb53(0x835),_0x30fb53(0x975),_0x30fb53(0xc91),_0x30fb53(0x12a5)][_0x30fb53(0x930)](_0x52ece9[_0x30fb53(0x12d9)])){let _0x48f09e={'type':_0x52ece9[_0x30fb53(0x12d9)]};if(_0x52ece9[_0x30fb53(0x12d9)]==='voice_message')_0x48f09e[_0x30fb53(0x53b)]=_0x52ece9['content'];else{if(_0x52ece9[_0x30fb53(0x12d9)]==='ai_image')_0x48f09e[_0x30fb53(0x1387)]=_0x52ece9['content'];else{if(_0x52ece9[_0x30fb53(0x12d9)]===_0x30fb53(0x975))_0x48f09e[_0x30fb53(0x212)]=_0x52ece9['amount'],_0x48f09e[_0x30fb53(0x490)]=_0x52ece9[_0x30fb53(0x490)];else{if(_0x52ece9[_0x30fb53(0x12d9)]===_0x30fb53(0xc91))_0x52ece9[_0x30fb53(0x53b)]?_0x48f09e[_0x30fb53(0x53b)]=_0x52ece9['content']:(_0x48f09e['dialogue']=_0x52ece9[_0x30fb53(0xc2e)],_0x48f09e['description']=_0x52ece9[_0x30fb53(0x1387)]);else _0x52ece9[_0x30fb53(0x12d9)]==='share_link'&&(_0x48f09e[_0x30fb53(0x9f2)]=_0x52ece9[_0x30fb53(0x9f2)],_0x48f09e[_0x30fb53(0x1387)]=_0x52ece9[_0x30fb53(0x1387)],_0x48f09e[_0x30fb53(0x545)]=_0x52ece9[_0x30fb53(0x545)],_0x48f09e[_0x30fb53(0x53b)]=_0x52ece9[_0x30fb53(0x53b)]);}}}_0x3dc89d=JSON[_0x30fb53(0xf1e)](_0x48f09e,null,0x2);}else typeof _0x52ece9[_0x30fb53(0x53b)]===_0x30fb53(0xc24)?_0x3dc89d=JSON[_0x30fb53(0xf1e)](_0x52ece9[_0x30fb53(0x53b)],null,0x2):_0x3dc89d=_0x52ece9[_0x30fb53(0x53b)];}const _0x326992=_0x6318fc(_0x3dc89d);_0x5a820f[_0x30fb53(0x7b9)](_0x326992);const _0x3598ab=document[_0x30fb53(0x9c8)](_0x30fb53(0x884)),_0x53612b=_0x3598ab[_0x30fb53(0x75c)](!![]);_0x3598ab[_0x30fb53(0x127d)]['replaceChild'](_0x53612b,_0x3598ab),_0x53612b[_0x30fb53(0xa0f)]('click',()=>{const _0x1964fa=_0x30fb53,_0x188da8=_0x6318fc();_0x5a820f[_0x1964fa(0x7b9)](_0x188da8),_0x188da8['querySelector'](_0x1964fa(0x11f9))[_0x1964fa(0x6fd)]();});const _0xecd92d=document['getElementById']('cancel-advanced-editor-btn'),_0x101ff1=_0xecd92d['cloneNode'](!![]);_0xecd92d[_0x30fb53(0x127d)]['replaceChild'](_0x101ff1,_0xecd92d),_0x101ff1[_0x30fb53(0xa0f)](_0x30fb53(0xf5c),()=>{const _0x13aef2=_0x30fb53;_0x57ca77[_0x13aef2(0x575)][_0x13aef2(0x30f)](_0x13aef2(0xc3f));});const _0x4973bd=document[_0x30fb53(0x9c8)](_0x30fb53(0xe05)),_0x5b4b46=_0x4973bd[_0x30fb53(0x75c)](!![]);_0x4973bd[_0x30fb53(0x127d)][_0x30fb53(0x4d7)](_0x5b4b46,_0x4973bd),_0x5b4b46[_0x30fb53(0xa0f)](_0x30fb53(0xf5c),()=>{_0x485035(_0xc91ba7);}),_0x57ca77[_0x30fb53(0x575)][_0x30fb53(0x68e)](_0x30fb53(0xc3f));}async function _0x3b2cc9(){const _0x2349c2=_0x419fa8;if(!_0x1f2a43)return;const _0x2ace3b=_0x9ebf46[_0x2349c2(0x547)][_0x9ebf46[_0x2349c2(0x970)]],_0x39f657=_0x2ace3b[_0x2349c2(0x8b3)][_0x2349c2(0xfc3)](_0x4a1216=>_0x4a1216['timestamp']===_0x1f2a43);if(!_0x39f657)return;let _0x5d221f;if(_0x39f657[_0x2349c2(0x12d9)]===_0x2349c2(0xc91))_0x39f657[_0x2349c2(0x53b)]?_0x5d221f=_0x39f657[_0x2349c2(0x53b)]:_0x5d221f='「'+(_0x39f657[_0x2349c2(0xc2e)]||'')+'」\x0a'+(_0x39f657[_0x2349c2(0x1387)]||'');else typeof _0x39f657[_0x2349c2(0x53b)]==='object'?_0x5d221f=JSON['stringify'](_0x39f657['content']):_0x5d221f=String(_0x39f657[_0x2349c2(0x53b)]);try{await navigator['clipboard'][_0x2349c2(0x1364)](_0x5d221f),await _0x1bff53(_0x2349c2(0x10d3),'消息内容已复制到剪贴板。');}catch(_0x212b79){await _0x1bff53(_0x2349c2(0x8ca),_0x2349c2(0xa4a));}_0x5c2bd9();}function _0x1d0358(_0x5420ca){const _0x50a153=_0x419fa8,_0x17634f=_0x5420ca[_0x50a153(0x3f1)]();if(_0x17634f[_0x50a153(0xc8d)]('{')&&_0x17634f['endsWith']('}'))try{const _0xb85d6a=JSON['parse'](_0x17634f);if(_0xb85d6a[_0x50a153(0x12d9)])return _0xb85d6a;}catch(_0xf9848e){}if(_0x2d389f['test'](_0x17634f))return{'type':_0x50a153(0x83e),'content':_0x17634f};return{'type':_0x50a153(0xbb7),'content':_0x17634f};}async function _0x485035(_0x390dad,_0x45ce44=null){const _0x43e4e6=_0x419fa8;if(!_0x390dad)return;const _0x4edcd4=_0x9ebf46['chats'][_0x9ebf46[_0x43e4e6(0x970)]],_0x5f99d5=_0x4edcd4[_0x43e4e6(0x8b3)][_0x43e4e6(0x684)](_0x2bc40f=>_0x2bc40f[_0x43e4e6(0x6b5)]===_0x390dad);if(_0x5f99d5===-0x1)return;const _0x4c1c10=_0x4edcd4[_0x43e4e6(0x8b3)][_0x5f99d5];let _0x56965a=[];const _0x1d91f8=_0x45ce44!==null?[_0x45ce44]:Array['from'](document[_0x43e4e6(0x7e4)](_0x43e4e6(0xa2d)))[_0x43e4e6(0xa3b)](_0x534a38=>_0x534a38['value']);for(const _0x1230f6 of _0x1d91f8){if(!_0x1230f6[_0x43e4e6(0x3f1)]())continue;const _0x4ec000=_0x1d0358(_0x1230f6[_0x43e4e6(0x3f1)]()),_0xdccabc={'role':_0x4c1c10[_0x43e4e6(0x7fd)],'senderName':_0x4c1c10['senderName'],'timestamp':_0x4c1c10[_0x43e4e6(0x6b5)]};switch(_0x4ec000[_0x43e4e6(0x12d9)]){case'text':_0xdccabc[_0x43e4e6(0x12d9)]=_0x43e4e6(0xbb7),_0xdccabc[_0x43e4e6(0x53b)]=_0x4ec000[_0x43e4e6(0x53b)];break;case _0x43e4e6(0xc91):_0xdccabc['type']='offline_text';_0x4ec000[_0x43e4e6(0x53b)]?_0xdccabc[_0x43e4e6(0x53b)]=_0x4ec000['content']:(_0xdccabc['dialogue']=_0x4ec000[_0x43e4e6(0xc2e)],_0xdccabc[_0x43e4e6(0x1387)]=_0x4ec000[_0x43e4e6(0x1387)]);break;case _0x43e4e6(0xb43):_0xdccabc[_0x43e4e6(0x12d9)]='quote_reply',_0xdccabc['content']=_0x4ec000[_0x43e4e6(0xbb2)];const _0xbb9fe7=_0x4edcd4[_0x43e4e6(0x8b3)]['find'](_0x2ff6a9=>_0x2ff6a9[_0x43e4e6(0x6b5)]===_0x4ec000['target_timestamp']);if(_0xbb9fe7){let _0x42f45a=_0xbb9fe7[_0x43e4e6(0xac4)];_0xbb9fe7[_0x43e4e6(0x7fd)]==='user'&&(_0x42f45a=_0x9ebf46['qzoneSettings'][_0x43e4e6(0x5b7)]||_0x43e4e6(0x5c1)),_0xdccabc['quote']={'timestamp':_0x4ec000['target_timestamp'],'senderName':_0x42f45a,'content':String(_0xbb9fe7[_0x43e4e6(0x53b)]||'')};}else _0xdccabc[_0x43e4e6(0xa19)]={'timestamp':_0x4ec000[_0x43e4e6(0x18b)],'senderName':'未知用户','content':_0x43e4e6(0xa6c)};break;case _0x43e4e6(0x10c1):case _0x43e4e6(0x835):case _0x43e4e6(0x560):_0xdccabc[_0x43e4e6(0x12d9)]=_0x4ec000[_0x43e4e6(0x12d9)],_0xdccabc[_0x43e4e6(0x53b)]=_0x4ec000[_0x43e4e6(0x53b)]||_0x4ec000[_0x43e4e6(0x1387)];if(_0x4ec000['meaning'])_0xdccabc[_0x43e4e6(0x1b3)]=_0x4ec000[_0x43e4e6(0x1b3)];break;case _0x43e4e6(0x83e):{_0xdccabc['type']=_0x43e4e6(0x83e);let _0x38ae58=![];if(_0x4ec000['meaning']){const _0x43b0ce=_0x9ebf46[_0x43e4e6(0x774)][_0x43e4e6(0xfc3)](_0x563173=>_0x563173[_0x43e4e6(0x609)]===_0x4ec000['meaning']);_0x43b0ce?(_0xdccabc['content']=_0x43b0ce[_0x43e4e6(0x11be)],_0xdccabc['meaning']=_0x43b0ce[_0x43e4e6(0x609)],console[_0x43e4e6(0x283)](_0x43e4e6(0x8bd)),_0x38ae58=!![]):(_0xdccabc[_0x43e4e6(0x12d9)]='text',_0xdccabc[_0x43e4e6(0x53b)]=_0x43e4e6(0xef0)+_0x4ec000[_0x43e4e6(0x1b3)]+']',console[_0x43e4e6(0x453)](_0x43e4e6(0x130c),_0x4ec000[_0x43e4e6(0x1b3)]),_0x38ae58=!![]);}if(!_0x38ae58&&_0x4ec000[_0x43e4e6(0x11be)]){_0xdccabc[_0x43e4e6(0x53b)]=_0x4ec000[_0x43e4e6(0x11be)];const _0x7c62f7=_0x9ebf46[_0x43e4e6(0x774)][_0x43e4e6(0xfc3)](_0x5c44cc=>_0x5c44cc['url']===_0x4ec000[_0x43e4e6(0x11be)]);if(_0x4ec000['meaning']&&(!_0x7c62f7||_0x7c62f7['name']===_0x4ec000[_0x43e4e6(0x1b3)]))_0xdccabc['meaning']=_0x4ec000[_0x43e4e6(0x1b3)];else _0x7c62f7?_0xdccabc[_0x43e4e6(0x1b3)]=_0x7c62f7[_0x43e4e6(0x609)]:_0xdccabc[_0x43e4e6(0x1b3)]=_0x43e4e6(0xdbe);console[_0x43e4e6(0x283)](_0x43e4e6(0x3f5),_0xdccabc[_0x43e4e6(0x1b3)]),_0x38ae58=!![];}if(!_0x38ae58&&_0x4ec000['content']&&typeof _0x4ec000[_0x43e4e6(0x53b)]==='string'&&_0x2d389f[_0x43e4e6(0x4e8)](_0x4ec000[_0x43e4e6(0x53b)])){_0xdccabc['content']=_0x4ec000[_0x43e4e6(0x53b)];const _0x30e223=_0x9ebf46[_0x43e4e6(0x774)][_0x43e4e6(0xfc3)](_0x14b7bd=>_0x14b7bd['url']===_0x4ec000[_0x43e4e6(0x53b)]);_0xdccabc[_0x43e4e6(0x1b3)]=_0x30e223?_0x30e223['name']:'未知表情',console[_0x43e4e6(0x283)](_0x43e4e6(0x3ce),_0xdccabc[_0x43e4e6(0x1b3)]),_0x38ae58=!![];}if(!_0x38ae58){console[_0x43e4e6(0x1221)](_0x43e4e6(0xc18),_0x4ec000);continue;}break;}case'transfer':_0xdccabc[_0x43e4e6(0x12d9)]=_0x43e4e6(0x975),_0xdccabc['amount']=_0x4ec000['amount'],_0xdccabc[_0x43e4e6(0x490)]=_0x4ec000[_0x43e4e6(0x490)];break;case _0x43e4e6(0x12a5):_0xdccabc['type']='share_link',_0xdccabc[_0x43e4e6(0x9f2)]=_0x4ec000[_0x43e4e6(0x9f2)],_0xdccabc[_0x43e4e6(0x1387)]=_0x4ec000['description'],_0xdccabc[_0x43e4e6(0x545)]=_0x4ec000[_0x43e4e6(0x545)],_0xdccabc[_0x43e4e6(0x53b)]=_0x4ec000[_0x43e4e6(0x53b)];break;default:Object[_0x43e4e6(0x6d3)](_0xdccabc,_0x4ec000);break;}_0x56965a[_0x43e4e6(0x668)](_0xdccabc);}if(_0x56965a[_0x43e4e6(0xa06)]===0x0){document['getElementById'](_0x43e4e6(0xb4c))['classList'][_0x43e4e6(0x30f)](_0x43e4e6(0xc3f));return;}_0x4edcd4[_0x43e4e6(0x8b3)][_0x43e4e6(0x888)](_0x5f99d5,0x1,..._0x56965a);let _0x5233e1=_0x390dad;for(let _0x479bdf=_0x5f99d5;_0x479bdf<_0x4edcd4[_0x43e4e6(0x8b3)][_0x43e4e6(0xa06)];_0x479bdf++){_0x4edcd4['history'][_0x479bdf]['timestamp']=_0x5233e1,_0x5233e1++;}await _0x2c5bcf[_0x43e4e6(0x547)][_0x43e4e6(0xff5)](_0x4edcd4),document[_0x43e4e6(0x9c8)](_0x43e4e6(0xb4c))['classList']['remove'](_0x43e4e6(0xc3f)),_0x1a44b1(_0x9ebf46[_0x43e4e6(0x970)]),await _0x1bff53('成功',_0x43e4e6(0xa84));}function _0x3ce008(_0x58b9c6){const _0x5bcb20=_0x419fa8;_0x52f277=_0x58b9c6,document[_0x5bcb20(0x9c8)]('post-actions-modal')['classList'][_0x5bcb20(0x68e)](_0x5bcb20(0xc3f));}function _0x4d4844(){const _0x444b52=_0x419fa8;document[_0x444b52(0x9c8)](_0x444b52(0x65d))[_0x444b52(0x575)]['remove'](_0x444b52(0xc3f)),_0x52f277=null;}async function _0xb88101(){const _0x15ef5b=_0x419fa8;if(!_0x52f277)return;const _0x59c909=_0x52f277,_0x2ee9b7=await _0x2c5bcf[_0x15ef5b(0x75f)][_0x15ef5b(0xdf9)](_0x59c909);if(!_0x2ee9b7)return;_0x4d4844();let _0x3cc91a;if(_0x2ee9b7[_0x15ef5b(0x12d9)]===_0x15ef5b(0x1238))_0x3cc91a=_0x2ee9b7['content'];else{const _0x27c6f0={'type':_0x2ee9b7[_0x15ef5b(0x12d9)],'publicText':_0x2ee9b7['publicText']||''};if(_0x2ee9b7[_0x15ef5b(0x12d9)]===_0x15ef5b(0x55b))_0x27c6f0['imageUrl']=_0x2ee9b7['imageUrl'],_0x27c6f0[_0x15ef5b(0xb34)]=_0x2ee9b7[_0x15ef5b(0xb34)];else _0x2ee9b7[_0x15ef5b(0x12d9)]===_0x15ef5b(0xf74)&&(_0x27c6f0[_0x15ef5b(0x841)]=_0x2ee9b7['hiddenContent']);_0x3cc91a=JSON[_0x15ef5b(0xf1e)](_0x27c6f0,null,0x2);}const _0x242300={'shuoshuo':_0x15ef5b(0x1cc),'image':{'type':_0x15ef5b(0x55b),'publicText':'','imageUrl':'https://...','imageDescription':''},'text_image':{'type':_0x15ef5b(0xf74),'publicText':'','hiddenContent':''}},_0x2db9e1=_0x15ef5b(0xcd4)+JSON[_0x15ef5b(0xf1e)](_0x242300[_0x15ef5b(0x10eb)])+_0x15ef5b(0x130d)+JSON[_0x15ef5b(0xf1e)](_0x242300[_0x15ef5b(0xf74)])+_0x15ef5b(0xa6f),_0x50adf4=await _0xadb5df(_0x15ef5b(0x10bb),'在此修改内容...',_0x3cc91a,'textarea',_0x2db9e1);setTimeout(()=>{const _0x5e30c8=document['querySelector']('#custom-modal-body\x20.format-btn[data-type=\x22text\x22]');_0x5e30c8&&_0x5e30c8['addEventListener']('click',()=>{const _0x129e49=_0x3569,_0x4b8a6e=document['getElementById'](_0x129e49(0x1de));_0x4b8a6e[_0x129e49(0x1155)]=_0x242300[_0x129e49(0x1238)],_0x4b8a6e[_0x129e49(0x6fd)]();});},0x64),_0x50adf4!==null&&await _0x5d4f64(_0x59c909,_0x50adf4);}async function _0x5d4f64(_0xc07576,_0x4a86fd){const _0x251c3e=_0x419fa8,_0x163bab=await _0x2c5bcf[_0x251c3e(0x75f)][_0x251c3e(0xdf9)](_0xc07576);if(!_0x163bab)return;const _0x1ddaf8=_0x4a86fd[_0x251c3e(0x3f1)]();try{const _0x46c9a4=JSON[_0x251c3e(0x907)](_0x1ddaf8);_0x163bab['type']=_0x46c9a4[_0x251c3e(0x12d9)]||'image_post',_0x163bab[_0x251c3e(0x7b2)]=_0x46c9a4[_0x251c3e(0x7b2)]||'',_0x163bab[_0x251c3e(0xd5e)]=_0x46c9a4[_0x251c3e(0xd5e)]||'',_0x163bab[_0x251c3e(0xb34)]=_0x46c9a4[_0x251c3e(0xb34)]||'',_0x163bab[_0x251c3e(0x841)]=_0x46c9a4['hiddenContent']||'',_0x163bab[_0x251c3e(0x53b)]='';}catch(_0x43b685){_0x163bab[_0x251c3e(0x12d9)]=_0x251c3e(0x1238),_0x163bab['content']=_0x1ddaf8,_0x163bab['publicText']='',_0x163bab[_0x251c3e(0xd5e)]='',_0x163bab['imageDescription']='',_0x163bab['hiddenContent']='';}await _0x2c5bcf[_0x251c3e(0x75f)]['put'](_0x163bab),await _0x2c70a9(),await _0x1bff53('成功',_0x251c3e(0x138c));}async function _0x5dfbd6(){const _0x11438c=_0x419fa8;if(!_0x52f277)return;const _0x1c067c=await _0x2c5bcf[_0x11438c(0x75f)][_0x11438c(0xdf9)](_0x52f277);if(!_0x1c067c)return;let _0x44b1d8=_0x1c067c['content']||_0x1c067c[_0x11438c(0x7b2)]||_0x1c067c[_0x11438c(0x841)]||_0x1c067c[_0x11438c(0xb34)]||_0x11438c(0x2d3);try{await navigator['clipboard'][_0x11438c(0x1364)](_0x44b1d8),await _0x1bff53(_0x11438c(0x10d3),_0x11438c(0x832));}catch(_0x2b38a8){await _0x1bff53(_0x11438c(0x8ca),_0x11438c(0xa4a));}_0x4d4844();}let _0x502f3b=new Set();async function _0x350f08(){const _0x491d56=_0x419fa8,_0x320d21=await _0xb8c832('创建群聊',[{'text':_0x491d56(0x448),'value':_0x491d56(0x5d4)},{'text':'创建旁观群聊\x20(我围观)','value':_0x491d56(0xd3c)}]);if(_0x320d21===_0x491d56(0x5d4)){_0x502f3b[_0x491d56(0xdae)]();const _0x628f83=document['getElementById']('confirm-contact-picker-btn'),_0x53ed26=_0x628f83['cloneNode'](!![]);_0x628f83['parentNode']['replaceChild'](_0x53ed26,_0x628f83),_0x53ed26[_0x491d56(0xa0f)](_0x491d56(0xf5c),_0x12c0de),await _0x5cbc76(),_0xe5834e(_0x491d56(0x9d4));}else _0x320d21===_0x491d56(0xd3c)&&_0x2dfbc0();}async function _0x2dfbc0(){const _0x2a5d6b=_0x419fa8;_0x502f3b['clear']();const _0x4b601e=document[_0x2a5d6b(0x9c8)](_0x2a5d6b(0xa31)),_0x5f3055=_0x4b601e['cloneNode'](!![]);_0x4b601e[_0x2a5d6b(0x127d)][_0x2a5d6b(0x4d7)](_0x5f3055,_0x4b601e),_0x5f3055[_0x2a5d6b(0xa0f)](_0x2a5d6b(0xf5c),_0x21a82b),await _0x2b388a(),_0xe5834e(_0x2a5d6b(0x9d4));}async function _0x2b388a(){const _0x5e00a7=_0x419fa8,_0x1f1529=document[_0x5e00a7(0x9c8)](_0x5e00a7(0x5b0));_0x1f1529[_0x5e00a7(0x2f5)]='';const _0x3f35ad=Object['values'](_0x9ebf46[_0x5e00a7(0x547)])[_0x5e00a7(0x401)](_0x495078=>!_0x495078['isGroup']),_0x5699f1=await _0x2c5bcf[_0x5e00a7(0x1094)][_0x5e00a7(0x5ff)]();if(_0x3f35ad['length']===0x0&&_0x5699f1[_0x5e00a7(0xa06)]===0x0){_0x1f1529['innerHTML']=_0x5e00a7(0x8ae);return;}_0x3f35ad[_0x5e00a7(0x591)](_0x6fab6b=>{const _0x128647=_0x5e00a7,_0x1740cd=document[_0x128647(0x28a)](_0x128647(0x11f4));_0x1740cd['className']=_0x128647(0xd75),_0x1740cd['dataset']['contactId']=_0x6fab6b['id'],_0x1740cd[_0x128647(0x2f5)]=_0x128647(0x10a9)+(_0x6fab6b[_0x128647(0x1131)][_0x128647(0xd4d)]||_0x246753)+_0x128647(0x131a)+_0x6fab6b[_0x128647(0x609)]+_0x128647(0x1b5),_0x1f1529[_0x128647(0x7b9)](_0x1740cd);}),_0x5699f1[_0x5e00a7(0x591)](_0x395a55=>{const _0x35f50d=_0x5e00a7,_0x37044f=document[_0x35f50d(0x28a)](_0x35f50d(0x11f4));_0x37044f[_0x35f50d(0x82c)]='contact-picker-item',_0x37044f[_0x35f50d(0xc9f)][_0x35f50d(0xa00)]=_0x395a55['id'],_0x37044f[_0x35f50d(0xc9f)]['isNpc']=_0x35f50d(0x667),_0x37044f['innerHTML']=_0x35f50d(0x10a9)+(_0x395a55[_0x35f50d(0x10c9)]||_0x337c8f)+_0x35f50d(0x131a)+_0x395a55[_0x35f50d(0x609)]+'\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x1f1529[_0x35f50d(0x7b9)](_0x37044f);}),_0x2093b3();}async function _0x21a82b(){const _0x5093b5=_0x419fa8;if(_0x502f3b['size']<0x2){alert('旁观群聊至少需要选择2个成员。');return;}const _0x151414=await _0xadb5df(_0x5093b5(0x700),_0x5093b5(0x1123),'AI们的茶话会');if(!_0x151414||!_0x151414[_0x5093b5(0x3f1)]())return;const _0x2d030a=_0x5093b5(0x473)+Date[_0x5093b5(0x9b7)](),_0x23e483=[],_0x3ff940=await _0x2c5bcf[_0x5093b5(0x1094)][_0x5093b5(0x5ff)]();for(const _0x304bd0 of _0x502f3b){const _0x5d08fe=document[_0x5093b5(0x91d)]('.contact-picker-item[data-contact-id=\x22'+_0x304bd0+'\x22]')['dataset']['isNpc']==='true';if(_0x5d08fe){const _0x18277c=_0x3ff940[_0x5093b5(0xfc3)](_0xbab6fc=>_0xbab6fc['id']===parseInt(_0x304bd0));_0x18277c&&_0x23e483[_0x5093b5(0x668)]({'id':_0x5093b5(0x2e7)+_0x18277c['id'],'originalName':_0x18277c[_0x5093b5(0x609)],'groupNickname':_0x18277c[_0x5093b5(0x609)],'persona':_0x18277c[_0x5093b5(0xeb1)],'avatar':_0x18277c[_0x5093b5(0x10c9)]||_0x337c8f,'isNpc':!![]});}else{const _0x3ffe1c=_0x9ebf46[_0x5093b5(0x547)][_0x304bd0];_0x3ffe1c&&_0x23e483['push']({'id':_0x304bd0,'originalName':_0x3ffe1c[_0x5093b5(0x1071)],'groupNickname':_0x3ffe1c[_0x5093b5(0x609)],'persona':_0x3ffe1c['settings'][_0x5093b5(0xae3)],'avatar':_0x3ffe1c[_0x5093b5(0x1131)][_0x5093b5(0xd4d)]||_0x246753,'isNpc':![]});}}const _0x50eb89={'id':_0x2d030a,'name':_0x151414[_0x5093b5(0x3f1)](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x23e483,'settings':{'maxMemory':0xa,'groupAvatar':_0x5d7a94,'background':'','theme':_0x5093b5(0x108b),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':_0x5093b5(0xb64),'content':'[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','timestamp':Date[_0x5093b5(0x9b7)](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x9ebf46[_0x5093b5(0x547)][_0x2d030a]=_0x50eb89,await _0x2c5bcf[_0x5093b5(0x547)][_0x5093b5(0xff5)](_0x50eb89),await _0x394b2c(),_0xe5834e('chat-list-screen'),_0x49f56e(_0x2d030a);}async function _0x5cbc76(){const _0xef5987=_0x419fa8,_0x523100=document[_0xef5987(0x9c8)]('contact-picker-list');_0x523100['innerHTML']='';const _0x33c121=Object['values'](_0x9ebf46[_0xef5987(0x547)])[_0xef5987(0x401)](_0x6b3371=>!_0x6b3371[_0xef5987(0x11e4)]),_0x2f4204=await _0x2c5bcf[_0xef5987(0x1094)][_0xef5987(0x5ff)]();if(_0x33c121[_0xef5987(0xa06)]===0x0&&_0x2f4204[_0xef5987(0xa06)]===0x0){_0x523100[_0xef5987(0x2f5)]=_0xef5987(0xdef);return;}_0x33c121[_0xef5987(0x591)](_0x1cf14a=>{const _0x2b9ba2=_0xef5987,_0x3984a0=document[_0x2b9ba2(0x28a)](_0x2b9ba2(0x11f4));_0x3984a0['className']=_0x2b9ba2(0xd75),_0x3984a0[_0x2b9ba2(0xc9f)][_0x2b9ba2(0xa00)]=_0x1cf14a['id'],_0x3984a0[_0x2b9ba2(0x2f5)]=_0x2b9ba2(0x10a9)+(_0x1cf14a[_0x2b9ba2(0x1131)][_0x2b9ba2(0xd4d)]||_0x246753)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x1cf14a[_0x2b9ba2(0x609)]+_0x2b9ba2(0x1b5),_0x523100[_0x2b9ba2(0x7b9)](_0x3984a0);}),_0x2f4204['forEach'](_0x414db3=>{const _0x2a2f2a=_0xef5987,_0x451438=document[_0x2a2f2a(0x28a)]('div');_0x451438[_0x2a2f2a(0x82c)]=_0x2a2f2a(0xd75),_0x451438[_0x2a2f2a(0xc9f)][_0x2a2f2a(0xa00)]=_0x2a2f2a(0x2e7)+_0x414db3['id'],_0x451438[_0x2a2f2a(0x2f5)]=_0x2a2f2a(0x10a9)+(_0x414db3[_0x2a2f2a(0x10c9)]||_0x337c8f)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x414db3[_0x2a2f2a(0x609)]+_0x2a2f2a(0x10e2),_0x523100['appendChild'](_0x451438);}),_0x2093b3();}function _0x2093b3(){const _0x3f3f62=_0x419fa8,_0x47f6a2=document[_0x3f3f62(0x9c8)](_0x3f3f62(0xa31));_0x47f6a2['textContent']=_0x3f3f62(0x6d6)+_0x502f3b[_0x3f3f62(0xa67)]+')',_0x47f6a2['disabled']=_0x502f3b['size']<0x2;}async function _0x12c0de(){const _0x4c3fea=_0x419fa8;if(_0x502f3b[_0x4c3fea(0xa67)]<0x2){alert(_0x4c3fea(0xbe5));return;}const _0xcb899e=await _0xadb5df(_0x4c3fea(0x700),_0x4c3fea(0x1123),'我们的群聊');if(!_0xcb899e||!_0xcb899e[_0x4c3fea(0x3f1)]())return;const _0x740c0d=_0x4c3fea(0x473)+Date[_0x4c3fea(0x9b7)](),_0x2e8468=[],_0x24b1dc=await _0x2c5bcf[_0x4c3fea(0x1094)]['toArray']();for(const _0x51fed6 of _0x502f3b){if(_0x51fed6['startsWith'](_0x4c3fea(0x2e7))){const _0x5b0013=parseInt(_0x51fed6[_0x4c3fea(0x459)](_0x4c3fea(0x2e7),'')),_0x1d69bd=_0x24b1dc[_0x4c3fea(0xfc3)](_0x218451=>_0x218451['id']===_0x5b0013);_0x1d69bd&&_0x2e8468[_0x4c3fea(0x668)]({'id':_0x51fed6,'originalName':_0x1d69bd[_0x4c3fea(0x609)],'groupNickname':_0x1d69bd[_0x4c3fea(0x609)],'persona':_0x1d69bd[_0x4c3fea(0xeb1)],'avatar':_0x1d69bd[_0x4c3fea(0x10c9)]||_0x337c8f,'isNpc':!![]});}else{const _0x2ef6a2=_0x9ebf46[_0x4c3fea(0x547)][_0x51fed6];_0x2ef6a2&&_0x2e8468[_0x4c3fea(0x668)]({'id':_0x51fed6,'originalName':_0x2ef6a2[_0x4c3fea(0x1071)],'groupNickname':_0x2ef6a2['name'],'persona':_0x2ef6a2[_0x4c3fea(0x1131)]['aiPersona'],'avatar':_0x2ef6a2['settings'][_0x4c3fea(0xd4d)]||_0x246753,'isNpc':![]});}}const _0x43ea6d={'id':_0x740c0d,'name':_0xcb899e[_0x4c3fea(0x3f1)](),'isGroup':!![],'members':_0x2e8468,'settings':{'myPersona':_0x4c3fea(0xafc),'myNickname':'我','maxMemory':0xa,'groupAvatar':_0x5d7a94,'myAvatar':_0x1d990b,'background':'','theme':_0x4c3fea(0x108b),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x9ebf46[_0x4c3fea(0x547)][_0x740c0d]=_0x43ea6d,await _0x2c5bcf['chats'][_0x4c3fea(0xff5)](_0x43ea6d),await _0x394b2c(),_0xe5834e(_0x4c3fea(0x1056)),_0x49f56e(_0x740c0d);}function _0x36c264(){const _0x2eba3c=_0x419fa8;if(!_0x9ebf46[_0x2eba3c(0x970)]||!_0x9ebf46[_0x2eba3c(0x547)][_0x9ebf46['activeChatId']]['isGroup'])return;_0x36d6d6(),_0xe5834e('member-management-screen');}function _0x36d6d6(){const _0x49328e=_0x419fa8,_0x4fe4db=document['getElementById'](_0x49328e(0xba4)),_0x582d4a=_0x9ebf46['chats'][_0x9ebf46['activeChatId']];_0x4fe4db[_0x49328e(0x2f5)]='',_0x582d4a[_0x49328e(0xd3e)][_0x49328e(0x591)](_0x134146=>{const _0x22b677=_0x49328e,_0x51fea4=document[_0x22b677(0x28a)]('div');_0x51fea4[_0x22b677(0x82c)]='member-management-item',_0x51fea4['innerHTML']=_0x22b677(0x5d1)+_0x134146[_0x22b677(0x10c9)]+_0x22b677(0x702)+_0x134146[_0x22b677(0x1132)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22'+_0x134146['id']+_0x22b677(0x86a),_0x4fe4db[_0x22b677(0x7b9)](_0x51fea4);});}async function _0x5d5175(_0x147226){const _0x8006b8=_0x419fa8,_0x1bc8dd=_0x9ebf46[_0x8006b8(0x547)][_0x9ebf46[_0x8006b8(0x970)]],_0x5820c6=_0x1bc8dd[_0x8006b8(0xd3e)][_0x8006b8(0x684)](_0x394e8f=>_0x394e8f['id']===_0x147226);if(_0x5820c6===-0x1)return;if(_0x1bc8dd[_0x8006b8(0xd3e)][_0x8006b8(0xa06)]<=0x2){alert(_0x8006b8(0x4bf));return;}const _0x354652=_0x1bc8dd[_0x8006b8(0xd3e)][_0x5820c6][_0x8006b8(0x1132)],_0x558f9d=await _0x352ae9(_0x8006b8(0x1245),'确定要将“'+_0x354652+_0x8006b8(0x5af),{'confirmButtonClass':'btn-danger'});_0x558f9d&&(_0x1bc8dd[_0x8006b8(0xd3e)][_0x8006b8(0x888)](_0x5820c6,0x1),await _0x2c5bcf[_0x8006b8(0x547)][_0x8006b8(0xff5)](_0x1bc8dd),_0x36d6d6(),document[_0x8006b8(0x9c8)](_0x8006b8(0xb86))[_0x8006b8(0xf5c)]());}async function _0x48ec67(){const _0x5575d5=_0x419fa8,_0x24b94a=document[_0x5575d5(0x9c8)]('confirm-contact-picker-btn'),_0x219792=_0x24b94a['cloneNode'](!![]);_0x24b94a[_0x5575d5(0x127d)][_0x5575d5(0x4d7)](_0x219792,_0x24b94a),_0x219792[_0x5575d5(0xa0f)](_0x5575d5(0xf5c),_0x268136),await _0xdf05a1(),_0xe5834e(_0x5575d5(0x9d4));}async function _0xdf05a1(){const _0x72fcf0=_0x419fa8,_0x40e3f5=document[_0x72fcf0(0x9c8)](_0x72fcf0(0x5b0));_0x40e3f5[_0x72fcf0(0x2f5)]='',_0x502f3b[_0x72fcf0(0xdae)]();const _0xc5aaea=_0x9ebf46[_0x72fcf0(0x547)][_0x9ebf46[_0x72fcf0(0x970)]],_0x540ab1=new Set(_0xc5aaea['members'][_0x72fcf0(0xa3b)](_0x4f7ff0=>_0x4f7ff0['id'])),_0x46ff55=Object[_0x72fcf0(0xeb2)](_0x9ebf46[_0x72fcf0(0x547)])['filter'](_0x238006=>!_0x238006[_0x72fcf0(0x11e4)]&&!_0x540ab1[_0x72fcf0(0xd97)](_0x238006['id'])),_0x5ae58e=(await _0x2c5bcf[_0x72fcf0(0x1094)][_0x72fcf0(0x5ff)]())[_0x72fcf0(0x401)](_0x479019=>!_0x540ab1['has'](_0x72fcf0(0x2e7)+_0x479019['id']));_0x46ff55[_0x72fcf0(0xa06)]===0x0&&_0x5ae58e['length']===0x0?(_0x40e3f5['innerHTML']=_0x72fcf0(0xe70),document[_0x72fcf0(0x9c8)](_0x72fcf0(0xa31))[_0x72fcf0(0x5e1)][_0x72fcf0(0x3c5)]=_0x72fcf0(0x8f6)):(document[_0x72fcf0(0x9c8)]('confirm-contact-picker-btn')[_0x72fcf0(0x5e1)][_0x72fcf0(0x3c5)]=_0x72fcf0(0x3d9),_0x46ff55[_0x72fcf0(0x591)](_0x1fc39d=>{const _0x801541=_0x72fcf0,_0x4289ec=document['createElement'](_0x801541(0x11f4));_0x4289ec['className']='contact-picker-item',_0x4289ec[_0x801541(0xc9f)][_0x801541(0xa00)]=_0x1fc39d['id'],_0x4289ec['dataset']['contactType']=_0x801541(0x96c),_0x4289ec[_0x801541(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x1fc39d[_0x801541(0x1131)]['aiAvatar']||_0x246753)+_0x801541(0x291)+_0x1fc39d['name']+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x40e3f5['appendChild'](_0x4289ec);}),_0x5ae58e[_0x72fcf0(0x591)](_0x2dd8c7=>{const _0x469ca0=_0x72fcf0,_0x230e8c=document[_0x469ca0(0x28a)]('div');_0x230e8c['className']=_0x469ca0(0xd75),_0x230e8c[_0x469ca0(0xc9f)][_0x469ca0(0xa00)]=_0x469ca0(0x2e7)+_0x2dd8c7['id'],_0x230e8c[_0x469ca0(0xc9f)][_0x469ca0(0x7e6)]=_0x469ca0(0xc7e),_0x230e8c['dataset'][_0x469ca0(0xc36)]=_0x2dd8c7['id'],_0x230e8c['innerHTML']=_0x469ca0(0x108a)+(_0x2dd8c7['avatar']||_0x337c8f)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x2dd8c7[_0x469ca0(0x609)]+_0x469ca0(0x10c2),_0x40e3f5[_0x469ca0(0x7b9)](_0x230e8c);})),_0x2093b3();}async function _0x268136(){const _0x334a57=_0x419fa8;if(_0x502f3b[_0x334a57(0xa67)]===0x0){alert(_0x334a57(0x713));return;}const _0x2bfede=_0x9ebf46[_0x334a57(0x547)][_0x9ebf46['activeChatId']],_0x13b62c=await _0x2c5bcf[_0x334a57(0x1094)][_0x334a57(0x5ff)]();for(const _0x377d76 of _0x502f3b){const _0x4a931e=document[_0x334a57(0x91d)](_0x334a57(0x6e2)+_0x377d76+'\x22]');if(!_0x4a931e)continue;const _0x381dab=_0x4a931e[_0x334a57(0xc9f)][_0x334a57(0x7e6)];if(_0x381dab===_0x334a57(0x96c)){const _0x2e3a2c=_0x9ebf46['chats'][_0x377d76];_0x2e3a2c&&_0x2bfede[_0x334a57(0xd3e)][_0x334a57(0x668)]({'id':_0x377d76,'originalName':_0x2e3a2c[_0x334a57(0x1071)],'groupNickname':_0x2e3a2c[_0x334a57(0x609)],'persona':_0x2e3a2c['settings'][_0x334a57(0xae3)],'avatar':_0x2e3a2c[_0x334a57(0x1131)][_0x334a57(0xd4d)]||_0x246753,'isNpc':![]});}else{if(_0x381dab===_0x334a57(0xc7e)){const _0x121865=parseInt(_0x4a931e['dataset'][_0x334a57(0xc36)]),_0x2508de=_0x13b62c[_0x334a57(0xfc3)](_0x1138cb=>_0x1138cb['id']===_0x121865);_0x2508de&&_0x2bfede[_0x334a57(0xd3e)][_0x334a57(0x668)]({'id':_0x334a57(0x2e7)+_0x121865,'originalName':_0x2508de['name'],'groupNickname':_0x2508de['name'],'persona':_0x2508de[_0x334a57(0xeb1)],'avatar':_0x2508de[_0x334a57(0x10c9)]||_0x337c8f,'isNpc':!![]});}}}await _0x2c5bcf[_0x334a57(0x547)][_0x334a57(0xff5)](_0x2bfede),_0x36c264();}function _0x9e3607(){_0x2cf21d=!![],_0x2e413a(null);}function _0x58b12b(_0x402226,_0x40a361){const _0x337fda=setInterval(()=>{const _0x3d2698=_0x3569,_0x3c703e=Date[_0x3d2698(0x9b7)](),_0x12484a=_0x40a361-_0x3c703e;if(_0x12484a<0x0){clearInterval(_0x337fda),_0x402226[_0x3d2698(0x2f5)]='<span>已</span><span>超</span><span>时</span>';return;}const _0x449b1d=Math[_0x3d2698(0x5fb)](_0x12484a%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x45bf3b=Math[_0x3d2698(0x5fb)](_0x12484a%(0x3e8*0x3c)/0x3e8),_0xf2dde3=String(_0x449b1d)[_0x3d2698(0x3e8)](0x2,'0'),_0x23672c=String(_0x45bf3b)[_0x3d2698(0x3e8)](0x2,'0');_0x402226[_0x3d2698(0x2f5)]=_0x3d2698(0xe7b)+_0xf2dde3[_0x3d2698(0x87e)](0x0)+'</span><span>'+_0xf2dde3[_0x3d2698(0x87e)](0x1)+_0x3d2698(0xa90)+_0x23672c[_0x3d2698(0x87e)](0x0)+_0x3d2698(0xb2a)+_0x23672c[_0x3d2698(0x87e)](0x1)+_0x3d2698(0x12c8);},0x3e8);return _0x337fda;}function _0x1150e0(){for(const _0x2b2b88 in _0xdea4f7){clearInterval(_0xdea4f7[_0x2b2b88]);}_0xdea4f7={};}async function _0x222a9f(_0x55c806){const _0x7faac4=_0x419fa8,_0x140350=_0x9ebf46[_0x7faac4(0x547)][_0x9ebf46[_0x7faac4(0x970)]];if(!_0x140350)return;const _0x20af38=_0x140350[_0x7faac4(0x8b3)]['find'](_0x4a9505=>_0x4a9505[_0x7faac4(0x6b5)]===_0x55c806);if(!_0x20af38||![_0x7faac4(0x12d4),_0x7faac4(0x1af)][_0x7faac4(0x930)](_0x20af38[_0x7faac4(0x12d9)])){console[_0x7faac4(0x1221)](_0x7faac4(0x603),_0x55c806);return;}let _0x18c5d1='';if(_0x20af38['type']===_0x7faac4(0x12d4)){let _0x44faf4;switch(_0x20af38[_0x7faac4(0xebd)]){case _0x7faac4(0x11b1):const _0x519b86=_0x20af38[_0x7faac4(0xec2)]||'对方',_0x468d8f=_0x227896(_0x140350,_0x519b86);_0x44faf4='由\x20'+_0x468d8f+_0x7faac4(0x984);break;case _0x7faac4(0x954):_0x44faf4=_0x7faac4(0x13a3);break;default:_0x44faf4='等待对方处理';break;}_0x18c5d1=_0x7faac4(0x3e6)+_0x20af38[_0x7faac4(0xde1)]+_0x7faac4(0x225)+Number(_0x20af38['amount'])[_0x7faac4(0x752)](0x2)+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20'+_0x44faf4+_0x7faac4(0x115d);}else{if(_0x20af38[_0x7faac4(0x12d9)]===_0x7faac4(0x1af)){let _0x282937,_0x29135b;_0x140350['isGroup']?(_0x282937=_0x227896(_0x140350,_0x20af38[_0x7faac4(0xac4)]),_0x29135b=_0x227896(_0x140350,_0x20af38[_0x7faac4(0x9d0)])):_0x20af38[_0x7faac4(0x7fd)]===_0x7faac4(0x586)?(_0x282937=_0x140350['settings'][_0x7faac4(0x29c)]||'我',_0x29135b=_0x140350[_0x7faac4(0x609)]):(_0x282937=_0x140350[_0x7faac4(0x609)],_0x29135b=_0x140350[_0x7faac4(0x1131)][_0x7faac4(0x29c)]||'我'),_0x18c5d1=_0x7faac4(0x8fb)+_0x282937+_0x7faac4(0xe7e)+_0x29135b+_0x7faac4(0x45f)+_0x20af38[_0x7faac4(0xde1)]+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥'+Number(_0x20af38[_0x7faac4(0x212)])[_0x7faac4(0x752)](0x2)+_0x7faac4(0x115d);}}await _0x1bff53(_0x7faac4(0x68b),_0x18c5d1);}async function _0x31b0bf(_0x4946c8,_0x12b278){const _0x39dc1d=_0x419fa8,_0x5bac16=_0x9ebf46['chats'][_0x9ebf46['activeChatId']];if(!_0x5bac16)return;const _0x305ed1=_0x5bac16['history'][_0x39dc1d(0x684)](_0x40406b=>_0x40406b[_0x39dc1d(0x6b5)]===_0x4946c8);if(_0x305ed1===-0x1)return;const _0x25b9a9=_0x5bac16['history'][_0x305ed1];_0x25b9a9[_0x39dc1d(0xebd)]=_0x12b278;let _0x2b20d4;const _0x4f0496=_0x5bac16[_0x39dc1d(0x11e4)]?_0x5bac16[_0x39dc1d(0x1131)][_0x39dc1d(0x29c)]||'我':'我';_0x12b278===_0x39dc1d(0x11b1)?(_0x25b9a9['paidBy']=_0x4f0496,_0x2b20d4='[系统提示：你\x20('+_0x4f0496+_0x39dc1d(0x932)+_0x25b9a9[_0x39dc1d(0xac4)]+_0x39dc1d(0x3a7)+_0x4946c8+_0x39dc1d(0x4a4)):_0x2b20d4=_0x39dc1d(0x1059)+_0x4f0496+')\x20拒绝了\x20'+_0x25b9a9[_0x39dc1d(0xac4)]+_0x39dc1d(0x458)+_0x4946c8+_0x39dc1d(0xf34);const _0x233eb8={'role':_0x39dc1d(0xb64),'content':_0x2b20d4,'timestamp':Date[_0x39dc1d(0x9b7)](),'isHidden':!![]};_0x5bac16[_0x39dc1d(0x8b3)]['push'](_0x233eb8),await _0x2c5bcf[_0x39dc1d(0x547)][_0x39dc1d(0xff5)](_0x5bac16),_0x1a44b1(_0x9ebf46['activeChatId']);}let _0x3085d5={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x30db8=null;async function _0x3c2c6d(){const _0x1213ed=_0x419fa8;if(!_0x9ebf46[_0x1213ed(0x970)]||_0x3085d5[_0x1213ed(0x103f)]||_0x3085d5[_0x1213ed(0x683)])return;const _0x1f9211=_0x9ebf46['chats'][_0x9ebf46[_0x1213ed(0x970)]];_0x3085d5[_0x1213ed(0x106c)]=_0x1f9211['isGroup'],_0x3085d5['isAwaitingResponse']=!![],_0x3085d5[_0x1213ed(0x6b9)]='user',_0x3085d5[_0x1213ed(0x970)]=_0x1f9211['id'],_0x3085d5['isUserParticipating']=!![];_0x1f9211[_0x1213ed(0x11e4)]?(document['getElementById'](_0x1213ed(0xcc5))['src']=_0x1f9211[_0x1213ed(0x1131)][_0x1213ed(0xb60)]||_0x1d990b,document[_0x1213ed(0x9c8)](_0x1213ed(0x902))[_0x1213ed(0xe24)]=_0x1f9211['settings'][_0x1213ed(0x29c)]||'我'):(document[_0x1213ed(0x9c8)]('outgoing-call-avatar')[_0x1213ed(0xbf4)]=_0x1f9211[_0x1213ed(0x1131)][_0x1213ed(0xd4d)]||_0x246753,document[_0x1213ed(0x9c8)](_0x1213ed(0x902))[_0x1213ed(0xe24)]=_0x1f9211[_0x1213ed(0x609)]);document[_0x1213ed(0x91d)](_0x1213ed(0x24b))['textContent']=_0x1f9211[_0x1213ed(0x11e4)]?'正在呼叫所有成员...':_0x1213ed(0x751),_0xe5834e('outgoing-call-screen');const _0x3cddf0={'role':'system','content':_0x1f9211['isGroup']?_0x1213ed(0xc77)+(_0x1f9211['settings']['myNickname']||'我')+_0x1213ed(0x1152):_0x1213ed(0xc92),'timestamp':Date[_0x1213ed(0x9b7)](),'isHidden':!![]};_0x1f9211[_0x1213ed(0x8b3)][_0x1213ed(0x668)](_0x3cddf0),await _0x2c5bcf[_0x1213ed(0x547)]['put'](_0x1f9211),await _0x4128b4();}function _0x5ab059(){const _0x39c7be=_0x419fa8,_0x366a62=_0x9ebf46[_0x39c7be(0x547)][_0x3085d5[_0x39c7be(0x970)]];if(!_0x366a62)return;_0x3085d5[_0x39c7be(0x103f)]=!![],_0x3085d5[_0x39c7be(0x683)]=![],_0x3085d5[_0x39c7be(0xca7)]=Date[_0x39c7be(0x9b7)](),_0x3085d5[_0x39c7be(0xe55)]=[];const _0x421e5e=_0x366a62[_0x39c7be(0x8b3)][_0x39c7be(0x1044)](-0xa);_0x3085d5['preCallContext']=_0x421e5e[_0x39c7be(0xa3b)](_0x49d8d7=>{const _0x1bb458=_0x39c7be,_0x44211d=_0x49d8d7[_0x1bb458(0x7fd)]===_0x1bb458(0x586)?_0x366a62['settings']['myNickname']||'我':_0x49d8d7[_0x1bb458(0xac4)]||_0x366a62[_0x1bb458(0x609)];return _0x44211d+':\x20'+String(_0x49d8d7[_0x1bb458(0x53b)])[_0x1bb458(0xc34)](0x0,0x32)+'...';})[_0x39c7be(0x809)]('\x0a'),_0x44b80c(),document['getElementById'](_0x39c7be(0x8e9))['innerHTML']=_0x39c7be(0x48c)+(_0x3085d5[_0x39c7be(0x106c)]?_0x39c7be(0x58e):'正在接通...')+_0x39c7be(0x12c6),_0xe5834e(_0x39c7be(0x7d9)),document[_0x39c7be(0x9c8)](_0x39c7be(0x183))['style'][_0x39c7be(0x3c5)]=_0x3085d5[_0x39c7be(0x110b)]?'block':'none',document[_0x39c7be(0x9c8)](_0x39c7be(0x1174))[_0x39c7be(0x5e1)][_0x39c7be(0x3c5)]=_0x3085d5[_0x39c7be(0x110b)]?'none':_0x39c7be(0x3d9);if(_0x30db8)clearInterval(_0x30db8);_0x30db8=setInterval(_0x5078c0,0x3e8),_0x5078c0(),_0x14270d();}async function _0xcd5c45(){const _0x3945a3=_0x419fa8;if(!_0x3085d5['isActive'])return;const _0x3a80bc=Math[_0x3945a3(0x5fb)]((Date['now']()-_0x3085d5[_0x3945a3(0xca7)])/0x3e8),_0x5110b2=Math[_0x3945a3(0x5fb)](_0x3a80bc/0x3c)+'分'+_0x3a80bc%0x3c+'秒',_0x56844a=_0x3945a3(0x84d)+_0x5110b2,_0x3e3b8c=_0x9ebf46[_0x3945a3(0x547)][_0x3085d5[_0x3945a3(0x970)]];if(_0x3e3b8c){const _0x100f7b=[];_0x3085d5[_0x3945a3(0x106c)]?(_0x3085d5[_0x3945a3(0x1189)]['forEach'](_0x35f0d5=>_0x100f7b['push']({'name':_0x35f0d5[_0x3945a3(0x1071)],'avatar':_0x35f0d5[_0x3945a3(0x10c9)]})),_0x3085d5[_0x3945a3(0x110b)]&&_0x100f7b[_0x3945a3(0x1c7)]({'name':_0x3e3b8c[_0x3945a3(0x1131)][_0x3945a3(0x29c)]||'我','avatar':_0x3e3b8c[_0x3945a3(0x1131)][_0x3945a3(0xb60)]||_0x1d990b})):(_0x100f7b[_0x3945a3(0x668)]({'name':_0x3e3b8c['name'],'avatar':_0x3e3b8c['settings'][_0x3945a3(0xd4d)]||_0x246753}),_0x100f7b[_0x3945a3(0x1c7)]({'name':'我','avatar':_0x3e3b8c[_0x3945a3(0x1131)][_0x3945a3(0xb60)]||_0x246753}));const _0x148de1={'chatId':_0x3085d5['activeChatId'],'timestamp':Date[_0x3945a3(0x9b7)](),'duration':_0x3a80bc,'participants':_0x100f7b,'transcript':[..._0x3085d5[_0x3945a3(0xe55)]]};await _0x2c5bcf[_0x3945a3(0x852)][_0x3945a3(0x68e)](_0x148de1),console[_0x3945a3(0x283)](_0x3945a3(0x7eb),_0x148de1);let _0xacfbb5={'role':_0x3085d5[_0x3945a3(0x6b9)]==='user'?_0x3945a3(0x586):'assistant','content':_0x56844a,'timestamp':Date['now']()};_0x3e3b8c[_0x3945a3(0x11e4)]&&_0xacfbb5['role']==='assistant'&&(_0xacfbb5[_0x3945a3(0xac4)]=_0x3085d5[_0x3945a3(0x1183)]||_0x3e3b8c[_0x3945a3(0xd3e)][0x0]?.[_0x3945a3(0x1071)]||_0x3e3b8c['name']);_0x3e3b8c[_0x3945a3(0x8b3)][_0x3945a3(0x668)](_0xacfbb5);const _0x1b70e5=_0x3085d5[_0x3945a3(0xe55)]['map'](_0x261465=>{const _0x464c8a=_0x3945a3,_0x41286f=_0x261465[_0x464c8a(0x7fd)]===_0x464c8a(0x586)?_0x3e3b8c[_0x464c8a(0x1131)][_0x464c8a(0x29c)]||'我':_0x261465[_0x464c8a(0xac4)];return _0x41286f+':\x20'+_0x261465['content'];})[_0x3945a3(0x809)]('\x0a');_0x378e3f(_0x3e3b8c['id'],_0x1b70e5);const _0x2023a8={'role':_0x3945a3(0xb64),'content':_0x3945a3(0x976),'timestamp':Date[_0x3945a3(0x9b7)]()+0x1,'isHidden':!![]};_0x3e3b8c[_0x3945a3(0x8b3)][_0x3945a3(0x668)](_0x2023a8),await _0x2c5bcf['chats'][_0x3945a3(0xff5)](_0x3e3b8c);}clearInterval(_0x30db8),_0x30db8=null,_0x3085d5={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x3e3b8c&&(_0x49f56e(_0x3e3b8c['id']),_0x4128b4());}function _0x44b80c(){const _0x353201=_0x419fa8,_0x10e54f=document[_0x353201(0x9c8)](_0x353201(0x139f));_0x10e54f[_0x353201(0x2f5)]='';const _0x13eb05=_0x9ebf46[_0x353201(0x547)][_0x3085d5['activeChatId']];if(!_0x13eb05)return;let _0x1cb3a5=[];_0x3085d5[_0x353201(0x106c)]?(_0x1cb3a5=[..._0x3085d5['participants']],_0x3085d5[_0x353201(0x110b)]&&_0x1cb3a5[_0x353201(0x1c7)]({'id':_0x353201(0x586),'name':_0x13eb05[_0x353201(0x1131)][_0x353201(0x29c)]||'我','avatar':_0x13eb05['settings'][_0x353201(0xb60)]||_0x1d990b})):_0x1cb3a5['push']({'id':'ai','name':_0x13eb05[_0x353201(0x609)],'avatar':_0x13eb05['settings']['aiAvatar']||_0x246753}),_0x1cb3a5[_0x353201(0x591)](_0x24a83b=>{const _0x5b9a01=_0x353201,_0x57a181=document['createElement']('div');_0x57a181[_0x5b9a01(0x82c)]=_0x5b9a01(0x26c),_0x57a181['dataset'][_0x5b9a01(0x5a4)]=_0x24a83b['id'];const _0x51ed2d=_0x24a83b['groupNickname']||_0x24a83b['name'];_0x57a181[_0x5b9a01(0x2f5)]=_0x5b9a01(0xc78)+_0x24a83b[_0x5b9a01(0x10c9)]+'\x22\x20class=\x22participant-avatar\x22\x20alt=\x22'+_0x51ed2d+_0x5b9a01(0x1197)+_0x51ed2d+_0x5b9a01(0xa43),_0x10e54f[_0x5b9a01(0x7b9)](_0x57a181);});}function _0x4a7f0b(){const _0xa17563=_0x419fa8;if(!_0x3085d5[_0xa17563(0x103f)]||_0x3085d5[_0xa17563(0x110b)])return;_0x3085d5[_0xa17563(0x110b)]=!![],_0x44b80c(),document['getElementById'](_0xa17563(0x183))[_0xa17563(0x5e1)][_0xa17563(0x3c5)]=_0xa17563(0x3d9),document[_0xa17563(0x9c8)](_0xa17563(0x1174))[_0xa17563(0x5e1)][_0xa17563(0x3c5)]='none',_0x14270d(_0xa17563(0xc9b));}function _0x5078c0(){const _0x19eb3b=_0x419fa8;if(!_0x3085d5[_0x19eb3b(0x103f)])return;const _0x58291d=Math[_0x19eb3b(0x5fb)]((Date['now']()-_0x3085d5[_0x19eb3b(0xca7)])/0x3e8),_0x48014b=Math[_0x19eb3b(0x5fb)](_0x58291d/0x3c),_0x2ecebc=_0x58291d%0x3c;document[_0x19eb3b(0x9c8)](_0x19eb3b(0x28b))['textContent']=String(_0x48014b)[_0x19eb3b(0x3e8)](0x2,'0')+':'+String(_0x2ecebc)[_0x19eb3b(0x3e8)](0x2,'0');}function _0x2762f6(){const _0xdb5b0f=_0x419fa8,_0x51c582=_0x9ebf46[_0xdb5b0f(0x547)][_0x9ebf46[_0xdb5b0f(0x970)]];if(!_0x51c582)return;if(_0x51c582[_0xdb5b0f(0x11e4)]){const _0x2d5352=_0x3085d5[_0xdb5b0f(0x1183)]||_0x51c582['members'][0x0]?.[_0xdb5b0f(0x609)]||_0xdb5b0f(0x1086);document[_0xdb5b0f(0x9c8)](_0xdb5b0f(0xab9))['src']=_0x51c582[_0xdb5b0f(0x1131)][_0xdb5b0f(0xa79)]||_0x5d7a94,document['getElementById']('caller-name')[_0xdb5b0f(0xe24)]=_0x51c582[_0xdb5b0f(0x609)],document[_0xdb5b0f(0x91d)]('.incoming-call-content\x20.caller-text')[_0xdb5b0f(0xe24)]=_0x2d5352+'\x20邀请你加入群视频';}else document[_0xdb5b0f(0x9c8)](_0xdb5b0f(0xab9))[_0xdb5b0f(0xbf4)]=_0x51c582[_0xdb5b0f(0x1131)][_0xdb5b0f(0xd4d)]||_0x246753,document[_0xdb5b0f(0x9c8)](_0xdb5b0f(0x1076))[_0xdb5b0f(0xe24)]=_0x51c582['name'],document['querySelector'](_0xdb5b0f(0x2a1))[_0xdb5b0f(0xe24)]='邀请你视频通话';document['getElementById'](_0xdb5b0f(0x871))[_0xdb5b0f(0x575)][_0xdb5b0f(0x68e)](_0xdb5b0f(0xc3f));}function _0x2bc8f7(){const _0x581180=_0x419fa8;document[_0x581180(0x9c8)](_0x581180(0x871))['classList'][_0x581180(0x30f)]('visible');}async function _0x14270d(_0x17d1f9=null){const _0xcd580f=_0x419fa8;if(!_0x3085d5[_0xcd580f(0x103f)])return;const _0x2245e0=_0x9ebf46[_0xcd580f(0x547)][_0x3085d5['activeChatId']],{proxyUrl:_0x57189c,apiKey:_0x2c2af8,model:_0x213f9b}=_0x9ebf46[_0xcd580f(0x4de)],_0x438fd3=document[_0xcd580f(0x9c8)](_0xcd580f(0x8e9)),_0x3f736e=_0x2245e0[_0xcd580f(0x1131)][_0xcd580f(0x29c)]||'我';let _0x5c8459='';if(_0x2245e0[_0xcd580f(0x1131)]['linkedWorldBookIds']&&_0x2245e0[_0xcd580f(0x1131)][_0xcd580f(0x41a)][_0xcd580f(0xa06)]>0x0){const _0x1604ff=_0x2245e0[_0xcd580f(0x1131)][_0xcd580f(0x41a)]['map'](_0x3cbc14=>{const _0x575fdf=_0xcd580f,_0x3685a6=_0x9ebf46[_0x575fdf(0x1369)]['find'](_0x350459=>_0x350459['id']===_0x3cbc14);return _0x3685a6&&_0x3685a6['content']?_0x575fdf(0xbac)+_0x3685a6[_0x575fdf(0x609)]+'\x0a'+_0x3685a6[_0x575fdf(0x53b)]:'';})[_0xcd580f(0x401)](Boolean)[_0xcd580f(0x809)]('');_0x1604ff&&(_0x5c8459=_0xcd580f(0xb13)+_0x1604ff+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}if(_0x17d1f9&&_0x3085d5['isUserParticipating']){const _0xc8b10a=Date[_0xcd580f(0x9b7)](),_0x471a10=document[_0xcd580f(0x28a)](_0xcd580f(0x11f4));_0x471a10[_0xcd580f(0x82c)]='call-message-bubble\x20user-speech',_0x471a10[_0xcd580f(0xe24)]=_0x17d1f9,_0x471a10[_0xcd580f(0xc9f)][_0xcd580f(0x6b5)]=_0xc8b10a,_0x43a60a(_0x471a10,()=>_0x19a70e(_0xc8b10a)),_0x438fd3[_0xcd580f(0x7b9)](_0x471a10),_0x438fd3[_0xcd580f(0x783)]=_0x438fd3['scrollHeight'],_0x3085d5[_0xcd580f(0xe55)][_0xcd580f(0x668)]({'role':_0xcd580f(0x586),'content':_0x17d1f9,'timestamp':_0xc8b10a});}let _0x55716f;if(_0x3085d5[_0xcd580f(0x106c)]){const _0x3a194d=_0x3085d5[_0xcd580f(0x1189)][_0xcd580f(0xa3b)](_0x51c701=>_0x51c701[_0xcd580f(0x609)]);_0x3085d5['isUserParticipating']&&_0x3a194d[_0xcd580f(0x1c7)](_0x3f736e),_0x55716f=_0xcd580f(0xe14)+_0x3f736e+_0xcd580f(0xc86)+_0x3f736e+'\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3085d5[_0xcd580f(0xd0e)]+_0xcd580f(0xdc3)+_0x3a194d[_0xcd580f(0x809)]('、\x20')+'。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5c8459+_0xcd580f(0x1282);}else{let _0x47a36c=_0x3085d5[_0xcd580f(0x6b9)]===_0xcd580f(0x586)?'你刚刚接听了用户的视频通话请求。':_0xcd580f(0xce0);_0x55716f=_0xcd580f(0x11f3)+_0x2245e0['name']+'\x20('+_0x2245e0['settings'][_0xcd580f(0xae3)]+_0xcd580f(0xa91)+_0x2245e0[_0xcd580f(0x609)]+_0xcd580f(0x5b9)+_0x3f736e+'，人设:\x20'+_0x2245e0[_0xcd580f(0x1131)][_0xcd580f(0x1151)]+_0xcd580f(0xd44)+_0x47a36c+_0xcd580f(0x111d)+_0x3085d5[_0xcd580f(0xd0e)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}const _0x46d367=[{'role':_0xcd580f(0xb64),'content':_0x55716f},..._0x3085d5[_0xcd580f(0xe55)]['map'](_0x571497=>({'role':_0x571497[_0xcd580f(0x7fd)],'content':_0x571497['content']}))];if(_0x3085d5[_0xcd580f(0xe55)][_0xcd580f(0xa06)]===0x0){const _0xf6975c=_0x3085d5[_0xcd580f(0x6b9)]==='user'?_0xcd580f(0x209):_0xcd580f(0x74b);_0x46d367[_0xcd580f(0x668)]({'role':_0xcd580f(0x586),'content':_0xf6975c});}try{let _0x1ef47c=_0x57189c===GEMINI_API_URL,_0x19c303=_0x2e5c04(_0x213f9b,_0x2c2af8,_0x55716f,_0x46d367);const _0x164f46=_0x1ef47c?await fetch(_0x19c303['url'],_0x19c303[_0xcd580f(0x100d)]):await fetch(_0x57189c+_0xcd580f(0x1090),{'method':_0xcd580f(0x116f),'headers':{'Content-Type':_0xcd580f(0x698),'Authorization':'Bearer\x20'+_0x2c2af8},'body':JSON[_0xcd580f(0xf1e)]({'model':_0x213f9b,'messages':_0x46d367,'temperature':_0x9ebf46[_0xcd580f(0x1383)][_0xcd580f(0xc3d)]||0.8})});if(!_0x164f46['ok'])throw new Error((await _0x164f46[_0xcd580f(0x5dd)]())[_0xcd580f(0x1221)][_0xcd580f(0x86e)]);const _0x229081=await _0x164f46['json'](),_0x19073b=_0x1ef47c?_0x229081[_0xcd580f(0xbd6)][0x0][_0xcd580f(0x53b)]['parts'][0x0][_0xcd580f(0xbb7)]:_0x229081['choices'][0x0][_0xcd580f(0x86e)][_0xcd580f(0x53b)],_0x4e17c5=_0x438fd3[_0xcd580f(0x91d)]('em');if(_0x4e17c5)_0x4e17c5[_0xcd580f(0x30f)]();if(_0x3085d5['isGroupCall']){const _0x4d4fbe=_0x169d92(_0x19073b);_0x4d4fbe['forEach'](_0x41cc8e=>{const _0x2d2a02=_0xcd580f;if(!_0x41cc8e[_0x2d2a02(0x609)]||_0x41cc8e['name']===_0x3f736e||!_0x41cc8e[_0x2d2a02(0x122c)])return;const _0xaaefe4=Date[_0x2d2a02(0x9b7)]()+Math[_0x2d2a02(0x360)](),_0x5ab91c=document[_0x2d2a02(0x28a)](_0x2d2a02(0x11f4));_0x5ab91c[_0x2d2a02(0x82c)]=_0x2d2a02(0xc6a),_0x5ab91c[_0x2d2a02(0x2f5)]=_0x2d2a02(0xa66)+_0x41cc8e[_0x2d2a02(0x609)]+_0x2d2a02(0x106e)+_0x41cc8e['speech'],_0x5ab91c[_0x2d2a02(0xc9f)][_0x2d2a02(0x6b5)]=_0xaaefe4,_0x43a60a(_0x5ab91c,()=>_0x19a70e(_0xaaefe4)),_0x438fd3[_0x2d2a02(0x7b9)](_0x5ab91c),_0x3085d5[_0x2d2a02(0xe55)][_0x2d2a02(0x668)]({'role':'assistant','content':_0x41cc8e['name']+':\x20'+_0x41cc8e[_0x2d2a02(0x122c)],'timestamp':_0xaaefe4});const _0x2073a0=_0x3085d5[_0x2d2a02(0x1189)][_0x2d2a02(0xfc3)](_0x1bd4eb=>_0x1bd4eb[_0x2d2a02(0x609)]===_0x41cc8e[_0x2d2a02(0x609)]);if(_0x2073a0){const _0x58920e=document[_0x2d2a02(0x91d)](_0x2d2a02(0x1d5)+_0x2073a0['id']+_0x2d2a02(0x1a1));_0x58920e&&(_0x58920e['classList']['add']('speaking'),setTimeout(()=>_0x58920e['classList'][_0x2d2a02(0x30f)](_0x2d2a02(0x39c)),0x7d0));}});}else{const _0x501fed=Date['now'](),_0x11af1e=document[_0xcd580f(0x28a)](_0xcd580f(0x11f4));_0x11af1e[_0xcd580f(0x82c)]=_0xcd580f(0xc6a),_0x11af1e[_0xcd580f(0xe24)]=_0x19073b,_0x11af1e['dataset'][_0xcd580f(0x6b5)]=_0x501fed,_0x43a60a(_0x11af1e,()=>_0x19a70e(_0x501fed)),_0x438fd3[_0xcd580f(0x7b9)](_0x11af1e),_0x3085d5[_0xcd580f(0xe55)]['push']({'role':'assistant','content':_0x19073b,'timestamp':_0x501fed});const _0x2f9c70=document['querySelector']('.participant-avatar-wrapper\x20.participant-avatar');_0x2f9c70&&(_0x2f9c70[_0xcd580f(0x575)][_0xcd580f(0x68e)](_0xcd580f(0x39c)),setTimeout(()=>_0x2f9c70[_0xcd580f(0x575)]['remove'](_0xcd580f(0x39c)),0x7d0));}_0x438fd3[_0xcd580f(0x783)]=_0x438fd3[_0xcd580f(0x1e4)];}catch(_0x35b6d2){const _0x11743b=document[_0xcd580f(0x28a)]('div');_0x11743b[_0xcd580f(0x82c)]='call-message-bubble\x20ai-speech',_0x11743b[_0xcd580f(0x5e1)]['color']=_0xcd580f(0xf4d),_0x11743b['textContent']=_0xcd580f(0xbc0)+_0x35b6d2[_0xcd580f(0x86e)]+']',_0x438fd3[_0xcd580f(0x7b9)](_0x11743b),_0x438fd3[_0xcd580f(0x783)]=_0x438fd3[_0xcd580f(0x1e4)],_0x3085d5[_0xcd580f(0xe55)]['push']({'role':'assistant','content':_0xcd580f(0xbc0)+_0x35b6d2[_0xcd580f(0x86e)]+']'});}}function _0x6554ae(_0x473268){const _0x13462f=_0x419fa8;document['getElementById'](_0x13462f(0xfb4))[_0x13462f(0x5e1)][_0x13462f(0x3c5)]=_0x473268?_0x13462f(0x8f6):_0x13462f(0x989),document[_0x13462f(0x9c8)](_0x13462f(0xeb8))[_0x13462f(0x5e1)][_0x13462f(0x3c5)]=_0x473268?'flex':'none';}async function _0x31b0bf(_0x388354,_0x4008f3){const _0x2ba8a4=_0x419fa8,_0x3890ce=_0x9ebf46[_0x2ba8a4(0x547)][_0x9ebf46[_0x2ba8a4(0x970)]];if(!_0x3890ce)return;const _0x1133aa=_0x3890ce[_0x2ba8a4(0x8b3)][_0x2ba8a4(0x684)](_0x3ad37e=>_0x3ad37e[_0x2ba8a4(0x6b5)]===_0x388354);if(_0x1133aa===-0x1)return;const _0x458cda=_0x3890ce[_0x2ba8a4(0x8b3)][_0x1133aa];_0x458cda[_0x2ba8a4(0xebd)]=_0x4008f3;let _0x5d49d0;const _0x1346bb=_0x3890ce[_0x2ba8a4(0x11e4)]?_0x3890ce['settings'][_0x2ba8a4(0x29c)]||'我':'我';_0x4008f3==='paid'?(_0x458cda[_0x2ba8a4(0xec2)]=_0x1346bb,_0x5d49d0='[系统提示：你\x20('+_0x1346bb+_0x2ba8a4(0x932)+_0x458cda[_0x2ba8a4(0xac4)]+_0x2ba8a4(0x3a7)+_0x388354+'）完成了支付。此订单已关闭，其他成员不能再支付。]'):_0x5d49d0=_0x2ba8a4(0x1059)+_0x1346bb+_0x2ba8a4(0x130a)+_0x458cda[_0x2ba8a4(0xac4)]+_0x2ba8a4(0x458)+_0x388354+'）。]';const _0x3acd6a={'role':_0x2ba8a4(0xb64),'content':_0x5d49d0,'timestamp':Date['now'](),'isHidden':!![]};_0x3890ce[_0x2ba8a4(0x8b3)][_0x2ba8a4(0x668)](_0x3acd6a),await _0x2c5bcf[_0x2ba8a4(0x547)][_0x2ba8a4(0xff5)](_0x3890ce),_0x1a44b1(_0x9ebf46[_0x2ba8a4(0x970)]),_0x4008f3===_0x2ba8a4(0x11b1)&&_0x4128b4();}async function _0x969182(_0x5c51b5,_0x26021f){const _0x22150c=_0x419fa8,_0x4e0a1e=_0x9ebf46[_0x22150c(0x547)][_0x5c51b5];if(!_0x4e0a1e)return;let _0x5c53af;_0x4e0a1e[_0x22150c(0x11e4)]?_0x5c53af=_0x227896(_0x4e0a1e,_0x26021f):_0x5c53af=_0x4e0a1e[_0x22150c(0x609)];const _0x48d943=document['getElementById'](_0x22150c(0x6fb));_0x48d943[_0x22150c(0x575)][_0x22150c(0x30f)]('pat-animation'),void _0x48d943[_0x22150c(0x138e)],_0x48d943[_0x22150c(0x575)][_0x22150c(0x68e)](_0x22150c(0x85b));const _0x24443e=await _0xadb5df(_0x22150c(0xd11)+_0x5c53af+'”',_0x22150c(0x1d6),'','text');if(_0x24443e===null)return;const _0x4fcb6a=_0x227896(_0x4e0a1e,_0x9ebf46['qzoneSettings']['nickname']),_0x213cbb=_0x4fcb6a+_0x22150c(0xafe)+_0x5c53af+'”\x20'+_0x24443e[_0x22150c(0x3f1)](),_0x2f6dc5={'role':_0x22150c(0xb64),'type':'pat_message','content':_0x213cbb,'timestamp':Date[_0x22150c(0x9b7)]()};_0x4e0a1e[_0x22150c(0x8b3)][_0x22150c(0x668)](_0x2f6dc5);const _0x43bfae='[系统提示：用户（'+_0x4fcb6a+_0x22150c(0x1029)+_0x26021f+'）'+_0x24443e[_0x22150c(0x3f1)]()+'。请你对此作出回应。]',_0x3d153b={'role':_0x22150c(0xb64),'content':_0x43bfae,'timestamp':Date[_0x22150c(0x9b7)]()+0x1,'isHidden':!![]};_0x4e0a1e[_0x22150c(0x8b3)][_0x22150c(0x668)](_0x3d153b),await _0x2c5bcf['chats'][_0x22150c(0xff5)](_0x4e0a1e),_0x9ebf46[_0x22150c(0x970)]===_0x5c51b5&&_0xc4e879(_0x2f6dc5,_0x4e0a1e),await _0x394b2c();}let _0x5bb668=null,_0x4d9412=![],_0x136906=new Set();function _0x19a70e(_0x256bc1){const _0x4a388c=_0x419fa8;_0x5bb668=_0x256bc1,document[_0x4a388c(0x9c8)](_0x4a388c(0x242))['classList'][_0x4a388c(0x68e)](_0x4a388c(0xc3f));}function _0x5aeb4a(){const _0x93bf98=_0x419fa8;document[_0x93bf98(0x9c8)](_0x93bf98(0x242))[_0x93bf98(0x575)][_0x93bf98(0x30f)]('visible'),_0x5bb668=null;}async function _0x2f9550(){const _0x1927ff=_0x419fa8;if(!_0x5bb668)return;const _0x451e7=_0x5bb668,_0x2b707f=_0x3085d5[_0x1927ff(0xe55)][_0x1927ff(0xfc3)](_0x3e3c38=>_0x3e3c38['timestamp']===_0x451e7);if(!_0x2b707f)return;_0x5aeb4a();let _0xa7acdb=_0x2b707f[_0x1927ff(0x53b)];if(_0x3085d5[_0x1927ff(0x106c)]&&_0x2b707f[_0x1927ff(0x7fd)]===_0x1927ff(0x1a7)){const _0x5a75bc=_0x2b707f[_0x1927ff(0x53b)][_0x1927ff(0x6c6)](':\x20');_0x5a75bc[_0x1927ff(0xa06)]>0x1&&(_0xa7acdb=_0x5a75bc[_0x1927ff(0x1044)](0x1)[_0x1927ff(0x809)](':\x20'));}const _0x1b105a=await _0xadb5df(_0x1927ff(0x383),'在此修改内容...',_0xa7acdb,_0x1927ff(0x11f9));_0x1b105a!==null&&await _0x1e39f0(_0x451e7,_0x1b105a);}async function _0x1e39f0(_0x6bd713,_0x493654){const _0x170f6f=_0x419fa8,_0x3e5460=_0x3085d5[_0x170f6f(0xe55)][_0x170f6f(0xfc3)](_0x3758e3=>_0x3758e3[_0x170f6f(0x6b5)]===_0x6bd713);if(_0x3e5460){let _0x808ef9=_0x493654;if(_0x3085d5[_0x170f6f(0x106c)]&&_0x3e5460[_0x170f6f(0x7fd)]===_0x170f6f(0x1a7)){const _0x349f84=_0x3e5460[_0x170f6f(0x53b)][_0x170f6f(0x6c6)](':\x20'),_0x40f45e=_0x349f84[0x0];_0x808ef9=_0x40f45e+':\x20'+_0x493654;}_0x3e5460[_0x170f6f(0x53b)]=_0x808ef9;const _0x2b62c6=document[_0x170f6f(0x91d)]('.call-message-bubble[data-timestamp=\x22'+_0x6bd713+'\x22]');if(_0x2b62c6){if(_0x3085d5['isGroupCall']&&_0x3e5460['role']===_0x170f6f(0x1a7)){const _0x14481a=_0x3e5460['content'][_0x170f6f(0x6c6)](':\x20'),_0x3bf195=_0x14481a[0x0];_0x2b62c6[_0x170f6f(0x2f5)]=_0x170f6f(0xa66)+_0x3bf195+_0x170f6f(0x106e)+_0x493654;}else _0x2b62c6[_0x170f6f(0xe24)]=_0x493654;}}await _0x1bff53('成功',_0x170f6f(0xfe5));}async function _0x5e4cf2(){const _0x5321ba=_0x419fa8;if(!_0x5bb668)return;const _0x342550=await _0x352ae9(_0x5321ba(0x6e1),_0x5321ba(0x43c),{'confirmButtonClass':_0x5321ba(0x12bc)});if(_0x342550){const _0xffc069=_0x5bb668;_0x5aeb4a();const _0xf760f=_0x3085d5['callHistory'][_0x5321ba(0x684)](_0x1f2a90=>_0x1f2a90['timestamp']===_0xffc069);_0xf760f>-0x1&&_0x3085d5[_0x5321ba(0xe55)]['splice'](_0xf760f,0x1);const _0x3c731a=document[_0x5321ba(0x91d)](_0x5321ba(0x428)+_0xffc069+'\x22]');_0x3c731a&&_0x3c731a[_0x5321ba(0x30f)]();}else _0x5aeb4a();}function _0x5720c7(_0x303114){const _0x3707e7=_0x419fa8;_0x2bfce7=_0x303114;const _0xe8345e=_0x9ebf46[_0x3707e7(0x547)][_0x9ebf46[_0x3707e7(0x970)]],_0x9e0657=_0xe8345e[_0x3707e7(0x8b3)][_0x3707e7(0xfc3)](_0xcb7f56=>_0xcb7f56[_0x3707e7(0x6b5)]===_0x303114);_0x9e0657&&(document[_0x3707e7(0x9c8)](_0x3707e7(0x7f4))['textContent']=_0x9e0657['senderName']),document[_0x3707e7(0x9c8)](_0x3707e7(0x2e0))[_0x3707e7(0x575)][_0x3707e7(0x68e)]('visible');}function _0x288aec(){const _0x1d34ed=_0x419fa8;document[_0x1d34ed(0x9c8)](_0x1d34ed(0x2e0))[_0x1d34ed(0x575)][_0x1d34ed(0x30f)](_0x1d34ed(0xc3f)),_0x2bfce7=null;}async function _0x39b40c(_0x35bf3e){const _0x1bab3e=_0x419fa8;if(!_0x2bfce7)return;const _0x1a6b0b=_0x2bfce7,_0x9f3060=_0x9ebf46['chats'][_0x9ebf46['activeChatId']],_0x5e954b=_0x9f3060[_0x1bab3e(0x8b3)][_0x1bab3e(0x684)](_0x585e9b=>_0x585e9b[_0x1bab3e(0x6b5)]===_0x1a6b0b);if(_0x5e954b===-0x1)return;const _0x4154d7=_0x9f3060[_0x1bab3e(0x8b3)][_0x5e954b];_0x4154d7[_0x1bab3e(0xebd)]=_0x35bf3e;let _0x4a350f;if(_0x35bf3e===_0x1bab3e(0x859)){const _0x5600c2={'role':_0x1bab3e(0x586),'type':_0x1bab3e(0x975),'isRefund':!![],'amount':_0x4154d7[_0x1bab3e(0x212)],'note':_0x1bab3e(0x135d),'timestamp':Date[_0x1bab3e(0x9b7)]()};_0x9f3060[_0x1bab3e(0x8b3)][_0x1bab3e(0x668)](_0x5600c2),_0x4a350f=_0x1bab3e(0x107c)+_0x4154d7[_0x1bab3e(0xac4)]+'”的转账。]';}else _0x4a350f=_0x1bab3e(0xdce)+_0x4154d7[_0x1bab3e(0xac4)]+'”的转账。]';const _0x7bbd70={'role':_0x1bab3e(0xb64),'content':_0x4a350f,'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x9f3060[_0x1bab3e(0x8b3)][_0x1bab3e(0x668)](_0x7bbd70),await _0x2c5bcf[_0x1bab3e(0x547)][_0x1bab3e(0xff5)](_0x9f3060),_0x288aec(),_0x1a44b1(_0x9ebf46[_0x1bab3e(0x970)]),_0x394b2c();}function _0x411ee8(_0x2d8ea0){const _0x334902=_0x419fa8;_0x370f8c=null;if(_0x2d8ea0){const _0x1c0494=_0x2d8ea0[_0x334902(0x91d)](_0x334902(0x4d2));_0x1c0494&&(_0x1c0494[_0x334902(0x1047)]='友善的评论是交流的起点');}}async function _0xc0e19(){const _0x1415ba=_0x419fa8,_0x8c34e0=document[_0x1415ba(0x9c8)]('memories-list');_0x8c34e0['innerHTML']='';const _0x4090af=await _0x2c5bcf[_0x1415ba(0x137e)]['orderBy']('timestamp')[_0x1415ba(0x101e)]()[_0x1415ba(0x5ff)]();if(_0x4090af[_0x1415ba(0xa06)]===0x0){_0x8c34e0['innerHTML']=_0x1415ba(0x57b);return;}_0x4090af[_0x1415ba(0x66b)]((_0x2c741f,_0x5b45a6)=>{const _0x3165b4=_0x1415ba,_0x4511ad=_0x2c741f[_0x3165b4(0x12d9)]===_0x3165b4(0xa89)&&_0x2c741f[_0x3165b4(0x1211)]>Date['now'](),_0x25fc53=_0x5b45a6[_0x3165b4(0x12d9)]==='countdown'&&_0x5b45a6['targetDate']>Date[_0x3165b4(0x9b7)]();if(_0x4511ad&&!_0x25fc53)return-0x1;if(!_0x4511ad&&_0x25fc53)return 0x1;if(_0x4511ad&&_0x25fc53)return _0x2c741f[_0x3165b4(0x1211)]-_0x5b45a6[_0x3165b4(0x1211)];return 0x0;}),_0x4090af['forEach'](_0xa9f2ed=>{const _0x1e6076=_0x1415ba;let _0x4091e2;_0xa9f2ed[_0x1e6076(0x12d9)]===_0x1e6076(0xa89)&&_0xa9f2ed[_0x1e6076(0x1211)]>Date[_0x1e6076(0x9b7)]()?_0x4091e2=_0xfadfa2(_0xa9f2ed):_0x4091e2=_0x6ae130(_0xa9f2ed),_0x8c34e0[_0x1e6076(0x7b9)](_0x4091e2);}),_0x2a0890();}function _0x6ae130(_0xd4e2c){const _0xf7ef75=_0x419fa8,_0x5776c0=document[_0xf7ef75(0x28a)](_0xf7ef75(0x11f4));_0x5776c0[_0xf7ef75(0x82c)]=_0xf7ef75(0x21a);const _0x5f27fe=new Date(_0xd4e2c[_0xf7ef75(0x6b5)]),_0x22d91f=_0x5f27fe[_0xf7ef75(0x10cd)]()+'-'+String(_0x5f27fe[_0xf7ef75(0x260)]()+0x1)['padStart'](0x2,'0')+'-'+String(_0x5f27fe[_0xf7ef75(0xa13)]())[_0xf7ef75(0x3e8)](0x2,'0')+'\x20'+String(_0x5f27fe[_0xf7ef75(0x7a2)]())[_0xf7ef75(0x3e8)](0x2,'0')+':'+String(_0x5f27fe[_0xf7ef75(0x3a6)]())['padStart'](0x2,'0');let _0x154b88,_0x183987;if(_0xd4e2c[_0xf7ef75(0x12d9)]===_0xf7ef75(0xa89)&&_0xd4e2c[_0xf7ef75(0x1211)])_0x154b88='[约定达成]\x20'+_0xd4e2c[_0xf7ef75(0x1387)],_0x183987=_0x1ffeeb('在\x20'+new Date(_0xd4e2c[_0xf7ef75(0x1211)])[_0xf7ef75(0x135b)]()+_0xf7ef75(0xe29))['replace'](/\n/g,_0xf7ef75(0x10d9));else{let _0x5934ba=_0xf7ef75(0xab4);if(_0xd4e2c[_0xf7ef75(0x61c)]){const _0x5104f4=_0x9ebf46[_0xf7ef75(0x547)][_0xd4e2c['authorId']];_0x5104f4?_0x5934ba=_0x5104f4[_0xf7ef75(0x609)]:_0x5934ba=_0xd4e2c['authorName']||_0xf7ef75(0x7fc);}else _0xd4e2c[_0xf7ef75(0xa2c)]&&(_0x5934ba=_0xd4e2c[_0xf7ef75(0xa2c)]);_0x154b88=_0x5934ba+_0xf7ef75(0x8dd),_0x183987=_0x1ffeeb(_0xd4e2c[_0xf7ef75(0x1387)]);}return _0x5776c0['innerHTML']=_0xf7ef75(0x11af)+_0x22d91f+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>'+_0x154b88+_0xf7ef75(0xaa1)+_0x183987+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x43a60a(_0x5776c0,async()=>{const _0x305404=_0xf7ef75,_0x1b5f09=await _0x352ae9(_0x305404(0x1362),_0x305404(0x938),{'confirmButtonClass':_0x305404(0x12bc)});_0x1b5f09&&(await _0x2c5bcf[_0x305404(0x137e)][_0x305404(0x6d2)](_0xd4e2c['id']),_0xc0e19());}),_0x5776c0;}function _0xfadfa2(_0x150b54){const _0x57f537=_0x419fa8,_0x3b9933=document[_0x57f537(0x28a)](_0x57f537(0x11f4));_0x3b9933[_0x57f537(0x82c)]=_0x57f537(0xd48);const _0x2125d7=new Date(_0x150b54['targetDate']),_0xf94b2d=_0x2125d7[_0x57f537(0x135b)](_0x57f537(0x101b),{'dateStyle':'full','timeStyle':_0x57f537(0x4ea)});return _0x3b9933['innerHTML']=_0x57f537(0xd2b)+_0x150b54[_0x57f537(0x1387)]+_0x57f537(0x11b7)+_0x150b54[_0x57f537(0x1211)]+_0x57f537(0x1037)+_0xf94b2d+_0x57f537(0xb72),_0x43a60a(_0x3b9933,async()=>{const _0x172555=_0x57f537,_0x45aff5=await _0x352ae9('删除约定',_0x172555(0x1371),{'confirmButtonClass':_0x172555(0x12bc)});_0x45aff5&&(await _0x2c5bcf[_0x172555(0x137e)][_0x172555(0x6d2)](_0x150b54['id']),_0xc0e19());}),_0x3b9933;}let _0x1056e0=[];function _0x2a0890(){const _0x3d9792=_0x419fa8;_0x1056e0[_0x3d9792(0x591)](_0x3c51f6=>clearInterval(_0x3c51f6)),_0x1056e0=[],document[_0x3d9792(0x7e4)](_0x3d9792(0x4d5))[_0x3d9792(0x591)](_0xb3506f=>{const _0x531c0c=_0x3d9792,_0x55889a=parseInt(_0xb3506f[_0x531c0c(0xc9f)][_0x531c0c(0x1211)]);let _0x2fe856;const _0x10a45c=()=>{const _0x4a8c6e=_0x531c0c,_0x4cc194=Date['now'](),_0x67bcb5=_0x55889a-_0x4cc194;if(_0x67bcb5<0x0){_0xb3506f['textContent']='约定达成！',clearInterval(_0x2fe856),setTimeout(()=>_0xc0e19(),0x7d0);return;}const _0x55c94c=Math['floor'](_0x67bcb5/(0x3e8*0x3c*0x3c*0x18)),_0x394955=Math['floor'](_0x67bcb5%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x4c8e58=Math[_0x4a8c6e(0x5fb)](_0x67bcb5%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x48c709=Math['floor'](_0x67bcb5%(0x3e8*0x3c)/0x3e8);_0xb3506f[_0x4a8c6e(0xe24)]=_0x55c94c+'天\x20'+_0x394955+'时\x20'+_0x4c8e58+'分\x20'+_0x48c709+'秒';};_0x10a45c(),_0x2fe856=setInterval(_0x10a45c,0x3e8),_0x1056e0[_0x531c0c(0x668)](_0x2fe856);});}async function _0x2ce675(_0x344683){const _0xaa6f3a=_0x419fa8,_0x170fa6=_0x9ebf46['chats'][_0x344683];if(!_0x170fa6)return;await _0x1bff53(_0xaa6f3a(0xa16),'正在为角色“'+_0x170fa6['name']+_0xaa6f3a(0x97a));const {proxyUrl:_0x576c6f,apiKey:_0x3ab558,model:_0x3c8793}=_0x9ebf46[_0xaa6f3a(0x4de)];if(!_0x576c6f||!_0x3ab558||!_0x3c8793){await _0x1bff53(_0xaa6f3a(0x7aa),_0xaa6f3a(0xa32));return;}const _0xe464e7=_0x170fa6['history'][_0xaa6f3a(0x1044)](-0x5)[_0xaa6f3a(0xa3b)](_0x4c00cf=>{const _0x4fd5ba=_0xaa6f3a,_0x51b962=_0x4c00cf[_0x4fd5ba(0x7fd)]===_0x4fd5ba(0x586)?_0x170fa6['settings'][_0x4fd5ba(0x29c)]||'我':_0x4c00cf[_0x4fd5ba(0xac4)]||_0x170fa6[_0x4fd5ba(0x609)];return _0x51b962+':\x20'+String(_0x4c00cf[_0x4fd5ba(0x53b)])[_0x4fd5ba(0xc34)](0x0,0x32)+_0x4fd5ba(0xf66);})[_0xaa6f3a(0x809)]('\x0a');let _0x328d70='';if(_0x170fa6['settings'][_0xaa6f3a(0x41a)]&&_0x170fa6[_0xaa6f3a(0x1131)][_0xaa6f3a(0x41a)][_0xaa6f3a(0xa06)]>0x0){const _0x43bd54=_0x170fa6['settings']['linkedWorldBookIds'][_0xaa6f3a(0xa3b)](_0x32a499=>{const _0x14a732=_0xaa6f3a,_0x5b39d0=_0x9ebf46[_0x14a732(0x1369)][_0x14a732(0xfc3)](_0x45a835=>_0x45a835['id']===_0x32a499);if(!_0x5b39d0||!Array[_0x14a732(0xb27)](_0x5b39d0[_0x14a732(0x53b)]))return'';const _0x46346f=_0x5b39d0[_0x14a732(0x53b)][_0x14a732(0xa3b)](_0x1b30b8=>{const _0x372705=_0x14a732;let _0x556485='\x0a###\x20条目:\x20'+(_0x1b30b8[_0x372705(0x10de)]||_0x372705(0xf27))+'\x0a';return _0x1b30b8[_0x372705(0x2bd)][_0x372705(0xa06)]>0x0&&(_0x556485+='**关键词:**\x20'+_0x1b30b8[_0x372705(0x2bd)][_0x372705(0x809)](',\x20')+'\x0a'),_0x556485+=_0x372705(0x246)+_0x1b30b8[_0x372705(0x53b)],_0x556485;})[_0x14a732(0x809)]('\x0a');return _0x46346f?_0x14a732(0xbac)+_0x5b39d0[_0x14a732(0x609)]+'\x0a'+_0x46346f:'';})[_0xaa6f3a(0x401)](Boolean)[_0xaa6f3a(0x809)]('');_0x43bd54&&(_0x328d70=_0xaa6f3a(0xa3a)+_0x43bd54+'\x0a');}const _0xff0002=_0xaa6f3a(0xa5d)+_0x170fa6[_0xaa6f3a(0x609)]+'”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x170fa6['settings'][_0xaa6f3a(0xae3)]+_0xaa6f3a(0xdde)+_0x328d70+_0xaa6f3a(0x129a)+_0xe464e7+_0xaa6f3a(0xead);try{const _0x11ed07=[{'role':'system','content':_0xff0002},{'role':'user','content':_0xaa6f3a(0x6fa)}];let _0x187fbd=_0x576c6f===GEMINI_API_URL,_0x24f333=_0x2e5c04(_0x3c8793,_0x3ab558,_0xff0002,_0x11ed07);const _0x28d148=_0x187fbd?await fetch(_0x24f333[_0xaa6f3a(0x11be)],_0x24f333[_0xaa6f3a(0x100d)]):await fetch(_0x576c6f+_0xaa6f3a(0x1090),{'method':_0xaa6f3a(0x116f),'headers':{'Content-Type':'application/json','Authorization':_0xaa6f3a(0x84a)+_0x3ab558},'body':JSON[_0xaa6f3a(0xf1e)]({'model':_0x3c8793,'messages':_0x11ed07,'temperature':_0x9ebf46[_0xaa6f3a(0x1383)][_0xaa6f3a(0xc3d)]||0.9})});if(!_0x28d148['ok']){const _0x3b2623=await _0x28d148[_0xaa6f3a(0x5dd)]();throw new Error(_0xaa6f3a(0xe1a)+_0x28d148[_0xaa6f3a(0xebd)]+_0xaa6f3a(0x23e)+_0x3b2623[_0xaa6f3a(0x1221)][_0xaa6f3a(0x86e)]);}const _0x35b10c=await _0x28d148[_0xaa6f3a(0x5dd)]();let _0x49e548=_0x187fbd?_0x35b10c['candidates'][0x0]['content']['parts'][0x0][_0xaa6f3a(0xbb7)]:_0x35b10c[_0xaa6f3a(0xfd2)][0x0]['message'][_0xaa6f3a(0x53b)];_0x49e548=_0x49e548['replace'](/^```json\s*/,'')[_0xaa6f3a(0x459)](/```$/,'');const _0x27b6c7=_0x49e548['trim'](),_0x462a65=JSON[_0xaa6f3a(0x907)](_0x27b6c7);_0x462a65[_0xaa6f3a(0x91c)]===_0xaa6f3a(0x1336)&&_0x462a65[_0xaa6f3a(0x616)]?(_0x170fa6[_0xaa6f3a(0x36f)][_0xaa6f3a(0xebd)]='pending_user_approval',_0x170fa6[_0xaa6f3a(0x36f)][_0xaa6f3a(0x1271)]=_0x462a65[_0xaa6f3a(0x616)],_0x9ebf46[_0xaa6f3a(0x547)][_0x344683]=_0x170fa6,_0x394b2c(),await _0x1bff53(_0xaa6f3a(0x6cd),'“'+_0x170fa6['name']+_0xaa6f3a(0x614))):(await _0x1bff53(_0xaa6f3a(0x12fc),'“'+_0x170fa6['name']+_0xaa6f3a(0xae1)),_0x170fa6[_0xaa6f3a(0x36f)][_0xaa6f3a(0xebd)]=_0xaa6f3a(0xafb),_0x170fa6[_0xaa6f3a(0x36f)]['blockedTimestamp']=Date[_0xaa6f3a(0x9b7)]());}catch(_0x237a99){await _0x1bff53(_0xaa6f3a(0x898),'为“'+_0x170fa6['name']+_0xaa6f3a(0xa18)+_0x237a99[_0xaa6f3a(0x86e)]+_0xaa6f3a(0x689)),_0x170fa6[_0xaa6f3a(0x36f)]['status']=_0xaa6f3a(0xafb),_0x170fa6[_0xaa6f3a(0x36f)][_0xaa6f3a(0x13c3)]=Date[_0xaa6f3a(0x9b7)]();}finally{await _0x2c5bcf[_0xaa6f3a(0x547)][_0xaa6f3a(0xff5)](_0x170fa6),_0x1a44b1(_0x344683);}}function _0x1cc2ec(){const _0x4f3f43=_0x419fa8;if(!_0x9ebf46[_0x4f3f43(0x970)])return;const _0x528ac8=_0x9ebf46[_0x4f3f43(0x547)][_0x9ebf46['activeChatId']];_0x528ac8['isGroup']?_0x2c68eb():document[_0x4f3f43(0x9c8)]('transfer-modal')[_0x4f3f43(0x575)][_0x4f3f43(0x68e)](_0x4f3f43(0xc3f));}function _0x2c68eb(){const _0x129cbb=_0x419fa8,_0x5d96c2=document[_0x129cbb(0x9c8)](_0x129cbb(0xada)),_0x5b20c6=_0x9ebf46[_0x129cbb(0x547)][_0x9ebf46[_0x129cbb(0x970)]];document[_0x129cbb(0x9c8)](_0x129cbb(0xa64))[_0x129cbb(0x1155)]='',document[_0x129cbb(0x9c8)](_0x129cbb(0xc4b))['value']='',document[_0x129cbb(0x9c8)](_0x129cbb(0x380))[_0x129cbb(0x1155)]='',document[_0x129cbb(0x9c8)](_0x129cbb(0xe65))[_0x129cbb(0x1155)]='',document['getElementById']('rp-direct-greeting')['value']='',document['getElementById'](_0x129cbb(0x99e))['textContent']=_0x129cbb(0x5c9),document[_0x129cbb(0x9c8)](_0x129cbb(0x7d5))[_0x129cbb(0xe24)]=_0x129cbb(0x5c9);const _0x15caa6=document['getElementById'](_0x129cbb(0x80e));_0x15caa6[_0x129cbb(0x2f5)]='',_0x5b20c6[_0x129cbb(0xd3e)][_0x129cbb(0x591)](_0x7bb895=>{const _0x15f547=_0x129cbb,_0x3a9f0a=document['createElement']('option');_0x3a9f0a[_0x15f547(0x1155)]=_0x7bb895[_0x15f547(0x1071)],_0x3a9f0a[_0x15f547(0xe24)]=_0x7bb895[_0x15f547(0x1132)],_0x15caa6[_0x15f547(0x7b9)](_0x3a9f0a);}),document[_0x129cbb(0x9c8)]('rp-tab-group')[_0x129cbb(0xf5c)](),_0x5d96c2[_0x129cbb(0x575)][_0x129cbb(0x68e)]('visible');}async function _0x5a1d80(){const _0x4c045a=_0x419fa8,_0x3306c3=_0x9ebf46['chats'][_0x9ebf46['activeChatId']],_0x381e58=parseFloat(document[_0x4c045a(0x9c8)]('rp-group-amount')[_0x4c045a(0x1155)]),_0x2ae19c=parseInt(document[_0x4c045a(0x9c8)](_0x4c045a(0xc4b))[_0x4c045a(0x1155)]),_0x3e5e50=document[_0x4c045a(0x9c8)](_0x4c045a(0x380))[_0x4c045a(0x1155)]['trim']();if(isNaN(_0x381e58)||_0x381e58<=0x0){alert('请输入有效的总金额！');return;}if(isNaN(_0x2ae19c)||_0x2ae19c<=0x0){alert('请输入有效的红包个数！');return;}if(_0x381e58/_0x2ae19c<0.01){alert(_0x4c045a(0x963));return;}const _0x258cab=_0x3306c3[_0x4c045a(0x1131)]['myNickname']||'我',_0x411b2b={'role':_0x4c045a(0x586),'senderName':_0x258cab,'type':_0x4c045a(0xf67),'packetType':_0x4c045a(0x537),'timestamp':Date[_0x4c045a(0x9b7)](),'totalAmount':_0x381e58,'count':_0x2ae19c,'greeting':_0x3e5e50||_0x4c045a(0xb65),'claimedBy':{},'isFullyClaimed':![]};_0x3306c3[_0x4c045a(0x8b3)][_0x4c045a(0x668)](_0x411b2b),await _0x2c5bcf['chats'][_0x4c045a(0xff5)](_0x3306c3),_0xc4e879(_0x411b2b,_0x3306c3),_0x394b2c(),document[_0x4c045a(0x9c8)](_0x4c045a(0xada))[_0x4c045a(0x575)][_0x4c045a(0x30f)](_0x4c045a(0xc3f));}async function _0x5a6c3c(){const _0x38637c=_0x419fa8,_0x47bd10=_0x9ebf46[_0x38637c(0x547)][_0x9ebf46['activeChatId']],_0x1b72e5=parseFloat(document[_0x38637c(0x9c8)](_0x38637c(0xe65))[_0x38637c(0x1155)]),_0x3388df=document[_0x38637c(0x9c8)](_0x38637c(0x80e))[_0x38637c(0x1155)],_0x5d82ac=document[_0x38637c(0x9c8)](_0x38637c(0x9f3))[_0x38637c(0x1155)][_0x38637c(0x3f1)]();if(isNaN(_0x1b72e5)||_0x1b72e5<=0x0){alert(_0x38637c(0xde3));return;}if(!_0x3388df){alert(_0x38637c(0xd6f));return;}const _0x33ae2d=_0x47bd10[_0x38637c(0x1131)][_0x38637c(0x29c)]||'我',_0x1f6ddb={'role':_0x38637c(0x586),'senderName':_0x33ae2d,'type':'red_packet','packetType':_0x38637c(0x7b4),'timestamp':Date[_0x38637c(0x9b7)](),'totalAmount':_0x1b72e5,'count':0x1,'greeting':_0x5d82ac||_0x38637c(0x738),'receiverName':_0x3388df,'claimedBy':{},'isFullyClaimed':![]};_0x47bd10[_0x38637c(0x8b3)]['push'](_0x1f6ddb),await _0x2c5bcf[_0x38637c(0x547)][_0x38637c(0xff5)](_0x47bd10),_0xc4e879(_0x1f6ddb,_0x47bd10),_0x394b2c(),document['getElementById'](_0x38637c(0xada))[_0x38637c(0x575)]['remove'](_0x38637c(0xc3f));}async function _0x23c5f9(_0x48524f){const _0xdf60ca=_0x419fa8,_0x1eb4e6=_0x9ebf46[_0xdf60ca(0x970)],_0x778351=await _0x2c5bcf['chats'][_0xdf60ca(0xdf9)](_0x1eb4e6);if(!_0x778351)return;_0x9ebf46[_0xdf60ca(0x547)][_0x1eb4e6]=_0x778351;const _0x392bef=_0x778351[_0xdf60ca(0x8b3)][_0xdf60ca(0xfc3)](_0x1bdc5f=>_0x1bdc5f['timestamp']===_0x48524f);if(!_0x392bef)return;const _0x248c3e=_0x9ebf46[_0xdf60ca(0x32c)][_0xdf60ca(0x5b7)]||'{{user}}',_0x15efeb=_0x392bef[_0xdf60ca(0x1118)]&&_0x392bef[_0xdf60ca(0x1118)][_0x248c3e];if(_0x392bef[_0xdf60ca(0x30a)]===_0xdf60ca(0x7b4)&&_0x392bef[_0xdf60ca(0xc8a)]!==_0x248c3e&&Object[_0xdf60ca(0x2bd)](_0x392bef[_0xdf60ca(0x1118)])[_0xdf60ca(0xa06)]>0x0||_0x392bef[_0xdf60ca(0x11b0)]||_0x15efeb){_0x494779(_0x392bef);return;}const _0x294ee6=await _0x121f30(_0x392bef);_0x294ee6!==null&&(await _0x1a44b1(_0x1eb4e6),await _0x1bff53('恭喜！',_0xdf60ca(0x734)+_0x227896(_0x778351,_0x392bef[_0xdf60ca(0xac4)])+_0xdf60ca(0x463)+_0x294ee6['toFixed'](0x2)+_0xdf60ca(0x4ce)));const _0x5b4367=_0x9ebf46[_0xdf60ca(0x547)][_0x1eb4e6]['history'][_0xdf60ca(0xfc3)](_0x436cd0=>_0x436cd0[_0xdf60ca(0x6b5)]===_0x48524f);_0x5b4367&&_0x494779(_0x5b4367);}async function _0x121f30(_0x52ddd4){const _0x431e90=_0x419fa8,_0x1c3a60=_0x9ebf46[_0x431e90(0x547)][_0x9ebf46[_0x431e90(0x970)]];let _0x2cc0ad=Date[_0x431e90(0x9b7)]();const _0xede484=_0x9ebf46[_0x431e90(0x32c)][_0x431e90(0x5b7)]||'{{user}}',_0x2d9581=_0x52ddd4['count']-Object[_0x431e90(0x2bd)](_0x52ddd4[_0x431e90(0x1118)]||{})[_0x431e90(0xa06)];if(_0x2d9581<=0x0)return _0x52ddd4[_0x431e90(0x11b0)]=!![],await _0x2c5bcf[_0x431e90(0x547)]['put'](_0x1c3a60),await _0x1bff53(_0x431e90(0x1f4),_0x431e90(0xd64)),null;let _0xbfb0c5=0x0;const _0x568521=_0x52ddd4[_0x431e90(0xc3b)]-Object[_0x431e90(0xeb2)](_0x52ddd4[_0x431e90(0x1118)]||{})[_0x431e90(0x12c1)]((_0x36e0d3,_0x43c283)=>_0x36e0d3+_0x43c283,0x0);if(_0x52ddd4[_0x431e90(0x30a)]==='lucky'){if(_0x2d9581===0x1)_0xbfb0c5=_0x568521;else{const _0x4f2d15=0.01,_0x1c6c3e=_0x568521-(_0x2d9581-0x1)*_0x4f2d15;_0xbfb0c5=Math['random']()*(_0x1c6c3e-_0x4f2d15)+_0x4f2d15;}}else _0xbfb0c5=_0x52ddd4[_0x431e90(0xc3b)];_0xbfb0c5=parseFloat(_0xbfb0c5[_0x431e90(0x752)](0x2));if(!_0x52ddd4[_0x431e90(0x1118)])_0x52ddd4['claimedBy']={};_0x52ddd4[_0x431e90(0x1118)][_0xede484]=_0xbfb0c5;const _0x2fd0f2=Object[_0x431e90(0x2bd)](_0x52ddd4[_0x431e90(0x1118)])[_0x431e90(0xa06)]>=_0x52ddd4[_0x431e90(0x636)];_0x2fd0f2&&(_0x52ddd4['isFullyClaimed']=!![]);const _0x2bee36=_0x227896(_0x1c3a60,_0xede484),_0x123cf0=_0x227896(_0x1c3a60,_0x52ddd4[_0x431e90(0xac4)]),_0x49d69d={'role':_0x431e90(0xb64),'type':_0x431e90(0x13a8),'content':_0x431e90(0x734)+_0x123cf0+_0x431e90(0xf43),'timestamp':_0x2cc0ad++};_0x1c3a60[_0x431e90(0x8b3)][_0x431e90(0x668)](_0x49d69d);let _0x25b4fb;if(_0x2fd0f2){const _0x2756fc={'role':'system','type':_0x431e90(0x13a8),'content':_0x123cf0+'\x20的红包已被领完','timestamp':_0x2cc0ad++};_0x1c3a60['history'][_0x431e90(0x668)](_0x2756fc);let _0x7303e5={'name':'','amount':-0x1};_0x52ddd4[_0x431e90(0x30a)]===_0x431e90(0x537)&&_0x52ddd4[_0x431e90(0x636)]>0x1&&Object[_0x431e90(0x1231)](_0x52ddd4['claimedBy'])[_0x431e90(0x591)](([_0x5824e0,_0x1c3940])=>{const _0x46db0b=_0x431e90;_0x1c3940>_0x7303e5[_0x46db0b(0x212)]&&(_0x7303e5={'name':_0x5824e0,'amount':_0x1c3940});});const _0x14ff29=_0x7303e5['name']?_0x227896(_0x1c3a60,_0x7303e5[_0x431e90(0x609)]):'无';_0x25b4fb=_0x431e90(0xc77)+_0x2bee36+_0x431e90(0x2e4)+_0x14ff29+'！请对此事件发表评论。]';}else _0x25b4fb=_0x431e90(0xc77)+_0x2bee36+_0x431e90(0xfb1)+_0x52ddd4[_0x431e90(0x6b5)]+_0x431e90(0x4bc);const _0x4dc46f={'role':'system','content':_0x25b4fb,'timestamp':_0x2cc0ad++,'isHidden':!![]};return _0x1c3a60[_0x431e90(0x8b3)]['push'](_0x4dc46f),await _0x2c5bcf[_0x431e90(0x547)]['put'](_0x1c3a60),_0xbfb0c5;}async function _0x494779(_0x34cc9b){const _0x23c3bb=_0x419fa8;if(!_0x34cc9b){console['error'](_0x23c3bb(0x12fd));return;}const _0xd7da38=_0x9ebf46[_0x23c3bb(0x547)][_0x9ebf46[_0x23c3bb(0x970)]];if(!_0xd7da38)return;const _0x4da9f0=document[_0x23c3bb(0x9c8)](_0x23c3bb(0x9a7)),_0x58c67b=_0x9ebf46[_0x23c3bb(0x32c)][_0x23c3bb(0x5b7)]||_0x23c3bb(0x5c1),_0x3cb127=_0x227896(_0xd7da38,_0x34cc9b['senderName']);document[_0x23c3bb(0x9c8)](_0x23c3bb(0x8d3))[_0x23c3bb(0xe24)]=_0x3cb127,document[_0x23c3bb(0x9c8)](_0x23c3bb(0x1046))[_0x23c3bb(0xe24)]=_0x34cc9b[_0x23c3bb(0xb0c)]||_0x23c3bb(0xb65);const _0x59df60=document[_0x23c3bb(0x9c8)](_0x23c3bb(0x5ba));_0x34cc9b[_0x23c3bb(0x1118)]&&_0x34cc9b['claimedBy'][_0x58c67b]?(_0x59df60['querySelector'](_0x23c3bb(0x561))['textContent']=_0x34cc9b[_0x23c3bb(0x1118)][_0x58c67b]['toFixed'](0x2),_0x59df60[_0x23c3bb(0x5e1)][_0x23c3bb(0x3c5)]='block'):_0x59df60[_0x23c3bb(0x5e1)]['display']=_0x23c3bb(0x8f6);const _0x891286=Object[_0x23c3bb(0x2bd)](_0x34cc9b[_0x23c3bb(0x1118)]||{})[_0x23c3bb(0xa06)],_0x475872=Object[_0x23c3bb(0xeb2)](_0x34cc9b['claimedBy']||{})[_0x23c3bb(0x12c1)]((_0x34fd94,_0x29efd3)=>_0x34fd94+_0x29efd3,0x0);let _0x3f3385=_0x891286+'/'+_0x34cc9b[_0x23c3bb(0x636)]+_0x23c3bb(0x51b)+_0x475872[_0x23c3bb(0x752)](0x2)+'/'+_0x34cc9b[_0x23c3bb(0xc3b)]['toFixed'](0x2)+'元。';if(!_0x34cc9b[_0x23c3bb(0x11b0)]&&_0x891286<_0x34cc9b[_0x23c3bb(0x636)]){const _0x2025c5=Math[_0x23c3bb(0x5fb)]((_0x34cc9b[_0x23c3bb(0x6b5)]+0x18*0x3c*0x3c*0x3e8-Date['now']())/(0x3e8*0x3c*0x3c));if(_0x2025c5>0x0)_0x3f3385+='\x20剩余红包将在'+_0x2025c5+_0x23c3bb(0x9e3);}document['getElementById'](_0x23c3bb(0x831))[_0x23c3bb(0xe24)]=_0x3f3385;const _0x5e4b53=document['getElementById'](_0x23c3bb(0xbc5));_0x5e4b53['innerHTML']='';const _0x187017=Object[_0x23c3bb(0x1231)](_0x34cc9b[_0x23c3bb(0x1118)]||{});let _0x5a1040={'name':'','amount':-0x1};_0x34cc9b[_0x23c3bb(0x30a)]===_0x23c3bb(0x537)&&_0x34cc9b[_0x23c3bb(0x11b0)]&&_0x187017['length']>0x1&&_0x187017[_0x23c3bb(0x591)](([_0x2c2a6d,_0x2ee680])=>{_0x2ee680>_0x5a1040['amount']&&(_0x5a1040={'name':_0x2c2a6d,'amount':_0x2ee680});}),_0x187017[_0x23c3bb(0x66b)]((_0x20bd4b,_0x342ad5)=>_0x342ad5[0x1]-_0x20bd4b[0x1]),_0x187017[_0x23c3bb(0x591)](([_0xdd1a91,_0x3f1089])=>{const _0x386197=_0x23c3bb,_0x4f19dc=document[_0x386197(0x28a)]('div');_0x4f19dc[_0x386197(0x82c)]=_0x386197(0x219);let _0x5ae47b='';_0x5a1040[_0x386197(0x609)]&&_0xdd1a91===_0x5a1040[_0x386197(0x609)]&&(_0x5ae47b='<span\x20class=\x22lucky-king-tag\x22>手气王</span>');const _0x1a362d=_0x227896(_0xd7da38,_0xdd1a91);_0x4f19dc['innerHTML']=_0x386197(0xf98)+_0x1a362d+_0x386197(0x127e)+_0x3f1089[_0x386197(0x752)](0x2)+_0x386197(0x4f1)+_0x5ae47b+_0x386197(0x9d9),_0x5e4b53['appendChild'](_0x4f19dc);}),_0x4da9f0['classList'][_0x23c3bb(0x68e)]('visible');}document[_0x419fa8(0x9c8)]('close-rp-details-btn')[_0x419fa8(0xa0f)](_0x419fa8(0xf5c),()=>{const _0x506d68=_0x419fa8;document[_0x506d68(0x9c8)](_0x506d68(0x9a7))[_0x506d68(0x575)][_0x506d68(0x30f)](_0x506d68(0xc3f));}),window[_0x419fa8(0xe72)]=_0x23c5f9;function _0x429f82(){const _0x13596=_0x419fa8,_0x5b2e82=document['getElementById'](_0x13596(0x53d));document[_0x13596(0x9c8)](_0x13596(0xcb1))['value']='';const _0x5bbfb7=document[_0x13596(0x9c8)]('poll-options-container');_0x5bbfb7[_0x13596(0x2f5)]='',_0x30d7b2(),_0x30d7b2(),_0x5b2e82['classList'][_0x13596(0x68e)](_0x13596(0xc3f));}function _0x30d7b2(){const _0x2c5e61=_0x419fa8,_0x298f35=document[_0x2c5e61(0x9c8)](_0x2c5e61(0xba9)),_0x4b591e=document['createElement'](_0x2c5e61(0x11f4));_0x4b591e[_0x2c5e61(0x82c)]=_0x2c5e61(0xb52),_0x4b591e[_0x2c5e61(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4b591e['querySelector'](_0x2c5e61(0x1125))[_0x2c5e61(0xa0f)](_0x2c5e61(0xf5c),()=>{const _0x3065b4=_0x2c5e61;_0x298f35[_0x3065b4(0xa9a)][_0x3065b4(0xa06)]>0x2?_0x4b591e['remove']():alert(_0x3065b4(0x9ee));}),_0x298f35['appendChild'](_0x4b591e);}async function _0x99912f(){const _0x1899a3=_0x419fa8;if(!_0x9ebf46[_0x1899a3(0x970)])return;const _0x32cf6a=document[_0x1899a3(0x9c8)](_0x1899a3(0xcb1))[_0x1899a3(0x1155)]['trim']();if(!_0x32cf6a){alert(_0x1899a3(0xbdc));return;}const _0x1670c3=Array[_0x1899a3(0x13a5)](document['querySelectorAll'](_0x1899a3(0x8b2)))[_0x1899a3(0xa3b)](_0x34c351=>_0x34c351[_0x1899a3(0x1155)][_0x1899a3(0x3f1)]())[_0x1899a3(0x401)](_0x5ab239=>_0x5ab239);if(_0x1670c3[_0x1899a3(0xa06)]<0x2){alert(_0x1899a3(0xa29));return;}const _0x2b0c52=_0x9ebf46['chats'][_0x9ebf46[_0x1899a3(0x970)]],_0x578124=_0x2b0c52[_0x1899a3(0x11e4)]?_0x2b0c52[_0x1899a3(0x1131)]['myNickname']||'我':'我',_0x2607e1={'role':_0x1899a3(0x586),'senderName':_0x578124,'type':_0x1899a3(0xb71),'timestamp':Date[_0x1899a3(0x9b7)](),'question':_0x32cf6a,'options':_0x1670c3,'votes':{},'isClosed':![]};_0x2b0c52[_0x1899a3(0x8b3)][_0x1899a3(0x668)](_0x2607e1),await _0x2c5bcf['chats'][_0x1899a3(0xff5)](_0x2b0c52),_0xc4e879(_0x2607e1,_0x2b0c52),_0x394b2c(),document['getElementById'](_0x1899a3(0x53d))[_0x1899a3(0x575)][_0x1899a3(0x30f)](_0x1899a3(0xc3f));}async function _0x20009b(_0x37a616,_0x42b747){const _0x2b156b=_0x419fa8,_0x3fe85d=_0x9ebf46[_0x2b156b(0x547)][_0x9ebf46[_0x2b156b(0x970)]],_0x12a9b2=_0x3fe85d[_0x2b156b(0x8b3)][_0x2b156b(0xfc3)](_0xf9d159=>_0xf9d159[_0x2b156b(0x6b5)]===_0x37a616),_0x12553d=_0x3fe85d[_0x2b156b(0x11e4)]?_0x3fe85d[_0x2b156b(0x1131)][_0x2b156b(0x29c)]||'我':'我';if(!_0x12a9b2||_0x12a9b2[_0x2b156b(0x12b8)]){_0x12a9b2&&_0x12a9b2['isClosed']&&_0x125490(_0x37a616);return;}const _0x491753=_0x12a9b2[_0x2b156b(0xe19)][_0x42b747]&&_0x12a9b2[_0x2b156b(0xe19)][_0x42b747][_0x2b156b(0x930)](_0x12553d);if(!_0x491753){for(const _0x5b3d58 in _0x12a9b2['votes']){const _0x513f19=_0x12a9b2[_0x2b156b(0xe19)][_0x5b3d58][_0x2b156b(0x78e)](_0x12553d);_0x513f19>-0x1&&_0x12a9b2[_0x2b156b(0xe19)][_0x5b3d58][_0x2b156b(0x888)](_0x513f19,0x1);}!_0x12a9b2[_0x2b156b(0xe19)][_0x42b747]&&(_0x12a9b2[_0x2b156b(0xe19)][_0x42b747]=[]),_0x12a9b2[_0x2b156b(0xe19)][_0x42b747][_0x2b156b(0x668)](_0x12553d);}let _0x5824dd=null;!_0x491753&&(_0x5824dd=_0x2b156b(0xc77)+_0x12553d+_0x2b156b(0x47a)+_0x42b747+_0x2b156b(0xa23));if(_0x5824dd){const _0x426178={'role':_0x2b156b(0xb64),'content':_0x5824dd,'timestamp':Date[_0x2b156b(0x9b7)](),'isHidden':!![]};_0x3fe85d['history']['push'](_0x426178);}await _0x2c5bcf[_0x2b156b(0x547)]['put'](_0x3fe85d),_0x1a44b1(_0x9ebf46['activeChatId']);}async function _0x5bdb6f(_0x9ca726){const _0x3635be=_0x419fa8,_0x4c4fe9=_0x9ebf46[_0x3635be(0x547)][_0x9ebf46[_0x3635be(0x970)]],_0xb4dafd=_0x4c4fe9['history'][_0x3635be(0xfc3)](_0x1449a8=>_0x1449a8['timestamp']===_0x9ca726);if(!_0xb4dafd||_0xb4dafd[_0x3635be(0x12b8)])return;const _0xfcd1a8=await _0x352ae9(_0x3635be(0x124d),'确定要结束这个投票吗？结束后将无法再进行投票。');if(_0xfcd1a8){_0xb4dafd['isClosed']=!![];const _0xa4bb0b=_0xb4dafd[_0x3635be(0x5ed)][_0x3635be(0xa3b)](_0x81db7c=>'“'+_0x81db7c+'”('+(_0xb4dafd[_0x3635be(0xe19)][_0x81db7c]?.[_0x3635be(0xa06)]||0x0)+'票)')[_0x3635be(0x809)]('，'),_0xa1ad24=_0x3635be(0x1e3)+_0xa4bb0b+'。]',_0x5af766={'role':_0x3635be(0xb64),'content':_0xa1ad24,'timestamp':Date[_0x3635be(0x9b7)](),'isHidden':!![]};_0x4c4fe9[_0x3635be(0x8b3)][_0x3635be(0x668)](_0x5af766),await _0x2c5bcf[_0x3635be(0x547)][_0x3635be(0xff5)](_0x4c4fe9),_0x1a44b1(_0x9ebf46['activeChatId']);}}function _0x125490(_0x3e6a9c){const _0x2890fc=_0x419fa8,_0x385d94=_0x9ebf46[_0x2890fc(0x547)][_0x9ebf46[_0x2890fc(0x970)]],_0x1050b8=_0x385d94[_0x2890fc(0x8b3)][_0x2890fc(0xfc3)](_0x4dc334=>_0x4dc334[_0x2890fc(0x6b5)]===_0x3e6a9c);if(!_0x1050b8||!_0x1050b8[_0x2890fc(0x12b8)])return;let _0x3b629b=_0x2890fc(0xcee)+_0x1050b8['question']+_0x2890fc(0xc02);Object[_0x2890fc(0x2bd)](_0x1050b8[_0x2890fc(0xe19)])[_0x2890fc(0xa06)]===0x0?_0x3b629b+=_0x2890fc(0x5c0):_0x1050b8[_0x2890fc(0x5ed)]['forEach'](_0x76233d=>{const _0x5cf623=_0x2890fc,_0x541874=_0x1050b8[_0x5cf623(0xe19)][_0x76233d]||[],_0xc8e734=_0x541874[_0x5cf623(0xa3b)](_0x18bc6c=>_0x227896(_0x385d94,_0x18bc6c))['join']('、\x20');_0x3b629b+=_0x5cf623(0x11b6)+_0x76233d+'\x20('+_0x541874[_0x5cf623(0xa06)]+_0x5cf623(0xdcf)+(_0x541874['length']>0x0?_0xc8e734:_0x5cf623(0x1350))+_0x5cf623(0x7e8);}),_0x1bff53(_0x2890fc(0x258),_0x3b629b);}function _0x215f00(){const _0x1212cc=_0x419fa8;if(!_0x9ebf46['activeChatId'])return;const _0x2df60a=_0x9ebf46[_0x1212cc(0x547)][_0x9ebf46[_0x1212cc(0x970)]];document[_0x1212cc(0x9c8)]('ai-avatar-library-title')[_0x1212cc(0xe24)]='“'+_0x2df60a[_0x1212cc(0x609)]+_0x1212cc(0x1144),_0x1386b6(),document[_0x1212cc(0x9c8)](_0x1212cc(0xcbc))[_0x1212cc(0x575)]['add'](_0x1212cc(0xc3f));}function _0x1386b6(){const _0x35ef49=_0x419fa8,_0xc735ca=document[_0x35ef49(0x9c8)](_0x35ef49(0xf2d));_0xc735ca[_0x35ef49(0x2f5)]='';const _0x5c713a=_0x9ebf46[_0x35ef49(0x547)][_0x9ebf46[_0x35ef49(0x970)]],_0x19bcb3=_0x5c713a[_0x35ef49(0x1131)][_0x35ef49(0x295)]||[];if(_0x19bcb3[_0x35ef49(0xa06)]===0x0){_0xc735ca[_0x35ef49(0x2f5)]=_0x35ef49(0x20e);return;}_0x19bcb3[_0x35ef49(0x591)]((_0x3a42e7,_0x555d23)=>{const _0x3fb951=_0x35ef49,_0x21f1a2=document['createElement'](_0x3fb951(0x11f4));_0x21f1a2[_0x3fb951(0x82c)]='sticker-item',_0x21f1a2['title']=_0x3a42e7[_0x3fb951(0x609)],_0x21f1a2[_0x3fb951(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url('+_0x3a42e7[_0x3fb951(0x11be)]+_0x3fb951(0xeb3)+_0x3a42e7[_0x3fb951(0x609)]+_0x3fb951(0x215);const _0x2668ba=document['createElement']('div');_0x2668ba[_0x3fb951(0x82c)]='delete-btn',_0x2668ba[_0x3fb951(0x2f5)]='×',_0x2668ba[_0x3fb951(0x5e1)]['display']='block',_0x2668ba[_0x3fb951(0x2fa)]=async _0x2ac2d0=>{const _0x299122=_0x3fb951;_0x2ac2d0[_0x299122(0x20a)]();const _0x3473dc=await _0x352ae9(_0x299122(0x585),_0x299122(0x805)+_0x3a42e7[_0x299122(0x609)]+_0x299122(0x13a7),{'confirmButtonClass':_0x299122(0x12bc)});_0x3473dc&&(_0x5c713a[_0x299122(0x1131)][_0x299122(0x295)][_0x299122(0x888)](_0x555d23,0x1),await _0x2c5bcf[_0x299122(0x547)][_0x299122(0xff5)](_0x5c713a),_0x1386b6());},_0x21f1a2[_0x3fb951(0x7b9)](_0x2668ba),_0xc735ca[_0x3fb951(0x7b9)](_0x21f1a2);});}async function _0x59aac0(){const _0x37fd5c=_0x419fa8,_0x2d1a24=await _0xadb5df(_0x37fd5c(0x11a7),_0x37fd5c(0xc2c));if(!_0x2d1a24||!_0x2d1a24[_0x37fd5c(0x3f1)]())return;const _0x1d68c7=await _0xadb5df(_0x37fd5c(0x11a7),_0x37fd5c(0xf6a),'',_0x37fd5c(0x11be));if(!_0x1d68c7||!_0x1d68c7[_0x37fd5c(0x3f1)]()[_0x37fd5c(0xc8d)](_0x37fd5c(0x34e))){alert(_0x37fd5c(0xf0f));return;}const _0x398310=_0x9ebf46[_0x37fd5c(0x547)][_0x9ebf46[_0x37fd5c(0x970)]];!_0x398310[_0x37fd5c(0x1131)]['aiAvatarLibrary']&&(_0x398310[_0x37fd5c(0x1131)][_0x37fd5c(0x295)]=[]),_0x398310[_0x37fd5c(0x1131)][_0x37fd5c(0x295)][_0x37fd5c(0x668)]({'name':_0x2d1a24[_0x37fd5c(0x3f1)](),'url':_0x1d68c7[_0x37fd5c(0x3f1)]()}),await _0x2c5bcf[_0x37fd5c(0x547)]['put'](_0x398310),_0x1386b6();}function _0x4c8989(){const _0x41efc7=_0x419fa8;document[_0x41efc7(0x9c8)](_0x41efc7(0xcbc))[_0x41efc7(0x575)][_0x41efc7(0x30f)](_0x41efc7(0xc3f));}function _0x392db6(){const _0x2fa8ae=_0x419fa8;if(!_0x9ebf46[_0x2fa8ae(0x970)])return;const _0x2684ef=_0x9ebf46[_0x2fa8ae(0x547)][_0x9ebf46[_0x2fa8ae(0x970)]];document[_0x2fa8ae(0x9c8)]('my-avatar-library-title')['textContent']='“'+(_0x2684ef[_0x2fa8ae(0x1131)]['myNickname']||'我')+_0x2fa8ae(0x1144),_0x4b511c(),document[_0x2fa8ae(0x9c8)](_0x2fa8ae(0x109f))['classList'][_0x2fa8ae(0x68e)](_0x2fa8ae(0xc3f));}function _0x4b511c(){const _0x2db8dd=_0x419fa8,_0x3eef91=document[_0x2db8dd(0x9c8)]('my-avatar-library-grid');_0x3eef91[_0x2db8dd(0x2f5)]='';const _0x5f3d1d=_0x9ebf46['chats'][_0x9ebf46['activeChatId']],_0x43377b=_0x5f3d1d[_0x2db8dd(0x1131)][_0x2db8dd(0xd7a)]||[];if(_0x43377b[_0x2db8dd(0xa06)]===0x0){_0x3eef91[_0x2db8dd(0x2f5)]=_0x2db8dd(0x20e);return;}_0x43377b['forEach']((_0x10f24b,_0x2b5281)=>{const _0x53c1d7=_0x2db8dd,_0x1d402f=document['createElement']('div');_0x1d402f[_0x53c1d7(0x82c)]='sticker-item',_0x1d402f[_0x53c1d7(0x9f2)]=_0x10f24b[_0x53c1d7(0x609)],_0x1d402f[_0x53c1d7(0x2f5)]=_0x53c1d7(0x1255)+_0x10f24b[_0x53c1d7(0x11be)]+');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>'+_0x10f24b[_0x53c1d7(0x609)]+_0x53c1d7(0x215);const _0x20ed20=document[_0x53c1d7(0x28a)](_0x53c1d7(0x11f4));_0x20ed20[_0x53c1d7(0x82c)]=_0x53c1d7(0x465),_0x20ed20[_0x53c1d7(0x2f5)]='×',_0x20ed20[_0x53c1d7(0x5e1)]['display']=_0x53c1d7(0x3d9),_0x20ed20[_0x53c1d7(0x2fa)]=async _0x318990=>{const _0x1967cb=_0x53c1d7;_0x318990[_0x1967cb(0x20a)]();const _0x27018e=await _0x352ae9(_0x1967cb(0x585),_0x1967cb(0xcfe)+_0x10f24b['name']+_0x1967cb(0x13a7),{'confirmButtonClass':_0x1967cb(0x12bc)});_0x27018e&&(_0x5f3d1d['settings']['myAvatarLibrary'][_0x1967cb(0x888)](_0x2b5281,0x1),await _0x2c5bcf[_0x1967cb(0x547)][_0x1967cb(0xff5)](_0x5f3d1d),_0x4b511c());},_0x1d402f[_0x53c1d7(0x7b9)](_0x20ed20),_0x3eef91[_0x53c1d7(0x7b9)](_0x1d402f);});}async function _0x3f837f(){const _0x270364=_0x419fa8,_0x4e77d5=await _0xadb5df(_0x270364(0x11a7),'请为这个头像起个名字（例如：开心、哭泣）');if(!_0x4e77d5||!_0x4e77d5[_0x270364(0x3f1)]())return;const _0x181c31=await _0xadb5df(_0x270364(0x11a7),_0x270364(0xf6a),'',_0x270364(0x11be));if(!_0x181c31||!_0x181c31[_0x270364(0x3f1)]()[_0x270364(0xc8d)](_0x270364(0x34e))){alert('请输入有效的图片URL！');return;}const _0x5b6a13=_0x9ebf46[_0x270364(0x547)][_0x9ebf46[_0x270364(0x970)]];!_0x5b6a13['settings']['myAvatarLibrary']&&(_0x5b6a13[_0x270364(0x1131)][_0x270364(0xd7a)]=[]),_0x5b6a13[_0x270364(0x1131)][_0x270364(0xd7a)][_0x270364(0x668)]({'name':_0x4e77d5[_0x270364(0x3f1)](),'url':_0x181c31[_0x270364(0x3f1)]()}),await _0x2c5bcf[_0x270364(0x547)][_0x270364(0xff5)](_0x5b6a13),_0x4b511c();}async function _0x26575d(_0xe4ed37){const _0x3f8f68=_0x419fa8,_0x11892e=_0xe4ed37[_0x3f8f68(0x1070)][_0x3f8f68(0x1216)][0x0];if(!_0x11892e)return;const _0x5be43a=await new Promise(_0x580050=>{const _0x1b4f19=_0x3f8f68,_0x1d2e86=new FileReader();_0x1d2e86[_0x1b4f19(0x429)]=()=>_0x580050(_0x1d2e86[_0x1b4f19(0xceb)]),_0x1d2e86[_0x1b4f19(0xba5)](_0x11892e);}),_0x2ab197=await _0xadb5df(_0x3f8f68(0xe18),_0x3f8f68(0x126d));if(!_0x2ab197||!_0x2ab197[_0x3f8f68(0x3f1)]())return;const _0x587866=_0x9ebf46['chats'][_0x9ebf46[_0x3f8f68(0x970)]];!_0x587866[_0x3f8f68(0x1131)][_0x3f8f68(0xd7a)]&&(_0x587866[_0x3f8f68(0x1131)][_0x3f8f68(0xd7a)]=[]),_0x587866[_0x3f8f68(0x1131)][_0x3f8f68(0xd7a)][_0x3f8f68(0x668)]({'name':_0x2ab197[_0x3f8f68(0x3f1)](),'url':_0x5be43a}),await _0x2c5bcf['chats'][_0x3f8f68(0xff5)](_0x587866),_0x4b511c(),_0xe4ed37[_0x3f8f68(0x1070)][_0x3f8f68(0x1155)]=null;}async function _0x39c46b(_0x6f7f1){const _0x29327d=_0x419fa8,_0x30be4c=_0x9ebf46[_0x29327d(0x547)][_0x9ebf46[_0x29327d(0x970)]];if(!_0x30be4c)return;const _0x2a1b28=_0x6f7f1[_0x29327d(0x3f1)]()[_0x29327d(0x6c6)]('\x0a'),_0x2ca7d2=[],_0x5ec293=_0x29327d(0xc70);let _0x494454=0x0;for(const _0x2663d9 of _0x2a1b28){const _0x466bec=_0x2663d9[_0x29327d(0x3f1)]();if(!_0x466bec||_0x466bec[_0x29327d(0x930)](_0x29327d(0x34e))||_0x466bec[_0x29327d(0x930)]('填入'))continue;let _0x5e4e9a=null,_0x21674a=null;const _0x5ad483=_0x466bec[_0x29327d(0x12c2)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x5ad483)_0x5e4e9a=_0x5ad483[0x1],_0x21674a=_0x5ad483[0x2];else{const _0x470bb6=_0x466bec[_0x29327d(0x6c6)](/\s+/);_0x470bb6['length']>=0x2&&(_0x21674a=_0x470bb6[_0x29327d(0x3a0)](),_0x5e4e9a=_0x470bb6['join']('\x20'));}_0x5e4e9a&&_0x21674a&&_0x21674a[_0x29327d(0x930)]('.')?_0x2ca7d2[_0x29327d(0x668)]({'name':_0x5e4e9a,'url':_0x5ec293+_0x21674a}):_0x494454++;}if(_0x494454>0x0)await _0x1bff53(_0x29327d(0x44d),'有\x20'+_0x494454+_0x29327d(0xfb8));if(_0x2ca7d2[_0x29327d(0xa06)]>0x0){if(!_0x30be4c[_0x29327d(0x1131)][_0x29327d(0xd7a)])_0x30be4c['settings']['myAvatarLibrary']=[];_0x30be4c[_0x29327d(0x1131)][_0x29327d(0xd7a)][_0x29327d(0x668)](..._0x2ca7d2),await _0x2c5bcf[_0x29327d(0x547)][_0x29327d(0xff5)](_0x30be4c),_0x4b511c(),await _0x1bff53('导入成功',_0x29327d(0x876)+_0x2ca7d2['length']+'\x20个新头像！');}else _0x494454===0x0&&alert(_0x29327d(0xae6));}function _0xd8608e(){const _0x588bdd=_0x419fa8;document[_0x588bdd(0x9c8)](_0x588bdd(0x109f))[_0x588bdd(0x575)][_0x588bdd(0x30f)]('visible');}function _0x5c7cc5(){const _0xdf1ecc=_0x419fa8;if(!_0x9ebf46['activeChatId'])return;const _0x4e4548=_0x9ebf46['chats'][_0x9ebf46[_0xdf1ecc(0x970)]];document[_0xdf1ecc(0x9c8)]('group-avatar-library-title')[_0xdf1ecc(0xe24)]='“'+_0x4e4548[_0xdf1ecc(0x609)]+_0xdf1ecc(0x1144),_0x365b99(),document['getElementById']('group-avatar-library-modal')[_0xdf1ecc(0x575)][_0xdf1ecc(0x68e)](_0xdf1ecc(0xc3f));}function _0x365b99(){const _0x1e384a=_0x419fa8,_0x36feb4=document[_0x1e384a(0x9c8)]('group-avatar-library-grid');_0x36feb4[_0x1e384a(0x2f5)]='';const _0x3fba56=_0x9ebf46['chats'][_0x9ebf46['activeChatId']],_0x44191e=_0x3fba56[_0x1e384a(0x1131)][_0x1e384a(0xd86)]||[];if(_0x44191e[_0x1e384a(0xa06)]===0x0){_0x36feb4['innerHTML']=_0x1e384a(0x20e);return;}_0x44191e[_0x1e384a(0x591)]((_0x3e0150,_0x3d970c)=>{const _0x50520c=_0x1e384a,_0x43552b=document[_0x50520c(0x28a)]('div');_0x43552b[_0x50520c(0x82c)]='sticker-item',_0x43552b[_0x50520c(0x9f2)]=_0x3e0150[_0x50520c(0x609)],_0x43552b[_0x50520c(0x2f5)]=_0x50520c(0x1255)+_0x3e0150[_0x50520c(0x11be)]+');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>'+_0x3e0150[_0x50520c(0x609)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0xa5cdb5=document[_0x50520c(0x28a)]('div');_0xa5cdb5[_0x50520c(0x82c)]=_0x50520c(0x465),_0xa5cdb5[_0x50520c(0x2f5)]='×',_0xa5cdb5[_0x50520c(0x5e1)][_0x50520c(0x3c5)]=_0x50520c(0x3d9),_0xa5cdb5[_0x50520c(0x2fa)]=async _0x4d8b6d=>{const _0x2ea555=_0x50520c;_0x4d8b6d['stopPropagation']();const _0x1ab820=await _0x352ae9(_0x2ea555(0x585),_0x2ea555(0x805)+_0x3e0150[_0x2ea555(0x609)]+_0x2ea555(0x13a7),{'confirmButtonClass':_0x2ea555(0x12bc)});_0x1ab820&&(_0x3fba56['settings'][_0x2ea555(0xd86)][_0x2ea555(0x888)](_0x3d970c,0x1),await _0x2c5bcf[_0x2ea555(0x547)][_0x2ea555(0xff5)](_0x3fba56),_0x365b99());},_0x43552b['appendChild'](_0xa5cdb5),_0x36feb4[_0x50520c(0x7b9)](_0x43552b);});}async function _0x55f86b(){const _0x20e4f6=_0x419fa8,_0x44ef48=await _0xadb5df('添加头像',_0x20e4f6(0x131b));if(!_0x44ef48||!_0x44ef48['trim']())return;const _0x48949b=await _0xadb5df(_0x20e4f6(0x11a7),'请输入头像的图片URL','',_0x20e4f6(0x11be));if(!_0x48949b||!_0x48949b[_0x20e4f6(0x3f1)]()['startsWith'](_0x20e4f6(0x34e))){alert(_0x20e4f6(0xf0f));return;}const _0x4e76f5=_0x9ebf46[_0x20e4f6(0x547)][_0x9ebf46[_0x20e4f6(0x970)]];!_0x4e76f5[_0x20e4f6(0x1131)][_0x20e4f6(0xd86)]&&(_0x4e76f5[_0x20e4f6(0x1131)][_0x20e4f6(0xd86)]=[]),_0x4e76f5[_0x20e4f6(0x1131)][_0x20e4f6(0xd86)][_0x20e4f6(0x668)]({'name':_0x44ef48[_0x20e4f6(0x3f1)](),'url':_0x48949b[_0x20e4f6(0x3f1)]()}),await _0x2c5bcf[_0x20e4f6(0x547)][_0x20e4f6(0xff5)](_0x4e76f5),_0x365b99();}function _0x3640f8(){const _0x517367=_0x419fa8;document[_0x517367(0x9c8)]('group-avatar-library-modal')[_0x517367(0x575)][_0x517367(0x30f)](_0x517367(0xc3f));}async function _0x6df4a9(_0xb6f0ce){const _0x5216ba=_0x419fa8,_0x4a01df=_0x5216ba(0x878),_0x5d54bd=await _0xadb5df(_0x5216ba(0x1263),_0x4a01df,'','textarea');_0x5d54bd&&_0x5d54bd[_0x5216ba(0x3f1)]()&&await _0x1b2b50(_0xb6f0ce,_0x5d54bd);}async function _0x1b2b50(_0x420435,_0x36cd6a){const _0x4c9748=_0x419fa8,_0xd5d611=_0x9ebf46[_0x4c9748(0x547)][_0x9ebf46[_0x4c9748(0x970)]];if(!_0xd5d611)return;const _0xe809a=_0x36cd6a[_0x4c9748(0x3f1)]()[_0x4c9748(0x6c6)]('\x0a'),_0x7fc0fc=[],_0x305ef3=_0x4c9748(0xc70);let _0x177daf=0x0;for(const _0x1d7890 of _0xe809a){const _0x20cfdc=_0x1d7890[_0x4c9748(0x3f1)]();if(!_0x20cfdc||_0x20cfdc[_0x4c9748(0x930)]('http')||_0x20cfdc[_0x4c9748(0x930)]('填入'))continue;let _0x6219ce=null,_0x5770e1=null;const _0x5330e7=_0x20cfdc['match'](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x5330e7)_0x6219ce=_0x5330e7[0x1],_0x5770e1=_0x5330e7[0x2];else{const _0x462a1d=_0x20cfdc['split'](/\s+/);_0x462a1d[_0x4c9748(0xa06)]>=0x2&&(_0x5770e1=_0x462a1d[_0x4c9748(0x3a0)](),_0x6219ce=_0x462a1d[_0x4c9748(0x809)]('\x20'));}_0x6219ce&&_0x5770e1&&_0x5770e1[_0x4c9748(0x930)]('.')?_0x7fc0fc[_0x4c9748(0x668)]({'name':_0x6219ce,'url':_0x305ef3+_0x5770e1}):(_0x177daf++,console[_0x4c9748(0x453)]('批量导入格式错误，已跳过此行:',_0x20cfdc));}_0x177daf>0x0&&await _0x1bff53(_0x4c9748(0x44d),'有\x20'+_0x177daf+_0x4c9748(0x331));if(_0x7fc0fc[_0x4c9748(0xa06)]>0x0){if(_0x420435==='ai'){if(!_0xd5d611[_0x4c9748(0x1131)][_0x4c9748(0x295)])_0xd5d611[_0x4c9748(0x1131)][_0x4c9748(0x295)]=[];_0xd5d611[_0x4c9748(0x1131)]['aiAvatarLibrary']['push'](..._0x7fc0fc),await _0x2c5bcf[_0x4c9748(0x547)][_0x4c9748(0xff5)](_0xd5d611),_0x1386b6();}else{if(_0x420435===_0x4c9748(0x1016)){if(!_0xd5d611[_0x4c9748(0x1131)][_0x4c9748(0xd86)])_0xd5d611[_0x4c9748(0x1131)][_0x4c9748(0xd86)]=[];_0xd5d611[_0x4c9748(0x1131)][_0x4c9748(0xd86)][_0x4c9748(0x668)](..._0x7fc0fc),await _0x2c5bcf[_0x4c9748(0x547)][_0x4c9748(0xff5)](_0xd5d611),_0x365b99();}}await _0x1bff53(_0x4c9748(0x135e),_0x4c9748(0x876)+_0x7fc0fc[_0x4c9748(0xa06)]+_0x4c9748(0x1156));}else _0x177daf===0x0&&alert('没有找到可导入的内容。请检查您粘贴的格式是否正确。');}async function _0x24f1a8(){const _0x576ab2=_0x419fa8,_0x223ceb=await _0xadb5df(_0x576ab2(0x11a7),_0x576ab2(0x131b));if(!_0x223ceb||!_0x223ceb['trim']())return;const _0x74f71e=await _0xadb5df(_0x576ab2(0x11a7),'请输入头像的图片URL','',_0x576ab2(0x11be));if(!_0x74f71e||!_0x74f71e[_0x576ab2(0x3f1)]()[_0x576ab2(0xc8d)](_0x576ab2(0x34e))){alert(_0x576ab2(0xf0f));return;}const _0x57c096=_0x9ebf46[_0x576ab2(0x547)][_0x9ebf46[_0x576ab2(0x970)]];!_0x57c096[_0x576ab2(0x1131)][_0x576ab2(0xd86)]&&(_0x57c096[_0x576ab2(0x1131)]['groupAvatarLibrary']=[]),_0x57c096[_0x576ab2(0x1131)][_0x576ab2(0xd86)][_0x576ab2(0x668)]({'name':_0x223ceb[_0x576ab2(0x3f1)](),'url':_0x74f71e[_0x576ab2(0x3f1)]()}),await _0x2c5bcf[_0x576ab2(0x547)][_0x576ab2(0xff5)](_0x57c096),_0x365b99();}function _0x1971f8(_0xfcfb7){return new Promise(_0xecdd94=>{const _0x1b38f6=_0x3569,_0x2d1073=document[_0x1b38f6(0x9c8)](_0x1b38f6(0x49b)),_0x1819db=document[_0x1b38f6(0x9c8)]('chat-list-action-pin'),_0x1c2199=document[_0x1b38f6(0x9c8)](_0x1b38f6(0x431)),_0x52351c=document[_0x1b38f6(0x9c8)](_0x1b38f6(0xede));_0x1819db[_0x1b38f6(0xe24)]=_0xfcfb7[_0x1b38f6(0xfac)]?_0x1b38f6(0x7a9):_0x1b38f6(0x100a);const _0x3b1bed=_0x1819db[_0x1b38f6(0x75c)](!![]);_0x1819db[_0x1b38f6(0x127d)][_0x1b38f6(0x4d7)](_0x3b1bed,_0x1819db),_0x3b1bed['onclick']=()=>{const _0x2cd704=_0x1b38f6;_0x2d1073[_0x2cd704(0x575)]['remove'](_0x2cd704(0xc3f)),_0xecdd94(_0x2cd704(0xd91));};const _0x2207c1=_0x1c2199[_0x1b38f6(0x75c)](!![]);_0x1c2199[_0x1b38f6(0x127d)][_0x1b38f6(0x4d7)](_0x2207c1,_0x1c2199),_0x2207c1[_0x1b38f6(0x2fa)]=()=>{const _0x214685=_0x1b38f6;_0x2d1073[_0x214685(0x575)][_0x214685(0x30f)](_0x214685(0xc3f)),_0xecdd94('delete');};const _0x567d61=_0x52351c[_0x1b38f6(0x75c)](!![]);_0x52351c['parentNode'][_0x1b38f6(0x4d7)](_0x567d61,_0x52351c),_0x567d61[_0x1b38f6(0x2fa)]=()=>{_0x2d1073['classList']['remove']('visible'),_0xecdd94(null);},_0x2d1073[_0x1b38f6(0x575)][_0x1b38f6(0x68e)](_0x1b38f6(0xc3f));});}function _0x58c61c(){const _0x2a06cf=_0x419fa8,_0x583ad8=document[_0x2a06cf(0x9c8)](_0x2a06cf(0x3ed)),_0x103088=_0x9ebf46[_0x2a06cf(0x1383)]['cphoneWallpaper'];_0x103088?_0x583ad8[_0x2a06cf(0x5e1)]['backgroundImage']=_0x2a06cf(0x7fe)+_0x103088+')':_0x583ad8[_0x2a06cf(0x5e1)][_0x2a06cf(0x11d9)]='linear-gradient(135deg,\x20#f6d365,\x20#fda085)';}function _0x3f12a7(){const _0x130d9c=_0x419fa8;if(!_0x9ebf46[_0x130d9c(0x1383)][_0x130d9c(0xe9b)])return;for(const _0x126af9 in _0x9ebf46[_0x130d9c(0x1383)][_0x130d9c(0xe9b)]){const _0x38416a=document['getElementById']('cphone-icon-img-'+_0x126af9);_0x38416a&&(_0x38416a[_0x130d9c(0xbf4)]=_0x9ebf46[_0x130d9c(0x1383)][_0x130d9c(0xe9b)][_0x126af9]);}}function _0x585ab4(){const _0x69e483=_0x419fa8,_0x8ab7a0=document[_0x69e483(0x9c8)](_0x69e483(0x703));if(!_0x8ab7a0)return;_0x8ab7a0['innerHTML']='';const _0x1a43de={'qq':'QQ','album':'相册','browser':_0x69e483(0x58d),'taobao':'淘宝','memo':_0x69e483(0xdbb),'diary':'日记','amap':'高德地图','usage':_0x69e483(0xee6),'music':_0x69e483(0x10fa),'ephone':_0x69e483(0xa5a)};for(const _0x4fcd11 in _0x9ebf46[_0x69e483(0x1383)][_0x69e483(0xe9b)]){const _0x67784c=_0x9ebf46[_0x69e483(0x1383)]['cphoneAppIcons'][_0x4fcd11],_0x26824d=_0x1a43de[_0x4fcd11]||_0x69e483(0x4c3),_0x32e650=document[_0x69e483(0x28a)]('div');_0x32e650[_0x69e483(0x82c)]=_0x69e483(0x446),_0x32e650[_0x69e483(0xc9f)][_0x69e483(0x3b8)]=_0x4fcd11,_0x32e650[_0x69e483(0x2f5)]=_0x69e483(0xa61)+_0x67784c+_0x69e483(0xdf4)+_0x26824d+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x8ab7a0[_0x69e483(0x7b9)](_0x32e650);}}function _0x2ea916(){const _0x2f235d=_0x419fa8;if(!_0x9ebf46[_0x2f235d(0x1383)]['appIcons'])return;for(const _0x29deb1 in _0x9ebf46[_0x2f235d(0x1383)][_0x2f235d(0x11b3)]){const _0x4565ee=document['getElementById'](_0x2f235d(0xe2b)+_0x29deb1);_0x4565ee&&(_0x4565ee[_0x2f235d(0xbf4)]=_0x9ebf46['globalSettings']['appIcons'][_0x29deb1]);}}function _0x14c32f(){const _0x125e9b=_0x419fa8,_0x1aa564=document[_0x125e9b(0x9c8)]('icon-settings-grid');if(!_0x1aa564)return;_0x1aa564[_0x125e9b(0x2f5)]='';const _0x4cefce={'qq':'QQ','world-book':_0x125e9b(0x12b7),'wallpaper':_0x125e9b(0x1a2),'renderer':_0x125e9b(0x119a),'api-settings':_0x125e9b(0xbf9),'font':'字体','char-phone':_0x125e9b(0xcf3),'douban':_0x125e9b(0x13b4),'preset':'预设','tutorial':'教程','werewolf':_0x125e9b(0x342),'x':'X'};for(const _0x3bea93 in _0x9ebf46[_0x125e9b(0x1383)][_0x125e9b(0x11b3)]){const _0x3ae3d9=_0x9ebf46[_0x125e9b(0x1383)][_0x125e9b(0x11b3)][_0x3bea93],_0x4b3b99=_0x4cefce[_0x3bea93]||_0x125e9b(0xcf3),_0xbbd2c=document['createElement'](_0x125e9b(0x11f4));_0xbbd2c['className']=_0x125e9b(0x446),_0xbbd2c[_0x125e9b(0xc9f)][_0x125e9b(0x3b8)]=_0x3bea93,_0xbbd2c[_0x125e9b(0x2f5)]=_0x125e9b(0xa61)+_0x3ae3d9+_0x125e9b(0xdf4)+_0x4b3b99+_0x125e9b(0x7d3),_0x1aa564[_0x125e9b(0x7b9)](_0xbbd2c);}}function _0xbe97f8(_0x24ca52){const _0x1e6370=_0x419fa8;if(!_0x9ebf46[_0x1e6370(0x970)])return;const _0x2fa54a=_0x9ebf46[_0x1e6370(0x547)][_0x9ebf46[_0x1e6370(0x970)]];if(!_0x2fa54a||!_0x2fa54a[_0x1e6370(0x8b3)])return;const _0x38bf68=_0x2fa54a[_0x1e6370(0x8b3)][_0x1e6370(0xfc3)](_0x1289a5=>_0x1289a5[_0x1e6370(0x6b5)]===_0x24ca52);if(!_0x38bf68||_0x38bf68[_0x1e6370(0x12d9)]!==_0x1e6370(0x12a5)){console[_0x1e6370(0x1221)](_0x1e6370(0x4dd),_0x24ca52);return;}document[_0x1e6370(0x9c8)]('browser-title')[_0x1e6370(0xe24)]=_0x38bf68[_0x1e6370(0x545)]||'文章详情';const _0x175d16=document[_0x1e6370(0x9c8)](_0x1e6370(0x33f));_0x175d16[_0x1e6370(0x2f5)]=_0x1e6370(0x449)+(_0x38bf68[_0x1e6370(0x9f2)]||'无标题')+_0x1e6370(0xbba)+(_0x38bf68[_0x1e6370(0x545)]||'未知')+_0x1e6370(0xc29)+(_0x38bf68['content']||_0x1e6370(0x1309))[_0x1e6370(0x459)](/\n/g,'</p><p>')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xe5834e(_0x1e6370(0xdb8));}function _0x2bb5c6(){const _0x1a9f8a=_0x419fa8;_0xe5834e(_0x1a9f8a(0x504));}function _0x2bb5c6(){_0xe5834e('chat-interface-screen');}function _0x3ed193(){const _0x37181b=_0x419fa8;if(!_0x9ebf46['activeChatId'])return;document[_0x37181b(0x9c8)](_0x37181b(0x1052))[_0x37181b(0x1155)]='',document[_0x37181b(0x9c8)](_0x37181b(0x9ae))['value']='',document['getElementById'](_0x37181b(0x1027))[_0x37181b(0x1155)]='',document[_0x37181b(0x9c8)](_0x37181b(0x107b))['value']='',document[_0x37181b(0x9c8)]('share-link-modal')['classList'][_0x37181b(0x68e)](_0x37181b(0xc3f));}async function _0x20fb6b(){const _0x124a21=_0x419fa8;if(!_0x9ebf46[_0x124a21(0x970)])return;const _0x37c253=document[_0x124a21(0x9c8)]('link-title-input')[_0x124a21(0x1155)]['trim']();if(!_0x37c253){alert('标题是必填项哦！');return;}const _0x1df512=document[_0x124a21(0x9c8)](_0x124a21(0x9ae))[_0x124a21(0x1155)]['trim'](),_0x410135=document[_0x124a21(0x9c8)](_0x124a21(0x1027))[_0x124a21(0x1155)][_0x124a21(0x3f1)](),_0x343222=document[_0x124a21(0x9c8)](_0x124a21(0x107b))[_0x124a21(0x1155)]['trim'](),_0x184d5a=_0x9ebf46[_0x124a21(0x547)][_0x9ebf46[_0x124a21(0x970)]],_0x1e0137={'role':_0x124a21(0x586),'type':_0x124a21(0x12a5),'timestamp':Date[_0x124a21(0x9b7)](),'title':_0x37c253,'description':_0x1df512,'source_name':_0x410135,'content':_0x343222,'thumbnail_url':null};_0x184d5a[_0x124a21(0x8b3)][_0x124a21(0x668)](_0x1e0137),await _0x2c5bcf[_0x124a21(0x547)][_0x124a21(0xff5)](_0x184d5a),_0xc4e879(_0x1e0137,_0x184d5a),_0x394b2c(),document[_0x124a21(0x9c8)](_0x124a21(0x5f2))[_0x124a21(0x575)]['remove'](_0x124a21(0xc3f));}function _0x499cd0(_0x14d0f2,_0x14327e){const _0x11a86e=_0x419fa8;if(!_0x14327e||!_0x14327e['id'])return[];const _0x1b2e46=_0x14327e[_0x11a86e(0x7b1)],_0x344d54=_0x14327e['id'];return _0x14d0f2[_0x11a86e(0x401)](_0x27e195=>{const _0x259fbe=_0x11a86e;if(_0x27e195[_0x259fbe(0x61c)]===_0x259fbe(0x586)){if(_0x27e195[_0x259fbe(0x719)]&&_0x27e195[_0x259fbe(0x719)][_0x259fbe(0xa06)]>0x0)return _0x1b2e46&&_0x27e195[_0x259fbe(0x719)][_0x259fbe(0x930)](_0x1b2e46);return!![];}if(String(_0x27e195['authorId'])[_0x259fbe(0xc8d)](_0x259fbe(0x2e7))){if(Array['isArray'](_0x27e195[_0x259fbe(0xe5a)]))return _0x27e195[_0x259fbe(0xe5a)][_0x259fbe(0x930)](_0x344d54);return![];}const _0x5f10f1=_0x9ebf46[_0x259fbe(0x547)][_0x27e195['authorId']];if(!_0x5f10f1)return![];const _0x5f31c4=_0x5f10f1['groupId'],_0x2bef69=_0x5f31c4&&_0x1b2e46&&_0x5f31c4===_0x1b2e46,_0x17f9cf=!_0x5f31c4&&!_0x1b2e46;return _0x2bef69||_0x17f9cf;});}function _0x5adfc0(_0x5265cd){const _0x12a2ad=_0x419fa8,_0xf6a047=document[_0x12a2ad(0x9c8)](_0x12a2ad(0x6fb)),_0x1ed748=document[_0x12a2ad(0x9c8)]('theme-toggle-switch'),_0x13eb84=_0x5265cd===_0x12a2ad(0xaf4);_0xf6a047[_0x12a2ad(0x575)][_0x12a2ad(0x1c3)](_0x12a2ad(0x292),_0x13eb84),_0x1ed748&&(_0x1ed748['checked']=_0x13eb84),localStorage[_0x12a2ad(0xa65)](_0x12a2ad(0x864),_0x5265cd);}function _0x14a17e(){const _0x13467b=_0x419fa8,_0x3cca8e=document[_0x13467b(0x9c8)](_0x13467b(0x9e8)),_0x37c6b8=_0x3cca8e[_0x13467b(0x1ec)]?_0x13467b(0xaf4):_0x13467b(0xfa2);_0x5adfc0(_0x37c6b8);}function _0x31649c(){const _0x188df9=_0x419fa8;if(!_0x9ebf46[_0x188df9(0x970)])return;_0x13c188(),_0xe5834e('long-term-memory-screen');}function _0x13c188(){const _0x17b2e1=_0x419fa8,_0x58cec5=document['getElementById']('memory-list-container'),_0x198622=_0x9ebf46[_0x17b2e1(0x547)][_0x9ebf46[_0x17b2e1(0x970)]];_0x58cec5[_0x17b2e1(0x2f5)]='';let _0x120f87=[];_0x198622['isGroup']?_0x198622[_0x17b2e1(0xd3e)][_0x17b2e1(0x591)](_0x3dcd93=>{const _0x1c26d4=_0x17b2e1,_0x40e413=_0x9ebf46['chats'][_0x3dcd93['id']];if(_0x40e413&&_0x40e413[_0x1c26d4(0x323)]){const _0x31aace=_0x40e413[_0x1c26d4(0x323)][_0x1c26d4(0xa3b)](_0x1fe191=>({..._0x1fe191,'authorName':_0x3dcd93['groupNickname'],'authorChatId':_0x3dcd93['id']}));_0x120f87['push'](..._0x31aace);}}):_0x198622[_0x17b2e1(0x323)]&&(_0x120f87=_0x198622['longTermMemory']['map'](_0x238e3a=>({..._0x238e3a,'authorName':_0x198622[_0x17b2e1(0x609)],'authorChatId':_0x198622['id']})));if(_0x120f87[_0x17b2e1(0xa06)]===0x0){_0x58cec5[_0x17b2e1(0x2f5)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>';return;}_0x120f87[_0x17b2e1(0x66b)]((_0x5754f2,_0x4aebc7)=>_0x4aebc7[_0x17b2e1(0x6b5)]-_0x5754f2[_0x17b2e1(0x6b5)]),_0x120f87['forEach']((_0x55e454,_0x4a1da8)=>{const _0x4ec561=_0x17b2e1,_0x2ae9e6=document['createElement'](_0x4ec561(0x11f4));_0x2ae9e6[_0x4ec561(0x82c)]=_0x4ec561(0x21a),_0x2ae9e6[_0x4ec561(0x5e1)][_0x4ec561(0x8e4)]=_0x4ec561(0x108b),_0x2ae9e6[_0x4ec561(0x2f5)]=_0x4ec561(0x630)+_0x55e454[_0x4ec561(0xa2c)]+_0x4ec561(0x68d)+_0x55e454[_0x4ec561(0x53b)][_0x4ec561(0x459)](/\n/g,_0x4ec561(0x10d9))+_0x4ec561(0x8c9)+_0x55e454['authorChatId']+_0x4ec561(0x10ed)+_0x55e454['timestamp']+_0x4ec561(0x10e9)+_0x55e454[_0x4ec561(0x497)]+_0x4ec561(0x10ed)+_0x55e454[_0x4ec561(0x6b5)]+'\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x58cec5['appendChild'](_0x2ae9e6);});}async function _0x115c29(){const _0xc155b=_0x419fa8,_0x251846=_0x9ebf46[_0xc155b(0x547)][_0x9ebf46[_0xc155b(0x970)]];if(!_0x251846)return;let _0x4fab9f=_0x251846;if(_0x251846['isGroup']){const _0x14a2c9=_0x251846['members'][_0xc155b(0xa3b)](_0x67f2b9=>({'text':'为“'+_0x67f2b9['groupNickname']+_0xc155b(0x9fe),'value':_0x67f2b9['id']})),_0x291ea5=await _0xb8c832(_0xc155b(0x12d1),_0x14a2c9);if(!_0x291ea5)return;_0x4fab9f=_0x9ebf46['chats'][_0x291ea5];if(!_0x4fab9f){alert(_0xc155b(0xeaa));return;}}const _0x35d8be=await _0xadb5df('为“'+_0x4fab9f[_0xc155b(0x609)]+_0xc155b(0x9fe),_0xc155b(0x9b4),'',_0xc155b(0x11f9));if(_0x35d8be&&_0x35d8be['trim']()){if(!_0x4fab9f[_0xc155b(0x323)])_0x4fab9f[_0xc155b(0x323)]=[];_0x4fab9f[_0xc155b(0x323)][_0xc155b(0x668)]({'content':_0x35d8be['trim'](),'timestamp':Date[_0xc155b(0x9b7)](),'source':_0xc155b(0xf8a)}),await _0x2c5bcf[_0xc155b(0x547)][_0xc155b(0xff5)](_0x4fab9f),_0x13c188();}}async function _0xb928f5(_0x2d763d,_0x40dc41){const _0x12e937=_0x419fa8,_0x14897f=_0x9ebf46[_0x12e937(0x547)][_0x2d763d];if(!_0x14897f||!_0x14897f['longTermMemory'])return;const _0x326c17=_0x14897f[_0x12e937(0x323)][_0x12e937(0x684)](_0x37909b=>_0x37909b['timestamp']===_0x40dc41);if(_0x326c17===-0x1)return;const _0x47c712=_0x14897f['longTermMemory'][_0x326c17],_0x3e5e55=await _0xadb5df(_0x12e937(0x780),_0x12e937(0x254),_0x47c712['content'],_0x12e937(0x11f9));_0x3e5e55&&_0x3e5e55[_0x12e937(0x3f1)]()&&(_0x47c712[_0x12e937(0x53b)]=_0x3e5e55[_0x12e937(0x3f1)](),await _0x2c5bcf[_0x12e937(0x547)]['put'](_0x14897f),_0x13c188());}async function _0x10a005(_0xa6a617,_0x4b4a1b){const _0x3254ea=_0x419fa8,_0x6b5a4=await _0x352ae9(_0x3254ea(0x115b),_0x3254ea(0x42a),{'confirmButtonClass':'btn-danger'});if(_0x6b5a4){const _0x1ad937=_0x9ebf46['chats'][_0xa6a617];if(!_0x1ad937||!_0x1ad937[_0x3254ea(0x323)])return;_0x1ad937[_0x3254ea(0x323)]=_0x1ad937[_0x3254ea(0x323)][_0x3254ea(0x401)](_0xe7c2e8=>_0xe7c2e8['timestamp']!==_0x4b4a1b),await _0x2c5bcf[_0x3254ea(0x547)]['put'](_0x1ad937),_0x13c188();}}async function _0x483fba(){const _0x16ef06=_0x419fa8,_0x21c123=await _0x352ae9(_0x16ef06(0x10c7),_0x16ef06(0x8da));_0x21c123&&await _0x37d8af(_0x9ebf46[_0x16ef06(0x970)],!![]);}async function _0x3fd0d9(_0xac25a8){const _0x43239e=_0x419fa8,_0x26d1d2=_0x9ebf46[_0x43239e(0x547)][_0xac25a8];if(!_0x26d1d2||!_0x26d1d2['settings'][_0x43239e(0x10df)])return;const _0x28021d=_0x26d1d2['lastMemorySummaryTimestamp']||0x0,_0x567db0=_0x26d1d2[_0x43239e(0x8b3)][_0x43239e(0x401)](_0x2bf9d9=>_0x2bf9d9[_0x43239e(0x6b5)]>_0x28021d&&!_0x2bf9d9[_0x43239e(0xc62)]);_0x567db0['length']>=_0x26d1d2[_0x43239e(0x1131)][_0x43239e(0x874)]&&(console[_0x43239e(0x283)]('达到自动总结阈值\x20('+_0x567db0['length']+'/'+_0x26d1d2['settings'][_0x43239e(0x874)]+_0x43239e(0x85e)),await _0x37d8af(_0xac25a8));}async function _0x378e3f(_0x167434,_0x5a3023){const _0x384f06=_0x419fa8,_0x2711c2=_0x9ebf46['chats'][_0x167434];if(!_0x2711c2||!_0x5a3023)throw new Error(_0x384f06(0xf35));const _0x58d06a=_0x9ebf46['qzoneSettings']['nickname']||'用户';let _0x442d40,_0x19c787=_0x2711c2;const _0x829c55=new Date()[_0x384f06(0xd23)](_0x384f06(0x101b),{'year':'numeric','month':'long','day':_0x384f06(0xa74)});if(_0x2711c2[_0x384f06(0x11e4)]){let _0x9a85e9=null;_0x3085d5[_0x384f06(0x1183)]&&(_0x9a85e9=_0x2711c2['members'][_0x384f06(0xfc3)](_0x1409d6=>_0x1409d6['originalName']===_0x3085d5[_0x384f06(0x1183)]));!_0x9a85e9&&(_0x9a85e9=_0x2711c2['members'][_0x384f06(0xfc3)](_0x7db2df=>_0x7db2df['id']!==_0x384f06(0x586)&&_0x3085d5['participants'][_0x384f06(0x10b2)](_0x2299dc=>_0x2299dc['id']===_0x7db2df['id'])));!_0x9a85e9&&(_0x9a85e9=_0x2711c2['members']['find'](_0x552f79=>_0x552f79['id']!=='user'));if(!_0x9a85e9)throw new Error(_0x384f06(0x10e5));const _0x322df2=_0x9ebf46[_0x384f06(0x547)][_0x9a85e9['id']];if(!_0x322df2)throw new Error(_0x384f06(0xf70)+_0x9a85e9['groupNickname']+_0x384f06(0x922));const _0x469edc=_0x2711c2[_0x384f06(0x1131)][_0x384f06(0x1151)]||_0x384f06(0xe1e);_0x442d40=_0x384f06(0x8dc)+_0x9a85e9['originalName']+_0x384f06(0xcf4)+_0x58d06a+_0x384f06(0xe73)+_0x829c55+'**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是'+_0x829c55+_0x384f06(0x349)+_0x322df2['settings'][_0x384f06(0xae3)]+_0x384f06(0x1119)+_0x469edc+_0x384f06(0x987)+_0x5a3023+'\x0a\x0a现在，请以“'+_0x9a85e9[_0x384f06(0x1071)]+'”的身份，开始你的客观总结。',_0x19c787=_0x322df2;}else _0x442d40='\x0a#\x20你的任务\x0a你就是角色“'+_0x2711c2['originalName']+'”。请你回顾一下刚才和“'+_0x58d06a+'”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x829c55+_0x384f06(0x998)+_0x829c55+_0x384f06(0x2e2)+_0x2711c2[_0x384f06(0x1131)]['aiPersona']+_0x384f06(0x1119)+_0x2711c2[_0x384f06(0x1131)][_0x384f06(0x1151)]+_0x384f06(0xf6b)+_0x5a3023+_0x384f06(0x4c4)+_0x2711c2['originalName']+_0x384f06(0x8a6);try{const _0x466e97=_0x9ebf46[_0x384f06(0x4de)][_0x384f06(0x797)]&&_0x9ebf46[_0x384f06(0x4de)][_0x384f06(0xc0c)]&&_0x9ebf46[_0x384f06(0x4de)][_0x384f06(0x62f)],{proxyUrl:_0x380e96,apiKey:_0xac9e0,model:_0x146671}=_0x466e97?{'proxyUrl':_0x9ebf46[_0x384f06(0x4de)]['secondaryProxyUrl'],'apiKey':_0x9ebf46[_0x384f06(0x4de)][_0x384f06(0xc0c)],'model':_0x9ebf46[_0x384f06(0x4de)]['secondaryModel']}:_0x9ebf46['apiConfig'];if(!_0x380e96||!_0xac9e0||!_0x146671)throw new Error(_0x384f06(0x1ac));let _0x21db21=_0x380e96[_0x384f06(0x930)](_0x384f06(0xb23)),_0xefc557=_0x2e5c04(_0x146671,_0xac9e0,_0x442d40,[{'role':_0x384f06(0x586),'content':_0x384f06(0xb85)}]);const _0x42f25f=_0x21db21?await fetch(_0xefc557[_0x384f06(0x11be)],_0xefc557[_0x384f06(0x100d)]):await fetch(_0x380e96+_0x384f06(0x1090),{'method':_0x384f06(0x116f),'headers':{'Content-Type':_0x384f06(0x698),'Authorization':_0x384f06(0x84a)+_0xac9e0},'body':JSON[_0x384f06(0xf1e)]({'model':_0x146671,'messages':[{'role':_0x384f06(0xb64),'content':_0x442d40},{'role':'user','content':_0x384f06(0xb85)}],'temperature':0.1})});if(!_0x42f25f['ok']){const _0xb85d57=await _0x42f25f[_0x384f06(0x5dd)]()[_0x384f06(0xd7f)](()=>({'error':{'message':_0x42f25f[_0x384f06(0x399)]}}));throw new Error(_0x384f06(0xe1a)+_0x42f25f[_0x384f06(0xebd)]+'\x20-\x20'+_0xb85d57[_0x384f06(0x1221)][_0x384f06(0x86e)]);}const _0x533c5f=await _0x42f25f[_0x384f06(0x5dd)]();let _0x5334f7=_0x21db21?getGeminiResponseText(_0x533c5f):_0x533c5f[_0x384f06(0xfd2)][0x0][_0x384f06(0x86e)][_0x384f06(0x53b)];_0x5334f7=_0x5334f7[_0x384f06(0x459)](/^```json\s*/,'')[_0x384f06(0x459)](/```$/,'')[_0x384f06(0x3f1)]();const _0x1edd49=JSON[_0x384f06(0x907)](_0x5334f7);if(_0x1edd49[_0x384f06(0xc48)]&&_0x1edd49[_0x384f06(0xc48)]['trim']()){const _0x15bcc9={'content':'(在那次'+(_0x2711c2[_0x384f06(0x11e4)]?'群聊':'')+'通话中，'+_0x1edd49[_0x384f06(0xc48)][_0x384f06(0x3f1)]()+')','timestamp':Date[_0x384f06(0x9b7)](),'source':_0x2711c2[_0x384f06(0x11e4)]?_0x384f06(0x94d):_0x384f06(0x1257)};if(!_0x19c787[_0x384f06(0x323)])_0x19c787['longTermMemory']=[];return _0x19c787['longTermMemory'][_0x384f06(0x668)](_0x15bcc9),await _0x2c5bcf[_0x384f06(0x547)]['put'](_0x19c787),console['log'](_0x384f06(0x127f)+_0x19c787[_0x384f06(0x609)]+_0x384f06(0x530)),!![];}else throw new Error(_0x384f06(0x9af));}catch(_0x435528){console[_0x384f06(0x1221)](_0x384f06(0xb80),_0x435528);throw _0x435528;}}function _0x3f7c0d(_0x5197a9){const _0x50ebcb=_0x419fa8,_0x136c70=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么',_0x50ebcb(0xca4),'哪个','一些','这个','那个','还有']),_0x366844=_0x5197a9['match'](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x1b2178=new Map();let _0x368d59=0x0;_0x366844[_0x50ebcb(0x591)](_0x58d7cd=>{const _0xc5f4b9=_0x50ebcb;if(_0x58d7cd['length']>0x1&&!_0x136c70[_0xc5f4b9(0xd97)](_0x58d7cd)){const _0x121451=(_0x1b2178[_0xc5f4b9(0xdf9)](_0x58d7cd)||0x0)+0x1;_0x1b2178[_0xc5f4b9(0xe36)](_0x58d7cd,_0x121451);if(_0x121451>_0x368d59)_0x368d59=_0x121451;}});const _0x37c7c1=[],_0x75c975=[],_0x213005=_0x368d59*0.9,_0x4e7910=_0x368d59*0.6;_0x1b2178[_0x50ebcb(0x591)]((_0x2a3980,_0x3dbeb1)=>{if(_0x2a3980>=_0x213005)_0x37c7c1['push'](_0x3dbeb1);else _0x2a3980>=_0x4e7910&&_0x75c975['push'](_0x3dbeb1);});const _0x4b76bc=new Set(_0x37c7c1),_0x27e5a5=_0x75c975[_0x50ebcb(0x401)](_0x2eaeb2=>!_0x4b76bc[_0x50ebcb(0xd97)](_0x2eaeb2))['slice'](0x0,0x5);return{'coreKeywords':_0x37c7c1[_0x50ebcb(0x1044)](0x0,0x3),'situationalKeywords':_0x27e5a5};}function _0xbdd100(_0x491853,_0x1efb52,_0x49df69){const _0x4ade49=_0x419fa8;let _0x56f3af;_0x49df69===_0x4ade49(0x658)?_0x56f3af=Date[_0x4ade49(0x9b7)]()-_0x1efb52*0x3c*0x3c*0x3e8:_0x56f3af=Date['now']()-_0x1efb52*0x18*0x3c*0x3c*0x3e8;const _0x28464b=_0x491853[_0x4ade49(0x8b3)][_0x4ade49(0x401)](_0x29ee9f=>_0x29ee9f['timestamp']>_0x56f3af&&!_0x29ee9f['isHidden']);if(_0x28464b[_0x4ade49(0xa06)]<0x3)return'';const _0x7f9e9e=_0x28464b['map'](_0x4a1571=>{const _0x3ffe15=_0x4ade49;if(typeof _0x4a1571[_0x3ffe15(0x53b)]===_0x3ffe15(0xe56))return _0x4a1571[_0x3ffe15(0x53b)];if(_0x4a1571['type']===_0x3ffe15(0x10c1))return _0x4a1571['content'];if(_0x4a1571[_0x3ffe15(0x12d9)]===_0x3ffe15(0xc91))return(_0x4a1571[_0x3ffe15(0xc2e)]||'')+'\x20'+(_0x4a1571['description']||'');return'';})[_0x4ade49(0x809)]('\x20'),_0x2a5c52=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0x1a2a83=_0x7f9e9e[_0x4ade49(0x12c2)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x133591=new Map();_0x1a2a83[_0x4ade49(0x591)](_0x4ed019=>{const _0x1f2d1a=_0x4ade49;_0x4ed019['length']>0x1&&!_0x2a5c52[_0x1f2d1a(0xd97)](_0x4ed019)&&_0x133591['set'](_0x4ed019,(_0x133591['get'](_0x4ed019)||0x0)+0x1);});const _0x5c424e=[..._0x133591[_0x4ade49(0x1231)]()][_0x4ade49(0x66b)]((_0x3fcb21,_0x52f320)=>_0x52f320[0x1]-_0x3fcb21[0x1])[_0x4ade49(0xa3b)](_0x412fc8=>_0x412fc8[0x0]);if(_0x5c424e[_0x4ade49(0xa06)]===0x0)return'';let _0x2034c1;return _0x49df69==='hours'?_0x2034c1='最近'+_0x1efb52+_0x4ade49(0xcba):_0x1efb52===0x1?_0x2034c1=_0x4ade49(0x12e1):_0x2034c1='最近'+_0x1efb52+_0x4ade49(0x8a3),'\x0a-\x20**'+_0x2034c1+_0x4ade49(0x816)+_0x5c424e[_0x4ade49(0x1044)](0x0,0x3)[_0x4ade49(0x809)]('、\x20')+_0x4ade49(0x94c);}function _0x11c6db(_0x1c76bb){const _0x42d552=_0x419fa8;if(!_0x1c76bb||typeof _0x1c76bb!==_0x42d552(0xe56))return null;const _0x233817=_0x1c76bb[_0x42d552(0x459)](/^```json\s*/,'')[_0x42d552(0x459)](/```$/,'')[_0x42d552(0x3f1)](),_0x234a2e=_0x233817[_0x42d552(0x12c2)](/{[\s\S]*}/);if(_0x234a2e)try{const _0x1ffb45=JSON[_0x42d552(0x907)](_0x234a2e[0x0]);return console[_0x42d552(0x283)]('容错解析：策略1成功\x20(找到并解析了完整的JSON对象)'),_0x1ffb45;}catch(_0x399d30){console[_0x42d552(0x453)]('容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...');}const _0x1440c8=_0x233817[_0x42d552(0x12c2)](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0x1440c8&&_0x1440c8[0x1])return console[_0x42d552(0x283)](_0x42d552(0x68a)),{'summary':_0x1440c8[0x1]['replace'](/\\"/g,'\x22')};if(_0x233817)return console[_0x42d552(0x283)](_0x42d552(0xf90)),{'summary':_0x233817};return null;}async function _0x4975f9(_0xbfcc28){const _0x46154=_0x419fa8;let _0xa318a6=_0x9ebf46[_0x46154(0x547)][_0xbfcc28];if(!_0xa318a6)return;let _0x5b0f51=_0xa318a6;if(_0xa318a6[_0x46154(0x11e4)]){const _0x3ed1c6=_0xa318a6[_0x46154(0xd3e)][_0x46154(0xa3b)](_0x2d85df=>{const _0x1b9aa2=_0x46154,_0x2f2322=_0x9ebf46['chats'][_0x2d85df['id']];if(_0x2f2322&&_0x2f2322[_0x1b9aa2(0x323)]&&_0x2f2322[_0x1b9aa2(0x323)]['length']>=0x2)return{'text':_0x1b9aa2(0xece)+_0x2d85df[_0x1b9aa2(0x1132)]+'”的记忆\x20('+_0x2f2322[_0x1b9aa2(0x323)][_0x1b9aa2(0xa06)]+'条)','value':_0x2d85df['id']};return null;})[_0x46154(0x401)](Boolean);if(_0x3ed1c6[_0x46154(0xa06)]===0x0){alert(_0x46154(0xddc));return;}const _0x24cf7e=await _0xb8c832(_0x46154(0x4dc),_0x3ed1c6);if(!_0x24cf7e)return;_0x5b0f51=_0x9ebf46['chats'][_0x24cf7e];}if(!_0x5b0f51[_0x46154(0x323)]||_0x5b0f51[_0x46154(0x323)][_0x46154(0xa06)]<0x2){alert('“'+_0x5b0f51[_0x46154(0x609)]+_0x46154(0x50f));return;}const _0x38fe63=_0x5b0f51[_0x46154(0x323)][_0x46154(0xa06)],_0x4072cc=await _0xb8c832(_0x46154(0x7f2),[{'text':'全部记忆\x20('+_0x38fe63+'条)','value':_0x46154(0xd0a)},{'text':_0x46154(0x9bb),'value':'20'},{'text':_0x46154(0x336),'value':'50'},{'text':_0x46154(0x123d),'value':_0x46154(0x710)},{'text':'自定义数量...','value':_0x46154(0x13c6)}]['filter'](_0x54e196=>_0x54e196[_0x46154(0x1155)]==='all'||_0x54e196[_0x46154(0x1155)]==='custom'||parseInt(_0x54e196[_0x46154(0x1155)])<_0x38fe63));if(_0x4072cc===null)return;let _0x2a8c32,_0x198674=_0x38fe63;if(_0x4072cc===_0x46154(0xd0a))_0x2a8c32=[..._0x5b0f51[_0x46154(0x323)]];else{if(_0x4072cc===_0x46154(0x13c6)){const _0x39a948=await _0xadb5df('自定义数量','请输入要精炼的最近记忆条数\x20(最多\x20'+_0x38fe63+_0x46154(0x1bd));if(_0x39a948===null)return;const _0x5648f8=parseInt(_0x39a948);if(isNaN(_0x5648f8)||_0x5648f8<0x2||_0x5648f8>_0x38fe63){alert('请输入一个\x202\x20到\x20'+_0x38fe63+'\x20之间的有效数字。');return;}_0x198674=_0x5648f8,_0x2a8c32=_0x5b0f51['longTermMemory']['slice'](-_0x198674);}else _0x198674=parseInt(_0x4072cc),_0x198674>=_0x38fe63?(_0x2a8c32=[..._0x5b0f51[_0x46154(0x323)]],_0x198674=_0x38fe63):_0x2a8c32=_0x5b0f51[_0x46154(0x323)][_0x46154(0x1044)](-_0x198674);}const _0x1be125=await _0xadb5df(_0x46154(0x1cf),_0x46154(0x126c),'150');if(_0x1be125===null)return;const _0x3310d2=parseInt(_0x1be125);if(isNaN(_0x3310d2)||_0x3310d2<0x14){alert(_0x46154(0x187));return;}const _0x9db3fd=await _0x352ae9(_0x46154(0x69d),_0x46154(0xea4)+_0x198674+_0x46154(0xdaf)+_0x3310d2+'\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？',{'confirmButtonClass':_0x46154(0x12bc),'confirmText':_0x46154(0xf9c)});if(!_0x9db3fd)return;const _0x150ef0=_0x2a8c32[_0x46154(0xa3b)](_0x407a8f=>'-\x20'+_0x407a8f[_0x46154(0x53b)])['join']('\x0a'),_0x3bb3b3=_0x9ebf46[_0x46154(0x32c)][_0x46154(0x5b7)]||'用户',_0x5a8982=new Date()['toLocaleDateString']('zh-CN',{'year':_0x46154(0xa74),'month':_0x46154(0xd72),'day':_0x46154(0xa74)}),_0x298ed0='\x0a#\x20你的任务\x0a你就是角色“'+_0x5b0f51[_0x46154(0x1071)]+_0x46154(0x5a3)+_0x3bb3b3+_0x46154(0xb0a)+_0x5a8982+_0x46154(0xad5)+_0x5a8982+_0x46154(0x97d)+_0x3310d2+_0x46154(0x2cf)+_0x5b0f51['settings']['aiPersona']+_0x46154(0x1119)+_0x5b0f51[_0x46154(0x1131)][_0x46154(0x1151)]+_0x46154(0x105e)+_0x150ef0+_0x46154(0x4c4)+_0x5b0f51[_0x46154(0x1071)]+_0x46154(0x345);await _0x1bff53(_0x46154(0x7a4),_0x46154(0x806));try{const _0x368484=_0x9ebf46[_0x46154(0x4de)]['secondaryProxyUrl']&&_0x9ebf46[_0x46154(0x4de)][_0x46154(0xc0c)]&&_0x9ebf46[_0x46154(0x4de)][_0x46154(0x62f)],{proxyUrl:_0x4542d1,apiKey:_0x518017,model:_0x17f141}=_0x368484?{'proxyUrl':_0x9ebf46[_0x46154(0x4de)][_0x46154(0x797)],'apiKey':_0x9ebf46[_0x46154(0x4de)][_0x46154(0xc0c)],'model':_0x9ebf46[_0x46154(0x4de)][_0x46154(0x62f)]}:_0x9ebf46['apiConfig'];if(!_0x4542d1||!_0x518017||!_0x17f141)throw new Error('请先在API设置中配置好（主或副）API以进行总结。');let _0xf507ad=_0x4542d1[_0x46154(0x930)]('generativelanguage'),_0x5efb9e=_0x2e5c04(_0x17f141,_0x518017,_0x298ed0,[{'role':_0x46154(0x586),'content':_0x46154(0xabd)}]);const _0x3cb534=_0xf507ad?await fetch(_0x5efb9e[_0x46154(0x11be)],_0x5efb9e[_0x46154(0x100d)]):await fetch(_0x4542d1+_0x46154(0x1090),{'method':'POST','headers':{'Content-Type':_0x46154(0x698),'Authorization':'Bearer\x20'+_0x518017},'body':JSON[_0x46154(0xf1e)]({'model':_0x17f141,'messages':[{'role':'system','content':_0x298ed0},{'role':_0x46154(0x586),'content':_0x46154(0xabd)}],'temperature':0.2})});if(!_0x3cb534['ok'])throw new Error(_0x46154(0x8ab)+_0x3cb534[_0x46154(0x399)]);const _0x47c9f9=await _0x3cb534[_0x46154(0x5dd)]();let _0x1a38e1=_0xf507ad?getGeminiResponseText(_0x47c9f9):_0x47c9f9[_0x46154(0xfd2)][0x0]['message'][_0x46154(0x53b)];const _0x3df7f7=_0x11c6db(_0x1a38e1);if(_0x3df7f7&&_0x3df7f7['summary']&&typeof _0x3df7f7['summary']===_0x46154(0xe56)&&_0x3df7f7['summary']['trim']()){const _0x5b9f3d=await _0x352ae9('精炼完成，请确认',_0x46154(0x979)+_0x198674+_0x46154(0xa68)+_0x3df7f7[_0x46154(0xc48)][_0x46154(0x3f1)]()+_0x46154(0x801),{'confirmText':'确认替换','cancelText':'保留旧的','confirmButtonClass':_0x46154(0x12bc)});if(_0x5b9f3d){const _0x2db94c={'content':_0x3df7f7['summary']['trim'](),'timestamp':Date[_0x46154(0x9b7)](),'source':_0x46154(0xce6)},_0x1f8898=_0x38fe63-_0x198674,_0x166d04=_0x1f8898>0x0?_0x5b0f51[_0x46154(0x323)][_0x46154(0x1044)](0x0,_0x1f8898):[];_0x5b0f51['longTermMemory']=[..._0x166d04,_0x2db94c],_0x5b0f51[_0x46154(0xa40)]=Date['now'](),await _0x2c5bcf['chats'][_0x46154(0xff5)](_0x5b0f51),document['getElementById'](_0x46154(0xf0a))[_0x46154(0x575)][_0x46154(0x1038)](_0x46154(0x113d))&&_0x13c188(),await _0x1bff53(_0x46154(0x432),_0x46154(0x1260)+_0x198674+_0x46154(0x12b3));}else await _0x1bff53('操作已取消',_0x46154(0x93b));}else throw new Error(_0x46154(0x9af));}catch(_0x355055){console[_0x46154(0x1221)](_0x46154(0x13d1),_0x355055),await _0x1bff53(_0x46154(0x36a),_0x46154(0x313)+_0x355055['message']);}}async function _0x37d8af(_0x3c9900,_0x561de0=![]){const _0x3c86cc=_0x419fa8,_0x22c766=_0x9ebf46[_0x3c86cc(0x547)][_0x3c9900];if(!_0x22c766)return;const _0xc27184=_0x22c766['lastMemorySummaryTimestamp']||0x0,_0x1d2f80=_0x561de0?_0x22c766['history'][_0x3c86cc(0x401)](_0x221106=>!_0x221106['isHidden']||_0x221106['role']===_0x3c86cc(0xb64)&&_0x221106[_0x3c86cc(0x53b)][_0x3c86cc(0x930)](_0x3c86cc(0x1100)))[_0x3c86cc(0x1044)](-(_0x22c766['settings'][_0x3c86cc(0x874)]||0x14)):_0x22c766['history'][_0x3c86cc(0x401)](_0x47479b=>_0x47479b['timestamp']>_0xc27184&&(!_0x47479b[_0x3c86cc(0xc62)]||_0x47479b['role']===_0x3c86cc(0xb64)&&_0x47479b[_0x3c86cc(0x53b)][_0x3c86cc(0x930)]('内心独白')));if(_0x1d2f80['length']<0x5){if(_0x561de0)alert(_0x3c86cc(0x1023));return;}const _0x1582d3=_0x9ebf46[_0x3c86cc(0x32c)][_0x3c86cc(0x5b7)]||'用户',_0x1b9ad6=_0x1d2f80[_0x3c86cc(0xa3b)](_0x50c17e=>{const _0x2cab4f=_0x3c86cc;if(_0x50c17e[_0x2cab4f(0xc62)]&&_0x50c17e[_0x2cab4f(0x7fd)]===_0x2cab4f(0xb64)&&_0x50c17e[_0x2cab4f(0x53b)]['includes']('内心独白'))return _0x50c17e[_0x2cab4f(0x53b)];let _0x3aa798;_0x50c17e[_0x2cab4f(0x7fd)]===_0x2cab4f(0x586)?_0x3aa798=_0x1582d3:_0x3aa798=_0x50c17e[_0x2cab4f(0xac4)]||_0x22c766[_0x2cab4f(0x1071)];let _0x204bc3='';if(_0x50c17e[_0x2cab4f(0x12d9)]==='offline_text'){if(_0x50c17e['content'])_0x204bc3=_0x50c17e['content'];else{const _0x241689=_0x50c17e['dialogue']?'「'+_0x50c17e[_0x2cab4f(0xc2e)]+'」':'',_0x3441a5=_0x50c17e[_0x2cab4f(0x1387)]?'('+_0x50c17e['description']+')':'';_0x204bc3=(_0x241689+'\x20'+_0x3441a5)[_0x2cab4f(0x3f1)]();}}else _0x204bc3=String(_0x50c17e[_0x2cab4f(0x53b)]);return _0x3aa798+':\x20'+_0x204bc3;})[_0x3c86cc(0x809)]('\x0a');let _0x2aa1cd;if(_0x22c766[_0x3c86cc(0x11e4)])_0x2aa1cd=_0x3c86cc(0x595)+_0x1582d3+_0x3c86cc(0x5e8)+_0x1b9ad6+_0x3c86cc(0x2f3)+_0x22c766[_0x3c86cc(0xd3e)][_0x3c86cc(0xa3b)](_0x3cc9dc=>'-\x20'+_0x3cc9dc['groupNickname']+_0x3c86cc(0xdcc)+_0x3cc9dc['originalName']+')')[_0x3c86cc(0x809)]('\x0a')+_0x3c86cc(0x10be);else{const _0x3eb7d4=new Date()[_0x3c86cc(0xd23)]('zh-CN',{'year':_0x3c86cc(0xa74),'month':_0x3c86cc(0xd72),'day':_0x3c86cc(0xa74)});_0x2aa1cd=_0x3c86cc(0x8dc)+_0x22c766[_0x3c86cc(0x1071)]+_0x3c86cc(0x13af)+_0x1582d3+'”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x3eb7d4+_0x3c86cc(0x646)+_0x3eb7d4+'”这个信息，将其转换为【具体的公历日期】（例如：“约定了明天见面”应总结为“我们约定了'+new Date(Date[_0x3c86cc(0x9b7)]()+0x5265c00)['toLocaleDateString']('zh-CN',{'month':_0x3c86cc(0xd72),'day':_0x3c86cc(0xa74)})+_0x3c86cc(0x787)+_0x22c766[_0x3c86cc(0x1131)][_0x3c86cc(0xae3)]+'\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x22c766[_0x3c86cc(0x1131)][_0x3c86cc(0x1151)]+'\x0a#\x20待总结的对话历史\x0a'+_0x1b9ad6+_0x3c86cc(0x4c4)+_0x22c766[_0x3c86cc(0x1071)]+_0x3c86cc(0x8a6);}try{const _0x3e42c2=_0x9ebf46[_0x3c86cc(0x4de)][_0x3c86cc(0x797)]&&_0x9ebf46[_0x3c86cc(0x4de)][_0x3c86cc(0xc0c)]&&_0x9ebf46[_0x3c86cc(0x4de)][_0x3c86cc(0x62f)],{proxyUrl:_0x4faaab,apiKey:_0x2c9058,model:_0x158d0c}=_0x3e42c2?{'proxyUrl':_0x9ebf46['apiConfig'][_0x3c86cc(0x797)],'apiKey':_0x9ebf46[_0x3c86cc(0x4de)][_0x3c86cc(0xc0c)],'model':_0x9ebf46['apiConfig'][_0x3c86cc(0x62f)]}:_0x9ebf46[_0x3c86cc(0x4de)];if(!_0x4faaab||!_0x2c9058||!_0x158d0c)throw new Error('API未配置');let _0x1fea74=_0x4faaab['includes'](_0x3c86cc(0xb23)),_0xc62d63=_0x2e5c04(_0x158d0c,_0x2c9058,_0x2aa1cd,[{'role':_0x3c86cc(0x586),'content':_0x3c86cc(0xb85)}]);const _0x286d2d=_0x1fea74?await fetch(_0xc62d63['url'],_0xc62d63[_0x3c86cc(0x100d)]):await fetch(_0x4faaab+'/v1/chat/completions',{'method':_0x3c86cc(0x116f),'headers':{'Content-Type':_0x3c86cc(0x698),'Authorization':_0x3c86cc(0x84a)+_0x2c9058},'body':JSON[_0x3c86cc(0xf1e)]({'model':_0x158d0c,'messages':[{'role':_0x3c86cc(0xb64),'content':_0x2aa1cd},{'role':_0x3c86cc(0x586),'content':_0x3c86cc(0xb85)}],'temperature':0.2})});if(!_0x286d2d['ok'])throw new Error('API\x20错误:\x20'+_0x286d2d[_0x3c86cc(0x399)]);const _0x16a3b0=await _0x286d2d['json']();let _0x2ba4dc=_0x1fea74?getGeminiResponseText(_0x16a3b0):_0x16a3b0[_0x3c86cc(0xfd2)][0x0]['message'][_0x3c86cc(0x53b)];_0x2ba4dc=_0x2ba4dc[_0x3c86cc(0x459)](/^```json\s*/,'')[_0x3c86cc(0x459)](/```$/,'')[_0x3c86cc(0x3f1)]();const _0x126e62=JSON[_0x3c86cc(0x907)](_0x2ba4dc);if(_0x22c766[_0x3c86cc(0x11e4)]){if(_0x126e62[_0x3c86cc(0x4ef)]&&typeof _0x126e62['summaries']===_0x3c86cc(0xc24)){let _0x286d4a=0x0;for(const _0x391602 in _0x126e62[_0x3c86cc(0x4ef)]){const _0x4600df=_0x126e62[_0x3c86cc(0x4ef)][_0x391602];if(_0x4600df&&_0x4600df[_0x3c86cc(0x3f1)]()){const _0x390755=Object[_0x3c86cc(0xeb2)](_0x9ebf46[_0x3c86cc(0x547)])[_0x3c86cc(0xfc3)](_0x23fd33=>_0x23fd33[_0x3c86cc(0x1071)]===_0x391602);if(_0x390755){const _0x1f3f2b={'content':_0x4600df[_0x3c86cc(0x3f1)](),'timestamp':Date['now'](),'source':_0x3c86cc(0x8df)+_0x22c766[_0x3c86cc(0x609)]};if(!_0x390755['longTermMemory'])_0x390755[_0x3c86cc(0x323)]=[];_0x390755[_0x3c86cc(0x323)][_0x3c86cc(0x668)](_0x1f3f2b),await _0x2c5bcf['chats'][_0x3c86cc(0xff5)](_0x390755),_0x286d4a++;}}}if(_0x286d4a>0x0)console[_0x3c86cc(0x283)]('自动总结成功：为\x20'+_0x286d4a+_0x3c86cc(0xdea));else throw new Error(_0x3c86cc(0x9af));}else throw new Error('AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。');}else{if(_0x126e62[_0x3c86cc(0xc48)]&&_0x126e62['summary'][_0x3c86cc(0x3f1)]()){const _0x365e6f={'content':_0x126e62[_0x3c86cc(0xc48)]['trim'](),'timestamp':Date[_0x3c86cc(0x9b7)](),'source':_0x3c86cc(0x4ee)};_0x22c766[_0x3c86cc(0x323)][_0x3c86cc(0x668)](_0x365e6f),await _0x2c5bcf['chats'][_0x3c86cc(0xff5)](_0x22c766),console[_0x3c86cc(0x283)](_0x3c86cc(0xe4f));}else throw new Error(_0x3c86cc(0x9af));}_0x22c766[_0x3c86cc(0xa40)]=_0x1d2f80['slice'](-0x1)[0x0][_0x3c86cc(0x6b5)],await _0x2c5bcf[_0x3c86cc(0x547)][_0x3c86cc(0xff5)](_0x22c766),document[_0x3c86cc(0x9c8)]('long-term-memory-screen')['classList'][_0x3c86cc(0x1038)](_0x3c86cc(0x113d))&&_0x13c188();}catch(_0x3134cd){console[_0x3c86cc(0x1221)](_0x3c86cc(0xad4),_0x3134cd),await _0x1bff53('总结失败',_0x3c86cc(0xcb0)+_0x3134cd['message']);}}function _0x544651(){const _0xaca9a2=_0x419fa8;if(!_0x1f2a43)return;const _0x56625a=_0x9ebf46[_0xaca9a2(0x547)][_0x9ebf46['activeChatId']],_0x124dcb=_0x56625a[_0xaca9a2(0x8b3)][_0xaca9a2(0xfc3)](_0x4d43ab=>_0x4d43ab['timestamp']===_0x1f2a43);if(!_0x124dcb)return;let _0x501370;_0x124dcb[_0xaca9a2(0x7fd)]===_0xaca9a2(0x586)?_0x501370=_0x56625a[_0xaca9a2(0x11e4)]?_0x56625a['settings'][_0xaca9a2(0x29c)]||'我':'我':_0x56625a[_0xaca9a2(0x11e4)]?_0x501370=_0x227896(_0x56625a,_0x124dcb[_0xaca9a2(0xac4)]):_0x501370=_0x56625a[_0xaca9a2(0x609)];const _0x462f00=String(_0x124dcb[_0xaca9a2(0x53b)]||'');let _0x37284c='';if(typeof _0x124dcb[_0xaca9a2(0x53b)]==='string'&&_0x2d389f[_0xaca9a2(0x4e8)](_0x124dcb['content']))_0x37284c=_0xaca9a2(0x7a8);else{if(_0x124dcb['type']===_0xaca9a2(0x835)||_0x124dcb[_0xaca9a2(0x12d9)]===_0xaca9a2(0x560))_0x37284c=_0xaca9a2(0x4a9);else _0x124dcb[_0xaca9a2(0x12d9)]==='voice_message'?_0x37284c=_0xaca9a2(0x1340):_0x37284c=_0x462f00[_0xaca9a2(0xc34)](0x0,0x32)+(_0x462f00['length']>0x32?_0xaca9a2(0xf66):'');}_0x309858={'timestamp':_0x124dcb['timestamp'],'senderName':_0x501370,'content':_0x462f00};const _0x2ce445=document['getElementById'](_0xaca9a2(0x100f));_0x2ce445[_0xaca9a2(0x91d)](_0xaca9a2(0x995))['textContent']='回复\x20'+_0x309858[_0xaca9a2(0xac4)]+':',_0x2ce445[_0xaca9a2(0x91d)](_0xaca9a2(0x12dc))[_0xaca9a2(0xe24)]=_0x37284c,_0x2ce445[_0xaca9a2(0x5e1)][_0xaca9a2(0x3c5)]=_0xaca9a2(0x3d9),_0x5c2bd9(),document[_0xaca9a2(0x9c8)]('chat-input')['focus']();}function _0x2e3e2c(){const _0xb05621=_0x419fa8;_0x309858=null,document[_0xb05621(0x9c8)](_0xb05621(0x100f))['style'][_0xb05621(0x3c5)]=_0xb05621(0x8f6);}let _0x2bfce7=null;function _0x5720c7(_0x52cc16){const _0x6eaee2=_0x419fa8;_0x2bfce7=_0x52cc16;const _0x2c3bea=_0x9ebf46[_0x6eaee2(0x547)][_0x9ebf46[_0x6eaee2(0x970)]],_0x5ea4c6=_0x2c3bea[_0x6eaee2(0x8b3)][_0x6eaee2(0xfc3)](_0x4d96cc=>_0x4d96cc[_0x6eaee2(0x6b5)]===_0x52cc16);_0x5ea4c6&&(document[_0x6eaee2(0x9c8)](_0x6eaee2(0x7f4))[_0x6eaee2(0xe24)]=_0x5ea4c6['senderName']),document[_0x6eaee2(0x9c8)]('transfer-actions-modal')[_0x6eaee2(0x575)][_0x6eaee2(0x68e)]('visible');}function _0x288aec(){const _0x10dfe3=_0x419fa8;document[_0x10dfe3(0x9c8)]('transfer-actions-modal')['classList'][_0x10dfe3(0x30f)](_0x10dfe3(0xc3f)),_0x2bfce7=null;}async function _0x39b40c(_0x52f316){const _0x43419d=_0x419fa8;if(!_0x2bfce7)return;const _0x56d283=_0x2bfce7,_0x2dfed7=_0x9ebf46['chats'][_0x9ebf46[_0x43419d(0x970)]],_0x49f47a=_0x2dfed7[_0x43419d(0x8b3)][_0x43419d(0x684)](_0x234359=>_0x234359[_0x43419d(0x6b5)]===_0x56d283);if(_0x49f47a===-0x1)return;const _0x1cdbc6=_0x2dfed7[_0x43419d(0x8b3)][_0x49f47a];_0x1cdbc6[_0x43419d(0xebd)]=_0x52f316;let _0x4ee6ec;if(_0x52f316===_0x43419d(0x859)){const _0x5aa8d6={'role':_0x43419d(0x586),'type':_0x43419d(0x975),'isRefund':!![],'amount':_0x1cdbc6[_0x43419d(0x212)],'note':_0x43419d(0x135d),'timestamp':Date['now']()};_0x2dfed7['history']['push'](_0x5aa8d6),_0x4ee6ec=_0x43419d(0x107c)+_0x1cdbc6[_0x43419d(0xac4)]+_0x43419d(0x6a3);}else _0x4ee6ec=_0x43419d(0xdce)+_0x1cdbc6['senderName']+_0x43419d(0x6a3);const _0x363e52={'role':_0x43419d(0xb64),'content':_0x4ee6ec,'timestamp':Date[_0x43419d(0x9b7)]()+0x1,'isHidden':!![]};_0x2dfed7[_0x43419d(0x8b3)][_0x43419d(0x668)](_0x363e52),await _0x2c5bcf[_0x43419d(0x547)][_0x43419d(0xff5)](_0x2dfed7),_0x288aec(),_0x1a44b1(_0x9ebf46[_0x43419d(0x970)]),_0x394b2c();}async function _0x26a28c(){const _0xcc1a57=_0x419fa8;_0xe5834e(_0xcc1a57(0x85a));const _0x1c8b79=document[_0xcc1a57(0x9c8)]('call-history-list'),_0x4d6ff9=document[_0xcc1a57(0x9c8)](_0xcc1a57(0x8a7));_0x1c8b79[_0xcc1a57(0x2f5)]='',_0x4d6ff9[_0xcc1a57(0xe24)]=_0xcc1a57(0x652);const _0x1eaf3a=await _0x2c5bcf[_0xcc1a57(0x852)][_0xcc1a57(0x8ea)]('timestamp')[_0xcc1a57(0x101e)]()[_0xcc1a57(0x5ff)]();if(_0x1eaf3a[_0xcc1a57(0xa06)]===0x0){_0x1c8b79[_0xcc1a57(0x2f5)]=_0xcc1a57(0x1147);return;}_0x1eaf3a[_0xcc1a57(0x591)](_0x548030=>{const _0x5846d0=_0xcc1a57,_0x6decb9=_0x17ff92(_0x548030);_0x43a60a(_0x6decb9,async()=>{const _0x1fa51b=_0x3569,_0x379c21=await _0xadb5df(_0x1fa51b(0xcc4),_0x1fa51b(0xd74),_0x548030[_0x1fa51b(0xb6a)]||'');if(_0x379c21===null)return;await _0x2c5bcf[_0x1fa51b(0x852)][_0x1fa51b(0x13a4)](_0x548030['id'],{'customName':_0x379c21[_0x1fa51b(0x3f1)]()}),await _0x26a28c(),await _0x1bff53('成功',_0x1fa51b(0x802));}),_0x1c8b79[_0x5846d0(0x7b9)](_0x6decb9);});}function _0x17ff92(_0x199421){const _0x4446ad=_0x419fa8,_0x5bc3bd=document[_0x4446ad(0x28a)](_0x4446ad(0x11f4));_0x5bc3bd['className']=_0x4446ad(0x118c),_0x5bc3bd['dataset'][_0x4446ad(0x34c)]=_0x199421['id'];const _0x5d9552=_0x9ebf46['chats'][_0x199421[_0x4446ad(0x54d)]],_0x319e54=_0x5d9552?_0x5d9552['name']:_0x4446ad(0x329),_0x172a75=new Date(_0x199421[_0x4446ad(0x6b5)]),_0x1f91dc=_0x172a75['getFullYear']()+'-'+String(_0x172a75[_0x4446ad(0x260)]()+0x1)['padStart'](0x2,'0')+'-'+String(_0x172a75[_0x4446ad(0xa13)]())[_0x4446ad(0x3e8)](0x2,'0')+'\x20'+String(_0x172a75[_0x4446ad(0x7a2)]())[_0x4446ad(0x3e8)](0x2,'0')+':'+String(_0x172a75['getMinutes']())[_0x4446ad(0x3e8)](0x2,'0'),_0x3e6b15=Math['floor'](_0x199421[_0x4446ad(0xa24)]/0x3c)+'分'+_0x199421[_0x4446ad(0xa24)]%0x3c+'秒',_0x234d5c=_0x199421['participants'][_0x4446ad(0xa3b)](_0x2a5c3a=>_0x4446ad(0x12ac)+_0x2a5c3a[_0x4446ad(0x10c9)]+_0x4446ad(0xdf4)+_0x2a5c3a[_0x4446ad(0x609)]+_0x4446ad(0x2ba)+_0x2a5c3a[_0x4446ad(0x609)]+'\x22>')[_0x4446ad(0x809)]('');return _0x5bc3bd['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>'+_0x1f91dc+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>'+_0x3e6b15+_0x4446ad(0x9f1)+(_0x199421[_0x4446ad(0xb6a)]?'<div\x20class=\x22custom-title\x22>'+_0x199421['customName']+_0x4446ad(0x103c):'')+_0x4446ad(0x46f)+_0x234d5c+_0x4446ad(0x6ed)+_0x319e54+_0x4446ad(0x645),_0x5bc3bd;}async function _0x53fe02(_0x1b5c1a){const _0x468ac0=_0x419fa8,_0x4ad13a=await _0x2c5bcf['callRecords'][_0x468ac0(0xdf9)](_0x1b5c1a);if(!_0x4ad13a)return;const _0x5e7701=document[_0x468ac0(0x9c8)](_0x468ac0(0x19f)),_0x510a4a=document[_0x468ac0(0x9c8)](_0x468ac0(0x4c9)),_0x315dd8=document[_0x468ac0(0x9c8)](_0x468ac0(0xc5b));_0x510a4a[_0x468ac0(0xe24)]=_0x468ac0(0x608)+new Date(_0x4ad13a[_0x468ac0(0x6b5)])[_0x468ac0(0x135b)]()+'\x20(时长:\x20'+Math['floor'](_0x4ad13a[_0x468ac0(0xa24)]/0x3c)+'分'+_0x4ad13a[_0x468ac0(0xa24)]%0x3c+'秒)',_0x315dd8[_0x468ac0(0x2f5)]='';const _0x1d6aed=document[_0x468ac0(0x9c8)](_0x468ac0(0x330)),_0x2a7279=document['getElementById'](_0x468ac0(0x393));!_0x4ad13a[_0x468ac0(0xe15)]||_0x4ad13a[_0x468ac0(0xe15)][_0x468ac0(0xa06)]===0x0?(_0x315dd8['innerHTML']=_0x468ac0(0x554),_0x2a7279[_0x468ac0(0x5e1)][_0x468ac0(0x3c5)]=_0x468ac0(0x8f6)):(_0x2a7279['style'][_0x468ac0(0x3c5)]=_0x468ac0(0x3d9),_0x4ad13a['transcript']['forEach'](_0x153320=>{const _0x1efb54=_0x468ac0,_0x5a1365=document[_0x1efb54(0x28a)](_0x1efb54(0x11f4));_0x5a1365[_0x1efb54(0x82c)]=_0x1efb54(0x71b)+_0x153320[_0x1efb54(0x7fd)],_0x5a1365['textContent']=_0x153320[_0x1efb54(0x53b)],_0x315dd8[_0x1efb54(0x7b9)](_0x5a1365);}));const _0xee2e3a=_0x1d6aed['cloneNode'](!![]);_0x1d6aed['parentNode'][_0x468ac0(0x4d7)](_0xee2e3a,_0x1d6aed);const _0x4f8d5e=_0x2a7279[_0x468ac0(0x75c)](!![]);_0x2a7279[_0x468ac0(0x127d)][_0x468ac0(0x4d7)](_0x4f8d5e,_0x2a7279),_0xee2e3a[_0x468ac0(0xa0f)](_0x468ac0(0xf5c),async()=>{const _0x1db298=_0x468ac0,_0x266058=await _0x352ae9(_0x1db298(0x115b),_0x1db298(0x199),{'confirmButtonClass':_0x1db298(0x12bc)});_0x266058&&(_0x5e7701[_0x1db298(0x575)]['remove']('visible'),await _0x2c5bcf[_0x1db298(0x852)][_0x1db298(0x6d2)](_0x1b5c1a),await _0x26a28c(),alert(_0x1db298(0x1049)));}),_0x4f8d5e[_0x468ac0(0xa0f)](_0x468ac0(0xf5c),async()=>{const _0x1670a1=_0x468ac0,_0x18f948=await _0x352ae9(_0x1670a1(0x10c7),_0x1670a1(0x647),{'confirmText':'确认总结'});if(!_0x18f948)return;_0x5e7701[_0x1670a1(0x575)][_0x1670a1(0x30f)](_0x1670a1(0xc3f));const _0x4ece92=_0x9ebf46[_0x1670a1(0x547)][_0x4ad13a[_0x1670a1(0x54d)]];if(!_0x4ece92){alert(_0x1670a1(0xa3c));return;}await _0x1bff53(_0x1670a1(0x7a4),_0x1670a1(0x1173));try{const _0x49d6d2=_0x4ad13a[_0x1670a1(0xe15)][_0x1670a1(0xa3b)](_0x421825=>{const _0xfdc631=_0x1670a1,_0x258755=_0x421825[_0xfdc631(0x7fd)]==='user'?_0x4ece92[_0xfdc631(0x1131)][_0xfdc631(0x29c)]||'我':_0x421825[_0xfdc631(0xac4)]||_0x4ece92[_0xfdc631(0x609)];return _0x258755+':\x20'+_0x421825[_0xfdc631(0x53b)];})[_0x1670a1(0x809)]('\x0a');await _0x378e3f(_0x4ad13a[_0x1670a1(0x54d)],_0x49d6d2),await _0x1bff53(_0x1670a1(0x111f),_0x1670a1(0x822)+_0x4ece92['name']+_0x1670a1(0x530));}catch(_0xd1e938){await _0x1bff53(_0x1670a1(0xf10),_0x1670a1(0x521)+_0xd1e938[_0x1670a1(0x86e)]);}});const _0x1c787f=document[_0x468ac0(0x9c8)]('close-transcript-modal-btn'),_0x47fc1a=_0x1c787f[_0x468ac0(0x75c)](!![]);_0x1c787f[_0x468ac0(0x127d)][_0x468ac0(0x4d7)](_0x47fc1a,_0x1c787f),_0x47fc1a['addEventListener'](_0x468ac0(0xf5c),()=>{const _0x5e6d19=_0x468ac0;_0x5e7701['classList']['remove'](_0x5e6d19(0xc3f));}),_0x5e7701[_0x468ac0(0x575)][_0x468ac0(0x68e)](_0x468ac0(0xc3f));}async function _0x2d734a(){const _0x1e9da8=_0x419fa8;if(!_0x9ebf46[_0x1e9da8(0x970)]||_0x9ebf46[_0x1e9da8(0x547)][_0x9ebf46[_0x1e9da8(0x970)]][_0x1e9da8(0x11e4)])return;const _0xfea69d=_0x9ebf46['chats'][_0x9ebf46['activeChatId']],_0x2c76d3=await _0xadb5df(_0x1e9da8(0x638),_0x1e9da8(0x1306),_0xfea69d[_0x1e9da8(0xebd)][_0x1e9da8(0xbb7)]);_0x2c76d3!==null&&(_0xfea69d[_0x1e9da8(0xebd)][_0x1e9da8(0xbb7)]=_0x2c76d3['trim']()||'在线',_0xfea69d[_0x1e9da8(0xebd)][_0x1e9da8(0xf22)]=![],_0xfea69d[_0x1e9da8(0xebd)][_0x1e9da8(0x114e)]=Date[_0x1e9da8(0x9b7)](),await _0x2c5bcf[_0x1e9da8(0x547)][_0x1e9da8(0xff5)](_0xfea69d),_0x1a44b1(_0x9ebf46[_0x1e9da8(0x970)]),_0x394b2c(),await _0x1bff53(_0x1e9da8(0x18d),'“'+_0xfea69d[_0x1e9da8(0x609)]+_0x1e9da8(0x8c5)+_0xfea69d[_0x1e9da8(0xebd)]['text']));}async function _0x620309(){const _0x712ef8=_0x419fa8,_0x577559=document[_0x712ef8(0x9c8)](_0x712ef8(0x838)),_0x4edda4=document[_0x712ef8(0x9c8)]('share-target-list');_0x4edda4[_0x712ef8(0x2f5)]='';const _0x15fbb4=Object[_0x712ef8(0xeb2)](_0x9ebf46[_0x712ef8(0x547)]);_0x15fbb4[_0x712ef8(0x591)](_0xc4b29b=>{const _0x24e293=_0x712ef8,_0x3addc2=document[_0x24e293(0x28a)](_0x24e293(0x11f4));_0x3addc2[_0x24e293(0x82c)]=_0x24e293(0xd75),_0x3addc2[_0x24e293(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22'+_0xc4b29b['id']+_0x24e293(0x1329)+(_0xc4b29b[_0x24e293(0x11e4)]?_0xc4b29b[_0x24e293(0x1131)][_0x24e293(0xa79)]:_0xc4b29b[_0x24e293(0x1131)][_0x24e293(0xd4d)]||_0x246753)+_0x24e293(0x702)+_0xc4b29b[_0x24e293(0x609)]+_0x24e293(0xa71),_0x4edda4[_0x24e293(0x7b9)](_0x3addc2);}),_0x577559['classList'][_0x712ef8(0x68e)](_0x712ef8(0xc3f));}function _0x4c69e6(_0x4c6b22){const _0x2189e4=_0x419fa8,_0xc7d920=document[_0x2189e4(0x9c8)](_0x2189e4(0x41e));if(!_0xc7d920[_0x2189e4(0x575)][_0x2189e4(0x1038)]('visible')){if(_0x4c6b22)_0x4c6b22();return;}_0xc7d920[_0x2189e4(0x575)][_0x2189e4(0x30f)](_0x2189e4(0xc3f)),setTimeout(()=>{const _0x669fe9=_0x2189e4;document[_0x669fe9(0x9c8)](_0x669fe9(0xc1f))['classList'][_0x669fe9(0x30f)](_0x669fe9(0xc3f));if(_0x4c6b22)_0x4c6b22();},0x190);}function _0x52e008(_0x103541){const _0x346f95=_0x419fa8;if(!_0x103541)return[];const _0x2a9fed=String(_0x103541)[_0x346f95(0x6c6)](/\r\n?|\n/),_0x45a69b=[],_0x2f498b=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0x50eeb0 of _0x2a9fed){const _0x3fe812=_0x50eeb0['replace'](_0x2f498b,'')['trim']();if(!_0x3fe812)continue;_0x2f498b[_0x346f95(0x11fa)]=0x0;let _0xb47e9a;while((_0xb47e9a=_0x2f498b['exec'](_0x50eeb0))!==null){const _0x53ee7e=parseInt(_0xb47e9a[0x1],0xa),_0x5132bc=parseInt(_0xb47e9a[0x2],0xa),_0x634b87=parseInt(_0xb47e9a[0x3]['padEnd'](0x3,'0'),0xa),_0x497e05=_0x53ee7e*0x3c+_0x5132bc+_0x634b87/0x3e8;_0x45a69b['push']({'time':_0x497e05,'text':_0x3fe812});}}return _0x45a69b['sort']((_0x7cbc61,_0x2dad13)=>_0x7cbc61[_0x346f95(0x13be)]-_0x2dad13['time']);}function _0x2e2dbe(){const _0x1208ae=_0x419fa8,_0x41da86=document[_0x1208ae(0x9c8)](_0x1208ae(0x622));_0x41da86[_0x1208ae(0x2f5)]='';if(!_0x5062a9[_0x1208ae(0x109a)]||_0x5062a9[_0x1208ae(0x109a)][_0x1208ae(0xa06)]===0x0){_0x41da86[_0x1208ae(0x2f5)]=_0x1208ae(0xd1e);return;}_0x5062a9[_0x1208ae(0x109a)]['forEach']((_0x549e50,_0x5927b7)=>{const _0x397100=_0x1208ae,_0x545951=document[_0x397100(0x28a)](_0x397100(0x11f4));_0x545951[_0x397100(0x82c)]=_0x397100(0xf0e),_0x545951[_0x397100(0xe24)]=_0x549e50[_0x397100(0xbb7)],_0x545951[_0x397100(0xc9f)][_0x397100(0x45a)]=_0x5927b7,_0x41da86[_0x397100(0x7b9)](_0x545951);}),_0x41da86['style'][_0x1208ae(0xf57)]='translateY(0px)';}function _0x261bca(_0xfd2489){const _0x345d36=_0x419fa8;if(_0x5062a9[_0x345d36(0x109a)][_0x345d36(0xa06)]===0x0)return;let _0xa9cbb6=-0x1;for(let _0x52a031=0x0;_0x52a031<_0x5062a9[_0x345d36(0x109a)]['length'];_0x52a031++){if(_0xfd2489>=_0x5062a9[_0x345d36(0x109a)][_0x52a031][_0x345d36(0x13be)])_0xa9cbb6=_0x52a031;else break;}if(_0xa9cbb6===_0x5062a9[_0x345d36(0x114b)])return;_0x5062a9[_0x345d36(0x114b)]=_0xa9cbb6,_0x2bd0ed();const _0x4436a2=document[_0x345d36(0x9c8)](_0x345d36(0xcc6));_0x4436a2&&(_0xa9cbb6>-0x1&&_0x5062a9[_0x345d36(0x109a)][_0xa9cbb6]?_0x4436a2['textContent']=_0x5062a9[_0x345d36(0x109a)][_0xa9cbb6][_0x345d36(0xbb7)]:_0x4436a2['textContent']=_0x345d36(0x12dd));const _0x233e24=document['getElementById'](_0x345d36(0x8b1));_0x233e24[_0x345d36(0x575)][_0x345d36(0x1038)](_0x345d36(0xc3f))&&(_0xa9cbb6>-0x1&&_0x5062a9[_0x345d36(0x109a)][_0xa9cbb6]?_0x233e24[_0x345d36(0xe24)]=_0x5062a9[_0x345d36(0x109a)][_0xa9cbb6][_0x345d36(0xbb7)]:_0x233e24[_0x345d36(0xe24)]='♪');}function _0x2bd0ed(_0xa3cd54=![]){const _0x1e905b=_0x419fa8,_0x5e32cf=_0xa3cd54?_0x1e905b(0xf00):'#music-lyrics-container\x20#music-lyrics-list',_0x263220=_0xa3cd54?'#fullscreen-lyrics-container':_0x1e905b(0xe4d),_0x5d53f6=document[_0x1e905b(0x91d)](_0x5e32cf),_0x363ea4=document[_0x1e905b(0x91d)](_0x263220);if(!_0x5d53f6||!_0x363ea4)return;const _0x2f5d07=_0x5d53f6[_0x1e905b(0x7e4)](_0x1e905b(0x228));_0x2f5d07[_0x1e905b(0x591)](_0x3a568d=>_0x3a568d[_0x1e905b(0x575)]['remove'](_0x1e905b(0x113d)));if(_0x5062a9[_0x1e905b(0x114b)]===-0x1){_0x5d53f6[_0x1e905b(0x5e1)][_0x1e905b(0xf57)]=_0x1e905b(0x12e0);return;}const _0x29bfd6=_0x5d53f6[_0x1e905b(0x91d)](_0x1e905b(0xdfe)+_0x5062a9['currentLyricIndex']+'\x22]');if(_0x29bfd6){_0x29bfd6['classList'][_0x1e905b(0x68e)](_0x1e905b(0x113d));const _0x4b0e57=_0x363ea4[_0x1e905b(0x559)],_0x3297d2=_0x4b0e57/2.2-_0x29bfd6[_0x1e905b(0xd22)]-_0x29bfd6[_0x1e905b(0x559)]/0x2;_0x5d53f6[_0x1e905b(0x5e1)][_0x1e905b(0xf57)]=_0x1e905b(0xdbd)+_0x3297d2+_0x1e905b(0x10b5);}}function _0x16e9be(_0x5bead9){const _0x5145ed=_0x419fa8;if(isNaN(_0x5bead9)||_0x5bead9<0x0)return _0x5145ed(0x98c);const _0x55ce83=Math[_0x5145ed(0x5fb)](_0x5bead9/0x3c),_0x511432=Math[_0x5145ed(0x5fb)](_0x5bead9%0x3c);return _0x55ce83+':'+String(_0x511432)[_0x5145ed(0x3e8)](0x2,'0');}let _0x3652fd=0x0,_0x1c2704;function _0x1d5b7a(){_0x1c2704&&cancelAnimationFrame(_0x1c2704);function _0x1008fa(){const _0x33043b=_0x3569;if(!_0x5062a9[_0x33043b(0x50c)]||!_0x287389[_0x33043b(0xa24)])return;const _0x2f3ae7=performance[_0x33043b(0x9b7)](),_0x3c354e=_0x287389[_0x33043b(0x117d)],_0x1adcc5=_0x287389['duration'],_0x54118e=_0x3c354e/_0x1adcc5*0x64;document[_0x33043b(0x9c8)]('music-progress-fill')[_0x33043b(0x5e1)]['width']=_0x54118e+'%',_0x2f3ae7-_0x3652fd>0x3e8&&(document[_0x33043b(0x9c8)](_0x33043b(0x1218))[_0x33043b(0xe24)]=_0x16e9be(_0x3c354e),document[_0x33043b(0x9c8)]('music-total-time')[_0x33043b(0xe24)]=_0x16e9be(_0x1adcc5),_0x3652fd=_0x2f3ae7),_0x261bca(_0x3c354e),_0x1c2704=requestAnimationFrame(_0x1008fa);}_0x1c2704=requestAnimationFrame(_0x1008fa);}function _0x155696(){const _0x2f55d0=_0x419fa8;if(!lastRawAiResponse){alert(_0x2f55d0(0x4d9));return;}const _0x3f4461=document[_0x2f55d0(0x9c8)](_0x2f55d0(0xdfd)),_0x1e8334=document[_0x2f55d0(0x9c8)]('ai-response-editor-container');_0x1e8334[_0x2f55d0(0x2f5)]='';const _0x2e979b=lastRawAiResponse[_0x2f55d0(0x12c2)](/{[^{}]*}/g);if(_0x2e979b)_0x2e979b['forEach'](_0x5d3f43=>{const _0x585d61=_0x2f55d0;try{const _0x132aed=JSON[_0x585d61(0x907)](_0x5d3f43),_0x1f086f=JSON[_0x585d61(0xf1e)](_0x132aed,null,0x2),_0x9b6e4=_0x27e7dc(_0x1f086f);_0x1e8334[_0x585d61(0x7b9)](_0x9b6e4);}catch(_0x233225){const _0x46e8c6=_0x27e7dc(_0x5d3f43);_0x1e8334[_0x585d61(0x7b9)](_0x46e8c6),console[_0x585d61(0x453)](_0x585d61(0x4cc),_0x5d3f43);}});else{const _0x2af9c9=_0x27e7dc(lastRawAiResponse);_0x1e8334[_0x2f55d0(0x7b9)](_0x2af9c9);}_0x3f4461[_0x2f55d0(0x575)][_0x2f55d0(0x68e)]('visible');}function _0x27e7dc(_0x271648=''){const _0x177c61=_0x419fa8,_0x35da3f=document[_0x177c61(0x28a)](_0x177c61(0x11f4));_0x35da3f['className']=_0x177c61(0x12d7);const _0x3b1a30={'text':{'type':_0x177c61(0xbb7),'content':_0x177c61(0x21e)},'sticker':{'type':_0x177c61(0x83e),'url':_0x177c61(0x110d),'meaning':_0x177c61(0x4b3)},'image':{'type':_0x177c61(0x835),'description':'在这里输入图片描述...'},'voice':{'type':_0x177c61(0x10c1),'content':'在这里输入语音内容...'},'transfer':{'type':_0x177c61(0x975),'amount':5.2,'note':'一点心意'},'offline':{'type':_0x177c61(0xc91),'content':_0x177c61(0x8f7)},'quote':{'type':_0x177c61(0xb43),'target_timestamp':0x499602d2,'reply_content':_0x177c61(0x190)}};return _0x35da3f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>'+_0x271648+_0x177c61(0x5d5)+JSON[_0x177c61(0xf1e)](_0x3b1a30[_0x177c61(0xbb7)])+_0x177c61(0x63c)+JSON[_0x177c61(0xf1e)](_0x3b1a30[_0x177c61(0x83e)])+_0x177c61(0x44f)+JSON['stringify'](_0x3b1a30[_0x177c61(0x10eb)])+_0x177c61(0x64a)+JSON['stringify'](_0x3b1a30['voice'])+'\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x177c61(0xf1e)](_0x3b1a30[_0x177c61(0x975)])+'\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x177c61(0xf1e)](_0x3b1a30[_0x177c61(0xab8)])+_0x177c61(0x9d6)+JSON[_0x177c61(0xf1e)](_0x3b1a30[_0x177c61(0xa19)])+_0x177c61(0x76e),_0x35da3f['querySelector'](_0x177c61(0x85c))[_0x177c61(0xa0f)]('click',()=>{const _0x4e3c38=_0x177c61;_0x35da3f[_0x4e3c38(0x30f)]();}),_0x35da3f[_0x177c61(0x7e4)]('.format-btn')['forEach'](_0x4cd3f8=>{const _0x293be5=_0x177c61;_0x4cd3f8['addEventListener'](_0x293be5(0xf5c),()=>{const _0x5459a9=_0x293be5,_0x36b3f1=_0x4cd3f8['dataset'][_0x5459a9(0x9bc)],_0x270d0b=_0x35da3f[_0x5459a9(0x91d)]('textarea');if(_0x36b3f1&&_0x270d0b)try{const _0x2fa5ec=JSON[_0x5459a9(0x907)](_0x36b3f1);_0x270d0b[_0x5459a9(0x1155)]=JSON[_0x5459a9(0xf1e)](_0x2fa5ec,null,0x2),_0x270d0b[_0x5459a9(0x6fd)]();}catch(_0x5a9ce8){console['error'](_0x5459a9(0x507),_0x5a9ce8);}});}),_0x35da3f;}async function _0x4cc032(){const _0x526dc4=_0x419fa8,_0x2e2955=_0x9ebf46[_0x526dc4(0x547)][_0x9ebf46[_0x526dc4(0x970)]];if(!_0x2e2955)return;const _0x101115=document['getElementById']('ai-response-editor-container'),_0x3ff8bc=_0x101115['querySelectorAll'](_0x526dc4(0x11f9)),_0x47af9f=Array[_0x526dc4(0x13a5)](_0x3ff8bc)['map'](_0x13e8e5=>_0x13e8e5[_0x526dc4(0x1155)][_0x526dc4(0x3f1)]())[_0x526dc4(0x401)](Boolean);if(_0x47af9f['length']===0x0){_0x2e2955[_0x526dc4(0x8b3)]=_0x2e2955[_0x526dc4(0x8b3)][_0x526dc4(0x401)](_0x38e588=>!lastResponseTimestamps['includes'](_0x38e588[_0x526dc4(0x6b5)])),await _0x2c5bcf[_0x526dc4(0x547)][_0x526dc4(0xff5)](_0x2e2955),_0x1a44b1(_0x9ebf46[_0x526dc4(0x970)]),_0x394b2c(),document[_0x526dc4(0x9c8)](_0x526dc4(0xdfd))[_0x526dc4(0x575)][_0x526dc4(0x30f)]('visible'),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0x1322d5=[];for(const _0xf73ba6 of _0x47af9f){try{const _0x418d3c=JSON[_0x526dc4(0x907)](_0xf73ba6);_0x1322d5[_0x526dc4(0x668)](_0x418d3c);}catch(_0x18814a){console['warn'](_0x526dc4(0x285),_0xf73ba6);}}_0x2e2955[_0x526dc4(0x8b3)]=_0x2e2955[_0x526dc4(0x8b3)][_0x526dc4(0x401)](_0x4c7a77=>!lastResponseTimestamps[_0x526dc4(0x930)](_0x4c7a77['timestamp']));let _0x1c8f5d=[],_0x167574=Date[_0x526dc4(0x9b7)]();for(const _0x330d18 of _0x1322d5){if(!_0x330d18||typeof _0x330d18!==_0x526dc4(0xc24)||!_0x330d18['type']){console[_0x526dc4(0x453)]('在导演模式保存时，发现无效的指令对象，已跳过:',_0x330d18);continue;}let _0x1a2908=null;const _0x2ad709={'role':'assistant','senderName':_0x330d18[_0x526dc4(0x609)]||_0x2e2955['originalName'],'timestamp':_0x167574++};switch(_0x330d18[_0x526dc4(0x12d9)]){case _0x526dc4(0xbb7):_0x1a2908={..._0x2ad709,'content':String(_0x330d18[_0x526dc4(0x53b)]||_0x330d18[_0x526dc4(0x86e)])};break;case _0x526dc4(0x83e):{let _0x192718=![];if(_0x330d18[_0x526dc4(0x11be)]&&_0x330d18[_0x526dc4(0x1b3)])_0x1a2908={..._0x2ad709,'type':_0x526dc4(0x83e),'content':_0x330d18['url'],'meaning':_0x330d18[_0x526dc4(0x1b3)]},console['log'](_0x526dc4(0xc9a)),_0x192718=!![];else{if(_0x330d18[_0x526dc4(0x1b3)]){const _0x28364d=_0x9ebf46[_0x526dc4(0x774)][_0x526dc4(0xfc3)](_0x3a6daf=>_0x3a6daf[_0x526dc4(0x609)]===_0x330d18['meaning']);_0x28364d?(_0x1a2908={..._0x2ad709,'type':'sticker','content':_0x28364d['url'],'meaning':_0x28364d[_0x526dc4(0x609)]},console[_0x526dc4(0x283)](_0x526dc4(0x3e2)),_0x192718=!![]):(_0x1a2908={..._0x2ad709,'type':_0x526dc4(0xbb7),'content':_0x526dc4(0xef0)+_0x330d18[_0x526dc4(0x1b3)]+']'},console['warn']('导演模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:',_0x330d18[_0x526dc4(0x1b3)]),_0x192718=!![]);}else{if(_0x330d18[_0x526dc4(0x11be)]){_0x1a2908={..._0x2ad709,'type':_0x526dc4(0x83e),'content':_0x330d18[_0x526dc4(0x11be)]};const _0x41c9f9=_0x9ebf46[_0x526dc4(0x774)][_0x526dc4(0xfc3)](_0x3d6f3b=>_0x3d6f3b['url']===_0x330d18[_0x526dc4(0x11be)]);_0x1a2908[_0x526dc4(0x1b3)]=_0x41c9f9?_0x41c9f9[_0x526dc4(0x609)]:_0x526dc4(0xdbe),console[_0x526dc4(0x283)](_0x526dc4(0x1346),_0x1a2908[_0x526dc4(0x1b3)]),_0x192718=!![];}else{if(_0x330d18[_0x526dc4(0x53b)]&&typeof _0x330d18[_0x526dc4(0x53b)]==='string'&&_0x2d389f[_0x526dc4(0x4e8)](_0x330d18[_0x526dc4(0x53b)])){_0x1a2908={..._0x2ad709,'type':_0x526dc4(0x83e),'content':_0x330d18['content']};const _0x2888ea=_0x9ebf46[_0x526dc4(0x774)][_0x526dc4(0xfc3)](_0x19ebe9=>_0x19ebe9['url']===_0x330d18['content']);_0x1a2908[_0x526dc4(0x1b3)]=_0x2888ea?_0x2888ea['name']:'未知表情',console[_0x526dc4(0x283)](_0x526dc4(0x708),_0x1a2908[_0x526dc4(0x1b3)]),_0x192718=!![];}}}}if(!_0x192718){console['error'](_0x526dc4(0x11fb),_0x330d18);continue;}break;}case _0x526dc4(0x835):_0x1a2908={..._0x2ad709,'type':'ai_image','content':_0x330d18['description']};break;case _0x526dc4(0x10c1):_0x1a2908={..._0x2ad709,'type':_0x526dc4(0x10c1),'content':_0x330d18[_0x526dc4(0x53b)]};break;case'transfer':_0x1a2908={..._0x2ad709,'type':_0x526dc4(0x975),'amount':_0x330d18[_0x526dc4(0x212)],'note':_0x330d18[_0x526dc4(0x490)],'receiverName':_0x330d18['receiver']||'我'};break;case'waimai_request':_0x1a2908={..._0x2ad709,'type':_0x526dc4(0x12d4),'productInfo':_0x330d18[_0x526dc4(0xde1)],'amount':_0x330d18[_0x526dc4(0x212)],'status':_0x526dc4(0xcf8),'countdownEndTime':Date['now']()+0xf*0x3c*0x3e8};break;case'offline_text':_0x1a2908={..._0x2ad709,..._0x330d18};break;case _0x526dc4(0x82d):{const _0x34245b=_0x434409[_0x2e2955['id']];if(_0x34245b){const _0x3def38=_0x34245b[_0x526dc4(0x8b3)]['findLastIndex'](_0x30db03=>_0x30db03[_0x526dc4(0xb4b)]===0x2);if(_0x3def38>-0x1){const _0x1fece7=_0x34245b[_0x526dc4(0x8b3)][_0x3def38];_0x34245b[_0x526dc4(0xb44)][_0x1fece7['y']][_0x1fece7['x']]=0x0,_0x34245b['history'][_0x526dc4(0x888)](_0x3def38,0x1),console[_0x526dc4(0x283)](_0x526dc4(0x906)+_0x1fece7['x']+',\x20'+_0x1fece7['y']+')\x20的棋步。');}}const _0x296a59=parseInt(_0x330d18['x']),_0x215664=parseInt(_0x330d18['y']);!isNaN(_0x296a59)&&!isNaN(_0x215664)?_0x3a7522({'x':_0x296a59,'y':_0x215664},!![]):console[_0x526dc4(0x453)](_0x526dc4(0x789),_0x330d18);continue;}case _0x526dc4(0x234):{if(!_0x2e2955[_0x526dc4(0x11e4)]){_0x330d18['heartfelt_voice']&&(_0x2e2955['heartfeltVoice']=String(_0x330d18[_0x526dc4(0x39f)]));_0x330d18[_0x526dc4(0xb98)]&&(_0x2e2955[_0x526dc4(0xa1a)]=String(_0x330d18[_0x526dc4(0xb98)]));!Array[_0x526dc4(0xb27)](_0x2e2955[_0x526dc4(0xec6)])&&(_0x2e2955[_0x526dc4(0xec6)]=[]);_0x2e2955['thoughtsHistory']['push']({'heartfeltVoice':_0x2e2955[_0x526dc4(0x1291)],'randomJottings':_0x2e2955[_0x526dc4(0xa1a)],'timestamp':Date[_0x526dc4(0x9b7)]()});_0x2e2955[_0x526dc4(0xec6)][_0x526dc4(0xa06)]>0x32&&_0x2e2955[_0x526dc4(0xec6)][_0x526dc4(0xd6e)]();const _0x10d1fc=_0x526dc4(0x74a)+_0x2e2955[_0x526dc4(0x1291)]+_0x526dc4(0xd4c)+_0x2e2955['randomJottings'],_0x53fd2c={'role':_0x526dc4(0xb64),'content':_0x10d1fc,'timestamp':Date[_0x526dc4(0x9b7)](),'isHidden':!![]};}continue;}case _0x526dc4(0xb43):{const _0x472a3c=_0x2e2955[_0x526dc4(0x8b3)][_0x526dc4(0xfc3)](_0x5e7050=>_0x5e7050['timestamp']===_0x330d18['target_timestamp']);let _0x2a43d8=null;if(_0x472a3c){let _0x2b098=_0x472a3c['senderName'];_0x472a3c[_0x526dc4(0x7fd)]===_0x526dc4(0x586)&&(_0x2b098=_0x2e2955['isGroup']?_0x2e2955['settings'][_0x526dc4(0x29c)]||'我':_0x9ebf46[_0x526dc4(0x32c)]['nickname']||_0x526dc4(0x5c1)),_0x2a43d8={'timestamp':_0x330d18[_0x526dc4(0x18b)],'senderName':_0x2b098,'content':String(_0x472a3c[_0x526dc4(0x53b)]||'')};}else _0x2a43d8={'timestamp':_0x330d18[_0x526dc4(0x18b)],'senderName':_0x526dc4(0x7ae),'content':_0x526dc4(0xa6c)};_0x1a2908={..._0x2ad709,'content':_0x330d18[_0x526dc4(0xbb2)],'quote':_0x2a43d8};break;}default:console[_0x526dc4(0x453)](_0x526dc4(0x9c1),_0x330d18[_0x526dc4(0x12d9)]);break;}_0x1a2908&&(_0x2e2955[_0x526dc4(0x8b3)][_0x526dc4(0x668)](_0x1a2908),_0x1c8f5d['push'](_0x1a2908[_0x526dc4(0x6b5)]));}await _0x2c5bcf[_0x526dc4(0x547)][_0x526dc4(0xff5)](_0x2e2955),_0x1a44b1(_0x9ebf46[_0x526dc4(0x970)]),_0x394b2c(),document['getElementById'](_0x526dc4(0xdfd))[_0x526dc4(0x575)]['remove'](_0x526dc4(0xc3f)),lastRawAiResponse=_0x47af9f[_0x526dc4(0x809)]('\x0a\x0a'),lastResponseTimestamps=_0x1c8f5d,await _0x1bff53(_0x526dc4(0x681),_0x526dc4(0x7bf));}async function _0x387a97(){const _0x449ca7=_0x419fa8;if(!_0x1f2a43)return;const _0x2dc188=0x2*0x3c*0x3e8,_0x356a4e=_0x1f2a43,_0x34f9b9=Date[_0x449ca7(0x9b7)]();if(_0x34f9b9-_0x356a4e>_0x2dc188){_0x5c2bd9(),await _0x1bff53(_0x449ca7(0x24d),_0x449ca7(0x803));return;}await _0x1aea32(_0x356a4e,!![]),_0x5c2bd9();}async function _0x1aea32(_0x1f1c20,_0x224f81){const _0x8920b4=_0x419fa8,_0x525506=_0x9ebf46[_0x8920b4(0x547)][_0x9ebf46[_0x8920b4(0x970)]];if(!_0x525506)return;const _0xcc756e=_0x525506[_0x8920b4(0x8b3)][_0x8920b4(0x684)](_0x5422c9=>_0x5422c9[_0x8920b4(0x6b5)]===_0x1f1c20);if(_0xcc756e===-0x1)return;const _0x1b46a7=_0x525506[_0x8920b4(0x8b3)][_0xcc756e],_0x5e3e57={'originalType':_0x1b46a7[_0x8920b4(0x12d9)]||_0x8920b4(0xbb7),'originalContent':_0x1b46a7[_0x8920b4(0x53b)],'originalMeaning':_0x1b46a7[_0x8920b4(0x1b3)],'originalQuote':_0x1b46a7[_0x8920b4(0xa19)]};_0x1b46a7['type']=_0x8920b4(0x8cc),_0x1b46a7[_0x8920b4(0x53b)]=_0x224f81?_0x8920b4(0xb33):_0x8920b4(0x39d),_0x1b46a7['recalledData']=_0x5e3e57,delete _0x1b46a7[_0x8920b4(0x1b3)],delete _0x1b46a7[_0x8920b4(0xa19)];if(_0x224f81){const _0x16f9ba=_0x525506[_0x8920b4(0x11e4)]?_0x525506['settings'][_0x8920b4(0x29c)]||'我':'我';let _0x3bb9ee='';if(_0x5e3e57[_0x8920b4(0x22e)]===_0x8920b4(0x83e))_0x3bb9ee=_0x8920b4(0x10b6)+(_0x5e3e57[_0x8920b4(0x105b)]||'未知')+']';else _0x5e3e57['originalType']===_0x8920b4(0x835)||_0x5e3e57[_0x8920b4(0x22e)]===_0x8920b4(0x560)?_0x3bb9ee='[图片，描述:\x20'+_0x5e3e57[_0x8920b4(0x489)]+']':_0x3bb9ee='“'+String(_0x5e3e57['originalContent'])+'”';const _0x2f12e1={'role':'system','content':_0x8920b4(0x124c)+_0x16f9ba+'）刚刚撤回了一条消息。撤回前的内容是：'+_0x3bb9ee+_0x8920b4(0xb01),'timestamp':Date[_0x8920b4(0x9b7)](),'isHidden':!![]};_0x525506['history'][_0x8920b4(0x668)](_0x2f12e1);}await _0x2c5bcf['chats'][_0x8920b4(0xff5)](_0x525506),_0x1a44b1(_0x9ebf46[_0x8920b4(0x970)]),_0x224f81&&(_0x394b2c(),_0x4128b4());}async function _0x497da2(){const _0x273c0b=_0x419fa8;await _0xe43974(),document['getElementById'](_0x273c0b(0xf16))[_0x273c0b(0x575)][_0x273c0b(0x68e)](_0x273c0b(0xc3f));}async function _0xe43974(){const _0x2da390=_0x419fa8,_0x3f7dca=document[_0x2da390(0x9c8)](_0x2da390(0xb96)),_0x554f50=await _0x2c5bcf[_0x2da390(0x58a)][_0x2da390(0x5ff)]();_0x3f7dca[_0x2da390(0x2f5)]='',_0x554f50[_0x2da390(0xa06)]===0x0&&(_0x3f7dca[_0x2da390(0x2f5)]=_0x2da390(0x814)),_0x554f50[_0x2da390(0x591)](_0x47c5d7=>{const _0x248dae=_0x2da390,_0x35daed=document['createElement'](_0x248dae(0x11f4));_0x35daed[_0x248dae(0x82c)]=_0x248dae(0xf68),_0x35daed[_0x248dae(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x47c5d7[_0x248dae(0x609)]+_0x248dae(0x1d3)+_0x47c5d7['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3f7dca['appendChild'](_0x35daed);});}async function _0x2babf0(){const _0x14c51f=_0x419fa8,_0x35ce2d=document[_0x14c51f(0x9c8)](_0x14c51f(0xdcb)),_0x4c17d6=_0x35ce2d[_0x14c51f(0x1155)][_0x14c51f(0x3f1)]();if(!_0x4c17d6){alert(_0x14c51f(0xc5f));return;}const _0x2215cf=await _0x2c5bcf[_0x14c51f(0x58a)][_0x14c51f(0xe78)](_0x14c51f(0x609))[_0x14c51f(0xda9)](_0x4c17d6)[_0x14c51f(0x476)]();if(_0x2215cf){alert(_0x14c51f(0xdc9)+_0x4c17d6+_0x14c51f(0x9bf));return;}await _0x2c5bcf[_0x14c51f(0x58a)][_0x14c51f(0x68e)]({'name':_0x4c17d6}),_0x35ce2d[_0x14c51f(0x1155)]='',await _0xe43974();}async function _0x5b5362(_0x41e1b6){const _0x2b9473=_0x419fa8,_0x3661b9=await _0x352ae9('确认删除','删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？',{'confirmButtonClass':_0x2b9473(0x12bc)});if(_0x3661b9){await _0x2c5bcf['worldBookCategories']['delete'](_0x41e1b6);const _0xdaf70=await _0x2c5bcf[_0x2b9473(0x1369)]['where']('categoryId')['equals'](_0x41e1b6)[_0x2b9473(0x5ff)]();for(const _0x46b609 of _0xdaf70){_0x46b609[_0x2b9473(0x408)]=null,await _0x2c5bcf[_0x2b9473(0x1369)][_0x2b9473(0xff5)](_0x46b609);const _0x4dd64f=_0x9ebf46[_0x2b9473(0x1369)][_0x2b9473(0xfc3)](_0xbfbdc0=>_0xbfbdc0['id']===_0x46b609['id']);if(_0x4dd64f)_0x4dd64f[_0x2b9473(0x408)]=null;}await _0xe43974();}}async function _0x3c9fd1(){const _0x33576d=_0x419fa8;if(!_0x1f2a43)return;const _0x574fca=_0x1f2a43;_0x5c2bd9();const _0x5934bc=_0x9ebf46['chats'][_0x9ebf46[_0x33576d(0x970)]],_0x2491b0=_0x5934bc[_0x33576d(0x8b3)][_0x33576d(0xfc3)](_0x480f4e=>_0x480f4e[_0x33576d(0x6b5)]===_0x574fca);if(!_0x2491b0)return;let _0x5bf6ec=String(_0x2491b0['content']||'')[_0x33576d(0xc34)](0x0,0x32)+_0x33576d(0xf66);if(_0x2491b0[_0x33576d(0x12d9)]===_0x33576d(0x835))_0x5bf6ec=_0x33576d(0xc90)+_0x5bf6ec;const _0x2849b4=await _0x352ae9(_0x33576d(0xee8),'确定要将以下消息发布到公告板吗？\x0a\x0a“'+_0x5bf6ec+'”',{'confirmText':_0x33576d(0x7d6)});if(_0x2849b4){const _0x1b5d77=_0x5934bc[_0x33576d(0x1131)][_0x33576d(0x29c)]||'我';!Array[_0x33576d(0xb27)](_0x5934bc['announcements'])&&(_0x5934bc['announcements']=[]);const _0x480e7d={'id':_0x33576d(0xc81)+Date[_0x33576d(0x9b7)](),'messageTimestamp':_0x574fca,'publisher':_0x1b5d77,'publishedAt':Date['now'](),'isPinned':![]};_0x5934bc[_0x33576d(0xf3b)][_0x33576d(0x668)](_0x480e7d);const _0x308c4a={'role':'system','type':'pat_message','content':_0x1b5d77+_0x33576d(0xdbc),'timestamp':Date[_0x33576d(0x9b7)]()};_0x5934bc[_0x33576d(0x8b3)][_0x33576d(0x668)](_0x308c4a),await _0x2c5bcf[_0x33576d(0x547)][_0x33576d(0xff5)](_0x5934bc),_0xc4e879(_0x308c4a,_0x5934bc),_0x394b2c(),await _0x1bff53('成功',_0x33576d(0x12da));}}async function _0x5f5004(){const _0x25c9fb=_0x419fa8,_0x228f16=_0x9ebf46['chats'][_0x9ebf46[_0x25c9fb(0x970)]],_0x2a3f1d=_0x228f16[_0x25c9fb(0xf3b)]||[];if(!_0x228f16||_0x2a3f1d[_0x25c9fb(0xa06)]===0x0){_0x1bff53('提示',_0x25c9fb(0x577));return;}const _0x39bbd2=document[_0x25c9fb(0x9c8)](_0x25c9fb(0xcf0));_0x39bbd2[_0x25c9fb(0x2f5)]='',_0x2a3f1d[_0x25c9fb(0x66b)]((_0x4da536,_0x3c697d)=>(_0x3c697d[_0x25c9fb(0xfac)]?0x1:0x0)-(_0x4da536[_0x25c9fb(0xfac)]?0x1:0x0));for(const _0x21e5e1 of _0x2a3f1d){const _0x5de907=_0x228f16[_0x25c9fb(0x8b3)][_0x25c9fb(0xfc3)](_0x32e408=>_0x32e408[_0x25c9fb(0x6b5)]===_0x21e5e1[_0x25c9fb(0x83c)]),_0x45875c=document[_0x25c9fb(0x28a)](_0x25c9fb(0x11f4));_0x45875c[_0x25c9fb(0x82c)]=_0x25c9fb(0xef2);if(_0x5de907){const _0x2de7ee=await _0x8ae2cf(_0x5de907,_0x228f16);_0x2de7ee&&_0x45875c[_0x25c9fb(0x7b9)](_0x2de7ee);}else _0x45875c[_0x25c9fb(0x2f5)]=_0x25c9fb(0xe8d);_0x21e5e1[_0x25c9fb(0xfac)]&&(_0x45875c['innerHTML']+=_0x25c9fb(0x138f)),_0x45875c[_0x25c9fb(0x2f5)]+='<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22'+_0x21e5e1['id']+_0x25c9fb(0xc6c),_0x39bbd2[_0x25c9fb(0x7b9)](_0x45875c);}document[_0x25c9fb(0x9c8)]('announcement-board-modal')[_0x25c9fb(0x575)][_0x25c9fb(0x68e)](_0x25c9fb(0xc3f));}let _0x40b2a6=null;function _0x134e96(_0x36a68b){const _0x14c2d4=_0x419fa8;_0x40b2a6=_0x36a68b;const _0x10e18d=_0x9ebf46[_0x14c2d4(0x547)][_0x9ebf46['activeChatId']],_0x33d755=_0x10e18d[_0x14c2d4(0xf3b)][_0x14c2d4(0xfc3)](_0x5311c8=>_0x5311c8['id']===_0x36a68b);if(!_0x33d755)return;const _0x31af8e=document[_0x14c2d4(0x9c8)]('announcement-action-pin');_0x31af8e['textContent']=_0x33d755[_0x14c2d4(0xfac)]?_0x14c2d4(0x7a9):_0x14c2d4(0x12a9),document['getElementById'](_0x14c2d4(0x2fd))[_0x14c2d4(0x575)][_0x14c2d4(0x68e)](_0x14c2d4(0xc3f));}async function _0x399016(){const _0x186b6a=_0x419fa8;if(!_0x40b2a6)return;const _0x1264c2=_0x9ebf46[_0x186b6a(0x547)][_0x9ebf46[_0x186b6a(0x970)]],_0x135280=_0x1264c2[_0x186b6a(0xf3b)]['find'](_0x2a0376=>_0x2a0376['id']===_0x40b2a6);_0x135280&&(_0x135280[_0x186b6a(0xfac)]=!_0x135280[_0x186b6a(0xfac)],await _0x2c5bcf[_0x186b6a(0x547)][_0x186b6a(0xff5)](_0x1264c2),_0x5f5004()),document[_0x186b6a(0x9c8)](_0x186b6a(0x2fd))[_0x186b6a(0x575)]['remove'](_0x186b6a(0xc3f));}async function _0x21f644(){const _0x1d657b=_0x419fa8;if(!_0x40b2a6)return;const _0x39b76a=await _0x352ae9('确认删除',_0x1d657b(0x9b5),{'confirmButtonClass':_0x1d657b(0x12bc)});if(_0x39b76a){const _0x410c94=_0x9ebf46[_0x1d657b(0x547)][_0x9ebf46[_0x1d657b(0x970)]];_0x410c94['announcements']=_0x410c94[_0x1d657b(0xf3b)][_0x1d657b(0x401)](_0xd9f21=>_0xd9f21['id']!==_0x40b2a6),await _0x2c5bcf[_0x1d657b(0x547)][_0x1d657b(0xff5)](_0x410c94),_0x5f5004();}document[_0x1d657b(0x9c8)](_0x1d657b(0x2fd))['classList'][_0x1d657b(0x30f)](_0x1d657b(0xc3f));}let _0x4972c5=![],_0x1f7cd6={'ai':null,'my':null};function _0x5446cd(_0x45219e=_0x419fa8(0x8b0)){const _0xe2293f=_0x419fa8,_0x544320=document['getElementById']('avatar-frame-modal');if(!_0x9ebf46[_0xe2293f(0x970)])return;const _0x6c5702=_0x9ebf46['chats'][_0x9ebf46[_0xe2293f(0x970)]];_0x4972c5=_0x45219e===_0xe2293f(0x43b);if(_0x4972c5){const _0x56f870=_0x6c5702[_0xe2293f(0xd3e)][_0xe2293f(0xfc3)](_0x451a4c=>_0x451a4c['id']===_0x57617b);if(!_0x56f870)return;_0x1f7cd6['my']=_0x56f870['avatarFrame']||'',_0x3c2f7a(!![],_0x56f870[_0xe2293f(0x10c9)],_0x56f870[_0xe2293f(0x1141)]);}else _0x1f7cd6['ai']=_0x6c5702[_0xe2293f(0x1131)][_0xe2293f(0xdda)]||'',_0x1f7cd6['my']=_0x6c5702[_0xe2293f(0x1131)]['myAvatarFrame']||'',_0x3c2f7a(![]);_0x544320[_0xe2293f(0x575)][_0xe2293f(0x68e)](_0xe2293f(0xc3f));}function _0x3c2f7a(_0x314e61=![],_0x521d7c=null,_0x3265bb=null){const _0x37beb4=_0x419fa8,_0x31f15d=document['getElementById']('ai-frame-grid'),_0x338d22=document['getElementById'](_0x37beb4(0x302)),_0x93a7be=_0x9ebf46[_0x37beb4(0x547)][_0x9ebf46[_0x37beb4(0x970)]];_0x31f15d['innerHTML']='',_0x338d22[_0x37beb4(0x2f5)]='',document[_0x37beb4(0x91d)](_0x37beb4(0x1207))[_0x37beb4(0x5e1)][_0x37beb4(0x3c5)]=_0x314e61?_0x37beb4(0x8f6):_0x37beb4(0x989),document['getElementById'](_0x37beb4(0xd25))[_0x37beb4(0x5e1)]['display']=_0x37beb4(0x3d9),document[_0x37beb4(0x9c8)](_0x37beb4(0xa2f))['style'][_0x37beb4(0x3c5)]='none',document['getElementById']('ai-frame-tab')[_0x37beb4(0x575)][_0x37beb4(0x68e)](_0x37beb4(0x113d)),document['getElementById']('my-frame-tab')[_0x37beb4(0x575)][_0x37beb4(0x30f)](_0x37beb4(0x113d));if(_0x314e61)_0x4f4f26[_0x37beb4(0x591)](_0x5bc7c9=>{const _0x4ee001=_0x37beb4,_0x3d9ec7=_0x9b4b7f(_0x5bc7c9,'my',_0x521d7c);_0x5bc7c9[_0x4ee001(0x11be)]===_0x3265bb&&_0x3d9ec7[_0x4ee001(0x575)][_0x4ee001(0x68e)](_0x4ee001(0x631)),_0x31f15d[_0x4ee001(0x7b9)](_0x3d9ec7);});else{const _0x184883=_0x93a7be[_0x37beb4(0x1131)][_0x37beb4(0xd4d)]||_0x246753,_0x1647b0=_0x93a7be[_0x37beb4(0x1131)][_0x37beb4(0xb60)]||(_0x93a7be['isGroup']?_0x1d990b:_0x246753);_0x4f4f26[_0x37beb4(0x591)](_0x437863=>{const _0x3b8aa8=_0x37beb4,_0x14d20a=_0x9b4b7f(_0x437863,'ai',_0x184883);if(_0x437863['url']===_0x1f7cd6['ai'])_0x14d20a[_0x3b8aa8(0x575)][_0x3b8aa8(0x68e)](_0x3b8aa8(0x631));_0x31f15d[_0x3b8aa8(0x7b9)](_0x14d20a);const _0x30ce88=_0x9b4b7f(_0x437863,'my',_0x1647b0);if(_0x437863[_0x3b8aa8(0x11be)]===_0x1f7cd6['my'])_0x30ce88[_0x3b8aa8(0x575)][_0x3b8aa8(0x68e)](_0x3b8aa8(0x631));_0x338d22[_0x3b8aa8(0x7b9)](_0x30ce88);});}}function _0x9b4b7f(_0x281a0c,_0x3e2817,_0x36805e){const _0x3bf377=_0x419fa8,_0x4b87b7=document[_0x3bf377(0x28a)](_0x3bf377(0x11f4));return _0x4b87b7[_0x3bf377(0x82c)]=_0x3bf377(0xe06),_0x4b87b7['dataset'][_0x3bf377(0x7d8)]=_0x281a0c[_0x3bf377(0x11be)],_0x4b87b7[_0x3bf377(0x9f2)]=_0x281a0c['name'],_0x4b87b7[_0x3bf377(0x2f5)]=_0x3bf377(0xbef)+_0x36805e+'\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x281a0c[_0x3bf377(0x11be)]?_0x3bf377(0x12ac)+_0x281a0c['url']+_0x3bf377(0x8cd):'')+_0x3bf377(0x11e0),_0x4b87b7[_0x3bf377(0xa0f)](_0x3bf377(0xf5c),()=>{const _0x50ade3=_0x3bf377;_0x1f7cd6[_0x3e2817]=_0x281a0c[_0x50ade3(0x11be)];const _0x4b4a5c=_0x3e2817==='ai'?document[_0x50ade3(0x9c8)](_0x50ade3(0x2ac)):document[_0x50ade3(0x9c8)](_0x50ade3(0x302));_0x4b4a5c[_0x50ade3(0x7e4)](_0x50ade3(0x1161))['forEach'](_0x48737d=>_0x48737d[_0x50ade3(0x575)][_0x50ade3(0x30f)](_0x50ade3(0x631))),_0x4b87b7[_0x50ade3(0x575)]['add'](_0x50ade3(0x631));}),_0x4b87b7;}async function _0x46cb1a(){const _0xe084f1=_0x419fa8;if(!_0x9ebf46[_0xe084f1(0x970)])return;const _0x51e5ed=_0x9ebf46[_0xe084f1(0x547)][_0x9ebf46['activeChatId']];if(_0x4972c5){const _0x9fc182=_0x51e5ed[_0xe084f1(0xd3e)][_0xe084f1(0xfc3)](_0x4ae1f9=>_0x4ae1f9['id']===_0x57617b);_0x9fc182&&(_0x9fc182[_0xe084f1(0x1141)]=_0x1f7cd6['my']);}else _0x51e5ed[_0xe084f1(0x1131)][_0xe084f1(0xdda)]=_0x1f7cd6['ai'],_0x51e5ed[_0xe084f1(0x1131)][_0xe084f1(0x2a2)]=_0x1f7cd6['my'];await _0x2c5bcf[_0xe084f1(0x547)][_0xe084f1(0xff5)](_0x51e5ed);if(!_0x4972c5&&!_0x51e5ed[_0xe084f1(0x11e4)]){const _0x176eb2=_0x51e5ed['id'];for(const _0x44aabc of Object[_0xe084f1(0xeb2)](_0x9ebf46[_0xe084f1(0x547)])){if(_0x44aabc[_0xe084f1(0x11e4)]&&_0x44aabc['members']){const _0x13ea06=_0x44aabc['members'][_0xe084f1(0xfc3)](_0x1b348c=>_0x1b348c['id']===_0x176eb2);_0x13ea06&&(_0x13ea06[_0xe084f1(0x1141)]=_0x51e5ed[_0xe084f1(0x1131)]['aiAvatarFrame'],await _0x2c5bcf[_0xe084f1(0x547)][_0xe084f1(0xff5)](_0x44aabc),console[_0xe084f1(0x283)](_0xe084f1(0x1181)+_0x176eb2+_0xe084f1(0xfcd)+_0x44aabc['name']+'\x22'));}}}document['getElementById']('avatar-frame-modal')[_0xe084f1(0x575)][_0xe084f1(0x30f)]('visible'),_0x1a44b1(_0x9ebf46[_0xe084f1(0x970)]),alert(_0xe084f1(0x581)),_0x4972c5=![];}function _0x38af39(){const _0x261b34=_0x419fa8;_0x4d9412=!_0x4d9412;const _0x27f46f=document['getElementById']('manage-frames-btn'),_0x47a3c7=document['getElementById']('frame-action-bar'),_0x4eb2de=document[_0x261b34(0x9c8)]('select-all-frames-checkbox');document['querySelectorAll'](_0x261b34(0x4db))[_0x261b34(0x591)](_0x8a68fd=>{const _0x110164=_0x261b34;_0x8a68fd[_0x110164(0x575)][_0x110164(0x1c3)](_0x110164(0x7a7),_0x4d9412);}),_0x4d9412?(_0x27f46f[_0x261b34(0xe24)]='完成',_0x47a3c7['style']['display']=_0x261b34(0x989),_0x136906[_0x261b34(0xdae)](),_0x4eb2de['checked']=![],_0x23159c()):(_0x27f46f[_0x261b34(0xe24)]='管理',_0x47a3c7['style'][_0x261b34(0x3c5)]=_0x261b34(0x8f6),document[_0x261b34(0x7e4)](_0x261b34(0x947))['forEach'](_0x171aed=>{const _0x2f664a=_0x261b34;_0x171aed[_0x2f664a(0x575)][_0x2f664a(0x30f)](_0x2f664a(0x631));}));}function _0x23159c(){const _0xfd1da5=_0x419fa8,_0x3a6f20=document[_0xfd1da5(0x9c8)](_0xfd1da5(0xb36));_0x3a6f20[_0xfd1da5(0xe24)]='删除\x20('+_0x136906[_0xfd1da5(0xa67)]+')';}function _0x1f426f(){const _0x2d7412=_0x419fa8,_0x16e4c8=document[_0x2d7412(0x9c8)](_0x2d7412(0xca2))['checked'],_0x157f98=document[_0x2d7412(0x91d)](_0x2d7412(0xc84));if(!_0x157f98)return;_0x157f98[_0x2d7412(0x7e4)](_0x2d7412(0xf14))[_0x2d7412(0x591)](_0x223850=>{const _0x35f6c3=_0x2d7412,_0x47b503=parseInt(_0x223850[_0x35f6c3(0x91d)](_0x35f6c3(0xcb4))['dataset']['id']);if(isNaN(_0x47b503))return;_0x223850['classList'][_0x35f6c3(0x1c3)](_0x35f6c3(0x631),_0x16e4c8),_0x16e4c8?_0x136906['add'](_0x47b503):_0x136906[_0x35f6c3(0x6d2)](_0x47b503);}),_0x23159c();}async function _0x4636c4(){const _0x26e195=_0x419fa8;if(_0x136906['size']===0x0)return;const _0x75a4ba=await _0x352ae9(_0x26e195(0x115b),'确定要永久删除选中的\x20'+_0x136906['size']+_0x26e195(0xb9b),{'confirmButtonClass':_0x26e195(0x12bc)});if(_0x75a4ba){const _0x198a5e=[..._0x136906];await _0x2c5bcf[_0x26e195(0x36b)][_0x26e195(0x256)](_0x198a5e),_0x38af39(),_0x3c2f7a(_0x4972c5),await _0x1bff53('删除成功','选中的头像框已成功删除。');}}function _0x4bc8ea(_0x544582){const _0x4a2b8c=_0x419fa8,_0x17a0fc=document['getElementById'](_0x4a2b8c(0x1256));_0x17a0fc&&(_0x17a0fc['innerHTML']=_0x544582||'');}async function _0x38b71e(_0xc46fa1){const _0x1069a5=_0x419fa8;if(!_0x5062a9[_0x1069a5(0x103f)]||!_0x5062a9[_0x1069a5(0x970)])return;const _0x466c8c=_0x9ebf46[_0x1069a5(0x547)][_0x5062a9[_0x1069a5(0x970)]];if(!_0x466c8c)return;const _0x57f7f4=_0x466c8c[_0x1069a5(0x11e4)]?_0x466c8c[_0x1069a5(0x1131)][_0x1069a5(0x29c)]||'我':'我',_0x32233b=_0x1069a5(0xc77)+_0x57f7f4+')\x20'+_0xc46fa1+']',_0x27f7a7={'role':'system','content':_0x32233b,'timestamp':Date['now'](),'isHidden':!![]};_0x466c8c[_0x1069a5(0x8b3)][_0x1069a5(0x668)](_0x27f7a7),await _0x2c5bcf[_0x1069a5(0x547)]['put'](_0x466c8c);}async function _0x4afd25(){const _0x3c6b7d=_0x419fa8;if(_0x24fb08['size']===0x0)return;const _0x2dc8ea=_0x9ebf46[_0x3c6b7d(0x547)][_0x9ebf46[_0x3c6b7d(0x970)]];if(!_0x2dc8ea)return;const _0x31c3a1=document[_0x3c6b7d(0x9c8)](_0x3c6b7d(0xd87)),_0x321dbe=_0x31c3a1['textContent'];_0x31c3a1['textContent']=_0x3c6b7d(0xfe7),_0x31c3a1[_0x3c6b7d(0x823)]=!![];const _0xafde56=document[_0x3c6b7d(0x28a)](_0x3c6b7d(0x11f4)),_0xbde5b7=document['getElementById'](_0x3c6b7d(0x6fb));_0xafde56['style']['width']=_0xbde5b7['offsetWidth']+'px',_0xafde56[_0x3c6b7d(0x5e1)][_0x3c6b7d(0x54b)]='absolute',_0xafde56['style'][_0x3c6b7d(0x114a)]=_0x3c6b7d(0x56c),_0xafde56[_0x3c6b7d(0x5e1)][_0x3c6b7d(0x12b6)]=_0x3c6b7d(0x56c),_0xafde56[_0x3c6b7d(0x5e1)][_0x3c6b7d(0x3c5)]=_0x3c6b7d(0x989),_0xafde56['style'][_0x3c6b7d(0x10d4)]=_0x3c6b7d(0x730),_0xafde56['style']['height']='auto';const _0x4f7444=document[_0x3c6b7d(0x9c8)](_0x3c6b7d(0x504));_0xafde56[_0x3c6b7d(0x5e1)][_0x3c6b7d(0x11d9)]=_0x4f7444['style'][_0x3c6b7d(0x11d9)],_0xafde56['style'][_0x3c6b7d(0x8e2)]=_0x4f7444[_0x3c6b7d(0x5e1)][_0x3c6b7d(0x8e2)]||(document['getElementById']('phone-screen')['classList']['contains'](_0x3c6b7d(0x292))?_0x3c6b7d(0xee1):_0x3c6b7d(0xbea));const _0x17452b=document[_0x3c6b7d(0x28a)](_0x3c6b7d(0x5e1));_0x17452b['innerHTML']=_0x3c6b7d(0xe02),document[_0x3c6b7d(0x37a)][_0x3c6b7d(0x7b9)](_0x17452b);try{const _0x807d11=_0x4f7444[_0x3c6b7d(0x91d)]('.header')[_0x3c6b7d(0x75c)](!![]);_0x807d11[_0x3c6b7d(0x575)][_0x3c6b7d(0x68e)](_0x3c6b7d(0x776));const _0xf19e6e=document[_0x3c6b7d(0x28a)](_0x3c6b7d(0x11f4)),_0x482b94=document[_0x3c6b7d(0x9c8)](_0x3c6b7d(0xbff));_0xf19e6e[_0x3c6b7d(0x5e1)]['display']=_0x3c6b7d(0x989),_0xf19e6e[_0x3c6b7d(0x5e1)]['flexDirection']=_0x3c6b7d(0x730),_0xf19e6e[_0x3c6b7d(0x5e1)]['gap']=_0x3c6b7d(0x10f6),_0xf19e6e[_0x3c6b7d(0x5e1)][_0x3c6b7d(0xcc2)]=_0x3c6b7d(0x11d1),_0xf19e6e[_0x3c6b7d(0x5e1)][_0x3c6b7d(0x125e)]='100%',_0xf19e6e[_0x3c6b7d(0x5e1)]['boxSizing']=_0x3c6b7d(0x1057),_0xf19e6e[_0x3c6b7d(0xc9f)][_0x3c6b7d(0x56d)]=_0x482b94['dataset'][_0x3c6b7d(0x56d)],_0xf19e6e[_0x3c6b7d(0x5e1)][_0x3c6b7d(0xa9e)](_0x3c6b7d(0x1110),_0x482b94[_0x3c6b7d(0x5e1)][_0x3c6b7d(0xa34)](_0x3c6b7d(0x1110)));const _0x84e380=_0x4f7444[_0x3c6b7d(0x91d)](_0x3c6b7d(0xacb))['cloneNode'](!![]),_0x301a90=[..._0x24fb08][_0x3c6b7d(0x66b)]((_0x3e3fe1,_0x170137)=>_0x3e3fe1-_0x170137);_0x301a90['forEach'](_0x154a55=>{const _0x313a22=_0x3c6b7d,_0x246883=document['querySelector'](_0x313a22(0x47f)+_0x154a55+'\x22]');if(_0x246883){const _0x3d4177=_0x246883['closest'](_0x313a22(0x6f0));_0x3d4177&&_0xf19e6e[_0x313a22(0x7b9)](_0x3d4177[_0x313a22(0x75c)](!![]));}}),_0xafde56[_0x3c6b7d(0x7b9)](_0x807d11),_0xafde56['appendChild'](_0xf19e6e),_0xafde56[_0x3c6b7d(0x7b9)](_0x84e380),document[_0x3c6b7d(0xe20)]['appendChild'](_0xafde56);const _0x1be58c=Array[_0x3c6b7d(0x13a5)](_0xafde56[_0x3c6b7d(0x7ba)](_0x3c6b7d(0x889))),_0x4f5bce=_0x1be58c['map'](_0x3e6c14=>new Promise((_0x4ce815,_0x510924)=>{const _0x8d03d5=_0x3c6b7d;if(_0x3e6c14['src'][_0x8d03d5(0xc8d)]('data:')){_0x4ce815();return;}const _0x29ce88=new Image();_0x29ce88[_0x8d03d5(0xbdd)]=_0x8d03d5(0x268),_0x29ce88[_0x8d03d5(0x429)]=_0x4ce815,_0x29ce88[_0x8d03d5(0x11e5)]=_0x4ce815,_0x29ce88[_0x8d03d5(0xbf4)]=_0x3e6c14[_0x8d03d5(0xbf4)];}));await Promise[_0x3c6b7d(0xd0a)](_0x4f5bce);const _0x195c74=await html2canvas(_0xafde56,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window[_0x3c6b7d(0x11eb)]||0x2});_0x195c74['toBlob'](function(_0xe063d9){const _0x372cec=_0x3c6b7d,_0x106375=URL[_0x372cec(0x5bb)](_0xe063d9),_0x465151=document[_0x372cec(0x28a)]('a');_0x465151[_0x372cec(0x6a4)]=_0x372cec(0xebf)+_0x2dc8ea[_0x372cec(0x609)]+'-'+Date[_0x372cec(0x9b7)]()+_0x372cec(0xa8f),_0x465151[_0x372cec(0xc4a)]=_0x106375,document[_0x372cec(0xe20)][_0x372cec(0x7b9)](_0x465151),_0x465151[_0x372cec(0xf5c)](),document[_0x372cec(0xe20)][_0x372cec(0x9f8)](_0x465151),URL[_0x372cec(0x1268)](_0x106375);},'image/png');}catch(_0x5468f2){console[_0x3c6b7d(0x1221)](_0x3c6b7d(0x12ea),_0x5468f2),await _0x1bff53(_0x3c6b7d(0xf8d),'生成截图时发生错误，请检查控制台获取详情。');}finally{document['body']['removeChild'](_0xafde56),document[_0x3c6b7d(0x37a)][_0x3c6b7d(0x9f8)](_0x17452b),_0x31c3a1[_0x3c6b7d(0xe24)]=_0x321dbe,_0x31c3a1[_0x3c6b7d(0x823)]=![],_0x2d6552();}}function _0x1ffeeb(_0x202dec){const _0x3f48f6=_0x419fa8;if(!_0x202dec||typeof _0x202dec!==_0x3f48f6(0xe56))return'';return _0x202dec=_0x202dec['replace'](/!h\{(.*?)\}/g,_0x3f48f6(0x503)),_0x202dec=_0x202dec['replace'](/!u\{(.*?)\}/g,'<span\x20class=\x22diary-underline\x22>$1</span>'),_0x202dec=_0x202dec[_0x3f48f6(0x459)](/!e\{(.*?)\}/g,'<span\x20class=\x22diary-emphasis\x22>$1</span>'),_0x202dec=_0x202dec[_0x3f48f6(0x459)](/!w\{(.*?)\}/g,_0x3f48f6(0x8a9)),_0x202dec=_0x202dec[_0x3f48f6(0x459)](/!m\{(.*?)\}/g,_0x3f48f6(0x10b0)),_0x202dec=_0x202dec['replace'](/\|\|(.*?)\|\|/g,'<span\x20class=\x22spoiler\x22>$1</span>'),_0x202dec=_0x202dec[_0x3f48f6(0x459)](/\*\*(.*?)\*\*/g,_0x3f48f6(0x579)),_0x202dec=_0x202dec['replace'](/\~\~(.*?)\~\~/g,_0x3f48f6(0x11f6)),_0x202dec=_0x202dec[_0x3f48f6(0x459)](/\*(.*?)\*/g,'<em>$1</em>'),_0x202dec;}async function _0x3df474(){const _0x4c2c0c=_0x419fa8;console[_0x4c2c0c(0x283)](_0x4c2c0c(0xced));let _0x1080e0=0x0;const _0x38409c=Object['values'](_0x9ebf46[_0x4c2c0c(0x547)]);for(const _0x2556bf of _0x38409c){let _0x4e8014=![];for(const _0x50703e of _0x2556bf[_0x4c2c0c(0x8b3)]){_0x50703e[_0x4c2c0c(0x12d9)]===_0x4c2c0c(0xf67)&&_0x50703e['packetType']==='direct'&&_0x50703e[_0x4c2c0c(0x7fd)]===_0x4c2c0c(0x1a7)&&_0x50703e[_0x4c2c0c(0x3de)](_0x4c2c0c(0x7bd))&&!_0x50703e[_0x4c2c0c(0x3de)]('receiverName')&&(_0x50703e[_0x4c2c0c(0xc8a)]=_0x50703e['receiver'],delete _0x50703e[_0x4c2c0c(0x7bd)],_0x4e8014=!![],_0x1080e0++);}_0x4e8014&&(console['log'](_0x4c2c0c(0x8c3)+_0x2556bf[_0x4c2c0c(0x609)]+_0x4c2c0c(0xb48)),await _0x2c5bcf[_0x4c2c0c(0x547)][_0x4c2c0c(0xff5)](_0x2556bf));}_0x1080e0>0x0?(console[_0x4c2c0c(0x283)](_0x4c2c0c(0x1101)+_0x1080e0+_0x4c2c0c(0x2d4)),alert('检测到并成功修复了\x20'+_0x1080e0+'\x20条旧的红包消息！页面将自动刷新以应用更改。'),location[_0x4c2c0c(0xea6)]()):console['log'](_0x4c2c0c(0x1301));}function _0x257d91(_0x2122cc){const _0x10e575=_0x419fa8,_0x57f72f=_0x9ebf46['chats'][_0x2122cc];if(!_0x57f72f||_0x57f72f[_0x10e575(0x11e4)])return;document[_0x10e575(0x9c8)](_0x10e575(0x2f8))[_0x10e575(0xe24)]=_0x57f72f[_0x10e575(0x1291)]||_0x10e575(0xf66),document[_0x10e575(0x9c8)]('profile-random-jottings')[_0x10e575(0xe24)]=_0x57f72f[_0x10e575(0xa1a)]||'...';const _0x2c0e24=document['getElementById']('character-profile-modal');_0x2c0e24[_0x10e575(0x575)][_0x10e575(0x68e)](_0x10e575(0xc3f));}function _0x40b003(){const _0x56a7bc=_0x419fa8;document['getElementById'](_0x56a7bc(0x73e))[_0x56a7bc(0x5e1)][_0x56a7bc(0x3c5)]=_0x56a7bc(0x8f6),document[_0x56a7bc(0x9c8)](_0x56a7bc(0xed9))[_0x56a7bc(0x5e1)][_0x56a7bc(0x3c5)]=_0x56a7bc(0x989),_0x3f826d();}function _0x314c27(){const _0xf68d6d=_0x419fa8;document['getElementById'](_0xf68d6d(0xed9))[_0xf68d6d(0x5e1)][_0xf68d6d(0x3c5)]=_0xf68d6d(0x8f6),document[_0xf68d6d(0x9c8)](_0xf68d6d(0x73e))[_0xf68d6d(0x5e1)][_0xf68d6d(0x3c5)]=_0xf68d6d(0x989);}function _0x3f826d(){const _0x436ce0=_0x419fa8,_0x167ee6=document[_0x436ce0(0x9c8)]('thoughts-history-list'),_0x15b187=_0x9ebf46[_0x436ce0(0x547)][_0x9ebf46['activeChatId']];_0x167ee6['innerHTML']='';if(!_0x15b187||!_0x15b187[_0x436ce0(0xec6)]||_0x15b187[_0x436ce0(0xec6)][_0x436ce0(0xa06)]===0x0){_0x167ee6[_0x436ce0(0x2f5)]=_0x436ce0(0x118d);return;}const _0x5b0294=[..._0x15b187[_0x436ce0(0xec6)]][_0x436ce0(0x101e)](),_0x40011d=_0x5b0294[_0x436ce0(0x1044)](0x0,_0x24712c);_0x40011d['forEach'](_0x25bb21=>{const _0x238d47=_0x436ce0,_0x3b9705=_0x3b383d(_0x25bb21);_0x167ee6[_0x238d47(0x7b9)](_0x3b9705);}),_0x3e7d67=_0x40011d[_0x436ce0(0xa06)],_0x5b0294[_0x436ce0(0xa06)]>_0x3e7d67&&appendLoadMoreThoughtsButton(_0x167ee6);}async function _0x5b2a99(){const _0x332941=_0x419fa8;if(_0x18bae1)return;_0x18bae1=!![];const _0x49c0d7=document['getElementById'](_0x332941(0x771)),_0x304b5a=_0x9ebf46['chats'][_0x9ebf46[_0x332941(0x970)]];if(!_0x304b5a){_0x18bae1=![];return;}_0xde08bb(_0x49c0d7,_0x332941(0x40f)),await new Promise(_0x2a4efe=>setTimeout(_0x2a4efe,0x1f4));const _0x4d04ce=[..._0x304b5a[_0x332941(0xec6)]][_0x332941(0x101e)](),_0x5ed4b7=_0x4d04ce[_0x332941(0xa06)],_0x1b1239=_0x3e7d67,_0x461ff0=_0x3e7d67+_0x24712c,_0xf79b03=_0x4d04ce[_0x332941(0x1044)](_0x1b1239,_0x461ff0);_0xfb2eb9(_0x49c0d7),_0xf79b03['forEach'](_0x1d512f=>{const _0x390785=_0x3b383d(_0x1d512f);_0x49c0d7['appendChild'](_0x390785);}),_0x3e7d67+=_0xf79b03[_0x332941(0xa06)],_0x18bae1=![];}function _0x3b383d(_0x386198){const _0x38b8de=_0x419fa8,_0x280334=document['createElement'](_0x38b8de(0x11f4));_0x280334[_0x38b8de(0x82c)]=_0x38b8de(0xc7c);const _0x380e3a=new Date(_0x386198[_0x38b8de(0x6b5)]),_0x53ac44=_0x380e3a[_0x38b8de(0x10cd)]()+'-'+String(_0x380e3a[_0x38b8de(0x260)]()+0x1)[_0x38b8de(0x3e8)](0x2,'0')+'-'+String(_0x380e3a['getDate']())[_0x38b8de(0x3e8)](0x2,'0')+'\x20'+String(_0x380e3a[_0x38b8de(0x7a2)]())[_0x38b8de(0x3e8)](0x2,'0')+':'+String(_0x380e3a[_0x38b8de(0x3a6)]())['padStart'](0x2,'0');return _0x280334[_0x38b8de(0x2f5)]=_0x38b8de(0x11aa)+_0x386198[_0x38b8de(0x6b5)]+_0x38b8de(0xe26)+_0x53ac44+_0x38b8de(0xb9e)+_0x386198[_0x38b8de(0x1291)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>'+_0x386198[_0x38b8de(0xa1a)]+_0x38b8de(0x206),_0x280334;}async function _0x406179(_0x92353d){const _0x23f980=_0x419fa8,_0x3d2f0c=_0x92353d[_0x23f980(0x1070)]['files'][0x0];if(!_0x3d2f0c)return;try{let _0x20756a,_0x5cb289=null;if(_0x3d2f0c[_0x23f980(0x609)][_0x23f980(0x6b1)]('.json')){const _0x4ff7df=await _0x3d2f0c[_0x23f980(0xbb7)]();_0x20756a=JSON[_0x23f980(0x907)](_0x4ff7df);}else{if(_0x3d2f0c['name'][_0x23f980(0x6b1)](_0x23f980(0xa8f))){const _0x5e41ce=await _0x3d2f0c[_0x23f980(0x72b)]();_0x20756a=await _0x35ada5(_0x5e41ce),_0x5cb289=await new Promise(_0x1fcfa9=>{const _0x430230=_0x23f980,_0x4c2ccc=new FileReader();_0x4c2ccc['onload']=()=>_0x1fcfa9(_0x4c2ccc[_0x430230(0xceb)]),_0x4c2ccc['readAsDataURL'](_0x3d2f0c);});}else throw new Error(_0x23f980(0xa9d));}await _0x1e2468(_0x20756a,_0x5cb289);}catch(_0x7da224){console['error'](_0x23f980(0xf1d),_0x7da224),await _0x1bff53(_0x23f980(0x685),_0x23f980(0x6b3)+_0x7da224[_0x23f980(0x86e)]);}finally{_0x92353d[_0x23f980(0x1070)]['value']=null;}}function _0x35ada5(_0x4ea901){return new Promise((_0x46ef3f,_0x10b349)=>{const _0x45b467=_0x3569,_0x37ea48=new DataView(_0x4ea901);if(_0x37ea48[_0x45b467(0x593)](0x0)!==0x89504e47||_0x37ea48[_0x45b467(0x593)](0x4)!==0xd0a1a0a)return _0x10b349(new Error(_0x45b467(0xa87)));let _0x24f529=0x8;const _0x394909=new TextDecoder();while(_0x24f529<_0x37ea48[_0x45b467(0x7f7)]){const _0x413db0=_0x37ea48['getUint32'](_0x24f529),_0x1bd697=_0x394909['decode'](_0x4ea901['slice'](_0x24f529+0x4,_0x24f529+0x8));if(_0x1bd697===_0x45b467(0x19b)){const _0x174cbe=new Uint8Array(_0x4ea901,_0x24f529+0x8,_0x413db0),_0x2e6548=_0x174cbe[_0x45b467(0x78e)](0x0);if(_0x2e6548!==-0x1){const _0x20c31c=_0x394909[_0x45b467(0x128e)](_0x174cbe['slice'](0x0,_0x2e6548));if(_0x20c31c===_0x45b467(0x6bf)){const _0x4bf42f=_0x394909[_0x45b467(0x128e)](_0x174cbe[_0x45b467(0x1044)](_0x2e6548+0x1));try{const _0x586017=atob(_0x4bf42f),_0x157165=new Uint8Array(_0x586017[_0x45b467(0xa06)]);for(let _0x315d1a=0x0;_0x315d1a<_0x586017[_0x45b467(0xa06)];_0x315d1a++){_0x157165[_0x315d1a]=_0x586017[_0x45b467(0xf76)](_0x315d1a);}const _0x9db829=new TextDecoder('utf-8')[_0x45b467(0x128e)](_0x157165);_0x46ef3f(JSON[_0x45b467(0x907)](_0x9db829));return;}catch(_0x37b7f1){return _0x10b349(new Error(_0x45b467(0x4a0)+_0x37b7f1[_0x45b467(0x86e)]));}}}}_0x24f529+=0x4+0x4+_0x413db0+0x4;}_0x10b349(new Error('在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。'));});}function _0x228209(_0x3eba81){const _0x43faa9=_0x419fa8;if(_0x3eba81['data']?.[_0x43faa9(0x46c)]?.[_0x43faa9(0x1231)]?.[_0x43faa9(0xa06)]>0x0)return console[_0x43faa9(0x283)]('诊断：在\x20data.character_book\x20中找到世界书。'),_0x3eba81['data'][_0x43faa9(0x46c)]['entries'];if(_0x3eba81['extensions']?.[_0x43faa9(0x46c)]?.['entries']?.[_0x43faa9(0xa06)]>0x0)return console[_0x43faa9(0x283)]('诊断：在\x20extensions.character_book\x20中找到世界书。'),_0x3eba81[_0x43faa9(0x3c1)][_0x43faa9(0x46c)]['entries'];if(_0x3eba81[_0x43faa9(0x100d)]?.[_0x43faa9(0x3c1)]?.[_0x43faa9(0x46c)]?.[_0x43faa9(0x1231)]?.['length']>0x0)return console['log'](_0x43faa9(0xb0b)),_0x3eba81['data'][_0x43faa9(0x3c1)]['character_book'][_0x43faa9(0x1231)];const _0x3971da=[_0x43faa9(0x46c),'lorebook',_0x43faa9(0xbb3),_0x43faa9(0x994)];for(const _0x1f64e8 of _0x3971da){if(_0x3eba81[_0x1f64e8]?.[_0x43faa9(0x1231)]?.[_0x43faa9(0xa06)]>0x0)return console['log'](_0x43faa9(0xbed)+_0x1f64e8+_0x43faa9(0x2c3)),_0x3eba81[_0x1f64e8][_0x43faa9(0x1231)];}return console[_0x43faa9(0x283)]('诊断：未在此角色卡中找到任何有效的世界书数据。'),null;}async function _0x1e2468(_0x17d153,_0x534557=null){const _0x3143d3=_0x419fa8,_0x159b07=_0x17d153[_0x3143d3(0x100d)]||_0x17d153;if(!_0x159b07[_0x3143d3(0x609)])throw new Error(_0x3143d3(0x8f0));let _0x38fe7e=null;const _0x1739f1=_0x228209(_0x17d153);if(_0x1739f1){const _0xac3774=_0x1739f1[_0x3143d3(0x401)](_0xb3b0f3=>_0xb3b0f3[_0x3143d3(0x38a)]&&_0xb3b0f3[_0x3143d3(0x53b)])[_0x3143d3(0xa3b)](_0x32bbe7=>({'keys':_0x32bbe7[_0x3143d3(0x2bd)]||[],'comment':_0x32bbe7[_0x3143d3(0x10de)]||'','content':_0x32bbe7[_0x3143d3(0x53b)]['replace'](/<memory>|<\/memory>/g,'')[_0x3143d3(0x3f1)]()}));if(_0xac3774['length']>0x0){const _0x526ce7={'id':'wb_'+Date['now'](),'name':_0x159b07['name']+_0x3143d3(0xd50),'content':_0xac3774,'categoryId':null};await _0x2c5bcf['worldBooks'][_0x3143d3(0x68e)](_0x526ce7),_0x9ebf46[_0x3143d3(0x1369)][_0x3143d3(0x668)](_0x526ce7),_0x38fe7e=_0x526ce7['id'];}}let _0x3a46c6=_0x159b07['description']||_0x17d153[_0x3143d3(0x1387)]||'无';_0x3a46c6=_0x3a46c6[_0x3143d3(0x459)](/```yaml/g,'')[_0x3143d3(0x459)](/```/g,'')['replace'](/<\/?info>/g,'')[_0x3143d3(0x459)](/<\/?character>/g,'')[_0x3143d3(0x459)](/<\/?writing_rule>/g,'')[_0x3143d3(0x459)](/\[OOC：.*?\]/g,'')[_0x3143d3(0x3f1)]();let _0x5a144c=_0x3143d3(0xaa4)+_0x3a46c6+'\x0a\x0a';if(_0x159b07[_0x3143d3(0xa3e)])_0x5a144c+='#\x20性格补充\x0a'+_0x159b07[_0x3143d3(0xa3e)]+'\x0a\x0a';if(_0x159b07['scenario'])_0x5a144c+=_0x3143d3(0x1279)+_0x159b07['scenario']+'\x0a\x0a';if(_0x159b07[_0x3143d3(0xda2)])_0x5a144c+=_0x3143d3(0x13c8)+_0x159b07[_0x3143d3(0xda2)]+'\x0a\x0a';const _0x29a56a=_0x159b07['name'],_0x3e2b5d=_0x159b07[_0x3143d3(0x609)],_0x351377=_0x3143d3(0xa63)+Date['now'](),_0x177a56={'id':_0x351377,'name':_0x29a56a['trim'](),'originalName':_0x3e2b5d['trim'](),'isGroup':![],'relationship':{'status':_0x3143d3(0x733)},'status':{'text':'在线','lastUpdate':Date[_0x3143d3(0x9b7)](),'isBusy':![]},'settings':{'aiPersona':_0x5a144c,'myPersona':_0x3143d3(0xafc),'maxMemory':0xa,'aiAvatar':_0x246753,'myAvatar':_0x246753,'background':'','theme':_0x3143d3(0x108b),'fontSize':0xd,'customCss':'','linkedWorldBookIds':_0x38fe7e?[_0x38fe7e]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0x534557&&(_0x177a56[_0x3143d3(0x1131)][_0x3143d3(0xd4d)]=_0x534557,_0x177a56[_0x3143d3(0x1131)][_0x3143d3(0x295)][_0x3143d3(0x668)]({'name':'默认头像','url':_0x534557}));const _0x1e1efa=_0x159b07[_0x3143d3(0x1111)]||_0x17d153[_0x3143d3(0x1111)];if(_0x1e1efa&&typeof _0x1e1efa===_0x3143d3(0xe56)){const _0x12b2f5=document[_0x3143d3(0x28a)](_0x3143d3(0x11f4));_0x12b2f5['innerHTML']=_0x1e1efa;const _0x28c43c=(_0x12b2f5[_0x3143d3(0xe24)]||_0x12b2f5[_0x3143d3(0x1239)]||'')['replace'](/原作者UR.*?开局/s,'')['trim']();_0x28c43c&&_0x177a56[_0x3143d3(0x8b3)][_0x3143d3(0x668)]({'role':_0x3143d3(0x1a7),'senderName':_0x177a56[_0x3143d3(0x1071)],'content':_0x28c43c,'timestamp':Date['now']()});}_0x9ebf46[_0x3143d3(0x547)][_0x351377]=_0x177a56,await _0x2c5bcf[_0x3143d3(0x547)][_0x3143d3(0xff5)](_0x177a56),_0x394b2c();let _0x3fdebb=_0x3143d3(0x634)+_0x177a56[_0x3143d3(0x609)]+'”\x20已成功导入！';_0x38fe7e&&(_0x3fdebb+=_0x3143d3(0x5df)),await _0x1bff53(_0x3143d3(0x858),_0x3fdebb);}async function _0x160d99(){const _0x5af53c=_0x419fa8;if(!_0x9ebf46[_0x5af53c(0x970)])return;const _0x3f54a3=_0x9ebf46['chats'][_0x9ebf46[_0x5af53c(0x970)]],_0x3d44a9=_0x3f54a3[_0x5af53c(0x1131)][_0x5af53c(0x31e)];if(!_0x3d44a9||_0x3d44a9[_0x5af53c(0xa06)]===0x0){alert('这个角色没有可用的备选开场白。');return;}const _0x187a69=_0x3d44a9[_0x5af53c(0xa3b)]((_0x592be1,_0x46794d)=>{const _0x35e302=_0x5af53c,_0x5a6f83=_0x592be1[_0x35e302(0x459)](/<[^>]*>/g,'')[_0x35e302(0x3f1)]()[_0x35e302(0xc34)](0x0,0x14);return{'text':_0x35e302(0x592)+(_0x46794d+0x1)+':\x20'+_0x5a6f83+'...','value':_0x46794d};}),_0x295675=await _0xb8c832('选择一个开场白',_0x187a69);if(_0x295675!==null){const _0x971f41=await _0x352ae9(_0x5af53c(0x10c7),_0x5af53c(0x1171),{'confirmButtonClass':_0x5af53c(0x12bc),'confirmText':_0x5af53c(0x11e3)});if(_0x971f41){const _0x5e0250=_0x3d44a9[_0x295675],_0xdad953={'role':_0x5af53c(0x1a7),'senderName':_0x3f54a3[_0x5af53c(0x1071)],'content':_0x5e0250,'timestamp':Date[_0x5af53c(0x9b7)]()};_0x3f54a3[_0x5af53c(0x8b3)]=[_0xdad953],await _0x2c5bcf[_0x5af53c(0x547)][_0x5af53c(0xff5)](_0x3f54a3),_0x1a44b1(_0x3f54a3['id']),document[_0x5af53c(0x9c8)]('chat-settings-modal')[_0x5af53c(0x575)][_0x5af53c(0x30f)](_0x5af53c(0xc3f)),await _0x1bff53('成功','已切换到新的开场故事！');}}}function _0x14ba38(_0x23bc84={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x328051=_0x419fa8,_0x94f47e=document['createElement'](_0x328051(0x11f4));_0x94f47e[_0x328051(0x82c)]='message-editor-block';const _0x45112a=_0x23bc84[_0x328051(0x38a)]!==![]?_0x328051(0x1ec):'';return _0x94f47e[_0x328051(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20'+_0x45112a+_0x328051(0x139c)+(_0x23bc84[_0x328051(0x10de)]||'')+'\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22'+(_0x23bc84['keys']||[])[_0x328051(0x809)](',\x20')+_0x328051(0x52c)+(_0x23bc84[_0x328051(0x53b)]||'')+_0x328051(0x474),_0x94f47e[_0x328051(0x91d)](_0x328051(0x85c))[_0x328051(0xa0f)]('click',()=>{const _0x3e6e75=_0x328051;_0x94f47e[_0x3e6e75(0x30f)]();}),_0x94f47e;}async function _0x45dfb4(){const _0x2e1c22=_0x419fa8;if(!_0x9ebf46[_0x2e1c22(0x970)])return;const _0x53b24a=_0x9ebf46['activeChatId'],_0x1a6819=document[_0x2e1c22(0x9c8)](_0x2e1c22(0x1283));if(!_0x1a6819[_0x2e1c22(0x575)][_0x2e1c22(0x1038)](_0x2e1c22(0xc3f))){const _0x4bc23c=document[_0x2e1c22(0x91d)](_0x2e1c22(0xe52));_0x1a6819['style']['top']=_0x4bc23c[_0x2e1c22(0x559)]+'px',_0x1a6819['style'][_0x2e1c22(0x3c5)]=_0x2e1c22(0x3d9),(!_0x434409[_0x53b24a]||!_0x434409[_0x53b24a][_0x2e1c22(0x103f)])&&_0x8aeca4(_0x53b24a),_0x34de8e(_0x53b24a),setTimeout(async()=>{const _0x2c3a1b=_0x2e1c22;_0x1a6819[_0x2c3a1b(0x575)][_0x2c3a1b(0x68e)](_0x2c3a1b(0xc3f));const _0x39de21={'role':'system','content':_0x2c3a1b(0xf7d),'timestamp':Date[_0x2c3a1b(0x9b7)](),'isHidden':!![]};_0x9ebf46[_0x2c3a1b(0x547)][_0x53b24a]['history'][_0x2c3a1b(0x668)](_0x39de21),await _0x2c5bcf[_0x2c3a1b(0x547)][_0x2c3a1b(0xff5)](_0x9ebf46[_0x2c3a1b(0x547)][_0x53b24a]);},0xa);}else await _0x45247c();}async function _0x45247c(){const _0x14aca9=_0x419fa8;if(!_0x9ebf46[_0x14aca9(0x970)])return;const _0x5bc88c=_0x9ebf46['activeChatId'],_0x45acc7=document[_0x14aca9(0x9c8)](_0x14aca9(0x1283));_0x45acc7[_0x14aca9(0x575)][_0x14aca9(0x30f)](_0x14aca9(0xc3f)),setTimeout(()=>{const _0x287847=_0x14aca9;_0x45acc7[_0x287847(0x5e1)][_0x287847(0x3c5)]='none';},0x12c);if(_0x434409[_0x5bc88c]){_0x434409[_0x5bc88c][_0x14aca9(0x103f)]=![];const _0x153dd2={'role':_0x14aca9(0xb64),'content':_0x14aca9(0xc43),'timestamp':Date[_0x14aca9(0x9b7)](),'isHidden':!![]};_0x9ebf46[_0x14aca9(0x547)][_0x5bc88c][_0x14aca9(0x8b3)]['push'](_0x153dd2),await _0x2c5bcf[_0x14aca9(0x547)]['put'](_0x9ebf46[_0x14aca9(0x547)][_0x5bc88c]);}}function _0x8aeca4(_0x84f798){const _0x31f3d3=_0x419fa8,_0x3bcf64=document[_0x31f3d3(0x9c8)](_0x31f3d3(0x120d)),_0x1358d5=document[_0x31f3d3(0x9c8)](_0x31f3d3(0x1283)),_0xef66de=document['getElementById'](_0x31f3d3(0x11bf)),_0x44ed69=_0x1358d5['offsetWidth']-0x28,_0x42942b=_0x1358d5[_0x31f3d3(0x559)]-_0xef66de[_0x31f3d3(0x559)]-0x28,_0x1d5940=Math[_0x31f3d3(0x5fb)](Math[_0x31f3d3(0x24c)](_0x44ed69,_0x42942b)),_0x184d44=0xf,_0xe08dc4=Math['floor'](_0x1d5940/_0x184d44),_0x8d1e91=_0xe08dc4*_0x184d44;_0x3bcf64['width']=_0x8d1e91,_0x3bcf64[_0x31f3d3(0x3ff)]=_0x8d1e91,_0x434409[_0x84f798]={'isActive':!![],'board':Array(_0x184d44)[_0x31f3d3(0x1073)](0x0)['map'](()=>Array(_0x184d44)[_0x31f3d3(0x1073)](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0x184d44,'CELL_SIZE':_0xe08dc4};}function _0x34de8e(_0xb0126d){const _0x456a4f=_0x419fa8,_0x289cfe=_0x434409[_0xb0126d];if(!_0x289cfe)return;const _0x28441d=document[_0x456a4f(0x9c8)]('gomoku-board'),_0x4170cb=_0x28441d[_0x456a4f(0xaa8)]('2d'),{GRID_SIZE:_0x2573b6,CELL_SIZE:_0x4368c7}=_0x289cfe,_0x586e43=_0x4368c7/0x2;_0x4170cb[_0x456a4f(0x1376)](0x0,0x0,_0x28441d[_0x456a4f(0x125e)],_0x28441d[_0x456a4f(0x3ff)]),_0x4170cb[_0x456a4f(0x820)]='#e4b591',_0x4170cb[_0x456a4f(0x522)](0x0,0x0,_0x28441d[_0x456a4f(0x125e)],_0x28441d[_0x456a4f(0x3ff)]),_0x4170cb[_0x456a4f(0x11ae)]=_0x456a4f(0x600),_0x4170cb[_0x456a4f(0xc8b)]=0x1;for(let _0x4f9afe=0x0;_0x4f9afe<_0x2573b6;_0x4f9afe++){_0x4170cb[_0x456a4f(0x868)](),_0x4170cb[_0x456a4f(0x7ac)](_0x586e43,_0x586e43+_0x4f9afe*_0x4368c7),_0x4170cb[_0x456a4f(0xea9)](_0x28441d['width']-_0x586e43,_0x586e43+_0x4f9afe*_0x4368c7),_0x4170cb[_0x456a4f(0x112a)](),_0x4170cb[_0x456a4f(0x868)](),_0x4170cb[_0x456a4f(0x7ac)](_0x586e43+_0x4f9afe*_0x4368c7,_0x586e43),_0x4170cb[_0x456a4f(0xea9)](_0x586e43+_0x4f9afe*_0x4368c7,_0x28441d[_0x456a4f(0x3ff)]-_0x586e43),_0x4170cb[_0x456a4f(0x112a)]();}for(let _0x2f7739=0x0;_0x2f7739<_0x2573b6;_0x2f7739++){for(let _0x2fdcfd=0x0;_0x2fdcfd<_0x2573b6;_0x2fdcfd++){_0x289cfe[_0x456a4f(0xb44)][_0x2f7739][_0x2fdcfd]!==0x0&&_0x5880f6(_0x4170cb,_0x2fdcfd,_0x2f7739,_0x289cfe[_0x456a4f(0xb44)][_0x2f7739][_0x2fdcfd],_0x289cfe);}}}function _0x5880f6(_0x4e8316,_0x13a9df,_0x11c48f,_0x3efbee,_0x558e5e){const _0x3a63ca=_0x419fa8,{CELL_SIZE:_0x1d14ec}=_0x558e5e,_0x5b24ee=_0x1d14ec/0x2,_0x2673a0=_0x1d14ec/0x2-0x2;_0x4e8316['beginPath'](),_0x4e8316['arc'](_0x5b24ee+_0x13a9df*_0x1d14ec,_0x5b24ee+_0x11c48f*_0x1d14ec,_0x2673a0,0x0,0x2*Math['PI']),_0x3efbee===0x1?_0x4e8316[_0x3a63ca(0x820)]='black':_0x4e8316[_0x3a63ca(0x820)]=_0x3a63ca(0x10e3),_0x4e8316[_0x3a63ca(0x1073)]();}function _0x35b4b2(_0x2835be){const _0x56059b=_0x419fa8,_0x55b68f=_0x9ebf46['activeChatId'],_0x2edd71=_0x434409[_0x55b68f];if(!_0x2edd71||_0x2edd71['isGameOver']||_0x2edd71['currentPlayer']!==0x1)return;const _0x368b52=document[_0x56059b(0x9c8)](_0x56059b(0x120d)),_0x1c0ca7=_0x368b52[_0x56059b(0xaa8)]('2d'),_0x5b9988=_0x368b52[_0x56059b(0xe2c)](),_0x1f13c4=_0x2835be['clientX']-_0x5b9988[_0x56059b(0x12b6)],_0xe0582e=_0x2835be[_0x56059b(0x96d)]-_0x5b9988[_0x56059b(0x114a)],_0x4dd03e=Math[_0x56059b(0xe3e)]((_0x1f13c4-_0x2edd71[_0x56059b(0x110e)]/0x2)/_0x2edd71['CELL_SIZE']),_0x48683c=Math[_0x56059b(0xe3e)]((_0xe0582e-_0x2edd71[_0x56059b(0x110e)]/0x2)/_0x2edd71['CELL_SIZE']);_0x34de8e(_0x55b68f);if(_0x4dd03e>=0x0&&_0x4dd03e<_0x2edd71[_0x56059b(0x57d)]&&_0x48683c>=0x0&&_0x48683c<_0x2edd71[_0x56059b(0x57d)]&&_0x2edd71[_0x56059b(0xb44)][_0x48683c][_0x4dd03e]===0x0){const _0x4534c7=_0x2edd71[_0x56059b(0x110e)]/0x2-0x2;_0x1c0ca7['beginPath'](),_0x1c0ca7[_0x56059b(0x12bf)](_0x2edd71['CELL_SIZE']/0x2+_0x4dd03e*_0x2edd71[_0x56059b(0x110e)],_0x2edd71['CELL_SIZE']/0x2+_0x48683c*_0x2edd71[_0x56059b(0x110e)],_0x4534c7,0x0,0x2*Math['PI']),_0x1c0ca7[_0x56059b(0x820)]=_0x56059b(0x12de),_0x1c0ca7[_0x56059b(0x1073)]();}}function _0xc1143e(_0x3e7376){const _0x10983=_0x419fa8,_0x58d8f0=_0x9ebf46[_0x10983(0x970)],_0x45ea4b=_0x434409[_0x58d8f0];if(!_0x45ea4b||_0x45ea4b['isGameOver']||_0x45ea4b['currentPlayer']!==0x1)return;const _0x337261=document[_0x10983(0x9c8)]('gomoku-board'),_0x5eb2dc=_0x337261[_0x10983(0xe2c)](),_0x924d28=_0x3e7376[_0x10983(0x223)]-_0x5eb2dc[_0x10983(0x12b6)],_0x38b455=_0x3e7376[_0x10983(0x96d)]-_0x5eb2dc['top'],_0xd0e981=Math['round']((_0x924d28-_0x45ea4b[_0x10983(0x110e)]/0x2)/_0x45ea4b[_0x10983(0x110e)]),_0x2e17ac=Math[_0x10983(0xe3e)]((_0x38b455-_0x45ea4b[_0x10983(0x110e)]/0x2)/_0x45ea4b[_0x10983(0x110e)]);_0xd0e981>=0x0&&_0xd0e981<_0x45ea4b[_0x10983(0x57d)]&&_0x2e17ac>=0x0&&_0x2e17ac<_0x45ea4b[_0x10983(0x57d)]&&_0x45ea4b['board'][_0x2e17ac][_0xd0e981]===0x0&&(_0x45ea4b[_0x10983(0xb44)][_0x2e17ac][_0xd0e981]=0x1,_0x45ea4b[_0x10983(0x8b3)][_0x10983(0x668)]({'x':_0xd0e981,'y':_0x2e17ac,'player':0x1}),_0x34de8e(_0x58d8f0),_0x4e06d6(_0xd0e981,_0x2e17ac,0x1,_0x45ea4b)?(_0x45ea4b[_0x10983(0x13b5)]=!![],setTimeout(()=>alert(_0x10983(0x310)),0x64),_0x548f7e(_0x10983(0x586))):_0x45ea4b[_0x10983(0x1202)]=0x2);}function _0x3a7522(_0x23cc72,_0x2b9b8d=![]){const _0x1ebd54=_0x419fa8,_0x5f54be=_0x9ebf46['activeChatId'],_0x4c5a76=_0x434409[_0x5f54be];if(!_0x4c5a76||_0x4c5a76[_0x1ebd54(0x13b5)])return;if(!_0x2b9b8d&&_0x4c5a76[_0x1ebd54(0x1202)]!==0x2)return;const {x:_0x5a4bc9,y:_0xcb14ed}=_0x23cc72;_0x5a4bc9>=0x0&&_0x5a4bc9<_0x4c5a76[_0x1ebd54(0x57d)]&&_0xcb14ed>=0x0&&_0xcb14ed<_0x4c5a76['GRID_SIZE']&&_0x4c5a76['board'][_0xcb14ed][_0x5a4bc9]===0x0?(_0x4c5a76[_0x1ebd54(0xb44)][_0xcb14ed][_0x5a4bc9]=0x2,_0x4c5a76[_0x1ebd54(0x8b3)]['push']({'x':_0x5a4bc9,'y':_0xcb14ed,'player':0x2}),_0x34de8e(_0x5f54be),_0x4e06d6(_0x5a4bc9,_0xcb14ed,0x2,_0x4c5a76)?(_0x4c5a76[_0x1ebd54(0x13b5)]=!![],setTimeout(()=>alert(_0x1ebd54(0xf46)),0x64),_0x548f7e('ai')):_0x4c5a76[_0x1ebd54(0x1202)]=0x1):(console['warn'](_0x1ebd54(0x4c7),_0x23cc72),_0x4c5a76[_0x1ebd54(0x1202)]=0x1);}function _0x4e06d6(_0xb414f,_0x3bfa03,_0x4d6a58,_0x5965ad){const {board:_0x68e240,GRID_SIZE:_0x3ae693}=_0x5965ad,_0x390468=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x1ee78f,_0x4703c4]of _0x390468){let _0x2f1b04=0x1;for(let _0x50c583=0x1;_0x50c583<0x5;_0x50c583++){const _0x44b003=_0xb414f+_0x50c583*_0x1ee78f,_0x5c46fc=_0x3bfa03+_0x50c583*_0x4703c4;if(_0x44b003>=0x0&&_0x44b003<_0x3ae693&&_0x5c46fc>=0x0&&_0x5c46fc<_0x3ae693&&_0x68e240[_0x5c46fc][_0x44b003]===_0x4d6a58)_0x2f1b04++;else break;}for(let _0xa588be=0x1;_0xa588be<0x5;_0xa588be++){const _0x495b6f=_0xb414f-_0xa588be*_0x1ee78f,_0x413b3e=_0x3bfa03-_0xa588be*_0x4703c4;if(_0x495b6f>=0x0&&_0x495b6f<_0x3ae693&&_0x413b3e>=0x0&&_0x413b3e<_0x3ae693&&_0x68e240[_0x413b3e][_0x495b6f]===_0x4d6a58)_0x2f1b04++;else break;}if(_0x2f1b04>=0x5)return!![];}return![];}function _0x201fd8(_0x219917){const _0x4fdfff=_0x419fa8;if(!_0x219917||!_0x219917[_0x4fdfff(0x103f)])return'';let _0x436897=_0x4fdfff(0x1310);_0x436897+=_0x219917[_0x4fdfff(0xb44)][_0x4fdfff(0xa3b)](_0x5e4e59=>_0x5e4e59[_0x4fdfff(0x809)]('\x20'))[_0x4fdfff(0x809)]('\x0a');let _0x158488=_0x4fdfff(0xd02);return _0x158488+=_0x219917[_0x4fdfff(0x8b3)][_0x4fdfff(0xa3b)](_0x82cb02=>'玩家'+_0x82cb02[_0x4fdfff(0xb4b)]+_0x4fdfff(0xa9c)+_0x82cb02['x']+','+_0x82cb02['y']+')')[_0x4fdfff(0x809)]('\x20->\x20'),_0x4fdfff(0x251)+_0x436897+_0x4fdfff(0x114d)+_0x158488+_0x4fdfff(0x24f);}async function _0x548f7e(_0xc0d37f){const _0x26d2e8=_0x419fa8,_0xc086b8=_0x9ebf46['activeChatId'],_0xc8a136=_0x9ebf46[_0x26d2e8(0x547)][_0xc086b8];if(!_0xc8a136)return;const _0x33c2cf=_0xc8a136[_0x26d2e8(0x11e4)]?_0xc8a136['settings'][_0x26d2e8(0x29c)]||'我':'我',_0xd30dbb=_0xc8a136[_0x26d2e8(0x11e4)]?_0x26d2e8(0x5cc):_0xc8a136[_0x26d2e8(0x609)],_0x1ac40b=_0xc0d37f===_0x26d2e8(0x586)?_0x33c2cf:_0xd30dbb,_0x17bf40=_0xc0d37f===_0x26d2e8(0x586)?_0x26d2e8(0x1106):'你赢了',_0x44a287=_0x26d2e8(0x491)+_0x1ac40b+'\x20获胜。也就是说，'+_0x17bf40+'。]',_0x27847e={'role':_0x26d2e8(0xb64),'content':_0x44a287,'timestamp':Date['now'](),'isHidden':!![]};_0xc8a136[_0x26d2e8(0x8b3)][_0x26d2e8(0x668)](_0x27847e),await _0x2c5bcf[_0x26d2e8(0x547)][_0x26d2e8(0xff5)](_0xc8a136),console[_0x26d2e8(0x283)]('游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20'+_0xc0d37f);}let _0x4a73f0=![];async function _0x3fe79f(){const _0xbd95ca=_0x419fa8,_0x1a7770=document[_0xbd95ca(0x9c8)]('product-grid'),_0x537c93=document[_0xbd95ca(0x9c8)](_0xbd95ca(0x635)),_0x373f16=document[_0xbd95ca(0x9c8)](_0xbd95ca(0xb15));_0x1a7770['innerHTML']='',_0x537c93[_0xbd95ca(0x2f5)]='';const [_0x1ca2cc,_0x4e89f7]=await Promise[_0xbd95ca(0xd0a)]([_0x2c5bcf[_0xbd95ca(0x281)][_0xbd95ca(0x5ff)](),_0x2c5bcf[_0xbd95ca(0xfa8)]['orderBy'](_0xbd95ca(0x609))[_0xbd95ca(0x5ff)]()]);_0x373f16[_0xbd95ca(0x575)][_0xbd95ca(0x1c3)](_0xbd95ca(0x7a7),_0x4a73f0);const _0x2d0bb2=document[_0xbd95ca(0x28a)]('button');_0x2d0bb2['className']=_0xbd95ca(0x785),_0x2d0bb2[_0xbd95ca(0xe24)]='全部',_0x2d0bb2[_0xbd95ca(0xc9f)][_0xbd95ca(0x408)]='all';if(activeShoppingCategoryId===_0xbd95ca(0xd0a))_0x2d0bb2['classList'][_0xbd95ca(0x68e)](_0xbd95ca(0x113d));_0x537c93[_0xbd95ca(0x7b9)](_0x2d0bb2),_0x4e89f7[_0xbd95ca(0x591)](_0x470102=>{const _0x7a9399=_0xbd95ca,_0x5ace2a=document[_0x7a9399(0x28a)]('button');_0x5ace2a[_0x7a9399(0x82c)]=_0x7a9399(0x785),_0x5ace2a[_0x7a9399(0xe24)]=_0x470102[_0x7a9399(0x609)],_0x5ace2a[_0x7a9399(0xc9f)][_0x7a9399(0x408)]=_0x470102['id'];if(activeShoppingCategoryId===_0x470102['id'])_0x5ace2a[_0x7a9399(0x575)][_0x7a9399(0x68e)](_0x7a9399(0x113d));_0x537c93[_0x7a9399(0x7b9)](_0x5ace2a);});let _0x12c586;activeShoppingCategoryId===_0xbd95ca(0xd0a)?_0x12c586=_0x1ca2cc:_0x12c586=_0x1ca2cc[_0xbd95ca(0x401)](_0x1f2a1d=>_0x1f2a1d['categoryId']===activeShoppingCategoryId);if(_0x12c586[_0xbd95ca(0xa06)]===0x0){const _0xf41538=activeShoppingCategoryId===_0xbd95ca(0xd0a)?'商店空空如也，点击“管理”添加商品吧！':_0xbd95ca(0x10b9);_0x1a7770[_0xbd95ca(0x2f5)]='<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>'+_0xf41538+_0xbd95ca(0x78d);return;}_0x12c586[_0xbd95ca(0x591)](_0x5f4a43=>{const _0x3802e6=_0xbd95ca,_0x3c3ca7=document[_0x3802e6(0x28a)](_0x3802e6(0x11f4));_0x3c3ca7[_0x3802e6(0x82c)]='product-item',_0x3c3ca7[_0x3802e6(0xc9f)]['id']=_0x5f4a43['id'];const _0x4dd515=_0x3802e6(0x32d);_0x3c3ca7[_0x3802e6(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4dd515+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x5f4a43['imageUrl']+'\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>'+_0x5f4a43['name']+_0x3802e6(0x62b)+_0x5f4a43[_0x3802e6(0x3fa)][_0x3802e6(0x752)](0x2)+_0x3802e6(0xb26),_0x1a7770['appendChild'](_0x3c3ca7);});}function _0xbe6222(_0x428bfc){activeShoppingCategoryId=_0x428bfc,_0x3fe79f(),_0x249f8f();}function _0x249f8f(){const _0x4b8025=_0x419fa8,_0x4e35db=document[_0x4b8025(0x9c8)]('delete-current-category-btn');if(!_0x4e35db)return;const _0x5d5686=_0x4a73f0&&activeShoppingCategoryId!==_0x4b8025(0xd0a);_0x4e35db['style'][_0x4b8025(0x3c5)]=_0x5d5686?_0x4b8025(0x989):'none';}async function _0x56ce3a(){const _0x3cad98=_0x419fa8;if(activeShoppingCategoryId===_0x3cad98(0xd0a))return;const _0x18365d=activeShoppingCategoryId,_0x5bdbcd=await _0x2c5bcf['shoppingCategories'][_0x3cad98(0xdf9)](_0x18365d);if(!_0x5bdbcd){alert(_0x3cad98(0xf18));return;}const _0x8ca306=_0x3cad98(0x11b2)+_0x5bdbcd[_0x3cad98(0x609)]+_0x3cad98(0x78f),_0x4d87e8=await _0x352ae9(_0x3cad98(0x7d7),_0x8ca306,{'confirmButtonClass':_0x3cad98(0x12bc),'confirmText':'确认删除'});_0x4d87e8&&(await _0x13fd84(_0x18365d),activeShoppingCategoryId=_0x3cad98(0xd0a),await _0x3fe79f(),_0x249f8f(),await _0x1bff53('成功',_0x3cad98(0x4be)+_0x5bdbcd[_0x3cad98(0x609)]+_0x3cad98(0x339)));}async function _0xc47e0b(){const _0x57a527=_0x419fa8;activeShoppingCategoryId=_0x57a527(0xd0a),await _0x3fe79f(),_0xe5834e('shopping-screen'),_0x249f8f();}async function _0x3fe79f(){const _0x29ba34=_0x419fa8,_0x2c76b2=document[_0x29ba34(0x9c8)]('product-grid'),_0x28bafa=document[_0x29ba34(0x9c8)](_0x29ba34(0x635)),_0x103ad1=document[_0x29ba34(0x9c8)]('shopping-screen');_0x2c76b2[_0x29ba34(0x2f5)]='',_0x28bafa[_0x29ba34(0x2f5)]='';const [_0x549bd0,_0xdb69b4]=await Promise[_0x29ba34(0xd0a)]([_0x2c5bcf[_0x29ba34(0x281)][_0x29ba34(0x5ff)](),_0x2c5bcf[_0x29ba34(0xfa8)][_0x29ba34(0x8ea)](_0x29ba34(0x609))['toArray']()]);_0x103ad1[_0x29ba34(0x575)]['toggle'](_0x29ba34(0x7a7),_0x4a73f0);const _0x359a86=document['createElement'](_0x29ba34(0x82f));_0x359a86[_0x29ba34(0x82c)]='product-category-tab',_0x359a86[_0x29ba34(0xe24)]='全部',_0x359a86[_0x29ba34(0xc9f)][_0x29ba34(0x408)]=_0x29ba34(0xd0a);if(activeShoppingCategoryId===_0x29ba34(0xd0a))_0x359a86[_0x29ba34(0x575)][_0x29ba34(0x68e)]('active');_0x28bafa[_0x29ba34(0x7b9)](_0x359a86),_0xdb69b4[_0x29ba34(0x591)](_0x5e5aca=>{const _0x52ce30=_0x29ba34,_0xcec0d=document[_0x52ce30(0x28a)](_0x52ce30(0x82f));_0xcec0d[_0x52ce30(0x82c)]=_0x52ce30(0x785),_0xcec0d[_0x52ce30(0xe24)]=_0x5e5aca['name'],_0xcec0d[_0x52ce30(0xc9f)][_0x52ce30(0x408)]=_0x5e5aca['id'];if(activeShoppingCategoryId===_0x5e5aca['id'])_0xcec0d[_0x52ce30(0x575)]['add'](_0x52ce30(0x113d));_0x28bafa[_0x52ce30(0x7b9)](_0xcec0d);});let _0x2630f3;activeShoppingCategoryId==='all'?_0x2630f3=_0x549bd0:_0x2630f3=_0x549bd0[_0x29ba34(0x401)](_0x3fe59d=>_0x3fe59d[_0x29ba34(0x408)]===activeShoppingCategoryId);if(_0x2630f3[_0x29ba34(0xa06)]===0x0){const _0x4c070a=activeShoppingCategoryId==='all'?_0x29ba34(0x80a):_0x29ba34(0x10b9);_0x2c76b2[_0x29ba34(0x2f5)]=_0x29ba34(0x13b7)+_0x4c070a+'</p>';return;}_0x2630f3['forEach'](_0x259f94=>{const _0x23c630=_0x29ba34,_0x4da8cc=document[_0x23c630(0x28a)](_0x23c630(0x11f4));_0x4da8cc[_0x23c630(0x82c)]='product-item',_0x4da8cc[_0x23c630(0xc9f)]['id']=_0x259f94['id'];const _0x11dae5=_0x4a73f0?_0x23c630(0x1fc):'';_0x4da8cc[_0x23c630(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x11dae5+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x259f94[_0x23c630(0xd5e)]+_0x23c630(0x3aa)+_0x259f94['name']+_0x23c630(0xad7)+_0x259f94['price'][_0x23c630(0x752)](0x2)+_0x23c630(0x1001),_0x2c76b2[_0x23c630(0x7b9)](_0x4da8cc);});}async function _0x111b4e(_0x443674,_0x2e134e=0x1,_0x40158d=null){const _0x23d650=_0x419fa8,_0x469b3b=_0x40158d?_0x220929[_0x23d650(0xfc3)](_0x515917=>_0x515917[_0x23d650(0x637)]===_0x443674&&_0x515917[_0x23d650(0x8fa)]?.[_0x23d650(0x609)]===_0x40158d[_0x23d650(0x609)]):_0x220929['find'](_0x587588=>_0x587588['productId']===_0x443674&&!_0x587588[_0x23d650(0x8fa)]);if(_0x469b3b)_0x469b3b[_0x23d650(0xe58)]+=_0x2e134e;else{const _0x8add6f=await _0x2c5bcf[_0x23d650(0x281)][_0x23d650(0xdf9)](_0x443674);_0x8add6f&&_0x220929['push']({'productId':_0x8add6f['id'],'quantity':_0x2e134e,'variation':_0x40158d});}_0x16a3f7();}function _0x531bcf(_0x34caac,_0x504ddc){const _0x4fa816=_0x419fa8,_0x24cb04=_0x220929[_0x4fa816(0x684)](_0x4a1c63=>_0x4a1c63['productId']===_0x34caac);_0x24cb04>-0x1&&(_0x220929[_0x24cb04][_0x4fa816(0xe58)]+=_0x504ddc,_0x220929[_0x24cb04][_0x4fa816(0xe58)]<=0x0&&_0x220929[_0x4fa816(0x888)](_0x24cb04,0x1),_0x16a3f7(),_0x1576ec());}function _0x16a3f7(){const _0x5ca336=_0x419fa8,_0x1be804=_0x220929[_0x5ca336(0x12c1)]((_0x32c8c6,_0x222775)=>_0x32c8c6+_0x222775[_0x5ca336(0xe58)],0x0);document['getElementById'](_0x5ca336(0x8a1))['textContent']=_0x1be804,document[_0x5ca336(0x9c8)](_0x5ca336(0x8ad))[_0x5ca336(0xe24)]=_0x5ca336(0x1316)+_0x1be804+')',document['getElementById'](_0x5ca336(0x72d))[_0x5ca336(0xe24)]='结算('+_0x1be804+')';}function _0x1f3158(){const _0x287a47=_0x419fa8;_0x1576ec(),_0xe5834e(_0x287a47(0x10a3));}async function _0x1576ec(){const _0x4a3be9=_0x419fa8,_0x499877=document[_0x4a3be9(0x9c8)](_0x4a3be9(0x92a));_0x499877[_0x4a3be9(0x2f5)]='';let _0x69a098=0x0;if(_0x220929['length']===0x0)_0x499877['innerHTML']=_0x4a3be9(0xddd);else{const _0x28ca53=_0x220929[_0x4a3be9(0xa3b)](_0x2322be=>_0x2322be[_0x4a3be9(0x637)]),_0x231311=await _0x2c5bcf[_0x4a3be9(0x281)]['where']('id')[_0x4a3be9(0x1372)](_0x28ca53)[_0x4a3be9(0x5ff)](),_0x30e5d7=new Map(_0x231311[_0x4a3be9(0xa3b)](_0x11c7ac=>[_0x11c7ac['id'],_0x11c7ac]));_0x220929[_0x4a3be9(0x591)](_0x27e08d=>{const _0x1f625c=_0x4a3be9,_0x23d593=_0x30e5d7[_0x1f625c(0xdf9)](_0x27e08d[_0x1f625c(0x637)]);if(_0x23d593){const _0x1af856=document[_0x1f625c(0x28a)]('div');_0x1af856[_0x1f625c(0x82c)]=_0x1f625c(0xa03);const _0x5f21d4=_0x27e08d['variation']?'<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20'+_0x27e08d[_0x1f625c(0x8fa)][_0x1f625c(0x609)]+'</div>':'';_0x1af856['innerHTML']=_0x1f625c(0xa62)+_0x23d593['id']+'\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x27e08d[_0x1f625c(0x8fa)]?.[_0x1f625c(0xd5e)]||_0x23d593[_0x1f625c(0xd5e)])+_0x1f625c(0x896)+_0x23d593[_0x1f625c(0x609)]+_0x1f625c(0x1159)+_0x5f21d4+_0x1f625c(0x133b)+(_0x27e08d[_0x1f625c(0x8fa)]?.[_0x1f625c(0x3fa)]||_0x23d593[_0x1f625c(0x3fa)])[_0x1f625c(0x752)](0x2)+_0x1f625c(0xa33)+_0x23d593['id']+_0x1f625c(0x9ff)+_0x27e08d[_0x1f625c(0xe58)]+_0x1f625c(0x8e8)+_0x23d593['id']+_0x1f625c(0xe25),_0x499877[_0x1f625c(0x7b9)](_0x1af856);}});}_0x5aa993();}async function _0x5aa993(){const _0x51dd85=_0x419fa8;let _0x41fb0f=0x0;const _0x3d7796=document[_0x51dd85(0x7e4)](_0x51dd85(0xb94)),_0x1ab25e=Array['from'](_0x3d7796)[_0x51dd85(0xa3b)](_0x613249=>parseInt(_0x613249[_0x51dd85(0xc9f)]['id']));if(_0x1ab25e[_0x51dd85(0xa06)]>0x0){const _0x40c894=await _0x2c5bcf['shoppingProducts']['where']('id')[_0x51dd85(0x1372)](_0x1ab25e)['toArray'](),_0x126fc0=new Map(_0x40c894[_0x51dd85(0xa3b)](_0xf46b4c=>[_0xf46b4c['id'],_0xf46b4c]));_0x220929[_0x51dd85(0x591)](_0x1c43fe=>{const _0x55cc68=_0x51dd85;if(_0x1ab25e[_0x55cc68(0x930)](_0x1c43fe[_0x55cc68(0x637)])){const _0x28ec0c=_0x126fc0[_0x55cc68(0xdf9)](_0x1c43fe[_0x55cc68(0x637)]);if(_0x28ec0c){const _0x13011f=_0x1c43fe[_0x55cc68(0x8fa)]?_0x1c43fe[_0x55cc68(0x8fa)][_0x55cc68(0x3fa)]:_0x28ec0c[_0x55cc68(0x3fa)];_0x41fb0f+=_0x13011f*_0x1c43fe[_0x55cc68(0xe58)];}}});}document[_0x51dd85(0x9c8)](_0x51dd85(0x1055))[_0x51dd85(0xe24)]=_0x51dd85(0xbca)+_0x41fb0f[_0x51dd85(0x752)](0x2);}async function _0x3f506d(){const _0x2afd05=_0x419fa8,_0x4ecd1b=_0x9ebf46[_0x2afd05(0x547)][_0x9ebf46[_0x2afd05(0x970)]];if(!_0x4ecd1b||!_0x4ecd1b['isGroup'])return;const _0x5756f2=document[_0x2afd05(0x9c8)](_0x2afd05(0xb62)),_0x56105c=document[_0x2afd05(0x9c8)](_0x2afd05(0xe43));_0x56105c[_0x2afd05(0x2f5)]='';const _0x242112=_0x4ecd1b[_0x2afd05(0x1131)][_0x2afd05(0x29c)]||'我',_0x49090d=_0x4ecd1b[_0x2afd05(0xd3e)][_0x2afd05(0x401)](_0x15964b=>_0x15964b[_0x2afd05(0x1132)]!==_0x242112);_0x49090d[_0x2afd05(0x591)](_0x2df1de=>{const _0x3071a9=_0x2afd05,_0x22d637=document[_0x3071a9(0x28a)](_0x3071a9(0x11f4));_0x22d637[_0x3071a9(0x82c)]='contact-picker-item',_0x22d637['dataset']['recipientName']=_0x2df1de[_0x3071a9(0x1071)],_0x22d637[_0x3071a9(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x2df1de['avatar']||_0x337c8f)+_0x3071a9(0x702)+_0x2df1de[_0x3071a9(0x1132)]+_0x3071a9(0xa71),_0x56105c[_0x3071a9(0x7b9)](_0x22d637);}),document['getElementById']('select-all-recipients')[_0x2afd05(0x1ec)]=![],_0x5756f2[_0x2afd05(0x575)][_0x2afd05(0x68e)]('visible');}async function _0x5b256d(){const _0x4aee20=_0x419fa8,_0x3d9487=_0x9ebf46['chats'][_0x9ebf46[_0x4aee20(0x970)]],_0x4a4748=_0x220929[_0x4aee20(0x401)](_0x5ce315=>document['querySelector'](_0x4aee20(0xe6d)+_0x5ce315[_0x4aee20(0x637)]+_0x4aee20(0x1175)));if(_0x4a4748[_0x4aee20(0xa06)]===0x0){alert(_0x4aee20(0x746));return;}if(_0x3d9487[_0x4aee20(0x11e4)])_0x3f506d();else{const _0x492d42=await _0x352ae9(_0x4aee20(0x96b),_0x4aee20(0x50e),{'confirmText':_0x4aee20(0xcfc)});_0x492d42&&await _0x36c88e(_0x4a4748);}}async function _0x36c88e(_0x29e8a7,_0x523226=null){const _0x3fff62=_0x419fa8;if(!_0x9ebf46[_0x3fff62(0x970)])return;const _0x2897ec=_0x9ebf46[_0x3fff62(0x547)][_0x9ebf46[_0x3fff62(0x970)]],_0x192a6c=_0x29e8a7['map'](_0x3e93cd=>_0x3e93cd[_0x3fff62(0x637)]),_0x1dbd31=await _0x2c5bcf[_0x3fff62(0x281)]['where']('id')[_0x3fff62(0x1372)](_0x192a6c)['toArray'](),_0x1c69c2=new Map(_0x1dbd31[_0x3fff62(0xa3b)](_0x235ffd=>[_0x235ffd['id'],_0x235ffd])),_0x4ffc5f=_0x29e8a7[_0x3fff62(0xa3b)](_0x5b7183=>{const _0x784311=_0x3fff62,_0x41b7d5=_0x1c69c2['get'](_0x5b7183[_0x784311(0x637)]);return _0x5b7183['variation']?{'name':_0x41b7d5['name']+'\x20-\x20'+_0x5b7183['variation'][_0x784311(0x609)],'price':_0x5b7183['variation'][_0x784311(0x3fa)],'imageUrl':_0x5b7183[_0x784311(0x8fa)][_0x784311(0xd5e)]||_0x41b7d5[_0x784311(0xd5e)],'quantity':_0x5b7183['quantity']}:{'name':_0x41b7d5['name'],'price':_0x41b7d5[_0x784311(0x3fa)],'imageUrl':_0x41b7d5[_0x784311(0xd5e)],'quantity':_0x5b7183['quantity']};}),_0x53b862={'role':_0x3fff62(0x586),'type':_0x3fff62(0x96e),'timestamp':Date['now'](),'items':_0x4ffc5f,'total':_0x4ffc5f[_0x3fff62(0x12c1)]((_0x2122cd,_0x31d77a)=>_0x2122cd+_0x31d77a[_0x3fff62(0x3fa)]*_0x31d77a[_0x3fff62(0xe58)],0x0),'recipients':_0x523226};_0x2897ec['history']['push'](_0x53b862);if(_0x523226&&_0x523226[_0x3fff62(0xa06)]>0x0){const _0x336c86=_0x523226[_0x3fff62(0xa3b)](_0x57a696=>_0x227896(_0x2897ec,_0x57a696))['join']('、'),_0x2d8225={'role':'system','content':_0x3fff62(0xc77)+(_0x2897ec['settings'][_0x3fff62(0x29c)]||'我')+_0x3fff62(0x5db)+_0x336c86+_0x3fff62(0xfff),'timestamp':Date[_0x3fff62(0x9b7)]()+0x1,'isHidden':!![]};_0x2897ec[_0x3fff62(0x8b3)][_0x3fff62(0x668)](_0x2d8225);}await _0x2c5bcf[_0x3fff62(0x547)][_0x3fff62(0xff5)](_0x2897ec),_0xc4e879(_0x53b862,_0x2897ec),_0x394b2c(),_0x220929=_0x220929[_0x3fff62(0x401)](_0x17aa69=>!_0x29e8a7[_0x3fff62(0x10b2)](_0x18eea9=>_0x18eea9[_0x3fff62(0x637)]===_0x17aa69[_0x3fff62(0x637)])),_0x16a3f7(),_0xe5834e(_0x3fff62(0x504)),await _0x1bff53('成功',_0x3fff62(0x213));}function _0x52a403(_0x586d36){const _0x9593be=_0x419fa8,_0x44ef7d=_0x9ebf46[_0x9593be(0x547)][_0x9ebf46['activeChatId']],_0x482314=_0x44ef7d[_0x9593be(0x8b3)][_0x9593be(0xfc3)](_0x2503e0=>_0x2503e0[_0x9593be(0x6b5)]===_0x586d36);if(!_0x482314||_0x482314[_0x9593be(0x12d9)]!=='gift')return;const _0x3abdd1=document['getElementById'](_0x9593be(0x426));let _0x1d8a4c='';_0x482314[_0x9593be(0x62e)]['forEach'](_0x13899a=>{const _0x64f013=_0x9593be;_0x1d8a4c+='<tr><td\x20class=\x22item-name\x22>'+_0x13899a[_0x64f013(0x609)]+_0x64f013(0x642)+_0x13899a[_0x64f013(0xe58)]+'</td><td\x20class=\x22item-price\x22>¥'+_0x13899a[_0x64f013(0x3fa)][_0x64f013(0x752)](0x2)+_0x64f013(0x63e)+(_0x13899a[_0x64f013(0x3fa)]*_0x13899a[_0x64f013(0xe58)])['toFixed'](0x2)+_0x64f013(0x10a0);}),_0x3abdd1[_0x9593be(0x2f5)]=_0x9593be(0x351)+new Date(_0x482314[_0x9593be(0x6b5)])['toLocaleString']()+_0x9593be(0xedc)+_0x1d8a4c+_0x9593be(0x558)+_0x482314['total'][_0x9593be(0x752)](0x2)+_0x9593be(0xce8),document[_0x9593be(0x9c8)]('gift-receipt-modal')[_0x9593be(0x575)]['add'](_0x9593be(0xc3f));}async function _0x387b4a(_0x5081bf=null){const _0x53a4ef=_0x419fa8;_0x51315e=_0x5081bf;const _0x286b7d=document['getElementById'](_0x53a4ef(0x442)),_0x12d9df=document[_0x53a4ef(0x9c8)]('product-editor-title'),_0x24752a=document[_0x53a4ef(0x9c8)]('product-name-input'),_0x2664a8=document['getElementById'](_0x53a4ef(0x287)),_0x480a09=document[_0x53a4ef(0x9c8)](_0x53a4ef(0xb82)),_0x182d84=document[_0x53a4ef(0x9c8)](_0x53a4ef(0x830)),_0x29f5aa=document[_0x53a4ef(0x9c8)](_0x53a4ef(0x391)),_0x1bafc5=document[_0x53a4ef(0x9c8)](_0x53a4ef(0x396));_0x1bafc5[_0x53a4ef(0x2f5)]='',_0x29f5aa['innerHTML']='<option\x20value=\x22\x22>--\x20未分类\x20--</option>';const _0x49c88b=await _0x2c5bcf[_0x53a4ef(0xfa8)][_0x53a4ef(0x5ff)]();_0x49c88b[_0x53a4ef(0x591)](_0xd7395e=>{const _0x1f7df0=_0x53a4ef,_0x22c70c=document[_0x1f7df0(0x28a)](_0x1f7df0(0x12ef));_0x22c70c[_0x1f7df0(0x1155)]=_0xd7395e['id'],_0x22c70c[_0x1f7df0(0xe24)]=_0xd7395e[_0x1f7df0(0x609)],_0x29f5aa['appendChild'](_0x22c70c);});if(_0x5081bf){_0x12d9df['textContent']=_0x53a4ef(0x203);const _0x29bd99=await _0x2c5bcf[_0x53a4ef(0x281)][_0x53a4ef(0xdf9)](_0x5081bf);_0x24752a[_0x53a4ef(0x1155)]=_0x29bd99[_0x53a4ef(0x609)],_0x2664a8['value']=_0x29bd99[_0x53a4ef(0x3fa)],_0x480a09[_0x53a4ef(0x1155)]=_0x29bd99[_0x53a4ef(0x1387)]||'',_0x182d84[_0x53a4ef(0xbf4)]=_0x29bd99[_0x53a4ef(0xd5e)],_0x29f5aa[_0x53a4ef(0x1155)]=_0x29bd99[_0x53a4ef(0x408)]||'',_0x29bd99['variations']&&_0x29bd99[_0x53a4ef(0x230)]['length']>0x0&&_0x29bd99['variations'][_0x53a4ef(0x591)](_0x380639=>_0xabc5be(_0x380639));}else _0x12d9df['textContent']=_0x53a4ef(0x1117),_0x24752a[_0x53a4ef(0x1155)]='',_0x2664a8['value']='',_0x480a09['value']='',_0x182d84['src']=_0x53a4ef(0x943),_0x29f5aa['value']='';_0x286b7d[_0x53a4ef(0x575)][_0x53a4ef(0x68e)](_0x53a4ef(0xc3f));}async function _0x4f893d(){const _0xb3d29d=_0x419fa8,_0x8f1d35=document[_0xb3d29d(0x9c8)](_0xb3d29d(0xa6b))[_0xb3d29d(0x1155)]['trim'](),_0x46344b=parseFloat(document[_0xb3d29d(0x9c8)](_0xb3d29d(0x287))[_0xb3d29d(0x1155)]),_0x266f7b=document[_0xb3d29d(0x9c8)](_0xb3d29d(0xb82))[_0xb3d29d(0x1155)][_0xb3d29d(0x3f1)](),_0x5478e6=document[_0xb3d29d(0x9c8)](_0xb3d29d(0x830))[_0xb3d29d(0xbf4)],_0x172b84=parseInt(document[_0xb3d29d(0x9c8)](_0xb3d29d(0x391))[_0xb3d29d(0x1155)])||null;if(!_0x8f1d35){alert(_0xb3d29d(0xfd4));return;}if(isNaN(_0x46344b)||_0x46344b<0x0){alert(_0xb3d29d(0x894));return;}const _0xb41d89=[];document[_0xb3d29d(0x7e4)]('.variation-block')[_0xb3d29d(0x591)](_0x38e007=>{const _0x459274=_0xb3d29d,_0x18120e=_0x38e007[_0x459274(0x91d)]('.variation-name-input')[_0x459274(0x1155)][_0x459274(0x3f1)](),_0x233185=parseFloat(_0x38e007[_0x459274(0x91d)]('.variation-price-input')['value']),_0x48e9cc=_0x38e007[_0x459274(0x91d)](_0x459274(0x11a4))['src'];_0x18120e&&!isNaN(_0x233185)&&_0x233185>=0x0&&_0xb41d89[_0x459274(0x668)]({'name':_0x18120e,'price':_0x233185,'imageUrl':_0x48e9cc[_0x459274(0x930)]('placeholder.png')?null:_0x48e9cc});});const _0x206afc={'name':_0x8f1d35,'price':_0x46344b,'description':_0x266f7b,'imageUrl':_0x5478e6,'categoryId':_0x172b84,'variations':_0xb41d89};_0x51315e?await _0x2c5bcf['shoppingProducts'][_0xb3d29d(0x13a4)](_0x51315e,_0x206afc):await _0x2c5bcf[_0xb3d29d(0x281)][_0xb3d29d(0x68e)](_0x206afc),document[_0xb3d29d(0x9c8)](_0xb3d29d(0x442))[_0xb3d29d(0x575)]['remove']('visible'),await _0x3fe79f();}async function _0x56a612(){const _0x1f76b7=_0x419fa8;await _0x39309c(),_0xe5834e(_0x1f76b7(0xdb0));}async function _0x39309c(){const _0x2174d2=_0x419fa8,_0x36ef3a=document['getElementById']('rules-tabs'),_0x2c5e4d=document[_0x2174d2(0x9c8)](_0x2174d2(0xfcf));_0x36ef3a[_0x2174d2(0x2f5)]='',_0x2c5e4d[_0x2174d2(0x2f5)]='';const _0x235f0d=await _0x2c5bcf['renderingRules']['toArray']();if(_0x235f0d[_0x2174d2(0xa06)]===0x0){_0x2c5e4d[_0x2174d2(0x2f5)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>';return;}const _0x5a1bc4=document[_0x2174d2(0x28a)](_0x2174d2(0x82f));_0x5a1bc4[_0x2174d2(0x82c)]='rules-tab\x20active',_0x5a1bc4['textContent']=_0x2174d2(0xdd2),_0x5a1bc4[_0x2174d2(0xc9f)][_0x2174d2(0x408)]=_0x2174d2(0x1024),_0x36ef3a[_0x2174d2(0x7b9)](_0x5a1bc4);const _0x32b6e0=document['createElement'](_0x2174d2(0x11f4));_0x32b6e0[_0x2174d2(0x82c)]=_0x2174d2(0x10f9),_0x32b6e0[_0x2174d2(0xc9f)][_0x2174d2(0x408)]='global',_0x2c5e4d[_0x2174d2(0x7b9)](_0x32b6e0);const _0x549028=Object[_0x2174d2(0xeb2)](_0x9ebf46[_0x2174d2(0x547)])[_0x2174d2(0x401)](_0xe2c067=>!_0xe2c067['isGroup']&&_0x235f0d[_0x2174d2(0x10b2)](_0x42624c=>_0x42624c[_0x2174d2(0x54d)]===_0xe2c067['id']));_0x549028[_0x2174d2(0x591)](_0x2f629c=>{const _0x30c18e=_0x2174d2,_0x231676=document['createElement'](_0x30c18e(0x82f));_0x231676[_0x30c18e(0x82c)]='rules-tab',_0x231676[_0x30c18e(0xe24)]=_0x2f629c[_0x30c18e(0x609)],_0x231676[_0x30c18e(0xc9f)]['categoryId']=_0x2f629c['id'],_0x36ef3a['appendChild'](_0x231676);const _0x4a908f=document[_0x30c18e(0x28a)](_0x30c18e(0x11f4));_0x4a908f[_0x30c18e(0x82c)]='rules-category-pane',_0x4a908f['dataset'][_0x30c18e(0x408)]=_0x2f629c['id'],_0x2c5e4d[_0x30c18e(0x7b9)](_0x4a908f);}),_0x235f0d[_0x2174d2(0x591)](_0x1df596=>{const _0x586feb=_0x2174d2,_0x34b8ba=_0x4a30a3(_0x1df596),_0x5f0216=_0x2c5e4d[_0x586feb(0x91d)](_0x586feb(0x7a0)+_0x1df596['chatId']+'\x22]');_0x5f0216&&_0x5f0216[_0x586feb(0x7b9)](_0x34b8ba);}),document['querySelectorAll'](_0x2174d2(0x182))[_0x2174d2(0x591)](_0x2fd148=>{const _0x5db944=_0x2174d2;_0x2fd148['addEventListener']('click',()=>_0x3d9f29(_0x2fd148[_0x5db944(0xc9f)]['categoryId']));});}function _0x4a30a3(_0x105faa){const _0x1c47f8=_0x419fa8,_0xce0da9=document[_0x1c47f8(0x28a)](_0x1c47f8(0x11f4));return _0xce0da9[_0x1c47f8(0x82c)]=_0x1c47f8(0x1370)+(_0x105faa[_0x1c47f8(0x5eb)]?'enabled':''),_0xce0da9['dataset'][_0x1c47f8(0xa59)]=_0x105faa['id'],_0xce0da9['innerHTML']=_0x1c47f8(0xe0f)+_0x105faa[_0x1c47f8(0x609)]+_0x1c47f8(0x1ef)+_0x105faa[_0x1c47f8(0x12a0)]+_0x1c47f8(0xb72),_0xce0da9[_0x1c47f8(0xa0f)](_0x1c47f8(0xf5c),()=>_0x398c43(_0x105faa['id'])),_0x43a60a(_0xce0da9,()=>_0x2223c2(_0x105faa['id'])),_0xce0da9;}async function _0x398c43(_0x3cbc7e=null){const _0x2a39cf=_0x419fa8;_0x541f35=_0x3cbc7e;const _0x264eae=document[_0x2a39cf(0x9c8)]('rule-editor-modal'),_0x3f7b45=document[_0x2a39cf(0x9c8)](_0x2a39cf(0xb9f)),_0x539f32=document[_0x2a39cf(0x9c8)](_0x2a39cf(0xa17)),_0x3afe2f=document[_0x2a39cf(0x9c8)](_0x2a39cf(0x819)),_0x33022c=document[_0x2a39cf(0x9c8)](_0x2a39cf(0x210)),_0x40670a=document[_0x2a39cf(0x9c8)](_0x2a39cf(0x2d8)),_0x4515c6=document['getElementById'](_0x2a39cf(0xaf9));_0x3afe2f[_0x2a39cf(0x2f5)]='<option\x20value=\x22global\x22>公用\x20(所有角色)</option>',Object[_0x2a39cf(0xeb2)](_0x9ebf46['chats'])[_0x2a39cf(0x401)](_0x23295b=>!_0x23295b[_0x2a39cf(0x11e4)])[_0x2a39cf(0x591)](_0xa4a10d=>{const _0x19d71f=_0x2a39cf;_0x3afe2f[_0x19d71f(0x2f5)]+=_0x19d71f(0x3b6)+_0xa4a10d['id']+'\x22>'+_0xa4a10d[_0x19d71f(0x609)]+'</option>';});if(_0x3cbc7e){_0x3f7b45['textContent']=_0x2a39cf(0x100b);const _0x5c3333=await _0x2c5bcf['renderingRules'][_0x2a39cf(0xdf9)](_0x3cbc7e);_0x539f32[_0x2a39cf(0x1155)]=_0x5c3333[_0x2a39cf(0x609)],_0x3afe2f['value']=_0x5c3333[_0x2a39cf(0x54d)],_0x33022c['value']=_0x5c3333['regex'],_0x40670a[_0x2a39cf(0x1155)]=_0x5c3333[_0x2a39cf(0x9bc)],_0x4515c6['checked']=_0x5c3333[_0x2a39cf(0x5eb)];}else _0x3f7b45[_0x2a39cf(0xe24)]=_0x2a39cf(0xcaf),_0x539f32[_0x2a39cf(0x1155)]='',_0x3afe2f['value']=_0x2a39cf(0x1024),_0x33022c[_0x2a39cf(0x1155)]='',_0x40670a[_0x2a39cf(0x1155)]='',_0x4515c6[_0x2a39cf(0x1ec)]=!![];_0x264eae[_0x2a39cf(0x575)]['add'](_0x2a39cf(0xc3f));}async function _0x32dcca(){const _0x1bacea=_0x419fa8,_0x196a86=document[_0x1bacea(0x9c8)]('rule-name-input')[_0x1bacea(0x1155)][_0x1bacea(0x3f1)](),_0x5c2847=document[_0x1bacea(0x9c8)]('rule-regex-input')[_0x1bacea(0x1155)][_0x1bacea(0x3f1)]();if(!_0x196a86||!_0x5c2847){alert(_0x1bacea(0x462));return;}try{new RegExp(_0x5c2847);}catch(_0x11acb8){alert(_0x1bacea(0x362)+_0x11acb8[_0x1bacea(0x86e)]);return;}const _0x5a6b5c={'name':_0x196a86,'chatId':document[_0x1bacea(0x9c8)](_0x1bacea(0x819))[_0x1bacea(0x1155)],'regex':_0x5c2847,'template':document[_0x1bacea(0x9c8)](_0x1bacea(0x2d8))[_0x1bacea(0x1155)],'isEnabled':document['getElementById']('rule-enabled-switch')['checked']};_0x541f35?await _0x2c5bcf[_0x1bacea(0x1349)]['update'](_0x541f35,_0x5a6b5c):await _0x2c5bcf[_0x1bacea(0x1349)][_0x1bacea(0x68e)](_0x5a6b5c),document[_0x1bacea(0x9c8)](_0x1bacea(0x1082))[_0x1bacea(0x575)]['remove'](_0x1bacea(0xc3f)),await _0x39309c();}async function _0x2223c2(_0xee13aa){const _0x24c1f4=_0x419fa8,_0x4e4803=await _0x352ae9('删除规则','确定要删除这条渲染规则吗？',{'confirmButtonClass':_0x24c1f4(0x12bc)});_0x4e4803&&(await _0x2c5bcf['renderingRules'][_0x24c1f4(0x6d2)](_0xee13aa),await _0x39309c());}async function _0x457ef2(_0x32e763,_0x208486){const _0x59c580=_0x419fa8;if(_0x32e763[_0x59c580(0x3f1)]()[_0x59c580(0xc8d)]('<')||!_0x32e763[_0x59c580(0x930)]('[')&&!_0x32e763[_0x59c580(0x930)]('{'))return _0x32e763;const _0x5c221e=await _0x2c5bcf[_0x59c580(0x1349)]['where'](_0x59c580(0x54d))['equals'](_0x59c580(0x1024))['or'](_0x59c580(0x54d))[_0x59c580(0xda9)](_0x208486)['toArray']();let _0x30762a=_0x32e763;for(const _0xcb128d of _0x5c221e[_0x59c580(0x401)](_0x29d183=>_0x29d183[_0x59c580(0x5eb)])){try{const _0x3a78bc=new RegExp(_0xcb128d['regex'],'g');_0x3a78bc[_0x59c580(0x4e8)](_0x30762a)&&(_0x30762a=_0x30762a[_0x59c580(0x459)](_0x3a78bc,_0xcb128d[_0x59c580(0x9bc)]));}catch(_0x17809b){console[_0x59c580(0x1221)](_0x59c580(0xfa3)+_0xcb128d['name']+_0x59c580(0x60b),_0x17809b);}}return _0x30762a;}async function _0x56a612(){await _0x39309c(),_0xe5834e('rendering-rules-screen');}async function _0x39309c(){const _0x286363=_0x419fa8,_0x5c5b04=document[_0x286363(0x9c8)](_0x286363(0x1146)),_0x57865f=document[_0x286363(0x9c8)](_0x286363(0xfcf));_0x5c5b04['innerHTML']='',_0x57865f[_0x286363(0x2f5)]='';const _0x3656f0=await _0x2c5bcf[_0x286363(0x1349)][_0x286363(0x5ff)]();if(_0x3656f0[_0x286363(0xa06)]===0x0){_0x57865f[_0x286363(0x2f5)]=_0x286363(0x110c);return;}const _0x596e68=document[_0x286363(0x28a)](_0x286363(0x82f));_0x596e68['className']=_0x286363(0xb02),_0x596e68[_0x286363(0xe24)]=_0x286363(0xdd2),_0x596e68['dataset']['categoryId']=_0x286363(0x1024),_0x5c5b04[_0x286363(0x7b9)](_0x596e68);const _0x1c477f=document[_0x286363(0x28a)]('div');_0x1c477f[_0x286363(0x82c)]=_0x286363(0x10f9),_0x1c477f[_0x286363(0xc9f)][_0x286363(0x408)]=_0x286363(0x1024),_0x57865f[_0x286363(0x7b9)](_0x1c477f);const _0x1b2026=Object[_0x286363(0xeb2)](_0x9ebf46[_0x286363(0x547)])[_0x286363(0x401)](_0x1cd4cd=>!_0x1cd4cd[_0x286363(0x11e4)]&&_0x3656f0[_0x286363(0x10b2)](_0x270e4a=>_0x270e4a[_0x286363(0x54d)]===_0x1cd4cd['id']));_0x1b2026[_0x286363(0x591)](_0x1c4573=>{const _0x175fd6=_0x286363,_0x45d305=document[_0x175fd6(0x28a)]('button');_0x45d305[_0x175fd6(0x82c)]='rules-tab',_0x45d305[_0x175fd6(0xe24)]=_0x1c4573[_0x175fd6(0x609)],_0x45d305[_0x175fd6(0xc9f)][_0x175fd6(0x408)]=_0x1c4573['id'],_0x5c5b04[_0x175fd6(0x7b9)](_0x45d305);const _0x531740=document['createElement'](_0x175fd6(0x11f4));_0x531740[_0x175fd6(0x82c)]='rules-category-pane',_0x531740[_0x175fd6(0xc9f)][_0x175fd6(0x408)]=_0x1c4573['id'],_0x57865f['appendChild'](_0x531740);}),_0x3656f0[_0x286363(0x591)](_0xdb58ef=>{const _0x456572=_0x286363,_0x50baaf=_0x4a30a3(_0xdb58ef),_0x33eab5=_0x57865f[_0x456572(0x91d)](_0x456572(0x7a0)+_0xdb58ef['chatId']+'\x22]');_0x33eab5&&_0x33eab5[_0x456572(0x7b9)](_0x50baaf);}),document[_0x286363(0x7e4)](_0x286363(0x182))[_0x286363(0x591)](_0xb55384=>{const _0x3f0bb6=_0x286363;_0xb55384[_0x3f0bb6(0xa0f)](_0x3f0bb6(0xf5c),()=>_0x3d9f29(_0xb55384[_0x3f0bb6(0xc9f)]['categoryId']));});}function _0x4a30a3(_0x59119b){const _0x204930=_0x419fa8,_0x5ba07d=document[_0x204930(0x28a)](_0x204930(0x11f4));return _0x5ba07d[_0x204930(0x82c)]=_0x204930(0x1370)+(_0x59119b[_0x204930(0x5eb)]?'enabled':''),_0x5ba07d[_0x204930(0xc9f)][_0x204930(0xa59)]=_0x59119b['id'],_0x5ba07d[_0x204930(0x2f5)]=_0x204930(0xe0f)+_0x59119b[_0x204930(0x609)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0x59119b['regex']+_0x204930(0xb72),_0x5ba07d[_0x204930(0xa0f)]('click',()=>_0x398c43(_0x59119b['id'])),_0x43a60a(_0x5ba07d,()=>_0x2223c2(_0x59119b['id'])),_0x5ba07d;}async function _0x398c43(_0x4a35b9=null){const _0x53b1ec=_0x419fa8;_0x541f35=_0x4a35b9;const _0x3fc60f=document[_0x53b1ec(0x9c8)](_0x53b1ec(0x1082)),_0x79c4dd=document['getElementById'](_0x53b1ec(0xb9f)),_0x5010b2=document[_0x53b1ec(0x9c8)](_0x53b1ec(0xa17)),_0x1f4298=document['getElementById'](_0x53b1ec(0x819)),_0x37c73c=document['getElementById'](_0x53b1ec(0x210)),_0x4b119e=document[_0x53b1ec(0x9c8)](_0x53b1ec(0x2d8)),_0x5a1b55=document[_0x53b1ec(0x9c8)](_0x53b1ec(0xaf9));_0x1f4298[_0x53b1ec(0x2f5)]=_0x53b1ec(0x714),Object[_0x53b1ec(0xeb2)](_0x9ebf46['chats'])[_0x53b1ec(0x401)](_0xa7a4cb=>!_0xa7a4cb[_0x53b1ec(0x11e4)])[_0x53b1ec(0x591)](_0x4fd73a=>{const _0x594672=_0x53b1ec;_0x1f4298[_0x594672(0x2f5)]+=_0x594672(0x3b6)+_0x4fd73a['id']+'\x22>'+_0x4fd73a[_0x594672(0x609)]+_0x594672(0x811);});if(_0x4a35b9){_0x79c4dd[_0x53b1ec(0xe24)]=_0x53b1ec(0x100b);const _0x4b499b=await _0x2c5bcf[_0x53b1ec(0x1349)]['get'](_0x4a35b9);_0x5010b2[_0x53b1ec(0x1155)]=_0x4b499b['name'],_0x1f4298['value']=_0x4b499b['chatId'],_0x37c73c[_0x53b1ec(0x1155)]=_0x4b499b[_0x53b1ec(0x12a0)],_0x4b119e['value']=_0x4b499b[_0x53b1ec(0x9bc)],_0x5a1b55[_0x53b1ec(0x1ec)]=_0x4b499b[_0x53b1ec(0x5eb)];}else _0x79c4dd[_0x53b1ec(0xe24)]=_0x53b1ec(0xcaf),_0x5010b2[_0x53b1ec(0x1155)]='',_0x1f4298['value']=_0x53b1ec(0x1024),_0x37c73c['value']='',_0x4b119e[_0x53b1ec(0x1155)]='',_0x5a1b55[_0x53b1ec(0x1ec)]=!![];_0x3fc60f[_0x53b1ec(0x575)]['add'](_0x53b1ec(0xc3f));}async function _0x32dcca(){const _0x95db9e=_0x419fa8,_0x580457=document['getElementById']('rule-name-input')[_0x95db9e(0x1155)][_0x95db9e(0x3f1)](),_0x557e1a=document[_0x95db9e(0x9c8)](_0x95db9e(0x210))['value'][_0x95db9e(0x3f1)]();if(!_0x580457||!_0x557e1a){alert('规则名称和正则表达式不能为空！');return;}try{new RegExp(_0x557e1a);}catch(_0x48f005){alert(_0x95db9e(0x362)+_0x48f005[_0x95db9e(0x86e)]);return;}const _0x1ad60e={'name':_0x580457,'chatId':document[_0x95db9e(0x9c8)](_0x95db9e(0x819))['value'],'regex':_0x557e1a,'template':document['getElementById'](_0x95db9e(0x2d8))[_0x95db9e(0x1155)],'isEnabled':document[_0x95db9e(0x9c8)](_0x95db9e(0xaf9))[_0x95db9e(0x1ec)]};_0x541f35?await _0x2c5bcf[_0x95db9e(0x1349)][_0x95db9e(0x13a4)](_0x541f35,_0x1ad60e):await _0x2c5bcf[_0x95db9e(0x1349)]['add'](_0x1ad60e),document[_0x95db9e(0x9c8)](_0x95db9e(0x1082))['classList'][_0x95db9e(0x30f)](_0x95db9e(0xc3f)),await _0x39309c();}async function _0x2223c2(_0x234eca){const _0x25fb1c=_0x419fa8,_0xf875aa=await _0x352ae9('删除规则',_0x25fb1c(0x7bc),{'confirmButtonClass':'btn-danger'});_0xf875aa&&(await _0x2c5bcf['renderingRules'][_0x25fb1c(0x6d2)](_0x234eca),await _0x39309c());}async function _0x457ef2(_0x541a12,_0x4c0eed){const _0x344d80=_0x419fa8;if(_0x541a12[_0x344d80(0x3f1)]()[_0x344d80(0xc8d)]('<')||!_0x541a12[_0x344d80(0x930)]('[')&&!_0x541a12[_0x344d80(0x930)]('{'))return _0x541a12;if(!_0x45cf77[_0x4c0eed]){console['log'](_0x344d80(0xe75)+_0x4c0eed);const _0x497f65=await _0x2c5bcf[_0x344d80(0x1349)][_0x344d80(0xe78)]('chatId')[_0x344d80(0xda9)](_0x344d80(0x1024))['or'](_0x344d80(0x54d))[_0x344d80(0xda9)](_0x4c0eed)[_0x344d80(0x5ff)]();_0x45cf77[_0x4c0eed]=_0x497f65[_0x344d80(0x401)](_0x121897=>_0x121897[_0x344d80(0x5eb)]);}const _0x571898=_0x45cf77[_0x4c0eed];let _0xfe0bb7=_0x541a12;for(const _0x473c86 of _0x571898){try{const _0x23154c=new RegExp(_0x473c86['regex'],'g');let _0xb41846=_0xfe0bb7;_0x23154c[_0x344d80(0x4e8)](_0xb41846)&&(_0xfe0bb7=_0xfe0bb7[_0x344d80(0x459)](_0x23154c,_0x473c86['template']));}catch(_0x3ac23f){console['error'](_0x344d80(0xfa3)+_0x473c86[_0x344d80(0x609)]+_0x344d80(0x60b),_0x3ac23f);}}return _0xfe0bb7;}function _0x33831a(_0x4e99dd){const _0xd97c5f=_0x419fa8;if(!_0x4e99dd)return'';const _0xd5f79a=new Date(),_0xf025c6=new Date(_0x4e99dd),_0x5e9ed5=String(_0xf025c6[_0xd97c5f(0x7a2)]())[_0xd97c5f(0x3e8)](0x2,'0'),_0x4c2a44=String(_0xf025c6[_0xd97c5f(0x3a6)]())['padStart'](0x2,'0'),_0x460e75=_0x5e9ed5+':'+_0x4c2a44;if(_0xd5f79a[_0xd97c5f(0x3c2)]()===_0xf025c6[_0xd97c5f(0x3c2)]())return _0x460e75;const _0x35dedb=new Date();_0x35dedb[_0xd97c5f(0xe66)](_0xd5f79a[_0xd97c5f(0xa13)]()-0x1);if(_0x35dedb[_0xd97c5f(0x3c2)]()===_0xf025c6['toDateString']())return _0xd97c5f(0xfe0)+_0x460e75;const _0x54c602=_0xf025c6[_0xd97c5f(0x10cd)](),_0x4c25e0=String(_0xf025c6[_0xd97c5f(0x260)]()+0x1)[_0xd97c5f(0x3e8)](0x2,'0'),_0x54156e=String(_0xf025c6['getDate']())[_0xd97c5f(0x3e8)](0x2,'0');return _0xd5f79a[_0xd97c5f(0x10cd)]()===_0x54c602?_0x4c25e0+'月'+_0x54156e+'日\x20'+_0x460e75:_0x54c602+'年'+_0x4c25e0+'月'+_0x54156e+'日\x20'+_0x460e75;}function _0x4b8eaa(_0xdbe9cc){const _0x2b46e2=_0x419fa8,_0x56de56=document['createElement']('div');_0x56de56['className']=_0x2b46e2(0xf85);const _0x448940=document[_0x2b46e2(0x28a)](_0x2b46e2(0x11f4));return _0x448940[_0x2b46e2(0x82c)]=_0x2b46e2(0x1395),_0x448940['textContent']=_0x33831a(_0xdbe9cc),_0x56de56['appendChild'](_0x448940),_0x56de56;}async function _0x4d088b(){const _0x5c3ffd=_0x419fa8,_0x11bc68=_0x9ebf46[_0x5c3ffd(0x547)][_0x9ebf46[_0x5c3ffd(0x970)]];if(!_0x11bc68||!lastResponseTimestamps||lastResponseTimestamps[_0x5c3ffd(0xa06)]===0x0){alert('没有可供重新生成的AI响应。');return;}_0x11bc68[_0x5c3ffd(0x8b3)]=_0x11bc68[_0x5c3ffd(0x8b3)]['filter'](_0x400503=>!lastResponseTimestamps[_0x5c3ffd(0x930)](_0x400503[_0x5c3ffd(0x6b5)])),await _0x2c5bcf[_0x5c3ffd(0x547)][_0x5c3ffd(0xff5)](_0x11bc68),await _0x1a44b1(_0x9ebf46[_0x5c3ffd(0x970)]),_0x13a3b1();}async function _0x213baf(){const _0x298115=_0x419fa8,_0x174fb0=_0x9ebf46[_0x298115(0x547)][_0x9ebf46[_0x298115(0x970)]];if(!_0x174fb0)return;const _0x2fd694=_0x174fb0[_0x298115(0x8b3)]['findLastIndex'](_0x1c45f7=>_0x1c45f7[_0x298115(0x7fd)]===_0x298115(0x586)&&!_0x1c45f7['isHidden']);if(_0x2fd694===-0x1){alert(_0x298115(0x64d));return;}const _0x4ec5e2=_0x174fb0[_0x298115(0x8b3)][_0x298115(0x318)](_0x58e080=>_0x58e080['role']==='assistant');if(_0x4ec5e2<_0x2fd694){alert('AI\x20尚未对您的最后一条消息做出回应，无法重新生成。');return;}_0x174fb0[_0x298115(0x8b3)]['splice'](_0x2fd694+0x1),await _0x2c5bcf[_0x298115(0x547)]['put'](_0x174fb0),await _0x1a44b1(_0x9ebf46[_0x298115(0x970)]),await _0x4128b4();}async function _0x2f2965(){const _0x4968bf=_0x419fa8;if(!_0x3085d5[_0x4968bf(0x103f)])return;const _0x338a22=_0x3085d5[_0x4968bf(0xe55)][_0x4968bf(0x318)](_0x425a0f=>_0x425a0f[_0x4968bf(0x7fd)]===_0x4968bf(0x586));if(_0x338a22===-0x1){alert(_0x4968bf(0xac5));return;}_0x3085d5[_0x4968bf(0xe55)]['splice'](_0x338a22+0x1);const _0x199fd7=document[_0x4968bf(0x9c8)]('video-call-main');_0x199fd7[_0x4968bf(0x2f5)]='',_0x3085d5[_0x4968bf(0xe55)][_0x4968bf(0x591)](_0x29bb09=>{const _0x4eb79e=_0x4968bf,_0x3b977c=document[_0x4eb79e(0x28a)]('div');_0x3b977c[_0x4eb79e(0x82c)]=_0x4eb79e(0x953)+_0x29bb09[_0x4eb79e(0x7fd)]+'-speech',_0x3b977c[_0x4eb79e(0xc9f)][_0x4eb79e(0x6b5)]=_0x29bb09[_0x4eb79e(0x6b5)],_0x29bb09[_0x4eb79e(0x7fd)]==='user'?_0x3b977c[_0x4eb79e(0xe24)]=_0x29bb09[_0x4eb79e(0x53b)]:_0x3b977c[_0x4eb79e(0x2f5)]=_0x29bb09[_0x4eb79e(0x53b)],_0x43a60a(_0x3b977c,()=>_0x19a70e(_0x29bb09[_0x4eb79e(0x6b5)])),_0x199fd7[_0x4eb79e(0x7b9)](_0x3b977c);}),_0x199fd7[_0x4968bf(0x783)]=_0x199fd7[_0x4968bf(0x1e4)],_0x14270d(null);}async function _0x40a360(){const _0x363e5b=_0x419fa8,_0x62eba1=_0x9ebf46['chats'][_0x9ebf46['activeChatId']];if(!_0x62eba1)return;_0x39290a(_0x62eba1['id'],!![]);const _0x585817=document[_0x363e5b(0x9c8)](_0x363e5b(0x117c));!_0x62eba1[_0x363e5b(0x11e4)]&&(_0x585817[_0x363e5b(0x5e1)][_0x363e5b(0xb17)]=0x0,setTimeout(()=>{const _0xa65907=_0x363e5b;_0x585817[_0xa65907(0xe24)]=_0xa65907(0x566),_0x585817['classList']['add'](_0xa65907(0x100e)),_0x585817['style'][_0xa65907(0xb17)]=0x1;},0xc8));try{const {proxyUrl:_0x2bfb1c,apiKey:_0x28866e,model:_0x65a9f2}=_0x9ebf46[_0x363e5b(0x4de)];if(!_0x2bfb1c||!_0x28866e||!_0x65a9f2)throw new Error(_0x363e5b(0x466));const _0x2ef442=parseInt(_0x62eba1[_0x363e5b(0x1131)]['maxMemory'])||0xa,_0x107c1d=_0x62eba1[_0x363e5b(0x8b3)]['slice'](-_0x2ef442),_0x59fe53=new Date(),_0x4bf87f=new Date(_0x59fe53['getTime']()+_0x59fe53[_0x363e5b(0xa52)]()*0xea60+0x36ee80*0x8),_0x2449ed=_0x4bf87f[_0x363e5b(0x135b)](_0x363e5b(0x101b),{'timeZone':_0x363e5b(0xdfb),'dateStyle':_0x363e5b(0x1088),'timeStyle':_0x363e5b(0x4ea)}),_0x32768b=_0x526327(_0x4bf87f),_0x668013=_0x62eba1[_0x363e5b(0x1131)]['myNickname']||'我';let _0x273197='';if(_0x62eba1[_0x363e5b(0x1131)]['linkedWorldBookIds']&&_0x62eba1[_0x363e5b(0x1131)][_0x363e5b(0x41a)][_0x363e5b(0xa06)]>0x0){const _0x1af17b=_0x62eba1[_0x363e5b(0x1131)][_0x363e5b(0x41a)]['map'](_0x13f46f=>{const _0x4b7aa6=_0x363e5b,_0x39548a=_0x9ebf46['worldBooks'][_0x4b7aa6(0xfc3)](_0x416dcc=>_0x416dcc['id']===_0x13f46f);if(!_0x39548a||!Array[_0x4b7aa6(0xb27)](_0x39548a[_0x4b7aa6(0x53b)]))return'';const _0x4b5d54=_0x39548a['content']['filter'](_0x1c0ada=>_0x1c0ada[_0x4b7aa6(0x38a)]!==![])[_0x4b7aa6(0xa3b)](_0x28a6c2=>{const _0x2d116c=_0x4b7aa6;let _0x3615bd=_0x2d116c(0x1085)+(_0x28a6c2['comment']||_0x2d116c(0xf27))+'\x0a';if(_0x28a6c2[_0x2d116c(0x2bd)][_0x2d116c(0xa06)]>0x0)_0x3615bd+='**关键词:**\x20'+_0x28a6c2[_0x2d116c(0x2bd)]['join'](',\x20')+'\x0a';return _0x3615bd+='**内容:**\x0a'+_0x28a6c2['content'],_0x3615bd;})[_0x4b7aa6(0x809)]('');return _0x4b5d54?_0x4b7aa6(0xbac)+_0x39548a[_0x4b7aa6(0x609)]+'\x0a'+_0x4b5d54:'';})[_0x363e5b(0x401)](Boolean)[_0x363e5b(0x809)]('');_0x1af17b&&(_0x273197='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x1af17b+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x42daf7='';if(_0x5062a9[_0x363e5b(0x103f)]&&_0x5062a9[_0x363e5b(0x970)]===_0x62eba1['id']){const _0x2dd4b1=_0x5062a9['currentIndex']>-0x1?_0x5062a9[_0x363e5b(0x8e6)][_0x5062a9['currentIndex']]:null;_0x42daf7=_0x363e5b(0x79d);}const _0x55b0bb=_0x201fd8(_0x434409[_0x62eba1['id']]);let _0x522e3c='';_0x62eba1[_0x363e5b(0xd4f)]&&_0x62eba1[_0x363e5b(0xd4f)][_0x363e5b(0xa06)]>0x0&&(_0x522e3c=_0x363e5b(0xfad)+_0x62eba1['nameHistory'][_0x363e5b(0x809)](',\x20')+']。当在对话历史中看到这些名字时，它们都指的是【你】自己。');let _0x3ed219='';const _0xe62f8a=_0x9ebf46[_0x363e5b(0x32c)][_0x363e5b(0x5b7)]||'用户';_0x3ed219+=_0x363e5b(0xd20)+_0xe62f8a+_0x363e5b(0x623);const _0xea3f46=Object[_0x363e5b(0xeb2)](_0x9ebf46[_0x363e5b(0x547)])[_0x363e5b(0x401)](_0x165a9c=>_0x165a9c[_0x363e5b(0x11e4)]&&_0x165a9c[_0x363e5b(0xd3e)][_0x363e5b(0x10b2)](_0x1d6ffc=>_0x1d6ffc['id']===_0x62eba1['id']));_0xea3f46[_0x363e5b(0xa06)]>0x0&&(_0x3ed219+=_0x363e5b(0xc88),_0xea3f46['forEach'](_0x2435f7=>{const _0xe76f73=_0x363e5b,_0x3509c3=_0x2435f7[_0xe76f73(0x1131)][_0xe76f73(0x29c)]||_0xe62f8a;_0x3ed219+=_0xe76f73(0x2a5)+_0x2435f7[_0xe76f73(0x609)]+_0xe76f73(0x332)+_0x3509c3+_0xe76f73(0x971);}));_0x3ed219+='当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。';const _0x322fa7=_0x389fa5(_0x62eba1),_0xc2f575=_0x363e5b(0x817)+_0x62eba1[_0x363e5b(0x1071)]+'”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20'+_0x2449ed+'\x20('+_0x32768b+_0x363e5b(0xac1)+(_0x42daf7?'你们正在一起听歌，'+_0x42daf7:'你们没有在听歌。')+_0x363e5b(0x13ae)+(_0x62eba1['longTermMemory']&&_0x62eba1[_0x363e5b(0x323)][_0x363e5b(0xa06)]>0x0?_0x62eba1[_0x363e5b(0x323)][_0x363e5b(0xa3b)](_0x328cef=>'-\x20'+_0x328cef[_0x363e5b(0x53b)])['join']('\x0a'):_0x363e5b(0x1264))+_0x363e5b(0x128f)+_0x62eba1[_0x363e5b(0x1131)]['aiPersona']+_0x363e5b(0x293)+_0x62eba1[_0x363e5b(0x1071)]+_0x363e5b(0x6e6)+_0x62eba1[_0x363e5b(0x609)]+_0x363e5b(0xb39)+_0x668013+_0x363e5b(0xeec)+_0x3ed219+'\x0a\x20\x20\x20\x20'+_0x522e3c+_0x363e5b(0xffd)+_0x273197+_0x363e5b(0x2c0)+_0x322fa7+_0x363e5b(0x133e)+(_0x62eba1[_0x363e5b(0x1131)]['aiAvatarLibrary']&&_0x62eba1[_0x363e5b(0x1131)][_0x363e5b(0x295)][_0x363e5b(0xa06)]>0x0?_0x62eba1[_0x363e5b(0x1131)]['aiAvatarLibrary'][_0x363e5b(0xa3b)](_0x1f21db=>'-\x20'+_0x1f21db['name'])[_0x363e5b(0x809)]('\x0a'):_0x363e5b(0xb88))+_0x363e5b(0x1157)+(_0x62eba1[_0x363e5b(0x1131)][_0x363e5b(0xd7a)]&&_0x62eba1[_0x363e5b(0x1131)][_0x363e5b(0xd7a)][_0x363e5b(0xa06)]>0x0?_0x62eba1['settings'][_0x363e5b(0xd7a)][_0x363e5b(0xa3b)](_0x3c1ff2=>'-\x20'+_0x3c1ff2[_0x363e5b(0x609)])['join']('\x0a'):'-\x20(空)')+'\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a'+_0x62eba1[_0x363e5b(0x1131)]['myPersona']+_0x363e5b(0xb2c),_0x542a54=_0x107c1d['map'](_0x176d75=>({'role':_0x176d75['role'],'content':String(_0x176d75[_0x363e5b(0x53b)])}));_0x542a54[_0x363e5b(0x668)]({'role':_0x363e5b(0x586),'content':_0x363e5b(0x44b)});let _0x134bb7=_0x2bfb1c===GEMINI_API_URL,_0x7df9bc=_0x2e5c04(_0x65a9f2,_0x28866e,_0xc2f575,_0x542a54);const _0x543a43=_0x134bb7?await fetch(_0x7df9bc[_0x363e5b(0x11be)],_0x7df9bc[_0x363e5b(0x100d)]):await fetch(_0x2bfb1c+_0x363e5b(0x1090),{'method':_0x363e5b(0x116f),'headers':{'Content-Type':_0x363e5b(0x698),'Authorization':'Bearer\x20'+_0x28866e},'body':JSON[_0x363e5b(0xf1e)]({'model':_0x65a9f2,'messages':[{'role':_0x363e5b(0xb64),'content':_0xc2f575},..._0x542a54],'temperature':_0x9ebf46['globalSettings'][_0x363e5b(0xc3d)]||0.8})});if(!_0x543a43['ok']){const _0x55097f=await _0x543a43[_0x363e5b(0x5dd)]();throw new Error(_0x363e5b(0xe1a)+_0x55097f[_0x363e5b(0x1221)][_0x363e5b(0x86e)]);}const _0x3c874b=await _0x543a43[_0x363e5b(0x5dd)](),_0x414cb3=getGeminiResponseText(_0x3c874b),_0x5ddf57=_0x169d92(_0x414cb3),_0x3747dd=[];for(const _0x463c1a of _0x5ddf57){if(_0x463c1a[_0x363e5b(0x12d9)]===_0x363e5b(0xbb7)&&typeof _0x463c1a[_0x363e5b(0x53b)]===_0x363e5b(0xe56)&&_0x463c1a[_0x363e5b(0x53b)][_0x363e5b(0x930)]('\x0a')){const _0x453812=_0x463c1a[_0x363e5b(0x53b)][_0x363e5b(0x6c6)](/\n+/)[_0x363e5b(0x401)](_0xfd545a=>_0xfd545a['trim']());_0x453812[_0x363e5b(0x591)](_0x4f2129=>{_0x3747dd['push']({..._0x463c1a,'content':_0x4f2129});});}else _0x3747dd[_0x363e5b(0x668)](_0x463c1a);}let _0x26ca19=Date['now']();for(const _0x247e70 of _0x3747dd){const _0x52edcc={'role':_0x363e5b(0x1a7),'senderName':_0x62eba1['originalName'],'timestamp':_0x26ca19++,'content':_0x247e70[_0x363e5b(0x53b)]||_0x247e70[_0x363e5b(0x86e)],'type':_0x247e70[_0x363e5b(0x12d9)]||_0x363e5b(0xbb7)};if(_0x247e70[_0x363e5b(0x12d9)]===_0x363e5b(0x234)){if(!_0x62eba1[_0x363e5b(0x11e4)]){if(_0x247e70[_0x363e5b(0x39f)])_0x62eba1['heartfeltVoice']=String(_0x247e70[_0x363e5b(0x39f)]);if(_0x247e70[_0x363e5b(0xb98)])_0x62eba1[_0x363e5b(0xa1a)]=String(_0x247e70[_0x363e5b(0xb98)]);}continue;}_0x62eba1['history']['push'](_0x52edcc),_0xc4e879(_0x52edcc,_0x62eba1),await new Promise(_0x2327d4=>setTimeout(_0x2327d4,Math[_0x363e5b(0x360)]()*0x3e8+0x320));}await _0x2c5bcf[_0x363e5b(0x547)][_0x363e5b(0xff5)](_0x62eba1),_0x394b2c();}catch(_0x423b1e){console[_0x363e5b(0x1221)]('推进剧情失败:',_0x423b1e),await _0x1bff53('操作失败',_0x363e5b(0x1191)+_0x423b1e[_0x363e5b(0x86e)]);}finally{_0x39290a(_0x62eba1['id'],![]);if(!_0x62eba1[_0x363e5b(0x11e4)]&&document['getElementById'](_0x363e5b(0x117c))){const _0x4a90dd=document[_0x363e5b(0x9c8)](_0x363e5b(0x117c));_0x4a90dd[_0x363e5b(0x5e1)][_0x363e5b(0xb17)]=0x0,setTimeout(()=>{const _0x3fffc9=_0x363e5b;_0x4a90dd['textContent']=_0x62eba1['name'],_0x4a90dd[_0x3fffc9(0x575)][_0x3fffc9(0x30f)](_0x3fffc9(0x100e)),_0x4a90dd['style'][_0x3fffc9(0xb17)]=0x1;},0xc8);}}}function _0xf6d7e9(){const _0x48c1ef=_0x419fa8,_0x2ceb20=document[_0x48c1ef(0x9c8)](_0x48c1ef(0x76d)),_0x4068d5=_0x9ebf46['globalSettings'][_0x48c1ef(0xb7a)]||_0x178a2b;_0x4068d5&&_0x4068d5[_0x48c1ef(0x3f1)]()&&(_0x2ceb20[_0x48c1ef(0xbf4)]=_0x4068d5,_0x2ceb20['play']()['catch'](_0x10c57d=>console['log'](_0x48c1ef(0x5b3),_0x10c57d)));}function _0x1960df(){const _0x31db84=_0x419fa8;if(!_0x9ebf46['globalSettings'][_0x31db84(0xa5e)])return;for(const _0x8f9f1a in _0x9ebf46[_0x31db84(0x1383)]['widgetData']){const _0x249bba=document[_0x31db84(0x9c8)](_0x8f9f1a),_0x393014=_0x9ebf46[_0x31db84(0x1383)][_0x31db84(0xa5e)][_0x8f9f1a];_0x249bba&&(_0x249bba[_0x31db84(0xbcf)]===_0x31db84(0xf0b)?_0x249bba[_0x31db84(0xbf4)]=_0x393014:_0x249bba[_0x31db84(0xe24)]=_0x393014);}}function _0x750485(){return new Promise(_0x13dd3d=>{const _0x2339f8=_0x3569,_0xf296a6=document['createElement'](_0x2339f8(0x11ce));_0xf296a6[_0x2339f8(0x12d9)]=_0x2339f8(0x621),_0xf296a6[_0x2339f8(0xf8b)]=_0x2339f8(0xdab),_0xf296a6[_0x2339f8(0x693)]=_0x3446a7=>{const _0x4f8933=_0x2339f8,_0x417a21=_0x3446a7[_0x4f8933(0x1070)][_0x4f8933(0x1216)][0x0];if(_0x417a21){const _0xdf2bb8=new FileReader();_0xdf2bb8[_0x4f8933(0x429)]=_0x487c00=>{const _0x556cae=_0x4f8933;_0x13dd3d(_0x487c00['target'][_0x556cae(0xceb)]);},_0xdf2bb8[_0x4f8933(0xba5)](_0x417a21);}else _0x13dd3d(null);},_0xf296a6['click']();});}async function _0x1a3f1b(_0x482b16){const _0x2dfc2a=_0x419fa8,_0x1c20be=_0x482b16['id'],_0x47ae74=_0x482b16[_0x2dfc2a(0xe24)],_0x429e71=await _0xadb5df('修改文字',_0x2dfc2a(0x5a6),_0x47ae74);if(_0x429e71!==null&&_0x429e71[_0x2dfc2a(0x3f1)]()!==''){const _0x4a6d10=_0x429e71[_0x2dfc2a(0x3f1)]();_0x482b16[_0x2dfc2a(0xe24)]=_0x4a6d10,_0x9ebf46[_0x2dfc2a(0x1383)][_0x2dfc2a(0xa5e)][_0x1c20be]=_0x4a6d10,await _0x2c5bcf[_0x2dfc2a(0x1383)][_0x2dfc2a(0xff5)](_0x9ebf46[_0x2dfc2a(0x1383)]),alert(_0x2dfc2a(0x11e9));}}async function _0x2e5dd2(_0x210cc9){const _0x2d3262=_0x419fa8,_0x4cb4a5=_0x210cc9['id'],_0x3902f4=await _0xb8c832(_0x2d3262(0x421),[{'text':_0x2d3262(0x9c7),'value':_0x2d3262(0xc89)},{'text':_0x2d3262(0xc13),'value':'url'}]);let _0x2d6a4e=null;if(_0x3902f4==='local')_0x2d6a4e=await _0x750485();else _0x3902f4==='url'&&(_0x2d6a4e=await _0xadb5df(_0x2d3262(0x421),'请输入新的图片URL：',_0x210cc9[_0x2d3262(0xbf4)],_0x2d3262(0x11be)));if(_0x2d6a4e&&_0x2d6a4e[_0x2d3262(0x3f1)]()){const _0x9f8e3d=_0x2d6a4e['trim']();_0x210cc9[_0x2d3262(0xbf4)]=_0x9f8e3d,_0x9ebf46[_0x2d3262(0x1383)][_0x2d3262(0xa5e)][_0x4cb4a5]=_0x9f8e3d,await _0x2c5bcf[_0x2d3262(0x1383)][_0x2d3262(0xff5)](_0x9ebf46[_0x2d3262(0x1383)]),alert('图片已更新！');}else _0x3902f4==='url'&&_0x2d6a4e!==null&&alert(_0x2d3262(0xa5b));}const _0x371556={'getSongCache'(_0x6ac6bb,_0x19e992){const _0x4c2672=_0x419fa8,_0x50f1e3=(_0x19e992||'all')+':'+_0x6ac6bb;if(_0x9ebf46['cache']&&_0x9ebf46['cache'][_0x4c2672(0x237)]){const _0x2619d9=_0x9ebf46[_0x4c2672(0xaca)]['songs'][_0x4c2672(0xdf9)](_0x50f1e3);if(_0x2619d9&&Date[_0x4c2672(0x9b7)]()-_0x2619d9[_0x4c2672(0x6b5)]<0x36ee80)return _0x2619d9[_0x4c2672(0x100d)];}return null;},'setSongCache'(_0x73810b,_0x1b89a0,_0xb4837){const _0xa7a564=_0x419fa8,_0x466ba6=(_0xb4837||'all')+':'+_0x73810b;if(!_0x9ebf46['cache'])_0x9ebf46['cache']={};if(!_0x9ebf46[_0xa7a564(0xaca)][_0xa7a564(0x237)])_0x9ebf46[_0xa7a564(0xaca)][_0xa7a564(0x237)]=new Map();_0x9ebf46['cache'][_0xa7a564(0x237)]['set'](_0x466ba6,{'data':_0x1b89a0,'timestamp':Date[_0xa7a564(0x9b7)]()});}};typeof Http_Get_External==='undefined'&&(window['Http_Get_External']=function(_0x3cbd1b){return new Promise(_0x3890cb=>{const _0x4690ea=_0x3569;fetch(_0x3cbd1b)[_0x4690ea(0xcd7)](_0x3e07b6=>_0x3e07b6[_0x4690ea(0x5dd)]()[_0x4690ea(0xd7f)](()=>_0x3e07b6[_0x4690ea(0xbb7)]()))[_0x4690ea(0xcd7)](_0x3890cb)[_0x4690ea(0xd7f)](()=>_0x3890cb(null));});});async function _0xfd7aac(_0x376e4e){return await Http_Get_External(_0x376e4e);}function _0x1b2d11(_0x3f050c){return new Promise(_0x56993d=>{const _0x2fe461=_0x3569,_0x2215d9=new Audio();_0x2215d9['addEventListener'](_0x2fe461(0x282),()=>_0x56993d(!![]),{'once':!![]}),_0x2215d9[_0x2fe461(0xa0f)]('error',()=>_0x56993d(![]),{'once':!![]}),_0x2215d9[_0x2fe461(0xbf4)]=_0x3f050c;});}async function _0x49d60b(_0xbef456,_0x47edcf){const _0x40ea02=_0x419fa8;try{let _0x4d3065=_0xbef456['replace'](/\s/g,'');_0x47edcf&&(_0x4d3065+='\x20'+_0x47edcf[_0x40ea02(0x459)](/\s/g,''));const _0x150b02=_0x40ea02(0x204)+encodeURIComponent(_0x4d3065);console['log'](_0x40ea02(0x765),_0x150b02);const _0x1a9984=await fetch(_0x150b02);if(!_0x1a9984['ok'])throw new Error('API\x20请求失败，状态码:\x20'+_0x1a9984[_0x40ea02(0xebd)]);const _0xa09594=await _0x1a9984[_0x40ea02(0x5dd)]();if(_0xa09594[_0x40ea02(0xea2)]!==0xc8||!_0xa09594[_0x40ea02(0x100d)]||_0xa09594[_0x40ea02(0x100d)]['length']===0x0)return console[_0x40ea02(0x283)]('网易云音乐API未返回有效结果:',_0xa09594),[];return _0xa09594[_0x40ea02(0x100d)][_0x40ea02(0xa3b)](_0x72a710=>({'name':_0x72a710[_0x40ea02(0xf25)],'artist':_0x72a710['singer'],'id':_0x72a710['id'],'cover':_0x72a710[_0x40ea02(0x669)]||'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','source':_0x40ea02(0x3c0)}))['slice'](0x0,0x1e);}catch(_0x3bf308){return console[_0x40ea02(0x1221)]('网易云音乐搜索失败:',_0x3bf308),[];}}async function _0x2b9fc9(_0x35123b){const _0x26d547=_0x419fa8;try{_0x35123b=_0x35123b[_0x26d547(0x459)](/\s/g,'');const _0x1164ef=await _0xfd7aac(_0x26d547(0xe23)+encodeURIComponent(_0x35123b));if(!_0x1164ef?.[_0x26d547(0x100d)]?.['length'])return[];return _0x1164ef['data'][_0x26d547(0xa3b)](_0x264291=>({'name':_0x264291['song'],'artist':_0x264291[_0x26d547(0xc94)],'id':_0x264291['id'],'cover':_0x264291[_0x26d547(0x669)]||_0x26d547(0x851),'source':_0x26d547(0x2dd)}))[_0x26d547(0x1044)](0x0,0x1e);}catch(_0x3681d1){return console[_0x26d547(0x1221)](_0x26d547(0x117a),_0x3681d1),[];}}async function _0x3c6868(){const _0x42fb53=_0x419fa8,_0x361e1f=await _0xadb5df(_0x42fb53(0x116b),_0x42fb53(0x1a3));if(!_0x361e1f||!_0x361e1f['trim']())return;await _0x1bff53(_0x42fb53(0x7a4),'正在全网搜索歌曲资源...');let _0x4a08b0=_0x361e1f[_0x42fb53(0x3f1)](),_0x1391af='';if(_0x361e1f[_0x42fb53(0x930)]('-')||_0x361e1f[_0x42fb53(0x930)]('–')){const _0x154035=_0x361e1f[_0x42fb53(0x6c6)](/[-–]/);_0x4a08b0=_0x154035[0x0][_0x42fb53(0x3f1)](),_0x1391af=_0x154035['slice'](0x1)[_0x42fb53(0x809)]('\x20')[_0x42fb53(0x3f1)]();}const [_0x514904,_0x1235c6]=await Promise[_0x42fb53(0xd0a)]([_0x49d60b(_0x4a08b0,_0x1391af),_0x2b9fc9(_0x4a08b0)]),_0x5694d9=[..._0x514904,..._0x1235c6];if(_0x5694d9[_0x42fb53(0xa06)]===0x0){await _0x1bff53(_0x42fb53(0x245),_0x42fb53(0x12d6));return;}const _0x4cedfb=document[_0x42fb53(0x9c8)](_0x42fb53(0xb5b)),_0xf49cb1=document[_0x42fb53(0x9c8)](_0x42fb53(0x7f0));_0xf49cb1[_0x42fb53(0x2f5)]='',document[_0x42fb53(0x9c8)]('select-all-music-search')['checked']=![],_0x5694d9[_0x42fb53(0x591)](_0x24663d=>{const _0x12e4c4=_0x42fb53,_0x574f52=document['createElement'](_0x12e4c4(0x11f4));_0x574f52[_0x12e4c4(0x82c)]='search-result-item',_0x574f52[_0x12e4c4(0xc9f)]['songJson']=JSON['stringify'](_0x24663d),_0x574f52[_0x12e4c4(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x24663d['name']+_0x12e4c4(0xade)+_0x24663d[_0x12e4c4(0xc14)]+_0x12e4c4(0x6c1)+(_0x24663d['source']==='netease'?_0x12e4c4(0x10fa):_0x12e4c4(0xb97))+_0x12e4c4(0xd1b),_0xf49cb1[_0x12e4c4(0x7b9)](_0x574f52);}),_0x4cedfb[_0x42fb53(0x575)][_0x42fb53(0x68e)](_0x42fb53(0xc3f));}async function _0x4e7b18(_0x361996){const _0x5720bb=_0x419fa8;let _0x137b6d=null,_0x2903df=_0x361996[_0x5720bb(0x9c9)];const _0x5c9a24=_0x361996[_0x5720bb(0x9c9)]===_0x5720bb(0x3c0)?'https://api.vkeys.cn/v2/music/netease?id='+_0x361996['id']:_0x5720bb(0x365)+_0x361996['id'];let _0x542506=await _0xfd7aac(_0x5c9a24);_0x542506?.[_0x5720bb(0x100d)]?.['url']&&(_0x137b6d={'url':_0x542506['data'][_0x5720bb(0x11be)],'id':_0x361996['id'],'source':_0x361996[_0x5720bb(0x9c9)]});if(!_0x137b6d){const _0x3db5c4=_0x361996[_0x5720bb(0x9c9)]===_0x5720bb(0x3c0)?'tencent':_0x5720bb(0x3c0),_0x47d475=_0x3db5c4===_0x5720bb(0x2dd)?await _0x2b9fc9(_0x361996[_0x5720bb(0x609)]):await _0x49d60b(_0x361996[_0x5720bb(0x609)],_0x361996['artist']);if(_0x47d475[_0x5720bb(0xa06)]>0x0){const _0x3d2fed=_0x3db5c4===_0x5720bb(0x3c0)?_0x5720bb(0x12cf)+_0x47d475[0x0]['id']:_0x5720bb(0x365)+_0x47d475[0x0]['id'],_0xf6d5e6=await _0xfd7aac(_0x3d2fed);_0xf6d5e6?.['data']?.[_0x5720bb(0x11be)]&&(_0x137b6d={'url':_0xf6d5e6[_0x5720bb(0x100d)]['url'],'id':_0x47d475[0x0]['id'],'source':_0x3db5c4},_0x2903df=_0x3db5c4);}}if(_0x137b6d){_0x137b6d[_0x5720bb(0x11be)]&&typeof _0x137b6d[_0x5720bb(0x11be)]===_0x5720bb(0xe56)&&(_0x137b6d[_0x5720bb(0x11be)]=_0x137b6d[_0x5720bb(0x11be)][_0x5720bb(0x459)](/^http:\/\//i,_0x5720bb(0xdf8)));_0x361996[_0x5720bb(0x669)]&&typeof _0x361996[_0x5720bb(0x669)]===_0x5720bb(0xe56)&&(_0x361996[_0x5720bb(0x669)]=_0x361996[_0x5720bb(0x669)][_0x5720bb(0x459)](/^http:\/\//i,_0x5720bb(0xdf8)));const _0x4ee83f=await _0x89bd0(_0x137b6d['id'],_0x2903df)||'';return{'name':_0x361996['name'],'artist':_0x361996[_0x5720bb(0xc14)],'src':_0x137b6d[_0x5720bb(0x11be)],'cover':_0x361996[_0x5720bb(0x669)],'isLocal':![],'lrcContent':_0x4ee83f};}return null;}async function _0x89bd0(_0x2f2777,_0x111b5d){const _0x197b7a=_0x419fa8,_0x3144c1=_0x111b5d==='netease'?_0x197b7a(0xd57)+_0x2f2777:_0x197b7a(0x12f9)+_0x2f2777,_0x2e0235=await _0xfd7aac(_0x3144c1);if(_0x2e0235?.[_0x197b7a(0x100d)]){const _0x256349=_0x2e0235[_0x197b7a(0x100d)][_0x197b7a(0x2dc)]||_0x2e0235[_0x197b7a(0x100d)][_0x197b7a(0x121a)]||'',_0x27492d=_0x2e0235['data']['trans']||_0x2e0235[_0x197b7a(0x100d)][_0x197b7a(0xb87)]||'';return _0x256349+'\x0a'+_0x27492d;}return'';}async function _0x140b9a(_0x1a2faa){const _0x41e1f8=_0x419fa8;if(_0x1a2faa<0x0||_0x1a2faa>=_0x5062a9[_0x41e1f8(0x8e6)][_0x41e1f8(0xa06)])return;const _0xda500a=await _0xb8c832(_0x41e1f8(0xad0),[{'text':_0x41e1f8(0x44a),'value':_0x41e1f8(0x621)},{'text':_0x41e1f8(0x5d9),'value':'paste'}]);let _0x4cc664=null;if(_0xda500a===_0x41e1f8(0x621))_0x4cc664=await new Promise(_0x2cb89d=>{const _0x1b6455=_0x41e1f8,_0x51caf5=document[_0x1b6455(0x9c8)](_0x1b6455(0xd18)),_0x375d59=_0x42d6d8=>{const _0x5b2569=_0x1b6455,_0xff8f61=_0x42d6d8[_0x5b2569(0x1070)][_0x5b2569(0x1216)][0x0];if(_0xff8f61){const _0x17dee9=new FileReader();_0x17dee9[_0x5b2569(0x429)]=_0x9844df=>_0x2cb89d(_0x9844df[_0x5b2569(0x1070)][_0x5b2569(0xceb)]),_0x17dee9[_0x5b2569(0x11e5)]=()=>_0x2cb89d(null),_0x17dee9[_0x5b2569(0x3c6)](_0xff8f61);}else _0x2cb89d(null);_0x51caf5[_0x5b2569(0xc9d)](_0x5b2569(0x25c),_0x375d59),_0x51caf5[_0x5b2569(0x1155)]='';};_0x51caf5['addEventListener'](_0x1b6455(0x25c),_0x375d59,{'once':!![]}),_0x51caf5[_0x1b6455(0xf5c)]();});else{if(_0xda500a==='paste'){const _0xf99636=await _0xadb5df('粘贴歌词','请在此处粘贴完整的LRC格式歌词...','',_0x41e1f8(0x11f9));if(_0xf99636)_0x4cc664=_0xf99636['replace'](/\[/g,'\x0a[')[_0x41e1f8(0x3f1)]();}}_0x4cc664!==null&&(_0x5062a9['playlist'][_0x1a2faa]['lrcContent']=_0x4cc664,await _0x4b5360(),_0x5062a9['currentIndex']===_0x1a2faa&&(_0x5062a9['parsedLyrics']=_0x52e008(_0x4cc664),_0x2e2dbe(),_0x2bd0ed()),await _0x1bff53('成功','《'+_0x5062a9[_0x41e1f8(0x8e6)][_0x1a2faa][_0x41e1f8(0x609)]+_0x41e1f8(0x1ed)));}async function _0xbf1dfc(){const _0x380c6e=_0x419fa8;if(_0x5062a9[_0x380c6e(0xcc8)]===-0x1)return;const _0x1eb296=_0x5062a9[_0x380c6e(0x8e6)][_0x5062a9[_0x380c6e(0xcc8)]];if(!_0x1eb296)return;_0x1eb296['isBgClear']=!_0x1eb296['isBgClear'],await _0x4b5360();const _0x393cd3=document['querySelector']('.music-player-window'),_0x3166f=document[_0x380c6e(0x9c8)](_0x380c6e(0x47b));_0x393cd3['classList'][_0x380c6e(0x1c3)]('bg-clear',_0x1eb296[_0x380c6e(0x6d5)]),_0x3166f['classList'][_0x380c6e(0x1c3)]('active',_0x1eb296[_0x380c6e(0x6d5)]);}function _0xf3f302(){const _0xb134db=_0x419fa8,_0x520965=document[_0xb134db(0x9c8)](_0xb134db(0xe9d)),_0x504198=document[_0xb134db(0x9c8)](_0xb134db(0x1ee));_0x520965&&_0x504198&&(_0x520965[_0xb134db(0x575)][_0xb134db(0x1c3)](_0xb134db(0xc3f)),_0x504198[_0xb134db(0x575)][_0xb134db(0x1c3)](_0xb134db(0x113d)));}function _0x11cad0(){const _0xd973ef=_0x419fa8,_0x4b758a=document[_0xd973ef(0x91d)](_0xd973ef(0x11f1)),_0x2739de=document['getElementById'](_0xd973ef(0x41e));_0x4b758a&&_0x2739de&&(_0x4b758a['classList']['toggle']('fullscreen'),_0x2739de['classList'][_0xd973ef(0x1c3)](_0xd973ef(0x826)));}window[_0x419fa8(0xda7)]=_0x11cad0;async function _0x569916(){const _0x1dcb00=_0x419fa8;if(_0x5062a9[_0x1dcb00(0x8e6)][_0x1dcb00(0xa06)]===0x0){alert(_0x1dcb00(0x632));return;}const _0xcbfc91=await _0x352ae9(_0x1dcb00(0xe3f),'此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。',{'confirmText':'开始清理'});if(!_0xcbfc91)return;await _0x1bff53(_0x1dcb00(0x7a4),'正在检查\x20'+_0x5062a9[_0x1dcb00(0x8e6)][_0x1dcb00(0xa06)]+_0x1dcb00(0x457));const _0x129a3d=_0x5062a9['playlist'][_0x1dcb00(0xa06)],_0x6575ae=[],_0x3f7c5e=[],_0x4518a7=_0x5062a9['playlist'][_0x1dcb00(0xa3b)](async _0x5b775b=>{const _0x1303fb=_0x1dcb00;if(_0x5b775b['isLocal']){_0x6575ae[_0x1303fb(0x668)](_0x5b775b);return;}const _0x57bbd9=await _0x1b2d11(_0x5b775b['src']);_0x57bbd9?_0x6575ae[_0x1303fb(0x668)](_0x5b775b):(_0x3f7c5e['push'](_0x5b775b[_0x1303fb(0x609)]),console['warn'](_0x1303fb(0x1328)+_0x5b775b[_0x1303fb(0x609)]+_0x1303fb(0x23e)+_0x5b775b['src']));});await Promise[_0x1dcb00(0xd0a)](_0x4518a7);const _0x192ab8=_0x129a3d-_0x6575ae['length'];if(_0x192ab8>0x0){const _0x371b65=_0x5062a9[_0x1dcb00(0x8e6)][_0x5062a9[_0x1dcb00(0xcc8)]],_0x4c004a=_0x3f7c5e[_0x1dcb00(0x930)](_0x371b65?.[_0x1dcb00(0x609)]);_0x5062a9[_0x1dcb00(0x8e6)]=_0x6575ae,await _0x4b5360();if(_0x4c004a)_0x287389[_0x1dcb00(0x6f2)](),_0x287389[_0x1dcb00(0xbf4)]='',_0x5062a9[_0x1dcb00(0xcc8)]=_0x5062a9[_0x1dcb00(0x8e6)]['length']>0x0?0x0:-0x1,_0x5062a9[_0x1dcb00(0x50c)]=![];else _0x371b65&&(_0x5062a9['currentIndex']=_0x5062a9[_0x1dcb00(0x8e6)][_0x1dcb00(0x684)](_0x43ffdd=>_0x43ffdd[_0x1dcb00(0xbf4)]===_0x371b65[_0x1dcb00(0xbf4)]));_0x2330eb(),_0x424265(),await _0x1bff53(_0x1dcb00(0x4c8),_0x1dcb00(0x468)+_0x192ab8+'\x20首无效歌曲:\x0a\x0a-\x20'+_0x3f7c5e[_0x1dcb00(0x809)](_0x1dcb00(0x12be)));}else await _0x1bff53('检查完成',_0x1dcb00(0x89e));}function _0x2417f9(){const _0x2e5e52=_0x419fa8,_0x503967=document[_0x2e5e52(0x9c8)](_0x2e5e52(0x6fb));_0x503967[_0x2e5e52(0x575)][_0x2e5e52(0x1c3)](_0x2e5e52(0x42d),!!_0x9ebf46[_0x2e5e52(0x1383)][_0x2e5e52(0xb3b)]);}async function _0x373cde(){const _0x384c89=_0x419fa8,_0x586a1d=document['getElementById'](_0x384c89(0x1203)),_0x34b194=document[_0x384c89(0x9c8)](_0x384c89(0x5b8));_0x34b194[_0x384c89(0x2f5)]='';const _0x4c9a98=[];_0x4c9a98[_0x384c89(0x668)]({'text':'清空所有动态\x20(危险)','value':_0x384c89(0xd0a),'isDanger':!![]});const _0x2e68c8=_0x9ebf46[_0x384c89(0x32c)]['nickname']||'我';_0x4c9a98['push']({'text':_0x384c89(0xd13)+_0x2e68c8+_0x384c89(0x1385),'value':_0x384c89(0x586)}),Object[_0x384c89(0xeb2)](_0x9ebf46[_0x384c89(0x547)])[_0x384c89(0x591)](_0x5790b2=>{const _0x26b3aa=_0x384c89;!_0x5790b2[_0x26b3aa(0x11e4)]&&_0x4c9a98[_0x26b3aa(0x668)]({'text':_0x26b3aa(0xd13)+_0x5790b2[_0x26b3aa(0x609)]+_0x26b3aa(0x439),'value':_0x5790b2['id']});});try{const _0x3e9b04=await _0x2c5bcf[_0x384c89(0x1094)][_0x384c89(0x5ff)]();_0x3e9b04[_0x384c89(0xa06)]>0x0&&(_0x4c9a98[_0x384c89(0x668)]({'isSeparator':!![],'text':_0x384c89(0xb73)}),_0x3e9b04['forEach'](_0x2c89c8=>{const _0x2d549d=_0x384c89;_0x4c9a98[_0x2d549d(0x668)]({'text':'仅清空\x20'+_0x2c89c8[_0x2d549d(0x609)]+'\x20的动态\x20(NPC)','value':_0x2d549d(0x2e7)+_0x2c89c8['id']});}));}catch(_0x9361a5){console['error'](_0x384c89(0x108d),_0x9361a5);}_0x4c9a98['forEach'](_0x2cb9a6=>{const _0x5b64e3=_0x384c89;if(_0x2cb9a6[_0x5b64e3(0x109e)]){const _0x1d352f=document[_0x5b64e3(0x28a)]('div');_0x1d352f[_0x5b64e3(0xe24)]=_0x2cb9a6[_0x5b64e3(0xbb7)],_0x1d352f[_0x5b64e3(0x5e1)]['cssText']=_0x5b64e3(0xa30),_0x34b194[_0x5b64e3(0x7b9)](_0x1d352f);return;}const _0x281857=document[_0x5b64e3(0x28a)](_0x5b64e3(0x11f4));_0x281857['className']=_0x5b64e3(0xab6),_0x2cb9a6[_0x5b64e3(0x76b)]&&_0x281857[_0x5b64e3(0x575)]['add'](_0x5b64e3(0x1206)),_0x281857[_0x5b64e3(0xc9f)][_0x5b64e3(0x1103)]=_0x2cb9a6[_0x5b64e3(0x1155)],_0x281857[_0x5b64e3(0x2f5)]=_0x5b64e3(0xb9c)+_0x2cb9a6[_0x5b64e3(0xbb7)]+_0x5b64e3(0x215),_0x34b194[_0x5b64e3(0x7b9)](_0x281857);}),_0x586a1d[_0x384c89(0x575)][_0x384c89(0x68e)](_0x384c89(0xc3f));}async function _0x29bda0(){const _0xfb28bf=_0x419fa8,_0x1e9b23=document[_0xfb28bf(0x7e4)]('#clear-posts-list\x20.clear-posts-item.selected');if(_0x1e9b23['length']===0x0){alert('请至少选择一个要清空的范围。');return;}const _0x5f5863=Array['from'](_0x1e9b23)[_0xfb28bf(0xa3b)](_0x51a9cd=>_0x51a9cd['dataset'][_0xfb28bf(0x1103)]);let _0x2c6d45=[];_0x5f5863[_0xfb28bf(0x930)](_0xfb28bf(0xd0a))?_0x2c6d45[_0xfb28bf(0x668)](_0xfb28bf(0xef1)):(_0x5f5863[_0xfb28bf(0x930)](_0xfb28bf(0x586))&&_0x2c6d45['push']('“'+_0x9ebf46['qzoneSettings'][_0xfb28bf(0x5b7)]+'”'),_0x5f5863[_0xfb28bf(0x591)](_0x422dd9=>{const _0x3e60a3=_0xfb28bf,_0x33fb93=_0x9ebf46['chats'][_0x422dd9];_0x33fb93&&_0x2c6d45['push']('“'+_0x33fb93[_0x3e60a3(0x609)]+'”');}));const _0x406300='此操作将永久删除\x20'+_0x2c6d45[_0xfb28bf(0x809)]('、\x20')+_0xfb28bf(0x321),_0x522bec=await _0x352ae9(_0xfb28bf(0x1366),_0x406300,{'confirmButtonClass':_0xfb28bf(0x12bc),'confirmText':'确认清空'});if(!_0x522bec)return;try{_0x5f5863[_0xfb28bf(0x930)](_0xfb28bf(0xd0a))?await _0x2c5bcf[_0xfb28bf(0x75f)][_0xfb28bf(0xdae)]():await _0x2c5bcf[_0xfb28bf(0x75f)][_0xfb28bf(0xe78)](_0xfb28bf(0x61c))['anyOf'](_0x5f5863)[_0xfb28bf(0x6d2)](),_0x20f1b5=await _0x2c5bcf[_0xfb28bf(0x75f)][_0xfb28bf(0x8ea)](_0xfb28bf(0x6b5))[_0xfb28bf(0x101e)]()[_0xfb28bf(0x5ff)](),_0xca834d=0x0,await _0x2c70a9(),document[_0xfb28bf(0x9c8)](_0xfb28bf(0x1203))[_0xfb28bf(0x575)]['remove'](_0xfb28bf(0xc3f)),await _0x1bff53(_0xfb28bf(0x7de),_0xfb28bf(0x6ac));}catch(_0x44cbe5){console['error'](_0xfb28bf(0x8e7),_0x44cbe5),await _0x1bff53(_0xfb28bf(0x24d),_0xfb28bf(0x915)+_0x44cbe5[_0xfb28bf(0x86e)]);}}async function _0x4400b5(_0x3fd1bb){const _0x278e13=_0x419fa8,_0x6a9c62=await _0x352ae9('确认删除',_0x278e13(0x6cf),{'confirmButtonClass':_0x278e13(0x12bc),'confirmText':_0x278e13(0x115b)});if(_0x6a9c62){const _0x45b143=_0x9ebf46[_0x278e13(0x547)][_0x9ebf46[_0x278e13(0x970)]];if(!_0x45b143||!_0x45b143[_0x278e13(0xec6)])return;const _0x2fb414=_0x45b143[_0x278e13(0xec6)][_0x278e13(0x684)](_0x8f6ea1=>_0x8f6ea1[_0x278e13(0x6b5)]===_0x3fd1bb);if(_0x2fb414===-0x1)return;const _0x14afd1=_0x2fb414===_0x45b143[_0x278e13(0xec6)]['length']-0x1;_0x45b143[_0x278e13(0xec6)]=_0x45b143['thoughtsHistory'][_0x278e13(0x401)](_0x2020c1=>_0x2020c1[_0x278e13(0x6b5)]!==_0x3fd1bb);if(_0x14afd1){if(_0x45b143['thoughtsHistory'][_0x278e13(0xa06)]>0x0){const _0x1e9845=_0x45b143[_0x278e13(0xec6)][_0x45b143[_0x278e13(0xec6)][_0x278e13(0xa06)]-0x1];_0x45b143[_0x278e13(0x1291)]=_0x1e9845[_0x278e13(0x1291)],_0x45b143['randomJottings']=_0x1e9845[_0x278e13(0xa1a)];const _0x9db858=document[_0x278e13(0x9c8)](_0x278e13(0x2f8)),_0xf1c7f7=document[_0x278e13(0x9c8)](_0x278e13(0xd7c));if(_0x9db858)_0x9db858[_0x278e13(0xe24)]=_0x45b143['heartfeltVoice'];if(_0xf1c7f7)_0xf1c7f7['textContent']=_0x45b143['randomJottings'];console[_0x278e13(0x283)](_0x278e13(0xba6));}else{_0x45b143[_0x278e13(0x1291)]=_0x278e13(0xf66),_0x45b143[_0x278e13(0xa1a)]=_0x278e13(0xf66);const _0x2539ae=document[_0x278e13(0x9c8)](_0x278e13(0x2f8)),_0x340583=document[_0x278e13(0x9c8)](_0x278e13(0xd7c));if(_0x2539ae)_0x2539ae[_0x278e13(0xe24)]=_0x45b143[_0x278e13(0x1291)];if(_0x340583)_0x340583[_0x278e13(0xe24)]=_0x45b143[_0x278e13(0xa1a)];console[_0x278e13(0x283)](_0x278e13(0x4a1));}}await _0x2c5bcf[_0x278e13(0x547)][_0x278e13(0xff5)](_0x45b143),_0x3f826d(),await _0x1bff53('成功',_0x278e13(0xeac));}}document[_0x419fa8(0x9c8)](_0x419fa8(0x771))[_0x419fa8(0xa0f)]('click',_0x16e108=>{const _0xda5370=_0x419fa8,_0x2aea76=_0x16e108[_0xda5370(0x1070)][_0xda5370(0xaa0)]('.thought-delete-btn');if(_0x2aea76){const _0x48fcfc=parseInt(_0x2aea76[_0xda5370(0xc9f)][_0xda5370(0x6b5)]);!isNaN(_0x48fcfc)&&_0x4400b5(_0x48fcfc);}});async function _0xd0ffc0(){const _0x6967cd=_0x419fa8,_0x1b6ed6=document[_0x6967cd(0x9c8)](_0x6967cd(0x701));_0x1b6ed6[_0x6967cd(0x2f5)]=_0x6967cd(0xcbf);const _0x3024e8=await _0x2c5bcf[_0x6967cd(0xdc6)][_0x6967cd(0xe78)]('type')[_0x6967cd(0xda9)]('global_css')[_0x6967cd(0x5ff)]();_0x3024e8[_0x6967cd(0x591)](_0x163dd1=>{const _0x5675ab=_0x6967cd,_0x2d9a0c=document[_0x5675ab(0x28a)](_0x5675ab(0x12ef));_0x2d9a0c[_0x5675ab(0x1155)]=_0x163dd1['id'],_0x2d9a0c[_0x5675ab(0xe24)]=_0x163dd1[_0x5675ab(0x609)],_0x1b6ed6[_0x5675ab(0x7b9)](_0x2d9a0c);});}async function _0x1e84ed(){const _0x4b13df=_0x419fa8,_0x4ee1fa=document[_0x4b13df(0x9c8)](_0x4b13df(0x701)),_0x23b874=parseInt(_0x4ee1fa[_0x4b13df(0x1155)]);if(isNaN(_0x23b874))return;const _0x47ad26=await _0x2c5bcf[_0x4b13df(0xdc6)]['get'](_0x23b874);if(_0x47ad26){const _0x169e35=document[_0x4b13df(0x9c8)]('global-css-input');_0x169e35[_0x4b13df(0x1155)]=_0x47ad26[_0x4b13df(0x1155)],_0x4bc8ea(_0x47ad26['value']);}}async function _0x5712bf(){const _0x4ea32c=_0x419fa8,_0xb82851=await _0xadb5df(_0x4ea32c(0xa4f),_0x4ea32c(0x1339));if(!_0xb82851||!_0xb82851[_0x4ea32c(0x3f1)]())return;const _0x48c2b4=document[_0x4ea32c(0x9c8)]('global-css-input')[_0x4ea32c(0x1155)],_0xbc8067=await _0x2c5bcf['appearancePresets'][_0x4ea32c(0xe78)]({'name':_0xb82851[_0x4ea32c(0x3f1)](),'type':_0x4ea32c(0x121b)})[_0x4ea32c(0x476)]();if(_0xbc8067){const _0x1b288e=await _0x352ae9(_0x4ea32c(0x1333),_0x4ea32c(0xecc)+_0xb82851[_0x4ea32c(0x3f1)]()+_0x4ea32c(0x118b),{'confirmButtonClass':'btn-danger'});if(!_0x1b288e)return;await _0x2c5bcf[_0x4ea32c(0xdc6)][_0x4ea32c(0x13a4)](_0xbc8067['id'],{'value':_0x48c2b4});}else await _0x2c5bcf[_0x4ea32c(0xdc6)][_0x4ea32c(0x68e)]({'name':_0xb82851[_0x4ea32c(0x3f1)](),'type':_0x4ea32c(0x121b),'value':_0x48c2b4});await _0xd0ffc0(),alert('CSS\x20预设已保存！');}async function _0x2028b9(){const _0x3aa5bd=_0x419fa8,_0x56c3ac=document[_0x3aa5bd(0x9c8)](_0x3aa5bd(0x701)),_0x5755f1=parseInt(_0x56c3ac['value']);if(isNaN(_0x5755f1)){alert(_0x3aa5bd(0x11fd));return;}const _0x8b2c8=await _0x2c5bcf[_0x3aa5bd(0xdc6)][_0x3aa5bd(0xdf9)](_0x5755f1);if(!_0x8b2c8)return;const _0x5ef3db=await _0x352ae9(_0x3aa5bd(0x2a9),'确定要删除预设\x20“'+_0x8b2c8[_0x3aa5bd(0x609)]+_0x3aa5bd(0x924),{'confirmButtonClass':_0x3aa5bd(0x12bc)});_0x5ef3db&&(await _0x2c5bcf['appearancePresets'][_0x3aa5bd(0x6d2)](_0x5755f1),await _0xd0ffc0(),alert(_0x3aa5bd(0xb74)));}async function _0x2b9f7f(){const _0x4edc20=_0x419fa8,_0x2ae8e7=document[_0x4edc20(0x9c8)](_0x4edc20(0x425));_0x2ae8e7[_0x4edc20(0x2f5)]='<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>';const _0x3513d2=await _0x2c5bcf[_0x4edc20(0xdc6)][_0x4edc20(0xe78)](_0x4edc20(0x12d9))['equals'](_0x4edc20(0x9d7))[_0x4edc20(0x5ff)]();_0x3513d2[_0x4edc20(0x591)](_0x131c07=>{const _0x41d8ea=_0x4edc20,_0x15ba15=document[_0x41d8ea(0x28a)](_0x41d8ea(0x12ef));_0x15ba15[_0x41d8ea(0x1155)]=_0x131c07['id'],_0x15ba15['textContent']=_0x131c07[_0x41d8ea(0x609)],_0x2ae8e7['appendChild'](_0x15ba15);});}async function _0x16c5e7(){const _0x1ffc4d=_0x419fa8,_0x97080c=document['getElementById'](_0x1ffc4d(0x425)),_0x27dea6=parseInt(_0x97080c[_0x1ffc4d(0x1155)]);if(isNaN(_0x27dea6))return;const _0x3162ae=await _0x2c5bcf[_0x1ffc4d(0xdc6)]['get'](_0x27dea6);if(_0x3162ae){const _0x4be60c=document['getElementById'](_0x1ffc4d(0xebe));_0x4be60c['value']=_0x3162ae[_0x1ffc4d(0x1155)],_0xd42b1c(_0x3162ae[_0x1ffc4d(0x1155)],!![]);}}async function _0x15e7f5(){const _0x4f5ffc=_0x419fa8,_0x1b3554=await _0xadb5df('保存字体预设','请输入预设名称');if(!_0x1b3554||!_0x1b3554[_0x4f5ffc(0x3f1)]())return;const _0x5ce10b=document['getElementById'](_0x4f5ffc(0xebe))[_0x4f5ffc(0x1155)][_0x4f5ffc(0x3f1)]();if(!_0x5ce10b){alert(_0x4f5ffc(0x1139));return;}const _0x30504c=await _0x2c5bcf['appearancePresets'][_0x4f5ffc(0xe78)]({'name':_0x1b3554[_0x4f5ffc(0x3f1)](),'type':'font'})['first']();if(_0x30504c){const _0x214ce2=await _0x352ae9(_0x4f5ffc(0x1333),_0x4f5ffc(0xecc)+_0x1b3554[_0x4f5ffc(0x3f1)]()+_0x4f5ffc(0x118b),{'confirmButtonClass':_0x4f5ffc(0x12bc)});if(!_0x214ce2)return;await _0x2c5bcf[_0x4f5ffc(0xdc6)][_0x4f5ffc(0x13a4)](_0x30504c['id'],{'value':_0x5ce10b});}else await _0x2c5bcf['appearancePresets'][_0x4f5ffc(0x68e)]({'name':_0x1b3554['trim'](),'type':_0x4f5ffc(0x9d7),'value':_0x5ce10b});await _0x2b9f7f(),alert(_0x4f5ffc(0x5fc));}async function _0x1c2bde(){const _0x289957=_0x419fa8,_0x42d6de=document[_0x289957(0x9c8)](_0x289957(0x425)),_0x4b3752=parseInt(_0x42d6de[_0x289957(0x1155)]);if(isNaN(_0x4b3752)){alert(_0x289957(0x11fd));return;}const _0x123166=await _0x2c5bcf[_0x289957(0xdc6)][_0x289957(0xdf9)](_0x4b3752);if(!_0x123166)return;const _0x5049ce=await _0x352ae9('删除预设',_0x289957(0x36c)+_0x123166[_0x289957(0x609)]+_0x289957(0x924),{'confirmButtonClass':_0x289957(0x12bc)});_0x5049ce&&(await _0x2c5bcf['appearancePresets'][_0x289957(0x6d2)](_0x4b3752),await _0x2b9f7f(),alert(_0x289957(0xb74)));}async function _0x407950(){const _0x25ad60=_0x419fa8,_0x504762=document[_0x25ad60(0x9c8)](_0x25ad60(0x122e));_0x504762[_0x25ad60(0x2f5)]=_0x25ad60(0xcbf);const _0x3ec650=await _0x2c5bcf[_0x25ad60(0xdc6)][_0x25ad60(0xe78)](_0x25ad60(0x12d9))[_0x25ad60(0xda9)]('appearance')[_0x25ad60(0x5ff)]();_0x3ec650[_0x25ad60(0x591)](_0x1dbb84=>{const _0x4b65f9=_0x25ad60,_0x3c7927=document[_0x4b65f9(0x28a)](_0x4b65f9(0x12ef));_0x3c7927[_0x4b65f9(0x1155)]=_0x1dbb84['id'],_0x3c7927[_0x4b65f9(0xe24)]=_0x1dbb84[_0x4b65f9(0x609)],_0x504762[_0x4b65f9(0x7b9)](_0x3c7927);});const _0x4c1eaf={'wallpaper':_0x9ebf46[_0x25ad60(0x1383)]['wallpaper'],'cphoneWallpaper':_0x9ebf46[_0x25ad60(0x1383)][_0x25ad60(0xe0b)],'globalChatBackground':_0x9ebf46['globalSettings'][_0x25ad60(0x73a)],'appIcons':_0x9ebf46[_0x25ad60(0x1383)]['appIcons'],'cphoneAppIcons':_0x9ebf46[_0x25ad60(0x1383)][_0x25ad60(0xe9b)],'chatActionButtonsOrder':_0x9ebf46[_0x25ad60(0x1383)]['chatActionButtonsOrder'],'theme':localStorage['getItem'](_0x25ad60(0x864))||_0x25ad60(0xfa2),'showStatusBar':_0x9ebf46[_0x25ad60(0x1383)][_0x25ad60(0xb3b)],'notificationSoundUrl':_0x9ebf46[_0x25ad60(0x1383)][_0x25ad60(0xb7a)],'widgetData':_0x9ebf46[_0x25ad60(0x1383)][_0x25ad60(0xa5e)]};let _0x3188ac=null;for(const _0x269d04 of _0x3ec650){if(JSON[_0x25ad60(0xf1e)](_0x269d04[_0x25ad60(0x1155)])===JSON['stringify'](_0x4c1eaf)){_0x3188ac=_0x269d04['id'];break;}}_0x3188ac?_0x504762[_0x25ad60(0x1155)]=_0x3188ac:_0x504762[_0x25ad60(0x1155)]='';}async function _0x17f730(){const _0x4ab943=_0x419fa8,_0x3fcbe3=document[_0x4ab943(0x9c8)](_0x4ab943(0x122e)),_0x5bdd23=parseInt(_0x3fcbe3[_0x4ab943(0x1155)]);if(isNaN(_0x5bdd23))return;const _0x184a2f=await _0x2c5bcf[_0x4ab943(0xdc6)]['get'](_0x5bdd23);if(_0x184a2f&&_0x184a2f[_0x4ab943(0x1155)]){const _0xe1cfcb=_0x184a2f[_0x4ab943(0x1155)];Object['assign'](_0x9ebf46['globalSettings'],_0xe1cfcb),_0x5adfc0(_0xe1cfcb['theme']||'light'),await _0x2c5bcf['globalSettings'][_0x4ab943(0xff5)](_0x9ebf46[_0x4ab943(0x1383)]),_0x2a99db(),_0x58c61c(),_0x2ea916(),_0x3f12a7(),_0x2417f9(),_0x1960df(),_0xec3eb7(),alert(_0x4ab943(0x13a2)+_0x184a2f['name']+'”');}}async function _0x21d2c6(){const _0x916b1b=_0x419fa8,_0x4f52a6=await _0xadb5df(_0x916b1b(0xe83),_0x916b1b(0x1339));if(!_0x4f52a6||!_0x4f52a6[_0x916b1b(0x3f1)]())return;const _0x65101f={'wallpaper':_0x9ebf46[_0x916b1b(0x1383)][_0x916b1b(0x1254)],'cphoneWallpaper':_0x9ebf46[_0x916b1b(0x1383)][_0x916b1b(0xe0b)],'globalChatBackground':_0x9ebf46[_0x916b1b(0x1383)][_0x916b1b(0x73a)],'appIcons':_0x9ebf46[_0x916b1b(0x1383)][_0x916b1b(0x11b3)],'cphoneAppIcons':_0x9ebf46[_0x916b1b(0x1383)][_0x916b1b(0xe9b)],'chatActionButtonsOrder':_0x9ebf46[_0x916b1b(0x1383)][_0x916b1b(0x11cb)],'theme':localStorage[_0x916b1b(0x1290)](_0x916b1b(0x864))||_0x916b1b(0xfa2),'showStatusBar':_0x9ebf46['globalSettings'][_0x916b1b(0xb3b)],'notificationSoundUrl':_0x9ebf46[_0x916b1b(0x1383)][_0x916b1b(0xb7a)],'widgetData':_0x9ebf46[_0x916b1b(0x1383)][_0x916b1b(0xa5e)]},_0x506a1a=await _0x2c5bcf[_0x916b1b(0xdc6)][_0x916b1b(0xe78)]({'name':_0x4f52a6[_0x916b1b(0x3f1)](),'type':_0x916b1b(0xb09)})[_0x916b1b(0x476)]();if(_0x506a1a){const _0x1d2def=await _0x352ae9(_0x916b1b(0x1333),'名为\x20“'+_0x4f52a6[_0x916b1b(0x3f1)]()+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':'btn-danger'});if(!_0x1d2def)return;await _0x2c5bcf['appearancePresets'][_0x916b1b(0x13a4)](_0x506a1a['id'],{'value':_0x65101f});}else await _0x2c5bcf['appearancePresets'][_0x916b1b(0x68e)]({'name':_0x4f52a6[_0x916b1b(0x3f1)](),'type':'appearance','value':_0x65101f});await _0x407950(),alert(_0x916b1b(0x9a5));}async function _0x8b4ec4(){const _0x3cd85f=_0x419fa8,_0x4404b2=document[_0x3cd85f(0x9c8)](_0x3cd85f(0x122e)),_0x491267=parseInt(_0x4404b2[_0x3cd85f(0x1155)]);if(isNaN(_0x491267)){alert(_0x3cd85f(0x11fd));return;}const _0x19faa3=await _0x2c5bcf[_0x3cd85f(0xdc6)][_0x3cd85f(0xdf9)](_0x491267);if(!_0x19faa3)return;const _0x5065a6=await _0x352ae9(_0x3cd85f(0x2a9),_0x3cd85f(0x36c)+_0x19faa3[_0x3cd85f(0x609)]+_0x3cd85f(0x924),{'confirmButtonClass':'btn-danger'});_0x5065a6&&(await _0x2c5bcf[_0x3cd85f(0xdc6)][_0x3cd85f(0x6d2)](_0x491267),await _0x407950(),alert(_0x3cd85f(0xb74)));}async function _0xa82c6d(){const _0x137dfe=_0x419fa8,_0x7e98e4=document[_0x137dfe(0x9c8)](_0x137dfe(0xb91));_0x7e98e4[_0x137dfe(0x2f5)]=_0x137dfe(0xcbf);const _0x42b694=await _0x2c5bcf[_0x137dfe(0xdc6)][_0x137dfe(0xe78)]('type')['equals'](_0x137dfe(0x879))[_0x137dfe(0x5ff)]();_0x42b694[_0x137dfe(0x591)](_0x379ac3=>{const _0x3c92b1=_0x137dfe,_0x94ad23=document[_0x3c92b1(0x28a)](_0x3c92b1(0x12ef));_0x94ad23[_0x3c92b1(0x1155)]=_0x379ac3['id'],_0x94ad23[_0x3c92b1(0xe24)]=_0x379ac3[_0x3c92b1(0x609)],_0x7e98e4['appendChild'](_0x94ad23);});}async function _0x56df35(){const _0x1fcd69=_0x419fa8,_0x4a042a=document['getElementById'](_0x1fcd69(0xb91)),_0x4d3ae6=parseInt(_0x4a042a[_0x1fcd69(0x1155)]);if(isNaN(_0x4d3ae6))return;const _0x3aac84=await _0x2c5bcf['appearancePresets'][_0x1fcd69(0xdf9)](_0x4d3ae6);if(_0x3aac84){const _0x5aef38=_0x3aac84['value'][_0x1fcd69(0xa56)]||_0x1fcd69(0x108b),_0x26e77b=_0x3aac84[_0x1fcd69(0x1155)]['custom']||'',_0xdc028f=document[_0x1fcd69(0x91d)](_0x1fcd69(0x8a8)+_0x5aef38+'\x22]');_0xdc028f&&(_0xdc028f[_0x1fcd69(0x1ec)]=!![]);const _0x57603b=document['getElementById'](_0x1fcd69(0x1332));_0x57603b[_0x1fcd69(0x1155)]=_0x26e77b,_0x2c9d73();}}async function _0x49ad17(){const _0x2856eb=_0x419fa8,_0x305f64=await _0xadb5df(_0x2856eb(0xd6d),'请输入预设名称');if(!_0x305f64||!_0x305f64[_0x2856eb(0x3f1)]())return;const _0x27cf05=document[_0x2856eb(0x91d)](_0x2856eb(0x12ab)),_0x3c1a85=_0x27cf05?_0x27cf05[_0x2856eb(0x1155)]:_0x2856eb(0x108b),_0x122352=document['getElementById'](_0x2856eb(0x1332))[_0x2856eb(0x1155)][_0x2856eb(0x3f1)](),_0x4fd07e={'base':_0x3c1a85,'custom':_0x122352},_0x22c94f=await _0x2c5bcf[_0x2856eb(0xdc6)][_0x2856eb(0xe78)]({'name':_0x305f64['trim'](),'type':_0x2856eb(0x879)})[_0x2856eb(0x476)]();if(_0x22c94f){const _0x38998b=await _0x352ae9(_0x2856eb(0x1333),_0x2856eb(0xecc)+_0x305f64[_0x2856eb(0x3f1)]()+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':_0x2856eb(0x12bc)});if(!_0x38998b)return;await _0x2c5bcf[_0x2856eb(0xdc6)][_0x2856eb(0x13a4)](_0x22c94f['id'],{'value':_0x4fd07e});}else await _0x2c5bcf['appearancePresets'][_0x2856eb(0x68e)]({'name':_0x305f64[_0x2856eb(0x3f1)](),'type':_0x2856eb(0x879),'value':_0x4fd07e});await _0xa82c6d(),alert('主题预设已保存！');}async function _0x3ba351(){const _0x212ae8=_0x419fa8,_0x2cdfcc=document[_0x212ae8(0x9c8)](_0x212ae8(0xb91)),_0x27bd8e=parseInt(_0x2cdfcc['value']);if(isNaN(_0x27bd8e)){alert(_0x212ae8(0x11fd));return;}const _0x5df915=await _0x2c5bcf['appearancePresets'][_0x212ae8(0xdf9)](_0x27bd8e);if(!_0x5df915)return;const _0x3078f5=await _0x352ae9(_0x212ae8(0x2a9),'确定要删除预设\x20“'+_0x5df915[_0x212ae8(0x609)]+'”\x20吗？',{'confirmButtonClass':_0x212ae8(0x12bc)});_0x3078f5&&(await _0x2c5bcf[_0x212ae8(0xdc6)]['delete'](_0x27bd8e),await _0xa82c6d(),alert(_0x212ae8(0xb74)));}async function _0x499619(){const _0x215670=_0x419fa8;await _0x2df012(),document['getElementById'](_0x215670(0xc0d))['classList'][_0x215670(0x68e)]('visible');}async function _0x2df012(){const _0x1b8065=_0x419fa8,_0x2442c7=document[_0x1b8065(0x9c8)]('existing-sticker-categories-list'),_0x59af72=await _0x2c5bcf[_0x1b8065(0x1342)]['toArray']();_0x2442c7['innerHTML']='';if(_0x59af72[_0x1b8065(0xa06)]===0x0){_0x2442c7[_0x1b8065(0x2f5)]=_0x1b8065(0x814);return;}_0x59af72[_0x1b8065(0x591)](_0x24f9a5=>{const _0x10efc8=_0x1b8065,_0x416abb=document[_0x10efc8(0x28a)](_0x10efc8(0x11f4));_0x416abb[_0x10efc8(0x82c)]=_0x10efc8(0xf68),_0x416abb[_0x10efc8(0x2f5)]=_0x10efc8(0x75a)+_0x24f9a5[_0x10efc8(0x609)]+_0x10efc8(0x1d3)+_0x24f9a5['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2442c7[_0x10efc8(0x7b9)](_0x416abb);});}async function _0x33172f(){const _0x46be4f=_0x419fa8,_0xda28c4=document['getElementById']('new-sticker-category-name-input'),_0x2419a3=_0xda28c4[_0x46be4f(0x1155)]['trim']();if(!_0x2419a3){alert('分类名不能为空！');return;}const _0x2208fd=await _0x2c5bcf[_0x46be4f(0x1342)][_0x46be4f(0xe78)]('name')[_0x46be4f(0xda9)](_0x2419a3)[_0x46be4f(0x476)]();if(_0x2208fd){alert(_0x46be4f(0xdc9)+_0x2419a3+_0x46be4f(0x9bf));return;}await _0x2c5bcf['stickerCategories'][_0x46be4f(0x68e)]({'name':_0x2419a3}),_0xda28c4['value']='',await _0x2df012();}async function _0x4d76c7(_0x5d9ce9){const _0x2641bb=_0x419fa8,_0x5768b9=await _0x2c5bcf[_0x2641bb(0x1342)][_0x2641bb(0xdf9)](_0x5d9ce9);if(!_0x5768b9)return;const _0x176209=await _0x2c5bcf[_0x2641bb(0x774)]['where'](_0x2641bb(0x408))['equals'](_0x5d9ce9)[_0x2641bb(0x636)](),_0x51fd1b=_0x176209>0x0?_0x2641bb(0x25a)+_0x5768b9['name']+_0x2641bb(0x4b2)+_0x176209+_0x2641bb(0xf61):_0x2641bb(0x25a)+_0x5768b9['name']+_0x2641bb(0xf50),_0xb497d9=await _0x352ae9('确认删除分类',_0x51fd1b,{'confirmButtonClass':_0x2641bb(0x12bc)});if(_0xb497d9)try{await _0x2c5bcf[_0x2641bb(0xa88)]('rw',_0x2c5bcf[_0x2641bb(0x1342)],_0x2c5bcf['userStickers'],async()=>{const _0x638fc=_0x2641bb,_0x26e21e=await _0x2c5bcf[_0x638fc(0x774)][_0x638fc(0xe78)](_0x638fc(0x408))['equals'](_0x5d9ce9)['primaryKeys']();_0x26e21e[_0x638fc(0xa06)]>0x0&&await _0x2c5bcf['userStickers'][_0x638fc(0x256)](_0x26e21e),await _0x2c5bcf[_0x638fc(0x1342)][_0x638fc(0x6d2)](_0x5d9ce9);}),_0x9ebf46['userStickers']=await _0x2c5bcf['userStickers'][_0x2641bb(0x5ff)](),_0x55c803===_0x5d9ce9&&(_0x55c803=_0x2641bb(0xd0a)),await _0x2df012(),await _0x43920d(),alert('分类《'+_0x5768b9[_0x2641bb(0x609)]+_0x2641bb(0x64f));}catch(_0x547b8e){console[_0x2641bb(0x1221)](_0x2641bb(0x767),_0x547b8e),alert(_0x2641bb(0x10b3));}}function _0x462b69(_0x2ff388){const _0x2e1c88=_0x419fa8;_0x55c803=_0x2ff388,document[_0x2e1c88(0x7e4)](_0x2e1c88(0xaa3))[_0x2e1c88(0x591)](_0x221831=>{const _0x940bb2=_0x2e1c88;_0x221831['classList'][_0x940bb2(0x1c3)](_0x940bb2(0x113d),String(_0x221831[_0x940bb2(0xc9f)]['categoryId'])===String(_0x2ff388));}),_0x43920d(![]);const _0x24b69b=document['getElementById'](_0x2e1c88(0x10d6));if(_0x24b69b)_0x24b69b['checked']=![];}async function _0x11ca72(){const _0x298c35=_0x419fa8;if(!_0x9ebf46['activeChatId'])return;const _0x1f394a=_0x9ebf46['chats'][_0x9ebf46['activeChatId']];if(!_0x1f394a)return;try{const _0x3c47ca={'type':_0x298c35(0x454),'version':0x1,'chatData':_0x1f394a},_0x23aa29=new Blob([JSON[_0x298c35(0xf1e)](_0x3c47ca,null,0x2)],{'type':_0x298c35(0x698)}),_0x2bef15=URL[_0x298c35(0x5bb)](_0x23aa29),_0x2ce9fb=document[_0x298c35(0x28a)]('a');_0x2ce9fb[_0x298c35(0xc4a)]=_0x2bef15,_0x2ce9fb['download']=_0x298c35(0x86b)+_0x1f394a[_0x298c35(0x609)]+'-'+new Date()['toISOString']()[_0x298c35(0x6c6)]('T')[0x0]+'.json',_0x2ce9fb[_0x298c35(0xf5c)](),URL['revokeObjectURL'](_0x2bef15),await _0x1bff53('导出成功','与“'+_0x1f394a[_0x298c35(0x609)]+_0x298c35(0x91a));}catch(_0x510f94){console[_0x298c35(0x1221)](_0x298c35(0x1241),_0x510f94),await _0x1bff53(_0x298c35(0xcd1),_0x298c35(0x58c)+_0x510f94[_0x298c35(0x86e)]);}}async function _0x560706(_0x56f6de){const _0x465987=_0x419fa8;if(!_0x56f6de||!_0x9ebf46[_0x465987(0x970)])return;const _0x2abb73=_0x9ebf46[_0x465987(0x970)],_0x4f9262=_0x9ebf46[_0x465987(0x547)][_0x2abb73];try{const _0x915f3c=await _0x56f6de[_0x465987(0xbb7)](),_0x361a44=JSON['parse'](_0x915f3c);if(_0x361a44['type']!==_0x465987(0x454)||!_0x361a44[_0x465987(0x3b9)])throw new Error(_0x465987(0x8a5));const _0x10145e=await _0x352ae9(_0x465987(0x3ec),_0x465987(0x9e7)+_0x4f9262[_0x465987(0x609)]+_0x465987(0x4f3),{'confirmButtonClass':'btn-danger','confirmText':'确认覆盖'});if(!_0x10145e)return;const _0x49fc31=_0x361a44['chatData'];_0x49fc31['id']=_0x2abb73,await _0x2c5bcf[_0x465987(0x547)][_0x465987(0xff5)](_0x49fc31),_0x9ebf46[_0x465987(0x547)][_0x2abb73]=_0x49fc31,await _0x1bff53(_0x465987(0x135e),_0x465987(0x12df)),_0x1a44b1(_0x2abb73),_0x394b2c(),document[_0x465987(0x9c8)](_0x465987(0xb86))['click']();}catch(_0xa0866b){console[_0x465987(0x1221)](_0x465987(0xe85),_0xa0866b),await _0x1bff53(_0x465987(0x685),_0x465987(0x3a2)+_0xa0866b[_0x465987(0x86e)]);}}function _0x541ea4(){const _0x51134e=_0x419fa8;_0x373d30(),_0xe5834e(_0x51134e(0xb90));}function _0x373d30(){const _0x1aa1fc=_0x419fa8,_0x57557f=document[_0x1aa1fc(0x9c8)](_0x1aa1fc(0x611));_0x57557f[_0x1aa1fc(0x2f5)]='';const _0x9bcdc1=Object[_0x1aa1fc(0xeb2)](_0x9ebf46[_0x1aa1fc(0x547)])[_0x1aa1fc(0x401)](_0x2a7b5f=>!_0x2a7b5f[_0x1aa1fc(0x11e4)]);if(_0x9bcdc1[_0x1aa1fc(0xa06)]===0x0){_0x57557f['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>';return;}_0x9bcdc1[_0x1aa1fc(0x591)](_0x48ec45=>{const _0x1e40d5=_0x1aa1fc,_0x76945=document['createElement'](_0x1e40d5(0x11f4));_0x76945['className']=_0x1e40d5(0x992),_0x76945[_0x1e40d5(0x2f5)]=_0x1e40d5(0xc78)+(_0x48ec45['settings'][_0x1e40d5(0xd4d)]||_0x246753)+_0x1e40d5(0x131a)+_0x48ec45[_0x1e40d5(0x609)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x76945[_0x1e40d5(0xa0f)](_0x1e40d5(0xf5c),()=>_0x4de4ed(_0x48ec45['id'])),_0x57557f[_0x1e40d5(0x7b9)](_0x76945);});}async function _0x4de4ed(_0x1e70e9){const _0x125944=_0x419fa8;_0x141b83=_0x1e70e9,console[_0x125944(0x283)](_0x125944(0x589)+_0x1e70e9+_0x125944(0x11b4)),_0x58c61c(),_0x3f12a7(),_0x179970(),_0xe5834e(_0x125944(0x3ed));}function _0x4dc5ba(){const _0xaf538e=_0x419fa8;_0x141b83=null,console[_0xaf538e(0x283)](_0xaf538e(0x1246)),_0xe5834e(_0xaf538e(0x327));}function _0x179970(){const _0x3bd2ae=_0x419fa8,_0x33aa08=new Date(),_0x418875=_0x33aa08['toLocaleTimeString']('zh-CN',{'hour':_0x3bd2ae(0x691),'minute':_0x3bd2ae(0x691)}),_0xa4175c=_0x33aa08['toLocaleDateString'](_0x3bd2ae(0x101b),{'weekday':_0x3bd2ae(0xd72),'month':'long','day':'numeric'});document['getElementById'](_0x3bd2ae(0xc21))[_0x3bd2ae(0xe24)]=_0x418875,document['getElementById'](_0x3bd2ae(0x877))[_0x3bd2ae(0xe24)]=_0xa4175c,_0x5bb1f1(_0x3bd2ae(0x1039));}function _0x5bb1f1(_0x1ee896){const _0x39a417=_0x419fa8;document['querySelectorAll'](_0x39a417(0x9b0))[_0x39a417(0x591)](_0x585093=>_0x585093[_0x39a417(0x575)][_0x39a417(0x30f)]('active')),document[_0x39a417(0x9c8)](_0x1ee896)[_0x39a417(0x575)][_0x39a417(0x68e)](_0x39a417(0x113d));}window['switchToCharScreen']=_0x5bb1f1;async function _0x188817(_0x136c28){const _0x59fa8a=_0x419fa8;if(!_0x141b83)return;const _0x2f71a8=_0x9ebf46[_0x59fa8a(0x547)][_0x141b83];await _0x22cf0b(_0x141b83,_0x136c28);switch(_0x136c28){case'qq':_0x267084(),_0x5bb1f1('char-qq-screen');break;case _0x59fa8a(0x126f):_0x3eea82(),_0x5bb1f1(_0x59fa8a(0xb57));break;case'browser':_0x34c684(),_0x5bb1f1(_0x59fa8a(0xbb0));break;case _0x59fa8a(0xd99):_0x2f0b87(),_0x5bb1f1(_0x59fa8a(0x9c2));break;case _0x59fa8a(0xe2a):_0x70d2be(),_0x5bb1f1(_0x59fa8a(0x2ae));break;case'diary':_0x8560c5(),_0x5bb1f1(_0x59fa8a(0x38f));break;case _0x59fa8a(0xa58):_0x4cf63d(),_0x5bb1f1(_0x59fa8a(0x80b));break;case'music':_0xdb04eb(),_0x5bb1f1(_0x59fa8a(0x499));break;case _0x59fa8a(0x109b):_0x4f3eed(),_0x5bb1f1(_0x59fa8a(0xde8));break;}}async function _0x3eea82(){const _0xa1a93a=_0x419fa8,_0x5f2fb4=document[_0xa1a93a(0x9c8)](_0xa1a93a(0xe17));_0x5f2fb4[_0xa1a93a(0x2f5)]='';if(!_0x141b83)return;const _0x3f37ae=_0x9ebf46['chats'][_0x141b83],_0x304db6=_0x3f37ae[_0xa1a93a(0x343)]||[];if(_0x304db6[_0xa1a93a(0xa06)]===0x0){_0x5f2fb4['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>';return;}const _0x13df3b='https://i.postimg.cc/KYr2qRCK/1.jpg';_0x304db6[_0xa1a93a(0x591)](_0x510037=>{const _0x48da08=_0xa1a93a,_0x57feeb=document['createElement'](_0x48da08(0x11f4));_0x57feeb['className']=_0x48da08(0x87b),_0x57feeb[_0x48da08(0xc9f)][_0x48da08(0x1387)]=_0x510037['description'],_0x5f2fb4['appendChild'](_0x57feeb);if(_0x9ebf46[_0x48da08(0x1383)][_0x48da08(0x443)]){_0x57feeb[_0x48da08(0x5e1)][_0x48da08(0x8e2)]=_0x48da08(0x744);const _0x5294ec=/[^\x00-\x7F]/[_0x48da08(0x4e8)](_0x510037[_0x48da08(0xd73)]),_0x23ffbd=_0x510037['image_prompt']&&_0x510037['image_prompt'][_0x48da08(0x3f1)]()&&!_0x5294ec,_0x27c4ec=_0x23ffbd?_0x510037['image_prompt']:'a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting',_0x5a2cd3=_0x48da08(0x12d5)+encodeURIComponent(_0x27c4ec),_0x507d5b=new Image();_0x507d5b['onload']=function(){const _0x1ed8c5=_0x48da08;_0x57feeb[_0x1ed8c5(0x5e1)][_0x1ed8c5(0x11d9)]=_0x1ed8c5(0x7fe)+this[_0x1ed8c5(0xbf4)]+')';},_0x507d5b[_0x48da08(0x11e5)]=function(){const _0x55b3e5=_0x48da08;_0x57feeb[_0x55b3e5(0x5e1)][_0x55b3e5(0x11d9)]=_0x55b3e5(0x7fe)+_0x13df3b+')';},_0x507d5b[_0x48da08(0xbf4)]=_0x5a2cd3;}else{_0x57feeb[_0x48da08(0x5e1)][_0x48da08(0x8e2)]=_0x48da08(0xbea),_0x57feeb[_0x48da08(0x5e1)][_0x48da08(0xbf0)]='1px\x20solid\x20#e0e0e0';const _0x355a2e=document[_0x48da08(0x28a)]('p');_0x355a2e[_0x48da08(0x82c)]=_0x48da08(0x26b),_0x355a2e[_0x48da08(0xe24)]=_0x510037['description']||_0x48da08(0xa8e),_0x57feeb[_0x48da08(0x7b9)](_0x355a2e);}});}function _0x34c684(){const _0x5572ae=_0x419fa8,_0x13d67f=document['getElementById']('char-browser-history');_0x13d67f[_0x5572ae(0x2f5)]='';if(!_0x141b83)return;const _0x2a8130=_0x9ebf46[_0x5572ae(0x547)][_0x141b83],_0x27b32e=[_0x2a8130[_0x5572ae(0x609)],'爱好','旅游','美食','新闻',..._0x2a8130[_0x5572ae(0x1131)]['aiPersona'][_0x5572ae(0x6c6)](/，|。|\s/)['slice'](0x0,0x5)],_0x33df41=['知乎',_0x5572ae(0x1136),_0x5572ae(0xdd6),'微博',_0x5572ae(0x2f1)];for(let _0x4b6db2=0x0;_0x4b6db2<0xf;_0x4b6db2++){const _0x1698ed=_0x27b32e[Math[_0x5572ae(0x5fb)](Math[_0x5572ae(0x360)]()*_0x27b32e[_0x5572ae(0xa06)])],_0x372925=_0x33df41[Math[_0x5572ae(0x5fb)](Math[_0x5572ae(0x360)]()*_0x33df41[_0x5572ae(0xa06)])],_0x21d50a=document[_0x5572ae(0x28a)](_0x5572ae(0x11f4));_0x21d50a['className']='char-browser-item',_0x21d50a[_0x5572ae(0x2f5)]=_0x5572ae(0xd85)+_0x1698ed+_0x5572ae(0x23e)+_0x372925+_0x5572ae(0x11d6)+_0x372925['toLowerCase']()+_0x5572ae(0xedf)+_0x1698ed+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x13d67f[_0x5572ae(0x7b9)](_0x21d50a);}}function _0x2f0b87(){const _0x3cab25=_0x419fa8,_0x4d6336=document[_0x3cab25(0x9c8)](_0x3cab25(0x85f));_0x4d6336['innerHTML']='';if(!_0x141b83)return;const _0x43cf8d=_0x9ebf46[_0x3cab25(0x547)][_0x141b83],_0x19f36e=_0x43cf8d[_0x3cab25(0xdb4)]?.[_0x3cab25(0x1031)]||[];if(_0x19f36e[_0x3cab25(0xa06)]===0x0){_0x4d6336[_0x3cab25(0x2f5)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>';return;}_0x19f36e[_0x3cab25(0x591)](_0x4f2887=>{const _0x4bf385=_0x3cab25,_0x4b968c=document[_0x4bf385(0x28a)](_0x4bf385(0x11f4));_0x4b968c[_0x4bf385(0x82c)]=_0x4bf385(0x28c),_0x4b968c[_0x4bf385(0xc9f)][_0x4bf385(0x616)]=_0x4f2887['reason'];let _0x4763f5;if(_0x9ebf46[_0x4bf385(0x1383)][_0x4bf385(0x443)]){const _0x41728f=_0x4bf385(0x12d5)+encodeURIComponent(_0x4f2887[_0x4bf385(0xd73)]||'a\x20random\x20product');_0x4763f5=_0x4bf385(0x12ac)+_0x41728f+'\x22\x20class=\x22product-image\x22>';}else _0x4763f5=_0x4bf385(0x9c0)+(_0x4f2887[_0x4bf385(0x616)]||'(无购买理由)')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x4b968c[_0x4bf385(0x2f5)]=_0x4bf385(0x983)+_0x4763f5+_0x4bf385(0x1006)+_0x4f2887['itemName']+_0x4bf385(0x49d)+(_0x4f2887[_0x4bf385(0x3fa)]||0x0)['toFixed'](0x2)+_0x4bf385(0x2b6)+_0x4f2887[_0x4bf385(0xebd)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4d6336[_0x4bf385(0x7b9)](_0x4b968c);});}function _0x13338d(){const _0x3c139b=_0x419fa8;_0x5bb1f1(_0x3c139b(0x1039));}function _0x151b97(){const _0x53c01a=_0x419fa8,_0x2aeb74=document['getElementById'](_0x53c01a(0x6ae));_0x2aeb74['innerHTML']='';if(!_0x141b83)return;const _0x2b7fef=Object[_0x53c01a(0xeb2)](_0x9ebf46['chats'])[_0x53c01a(0x401)](_0x4fd458=>{const _0x23d4b0=_0x53c01a;if(_0x4fd458['id']===_0x141b83)return!![];if(_0x4fd458[_0x23d4b0(0x11e4)]&&_0x4fd458[_0x23d4b0(0xd3e)]['some'](_0x2494d3=>_0x2494d3['id']===_0x141b83))return!![];return![];});_0x2b7fef[_0x53c01a(0x591)](_0x13bc29=>{const _0x346114=_0x53c01a,_0x24c9e6=_0x15f1c0(_0x13bc29);_0x2aeb74[_0x346114(0x7b9)](_0x24c9e6);});}async function _0x22cf0b(_0x38b376,_0x595b48){const _0x438309=_0x419fa8,_0x3924f6=_0x9ebf46[_0x438309(0x547)][_0x38b376];if(!_0x3924f6)return;!_0x3924f6['appUsageLog']&&(_0x3924f6['appUsageLog']=[]),_0x3924f6[_0x438309(0x5c5)][_0x438309(0x668)]({'appName':_0x595b48,'timestamp':Date['now']()}),_0x3924f6[_0x438309(0x5c5)][_0x438309(0xa06)]>0x32&&_0x3924f6[_0x438309(0x5c5)][_0x438309(0xd6e)](),await _0x2c5bcf[_0x438309(0x547)]['put'](_0x3924f6);}function _0x4f3eed(){const _0x767082=_0x419fa8,_0x23d666=document[_0x767082(0x9c8)](_0x767082(0xacc));_0x23d666['innerHTML']='';const _0x32cb90=_0x9ebf46[_0x767082(0x547)][_0x141b83],_0x8feeeb=(_0x32cb90[_0x767082(0x5c5)]||[])['slice']()[_0x767082(0x101e)]();if(_0x8feeeb[_0x767082(0xa06)]===0x0){_0x23d666[_0x767082(0x2f5)]=_0x767082(0x1348);return;}const _0x5d3acd={'qq':'QQ','album':'相册','browser':_0x767082(0x58d),'taobao':'淘宝','memo':_0x767082(0xdbb),'diary':'日记','amap':_0x767082(0x2b1),'usage':_0x767082(0xee6)};_0x8feeeb['forEach'](_0x3d87e3=>{const _0x49cd76=_0x767082,_0x338a2b=document[_0x49cd76(0x28a)](_0x49cd76(0x11f4));_0x338a2b[_0x49cd76(0x82c)]=_0x49cd76(0x1303),_0x338a2b['innerHTML']=_0x49cd76(0x4ae)+new Date(_0x3d87e3[_0x49cd76(0x6b5)])['toLocaleString']()+_0x49cd76(0x5e4)+(_0x5d3acd[_0x3d87e3[_0x49cd76(0x2d0)]]||_0x3d87e3[_0x49cd76(0x2d0)])+_0x49cd76(0x629),_0x23d666[_0x49cd76(0x7b9)](_0x338a2b);});}async function _0x2b7116(_0x78fd5f){const _0x39eca2=_0x419fa8,_0x4443e3=_0x9ebf46['chats'][_0x141b83];if(!_0x4443e3)return;const _0x487747={'role':_0x39eca2(0x1a7),'senderName':_0x4443e3[_0x39eca2(0x1071)],'type':_0x39eca2(0x358),'content':_0x78fd5f,'imageUrl':'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','timestamp':Date['now']()};_0x4443e3[_0x39eca2(0x8b3)][_0x39eca2(0x668)](_0x487747),await _0x2c5bcf[_0x39eca2(0x547)]['put'](_0x4443e3),_0x9ebf46['activeChatId']===_0x141b83&&_0xc4e879(_0x487747,_0x4443e3),await _0x1bff53(_0x39eca2(0x937),'“'+_0x4443e3['name']+_0x39eca2(0x13bb));}async function _0x2f3572(_0x405cab){const _0x2e35a6=_0x419fa8,_0x33fba7=_0x9ebf46[_0x2e35a6(0x547)][_0x141b83];if(!_0x33fba7||!_0x33fba7[_0x2e35a6(0x6e9)])return;const _0x5e1036=_0x33fba7[_0x2e35a6(0x6e9)][_0x2e35a6(0xfc3)](_0x79e92d=>_0x79e92d['id']===_0x405cab);if(_0x5e1036){_0xb8e4f0=_0x5e1036;const _0x967069=document[_0x2e35a6(0x9c8)]('char-memo-detail-title'),_0x5d28a6=document[_0x2e35a6(0x9c8)](_0x2e35a6(0x798)),_0x54ec11=document[_0x2e35a6(0x9c8)](_0x2e35a6(0x77a));if(_0x967069)_0x967069['textContent']=_0x5e1036[_0x2e35a6(0x9f2)];if(_0x5d28a6)_0x5d28a6[_0x2e35a6(0x1155)]=_0x5e1036[_0x2e35a6(0x53b)];const _0x22a789=await _0x2c5bcf[_0x2e35a6(0xc09)]['where']({'type':'char_memo','content.id':_0x405cab})[_0x2e35a6(0x476)]();_0x54ec11[_0x2e35a6(0x575)][_0x2e35a6(0x1c3)](_0x2e35a6(0x113d),!!_0x22a789),_0x5bb1f1('char-memo-detail-screen');}}function _0x70d2be(){const _0x346ac6=_0x419fa8,_0x49ad8a=document['getElementById'](_0x346ac6(0x10f5));_0x49ad8a[_0x346ac6(0x2f5)]='';const _0xc7c82f=_0x9ebf46[_0x346ac6(0x547)][_0x141b83],_0xf155b3=(_0xc7c82f['memos']||[])[_0x346ac6(0x1044)]()['reverse']();if(_0xf155b3[_0x346ac6(0xa06)]===0x0){_0x49ad8a['innerHTML']=_0x346ac6(0x1ea);return;}_0xf155b3['forEach'](_0x39aac6=>{const _0x3aeae8=_0x346ac6,_0x25879e=document[_0x3aeae8(0x28a)]('div');_0x25879e[_0x3aeae8(0x82c)]=_0x3aeae8(0xdc4),_0x25879e[_0x3aeae8(0x2f5)]=_0x3aeae8(0x309)+_0x39aac6[_0x3aeae8(0x9f2)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>'+(_0x39aac6['content']||'')[_0x3aeae8(0x6c6)]('\x0a')[0x0]+_0x3aeae8(0xa43),_0x25879e[_0x3aeae8(0xa0f)](_0x3aeae8(0xf5c),()=>_0x2f3572(_0x39aac6['id'])),_0x43a60a(_0x25879e,()=>deleteMemo(_0x39aac6['id'])),_0x49ad8a[_0x3aeae8(0x7b9)](_0x25879e);});}async function _0x2e3e51(_0x50510e=null){const _0x3bd2e2=_0x419fa8;_0xde3ba7=null;const _0x6a5e53=await _0xadb5df(_0x3bd2e2(0xcb6),_0x3bd2e2(0x9de));if(_0x6a5e53===null||!_0x6a5e53[_0x3bd2e2(0x3f1)]())return;const _0x1293d1=await _0xadb5df(_0x3bd2e2(0xf12)+_0x6a5e53,_0x3bd2e2(0xa97),'',_0x3bd2e2(0x11f9));_0x1293d1!==null&&(await _0x515f29({'title':_0x6a5e53[_0x3bd2e2(0x3f1)](),'content':_0x1293d1}),_0x5bb1f1('char-memo-screen'));}async function _0x515f29(_0x41f7d8){const _0x3c7e03=_0x419fa8,_0x5e79b4=_0x9ebf46['chats'][_0x141b83];if(!_0x5e79b4['memos'])_0x5e79b4[_0x3c7e03(0x6e9)]=[];_0x5e79b4[_0x3c7e03(0x6e9)][_0x3c7e03(0x668)]({'id':Date[_0x3c7e03(0x9b7)](),'title':_0x41f7d8[_0x3c7e03(0x9f2)],'content':_0x41f7d8[_0x3c7e03(0x53b)]}),await _0x2c5bcf['chats'][_0x3c7e03(0xff5)](_0x5e79b4),_0x70d2be();}async function _0x515f29(_0x37c2af){const _0x467b03=_0x419fa8,_0x10454e=_0x9ebf46[_0x467b03(0x547)][_0x141b83];if(!_0x10454e['memos'])_0x10454e[_0x467b03(0x6e9)]=[];if(_0xde3ba7){const _0x3c4500=_0x10454e[_0x467b03(0x6e9)][_0x467b03(0xfc3)](_0x362742=>_0x362742['id']===_0xde3ba7);if(_0x3c4500)_0x3c4500[_0x467b03(0x53b)]=_0x37c2af;}else _0x10454e['memos'][_0x467b03(0x668)]({'id':Date[_0x467b03(0x9b7)](),'content':_0x37c2af});await _0x2c5bcf['chats'][_0x467b03(0xff5)](_0x10454e),_0x70d2be(),_0xde3ba7=null;}async function _0x1c9ef8(){const _0x23a774=_0x419fa8;if(!_0x141b83)return;const _0x571fdc=_0x9ebf46[_0x23a774(0x547)][_0x141b83];if(!_0x571fdc)return;await _0x1bff53(_0x23a774(0x7a4),_0x23a774(0xd33)+_0x571fdc[_0x23a774(0x609)]+_0x23a774(0x8f4));const {proxyUrl:_0x280b17,apiKey:_0xf317eb,model:_0x5cbff0}=_0x9ebf46[_0x23a774(0x4de)];if(!_0x280b17||!_0xf317eb||!_0x5cbff0){alert(_0x23a774(0xf3c));return;}const _0x237352=_0x9ebf46[_0x23a774(0x32c)]['nickname']===_0x23a774(0x5c1)||!_0x9ebf46[_0x23a774(0x32c)]['nickname']?'用户':_0x9ebf46[_0x23a774(0x32c)][_0x23a774(0x5b7)],_0xdf3204=_0x571fdc[_0x23a774(0x323)]&&_0x571fdc[_0x23a774(0x323)][_0x23a774(0xa06)]>0x0?_0x571fdc[_0x23a774(0x323)][_0x23a774(0xa3b)](_0x3cf1c0=>_0x23a774(0x1dc)+_0x4fcd92(_0x3cf1c0[_0x23a774(0x6b5)])+')\x20'+_0x3cf1c0[_0x23a774(0x53b)])['join']('\x0a'):'无',_0x373fb9=_0x571fdc[_0x23a774(0x1131)][_0x23a774(0x132a)]||0xa,_0x4b99e2=_0x571fdc['history'][_0x23a774(0x1044)](-_0x373fb9)[_0x23a774(0xa3b)](_0x11d8df=>(_0x11d8df['role']===_0x23a774(0x586)?_0x237352:_0x571fdc[_0x23a774(0x609)])+':\x20'+String(_0x11d8df[_0x23a774(0x53b)])[_0x23a774(0xc34)](0x0,0x1e)+'...')[_0x23a774(0x809)]('\x0a'),_0x40942c=(_0x571fdc[_0x23a774(0x1131)][_0x23a774(0x41a)]||[])[_0x23a774(0xa3b)](_0xb65c78=>_0x9ebf46[_0x23a774(0x1369)]['find'](_0x388765=>_0x388765['id']===_0xb65c78))[_0x23a774(0x401)](Boolean)[_0x23a774(0xa3b)](_0x1df60c=>_0x23a774(0xb37)+_0x1df60c[_0x23a774(0x609)]+_0x23a774(0x2a4)+_0x1df60c[_0x23a774(0x53b)][_0x23a774(0x401)](_0x4a6b76=>_0x4a6b76[_0x23a774(0x38a)])['map'](_0x19a785=>'-\x20'+_0x19a785['content'])[_0x23a774(0x809)]('\x0a'))[_0x23a774(0x809)](''),_0x50220e=_0xbdd100(_0x571fdc,0x3,'hours'),_0x166b20=_0xbdd100(_0x571fdc,0x6,_0x23a774(0x658)),_0x227f41=_0xbdd100(_0x571fdc,0x9,'hours'),_0x2fe3a0=_0xbdd100(_0x571fdc,0x1,_0x23a774(0x929)),_0x107365=_0xbdd100(_0x571fdc,0x3,_0x23a774(0x929)),_0x407cc3=_0xbdd100(_0x571fdc,0x7,_0x23a774(0x929));let _0x3c55c2='';if(_0x50220e||_0x166b20||_0x227f41||_0x2fe3a0||_0x107365||_0x407cc3){_0x3c55c2+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x50220e)_0x3c55c2+=_0x50220e;if(_0x166b20)_0x3c55c2+=_0x166b20;if(_0x227f41)_0x3c55c2+=_0x227f41;if(_0x50220e||_0x166b20||_0x227f41)_0x3c55c2+='\x0a';if(_0x2fe3a0)_0x3c55c2+=_0x2fe3a0;if(_0x107365)_0x3c55c2+=_0x107365;if(_0x407cc3)_0x3c55c2+=_0x407cc3;}const _0x3b29ce='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“'+_0x571fdc[_0x23a774(0x609)]+_0x23a774(0x736)+new Date()['toLocaleDateString'](_0x23a774(0x101b))+_0x23a774(0x7c3)+_0x237352+_0x23a774(0x265)+_0x571fdc['settings'][_0x23a774(0xae3)]+_0x23a774(0xc5c)+_0xdf3204+'\x0a'+_0x40942c+'\x0a'+_0x3c55c2+_0x23a774(0x211)+_0x237352+_0x23a774(0xa83)+_0x4b99e2+'\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。';try{const _0x4021e4=[{'role':'user','content':_0x23a774(0xf51)}];let _0x3c9f31=_0x280b17[_0x23a774(0x930)](_0x23a774(0xb23)),_0x323afd=_0x2e5c04(_0x5cbff0,_0xf317eb,_0x3b29ce,_0x4021e4);const _0x42d6b9=_0x3c9f31?await fetch(_0x323afd[_0x23a774(0x11be)],_0x323afd[_0x23a774(0x100d)]):await fetch(_0x280b17+'/v1/chat/completions',{'method':_0x23a774(0x116f),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0xf317eb},'body':JSON[_0x23a774(0xf1e)]({'model':_0x5cbff0,'messages':[{'role':_0x23a774(0xb64),'content':_0x3b29ce},..._0x4021e4],'temperature':_0x9ebf46[_0x23a774(0x1383)][_0x23a774(0xc3d)]||0.95})});if(!_0x42d6b9['ok'])throw new Error('API\x20错误:\x20'+_0x42d6b9[_0x23a774(0x399)]);const _0x1e6e44=await _0x42d6b9[_0x23a774(0x5dd)](),_0x1be8b7=getGeminiResponseText(_0x1e6e44),_0x4130d5=_0x1be8b7[_0x23a774(0x12c2)](/(\[[\s\S]*\])/);if(!_0x4130d5||!_0x4130d5[0x0])throw new Error(_0x23a774(0x9c5)+_0x1be8b7);const _0x33fd27=_0x4130d5[0x0];let _0x31ce9e;try{_0x31ce9e=JSON[_0x23a774(0x907)](_0x33fd27);}catch(_0x483b66){throw new Error('解析AI返回的JSON时出错:\x20'+_0x483b66[_0x23a774(0x86e)]+_0x23a774(0xa48)+_0x1be8b7);}_0x571fdc[_0x23a774(0x2b7)]=_0x31ce9e['map'](_0x5b183c=>({'id':Date['now']()+Math['random'](),'title':_0x5b183c[_0x23a774(0x9f2)],'content':_0x5b183c[_0x23a774(0x53b)],'timestamp':Date[_0x23a774(0x9b7)]()})),await _0x2c5bcf[_0x23a774(0x547)][_0x23a774(0xff5)](_0x571fdc),await _0x8560c5();}catch(_0x321d65){console['error'](_0x23a774(0xdf1),_0x321d65),await _0x1bff53('生成失败',_0x23a774(0xbe6)+_0x321d65[_0x23a774(0x86e)]);}}async function _0x56a272(){const _0x12dfe7=_0x419fa8;if(!_0x141b83)return;const _0x39389a=_0x9ebf46[_0x12dfe7(0x547)][_0x141b83];if(!_0x39389a)return;await _0x1bff53(_0x12dfe7(0x7a4),'正在请求“'+_0x39389a['name']+_0x12dfe7(0x2d6));const {proxyUrl:_0x6d390d,apiKey:_0x56e4d8,model:_0x4436e3}=_0x9ebf46[_0x12dfe7(0x4de)];if(!_0x6d390d||!_0x56e4d8||!_0x4436e3)return;const _0x40ba89=_0x9ebf46[_0x12dfe7(0x32c)][_0x12dfe7(0x5b7)]==='{{user}}'||!_0x9ebf46[_0x12dfe7(0x32c)]['nickname']?'用户':_0x9ebf46['qzoneSettings'][_0x12dfe7(0x5b7)],_0x3ea7eb=_0x39389a[_0x12dfe7(0x323)]&&_0x39389a[_0x12dfe7(0x323)][_0x12dfe7(0xa06)]>0x0?_0x39389a[_0x12dfe7(0x323)][_0x12dfe7(0xa3b)](_0x5173b2=>_0x12dfe7(0x1dc)+_0x4fcd92(_0x5173b2['timestamp'])+')\x20'+_0x5173b2['content'])[_0x12dfe7(0x809)]('\x0a'):'无',_0x370593=_0x39389a['settings'][_0x12dfe7(0x132a)]||0xa,_0x3fdfb6=_0x39389a['history'][_0x12dfe7(0x1044)](-_0x370593)[_0x12dfe7(0xa3b)](_0x146bcb=>(_0x146bcb[_0x12dfe7(0x7fd)]===_0x12dfe7(0x586)?_0x40ba89:_0x39389a[_0x12dfe7(0x609)])+':\x20'+String(_0x146bcb['content'])[_0x12dfe7(0xc34)](0x0,0x1e)+_0x12dfe7(0xf66))[_0x12dfe7(0x809)]('\x0a'),_0x2a6a2b=(_0x39389a[_0x12dfe7(0x1131)][_0x12dfe7(0x41a)]||[])['map'](_0x5dfa91=>_0x9ebf46[_0x12dfe7(0x1369)][_0x12dfe7(0xfc3)](_0x5da15f=>_0x5da15f['id']===_0x5dfa91))[_0x12dfe7(0x401)](Boolean)['map'](_0x43cba7=>_0x12dfe7(0xb37)+_0x43cba7[_0x12dfe7(0x609)]+'》设定:\x0a'+_0x43cba7[_0x12dfe7(0x53b)]['filter'](_0x500c39=>_0x500c39[_0x12dfe7(0x38a)])['map'](_0x595da8=>'-\x20'+_0x595da8[_0x12dfe7(0x53b)])[_0x12dfe7(0x809)]('\x0a'))[_0x12dfe7(0x809)](''),_0x5ebee2=_0x12dfe7(0x21f)+_0x39389a['name']+_0x12dfe7(0x43f)+new Date()[_0x12dfe7(0xd23)](_0x12dfe7(0x101b))+_0x12dfe7(0x1379)+_0x39389a[_0x12dfe7(0x1131)][_0x12dfe7(0xae3)]+_0x12dfe7(0xc5c)+_0x3ea7eb+'\x0a'+_0x2a6a2b+_0x12dfe7(0xf19)+_0x40ba89+_0x12dfe7(0xa83)+_0x3fdfb6+'\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。';try{const _0x3a73d7=[{'role':_0x12dfe7(0x586),'content':'请根据你的设定，写一篇新日记。'}];let _0x554686=_0x6d390d['includes'](_0x12dfe7(0xb23)),_0x1f1fe9=_0x2e5c04(_0x4436e3,_0x56e4d8,_0x5ebee2,_0x3a73d7);const _0x1036ae=_0x554686?await fetch(_0x1f1fe9[_0x12dfe7(0x11be)],_0x1f1fe9[_0x12dfe7(0x100d)]):await fetch(_0x6d390d+_0x12dfe7(0x1090),{'method':_0x12dfe7(0x116f),'headers':{'Content-Type':'application/json','Authorization':_0x12dfe7(0x84a)+_0x56e4d8},'body':JSON[_0x12dfe7(0xf1e)]({'model':_0x4436e3,'messages':[{'role':'system','content':_0x5ebee2},..._0x3a73d7],'temperature':_0x9ebf46[_0x12dfe7(0x1383)][_0x12dfe7(0xc3d)]||0.95})});if(!_0x1036ae['ok'])throw new Error(_0x12dfe7(0x8ab)+_0x1036ae[_0x12dfe7(0x399)]);const _0x575e91=await _0x1036ae[_0x12dfe7(0x5dd)](),_0x27028f=getGeminiResponseText(_0x575e91),_0x83d822=_0x27028f[_0x12dfe7(0x12c2)](/(\[[\s\S]*\])/);if(!_0x83d822||!_0x83d822[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x27028f);const _0x430691=_0x83d822[0x0];let _0xa57df7;try{_0xa57df7=JSON[_0x12dfe7(0x907)](_0x430691)[0x0];}catch(_0x48c3be){throw new Error(_0x12dfe7(0x1093)+_0x48c3be[_0x12dfe7(0x86e)]+_0x12dfe7(0xa48)+_0x27028f);}if(!_0x39389a[_0x12dfe7(0x2b7)])_0x39389a[_0x12dfe7(0x2b7)]=[];_0x39389a[_0x12dfe7(0x2b7)][_0x12dfe7(0x668)]({'id':Date['now'](),'title':_0xa57df7[_0x12dfe7(0x9f2)],'content':_0xa57df7[_0x12dfe7(0x53b)],'timestamp':Date[_0x12dfe7(0x9b7)]()}),await _0x2c5bcf[_0x12dfe7(0x547)]['put'](_0x39389a),await _0x8560c5();}catch(_0x2d9a3f){console[_0x12dfe7(0x1221)]('生成新日记失败:',_0x2d9a3f),await _0x1bff53(_0x12dfe7(0xf8d),_0x12dfe7(0x320)+_0x2d9a3f[_0x12dfe7(0x86e)]);}}function _0x8560c5(){const _0xc70425=_0x419fa8,_0xe9f8e8=document[_0xc70425(0x9c8)](_0xc70425(0x5d0));_0xe9f8e8['innerHTML']='';const _0x2fe278=_0x9ebf46[_0xc70425(0x547)][_0x141b83],_0x277930=(_0x2fe278['diary']||[])['slice']()[_0xc70425(0x101e)]();if(_0x277930[_0xc70425(0xa06)]===0x0){_0xe9f8e8[_0xc70425(0x2f5)]=_0xc70425(0x274);return;}_0x277930['forEach'](_0x3950d9=>{const _0x217965=_0xc70425,_0x19d2bb=document[_0x217965(0x28a)](_0x217965(0x11f4));_0x19d2bb[_0x217965(0x82c)]=_0x217965(0xdc4),_0x19d2bb[_0x217965(0x2f5)]=_0x217965(0x397)+_0x3950d9['title']+_0x217965(0xcdb)+new Date(_0x3950d9[_0x217965(0x6b5)])[_0x217965(0xd23)]()+_0x217965(0x1122),_0x19d2bb[_0x217965(0xa0f)](_0x217965(0xf5c),()=>_0x22b55b(_0x3950d9['id'])),_0x43a60a(_0x19d2bb,()=>_0x36ab68(_0x3950d9['id'])),_0xe9f8e8[_0x217965(0x7b9)](_0x19d2bb);});}async function _0x22b55b(_0x53979f){const _0x2cf05f=_0x419fa8,_0x4cb8a5=_0x9ebf46[_0x2cf05f(0x547)][_0x141b83];if(!_0x4cb8a5||!_0x4cb8a5[_0x2cf05f(0x2b7)])return;const _0x1a0245=_0x4cb8a5[_0x2cf05f(0x2b7)][_0x2cf05f(0xfc3)](_0x1dea4b=>_0x1dea4b['id']===_0x53979f);if(_0x1a0245){_0x246cff=_0x1a0245;const _0x1a631e=document['getElementById'](_0x2cf05f(0x904)),_0x1f7965=document[_0x2cf05f(0x9c8)](_0x2cf05f(0xa26)),_0x24a988=document[_0x2cf05f(0x9c8)](_0x2cf05f(0x1112));_0x1a631e[_0x2cf05f(0xe24)]=_0x1a0245['title'];const _0x43104c=_0x1ffeeb(_0x1a0245['content'])[_0x2cf05f(0x6c6)]('\x0a')[_0x2cf05f(0xa3b)](_0x3cbe69=>_0x2cf05f(0x10db)+(_0x3cbe69||_0x2cf05f(0x334))+_0x2cf05f(0x78d))[_0x2cf05f(0x809)]('');_0x1f7965['innerHTML']=_0x43104c;const _0x480214=await _0x2c5bcf[_0x2cf05f(0xc09)][_0x2cf05f(0xe78)]({'type':_0x2cf05f(0x423),'content.id':_0x53979f})['first']();_0x24a988[_0x2cf05f(0x575)][_0x2cf05f(0x1c3)]('active',!!_0x480214),_0x5bb1f1(_0x2cf05f(0x263));}}async function _0x499e1b(){const _0x515b44=_0x419fa8;if(!_0x246cff||!_0x141b83)return;const _0x5cc726=_0x246cff,_0x4e6431=_0x9ebf46[_0x515b44(0x547)][_0x141b83],_0x4a6dfc=document['getElementById'](_0x515b44(0x1112)),_0x15c2a6=await _0x2c5bcf[_0x515b44(0xc09)][_0x515b44(0xe78)]({'type':_0x515b44(0x423),'content.id':_0x5cc726['id']})['first']();if(_0x15c2a6)await _0x2c5bcf[_0x515b44(0xc09)][_0x515b44(0x6d2)](_0x15c2a6['id']),_0x4a6dfc['classList'][_0x515b44(0x30f)]('active'),await _0x1bff53(_0x515b44(0x7de),_0x515b44(0xea0));else{const _0x4583a8={'type':'char_diary','content':{'id':_0x5cc726['id'],'title':_0x5cc726[_0x515b44(0x9f2)],'content':_0x5cc726['content'],'timestamp':_0x5cc726['timestamp'],'characterId':_0x141b83,'characterName':_0x4e6431[_0x515b44(0x609)]},'timestamp':Date['now']()};await _0x2c5bcf[_0x515b44(0xc09)][_0x515b44(0x68e)](_0x4583a8),_0x4a6dfc[_0x515b44(0x575)][_0x515b44(0x68e)]('active'),await _0x1bff53(_0x515b44(0x7de),_0x515b44(0xb9a));}}async function _0xfcaa39(){const _0x148327=_0x419fa8;if(!_0xb8e4f0||!_0x141b83)return;const _0x5f5a05=_0xb8e4f0,_0xe1fd44=_0x9ebf46[_0x148327(0x547)][_0x141b83],_0x4eebb6=document[_0x148327(0x9c8)](_0x148327(0x77a)),_0x52d8c3=await _0x2c5bcf[_0x148327(0xc09)][_0x148327(0xe78)]({'type':_0x148327(0x136c),'content.id':_0x5f5a05['id']})[_0x148327(0x476)]();if(_0x52d8c3)await _0x2c5bcf[_0x148327(0xc09)][_0x148327(0x6d2)](_0x52d8c3['id']),_0x4eebb6['classList'][_0x148327(0x30f)](_0x148327(0x113d)),await _0x1bff53(_0x148327(0x7de),_0x148327(0xea0));else{const _0x366b76={'type':'char_memo','content':{'id':_0x5f5a05['id'],'title':_0x5f5a05[_0x148327(0x9f2)],'content':_0x5f5a05[_0x148327(0x53b)],'timestamp':_0x5f5a05['timestamp'],'characterId':_0x141b83,'characterName':_0xe1fd44[_0x148327(0x609)]},'timestamp':Date['now']()};await _0x2c5bcf[_0x148327(0xc09)][_0x148327(0x68e)](_0x366b76),_0x4eebb6['classList'][_0x148327(0x68e)](_0x148327(0x113d)),await _0x1bff53('操作成功','已成功收藏到“我的收藏”页面！');}}async function _0x36ab68(_0x437b48){const _0x20032f=_0x419fa8,_0x5a3940=await _0x352ae9(_0x20032f(0x412),_0x20032f(0x856),{'confirmButtonClass':_0x20032f(0x12bc)});if(_0x5a3940){const _0x145bbf=_0x9ebf46['chats'][_0x141b83];_0x145bbf[_0x20032f(0x2b7)]=_0x145bbf[_0x20032f(0x2b7)][_0x20032f(0x401)](_0x211f38=>_0x211f38['id']!==_0x437b48),await _0x2c5bcf[_0x20032f(0x547)][_0x20032f(0xff5)](_0x145bbf),_0x8560c5();}}async function _0x267084(){const _0x55baa2=_0x419fa8,_0x1ccd69=document[_0x55baa2(0x9c8)](_0x55baa2(0x6ae));_0x1ccd69['innerHTML']='';const _0x22435e=_0x9ebf46[_0x55baa2(0x547)][_0x141b83];if(!_0x22435e)return;const _0x30966c=_0x22435e['settings']['myNickname']||(_0x9ebf46[_0x55baa2(0x32c)][_0x55baa2(0x5b7)]||'我'),_0x309835=_0x22435e[_0x55baa2(0x8b3)]['filter'](_0x442a74=>!_0x442a74[_0x55baa2(0xc62)])[_0x55baa2(0x1044)](-0x1)[0x0]||{'content':_0x55baa2(0xf66)};let _0x130d5f='...';if(_0x309835){if(typeof _0x309835[_0x55baa2(0x53b)]==='string')_0x130d5f=_0x309835[_0x55baa2(0x53b)];else{if(Array[_0x55baa2(0xb27)](_0x309835[_0x55baa2(0x53b)])&&_0x309835[_0x55baa2(0x53b)][0x0]?.[_0x55baa2(0x12d9)]===_0x55baa2(0x96f))_0x130d5f=_0x55baa2(0x4a9);else{if(_0x309835[_0x55baa2(0x12d9)]){const _0x5807e7={'voice_message':_0x55baa2(0x1340),'transfer':'[转账]','ai_image':_0x55baa2(0x4a9)};_0x130d5f=_0x5807e7[_0x309835['type']]||'['+_0x309835['type']+']';}}}}const _0x4c21f8=_0x22435e['settings'][_0x55baa2(0xb60)]||_0x246753,_0x34c10d=_0x22435e[_0x55baa2(0x1131)]['myAvatarFrame']||'';let _0x39ebb6;_0x34c10d?_0x39ebb6=_0x55baa2(0xaad)+_0x4c21f8+_0x55baa2(0x33c)+_0x34c10d+_0x55baa2(0x12e4):_0x39ebb6=_0x55baa2(0x486)+_0x4c21f8+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>';const _0x4c4b24=document[_0x55baa2(0x28a)](_0x55baa2(0x11f4));_0x4c4b24['className']=_0x55baa2(0x52e),_0x4c4b24['dataset'][_0x55baa2(0x761)]='-1',_0x4c4b24[_0x55baa2(0x2f5)]=_0x55baa2(0xdde)+_0x39ebb6+_0x55baa2(0xe93)+_0x30966c+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>'+String(_0x130d5f)[_0x55baa2(0xc34)](0x0,0x14)+_0x55baa2(0x1150),_0x1ccd69[_0x55baa2(0x7b9)](_0x4c4b24);const _0x39e8aa=await _0x2c5bcf[_0x55baa2(0x1094)][_0x55baa2(0x5ff)](),_0x49edd7=new Map(_0x39e8aa[_0x55baa2(0xa3b)](_0x394398=>[_0x394398[_0x55baa2(0x609)],_0x394398])),_0x27836a=_0x22435e[_0x55baa2(0x289)]||[];if(_0x27836a[_0x55baa2(0xa06)]===0x0&&!_0x4c4b24){_0x1ccd69[_0x55baa2(0x2f5)]=_0x55baa2(0x1ad);return;}_0x27836a['forEach']((_0x1f5185,_0x6d106e)=>{const _0x14f14b=_0x55baa2;if(_0x1f5185['type']===_0x14f14b(0x7fb))return;const _0xadc42=document[_0x14f14b(0x28a)](_0x14f14b(0x11f4));_0xadc42[_0x14f14b(0x82c)]=_0x14f14b(0x52e),_0xadc42[_0x14f14b(0xc9f)][_0x14f14b(0x761)]=_0x6d106e;let _0x37846b,_0x2b7e38,_0x5e5acb;if(_0x1f5185[_0x14f14b(0x12d9)]===_0x14f14b(0x1016)){_0x5e5acb=_0x1f5185['groupName']+'\x20<span\x20class=\x22group-tag\x22>群</span>',_0x37846b=_0x1f5185[_0x14f14b(0x103b)][_0x14f14b(0x1044)](-0x1)[0x0]||{'content':_0x14f14b(0xf66)};const _0x427d0b=_0x14f14b(0x1377)+_0x1f5185['groupName']+'\x27',_0xfd68dd=_0x9ebf46[_0x14f14b(0x1383)][_0x14f14b(0x443)]?_0x14f14b(0x12d5)+encodeURIComponent(_0x427d0b):_0x5d7a94;_0x2b7e38=_0x14f14b(0x308)+_0xfd68dd+_0x14f14b(0x10f7);}else{_0x5e5acb=_0x1f5185[_0x14f14b(0xc5e)][_0x14f14b(0x609)],_0x37846b=_0x1f5185['messages'][_0x14f14b(0x1044)](-0x1)[0x0]||{'content':_0x14f14b(0xf66)};const _0x156df9=_0x49edd7[_0x14f14b(0xdf9)](_0x5e5acb);let _0x5f2a00=_0x156df9&&_0x156df9[_0x14f14b(0x10c9)]?_0x156df9[_0x14f14b(0x10c9)]:_0x9ebf46['globalSettings']['enableAiDrawing']?_0x14f14b(0x12d5)+encodeURIComponent(_0x1f5185['participant'][_0x14f14b(0x5bd)]||_0x14f14b(0x1065)):_0x337c8f;_0x2b7e38=_0x14f14b(0x308)+_0x5f2a00+_0x14f14b(0x10f7);}let _0x3cdd89=_0x14f14b(0xf66);_0x37846b&&_0x37846b['content']&&(_0x3cdd89=_0x37846b['content']),_0xadc42[_0x14f14b(0x2f5)]=_0x14f14b(0x11e0)+_0x2b7e38+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x5e5acb+_0x14f14b(0xe57)+String(_0x3cdd89)['substring'](0x0,0x14)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x1ccd69[_0x14f14b(0x7b9)](_0xadc42);});}async function _0x55a14c(){const _0x4cdf4c=_0x419fa8;if(!_0x141b83)return;const _0x2d4565=_0x9ebf46['chats'][_0x141b83];if(!_0x2d4565)return;await _0x1bff53(_0x4cdf4c(0x7a4),'正在根据“'+_0x2d4565[_0x4cdf4c(0x609)]+'”的记忆和人设，生成全新的社交动态...');const {proxyUrl:_0x52d814,apiKey:_0x401351,model:_0x1c14ab}=_0x9ebf46['apiConfig'];if(!_0x52d814||!_0x401351||!_0x1c14ab){alert(_0x4cdf4c(0xf3c));return;}const _0x197424=await _0x2c5bcf[_0x4cdf4c(0x1094)][_0x4cdf4c(0x5ff)](),_0x332f5e=_0x197424[_0x4cdf4c(0x401)](_0x22d73b=>_0x22d73b['associatedWith']&&_0x22d73b[_0x4cdf4c(0x754)][_0x4cdf4c(0x930)](_0x141b83));let _0x379292=_0x4cdf4c(0x556);_0x332f5e[_0x4cdf4c(0xa06)]>0x0?(_0x379292+='这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a',_0x332f5e[_0x4cdf4c(0x591)](_0x455610=>{const _0x5846b5=_0x4cdf4c;_0x379292+=_0x5846b5(0x10f1)+_0x455610[_0x5846b5(0x609)]+_0x5846b5(0x2d2)+_0x455610[_0x5846b5(0xeb1)]+'\x0a';})):_0x379292+=_0x4cdf4c(0x81d);const _0x49e7e4=_0x9ebf46[_0x4cdf4c(0x32c)][_0x4cdf4c(0x5b7)]==='{{user}}'||!_0x9ebf46[_0x4cdf4c(0x32c)]['nickname']?'用户':_0x9ebf46[_0x4cdf4c(0x32c)][_0x4cdf4c(0x5b7)],_0x55662a=_0x2d4565[_0x4cdf4c(0x1131)][_0x4cdf4c(0x29c)]||_0x49e7e4,_0x1e867d=_0x2d4565['longTermMemory']&&_0x2d4565[_0x4cdf4c(0x323)][_0x4cdf4c(0xa06)]>0x0?_0x2d4565[_0x4cdf4c(0x323)][_0x4cdf4c(0xa3b)](_0x215150=>'-\x20(记录于\x20'+_0x4fcd92(_0x215150['timestamp'])+')\x20'+_0x215150[_0x4cdf4c(0x53b)])[_0x4cdf4c(0x809)]('\x0a'):'无',_0x38f681=_0x2d4565['settings'][_0x4cdf4c(0x132a)]||0xa,_0x5cbbbb=_0x2d4565[_0x4cdf4c(0x8b3)]['slice'](-_0x38f681)[_0x4cdf4c(0xa3b)](_0x4b13e6=>(_0x4b13e6['role']===_0x4cdf4c(0x586)?_0x55662a:_0x2d4565['name'])+':\x20'+String(_0x4b13e6[_0x4cdf4c(0x53b)])[_0x4cdf4c(0xc34)](0x0,0x1e)+'...')[_0x4cdf4c(0x809)]('\x0a'),_0x9e75d8=(_0x2d4565[_0x4cdf4c(0x1131)][_0x4cdf4c(0x41a)]||[])[_0x4cdf4c(0xa3b)](_0x4dd5cb=>_0x9ebf46[_0x4cdf4c(0x1369)]['find'](_0x284e9a=>_0x284e9a['id']===_0x4dd5cb))[_0x4cdf4c(0x401)](Boolean)['map'](_0x1caec3=>_0x4cdf4c(0xb37)+_0x1caec3[_0x4cdf4c(0x609)]+'》设定\x20(你可以将其中角色作为聊天对象):\x0a'+_0x1caec3['content'][_0x4cdf4c(0x401)](_0x547a15=>_0x547a15['enabled'])[_0x4cdf4c(0xa3b)](_0x23bdf4=>'-\x20'+_0x23bdf4['content'])[_0x4cdf4c(0x809)]('\x0a'))['join'](''),_0x245a40=_0x2d4565[_0x4cdf4c(0x1071)]||_0x2d4565[_0x4cdf4c(0x609)],_0x4fed9c=_0xe373a(_0x2d4565),_0x2fbb50=_0x4cdf4c(0x279)+_0x2d4565[_0x4cdf4c(0x609)]+_0x4cdf4c(0xeee)+_0x245a40+_0x4cdf4c(0x4e5)+_0x245a40+'\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22'+_0x245a40+_0x4cdf4c(0x113a)+_0x2d4565[_0x4cdf4c(0x1131)][_0x4cdf4c(0xae3)]+'\x0a-\x20**你的长期记忆**:\x20'+_0x1e867d+_0x4cdf4c(0x3ad)+_0x9e75d8+_0x4cdf4c(0xd2c)+_0x5cbbbb+'\x0a'+_0x379292+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x4fed9c+_0x4cdf4c(0x189);try{const _0x5b50d6=[{'role':'user','content':_0x4cdf4c(0x1124)}];let _0x159909=_0x52d814[_0x4cdf4c(0x930)](_0x4cdf4c(0xb23)),_0xf5ab46=_0x2e5c04(_0x1c14ab,_0x401351,_0x2fbb50,_0x5b50d6);const _0x4a2f3a=_0x159909?await fetch(_0xf5ab46[_0x4cdf4c(0x11be)],_0xf5ab46[_0x4cdf4c(0x100d)]):await fetch(_0x52d814+_0x4cdf4c(0x1090),{'method':_0x4cdf4c(0x116f),'headers':{'Content-Type':_0x4cdf4c(0x698),'Authorization':'Bearer\x20'+_0x401351},'body':JSON[_0x4cdf4c(0xf1e)]({'model':_0x1c14ab,'messages':[{'role':'system','content':_0x2fbb50},..._0x5b50d6],'temperature':_0x9ebf46[_0x4cdf4c(0x1383)][_0x4cdf4c(0xc3d)]||0.9})});if(!_0x4a2f3a['ok'])throw new Error('API\x20错误:\x20'+_0x4a2f3a[_0x4cdf4c(0x399)]);const _0x320685=await _0x4a2f3a[_0x4cdf4c(0x5dd)](),_0x8a9028=getGeminiResponseText(_0x320685),_0x3c03f4=_0x8a9028['match'](/(\[[\s\S]*\])/);if(!_0x3c03f4||!_0x3c03f4[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x8a9028);const _0x2daea7=_0x3c03f4[0x0];let _0x16ee63;try{_0x16ee63=JSON[_0x4cdf4c(0x907)](_0x2daea7);}catch(_0x3374dc){throw new Error(_0x4cdf4c(0x1093)+_0x3374dc['message']+'\x0a\x0aAI原始返回内容:\x0a'+_0x8a9028);}_0x2d4565[_0x4cdf4c(0x289)]=_0x16ee63,await _0x2c5bcf[_0x4cdf4c(0x547)][_0x4cdf4c(0xff5)](_0x2d4565),await _0x267084();const _0x3d163c={'role':'system','content':_0x4cdf4c(0xe13),'timestamp':Date[_0x4cdf4c(0x9b7)](),'isHidden':!![]};_0x2d4565['history'][_0x4cdf4c(0x668)](_0x3d163c),await _0x2c5bcf[_0x4cdf4c(0x547)][_0x4cdf4c(0xff5)](_0x2d4565),_0x4128b4();}catch(_0x16cf52){console[_0x4cdf4c(0x1221)](_0x4cdf4c(0xce4),_0x16cf52),await _0x1bff53(_0x4cdf4c(0xf8d),_0x4cdf4c(0x137a)+_0x16cf52[_0x4cdf4c(0x86e)]);}}async function _0x2a8c8a(){const _0x332552=_0x419fa8;if(!_0x141b83)return;const _0x4e0390=_0x9ebf46[_0x332552(0x547)][_0x141b83];if(!_0x4e0390)return;try{const {proxyUrl:_0x1b72e0,apiKey:_0x54e37f,model:_0x3a4561}=_0x9ebf46['apiConfig'];if(!_0x1b72e0||!_0x54e37f||!_0x3a4561)throw new Error(_0x332552(0xf82));const _0x896da3=parseInt(_0x4e0390['settings']['maxMemory'])||0xa,_0x43eb5d=_0x4e0390['history'][_0x332552(0x1044)](-_0x896da3),_0x5b5d3c=_0x4e0390[_0x332552(0x1131)][_0x332552(0x29c)]||'我',_0x13bf20=_0x4e0390['settings']['myPersona']||'用户',_0x1b5246=_0x332552(0x55f)+(_0x4e0390[_0x332552(0x323)]&&_0x4e0390['longTermMemory'][_0x332552(0xa06)]>0x0?_0x4e0390[_0x332552(0x323)][_0x332552(0xa3b)](_0x2a4ffa=>'-\x20'+_0x2a4ffa['content'])[_0x332552(0x809)]('\x0a'):_0x332552(0x1264));let _0x3d0816='';if(_0x4e0390['settings'][_0x332552(0x41a)]&&_0x4e0390[_0x332552(0x1131)][_0x332552(0x41a)][_0x332552(0xa06)]>0x0){const _0x4c055d=_0x4e0390[_0x332552(0x1131)][_0x332552(0x41a)]['map'](_0x351c63=>{const _0x389132=_0x332552,_0x4810d3=_0x9ebf46[_0x389132(0x1369)][_0x389132(0xfc3)](_0x1bb126=>_0x1bb126['id']===_0x351c63);if(!_0x4810d3||!Array[_0x389132(0xb27)](_0x4810d3[_0x389132(0x53b)]))return'';const _0x1a1c51=_0x4810d3['content'][_0x389132(0x401)](_0x288c9e=>_0x288c9e[_0x389132(0x38a)]!==![])[_0x389132(0xa3b)](_0x8fabc2=>_0x389132(0x1085)+(_0x8fabc2[_0x389132(0x10de)]||'无备注')+_0x389132(0x8b6)+_0x8fabc2['content'])[_0x389132(0x809)]('');return _0x1a1c51?_0x389132(0xbac)+_0x4810d3[_0x389132(0x609)]+'\x0a'+_0x1a1c51:'';})[_0x332552(0x401)](Boolean)[_0x332552(0x809)]('');_0x4c055d&&(_0x3d0816=_0x332552(0xa3a)+_0x4c055d+'\x0a');}const _0x2ee03e=_0xbdd100(_0x4e0390,0x3,_0x332552(0x658)),_0x342db1=_0xbdd100(_0x4e0390,0x6,_0x332552(0x658)),_0x22dcf6=_0xbdd100(_0x4e0390,0x9,_0x332552(0x658)),_0x138a2c=_0xbdd100(_0x4e0390,0x1,'days'),_0x286376=_0xbdd100(_0x4e0390,0x3,_0x332552(0x929)),_0x560beb=_0xbdd100(_0x4e0390,0x7,_0x332552(0x929));let _0x3cb491='';if(_0x2ee03e||_0x342db1||_0x22dcf6||_0x138a2c||_0x286376||_0x560beb){_0x3cb491+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x2ee03e)_0x3cb491+=_0x2ee03e;if(_0x342db1)_0x3cb491+=_0x342db1;if(_0x22dcf6)_0x3cb491+=_0x22dcf6;if(_0x2ee03e||_0x342db1||_0x22dcf6)_0x3cb491+='\x0a';if(_0x138a2c)_0x3cb491+=_0x138a2c;if(_0x286376)_0x3cb491+=_0x286376;if(_0x560beb)_0x3cb491+=_0x560beb;}const _0x109836=_0x389fa5(_0x4e0390),_0x544878=_0x332552(0xe49)+_0x4e0390[_0x332552(0x1071)]+_0x332552(0x77e)+_0x4e0390[_0x332552(0x1131)][_0x332552(0xae3)]+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x109836+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x13bf20+_0x332552(0x11bb)+_0x4e0390['originalName']+_0x332552(0xe22)+_0x5b5d3c+'\x22\x0a'+_0x3d0816+'\x0a'+_0x1b5246+'\x0a'+_0x3cb491+_0x332552(0x643)+_0x43eb5d['map'](_0x19f561=>(_0x19f561[_0x332552(0x7fd)]==='user'?_0x5b5d3c:_0x4e0390[_0x332552(0x609)])+':\x20'+String(_0x19f561[_0x332552(0x53b)]))['join']('\x0a')+'\x0a\x0a现在，请继续这场对话。\x0a',_0x49fefd=_0x43eb5d[_0x332552(0xa3b)](_0x5e75ff=>({'role':_0x5e75ff[_0x332552(0x7fd)],'content':(_0x5e75ff[_0x332552(0x7fd)]===_0x332552(0x586)?_0x5b5d3c:_0x4e0390[_0x332552(0x609)])+':\x20'+String(_0x5e75ff[_0x332552(0x53b)])}));let _0x11020a=_0x1b72e0[_0x332552(0x930)](_0x332552(0xb23)),_0xc34c28=_0x2e5c04(_0x3a4561,_0x54e37f,_0x544878,_0x49fefd);const _0x45cc33=_0x11020a?await fetch(_0xc34c28[_0x332552(0x11be)],_0xc34c28[_0x332552(0x100d)]):await fetch(_0x1b72e0+_0x332552(0x1090),{'method':_0x332552(0x116f),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x54e37f},'body':JSON[_0x332552(0xf1e)]({'model':_0x3a4561,'messages':[{'role':_0x332552(0xb64),'content':_0x544878},..._0x49fefd],'temperature':_0x9ebf46[_0x332552(0x1383)][_0x332552(0xc3d)]||0.8})});if(!_0x45cc33['ok'])throw new Error(_0x332552(0xe1a)+(await _0x45cc33['json']())[_0x332552(0x1221)]['message']);const _0x84e2e3=await _0x45cc33[_0x332552(0x5dd)](),_0x376b5c=getGeminiResponseText(_0x84e2e3),_0x49c086=_0x169d92(_0x376b5c);if(!_0x49c086||_0x49c086['length']===0x0)throw new Error(_0x332552(0xb9d));let _0x46beae=0x0,_0x277629=Date[_0x332552(0x9b7)]();for(const _0x25d044 of _0x49c086){const _0x5a3f68={'role':_0x332552(0x1a7),'senderName':_0x4e0390[_0x332552(0x1071)],'timestamp':_0x277629++};let _0x5bbf3e=null;switch(_0x25d044[_0x332552(0x12d9)]){case _0x332552(0xbb7):_0x5bbf3e={..._0x5a3f68,'content':String(_0x25d044[_0x332552(0x53b)]||_0x25d044[_0x332552(0x86e)])};break;case _0x332552(0x83e):if(_0x25d044['meaning']){const _0x58e89d=_0x9ebf46[_0x332552(0x774)]['find'](_0x1c4fec=>_0x1c4fec[_0x332552(0x609)]===_0x25d044[_0x332552(0x1b3)]);_0x58e89d?_0x5bbf3e={..._0x5a3f68,'type':_0x332552(0x83e),'content':_0x58e89d[_0x332552(0x11be)],'meaning':_0x58e89d[_0x332552(0x609)]}:(console[_0x332552(0x453)](_0x332552(0xf5a)+_0x25d044['meaning']+'\x22'),_0x5bbf3e={..._0x5a3f68,'type':'text','content':_0x332552(0xef0)+_0x25d044[_0x332552(0x1b3)]+']'});}else console[_0x332552(0x453)](_0x332552(0x1270),_0x25d044),_0x5bbf3e={..._0x5a3f68,'type':_0x332552(0x83e),'content':_0x25d044['url'],'meaning':_0x332552(0xdbe)};break;}_0x5bbf3e&&(_0x4e0390[_0x332552(0x8b3)]['push'](_0x5bbf3e),_0x46beae++);}_0x46beae>0x0&&(_0x4e0390['unreadCount']=(_0x4e0390[_0x332552(0x382)]||0x0)+_0x46beae),await _0x2c5bcf['chats'][_0x332552(0xff5)](_0x4e0390),await _0x394b2c(),_0x46beae>0x0&&_0x52c10d(_0x4e0390['id'],_0x332552(0xc16)+_0x46beae+_0x332552(0x116a));}catch(_0x5af182){console[_0x332552(0x1221)](_0x332552(0x366),_0x5af182),await _0x1bff53('操作失败',_0x332552(0xc22)+_0x5af182[_0x332552(0x86e)]);}}async function _0x2f6963(){const _0x927501=_0x419fa8;if(_0xb426e||!_0x141b83)return;_0xb426e=!![];const _0x3778f4=document['getElementById'](_0x927501(0xd68)),_0x27e132=_0x9ebf46['chats'][_0x141b83];if(!_0x27e132){_0xb426e=![];return;}_0xde08bb(_0x3778f4,'top');const _0x2dc4ef=_0x3778f4[_0x927501(0x1e4)];await new Promise(_0xe0ddde=>setTimeout(_0xe0ddde,0x1f4));const _0x492cad=_0x27e132['history'][_0x927501(0xa06)],_0x1d0054=_0x9ebf46[_0x927501(0x1383)][_0x927501(0x4f5)]||0x32,_0x5f230b=_0x492cad-_0x512a95,_0x434099=Math[_0x927501(0x24e)](0x0,_0x5f230b-_0x1d0054),_0xd5a468=_0x27e132[_0x927501(0x8b3)][_0x927501(0x1044)](_0x434099,_0x5f230b);_0xfb2eb9(_0x3778f4);if(_0xd5a468[_0x927501(0xa06)]===0x0){_0xb426e=![];return;}for(const _0x3f257a of _0xd5a468[_0x927501(0x101e)]()){const _0x2329df={..._0x3f257a,'role':_0x3f257a['role']===_0x927501(0x586)?_0x927501(0x1a7):_0x927501(0x586)},_0x339e13={'id':'temp_user_chat_mirror','isGroup':![],'name':_0x27e132[_0x927501(0x609)],'settings':{..._0x27e132[_0x927501(0x1131)],'myAvatar':_0x27e132[_0x927501(0x1131)][_0x927501(0xd4d)],'myAvatarFrame':_0x27e132[_0x927501(0x1131)][_0x927501(0xdda)],'aiAvatar':_0x27e132['settings'][_0x927501(0xb60)],'aiAvatarFrame':_0x27e132[_0x927501(0x1131)][_0x927501(0x2a2)]}},_0x4d9e15=await _0x8ae2cf(_0x2329df,_0x339e13);_0x4d9e15&&_0x3778f4[_0x927501(0x2a8)](_0x4d9e15);}_0x512a95+=_0xd5a468['length'];const _0x4e12cf=_0x3778f4['scrollHeight'];_0x3778f4['scrollTop']=_0x4e12cf-_0x2dc4ef,_0xb426e=![];}async function _0x4eb7a8(_0x39bbd3){const _0xfe191e=_0x419fa8,_0x5427d5=_0x9ebf46[_0xfe191e(0x547)][_0x141b83];if(!_0x5427d5)return;_0x47adf6=_0x39bbd3===-0x1?'private_user':_0x5427d5['simulatedConversations'][_0x39bbd3]?.[_0xfe191e(0x12d9)];const _0x14edb3=document[_0xfe191e(0x9c8)]('char-conversation-messages');_0x14edb3[_0xfe191e(0x2f5)]='',_0x14edb3[_0xfe191e(0xc9f)][_0xfe191e(0x56d)]=_0x5427d5[_0xfe191e(0x1131)]['theme']||_0xfe191e(0x108b);const _0x19bce4=document[_0xfe191e(0x9c8)]('phone-screen')['classList'][_0xfe191e(0x1038)](_0xfe191e(0x292));_0x14edb3['style'][_0xfe191e(0x8e2)]=_0x19bce4?'#000000':'#f0f2f5';let _0x5001c2,_0x58ca3d=[];const _0x5b81b3=await _0x2c5bcf[_0xfe191e(0x1094)]['toArray'](),_0x5b1f06=new Map(_0x5b81b3['map'](_0x501860=>[_0x501860[_0xfe191e(0x609)],_0x501860]));if(_0x39bbd3===-0x1){_0x47adf6=_0xfe191e(0x7fb);const _0x191226=document['getElementById'](_0xfe191e(0xc4f)),_0x28ca1a=document['getElementById'](_0xfe191e(0x30b));_0x14edb3[_0xfe191e(0x2f5)]='',_0x191226[_0xfe191e(0xe24)]=_0x5427d5[_0xfe191e(0x1131)]['myNickname']||(_0x9ebf46[_0xfe191e(0x32c)][_0xfe191e(0x5b7)]||'我'),_0x28ca1a[_0xfe191e(0x1047)]='与\x20'+(_0x5427d5[_0xfe191e(0x1131)]['myNickname']||'我')+_0xfe191e(0x8ee),_0x512a95=0x0,_0xb426e=![];const _0x395f48=_0x5427d5[_0xfe191e(0x8b3)],_0x580f0d=_0x9ebf46['globalSettings'][_0xfe191e(0x4f5)]||0x32,_0x246910=_0x395f48[_0xfe191e(0x1044)](-_0x580f0d);_0x5001c2={'id':_0xfe191e(0x2eb),'isGroup':![],'name':_0x5427d5[_0xfe191e(0x609)],'settings':{..._0x5427d5['settings'],'myAvatar':_0x5427d5[_0xfe191e(0x1131)][_0xfe191e(0xd4d)],'myAvatarFrame':_0x5427d5[_0xfe191e(0x1131)][_0xfe191e(0xdda)],'aiAvatar':_0x5427d5[_0xfe191e(0x1131)][_0xfe191e(0xb60)],'aiAvatarFrame':_0x5427d5['settings'][_0xfe191e(0x2a2)]}},_0x58ca3d=_0x246910['map'](_0x2420a1=>({..._0x2420a1,'role':_0x2420a1[_0xfe191e(0x7fd)]===_0xfe191e(0x586)?'assistant':_0xfe191e(0x586)})),_0x512a95=_0x246910[_0xfe191e(0xa06)];}else{const _0x1031f6=_0x5427d5[_0xfe191e(0x289)][_0x39bbd3];if(!_0x1031f6)return;_0x47adf6=_0x1031f6['type'];const _0x185373=document[_0xfe191e(0x9c8)]('char-conversation-partner-name'),_0x76ea7b=document[_0xfe191e(0x9c8)](_0xfe191e(0x30b));if(_0x1031f6[_0xfe191e(0x12d9)]===_0xfe191e(0x1016))_0x185373[_0xfe191e(0xe24)]=_0x1031f6[_0xfe191e(0x9a6)]+'\x20('+(_0x1031f6[_0xfe191e(0x1189)]['length']+0x1)+')',_0x76ea7b[_0xfe191e(0x1047)]='在\x20'+_0x1031f6['groupName']+_0xfe191e(0xc38),_0x5001c2={'id':_0xfe191e(0x122a),'isGroup':!![],'name':_0x1031f6[_0xfe191e(0x9a6)],'originalName':_0x5427d5[_0xfe191e(0x1071)],'members':_0x1031f6[_0xfe191e(0x1189)]['map'](_0x13d5d1=>{const _0x206c76=_0xfe191e,_0xaf02fb=_0x5b1f06[_0x206c76(0xdf9)](_0x13d5d1[_0x206c76(0x609)]);let _0x320199=_0xaf02fb&&_0xaf02fb[_0x206c76(0x10c9)]?_0xaf02fb[_0x206c76(0x10c9)]:_0x9ebf46[_0x206c76(0x1383)][_0x206c76(0x443)]?_0x206c76(0x12d5)+encodeURIComponent(_0x13d5d1[_0x206c76(0x5bd)]||'anime\x20person'):_0x337c8f;return{'originalName':_0x13d5d1['name'],'groupNickname':_0x13d5d1['name'],'avatar':_0x320199};}),'settings':{..._0x5427d5[_0xfe191e(0x1131)],'myNickname':_0x5427d5[_0xfe191e(0x609)],'myAvatar':_0x5427d5[_0xfe191e(0x1131)][_0xfe191e(0xd4d)],'myAvatarFrame':_0x5427d5[_0xfe191e(0x1131)][_0xfe191e(0xdda)]}};else{_0x185373[_0xfe191e(0xe24)]=_0x1031f6[_0xfe191e(0xc5e)][_0xfe191e(0x609)],_0x76ea7b[_0xfe191e(0x1047)]='与\x20'+_0x1031f6['participant']['name']+'\x20的对话';const _0x487df7=_0x5b1f06[_0xfe191e(0xdf9)](_0x1031f6[_0xfe191e(0xc5e)][_0xfe191e(0x609)]),_0x3b9a7e=_0x487df7&&_0x487df7[_0xfe191e(0x10c9)]?_0x487df7[_0xfe191e(0x10c9)]:_0x9ebf46[_0xfe191e(0x1383)]['enableAiDrawing']?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x1031f6[_0xfe191e(0xc5e)][_0xfe191e(0x5bd)]||_0xfe191e(0x1065)):_0x337c8f;_0x5001c2={'id':_0xfe191e(0xaea),'isGroup':![],'name':_0x1031f6['participant'][_0xfe191e(0x609)],'originalName':_0x5427d5[_0xfe191e(0x1071)],'settings':{..._0x5427d5[_0xfe191e(0x1131)],'myAvatar':_0x5427d5[_0xfe191e(0x1131)][_0xfe191e(0xd4d)],'myAvatarFrame':_0x5427d5[_0xfe191e(0x1131)][_0xfe191e(0xdda)],'aiAvatar':_0x3b9a7e,'aiAvatarFrame':''}};}_0x58ca3d=_0x1031f6['messages'];}for(const _0x532d55 of _0x58ca3d){let _0x3cd084=_0x532d55[_0xfe191e(0x7fd)];if(_0x39bbd3!==-0x1){const _0x43cbfd=_0x532d55['sender']===(_0x5427d5[_0xfe191e(0x1071)]||_0x5427d5[_0xfe191e(0x609)]);_0x3cd084=_0x43cbfd?_0xfe191e(0x586):_0xfe191e(0x1a7);}const _0x996fd2={'role':_0x3cd084,'senderName':_0x532d55[_0xfe191e(0xfa4)]||(_0x3cd084===_0xfe191e(0x586)?_0x5001c2[_0xfe191e(0x1131)][_0xfe191e(0x29c)]:_0x5001c2[_0xfe191e(0x609)]),'timestamp':_0x532d55[_0xfe191e(0x6b5)]||Date[_0xfe191e(0x9b7)]()+Math[_0xfe191e(0x360)]()};if(_0x532d55[_0xfe191e(0x12d9)]===_0xfe191e(0x83e)&&_0x532d55[_0xfe191e(0x1b3)]){const _0x7e607e=_0x9ebf46[_0xfe191e(0x774)][_0xfe191e(0xfc3)](_0x1881da=>_0x1881da['name']===_0x532d55[_0xfe191e(0x1b3)]);_0x7e607e?(_0x996fd2[_0xfe191e(0x53b)]=_0x7e607e[_0xfe191e(0x11be)],_0x996fd2[_0xfe191e(0x1b3)]=_0x532d55[_0xfe191e(0x1b3)],_0x996fd2['type']=_0xfe191e(0x83e)):(console[_0xfe191e(0x453)](_0xfe191e(0x1127)+_0x532d55[_0xfe191e(0x1b3)]+_0xfe191e(0x11d3)),_0x996fd2['content']=_0xfe191e(0xef0)+_0x532d55['meaning']+']',_0x996fd2['type']='text');}else _0x996fd2['content']=_0x532d55[_0xfe191e(0x53b)],_0x996fd2[_0xfe191e(0x12d9)]=_0x532d55[_0xfe191e(0x12d9)]||_0xfe191e(0xbb7);const _0x1440c4=await _0x8ae2cf(_0x996fd2,_0x5001c2);_0x1440c4&&_0x14edb3[_0xfe191e(0x7b9)](_0x1440c4);}_0x5bb1f1(_0xfe191e(0x40b)),setTimeout(()=>_0x14edb3[_0xfe191e(0x783)]=_0x14edb3[_0xfe191e(0x1e4)],0x0);}function _0xef558f(){const _0x4ee6cb=_0x419fa8;document[_0x4ee6cb(0x9c8)](_0x4ee6cb(0xfa7))[_0x4ee6cb(0x575)][_0x4ee6cb(0x30f)]('visible');}async function _0x202be7(){const _0x12e525=_0x419fa8;if(!_0x141b83)return;const _0x279be8=_0x9ebf46[_0x12e525(0x547)][_0x141b83];if(!_0x279be8){await _0x1bff53(_0x12e525(0x24d),_0x12e525(0x42c));return;}await _0x1bff53(_0x12e525(0x7a4),_0x12e525(0xd33)+_0x279be8[_0x12e525(0x609)]+'”回忆TA的相册照片...');const {proxyUrl:_0x285d3f,apiKey:_0x5d9d9e,model:_0x37c5f6}=_0x9ebf46[_0x12e525(0x4de)];if(!_0x285d3f||!_0x5d9d9e||!_0x37c5f6){alert(_0x12e525(0xf3c));return;}const _0xe45912=_0x9ebf46[_0x12e525(0x32c)][_0x12e525(0x5b7)]==='{{user}}'||!_0x9ebf46['qzoneSettings']['nickname']?'用户':_0x9ebf46[_0x12e525(0x32c)][_0x12e525(0x5b7)],_0x51f056=_0x279be8['longTermMemory']&&_0x279be8[_0x12e525(0x323)][_0x12e525(0xa06)]>0x0?_0x279be8[_0x12e525(0x323)][_0x12e525(0xa3b)](_0x48cbe9=>_0x12e525(0x1dc)+_0x4fcd92(_0x48cbe9[_0x12e525(0x6b5)])+')\x20'+_0x48cbe9['content'])[_0x12e525(0x809)]('\x0a'):'无',_0x5378ae=_0x279be8[_0x12e525(0x1131)][_0x12e525(0x132a)]||0xa,_0xab0e0f=_0x279be8[_0x12e525(0x8b3)][_0x12e525(0x1044)](-_0x5378ae)[_0x12e525(0xa3b)](_0x46876f=>(_0x46876f[_0x12e525(0x7fd)]===_0x12e525(0x586)?_0xe45912:_0x279be8[_0x12e525(0x609)])+':\x20'+String(_0x46876f[_0x12e525(0x53b)])[_0x12e525(0xc34)](0x0,0x1e)+_0x12e525(0xf66))[_0x12e525(0x809)]('\x0a'),_0x3a9eb3=(_0x279be8[_0x12e525(0x1131)][_0x12e525(0x41a)]||[])[_0x12e525(0xa3b)](_0x1ff375=>_0x9ebf46[_0x12e525(0x1369)][_0x12e525(0xfc3)](_0x17ef3f=>_0x17ef3f['id']===_0x1ff375))['filter'](Boolean)['map'](_0x2dcfa3=>_0x12e525(0xb37)+_0x2dcfa3[_0x12e525(0x609)]+_0x12e525(0x2a4)+_0x2dcfa3[_0x12e525(0x53b)][_0x12e525(0x401)](_0x6af9e4=>_0x6af9e4['enabled'])[_0x12e525(0xa3b)](_0x3c7545=>'-\x20'+_0x3c7545[_0x12e525(0x53b)])[_0x12e525(0x809)]('\x0a'))[_0x12e525(0x809)](''),_0x2e2d73=_0xbdd100(_0x279be8,0x3,'hours'),_0x1a817a=_0xbdd100(_0x279be8,0x6,'hours'),_0x214b33=_0xbdd100(_0x279be8,0x9,_0x12e525(0x658)),_0xe91b10=_0xbdd100(_0x279be8,0x1,_0x12e525(0x929)),_0x310b07=_0xbdd100(_0x279be8,0x3,'days'),_0x1a09e7=_0xbdd100(_0x279be8,0x7,_0x12e525(0x929));let _0x17c890='';if(_0x2e2d73||_0x1a817a||_0x214b33||_0xe91b10||_0x310b07||_0x1a09e7){_0x17c890+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x2e2d73)_0x17c890+=_0x2e2d73;if(_0x1a817a)_0x17c890+=_0x1a817a;if(_0x214b33)_0x17c890+=_0x214b33;if(_0x2e2d73||_0x1a817a||_0x214b33)_0x17c890+='\x0a';if(_0xe91b10)_0x17c890+=_0xe91b10;if(_0x310b07)_0x17c890+=_0x310b07;if(_0x1a09e7)_0x17c890+=_0x1a09e7;}const _0x1414f1=_0x12e525(0x1176)+_0x279be8[_0x12e525(0x609)]+_0x12e525(0xdee)+_0x279be8[_0x12e525(0x1131)]['aiPersona']+'\x0a'+_0x51f056+'\x0a'+_0x3a9eb3+'\x0a'+_0x17c890+_0x12e525(0x211)+_0xe45912+_0x12e525(0xa83)+_0xab0e0f+_0x12e525(0x1249);try{const _0x508783=[{'role':_0x12e525(0x586),'content':_0x12e525(0x895)}];let _0x114cad=_0x285d3f[_0x12e525(0x930)](_0x12e525(0xb23)),_0x57ed73=_0x2e5c04(_0x37c5f6,_0x5d9d9e,_0x1414f1,_0x508783);const _0x485fde=_0x114cad?await fetch(_0x57ed73[_0x12e525(0x11be)],_0x57ed73[_0x12e525(0x100d)]):await fetch(_0x285d3f+_0x12e525(0x1090),{'method':_0x12e525(0x116f),'headers':{'Content-Type':_0x12e525(0x698),'Authorization':_0x12e525(0x84a)+_0x5d9d9e},'body':JSON[_0x12e525(0xf1e)]({'model':_0x37c5f6,'messages':[{'role':_0x12e525(0xb64),'content':_0x1414f1},..._0x508783],'temperature':_0x9ebf46[_0x12e525(0x1383)]['apiTemperature']||0.9})});if(!_0x485fde['ok'])throw new Error(_0x12e525(0x8ab)+_0x485fde[_0x12e525(0x399)]);const _0x4e36f5=await _0x485fde[_0x12e525(0x5dd)](),_0x3e7514=getGeminiResponseText(_0x4e36f5),_0x3b64dc=_0x3e7514['match'](/(\[[\s\S]*\])/);if(!_0x3b64dc||!_0x3b64dc[0x0])throw new Error(_0x12e525(0x9c5)+_0x3e7514);const _0x4ada37=_0x3b64dc[0x0];let _0x1eff92;try{_0x1eff92=JSON[_0x12e525(0x907)](_0x4ada37);}catch(_0x4663fa){throw new Error(_0x12e525(0x1093)+_0x4663fa[_0x12e525(0x86e)]+_0x12e525(0xa48)+_0x3e7514);}_0x279be8[_0x12e525(0x343)]=_0x1eff92,await _0x2c5bcf['chats'][_0x12e525(0xff5)](_0x279be8),await _0x3eea82();}catch(_0xe6050b){console[_0x12e525(0x1221)]('生成模拟相册失败:',_0xe6050b),await _0x1bff53(_0x12e525(0xf8d),_0x12e525(0x25b)+_0xe6050b['message']);}}async function _0x3eea82(){const _0x3242b1=_0x419fa8,_0x2aeaec=document[_0x3242b1(0x9c8)](_0x3242b1(0xe17));_0x2aeaec[_0x3242b1(0x2f5)]='';if(!_0x141b83)return;const _0x5e76c4=_0x9ebf46['chats'][_0x141b83],_0x307aa6=_0x5e76c4[_0x3242b1(0x343)]||[];if(_0x307aa6[_0x3242b1(0xa06)]===0x0){_0x2aeaec[_0x3242b1(0x2f5)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>';return;}const _0x3e25f7=_0x3242b1(0xe94);_0x307aa6['forEach'](_0x46204c=>{const _0x3eebd4=_0x3242b1,_0x49d6e0=document[_0x3eebd4(0x28a)](_0x3eebd4(0x11f4));_0x49d6e0[_0x3eebd4(0x82c)]=_0x3eebd4(0x87b),_0x49d6e0[_0x3eebd4(0xc9f)][_0x3eebd4(0x1387)]=_0x46204c[_0x3eebd4(0x1387)],_0x2aeaec[_0x3eebd4(0x7b9)](_0x49d6e0);if(_0x9ebf46[_0x3eebd4(0x1383)]['enableAiDrawing']){_0x49d6e0[_0x3eebd4(0x5e1)][_0x3eebd4(0x8e2)]='#e9ecef';const _0x5a985c=/[^\x00-\x7F]/[_0x3eebd4(0x4e8)](_0x46204c['image_prompt']),_0x449917=_0x46204c[_0x3eebd4(0xd73)]&&_0x46204c[_0x3eebd4(0xd73)][_0x3eebd4(0x3f1)]()&&!_0x5a985c,_0x5c2d16=_0x449917?_0x46204c[_0x3eebd4(0xd73)]:'a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting',_0x2c14f7=_0x3eebd4(0x12d5)+encodeURIComponent(_0x5c2d16),_0xbc984b=new Image();_0xbc984b['onload']=function(){const _0x46fc8a=_0x3eebd4;_0x49d6e0[_0x46fc8a(0x5e1)]['backgroundImage']='url('+this[_0x46fc8a(0xbf4)]+')';},_0xbc984b[_0x3eebd4(0x11e5)]=function(){const _0x5d8900=_0x3eebd4;_0x49d6e0['style']['backgroundImage']=_0x5d8900(0x7fe)+_0x3e25f7+')';},_0xbc984b[_0x3eebd4(0xbf4)]=_0x2c14f7;}else{_0x49d6e0[_0x3eebd4(0x5e1)][_0x3eebd4(0x8e2)]=_0x3eebd4(0xbea),_0x49d6e0[_0x3eebd4(0x5e1)][_0x3eebd4(0xbf0)]='1px\x20solid\x20#e0e0e0';const _0x2fd34c=document[_0x3eebd4(0x28a)]('p');_0x2fd34c[_0x3eebd4(0x82c)]='char-photo-description',_0x2fd34c['textContent']=_0x46204c[_0x3eebd4(0x1387)]||_0x3eebd4(0xa8e),_0x49d6e0['appendChild'](_0x2fd34c);}});}async function _0x47894b(){const _0x419831=_0x419fa8;if(!_0x141b83)return;const _0x1fb643=_0x9ebf46[_0x419831(0x547)][_0x141b83];if(!_0x1fb643)return;await _0x1bff53(_0x419831(0x7a4),'正在模拟“'+_0x1fb643['name']+_0x419831(0x1220));const {proxyUrl:_0x5656ba,apiKey:_0x59c332,model:_0x57806b}=_0x9ebf46['apiConfig'];if(!_0x5656ba||!_0x59c332||!_0x57806b){alert(_0x419831(0x5da));return;}const _0x27d5ba=_0x9ebf46[_0x419831(0x32c)][_0x419831(0x5b7)]==='{{user}}'||!_0x9ebf46[_0x419831(0x32c)][_0x419831(0x5b7)]?'用户':_0x9ebf46['qzoneSettings'][_0x419831(0x5b7)],_0x4b0ece=_0x1fb643[_0x419831(0x323)]&&_0x1fb643[_0x419831(0x323)][_0x419831(0xa06)]>0x0?_0x1fb643[_0x419831(0x323)][_0x419831(0xa3b)](_0x288c40=>_0x419831(0x1dc)+_0x4fcd92(_0x288c40['timestamp'])+')\x20'+_0x288c40[_0x419831(0x53b)])[_0x419831(0x809)]('\x0a'):'无',_0xf3233=_0x1fb643[_0x419831(0x1131)][_0x419831(0x132a)]||0xa,_0x1614b7=_0x1fb643[_0x419831(0x8b3)][_0x419831(0x1044)](-_0xf3233)[_0x419831(0xa3b)](_0x543e82=>(_0x543e82[_0x419831(0x7fd)]===_0x419831(0x586)?_0x27d5ba:_0x1fb643[_0x419831(0x609)])+':\x20'+String(_0x543e82[_0x419831(0x53b)])[_0x419831(0xc34)](0x0,0x1e)+'...')[_0x419831(0x809)]('\x0a'),_0x2d9dfe=(_0x1fb643[_0x419831(0x1131)][_0x419831(0x41a)]||[])['map'](_0x4f374b=>_0x9ebf46[_0x419831(0x1369)][_0x419831(0xfc3)](_0x5b9985=>_0x5b9985['id']===_0x4f374b))[_0x419831(0x401)](Boolean)[_0x419831(0xa3b)](_0x2a35a5=>_0x419831(0xb37)+_0x2a35a5['name']+_0x419831(0x2a4)+_0x2a35a5[_0x419831(0x53b)][_0x419831(0x401)](_0x420812=>_0x420812[_0x419831(0x38a)])[_0x419831(0xa3b)](_0x2f323c=>'-\x20'+_0x2f323c['content'])[_0x419831(0x809)]('\x0a'))[_0x419831(0x809)](''),_0x561fea=_0xbdd100(_0x1fb643,0x3,_0x419831(0x658)),_0x4758d0=_0xbdd100(_0x1fb643,0x6,_0x419831(0x658)),_0xd02d54=_0xbdd100(_0x1fb643,0x9,_0x419831(0x658)),_0x116303=_0xbdd100(_0x1fb643,0x1,'days'),_0x3e88c0=_0xbdd100(_0x1fb643,0x3,_0x419831(0x929)),_0xb9c4ab=_0xbdd100(_0x1fb643,0x7,_0x419831(0x929));let _0x290b2b='';if(_0x561fea||_0x4758d0||_0xd02d54||_0x116303||_0x3e88c0||_0xb9c4ab){_0x290b2b+=_0x419831(0x6ce);if(_0x561fea)_0x290b2b+=_0x561fea;if(_0x4758d0)_0x290b2b+=_0x4758d0;if(_0xd02d54)_0x290b2b+=_0xd02d54;if(_0x561fea||_0x4758d0||_0xd02d54)_0x290b2b+='\x0a';if(_0x116303)_0x290b2b+=_0x116303;if(_0x3e88c0)_0x290b2b+=_0x3e88c0;if(_0xb9c4ab)_0x290b2b+=_0xb9c4ab;}const _0x5b1d96=_0x419831(0x1176)+_0x1fb643['name']+_0x419831(0x2ef)+_0x1fb643['settings']['aiPersona']+'\x0a-\x20**你的长期记忆**:\x0a'+_0x4b0ece+'\x0a'+_0x2d9dfe+'\x0a'+_0x290b2b+_0x419831(0x211)+_0x27d5ba+_0x419831(0xa83)+_0x1614b7+_0x419831(0xaeb);try{const _0xcf7520=[{'role':_0x419831(0x586),'content':_0x419831(0x4b1)}];let _0xf819=_0x5656ba[_0x419831(0x930)](_0x419831(0xb23)),_0x1abe7c=_0x2e5c04(_0x57806b,_0x59c332,_0x5b1d96,_0xcf7520);const _0x597ad6=_0xf819?await fetch(_0x1abe7c['url'],_0x1abe7c[_0x419831(0x100d)]):await fetch(_0x5656ba+_0x419831(0x1090),{'method':_0x419831(0x116f),'headers':{'Content-Type':_0x419831(0x698),'Authorization':_0x419831(0x84a)+_0x59c332},'body':JSON[_0x419831(0xf1e)]({'model':_0x57806b,'messages':[{'role':_0x419831(0xb64),'content':_0x5b1d96},..._0xcf7520],'temperature':_0x9ebf46[_0x419831(0x1383)][_0x419831(0xc3d)]||0.9})});if(!_0x597ad6['ok'])throw new Error('API\x20错误:\x20'+_0x597ad6[_0x419831(0x399)]);const _0x6e1361=await _0x597ad6['json'](),_0x388a94=getGeminiResponseText(_0x6e1361),_0x261866=_0x388a94[_0x419831(0x12c2)](/(\[[\s\S]*\])/);if(!_0x261866||!_0x261866[0x0])throw new Error(_0x419831(0x9c5)+_0x388a94);const _0x69c03a=_0x261866[0x0];let _0x5ee0e7;try{_0x5ee0e7=JSON['parse'](_0x69c03a);}catch(_0x3dae00){throw new Error(_0x419831(0x1093)+_0x3dae00[_0x419831(0x86e)]+_0x419831(0xa48)+_0x388a94);}_0x1fb643[_0x419831(0x4e1)]=_0x5ee0e7,await _0x2c5bcf['chats']['put'](_0x1fb643),await _0x34c684();}catch(_0x843b27){console[_0x419831(0x1221)](_0x419831(0xc96),_0x843b27),await _0x1bff53(_0x419831(0xf8d),_0x419831(0x6ad)+_0x843b27[_0x419831(0x86e)]);}}function _0x34c684(){const _0x3ad5e0=_0x419fa8,_0x26307f=document[_0x3ad5e0(0x9c8)]('char-browser-history');_0x26307f['innerHTML']='';if(!_0x141b83)return;const _0x14c4b0=_0x9ebf46[_0x3ad5e0(0x547)][_0x141b83],_0x2bdd8a=_0x14c4b0[_0x3ad5e0(0x4e1)]||[];if(_0x2bdd8a[_0x3ad5e0(0xa06)]===0x0){_0x26307f[_0x3ad5e0(0x2f5)]=_0x3ad5e0(0xac0);return;}_0x2bdd8a[_0x3ad5e0(0x591)]((_0xc76dbb,_0x524d55)=>{const _0x42e757=_0x3ad5e0,_0x5e7703=document[_0x42e757(0x28a)](_0x42e757(0x11f4));_0x5e7703[_0x42e757(0x82c)]=_0x42e757(0xc37),_0x5e7703['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0xc76dbb[_0x42e757(0x9f2)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>'+_0xc76dbb[_0x42e757(0x11be)]+_0x42e757(0xa43),_0x5e7703[_0x42e757(0xa0f)](_0x42e757(0xf5c),()=>_0x3c7570(_0x524d55)),_0x26307f[_0x42e757(0x7b9)](_0x5e7703);});}async function _0x3c7570(_0x5cad96){const _0x227c68=_0x419fa8,_0x130eed=_0x9ebf46[_0x227c68(0x547)][_0x141b83],_0x4cea2b=_0x130eed['simulatedBrowserHistory'][_0x5cad96];if(!_0x4cea2b)return;_0x118ea3=_0x4cea2b,_0x230b89(_0x4cea2b),_0x5bb1f1('char-browser-article-screen');const _0x16e706=document['getElementById'](_0x227c68(0x52a)),_0x5d0d32=await _0x2c5bcf[_0x227c68(0xc09)]['where']({'type':'char_browser_article','content.url':_0x4cea2b['url']})['first']();_0x16e706[_0x227c68(0x575)][_0x227c68(0x1c3)](_0x227c68(0x113d),!!_0x5d0d32);}async function _0x2bbabb(){const _0x11fb29=_0x419fa8;if(!_0x118ea3||!_0x141b83)return;const _0x429cc5=_0x118ea3,_0x5207d1=_0x9ebf46['chats'][_0x141b83],_0x24029a=document['getElementById'](_0x11fb29(0x52a)),_0x2ea584=await _0x2c5bcf[_0x11fb29(0xc09)][_0x11fb29(0xe78)]({'type':'char_browser_article','content.url':_0x429cc5['url']})['first']();if(_0x2ea584)await _0x2c5bcf[_0x11fb29(0xc09)][_0x11fb29(0x6d2)](_0x2ea584['id']),_0x24029a['classList']['remove'](_0x11fb29(0x113d)),await _0x1bff53(_0x11fb29(0x7de),'已取消收藏。');else{const _0x3a72bc={'type':_0x11fb29(0x355),'content':{..._0x429cc5,'characterId':_0x141b83,'characterName':_0x5207d1[_0x11fb29(0x609)]},'timestamp':Date[_0x11fb29(0x9b7)]()};await _0x2c5bcf[_0x11fb29(0xc09)][_0x11fb29(0x68e)](_0x3a72bc),_0x24029a['classList'][_0x11fb29(0x68e)](_0x11fb29(0x113d)),await _0x1bff53('操作成功','已成功收藏到“我的收藏”页面！');}}function _0x230b89(_0x55c44d){const _0x4e8728=_0x419fa8,_0x4cd3d0=document[_0x4e8728(0x9c8)](_0x4e8728(0xb8e)),_0x57d369=document[_0x4e8728(0x9c8)]('char-article-content');_0x4cd3d0[_0x4e8728(0xe24)]=_0x55c44d[_0x4e8728(0x9f2)],_0x57d369['innerHTML']='',_0x55c44d[_0x4e8728(0x12d9)]===_0x4e8728(0x10eb)?_0x57d369['innerHTML']=_0x4e8728(0x518)+(_0x55c44d[_0x4e8728(0x9f2)]||_0x4e8728(0xfa1))+_0x4e8728(0x78d):_0x57d369[_0x4e8728(0x2f5)]=_0x4e8728(0x10db)+(_0x55c44d[_0x4e8728(0x53b)]||_0x4e8728(0xd42))[_0x4e8728(0x459)](/\n/g,_0x4e8728(0xdb9))+_0x4e8728(0x78d);}async function _0x597159(){const _0x2143c4=_0x419fa8;if(!_0x141b83)return;const _0x1ae327=_0x9ebf46[_0x2143c4(0x547)][_0x141b83];if(!_0x1ae327)return;await _0x1bff53(_0x2143c4(0x7a4),_0x2143c4(0x7d4)+_0x1ae327[_0x2143c4(0x609)]+_0x2143c4(0x25d));const {proxyUrl:_0x322777,apiKey:_0x44ebe9,model:_0x83c85}=_0x9ebf46['apiConfig'];if(!_0x322777||!_0x44ebe9||!_0x83c85){alert(_0x2143c4(0x5da));return;}const _0x6d2450=_0x9ebf46[_0x2143c4(0x32c)][_0x2143c4(0x5b7)]===_0x2143c4(0x5c1)||!_0x9ebf46[_0x2143c4(0x32c)]['nickname']?'用户':_0x9ebf46[_0x2143c4(0x32c)]['nickname'],_0x4a05e5=_0x1ae327[_0x2143c4(0x323)]&&_0x1ae327[_0x2143c4(0x323)]['length']>0x0?_0x1ae327[_0x2143c4(0x323)][_0x2143c4(0xa3b)](_0x536642=>_0x2143c4(0x1dc)+_0x4fcd92(_0x536642['timestamp'])+')\x20'+_0x536642['content'])[_0x2143c4(0x809)]('\x0a'):'无',_0x19c826=_0x1ae327[_0x2143c4(0x1131)]['maxMemory']||0xa,_0x574f5e=_0x1ae327['history'][_0x2143c4(0x1044)](-_0x19c826)[_0x2143c4(0xa3b)](_0x323091=>(_0x323091['role']===_0x2143c4(0x586)?_0x6d2450:_0x1ae327['name'])+':\x20'+String(_0x323091[_0x2143c4(0x53b)])[_0x2143c4(0xc34)](0x0,0x1e)+_0x2143c4(0xf66))[_0x2143c4(0x809)]('\x0a'),_0x12d65c=(_0x1ae327[_0x2143c4(0x1131)][_0x2143c4(0x41a)]||[])[_0x2143c4(0xa3b)](_0x16c2b9=>_0x9ebf46[_0x2143c4(0x1369)]['find'](_0x726ee7=>_0x726ee7['id']===_0x16c2b9))['filter'](Boolean)['map'](_0x51aa6d=>_0x2143c4(0xb37)+_0x51aa6d['name']+'》设定:\x0a'+_0x51aa6d[_0x2143c4(0x53b)][_0x2143c4(0x401)](_0x1915ee=>_0x1915ee[_0x2143c4(0x38a)])[_0x2143c4(0xa3b)](_0x2f6ce1=>'-\x20'+_0x2f6ce1[_0x2143c4(0x53b)])[_0x2143c4(0x809)]('\x0a'))[_0x2143c4(0x809)](''),_0x45a4a7=_0xbdd100(_0x1ae327,0x3,_0x2143c4(0x658)),_0x2e9d3c=_0xbdd100(_0x1ae327,0x6,_0x2143c4(0x658)),_0x3d8d7f=_0xbdd100(_0x1ae327,0x9,_0x2143c4(0x658)),_0x3c3d84=_0xbdd100(_0x1ae327,0x1,_0x2143c4(0x929)),_0x55281a=_0xbdd100(_0x1ae327,0x3,_0x2143c4(0x929)),_0x4f18e0=_0xbdd100(_0x1ae327,0x7,'days');let _0x5914b3='';if(_0x45a4a7||_0x2e9d3c||_0x3d8d7f||_0x3c3d84||_0x55281a||_0x4f18e0){_0x5914b3+=_0x2143c4(0x6ce);if(_0x45a4a7)_0x5914b3+=_0x45a4a7;if(_0x2e9d3c)_0x5914b3+=_0x2e9d3c;if(_0x3d8d7f)_0x5914b3+=_0x3d8d7f;if(_0x45a4a7||_0x2e9d3c||_0x3d8d7f)_0x5914b3+='\x0a';if(_0x3c3d84)_0x5914b3+=_0x3c3d84;if(_0x55281a)_0x5914b3+=_0x55281a;if(_0x4f18e0)_0x5914b3+=_0x4f18e0;}const _0x28cee5=_0x2143c4(0x1176)+_0x1ae327['name']+_0x2143c4(0x527)+_0x1ae327[_0x2143c4(0x1131)][_0x2143c4(0xae3)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0x4a05e5+'\x0a'+_0x12d65c+'\x0a'+_0x5914b3+'\x20\x0a-\x20**你最近和“'+_0x6d2450+_0x2143c4(0xa83)+_0x574f5e+'\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。';try{const _0x3669be=[{'role':_0x2143c4(0x586),'content':_0x2143c4(0xe30)}];let _0x526e26=_0x322777[_0x2143c4(0x930)](_0x2143c4(0xb23)),_0x24aab5=_0x2e5c04(_0x83c85,_0x44ebe9,_0x28cee5,_0x3669be);const _0x28b327=_0x526e26?await fetch(_0x24aab5[_0x2143c4(0x11be)],_0x24aab5[_0x2143c4(0x100d)]):await fetch(_0x322777+_0x2143c4(0x1090),{'method':'POST','headers':{'Content-Type':_0x2143c4(0x698),'Authorization':_0x2143c4(0x84a)+_0x44ebe9},'body':JSON[_0x2143c4(0xf1e)]({'model':_0x83c85,'messages':[{'role':_0x2143c4(0xb64),'content':_0x28cee5},..._0x3669be],'temperature':_0x9ebf46[_0x2143c4(0x1383)]['apiTemperature']||0.9})});if(!_0x28b327['ok'])throw new Error(_0x2143c4(0x8ab)+_0x28b327[_0x2143c4(0x399)]);const _0x2a84a8=await _0x28b327[_0x2143c4(0x5dd)](),_0x3ddbb1=getGeminiResponseText(_0x2a84a8),_0x1b73bb=_0x3ddbb1[_0x2143c4(0x12c2)](/({[\s\S]*})/);if(!_0x1b73bb)throw new Error(_0x2143c4(0x10ba));const _0x4e219c=JSON['parse'](_0x1b73bb[0x0]);!_0x4e219c[_0x2143c4(0x1031)]&&(_0x4e219c[_0x2143c4(0x1031)]=[]),_0x1ae327['simulatedTaobaoHistory']=_0x4e219c,await _0x2c5bcf[_0x2143c4(0x547)][_0x2143c4(0xff5)](_0x1ae327),await _0x2f0b87();}catch(_0x184482){console[_0x2143c4(0x1221)](_0x2143c4(0xff3),_0x184482),await _0x1bff53('生成失败',_0x2143c4(0xf92)+_0x184482[_0x2143c4(0x86e)]);}}function _0x1e2733(){const _0x517716=_0x419fa8;_0x20cab2(),_0x5bb1f1(_0x517716(0xfbd));}function _0x20cab2(){const _0x20d601=_0x419fa8,_0x396587=document['getElementById'](_0x20d601(0xb47));_0x396587[_0x20d601(0x2f5)]='';const _0x45da02=_0x9ebf46[_0x20d601(0x547)][_0x141b83],_0x3c0d99=_0x45da02[_0x20d601(0xdb4)]||{},_0x3750cb=_0x3c0d99[_0x20d601(0x1031)]||[],_0x4ae343=_0x3c0d99[_0x20d601(0x66c)]||0x0,_0x4c9a7d=document['createElement'](_0x20d601(0x11f4));_0x4c9a7d[_0x20d601(0x5e1)][_0x20d601(0xd09)]=_0x20d601(0xad9),_0x4c9a7d[_0x20d601(0x2f5)]=_0x20d601(0x5a8)+_0x4ae343[_0x20d601(0x752)](0x2)+_0x20d601(0xeab),_0x396587['appendChild'](_0x4c9a7d);const _0x1362f2=document['createElement']('h3');_0x1362f2[_0x20d601(0xe24)]=_0x20d601(0x9ce),_0x1362f2[_0x20d601(0x5e1)][_0x20d601(0xd09)]='font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;',_0x396587[_0x20d601(0x7b9)](_0x1362f2);if(_0x3750cb['length']===0x0){_0x396587[_0x20d601(0x2f5)]+=_0x20d601(0x9b8);return;}_0x3750cb[_0x20d601(0x591)](_0x53ceea=>{const _0x341492=_0x20d601,_0x199799=document[_0x341492(0x28a)]('div');_0x199799[_0x341492(0x5e1)][_0x341492(0xd09)]=_0x341492(0x4c5),_0x199799['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>'+_0x53ceea[_0x341492(0x1108)]+_0x341492(0x11bc)+_0x53ceea['status']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥'+(_0x53ceea['price']||0x0)[_0x341492(0x752)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x396587[_0x341492(0x7b9)](_0x199799);});}async function _0x1387e3(){const _0x5d560b=_0x419fa8;if(!_0x141b83)return;const _0x12b155=_0x9ebf46[_0x5d560b(0x547)][_0x141b83];if(!_0x12b155)return;await _0x1bff53('请稍候...',_0x5d560b(0xd33)+_0x12b155['name']+_0x5d560b(0x10a7));const {proxyUrl:_0x4f5df0,apiKey:_0x572d28,model:_0x52337a}=_0x9ebf46[_0x5d560b(0x4de)];if(!_0x4f5df0||!_0x572d28||!_0x52337a){alert(_0x5d560b(0xf3c));return;}const _0x188a13=_0x9ebf46['qzoneSettings'][_0x5d560b(0x5b7)]===_0x5d560b(0x5c1)||!_0x9ebf46[_0x5d560b(0x32c)]['nickname']?'用户':_0x9ebf46[_0x5d560b(0x32c)][_0x5d560b(0x5b7)],_0xa4b519=_0x12b155[_0x5d560b(0x323)]&&_0x12b155[_0x5d560b(0x323)][_0x5d560b(0xa06)]>0x0?_0x12b155[_0x5d560b(0x323)]['map'](_0x95c66f=>_0x5d560b(0x1dc)+_0x4fcd92(_0x95c66f[_0x5d560b(0x6b5)])+')\x20'+_0x95c66f[_0x5d560b(0x53b)])[_0x5d560b(0x809)]('\x0a'):'无',_0xc64664=_0x12b155[_0x5d560b(0x1131)][_0x5d560b(0x132a)]||0xa,_0x42c27e=_0x12b155[_0x5d560b(0x8b3)][_0x5d560b(0x1044)](-_0xc64664)[_0x5d560b(0xa3b)](_0x2752fc=>(_0x2752fc[_0x5d560b(0x7fd)]===_0x5d560b(0x586)?_0x188a13:_0x12b155[_0x5d560b(0x609)])+':\x20'+String(_0x2752fc[_0x5d560b(0x53b)])[_0x5d560b(0xc34)](0x0,0x1e)+_0x5d560b(0xf66))[_0x5d560b(0x809)]('\x0a'),_0x5cb6e6=(_0x12b155[_0x5d560b(0x1131)][_0x5d560b(0x41a)]||[])[_0x5d560b(0xa3b)](_0x38b09d=>_0x9ebf46[_0x5d560b(0x1369)][_0x5d560b(0xfc3)](_0x430c5f=>_0x430c5f['id']===_0x38b09d))[_0x5d560b(0x401)](Boolean)[_0x5d560b(0xa3b)](_0x457650=>_0x5d560b(0xb37)+_0x457650[_0x5d560b(0x609)]+_0x5d560b(0x2a4)+_0x457650[_0x5d560b(0x53b)][_0x5d560b(0x401)](_0x2864a7=>_0x2864a7[_0x5d560b(0x38a)])[_0x5d560b(0xa3b)](_0x479325=>'-\x20'+_0x479325[_0x5d560b(0x53b)])['join']('\x0a'))[_0x5d560b(0x809)](''),_0x2b8332=_0xbdd100(_0x12b155,0x3,_0x5d560b(0x658)),_0x4e550c=_0xbdd100(_0x12b155,0x6,_0x5d560b(0x658)),_0x3466d5=_0xbdd100(_0x12b155,0x9,_0x5d560b(0x658)),_0x7dc5e5=_0xbdd100(_0x12b155,0x1,'days'),_0x10e16a=_0xbdd100(_0x12b155,0x3,'days'),_0x1be01a=_0xbdd100(_0x12b155,0x7,'days');let _0x27ff40='';if(_0x2b8332||_0x4e550c||_0x3466d5||_0x7dc5e5||_0x10e16a||_0x1be01a){_0x27ff40+=_0x5d560b(0x6ce);if(_0x2b8332)_0x27ff40+=_0x2b8332;if(_0x4e550c)_0x27ff40+=_0x4e550c;if(_0x3466d5)_0x27ff40+=_0x3466d5;if(_0x2b8332||_0x4e550c||_0x3466d5)_0x27ff40+='\x0a';if(_0x7dc5e5)_0x27ff40+=_0x7dc5e5;if(_0x10e16a)_0x27ff40+=_0x10e16a;if(_0x1be01a)_0x27ff40+=_0x1be01a;}const _0x254c0c=_0x5d560b(0x1176)+_0x12b155['name']+_0x5d560b(0x434)+_0x12b155[_0x5d560b(0x1131)][_0x5d560b(0xae3)]+_0x5d560b(0xc5c)+_0xa4b519+'\x0a'+_0x5cb6e6+'\x0a'+_0x27ff40+'\x0a-\x20**你最近和“'+_0x188a13+_0x5d560b(0xa83)+_0x42c27e+'\x0a\x0a现在，请开始生成这组备忘录。';try{const _0x47736b=[{'role':_0x5d560b(0x586),'content':_0x5d560b(0xf95)}];let _0x381cb8=_0x4f5df0[_0x5d560b(0x930)]('generativelanguage'),_0x2d5e65=_0x2e5c04(_0x52337a,_0x572d28,_0x254c0c,_0x47736b);const _0x40852c=_0x381cb8?await fetch(_0x2d5e65['url'],_0x2d5e65[_0x5d560b(0x100d)]):await fetch(_0x4f5df0+_0x5d560b(0x1090),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x5d560b(0x84a)+_0x572d28},'body':JSON[_0x5d560b(0xf1e)]({'model':_0x52337a,'messages':[{'role':'system','content':_0x254c0c},..._0x47736b],'temperature':_0x9ebf46['globalSettings'][_0x5d560b(0xc3d)]||0.9})});if(!_0x40852c['ok']){const _0x37b303=await _0x40852c[_0x5d560b(0x5dd)]()[_0x5d560b(0xd7f)](()=>null),_0x5ed5cb=_0x37b303?.[_0x5d560b(0x1221)]?.['message']||_0x40852c[_0x5d560b(0x399)];throw new Error(_0x5d560b(0x8ab)+_0x40852c[_0x5d560b(0xebd)]+_0x5d560b(0x23e)+_0x5ed5cb);}const _0x351ded=await _0x40852c['json'](),_0x3bbbad=getGeminiResponseText(_0x351ded),_0x4b7380=_0x3bbbad['match'](/(\[[\s\S]*\])/);if(!_0x4b7380||!_0x4b7380[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x3bbbad);const _0x1d92a1=_0x4b7380[0x0];let _0x411f1c;try{_0x411f1c=JSON[_0x5d560b(0x907)](_0x1d92a1);}catch(_0x1f047b){throw new Error('解析AI返回的JSON时出错:\x20'+_0x1f047b[_0x5d560b(0x86e)]+_0x5d560b(0xa48)+_0x3bbbad);}if(!Array['isArray'](_0x411f1c))throw new Error(_0x5d560b(0x11ff)+JSON[_0x5d560b(0xf1e)](_0x411f1c));_0x12b155[_0x5d560b(0x6e9)]=_0x411f1c[_0x5d560b(0xa3b)](_0xa6422d=>({'id':Date[_0x5d560b(0x9b7)]()+Math[_0x5d560b(0x360)](),'title':_0xa6422d[_0x5d560b(0x9f2)],'content':_0xa6422d[_0x5d560b(0x53b)]})),await _0x2c5bcf['chats']['put'](_0x12b155),await _0x70d2be();}catch(_0x28aef7){console[_0x5d560b(0x1221)](_0x5d560b(0xd4a),_0x28aef7),await _0x1bff53(_0x5d560b(0xf8d),'无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x28aef7[_0x5d560b(0x86e)]);}}async function _0x1ae910(){const _0x2e0a61=_0x419fa8;if(!_0x141b83)return;const _0x2ed001=_0x9ebf46[_0x2e0a61(0x547)][_0x141b83];if(!_0x2ed001)return;await _0x1bff53('请稍候...',_0x2e0a61(0x79b)+_0x2ed001['name']+_0x2e0a61(0x324));const {proxyUrl:_0x58f555,apiKey:_0x46b826,model:_0x289cc3}=_0x9ebf46[_0x2e0a61(0x4de)];if(!_0x58f555||!_0x46b826||!_0x289cc3){alert(_0x2e0a61(0x5da));return;}const _0x12f072=_0x9ebf46['qzoneSettings'][_0x2e0a61(0x5b7)]===_0x2e0a61(0x5c1)||!_0x9ebf46[_0x2e0a61(0x32c)][_0x2e0a61(0x5b7)]?'用户':_0x9ebf46[_0x2e0a61(0x32c)][_0x2e0a61(0x5b7)],_0x51f1b7=_0x2ed001[_0x2e0a61(0x323)]&&_0x2ed001['longTermMemory'][_0x2e0a61(0xa06)]>0x0?_0x2ed001[_0x2e0a61(0x323)][_0x2e0a61(0xa3b)](_0x10dcdc=>'-\x20(记录于\x20'+_0x4fcd92(_0x10dcdc[_0x2e0a61(0x6b5)])+')\x20'+_0x10dcdc[_0x2e0a61(0x53b)])['join']('\x0a'):'无',_0x1b25a6=_0x2ed001[_0x2e0a61(0x1131)][_0x2e0a61(0x132a)]||0xa,_0x4c56bf=_0x2ed001[_0x2e0a61(0x8b3)][_0x2e0a61(0x1044)](-_0x1b25a6)['map'](_0x108a4b=>(_0x108a4b[_0x2e0a61(0x7fd)]===_0x2e0a61(0x586)?_0x12f072:_0x2ed001[_0x2e0a61(0x609)])+':\x20'+String(_0x108a4b[_0x2e0a61(0x53b)])['substring'](0x0,0x1e)+_0x2e0a61(0xf66))['join']('\x0a'),_0x37a8f8=(_0x2ed001[_0x2e0a61(0x1131)][_0x2e0a61(0x41a)]||[])['map'](_0x3a4e2e=>_0x9ebf46['worldBooks'][_0x2e0a61(0xfc3)](_0x259f2c=>_0x259f2c['id']===_0x3a4e2e))[_0x2e0a61(0x401)](Boolean)[_0x2e0a61(0xa3b)](_0x293522=>_0x2e0a61(0xb37)+_0x293522[_0x2e0a61(0x609)]+_0x2e0a61(0x2a4)+_0x293522[_0x2e0a61(0x53b)][_0x2e0a61(0x401)](_0x543ff4=>_0x543ff4[_0x2e0a61(0x38a)])[_0x2e0a61(0xa3b)](_0x25faca=>'-\x20'+_0x25faca[_0x2e0a61(0x53b)])[_0x2e0a61(0x809)]('\x0a'))['join'](''),_0x20662c=_0xbdd100(_0x2ed001,0x3,_0x2e0a61(0x658)),_0x56216e=_0xbdd100(_0x2ed001,0x6,_0x2e0a61(0x658)),_0xc15abb=_0xbdd100(_0x2ed001,0x9,'hours'),_0x3a6797=_0xbdd100(_0x2ed001,0x1,_0x2e0a61(0x929)),_0x448e75=_0xbdd100(_0x2ed001,0x3,_0x2e0a61(0x929)),_0x345ecc=_0xbdd100(_0x2ed001,0x7,_0x2e0a61(0x929));let _0x4262ec='';if(_0x20662c||_0x56216e||_0xc15abb||_0x3a6797||_0x448e75||_0x345ecc){_0x4262ec+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x20662c)_0x4262ec+=_0x20662c;if(_0x56216e)_0x4262ec+=_0x56216e;if(_0xc15abb)_0x4262ec+=_0xc15abb;if(_0x20662c||_0x56216e||_0xc15abb)_0x4262ec+='\x0a';if(_0x3a6797)_0x4262ec+=_0x3a6797;if(_0x448e75)_0x4262ec+=_0x448e75;if(_0x345ecc)_0x4262ec+=_0x345ecc;}const _0x7e1e9b=_0x2e0a61(0x1176)+_0x2ed001[_0x2e0a61(0x609)]+_0x2e0a61(0xbe2)+new Date()['toISOString']()+_0x2e0a61(0x794)+_0x2ed001[_0x2e0a61(0x1131)][_0x2e0a61(0xae3)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0x51f1b7+'\x0a'+_0x37a8f8+'\x0a'+_0x4262ec+'\x0a-\x20**你最近和“'+_0x12f072+_0x2e0a61(0xa83)+_0x4c56bf+_0x2e0a61(0x10da);try{const _0x4d1f2f=[{'role':'user','content':_0x2e0a61(0x594)}];let _0x48afaa=_0x58f555['includes'](_0x2e0a61(0xb23)),_0x120c9b=_0x2e5c04(_0x289cc3,_0x46b826,_0x7e1e9b,_0x4d1f2f);const _0x556bab=_0x48afaa?await fetch(_0x120c9b[_0x2e0a61(0x11be)],_0x120c9b[_0x2e0a61(0x100d)]):await fetch(_0x58f555+'/v1/chat/completions',{'method':_0x2e0a61(0x116f),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x46b826},'body':JSON[_0x2e0a61(0xf1e)]({'model':_0x289cc3,'messages':[{'role':'system','content':_0x7e1e9b},..._0x4d1f2f],'temperature':_0x9ebf46[_0x2e0a61(0x1383)][_0x2e0a61(0xc3d)]||0.9})});if(!_0x556bab['ok'])throw new Error(_0x2e0a61(0x8ab)+_0x556bab[_0x2e0a61(0x399)]);const _0x6db3d=await _0x556bab['json'](),_0x3e15da=getGeminiResponseText(_0x6db3d),_0x1ea718=_0x3e15da['match'](/(\[[\s\S]*\])/);if(!_0x1ea718||!_0x1ea718[0x0])throw new Error(_0x2e0a61(0x9c5)+_0x3e15da);const _0x3f23fe=_0x1ea718[0x0];let _0x4d8baf;try{_0x4d8baf=JSON[_0x2e0a61(0x907)](_0x3f23fe);}catch(_0x1058c7){throw new Error(_0x2e0a61(0x1093)+_0x1058c7[_0x2e0a61(0x86e)]+_0x2e0a61(0xa48)+_0x3e15da);}_0x2ed001[_0x2e0a61(0x12e5)]=_0x4d8baf,await _0x2c5bcf[_0x2e0a61(0x547)][_0x2e0a61(0xff5)](_0x2ed001),await _0x4cf63d();}catch(_0x5ca2f5){console['error'](_0x2e0a61(0xa7f),_0x5ca2f5),await _0x1bff53(_0x2e0a61(0xf8d),_0x2e0a61(0x12c0)+_0x5ca2f5['message']);}}function _0x4cf63d(){const _0x1959ce=_0x419fa8,_0x2b333a=document[_0x1959ce(0x9c8)](_0x1959ce(0x21d));_0x2b333a['innerHTML']='';if(!_0x141b83)return;const _0x474d9c=_0x9ebf46[_0x1959ce(0x547)][_0x141b83],_0x42b097=_0x474d9c[_0x1959ce(0x12e5)]||[];if(_0x42b097['length']===0x0){_0x2b333a[_0x1959ce(0x2f5)]=_0x1959ce(0x184);return;}_0x42b097[_0x1959ce(0x591)](_0x411e23=>{const _0x17bd3d=_0x1959ce,_0x127faf=document[_0x17bd3d(0x28a)](_0x17bd3d(0x11f4));_0x127faf[_0x17bd3d(0x82c)]=_0x17bd3d(0x26f);let _0x1b0b89='';if(_0x411e23[_0x17bd3d(0xd73)]){const _0x3cdba3=_0x17bd3d(0x12d5)+encodeURIComponent(_0x411e23[_0x17bd3d(0xd73)]);_0x1b0b89=_0x17bd3d(0x10bf)+_0x3cdba3+_0x17bd3d(0xff7)+_0x411e23['comment']+'\x22></div>';}const _0x3e1e88=_0x411e23['timestamp']?_0x4fcd92(new Date(_0x411e23[_0x17bd3d(0x6b5)])[_0x17bd3d(0xb03)]()):'某个时间';_0x127faf[_0x17bd3d(0x2f5)]=_0x17bd3d(0x1c0)+_0x411e23[_0x17bd3d(0x1d2)]+_0x17bd3d(0x4d3)+_0x411e23[_0x17bd3d(0xffc)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>'+_0x411e23[_0x17bd3d(0x10de)][_0x17bd3d(0x459)](/\n/g,_0x17bd3d(0x10d9))+_0x17bd3d(0xec9)+_0x1b0b89+_0x17bd3d(0x44c)+_0x3e1e88+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2b333a['appendChild'](_0x127faf);});}async function _0x1027b4(){const _0x2b94bd=_0x419fa8;if(!_0x141b83)return;const _0x38a419=_0x9ebf46['chats'][_0x141b83];if(!_0x38a419)return;await _0x1bff53('请稍候...',_0x2b94bd(0x85d)+_0x38a419[_0x2b94bd(0x609)]+_0x2b94bd(0x6ee));const {proxyUrl:_0xfcee7a,apiKey:_0x263c5d,model:_0x4b491a}=_0x9ebf46['apiConfig'];if(!_0xfcee7a||!_0x263c5d||!_0x4b491a){alert('API未配置，无法生成内容。');return;}const _0x3b7e1b=_0x9ebf46[_0x2b94bd(0x32c)]['nickname']===_0x2b94bd(0x5c1)||!_0x9ebf46[_0x2b94bd(0x32c)]['nickname']?'用户':_0x9ebf46['qzoneSettings'][_0x2b94bd(0x5b7)],_0x15f075=_0x38a419[_0x2b94bd(0x323)]&&_0x38a419['longTermMemory'][_0x2b94bd(0xa06)]>0x0?_0x38a419['longTermMemory'][_0x2b94bd(0xa3b)](_0x5dd14a=>'-\x20(记录于\x20'+_0x4fcd92(_0x5dd14a[_0x2b94bd(0x6b5)])+')\x20'+_0x5dd14a[_0x2b94bd(0x53b)])[_0x2b94bd(0x809)]('\x0a'):'无',_0x36e6ce=_0x38a419[_0x2b94bd(0x1131)]['maxMemory']||0xa,_0x3ec550=_0x38a419[_0x2b94bd(0x8b3)][_0x2b94bd(0x1044)](-_0x36e6ce)[_0x2b94bd(0xa3b)](_0x497e27=>(_0x497e27[_0x2b94bd(0x7fd)]===_0x2b94bd(0x586)?_0x3b7e1b:_0x38a419[_0x2b94bd(0x609)])+':\x20'+String(_0x497e27[_0x2b94bd(0x53b)])[_0x2b94bd(0xc34)](0x0,0x1e)+'...')[_0x2b94bd(0x809)]('\x0a'),_0x38cc2b=(_0x38a419[_0x2b94bd(0x1131)][_0x2b94bd(0x41a)]||[])['map'](_0x418289=>_0x9ebf46[_0x2b94bd(0x1369)][_0x2b94bd(0xfc3)](_0x5856fe=>_0x5856fe['id']===_0x418289))['filter'](Boolean)[_0x2b94bd(0xa3b)](_0xdeab53=>'\x0a##\x20世界书《'+_0xdeab53[_0x2b94bd(0x609)]+_0x2b94bd(0x2a4)+_0xdeab53['content'][_0x2b94bd(0x401)](_0x448d45=>_0x448d45['enabled'])[_0x2b94bd(0xa3b)](_0x5a13dc=>'-\x20'+_0x5a13dc[_0x2b94bd(0x53b)])['join']('\x0a'))[_0x2b94bd(0x809)](''),_0x45b1f6=_0xbdd100(_0x38a419,0x3,_0x2b94bd(0x658)),_0x1d86ed=_0xbdd100(_0x38a419,0x6,_0x2b94bd(0x658)),_0x29cea3=_0xbdd100(_0x38a419,0x9,_0x2b94bd(0x658)),_0x506e04=_0xbdd100(_0x38a419,0x1,'days'),_0x45ee23=_0xbdd100(_0x38a419,0x3,'days'),_0x141c75=_0xbdd100(_0x38a419,0x7,_0x2b94bd(0x929));let _0x43a3e4='';if(_0x45b1f6||_0x1d86ed||_0x29cea3||_0x506e04||_0x45ee23||_0x141c75){_0x43a3e4+=_0x2b94bd(0x6ce);if(_0x45b1f6)_0x43a3e4+=_0x45b1f6;if(_0x1d86ed)_0x43a3e4+=_0x1d86ed;if(_0x29cea3)_0x43a3e4+=_0x29cea3;if(_0x45b1f6||_0x1d86ed||_0x29cea3)_0x43a3e4+='\x0a';if(_0x506e04)_0x43a3e4+=_0x506e04;if(_0x45ee23)_0x43a3e4+=_0x45ee23;if(_0x141c75)_0x43a3e4+=_0x141c75;}const _0x1ee55d='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x38a419[_0x2b94bd(0x609)]+_0x2b94bd(0xc67)+_0x38a419[_0x2b94bd(0x1131)][_0x2b94bd(0xae3)]+_0x2b94bd(0xc5c)+_0x15f075+'\x0a'+_0x38cc2b+'\x0a'+_0x43a3e4+_0x2b94bd(0xf19)+_0x3b7e1b+_0x2b94bd(0xa83)+_0x3ec550+_0x2b94bd(0x525);try{const _0x5a74dd=[{'role':_0x2b94bd(0x586),'content':_0x2b94bd(0x674)}];let _0x52ae5b=_0xfcee7a[_0x2b94bd(0x930)](_0x2b94bd(0xb23)),_0x3c2451=_0x2e5c04(_0x4b491a,_0x263c5d,_0x1ee55d,_0x5a74dd);const _0x3252a2=_0x52ae5b?await fetch(_0x3c2451[_0x2b94bd(0x11be)],_0x3c2451['data']):await fetch(_0xfcee7a+_0x2b94bd(0x1090),{'method':'POST','headers':{'Content-Type':_0x2b94bd(0x698),'Authorization':_0x2b94bd(0x84a)+_0x263c5d},'body':JSON['stringify']({'model':_0x4b491a,'messages':[{'role':'system','content':_0x1ee55d},..._0x5a74dd],'temperature':_0x9ebf46['globalSettings'][_0x2b94bd(0xc3d)]||0.9})});if(!_0x3252a2['ok'])throw new Error('API\x20错误:\x20'+_0x3252a2[_0x2b94bd(0x399)]);const _0x4c1c76=await _0x3252a2[_0x2b94bd(0x5dd)](),_0x3d1011=getGeminiResponseText(_0x4c1c76),_0x2a4dd8=_0x3d1011['replace'](/^```json\s*/,'')[_0x2b94bd(0x459)](/```$/,''),_0x4fd974=JSON['parse'](_0x2a4dd8);_0x38a419['simulatedAppUsage']=_0x4fd974,await _0x2c5bcf[_0x2b94bd(0x547)][_0x2b94bd(0xff5)](_0x38a419),await _0x4f3eed();}catch(_0x3fe93a){console[_0x2b94bd(0x1221)]('生成模拟App使用记录失败:',_0x3fe93a),await _0x1bff53(_0x2b94bd(0xf8d),'无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x3fe93a[_0x2b94bd(0x86e)]);}}function _0x4f3eed(){const _0x3d7cac=_0x419fa8,_0x44db45=document[_0x3d7cac(0x9c8)](_0x3d7cac(0xacc));_0x44db45[_0x3d7cac(0x2f5)]='';if(!_0x141b83)return;const _0x21fe88=_0x9ebf46[_0x3d7cac(0x547)][_0x141b83],_0x4677dc=(_0x21fe88[_0x3d7cac(0x753)]||[])[_0x3d7cac(0x66b)]((_0x27ce3e,_0x164953)=>_0x164953['usageTimeMinutes']-_0x27ce3e[_0x3d7cac(0x1e6)]);if(_0x4677dc[_0x3d7cac(0xa06)]===0x0){_0x44db45['innerHTML']=_0x3d7cac(0x1013);return;}_0x4677dc[_0x3d7cac(0x591)](_0xed569e=>{const _0x5bccb7=_0x3d7cac,_0x205c0a=document[_0x5bccb7(0x28a)]('div');_0x205c0a['className']='char-usage-item';const _0x39b624=Math[_0x5bccb7(0x5fb)](_0xed569e['usageTimeMinutes']/0x3c),_0x54fe63=_0xed569e[_0x5bccb7(0x1e6)]%0x3c;let _0x5a74c4='';if(_0x39b624>0x0)_0x5a74c4+=_0x39b624+'小时';if(_0x54fe63>0x0)_0x5a74c4+=_0x54fe63+'分钟';if(!_0x5a74c4)_0x5a74c4=_0x5bccb7(0x6c3);const _0x1d4c44=_0xed569e[_0x5bccb7(0xd73)]||_0x5bccb7(0x567)+_0xed569e[_0x5bccb7(0x2d0)]+_0x5bccb7(0xacd),_0x51420e=_0x5bccb7(0x12d5)+encodeURIComponent(_0x1d4c44);_0x205c0a[_0x5bccb7(0x2f5)]=_0x5bccb7(0x5d1)+_0x51420e+_0x5bccb7(0x103e)+_0xed569e[_0x5bccb7(0x2d0)]+_0x5bccb7(0x13a0)+_0xed569e[_0x5bccb7(0xf08)]+_0x5bccb7(0x45e)+_0x5a74c4+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x44db45[_0x5bccb7(0x7b9)](_0x205c0a);});}async function _0x1ca338(){const _0x45c630=_0x419fa8;if(!_0x141b83)return;const _0x5a7096=_0x9ebf46[_0x45c630(0x547)][_0x141b83];if(!_0x5a7096)return;await _0x1bff53(_0x45c630(0x7a4),_0x45c630(0xd33)+_0x5a7096[_0x45c630(0x609)]+'”分享TA的私人歌单...');const {proxyUrl:_0x409af6,apiKey:_0xb11cb8,model:_0x541405}=_0x9ebf46[_0x45c630(0x4de)];if(!_0x409af6||!_0xb11cb8||!_0x541405){alert(_0x45c630(0xf3c));return;}const _0x5b5ad4=_0x9ebf46['qzoneSettings'][_0x45c630(0x5b7)]===_0x45c630(0x5c1)||!_0x9ebf46['qzoneSettings'][_0x45c630(0x5b7)]?'用户':_0x9ebf46[_0x45c630(0x32c)][_0x45c630(0x5b7)],_0x106610=_0x5a7096[_0x45c630(0x323)]&&_0x5a7096[_0x45c630(0x323)]['length']>0x0?_0x5a7096[_0x45c630(0x323)][_0x45c630(0xa3b)](_0x210afe=>_0x45c630(0x1dc)+_0x4fcd92(_0x210afe[_0x45c630(0x6b5)])+')\x20'+_0x210afe['content'])[_0x45c630(0x809)]('\x0a'):'无',_0x120896=_0x5a7096['settings'][_0x45c630(0x132a)]||0xa,_0x1183a0=_0x5a7096[_0x45c630(0x8b3)][_0x45c630(0x1044)](-_0x120896)['map'](_0x4c33b2=>(_0x4c33b2['role']===_0x45c630(0x586)?_0x5b5ad4:_0x5a7096[_0x45c630(0x609)])+':\x20'+String(_0x4c33b2[_0x45c630(0x53b)])[_0x45c630(0xc34)](0x0,0x1e)+_0x45c630(0xf66))['join']('\x0a'),_0x1d39bc=(_0x5a7096['settings'][_0x45c630(0x41a)]||[])[_0x45c630(0xa3b)](_0x19ab77=>_0x9ebf46[_0x45c630(0x1369)][_0x45c630(0xfc3)](_0x130962=>_0x130962['id']===_0x19ab77))[_0x45c630(0x401)](Boolean)[_0x45c630(0xa3b)](_0x5ab655=>_0x45c630(0xb37)+_0x5ab655[_0x45c630(0x609)]+'》设定:\x0a'+_0x5ab655['content'][_0x45c630(0x401)](_0x51a226=>_0x51a226[_0x45c630(0x38a)])['map'](_0x5890da=>'-\x20'+_0x5890da[_0x45c630(0x53b)])[_0x45c630(0x809)]('\x0a'))[_0x45c630(0x809)](''),_0x43e5bb=_0x45c630(0xb00)+_0x5a7096[_0x45c630(0x609)]+'”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x5a7096[_0x45c630(0x1131)][_0x45c630(0xae3)]+_0x45c630(0xc5c)+_0x106610+'\x0a'+_0x1d39bc+_0x45c630(0xf19)+_0x5b5ad4+_0x45c630(0xa83)+_0x1183a0+'\x0a\x0a现在，请生成这份歌单。';try{const _0x4907f9=[{'role':'user','content':_0x45c630(0x91b)}];let _0x2b5000=_0x409af6[_0x45c630(0x930)](_0x45c630(0xb23)),_0x5c1afa=_0x2e5c04(_0x541405,_0xb11cb8,_0x43e5bb,_0x4907f9);const _0x4ac92b=_0x2b5000?await fetch(_0x5c1afa['url'],_0x5c1afa[_0x45c630(0x100d)]):await fetch(_0x409af6+_0x45c630(0x1090),{'method':_0x45c630(0x116f),'headers':{'Content-Type':_0x45c630(0x698),'Authorization':_0x45c630(0x84a)+_0xb11cb8},'body':JSON[_0x45c630(0xf1e)]({'model':_0x541405,'messages':[{'role':_0x45c630(0xb64),'content':_0x43e5bb},..._0x4907f9],'temperature':_0x9ebf46[_0x45c630(0x1383)]['apiTemperature']||0x1})});if(!_0x4ac92b['ok'])throw new Error(_0x45c630(0x8ab)+_0x4ac92b[_0x45c630(0x399)]);const _0x11ad90=await _0x4ac92b['json'](),_0x3daa69=getGeminiResponseText(_0x11ad90),_0x277951=_0x3daa69[_0x45c630(0x459)](/^```json\s*/,'')['replace'](/```$/,''),_0x56601c=JSON[_0x45c630(0x907)](_0x277951);await _0x1bff53('请稍候...',_0x45c630(0xfdc)+_0x56601c[_0x45c630(0xa06)]+_0x45c630(0x65e));const _0x45e674=_0x56601c[_0x45c630(0xa3b)](async _0xacd278=>{const _0x42c21d=_0x45c630;let _0x3ba38f=await _0x49d60b(_0xacd278[_0x42c21d(0x672)],_0xacd278['artistName']);(!_0x3ba38f||_0x3ba38f[_0x42c21d(0xa06)]===0x0)&&(_0x3ba38f=await _0x2b9fc9(_0xacd278[_0x42c21d(0x672)]));if(_0x3ba38f[_0x42c21d(0xa06)]>0x0)return _0x4e7b18(_0x3ba38f[0x0]);return console[_0x42c21d(0x453)](_0x42c21d(0xb29)+_0xacd278['songName']+_0x42c21d(0x23e)+_0xacd278[_0x42c21d(0x11f8)]+'”'),null;}),_0x3f62e4=(await Promise[_0x45c630(0xd0a)](_0x45e674))[_0x45c630(0x401)](Boolean);_0x5a7096[_0x45c630(0x440)]=_0x3f62e4,await _0x2c5bcf[_0x45c630(0x547)][_0x45c630(0xff5)](_0x5a7096),await _0xdb04eb();}catch(_0x4cc0d2){console[_0x45c630(0x1221)]('生成模拟歌单失败:',_0x4cc0d2),await _0x1bff53(_0x45c630(0xf8d),'无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20'+_0x4cc0d2['message']);}}function _0xdb04eb(){const _0x50d92b=_0x419fa8,_0x4ce52d=document[_0x50d92b(0x9c8)](_0x50d92b(0x4c6));_0x4ce52d[_0x50d92b(0x2f5)]='';if(!_0x141b83)return;const _0x14a910=_0x9ebf46[_0x50d92b(0x547)][_0x141b83],_0x1f3794=_0x14a910[_0x50d92b(0x440)]||[];if(_0x1f3794[_0x50d92b(0xa06)]===0x0){_0x4ce52d['innerHTML']=_0x50d92b(0x548);return;}_0x1f3794[_0x50d92b(0x591)]((_0x4a2f89,_0x392c3f)=>{const _0x23e818=_0x50d92b,_0xc0fb62=document[_0x23e818(0x28a)](_0x23e818(0x11f4));_0xc0fb62['className']='char-music-item',_0xc0fb62[_0x23e818(0x2f5)]=_0x23e818(0xc78)+_0x4a2f89[_0x23e818(0x669)]+_0x23e818(0x445)+_0x4a2f89[_0x23e818(0x609)]+_0x23e818(0xb4d)+_0x4a2f89['artist']+_0x23e818(0x13a9),_0xc0fb62[_0x23e818(0xa0f)]('click',()=>_0xe65a1a(_0x4a2f89)),_0x4ce52d[_0x23e818(0x7b9)](_0xc0fb62);});}let _0x4daa5b={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':_0x419fa8(0x26e),'lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0xe65a1a(_0x5d9214){const _0x1db801=_0x419fa8,_0x2ff671=document[_0x1db801(0x9c8)]('char-audio-player'),_0x2d8b5f=document[_0x1db801(0x9c8)]('char-music-player-modal');if(_0x4daa5b['lrcUpdateInterval'])clearInterval(_0x4daa5b['lrcUpdateInterval']);_0x2ff671[_0x1db801(0x6f2)]();const _0x22e8f6=_0x4daa5b[_0x1db801(0x66a)][_0x1db801(0x684)](_0x24735b=>_0x24735b[_0x1db801(0xbf4)]===_0x5d9214[_0x1db801(0xbf4)]);_0x22e8f6>-0x1?_0x4daa5b[_0x1db801(0xcc8)]=_0x22e8f6:(_0x4daa5b['currentPlaylist']=[_0x5d9214],_0x4daa5b[_0x1db801(0xcc8)]=0x0);document[_0x1db801(0x9c8)](_0x1db801(0xb6b))[_0x1db801(0xe24)]=_0x5d9214[_0x1db801(0x609)],document[_0x1db801(0x9c8)](_0x1db801(0x241))[_0x1db801(0xe24)]=_0x5d9214[_0x1db801(0xc14)],document[_0x1db801(0x9c8)](_0x1db801(0x633))['src']=_0x5d9214[_0x1db801(0x669)],_0x4daa5b['parsedLyrics']=_0x52e008(_0x5d9214[_0x1db801(0x725)]||''),_0x58d11b();if(_0x5d9214[_0x1db801(0x306)]){const _0x9089a4=new Blob([_0x5d9214['src']],{'type':_0x5d9214[_0x1db801(0xec8)]||_0x1db801(0xa47)});_0x2ff671['src']=URL[_0x1db801(0x5bb)](_0x9089a4);}else _0x2ff671[_0x1db801(0xbf4)]=_0x5d9214[_0x1db801(0xbf4)];_0x2ff671[_0x1db801(0xcc3)]()[_0x1db801(0xd7f)](_0x582681=>console[_0x1db801(0x1221)](_0x1db801(0xe1d),_0x582681)),_0x2ff671[_0x1db801(0x6ab)]=()=>{const _0x1fe513=_0x1db801;document[_0x1fe513(0x9c8)](_0x1fe513(0x869))[_0x1fe513(0xe24)]=_0x16e9be(_0x2ff671[_0x1fe513(0xa24)]),_0x4daa5b['lrcUpdateInterval']=setInterval(_0x35de85,0x1f4);},_0x2d8b5f[_0x1db801(0x575)][_0x1db801(0x68e)]('visible');}function _0x23422f(){const _0x123324=_0x419fa8,_0x29d7ac=document[_0x123324(0x9c8)](_0x123324(0x9e0)),_0x2e6e18=document[_0x123324(0x9c8)](_0x123324(0xeb4));if(_0x4daa5b['lrcUpdateInterval'])clearInterval(_0x4daa5b[_0x123324(0x2ff)]);_0x2e6e18[_0x123324(0x6f2)](),_0x2e6e18[_0x123324(0xbf4)]='',_0x29d7ac[_0x123324(0x575)][_0x123324(0x30f)](_0x123324(0xc3f)),_0x4daa5b[_0x123324(0x50c)]=![],document[_0x123324(0x9c8)](_0x123324(0x185))[_0x123324(0x575)]['remove']('spinning');}function _0x35de85(){const _0x301537=_0x419fa8,_0x519c3d=document[_0x301537(0x9c8)](_0x301537(0xeb4));if(!_0x519c3d[_0x301537(0xa24)])return;const _0x336914=_0x519c3d[_0x301537(0x117d)],_0x1a3c1b=_0x519c3d[_0x301537(0xa24)];document['getElementById'](_0x301537(0x8a0))[_0x301537(0x5e1)]['width']=_0x336914/_0x1a3c1b*0x64+'%',document['getElementById']('char-music-current-time')['textContent']=_0x16e9be(_0x336914),_0x31b622(_0x336914);}function _0x58d11b(){const _0x1f2ceb=_0x419fa8,_0x4e31fb=document[_0x1f2ceb(0x9c8)](_0x1f2ceb(0xdb3));_0x4e31fb[_0x1f2ceb(0x2f5)]='',_0x4daa5b[_0x1f2ceb(0x114b)]=-0x1;if(!_0x4daa5b['parsedLyrics']||_0x4daa5b[_0x1f2ceb(0x109a)][_0x1f2ceb(0xa06)]===0x0){_0x4e31fb[_0x1f2ceb(0x2f5)]=_0x1f2ceb(0xa8c);return;}_0x4daa5b[_0x1f2ceb(0x109a)]['forEach']((_0x1ba2c9,_0x549182)=>{const _0x4e27d8=_0x1f2ceb,_0x44643c=document[_0x4e27d8(0x28a)]('p');_0x44643c[_0x4e27d8(0xe24)]=_0x1ba2c9[_0x4e27d8(0xbb7)],_0x44643c[_0x4e27d8(0xc9f)]['index']=_0x549182,_0x4e31fb[_0x4e27d8(0x7b9)](_0x44643c);});}function _0x31b622(_0x35fd6a){const _0x5ef168=_0x419fa8,_0x29a2e4=_0x4daa5b[_0x5ef168(0x109a)];if(_0x29a2e4['length']===0x0)return;let _0x406c81=-0x1;for(let _0x13f928=0x0;_0x13f928<_0x29a2e4[_0x5ef168(0xa06)];_0x13f928++){if(_0x35fd6a>=_0x29a2e4[_0x13f928][_0x5ef168(0x13be)])_0x406c81=_0x13f928;else break;}if(_0x406c81===_0x4daa5b[_0x5ef168(0x114b)])return;_0x4daa5b[_0x5ef168(0x114b)]=_0x406c81;const _0x27692a=document['getElementById'](_0x5ef168(0xdb3)),_0x31db9e=_0x27692a[_0x5ef168(0x7e4)]('p');_0x31db9e[_0x5ef168(0x591)](_0x38a297=>_0x38a297[_0x5ef168(0x575)][_0x5ef168(0x30f)](_0x5ef168(0x113d)));if(_0x406c81>-0x1){const _0x324136=_0x27692a[_0x5ef168(0x91d)](_0x5ef168(0x839)+_0x406c81+'\x22]');if(_0x324136){_0x324136['classList'][_0x5ef168(0x68e)](_0x5ef168(0x113d));const _0x5eaaf3=_0x27692a['clientHeight']/0x2-_0x324136['offsetTop']-_0x324136[_0x5ef168(0x559)]/0x2;_0x31db9e[_0x5ef168(0x591)](_0x19077c=>{const _0x44cf60=_0x5ef168;_0x19077c['style'][_0x44cf60(0xf57)]=_0x44cf60(0xdbd)+_0x5eaaf3+_0x44cf60(0x10b5);});}}}function _0x4a9d7e(){const _0x59251a=_0x419fa8;if(_0x4daa5b[_0x59251a(0x66a)]['length']===0x0)return;let _0x15ac52;switch(_0x4daa5b[_0x59251a(0x10ca)]){case _0x59251a(0x360):_0x15ac52=Math['floor'](Math[_0x59251a(0x360)]()*_0x4daa5b[_0x59251a(0x66a)][_0x59251a(0xa06)]);break;case'single':_0xe65a1a(_0x4daa5b[_0x59251a(0x66a)][_0x4daa5b['currentIndex']]);return;case _0x59251a(0x26e):default:_0x15ac52=(_0x4daa5b[_0x59251a(0xcc8)]+0x1)%_0x4daa5b[_0x59251a(0x66a)]['length'];break;}_0xe65a1a(_0x4daa5b[_0x59251a(0x66a)][_0x15ac52]);}function _0x426806(){const _0x56be22=_0x419fa8;if(_0x4daa5b[_0x56be22(0x66a)][_0x56be22(0xa06)]===0x0)return;const _0x29acfb=(_0x4daa5b['currentIndex']-0x1+_0x4daa5b[_0x56be22(0x66a)][_0x56be22(0xa06)])%_0x4daa5b[_0x56be22(0x66a)][_0x56be22(0xa06)];_0xe65a1a(_0x4daa5b[_0x56be22(0x66a)][_0x29acfb]);}function _0x1e6a18(){const _0x52ebb7=_0x419fa8,_0x4216fa=[_0x52ebb7(0x26e),_0x52ebb7(0x360),_0x52ebb7(0x6af)],_0x2d10b4=_0x4216fa[_0x52ebb7(0x78e)](_0x4daa5b[_0x52ebb7(0x10ca)]);_0x4daa5b[_0x52ebb7(0x10ca)]=_0x4216fa[(_0x2d10b4+0x1)%_0x4216fa['length']],document[_0x52ebb7(0x9c8)](_0x52ebb7(0x3cb))[_0x52ebb7(0xe24)]={'order':'顺序','random':'随机','single':'单曲'}[_0x4daa5b['playMode']];}function _0x43c581(){const _0x2674ba=_0x419fa8,_0x2a8e2e=document[_0x2674ba(0x9c8)](_0x2674ba(0xeb4)),_0x29b866=document[_0x2674ba(0x9c8)](_0x2674ba(0x6bd)),_0x2394cc=document[_0x2674ba(0x9c8)](_0x2674ba(0x185));_0x29b866['addEventListener'](_0x2674ba(0xf5c),()=>{const _0x1c0df6=_0x2674ba;if(_0x2a8e2e['paused']){if(_0x4daa5b['currentIndex']>-0x1)_0x2a8e2e[_0x1c0df6(0xcc3)]();}else _0x2a8e2e[_0x1c0df6(0x6f2)]();}),_0x2a8e2e[_0x2674ba(0x3ae)]=()=>{const _0x3d23ce=_0x2674ba;_0x29b866[_0x3d23ce(0x2f5)]=_0x3d23ce(0x424),_0x2394cc[_0x3d23ce(0x575)][_0x3d23ce(0x68e)](_0x3d23ce(0xfba)),_0x4daa5b[_0x3d23ce(0x50c)]=!![];},_0x2a8e2e[_0x2674ba(0xea1)]=()=>{const _0x33c3b1=_0x2674ba;_0x29b866['innerHTML']=_0x33c3b1(0x1104),_0x2394cc[_0x33c3b1(0x575)][_0x33c3b1(0x30f)](_0x33c3b1(0xfba)),_0x4daa5b['isPlaying']=![];},_0x2a8e2e[_0x2674ba(0x4b0)]=()=>{const _0x333673=_0x2674ba;_0x2394cc['classList'][_0x333673(0x30f)](_0x333673(0xfba)),_0x4daa5b['isPlaying']=![],_0x4a9d7e();},document['getElementById'](_0x2674ba(0x7e0))[_0x2674ba(0xa0f)]('click',_0x426806),document[_0x2674ba(0x9c8)](_0x2674ba(0x5bf))[_0x2674ba(0xa0f)](_0x2674ba(0xf5c),_0x4a9d7e),document[_0x2674ba(0x9c8)](_0x2674ba(0x3cb))[_0x2674ba(0xa0f)]('click',_0x1e6a18),document[_0x2674ba(0x9c8)](_0x2674ba(0x2c9))[_0x2674ba(0xa0f)](_0x2674ba(0xf5c),_0x2bb91b=>{const _0x20e507=_0x2674ba;if(!_0x2a8e2e[_0x20e507(0xa24)])return;const _0x38a8bf=_0x2bb91b['currentTarget'],_0x31b572=_0x2bb91b['offsetX'];_0x2a8e2e[_0x20e507(0x117d)]=_0x31b572/_0x38a8bf['clientWidth']*_0x2a8e2e[_0x20e507(0xa24)];});}async function _0x30f476(){const _0x5647b3=_0x419fa8,_0x58b2e6=document['getElementById']('douban-posts-list');_0x58b2e6[_0x5647b3(0x2f5)]='';const _0x9f1693=await _0x2c5bcf[_0x5647b3(0x8af)][_0x5647b3(0x8ea)](_0x5647b3(0x6b5))[_0x5647b3(0x101e)]()['toArray']();if(_0x9f1693['length']===0x0){_0x58b2e6[_0x5647b3(0x2f5)]=_0x5647b3(0x1fe);return;}_0x9f1693[_0x5647b3(0x591)](_0x1dfad3=>{const _0x41813f=_0x5647b3;let _0x5cb600;const _0x10e04f=_0x1dfad3[_0x41813f(0x12ec)]?Object[_0x41813f(0xeb2)](_0x9ebf46[_0x41813f(0x547)])['find'](_0x54763e=>!_0x54763e['isGroup']&&_0x54763e[_0x41813f(0x609)]===_0x1dfad3[_0x41813f(0x12ec)]):null;if(_0x10e04f)_0x5cb600=_0x10e04f[_0x41813f(0x1131)][_0x41813f(0xd4d)];else{const _0x4c8e4d=Object[_0x41813f(0xeb2)](_0x9ebf46[_0x41813f(0x547)])[_0x41813f(0xfc3)](_0x481d30=>!_0x481d30[_0x41813f(0x11e4)]&&_0x481d30[_0x41813f(0x609)]===_0x1dfad3[_0x41813f(0xa2c)]);if(_0x4c8e4d)_0x5cb600=_0x4c8e4d[_0x41813f(0x1131)][_0x41813f(0xd4d)];else _0x1dfad3[_0x41813f(0x8b7)]?_0x5cb600=_0x41813f(0x12d5)+encodeURIComponent(_0x1dfad3[_0x41813f(0x8b7)]):_0x5cb600=_0x246753;}const _0x44be28=document['createElement'](_0x41813f(0x11f4));_0x44be28[_0x41813f(0x82c)]='douban-post-item',_0x44be28[_0x41813f(0x2fa)]=()=>_0x551da5(_0x1dfad3['id']),_0x44be28[_0x41813f(0x2f5)]=_0x41813f(0x1351)+_0x5cb600+_0x41813f(0xe35)+_0x1dfad3[_0x41813f(0xa2c)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20'+_0x1dfad3[_0x41813f(0x9a6)]+_0x41813f(0x1201)+_0x1dfad3['postTitle']+_0x41813f(0xb06)+_0x1dfad3['content'][_0x41813f(0x459)](/\n/g,_0x41813f(0x10d9))+_0x41813f(0x120c)+_0x1dfad3['likesCount']+_0x41813f(0x80f)+_0x1dfad3['commentsCount']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>'+_0x4fcd92(_0x1dfad3[_0x41813f(0x6b5)])+_0x41813f(0xe62),_0x58b2e6['appendChild'](_0x44be28);});}async function _0x5de7c6(){const _0x38f5e0=_0x419fa8,_0x3ae20c=_0x9ebf46[_0x38f5e0(0x1383)][_0x38f5e0(0x866)]||[];if(_0x3ae20c[_0x38f5e0(0xa06)]===0x0){await _0x1bff53('请先选择角色','请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。');return;}await _0x1bff53(_0x38f5e0(0x7a4),_0x38f5e0(0xcf6)+_0x3ae20c[_0x38f5e0(0xa06)]+'\x20位角色生成豆瓣动态...');const {proxyUrl:_0x15df07,apiKey:_0xdd54e,model:_0x21d4d6}=_0x9ebf46[_0x38f5e0(0x4de)];if(!_0x15df07||!_0xdd54e||!_0x21d4d6){alert(_0x38f5e0(0xf3c));return;}const _0x3ee890=new Set();_0x3ae20c[_0x38f5e0(0x591)](_0x87d396=>{const _0x1cd9f0=_0x38f5e0,_0x139cd4=_0x9ebf46[_0x1cd9f0(0x547)][_0x87d396];_0x139cd4&&_0x139cd4[_0x1cd9f0(0x1131)]['linkedWorldBookIds']&&_0x139cd4[_0x1cd9f0(0x1131)][_0x1cd9f0(0x41a)][_0x1cd9f0(0x591)](_0x501ba8=>_0x3ee890['add'](_0x501ba8));});let _0x508ade='';_0x3ee890[_0x38f5e0(0xa67)]>0x0&&(_0x508ade+='\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a',_0x3ee890[_0x38f5e0(0x591)](_0x16b3d7=>{const _0x1c2d91=_0x38f5e0,_0x599a13=_0x9ebf46[_0x1c2d91(0x1369)][_0x1c2d91(0xfc3)](_0x4d1b4b=>_0x4d1b4b['id']===_0x16b3d7);if(_0x599a13){const _0x5ebde9=_0x599a13[_0x1c2d91(0x53b)][_0x1c2d91(0x401)](_0x20078f=>_0x20078f[_0x1c2d91(0x38a)]!==![])[_0x1c2d91(0xa3b)](_0x5d279d=>'-\x20'+_0x5d279d[_0x1c2d91(0x53b)])['join']('\x0a');_0x5ebde9&&(_0x508ade+=_0x1c2d91(0x4b8)+_0x599a13[_0x1c2d91(0x609)]+_0x1c2d91(0x195)+_0x5ebde9);}}));const _0x49be40=_0x9ebf46[_0x38f5e0(0x1369)][_0x38f5e0(0xfc3)](_0x33b3a9=>_0x33b3a9[_0x38f5e0(0x609)]==='豆瓣设定');let _0x10c967='',_0xd94bd8=[];_0x49be40&&_0x49be40[_0x38f5e0(0x53b)][_0x38f5e0(0x591)](_0x496393=>{const _0xb834cd=_0x38f5e0;_0x496393['comment'][_0xb834cd(0x930)](_0xb834cd(0x1060))&&(_0x10c967+=_0xb834cd(0x756)+_0x496393[_0xb834cd(0x53b)]);if(_0x496393['comment']['includes'](_0xb834cd(0x13b3))){const _0x276f89=_0x496393[_0xb834cd(0x53b)][_0xb834cd(0x6c6)]('\x0a');_0x276f89[_0xb834cd(0x591)](_0x3a87b7=>{const _0x5637e5=_0xb834cd,_0x5edf49=_0x3a87b7[_0x5637e5(0x12c2)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x5edf49&&_0xd94bd8['push']({'name':_0x5edf49[0x1][_0x5637e5(0x3f1)](),'persona':_0x5edf49[0x2][_0x5637e5(0x3f1)]()});});}});const _0x3c56de=_0x9ebf46[_0x38f5e0(0x32c)][_0x38f5e0(0x5b7)]||'我',_0x4663d7=_0x3ae20c[_0x38f5e0(0xa06)]>0x0&&_0x9ebf46[_0x38f5e0(0x547)][_0x3ae20c[0x0]]?_0x9ebf46['chats'][_0x3ae20c[0x0]][_0x38f5e0(0x1131)][_0x38f5e0(0x1151)]:_0x38f5e0(0xe1e);let _0x942763='';_0x3ae20c['forEach'](_0xa86c48=>{const _0x3e284d=_0x38f5e0,_0x24643a=_0x9ebf46[_0x3e284d(0x547)][_0xa86c48];if(_0x24643a){const _0x2b0ccf=_0x24643a[_0x3e284d(0x323)]&&_0x24643a[_0x3e284d(0x323)][_0x3e284d(0xa06)]>0x0?_0x24643a['longTermMemory'][_0x3e284d(0xa3b)](_0x22340e=>_0x22340e['content'])['join'](';\x20'):'无',_0x5ab0e4=_0x24643a[_0x3e284d(0x8b3)][_0x3e284d(0x1044)](-0xa)['map'](_0x39309a=>(_0x39309a[_0x3e284d(0x7fd)]==='user'?_0x3c56de:_0x24643a[_0x3e284d(0x609)])+':\x20'+String(_0x39309a['content'])[_0x3e284d(0xc34)](0x0,0x1e)+'...')[_0x3e284d(0x809)]('\x0a');_0x942763+='\x0a<character>\x0a\x20\x20<name>'+_0x24643a[_0x3e284d(0x609)]+'</name>\x0a\x20\x20<persona>'+_0x24643a[_0x3e284d(0x1131)][_0x3e284d(0xae3)]+'</persona>\x0a\x20\x20<memory>'+_0x2b0ccf+_0x3e284d(0x1230)+_0x5ab0e4+_0x3e284d(0x307);}}),_0xd94bd8[_0x38f5e0(0x591)](_0x2b9bd9=>{const _0x55daff=_0x38f5e0;_0x942763+='\x0a<character>\x0a\x20\x20<name>'+_0x2b9bd9[_0x55daff(0x609)]+_0x55daff(0xc58)+_0x2b9bd9[_0x55daff(0xeb1)]+_0x55daff(0xba0);});const _0x23e0c2=new Date(),_0x4680c5=_0x23e0c2[_0x38f5e0(0x135b)]('zh-CN',{'dateStyle':_0x38f5e0(0x1088),'timeStyle':_0x38f5e0(0x4ea)}),_0x4a4146=_0x9ebf46[_0x38f5e0(0x1383)][_0x38f5e0(0x387)]||0xc,_0x45fdc7=_0x9ebf46['globalSettings'][_0x38f5e0(0x912)]||0x14,_0x8b1d79=_0x38f5e0(0xb8d)+_0x4a4146+'到'+_0x45fdc7+_0x38f5e0(0x472)+_0x4680c5+_0x38f5e0(0x610)+_0x3c56de+_0x38f5e0(0x2a3)+_0x3c56de+_0x38f5e0(0xb77)+_0x10c967+'\x0a'+_0x508ade+_0x38f5e0(0xad3)+_0x4680c5+'\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20'+_0x3c56de+_0x38f5e0(0x1089)+_0x4663d7+_0x38f5e0(0xa4c)+_0x942763+_0x38f5e0(0x939);try{const _0x2fa313=[{'role':'user','content':_0x38f5e0(0x6ca)}];let _0x580890=_0x15df07[_0x38f5e0(0x930)](_0x38f5e0(0xb23)),_0xe07a35=_0x2e5c04(_0x21d4d6,_0xdd54e,_0x8b1d79,_0x2fa313);const _0x4752d7=_0x580890?await fetch(_0xe07a35['url'],_0xe07a35[_0x38f5e0(0x100d)]):await fetch(_0x15df07+_0x38f5e0(0x1090),{'method':_0x38f5e0(0x116f),'headers':{'Content-Type':_0x38f5e0(0x698),'Authorization':'Bearer\x20'+_0xdd54e},'body':JSON[_0x38f5e0(0xf1e)]({'model':_0x21d4d6,'messages':[{'role':'system','content':_0x8b1d79},..._0x2fa313],'temperature':_0x9ebf46[_0x38f5e0(0x1383)][_0x38f5e0(0xc3d)]||0x1})});if(!_0x4752d7['ok'])throw new Error(_0x38f5e0(0x8ab)+_0x4752d7[_0x38f5e0(0x399)]);const _0x3bbbcf=await _0x4752d7[_0x38f5e0(0x5dd)](),_0x552fb7=getGeminiResponseText(_0x3bbbcf),_0x1f28b5=_0x552fb7[_0x38f5e0(0x12c2)](/\[[\s\S]*\]/);if(!_0x1f28b5)throw new Error(_0x38f5e0(0x9c5)+_0x552fb7);const _0x1b2bfc=JSON['parse'](_0x1f28b5[0x0]);await _0x2c5bcf[_0x38f5e0(0x8af)][_0x38f5e0(0xdae)](),await _0x2c5bcf[_0x38f5e0(0x8af)]['bulkAdd'](_0x1b2bfc['map'](_0x2a0e96=>({..._0x2a0e96,'timestamp':Date[_0x38f5e0(0x9b7)]()-Math[_0x38f5e0(0x360)]()*0x186a0}))),await _0x30f476();}catch(_0x5ee524){console['error'](_0x38f5e0(0xf96),_0x5ee524),await _0x1bff53(_0x38f5e0(0xf8d),_0x38f5e0(0xc52)+_0x5ee524[_0x38f5e0(0x86e)]);}}async function _0x551da5(_0x2134b6){const _0x32c890=_0x419fa8;_0xe5834e(_0x32c890(0x52d)),_0x457a2a=_0x2134b6;const _0x3ce8c5=await _0x2c5bcf[_0x32c890(0x8af)][_0x32c890(0xdf9)](_0x2134b6);if(!_0x3ce8c5){_0xe5834e(_0x32c890(0x5de));return;}document[_0x32c890(0x9c8)](_0x32c890(0x12ca))['textContent']=_0x32c890(0x1021);let _0x2976ff=_0x246753,_0x3f6789=_0x3ce8c5[_0x32c890(0xa2c)];const _0x5d5de7=_0x3ce8c5[_0x32c890(0x12ec)]?Object[_0x32c890(0xeb2)](_0x9ebf46[_0x32c890(0x547)])[_0x32c890(0xfc3)](_0x3a4d97=>!_0x3a4d97[_0x32c890(0x11e4)]&&_0x3a4d97[_0x32c890(0x1071)]===_0x3ce8c5['authorOriginalName']):null;if(_0x5d5de7)_0x2976ff=_0x5d5de7[_0x32c890(0x1131)][_0x32c890(0xd4d)];else{const _0x30dcf5=Object[_0x32c890(0xeb2)](_0x9ebf46[_0x32c890(0x547)])['find'](_0x363543=>!_0x363543['isGroup']&&_0x363543[_0x32c890(0x609)]===_0x3ce8c5[_0x32c890(0xa2c)]);if(_0x30dcf5)_0x2976ff=_0x30dcf5[_0x32c890(0x1131)]['aiAvatar'];else _0x3ce8c5['authorAvatarPrompt']&&(_0x2976ff=_0x32c890(0x12d5)+encodeURIComponent(_0x3ce8c5[_0x32c890(0x8b7)]));}document[_0x32c890(0x9c8)](_0x32c890(0x70e))['src']=_0x2976ff,document[_0x32c890(0x9c8)](_0x32c890(0xbc7))[_0x32c890(0xe24)]=_0x3f6789,document[_0x32c890(0x9c8)](_0x32c890(0x95d))[_0x32c890(0xe24)]=_0x32c890(0xaee)+_0x3ce8c5[_0x32c890(0x9a6)],document[_0x32c890(0x9c8)](_0x32c890(0xa81))[_0x32c890(0xe24)]=_0x3ce8c5['postTitle'],document[_0x32c890(0x9c8)](_0x32c890(0xe07))[_0x32c890(0x2f5)]=_0x3ce8c5['content']['replace'](/\n/g,_0x32c890(0x10d9)),document[_0x32c890(0x9c8)](_0x32c890(0xd01))[_0x32c890(0xbf4)]=_0x9ebf46[_0x32c890(0x32c)][_0x32c890(0x10c9)],document[_0x32c890(0x9c8)](_0x32c890(0xf32))[_0x32c890(0x1155)]='';const _0x21ad06=document['getElementById'](_0x32c890(0xf48));_0x21ad06['innerHTML']='';if(_0x3ce8c5['comments']&&_0x3ce8c5[_0x32c890(0x1e0)][_0x32c890(0xa06)]>0x0){const _0x2eed1c=new Map();_0x3ce8c5[_0x32c890(0x1e0)]['forEach'](_0x1e014f=>{const _0x226da6=_0x32c890;let _0x49e318=_0x246753;const _0x51ebb4=_0x9ebf46['qzoneSettings'][_0x226da6(0x5b7)]||'我',_0xf4c6af=_0x1e014f[_0x226da6(0xe32)];if(_0x2eed1c['has'](_0xf4c6af))_0x49e318=_0x2eed1c[_0x226da6(0xdf9)](_0xf4c6af);else{if(_0xf4c6af===_0x51ebb4)_0x49e318=_0x9ebf46[_0x226da6(0x32c)][_0x226da6(0x10c9)];else{if(_0xf4c6af===_0x3ce8c5[_0x226da6(0xa2c)])_0x49e318=_0x2976ff;else{const _0x555fdf=_0x1e014f['commenterOriginalName']?Object['values'](_0x9ebf46[_0x226da6(0x547)])[_0x226da6(0xfc3)](_0x3dc2d2=>!_0x3dc2d2[_0x226da6(0x11e4)]&&_0x3dc2d2[_0x226da6(0x1071)]===_0x1e014f[_0x226da6(0xdaa)]):null;if(_0x555fdf)_0x49e318=_0x555fdf[_0x226da6(0x1131)][_0x226da6(0xd4d)];else{const _0x3f97de=Object[_0x226da6(0xeb2)](_0x9ebf46[_0x226da6(0x547)])[_0x226da6(0xfc3)](_0x1bfec1=>!_0x1bfec1[_0x226da6(0x11e4)]&&_0x1bfec1[_0x226da6(0x609)]===_0xf4c6af);if(_0x3f97de)_0x49e318=_0x3f97de[_0x226da6(0x1131)][_0x226da6(0xd4d)];else _0x1e014f[_0x226da6(0x5bd)]&&(_0x49e318='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x1e014f[_0x226da6(0x5bd)]));}}}_0x2eed1c[_0x226da6(0xe36)](_0xf4c6af,_0x49e318);}const _0x3523f6=document[_0x226da6(0x28a)](_0x226da6(0x11f4));_0x3523f6[_0x226da6(0x82c)]=_0x226da6(0xb8c),_0x3523f6[_0x226da6(0x2f5)]=_0x226da6(0xbef)+_0x49e318+_0x226da6(0x370)+_0xf4c6af+_0x226da6(0xe2d)+_0x1e014f['text'][_0x226da6(0x459)](/\n/g,_0x226da6(0x10d9))+_0x226da6(0xf49),_0x21ad06['appendChild'](_0x3523f6);});}else _0x21ad06[_0x32c890(0x2f5)]=_0x32c890(0x7a3);const _0x25249b=document[_0x32c890(0x9c8)](_0x32c890(0x82b));if(_0x25249b)_0x25249b[_0x32c890(0x783)]=0x0;}async function _0x219a6b(){const _0x55ec6a=_0x419fa8;if(!_0x457a2a)return;const _0x1da0b0=document[_0x55ec6a(0x9c8)](_0x55ec6a(0xf32)),_0x4a82c7=_0x1da0b0[_0x55ec6a(0x1155)][_0x55ec6a(0x3f1)]();if(!_0x4a82c7)return;const _0x4ea013=await _0x2c5bcf['doubanPosts'][_0x55ec6a(0xdf9)](_0x457a2a);if(!_0x4ea013)return;!_0x4ea013[_0x55ec6a(0x1e0)]&&(_0x4ea013[_0x55ec6a(0x1e0)]=[]);const _0x1f491a=_0x9ebf46[_0x55ec6a(0x32c)]['nickname']||'我';_0x4ea013['comments'][_0x55ec6a(0x668)]({'commenter':_0x1f491a,'text':_0x4a82c7}),_0x4ea013[_0x55ec6a(0x326)]++,await _0x2c5bcf['doubanPosts'][_0x55ec6a(0xff5)](_0x4ea013),_0x1da0b0['value']='',await _0x551da5(_0x457a2a);}async function _0x4f3c88(){const _0xd07891=_0x419fa8;if(!_0x457a2a)return;const _0x345d99=_0x457a2a,_0x58e5be=await _0x2c5bcf[_0xd07891(0x8af)]['get'](_0x345d99);if(!_0x58e5be)return;const _0x1d19a6=_0x58e5be['comments']&&_0x58e5be['comments']['slice'](-0x1)[0x0];if(!_0x1d19a6){alert(_0xd07891(0x122b));return;}await _0x1bff53('请稍候...',_0xd07891(0xea3));try{const {proxyUrl:_0x35a5a9,apiKey:_0x568fb2,model:_0x3d943c}=_0x9ebf46[_0xd07891(0x4de)];if(!_0x35a5a9||!_0x568fb2||!_0x3d943c)throw new Error(_0xd07891(0x5da));const _0x34da71=_0x9ebf46['qzoneSettings']['nickname']||'我',_0x4b8365=_0x9ebf46['chats'][Object[_0xd07891(0x2bd)](_0x9ebf46['chats'])[0x0]]?.['settings'][_0xd07891(0x1151)]||_0xd07891(0xe1e),_0x173819=new Map();_0x58e5be[_0xd07891(0x1e0)]&&_0x58e5be['comments'][_0xd07891(0x591)](_0xd26074=>{const _0x2319dc=_0xd07891,_0x431c53=(_0x9ebf46[_0x2319dc(0x1383)][_0x2319dc(0x866)]||[])[_0x2319dc(0x10b2)](_0x204a7e=>_0x9ebf46[_0x2319dc(0x547)][_0x204a7e]?.[_0x2319dc(0x609)]===_0xd26074['commenter']);!_0x431c53&&_0xd26074['avatar_prompt']&&_0x173819[_0x2319dc(0xe36)](_0xd26074[_0x2319dc(0xe32)],_0xd26074[_0x2319dc(0x5bd)]);});let _0x5b69ac='#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a';_0x173819[_0xd07891(0xa67)]>0x0?(_0x5b69ac+='如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a',_0x173819['forEach']((_0x33c3f4,_0x1eb096)=>{const _0x489218=_0xd07891;_0x5b69ac+=_0x489218(0x388)+_0x1eb096+_0x489218(0x618)+_0x33c3f4+'\x22\x0a';})):_0x5b69ac+='（当前帖子还没有路人NPC发表评论。）\x0a';const _0x5a674a=_0x9ebf46[_0xd07891(0x1369)][_0xd07891(0xfc3)](_0x31a715=>_0x31a715[_0xd07891(0x609)]===_0xd07891(0x7e1));let _0x4cb0b4=[];_0x5a674a&&_0x5a674a[_0xd07891(0x53b)][_0xd07891(0x591)](_0x2b4b5a=>{const _0x38366d=_0xd07891;if(_0x2b4b5a['comment'][_0x38366d(0x930)](_0x38366d(0x13b3))){const _0x55596c=_0x2b4b5a['content'][_0x38366d(0x6c6)]('\x0a');_0x55596c[_0x38366d(0x591)](_0x36a7a4=>{const _0x23ef8b=_0x38366d,_0x2f8509=_0x36a7a4[_0x23ef8b(0x12c2)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x2f8509&&_0x4cb0b4[_0x23ef8b(0x668)]({'name':_0x2f8509[0x1][_0x23ef8b(0x3f1)](),'persona':_0x2f8509[0x2][_0x23ef8b(0x3f1)]()});});}});let _0x5061d5='';const _0x1c8602=_0x9ebf46[_0xd07891(0x1383)][_0xd07891(0x866)]||[];_0x1c8602['forEach'](_0x170c2c=>{const _0x2a5bf0=_0xd07891,_0x4642c6=_0x9ebf46[_0x2a5bf0(0x547)][_0x170c2c];if(_0x4642c6){const _0x5ab4a5=_0x4642c6[_0x2a5bf0(0x323)]&&_0x4642c6[_0x2a5bf0(0x323)][_0x2a5bf0(0xa06)]>0x0?_0x4642c6[_0x2a5bf0(0x323)][_0x2a5bf0(0xa3b)](_0x2c9343=>_0x2c9343['content'])[_0x2a5bf0(0x809)](';\x20'):'无',_0x2faa24=_0x4642c6[_0x2a5bf0(0x8b3)][_0x2a5bf0(0x1044)](-0xa)[_0x2a5bf0(0xa3b)](_0x486a9d=>(_0x486a9d[_0x2a5bf0(0x7fd)]===_0x2a5bf0(0x586)?_0x34da71:_0x4642c6[_0x2a5bf0(0x609)])+':\x20'+String(_0x486a9d[_0x2a5bf0(0x53b)])[_0x2a5bf0(0xc34)](0x0,0x1e)+_0x2a5bf0(0xf66))[_0x2a5bf0(0x809)]('\x0a');_0x5061d5+=_0x2a5bf0(0x12be)+_0x4642c6[_0x2a5bf0(0x609)]+':\x20'+_0x4642c6[_0x2a5bf0(0x1131)][_0x2a5bf0(0xae3)][_0x2a5bf0(0xc34)](0x0,0x32)+'...\x20[记忆:\x20'+_0x5ab4a5+_0x2a5bf0(0x112e)+_0x2faa24+']';}}),_0x4cb0b4[_0xd07891(0x591)](_0x4cf939=>{const _0x1615f2=_0xd07891;_0x5061d5+=_0x1615f2(0x12be)+_0x4cf939[_0x1615f2(0x609)]+':\x20'+_0x4cf939['persona'];});const _0x196109=new Date(),_0x53acd4=_0x196109['toLocaleString']('zh-CN',{'dateStyle':_0xd07891(0x1088),'timeStyle':_0xd07891(0x4ea)}),_0xd15377=_0xd07891(0x12f7)+_0x34da71+_0xd07891(0x569)+_0x53acd4+_0xd07891(0x2fb)+_0x34da71+'”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“'+_0x34da71+_0xd07891(0x13bd)+_0x58e5be[_0xd07891(0xabc)]+_0xd07891(0x933)+_0x58e5be['authorName']+_0xd07891(0xe4c)+_0x58e5be[_0xd07891(0x53b)][_0xd07891(0xc34)](0x0,0x64)+_0xd07891(0x119b)+_0x58e5be[_0xd07891(0x1e0)][_0xd07891(0xa3b)](_0x21b99e=>'-\x20'+_0x21b99e['commenter']+':\x20'+_0x21b99e[_0xd07891(0xbb7)])[_0xd07891(0x809)]('\x0a')+'\x0a\x0a'+_0x5b69ac+_0xd07891(0xad3)+_0x53acd4+'\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20'+_0x34da71+_0xd07891(0x1089)+_0x4b8365+_0xd07891(0x1334)+_0x5061d5+_0xd07891(0xf01),_0x48eaec=[{'role':'user','content':_0xd07891(0x1295)}];let _0x715fe4=_0x35a5a9[_0xd07891(0x930)](_0xd07891(0xb23)),_0x179de2=_0x2e5c04(_0x3d943c,_0x568fb2,_0xd15377,_0x48eaec);const _0xaf7b95=_0x715fe4?await fetch(_0x179de2['url'],_0x179de2[_0xd07891(0x100d)]):await fetch(_0x35a5a9+'/v1/chat/completions',{'method':_0xd07891(0x116f),'headers':{'Content-Type':_0xd07891(0x698),'Authorization':_0xd07891(0x84a)+_0x568fb2},'body':JSON[_0xd07891(0xf1e)]({'model':_0x3d943c,'messages':[{'role':_0xd07891(0xb64),'content':_0xd15377},..._0x48eaec],'temperature':_0x9ebf46[_0xd07891(0x1383)][_0xd07891(0xc3d)]||0x1})});if(!_0xaf7b95['ok'])throw new Error(_0xd07891(0x8ab)+_0xaf7b95[_0xd07891(0x399)]);const _0x47b14e=await _0xaf7b95[_0xd07891(0x5dd)](),_0x3eefcb=getGeminiResponseText(_0x47b14e),_0x20cc19=_0x3eefcb[_0xd07891(0x459)](/^```json\s*/,'')[_0xd07891(0x459)](/```$/,''),_0x1f6cb0=JSON[_0xd07891(0x907)](_0x20cc19);Array[_0xd07891(0xb27)](_0x1f6cb0)&&_0x1f6cb0[_0xd07891(0xa06)]>0x0&&(_0x58e5be[_0xd07891(0x1e0)][_0xd07891(0x668)](..._0x1f6cb0),_0x58e5be[_0xd07891(0x326)]+=_0x1f6cb0[_0xd07891(0xa06)],await _0x2c5bcf['doubanPosts'][_0xd07891(0xff5)](_0x58e5be)),await _0x551da5(_0x345d99),_0x1dc9df();}catch(_0x16849a){console[_0xd07891(0x1221)](_0xd07891(0x3d2),_0x16849a),await _0x1bff53('操作失败',_0xd07891(0xed5)+_0x16849a[_0xd07891(0x86e)]);}}async function _0x5e93d1(){const _0x348dbf=_0x419fa8,_0x562250=document[_0x348dbf(0x9c8)](_0x348dbf(0x8d7)),_0x1a5861=document['getElementById'](_0x348dbf(0x31d));_0x1a5861['innerHTML']='';const _0x2d255=Object[_0x348dbf(0xeb2)](_0x9ebf46[_0x348dbf(0x547)])[_0x348dbf(0x401)](_0x4522ab=>!_0x4522ab[_0x348dbf(0x11e4)]),_0x24b544=new Set(_0x9ebf46[_0x348dbf(0x1383)]['doubanActiveCharacterIds']||[]);_0x2d255[_0x348dbf(0xa06)]===0x0?_0x1a5861[_0x348dbf(0x2f5)]=_0x348dbf(0xb21):_0x2d255[_0x348dbf(0x591)](_0x10418f=>{const _0x405d8e=_0x348dbf,_0x10ce80=document['createElement']('div');_0x10ce80[_0x405d8e(0x82c)]='contact-picker-item',_0x10ce80[_0x405d8e(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22'+_0x10418f['id']+'\x22\x20'+(_0x24b544[_0x405d8e(0xd97)](_0x10418f['id'])?_0x405d8e(0x1ec):'')+'\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x10418f[_0x405d8e(0x1131)][_0x405d8e(0xd4d)]||_0x246753)+_0x405d8e(0x291)+_0x10418f['name']+_0x405d8e(0x4fc),_0x1a5861[_0x405d8e(0x7b9)](_0x10ce80);}),_0x562250[_0x348dbf(0x575)][_0x348dbf(0x68e)](_0x348dbf(0xc3f));}async function _0x130bfb(){const _0x2b2cc5=_0x419fa8,_0x50b6aa=document[_0x2b2cc5(0x7e4)](_0x2b2cc5(0x11a9)),_0x1fdfa3=Array[_0x2b2cc5(0x13a5)](_0x50b6aa)['map'](_0x48e20e=>_0x48e20e[_0x2b2cc5(0xc9f)]['chatId']);_0x9ebf46[_0x2b2cc5(0x1383)]['doubanActiveCharacterIds']=_0x1fdfa3,await _0x2c5bcf[_0x2b2cc5(0x1383)][_0x2b2cc5(0xff5)](_0x9ebf46[_0x2b2cc5(0x1383)]),document['getElementById'](_0x2b2cc5(0x8d7))[_0x2b2cc5(0x575)][_0x2b2cc5(0x30f)](_0x2b2cc5(0xc3f)),await _0x5de7c6();}document[_0x419fa8(0x9c8)](_0x419fa8(0x1363))['addEventListener']('click',_0x5e93d1),document[_0x419fa8(0x9c8)](_0x419fa8(0x26a))[_0x419fa8(0xa0f)]('click',()=>{const _0x4c3098=_0x419fa8;document[_0x4c3098(0x9c8)](_0x4c3098(0x8d7))[_0x4c3098(0x575)]['remove'](_0x4c3098(0xc3f));}),document['getElementById']('save-douban-cast-btn')['addEventListener'](_0x419fa8(0xf5c),_0x130bfb),document['getElementById'](_0x419fa8(0x31d))[_0x419fa8(0xa0f)](_0x419fa8(0xf5c),_0x3a21ae=>{const _0x111fa1=_0x419fa8,_0x394b27=_0x3a21ae['target']['closest']('.contact-picker-item');if(_0x394b27){const _0x187de7=_0x394b27[_0x111fa1(0x91d)](_0x111fa1(0xa8b));_0x187de7&&_0x3a21ae[_0x111fa1(0x1070)]!==_0x187de7&&(_0x187de7[_0x111fa1(0x1ec)]=!_0x187de7[_0x111fa1(0x1ec)]);}});async function _0x46eebd(_0x5c5606){const _0x283e23=_0x419fa8;if(!_0x5c5606)return;const _0x5babae=await _0x352ae9('导入外观设置',_0x283e23(0x276),{'confirmText':_0x283e23(0x119f)});if(!_0x5babae)return;try{const _0x3576d8=await _0x5c5606[_0x283e23(0xbb7)](),_0x472e79=JSON[_0x283e23(0x907)](_0x3576d8);if(!_0x472e79['wallpaper']&&!_0x472e79[_0x283e23(0x911)]&&!_0x472e79[_0x283e23(0x11b3)])throw new Error(_0x283e23(0x37b));Object[_0x283e23(0x6d3)](_0x9ebf46['globalSettings'],_0x472e79),await _0x2c5bcf[_0x283e23(0x1383)]['put'](_0x9ebf46['globalSettings']),_0x2a99db(),_0x58c61c(),_0x2ea916(),_0x3f12a7(),_0x4bc8ea(_0x9ebf46[_0x283e23(0x1383)][_0x283e23(0x911)]),_0xd42b1c(_0x9ebf46[_0x283e23(0x1383)]['fontUrl']),_0x2417f9(),_0x1960df(),_0xec3eb7(),await _0x1bff53(_0x283e23(0x135e),'外观设置已成功导入并应用！');}catch(_0x2ddd2d){console[_0x283e23(0x1221)](_0x283e23(0x186),_0x2ddd2d),await _0x1bff53('导入失败',_0x283e23(0x3a2)+_0x2ddd2d[_0x283e23(0x86e)]);}}async function _0x206959(_0xf2cc5c){const _0x158f29=_0x419fa8;console[_0x158f29(0x283)](_0x158f29(0x304)+_0xf2cc5c[_0x158f29(0x752)](0x1)+'\x20分钟，开始模拟后台活动...');const _0x6a2e97=Object[_0x158f29(0xeb2)](_0x9ebf46[_0x158f29(0x547)])[_0x158f29(0x401)](_0x417e38=>!_0x417e38[_0x158f29(0x11e4)]&&_0x417e38[_0x158f29(0x1131)][_0x158f29(0x22a)]&&_0x417e38[_0x158f29(0x36f)]?.['status']===_0x158f29(0x733));if(_0x6a2e97[_0x158f29(0xa06)]===0x0){console[_0x158f29(0x283)]('没有配置为后台活跃的角色，跳过模拟。');return;}for(const _0x301739 of _0x6a2e97){const _0x28e917=_0x301739[_0x158f29(0x1131)][_0x158f29(0x664)]||0xf,_0x585a5f=_0x301739['lastActionTimestamp']?(Date[_0x158f29(0x9b7)]()-_0x301739[_0x158f29(0x6e3)])/(0x3e8*0x3c):Infinity;_0xf2cc5c>_0x28e917&&_0x585a5f>_0x28e917&&(Math[_0x158f29(0x360)]()<0.3&&(console[_0x158f29(0x283)](_0x158f29(0x23a)+_0x301739[_0x158f29(0x609)]+_0x158f29(0x10ff)),Math['random']()<0.7?await _0x1dd4ec(_0x301739['id']):console[_0x158f29(0x283)]('角色\x20\x22'+_0x301739[_0x158f29(0x609)]+_0x158f29(0x46d))));}}function _0x941015(){const _0x1f62cc=_0x419fa8;if(!_0x9ebf46[_0x1f62cc(0x970)])return;const _0x567176=_0x9ebf46['chats'][_0x9ebf46[_0x1f62cc(0x970)]];document[_0x1f62cc(0x9c8)](_0x1f62cc(0x1b7))[_0x1f62cc(0x1155)]='',document[_0x1f62cc(0x9c8)](_0x1f62cc(0x5b5))[_0x1f62cc(0x1155)]='',document[_0x1f62cc(0x9c8)]('chat-search-results-list')[_0x1f62cc(0x2f5)]=_0x1f62cc(0xabb),_0xe5834e(_0x1f62cc(0x8b9));}async function _0x4aa386(){const _0x5ad0eb=_0x419fa8,_0xff205a=_0x9ebf46[_0x5ad0eb(0x547)][_0x9ebf46[_0x5ad0eb(0x970)]];if(!_0xff205a)return;const _0x36346a=document[_0x5ad0eb(0x9c8)](_0x5ad0eb(0x1b7))[_0x5ad0eb(0x1155)][_0x5ad0eb(0x3f1)]()['toLowerCase'](),_0x1c4a5c=document[_0x5ad0eb(0x9c8)](_0x5ad0eb(0x5b5))[_0x5ad0eb(0x1155)];if(!_0x36346a&&!_0x1c4a5c){alert(_0x5ad0eb(0xe64));return;}let _0x3e9626=_0xff205a[_0x5ad0eb(0x8b3)][_0x5ad0eb(0x401)](_0x4e0446=>!_0x4e0446[_0x5ad0eb(0xc62)]);_0x36346a&&(_0x3e9626=_0x3e9626[_0x5ad0eb(0x401)](_0x2e4e9c=>{const _0x3584f1=_0x5ad0eb;let _0x26850a='';if(typeof _0x2e4e9c[_0x3584f1(0x53b)]===_0x3584f1(0xe56))_0x26850a=_0x2e4e9c[_0x3584f1(0x53b)];else{if(_0x2e4e9c[_0x3584f1(0x12d9)]===_0x3584f1(0x10c1))_0x26850a=_0x2e4e9c[_0x3584f1(0x53b)];else{if(_0x2e4e9c[_0x3584f1(0x12d9)]===_0x3584f1(0x835)||_0x2e4e9c[_0x3584f1(0x12d9)]==='user_photo')_0x26850a=_0x2e4e9c[_0x3584f1(0x53b)];else{if(_0x2e4e9c[_0x3584f1(0x12d9)]===_0x3584f1(0xc91))_0x26850a=(_0x2e4e9c['dialogue']||'')+'\x20'+(_0x2e4e9c[_0x3584f1(0x1387)]||'');else _0x2e4e9c[_0x3584f1(0xa19)]&&(_0x26850a=_0x2e4e9c[_0x3584f1(0x53b)]);}}}return _0x26850a[_0x3584f1(0xc61)]()[_0x3584f1(0x930)](_0x36346a);}));if(_0x1c4a5c){const _0x46a5da=new Date(_0x1c4a5c),_0x86e4f7=new Date(_0x46a5da['setHours'](0x0,0x0,0x0,0x0))[_0x5ad0eb(0xb03)](),_0x314181=new Date(_0x46a5da[_0x5ad0eb(0x1177)](0x17,0x3b,0x3b,0x3e7))['getTime']();_0x3e9626=_0x3e9626[_0x5ad0eb(0x401)](_0x2ebc44=>_0x2ebc44[_0x5ad0eb(0x6b5)]>=_0x86e4f7&&_0x2ebc44['timestamp']<=_0x314181);}await _0x9fd862(_0x3e9626);}async function _0x9fd862(_0x3e5c5c){const _0x926f62=_0x419fa8,_0x477421=document['getElementById'](_0x926f62(0x10ac)),_0x3864da=_0x9ebf46[_0x926f62(0x547)][_0x9ebf46[_0x926f62(0x970)]];_0x477421[_0x926f62(0x2f5)]='';if(_0x3e5c5c[_0x926f62(0xa06)]===0x0){_0x477421['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>';return;}let _0x29cc6c='';for(const _0x4e6194 of _0x3e5c5c){const _0x4b0d5c=new Date(_0x4e6194['timestamp']),_0x469ea4=_0x4b0d5c[_0x926f62(0xd23)]();if(_0x469ea4!==_0x29cc6c){const _0x1b0bea=document[_0x926f62(0x28a)](_0x926f62(0x11f4));_0x1b0bea['className']='date-separator',_0x1b0bea['textContent']=_0x926f62(0x5f0)+_0x4b0d5c['getFullYear']()+'年'+(_0x4b0d5c[_0x926f62(0x260)]()+0x1)+'月'+_0x4b0d5c['getDate']()+_0x926f62(0x20b),_0x477421[_0x926f62(0x7b9)](_0x1b0bea),_0x29cc6c=_0x469ea4;}const _0x2e6fb5=await _0x8ae2cf(_0x4e6194,_0x3864da);_0x2e6fb5&&(_0x2e6fb5['style'][_0x926f62(0x8e4)]=_0x926f62(0xec1),_0x2e6fb5[_0x926f62(0xa0f)](_0x926f62(0xf5c),()=>_0x108d0b(_0x4e6194[_0x926f62(0x6b5)])),_0x477421['appendChild'](_0x2e6fb5));}}async function _0x108d0b(_0x3028bc){const _0x588b5d=_0x419fa8,_0x1fe004=_0x9ebf46[_0x588b5d(0x970)];if(!_0x1fe004)return;_0xe5834e(_0x588b5d(0x504)),setTimeout(async()=>{const _0x5aeb10=_0x588b5d,_0x30fe88=document[_0x5aeb10(0x9c8)](_0x5aeb10(0xbff)),_0x44a2fc=_0x5aeb10(0x47f)+_0x3028bc+'\x22]';let _0x5941bc=_0x30fe88[_0x5aeb10(0x91d)](_0x44a2fc),_0x35964d=0x0;const _0x457c25=0x14;while(!_0x5941bc&&_0x35964d<_0x457c25){const _0x20f46b=document[_0x5aeb10(0x9c8)](_0x5aeb10(0x121c));if(_0x20f46b)console[_0x5aeb10(0x283)](_0x5aeb10(0x125d)+(_0x35964d+0x1)+')'),await _0x32afa4(),_0x5941bc=_0x30fe88['querySelector'](_0x44a2fc),_0x35964d++;else break;}_0xc1ed1c(_0x3028bc);},0xc8);}async function _0x4953a6(){const _0x2890c0=_0x419fa8;document[_0x2890c0(0x9c8)](_0x2890c0(0x1b7))[_0x2890c0(0x1155)]='',document['getElementById']('date-search-input')[_0x2890c0(0x1155)]='',await _0x9fd862(_0x9ebf46[_0x2890c0(0x547)][_0x9ebf46[_0x2890c0(0x970)]][_0x2890c0(0x8b3)][_0x2890c0(0x401)](_0x2d2910=>!_0x2d2910['isHidden']));}async function _0x3c2f7a(_0x42d5ea=![],_0x35dd3a=null,_0x2a962e=null){const _0x5da766=_0x419fa8,_0x520090=document[_0x5da766(0x9c8)](_0x5da766(0x2ac)),_0x231c4f=document[_0x5da766(0x9c8)](_0x5da766(0x302)),_0x41e39d=_0x9ebf46[_0x5da766(0x547)][_0x9ebf46[_0x5da766(0x970)]];_0x520090[_0x5da766(0x2f5)]='',_0x231c4f[_0x5da766(0x2f5)]='';const _0x4c4abc=await _0x2c5bcf[_0x5da766(0x36b)][_0x5da766(0x5ff)](),_0x281da0=[..._0x4f4f26,..._0x4c4abc];document['querySelector'](_0x5da766(0x1207))[_0x5da766(0x5e1)][_0x5da766(0x3c5)]=_0x42d5ea?_0x5da766(0x8f6):_0x5da766(0x989),document[_0x5da766(0x9c8)](_0x5da766(0xd25))[_0x5da766(0x5e1)]['display']=_0x5da766(0x3d9),document[_0x5da766(0x9c8)]('my-frame-content')['style'][_0x5da766(0x3c5)]=_0x5da766(0x8f6),document[_0x5da766(0x9c8)](_0x5da766(0x197))[_0x5da766(0x575)][_0x5da766(0x68e)](_0x5da766(0x113d)),document['getElementById'](_0x5da766(0x11ab))[_0x5da766(0x575)]['remove']('active');if(_0x42d5ea)_0x281da0[_0x5da766(0x591)](_0x432250=>{const _0x3b37f6=_0x5da766,_0xdaf5f7=_0x9b4b7f(_0x432250,'my',_0x35dd3a);_0x432250[_0x3b37f6(0x11be)]===_0x2a962e&&_0xdaf5f7[_0x3b37f6(0x575)][_0x3b37f6(0x68e)](_0x3b37f6(0x631)),_0x520090[_0x3b37f6(0x7b9)](_0xdaf5f7);});else{const _0x276dcc=_0x41e39d[_0x5da766(0x1131)][_0x5da766(0xd4d)]||_0x246753,_0x1cf3b7=_0x41e39d[_0x5da766(0x1131)][_0x5da766(0xb60)]||(_0x41e39d[_0x5da766(0x11e4)]?_0x1d990b:_0x246753);_0x281da0[_0x5da766(0x591)](_0x560539=>{const _0x13029f=_0x5da766,_0x15dafe=_0x9b4b7f(_0x560539,'ai',_0x276dcc);if(_0x560539[_0x13029f(0x11be)]===_0x1f7cd6['ai'])_0x15dafe[_0x13029f(0x575)][_0x13029f(0x68e)]('selected');_0x520090['appendChild'](_0x15dafe);const _0x171a95=_0x9b4b7f(_0x560539,'my',_0x1cf3b7);if(_0x560539[_0x13029f(0x11be)]===_0x1f7cd6['my'])_0x171a95[_0x13029f(0x575)][_0x13029f(0x68e)](_0x13029f(0x631));_0x231c4f['appendChild'](_0x171a95);});}}function _0x9b4b7f(_0x36c402,_0x8cf40c,_0x1008f5){const _0x257b0a=_0x419fa8,_0xd02cad=document[_0x257b0a(0x28a)](_0x257b0a(0x11f4));_0xd02cad[_0x257b0a(0x82c)]=_0x257b0a(0xe06),_0xd02cad[_0x257b0a(0xc9f)][_0x257b0a(0x7d8)]=_0x36c402[_0x257b0a(0x11be)],_0xd02cad['title']=_0x36c402[_0x257b0a(0x609)];const _0xed9fb0=typeof _0x36c402['id']===_0x257b0a(0x10ae),_0x3dcded=_0xed9fb0?_0x257b0a(0x6f9)+_0x36c402['id']+_0x257b0a(0x494):'';return _0xd02cad[_0x257b0a(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3dcded+_0x257b0a(0x1137)+_0x1008f5+_0x257b0a(0x7c4)+(_0x36c402[_0x257b0a(0x11be)]?_0x257b0a(0x12ac)+_0x36c402[_0x257b0a(0x11be)]+_0x257b0a(0x8cd):'')+'\x0a\x20\x20\x20\x20',_0xd02cad[_0x257b0a(0xa0f)](_0x257b0a(0xf5c),_0x11f270=>{const _0x326fa0=_0x257b0a;if(_0x11f270['target'][_0x326fa0(0x575)][_0x326fa0(0x1038)](_0x326fa0(0x465)))return;if(_0x4d9412){if(_0xed9fb0){const _0x5b646b=parseInt(_0x36c402['id']);_0xd02cad[_0x326fa0(0x575)]['toggle']('selected'),_0x136906[_0x326fa0(0xd97)](_0x5b646b)?_0x136906[_0x326fa0(0x6d2)](_0x5b646b):_0x136906[_0x326fa0(0x68e)](_0x5b646b),_0x23159c();}}else{_0x1f7cd6[_0x8cf40c]=_0x36c402['url'];const _0xfa6cb6=_0x8cf40c==='ai'?document[_0x326fa0(0x9c8)](_0x326fa0(0x2ac)):document[_0x326fa0(0x9c8)](_0x326fa0(0x302));_0xfa6cb6[_0x326fa0(0x7e4)](_0x326fa0(0x1161))['forEach'](_0x8859aa=>_0x8859aa[_0x326fa0(0x575)]['remove'](_0x326fa0(0x631))),_0xd02cad[_0x326fa0(0x575)][_0x326fa0(0x68e)]('selected');}}),_0xd02cad;}async function _0x4e9bdc(){const _0x2f8351=_0x419fa8,_0x4a6e63=document[_0x2f8351(0x9c8)](_0x2f8351(0xe8e)),_0x1167b4=await new Promise(_0x268d1f=>{const _0x17ba19=_0x2f8351,_0x2f3bd1=_0x517aec=>{const _0x3b7c62=_0x3569;_0x268d1f(_0x517aec[_0x3b7c62(0x1070)][_0x3b7c62(0x1216)][0x0]||null),_0x4a6e63['removeEventListener'](_0x3b7c62(0x25c),_0x2f3bd1);};_0x4a6e63[_0x17ba19(0xa0f)]('change',_0x2f3bd1,{'once':!![]}),_0x4a6e63[_0x17ba19(0xf5c)]();});if(!_0x1167b4)return;const _0x226f17=await _0xadb5df('命名头像框','请为这个新头像框起个名字');if(!_0x226f17||!_0x226f17[_0x2f8351(0x3f1)]())return;const _0x5ad113=await new Promise(_0x5d923f=>{const _0x3f936b=_0x2f8351,_0x320a55=new FileReader();_0x320a55['onload']=()=>_0x5d923f(_0x320a55[_0x3f936b(0xceb)]),_0x320a55[_0x3f936b(0xba5)](_0x1167b4);});await _0x2c5bcf[_0x2f8351(0x36b)][_0x2f8351(0x68e)]({'name':_0x226f17[_0x2f8351(0x3f1)](),'url':_0x5ad113}),_0x3c2f7a(_0x4972c5);}async function _0x10f68e(){const _0x5c9ea5=_0x419fa8,_0xa2be7b='请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif',_0x1f032f=await _0xadb5df(_0x5c9ea5(0x95e),_0x5c9ea5(0xfcb),'','textarea',_0x5c9ea5(0xa93)+_0xa2be7b+_0x5c9ea5(0x78d));if(!_0x1f032f||!_0x1f032f[_0x5c9ea5(0x3f1)]())return;const _0x3f63a7=_0x1f032f[_0x5c9ea5(0x3f1)]()[_0x5c9ea5(0x6c6)]('\x0a'),_0x534b6b=[];let _0x15da8a=0x0;for(const _0x2439f2 of _0x3f63a7){const _0x1fc1f8=_0x2439f2[_0x5c9ea5(0x12c2)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x1fc1f8)_0x534b6b[_0x5c9ea5(0x668)]({'name':_0x1fc1f8[0x1][_0x5c9ea5(0x3f1)](),'url':_0x1fc1f8[0x2]['trim']()});else _0x2439f2[_0x5c9ea5(0x3f1)]()&&_0x15da8a++;}_0x534b6b[_0x5c9ea5(0xa06)]>0x0&&(await _0x2c5bcf[_0x5c9ea5(0x36b)][_0x5c9ea5(0x115e)](_0x534b6b),_0x3c2f7a(_0x4972c5),await _0x1bff53(_0x5c9ea5(0x135e),'成功导入\x20'+_0x534b6b[_0x5c9ea5(0xa06)]+_0x5c9ea5(0xd8e))),_0x15da8a>0x0&&await _0x1bff53(_0x5c9ea5(0x312),'有\x20'+_0x15da8a+'\x20行格式不正确，已被忽略。');}async function _0x2da8d9(_0x2891ee){const _0x70ae31=_0x419fa8,_0x10d00d=await _0x2c5bcf['customAvatarFrames'][_0x70ae31(0xdf9)](_0x2891ee);if(!_0x10d00d)return;const _0x289870=await _0x352ae9('确认删除',_0x70ae31(0x7e7)+_0x10d00d['name']+_0x70ae31(0x924),{'confirmButtonClass':_0x70ae31(0x12bc)});_0x289870&&(await _0x2c5bcf[_0x70ae31(0x36b)][_0x70ae31(0x6d2)](_0x2891ee),_0x3c2f7a(_0x4972c5));}let _0x12e29c=0x0;const _0x560b85=0x2;function _0x31ba2c(){const _0x4191bd=_0x419fa8,_0x494c61=document[_0x4191bd(0x9c8)](_0x4191bd(0x300)),_0x4e805a=document['getElementById'](_0x4191bd(0x1287)),_0x2fbd00=document['querySelectorAll']('.pagination-dot');let _0x3e626b=0x0,_0x8dc98a=0x0,_0x466ea4=0x0,_0x430402=![],_0x460d07=!![];const _0x5c918e=()=>{const _0x333e6d=_0x4191bd;_0x4e805a[_0x333e6d(0x5e1)]['transform']=_0x333e6d(0x136b)+_0x12e29c*(0x64/_0x560b85)+'%)',_0x2fbd00[_0x333e6d(0x591)]((_0x398c5c,_0x36b817)=>{const _0xa3db4d=_0x333e6d;_0x398c5c[_0xa3db4d(0x575)][_0xa3db4d(0x1c3)](_0xa3db4d(0x113d),_0x36b817===_0x12e29c);});},_0xda6002=_0x41c6ea=>{const _0x200a45=_0x4191bd;_0x430402=!![],_0x460d07=!![],_0x3e626b=_0x41c6ea[_0x200a45(0x12d9)][_0x200a45(0x930)](_0x200a45(0x7b5))?_0x41c6ea[_0x200a45(0xeff)]:_0x41c6ea['touches'][0x0][_0x200a45(0xeff)],_0x8dc98a=_0x41c6ea['type']['includes']('mouse')?_0x41c6ea['pageY']:_0x41c6ea['touches'][0x0]['pageY'],_0x4e805a[_0x200a45(0x5e1)]['transition']=_0x200a45(0x8f6);},_0x1047f6=_0x575fcd=>{const _0x562f56=_0x4191bd;if(!_0x430402)return;const _0xdc594d=_0x575fcd['type'][_0x562f56(0x930)]('mouse')?_0x575fcd[_0x562f56(0x42f)]:_0x575fcd[_0x562f56(0x781)][0x0][_0x562f56(0x42f)];_0x466ea4=_0x575fcd[_0x562f56(0x12d9)][_0x562f56(0x930)](_0x562f56(0x7b5))?_0x575fcd['pageX']:_0x575fcd[_0x562f56(0x781)][0x0]['pageX'];const _0x5d7077=_0x466ea4-_0x3e626b,_0x376e3a=_0xdc594d-_0x8dc98a;_0x460d07&&(Math[_0x562f56(0x4e2)](_0x5d7077)>0xa||Math[_0x562f56(0x4e2)](_0x376e3a)>0xa)&&(_0x460d07=![]);if(Math['abs'](_0x5d7077)>Math[_0x562f56(0x4e2)](_0x376e3a)){if(_0x575fcd[_0x562f56(0x748)])_0x575fcd[_0x562f56(0xf26)]();_0x4e805a[_0x562f56(0x5e1)][_0x562f56(0xf57)]=_0x562f56(0x1149)+_0x12e29c*(0x64/_0x560b85)+'%\x20+\x20'+_0x5d7077+_0x562f56(0xb6e);}},_0x422eca=_0x31d7e4=>{const _0x36de0c=_0x4191bd;if(!_0x430402)return;_0x430402=![],_0x4e805a[_0x36de0c(0x5e1)][_0x36de0c(0x758)]='transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)';if(_0x460d07){_0x5c918e();return;}const _0x1d3606=_0x466ea4-_0x3e626b;if(Math[_0x36de0c(0x4e2)](_0x1d3606)>_0x494c61[_0x36de0c(0x138e)]/0x4){if(_0x1d3606>0x0&&_0x12e29c>0x0)_0x12e29c--;else _0x1d3606<0x0&&_0x12e29c<_0x560b85-0x1&&_0x12e29c++;}_0x5c918e();};_0x494c61[_0x4191bd(0xa0f)]('mousedown',_0xda6002),_0x494c61[_0x4191bd(0xa0f)](_0x4191bd(0x726),_0x1047f6),_0x494c61[_0x4191bd(0xa0f)](_0x4191bd(0xdf0),_0x422eca),_0x494c61['addEventListener'](_0x4191bd(0xcc9),_0x422eca),_0x494c61[_0x4191bd(0xa0f)](_0x4191bd(0xa6d),_0xda6002,{'passive':![]}),_0x494c61[_0x4191bd(0xa0f)]('touchmove',_0x1047f6,{'passive':![]}),_0x494c61['addEventListener']('touchend',_0x422eca);}let _0x46d2fa=null;async function _0x22d9f2(){await _0x380d6a(),_0xe5834e('preset-screen');}async function _0x380d6a(){const _0x34b3ac=_0x419fa8,_0x1aaaee=document['getElementById'](_0x34b3ac(0x113c)),_0x2b8f48=document[_0x34b3ac(0x9c8)]('preset-content-container');_0x1aaaee[_0x34b3ac(0x2f5)]='',_0x2b8f48[_0x34b3ac(0x2f5)]='';const [_0x2d4002,_0x557d62]=await Promise[_0x34b3ac(0xd0a)]([_0x2c5bcf[_0x34b3ac(0x10ef)][_0x34b3ac(0x5ff)](),_0x2c5bcf[_0x34b3ac(0x99f)]['orderBy'](_0x34b3ac(0x609))[_0x34b3ac(0x5ff)]()]);_0x9ebf46[_0x34b3ac(0x10ef)]=_0x2d4002;if(_0x2d4002[_0x34b3ac(0xa06)]===0x0){_0x2b8f48['innerHTML']=_0x34b3ac(0x12ad);return;}const _0x3f2cc=document[_0x34b3ac(0x28a)](_0x34b3ac(0x82f));_0x3f2cc['className']='world-book-tab\x20active',_0x3f2cc['textContent']='全部',_0x3f2cc['dataset'][_0x34b3ac(0x408)]=_0x34b3ac(0xd0a),_0x1aaaee[_0x34b3ac(0x7b9)](_0x3f2cc);const _0x40cfd7=document[_0x34b3ac(0x28a)](_0x34b3ac(0x11f4));_0x40cfd7['className']='world-book-category-pane\x20active',_0x40cfd7[_0x34b3ac(0xc9f)]['categoryId']=_0x34b3ac(0xd0a),_0x2b8f48['appendChild'](_0x40cfd7),_0x557d62[_0x34b3ac(0x591)](_0x225571=>{const _0x3ae830=_0x34b3ac,_0x383dcf=document[_0x3ae830(0x28a)](_0x3ae830(0x82f));_0x383dcf[_0x3ae830(0x82c)]=_0x3ae830(0xa38),_0x383dcf[_0x3ae830(0xe24)]=_0x225571[_0x3ae830(0x609)],_0x383dcf[_0x3ae830(0xc9f)][_0x3ae830(0x408)]=String(_0x225571['id']),_0x1aaaee['appendChild'](_0x383dcf);const _0x5d3457=document[_0x3ae830(0x28a)]('div');_0x5d3457['className']=_0x3ae830(0x297),_0x5d3457['dataset']['categoryId']=String(_0x225571['id']),_0x2b8f48['appendChild'](_0x5d3457);});const _0x4edc61=_0x2d4002[_0x34b3ac(0x10b2)](_0x39fddf=>!_0x39fddf[_0x34b3ac(0x408)]);if(_0x4edc61){const _0x518f05=document['createElement']('button');_0x518f05[_0x34b3ac(0x82c)]='world-book-tab',_0x518f05['textContent']=_0x34b3ac(0x6ea),_0x518f05[_0x34b3ac(0xc9f)]['categoryId']=_0x34b3ac(0x247),_0x1aaaee[_0x34b3ac(0x7b9)](_0x518f05);const _0xa0a7ac=document['createElement']('div');_0xa0a7ac[_0x34b3ac(0x82c)]=_0x34b3ac(0x297),_0xa0a7ac[_0x34b3ac(0xc9f)][_0x34b3ac(0x408)]='uncategorized',_0x2b8f48['appendChild'](_0xa0a7ac);}_0x2d4002[_0x34b3ac(0x591)](_0x4b4cc6=>{const _0x329050=_0x34b3ac,_0x3631a7=_0x329050(0xd98)+_0x4b4cc6[_0x329050(0x53b)][_0x329050(0xa06)]+'\x20个条目。',_0x4d81b2=document[_0x329050(0x28a)](_0x329050(0x11f4));_0x4d81b2[_0x329050(0x82c)]='world-book-card',_0x4d81b2['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x4b4cc6[_0x329050(0x609)]+_0x329050(0xc0e)+_0x3631a7+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x884d2b=()=>_0x37397b(_0x4b4cc6['id']),_0x3a17a5=async()=>{const _0x1d1a72=_0x329050,_0x41d3e3=await _0x352ae9('删除预设',_0x1d1a72(0x5d2)+_0x4b4cc6['name']+_0x1d1a72(0xf50),{'confirmButtonClass':_0x1d1a72(0x12bc)});_0x41d3e3&&(await _0x2c5bcf['presets'][_0x1d1a72(0x6d2)](_0x4b4cc6['id']),_0x9ebf46[_0x1d1a72(0x10ef)]=await _0x2c5bcf[_0x1d1a72(0x10ef)][_0x1d1a72(0x5ff)](),_0x380d6a());};_0x4d81b2['addEventListener']('click',_0x884d2b),_0x43a60a(_0x4d81b2,_0x3a17a5);const _0x3640d7=_0x4d81b2['cloneNode'](!![]);_0x3640d7[_0x329050(0xa0f)](_0x329050(0xf5c),_0x884d2b),_0x43a60a(_0x3640d7,_0x3a17a5),_0x40cfd7[_0x329050(0x7b9)](_0x3640d7);const _0x7055e=_0x4b4cc6['categoryId']?String(_0x4b4cc6[_0x329050(0x408)]):_0x329050(0x247),_0x14a690=_0x2b8f48[_0x329050(0x91d)](_0x329050(0x815)+_0x7055e+'\x22]');_0x14a690&&_0x14a690[_0x329050(0x7b9)](_0x4d81b2);}),document[_0x34b3ac(0x7e4)](_0x34b3ac(0xc35))['forEach'](_0x2f3e49=>{const _0x20cec6=_0x34b3ac;_0x2f3e49[_0x20cec6(0xa0f)](_0x20cec6(0xf5c),()=>_0x19310f(_0x2f3e49['dataset'][_0x20cec6(0x408)]));});}function _0x19310f(_0xf326bc){const _0x5aa19e=_0x419fa8;document[_0x5aa19e(0x7e4)]('#preset-tabs\x20.world-book-tab')[_0x5aa19e(0x591)](_0x508a8b=>{const _0x119076=_0x5aa19e;_0x508a8b['classList'][_0x119076(0x1c3)](_0x119076(0x113d),_0x508a8b[_0x119076(0xc9f)]['categoryId']===_0xf326bc);}),document[_0x5aa19e(0x7e4)](_0x5aa19e(0x111a))['forEach'](_0x4ec0ed=>{const _0x372c1b=_0x5aa19e;_0x4ec0ed[_0x372c1b(0x575)][_0x372c1b(0x1c3)](_0x372c1b(0x113d),_0x4ec0ed[_0x372c1b(0xc9f)][_0x372c1b(0x408)]===_0xf326bc);});}async function _0x37397b(_0x157314){const _0x223718=_0x419fa8;_0xe5834e(_0x223718(0x12db)),_0x46d2fa=_0x157314;try{const [_0x2c897e,_0x547f34]=await Promise['all']([_0x2c5bcf[_0x223718(0x10ef)]['get'](_0x157314),_0x2c5bcf['presetCategories'][_0x223718(0x5ff)]()]);if(!_0x2c897e){console['error'](_0x223718(0x92e),_0x157314),await _0x1bff53(_0x223718(0x1a6),_0x223718(0x232)),_0xe5834e(_0x223718(0xf21));return;}setTimeout(()=>{const _0xf265ad=_0x223718;document[_0xf265ad(0x9c8)](_0xf265ad(0x119e))[_0xf265ad(0xe24)]=_0x2c897e[_0xf265ad(0x609)],document[_0xf265ad(0x9c8)]('preset-name-input')['value']=_0x2c897e[_0xf265ad(0x609)];const _0x43781e=document[_0xf265ad(0x9c8)]('preset-category-select');_0x43781e[_0xf265ad(0x2f5)]=_0xf265ad(0xaff),_0x547f34[_0xf265ad(0x591)](_0x2fa415=>{const _0x50a4dc=_0xf265ad,_0xe84647=document[_0x50a4dc(0x28a)](_0x50a4dc(0x12ef));_0xe84647['value']=_0x2fa415['id'],_0xe84647['textContent']=_0x2fa415[_0x50a4dc(0x609)];if(_0x2c897e['categoryId']===_0x2fa415['id'])_0xe84647[_0x50a4dc(0x631)]=!![];_0x43781e[_0x50a4dc(0x7b9)](_0xe84647);});const _0x38ec1f=document[_0xf265ad(0x9c8)](_0xf265ad(0x8cb));_0x38ec1f[_0xf265ad(0x2f5)]='',Array[_0xf265ad(0xb27)](_0x2c897e[_0xf265ad(0x53b)])&&_0x2c897e[_0xf265ad(0x53b)][_0xf265ad(0xa06)]>0x0?_0x2c897e['content']['forEach'](_0x491a53=>{const _0x5cb156=_0xf265ad,_0x4a40ea=_0x383311(_0x491a53);_0x38ec1f[_0x5cb156(0x7b9)](_0x4a40ea);}):_0x38ec1f[_0xf265ad(0x2f5)]=_0xf265ad(0x10e4);},0x32);}catch(_0x4ac860){console[_0x223718(0x1221)]('打开预设编辑器时发生严重错误:',_0x4ac860),await _0x1bff53(_0x223718(0x1a6),_0x223718(0x795)+_0x4ac860[_0x223718(0x86e)]),_0xe5834e(_0x223718(0xf21));}}function _0x383311(_0x3a046a={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x3ab40b=_0x419fa8,_0x36d764=document[_0x3ab40b(0x28a)]('div');_0x36d764[_0x3ab40b(0x82c)]=_0x3ab40b(0xe97);const _0x3929f9=_0x3a046a['enabled']!==![]?_0x3ab40b(0x1ec):'';_0x36d764[_0x3ab40b(0x2f5)]=_0x3ab40b(0x1154)+_0x3929f9+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22'+(_0x3a046a['comment']||'')+_0x3ab40b(0x1391)+(_0x3a046a[_0x3ab40b(0x2bd)]||[])[_0x3ab40b(0x809)](',\x20')+'\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>'+(_0x3a046a[_0x3ab40b(0x53b)]||'')+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x36d764[_0x3ab40b(0x91d)](_0x3ab40b(0x85c))[_0x3ab40b(0xa0f)]('click',()=>_0x36d764[_0x3ab40b(0x30f)]());const _0x1d8ced=_0x36d764['querySelector']('.toggle-content-btn'),_0x58b82f=_0x36d764[_0x3ab40b(0x91d)](_0x3ab40b(0x7d0));return _0x1d8ced[_0x3ab40b(0xa0f)]('click',()=>{const _0x47b28d=_0x3ab40b,_0x1785bc=_0x58b82f['style'][_0x47b28d(0x3c5)]==='none';_0x58b82f[_0x47b28d(0x5e1)][_0x47b28d(0x3c5)]=_0x1785bc?'block':'none',_0x1d8ced['textContent']=_0x1785bc?'收起':'展开';}),_0x36d764;}async function _0x181a65(){const _0x1bbf50=_0x419fa8;await _0x47864d(),document[_0x1bbf50(0x91d)](_0x1bbf50(0x1042))[_0x1bbf50(0xe24)]=_0x1bbf50(0x1267),document[_0x1bbf50(0x9c8)](_0x1bbf50(0xc74))[_0x1bbf50(0x2fa)]=_0x214b61,document[_0x1bbf50(0x9c8)](_0x1bbf50(0x495))[_0x1bbf50(0x2fa)]=_0x40e699=>{const _0x44cabf=_0x1bbf50;_0x40e699['target'][_0x44cabf(0x575)][_0x44cabf(0x1038)](_0x44cabf(0x5ae))&&_0x10f1ac(parseInt(_0x40e699['target'][_0x44cabf(0xc9f)]['id']));},document[_0x1bbf50(0x9c8)]('close-group-manager-btn')[_0x1bbf50(0x2fa)]=()=>{const _0x4d179a=_0x1bbf50;document[_0x4d179a(0x9c8)](_0x4d179a(0x745))[_0x4d179a(0x575)][_0x4d179a(0x30f)](_0x4d179a(0xc3f)),_0x380d6a();},document['getElementById'](_0x1bbf50(0x745))['classList'][_0x1bbf50(0x68e)](_0x1bbf50(0xc3f));}async function _0x47864d(){const _0x249be2=_0x419fa8,_0xb71929=document[_0x249be2(0x9c8)](_0x249be2(0x495)),_0x3eac7a=await _0x2c5bcf[_0x249be2(0x99f)][_0x249be2(0x5ff)]();_0xb71929[_0x249be2(0x2f5)]='',_0x3eac7a['length']===0x0&&(_0xb71929[_0x249be2(0x2f5)]=_0x249be2(0x814)),_0x3eac7a[_0x249be2(0x591)](_0x1bda32=>{const _0x291b98=_0x249be2,_0x2302ae=document[_0x291b98(0x28a)](_0x291b98(0x11f4));_0x2302ae['className']=_0x291b98(0xf68),_0x2302ae[_0x291b98(0x2f5)]=_0x291b98(0x731)+_0x1bda32['name']+'</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x1bda32['id']+_0x291b98(0xa35),_0xb71929[_0x291b98(0x7b9)](_0x2302ae);});}async function _0x214b61(){const _0xf82684=_0x419fa8,_0x423b4c=document[_0xf82684(0x9c8)](_0xf82684(0x2c1)),_0x1b732d=_0x423b4c[_0xf82684(0x1155)][_0xf82684(0x3f1)]();if(!_0x1b732d)return alert('分类名不能为空！');const _0x488c04=await _0x2c5bcf['presetCategories']['where']('name')[_0xf82684(0xda9)](_0x1b732d)[_0xf82684(0x476)]();if(_0x488c04)return alert(_0xf82684(0xdc9)+_0x1b732d+'\x22\x20已经存在了！');await _0x2c5bcf[_0xf82684(0x99f)]['add']({'name':_0x1b732d}),_0x423b4c['value']='',await _0x47864d();}async function _0x10f1ac(_0xde26a8){const _0x50937d=_0x419fa8,_0xc4ed64=await _0x352ae9(_0x50937d(0x115b),'删除分类后，该分类下的所有预设将变为“未分类”。确定吗？',{'confirmButtonClass':_0x50937d(0x12bc)});_0xc4ed64&&(await _0x2c5bcf[_0x50937d(0x99f)][_0x50937d(0x6d2)](_0xde26a8),await _0x2c5bcf[_0x50937d(0x10ef)][_0x50937d(0xe78)](_0x50937d(0x408))[_0x50937d(0xda9)](_0xde26a8)[_0x50937d(0xf87)]({'categoryId':null}),_0x9ebf46[_0x50937d(0x10ef)]=await _0x2c5bcf['presets'][_0x50937d(0x5ff)](),await _0x47864d());}async function _0x4255ff(_0x5dc03a){const _0x520339=_0x419fa8,_0x2e80dc=_0x5dc03a['target'][_0x520339(0x1216)][0x0];if(!_0x2e80dc)return;try{if(!_0x2e80dc['name']['endsWith']('.json'))throw new Error(_0x520339(0x862));const _0x1ce5e7=await _0x2e80dc[_0x520339(0xbb7)](),_0x1529cd=JSON['parse'](_0x1ce5e7);await _0x39e600(_0x1529cd,_0x2e80dc[_0x520339(0x609)]);}catch(_0x530965){console[_0x520339(0x1221)](_0x520339(0xd51),_0x530965),await _0x1bff53(_0x520339(0x685),_0x520339(0x1087)+_0x530965[_0x520339(0x86e)]);}finally{_0x5dc03a[_0x520339(0x1070)][_0x520339(0x1155)]=null;}}async function _0x39e600(_0x56ec1d,_0x1ee3d6){const _0x371137=_0x419fa8;let _0x5bc22e=[];if(Array[_0x371137(0xb27)](_0x56ec1d[_0x371137(0x11ed)])&&Array[_0x371137(0xb27)](_0x56ec1d[_0x371137(0xb4e)])&&_0x56ec1d['prompt_order'][_0x371137(0xa06)]>0x0){console[_0x371137(0x283)](_0x371137(0xef5));const _0x3d67e3=new Map(_0x56ec1d[_0x371137(0x11ed)]['map'](_0x2340cd=>[_0x2340cd[_0x371137(0x8d6)],_0x2340cd])),_0xf11bf4=_0x56ec1d['prompt_order'][_0x371137(0x12c1)]((_0x5de2e2,_0x424761)=>_0x424761[_0x371137(0x26e)]&&_0x424761['order'][_0x371137(0xa06)]>(_0x5de2e2[_0x371137(0xa06)]||0x0)?_0x424761['order']:_0x5de2e2,[]);_0xf11bf4&&_0xf11bf4['length']>0x0&&(_0x5bc22e=_0xf11bf4[_0x371137(0xa3b)](_0x165210=>{const _0x2979ff=_0x371137,_0xbc6d46=_0x3d67e3[_0x2979ff(0xdf9)](_0x165210[_0x2979ff(0x8d6)]);if(_0xbc6d46)return{'keys':[],'comment':_0xbc6d46[_0x2979ff(0x609)]||_0x2979ff(0x2d7),'content':_0xbc6d46['content']||'','enabled':_0x165210[_0x2979ff(0x38a)]};return null;})[_0x371137(0x401)](Boolean));}else{if(_0x56ec1d[_0x371137(0x1231)]&&typeof _0x56ec1d[_0x371137(0x1231)]===_0x371137(0xc24))console['log']('检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。'),Array['isArray'](_0x56ec1d[_0x371137(0x26e)])?(console['log']('检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。'),_0x5bc22e=_0x56ec1d['order']['map'](_0x4e34da=>_0x56ec1d[_0x371137(0x1231)][_0x4e34da])['filter'](Boolean)[_0x371137(0xa3b)](_0xb49911=>({'keys':_0xb49911['key']||[],'comment':_0xb49911[_0x371137(0x10de)]||_0x371137(0xf27),'content':_0xb49911['content']||'','enabled':!_0xb49911['disable']}))):(console[_0x371137(0x453)](_0x371137(0xa11)),_0x5bc22e=Object[_0x371137(0xeb2)](_0x56ec1d['entries'])[_0x371137(0xa3b)](_0xa91e41=>({'keys':_0xa91e41[_0x371137(0x7e5)]||[],'comment':_0xa91e41[_0x371137(0x10de)]||'无备注','content':_0xa91e41['content']||'','enabled':!_0xa91e41['disable']})));else{if(Array[_0x371137(0xb27)](_0x56ec1d[_0x371137(0x11ed)]))console[_0x371137(0x283)](_0x371137(0xf63)),_0x5bc22e=_0x56ec1d[_0x371137(0x11ed)][_0x371137(0xa3b)](_0x17872a=>({'keys':[],'comment':_0x17872a[_0x371137(0x609)]||'无标题','content':_0x17872a[_0x371137(0x53b)]||'','enabled':!![]}));else throw new Error(_0x371137(0x1214));}}_0x5bc22e=_0x5bc22e[_0x371137(0x401)](_0x2d64b7=>_0x2d64b7['content']);if(_0x5bc22e[_0x371137(0xa06)]===0x0){alert(_0x371137(0xb7f));return;}const _0xc7f099=_0x1ee3d6[_0x371137(0x459)](/\.json$/i,''),_0x5ce6a6=await _0xadb5df('导入\x20Tavern\x20预设',_0x371137(0xc3e),_0xc7f099);if(!_0x5ce6a6||!_0x5ce6a6[_0x371137(0x3f1)]()){alert(_0x371137(0xd95));return;}const _0xe371e7={'id':'preset_'+Date[_0x371137(0x9b7)](),'name':_0x5ce6a6['trim'](),'content':_0x5bc22e,'categoryId':null};await _0x2c5bcf[_0x371137(0x10ef)][_0x371137(0x68e)](_0xe371e7),_0x9ebf46[_0x371137(0x10ef)]['push'](_0xe371e7),await _0x380d6a(),await _0x1bff53(_0x371137(0x858),'已成功从文件导入预设《'+_0x5ce6a6+'》。');}async function _0x6edbb3(_0x481cde){const _0x6feb5f=_0x419fa8,_0x119da7=document[_0x6feb5f(0x9c8)](_0x6feb5f(0x4e6));if(!_0x119da7)return;const _0x15bfee=_0x9ebf46[_0x6feb5f(0x10ef)]||[];_0x119da7['innerHTML']='<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>',_0x15bfee['forEach'](_0xe05484=>{const _0x4c19f8=_0x6feb5f,_0x35810d=document['createElement'](_0x4c19f8(0x12ef));_0x35810d['value']=_0xe05484['id'],_0x35810d[_0x4c19f8(0xe24)]=_0xe05484[_0x4c19f8(0x609)],_0x119da7[_0x4c19f8(0x7b9)](_0x35810d);}),_0x481cde[_0x6feb5f(0x1131)][_0x6feb5f(0x6aa)]&&(_0x119da7[_0x6feb5f(0x1155)]=_0x481cde[_0x6feb5f(0x1131)]['offlinePresetId']);}function _0x50cb6d(){const _0x112d07=_0x419fa8,_0x263a4c=document[_0x112d07(0x9c8)](_0x112d07(0xf52));if(!_0x263a4c)return;_0x263a4c[_0x112d07(0x2f5)]='';let _0x2b722e=_0x9ebf46[_0x112d07(0x1383)]['chatActionButtonsOrder']||_0x3f63fd;_0x2b722e[_0x112d07(0x591)](_0x337813=>{const _0x4099d=_0x112d07,_0x298d72=document[_0x4099d(0x9c8)](_0x337813);if(_0x298d72){const _0x1dc036=document[_0x4099d(0x28a)](_0x4099d(0x11f4));_0x1dc036[_0x4099d(0x82c)]=_0x4099d(0x8f1),_0x1dc036[_0x4099d(0x1335)]=!![],_0x1dc036[_0x4099d(0xc9f)][_0x4099d(0x5d6)]=_0x337813,_0x1dc036['innerHTML']=_0x298d72['innerHTML'],_0x263a4c[_0x4099d(0x7b9)](_0x1dc036);}});}function _0xc4095b(){const _0x4d1524=_0x419fa8,_0x33b7b6=document[_0x4d1524(0x9c8)](_0x4d1524(0xf52));if(!_0x33b7b6)return;let _0x31b921=null;const _0x364891=_0x26ab1a=>{const _0x3edec9=_0x4d1524,_0x1894d6=_0x26ab1a[_0x3edec9(0x1070)]['closest']('.draggable-button-item');if(!_0x1894d6)return;_0x31b921=_0x1894d6,_0x31b921[_0x3edec9(0x575)][_0x3edec9(0x68e)]('dragging');if(_0x26ab1a[_0x3edec9(0x748)])_0x26ab1a[_0x3edec9(0xf26)]();},_0xae039d=_0x5d4c5f=>{const _0x185be5=_0x4d1524;if(!_0x31b921)return;const _0x1b56da=_0x5d4c5f['type'][_0x185be5(0x930)]('mouse')?_0x5d4c5f[_0x185be5(0x223)]:_0x5d4c5f[_0x185be5(0x781)][0x0][_0x185be5(0x223)],_0x4e9bd4=_0x1924d4(_0x33b7b6,_0x1b56da);_0x4e9bd4==null?_0x33b7b6['appendChild'](_0x31b921):_0x33b7b6['insertBefore'](_0x31b921,_0x4e9bd4);},_0x34fc8b=()=>{const _0x43cef6=_0x4d1524;if(!_0x31b921)return;_0x31b921[_0x43cef6(0x575)][_0x43cef6(0x30f)](_0x43cef6(0x104a)),_0x31b921=null,_0x4e361c();};_0x33b7b6[_0x4d1524(0xa0f)](_0x4d1524(0x124a),_0x364891),_0x33b7b6['addEventListener']('touchstart',_0x364891,{'passive':![]}),_0x33b7b6[_0x4d1524(0xa0f)](_0x4d1524(0x726),_0xae039d),_0x33b7b6[_0x4d1524(0xa0f)](_0x4d1524(0x699),_0xae039d,{'passive':![]}),_0x33b7b6[_0x4d1524(0xa0f)]('mouseup',_0x34fc8b),_0x33b7b6[_0x4d1524(0xa0f)](_0x4d1524(0xcc9),_0x34fc8b),_0x33b7b6[_0x4d1524(0xa0f)](_0x4d1524(0xd41),_0x34fc8b);}function _0x1924d4(_0x2e5b07,_0x583475){const _0x1f6c4e=_0x419fa8,_0x49ded4=[..._0x2e5b07[_0x1f6c4e(0x7e4)](_0x1f6c4e(0xc5a))];return _0x49ded4[_0x1f6c4e(0x12c1)]((_0x224a76,_0x205f9c)=>{const _0x4c2035=_0x1f6c4e,_0x3c6a90=_0x205f9c[_0x4c2035(0xe2c)](),_0x30a3a3=_0x583475-_0x3c6a90[_0x4c2035(0x12b6)]-_0x3c6a90[_0x4c2035(0x125e)]/0x2;return _0x30a3a3<0x0&&_0x30a3a3>_0x224a76['offset']?{'offset':_0x30a3a3,'element':_0x205f9c}:_0x224a76;},{'offset':Number[_0x1f6c4e(0xf0d)]})[_0x1f6c4e(0x4c1)];}async function _0x4e361c(){const _0x3ede78=_0x419fa8,_0x231ff8=document[_0x3ede78(0x9c8)](_0x3ede78(0xf52)),_0x1a3072=Array[_0x3ede78(0x13a5)](_0x231ff8[_0x3ede78(0x7e4)]('.draggable-button-item'))[_0x3ede78(0xa3b)](_0x2a238e=>_0x2a238e[_0x3ede78(0xc9f)][_0x3ede78(0x5d6)]);_0x9ebf46[_0x3ede78(0x1383)]['chatActionButtonsOrder']=_0x1a3072,await _0x2c5bcf[_0x3ede78(0x1383)]['put'](_0x9ebf46[_0x3ede78(0x1383)]);}function _0x30dc98(){const _0x45c93d=_0x419fa8,_0xa9940=_0x9ebf46['globalSettings'][_0x45c93d(0x11cb)];if(!_0xa9940||!Array[_0x45c93d(0xb27)](_0xa9940)||_0xa9940[_0x45c93d(0xa06)]===0x0)return;const _0x21fa38=document[_0x45c93d(0x9c8)](_0x45c93d(0x9a0));if(!_0x21fa38)return;_0xa9940[_0x45c93d(0x591)](_0x2031f5=>{const _0x38d47a=_0x45c93d,_0x156a6c=document['getElementById'](_0x2031f5);_0x156a6c&&_0x21fa38[_0x38d47a(0x7b9)](_0x156a6c);});}const _0x3f63fd=[_0x419fa8(0xeb0),_0x419fa8(0x1097),_0x419fa8(0x10b1),'transfer-btn','voice-message-btn',_0x419fa8(0x6de),_0x419fa8(0xfb4),_0x419fa8(0xeb8),_0x419fa8(0xde4),_0x419fa8(0x827),_0x419fa8(0xa92),_0x419fa8(0xe9c),_0x419fa8(0x72e),_0x419fa8(0xe0a),_0x419fa8(0x53e),_0x419fa8(0x364),'propel-btn',_0x419fa8(0x419),_0x419fa8(0x7f6),'read-together-btn'];async function _0x55bcd6(){const _0x4b48c6=_0x419fa8;_0x9ebf46[_0x4b48c6(0x1383)][_0x4b48c6(0x11cb)]=null,await _0x2c5bcf[_0x4b48c6(0x1383)][_0x4b48c6(0xff5)](_0x9ebf46[_0x4b48c6(0x1383)]),_0x50cb6d(),_0x30dc98(),await _0x1bff53('成功',_0x4b48c6(0x8d2));}let _0x623571=[],_0x313fe6=[];function _0x382942(){const _0x3c963e=_0x419fa8,_0x271c45=document[_0x3c963e(0x9c8)](_0x3c963e(0xd29));_0x623571=[],_0x313fe6=[],_0x4a5491(),document[_0x3c963e(0x9c8)](_0x3c963e(0x4f9))['style'][_0x3c963e(0x3c5)]=_0x3c963e(0x989),document['getElementById'](_0x3c963e(0x1079))[_0x3c963e(0x5e1)][_0x3c963e(0x3c5)]=_0x3c963e(0x8f6),_0x271c45[_0x3c963e(0x575)][_0x3c963e(0x68e)]('visible');}function _0x4a5491(){const _0x5d7718=_0x419fa8,_0xe69830=document['getElementById'](_0x5d7718(0xbce));_0xe69830['innerHTML']='';const _0xaeca2c=document['createElement'](_0x5d7718(0x11f4));_0xaeca2c[_0x5d7718(0x82c)]='clear-posts-item',_0xaeca2c[_0x5d7718(0xc9f)][_0x5d7718(0xfed)]=_0x5d7718(0x586),_0xaeca2c['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+(_0x9ebf46[_0x5d7718(0x32c)]['nickname']||'我')+_0x5d7718(0x991),_0xe69830[_0x5d7718(0x7b9)](_0xaeca2c),Object[_0x5d7718(0xeb2)](_0x9ebf46[_0x5d7718(0x547)])['forEach'](_0x570dbc=>{const _0x45f81b=_0x5d7718;if(!_0x570dbc['isGroup']){const _0x55f1fb=document['createElement'](_0x45f81b(0x11f4));_0x55f1fb[_0x45f81b(0x82c)]=_0x45f81b(0xab6),_0x55f1fb[_0x45f81b(0xc9f)][_0x45f81b(0xfed)]=_0x570dbc['id'],_0x55f1fb[_0x45f81b(0x2f5)]=_0x45f81b(0x129c)+_0x570dbc[_0x45f81b(0x609)]+_0x45f81b(0x2a6),_0xe69830[_0x45f81b(0x7b9)](_0x55f1fb);}});}function _0x1889ef(){const _0x255a63=_0x419fa8,_0x193089=document['getElementById'](_0x255a63(0x12bb));_0x193089[_0x255a63(0x2f5)]='';const _0x4745dc=[{'id':_0x255a63(0x8b0),'name':_0x255a63(0x115f),'description':'将清空选定角色的所有对话消息、曾用备注和你的昵称。'},{'id':_0x255a63(0xbfe),'name':_0x255a63(0x7ed),'description':_0x255a63(0x4a6)},{'id':_0x255a63(0xd17),'name':'通话记录','description':_0x255a63(0xa4b)},{'id':_0x255a63(0x12a2),'name':'心声','description':_0x255a63(0x59d)},{'id':_0x255a63(0x137e),'name':_0x255a63(0x10d7),'description':_0x255a63(0x93e)},{'id':_0x255a63(0xc09),'name':'收藏','description':_0x255a63(0x4ff)},{'id':_0x255a63(0x2ec),'name':_0x255a63(0x81f),'description':_0x255a63(0x30e)}];_0x4745dc[_0x255a63(0x591)](_0x15d538=>{const _0x41ad27=_0x255a63,_0x20a007=document[_0x41ad27(0x28a)](_0x41ad27(0x11f4));_0x20a007['className']='clear-posts-item',_0x20a007[_0x41ad27(0xc9f)]['typeId']=_0x15d538['id'],_0x20a007[_0x41ad27(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x15d538['name']+_0x41ad27(0x6e0)+_0x15d538[_0x41ad27(0x1387)]+_0x41ad27(0xe5c),_0x193089[_0x41ad27(0x7b9)](_0x20a007);});}function _0x31ebc8(){const _0x36bebe=_0x419fa8,_0x343ab7=document[_0x36bebe(0x7e4)](_0x36bebe(0x847));if(_0x343ab7[_0x36bebe(0xa06)]===0x0){alert(_0x36bebe(0x69b));return;}_0x623571=Array[_0x36bebe(0x13a5)](_0x343ab7)[_0x36bebe(0xa3b)](_0x173b8d=>_0x173b8d[_0x36bebe(0xc9f)][_0x36bebe(0xfed)]),_0x1889ef(),document[_0x36bebe(0x9c8)]('data-clear-step-1')['style'][_0x36bebe(0x3c5)]=_0x36bebe(0x8f6),document[_0x36bebe(0x9c8)](_0x36bebe(0x1079))[_0x36bebe(0x5e1)][_0x36bebe(0x3c5)]=_0x36bebe(0x989);}function _0x2a73de(){const _0x393819=_0x419fa8;document[_0x393819(0x9c8)]('data-clear-step-2')['style'][_0x393819(0x3c5)]=_0x393819(0x8f6),document[_0x393819(0x9c8)](_0x393819(0x4f9))[_0x393819(0x5e1)][_0x393819(0x3c5)]=_0x393819(0x989),document[_0x393819(0x7e4)]('#data-clear-char-list\x20.clear-posts-item')['forEach'](_0x4680f9=>{const _0x566768=_0x393819;_0x623571[_0x566768(0x930)](_0x4680f9[_0x566768(0xc9f)][_0x566768(0xfed)])&&_0x4680f9['classList'][_0x566768(0x68e)](_0x566768(0x631));});}async function _0x41d22f(){const _0x373541=_0x419fa8,_0x184694=document[_0x373541(0x7e4)]('#data-clear-type-list\x20.clear-posts-item.selected');if(_0x184694[_0x373541(0xa06)]===0x0){alert(_0x373541(0xe7d));return;}_0x313fe6=Array[_0x373541(0x13a5)](_0x184694)[_0x373541(0xa3b)](_0x5d8875=>_0x5d8875['dataset']['typeId']);const _0x480959=await _0x352ae9('最后确认！',_0x373541(0x437),{'confirmButtonClass':_0x373541(0x12bc),'confirmText':_0x373541(0x115b)});if(!_0x480959)return;await _0x1bff53(_0x373541(0x7a4),_0x373541(0xd8d));try{await _0x2c5bcf[_0x373541(0xa88)]('rw',_0x2c5bcf[_0x373541(0xe42)],async()=>{const _0x2d023c=_0x373541;for(const _0x474d6a of _0x623571){for(const _0x4199df of _0x313fe6){if(_0x4199df==='chat'){if(_0x474d6a==='user'){const _0x5a2fab=await _0x2c5bcf[_0x2d023c(0x547)][_0x2d023c(0x5ff)]();for(const _0x205cab of _0x5a2fab){_0x205cab[_0x2d023c(0x8b3)]=_0x205cab[_0x2d023c(0x8b3)][_0x2d023c(0x401)](_0x15a12d=>_0x15a12d[_0x2d023c(0x7fd)]!==_0x2d023c(0x586)),await _0x2c5bcf[_0x2d023c(0x547)]['put'](_0x205cab);}}else{const _0x4fd93b=await _0x2c5bcf[_0x2d023c(0x547)][_0x2d023c(0xdf9)](_0x474d6a);_0x4fd93b&&(_0x4fd93b[_0x2d023c(0x8b3)]=[],_0x4fd93b[_0x2d023c(0x1291)]=_0x2d023c(0xf66),_0x4fd93b[_0x2d023c(0xa1a)]=_0x2d023c(0xf66),Array[_0x2d023c(0xb27)](_0x4fd93b[_0x2d023c(0xd4f)])&&(_0x4fd93b[_0x2d023c(0xd4f)]=[]),_0x4fd93b['settings']&&(_0x4fd93b[_0x2d023c(0x1131)]['myNickname']='我'),await _0x2c5bcf[_0x2d023c(0x547)][_0x2d023c(0xff5)](_0x4fd93b));}}if(_0x4199df===_0x2d023c(0xbfe)){const _0x240686=_0x474d6a===_0x2d023c(0x586)?_0x2d023c(0x586):_0x474d6a;await _0x2c5bcf['qzonePosts']['where'](_0x2d023c(0x61c))[_0x2d023c(0xda9)](_0x240686)[_0x2d023c(0x6d2)]();}_0x4199df===_0x2d023c(0xd17)&&_0x474d6a!==_0x2d023c(0x586)&&await _0x2c5bcf['callRecords']['where'](_0x2d023c(0x54d))[_0x2d023c(0xda9)](_0x474d6a)[_0x2d023c(0x6d2)]();if(_0x4199df===_0x2d023c(0x12a2)&&_0x474d6a!==_0x2d023c(0x586)){const _0x7d9668=await _0x2c5bcf['chats'][_0x2d023c(0xdf9)](_0x474d6a);_0x7d9668&&(_0x7d9668[_0x2d023c(0xec6)]=[],_0x7d9668[_0x2d023c(0x1291)]=_0x2d023c(0xf66),_0x7d9668[_0x2d023c(0xa1a)]=_0x2d023c(0xf66),await _0x2c5bcf[_0x2d023c(0x547)][_0x2d023c(0xff5)](_0x7d9668));}if(_0x4199df===_0x2d023c(0x137e)&&_0x474d6a!==_0x2d023c(0x586)){const _0x3d9d86=await _0x2c5bcf[_0x2d023c(0x547)][_0x2d023c(0xdf9)](_0x474d6a);_0x3d9d86&&(_0x3d9d86[_0x2d023c(0x323)]=[],await _0x2c5bcf[_0x2d023c(0x547)][_0x2d023c(0xff5)](_0x3d9d86));}_0x4199df===_0x2d023c(0xc09)&&(_0x474d6a===_0x2d023c(0x586)?(await _0x2c5bcf[_0x2d023c(0xc09)][_0x2d023c(0xe78)]('type')['equals']('qzone_post')[_0x2d023c(0x401)](_0xa5d04d=>_0xa5d04d[_0x2d023c(0x53b)][_0x2d023c(0x61c)]===_0x2d023c(0x586))[_0x2d023c(0x6d2)](),await _0x2c5bcf[_0x2d023c(0xc09)][_0x2d023c(0xe78)](_0x2d023c(0x12d9))[_0x2d023c(0xda9)](_0x2d023c(0xb3c))[_0x2d023c(0x401)](_0x2911ad=>_0x2911ad[_0x2d023c(0x53b)][_0x2d023c(0x7fd)]===_0x2d023c(0x586))[_0x2d023c(0x6d2)]()):(await _0x2c5bcf[_0x2d023c(0xc09)]['where']('type')[_0x2d023c(0xda9)](_0x2d023c(0xb3c))[_0x2d023c(0xdb2)](_0x13a403=>_0x13a403[_0x2d023c(0x54d)]===_0x474d6a)[_0x2d023c(0x6d2)](),await _0x2c5bcf['favorites'][_0x2d023c(0xe78)]('type')['equals'](_0x2d023c(0x411))[_0x2d023c(0x401)](_0x415b5c=>_0x415b5c[_0x2d023c(0x53b)][_0x2d023c(0x61c)]===_0x474d6a)[_0x2d023c(0x6d2)](),await _0x2c5bcf[_0x2d023c(0xc09)][_0x2d023c(0xe78)](_0x2d023c(0x12d9))[_0x2d023c(0xda9)](_0x2d023c(0x423))[_0x2d023c(0x401)](_0x52ba5f=>_0x52ba5f[_0x2d023c(0x53b)][_0x2d023c(0xf24)]===_0x474d6a)[_0x2d023c(0x6d2)](),await _0x2c5bcf[_0x2d023c(0xc09)]['where'](_0x2d023c(0x12d9))[_0x2d023c(0xda9)]('char_browser_article')[_0x2d023c(0x401)](_0x54700b=>_0x54700b[_0x2d023c(0x53b)][_0x2d023c(0xf24)]===_0x474d6a)[_0x2d023c(0x6d2)](),await _0x2c5bcf[_0x2d023c(0xc09)][_0x2d023c(0xe78)](_0x2d023c(0x12d9))[_0x2d023c(0xda9)](_0x2d023c(0x136c))[_0x2d023c(0x401)](_0x4a6f68=>_0x4a6f68[_0x2d023c(0x53b)]['characterId']===_0x474d6a)['delete']()));if(_0x4199df===_0x2d023c(0x2ec)&&_0x474d6a!==_0x2d023c(0x586)){const _0x1dbf68=await _0x2c5bcf[_0x2d023c(0x547)][_0x2d023c(0xdf9)](_0x474d6a);_0x1dbf68&&(_0x1dbf68[_0x2d023c(0x343)]=[],_0x1dbf68['simulatedConversations']=[],_0x1dbf68['simulatedBrowserHistory']=[],_0x1dbf68['simulatedTaobaoHistory']=null,_0x1dbf68[_0x2d023c(0x12e5)]=[],_0x1dbf68[_0x2d023c(0x753)]=[],_0x1dbf68[_0x2d023c(0x440)]=[],_0x1dbf68['diary']=[],_0x1dbf68[_0x2d023c(0x6e9)]=[],await _0x2c5bcf[_0x2d023c(0x547)][_0x2d023c(0xff5)](_0x1dbf68));}}}}),await _0x41edb1(),await _0x394b2c(),document[_0x373541(0x9c8)](_0x373541(0xd29))[_0x373541(0x575)][_0x373541(0x30f)](_0x373541(0xc3f)),await _0x1bff53(_0x373541(0x4c8),_0x373541(0x7c1));}catch(_0x1de99d){console[_0x373541(0x1221)](_0x373541(0x38c),_0x1de99d),await _0x1bff53('清理失败',_0x373541(0xcb0)+_0x1de99d[_0x373541(0x86e)]);}}async function _0x58f257(_0x54786,_0x2368e6,_0x5b6951){const _0x54e3e6=_0x419fa8,_0x2b0eab=_0x5b6951[_0x54e3e6(0x91d)](_0x54e3e6(0x3d3))[_0x54e3e6(0x47c)],_0x370e64=await _0xb8c832(_0x54e3e6(0x3c4)+_0x2b0eab+_0x54e3e6(0x51d),[{'text':_0x54e3e6(0x9c7),'value':'local'},{'text':'🌐\x20使用网络URL','value':_0x54e3e6(0x11be)}]);let _0x1b463f=null;if(_0x370e64==='local')_0x1b463f=await _0x750485();else{if(_0x370e64==='url'){const _0x209c7f=_0x2368e6==='cphone'?_0x9ebf46[_0x54e3e6(0x1383)][_0x54e3e6(0xe9b)][_0x54786]:_0x9ebf46[_0x54e3e6(0x1383)][_0x54e3e6(0x11b3)][_0x54786],_0x2efad5=_0x209c7f[_0x54e3e6(0xc8d)]('data:image'),_0x49b34a=_0x2efad5?'':_0x209c7f;_0x1b463f=await _0xadb5df(_0x54e3e6(0xd3b),'请输入新的图片URL',_0x49b34a,'url');}}if(_0x1b463f&&_0x1b463f[_0x54e3e6(0x3f1)]()){const _0x558d6a=_0x1b463f[_0x54e3e6(0x3f1)]();_0x2368e6==='cphone'?_0x9ebf46['globalSettings'][_0x54e3e6(0xe9b)][_0x54786]=_0x558d6a:_0x9ebf46[_0x54e3e6(0x1383)][_0x54e3e6(0x11b3)][_0x54786]=_0x558d6a,_0x5b6951[_0x54e3e6(0x91d)]('.icon-preview')[_0x54e3e6(0xbf4)]=_0x558d6a;}else _0x1b463f!==null&&alert(_0x54e3e6(0x290));}async function _0x16b97f(){const _0x2e2235=_0x419fa8,_0x47cf21=await _0x352ae9(_0x2e2235(0x114f),'此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>',{'confirmButtonClass':_0x2e2235(0x12bc),'confirmText':'我已了解风险，确认压缩'});if(!_0x47cf21)return;await _0x1bff53('请稍候...','正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...');let _0x248082={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console[_0x2e2235(0x283)]('压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...');const _0x419789=[_0x2e2235(0x547),'globalSettings',_0x2e2235(0x32c),_0x2e2235(0x774),_0x2e2235(0x36b)],_0x26d838=[];for(const _0x29c4cc of _0x419789){const _0x4256b5=_0x2c5bcf[_0x2e2235(0x11de)](_0x29c4cc),_0x24f496=await _0x4256b5[_0x2e2235(0x5ff)]();_0x26d838[_0x2e2235(0x668)]({'tableName':_0x29c4cc,'records':_0x24f496});}console['log']('压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...');for(const _0x4b9d7f of _0x26d838){for(const _0x244a53 of _0x4b9d7f['records']){await _0x2b2b8f(_0x244a53,_0x248082);}}console['log']('压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...'),await _0x2c5bcf[_0x2e2235(0xa88)]('rw',_0x419789,async()=>{const _0xaacf15=_0x2e2235;for(const _0x4948db of _0x26d838){await _0x2c5bcf[_0xaacf15(0x11de)](_0x4948db[_0xaacf15(0x10e1)])['bulkPut'](_0x4948db[_0xaacf15(0x1302)]);}});const _0x20b3ac=_0x248082[_0x2e2235(0x89b)]-_0x248082[_0x2e2235(0xd71)],_0x53d4ed=_0x248082['originalSize']>0x0?(_0x20b3ac/_0x248082[_0x2e2235(0x89b)]*0x64)['toFixed'](0x2):0x0;await _0x1bff53(_0x2e2235(0x389),_0x2e2235(0x12a4)+_0x248082[_0x2e2235(0x32b)]+_0x2e2235(0x385)+_0x248082['compressed']+_0x2e2235(0x451)+_0x248082[_0x2e2235(0x32a)]+_0x2e2235(0x11a0)+(_0x20b3ac/0x400/0x400)[_0x2e2235(0x752)](0x2)+'\x20MB</strong>\x20(压缩率\x20'+_0x53d4ed+_0x2e2235(0x4a5));}catch(_0x58eec2){console[_0x2e2235(0x1221)](_0x2e2235(0xeaf),_0x58eec2),await _0x1bff53(_0x2e2235(0x112f),_0x2e2235(0xcb0)+_0x58eec2[_0x2e2235(0x86e)]);}}function _0x5af8a0(_0x40cca9,_0x25d501=''){const _0x4593a7=_0x419fa8;let _0x490cd9=0x0;for(const _0x3710d5 in _0x40cca9){if(_0x40cca9['hasOwnProperty'](_0x3710d5)){const _0x56afbb=_0x40cca9[_0x3710d5];if(typeof _0x56afbb===_0x4593a7(0xe56)&&_0x56afbb[_0x4593a7(0xc8d)](_0x4593a7(0x11a5))){const _0x1969ba=_0x25d501===_0x4593a7(0x1383)&&(_0x3710d5===_0x4593a7(0x1254)||_0x3710d5===_0x4593a7(0xe0b)||_0x3710d5===_0x4593a7(0x73a))||_0x25d501===_0x4593a7(0xa5e)||_0x25d501==='settings'&&_0x3710d5==='background'||(_0x25d501===_0x4593a7(0x11b3)||_0x25d501===_0x4593a7(0xe9b));!_0x1969ba&&(_0x490cd9+=_0x56afbb[_0x4593a7(0xa06)]);}else typeof _0x56afbb===_0x4593a7(0xc24)&&_0x56afbb!==null&&(_0x490cd9+=_0x5af8a0(_0x56afbb,_0x3710d5));}}return _0x490cd9;}async function _0x1671a7(){const _0x54cc71=_0x419fa8,_0x35faf7=document[_0x54cc71(0x9c8)](_0x54cc71(0xbc2));if(!_0x35faf7)return;_0x35faf7[_0x54cc71(0x2f5)]=_0x54cc71(0x27f);try{let _0x26b046=0x0;const _0xfae76b=[_0x54cc71(0x547),'globalSettings',_0x54cc71(0x32c),_0x54cc71(0x774),'customAvatarFrames'];for(const _0x2ecaa2 of _0xfae76b){const _0x19b779=_0x2c5bcf[_0x54cc71(0x11de)](_0x2ecaa2);await _0x19b779[_0x54cc71(0x1075)](_0x36089c=>{_0x26b046+=_0x5af8a0(_0x36089c);});}const _0x4cf881=(_0x26b046/0x400/0x400)[_0x54cc71(0x752)](0x2);_0x35faf7[_0x54cc71(0x2f5)]=_0x54cc71(0x2cb)+_0x4cf881+_0x54cc71(0x384);}catch(_0x38f397){console[_0x54cc71(0x1221)](_0x54cc71(0x562),_0x38f397),_0x35faf7[_0x54cc71(0x2f5)]=_0x54cc71(0xe08);}}async function _0x2b2b8f(_0x42cf3e,_0x186193,_0x14ea1b=''){const _0x25893d=_0x419fa8;for(const _0x3cdf80 in _0x42cf3e){if(_0x42cf3e['hasOwnProperty'](_0x3cdf80)){const _0x335dcb=_0x42cf3e[_0x3cdf80];if(typeof _0x335dcb===_0x25893d(0xe56)&&_0x335dcb[_0x25893d(0xc8d)](_0x25893d(0x11a5))){const _0x18b798=_0x14ea1b==='globalSettings'&&(_0x3cdf80==='wallpaper'||_0x3cdf80===_0x25893d(0xe0b)||_0x3cdf80===_0x25893d(0x73a))||_0x14ea1b==='widgetData'||_0x14ea1b==='settings'&&_0x3cdf80===_0x25893d(0x93f)||(_0x14ea1b===_0x25893d(0x11b3)||_0x14ea1b===_0x25893d(0xe9b));if(_0x18b798)continue;_0x186193[_0x25893d(0x32b)]++,_0x186193[_0x25893d(0x89b)]+=_0x335dcb[_0x25893d(0xa06)];const _0x554ba7=await _0x17899a(_0x335dcb);_0x554ba7&&_0x554ba7!==_0x335dcb?(_0x42cf3e[_0x3cdf80]=_0x554ba7,_0x186193[_0x25893d(0xb84)]++,_0x186193[_0x25893d(0xd71)]+=_0x554ba7[_0x25893d(0xa06)]):(_0x186193['skipped']++,_0x186193[_0x25893d(0xd71)]+=_0x335dcb[_0x25893d(0xa06)]);}else typeof _0x335dcb===_0x25893d(0xc24)&&_0x335dcb!==null&&await _0x2b2b8f(_0x335dcb,_0x186193,_0x3cdf80);}}}function _0x17899a(_0x49bcc1,_0x17d48d={}){return new Promise(_0x91e7e3=>{const _0x58cf76=_0x3569;if(!_0x49bcc1[_0x58cf76(0xc8d)](_0x58cf76(0x11a5))){console[_0x58cf76(0x453)]('非图片格式，跳过压缩:',_0x49bcc1['substring'](0x0,0x32)+'...'),_0x91e7e3(_0x49bcc1);return;}const _0x371abc=_0x17d48d['quality']||0.5,_0x4f4873=_0x17d48d[_0x58cf76(0xa78)]||0x320,_0x115b69=new Image();_0x115b69[_0x58cf76(0x429)]=()=>{const _0x3ef8e4=_0x58cf76;let _0x42c988=_0x115b69[_0x3ef8e4(0x125e)],_0x30275a=_0x115b69[_0x3ef8e4(0x3ff)];_0x42c988>_0x4f4873&&(_0x30275a=Math[_0x3ef8e4(0xe3e)](_0x4f4873/_0x42c988*_0x30275a),_0x42c988=_0x4f4873);const _0x581e9f=document[_0x3ef8e4(0x28a)](_0x3ef8e4(0x8c2));_0x581e9f['width']=_0x42c988,_0x581e9f[_0x3ef8e4(0x3ff)]=_0x30275a;const _0x3e5b95=_0x581e9f[_0x3ef8e4(0xaa8)]('2d');_0x3e5b95['drawImage'](_0x115b69,0x0,0x0,_0x42c988,_0x30275a);const _0x5fa622=_0x581e9f[_0x3ef8e4(0x3e0)]('image/jpeg',_0x371abc);_0x91e7e3(_0x5fa622);},_0x115b69[_0x58cf76(0x11e5)]=()=>{const _0xd80f0a=_0x58cf76;console[_0xd80f0a(0x453)](_0xd80f0a(0xaae),_0x49bcc1['substring'](0x0,0x32)+_0xd80f0a(0xf66)),_0x91e7e3(_0x49bcc1);},_0x115b69[_0x58cf76(0xbf4)]=_0x49bcc1;});}function _0x574d0a(_0x2ad5c5,_0x209c40){const _0x58b6c5=_0x419fa8;if(!_0x2ad5c5||!_0x209c40||typeof _0x2ad5c5!==_0x58b6c5(0xe56)||typeof _0x209c40!=='string')return 0x0;const _0x579bea=_0x2ad5c5[_0x58b6c5(0x6c6)]('.')[_0x58b6c5(0xa3b)](Number),_0x144be9=_0x209c40['split']('.')['map'](Number),_0x4462d9=Math[_0x58b6c5(0x24e)](_0x579bea[_0x58b6c5(0xa06)],_0x144be9['length']);for(let _0x5aee64=0x0;_0x5aee64<_0x4462d9;_0x5aee64++){const _0x428442=_0x579bea[_0x5aee64]||0x0,_0x474a28=_0x144be9[_0x5aee64]||0x0;if(_0x428442>_0x474a28)return 0x1;if(_0x428442<_0x474a28)return-0x1;}return 0x0;}async function _0x52a623(){const _0x1b8f60=_0x419fa8,_0x743467=_0x1b8f60(0xccc);try{const _0x1af278=await fetch(_0x1b8f60(0xc0a)+Date[_0x1b8f60(0x9b7)]());if(!_0x1af278['ok']){console[_0x1b8f60(0x453)](_0x1b8f60(0x9b3));return;}const _0x28fac5=await _0x1af278[_0x1b8f60(0xbb7)](),_0x4a7725=document[_0x1b8f60(0x28a)](_0x1b8f60(0x11f4));_0x4a7725[_0x1b8f60(0x2f5)]=_0x28fac5;const _0x3601fe=_0x4a7725[_0x1b8f60(0x91d)](_0x1b8f60(0x22f));if(!_0x3601fe){console[_0x1b8f60(0x1221)]('更新通知文件中缺少\x20data-version\x20属性。');return;}const _0x3db9b8=_0x3601fe[_0x1b8f60(0xc9f)][_0x1b8f60(0x977)],_0x2ad9dd=localStorage['getItem'](_0x1b8f60(0x697));!_0x2ad9dd||_0x574d0a(_0x3db9b8,_0x2ad9dd)>0x0?(console[_0x1b8f60(0x283)](_0x1b8f60(0x10fe)+_0x3db9b8+'\x20(已忽略版本:\x20'+(_0x2ad9dd||'无')+')'),_0x3472fb(_0x3db9b8,_0x3601fe[_0x1b8f60(0x2f5)])):console[_0x1b8f60(0x283)](_0x1b8f60(0x135a)+_0x3db9b8+')\x20已被用户忽略或为旧版本，无需显示。');}catch(_0x2274d3){console[_0x1b8f60(0x1221)](_0x1b8f60(0x1180),_0x2274d3);}}function _0x3472fb(_0x7fff2e,_0x236d1d){const _0x277ee6=_0x419fa8,_0x443542=document[_0x277ee6(0x9c8)](_0x277ee6(0x4cb)),_0x196955=document[_0x277ee6(0x9c8)](_0x277ee6(0xfb3)),_0x355a74=document['getElementById']('update-notice-confirm-btn'),_0x2b8660=document[_0x277ee6(0x9c8)](_0x277ee6(0x10e0));_0x196955[_0x277ee6(0x2f5)]=_0x236d1d,_0x355a74[_0x277ee6(0x2fa)]=()=>{const _0x3fb3e8=_0x277ee6;_0x443542[_0x3fb3e8(0x575)]['remove'](_0x3fb3e8(0xc3f));},_0x2b8660['onclick']=()=>{const _0x21e5e5=_0x277ee6;localStorage[_0x21e5e5(0xa65)](_0x21e5e5(0x697),_0x7fff2e),_0x443542[_0x21e5e5(0x575)][_0x21e5e5(0x30f)](_0x21e5e5(0xc3f)),console[_0x21e5e5(0x283)](_0x21e5e5(0x1399)+_0x7fff2e);},_0x443542['classList'][_0x277ee6(0x68e)](_0x277ee6(0xc3f));}function _0x5015ab(){const _0x25c7b1=_0x419fa8,_0xc7bf25=document[_0x25c7b1(0x9c8)](_0x25c7b1(0xfaa));document[_0x25c7b1(0x9c8)]('douban-min-posts-input')['value']=_0x9ebf46['globalSettings'][_0x25c7b1(0x387)]||0xc,document['getElementById'](_0x25c7b1(0x130f))[_0x25c7b1(0x1155)]=_0x9ebf46[_0x25c7b1(0x1383)]['doubanMaxPosts']||0x14,_0xc7bf25[_0x25c7b1(0x575)]['add']('visible');}async function _0x1a61ec(){const _0x33ef66=_0x419fa8,_0x31d56d=document[_0x33ef66(0x9c8)](_0x33ef66(0xcdd)),_0x43fa70=document[_0x33ef66(0x9c8)](_0x33ef66(0x130f)),_0x23b36e=parseInt(_0x31d56d['value']),_0x1f4322=parseInt(_0x43fa70[_0x33ef66(0x1155)]);if(isNaN(_0x23b36e)||isNaN(_0x1f4322)||_0x23b36e<0x1||_0x1f4322<0x1){alert(_0x33ef66(0x8c4));return;}if(_0x23b36e>_0x1f4322){alert(_0x33ef66(0x1105));return;}_0x9ebf46['globalSettings'][_0x33ef66(0x387)]=_0x23b36e,_0x9ebf46[_0x33ef66(0x1383)]['doubanMaxPosts']=_0x1f4322,await _0x2c5bcf['globalSettings'][_0x33ef66(0xff5)](_0x9ebf46[_0x33ef66(0x1383)]),document['getElementById'](_0x33ef66(0xfaa))[_0x33ef66(0x575)][_0x33ef66(0x30f)]('visible'),await _0x1bff53(_0x33ef66(0x1324),'豆瓣设置已更新！下次重新生成时将生效。');}async function _0x29b196(_0x3d0c8e){const _0x51efe5=_0x419fa8,_0x1cd56f=document[_0x51efe5(0x9c8)](_0x51efe5(0x96a)),_0x473636=document[_0x51efe5(0x9c8)]('werewolf-player-selection-list');_0x473636[_0x51efe5(0x2f5)]='';let _0x591e16=[];if(_0x3d0c8e===_0x51efe5(0x1024)){const _0x3fa38c=Object['values'](_0x9ebf46[_0x51efe5(0x547)])[_0x51efe5(0x401)](_0x4511d7=>!_0x4511d7[_0x51efe5(0x11e4)]),_0x567cef=await _0x2c5bcf[_0x51efe5(0x1094)]['toArray']();_0x591e16=[{'id':_0x51efe5(0x586),'name':_0x9ebf46[_0x51efe5(0x32c)][_0x51efe5(0x5b7)]||'我','originalName':_0x9ebf46['qzoneSettings'][_0x51efe5(0x5b7)]||'我','avatar':_0x9ebf46[_0x51efe5(0x32c)][_0x51efe5(0x10c9)],'type':_0x51efe5(0x586)},..._0x3fa38c['map'](_0x1f2d2a=>({'id':_0x1f2d2a['id'],'name':_0x1f2d2a[_0x51efe5(0x609)],'originalName':_0x1f2d2a[_0x51efe5(0x1071)],'avatar':_0x1f2d2a[_0x51efe5(0x1131)][_0x51efe5(0xd4d)],'type':_0x51efe5(0x96c)})),..._0x567cef[_0x51efe5(0xa3b)](_0x27739a=>({'id':_0x51efe5(0x2e7)+_0x27739a['id'],'name':_0x27739a[_0x51efe5(0x609)],'originalName':_0x27739a[_0x51efe5(0x609)],'avatar':_0x27739a[_0x51efe5(0x10c9)],'type':_0x51efe5(0xc7e)}))],_0x1c1d43[_0x51efe5(0x54d)]=null;}else{const _0x2c9266=_0x9ebf46['chats'][_0x9ebf46[_0x51efe5(0x970)]];if(!_0x2c9266||!_0x2c9266[_0x51efe5(0x11e4)])return;_0x591e16=[{'id':_0x51efe5(0x586),'name':_0x2c9266[_0x51efe5(0x1131)][_0x51efe5(0x29c)]||'我','originalName':_0x9ebf46[_0x51efe5(0x32c)][_0x51efe5(0x5b7)]||'我','avatar':_0x2c9266[_0x51efe5(0x1131)][_0x51efe5(0xb60)],'type':_0x51efe5(0x586)},..._0x2c9266[_0x51efe5(0xd3e)]['map'](_0x262cb9=>{const _0x3190e1=_0x51efe5,_0x1236e9=_0x9ebf46['chats'][_0x262cb9['id']],_0x567473=_0x262cb9[_0x3190e1(0x10c9)]||(_0x1236e9?_0x1236e9['settings'][_0x3190e1(0xd4d)]:_0x337c8f);return{'id':_0x262cb9['id'],'name':_0x262cb9['groupNickname'],'originalName':_0x262cb9['originalName'],'avatar':_0x567473,'type':_0x262cb9['isNpc']?_0x3190e1(0xc7e):_0x3190e1(0x96c)};})],_0x1c1d43['chatId']=_0x9ebf46['activeChatId'];}_0x591e16[_0x51efe5(0x591)](_0x42078e=>{const _0x480542=_0x51efe5,_0x354025=document[_0x480542(0x28a)](_0x480542(0x11f4));_0x354025[_0x480542(0x82c)]=_0x480542(0xd75),_0x354025['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27'+JSON['stringify'](_0x42078e)+'\x27\x20'+(_0x42078e['type']==='user'?_0x480542(0xe4b):_0x480542(0x1ec))+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x42078e[_0x480542(0x10c9)]+_0x480542(0x131a)+_0x42078e[_0x480542(0x609)]+_0x480542(0x215),_0x473636[_0x480542(0x7b9)](_0x354025);}),_0x1cd56f[_0x51efe5(0x575)]['add']('visible');}async function _0xaca914(){const _0x27a336=_0x419fa8,_0x2da430=document[_0x27a336(0x7e4)](_0x27a336(0x359)),_0x535129=_0x2da430['length'];let _0xf2098d=[];if(_0x535129===0x6)_0x1c1d43[_0x27a336(0xf45)]='6p',_0xf2098d=['狼人','狼人','平民','平民',_0x27a336(0x7c2),'猎人'];else{if(_0x535129===0x9)_0x1c1d43['gameMode']='9p',_0xf2098d=['狼人','狼人','狼人','平民','平民','平民',_0x27a336(0x7c2),'女巫','猎人'];else{if(_0x535129===0xc)_0x1c1d43[_0x27a336(0xf45)]=_0x27a336(0x9cf),_0xf2098d=['狼人','狼人','狼人','狼人','平民','平民','平民','平民',_0x27a336(0x7c2),'女巫','猎人','守卫'];else{alert(_0x27a336(0x1011)+_0x535129+_0x27a336(0xa3d));return;}}}document['getElementById'](_0x27a336(0x96a))[_0x27a336(0x575)][_0x27a336(0x30f)](_0x27a336(0xc3f)),await _0x1bff53('正在发牌...',_0x27a336(0x7cd));for(let _0x4b876c=_0xf2098d['length']-0x1;_0x4b876c>0x0;_0x4b876c--){const _0x1bf603=Math[_0x27a336(0x5fb)](Math['random']()*(_0x4b876c+0x1));[_0xf2098d[_0x4b876c],_0xf2098d[_0x1bf603]]=[_0xf2098d[_0x1bf603],_0xf2098d[_0x4b876c]];}const _0x99aa15=Array[_0x27a336(0x13a5)](_0x2da430)[_0x27a336(0xa3b)](_0x55e34d=>JSON[_0x27a336(0x907)](_0x55e34d[_0x27a336(0xc9f)][_0x27a336(0xa08)]));_0x1c1d43['players']=[];for(let _0x4de22b=0x0;_0x4de22b<_0x99aa15[_0x27a336(0xa06)];_0x4de22b++){const _0x253f26=_0x99aa15[_0x4de22b],_0x5e437e=_0xf2098d[_0x4de22b];let _0x5917af=_0x27a336(0x60a);if(_0x253f26['type']===_0x27a336(0x96c)){const _0x17ad81=_0x9ebf46[_0x27a336(0x547)][_0x253f26['id']];_0x5917af=_0x17ad81?_0x17ad81['settings'][_0x27a336(0xae3)]:_0x27a336(0xe1f);}else{if(_0x253f26[_0x27a336(0x12d9)]==='npc'){const _0x54ac9d=await _0x2c5bcf['npcs'][_0x27a336(0x5ff)](),_0x4e3e3a=_0x54ac9d[_0x27a336(0xfc3)](_0x23a7e3=>'npc_'+_0x23a7e3['id']===_0x253f26['id']);_0x5917af=_0x4e3e3a?_0x4e3e3a[_0x27a336(0xeb1)]:_0x27a336(0x863);}else{if(_0x253f26[_0x27a336(0x12d9)]==='user'){const _0x1f4f9f=_0x1c1d43[_0x27a336(0x54d)]?_0x9ebf46[_0x27a336(0x547)][_0x1c1d43[_0x27a336(0x54d)]]:null;_0x5917af=_0x1f4f9f?_0x1f4f9f[_0x27a336(0x1131)][_0x27a336(0x1151)]:_0x27a336(0xafc);}}}const _0x465cbd={..._0x253f26,'role':_0x5e437e,'isAlive':!![],'character_persona':_0x5917af};_0x5e437e==='女巫'&&(_0x465cbd['antidoteUsed']=![],_0x465cbd[_0x27a336(0x13cc)]=![]),_0x5e437e==='守卫'&&(_0x465cbd[_0x27a336(0x12cd)]=null),_0x1c1d43[_0x27a336(0x544)][_0x27a336(0x668)](_0x465cbd);}_0x1c1d43['isActive']=!![],_0x1c1d43[_0x27a336(0x8b8)]=0x1,_0x1c1d43[_0x27a336(0xa7c)]='start',_0x1c1d43[_0x27a336(0xd7e)]=[],_0x1c1d43[_0x27a336(0x1337)]=[];const _0x211583=_0xf2098d[_0x27a336(0x12c1)]((_0x1f362d,_0x3d8a04)=>{return _0x1f362d[_0x3d8a04]=(_0x1f362d[_0x3d8a04]||0x0)+0x1,_0x1f362d;},{}),_0x407b0d=Object['entries'](_0x211583)['map'](([_0x434e7d,_0x54f4c7])=>_0x434e7d+'\x20x'+_0x54f4c7)[_0x27a336(0x809)]('、');_0xe634a6(_0x27a336(0xf97)+_0x535129+_0x27a336(0x90d)+_0x407b0d+'。');const _0xbba014=_0x1c1d43['players'][_0x27a336(0xfc3)](_0x2204fc=>_0x2204fc['id']==='user');_0x19e314(),_0xe5834e(_0x27a336(0xcea)),_0x20eaef(_0xbba014[_0x27a336(0x7fd)]);}function _0x19e314(){const _0x4fc158=_0x419fa8,_0x489ba5=document[_0x4fc158(0x9c8)]('werewolf-player-grid');_0x489ba5['innerHTML']='';const _0x4c9dd7=[..._0x1c1d43[_0x4fc158(0x544)]][_0x4fc158(0x66b)]((_0xef613c,_0x2eb760)=>_0xef613c[_0x4fc158(0x1294)]-_0x2eb760[_0x4fc158(0x1294)]);_0x4c9dd7['forEach']((_0x52e28c,_0x46ae16)=>{const _0x5db079=_0x4fc158,_0x39b084=_0x1c1d43[_0x5db079(0x544)][_0x5db079(0x684)](_0x4b96aa=>_0x4b96aa['id']===_0x52e28c['id'])+0x1,_0x21ed65=document[_0x5db079(0x28a)](_0x5db079(0x11f4));_0x21ed65[_0x5db079(0x82c)]=_0x5db079(0x1f2);if(!_0x52e28c[_0x5db079(0x1294)])_0x21ed65[_0x5db079(0x575)][_0x5db079(0x68e)](_0x5db079(0x415));_0x21ed65[_0x5db079(0x2f5)]=_0x5db079(0xc78)+_0x52e28c[_0x5db079(0x10c9)]+_0x5db079(0xb50)+_0x39b084+'.\x20'+_0x52e28c[_0x5db079(0x609)]+_0x5db079(0x215),_0x489ba5[_0x5db079(0x7b9)](_0x21ed65);});const _0x17f197=document[_0x4fc158(0x9c8)]('werewolf-log');_0x17f197[_0x4fc158(0x2f5)]='';for(let _0x4b4c72=0x1;_0x4b4c72<=_0x1c1d43[_0x4fc158(0x8b8)];_0x4b4c72++){const _0x379cf2=[..._0x1c1d43[_0x4fc158(0xd7e)]['filter'](_0x210e6d=>_0x210e6d[_0x4fc158(0x1025)]===_0x4b4c72),..._0x1c1d43['discussionLog'][_0x4fc158(0x401)](_0x14a9db=>_0x14a9db[_0x4fc158(0x1025)]===_0x4b4c72)][_0x4fc158(0x66b)]((_0x332c59,_0x2d7434)=>(_0x332c59['timestamp']||0x0)-(_0x2d7434['timestamp']||0x0));if(_0x379cf2[_0x4fc158(0xa06)]>0x0){const _0x4a1666=document[_0x4fc158(0x28a)](_0x4fc158(0x11f4));_0x4a1666['className']=_0x4fc158(0xa69),_0x4a1666[_0x4fc158(0xe24)]=_0x4fc158(0x20d)+_0x4b4c72+_0x4fc158(0xbf6),_0x4a1666[_0x4fc158(0x5e1)]['cssText']=_0x4fc158(0xa55),_0x17f197[_0x4fc158(0x7b9)](_0x4a1666),_0x379cf2['forEach'](_0x2bd49d=>{const _0x3126c9=_0x4fc158,_0x2f0485=document['createElement']('div');_0x2f0485['className']=_0x3126c9(0x980)+_0x2bd49d[_0x3126c9(0x12d9)],_0x2bd49d[_0x3126c9(0x12d9)]===_0x3126c9(0xc2e)?_0x2f0485[_0x3126c9(0x2f5)]='<span\x20class=\x22speaker\x22>'+_0x2bd49d[_0x3126c9(0xd84)]+_0x3126c9(0x137c)+_0x2bd49d[_0x3126c9(0x53b)]:_0x2f0485[_0x3126c9(0xe24)]=_0x2bd49d['content'],_0x17f197[_0x3126c9(0x7b9)](_0x2f0485);});}}_0x17f197[_0x4fc158(0x783)]=_0x17f197[_0x4fc158(0x1e4)];const _0x507b6e={'start':'游戏开始','night':'第'+_0x1c1d43[_0x4fc158(0x8b8)]+_0x4fc158(0xfa9),'day':'第'+_0x1c1d43[_0x4fc158(0x8b8)]+_0x4fc158(0x113e),'discussion':'第'+_0x1c1d43[_0x4fc158(0x8b8)]+_0x4fc158(0xe1b),'voting':'第'+_0x1c1d43['currentDay']+_0x4fc158(0x1269),'gameover':'游戏结束'};document[_0x4fc158(0x9c8)](_0x4fc158(0xad6))['textContent']=_0x4fc158(0x1213)+(_0x507b6e[_0x1c1d43[_0x4fc158(0xa7c)]]||_0x1c1d43[_0x4fc158(0xa7c)]);}function _0x20eaef(_0x5b53c9){const _0x27f18f=_0x419fa8,_0x14b8e2={'狼人':_0x27f18f(0x125b),'平民':_0x27f18f(0x5b2),'预言家':_0x27f18f(0xd93),'猎人':_0x27f18f(0xbb4),'女巫':'你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','守卫':'每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。'};document['getElementById'](_0x27f18f(0x886))['textContent']=_0x5b53c9,document[_0x27f18f(0x9c8)](_0x27f18f(0x84e))[_0x27f18f(0xe24)]=_0x14b8e2[_0x5b53c9]||_0x27f18f(0x584),document[_0x27f18f(0x9c8)](_0x27f18f(0x696))[_0x27f18f(0x575)][_0x27f18f(0x68e)]('visible');}async function _0x1116f9(){const _0x37f404=_0x419fa8;_0x1c1d43[_0x37f404(0xa7c)]='第'+_0x1c1d43['currentDay']+'天\x20-\x20夜晚',_0x1c1d43[_0x37f404(0x3c3)]={},_0xe634a6(_0x37f404(0xdcd)),_0x19e314(),document['getElementById']('werewolf-action-bar')[_0x37f404(0x5e1)][_0x37f404(0x3c5)]=_0x37f404(0x8f6),document[_0x37f404(0x9c8)](_0x37f404(0x32e))[_0x37f404(0x5e1)][_0x37f404(0x3c5)]=_0x37f404(0x8f6),await new Promise(_0x54384c=>setTimeout(_0x54384c,0x5dc));const _0x356064=_0x1c1d43['players'][_0x37f404(0xfc3)](_0x339dfe=>_0x339dfe[_0x37f404(0x7fd)]==='守卫'&&_0x339dfe[_0x37f404(0x1294)]);if(_0x356064){_0xe634a6(_0x37f404(0xc25)),_0x19e314();let _0x86623f=null;if(_0x356064['id']==='user')_0x86623f=await _0x5273c4(_0x37f404(0xd79),_0x356064[_0x37f404(0x12cd)]);else{const _0x36f626=_0x1c1d43['players'][_0x37f404(0x401)](_0x4d0927=>_0x4d0927['isAlive']&&_0x4d0927['id']!==_0x356064[_0x37f404(0x12cd)]);_0x36f626[_0x37f404(0xa06)]>0x0&&(_0x86623f=_0x36f626[Math['floor'](Math['random']()*_0x36f626[_0x37f404(0xa06)])]['id']);}_0x86623f&&(_0x1c1d43[_0x37f404(0x3c3)][_0x37f404(0xcd8)]=_0x86623f,_0x356064[_0x37f404(0x12cd)]=_0x86623f),_0xe634a6(_0x37f404(0x3a5)),_0x19e314(),await new Promise(_0x293b0c=>setTimeout(_0x293b0c,0x5dc));}_0xe634a6(_0x37f404(0x1074)),_0x19e314();const _0x57384f=_0x1c1d43[_0x37f404(0x544)][_0x37f404(0x401)](_0x13d5a0=>_0x13d5a0['role']==='狼人'&&_0x13d5a0['isAlive']),_0x533f53=_0x57384f[_0x37f404(0x10b2)](_0x197347=>_0x197347['id']==='user');let _0x309e4b=null;_0x1c1d43[_0x37f404(0x120f)]=_0x37f404(0x9f5);try{if(_0x533f53)_0xe634a6(_0x37f404(0xcd2)),_0x19e314(),_0x309e4b=await _0x5d2e82();else{if(_0x1c1d43[_0x37f404(0x8b8)]===0x1){console[_0x37f404(0x283)]('第一夜，执行本地随机刀人逻辑...');const _0x3228b2=_0x1c1d43[_0x37f404(0x544)][_0x37f404(0x401)](_0x9e5155=>_0x9e5155[_0x37f404(0x1294)]&&_0x9e5155[_0x37f404(0x7fd)]!=='狼人');_0x3228b2[_0x37f404(0xa06)]>0x0&&(_0x309e4b=_0x3228b2[Math[_0x37f404(0x5fb)](Math['random']()*_0x3228b2['length'])]['id']);}else _0x309e4b=await _0xdf4373();}_0x1c1d43['lastFailedAction']=null;}catch(_0x1b4273){console[_0x37f404(0x1221)](_0x37f404(0x305),_0x1b4273),await _0x1bff53(_0x37f404(0x24d),_0x37f404(0x1226)),document[_0x37f404(0x9c8)](_0x37f404(0x32e))['style']['display']=_0x37f404(0x3d9);return;}_0x1c1d43[_0x37f404(0x3c3)][_0x37f404(0xd52)]=_0x309e4b,_0xe634a6('狼人已行动，狼人请闭眼。'),_0x19e314(),await new Promise(_0x5c6b6c=>setTimeout(_0x5c6b6c,0x5dc));const _0xb4dea5=_0x1c1d43[_0x37f404(0x544)][_0x37f404(0xfc3)](_0x23fc74=>_0x23fc74[_0x37f404(0x7fd)]==='女巫'&&_0x23fc74[_0x37f404(0x1294)]);if(_0xb4dea5){_0xe634a6('女巫请睁眼。'),_0x19e314();const _0x56d6a3=_0x1c1d43[_0x37f404(0x544)][_0x37f404(0xfc3)](_0x8445f5=>_0x8445f5['id']===_0x1c1d43[_0x37f404(0x3c3)][_0x37f404(0xd52)]),_0x4caea7=_0x1c1d43[_0x37f404(0x3c3)][_0x37f404(0xcd8)]===_0x1c1d43['nightActions']['killedId'],_0x2fb6d9=_0x4caea7||!_0x56d6a3?null:_0x56d6a3;if(_0xb4dea5['id']==='user'){let _0x1be296=await _0x1123f7(_0x2fb6d9,_0xb4dea5);_0x1be296['save']&&(_0x1c1d43[_0x37f404(0x3c3)][_0x37f404(0x11d0)]=_0x1c1d43['nightActions']['killedId'],_0xb4dea5['antidoteUsed']=!![]),_0x1be296[_0x37f404(0x1315)]&&(_0x1c1d43[_0x37f404(0x3c3)]['poisonedId']=_0x1be296[_0x37f404(0x1315)],_0xb4dea5[_0x37f404(0x13cc)]=!![]);}else{if(!_0xb4dea5[_0x37f404(0xcaa)]&&_0x2fb6d9){let _0x2a1218=0x0;_0x1c1d43[_0x37f404(0x8b8)]===0x1?_0x2a1218=0.3:_0x2a1218=0.8,console['log'](_0x37f404(0x5d3)+_0x1c1d43['currentDay']+_0x37f404(0x19c)+_0x2a1218*0x64+'%'),Math['random']()<_0x2a1218?(console[_0x37f404(0x283)](_0x37f404(0x9dd)),_0x1c1d43[_0x37f404(0x3c3)][_0x37f404(0x11d0)]=_0x1c1d43[_0x37f404(0x3c3)][_0x37f404(0xd52)],_0xb4dea5[_0x37f404(0xcaa)]=!![]):console[_0x37f404(0x283)](_0x37f404(0x64e));}if(!_0x1c1d43[_0x37f404(0x3c3)][_0x37f404(0x11d0)]&&!_0xb4dea5[_0x37f404(0x13cc)]&&Math[_0x37f404(0x360)]()<0.5){const _0x1aabea=_0x1c1d43[_0x37f404(0x544)][_0x37f404(0x401)](_0x39dcda=>_0x39dcda[_0x37f404(0x1294)]&&_0x39dcda['id']!==_0x1c1d43['nightActions'][_0x37f404(0xd52)]);if(_0x1aabea['length']>0x0){const _0x140831=_0x1aabea[Math[_0x37f404(0x5fb)](Math['random']()*_0x1aabea[_0x37f404(0xa06)])];_0x1c1d43[_0x37f404(0x3c3)][_0x37f404(0x626)]=_0x140831['id'],_0xb4dea5[_0x37f404(0x13cc)]=!![],console[_0x37f404(0x283)](_0x37f404(0x29a)+_0x140831[_0x37f404(0x609)]);}}}_0xe634a6(_0x37f404(0xa95)),_0x19e314(),await new Promise(_0x35be5e=>setTimeout(_0x35be5e,0x5dc));}const _0x5a3521=_0x1c1d43[_0x37f404(0x544)][_0x37f404(0xfc3)](_0x15ebb0=>_0x15ebb0['role']===_0x37f404(0x7c2)&&_0x15ebb0[_0x37f404(0x1294)]);if(_0x5a3521){_0xe634a6(_0x37f404(0xa51)),_0x19e314();if(_0x5a3521['id']==='user'){const _0x4f5134=await _0x5273c4(_0x37f404(0xcad)),_0x2dd7dc=_0x1c1d43['players'][_0x37f404(0xfc3)](_0x35b9b6=>_0x35b9b6['id']===_0x4f5134);if(_0x2dd7dc){const _0x4b8079=_0x2dd7dc['role']==='狼人';await _0x1bff53(_0x37f404(0x377),'你查验的玩家\x20'+_0x2dd7dc[_0x37f404(0x609)]+'\x20的身份是：'+(_0x4b8079?'狼人':'好人')),_0x1c1d43[_0x37f404(0x3c3)][_0x37f404(0x5e9)]={'target':_0x4f5134,'result':_0x4b8079?'狼人':'好人'};}}else{const _0x31d223=_0x1c1d43[_0x37f404(0x544)][_0x37f404(0x401)](_0xb87969=>_0xb87969[_0x37f404(0x1294)]&&_0xb87969['id']!==_0x5a3521['id']);if(_0x31d223[_0x37f404(0xa06)]>0x0){const _0x15e88e=_0x31d223[Math['floor'](Math[_0x37f404(0x360)]()*_0x31d223[_0x37f404(0xa06)])];_0x1c1d43['nightActions'][_0x37f404(0x5e9)]={'target':_0x15e88e['id'],'result':_0x15e88e[_0x37f404(0x7fd)]==='狼人'?'狼人':'好人'};}}_0xe634a6(_0x37f404(0x12b4)),_0x19e314(),await new Promise(_0x4db1fb=>setTimeout(_0x4db1fb,0x5dc));}_0x1ffd91();}async function _0x1ffd91(){const _0x33873c=_0x419fa8;_0x1c1d43[_0x33873c(0xa7c)]='第'+_0x1c1d43['currentDay']+_0x33873c(0x113e),_0x1c1d43['voteResults']={},_0xe634a6(_0x33873c(0x1368));const {killedId:_0x6757b2,guardedId:_0x4ed0f3,savedId:_0x248680,poisonedId:_0x99a5e8}=_0x1c1d43[_0x33873c(0x3c3)],_0x17b576=new Set();_0x6757b2&&_0x6757b2!==_0x4ed0f3&&_0x6757b2!==_0x248680&&_0x17b576[_0x33873c(0x68e)](_0x6757b2);_0x99a5e8&&_0x17b576[_0x33873c(0x68e)](_0x99a5e8);if(_0x17b576[_0x33873c(0xa67)]===0x0)_0xe634a6('昨晚是平安夜。');else for(const _0x1bf841 of _0x17b576){const _0x2eb536=_0x1c1d43[_0x33873c(0x544)][_0x33873c(0xfc3)](_0x5c27c6=>_0x5c27c6['id']===_0x1bf841);if(_0x2eb536&&_0x2eb536['isAlive']){_0x2eb536[_0x33873c(0x1294)]=![],_0xe634a6(_0x33873c(0x261)+_0x2eb536[_0x33873c(0x609)]+'\x20死亡了。');if(_0x2eb536[_0x33873c(0x7fd)]==='猎人'){_0xe634a6(_0x33873c(0x13cf)),_0x19e314();let _0x46eebf=null;if(_0x2eb536['id']==='user')_0x46eebf=await _0x5273c4(_0x33873c(0x9d8));else{const _0x3ff24b=_0x1c1d43['players'][_0x33873c(0x401)](_0x4428c7=>_0x4428c7[_0x33873c(0x1294)]&&_0x4428c7['id']!==_0x2eb536['id']);_0x3ff24b[_0x33873c(0xa06)]>0x0&&(_0x46eebf=_0x3ff24b[Math[_0x33873c(0x5fb)](Math['random']()*_0x3ff24b[_0x33873c(0xa06)])]['id']);}const _0x16f4ea=_0x1c1d43[_0x33873c(0x544)]['find'](_0x213092=>_0x213092['id']===_0x46eebf);_0x16f4ea&&(_0x16f4ea['isAlive']=![],_0xe634a6(_0x33873c(0x1232)+_0x16f4ea['name']+'。'));}}}_0x19e314();if(_0x1ddcec())return;await _0x5a3f2b();}async function _0x5a3f2b(){const _0x4a0ad7=_0x419fa8;_0xe634a6(_0x4a0ad7(0x657)),_0x19e314();const {proxyUrl:_0x46377d,apiKey:_0x15aec7,model:_0x3d4dcf}=_0x9ebf46[_0x4a0ad7(0x4de)];if(!_0x46377d||!_0x15aec7||!_0x3d4dcf){alert(_0x4a0ad7(0xf82));return;}const _0x2a3de0=_0x2066aa();_0x1c1d43[_0x4a0ad7(0x120f)]=_0x4a0ad7(0x481);try{await _0x1bff53(_0x4a0ad7(0x7b8),_0x4a0ad7(0x9aa));let _0x26054a=_0x46377d[_0x4a0ad7(0x930)](_0x4a0ad7(0xb23)),_0x5f0a7a=[{'role':_0x4a0ad7(0x586),'content':'请所有AI角色根据你们的身份和人设开始发言。'}],_0x2e5492=_0x2e5c04(_0x3d4dcf,_0x15aec7,_0x2a3de0,_0x5f0a7a);const _0x4911eb=_0x26054a?await fetch(_0x2e5492[_0x4a0ad7(0x11be)],_0x2e5492[_0x4a0ad7(0x100d)]):await fetch(_0x46377d+_0x4a0ad7(0x1090),{'method':_0x4a0ad7(0x116f),'headers':{'Content-Type':_0x4a0ad7(0x698),'Authorization':'Bearer\x20'+_0x15aec7},'body':JSON[_0x4a0ad7(0xf1e)]({'model':_0x3d4dcf,'messages':[{'role':'system','content':_0x2a3de0},..._0x5f0a7a],'temperature':_0x9ebf46['globalSettings'][_0x4a0ad7(0xc3d)]||0.95})});if(!_0x4911eb['ok']){const _0x35154c=await _0x4911eb[_0x4a0ad7(0x5dd)]();throw new Error('API\x20错误:\x20'+_0x35154c[_0x4a0ad7(0x1221)]['message']);}const _0x2b1146=await _0x4911eb[_0x4a0ad7(0x5dd)](),_0x388c61=getGeminiResponseText(_0x2b1146),_0x27998f=_0x388c61['match'](/(\[[\s\S]*\])/);if(!_0x27998f)throw new Error(_0x4a0ad7(0x12f0)+_0x388c61);const _0x123367=JSON[_0x4a0ad7(0x907)](_0x27998f[0x0]);for(const _0x34f4f9 of _0x123367){_0x34f4f9['speaker_name']&&_0x34f4f9[_0x4a0ad7(0xc2e)]&&(_0x8c398(_0x34f4f9[_0x4a0ad7(0xd60)],_0x34f4f9[_0x4a0ad7(0xc2e)]),_0x19e314(),await new Promise(_0x4acf9a=>setTimeout(_0x4acf9a,0x5dc+Math['random']()*0x7d0)));}_0x1c1d43['lastFailedAction']=null;}catch(_0x2ae607){console[_0x4a0ad7(0x1221)](_0x4a0ad7(0x628),_0x2ae607),await _0x1bff53('AI\x20发言失败','讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20'+_0x2ae607[_0x4a0ad7(0x86e)]),document['getElementById'](_0x4a0ad7(0x32e))[_0x4a0ad7(0x5e1)]['display']=_0x4a0ad7(0x3d9);return;}const _0x28e1fa=_0x1c1d43[_0x4a0ad7(0x544)][_0x4a0ad7(0xfc3)](_0x2d1f14=>_0x2d1f14['id']===_0x4a0ad7(0x586)),_0x3ddc84=document[_0x4a0ad7(0x9c8)](_0x4a0ad7(0xab0)),_0x3edb28=document[_0x4a0ad7(0x9c8)](_0x4a0ad7(0x5ad)),_0x31381d=document[_0x4a0ad7(0x9c8)](_0x4a0ad7(0x1026)),_0x14ab99=document['getElementById'](_0x4a0ad7(0xaf8));_0x3ddc84[_0x4a0ad7(0x5e1)][_0x4a0ad7(0x3c5)]=_0x4a0ad7(0x989);if(_0x28e1fa&&_0x28e1fa[_0x4a0ad7(0x1294)]){_0x3edb28[_0x4a0ad7(0xe24)]=_0x4a0ad7(0xa1d),_0x31381d[_0x4a0ad7(0xe24)]=_0x4a0ad7(0x1c5),_0x3edb28['style'][_0x4a0ad7(0x3c5)]='block',_0x31381d[_0x4a0ad7(0x5e1)][_0x4a0ad7(0x3c5)]=_0x4a0ad7(0x3d9),_0x14ab99[_0x4a0ad7(0x823)]=![],_0x14ab99[_0x4a0ad7(0x1047)]='轮到你发言了...',_0x14ab99[_0x4a0ad7(0x6fd)]();const _0x4d86dd=_0x3edb28[_0x4a0ad7(0x75c)](!![]);_0x3edb28[_0x4a0ad7(0x127d)][_0x4a0ad7(0x4d7)](_0x4d86dd,_0x3edb28),_0x4d86dd['addEventListener'](_0x4a0ad7(0xf5c),_0x4e84b7);const _0x3888da=_0x31381d[_0x4a0ad7(0x75c)](!![]);_0x31381d[_0x4a0ad7(0x127d)][_0x4a0ad7(0x4d7)](_0x3888da,_0x31381d),_0x3888da[_0x4a0ad7(0xa0f)](_0x4a0ad7(0xf5c),_0x5a1f6e);}else{_0xe634a6(_0x4a0ad7(0x997)),_0x19e314(),_0x3edb28[_0x4a0ad7(0xe24)]=_0x4a0ad7(0xfe1),_0x31381d[_0x4a0ad7(0xe24)]=_0x4a0ad7(0xa0d),_0x3edb28[_0x4a0ad7(0x5e1)][_0x4a0ad7(0x3c5)]=_0x4a0ad7(0x3d9),_0x31381d['style'][_0x4a0ad7(0x3c5)]=_0x4a0ad7(0x3d9),_0x14ab99[_0x4a0ad7(0x823)]=!![],_0x14ab99[_0x4a0ad7(0x1047)]=_0x4a0ad7(0x5ab);const _0x18ebab=_0x3edb28['cloneNode'](!![]);_0x3edb28[_0x4a0ad7(0x127d)][_0x4a0ad7(0x4d7)](_0x18ebab,_0x3edb28),_0x18ebab[_0x4a0ad7(0xa0f)](_0x4a0ad7(0xf5c),_0x292508);const _0x2458b7=_0x31381d['cloneNode'](!![]);_0x31381d[_0x4a0ad7(0x127d)][_0x4a0ad7(0x4d7)](_0x2458b7,_0x31381d),_0x2458b7['addEventListener']('click',_0x4ab9bb);}}function _0x2066aa(){const _0x5d607c=_0x419fa8,_0x463de2=_0x1c1d43[_0x5d607c(0x544)][_0x5d607c(0x401)](_0x5e089d=>_0x5e089d[_0x5d607c(0x1294)]),_0x44c12b=_0x1c1d43[_0x5d607c(0x544)][_0x5d607c(0xfc3)](_0x19eadc=>_0x19eadc['id']===_0x5d607c(0x586)),_0x4311be=_0x44c12b?_0x44c12b[_0x5d607c(0x609)]:'用户',_0x151b2d=_0x463de2[_0x5d607c(0x10b2)](_0x39a26f=>_0x39a26f['id']===_0x5d607c(0x586));let _0x149f78=_0x5d607c(0x1043);_0x463de2[_0x5d607c(0x591)]((_0x46743e,_0x158e8a)=>{const _0x3cb996=_0x5d607c,_0x56e0dd=_0x1c1d43[_0x3cb996(0x544)][_0x3cb996(0x684)](_0x5512e2=>_0x5512e2['id']===_0x46743e['id'])+0x1;_0x149f78+=_0x3cb996(0x890)+_0x56e0dd+_0x3cb996(0xee7)+_0x46743e['name']+_0x3cb996(0x829)+_0x46743e[_0x3cb996(0x1071)]+'\x0a-\x20**身份**:\x20'+(_0x46743e['id']==='user'?_0x3cb996(0x10e8):_0x3cb996(0x800))+_0x3cb996(0x6dd)+_0x46743e[_0x3cb996(0x747)]+'\x0a';if(_0x46743e['type']==='character'){const _0x197bd6=_0x9ebf46[_0x3cb996(0x547)][_0x46743e['id']];if(_0x197bd6&&_0x197bd6['longTermMemory']&&_0x197bd6['longTermMemory'][_0x3cb996(0xa06)]>0x0){const _0x14a66e=_0x197bd6['longTermMemory']['map'](_0x42b103=>_0x42b103['content'])['join'](';\x20');_0x149f78+='-\x20**长期记忆\x20(必须参考)**:\x20'+_0x14a66e+'\x0a';}}});let _0x356ed6='#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a';const _0x446b88=_0x1c1d43['gameLog']['filter'](_0x2d6505=>_0x2d6505['content']['includes']('死亡了')&&_0x2d6505[_0x5d607c(0x1025)]===_0x1c1d43[_0x5d607c(0x8b8)]);_0x446b88[_0x5d607c(0xa06)]===0x0?_0x356ed6+=_0x5d607c(0x686):_0x446b88[_0x5d607c(0x591)](_0x4de10a=>{const _0x4909ae=_0x5d607c;_0x356ed6+='-\x20'+_0x4de10a[_0x4909ae(0x53b)]+'\x0a';});let _0x37afe5='#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a';if(_0x1c1d43['currentDay']>0x1)for(let _0x2a4aa7=0x1;_0x2a4aa7<_0x1c1d43[_0x5d607c(0x8b8)];_0x2a4aa7++){_0x37afe5+=_0x5d607c(0x498)+_0x2a4aa7+_0x5d607c(0x1066);const _0x325037=_0x1c1d43['gameLog']['filter'](_0x9166bf=>_0x9166bf[_0x5d607c(0x1025)]===_0x2a4aa7&&(_0x9166bf[_0x5d607c(0x53b)][_0x5d607c(0x930)]('死亡')||_0x9166bf['content'][_0x5d607c(0x930)]('放逐')));_0x325037[_0x5d607c(0xa06)]>0x0?_0x37afe5+='*事件*:\x20'+_0x325037[_0x5d607c(0xa3b)](_0x577eb8=>_0x577eb8[_0x5d607c(0x53b)])[_0x5d607c(0x809)]('\x20')+'\x0a':_0x37afe5+=_0x5d607c(0x917);const _0x2a841d=_0x1c1d43[_0x5d607c(0x1337)][_0x5d607c(0x401)](_0x25f197=>_0x25f197[_0x5d607c(0x1025)]===_0x2a4aa7);_0x2a841d[_0x5d607c(0xa06)]>0x0&&(_0x37afe5+=_0x5d607c(0xde6)+_0x2a841d[_0x5d607c(0xa3b)](_0x4d73f9=>'-\x20'+_0x4d73f9['speaker']+':\x20'+_0x4d73f9['content'])[_0x5d607c(0x809)]('\x0a')+'\x0a');}else _0x37afe5+='(今天是第一天，没有历史记录)\x0a';let _0x5e9831=_0x5d607c(0x694);_0x463de2['forEach'](_0x3e5166=>{const _0x5c7240=_0x5d607c;if(_0x3e5166['id']!==_0x5c7240(0x586)){_0x5e9831+=_0x5c7240(0x842)+_0x3e5166['name']+_0x5c7240(0xac2)+_0x3e5166['role']+'】\x0a';if(_0x3e5166[_0x5c7240(0x7fd)]==='狼人'){const _0x22d8a5=_0x1c1d43[_0x5c7240(0x544)][_0x5c7240(0x401)](_0x5e705b=>_0x5e705b[_0x5c7240(0x7fd)]==='狼人'&&_0x5e705b['id']!==_0x3e5166['id'])[_0x5c7240(0xa3b)](_0x1a3ee3=>_0x1a3ee3[_0x5c7240(0x609)])['join']('、');_0x5e9831+=_0x5c7240(0xa9b)+(_0x22d8a5||'无')+'\x0a';const _0x39f646=_0x1c1d43[_0x5c7240(0x544)]['find'](_0x55ea56=>_0x55ea56['id']===_0x1c1d43[_0x5c7240(0x3c3)][_0x5c7240(0xd52)]);_0x5e9831+=_0x5c7240(0xc17)+(_0x39f646?_0x39f646[_0x5c7240(0x609)]:'空刀')+'\x0a';}if(_0x3e5166[_0x5c7240(0x7fd)]===_0x5c7240(0x7c2)&&_0x1c1d43[_0x5c7240(0x3c3)][_0x5c7240(0x5e9)]){const _0x348b10=_0x1c1d43[_0x5c7240(0x544)][_0x5c7240(0xfc3)](_0x54cbbc=>_0x54cbbc['id']===_0x1c1d43[_0x5c7240(0x3c3)][_0x5c7240(0x5e9)][_0x5c7240(0x1070)]);_0x5e9831+=_0x5c7240(0x9b6)+_0x348b10[_0x5c7240(0x609)]+_0x5c7240(0x778)+_0x1c1d43[_0x5c7240(0x3c3)]['prophetCheck'][_0x5c7240(0xceb)]+'】\x0a';}if(_0x3e5166['role']==='女巫'){if(_0x1c1d43['nightActions']['savedId']){const _0x234c1e=_0x1c1d43['players']['find'](_0x158122=>_0x158122['id']===_0x1c1d43['nightActions'][_0x5c7240(0x11d0)]);_0x5e9831+=_0x5c7240(0x107d)+_0x234c1e[_0x5c7240(0x609)]+'。\x0a';}if(_0x1c1d43['nightActions'][_0x5c7240(0x626)]){const _0x2bfa4f=_0x1c1d43['players']['find'](_0x21c3d4=>_0x21c3d4['id']===_0x1c1d43[_0x5c7240(0x3c3)][_0x5c7240(0x626)]);_0x5e9831+='-\x20你昨晚用毒药毒了\x20'+_0x2bfa4f[_0x5c7240(0x609)]+'。\x0a';}_0x5e9831+=_0x5c7240(0x1b2)+(_0x3e5166[_0x5c7240(0xcaa)]?'已使用':_0x5c7240(0xb51))+'\x0a',_0x5e9831+=_0x5c7240(0x233)+(_0x3e5166[_0x5c7240(0x13cc)]?'已使用':_0x5c7240(0xb51))+'\x0a';}if(_0x3e5166[_0x5c7240(0x7fd)]==='守卫'){if(_0x1c1d43[_0x5c7240(0x3c3)][_0x5c7240(0xcd8)]){const _0x5e63d6=_0x1c1d43['players']['find'](_0x58af31=>_0x58af31['id']===_0x1c1d43[_0x5c7240(0x3c3)][_0x5c7240(0xcd8)]);_0x5e9831+=_0x5c7240(0x509)+_0x5e63d6['name']+'。\x0a';}else _0x5e9831+=_0x5c7240(0x549);}_0x5e9831+='\x0a';}});let _0x465eeb=_0x5d607c(0x11b8);const _0x45a38c=_0x1c1d43[_0x5d607c(0x1337)][_0x5d607c(0x401)](_0x871f1c=>_0x871f1c[_0x5d607c(0x1025)]===_0x1c1d43['currentDay']);_0x45a38c[_0x5d607c(0xa06)]>0x0?_0x465eeb+=_0x45a38c[_0x5d607c(0xa3b)](_0x28a078=>_0x5d607c(0x388)+_0x28a078['speaker']+'**:\x20'+_0x28a078[_0x5d607c(0x53b)])[_0x5d607c(0x809)]('\x0a'):_0x465eeb+=_0x5d607c(0xf5f);const _0x15e676=_0x5d607c(0xbf1)+(_0x151b2d?'用户('+_0x4311be+')':'已死亡的用户('+_0x4311be+')')+'以外】的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a'+_0x149f78+_0x5d607c(0x1050)+(_0x1c1d43[_0x5d607c(0xf45)]===_0x5d607c(0x9cf)?'屠边局：狼人杀死所有神职或所有平民即获胜。':'屠城局：狼人杀死所有好人即获胜。')+_0x5d607c(0x760)+_0x1c1d43['currentDay']+_0x5d607c(0x4ad)+_0x356ed6+'\x20\x0a-\x20存活玩家:\x20'+_0x463de2['map'](_0x474214=>_0x474214[_0x5d607c(0x609)]+'\x20('+(_0x474214['id']===_0x5d607c(0x586)?'用户':'AI')+')')[_0x5d607c(0x809)](',\x20')+'\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20\x20\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20\x20\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20\x20\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20\x20\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20'+_0x4311be+_0x5d607c(0xecf)+_0x37afe5+_0x5d607c(0x114d)+_0x465eeb+'\x0a\x0a'+_0x5e9831+'\x0a\x0a现在，请为所有【存活的AI角色】生成他们充满策略和博弈的发言。';return _0x15e676;}function _0x39928e(_0x4d73b8){const _0x17d395=_0x419fa8;let _0x39b652=_0x17d395(0x9ad);const _0x2b1e71=_0x4d73b8[_0x17d395(0xd7e)]['find'](_0x131740=>_0x131740[_0x17d395(0x53b)][_0x17d395(0x930)]('胜利'))?.['content']||_0x17d395(0x4e0);_0x39b652+=_0x17d395(0x106d)+_0x2b1e71+'\x0a\x0a',_0x39b652+=_0x17d395(0xefe),_0x4d73b8[_0x17d395(0x544)]['forEach'](_0x74d5c0=>{const _0x3a9999=_0x17d395,_0x48b03e=_0x74d5c0[_0x3a9999(0x1294)]?'存活':_0x3a9999(0x1a4);_0x39b652+='-\x20'+_0x74d5c0[_0x3a9999(0x609)]+':\x20'+_0x74d5c0['role']+'\x20('+_0x48b03e+')\x0a';}),_0x39b652+=_0x17d395(0x65b);for(let _0x1c44f3=0x1;_0x1c44f3<=_0x4d73b8[_0x17d395(0x8b8)];_0x1c44f3++){_0x39b652+=_0x17d395(0x498)+_0x1c44f3+_0x17d395(0x1066);const _0x10ce5e=_0x4d73b8[_0x17d395(0xd7e)]['filter'](_0x126b35=>_0x126b35[_0x17d395(0x1025)]===_0x1c44f3&&_0x126b35['content']['includes']('死亡'));if(_0x10ce5e[_0x17d395(0xa06)]>0x0)_0x39b652+=_0x17d395(0xf4b)+_0x10ce5e['map'](_0xdae5d7=>_0xdae5d7[_0x17d395(0x53b)])['join']('\x20')+'\x0a';else(_0x1c44f3>0x1||_0x1c44f3===0x1&&_0x4d73b8[_0x17d395(0x8b8)]>0x1)&&(_0x39b652+=_0x17d395(0xf3f));const _0x4acd3f=_0x4d73b8[_0x17d395(0x1337)][_0x17d395(0x401)](_0x4dac66=>_0x4dac66[_0x17d395(0x1025)]===_0x1c44f3);_0x4acd3f[_0x17d395(0xa06)]>0x0&&(_0x39b652+=_0x17d395(0xd1c)+_0x4acd3f['map'](_0x50f73f=>'-\x20'+_0x50f73f[_0x17d395(0xd84)]+':\x20'+_0x50f73f[_0x17d395(0x53b)])[_0x17d395(0x809)]('\x0a')+'\x0a');const _0x563bf7=_0x4d73b8[_0x17d395(0xd7e)][_0x17d395(0xfc3)](_0x33a4a3=>_0x33a4a3[_0x17d395(0x1025)]===_0x1c44f3&&_0x33a4a3['content'][_0x17d395(0x930)](_0x17d395(0x8a4)));_0x563bf7&&(_0x39b652+=_0x17d395(0x6cb)+_0x563bf7['content']+'\x0a');}return _0x39b652+=_0x17d395(0xbf5),_0x39b652;}async function _0x2b5934(_0x41dbbb){const _0x203987=_0x419fa8;let _0x494a82=0x0;for(const _0x32a58a of _0x1c1d43[_0x203987(0x544)]){if(_0x32a58a[_0x203987(0x12d9)]===_0x203987(0x96c)){const _0x41ec09=_0x9ebf46[_0x203987(0x547)][_0x32a58a['id']];if(_0x41ec09){const _0x1ffba6={'content':_0x41dbbb,'timestamp':Date['now'](),'source':'werewolf_summary'};!_0x41ec09[_0x203987(0x323)]&&(_0x41ec09[_0x203987(0x323)]=[]),_0x41ec09[_0x203987(0x323)][_0x203987(0x668)](_0x1ffba6),await _0x2c5bcf[_0x203987(0x547)][_0x203987(0xff5)](_0x41ec09),_0x494a82++;}}}return _0x494a82;}async function _0x4fb78b(){const _0x3ed4ce=_0x419fa8;if(!_0x1c1d43[_0x3ed4ce(0x103f)]&&_0x1c1d43[_0x3ed4ce(0xa7c)]==='gameover'){await _0x1bff53(_0x3ed4ce(0x7a4),'正在为所有AI角色生成并注入游戏记忆...');try{const _0x956726=_0x39928e(_0x1c1d43),_0x4d4a4f=await _0x2b5934(_0x956726);await _0x1bff53('成功',_0x3ed4ce(0x115a)+_0x4d4a4f+_0x3ed4ce(0x574));}catch(_0x363d37){console[_0x3ed4ce(0x1221)](_0x3ed4ce(0x49f),_0x363d37),await _0x1bff53('失败',_0x3ed4ce(0x129d)+_0x363d37[_0x3ed4ce(0x86e)]);}}else alert(_0x3ed4ce(0x1168));}async function _0x12a4fb(_0x263121){const _0x223154=_0x419fa8;_0x1c1d43[_0x223154(0x103f)]=![],_0x1c1d43['currentPhase']=_0x223154(0x519),_0xe634a6(_0x263121+'阵营胜利！'),document[_0x223154(0x9c8)](_0x223154(0x41c))[_0x223154(0xe24)]=_0x263121+_0x223154(0xe81);let _0x1263d1='';_0x263121==='好人'?_0x1263d1=_0x223154(0x11ea):_0x1263d1=_0x223154(0xa96);const _0x5a14ef=document['getElementById'](_0x223154(0xfb5));_0x5a14ef[_0x223154(0xe24)]=_0x1263d1;const _0x5d5380=document[_0x223154(0x9c8)]('werewolf-role-reveal-list');_0x5d5380['innerHTML']='';const _0x304f56=[..._0x1c1d43[_0x223154(0x544)]][_0x223154(0x66b)]((_0x472bc5,_0x36249e)=>{const _0x5e6a49=_0x223154,_0x282467=_0x1c1d43[_0x5e6a49(0x544)][_0x5e6a49(0x684)](_0x53e0b2=>_0x53e0b2['id']===_0x472bc5['id']),_0x273b0c=_0x1c1d43[_0x5e6a49(0x544)]['findIndex'](_0x1a9940=>_0x1a9940['id']===_0x36249e['id']);return _0x282467-_0x273b0c;});_0x304f56[_0x223154(0x591)]((_0x434a3b,_0x3fb1d6)=>{const _0x305e9e=_0x223154,_0x5b9708=document['createElement'](_0x305e9e(0x11f4));_0x5b9708[_0x305e9e(0x5e1)][_0x305e9e(0xd09)]=_0x305e9e(0xde0);if(_0x3fb1d6===_0x304f56[_0x305e9e(0xa06)]-0x1)_0x5b9708[_0x305e9e(0x5e1)][_0x305e9e(0xf54)]='none';const _0x63a540=_0x434a3b['role']==='狼人'?_0x305e9e(0x945):'#52c41a';_0x5b9708[_0x305e9e(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x434a3b[_0x305e9e(0x10c9)]+'\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20'+(_0x434a3b['isAlive']?'none':_0x305e9e(0x79f))+_0x305e9e(0x1251)+(_0x434a3b[_0x305e9e(0x1294)]?'none':_0x305e9e(0xfa5))+_0x305e9e(0x13c4)+(_0x3fb1d6+0x1)+'.\x20'+_0x434a3b['name']+_0x305e9e(0x1b0)+_0x63a540+_0x305e9e(0x13c4)+_0x434a3b[_0x305e9e(0x7fd)]+_0x305e9e(0x61b),_0x5d5380[_0x305e9e(0x7b9)](_0x5b9708);}),document[_0x223154(0x9c8)](_0x223154(0xce3))[_0x223154(0x575)][_0x223154(0x68e)](_0x223154(0xc3f));try{console['log'](_0x223154(0x5e0));const _0x3a3440=_0x39928e(_0x1c1d43),_0x226c1c=await generateAndInjectWerewolfMemories(_0x3a3440);console['log']('狼人杀游戏总结已自动存入\x20'+_0x226c1c+'\x20位角色的记忆中。');}catch(_0x5b9999){console[_0x223154(0x1221)](_0x223154(0xbe4),_0x5b9999),_0x5a14ef&&(_0x5a14ef[_0x223154(0x2f5)]+='<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>');}}function _0xe634a6(_0x3d091a){const _0x14a6f0=_0x419fa8;_0x1c1d43[_0x14a6f0(0xd7e)][_0x14a6f0(0x668)]({'type':_0x14a6f0(0xb64),'content':_0x3d091a,'timestamp':Date['now'](),'day':_0x1c1d43[_0x14a6f0(0x8b8)]});}function _0x8c398(_0x18fe34,_0x1280eb){const _0x5ae8df=_0x419fa8;_0x1c1d43['discussionLog'][_0x5ae8df(0x668)]({'type':'dialogue','speaker':_0x18fe34,'content':_0x1280eb,'timestamp':Date['now'](),'day':_0x1c1d43['currentDay']});}function _0x5273c4(_0xd17421){return new Promise(_0x222190=>{const _0x17578f=_0x3569,_0x20991f=_0x17578f(0x1392)+_0xd17421+_0x17578f(0x1277),_0x1437a2=_0x17578f(0x1392)+_0xd17421+_0x17578f(0xe41);let _0x38d428='';if(_0xd17421===_0x17578f(0xcad))_0x38d428=_0x17578f(0x860);if(_0xd17421===_0x17578f(0x9d8))_0x38d428=_0x17578f(0xec3);if(_0xd17421===_0x17578f(0xcec))_0x38d428=_0x17578f(0x71c);const _0x10f1ae=document[_0x17578f(0x9c8)](_0x20991f),_0x3620d5=document[_0x17578f(0x9c8)](_0x1437a2),_0x49cec4=document[_0x17578f(0x9c8)](_0x38d428);_0x3620d5['innerHTML']='';let _0x1ff3e5=null;const _0xd05c9c=_0x1c1d43[_0x17578f(0x544)]['filter'](_0x4f387d=>_0x4f387d['isAlive']&&(_0xd17421===_0x17578f(0x9d8)||_0xd17421===_0x17578f(0xcec)||_0x4f387d['id']!=='user'));_0xd05c9c[_0x17578f(0x591)](_0x49b2a1=>{const _0xc0b2fc=_0x17578f,_0x1c691b=document[_0xc0b2fc(0x28a)]('div');_0x1c691b[_0xc0b2fc(0x82c)]='werewolf-selection-item',_0x1c691b[_0xc0b2fc(0xc9f)]['id']=_0x49b2a1['id'],_0x1c691b[_0xc0b2fc(0x2f5)]=_0xc0b2fc(0x12ac)+_0x49b2a1[_0xc0b2fc(0x10c9)]+_0xc0b2fc(0x1312)+_0x49b2a1[_0xc0b2fc(0x609)]+_0xc0b2fc(0x12c8),_0x1c691b[_0xc0b2fc(0x2fa)]=()=>{const _0x58916c=_0xc0b2fc;_0x3620d5[_0x58916c(0x7e4)]('.selected')[_0x58916c(0x591)](_0x1fdad1=>_0x1fdad1[_0x58916c(0x575)]['remove'](_0x58916c(0x631))),_0x1c691b['classList']['add']('selected'),_0x1ff3e5=_0x49b2a1['id'];},_0x3620d5['appendChild'](_0x1c691b);});const _0x16f369=_0x49cec4[_0x17578f(0x75c)](!![]);_0x49cec4[_0x17578f(0x127d)][_0x17578f(0x4d7)](_0x16f369,_0x49cec4),_0x16f369['onclick']=()=>{const _0x148e18=_0x17578f;_0x1ff3e5?(_0x10f1ae[_0x148e18(0x575)][_0x148e18(0x30f)](_0x148e18(0xc3f)),_0x222190(_0x1ff3e5)):alert(_0x148e18(0xf06));},_0x10f1ae[_0x17578f(0x575)][_0x17578f(0x68e)](_0x17578f(0xc3f));});}function _0x5d2e82(){return new Promise(_0x1b18da=>{const _0x3af073=_0x3569,_0x55c331=document[_0x3af073(0x9c8)](_0x3af073(0x12ba)),_0x41d322=document[_0x3af073(0x9c8)](_0x3af073(0x11ba)),_0x16a82b=document[_0x3af073(0x9c8)](_0x3af073(0x12d3)),_0x4c05e6=_0x55c331['querySelector'](_0x3af073(0xc08)),_0x40dfd9=_0x1c1d43[_0x3af073(0x544)]['filter'](_0x2bc151=>_0x2bc151[_0x3af073(0x7fd)]==='狼人'&&_0x2bc151[_0x3af073(0x1294)]),_0x1906c1=_0x40dfd9[_0x3af073(0x401)](_0x515377=>_0x515377['id']!=='user')[_0x3af073(0xa3b)](_0x5747ee=>_0x5747ee[_0x3af073(0x609)])[_0x3af073(0x809)]('、');_0x1906c1?_0x4c05e6[_0x3af073(0x2f5)]='狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20'+_0x1906c1+_0x3af073(0xeb7):_0x4c05e6['textContent']=_0x3af073(0x406);_0x41d322[_0x3af073(0x2f5)]='';let _0x4e04f2=null;const _0x2f7c18=_0x1c1d43[_0x3af073(0x544)][_0x3af073(0x401)](_0x52b859=>_0x52b859[_0x3af073(0x1294)]&&_0x52b859[_0x3af073(0x7fd)]!=='狼人');_0x2f7c18[_0x3af073(0x591)](_0x2a111d=>{const _0x993ba0=_0x3af073,_0x702724=document[_0x993ba0(0x28a)](_0x993ba0(0x11f4));_0x702724[_0x993ba0(0x82c)]='werewolf-selection-item',_0x702724[_0x993ba0(0xc9f)]['id']=_0x2a111d['id'],_0x702724[_0x993ba0(0x2f5)]=_0x993ba0(0x12ac)+_0x2a111d['avatar']+_0x993ba0(0x1312)+_0x2a111d['name']+_0x993ba0(0x12c8),_0x702724[_0x993ba0(0x2fa)]=()=>{const _0x124cf4=_0x993ba0;_0x41d322['querySelectorAll'](_0x124cf4(0xb38))[_0x124cf4(0x591)](_0x2b63b1=>_0x2b63b1['classList'][_0x124cf4(0x30f)]('selected')),_0x702724[_0x124cf4(0x575)]['add'](_0x124cf4(0x631)),_0x4e04f2=_0x2a111d['id'];},_0x41d322['appendChild'](_0x702724);});const _0x269378=_0x16a82b['cloneNode'](!![]);_0x16a82b['parentNode'][_0x3af073(0x4d7)](_0x269378,_0x16a82b),_0x269378[_0x3af073(0x2fa)]=()=>{const _0x2331d7=_0x3af073;_0x4e04f2?(_0x55c331[_0x2331d7(0x575)]['remove'](_0x2331d7(0xc3f)),_0x1b18da(_0x4e04f2)):alert('请选择一个目标。');},_0x55c331['classList']['add'](_0x3af073(0xc3f));});}function _0x5a1f6e(){const _0x13ba38=_0x419fa8,_0x6b449e=_0x1c1d43[_0x13ba38(0x544)][_0x13ba38(0xfc3)](_0x3fd19d=>_0x3fd19d['id']===_0x13ba38(0x586));if(!_0x6b449e||!_0x6b449e[_0x13ba38(0x1294)])return;const _0x4d9778=document[_0x13ba38(0x9c8)]('werewolf-user-input'),_0x1c2b56=_0x4d9778['value'][_0x13ba38(0x3f1)]();_0x1c2b56&&(_0x8c398(_0x6b449e[_0x13ba38(0x609)],_0x1c2b56),_0x19e314()),document['getElementById'](_0x13ba38(0xab0))[_0x13ba38(0x5e1)][_0x13ba38(0x3c5)]='none',_0x4d9778[_0x13ba38(0x1155)]='',_0x4ab9bb();}async function _0x292508(){const _0x1a065b=_0x419fa8;_0xe634a6(_0x1a065b(0x2c2)),_0x19e314();const _0x1fa721=document[_0x1a065b(0x9c8)]('werewolf-wait-reply-btn');if(_0x1fa721)_0x1fa721[_0x1a065b(0x823)]=!![];await _0x1bff53('请稍候','正在等待AI角色们继续讨论...');const {proxyUrl:_0x279a2d,apiKey:_0x3741cf,model:_0x218270}=_0x9ebf46[_0x1a065b(0x4de)];if(!_0x279a2d||!_0x3741cf||!_0x218270){alert(_0x1a065b(0xf82));return;}const _0x5a7720=_0x2066aa();try{let _0x28e3cb=_0x279a2d[_0x1a065b(0x930)]('generativelanguage'),_0x3af4aa=[{'role':_0x1a065b(0x586),'content':_0x1a065b(0x1397)}],_0x1a5c21=_0x2e5c04(_0x218270,_0x3741cf,_0x5a7720,_0x3af4aa);const _0x438087=_0x28e3cb?await fetch(_0x1a5c21['url'],_0x1a5c21[_0x1a065b(0x100d)]):await fetch(_0x279a2d+_0x1a065b(0x1090),{'method':'POST','headers':{'Content-Type':_0x1a065b(0x698),'Authorization':_0x1a065b(0x84a)+_0x3741cf},'body':JSON['stringify']({'model':_0x218270,'messages':[{'role':_0x1a065b(0xb64),'content':_0x5a7720},..._0x3af4aa],'temperature':_0x9ebf46['globalSettings']['apiTemperature']||0.9})});if(!_0x438087['ok']){const _0x1b6c1f=await _0x438087[_0x1a065b(0x5dd)]();throw new Error('API\x20错误:\x20'+_0x1b6c1f[_0x1a065b(0x1221)][_0x1a065b(0x86e)]);}const _0x41d84b=await _0x438087[_0x1a065b(0x5dd)](),_0x51c3be=getGeminiResponseText(_0x41d84b),_0x1f1844=_0x51c3be[_0x1a065b(0x12c2)](/(\[[\s\S]*\])/);if(!_0x1f1844)throw new Error(_0x1a065b(0x9c5)+_0x51c3be);const _0x13385c=JSON[_0x1a065b(0x907)](_0x1f1844[0x0]);for(const _0x17a736 of _0x13385c){_0x17a736[_0x1a065b(0xd60)]&&_0x17a736[_0x1a065b(0xc2e)]&&(_0x8c398(_0x17a736[_0x1a065b(0xd60)],_0x17a736[_0x1a065b(0xc2e)]),_0x19e314(),await new Promise(_0x572d50=>setTimeout(_0x572d50,0x5dc+Math['random']()*0x7d0)));}}catch(_0x40e0fd){console[_0x1a065b(0x1221)](_0x1a065b(0xe59),_0x40e0fd),await _0x1bff53(_0x1a065b(0xd66),_0x1a065b(0x320)+_0x40e0fd[_0x1a065b(0x86e)]);}finally{if(_0x1fa721)_0x1fa721[_0x1a065b(0x823)]=![];}}async function _0x4e84b7(){const _0x287478=_0x419fa8,_0x17c9d8=_0x1c1d43[_0x287478(0x544)][_0x287478(0xfc3)](_0x459268=>_0x459268['id']===_0x287478(0x586));if(!_0x17c9d8||!_0x17c9d8[_0x287478(0x1294)]){console[_0x287478(0x453)]('handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。');return;}const _0x52403f=document['getElementById'](_0x287478(0xaf8)),_0x4a6093=_0x52403f[_0x287478(0x1155)][_0x287478(0x3f1)]();if(!_0x4a6093){alert(_0x287478(0x115c));return;}_0x8c398(_0x17c9d8['name'],_0x4a6093),_0x19e314(),_0x52403f[_0x287478(0x1155)]='',await _0x1bff53('请稍候','正在等待AI角色们对你的发言做出回应...');const {proxyUrl:_0x318645,apiKey:_0xe963aa,model:_0x34801d}=_0x9ebf46[_0x287478(0x4de)];if(!_0x318645||!_0xe963aa||!_0x34801d){alert(_0x287478(0xf82));return;}const _0x582c21=_0x2066aa();try{let _0x5b7404=_0x318645[_0x287478(0x930)](_0x287478(0xb23)),_0x4301e3=[{'role':'user','content':_0x287478(0x7c6)+_0x17c9d8[_0x287478(0x609)]+'\x27的发言）继续进行讨论。'}],_0x5eca82=_0x2e5c04(_0x34801d,_0xe963aa,_0x582c21,_0x4301e3);const _0x457d07=_0x5b7404?await fetch(_0x5eca82[_0x287478(0x11be)],_0x5eca82[_0x287478(0x100d)]):await fetch(_0x318645+_0x287478(0x1090),{'method':_0x287478(0x116f),'headers':{'Content-Type':_0x287478(0x698),'Authorization':_0x287478(0x84a)+_0xe963aa},'body':JSON[_0x287478(0xf1e)]({'model':_0x34801d,'messages':[{'role':'system','content':_0x582c21},..._0x4301e3],'temperature':_0x9ebf46[_0x287478(0x1383)][_0x287478(0xc3d)]||0.9})});if(!_0x457d07['ok']){const _0x1dca14=await _0x457d07[_0x287478(0x5dd)]();throw new Error('API\x20错误:\x20'+_0x1dca14[_0x287478(0x1221)][_0x287478(0x86e)]);}const _0x149140=await _0x457d07[_0x287478(0x5dd)](),_0x4c8b03=getGeminiResponseText(_0x149140),_0x7ce588=_0x4c8b03[_0x287478(0x12c2)](/(\[[\s\S]*\])/);if(!_0x7ce588)throw new Error(_0x287478(0x9c5)+_0x4c8b03);const _0x951a5=JSON[_0x287478(0x907)](_0x7ce588[0x0]);for(const _0x5ba4c4 of _0x951a5){_0x5ba4c4[_0x287478(0xd60)]&&_0x5ba4c4[_0x287478(0xc2e)]&&(_0x8c398(_0x5ba4c4[_0x287478(0xd60)],_0x5ba4c4[_0x287478(0xc2e)]),_0x19e314(),await new Promise(_0x44a7bb=>setTimeout(_0x44a7bb,0x5dc+Math['random']()*0x7d0)));}}catch(_0x57fdb7){console['error'](_0x287478(0xe59),_0x57fdb7),await _0x1bff53('AI\x20发言失败','错误:\x20'+_0x57fdb7[_0x287478(0x86e)]);}}async function _0x4ab9bb(){const _0x321afa=_0x419fa8;_0xe634a6(_0x321afa(0x775)),_0x19e314(),_0x1c1d43[_0x321afa(0xe19)]={};let _0xddb22f=null;_0x1c1d43[_0x321afa(0x120f)]=_0x321afa(0xa6a);try{_0xddb22f=await _0x45b016(),_0xddb22f&&_0xddb22f[_0x321afa(0x591)](_0x476500=>{const _0x3b214f=_0x321afa,_0xae5c05=_0x1c1d43['players'][_0x3b214f(0xfc3)](_0x289eb4=>_0x289eb4[_0x3b214f(0x609)]===_0x476500[_0x3b214f(0xbf7)]),_0x1f3be5=_0x1c1d43['players'][_0x3b214f(0xfc3)](_0x8ba43a=>_0x8ba43a[_0x3b214f(0x609)]===_0x476500[_0x3b214f(0x2ee)]);_0xae5c05&&_0xae5c05[_0x3b214f(0x1294)]&&_0x1f3be5&&(_0x1c1d43[_0x3b214f(0xe19)][_0xae5c05['name']]=_0x1f3be5[_0x3b214f(0x609)]);}),_0x1c1d43[_0x321afa(0x120f)]=null;}catch(_0x30203a){console[_0x321afa(0x1221)](_0x321afa(0x5dc),_0x30203a),await _0x1bff53(_0x321afa(0x24d),_0x321afa(0xdd3)+_0x30203a[_0x321afa(0x86e)]),document[_0x321afa(0x9c8)](_0x321afa(0x32e))[_0x321afa(0x5e1)][_0x321afa(0x3c5)]=_0x321afa(0x3d9);return;}const _0xf2cf58=_0x1c1d43[_0x321afa(0x544)][_0x321afa(0xfc3)](_0x1ac6b3=>_0x1ac6b3['id']===_0x321afa(0x586));if(_0xf2cf58&&_0xf2cf58[_0x321afa(0x1294)]){_0xe634a6('请你投票。'),_0x19e314();const _0x25338b=await _0x5273c4(_0x321afa(0xcec)),_0x7c9950=_0x1c1d43[_0x321afa(0x544)][_0x321afa(0xfc3)](_0x1f0b89=>_0x1f0b89['id']===_0x25338b);_0x7c9950&&(_0x1c1d43[_0x321afa(0xe19)][_0xf2cf58[_0x321afa(0x609)]]=_0x7c9950[_0x321afa(0x609)]);}_0x28cf87();}async function _0x45b016(){const _0x5adba3=_0x419fa8,{proxyUrl:_0x51df41,apiKey:_0x5edfb5,model:_0x4e9e5f}=_0x9ebf46['apiConfig'];if(!_0x51df41||!_0x5edfb5||!_0x4e9e5f)return null;const _0x2a8416=_0x1c1d43[_0x5adba3(0x544)]['filter'](_0x41b1e8=>_0x41b1e8['isAlive']&&_0x41b1e8['id']!==_0x5adba3(0x586)),_0x1699c8=_0x1c1d43[_0x5adba3(0x544)][_0x5adba3(0x401)](_0xd337db=>_0xd337db['isAlive'])['map'](_0x5373c0=>_0x5373c0[_0x5adba3(0x609)]);let _0x36e000=_0x2066aa();_0x36e000+=_0x5adba3(0x2a0)+_0x1699c8['join'](',\x20')+'\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。';try{let _0x454e6f=_0x51df41[_0x5adba3(0x930)]('generativelanguage'),_0x73d10c=[{'role':'user','content':_0x5adba3(0x1196)}],_0x2a09d5=_0x2e5c04(_0x4e9e5f,_0x5edfb5,_0x36e000,_0x73d10c);const _0x5ca9b3=_0x454e6f?await fetch(_0x2a09d5[_0x5adba3(0x11be)],_0x2a09d5[_0x5adba3(0x100d)]):await fetch(_0x51df41+_0x5adba3(0x1090),{'method':'POST','headers':{'Content-Type':_0x5adba3(0x698),'Authorization':_0x5adba3(0x84a)+_0x5edfb5},'body':JSON[_0x5adba3(0xf1e)]({'model':_0x4e9e5f,'messages':[{'role':_0x5adba3(0xb64),'content':_0x36e000},..._0x73d10c],'temperature':_0x9ebf46[_0x5adba3(0x1383)]['apiTemperature']||0.8})});if(!_0x5ca9b3['ok'])throw new Error((await _0x5ca9b3[_0x5adba3(0x5dd)]())[_0x5adba3(0x1221)][_0x5adba3(0x86e)]);const _0x76e09a=await _0x5ca9b3['json'](),_0x4178db=getGeminiResponseText(_0x76e09a);let _0x452ca3=_0x4178db[_0x5adba3(0x459)](/^```json\s*/,'')[_0x5adba3(0x459)](/```$/,'')[_0x5adba3(0x3f1)]();const _0x586482=_0x452ca3['indexOf']('['),_0x3f856a=_0x452ca3[_0x5adba3(0x857)](']');if(_0x586482===-0x1||_0x3f856a===-0x1||_0x3f856a<_0x586482)throw new Error(_0x5adba3(0xb1c));const _0x11eddd=_0x452ca3[_0x5adba3(0xc34)](_0x586482,_0x3f856a+0x1);try{const _0x74681f=_0x11eddd[_0x5adba3(0x12c2)](/(\[[\s\S]*?\])/g);if(_0x74681f&&_0x74681f[_0x5adba3(0xa06)]>0x0)return JSON[_0x5adba3(0x907)](_0x74681f[_0x74681f[_0x5adba3(0xa06)]-0x1]);return JSON[_0x5adba3(0x907)](_0x11eddd);}catch(_0x2220ba){throw new Error(_0x5adba3(0x951)+_0x2220ba['message']+_0x5adba3(0xa48)+_0x4178db);}}catch(_0x376d15){console[_0x5adba3(0x1221)]('获取AI投票失败:',_0x376d15);throw new Error(_0x5adba3(0x133a)+_0x376d15['message']);}}function _0x28cf87(){const _0x10adbf=_0x419fa8,_0x3840aa={},_0x1b8ebf={};for(const _0x11dfca in _0x1c1d43[_0x10adbf(0xe19)]){const _0x3a8e06=_0x1c1d43['votes'][_0x11dfca];_0x3840aa[_0x3a8e06]=(_0x3840aa[_0x3a8e06]||0x0)+0x1,!_0x1b8ebf[_0x3a8e06]&&(_0x1b8ebf[_0x3a8e06]=[]),_0x1b8ebf[_0x3a8e06][_0x10adbf(0x668)](_0x11dfca);}let _0x6cc227=0x0,_0x14c324=[];for(const _0x268d3b in _0x3840aa){const _0x17f0b8=_0x3840aa[_0x268d3b];if(_0x17f0b8>_0x6cc227)_0x6cc227=_0x17f0b8,_0x14c324=[_0x268d3b];else _0x17f0b8===_0x6cc227&&_0x14c324[_0x10adbf(0x668)](_0x268d3b);}_0xe634a6('投票结果：');for(const _0xa0264a in _0x1b8ebf){_0xe634a6(_0xa0264a+'\x20('+_0x1b8ebf[_0xa0264a][_0x10adbf(0xa06)]+_0x10adbf(0x1353)+_0x1b8ebf[_0xa0264a]['join']('、\x20'));}if(_0x14c324['length']===0x1&&_0x6cc227>0x0){const _0x216bc3=_0x1c1d43['players'][_0x10adbf(0xfc3)](_0x43cfe3=>_0x43cfe3[_0x10adbf(0x609)]===_0x14c324[0x0]);if(_0x216bc3){_0x216bc3[_0x10adbf(0x1294)]=![],_0xe634a6(_0x216bc3['name']+_0x10adbf(0x1153));if(_0x216bc3['role']==='猎人'){}}}else _0xe634a6(_0x10adbf(0x2f4));_0x19e314();if(_0x1ddcec())return;_0x1c1d43[_0x10adbf(0x8b8)]++,_0x1116f9();}async function _0xdf4373(){const _0x272dcb=_0x419fa8,{proxyUrl:_0x883291,apiKey:_0x576c19,model:_0x5d5685}=_0x9ebf46[_0x272dcb(0x4de)];if(!_0x883291||!_0x576c19||!_0x5d5685)return null;const _0x152c2a=_0x1c1d43[_0x272dcb(0x544)][_0x272dcb(0x401)](_0x5a0fcf=>_0x5a0fcf['role']==='狼人'&&_0x5a0fcf[_0x272dcb(0x1294)]),_0x72f909=_0x1c1d43['players'][_0x272dcb(0x401)](_0x32f3f5=>_0x32f3f5[_0x272dcb(0x1294)]&&_0x32f3f5[_0x272dcb(0x7fd)]!=='狼人'),_0x880d66=_0x272dcb(0x67e)+_0x152c2a['map'](_0x1d0aa9=>_0x1d0aa9[_0x272dcb(0x609)])[_0x272dcb(0x809)]('、\x20')+_0x272dcb(0x49c)+_0x72f909[_0x272dcb(0xa3b)](_0xbd4b3=>_0xbd4b3[_0x272dcb(0x609)])[_0x272dcb(0x809)]('、\x20')+_0x272dcb(0x8e0)+_0x1c1d43[_0x272dcb(0x1337)][_0x272dcb(0xa3b)](_0xabcf64=>_0xabcf64['speaker']+':\x20'+_0xabcf64[_0x272dcb(0x53b)])[_0x272dcb(0x809)]('\x0a')+_0x272dcb(0xcc0);try{let _0x25ba62=_0x883291['includes'](_0x272dcb(0xb23)),_0x51e20b=[{'role':_0x272dcb(0x586),'content':'请选择今晚的目标。'}],_0x5247c5=_0x2e5c04(_0x5d5685,_0x576c19,_0x880d66,_0x51e20b);const _0x43dfd6=_0x25ba62?await fetch(_0x5247c5[_0x272dcb(0x11be)],_0x5247c5['data']):await fetch(_0x883291+_0x272dcb(0x1090),{'method':_0x272dcb(0x116f),'headers':{'Content-Type':_0x272dcb(0x698),'Authorization':_0x272dcb(0x84a)+_0x576c19},'body':JSON[_0x272dcb(0xf1e)]({'model':_0x5d5685,'messages':[{'role':_0x272dcb(0xb64),'content':_0x880d66},..._0x51e20b],'temperature':_0x9ebf46[_0x272dcb(0x1383)][_0x272dcb(0xc3d)]||0.8})});if(!_0x43dfd6['ok'])throw new Error((await _0x43dfd6['json']())['error'][_0x272dcb(0x86e)]);const _0x935cfc=await _0x43dfd6['json'](),_0x207732=getGeminiResponseText(_0x935cfc),_0x19f177=_0x207732['match'](/({[\s\S]*})/);if(!_0x19f177)throw new Error(_0x272dcb(0x112b));const _0x2f7966=JSON[_0x272dcb(0x907)](_0x19f177[0x0]),_0x1ae1ad=_0x1c1d43['players']['find'](_0x1c8ee1=>_0x1c8ee1['name']===_0x2f7966[_0x272dcb(0x9cd)]);return _0x1ae1ad?_0x1ae1ad['id']:null;}catch(_0xcfeb88){return console[_0x272dcb(0x1221)](_0x272dcb(0x10f2),_0xcfeb88),_0x72f909[Math['floor'](Math[_0x272dcb(0x360)]()*_0x72f909[_0x272dcb(0xa06)])]['id'];}}function _0x1123f7(_0x4f55f4,_0x3478c1){return new Promise(_0xc375d5=>{const _0x54db27=_0x3569,_0x5e81e3=document[_0x54db27(0x9c8)](_0x54db27(0x1352)),_0x14c171=document[_0x54db27(0x9c8)](_0x54db27(0x1284)),_0x44c035=document[_0x54db27(0x9c8)](_0x54db27(0x885)),_0x2410b0=document[_0x54db27(0x9c8)]('confirm-witch-poison-btn'),_0x9382ad=document['getElementById']('witch-do-nothing-btn');_0x14c171[_0x54db27(0x2f5)]='';const _0x35d73c=_0x2410b0['cloneNode'](!![]);_0x2410b0['parentNode'][_0x54db27(0x4d7)](_0x35d73c,_0x2410b0);const _0xb03615=_0x9382ad[_0x54db27(0x75c)](!![]);_0x9382ad[_0x54db27(0x127d)][_0x54db27(0x4d7)](_0xb03615,_0x9382ad),_0x35d73c[_0x54db27(0x5e1)][_0x54db27(0x3c5)]='block',_0x35d73c['disabled']=!![];let _0x45cb35={'save':![],'poison':null},_0x294756=null;if(_0x4f55f4&&!_0x3478c1['antidoteUsed']){_0x44c035[_0x54db27(0xe24)]='昨晚\x20'+_0x4f55f4[_0x54db27(0x609)]+_0x54db27(0x5c8);const _0x25fc88=document['createElement'](_0x54db27(0x82f));_0x25fc88[_0x54db27(0x82c)]=_0x54db27(0x10d8),_0x25fc88[_0x54db27(0xe24)]='使用解药救TA',_0x25fc88['style']['margin']=_0x54db27(0x10f6),_0x25fc88[_0x54db27(0x2fa)]=()=>{const _0x55f577=_0x54db27;_0x45cb35[_0x55f577(0x7e9)]=!![],_0x5e81e3[_0x55f577(0x575)]['remove'](_0x55f577(0xc3f)),_0xc375d5(_0x45cb35);},_0x14c171[_0x54db27(0x7b9)](_0x25fc88);}else _0x4f55f4?_0x44c035['textContent']=_0x54db27(0x261)+_0x4f55f4[_0x54db27(0x609)]+_0x54db27(0x5f8):_0x44c035[_0x54db27(0xe24)]=_0x54db27(0x71a);if(!_0x3478c1[_0x54db27(0x13cc)]){const _0x22fc75=document[_0x54db27(0x28a)]('p');_0x22fc75[_0x54db27(0xe24)]=_0x54db27(0xbbe),_0x22fc75[_0x54db27(0x5e1)][_0x54db27(0x7b6)]=_0x54db27(0x9f7),_0x22fc75[_0x54db27(0x5e1)][_0x54db27(0x4cf)]=_0x54db27(0x10f6),_0x14c171[_0x54db27(0x7b9)](_0x22fc75);const _0x13d97c=_0x1c1d43[_0x54db27(0x544)][_0x54db27(0x401)](_0xf79111=>_0xf79111[_0x54db27(0x1294)]&&_0xf79111['id']!==_0x4f55f4?.['id']);_0x13d97c[_0x54db27(0x591)](_0x4a9f84=>{const _0x592c07=_0x54db27,_0x1269cc=document[_0x592c07(0x28a)](_0x592c07(0x11f4));_0x1269cc['className']=_0x592c07(0x456),_0x1269cc[_0x592c07(0xc9f)]['id']=_0x4a9f84['id'],_0x1269cc[_0x592c07(0x2f5)]=_0x592c07(0x12ac)+_0x4a9f84['avatar']+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0x4a9f84[_0x592c07(0x609)]+_0x592c07(0x12c8),_0x1269cc[_0x592c07(0x2fa)]=()=>{const _0x247ab0=_0x592c07;_0x14c171[_0x247ab0(0x7e4)]('.selected')[_0x247ab0(0x591)](_0x48eb02=>_0x48eb02[_0x247ab0(0x575)][_0x247ab0(0x30f)](_0x247ab0(0x631))),_0x1269cc[_0x247ab0(0x575)]['add']('selected'),_0x294756=_0x4a9f84['id'],_0x35d73c['disabled']=![];},_0x14c171[_0x592c07(0x7b9)](_0x1269cc);});}_0x35d73c['onclick']=()=>{const _0x14e8b2=_0x54db27;_0x294756&&(_0x45cb35['poison']=_0x294756,_0x5e81e3[_0x14e8b2(0x575)][_0x14e8b2(0x30f)]('visible'),_0xc375d5(_0x45cb35));},_0xb03615[_0x54db27(0x2fa)]=()=>{const _0x268018=_0x54db27;_0x5e81e3[_0x268018(0x575)][_0x268018(0x30f)]('visible'),_0xc375d5(_0x45cb35);},_0x5e81e3['classList'][_0x54db27(0x68e)](_0x54db27(0xc3f));});}async function _0x1ecc36(){const _0xbf010e=_0x419fa8,_0x3ca647=_0x1c1d43[_0xbf010e(0x120f)];if(!_0x3ca647)return;document['getElementById'](_0xbf010e(0x32e))[_0xbf010e(0x5e1)][_0xbf010e(0x3c5)]='none',await _0x1bff53(_0xbf010e(0x7a4),_0xbf010e(0x102c)+_0x3ca647+_0xbf010e(0x5a5));switch(_0x3ca647){case _0xbf010e(0x9f5):await _0x1116f9();break;case _0xbf010e(0x481):await _0x5a3f2b();break;case _0xbf010e(0xa6a):await _0x4ab9bb();break;}}function _0x1ddcec(){const _0x293dd2=_0x419fa8,_0x25b546=_0x1c1d43[_0x293dd2(0x544)][_0x293dd2(0x401)](_0x29d5c9=>_0x29d5c9[_0x293dd2(0x1294)]),_0x1451ae=_0x25b546[_0x293dd2(0x401)](_0x219c04=>_0x219c04[_0x293dd2(0x7fd)]==='狼人'),_0x22f084=_0x25b546['filter'](_0x3039fb=>['预言家','女巫','猎人','守卫']['includes'](_0x3039fb[_0x293dd2(0x7fd)])),_0x4ab3aa=_0x25b546[_0x293dd2(0x401)](_0x589597=>_0x589597[_0x293dd2(0x7fd)]==='平民');let _0x3bcd6e=null;if(_0x1451ae['length']===0x0)_0x3bcd6e='好人';else{if(_0x1451ae['length']>=_0x22f084[_0x293dd2(0xa06)]+_0x4ab3aa['length'])_0x3bcd6e='狼人';else _0x1c1d43[_0x293dd2(0xf45)]===_0x293dd2(0x9cf)?(_0x22f084['length']===0x0||_0x4ab3aa[_0x293dd2(0xa06)]===0x0)&&(_0x3bcd6e='狼人'):_0x22f084[_0x293dd2(0xa06)]===0x0&&_0x4ab3aa[_0x293dd2(0xa06)]===0x0&&(_0x3bcd6e='狼人');}if(_0x3bcd6e)return _0x12a4fb(_0x3bcd6e),!![];return![];}async function _0xaaa6b1(){const _0x2e4dae=_0x419fa8,_0x164692=await _0x352ae9(_0x2e4dae(0x10c7),_0x2e4dae(0xd58),{'confirmText':_0x2e4dae(0x369)});if(!_0x164692)return;await _0x1bff53('请稍候...','正在扫描和修复数据...');try{const _0x234004=await _0x2c5bcf[_0x2e4dae(0x547)][_0x2e4dae(0x5ff)]();let _0x44e5c7=0x0;for(const _0x554500 of _0x234004){let _0x8737ba=![];!Array['isArray'](_0x554500[_0x2e4dae(0x8b3)])&&(_0x554500[_0x2e4dae(0x8b3)]=[],_0x8737ba=!![]),(typeof _0x554500['settings']!==_0x2e4dae(0xc24)||_0x554500['settings']===null)&&(_0x554500[_0x2e4dae(0x1131)]={},_0x8737ba=!![]),!_0x554500[_0x2e4dae(0x11e4)]&&!_0x554500[_0x2e4dae(0x1071)]&&(_0x554500['originalName']=_0x554500[_0x2e4dae(0x609)],_0x8737ba=!![]),typeof _0x554500['unreadCount']===_0x2e4dae(0xa20)&&(_0x554500['unreadCount']=0x0,_0x8737ba=!![]),!Array[_0x2e4dae(0xb27)](_0x554500[_0x2e4dae(0x323)])&&(_0x554500['longTermMemory']=[],_0x8737ba=!![]),_0x8737ba&&(_0x44e5c7++,console[_0x2e4dae(0x283)](_0x2e4dae(0x55e)+_0x554500['name']+'\x22\x20(ID:\x20'+_0x554500['id']+_0x2e4dae(0x750)),await _0x2c5bcf[_0x2e4dae(0x547)][_0x2e4dae(0xff5)](_0x554500)),_0x9ebf46[_0x2e4dae(0x547)][_0x554500['id']]=_0x554500;}_0x44e5c7>0x0?(await _0x1bff53(_0x2e4dae(0x3ab),_0x2e4dae(0x3a8)+_0x44e5c7+_0x2e4dae(0x35f)),await _0x394b2c()):await _0x1bff53(_0x2e4dae(0x59f),_0x2e4dae(0xe1c));}catch(_0x21bff0){console[_0x2e4dae(0x1221)]('数据检查与修复失败:',_0x21bff0),await _0x1bff53(_0x2e4dae(0x24d),'执行检查时发生错误:\x20'+_0x21bff0[_0x2e4dae(0x86e)]);}}function _0xde08bb(_0x250d5d,_0x524f4a='top'){const _0x2c61bf=_0x419fa8;if(_0x250d5d[_0x2c61bf(0x91d)]('.loader-container'))return;const _0x3c29dd=document[_0x2c61bf(0x28a)](_0x2c61bf(0x11f4));_0x3c29dd[_0x2c61bf(0x82c)]=_0x2c61bf(0xb93),_0x3c29dd[_0x2c61bf(0x2f5)]=_0x2c61bf(0x555),_0x524f4a===_0x2c61bf(0x40f)?_0x250d5d[_0x2c61bf(0x7b9)](_0x3c29dd):_0x250d5d['prepend'](_0x3c29dd);}function _0xfb2eb9(_0x4362f4){const _0x51b3e7=_0x419fa8,_0x4d138b=_0x4362f4[_0x51b3e7(0x91d)]('.loader-container');_0x4d138b&&_0x4d138b[_0x51b3e7(0x30f)]();}async function _0x1c4d4d(){const _0x5b25a8=_0x419fa8,_0x40cb50=document[_0x5b25a8(0x9c8)]('delete-world-books-modal'),_0x5d3c92=document[_0x5b25a8(0x9c8)](_0x5b25a8(0x1c1)),_0x4f8893=document[_0x5b25a8(0x9c8)]('select-all-world-books-for-clear');_0x5d3c92[_0x5b25a8(0x2f5)]='',_0x4f8893[_0x5b25a8(0x1ec)]=![];const _0x3534ad=await _0x2c5bcf['worldBooks'][_0x5b25a8(0x5ff)]();_0x3534ad[_0x5b25a8(0xa06)]===0x0?_0x5d3c92[_0x5b25a8(0x2f5)]=_0x5b25a8(0x78a):_0x3534ad[_0x5b25a8(0x591)](_0x434c6b=>{const _0x563399=_0x5b25a8,_0x18182b=document[_0x563399(0x28a)](_0x563399(0x11f4));_0x18182b['className']=_0x563399(0xab6),_0x18182b[_0x563399(0xc9f)]['bookId']=_0x434c6b['id'],_0x18182b[_0x563399(0x2f5)]=_0x563399(0x129c)+_0x434c6b[_0x563399(0x609)]+_0x563399(0x4fc),_0x5d3c92[_0x563399(0x7b9)](_0x18182b);}),_0x40cb50[_0x5b25a8(0x575)][_0x5b25a8(0x68e)](_0x5b25a8(0xc3f));}async function _0x421182(){const _0x5d5e75=_0x419fa8,_0x14f25c=document[_0x5d5e75(0x7e4)](_0x5d5e75(0xc0f));if(_0x14f25c[_0x5d5e75(0xa06)]===0x0){alert('请至少选择一个要删除的世界书。');return;}const _0x4c1931=Array[_0x5d5e75(0x13a5)](_0x14f25c)[_0x5d5e75(0xa3b)](_0x523b69=>_0x523b69[_0x5d5e75(0xc9f)][_0x5d5e75(0x7ad)]),_0x2a1fc2=await _0x352ae9('最后确认！','此操作将永久删除您选择的\x20'+_0x14f25c[_0x5d5e75(0xa06)]+'\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！',{'confirmButtonClass':_0x5d5e75(0x12bc),'confirmText':'确认删除'});if(!_0x2a1fc2)return;await _0x1bff53(_0x5d5e75(0x7a4),_0x5d5e75(0x56f));try{await _0x2c5bcf[_0x5d5e75(0xa88)]('rw',_0x2c5bcf['worldBooks'],_0x2c5bcf['chats'],async()=>{const _0x5ae986=_0x5d5e75;await _0x2c5bcf[_0x5ae986(0x1369)]['bulkDelete'](_0x4c1931);const _0x122489=await _0x2c5bcf[_0x5ae986(0x547)][_0x5ae986(0x5ff)]();for(const _0x302a11 of _0x122489){if(_0x302a11[_0x5ae986(0x1131)]&&Array[_0x5ae986(0xb27)](_0x302a11[_0x5ae986(0x1131)][_0x5ae986(0x41a)])){const _0x189dac=_0x302a11['settings'][_0x5ae986(0x41a)]['length'];_0x302a11[_0x5ae986(0x1131)][_0x5ae986(0x41a)]=_0x302a11['settings'][_0x5ae986(0x41a)]['filter'](_0x11bb4a=>!_0x4c1931[_0x5ae986(0x930)](_0x11bb4a)),_0x302a11[_0x5ae986(0x1131)]['linkedWorldBookIds'][_0x5ae986(0xa06)]<_0x189dac&&await _0x2c5bcf[_0x5ae986(0x547)][_0x5ae986(0xff5)](_0x302a11);}}}),_0x9ebf46[_0x5d5e75(0x1369)]=_0x9ebf46[_0x5d5e75(0x1369)]['filter'](_0x5d891a=>!_0x4c1931[_0x5d5e75(0x930)](_0x5d891a['id'])),document[_0x5d5e75(0x9c8)](_0x5d5e75(0xea7))[_0x5d5e75(0x575)]['remove']('visible'),await _0x1bff53(_0x5d5e75(0x3e7),_0x14f25c[_0x5d5e75(0xa06)]+_0x5d5e75(0x1a8));}catch(_0x28c4d1){console[_0x5d5e75(0x1221)](_0x5d5e75(0x1308),_0x28c4d1),await _0x1bff53('删除失败',_0x5d5e75(0xcb0)+_0x28c4d1[_0x5d5e75(0x86e)]);}}function _0x4ef20e(){const _0x17ebcf=_0x419fa8;if(!_0x9ebf46['activeChatId'])return;const _0x471774=_0x9ebf46[_0x17ebcf(0x970)],_0x18b65d=document[_0x17ebcf(0x9c8)](_0x17ebcf(0x807)),_0x40c149=document[_0x17ebcf(0x9c8)](_0x17ebcf(0x108c)),_0x52270c=document[_0x17ebcf(0x9c8)]('reading-restore-btn');let _0x5041ee=_0x57f4a4[_0x471774];if(_0x5041ee&&_0x5041ee[_0x17ebcf(0x103f)]){_0x5041ee[_0x17ebcf(0x126e)]&&_0x5981();_0x18b65d[_0x17ebcf(0x5e1)][_0x17ebcf(0x3c5)]=_0x17ebcf(0x989);return;}_0x6d00d0(_0x471774),_0x1b5602(_0x471774),_0x18b65d[_0x17ebcf(0x5e1)][_0x17ebcf(0x3c5)]=_0x17ebcf(0x989),_0x40c149['classList']['remove'](_0x17ebcf(0x828)),_0x52270c[_0x17ebcf(0x5e1)][_0x17ebcf(0x3c5)]=_0x17ebcf(0x8f6);const _0x3f7780=document[_0x17ebcf(0x9c8)](_0x17ebcf(0x6fb)),_0xb5d43d=_0x40c149[_0x17ebcf(0xe2c)](),_0x154b68=(_0x3f7780[_0x17ebcf(0xfce)]-_0xb5d43d['height'])/0x2,_0x134578=(_0x3f7780[_0x17ebcf(0xfc6)]-_0xb5d43d[_0x17ebcf(0x125e)])/0x2;_0x40c149[_0x17ebcf(0x5e1)][_0x17ebcf(0x114a)]=_0x154b68+'px',_0x40c149[_0x17ebcf(0x5e1)][_0x17ebcf(0x12b6)]=_0x134578+'px',_0x40c149['style'][_0x17ebcf(0xf57)]='';}function _0x6d00d0(_0x193c81){const _0x49e1f2=_0x419fa8;_0x57f4a4[_0x193c81]={'isActive':!![],'isMinimized':![],'title':_0x49e1f2(0xa53),'contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0x36c2b5(){const _0x279e91=_0x419fa8,_0x5d77e0=_0x9ebf46['activeChatId'];if(!_0x5d77e0||!_0x57f4a4[_0x5d77e0]||!_0x57f4a4[_0x5d77e0]['isActive'])return;document['getElementById'](_0x279e91(0x807))[_0x279e91(0x5e1)][_0x279e91(0x3c5)]='none',document['getElementById'](_0x279e91(0x11dc))['style'][_0x279e91(0x3c5)]=_0x279e91(0x8f6),document[_0x279e91(0x9c8)]('reading-window')[_0x279e91(0x575)][_0x279e91(0x30f)](_0x279e91(0x828)),_0x57f4a4[_0x5d77e0][_0x279e91(0x103f)]=![],console[_0x279e91(0x283)](_0x279e91(0xb25));}function _0x2a1df1(){const _0x5459ac=_0x419fa8,_0x164450=_0x57f4a4[_0x9ebf46['activeChatId']];if(!_0x164450||!_0x164450[_0x5459ac(0x103f)]||_0x164450[_0x5459ac(0x126e)])return;_0x164450[_0x5459ac(0x126e)]=!![],document[_0x5459ac(0x9c8)]('reading-window')[_0x5459ac(0x575)][_0x5459ac(0x68e)](_0x5459ac(0x828)),document[_0x5459ac(0x9c8)](_0x5459ac(0x11dc))[_0x5459ac(0x5e1)][_0x5459ac(0x3c5)]=_0x5459ac(0x989);}function _0x5981(){const _0x4421be=_0x419fa8,_0x486611=_0x57f4a4[_0x9ebf46[_0x4421be(0x970)]];if(!_0x486611||!_0x486611[_0x4421be(0x103f)]||!_0x486611['isMinimized'])return;_0x486611[_0x4421be(0x126e)]=![],document[_0x4421be(0x9c8)](_0x4421be(0x11dc))[_0x4421be(0x5e1)]['display']='none',document[_0x4421be(0x9c8)](_0x4421be(0x108c))['classList'][_0x4421be(0x30f)](_0x4421be(0x828));}function _0x194388(_0x156094,_0x1a4d32){const _0x466eee=_0x419fa8;let _0x432e22=0x0,_0x5e0f93=0x0,_0x440b4f=0x0,_0x449cb5=0x0;const _0x2ebc85=document['getElementById'](_0x466eee(0x6fb)),_0x414ff5=_0x2928d7=>{const _0x4f54e1=_0x466eee;if(_0x2928d7[_0x4f54e1(0x1070)][_0x4f54e1(0xaa0)]('button'))return;if(_0x156094[_0x4f54e1(0x5e1)][_0x4f54e1(0xf57)]){const _0x42e15d=_0x156094[_0x4f54e1(0xe2c)](),_0x36b764=_0x156094[_0x4f54e1(0x76a)][_0x4f54e1(0xe2c)]();_0x156094[_0x4f54e1(0x5e1)][_0x4f54e1(0x114a)]=_0x42e15d['top']-_0x36b764[_0x4f54e1(0x114a)]+'px',_0x156094[_0x4f54e1(0x5e1)][_0x4f54e1(0x12b6)]=_0x42e15d[_0x4f54e1(0x12b6)]-_0x36b764['left']+'px',_0x156094[_0x4f54e1(0x5e1)][_0x4f54e1(0xf57)]='';}_0x2928d7[_0x4f54e1(0xf26)]();const _0x185a02=_0x2928d7[_0x4f54e1(0x12d9)]===_0x4f54e1(0xa6d)?_0x2928d7[_0x4f54e1(0x781)][0x0]:_0x2928d7;_0x440b4f=_0x185a02[_0x4f54e1(0x223)],_0x449cb5=_0x185a02[_0x4f54e1(0x96d)],document[_0x4f54e1(0xa0f)](_0x4f54e1(0xdf0),_0x45f7e1),document[_0x4f54e1(0xa0f)](_0x4f54e1(0x726),_0x13492d),document[_0x4f54e1(0xa0f)](_0x4f54e1(0xd41),_0x45f7e1),document['addEventListener'](_0x4f54e1(0x699),_0x13492d);},_0x13492d=_0x26a66f=>{const _0x5c3216=_0x466eee,_0x557eb7=_0x26a66f[_0x5c3216(0x12d9)]===_0x5c3216(0x699)?_0x26a66f['touches'][0x0]:_0x26a66f;_0x432e22=_0x440b4f-_0x557eb7[_0x5c3216(0x223)],_0x5e0f93=_0x449cb5-_0x557eb7[_0x5c3216(0x96d)],_0x440b4f=_0x557eb7[_0x5c3216(0x223)],_0x449cb5=_0x557eb7[_0x5c3216(0x96d)];let _0x6cc031=_0x156094['offsetTop']-_0x5e0f93,_0x49384d=_0x156094[_0x5c3216(0x3a3)]-_0x432e22;const _0xdd2803=_0x2ebc85[_0x5c3216(0xfce)]-_0x156094['offsetHeight']-0xa,_0x3b0a8b=_0x2ebc85[_0x5c3216(0xfc6)]-_0x156094['offsetWidth']-0xa;_0x6cc031=Math[_0x5c3216(0x24e)](0xa,Math[_0x5c3216(0x24c)](_0x6cc031,_0xdd2803)),_0x49384d=Math[_0x5c3216(0x24e)](0xa,Math['min'](_0x49384d,_0x3b0a8b)),_0x156094[_0x5c3216(0x5e1)]['top']=_0x6cc031+'px',_0x156094[_0x5c3216(0x5e1)]['left']=_0x49384d+'px';},_0x45f7e1=()=>{const _0x288a90=_0x466eee;document[_0x288a90(0xc9d)]('mouseup',_0x45f7e1),document[_0x288a90(0xc9d)](_0x288a90(0x726),_0x13492d),document['removeEventListener'](_0x288a90(0xd41),_0x45f7e1),document[_0x288a90(0xc9d)]('touchmove',_0x13492d);};_0x1a4d32[_0x466eee(0xa0f)](_0x466eee(0x124a),_0x414ff5),_0x1a4d32[_0x466eee(0xa0f)]('touchstart',_0x414ff5);}function _0x1b5602(_0x5807ff){const _0x43508a=_0x419fa8,_0x30c75e=_0x57f4a4[_0x5807ff];if(!_0x30c75e)return;const _0x106c7e=document[_0x43508a(0x9c8)]('reading-title'),_0x5e8179=document[_0x43508a(0x9c8)]('reading-content'),_0x5e00b9=document[_0x43508a(0x9c8)](_0x43508a(0x845)),_0x31d96b=document[_0x43508a(0x9c8)](_0x43508a(0xd63)),_0x1d65ec=document[_0x43508a(0x9c8)](_0x43508a(0xbbc));_0x106c7e['textContent']=_0x30c75e[_0x43508a(0x9f2)];if(_0x30c75e['contentLines'][_0x43508a(0xa06)]===0x0)_0x5e8179[_0x43508a(0x2f5)]=_0x43508a(0x6da),_0x30c75e[_0x43508a(0x1187)]=0x0,_0x30c75e[_0x43508a(0x11c3)]=0x0;else{const _0x34f6a3=_0x30c75e[_0x43508a(0x11c3)]*_0x30c75e[_0x43508a(0x1182)],_0x1ddcb2=_0x34f6a3+_0x30c75e[_0x43508a(0x1182)];_0x5e8179[_0x43508a(0xe24)]=_0x30c75e[_0x43508a(0x8c6)]['slice'](_0x34f6a3,_0x1ddcb2)['join']('\x0a');}_0x5e00b9[_0x43508a(0xe24)]=_0x30c75e[_0x43508a(0x11c3)]+0x1+_0x43508a(0x69e)+_0x30c75e[_0x43508a(0x1187)],_0x31d96b['disabled']=_0x30c75e[_0x43508a(0x11c3)]===0x0,_0x1d65ec[_0x43508a(0x823)]=_0x30c75e[_0x43508a(0x11c3)]>=_0x30c75e[_0x43508a(0x1187)]-0x1;}function _0x1fdb41(){const _0x305275=_0x419fa8,_0x4aea14=_0x57f4a4[_0x9ebf46['activeChatId']];_0x4aea14&&_0x4aea14[_0x305275(0x11c3)]<_0x4aea14[_0x305275(0x1187)]-0x1&&(_0x4aea14[_0x305275(0x11c3)]++,_0x1b5602(_0x9ebf46['activeChatId']),document[_0x305275(0x9c8)]('reading-content')[_0x305275(0x783)]=0x0,_0x2c204c(_0x4aea14['activeBookId'],_0x4aea14[_0x305275(0x11c3)]));}async function _0x2d59f7(){const _0x27140c=_0x419fa8,_0x4018ad=_0x57f4a4[_0x9ebf46['activeChatId']];_0x4018ad&&_0x4018ad['currentPage']>0x0&&(_0x4018ad[_0x27140c(0x11c3)]--,_0x1b5602(_0x9ebf46[_0x27140c(0x970)]),document['getElementById'](_0x27140c(0xdba))['scrollTop']=0x0,await _0x2c204c(_0x4018ad[_0x27140c(0xd94)],_0x4018ad[_0x27140c(0x11c3)]),await notifyAiOfPageTurn(_0x9ebf46['activeChatId'],_0x4018ad));}function _0x23f649(){const _0x4764ad=_0x419fa8;document['getElementById'](_0x4764ad(0xd9b))[_0x4764ad(0xf5c)]();}async function _0x112d66(_0x4c45b0){const _0x274a37=_0x419fa8,_0x3663ae=new Uint8Array(_0x4c45b0);if(_0x3663ae[_0x274a37(0xa06)]>=0x3&&_0x3663ae[0x0]===0xef&&_0x3663ae[0x1]===0xbb&&_0x3663ae[0x2]===0xbf)return console['log'](_0x274a37(0xd21)),new TextDecoder(_0x274a37(0x1272))[_0x274a37(0x128e)](_0x3663ae);if(_0x3663ae[_0x274a37(0xa06)]>=0x2&&_0x3663ae[0x0]===0xff&&_0x3663ae[0x1]===0xfe)return console[_0x274a37(0x283)](_0x274a37(0xb1d)),new TextDecoder(_0x274a37(0x25e))[_0x274a37(0x128e)](_0x3663ae);if(_0x3663ae['length']>=0x2&&_0x3663ae[0x0]===0xfe&&_0x3663ae[0x1]===0xff)return console[_0x274a37(0x283)]('检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。'),new TextDecoder('utf-16be')['decode'](_0x3663ae);try{console[_0x274a37(0x283)](_0x274a37(0x9a2));const _0xfd09ec=new TextDecoder(_0x274a37(0x1272),{'fatal':!![]})[_0x274a37(0x128e)](_0x3663ae);return console[_0x274a37(0x283)](_0x274a37(0x849)),_0xfd09ec;}catch(_0x3fb52a){console['log'](_0x274a37(0x3f9));try{const _0x122327=new TextDecoder(_0x274a37(0xf6f))[_0x274a37(0x128e)](_0x3663ae);return console[_0x274a37(0x283)](_0x274a37(0xc9c)),_0x122327;}catch(_0x23872a){console[_0x274a37(0x1221)](_0x274a37(0xc45),_0x23872a);throw new Error('无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。');}}}async function _0x1db2f5(_0x1aef4c){const _0x262868=_0x419fa8,_0x487d52=_0x1aef4c[_0x262868(0x1070)][_0x262868(0x1216)][0x0];if(!_0x487d52)return;try{const _0x18a513=await _0x487d52[_0x262868(0x72b)](),_0x57504f=await _0x112d66(_0x18a513),_0x9d95e0=_0x487d52['name'][_0x262868(0x459)](/\.txt$/i,''),_0x17ddef=await _0x2c5bcf[_0x262868(0x337)]['add']({'title':_0x9d95e0,'content':_0x57504f,'lastOpened':Date[_0x262868(0x9b7)]()});await _0x4460aa(_0x17ddef),document[_0x262868(0x9c8)]('reading-library-modal')[_0x262868(0x575)][_0x262868(0x1038)]('visible')&&_0x291d51();}catch(_0x494288){console['error']('导入书籍失败:',_0x494288),await _0x1bff53(_0x262868(0x685),_0x494288[_0x262868(0x86e)]);}finally{_0x1aef4c[_0x262868(0x1070)][_0x262868(0x1155)]=null;}}async function _0x5d767a(){const _0x59c595=_0x419fa8,_0x444216=_0x9ebf46['activeChatId'];if(!_0x444216)return;const _0x555277=_0x57f4a4[_0x444216];if(!_0x555277||_0x555277[_0x59c595(0x1187)]<=0x1)return;const _0x6601d2=await _0xadb5df(_0x59c595(0x33d),_0x59c595(0xace)+_0x555277[_0x59c595(0x1187)]+')',_0x555277[_0x59c595(0x11c3)]+0x1);if(_0x6601d2===null)return;const _0x3f54ec=parseInt(_0x6601d2);if(isNaN(_0x3f54ec)||_0x3f54ec<0x1||_0x3f54ec>_0x555277[_0x59c595(0x1187)]){alert(_0x59c595(0x98f));return;}_0x555277[_0x59c595(0x11c3)]=_0x3f54ec-0x1,_0x1b5602(_0x444216),_0x2c204c(_0x555277[_0x59c595(0xd94)],_0x555277[_0x59c595(0x11c3)]);}async function _0x2c204c(_0x4c2dfe,_0x453561){const _0x5345a1=_0x419fa8;if(!_0x4c2dfe)return;try{await _0x2c5bcf[_0x5345a1(0x337)]['update'](_0x4c2dfe,{'currentPage':_0x453561});}catch(_0x5703a4){console[_0x5345a1(0x1221)]('保存书籍(ID:\x20'+_0x4c2dfe+_0x5345a1(0x749),_0x5703a4);}}async function _0x1fdb41(){const _0x60dcaa=_0x419fa8,_0x41f719=_0x57f4a4[_0x9ebf46['activeChatId']];_0x41f719&&_0x41f719[_0x60dcaa(0x11c3)]<_0x41f719[_0x60dcaa(0x1187)]-0x1&&(_0x41f719[_0x60dcaa(0x11c3)]++,_0x1b5602(_0x9ebf46[_0x60dcaa(0x970)]),document['getElementById'](_0x60dcaa(0xdba))[_0x60dcaa(0x783)]=0x0,await _0x2c204c(_0x41f719[_0x60dcaa(0xd94)],_0x41f719[_0x60dcaa(0x11c3)]),await notifyAiOfPageTurn(_0x9ebf46['activeChatId'],_0x41f719));}function _0x545e61(_0x1a904e,_0x17b9a5){const _0x20902e=_0x419fa8,_0x2485d2=_0x9ebf46[_0x20902e(0x970)];if(!_0x2485d2)return;const _0x2e7d00=_0x57f4a4[_0x2485d2];_0x2e7d00[_0x20902e(0x9f2)]=_0x1a904e[_0x20902e(0x459)](/\.txt$/i,''),_0x2e7d00['contentLines']=_0x17b9a5['split'](/\r\n?|\n/)[_0x20902e(0xa3b)](_0x364b45=>_0x364b45[_0x20902e(0x459)](/ +/g,'\x20')),_0x2e7d00['totalPages']=Math[_0x20902e(0x1f1)](_0x2e7d00['contentLines'][_0x20902e(0xa06)]/_0x2e7d00[_0x20902e(0x1182)]),_0x2e7d00[_0x20902e(0x11c3)]=0x0,_0x1b5602(_0x2485d2);}async function _0x1ddb7e(){const _0x9ba3fb=_0x419fa8;document[_0x9ba3fb(0x9c8)]('reading-library-search-input')[_0x9ba3fb(0x1155)]='',await _0x291d51(),document[_0x9ba3fb(0x9c8)](_0x9ba3fb(0x269))['classList'][_0x9ba3fb(0x68e)]('visible');}async function _0x291d51(_0x3d26b1=''){const _0x5ae7b1=_0x419fa8,_0x1ece67=document[_0x5ae7b1(0x9c8)]('reading-library-list');let _0x58937e=await _0x2c5bcf['readingLibrary'][_0x5ae7b1(0x8ea)](_0x5ae7b1(0x8db))['reverse']()['toArray']();_0x1ece67[_0x5ae7b1(0x2f5)]='';_0x3d26b1&&(_0x58937e=_0x58937e['filter'](_0x1ae4c3=>_0x1ae4c3['title']['toLowerCase']()[_0x5ae7b1(0x930)](_0x3d26b1[_0x5ae7b1(0xc61)]())));if(_0x58937e[_0x5ae7b1(0xa06)]===0x0){const _0x4967d1=_0x3d26b1?_0x5ae7b1(0x660):_0x5ae7b1(0x3bf);_0x1ece67[_0x5ae7b1(0x2f5)]=_0x5ae7b1(0xae2)+_0x4967d1+'</p>';return;}_0x58937e['forEach'](_0x483144=>{const _0x2494f2=_0x5ae7b1,_0x5ce270=document['createElement']('div');_0x5ce270[_0x2494f2(0x82c)]=_0x2494f2(0xf68),_0x5ce270[_0x2494f2(0x2f5)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22'+_0x483144['id']+'\x22>'+_0x483144['title']+_0x2494f2(0x11c8)+_0x483144['id']+_0x2494f2(0xf17),_0x1ece67[_0x2494f2(0x7b9)](_0x5ce270);});}async function _0x4460aa(_0x4f11a2){const _0x2eaa17=_0x419fa8,_0x2f25fc=_0x9ebf46[_0x2eaa17(0x970)];if(!_0x2f25fc)return;const _0x37235b=await _0x2c5bcf[_0x2eaa17(0x337)]['get'](_0x4f11a2);if(!_0x37235b){alert(_0x2eaa17(0x11d8));return;}await _0x2c5bcf[_0x2eaa17(0x337)]['update'](_0x4f11a2,{'lastOpened':Date[_0x2eaa17(0x9b7)]()});const _0x2180eb=_0x57f4a4[_0x2f25fc];_0x2180eb[_0x2eaa17(0xd94)]=_0x4f11a2,_0x2180eb[_0x2eaa17(0x9f2)]=_0x37235b[_0x2eaa17(0x9f2)],_0x2180eb[_0x2eaa17(0x8c6)]=_0x37235b[_0x2eaa17(0x53b)][_0x2eaa17(0x6c6)](/\r\n?|\n/)[_0x2eaa17(0xa3b)](_0x1b9de7=>_0x1b9de7[_0x2eaa17(0x459)](/ +/g,'\x20')),_0x2180eb[_0x2eaa17(0x1187)]=Math[_0x2eaa17(0x1f1)](_0x2180eb[_0x2eaa17(0x8c6)]['length']/_0x2180eb[_0x2eaa17(0x1182)]),_0x2180eb[_0x2eaa17(0x11c3)]=_0x37235b[_0x2eaa17(0x11c3)]||0x0,_0x1b5602(_0x2f25fc),document[_0x2eaa17(0x9c8)]('reading-content')[_0x2eaa17(0x783)]=0x0,document[_0x2eaa17(0x9c8)](_0x2eaa17(0x269))[_0x2eaa17(0x575)]['remove']('visible');}async function _0x3bfbc9(_0x31a994){const _0x416e2c=_0x419fa8,_0x43222f=await _0x2c5bcf[_0x416e2c(0x337)][_0x416e2c(0xdf9)](_0x31a994);if(!_0x43222f)return;const _0x1d24ad=await _0x352ae9(_0x416e2c(0xc51),_0x416e2c(0x5d2)+_0x43222f['title']+_0x416e2c(0xf50),{'confirmButtonClass':_0x416e2c(0x12bc)});_0x1d24ad&&(await _0x2c5bcf['readingLibrary'][_0x416e2c(0x6d2)](_0x31a994),await _0x291d51());}function _0x545e61(_0x548d40,_0x58b5bd){const _0x3a8663=_0x419fa8,_0x5bb160=_0x9ebf46[_0x3a8663(0x970)];if(!_0x5bb160)return;const _0x2ee2b1=_0x57f4a4[_0x5bb160];_0x2ee2b1[_0x3a8663(0x9f2)]=_0x548d40[_0x3a8663(0x459)](/\.txt$/i,''),_0x2ee2b1[_0x3a8663(0x8c6)]=_0x58b5bd[_0x3a8663(0x6c6)](/\r\n?|\n/),_0x2ee2b1[_0x3a8663(0x1187)]=Math[_0x3a8663(0x1f1)](_0x2ee2b1[_0x3a8663(0x8c6)][_0x3a8663(0xa06)]/_0x2ee2b1[_0x3a8663(0x1182)]),_0x2ee2b1['currentPage']=0x0,_0x1b5602(_0x5bb160);}function _0x194388(_0x1dfe5e,_0x1fb284){const _0x1a5c0f=_0x419fa8;let _0x1c7cca=0x0,_0x2ea092=0x0,_0x5e6669=0x0,_0x18582b=0x0,_0x11538f=![],_0x211ea8=![];const _0x5d1bcb=document[_0x1a5c0f(0x9c8)](_0x1a5c0f(0x6fb)),_0x344114=_0x3ed760=>{const _0x3471cb=_0x1a5c0f;if(_0x1dfe5e!==_0x1fb284&&_0x3ed760[_0x3471cb(0x1070)]['closest']('button'))return;_0x11538f=!![],_0x211ea8=![];const _0x49abd1=_0x3ed760[_0x3471cb(0x12d9)]===_0x3471cb(0xa6d)?_0x3ed760[_0x3471cb(0x781)][0x0]:_0x3ed760;_0x5e6669=_0x49abd1[_0x3471cb(0x223)],_0x18582b=_0x49abd1[_0x3471cb(0x96d)],_0x1dfe5e[_0x3471cb(0x5e1)][_0x3471cb(0x114a)]=_0x1dfe5e['offsetTop']+'px',_0x1dfe5e['style'][_0x3471cb(0x12b6)]=_0x1dfe5e['offsetLeft']+'px',_0x1dfe5e[_0x3471cb(0x5e1)]['transform']='',document[_0x3471cb(0xa0f)](_0x3471cb(0xdf0),_0x273249),document[_0x3471cb(0xa0f)](_0x3471cb(0x726),_0x3f1486),document[_0x3471cb(0xa0f)](_0x3471cb(0xd41),_0x273249),document['addEventListener'](_0x3471cb(0x699),_0x3f1486,{'passive':![]});},_0x3f1486=_0x3fa753=>{const _0x282223=_0x1a5c0f;if(!_0x11538f)return;const _0x4b346a=_0x3fa753['type']==='touchmove'?_0x3fa753['touches'][0x0]:_0x3fa753,_0x1ca294=_0x4b346a[_0x282223(0x223)]-_0x5e6669,_0xf1fb0=_0x4b346a[_0x282223(0x96d)]-_0x18582b;!_0x211ea8&&(Math[_0x282223(0x4e2)](_0x1ca294)>0x5||Math[_0x282223(0x4e2)](_0xf1fb0)>0x5)&&(_0x211ea8=!![]);_0x211ea8&&_0x3fa753[_0x282223(0x748)]&&_0x3fa753['preventDefault']();_0x1c7cca=_0x5e6669-_0x4b346a[_0x282223(0x223)],_0x2ea092=_0x18582b-_0x4b346a[_0x282223(0x96d)],_0x5e6669=_0x4b346a['clientX'],_0x18582b=_0x4b346a[_0x282223(0x96d)];let _0x2c63d2=_0x1dfe5e[_0x282223(0xd22)]-_0x2ea092,_0x228759=_0x1dfe5e[_0x282223(0x3a3)]-_0x1c7cca;const _0x6308cf=_0x5d1bcb[_0x282223(0xfce)]-_0x1dfe5e[_0x282223(0x559)]-0xa,_0x2ac323=_0x5d1bcb[_0x282223(0xfc6)]-_0x1dfe5e[_0x282223(0x138e)]-0xa;_0x2c63d2=Math[_0x282223(0x24e)](0xa,Math[_0x282223(0x24c)](_0x2c63d2,_0x6308cf)),_0x228759=Math['max'](0xa,Math[_0x282223(0x24c)](_0x228759,_0x2ac323)),_0x1dfe5e[_0x282223(0x5e1)][_0x282223(0x114a)]=_0x2c63d2+'px',_0x1dfe5e['style'][_0x282223(0x12b6)]=_0x228759+'px';},_0x273249=()=>{const _0x190223=_0x1a5c0f;document[_0x190223(0xc9d)](_0x190223(0xdf0),_0x273249),document[_0x190223(0xc9d)](_0x190223(0x726),_0x3f1486),document[_0x190223(0xc9d)](_0x190223(0xd41),_0x273249),document['removeEventListener'](_0x190223(0x699),_0x3f1486);if(!_0x11538f)return;_0x11538f=![],!_0x211ea8&&_0x1dfe5e['click']();};_0x1fb284['addEventListener'](_0x1a5c0f(0x124a),_0x344114),_0x1fb284[_0x1a5c0f(0xa0f)](_0x1a5c0f(0xa6d),_0x344114,{'passive':![]});}function _0x2a1df1(){const _0x5b583a=_0x419fa8,_0x52bed1=_0x57f4a4[_0x9ebf46[_0x5b583a(0x970)]];if(!_0x52bed1||!_0x52bed1['isActive'])return;document[_0x5b583a(0x9c8)]('reading-window')[_0x5b583a(0x575)][_0x5b583a(0x68e)]('minimized'),document[_0x5b583a(0x9c8)](_0x5b583a(0x11dc))[_0x5b583a(0x5e1)]['display']=_0x5b583a(0x989),_0x52bed1[_0x5b583a(0x126e)]=!![];}function _0x5981(){const _0x18771a=_0x419fa8,_0x2a3699=_0x57f4a4[_0x9ebf46[_0x18771a(0x970)]];if(!_0x2a3699||!_0x2a3699[_0x18771a(0x103f)])return;document[_0x18771a(0x9c8)]('reading-restore-btn')['style'][_0x18771a(0x3c5)]=_0x18771a(0x8f6),document[_0x18771a(0x9c8)](_0x18771a(0x108c))[_0x18771a(0x575)]['remove']('minimized'),_0x2a3699['isMinimized']=![];}function _0x3b23c3(_0x910b81,_0x5d4413){let _0x31247c;return function(..._0x54d663){const _0x4be4de=_0x3569,_0x498f50=this;clearTimeout(_0x31247c),_0x31247c=setTimeout(()=>_0x910b81[_0x4be4de(0x1336)](_0x498f50,_0x54d663),_0x5d4413);};}function _0x495144(_0x425bdd){const _0x5339c1=_0x419fa8,_0x35d63b=_0x57f4a4[_0x425bdd];if(!_0x35d63b||!_0x35d63b[_0x5339c1(0x103f)])return'';const _0x31ce21=_0x35d63b[_0x5339c1(0x9f2)]||'未知书籍';let _0x2a42fb='',_0x432b4a='';if(_0x35d63b[_0x5339c1(0xf56)]&&_0x35d63b[_0x5339c1(0xf56)][_0x5339c1(0x3f1)]())_0x2a42fb=_0x35d63b['currentSnippet'],_0x432b4a=_0x5339c1(0x2ad);else{if(_0x35d63b['contentLines']['length']>0x0){const _0x21730e=_0x35d63b[_0x5339c1(0x11c3)]*_0x35d63b[_0x5339c1(0x1182)],_0x250082=_0x21730e+_0x35d63b[_0x5339c1(0x1182)];_0x2a42fb=_0x35d63b['contentLines'][_0x5339c1(0x1044)](_0x21730e,_0x250082)['join']('\x0a')[_0x5339c1(0xc34)](0x0,0xc8),_0x432b4a=_0x5339c1(0x90b);}else _0x2a42fb=_0x5339c1(0x1167),_0x432b4a='内容';}return _0x5339c1(0x8fd)+_0x31ce21+_0x5339c1(0x662)+_0x432b4a+_0x5339c1(0x618)+_0x2a42fb+'...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】('+(_0x9ebf46[_0x5339c1(0x547)][_0x425bdd]?.[_0x5339c1(0x1071)]||'AI角色')+_0x5339c1(0xda6);}function _0x4ee342(){const _0x23c5e3=_0x419fa8,_0x27de9f=_0x9ebf46[_0x23c5e3(0x970)];if(!_0x27de9f||!_0x57f4a4[_0x27de9f])return;const _0x799325=_0x57f4a4[_0x27de9f],_0x25e891=document[_0x23c5e3(0x9c8)](_0x23c5e3(0xdba)),_0x1f3755=_0x25e891[_0x23c5e3(0x783)],_0x46ca8f=_0x25e891[_0x23c5e3(0xfce)],_0x1a80ee=_0x1f3755+_0x46ca8f,_0x1e1bd6=0xf*1.8,_0xae9ed4=Math[_0x23c5e3(0x5fb)](_0x1f3755/_0x1e1bd6),_0xcd3cb7=Math[_0x23c5e3(0x1f1)](_0x1a80ee/_0x1e1bd6),_0x53e9c4=_0x799325[_0x23c5e3(0x11c3)]*_0x799325[_0x23c5e3(0x1182)]+_0xae9ed4,_0x3aa479=_0x799325[_0x23c5e3(0x11c3)]*_0x799325[_0x23c5e3(0x1182)]+_0xcd3cb7;if(_0x53e9c4<0x0||_0x53e9c4>=_0x799325[_0x23c5e3(0x8c6)][_0x23c5e3(0xa06)])return;const _0x39e6da=_0x799325[_0x23c5e3(0x8c6)][_0x23c5e3(0x1044)](Math[_0x23c5e3(0x24e)](0x0,_0x53e9c4),Math[_0x23c5e3(0x24c)](_0x799325[_0x23c5e3(0x8c6)][_0x23c5e3(0xa06)],_0x3aa479))[_0x23c5e3(0x809)]('\x0a');_0x799325[_0x23c5e3(0xf56)]=_0x39e6da;}function _0x35124d(){const _0x340c40=_0x419fa8,_0x11468c=document['getElementById']('silent-audio-player');if(_0x11468c){const _0x292fb1=_0x11468c['play']();_0x292fb1!==undefined&&_0x292fb1[_0x340c40(0xcd7)](_0x1a2e85=>{const _0x489127=_0x340c40;console[_0x489127(0x283)](_0x489127(0x12f8));})['catch'](_0x14ee60=>{const _0x71388a=_0x340c40;console[_0x71388a(0x453)](_0x71388a(0x29e),_0x14ee60);});}}function _0x4762c1(){const _0x26af17=_0x419fa8,_0x2fd6e7=document[_0x26af17(0x9c8)]('silent-audio-player');_0x2fd6e7&&!_0x2fd6e7[_0x26af17(0x1fa)]&&(_0x2fd6e7[_0x26af17(0x6f2)](),_0x2fd6e7[_0x26af17(0x117d)]=0x0,console['log'](_0x26af17(0xfa6)));}async function _0x278f3f(_0x1c5c20){const _0x1a07c4=_0x419fa8,_0x4b9387=decodeURIComponent(_0x1c5c20['dataset'][_0x1a07c4(0xbb7)]),_0x55db2a=_0x1c5c20[_0x1a07c4(0xc9f)][_0x1a07c4(0x1365)],_0x3960bc=_0x1c5c20[_0x1a07c4(0x91d)](_0x1a07c4(0xdbf)),_0x231e72=_0x1c5c20[_0x1a07c4(0x91d)](_0x1a07c4(0x10fd)),_0x1491a3=document[_0x1a07c4(0x9c8)](_0x1a07c4(0xbcb));if(!_0x1491a3[_0x1a07c4(0x1fa)]&&_0x1491a3[_0x1a07c4(0xc9f)][_0x1a07c4(0x11c5)]===_0x4b9387&&_0x1491a3[_0x1a07c4(0xc9f)][_0x1a07c4(0x3e4)]===_0x55db2a){_0x1491a3['pause']();return;}_0x1491a3[_0x1a07c4(0x6f2)](),document['querySelectorAll'](_0x1a07c4(0xdbf))[_0x1a07c4(0x591)](_0x1fcbe5=>_0x1fcbe5[_0x1a07c4(0xe24)]='▶');const _0x493371=_0x1a07c4(0xefb)+_0x55db2a+'_'+_0x4b9387;let _0xd80638=_0x9ebf46[_0x1a07c4(0xd2f)]['get'](_0x493371);if(_0xd80638){console[_0x1a07c4(0x283)](_0x1a07c4(0x33a)),await _0x3c6516(_0xd80638[_0x1a07c4(0x11be)],_0xd80638['type'],_0x4b9387,_0x55db2a,_0x1c5c20);return;}console[_0x1a07c4(0x283)](_0x1a07c4(0x12cb));if(_0x3960bc)_0x3960bc['style']['display']=_0x1a07c4(0x8f6);_0x231e72['style'][_0x1a07c4(0x3c5)]=_0x1a07c4(0x3d9);const {minimaxGroupId:_0x1deb2,minimaxApiKey:_0x2f3e8a}=_0x9ebf46[_0x1a07c4(0x4de)];if(!_0x1deb2||!_0x2f3e8a){await _0x1bff53('配置错误','请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。'),_0x231e72[_0x1a07c4(0x5e1)][_0x1a07c4(0x3c5)]='none';if(_0x3960bc)_0x3960bc['style'][_0x1a07c4(0x3c5)]=_0x1a07c4(0x989);return;}try{const _0x43fd0e=await fetch('https://api.minimax.chat/v1/text_to_speech?GroupId='+_0x1deb2,{'method':_0x1a07c4(0x116f),'headers':{'Authorization':'Bearer\x20'+_0x2f3e8a,'Content-Type':'application/json'},'body':JSON[_0x1a07c4(0xf1e)]({'text':_0x4b9387,'voice_id':_0x55db2a,'model':_0x9ebf46[_0x1a07c4(0x4de)][_0x1a07c4(0x10f0)]||_0x1a07c4(0x5f9),'speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0x43fd0e['ok']){let _0x343ccb=_0x1a07c4(0x76f)+_0x43fd0e[_0x1a07c4(0xebd)];try{const _0xc27d81=await _0x43fd0e[_0x1a07c4(0x5dd)]();_0x343ccb=_0xc27d81[_0x1a07c4(0x6f5)]?.['status_msg']||JSON[_0x1a07c4(0xf1e)](_0xc27d81);}catch(_0x2b7e25){_0x343ccb=await _0x43fd0e[_0x1a07c4(0xbb7)]();}throw new Error(_0x343ccb);}const _0x36cd92=await _0x43fd0e[_0x1a07c4(0xa6e)](),_0x52ebac=URL['createObjectURL'](_0x36cd92);await _0x3c6516(_0x52ebac,_0x36cd92[_0x1a07c4(0x12d9)],_0x4b9387,_0x55db2a,_0x1c5c20);const _0x4a86d5=new FileReader();_0x4a86d5[_0x1a07c4(0x9b9)]=function(){const _0x400d52=_0x1a07c4;_0x9ebf46[_0x400d52(0xd2f)][_0x400d52(0xe36)](_0x493371,{'url':_0x4a86d5[_0x400d52(0xceb)],'type':_0x36cd92[_0x400d52(0x12d9)]}),console[_0x400d52(0x283)](_0x400d52(0x12e7));},_0x4a86d5['readAsDataURL'](_0x36cd92);}catch(_0x17ad65){console[_0x1a07c4(0x1221)](_0x1a07c4(0x101a),_0x17ad65),await _0x1bff53('语音生成失败',_0x1a07c4(0x320)+_0x17ad65[_0x1a07c4(0x86e)]);}finally{_0x231e72[_0x1a07c4(0x5e1)][_0x1a07c4(0x3c5)]=_0x1a07c4(0x8f6);if(_0x3960bc)_0x3960bc[_0x1a07c4(0x5e1)][_0x1a07c4(0x3c5)]=_0x1a07c4(0x989);}}function _0x3c6516(_0x1a38c8,_0x2ffef6,_0x4144b1,_0x217f3a,_0x1ff161){return new Promise((_0x2dd2e1,_0x190f30)=>{const _0xb410b5=_0x3569,_0x4f2861=document['getElementById']('tts-audio-player');_0x4f2861[_0xb410b5(0xbf4)]=_0x1a38c8,_0x4f2861[_0xb410b5(0x12d9)]=_0x2ffef6,_0x4f2861[_0xb410b5(0xc9f)][_0xb410b5(0x11c5)]=_0x4144b1,_0x4f2861[_0xb410b5(0xc9f)][_0xb410b5(0x3e4)]=_0x217f3a;const _0x4ced0b=_0x4f2861[_0xb410b5(0xcc3)]();_0x4ced0b!==undefined&&_0x4ced0b[_0xb410b5(0xcd7)](()=>{const _0x1f9cd9=_0xb410b5,_0x335ff6=_0x1ff161['querySelector'](_0x1f9cd9(0xdbf));if(_0x335ff6)_0x335ff6[_0x1f9cd9(0xe24)]='❚❚';_0x2dd2e1();})[_0xb410b5(0xd7f)](_0x54ebde=>{const _0x1b588c=_0xb410b5;console[_0x1b588c(0x1221)](_0x1b588c(0xe1d),_0x54ebde),_0x190f30(_0x54ebde);}),_0x4f2861[_0xb410b5(0x4b0)]=()=>{const _0x3f7fd9=_0xb410b5,_0x36395a=_0x1ff161[_0x3f7fd9(0x91d)](_0x3f7fd9(0xdbf));if(_0x36395a)_0x36395a['textContent']='▶';},_0x4f2861[_0xb410b5(0xea1)]=()=>{const _0x436f86=_0xb410b5,_0x49d3cf=_0x1ff161[_0x436f86(0x91d)](_0x436f86(0xdbf));if(_0x49d3cf)_0x49d3cf[_0x436f86(0xe24)]='▶';};});}function _0x21e7a1(_0x130b52){const _0x48aeb8=_0x419fa8,_0x3a480e=_0x130b52[_0x48aeb8(0xaa0)](_0x48aeb8(0xef7));if(!_0x3a480e)return;const _0x322e6a=_0x3a480e[_0x48aeb8(0x91d)](_0x48aeb8(0x925)),_0x10b5f1=decodeURIComponent(_0x130b52[_0x48aeb8(0xc9f)]['text']);_0x322e6a['style'][_0x48aeb8(0x3c5)]===_0x48aeb8(0x3d9)?_0x322e6a[_0x48aeb8(0x5e1)]['display']=_0x48aeb8(0x8f6):(_0x322e6a[_0x48aeb8(0xe24)]=_0x10b5f1,_0x322e6a['style'][_0x48aeb8(0x3c5)]=_0x48aeb8(0x3d9));}async function _0x32e03e(){const _0x2dccdb=_0x419fa8;await _0x2e6e41(),document[_0x2dccdb(0x9c8)](_0x2dccdb(0x7df))['classList'][_0x2dccdb(0x68e)](_0x2dccdb(0xc3f));}async function _0x2e6e41(){const _0x3ecee6=_0x419fa8,_0x42886d=document['getElementById'](_0x3ecee6(0xa0c)),_0x1788c7=await _0x2c5bcf[_0x3ecee6(0xfa8)][_0x3ecee6(0x5ff)]();_0x42886d['innerHTML']='';if(_0x1788c7[_0x3ecee6(0xa06)]===0x0){_0x42886d['innerHTML']=_0x3ecee6(0x814);return;}_0x1788c7['forEach'](_0x30b489=>{const _0x499697=_0x3ecee6,_0x32b564=document[_0x499697(0x28a)](_0x499697(0x11f4));_0x32b564[_0x499697(0x82c)]=_0x499697(0xf68),_0x32b564[_0x499697(0x2f5)]=_0x499697(0x9c4)+_0x30b489['name']+_0x499697(0x488)+_0x30b489['id']+_0x499697(0x598),_0x42886d['appendChild'](_0x32b564);});}async function _0x82059a(){const _0x469b35=_0x419fa8,_0x17e134=document['getElementById']('new-product-category-name-input'),_0xa9db22=_0x17e134[_0x469b35(0x1155)]['trim']();if(!_0xa9db22)return alert('分类名不能为空！');const _0x2ac1a1=await _0x2c5bcf['shoppingCategories'][_0x469b35(0xe78)](_0x469b35(0x609))['equals'](_0xa9db22)[_0x469b35(0x476)]();if(_0x2ac1a1)return alert('分类\x20\x22'+_0xa9db22+_0x469b35(0x9bf));await _0x2c5bcf['shoppingCategories']['add']({'name':_0xa9db22}),_0x17e134[_0x469b35(0x1155)]='',await _0x2e6e41();}async function _0x13fd84(_0x33a2aa){const _0x53b9a3=_0x419fa8,_0x59077a=await _0x352ae9(_0x53b9a3(0x115b),_0x53b9a3(0x4c2),{'confirmButtonClass':_0x53b9a3(0x12bc)});_0x59077a&&(await _0x2c5bcf['shoppingCategories']['delete'](_0x33a2aa),await _0x2c5bcf[_0x53b9a3(0x281)][_0x53b9a3(0xe78)]('categoryId')[_0x53b9a3(0xda9)](_0x33a2aa)['modify']({'categoryId':null}),await _0x2e6e41());}function _0xabc5be(_0x2be29b={}){const _0x58c71d=_0x419fa8,_0x4e15b8=document[_0x58c71d(0x9c8)]('product-variations-container'),_0xf49cf9=document['createElement'](_0x58c71d(0x11f4));return _0xf49cf9[_0x58c71d(0x82c)]=_0x58c71d(0xbd2),_0xf49cf9[_0x58c71d(0x2f5)]=_0x58c71d(0x1262)+(_0x2be29b[_0x58c71d(0x609)]||'')+_0x58c71d(0x22c)+(_0x2be29b['price']||'')+_0x58c71d(0x837)+(_0x2be29b['imageUrl']||_0x58c71d(0x367))+_0x58c71d(0x615),_0xf49cf9['querySelector'](_0x58c71d(0x85c))[_0x58c71d(0xa0f)](_0x58c71d(0xf5c),()=>_0xf49cf9[_0x58c71d(0x30f)]()),_0xf49cf9[_0x58c71d(0x91d)](_0x58c71d(0xa0e))[_0x58c71d(0xa0f)](_0x58c71d(0xf5c),()=>{const _0x1b1c49=_0x58c71d;_0xf49cf9['querySelector'](_0x1b1c49(0x705))[_0x1b1c49(0xf5c)]();}),_0xf49cf9['querySelector']('.variation-image-input')[_0x58c71d(0xa0f)]('change',_0x45940f=>{const _0x2ca2f0=_0x58c71d,_0x345119=_0x45940f[_0x2ca2f0(0x1070)][_0x2ca2f0(0x1216)][0x0];if(_0x345119){const _0x5b5bcc=new FileReader();_0x5b5bcc[_0x2ca2f0(0x429)]=_0x49daa2=>{const _0x575c69=_0x2ca2f0;_0xf49cf9[_0x575c69(0x91d)](_0x575c69(0x11a4))[_0x575c69(0xbf4)]=_0x49daa2['target'][_0x575c69(0xceb)];},_0x5b5bcc['readAsDataURL'](_0x345119);}}),_0x4e15b8[_0x58c71d(0x7b9)](_0xf49cf9),_0xf49cf9;}async function _0x4598e6(_0x46ce0a){const _0xb83cd5=_0x419fa8,_0x54b422=await _0x2c5bcf[_0xb83cd5(0x281)]['get'](_0x46ce0a);if(!_0x54b422||!_0x54b422['variations']||_0x54b422[_0xb83cd5(0x230)][_0xb83cd5(0xa06)]===0x0)return;const _0x494cf6=document[_0xb83cd5(0x9c8)](_0xb83cd5(0xa2a));document[_0xb83cd5(0x9c8)](_0xb83cd5(0x7c5))[_0xb83cd5(0xbf4)]=_0x54b422[_0xb83cd5(0xd5e)],document[_0xb83cd5(0x9c8)](_0xb83cd5(0x506))[_0xb83cd5(0xe24)]=_0x54b422[_0xb83cd5(0x609)];const _0x14c19b=document[_0xb83cd5(0x9c8)](_0xb83cd5(0xb81));_0x14c19b['innerHTML']='',_0x54b422[_0xb83cd5(0x230)]['forEach']((_0x26d7f4,_0x5b5d59)=>{const _0x42fafe=_0xb83cd5,_0xde007e=document[_0x42fafe(0x28a)](_0x42fafe(0x11ce));_0xde007e[_0x42fafe(0x12d9)]=_0x42fafe(0x5e5),_0xde007e[_0x42fafe(0x609)]=_0x42fafe(0x12b2),_0xde007e['id']=_0x42fafe(0x1384)+_0x46ce0a+'-'+_0x5b5d59,_0xde007e[_0x42fafe(0x1155)]=_0x5b5d59,_0xde007e['style'][_0x42fafe(0x3c5)]='none';if(_0x5b5d59===0x0)_0xde007e[_0x42fafe(0x1ec)]=!![];const _0x29c9d6=document[_0x42fafe(0x28a)](_0x42fafe(0x13c5));_0x29c9d6['htmlFor']=_0x42fafe(0x1384)+_0x46ce0a+'-'+_0x5b5d59,_0x29c9d6[_0x42fafe(0xe24)]=_0x26d7f4[_0x42fafe(0x609)],_0x29c9d6['style'][_0x42fafe(0xd09)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x14c19b[_0x42fafe(0x7b9)](_0xde007e),_0x14c19b[_0x42fafe(0x7b9)](_0x29c9d6);});const _0x227dbd=()=>{const _0x136e49=_0xb83cd5,_0x54f438=_0x14c19b['querySelector'](_0x136e49(0x11f0));_0x14c19b['querySelectorAll']('label')['forEach'](_0x45f6a5=>{const _0x23db07=_0x136e49;_0x45f6a5[_0x23db07(0x5e1)]['borderColor']=_0x23db07(0x1b4),_0x45f6a5[_0x23db07(0x5e1)][_0x23db07(0xf84)]=_0x23db07(0x45d),_0x45f6a5['style'][_0x23db07(0x8e2)]=_0x23db07(0x10e3);});if(_0x54f438){const _0x17a2d9=_0x14c19b[_0x136e49(0x91d)](_0x136e49(0x1288)+_0x54f438['id']+'\x22]');_0x17a2d9['style'][_0x136e49(0xbe0)]='var(--accent-color)',_0x17a2d9['style'][_0x136e49(0xf84)]=_0x136e49(0x12c5),_0x17a2d9[_0x136e49(0x5e1)][_0x136e49(0x8e2)]=_0x136e49(0x217);const _0x42ae0d=_0x54b422[_0x136e49(0x230)][parseInt(_0x54f438[_0x136e49(0x1155)])];document['getElementById'](_0x136e49(0x12eb))[_0x136e49(0xe24)]='¥'+_0x42ae0d[_0x136e49(0x3fa)][_0x136e49(0x752)](0x2),_0x42ae0d[_0x136e49(0xd5e)]?document[_0x136e49(0x9c8)](_0x136e49(0x7c5))['src']=_0x42ae0d[_0x136e49(0xd5e)]:document[_0x136e49(0x9c8)](_0x136e49(0x7c5))['src']=_0x54b422[_0x136e49(0xd5e)];}};_0x14c19b[_0xb83cd5(0xa0f)](_0xb83cd5(0x25c),_0x227dbd),_0x227dbd(),document[_0xb83cd5(0x9c8)](_0xb83cd5(0xe7c))[_0xb83cd5(0xe24)]='1';const _0x8dcf68=document[_0xb83cd5(0x9c8)](_0xb83cd5(0x137d)),_0x22fd75=_0x8dcf68['cloneNode'](!![]);_0x8dcf68[_0xb83cd5(0x127d)]['replaceChild'](_0x22fd75,_0x8dcf68),_0x22fd75['addEventListener'](_0xb83cd5(0xf5c),async()=>{const _0x2a7905=_0xb83cd5,_0x29fcdd=_0x14c19b[_0x2a7905(0x91d)](_0x2a7905(0x11f0)),_0x3d42ec=parseInt(document[_0x2a7905(0x9c8)](_0x2a7905(0xe7c))[_0x2a7905(0xe24)]);if(_0x29fcdd){const _0x2e0e6a=_0x54b422[_0x2a7905(0x230)][parseInt(_0x29fcdd[_0x2a7905(0x1155)])];await _0x111b4e(_0x46ce0a,_0x3d42ec,_0x2e0e6a),_0x494cf6[_0x2a7905(0x575)][_0x2a7905(0x30f)]('visible'),await _0x1bff53('成功',_0x2a7905(0xdac));}}),_0x494cf6[_0xb83cd5(0x575)][_0xb83cd5(0x68e)](_0xb83cd5(0xc3f));}function _0x83b4eb(){const _0x58a7c8=_0x419fa8,_0xb21486=document[_0x58a7c8(0x9c8)](_0x58a7c8(0x36e));document[_0x58a7c8(0x9c8)](_0x58a7c8(0x71d))[_0x58a7c8(0x1155)]=_0x9ebf46[_0x58a7c8(0x1383)][_0x58a7c8(0xaec)]||0x3,document[_0x58a7c8(0x9c8)](_0x58a7c8(0x117f))[_0x58a7c8(0x1155)]=_0x9ebf46['globalSettings'][_0x58a7c8(0xcfa)]||0x8,_0xb21486[_0x58a7c8(0x575)][_0x58a7c8(0x68e)](_0x58a7c8(0xc3f));}async function _0x7d103e(){const _0x10c607=_0x419fa8,_0x290eb5=document['getElementById'](_0x10c607(0x71d)),_0x174a51=document[_0x10c607(0x9c8)](_0x10c607(0x117f)),_0x7c0661=parseInt(_0x290eb5[_0x10c607(0x1155)]),_0x48e5cc=parseInt(_0x174a51[_0x10c607(0x1155)]);if(isNaN(_0x7c0661)||isNaN(_0x48e5cc)||_0x7c0661<0x1||_0x48e5cc<0x1){alert(_0x10c607(0x8c4));return;}_0x9ebf46[_0x10c607(0x1383)][_0x10c607(0xaec)]=_0x7c0661,_0x9ebf46[_0x10c607(0x1383)][_0x10c607(0xcfa)]=_0x48e5cc,await _0x2c5bcf[_0x10c607(0x1383)][_0x10c607(0xff5)](_0x9ebf46[_0x10c607(0x1383)]),document[_0x10c607(0x9c8)](_0x10c607(0x36e))['classList']['remove'](_0x10c607(0xc3f)),await _0x1bff53(_0x10c607(0x1324),_0x10c607(0x2da));}async function _0x53a029(){const _0x418489=_0x419fa8;if(!_0x9ebf46[_0x418489(0x970)]){await _0x1bff53('操作失败',_0x418489(0x833));return;}const _0x5ad58a=_0x9ebf46[_0x418489(0x547)][_0x9ebf46[_0x418489(0x970)]],_0x3851fd=await _0x352ae9('为“'+_0x5ad58a[_0x418489(0x609)]+_0x418489(0xb54),_0x418489(0x1193),{'confirmText':_0x418489(0x95c)});if(!_0x3851fd)return;await _0x1bff53('请稍候...','正在根据“'+_0x5ad58a[_0x418489(0x609)]+_0x418489(0x2a7));const _0x1257e8=_0x9ebf46[_0x418489(0x4de)][_0x418489(0x797)]&&_0x9ebf46[_0x418489(0x4de)]['secondaryApiKey']&&_0x9ebf46[_0x418489(0x4de)][_0x418489(0x62f)],{proxyUrl:_0x5090f3,apiKey:_0x17bacc,model:_0x519ed0}=_0x1257e8?{'proxyUrl':_0x9ebf46[_0x418489(0x4de)][_0x418489(0x797)],'apiKey':_0x9ebf46[_0x418489(0x4de)][_0x418489(0xc0c)],'model':_0x9ebf46[_0x418489(0x4de)][_0x418489(0x62f)]}:_0x9ebf46[_0x418489(0x4de)];if(!_0x5090f3||!_0x17bacc||!_0x519ed0){await _0x1bff53('API未配置','请先在API设置中配置好（主或副）API。');return;}const _0x33475f=_0x9ebf46['globalSettings'][_0x418489(0xaec)]||0x3,_0xa33faf=_0x9ebf46[_0x418489(0x1383)][_0x418489(0xcfa)]||0x8,_0x36dd8c=await _0x2c5bcf[_0x418489(0xfa8)][_0x418489(0x5ff)]();let _0x3ef96c='';_0x36dd8c[_0x418489(0xa06)]>0x0&&(_0x3ef96c=_0x418489(0xed3)+_0x36dd8c[_0x418489(0xa3b)](_0x5da75b=>'\x22'+_0x5da75b[_0x418489(0x609)]+'\x22')[_0x418489(0x809)](',\x20')+']\x0a');const _0x5a243a=_0x9ebf46[_0x418489(0x32c)][_0x418489(0x5b7)]||'我',_0x3863ca=_0x5ad58a['longTermMemory']&&_0x5ad58a[_0x418489(0x323)][_0x418489(0xa06)]>0x0?_0x5ad58a['longTermMemory']['map'](_0x5e7684=>_0x418489(0x1dc)+_0x4fcd92(_0x5e7684[_0x418489(0x6b5)])+')\x20'+_0x5e7684[_0x418489(0x53b)])[_0x418489(0x809)]('\x0a'):'无',_0x196174=_0x5ad58a['history'][_0x418489(0x1044)](-0xa)[_0x418489(0xa3b)](_0x5aa871=>(_0x5aa871['role']===_0x418489(0x586)?_0x5a243a:_0x5ad58a['name'])+':\x20'+String(_0x5aa871[_0x418489(0x53b)])['substring'](0x0,0x1e)+_0x418489(0xf66))[_0x418489(0x809)]('\x0a');let _0x22a0ce='';if(_0x5ad58a[_0x418489(0x1131)][_0x418489(0x41a)]&&_0x5ad58a[_0x418489(0x1131)][_0x418489(0x41a)][_0x418489(0xa06)]>0x0){const _0x3cc5ef=_0x5ad58a[_0x418489(0x1131)]['linkedWorldBookIds']['map'](_0xe3ac32=>{const _0x10dcf2=_0x418489,_0x17186b=_0x9ebf46[_0x10dcf2(0x1369)][_0x10dcf2(0xfc3)](_0x142cfa=>_0x142cfa['id']===_0xe3ac32);if(!_0x17186b||!Array[_0x10dcf2(0xb27)](_0x17186b[_0x10dcf2(0x53b)]))return'';const _0x4ae8bd=_0x17186b[_0x10dcf2(0x53b)][_0x10dcf2(0x401)](_0x3b8c0f=>_0x3b8c0f[_0x10dcf2(0x38a)]!==![])['map'](_0x87004d=>'-\x20'+_0x87004d['content'])['join']('\x0a');return _0x4ae8bd?'\x0a##\x20来自《'+_0x17186b['name']+_0x10dcf2(0x195)+_0x4ae8bd:'';})[_0x418489(0x401)](Boolean)[_0x418489(0x809)]('');_0x3cc5ef&&(_0x22a0ce='\x0a#\x20世界观设定\x20(必须参考)\x0a'+_0x3cc5ef+'\x0a');}const _0x231097=_0x418489(0xef3)+_0x5ad58a['name']+_0x418489(0xea8)+_0x33475f+_0x418489(0x46e)+_0xa33faf+_0x418489(0x12f3)+_0x5ad58a[_0x418489(0x609)]+'\x0a-\x20**角色人设**:\x20'+_0x5ad58a['settings'][_0x418489(0xae3)]+_0x418489(0x12d0)+_0x3863ca+_0x418489(0x63f)+_0x22a0ce+'\x0a'+_0x3ef96c+_0x418489(0x43a)+_0x196174+_0x418489(0x962)+_0x5ad58a['name']+_0x418489(0x59a);try{const _0x398f52=[{'role':_0x418489(0x586),'content':_0x418489(0x5be)}];let _0x2921a7=_0x5090f3[_0x418489(0x930)](_0x418489(0xb23)),_0x1f604a=_0x2e5c04(_0x519ed0,_0x17bacc,_0x231097,_0x398f52);const _0xc69cdc=_0x2921a7?await fetch(_0x1f604a[_0x418489(0x11be)],_0x1f604a['data']):await fetch(_0x5090f3+_0x418489(0x1090),{'method':_0x418489(0x116f),'headers':{'Content-Type':_0x418489(0x698),'Authorization':_0x418489(0x84a)+_0x17bacc},'body':JSON[_0x418489(0xf1e)]({'model':_0x519ed0,'messages':[{'role':_0x418489(0xb64),'content':_0x231097},..._0x398f52],'temperature':_0x9ebf46[_0x418489(0x1383)]['apiTemperature']||0.9})});if(!_0xc69cdc['ok'])throw new Error(_0x418489(0x8ab)+_0xc69cdc['statusText']);const _0x33ef67=await _0xc69cdc['json'](),_0x154964=getGeminiResponseText(_0x33ef67),_0x310d2a=_0x154964['match'](/({[\s\S]*})/);if(!_0x310d2a)throw new Error('AI返回的内容中未找到有效的JSON对象。');const _0xde846d=JSON[_0x418489(0x907)](_0x310d2a[0x0]);if(!_0xde846d[_0x418489(0xf44)]||!Array[_0x418489(0xb27)](_0xde846d[_0x418489(0xf44)]))throw new Error(_0x418489(0xd83));await _0x2c5bcf[_0x418489(0xa88)]('rw',_0x2c5bcf['shoppingProducts'],_0x2c5bcf[_0x418489(0xfa8)],async()=>{const _0x43a76=_0x418489;for(const _0x28fe69 of _0xde846d['categories']){let _0x421eb3;const _0x71d108=await _0x2c5bcf[_0x43a76(0xfa8)]['where'](_0x43a76(0x609))[_0x43a76(0x1028)](_0x28fe69[_0x43a76(0x609)])[_0x43a76(0x476)]();_0x71d108?_0x421eb3=_0x71d108['id']:_0x421eb3=await _0x2c5bcf['shoppingCategories']['add']({'name':_0x28fe69[_0x43a76(0x609)]});const _0x1a4473=_0x28fe69[_0x43a76(0x4b4)][_0x43a76(0xa3b)](_0x34ffef=>{const _0x4a364d=_0x43a76;return{'name':_0x34ffef['name'],'price':_0x34ffef[_0x4a364d(0x3fa)]||0x0,'description':_0x34ffef[_0x4a364d(0x1387)]||'','imageUrl':'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x34ffef[_0x4a364d(0xd73)]),'variations':(_0x34ffef[_0x4a364d(0x230)]||[])['map'](_0x4ab7c7=>({..._0x4ab7c7,'imageUrl':'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x4ab7c7[_0x4a364d(0xd73)])})),'categoryId':_0x421eb3};});_0x1a4473['length']>0x0&&await _0x2c5bcf[_0x43a76(0x281)][_0x43a76(0x115e)](_0x1a4473);}}),activeShoppingCategoryId='all',await _0x3fe79f(),await _0x1bff53(_0x418489(0xadd),'为“'+_0x5ad58a[_0x418489(0x609)]+_0x418489(0xb2f));}catch(_0x2105c7){console[_0x418489(0x1221)](_0x418489(0xdd7),_0x2105c7),await _0x1bff53(_0x418489(0xf8d),_0x418489(0xfc5)+_0x2105c7[_0x418489(0x86e)]);}}async function _0x393677(_0x16a87f){const _0xfdef97=_0x419fa8,_0x1d2a56=document[_0xfdef97(0x9c8)](_0x16a87f);if(!_0x1d2a56)return;const _0x31de46=await _0xb8c832(_0xfdef97(0xb58),[{'text':'📁\x20从本地上传','value':_0xfdef97(0xc89)},{'text':'🌐\x20使用网络URL','value':_0xfdef97(0x11be)}]);let _0x51f044=null;if(_0x31de46===_0xfdef97(0xc89))_0x51f044=await _0x750485();else _0x31de46==='url'&&(_0x51f044=await _0xadb5df(_0xfdef97(0xb58),_0xfdef97(0x12e6),_0x1d2a56[_0xfdef97(0xbf4)],_0xfdef97(0x11be)));if(_0x51f044&&_0x51f044[_0xfdef97(0x3f1)]()){const _0x1629c2=_0x51f044[_0xfdef97(0x3f1)]();_0x1d2a56[_0xfdef97(0xbf4)]=_0x1629c2,!_0x9ebf46[_0xfdef97(0x1383)][_0xfdef97(0xa5e)]&&(_0x9ebf46[_0xfdef97(0x1383)][_0xfdef97(0xa5e)]={}),_0x9ebf46[_0xfdef97(0x1383)][_0xfdef97(0xa5e)][_0x16a87f]=_0x1629c2,await _0x2c5bcf[_0xfdef97(0x1383)][_0xfdef97(0xff5)](_0x9ebf46[_0xfdef97(0x1383)]),await _0x1bff53('成功',_0xfdef97(0x570));}}window[_0x419fa8(0x59c)]=_0x393677;async function _0x4a0468(){const _0xb9e363=_0x419fa8;if(!window[_0xb9e363(0x535)]){alert(_0xb9e363(0x8e3));return;}await _0x1bff53(_0xb9e363(0x6fc),_0xb9e363(0x875));const _0x2fc4cd=streamSaver[_0xb9e363(0x855)](_0xb9e363(0x10ce)+new Date()[_0xb9e363(0x3d5)]()[_0xb9e363(0x6c6)]('T')[0x0]+_0xb9e363(0x11d4)),_0x3fe65d=_0x2fc4cd[_0xb9e363(0xe28)](),_0xb6e136=new TextEncoder();try{await _0x3fe65d[_0xb9e363(0x28f)](_0xb6e136['encode']('{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20'+Date['now']()+_0xb9e363(0xfc7)));const _0x1263d3=await _0x2c5bcf[_0xb9e363(0xe42)][_0xb9e363(0xa3b)](_0x2fd6ad=>_0x2fd6ad[_0xb9e363(0x609)]);for(let _0x1f147e=0x0;_0x1f147e<_0x1263d3[_0xb9e363(0xa06)];_0x1f147e++){const _0x4f7ba5=_0x1263d3[_0x1f147e],_0x3089ab=_0x2c5bcf['table'](_0x4f7ba5);await _0x3fe65d[_0xb9e363(0x28f)](_0xb6e136[_0xb9e363(0x107e)]('\x22'+_0x4f7ba5+_0xb9e363(0xdca)));let _0x101e7f=!![];await _0x3089ab[_0xb9e363(0x1075)](_0x189f1e=>{const _0xae82a0=_0xb9e363;!_0x101e7f&&_0x3fe65d['write'](_0xb6e136[_0xae82a0(0x107e)](',\x0a')),_0x3fe65d[_0xae82a0(0x28f)](_0xb6e136[_0xae82a0(0x107e)](JSON[_0xae82a0(0xf1e)](_0x189f1e))),_0x101e7f=![];}),await _0x3fe65d['write'](_0xb6e136[_0xb9e363(0x107e)]('\x0a]')),_0x1f147e<_0x1263d3[_0xb9e363(0xa06)]-0x1&&await _0x3fe65d['write'](_0xb6e136[_0xb9e363(0x107e)](',\x0a'));}await _0x3fe65d[_0xb9e363(0x28f)](_0xb6e136[_0xb9e363(0x107e)](_0xb9e363(0x90c)));}catch(_0x3c2b77){console[_0xb9e363(0x1221)](_0xb9e363(0x132b),_0x3c2b77),await _0x1bff53(_0xb9e363(0xcd1),_0xb9e363(0x77d)+_0x3c2b77['message']);}finally{await _0x3fe65d[_0xb9e363(0x363)]();}}async function _0x190631(){const _0x212d22=_0x419fa8;await _0x1bff53(_0x212d22(0x6fc),_0x212d22(0x11c9));try{const _0x5577ff={'version':0x3,'timestamp':Date[_0x212d22(0x9b7)](),'data':{}},_0x58474a=_0x2c5bcf['tables'][_0x212d22(0xa3b)](_0x4e7324=>_0x4e7324['name']);for(const _0x2a4322 of _0x58474a){const _0x32e638=await _0x2c5bcf[_0x212d22(0x11de)](_0x2a4322)['toArray']();_0x5577ff[_0x212d22(0x100d)][_0x2a4322]=_0x32e638,console[_0x212d22(0x283)](_0x212d22(0xa77)+_0x2a4322+',\x20记录数:\x20'+_0x32e638[_0x212d22(0xa06)]);}const _0x8b3e61=new Blob([JSON[_0x212d22(0xf1e)](_0x5577ff,null,0x2)],{'type':'application/json'}),_0x5ca700=URL['createObjectURL'](_0x8b3e61),_0xb2b9c7=document[_0x212d22(0x28a)]('a');_0xb2b9c7[_0x212d22(0xc4a)]=_0x5ca700,_0xb2b9c7[_0x212d22(0x6a4)]=_0x212d22(0xefa)+new Date()['toISOString']()['split']('T')[0x0]+_0x212d22(0x11d4),_0xb2b9c7[_0x212d22(0xf5c)](),URL[_0x212d22(0x1268)](_0x5ca700),await _0x1bff53(_0x212d22(0x418),_0x212d22(0x573));}catch(_0x80c4fa){console['error'](_0x212d22(0x126b),_0x80c4fa),await _0x1bff53(_0x212d22(0xcd1),_0x212d22(0x58c)+_0x80c4fa[_0x212d22(0x86e)]);}}function _0x159e72(){const _0x445786=_0x419fa8,_0x2e6e0e=Object[_0x445786(0xeb2)](_0x9ebf46['chats'])[_0x445786(0x12c1)]((_0x1c0a44,_0xe10ead)=>{const _0x12e9cd=_0x445786;if(_0xe10ead['id']===_0x9ebf46[_0x12e9cd(0x970)])return _0x1c0a44;return _0x1c0a44+(_0xe10ead[_0x12e9cd(0x382)]||0x0);},0x0),_0x1c4cc6=_0x776068||0x0,_0x4748a2=_0x2e6e0e+_0x1c4cc6,_0x188ac2=document['getElementById']('back-to-list-btn');if(!_0x188ac2)return;let _0x42e598=_0x188ac2['querySelector'](_0x445786(0x34a));!_0x42e598&&(_0x42e598=document[_0x445786(0x28a)](_0x445786(0xf1c)),_0x42e598[_0x445786(0x82c)]='unread-indicator',_0x188ac2[_0x445786(0x7b9)](_0x42e598));let _0x18cd98=_0x188ac2['querySelector'](_0x445786(0x13c7));_0x18cd98&&_0x18cd98[_0x445786(0x30f)](),_0x4748a2>0x0?(_0x42e598[_0x445786(0xe24)]=_0x4748a2>0x63?_0x445786(0x4eb):_0x4748a2,_0x42e598[_0x445786(0x5e1)][_0x445786(0x3c5)]=_0x445786(0x3d9),_0x42e598[_0x445786(0x5e1)][_0x445786(0x3da)]='20',_0x42e598[_0x445786(0x5e1)]['transform']='scale(0.8)'):_0x42e598[_0x445786(0x5e1)]['display']='none';}async function _0x3ff953(_0x3fbf71){const _0x3b2402=_0x419fa8,_0x54991f=_0x3fbf71===_0x3b2402(0x247)?{'id':_0x3b2402(0x247),'name':_0x3b2402(0x6ea)}:await _0x2c5bcf[_0x3b2402(0x1342)]['get'](_0x3fbf71);if(!_0x54991f){console['error'](_0x3b2402(0x2fc),_0x3fbf71);return;}const _0x38dee1=document[_0x3b2402(0x9c8)](_0x3b2402(0x1091)),_0x3c1865=document[_0x3b2402(0x9c8)]('sticker-binding-chat-list'),_0x319353=_0x38dee1[_0x3b2402(0x91d)]('.modal-header\x20span');_0x3c1865[_0x3b2402(0x2f5)]='',_0x319353[_0x3b2402(0xe24)]=_0x3b2402(0xe7f)+_0x54991f[_0x3b2402(0x609)]+_0x3b2402(0x54f);const _0x39ec26=Object[_0x3b2402(0xeb2)](_0x9ebf46[_0x3b2402(0x547)])[_0x3b2402(0x66b)]((_0x1e1c92,_0x416606)=>_0x1e1c92['name'][_0x3b2402(0x11d2)](_0x416606['name'],'zh-CN'));_0x39ec26[_0x3b2402(0x591)](_0x174438=>{const _0x253e70=_0x3b2402,_0x52abb5=Array[_0x253e70(0xb27)](_0x174438['settings']?.['stickerCategoryIds'])&&_0x174438[_0x253e70(0x1131)][_0x253e70(0x239)][_0x253e70(0x930)](_0x3fbf71),_0x46f6e9=document[_0x253e70(0x28a)](_0x253e70(0x11f4));_0x46f6e9[_0x253e70(0x82c)]=_0x253e70(0xd75),_0x46f6e9['innerHTML']=_0x253e70(0xf78)+_0x174438['id']+'\x22\x20'+(_0x52abb5?_0x253e70(0x1ec):'')+'\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x174438[_0x253e70(0x11e4)]?_0x174438[_0x253e70(0x1131)][_0x253e70(0xa79)]:_0x174438['settings']['aiAvatar']||_0x246753)+_0x253e70(0x131a)+_0x174438[_0x253e70(0x609)]+_0x253e70(0x215),_0x3c1865['appendChild'](_0x46f6e9);}),document[_0x3b2402(0x9c8)](_0x3b2402(0x335))['onclick']=()=>_0x335272(_0x3fbf71),document[_0x3b2402(0x9c8)]('cancel-sticker-binding-btn')[_0x3b2402(0x2fa)]=()=>_0x38dee1[_0x3b2402(0x575)][_0x3b2402(0x30f)](_0x3b2402(0xc3f)),_0x38dee1['classList'][_0x3b2402(0x68e)](_0x3b2402(0xc3f));}async function _0x335272(_0x234a74){const _0x379e81=_0x419fa8,_0x500415=new Set(Array[_0x379e81(0x13a5)](document['querySelectorAll']('#sticker-binding-chat-list\x20.sticker-binding-checkbox:checked'))['map'](_0x2c8594=>_0x2c8594['dataset'][_0x379e81(0x54d)])),_0x3ca83d=[];for(const _0x180d0e in _0x9ebf46[_0x379e81(0x547)]){const _0x2e0a82=_0x9ebf46[_0x379e81(0x547)][_0x180d0e];!Array[_0x379e81(0xb27)](_0x2e0a82['settings'][_0x379e81(0x239)])&&(_0x2e0a82[_0x379e81(0x1131)]['stickerCategoryIds']=[]);const _0xf8e769=_0x2e0a82['settings']['stickerCategoryIds'][_0x379e81(0x930)](_0x234a74),_0x50e581=_0x500415[_0x379e81(0xd97)](_0x180d0e);if(_0xf8e769&&!_0x50e581)_0x2e0a82[_0x379e81(0x1131)][_0x379e81(0x239)]=_0x2e0a82[_0x379e81(0x1131)]['stickerCategoryIds'][_0x379e81(0x401)](_0x6dc038=>_0x6dc038!==_0x234a74),_0x3ca83d[_0x379e81(0x668)](_0x2e0a82);else!_0xf8e769&&_0x50e581&&(_0x2e0a82[_0x379e81(0x1131)][_0x379e81(0x239)]['push'](_0x234a74),_0x3ca83d[_0x379e81(0x668)](_0x2e0a82));}_0x3ca83d['length']>0x0&&(await _0x2c5bcf[_0x379e81(0x547)][_0x379e81(0x1113)](_0x3ca83d),await _0x1bff53(_0x379e81(0x1324),_0x379e81(0xbda))),document[_0x379e81(0x9c8)](_0x379e81(0x1091))['classList'][_0x379e81(0x30f)](_0x379e81(0xc3f));}function _0x389fa5(_0x4c192c){const _0x52966d=_0x419fa8;if(!_0x4c192c||!_0x4c192c['settings'][_0x52966d(0x239)]||_0x4c192c[_0x52966d(0x1131)][_0x52966d(0x239)][_0x52966d(0xa06)]===0x0)return'';const _0x45d1f6=_0x4c192c['settings'][_0x52966d(0x239)];let _0x185ad7=[];const _0x2a5e37=new Set();_0x45d1f6[_0x52966d(0x591)](_0x3a6cfd=>{const _0x6e3635=_0x52966d;let _0x3c65aa;_0x3a6cfd===_0x6e3635(0x247)?_0x3c65aa=_0x9ebf46[_0x6e3635(0x774)][_0x6e3635(0x401)](_0x201fb0=>!_0x201fb0[_0x6e3635(0x408)]):_0x3c65aa=_0x9ebf46['userStickers']['filter'](_0x6577bf=>_0x6577bf[_0x6e3635(0x408)]===_0x3a6cfd),_0x3c65aa[_0x6e3635(0x591)](_0x2ed4b2=>{const _0x3e6d1f=_0x6e3635;!_0x2a5e37[_0x3e6d1f(0xd97)](_0x2ed4b2[_0x3e6d1f(0x609)])&&(_0x185ad7[_0x3e6d1f(0x668)](_0x2ed4b2),_0x2a5e37['add'](_0x2ed4b2[_0x3e6d1f(0x609)]));});});if(_0x185ad7[_0x52966d(0xa06)]===0x0)return'';const _0x779da7=_0x185ad7['map'](_0x8c6a2=>'-\x20'+_0x8c6a2[_0x52966d(0x609)])[_0x52966d(0x809)]('\x0a');return _0x52966d(0x720)+_0x779da7+'\x0a';}function _0xe373a(_0x29a160){const _0x376ecf=_0x419fa8;if(!_0x29a160||!_0x29a160[_0x376ecf(0x11e4)])return'';let _0xaa0c7f=_0x376ecf(0x711),_0xc89ada=![];return _0x29a160[_0x376ecf(0xd3e)][_0x376ecf(0x591)](_0x26d34b=>{const _0x416ee5=_0x376ecf;if(_0x26d34b['id']===_0x416ee5(0x586))return;const _0x723282=_0x9ebf46['chats'][_0x26d34b['id']];if(_0x723282&&_0x723282['settings'][_0x416ee5(0x239)]&&_0x723282[_0x416ee5(0x1131)][_0x416ee5(0x239)][_0x416ee5(0xa06)]>0x0){const _0x3e5581=_0x723282[_0x416ee5(0x1131)]['stickerCategoryIds'];let _0x5e2d7c=[];const _0x294e28=new Set();_0x3e5581[_0x416ee5(0x591)](_0x54c1ea=>{const _0x454443=_0x416ee5;let _0x30b0c5;_0x54c1ea===_0x454443(0x247)?_0x30b0c5=_0x9ebf46[_0x454443(0x774)][_0x454443(0x401)](_0x365810=>!_0x365810[_0x454443(0x408)]):_0x30b0c5=_0x9ebf46[_0x454443(0x774)][_0x454443(0x401)](_0x125474=>_0x125474[_0x454443(0x408)]===_0x54c1ea),_0x30b0c5['forEach'](_0x4194ab=>{const _0x5f37eb=_0x454443;!_0x294e28[_0x5f37eb(0xd97)](_0x4194ab[_0x5f37eb(0x609)])&&(_0x5e2d7c[_0x5f37eb(0x668)](_0x4194ab),_0x294e28[_0x5f37eb(0x68e)](_0x4194ab[_0x5f37eb(0x609)]));});}),_0x5e2d7c[_0x416ee5(0xa06)]>0x0&&(_0xc89ada=!![],_0xaa0c7f+=_0x416ee5(0x890)+_0x26d34b['groupNickname']+_0x416ee5(0xdcc)+_0x26d34b['originalName']+_0x416ee5(0xf69),_0xaa0c7f+=_0x5e2d7c[_0x416ee5(0xa3b)](_0x5cb693=>'-\x20'+_0x5cb693['name'])[_0x416ee5(0x809)]('\x0a'));}}),_0xc89ada?_0xaa0c7f:'';}function _0x15d37e(_0x162105){const _0x1d2320=_0x419fa8;if(!_0x162105)return 0x0;return Math[_0x1d2320(0x1f1)](_0x162105[_0x1d2320(0xa06)]/1.5);}async function _0x1932aa(){const _0x171ad9=_0x419fa8;if(!_0x9ebf46[_0x171ad9(0x970)])return 0x0;const _0x3f8da5=_0x9ebf46[_0x171ad9(0x547)][_0x9ebf46[_0x171ad9(0x970)]];if(!_0x3f8da5)return 0x0;const _0x2564f5=parseInt(document[_0x171ad9(0x9c8)]('max-memory')['value'])||0xa,_0x3303fc=parseInt(document[_0x171ad9(0x9c8)](_0x171ad9(0xdb1))['value'])||0xa,_0x10fdfa=document[_0x171ad9(0x9c8)]('offline-mode-toggle')[_0x171ad9(0x1ec)],_0x545fab=document[_0x171ad9(0x9c8)](_0x171ad9(0x72a))[_0x171ad9(0x1155)],_0x1b7608=document[_0x171ad9(0x9c8)]('my-persona')['value'];let _0xfeed5c='';const _0x4ec0cf=Array[_0x171ad9(0x13a5)](document[_0x171ad9(0x7e4)]('#world-book-checkboxes-container\x20input:checked'))[_0x171ad9(0xa3b)](_0x1e22d8=>_0x1e22d8[_0x171ad9(0x1155)][_0x171ad9(0x459)](_0x171ad9(0x8de),''));if(_0x4ec0cf[_0x171ad9(0xa06)]>0x0){const _0x28bfa6=_0x4ec0cf[_0x171ad9(0xa3b)](_0x584cf3=>{const _0x1a8819=_0x171ad9,_0x35781d=_0x9ebf46['worldBooks'][_0x1a8819(0xfc3)](_0x420912=>_0x420912['id']===_0x584cf3);if(!_0x35781d||!Array[_0x1a8819(0xb27)](_0x35781d[_0x1a8819(0x53b)]))return'';return _0x35781d['content'][_0x1a8819(0x401)](_0x584ec9=>_0x584ec9[_0x1a8819(0x38a)]!==![])[_0x1a8819(0xa3b)](_0x187b19=>_0x187b19['content'])[_0x1a8819(0x809)]('\x0a');})[_0x171ad9(0x401)](Boolean)['join']('\x0a');_0xfeed5c+=_0x28bfa6;}_0x3f8da5[_0x171ad9(0x323)]&&_0x3f8da5[_0x171ad9(0x323)][_0x171ad9(0xa06)]>0x0&&(_0xfeed5c+=_0x3f8da5[_0x171ad9(0x323)][_0x171ad9(0xa3b)](_0x17855e=>_0x17855e['content'])[_0x171ad9(0x809)]('\x0a'));const _0x337782=document[_0x171ad9(0x9c8)]('link-memory-toggle')[_0x171ad9(0x1ec)];if(_0x337782){const _0xae0233=Array[_0x171ad9(0x13a5)](document['querySelectorAll'](_0x171ad9(0x1320)))[_0x171ad9(0xa3b)](_0xeebe6d=>_0xeebe6d[_0x171ad9(0x1155)]);for(const _0x3c7fbd of _0xae0233){const _0xcb4afd=_0x9ebf46[_0x171ad9(0x547)][_0x3c7fbd];_0xcb4afd&&_0xcb4afd[_0x171ad9(0x8b3)][_0x171ad9(0xa06)]>0x0&&(_0xfeed5c+=_0xcb4afd[_0x171ad9(0x8b3)][_0x171ad9(0x1044)](-_0x3303fc)[_0x171ad9(0xa3b)](_0x59abe0=>String(_0x59abe0[_0x171ad9(0x53b)]))[_0x171ad9(0x809)]('\x0a'));}}_0x3f8da5[_0x171ad9(0x11e4)]?_0x3f8da5[_0x171ad9(0xd3e)][_0x171ad9(0x591)](_0x32be6a=>{const _0x383e54=_0x171ad9;_0xfeed5c+=_0x32be6a[_0x383e54(0xeb1)];}):_0xfeed5c+=_0x545fab;_0xfeed5c+=_0x1b7608,_0xfeed5c+=_0x389fa5(_0x3f8da5);_0x3f8da5['isGroup']&&(_0xfeed5c+=_0xe373a(_0x3f8da5));if(!_0x3f8da5[_0x171ad9(0x11e4)]&&_0x10fdfa){const _0x362f4b=document['getElementById'](_0x171ad9(0x4e6))[_0x171ad9(0x1155)];if(_0x362f4b){const _0x3d6e29=_0x9ebf46[_0x171ad9(0x10ef)][_0x171ad9(0xfc3)](_0x37b53b=>_0x37b53b['id']===_0x362f4b);_0x3d6e29&&(_0xfeed5c+=_0x3d6e29['content'][_0x171ad9(0xa3b)](_0x43c60a=>_0x43c60a[_0x171ad9(0x53b)])['join']('\x0a'));}}const _0x3e0736=_0x3f8da5[_0x171ad9(0x8b3)][_0x171ad9(0x1044)](-_0x2564f5);return _0xfeed5c+=_0x3e0736[_0x171ad9(0xa3b)](_0xec44dc=>{const _0x360cb6=_0x171ad9;if(typeof _0xec44dc[_0x360cb6(0x53b)]===_0x360cb6(0xe56))return _0xec44dc[_0x360cb6(0x53b)];if(Array['isArray'](_0xec44dc['content']))return _0xec44dc['content'][_0x360cb6(0xa3b)](_0x4ea18f=>_0x4ea18f[_0x360cb6(0xbb7)])[_0x360cb6(0x809)]('\x20');return'';})[_0x171ad9(0x809)]('\x0a'),_0x15d37e(_0xfeed5c);}const _0x3cf16e=_0x3b23c3(async()=>{const _0x528dff=_0x419fa8,_0x1e0030=document[_0x528dff(0x9c8)](_0x528dff(0xd24));if(!_0x1e0030)return;_0x1e0030['innerHTML']=_0x528dff(0x98d);try{const _0x4d0234=await _0x1932aa();_0x1e0030[_0x528dff(0x2f5)]=_0x528dff(0x1f7)+_0x4d0234+'</strong>\x20Tokens</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}catch(_0x24bd41){console['error'](_0x528dff(0x4ed),_0x24bd41),_0x1e0030[_0x528dff(0x2f5)]=_0x528dff(0x8f8);}},0x12c);async function _0xa25f02(){const _0x4aca80=_0x419fa8;async function _0x4a4dfd(_0x6951b9){const _0x260d27=_0x3569;if(!_0x6951b9)return;try{const _0x63bff1=await _0x6951b9['text'](),_0x4a3d6b=JSON['parse'](_0x63bff1);if(_0x4a3d6b[_0x260d27(0x12d9)]===_0x260d27(0xaab))console[_0x260d27(0x283)](_0x260d27(0x471)),await _0x2c5afb(_0x4a3d6b);else{if(_0x4a3d6b[_0x260d27(0x1231)]&&typeof _0x4a3d6b[_0x260d27(0x1231)]===_0x260d27(0xc24))console[_0x260d27(0x283)](_0x260d27(0x718)),await _0x2db727(_0x4a3d6b,_0x6951b9['name']);else throw new Error(_0x260d27(0x124e));}}catch(_0x354e66){console[_0x260d27(0x1221)](_0x260d27(0xd08),_0x354e66),await _0x1bff53(_0x260d27(0x685),'文件解析或应用失败:\x20'+_0x354e66[_0x260d27(0x86e)]);}}async function _0x2db727(_0x4dca1a,_0x206e8a){const _0x38563a=_0x3569,_0x4390e4=_0x206e8a['replace'](/\.json$/i,''),_0x1cf01b=await _0xadb5df('导入\x20Tavern\x20AI\x20世界书',_0x38563a(0x10d0),_0x4390e4);if(!_0x1cf01b||!_0x1cf01b[_0x38563a(0x3f1)]()){alert('导入已取消，因为未提供书名。');return;}const _0x384208=Object[_0x38563a(0xeb2)](_0x4dca1a[_0x38563a(0x1231)])['map'](_0x3ada16=>{const _0x521067=_0x38563a;return{'keys':_0x3ada16[_0x521067(0x7e5)]||[],'comment':_0x3ada16[_0x521067(0x10de)]||_0x521067(0xf27),'content':_0x3ada16[_0x521067(0x53b)]||'','enabled':!_0x3ada16['disable']};})['filter'](_0x1b1681=>_0x1b1681[_0x38563a(0x53b)]);if(_0x384208[_0x38563a(0xa06)]===0x0){alert(_0x38563a(0x2fe));return;}const _0x243ca9={'id':'wb_'+Date['now'](),'name':_0x1cf01b[_0x38563a(0x3f1)](),'content':_0x384208,'categoryId':null};await _0x2c5bcf[_0x38563a(0x1369)][_0x38563a(0x68e)](_0x243ca9),_0x9ebf46[_0x38563a(0x1369)]['push'](_0x243ca9),await _0x3ce340(),await _0x1bff53(_0x38563a(0x858),'已成功从\x20Tavern\x20AI\x20文件导入设定集《'+_0x1cf01b+'》。');}async function _0x2dd07f(){const _0x4a247b=_0x3569;try{const _0x448900=await _0x2c5bcf[_0x4a247b(0x1369)]['toArray'](),_0x34b129=await _0x2c5bcf[_0x4a247b(0x58a)][_0x4a247b(0x5ff)]();if(_0x448900[_0x4a247b(0xa06)]===0x0&&_0x34b129[_0x4a247b(0xa06)]===0x0){alert(_0x4a247b(0x99c));return;}const _0x1eb1d0={'type':_0x4a247b(0xaab),'version':0x1,'timestamp':Date[_0x4a247b(0x9b7)](),'books':_0x448900,'categories':_0x34b129},_0x1c8af8=new Blob([JSON[_0x4a247b(0xf1e)](_0x1eb1d0,null,0x2)],{'type':_0x4a247b(0x698)}),_0x3f9fad=URL[_0x4a247b(0x5bb)](_0x1c8af8),_0x520e9d=document[_0x4a247b(0x28a)]('a');_0x520e9d['href']=_0x3f9fad,_0x520e9d[_0x4a247b(0x6a4)]=_0x4a247b(0x9ed)+new Date()[_0x4a247b(0x3d5)]()[_0x4a247b(0x6c6)]('T')[0x0]+'.json',_0x520e9d[_0x4a247b(0xf5c)](),URL[_0x4a247b(0x1268)](_0x3f9fad),await _0x1bff53(_0x4a247b(0x418),'所有世界书数据已成功导出！');}catch(_0x550b0b){console[_0x4a247b(0x1221)](_0x4a247b(0x1e2),_0x550b0b),await _0x1bff53(_0x4a247b(0xcd1),_0x4a247b(0x58c)+_0x550b0b[_0x4a247b(0x86e)]);}}async function _0x2c5afb(_0x5e0b50){const _0x40a7d6=_0x3569;try{if(_0x5e0b50[_0x40a7d6(0x12d9)]!==_0x40a7d6(0xaab)||!_0x5e0b50[_0x40a7d6(0x102f)])throw new Error(_0x40a7d6(0xb70));const _0x206401=await _0x352ae9('导入世界书','这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！',{'confirmButtonClass':_0x40a7d6(0x12bc),'confirmText':_0x40a7d6(0xde2)});if(!_0x206401)return;await _0x2c5bcf['transaction']('rw',_0x2c5bcf[_0x40a7d6(0x1369)],_0x2c5bcf[_0x40a7d6(0x58a)],async()=>{const _0x446967=_0x40a7d6;await _0x2c5bcf['worldBooks']['clear'](),await _0x2c5bcf[_0x446967(0x58a)][_0x446967(0xdae)](),Array[_0x446967(0xb27)](_0x5e0b50[_0x446967(0x102f)])&&await _0x2c5bcf[_0x446967(0x1369)][_0x446967(0x1113)](_0x5e0b50['books']),Array[_0x446967(0xb27)](_0x5e0b50[_0x446967(0xf44)])&&await _0x2c5bcf[_0x446967(0x58a)][_0x446967(0x1113)](_0x5e0b50[_0x446967(0xf44)]);}),_0x9ebf46['worldBooks']=await _0x2c5bcf['worldBooks'][_0x40a7d6(0x5ff)](),await _0x3ce340(),await _0x1bff53(_0x40a7d6(0x135e),_0x40a7d6(0x2f2));}catch(_0x2cfc0a){console['error'](_0x40a7d6(0xd08),_0x2cfc0a),await _0x1bff53(_0x40a7d6(0x685),_0x40a7d6(0x3a2)+_0x2cfc0a[_0x40a7d6(0x86e)]);}}const _0xda1497=localStorage[_0x4aca80(0x1290)]('ephoneLastActiveTimestamp');if(_0xda1497){const _0x53a452=(Date['now']()-parseInt(_0xda1497))/(0x3e8*0x3c);_0x53a452>0x5&&_0x206959(_0x53a452);}_0x43c581(),window[_0x4aca80(0x6bc)]=_0xe5834e,window['openRenderingRulesScreen']=_0x56a612,window[_0x4aca80(0x2e9)]=_0x1c3fee,window[_0x4aca80(0xbc4)]=_0x541ea4,window[_0x4aca80(0xfc2)]=_0x188817,window['switchToMyPhone']=_0x4dc5ba,window[_0x4aca80(0x3b7)]=_0x1e2733,window[_0x4aca80(0x1235)]=_0x13338d,window[_0x4aca80(0x12c9)]=_0x2e413a;const _0x3f6988=document[_0x4aca80(0x28a)](_0x4aca80(0x11f4));_0x3f6988['id']='sticker-action-bar',_0x3f6988[_0x4aca80(0x2f5)]=_0x4aca80(0xf7c),document[_0x4aca80(0x9c8)](_0x4aca80(0x946))[_0x4aca80(0x7b9)](_0x3f6988);const _0xc8f607=document[_0x4aca80(0x28a)]('style');_0xc8f607['id']='global-custom-style',document['head'][_0x4aca80(0x7b9)](_0xc8f607),_0x15329b[_0x4aca80(0x1280)]=document[_0x4aca80(0x9c8)](_0x4aca80(0x52b)),_0x15329b['gridEl']=document[_0x4aca80(0x9c8)](_0x4aca80(0x6a2));const _0x36b404=localStorage[_0x4aca80(0x1290)](_0x4aca80(0x864))||_0x4aca80(0xfa2);_0x5adfc0(_0x36b404);const _0x578df2=document['createElement']('style');_0x578df2['id']=_0x4aca80(0x8fe),document['head'][_0x4aca80(0x7b9)](_0x578df2);const _0x5ed278=document['createElement']('style');_0x5ed278['id']=_0x4aca80(0x793),document['head'][_0x4aca80(0x7b9)](_0x5ed278),_0x144843('',_0x4aca80(0xcd6),_0x4aca80(0x8fe)),_0x144843('',_0x4aca80(0x1208),_0x4aca80(0x793)),window[_0x4aca80(0x284)]=_0x56a612,window['showScreen']=_0xe5834e,window[_0x4aca80(0xaf3)]=_0x394b2c,window[_0x4aca80(0xac6)]=_0x64a68a,window[_0x4aca80(0xc4c)]=_0xec3eb7,window['renderWorldBookScreenProxy']=_0x3ce340,await _0x41edb1(),_0x2417f9(),await _0x3df474(),_0x4bc8ea(_0x9ebf46[_0x4aca80(0x1383)][_0x4aca80(0x911)]);const _0x19d52a=parseInt(localStorage['getItem'](_0x4aca80(0xe88)))||0x0;_0xddb60e(_0x19d52a);_0x9ebf46[_0x4aca80(0x1383)]&&_0x9ebf46[_0x4aca80(0x1383)]['fontUrl']&&_0xd42b1c(_0x9ebf46[_0x4aca80(0x1383)][_0x4aca80(0x88a)]);_0x1ed2c5(),setInterval(_0x1ed2c5,0x3e8*0x1e),_0x2a99db(),_0x50141b(),_0x2ea916(),_0x1960df(),document[_0x4aca80(0x9c8)](_0x4aca80(0x1146))[_0x4aca80(0xa0f)]('click',_0x4bb97b=>{const _0x34be6b=_0x4aca80;_0x4bb97b['target']['classList'][_0x34be6b(0x1038)](_0x34be6b(0x11c2))&&_0x3d9f29(_0x4bb97b[_0x34be6b(0x1070)][_0x34be6b(0xc9f)][_0x34be6b(0x408)]);}),document[_0x4aca80(0x9c8)]('add-new-rule-btn')['addEventListener']('click',()=>_0x398c43(null)),document[_0x4aca80(0x9c8)](_0x4aca80(0x960))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x58a0ae=_0x4aca80;document[_0x58a0ae(0x9c8)]('rule-editor-modal')[_0x58a0ae(0x575)]['remove']('visible');}),document['getElementById'](_0x4aca80(0x55c))[_0x4aca80(0xa0f)]('click',_0x32dcca),document[_0x4aca80(0x9c8)](_0x4aca80(0xe0a))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x36108d=_0x4aca80;if(_0x9ebf46['activeChatId']&&!_0x9ebf46[_0x36108d(0x547)][_0x9ebf46[_0x36108d(0x970)]][_0x36108d(0x11e4)]){const _0x50ae05=_0x9ebf46[_0x36108d(0x547)][_0x9ebf46['activeChatId']];_0x969182(_0x50ae05['id'],_0x50ae05[_0x36108d(0x1071)]);}});let _0x4e3c3f=null;function _0x32dae6(_0x5ae5e1){const _0x2d46da=_0x4aca80;_0x4e3c3f=_0x5ae5e1;const _0x29f42b=_0x9ebf46['chats'][_0x9ebf46['activeChatId']],_0x445b9d=_0x29f42b[_0x2d46da(0xf3b)][_0x2d46da(0xfc3)](_0x6fddda=>_0x6fddda['id']===_0x5ae5e1);if(!_0x445b9d)return;const _0x4726c7=document[_0x2d46da(0x9c8)](_0x2d46da(0x3b1));_0x4726c7[_0x2d46da(0xe24)]=_0x445b9d[_0x2d46da(0xfac)]?'取消置顶':'置顶公告',document['getElementById'](_0x2d46da(0x2fd))[_0x2d46da(0x575)][_0x2d46da(0x68e)](_0x2d46da(0xc3f));}async function _0x194867(){const _0x2db2a4=_0x4aca80;if(!_0x4e3c3f)return;const _0x94f8aa=_0x9ebf46[_0x2db2a4(0x547)][_0x9ebf46[_0x2db2a4(0x970)]],_0xcad552=_0x94f8aa[_0x2db2a4(0xf3b)][_0x2db2a4(0xfc3)](_0x1c3e89=>_0x1c3e89['id']===_0x4e3c3f);_0xcad552&&(_0xcad552[_0x2db2a4(0xfac)]=!_0xcad552[_0x2db2a4(0xfac)],await _0x2c5bcf[_0x2db2a4(0x547)]['put'](_0x94f8aa),_0x5f5004()),document['getElementById'](_0x2db2a4(0x2fd))[_0x2db2a4(0x575)][_0x2db2a4(0x30f)]('visible');}async function _0x48deb6(){const _0x48b4a2=_0x4aca80;if(!_0x4e3c3f)return;const _0x362861=await _0x352ae9('确认删除',_0x48b4a2(0x9b5),{'confirmButtonClass':_0x48b4a2(0x12bc)});if(_0x362861){const _0x53d995=_0x9ebf46['chats'][_0x9ebf46[_0x48b4a2(0x970)]];_0x53d995[_0x48b4a2(0xf3b)]=_0x53d995['announcements'][_0x48b4a2(0x401)](_0x254cf5=>_0x254cf5['id']!==_0x4e3c3f),await _0x2c5bcf[_0x48b4a2(0x547)][_0x48b4a2(0xff5)](_0x53d995),_0x5f5004();}document[_0x48b4a2(0x9c8)]('announcement-actions-modal')[_0x48b4a2(0x575)][_0x48b4a2(0x30f)](_0x48b4a2(0xc3f));}document[_0x4aca80(0x9c8)](_0x4aca80(0xb89))[_0x4aca80(0xa0f)]('click',_0x1dc9df),document[_0x4aca80(0x9c8)](_0x4aca80(0xab3))[_0x4aca80(0xa0f)]('click',_0x303482=>{const _0x4577bf=_0x4aca80;if(_0x303482[_0x4577bf(0x1070)]===_0x2e0a29)_0x1dc9df();}),document[_0x4aca80(0x9c8)](_0x4aca80(0xd31))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x110897=_0x4aca80,_0x21c502=await _0xb8c832('选择导出方式',[{'text':_0x110897(0x10cb),'value':_0x110897(0x130b)},{'text':_0x110897(0xe33),'value':_0x110897(0xa6e)}]);if(_0x21c502===_0x110897(0x130b))_0x4a0468();else _0x21c502===_0x110897(0xa6e)&&_0x190631();}),document[_0x4aca80(0x9c8)]('cleanup-data-btn')['addEventListener'](_0x4aca80(0xf5c),_0x5ad329),document['getElementById'](_0x4aca80(0xaa6))[_0x4aca80(0xa0f)]('change',_0x9f79ef=>{const _0x136079=_0x4aca80;document[_0x136079(0x9c8)]('offline-mode-options')[_0x136079(0x5e1)][_0x136079(0x3c5)]=_0x9f79ef[_0x136079(0x1070)][_0x136079(0x1ec)]?'block':_0x136079(0x8f6);}),document[_0x4aca80(0x9c8)](_0x4aca80(0x5cd))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>document[_0x4aca80(0x9c8)](_0x4aca80(0x105c))[_0x4aca80(0xf5c)]()),document[_0x4aca80(0x9c8)](_0x4aca80(0xc31))['addEventListener'](_0x4aca80(0x25c),_0x574749=>{const _0x2ab5cb=_0x4aca80;document[_0x2ab5cb(0x9c8)](_0x2ab5cb(0x8ce))[_0x2ab5cb(0x5e1)]['display']=_0x574749['target'][_0x2ab5cb(0x1ec)]?_0x2ab5cb(0x3d9):_0x2ab5cb(0x8f6);}),document[_0x4aca80(0x9c8)](_0x4aca80(0x105c))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),_0xf2ce25=>_0x5a6cbe(_0xf2ce25[_0x4aca80(0x1070)]['files'][0x0])),document[_0x4aca80(0x9c8)](_0x4aca80(0x22b))[_0x4aca80(0xa0f)]('change',_0x406179),document['getElementById'](_0x4aca80(0x1126))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x83361c=_0x4aca80;_0x45cf77={},_0x144843('',_0x83361c(0xcd6),_0x83361c(0x8fe)),_0x144843('',_0x83361c(0x1208),_0x83361c(0x793)),_0x2d6552(),_0x9ebf46[_0x83361c(0x970)]=null,_0xe5834e('chat-list-screen');}),document[_0x4aca80(0x9c8)](_0x4aca80(0x1081))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x39d843=_0x4aca80,_0x2b129a=await _0xb8c832(_0x39d843(0x6b6),[{'text':_0x39d843(0xa45),'value':_0x39d843(0xf8a)},{'text':_0x39d843(0x11f2),'value':_0x39d843(0xd1d)}]);if(_0x2b129a===_0x39d843(0xf8a)){const _0x4155fe=await _0xadb5df('创建新聊天\x20(第1/2步)',_0x39d843(0x1116));if(!_0x4155fe||!_0x4155fe[_0x39d843(0x3f1)]())return;const _0x199248=await _0xadb5df('创建新聊天\x20(第2/2步)',_0x39d843(0x1200));if(!_0x199248||!_0x199248[_0x39d843(0x3f1)]())return;const _0x53dfc6=_0x39d843(0xa63)+Date[_0x39d843(0x9b7)](),_0x8ceb2d={'id':_0x53dfc6,'name':_0x4155fe[_0x39d843(0x3f1)](),'originalName':_0x199248[_0x39d843(0x3f1)](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':_0x39d843(0x733),'blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date['now'](),'isBusy':![]},'settings':{'aiPersona':'这是一个通过手动创建的角色。','myPersona':_0x39d843(0xafc),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x246753,'myAvatar':_0x246753,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':_0x39d843(0xdfb)},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x9ebf46['chats'][_0x53dfc6]=_0x8ceb2d,await _0x2c5bcf[_0x39d843(0x547)][_0x39d843(0xff5)](_0x8ceb2d),_0x394b2c();}else _0x2b129a===_0x39d843(0xd1d)&&document['getElementById'](_0x39d843(0x22b))[_0x39d843(0xf5c)]();}),document['getElementById']('add-group-chat-btn')['addEventListener'](_0x4aca80(0xf5c),_0x350f08),document[_0x4aca80(0x9c8)](_0x4aca80(0x1205))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>document[_0x4aca80(0x9c8)](_0x4aca80(0x1a9))[_0x4aca80(0x575)]['remove']('visible')),document[_0x4aca80(0x9c8)](_0x4aca80(0x126a))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3b7475),document[_0x4aca80(0x9c8)](_0x4aca80(0xd40))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1c3fee),document['getElementById']('music-exit-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>_0xce20b(!![])),document[_0x4aca80(0x9c8)]('music-return-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x51f94a),document[_0x4aca80(0x9c8)](_0x4aca80(0x883))['addEventListener']('click',_0x522563),document[_0x4aca80(0x9c8)](_0x4aca80(0x1dd))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1894d5),document[_0x4aca80(0x9c8)](_0x4aca80(0x9c6))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x321294),document['getElementById'](_0x4aca80(0xf39))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2d6b12),document[_0x4aca80(0x9c8)](_0x4aca80(0x952))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x483075=_0x4aca80;_0x2330eb(),document['getElementById'](_0x483075(0xc1f))[_0x483075(0x575)]['add']('visible');}),document['getElementById']('close-playlist-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>document[_0x4aca80(0x9c8)]('music-playlist-panel')['classList'][_0x4aca80(0x30f)]('visible')),document[_0x4aca80(0x9c8)](_0x4aca80(0x207))[_0x4aca80(0xa0f)]('click',_0x1ad01e),document[_0x4aca80(0x9c8)]('add-song-local-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>document['getElementById']('local-song-upload-input')[_0x4aca80(0xf5c)]()),document['getElementById'](_0x4aca80(0x381))['addEventListener'](_0x4aca80(0x25c),_0x537a8c),document[_0x4aca80(0x9c8)](_0x4aca80(0x1c8))[_0x4aca80(0xa0f)]('click',_0x3481c1=>{const _0x5bd2dc=_0x4aca80,_0x4b56e0=_0x3481c1[_0x5bd2dc(0x1070)],_0x463ace=parseInt(_0x4b56e0[_0x5bd2dc(0xc9f)][_0x5bd2dc(0x45a)]);if(isNaN(_0x463ace))return;if(_0x4b56e0[_0x5bd2dc(0x575)]['contains'](_0x5bd2dc(0x18f)))_0x357753(_0x463ace);else{if(_0x4b56e0[_0x5bd2dc(0x575)]['contains'](_0x5bd2dc(0x4b5)))_0x140b9a(_0x463ace);else{if(_0x4b56e0[_0x5bd2dc(0x575)][_0x5bd2dc(0x1038)](_0x5bd2dc(0xae7)))_0x790b09(_0x463ace);else _0x4b56e0[_0x5bd2dc(0x575)]['contains'](_0x5bd2dc(0x782))&&_0x4d498f(_0x463ace);}}}),_0x287389['addEventListener'](_0x4aca80(0x3bd),()=>{const _0x574a4f=_0x4aca80;document[_0x574a4f(0x9c8)](_0x574a4f(0x438))['classList'][_0x574a4f(0x30f)]('spinning'),_0x1894d5();});const _0x87a265=document['getElementById']('chat-input');document[_0x4aca80(0x9c8)](_0x4aca80(0x6d4))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x5ecf51=_0x4aca80;_0x35124d();const _0x1de758=_0x87a265['value'][_0x5ecf51(0x3f1)]();if(!_0x1de758||!_0x9ebf46[_0x5ecf51(0x970)])return;const _0x34d71c=_0x9ebf46[_0x5ecf51(0x547)][_0x9ebf46[_0x5ecf51(0x970)]],_0x244c4c={'role':_0x5ecf51(0x586),'content':_0x1de758,'timestamp':Date[_0x5ecf51(0x9b7)]()};_0x309858&&(_0x244c4c['quote']=_0x309858),_0xc4e879(_0x244c4c,_0x34d71c),((async()=>{const _0x7ce1ba=_0x5ecf51;_0x34d71c[_0x7ce1ba(0x8b3)][_0x7ce1ba(0x668)](_0x244c4c),await _0x2c5bcf[_0x7ce1ba(0x547)][_0x7ce1ba(0xff5)](_0x34d71c),_0x394b2c();})()),_0x87a265[_0x5ecf51(0x1155)]='',_0x87a265[_0x5ecf51(0x5e1)][_0x5ecf51(0x3ff)]=_0x5ecf51(0x4ee),_0x87a265[_0x5ecf51(0x6fd)](),_0x2e3e2c();}),document[_0x4aca80(0x9c8)]('wait-reply-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x4128b4),_0x87a265['addEventListener']('keypress',_0x334ba1=>{const _0x4aadb0=_0x4aca80;_0x334ba1['key']===_0x4aadb0(0x40e)&&!_0x334ba1[_0x4aadb0(0x475)]&&(_0x334ba1[_0x4aadb0(0xf26)](),document[_0x4aadb0(0x9c8)](_0x4aadb0(0x6d4))['click']());}),document[_0x4aca80(0x9c8)](_0x4aca80(0x13c0))[_0x4aca80(0xa0f)]('change',async _0x5020c6=>{const _0x38ee5c=_0x4aca80,_0x428819=_0x5020c6[_0x38ee5c(0x1070)][_0x38ee5c(0x1216)][0x0];if(_0x428819){const _0x4ad28b=await new Promise((_0x1cd974,_0x1cf8b4)=>{const _0x267110=_0x38ee5c,_0x5a2632=new FileReader();_0x5a2632[_0x267110(0x429)]=()=>_0x1cd974(_0x5a2632[_0x267110(0xceb)]),_0x5a2632[_0x267110(0x11e5)]=()=>_0x1cf8b4(_0x5a2632[_0x267110(0x1221)]),_0x5a2632['readAsDataURL'](_0x428819);});_0x3d4f7d=_0x4ad28b,_0xec3eb7();}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x4c0))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0xdb7222=_0x4aca80;_0x3d4f7d&&(_0x9ebf46[_0xdb7222(0x1383)][_0xdb7222(0x1254)]=_0x3d4f7d),_0x9ebf46['globalSettings']['globalCss']=document[_0xdb7222(0x9c8)](_0xdb7222(0x3c7))[_0xdb7222(0x1155)][_0xdb7222(0x3f1)](),_0x9ebf46[_0xdb7222(0x1383)]['notificationSoundUrl']=document[_0xdb7222(0x9c8)](_0xdb7222(0x89a))['value']['trim'](),_0x9ebf46[_0xdb7222(0x1383)]['showStatusBar']=document[_0xdb7222(0x9c8)](_0xdb7222(0x13c2))['checked'],await _0x2c5bcf[_0xdb7222(0x1383)][_0xdb7222(0xff5)](_0x9ebf46[_0xdb7222(0x1383)]),_0x2a99db(),_0x58c61c(),_0x3d4f7d=null,_0x2ea916(),_0x3f12a7(),_0x4bc8ea(_0x9ebf46[_0xdb7222(0x1383)][_0xdb7222(0x911)]),_0x2417f9(),alert(_0xdb7222(0x37e)),_0xe5834e('home-screen');});const _0x6563b3=document[_0x4aca80(0x9c8)](_0x4aca80(0xbc9));_0x6563b3[_0x4aca80(0xa0f)]('scroll',()=>{const {scrollTop:_0x39451d,scrollHeight:_0x89d3ac,clientHeight:_0x5988cc}=_0x6563b3;_0x89d3ac-_0x39451d-_0x5988cc<_0x5988cc&&(!_0x5daaec&&_0x5ddf04());}),document[_0x4aca80(0x9c8)](_0x4aca80(0x93c))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x402cb6=_0x4aca80;_0x9ebf46['apiConfig'][_0x402cb6(0x6a5)]=document['getElementById']('proxy-url')[_0x402cb6(0x1155)][_0x402cb6(0x3f1)](),_0x9ebf46[_0x402cb6(0x4de)][_0x402cb6(0xfbf)]=document[_0x402cb6(0x9c8)]('api-key')[_0x402cb6(0x1155)][_0x402cb6(0x3f1)](),_0x9ebf46[_0x402cb6(0x4de)][_0x402cb6(0x546)]=document[_0x402cb6(0x9c8)](_0x402cb6(0x661))[_0x402cb6(0x1155)],_0x9ebf46[_0x402cb6(0x4de)][_0x402cb6(0x49e)]=document[_0x402cb6(0x9c8)](_0x402cb6(0x910))[_0x402cb6(0x1155)][_0x402cb6(0x3f1)](),_0x9ebf46[_0x402cb6(0x4de)]['minimaxApiKey']=document[_0x402cb6(0x9c8)](_0x402cb6(0x13ba))[_0x402cb6(0x1155)][_0x402cb6(0x3f1)](),_0x9ebf46[_0x402cb6(0x4de)]['minimaxModel']=document[_0x402cb6(0x9c8)](_0x402cb6(0xf20))[_0x402cb6(0x1155)],_0x9ebf46[_0x402cb6(0x4de)]['secondaryProxyUrl']=document['getElementById'](_0x402cb6(0xe95))['value'][_0x402cb6(0x3f1)](),_0x9ebf46['apiConfig'][_0x402cb6(0xc0c)]=document[_0x402cb6(0x9c8)](_0x402cb6(0xb99))['value'][_0x402cb6(0x3f1)](),_0x9ebf46[_0x402cb6(0x4de)][_0x402cb6(0x62f)]=document['getElementById'](_0x402cb6(0xeda))[_0x402cb6(0x1155)],await _0x2c5bcf['apiConfig'][_0x402cb6(0xff5)](_0x9ebf46['apiConfig']);const _0x3d8b55=document[_0x402cb6(0x9c8)]('background-activity-switch'),_0x5a4ba8=document[_0x402cb6(0x9c8)](_0x402cb6(0xefd)),_0x58ccfc=document[_0x402cb6(0x9c8)]('block-cooldown-input');_0x9ebf46[_0x402cb6(0x1383)][_0x402cb6(0x22a)]=_0x3d8b55[_0x402cb6(0x1ec)],_0x9ebf46[_0x402cb6(0x1383)][_0x402cb6(0x99a)]=parseInt(_0x5a4ba8['value'])||0x3c,_0x9ebf46[_0x402cb6(0x1383)][_0x402cb6(0x368)]=parseFloat(_0x58ccfc[_0x402cb6(0x1155)])||0x1,_0x9ebf46[_0x402cb6(0x1383)]['enableAiDrawing']=document[_0x402cb6(0x9c8)](_0x402cb6(0x3c9))[_0x402cb6(0x1ec)],_0x9ebf46['globalSettings'][_0x402cb6(0x4f5)]=parseInt(document[_0x402cb6(0x9c8)]('chat-render-window-input')[_0x402cb6(0x1155)])||0x32,_0x9ebf46[_0x402cb6(0x1383)][_0x402cb6(0x905)]=parseInt(document[_0x402cb6(0x9c8)]('chat-list-render-window-input')[_0x402cb6(0x1155)])||0x1e,_0x9ebf46['globalSettings'][_0x402cb6(0xc3d)]=parseFloat(document[_0x402cb6(0x9c8)](_0x402cb6(0xfd3))['value']),await _0x2c5bcf['globalSettings'][_0x402cb6(0xff5)](_0x9ebf46[_0x402cb6(0x1383)]),_0x434560();_0x9ebf46['globalSettings'][_0x402cb6(0x22a)]?(_0x27aa50(),console['log'](_0x402cb6(0x11f7)+_0x9ebf46[_0x402cb6(0x1383)][_0x402cb6(0x99a)]+'秒')):console[_0x402cb6(0x283)]('后台活动模拟已停止。');const _0x2fd846=document[_0x402cb6(0x9c8)]('novelai-switch')[_0x402cb6(0x1ec)],_0x120f1b=document[_0x402cb6(0x9c8)]('novelai-model')[_0x402cb6(0x1155)],_0x13ee95=document['getElementById'](_0x402cb6(0xef8))[_0x402cb6(0x1155)][_0x402cb6(0x3f1)]();localStorage['setItem'](_0x402cb6(0xe51),_0x2fd846),localStorage[_0x402cb6(0xa65)](_0x402cb6(0x8e5),_0x120f1b),localStorage['setItem'](_0x402cb6(0xef8),_0x13ee95),alert('所有API与后台设置已保存!');});const _0x362524=document[_0x4aca80(0x9c8)](_0x4aca80(0x773));_0x362524[_0x4aca80(0xa0f)](_0x4aca80(0x6fd),_0x7e0bb1=>{const _0x44e6ae=_0x4aca80;_0x7e0bb1[_0x44e6ae(0x1070)]['setAttribute'](_0x44e6ae(0x12d9),_0x44e6ae(0xbb7));}),_0x362524[_0x4aca80(0xa0f)](_0x4aca80(0x1e8),_0x56f21e=>{const _0xd14284=_0x4aca80;_0x56f21e['target'][_0xd14284(0x13ce)]('type',_0xd14284(0x56b));});async function _0x1fdb5c(_0x354786,_0x29cb08,_0x3ed944){const _0x55ea6d=_0x4aca80,_0x559718=document[_0x55ea6d(0x9c8)](_0x354786)[_0x55ea6d(0x1155)][_0x55ea6d(0x3f1)](),_0xe45d32=document[_0x55ea6d(0x9c8)](_0x29cb08)[_0x55ea6d(0x1155)]['trim']();if(!_0x559718||!_0xe45d32)return alert(_0x55ea6d(0x1225));try{let _0x1029ad=_0x559718===GEMINI_API_URL;const _0x382e40=await fetch(_0x1029ad?GEMINI_API_URL+'?key='+getRandomValue(_0xe45d32):_0x559718+_0x55ea6d(0xfb7),_0x1029ad?undefined:{'headers':{'Authorization':'Bearer\x20'+_0xe45d32}});if(!_0x382e40['ok'])throw new Error(_0x55ea6d(0xf1b));const _0xfc474a=await _0x382e40['json']();let _0x54e195=_0x1029ad?_0xfc474a[_0x55ea6d(0x58b)][_0x55ea6d(0xa3b)](_0x22835c=>({'id':_0x22835c[_0x55ea6d(0x609)]['split']('/')[0x1]||_0x22835c[_0x55ea6d(0x609)]})):_0xfc474a['data'];const _0x33a081=document[_0x55ea6d(0x9c8)](_0x3ed944);_0x33a081[_0x55ea6d(0x2f5)]='';const _0x2a5e62=_0x3ed944===_0x55ea6d(0x661)?_0x9ebf46[_0x55ea6d(0x4de)][_0x55ea6d(0x546)]:_0x9ebf46['apiConfig'][_0x55ea6d(0x62f)];_0x54e195[_0x55ea6d(0x591)](_0x26ed7d=>{const _0xcfd546=_0x55ea6d,_0x5d5834=document[_0xcfd546(0x28a)](_0xcfd546(0x12ef));_0x5d5834[_0xcfd546(0x1155)]=_0x26ed7d['id'],_0x5d5834[_0xcfd546(0xe24)]=_0x26ed7d['id'];if(_0x26ed7d['id']===_0x2a5e62)_0x5d5834[_0xcfd546(0x631)]=!![];_0x33a081['appendChild'](_0x5d5834);}),alert(_0x55ea6d(0xfc0));}catch(_0xa17db){alert(_0x55ea6d(0x578)+_0xa17db[_0x55ea6d(0x86e)]);}}document[_0x4aca80(0x9c8)](_0x4aca80(0x1048))[_0x4aca80(0xa0f)]('click',()=>{const _0x23c613=_0x4aca80;_0x1fdb5c(_0x23c613(0x9a9),_0x23c613(0x773),_0x23c613(0x661));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xa01))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x4c374d=_0x4aca80;_0x1fdb5c(_0x4c374d(0xe95),'secondary-api-key',_0x4c374d(0xeda));}),document['getElementById'](_0x4aca80(0x131c))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x37a026=_0x4aca80,_0x16d768=await _0xadb5df('创建世界书','请输入书名');if(_0x16d768&&_0x16d768['trim']()){const _0x2bdb9f={'id':_0x37a026(0x1058)+Date[_0x37a026(0x9b7)](),'name':_0x16d768[_0x37a026(0x3f1)](),'content':''};await _0x2c5bcf[_0x37a026(0x1369)]['add'](_0x2bdb9f),_0x9ebf46['worldBooks'][_0x37a026(0x668)](_0x2bdb9f),_0x3ce340(),_0x31b7ce(_0x2bdb9f['id']);}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x3c8))['addEventListener'](_0x4aca80(0xf5c),async()=>{const _0x174fb7=_0x4aca80;if(!_0x56f504)return;const _0x504153=_0x9ebf46[_0x174fb7(0x1369)][_0x174fb7(0xfc3)](_0x2319c5=>_0x2319c5['id']===_0x56f504);if(!_0x504153)return;const _0x516d44=document[_0x174fb7(0x9c8)](_0x174fb7(0xb12))[_0x174fb7(0x1155)]['trim']();if(!_0x516d44){alert('书名不能为空！');return;}_0x504153[_0x174fb7(0x609)]=_0x516d44;const _0x3a0635=document[_0x174fb7(0x9c8)](_0x174fb7(0x10aa))['value'];_0x504153[_0x174fb7(0x408)]=_0x3a0635?parseInt(_0x3a0635):null;const _0x3021ab=document[_0x174fb7(0x9c8)]('world-book-entries-container'),_0xb83a88=_0x3021ab[_0x174fb7(0x7e4)]('.message-editor-block'),_0x5b2ca6=[];_0xb83a88['forEach'](_0x3ded60=>{const _0x2496b1=_0x174fb7,_0x98480c=_0x3ded60[_0x2496b1(0x91d)]('.entry-keys-input')[_0x2496b1(0x1155)][_0x2496b1(0x3f1)](),_0x1880d3=_0x3ded60['querySelector']('.entry-content-textarea')[_0x2496b1(0x1155)][_0x2496b1(0x3f1)](),_0x360572=_0x3ded60['querySelector'](_0x2496b1(0x605))[_0x2496b1(0x1ec)];_0x1880d3&&_0x5b2ca6['push']({'comment':_0x3ded60['querySelector'](_0x2496b1(0x136f))['value'][_0x2496b1(0x3f1)](),'keys':_0x98480c?_0x98480c[_0x2496b1(0x6c6)](',')[_0x2496b1(0xa3b)](_0x3e667d=>_0x3e667d[_0x2496b1(0x3f1)]())['filter'](_0x204f95=>_0x204f95):[],'content':_0x1880d3,'enabled':_0x360572});}),_0x504153['content']=_0x5b2ca6,await _0x2c5bcf['worldBooks']['put'](_0x504153),document['getElementById'](_0x174fb7(0xc47))['textContent']=_0x516d44,_0x56f504=null,_0xe5834e(_0x174fb7(0x3d0)),await _0x3ce340();}),document[_0x4aca80(0x9c8)](_0x4aca80(0xbff))['addEventListener'](_0x4aca80(0xf5c),async _0x33a18c=>{const _0x5c4722=_0x4aca80,_0x13ee59=_0x33a18c[_0x5c4722(0x1070)][_0x5c4722(0xaa0)]('.voice-message-body[data-text]');if(_0x13ee59){const _0x58a686=_0x9ebf46['chats'][_0x9ebf46[_0x5c4722(0x970)]];if(!_0x58a686)return;_0x21e7a1(_0x13ee59);const _0x19e052=_0x13ee59['closest']('.message-bubble'),_0x42f1e2=_0x19e052?_0x19e052[_0x5c4722(0x91d)]('.voice-transcript'):null;if(_0x13ee59[_0x5c4722(0xc9f)][_0x5c4722(0x1365)]&&_0x42f1e2&&_0x42f1e2['style'][_0x5c4722(0x3c5)]===_0x5c4722(0x3d9)){if(_0x58a686[_0x5c4722(0x11e4)]){console[_0x5c4722(0x283)](_0x5c4722(0x89d));return;}if(_0x58a686['settings'][_0x5c4722(0xd80)]===![]){console[_0x5c4722(0x283)]('“'+_0x58a686[_0x5c4722(0x609)]+_0x5c4722(0xd6a));return;}_0x278f3f(_0x13ee59);}return;}const _0x493c86=_0x33a18c[_0x5c4722(0x1070)][_0x5c4722(0xaa0)]('.waimai-details-btn');if(_0x493c86){const _0x430d9e=_0x493c86[_0x5c4722(0xaa0)](_0x5c4722(0xef7));if(_0x430d9e){const _0x53fe93=parseInt(_0x430d9e['dataset'][_0x5c4722(0x6b5)]);if(!isNaN(_0x53fe93)){_0x222a9f(_0x53fe93);return;}}}const _0x3a8ce3=_0x33a18c[_0x5c4722(0x1070)][_0x5c4722(0xaa0)]('.waimai-user-actions\x20button');if(_0x3a8ce3){const _0x253525=_0x3a8ce3['closest'](_0x5c4722(0xef7));if(_0x253525){const _0x576f5b=parseInt(_0x253525[_0x5c4722(0xc9f)][_0x5c4722(0x6b5)]),_0x4c547d=_0x3a8ce3[_0x5c4722(0xc9f)][_0x5c4722(0xaaa)];if(!isNaN(_0x576f5b)&&_0x4c547d){await _0x31b0bf(_0x576f5b,_0x4c547d);return;}}}const _0x1a1293=_0x33a18c[_0x5c4722(0x1070)]['closest'](_0x5c4722(0xb0f));if(_0x1a1293){const _0x596dbf=parseInt(_0x1a1293[_0x5c4722(0xc9f)][_0x5c4722(0xf23)]);if(!isNaN(_0x596dbf)){const _0x171dc9=await _0x2c5bcf[_0x5c4722(0x75f)][_0x5c4722(0xdf9)](_0x596dbf);if(_0x171dc9){let _0x3553a5='';const _0x19e51b=_0x171dc9['authorId']===_0x5c4722(0x586)?_0x9ebf46[_0x5c4722(0x32c)][_0x5c4722(0x5b7)]:_0x9ebf46[_0x5c4722(0x547)][_0x171dc9[_0x5c4722(0x61c)]]?.[_0x5c4722(0x609)]||_0x5c4722(0x37c);if(_0x171dc9['type']===_0x5c4722(0x1238))_0x3553a5=_0x171dc9[_0x5c4722(0x53b)];else{_0x3553a5=_0x171dc9[_0x5c4722(0x7b2)]||'';if(_0x171dc9[_0x5c4722(0xd5e)])_0x3553a5+='\x0a[图片]';if(_0x171dc9[_0x5c4722(0x841)])_0x3553a5+=_0x5c4722(0x639)+_0x171dc9[_0x5c4722(0x841)]+']';}_0x1bff53('来自\x20'+_0x19e51b+_0x5c4722(0xdad),_0x3553a5[_0x5c4722(0x459)](/\n/g,_0x5c4722(0x10d9)));}else _0x1bff53('提示',_0x5c4722(0xbd4));}return;}const _0x574b88=_0x33a18c['target'][_0x5c4722(0xaa0)](_0x5c4722(0x447));if(_0x574b88){const _0x30e6f6=_0x574b88[_0x5c4722(0xc9f)][_0x5c4722(0x1387)];if(_0x30e6f6)_0x1bff53(_0x5c4722(0xca1),_0x30e6f6);return;}const _0x2da35d=_0x33a18c[_0x5c4722(0x1070)][_0x5c4722(0xaa0)](_0x5c4722(0x12ee));if(_0x2da35d&&_0x2da35d[_0x5c4722(0xc9f)][_0x5c4722(0x117e)]){const _0x55f43a=parseInt(_0x2da35d[_0x5c4722(0xc9f)][_0x5c4722(0x117e)]);!isNaN(_0x55f43a)&&_0xc1ed1c(_0x55f43a);}const _0x480b72=_0x33a18c[_0x5c4722(0x1070)][_0x5c4722(0xaa0)](_0x5c4722(0x139d));if(_0x480b72){const _0x27118f=_0x480b72[_0x5c4722(0xaa0)](_0x5c4722(0xef7));_0x27118f&&_0x52a403(parseInt(_0x27118f[_0x5c4722(0xc9f)][_0x5c4722(0x6b5)]));}const _0x5a4fb2=_0x33a18c[_0x5c4722(0x1070)][_0x5c4722(0xaa0)](_0x5c4722(0xd03));if(_0x5a4fb2){const _0x2bd501=_0x5a4fb2[_0x5c4722(0xaa0)]('.message-bubble');if(_0x2bd501&&_0x2bd501[_0x5c4722(0xc9f)][_0x5c4722(0x6b5)]){const _0x32cd4b=parseInt(_0x2bd501[_0x5c4722(0xc9f)]['timestamp']);_0x23c5f9(_0x32cd4b);}}const _0x2bb7b0=_0x33a18c['target'][_0x5c4722(0xaa0)](_0x5c4722(0x1aa));if(_0x2bb7b0){const _0x531179=parseInt(_0x2bb7b0[_0x5c4722(0xc9f)][_0x5c4722(0xff4)]);if(isNaN(_0x531179))return;const _0x27fe76=_0x33a18c['target']['closest'](_0x5c4722(0x9a8));if(_0x27fe76&&!_0x2bb7b0[_0x5c4722(0x575)]['contains'](_0x5c4722(0x10c3))){_0x20009b(_0x531179,_0x27fe76[_0x5c4722(0xc9f)][_0x5c4722(0x12ef)]);return;}const _0x2dc173=_0x33a18c[_0x5c4722(0x1070)][_0x5c4722(0xaa0)]('.poll-action-btn');if(_0x2dc173){_0x2bb7b0[_0x5c4722(0x575)][_0x5c4722(0x1038)](_0x5c4722(0x10c3))?_0x125490(_0x531179):_0x5bdb6f(_0x531179);return;}_0x2bb7b0[_0x5c4722(0x575)][_0x5c4722(0x1038)](_0x5c4722(0x10c3))&&_0x125490(_0x531179);}const _0x3af29f=_0x33a18c[_0x5c4722(0x1070)][_0x5c4722(0xaa0)](_0x5c4722(0x84f));if(_0x3af29f){const _0x49a4da=_0x9ebf46[_0x5c4722(0x547)][_0x9ebf46[_0x5c4722(0x970)]],_0x126c10=_0x3af29f[_0x5c4722(0xaa0)](_0x5c4722(0x6f0));if(_0x49a4da&&_0x126c10){const _0x4d0b33=parseInt(_0x126c10['dataset']['timestamp']),_0x2cd6c0=_0x49a4da[_0x5c4722(0x8b3)][_0x5c4722(0xfc3)](_0x594142=>_0x594142[_0x5c4722(0x6b5)]===_0x4d0b33);if(_0x2cd6c0&&_0x2cd6c0[_0x5c4722(0x6c2)]){let _0x25c1fc='';const _0x362af2=_0x2cd6c0[_0x5c4722(0x6c2)];_0x362af2[_0x5c4722(0x22e)]===_0x5c4722(0xbb7)?_0x25c1fc=_0x5c4722(0xed7)+_0x362af2[_0x5c4722(0x489)]+'\x22':_0x25c1fc=_0x5c4722(0xdfa)+_0x362af2['originalType']+']类型的消息',_0x1bff53(_0x5c4722(0xed8),_0x25c1fc);}}}const _0x33ff96=_0x33a18c[_0x5c4722(0x1070)]['closest'](_0x5c4722(0xab1));if(_0x33ff96&&_0x33ff96[_0x5c4722(0xaa0)](_0x5c4722(0xa1f))){const _0x49b109=parseInt(_0x33ff96[_0x5c4722(0xc9f)][_0x5c4722(0x6b5)]);_0x1ca9d6(_0x49b109);}const _0x9c1188=_0x33a18c['target'][_0x5c4722(0xaa0)](_0x5c4722(0xef7));if(_0x9c1188&&_0x9c1188[_0x5c4722(0x575)][_0x5c4722(0x1038)]('ai')&&_0x9c1188[_0x5c4722(0x575)][_0x5c4722(0x1038)](_0x5c4722(0x464))&&_0x9c1188[_0x5c4722(0xc9f)]['status']==='pending'){const _0x5bc5be=parseInt(_0x9c1188[_0x5c4722(0xc9f)]['timestamp']);!isNaN(_0x5bc5be)&&_0x5720c7(_0x5bc5be);}});const _0x11ab5d=document[_0x4aca80(0x9c8)](_0x4aca80(0xb76)),_0x2bb65c=document[_0x4aca80(0x91d)](_0x4aca80(0x1321)),_0x35c6d2=document[_0x4aca80(0x9c8)](_0x4aca80(0xb2d));function _0x129089(){const _0x4509c7=_0x4aca80,_0x3979cf=_0x35c6d2[_0x4509c7(0x7e4)]('input:checked'),_0x319ee2=document[_0x4509c7(0x91d)](_0x4509c7(0x1019));if(_0x3979cf[_0x4509c7(0xa06)]===0x0)_0x319ee2[_0x4509c7(0xe24)]=_0x4509c7(0xd43);else{if(_0x3979cf[_0x4509c7(0xa06)]>0x2)_0x319ee2[_0x4509c7(0xe24)]=_0x4509c7(0x88b)+_0x3979cf[_0x4509c7(0xa06)]+_0x4509c7(0xaef);else{const _0x5ddbb3=Array[_0x4509c7(0x13a5)](_0x3979cf)[_0x4509c7(0xa3b)](_0x3b2f79=>{const _0x4a5f99=_0x4509c7;return _0x3b2f79[_0x4a5f99(0x193)][_0x4a5f99(0xe24)][_0x4a5f99(0x3f1)]();});_0x319ee2[_0x4509c7(0xe24)]=_0x5ddbb3[_0x4509c7(0x809)](',\x20');}}}_0x2bb65c[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2970d5=>{const _0x37f71a=_0x4aca80;_0x2970d5[_0x37f71a(0x20a)](),_0x35c6d2[_0x37f71a(0x575)][_0x37f71a(0x1c3)](_0x37f71a(0xc3f)),_0x2bb65c[_0x37f71a(0x575)][_0x37f71a(0x1c3)](_0x37f71a(0x6e8));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xb2d))['addEventListener']('change',_0x129089),window['addEventListener'](_0x4aca80(0xf5c),_0x237280=>{const _0x26c88f=_0x4aca80;!document[_0x26c88f(0x91d)]('.custom-multiselect')['contains'](_0x237280[_0x26c88f(0x1070)])&&(_0x35c6d2[_0x26c88f(0x575)][_0x26c88f(0x30f)]('visible'),_0x2bb65c[_0x26c88f(0x575)]['remove'](_0x26c88f(0x6e8)));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xb86))['addEventListener'](_0x4aca80(0xf5c),async()=>{const _0x590df6=_0x4aca80;_0xa82c6d();if(!_0x9ebf46[_0x590df6(0x970)])return;const _0x55093b=_0x9ebf46[_0x590df6(0x547)][_0x9ebf46[_0x590df6(0x970)]],_0x392346=_0x55093b[_0x590df6(0x11e4)],_0x899f7a=document['getElementById'](_0x590df6(0x413));!_0x392346&&_0x55093b[_0x590df6(0x1131)][_0x590df6(0x31e)]&&_0x55093b['settings']['alternateGreetings']['length']>0x0?_0x899f7a[_0x590df6(0x5e1)][_0x590df6(0x3c5)]=_0x590df6(0x3d9):_0x899f7a[_0x590df6(0x5e1)][_0x590df6(0x3c5)]=_0x590df6(0x8f6);document[_0x590df6(0x9c8)]('chat-name-group')['style'][_0x590df6(0x3c5)]='block',document[_0x590df6(0x9c8)](_0x590df6(0x61e))['style']['display']=_0x590df6(0x3d9),document[_0x590df6(0x9c8)]('my-avatar-group')[_0x590df6(0x5e1)][_0x590df6(0x3c5)]=_0x590df6(0x3d9),document[_0x590df6(0x9c8)](_0x590df6(0x1253))[_0x590df6(0x5e1)][_0x590df6(0x3c5)]=_0x392346?'block':_0x590df6(0x8f6),document['getElementById']('my-nickname-group')[_0x590df6(0x5e1)][_0x590df6(0x3c5)]=_0x392346?_0x590df6(0x8f6):_0x590df6(0x3d9),document[_0x590df6(0x9c8)]('group-avatar-group')['style']['display']=_0x392346?_0x590df6(0x3d9):_0x590df6(0x8f6),document[_0x590df6(0x9c8)](_0x590df6(0x704))[_0x590df6(0x5e1)][_0x590df6(0x3c5)]=_0x392346?_0x590df6(0x3d9):_0x590df6(0x8f6),document[_0x590df6(0x9c8)]('ai-persona-group')[_0x590df6(0x5e1)][_0x590df6(0x3c5)]=_0x392346?'none':_0x590df6(0x3d9),document[_0x590df6(0x9c8)](_0x590df6(0xe3a))[_0x590df6(0x5e1)]['display']=_0x392346?_0x590df6(0x8f6):'block',document[_0x590df6(0x9c8)]('assign-group-section')['style'][_0x590df6(0x3c5)]=_0x392346?_0x590df6(0x8f6):_0x590df6(0x3d9),document[_0x590df6(0x9c8)]('ai-original-name-group')[_0x590df6(0x5e1)]['display']=_0x392346?_0x590df6(0x8f6):_0x590df6(0x3d9),document['getElementById'](_0x590df6(0x993))[_0x590df6(0x5e1)][_0x590df6(0x3c5)]=_0x392346?_0x590df6(0x8f6):_0x590df6(0x3d9),document['getElementById']('inject-thought-group')['style'][_0x590df6(0x3c5)]=_0x392346?'none':_0x590df6(0x3d9),document[_0x590df6(0x9c8)](_0x590df6(0x619))[_0x590df6(0x5e1)]['display']=_0x392346?'none':'block',document['getElementById'](_0x590df6(0x10b8))[_0x590df6(0x5e1)][_0x590df6(0x3c5)]=_0x392346?'none':_0x590df6(0x3d9),document['getElementById'](_0x590df6(0xf3a))[_0x590df6(0x5e1)]['display']=_0x392346?_0x590df6(0x3d9):_0x590df6(0x8f6),document[_0x590df6(0x9c8)](_0x590df6(0x3f8))[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x609)],document[_0x590df6(0x9c8)](_0x590df6(0x79e))[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x1131)]['myPersona'],document['getElementById'](_0x590df6(0xa98))[_0x590df6(0xbf4)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0xb60)]||(_0x392346?_0x1d990b:_0x246753),document[_0x590df6(0x9c8)](_0x590df6(0x4df))[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0x132a)],document['getElementById'](_0x590df6(0xdb1))[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0xf9f)]||0xa;const _0x1d588=document['getElementById']('bg-preview'),_0x4b967d=document[_0x590df6(0x9c8)](_0x590df6(0x1275));_0x55093b[_0x590df6(0x1131)]['background']?(_0x1d588[_0x590df6(0xbf4)]=_0x55093b[_0x590df6(0x1131)]['background'],_0x1d588[_0x590df6(0x5e1)][_0x590df6(0x3c5)]=_0x590df6(0x3d9),_0x4b967d['style'][_0x590df6(0x3c5)]='inline-block'):(_0x1d588['style']['display']=_0x590df6(0x8f6),_0x4b967d[_0x590df6(0x5e1)][_0x590df6(0x3c5)]=_0x590df6(0x8f6));document[_0x590df6(0x9c8)](_0x590df6(0x106b))['style'][_0x590df6(0x3c5)]=_0x392346?_0x590df6(0x8f6):'block',document[_0x590df6(0x9c8)](_0x590df6(0xe0d))[_0x590df6(0x5e1)]['display']=_0x392346?_0x590df6(0x8f6):_0x590df6(0x3d9),document[_0x590df6(0x9c8)]('group-background-activity-group')['style']['display']=_0x392346?_0x590df6(0x3d9):_0x590df6(0x8f6);const _0x44e781=document['getElementById']('time-perception-toggle'),_0x946a1=document[_0x590df6(0x9c8)](_0x590df6(0x8ce));_0x44e781[_0x590df6(0x1ec)]=_0x55093b['settings'][_0x590df6(0x64b)],_0x946a1[_0x590df6(0x5e1)][_0x590df6(0x3c5)]=_0x44e781[_0x590df6(0x1ec)]?_0x590df6(0x3d9):_0x590df6(0x8f6);const _0x3dd1ed=document[_0x590df6(0x9c8)]('time-zone-select'),_0x3a81c2=Intl['supportedValuesOf'](_0x590df6(0x11ee));_0x3dd1ed['innerHTML']='',_0x3a81c2['forEach'](_0x3210ac=>{const _0x4da90f=_0x590df6,_0x537a9c=document[_0x4da90f(0x28a)]('option');_0x537a9c[_0x4da90f(0x1155)]=_0x3210ac,_0x537a9c[_0x4da90f(0xe24)]=_0x3210ac,_0x3dd1ed[_0x4da90f(0x7b9)](_0x537a9c);}),_0x3dd1ed[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0x11ee)]||_0x590df6(0xdfb);if(_0x392346)document['getElementById'](_0x590df6(0x882))[_0x590df6(0x1ec)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0x22a)],document['getElementById'](_0x590df6(0x13b6))[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x1131)]['myNickname']||'',document[_0x590df6(0x9c8)]('group-avatar-preview')['src']=_0x55093b[_0x590df6(0x1131)][_0x590df6(0xa79)]||_0x5d7a94,document[_0x590df6(0x9c8)](_0x590df6(0xa12))[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0x664)]||0xa,document[_0x590df6(0x9c8)](_0x590df6(0xe0d))[_0x590df6(0x5e1)]['display']=_0x590df6(0x8f6),_0x30bb01(_0x55093b[_0x590df6(0xd3e)]);else{document[_0x590df6(0x9c8)](_0x590df6(0xe0d))[_0x590df6(0x5e1)][_0x590df6(0x3c5)]=_0x590df6(0x3d9),document[_0x590df6(0x9c8)](_0x590df6(0x743))['checked']=_0x55093b['settings'][_0x590df6(0x22a)],document[_0x590df6(0x9c8)](_0x590df6(0xf9d))[_0x590df6(0x1ec)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0x31f)];const _0x159a39=document[_0x590df6(0x9c8)](_0x590df6(0xaa6)),_0x14f17e=document['getElementById'](_0x590df6(0x988)),_0x1eb319=document[_0x590df6(0x9c8)](_0x590df6(0x511)),_0x30939e=document[_0x590df6(0x9c8)](_0x590df6(0xba2));_0x159a39['checked']=_0x55093b[_0x590df6(0x1131)][_0x590df6(0x95b)]||![],_0x14f17e[_0x590df6(0x5e1)]['display']=_0x159a39['checked']?'block':_0x590df6(0x8f6),_0x1eb319[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0xa82)]||0x64,_0x30939e['value']=_0x55093b[_0x590df6(0x1131)]['offlineMaxLength']||0x12c,await _0x6edbb3(_0x55093b),document[_0x590df6(0x9c8)]('ai-original-name-input')[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x1071)],document[_0x590df6(0x9c8)](_0x590df6(0xb42))[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0x8c1)]||'',document[_0x590df6(0x9c8)](_0x590df6(0x11f5))[_0x590df6(0x1ec)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0xd80)]!==![],document[_0x590df6(0x9c8)](_0x590df6(0x72a))[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0xae3)],document['getElementById'](_0x590df6(0x347))[_0x590df6(0xbf4)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0xd4d)]||_0x246753,document[_0x590df6(0x9c8)](_0x590df6(0x1008))[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x1131)]['myNickname']||'我',document[_0x590df6(0x9c8)](_0x590df6(0xfcc))[_0x590df6(0x1155)]=_0x55093b['settings']['actionCooldownMinutes']||0xa;const _0x32416a=document['getElementById'](_0x590df6(0x120e));_0x32416a[_0x590df6(0x2f5)]=_0x590df6(0x67f);const _0x146e33=await _0x2c5bcf[_0x590df6(0xaf2)][_0x590df6(0x5ff)]();_0x146e33[_0x590df6(0x591)](_0x435594=>{const _0x285ecc=_0x590df6,_0x19c717=document['createElement']('option');_0x19c717[_0x285ecc(0x1155)]=_0x435594['id'],_0x19c717[_0x285ecc(0xe24)]=_0x435594['name'];if(_0x55093b['groupId']===_0x435594['id'])_0x19c717[_0x285ecc(0x631)]=!![];_0x32416a[_0x285ecc(0x7b9)](_0x19c717);});const _0x3a8b06=_0x55093b[_0x590df6(0x1131)][_0x590df6(0xd55)]||{'vertical':_0x590df6(0x114a),'horizontal':'center','offset':0xa};document['getElementById'](_0x590df6(0xa02))[_0x590df6(0x1155)]=_0x3a8b06[_0x590df6(0x3e1)],document[_0x590df6(0x9c8)](_0x590df6(0x42b))[_0x590df6(0x1155)]=_0x3a8b06[_0x590df6(0xca6)],document['getElementById']('lyrics-offset-input')[_0x590df6(0x1155)]=_0x3a8b06[_0x590df6(0x1007)];}const _0x2e2e0c=document['getElementById'](_0x590df6(0xb2d));_0x2e2e0c[_0x590df6(0x2f5)]='';const [_0x2cc898,_0x248185]=await Promise['all']([_0x2c5bcf[_0x590df6(0x58a)][_0x590df6(0x5ff)](),_0x2c5bcf['worldBooks'][_0x590df6(0x5ff)]()]),_0x5ed213=new Set(_0x55093b[_0x590df6(0x1131)]['linkedWorldBookIds']||[]);if(_0x248185['length']===0x0)_0x2e2e0c[_0x590df6(0x2f5)]=_0x590df6(0x1300);else{_0x2cc898['forEach'](_0xae6412=>{const _0x3bb271=_0x590df6,_0x580684=_0x248185[_0x3bb271(0x401)](_0x5a4af5=>_0x5a4af5[_0x3bb271(0x408)]===_0xae6412['id']);if(_0x580684[_0x3bb271(0xa06)]>0x0){const _0x139fc3=document['createElement']('h4');_0x139fc3['textContent']=_0xae6412[_0x3bb271(0x609)],_0x139fc3[_0x3bb271(0x5e1)][_0x3bb271(0xd09)]=_0x3bb271(0xc1d),_0x2e2e0c[_0x3bb271(0x7b9)](_0x139fc3),_0x580684[_0x3bb271(0x591)](_0x291afc=>{const _0x57acf1=_0x3bb271,_0x51ea64=_0x5ed213[_0x57acf1(0xd97)](_0x291afc['id']),_0x453a2c=document[_0x57acf1(0x28a)](_0x57acf1(0x13c5));_0x453a2c[_0x57acf1(0x2f5)]=_0x57acf1(0xeef)+_0x291afc['id']+'\x22\x20'+(_0x51ea64?_0x57acf1(0x1ec):'')+'>\x20'+_0x291afc['name'],_0x2e2e0c['appendChild'](_0x453a2c);});}});const _0x52ee91=_0x248185[_0x590df6(0x401)](_0x3e7cfa=>!_0x3e7cfa['categoryId']);if(_0x52ee91[_0x590df6(0xa06)]>0x0){const _0x1a4364=document[_0x590df6(0x28a)]('h4');_0x1a4364[_0x590df6(0xe24)]=_0x590df6(0x6ea),_0x1a4364[_0x590df6(0x5e1)][_0x590df6(0xd09)]=_0x590df6(0x1cb),_0x2e2e0c[_0x590df6(0x7b9)](_0x1a4364),_0x52ee91['forEach'](_0x8875e0=>{const _0x2a5dfc=_0x590df6,_0x23a411=_0x5ed213['has'](_0x8875e0['id']),_0xf82733=document[_0x2a5dfc(0x28a)]('label');_0xf82733[_0x2a5dfc(0x2f5)]='<input\x20type=\x22checkbox\x22\x20value=\x22book_'+_0x8875e0['id']+'\x22\x20'+(_0x23a411?_0x2a5dfc(0x1ec):'')+'>\x20'+_0x8875e0[_0x2a5dfc(0x609)],_0x2e2e0c[_0x2a5dfc(0x7b9)](_0xf82733);});}}_0x129089();const _0x5bbbf8=document[_0x590df6(0x9c8)](_0x590df6(0x136d)),_0x2551ab=document['getElementById'](_0x590df6(0x64c)),_0x5cb84d=document[_0x590df6(0x9c8)](_0x590df6(0xc95)),_0x3d1072=_0x55093b[_0x590df6(0x1131)][_0x590df6(0xfeb)]||[];_0x5bbbf8[_0x590df6(0x1ec)]=_0x3d1072[_0x590df6(0xa06)]>0x0,_0x2551ab['style'][_0x590df6(0x3c5)]=_0x5bbbf8[_0x590df6(0x1ec)]?'block':_0x590df6(0x8f6),_0x5cb84d[_0x590df6(0x2f5)]='',Object[_0x590df6(0xeb2)](_0x9ebf46['chats'])[_0x590df6(0x591)](_0x4740ae=>{const _0x42846a=_0x590df6;if(_0x4740ae['id']===_0x55093b['id'])return;const _0x1ed069=_0x3d1072[_0x42846a(0x930)](_0x4740ae['id']),_0x1660b3=_0x4740ae[_0x42846a(0x11e4)]?_0x42846a(0x93a):'[私聊]',_0x24fef0=document[_0x42846a(0x28a)](_0x42846a(0x13c5));_0x24fef0['innerHTML']=_0x42846a(0x12f5)+_0x4740ae['id']+'\x22\x20'+(_0x1ed069?_0x42846a(0x1ec):'')+'>\x20'+_0x1660b3+'\x20'+_0x4740ae[_0x42846a(0x609)],_0x5cb84d['appendChild'](_0x24fef0);});function _0x5d5e8a(){const _0x26b8df=_0x590df6,_0x42e23b=_0x5cb84d['querySelectorAll'](_0x26b8df(0x3ef)),_0x1cc57f=_0x2551ab[_0x26b8df(0x91d)](_0x26b8df(0x1019));if(_0x42e23b[_0x26b8df(0xa06)]===0x0)_0x1cc57f[_0x26b8df(0xe24)]=_0x26b8df(0xd43);else _0x42e23b[_0x26b8df(0xa06)]>0x2?_0x1cc57f[_0x26b8df(0xe24)]=_0x26b8df(0x88b)+_0x42e23b[_0x26b8df(0xa06)]+'\x20项':_0x1cc57f['textContent']=Array[_0x26b8df(0x13a5)](_0x42e23b)[_0x26b8df(0xa3b)](_0x520cfc=>_0x520cfc['parentElement'][_0x26b8df(0xe24)][_0x26b8df(0x3f1)]())[_0x26b8df(0x809)](',\x20');}_0x5d5e8a(),_0x5bbbf8[_0x590df6(0xa0f)](_0x590df6(0x25c),()=>{const _0x2860a5=_0x590df6;_0x2551ab['style'][_0x2860a5(0x3c5)]=_0x5bbbf8['checked']?'block':_0x2860a5(0x8f6);});const _0x4ec957=_0x2551ab[_0x590df6(0x91d)]('.select-box'),_0x346772=_0x4ec957[_0x590df6(0x75c)](!![]);_0x4ec957[_0x590df6(0x127d)]['replaceChild'](_0x346772,_0x4ec957),_0x346772[_0x590df6(0xa0f)](_0x590df6(0xf5c),_0x30bcec=>{const _0x21fa1d=_0x590df6;_0x30bcec[_0x21fa1d(0x20a)](),_0x5cb84d[_0x21fa1d(0x575)][_0x21fa1d(0x1c3)]('visible'),_0x346772['classList'][_0x21fa1d(0x1c3)]('expanded');}),_0x5cb84d['addEventListener'](_0x590df6(0x25c),_0x5d5e8a);const _0x4f2585=document[_0x590df6(0x91d)]('input[name=\x22theme-select\x22][value=\x22'+(_0x55093b[_0x590df6(0x1131)][_0x590df6(0x56d)]||'default')+'\x22]');if(_0x4f2585)_0x4f2585[_0x590df6(0x1ec)]=!![];const _0x5df31f=document[_0x590df6(0x9c8)](_0x590df6(0xfb6));_0x5df31f[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0x844)]||0xd,document[_0x590df6(0x9c8)](_0x590df6(0x1c9))[_0x590df6(0xe24)]=_0x5df31f['value']+'px';const _0x1af6b9=document['getElementById'](_0x590df6(0x1332));_0x1af6b9['value']=_0x55093b['settings'][_0x590df6(0xc83)]||'',_0x2c9d73(),document[_0x590df6(0x9c8)]('auto-memory-toggle')[_0x590df6(0x1ec)]=_0x55093b['settings'][_0x590df6(0x10df)]||![],document[_0x590df6(0x9c8)]('auto-memory-interval')[_0x590df6(0x1155)]=_0x55093b[_0x590df6(0x1131)][_0x590df6(0x874)]||0x14,setTimeout(()=>{const _0x3f4223=_0x590df6;_0x3cf16e();const _0x1d255c=[_0x3f4223(0x72a),_0x3f4223(0x79e),'max-memory',_0x3f4223(0xdb1),_0x3f4223(0x9e9),_0x3f4223(0x57c),'offline-mode-toggle',_0x3f4223(0x511),_0x3f4223(0xba2),_0x3f4223(0x4e6)];_0x1d255c['forEach'](_0x145f50=>{const _0x1d6dba=_0x3f4223,_0x25995b=document[_0x1d6dba(0x9c8)](_0x145f50);_0x25995b&&_0x25995b['addEventListener'](_0x1d6dba(0x11ce),_0x3cf16e);}),document[_0x3f4223(0x9c8)](_0x3f4223(0xb2d))['addEventListener'](_0x3f4223(0x25c),_0x3cf16e),document[_0x3f4223(0x9c8)](_0x3f4223(0xc95))[_0x3f4223(0xa0f)](_0x3f4223(0x25c),_0x3cf16e),document[_0x3f4223(0x9c8)](_0x3f4223(0x136d))['addEventListener'](_0x3f4223(0x25c),_0x3cf16e);},0x64),_0xe5834e('chat-settings-screen');});function _0x30bb01(_0x33c450){const _0x3d5669=_0x4aca80,_0x265b20=document['getElementById'](_0x3d5669(0x682));_0x265b20[_0x3d5669(0x2f5)]='',_0x33c450[_0x3d5669(0x591)](_0x2e53f5=>{const _0xae83ae=_0x3d5669,_0x414b96=document[_0xae83ae(0x28a)](_0xae83ae(0x11f4));_0x414b96[_0xae83ae(0x82c)]=_0xae83ae(0x105f),_0x414b96[_0xae83ae(0xc9f)][_0xae83ae(0x531)]=_0x2e53f5['id'];const _0x5e129f=_0x2e53f5[_0xae83ae(0x10c9)]||(_0x9ebf46[_0xae83ae(0x547)][_0x2e53f5['id']]?_0x9ebf46['chats'][_0x2e53f5['id']][_0xae83ae(0x1131)][_0xae83ae(0xd4d)]:_0x337c8f);_0x414b96[_0xae83ae(0x2f5)]=_0xae83ae(0x12ac)+_0x5e129f+_0xae83ae(0xdf4)+_0x2e53f5[_0xae83ae(0x1132)]+'\x22><div\x20class=\x22member-name\x22>'+_0x2e53f5[_0xae83ae(0x1132)]+_0xae83ae(0x103c),_0x414b96[_0xae83ae(0xa0f)](_0xae83ae(0xf5c),()=>_0x4ffb13(_0x2e53f5['id'])),_0x265b20[_0xae83ae(0x7b9)](_0x414b96);});}document[_0x4aca80(0x9c8)](_0x4aca80(0x48d))[_0x4aca80(0xa0f)]('click',async()=>{const _0x2172e8=_0x4aca80;if(!_0x57617b)return;const _0x3752c0=_0x9ebf46['chats'][_0x9ebf46['activeChatId']],_0x190e87=_0x3752c0[_0x2172e8(0xd3e)][_0x2172e8(0xfc3)](_0x303037=>_0x303037['id']===_0x57617b);if(!_0x190e87)return;const _0x5e1c3d=document[_0x2172e8(0x9c8)]('member-name-input')[_0x2172e8(0x1155)][_0x2172e8(0x3f1)]();if(!_0x5e1c3d){alert(_0x2172e8(0x5e2));return;}_0x190e87[_0x2172e8(0x1132)]=_0x5e1c3d,_0x190e87[_0x2172e8(0xeb1)]=document[_0x2172e8(0x9c8)](_0x2172e8(0x483))[_0x2172e8(0x1155)];const _0x5d34d3=document[_0x2172e8(0x9c8)](_0x2172e8(0x843))['src'];_0x190e87['avatar']=_0x5d34d3;const _0x234be4=_0x9ebf46['chats'][_0x190e87['id']];_0x234be4&&(_0x234be4[_0x2172e8(0x1131)][_0x2172e8(0xd4d)]=_0x5d34d3,await _0x2c5bcf[_0x2172e8(0x547)][_0x2172e8(0xff5)](_0x234be4)),await _0x2c5bcf[_0x2172e8(0x547)][_0x2172e8(0xff5)](_0x3752c0),_0x30bb01(_0x3752c0['members']),document[_0x2172e8(0x9c8)](_0x2172e8(0x51c))[_0x2172e8(0x575)][_0x2172e8(0x30f)](_0x2172e8(0xc3f)),_0x57617b=null;});function _0x4ffb13(_0x40b9fe){const _0x560ec3=_0x4aca80;_0x57617b=_0x40b9fe;const _0x13c32a=_0x9ebf46[_0x560ec3(0x547)][_0x9ebf46['activeChatId']],_0x3e9aa4=_0x13c32a[_0x560ec3(0xd3e)][_0x560ec3(0xfc3)](_0x6f63d4=>_0x6f63d4['id']===_0x40b9fe);if(!_0x3e9aa4)return;document[_0x560ec3(0x9c8)](_0x560ec3(0x92f))[_0x560ec3(0x1155)]=_0x3e9aa4[_0x560ec3(0x1132)],document['getElementById'](_0x560ec3(0x483))[_0x560ec3(0x1155)]=_0x3e9aa4[_0x560ec3(0xeb1)];const _0x4a6a96=_0x3e9aa4['avatar']||(_0x9ebf46[_0x560ec3(0x547)][_0x3e9aa4['id']]?_0x9ebf46[_0x560ec3(0x547)][_0x3e9aa4['id']]['settings'][_0x560ec3(0xd4d)]:_0x337c8f);document[_0x560ec3(0x9c8)](_0x560ec3(0x843))[_0x560ec3(0xbf4)]=_0x4a6a96,document[_0x560ec3(0x9c8)]('member-settings-modal')['classList'][_0x560ec3(0x68e)](_0x560ec3(0xc3f));}document[_0x4aca80(0x9c8)](_0x4aca80(0x1bf))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x599d21=_0x4aca80;document['getElementById'](_0x599d21(0x51c))[_0x599d21(0x575)][_0x599d21(0x30f)](_0x599d21(0xc3f)),_0x57617b=null;}),document[_0x4aca80(0x9c8)](_0x4aca80(0x48d))['addEventListener']('click',async()=>{const _0x1e282f=_0x4aca80;if(!_0x57617b)return;const _0x20734c=_0x9ebf46['chats'][_0x9ebf46['activeChatId']],_0x1c50b7=_0x20734c[_0x1e282f(0xd3e)][_0x1e282f(0xfc3)](_0x4e6d3c=>_0x4e6d3c['id']===_0x57617b);if(!_0x1c50b7)return;const _0x557ad6=document['getElementById'](_0x1e282f(0x92f))[_0x1e282f(0x1155)][_0x1e282f(0x3f1)]();if(!_0x557ad6){alert(_0x1e282f(0x5e2));return;}_0x1c50b7[_0x1e282f(0x1132)]=_0x557ad6,_0x1c50b7[_0x1e282f(0xeb1)]=document[_0x1e282f(0x9c8)]('member-persona-input')[_0x1e282f(0x1155)];const _0x343fdd=document['getElementById'](_0x1e282f(0x843))[_0x1e282f(0xbf4)];_0x1c50b7[_0x1e282f(0x10c9)]=_0x343fdd;const _0x459720=_0x9ebf46[_0x1e282f(0x547)][_0x1c50b7['id']];_0x459720&&(_0x459720[_0x1e282f(0x1131)][_0x1e282f(0xd4d)]=_0x343fdd,await _0x2c5bcf['chats'][_0x1e282f(0xff5)](_0x459720)),await _0x2c5bcf[_0x1e282f(0x547)][_0x1e282f(0xff5)](_0x20734c),_0x30bb01(_0x20734c[_0x1e282f(0xd3e)]),document[_0x1e282f(0x9c8)](_0x1e282f(0x51c))[_0x1e282f(0x575)][_0x1e282f(0x30f)](_0x1e282f(0xc3f)),_0x57617b=null;}),document[_0x4aca80(0x9c8)]('reset-theme-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x577e62=_0x4aca80;document[_0x577e62(0x9c8)](_0x577e62(0xd7b))[_0x577e62(0x1ec)]=!![];}),document[_0x4aca80(0x9c8)](_0x4aca80(0xd32))['addEventListener'](_0x4aca80(0xf5c),async()=>{const _0x1fb0e8=_0x4aca80;if(!_0x9ebf46[_0x1fb0e8(0x970)])return;const _0x5f4001=_0x9ebf46['chats'][_0x9ebf46[_0x1fb0e8(0x970)]],_0x298bc7=_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0x95b)]||![],_0x3ede7a=document[_0x1fb0e8(0x9c8)]('chat-name-input')['value'][_0x1fb0e8(0x3f1)]();if(!_0x3ede7a)return alert(_0x1fb0e8(0xf2b));if(!_0x5f4001[_0x1fb0e8(0x11e4)]&&_0x3ede7a!==_0x5f4001[_0x1fb0e8(0x609)]){if(!_0x5f4001['nameHistory'])_0x5f4001[_0x1fb0e8(0xd4f)]=[];if(!_0x5f4001[_0x1fb0e8(0xd4f)][_0x1fb0e8(0x930)](_0x5f4001[_0x1fb0e8(0x609)]))_0x5f4001[_0x1fb0e8(0xd4f)][_0x1fb0e8(0x668)](_0x5f4001[_0x1fb0e8(0x609)]);}_0x5f4001[_0x1fb0e8(0x609)]=_0x3ede7a;const _0x1bcd3a=document[_0x1fb0e8(0x91d)]('input[name=\x22theme-select\x22]:checked');_0x5f4001['settings'][_0x1fb0e8(0x56d)]=_0x1bcd3a?_0x1bcd3a['value']:'default',_0x5f4001[_0x1fb0e8(0x1131)]['fontSize']=parseInt(document['getElementById'](_0x1fb0e8(0xfb6))[_0x1fb0e8(0x1155)]),_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0xc83)]=document[_0x1fb0e8(0x9c8)]('custom-css-input')[_0x1fb0e8(0x1155)][_0x1fb0e8(0x3f1)](),_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0x1151)]=document['getElementById']('my-persona')[_0x1fb0e8(0x1155)],_0x5f4001['settings'][_0x1fb0e8(0xb60)]=document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0xa98))[_0x1fb0e8(0xbf4)],_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0x132a)]=parseInt(document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0x4df))[_0x1fb0e8(0x1155)])||0xa,_0x5f4001['settings'][_0x1fb0e8(0xf9f)]=parseInt(document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0xdb1))['value'])||0xa;const _0x1e5ee0=document[_0x1fb0e8(0x7e4)]('#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked'),_0x4a4329=[];_0x1e5ee0[_0x1fb0e8(0x591)](_0x5bd1c0=>{const _0x2bd66c=_0x1fb0e8;_0x5bd1c0[_0x2bd66c(0x1155)][_0x2bd66c(0xc8d)](_0x2bd66c(0x8de))&&_0x4a4329[_0x2bd66c(0x668)](_0x5bd1c0[_0x2bd66c(0x1155)]['replace'](_0x2bd66c(0x8de),''));}),_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0x41a)]=_0x4a4329;const _0x24269f=document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0x136d))[_0x1fb0e8(0x1ec)];if(_0x24269f){const _0x5c65be=document[_0x1fb0e8(0x7e4)]('#linked-chats-checkboxes-container\x20input:checked');_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0xfeb)]=Array['from'](_0x5c65be)[_0x1fb0e8(0xa3b)](_0x481e44=>_0x481e44[_0x1fb0e8(0x1155)]);}else _0x5f4001[_0x1fb0e8(0x1131)]['linkedMemoryChatIds']=[];_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0x10df)]=document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0x9e9))[_0x1fb0e8(0x1ec)],_0x5f4001[_0x1fb0e8(0x1131)]['autoMemoryInterval']=parseInt(document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0x57c))['value'])||0x14,_0x5f4001[_0x1fb0e8(0x1131)]['enableTimePerception']=document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0xc31))[_0x1fb0e8(0x1ec)],_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0x11ee)]=document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0x39b))[_0x1fb0e8(0x1155)];if(_0x5f4001[_0x1fb0e8(0x11e4)])_0x5f4001['settings'][_0x1fb0e8(0x22a)]=document[_0x1fb0e8(0x9c8)]('group-background-activity-switch')[_0x1fb0e8(0x1ec)],_0x5f4001['settings'][_0x1fb0e8(0x29c)]=document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0x13b6))[_0x1fb0e8(0x1155)][_0x1fb0e8(0x3f1)](),_0x5f4001['settings'][_0x1fb0e8(0xa79)]=document[_0x1fb0e8(0x9c8)]('group-avatar-preview')['src'],_0x5f4001['settings']['actionCooldownMinutes']=parseInt(document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0xa12))['value'])||0xa;else{_0x5f4001[_0x1fb0e8(0x1131)]['enableBackgroundActivity']=document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0x743))[_0x1fb0e8(0x1ec)];const _0x598340=document[_0x1fb0e8(0x9c8)]('offline-mode-toggle')[_0x1fb0e8(0x1ec)];_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0x95b)]=_0x598340;if(_0x298bc7===!![]&&_0x598340===![]){const _0x4090db={'role':_0x1fb0e8(0xb64),'content':_0x1fb0e8(0x6f1),'timestamp':Date[_0x1fb0e8(0x9b7)](),'isHidden':!![]};_0x5f4001[_0x1fb0e8(0x8b3)]['push'](_0x4090db),console['log'](_0x1fb0e8(0x127b));}_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0x31f)]=document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0xf9d))['checked'],_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0xa82)]=parseInt(document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0x511))[_0x1fb0e8(0x1155)])||0x64,_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0x94a)]=parseInt(document[_0x1fb0e8(0x9c8)]('offline-max-length-input')[_0x1fb0e8(0x1155)])||0x12c,_0x5f4001['settings']['offlinePresetId']=document[_0x1fb0e8(0x9c8)]('offline-preset-select')['value']||null;const _0x426bdd=document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0xdc2))[_0x1fb0e8(0x1155)][_0x1fb0e8(0x3f1)]();if(!_0x426bdd)return alert('对方本名不能为空！');_0x5f4001['originalName']=_0x426bdd,_0x5f4001['settings'][_0x1fb0e8(0xae3)]=document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0x72a))[_0x1fb0e8(0x1155)],_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0x8c1)]=document['getElementById'](_0x1fb0e8(0xb42))[_0x1fb0e8(0x1155)][_0x1fb0e8(0x3f1)](),_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0xd80)]=document[_0x1fb0e8(0x9c8)]('enable-tts-switch')[_0x1fb0e8(0x1ec)],_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0xd4d)]=document['getElementById'](_0x1fb0e8(0x347))[_0x1fb0e8(0xbf4)],_0x5f4001['settings'][_0x1fb0e8(0x29c)]=document['getElementById'](_0x1fb0e8(0x1008))['value']['trim']()||'我',_0x5f4001[_0x1fb0e8(0x1131)][_0x1fb0e8(0x664)]=parseInt(document[_0x1fb0e8(0x9c8)]('ai-action-cooldown-input')[_0x1fb0e8(0x1155)])||0xa,_0x5f4001['settings']['lyricsPosition']={'vertical':document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0xa02))[_0x1fb0e8(0x1155)],'horizontal':document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0x42b))[_0x1fb0e8(0x1155)],'offset':parseInt(document[_0x1fb0e8(0x9c8)](_0x1fb0e8(0x1015))[_0x1fb0e8(0x1155)])||0xa};const _0x46c09c=document['getElementById'](_0x1fb0e8(0x120e))[_0x1fb0e8(0x1155)];_0x5f4001[_0x1fb0e8(0x7b1)]=_0x46c09c?parseInt(_0x46c09c):null;}await _0x2c5bcf[_0x1fb0e8(0x547)][_0x1fb0e8(0xff5)](_0x5f4001),!_0x5f4001[_0x1fb0e8(0x11e4)]&&(await _0x5eaa16(_0x5f4001),await _0x177091(_0x5f4001)),_0x3eb3d2(_0x5f4001),_0x144843(_0x5f4001[_0x1fb0e8(0x1131)]['customCss'],_0x1fb0e8(0xcd6),'custom-bubble-style'),_0xe5834e(_0x1fb0e8(0x504)),_0x1a44b1(_0x9ebf46[_0x1fb0e8(0x970)]),_0x394b2c();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x3bc))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x15a18a=>{const _0x1ba6ab=_0x4aca80;_0x15a18a[_0x1ba6ab(0x1070)][_0x1ba6ab(0x575)][_0x1ba6ab(0x1038)]('change-frame-btn')&&_0x5446cd(_0x1ba6ab(0x8b0));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x51c))['addEventListener'](_0x4aca80(0xf5c),_0x590069=>{const _0x168b38=_0x4aca80;_0x590069['target'][_0x168b38(0x575)][_0x168b38(0x1038)](_0x168b38(0x7e2))&&_0x5446cd(_0x168b38(0x43b));});const _0x2d344=document[_0x4aca80(0x9c8)](_0x4aca80(0xbd9)),_0x4a4bf5=document[_0x4aca80(0x9c8)](_0x4aca80(0x197)),_0x839f06=document[_0x4aca80(0x9c8)](_0x4aca80(0x11ab)),_0x4fb1d9=document[_0x4aca80(0x9c8)](_0x4aca80(0xd25)),_0x427763=document[_0x4aca80(0x9c8)]('my-frame-content');document[_0x4aca80(0x9c8)](_0x4aca80(0xd5a))[_0x4aca80(0xa0f)]('click',_0x46cb1a),document[_0x4aca80(0x9c8)](_0x4aca80(0x9d3))['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x23e3a3=_0x4aca80;_0x2d344['classList'][_0x23e3a3(0x30f)](_0x23e3a3(0xc3f)),_0x4972c5=![];}),_0x4a4bf5[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x2a0718=_0x4aca80;_0x4a4bf5['classList']['add'](_0x2a0718(0x113d)),_0x839f06['classList'][_0x2a0718(0x30f)](_0x2a0718(0x113d)),_0x4fb1d9['style']['display']=_0x2a0718(0x3d9),_0x427763[_0x2a0718(0x5e1)][_0x2a0718(0x3c5)]='none';}),_0x839f06[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x57446c=_0x4aca80;_0x839f06[_0x57446c(0x575)][_0x57446c(0x68e)](_0x57446c(0x113d)),_0x4a4bf5['classList'][_0x57446c(0x30f)](_0x57446c(0x113d)),_0x427763[_0x57446c(0x5e1)][_0x57446c(0x3c5)]=_0x57446c(0x3d9),_0x4fb1d9['style'][_0x57446c(0x3c5)]=_0x57446c(0x8f6);}),document[_0x4aca80(0x9c8)]('clear-chat-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x587c47=_0x4aca80;if(!_0x9ebf46[_0x587c47(0x970)])return;const _0x5191b3=_0x9ebf46['chats'][_0x9ebf46[_0x587c47(0x970)]],_0x34c494=await _0x352ae9('清空聊天记录',_0x587c47(0xe21),{'confirmButtonClass':'btn-danger'});_0x34c494&&(_0x5191b3[_0x587c47(0x8b3)]=[],_0x5191b3['heartfeltVoice']='...',_0x5191b3['randomJottings']=_0x587c47(0xf66),await _0x2c5bcf[_0x587c47(0x547)][_0x587c47(0xff5)](_0x5191b3),_0x1a44b1(_0x9ebf46['activeChatId']),_0x394b2c(),_0x11ab5d['classList'][_0x587c47(0x30f)](_0x587c47(0xc3f)));});const _0x2af862=(_0x3b9298,_0x1f2aa5)=>{const _0x4f3a03=_0x4aca80;document[_0x4f3a03(0x9c8)](_0x3b9298)[_0x4f3a03(0xa0f)](_0x4f3a03(0x25c),async _0x3d3fef=>{const _0x18674e=_0x4f3a03,_0x2dfdd4=_0x3d3fef[_0x18674e(0x1070)][_0x18674e(0x1216)][0x0];if(_0x2dfdd4){const _0x473f86=await new Promise((_0x45782a,_0x41f2e4)=>{const _0x24115a=_0x18674e,_0x20a04e=new FileReader();_0x20a04e[_0x24115a(0x429)]=()=>_0x45782a(_0x20a04e[_0x24115a(0xceb)]),_0x20a04e[_0x24115a(0x11e5)]=()=>_0x41f2e4(_0x20a04e[_0x24115a(0x1221)]),_0x20a04e[_0x24115a(0xba5)](_0x2dfdd4);});_0x1f2aa5(_0x473f86),_0x3d3fef[_0x18674e(0x1070)][_0x18674e(0x1155)]=null;}});};_0x2af862(_0x4aca80(0x2b3),_0x4721e1=>document['getElementById']('ai-avatar-preview')[_0x4aca80(0xbf4)]=_0x4721e1),_0x2af862(_0x4aca80(0x77f),_0xd24ac1=>document[_0x4aca80(0x9c8)](_0x4aca80(0xa98))['src']=_0xd24ac1),_0x2af862(_0x4aca80(0x1115),_0x5997ba=>document[_0x4aca80(0x9c8)](_0x4aca80(0x194))[_0x4aca80(0xbf4)]=_0x5997ba),_0x2af862(_0x4aca80(0xa70),_0x2a6490=>document[_0x4aca80(0x9c8)](_0x4aca80(0x843))['src']=_0x2a6490),_0x2af862('bg-input',_0x28353f=>{const _0x24562f=_0x4aca80;if(_0x9ebf46[_0x24562f(0x970)]){_0x9ebf46[_0x24562f(0x547)][_0x9ebf46[_0x24562f(0x970)]]['settings'][_0x24562f(0x93f)]=_0x28353f;const _0x2b6d29=document[_0x24562f(0x9c8)](_0x24562f(0xfd8));_0x2b6d29['src']=_0x28353f,_0x2b6d29[_0x24562f(0x5e1)][_0x24562f(0x3c5)]=_0x24562f(0x3d9),document[_0x24562f(0x9c8)](_0x24562f(0x1275))[_0x24562f(0x5e1)][_0x24562f(0x3c5)]=_0x24562f(0xf6c);}}),_0x2af862('preset-avatar-input',_0x4f025e=>document[_0x4aca80(0x9c8)]('preset-avatar-preview')[_0x4aca80(0xbf4)]=_0x4f025e),document[_0x4aca80(0x9c8)](_0x4aca80(0x1275))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x17e9c8=_0x4aca80;if(_0x9ebf46[_0x17e9c8(0x970)]){_0x9ebf46[_0x17e9c8(0x547)][_0x9ebf46[_0x17e9c8(0x970)]][_0x17e9c8(0x1131)][_0x17e9c8(0x93f)]='';const _0x553cbf=document[_0x17e9c8(0x9c8)]('bg-preview');_0x553cbf[_0x17e9c8(0xbf4)]='',_0x553cbf['style'][_0x17e9c8(0x3c5)]='none',document[_0x17e9c8(0x9c8)]('remove-bg-btn')['style'][_0x17e9c8(0x3c5)]='none';}});const _0x52efd3=document[_0x4aca80(0x9c8)]('sticker-panel');document[_0x4aca80(0x9c8)](_0x4aca80(0xeb0))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x251e74=_0x4aca80,_0x11fa66=_0x9ebf46[_0x251e74(0x547)][_0x9ebf46[_0x251e74(0x970)]];_0x11fa66&&_0x11fa66[_0x251e74(0x1131)][_0x251e74(0x1223)]?_0x55c803=_0x11fa66[_0x251e74(0x1131)]['stickerCategoryId']:_0x55c803=_0x251e74(0xd0a),_0x43920d(),_0x52efd3['classList'][_0x251e74(0x68e)](_0x251e74(0xc3f));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xcff))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>_0x52efd3[_0x4aca80(0x575)][_0x4aca80(0x30f)](_0x4aca80(0xc3f))),document[_0x4aca80(0x9c8)](_0x4aca80(0xe6b))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x4077ba),document[_0x4aca80(0x9c8)]('upload-sticker-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>document['getElementById'](_0x4aca80(0x3dc))['click']()),document['getElementById'](_0x4aca80(0x3dc))[_0x4aca80(0xa0f)]('change',async _0x5036d8=>{const _0x2cc378=_0x4aca80,_0x5f33da=_0x5036d8[_0x2cc378(0x1070)][_0x2cc378(0x1216)][0x0];if(!_0x5f33da)return;const _0x52fa63=new FileReader();_0x52fa63['readAsDataURL'](_0x5f33da),_0x52fa63[_0x2cc378(0x429)]=async()=>{const _0x33a4df=_0x2cc378,_0x4ca30a=_0x52fa63['result'],_0x561702=await _0xadb5df(_0x33a4df(0x1247),'请为这个表情命名\x20(例如：好耶、疑惑)');if(_0x561702&&_0x561702['trim']()){const _0x51548f={'id':_0x33a4df(0x3fe)+Date[_0x33a4df(0x9b7)](),'url':_0x4ca30a,'name':_0x561702[_0x33a4df(0x3f1)](),'categoryId':_0x55c803!==_0x33a4df(0xd0a)&&_0x55c803!==_0x33a4df(0x247)?_0x55c803:null};await _0x2c5bcf[_0x33a4df(0x774)][_0x33a4df(0x68e)](_0x51548f),_0x9ebf46['userStickers']['push'](_0x51548f),_0x43920d();}else{if(_0x561702!==null)alert(_0x33a4df(0x3f4));}},_0x5036d8['target'][_0x2cc378(0x1155)]=null;}),document['getElementById'](_0x4aca80(0x10b1))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>document['getElementById']('image-upload-input')[_0x4aca80(0xf5c)]()),document[_0x4aca80(0x9c8)](_0x4aca80(0x596))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),async _0x305fea=>{const _0x4978ab=_0x4aca80,_0x26da1b=_0x305fea[_0x4978ab(0x1070)][_0x4978ab(0x1216)][0x0];if(!_0x26da1b||!_0x9ebf46['activeChatId'])return;const _0x2165b9=new FileReader();_0x2165b9[_0x4978ab(0x429)]=async _0x5ca671=>{const _0x4fc52d=_0x4978ab,_0x5c4093=_0x5ca671[_0x4fc52d(0x1070)][_0x4fc52d(0xceb)],_0x76d4=_0x9ebf46['chats'][_0x9ebf46['activeChatId']],_0x5bc85b={'role':_0x4fc52d(0x586),'content':[{'type':'image_url','image_url':{'url':_0x5c4093}}],'timestamp':Date[_0x4fc52d(0x9b7)]()};_0x76d4['history'][_0x4fc52d(0x668)](_0x5bc85b),await _0x2c5bcf['chats'][_0x4fc52d(0xff5)](_0x76d4),_0xc4e879(_0x5bc85b,_0x76d4),_0x394b2c();},_0x2165b9[_0x4978ab(0xba5)](_0x26da1b),_0x305fea['target'][_0x4978ab(0x1155)]=null;}),document[_0x4aca80(0x9c8)](_0x4aca80(0xa1c))['addEventListener'](_0x4aca80(0xf5c),async()=>{const _0x6396f2=_0x4aca80;if(!_0x9ebf46[_0x6396f2(0x970)])return;const _0x2090e1=await _0xadb5df(_0x6396f2(0x3b5),_0x6396f2(0xb75));if(_0x2090e1&&_0x2090e1[_0x6396f2(0x3f1)]()){const _0x34d4c9=_0x9ebf46[_0x6396f2(0x547)][_0x9ebf46[_0x6396f2(0x970)]],_0x5103d4={'role':'user','type':_0x6396f2(0x10c1),'content':_0x2090e1[_0x6396f2(0x3f1)](),'timestamp':Date[_0x6396f2(0x9b7)]()};_0x34d4c9[_0x6396f2(0x8b3)][_0x6396f2(0x668)](_0x5103d4),await _0x2c5bcf[_0x6396f2(0x547)][_0x6396f2(0xff5)](_0x34d4c9),_0xc4e879(_0x5103d4,_0x34d4c9),_0x394b2c();}}),document[_0x4aca80(0x9c8)]('send-photo-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x42c876=_0x4aca80;if(!_0x9ebf46['activeChatId'])return;const _0x9e7a9e=await _0xadb5df('发送照片','请用文字描述您要发送的照片：');if(_0x9e7a9e&&_0x9e7a9e[_0x42c876(0x3f1)]()){const _0x372488=_0x9ebf46[_0x42c876(0x547)][_0x9ebf46[_0x42c876(0x970)]],_0x21ad33={'role':_0x42c876(0x586),'type':_0x42c876(0x560),'content':_0x9e7a9e['trim'](),'timestamp':Date['now']()};_0x372488['history']['push'](_0x21ad33),await _0x2c5bcf[_0x42c876(0x547)]['put'](_0x372488),_0xc4e879(_0x21ad33,_0x372488),_0x394b2c();}});const _0x202725=document['getElementById'](_0x4aca80(0xadb));document['getElementById']('send-waimai-request-btn')['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x1420e9=_0x4aca80;_0x202725[_0x1420e9(0x575)][_0x1420e9(0x68e)](_0x1420e9(0xc3f));}),_0x202725[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2b72f0=>{const _0x28dfc8=_0x4aca80;_0x2b72f0[_0x28dfc8(0x1070)]===_0x202725&&_0x202725[_0x28dfc8(0x575)][_0x28dfc8(0x30f)](_0x28dfc8(0xc3f));}),document['getElementById'](_0x4aca80(0x10c8))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x8d3042),document[_0x4aca80(0x9c8)](_0x4aca80(0x357))['addEventListener'](_0x4aca80(0xf5c),async()=>{const _0x56c672=_0x4aca80;if(!_0x9ebf46['activeChatId'])return;const _0x1f5572=document[_0x56c672(0x9c8)](_0x56c672(0x23f)),_0x4c0014=document[_0x56c672(0x9c8)]('waimai-amount'),_0x5125cf=_0x1f5572[_0x56c672(0x1155)][_0x56c672(0x3f1)](),_0x5a4467=parseFloat(_0x4c0014['value']);if(!_0x5125cf||isNaN(_0x5a4467)||_0x5a4467<=0x0){alert(_0x56c672(0x10c4));return;}const _0x2ed384=_0x9ebf46[_0x56c672(0x547)][_0x9ebf46[_0x56c672(0x970)]],_0x44c1b8=Date[_0x56c672(0x9b7)](),_0x46b930=_0x2ed384['isGroup']?_0x2ed384[_0x56c672(0x1131)]['myNickname']||'我':'我',_0x47260c={'role':_0x56c672(0x586),'senderName':_0x46b930,'type':_0x56c672(0x12d4),'productInfo':_0x5125cf,'amount':_0x5a4467,'status':_0x56c672(0xcf8),'countdownEndTime':_0x44c1b8+0xf*0x3c*0x3e8,'timestamp':_0x44c1b8};_0x2ed384[_0x56c672(0x8b3)][_0x56c672(0x668)](_0x47260c),await _0x2c5bcf[_0x56c672(0x547)][_0x56c672(0xff5)](_0x2ed384),_0xc4e879(_0x47260c,_0x2ed384),_0x394b2c(),_0x1f5572['value']='',_0x4c0014[_0x56c672(0x1155)]='',_0x202725[_0x56c672(0x575)][_0x56c672(0x30f)](_0x56c672(0xc3f));}),document['getElementById']('open-persona-library-btn')[_0x4aca80(0xa0f)]('click',_0x55bb50),document[_0x4aca80(0x9c8)]('close-persona-library-btn')['addEventListener'](_0x4aca80(0xf5c),_0x525a6e),document[_0x4aca80(0x9c8)](_0x4aca80(0xe9f))[_0x4aca80(0xa0f)]('click',_0x17b66d),document[_0x4aca80(0x9c8)]('cancel-persona-editor-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3b4559),document[_0x4aca80(0x9c8)](_0x4aca80(0x655))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x53cd90),document['getElementById'](_0x4aca80(0x949))['addEventListener'](_0x4aca80(0xf5c),_0x134bed),document[_0x4aca80(0x9c8)]('preset-action-delete')['addEventListener'](_0x4aca80(0xf5c),_0x19f270),document[_0x4aca80(0x9c8)](_0x4aca80(0x576))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3e45cc),document[_0x4aca80(0x9c8)](_0x4aca80(0x73f))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2d6552),document[_0x4aca80(0x9c8)](_0x4aca80(0x273))['addEventListener']('click',async()=>{const _0xd9914b=_0x4aca80;if(_0x24fb08[_0xd9914b(0xa67)]===0x0)return;const _0x5704cf=await _0x352ae9('删除消息','确定要删除选中的\x20'+_0x24fb08[_0xd9914b(0xa67)]+_0xd9914b(0x105a),{'confirmButtonClass':_0xd9914b(0x12bc)});if(_0x5704cf){const _0x9ccbe2=_0x9ebf46[_0xd9914b(0x547)][_0x9ebf46[_0xd9914b(0x970)]];let _0x2349a2=[];for(const _0x4b3038 of _0x24fb08){const _0x38a50f=_0x9ccbe2[_0xd9914b(0x8b3)]['find'](_0xe9cad7=>_0xe9cad7[_0xd9914b(0x6b5)]===_0x4b3038);_0x38a50f&&_0x38a50f[_0xd9914b(0x12d9)]===_0xd9914b(0xb71)&&_0x2349a2['push'](_0xd9914b(0xe6c)+_0x38a50f[_0xd9914b(0x12f6)]+'”的投票(时间戳:\x20'+_0x38a50f['timestamp']+')');}_0x9ccbe2[_0xd9914b(0x8b3)]=_0x9ccbe2['history']['filter'](_0x12c16a=>!_0x24fb08[_0xd9914b(0xd97)](_0x12c16a['timestamp']));let _0x1ef041='一些之前的消息已被用户删除。';_0x2349a2[_0xd9914b(0xa06)]>0x0&&(_0x1ef041+=_0xd9914b(0x97b)+_0x2349a2[_0xd9914b(0x809)]('；')+'。');_0x1ef041+=_0xd9914b(0xe5e);const _0x1f47cc={'role':_0xd9914b(0xb64),'content':_0xd9914b(0x808)+_0x1ef041+']','timestamp':Date[_0xd9914b(0x9b7)](),'isHidden':!![]};_0x9ccbe2['history']['push'](_0x1f47cc),await _0x2c5bcf[_0xd9914b(0x547)][_0xd9914b(0xff5)](_0x9ccbe2),_0x1a44b1(_0x9ebf46[_0xd9914b(0x970)]),_0x394b2c();}}),document['getElementById'](_0x4aca80(0x29d))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x5938b3=_0x4aca80;if(_0x24fb08[_0x5938b3(0xa67)]===0x0)return;const _0x52f3eb=await _0x352ae9(_0x5938b3(0xc27),_0x5938b3(0x348)+_0x24fb08[_0x5938b3(0xa67)]+'\x20条消息，AI将完全遗忘它们的存在。确定吗？',{'confirmButtonClass':_0x5938b3(0x12bc),'confirmText':_0x5938b3(0x620)});if(_0x52f3eb){const _0x503502=_0x9ebf46['chats'][_0x9ebf46[_0x5938b3(0x970)]];_0x503502['history']=_0x503502['history'][_0x5938b3(0x401)](_0xbcdb5e=>!_0x24fb08[_0x5938b3(0xd97)](_0xbcdb5e[_0x5938b3(0x6b5)])),await _0x2c5bcf[_0x5938b3(0x547)][_0x5938b3(0xff5)](_0x503502),_0x1a44b1(_0x9ebf46[_0x5938b3(0x970)]),_0x394b2c();}});const _0x93bfdc=document[_0x4aca80(0x9c8)](_0x4aca80(0xebe));_0x93bfdc[_0x4aca80(0xa0f)]('input',()=>_0xd42b1c(_0x93bfdc[_0x4aca80(0x1155)][_0x4aca80(0x3f1)](),!![])),document[_0x4aca80(0x9c8)](_0x4aca80(0xf42))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x224009=_0x4aca80,_0x368257=_0x93bfdc[_0x224009(0x1155)][_0x224009(0x3f1)]();if(!_0x368257){alert(_0x224009(0xd12));return;}_0xd42b1c(_0x368257,![]),_0x9ebf46['globalSettings'][_0x224009(0x88a)]=_0x368257,await _0x2c5bcf[_0x224009(0x1383)][_0x224009(0xff5)](_0x9ebf46[_0x224009(0x1383)]),alert(_0x224009(0x5cb));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xc79))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3caa94),document[_0x4aca80(0x7e4)]('#chat-list-bottom-nav\x20.nav-item')[_0x4aca80(0x591)](_0x2fecbc=>{const _0x453d50=_0x4aca80;_0x2fecbc[_0x453d50(0xa0f)](_0x453d50(0xf5c),()=>_0x55787a(_0x2fecbc[_0x453d50(0xc9f)][_0x453d50(0x103a)]));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xebb))[_0x4aca80(0xa0f)]('click',()=>_0x55787a(_0x4aca80(0xbc9))),document[_0x4aca80(0x9c8)]('qzone-nickname')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x31331b=_0x4aca80,_0x8acec5=await _0xadb5df(_0x31331b(0x4da),_0x31331b(0x648),_0x9ebf46[_0x31331b(0x32c)]['nickname']);_0x8acec5&&_0x8acec5[_0x31331b(0x3f1)]()&&(_0x9ebf46[_0x31331b(0x32c)][_0x31331b(0x5b7)]=_0x8acec5[_0x31331b(0x3f1)](),await _0x1a3c11(),_0xf26c4f());}),document[_0x4aca80(0x9c8)](_0x4aca80(0x118e))[_0x4aca80(0xa0f)]('click',()=>document[_0x4aca80(0x9c8)](_0x4aca80(0xd88))[_0x4aca80(0xf5c)]()),document[_0x4aca80(0x9c8)]('qzone-banner-container')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>document[_0x4aca80(0x9c8)](_0x4aca80(0x563))[_0x4aca80(0xf5c)]()),document['getElementById'](_0x4aca80(0xd88))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),async _0x56f171=>{const _0x43f4ad=_0x4aca80,_0x44e866=_0x56f171[_0x43f4ad(0x1070)]['files'][0x0];if(_0x44e866){const _0x133f1b=await new Promise(_0x1ce3ef=>{const _0x171546=_0x43f4ad,_0x5cee=new FileReader();_0x5cee[_0x171546(0x429)]=()=>_0x1ce3ef(_0x5cee[_0x171546(0xceb)]),_0x5cee['readAsDataURL'](_0x44e866);});_0x9ebf46[_0x43f4ad(0x32c)][_0x43f4ad(0x10c9)]=_0x133f1b,await _0x1a3c11(),_0xf26c4f();}_0x56f171[_0x43f4ad(0x1070)]['value']=null;}),document[_0x4aca80(0x9c8)](_0x4aca80(0x563))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),async _0x5a6fd3=>{const _0x1d6dac=_0x4aca80,_0x17c0b6=_0x5a6fd3[_0x1d6dac(0x1070)]['files'][0x0];if(_0x17c0b6){const _0x123ce0=await new Promise(_0x31c67d=>{const _0x257dbb=_0x1d6dac,_0x4f23ea=new FileReader();_0x4f23ea[_0x257dbb(0x429)]=()=>_0x31c67d(_0x4f23ea[_0x257dbb(0xceb)]),_0x4f23ea[_0x257dbb(0xba5)](_0x17c0b6);});_0x9ebf46[_0x1d6dac(0x32c)]['banner']=_0x123ce0,await _0x1a3c11(),_0xf26c4f();}_0x5a6fd3['target'][_0x1d6dac(0x1155)]=null;}),document[_0x4aca80(0x9c8)](_0x4aca80(0xcc1))['addEventListener']('click',async()=>{const _0x594c8d=_0x4aca80;_0x1055ad();const _0x4ac0f4=document[_0x594c8d(0x9c8)](_0x594c8d(0xf6d));_0x4ac0f4[_0x594c8d(0xc9f)][_0x594c8d(0x493)]='shuoshuo',_0x4ac0f4['querySelector'](_0x594c8d(0xb61))[_0x594c8d(0x5e1)][_0x594c8d(0x3c5)]='none',_0x4ac0f4[_0x594c8d(0x91d)](_0x594c8d(0xb35))[_0x594c8d(0x5e1)][_0x594c8d(0x3c5)]=_0x594c8d(0x8f6),_0x4ac0f4[_0x594c8d(0x91d)](_0x594c8d(0x1ce))[_0x594c8d(0x5e1)]['display']='none',_0x4ac0f4['querySelector'](_0x594c8d(0x13bc))[_0x594c8d(0x1047)]=_0x594c8d(0xedb);const _0x32c3ab=document[_0x594c8d(0x9c8)](_0x594c8d(0x1142));_0x32c3ab[_0x594c8d(0x2f5)]='';const _0x95c63b=await _0x2c5bcf[_0x594c8d(0xaf2)]['toArray']();_0x95c63b[_0x594c8d(0xa06)]>0x0?_0x95c63b['forEach'](_0x7b1d21=>{const _0x5b0873=_0x594c8d,_0x58ba19=document[_0x5b0873(0x28a)]('label');_0x58ba19[_0x5b0873(0x5e1)][_0x5b0873(0x3c5)]=_0x5b0873(0x3d9),_0x58ba19['innerHTML']=_0x5b0873(0x3b3)+_0x7b1d21['id']+'\x22>\x20'+_0x7b1d21['name'],_0x32c3ab[_0x5b0873(0x7b9)](_0x58ba19);}):_0x32c3ab[_0x594c8d(0x2f5)]=_0x594c8d(0x1388),_0x4ac0f4['classList'][_0x594c8d(0x68e)]('visible');}),document[_0x4aca80(0x9c8)](_0x4aca80(0x10ec))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x31609f=_0x4aca80;_0x1055ad();const _0x3e8ab3=document[_0x31609f(0x9c8)](_0x31609f(0xf6d));_0x3e8ab3[_0x31609f(0xc9f)]['mode']='complex',_0x3e8ab3[_0x31609f(0x91d)](_0x31609f(0xb61))[_0x31609f(0x5e1)][_0x31609f(0x3c5)]=_0x31609f(0x989),_0x3e8ab3[_0x31609f(0x91d)](_0x31609f(0xb35))[_0x31609f(0x575)][_0x31609f(0x68e)](_0x31609f(0x113d)),_0x3e8ab3[_0x31609f(0x91d)](_0x31609f(0x1ce))[_0x31609f(0x575)][_0x31609f(0x30f)](_0x31609f(0x113d)),_0x3e8ab3[_0x31609f(0x91d)](_0x31609f(0x13bc))['placeholder']=_0x31609f(0xecd);const _0x2f0de1=document['getElementById']('post-visibility-groups');_0x2f0de1[_0x31609f(0x2f5)]='';const _0x22c3c9=await _0x2c5bcf[_0x31609f(0xaf2)][_0x31609f(0x5ff)]();_0x22c3c9['length']>0x0?_0x22c3c9['forEach'](_0x13fd36=>{const _0x3c0865=_0x31609f,_0x329a74=document['createElement'](_0x3c0865(0x13c5));_0x329a74[_0x3c0865(0x5e1)][_0x3c0865(0x3c5)]='block',_0x329a74['innerHTML']=_0x3c0865(0x3b3)+_0x13fd36['id']+_0x3c0865(0x2f9)+_0x13fd36['name'],_0x2f0de1['appendChild'](_0x329a74);}):_0x2f0de1[_0x31609f(0x2f5)]=_0x31609f(0x1388),_0x3e8ab3[_0x31609f(0x575)][_0x31609f(0x68e)]('visible');}),document[_0x4aca80(0x9c8)](_0x4aca80(0x100c))['addEventListener'](_0x4aca80(0xf5c),async()=>{const _0x4bbcf6=_0x4aca80;await _0x178ddd(),_0xe5834e(_0x4bbcf6(0x13ab));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x3eb))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x6fad19=_0x4aca80;_0xe5834e(_0x6fad19(0x1056)),_0x55787a(_0x6fad19(0x81c));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xfa0))['addEventListener'](_0x4aca80(0xf5c),()=>{const _0xaf9cf5=_0x4aca80;_0x9ebf46[_0xaf9cf5(0x129e)]=null,_0xe5834e(_0xaf9cf5(0x13ab));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x2cc))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>document[_0x4aca80(0x9c8)](_0x4aca80(0x9a3))[_0x4aca80(0xf5c)]()),document[_0x4aca80(0x9c8)](_0x4aca80(0x9a3))['addEventListener'](_0x4aca80(0x25c),async _0x4d32be=>{const _0x2da3a5=_0x4aca80;if(!_0x9ebf46[_0x2da3a5(0x129e)])return;const _0x45cbfb=_0x4d32be[_0x2da3a5(0x1070)]['files'];if(!_0x45cbfb['length'])return;const _0x5a414c=await _0x2c5bcf[_0x2da3a5(0x6dc)][_0x2da3a5(0xdf9)](_0x9ebf46['activeAlbumId']);for(const _0x1a6f18 of _0x45cbfb){const _0x39f407=await new Promise(_0x18f3a3=>{const _0x3faec5=_0x2da3a5,_0x1f02f7=new FileReader();_0x1f02f7[_0x3faec5(0x429)]=()=>_0x18f3a3(_0x1f02f7[_0x3faec5(0xceb)]),_0x1f02f7['readAsDataURL'](_0x1a6f18);});await _0x2c5bcf['qzonePhotos'][_0x2da3a5(0x68e)]({'albumId':_0x9ebf46[_0x2da3a5(0x129e)],'url':_0x39f407,'createdAt':Date[_0x2da3a5(0x9b7)]()});}const _0x3dd63b=await _0x2c5bcf[_0x2da3a5(0x373)][_0x2da3a5(0xe78)]('albumId')[_0x2da3a5(0xda9)](_0x9ebf46[_0x2da3a5(0x129e)])['count'](),_0x4ab27d={'photoCount':_0x3dd63b};if(!_0x5a414c['photoCount']||_0x5a414c[_0x2da3a5(0x722)][_0x2da3a5(0x930)]('placeholder')){const _0x36cb40=await _0x2c5bcf[_0x2da3a5(0x373)][_0x2da3a5(0xe78)](_0x2da3a5(0x2d5))[_0x2da3a5(0xda9)](_0x9ebf46[_0x2da3a5(0x129e)])[_0x2da3a5(0x476)]();if(_0x36cb40)_0x4ab27d['coverUrl']=_0x36cb40[_0x2da3a5(0x11be)];}await _0x2c5bcf['qzoneAlbums']['update'](_0x9ebf46['activeAlbumId'],_0x4ab27d),await _0x33fed7(),await _0x178ddd(),_0x4d32be[_0x2da3a5(0x1070)]['value']=null,alert(_0x2da3a5(0xa25));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x59e))[_0x4aca80(0xa0f)]('click',async _0x3d0f7b=>{const _0x22c18b=_0x4aca80,_0x2c0f8c=_0x3d0f7b[_0x22c18b(0x1070)][_0x22c18b(0xaa0)](_0x22c18b(0xc3c)),_0x42e39f=_0x3d0f7b[_0x22c18b(0x1070)][_0x22c18b(0xaa0)]('.photo-thumb');if(_0x2c0f8c){_0x3d0f7b['stopPropagation']();const _0x3ba4e4=parseInt(_0x2c0f8c[_0x22c18b(0xc9f)]['photoId']),_0x2edb44=await _0x352ae9(_0x22c18b(0x1325),'确定要删除这张照片吗？此操作不可恢复。',{'confirmButtonClass':_0x22c18b(0x12bc)});if(_0x2edb44){const _0x11f473=await _0x2c5bcf['qzonePhotos'][_0x22c18b(0xdf9)](_0x3ba4e4);if(!_0x11f473)return;await _0x2c5bcf['qzonePhotos']['delete'](_0x3ba4e4);const _0x1dbf1e=await _0x2c5bcf[_0x22c18b(0x6dc)]['get'](_0x9ebf46[_0x22c18b(0x129e)]),_0x1ff4d8=(_0x1dbf1e[_0x22c18b(0x821)]||0x1)-0x1,_0x1948dd={'photoCount':_0x1ff4d8};if(_0x1dbf1e[_0x22c18b(0x722)]===_0x11f473['url']){const _0x1f6588=await _0x2c5bcf[_0x22c18b(0x373)][_0x22c18b(0xe78)](_0x22c18b(0x2d5))['equals'](_0x9ebf46[_0x22c18b(0x129e)])[_0x22c18b(0x476)]();_0x1948dd[_0x22c18b(0x722)]=_0x1f6588?_0x1f6588['url']:_0x22c18b(0xfec);}await _0x2c5bcf[_0x22c18b(0x6dc)][_0x22c18b(0x13a4)](_0x9ebf46[_0x22c18b(0x129e)],_0x1948dd),await _0x33fed7(),await _0x178ddd(),alert(_0x22c18b(0x83b));}}else _0x42e39f&&_0x4a3dab(_0x42e39f[_0x22c18b(0xbf4)]);}),document[_0x4aca80(0x9c8)](_0x4aca80(0x1278))['addEventListener']('click',_0xbe1012),document[_0x4aca80(0x9c8)](_0x4aca80(0xf04))['addEventListener'](_0x4aca80(0xf5c),_0x171ef2),document['getElementById']('photo-viewer-prev-btn')[_0x4aca80(0xa0f)]('click',_0x5b1734),document['addEventListener'](_0x4aca80(0xd59),_0x3633e5=>{const _0x132e03=_0x4aca80;if(!_0x5daebe[_0x132e03(0x84b)])return;if(_0x3633e5['key']===_0x132e03(0x587))_0x171ef2();else{if(_0x3633e5[_0x132e03(0x7e5)]==='ArrowLeft')_0x5b1734();else _0x3633e5['key']==='Escape'&&_0xbe1012();}}),document['getElementById'](_0x4aca80(0xd36))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0xc6967b=_0x4aca80,_0x3139ea=await _0xadb5df(_0xc6967b(0x7ff),_0xc6967b(0xaa7));if(_0x3139ea&&_0x3139ea[_0xc6967b(0x3f1)]()){const _0x4d01ba={'name':_0x3139ea[_0xc6967b(0x3f1)](),'coverUrl':_0xc6967b(0xfec),'photoCount':0x0,'createdAt':Date['now']()};await _0x2c5bcf[_0xc6967b(0x6dc)][_0xc6967b(0x68e)](_0x4d01ba),await _0x178ddd(),alert(_0xc6967b(0x1d7)+_0x3139ea+'\x22\x20创建成功！');}else _0x3139ea!==null&&alert('相册名称不能为空！');}),document[_0x4aca80(0x9c8)](_0x4aca80(0xdeb))[_0x4aca80(0xa0f)]('click',()=>document['getElementById'](_0x4aca80(0xf6d))[_0x4aca80(0x575)][_0x4aca80(0x30f)](_0x4aca80(0xc3f))),document[_0x4aca80(0x9c8)](_0x4aca80(0x7db))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>document[_0x4aca80(0x9c8)]('post-local-image-input')['click']()),document[_0x4aca80(0x9c8)](_0x4aca80(0x1356))['addEventListener']('change',_0x627fa3=>{const _0x2d3d9c=_0x4aca80,_0x4a72de=_0x627fa3[_0x2d3d9c(0x1070)][_0x2d3d9c(0x1216)][0x0];if(_0x4a72de){const _0x596aaf=new FileReader();_0x596aaf[_0x2d3d9c(0x429)]=_0x238bad=>{const _0x4803ec=_0x2d3d9c;document['getElementById'](_0x4803ec(0xf9e))[_0x4803ec(0xbf4)]=_0x238bad['target']['result'],document[_0x4803ec(0x9c8)]('post-image-preview-container')['classList'][_0x4803ec(0x68e)](_0x4803ec(0xc3f)),document['getElementById'](_0x4803ec(0x6f4))['style']['display']=_0x4803ec(0x3d9);},_0x596aaf[_0x2d3d9c(0xba5)](_0x4a72de);}}),document['getElementById'](_0x4aca80(0xe01))['addEventListener'](_0x4aca80(0xf5c),async()=>{const _0x3d232e=_0x4aca80,_0x3ba4d1=await _0xadb5df(_0x3d232e(0x13a6),'请输入网络图片的链接','','url');_0x3ba4d1&&(document['getElementById']('post-image-preview')[_0x3d232e(0xbf4)]=_0x3ba4d1,document[_0x3d232e(0x9c8)](_0x3d232e(0x1135))['classList']['add'](_0x3d232e(0xc3f)),document[_0x3d232e(0x9c8)](_0x3d232e(0x6f4))['style'][_0x3d232e(0x3c5)]='block');}),document['getElementById'](_0x4aca80(0x5c3))[_0x4aca80(0xa0f)]('click',()=>_0x1055ad());const _0x355a0c=document[_0x4aca80(0x9c8)](_0x4aca80(0x7f5)),_0x8b412a=document[_0x4aca80(0x9c8)]('switch-to-text-image-mode'),_0x41703e=document[_0x4aca80(0x9c8)]('image-mode-content'),_0x3830b0=document['getElementById'](_0x4aca80(0xc75));_0x355a0c['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x14d066=_0x4aca80;_0x355a0c[_0x14d066(0x575)][_0x14d066(0x68e)]('active'),_0x8b412a['classList'][_0x14d066(0x30f)]('active'),_0x41703e['classList'][_0x14d066(0x68e)](_0x14d066(0x113d)),_0x3830b0[_0x14d066(0x575)][_0x14d066(0x30f)](_0x14d066(0x113d));}),_0x8b412a[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x29e005=_0x4aca80;_0x8b412a[_0x29e005(0x575)][_0x29e005(0x68e)](_0x29e005(0x113d)),_0x355a0c['classList'][_0x29e005(0x30f)](_0x29e005(0x113d)),_0x3830b0[_0x29e005(0x575)]['add']('active'),_0x41703e[_0x29e005(0x575)][_0x29e005(0x30f)](_0x29e005(0x113d));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xb24))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x1b4c4c=_0x4aca80,_0x48d5ac=document[_0x1b4c4c(0x9c8)](_0x1b4c4c(0xf6d)),_0x4722b6=_0x48d5ac[_0x1b4c4c(0xc9f)]['mode'],_0x3518de=document['querySelector'](_0x1b4c4c(0xe74))[_0x1b4c4c(0x1155)];let _0x175642=null;_0x3518de===_0x1b4c4c(0x1361)&&(_0x175642=Array[_0x1b4c4c(0x13a5)](document[_0x1b4c4c(0x7e4)]('input[name=\x22visibility_group\x22]:checked'))[_0x1b4c4c(0xa3b)](_0x1f0bab=>parseInt(_0x1f0bab['value'])));let _0xbefaf3={};const _0x1bf35e={'timestamp':Date['now'](),'authorId':_0x1b4c4c(0x586),'visibleGroupIds':_0x175642};if(_0x4722b6===_0x1b4c4c(0x1238)){const _0x225e52=document[_0x1b4c4c(0x9c8)]('post-public-text')[_0x1b4c4c(0x1155)][_0x1b4c4c(0x3f1)]();if(!_0x225e52){alert('说说内容不能为空哦！');return;}_0xbefaf3={..._0x1bf35e,'type':_0x1b4c4c(0x1238),'content':_0x225e52};}else{const _0x28c4fc=document['getElementById']('post-public-text')[_0x1b4c4c(0x1155)]['trim'](),_0x148d48=document[_0x1b4c4c(0x9c8)](_0x1b4c4c(0xc01))[_0x1b4c4c(0x575)][_0x1b4c4c(0x1038)]('active');if(_0x148d48){const _0x3af731=document[_0x1b4c4c(0x9c8)](_0x1b4c4c(0xf9e))[_0x1b4c4c(0xbf4)],_0x288105=document['getElementById'](_0x1b4c4c(0xda0))[_0x1b4c4c(0x1155)][_0x1b4c4c(0x3f1)]();if(!_0x3af731||!(_0x3af731[_0x1b4c4c(0xc8d)](_0x1b4c4c(0x34e))||_0x3af731[_0x1b4c4c(0xc8d)](_0x1b4c4c(0xfee)))){alert('请先添加一张图片再发布动态哦！');return;}if(!_0x288105){alert(_0x1b4c4c(0x62a));return;}_0xbefaf3={..._0x1bf35e,'type':'image_post','publicText':_0x28c4fc,'imageUrl':_0x3af731,'imageDescription':_0x288105};}else{const _0x3d2d62=document[_0x1b4c4c(0x9c8)](_0x1b4c4c(0x690))[_0x1b4c4c(0x1155)][_0x1b4c4c(0x3f1)]();if(!_0x3d2d62){alert(_0x1b4c4c(0xc69));return;}_0xbefaf3={..._0x1bf35e,'type':'text_image','publicText':_0x28c4fc,'hiddenContent':_0x3d2d62};}}const _0x27281a=await _0x2c5bcf['qzonePosts'][_0x1b4c4c(0x68e)](_0xbefaf3);let _0x6a7de3=_0xbefaf3[_0x1b4c4c(0x53b)]||_0xbefaf3[_0x1b4c4c(0x7b2)]||_0xbefaf3['imageDescription']||_0xbefaf3['hiddenContent']||'（无文字内容）';_0x6a7de3=_0x6a7de3[_0x1b4c4c(0xc34)](0x0,0x32)+(_0x6a7de3['length']>0x32?'...':'');for(const _0x1d3a3d in _0x9ebf46[_0x1b4c4c(0x547)]){const _0x1a0abd=_0x9ebf46[_0x1b4c4c(0x547)][_0x1d3a3d];if(_0x1a0abd[_0x1b4c4c(0x11e4)])continue;let _0x45b829=![];const _0x10959f=_0xbefaf3[_0x1b4c4c(0x719)];if(!_0x10959f||_0x10959f[_0x1b4c4c(0xa06)]===0x0)_0x45b829=!![];else _0x1a0abd['groupId']&&_0x10959f[_0x1b4c4c(0x930)](_0x1a0abd[_0x1b4c4c(0x7b1)])&&(_0x45b829=!![]);if(_0x45b829){const _0x372115={'role':_0x1b4c4c(0xb64),'content':_0x1b4c4c(0xf40)+_0x27281a+_0x1b4c4c(0x10fb)+_0x6a7de3+'”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','timestamp':Date[_0x1b4c4c(0x9b7)](),'isHidden':!![]};_0x1a0abd[_0x1b4c4c(0x8b3)]['push'](_0x372115),await _0x2c5bcf[_0x1b4c4c(0x547)][_0x1b4c4c(0xff5)](_0x1a0abd);}}await _0x2c70a9(),_0x48d5ac[_0x1b4c4c(0x575)][_0x1b4c4c(0x30f)]('visible'),alert(_0x1b4c4c(0x4ab));});const _0x12b8a2=document[_0x4aca80(0x9c8)]('qzone-posts-list');let _0x54ed38={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0x247cfb(_0x405039=null){const _0x493e4e=_0x4aca80;document[_0x493e4e(0x7e4)](_0x493e4e(0x90f))[_0x493e4e(0x591)](_0x44d469=>{const _0x10ccb0=_0x493e4e;_0x44d469!==_0x405039&&_0x44d469[_0x10ccb0(0x91d)](_0x10ccb0(0xfd6))[_0x10ccb0(0x575)][_0x10ccb0(0x30f)](_0x10ccb0(0x9eb));});}async function _0x39ea27(_0x4e7c1c){const _0x2b882d=_0x4aca80;_0x4e7c1c[_0x2b882d(0x20a)]();const _0x331d0f=_0x4e7c1c[_0x2b882d(0x1070)],_0x5d1bfa=_0x331d0f[_0x2b882d(0xaa0)](_0x2b882d(0x1389));if(_0x5d1bfa){const _0x821c16=_0x5d1bfa[_0x2b882d(0xaa0)](_0x2b882d(0x90f)),_0x3ded86=parseInt(_0x821c16[_0x2b882d(0xc9f)][_0x2b882d(0xf23)]),_0x2eebe1=parseInt(_0x5d1bfa[_0x2b882d(0xc9f)][_0x2b882d(0x1020)]);if(isNaN(_0x3ded86)||isNaN(_0x2eebe1))return;const _0x48659a=_0x20f1b5[_0x2b882d(0xfc3)](_0x2d8b34=>_0x2d8b34['id']===_0x3ded86);if(!_0x48659a||!_0x48659a[_0x2b882d(0x1e0)]||!_0x48659a[_0x2b882d(0x1e0)][_0x2eebe1])return;const _0x43ad91=_0x48659a['comments'][_0x2eebe1],_0x5db929=await _0x352ae9('删除评论',_0x2b882d(0x125f),{'confirmButtonClass':'btn-danger'});if(_0x5db929){_0x48659a[_0x2b882d(0x1e0)][_0x2b882d(0x888)](_0x2eebe1,0x1),await _0x2c5bcf[_0x2b882d(0x75f)][_0x2b882d(0x13a4)](_0x3ded86,{'comments':_0x48659a[_0x2b882d(0x1e0)]});if(_0x43ad91&&_0x43ad91[_0x2b882d(0x8bf)]===_0x9ebf46[_0x2b882d(0x32c)][_0x2b882d(0x5b7)]){console[_0x2b882d(0x283)]('用户删除了自己的评论，开始清理AI记忆...');const _0x2fdb65=new Set();_0x48659a[_0x2b882d(0x61c)]!==_0x2b882d(0x586)&&_0x2fdb65['add'](_0x48659a[_0x2b882d(0x61c)]);if(_0x43ad91[_0x2b882d(0x6ff)]){const _0x3f3584=Object[_0x2b882d(0xeb2)](_0x9ebf46[_0x2b882d(0x547)])[_0x2b882d(0xfc3)](_0x18f589=>_0x18f589['originalName']===_0x43ad91[_0x2b882d(0x6ff)]);_0x3f3584&&_0x2fdb65['add'](_0x3f3584['id']);}const _0x52bd77=(_0x48659a[_0x2b882d(0x7b2)]||_0x48659a['content']||'')[_0x2b882d(0xc34)](0x0,0x1e),_0x2c4182=_0x9ebf46['qzoneSettings']['nickname'];let _0x76a170;const _0x5db311=_0x9ebf46[_0x2b882d(0x774)]['find'](_0x52c030=>_0x52c030[_0x2b882d(0x11be)]===_0x43ad91[_0x2b882d(0xbb7)]);if(_0x5db311)_0x76a170='用户\x27'+_0x2c4182+_0x2b882d(0x6a0)+_0x52bd77+'”下，发送了一个表情评论，意思是：“'+_0x5db311[_0x2b882d(0x609)]+'”。';else{if(_0x43ad91[_0x2b882d(0x6ff)]){const _0x314e0d=_0x1dfc4e(_0x43ad91[_0x2b882d(0x6ff)]);_0x76a170=_0x2b882d(0x7ef)+_0x2c4182+'\x27刚刚在你的动态“'+_0x52bd77+_0x2b882d(0x181)+_0x314e0d+'\x27的评论，内容是：“'+_0x43ad91[_0x2b882d(0xbb7)]+'”。';}else _0x76a170='用户\x27'+_0x2c4182+_0x2b882d(0xbbd)+_0x52bd77+'”，内容是：“'+_0x43ad91[_0x2b882d(0xbb7)]+'”。';}const _0xf71c23='[系统提示：'+_0x76a170+'请你对此作出回应。]';for(const _0x3d125e of _0x2fdb65){const _0x50d85b=_0x9ebf46['chats'][_0x3d125e];if(_0x50d85b){const _0x6e030a=_0x50d85b['history']['length'];_0x50d85b[_0x2b882d(0x8b3)]=_0x50d85b[_0x2b882d(0x8b3)][_0x2b882d(0x401)](_0x410879=>!(_0x410879['isHidden']&&_0x410879[_0x2b882d(0x7fd)]===_0x2b882d(0xb64)&&_0x410879[_0x2b882d(0x53b)]===_0xf71c23)),_0x50d85b[_0x2b882d(0x8b3)][_0x2b882d(0xa06)]<_0x6e030a&&(console[_0x2b882d(0x283)](_0x2b882d(0x513)+_0x50d85b[_0x2b882d(0x609)]+_0x2b882d(0x34d)),await _0x2c5bcf[_0x2b882d(0x547)][_0x2b882d(0xff5)](_0x50d85b));}}}await _0x374c25(_0x3ded86);}return;}const _0xbf7484=_0x331d0f[_0x2b882d(0xaa0)]('.comment-sticker-btn');if(_0xbf7484){const _0x1f5772=_0xbf7484[_0x2b882d(0xaa0)]('.qzone-post-container');if(!_0x1f5772)return;const _0x3cc9dd=parseInt(_0x1f5772[_0x2b882d(0xc9f)][_0x2b882d(0xf23)]);_0x15329b['isOpen']&&_0x15329b[_0x2b882d(0x2bf)]===_0x3cc9dd?_0x475b2e():_0x1f1e10(_0x3cc9dd,_0xbf7484);return;}const _0xea10af=_0x331d0f[_0x2b882d(0xaa0)](_0x2b882d(0xad1));if(_0xea10af){const _0x41e5f3=parseInt(_0xea10af[_0x2b882d(0xc9f)][_0x2b882d(0xf23)]),_0x4838bb=_0xea10af[_0x2b882d(0xc9f)]['commenterOriginalName'],_0x2a1faa=_0xea10af[_0x2b882d(0xc9f)][_0x2b882d(0x1184)];if(!_0x4838bb||!_0x2a1faa||_0x4838bb===_0x9ebf46[_0x2b882d(0x32c)]['nickname']){_0x411ee8(_0xea10af[_0x2b882d(0xaa0)](_0x2b882d(0x90f)));return;}_0x370f8c={'postId':_0x41e5f3,'replyToName':_0x4838bb,'replyToDisplayName':_0x2a1faa};const _0x3b9972=_0xea10af[_0x2b882d(0xaa0)](_0x2b882d(0x90f)),_0x3f0ae2=_0x3b9972[_0x2b882d(0x91d)](_0x2b882d(0x4d2));_0x3f0ae2[_0x2b882d(0x1047)]=_0x2b882d(0xff0)+_0x2a1faa+':',_0x3f0ae2[_0x2b882d(0x6fd)]();return;}if(_0x331d0f[_0x2b882d(0x575)]['contains'](_0x2b882d(0x712))){const _0xdbe0a4=_0x331d0f[_0x2b882d(0xaa0)](_0x2b882d(0x90f));if(_0xdbe0a4&&_0xdbe0a4[_0x2b882d(0xc9f)]['postId'])_0x3ce008(parseInt(_0xdbe0a4[_0x2b882d(0xc9f)][_0x2b882d(0xf23)]));return;}if(_0x331d0f[_0x2b882d(0xbcf)]===_0x2b882d(0xf0b)&&_0x331d0f[_0x2b882d(0xc9f)][_0x2b882d(0x86c)]){_0x1bff53(_0x2b882d(0x112c),_0x331d0f[_0x2b882d(0xc9f)][_0x2b882d(0x86c)]['replace'](/<br>/g,'\x0a'));return;}const _0x517291=_0x331d0f[_0x2b882d(0xaa0)](_0x2b882d(0x90f));if(!_0x517291)return;const _0x5236fc=parseInt(_0x517291[_0x2b882d(0xc9f)][_0x2b882d(0xf23)]);if(isNaN(_0x5236fc))return;if(_0x331d0f[_0x2b882d(0xaa0)]('.qzone-post-delete-action')){const _0x52ec35=await _0x352ae9(_0x2b882d(0x361),_0x2b882d(0xf13),{'confirmButtonClass':_0x2b882d(0x12bc)});_0x52ec35&&(_0x517291[_0x2b882d(0x5e1)][_0x2b882d(0x758)]=_0x2b882d(0x405),_0x517291[_0x2b882d(0x5e1)]['transform']='scale(0.8)',_0x517291[_0x2b882d(0x5e1)][_0x2b882d(0xb17)]='0',setTimeout(async()=>{const _0x5af5b2=_0x2b882d;await _0x2c5bcf[_0x5af5b2(0x75f)][_0x5af5b2(0x6d2)](_0x5236fc);const _0x35825f=_0x5af5b2(0xd96)+_0x5236fc+')';for(const _0x5d5abb in _0x9ebf46[_0x5af5b2(0x547)]){const _0x34cef7=_0x9ebf46[_0x5af5b2(0x547)][_0x5d5abb],_0xf3e265=_0x34cef7[_0x5af5b2(0x8b3)][_0x5af5b2(0xa06)];_0x34cef7[_0x5af5b2(0x8b3)]=_0x34cef7[_0x5af5b2(0x8b3)][_0x5af5b2(0x401)](_0x284dfc=>!(_0x284dfc[_0x5af5b2(0x7fd)]===_0x5af5b2(0xb64)&&_0x284dfc['content']['includes'](_0x35825f)));if(_0x34cef7['history']['length']<_0xf3e265)await _0x2c5bcf[_0x5af5b2(0x547)]['put'](_0x34cef7);}await _0x2c70a9(),alert('动态已删除。');},0x12c));return;}const _0x3d6e3f=_0x331d0f[_0x2b882d(0xaa0)](_0x2b882d(0x10c5));if(_0x3d6e3f){if(_0x3d6e3f[_0x2b882d(0x575)]['contains'](_0x2b882d(0x75b))){_0x4020b6(_0x5236fc);return;}if(_0x3d6e3f[_0x2b882d(0x575)][_0x2b882d(0x1038)](_0x2b882d(0x414))){const _0x4b29cb=_0x20f1b5['find'](_0x403be7=>_0x403be7['id']===_0x5236fc);if(!_0x4b29cb)return;if(!_0x4b29cb[_0x2b882d(0x315)])_0x4b29cb[_0x2b882d(0x315)]=[];const _0x4ca96b=_0x9ebf46['qzoneSettings'][_0x2b882d(0x5b7)],_0x1dc745=_0x4b29cb['likes'][_0x2b882d(0x78e)](_0x4ca96b);_0x1dc745>-0x1?_0x4b29cb[_0x2b882d(0x315)][_0x2b882d(0x888)](_0x1dc745,0x1):(_0x4b29cb[_0x2b882d(0x315)][_0x2b882d(0x668)](_0x4ca96b),_0x3d6e3f[_0x2b882d(0x575)]['add'](_0x2b882d(0xe11)),_0x3d6e3f['addEventListener'](_0x2b882d(0x84c),()=>_0x3d6e3f['classList'][_0x2b882d(0x30f)](_0x2b882d(0xe11)),{'once':!![]})),await _0x2c5bcf[_0x2b882d(0x75f)][_0x2b882d(0x13a4)](_0x5236fc,{'likes':_0x4b29cb[_0x2b882d(0x315)]}),await _0x374c25(_0x5236fc);}if(_0x3d6e3f[_0x2b882d(0x575)][_0x2b882d(0x1038)](_0x2b882d(0x410))){const _0xf2d74c=await _0x2c5bcf[_0x2b882d(0xc09)]['where']({'type':'qzone_post','content.id':_0x5236fc})['first']();if(_0xf2d74c)await _0x2c5bcf['favorites'][_0x2b882d(0x6d2)](_0xf2d74c['id']),await _0x1bff53('提示',_0x2b882d(0x1d0));else{const _0x421aff=await _0x2c5bcf[_0x2b882d(0x75f)][_0x2b882d(0xdf9)](_0x5236fc);_0x421aff&&(await _0x2c5bcf[_0x2b882d(0xc09)][_0x2b882d(0x68e)]({'type':'qzone_post','content':_0x421aff,'timestamp':Date[_0x2b882d(0x9b7)]()}),await _0x1bff53('提示','收藏成功！'));}await _0x374c25(_0x5236fc);}return;}const _0x2ac70d=_0x331d0f['closest'](_0x2b882d(0x83a));if(_0x2ac70d){const _0x183253=_0x517291[_0x2b882d(0x91d)]('.comment-input'),_0x419cd4=_0x183253[_0x2b882d(0x1155)][_0x2b882d(0x3f1)]();if(!_0x419cd4)return alert(_0x2b882d(0xfbe));const _0x4d111a=_0x20f1b5[_0x2b882d(0xfc3)](_0xaa2799=>_0xaa2799['id']===_0x5236fc);if(!_0x4d111a)return;if(!_0x4d111a['comments'])_0x4d111a['comments']=[];const _0x1f01df={'commenterName':_0x9ebf46[_0x2b882d(0x32c)][_0x2b882d(0x5b7)],'text':_0x419cd4,'timestamp':Date[_0x2b882d(0x9b7)](),'replyTo':_0x370f8c&&_0x370f8c[_0x2b882d(0xf23)]===_0x5236fc?_0x370f8c[_0x2b882d(0x540)]:null};_0x4d111a[_0x2b882d(0x1e0)][_0x2b882d(0x668)](_0x1f01df),await _0x2c5bcf[_0x2b882d(0x75f)]['update'](_0x5236fc,{'comments':_0x4d111a[_0x2b882d(0x1e0)]});let _0x40ec49=(_0x4d111a['publicText']||_0x4d111a[_0x2b882d(0x53b)]||'')[_0x2b882d(0xc34)](0x0,0x1e);const _0x302281=_0x9ebf46[_0x2b882d(0x32c)]['nickname'],_0x3bba92=new Set();if(_0x4d111a['authorId']!==_0x2b882d(0x586))_0x3bba92['add'](_0x4d111a[_0x2b882d(0x61c)]);if(_0x1f01df[_0x2b882d(0x6ff)]&&_0x1f01df[_0x2b882d(0x6ff)]!==_0x302281){const _0x5b6fa4=Object[_0x2b882d(0xeb2)](_0x9ebf46[_0x2b882d(0x547)])[_0x2b882d(0xfc3)](_0x503cc9=>_0x503cc9[_0x2b882d(0x1071)]===_0x1f01df[_0x2b882d(0x6ff)]);if(_0x5b6fa4)_0x3bba92[_0x2b882d(0x68e)](_0x5b6fa4['id']);}for(const _0x581a01 of _0x3bba92){const _0xd9de33=_0x9ebf46[_0x2b882d(0x547)][_0x581a01];if(_0xd9de33&&!_0xd9de33[_0x2b882d(0x11e4)]){const _0x36dea9=_0x9ebf46[_0x2b882d(0x774)][_0x2b882d(0xfc3)](_0x4cd546=>_0x4cd546[_0x2b882d(0x11be)]===_0x419cd4);let _0x5ef0e5=_0x36dea9?_0x2b882d(0x7ef)+_0x302281+_0x2b882d(0x6a0)+_0x40ec49+_0x2b882d(0x650)+_0x36dea9[_0x2b882d(0x609)]+'”。':_0x1f01df['replyTo']?_0x2b882d(0x7ef)+_0x302281+_0x2b882d(0x6a0)+_0x40ec49+_0x2b882d(0x181)+_0x370f8c['replyToDisplayName']+_0x2b882d(0xb16)+_0x419cd4+'”。':_0x2b882d(0x7ef)+_0x302281+_0x2b882d(0xbbd)+_0x40ec49+_0x2b882d(0x1179)+_0x419cd4+'”。';const _0x31202e={'role':_0x2b882d(0xb64),'content':_0x2b882d(0x808)+_0x5ef0e5+_0x2b882d(0xa10),'timestamp':Date[_0x2b882d(0x9b7)](),'isHidden':!![]};_0xd9de33['history'][_0x2b882d(0x668)](_0x31202e),await _0x2c5bcf[_0x2b882d(0x547)][_0x2b882d(0xff5)](_0xd9de33);}}_0x183253[_0x2b882d(0x1155)]='',_0x411ee8(_0x517291),await _0x374c25(_0x5236fc);return;}}const _0x2d65d9=_0x4f1451=>{const _0xd2ae32=_0x4aca80,_0x3149d6=_0x4f1451['target'];if(_0x3149d6[_0xd2ae32(0xaa0)](_0xd2ae32(0x118a)))return;const _0x850b82=_0x4f1451[_0xd2ae32(0x1070)]['closest'](_0xd2ae32(0x90f));if(!_0x850b82)return;_0x247cfb(_0x850b82),_0x54ed38['activeContainer']=_0x850b82,_0x54ed38['isDragging']=!![],_0x54ed38['isClick']=!![],_0x54ed38[_0xd2ae32(0xcd3)]=null,_0x54ed38[_0xd2ae32(0xda5)]=_0x4f1451[_0xd2ae32(0x12d9)][_0xd2ae32(0x930)](_0xd2ae32(0x7b5))?_0x4f1451[_0xd2ae32(0xeff)]:_0x4f1451[_0xd2ae32(0x781)][0x0][_0xd2ae32(0xeff)],_0x54ed38['startY']=_0x4f1451['type'][_0xd2ae32(0x930)](_0xd2ae32(0x7b5))?_0x4f1451[_0xd2ae32(0x42f)]:_0x4f1451[_0xd2ae32(0x781)][0x0]['pageY'],_0x54ed38[_0xd2ae32(0x3db)][_0xd2ae32(0x91d)](_0xd2ae32(0xfd6))['style']['transition']='none',document[_0xd2ae32(0xa0f)](_0xd2ae32(0x726),_0x595008),document['addEventListener']('mouseup',_0x28e9a4),document['addEventListener'](_0xd2ae32(0x699),_0x595008,{'passive':![]}),document[_0xd2ae32(0xa0f)](_0xd2ae32(0xd41),_0x28e9a4);},_0x595008=_0x4214a9=>{const _0x322bac=_0x4aca80;if(!_0x54ed38[_0x322bac(0x1190)]||!_0x54ed38[_0x322bac(0x3db)])return;const _0x856a5d=_0x4214a9[_0x322bac(0x12d9)][_0x322bac(0x930)]('mouse')?_0x4214a9[_0x322bac(0xeff)]:_0x4214a9['touches'][0x0][_0x322bac(0xeff)],_0x5bab11=_0x4214a9['type'][_0x322bac(0x930)]('mouse')?_0x4214a9['pageY']:_0x4214a9[_0x322bac(0x781)][0x0]['pageY'],_0xc3b583=_0x856a5d-_0x54ed38[_0x322bac(0xda5)],_0x1883d9=_0x5bab11-_0x54ed38[_0x322bac(0x11e8)];_0x54ed38['isClick']&&(Math[_0x322bac(0x4e2)](_0xc3b583)>0x5||Math[_0x322bac(0x4e2)](_0x1883d9)>0x5)&&(_0x54ed38['isClick']=![]);!_0x54ed38[_0x322bac(0xcd3)]&&(Math[_0x322bac(0x4e2)](_0xc3b583)>Math[_0x322bac(0x4e2)](_0x1883d9)?_0x54ed38[_0x322bac(0xcd3)]=_0x322bac(0xca6):_0x54ed38[_0x322bac(0xcd3)]=_0x322bac(0x3e1));if(_0x54ed38['swipeDirection']===_0x322bac(0xca6)){_0x4214a9[_0x322bac(0xf26)](),_0x54ed38[_0x322bac(0x444)]=_0x856a5d;let _0x461ec3=Math['min'](0x0,Math[_0x322bac(0x24e)](-0x5a,_0xc3b583));_0x54ed38[_0x322bac(0x3db)][_0x322bac(0x91d)](_0x322bac(0xfd6))[_0x322bac(0x5e1)][_0x322bac(0xf57)]=_0x322bac(0xd19)+_0x461ec3+_0x322bac(0x10b5);}},_0x28e9a4=_0x2b152=>{const _0x3d1950=_0x4aca80;document[_0x3d1950(0xc9d)](_0x3d1950(0x726),_0x595008),document[_0x3d1950(0xc9d)](_0x3d1950(0xdf0),_0x28e9a4),document[_0x3d1950(0xc9d)](_0x3d1950(0x699),_0x595008),document[_0x3d1950(0xc9d)](_0x3d1950(0xd41),_0x28e9a4);if(!_0x54ed38[_0x3d1950(0x1190)]||!_0x54ed38['activeContainer'])return;const _0x18eb4d=_0x54ed38[_0x3d1950(0x3db)][_0x3d1950(0x91d)](_0x3d1950(0xfd6));_0x18eb4d[_0x3d1950(0x5e1)][_0x3d1950(0x758)]=_0x3d1950(0x6b8);if(_0x54ed38[_0x3d1950(0xcd3)]===_0x3d1950(0xca6)&&!_0x54ed38[_0x3d1950(0x1f5)]){const _0xa3def3=_0x2b152[_0x3d1950(0x12d9)][_0x3d1950(0x930)](_0x3d1950(0xd41))?_0x2b152['changedTouches'][0x0][_0x3d1950(0xeff)]:_0x2b152[_0x3d1950(0xeff)],_0x5f4434=_0xa3def3-_0x54ed38[_0x3d1950(0xda5)];_0x5f4434<-0x28?_0x18eb4d['classList'][_0x3d1950(0x68e)]('swiped'):_0x18eb4d['classList']['remove'](_0x3d1950(0x9eb));}_0x18eb4d['style'][_0x3d1950(0xf57)]='',_0x54ed38[_0x3d1950(0x1190)]=![],_0x54ed38[_0x3d1950(0x3db)]=null,_0x54ed38[_0x3d1950(0xcd3)]=null,_0x54ed38[_0x3d1950(0x1f5)]=!![];};_0x12b8a2[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x39ea27),_0x12b8a2[_0x4aca80(0xa0f)](_0x4aca80(0x124a),_0x2d65d9),_0x12b8a2[_0x4aca80(0xa0f)]('touchstart',_0x2d65d9,{'passive':!![]}),_0x12b8a2[_0x4aca80(0xa0f)]('click',_0xa754bf=>{const _0x3d39a9=_0x4aca80;_0xa754bf[_0x3d39a9(0x1070)]&&_0xa754bf[_0x3d39a9(0x1070)]['id']===_0x3d39a9(0xf58)&&_0x2a6c86();}),document['getElementById'](_0x4aca80(0xa8d))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x48bee4=_0x4aca80;_0x9ebf46[_0x48bee4(0x970)]&&_0x4975f9(_0x9ebf46[_0x48bee4(0x970)]);}),document[_0x4aca80(0x9c8)](_0x4aca80(0x1281))['addEventListener'](_0x4aca80(0x25c),_0x3cf58f),document[_0x4aca80(0x9c8)](_0x4aca80(0x529))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x51f885),document['getElementById'](_0x4aca80(0x2e3))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x4d4ba0),document[_0x4aca80(0x9c8)](_0x4aca80(0x6fe))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x555f6b=_0x4aca80,_0x5ccbbb=document['getElementById'](_0x555f6b(0x1266));_0x5ccbbb['querySelector']('p')&&(_0x5ccbbb['innerHTML']='');const _0x362f54=_0x14ba38();_0x5ccbbb[_0x555f6b(0x7b9)](_0x362f54),_0x362f54['querySelector'](_0x555f6b(0xc7f))[_0x555f6b(0x6fd)]();}),document[_0x4aca80(0x9c8)]('switch-greeting-btn')['addEventListener']('click',_0x160d99),document[_0x4aca80(0x9c8)](_0x4aca80(0x771))[_0x4aca80(0xa0f)]('click',_0x99dfb0=>{const _0x3bb787=_0x4aca80;_0x99dfb0[_0x3bb787(0x1070)]&&_0x99dfb0['target']['id']===_0x3bb787(0x2d9)&&_0x5b2a99();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x48b))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x40b003),document['getElementById'](_0x4aca80(0xa49))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x314c27),document[_0x4aca80(0x9c8)](_0x4aca80(0x9ac))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x56e5d3=>{const _0x1ea27c=_0x4aca80;_0x56e5d3[_0x1ea27c(0x1070)]['id']===_0x1ea27c(0x9ac)&&_0x56e5d3['target'][_0x1ea27c(0x575)]['remove']('visible');}),document[_0x4aca80(0x9c8)](_0x4aca80(0xae5))['addEventListener'](_0x4aca80(0xf5c),_0x207725),document[_0x4aca80(0x9c8)](_0x4aca80(0xf7f))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x27519a),document[_0x4aca80(0x9c8)](_0x4aca80(0xebb))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>_0x55787a(_0x4aca80(0xbc9))),document[_0x4aca80(0x9c8)](_0x4aca80(0xc55))['addEventListener'](_0x4aca80(0xf5c),()=>_0x55787a(_0x4aca80(0xbc9)));const _0x916c2c=document[_0x4aca80(0x9c8)](_0x4aca80(0xe8c)),_0x2352ed=document['getElementById'](_0x4aca80(0x9cb));_0x916c2c[_0x4aca80(0xa0f)]('input',()=>{const _0x1b03d3=_0x4aca80,_0x157fcf=_0x916c2c['value'][_0x1b03d3(0x3f1)]()[_0x1b03d3(0xc61)]();_0x2352ed['style'][_0x1b03d3(0x3c5)]=_0x157fcf?_0x1b03d3(0x3d9):_0x1b03d3(0x8f6);if(!_0x157fcf){_0x4336b7(allFavoriteItems);return;}const _0x1f3cb1=allFavoriteItems[_0x1b03d3(0x401)](_0x57f536=>{const _0x4989a3=_0x1b03d3;let _0x21a99b='',_0x1cfe33='';if(_0x57f536['type']===_0x4989a3(0x411)){const _0x52966c=_0x57f536[_0x4989a3(0x53b)];_0x21a99b+=(_0x52966c['publicText']||'')+'\x20'+(_0x52966c['content']||'');if(_0x52966c[_0x4989a3(0x61c)]===_0x4989a3(0x586))_0x1cfe33=_0x9ebf46[_0x4989a3(0x32c)][_0x4989a3(0x5b7)];else _0x9ebf46[_0x4989a3(0x547)][_0x52966c['authorId']]&&(_0x1cfe33=_0x9ebf46[_0x4989a3(0x547)][_0x52966c[_0x4989a3(0x61c)]][_0x4989a3(0x609)]);}else{if(_0x57f536[_0x4989a3(0x12d9)]===_0x4989a3(0xb3c)){const _0xab1dbe=_0x57f536[_0x4989a3(0x53b)];typeof _0xab1dbe['content']==='string'&&(_0x21a99b=_0xab1dbe[_0x4989a3(0x53b)]);const _0x4d7efc=_0x9ebf46[_0x4989a3(0x547)][_0x57f536[_0x4989a3(0x54d)]];_0x4d7efc&&(_0xab1dbe[_0x4989a3(0x7fd)]===_0x4989a3(0x586)?_0x1cfe33=_0x4d7efc[_0x4989a3(0x11e4)]?_0x4d7efc['settings'][_0x4989a3(0x29c)]||'我':'我':_0x1cfe33=_0x4d7efc['isGroup']?_0xab1dbe['senderName']:_0x4d7efc[_0x4989a3(0x609)]);}}return _0x21a99b[_0x4989a3(0xc61)]()[_0x4989a3(0x930)](_0x157fcf)||_0x1cfe33[_0x4989a3(0xc61)]()['includes'](_0x157fcf);});_0x4336b7(_0x1f3cb1);}),_0x2352ed[_0x4aca80(0xa0f)]('click',()=>{const _0x1ce719=_0x4aca80;_0x916c2c[_0x1ce719(0x1155)]='',_0x2352ed[_0x1ce719(0x5e1)][_0x1ce719(0x3c5)]=_0x1ce719(0x8f6),_0x4336b7(allFavoriteItems),_0x916c2c['focus']();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x66d))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x15c2f5=_0x4aca80;if(_0x24fb08['size']===0x0)return;const _0x1d0fab=_0x9ebf46[_0x15c2f5(0x547)][_0x9ebf46['activeChatId']];if(!_0x1d0fab)return;const _0x4a58d7=[],_0x5241b3=[..._0x24fb08];for(const _0x3a24e0 of _0x5241b3){const _0x58234a=await _0x2c5bcf[_0x15c2f5(0xc09)][_0x15c2f5(0xe78)](_0x15c2f5(0x117e))[_0x15c2f5(0xda9)](_0x3a24e0)['first']();if(!_0x58234a){const _0x2cc00b=_0x1d0fab[_0x15c2f5(0x8b3)][_0x15c2f5(0xfc3)](_0x5f08bb=>_0x5f08bb[_0x15c2f5(0x6b5)]===_0x3a24e0);_0x2cc00b&&_0x4a58d7['push']({'type':_0x15c2f5(0xb3c),'content':_0x2cc00b,'chatId':_0x9ebf46['activeChatId'],'timestamp':Date[_0x15c2f5(0x9b7)](),'originalTimestamp':_0x2cc00b['timestamp']});}}_0x4a58d7[_0x15c2f5(0xa06)]>0x0?(await _0x2c5bcf[_0x15c2f5(0xc09)][_0x15c2f5(0x115e)](_0x4a58d7),allFavoriteItems=await _0x2c5bcf[_0x15c2f5(0xc09)][_0x15c2f5(0x8ea)](_0x15c2f5(0x6b5))[_0x15c2f5(0x101e)]()[_0x15c2f5(0x5ff)](),await _0x1bff53('收藏成功',_0x15c2f5(0xe0c)+_0x4a58d7[_0x15c2f5(0xa06)]+_0x15c2f5(0x83f))):await _0x1bff53('提示',_0x15c2f5(0x303)),_0x2d6552();});const _0x33b5fe=document['getElementById']('favorites-edit-btn'),_0x427d24=document[_0x4aca80(0x9c8)](_0x4aca80(0x71f)),_0x3b66f5=document['getElementById'](_0x4aca80(0x583)),_0x448b04=document[_0x4aca80(0x9c8)](_0x4aca80(0x861)),_0x3e9062=document[_0x4aca80(0x9c8)](_0x4aca80(0x4d8));_0x33b5fe['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x4d8681=_0x4aca80;_0x24371e=!_0x24371e,_0x427d24[_0x4d8681(0x575)][_0x4d8681(0x1c3)](_0x4d8681(0xec5),_0x24371e),_0x24371e?(_0x33b5fe['textContent']='完成',_0x3b66f5['style'][_0x4d8681(0x3c5)]=_0x4d8681(0x3d9),_0x448b04[_0x4d8681(0x5e1)][_0x4d8681(0x3c5)]=_0x4d8681(0x8f6),_0x3e9062[_0x4d8681(0x5e1)]['paddingBottom']=_0x4d8681(0x54a)):(_0x33b5fe[_0x4d8681(0xe24)]='编辑',_0x3b66f5[_0x4d8681(0x5e1)][_0x4d8681(0x3c5)]='none',_0x448b04['style'][_0x4d8681(0x3c5)]=_0x4d8681(0x989),_0x3e9062['style']['paddingBottom']='',_0x1fb797[_0x4d8681(0xdae)](),document[_0x4d8681(0x7e4)]('.favorite-item-card.selected')[_0x4d8681(0x591)](_0x4ef163=>_0x4ef163[_0x4d8681(0x575)][_0x4d8681(0x30f)]('selected')),document[_0x4d8681(0x9c8)]('favorites-delete-selected-btn')[_0x4d8681(0xe24)]='删除\x20(0)');}),document['getElementById'](_0x4aca80(0x4d8))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x284cac=>{const _0x8ee8f=_0x4aca80,_0x54bb45=_0x284cac[_0x8ee8f(0x1070)],_0x2d41d8=_0x54bb45['closest'](_0x8ee8f(0x341));if(_0x54bb45[_0x8ee8f(0xbcf)]===_0x8ee8f(0xf0b)&&_0x54bb45[_0x8ee8f(0xc9f)][_0x8ee8f(0x86c)]){const _0x36ac72=_0x54bb45[_0x8ee8f(0xc9f)][_0x8ee8f(0x86c)];_0x1bff53(_0x8ee8f(0x112c),_0x36ac72[_0x8ee8f(0x459)](/<br>/g,'\x0a'));return;}if(!_0x24371e)return;if(!_0x2d41d8)return;const _0x42b039=parseInt(_0x2d41d8[_0x8ee8f(0xc9f)][_0x8ee8f(0x784)]);if(isNaN(_0x42b039))return;_0x1fb797[_0x8ee8f(0xd97)](_0x42b039)?(_0x1fb797['delete'](_0x42b039),_0x2d41d8[_0x8ee8f(0x575)]['remove'](_0x8ee8f(0x631))):(_0x1fb797[_0x8ee8f(0x68e)](_0x42b039),_0x2d41d8[_0x8ee8f(0x575)][_0x8ee8f(0x68e)](_0x8ee8f(0x631))),document[_0x8ee8f(0x9c8)](_0x8ee8f(0x2c7))[_0x8ee8f(0xe24)]=_0x8ee8f(0xf53)+_0x1fb797[_0x8ee8f(0xa67)]+')';}),document[_0x4aca80(0x9c8)](_0x4aca80(0x2c7))[_0x4aca80(0xa0f)]('click',async()=>{const _0xcd5525=_0x4aca80;if(_0x1fb797[_0xcd5525(0xa67)]===0x0)return;const _0x13f995=await _0x352ae9(_0xcd5525(0x115b),_0xcd5525(0x82e)+_0x1fb797[_0xcd5525(0xa67)]+_0xcd5525(0x13b1),{'confirmButtonClass':_0xcd5525(0x12bc)});if(_0x13f995){const _0x5cf754=[..._0x1fb797];await _0x2c5bcf[_0xcd5525(0xc09)][_0xcd5525(0x256)](_0x5cf754),await _0x1bff53(_0xcd5525(0x3e7),_0xcd5525(0x436)),allFavoriteItems=allFavoriteItems[_0xcd5525(0x401)](_0x714f68=>!_0x5cf754[_0xcd5525(0x930)](_0x714f68['id'])),_0x4336b7(allFavoriteItems),_0x33b5fe['click']();}});_0x9ebf46[_0x4aca80(0x1383)][_0x4aca80(0x22a)]&&(_0x27aa50(),console['log'](_0x4aca80(0x11b5)));document[_0x4aca80(0x7e4)]('input[name=\x22theme-select\x22]')[_0x4aca80(0x591)](_0x33240a=>{const _0x51ecf3=_0x4aca80;_0x33240a['addEventListener'](_0x51ecf3(0x25c),_0x2c9d73);});const _0x634a04=document[_0x4aca80(0x9c8)]('font-size-slider');_0x634a04['addEventListener'](_0x4aca80(0x11ce),()=>{const _0x47478c=_0x4aca80;document['getElementById'](_0x47478c(0x1c9))[_0x47478c(0xe24)]=_0x634a04['value']+'px',_0x2c9d73();});const _0x184ac3=document['getElementById'](_0x4aca80(0x1332));_0x184ac3[_0x4aca80(0xa0f)](_0x4aca80(0x11ce),_0x2c9d73),document[_0x4aca80(0x9c8)](_0x4aca80(0x1fd))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x44d6e9=_0x4aca80;document[_0x44d6e9(0x9c8)](_0x44d6e9(0xd7b))[_0x44d6e9(0x1ec)]=!![],_0x2c9d73();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x3f6))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0xefc840=_0x4aca80;document[_0xefc840(0x9c8)]('custom-css-input')[_0xefc840(0x1155)]='',_0x2c9d73();}),document['getElementById']('lyrics-vertical-pos')[_0x4aca80(0xa0f)](_0x4aca80(0x25c),_0x2c9d73),document['getElementById'](_0x4aca80(0x42b))[_0x4aca80(0xa0f)]('change',_0x2c9d73),document['getElementById']('lyrics-offset-input')['addEventListener'](_0x4aca80(0x11ce),_0x2c9d73),document[_0x4aca80(0x7e4)]('input[name=\x22visibility\x22]')[_0x4aca80(0x591)](_0x19cafb=>{const _0x20db7b=_0x4aca80;_0x19cafb[_0x20db7b(0xa0f)]('change',function(){const _0x41d3bb=_0x20db7b,_0x154974=document[_0x41d3bb(0x9c8)](_0x41d3bb(0x1142));this[_0x41d3bb(0x1155)]===_0x41d3bb(0x1361)||this['value']===_0x41d3bb(0xe47)?_0x154974[_0x41d3bb(0x5e1)][_0x41d3bb(0x3c5)]=_0x41d3bb(0x3d9):_0x154974[_0x41d3bb(0x5e1)][_0x41d3bb(0x3c5)]=_0x41d3bb(0x8f6);});}),document['getElementById'](_0x4aca80(0xc97))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x259cff),document[_0x4aca80(0x9c8)](_0x4aca80(0x35e))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x2960bf=_0x4aca80;document['getElementById'](_0x2960bf(0x745))[_0x2960bf(0x575)]['remove'](_0x2960bf(0xc3f));const _0x188487=document['getElementById']('chat-settings-btn');document[_0x2960bf(0x9c8)](_0x2960bf(0xb76))[_0x2960bf(0x575)][_0x2960bf(0x1038)](_0x2960bf(0xc3f))&&_0x188487['click']();}),document[_0x4aca80(0x9c8)](_0x4aca80(0xc74))[_0x4aca80(0xa0f)]('click',_0x1df651),document[_0x4aca80(0x9c8)](_0x4aca80(0x495))['addEventListener'](_0x4aca80(0xf5c),_0x44b9a5=>{const _0x4ea540=_0x4aca80;if(_0x44b9a5[_0x4ea540(0x1070)][_0x4ea540(0x575)][_0x4ea540(0x1038)](_0x4ea540(0x5ae))){const _0x4556c0=parseInt(_0x44b9a5['target'][_0x4ea540(0xc9f)]['id']);_0x27551f(_0x4556c0);}}),document[_0x4aca80(0x9c8)](_0x4aca80(0xeb6))['addEventListener'](_0x4aca80(0xf5c),_0x5c2bd9),document['getElementById'](_0x4aca80(0xe63))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2e94e8),document[_0x4aca80(0x9c8)](_0x4aca80(0x398))['addEventListener']('click',_0x3b2cc9),document[_0x4aca80(0x9c8)](_0x4aca80(0x34b))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x387a97),document[_0x4aca80(0x9c8)](_0x4aca80(0xc7a))['addEventListener']('click',()=>{const _0x5839d9=_0x1f2a43;_0x5c2bd9(),_0x5839d9&&_0x5f062d(_0x5839d9);}),document[_0x4aca80(0x9c8)](_0x4aca80(0xbff))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x12f9c3=>{const _0xa8e36b=_0x4aca80,_0x405ea7=_0x12f9c3[_0xa8e36b(0x1070)][_0xa8e36b(0xaa0)](_0xa8e36b(0xef7));if(!_0x405ea7)return;if(_0x405ea7[_0xa8e36b(0x575)]['contains']('ai')&&_0x405ea7[_0xa8e36b(0x575)][_0xa8e36b(0x1038)](_0xa8e36b(0x464))&&_0x405ea7[_0xa8e36b(0xc9f)][_0xa8e36b(0xebd)]===_0xa8e36b(0xcf8)){const _0x35a11f=parseInt(_0x405ea7[_0xa8e36b(0xc9f)][_0xa8e36b(0x6b5)]);!isNaN(_0x35a11f)&&_0x5720c7(_0x35a11f);}}),document[_0x4aca80(0x9c8)]('transfer-action-accept')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>_0x39b40c(_0x4aca80(0xa36))),document[_0x4aca80(0x9c8)](_0x4aca80(0x70c))['addEventListener']('click',()=>_0x39b40c('declined')),document['getElementById'](_0x4aca80(0x480))[_0x4aca80(0xa0f)]('click',_0x288aec),document[_0x4aca80(0x9c8)](_0x4aca80(0xfbb))[_0x4aca80(0xa0f)]('click',_0xb88101),document[_0x4aca80(0x9c8)]('copy-post-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x5dfbd6),document[_0x4aca80(0x9c8)](_0x4aca80(0xaf1))[_0x4aca80(0xa0f)]('click',_0x4d4844),document[_0x4aca80(0x9c8)]('cancel-contact-picker-btn')[_0x4aca80(0xa0f)]('click',()=>{const _0x260935=_0x4aca80;_0xe5834e(_0x260935(0x1056));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x5b0))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x97a19e=>{const _0x2f8607=_0x4aca80,_0x277fe2=_0x97a19e[_0x2f8607(0x1070)][_0x2f8607(0xaa0)](_0x2f8607(0x422));if(!_0x277fe2)return;const _0x375fdb=_0x277fe2[_0x2f8607(0xc9f)][_0x2f8607(0xa00)];_0x277fe2['classList'][_0x2f8607(0x1c3)](_0x2f8607(0x631)),_0x502f3b[_0x2f8607(0xd97)](_0x375fdb)?_0x502f3b[_0x2f8607(0x6d2)](_0x375fdb):_0x502f3b['add'](_0x375fdb),_0x2093b3();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x7a5))['addEventListener'](_0x4aca80(0xf5c),()=>{_0x36c264();}),document['getElementById']('back-from-member-management')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x21598b=_0x4aca80;_0xe5834e(_0x21598b(0x504)),document[_0x21598b(0x9c8)](_0x21598b(0xb86))['click']();}),document['getElementById'](_0x4aca80(0xba4))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x577fb9=>{const _0xb099a7=_0x4aca80;_0x577fb9['target'][_0xb099a7(0x575)][_0xb099a7(0x1038)](_0xb099a7(0x11fe))&&_0x5d5175(_0x577fb9[_0xb099a7(0x1070)]['dataset'][_0xb099a7(0x531)]);}),document[_0x4aca80(0x9c8)](_0x4aca80(0x1330))['addEventListener'](_0x4aca80(0xf5c),async()=>{const _0x12f43a=_0x4aca80,_0x44474f=document[_0x12f43a(0x9c8)]('confirm-contact-picker-btn'),_0x3177ea=_0x44474f['cloneNode'](!![]);_0x44474f[_0x12f43a(0x127d)][_0x12f43a(0x4d7)](_0x3177ea,_0x44474f),_0x3177ea[_0x12f43a(0xa0f)](_0x12f43a(0xf5c),_0x268136),await _0x48ec67();}),document['getElementById'](_0x4aca80(0xd3d))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x9e3607),document['getElementById']('video-call-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3c2c6d),document[_0x4aca80(0x9c8)](_0x4aca80(0xeb8))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3c2c6d),document[_0x4aca80(0x9c8)](_0x4aca80(0x106f))[_0x4aca80(0xa0f)]('click',_0xcd5c45),document[_0x4aca80(0x9c8)](_0x4aca80(0x6eb))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x2766c1=_0x4aca80;_0x3085d5[_0x2766c1(0x683)]=![],_0xe5834e(_0x2766c1(0x504));}),document['getElementById'](_0x4aca80(0x1174))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x4a7f0b),document[_0x4aca80(0x9c8)](_0x4aca80(0x2b2))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x44ba5c=_0x4aca80;_0x2bc8f7();const _0x4827a5=_0x9ebf46[_0x44ba5c(0x547)][_0x3085d5[_0x44ba5c(0x970)]];if(!_0x4827a5)return;if(_0x3085d5[_0x44ba5c(0x106c)]){_0x3085d5[_0x44ba5c(0x110b)]=![];const _0x2a745c={'role':'system','content':_0x44ba5c(0xb40),'timestamp':Date[_0x44ba5c(0x9b7)](),'isHidden':!![]};_0x4827a5[_0x44ba5c(0x8b3)]['push'](_0x2a745c),await _0x2c5bcf[_0x44ba5c(0x547)][_0x44ba5c(0xff5)](_0x4827a5),await _0x4128b4();}else{const _0x72769f={'role':_0x44ba5c(0x586),'content':'我拒绝了你的视频通话请求。','timestamp':Date[_0x44ba5c(0x9b7)]()};_0x4827a5['history'][_0x44ba5c(0x668)](_0x72769f),await _0x2c5bcf[_0x44ba5c(0x547)]['put'](_0x4827a5),_0xe5834e(_0x44ba5c(0x504)),_0xc4e879(_0x72769f,_0x4827a5),_0x4128b4();}_0x3085d5[_0x44ba5c(0x683)]=![];}),document['getElementById'](_0x4aca80(0xc72))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x202ae1=_0x4aca80;_0x2bc8f7(),_0x3085d5['initiator']='ai',_0x3085d5[_0x202ae1(0x110b)]=!![],_0x3085d5['activeChatId']=_0x9ebf46[_0x202ae1(0x970)];if(_0x3085d5[_0x202ae1(0x106c)]){const _0x402b59=_0x9ebf46[_0x202ae1(0x547)][_0x3085d5[_0x202ae1(0x970)]],_0x1bd2d9=_0x402b59[_0x202ae1(0xd3e)][_0x202ae1(0xfc3)](_0x5a21e9=>_0x5a21e9[_0x202ae1(0x609)]===_0x3085d5[_0x202ae1(0x1183)]);_0x1bd2d9?_0x3085d5[_0x202ae1(0x1189)]=[_0x1bd2d9]:_0x3085d5[_0x202ae1(0x1189)]=[];}_0x5ab059();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x183))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x4c65fc=_0x4aca80;if(!_0x3085d5['isActive'])return;const _0x35fcf6=document[_0x4c65fc(0x91d)](_0x4c65fc(0xf5b));_0x35fcf6&&_0x35fcf6[_0x4c65fc(0x575)][_0x4c65fc(0x68e)]('speaking');const _0x2ece1f=await _0xadb5df('你说','请输入你想说的话...');_0x35fcf6&&_0x35fcf6[_0x4c65fc(0x575)][_0x4c65fc(0x30f)](_0x4c65fc(0x39c)),_0x2ece1f&&_0x2ece1f[_0x4c65fc(0x3f1)]()&&_0x14270d(_0x2ece1f[_0x4c65fc(0x3f1)]());}),document[_0x4aca80(0x91d)](_0x4aca80(0xfb2))['addEventListener']('click',()=>{const _0x15757a=_0x4aca80;_0x24371e&&document[_0x15757a(0x9c8)](_0x15757a(0x5e3))[_0x15757a(0xf5c)](),_0x55787a(_0x15757a(0x46a)),_0xc0e19();}),document[_0x4aca80(0x9c8)]('memories-back-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>_0x55787a(_0x4aca80(0xbc9))),document[_0x4aca80(0x9c8)]('confirm-create-countdown-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0xb14e5d=_0x4aca80,_0x4c24cf=document[_0xb14e5d(0x9c8)](_0xb14e5d(0xc10))[_0xb14e5d(0x1155)]['trim'](),_0x4ea005=document['getElementById']('countdown-date-input')['value'];if(!_0x4c24cf||!_0x4ea005){alert(_0xb14e5d(0xfd7));return;}const _0x5eb118=new Date(_0x4ea005);if(isNaN(_0x5eb118)||_0x5eb118<=new Date()){alert(_0xb14e5d(0x1128));return;}const _0x45cb21={'authorId':'user','description':_0x4c24cf,'timestamp':Date[_0xb14e5d(0x9b7)](),'type':_0xb14e5d(0xa89),'targetDate':_0x5eb118[_0xb14e5d(0xb03)]()};await _0x2c5bcf[_0xb14e5d(0x137e)][_0xb14e5d(0x68e)](_0x45cb21),document[_0xb14e5d(0x9c8)]('create-countdown-modal')[_0xb14e5d(0x575)][_0xb14e5d(0x30f)](_0xb14e5d(0xc3f)),_0xc0e19();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x901))['addEventListener']('click',async()=>{const _0x15c068=_0x4aca80;if(!_0x9ebf46[_0x15c068(0x970)]||_0x9ebf46[_0x15c068(0x547)][_0x9ebf46[_0x15c068(0x970)]]['isGroup'])return;const _0x4ba610=_0x9ebf46[_0x15c068(0x547)][_0x9ebf46[_0x15c068(0x970)]],_0x3ffaba=await _0x352ae9(_0x15c068(0x8ed),_0x15c068(0xd81)+_0x4ba610['name']+_0x15c068(0x4fd),{'confirmButtonClass':'btn-danger'});if(_0x3ffaba){_0x4ba610[_0x15c068(0x36f)][_0x15c068(0xebd)]=_0x15c068(0xafb),_0x4ba610[_0x15c068(0x36f)]['blockedTimestamp']=Date['now']();const _0x2f04e3={'role':'system','content':'[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','timestamp':Date[_0x15c068(0x9b7)]()+0x1,'isHidden':!![]};_0x4ba610[_0x15c068(0x8b3)][_0x15c068(0x668)](_0x2f04e3),await _0x2c5bcf[_0x15c068(0x547)][_0x15c068(0xff5)](_0x4ba610),document[_0x15c068(0x9c8)](_0x15c068(0xb76))[_0x15c068(0x575)][_0x15c068(0x30f)](_0x15c068(0xc3f)),_0x1a44b1(_0x9ebf46[_0x15c068(0x970)]),_0x394b2c();}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x1134))['addEventListener'](_0x4aca80(0xf5c),async _0x3497e9=>{const _0x28d054=_0x4aca80,_0x201d01=_0x9ebf46[_0x28d054(0x547)][_0x9ebf46[_0x28d054(0x970)]];if(!_0x201d01)return;if(_0x3497e9[_0x28d054(0x1070)]['id']==='force-apply-check-btn'){alert(_0x28d054(0x1358)),await _0x2ce675(_0x201d01['id']),_0x1a44b1(_0x201d01['id']);return;}if(_0x3497e9['target']['id']===_0x28d054(0x1ab)){_0x201d01[_0x28d054(0x36f)][_0x28d054(0xebd)]='friend',_0x201d01[_0x28d054(0x36f)][_0x28d054(0x13c3)]=null;const _0x52f15e={'role':_0x28d054(0xb64),'content':_0x28d054(0x12fe),'timestamp':Date['now'](),'isHidden':!![]};_0x201d01['history'][_0x28d054(0x668)](_0x52f15e),await _0x2c5bcf[_0x28d054(0x547)][_0x28d054(0xff5)](_0x201d01),_0x1a44b1(_0x201d01['id']),_0x394b2c(),_0x4128b4();}else{if(_0x3497e9[_0x28d054(0x1070)]['id']===_0x28d054(0x680)){_0x201d01['relationship'][_0x28d054(0xebd)]=_0x28d054(0x733),_0x201d01[_0x28d054(0x36f)][_0x28d054(0x1271)]='';const _0x4ef710={'role':_0x28d054(0xb64),'type':_0x28d054(0x13a8),'content':'你通过了“'+_0x201d01[_0x28d054(0x609)]+_0x28d054(0x1017),'timestamp':Date[_0x28d054(0x9b7)]()};_0x201d01['history'][_0x28d054(0x668)](_0x4ef710);const _0x11d854={'role':_0x28d054(0x1a7),'senderName':_0x201d01[_0x28d054(0x609)],'content':'太好了！我们又可以聊天啦！','timestamp':Date[_0x28d054(0x9b7)]()+0x1};_0x201d01['history']['push'](_0x11d854),await _0x2c5bcf['chats'][_0x28d054(0xff5)](_0x201d01),_0x1a44b1(_0x201d01['id']),_0x394b2c();}else{if(_0x3497e9[_0x28d054(0x1070)]['id']===_0x28d054(0x88f))_0x201d01[_0x28d054(0x36f)][_0x28d054(0xebd)]=_0x28d054(0xafb),_0x201d01[_0x28d054(0x36f)]['blockedTimestamp']=Date['now'](),_0x201d01[_0x28d054(0x36f)]['applicationReason']='',await _0x2c5bcf[_0x28d054(0x547)][_0x28d054(0xff5)](_0x201d01),_0x1a44b1(_0x201d01['id']);else{if(_0x3497e9['target']['id']===_0x28d054(0x135c)){const _0x51b9aa=await _0xadb5df(_0x28d054(0xd89),_0x28d054(0xcef)+_0x201d01['name']+_0x28d054(0xb2b),_0x28d054(0xe92));_0x51b9aa!==null&&(_0x201d01['relationship'][_0x28d054(0xebd)]=_0x28d054(0x26d),_0x201d01[_0x28d054(0x36f)][_0x28d054(0x1271)]=_0x51b9aa,await _0x2c5bcf['chats'][_0x28d054(0xff5)](_0x201d01),_0x1a44b1(_0x201d01['id']),_0x394b2c(),_0x4128b4());}}}}}),document[_0x4aca80(0x9c8)]('transfer-btn')['addEventListener'](_0x4aca80(0xf5c),_0x1cc2ec),document[_0x4aca80(0x9c8)](_0x4aca80(0x3ac))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x5e50bb=_0x4aca80;document[_0x5e50bb(0x9c8)](_0x5e50bb(0xada))[_0x5e50bb(0x575)][_0x5e50bb(0x30f)](_0x5e50bb(0xc3f));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x6db))['addEventListener'](_0x4aca80(0xf5c),_0x5a1d80),document['getElementById']('send-direct-packet-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x5a6c3c);const _0x4e46d6=document[_0x4aca80(0x9c8)](_0x4aca80(0xeea)),_0x4aadf4=document[_0x4aca80(0x9c8)](_0x4aca80(0x5bc)),_0x29f419=document[_0x4aca80(0x9c8)](_0x4aca80(0x238)),_0x31ab5c=document[_0x4aca80(0x9c8)](_0x4aca80(0xcb9));_0x4e46d6[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x2e7d44=_0x4aca80;_0x4e46d6['classList']['add'](_0x2e7d44(0x113d)),_0x4aadf4['classList'][_0x2e7d44(0x30f)]('active'),_0x29f419['style'][_0x2e7d44(0x3c5)]=_0x2e7d44(0x3d9),_0x31ab5c['style'][_0x2e7d44(0x3c5)]=_0x2e7d44(0x8f6);}),_0x4aadf4['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x15a7da=_0x4aca80;_0x4aadf4[_0x15a7da(0x575)][_0x15a7da(0x68e)]('active'),_0x4e46d6[_0x15a7da(0x575)][_0x15a7da(0x30f)](_0x15a7da(0x113d)),_0x31ab5c[_0x15a7da(0x5e1)][_0x15a7da(0x3c5)]=_0x15a7da(0x3d9),_0x29f419[_0x15a7da(0x5e1)][_0x15a7da(0x3c5)]=_0x15a7da(0x8f6);}),document['getElementById']('rp-group-amount')[_0x4aca80(0xa0f)](_0x4aca80(0x11ce),_0x3d4037=>{const _0xae665=_0x4aca80,_0x51ece6=parseFloat(_0x3d4037['target']['value'])||0x0;document[_0xae665(0x9c8)](_0xae665(0x99e))[_0xae665(0xe24)]='¥\x20'+_0x51ece6['toFixed'](0x2);}),document[_0x4aca80(0x9c8)](_0x4aca80(0xe65))['addEventListener'](_0x4aca80(0x11ce),_0xd30e9e=>{const _0x19679c=_0x4aca80,_0x80d678=parseFloat(_0xd30e9e['target'][_0x19679c(0x1155)])||0x0;document[_0x19679c(0x9c8)](_0x19679c(0x7d5))[_0x19679c(0xe24)]='¥\x20'+_0x80d678['toFixed'](0x2);}),document[_0x4aca80(0x9c8)]('chat-messages')[_0x4aca80(0xa0f)]('click',_0x5a754f=>{const _0x1c6ad1=_0x4aca80,_0x278a6e=_0x5a754f[_0x1c6ad1(0x1070)][_0x1c6ad1(0xaa0)](_0x1c6ad1(0xd03));if(!_0x278a6e)return;const _0x25d306=_0x278a6e['closest'](_0x1c6ad1(0xef7));if(!_0x25d306||!_0x25d306[_0x1c6ad1(0xc9f)]['timestamp'])return;const _0x5a8377=parseInt(_0x25d306['dataset']['timestamp']);_0x23c5f9(_0x5a8377);}),document['getElementById']('send-poll-btn')[_0x4aca80(0xa0f)]('click',_0x429f82),document[_0x4aca80(0x9c8)]('add-poll-option-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x30d7b2),document[_0x4aca80(0x9c8)](_0x4aca80(0xd0b))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x3f94fd=_0x4aca80;document[_0x3f94fd(0x9c8)](_0x3f94fd(0x53d))['classList'][_0x3f94fd(0x30f)](_0x3f94fd(0xc3f));}),document[_0x4aca80(0x9c8)]('confirm-create-poll-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x99912f),document[_0x4aca80(0x9c8)](_0x4aca80(0xbff))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0xec1385=>{const _0x266efc=_0x4aca80,_0x54634b=_0xec1385[_0x266efc(0x1070)]['closest'](_0x266efc(0x1aa));if(!_0x54634b)return;const _0xda38a9=parseInt(_0x54634b[_0x266efc(0xc9f)][_0x266efc(0xff4)]);if(isNaN(_0xda38a9))return;const _0x3cb9e3=_0xec1385['target'][_0x266efc(0xaa0)](_0x266efc(0x9a8));if(_0x3cb9e3&&!_0x54634b['classList']['contains']('closed')){_0x20009b(_0xda38a9,_0x3cb9e3['dataset'][_0x266efc(0x12ef)]);return;}const _0x2d767a=_0xec1385['target'][_0x266efc(0xaa0)]('.poll-action-btn');if(_0x2d767a){_0x54634b[_0x266efc(0x575)][_0x266efc(0x1038)](_0x266efc(0x10c3))?_0x125490(_0xda38a9):_0x5bdb6f(_0xda38a9);return;}_0x54634b[_0x266efc(0x575)][_0x266efc(0x1038)](_0x266efc(0x10c3))&&_0x125490(_0xda38a9);}),document[_0x4aca80(0x9c8)](_0x4aca80(0xe31))[_0x4aca80(0xa0f)]('click',_0x215f00),document['getElementById'](_0x4aca80(0xbd8))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>_0x6df4a9('ai')),document[_0x4aca80(0x9c8)](_0x4aca80(0x892))[_0x4aca80(0xa0f)]('click',()=>_0x6df4a9(_0x4aca80(0x1016))),document[_0x4aca80(0x9c8)]('add-ai-avatar-url-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x59aac0),document[_0x4aca80(0x9c8)]('add-ai-avatar-upload-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x3abbd9=_0x4aca80;document[_0x3abbd9(0x9c8)]('ai-avatar-upload-input')[_0x3abbd9(0xf5c)]();}),document[_0x4aca80(0x9c8)](_0x4aca80(0xc06))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),_0x8e82fc),document[_0x4aca80(0x9c8)]('close-ai-avatar-library-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x4c8989),document[_0x4aca80(0x9c8)]('manage-group-avatar-library-btn')['addEventListener']('click',_0x5c7cc5),document['getElementById'](_0x4aca80(0xb8b))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x24f1a8),document['getElementById'](_0x4aca80(0x40c))[_0x4aca80(0xa0f)]('click',()=>{const _0x20b79f=_0x4aca80;document[_0x20b79f(0x9c8)](_0x20b79f(0x63d))[_0x20b79f(0xf5c)]();}),document['getElementById']('group-avatar-upload-input')['addEventListener'](_0x4aca80(0x25c),_0x15ab92),document[_0x4aca80(0x9c8)](_0x4aca80(0xe40))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3640f8),document[_0x4aca80(0x9c8)](_0x4aca80(0x54c))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2d6a53=>{const _0x4fbcb2=_0x4aca80;if(_0x2d6a53[_0x4fbcb2(0x1070)][_0x4fbcb2(0x575)][_0x4fbcb2(0x1038)](_0x4fbcb2(0xb66))){const _0x46004d=_0x2d6a53[_0x4fbcb2(0x1070)]['closest']('.icon-setting-item'),_0x384618=_0x46004d[_0x4fbcb2(0xc9f)][_0x4fbcb2(0x3b8)];_0x384618&&_0x58f257(_0x384618,_0x4fbcb2(0x2df),_0x46004d);}}),document[_0x4aca80(0x9c8)](_0x4aca80(0xbff))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x4b230e=>{const _0x278f0d=_0x4aca80,_0x20fe21=_0x4b230e[_0x278f0d(0x1070)][_0x278f0d(0xaa0)](_0x278f0d(0xab1));if(_0x20fe21){const _0x4e05a0=parseInt(_0x20fe21[_0x278f0d(0xc9f)][_0x278f0d(0x6b5)]);!isNaN(_0x4e05a0)&&_0xbe97f8(_0x4e05a0);}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x4f4))[_0x4aca80(0xa0f)]('click',()=>{const _0x43806c=_0x4aca80;_0xe5834e(_0x43806c(0x504));}),_0x15329b[_0x4aca80(0x1280)][_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async _0x534eec=>{const _0x3bb6bd=_0x4aca80,_0x5d9980=_0x534eec[_0x3bb6bd(0x1070)][_0x3bb6bd(0xaa0)]('.sticker-item');if(_0x5d9980&&_0x15329b[_0x3bb6bd(0x2bf)]!==null){const _0x697047=_0x5d9980[_0x3bb6bd(0x5e1)][_0x3bb6bd(0x11d9)][_0x3bb6bd(0x1044)](0x5,-0x2),_0x3b2850=_0x9ebf46[_0x3bb6bd(0x774)][_0x3bb6bd(0xfc3)](_0x9fa1e5=>_0x9fa1e5[_0x3bb6bd(0x11be)]===_0x697047);_0x3b2850?await _0x365251(_0x15329b['activePostId'],_0x3b2850):console[_0x3bb6bd(0x453)](_0x3bb6bd(0x37d),_0x697047);}}),document[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1693a7=>{const _0x3dabaa=_0x4aca80;_0x15329b[_0x3dabaa(0x84b)]&&!_0x15329b[_0x3dabaa(0x1280)][_0x3dabaa(0x1038)](_0x1693a7[_0x3dabaa(0x1070)])&&!_0x1693a7['target'][_0x3dabaa(0xaa0)](_0x3dabaa(0x39a))&&_0x475b2e();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x827))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3ed193),document[_0x4aca80(0x9c8)]('cancel-share-link-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x652585=_0x4aca80;document[_0x652585(0x9c8)]('share-link-modal')[_0x652585(0x575)][_0x652585(0x30f)](_0x652585(0xc3f));}),document[_0x4aca80(0x9c8)]('confirm-share-link-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x20fb6b),document[_0x4aca80(0x9c8)](_0x4aca80(0x9e8))['addEventListener']('change',_0x14a17e),document['getElementById'](_0x4aca80(0xa92))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x158dea),document[_0x4aca80(0x9c8)](_0x4aca80(0xb0d))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x26a28c),document[_0x4aca80(0x9c8)](_0x4aca80(0xed0))[_0x4aca80(0xa0f)]('click',()=>{const _0x31dfde=_0x4aca80;_0xe5834e(_0x31dfde(0x1056));}),document['getElementById'](_0x4aca80(0xbaa))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x370cdc=>{const _0x227407=_0x4aca80,_0x112162=_0x370cdc[_0x227407(0x1070)][_0x227407(0xaa0)](_0x227407(0xd6c));_0x112162&&_0x112162[_0x227407(0xc9f)][_0x227407(0x34c)]&&_0x53fe02(parseInt(_0x112162[_0x227407(0xc9f)]['recordId']));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x515))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x3e7fa4=_0x4aca80;document['getElementById']('call-transcript-modal')[_0x3e7fa4(0x575)][_0x3e7fa4(0x30f)](_0x3e7fa4(0xc3f));}),document['getElementById'](_0x4aca80(0x41f))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2d734a),document['getElementById'](_0x4aca80(0xa57))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x2502df=_0x4aca80;_0x24fb08[_0x2502df(0xa67)]>0x0&&_0x620309();}),document['getElementById'](_0x4aca80(0xd87))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x4afd25),document[_0x4aca80(0x9c8)](_0x4aca80(0x966))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x1a5949=_0x4aca80,_0x33ec7d=_0x9ebf46[_0x1a5949(0x547)][_0x9ebf46[_0x1a5949(0x970)]],_0x21d48d=Array['from'](document['querySelectorAll'](_0x1a5949(0x1107)))[_0x1a5949(0xa3b)](_0x90a031=>_0x90a031['dataset'][_0x1a5949(0x54d)]);if(_0x21d48d[_0x1a5949(0xa06)]===0x0){alert(_0x1a5949(0xb5f));return;}const _0x329ca6=[],_0x33e131=[..._0x24fb08]['sort']((_0x10d13f,_0x528d77)=>_0x10d13f-_0x528d77);for(const _0x1d38f6 of _0x33e131){const _0x203f3c=_0x33ec7d[_0x1a5949(0x8b3)][_0x1a5949(0xfc3)](_0x4b900f=>_0x4b900f['timestamp']===_0x1d38f6);_0x203f3c&&_0x329ca6[_0x1a5949(0x668)](_0x203f3c);}const _0xa675e3={'role':'user','senderName':_0x33ec7d[_0x1a5949(0x11e4)]?_0x33ec7d[_0x1a5949(0x1131)][_0x1a5949(0x29c)]||'我':'我','type':'share_card','timestamp':Date[_0x1a5949(0x9b7)](),'payload':{'sourceChatName':_0x33ec7d[_0x1a5949(0x609)],'title':_0x1a5949(0x66f)+_0x33ec7d['name']+_0x1a5949(0xf99),'sharedHistory':_0x329ca6}};for(const _0x554823 of _0x21d48d){const _0x7a199e=_0x9ebf46[_0x1a5949(0x547)][_0x554823];_0x7a199e&&(_0x7a199e[_0x1a5949(0x8b3)][_0x1a5949(0x668)](_0xa675e3),await _0x2c5bcf[_0x1a5949(0x547)][_0x1a5949(0xff5)](_0x7a199e));}document[_0x1a5949(0x9c8)](_0x1a5949(0x838))['classList'][_0x1a5949(0x30f)]('visible'),_0x2d6552(),await _0x1bff53(_0x1a5949(0x937),_0x1a5949(0x7b3)+_0x21d48d[_0x1a5949(0xa06)]+'\x20个会话中。'),_0x394b2c();}),document[_0x4aca80(0x9c8)](_0x4aca80(0xf2c))['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x4edd5b=_0x4aca80;document[_0x4edd5b(0x9c8)]('share-target-modal')[_0x4edd5b(0x575)][_0x4edd5b(0x30f)]('visible');}),document['getElementById'](_0x4aca80(0xbff))[_0x4aca80(0xa0f)]('click',_0x1a4ed4=>{const _0x16c072=_0x4aca80,_0x32439b=_0x1a4ed4[_0x16c072(0x1070)][_0x16c072(0xaa0)]('.link-share-card[data-timestamp]');if(_0x32439b&&_0x32439b[_0x16c072(0xaa0)]('.message-bubble.is-link-share')){const _0x1d840a=parseInt(_0x32439b[_0x16c072(0xc9f)][_0x16c072(0x6b5)]);_0x1ca9d6(_0x1d840a);}}),document[_0x4aca80(0x9c8)](_0x4aca80(0xae0))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x27f95d=_0x4aca80;document[_0x27f95d(0x9c8)](_0x27f95d(0x2b8))[_0x27f95d(0x575)][_0x27f95d(0x30f)](_0x27f95d(0xc3f));});async function _0x1ca9d6(_0x279982){const _0x593ed5=_0x4aca80,_0x527e5c=_0x9ebf46[_0x593ed5(0x547)][_0x9ebf46[_0x593ed5(0x970)]],_0x10f793=_0x527e5c[_0x593ed5(0x8b3)][_0x593ed5(0xfc3)](_0x12a35a=>_0x12a35a[_0x593ed5(0x6b5)]===_0x279982);if(!_0x10f793||_0x10f793[_0x593ed5(0x12d9)]!==_0x593ed5(0x81e)||!_0x10f793['payload']){console[_0x593ed5(0x1221)]('无法找到或消息类型/内容不匹配的分享记录:',_0x279982),await _0x1bff53(_0x593ed5(0xb8a),_0x593ed5(0x1b1));return;}const _0x80ac1=document[_0x593ed5(0x9c8)](_0x593ed5(0x2b8)),_0x3c213d=document[_0x593ed5(0x9c8)]('shared-history-viewer-title'),_0x378d0c=document['getElementById']('shared-history-viewer-content');_0x3c213d[_0x593ed5(0xe24)]=_0x10f793[_0x593ed5(0xd26)]['title'],_0x378d0c[_0x593ed5(0x2f5)]='';const _0x4cce7c=document[_0x593ed5(0x5a2)](),_0x163889=Object[_0x593ed5(0xeb2)](_0x9ebf46[_0x593ed5(0x547)])[_0x593ed5(0xfc3)](_0x2ec1ad=>_0x2ec1ad[_0x593ed5(0x609)]===_0x10f793[_0x593ed5(0xd26)][_0x593ed5(0xd0f)])||_0x527e5c;for(const _0x5d8cd7 of _0x10f793['payload']['sharedHistory']){const _0x15e5e9=await _0x8ae2cf(_0x5d8cd7,_0x163889);_0x15e5e9&&_0x4cce7c[_0x593ed5(0x7b9)](_0x15e5e9);}_0x378d0c['appendChild'](_0x4cce7c),_0x80ac1[_0x593ed5(0x575)][_0x593ed5(0x68e)](_0x593ed5(0xc3f));}_0x287389['addEventListener'](_0x4aca80(0x741),_0x1d5b7a),_0x287389['addEventListener'](_0x4aca80(0x6f2),()=>{const _0x470804=_0x4aca80;_0x5062a9['isActive']&&(_0x5062a9[_0x470804(0x50c)]=![],_0x424265());}),_0x287389[_0x4aca80(0xa0f)]('play',()=>{const _0x811783=_0x4aca80;_0x5062a9[_0x811783(0x103f)]&&(_0x5062a9[_0x811783(0x50c)]=!![],_0x424265());}),document['getElementById'](_0x4aca80(0x1c8))['addEventListener'](_0x4aca80(0xf5c),async _0x16b9bc=>{const _0x457917=_0x4aca80,_0xca84cc=_0x16b9bc['target'],_0x3af71e=_0xca84cc[_0x457917(0xaa0)](_0x457917(0x6ef));if(_0x3af71e){const _0x40c502=parseInt(_0x3af71e[_0x457917(0xc9f)][_0x457917(0x45a)]);!isNaN(_0x40c502)&&await _0x357753(_0x40c502);return;}const _0x2e527a=_0xca84cc[_0x457917(0xaa0)](_0x457917(0x8a2));if(_0x2e527a){const _0x571474=parseInt(_0x2e527a[_0x457917(0xc9f)][_0x457917(0x45a)]);if(isNaN(_0x571474))return;await _0x140b9a(_0x571474);return;}const _0x419987=_0xca84cc[_0x457917(0xaa0)](_0x457917(0xc1c));if(_0x419987){const _0xb220d2=parseInt(_0x419987[_0x457917(0xc9f)][_0x457917(0x45a)]);if(isNaN(_0xb220d2))return;const _0x34d28c=_0x5062a9['playlist'][_0xb220d2],_0x230993=await _0x352ae9(_0x457917(0x23c),'确定要从播放列表中删除《'+_0x34d28c[_0x457917(0x609)]+_0x457917(0xf50));_0x230993&&_0x4d498f(_0xb220d2);return;}const _0x9984ee=_0xca84cc[_0x457917(0xaa0)]('.playlist-item-info');if(_0x9984ee){const _0x13257a=_0x9984ee['closest'](_0x457917(0x10e7)),_0xda12fb=Array[_0x457917(0x13a5)](_0x13257a[_0x457917(0x193)][_0x457917(0xa9a)])['indexOf'](_0x13257a);_0xda12fb>-0x1&&_0x187421(_0xda12fb);}}),document[_0x4aca80(0x91d)](_0x4aca80(0xe38))[_0x4aca80(0xa0f)]('click',_0xcb0216=>{const _0x461c4a=_0x4aca80;if(!_0x287389[_0x461c4a(0xa24)])return;const _0x25bf6b=_0xcb0216[_0x461c4a(0x31a)],_0x44faa7=_0x25bf6b['clientWidth'],_0x38c9d6=_0xcb0216['offsetX'];_0x287389['currentTime']=_0x38c9d6/_0x44faa7*_0x287389['duration'];}),document['getElementById'](_0x4aca80(0xbff))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x5e08b4=>{const _0x3bf4d0=_0x4aca80,_0x498d24=_0x5e08b4[_0x3bf4d0(0x1070)][_0x3bf4d0(0xaa0)](_0x3bf4d0(0x84f));if(_0x498d24){const _0x52865a=_0x9ebf46[_0x3bf4d0(0x547)][_0x9ebf46[_0x3bf4d0(0x970)]],_0x242803=_0x498d24[_0x3bf4d0(0xaa0)](_0x3bf4d0(0x6f0));if(_0x52865a&&_0x242803){const _0x44aff0=parseInt(_0x242803['dataset'][_0x3bf4d0(0x6b5)]),_0x1cf292=_0x52865a[_0x3bf4d0(0x8b3)][_0x3bf4d0(0xfc3)](_0x4f241b=>_0x4f241b[_0x3bf4d0(0x6b5)]===_0x44aff0);if(_0x1cf292&&_0x1cf292[_0x3bf4d0(0x6c2)]){let _0xf840a9='';const _0x462cc8=_0x1cf292[_0x3bf4d0(0x6c2)];switch(_0x462cc8[_0x3bf4d0(0x22e)]){case _0x3bf4d0(0xbb7):_0xf840a9=_0x3bf4d0(0xed7)+_0x462cc8[_0x3bf4d0(0x489)]+'\x22';break;case _0x3bf4d0(0x560):case'ai_image':case _0x3bf4d0(0xf74):_0xf840a9='[图片/文字图]\x20描述:\x20\x22'+_0x462cc8['originalContent']+'\x22';break;case _0x3bf4d0(0x10c1):_0xf840a9='[语音]\x20内容:\x20\x22'+_0x462cc8['originalContent']+'\x22';break;case'sticker':_0xf840a9='[表情]\x20含义:\x20\x22'+(_0x462cc8[_0x3bf4d0(0x105b)]||_0x3bf4d0(0xff2))+_0x3bf4d0(0x33e)+_0x462cc8['originalContent'];break;case _0x3bf4d0(0x975):_0xf840a9=_0x3bf4d0(0x196);break;default:_0xf840a9='撤回了一条['+_0x462cc8[_0x3bf4d0(0x22e)]+_0x3bf4d0(0x1067)+JSON[_0x3bf4d0(0xf1e)](_0x462cc8[_0x3bf4d0(0x489)]);break;}_0x1bff53(_0x3bf4d0(0xed8),_0xf840a9);}}}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x131d))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x497da2),document[_0x4aca80(0x9c8)]('close-category-manager-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0xec0d2=_0x4aca80;document['getElementById'](_0xec0d2(0xf16))[_0xec0d2(0x575)][_0xec0d2(0x30f)]('visible'),_0x3ce340();}),document[_0x4aca80(0x9c8)](_0x4aca80(0xc50))['addEventListener'](_0x4aca80(0xf5c),_0x2babf0),document[_0x4aca80(0x9c8)](_0x4aca80(0xb96))[_0x4aca80(0xa0f)]('click',_0x21a9b0=>{const _0x1e6791=_0x4aca80;if(_0x21a9b0[_0x1e6791(0x1070)][_0x1e6791(0x575)][_0x1e6791(0x1038)](_0x1e6791(0x5ae))){const _0x2addec=parseInt(_0x21a9b0['target']['dataset']['id']);_0x5b5362(_0x2addec);}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x824))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1b1003),document['getElementById'](_0x4aca80(0xb59))[_0x4aca80(0xa0f)]('click',_0xf09c12),document['getElementById'](_0x4aca80(0x13aa))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x544651),document[_0x4aca80(0x9c8)](_0x4aca80(0xd8b))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2e3e2c),document[_0x4aca80(0x9c8)](_0x4aca80(0x958))[_0x4aca80(0xa0f)](_0x4aca80(0x11ce),_0x34152b=>{const _0x592a51=_0x4aca80;if(!_0x34152b[_0x592a51(0x1070)][_0x592a51(0xddb)](_0x592a51(0x4d2)))return;const _0x5cb87d=_0x34152b[_0x592a51(0x1070)],_0x148035=_0x5cb87d[_0x592a51(0xaa0)](_0x592a51(0x90f));if(!_0x148035)return;const _0x303395=_0x148035[_0x592a51(0x91d)](_0x592a51(0x81a)),_0x504fd2=_0x5cb87d['value'],_0x23bfd7=_0x504fd2[_0x592a51(0x12c2)](/@([\p{L}\w]*)$/u);if(_0x23bfd7){const _0x5b93e0=new Set(),_0x153d09=_0x148035['querySelector']('.post-nickname')?.[_0x592a51(0xe24)];if(_0x153d09)_0x5b93e0[_0x592a51(0x68e)](_0x153d09);_0x148035[_0x592a51(0x7e4)]('.commenter-name')[_0x592a51(0x591)](_0x3d96b7=>{const _0x100f64=_0x592a51;_0x5b93e0[_0x100f64(0x68e)](_0x3d96b7[_0x100f64(0xe24)][_0x100f64(0x459)](':',''));}),_0x5b93e0['delete'](_0x9ebf46[_0x592a51(0x32c)]['nickname']),_0x303395[_0x592a51(0x2f5)]='';if(_0x5b93e0[_0x592a51(0xa67)]>0x0){const _0x378173=_0x23bfd7[0x1];_0x5b93e0[_0x592a51(0x591)](_0x3f677e=>{const _0x11d28c=_0x592a51;if(_0x3f677e['toLowerCase']()[_0x11d28c(0x930)](_0x378173[_0x11d28c(0xc61)]())){const _0xc7c1e0=document[_0x11d28c(0x28a)]('div');_0xc7c1e0[_0x11d28c(0x82c)]=_0x11d28c(0xa85),_0xc7c1e0[_0x11d28c(0xe24)]=_0x3f677e,_0xc7c1e0['addEventListener'](_0x11d28c(0x124a),_0x16894a=>{const _0x413fb9=_0x11d28c;_0x16894a['preventDefault']();const _0x427d4d=_0x504fd2[_0x413fb9(0xc34)](0x0,_0x23bfd7[_0x413fb9(0x45a)])+('@'+_0x3f677e+'\x20');_0x5cb87d[_0x413fb9(0x1155)]=_0x427d4d,_0x303395[_0x413fb9(0x5e1)][_0x413fb9(0x3c5)]=_0x413fb9(0x8f6),_0x5cb87d['focus']();}),_0x303395['appendChild'](_0xc7c1e0);}}),_0x303395[_0x592a51(0x5e1)][_0x592a51(0x3c5)]=_0x303395[_0x592a51(0xa9a)]['length']>0x0?_0x592a51(0x3d9):_0x592a51(0x8f6);}else _0x303395[_0x592a51(0x5e1)][_0x592a51(0x3c5)]='none';}else _0x303395[_0x592a51(0x5e1)]['display']=_0x592a51(0x8f6);}),document[_0x4aca80(0x9c8)](_0x4aca80(0x958))[_0x4aca80(0xa0f)]('focusout',_0x30c185=>{const _0x52e603=_0x4aca80;if(_0x30c185[_0x52e603(0x1070)]['matches'](_0x52e603(0x4d2))){const _0x42bbf1=_0x30c185[_0x52e603(0x1070)][_0x52e603(0xaa0)](_0x52e603(0x90f));if(_0x42bbf1){const _0x46a91c=_0x42bbf1['querySelector'](_0x52e603(0x81a));_0x46a91c&&setTimeout(()=>{const _0x1c1bd7=_0x52e603;_0x46a91c[_0x1c1bd7(0x5e1)]['display']=_0x1c1bd7(0x8f6);},0xc8);}}});const _0xb2e9cd=document['getElementById'](_0x4aca80(0x38e)),_0x196f8a=document[_0x4aca80(0x9c8)]('chat-at-mention-popup');_0xb2e9cd[_0x4aca80(0xa0f)](_0x4aca80(0x11ce),()=>{const _0x4bab18=_0x4aca80;if(!_0x9ebf46[_0x4bab18(0x970)]||!_0x9ebf46[_0x4bab18(0x547)][_0x9ebf46[_0x4bab18(0x970)]]['isGroup']){_0x196f8a['style'][_0x4bab18(0x3c5)]='none';return;}const _0x800541=_0x9ebf46['chats'][_0x9ebf46[_0x4bab18(0x970)]],_0x12365d=_0xb2e9cd[_0x4bab18(0x1155)],_0x5a71c9=_0x12365d[_0x4bab18(0x12c2)](/@([\p{L}\w]*)$/u);if(_0x5a71c9){const _0x241956=_0x800541['settings'][_0x4bab18(0x29c)]||'我',_0x5971f0=_0x800541[_0x4bab18(0xd3e)]['map'](_0x321362=>_0x321362[_0x4bab18(0x1132)])[_0x4bab18(0x401)](_0x1e42b1=>_0x1e42b1!==_0x241956);_0x196f8a[_0x4bab18(0x2f5)]='';if(_0x5971f0[_0x4bab18(0xa06)]>0x0){const _0x573f13=_0x5a71c9[0x1];_0x5971f0[_0x4bab18(0x591)](_0x2eba8d=>{const _0x4bf823=_0x4bab18;if(_0x2eba8d[_0x4bf823(0xc61)]()[_0x4bf823(0x930)](_0x573f13['toLowerCase']())){const _0x579e56=document['createElement'](_0x4bf823(0x11f4));_0x579e56[_0x4bf823(0x82c)]='at-mention-item',_0x579e56[_0x4bf823(0xe24)]=_0x2eba8d,_0x579e56[_0x4bf823(0xa0f)](_0x4bf823(0x124a),_0x537873=>{const _0xc3cb90=_0x4bf823;_0x537873['preventDefault']();const _0x3f22f1=_0x12365d[_0xc3cb90(0xc34)](0x0,_0x5a71c9[_0xc3cb90(0x45a)])+('@'+_0x2eba8d+'\x20');_0xb2e9cd[_0xc3cb90(0x1155)]=_0x3f22f1,_0x196f8a['style'][_0xc3cb90(0x3c5)]=_0xc3cb90(0x8f6),_0xb2e9cd[_0xc3cb90(0x6fd)]();}),_0x196f8a['appendChild'](_0x579e56);}}),_0x196f8a[_0x4bab18(0x5e1)][_0x4bab18(0x3c5)]=_0x196f8a[_0x4bab18(0xa9a)][_0x4bab18(0xa06)]>0x0?'block':_0x4bab18(0x8f6);}else _0x196f8a[_0x4bab18(0x5e1)]['display']=_0x4bab18(0x8f6);}else _0x196f8a[_0x4bab18(0x5e1)][_0x4bab18(0x3c5)]=_0x4bab18(0x8f6);}),_0xb2e9cd[_0x4aca80(0xa0f)](_0x4aca80(0x1e8),()=>{setTimeout(()=>{const _0x229171=_0x3569;_0x196f8a[_0x229171(0x5e1)]['display']=_0x229171(0x8f6);},0xc8);}),document['getElementById']('publish-to-announcement-btn')['addEventListener'](_0x4aca80(0xf5c),_0x3c9fd1),document[_0x4aca80(0x9c8)](_0x4aca80(0x419))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x5f5004),document[_0x4aca80(0x9c8)](_0x4aca80(0xaa9))['addEventListener']('click',()=>{const _0x4f8743=_0x4aca80;document[_0x4f8743(0x9c8)](_0x4f8743(0x12c7))['classList'][_0x4f8743(0x30f)]('visible');}),document[_0x4aca80(0x9c8)](_0x4aca80(0xcf0))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3fbd13=>{const _0xd4e9b6=_0x4aca80;if(_0x3fbd13['target']['classList'][_0xd4e9b6(0x1038)]('announcement-item-actions')){const _0x55da9a=_0x3fbd13[_0xd4e9b6(0x1070)][_0xd4e9b6(0xc9f)][_0xd4e9b6(0x11e7)];_0x55da9a&&_0x32dae6(_0x55da9a);}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x3b1))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x194867),document[_0x4aca80(0x9c8)](_0x4aca80(0x3ca))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x48deb6),document[_0x4aca80(0x9c8)](_0x4aca80(0xfc4))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x172714=_0x4aca80;document[_0x172714(0x9c8)](_0x172714(0x2fd))[_0x172714(0x575)]['remove'](_0x172714(0xc3f));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xb63))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x70844b=_0x4aca80;document[_0x70844b(0x9c8)](_0x70844b(0x3c7))[_0x70844b(0x1155)]='';}),document[_0x4aca80(0x9c8)](_0x4aca80(0xdd8))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x31649c),document['getElementById'](_0x4aca80(0x2ed))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0xa4b71b=_0x4aca80;_0xe5834e(_0xa4b71b(0x504));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x7b0))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x115c29),document[_0x4aca80(0x9c8)]('summarize-recent-btn-header')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x483fba),document[_0x4aca80(0x9c8)](_0x4aca80(0x4aa))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x880bf4=>{const _0x36bb78=_0x4aca80,_0x509012=_0x880bf4['target'][_0x36bb78(0xaa0)]('.edit-memory-btn');if(_0x509012){_0xb928f5(_0x509012[_0x36bb78(0xc9f)][_0x36bb78(0x61c)],parseInt(_0x509012[_0x36bb78(0xc9f)][_0x36bb78(0xba7)]));return;}const _0x2c85bc=_0x880bf4[_0x36bb78(0x1070)]['closest'](_0x36bb78(0x4fe));if(_0x2c85bc){_0x10a005(_0x2c85bc[_0x36bb78(0xc9f)]['authorId'],parseInt(_0x2c85bc[_0x36bb78(0xc9f)]['memoryTimestamp']));return;}}),document[_0x4aca80(0x9c8)]('gomoku-btn')[_0x4aca80(0xa0f)]('click',_0x45dfb4),document[_0x4aca80(0x9c8)](_0x4aca80(0x870))[_0x4aca80(0xa0f)]('click',_0x45247c);const _0x256997=document['getElementById']('gomoku-board');_0x256997[_0x4aca80(0xa0f)](_0x4aca80(0x726),_0x35b4b2),_0x256997[_0x4aca80(0xa0f)](_0x4aca80(0xbe1),()=>_0x34de8e(_0x9ebf46[_0x4aca80(0x970)])),_0x256997[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0xc1143e),document[_0x4aca80(0x9c8)]('add-countdown-btn')[_0x4aca80(0xa0f)]('click',()=>{const _0x40cad1=_0x4aca80;document[_0x40cad1(0x9c8)]('countdown-title-input')[_0x40cad1(0x1155)]='',document[_0x40cad1(0x9c8)](_0x40cad1(0x3af))[_0x40cad1(0x1155)]='',document[_0x40cad1(0x9c8)](_0x40cad1(0x1304))[_0x40cad1(0x575)][_0x40cad1(0x68e)]('visible');}),document[_0x4aca80(0x9c8)](_0x4aca80(0x80c))[_0x4aca80(0xa0f)]('click',()=>{const _0x241284=_0x4aca80;document[_0x241284(0x9c8)](_0x241284(0x1304))[_0x241284(0x575)][_0x241284(0x30f)](_0x241284(0xc3f));}),document['getElementById'](_0x4aca80(0x706))['addEventListener'](_0x4aca80(0xf5c),_0x2f9550),document['getElementById']('delete-call-message-btn')[_0x4aca80(0xa0f)]('click',_0x5e4cf2),document[_0x4aca80(0x9c8)](_0x4aca80(0x500))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x5aeb4a),document[_0x4aca80(0x9c8)]('edit-last-response-btn')['addEventListener'](_0x4aca80(0xf5c),_0x155696),document[_0x4aca80(0x9c8)](_0x4aca80(0xff1))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x484d5c=_0x4aca80;document[_0x484d5c(0x9c8)](_0x484d5c(0xdfd))[_0x484d5c(0x575)][_0x484d5c(0x30f)]('visible');}),document[_0x4aca80(0x9c8)](_0x4aca80(0xe86))[_0x4aca80(0xa0f)]('click',_0x4cc032),document[_0x4aca80(0x9c8)](_0x4aca80(0x1098))[_0x4aca80(0xa0f)]('click',()=>{const _0xe4c909=_0x4aca80,_0x262c65=document[_0xe4c909(0x9c8)](_0xe4c909(0x913)),_0x7e409d=_0x27e7dc(_0xe4c909(0xc8e));_0x262c65[_0xe4c909(0x7b9)](_0x7e409d),_0x7e409d['querySelector'](_0xe4c909(0x11f9))['focus']();}),document[_0x4aca80(0x9c8)](_0x4aca80(0xbe3))[_0x4aca80(0xa0f)]('click',_0x392db6),document[_0x4aca80(0x9c8)](_0x4aca80(0x1009))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0xd8608e),document['getElementById']('add-my-avatar-url-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3f837f),document['getElementById'](_0x4aca80(0xac7))['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x1a1d63=_0x4aca80;document[_0x1a1d63(0x9c8)](_0x1a1d63(0x4f0))[_0x1a1d63(0xf5c)]();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x4f0))['addEventListener'](_0x4aca80(0x25c),_0x26575d),document[_0x4aca80(0x9c8)](_0x4aca80(0xac9))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x2317dd=_0x4aca80,_0x5083ed=_0x2317dd(0x878),_0x461bd5=await _0xadb5df(_0x2317dd(0x1263),_0x5083ed,'',_0x2317dd(0x11f9));_0x461bd5&&_0x461bd5['trim']()&&await _0x39c46b(_0x461bd5);}),document['getElementById']('open-shopping-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0xc47e0b),document[_0x4aca80(0x9c8)]('shopping-back-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>_0xe5834e(_0x4aca80(0x504))),document[_0x4aca80(0x9c8)](_0x4aca80(0xc93))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1f3158),document[_0x4aca80(0x9c8)]('cart-back-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0xc47e0b),document['getElementById'](_0x4aca80(0x72d))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x5b256d),document[_0x4aca80(0x9c8)](_0x4aca80(0x120a))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x54081d=_0x4aca80;document['getElementById']('gift-receipt-modal')[_0x54081d(0x575)][_0x54081d(0x30f)](_0x54081d(0xc3f));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x350))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x1d2d98=_0x4aca80;_0x4a73f0=!_0x4a73f0;const _0x53c1ce=document[_0x1d2d98(0x9c8)]('manage-products-btn'),_0x3b7735=document[_0x1d2d98(0x9c8)](_0x1d2d98(0x11a3)),_0x3cd416=document[_0x1d2d98(0x9c8)]('product-grid');_0x53c1ce[_0x1d2d98(0x5e1)][_0x1d2d98(0xf84)]=_0x4a73f0?_0x1d2d98(0x12c5):_0x1d2d98(0x12b1),_0x4a73f0?(_0x3b7735[_0x1d2d98(0x5e1)][_0x1d2d98(0x3c5)]=_0x1d2d98(0x989),_0x3cd416[_0x1d2d98(0x5e1)][_0x1d2d98(0xf8c)]=_0x1d2d98(0x54a)):(_0x3b7735['style']['display']=_0x1d2d98(0x8f6),_0x3cd416[_0x1d2d98(0x5e1)][_0x1d2d98(0xf8c)]='',_0x524d97[_0x1d2d98(0xdae)](),document[_0x1d2d98(0x7e4)](_0x1d2d98(0x390))[_0x1d2d98(0x591)](_0x1f7407=>_0x1f7407[_0x1d2d98(0x575)][_0x1d2d98(0x30f)](_0x1d2d98(0x631))),document[_0x1d2d98(0x9c8)](_0x1d2d98(0xfde))[_0x1d2d98(0xe24)]=_0x1d2d98(0x2b4),document['getElementById'](_0x1d2d98(0xb41))[_0x1d2d98(0x1ec)]=![]),_0x3fe79f(),_0x249f8f();}),document[_0x4aca80(0x9c8)]('add-new-product-btn')['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x239e90=_0x4aca80;_0x4a73f0?_0x387b4a(null):alert(_0x239e90(0x88c));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xd3a))['addEventListener'](_0x4aca80(0xf5c),async _0x20b52d=>{const _0x296091=_0x4aca80,_0x5df10e=_0x20b52d[_0x296091(0x1070)][_0x296091(0xaa0)](_0x296091(0x1083));if(!_0x5df10e)return;const _0x293370=parseInt(_0x5df10e[_0x296091(0xc9f)]['id']);if(isNaN(_0x293370))return;if(_0x4a73f0){if(_0x20b52d[_0x296091(0x1070)]['classList'][_0x296091(0x1038)](_0x296091(0x76c))){_0x387b4a(_0x293370);return;}if(_0x20b52d[_0x296091(0x1070)][_0x296091(0x575)][_0x296091(0x1038)]('delete-product-btn')){const _0x6ac5f8=await _0x2c5bcf[_0x296091(0x281)]['get'](_0x293370);if(!_0x6ac5f8)return;const _0xc2a7ba=await _0x352ae9(_0x296091(0x1d8),_0x296091(0xcca)+_0x6ac5f8[_0x296091(0x609)]+'”\x20吗？',{'confirmButtonClass':_0x296091(0x12bc)});_0xc2a7ba&&(await _0x2c5bcf[_0x296091(0x281)][_0x296091(0x6d2)](_0x293370),await _0x3fe79f(),alert(_0x296091(0xc4d)));return;}_0x5df10e['classList'][_0x296091(0x1c3)](_0x296091(0x631));_0x524d97[_0x296091(0xd97)](_0x293370)?_0x524d97['delete'](_0x293370):_0x524d97[_0x296091(0x68e)](_0x293370);document[_0x296091(0x9c8)](_0x296091(0xfde))[_0x296091(0xe24)]=_0x296091(0xf53)+_0x524d97[_0x296091(0xa67)]+')';return;}if(_0x20b52d[_0x296091(0x1070)][_0x296091(0x575)][_0x296091(0x1038)]('add-to-cart-btn')){const _0x84dd5=await _0x2c5bcf['shoppingProducts'][_0x296091(0xdf9)](_0x293370);_0x84dd5[_0x296091(0x230)]&&_0x84dd5['variations'][_0x296091(0xa06)]>0x0?_0x4598e6(_0x293370):(await _0x111b4e(_0x293370),await _0x1bff53('成功',_0x296091(0xdac)));return;}_0x5df10e[_0x296091(0x1038)](_0x20b52d[_0x296091(0x1070)])&&console[_0x296091(0x283)](_0x296091(0x132d)+_0x293370);}),document[_0x4aca80(0x9c8)](_0x4aca80(0x92a))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2f2116=>{const _0x97e4=_0x4aca80,_0x587a2e=_0x2f2116[_0x97e4(0x1070)];_0x587a2e['classList']['contains']('decrease-qty-btn')&&_0x531bcf(parseInt(_0x587a2e['dataset']['id']),-0x1),_0x587a2e[_0x97e4(0x575)][_0x97e4(0x1038)](_0x97e4(0x1e5))&&_0x531bcf(parseInt(_0x587a2e[_0x97e4(0xc9f)]['id']),0x1),_0x587a2e[_0x97e4(0x575)]['contains'](_0x97e4(0x1045))&&_0x5aa993();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x7cc))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x23c29f=_0x4aca80;if(_0x220929[_0x23c29f(0xa06)]===0x0)return;const _0x31d472=await _0x352ae9('清空购物车','确定要清空购物车中的所有商品吗？');_0x31d472&&(_0x220929=[],_0x16a3f7(),_0x1576ec());}),document[_0x4aca80(0x9c8)](_0x4aca80(0x19a))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),function(_0x4a6dff){const _0x4023e7=_0x4aca80;document[_0x4023e7(0x7e4)](_0x4023e7(0x1375))['forEach'](_0x21acfe=>{const _0x34f1cc=_0x4023e7;_0x21acfe[_0x34f1cc(0x1ec)]=_0x4a6dff['target']['checked'];}),_0x5aa993();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x1ca))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x106f15=_0x4aca80;document[_0x106f15(0x9c8)]('product-editor-modal')[_0x106f15(0x575)]['remove']('visible');}),document[_0x4aca80(0x9c8)](_0x4aca80(0x123c))['addEventListener'](_0x4aca80(0xf5c),_0x4f893d),document['getElementById'](_0x4aca80(0xcbb))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),_0x332035=>{const _0x721abd=_0x4aca80,_0x8baae8=_0x332035[_0x721abd(0x1070)]['files'][0x0];if(_0x8baae8){const _0x23746d=new FileReader();_0x23746d[_0x721abd(0x429)]=_0x21214c=>{const _0x2b50b8=_0x721abd;document[_0x2b50b8(0x9c8)](_0x2b50b8(0x830))['src']=_0x21214c[_0x2b50b8(0x1070)][_0x2b50b8(0xceb)];},_0x23746d['readAsDataURL'](_0x8baae8);}}),document[_0x4aca80(0x9c8)](_0x4aca80(0xbff))['addEventListener']('click',_0x28f3e7=>{const _0x33a450=_0x4aca80,_0x15b3e8=_0x28f3e7[_0x33a450(0x1070)][_0x33a450(0xaa0)](_0x33a450(0x139d));if(_0x15b3e8){const _0x448e57=_0x15b3e8[_0x33a450(0xaa0)]('.message-bubble');_0x448e57&&_0x52a403(parseInt(_0x448e57[_0x33a450(0xc9f)]['timestamp']));}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x6c0))[_0x4aca80(0xa0f)]('click',()=>{const _0x15f021=_0x4aca80;document[_0x15f021(0x9c8)](_0x15f021(0xb62))[_0x15f021(0x575)]['remove'](_0x15f021(0xc3f));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xfdd))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x490821=_0x4aca80,_0x272d00=Array[_0x490821(0x13a5)](document[_0x490821(0x7e4)](_0x490821(0xd9a)))[_0x490821(0xa3b)](_0x48e5f0=>_0x48e5f0[_0x490821(0xc9f)]['recipientName']);if(_0x272d00[_0x490821(0xa06)]===0x0){alert(_0x490821(0x106a));return;}const _0x4f4c0d=_0x220929[_0x490821(0x401)](_0x5448d0=>document[_0x490821(0x91d)]('.cart-item-checkbox[data-id=\x22'+_0x5448d0['productId']+_0x490821(0x1175)));await _0x36c88e(_0x4f4c0d,_0x272d00),document[_0x490821(0x9c8)]('gift-recipient-modal')[_0x490821(0x575)]['remove'](_0x490821(0xc3f));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xe43))['addEventListener'](_0x4aca80(0xf5c),_0x21d5a5=>{const _0x3b5c3f=_0x4aca80,_0x229b47=_0x21d5a5[_0x3b5c3f(0x1070)][_0x3b5c3f(0xaa0)](_0x3b5c3f(0x422));_0x229b47&&_0x229b47[_0x3b5c3f(0x575)][_0x3b5c3f(0x1c3)]('selected');}),document['getElementById'](_0x4aca80(0x376))['addEventListener'](_0x4aca80(0x25c),function(_0x586aed){const _0x150b7a=_0x4aca80,_0x45a45f=_0x586aed[_0x150b7a(0x1070)]['checked'];document[_0x150b7a(0x7e4)](_0x150b7a(0x19e))[_0x150b7a(0x591)](_0x469da9=>{const _0x4d111e=_0x150b7a;_0x469da9[_0x4d111e(0x575)][_0x4d111e(0x1c3)](_0x4d111e(0x631),_0x45a45f);});}),document['getElementById']('regenerate-btn')['addEventListener'](_0x4aca80(0xf5c),_0x213baf),document[_0x4aca80(0x9c8)](_0x4aca80(0x903))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2f2965),document['getElementById'](_0x4aca80(0xb6c))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x40a360),document[_0x4aca80(0x9c8)]('test-sound-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x4cf50e=_0x4aca80,_0x1280d0=document[_0x4cf50e(0x9c8)]('notification-sound-player'),_0x55b6ec=document[_0x4cf50e(0x9c8)](_0x4cf50e(0x89a))[_0x4cf50e(0x1155)][_0x4cf50e(0x3f1)]()||_0x178a2b;_0x1280d0[_0x4cf50e(0xbf4)]=_0x55b6ec,_0x1280d0[_0x4cf50e(0xcc3)]()[_0x4cf50e(0xd7f)](_0x2e8d34=>alert(_0x4cf50e(0xfdf)));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xcdf))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x4c725d=_0x4aca80;document[_0x4c725d(0x9c8)](_0x4c725d(0x89a))[_0x4c725d(0x1155)]='',alert(_0x4c725d(0xd56));}),document['getElementById'](_0x4aca80(0x327))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x30396d=>{const _0x151e85=_0x4aca80,_0x4b4220=_0x30396d[_0x151e85(0x1070)];_0x4b4220['classList'][_0x151e85(0x1038)]('editable-text')&&_0x1a3f1b(_0x4b4220),_0x4b4220[_0x151e85(0x575)]['contains'](_0x151e85(0x4fb))&&_0x2e5dd2(_0x4b4220);}),document['getElementById']('add-song-search-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3c6868),document[_0x4aca80(0x9c8)]('cancel-music-search-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x24fd05=_0x4aca80;document['getElementById'](_0x24fd05(0xb5b))['classList'][_0x24fd05(0x30f)](_0x24fd05(0xc3f));}),document['getElementById'](_0x4aca80(0x1ba))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3c6868),document[_0x4aca80(0x9c8)](_0x4aca80(0xa28))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x21f860=_0x4aca80;document['getElementById']('music-search-results-modal')[_0x21f860(0x575)]['remove'](_0x21f860(0xc3f));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xe4e))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),function(_0x5d0337){const _0xea639e=_0x4aca80;document['querySelectorAll'](_0xea639e(0x10f3))[_0xea639e(0x591)](_0x1db7e2=>{const _0x39d69e=_0xea639e;_0x1db7e2[_0x39d69e(0x1ec)]=_0x5d0337[_0x39d69e(0x1070)][_0x39d69e(0x1ec)];});}),document[_0x4aca80(0x9c8)](_0x4aca80(0x7f0))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x54f467=>{const _0x2f031e=_0x4aca80,_0x5d69ad=_0x54f467['target'][_0x2f031e(0xaa0)]('.search-result-item');if(_0x5d69ad){const _0x51e4e9=_0x5d69ad['querySelector'](_0x2f031e(0x10a2));_0x51e4e9&&(_0x54f467[_0x2f031e(0x1070)]!==_0x51e4e9&&(_0x51e4e9[_0x2f031e(0x1ec)]=!_0x51e4e9[_0x2f031e(0x1ec)]));}}),document['getElementById'](_0x4aca80(0x22d))['addEventListener'](_0x4aca80(0xf5c),async()=>{const _0x538889=_0x4aca80,_0x5d7d5a=document['querySelectorAll'](_0x538889(0x102a));if(_0x5d7d5a[_0x538889(0xa06)]===0x0){alert('请先选择要添加的歌曲。');return;}document[_0x538889(0x9c8)]('music-search-results-modal')[_0x538889(0x575)][_0x538889(0x30f)]('visible'),await _0x1bff53('请稍候...',_0x538889(0x1344)+_0x5d7d5a[_0x538889(0xa06)]+_0x538889(0x1259));const _0x46f49b=Array[_0x538889(0x13a5)](_0x5d7d5a)[_0x538889(0xa3b)](_0x1e91e9=>JSON['parse'](_0x1e91e9[_0x538889(0xaa0)](_0x538889(0xdf7))[_0x538889(0xc9f)][_0x538889(0x9ea)]));let _0x13e6f3=0x0,_0x4e909b=[];const _0xc2336d=_0x46f49b['map'](_0x38dc46=>_0x4e7b18(_0x38dc46)),_0x306404=await Promise[_0x538889(0xd0a)](_0xc2336d);_0x306404['forEach']((_0x44f429,_0x23c619)=>{const _0x23f44e=_0x538889;_0x44f429?(_0x5062a9['playlist']['push'](_0x44f429),_0x13e6f3++):_0x4e909b[_0x23f44e(0x668)](_0x46f49b[_0x23c619][_0x23f44e(0x609)]);});_0x13e6f3>0x0&&(await _0x4b5360(),_0x2330eb(),_0x5062a9[_0x538889(0xcc8)]===-0x1&&(_0x5062a9[_0x538889(0xcc8)]=_0x5062a9[_0x538889(0x8e6)][_0x538889(0xa06)]-_0x13e6f3,_0x424265()));let _0x26522e=_0x538889(0x62c)+_0x13e6f3+_0x538889(0x1099);_0x4e909b[_0x538889(0xa06)]>0x0&&(_0x26522e+='\x0a\x0a'+_0x4e909b[_0x538889(0xa06)]+_0x538889(0xf2a)+_0x4e909b['join'](_0x538889(0x12be))),await _0x1bff53(_0x538889(0x5d7),_0x26522e);}),document[_0x4aca80(0x9c8)]('music-visual-container')[_0x4aca80(0xa0f)]('click',()=>{const _0x3a3782=_0x4aca80;document[_0x3a3782(0x9c8)](_0x3a3782(0x3d1))[_0x3a3782(0x575)]['toggle'](_0x3a3782(0x10b7));}),document[_0x4aca80(0x9c8)]('add-song-search-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3c6868),document[_0x4aca80(0x9c8)](_0x4aca80(0xa28))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x9551d=_0x4aca80;document[_0x9551d(0x9c8)]('music-search-results-modal')['classList'][_0x9551d(0x30f)](_0x9551d(0xc3f));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x7f0))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x12ad55=>{const _0x198964=_0x4aca80,_0x288287=_0x12ad55[_0x198964(0x1070)][_0x198964(0xaa0)]('.search-result-item');if(_0x288287&&_0x288287[_0x198964(0xc9f)][_0x198964(0x9ea)]){const _0x692a09=JSON['parse'](_0x288287[_0x198964(0xc9f)][_0x198964(0x9ea)]);handleSearchResultClick(_0x692a09);}}),document['getElementById']('cleanup-songs-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x569916),document[_0x4aca80(0x9c8)](_0x4aca80(0x47b))['addEventListener'](_0x4aca80(0xf5c),_0xbf1dfc),document[_0x4aca80(0x9c8)]('toggle-fullscreen-btn')['addEventListener']('click',_0x11cad0),document[_0x4aca80(0x9c8)](_0x4aca80(0x1ee))['addEventListener'](_0x4aca80(0xf5c),_0xf3f302),document[_0x4aca80(0x9c8)]('status-bar-toggle-switch')[_0x4aca80(0xa0f)]('change',()=>{const _0x57c8ae=_0x4aca80;_0x9ebf46['globalSettings'][_0x57c8ae(0xb3b)]=document['getElementById'](_0x57c8ae(0x13c2))[_0x57c8ae(0x1ec)],_0x2417f9();}),document[_0x4aca80(0x9c8)]('qzone-more-actions-btn')['addEventListener'](_0x4aca80(0xf5c),_0x373cde),document[_0x4aca80(0x9c8)](_0x4aca80(0x10ee))[_0x4aca80(0xa0f)]('click',()=>{const _0x3bbc60=_0x4aca80;document[_0x3bbc60(0x9c8)](_0x3bbc60(0x1203))[_0x3bbc60(0x575)][_0x3bbc60(0x30f)](_0x3bbc60(0xc3f));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x1f3))[_0x4aca80(0xa0f)]('click',_0x29bda0),document[_0x4aca80(0x9c8)](_0x4aca80(0x5b8))['addEventListener']('click',_0x493658=>{const _0x3c4e47=_0x4aca80,_0x1726c7=_0x493658[_0x3c4e47(0x1070)][_0x3c4e47(0xaa0)]('.clear-posts-item');_0x1726c7&&_0x1726c7[_0x3c4e47(0x575)][_0x3c4e47(0x1c3)](_0x3c4e47(0x631));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xa7e))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),async _0x117c8f=>{const _0x87d6ef=_0x4aca80,_0xbc4688=_0x117c8f[_0x87d6ef(0x1070)][_0x87d6ef(0x1216)][0x0];if(_0xbc4688){const _0x2967a8=await new Promise(_0x105bf7=>{const _0x1f4e52=_0x87d6ef,_0x381d2f=new FileReader();_0x381d2f['onload']=()=>_0x105bf7(_0x381d2f[_0x1f4e52(0xceb)]),_0x381d2f[_0x1f4e52(0xba5)](_0xbc4688);});_0x9ebf46[_0x87d6ef(0x1383)][_0x87d6ef(0x73a)]=_0x2967a8,_0xec3eb7();}_0x117c8f['target'][_0x87d6ef(0x1155)]=null;}),document[_0x4aca80(0x9c8)](_0x4aca80(0x1170))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x42516c=_0x4aca80;_0x9ebf46['globalSettings'][_0x42516c(0x73a)]='',_0xec3eb7();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x4c0))['addEventListener'](_0x4aca80(0xf5c),async()=>{const _0x1e7691=_0x4aca80;_0x3d4f7d&&(_0x9ebf46[_0x1e7691(0x1383)][_0x1e7691(0x1254)]=_0x3d4f7d),_0x9ebf46[_0x1e7691(0x1383)][_0x1e7691(0x911)]=document[_0x1e7691(0x9c8)](_0x1e7691(0x3c7))[_0x1e7691(0x1155)][_0x1e7691(0x3f1)](),_0x9ebf46[_0x1e7691(0x1383)]['notificationSoundUrl']=document[_0x1e7691(0x9c8)]('notification-sound-url-input')[_0x1e7691(0x1155)]['trim'](),_0x9ebf46[_0x1e7691(0x1383)][_0x1e7691(0xb3b)]=document[_0x1e7691(0x9c8)](_0x1e7691(0x13c2))[_0x1e7691(0x1ec)],await _0x2c5bcf[_0x1e7691(0x1383)][_0x1e7691(0xff5)](_0x9ebf46[_0x1e7691(0x1383)]),_0x2a99db(),_0x3d4f7d=null,_0x2ea916(),_0x4bc8ea(_0x9ebf46[_0x1e7691(0x1383)][_0x1e7691(0x911)]),_0x2417f9(),alert('外观设置已保存并应用！'),_0xe5834e('home-screen');}),document[_0x4aca80(0x9c8)](_0x4aca80(0xee2))['addEventListener'](_0x4aca80(0xf5c),async()=>{const _0x1a53e2=_0x4aca80,_0x4915b6=await _0xadb5df('网络图片',_0x1a53e2(0xd5b),'',_0x1a53e2(0x11be));if(_0x4915b6&&_0x4915b6['trim']())_0x9ebf46['globalSettings'][_0x1a53e2(0x73a)]=_0x4915b6[_0x1a53e2(0x3f1)](),_0xec3eb7();else _0x4915b6!==null&&alert(_0x1a53e2(0x13ac));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xab5))['addEventListener'](_0x4aca80(0xf5c),async()=>{const _0x1db4ad=_0x4aca80,_0x205dc9=await _0xadb5df('网络图片\x20(EPhone)',_0x1db4ad(0xfd5),'','url');if(_0x205dc9&&_0x205dc9[_0x1db4ad(0x3f1)]())_0x3d4f7d=_0x205dc9[_0x1db4ad(0x3f1)](),_0xec3eb7();else _0x205dc9!==null&&alert('请输入有效的URL。');}),document['getElementById'](_0x4aca80(0x3a1))[_0x4aca80(0xa0f)]('click',async()=>{const _0x509136=_0x4aca80,_0x4afd68=await _0xadb5df('网络图片\x20(CPhone)','请输入CPhone的背景图片URL','',_0x509136(0x11be));if(_0x4afd68&&_0x4afd68[_0x509136(0x3f1)]())_0x9ebf46[_0x509136(0x1383)]['cphoneWallpaper']=_0x4afd68[_0x509136(0x3f1)](),_0xec3eb7();else _0x4afd68!==null&&alert(_0x509136(0x13ac));}),document['getElementById'](_0x4aca80(0x102e))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x100421=_0x4aca80;_0x3d4f7d=null,_0x9ebf46[_0x100421(0x1383)]['wallpaper']='',_0xec3eb7();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x846))['addEventListener']('click',()=>{const _0x22c431=_0x4aca80;_0x9ebf46['globalSettings'][_0x22c431(0xe0b)]='',_0xec3eb7();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x701))['addEventListener']('change',_0x1e84ed),document[_0x4aca80(0x9c8)](_0x4aca80(0x5ec))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x5712bf),document[_0x4aca80(0x9c8)](_0x4aca80(0x1236))['addEventListener'](_0x4aca80(0xf5c),_0x2028b9),document[_0x4aca80(0x9c8)](_0x4aca80(0x425))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),_0x16c5e7),document[_0x4aca80(0x9c8)](_0x4aca80(0x487))[_0x4aca80(0xa0f)]('click',_0x15e7f5),document[_0x4aca80(0x9c8)]('delete-font-preset-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1c2bde),document['getElementById'](_0x4aca80(0xb91))[_0x4aca80(0xa0f)]('change',_0x56df35),document[_0x4aca80(0x9c8)](_0x4aca80(0x86d))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x49ad17),document[_0x4aca80(0x9c8)](_0x4aca80(0x31c))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3ba351),document[_0x4aca80(0x9c8)](_0x4aca80(0x11ec))[_0x4aca80(0xa0f)]('click',_0x499619),document[_0x4aca80(0x9c8)](_0x4aca80(0x735))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x31cfa0=_0x4aca80;document[_0x31cfa0(0x9c8)](_0x31cfa0(0xc0d))['classList'][_0x31cfa0(0x30f)](_0x31cfa0(0xc3f)),_0x43920d();}),document[_0x4aca80(0x9c8)]('add-new-sticker-category-btn')['addEventListener'](_0x4aca80(0xf5c),_0x33172f),document['getElementById'](_0x4aca80(0x87f))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x547447=>{const _0xc447ce=_0x4aca80;if(_0x547447[_0xc447ce(0x1070)][_0xc447ce(0x575)][_0xc447ce(0x1038)](_0xc447ce(0x5ae))){const _0x2bd151=parseInt(_0x547447[_0xc447ce(0x1070)]['dataset']['id']);_0x4d76c7(_0x2bd151);}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x70a))['addEventListener'](_0x4aca80(0xf5c),_0x7671d7=>{const _0x18a940=_0x4aca80;if(_0x7671d7[_0x18a940(0x1070)][_0x18a940(0x575)]['contains'](_0x18a940(0x1293))){const _0x2bc0cc=_0x7671d7[_0x18a940(0x1070)]['dataset'][_0x18a940(0x408)],_0x462702=_0x2bc0cc!==_0x18a940(0xd0a)&&_0x2bc0cc!==_0x18a940(0x247)?parseInt(_0x2bc0cc):_0x2bc0cc;_0x462b69(_0x462702);}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x10d6))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),_0x36736d),document[_0x4aca80(0x9c8)](_0x4aca80(0x12a3))['addEventListener']('click',_0x11ca72),document[_0x4aca80(0x9c8)](_0x4aca80(0x1095))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x239531=_0x4aca80;document[_0x239531(0x9c8)]('import-single-chat-input')[_0x239531(0xf5c)]();}),document[_0x4aca80(0x9c8)](_0x4aca80(0xb5e))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),_0x217adc=>{const _0x23d9b5=_0x4aca80,_0x2dcead=_0x217adc['target'][_0x23d9b5(0x1216)][0x0];_0x2dcead&&_0x560706(_0x2dcead),_0x217adc[_0x23d9b5(0x1070)][_0x23d9b5(0x1155)]=null;}),document[_0x4aca80(0x9c8)](_0x4aca80(0x27e))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>_0x2e3e51()),document[_0x4aca80(0x9c8)]('add-char-diary-btn')[_0x4aca80(0xa0f)]('click',()=>openDiaryEditor()),document[_0x4aca80(0x9c8)](_0x4aca80(0x1112))[_0x4aca80(0xa0f)]('click',_0x499e1b),document[_0x4aca80(0x9c8)](_0x4aca80(0x52a))[_0x4aca80(0xa0f)]('click',_0x2bbabb),document['getElementById'](_0x4aca80(0x77a))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0xfcaa39),document[_0x4aca80(0x9c8)](_0x4aca80(0xb55))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x2f92fb=_0x4aca80;_0x1bff53(_0x2f92fb(0x8c7),_0x2f92fb(0xc73));try{await Promise['all']([_0x55a14c(),_0x2a8c8a()]),console[_0x2f92fb(0x283)](_0x2f92fb(0xcae));}catch(_0x2cc489){console[_0x2f92fb(0x1221)](_0x2f92fb(0xbfd),_0x2cc489),await _0x1bff53(_0x2f92fb(0x24d),'在执行组合操作时遇到错误:\x20'+_0x2cc489[_0x2f92fb(0x86e)]);}}),document[_0x4aca80(0x9c8)]('char-chat-list')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1d3a3a=>{const _0x27aee3=_0x4aca80,_0x40bb55=_0x1d3a3a[_0x27aee3(0x1070)][_0x27aee3(0xaa0)](_0x27aee3(0x108e));if(_0x40bb55&&_0x40bb55[_0x27aee3(0xc9f)][_0x27aee3(0x761)]){const _0xd89ba7=parseInt(_0x40bb55[_0x27aee3(0xc9f)][_0x27aee3(0x761)]);!isNaN(_0xd89ba7)&&_0x4eb7a8(_0xd89ba7);}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x5e7))[_0x4aca80(0xa0f)]('click',()=>{const _0xa83299=_0x4aca80;_0x5bb1f1(_0xa83299(0xf7b));});const _0x249ded=document['getElementById'](_0x4aca80(0xd68)),_0x19ea1c=()=>{const _0x2b3737=_0x4aca80;if(_0x47adf6!==_0x2b3737(0x7fb))return;if(_0x249ded[_0x2b3737(0x783)]<0x1&&!_0xb426e){const _0x47cb38=_0x9ebf46['chats'][_0x141b83]?.[_0x2b3737(0x8b3)][_0x2b3737(0xa06)]||0x0;_0x47cb38>_0x512a95&&_0x2f6963();}};_0x249ded[_0x4aca80(0xa0f)]('scroll',_0x19ea1c),document[_0x4aca80(0x9c8)](_0x4aca80(0xf80))[_0x4aca80(0xa0f)]('click',()=>{const _0x4b96f4=_0x4aca80;alert(_0x4b96f4(0xc8c));}),document['getElementById'](_0x4aca80(0x770))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x202be7),document[_0x4aca80(0x9c8)]('char-album-grid')[_0x4aca80(0xa0f)]('click',_0x13835c=>{const _0x306a72=_0x4aca80,_0x1abc28=_0x13835c['target'][_0x306a72(0xaa0)](_0x306a72(0x8d9));if(_0x1abc28&&_0x1abc28['dataset'][_0x306a72(0x1387)]){const _0x617c1b=_0x1abc28[_0x306a72(0xc9f)][_0x306a72(0x1387)];_0x1bff53(_0x306a72(0x7ee),_0x617c1b[_0x306a72(0x459)](/\n/g,_0x306a72(0x10d9)));}}),document['getElementById']('regenerate-char-browser-btn')[_0x4aca80(0xa0f)]('click',_0x47894b),document[_0x4aca80(0x9c8)](_0x4aca80(0x139b))['addEventListener'](_0x4aca80(0xf5c),_0x597159),document[_0x4aca80(0x9c8)](_0x4aca80(0x85f))[_0x4aca80(0xa0f)]('click',_0x51a486=>{const _0x3ac465=_0x4aca80,_0x4a9f24=_0x51a486[_0x3ac465(0x1070)][_0x3ac465(0xaa0)]('.char-product-item');if(_0x4a9f24&&_0x4a9f24[_0x3ac465(0xc9f)][_0x3ac465(0x616)]){const _0x394d2b=_0x4a9f24[_0x3ac465(0xc9f)][_0x3ac465(0x616)];_0x1bff53('TA的想法...',_0x394d2b['replace'](/\n/g,'<br>'));}}),window[_0x4aca80(0x3b7)]=_0x1e2733,document[_0x4aca80(0x9c8)]('regenerate-char-memo-btn')['addEventListener']('click',_0x1387e3),document['getElementById']('char-memo-detail-back-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>_0x5bb1f1(_0x4aca80(0x2ae))),document[_0x4aca80(0x9c8)]('regenerate-char-diary-btn')['addEventListener'](_0x4aca80(0xf5c),_0x1c9ef8),document[_0x4aca80(0x9c8)](_0x4aca80(0x6c7))[_0x4aca80(0xa0f)]('click',_0x56a272),document[_0x4aca80(0x9c8)]('char-diary-detail-back-btn')['addEventListener'](_0x4aca80(0xf5c),()=>_0x5bb1f1(_0x4aca80(0x38f))),document['getElementById'](_0x4aca80(0x298))[_0x4aca80(0xa0f)]('click',_0x1ae910),document[_0x4aca80(0x9c8)](_0x4aca80(0xd47))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1027b4),document[_0x4aca80(0x9c8)]('regenerate-char-music-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1ca338),document['getElementById'](_0x4aca80(0x60d))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x23422f),document[_0x4aca80(0x9c8)](_0x4aca80(0x56a))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x5de7c6),document['getElementById']('regenerate-douban-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x5de7c6),document['getElementById']('douban-detail-back-btn')[_0x4aca80(0xa0f)]('click',()=>_0xe5834e('douban-screen')),document[_0x4aca80(0x9c8)](_0x4aca80(0x1e7))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x219a6b),document['getElementById'](_0x4aca80(0xfef))[_0x4aca80(0xa0f)]('click',_0x4f3c88),document[_0x4aca80(0x9c8)](_0x4aca80(0x11a8))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),async _0x2c0bfe=>{const _0x59bce9=_0x4aca80,_0x5e127d=_0x2c0bfe['target'][_0x59bce9(0x1216)][0x0];if(_0x5e127d){const _0x15839d=await new Promise(_0x3c1950=>{const _0x50426a=_0x59bce9,_0x5cad6f=new FileReader();_0x5cad6f['onload']=()=>_0x3c1950(_0x5cad6f[_0x50426a(0xceb)]),_0x5cad6f['readAsDataURL'](_0x5e127d);});_0x9ebf46[_0x59bce9(0x1383)][_0x59bce9(0xe0b)]=_0x15839d,_0xec3eb7();}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x703))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2c6163=>{const _0x47dc1f=_0x4aca80;if(_0x2c6163[_0x47dc1f(0x1070)]['classList']['contains'](_0x47dc1f(0xb66))){const _0xa692d0=_0x2c6163['target']['closest']('.icon-setting-item'),_0x57f236=_0xa692d0[_0x47dc1f(0xc9f)]['iconId'];_0x57f236&&_0x58f257(_0x57f236,'cphone',_0xa692d0);}}),document[_0x4aca80(0x9c8)]('import-appearance-btn')['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x164237=_0x4aca80;document[_0x164237(0x9c8)](_0x164237(0x523))['click']();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x523))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),_0x89d01f=>{const _0x4ed7f3=_0x4aca80,_0x999c34=_0x89d01f[_0x4ed7f3(0x1070)][_0x4ed7f3(0x1216)][0x0];_0x999c34&&_0x46eebd(_0x999c34),_0x89d01f[_0x4ed7f3(0x1070)][_0x4ed7f3(0x1155)]=null;}),document[_0x4aca80(0xa0f)](_0x4aca80(0x4b7),()=>{const _0x20afbf=_0x4aca80;document['visibilityState']===_0x20afbf(0x13cd)&&(localStorage[_0x20afbf(0xa65)]('ephoneLastActiveTimestamp',Date[_0x20afbf(0x9b7)]()),console[_0x20afbf(0x283)]('应用已切换到后台，记录当前时间。'));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x812))[_0x4aca80(0xa0f)]('click',_0x2dd07f),document[_0x4aca80(0x9c8)](_0x4aca80(0x1172))[_0x4aca80(0xa0f)]('click',()=>{const _0x5e55e2=_0x4aca80;document[_0x5e55e2(0x9c8)](_0x5e55e2(0x191))[_0x5e55e2(0xf5c)]();}),document['getElementById'](_0x4aca80(0x191))[_0x4aca80(0xa0f)]('change',_0x2cb01d=>{const _0x5f500c=_0x4aca80,_0x8b6016=_0x2cb01d['target'][_0x5f500c(0x1216)][0x0];_0x8b6016&&_0x4a4dfd(_0x8b6016),_0x2cb01d[_0x5f500c(0x1070)]['value']=null;}),document[_0x4aca80(0x9c8)](_0x4aca80(0x3c9))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),async _0x200a24=>{const _0x3f063d=_0x4aca80,_0x41c97b=_0x200a24[_0x3f063d(0x1070)][_0x3f063d(0x1ec)];_0x9ebf46[_0x3f063d(0x1383)][_0x3f063d(0x443)]=_0x41c97b,await _0x2c5bcf['globalSettings'][_0x3f063d(0xff5)](_0x9ebf46['globalSettings']);const _0x29329a=document[_0x3f063d(0x91d)]('.screen.active');if(_0x29329a)switch(_0x29329a['id']){case _0x3f063d(0x504):_0x1a44b1(_0x9ebf46['activeChatId']);break;case _0x3f063d(0x1056):if(document[_0x3f063d(0x9c8)](_0x3f063d(0x81c))[_0x3f063d(0x575)][_0x3f063d(0x1038)](_0x3f063d(0x113d)))_0x2c70a9();if(document['getElementById'](_0x3f063d(0x71f))[_0x3f063d(0x575)][_0x3f063d(0x1038)](_0x3f063d(0x113d)))_0x22a029();break;case _0x3f063d(0x5de):_0x30f476();break;case _0x3f063d(0x52d):_0x551da5(_0x457a2a);break;case _0x3f063d(0x3ed):const _0x5d880d=document['querySelector'](_0x3f063d(0x322));if(_0x5d880d)switch(_0x5d880d['id']){case _0x3f063d(0xb57):_0x3eea82();break;case _0x3f063d(0x9c2):_0x2f0b87();break;case _0x3f063d(0x1e9):const _0x2e7817=_0x9ebf46[_0x3f063d(0x547)][_0x141b83],_0x5a2e7e=_0x2e7817[_0x3f063d(0x4e1)]||[],_0x24f31a=_0x5a2e7e['length']>0x0?_0x5a2e7e['length']-0x1:0x0;_0x230b89(_0x5a2e7e[_0x24f31a]);break;case _0x3f063d(0xde8):_0x4f3eed();break;case _0x3f063d(0xf7b):_0x267084();break;case _0x3f063d(0x40b):const _0xcca33d=document[_0x3f063d(0x91d)](_0x3f063d(0xc12))?.[_0x3f063d(0xc9f)]['conversationIndex']||0x0;_0x4eb7a8(parseInt(_0xcca33d));break;}break;}_0x1bff53(_0x3f063d(0x4ac),_0x3f063d(0x205)+(_0x41c97b?'开启':'关闭')+'。');}),document[_0x4aca80(0x9c8)](_0x4aca80(0x12e8))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x941015),document[_0x4aca80(0x9c8)](_0x4aca80(0x1228))[_0x4aca80(0xa0f)]('click',()=>{const _0x4adf07=_0x4aca80;_0xe5834e(_0x4adf07(0x3bc));}),document['getElementById'](_0x4aca80(0x395))[_0x4aca80(0xa0f)]('click',_0x4aa386),document[_0x4aca80(0x9c8)]('clear-search-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x4953a6),document[_0x4aca80(0x9c8)](_0x4aca80(0xa27))[_0x4aca80(0xa0f)]('click',_0x4e9bdc),document[_0x4aca80(0x9c8)](_0x4aca80(0x13d0))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x10f68e),document[_0x4aca80(0x91d)](_0x4aca80(0xd61))['addEventListener'](_0x4aca80(0xf5c),_0x157a37=>{const _0x2bac36=_0x4aca80;if(_0x157a37['target'][_0x2bac36(0x575)][_0x2bac36(0x1038)](_0x2bac36(0x465))){const _0x1d755e=parseInt(_0x157a37['target'][_0x2bac36(0xc9f)]['id']);!isNaN(_0x1d755e)&&_0x2da8d9(_0x1d755e);}}),_0x31ba2c(),window['openPresetScreen']=_0x22d9f2,document[_0x4aca80(0x9c8)]('add-preset-btn')[_0x4aca80(0xa0f)]('click',async()=>{const _0x45db20=_0x4aca80,_0x439a77=await _0xadb5df(_0x45db20(0xc04),_0x45db20(0x1339));if(_0x439a77&&_0x439a77[_0x45db20(0x3f1)]()){const _0x2bde94={'id':_0x45db20(0xc2d)+Date[_0x45db20(0x9b7)](),'name':_0x439a77[_0x45db20(0x3f1)](),'content':[]};await _0x2c5bcf[_0x45db20(0x10ef)][_0x45db20(0x68e)](_0x2bde94),await _0x380d6a(),_0x37397b(_0x2bde94['id']);}}),document['getElementById'](_0x4aca80(0x218))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x181a65),document[_0x4aca80(0x9c8)](_0x4aca80(0x6f8))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x4af5c2=_0x4aca80,_0x2ea0e5=document[_0x4af5c2(0x9c8)](_0x4af5c2(0x8cb));_0x2ea0e5[_0x4af5c2(0x91d)]('p')&&(_0x2ea0e5['innerHTML']='');const _0x5ba965=_0x383311();_0x2ea0e5[_0x4af5c2(0x7b9)](_0x5ba965),_0x5ba965[_0x4af5c2(0x91d)](_0x4af5c2(0xc7f))['focus']();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x532))[_0x4aca80(0xa0f)]('click',async()=>{const _0xd73ae4=_0x4aca80;if(!_0x46d2fa)return;const _0x2bef30=await _0x2c5bcf[_0xd73ae4(0x10ef)][_0xd73ae4(0xdf9)](_0x46d2fa);if(!_0x2bef30)return;const _0xa33458=document['getElementById']('preset-name-input')[_0xd73ae4(0x1155)][_0xd73ae4(0x3f1)]();if(!_0xa33458){alert('预设名称不能为空！');return;}_0x2bef30[_0xd73ae4(0x609)]=_0xa33458,_0x2bef30[_0xd73ae4(0x408)]=parseInt(document[_0xd73ae4(0x9c8)](_0xd73ae4(0x29f))[_0xd73ae4(0x1155)])||null;const _0x167257=document[_0xd73ae4(0x9c8)](_0xd73ae4(0x8cb)),_0x276f36=_0x167257['querySelectorAll'](_0xd73ae4(0x5d8)),_0x53cd2d=[];_0x276f36[_0xd73ae4(0x591)](_0x759a88=>{const _0x3035d3=_0xd73ae4,_0x1152ff=_0x759a88[_0x3035d3(0x91d)](_0x3035d3(0xc7f))[_0x3035d3(0x1155)][_0x3035d3(0x3f1)]();_0x1152ff&&_0x53cd2d[_0x3035d3(0x668)]({'comment':_0x759a88[_0x3035d3(0x91d)]('.entry-comment-input')[_0x3035d3(0x1155)][_0x3035d3(0x3f1)](),'keys':(_0x759a88[_0x3035d3(0x91d)]('.entry-keys-input')[_0x3035d3(0x1155)][_0x3035d3(0x3f1)]()||'')['split'](',')[_0x3035d3(0xa3b)](_0x1e9c28=>_0x1e9c28[_0x3035d3(0x3f1)]())[_0x3035d3(0x401)](Boolean),'content':_0x1152ff,'enabled':_0x759a88[_0x3035d3(0x91d)](_0x3035d3(0x605))[_0x3035d3(0x1ec)]});}),_0x2bef30[_0xd73ae4(0x53b)]=_0x53cd2d,await _0x2c5bcf[_0xd73ae4(0x10ef)][_0xd73ae4(0xff5)](_0x2bef30),_0x46d2fa=null,_0xe5834e(_0xd73ae4(0xf21)),await _0x380d6a();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x978))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x2a5918=_0x4aca80;document[_0x2a5918(0x9c8)](_0x2a5918(0x727))[_0x2a5918(0xf5c)]();}),document['getElementById']('import-preset-input')[_0x4aca80(0xa0f)]('change',_0x4255ff),document[_0x4aca80(0x9c8)](_0x4aca80(0x4ca))['addEventListener'](_0x4aca80(0xf5c),_0x55bcd6),document[_0x4aca80(0x9c8)]('clear-specific-data-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x382942),document[_0x4aca80(0x9c8)](_0x4aca80(0xc9e))['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x2acb9c=_0x4aca80;document[_0x2acb9c(0x9c8)](_0x2acb9c(0xd29))[_0x2acb9c(0x575)][_0x2acb9c(0x30f)](_0x2acb9c(0xc3f));}),document['getElementById'](_0x4aca80(0x93d))['addEventListener'](_0x4aca80(0xf5c),_0x31ebc8),document[_0x4aca80(0x9c8)](_0x4aca80(0x8cf))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2a73de),document[_0x4aca80(0x9c8)](_0x4aca80(0x1393))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x5ad3e8=_0x4aca80;document[_0x5ad3e8(0x9c8)]('data-clear-wizard-modal')[_0x5ad3e8(0x575)][_0x5ad3e8(0x30f)]('visible');}),document[_0x4aca80(0x9c8)](_0x4aca80(0xf65))['addEventListener'](_0x4aca80(0xf5c),_0x41d22f),document[_0x4aca80(0x9c8)](_0x4aca80(0xd29))[_0x4aca80(0xa0f)]('click',_0x359ef8=>{const _0x496f5e=_0x4aca80,_0x433462=_0x359ef8['target']['closest'](_0x496f5e(0x11b9));_0x433462&&(_0x359ef8[_0x496f5e(0x20a)](),_0x433462['classList']['toggle'](_0x496f5e(0x631)));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xd29))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),_0x1b751e=>{const _0x3dfd82=_0x4aca80;if(_0x1b751e['target']['id']==='select-all-chars-for-clear'){const _0x4f7ec1=_0x1b751e[_0x3dfd82(0x1070)]['checked'];document[_0x3dfd82(0x7e4)](_0x3dfd82(0x1322))[_0x3dfd82(0x591)](_0x317759=>{const _0x15acd0=_0x3dfd82;_0x317759[_0x15acd0(0x575)][_0x15acd0(0x1c3)](_0x15acd0(0x631),_0x4f7ec1);});}else{if(_0x1b751e[_0x3dfd82(0x1070)]['id']===_0x3dfd82(0xe60)){const _0x34d13f=_0x1b751e[_0x3dfd82(0x1070)][_0x3dfd82(0x1ec)];document[_0x3dfd82(0x7e4)](_0x3dfd82(0xfe6))[_0x3dfd82(0x591)](_0x412f01=>{const _0xd14128=_0x3dfd82;_0x412f01[_0xd14128(0x575)]['toggle'](_0xd14128(0x631),_0x34d13f);});}}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x4f7))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x16b97f),document['getElementById'](_0x4aca80(0x398))[_0x4aca80(0xa0f)]('click',_0x3b2cc9),document[_0x4aca80(0x9c8)]('copy-timestamp-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x3149f3),document['getElementById'](_0x4aca80(0xbd5))[_0x4aca80(0xa0f)]('click',()=>{_0x55787a('messages-view');}),document[_0x4aca80(0x9c8)](_0x4aca80(0x39e))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>_0x2e413a(null)),document['getElementById'](_0x4aca80(0x2e5))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x452c7a),document[_0x4aca80(0x9c8)](_0x4aca80(0xd67))['addEventListener']('click',()=>{const _0x10ac59=_0x4aca80;document[_0x10ac59(0x9c8)](_0x10ac59(0xf2e))[_0x10ac59(0x575)]['remove'](_0x10ac59(0xc3f));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x1274))[_0x4aca80(0xa0f)](_0x4aca80(0x25c),_0x57ef9f=>{const _0x48a184=_0x4aca80,_0x255f3c=_0x57ef9f[_0x48a184(0x1070)]['files'][0x0];if(_0x255f3c){const _0x37f0f5=new FileReader();_0x37f0f5[_0x48a184(0x429)]=_0x254086=>{const _0xa51702=_0x48a184;document[_0xa51702(0x9c8)]('npc-avatar-preview')['src']=_0x254086['target'][_0xa51702(0xceb)];},_0x37f0f5['readAsDataURL'](_0x255f3c);}}),document['getElementById'](_0x4aca80(0x1134))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0xbdeec9=>{const _0x2751a4=_0x4aca80;if(_0xbdeec9[_0x2751a4(0x1070)]['id']===_0x2751a4(0x433))_0x4d088b();else _0xbdeec9[_0x2751a4(0x1070)]['id']===_0x2751a4(0x777)&&_0x155696();}),_0x43a60a(document[_0x4aca80(0x9c8)](_0x4aca80(0x3d1)),()=>{const _0x29da9b=_0x4aca80;_0x5062a9[_0x29da9b(0xcc8)]>-0x1&&_0x357753(_0x5062a9[_0x29da9b(0xcc8)]);}),document['getElementById'](_0x4aca80(0x4f2))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x5015ab),document[_0x4aca80(0x9c8)]('save-douban-settings-btn')[_0x4aca80(0xa0f)]('click',_0x1a61ec),document[_0x4aca80(0x9c8)]('cancel-douban-settings-btn')[_0x4aca80(0xa0f)]('click',()=>{const _0x1b4792=_0x4aca80;document[_0x1b4792(0x9c8)]('douban-settings-modal')[_0x1b4792(0x575)][_0x1b4792(0x30f)](_0x1b4792(0xc3f));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x1c6))[_0x4aca80(0xa0f)]('input',_0x5dfd96=>{const _0x18ca92=_0x4aca80,_0x45d548=_0x5dfd96['target'][_0x18ca92(0x1155)][_0x18ca92(0xc61)](),_0x18ea9b=document[_0x18ca92(0x9c8)](_0x18ca92(0x39b));for(const _0x5e1867 of _0x18ea9b[_0x18ca92(0x5ed)]){const _0x285045=_0x5e1867['textContent'][_0x18ca92(0xc61)]();_0x285045[_0x18ca92(0x930)](_0x45d548)?_0x5e1867[_0x18ca92(0x5e1)]['display']='':_0x5e1867[_0x18ca92(0x5e1)][_0x18ca92(0x3c5)]=_0x18ca92(0x8f6);}}),window[_0x4aca80(0x107f)]=_0x29b196,document['getElementById'](_0x4aca80(0x7f6))['addEventListener']('click',()=>_0x29b196(_0x4aca80(0x1016))),document['getElementById'](_0x4aca80(0x89f))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x1dab39=_0x4aca80;document[_0x1dab39(0x9c8)](_0x1dab39(0x96a))['classList']['remove'](_0x1dab39(0xc3f));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x4cd))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0xaca914),document[_0x4aca80(0x9c8)](_0x4aca80(0x134a))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x53f96c=_0x4aca80;document['getElementById'](_0x53f96c(0x696))[_0x53f96c(0x575)][_0x53f96c(0x30f)](_0x53f96c(0xc3f)),_0x1116f9();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x2b5))[_0x4aca80(0xa0f)]('click',async()=>{const _0x48799d=_0x4aca80,_0x503870=await _0x352ae9(_0x48799d(0x8e1),_0x48799d(0x101d),{'confirmButtonClass':_0x48799d(0x12bc)});_0x503870&&(_0x1c1d43['isActive']=![],_0xe5834e(_0x1c1d43[_0x48799d(0x54d)]?_0x48799d(0x504):'home-screen'));}),document['getElementById'](_0x4aca80(0x9d5))['addEventListener']('click',()=>{const _0x2b5041=_0x4aca80;document['getElementById'](_0x2b5041(0xce3))['classList'][_0x2b5041(0x30f)]('visible'),_0xe5834e(_0x1c1d43[_0x2b5041(0x54d)]?_0x2b5041(0x1056):_0x2b5041(0x327));}),document[_0x4aca80(0x9c8)]('cancel-wolf-kill-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x42bfbb=_0x4aca80;document[_0x42bfbb(0x9c8)](_0x42bfbb(0x12ba))['classList'][_0x42bfbb(0x30f)](_0x42bfbb(0xc3f));}),document['getElementById'](_0x4aca80(0x89f))[_0x4aca80(0xa0f)]('click',()=>{const _0x11aaae=_0x4aca80;document[_0x11aaae(0x9c8)](_0x11aaae(0x96a))['classList'][_0x11aaae(0x30f)](_0x11aaae(0xc3f));}),document['getElementById'](_0x4aca80(0x32e))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1ecc36),document[_0x4aca80(0x9c8)]('manual-werewolf-summary-btn')['addEventListener'](_0x4aca80(0xf5c),_0x4fb78b),document['getElementById']('check-and-fix-data-btn')[_0x4aca80(0xa0f)]('click',_0xaaa6b1),document['getElementById'](_0x4aca80(0xfe3))['addEventListener']('click',_0x1c4d4d),document[_0x4aca80(0x9c8)](_0x4aca80(0x83d))[_0x4aca80(0xa0f)]('click',()=>{const _0x421f98=_0x4aca80;document[_0x421f98(0x9c8)](_0x421f98(0xea7))[_0x421f98(0x575)][_0x421f98(0x30f)](_0x421f98(0xc3f));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xd8a))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x421182),document[_0x4aca80(0x9c8)](_0x4aca80(0xea7))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x7ece3f=>{const _0x416f23=_0x4aca80,_0x51006a=_0x7ece3f[_0x416f23(0x1070)]['closest'](_0x416f23(0x11b9));_0x51006a&&_0x51006a[_0x416f23(0x575)][_0x416f23(0x1c3)](_0x416f23(0x631));if(_0x7ece3f['target']['id']===_0x416f23(0x231)){const _0x339d48=_0x7ece3f[_0x416f23(0x1070)][_0x416f23(0x1ec)];document[_0x416f23(0x7e4)](_0x416f23(0x2c5))[_0x416f23(0x591)](_0x6d47e6=>{const _0x7beb0d=_0x416f23;_0x6d47e6[_0x7beb0d(0x575)][_0x7beb0d(0x1c3)]('selected',_0x339d48);});}}),document[_0x4aca80(0x9c8)]('sticker-search-input')[_0x4aca80(0xa0f)](_0x4aca80(0x11ce),()=>{_0x43920d(![]);}),document[_0x4aca80(0x9c8)](_0x4aca80(0x70a))['addEventListener'](_0x4aca80(0xf5c),_0x370ab3=>{const _0x4aca37=_0x4aca80;if(_0x370ab3[_0x4aca37(0x1070)][_0x4aca37(0x575)][_0x4aca37(0x1038)](_0x4aca37(0x1293))){const _0x47c566=_0x370ab3['target'][_0x4aca37(0xc9f)][_0x4aca37(0x408)],_0x1d0887=_0x47c566!==_0x4aca37(0xd0a)&&_0x47c566!==_0x4aca37(0x247)?parseInt(_0x47c566):_0x47c566;document[_0x4aca37(0x9c8)](_0x4aca37(0xe61))['value']='',_0x462b69(_0x1d0887);}});const _0x345e24=document[_0x4aca80(0x9c8)](_0x4aca80(0xbff));_0x345e24[_0x4aca80(0xa0f)](_0x4aca80(0x3be),()=>{const _0x3cbd98=_0x4aca80;if(_0x345e24['scrollTop']<0x1&&!_0x836281){const _0x1a34f4=_0x9ebf46[_0x3cbd98(0x547)][_0x9ebf46[_0x3cbd98(0x970)]]?.['history']['length']||0x0;_0x1a34f4>_0x2200fe&&_0x32afa4();}});const _0x201817=document[_0x4aca80(0x9c8)](_0x4aca80(0x771));_0x201817[_0x4aca80(0xa0f)](_0x4aca80(0x3be),()=>{const _0x3bcb2e=_0x4aca80,{scrollTop:_0x3c8e01,scrollHeight:_0xea8cb1,clientHeight:_0x3a61e9}=_0x201817;if(_0xea8cb1-_0x3c8e01<=_0x3a61e9+0x32&&!_0x18bae1){const _0x2c22e=_0x9ebf46[_0x3bcb2e(0x547)][_0x9ebf46[_0x3bcb2e(0x970)]]?.[_0x3bcb2e(0xec6)][_0x3bcb2e(0xa06)]||0x0;_0x2c22e>_0x3e7d67&&_0x5b2a99();}});const _0x3987b5=document[_0x4aca80(0x91d)](_0x4aca80(0x8aa));_0x3987b5['addEventListener'](_0x4aca80(0x3be),()=>{const _0x463b6d=_0x4aca80,{scrollTop:_0x1b8af7,scrollHeight:_0x359376,clientHeight:_0x345add}=_0x3987b5;_0x359376-_0x1b8af7<=_0x345add+0x64&&!_0x3d4398&&(_0x20f1b5[_0x463b6d(0xa06)]>_0xca834d&&_0x2a6c86());}),document[_0x4aca80(0x9c8)]('read-together-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x4ef20e);const _0x35a6a1=document[_0x4aca80(0x9c8)](_0x4aca80(0x11dc));_0x194388(_0x35a6a1,_0x35a6a1),document[_0x4aca80(0x9c8)](_0x4aca80(0x1df))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x36c2b5),document[_0x4aca80(0x9c8)](_0x4aca80(0xd30))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1ddb7e),document[_0x4aca80(0x9c8)](_0x4aca80(0xbbc))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1fdb41),document[_0x4aca80(0x9c8)]('prev-page-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2d59f7),document[_0x4aca80(0x9c8)](_0x4aca80(0xd9b))[_0x4aca80(0xa0f)]('change',_0x1db2f5),document[_0x4aca80(0x9c8)](_0x4aca80(0x104b))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x2a1df1),document[_0x4aca80(0x9c8)](_0x4aca80(0x11dc))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x5981),_0x194388(document[_0x4aca80(0x9c8)](_0x4aca80(0x108c)),document['querySelector'](_0x4aca80(0x105d))),document[_0x4aca80(0x9c8)]('open-reading-library-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1ddb7e),document[_0x4aca80(0x9c8)](_0x4aca80(0x12bd))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x177391=_0x4aca80;document[_0x177391(0x9c8)](_0x177391(0x269))[_0x177391(0x575)][_0x177391(0x30f)]('visible');}),document[_0x4aca80(0x9c8)](_0x4aca80(0x564))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x23f649),document[_0x4aca80(0x9c8)](_0x4aca80(0xdf2))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x1c4db6=>{const _0x589dc6=_0x4aca80,_0x59c10d=_0x1c4db6[_0x589dc6(0x1070)];if(_0x59c10d['classList'][_0x589dc6(0x1038)](_0x589dc6(0x5ce))){const _0x1f6a18=parseInt(_0x59c10d[_0x589dc6(0xc9f)]['bookId']);_0x4460aa(_0x1f6a18);}else{if(_0x59c10d[_0x589dc6(0x575)][_0x589dc6(0x1038)](_0x589dc6(0x5ae))){const _0x1dc168=parseInt(_0x59c10d[_0x589dc6(0xc9f)][_0x589dc6(0x7ad)]);_0x3bfbc9(_0x1dc168);}}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x845))['addEventListener'](_0x4aca80(0xf5c),_0x5d767a),document[_0x4aca80(0x9c8)](_0x4aca80(0x920))[_0x4aca80(0xa0f)](_0x4aca80(0x11ce),_0x1d4046=>{const _0x273de9=_0x4aca80;_0x291d51(_0x1d4046['target'][_0x273de9(0x1155)]);});const _0x578e60=_0x3b23c3(_0x4ee342,0x12c);document[_0x4aca80(0x9c8)]('reading-content')['addEventListener'](_0x4aca80(0x3be),_0x578e60),document[_0x4aca80(0x9c8)](_0x4aca80(0xfd3))[_0x4aca80(0xa0f)]('input',_0x2186f4=>{const _0x45f360=_0x4aca80;document['getElementById']('api-temperature-value')[_0x45f360(0xe24)]=_0x2186f4[_0x45f360(0x1070)][_0x45f360(0x1155)];});const _0xb669cb=document[_0x4aca80(0x9c8)](_0x4aca80(0xbc9));_0xb669cb['addEventListener']('scroll',()=>{const {scrollTop:_0x3944cf,scrollHeight:_0x28c7b2,clientHeight:_0x480271}=_0xb669cb;_0x28c7b2-_0x3944cf<=_0x480271+0x96&&!_0x5daaec&&_0x5ddf04();}),document['getElementById'](_0x4aca80(0x333))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x32e03e),document[_0x4aca80(0x9c8)](_0x4aca80(0xfea))['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x27f3b1=_0x4aca80;document['getElementById'](_0x27f3b1(0x7df))[_0x27f3b1(0x575)][_0x27f3b1(0x30f)](_0x27f3b1(0xc3f)),_0x387b4a(_0x51315e);}),document[_0x4aca80(0x9c8)]('add-new-product-category-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x82059a),document[_0x4aca80(0x9c8)](_0x4aca80(0xa0c))['addEventListener'](_0x4aca80(0xf5c),_0x4b2358=>{const _0x511266=_0x4aca80;_0x4b2358[_0x511266(0x1070)][_0x511266(0x575)]['contains'](_0x511266(0x5ae))&&_0x13fd84(parseInt(_0x4b2358['target'][_0x511266(0xc9f)]['id']));}),document[_0x4aca80(0x9c8)](_0x4aca80(0xb8f))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>_0xabc5be()),document[_0x4aca80(0x9c8)](_0x4aca80(0x214))['addEventListener']('click',()=>{const _0x18378e=_0x4aca80;document[_0x18378e(0x9c8)](_0x18378e(0xa2a))[_0x18378e(0x575)][_0x18378e(0x30f)]('visible');}),document[_0x4aca80(0x9c8)](_0x4aca80(0x9fa))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0xfb3603=_0x4aca80,_0x18efc9=document[_0xfb3603(0x9c8)](_0xfb3603(0xe7c));let _0x3d746f=parseInt(_0x18efc9[_0xfb3603(0xe24)]);if(_0x3d746f>0x1)_0x18efc9[_0xfb3603(0xe24)]=_0x3d746f-0x1;}),document[_0x4aca80(0x9c8)]('variation-increase-qty')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x185712=_0x4aca80,_0x470b41=document[_0x185712(0x9c8)]('variation-quantity-display');_0x470b41[_0x185712(0xe24)]=parseInt(_0x470b41[_0x185712(0xe24)])+0x1;}),document[_0x4aca80(0x9c8)](_0x4aca80(0x635))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0xf26c69=>{const _0x3efadf=_0x4aca80;if(_0xf26c69['target'][_0x3efadf(0x575)]['contains'](_0x3efadf(0x785))){const _0x40d98c=_0xf26c69[_0x3efadf(0x1070)][_0x3efadf(0xc9f)][_0x3efadf(0x408)]===_0x3efadf(0xd0a)?_0x3efadf(0xd0a):parseInt(_0xf26c69[_0x3efadf(0x1070)][_0x3efadf(0xc9f)][_0x3efadf(0x408)]);_0xbe6222(_0x40d98c);}}),document[_0x4aca80(0x9c8)](_0x4aca80(0x3a4))['addEventListener']('click',_0x53a029),document['getElementById']('shopping-settings-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x83b4eb),document[_0x4aca80(0x9c8)](_0x4aca80(0x1166))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x7d103e),document[_0x4aca80(0x9c8)](_0x4aca80(0x1289))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x5398c5=_0x4aca80;document['getElementById'](_0x5398c5(0x36e))[_0x5398c5(0x575)][_0x5398c5(0x30f)](_0x5398c5(0xc3f));}),document['getElementById']('select-all-products-checkbox')[_0x4aca80(0xa0f)](_0x4aca80(0x25c),_0x2e6624=>{const _0x46fd4e=_0x4aca80,_0x2b3eb9=_0x2e6624[_0x46fd4e(0x1070)]['checked'],_0x564480=document[_0x46fd4e(0x7e4)]('#product-grid\x20.product-item');_0x564480[_0x46fd4e(0x591)](_0x396e4f=>{const _0x4510f6=_0x46fd4e,_0x3266c4=parseInt(_0x396e4f[_0x4510f6(0xc9f)]['id']);_0x396e4f[_0x4510f6(0x575)]['toggle'](_0x4510f6(0x631),_0x2b3eb9),_0x2b3eb9?_0x524d97[_0x4510f6(0x68e)](_0x3266c4):_0x524d97['delete'](_0x3266c4);}),document[_0x46fd4e(0x9c8)]('delete-selected-products-btn')['textContent']='删除\x20('+_0x524d97['size']+')';}),document[_0x4aca80(0x9c8)](_0x4aca80(0xfde))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{const _0x449ba5=_0x4aca80;if(_0x524d97[_0x449ba5(0xa67)]===0x0){alert(_0x449ba5(0x792));return;}const _0x50cad1=await _0x352ae9('确认删除',_0x449ba5(0x124b)+_0x524d97[_0x449ba5(0xa67)]+_0x449ba5(0x9cc),{'confirmButtonClass':_0x449ba5(0x12bc)});_0x50cad1&&(await _0x2c5bcf[_0x449ba5(0x281)][_0x449ba5(0x256)]([..._0x524d97]),document[_0x449ba5(0x9c8)](_0x449ba5(0x350))[_0x449ba5(0xf5c)](),await _0x3fe79f(),await _0x1bff53('成功','选中的商品已成功删除。'));}),document[_0x4aca80(0x9c8)](_0x4aca80(0x122e))['addEventListener']('change',_0x17f730),document[_0x4aca80(0x9c8)](_0x4aca80(0x3cf))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x21d2c6),document[_0x4aca80(0x9c8)]('delete-appearance-preset-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x8b4ec4),document['getElementById']('novelai-switch')[_0x4aca80(0xa0f)](_0x4aca80(0x25c),_0x5b2227=>{const _0x1437b3=_0x4aca80,_0x6bfac6=document[_0x1437b3(0x9c8)](_0x1437b3(0x580));_0x6bfac6[_0x1437b3(0x5e1)]['display']=_0x5b2227['target'][_0x1437b3(0x1ec)]?_0x1437b3(0x3d9):_0x1437b3(0x8f6);}),document[_0x4aca80(0x9c8)](_0x4aca80(0xd38))['addEventListener']('click',function(){const _0x3a1855=_0x4aca80,_0x1398b6=document[_0x3a1855(0x9c8)]('novelai-api-key');_0x1398b6[_0x3a1855(0x12d9)]===_0x3a1855(0x56b)?(_0x1398b6[_0x3a1855(0x12d9)]=_0x3a1855(0xbb7),this['textContent']='😌'):(_0x1398b6[_0x3a1855(0x12d9)]=_0x3a1855(0x56b),this[_0x3a1855(0xe24)]='🧐');}),document['getElementById']('novelai-settings-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x228562=_0x4aca80;_0x388726(),document['getElementById'](_0x228562(0x5aa))[_0x228562(0x5e1)]['display']=_0x228562(0x989);}),document[_0x4aca80(0x9c8)](_0x4aca80(0x967))['addEventListener'](_0x4aca80(0x25c),_0x4e8389=>{const _0x43e970=_0x4aca80,_0x33a22b=document[_0x43e970(0x9c8)](_0x43e970(0x255));_0x4e8389[_0x43e970(0x1070)][_0x43e970(0x1155)]===_0x43e970(0x13c6)?_0x33a22b[_0x43e970(0x5e1)][_0x43e970(0x3c5)]=_0x43e970(0x3d9):_0x33a22b[_0x43e970(0x5e1)][_0x43e970(0x3c5)]=_0x43e970(0x8f6);}),document[_0x4aca80(0x9c8)]('close-novelai-settings')['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x340119=_0x4aca80;document[_0x340119(0x9c8)](_0x340119(0x5aa))[_0x340119(0x5e1)][_0x340119(0x3c5)]=_0x340119(0x8f6);}),document[_0x4aca80(0x9c8)](_0x4aca80(0xf89))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0xe5e103=_0x4aca80;_0x43ebac(),document[_0xe5e103(0x9c8)](_0xe5e103(0x5aa))[_0xe5e103(0x5e1)][_0xe5e103(0x3c5)]=_0xe5e103(0x8f6),alert('NovelAI设置已保存！');}),document[_0x4aca80(0x9c8)]('reset-nai-settings-btn')['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x4faeb5=_0x4aca80;confirm(_0x4faeb5(0x4e4))&&_0x2a520e();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x8b4))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0xbc9330=_0x4aca80,_0x5116c3=document[_0xbc9330(0x9c8)](_0xbc9330(0xef8))[_0xbc9330(0x1155)]['trim']();if(!_0x5116c3){alert(_0xbc9330(0xc49));return;}document[_0xbc9330(0x9c8)](_0xbc9330(0xecb))[_0xbc9330(0x5e1)][_0xbc9330(0x3c5)]='flex',document[_0xbc9330(0x9c8)](_0xbc9330(0x113f))[_0xbc9330(0x5e1)][_0xbc9330(0x3c5)]=_0xbc9330(0x8f6),document[_0xbc9330(0x9c8)](_0xbc9330(0x641))[_0xbc9330(0x5e1)][_0xbc9330(0x3c5)]=_0xbc9330(0x8f6);}),document[_0x4aca80(0x9c8)](_0x4aca80(0x346))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0xf94147=_0x4aca80;document[_0xf94147(0x9c8)](_0xf94147(0xecb))['style'][_0xf94147(0x3c5)]=_0xf94147(0x8f6);}),document[_0x4aca80(0x9c8)](_0x4aca80(0x5c2))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x888976=_0x4aca80;document['getElementById']('novelai-test-modal')[_0x888976(0x5e1)]['display']=_0x888976(0x8f6);}),document[_0x4aca80(0x9c8)](_0x4aca80(0x30d))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),async()=>{await _0xe6d441();}),document['getElementById']('nai-download-btn')[_0x4aca80(0xa0f)]('click',()=>{const _0x4b09a6=_0x4aca80,_0x29abce=document[_0x4b09a6(0x9c8)](_0x4b09a6(0x568)),_0x2af713=document[_0x4b09a6(0x28a)]('a');_0x2af713[_0x4b09a6(0xc4a)]=_0x29abce[_0x4b09a6(0xbf4)],_0x2af713['download']=_0x4b09a6(0x3e5)+Date[_0x4b09a6(0x9b7)]()+_0x4b09a6(0xa8f),_0x2af713['click']();}),document[_0x4aca80(0x9c8)](_0x4aca80(0x536))[_0x4aca80(0xa0f)]('click',()=>{const _0x227021=_0x4aca80;if(!_0x9ebf46[_0x227021(0x970)])return;const _0x21e8e5=_0x9ebf46[_0x227021(0x547)][_0x9ebf46[_0x227021(0x970)]],_0x1bfdb2=_0x21e8e5[_0x227021(0x1131)][_0x227021(0xf03)]||{'promptSource':'system','characterPositivePrompt':'','characterNegativePrompt':''};document[_0x227021(0x9c8)]('character-nai-positive')[_0x227021(0x1155)]=_0x1bfdb2[_0x227021(0x12af)]||'',document[_0x227021(0x9c8)](_0x227021(0x508))[_0x227021(0x1155)]=_0x1bfdb2[_0x227021(0x41d)]||'',document[_0x227021(0x9c8)](_0x227021(0xb6f))[_0x227021(0x5e1)][_0x227021(0x3c5)]=_0x227021(0x989);}),document[_0x4aca80(0x9c8)](_0x4aca80(0x709))[_0x4aca80(0xa0f)]('click',()=>{const _0x341dcd=_0x4aca80;document[_0x341dcd(0x9c8)](_0x341dcd(0xb6f))[_0x341dcd(0x5e1)][_0x341dcd(0x3c5)]='none';}),document[_0x4aca80(0x9c8)](_0x4aca80(0x12a7))['addEventListener']('click',async()=>{const _0x39def1=_0x4aca80;if(!_0x9ebf46[_0x39def1(0x970)])return;const _0x5d0ab2=_0x9ebf46[_0x39def1(0x547)][_0x9ebf46[_0x39def1(0x970)]];!_0x5d0ab2['settings'][_0x39def1(0xf03)]&&(_0x5d0ab2['settings'][_0x39def1(0xf03)]={'promptSource':'system'}),_0x5d0ab2[_0x39def1(0x1131)][_0x39def1(0xf03)]['characterPositivePrompt']=document[_0x39def1(0x9c8)](_0x39def1(0xd77))[_0x39def1(0x1155)][_0x39def1(0x3f1)](),_0x5d0ab2[_0x39def1(0x1131)][_0x39def1(0xf03)][_0x39def1(0x41d)]=document['getElementById']('character-nai-negative')[_0x39def1(0x1155)][_0x39def1(0x3f1)](),console['log'](_0x39def1(0x392)),console[_0x39def1(0x283)](_0x39def1(0x9df),_0x5d0ab2[_0x39def1(0x1131)][_0x39def1(0xf03)][_0x39def1(0x12af)]),console[_0x39def1(0x283)](_0x39def1(0x12ed),_0x5d0ab2['settings'][_0x39def1(0xf03)][_0x39def1(0x41d)]),console['log'](_0x39def1(0x51f),_0x5d0ab2[_0x39def1(0x1131)][_0x39def1(0xf03)][_0x39def1(0x27b)]),await _0x2c5bcf['chats']['put'](_0x5d0ab2),document[_0x39def1(0x9c8)]('character-nai-prompts-modal')['style'][_0x39def1(0x3c5)]='none',alert('角色专属NAI提示词已保存！');}),document[_0x4aca80(0x9c8)](_0x4aca80(0x715))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x42918a=_0x4aca80;confirm(_0x42918a(0x625))&&(document[_0x42918a(0x9c8)](_0x42918a(0xd77))[_0x42918a(0x1155)]='',document['getElementById'](_0x42918a(0x508))[_0x42918a(0x1155)]='');}),document[_0x4aca80(0x9c8)]('group-character-nai-prompts-btn')['addEventListener'](_0x4aca80(0xf5c),()=>{const _0x30779b=_0x4aca80;if(!_0x9ebf46[_0x30779b(0x970)])return;const _0x5e049c=_0x9ebf46['chats'][_0x9ebf46[_0x30779b(0x970)]],_0xcd5379=_0x5e049c[_0x30779b(0x1131)][_0x30779b(0xf03)]||{'promptSource':_0x30779b(0xb64),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x30779b(0x9c8)](_0x30779b(0xd77))[_0x30779b(0x1155)]=_0xcd5379[_0x30779b(0x12af)]||'',document[_0x30779b(0x9c8)](_0x30779b(0x508))[_0x30779b(0x1155)]=_0xcd5379[_0x30779b(0x41d)]||'',document[_0x30779b(0x9c8)](_0x30779b(0xb6f))['style'][_0x30779b(0x3c5)]='flex';}),document[_0x4aca80(0x9c8)](_0x4aca80(0xefc))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x38af39),document[_0x4aca80(0x9c8)]('select-all-frames-checkbox')[_0x4aca80(0xa0f)](_0x4aca80(0x25c),_0x1f426f),document[_0x4aca80(0x9c8)](_0x4aca80(0xb36))[_0x4aca80(0xa0f)]('click',_0x4636c4),document['getElementById'](_0x4aca80(0x35a))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x56ce3a),document[_0x4aca80(0x9c8)]('char-wallet-back-btn')[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),()=>{const _0x48f49d=_0x4aca80;_0x5bb1f1(_0x48f49d(0x9c2));}),document['getElementById'](_0x4aca80(0x248))[_0x4aca80(0xa0f)](_0x4aca80(0xf5c),_0x5a6e75=>{const _0x1b7de9=_0x4aca80,_0x2f3559=_0x5a6e75[_0x1b7de9(0x1070)]['closest'](_0x1b7de9(0x422));if(_0x2f3559){const _0xc31bd0=_0x2f3559[_0x1b7de9(0x91d)](_0x1b7de9(0x640));_0xc31bd0&&_0x5a6e75[_0x1b7de9(0x1070)]!==_0xc31bd0&&(_0xc31bd0[_0x1b7de9(0x1ec)]=!_0xc31bd0[_0x1b7de9(0x1ec)]);}});const _0x2a4a60=document[_0x4aca80(0x9c8)](_0x4aca80(0x70a));_0x43a60a(_0x2a4a60,_0x217836=>{const _0x33efc7=_0x4aca80,_0x18f777=_0x217836[_0x33efc7(0x1070)][_0x33efc7(0xaa0)](_0x33efc7(0xaa3));if(_0x18f777){_0x217836['preventDefault']();const _0x1ffcaa=_0x18f777[_0x33efc7(0xc9f)][_0x33efc7(0x408)];if(_0x1ffcaa===_0x33efc7(0xd0a)){_0x1bff53('提示',_0x33efc7(0xbf2));return;}const _0x25371c=_0x1ffcaa===_0x33efc7(0x247)?_0x33efc7(0x247):parseInt(_0x1ffcaa);_0x3ff953(_0x25371c);}}),_0x52a623(),_0xe5834e(_0x4aca80(0x327));}_0xa25f02();});
